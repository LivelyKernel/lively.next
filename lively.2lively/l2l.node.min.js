function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof2(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _slicedToArray2(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function asyncGeneratorStep(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){asyncGeneratorStep(i,n,o,a,s,"next",e)}function s(e){asyncGeneratorStep(i,n,o,a,s,"throw",e)}a(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _typeof2(e){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _toArray(e){return Array.isArray(e)?e:Array.from(e)}!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this;"object"!==_typeof(e.lively)&&(e.lively={}),e.prepareGlobal=function(t,r,n,i){var s,c=e.define;if(e.define=void 0,n)for(var u in s={},n)s[u]=e[u],e[u]=n[u];return r||(o={},a((function(e,t){o[e]=t}))),function(){var t,n=r?l(r):{},u=!!r;if(r&&!i||a((function(a,s){o[a]!==s&&void 0!==s&&(i&&(e[a]=void 0),r||(n[a]=s,void 0!==t?u||t===s||(u=!0):t=s))})),n=u?n:t,s)for(var f in s)e[f]=s[f];return e.define=c,n}};var t,r={},n={},o={},i=["_g","sessionStorage","localStorage","clipboardData","frames","frameElement","external","mozAnimationStartTime","webkitStorageInfo","webkitIndexedDB","mozInnerScreenY","mozInnerScreenX"];function a(t){!function(t){if(Object.keys)Object.keys(e).forEach(t);else for(var r in e)Object.hasOwnProperty.call(e,r)&&t(r)}((function(r){var n;if(-1==i.indexOf(r)){try{n=e[r]}catch(e){i.push(r)}t(r,n)}}))}function s(e,t){for(var r=e.split(".");r.length;)t=t[r.shift()];return t}function l(t){if("string"==typeof t)return s(t,e);if(!(t instanceof Array))throw new Error("Global exports must be a string or array.");for(var r={},n=!0,o=0;o<t.length;o++){var i=s(t[o],e);n&&(r.default=i,n=!1),r[t[o].split(".").pop()]=i}return r}if(e.lively.FreezerRuntime){var c=t.split(".").map(Number),u=_slicedToArray(c,3),f=u[0],p=u[1],h=u[2],g=e.lively.FreezerRuntime.version.split(".").map(Number),$=_slicedToArray(g,3),d=$[0],b=$[1],y=$[2],m=!1;if((isNaN(d)||!isNaN(f)&&f>d)&&(m=!0),!m&&(isNaN(b)||!isNaN(p)&&p>b)&&(m=!0),!m&&(isNaN(y)||!isNaN(h)&&h>y)&&(m=!0),!m)return;r=e.lively.FreezerRuntime.registry}n["@lively-env"]={executed:!0,options:{},moduleEnv:function(e){var t=System.get(e,!1)||System.fetchStandaloneFor(e)||System.get(e+"index.js",!1);return{recorder:t.recorder||t.exports}}},n["@system-env"]={executed:!0,browser:!0},e.lively.FreezerRuntime={global:e,location:e.document&&e.document.location.href.split("?")[0],version:t,registry:r,globalModules:n,get:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e&&e.startsWith("@"))return this.globalModules[e];var r=this.registry[e];return t?r&&r.recorder:r},set:function(e,t){return this.registry[e]=t},add:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={id:e,dependencies:t,executed:n,exports:r,execute:function(){},setters:[],subscribeToToplevelDefinitionChanges:function(){},package:function(){}};return this.set(e,o),o},decanonicalize:function(t){return t.endsWith(".json")?e.lively.resources.resource(e.origin).join(t).url:t.endsWith(".js")||t.endsWith("/")?t:t.split("/").concat(["index.js"]).filter(Boolean).join("/")},loadObjectFromPartsbinFolder:function(t){var r=this.location,n=e.lively.resources.resource(r);return n.isDirectory()||(n=n.parent()),n.join("dynamicParts/"+t+".json").readJson().then((function(t){return e.lively.morphic.loadMorphFromSnapshot(t,{onDeserializationStart:!1,migrations:[]})}))},fetchStandaloneFor:function(e){for(var t in this.globalModules)if(e.match(t.replace("local://","").replace(/\@.*\//,"/").replace("/index.js","")))return this.globalModules[t]},resolveSync:function(t,r){var n=this.get(t);if(n)return n;if(!t.includes("/")){for(var o=t.split("."),i=e;i&&o.length;)i=i[o.shift()];if(i)return{executed:!0,exports:i,dependencies:[]}}var a=this.get(this.decanonicalize(t,r));if(a)return{executed:!0,exports:a,dependencies:[]};if(n=this.fetchStandaloneFor(t))return n;throw new Error("Module "+t+" cannot be found in lively.freezer bundle!")},import:function(e){return Promise.resolve(this.registry[e]?this.registry[e].exports:{})},register:function(e,t,r){var n=this.add(e,t),o=r((function(e,t){if("string"==typeof e)n.exports[e]=t;else{var r={};for(var o in n.exports)r[o]=n.exports[o];for(var i in n.exports=e,r)n.exports[i]||(n.exports[i]=r[i])}}));return n.execute=o.execute,n.setters=o.setters,n},updateImports:function(e){if(e.dependencies)for(var t=0;t<e.dependencies.length;t++){var r=e.dependencies[t],n="@empty"!=r&&this.resolveSync(r,e.id);n&&e.setters[t](n.exports)}},updateDependent:function(e,t){for(var r=0;r<t.dependencies.length;r++){var n=t.dependencies[r];"@empty"!=n&&e==this.resolveSync(n,t.id)&&t.setters[r](e.exports)}},computeUniqDepGraphs:function(e){var t=[],r={},n={"@empty":[]},o={"@empty":[]};if(!e){var i={},a=lively.FreezerRuntime.registry;for(var s in a)i[s]=a[s].dependencies;e=i}for(var l in e){r.hasOwnProperty(l)||(r[l]=!0,t.push(l));var c=e[l],u={};if(c){n[l]=[];var f=!0,p=!1,h=void 0;try{for(var g,$=c[Symbol.iterator]();!(f=(g=$.next()).done);f=!0){var d=g.value;if(!u.hasOwnProperty(d)&&l!==d){var b=o[d]||(o[d]=[]);b.includes(l)||b.push(l),u[d]=!0,n[l].push(d),r.hasOwnProperty(d)||(r[d]=!0,t.push(d))}}}catch(e){p=!0,h=e}finally{try{!f&&$.return&&$.return()}finally{if(p)throw h}}}}return{uniqDepGraph:n,inverseDepGraph:o,dependencies:t}},sortForLoad:function(e){var t,r=this.computeUniqDepGraphs(),n=r.dependencies,o=r.uniqDepGraph,i=r.inverseDepGraph,a=[],s={};function l(e){return e.split("/")[0]}function c(e){return(o[t]||[]).filter((function(e){return!u(e)})).map((function(e){return l(e)}))}function u(e){return"@empty"==e||!!lively.FreezerRuntime.globalModules[e]}function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;return e==t||!!o[e]&&(o[e].includes(t)||o[e].some((function(e){return!r.has(e)&&f(e,t,new Set([].concat(_toConsumableArray(r),_toConsumableArray(o[e]))))})))}for(var p=n.length;p--;){if(u(t=n[p]))a.push(t);else{var h,g=l(t);if(!f(g+"/index.js",t))continue;if(s[g])s[g].modules.push(t),(h=s[g].deps).push.apply(h,_toConsumableArray(c()));else s[g]={modules:[t],deps:c()}}n.splice(p,1)}var $=n;for(var d in s)s[d].deps=new Set(s[d].deps.filter((function(e){return e!=d})));function b(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.filter((function(e){return"@empty"!=e&&!e.includes("/index.js")})).every((function(e){return r.some((function(t){return t.includes(e)}))}))}n=Object.keys(s);for(var y=[];n.length;){for(var m=1/0,v=[],_=[],w=[],x=0;x<n.length;x++){var k=n[x],S=[].concat(_toConsumableArray(s[k].deps));S.length>m||(S.length===m&&b(S,y,v)?(v.push(k),_.push(x)):(m=S.length,b(S,y,v)&&(v=[k],_=[x])))}if(0==v.length)break;for(x=_.length;x--;){k=n[_[x]];n.splice(_[x],1)}y.push.apply(y,_toConsumableArray(v))}var A,C=n,B=!0,T=!1,E=void 0;try{for(var R,O=y[Symbol.iterator]();!(B=(R=O.next()).done);B=!0){for(A=s[G=R.value].modules;A.length;){for(m=1/0,v=[],_=[],w=[],x=0;x<A.length;x++){k=A[x];var P,N=o[k]||[];if(!(N.length>m))if(N.length===m&&b(N,a,v))v.push(k),_.push(x),(P=w).push.apply(P,_toConsumableArray(i[k]||[]));else m=N.length,b(N,a,v)&&(v=[k],_=[x],w=(i[k]||[]).slice())}if(0==v.length)break;for(x=_.length;x--;){i[k=A[_[x]]]=[],A.splice(_[x],1)}var L=!0,F=!1,j=void 0;try{for(var I,M=w[Symbol.iterator]();!(L=(I=M.next()).done);L=!0){k=I.value;o[k]=o[k].filter((function(e){return!v.includes(e)}))}}catch(e){F=!0,j=e}finally{try{!L&&M.return&&M.return()}finally{if(F)throw j}}a.push.apply(a,_toConsumableArray(v))}a.push.apply(a,_toConsumableArray(A))}}catch(e){T=!0,E=e}finally{try{!B&&O.return&&O.return()}finally{if(T)throw E}}n=$;var D=!0,q=!1,U=void 0;try{for(var W,z=C[Symbol.iterator]();!(D=(W=z.next()).done);D=!0){var H,G=W.value;(H=n).push.apply(H,_toConsumableArray(s[G].modules))}}catch(e){q=!0,U=e}finally{try{!D&&z.return&&z.return()}finally{if(q)throw U}}for(;n.length;){for(m=1/0,v=[],_=[],w=[],x=0;x<n.length;x++){k=n[x];var X,J=o[k]||[];if(!(J.length>m))if(J.length===m&&b(J,a,v))v.push(k),_.push(x),(X=w).push.apply(X,_toConsumableArray(i[k]||[]));else m=J.length,b(J,a,v)&&(v=[k],_=[x],w=(i[k]||[]).slice())}if(0==v.length)break;for(x=_.length;x--;){i[k=n[_[x]]]=[],n.splice(_[x],1)}var K=!0,V=!1,Y=void 0;try{for(var Z,Q=w[Symbol.iterator]();!(K=(Z=Q.next()).done);K=!0){k=Z.value;o[k]=o[k].filter((function(e){return!v.includes(e)}))}}catch(e){V=!0,Y=e}finally{try{!K&&Q.return&&Q.return()}finally{if(V)throw Y}}a.push.apply(a,_toConsumableArray(v))}var ee=[];for(var te in a)(o[te]||[]).length&&ee.push(te);return console.log("async modules due to preserved module structures: ",[].concat(ee,_toConsumableArray(n))),[a,n]},initializeClass:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments[5],s=arguments[6];if(void 0===r)throw Error("Superclass can not be undefined!");return e.System.initializeClass._get=e.lively.classes.runtime.initializeClass._get,e.System.initializeClass._set=e.lively.classes.runtime.initializeClass._set,lively.classes.runtime.initializeClass(t,r,n,o,i,a,s)},prepareGlobal:function(t,r,n,i){var s,c=e.define;if(e.define=void 0,n)for(var u in s={},n)s[u]=e[u],e[u]=n[u];return r||(o={},a((function(e,t){o[e]=t}))),function(){var t,n=r?l(r):{},u=!!r;if(r&&!i||a((function(a,s){o[a]!==s&&void 0!==s&&(i&&(e[a]=void 0),r||(n[a]=s,void 0!==t?u||t===s||(u=!0):t=s))})),n=u?n:t,s)for(var f in s)e[f]=s[f];return e.define=c,n}},recorderFor:function(e){var t={};return(this.registry[e]=this.registry[e]||{recorder:t,exports:t}).recorder},load:function(e){for(var t=this,r=this.sortForLoad(e),n=_slicedToArray(r,2),o=n[0],i=n[1],a=this.computeUniqDepGraphs().inverseDepGraph,s=[].concat(_toConsumableArray(o),_toConsumableArray(i)),l=function(e){(a[e.id]||[]).forEach((function(r){var n=t.get(r);try{t.updateDependent(e,n)}catch(t){e.executed=!1}}))},c=function(e){var r=!0,n=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value,c=t.get(s);if(c&&!c.executed){c.executed=!0;try{t.updateImports(c),c.execute()}catch(e){c.executed=!1}l(c)}}}catch(e){n=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(n)throw o}}},u=0;s.some((function(e){return t.get(e)&&!t.get(e).executed}))&&u<5;u++)c(s);return this.get(e).exports}},e.loadCompiledFrozenPart=e.lively.FreezerRuntime.loadObjectFromPartsbinFolder.bind(e.lively.FreezerRuntime)}();var G="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this;G.System||(G.System=G.lively.FreezerRuntime);var runtime=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new B(n||[]);return i._invoke=function(e,t,r){var n=f;return function(o,i){if(n===h)throw new Error("Generator is already running");if(n===g){if("throw"===o)throw i;return E()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=S(a,r);if(s){if(s===$)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var l=u(e,t,r);if("normal"===l.type){if(n=r.done?g:p,l.arg===$)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=g,r.method="throw",r.arg=l.arg)}}}(e,r,a),i}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f="suspendedStart",p="suspendedYield",h="executing",g="completed",$={};function d(){}function b(){}function y(){}var m={};m[i]=function(){return this};var v=Object.getPrototypeOf,_=v&&v(v(T([])));_&&_!==r&&n.call(_,i)&&(m=_);var w=y.prototype=d.prototype=Object.create(m);function x(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(o,i,a,s){var l=u(e[o],e,i);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"===_typeof2(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(f).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function S(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method))return $;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return $}var o=u(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,$;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,$):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,$)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function T(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:E}}function E(){return{value:t,done:!0}}return b.prototype=w.constructor=y,y.constructor=b,b.displayName=l(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,s,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},x(k.prototype),k.prototype[a]=function(){return this},e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(w),l(w,s,"Generator"),w[i]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=T,B.prototype={constructor:B,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,$):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),$},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),$}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),$}},e}("object"===("undefined"==typeof module?"undefined":_typeof2(module))?module.exports:{});try{regeneratorRuntime=runtime}catch(e){Function("r","regeneratorRuntime = r")(runtime)}var fs=require("fs"),_missingExportShim,show,System,require,timing,lively,Namespace,localStorage,babelPluginTransformJsx={},GLOBAL=void 0!==System?System.global:"undefined"!=typeof window?window:global,features={from:!!Array.from,filter:!!Array.prototype.filter,find:!!Array.prototype.find,findIndex:!!Array.prototype.findIndex,includes:!!Array.prototype.includes},from=features.from?Array.from:function(e){if(!e)return[];if(Array.isArray(e))return e;if(e.toArray)return e.toArray();for(var t=e.length,r=new Array(t);t--;)r[t]=e[t];return r};function filter(e,t,r){for(var n=[],o=0;o<e.length;o++){var i=e[o];t.call(r,i)&&n.push(i)}return n}var detect=features.find?function(e,t,r){return e.find(t,r)}:function(e,t,r){for(var n,o=0,i=e.length;o<i;o++)if(n=e[o],t.call(r,n,o))return n},findIndex=features.findIndex?function(e,t,r){return e.findIndex(t,r)}:function(e,t,r){var n=-1;return e.find((function(e,o){return n=o,t.call(e,r)}))?n:-1},includes=features.includes?function(e,t){return e.includes(t)}:function(e,t){return-1!==e.indexOf(t)};function deepEquals(e,t){var r=e.length;if(!t||r!==t.length)return!1;for(var n=0;n<r;n++)if(!equals(e[n],t[n]))return!1;return!0}function argumentNames(e){if(e.superclass)return[];var t=e.toString(),r="",n=t.match(/(?:\(([^\)]*)\)|([^\(\)-+!]+))\s*=>/);if(n)r=n[1]||n[2]||"";else{var o=t.match(/^[\s\(]*function[^(]*\(([^)]*)\)/);o&&o[1]&&(r=o[1])}return r.replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",").map((function(e){return e.trim()})).filter((function(e){return!!e}))}function print(e){if(e&&Array.isArray(e))return"["+e.map(print)+"]";if("string"!=typeof e)return String(e);var t=String(e);return t='"'+(t=(t=t.replace(/\n/g,"\\n\\\n")).replace(/(")/g,"\\$1"))+'"'}function indent(e,t,r){if(!r||r<=0)return e;for(;r>0;)r--,e=t+e;return e}features.from||(Array.from=from),features.filter||(Array.prototype.filter=function(e,t){return filter(this,e,t)}),features.find||(Array.prototype.find=function(e,t){return detect(this,e,t)}),features.findIndex||(Array.prototype.findIndex=function(e,t){return findIndex(this,e,t)}),features.includes||(Array.prototype.includes=function(e){return includes(this,e)});var getOwnPropertyDescriptors="function"==typeof Object.getOwnPropertyDescriptors?Object.getOwnPropertyDescriptors:function(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&Object.defineProperty(t,r,{configurable:!0,enumerable:!0,writable:!0,value:Object.getOwnPropertyDescriptor(e,r)});return t};function equals(e,t){if(e===t)return!0;if(!e||!t)return e==t;if(Array.isArray(e))return deepEquals(e,t);switch(e.constructor){case String:case Date:case Boolean:case Number:return e==t}if("function"==typeof e.isEqualNode)return e.isEqualNode(t);if("function"==typeof e.equals)return e.equals(t);var r=[];for(var n in e)if(r.push(n),"function"!=typeof e[n]&&!equals(e[n],t[n]))return!1;for(var n in t)if(-1===r.indexOf(n)&&"function"!=typeof t[n]&&!equals(t[n],e[n]))return!1;return!0}function dissoc(e,t){for(var r=getOwnPropertyDescriptors(e=e||{}),n=0;n<t.length;n++)t[n]in r&&delete r[t[n]];return Object.defineProperties({},r)}function inspect(e,t,r){if(r=r||0,(t=t||{}).customPrinter){var n=t._ignoreSignal||(t._ignoreSignal={}),o=t.customPrinter(e,n,(function(e){return inspect(e,t,r+1)}));if(o!==n)return o}if(!e)return print(e);if("function"==typeof e)return t.printFunctionSource?String(e):"function"+(e.name?" "+e.name:"")+"("+argumentNames(e).join(",")+") {/*...*/}";switch(e.constructor){case String:case Boolean:case RegExp:case Number:return print(e)}if("function"==typeof e.serializeExpr)return e.serializeExpr();var i=e&&Array.isArray(e),a=i?"[":"{",s=i?"]":"}";if(t.maxDepth&&r>=t.maxDepth)return a+"/*...*/"+s;var l=[];if(i)l=e.map((function(e){return inspect(e,t,r+1)}));else for(var c=Object.keys(e).sort((function(t,r){var n="function"==typeof e[t];return n===("function"==typeof e[r])?t<r?-1:t>r?1:0:n?1:-1})),u=0;u<c.length;u++){if(u>(t.maxNumberOfKeys||1/0)){var f=c.length-u;l.push("...".concat(f," hidden ").concat(f>1?"entries":"entry","..."));break}var p=c[u];i&&inspect(e[p],t,r+1);var h=inspect(e[p],t,r+1);l.push((t.escapeKeys?JSON.stringify(p):p)+": "+h)}if(0===l.length)return a+s;var g=l.join(", "),$=(!i||t.newLineInArrays)&&(!t.minLengthForNewLine||g.length>=t.minLengthForNewLine),d=indent("",t.indent||"  ",r),b=indent("",t.indent||"  ",r+1),y=$&&!i?"\n"+b:"",m=$?"\n"+b:"",v=$&&!i?"\n"+d:"";return $&&(g=l.join(","+m)),a+y+g+v+s}var newUUIDTemplate="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",newUUIDRe=/[xy]/g,newUUIDReplacer=function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)};function newUUID(){return newUUIDTemplate.replace(newUUIDRe,newUUIDReplacer).toUpperCase()}function backoff(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e4,n=Math.min(r,t*Math.pow(2,e)),o=n/2+Math.round(Math.random()*(n/2));return Math.min(r,t+Math.random()*(3*o-t))}function promise(e){return"function"==typeof e?promise.convertCallbackFun(e):Promise.resolve(e)}function delay(e,t){return new Promise((function(r){return setTimeout(r,e,t)}))}function delayReject(e,t){return new Promise((function(r,n){return setTimeout(n,e,t)}))}function timeout(e,t){return new Promise((function(r,n){var o=!1;setTimeout((function(){return!o&&(o=!0)&&n(new Error("Promise timed out"))}),e),t.then((function(e){return!o&&(o=!0)&&r(e)}),(function(e){return!o&&(o=!0)&&n(e)}))}))}function waitFor(e,t,r){return"function"==typeof e&&(t=e,e=void 0),new Promise((function(n,o){var i,a,s=!1,l=!1,c=function(e){clearInterval(e)},u=setInterval((function(){if(s)return c(u);try{a=t()}catch(e){i=e}return a||i||l?(s=!0,c(u),i?o(i):l?void 0===r?o(new Error("timeout")):n(r):n(a)):void 0}),10);"number"==typeof e&&setTimeout((function(){return l=!0}),e)}))}function deferred(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return{resolve:e,reject:t,promise:r}}function convertCallbackFun(e){return function(){var t=Array.from(arguments),r=this;return new Promise((function(n,o){t.push((function(e,t){return e?o(e):n(t)})),e.apply(r,t)}))}}function convertCallbackFunWithManyArgs(e){return function(){var t=Array.from(arguments),r=this;return new Promise((function(n,o){t.push((function(){var e=Array.from(arguments),t=e.shift();return t?o(t):n(e)})),e.apply(r,t)}))}}function _chainResolveNext(e,t,r,n,o){var i=e.shift();if(i)try{Promise.resolve(i(t,r)).then((function(t){return _chainResolveNext(e,t,r,n,o)})).catch((function(e){o(e)}))}catch(e){o(e)}else n(t)}function chain(e){return new Promise((function(t,r){return _chainResolveNext(e.slice(),void 0,{},t,r)}))}function promise_finally(e,t){return Promise.resolve(e).then((function(e){try{t()}catch(e){console.error("Error in promise finally: "+e.stack||e)}return e})).catch((function(e){try{t()}catch(e){console.error("Error in promise finally: "+e.stack||e)}throw e}))}function parallel(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(!e.length)return Promise.resolve([]);var r,n,o=[],i=null,a=0,s=e.length;return new Promise((function(e,t){r=function(){return e(o)},n=function(e){return t(i=e)},c()}));function l(){t--;try{var i=a++;e[i]().then((function(e){t++,o[i]=e,0==--s?r():c()})).catch((function(e){return n(e)}))}catch(e){n(e)}}function c(){for(;!i&&s>0&&a<e.length&&t>0;)l()}}function Path(e,t){return e instanceof Path?e:this instanceof Path?(this.setSplitter(t||"."),void this.fromPath(e)):new Path(e,t)}Object.assign(promise,{delay:delay,delayReject:delayReject,timeout:timeout,waitFor:waitFor,deferred:deferred,convertCallbackFun:convertCallbackFun,convertCallbackFunWithManyArgs:convertCallbackFunWithManyArgs,chain:chain,finally:promise_finally,parallel:parallel}),Object.assign(Path.prototype,{get isPathAccessor(){return!0},fromPath:function(e){return"string"==typeof e&&""!==e&&e!==this.splitter?(this._parts=e.split(this.splitter),this._path=e):Array.isArray(e)?(this._parts=[].concat(e),this._path=e.join(this.splitter)):(this._parts=[],this._path=""),this},setSplitter:function(e){return e&&(this.splitter=e),this},map:function(e){return this._mapper=e,this},parts:function(){return this._parts},size:function(){return this._parts.length},slice:function(e,t){return Path(this.parts().slice(e,t))},normalizePath:function(){return this._path},isRoot:function(e){return 0===this._parts.length},isIn:function(e){if(this.isRoot())return!0;var t=this.get(e,-1);return t&&t.hasOwnProperty(this._parts[this._parts.length-1])},equals:function(e){return e&&e.isPathAccessor&&this.parts().equals(e.parts())},isParentPathOf:function(e){e=e&&e.isPathAccessor?e:Path(e);for(var t=this.parts(),r=e.parts(),n=0;n<t.length;n++)if(t[n]!=r[n])return!1;return!0},relativePathTo:function(e){return e=Path(e),this.isParentPathOf(e)?e.slice(this.size(),e.size()):void 0},del:function(e){if(this.isRoot())return!1;for(var t=e,r=0;r<this._parts.length-1;r++){var n=this._parts[r];if(!t.hasOwnProperty(n))return!1;t=t[n]}return delete t[this._parts[this._parts.length-1]]},withParentAndKeyDo:function(e,t,r){if(this.isRoot())return r(null,null);for(var n=e,o=0;o<this._parts.length-1;o++){var i=this._parts[o];if(!n.hasOwnProperty(i)||"object"!==_typeof2(n[i])&&"function"!=typeof n[i]){if(!t)return r(null,i);n=n[i]={}}else n=n[i]}return r(n,this._parts[this._parts.length-1])},set:function(e,t,r){return this.withParentAndKeyDo(e,r,(function(e,r){return e?e[r]=t:void 0}))},defineProperty:function(e,t,r){return this.withParentAndKeyDo(e,r,(function(e,r){return e?Object.defineProperty(e,r,t):void 0}))},get:function(e,t){var r=t?this._parts.slice(0,t):this._parts,n=this;return r.reduce((function(e,t){return e?n._mapper?n._mapper(t,e[t]):e[t]:e}),e)},concat:function(e,t){return Path(this.parts().concat(Path(e,t).parts()))},toString:function(){return this.normalizePath()},serializeExpr:function(){return"lively.lang.Path("+inspect(this.parts())+")"},watch:function(e){if(e&&!this.isRoot()){var t=e.target,r=this.get(t,-1),n=this.parts().slice(-1)[0],o="propertyWatcher$"+n,i=r&&r.hasOwnProperty(o),a=e.uninstall,s=(e.haltWhenChanged,e.showStack),l=r.__lookupGetter__(n),c=r.__lookupSetter__(n);if(t&&n&&r)if(a){if(!i)return;delete r[n],r[n]=r[o],delete r[o];var u="Watcher for "+r+"."+n+" uninstalled"}else if(i)u="Watcher for "+r+"."+n+" already installed";else if(l||c){u=r+'["'+n+'"] is a getter/setter, watching not support';console.log(u)}else{r[o]=r[n],r.__defineSetter__(n,(function(t){var i=r[o];e.onSet&&e.onSet(t,i);var a=r+"."+n+" changed: "+i+" -> "+t;return s&&(a+="\n"+(void 0!==lively?lively.printStack():console.trace())),e.verbose&&console.log(a),r[o]=t})),r.__defineGetter__(n,(function(){return e.onGet&&e.onGet(r[o]),r[o]}));u="Watcher for "+r+"."+n+" installed";console.log(u)}}},debugFunctionWrapper:function(e){var t=e.target,r=this.get(t,-1),n=this.parts().slice(-1)[0],o=e.uninstall,i=(void 0===e.haltWhenChanged||e.haltWhenChanged,e.showStack,r&&n&&r[n]),a=i&&i.isDebugFunctionWrapper;if(t&&n&&i&&r)if(o){if(!a)return;r[n]=r[n].debugTargetFunction;var s="Uninstalled debugFunctionWrapper for "+r+"."+n;console.log(s)}else if(a){s="debugFunctionWrapper for "+r+"."+n+" already installed";console.log(s)}else{var l=r[n]=i.wrap((function(e){var t=Array.from(arguments);return t.shift().apply(r,t)}));l.isDebugFunctionWrapper=!0,l.debugTargetFunction=i;s="debugFunctionWrapper for "+r+"."+n+" installed";console.log(s)}}});var GLOBAL$1=void 0!==System?System.global:"undefined"!=typeof window?window:global,isNode="undefined"!=typeof process&&process.versions&&process.versions.node,makeEmitter=isNode?function(e,t){if(e.on&&e.removeListener)return e;var r=void 0!==System?System._nodeRequire("events"):require("events");return Object.assign(e,r.EventEmitter.prototype),r.EventEmitter.call(e),t&&t.maxListenerLimit&&e.setMaxListeners(t.maxListenerLimit),e}:function(e){return e.on&&e.removeListener||(e.listeners={},e.on=function(t,r){r&&(e.listeners[t]||(e.listeners[t]=[]),e.listeners[t].push(r))},e.once=function(t,r){r&&e.on(t,(function n(){e.removeListener(t,n),r.apply(this,arguments)}))},e.removeListener=function(t,r){e.listeners[t]&&(e.listeners[t]=e.listeners[t].filter((function(e){return e!==r})))},e.removeAllListeners=function(t){e.listeners[t]&&(e.listeners[t]=[])},e.emit=function(){var t=Array.prototype.slice.call(arguments),r=t.shift(),n=e.listeners[r];n&&n.length&&n.forEach((function(e){try{e.apply(null,t)}catch(e){console.error("Error in event handler: %s",e.stack||String(e))}}))}),e},isNode$1="undefined"!=typeof process&&process.env&&"function"==typeof process.exit;function nyi(e){throw new Error("Not yet implemented: ".concat(e))}var debugMessageOrder=!1,L2LConnection=function(){function e(t){_classCallCheck(this,e),this.id=newUUID(),this.actions={},this.options={ackTimeout:3500,debug:!1},this._incomingOrderNumberingBySenders=new Map,this._outgoingOrderNumberingByTargets=new Map,this._outOfOrderCacheBySenders=new Map}var t,r;return _createClass(e,[{key:"isOnline",value:function(){nyi("isOnline")}},{key:"open",value:function(){nyi("open")}},{key:"close",value:function(){nyi("close")}},{key:"remove",value:function(){nyi("remove")}},{key:"whenOnline",value:function(e){var t=this;return promise.waitFor(e,(function(){return t.isOnline()})).then((function(){return t})).catch((function(e){return Promise.reject(/timeout/i.test(String(e))?new Error("Timeout in ".concat(t,".whenOnline")):e)}))}},{key:"onError",value:function(e){this.debug&&console.log("[".concat(this,"] error: ").concat(e))}},{key:"removeService",value:function(e){delete this.actions[e]}},{key:"removeServices",value:function(e){var t=this;e.forEach((function(e){return t.removeService(e)}))}},{key:"addService",value:function(e,t){this.actions[e]=t}},{key:"addServices",value:function(e){var t=this;Object.keys(e).forEach((function(r){return t.addService(r,e[r])}))}},{key:"ping",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,n,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Date.now(),e.next=3,this.sendToAndWait(t,"l2l-ping",{timestamp:r});case 3:return n=e.sent,o=n.data.timestamp,i=Date.now(),e.abrupt("return",{to:o-r,from:i-o,roundtrip:i-r});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"send",value:function(e,t){nyi("send")}},{key:"sendAndWait",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,n,o,i,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new Promise((function(e,r){return a.send(t,e)})),n={},o=this.options.ackTimeout+400,"ackTimeout"in t&&(o=!t.ackTimeout||t.ackTimeout<0?null:t.ackTimeout+400),!o){e.next=8;break}return e.next=5,Promise.race([promise.delay(o,n),r]);case 5:i=e.sent,e.next=11;break;case 8:return e.next=10,r;case 10:i=e.sent;case 11:if(i!==n){e.next=13;break}throw new Error("Timeout sending ".concat(t.action));case 13:return e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"sendTo",value:function(e,t,r,n){return this.send({target:e,action:t,data:r},n)}},{key:"sendToAndWait",value:function(e,t,r,n){return this.sendAndWait(_objectSpread({target:e,action:t,data:r},n))}},{key:"prepareSend",value:function(e,t){var r=e.target,n=e.action,o=e.messageId,i=(e.data,e.sender);if(!n)throw new Error("Trying to send a message without specifying action!");if(!r)throw new Error("Trying to send message ".concat(n," without specifying target!"));o||(e.messageId=newUUID()),i||(e.sender=this.id);var a=e.n=this._outgoingOrderNumberingByTargets.get(r)||0;if(this._outgoingOrderNumberingByTargets.set(r,a+1),"function"==typeof t){i=this;var s=t;t=function(e){var t=i._incomingOrderNumberingBySenders.get(e.sender)||0;i.debug&&debugMessageOrder&&console.log("[MSG ORDER] ".concat(i," received ack for ").concat(e.action," as msg ").concat(t));try{s.apply(null,arguments)}catch(e){console.error("Error in ack fn of ".concat(i,": ").concat(e.stack))}i._incomingOrderNumberingBySenders.set(e.sender,t+1),setTimeout((function(){return i.invokeOutOfOrderMessages(e.sender)}),0)}}return this.debug&&debugMessageOrder&&console.log("[MSG ORDER] ".concat(this," sending ").concat(a," (").concat(e.action,") to ").concat(r)),[e,t]}},{key:"prepareAnswerMessage",value:function(e,t){return{action:e.action+"-response",inResponseTo:e.messageId,target:e.sender,data:t,sender:this.id}}},{key:"installEventToMessageTranslator",value:function(e){var t=this,r=e.onevent;e.onevent=function(e){var t=e.data||[];r.call(this,e),e.data=["*"].concat(t),r.call(this,e)},e.on("*",(function(r,n){r&&"object"===_typeof2(r)&&r.action&&(r=(n=r).action);var o=arguments[arguments.length-1],i="function"==typeof o?o:null;if(!(n=n===i?null:n)||!n.data||"number"!=typeof n.n&&!n.broadcast||!n.sender)return console.warn("".concat(t," received non-conformant message ").concat(r,":"),arguments),void("function"==typeof i&&i({data:{error:"invalid l2l message"}}));t.receive(n,e,i)}))}},{key:"receive",value:function(e,t,r){this.dispatchL2LMessageToSelf(e,t,r)}},{key:"dispatchL2LMessageToSelf",value:function(e,t,r){var n=this,o=e.action;if(e.broadcast)this.safeInvokeServiceHandler(o,e,r,t);else try{var i=this._incomingOrderNumberingBySenders.get(e.sender)||0,a="register"===o||"unregister";if(!a&&e.n<i)return void console.error("[MSG ORDER] [".concat(this,"] received message no. ").concat(e.n," but expected >= ").concat(i,", dropping ").concat(o));if(!a&&e.n>i){this.debug&&debugMessageOrder&&console.log("[MSG ORDER] [".concat(this,"] storing out of order message ").concat(o," (").concat(e.n,") for later invocation"));var s=this._outOfOrderCacheBySenders.get(e.sender);return s||(s=[],this._outOfOrderCacheBySenders.set(e.sender,s)),void s.push([o,e,r,t])}this.safeInvokeServiceHandler(o,e,r,t),setTimeout((function(){return n.invokeOutOfOrderMessages(e.sender)}),0)}catch(t){console.error("Error message ordering when handling ".concat(o,": ").concat(t.stack||t)),"function"==typeof r&&r(this.prepareAnswerMessage(e,{isError:!0,error:String(t.stack||t)}))}}},{key:"invokeOutOfOrderMessages",value:function(e){var t=this._outOfOrderCacheBySenders.get(e);if(t&&t.length){var r=this._incomingOrderNumberingBySenders.get(e)||0,n=t.findIndex((function(e){var t=_slicedToArray2(e,2);t[0];return t[1].n===r}));if(-1!==n){t.splice(n,1);var o=t[n];this.invokeServiceHandler.apply(this,o)}}}},{key:"renameTarget",value:function(e,t){if(e!==t){var r=this._outgoingOrderNumberingByTargets.get(e);this._outgoingOrderNumberingByTargets.delete(e),this._outgoingOrderNumberingByTargets.set(t,r)}}},{key:"safeInvokeServiceHandler",value:function(e,t,r,n){try{"function"==typeof this.actions[e]?this.invokeServiceHandler(e,t,r,n):n._events&&Object.keys(n._events).includes(e)||(console.warn("WARNING [".concat(this,"] Unhandled message: ").concat(e)),"function"==typeof r&&r(this.prepareAnswerMessage(t,{isError:!0,error:"message not understood: "+e})))}catch(n){console.error("Error when handling ".concat(e,": ").concat(n.stack||n)),"function"==typeof r&&r(this.prepareAnswerMessage(t,{isError:!0,error:String(n.stack||n)}))}}},{key:"invokeServiceHandler",value:function(e,t,r,n){var o=this;if(this.debug&&debugMessageOrder&&console.log("[MSG ORDER] ".concat(this," received ").concat(t.n," (").concat(t.action,") from ").concat(t.sender)),this._incomingOrderNumberingBySenders.set(t.sender,t.n+1),"function"==typeof r){var i=!1,a=!1,s="ackTimeout"in t?t.ackTimeout:this.options.ackTimeout,l=this._outgoingOrderNumberingByTargets.get(t.sender)||0;this._outgoingOrderNumberingByTargets.set(t.sender,l+1);var c=function(e){a?console.warn("[".concat(o,"] ackFn for ").concat(t.action," called after it timed out, dropping answer!")):i?console.warn("[".concat(o,"] ack function called repeatedly when handling ").concat(t.action)):(i=!0,r(o.prepareAnswerMessage(t,e)),o.debug&&debugMessageOrder&&console.log("[MSG ORDER] ".concat(o," sending ").concat(l," (ack for ").concat(t.action,")")))};s&&setTimeout((function(){i||(c({isError:!0,error:"Timeout error: ".concat(o," did not send answer for ").concat(t.action," after ").concat(s,"ms")}),a=!0)}),s)}try{this.actions[e].call(this,this,t,c,n)}catch(t){console.error("[".concat(this,"] Error handling ").concat(e,": ").concat(t.stack||t)),c&&c({error:t.stack})}}},{key:"debug",get:function(){return this.options.debug},set:function(e){this.options.debug=e}}]),e}(),defaultActions={"l2l-ping":function(e,t,r,n){var o=t.sender,i=t.data.timestamp,a=Date.now();"function"==typeof r&&r({timestamp:a}),e.debug&&console.log("[".concat(void 0,"] got ping from ").concat(o,", time: ").concat(a-i,"ms"))},"remote-eval":function remoteEval(tracker,_ref4,ackFn,socket){var sender=_ref4.sender,source=_ref4.data.source;Promise.resolve().then((function(){return eval(source)})).then((function(e){return ackFn({value:e})})).catch((function(e){e.originalErr&&(e=e.originalErr),console.error("eval error: "+e),"function"==typeof ackFn&&ackFn({isError:!0,value:String(e.stack||e)})}))},"remote-eval-2":function remoteEval2(tracker,_ref5,ackFn,socket){var sender=_ref5.sender,source=_ref5.data.source;Promise.resolve().then((function(){var result=eval(source);if(!(result instanceof Promise))throw console.error("unexpected eval result:"+result),new Error("unexpected eval result:"+result);return result})).then((function(e){return ackFn(e)})).catch((function(e){console.error("eval error: "+e),e.originalErr&&(e=e.originalErr),"function"==typeof ackFn&&ackFn({isError:!0,value:String(e.stack||e)})}))}},defaultClientActions={getRoomList:function(e){return _asyncToGenerator(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.client,n=e.ackFn,o=r._socketioClient.rooms,n(o);case 3:case"end":return t.stop()}}),t)})))()},"ask for":function(e,t,r,n){var o=this;return _asyncToGenerator(regeneratorRuntime.mark((function n(){var i,a,s,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.sender,a=t.data.query,s=a.match(/password|sudo/i)?"passwordPrompt":"prompt",n.next=4,$world[s](a);case 4:l=n.sent,"function"==typeof r&&r({answer:l}),e.debug&&console.log("[".concat(o,"] message 'ask for' from ").concat(i,", query: ").concat(a));case 7:case"end":return n.stop()}}),n)})))()},"open editor":function(e,t,r,n){return _asyncToGenerator(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.sender,(n=t.data.args).length){e.next=4;break}return r({error:"no file specified"}),e.abrupt("return");case 4:return e.next=6,$world.execCommand("open file for EDITOR",{url:n[0]});case 6:o=e.sent,"function"==typeof r&&r("aborted"===o?{error:String(o)}:{status:o});case 8:case"end":return e.stop()}}),e)})))()},changeWorkingDirectory:function(e,t,r,n){return _asyncToGenerator(regeneratorRuntime.mark((function e(){var n,o,i,a,s,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.sender,n=t.data.args,o=_slicedToArray2(n||[],2),i=o[0],a=o[1],s="OK";try{i?a?(l=$world.getMorphWithId(a))&&(l.__lookupSetter__("cwd")?l.cwd=i:"function"==typeof l.changeWorkingDirectory?l.changeWorkingDirectory(i):"function"==typeof l.pluginFind?(c=l.pluginFind((function(e){return e.isShellEditorPlugin})))&&(c.cwd=i):s="[changeWorkingDirectory] cannot figure pout how to set dir"):s="[changeWorkingDirectory] No command morph":s="[changeWorkingDirectory] No directory received"}catch(e){s=String(e)}"OK"!==s&&console.warn(s),"function"==typeof r&&r(s);case 6:case"end":return e.stop()}}),e)})))()}},exports$1={},re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function pathNames(e,t){var r=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.substr(0,1)&&0!==t.length||r.splice(0,1),"/"==t.substr(t.length-1,1)&&r.splice(r.length-1,1),r}function queryKey(e,t){var r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(r[t]=n)})),r}exports$1=function(e){var t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));for(var o=re.exec(e||""),i={},a=14;a--;)i[parts[a]]=o[a]||"";return-1!=r&&-1!=n&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=pathNames(i,i.path),i.queryKey=queryKey(i,i.query),i};var exports$1$1=exports$1,exports$2={},s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;function parse(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*y;case"days":case"day":case"d":return r*d;case"hours":case"hour":case"hrs":case"hr":case"h":return r*h;case"minutes":case"minute":case"mins":case"min":case"m":return r*m;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function fmtShort(e){return e>=d?Math.round(e/d)+"d":e>=h?Math.round(e/h)+"h":e>=m?Math.round(e/m)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function fmtLong(e){return plural(e,d,"day")||plural(e,h,"hour")||plural(e,m,"minute")||plural(e,s,"second")||e+" ms"}function plural(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}exports$2=function(e,t){t=t||{};var r=_typeof2(e);if("string"===r&&e.length>0)return parse(e);if("number"===r&&!1===isNaN(e))return t.long?fmtLong(e):fmtShort(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};var exports$1$2=exports$2,_global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$3={};function selectColor(e){var t,r=0;for(t in e)r=(r<<5)-r+e.charCodeAt(t),r|=0;return exports$3.colors[Math.abs(r)%exports$3.colors.length]}function createDebug(e){var t;function r(){if(r.enabled){var e=r,n=+new Date,o=n-(t||n);e.diff=o,e.prev=t,e.curr=n,t=n;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=exports$3.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var s=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(t,r){if("%%"===t)return t;s++;var n=exports$3.formatters[r];if("function"==typeof n){var o=i[s];t=n.call(e,o),i.splice(s,1),s--}return t})),exports$3.formatArgs.call(e,i);var l=r.log||exports$3.log||console.log.bind(console);l.apply(e,i)}}return r.namespace=e,r.enabled=exports$3.enabled(e),r.useColors=exports$3.useColors(),r.color=selectColor(e),r.destroy=destroy,"function"==typeof exports$3.init&&exports$3.init(r),exports$3.instances.push(r),r}function destroy(){var e=exports$3.instances.indexOf(this||_global);return-1!==e&&(exports$3.instances.splice(e,1),!0)}function enable(e){var t;exports$3.save(e),exports$3.names=[],exports$3.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length;for(t=0;t<n;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?exports$3.skips.push(new RegExp("^"+e.substr(1)+"$")):exports$3.names.push(new RegExp("^"+e+"$")));for(t=0;t<exports$3.instances.length;t++){var o=exports$3.instances[t];o.enabled=exports$3.enabled(o.namespace)}}function disable(){exports$3.enable("")}function enabled(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=exports$3.skips.length;t<r;t++)if(exports$3.skips[t].test(e))return!1;for(t=0,r=exports$3.names.length;t<r;t++)if(exports$3.names[t].test(e))return!0;return!1}function coerce(e){return e instanceof Error?e.stack||e.message:e}exports$3=exports$3=createDebug.debug=createDebug.default=createDebug,exports$3.coerce=coerce,exports$3.disable=disable,exports$3.enable=enable,exports$3.enabled=enabled,exports$3.humanize=exports$1$2,exports$3.instances=[],exports$3.names=[],exports$3.skips=[],exports$3.formatters={};var _debug=exports$3,e,t,n,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,o=e={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this||r,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:u}catch(e){n=u}}();var l,s$1=[],f=!1,a=-1;function h$1(){f&&l&&(f=!1,l.length?s$1=l.concat(s$1):a=-1,s$1.length&&d$1())}function d$1(){if(!f){var e=c(h$1);f=!0;for(var t=s$1.length;t;){for(l=s$1,s$1=[];++a<t;)l&&l[a].run();a=-1,t=s$1.length}l=null,f=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===u||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this||r,e)}}}(e)}}function m$1(e,t){(this||r).fun=e,(this||r).array=t}function p(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];s$1.push(new m$1(e,t)),1!==s$1.length||f||c(d$1)},m$1.prototype.run=function(){(this||r).fun.apply(null,(this||r).array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0};var T=e,addListener=T.addListener,argv=T.argv,binding=T.binding,browser=T.browser,chdir=T.chdir,cwd=T.cwd,emit=T.emit,env=T.env,listeners=T.listeners,nextTick=T.nextTick,off=T.off,on=T.on,once=T.once,prependListener=T.prependListener,prependOnceListener=T.prependOnceListener,removeAllListeners=T.removeAllListeners,removeListener=T.removeListener,title=T.title,umask=T.umask,version=T.version,versions=T.versions,_global$1="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$4={},process$1=T;function useColors(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function formatArgs(e){var t=(this||_global$1).useColors;if(e[0]=(t?"%c":"")+(this||_global$1).namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+exports$4.humanize((this||_global$1).diff),t){var r="color: "+(this||_global$1).color;e.splice(1,0,r,"color: inherit");var n=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(o=n))})),e.splice(o,0,r)}}function log(){return"object"===("undefined"==typeof console?"undefined":_typeof2(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(e){try{null==e?exports$4.storage.removeItem("debug"):exports$4.storage.debug=e}catch(e){}}function load(){var e;try{e=exports$4.storage.debug}catch(e){}return!e&&void 0!==process$1&&"env"in process$1&&(e=process$1.env.DEBUG),e}function localstorage(){try{return window.localStorage}catch(e){}}exports$4=exports$4=_debug,exports$4.log=log,exports$4.formatArgs=formatArgs,exports$4.save=save,exports$4.load=load,exports$4.useColors=useColors,exports$4.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:localstorage(),exports$4.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],exports$4.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},exports$4.enable(load());var exports$1$3=exports$4,storage=exports$4.storage,colors=exports$4.colors,coerce$1=exports$4.coerce,disable$1=exports$4.disable,enable$1=exports$4.enable,enabled$1=exports$4.enabled,humanize=exports$4.humanize,instances=exports$4.instances,names=exports$4.names,skips=exports$4.skips,formatters=exports$4.formatters,_log=exports$4.log,_formatArgs=exports$4.formatArgs,_save=exports$4.save,_load=exports$4.load,_useColors=exports$4.useColors,_global$2="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$5={};function Emitter(e){if(e)return mixin(e)}function mixin(e){for(var t in Emitter.prototype)e[t]=Emitter.prototype[t];return e}exports$5=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(e,t){return(this||_global$2)._callbacks=(this||_global$2)._callbacks||{},((this||_global$2)._callbacks["$"+e]=(this||_global$2)._callbacks["$"+e]||[]).push(t),this||_global$2},Emitter.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this||_global$2,arguments)}return r.fn=t,this.on(e,r),this||_global$2},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(e,t){if((this||_global$2)._callbacks=(this||_global$2)._callbacks||{},0==arguments.length)return(this||_global$2)._callbacks={},this||_global$2;var r,n=(this||_global$2)._callbacks["$"+e];if(!n)return this||_global$2;if(1==arguments.length)return delete(this||_global$2)._callbacks["$"+e],this||_global$2;for(var o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return 0===n.length&&delete(this||_global$2)._callbacks["$"+e],this||_global$2},Emitter.prototype.emit=function(e){(this||_global$2)._callbacks=(this||_global$2)._callbacks||{};for(var t=new Array(arguments.length-1),r=(this||_global$2)._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this||_global$2,t)}return this||_global$2},Emitter.prototype.listeners=function(e){return(this||_global$2)._callbacks=(this||_global$2)._callbacks||{},(this||_global$2)._callbacks["$"+e]||[]},Emitter.prototype.hasListeners=function(e){return!!this.listeners(e).length};var exports$1$4=exports$5,exports$6={},toString={}.toString;exports$6=Array.isArray||function(e){return"[object Array]"==toString.call(e)};for(var exports$1$5=exports$6,r$1={byteLength:function(e){var t=u$1(e),r=t[0],n=t[1];return 3*(r+n)/4-n},toByteArray:function(e){var t,r,n=u$1(e),o=n[0],i=n[1],a=new n$1(function(e,t,r){return 3*(t+r)/4-r}(0,o,i)),s=0,l=i>0?o-4:o;for(r=0;r<l;r+=4)t=e$1[e.charCodeAt(r)]<<18|e$1[e.charCodeAt(r+1)]<<12|e$1[e.charCodeAt(r+2)]<<6|e$1[e.charCodeAt(r+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;return 2===i&&(t=e$1[e.charCodeAt(r)]<<2|e$1[e.charCodeAt(r+1)]>>4,a[s++]=255&t),1===i&&(t=e$1[e.charCodeAt(r)]<<10|e$1[e.charCodeAt(r+1)]<<4|e$1[e.charCodeAt(r+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t),a},fromByteArray:function(e){for(var t,r=e.length,n=r%3,o=[],i=0,a=r-n;i<a;i+=16383)o.push(c$1(e,i,i+16383>a?a:i+16383));return 1===n?(t=e[r-1],o.push(t$1[t>>2]+t$1[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],o.push(t$1[t>>10]+t$1[t>>4&63]+t$1[t<<2&63]+"=")),o.join("")}},t$1=[],e$1=[],n$1="undefined"!=typeof Uint8Array?Uint8Array:Array,o$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a$1=0,h$2=o$1.length;a$1<h$2;++a$1)t$1[a$1]=o$1[a$1],e$1[o$1.charCodeAt(a$1)]=a$1;function u$1(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c$1(e,t,r){for(var n,o,i=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(t$1[(o=n)>>18&63]+t$1[o>>12&63]+t$1[o>>6&63]+t$1[63&o]);return i.join("")}e$1["-".charCodeAt(0)]=62,e$1["_".charCodeAt(0)]=63;var a$1$1={read:function(e,t,r,n,o){var i,a,s=8*o-n-1,l=(1<<s)-1,c=l>>1,u=-7,f=r?o-1:0,p=r?-1:1,h=e[t+f];for(f+=p,i=h&(1<<-u)-1,h>>=-u,u+=s;u>0;i=256*i+e[t+f],f+=p,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=n;u>0;a=256*a+e[t+f],f+=p,u-=8);if(0===i)i=1-c;else{if(i===l)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,n),i-=c}return(h?-1:1)*a*Math.pow(2,i-n)},write:function(e,t,r,n,o,i){var a,s,l,c=8*i-o-1,u=(1<<c)-1,f=u>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,g=n?1:-1,$=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+f>=1?p/l:p*Math.pow(2,1-f))*l>=2&&(a++,l/=2),a+f>=u?(s=0,a=u):a+f>=1?(s=(t*l-1)*Math.pow(2,o),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;e[r+h]=255&s,h+=g,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[r+h]=255&a,h+=g,a/=256,c-=8);e[r+h-g]|=128*$}},e$1$1={},n$1$1=r$1,i$1=a$1$1,o$1$1="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function f$1(e){if(e>2147483647)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,u$1$1.prototype),t}function u$1$1(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return a$2(e)}return s$2(e,t,r)}function s$2(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!u$1$1.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|y$1(e,t),n=f$1(r),o=n.write(e,t);return o!==r&&(n=n.slice(0,o)),n}(e,t);if(ArrayBuffer.isView(e))return p$1(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+_typeof2(e));if(F(e,ArrayBuffer)||e&&F(e.buffer,ArrayBuffer))return c$1$1(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(F(e,SharedArrayBuffer)||e&&F(e.buffer,SharedArrayBuffer)))return c$1$1(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return u$1$1.from(n,t,r);var o=function(e){if(u$1$1.isBuffer(e)){var t=0|l$1(e.length),r=f$1(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||N(e.length)?f$1(0):p$1(e):"Buffer"===e.type&&Array.isArray(e.data)?p$1(e.data):void 0}(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u$1$1.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+_typeof2(e))}function h$1$1(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function a$2(e){return h$1$1(e),f$1(e<0?0:0|l$1(e))}function p$1(e){for(var t=e.length<0?0:0|l$1(e.length),r=f$1(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function c$1$1(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,u$1$1.prototype),n}function l$1(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function y$1(e,t){if(u$1$1.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||F(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+_typeof2(e));var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return _(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(e).length;default:if(o)return n?-1:_(e).length;t=(""+t).toLowerCase(),o=!0}}function g(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return S(this,t,r);case"latin1":case"binary":return R(this,t,r);case"base64":return T$1(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function w(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function d$2(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),N(r=+r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=u$1$1.from(t,n)),u$1$1.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,o){var i,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var u=-1;for(i=r;i<s;i++)if(c(e,i)===c(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===l)return u*a}else-1!==u&&(i-=i-u),u=-1}else for(r+l>s&&(r=s-l),i=r;i>=0;i--){for(var f=!0,p=0;p<l;p++)if(c(e,i+p)!==c(t,p)){f=!1;break}if(f)return i}return-1}function b(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;n>i/2&&(n=i/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(N(s))return a;e[r+a]=s}return a}function m$2(e,t,r,n){return D(_(t,e.length-r),e,r,n)}function E(e,t,r,n){return D(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function B(e,t,r,n){return E(e,t,r,n)}function A(e,t,r,n){return D(z(t),e,r,n)}function U(e,t,r,n){return D(function(e,t){for(var r,n,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function T$1(e,t,r){return 0===t&&r===e.length?n$1$1.fromByteArray(e):n$1$1.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,a,s,l,c=e[o],u=null,f=c>239?4:c>223?3:c>191?2:1;if(o+f<=r)switch(f){case 1:c<128&&(u=c);break;case 2:128==(192&(i=e[o+1]))&&(l=(31&c)<<6|63&i)>127&&(u=l);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(l=(15&c)<<12|(63&i)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,f=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),o+=f}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}function S(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function R(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function O(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=Y[e[i]];return o}function L(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function x(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function C(e,t,r,n,o,i){if(!u$1$1.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function P(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function k(e,t,r,n,o){return t=+t,r>>>=0,o||P(e,0,r,4),i$1.write(e,t,r,n,23,4),r+4}function M(e,t,r,n,o){return t=+t,r>>>=0,o||P(e,0,r,8),i$1.write(e,t,r,n,52,8),r+8}e$1$1.Buffer=u$1$1,e$1$1.SlowBuffer=function(e){return+e!=e&&(e=0),u$1$1.alloc(+e)},e$1$1.INSPECT_MAX_BYTES=50,e$1$1.kMaxLength=2147483647,u$1$1.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u$1$1.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u$1$1.prototype,"parent",{enumerable:!0,get:function(){if(u$1$1.isBuffer(this))return this.buffer}}),Object.defineProperty(u$1$1.prototype,"offset",{enumerable:!0,get:function(){if(u$1$1.isBuffer(this))return this.byteOffset}}),u$1$1.poolSize=8192,u$1$1.from=function(e,t,r){return s$2(e,t,r)},Object.setPrototypeOf(u$1$1.prototype,Uint8Array.prototype),Object.setPrototypeOf(u$1$1,Uint8Array),u$1$1.alloc=function(e,t,r){return function(e,t,r){return h$1$1(e),e<=0?f$1(e):void 0!==t?"string"==typeof r?f$1(e).fill(t,r):f$1(e).fill(t):f$1(e)}(e,t,r)},u$1$1.allocUnsafe=function(e){return a$2(e)},u$1$1.allocUnsafeSlow=function(e){return a$2(e)},u$1$1.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u$1$1.prototype},u$1$1.compare=function(e,t){if(F(e,Uint8Array)&&(e=u$1$1.from(e,e.offset,e.byteLength)),F(t,Uint8Array)&&(t=u$1$1.from(t,t.offset,t.byteLength)),!u$1$1.isBuffer(e)||!u$1$1.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},u$1$1.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u$1$1.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u$1$1.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u$1$1.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var i=e[r];if(F(i,Uint8Array)&&(i=u$1$1.from(i)),!u$1$1.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},u$1$1.byteLength=y$1,u$1$1.prototype._isBuffer=!0,u$1$1.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)w(this,t,t+1);return this},u$1$1.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)w(this,t,t+3),w(this,t+1,t+2);return this},u$1$1.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)w(this,t,t+7),w(this,t+1,t+6),w(this,t+2,t+5),w(this,t+3,t+4);return this},u$1$1.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},u$1$1.prototype.toLocaleString=u$1$1.prototype.toString,u$1$1.prototype.equals=function(e){if(!u$1$1.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u$1$1.compare(this,e)},u$1$1.prototype.inspect=function(){var e="",t=e$1$1.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},o$1$1&&(u$1$1.prototype[o$1$1]=u$1$1.prototype.inspect),u$1$1.prototype.compare=function(e,t,r,n,o){if(F(e,Uint8Array)&&(e=u$1$1.from(e,e.offset,e.byteLength)),!u$1$1.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+_typeof2(e));if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(i,a),l=this.slice(n,o),c=e.slice(t,r),u=0;u<s;++u)if(l[u]!==c[u]){i=l[u],a=c[u];break}return i<a?-1:a<i?1:0},u$1$1.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u$1$1.prototype.indexOf=function(e,t,r){return d$2(this,e,t,r,!0)},u$1$1.prototype.lastIndexOf=function(e,t,r){return d$2(this,e,t,r,!1)},u$1$1.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return m$2(this,e,t,r);case"ascii":return E(this,e,t,r);case"latin1":case"binary":return B(this,e,t,r);case"base64":return A(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},u$1$1.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u$1$1.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,u$1$1.prototype),n},u$1$1.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},u$1$1.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},u$1$1.prototype.readUInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),this[e]},u$1$1.prototype.readUInt16LE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]|this[e+1]<<8},u$1$1.prototype.readUInt16BE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]<<8|this[e+1]},u$1$1.prototype.readUInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u$1$1.prototype.readUInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u$1$1.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},u$1$1.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},u$1$1.prototype.readInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u$1$1.prototype.readInt16LE=function(e,t){e>>>=0,t||x(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u$1$1.prototype.readInt16BE=function(e,t){e>>>=0,t||x(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u$1$1.prototype.readInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u$1$1.prototype.readInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u$1$1.prototype.readFloatLE=function(e,t){return e>>>=0,t||x(e,4,this.length),i$1.read(this,e,!0,23,4)},u$1$1.prototype.readFloatBE=function(e,t){return e>>>=0,t||x(e,4,this.length),i$1.read(this,e,!1,23,4)},u$1$1.prototype.readDoubleLE=function(e,t){return e>>>=0,t||x(e,8,this.length),i$1.read(this,e,!0,52,8)},u$1$1.prototype.readDoubleBE=function(e,t){return e>>>=0,t||x(e,8,this.length),i$1.read(this,e,!1,52,8)},u$1$1.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||C(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},u$1$1.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||C(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},u$1$1.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,1,255,0),this[t]=255&e,t+1},u$1$1.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u$1$1.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u$1$1.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u$1$1.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u$1$1.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var o=Math.pow(2,8*r-1);C(this,e,t,r,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},u$1$1.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var o=Math.pow(2,8*r-1);C(this,e,t,r,o-1,-o)}var i=r-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},u$1$1.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u$1$1.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u$1$1.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u$1$1.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u$1$1.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u$1$1.prototype.writeFloatLE=function(e,t,r){return k(this,e,t,!0,r)},u$1$1.prototype.writeFloatBE=function(e,t,r){return k(this,e,t,!1,r)},u$1$1.prototype.writeDoubleLE=function(e,t,r){return M(this,e,t,!0,r)},u$1$1.prototype.writeDoubleBE=function(e,t,r){return M(this,e,t,!1,r)},u$1$1.prototype.copy=function(e,t,r,n){if(!u$1$1.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var i=o-1;i>=0;--i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return o},u$1$1.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u$1$1.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var o=e.charCodeAt(0);("utf8"===n&&o<128||"latin1"===n)&&(e=o)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var a=u$1$1.isBuffer(e)?e:u$1$1.from(e,n),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=a[i%s]}return this};var j=/[^+/0-9A-Za-z-_]/g;function _(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function z(e){return n$1$1.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function D(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function F(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function N(e){return e!=e}var Y=function(){for(var e=new Array(256),t=0;t<16;++t)for(var r=16*t,n=0;n<16;++n)e[r+n]="0123456789abcdef"[t]+"0123456789abcdef"[n];return e}(),exports$7={},Buffer=e$1$1.Buffer;exports$7=isBuf;var withNativeBuffer="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,withNativeArrayBuffer="function"==typeof ArrayBuffer,isView=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer};function isBuf(e){return withNativeBuffer&&Buffer.isBuffer(e)||withNativeArrayBuffer&&(e instanceof ArrayBuffer||isView(e))}var _isBuffer=exports$7,_global$3="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$1$6={},isArray=exports$1$5,isBuf$1=_isBuffer,toString$1=Object.prototype.toString,withNativeBlob="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===toString$1.call(Blob),withNativeFile="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===toString$1.call(File);function _deconstructPacket(e,t){if(!e)return e;if(isBuf$1(e)){var r={_placeholder:!0,num:t.length};return t.push(e),r}if(isArray(e)){for(var n=new Array(e.length),o=0;o<e.length;o++)n[o]=_deconstructPacket(e[o],t);return n}if("object"===_typeof2(e)&&!(e instanceof Date)){n={};for(var i in e)n[i]=_deconstructPacket(e[i],t);return n}return e}function _reconstructPacket(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(isArray(e))for(var r=0;r<e.length;r++)e[r]=_reconstructPacket(e[r],t);else if("object"===_typeof2(e))for(var n in e)e[n]=_reconstructPacket(e[n],t);return e}exports$1$6.deconstructPacket=function(e){var t=[],r=e.data,n=e;return n.data=_deconstructPacket(r,t),n.attachments=t.length,{packet:n,buffers:t}},exports$1$6.reconstructPacket=function(e,t){return e.data=_reconstructPacket(e.data,t),e.attachments=void 0,e},exports$1$6.removeBlobs=function(e,t){var r=0,n=e;!function e(o,i,a){if(!o)return o;if(withNativeBlob&&o instanceof Blob||withNativeFile&&o instanceof File){r++;var s=new FileReader;s.onload=function(){a?a[i]=(this||_global$3).result:n=(this||_global$3).result,--r||t(n)},s.readAsArrayBuffer(o)}else if(isArray(o))for(var l=0;l<o.length;l++)e(o[l],l,o);else if("object"===_typeof2(o)&&!isBuf$1(o))for(var c in o)e(o[c],c,o)}(n),r||t(n)};var _global$1$1="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$2$1={},debug=exports$1$3("socket.io-parser"),Emitter$1=exports$1$4,binary=exports$1$6,isArray$1=exports$1$5,isBuf$2=_isBuffer;function Encoder(){}exports$2$1.protocol=4,exports$2$1.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],exports$2$1.CONNECT=0,exports$2$1.DISCONNECT=1,exports$2$1.EVENT=2,exports$2$1.ACK=3,exports$2$1.ERROR=4,exports$2$1.BINARY_EVENT=5,exports$2$1.BINARY_ACK=6,exports$2$1.Encoder=Encoder,exports$2$1.Decoder=Decoder;var ERROR_PACKET=exports$2$1.ERROR+'"encode error"';function encodeAsString(e){var t=""+e.type;if(exports$2$1.BINARY_EVENT!==e.type&&exports$2$1.BINARY_ACK!==e.type||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data){var r=tryStringify(e.data);if(!1===r)return ERROR_PACKET;t+=r}return debug("encoded %j as %s",e,t),t}function tryStringify(e){try{return JSON.stringify(e)}catch(e){return!1}}function encodeAsBinary(e,t){binary.removeBlobs(e,(function(e){var r=binary.deconstructPacket(e),n=encodeAsString(r.packet),o=r.buffers;o.unshift(n),t(o)}))}function Decoder(){(this||_global$1$1).reconstructor=null}function decodeString(e){var t=0,r={type:Number(e.charAt(0))};if(null==exports$2$1.types[r.type])return error("unknown packet type "+r.type);if(exports$2$1.BINARY_EVENT===r.type||exports$2$1.BINARY_ACK===r.type){for(var n=t+1;"-"!==e.charAt(++t)&&t!=e.length;);var o=e.substring(n,t);if(o!=Number(o)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===e.charAt(t+1)){for(n=t+1;++t;){if(","===(a=e.charAt(t)))break;if(t===e.length)break}r.nsp=e.substring(n,t)}else r.nsp="/";var i=e.charAt(t+1);if(""!==i&&Number(i)==i){for(n=t+1;++t;){var a;if(null==(a=e.charAt(t))||Number(a)!=a){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){var s=tryParse(e.substr(t));if(!(!1!==s&&(r.type===exports$2$1.ERROR||isArray$1(s))))return error("invalid payload");r.data=s}return debug("decoded %s as %j",e,r),r}function tryParse(e){try{return JSON.parse(e)}catch(e){return!1}}function BinaryReconstructor(e){(this||_global$1$1).reconPack=e,(this||_global$1$1).buffers=[]}function error(e){return{type:exports$2$1.ERROR,data:"parser error: "+e}}Encoder.prototype.encode=function(e,t){(debug("encoding packet %j",e),exports$2$1.BINARY_EVENT===e.type||exports$2$1.BINARY_ACK===e.type)?encodeAsBinary(e,t):t([encodeAsString(e)])},Emitter$1(Decoder.prototype),Decoder.prototype.add=function(e){var t;if("string"==typeof e)t=decodeString(e),exports$2$1.BINARY_EVENT===t.type||exports$2$1.BINARY_ACK===t.type?((this||_global$1$1).reconstructor=new BinaryReconstructor(t),0===(this||_global$1$1).reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!isBuf$2(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!(this||_global$1$1).reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=(this||_global$1$1).reconstructor.takeBinaryData(e))&&((this||_global$1$1).reconstructor=null,this.emit("decoded",t))}},Decoder.prototype.destroy=function(){(this||_global$1$1).reconstructor&&(this||_global$1$1).reconstructor.finishedReconstruction()},BinaryReconstructor.prototype.takeBinaryData=function(e){if((this||_global$1$1).buffers.push(e),(this||_global$1$1).buffers.length===(this||_global$1$1).reconPack.attachments){var t=binary.reconstructPacket((this||_global$1$1).reconPack,(this||_global$1$1).buffers);return this.finishedReconstruction(),t}return null},BinaryReconstructor.prototype.finishedReconstruction=function(){(this||_global$1$1).reconPack=null,(this||_global$1$1).buffers=[]};var exports$8={};try{exports$8="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(err){exports$8=!1}var exports$1$7=exports$8,exports$9={};exports$9="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();var _globalThis2=exports$9,exports$a={},hasCORS=exports$1$7,_globalThis=_globalThis2;exports$a=function(e){var t=e.xdomain,r=e.xscheme,n=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||hasCORS))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!r&&n)return new XDomainRequest}catch(e){}if(!t)try{return new(_globalThis[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}};var _xmlhttprequestSsl=exports$a,exports$b={},Buffer$1=e$1$1.Buffer,isArray$2=exports$1$5,toString$2=Object.prototype.toString,withNativeBlob$1="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===toString$2.call(Blob),withNativeFile$1="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===toString$2.call(File);function hasBinary(e){if(!e||"object"!==_typeof2(e))return!1;if(isArray$2(e)){for(var t=0,r=e.length;t<r;t++)if(hasBinary(e[t]))return!0;return!1}if("function"==typeof Buffer$1&&Buffer$1.isBuffer&&Buffer$1.isBuffer(e)||"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||withNativeBlob$1&&e instanceof Blob||withNativeFile$1&&e instanceof File)return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return hasBinary(e.toJSON(),!0);for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&hasBinary(e[n]))return!0;return!1}exports$b=hasBinary;var exports$1$8=exports$b,exports$c={};exports$c=function(e,t,r){var n=e.byteLength;if(t=t||0,r=r||n,e.slice)return e.slice(t,r);if(t<0&&(t+=n),r<0&&(r+=n),r>n&&(r=n),t>=n||t>=r||0===n)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(r-t),a=t,s=0;a<r;a++,s++)i[s]=o[a];return i.buffer};var exports$1$9=exports$c,exports$d={};function after(e,t,r){var n=!1;return r=r||noop,o.count=e,0===e?t():o;function o(e,i){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(n=!0,t(e),t=r):0!==o.count||n||t(null,i)}}function noop(){}exports$d=after;var exports$1$a=exports$d,exports$e={};!function(e){exports$e.encode=function(t){var r,n=new Uint8Array(t),o=n.length,i="";for(r=0;r<o;r+=3)i+=e[n[r]>>2],i+=e[(3&n[r])<<4|n[r+1]>>4],i+=e[(15&n[r+1])<<2|n[r+2]>>6],i+=e[63&n[r+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},exports$e.decode=function(t){var r,n,o,i,a,s=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var u=new ArrayBuffer(s),f=new Uint8Array(u);for(r=0;r<l;r+=4)n=e.indexOf(t[r]),o=e.indexOf(t[r+1]),i=e.indexOf(t[r+2]),a=e.indexOf(t[r+3]),f[c++]=n<<2|o>>4,f[c++]=(15&o)<<4|i>>2,f[c++]=(3&i)<<6|63&a;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");var exports$f={},BlobBuilder=void 0!==BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,blobSupported=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),blobSupportsArrayBufferView=blobSupported&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),blobBuilderSupported=BlobBuilder&&BlobBuilder.prototype.append&&BlobBuilder.prototype.getBlob;function mapArrayBufferViews(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var r=new Uint8Array(e.byteLength);r.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=r.buffer}return t}return e}))}function BlobBuilderConstructor(e,t){t=t||{};var r=new BlobBuilder;return mapArrayBufferViews(e).forEach((function(e){r.append(e)})),t.type?r.getBlob(t.type):r.getBlob()}function BlobConstructor(e,t){return new Blob(mapArrayBufferViews(e),t||{})}"undefined"!=typeof Blob&&(BlobBuilderConstructor.prototype=Blob.prototype,BlobConstructor.prototype=Blob.prototype),exports$f=blobSupported?blobSupportsArrayBufferView?Blob:BlobConstructor:blobBuilderSupported?BlobBuilderConstructor:void 0;var exports$1$b=exports$f,exports$g={};exports$g=Object.keys||function(e){var t=[],r=Object.prototype.hasOwnProperty;for(var n in e)r.call(e,n)&&t.push(n);return t};var _keys=exports$g,exports$1$c={},stringFromCharCode=String.fromCharCode,byteArray,byteCount,byteIndex;function ucs2decode(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function ucs2encode(e){for(var t,r=e.length,n=-1,o="";++n<r;)(t=e[n])>65535&&(o+=stringFromCharCode((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=stringFromCharCode(t);return o}function checkScalarValue(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function createByte(e,t){return stringFromCharCode(e>>t&63|128)}function encodeCodePoint(e,t){if(0==(4294967168&e))return stringFromCharCode(e);var r="";return 0==(4294965248&e)?r=stringFromCharCode(e>>6&31|192):0==(4294901760&e)?(checkScalarValue(e,t)||(e=65533),r=stringFromCharCode(e>>12&15|224),r+=createByte(e,6)):0==(4292870144&e)&&(r=stringFromCharCode(e>>18&7|240),r+=createByte(e,12),r+=createByte(e,6)),r+=stringFromCharCode(63&e|128)}function utf8encode(e,t){for(var r=!1!==(t=t||{}).strict,n=ucs2decode(e),o=n.length,i=-1,a="";++i<o;)a+=encodeCodePoint(n[i],r);return a}function readContinuationByte(){if(byteIndex>=byteCount)throw Error("Invalid byte index");var e=255&byteArray[byteIndex];if(byteIndex++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function decodeSymbol(e){var t,r;if(byteIndex>byteCount)throw Error("Invalid byte index");if(byteIndex==byteCount)return!1;if(t=255&byteArray[byteIndex],byteIndex++,0==(128&t))return t;if(192==(224&t)){if((r=(31&t)<<6|readContinuationByte())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if((r=(15&t)<<12|readContinuationByte()<<6|readContinuationByte())>=2048)return checkScalarValue(r,e)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(r=(7&t)<<18|readContinuationByte()<<12|readContinuationByte()<<6|readContinuationByte())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}function utf8decode(e,t){var r=!1!==(t=t||{}).strict;byteArray=ucs2decode(e),byteCount=byteArray.length,byteIndex=0;for(var n,o=[];!1!==(n=decodeSymbol(r));)o.push(n);return ucs2encode(o)}exports$1$c={version:"2.1.2",encode:utf8encode,decode:utf8decode};var _utf=exports$1$c,exports$2$2={},keys=_keys,hasBinary$1=exports$1$8,sliceBuffer=exports$1$9,after$1=exports$1$a,utf8=_utf,base64encoder;"undefined"!=typeof ArrayBuffer&&(base64encoder=exports$e);var isAndroid="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),isPhantomJS="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),dontSendBlobs=isAndroid||isPhantomJS;exports$2$2.protocol=3;var packets=exports$2$2.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},packetslist=keys(packets),err={type:"error",data:"parser error"},Blob$1=exports$1$b;function encodeBase64Object(e,t){return t("b"+exports$2$2.packets[e.type]+e.data.data)}function encodeArrayBuffer(e,t,r){if(!t)return exports$2$2.encodeBase64Packet(e,r);var n=e.data,o=new Uint8Array(n),i=new Uint8Array(1+n.byteLength);i[0]=packets[e.type];for(var a=0;a<o.length;a++)i[a+1]=o[a];return r(i.buffer)}function encodeBlobAsArrayBuffer(e,t,r){if(!t)return exports$2$2.encodeBase64Packet(e,r);var n=new FileReader;return n.onload=function(){exports$2$2.encodePacket({type:e.type,data:n.result},t,!0,r)},n.readAsArrayBuffer(e.data)}function encodeBlob(e,t,r){if(!t)return exports$2$2.encodeBase64Packet(e,r);if(dontSendBlobs)return encodeBlobAsArrayBuffer(e,t,r);var n=new Uint8Array(1);return n[0]=packets[e.type],r(new Blob$1([n.buffer,e.data]))}function tryDecode(e){try{e=utf8.decode(e,{strict:!1})}catch(e){return!1}return e}function map(e,t,r){for(var n=new Array(e.length),o=after$1(e.length,r),i=function(e,r,o){t(r,(function(t,r){n[e]=r,o(t,n)}))},a=0;a<e.length;a++)i(a,e[a],o)}exports$2$2.encodePacket=function(e,t,r,n){"function"==typeof t&&(n=t,t=!1),"function"==typeof r&&(n=r,r=null);var o=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return encodeArrayBuffer(e,t,n);if(void 0!==Blob$1&&o instanceof Blob$1)return encodeBlob(e,t,n);if(o&&o.base64)return encodeBase64Object(e,n);var i=packets[e.type];return void 0!==e.data&&(i+=r?utf8.encode(String(e.data),{strict:!1}):String(e.data)),n(""+i)},exports$2$2.encodeBase64Packet=function(e,t){var r,n="b"+exports$2$2.packets[e.type];if(void 0!==Blob$1&&e.data instanceof Blob$1){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];t(n+e)},o.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var i=new Uint8Array(e.data),a=new Array(i.length),s=0;s<i.length;s++)a[s]=i[s];r=String.fromCharCode.apply(null,a)}return n+=btoa(r),t(n)},exports$2$2.decodePacket=function(e,t,r){if(void 0===e)return err;if("string"==typeof e){if("b"===e.charAt(0))return exports$2$2.decodeBase64Packet(e.substr(1),t);if(r&&!1===(e=tryDecode(e)))return err;var n=e.charAt(0);return Number(n)==n&&packetslist[n]?e.length>1?{type:packetslist[n],data:e.substring(1)}:{type:packetslist[n]}:err}n=new Uint8Array(e)[0];var o=sliceBuffer(e,1);return Blob$1&&"blob"===t&&(o=new Blob$1([o])),{type:packetslist[n],data:o}},exports$2$2.decodeBase64Packet=function(e,t){var r=packetslist[e.charAt(0)];if(!base64encoder)return{type:r,data:{base64:!0,data:e.substr(1)}};var n=base64encoder.decode(e.substr(1));return"blob"===t&&Blob$1&&(n=new Blob$1([n])),{type:r,data:n}},exports$2$2.encodePayload=function(e,t,r){"function"==typeof t&&(r=t,t=null);var n=hasBinary$1(e);if(t&&n)return Blob$1&&!dontSendBlobs?exports$2$2.encodePayloadAsBlob(e,r):exports$2$2.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");map(e,(function(e,r){exports$2$2.encodePacket(e,!!n&&t,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))}))},exports$2$2.decodePayload=function(e,t,r){if("string"!=typeof e)return exports$2$2.decodePayloadAsBinary(e,t,r);var n;if("function"==typeof t&&(r=t,t=null),""===e)return r(err,0,1);for(var o,i,a="",s=0,l=e.length;s<l;s++){var c=e.charAt(s);if(":"===c){if(""===a||a!=(o=Number(a)))return r(err,0,1);if(a!=(i=e.substr(s+1,o)).length)return r(err,0,1);if(i.length){if(n=exports$2$2.decodePacket(i,t,!1),err.type===n.type&&err.data===n.data)return r(err,0,1);if(!1===r(n,s+o,l))return}s+=o,a=""}else a+=c}return""!==a?r(err,0,1):void 0},exports$2$2.encodePayloadAsArrayBuffer=function(e,t){if(!e.length)return t(new ArrayBuffer(0));map(e,(function(e,t){exports$2$2.encodePacket(e,!0,!0,(function(e){return t(null,e)}))}),(function(e,r){var n=r.reduce((function(e,t){var r;return e+(r="string"==typeof t?t.length:t.byteLength).toString().length+r+2}),0),o=new Uint8Array(n),i=0;return r.forEach((function(e){var t="string"==typeof e,r=e;if(t){for(var n=new Uint8Array(e.length),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);r=n.buffer}o[i++]=t?0:1;var s=r.byteLength.toString();for(a=0;a<s.length;a++)o[i++]=parseInt(s[a]);o[i++]=255;for(n=new Uint8Array(r),a=0;a<n.length;a++)o[i++]=n[a]})),t(o.buffer)}))},exports$2$2.encodePayloadAsBlob=function(e,t){map(e,(function(e,t){exports$2$2.encodePacket(e,!0,!0,(function(e){var r=new Uint8Array(1);if(r[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);e=n.buffer,r[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)a[o]=parseInt(i[o]);if(a[i.length]=255,Blob$1){var s=new Blob$1([r.buffer,a.buffer,e]);t(null,s)}}))}),(function(e,r){return t(new Blob$1(r))}))},exports$2$2.decodePayloadAsBinary=function(e,t,r){"function"==typeof t&&(r=t,t=null);for(var n=e,o=[];n.byteLength>0;){for(var i=new Uint8Array(n),a=0===i[0],s="",l=1;255!==i[l];l++){if(s.length>310)return r(err,0,1);s+=i[l]}n=sliceBuffer(n,2+s.length),s=parseInt(s);var c=sliceBuffer(n,0,s);if(a)try{c=String.fromCharCode.apply(null,new Uint8Array(c))}catch(e){var u=new Uint8Array(c);c="";for(l=0;l<u.length;l++)c+=String.fromCharCode(u[l])}o.push(c),n=sliceBuffer(n,s)}var f=o.length;o.forEach((function(e,n){r(exports$2$2.decodePacket(e,t,!0),n,f)}))};var exports$h={encode:function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t},decode:function(e){for(var t={},r=e.split("&"),n=0,o=r.length;n<o;n++){var i=r[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},exports$i={};exports$i=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e};var exports$1$d=exports$i,exports$j={},alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map$1={},seed=0,i$2=0,prev;function encode(e){var t="";do{t=alphabet[e%length]+t,e=Math.floor(e/length)}while(e>0);return t}function decode(e){var t=0;for(i$2=0;i$2<e.length;i$2++)t=t*length+map$1[e.charAt(i$2)];return t}function yeast(){var e=encode(+new Date);return e!==prev?(seed=0,prev=e):e+"."+encode(seed++)}for(;i$2<length;i$2++)map$1[alphabet[i$2]]=i$2;yeast.encode=encode,yeast.decode=decode,exports$j=yeast;var exports$1$e=exports$j,_global$4="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$k={},parser=exports$2$2,Emitter$2=exports$1$4;function Transport(e){(this||_global$4).path=e.path,(this||_global$4).hostname=e.hostname,(this||_global$4).port=e.port,(this||_global$4).secure=e.secure,(this||_global$4).query=e.query,(this||_global$4).timestampParam=e.timestampParam,(this||_global$4).timestampRequests=e.timestampRequests,(this||_global$4).readyState="",(this||_global$4).agent=e.agent||!1,(this||_global$4).socket=e.socket,(this||_global$4).enablesXDR=e.enablesXDR,(this||_global$4).withCredentials=e.withCredentials,(this||_global$4).pfx=e.pfx,(this||_global$4).key=e.key,(this||_global$4).passphrase=e.passphrase,(this||_global$4).cert=e.cert,(this||_global$4).ca=e.ca,(this||_global$4).ciphers=e.ciphers,(this||_global$4).rejectUnauthorized=e.rejectUnauthorized,(this||_global$4).forceNode=e.forceNode,(this||_global$4).isReactNative=e.isReactNative,(this||_global$4).extraHeaders=e.extraHeaders,(this||_global$4).localAddress=e.localAddress}exports$k=Transport,Emitter$2(Transport.prototype),Transport.prototype.onError=function(e,t){var r=new Error(e);return r.type="TransportError",r.description=t,this.emit("error",r),this||_global$4},Transport.prototype.open=function(){return"closed"!==(this||_global$4).readyState&&""!==(this||_global$4).readyState||((this||_global$4).readyState="opening",this.doOpen()),this||_global$4},Transport.prototype.close=function(){return"opening"!==(this||_global$4).readyState&&"open"!==(this||_global$4).readyState||(this.doClose(),this.onClose()),this||_global$4},Transport.prototype.send=function(e){if("open"!==(this||_global$4).readyState)throw new Error("Transport not open");this.write(e)},Transport.prototype.onOpen=function(){(this||_global$4).readyState="open",(this||_global$4).writable=!0,this.emit("open")},Transport.prototype.onData=function(e){var t=parser.decodePacket(e,(this||_global$4).socket.binaryType);this.onPacket(t)},Transport.prototype.onPacket=function(e){this.emit("packet",e)},Transport.prototype.onClose=function(){(this||_global$4).readyState="closed",this.emit("close")};var _transport=exports$k,_global$1$2="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$1$f={},Transport$1=_transport,parseqs=exports$h,parser$1=exports$2$2,inherit=exports$1$d,yeast$1=exports$1$e,debug$1=exports$1$3("engine.io-client:polling");exports$1$f=Polling;var hasXHR2=null!=new _xmlhttprequestSsl({xdomain:!1}).responseType;function Polling(e){var t=e&&e.forceBase64;hasXHR2&&!t||((this||_global$1$2).supportsBinary=!1),Transport$1.call(this||_global$1$2,e)}inherit(Polling,Transport$1),Polling.prototype.name="polling",Polling.prototype.doOpen=function(){this.poll()},Polling.prototype.pause=function(e){var t=this||_global$1$2;function r(){debug$1("paused"),t.readyState="paused",e()}if((this||_global$1$2).readyState="pausing",(this||_global$1$2).polling||!(this||_global$1$2).writable){var n=0;(this||_global$1$2).polling&&(debug$1("we are currently polling - waiting to pause"),n++,this.once("pollComplete",(function(){debug$1("pre-pause polling complete"),--n||r()}))),(this||_global$1$2).writable||(debug$1("we are currently writing - waiting to pause"),n++,this.once("drain",(function(){debug$1("pre-pause writing complete"),--n||r()})))}else r()},Polling.prototype.poll=function(){debug$1("polling"),(this||_global$1$2).polling=!0,this.doPoll(),this.emit("poll")},Polling.prototype.onData=function(e){var t=this||_global$1$2;debug$1("polling got data %s",e);parser$1.decodePayload(e,(this||_global$1$2).socket.binaryType,(function(e,r,n){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==(this||_global$1$2).readyState&&((this||_global$1$2).polling=!1,this.emit("pollComplete"),"open"===(this||_global$1$2).readyState?this.poll():debug$1('ignoring poll - transport state "%s"',(this||_global$1$2).readyState))},Polling.prototype.doClose=function(){var e=this||_global$1$2;function t(){debug$1("writing close packet"),e.write([{type:"close"}])}"open"===(this||_global$1$2).readyState?(debug$1("transport open - closing"),t()):(debug$1("transport not open - deferring close"),this.once("open",t))},Polling.prototype.write=function(e){var t=this||_global$1$2;(this||_global$1$2).writable=!1;var r=function(){t.writable=!0,t.emit("drain")};parser$1.encodePayload(e,(this||_global$1$2).supportsBinary,(function(e){t.doWrite(e,r)}))},Polling.prototype.uri=function(){var e=(this||_global$1$2).query||{},t=(this||_global$1$2).secure?"https":"http",r="";return!1!==(this||_global$1$2).timestampRequests&&(e[(this||_global$1$2).timestampParam]=yeast$1()),(this||_global$1$2).supportsBinary||e.sid||(e.b64=1),e=parseqs.encode(e),(this||_global$1$2).port&&("https"===t&&443!==Number((this||_global$1$2).port)||"http"===t&&80!==Number((this||_global$1$2).port))&&(r=":"+(this||_global$1$2).port),e.length&&(e="?"+e),t+"://"+(-1!==(this||_global$1$2).hostname.indexOf(":")?"["+(this||_global$1$2).hostname+"]":(this||_global$1$2).hostname)+r+(this||_global$1$2).path+e};var _polling=exports$1$f,_global$2$1="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$2$3={},XMLHttpRequest$1=_xmlhttprequestSsl,Polling$1=_polling,Emitter$1$1=exports$1$4,inherit$1=exports$1$d,debug$1$1=exports$1$3("engine.io-client:polling-xhr"),_globalThis$1=_globalThis2;function empty(){}function XHR(e){if(Polling$1.call(this||_global$2$1,e),(this||_global$2$1).requestTimeout=e.requestTimeout,(this||_global$2$1).extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,r=location.port;r||(r=t?443:80),(this||_global$2$1).xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,(this||_global$2$1).xs=e.secure!==t}}function Request(e){(this||_global$2$1).method=e.method||"GET",(this||_global$2$1).uri=e.uri,(this||_global$2$1).xd=!!e.xd,(this||_global$2$1).xs=!!e.xs,(this||_global$2$1).async=!1!==e.async,(this||_global$2$1).data=void 0!==e.data?e.data:null,(this||_global$2$1).agent=e.agent,(this||_global$2$1).isBinary=e.isBinary,(this||_global$2$1).supportsBinary=e.supportsBinary,(this||_global$2$1).enablesXDR=e.enablesXDR,(this||_global$2$1).withCredentials=e.withCredentials,(this||_global$2$1).requestTimeout=e.requestTimeout,(this||_global$2$1).pfx=e.pfx,(this||_global$2$1).key=e.key,(this||_global$2$1).passphrase=e.passphrase,(this||_global$2$1).cert=e.cert,(this||_global$2$1).ca=e.ca,(this||_global$2$1).ciphers=e.ciphers,(this||_global$2$1).rejectUnauthorized=e.rejectUnauthorized,(this||_global$2$1).extraHeaders=e.extraHeaders,this.create()}if(exports$2$3=XHR,exports$2$3.Request=Request,inherit$1(XHR,Polling$1),XHR.prototype.supportsBinary=!0,XHR.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=(this||_global$2$1).xd,e.xs=(this||_global$2$1).xs,e.agent=(this||_global$2$1).agent||!1,e.supportsBinary=(this||_global$2$1).supportsBinary,e.enablesXDR=(this||_global$2$1).enablesXDR,e.withCredentials=(this||_global$2$1).withCredentials,e.pfx=(this||_global$2$1).pfx,e.key=(this||_global$2$1).key,e.passphrase=(this||_global$2$1).passphrase,e.cert=(this||_global$2$1).cert,e.ca=(this||_global$2$1).ca,e.ciphers=(this||_global$2$1).ciphers,e.rejectUnauthorized=(this||_global$2$1).rejectUnauthorized,e.requestTimeout=(this||_global$2$1).requestTimeout,e.extraHeaders=(this||_global$2$1).extraHeaders,new Request(e)},XHR.prototype.doWrite=function(e,t){var r="string"!=typeof e&&void 0!==e,n=this.request({method:"POST",data:e,isBinary:r}),o=this||_global$2$1;n.on("success",t),n.on("error",(function(e){o.onError("xhr post error",e)})),(this||_global$2$1).sendXhr=n},XHR.prototype.doPoll=function(){debug$1$1("xhr poll");var e=this.request(),t=this||_global$2$1;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),(this||_global$2$1).pollXhr=e},Emitter$1$1(Request.prototype),Request.prototype.create=function(){var e={agent:(this||_global$2$1).agent,xdomain:(this||_global$2$1).xd,xscheme:(this||_global$2$1).xs,enablesXDR:(this||_global$2$1).enablesXDR};e.pfx=(this||_global$2$1).pfx,e.key=(this||_global$2$1).key,e.passphrase=(this||_global$2$1).passphrase,e.cert=(this||_global$2$1).cert,e.ca=(this||_global$2$1).ca,e.ciphers=(this||_global$2$1).ciphers,e.rejectUnauthorized=(this||_global$2$1).rejectUnauthorized;var t=(this||_global$2$1).xhr=new XMLHttpRequest$1(e),r=this||_global$2$1;try{debug$1$1("xhr open %s: %s",(this||_global$2$1).method,(this||_global$2$1).uri),t.open((this||_global$2$1).method,(this||_global$2$1).uri,(this||_global$2$1).async);try{if((this||_global$2$1).extraHeaders)for(var n in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),(this||_global$2$1).extraHeaders)(this||_global$2$1).extraHeaders.hasOwnProperty(n)&&t.setRequestHeader(n,(this||_global$2$1).extraHeaders[n])}catch(e){}if("POST"===(this||_global$2$1).method)try{(this||_global$2$1).isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=(this||_global$2$1).withCredentials),(this||_global$2$1).requestTimeout&&(t.timeout=(this||_global$2$1).requestTimeout),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(r.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?r.onLoad():setTimeout((function(){r.onError("number"==typeof t.status?t.status:0)}),0))},debug$1$1("xhr data %s",(this||_global$2$1).data),t.send((this||_global$2$1).data)}catch(e){return void setTimeout((function(){r.onError(e)}),0)}"undefined"!=typeof document&&((this||_global$2$1).index=Request.requestsCount++,Request.requests[(this||_global$2$1).index]=this||_global$2$1)},Request.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},Request.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},Request.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},Request.prototype.cleanup=function(e){if(void 0!==(this||_global$2$1).xhr&&null!==(this||_global$2$1).xhr){if(this.hasXDR()?(this||_global$2$1).xhr.onload=(this||_global$2$1).xhr.onerror=empty:(this||_global$2$1).xhr.onreadystatechange=empty,e)try{(this||_global$2$1).xhr.abort()}catch(e){}"undefined"!=typeof document&&delete Request.requests[(this||_global$2$1).index],(this||_global$2$1).xhr=null}},Request.prototype.onLoad=function(){var e;try{var t;try{t=(this||_global$2$1).xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&(this||_global$2$1).xhr.response||(this||_global$2$1).xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},Request.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!(this||_global$2$1).xs&&(this||_global$2$1).enablesXDR},Request.prototype.abort=function(){this.cleanup()},Request.requestsCount=0,Request.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",unloadHandler);else if("function"==typeof addEventListener){var terminationEvent="onpagehide"in _globalThis$1?"pagehide":"unload";addEventListener(terminationEvent,unloadHandler,!1)}function unloadHandler(){for(var e in Request.requests)Request.requests.hasOwnProperty(e)&&Request.requests[e].abort()}var _pollingXhr=exports$2$3,_Request=exports$2$3.Request,exports$l={},indexOf=[].indexOf;exports$l=function(e,t){if(indexOf)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1};var exports$1$g=exports$l,_global$5="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$m={},Polling$2=_polling,inherit$2=exports$1$d,_globalThis$2=_globalThis2;exports$m=JSONPPolling;var rNewline=/\n/g,rEscapedNewline=/\\n/g,callbacks;function empty$1(){}function JSONPPolling(e){Polling$2.call(this||_global$5,e),(this||_global$5).query=(this||_global$5).query||{},callbacks||(callbacks=_globalThis$2.___eio=_globalThis$2.___eio||[]),(this||_global$5).index=callbacks.length;var t=this||_global$5;callbacks.push((function(e){t.onData(e)})),(this||_global$5).query.j=(this||_global$5).index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=empty$1)}),!1)}inherit$2(JSONPPolling,Polling$2),JSONPPolling.prototype.supportsBinary=!1,JSONPPolling.prototype.doClose=function(){(this||_global$5).script&&((this||_global$5).script.parentNode.removeChild((this||_global$5).script),(this||_global$5).script=null),(this||_global$5).form&&((this||_global$5).form.parentNode.removeChild((this||_global$5).form),(this||_global$5).form=null,(this||_global$5).iframe=null),Polling$2.prototype.doClose.call(this||_global$5)},JSONPPolling.prototype.doPoll=function(){var e=this||_global$5,t=document.createElement("script");(this||_global$5).script&&((this||_global$5).script.parentNode.removeChild((this||_global$5).script),(this||_global$5).script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(t,r):(document.head||document.body).appendChild(t),(this||_global$5).script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},JSONPPolling.prototype.doWrite=function(e,t){var r=this||_global$5;if(!(this||_global$5).form){var n,o=document.createElement("form"),i=document.createElement("textarea"),a=(this||_global$5).iframeId="eio_iframe_"+(this||_global$5).index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=a,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),(this||_global$5).form=o,(this||_global$5).area=i}function s(){l(),t()}function l(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+r.iframeId+'">';n=document.createElement(e)}catch(e){(n=document.createElement("iframe")).name=r.iframeId,n.src="javascript:0"}n.id=r.iframeId,r.form.appendChild(n),r.iframe=n}(this||_global$5).form.action=this.uri(),l(),e=e.replace(rEscapedNewline,"\\\n"),(this||_global$5).area.value=e.replace(rNewline,"\\n");try{(this||_global$5).form.submit()}catch(e){}(this||_global$5).iframe.attachEvent?(this||_global$5).iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&s()}:(this||_global$5).iframe.onload=s};var _pollingJsonp=exports$m,_ws=Object.freeze({}),_global$1$3="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$1$h={},Buffer$2=e$1$1.Buffer,Transport$2=_transport,parser$2=exports$2$2,parseqs$1=exports$h,inherit$1$1=exports$1$d,yeast$2=exports$1$e,debug$2=exports$1$3("engine.io-client:websocket"),BrowserWebSocket,NodeWebSocket;if("undefined"!=typeof WebSocket?BrowserWebSocket=WebSocket:"undefined"!=typeof self&&(BrowserWebSocket=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{NodeWebSocket=_ws}catch(e){}var WebSocketImpl=BrowserWebSocket||NodeWebSocket;function WS(e){e&&e.forceBase64&&((this||_global$1$3).supportsBinary=!1),(this||_global$1$3).perMessageDeflate=e.perMessageDeflate,(this||_global$1$3).usingBrowserWebSocket=BrowserWebSocket&&!e.forceNode,(this||_global$1$3).protocols=e.protocols,(this||_global$1$3).usingBrowserWebSocket||(WebSocketImpl=NodeWebSocket),Transport$2.call(this||_global$1$3,e)}exports$1$h=WS,inherit$1$1(WS,Transport$2),WS.prototype.name="websocket",WS.prototype.supportsBinary=!0,WS.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=(this||_global$1$3).protocols,r={};(this||_global$1$3).isReactNative||(r.agent=(this||_global$1$3).agent,r.perMessageDeflate=(this||_global$1$3).perMessageDeflate,r.pfx=(this||_global$1$3).pfx,r.key=(this||_global$1$3).key,r.passphrase=(this||_global$1$3).passphrase,r.cert=(this||_global$1$3).cert,r.ca=(this||_global$1$3).ca,r.ciphers=(this||_global$1$3).ciphers,r.rejectUnauthorized=(this||_global$1$3).rejectUnauthorized),(this||_global$1$3).extraHeaders&&(r.headers=(this||_global$1$3).extraHeaders),(this||_global$1$3).localAddress&&(r.localAddress=(this||_global$1$3).localAddress);try{(this||_global$1$3).ws=(this||_global$1$3).usingBrowserWebSocket&&!(this||_global$1$3).isReactNative?t?new WebSocketImpl(e,t):new WebSocketImpl(e):new WebSocketImpl(e,t,r)}catch(e){return this.emit("error",e)}void 0===(this||_global$1$3).ws.binaryType&&((this||_global$1$3).supportsBinary=!1),(this||_global$1$3).ws.supports&&(this||_global$1$3).ws.supports.binary?((this||_global$1$3).supportsBinary=!0,(this||_global$1$3).ws.binaryType="nodebuffer"):(this||_global$1$3).ws.binaryType="arraybuffer",this.addEventListeners()}},WS.prototype.addEventListeners=function(){var e=this||_global$1$3;(this||_global$1$3).ws.onopen=function(){e.onOpen()},(this||_global$1$3).ws.onclose=function(){e.onClose()},(this||_global$1$3).ws.onmessage=function(t){e.onData(t.data)},(this||_global$1$3).ws.onerror=function(t){e.onError("websocket error",t)}},WS.prototype.write=function(e){var t=this||_global$1$3;(this||_global$1$3).writable=!1;for(var r=e.length,n=0,o=r;n<o;n++)!function(e){parser$2.encodePacket(e,t.supportsBinary,(function(n){if(!t.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),t.perMessageDeflate)("string"==typeof n?Buffer$2.byteLength(n):n.length)<t.perMessageDeflate.threshold&&(o.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(n):t.ws.send(n,o)}catch(e){debug$2("websocket closed before onclose event")}--r||i()}))}(e[n]);function i(){t.emit("flush"),setTimeout((function(){t.writable=!0,t.emit("drain")}),0)}},WS.prototype.onClose=function(){Transport$2.prototype.onClose.call(this||_global$1$3)},WS.prototype.doClose=function(){void 0!==(this||_global$1$3).ws&&(this||_global$1$3).ws.close()},WS.prototype.uri=function(){var e=(this||_global$1$3).query||{},t=(this||_global$1$3).secure?"wss":"ws",r="";return(this||_global$1$3).port&&("wss"===t&&443!==Number((this||_global$1$3).port)||"ws"===t&&80!==Number((this||_global$1$3).port))&&(r=":"+(this||_global$1$3).port),(this||_global$1$3).timestampRequests&&(e[(this||_global$1$3).timestampParam]=yeast$2()),(this||_global$1$3).supportsBinary||(e.b64=1),(e=parseqs$1.encode(e)).length&&(e="?"+e),t+"://"+(-1!==(this||_global$1$3).hostname.indexOf(":")?"["+(this||_global$1$3).hostname+"]":(this||_global$1$3).hostname)+r+(this||_global$1$3).path+e},WS.prototype.check=function(){return!(!WebSocketImpl||"__initialize"in WebSocketImpl&&(this||_global$1$3).name===WS.prototype.name)};var _websocket=exports$1$h,exports$2$4={},XMLHttpRequest$2=_xmlhttprequestSsl,XHR$1=_pollingXhr,JSONP=_pollingJsonp,websocket=_websocket;function polling(e){var t=!1,r=!1,n=!1!==e.jsonp;if("undefined"!=typeof location){var o="https:"===location.protocol,i=location.port;i||(i=o?443:80),t=e.hostname!==location.hostname||i!==e.port,r=e.secure!==o}if(e.xdomain=t,e.xscheme=r,"open"in new XMLHttpRequest$2(e)&&!e.forceJSONP)return new XHR$1(e);if(!n)throw new Error("JSONP disabled");return new JSONP(e)}exports$2$4.polling=polling,exports$2$4.websocket=websocket;var _global$2$2="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$3$1={},transports=exports$2$4,Emitter$3=exports$1$4,debug$1$2=exports$1$3("engine.io-client:socket"),index=exports$1$g,parser$1$1=exports$2$2,parseuri=exports$1$1,parseqs$1$1=exports$h;function Socket(e,t){if(!((this||_global$2$2)instanceof Socket))return new Socket(e,t);t=t||{},e&&"object"===_typeof2(e)&&(t=e,e=null),e?(e=parseuri(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=parseuri(t.host).host),(this||_global$2$2).secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=(this||_global$2$2).secure?"443":"80"),(this||_global$2$2).agent=t.agent||!1,(this||_global$2$2).hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),(this||_global$2$2).port=t.port||("undefined"!=typeof location&&location.port?location.port:(this||_global$2$2).secure?443:80),(this||_global$2$2).query=t.query||{},"string"==typeof(this||_global$2$2).query&&((this||_global$2$2).query=parseqs$1$1.decode((this||_global$2$2).query)),(this||_global$2$2).upgrade=!1!==t.upgrade,(this||_global$2$2).path=(t.path||"/engine.io").replace(/\/$/,"")+"/",(this||_global$2$2).forceJSONP=!!t.forceJSONP,(this||_global$2$2).jsonp=!1!==t.jsonp,(this||_global$2$2).forceBase64=!!t.forceBase64,(this||_global$2$2).enablesXDR=!!t.enablesXDR,(this||_global$2$2).withCredentials=!1!==t.withCredentials,(this||_global$2$2).timestampParam=t.timestampParam||"t",(this||_global$2$2).timestampRequests=t.timestampRequests,(this||_global$2$2).transports=t.transports||["polling","websocket"],(this||_global$2$2).transportOptions=t.transportOptions||{},(this||_global$2$2).readyState="",(this||_global$2$2).writeBuffer=[],(this||_global$2$2).prevBufferLen=0,(this||_global$2$2).policyPort=t.policyPort||843,(this||_global$2$2).rememberUpgrade=t.rememberUpgrade||!1,(this||_global$2$2).binaryType=null,(this||_global$2$2).onlyBinaryUpgrades=t.onlyBinaryUpgrades,(this||_global$2$2).perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===(this||_global$2$2).perMessageDeflate&&((this||_global$2$2).perMessageDeflate={}),(this||_global$2$2).perMessageDeflate&&null==(this||_global$2$2).perMessageDeflate.threshold&&((this||_global$2$2).perMessageDeflate.threshold=1024),(this||_global$2$2).pfx=t.pfx||null,(this||_global$2$2).key=t.key||null,(this||_global$2$2).passphrase=t.passphrase||null,(this||_global$2$2).cert=t.cert||null,(this||_global$2$2).ca=t.ca||null,(this||_global$2$2).ciphers=t.ciphers||null,(this||_global$2$2).rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,(this||_global$2$2).forceNode=!!t.forceNode,(this||_global$2$2).isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||(this||_global$2$2).isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&((this||_global$2$2).extraHeaders=t.extraHeaders),t.localAddress&&((this||_global$2$2).localAddress=t.localAddress)),(this||_global$2$2).id=null,(this||_global$2$2).upgrades=null,(this||_global$2$2).pingInterval=null,(this||_global$2$2).pingTimeout=null,(this||_global$2$2).pingIntervalTimer=null,(this||_global$2$2).pingTimeoutTimer=null,this.open()}function clone(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}exports$3$1=Socket,Socket.priorWebsocketSuccess=!1,Emitter$3(Socket.prototype),Socket.protocol=parser$1$1.protocol,Socket.Socket=Socket,Socket.Transport=_transport,Socket.transports=exports$2$4,Socket.parser=exports$2$2,Socket.prototype.createTransport=function(e){debug$1$2('creating transport "%s"',e);var t=clone((this||_global$2$2).query);t.EIO=parser$1$1.protocol,t.transport=e;var r=(this||_global$2$2).transportOptions[e]||{};return(this||_global$2$2).id&&(t.sid=(this||_global$2$2).id),new transports[e]({query:t,socket:this||_global$2$2,agent:r.agent||(this||_global$2$2).agent,hostname:r.hostname||(this||_global$2$2).hostname,port:r.port||(this||_global$2$2).port,secure:r.secure||(this||_global$2$2).secure,path:r.path||(this||_global$2$2).path,forceJSONP:r.forceJSONP||(this||_global$2$2).forceJSONP,jsonp:r.jsonp||(this||_global$2$2).jsonp,forceBase64:r.forceBase64||(this||_global$2$2).forceBase64,enablesXDR:r.enablesXDR||(this||_global$2$2).enablesXDR,withCredentials:r.withCredentials||(this||_global$2$2).withCredentials,timestampRequests:r.timestampRequests||(this||_global$2$2).timestampRequests,timestampParam:r.timestampParam||(this||_global$2$2).timestampParam,policyPort:r.policyPort||(this||_global$2$2).policyPort,pfx:r.pfx||(this||_global$2$2).pfx,key:r.key||(this||_global$2$2).key,passphrase:r.passphrase||(this||_global$2$2).passphrase,cert:r.cert||(this||_global$2$2).cert,ca:r.ca||(this||_global$2$2).ca,ciphers:r.ciphers||(this||_global$2$2).ciphers,rejectUnauthorized:r.rejectUnauthorized||(this||_global$2$2).rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||(this||_global$2$2).perMessageDeflate,extraHeaders:r.extraHeaders||(this||_global$2$2).extraHeaders,forceNode:r.forceNode||(this||_global$2$2).forceNode,localAddress:r.localAddress||(this||_global$2$2).localAddress,requestTimeout:r.requestTimeout||(this||_global$2$2).requestTimeout,protocols:r.protocols||void 0,isReactNative:(this||_global$2$2).isReactNative})},Socket.prototype.open=function(){var e;if((this||_global$2$2).rememberUpgrade&&Socket.priorWebsocketSuccess&&-1!==(this||_global$2$2).transports.indexOf("websocket"))e="websocket";else{if(0===(this||_global$2$2).transports.length){var t=this||_global$2$2;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=(this||_global$2$2).transports[0]}(this||_global$2$2).readyState="opening";try{e=this.createTransport(e)}catch(e){return(this||_global$2$2).transports.shift(),void this.open()}e.open(),this.setTransport(e)},Socket.prototype.setTransport=function(e){debug$1$2("setting transport %s",e.name);var t=this||_global$2$2;(this||_global$2$2).transport&&(debug$1$2("clearing existing transport %s",(this||_global$2$2).transport.name),(this||_global$2$2).transport.removeAllListeners()),(this||_global$2$2).transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},Socket.prototype.probe=function(e){debug$1$2('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),r=!1,n=this||_global$2$2;function o(){if(n.onlyBinaryUpgrades){var o=!(this||_global$2$2).supportsBinary&&n.transport.supportsBinary;r=r||o}r||(debug$1$2('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!r)if("pong"===o.type&&"probe"===o.data){if(debug$1$2('probe transport "%s" pong',e),n.upgrading=!0,n.emit("upgrading",t),!t)return;Socket.priorWebsocketSuccess="websocket"===t.name,debug$1$2('pausing current transport "%s"',n.transport.name),n.transport.pause((function(){r||"closed"!==n.readyState&&(debug$1$2("changing transport and sending upgrade packet"),u(),n.setTransport(t),t.send([{type:"upgrade"}]),n.emit("upgrade",t),t=null,n.upgrading=!1,n.flush())}))}else{debug$1$2('probe transport "%s" failed',e);var i=new Error("probe error");i.transport=t.name,n.emit("upgradeError",i)}})))}function i(){r||(r=!0,u(),t.close(),t=null)}function a(r){var o=new Error("probe error: "+r);o.transport=t.name,i(),debug$1$2('probe transport "%s" failed because of error: %s',e,r),n.emit("upgradeError",o)}function s(){a("transport closed")}function l(){a("socket closed")}function c(e){t&&e.name!==t.name&&(debug$1$2('"%s" works - aborting "%s"',e.name,t.name),i())}function u(){t.removeListener("open",o),t.removeListener("error",a),t.removeListener("close",s),n.removeListener("close",l),n.removeListener("upgrading",c)}Socket.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",a),t.once("close",s),this.once("close",l),this.once("upgrading",c),t.open()},Socket.prototype.onOpen=function(){if(debug$1$2("socket open"),(this||_global$2$2).readyState="open",Socket.priorWebsocketSuccess="websocket"===(this||_global$2$2).transport.name,this.emit("open"),this.flush(),"open"===(this||_global$2$2).readyState&&(this||_global$2$2).upgrade&&(this||_global$2$2).transport.pause){debug$1$2("starting upgrade probes");for(var e=0,t=(this||_global$2$2).upgrades.length;e<t;e++)this.probe((this||_global$2$2).upgrades[e])}},Socket.prototype.onPacket=function(e){if("opening"===(this||_global$2$2).readyState||"open"===(this||_global$2$2).readyState||"closing"===(this||_global$2$2).readyState)switch(debug$1$2('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else debug$1$2('packet received with socket readyState "%s"',(this||_global$2$2).readyState)},Socket.prototype.onHandshake=function(e){this.emit("handshake",e),(this||_global$2$2).id=e.sid,(this||_global$2$2).transport.query.sid=e.sid,(this||_global$2$2).upgrades=this.filterUpgrades(e.upgrades),(this||_global$2$2).pingInterval=e.pingInterval,(this||_global$2$2).pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==(this||_global$2$2).readyState&&(this.setPing(),this.removeListener("heartbeat",(this||_global$2$2).onHeartbeat),this.on("heartbeat",(this||_global$2$2).onHeartbeat))},Socket.prototype.onHeartbeat=function(e){clearTimeout((this||_global$2$2).pingTimeoutTimer);var t=this||_global$2$2;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},Socket.prototype.setPing=function(){var e=this||_global$2$2;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){debug$1$2("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},Socket.prototype.ping=function(){var e=this||_global$2$2;this.sendPacket("ping",(function(){e.emit("ping")}))},Socket.prototype.onDrain=function(){(this||_global$2$2).writeBuffer.splice(0,(this||_global$2$2).prevBufferLen),(this||_global$2$2).prevBufferLen=0,0===(this||_global$2$2).writeBuffer.length?this.emit("drain"):this.flush()},Socket.prototype.flush=function(){"closed"!==(this||_global$2$2).readyState&&(this||_global$2$2).transport.writable&&!(this||_global$2$2).upgrading&&(this||_global$2$2).writeBuffer.length&&(debug$1$2("flushing %d packets in socket",(this||_global$2$2).writeBuffer.length),(this||_global$2$2).transport.send((this||_global$2$2).writeBuffer),(this||_global$2$2).prevBufferLen=(this||_global$2$2).writeBuffer.length,this.emit("flush"))},Socket.prototype.write=Socket.prototype.send=function(e,t,r){return this.sendPacket("message",e,t,r),this||_global$2$2},Socket.prototype.sendPacket=function(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==(this||_global$2$2).readyState&&"closed"!==(this||_global$2$2).readyState){(r=r||{}).compress=!1!==r.compress;var o={type:e,data:t,options:r};this.emit("packetCreate",o),(this||_global$2$2).writeBuffer.push(o),n&&this.once("flush",n),this.flush()}},Socket.prototype.close=function(){if("opening"===(this||_global$2$2).readyState||"open"===(this||_global$2$2).readyState){(this||_global$2$2).readyState="closing";var e=this||_global$2$2;(this||_global$2$2).writeBuffer.length?this.once("drain",(function(){(this||_global$2$2).upgrading?n():t()})):(this||_global$2$2).upgrading?n():t()}function t(){e.onClose("forced close"),debug$1$2("socket closing - telling transport to close"),e.transport.close()}function r(){e.removeListener("upgrade",r),e.removeListener("upgradeError",r),t()}function n(){e.once("upgrade",r),e.once("upgradeError",r)}return this||_global$2$2},Socket.prototype.onError=function(e){debug$1$2("socket error %j",e),Socket.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},Socket.prototype.onClose=function(e,t){if("opening"===(this||_global$2$2).readyState||"open"===(this||_global$2$2).readyState||"closing"===(this||_global$2$2).readyState){debug$1$2('socket close with reason: "%s"',e);var r=this||_global$2$2;clearTimeout((this||_global$2$2).pingIntervalTimer),clearTimeout((this||_global$2$2).pingTimeoutTimer),(this||_global$2$2).transport.removeAllListeners("close"),(this||_global$2$2).transport.close(),(this||_global$2$2).transport.removeAllListeners(),(this||_global$2$2).readyState="closed",(this||_global$2$2).id=null,this.emit("close",e,t),r.writeBuffer=[],r.prevBufferLen=0}},Socket.prototype.filterUpgrades=function(e){for(var t=[],r=0,n=e.length;r<n;r++)~index((this||_global$2$2).transports,e[r])&&t.push(e[r]);return t};var _socket=exports$3$1,exports$4$1={};exports$4$1=_socket,exports$4$1.parser=exports$2$2;var exports$5$1=exports$4$1,parser$2$1=exports$4$1.parser,exports$n={};function toArray(e,t){for(var r=[],n=(t=t||0)||0;n<e.length;n++)r[n-t]=e[n];return r}exports$n=toArray;var exports$1$i=exports$n,exports$o={},slice=[].slice;exports$o=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=slice.call(arguments,2);return function(){return t.apply(e,r.concat(slice.call(arguments)))}};var exports$1$j=exports$o,exports$p={};function on$1(e,t,r){return e.on(t,r),{destroy:function(){e.removeListener(t,r)}}}exports$p=on$1;var _on=exports$p,_global$6="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$1$k={},parser$3=exports$2$1,Emitter$4=exports$1$4,toArray$1=exports$1$i,on$1$1=_on,bind=exports$1$j,debug$3=exports$1$3("socket.io-client:socket"),parseqs$2=exports$h,hasBin=exports$1$8;exports$1$k=exports$1$k=Socket$1;var events={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},emit$1=Emitter$4.prototype.emit;function Socket$1(e,t,r){(this||_global$6).io=e,(this||_global$6).nsp=t,(this||_global$6).json=this||_global$6,(this||_global$6).ids=0,(this||_global$6).acks={},(this||_global$6).receiveBuffer=[],(this||_global$6).sendBuffer=[],(this||_global$6).connected=!1,(this||_global$6).disconnected=!0,(this||_global$6).flags={},r&&r.query&&((this||_global$6).query=r.query),(this||_global$6).io.autoConnect&&this.open()}Emitter$4(Socket$1.prototype),Socket$1.prototype.subEvents=function(){if(!(this||_global$6).subs){var e=(this||_global$6).io;(this||_global$6).subs=[on$1$1(e,"open",bind(this||_global$6,"onopen")),on$1$1(e,"packet",bind(this||_global$6,"onpacket")),on$1$1(e,"close",bind(this||_global$6,"onclose"))]}},Socket$1.prototype.open=Socket$1.prototype.connect=function(){return(this||_global$6).connected||(this.subEvents(),(this||_global$6).io.reconnecting||(this||_global$6).io.open(),"open"===(this||_global$6).io.readyState&&this.onopen(),this.emit("connecting")),this||_global$6},Socket$1.prototype.send=function(){var e=toArray$1(arguments);return e.unshift("message"),(this||_global$6).emit.apply(this||_global$6,e),this||_global$6},Socket$1.prototype.emit=function(e){if(events.hasOwnProperty(e))return emit$1.apply(this||_global$6,arguments),this||_global$6;var t=toArray$1(arguments),r={type:(void 0!==(this||_global$6).flags.binary?(this||_global$6).flags.binary:hasBin(t))?parser$3.BINARY_EVENT:parser$3.EVENT,data:t,options:{}};return r.options.compress=!(this||_global$6).flags||!1!==(this||_global$6).flags.compress,"function"==typeof t[t.length-1]&&(debug$3("emitting packet with ack id %d",(this||_global$6).ids),(this||_global$6).acks[(this||_global$6).ids]=t.pop(),r.id=(this||_global$6).ids++),(this||_global$6).connected?this.packet(r):(this||_global$6).sendBuffer.push(r),(this||_global$6).flags={},this||_global$6},Socket$1.prototype.packet=function(e){e.nsp=(this||_global$6).nsp,(this||_global$6).io.packet(e)},Socket$1.prototype.onopen=function(){if(debug$3("transport is open - connecting"),"/"!==(this||_global$6).nsp)if((this||_global$6).query){var e="object"===_typeof2((this||_global$6).query)?parseqs$2.encode((this||_global$6).query):(this||_global$6).query;debug$3("sending connect packet with query %s",e),this.packet({type:parser$3.CONNECT,query:e})}else this.packet({type:parser$3.CONNECT})},Socket$1.prototype.onclose=function(e){debug$3("close (%s)",e),(this||_global$6).connected=!1,(this||_global$6).disconnected=!0,delete(this||_global$6).id,this.emit("disconnect",e)},Socket$1.prototype.onpacket=function(e){var t=e.nsp===(this||_global$6).nsp,r=e.type===parser$3.ERROR&&"/"===e.nsp;if(t||r)switch(e.type){case parser$3.CONNECT:this.onconnect();break;case parser$3.EVENT:case parser$3.BINARY_EVENT:this.onevent(e);break;case parser$3.ACK:case parser$3.BINARY_ACK:this.onack(e);break;case parser$3.DISCONNECT:this.ondisconnect();break;case parser$3.ERROR:this.emit("error",e.data)}},Socket$1.prototype.onevent=function(e){var t=e.data||[];debug$3("emitting event %j",t),null!=e.id&&(debug$3("attaching ack callback to event"),t.push(this.ack(e.id))),(this||_global$6).connected?emit$1.apply(this||_global$6,t):(this||_global$6).receiveBuffer.push(t)},Socket$1.prototype.ack=function(e){var t=this||_global$6,r=!1;return function(){if(!r){r=!0;var n=toArray$1(arguments);debug$3("sending ack %j",n),t.packet({type:hasBin(n)?parser$3.BINARY_ACK:parser$3.ACK,id:e,data:n})}}},Socket$1.prototype.onack=function(e){var t=(this||_global$6).acks[e.id];"function"==typeof t?(debug$3("calling ack %s with %j",e.id,e.data),t.apply(this||_global$6,e.data),delete(this||_global$6).acks[e.id]):debug$3("bad ack %s",e.id)},Socket$1.prototype.onconnect=function(){(this||_global$6).connected=!0,(this||_global$6).disconnected=!1,this.emit("connect"),this.emitBuffered()},Socket$1.prototype.emitBuffered=function(){var e;for(e=0;e<(this||_global$6).receiveBuffer.length;e++)emit$1.apply(this||_global$6,(this||_global$6).receiveBuffer[e]);for((this||_global$6).receiveBuffer=[],e=0;e<(this||_global$6).sendBuffer.length;e++)this.packet((this||_global$6).sendBuffer[e]);(this||_global$6).sendBuffer=[]},Socket$1.prototype.ondisconnect=function(){debug$3("server disconnect (%s)",(this||_global$6).nsp),this.destroy(),this.onclose("io server disconnect")},Socket$1.prototype.destroy=function(){if((this||_global$6).subs){for(var e=0;e<(this||_global$6).subs.length;e++)(this||_global$6).subs[e].destroy();(this||_global$6).subs=null}(this||_global$6).io.destroy(this||_global$6)},Socket$1.prototype.close=Socket$1.prototype.disconnect=function(){return(this||_global$6).connected&&(debug$3("performing disconnect (%s)",(this||_global$6).nsp),this.packet({type:parser$3.DISCONNECT})),this.destroy(),(this||_global$6).connected&&this.onclose("io client disconnect"),this||_global$6},Socket$1.prototype.compress=function(e){return(this||_global$6).flags.compress=e,this||_global$6},Socket$1.prototype.binary=function(e){return(this||_global$6).flags.binary=e,this||_global$6};var _socket2=exports$1$k,_global$7="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$q={};function Backoff(e){e=e||{},(this||_global$7).ms=e.min||100,(this||_global$7).max=e.max||1e4,(this||_global$7).factor=e.factor||2,(this||_global$7).jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,(this||_global$7).attempts=0}exports$q=Backoff,Backoff.prototype.duration=function(){var e=(this||_global$7).ms*Math.pow((this||_global$7).factor,(this||_global$7).attempts++);if((this||_global$7).jitter){var t=Math.random(),r=Math.floor(t*(this||_global$7).jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,(this||_global$7).max)},Backoff.prototype.reset=function(){(this||_global$7).attempts=0},Backoff.prototype.setMin=function(e){(this||_global$7).ms=e},Backoff.prototype.setMax=function(e){(this||_global$7).max=e},Backoff.prototype.setJitter=function(e){(this||_global$7).jitter=e};var exports$1$l=exports$q,exports$r={},parseuri$1=exports$1$1,debug$4=exports$1$3("socket.io-client:url");function url(e,t){var r=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(debug$4("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),debug$4("parse %s",e),r=parseuri$1(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var n=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+n+":"+r.port,r.href=r.protocol+"://"+n+(t&&t.port===r.port?"":":"+r.port),r}exports$r=url;var _url=exports$r,_global$8="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,exports$1$m={},eio=exports$5$1,Socket$2=_socket2,Emitter$5=exports$1$4,parser$4=exports$2$1,on$2=_on,bind$1=exports$1$j,debug$1$3=exports$1$3("socket.io-client:manager"),indexOf$1=exports$1$g,Backoff$1=exports$1$l,has=Object.prototype.hasOwnProperty;function Manager(e,t){if(!((this||_global$8)instanceof Manager))return new Manager(e,t);e&&"object"===_typeof2(e)&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",(this||_global$8).nsps={},(this||_global$8).subs=[],(this||_global$8).opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),(this||_global$8).backoff=new Backoff$1({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),(this||_global$8).readyState="closed",(this||_global$8).uri=e,(this||_global$8).connecting=[],(this||_global$8).lastPing=null,(this||_global$8).encoding=!1,(this||_global$8).packetBuffer=[];var r=t.parser||parser$4;(this||_global$8).encoder=new r.Encoder,(this||_global$8).decoder=new r.Decoder,(this||_global$8).autoConnect=!1!==t.autoConnect,(this||_global$8).autoConnect&&this.open()}exports$1$m=Manager,Manager.prototype.emitAll=function(){for(var e in(this||_global$8).emit.apply(this||_global$8,arguments),(this||_global$8).nsps)has.call((this||_global$8).nsps,e)&&(this||_global$8).nsps[e].emit.apply((this||_global$8).nsps[e],arguments)},Manager.prototype.updateSocketIds=function(){for(var e in(this||_global$8).nsps)has.call((this||_global$8).nsps,e)&&((this||_global$8).nsps[e].id=this.generateId(e))},Manager.prototype.generateId=function(e){return("/"===e?"":e+"#")+(this||_global$8).engine.id},Emitter$5(Manager.prototype),Manager.prototype.reconnection=function(e){return arguments.length?((this||_global$8)._reconnection=!!e,this||_global$8):(this||_global$8)._reconnection},Manager.prototype.reconnectionAttempts=function(e){return arguments.length?((this||_global$8)._reconnectionAttempts=e,this||_global$8):(this||_global$8)._reconnectionAttempts},Manager.prototype.reconnectionDelay=function(e){return arguments.length?((this||_global$8)._reconnectionDelay=e,(this||_global$8).backoff&&(this||_global$8).backoff.setMin(e),this||_global$8):(this||_global$8)._reconnectionDelay},Manager.prototype.randomizationFactor=function(e){return arguments.length?((this||_global$8)._randomizationFactor=e,(this||_global$8).backoff&&(this||_global$8).backoff.setJitter(e),this||_global$8):(this||_global$8)._randomizationFactor},Manager.prototype.reconnectionDelayMax=function(e){return arguments.length?((this||_global$8)._reconnectionDelayMax=e,(this||_global$8).backoff&&(this||_global$8).backoff.setMax(e),this||_global$8):(this||_global$8)._reconnectionDelayMax},Manager.prototype.timeout=function(e){return arguments.length?((this||_global$8)._timeout=e,this||_global$8):(this||_global$8)._timeout},Manager.prototype.maybeReconnectOnOpen=function(){!(this||_global$8).reconnecting&&(this||_global$8)._reconnection&&0===(this||_global$8).backoff.attempts&&this.reconnect()},Manager.prototype.open=Manager.prototype.connect=function(e,t){if(debug$1$3("readyState %s",(this||_global$8).readyState),~(this||_global$8).readyState.indexOf("open"))return this||_global$8;debug$1$3("opening %s",(this||_global$8).uri),(this||_global$8).engine=eio((this||_global$8).uri,(this||_global$8).opts);var r=(this||_global$8).engine,n=this||_global$8;(this||_global$8).readyState="opening",(this||_global$8).skipReconnect=!1;var o=on$2(r,"open",(function(){n.onopen(),e&&e()})),i=on$2(r,"error",(function(t){if(debug$1$3("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else n.maybeReconnectOnOpen()}));if(!1!==(this||_global$8)._timeout){var a=(this||_global$8)._timeout;debug$1$3("connect attempt will timeout after %d",a),0===a&&o.destroy();var s=setTimeout((function(){debug$1$3("connect attempt timed out after %d",a),o.destroy(),r.close(),r.emit("error","timeout"),n.emitAll("connect_timeout",a)}),a);(this||_global$8).subs.push({destroy:function(){clearTimeout(s)}})}return(this||_global$8).subs.push(o),(this||_global$8).subs.push(i),this||_global$8},Manager.prototype.onopen=function(){debug$1$3("open"),this.cleanup(),(this||_global$8).readyState="open",this.emit("open");var e=(this||_global$8).engine;(this||_global$8).subs.push(on$2(e,"data",bind$1(this||_global$8,"ondata"))),(this||_global$8).subs.push(on$2(e,"ping",bind$1(this||_global$8,"onping"))),(this||_global$8).subs.push(on$2(e,"pong",bind$1(this||_global$8,"onpong"))),(this||_global$8).subs.push(on$2(e,"error",bind$1(this||_global$8,"onerror"))),(this||_global$8).subs.push(on$2(e,"close",bind$1(this||_global$8,"onclose"))),(this||_global$8).subs.push(on$2((this||_global$8).decoder,"decoded",bind$1(this||_global$8,"ondecoded")))},Manager.prototype.onping=function(){(this||_global$8).lastPing=new Date,this.emitAll("ping")},Manager.prototype.onpong=function(){this.emitAll("pong",new Date-(this||_global$8).lastPing)},Manager.prototype.ondata=function(e){(this||_global$8).decoder.add(e)},Manager.prototype.ondecoded=function(e){this.emit("packet",e)},Manager.prototype.onerror=function(e){debug$1$3("error",e),this.emitAll("error",e)},Manager.prototype.socket=function(e,t){var r=(this||_global$8).nsps[e];if(!r){r=new Socket$2(this||_global$8,e,t),(this||_global$8).nsps[e]=r;var n=this||_global$8;r.on("connecting",o),r.on("connect",(function(){r.id=n.generateId(e)})),(this||_global$8).autoConnect&&o()}function o(){~indexOf$1(n.connecting,r)||n.connecting.push(r)}return r},Manager.prototype.destroy=function(e){var t=indexOf$1((this||_global$8).connecting,e);~t&&(this||_global$8).connecting.splice(t,1),(this||_global$8).connecting.length||this.close()},Manager.prototype.packet=function(e){debug$1$3("writing packet %j",e);var t=this||_global$8;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,(this||_global$8).encoder.encode(e,(function(r){for(var n=0;n<r.length;n++)t.engine.write(r[n],e.options);t.encoding=!1,t.processPacketQueue()})))},Manager.prototype.processPacketQueue=function(){if((this||_global$8).packetBuffer.length>0&&!(this||_global$8).encoding){var e=(this||_global$8).packetBuffer.shift();this.packet(e)}},Manager.prototype.cleanup=function(){debug$1$3("cleanup");for(var e=(this||_global$8).subs.length,t=0;t<e;t++){(this||_global$8).subs.shift().destroy()}(this||_global$8).packetBuffer=[],(this||_global$8).encoding=!1,(this||_global$8).lastPing=null,(this||_global$8).decoder.destroy()},Manager.prototype.close=Manager.prototype.disconnect=function(){debug$1$3("disconnect"),(this||_global$8).skipReconnect=!0,(this||_global$8).reconnecting=!1,"opening"===(this||_global$8).readyState&&this.cleanup(),(this||_global$8).backoff.reset(),(this||_global$8).readyState="closed",(this||_global$8).engine&&(this||_global$8).engine.close()},Manager.prototype.onclose=function(e){debug$1$3("onclose"),this.cleanup(),(this||_global$8).backoff.reset(),(this||_global$8).readyState="closed",this.emit("close",e),(this||_global$8)._reconnection&&!(this||_global$8).skipReconnect&&this.reconnect()},Manager.prototype.reconnect=function(){if((this||_global$8).reconnecting||(this||_global$8).skipReconnect)return this||_global$8;var e=this||_global$8;if((this||_global$8).backoff.attempts>=(this||_global$8)._reconnectionAttempts)debug$1$3("reconnect failed"),(this||_global$8).backoff.reset(),this.emitAll("reconnect_failed"),(this||_global$8).reconnecting=!1;else{var t=(this||_global$8).backoff.duration();debug$1$3("will wait %dms before reconnect attempt",t),(this||_global$8).reconnecting=!0;var r=setTimeout((function(){e.skipReconnect||(debug$1$3("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(debug$1$3("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(debug$1$3("reconnect success"),e.onreconnect())})))}),t);(this||_global$8).subs.push({destroy:function(){clearTimeout(r)}})}},Manager.prototype.onreconnect=function(){var e=(this||_global$8).backoff.attempts;(this||_global$8).reconnecting=!1,(this||_global$8).backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)};var _manager=exports$1$m,exports$2$5={},url$1=_url,parser$1$2=exports$2$1,Manager$1=_manager,debug$2$1=exports$1$3("socket.io-client");exports$2$5=exports$2$5=lookup;var cache=exports$2$5.managers={};function lookup(e,t){"object"===_typeof2(e)&&(t=e,e=void 0),t=t||{};var r,n=url$1(e),o=n.source,i=n.id,a=n.path,s=cache[i]&&a in cache[i].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||s?(debug$2$1("ignoring socket cache for %s",o),r=Manager$1(o,t)):(cache[i]||(debug$2$1("new io instance for %s",o),cache[i]=Manager$1(o,t)),r=cache[i]),n.query&&!t.query&&(t.query=n.query),r.socket(n.path,t)}exports$2$5.protocol=parser$1$2.protocol,exports$2$5.connect=lookup,exports$2$5.Manager=_manager,exports$2$5.Socket=_socket2;var exports$3$2=exports$2$5,managers=exports$2$5.managers,protocol=exports$2$5.protocol,connect=exports$2$5.connect,Socket$1$1=exports$2$5.Socket,_Manager=exports$2$5.Manager,isNode$2=void 0!==System?System.get("@system-env").node:"undefined"!=typeof process&&process.env,ioClient;if(isNode$2&&System){var _require=System._nodeRequire("module")._load;ioClient=_require("socket.io-client")}else ioClient=exports$3$2;var urlHelper={isRoot:function(e){return"/"===urlHelper.path(e)},root:function(e){return urlHelper.isRoot(e)?e:e.slice(0,-urlHelper.path(e).length)+"/"},path:function(){var e=/^[a-z0-9-_\.]+:/,t=/^\/\/[^\/]+/;return function(r){var n=r.replace(e,"").replace(t,"");return""===n?"/":n}}(),join:function(e,t){return e.endsWith("/")&&(e=e.slice(0,-1)),t.startsWith("/")&&(t=t.slice(1)),e+"/"+t}};function determineLocation(){return"undefined"!=typeof document&&document.location?document.location.origin:isNode$2?System._nodeRequire("os").hostname():System.baseURL}var L2LClient=function(e){_inherits(u,L2LConnection);var t,r,n,o,i,a,s,l,c=_createSuper(u);function u(e,t,r,n){var o;return _classCallCheck(this,u),o=c.call(this),makeEmitter(_assertThisInitialized(o)),o.info=n,o.origin=e,o.path=t,o.namespace=r.replace(/^\/?/,"/"),o.trackerId=null,o._socketioClient=null,o._reconnectState={closed:!1,autoReconnect:!0,isReconnecting:!1,isReconnectingViaSocketio:!1,registerAttempt:0,registerProcess:null,isOpening:!1},Object.keys(defaultActions).forEach((function(e){return o.addService(e,defaultActions[e])})),Object.keys(defaultClientActions).forEach((function(e){return o.addService(e,defaultClientActions[e])})),o}return _createClass(u,null,[{key:"clientKey",value:function(e,t,r){return e=e.replace(/\/$/,""),t=t.replace(/^\//,""),r=r.replace(/^\//,""),"".concat(e,"-").concat(t,"-").concat(r)}},{key:"forLivelyInBrowser",value:function(e){var t=!!e;e=_objectSpread({type:"lively.morphic browser"},e);var r=this.default();return r?(t&&!equals(r.info,e)&&r.isRegistered()&&(r.info=e,r.unregister().then((function(){return r.register()})).catch((function(e){return console.error("l2l re-register on info change errored: "+e)}))),r):u.ensure({url:"".concat(document.location.origin,"/lively-socket.io"),namespace:"l2l",info:e})}},{key:"default",value:function(){var e=u.clients.keys().next().value;return u.clients.get(e)}},{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.debug,r=void 0!==t&&t,n=e.url,o=e.namespace,i=e.autoOpen,a=void 0===i||i,s=e.info,l=void 0===s?{}:s;if(!n)throw new Error("L2LClient needs server url!");var c=urlHelper.root(n).replace(/\/+$/,""),u=urlHelper.path(n),f=new this(c,u,o||"",l);return a&&f.register(),f.debug=r,f}},{key:"ensure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.namespace;if(!t)throw new Error("L2LClient needs server url!");var n=urlHelper.root(t).replace(/\/+$/,""),o=urlHelper.path(t),i=this.clientKey(n,o,r||""),a=this.clients.get(i);return a||this.clients.set(i,a=this.create(_objectSpread(_objectSpread({},e),{},{url:t,namespace:r}))),a}},{key:"clients",get:function(){return this._clients||(this._clients=new Map)}}]),_createClass(u,[{key:"isOnline",value:function(){return this.socket&&this.socket.connected}},{key:"isRegistered",value:function(){return this.isOnline()&&!!this.trackerId}},{key:"open",value:(l=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,r,n,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isOnline()){e.next=2;break}return e.abrupt("return",this);case 2:if(!this._reconnectState.isOpening){e.next=4;break}return e.abrupt("return",this);case 4:return e.next=6,this.close();case 6:return this._reconnectState.closed=!1,t=urlHelper.join(this.origin,this.namespace),r={path:this.path,transports:["websocket","polling"]},n=this._socketioClient=ioClient(t,r),this.debug&&console.log("[".concat(this,"] connecting")),n.on("error",(function(e){o._reconnectState.isOpening=!1,o.debug&&console.log("[".concat(o,"] errored: ").concat(e))})),n.on("close",(function(e){return o.debug&&console.log("[".concat(o,"] closed: ").concat(e))})),n.on("reconnect_failed",(function(){return o.debug&&console.log("[".concat(o,"] could not reconnect"))})),n.on("reconnect_error",(function(e){return o.debug&&console.log("[".concat(o,"] reconnect error ").concat(e))})),n.on("connect",(function(){o.debug&&console.log("[".concat(o,"] connected")),o.emit("connected",o),o._reconnectState.isOpening=!1,o._reconnectState.isReconnecting=!1,o._reconnectState.isReconnectingViaSocketio=!1})),n.on("disconnect",(function(){if(o._reconnectState.isOpening=!1,o.debug&&console.log("[".concat(o,"] disconnected")),o.emit("disconnected",o),!o.trackerId)return o.debug&&console.log("[".concat(o,"] disconnect: don't have a tracker id, won't try reconnect")),void(o.trackerId="tracker");"tracker"!==o.trackerId&&(o.renameTarget(o.trackerId,"tracker"),o.trackerId=null),o._reconnectState.closed?o.debug&&console.log("[".concat(o,"] won't reconnect b/c client is marked as closed")):o._reconnectState.autoReconnect?(o._reconnectState.isReconnecting=!0,setTimeout((function(){o._reconnectState.closed?o.debug&&console.log("[".concat(o,"] won't reconnect b/c client is marked as closed 2")):o._reconnectState.isReconnectingViaSocketio?o.debug&&console.log("[".concat(o,"] won't reconnect again, client already reconnecting")):(o.debug&&console.log("[".concat(o,"] initiating reconnection to tracker")),o.register())}),20)):o.debug&&console.log("[".concat(o,"] won't reconnect b/c client has reconnection disabled"))})),n.on("reconnecting",(function(){o.debug&&console.log("[".concat(o,"] reconnecting"),o._reconnectState),o.emit("reconnecting",o),o._reconnectState.closed?(o._reconnectState.isReconnecting=!1,o._reconnectState.isReconnectingViaSocketio=!1,n.close(),o.close()):(o._reconnectState.isReconnecting=!0,o._reconnectState.isReconnectingViaSocketio=!0)})),n.on("reconnect",(function(){o.debug&&console.log("[".concat(o,"] reconnected")),o._reconnectState.isReconnecting=!1,o._reconnectState.isReconnectingViaSocketio=!1,o.register()})),this.installEventToMessageTranslator(n),this._reconnectState.isOpening=!0,e.abrupt("return",new Promise((function(e,t){n.once("error",t),n.once("connect",e)})).then((function(){return o})));case 22:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"close",value:(s=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._reconnectState.closed=!0,(t=this.socket)&&(t.removeAllListeners("reconnect"),t.removeAllListeners("reconnecting"),t.removeAllListeners("disconnect"),t.removeAllListeners("connect"),t.removeAllListeners("reconnect_error"),t.removeAllListeners("reconnect_failed"),t.removeAllListeners("close"),t.removeAllListeners("error"),t.close()),this.debug&&console.log("[".concat(this,"] closing...")),!this.isRegistered()){e.next=7;break}return e.next=7,this.unregister();case 7:if(this.isOnline()||this.socket){e.next=10;break}return this.debug&&(r=this.isOnline()?"no socket":"not online",this.debug&&console.log("[".concat(this,"] cannot close: ").concat(r))),e.abrupt("return",this);case 10:if(!t||t.connected){e.next=13;break}return this.debug&&console.log("[".concat(this,"] socket not connected, considering client closed")),e.abrupt("return",this);case 13:return e.abrupt("return",Promise.race([promise.delay(2e3).then((function(){return t.removeAllListeners("disconnect")})),new Promise((function(e){return t.once("disconnect",e)}))]).then((function(){return n.debug&&console.log("[".concat(n,"] closed")),n})));case 14:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"remove",value:function(){var e=this.origin,t=this.path,r=this.namespace,n=this.constructor.clientKey(e,t,r);return this.constructor.clients.delete(n),this.close()}},{key:"register",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,r,n,o,i,a,s,l,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isRegistered()){e.next=2;break}return e.abrupt("return");case 2:if(!this._reconnectState.closed){e.next=6;break}return this.debug&&console.log("[".concat(this,"] not registering this b/c closed")),this._reconnectState.registerAttempt=0,e.abrupt("return");case 6:if(!this._reconnectState.registerProcess){e.next=9;break}return this.debug&&console.log("[".concat(this,"] not registering this b/c register process exists")),e.abrupt("return");case 9:if(e.prev=9,this.isOnline()){e.next=13;break}return e.next=13,this.open();case 13:return this.debug&&console.log("[".concat(this,"] register")),e.next=16,this.sendToAndWait("tracker","register",_objectSpread({userName:"unknown",type:"l2l "+(isNode$2?"node":"browser"),location:determineLocation()},this.info));case 16:if((t=e.sent).data){e.next=21;break}throw r=new Error("Register answer is empty!"),this.emit("error",r),r;case 21:if(!t.data.isError){e.next=25;break}throw n=new Error(t.data.error),this.emit("error",n),n;case 25:this._reconnectState.registerAttempt=0,o=t.data,i=o.trackerId,a=o.messageNumber,this.trackerId=i,this._incomingOrderNumberingBySenders.set(i,a||0),this.emit("registered",{trackerId:i}),e.next=38;break;case 32:e.prev=32,e.t0=e.catch(9),console.error("Error in register request of ".concat(this,": ").concat(e.t0)),s=this._reconnectState.registerAttempt++,l=backoff(s,4,3e5),this._reconnectState.registerProcess=setTimeout((function(){c._reconnectState.registerProcess=null,c.register()}),l);case 38:case"end":return e.stop()}}),e,this,[[9,32]])}))),function(){return a.apply(this,arguments)})},{key:"unregister",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isRegistered()){e.next=2;break}return e.abrupt("return");case 2:return this.debug&&console.log("[".concat(this,"] unregister")),t=this.trackerId,e.prev=4,e.next=7,this.sendToAndWait(this.trackerId,"unregister",{});case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:this.renameTarget(t,"tracker"),this.trackerId=null,this.emit("unregistered",this);case 14:case"end":return e.stop()}}),e,this,[[4,9]])}))),function(){return i.apply(this,arguments)})},{key:"whenRegistered",value:function(e){var t=this;return promise.waitFor(e,(function(){return t.isRegistered()})).catch((function(e){return Promise.reject(/timeout/i.test(String(e))?new Error("Timeout in ".concat(t,".whenRegistered")):e)}))}},{key:"send",value:function(e,t){var r=this,n=_slicedToArray2(this.prepareSend(e,t),2);e=n[0],t=n[1],this.whenOnline().then((function(){var n=r.socket,o=e,i=o.action,a=o.target;if(!n)throw new Error("Trying to send message ".concat(i," to ").concat(a," but cannot find a connection to it!"));"function"==typeof t?n.emit(i,e,t):n.emit(i,e)}))}},{key:"joinRoom",value:function(e){var t=this;return this.whenOnline().then((function(){return t.sendToAndWait(t.trackerId,"[broadcast] join room",{room:e})}))}},{key:"leaveRoom",value:function(e){var t=this;return this.whenOnline().then((function(){return t.sendToAndWait(t.trackerId,"[broadcast] leave room",{room:e})}))}},{key:"broadcast",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a={action:t,room:e,broadcast:r};return o&&(a.isSystemBroadcast=!0),i&&(a.isMultiServerBroadcast=!0),this.whenOnline().then((function(){return n.sendToAndWait(n.trackerId,"[broadcast] send",a)}))}},{key:"listRoomMembers",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendToAndWait(this.trackerId,"[broadcast] list room members",{room:t});case 2:return r=e.sent,n=r.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"joinedRooms",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendToAndWait(this.trackerId,"[broadcast] my rooms",{});case 2:return t=e.sent,r=t.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"listRooms",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendToAndWait(this.trackerId,"[broadcast] all rooms",{});case 2:return t=e.sent,r=t.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"listPeers",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,r,n,o,i,a,s,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]&&l[0],r=this._peersCached,n=Date.now(),o=1e3,!(!t&&r&&n-r.timestamp<o)){e.next=6;break}return e.abrupt("return",this._peersCached.sessions);case 6:if(this.isOnline()){e.next=8;break}return e.abrupt("return",[]);case 8:return e.next=10,this.sendToAndWait(this.trackerId,"getClients",{});case 10:return i=e.sent,a=i.data,s=a.map((function(e){var t=_slicedToArray2(e,2),r=t[0],n=t[1],o=n.info||{},i=o.userRealm,a=o.userToken,s=o.l2lUserToken,l=o.location,c=o.type,u=o.world,f=_objectSpread(_objectSpread({},dissoc(n,["info"])),{},{id:r,world:u,location:l,type:c});return(a=a||s)&&"null"!==a&&(lively.user?f.user=lively.user.ClientUser.fromToken(a,i):(f.userToken=a,f.userRealm=i)),f})),this._peersCached={timestamp:n,sessions:s},e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"toString",value:function(){var e=this.origin,t=this.path,r=this.namespace,n=this.id,o=this.isOnline()?this.isRegistered()?"registered":"unregistered":"disconnected",i=(n||"").slice(0,5);return"L2LClient(".concat(i," ").concat(e).concat(t," - ").concat(r," ").concat(o,")")}},{key:"socket",get:function(){return this._socketioClient}},{key:"socketId",get:function(){return this.socket?this.socket.id:null}}]),u}();module.exports=L2LClient;
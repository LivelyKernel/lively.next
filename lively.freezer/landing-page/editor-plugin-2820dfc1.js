System.register("./__rootModule___commonjs-entry-51a55f66.js ./ui.cp-8dfc076f.js ./editor-plugin-5397d87c.js @babel/plugin-syntax-import-meta ./loading-indicator.cp-98e470a2.js ./index-61952933.js ./tooltips.cp-3c41b378.js ./index-42118cd5.js ./interface-1a7f3c67.js ./index-616023be.js ./popups.cp-5b9fb681.js ./list.cp-840d1cf8.js ./editor-modes-aae4d878.js".split(" "),function(bd){var Dd,se,Rc,ad,Ne,Cb,Sd,ve,uc,dd,vd,Ed,fe,jc,Od,qb;return{setters:[function(ic){Dd=ic.s;se=ic.t;Rc=ic.i;ad=ic.K;Ne=
ic.N;Cb=ic.bx;Sd=ic.by;ve=ic.v;uc=ic.l;dd=ic.Y;vd=ic.o;Ed=ic._;fe=ic.b;jc=ic.F},function(ic){Od=ic.s},function(ic){qb=ic["default"]},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){function ic(){ic=Ed(regeneratorRuntime.mark(function wb(Aa){var Na,hb,Bb,ba,dc,la,Fb,vb,Ia,xb,Rb,yc,id,ob;return regeneratorRuntime.wrap(function(Pb){for(;;)switch(Pb.prev=Pb.next){case 0:Na={},hb="lively.shell-default-command-group-"+
ka.string.newUUID(),Bb=0,ba=Ne(Aa),Pb.prev=4,ba.s();case 6:if((dc=ba.n()).done){Pb.next=22;break}la=dc.value;Fb=la.name;vb=la.command;Ia=la.options;xb=la.transform;Rb=la.readFile;yc=la.writeFile;id=la.content;Ia=Ia||{};hb||(Ia.group=hb);Rb?(ka.runCommand=readFileFn,vb=Rb):yc&&(ka.runCommand=writeFileFn,vb=yc,Ia=Ia||{},id&&(Ia.content=id));Rb||yc||(vb=vb.replace(/\$\{([^\}]+)\}/g,function(tb,xc){return Na[xc]&&Na[xc].isShellCommand?Na[xc].output:Na[xc]||""}));console.log("Running ".concat(vb," with options"),
Ia);Pb.next=15;return ka.runCommand(vb,Ia);case 15:return ob=Pb.sent,Pb.next=18,ob.whenDone();case 18:Fb=Fb||String(Bb++),Na[Fb]="function"===typeof xb?xb(ob):ob;case 20:Pb.next=6;break;case 22:Pb.next=27;break;case 24:Pb.prev=24,Pb.t0=Pb["catch"](4),ba.e(Pb.t0);case 27:return Pb.prev=27,ba.f(),Pb.finish(27);case 30:return Pb.abrupt("return",Na);case 31:case "end":return Pb.stop()}},wb,null,[[4,24,27,30]])}));return ic.apply(this,arguments)}function Wb(M){return lc.apply(this,arguments)}function lc(){lc=
Ed(regeneratorRuntime.mark(function wb(Aa){var Na,hb,Bb,ba,dc=arguments;return regeneratorRuntime.wrap(function(la){for(;;)switch(la.prev=la.next){case 0:Na=1<dc.length&&void 0!==dc[1]?dc[1]:{cwd:null};hb=["--no-pager"];if(!Na.cwd){la.next=6;break}la.t0=Na.cwd;la.next=9;break;case 6:return la.next=8,ka.defaultDirectory();case 8:la.t0=la.sent;case 9:Bb=la.t0;Aa.map(function(Fb){Fb.gitCommand&&(Array.isArray(Fb.gitCommand)&&(Fb.gitCommand=Fb.gitCommand.join(" ")),Fb.command=["git"].concat(hb).concat([Fb.gitCommand]).join(" "));
Fb.options=Object.assign({cwd:Bb,group:"lively-git-interface"},Fb.options);return Fb}).filter(Boolean);if(Na.dryRun){la.next=16;break}la.next=14;return ka.runCommands(Aa);case 14:ba=la.sent,ba=Object.keys(ba||{}).reduce(function(Fb,vb){var Ia=Fb[vb];if(!Ia||!Ia.isShellCommand)return Fb;Fb["cmd"+ka.string.capitalize(vb)]=Ia;Fb[vb]=Ia.output;return Fb},ba);case 16:return la.abrupt("return",ba);case 17:case "end":return la.stop()}},wb)}));return lc.apply(this,arguments)}function db(M){return Xa.apply(this,
arguments)}function Xa(){Xa=Ed(regeneratorRuntime.mark(function wb(Aa){var Na,hb,Bb,ba,dc;return regeneratorRuntime.wrap(function(la){for(;;)switch(la.prev=la.next){case 0:dc=function(Fb){var vb=Fb.statusString,Ia=Fb.status,xb="",Rb=vb.slice(3);vb=vb.slice(0,2);var yc=vb[0],id=vb[1];Ia="unstaged"===Ia?id:yc;"DD"===vb?xb="unmerged, deleted locally and remotely":"AU"===vb?xb="unmerged, added locally and modified remotely":"UD"===vb?xb="unmerged, modified locally and deleted remotely":"UA"===vb?xb="unmerged, modified locally and added remotely":
"DU"===vb?xb="unmerged, deleted locally and modified remotely":"AA"===vb?xb="unmerged, added locally and remotely":"UU"===vb?xb="unmerged, modified locally and remotely":"M"===Ia?xb="modfied":"R"===Ia?xb="renamed":"C"===Ia?xb="copied":"A"===Ia?xb="added":"D"===Ia&&(xb="deleted");if("renamed"===xb||"copied"===xb)Rb=Rb.split("->").last().trim();Fb.change=xb;Fb.fileName=Rb;return Fb};la.t0=Aa;if(la.t0){la.next=7;break}la.next=6;return ka.defaultDirectory();case 6:la.t0=la.sent;case 7:return Aa=la.t0,
Na=[{name:"status",gitCommand:"status --porcelain",transform:function(Fb){return Fb.output}}],la.prev=9,la.next=12,ka.runGitCommands(Na,{cwd:Aa});case 12:Bb=(hb=la.sent)&&hb.status.split("\n");ba=(Bb||[]).flatMap(function(Fb){if(!Fb)return[];var vb,Ia=[];(vb=Fb.match(/^(\s[A-Z]|[A-Z]{2})(.*)/))&&Ia.push({status:"unstaged",statusString:vb[0]});(vb=Fb.match(/^[A-Z]{1,2}(.*)/))&&Ia.push({status:"staged",statusString:vb[0]});(vb=Fb.match(/^\s*\?\?(.*)/))&&Ia.push({status:"untracked",statusString:vb[0]});
return Ia}).filter(Boolean);la.next=20;break;case 17:la.prev=17,la.t1=la["catch"](9),Error("failed to run git status on "+Aa+"\n"+la.t1);case 20:return la.abrupt("return",ba.map(dc));case 21:case "end":return la.stop()}},wb,null,[[9,17]])}));return Xa.apply(this,arguments)}function Gb(M,Aa){return sc.apply(this,arguments)}function sc(){sc=Ed(regeneratorRuntime.mark(function Na(Aa,wb){var hb,Bb,ba,dc,la,Fb,vb,Ia,xb=arguments;return regeneratorRuntime.wrap(function(Rb){for(;;)switch(Rb.prev=Rb.next){case 0:hb=
2<xb.length&&void 0!==xb[2]?xb[2]:{};if(Bb=wb.pluginFind(function(yc){return yc.isDiffEditorPlugin})){Rb.next=4;break}throw Error("Editor ".concat(wb," has no diff mode"));case 4:if(ba=!wb.selection.isEmpty())dc=Bb.getPatchesFromSelection(wb),dc[0].createPatchString();else{Fb=(la=Bb.getPatchAtCursor(wb))||{};vb=Fb.patch;if(Ia=Fb.hunk)vb=vb.copy(),vb.hunks=[Ia];dc=vb?[vb]:null}if(dc){Rb.next=8;break}throw Error("Could not read patches");case 8:return Rb.next=10,ka.applyPatches(Aa,dc,hb);case 10:return Rb.abrupt("return",
Rb.sent);case 11:case "end":return Rb.stop()}},Na)}));return sc.apply(this,arguments)}function ub(M,Aa){return sb.apply(this,arguments)}function sb(){sb=Ed(regeneratorRuntime.mark(function Na(Aa,wb){var hb,Bb,ba,dc,la=arguments;return regeneratorRuntime.wrap(function(Fb){for(;;)switch(Fb.prev=Fb.next){case 0:return hb=2<la.length&&void 0!==la[2]?la[2]:{},console.assert("stage"===Aa||"unstage"===Aa||"discard"===Aa||"apply"===Aa||"reverseApply"===Aa,Aa+" is not expected action"),console.assert(wb,"gitApply needs patches"),
Bb=[],"unstage"!==Aa&&"discard"!==Aa&&"reverseApply"!==Aa||Bb.push("--reverse"),"stage"!==Aa&&"unstage"!==Aa&&"discard"!==Aa||Bb.push("--cached"),ba=[{name:"gitApply",options:{stdin:ka.arr.invoke(wb,"createPatchString").join("\n")},command:"git apply "+Bb.join(" ")+" -"}],"discard"===Aa&&ba.push({name:"gitApply",options:{stdin:ka.arr.invoke(wb,"createPatchString").join("\n")},command:"git apply --reverse -"}),Fb.next=10,ka.runGitCommands(ba,hb);case 10:dc=Fb.sent;if(!(dc.hasOwnProperty("gitApply")&&
0<dc.cmdGitApply.exitCode)){Fb.next=13;break}throw Error("Could not apply patch:\n"+dc.cmdGitApply.stderr);case 13:return Fb.abrupt("return",{commands:dc,patches:wb});case 14:case "end":return Fb.stop()}},Na)}));return sb.apply(this,arguments)}function fa(M,Aa){return Db.apply(this,arguments)}function Db(){Db=Ed(regeneratorRuntime.mark(function Na(Aa,wb){var hb,Bb,ba,dc,la,Fb=arguments;return regeneratorRuntime.wrap(function(vb){for(;;)switch(vb.prev=vb.next){case 0:return hb=2<Fb.length&&void 0!==
Fb[2]?Fb[2]:{},console.assert("stage"===Aa||"unstage"===Aa||"discard"===Aa,Aa+" is not expected action"),console.assert(wb,"stageOrUnstage needs file status objects"),"stage"===Aa&&(Bb=function(Ia){return"unstaged"===Ia.status}),"unstage"===Aa&&(Bb=function(Ia){return"staged"===Ia.status}),"discard"===Aa&&(Bb=function(Ia){return!0}),ba=wb.reduce(function(Ia,xb){if(!Bb(xb))return Ia;var Rb=[];"unstage"!==Aa&&"discard"!==Aa||Rb.push(Ia.reset);"discard"===Aa&&Rb.push(Ia.checkout);"unstage"!==Aa&&"discard"!==
Aa||"staged"!==xb.status||"added"!==xb.change||Rb.push(Ia.rmCached);"stage"===Aa&&"unstaged"===xb.status&&"deleted"===xb.change?Rb.push(Ia.rm):"stage"===Aa&&Rb.push(Ia.add);ka.arr.invoke(Rb,"push",xb.fileName);return Ia},{checkout:[],reset:[],rmCached:[],rm:[],add:[]}),dc=[],ba.rm.length&&dc.push({name:"rm",gitCommand:"rm -- "+ba.rm.join(" ")}),ba.rmCached.length&&dc.push({name:"rm",gitCommand:"rm --cached -- "+ba.rmCached.join(" ")}),ba.add.length&&dc.push({name:"add",gitCommand:"add -- "+ba.add.join(" ")}),
ba.reset.length&&dc.push({name:"reset",gitCommand:"reset -- "+ba.reset.join(" ")}),ba.checkout.length&&dc.push({name:"checkout",gitCommand:"checkout -- "+ba.checkout.join(" ")}),vb.next=15,ka.runGitCommands(dc,hb);case 15:return la=vb.sent,vb.abrupt("return",{commands:la,fileObjects:wb});case 17:case "end":return vb.stop()}},Na)}));return Db.apply(this,arguments)}function ab(M){return eb.apply(this,arguments)}function eb(){eb=Ed(regeneratorRuntime.mark(function wb(Aa){var Na,hb,Bb,ba,dc,la,Fb,vb,
Ia,xb,Rb,yc,id,ob;return regeneratorRuntime.wrap(function(Pb){for(;;)switch(Pb.prev=Pb.next){case 0:return ob=function(){ob=Ed(regeneratorRuntime.mark(function Pc(xc){var nd,Id,Hb,Kd,vc,Qc,kb,Cc,zc,Fc;return regeneratorRuntime.wrap(function(xd){for(;;)switch(xd.prev=xd.next){case 0:Fc=function(Uc,Md,Ob){return ka.runGitCommands([{name:"set username",gitCommand:'config user.name "'+Uc+'"',options:Ob},{name:"set email",gitCommand:'config user.email "'+Md+'"',options:Ob}])};zc=function(){zc=Ed(regeneratorRuntime.mark(function Ob(Md){var Le;
return regeneratorRuntime.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return We.next=2,Na.prompt("Please also enter your email:",{input:localStorage.getItem("GitUserEmail")||""});case 2:if((Le=We.sent)&&Le.length){We.next=5;break}throw Error("Missing email");case 5:return localStorage.setItem("GitUserEmail",Le),We.abrupt("return",Le);case 7:case "end":return We.stop()}},Ob)}));return zc.apply(this,arguments)};Cc=function(Uc){return zc.apply(this,arguments)};kb=function(){kb=Ed(regeneratorRuntime.mark(function Md(){var Ob;
return regeneratorRuntime.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return Le.next=2,Na.prompt("Git does not yet know your name. Please enter it here:",{input:localStorage.getItem("GitUserName")||""});case 2:if((Ob=Le.sent)&&Ob.length){Le.next=5;break}throw Error("Missing username");case 5:return localStorage.setItem("GitUserName",Ob),Le.abrupt("return",Ob);case 7:case "end":return Le.stop()}},Md)}));return kb.apply(this,arguments)};Qc=function(){return kb.apply(this,arguments)};vc=
function(){vc=Ed(regeneratorRuntime.mark(function Ob(Md){var Le,We,xe,Fg;return regeneratorRuntime.wrap(function(Zc){for(;;)switch(Zc.prev=Zc.next){case 0:return Le=[{name:"get username",gitCommand:"config --get user.name",options:Md},{name:"get email",gitCommand:"config --get user.email",options:Md}],Zc.next=3,ka.runGitCommands(Le);case 3:return xe=(We=Zc.sent)?We["get email"].trim():"",Fg=We?We["get username"].trim():"",Zc.abrupt("return",{user:Fg,email:xe});case 7:case "end":return Zc.stop()}},
Ob)}));return vc.apply(this,arguments)};Kd=function(Uc){return vc.apply(this,arguments)};nd=xc.user;Id=xc.email;if(!nd||!Id){xd.next=10;break}return xd.abrupt("return",{user:nd,email:Id});case 10:if(ka.isPublicServer){xd.next=16;break}xd.next=13;return Kd(xc);case 13:Hb=xd.sent,nd=Hb.user,Id=Hb.email;case 16:if(nd){xd.next=20;break}xd.next=19;return Qc();case 19:nd=xd.sent;case 20:if(Id){xd.next=24;break}xd.next=23;return Cc();case 23:Id=xd.sent;case 24:if(ka.isPublicServer){xd.next=27;break}xd.next=
27;return Fc(nd,Id,xc);case 27:return xd.abrupt("return",{user:nd,email:Id});case 28:case "end":return xd.stop()}},Pc)}));return ob.apply(this,arguments)},id=function(tb){return ob.apply(this,arguments)},yc=function(){yc=Ed(regeneratorRuntime.mark(function Id(xc,Pc,nd){var Hb,Kd;return regeneratorRuntime.wrap(function(vc){for(;;)switch(vc.prev=vc.next){case 0:if(!Aa.askForCommitInLively){vc.next=10;break}vc.next=3;return Na.prompt("Please enter a commit message:",{textMode:"text",historyId:"lively.git.commit",
input:"empty commit message"});case 3:if(Hb=vc.sent){vc.next=6;break}throw Error("No commit message, commit aborted.");case 6:return Kd=[{name:"commit",gitCommand:xb(Hb,Pc,nd),options:xc}],vc.abrupt("return",ka.runGitCommands(Kd));case 10:return Kd=[{name:"commit",gitCommand:xb(null,Pc,nd),options:xc}],vc.abrupt("return",ka.runGitCommands(Kd));case 12:case "end":return vc.stop()}},Id)}));return yc.apply(this,arguments)},Rb=function(tb,xc,Pc){return yc.apply(this,arguments)},xb=function(tb,xc,Pc){var nd=
"commit";ka.isPublicServer&&(xc=xc||"unknown-author",Pc=Pc||xc+"@"+document.location.hostname,nd+=ka.string.format(" --author='%s <%s>'",xc,Pc));tb&&(nd+=' -m "'+tb.replace(/"/g,'\\"')+'"');return nd},Aa=Object.assign({askForCommitInLively:!1},Aa),Na=$world,Pb.next=9,id(Aa);case 9:return hb=Pb.sent,Bb=hb.user,ba=hb.email,Pb.next=14,Rb(Aa,Bb,ba);case 14:dc=Pb.sent;la=dc.cmdCommit;Fb=la.exitCode;vb=la.stderr;Ia=la.output;if(!Fb){Pb.next=21;break}throw Error("Commit failed: "+vb);case 21:return Pb.abrupt("return",
Ia);case 22:case "end":return Pb.stop()}},wb)}));return eb.apply(this,arguments)}function kc(){kc=Ed(regeneratorRuntime.mark(function hb(Aa,wb,Na){var Bb,ba,dc,la,Fb,vb,Ia;return regeneratorRuntime.wrap(function(xb){for(;;)switch(xb.prev=xb.next){case 0:return Na=Object.assign({dryRun:!1},Na),Bb=Aa.pluginFind(function(Rb){return Rb.isDiffEditorPlugin}),ba=Fa.arr.pluck(Bb.patches,"fileNameA"),xb.next=5,Fa.git.fileStatus(Na.cwd,Na);case 5:return dc=xb.sent,la=dc.filter(function(Rb){return ba.includes(Rb.fileName)}),
xb.next=9,Fa.git.stageOrUnstageOrDiscardFiles(wb,la,Na);case 9:return Fb=xb.sent,vb=Fb.commands,Ia=Fb.fileObjects,Aa.setStatusMessage(Fa.string.capitalize(wb)+"\n"+Fa.arr.pluck(Ia,"fileName").join("\n")),xb.abrupt("return",{commands:vb,fileObjects:Ia});case 14:case "end":return xb.stop()}},hb)}));return kc.apply(this,arguments)}function Vb(){Vb=Ed(regeneratorRuntime.mark(function hb(Aa,wb,Na){var Bb,ba,dc;return regeneratorRuntime.wrap(function(la){for(;;)switch(la.prev=la.next){case 0:return Na=
Object.assign({dryRun:!1},Na),la.next=3,Fa.git.applyPatchesFromEditor(wb,Aa,Na);case 3:return Bb=la.sent,ba=Bb.commands,dc=Bb.patches,Aa.setStatusMessage(Fa.string.capitalize(wb)+"\n"+Fa.arr.invoke(dc,"createPatchString").join("\n")),la.abrupt("return",{commands:ba,patches:dc});case 8:case "end":return la.stop()}},hb)}));return Vb.apply(this,arguments)}var pb=window.lively.FreezerRuntime.recorderFor("lively.ide/diff/file-patch.js");pb.arr=Dd;pb.string=se;var Nb=function(M){var Aa=window.lively.FreezerRuntime.recorderFor("lively.ide/diff/file-patch.js"),
wb=Aa.hasOwnProperty("FilePatch")&&"function"===typeof Aa.FilePatch?Aa.FilePatch:Aa.FilePatch=function(Na){if(!Na||!Na[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Rc(wb,M,[{key:Symbol["for"]("lively-instance-initialize"),value:function(){this.lines=[];this.headerLines=[];this.hunks=[];this.command=this.fileNameB=this.fileNameA=this.pathChanged=this.pathOriginal=""}},{key:"copy",value:function(){return Object.assign(new this.constructor,
this)}},{key:"isFilePatch",get:function(){return!0}},{key:"read",value:function(Na){this.lines=Array.isArray(Na)?Na:pb.string.lines(Na);Na=this.lines.slice();var hb=this.hunks;""===Na[Na.length-1]&&Na.pop();var Bb=this.headerLines=pb.arr.takeWhile(Na,function(Ia){return!Ia.startsWith("---")});Bb.length&&!Bb[0].match(/^index/i)&&(this.command=Bb[0]);Na=Na.slice(Bb.length);var ba=ad(Na,2),dc=ba[0];ba=ba[1];if(dc&&dc.startsWith("---")){var la=dc.match(/^---\s*([^\s]+)/);la=ad(la,2);la[0];this.pathOriginal=
la=la[1];this.fileNameA=la.replace(/^a\//,"");Bb.push(dc)}ba&&ba.startsWith("+++")&&(dc=ba.match(/^\+\+\+\s*([^\s]+)/),dc=ad(dc,2),dc[0],this.pathChanged=la=dc[1],this.fileNameB=la.replace(/^b\//,""),Bb.push(ba));for(;0<Na.length;){Bb=pb.FilePatchHunk.read(Na,Fb,vb);var Fb=Bb.pathOriginal;var vb=Bb.pathChanged;Bb.patch=this;hb.push(Bb)}return this}},{key:"reverse",value:function(){return pb.FilePatch.read(this.createPatchString(!0))}},{key:"createPatchStringHeader",value:function(Na){return pb.arr.takeWhile(this.headerLines,
function(hb){return!hb.startsWith("---")}).join("\n")}},{key:"createPatchString",value:function(Na){return this.createPatchStringHeader(Na)+"\n"+this.hunks.map(function(hb,Bb){return hb.createPatchString(Na,0===Bb)}).join("\n")+"\n"}},{key:"createPatchStringFromRows",value:function(Na,hb,Bb){var ba=this.hunks,dc=this.headerLines.length,la=[];Na=Math.max(Na,dc)-dc;hb-=dc;var Fb=!1;la=ba.map(function(vb,Ia){Ia=vb.createPatchStringFromRows(Na,hb,Bb,!Fb);Fb=Fb||!!Ia;Na-=vb.length;hb-=vb.length;return Ia}).filter(Boolean);
return 0===la.length?null:this.createPatchStringHeader()+"\n"+la.join("\n")+"\n"}},{key:"changesByLines",value:function(){return pb.arr.invoke(this.hunks,"changesByLines").flat()}},{key:"length",value:function(){return this.lines.length}},{key:"patch",value:function(Na){return this.changesByLines().reduce(function(hb,Bb,ba){var dc=Bb.lineNoAdded-1,la=Bb.removed.replace(/\n$/,""),Fb=la?pb.string.lines(la).length:0,vb=hb.slice(dc,dc+Fb).join("\n");if(la!==vb)throw hb=pb.string.format('Change %s not matching: Expected "%s", got "%s"',
ba+1,la,vb),Error(hb);Bb=Bb.added?Bb.added:"";Fb=dc+Fb;return hb.slice(0,dc).concat(Bb?pb.string.lines(Bb.replace(/\n$/,"")):[]).concat(hb.slice(Fb))},pb.string.lines(Na)).join("\n")}},{key:"hunkForRow",value:function(Na){Na-=this.headerLines.length;return 0>Na?null:this.hunks.find(function(hb){Na-=(hb.header?1:0)+hb.lines.length;if(0>Na)return!0})}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"FilePatch"}},{key:"read",value:function(Na){return(new this).read(Na)}},{key:"readAll",
value:function(Na){return pb.string.lines(Na).reduce(function(hb,Bb){var ba=pb.arr.last(hb);ba?Bb.match(/^(---|\+\+\+|@@|-|\+|\\| )/)?ba.push(Bb):1===ba.length?ba.push(Bb):""!==Bb&&hb.push([Bb]):hb.push([Bb]);return hb},[]).map(function(hb){return pb.FilePatch.read(hb)})}},{key:"hunkOrPatchForRow",value:function(Na){var hb=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,Bb=0,ba=0,dc=Ne(Na),la;try{for(dc.s();!(la=dc.n()).done;){var Fb=la.value;ba+=Fb.length();if(hb<ba)break;Bb=ba}}catch(vb){dc.e(vb)}finally{dc.f()}return Fb?
Fb.hunkForRow(hb-Bb)||Fb:null}}],Aa,{pathInPackage:function(){return"./diff/file-patch.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:50,end:5858})}(void 0);pb.FilePatch=Nb;pb.FilePatch=Nb;var zb=function(M){var Aa=window.lively.FreezerRuntime.recorderFor("lively.ide/diff/file-patch.js"),wb=Aa.hasOwnProperty("FilePatchHunk")&&"function"===
typeof Aa.FilePatchHunk?Aa.FilePatchHunk:Aa.FilePatchHunk=function(Na){if(!Na||!Na[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Rc(wb,M,[{key:Symbol["for"]("lively-instance-initialize"),value:function(){this.patch=null;this.header=this.fileNameB=this.fileNameA=this.pathChanged=this.pathOriginal="";this.changedLength=this.changedLine=this.originalLength=this.originalLine=-1;this.lines=[]}},{key:"isFilePatchHunk",get:function(){return!0}},
{key:"read",value:function(Na,hb,Bb){this.pathOriginal=hb||"";this.pathChanged=Bb||"";for(hb=Na.shift();!hb.startsWith("---")&&!hb.startsWith("@@");)hb=Na.shift();hb.startsWith("---")&&(this.pathOriginal=hb.split(" ")[1]||this.pathOriginal,hb=Na.shift());this.fileNameA=this.pathOriginal.replace(/^a\//,"");hb.startsWith("+++")&&(this.pathChanged=hb.split(" ")[1]||this.pathChanged,hb=Na.shift());this.fileNameB=this.pathChanged.replace(/^b\//,"");Bb=hb.match(/^@@\s*-([0-9]+),?([0-9]*)\s*\+([0-9]+),?([0-9]*)\s*@@/);
console.assert(Bb,"hunk header "+hb);this.header=Bb[0];this.originalLine=Number(Bb[1]);this.originalLength=Number(Bb[2]);this.changedLine=Number(Bb[3]);for(this.changedLength=Number(Bb[4]);Na[0]&&Na[0].match(/^[\+\-\s\\]/);)this.lines.push(Na.shift());this.length=this.lines.length+1;return this}},{key:"createPatchString",value:function(Na,hb){return this.printHeader(Na,hb)+"\n"+this.printLines(Na)}},{key:"createPatchStringFromRows",value:function(Na,hb,Bb,ba){if(1>hb||Na>=this.lines.length)return null;
var dc=this.originalLine,la=this.changedLine,Fb=0,vb=0,Ia=this.lines.reduce(function(Rb,yc,id){if(Rb.atEnd)return Rb;id++;if(id<Na)switch(yc[0]){case "+":case "-":return dc+=Rb.lines.length,la+=Rb.lines.length,Fb=vb=0,Rb.lines=[],Rb;case " ":vb++,Fb++}else if(id>hb)switch(yc[0]){case " ":vb++;Fb++;break;default:return Rb.atEnd=!0,Rb}else switch(yc[0]){case " ":vb++;Fb++;break;case "-":Fb++;break;case "+":vb++}if(Bb)switch(yc[0]){case "-":yc="+"+yc.slice(1);break;case "+":yc="-"+yc.slice(1)}Rb.lines.push(yc);
return Rb},{atEnd:!1,lines:[]}).lines;if(0===Ia.length)return null;var xb="";ba&&(xb="--- "+(Bb?this.pathChanged:this.pathOriginal)+"\n+++ "+(Bb?this.pathOriginal:this.pathChanged)+"\n");return[pb.string.format("%s@@ -%s,%s +%s,%s @@",xb,dc,Fb,la,vb)].concat(Ia).join("\n")}},{key:"changesByLines",value:function(){var Na=this.changedLine,hb=this.originalLine,Bb=0,ba=this.lines.reduce(function(dc,la,Fb){if(" "===la[0])return dc.current&&(dc.changes.push(dc.current),dc.current=null),dc;Fb=dc.current||
(dc.current={lineNoAdded:Na+Fb+Bb,lineNoRemoved:hb+Fb+Bb,added:"",removed:""});"+"===la[0]?(Fb.added+=la.slice(1)+"\n",Bb++):"-"===la[0]&&(Fb.removed+=la.slice(1)+"\n",Bb--);return dc},{changes:[],current:null});ba.current&&ba.changes.push(ba.current);return ba.changes}},{key:"relativeOffsetToFileLine",value:function(Na){return 0>=Na?this.changedLine-1:this.lines.slice(0,Na).reduce(function(hb,Bb){Bb=Bb[0];return"+"===Bb||" "===Bb?hb+1:hb},this.changedLine-2)}},{key:"printHeader",value:function(Na,
hb){var Bb="";hb&&(Bb="--- "+(Na?this.pathChanged:this.pathOriginal)+"\n+++ "+(Na?this.pathOriginal:this.pathChanged)+"\n");return pb.string.format("%s@@ -%s +%s @@",Bb,Na?this.changedLine+","+this.changedLength:this.originalLine+","+this.originalLength,Na?this.originalLine+","+this.originalLength:this.changedLine+","+this.changedLength)}},{key:"printLines",value:function(Na){return(Na?this.lines.map(function(hb){switch(hb[0]){case " ":return hb;case "+":return"-"+hb.slice(1);case "-":return"+"+hb.slice(1)}}):
this.lines).join("\n")}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"FilePatchHunk"}},{key:"read",value:function(Na,hb,Bb){return(new this).read(Na,hb,Bb)}}],Aa,{pathInPackage:function(){return"./diff/file-patch.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5866,end:13932})}(void 0);pb.FilePatchHunk=zb;pb.FilePatchHunk=
zb;var rb=window.lively.FreezerRuntime.recorderFor("lively.ide/diff/tokenizer.js");rb.FilePatch=Nb;zb=function(M){var Aa=window.lively.FreezerRuntime.recorderFor("lively.ide/diff/tokenizer.js"),wb=Aa.hasOwnProperty("DiffTokenizer")&&"function"===typeof Aa.DiffTokenizer?Aa.DiffTokenizer:Aa.DiffTokenizer=function(Na){if(!Na||!Na[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Rc(wb,M,[{key:"tokenize",value:function(Na){Na=
rb.FilePatch.readAll(Na);var hb={row:0,column:0},Bb=[],ba=0,dc=Ne(Na),la;try{for(dc.s();!(la=dc.n()).done;){var Fb=la.value,vb={column:0,row:hb.row+Fb.headerLines.length},Ia={patch:ba,string:Fb.headerLines.join("\n")+"\n",type:"diff-file-header",start:hb,end:vb};Bb.push(Ia);Fb.tokens=[Ia];hb=vb;var xb=0,Rb=Ne(Fb.hunks),yc;try{for(Rb.s();!(yc=Rb.n()).done;){var id=yc.value;vb={column:0,row:hb.row+1};Ia={patch:ba,hunk:xb,string:id.header+"\n",type:"diff-hunk-header",start:hb,end:vb};Bb.push(Ia);Fb.tokens.push(Ia);
id.tokens=[Ia];hb=vb;var ob=Ne(id.lines),Pb;try{for(ob.s();!(Pb=ob.n()).done;){var tb=Pb.value;vb={column:0,row:hb.row+1};var xc=tb.startsWith("+")?"inserted":tb.startsWith("-")?"deleted":"default";Ia={patch:ba,hunk:xb,string:tb+"\n",type:xc,start:hb,end:vb};Bb.push(Ia);Fb.tokens.push(Ia);id.tokens.push(Ia);hb=vb}}catch(Pc){ob.e(Pc)}finally{ob.f()}xb++}}catch(Pc){Rb.e(Pc)}finally{Rb.f()}ba++}}catch(Pc){dc.e(Pc)}finally{dc.f()}return{tokens:Bb,patches:Na}}}],[{key:Symbol["for"]("__LivelyClassName__"),
get:function(){return"DiffTokenizer"}}],Aa,{pathInPackage:function(){return"./diff/tokenizer.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:60,end:1744})}(void 0);rb["default"]=zb;var Ib=window.lively.FreezerRuntime.recorderFor("lively.ide/diff/navigator.js");Ib.lessEqPosition=Cb;Ib.lessPosition=Sd;Ib.obj=ve;Ib.arr=Dd;Ib.DiffTokenizer=
zb;Ib.show=Od;var da=function(M){var Aa=window.lively.FreezerRuntime.recorderFor("lively.ide/diff/navigator.js"),wb=Aa.hasOwnProperty("DiffNavigator")&&"function"===typeof Aa.DiffNavigator?Aa.DiffNavigator:Aa.DiffNavigator=function(Na){if(!Na||!Na[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Rc(wb,M,[{key:"ensureAST",value:function(Na){return(new Ib.DiffTokenizer).tokenize(Na.textString).tokens}},{key:"tokenStateAt",
value:function(Na){var hb=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Na.cursorPosition,Bb=Na.pluginFind(function(la){return la.isDiffEditorPlugin});if(!Bb)return null;var ba=Bb.tokens;Bb=Bb.patches;var dc=ba.findIndex(function(la){var Fb=la.end;return Ib.lessEqPosition(la.start,hb)&&Ib.lessPosition(hb,Fb)});return{token:ba[dc],tokenIndex:dc,tokens:ba,patches:Bb}}},{key:"findPatchAt",value:function(Na){var hb=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Na.cursorPosition;return(hb=
this.findContainingHunkOrPatch(Na,{start:hb,end:hb}))?hb.isFilePatchHunk?hb.patch:hb:null}},{key:"findHunkAt",value:function(Na){var hb=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Na.cursorPosition;return(hb=this.findContainingHunkOrPatch(Na,{start:hb,end:hb}))?hb.isFilePatchHunk?hb:null:null}},{key:"findPatchStart",value:function(Na,hb){return(Na=this.findPatchAt(Na,hb))?Na.tokens[0].start:hb}},{key:"findPatchEnd",value:function(Na,hb){return(Na=this.findPatchAt(Na,hb))?Ib.arr.last(Na.tokens).end:
hb}},{key:"findHunkStart",value:function(Na,hb){return(Na=this.findHunkAt(Na,hb))?Na.tokens[0].start:hb}},{key:"findHunkEnd",value:function(Na){var hb=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Na.cursorPosition,Bb=this.findHunkAt(Na,hb);return Bb?Ib.arr.last(Bb.tokens).end:hb}},{key:"backwardSexp",value:function(Na){var hb=this,Bb=Na.cursorPosition,ba=this.findHunkStart(Na),dc=this.findPatchStart(Na);Ib.obj.equals(Bb,ba)&&(Na.saveExcursion(function(){Na.selection.goLeft();ba=hb.findHunkStart(Na)}),
Ib.obj.equals(Bb,ba)&&(ba=null));Ib.obj.equals(Bb,dc)&&(Na.saveExcursion(function(){Na.selection.goLeft();dc=hb.findPatchStart(Na)}),Ib.obj.equals(Bb,dc)&&(dc=null));if(ba||dc)Na.cursorPosition=ba?dc?ba.row>dc.row?ba:dc:ba:dc,Na.scrollCursorIntoView()}},{key:"forwardSexp",value:function(Na){var hb=this,Bb=Na.cursorPosition,ba=hb.findHunkEnd(Na);Ib.obj.equals(Bb,ba)&&(Na.saveExcursion(function(){Na.selection.goRight();ba=hb.findHunkEnd(Na)}),Ib.obj.equals(Bb,ba)&&(ba=null));ba&&(Na.cursorPosition=
ba,Na.scrollCursorIntoView())}},{key:"backwardUpSexp",value:function(Na){Na.cursorPosition;var hb=this.findPatchStart(Na);hb&&(Na.cursorPosition=hb,Na.scrollCursorIntoView())}},{key:"forwardDownSexp",value:function(Na){Ib.show("Not yet implemented")}},{key:"findContainingHunkOrPatch",value:function(Na,hb){var Bb=this.tokenStateAt(Na,hb.start);Bb.tokens;var ba=Bb.patches;Bb=Bb.token;Na=this.tokenStateAt(Na,hb.end).token;return Bb.patch!=Na.patch?null:Bb.hasOwnProperty("hunk")&&Na.hasOwnProperty("hunk")&&
Bb.hunk===Na.hunk?ba[Bb.patch].hunks[Bb.hunk]:ba[Bb.patch]}},{key:"findContainingHunkOrPatchRange",value:function(Na,hb){Na=this.findContainingHunkOrPatch(Na,hb);if(!Na)return null;hb=Na.tokens;Na=hb[0].start;hb=Ib.arr.last(hb).end;return{start:Na,end:hb}}},{key:"expandRegion",value:function(Na,hb,Bb,ba){return(hb=this.findContainingHunkOrPatchRange(Na,Na.selection.range))?{range:[Na.positionToIndex(hb.start),Na.positionToIndex(hb.end)],prev:ba}:ba}},{key:"contractRegion",value:function(Na,hb,Bb,
ba){return ba.prev||ba}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"DiffNavigator"}}],Aa,{pathInPackage:function(){return"./diff/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:484,end:4994})}(void 0);Ib["default"]=da;var ka=window.lively.FreezerRuntime.recorderFor("lively.ide/shell/git.js");ka.runCommands=
function(M){return ic.apply(this,arguments)};ka.runGitCommands=Wb;ka.fileStatus=db;ka.applyPatchesFromEditor=Gb;ka.applyPatches=ub;ka.stageOrUnstageOrDiscardFiles=fa;ka.commit=ab;ka.fun=uc;ka.arr=Dd;ka.string=se;ka.obj=ve;ka.defaultDirectory=dd;ka.runCommand=vd;ka.isPublicServer=!1;ka.runGitCommands=Wb;ka.fileStatus=db;ka.applyPatchesFromEditor=Gb;ka.applyPatches=ub;ka.stageOrUnstageOrDiscardFiles=fa;ka.commit=ab;var va=Object.freeze({__proto__:null,runGitCommands:Wb,fileStatus:db,applyPatchesFromEditor:Gb,
applyPatches:ub,stageOrUnstageOrDiscardFiles:fa,commit:ab}),Fa=window.lively.FreezerRuntime.recorderFor("lively.ide/diff/editor-plugin.js");Fa.stageOrUnstagedOrDiscardAll=function(M,Aa,wb){return kc.apply(this,arguments)};Fa.patchApplySelection=function(M,Aa,wb){return Vb.apply(this,arguments)};Fa.arr=Dd;Fa.string=se;Fa.pt=fe;Fa.config=jc;Fa.lessEqPosition=Cb;Fa.DiffNavigator=da;Fa.DiffTokenizer=zb;Fa.FilePatch=Nb;Fa.EditorPlugin=qb;Fa.runCommand=vd;Fa.git=va;Nb=bd("default",function(M){var Aa=window.lively.FreezerRuntime.recorderFor("lively.ide/diff/editor-plugin.js"),
wb=Aa.hasOwnProperty("DiffEditorPlugin")&&"function"===typeof Aa.DiffEditorPlugin?Aa.DiffEditorPlugin:Aa.DiffEditorPlugin=function(Na){if(!Na||!Na[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Rc(wb,M,[{key:Symbol["for"]("lively-instance-initialize"),value:function(){Rc._get(Object.getPrototypeOf(wb.prototype),Symbol["for"]("lively-instance-initialize"),this).call(this);this.tokenizer=new Fa.DiffTokenizer;this.tokens=
[];this.patches=[]}},{key:"isDiffEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"diff"}},{key:"cwd",get:function(){var Na=this.textMorph.owner;return Na&&"Terminal"===Na.constructor.name?Na.cwd:null}},{key:"highlight",value:function(){var Na=this.textMorph;this.theme&&Na&&Na.document&&(this.tokenize(Na.textString),Na.setTextAttributesWithSortedRanges(this.styledRanges()))}},{key:"tokenize",value:function(Na){var hb=[],Bb=[];if(Na)try{Fa.__inter0__=this.tokenizer.tokenize(Na),
hb=Fa.__inter0__.tokens,Bb=Fa.__inter0__.patches}catch(ba){}this.tokens=hb;this.patches=Bb}},{key:"styledRanges",value:function(){var Na=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,hb=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,Bb=[],ba=this.tokens,dc=Ne(ba),la;try{for(dc.s();!(la=dc.n()).done;){var Fb=la.value,vb=Fb.type,Ia=Fb.start,xb=Fb.end;if(Na||hb){var Rb=Ia,yc=Rb.row,id=Rb.column;yc+=Na;Ia={row:yc,column:id};Rb=xb;var ob=Rb.row,Pb=Rb.column;ob+=Na;xb={row:ob,column:Pb}}"default"!==
ba.type&&this.theme[vb]&&Bb.push({start:Ia,end:xb},this.theme[vb])}}catch(tb){dc.e(tb)}finally{dc.f()}return Bb}},{key:"getCommands",value:function(Na){return Na.concat(Fa.commands)}},{key:"getKeyBindings",value:function(Na){return Na.concat([{command:"[patch] open file at cursor",keys:"Alt-O"},{command:"[patch] show selected patch",keys:"Alt-P"},{command:"[git] stage selection",keys:"Alt-S"},{command:"[git] stage all",keys:"Alt-Shift-S"},{command:"[git] unstage selection",keys:"Alt-U"},{command:"[git] unstage all",
keys:"Alt-Shift-U"},{command:"[git] discard selection",keys:"Alt-K"},{command:"[git] discard all",keys:"Alt-Shift-K"},{command:"[git] apply selection",keys:"Alt-A"},{command:"[git] reverse apply selection",keys:"Alt-R"},{command:"[git] commit",keys:"Alt-C"},{command:"[git] update",keys:"Alt-G"}])}},{key:"tokenAt",value:function(Na){return this.tokens.find(function(hb){var Bb=hb.end;return Fa.lessEqPosition(hb.start,Na)&&Fa.lessEqPosition(Na,Bb)})}},{key:"getNavigator",value:function(){return new Fa.DiffNavigator}},
{key:"getPatchesFromSelection",value:function(Na){var hb=this.patches;if(!hb||!hb.length)return[];var Bb=this.getNavigator(),ba=Na.selection.range,dc=Bb.findPatchAt(Na,ba.start);Bb=Bb.findPatchAt(Na,ba.end);Na=hb.indexOf(dc);Bb=Bb?hb.indexOf(Bb):hb.length;var la=ba.start.row,Fb=ba.end.row,vb=dc?dc.tokens[0].start.row:0;return hb.slice(Na,Bb+1).map(function(Ia,xb){xb=Ia.createPatchStringFromRows(la-vb,Fb-vb);vb+=Ia.length();return xb?Fa.FilePatch.read(xb):null}).filter(Boolean)}},{key:"getPatchAtCursor",
value:function(Na){Na=Na.cursorPosition;var hb=this.tokenAt(Na);if(!hb||!hb.hasOwnProperty("patch"))return null;var Bb=this.patches[hb.patch];hb=hb.hasOwnProperty("hunk")?Bb.hunks[hb.hunk]:null;return{patch:Bb,hunk:hb,cursorOffsetInHunk:hb?Na.row-hb.tokens[0].start.row:0}}},{key:"getMenuItems",value:function(Na){var hb=this.textMorph,Bb=!hb.selection.isEmpty();Na.push.apply(Na,[{isDivider:!0},{target:hb,command:"[patch] open file at cursor"},{target:hb,command:"[patch] show selected patch"},{target:hb,
command:"[git] apply selection"},{target:hb,command:"[git] reverse apply selection"},{target:hb,command:"[git] stage "+(Bb?"selection":"all")},{target:hb,command:"[git] unstage "+(Bb?"selection":"all")},{target:hb,command:"[git] discard "+(Bb?"selection":"all")},{target:hb,command:"[git] update"},{target:hb,command:"[git] commit"}]);return Na}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"DiffEditorPlugin"}}],Aa,{pathInPackage:function(){return"./diff/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:526,end:5581})}(Fa.EditorPlugin));Fa.commands=[{name:"[patch] show selected patch",exec:function(M){var Aa=M.pluginFind(function(Na){return Na.isDiffEditorPlugin});M.selection.isEmpty()?(Aa=Aa.getPatchAtCursor(M),Aa=Aa.patch?[Aa.patch]:null):Aa=Aa.getPatchesFromSelection(M);if(Aa&&Aa.length)var wb=Fa.arr.invoke(Aa,"createPatchString").join("\n");else M.setStatusMessage("Cannot read patch");
M.world().execCommand("open text window",Object.assign({lineWrapping:!1,plugins:[new Fa.DiffEditorPlugin]},Fa.config.codeEditor.defaultStyle,{title:"patches for "+Fa.arr.pluck(Aa,"fileNameA").join(", "),content:wb,extent:Fa.pt(700,400)}));return!0}},{name:"[patch] open file at cursor",exec:function(){var M=Ed(regeneratorRuntime.mark(function Na(wb){var hb,Bb,ba,dc,la;return regeneratorRuntime.wrap(function(Fb){for(;;)switch(Fb.prev=Fb.next){case 0:hb=wb.pluginFind(function(vb){return vb.isDiffEditorPlugin});
if((Bb=hb.getPatchAtCursor(wb))&&Bb.hunk){Fb.next=5;break}wb.setStatusMessage("Cannot read patch");return Fb.abrupt("return",!0);case 5:ba=Bb.hunk.relativeOffsetToFileLine(Bb.cursorOffsetInHunk);dc=Bb.hunk.fileNameB;if(dc.match(/^(\/|[a-z]:\\)/i)){Fb.next=15;break}Fb.t0=hb.cwd;if(Fb.t0){Fb.next=13;break}Fb.next=12;return wb.world().prompt("Enter base directory for file",{historyId:"lively.morphic-ide/diff-directory-for-file",useLastInput:!0,input:document.location.origin});case 12:Fb.t0=Fb.sent;case 13:(la=
Fb.t0)&&(dc=Fa.string.joinPath(la,dc));case 15:return ba&&(dc+=":"+ba),Fb.abrupt("return",wb.world().execCommand("open file",{url:dc}));case 17:case "end":return Fb.stop()}},Na)}));return function(wb){return M.apply(this,arguments)}}()},{name:"[git] commit",exec:function(){var M=Ed(regeneratorRuntime.mark(function hb(wb,Na){var Bb;return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:return Bb=wb.pluginFind(function(dc){return dc.isDiffEditorPlugin}),ba.prev=1,ba.next=
4,Fa.git.commit({cwd:Bb.cwd});case 4:wb.setStatusMessage("Commit successful");ba.next=10;break;case 7:ba.prev=7,ba.t0=ba["catch"](1),wb.showError(ba.t0);case 10:return ba.abrupt("return",!0);case 11:case "end":return ba.stop()}},hb,null,[[1,7]])}));return function(wb,Na){return M.apply(this,arguments)}}()},{name:"[git] update",exec:function(){var M=Ed(regeneratorRuntime.mark(function hb(wb,Na){var Bb,ba,dc;return regeneratorRuntime.wrap(function(la){for(;;)switch(la.prev=la.next){case 0:return la.next=
2,wb.world().prompt("git diff command",{useLastInput:!0,input:"git diff",historyId:"codeeditor.modes.Diff.git-update"});case 2:if(Bb=la.sent){la.next=6;break}wb.setStatusMessage("command canceled");return la.abrupt("return",!0);case 6:return ba=wb.pluginFind(function(Fb){return Fb.isDiffEditorPlugin}),la.next=9,Fa.runCommand(Bb,{cwd:ba.cwd});case 9:return dc=la.sent,la.next=12,dc.whenDone();case 12:return wb.saveExcursion(function(){return wb.textString=dc.stdout}),la.abrupt("return",!0);case 14:case "end":return la.stop()}},
hb)}));return function(wb,Na){return M.apply(this,arguments)}}()},{name:"[git] stage selection",exec:function(){var M=Ed(regeneratorRuntime.mark(function hb(wb,Na){var Bb;return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:return Bb=wb.pluginFind(function(dc){return dc.isDiffEditorPlugin}),ba.next=3,Fa.patchApplySelection(wb,"stage",Object.assign({cwd:Bb.cwd},Na));case 3:return ba.abrupt("return",ba.sent);case 4:case "end":return ba.stop()}},hb)}));return function(wb,
Na){return M.apply(this,arguments)}}()},{name:"[git] unstage selection",exec:function(){var M=Ed(regeneratorRuntime.mark(function hb(wb,Na){var Bb;return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:return Bb=wb.pluginFind(function(dc){return dc.isDiffEditorPlugin}),ba.next=3,Fa.patchApplySelection(wb,"unstage",Object.assign({cwd:Bb.cwd},Na));case 3:return ba.abrupt("return",ba.sent);case 4:case "end":return ba.stop()}},hb)}));return function(wb,Na){return M.apply(this,
arguments)}}()},{name:"[git] discard selection",exec:function(){var M=Ed(regeneratorRuntime.mark(function hb(wb,Na){var Bb;return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:return Bb=wb.pluginFind(function(dc){return dc.isDiffEditorPlugin}),ba.next=3,Fa.patchApplySelection(wb,"discard",Object.assign({cwd:Bb.cwd},Na));case 3:return ba.abrupt("return",ba.sent);case 4:case "end":return ba.stop()}},hb)}));return function(wb,Na){return M.apply(this,arguments)}}()},{name:"[git] reverse apply selection",
exec:function(){var M=Ed(regeneratorRuntime.mark(function hb(wb,Na){var Bb;return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:return Bb=wb.pluginFind(function(dc){return dc.isDiffEditorPlugin}),ba.next=3,Fa.patchApplySelection(wb,"reverseApply",Object.assign({cwd:Bb.cwd},Na));case 3:return ba.abrupt("return",ba.sent);case 4:case "end":return ba.stop()}},hb)}));return function(wb,Na){return M.apply(this,arguments)}}()},{name:"[git] apply selection",exec:function(){var M=
Ed(regeneratorRuntime.mark(function hb(wb,Na){var Bb;return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:return Bb=wb.pluginFind(function(dc){return dc.isDiffEditorPlugin}),ba.next=3,Fa.patchApplySelection(wb,"apply",Object.assign({cwd:Bb.cwd},Na));case 3:return ba.abrupt("return",ba.sent);case 4:case "end":return ba.stop()}},hb)}));return function(wb,Na){return M.apply(this,arguments)}}()},{name:"[git] stage all",exec:function(){var M=Ed(regeneratorRuntime.mark(function hb(wb,
Na){var Bb;return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:return Bb=wb.pluginFind(function(dc){return dc.isDiffEditorPlugin}),ba.next=3,Fa.stageOrUnstagedOrDiscardAll(wb,"stage",Object.assign({cwd:Bb.cwd},Na));case 3:return ba.abrupt("return",ba.sent);case 4:case "end":return ba.stop()}},hb)}));return function(wb,Na){return M.apply(this,arguments)}}()},{name:"[git] unstage all",exec:function(){var M=Ed(regeneratorRuntime.mark(function hb(wb,Na){var Bb;return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=
ba.next){case 0:return Bb=wb.pluginFind(function(dc){return dc.isDiffEditorPlugin}),ba.next=3,Fa.stageOrUnstagedOrDiscardAll(wb,"unstage",Object.assign({cwd:Bb.cwd},Na));case 3:return ba.abrupt("return",ba.sent);case 4:case "end":return ba.stop()}},hb)}));return function(wb,Na){return M.apply(this,arguments)}}()},{name:"[git] discard all",exec:function(){var M=Ed(regeneratorRuntime.mark(function hb(wb,Na){var Bb;return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:return Bb=
wb.pluginFind(function(dc){return dc.isDiffEditorPlugin}),ba.next=3,Fa.stageOrUnstagedOrDiscardAll(wb,"discard",Object.assign({cwd:Bb.cwd},Na));case 3:return ba.abrupt("return",ba.sent);case 4:case "end":return ba.stop()}},hb)}));return function(wb,Na){return M.apply(this,arguments)}}()}];Fa["default"]=Nb}}});
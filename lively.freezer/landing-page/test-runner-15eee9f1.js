System.register("./__rootModule___commonjs-entry-51a55f66.js ./eval-backend-ui-b51e822c.js ./index-61952933.js ./editor-plugin-80c3c4f5.js ./index-616023be.js ./index-42118cd5.js ./loading-indicator.cp-98e470a2.js @babel/plugin-syntax-import-meta ./interface-1a7f3c67.js ./tooltips.cp-3c41b378.js ./mode-3092ef0b.js ./ui.cp-8dfc076f.js ./popups.cp-5b9fb681.js ./list.cp-840d1cf8.js ./editor-modes-aae4d878.js ./editor-plugin-5397d87c.js".split(" "),function(bd,Dd){var se,Rc,ad,Ne,Cb,Sd,ve,uc,dd,vd,Ed,
fe,jc,Od,qb,ic,Wb,lc,db,Xa,Gb,sc,ub;return{setters:[function(sb){se=sb.m;Rc=sb._;ad=sb.s;Ne=sb.a;Cb=sb.v;Sd=sb.bs;ve=sb.l;uc=sb.aK;dd=sb.$;vd=sb.c0;Ed=sb.b;fe=sb.C;jc=sb.ag;Od=sb.d;qb=sb.k;ic=sb.i;Wb=sb.K;lc=sb.N},function(sb){db=sb["default"]},function(){},function(sb){Xa=sb["default"]},function(sb){Gb=sb.p},function(sb){sc=sb.localInterface},function(sb){ub=sb.L},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){function sb(){}
function fa(Pb,tb,xc,Pc,nd){for(var Id=0,Hb=tb.length,Kd=0,vc=0;Id<Hb;Id++){var Qc=tb[Id];if(Qc.removed)Qc.value=Pc.slice(vc,vc+Qc.count).join(""),vc+=Qc.count,Id&&tb[Id-1].added&&(Qc=tb[Id-1],tb[Id-1]=tb[Id],tb[Id]=Qc);else{if(!Qc.added&&nd){var kb=xc.slice(Kd,Kd+Qc.count);kb=kb.map(function(Cc,zc){zc=Pc[vc+zc];return zc.length>Cc.length?zc:Cc});Qc.value=kb.join("")}else Qc.value=xc.slice(Kd,Kd+Qc.count).join("");Kd+=Qc.count;Qc.added||(vc+=Qc.count)}}xc=tb[Hb-1];1<Hb&&(xc.added||xc.removed)&&Pb.equals("",
xc.value)&&(tb[Hb-2].value+=xc.value,tb.pop());return tb}function Db(Pb,tb,xc){tb=tb||[];xc=xc||[];var Pc;for(Pc=0;Pc<tb.length;Pc+=1)if(tb[Pc]===Pb)return xc[Pc];if("[object Array]"===Fb.call(Pb)){tb.push(Pb);var nd=Array(Pb.length);xc.push(nd);for(Pc=0;Pc<Pb.length;Pc+=1)nd[Pc]=Db(Pb[Pc],tb,xc);tb.pop();xc.pop();return nd}Pb&&Pb.toJSON&&(Pb=Pb.toJSON());if("object"===("undefined"===typeof Pb?"undefined":dc(Pb))&&null!==Pb){tb.push(Pb);nd={};xc.push(nd);var Id=[],Hb=void 0;for(Hb in Pb)Pb.hasOwnProperty(Hb)&&
Id.push(Hb);Id.sort();for(Pc=0;Pc<Id.length;Pc+=1)Hb=Id[Pc],nd[Hb]=Db(Pb[Hb],tb,xc);tb.pop();xc.pop()}else nd=Pb;return nd}function ab(Pb,tb){function xc(Ob,Le){for(var We=0;We<Ob.lines.length;We++){var xe=Ob.lines[We],Fg=xe[0];xe=xe.substr(1);if(" "===Fg||"-"===Fg){if(!Hb(Le+1,nd[Le],Fg,xe)&&(Kd++,Kd>vc))return!1;Le++}}return!0}var Pc=2>=arguments.length||void 0===arguments[2]?{}:arguments[2];"string"===typeof tb&&(tb=(0,Rb.parsePatch)(tb));if(Array.isArray(tb)){if(1<tb.length)throw Error("applyPatch only works with a single input.");
tb=tb[0]}for(var nd=Pb.split("\n"),Id=tb.hunks,Hb=Pc.compareLine||function(Ob,Le,We,xe){return Le===xe},Kd=0,vc=Pc.fuzzFactor||0,Qc=0,kb=0,Cc=Pc=void 0,zc=0;zc<Id.length;zc++){var Fc=Id[zc],xd=nd.length-Fc.oldLines,Uc=0,Md=kb+Fc.oldStart-1;for(Qc=(0,yc.default)(Md,Qc,xd);void 0!==Uc;Uc=Qc())if(xc(Fc,Md+Uc)){Fc.offset=kb+=Uc;break}if(void 0===Uc)return!1;Qc=Fc.offset+Fc.oldStart+Fc.oldLines}for(kb=0;kb<Id.length;kb++)for(zc=Id[kb],Fc=zc.offset+zc.newStart-1,0==zc.newLines&&Fc++,Uc=0;Uc<zc.lines.length;Uc++)Qc=
zc.lines[Uc],Md=Qc[0],Qc=Qc.substr(1)," "===Md?Fc++:"-"===Md?nd.splice(Fc,1):"+"===Md?(nd.splice(Fc,0,Qc),Fc++):"\\"===Md&&(Md=zc.lines[Uc-1]?zc.lines[Uc-1][0]:null,"+"===Md?Pc=!0:"-"===Md&&(Cc=!0));if(Pc)for(;!nd[nd.length-1];)nd.pop();else Cc&&nd.push("");return nd.join("\n")}function eb(Pb){if(Array.isArray(Pb)){for(var tb=0,xc=Array(Pb.length);tb<Pb.length;tb++)xc[tb]=Pb[tb];return xc}return Array.from(Pb)}function kc(Pb,tb,xc,Pc,nd,Id,Hb){function Kd(Ob){return Ob.map(function(Le){return" "+
Le})}Hb||(Hb={context:4});var vc=(0,id.diffLines)(xc,Pc);vc.push({value:"",lines:[]});for(var Qc=[],kb=0,Cc=0,zc=[],Fc=1,xd=1,Uc=function(Ob){var Le=vc[Ob],We=Le.lines||Le.value.replace(/\n$/,"").split("\n");Le.lines=We;if(Le.added||Le.removed){var xe;kb||(Ob=vc[Ob-1],kb=Fc,Cc=xd,Ob&&(zc=0<Hb.context?Kd(Ob.lines.slice(-Hb.context)):[],kb-=zc.length,Cc-=zc.length));(xe=zc).push.apply(xe,eb(We.map(function(rd){return(Le.added?"+":"-")+rd})));Le.added?xd+=We.length:Fc+=We.length}else{if(kb)if(We.length<=
2*Hb.context&&Ob<vc.length-2){var Fg;(Fg=zc).push.apply(Fg,eb(Kd(We)))}else{var Zc;xe=Math.min(We.length,Hb.context);(Zc=zc).push.apply(Zc,eb(Kd(We.slice(0,xe))));xe={oldStart:kb,oldLines:Fc-kb+xe,newStart:Cc,newLines:xd-Cc+xe,lines:zc};Ob>=vc.length-2&&We.length<=Hb.context&&(Ob=/\n$/.test(xc),Zc=/\n$/.test(Pc),0!=We.length||Ob?Ob&&Zc||zc.push("\\ No newline at end of file"):zc.splice(xe.oldLines,0,"\\ No newline at end of file"));Qc.push(xe);Cc=kb=0;zc=[]}Fc+=We.length;xd+=We.length}},Md=0;Md<vc.length;Md++)Uc(Md);
return{oldFileName:Pb,newFileName:tb,oldHeader:nd,newHeader:Id,hunks:Qc}}function Vb(Pb,tb,xc,Pc,nd,Id,Hb){xc=kc(Pb,tb,xc,Pc,nd,Id,Hb);Pc=[];Pb==tb&&Pc.push("Index: "+Pb);Pc.push("===================================================================");Pc.push("--- "+xc.oldFileName+("undefined"===typeof xc.oldHeader?"":"\t"+xc.oldHeader));Pc.push("+++ "+xc.newFileName+("undefined"===typeof xc.newHeader?"":"\t"+xc.newHeader));for(Pb=0;Pb<xc.hunks.length;Pb++)tb=xc.hunks[Pb],Pc.push("@@ -"+tb.oldStart+
","+tb.oldLines+" +"+tb.newStart+","+tb.newLines+" @@"),Pc.push.apply(Pc,tb.lines);return Pc.join("\n")+"\n"}function pb(Pb){Pb=Pb.replace(/&/g,"&amp;");Pb=Pb.replace(/</g,"&lt;");Pb=Pb.replace(/>/g,"&gt;");return Pb=Pb.replace(/"/g,"&quot;")}function Nb(Pb){var tb=[],xc=[];try{var Pc="string"===typeof Pb?ob.parse(Pb):Pb}catch(nd){return xc}ob.walk.recursive(Pc,{},{CallExpression:function(nd,Id,Hb){if(nd.callee.name&&nd.callee.name.match(/^(describe|it|describeInBrowser|xdescribe|xit)$/)&&2<=nd.arguments.length){var Kd=
{title:nd.arguments[0].value,type:nd.callee.name.match(/describe/)?"suite":"test"};tb.push(Kd);var vc={fullTitle:ob.arr.pluck(tb,"title").join(" "),type:Kd.type,node:nd};xc.push(vc)}ob.walk.base.CallExpression(nd,Id,Hb);Kd&&tb.pop()}},Object.assign({},ob.walk.base,{SpreadProperty:function(nd,Id,Hb){}}));return xc}function zb(Pb){function tb(xc){var Pc,nd=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",Id=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,Hb=(nd+" "+xc.title).trim();
return(Pc=[{parent:nd,fullTitle:Hb,title:xc.title,file:xc.file,depth:Id,type:"suite"}].concat((xc.tests||[]).map(function(Kd){var vc=Kd.title,Qc=Kd.file;Kd=Kd.type;return{state:"",duration:-1,parent:Hb,fullTitle:(Hb+" "+vc).trim(),title:vc,file:Qc,depth:Id,type:Kd}}))).concat.apply(Pc,se((xc.suites||[]).map(function(Kd){return tb(Kd,Hb,Id+1)})))}return tb(Pb.suite).reduce(function(xc,Pc){if(!Pc.file)return xc;var nd=xc.find(function(Id){return Id.file===Pc.file});nd?nd.tests.push(Pc):xc.push({file:Pc.file,
tests:[Pc]});return xc},[])}function rb(Pb,tb){return Ib.apply(this,arguments)}function Ib(){Ib=Rc(regeneratorRuntime.mark(function Pc(tb,xc){var nd;return regeneratorRuntime.wrap(function(Id){for(;;)switch(Id.prev=Id.next){case 0:return Id.next=2,tb.resourcesOfPackage(xc);case 2:return nd=Id.sent,Id.abrupt("return",Promise.all(nd.map(function(){var Hb=Rc(regeneratorRuntime.mark(function Qc(vc){var kb,Cc,zc,Fc;return regeneratorRuntime.wrap(function(xd){for(;;)switch(xd.prev=xd.next){case 0:kb=vc.url;
if(kb.endsWith(".js")){xd.next=3;break}return xd.abrupt("return",null);case 3:return xd.next=5,tb.moduleRead(kb);case 5:Cc=xd.sent;xd.prev=6;zc=ob.parse(Cc);xd.next=13;break;case 10:return xd.prev=10,xd.t0=xd["catch"](6),xd.abrupt("return",null);case 13:if(Fc=ob.query.imports(ob.query.scopes(zc)).some(function(Uc){return Uc.fromModule.includes("mocha-es6")})){xd.next=16;break}return xd.abrupt("return",null);case 16:return xd.prev=16,xd.abrupt("return",ob.testsFromSource(Cc).length?kb:null);case 20:return xd.prev=
20,xd.t1=xd["catch"](16),xd.abrupt("return",null);case 23:case "end":return xd.stop()}},Qc,null,[[6,10],[16,20]])}));return function(vc){return Hb.apply(this,arguments)}}())).then(function(Hb){return Hb.filter(Boolean)}));case 4:case "end":return Id.stop()}},Pc)}));return Ib.apply(this,arguments)}bd({findTestModulesInPackage:rb,testsFromMocha:zb,testsFromSource:Nb});var da={__esModule:!0};da["default"]=sb;sb.prototype={diff:function(Pb,tb){function xc(zc){return Id?(setTimeout(function(){Id(void 0,
zc)},0),!0):zc}function Pc(){for(var zc=-1*Qc;zc<=Qc;zc+=2){var Fc=Cc[zc-1];var xd=Cc[zc+1],Uc=(xd?xd.newPos:0)-zc;Fc&&(Cc[zc-1]=void 0);var Md=Fc&&Fc.newPos+1<Kd;Uc=xd&&0<=Uc&&Uc<vc;if(Md||Uc){!Md||Uc&&Fc.newPos<xd.newPos?(Fc={newPos:xd.newPos,components:xd.components.slice(0)},Hb.pushComponent(Fc.components,void 0,!0)):(Fc.newPos++,Hb.pushComponent(Fc.components,!0,void 0));Uc=Hb.extractCommon(Fc,tb,Pb,zc);if(Fc.newPos+1>=Kd&&Uc+1>=vc)return xc(fa(Hb,Fc.components,tb,Pb,Hb.useLongestToken));Cc[zc]=
Fc}else Cc[zc]=void 0}Qc++}var nd=2>=arguments.length||void 0===arguments[2]?{}:arguments[2],Id=nd.callback;"function"===typeof nd&&(Id=nd,nd={});this.options=nd;var Hb=this;Pb=this.castInput(Pb);tb=this.castInput(tb);Pb=this.removeEmpty(this.tokenize(Pb));tb=this.removeEmpty(this.tokenize(tb));var Kd=tb.length,vc=Pb.length,Qc=1,kb=Kd+vc,Cc=[{newPos:-1,components:[]}];nd=this.extractCommon(Cc[0],tb,Pb,0);if(Cc[0].newPos+1>=Kd&&nd+1>=vc)return xc([{value:tb.join(""),count:tb.length}]);if(Id)(function Fc(){setTimeout(function(){if(Qc>
kb)return Id();Pc()||Fc()},0)})();else for(;Qc<=kb;)if(nd=Pc())return nd},pushComponent:function(Pb,tb,xc){var Pc=Pb[Pb.length-1];Pc&&Pc.added===tb&&Pc.removed===xc?Pb[Pb.length-1]={count:Pc.count+1,added:tb,removed:xc}:Pb.push({count:1,added:tb,removed:xc})},extractCommon:function(Pb,tb,xc,Pc){var nd=tb.length,Id=xc.length,Hb=Pb.newPos;Pc=Hb-Pc;for(var Kd=0;Hb+1<nd&&Pc+1<Id&&this.equals(tb[Hb+1],xc[Pc+1]);)Hb++,Pc++,Kd++;Kd&&Pb.components.push({count:Kd});Pb.newPos=Hb;return Pc},equals:function(Pb,
tb){return Pb===tb},removeEmpty:function(Pb){for(var tb=[],xc=0;xc<Pb.length;xc++)Pb[xc]&&tb.push(Pb[xc]);return tb},castInput:function(Pb){return Pb},tokenize:function(Pb){return Pb.split("")}};var ka=new (da&&da.__esModule?da:{"default":da})["default"],va={__esModule:!0,generateOptions:function(Pb,tb){if("function"===typeof Pb)tb.callback=Pb;else if(Pb)for(var xc in Pb)Pb.hasOwnProperty(xc)&&(tb[xc]=Pb[xc]);return tb}},Fa=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,M=/\S/,Aa=
new (da&&da.__esModule?da:{default:da}).default;Aa.equals=function(Pb,tb){return Pb===tb||this.options.ignoreWhitespace&&!M.test(Pb)&&!M.test(tb)};Aa.tokenize=function(Pb){Pb=Pb.split(/(\s+|\b)/);for(var tb=0;tb<Pb.length-1;tb++)!Pb[tb+1]&&Pb[tb+2]&&Fa.test(Pb[tb])&&Fa.test(Pb[tb+2])&&(Pb[tb]+=Pb[tb+2],Pb.splice(tb+1,2),tb--);return Pb};var wb={__esModule:!0,lineDiff:void 0,diffLines:function(Pb,tb,xc){return hb.diff(Pb,tb,xc)},diffTrimmedLines:function(Pb,tb,xc){xc=(0,Na.generateOptions)(xc,{ignoreWhitespace:!0});
return hb.diff(Pb,tb,xc)}},Na=va,hb=wb.lineDiff=new (da&&da.__esModule?da:{default:da}).default;hb.tokenize=function(Pb){var tb=[];Pb=Pb.split(/(\n|\r\n)/);Pb[Pb.length-1]||Pb.pop();for(var xc=0;xc<Pb.length;xc++){var Pc=Pb[xc];xc%2&&!this.options.newlineIsToken?tb[tb.length-1]+=Pc:(this.options.ignoreWhitespace&&(Pc=Pc.trim()),tb.push(Pc))}return tb};var Bb=new (da&&da.__esModule?da:{default:da}).default;Bb.tokenize=function(Pb){return Pb.split(/(\S.+?[.!?])(?=\s+|$)/)};var ba=new (da&&da.__esModule?
da:{default:da}).default;ba.tokenize=function(Pb){return Pb.split(/([{}:;,]|\s+)/)};var dc="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(Pb){return typeof Pb}:function(Pb){return Pb&&"function"===typeof Symbol&&Pb.constructor===Symbol?"symbol":typeof Pb},la=da&&da.__esModule?da:{default:da},Fb=Object.prototype.toString,vb=new la.default;vb.useLongestToken=!0;vb.tokenize=wb.lineDiff.tokenize;vb.castInput=function(Pb){return"string"===typeof Pb?Pb:JSON.stringify(Db(Pb),void 0,
"  ")};vb.equals=function(Pb,tb){return la.default.prototype.equals(Pb.replace(/,([\r\n])/g,"$1"),tb.replace(/,([\r\n])/g,"$1"))};var Ia={__esModule:!0,parsePatch:function(Pb){function tb(){var vc={};for(Hb.push(vc);Kd<Id.length;){var Qc=Id[Kd];if(/^(\-\-\-|\+\+\+|@@)\s/.test(Qc))break;if(Qc=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(Qc))vc.index=Qc[1];Kd++}xc(vc);xc(vc);for(vc.hunks=[];Kd<Id.length&&(Qc=Id[Kd],!/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(Qc));)if(/^@@/.test(Qc))vc.hunks.push(Pc());
else{if(Qc&&nd.strict)throw Error("Unknown line "+(Kd+1)+" "+JSON.stringify(Qc));Kd++}}function xc(vc){var Qc=/^(---|\+\+\+)\s+([\S ]*)(?:\t(.*?)\s*)?$/.exec(Id[Kd]);if(Qc){var kb="---"===Qc[1]?"old":"new";vc[kb+"FileName"]=Qc[2];vc[kb+"Header"]=Qc[3];Kd++}}function Pc(){var vc=Kd,Qc=Id[Kd++].split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/);Qc={oldStart:+Qc[1],oldLines:+Qc[2]||1,newStart:+Qc[3],newLines:+Qc[4]||1,lines:[]};for(var kb=0,Cc=0;Kd<Id.length;Kd++){var zc=Id[Kd][0];if("+"===zc||"-"===
zc||" "===zc||"\\"===zc)Qc.lines.push(Id[Kd]),"+"===zc?kb++:"-"===zc?Cc++:" "===zc&&(kb++,Cc++);else break}kb||1!==Qc.newLines||(Qc.newLines=0);Cc||1!==Qc.oldLines||(Qc.oldLines=0);if(nd.strict){if(kb!==Qc.newLines)throw Error("Added line count did not match for hunk at line "+(vc+1));if(Cc!==Qc.oldLines)throw Error("Removed line count did not match for hunk at line "+(vc+1));}return Qc}for(var nd=1>=arguments.length||void 0===arguments[1]?{}:arguments[1],Id=Pb.split("\n"),Hb=[],Kd=0;Kd<Id.length;)tb();
return Hb}},xb={__esModule:!0,default:function(Pb,tb,xc){var Pc=!0,nd=!1,Id=!1,Hb=1;return function vc(){if(Pc&&!Id){nd?Hb++:Pc=!1;if(Pb+Hb<=xc)return Hb;Id=!0}if(!nd){Id||(Pc=!0);if(tb<=Pb-Hb)return-Hb++;nd=!0;return vc()}}}},Rb=Ia,yc=xb&&xb.__esModule?xb:{default:xb},id=wb;xb={__esModule:!0};xb.canonicalize=xb.convertChangesToXML=xb.convertChangesToDMP=xb.parsePatch=xb.applyPatches=xb.applyPatch=xb.createPatch=xb.createTwoFilesPatch=xb.structuredPatch=xb.diffJson=xb.diffCss=xb.diffSentences=xb.diffTrimmedLines=
xb.diffLines=xb.diffWordsWithSpace=xb.diffWords=xb.diffChars=xb.Diff=void 0;xb.Diff=(da&&da.__esModule?da:{default:da}).default;xb.diffChars=function(Pb,tb,xc){return ka.diff(Pb,tb,xc)};xb.diffWords=function(Pb,tb,xc){xc=(0,va.generateOptions)(xc,{ignoreWhitespace:!0});return Aa.diff(Pb,tb,xc)};xb.diffWordsWithSpace=function(Pb,tb,xc){return Aa.diff(Pb,tb,xc)};xb.diffLines=wb.diffLines;xb.diffTrimmedLines=wb.diffTrimmedLines;xb.diffSentences=function(Pb,tb,xc){return Bb.diff(Pb,tb,xc)};xb.diffCss=
function(Pb,tb,xc){return ba.diff(Pb,tb,xc)};xb.diffJson=function(Pb,tb,xc){return vb.diff(Pb,tb,xc)};xb.structuredPatch=kc;xb.createTwoFilesPatch=Vb;xb.createPatch=function(Pb,tb,xc,Pc,nd,Id){return Vb(Pb,Pb,tb,xc,Pc,nd,Id)};xb.applyPatch=ab;xb.applyPatches=function(Pb,tb){function xc(){var nd=Pb[Pc++];if(!nd)return tb.complete();tb.loadFile(nd,function(Id,Hb){if(Id)return tb.complete(Id);Id=ab(Hb,nd,tb);tb.patched(nd,Id,function(Kd){if(Kd)return tb.complete(Kd);xc()})})}"string"===typeof Pb&&(Pb=
(0,Rb.parsePatch)(Pb));var Pc=0;xc()};xb.parsePatch=Ia.parsePatch;xb.convertChangesToDMP=function(Pb){for(var tb=[],xc,Pc,nd=0;nd<Pb.length;nd++)xc=Pb[nd],Pc=xc.added?1:xc.removed?-1:0,tb.push([Pc,xc.value]);return tb};xb.convertChangesToXML=function(Pb){for(var tb=[],xc=0;xc<Pb.length;xc++){var Pc=Pb[xc];Pc.added?tb.push("<ins>"):Pc.removed&&tb.push("<del>");tb.push(pb(Pc.value));Pc.added?tb.push("</ins>"):Pc.removed&&tb.push("</del>")}return tb.join("")};xb.canonicalize=Db;xb.__esModule;xb.canonicalize;
xb.convertChangesToXML;xb.convertChangesToDMP;xb.parsePatch;xb.applyPatches;xb.applyPatch;xb.createPatch;xb.createTwoFilesPatch;xb.structuredPatch;xb.diffJson;xb.diffCss;xb.diffSentences;xb.diffTrimmedLines;xb.diffLines;xb.diffWordsWithSpace;xb.diffWords;xb.diffChars;xb.Diff;var ob=window.lively.FreezerRuntime.recorderFor("lively.ide/test-runner.js");ob.testsFromSource=Nb;ob.testsFromMocha=zb;ob.findTestModulesInPackage=rb;ob.arr=ad;ob.promise=Ne;ob.obj=Cb;ob.chain=Sd;ob.fun=ve;ob.query=uc;ob.parse=
dd;ob.walk=vd;ob.pt=Ed;ob.Color=fe;ob.HTMLMorph=jc;ob.connect=Od;ob.EvalBackendChooser=db;ob.LoadingIndicator=ub;ob.JavaScriptEditorPlugin=Xa;ob.resource=qb;ob.packagesConfig=Gb;ob.localInterface=sc;ob.jsDiff=xb;ob.testsFromSource=Nb;ob.testsFromMocha=zb;ob.findTestModulesInPackage=rb;ob.testRunnerCSS='\n\n.mocha-test-runner {\n  font-family: IBM Plex Sans,Arial,sans-serif;\n  font-size: 12px;\n  line-height: 1.5em;\n  height: 100%;\n}\n\n.mocha-test-runner .controls input {\n  display: inline;\n}\n\n.mocha-test-runner .row h2 {\n  display: inline;\n  margin: 2px 4px;\n  font-size: small;\n}\n\n.mocha-test-runner .row.test-file {\n  margin-top: 0px;\n}\n\n.controls {\n  pointer-events: auto;\n  margin: 6px 6px;\n}\n\n.mocha-test-runner .row {\n  white-space: wrap;\n}\n\n.mocha-test-runner .suites {\n  pointer-events: auto;\n  overflow-y: auto;\n  overflow-x: hidden;\n  height: calc(100% - 30px);\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  background: rgba(0,0,0,0.5);\n}\n\n.mocha-test-runner .suite {\n  font-weight: bold;\n}\n\n.mocha-test-runner .collapse-button {\n  font-weight: bold;\n}\n\n.mocha-test-runner .collapse-button.collapsed {\n  font-weight: bold;\n}\n\n.mocha-test-runner .row {\n/*line-height: 2.2;*/\n}\n\n.mocha-test-runner .run-button {\n  color: rgb(30,30,30);\n  border: rgb(150,150,150) 1px solid;\n  font-size: 12px;\n  border-radius: 5px;\n  padding: 2px 8px;\n  cursor: pointer;\n}\n\n.mocha-test-runner .run-button:active {\n  background-color: rgb(200,200,200);\n}\n\n.row .run-button {\n  font-size: 11px;\n}\n\n.mocha-test-runner .heading .run-button, .row .run-button, .row .remove-button {\n  display: none;\n}\n\n.mocha-test-runner .heading:hover .run-button, .row:hover .run-button, .row:hover .remove-button {\n  display: inline;\n}\n\n.mocha-test-runner .test-file, .suite, .test, .collapse-button {\n  cursor: pointer;\n}\n\n.mocha-test-runner .suite, .test {\n  padding: 2px;\n/*outline: 1px red solid;*/\n}\n\n.mocha-test-runner .row.collapsed {\n  display: none;\n}\n\n.mocha-test-runner .hidden {\n  display: none;\n}\n\n.mocha-test-runner .suite .running::before, .test .running::before {\n  content: "\u261b ";\n}\n\n.mocha-test-runner .failed {\n  background-color: red;\n  color: white;\n}\n\n.mocha-test-runner .succeeded {\n  background-color: #60d610;\n  color: white;\n}\n\n.mocha-test-runner .duration {\n  font-size: 80%;\n}\n\n.mocha-test-runner .duration.slow {\n  color: yellow;\n}\n\n.mocha-test-runner .duration.very-slow {\n  color: red;\n}';
da=bd("default",function(Pb){var tb=window.lively.FreezerRuntime.recorderFor("lively.ide/test-runner.js"),xc=tb.hasOwnProperty("TestRunner")&&"function"===typeof tb.TestRunner?tb.TestRunner:tb.TestRunner=function(Pc){if(!Pc||!Pc[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return ic(xc,Pb,[{key:Symbol["for"]("lively-instance-initialize"),value:function(Pc){ic._get(Object.getPrototypeOf(xc.prototype),Symbol["for"]("lively-instance-initialize"),
this).call(this,Pc);this.reset();ob.connect(this,"extent",this,"relayout")}},{key:"onLoad",value:function(){var Pc=Rc(regeneratorRuntime.mark(function Id(){return regeneratorRuntime.wrap(function(Hb){for(;;)switch(Hb.prev=Hb.next){case 0:return Hb.next=2,Dd.import("mocha-es6");case 2:return Hb.next=4,ob.promise.waitFor(3E4,function(){return!!$world});case 4:return ob.resource(document.URL).query().runAllTests&&this.runAllTests(),Hb.next=7,this.whenRendered();case 7:this.update();case 8:case "end":return Hb.stop()}},
Id,this)}));return function(){return Pc.apply(this,arguments)}}()},{key:"reset",value:function(){var Pc=this.getWindow();Pc&&(Pc.extent=ob.pt(500,600));this.state={grep:null,loadedTests:[],collapsedSuites:{}};this.addMorph(ob.EvalBackendChooser["default"].ensureEvalBackendDropdown(this,null));this.update()}},{key:"relayout",value:function(){this.get("eval backend button").topRight=this.innerBounds().insetBy(5).topRight()}},{key:"setEvalBackend",value:function(Pc){this.editorPlugin.setSystemInterfaceNamed(Pc)}},
{key:"findBrowserForFile",value:function(Pc){var nd=this.world();return nd.getWindows().map(function(Id){return Id.targetMorph}).filter(function(Id){return Id.isBrowser}).find(function(Id){return(Id=Id.selectedModule)&&Id.url===Pc})||nd.execCommand("open browser",null)}},{key:"jumpToTest",value:function(){var Pc=Rc(regeneratorRuntime.mark(function Kd(Id,Hb){var vc,Qc,kb,Cc,zc;return regeneratorRuntime.wrap(function(Fc){for(;;)switch(Fc.prev=Fc.next){case 0:return vc=ob.LoadingIndicator.open("Scanning source code..."),
Fc.prev=1,Fc.next=4,this.findBrowserForFile(Hb);case 4:return Qc=Fc.sent,Qc.getWindow().activate(),Fc.next=8,Qc.searchForModuleAndSelect(Hb);case 8:kb=Qc.editorPlugin.textMorph;Cc=ob.testsFromSource(kb.textString);if(zc=Cc.find(function(xd){return xd.fullTitle===Id.fullTitle})){Fc.next=13;break}throw Error("Cannot find test ".concat(Id.title," in file ").concat(Hb));case 13:kb.selection=kb.astNodeRange(zc.node);kb.centerRow(kb.selection.start.row);Fc.next=20;break;case 17:Fc.prev=17,Fc.t0=Fc["catch"](1),
this.showError(Fc.t0);case 20:return Fc.prev=20,vc.remove(),Fc.finish(20);case 23:case "end":return Fc.stop()}},Kd,this,[[1,17,20,23]])}));return function(Id,Hb){return Pc.apply(this,arguments)}}()},{key:"showError",value:function(Pc){this.world()&&this.world().logError(Pc)}},{key:"removeTestFile",value:function(Pc){var nd=this.state,Id=nd.loadedTests,Hb=nd.collapsedSuites;if(nd=Id.find(function(Kd){return Kd.file===Pc}))ob.arr.remove(Id,nd),[Pc].concat(ob.arr.pluck(nd.tests,"fullTitle")).forEach(function(Kd){return delete Hb[Kd]});
this.update()}},{key:"runAllTests",value:function(){var Pc=Rc(regeneratorRuntime.mark(function Id(){var Hb,Kd,vc,Qc;return regeneratorRuntime.wrap(function(kb){for(;;)switch(kb.prev=kb.next){case 0:Hb=ob.arr.pluck(this.state.loadedTests,"file"),kb.prev=1,Kd=lc(Hb),kb.prev=3,Kd.s();case 5:if((vc=Kd.n()).done){kb.next=11;break}Qc=vc.value;kb.next=9;return this.runTestFile(Qc);case 9:kb.next=5;break;case 11:kb.next=16;break;case 13:kb.prev=13,kb.t0=kb["catch"](3),Kd.e(kb.t0);case 16:return kb.prev=16,
Kd.f(),kb.finish(16);case 19:kb.next=24;break;case 21:kb.prev=21,kb.t1=kb["catch"](1),this.world().logError(kb.t1);case 24:case "end":return kb.stop()}},Id,this,[[1,21],[3,13,16,19]])}));return function(){return Pc.apply(this,arguments)}}()},{key:"runSuite",value:function(){var Pc=Rc(regeneratorRuntime.mark(function Hb(Id){var Kd,vc,Qc;return regeneratorRuntime.wrap(function(kb){for(;;)switch(kb.prev=kb.next){case 0:if(Kd=this.state.loadedTests.find(function(Cc){return Cc.tests.some(function(zc){return zc.fullTitle===
Id})})){kb.next=3;break}throw Error("Cannot find test file for test "+Id);case 3:return vc=new RegExp("^"+Id.replace(/\*/g,"\\*")+".*"),kb.next=6,this.runTestFile(Kd.file,vc);case 6:if(Qc=this.state.loadedTests.find(function(Cc){return Cc.file===Kd.file}))Qc.tests=Qc.tests.map(function(Cc){return Cc.fullTitle.match(vc)?Cc:Kd.tests.find(function(zc){return zc.fullTitle===Cc.fullTitle})||Cc}),this.update();kb.next=10;return this.scrollIntoView(Id);case 10:case "end":return kb.stop()}},Hb,this)}));return function(Id){return Pc.apply(this,
arguments)}}()},{key:"runTest",value:function(Pc){return this.runSuite(Pc)}},{key:"runTestFile",value:function(){var Pc=Rc(regeneratorRuntime.mark(function vc(Id,Hb,Kd){var Qc,kb;return regeneratorRuntime.wrap(function(Cc){for(;;)switch(Cc.prev=Cc.next){case 0:return System._testsRunning=!0,Cc.prev=1,this.state.loadedTests||(this.state.loadedTests=[]),this.state.loadedTests.some(function(zc){return zc.file===Id})||this.state.loadedTests.push({file:Id,tests:[]}),Qc=this.state.loadedTests.findIndex(function(zc){return zc.file===
Id}),Cc.next=7,this.runTestFiles([Id],Hb,Kd);case 7:return kb=Cc.sent,this.state.loadedTests[Qc]=kb.find(function(zc){return zc.file===Id}),this.update(),Cc.abrupt("return",this.state.loadedTests[Qc]);case 11:return Cc.prev=11,System._testsRunning=!1,Cc.finish(11);case 14:case "end":return Cc.stop()}},vc,this,[[1,,11,14]])}));return function(Id,Hb,Kd){return Pc.apply(this,arguments)}}()},{key:"runTestFiles",value:function(){var Pc=Rc(regeneratorRuntime.mark(function vc(Id,Hb,Kd){var Qc=this,kb,Cc;
return regeneratorRuntime.wrap(function(zc){for(;;)switch(zc.prev=zc.next){case 0:return kb=Id.map(function(Fc){return{file:Fc,tests:[]}}),Hb=Hb||this.state.grep||/.*/,zc.prev=2,zc.next=5,this.systemInterface.runMochaTests(Hb,kb,function(){return Qc.update()},function(Fc,xd){return Qc.showError("Error during ".concat(xd,": ").concat(Fc))});case 5:Cc=zc.sent;if(!Cc||!Cc.isError){zc.next=8;break}throw Error(Cc.value.stack||Cc.value);case 8:if(Cc&&Cc.testsByFile){zc.next=10;break}throw Error("No test results when runnin tests of ".concat(Id));
case 10:return zc.abrupt("return",Cc.testsByFile);case 13:return zc.prev=13,zc.t0=zc["catch"](2),this.showError(zc.t0),zc.next=18,this.update();case 18:throw zc.t0;case 19:case "end":return zc.stop()}},vc,this,[[2,13]])}));return function(Id,Hb,Kd){return Pc.apply(this,arguments)}}()},{key:"updateEvalBackendForPackage",value:function(Pc){this.systemInterface=Pc?ob.EvalBackendChooser["default"].httpEvalBackends[0]:ob.localInterface}},{key:"runTestsInPackage",value:function(){var Pc=Rc(regeneratorRuntime.mark(function Hb(Id){var Kd,
vc,Qc,kb,Cc,zc,Fc;return regeneratorRuntime.wrap(function(xd){for(;;)switch(xd.prev=xd.next){case 0:return xd.next=2,ob.packagesConfig();case 2:return Kd=xd.sent,vc=Kd.find(function(Uc){return Uc.name===Id}).wantsServerInterface,this.updateEvalBackendForPackage(vc),xd.next=7,ob.findTestModulesInPackage(this.systemInterface,Id);case 7:Qc=xd.sent,kb=[],Cc=lc(Qc),xd.prev=10,Cc.s();case 12:if((zc=Cc.n()).done){xd.next=21;break}Fc=zc.value;xd.t0=kb;xd.next=17;return this.runTestFile(Fc);case 17:xd.t1=
xd.sent,xd.t0.push.call(xd.t0,xd.t1);case 19:xd.next=12;break;case 21:xd.next=26;break;case 23:xd.prev=23,xd.t2=xd["catch"](10),Cc.e(xd.t2);case 26:return xd.prev=26,Cc.f(),xd.finish(26);case 29:return xd.abrupt("return",kb);case 30:case "end":return xd.stop()}},Hb,this,[[10,23,26,29]])}));return function(Id){return Pc.apply(this,arguments)}}()},{key:"collapseAll",value:function(){var Pc=this;this.state.collapsedSuites={};ob.chain(this.state.loadedTests).pluck("tests").flat().filter(function(nd){return"suite"===
nd.type&&nd.fullTitle}).forEach(function(nd){return Pc.state.collapsedSuites[nd.fullTitle]=!0});ob.arr.pluck(this.state.loadedTests,"file").forEach(function(nd){return Pc.state.collapsedSuites[nd]=!0});this.update()}},{key:"collapseToggle",value:function(){this[0===Object.keys(this.state.collapsedSuites).length?"collapseAll":"uncollapseAll"]()}},{key:"uncollapseAll",value:function(){this.state.collapsedSuites={};this.update()}},{key:"onClickCollapseButton",value:function(Pc,nd,Id){Pc=Pc.shiftKey;
var Hb=this.state.collapsedSuites,Kd=this.state.loadedTests;nd in Hb?(delete Hb[nd],Pc&&(Id===nd?(Pc=Kd.find(function(vc){return vc.file===Id}))&&Pc.tests.forEach(function(vc){return delete Hb[vc.fullTitle]}):Object.keys(Hb).forEach(function(vc){return 0===vc.indexOf(nd)&&delete Hb[vc]}))):(Hb[nd]=!0,Pc&&(Pc=Kd.find(function(vc){return vc.file===Id}),Id===nd?Pc&&Pc.tests.forEach(function(vc){return"suite"===vc.type&&1<=vc.depth&&(Hb[vc.fullTitle]=!0)}):Pc&&Pc.tests.forEach(function(vc){return"suite"===
vc.type&&0===vc.fullTitle.indexOf(nd)&&(Hb[vc.fullTitle]=!0)})));this.update()}},{key:"onClickTest",value:function(){var Pc=Rc(regeneratorRuntime.mark(function vc(Id,Hb,Kd){return regeneratorRuntime.wrap(function(Qc){for(;;)switch(Qc.prev=Qc.next){case 0:return Qc.prev=0,Qc.next=3,this.jumpToTest({fullTitle:Hb},Kd);case 3:Qc.next=8;break;case 5:Qc.prev=5,Qc.t0=Qc["catch"](0),this.showError(Qc.t0);case 8:case "end":return Qc.stop()}},vc,this,[[0,5]])}));return function(Id,Hb,Kd){return Pc.apply(this,
arguments)}}()},{key:"onClickError",value:function(Pc,nd,Id){Pc=this.state.loadedTests.find(function(Kd){return Kd.file===Id}).tests.find(function(Kd){return Kd.fullTitle===nd});if(this.stringifyExpectedAndActualOfError(Pc.error)&&Pc.error.actual&&Pc.error.expected)this.world().execCommand("diff and open in window",{a:Pc.error.actual,b:Pc.error.expected,title:Pc.fullTitle});else{var Hb=this.world().execCommand("open text window",{title:Pc.fullTitle,content:Pc.error+"\n"+Pc.error.stack});setTimeout(function(){return Hb.activate()})}}},
{key:"onClickFile",value:function(){var Pc=Rc(regeneratorRuntime.mark(function Kd(Id,Hb){var vc;return regeneratorRuntime.wrap(function(Qc){for(;;)switch(Qc.prev=Qc.next){case 0:return Qc.prev=0,Qc.next=3,this.findBrowserForFile(Hb);case 3:return vc=Qc.sent,vc.getWindow().activate(),Qc.next=7,vc.searchForModuleAndSelect(Hb);case 7:Qc.next=12;break;case 9:Qc.prev=9,Qc.t0=Qc["catch"](0),this.showError(Qc.t0);case 12:case "end":return Qc.stop()}},Kd,this,[[0,9]])}));return function(Id,Hb){return Pc.apply(this,
arguments)}}()},{key:"onClickSuite",value:function(Pc,nd,Id){this.onClickTest(Pc,nd,Id)}},{key:"update",value:function(){var Pc=this;return new Promise(function(nd,Id){ob.fun.throttleNamed(Pc.id+"-update",100,function(){return nd(Pc.renderTests(Pc.state))})()})}},{key:"ensureScrollPosition",value:function(){var Pc=this.domNode.getElementsByClassName("suites");Wb(Pc,1)[0].scrollTop=this._currentScrollY||0}},{key:"htmlRef",get:function(){return"System.get(System.normalizeSync('lively.morphic')).MorphicEnv.default().world.getMorphWithId('".concat(this.id,
"')")}},{key:"afterRenderHook",value:function(){this.ensureScrollPosition()}},{key:"renderTests",value:function(){var Pc=Rc(regeneratorRuntime.mark(function Hb(Id){var Kd=this,vc,Qc,kb,Cc,zc,Fc,xd,Uc,Md,Ob;return regeneratorRuntime.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:vc=Object.keys(Id.collapsedSuites),Qc=Id.loadedTests||[],kb=Qc.find(function(We){return"running"===We.state}),Cc=[],zc=lc(Qc),Le.prev=5,xd=regeneratorRuntime.mark(function xe(){var Fg;return regeneratorRuntime.wrap(function(Zc){for(;;)switch(Zc.prev=
Zc.next){case 0:return Fg=Fc.value,Zc.t0=Cc,Zc.next=4,Kd.renderFile(Fg.file,Fg.tests,vc);case 4:Zc.t1=Zc.sent,Zc.t2=Fg.tests.slice(1).map(function(rd){return"test"===rd.type?Kd.renderTest(rd,Fg.tests,Fg.file,vc):Kd.renderSuite(rd,Fg.tests,Fg.file,vc)}).join("\n"),Zc.t3=Zc.t1+Zc.t2,Zc.t0.push.call(Zc.t0,Zc.t3);case 8:case "end":return Zc.stop()}},xe)}),zc.s();case 8:if((Fc=zc.n()).done){Le.next=12;break}return Le.delegateYield(xd(),"t0",10);case 10:Le.next=8;break;case 12:Le.next=17;break;case 14:Le.prev=
14,Le.t1=Le["catch"](5),zc.e(Le.t1);case 17:return Le.prev=17,zc.f(),Le.finish(17);case 20:return this.html='\n       <div class="mocha-test-runner">\n       <div class="controls" '.concat(this.showControls?"":'style="display: none;"','>\n         <input type="button" class="load-test-button run-button" value="load test" onmousedown="').concat(this.htmlRef,'.interactivelyloadTests()"></input>\n         <input type="button" class="run-button" value="run all" onmouseup="').concat(this.htmlRef,'.runAllTests()"></input>\n         <input type="button" class="collapse-button run-button" value="toggle collapse" onmousedown="').concat(this.htmlRef,
'.collapseToggle()"></input>\n         <span class="').concat(kb?"":"hidden",'">Running: ').concat(kb&&kb.title,'</span>\n       </div>\n       <div class="suites">').concat(Cc.join("\n"),"</div>\n       <div>"),Le.next=23,this.whenRendered();case 23:Uc=this.domNode.getElementsByClassName("suites"),Md=Wb(Uc,1),Ob=Md[0],Ob.onscroll=function(){Kd._currentScrollY=Ob.scrollTop},this.ensureScrollPosition();case 26:case "end":return Le.stop()}},Hb,this,[[5,14,17,20]])}));return function(Id){return Pc.apply(this,
arguments)}}()},{key:"renderTest",value:function(Pc,nd,Id,Hb){var Kd=Pc.fullTitle;nd=Hb.includes(Id)||(Hb||[]).some(function(kb){return 0===Kd.indexOf(kb)});Hb=["test",Pc.state];var vc=10*Pc.depth+20,Qc=Pc.title;return'<div class="row '.concat(nd?"collapsed":""," ").concat(Hb.join(" "),'">\n              <span\n                class="').concat(Hb.join(" "),'"\n                onmousedown="').concat(this.htmlRef,".onClickTest(event, '").concat(Kd,"', '").concat(Id,'\', this);"\n                id="').concat(Kd,
'"\n                style="margin-left: ').concat(vc,'px;"\n                >').concat(Qc,'</span>\n              <span\n                class="duration\n                ').concat(Pc.duration?"":"hidden","\n                ").concat(500<Pc.duration?"very-slow":100<Pc.duration?"slow":"",'"\n                >').concat(Pc.duration,'ms</span>\n              <input\n                type="button" class="run-button" value="run"\n                onmousedown="').concat(this.htmlRef,".runTest('").concat(Kd,
'\')"></input>\n              <div\n                onmousedown="').concat(this.htmlRef,".onClickError(event, '").concat(Kd,"', '").concat(Id,'\', this);"\n                class="error ').concat(Pc.error?"":"hidden",'"\n                style="margin-left: ').concat(vc+10,'px;"\n                >').concat(this.renderError(Pc),"\n              </div>\n            </div>")}},{key:"renderSuite",value:function(Pc,nd,Id,Hb){var Kd=Pc.fullTitle,vc=nd.filter(function(zc){return"test"===zc.type&&0===zc.fullTitle.indexOf(Pc.fullTitle)});
nd=ob.arr.sum(ob.arr.compact(vc.map(function(zc){return zc.duration})));vc=["suite",(vc||[]).some(function(zc){return"failed"===zc.state})?"failed":vc.every(function(zc){return"succeeded"===zc.state})?"succeeded":""];var Qc=Hb.filter(function(zc){return 0===Kd.indexOf(zc)});Hb=Hb.includes(Id)||(Qc||[]).some(function(zc){return zc.length<Kd.length});Qc=!Hb&&!!Qc.length;var kb=10*Pc.depth,Cc=Pc.title;return'<div class="row '.concat(Hb?"collapsed":""," ").concat(vc.join(" "),'">\n              <span\n                class="collapse-button ').concat(Qc?
"collapsed":"",'"\n                onmousedown="').concat(this.htmlRef,".onClickCollapseButton(event, '").concat(Kd,"', '").concat(Id,'\', this);"\n                style="margin-left: ').concat(kb,'px;">').concat(Qc?"\u25ba ":"\u25bc ",'</span>\n              <span\n                class="').concat(vc.join(" "),'"\n                onmousedown="').concat(this.htmlRef,".onClickSuite(event, '").concat(Kd,"', '").concat(Id,'\', this);"\n                id="').concat(Kd,'">').concat(Cc,'</span>\n              <span class="duration">').concat(nd,
'ms</span>\n              <input\n                type="button" class="run-button" value="run"\n                onmousedown="').concat(this.htmlRef,".runSuite('").concat(Kd,"')\"></input>\n            </div>")}},{key:"renderFile",value:function(){var Pc=Rc(regeneratorRuntime.mark(function vc(Id,Hb,Kd){var Qc,kb,Cc,zc,Fc,xd,Uc,Md,Ob;return regeneratorRuntime.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return Qc=Id,kb=Hb.filter(function(We){return"test"===We.type}),Cc=ob.arr.sum(ob.arr.compact(kb.map(function(We){return We.duration}))),
zc=(kb||[]).some(function(We){return"failed"===We.state})?"failed":kb.every(function(We){return"succeeded"===We.state})?"succeeded":"",Fc=this.systemInterface,Le.next=7,Fc.getPackageForModule(Qc);case 7:return Uc=(xd=Le.sent)?xd.name+"/"+Fc.shortModuleName(Qc,xd):Qc,Md=["test-file",zc],Ob=Kd.includes(Qc),Le.abrupt("return",'<div class="row '.concat(Md.join(" "),'">\n              <span\n                class="collapse-button ').concat(Ob?"collapsed":"",'"\n                onmousedown="').concat(this.htmlRef,
".onClickCollapseButton(event, '").concat(Qc,"', '").concat(Id,"', this);\">\n                ").concat(Ob?"\u25ba ":"\u25bc ",'</span>\n              <h2 class="').concat(Md.join(" "),'"\n                  onmousedown="').concat(this.htmlRef,".onClickFile(event, '").concat(Qc,"', this);\"\n               >").concat(Uc,'</h2>\n              <span class="duration">').concat(Cc,'ms</span>\n              <input\n                type="button" class="run-button" value="run"\n                onmousedown="').concat(this.htmlRef,
".runTestFile('").concat(Qc,'\')"></input>\n              <i class="far fa-window-close remove-button"\n                 onmousedown="').concat(this.htmlRef,".removeTestFile('").concat(Qc,"')\"></i>\n            </div>"));case 12:case "end":return Le.stop()}},vc,this)}));return function(Id,Hb,Kd){return Pc.apply(this,arguments)}}()},{key:"renderError",value:function(Pc){function nd(Kd,vc){return ob.jsDiff.diffLines(Kd,vc).reduce(function(Qc,kb){return kb.added||kb.removed?kb.added?Qc.concat("+ "+
kb.value.replace(/\n?$/,"\n")):kb.removed?Qc.concat("- "+kb.value.replace(/\n?$/,"\n")):Qc.concat("???\n"):"  ..."===ob.arr.last(Qc)?Qc:Qc.concat("  ...\n")},[]).join("")}if(!Pc.error)return"";var Id=Pc.error.message?"<p>".concat(Pc.error.message,"</p>"):"";if(!Pc.error.actual||!Pc.error.expected)return"".concat(Id,"<pre>").concat(Pc.error.stack||Pc.error,"</pre>");var Hb=this.stringifyExpectedAndActualOfError(Pc.error);return ob.jsDiff&&Hb&&Hb.expected&&Hb.actual?"".concat(Id,"<p>diff + = actual, - = expected:</p><pre>").concat(nd(Hb.expected,
Hb.actual),"</pre>"):"".concat(Id,"<p>expected:</p><pre>").concat(String(Pc.error.expected),"</pre><p>actual:</p><pre>").concat(String(Pc.error.actual),"</pre>")}},{key:"stringifyExpectedAndActualOfError",value:function(Pc){function nd(Id){if("function"===typeof Id)return String(Id);if("string"===typeof Id)return Id;try{return JSON.stringify(Id,null,2)}catch(Hb){}try{return ob.obj.inspect(Id,{maxDepth:3})}catch(Hb){}return String(Id)}return Pc.expected&&Pc.actual?{expected:nd(Pc.expected),actual:nd(Pc.actual)}:
null}},{key:"scrollIntoView",value:function(Pc){(Pc=document.getElementById(Pc))&&Pc.scrollIntoViewIfNeeded?Pc.scrollIntoViewIfNeeded():Pc&&Pc.scrollIntoView&&Pc.scrollIntoView();return Promise.resolve()}},{key:"interactivelyloadTests",value:function(){var Pc=Rc(regeneratorRuntime.mark(function Id(){var Hb,Kd,vc,Qc,kb,Cc,zc,Fc,xd,Uc,Md,Ob,Le,We,xe;return regeneratorRuntime.wrap(function(Fg){for(;;)switch(Fg.prev=Fg.next){case 0:return Hb=this.systemInterface,Fg.next=3,Hb.getPackages();case 3:return Fg.t0=
function(Zc){var rd=Zc.name;return{isListItem:!0,string:rd,value:{name:rd,url:Zc.url}}},Kd=Fg.sent.map(Fg.t0),Fg.next=7,$world.filterableListPrompt("Choose package",Kd,{requester:this,multiSelect:!0,historyId:"lively.morphic-test-runner-load-tests-pkg-hist"});case 7:return vc=Fg.sent,Qc=Wb(vc.selected,1),kb=Qc[0],Fg.next=12,ob.findTestModulesInPackage(Hb,kb.url);case 12:return Cc=Fg.sent,zc=Cc.map(function(Zc){return{string:Zc.slice(kb.url.length),value:{url:Zc,nameInPackage:Zc.slice(kb.url.length)},
isListItem:!0}}),Fg.next=16,$world.filterableListPrompt("Load tests",zc,{requester:this,multiSelect:!0,historyId:"lively.morphic-test-runner-load-tests-module-hist"});case 16:Fc=Fg.sent,xd=Fc.selected,Uc=ob.LoadingIndicator.open("running tests"),Fg.prev=19,Md=lc(xd),Fg.prev=21,Md.s();case 23:if((Ob=Md.n()).done){Fg.next=30;break}Le=Ob.value;We=Le.url;xe=Le.nameInPackage;Uc.label="Running ".concat(xe);Fg.next=28;return this.runTestFile(We);case 28:Fg.next=23;break;case 30:Fg.next=35;break;case 32:Fg.prev=
32,Fg.t1=Fg["catch"](21),Md.e(Fg.t1);case 35:return Fg.prev=35,Md.f(),Fg.finish(35);case 38:return Fg.prev=38,Uc.remove(),Fg.finish(38);case 41:case "end":return Fg.stop()}},Id,this,[[19,,38,41],[21,32,35,38]])}));return function(){return Pc.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"TestRunner"}},{key:"open",value:function(){var Pc=Rc(regeneratorRuntime.mark(function Hb(Id){var Kd;return regeneratorRuntime.wrap(function(vc){for(;;)switch(vc.prev=
vc.next){case 0:return Kd=(new this(Object.assign({extent:ob.pt(500,600)},Id))).openInWorld(),vc.abrupt("return",Kd.world().openInWindow(Kd,{title:"test runner",name:"test runner window"}).activate());case 2:case "end":return vc.stop()}},Hb,this)}));return function(Id){return Pc.apply(this,arguments)}}()},{key:"properties",get:function(){return{showControls:{defaultValue:!0,after:["html","submorphs"],set:function(Pc){this.setProperty("showControls",Pc);this.get("eval backend button").visible=Pc;this.update()}},
reactsToPointer:{defaultValue:!1},fill:{defaultValue:ob.Color.transparent},state:{},editorPlugin:{get:function(){return this.getProperty("editorPlugin")||(this.editorPlugin=new ob.JavaScriptEditorPlugin)}},name:{defaultValue:"test runner"},systemInterface:{derived:!0,after:["editorPlugin","submorphs"],get:function(){return this.editorPlugin.systemInterface()},set:function(Pc){this.editorPlugin.setSystemInterface(Pc);this.get("eval backend button").updateFromTarget()}},cssDeclaration:{defaultValue:ob.testRunnerCSS}}}}],
tb,{pathInPackage:function(){return"./test-runner.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6155,end:26359})}(ob.HTMLMorph));ob["default"]=da}}});
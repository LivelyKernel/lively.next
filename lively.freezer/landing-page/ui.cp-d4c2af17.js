System.register("./__rootModule___commonjs-entry-51a55f66.js ./editor-plugin-80c3c4f5.js ./index-61952933.js ./object-classes-06d7e61a.js ./import-helper-5edccc49.js ./index-616023be.js ./ui.cp-8dfc076f.js ./index-42118cd5.js ./top-bar.cp-fa0cb96d.js ./popups.cp-5b9fb681.js ./loading-indicator.cp-98e470a2.js ./linter-96a9a2d8.js ./messages.cp-817cc06d.js ./list.cp-840d1cf8.js @babel/plugin-syntax-import-meta ./mode-3092ef0b.js ./editor-modes-aae4d878.js ./editor-plugin-5397d87c.js ./interface-1a7f3c67.js ./tooltips.cp-3c41b378.js ./canvas-2fd3d40b.js lively.collab rollup @rollup/plugin-json ./helpers-94ca076d.js @rollup/plugin-commonjs rollup-plugin-polyfill-node ./user-ui-98206202.js".split(" "),function(bd,
Dd){var se,Rc,ad,Ne,Cb,Sd,ve,uc,dd,vd,Ed,fe,jc,Od,qb,ic,Wb,lc,db,Xa,Gb,sc,ub,sb,fa,Db,ab,eb,kc,Vb,pb,Nb,zb,rb,Ib,da,ka,va,Fa,M,Aa,wb,Na,hb,Bb,ba,dc,la,Fb,vb,Ia,xb,Rb,yc,id,ob,Pb,tb,xc,Pc,nd,Id,Hb,Kd,vc,Qc,kb,Cc,zc,Fc,xd,Uc,Md,Ob,Le,We,xe,Fg,Zc,rd,ti,dg,Of,mg,wf;return{setters:[function(mf){se=mf.s;Rc=mf.bj;ad=mf.c2;Ne=mf.f;Cb=mf.i;Sd=mf.m;ve=mf.bh;uc=mf.c3;dd=mf.t;vd=mf.b3;Ed=mf.a;fe=mf.u;jc=mf.v;Od=mf.a6;qb=mf.b1;ic=mf.bZ;Wb=mf.a3;lc=mf.ay;db=mf.a7;Xa=mf._;Gb=mf.C;sc=mf.r;ub=mf.b;sb=mf.d;fa=mf.aF;
Db=mf.aq;ab=mf.M;eb=mf.az;kc=mf.au;Vb=mf.H;pb=mf.af;Nb=mf.L;zb=mf.F;rb=mf.bf;Ib=mf.K;da=mf.N;ka=mf.l;va=mf.at;Fa=mf.$;M=mf.aK;Aa=mf.c4;wb=mf.c5;Na=mf.k;hb=mf.aD;Bb=mf.c;ba=mf.p;dc=mf.T;la=mf.h},function(mf){Fb=mf["default"]},function(mf){vb=mf.T;Ia=mf.c;xb=mf.j;Rb=mf.e;yc=mf._;id=mf.d},function(mf){ob=mf.isObjectClass;Pb=mf.interactivelyForkPackage;tb=mf.addScript;xc=mf["default"]},function(mf){Pc=mf.chooseUnusedImports;nd=mf.interactivlyFixUndeclaredVariables;Id=mf.interactivelyChooseImports},function(mf){Hb=
mf.e;Kd=mf.a},function(mf){vc=mf.M;Qc=mf.b;kb=mf.p;Cc=mf.R;zc=mf.d;Fc=mf.i;xd=mf.c;Uc=mf.D},function(mf){Md=mf.l2lInterfaceFor;Ob=mf.localInterface},function(mf){Le=mf.a},function(mf){We=mf.v;xe=mf.p},function(mf){Fg=mf.L;Zc=mf.B;rd=mf.c},function(mf){ti=mf.l},function(mf){dg=mf.StatusMessageConfirm;Of=mf.StatusMessageWarning;mg=mf.StatusMessageError},function(mf){wf=mf.a},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},
function(){},function(){},function(){},function(){}],execute:function(){function mf(cb){return he.Inspector.openInWindow({targetObject:cb})}function Mb(cb,Yb){return he.Inspector.openInWindow({remoteTarget:{code:cb,evalEnvironment:Yb}})}function gd(cb){function Yb(ia){var Ca=ia.name,w=ia.ownerChain(),ma=ia.owner,ua=ia.world(),ha;ia===wa&&(ha=[Ea]);ua===ia&&(ha=["$world"]);if(!ha&&Ca&&ma){ma===ua&&1===he.arr.count(he.arr.pluck(ua.submorphs,"name"),Ca)&&(ha=['$world.get("'.concat(Ca,'")')]);if(!ha&&
ma!=ua)for(ua=w.length-1;ua--;)if(1===w[ua].getAllNamed(Ca).length){ha=[].concat(Sd(Yb(w[ua])),['get("'.concat(Ca,'")')]);break}ha||(Ca=[].concat(Sd(Yb(ma)),['get("'.concat(Ca,'")')]),he.syncEval(Ca.join("."),{context:wa}).value===ia&&(ha=Ca))}ha||(ha=["".concat(Ea,'.getMorphWithId("').concat(ia.id,'")')]);return ha}var de=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},P=cb.world(),pa=de.maxLength;pa=void 0===pa?10:pa;de=de.fromMorph;var wa=void 0===de?P:de;if(wa===cb)return"this";var Ea=
P===wa?"$world":"this";if(!(P||cb.name&&wa.get(cb.name)===cb))return"morph";P=Yb(cb);return P.length>pa?'$world.getMorphWithId("'.concat(cb.id,'")'):P.join(".")}function Vd(){return sf.apply(this,arguments)}function sf(){sf=Xa(regeneratorRuntime.mark(function Yb(){var de,P,pa,wa,Ea,ia,Ca,w,ma,ua,ha,ra,mb,E=arguments;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return de=0<E.length&&void 0!==E[0]?E[0]:{},P=de.title,pa=de.target,wa=de.className,Ea=de.methodName,ia=
de.textPosition,Ca=de.scroll,w=de.classTreeScroll,ma=de.evalEnvironment,ua=de.loadingIndicator,ha=Be.part(Be.ObjectEditorLight,{viewModel:Be.obj.dissoc(de,"title","class","method","target","evalEnvironment")}),ra={name:"ObjectEditor window",title:de.title||"ObjectEditor"},R.next=6,ha.openInWindow(ra);case 6:return mb=R.sent.activate(),R.next=9,mb.whenRendered();case 9:if(!pa){R.next=13;break}ua&&(ua.label="Connecting to target");R.next=13;return ha.browse({title:P,target:pa,className:wa,methodName:Ea,
textPosition:ia,scroll:Ca,classTreeScroll:w,evalEnvironment:ma});case 13:return mb.doNotAcceptDropsForThisAndSubmorphs(),R.abrupt("return",mb);case 15:case "end":return R.stop()}},Yb)}));return sf.apply(this,arguments)}bd("open",Vd);var hg=window.lively.FreezerRuntime.recorderFor("lively.ide/js/objecteditor/classTree.js");hg.TreeData=vb;hg.arr=se;hg.withSuperclasses=Rc;hg.lexicalClassMembers=ad;hg.Icon=Ne;var bh=function(cb){var Yb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/objecteditor/classTree.js"),
de=Yb.hasOwnProperty("ClassTreeData")&&"function"===typeof Yb.ClassTreeData?Yb.ClassTreeData:Yb.ClassTreeData=function(P){if(!P||!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Cb(de,cb,[{key:Symbol["for"]("lively-instance-initialize"),value:function(P){Cb._get(Object.getPrototypeOf(de.prototype),Symbol["for"]("lively-instance-initialize"),this).call(this,{target:P,name:"root",isRoot:!0,isCollapsed:!1})}},{key:"display",
value:function(P){return P?P.isRoot?P.target.name||P.target.id||"root object":P.isClass?P.target:P.name||"no name":"empty"}},{key:"isLeaf",value:function(P){return P?!P.isRoot&&!P.isClass:!0}},{key:"isCollapsed",value:function(P){return!P||P.isCollapsed}},{key:"collapse",value:function(P,pa){P&&(P.isCollapsed=pa)}},{key:"getChildren",value:function(P){if(!P)return[];if(P.isRoot){if(P.children)return P.children;var pa=hg.arr.without(hg.withSuperclasses(P.target),Object).reverse();return P.children=
pa.map(function(wa){return{isClass:!0,klass:wa,target:wa[Symbol["for"]("__LivelyClassName__")],isCollapsed:!0}})}if(P.isClass)try{return P.children||(P.children=hg.lexicalClassMembers(P.klass).map(function(wa){var Ea=wa.name,ia=wa.kind,Ca=wa.overridden,w="";wa["static"]&&(w+="static ");"get"===ia&&(w+="get ");"set"===ia&&(w+="set ");return{name:[Ca?[].concat(Sd(hg.Icon.textAttribute("arrow-circle-up")),[" ",{opacity:.5}]):[],w+Ea,{}],target:wa}}))}catch(wa){return $world.showError(wa),P.children=
[]}return[]}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ClassTreeData"}}],Yb,{pathInPackage:function(){return"./js/objecteditor/classTree.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:971,end:2818})}(hg.TreeData);hg["default"]=bh;var Qf=window.lively.FreezerRuntime.recorderFor("lively.ide/js/objecteditor/context.js");
Qf.semver=Hb;Qf.RuntimeSourceDescriptor=ve;Qf.withSuperclasses=Rc;Qf.isClass=uc;Qf.isObjectClass=ob;Qf.interactivelyForkPackage=Pb;Qf.addScript=tb;Qf.string=dd;Qf.num=vd;Qf.promise=Ed;Qf.Path=fe;Qf.obj=jc;Qf.subscribe=Od;Qf.unsubscribe=qb;Qf.L2LClient=ic;Qf.l2lInterfaceFor=Md;Qf.localInterface=Ob;Qf.deserialize=Wb;Qf.getClassName=lc;Qf.stringifyFunctionWithoutToplevelRecorder=db;Qf.modules=Kd;Qf.module=Qf.modules.module;Qf.ClassTreeData=bh;Qf.chooseUnusedImports=Pc;bh=function(cb){var Yb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/objecteditor/context.js"),
de=Yb.hasOwnProperty("ObjectEditorContext")&&"function"===typeof Yb.ObjectEditorContext?Yb.ObjectEditorContext:Yb.ObjectEditorContext=function(P){if(!P||!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Cb(de,cb,[{key:"isRemote",get:function(){return!!this.remoteContextId}},{key:"selectedModule",get:function(){return Qf.module(this.evalEnvironment.targetModule)}},{key:"isRemoteHandle",value:function(P){return Qf.obj.isString(P)&&
P.startsWith("lively://lively.next-object-editor/")}},{key:"selectTarget",value:function(){var P=Xa(regeneratorRuntime.mark(function ia(wa,Ea){var Ca=this,w,ma=arguments;return regeneratorRuntime.wrap(function(ua){for(;;)switch(ua.prev=ua.next){case 0:w=2<ma.length&&void 0!==ma[2]?ma[2]:!1;!this.onModuleChangeHandler&&this.interfaceToEditor&&(this.onModuleChangeHandler=function(){var ha=Xa(regeneratorRuntime.mark(function E(mb){var R;return regeneratorRuntime.wrap(function(Ya){for(;;)switch(Ya.prev=
Ya.next){case 0:return Ya.next=2,Ca.onModuleChanged(mb);case 2:(R=Ya.sent)&&Ca.withEditorDo(function(gb){return gb.reactToModuleChange(R)},{newClassSource:R});case 4:case "end":return Ya.stop()}},E)}));return function(mb){return ha.apply(this,arguments)}}(),Qf.subscribe("lively.modules/modulechanged",this.onModuleChangeHandler),Qf.subscribe("lively.modules/moduleloaded",this.onModuleChangeHandler));if(!w||!this.isRemoteHandle(wa)){ua.next=5;break}this.connectToContext(wa,Ea,w);return ua.abrupt("return",
this);case 5:if(!w||"string"!==typeof wa){ua.next=9;break}ua.next=8;return this.selectRemoteTarget({code:wa,editor:Ea,evalEnvironment:w});case 8:return ua.abrupt("return",this);case 9:return ua.next=11,this.selectLocalTarget(wa,Ea);case 11:return ua.abrupt("return",this);case 12:case "end":return ua.stop()}},ia,this)}));return function(wa,Ea){return P.apply(this,arguments)}}()},{key:"refresh",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia=this;return regeneratorRuntime.wrap(function(Ca){for(;;)switch(Ca.prev=
Ca.next){case 0:this.classTreeData=new Qf.ClassTreeData(this.target.constructor);if(!wa){Ca.next=4;break}Ca.next=4;return this.classTreeData.uncollapseAll(function(w){return ia.classTreeData.getChildren(w)&&w.isRoot});case 4:this.evalEnvironment={context:this.target,systemInterface:Qf.localInterface,targetModule:this.sourceDescriptorFor(this.target.constructor).module.id,format:"esm"};case 5:case "end":return Ca.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"connectToContext",
value:function(){var P=Xa(regeneratorRuntime.mark(function Ca(wa,Ea,ia){return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return this.remoteContextId=this.target=wa,this.evalEnvironment={context:"System.get('@lively-env').objectEditContexts[\"".concat(this.remoteContextId,'"].target'),systemInterface:ia.systemInterface,format:"esm"},w.next=4,this.withContextDo(function(ma){return ma.selectedModule.id});case 4:return this.evalEnvironment.targetModule=w.sent,Ea&&Object.assign(Ea.editorPlugin.evalEnvironment,
this.evalEnvironment),w.next=8,this.withContextDo(function(ma){return ma.selectedClassName});case 8:this.selectedClassName=w.sent;case 9:case "end":return w.stop()}},Ca,this)}));return function(wa,Ea,ia){return P.apply(this,arguments)}}()},{key:"selectLocalTarget",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia,Ca=arguments;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return ia=1<Ca.length&&void 0!==Ca[1]?Ca[1]:!1,this.target=wa,this.selectedMethod=
this.selectedClass=null,w.next=6,this.refresh(!ia);case 6:return ia&&Object.assign(ia.editorPlugin.evalEnvironment,this.evalEnvironment),w.next=9,this.selectClass(Qf.getClassName(wa));case 9:return w.abrupt("return",this);case 10:case "end":return w.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"selectRemoteTarget",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia,Ca,w,ma,ua;return regeneratorRuntime.wrap(function(ha){for(;;)switch(ha.prev=
ha.next){case 0:return ia=wa.code,Ca=wa.evalEnvironment,w=wa.editor,ma=Qf.L2LClient["default"]().id,ha.next=4,Ca.systemInterface.runEval('\n       const { default: ObjectEditorContext} = await System.import("lively.ide/js/objecteditor/context.js");\n       const t = (() => '.concat(ia,')();\n       const ctx = await ObjectEditorContext.for(t);\n       const id = await ctx.connectToEditor("').concat(ma,'", "').concat(w.id,'");\n       const targetModule = ctx.selectedModule.id;\n       const res =  {targetModule, id};\n       res;\n    '),
Ca);case 4:ua=ha.sent;if(!ua.isError){ha.next=7;break}throw Error(ua);case 7:return this.remoteContextId=this.target=ua.value.id,this.evalEnvironment={context:"System.get('@lively-env').objectEditContexts[\"".concat(this.remoteContextId,'"].target'),systemInterface:Ca.systemInterface,targetModule:ua.value.targetModule,format:"esm"},ha.next=11,this.withContextDo(function(ra){return ra.selectedClassName});case 11:this.selectedClassName=ha.sent,w&&Object.assign(w.editorPlugin.evalEnvironment,this.evalEnvironment);
case 13:case "end":return ha.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"dispose",value:function(){var P=this;this.withContextDo(function(){System.get("@system-env").node&&(delete System.get("@lively-env").objectEditContexts[P.id],Qf.unsubscribe("lively.modules/modulechanged",P.onModuleChangeHandler),Qf.unsubscribe("lively.modules/moduleloaded",P.onModuleChangeHandler))})}},{key:"connectToEditor",value:function(P,pa){this.id="lively://lively.next-object-editor/".concat(pa);
System.get("@lively-env").objectEditContexts||(System.get("@lively-env").objectEditContexts={});this.interfaceToEditor=Qf.l2lInterfaceFor(P,Qf.L2LClient["default"]());this.editorId=pa;System.get("@lively-env").objectEditContexts[this.id]=this;return this.id}},{key:"stringifySource",value:function(P){var pa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},wa=Qf.obj.keys(pa).map(function(Ea){return"const ".concat(Ea," = ").concat(JSON.stringify(pa[Ea]),";")}).join("\n");P="string"===P?P:Qf.stringifyFunctionWithoutToplevelRecorder(P);
return"(() => {"+wa+"\n return ("+P+")(this) })()"}},{key:"withEditorDo",value:function(){var P=Xa(regeneratorRuntime.mark(function ia(wa,Ea){var Ca;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return wa=this.wrapSource(this.stringifySource(wa,Ea)),w.next=3,this.interfaceToEditor.runEval(wa,{context:'$world.getMorphWithId("'.concat(this.editorId,'")'),targetModule:"lively.ide/js/objecteditor/index.js",ackTimeout:3E4});case 3:Ca=w.sent;if(!Ca.isError){w.next=6;break}throw Error(Ca.value);
case 6:Ca=Ca.value;if(Qf.obj.isArray(Ca)||!Qf.obj.isObject(Ca)){w.next=9;break}return w.abrupt("return",Qf.deserialize(Ca));case 9:return w.abrupt("return",Ca);case 10:case "end":return w.stop()}},ia,this)}));return function(wa,Ea){return P.apply(this,arguments)}}()},{key:"wrapSource",value:function(P){return"\n          let { serialize } = await System.import('lively.serializer2');\n          let __eval_res__ = await ".concat(P,";\n          if (!obj.isArray(__eval_res__) && obj.isObject(__eval_res__))\n            __eval_res__ = serialize(__eval_res__);\n          __eval_res__;\n        ")}},
{key:"withContextDo",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia=this,Ca,w,ma,ua,ha=arguments;return regeneratorRuntime.wrap(function(ra){for(;;)switch(ra.prev=ra.next){case 0:Ca=1<ha.length&&void 0!==ha[1]?ha[1]:{};if(this.remoteContextId||!Qf.obj.isFunction(wa)){ra.next=5;break}ra.next=4;return wa(this);case 4:return ra.abrupt("return",ra.sent);case 5:if(!this._evalInProgress){ra.next=8;break}ra.next=8;return Qf.promise.waitFor(5E3,function(){return!ia._evalInProgress});
case 8:return this._evalInProgress=!0,wa=this.stringifySource(wa,Ca),w=this.wrapSource(wa),ma=this.remoteContextId?"System.get('@lively-env').objectEditContexts[\"".concat(this.remoteContextId,'"]'):this,ra.next=14,this.evalEnvironment.systemInterface.runEval(w,{targetModule:"lively.ide/js/objecteditor/context.js",ackTimeout:3E4,context:ma});case 14:ua=ra.sent;if(!ua.isError){ra.next=17;break}throw Error(ua.value);case 17:ua=ua.value;this._evalInProgress=!1;if(Qf.obj.isArray(ua)||!Qf.obj.isObject(ua)){ra.next=
21;break}return ra.abrupt("return",Qf.deserialize(ua));case 21:return ra.abrupt("return",ua);case 22:case "end":return ra.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"sourceDescriptorFor",value:function(P){return Qf.RuntimeSourceDescriptor["for"](P)}},{key:"classChainOfTarget",value:function(){return Qf.withSuperclasses(this.target.constructor)}},{key:"addModuleChangeWarning",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea;return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=
ia.next){case 0:if(!this.isSaving){ia.next=2;break}return ia.abrupt("return");case 2:return ia.next=4,this.sourceDescriptorFor(this.selectedClass).source;case 4:Ea=ia.sent,this.moduleChangeWarning=this.selectedModule.id,this.sourceHash=Qf.string.hashCode(Ea);case 7:case "end":return ia.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"onModuleChanged",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia,Ca,w;return regeneratorRuntime.wrap(function(ma){for(;;)switch(ma.prev=
ma.next){case 0:if(!this.isSaving){ma.next=2;break}return ma.abrupt("return");case 2:ia=Qf.module(wa.module);Ca=this.selectedModule;w=this.selectedClass;if(Ca&&Ca.id===ia.id){ma.next=6;break}return ma.abrupt("return");case 6:return ma.next=8,this.sourceDescriptorFor(w).source;case 8:return ma.abrupt("return",ma.sent);case 9:case "end":return ma.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"onModuleLoaded",value:function(P){this.onModuleChanged(P)}},{key:"getTitle",
value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma;return regeneratorRuntime.wrap(function(ua){for(;;)switch(ua.prev=ua.next){case 0:return Ea="",ia=this.selectedClass,Ca=this.selectedMethod,w=this.selectedModule,ia?(Ea+=" - ".concat(ia[Symbol["for"]("__LivelyClassName__")]),Qf.isObjectClass(ia)&&(ma=ia[Symbol["for"]("lively-module-meta")]["package"])&&ma.version&&(Ea+="@"+ma.version),Ca&&(Ea+=">>".concat(Ca.name))):w&&(Ea+=" - ".concat(w.shortName())),ua.abrupt("return",
Ea);case 4:case "end":return ua.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"selectClass",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia=this;return regeneratorRuntime.wrap(function(Ca){for(;;)switch(Ca.prev=Ca.next){case 0:return Ca.next=2,this.withContextDo(function(){var w=ia.classChainOfTarget().find(function(ma){return ma[Symbol["for"]("__LivelyClassName__")]===wa});ia.selectedMethod=null;ia.selectedClass=w;return w[Symbol["for"]("__LivelyClassName__")]},
{className:wa});case 2:this.selectedClassName=Ca.sent;case 3:case "end":return Ca.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"updatePackageConfig",value:function(P){if(Qf.isObjectClass(this.selectedClass)&&P){P=this.evalEnvironment.systemInterface;var pa=this.sourceDescriptorFor(this.selectedClass).module["package"](),wa=Object.assign({},pa.config,{version:Qf.semver.inc(pa.version,"prerelease",!0)});pa=P.getModule(pa.url+"/package.json");P.packageConfChange(JSON.stringify(wa,
null,2),pa.id)}}},{key:"forkPackage",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.next=2,Qf.interactivelyForkPackage(this.target,wa);case 2:return ia.abrupt("return",ia.sent);case 3:case "end":return ia.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"addNewMethod",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){return regeneratorRuntime.wrap(function(Ea){for(;;)switch(Ea.prev=
Ea.next){case 0:return Ea.next=2,Qf.addScript(this.target,"function() {}","newMethod");case 2:return Ea.abrupt("return",Ea.sent);case 3:case "end":return Ea.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"selectMethod",value:function(){var P=Xa(regeneratorRuntime.mark(function ia(wa,Ea){var Ca=this,w;return regeneratorRuntime.wrap(function(ma){for(;;)switch(ma.prev=ma.next){case 0:return ma.next=2,this.withContextDo(Xa(regeneratorRuntime.mark(function ha(){var ra,
mb;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return(ra=Ca.classChainOfTarget().find(function(R){return R[Symbol["for"]("__LivelyClassName__")]===wa}))&&!Ea&&Qf.isClass(ra.owner)&&(Ea=ra,ra=ra.owner),Ca.selectedMethod=Ea,E.next=5,Ca._sourceDescriptor_of_class_findMethodNode(ra,Ea.name,Ea.kind,Ea["static"]);case 5:return mb=E.sent,E.abrupt("return",mb);case 7:case "end":return E.stop()}},ha)})),{className:wa,methodSpec:Ea});case 2:if(w=ma.sent)this.selectedMethodName=
Ea.name;return ma.abrupt("return",w);case 5:case "end":return ma.stop()}},ia,this)}));return function(wa,Ea){return P.apply(this,arguments)}}()},{key:"removeUnusedImports",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia,Ca,w;return regeneratorRuntime.wrap(function(ma){for(;;)switch(ma.prev=ma.next){case 0:return ma.prev=0,ia=this.selectedModule,ma.next=4,ia.source();case 4:return Ca=ma.sent,ma.next=7,Qf.chooseUnusedImports(Ca);case 7:if((w=ma.sent)&&w.changes&&w.changes.length){ma.next=
10;break}return ma.abrupt("return",{statusMessage:"Nothing to remove"});case 10:return ma.next=12,ia.removeImports(w.removedImports);case 12:return ma.abrupt("return",{statusMessage:"Imports removed"});case 15:ma.prev=15;ma.t0=ma["catch"](0);ma.t1=origSource;if(!ma.t1){ma.next=21;break}ma.next=21;return m.changeSource(origSource);case 21:return ma.abrupt("return",{statusMessage:ma.t0.toString()});case 22:case "end":return ma.stop()}},Ea,this,[[0,15]])}));return function(wa){return P.apply(this,arguments)}}()},
{key:"getMethodAtCursorPos",value:function(){var P=Xa(regeneratorRuntime.mark(function Ca(wa,Ea,ia){var w=this;return regeneratorRuntime.wrap(function(ma){for(;;)switch(ma.prev=ma.next){case 0:return ma.next=2,this.withContextDo(function(){var ua=w.classChainOfTarget().find(function(ha){return ha[Symbol["for"]("__LivelyClassName__")]===wa});return w._sourceDescriptor_of_class_findMethodNode(ua,ia)},{cursorIndex:ia});case 2:return ma.abrupt("return",ma.sent);case 3:case "end":return ma.stop()}},Ca,
this)}));return function(wa,Ea,ia){return P.apply(this,arguments)}}()},{key:"_sourceDescriptor_of_class_findMethodNode",value:function(){var P=Xa(regeneratorRuntime.mark(function Ca(wa,Ea,ia){var w,ma,ua,ha,ra,mb,E=arguments;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:w=3<E.length&&void 0!==E[3]?E[3]:!1;ma=4<E.length?E[4]:void 0;ua=this.sourceDescriptorFor(wa);R.t0=ma;if(R.t0){R.next=8;break}R.next=7;return ua.ast;case 7:R.t0=R.sent;case 8:return ha=R.t0,ra=Qf.Path("body.body").get(ha),
mb=ra.find(function(Ya){var gb=Ya.kind,$b=Ya["static"],Sc=Ya.key.name,Ic=Ya.value.body;Ya=Ic.start;Ic=Ic.end;return Qf.obj.isNumber(Ea)?Qf.num.between(Ea,Ya,Ic):Sc!==Ea||$b!==w?!1:!ia||"get"!==ia&&"set"!==ia?!0:ia===gb}),R.abrupt("return",mb);case 12:case "end":return R.stop()}},Ca,this)}));return function(wa,Ea,ia){return P.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ObjectEditorContext"}},{key:"for",value:function(){var P=Xa(regeneratorRuntime.mark(function Ca(wa,
Ea,ia){return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(new this).selectTarget(wa,Ea,ia);case 2:return w.abrupt("return",w.sent);case 3:case "end":return w.stop()}},Ca,this)}));return function(wa,Ea,ia){return P.apply(this,arguments)}}()}],Yb,{pathInPackage:function(){return"./js/objecteditor/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:890,end:13113})}(void 0);Qf["default"]=bh;var he=window.lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");he.inspect=mf;he.remoteInspect=Mb;he.generateReferenceExpression=gd;he.onNumberDragStart=function(cb,Yb){Yb.initPos=cb.position;Yb.factorLabel=(new he.Tooltip({description:"1x"})).openInWorld(cb.hand.position.addXY(10,10))};he.onNumberDrag=function(cb,Yb){var de=he.getScaleAndOffset(cb,Yb),P=de.scale;de=de.offset;Yb.factorLabel.position=cb.hand.position.addXY(10,
10);Yb.factorLabel.description="".concat(P,"x");return he.getCurrentValue(de,P,Yb)};he.onNumberDragEnd=function(cb,Yb){var de=he.getScaleAndOffset(cb,Yb);cb=de.offset;de=de.scale;Yb.factorLabel.softRemove();return he.getCurrentValue(cb,de,Yb)};he.getScaleAndOffset=function(cb,Yb){var de=cb.position.subPt(Yb.initPos);cb=de.x;Yb=he.num.roundTo(Math.exp(-de.y/$world.height*6),.01)*Yb.baseFactor;return{offset:cb,scale:Yb}};he.getCurrentValue=function(cb,Yb,de){return Math.max(de.min,Math.min(de.max,de.scrubbedValue+
(de.floatingPoint?cb*Yb:Math.round(cb*Yb))))};he.Color=Gb;he.rect=sc;he.pt=ub;he.obj=jc;he.num=vd;he.Path=fe;he.arr=se;he.promise=Ed;he.connect=sb;he.disconnect=fa;he.once=Db;he.Morph=ab;he.Tooltip=eb;he.VerticalLayout=kc;he.HorizontalLayout=Vb;he.morph=pb;he.Label=Nb;he.Icon=Ne;he.config=zb;he.Tree=Ia;he.LoadingIndicator=Fg;he.DropDownList=xb;he.DropDownSelector=Rb;he.SearchField=yc;he.LabeledCheckBox=id;he.MorphHighlighter=vc;he.InteractiveMorphSelector=Qc;he.printValue=kb;he.RemoteInspectionTree=
Cc;he.InspectionTree=zc;he.isMultiValue=Fc;he.valueWidgets=We;he.popovers=xe;he.DarkTheme=xd;he.DefaultTheme=Uc;he.syncEval=rb;he.inspectorCommands=[{name:"focus codeEditor",exec:function(cb){cb.get("codeEditor").show();cb.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(cb){cb.get("propertyTree").show();cb.get("propertyTree").focus();return!0}}];(function(cb){var Yb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),de=Yb.hasOwnProperty("DraggedProp")&&
"function"===typeof Yb.DraggedProp?Yb.DraggedProp:Yb.DraggedProp=function(P){if(!P||!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Cb(de,cb,[{key:"applyToTarget",value:function(P){var pa=this.currentTarget,wa=this.control;this.remove();he.MorphHighlighter.removeHighlighters(P.world);if(pa)if(pa.isText&&"js"===pa.editorModeName){var Ea=pa.evalEnvironment.context;P=pa.textPositionFromPoint(pa.localize(P.position));
Ea=he.generateReferenceExpression(this.sourceObject,{fromMorph:Ea});wa.keyString&&(Ea+="."+wa.keyString);pa.insertTextAndSelect(Ea,P);pa.focus()}else"propertyValue"in wa&&(pa[wa.keyString]=wa.propertyValue)}},{key:"update",value:function(P){P=P.hand.globalPosition;var pa=this.morphBeneath(P);if(pa){for(pa==this.morphHighlighter&&(pa=pa.morphBeneath(P));[pa].concat(Sd(pa.ownerChain())).find(function(wa){return!wa.visible});)pa=pa.morphBeneath(P);if(pa!=this.currentTarget){this.currentTarget=pa;this.morphHighlighter&&
this.morphHighlighter.deactivate();if(pa.isWorld)return;this.morphHighlighter=he.MorphHighlighter["for"]($world,pa);this.morphHighlighter.show()}this.position=P}}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:he.Color.rgb(169,204,227)},fill:{defaultValue:he.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],
initialize:function(){var P=this.control;if(!P)return this.submorphs=[];this.height=22;this.submorphs=[P];P.top=0;P.fontSize=14;"function"===typeof P.relayout&&P.relayout();this.width=P.width+20;this.adjustOrigin(he.pt(10,10))}}}}}],Yb,{pathInPackage:function(){return"./js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1184,
end:3773})})(he.Morph);(function(cb){var Yb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),de=Yb.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Yb.DraggableTreeLabel?Yb.DraggableTreeLabel:Yb.DraggableTreeLabel=function(P){if(!P||!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Cb(de,cb,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(P){this.draggedProp=
new he.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();he.connect(P.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(P){}},{key:"onDragEnd",value:function(P){he.disconnect(P.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(P)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},
draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:he.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:he.Color.transparent},padding:{defaultValue:he.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(P){this.setProperty("isSelected",P);P?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=
P)}}}}}],Yb,{pathInPackage:function(){return"./js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3775,end:5203})})(he.Label);var Uf=function(cb){var Yb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),de=Yb.hasOwnProperty("PropertyControl")&&"function"===typeof Yb.PropertyControl?Yb.PropertyControl:
Yb.PropertyControl=function(P){if(!P||!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Cb(de,cb,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(P,pa,wa){P.control=new he.DropDownSelector({opacity:.8,fill:he.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:pa,padding:0,values:wa});he.connect(P.control,"update",P,"propertyValue",
{updater:function(Ea,ia){this.targetObj.propertyValue!=ia&&Ea(ia)}});he.connect(P,"update",P.control,"selectedValue",{updater:function(Ea,ia){ia=ia&&ia.valueOf?ia.valueOf():ia;this.targetObj.propertyValue!=ia&&Ea(ia)}});return P}},{key:"toggleMultiValuePlaceholder",value:function(P){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:he.Color.transparent,layout:new he.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:he.arr.range(0,
2).map(function(pa){return{type:"ellipse",fill:he.Color.gray.withA(.5),reactsToPointer:!1,extent:he.pt(7,7)}})});P?(he.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(he.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(P){this.foldableProperties&&
this.toggleMultiValuePlaceholder(he.isMultiValue(P,this.foldableProperties))}},{key:"asFoldable",value:function(P){this.foldableProperties=P;he.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",
value:function(){return"".concat(this.keyString,": ").concat(this.valueString)}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var P=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});P.isLayoutable=!1;P.fontWeight="bold";P.fontColor=he.Color.orange;P.reactsToPointer=!1;P.fadeOut(2E3)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},
valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(P){this.submorphs=[P]}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[];he.connect(this,"extent",this,"relayout")}}}}},{key:"inferType",value:function(P){P.keyString;return(P=P.value)&&(P.isColor||P.isGradient)?"Color":P&&P.isPoint?"Point":he.obj.isBoolean(P)?"Boolean":he.obj.isNumber(P)?"Number":he.obj.isString(P)?"String":P&&P.isRectangle?
"Rectangle":!1}},{key:"render",value:function(P){P.spec.type||(P.spec=Object.assign({},P.spec,{isFloat:!Number.isInteger(P.value),type:this.inferType(P)}));switch(P.spec.type){case "Color":var pa=this.renderColorControl(P);break;case "ColorGradient":pa=this.renderColorControl(Object.assign({},P,{gradientEnabled:!0}));break;case "Number":pa=this.renderNumberControl(P);break;case "String":pa=this.renderStringControl(P);break;case "RichText":pa=this.renderStringControl(P);break;case "Layout":pa=this.renderLayoutControl(P);
break;case "Enum":pa=this.renderEnumControl(P);break;case "Shadow":pa=this.renderShadowControl(P);break;case "Point":pa=this.renderPointControl(P);break;case "Rectangle":pa=this.renderRectangleControl(P);break;case "Boolean":pa=this.renderBooleanControl(P);break;default:pa=this.renderItSomehow(P)}pa.control&&(he.connect(pa.control,"openWidget",pa,"openWidget"),pa.toggleFoldableValue(P.value));return pa}},{key:"baseControl",value:function(P){var pa=P.spec;P=new this({keyString:P.keyString,valueString:P.valueString,
isSelected:!1,propertyValue:P.value});pa.foldable&&P.asFoldable(pa.foldable);return P}},{key:"renderGrabbableKey",value:function(P){var pa=this,wa=P.target;return["".concat(P.keyString,":"),{nativeCursor:"-webkit-grab",onDragStart:function(Ea){Ea.state.draggedProp=new he.DraggedProp({sourceObject:wa,control:pa.baseControl(P)});Ea.state.draggedProp.openInWorld();he.connect(Ea.hand,"update",Ea.state.draggedProp,"update")},onDrag:function(Ea){},onDragEnd:function(Ea){he.disconnect(Ea.hand,"update",Ea.state.draggedProp,
"update");Ea.state.draggedProp.applyToTarget(Ea)}}]}},{key:"renderEnumControl",value:function(P){var pa=P.value,wa=P.spec.values;P.valueString;var Ea=P.keyString,ia=P.target,Ca=P.node;P.tree;var w=function(){var ma=Xa(regeneratorRuntime.mark(function mb(ha,ra){return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:ia.world().openWorldMenu(ha,wa.map(function(R){return{string:R.toString(),action:function(){ia[Ea]=R;Ca.rerender()}}}));case 1:case "end":return E.stop()}},mb)}));
return function(ha,ra){return ma.apply(this,arguments)}}();return[].concat(Sd(this.renderGrabbableKey(P)),[" ".concat(pa?pa.valueOf?pa.valueOf():pa:"Not set"),{nativeCursor:"pointer",onMouseDown:w}],Sd(he.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:w})))}},{key:"renderStringControl",value:function(P){var pa=P.value;P.fastRender;P.keyString;P.valueString;P.node;return[].concat(Sd(this.renderGrabbableKey(P)),[" ".concat(200<pa.length?pa.slice(0,20)+"...":
pa),{fontColor:he.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(P){var pa=P.value,wa=P.keyString,Ea=P.valueString,ia=P.target,Ca=P.node,w=function(){var ma=Xa(regeneratorRuntime.mark(function ra(ha){var mb;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return mb=new he.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:pa}),mb.relayout(),E.next=4,mb.fadeIntoWorld(ha.positionIn(ia.world()));case 4:he.connect(mb,"rectangle",function(R){ia[wa]=
R;Ca.rerender()});case 5:case "end":return E.stop()}},ra)}));return function(ha){return ma.apply(this,arguments)}}();return[].concat(Sd(this.renderGrabbableKey(P)),[" ".concat(Ea),{fontColor:he.Color.black,nativeCursor:"pointer",onMouseDown:w}])}},{key:"renderBooleanControl",value:function(P){var pa=P.value,wa=P.keyString,Ea=P.valueString,ia=P.target,Ca=P.node;return[].concat(Sd(this.renderGrabbableKey(P)),[" ".concat(Ea),{nativeCursor:"pointer",fontColor:pa?he.Color.green:he.Color.red,onMouseDown:function(w){ia[wa]=
!ia[wa];Ca.rerender()}}])}},{key:"renderNumberControl",value:function(P){var pa=P.value,wa=P.spec,Ea=P.keyString,ia=P.valueString;P.fastRender;var Ca=P.node,w=P.target,ma=P.tree,ua=Ca._numberControls;ua=void 0===ua?new $g:ua;var ha=Ib(ua.submorphs,2),ra=ha[0],mb=ha[1];ua.fontColor=ma.fontColor;var E=Ca._numberControls=ua;"max"in wa&&"min"in wa&&-Infinity!=wa.min&&Infinity!=wa.max?(E.baseFactor=(wa.max-wa.min)/100,E.floatingPoint=wa.isFloat,E.max=wa.max,E.min=wa.min):(E.floatingPoint=wa.isFloat,E.baseFactor=
.5,E.min=void 0!=wa.min?wa.min:-Infinity,E.max=void 0!=wa.max?wa.max:Infinity);var R=he.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat(Sd(this.renderGrabbableKey(P)),Sd(Ca._inputMorph?[Ca._inputMorph,{}]:[" ".concat(void 0!=pa&&(pa.valueOf?pa.valueOf():pa).toFixed(wa.isFloat?Math.max(4,he.num.precision(pa)):0)," "),{fontColor:R,onMouseUp:function(Ya){Ca._inputMorph=he.morph({type:"input",fill:null,fontColor:R,fontFamily:"IBM Plex Mono",fontSize:14,padding:he.rect(8,2,
-6,2),height:23,cursorColor:he.Color.white,value:pa.valueOf?pa.valueOf():ia});w[Ea]=pa;Ca._inputMorph.focus();he.once(Ca._inputMorph,"inputAccepted",function(gb){delete Ca._inputMorph;w[Ea]=wa.isFloat?Number.parseFloat(gb):Number.parseInt(gb);Ca.rerender()});he.once(Ca._inputMorph,"onBlur",function(gb){Ca._inputMorph&&(delete Ca._inputMorph,w[Ea]=pa,Ca.rerender())});Ca.rerender()},onDragStart:function(Ya){E.scrubbedValue=pa;he.onNumberDragStart(Ya,E)},onDrag:function(Ya){w[Ea]=he.onNumberDrag(Ya,
E);Ca.rerender()},onDragEnd:function(Ya){return he.onNumberDragEnd(Ya,E)}},ua,{onMouseUp:function(){ra.fill=mb.fill=null},onMouseDown:function(Ya){if(Ya.targetMorph===ra){ra.fill=he.Color.white.withA(.2);if("max"in wa&&w[Ea]>=wa.max)return;w[Ea]+=1}if(Ya.targetMorph===mb){mb.fill=he.Color.white.withA(.2);if("min"in wa&&w[Ea]<=wa.min)return;--w[Ea]}Ca.rerender()}}]))}},{key:"renderShadowControl",value:function(P){var pa=P.keyString;P.valueString;var wa=P.value,Ea=P.target,ia=P.node,Ca=function(){var w=
Xa(regeneratorRuntime.mark(function ha(ua){var ra;return regeneratorRuntime.wrap(function(mb){for(;;)switch(mb.prev=mb.next){case 0:return ra=new he.popovers.ShadowPopover({shadowValue:Ea[pa],hasFixedPosition:!0}),mb.next=3,ra.fadeIntoWorld(ua.positionIn(Ea.world()));case 3:he.connect(ra,"shadowValue",function(E){Ea[pa]=E;ia.rerender()});case 4:case "end":return mb.stop()}},ha)}));return function(ua){return w.apply(this,arguments)}}();return[].concat(Sd(this.renderGrabbableKey(P)),["".concat(wa?wa.toFilterCss():
"No Shadow"),{nativeCursor:"pointer",onMouseDown:Ca}])}},{key:"renderPointControl",value:function(P){var pa=P.keyString;P.valueString;var wa=P.value;P.fontColor;var Ea=P.target,ia=P.node,Ca=he.valueWidgets.NumberWidget.properties.fontColor.defaultValue,w={nativeCursor:"pointer",onMouseDown:function(){var ma=Xa(regeneratorRuntime.mark(function ra(ha){var mb;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return mb=new he.popovers.PointPopover({pointValue:Ea[pa],hasFixedPosition:!0}),
E.next=3,mb.fadeIntoWorld(ha.positionIn(Ea.world()));case 3:he.connect(mb,"pointValue",function(R){Ea[pa]=R;ia.rerender()});case 4:case "end":return E.stop()}},ra)}));return function(ha){return ma.apply(this,arguments)}}()};return[].concat(Sd(this.renderGrabbableKey(P)),[" pt(",Object.assign({},w),"".concat(wa.x.toFixed()),Object.assign({fontColor:Ca},w),",",Object.assign({},w),"".concat(wa.y.toFixed()),Object.assign({fontColor:Ca},w),")",Object.assign({},w)])}},{key:"renderLayoutControl",value:function(P){P.target;
P.fastRender;var pa=P.valueString;P.keyString;var wa=P.value;return[].concat(Sd(this.renderGrabbableKey(P)),[" ".concat(wa?pa:"No Layout"),{onMouseDown:function(Ea){}}])}},{key:"renderColorControl",value:function(P){var pa=P.node,wa=P.gradientEnabled;P.fastRender;var Ea=P.valueString,ia=P.keyString,Ca=P.value,w=P.target,ma=function(){var ua=Xa(regeneratorRuntime.mark(function mb(ra){var E;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return E=new he.popovers.FillPopover({hasFixedPosition:!0,
handleMorph:w,fillValue:Ca,title:"Fill Control",gradientEnabled:wa}),R.next=3,E.fadeIntoWorld(ra.positionIn(w.world()));case 3:he.connect(E,"fillValue",function(Ya){w[ia]=Ya;pa.rerender()});case 4:case "end":return R.stop()}},mb)}));return function(ra){return ua.apply(this,arguments)}}();return[].concat(Sd(this.renderGrabbableKey(P)),[he.morph({fill:Ca.valueOf?Ca.valueOf():Ca,extent:he.pt(15,15),borderColor:he.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},"".concat(Ca?
Ca.valueOf?Ca.valueOf():Ea:"No Color"),{nativeCursor:"pointer",onMouseDown:ma}])}},{key:"renderItSomehow",value:function(P){P.fastRender;P.keyString;var pa=P.valueString;P.value;return[].concat(Sd(this.renderGrabbableKey(P)),[" ".concat(pa),{}])}}],Yb,{pathInPackage:function(){return"./js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:5212,end:20700})}(he.DraggableTreeLabel);he.PropertyControl=Uf;he.PropertyControl=Uf;he.inspect=mf;he.remoteInspect=Mb;he.generateReferenceExpression=gd;var $g=function(cb){var Yb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),de=Yb.hasOwnProperty("NumberControls")&&"function"===typeof Yb.NumberControls?Yb.NumberControls:Yb.NumberControls=function(P){if(!P||!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return Cb(de,cb,void 0,[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new he.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:he.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(P){this.submorphs.map(function(pa){return pa.fontColor=P})}},submorphs:{initialize:function(){this.submorphs=[he.Icon.makeLabel("sort-up",{autofit:!0,
opacity:.6,nativeCursor:"pointer",padding:he.rect(5,2,0,-6),fontSize:12}),he.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:he.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],Yb,{pathInPackage:function(){return"./js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23397,end:24441})}(he.Morph);
(function(cb){var Yb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),de=Yb.hasOwnProperty("PropertyTree")&&"function"===typeof Yb.PropertyTree?Yb.PropertyTree:Yb.PropertyTree=function(P){if(!P||!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Cb(de,cb,[{key:"onDrag",value:function(P){this._onDragHandler&&this._onDragHandler(P)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"PropertyTree"}}],
Yb,{pathInPackage:function(){return"./js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25640,end:25751})})(he.Tree);Uf=function(cb){var Yb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),de=Yb.hasOwnProperty("Inspector")&&"function"===typeof Yb.Inspector?Yb.Inspector:Yb.Inspector=function(P){if(!P||
!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Cb(de,cb,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(P){}},{key:"__after_deserialize__",value:function(P,pa,wa){var Ea=this;this._serializableTarget;var ia=new he.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:he.InspectionTree.forObject(null,
this)}));this.addMorph(ia,this.getSubmorphNamed("terminal toggler"));Cb._get(Object.getPrototypeOf(de.prototype),"__after_deserialize__",this).call(this,P,pa,wa);!this.isComponent&&this.master.whenApplied().then(function(){Ea.layout.col(0).row(1).group.morph=ia;Ea.targetObject&&(Ea.targetObject=Ea.targetObject)})}},{key:"__additionally_serialize__",value:function(P,pa,wa,Ea){P=P.props.submorphs.value;for(pa=P.length;pa--;)wa.refForId(P[pa].id).realObj==this.ui.propertyTree&&he.arr.removeAt(P,pa)}},
{key:"renderDraggableTreeLabel",value:function(P){return new he.DraggableTreeLabel(P)}},{key:"renderPropertyControl",value:function(P){return he.PropertyControl.render(P)}},{key:"onLoad",value:function(){var P=this.ui,pa=P.codeEditor,wa=P.thisBindingSelector,Ea=P.propertyTree;pa.changeEditorMode("js").then(function(){return pa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==wa.selection?pa.owner.selectedContext:pa.owner.targetObject},get systemInterface(){return he.Path("treeData.systemInterface").get(Ea)},
format:"esm"}})["catch"](function(ia){return $world.logError(ia)})}},{key:Symbol["for"]("lively-instance-initialize"),value:function(P){Cb._get(Object.getPrototypeOf(de.prototype),Symbol["for"]("lively-instance-initialize"),this).call(this,P);P=this.ui;var pa=P.targetPicker,wa=P.propertyTree,Ea=P.resizer,ia=P.terminalToggler,Ca=P.unknowns,w=P.internals,ma=P.searchField,ua=P.codeEditor,ha=P.fixImportButton,ra=P.thisBindingSelector;ua.changeEditorMode("js").then(function(){return ua.evalEnvironment=
{targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==ra.selection?ua.owner.selectedContext:ua.owner.targetObject},get systemInterface(){return wa.treeData.systemInterface},format:"esm"}})["catch"](function(mb){return $world.logError(mb)});he.connect(pa,"onMouseUp",this,"selectTarget");he.connect(wa,"onScroll",this,"repositionOpenWidget");he.connect(Ea,"onDrag",this,"adjustProportions");he.connect(ia,"onMouseDown",this,"toggleCodeEditor");he.connect(Ca,"trigger",this,
"filterProperties");he.connect(w,"trigger",this,"filterProperties");he.connect(ma,"searchInput",this,"filterProperties");he.connect(wa,"nodeCollapseChanged",this,"filterProperties");he.connect(this,"extent",this,"relayout");he.connect(ra,"selection",this,"bindCodeEditorThis");he.connect(ha,"fire",ua,"execCommand",{updater:function(mb){return mb("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var P=this.ui.propertyTree.selectedIndex-
1,pa=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();pa=this.ui.propertyTree.document.getLine(P).textAndAttributes.slice(0,4).concat(pa.display(this));P=this.ui.propertyTree.lineRange(P,!1);this.ui.propertyTree.replace(P,pa,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=
this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var P=he.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(P!=this.lastChange||this.lastSubmorphs!=he.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==P.prop&&this.repositionOpenWidget(),this.lastChange=P,this.lastSubmorphs=he.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},
{key:"refreshTreeView",value:function(){var P;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(pa){pa=pa.node;pa.target&&(P=pa.foldableNode?pa.target[pa.foldableNode.key][pa.key]:pa.target[pa.key],!he.obj.equals(P,pa.value)&&pa.refreshProperty&&pa.refreshProperty(P))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(){var P=
Xa(regeneratorRuntime.mark(function Ea(wa){var ia,Ca,w,ma,ua,ha,ra,mb,E,R,Ya,gb,$b,Sc=arguments;return regeneratorRuntime.wrap(function(Ic){for(;;)switch(Ic.prev=Ic.next){case 0:ia=1<Sc.length&&void 0!==Sc[1]?Sc[1]:!1;if(!this.isUpdating()){Ic.next=4;break}Ic.next=4;return this.whenUpdated();case 4:Ca=he.promise.deferred();w=Ca.promise;ma=!!this.target;this.updateInProgress=w;Ic.prev=7;ia&&(ua=he.LoadingIndicator.open("connecting to remote..."));if(!ia){Ic.next=15;break}Ic.next=12;return he.RemoteInspectionTree.forObject(wa,
this);case 12:Ic.t0=Ic.sent;Ic.next=16;break;case 15:Ic.t0=he.InspectionTree.forObject(wa,this);case 16:return ha=Ic.t0,ra=this.ui.propertyTree,Ic.next=21,ha.collapse(ha.root,!1);case 21:if(!ha.root.children){Ic.next=24;break}Ic.next=24;return ha.collapse(ha.root.children[0],!1);case 24:mb=this.originalTreeData&&this.originalTreeData.diff(ha);if(!mb){Ic.next=30;break}E=da(mb);try{for(E.s();!(R=E.n()).done;)Ya=Ib(R.value,2),gb=Ya[0],$b=Ya[1],gb.refreshProperty($b.value)}catch(Pd){E.e(Pd)}finally{E.f()}Ic.next=
39;break;case 30:return ra.treeData=ha,Ic.next=33,this.filterProperties();case 33:if(!ra.treeData.root.isCollapsed){Ic.next=37;break}Ic.next=36;return ra.onNodeCollapseChanged({node:ha.root,isCollapsed:!1});case 36:ra.selectedIndex=1;case 37:return Ic.next=39,ra.execCommand("uncollapse selected node");case 39:this.toggleWindowStyle(ma);ua&&ua.remove();Ic.next=46;break;case 43:Ic.prev=43,Ic.t1=Ic["catch"](7),this.showError(Ic.t1);case 46:this.startStepping(1E3,"refreshAllProperties"),this.updateInProgress=
null;case 48:case "end":return Ic.stop()}},Ea,this,[[7,43]])}));return function(wa){return P.apply(this,arguments)}}()},{key:"toggleWindowStyle",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma,ua,ha=arguments;return regeneratorRuntime.wrap(function(ra){for(;;)switch(ra.prev=ra.next){case 0:return Ea=0<ha.length&&void 0!==ha[0]?ha[0]:!0,ia=300,ma=this.ui.codeEditor.pluginFind(function(mb){return mb.runEval}),ua=this.getWindow(),ra.next=6,ma.runEval("System.get('@system-env').node");
case 6:if(!ra.sent.value){ra.next=11;break}w=[].concat(Sd(he.arr.without(ua.styleClasses,"local")),["node"]);Ca=he.DarkTheme.instance;ra.next=13;break;case 11:w=["local"].concat(Sd(ua?he.arr.without(ua.styleClasses,"node"):[])),Ca=he.DefaultTheme.instance;case 13:ma.theme=Ca,Ea?(ua&&ua.animate({duration:ia,styleClasses:w}),this.ui.codeEditor.animate({fill:Ca.background,duration:ia})):ua&&(ua.styleClasses=w),this.ui.codeEditor.textString=this.ui.codeEditor.textString,ma.highlight();case 17:case "end":return ra.stop()}},
wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var P=this,pa=Object.assign({type:"text",borderWidth:1,borderColor:he.Color.gray,lineWrapping:"by-chars"},he.config.codeEditor.defaultStyle,{textString:""}),wa=he.Icon.textAttribute("long-arrow-alt-right",
{textStyleClasses:["fas"],paddingTop:"2px"});he.rect(0,0,this.width,30);this.submorphs=[{name:"searchBar",submorphs:[new he.SearchField({styleClasses:["idle"],name:"searchField"}),{type:"button",name:"targetPicker",padding:he.rect(2,2,0,0),borderRadius:15,tooltip:"Change Inspection Target",label:he.Icon.textAttribute("crosshairs")},new he.LabeledCheckBox({label:"Internals",name:"internals"}),new he.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new he.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:he.InspectionTree.forObject(null,this)})),he.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},pa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:he.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat(Sd(wa),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat(Sd(wa),[" selection",
null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){P.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(!this.env.eventDispatcher.isKeyPressed("Shift")){w.next=8;break}w.next=3;return $world.execCommand("select morph",
{justReturn:!0});case 3:ia=w.sent;Ca=Ib(ia,1);Ea=Ca[0];w.next=13;break;case 8:return this.toggleSelectionInstructions(!0),w.next=11,he.InteractiveMorphSelector.selectMorph();case 11:Ea=w.sent,this.toggleSelectionInstructions(!1);case 13:Ea&&(this.targetObject=Ea);case 14:case "end":return w.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"toggleSelectionInstructions",value:function(P){if(P&&!this.instructionWidget){var pa=he.morph({type:"label",name:"escapeKey",value:"esc"});
pa.whenRendered().then(function(){return pa.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},pa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},
{key:"onWidgetOpened",value:function(P){P=P.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;P.epiMorph=!0;this.openWidget=P;he.once(P,"close",this,"closeOpenWidget");he.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var P=this.ui.propertyTree,pa=P.textLayout.boundsFor(P,{column:0,row:P.selectedIndex-1});pa=P.worldPoint(he.pt(pa.x,pa.y+pa.height/2)).addPt(P.scroll.negated());P=P.globalBounds();
pa.x=this.globalBounds().center().x;pa.y<P.top()?pa=P.topCenter():P.bottom()-20<pa.y&&(pa=P.bottomCenter().addXY(0,-20));return pa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(P){this.layout.row(1).height+=P.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(P){if(P!==
this.isEditorVisible()){var pa=this.extent,wa=this.layout,Ea=this.ui,ia=Ea.terminalToggler,Ca=Ea.codeEditor,w=Ea.thisBindingSelector;Ea=Ea.fixImportButton;wa.disable();P?(ia.fontColor=he.Color.rgbHex("00e0ff"),wa.row(3).height=this.codeEditorHeight||180,wa.row(2).height=5,Ea.animate({visible:!0,duration:200}),w.animate({visible:!0,duration:200})):(this.codeEditorHeight=wa.row(3).height,ia.fontColor=he.Color.white,wa.row(3).height=wa.row(2).height=0,Ea.animate({visible:!1,duration:200}),w.animate({visible:!1,
duration:200}));this.extent=pa;wa.enable({duration:200});this.relayout({duration:200});Ca.focus();Ca.animate({opacity:P?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){return regeneratorRuntime.wrap(function(Ea){for(;;)switch(Ea.prev=Ea.next){case 0:this.makeEditorVisible(!this.isEditorVisible());case 1:case "end":return Ea.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"filterProperties",value:function(){var P=
Xa(regeneratorRuntime.mark(function wa(){var Ea,ia;return regeneratorRuntime.wrap(function(Ca){for(;;)switch(Ca.prev=Ca.next){case 0:return Ea=this.ui.searchField,ia=this.ui.propertyTree,this.originalTreeData||(this.originalTreeData=ia.treeData),he.disconnect(ia.treeData,"onWidgetOpened",this,"onWidgetOpened"),Ca.next=6,ia.treeData.filter({maxDepth:2,showUnknown:this.ui.unknowns.checked,showInternal:this.ui.internals.checked,iterator:function(w){return Ea.matches(w.key)}});case 6:ia.update(),he.connect(ia.treeData,
"onWidgetOpened",this,"onWidgetOpened");case 8:case "end":return Ca.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"relayout",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma,ua,ha,ra,mb,E=arguments;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:Ea=0<E.length&&void 0!==E[0]?E[0]:{},this.layout&&this.layout.forceLayout(),ia=this.ui,Ca=ia.fixImportButton,w=ia.terminalToggler,ma=ia.propertyTree,ua=ia.thisBindingSelector,
ha=ma.bounds().insetBy(5).bottomLeft(),ra=ma.bounds().insetBy(5).bottomRight(),mb=ra.subXY(Ca.width+10,0),ua.width=115,ua.listMorph.itemHeight=20,Ea.duration?(w.animate(Object.assign({bottomLeft:ha},Ea)),Ca.animate(Object.assign({bottomRight:ra},Ea)),ua.animate(Object.assign({bottomRight:mb},Ea))):(w.bottomLeft=ha,Ca.bottomRight=ra,ua.bottomRight=mb);case 9:case "end":return R.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"keybindings",get:function(){return[{keys:"Alt-Up",
command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Cb._get(Object.getPrototypeOf(de.prototype),"keybindings",this))}},{key:"commands",get:function(){return he.inspectorCommands}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(P){if(System._testsRunning)return console.log(P.targetObject);P=new this(P);P.openInWindow().doNotAcceptDropsForThisAndSubmorphs();
return P}},{key:"properties",get:function(){return{extent:{defaultValue:he.pt(400,500)},fill:{defaultValue:he.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(P){this.setProperty("remoteTarget",P);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(P,!0))}},targetObject:{after:["submorphs"],set:function(P){this._serializableTarget=P&&P.isMorph?P.id:P;this.setProperty("targetObject",
P);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(P))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var P=this.ui.propertyTree,pa=P.treeData;return pa.getContextFor(P.selectedNode||pa.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),
thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:he.Color.gray,
fontSize:14,fontFamily:he.config.codeEditor.defaultStyle.fontFamily}}}}}],Yb,{pathInPackage:function(){return"./js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25768,end:46417})}(he.Morph);he["default"]=Uf;var Ta=window.lively.FreezerRuntime.recorderFor("lively.ide/js/objecteditor/index.js");Ta.arr=se;Ta.obj=jc;Ta.Path=
fe;Ta.string=dd;Ta.fun=ka;Ta.promise=Ed;Ta.Icon=Ne;Ta.Morph=ab;Ta.HorizontalLayout=Vb;Ta.GridLayout=va;Ta.config=zb;Ta.pt=ub;Ta.Color=Gb;Ta.JavaScriptEditorPlugin=Fb;Ta.withSuperclasses=Rc;Ta.isClass=uc;Ta.LoadingIndicator=Fg;Ta.connect=sb;Ta.RuntimeSourceDescriptor=ve;Ta.ObjectPackage=xc;Ta.isObjectClass=ob;Ta.chooseUnusedImports=Pc;Ta.interactivlyFixUndeclaredVariables=nd;Ta.interactivelyChooseImports=Id;Ta.modules=Kd;Ta.parse=Fa;Ta.query=M;Ta.interactivelySavePart=Aa;Ta.adoptObject=wb;Ta.InteractiveMorphSelector=
Qc;Ta.ObjectEditorContext=bh;Ta.DarkTheme=xd;Ta.DefaultTheme=Uc;Ta.stringifyFunctionWithoutToplevelRecorder=db;Ta.interactivelyFreezePart=Le;Ta.generateReferenceExpression=gd;Ta.getClassName=lc;Ta.resource=Na;Ta.lint=ti;Ta.StatusMessageConfirm=dg;Ta.StatusMessageWarning=Of;Ta.StatusMessageError=mg;Ta.ViewModel=hb;Ta.DANGEROUS_METHODS_TO_OVERRIDE=["render","remove","addMorph","addMorphAt"];bh=function(cb){var Yb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/objecteditor/index.js"),de=Yb.hasOwnProperty("ObjectEditorModel")&&
"function"===typeof Yb.ObjectEditorModel?Yb.ObjectEditorModel:Yb.ObjectEditorModel=function(P){if(!P||!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Cb(de,cb,[{key:"keybindings",get:function(){return[{keys:"F1",command:"focus class tree"},{keys:"F2",command:"focus code editor"},{keys:"F3",command:"toggle showing imports"},{keys:{mac:"Command-S",win:"Ctrl-S"},command:"save source"},{keys:{mac:"Command-Shift-=",win:"Ctrl-Shift-="},
command:"add method"},{keys:{mac:"Command-Shift--",win:"Ctrl-Shift--"},command:"remove method or class"},{keys:"Ctrl-Shift-R",command:"run selected method"},{keys:"Alt-R",command:"refresh"},{keys:{win:"Ctrl-B",mac:"Meta-B"},command:"open class in system browser"},{keys:"Alt-Shift-T",command:"choose target"},{keys:"Alt-J",command:"jump to definition"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}]}},{key:"commands",get:function(){var P=
this;return[{name:"focus class tree",exec:function(){var pa=P.ui.classTree;pa.show();pa.focus();return!0}},{name:"focus code editor",exec:function(){var pa=P.ui.sourceEditor;pa.show();pa.focus();return!0}},{name:"refresh",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.next=2,P.withContextDo(function(Ca){var w=Ca.selectedClass;w&&(Ca=Ca.sourceDescriptorFor(w),Ca.module.reset(),Ca.reset())});
case 2:return ia.next=4,P.refresh(!0);case 4:return P.view.setStatusMessage("reloaded"),ia.abrupt("return",!0);case 6:case "end":return ia.stop()}},Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"[javascript] inject import",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.next=2,P.models.importController.interactivelyAddImport();case 2:return ia.abrupt("return",!0);case 3:case "end":return ia.stop()}},
Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"[javascript] fix undeclared variables",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.abrupt("return",P.interactivlyFixUndeclaredVariables());case 1:case "end":return ia.stop()}},Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"[javascript] removed unused imports",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=
ia.next){case 0:return ia.next=2,P.interactivelyRemoveUnusedImports();case 2:return ia.abrupt("return",!0);case 3:case "end":return ia.stop()}},Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"toggle showing imports",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.next=2,P.toggleShowingImports();case 2:return ia.abrupt("return",!0);case 3:case "end":return ia.stop()}},Ea)}));
return function(){return pa.apply(this,arguments)}}()},{name:"add method",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.next=2,P.interactivelyAddObjectPackageAndMethod();case 2:return ia.abrupt("return",!0);case 3:case "end":return ia.stop()}},Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"remove method or class",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=
ia.next){case 0:return ia.next=2,P.interactivelyRemoveMethodOrClass();case 2:return ia.abrupt("return",!0);case 3:case "end":return ia.stop()}},Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"adopt by superclass",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.next=2,P.interactivelyAdoptBySuperclass();case 2:return ia.abrupt("return",!0);case 3:case "end":return ia.stop()}},
Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"adopt by another class",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.next=2,P.interactivelyAdoptByClass();case 2:return ia.abrupt("return",!0);case 3:case "end":return ia.stop()}},Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"run selected method",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=
ia.next){case 0:return ia.next=2,P.interactivelyRunSelectedMethod();case 2:return ia.abrupt("return",!0);case 3:case "end":return ia.stop()}},Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"jump to definition",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){var ia,Ca,w,ma,ua,ha,ra,mb,E;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return ia=P.ui,Ca=ia.classTree,w=ia.sourceEditor,ma=Ca.treeData,ua=ma.getChildren(ma.root).slice(),
ha=ua.reverse().flatMap(function(Ya){var gb=Ya.target,$b=ma.getChildren(Ya);return[{isListItem:!0,label:[gb,{fontWeight:"bold",fontFamily:"IBM Plex Mono"}],value:{node:Ya,selector:"selectClass",klass:gb}}].concat($b.map(function(Sc){return{isListItem:!0,label:["".concat(gb),{fontSize:"80%",textStyleClasses:["v-center-text"],paddingRight:"10px"},"".concat(Sc.name[1]),{}],value:{node:Sc,selector:"selectMethod",klass:gb}}}))}),R.next=6,P.world().filterableListPrompt("select class or method",ha,{historyId:"lively.morphic-object-editor-jump-def-hist",
requester:P.view});case 6:ra=R.sent;mb=Ib(ra.selected,1);E=mb[0];if(!E){R.next=15;break}R.next=12;return P[E.selector](E.klass,E.node.target);case 12:w.focus(),Ca.scrollSelectionIntoView(),"selectClass"===E.selector&&(w.scroll=Ta.pt(0,0));case 15:return R.abrupt("return",!0);case 16:case "end":return R.stop()}},Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"save source",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){var ia,Ca,w,ma,ua;return regeneratorRuntime.wrap(function(ha){for(;;)switch(ha.prev=
ha.next){case 0:return ha.prev=0,ia=P.view,ha.next=4,P.doSave();case 4:Ca=ha.sent;w=Ca.success;ma=Ca.reason;ua=Ca.warnings;if(!(ua&&0<ua.length)){ha.next=11;break}ia.setStatusMessage(["Saved with warnings:"].concat(ua.map(function(ra){return'"'.concat(ra.message,'" on line ').concat(ra.line)})).join("\n"),Ta.StatusMessageWarning,5E3,{isCompact:!1});return ha.abrupt("return",!0);case 11:ia.setStatusMessage(w?"saved":ma,w?Ta.StatusMessageConfirm:Ta.StatusMessageError,5E3,{extent:Ta.pt(ia.width,40)});
ha.next=17;break;case 14:ha.prev=14,ha.t0=ha["catch"](0),P.view.showError(ha.t0);case 17:return ha.abrupt("return",!0);case 18:case "end":return ha.stop()}},Ea,null,[[0,14]])}));return function(){return pa.apply(this,arguments)}}()},{name:"open class in system browser",exec:function(){var pa=Xa(regeneratorRuntime.mark(function ia(Ea){var Ca,w=arguments;return regeneratorRuntime.wrap(function(ma){for(;;)switch(ma.prev=ma.next){case 0:return Ca=1<w.length&&void 0!==w[1]?w[1]:{klass:null},ma.abrupt("return",
P.browseClass(Ca.klass));case 2:case "end":return ma.stop()}},ia)}));return function(Ea){return pa.apply(this,arguments)}}()},{name:"open object inspector for target",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.abrupt("return",P.world().execCommand("open object inspector",{target:P.target}));case 1:case "end":return ia.stop()}},Ea)}));return function(){return pa.apply(this,arguments)}}()},
{name:"freeze target",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.prev=0,ia.next=3,Ta.interactivelyFreezePart(P.target,P.view);case 3:ia.next=8;break;case 5:ia.prev=5,ia.t0=ia["catch"](0),"canceled"===ia.t0?P.view.setStatusMessage("canceled"):P.view.showError(ia.t0);case 8:case "end":return ia.stop()}},Ea,null,[[0,5]])}));return function(){return pa.apply(this,arguments)}}()},{name:"publish target to PartsBin",
exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){var ia,Ca;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return ia=P.view,w.prev=1,w.next=4,Ta.interactivelySavePart(P.target,{notifications:!1,loadingIndicator:!0});case 4:Ca=w.sent;ia.setStatusMessage(Ca?"Published ".concat(P.target," as ").concat(Ca.name):"Failed to publish part ".concat(P.target),Ca?Ta.StatusMessageConfirm:Ta.StatusMessageError,5E3);w.next=11;break;case 8:w.prev=8,w.t0=w["catch"](1),
"canceled"===w.t0?ia.setStatusMessage("canceled"):ia.showError(w.t0);case 11:case "end":return w.stop()}},Ea,null,[[1,8]])}));return function(){return pa.apply(this,arguments)}}()},{name:"choose target",exec:function(){var pa=Xa(regeneratorRuntime.mark(function Ea(){var ia,Ca,w,ma,ua;return regeneratorRuntime.wrap(function(ha){for(;;)switch(ha.prev=ha.next){case 0:ia=P.view;if(!ia.env.eventDispatcher.isKeyPressed("Shift")){ha.next=18;break}if(!P.context.isRemote){ha.next=10;break}P._loadingIndicator=
Ta.LoadingIndicator.open("Connecting to Remote...");ha.next=6;return P.withContextDo(function(){var ra=Xa(regeneratorRuntime.mark(function R(E){var Ya,gb,$b,Sc;return regeneratorRuntime.wrap(function(Ic){for(;;)switch(Ic.prev=Ic.next){case 0:if(E.target.isMorph){Ic.next=2;break}return Ic.abrupt("return");case 2:return Ya=function(){var Pd=Xa(regeneratorRuntime.mark(function pf(ge,Ce,$e){var ig,Xf,Vg,Re;return regeneratorRuntime.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ig=Ta.stringifyFunctionWithoutToplevelRecorder(function(){var Sb=
Xa(regeneratorRuntime.mark(function zf(hf){var Gg;return regeneratorRuntime.wrap(function(vg){for(;;)switch(vg.prev=vg.next){case 0:return hf._loadingIndicator.remove(),vg.next=3,hf.world().filterableListPrompt(ge,Ce,$e);case 3:return Gg=vg.sent,hf._loadingIndicator=Ta.LoadingIndicator.open("Switching Target..."),vg.abrupt("return",Gg);case 6:case "end":return vg.stop()}},zf)}));return function(hf){return Sb.apply(this,arguments)}}()),ae.next=3,E.withEditorDo(ig,{items:Ce.map(function(Sb){Sb.value=
Sb.value.id;return Sb}),title:ge,opts:$e});case 3:return Xf=ae.sent,Vg=Xf.selected,Re=Xf.action,Vg=Vg.map(function(Sb){return $world.getMorphWithId(Sb)}),ae.abrupt("return",{selected:Vg,action:Re});case 7:case "end":return ae.stop()}},pf)}));return function(ge,Ce,$e){return Pd.apply(this,arguments)}}(),Ic.next=5,$world.execCommand("select morph",{selectionFn:Ya,justReturn:!0,root:[E.target].concat(Sd(E.target.ownerChain())).find(function(Pd){return Pd.owner.isWorld})});case 5:gb=Ic.sent;$b=Ib(gb,
1);Sc=$b[0];if(!Sc){Ic.next=11;break}Ic.next=11;return E.selectTarget(Sc);case 11:case "end":return Ic.stop()}},R)}));return function(E){return ra.apply(this,arguments)}}());case 6:return ha.next=8,P.refresh();case 8:return P._loadingIndicator.remove(),ha.abrupt("return");case 10:return ha.next=12,P.world().execCommand("select morph",{justReturn:!0,root:[P.target].concat(Sd(P.target.ownerChain())).find(function(ra){return ra.owner.isWorld})});case 12:Ca=ha.sent;w=Ib(Ca,1);(ma=w[0])&&P.selectTarget(ma);
ha.next=22;break;case 18:return ha.next=20,Ta.InteractiveMorphSelector.selectMorph(P.world());case 20:(ua=ha.sent)&&P.selectTarget(ua);case 22:return ia.focus(),ha.abrupt("return",P.target);case 24:case "end":return ha.stop()}},Ea)}));return function(){return pa.apply(this,arguments)}}()},{name:"open browse snippet",exec:function(){return P.world().execCommand("open workspace",{content:P.browseSnippetForSelection(),language:"javascript"})}}]}},{key:"viewDidLoad",value:function(){var P=this;this.ui.sourceEditor.addCommands([{name:"[javascript] fix undeclared variables",
exec:function(){return P.interactivlyFixUndeclaredVariables()}},{name:"[javascript] inject import",exec:function(){return P.interactivelyAddImport()}},{name:"[javascript] remove unused imports",exec:function(){return P.interactivelyRemoveUnusedImports()}}])}},{key:"warnForUnsavedChanges",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){return regeneratorRuntime.wrap(function(Ea){for(;;)switch(Ea.prev=Ea.next){case 0:return Ea.next=2,this.world().confirm(["Discard Changes\n",{},"The unsaved changes to this module are going to be discarded.\nAre you sure you want to proceed?",
{fontSize:16,fontWeight:"normal"}],{requester:this.view,width:350});case 2:return Ea.abrupt("return",Ea.sent);case 3:case "end":return Ea.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"onWindowClose",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea;return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return Ea=!0,ia.next=3,this.hasUnsavedChanges();case 3:if(!ia.sent){ia.next=7;break}ia.next=6;return this.warnForUnsavedChanges();
case 6:Ea=ia.sent;case 7:if(!Ea){ia.next=11;break}this.context.dispose();ia.next=12;break;case 11:return ia.abrupt("return",!1);case 12:case "end":return ia.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"isShowingImports",value:function(){return 10<this.view.layout.grid.col(2).width}},{key:"sourceDescriptorFor",value:function(P){return Ta.RuntimeSourceDescriptor["for"](P)}},{key:"classChainOfTarget",value:function(){return Ta.withSuperclasses(this.target.constructor)}},
{key:"toggleShowingImports",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma,ua,ha,ra,mb,E=arguments;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return Ea=0<E.length&&void 0!==E[0]?E[0]:300,ia=this.view,Ca=this.ui,w=Ca.importController,ma=Ca.sourceEditor,ua=w.getExpandedWidth(),ra=(ha=!this.isShowingImports())?ua:-ua,mb=ia.layout.grid.col(2),ia.layout.disable(),w.layout.disable(),mb.width+=ra,mb.before.width-=ra,w.layout.col(0).width=
ha?ua:0,w.layout.enable(Ea?{duration:Ea}:null),R.next=14,ia.layout.enable(Ea?{duration:Ea}:null);case 14:return(ha?w:ma).focus(),R.next=17,Ta.promise.delay(2*Ea);case 17:case "end":return R.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"ensureProperWindowStyle",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma,ua=arguments;return regeneratorRuntime.wrap(function(ha){for(;;)switch(ha.prev=ha.next){case 0:return Ea=0<ua.length&&void 0!==
ua[0]?ua[0]:!0,ia=300,ma=this.view.getWindow(),ha.next=5,this.editorPlugin.runEval("System.get('@system-env').node");case 5:if(!ha.sent.value){ha.next=10;break}w=[].concat(Sd(Ta.arr.without(ma.styleClasses,"local")),["node"]);Ca=Ta.DarkTheme.instance;ha.next=12;break;case 10:w=["local"].concat(Sd(Ta.arr.without(ma.styleClasses,"node"))),Ca=Ta.DefaultTheme.instance;case 12:this.editorPlugin.theme=Ca,Ea?(ma.animate({duration:ia,styleClasses:w}),this.ui.sourceEditor.animate({fill:Ca.background,duration:ia})):
ma.styleClasses=w,this.ui.sourceEditor.textString=this.ui.sourceEditor.textString,this.editorPlugin.highlight();case 16:case "end":return ha.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"selectTarget",value:function(){var P=Xa(regeneratorRuntime.mark(function ia(wa,Ea){var Ca,w,ma,ua;return regeneratorRuntime.wrap(function(ha){for(;;)switch(ha.prev=ha.next){case 0:return Ca=this.ui,w=Ca.classTree,ma=Ca.openInBrowserButton,ua=Ca.publishButton,ha.next=3,Ta.ObjectEditorContext["for"](wa,
this,Ea);case 3:return this.context=ha.sent,ha.next=6,this.withContextDo(function(ra){return!ra.target.isMorph});case 6:if(!ha.sent){ha.next=10;break}ua.disable();ha.next=11;break;case 10:ua.enable();case 11:return ha.next=13,this.withContextDo(function(ra){return!ra.target.constructor[Symbol["for"]("lively-module-meta")]["package"].name});case 13:if(!ha.sent){ha.next=17;break}ma.disable();ha.next=18;break;case 17:ma.enable();case 18:return ha.next=20,this.withContextDo(function(ra){return ra.classTreeData});
case 20:return w.treeData=ha.sent,ha.next=23,this.selectClass(this.context.selectedClassName);case 23:this.ensureProperWindowStyle();case 24:case "end":return ha.stop()}},ia,this)}));return function(wa,Ea){return P.apply(this,arguments)}}()},{key:"withContextDo",value:function(){var P=Xa(regeneratorRuntime.mark(function ia(wa,Ea){return regeneratorRuntime.wrap(function(Ca){for(;;)switch(Ca.prev=Ca.next){case 0:return Ca.next=2,this.context.withContextDo(wa,Ea);case 2:return Ca.abrupt("return",Ca.sent);
case 3:case "end":return Ca.stop()}},ia,this)}));return function(wa,Ea){return P.apply(this,arguments)}}()},{key:"refresh",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma,ua,ha,ra,mb=arguments;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return Ea=0<mb.length&&void 0!==mb[0]?mb[0]:!1,ia=this.ui,Ca=ia.sourceEditor,w=ia.classTree,ma=Ca.cursorPosition,E.next=5,this.withContextDo(function(){var R=Xa(regeneratorRuntime.mark(function $b(gb){var Sc;
return regeneratorRuntime.wrap(function(Ic){for(;;)switch(Ic.prev=Ic.next){case 0:return Sc={className:gb.selectedClass&&gb.selectedClass.name,methodName:gb.selectedMethod&&gb.selectedMethod.name},Ic.next=3,gb.refresh();case 3:return Sc.treeData=gb.classTreeData,Ic.abrupt("return",Sc);case 5:case "end":return Ic.stop()}},$b)}));return function(gb){return R.apply(this,arguments)}}());case 5:return ua=E.sent,ha=ua.className,ra=ua.treeData,E.next=10,w.maintainViewStateWhile(function(){return w.treeData=
ra},function(R){return R.isClass?R.target:R.name});case 10:if(!ha||w.selectedNode){E.next=13;break}E.next=13;return this.selectClass(ha);case 13:Ea&&(Ca.cursorPosition=ma);case 14:case "end":return E.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"updateKnownGlobals",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea;return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.next=2,this.withContextDo(function(){var Ca=
Xa(regeneratorRuntime.mark(function ua(ma){var ha,ra,mb;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:ha=[];ra=ma.selectedClass;if(!ra){E.next=8;break}mb=ma.sourceDescriptorFor(ra);E.next=6;return mb.declaredAndUndeclaredNames;case 6:Ta.__inter0__=E.sent,ha=Ta.__inter0__.declaredNames;case 8:return Object.assign(ma.evalEnvironment,{knownGlobals:ha}),E.abrupt("return",ha);case 10:case "end":return E.stop()}},ua)}));return function(ma){return Ca.apply(this,arguments)}}());
case 2:Ea=ia.sent,Object.assign(this.editorPlugin.evalEnvironment,{knownGlobals:Ea}),this.editorPlugin.highlight();case 5:case "end":return ia.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"updateSource",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia,Ca,w,ma,ua=arguments;return regeneratorRuntime.wrap(function(ha){for(;;)switch(ha.prev=ha.next){case 0:return ia=1<ua.length&&void 0!==ua[1]?ua[1]:"lively://object-editor/"+this.id,Ca=this.ui.sourceEditor,
ha.next=4,this.withContextDo(function(){var ra=Xa(regeneratorRuntime.mark(function R(E){var Ya,gb;return regeneratorRuntime.wrap(function($b){for(;;)switch($b.prev=$b.next){case 0:return Ya=E.evalEnvironment.systemInterface,$b.next=3,Ya.moduleFormat(ia);case 3:$b.t0=$b.sent;if($b.t0){$b.next=6;break}$b.t0="esm";case 6:return gb=$b.t0,Object.assign(E.evalEnvironment,{targetModule:ia,format:gb}),$b.abrupt("return",gb);case 9:case "end":return $b.stop()}},R)}));return function(E){return ra.apply(this,
arguments)}}(),{targetModule:ia});case 4:return w=ha.sent,Ca.textString!==wa&&(Ca.textString=wa),Object.assign(this.editorPlugin.evalEnvironment,{targetModule:ia,format:w}),ma=Ta.string.hashCode(wa),ha.next=10,this.withContextDo(function(ra){ra.moduleChangeWarning=null;ra.sourceHash=ma},{hashCode:ma});case 10:return ha.next=12,this.clearLocalProperties();case 12:this.indicateNoUnsavedChanges();case 13:case "end":return ha.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},
{key:"clearLocalProperties",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){return regeneratorRuntime.wrap(function(Ea){for(;;)switch(Ea.prev=Ea.next){case 0:return Ea.next=2,this.withContextDo(function(ia){var Ca=ia.target.propertiesAndPropertySettings().properties,w;for(w in Ca)!ia.target.hasOwnProperty(w)||ia.target[w]&&ia.target[w].isConnectionWrapper||ia.hasOwnProperty("$$"+w)&&delete ia.target[w]});case 2:case "end":return Ea.stop()}},wa,this)}));return function(){return P.apply(this,
arguments)}}()},{key:"indicateUnsavedChanges",value:function(){var P=this.ui.sourceEditor;this.view.layout.col(1).paddingRight=1;P.padding=P.padding.withWidth(-1);P.borderColor=Ta.Color.red}},{key:"indicateNoUnsavedChanges",value:function(){var P=this.ui.sourceEditor;this.view.layout.col(1).paddingRight=0;P.padding=P.padding.withWidth(0);P.borderColor=Ta.Color.gray}},{key:"hasUnsavedChanges",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){return regeneratorRuntime.wrap(function(Ea){for(;;)switch(Ea.prev=
Ea.next){case 0:return Ea.next=2,this.withContextDo(function(ia){return ia.sourceHash});case 2:return Ea.t0=Ea.sent,Ea.t1=Ta.string.hashCode(this.ui.sourceEditor.textString),Ea.abrupt("return",Ea.t0!==Ea.t1);case 5:case "end":return Ea.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"updateUnsavedChangeIndicator",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){return regeneratorRuntime.wrap(function(Ea){for(;;)switch(Ea.prev=Ea.next){case 0:return Ea.next=
2,this.hasUnsavedChanges();case 2:if(!Ea.sent){Ea.next=6;break}Ea.t0="indicateUnsavedChanges";Ea.next=7;break;case 6:Ea.t0="indicateNoUnsavedChanges";case 7:Ea.t1=Ea.t0,this[Ea.t1]();case 9:case "end":return Ea.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"updateUnsavedChangeIndicatorDebounced",value:function(){var P=this;Ta.fun.debounceNamed(this.id+"-updateUnsavedChangeIndicatorDebounced",20,function(){return P.updateUnsavedChangeIndicator()})()}},{key:"reactToModuleChange",
value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia;return regeneratorRuntime.wrap(function(Ca){for(;;)switch(Ca.prev=Ca.next){case 0:return ia=this.ui.sourceEditor,Ca.next=3,this.hasUnsavedChanges();case 3:if(!Ca.sent){Ca.next=8;break}if(Ta.string.hashCode(ia.textString)===Ta.string.hashCode(wa)){Ca.next=8;break}Ca.next=7;return this.withContextDo(function(w){return w.addModuleChangeWarning()});case 7:return Ca.abrupt("return");case 8:return Ca.next=10,this.refresh(!0);case 10:case "end":return Ca.stop()}},
Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"onModuleChanged",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia;return regeneratorRuntime.wrap(function(Ca){for(;;)switch(Ca.prev=Ca.next){case 0:if(this.context&&!this.context.isRemote){Ca.next=2;break}return Ca.abrupt("return");case 2:return Ca.next=4,this.context.onModuleChanged(wa);case 4:(ia=Ca.sent)&&this.reactToModuleChange(ia);case 6:case "end":return Ca.stop()}},Ea,this)}));return function(wa){return P.apply(this,
arguments)}}()},{key:"onModuleLoaded",value:function(P){this.onModuleChanged(P)}},{key:"browse",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia,Ca,w,ma,ua,ha,ra,mb,E,R;return regeneratorRuntime.wrap(function(Ya){for(;;)switch(Ya.prev=Ya.next){case 0:ia=wa.target;Ca=wa.className;w=wa.methodName;ma=wa.textPosition;ua=wa.scroll;ha=wa.classTreeScroll;ra=wa.evalEnvironment;if(!ia){Ya.next=4;break}Ya.next=4;return this.selectTarget(ia,ra);case 4:if(Ca){Ya.next=8;break}Ya.next=7;
return this.withContextDo(function(gb){return gb.selectedClass.name});case 7:Ca=Ya.sent;case 8:if(!Ca||!w){Ya.next=13;break}Ya.next=11;return this.selectMethod(Ca,w,!1);case 11:Ya.next=16;break;case 13:if(!Ca){Ya.next=16;break}Ya.next=16;return this.selectClass(Ca);case 16:return mb=this.ui,E=mb.classTree,R=mb.sourceEditor,ua&&(R.scroll=ua),ma&&(R.cursorPosition=ma),ha&&(E.scroll=ha),Ya.abrupt("return",this);case 21:case "end":return Ya.stop()}},Ea,this)}));return function(wa){return P.apply(this,
arguments)}}()},{key:"browseSpec",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma,ua,ha,ra,mb,E=arguments;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return Ea=0<E.length&&void 0!==E[0]?E[0]:!0,ia=this.ui,Ca=ia.classTree.scroll,w=ia.sourceEditor,ma=w.scroll,ua=w.cursorPosition,R.next=4,this.withContextDo(function(Ya){return{className:Ya.selectedClass&&Ya.selectedClass.name,methodName:Ya.selectedMethod&&Ya.selectedMethod.name}});
case 4:return ha=R.sent,ra=ha.className,mb=ha.methodName,R.abrupt("return",Object.assign({target:this.context.target,className:ra,methodName:mb,evalEnvironment:this.context.evalEnvironment},Ea?{scroll:ma,textPosition:ua,classTreeScroll:Ca}:{}));case 8:case "end":return R.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"browseClass",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia,Ca,w;return regeneratorRuntime.wrap(function(ma){for(;;)switch(ma.prev=
ma.next){case 0:if(!wa){ma.next=4;break}Ta.__inter1__=this.context.sourceDescriptorFor(wa);ia=Ta.__inter1__.name;w=Ta.__inter1__.module;Ca=w.id;w;ma.next=9;break;case 4:return ma.next=6,this.withContextDo(function(ua){if(!ua.selectedClass)return{};ua=ua.sourceDescriptorFor(ua.selectedClass);return{className:ua.name,moduleName:ua.module.id}});case 6:Ta.__inter2__=ma.sent,ia=Ta.__inter2__.className,Ca=Ta.__inter2__.moduleName;case 9:if(!Ca||!ia){ma.next=11;break}return ma.abrupt("return",this.world().execCommand("open browser",
{moduleName:Ca,codeEntity:{name:ia},systemInterface:this.systemInterface}));case 11:return this.view.setStatusMessage("No class specified"),ma.abrupt("return",!0);case 13:case "end":return ma.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"browseSnippetForSelection",value:function(){var P=this.context.selectedClassName,pa=this.selectedMethod;var wa='$world.execCommand("open object editor", {'+"target: ".concat(Ta.generateReferenceExpression(this.target));P&&(wa+=
', selectedClass: "'.concat(P,'"'));pa&&P&&(wa+=', selectedMethod: "'.concat(pa.name,'"'));return wa+"});"}},{key:"onClassTreeSelection",value:function(P){if(P)if(Ta.obj.isString(P.target)||Ta.isClass(P.target))this.selectClass(P.target);else{var pa=this.ui.classTree.treeData.parentNode(P),wa=!!Ta.Path("env.eventDispatcher.eventState.clickedOnMorph").get(this.view);this.selectMethod(pa.target,P.target,wa)}}},{key:"contextMenuForClassTree",value:function(P){var pa=P.node;P=P.evt;P.stop();if(pa&&pa.target){pa=
Ta.isClass(pa.target)?pa.target:pa.target.owner&&Ta.isClass(pa.target.owner)?pa.target.owner:Ta.obj.isString(pa.target)?pa.target:null;var wa=[];pa&&wa.push({command:"open browse snippet",target:this.view});if(Ta.obj.isString(pa)?this.context.selectedClassName===pa:this.context.selectedClass===pa){var Ea=[];"Morph"!==pa.name&&Ea.push({alias:"by superclass",command:"adopt by superclass",target:this.view});Ea.push({alias:"by custom class...",command:"adopt by another class",target:this.view});wa.push(["adopt by...",
Ea])}return this.world().openWorldMenu(P,wa)}}},{key:"selectClass",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia=this,Ca,w,ma,ua,ha,ra;return regeneratorRuntime.wrap(function(mb){for(;;)switch(mb.prev=mb.next){case 0:if(!this._updatingTree){mb.next=2;break}return mb.abrupt("return");case 2:Ca=this.ui.classTree;w="string"===typeof wa?wa:wa.name;if(this.context.selectedClassName===w){mb.next=25;break}mb.t1=Ca.selectedNode;if(!mb.t1){mb.next=10;break}mb.next=9;return this.hasUnsavedChanges();
case 9:mb.t1=mb.sent;case 10:mb.t0=mb.t1;if(!mb.t0){mb.next=13;break}mb.t0=this.ui.sourceEditor.textString;case 13:if(!mb.t0){mb.next=23;break}mb.next=16;return this.warnForUnsavedChanges();case 16:if(ma=mb.sent){mb.next=23;break}ua=Ca.nodes.find(function(E){return!E.isRoot&&E.isClass&&E.klass.name===ia.context.selectedClassName});this._updatingTree=!0;Ca.selectedNode=ua;this._updatingTree=!1;return mb.abrupt("return");case 23:return mb.next=25,this.context.selectClass(w);case 25:return mb.next=27,
this.withContextDo(function(E){return Ta.isObjectClass(E.selectedClass)});case 27:if(!mb.sent){mb.next=31;break}this.ui.forkPackageButton.enable();mb.next=32;break;case 31:this.ui.forkPackageButton.disable();case 32:return mb.next=34,this.withContextDo(function(){var E=Xa(regeneratorRuntime.mark(function gb(Ya){var $b;return regeneratorRuntime.wrap(function(Sc){for(;;)switch(Sc.prev=Sc.next){case 0:Ya.selectedMethod=null;$b=Ya.sourceDescriptorFor(Ya.selectedClass);if($b._moduleSource||!$b.module._frozenModule){Sc.next=
6;break}Sc.next=5;return $b.module.source();case 5:$b._moduleSource=Sc.sent;case 6:return Sc.abrupt("return",{source:$b.source,moduleId:$b.module.id});case 7:case "end":return Sc.stop()}},gb)}));return function(Ya){return E.apply(this,arguments)}}());case 34:return ha=mb.sent,mb.t2=this,mb.next=38,ha.source;case 38:return mb.t3=mb.sent,mb.t4=ha.moduleId,mb.next=42,mb.t2.updateSource.call(mb.t2,mb.t3,mb.t4);case 42:return mb.next=44,this.updateKnownGlobals();case 44:return mb.next=46,this.updateTitle();
case 46:return mb.next=48,this.ui.importController.setModule(ha.moduleId);case 48:Ca.selectedNode&&Ca.selectedNode.target===wa||(ra=Ca.nodes.find(function(E){return!E.isRoot&&E.isClass&&E.name===wa}),Ca.selectedNode=ra);case 49:case "end":return mb.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"selectMethod",value:function(){var P=Xa(regeneratorRuntime.mark(function ia(wa,Ea){var Ca,w,ma,ua,ha,ra,mb,E,R,Ya,gb=arguments;return regeneratorRuntime.wrap(function($b){for(;;)switch($b.prev=
$b.next){case 0:return Ca=2<gb.length&&void 0!==gb[2]?gb[2]:!0,w=3<gb.length&&void 0!==gb[3]?gb[3]:!1,ma=wa.name||wa,Ea.name||(Ea={name:Ea}),$b.next=6,this.context.selectMethod(ma,Ea);case 6:if(ua=$b.sent){$b.next=10;break}this.setStatusMessage("Cannot find method ".concat(Ea.name));return $b.abrupt("return");case 10:return $b.next=12,this.updateTitle();case 12:return ha=this.ui.classTree,$b.next=15,this.withContextDo(function(Sc){return Sc.selectedClass.name!==ma},{className:ma});case 15:ra=$b.sent;
if(!ra&&ha.selectedNode){$b.next=19;break}$b.next=19;return this.selectClass(wa);case 19:return $b.next=21,ha.uncollapse(ha.selectedNode);case 21:ha.selectedNode&&ha.selectedNode.target===Ea||(mb=ha.nodes.find(function(Sc){return!Sc.isClass&&!Sc.isRoot&&Sc.target.owner===wa&&Sc.target.name===Ea.name}),ha.selectedNode=mb,ha.scrollSelectionIntoView()),E=this.ui.sourceEditor,R=E.indexToPosition(w?ua.value.body.start+1:ua.key.start),E.cursorPosition=R,E.scrollCursorIntoView(),Ya={start:E.indexToPosition(ua.start),
end:E.indexToPosition(ua.end)},E.centerRange(Ya),Ca&&E.flash(Ya,{id:"method",time:1E3,fill:E.selectionColor||Ta.Color.blue.withA(.2)}),this.selectedMethodName=Ea.name;case 30:case "end":return $b.stop()}},ia,this)}));return function(wa,Ea){return P.apply(this,arguments)}}()},{key:"displayFrozenWarningIfNeeded",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w;return regeneratorRuntime.wrap(function(ma){for(;;)switch(ma.prev=ma.next){case 0:return Ea=this.view,ma.next=
3,this.withContextDo(function(ua){return ua.selectedModule._frozenModule&&{pkgName:ua.selectedModule["package"]().name,moduleName:ua.selectedModule.pathInPackage()}});case 3:if(ia=ma.sent)this.ui.frozenWarning.textString='The module "'.concat(ia.pkgName,"/").concat(ia.moduleName,'" you are viewing is frozen. You are not able to make changes to this module unless you reload the world with dynamic load enabled for the package "').concat(ia.pkgName,'".');this.ui.saveButton.deactivated=!!ia;Ca=Ea.layout.row(1).height;
w=Ea.layout.row(1);Ea.layout.disable();w.height=ia?80:0;w.after.height-=Ca!==w.height?ia?80:-80:0;Ea.layout.enable({duration:300});case 12:case "end":return ma.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"updateTitle",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(Ea=this.view.getWindow()){w.next=3;break}return w.abrupt("return");case 3:return ia="ObjectEditor",
w.t0=ia,w.next=7,this.withContextDo(function(ma){return ma.getTitle()});case 7:ia=w.t0+=w.sent,Ca=this.systemInterface.coreInterface.url,ia+=Ca?" [".concat(Ca,"]"):"",Ea.title=ia,Ea.relayoutWindowControls();case 12:case "end":return w.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"doSave",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea=this,ia,Ca,w,ma,ua,ha,ra,mb,E,R,Ya,gb,$b,Sc,Ic,Pd;return regeneratorRuntime.wrap(function(Zd){for(;;)switch(Zd.prev=
Zd.next){case 0:return ia=this.ui.sourceEditor,Zd.next=3,this.withContextDo(function(ge){return!ge.selectedClass});case 3:if(!Zd.sent){Zd.next=5;break}return Zd.abrupt("return",{success:!1,reason:"No class selected"});case 5:return Zd.next=7,this.withContextDo(function(ge){return ge.selectedModule._frozenModule});case 7:if(!Zd.sent){Zd.next=9;break}return Zd.abrupt("return",{success:!1,reason:"Frozen modules can not be altered"});case 9:if(!Ta.config.objectEditor.fixUndeclaredVarsOnSave){Zd.next=
15;break}Zd.next=12;return this.execCommand("[javascript] fix undeclared variables");case 12:if(Ca=Zd.sent){Zd.next=15;break}return Zd.abrupt("return",{success:!1,reason:"Save canceled"});case 15:return ma=ia.textString,Zd.next=18,this.withContextDo(function(ge){ge=ge.selectedClass;var Ce=Ta.parse(ma);if(1!==Ce.body.length||"ClassDeclaration"!==Ce.body[0].type)return{success:!1,reason:"Code is expected to contain the class definition of ".concat(ge,", aborting save.")};Ce=Ce.body[0];var $e=ma.slice(Ce.id.start,
Ce.id.end);$e!==ge.name&&(ma=ma.slice(0,Ce.id.start)+ge.name+ma.slice(Ce.id.end));return{content:ma,className:$e}},{content:ma});case 18:return Ta.__inter3__=Zd.sent,ma=Ta.__inter3__.content,w=Ta.__inter3__.className,ua=!1,ha=Ta.lint(ma,{"no-unused-vars":["warn",{args:"none",varsIgnorePattern:"_|".concat(w)}]}),ra=Ib(ha,2),ma=ra[0],ua=ra[1],mb=Ta.string.hashCode(ma),Zd.next=29,this.withContextDo(function(ge){var Ce=ge.selectedModule;return{selectedModuleId:Ce.id,sourceChanged:ge.sourceHash!==mb,outsideChangeWarning:ge.moduleChangeWarning===
Ce.id}},{editorSourceHash:mb});case 29:return E=Zd.sent,R=E.sourceChanged,Ya=E.outsideChangeWarning,gb=E.selectedModuleId,Zd.next=35,this.withContextDo(function(ge){var Ce=Ta.parse(ma);Ce=Ib(Ta.query.topLevelDeclsAndRefs(Ce).classDecls,1)[0];Ce=Ta.query.nodesInScopeOf(Ce).filter(function($e){return"MethodDefinition"===$e.type&&Ta.DANGEROUS_METHODS_TO_OVERRIDE.includes($e.key.name)&&!ge.selectedClass.prototype.hasOwnProperty($e.key.name)});return Ce.length?Ce.map(function($e){return $e.key.name}):
!1});case 35:if($b=Zd.sent,!$b){Zd.next=45;break}case 37:if(!(Sc=$b.pop())){Zd.next=45;break}Zd.next=40;return this.world().confirm(["System Method Override\n",{},"You are about to override ",{fontWeight:"normal",fontSize:16},Sc+"()",{fontWeight:"bold",fontStyle:"italic"}," which is a method at the core of the System. You should only proceed if you are absolutely sure you know what you are doing, else you may cause to crash the running System.",{fontWeight:"normal"}],{width:400,requester:this});case 40:if(Ic=
Zd.sent){Zd.next=43;break}return Zd.abrupt("return",{success:!1});case 43:Zd.next=37;break;case 45:if(!R||!Ya){Zd.next=53;break}Zd.next=48;return this.world().confirm(["Simultaneous Change Warning\n",{},"The module ".concat(gb," you are trying to save changed elsewhere!\nOverwrite those changes?"),{fontSize:16,fontWeight:"normal"}],{requester:this});case 48:if(Pd=Zd.sent){Zd.next=51;break}return Zd.abrupt("return",{success:!1,reason:"Save canceled"});case 51:return Zd.next=53,this.withContextDo(function(ge){return ge.moduleChangeWarning=
null});case 53:return this.backupSourceInLocalStorage(ma),Zd.prev=54,Zd.next=57,this.withContextDo(function(){var ge=Xa(regeneratorRuntime.mark(function pf($e){return regeneratorRuntime.wrap(function(ig){for(;;)switch(ig.prev=ig.next){case 0:return $e.isSaving=!0,ig.next=3,Ea.sourceDescriptorFor($e.selectedClass).changeSource(ma);case 3:case "end":return ig.stop()}},pf)}));return function($e){return ge.apply(this,arguments)}}(),{content:ma});case 57:return Zd.next=59,ia.saveExcursion(Xa(regeneratorRuntime.mark(function Ce(){return regeneratorRuntime.wrap(function($e){for(;;)switch($e.prev=
$e.next){case 0:return $e.next=2,Ea.refresh();case 2:case "end":return $e.stop()}},Ce)})));case 59:return Zd.next=61,this.withContextDo(function(Ce){Ce.updatePackageConfig(R)},{sourceChanged:R});case 61:return Zd.abrupt("return",{success:!0,warnings:ua});case 62:return Zd.prev=62,this.jumpToMethodAtCursorPosition(),Zd.next=66,this.withContextDo(function(Ce){return Ce.isSaving=!1});case 66:return this.updateSource(ma,gb),Zd.finish(62);case 68:this.target instanceof Ta.ViewModel&&(this.target.reifyBindings(),
this.target.reifyExposedProps());case 69:case "end":return Zd.stop()}},wa,this,[[54,,62,68]])}));return function(){return P.apply(this,arguments)}}()},{key:"jumpToMethodAtCursorPosition",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w;return regeneratorRuntime.wrap(function(ma){for(;;)switch(ma.prev=ma.next){case 0:return ma.abrupt("return");case 5:Ea=ma.sent,ia=Ib(Ea,2),Ca=ia[0],w=ia[1],this.selectMethod(w,Ca.key.name,!1);case 10:case "end":return ma.stop()}},wa,this)}));
return function(){return P.apply(this,arguments)}}()},{key:"backupSourceInLocalStorage",value:function(P){var pa=JSON.parse(localStorage.getItem("oe helper")||'{"saves": []}');pa.saves.some(function(wa){return"string"===typeof wa?wa===P:wa.source===P})||(100<pa.saves.length&&(pa.saves=pa.saves.slice(40,100)),pa.saves.push({source:P,time:Date.now()}),localStorage.setItem("oe helper",JSON.stringify(pa)))}},{key:"interactivelyAddObjectPackageAndMethod",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,
ia,Ca,w,ma,ua,ha;return regeneratorRuntime.wrap(function(ra){for(;;)switch(ra.prev=ra.next){case 0:return ma=Ta.LoadingIndicator.open("Lookup Package..."),ua=this.view.getWindow(),ra.prev=2,ra.next=5,this.withContextDo(function(mb){var E=Ta.ObjectPackage.lookupPackageForObject(mb.target);return{objPkgName:E&&E.id,className:Ta.getClassName(mb.target),stringifiedTarget:mb.target.toString()}});case 5:Ta.__inter4__=ra.sent;Ea=Ta.__inter4__.objPkgName;ia=Ta.__inter4__.className;w=Ta.__inter4__.stringifiedTarget;
if(Ea){ra.next=35;break}ma.remove();ra.next=13;return this.withContextDo(function(){var mb=Ta.ObjectPackage.lookupPackageForObject($world);if(mb)return mb.name});case 13:ha=ra.sent;if(!ha){ra.next=25;break}ra.next=17;return this.world().prompt(["New Class\n",{},"Regarding the object:\n",{fontSize:16,fontWeight:"normal"},w,{fontSize:16,fontStyle:"italic",fontWeight:"normal"},"\nEnter a name for the new class of this object:",{fontSize:16,fontWeight:"normal"}],{historyId:"object-package-name-hist",
requester:ua,width:400,input:Ta.string.capitalize(ia).replace(/\s+(.)/g,function(mb,E){return E.toUpperCase()})});case 17:if(ia=ra.sent){ra.next=21;break}ua.setStatusMessage("Canceled");return ra.abrupt("return");case 21:return ra.next=23,this.withContextDo(function(){var mb=Xa(regeneratorRuntime.mark(function Ya(R){var gb,$b,Sc;return regeneratorRuntime.wrap(function(Ic){for(;;)switch(Ic.prev=Ic.next){case 0:return gb=Ta.ObjectPackage.withId(ha),$b=ia[0].toLowerCase()+ia.slice(1)+".js",Ic.next=4,
gb.ensureSubModule($b);case 4:return Sc=Ic.sent,Ic.next=7,Sc.adoptObject(R.target,ia);case 7:case "end":return Ic.stop()}},Ya)}));return function(R){return mb.apply(this,arguments)}}(),{className:ia,worldPkgUrl:ha});case 23:ra.next=35;break;case 25:return ra.next=27,this.world().prompt(["New Object Package\n",{},"No object package exists yet for object\n",{fontSize:16,fontWeight:"normal"},w,{fontSize:16,fontStyle:"italic",fontWeight:"normal"},"\nEnter a name for a new package:",{fontSize:16,fontWeight:"normal"}],
{historyId:"object-package-name-hist",requester:ua,width:400,input:Ta.string.capitalize(ia).replace(/\s+(.)/g,function(mb,E){return E.toUpperCase()})});case 27:if(Ea=ra.sent){ra.next=31;break}ua.setStatusMessage("Canceled");return ra.abrupt("return");case 31:return ma.label="Creating Class...",ma.openInWorld(),ra.next=35,this.withContextDo(function(){var mb=Xa(regeneratorRuntime.mark(function Ya(R){var gb;return regeneratorRuntime.wrap(function($b){for(;;)switch($b.prev=$b.next){case 0:return gb=
Ta.ObjectPackage.withId(Ea),$b.next=3,gb.adoptObject(R.target);case 3:case "end":return $b.stop()}},Ya)}));return function(R){return mb.apply(this,arguments)}}(),{objPkgName:Ea});case 35:return ma.label="Adding method...",ra.next=38,this.withContextDo(function(){var mb=Xa(regeneratorRuntime.mark(function Ya(R){var gb,$b;return regeneratorRuntime.wrap(function(Sc){for(;;)switch(Sc.prev=Sc.next){case 0:return Sc.next=2,R.addNewMethod();case 2:return gb=Sc.sent,$b=gb.methodName,Sc.abrupt("return",{methodName:$b,
className:R.target.constructor[Symbol["for"]("__LivelyClassName__")]});case 5:case "end":return Sc.stop()}},Ya)}));return function(R){return mb.apply(this,arguments)}}());case 38:return Ta.__inter5__=ra.sent,ia=Ta.__inter5__.className,Ca=Ta.__inter5__.methodName,ma.remove(),ra.next=44,this.refresh();case 44:return ra.next=46,this.selectMethod(ia,Ca,!0,!0);case 46:this.ui.sourceEditor.focus();ra.next=53;break;case 49:ra.prev=49,ra.t0=ra["catch"](2),ma.remove(),ua.showError(ra.t0);case 53:case "end":return ra.stop()}},
wa,this,[[2,49]])}));return function(){return P.apply(this,arguments)}}()},{key:"interactivelyRemoveMethodOrClass",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.withContextDo(function(ma){return{selectedMethod:Ta.Path("selectedMethod.name").get(ma),selectedClass:Ta.Path("selectedClass.name").get(ma)}});case 2:Ea=w.sent;ia=Ea.selectedMethod;Ca=Ea.selectedClass;if(!ia){w.next=
7;break}return w.abrupt("return",this.interactivelyRemoveMethod());case 7:if(!Ca){w.next=9;break}return w.abrupt("return",this.interactivelyAdoptBySuperclass());case 9:case "end":return w.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"interactivelyAdoptByClass",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma;return regeneratorRuntime.wrap(function(ua){for(;;)switch(ua.prev=ua.next){case 0:return Ea=Ta.LoadingIndicator.open("fetching modules..."),
ua.next=3,this.withContextDo(function(){var ha=Xa(regeneratorRuntime.mark(function E(mb){var R,Ya,gb,$b,Sc,Ic,Pd,Zd,ge;return regeneratorRuntime.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return R=mb.evalEnvironment.systemInterface,Ce.next=3,R.getModules();case 3:return Ya=Ce.sent,Ce.next=6,Dd.import("./index-616023be.js").then(function($e){return $e.a});case 6:gb=Ce.sent,$b=gb.module,Sc=[],Ic=da(Ya),Ce.prev=10,Zd=regeneratorRuntime.mark(function pf(){var ig,Xf,Vg,Re,ae,Sb,Hd,hf,zf,Gg,
vg,tg;return regeneratorRuntime.wrap(function(pd){for(;;)switch(pd.prev=pd.next){case 0:ig=Pd.value;if(!ig.name.endsWith(".md")){pd.next=3;break}return pd.abrupt("return","continue");case 3:return pd.next=5,R.getPackageForModule(ig.name);case 5:Vg=(Xf=pd.sent)?Xf.name+"/"+R.shortModuleName(ig.name,Xf):ig.name;Re=$b(ig.name);if("esm"===Re.format()||"register"===Re.format()){pd.next=10;break}return pd.abrupt("return","continue");case 10:return pd.next=12,Re.imports();case 12:pd.t0=function(Z){return Z.local};
ae=pd.sent.map(pd.t0);if(!mb.target.isMorph){pd.next=20;break}pd.next=17;return Dd.import("./__rootModule___commonjs-entry-51a55f66.js").then(function(Z){return Z.cj});case 17:pd.t1=pd.sent;pd.next=21;break;case 20:pd.t1={};case 21:return Sb=pd.t1,Hd=Sb.Morph,pd.next=25,Re.scope();case 25:pd.t2=function(Z){return Z.id.name};hf=pd.sent.classDecls.map(pd.t2);zf=Ta.obj.values(Re.recorder).filter(function(Z){return Ta.isClass(Z)&&!ae.includes(Z.name)&&hf.includes(Z.name)&&(mb.target.isMorph?Ta.withSuperclasses(Z).includes(Hd):
!0)});Gg=da(zf);try{for(Gg.s();!(vg=Gg.n()).done;)tg=vg.value,Sc.push({isListItem:!0,string:"".concat(Vg," ").concat(tg.name),value:{moduleName:ig.name,className:tg.name}})}catch(Z){Gg.e(Z)}finally{Gg.f()}case 30:case "end":return pd.stop()}},pf)}),Ic.s();case 13:if((Pd=Ic.n()).done){Ce.next=20;break}return Ce.delegateYield(Zd(),"t0",15);case 15:ge=Ce.t0;if("continue"!==ge){Ce.next=18;break}return Ce.abrupt("continue",18);case 18:Ce.next=13;break;case 20:Ce.next=25;break;case 22:Ce.prev=22,Ce.t1=
Ce["catch"](10),Ic.e(Ce.t1);case 25:return Ce.prev=25,Ic.f(),Ce.finish(25);case 28:return Ce.abrupt("return",Sc);case 29:case "end":return Ce.stop()}},E,null,[[10,22,25,28]])}));return function(mb){return ha.apply(this,arguments)}}());case 3:return ia=ua.sent,Ea.remove(),ua.next=7,$world.filterableListPrompt("From which class should the target object inherit?",ia,{requester:this.view});case 7:Ca=ua.sent;w=Ib(Ca.selected,1);if(ma=w[0]){ua.next=12;break}return ua.abrupt("return");case 12:return ua.next=
14,this.withContextDo(function(ha){var ra=ma.className;ra=Ta.modules.module(ma.moduleName).recorder[ra];Ta.adoptObject(ha.target,ra)},{klassAndModule:ma});case 14:this.refresh(),this.selectClass(ma.className);case 16:case "end":return ua.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"interactivelyAdoptBySuperclass",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma,ua,ha,ra,mb,E;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=
R.next){case 0:return R.next=2,this.withContextDo(function(Ya){Ya=Ya.target;var gb=Ya.constructor;if(gb===Ta.Morph)return{};var $b=Ta.withSuperclasses(gb)[1];return{moduleMeta:gb[Symbol["for"]("lively-module-meta")],nextModuleMeta:$b[Symbol["for"]("lively-module-meta")],nextClassName:$b.name,className:gb.name,targetName:Ya.name}});case 2:Ea=R.sent;ia=Ea.nextClassName;Ca=Ea.className;w=Ea.targetName;ma=Ea.moduleMeta;ua=Ea.nextModuleMeta;ha=function(Ya,gb){return{textDecoration:"underline",doit:{code:'$world.execCommand("open browser", {moduleName: "'.concat(Ya["package"].name+
"/"+Ya.pathInPackage,'", codeEntity: "').concat(gb,'"})')}}};if(!ia){R.next=21;break}ra={fontWeight:"normal",fontSize:16};mb={fontWeight:"normal",fontStyle:"italic",fontSize:16};R.next=14;return this.world().confirm(["Class Hierarchy Change\n",{},"Do you really want to make ",ra,'"'.concat(w,'"'),mb," an instance of ",ra,ia,Object.assign({},mb,{},ha(ua,ia))," and remove class ",ra,Ca,Object.assign({},mb,{},ha(ma,Ca))," and its package ",ra,ma["package"].name,mb," ?",ra],{requester:this.view,width:500});
case 14:if(E=R.sent){R.next=17;break}return R.abrupt("return");case 17:return R.next=19,this.withContextDo(function(Ya){Ta.adoptObject(Ya.target,Ta.withSuperclasses(Ya.target.constructor)[1])});case 19:this.refresh(),this.selectClass(ia);case 21:case "end":return R.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"interactivelyRemoveMethod",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma,ua,ha;return regeneratorRuntime.wrap(function(ra){for(;;)switch(ra.prev=
ra.next){case 0:return ra.next=2,this.withContextDo(function(mb){return!mb.selectedMethod});case 2:if(!ra.sent){ra.next=4;break}return ra.abrupt("return");case 4:return Ea=this.editorPlugin.parse().body[0],ra.next=7,this.withContextDo(function(){var mb=Xa(regeneratorRuntime.mark(function Ya(R){var gb,$b;return regeneratorRuntime.wrap(function(Sc){for(;;)switch(Sc.prev=Sc.next){case 0:return gb=R.selectedMethod,$b=R.selectedClass,Sc.t0=gb.name,Sc.next=4,R._sourceDescriptor_of_class_findMethodNode($b,
gb.name,gb.kind,gb["static"],Ea);case 4:return Sc.t1=Sc.sent,Sc.abrupt("return",{selectedMethodName:Sc.t0,methodNode:Sc.t1});case 6:case "end":return Sc.stop()}},Ya)}));return function(R){return mb.apply(this,arguments)}}(),{parsed:Ea});case 7:ia=ra.sent;Ca=ia.methodNode;if(w=ia.selectedMethodName){ra.next=12;break}return ra.abrupt("return");case 12:if(Ca){ra.next=15;break}this.view.showError("Cannot find AST node for method ".concat(w));return ra.abrupt("return");case 15:return ra.next=17,this.world().confirm("Really remove method ".concat(w,
"?"));case 17:if(ma=ra.sent){ra.next=20;break}return ra.abrupt("return");case 20:return ua=this.ui.sourceEditor,ha={start:ua.indexToPosition(Ca.start),end:ua.indexToPosition(Ca.end)},ua.textInRange({start:{column:0,row:ha.start.row},end:ha.start}).trim()||(ha.start=ua.lineRange(ha.start.row-1).end),ua.replace(ha,""),ra.next=26,this.doSave();case 26:case "end":return ra.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"interactivelyForkPackage",value:function(){var P=
Xa(regeneratorRuntime.mark(function wa(){var Ea,ia;return regeneratorRuntime.wrap(function(Ca){for(;;)switch(Ca.prev=Ca.next){case 0:return Ca.t0=this.world(),Ca.t1=["New Forked Package\n",{},"Please enter a name for the forked class and its package:",{fontSize:16,fontWeight:"normal"}],Ca.t2=this.view,Ca.next=5,this.withContextDo(function(w){return w.target.constructor[Symbol["for"]("__LivelyClassName__")]});case 5:return Ca.t3=Ca.sent,Ca.t4=Ca.t3+"Fork",Ca.t5={requester:Ca.t2,input:Ca.t4,historyId:"lively.morphic-object-editor-fork-names",
useLastInput:!1},Ca.next=10,Ca.t0.prompt.call(Ca.t0,Ca.t1,Ca.t5);case 10:if(Ea=Ca.sent){Ca.next=13;break}return Ca.abrupt("return");case 13:return Ca.next=15,this.withContextDo(function(){var w=Xa(regeneratorRuntime.mark(function ha(ua){return regeneratorRuntime.wrap(function(ra){for(;;)switch(ra.prev=ra.next){case 0:return ra.next=2,ua.forkPackage(Ea);case 2:case "end":return ra.stop()}},ha)}));return function(ua){return w.apply(this,arguments)}}(),{forkedName:Ea});case 15:return ia=Ca.sent,Ca.next=
18,this.browse({target:this.context.target,selectedClass:ia});case 18:case "end":return Ca.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"interactivlyFixUndeclaredVariables",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea=this,ia,Ca,w,ma,ua,ha;return regeneratorRuntime.wrap(function(ra){for(;;)switch(ra.prev=ra.next){case 0:return ma=this.ui,ua=ma.sourceEditor,ha=ma.importController,ra.prev=1,ra.next=4,this.withContextDo(function(mb){return mb.selectedClass&&
mb.selectedClass.name});case 4:if(ra.sent){ra.next=7;break}this.view.showError(Error("No class selected"));return ra.abrupt("return",null);case 7:return w=ua.textString,ra.next=10,this.withContextDo(function(mb){var E=mb.sourceDescriptorFor(mb.selectedClass),R=E.module;E=E.moduleSource;mb.isSaving=!0;return{moduleId:R.id,origSource:E}});case 10:return Ta.__inter6__=ra.sent,ia=Ta.__inter6__.moduleId,Ca=Ta.__inter6__.origSource,ra.next=15,Ta.interactivlyFixUndeclaredVariables(ua,{requester:ua,sourceUpdater:function(){var mb=
Xa(regeneratorRuntime.mark(function gb(R,Ya){return regeneratorRuntime.wrap(function($b){for(;;)switch($b.prev=$b.next){case 0:return $b.next=2,Ea.withContextDo(function(){var Sc=Xa(regeneratorRuntime.mark(function Zd(Pd){var ge,Ce;return regeneratorRuntime.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:ge=Pd.sourceDescriptorFor(Pd.selectedClass);Ce=ge.module;if("import"!==R){$e.next=7;break}$e.next=5;return Ce.addImports(Ya);case 5:$e.next=13;break;case 7:if("global"!==R){$e.next=12;break}$e.next=
10;return Ce.addGlobalDeclaration(Ya);case 10:$e.next=13;break;case 12:throw Error("Cannot handle fixUndeclaredVar type ".concat(R));case 13:ge.resetIfChanged();case 14:case "end":return $e.stop()}},Zd)}));return function(Pd){return Sc.apply(this,arguments)}}(),{type:R,arg:Ya});case 2:return $b.next=4,ha.updateImports();case 4:return $b.next=6,Ea.updateKnownGlobals();case 6:case "end":return $b.stop()}},gb)}));return function(R,Ya){return mb.apply(this,arguments)}}(),sourceRetriever:function(){var mb=
Xa(regeneratorRuntime.mark(function R(){return regeneratorRuntime.wrap(function(Ya){for(;;)switch(Ya.prev=Ya.next){case 0:return Ya.abrupt("return",Ea.withContextDo(function(gb){return gb.sourceDescriptorFor(gb.selectedClass)._modifiedSource(w).moduleSource},{content:ua.textString}));case 1:case "end":return Ya.stop()}},R)}));return function(){return mb.apply(this,arguments)}}(),highlightUndeclared:function(){var mb=Xa(regeneratorRuntime.mark(function Ya(R){var gb,$b,Sc,Ic,Pd,Zd;return regeneratorRuntime.wrap(function(ge){for(;;)switch(ge.prev=
ge.next){case 0:return gb=R.start,$b=R.end,ge.next=3,Ea.withContextDo(function(Ce){Ce=Ce.sourceDescriptorFor(Ce.selectedClass).sourceLocation;return{classStart:Ce.start,classEnd:Ce.end}});case 3:Sc=ge.sent;Ic=Sc.classStart;Pd=Sc.classEnd;if(!(gb<Ic||$b>Pd)){ge.next=8;break}return ge.abrupt("return");case 8:gb-=Ic,$b-=Ic,Zd={start:ua.indexToPosition(gb),end:ua.indexToPosition($b)},ua.selection=Zd,ua.centerRange(Zd);case 13:case "end":return ge.stop()}},Ya)}));return function(R){return mb.apply(this,
arguments)}}()});case 15:return ra.abrupt("return",ra.sent);case 18:return ra.prev=18,ra.t0=ra["catch"](1),ra.next=22,this.withContextDo(Xa(regeneratorRuntime.mark(function E(){return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:R.t0=Ca;if(!R.t0){R.next=5;break}R.next=4;return Ta.modules.module(ia).changeSource(Ca);case 4:R.t0=R.sent;case 5:return R.abrupt("return",R.t0);case 6:case "end":return R.stop()}},E)})),{moduleId:ia,origSource:Ca});case 22:return this.view.showError(ra.t0),
ra.abrupt("return",null);case 24:return ra.prev=24,ra.next=27,this.withContextDo(function(E){return E.isSaving=!1});case 27:return ra.next=29,ha.updateImports();case 29:return ra.next=31,this.updateKnownGlobals();case 31:return ua.focus(),ra.finish(24);case 33:case "end":return ra.stop()}},wa,this,[[1,18,24,33]])}));return function(){return P.apply(this,arguments)}}()},{key:"interactivelyRunSelectedMethod",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea=this,ia,Ca,w,ma=arguments;
return regeneratorRuntime.wrap(function(ua){for(;;)switch(ua.prev=ua.next){case 0:return ia=0<ma.length&&void 0!==ma[0]?ma[0]:{},ua.next=3,this.withContextDo(function(){var ha=Xa(regeneratorRuntime.mark(function E(mb){var R,Ya,gb;return regeneratorRuntime.wrap(function($b){for(;;)switch($b.prev=$b.next){case 0:if(R=mb.selectedMethod){$b.next=3;break}return $b.abrupt("return",{statusMessage:"no message selected"});case 3:if("function"===typeof mb.target[R.name]){$b.next=5;break}return $b.abrupt("return",
{statusMessage:"".concat(R.name," is not a method of ").concat(Ea.target)});case 5:return $b.prev=5,$b.next=8,mb.target[R.name]();case 8:return Ya=$b.sent,gb="Running ".concat(R.name),"undefined"!==typeof Ya&&(gb+=", returns ".concat(Ya)),$b.abrupt("return",{statusMessage:gb});case 14:return $b.prev=14,$b.t0=$b["catch"](5),$b.abrupt("return",{statusMessage:$b.t0.toString()});case 17:case "end":return $b.stop()}},E,null,[[5,14]])}));return function(mb){return ha.apply(this,arguments)}}());case 3:Ca=
ua.sent,(w=Ca.statusMessage)&&!ia.silent&&this.view.setStatusMessage(w);case 6:case "end":return ua.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ObjectEditorModel"}},{key:"properties",get:function(){return{context:{},editorPlugin:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){var P=this.ui.sourceEditor,pa=P.pluginFind(function(wa){return wa.isEditorPlugin});pa||(pa=P.addPlugin(new Ta.JavaScriptEditorPlugin(Ta.config.codeEditor.defaultTheme)));
return pa}},target:{get:function(){return this.context.target}},isObjectEditor:{readOnly:!0,get:function(){return!0}},systemInterface:{readOnly:!0,get:function(){return this.editorPlugin.evalEnvironment.systemInterface}},expose:{get:function(){return["browse","commands","keybindings","onWindowClose"]}},bindings:{get:function(){return[{model:"inspect object button",signal:"fire",handler:"execCommand",converter:function(){return"open object inspector for target"}},{model:"publish button",signal:"fire",
handler:"execCommand",converter:function(){return"freeze target"}},{model:"choose target button",signal:"fire",handler:"execCommand",converter:function(){return"choose target"}},{model:"add button",signal:"fire",handler:"interactivelyAddObjectPackageAndMethod"},{model:"remove button",signal:"fire",handler:"execCommand",converter:function(){return"remove method or class"}},{model:"fork package button",signal:"fire",handler:"interactivelyForkPackage"},{model:"open in browser button",signal:"fire",handler:"execCommand",
updater:function(P){P("open class in system browser",{klass:this.targetObj.selectedClass})}},{model:"save button",signal:"fire",handler:"execCommand",converter:function(){return"save source"}},{model:"run method button",signal:"fire",handler:"execCommand",converter:function(){return"run selected method"}},{model:"toggle imports button",signal:"fire",handler:"toggleShowingImports"},{target:"source editor",signal:"textChange",handler:"updateUnsavedChangeIndicatorDebounced"},{target:"class tree",signal:"selectedNode",
handler:"onClassTreeSelection"},{target:"class tree",signal:"contextMenuRequested",handler:"contextMenuForClassTree"}]}}}}}],Yb,{pathInPackage:function(){return"./js/objecteditor/index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1763,end:64483})}(Ta.ViewModel);Ta.ObjectEditorModel=bh;Ta.ObjectEditorModel=bh;Uf=function(cb){var Yb=
window.lively.FreezerRuntime.recorderFor("lively.ide/js/objecteditor/index.js"),de=Yb.hasOwnProperty("ImportControllerModel")&&"function"===typeof Yb.ImportControllerModel?Yb.ImportControllerModel:Yb.ImportControllerModel=function(P){if(!P||!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Cb(de,cb,[{key:"getExpandedWidth",value:function(){return Math.min(400,Math.max(300,this.ui.importsList.listItemContainer.width))}},
{key:"openModuleInBrowser",value:function(){this.view.execCommand("open selected module in system browser")}},{key:"setModule",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return this.module=wa,ia.next=3,this.updateImports();case 3:case "end":return ia.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"doNewNPMSearch",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia,
Ca,w;return regeneratorRuntime.wrap(function(ma){for(;;)switch(ma.prev=ma.next){case 0:return ia=Ta.LoadingIndicator.open("fetching information..."),ia.center=this.view.owner.globalBounds().center(),Ca="https://registry.npmjs.com/-/v1/search?text=".concat(wa,"&size=50"),ma.next=5,Ta.resource(Ca).makeProxied().readJson();case 5:return w=ma.sent,ia.remove(),ma.abrupt("return",w.objects.map(function(ua){var ha=ua["package"],ra=ha.version;return{isListItem:!0,string:"".concat(ha.name,"@").concat(ra),
value:ua}}));case 8:case "end":return ma.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"updateImports",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia;return regeneratorRuntime.wrap(function(Ca){for(;;)switch(Ca.prev=Ca.next){case 0:return Ea=this.ui.importsList,Ca.next=3,this.editor.withContextDo(function(){var w=Xa(regeneratorRuntime.mark(function ha(ua){var ra,mb,E;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=
2,ua.selectedModule;case 2:if(ra=R.sent){R.next=5;break}return R.abrupt("return",[]);case 5:return R.next=7,ra.imports();case 7:return mb=R.sent,E=mb.map(function(Ya){var gb=[],$b=Ya.local!==Ya.imported&&"default"!==Ya.imported?Ya.local:null;$b&&gb.push("".concat(Ya.imported," as "),{});gb.push($b||Ya.local||"??????",{fontWeight:"bold"});gb.push(" from ".concat(Ta.string.truncate(Ya.fromModule,25,"...")),{opacity:.5});$b=gb.slice();$b[2]=" from ".concat(Ya.fromModule);$b[3]={};return{isListItem:!0,
value:Ya,label:gb,tooltip:$b,annotation:Ya.fromModule.includes("jspm.dev")?Ta.Icon.textAttribute("npm",{fontSize:18,fontWeight:"400",textStyleClasses:["fab"]}):[]}}),R.abrupt("return",E);case 10:case "end":return R.stop()}},ha)}));return function(ua){return w.apply(this,arguments)}}());case 3:ia=Ca.sent,Ea.items=[],Ea.items=ia;case 6:case "end":return Ca.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"keybindings",get:function(){return[{keys:"Enter",command:"open selected module in system browser"}]}},
{key:"commands",get:function(){var P=this;return[{name:"open selected module in system browser",exec:function(){var pa=Xa(regeneratorRuntime.mark(function ia(Ea){var Ca,w,ma,ua,ha;return regeneratorRuntime.wrap(function(ra){for(;;)switch(ra.prev=ra.next){case 0:Ca=P.view.getWindow();if(w=P.ui.importsList.selection){ra.next=5;break}Ca.setStatusMessage("no module selected");return ra.abrupt("return",null);case 5:return ma=w||{},ua=ma.fromModule,ha=ma.local,ua.startsWith(".")&&(ua=System.decanonicalize(ua,
P.module)),ra.abrupt("return",P.world().execCommand("open browser",{moduleName:ua,codeEntity:ha}));case 8:case "end":return ra.stop()}},ia)}));return function(Ea){return pa.apply(this,arguments)}}()}]}},{key:"refreshInterface",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){return regeneratorRuntime.wrap(function(Ea){for(;;)switch(Ea.prev=Ea.next){case 0:return Ea.next=2,this.updateImports();case 2:return Ea.next=4,this.editor.updateKnownGlobals();case 4:this.editor.ui.sourceEditor.focus();
case 5:case "end":return Ea.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"interactivelyAddImport",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea=this,ia,Ca,w,ma,ua,ha,ra,mb,E,R,Ya,gb,$b,Sc;return regeneratorRuntime.wrap(function(Ic){for(;;)switch(Ic.prev=Ic.next){case 0:return Ca=this.editor,w=this.view.getWindow(),Ic.prev=2,Ic.next=5,Ca.withContextDo(function(Pd){return!Pd.selectedClass});case 5:if(!Ic.sent){Ic.next=8;break}w.showError(Error("No class selected"));
return Ic.abrupt("return");case 8:return Ic.next=10,this.world().multipleChoicePrompt("Select import style:",{requester:w,width:400,choices:new Map([["An already loaded module (via exports)","system"],["A NPM Module via jspm.dev","jspm"],["A custom module (via free text)","free text"]])});case 10:ma=Ic.sent;if(void 0!==ma){Ic.next=13;break}return Ic.abrupt("return");case 13:ua='import ... from "module";';if("jspm"!==ma){Ic.next=25;break}Ic.next=17;return this.world().filterableListPrompt("Browse NPM",
[],{requester:w,onFilter:Ta.fun.debounce(500,function(){var Pd=Xa(regeneratorRuntime.mark(function Ce(ge){var $e;return regeneratorRuntime.wrap(function(pf){for(;;)switch(pf.prev=pf.next){case 0:$e=ge.target.owner;if($e._lastTerm!==$e.input){pf.next=3;break}return pf.abrupt("return");case 3:return $e._lastTerm=$e.input,pf.next=6,Ea.doNewNPMSearch($e.input);case 6:$e.items=pf.sent;case 7:case "end":return pf.stop()}},Ce)}));return function(ge){return Pd.apply(this,arguments)}}()),fuzzy:!0});case 17:ha=
Ic.sent;if("accepted"===ha.status){Ic.next=20;break}return Ic.abrupt("return");case 20:ra=Ib(ha.selected,1),ha=ra[0],mb=ha["package"],E=mb.version,R=mb.name,ua='import ... from "https://jspm.dev/'.concat(R,"@").concat(E,'";'),ma="free text";case 25:if("free text"!==ma){Ic.next=46;break}case 26:return Ic.next=29,this.world().editPrompt("Enter import statement:",{requester:w,input:ua,mode:"js"});case 29:if(ua=Ic.sent){Ic.next=32;break}return Ic.abrupt("return");case 32:Ic.prev=32;Ta.parse(ua);Ic.next=
40;break;case 36:return Ic.prev=36,Ic.t0=Ic["catch"](32),w.setStatusMessage(Ic.t0.message),Ic.abrupt("continue",26);case 40:return Ic.abrupt("break",43);case 43:return Ic.next=45,Ca.withContextDo(function(){var Pd=Xa(regeneratorRuntime.mark(function Ce(ge){var $e;return regeneratorRuntime.wrap(function(pf){for(;;)switch(pf.prev=pf.next){case 0:return pf.next=2,ge.selectedModule.source();case 2:return $e=pf.sent,ge.isSaving=!0,pf.next=6,ge.selectedModule.changeSource(ua+"\n"+$e);case 6:return pf.abrupt("return",
$e);case 7:case "end":return pf.stop()}},Ce)}));return function(ge){return Pd.apply(this,arguments)}}(),{importStmt:ua});case 45:ia=Ic.sent;case 46:if("system"!==ma){Ic.next=61;break}Ic.next=49;return Ca.editorPlugin.systemInterface();case 49:return Ya=Ic.sent,Ic.next=52,Ta.interactivelyChooseImports(Ya,{requester:w});case 52:if(gb=Ic.sent){Ic.next=55;break}return Ic.abrupt("return",null);case 55:return Ic.next=57,Ca.withContextDo(function(){var Pd=Xa(regeneratorRuntime.mark(function Ce(ge){var $e;
return regeneratorRuntime.wrap(function(pf){for(;;)switch(pf.prev=pf.next){case 0:return pf.next=2,ge.selectedModule.source();case 2:return $e=pf.sent,ge.isSaving=!0,pf.next=6,ge.selectedModule.addImports(gb);case 6:return pf.abrupt("return",$e);case 7:case "end":return pf.stop()}},Ce)}));return function(ge){return Pd.apply(this,arguments)}}(),{choices:gb});case 57:ia=Ic.sent,$b=gb.map(function(Pd){var Zd=Pd.local;Pd=Pd.exported;return"default"===Pd?Zd:Pd}).join("\n"),Sc=Ca.ui.sourceEditor,Sc.insertTextAndSelect($b,
Sc.cursorPosition);case 61:Ic.next=68;break;case 63:return Ic.prev=63,Ic.t1=Ic["catch"](2),Ic.next=67,Ca.withContextDo(function(){var Pd=Xa(regeneratorRuntime.mark(function Ce(ge){return regeneratorRuntime.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:$e.t0=ia;if(!$e.t0){$e.next=5;break}$e.next=4;return ge.selectedModule.changeSource(ia);case 4:$e.t0=$e.sent;case 5:return $e.abrupt("return",$e.t0);case 6:case "end":return $e.stop()}},Ce)}));return function(ge){return Pd.apply(this,arguments)}}(),
{origSource:ia});case 67:w.showError(Ic.t1);case 68:return Ic.prev=68,Ic.next=71,this.updateImports();case 71:return Ic.next=73,Ca.updateKnownGlobals();case 73:return Ic.next=75,Ca.withContextDo(function(){var Pd=Xa(regeneratorRuntime.mark(function Ce(ge){return regeneratorRuntime.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:ge.isSaving=!1;case 1:case "end":return $e.stop()}},Ce)}));return function(ge){return Pd.apply(this,arguments)}}());case 75:return Ic.finish(68);case 76:case "end":return Ic.stop()}},
wa,this,[[2,63,68,76],[32,36]])}));return function(){return P.apply(this,arguments)}}()},{key:"interactivelyRemoveImport",value:function(){var P=Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca,w,ma;return regeneratorRuntime.wrap(function(ua){for(;;)switch(ua.prev=ua.next){case 0:Ea=this.ui.importsList;ia=this.view.getWindow();if((Ca=Ea.selections)&&Ca.length){ua.next=5;break}return ua.abrupt("return");case 5:return ua.next=7,this.world().confirm(["Really remove these imports?\n",{},Ta.arr.pluck(Ca,
"local").join("\n"),{fontWeight:"normal",fontSize:16}],{requester:ia});case 7:if(w=ua.sent){ua.next=10;break}return ua.abrupt("return");case 10:return ua.next=12,this.editor.withContextDo(function(){var ha=Xa(regeneratorRuntime.mark(function E(mb){var R,Ya;return regeneratorRuntime.wrap(function(gb){for(;;)switch(gb.prev=gb.next){case 0:return gb.prev=0,R=mb.selectedModule,gb.next=4,R.source();case 4:return Ya=gb.sent,gb.next=7,R.removeImports(Ca);case 7:return gb.abrupt("return",!1);case 10:gb.prev=
10;gb.t0=gb["catch"](0);gb.t1=Ya;if(!gb.t1){gb.next=16;break}gb.next=16;return R.changeSource(Ya);case 16:return gb.abrupt("return",gb.t0);case 17:case "end":return gb.stop()}},E,null,[[0,10]])}));return function(mb){return ha.apply(this,arguments)}}(),{sels:Ca});case 12:ma=ua.sent,Ea.selection=null,ma&&ia.showError(ma),this.refreshInterface();case 16:case "end":return ua.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"interactivelyRemoveUnusedImports",value:function(){var P=
Xa(regeneratorRuntime.mark(function wa(){var Ea,ia,Ca;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.prev=0,Ea=this.view.getWindow(),w.next=4,this.editor.withContextDo(function(){var ma=Xa(regeneratorRuntime.mark(function ra(ha){return regeneratorRuntime.wrap(function(mb){for(;;)switch(mb.prev=mb.next){case 0:return mb.next=2,ha.selectedModule.source();case 2:return mb.abrupt("return",mb.sent);case 3:case "end":return mb.stop()}},ra)}));return function(ha){return ma.apply(this,
arguments)}}());case 4:return ia=w.sent,w.next=7,Ta.chooseUnusedImports(ia,{requester:Ea});case 7:if((Ca=w.sent)&&Ca.changes&&Ca.changes.length){w.next=11;break}Ea.setStatusMessage("Nothing to remove");return w.abrupt("return");case 11:return w.next=13,this.editor.withContextDo(function(ma){ma.selectedModule.removeImports(Ca.removedImports)},{toRemove:Ca});case 13:Ea.setStatusMessage("Imports removed");w.next=24;break;case 16:w.prev=16;w.t0=w["catch"](0);w.t1=origSource;if(!w.t1){w.next=22;break}w.next=
22;return this.editor.withContextDo(function(ma){return ma.selectedModule.changeSource(origSource)},{origSource});case 22:return requester.setStatusMessage(w.t0.toString()),w.abrupt("return");case 24:return w.next=26,this.updateImports();case 26:return w.next=28,this.editor.updateKnownGlobals();case 28:this.editor.ui.sourceEditor.focus();case 29:case "end":return w.stop()}},wa,this,[[0,16]])}));return function(){return P.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ImportControllerModel"}},
{key:"properties",get:function(){return{editor:{get:function(){return this.view.owner.viewModel}},systemInterface:{get:function(){return this.editor&&this.editor.systemInterface}},module:{set:function(P){this.setProperty("module",P?"string"===typeof P?P:P.id:null)}},expose:{get:function(){return"commands keybindings setModule updateImports doNewNPMSearch getExpandedWidth".split(" ")}},bindings:{get:function(){return[{model:"open button",signal:"fire",handler:"openModuleInBrowser"},{model:"add import button",
signal:"fire",handler:"interactivelyAddImport"},{model:"remove import button",signal:"fire",handler:"interactivelyRemoveImport"},{model:"cleanup button",signal:"fire",handler:"interactivelyRemoveUnusedImports"}]}}}}}],Yb,{pathInPackage:function(){return"./js/objecteditor/index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:64491,
end:75718})}(Ta.ViewModel);Ta.ImportControllerModel=Uf;Ta.ImportControllerModel=Uf;var th=function(cb){var Yb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/objecteditor/index.js"),de=Yb.hasOwnProperty("ImportController")&&"function"===typeof Yb.ImportController?Yb.ImportController:Yb.ImportController=function(P){if(!P||!P[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Cb(de,cb,[{key:Symbol["for"]("lively-instance-initialize"),
value:function(P){Cb._get(Object.getPrototypeOf(de.prototype),Symbol["for"]("lively-instance-initialize"),this).call(this,P);this.build();Ta.connect(this.get("openButton"),"fire",this,"execCommand",{converter:function(){return"open selected module in system browser"}})}},{key:"setModule",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return this.module=wa,ia.next=3,this.updateImports();case 3:case "end":return ia.stop()}},
Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"build",value:function(){var P={borderWidthTop:1,borderWidthBottom:1,borderColor:Ta.Color.gray,fontSize:14,fontFamily:"IBM Plex Sans",type:"list"},pa={type:"button",extent:Ta.pt(26,24)};this.submorphs=[Object.assign({},P,{name:"importsList",multiSelect:!0,borderBottom:{width:1,color:Ta.Color.gray}}),{name:"buttons",fill:Ta.Color.transparent,layout:new Ta.HorizontalLayout({direction:"centered",spacing:2,autoResize:!1}),submorphs:[Object.assign({},
pa,{name:"addImportButton",label:Ta.Icon.makeLabel("plus"),tooltip:"add new import"}),Object.assign({},pa,{name:"removeImportButton",label:Ta.Icon.makeLabel("minus"),tooltip:"remove selected import(s)"}),Object.assign({},pa,{name:"cleanupButton",label:"cleanup",tooltip:"remove unused imports"}),Object.assign({},pa,{name:"openButton",label:"open",tooltip:"open selected module"})]}];this.layout=new Ta.GridLayout({renderViaCSS:!0,grid:[["importsList"],["buttons"]]});this.layout.row(1).fixed=30;this.layout.row(1).col(0).group.resize=
!1;this.layout.row(1).col(0).group.align="center";this.layout.row(1).col(0).group.alignedProperty="center";this.applyLayoutIfNeeded();[this.get("openButton"),this.get("cleanupButton"),this.get("removeImportButton"),this.get("addImportButton")].forEach(function(wa){return wa.extent=pa.extent})}},{key:"doNewNPMSearch",value:function(){var P=Xa(regeneratorRuntime.mark(function Ea(wa){var ia,Ca,w;return regeneratorRuntime.wrap(function(ma){for(;;)switch(ma.prev=ma.next){case 0:return ia=Ta.LoadingIndicator.open("fetching information..."),
ia.center=this.owner.globalBounds().center(),Ca="https://registry.npmjs.com/-/v1/search?text=".concat(wa,"&size=50"),ma.next=5,Ta.resource(Ca).makeProxied().readJson();case 5:return w=ma.sent,ia.remove(),ma.abrupt("return",w.objects.map(function(ua){var ha=ua["package"],ra=ha.version;return{isListItem:!0,string:"".concat(ha.name,"@").concat(ra),value:ua}}));case 8:case "end":return ma.stop()}},Ea,this)}));return function(wa){return P.apply(this,arguments)}}()},{key:"updateImports",value:function(){var P=
Xa(regeneratorRuntime.mark(function wa(){var Ea;return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return ia.next=2,this.owner.withContextDo(function(){var Ca=Xa(regeneratorRuntime.mark(function ua(ma){var ha,ra,mb;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,ma.selectedModule;case 2:if(ha=E.sent){E.next=5;break}return E.abrupt("return",[]);case 5:return E.next=7,ha.imports();case 7:return ra=E.sent,mb=ra.map(function(R){var Ya=
[],gb=R.local!==R.imported&&"default"!==R.imported?R.local:null;gb&&Ya.push("".concat(R.imported," as "),{});Ya.push(gb||R.local||"??????",{fontWeight:"bold"});Ya.push(" from ".concat(Ta.string.truncate(R.fromModule,25,"...")),{opacity:.5});gb=Ya.slice();gb[2]=" from ".concat(R.fromModule);gb[3]={};return{isListItem:!0,value:R,label:Ya,tooltip:gb,annotation:R.fromModule.includes("jspm.dev")?Ta.Icon.textAttribute("npm",{fontSize:18,fontWeight:"400",textStyleClasses:["fab"]}):[]}}),E.abrupt("return",
mb);case 10:case "end":return E.stop()}},ua)}));return function(ma){return Ca.apply(this,arguments)}}());case 2:Ea=ia.sent,this.getSubmorphNamed("importsList").items=[],this.getSubmorphNamed("importsList").items=Ea;case 5:case "end":return ia.stop()}},wa,this)}));return function(){return P.apply(this,arguments)}}()},{key:"keybindings",get:function(){return[{keys:"Enter",command:"open selected module in system browser"}].concat(Cb._get(Object.getPrototypeOf(de.prototype),"keybindings",this))}},{key:"commands",
get:function(){var P=this;return[{name:"open selected module in system browser",exec:function(){var pa=Xa(regeneratorRuntime.mark(function ia(Ea){var Ca,w,ma,ua;return regeneratorRuntime.wrap(function(ha){for(;;)switch(ha.prev=ha.next){case 0:if(Ca=P.getSubmorphNamed("importsList").selection){ha.next=4;break}P.setStatusMessage("no module selected");return ha.abrupt("return",null);case 4:return w=Ca||{},ma=w.fromModule,ua=w.local,ma.startsWith(".")&&(ma=System.decanonicalize(ma,P.module)),ha.abrupt("return",
P.world().execCommand("open browser",{moduleName:ma,codeEntity:ua}));case 7:case "end":return ha.stop()}},ia)}));return function(Ea){return pa.apply(this,arguments)}}()}]}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ImportController"}},{key:"properties",get:function(){return{extent:{defaultValue:Ta.pt(300,600)},systemInterface:{get:function(){return this.owner.systemInterface}},module:{set:function(P){this.setProperty("module",P?"string"===typeof P?P:P.id:null)}}}}}],Yb,{pathInPackage:function(){return"./js/objecteditor/index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:75726,end:81639})}(Ta.Morph);Ta.ImportController=th;Ta.ImportController=th;var Be=window.lively.FreezerRuntime.recorderFor("lively.ide/js/objecteditor/ui.cp.js");Be.open=Vd;Be.component=Bb;Be.part=ba;Be.ObjectEditorModel=bh;Be.ImportControllerModel=Uf;Be.pt=ub;Be.rect=sc;Be.Color=Gb;Be.GridLayout=
va;Be.TilingLayout=dc;Be.Text=la;Be.Icon=Ne;Be.HorizontalLayout=Vb;Be.Tree=Ia;Be.ButtonDefault=Zc;Be.SystemButton=rd;Be.DefaultList=wf;Be.obj=jc;Be.ImportController=Be.component["for"](function(){return Be.component({defaultViewModel:Be.ImportControllerModel,name:"import controller",extent:Be.pt(209.5,472),fill:Be.Color.rgba(0,0,0,0),layout:new Be.GridLayout({autoAssign:!1,columns:[0,{width:200}],grid:[["imports list"],["buttons"]],groups:{buttons:{align:"topLeft",resize:!0},"imports list":{align:"topLeft",
resize:!0}},rows:[0,{height:442},1,{fixed:30}]}),submorphs:[Be.part(Be.DefaultList,{name:"imports list",borderColor:Be.Color.rgbHex("CCCCCC"),itemBorderRadius:2,borderWidth:{left:0,right:0,bottom:1,top:1}}),{name:"buttons",clipMode:"hidden",layout:new Be.TilingLayout({align:"center",axisAlign:"center",orderByIndex:!0,spacing:3,wrapSubmorphs:!1}),extent:Be.pt(199.1,29.3),fill:Be.Color.rgba(0,0,0,0),reactsToPointer:!1,submorphs:[Be.part(Be.SystemButton,{name:"add import button",extent:Be.pt(26,24),
submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("plus")}],tooltip:"add new import"}),Be.part(Be.SystemButton,{name:"remove import button",extent:Be.pt(26,24),submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("minus")}],tooltip:"remove selected import(s)"}),Be.part(Be.SystemButton,{name:"cleanup button",extent:Be.pt(53,24),submorphs:[{name:"label",fontSize:12,textAndAttributes:["cleanup",null]}],tooltip:"remove unused imports"}),Be.part(Be.SystemButton,{name:"open button",
extent:Be.pt(38,24),submorphs:[{name:"label",fontSize:12,textAndAttributes:["open",null]}],tooltip:"open module of selected import"})]}]})},{module:"lively.ide/js/objecteditor/ui.cp.js","export":"ImportController",range:{start:537,end:2582}},Be.ImportController);Be.ObjectEditorLight=Be.component["for"](function(){return Be.component({defaultViewModel:Be.ObjectEditorModel,name:"object editor light",extent:Be.pt(693.7,426.9),fill:Be.Color.transparent,reactsToPointer:!1,layout:new Be.GridLayout({autoAssign:!1,
columns:[0,{fixed:180},1,{width:243},2,{fixed:0}],grid:[["object commands","object commands","object commands"],["class tree","frozen warning","import controller"],["class tree","source editor","import controller"],["class and method controls","source editor controls","import controller"]],groups:{"class and method controls":{align:"topLeft",resize:!0},"class tree":{align:"topLeft",resize:!0},"frozen warning":{align:"topLeft",resize:!0},"import controller":{align:"topLeft",resize:!0},"object commands":{align:"topLeft",
resize:!0},"source editor":{align:"topLeft",resize:!0},"source editor controls":{align:"topLeft",resize:!0}},rows:[0,{fixed:28},1,{fixed:0},2,{height:125},3,{fixed:30}]}),submorphs:[{name:"object commands",extent:Be.pt(727,28),fill:Be.Color.transparent,layout:new Be.TilingLayout({orderByIndex:!0,resizePolicies:[["target controls",{height:"fixed",width:"fill"}]],wrapSubmorphs:!1}),reactsToPointer:!1,submorphs:[{name:"target controls",clipMode:"hidden",extent:Be.pt(181.3,30),fill:Be.Color.rgba(0,0,
0,0),layout:new Be.HorizontalLayout({align:"top",autoResize:!1,direction:"centered",orderByIndex:!0,padding:{height:0,width:0,x:2,y:2},reactToSubmorphAnimations:!1,renderViaCSS:!0,resizeSubmorphs:!1,spacing:2}),position:Be.pt(271.9,0),reactsToPointer:!1,submorphs:[Be.part(Be.SystemButton,{name:"inspect object button",extent:Be.pt(28,24),tooltip:"open object inspector",submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("cogs")}]}),Be.part(Be.SystemButton,{extent:Be.pt(28,24),name:"publish button",
tooltip:"Freeze this morph",submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("cloud-upload-alt")}]}),Be.part(Be.SystemButton,{name:"choose target button",extent:Be.pt(26,24),tooltip:"select another target",submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("crosshairs")}]})]},{name:"freezer controls",clipMode:"hidden",extent:Be.pt(35,28),fill:Be.Color.rgba(0,0,0,0),layout:new Be.HorizontalLayout({align:"top",autoResize:!1,direction:"rightToLeft",orderByIndex:!0,padding:{height:0,
width:0,x:2,y:2},reactToSubmorphAnimations:!1,renderViaCSS:!0,resizeSubmorphs:!1,spacing:2}),position:Be.pt(626,0),reactsToPointer:!1,submorphs:[Be.part(Be.SystemButton,{name:"show frozen parts button",extent:Be.pt(30,24),tooltip:"show published parts",submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("sellsy")}]})]}]},{name:"class and method controls",extent:Be.pt(180,30),fill:Be.Color.rgba(0,0,0,0),layout:new Be.HorizontalLayout({align:"top",autoResize:!1,direction:"centered",orderByIndex:!0,
padding:{height:0,width:0,x:2,y:2},reactToSubmorphAnimations:!1,renderViaCSS:!0,resizeSubmorphs:!1,spacing:2}),submorphs:[Be.part(Be.SystemButton,{name:"add button",extent:Be.pt(26,24),submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("plus")}],tooltip:"add a new method"}),Be.part(Be.SystemButton,{name:"remove button",extent:Be.pt(26,24),submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("minus")}],tooltip:"remove a method or class"}),Be.part(Be.SystemButton,{name:"fork package button",
extent:Be.pt(26,24),submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("code-branch")}],tooltip:"fork package"}),Be.part(Be.SystemButton,{name:"open in browser button",extent:Be.pt(26,24),submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("external-link-alt")}],tooltip:"open selected class in system browser"})]},{type:Be.Text,name:"source editor",borderColor:Be.Color.rgb(204,204,204),borderWidth:1,clipMode:"auto",extent:Be.pt(547,442),fixedHeight:!0,fixedWidth:!0,fontFamily:'"IBM Plex Mono"',
lineWrapping:"by-chars",padding:Be.rect(4,2,0,0)},{type:Be.Tree,name:"class tree",clipMode:"hidden",extent:Be.pt(180,442),fontFamily:'"IBM Plex Sans"',fontSize:14,borderColor:Be.Color.rgb(204,204,204),borderWidth:{top:1,bottom:1,left:0,right:0},treeData:{}},{name:"source editor controls",borderColor:{bottom:Be.Color.rgb(255,255,255),left:Be.Color.rgb(204,204,204),right:Be.Color.rgb(204,204,204),top:Be.Color.rgb(255,255,255)},borderWidth:{bottom:0,left:1,right:1,top:0},extent:Be.pt(547,30),fill:Be.Color.rgba(0,
0,0,0),layout:new Be.GridLayout({autoAssign:!1,columns:[0,{width:110},1,{fixed:30,paddingRight:1},2,{fixed:30,paddingLeft:1},3,{width:110},4,{fixed:74,paddingRight:4}],grid:[[null,"save button","run method button",null,"toggle imports button"]],groups:{"run method button":{align:"topLeft",resize:!0},"save button":{align:"topLeft",resize:!0},"toggle imports button":{align:"topLeft",resize:!0}},rows:[0,{height:30,paddingBottom:3,paddingTop:2}]}),submorphs:[Be.part(Be.SystemButton,{name:"save button",
extent:Be.pt(29,23),submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("save")}],tooltip:"save"}),Be.part(Be.SystemButton,{name:"run method button",extent:Be.pt(28,23),submorphs:[{name:"label",textAndAttributes:Be.Icon.textAttribute("play-circle")}],tooltip:"execute selected method"}),Be.part(Be.SystemButton,{name:"toggle imports button",extent:Be.pt(70,23),submorphs:[{name:"label",textAndAttributes:["imports",null]}],tooltip:"toggle showing imports"})]},Be.part(Be.ImportController,
{name:"import controller"})]})},{module:"lively.ide/js/objecteditor/ui.cp.js","export":"ObjectEditorLight",range:{start:2723,end:10581}},Be.ObjectEditorLight);bh=bd("ObjectEditorLight",Be.ObjectEditorLight);Uf=bd("ImportController",Be.ImportController);Be.ObjectEditorLight=bh;Be.ImportController=Uf;Be.open=Vd}}});
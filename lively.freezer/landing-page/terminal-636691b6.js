System.register("./__rootModule___commonjs-entry-51a55f66.js ./editor-plugin-5397d87c.js ./editor-modes-aae4d878.js ./mode-3092ef0b.js ./editor-plugin-2820dfc1.js ./ui.cp-499efc12.js ./loading-indicator.cp-98e470a2.js @babel/plugin-syntax-import-meta ./ui.cp-8dfc076f.js ./index-61952933.js ./tooltips.cp-3c41b378.js ./index-42118cd5.js ./interface-1a7f3c67.js ./index-616023be.js ./popups.cp-5b9fb681.js ./list.cp-840d1cf8.js ./index-81f98d16.js ./editor-plugin-80c3c4f5.js ./editor-plugin-0f29b6cf.js ./eval-backend-ui-b51e822c.js ./top-bar.cp-fa0cb96d.js ./canvas-2fd3d40b.js lively.collab ./messages.cp-817cc06d.js rollup @rollup/plugin-json ./helpers-94ca076d.js @rollup/plugin-commonjs rollup-plugin-polyfill-node ./user-ui-98206202.js ./object-classes-06d7e61a.js ./test-runner-15eee9f1.js ./linter-96a9a2d8.js".split(" "),function(bd){var Dd,
se,Rc,ad,Ne,Cb,Sd,ve,uc,dd,vd,Ed,fe,jc,Od,qb,ic,Wb,lc,db,Xa,Gb,sc,ub,sb,fa,Db,ab;return{setters:[function(eb){Dd=eb.s;se=eb.o;Rc=eb.i;ad=eb.K;Ne=eb._;Cb=eb.t;Sd=eb.aG;ve=eb.Y;uc=eb.m;dd=eb.b;vd=eb.a9;Ed=eb.C;fe=eb.d;jc=eb.v;Od=eb.at;qb=eb.M;ic=eb.W;Wb=eb.F;lc=eb.ad;db=eb.bT},function(eb){Xa=eb.CodeMirrorEnabledEditorPlugin;Gb=eb["default"];sc=eb.guessTextModeName},function(eb){ub=eb.defineMode;sb=eb.defineMIME},function(eb){fa=eb.S},function(eb){Db=eb["default"]},function(){},function(eb){ab=eb.D},
function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var eb=window.lively.FreezerRuntime.recorderFor("lively.ide/shell/completers.js");eb.arr=Dd;eb.runCommand=se;(function(zb){var rb=window.lively.FreezerRuntime.recorderFor("lively.ide/shell/completers.js"),
Ib=rb.hasOwnProperty("ShellCompleter")&&"function"===typeof rb.ShellCompleter?rb.ShellCompleter:rb.ShellCompleter=function(da){if(!da||!da[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Rc(Ib,zb,[{key:"buildCommand",value:function(da){var ka=da.match(/\$([^\s]*)$/i)||[];ka=ad(ka,2);ka[0];ka=ka[1];if("string"===typeof ka)return{command:'compgen -v -S "[variable]" '.concat(ka),prefix:ka};ka=da.match(/(^|;)\s*([^\s]*)$/i)||
[];ka=ad(ka,3);ka[0];ka[1];ka=ka[2];if("string"===typeof ka)return{command:'compgen -a -S "[alias]" '.concat(ka,'\n                        compgen -c -S "[command]" ').concat(ka,'\n                        compgen -b -S "[builtin]" ').concat(ka),prefix:ka};ka=eb.arr.last(da.split(/[\s;]/));return{prefix:ka,command:'compgen -f -S "[file]" '.concat(ka)}}},{key:"compute",value:function(){var da=Ne(regeneratorRuntime.mark(function Fa(va){var M,Aa,wb,Na,hb,Bb,ba,dc,la,Fb,vb;return regeneratorRuntime.wrap(function(Ia){for(;;)switch(Ia.prev=
Ia.next){case 0:M=va.pluginFind(function(xb){return xb.isShellEditorPlugin});Aa=va.cursorPosition;wb=Aa.row;Na=Aa.column;hb=va.getLine(wb).slice(0,Na);Bb="";if(M){Ia.next=6;break}return Ia.abrupt("return",[]);case 6:return ba=this.buildCommand(hb),dc=ba.command,hb=ba.prefix,Ia.prev=7,la=eb.runCommand(dc,{cwd:M.cwd}),Ia.next=11,la.whenDone();case 11:Bb=la.stdout;Ia.next=18;break;case 14:return Ia.prev=14,Ia.t0=Ia["catch"](7),console.warn("shell completer errored: ".concat(Ia.t0.stack||Ia.t0)),Ia.abrupt("return",
[]);case 18:return Fb={variable:300,file:400,builtin:400,command:500,alias:200},vb=Bb.split("\n").map(function(xb){xb=xb.match(/(.*)\[([^\]]+)\]$/)||[];var Rb=ad(xb,3);Rb[0];xb=Rb[1];Rb=Rb[2];return xb?{completion:xb,prefix:hb,info:Rb,priority:1500+(Fb[Rb]||0)}:null}).filter(Boolean),Ia.abrupt("return",vb);case 21:case "end":return Ia.stop()}},Fa,this,[[7,14]])}));return function(va){return da.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ShellCompleter"}}],
rb,{pathInPackage:function(){return"./shell/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:87,end:2022})})(void 0);var kc=[new eb.ShellCompleter];eb.shellCompleters=kc;eb.shellCompleters=kc;var Vb=window.lively.FreezerRuntime.recorderFor("lively.ide/shell/mode.js");Vb.defineMode=ub;Vb.defineMIME=sb;Vb.defineMode("shell",
function(){function zb(Fa,M){M=M.split(" ");for(var Aa=0;Aa<M.length;Aa++)ka[M[Aa]]=Fa}function rb(Fa,M){if(Fa.eatSpace())return null;var Aa=Fa.sol(),wb=Fa.next();if("\\"===wb)return Fa.next(),null;if("'"===wb||'"'===wb||"`"===wb)return M.tokens.unshift(Ib(wb,"`"===wb?"quote":"string")),da(Fa,M);if("#"===wb){if(Aa&&Fa.eat("!"))return Fa.skipToEnd(),"meta";Fa.skipToEnd();return"comment"}if("$"===wb)return M.tokens.unshift(va),da(Fa,M);if("+"===wb||"="===wb)return"operator";if("-"===wb)return Fa.eat("-"),
Fa.eatWhile(/\w/),"attribute";if(/\d/.test(wb)&&(Fa.eatWhile(/\d/),Fa.eol()||!/\w/.test(Fa.peek())))return"number";Fa.eatWhile(/[\w-]/);M=Fa.current();return"="===Fa.peek()&&/\w+/.test(M)?"def":ka.hasOwnProperty(M)?ka[M]:null}function Ib(Fa,M){var Aa="("==Fa?")":"{"==Fa?"}":Fa;return function(wb,Na){for(var hb,Bb=!1,ba=!1;null!=(hb=wb.next());){if(hb===Aa&&!ba){Bb=!0;break}if("$"===hb&&!ba&&"'"!==Fa){ba=!0;wb.backUp(1);Na.tokens.unshift(va);break}if(!ba&&hb===Fa&&Fa!==Aa)return Na.tokens.unshift(Ib(Fa,
M)),da(wb,Na);ba=!ba&&"\\"===hb}!Bb&&ba||Na.tokens.shift();return M}}function da(Fa,M){return(M.tokens[0]||rb)(Fa,M)}var ka={};zb("atom","true false");zb("keyword","if then do else elif while until for in esac fi fin fil done exit set unset export function");zb("builtin","ab awk bash beep cat cc cd chown chmod chroot clear cp curl cut diff echo find gawk gcc get git grep hg kill killall ln ls make mkdir openssl mv nc node npm ping ps restart rm rmdir sed service sh shopt shred source sort sleep ssh start stop su sudo svn tee telnet top touch vi vim wall wc wget who write yes zsh");
var va=function(Fa,M){1<M.tokens.length&&Fa.eat("$");var Aa=Fa.next();if(/['"({]/.test(Aa))return M.tokens[0]=Ib(Aa,"("==Aa?"quote":"{"==Aa?"def":"string"),da(Fa,M);/\d/.test(Aa)||Fa.eatWhile(/\w/);M.tokens.shift();return"def"};return{startState:function(){return{tokens:[]}},token:function(Fa,M){return da(Fa,M)},closeBrackets:"()[]{}''\"\"``",lineComment:"#",fold:"brace"}});Vb.defineMIME("text/x-sh","shell");var pb=window.lively.FreezerRuntime.recorderFor("lively.ide/shell/editor-plugin.js");pb.arr=
Dd;pb.string=Cb;pb.signal=Sd;pb.CodeMirrorEnabledEditorPlugin=Xa;pb.defaultDirectory=ve;pb.runCommand=se;pb.shellCompleters=kc;pb.Snippet=fa;pb.defaultDir=pb.defaultDir||void 0;Promise.resolve(pb.defaultDirectory()).then(function(zb){return pb.defaultDir=zb});kc=function(zb){var rb=window.lively.FreezerRuntime.recorderFor("lively.ide/shell/editor-plugin.js"),Ib=rb.hasOwnProperty("ShellEditorPlugin")&&"function"===typeof rb.ShellEditorPlugin?rb.ShellEditorPlugin:rb.ShellEditorPlugin=function(da){if(!da||
!da[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Rc(Ib,zb,[{key:Symbol["for"]("lively-instance-initialize"),value:function(){Rc._get(Object.getPrototypeOf(Ib.prototype),Symbol["for"]("lively-instance-initialize"),this).call(this);this.state={cwd:pb.defaultDir,command:null}}},{key:"isShellEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"shell"}},{key:"options",get:function(){return this.state}},
{key:"options",set:function(da){return this.state=Object.assign(this.state,da)}},{key:"cwd",get:function(){return this.state.cwd||pb.defaultDir||""}},{key:"cwd",set:function(da){this.state.cwd=da;pb.signal(this,"cwd",da)}},{key:"command",get:function(){return this.state.command}},{key:"command",set:function(da){this.state.command=da;pb.signal(this,"command",da)}},{key:"runCommand",value:function(da,ka){return this.command=pb.runCommand(da,Object.assign({cwd:this.cwd,owner:this.textMorph.id},ka))}},
{key:"changeCwdInteractively",value:function(){var da=Ne(regeneratorRuntime.mark(function va(){var Fa,M,Aa,wb,Na,hb,Bb,ba;return regeneratorRuntime.wrap(function(dc){for(;;)switch(dc.prev=dc.next){case 0:return M=this.cwd,Aa=pb.arr.uniq((Fa=[M]).concat.apply(Fa,[pb.defaultDir].concat(uc(this.knownCwds)))).filter(Boolean),dc.next=4,this.textMorph.world().editListPrompt("Choose working directory:",Aa,{requester:this.textMorph.getWindow(),historyId:"lively.morphic-ide/shell-changeCwdInteractively-hist-list",
preselect:Aa.indexOf(M)});case 4:dc.t0=dc.sent;if(dc.t0){dc.next=7;break}dc.t0={};case 7:wb=dc.t0;Na=wb.status;hb=wb.list;Bb=ad(wb.selections,1);ba=Bb[0];if("canceled"!==Na){dc.next=14;break}return dc.abrupt("return");case 14:this.knownCwds=hb;if(ba){dc.next=17;break}return dc.abrupt("return");case 17:this.textMorph.setStatusMessage(ba),this.cwd=ba,this.updateWindowTitle();case 20:case "end":return dc.stop()}},va,this)}));return function(){return da.apply(this,arguments)}}()},{key:"knownCwds",get:function(){if("undefined"===
typeof localStorage)return[];try{var da=localStorage.getItem("lively.morphic-ide/shell-known-cwds");return da?JSON.parse(da):[]}catch(ka){return[]}}},{key:"knownCwds",set:function(da){if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-ide/shell-known-cwds",JSON.stringify(da))}catch(ka){console.error(ka)}}},{key:"updateWindowTitle",value:function(){var da=this.textMorph.getWindow();if(da&&da.title.includes("Shell Workspace")){var ka=this.command&&this.command.isRunning()?
" (running ".concat(this.command.pid,")"):"",va=this.cwd?" - ".concat(pb.string.truncateLeft(this.cwd,35)):"";da.title=["Shell Workspace",ka,va].join("")}}},{key:"getCommands",value:function(da){var ka=this,va=this.textMorph;return[{name:"[shell] spawn command from selected text",exec:function(){var Fa=Ne(regeneratorRuntime.mark(function wb(Aa){var Na,hb,Bb,ba,dc=arguments;return regeneratorRuntime.wrap(function(la){for(;;)switch(la.prev=la.next){case 0:return Na=1<dc.length&&void 0!==dc[1]?dc[1]:
{printit:!1},hb=va.selection,hb.isEmpty()&&va.selectLine(hb.lead.row),Bb=ka.runCommand(hb.text,{}),hb.collapseToEnd(),Na.printit&&(ba=function(Fb){var vb=hb.start;hb.collapseToEnd();va.insertText(Fb);hb.range={start:vb,end:va.cursorPosition}},Bb.on("stdout",ba),Bb.on("stderr",ba)),ka.updateWindowTitle(),la.next=9,Bb.whenStarted();case 9:return ka.updateWindowTitle(),la.next=12,Bb.whenDone();case 12:return ka.updateWindowTitle(),Na.printit?(Bb.removeListener("stdout",ba),Bb.removeListener("stderr",
ba)):va.setStatusMessage(Bb.output.trim()),la.abrupt("return",!0);case 15:case "end":return la.stop()}},wb)}));return function(Aa){return Fa.apply(this,arguments)}}()},{name:"[shell] kill current command",exec:function(){var Fa=Ne(regeneratorRuntime.mark(function wb(Aa){var Na,hb,Bb=arguments;return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:Na=1<Bb.length&&void 0!==Bb[1]?Bb[1]:{signal:void 0};if(hb=ka.command){ba.next=5;break}va.setStatusMessage("No command running");
return ba.abrupt("return",!0);case 5:return va.setStatusMessage("Sending signal ".concat(Na.signal||"KILL"," to command ").concat(hb.pid)),ba.next=8,hb.kill(Na.signal);case 8:return ba.abrupt("return",!0);case 9:case "end":return ba.stop()}},wb)}));return function(Aa){return Fa.apply(this,arguments)}}()},{name:"[shell] change working directory",exec:function(){var Fa=Ne(regeneratorRuntime.mark(function Aa(){return regeneratorRuntime.wrap(function(wb){for(;;)switch(wb.prev=wb.next){case 0:return wb.next=
2,ka.changeCwdInteractively();case 2:return wb.abrupt("return",!0);case 3:case "end":return wb.stop()}},Aa)}));return function(){return Fa.apply(this,arguments)}}()}].concat(da)}},{key:"getKeyBindings",value:function(da){return da.concat([{keys:{mac:"Meta-D",win:"Alt-Enter"},command:{command:"[shell] spawn command from selected text",args:{printit:!1}}},{keys:{mac:"Meta-P",win:"Ctrl-Alt-Enter"},command:{command:"[shell] spawn command from selected text",args:{printit:!0}}},{keys:{mac:"Meta-Shift-L D I R",
win:"Ctrl-Shift-L D I R"},command:"[shell] change working directory"}])}},{key:"getSnippets",value:function(da){return da.concat([["findjs","find ${0:.} \\( -name ${1:excluded} \\) -prune -o -iname '*.js' -type f -print0 | xargs -0 grep -nH ${2:what}"]].map(function(ka){ka=ad(ka,2);return new pb.Snippet({trigger:ka[0],expansion:ka[1]})}))}},{key:"getCompleters",value:function(da){return da.concat(pb.shellCompleters)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ShellEditorPlugin"}}],
rb,{pathInPackage:function(){return"./shell/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:465,end:5892})}(pb.CodeMirrorEnabledEditorPlugin);pb["default"]=kc;var Nb=window.lively.FreezerRuntime.recorderFor("lively.ide/shell/terminal.js");Nb.pt=dd;Nb.Rectangle=vd;Nb.Color=Ed;Nb.connect=fe;Nb.arr=Dd;Nb.obj=jc;Nb.defaultDirectory=
ve;Nb.GridLayout=Od;Nb.Morph=qb;Nb.World=ic;Nb.config=Wb;Nb.InputLine=lc;Nb.ShellEditorPlugin=kc;Nb.DiffEditorPlugin=Db;Nb.EditorPlugin=Gb;Nb.guessTextModeName=sc;Nb.packagesOfSnapshot=db;Nb.DarkButton=ab;kc=bd("default",function(zb){var rb=window.lively.FreezerRuntime.recorderFor("lively.ide/shell/terminal.js"),Ib=rb.hasOwnProperty("Terminal")&&"function"===typeof rb.Terminal?rb.Terminal:rb.Terminal=function(da){if(!da||!da[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return Rc(Ib,zb,[{key:Symbol["for"]("lively-instance-initialize"),value:function(da){var ka=this;Rc._get(Object.getPrototypeOf(Ib.prototype),Symbol["for"]("lively-instance-initialize"),this).call(this,da);da.cwd||Promise.resolve(function(){return ka.cwd=Nb.defaultDirectory()})}},{key:"__additionally_serialize__",value:function(da,ka,va,Fa){Rc._get(Object.getPrototypeOf(Ib.prototype),"__additionally_serialize__",this).call(this,da,ka,va,Fa);ka=va.ref(this.ui.output);ka=ka.currentSnapshot.props;
ka.attributeConnections&&(ka.attributeConnections.value=[]);ka.plugins&&(ka.plugins.value=[]);ka.anchors&&(ka.anchors.value=ka.anchors.value.filter(function(M){return M.id.startsWith("selection-")}));ka.savedMarks&&(ka.savedMarks.value=[]);ka=va.ref(this.ui.input);ka=ka.currentSnapshot.props;ka.attributeConnections&&(ka.attributeConnections.value=[]);ka.plugins&&(ka.plugins.value=[]);ka.anchors&&(ka.anchors.value=ka.anchors.value.filter(function(M){return M.id.startsWith("selection-")}));ka.savedMarks&&
(ka.savedMarks.value=[]);da.props._serializedState={verbatim:!0,value:{cwd:this.cwd}}}},{key:"onLoad",value:function(da,ka){this._serializedState&&(this.cwd=this._serializedState.cwd,delete this._serializedState);Nb.connect(this.ui.input,"inputAccepted",this,"execCommand",{updater:function(va,Fa){return va("[shell terminal] run command or send input",{command:Fa})}})}},{key:"defaultStyle",get:function(){return Object.assign({},Nb.config.codeEditor.defaultStyle)}},{key:"focus",value:function(){this.ui[this.lastFocused].focus()}},
{key:"clear",value:function(){this.ui.output.textString=""}},{key:"updateWindowTitle",value:function(){var da=this.getWindow();if(da){var ka="Term",va=this.command;if(va){var Fa=va.commandString;va=va.status;ka+=" - ".concat(Fa?Fa+" ":"").concat(va)}da.title=ka}}},{key:"updateTextMode",value:function(){var da=this.ui.output,ka=Nb.guessTextModeName(da),va=da.plugins.filter(function(M){return M.isEditorPlugin}),Fa=[];"diff"===ka&&((ka=va.find(function(M){return M instanceof Nb.DiffEditorPlugin}))?Nb.arr.remove(va,
ka):Fa.push(new Nb.DiffEditorPlugin));da.plugins=Nb.arr.withoutAll(da.plugins,va).concat(Fa)}},{key:"keybindings",get:function(){return[{keys:"F1|Alt-Up",command:"focus output"},{keys:"F2|Alt-Down",command:"focus input"},{keys:"Ctrl-D",command:{command:"[shell] kill current command",args:{signal:"KILL"}}},{keys:"Ctrl-C",command:{command:"[shell] kill current command",args:{signal:"INT"}}},{keys:{mac:"Meta-Shift-L D I R",win:"Ctrl-Shift-L D I R"},command:"[shell] change working directory"}].concat(Rc._get(Object.getPrototypeOf(Ib.prototype),
"keybindings",this))}},{key:"commands",get:function(){return Rc._get(Object.getPrototypeOf(Ib.prototype),"commands",this).concat([{name:"focus input",exec:function(da){da.lastFocused="input";da=da.ui.input;da.show();da.focus();return!0}},{name:"focus output",exec:function(da){da.lastFocused="output";da=da.ui.output;da.show();da.focus();return!0}},{name:"[shell terminal] run command or send input",exec:function(da){var ka=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{command:""};da.command&&
da.command.isRunning()?da.command.writeToStdin(ka.command+"\n"):(da.clear(),da.runCommand(ka.command,Nb.obj.dissoc(ka,["command"])));return!0}},{name:"[shell] kill current command",exec:function(){var da=Ne(regeneratorRuntime.mark(function Fa(va){var M,Aa,wb,Na=arguments;return regeneratorRuntime.wrap(function(hb){for(;;)switch(hb.prev=hb.next){case 0:M=1<Na.length&&void 0!==Na[1]?Na[1]:{signal:void 0};if(Aa=va.command){hb.next=5;break}va.setStatusMessage("No command running");return hb.abrupt("return",
!0);case 5:return wb=M.signal||"KILL",va.addOutput("\nsend signal ".concat(wb)),va.setStatusMessage("Sending signal ".concat(wb," to command ").concat(Aa.pid)),hb.next=10,Aa.kill(wb);case 10:return hb.abrupt("return",!0);case 11:case "end":return hb.stop()}},Fa)}));return function(va){return da.apply(this,arguments)}}()},{name:"[shell] change working directory",exec:function(){var da=Ne(regeneratorRuntime.mark(function Fa(va){return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=
2,va.shellPlugin.changeCwdInteractively();case 2:return M.abrupt("return",!0);case 3:case "end":return M.stop()}},Fa)}));return function(va){return da.apply(this,arguments)}}()}])}},{key:"addOutput",value:function(da){var ka=this.ui.output,va=ka.isAtDocumentEnd();ka.append(da);va&&(ka.gotoDocumentEnd(),ka.scrollCursorIntoView())}},{key:"diffModulesOfSnapshot",value:function(){var da=Ne(regeneratorRuntime.mark(function Fa(va){var M=this,Aa,wb,Na,hb,Bb,ba,dc,la;return regeneratorRuntime.wrap(function(Fb){for(;;)switch(Fb.prev=
Fb.next){case 0:return Aa=this.shellPlugin.runCommand("git diff "+va),Fb.next=3,Aa.whenDone();case 3:wb=Aa.stdout.split("\n").filter(function(vb){return 1E3<vb.length}).map(function(vb){return JSON.parse(vb.slice(1))}),Na=ad(wb,2),hb=Na[0],Bb=Na[1],hb&&Bb?(ba=Nb.packagesOfSnapshot(hb),dc=Nb.packagesOfSnapshot(Bb),la=[],Nb.arr.zip(ba,dc).forEach(function(vb){var Ia=ad(vb,2);vb=Ia[0];Ia=Ia[1];vb&&Ia&&Nb.arr.zip(Object.entries(vb.files),Object.entries(Ia.files)).forEach(function(xb){var Rb=ad(xb,2),
yc=ad(Rb[0],2);xb=yc[0];yc=yc[1];Rb=ad(Rb[1],2);Rb[0];Rb=Rb[1];yc!=Rb&&la.push([xb,yc,Rb])})}),la.forEach(function(vb){var Ia=ad(vb,3);vb=Ia[0];var xb=Ia[1];Ia=Ia[2];M.world().execCommand("diff and open in window",{a:xb,b:Ia,title:vb})})):this.world().inform("No Changes!");case 5:case "end":return Fb.stop()}},Fa,this)}));return function(va){return da.apply(this,arguments)}}()},{key:"runCommand",value:function(da,ka){if(this.command&&this.command.isRunning())throw Error("".concat(this.command," still running"));
return da.includes("styleguides")&&da.startsWith("git diff")?this.diffModulesOfSnapshot(da.replace(/git diff\s*/,"")):this.command=this.shellPlugin.runCommand(da,ka)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"Terminal"}},{key:"open",value:function(){var da=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},ka=new this(da);da=ka.openInWindow({name:"ShellTerminal window",title:da.title||"Terminal"});ka.whenRendered().then(function(){return ka.focus()});return da}},{key:"runCommand",
value:function(da,ka){var va=this.open(ka);va.targetMorph.runCommand(da,ka);return va}},{key:"forCommand",value:function(da,ka){return this.open(Object.assign({command:da},ka))}},{key:"findOrCreateForCommand",value:function(da){var ka=Nb.World.defaultWorld();return Nb.arr.grep(ka.submorphs,/ShellTerminal window/).find(function(va){return va.targetMorph.command&&va.targetMorph.command.pid===da.pid})||this.forCommand(da)}},{key:"properties",get:function(){return{title:{defaultValue:"Terminal"},name:{defaultValue:"terminal"},
extent:{defaultValue:Nb.pt(600,300)},lastFocused:{defaultValue:"input"},submorphs:{initialize:function(){this.submorphs=[Object.assign({type:"text",name:"output",lineWrapping:!1,textString:""},this.defaultStyle),new Nb.InputLine(Object.assign({},this.defaultStyle,{name:"input",textString:"",clearOnInput:!0,historyId:"lively.shell-terminal-input-history",border:{width:1,color:Nb.Color.gray},plugins:[new Nb.ShellEditorPlugin,new Nb.EditorPlugin],clipMode:"hidden"})),{type:"button",name:"changeCwdButton",
label:"cwd...",extent:Nb.pt(60,20),borderRadius:3,fontSize:12,master:Nb.DarkButton,padding:Nb.Rectangle.inset(4,2)}];var da=this.ui,ka=da.changeCwdButton;Nb.connect(da.input,"inputAccepted",this,"execCommand",{updater:function(va,Fa){return va("[shell terminal] run command or send input",{command:Fa})}});Nb.connect(this,"extent",ka,"topRight",{converter:function(va){return va.withY(0).addXY(-5,5)}});Nb.connect(ka,"fire",this,"execCommand",{converter:function(){return"[shell] change working directory"}});
this.layout=new Nb.GridLayout({grid:[["output"],["input"]],rows:[1,{fixed:25}],groups:{output:{align:"topLeft",resize:!0},input:{align:"topLeft",resize:!0}}})}},ui:{derived:!0,readOnly:!0,after:["submorphs"],get:function(){var da=ad(this.submorphs,3);return{output:da[0],input:da[1],changeCwdButton:da[2]}}},command:{derived:!0,after:["shellPlugin"],get:function(){return this.shellPlugin.command},set:function(da){if(this.command&&this.command.isRunning())throw Error("".concat(this.command," still running"));
this.shellPlugin.command=da;da.stdout&&this.addOutput(da.stdout);da.stdout&&this.addOutput(da.stderr);Nb.connect(da,"stdout",this,"addOutput");Nb.connect(da,"stderr",this,"addOutput");Nb.connect(da,"error",this,"addOutput");Nb.connect(da,"pid",this,"updateWindowTitle");Nb.connect(da,"close",this,"updateWindowTitle");Nb.connect(da,"close",this,"updateTextMode");this.updateWindowTitle();this.updateTextMode()}},cwd:{derived:!0,after:["shellPlugin"],get:function(){return this.shellPlugin.cwd},set:function(da){return this.shellPlugin.cwd=
da}},shellPlugin:{derived:!0,readOnly:!0,after:["submorphs"],get:function(){var da=this.ui.input,ka=da.pluginFind(function(va){return va.isShellEditorPlugin});if(ka)return ka;ka=da.addPlugin(new Nb.ShellEditorPlugin);Nb.connect(ka,"cwd",this.ui.changeCwdButton,"label");return ka}},input:{derived:!0,after:["submorphs"],set:function(da){this.ui.input.input=da},get:function(){return this.ui.input.input}}}}}],rb,{pathInPackage:function(){return"./shell/terminal.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:878,end:12474})}(Nb.Morph));Nb["default"]=kc}}});
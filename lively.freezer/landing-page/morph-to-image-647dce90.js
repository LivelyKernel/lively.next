System.register(["./__rootModule___commonjs-entry-51a55f66.js","@babel/plugin-syntax-import-meta"],function(bd){var Dd,se,Rc;return{setters:[function(ad){Dd=ad._;se=ad.N;Rc=ad.K},function(){}],execute:function(){function ad(uc){return Ne.apply(this,arguments)}function Ne(){Ne=Dd(regeneratorRuntime.mark(function vd(dd){var Ed,fe,jc,Od,qb,ic,Wb,lc,db,Xa,Gb,sc,ub,sb,fa,Db,ab,eb,kc,Vb,pb,Nb,zb=arguments;return regeneratorRuntime.wrap(function(rb){for(;;)switch(rb.prev=rb.next){case 0:return Ed=1<zb.length&&
void 0!==zb[1]?zb[1]:{},fe=new Map,dd.withAllSubmorphsDo(function(Ib){return Ib.isHTMLMorph&&fe.set(Ib,{domNode:Ib.domNode,parentNode:Ib.domNode.parentNode})}),jc=dd.renderOnGPU,dd.renderOnGPU=!0,rb.next=7,dd.whenRendered();case 7:return Od=dd.env.domEnv,qb=Od.document,ic=Od.window,Wb=dd.renderPreview(Object.assign({},Ed,{asNode:!0})),lc=qb.createElement("div"),db=qb.createElement("div"),Xa=Ed.width,Gb=Ed.height,sc=Ed.type,ub=void 0===sc?"svg":sc,System.get("@system-env").node&&ve.fixNodejs(qb,ic),
rb.prev=13,lc.style.overflow="hidden",lc.style.width="1px",lc.style.height="1px",lc.style.position="absolute",qb.body.appendChild(lc),lc.appendChild(db),db.appendChild(Wb),sb=Xa&&Gb?null:Wb.getBoundingClientRect(),Xa||(db.style.width=Math.ceil(sb.width+2*dd.borderWidth)+"px"),Gb||(db.style.height=Math.ceil(sb.height+2*dd.borderWidth)+"px"),db.style.width=Xa+"px",db.style.height=Gb+"px",fa=ve.typeMethodMap[ub]||"toSvg",rb.next=29,ve.domToImage[fa](db,{style:{transform:"scale(.7)","transform-origin":"center"}});
case 29:return Db=rb.sent,rb.abrupt("return",Db);case 31:rb.prev=31;dd.renderOnGPU=jc;lc.parentNode&&lc.parentNode.removeChild(lc);ab=se(fe);try{for(ab.s();!(eb=ab.n()).done;)kc=Rc(eb.value,2),Vb=kc[1],pb=Vb.domNode,Nb=Vb.parentNode,pb&&Nb&&pb.parentNode!==Nb&&Nb.appendChild(pb)}catch(Ib){ab.e(Ib)}finally{ab.f()}return rb.finish(31);case 37:case "end":return rb.stop()}},vd,null,[[13,,31,37]])}));return Ne.apply(this,arguments)}bd("renderMorphToDataURI",ad);var Cb={};(function(uc){function dd(sc,ub){ub=
ub||{};vd(ub);return Promise.resolve(sc).then(function(sb){return fe(sb,ub.filter,!0)}).then(jc).then(Od).then(function(sb){ub.bgcolor&&(sb.style.backgroundColor=ub.bgcolor);ub.width&&(sb.style.width=ub.width+"px");ub.height&&(sb.style.height=ub.height+"px");ub.style&&Object.keys(ub.style).forEach(function(fa){sb.style[fa]=ub.style[fa]});return sb}).then(function(sb){return qb(sb,ub.width||ic.width(sc),ub.height||ic.height(sc))})}function vd(sc){Gb.impl.options.imagePlaceholder="undefined"===typeof sc.imagePlaceholder?
Xa.imagePlaceholder:sc.imagePlaceholder;Gb.impl.options.cacheBust="undefined"===typeof sc.cacheBust?Xa.cacheBust:sc.cacheBust;Gb.impl.options.useCredentials="undefined"===typeof sc.useCredentials?Xa.useCredentials:sc.useCredentials}function Ed(sc,ub){return dd(sc,ub).then(ic.makeImage).then(ic.delay(100)).then(function(sb){var fa="number"!==typeof ub.scale?1:ub.scale,Db=document.createElement("canvas");Db.width=(ub.width||ic.width(sc))*fa;Db.height=(ub.height||ic.height(sc))*fa;if(ub.bgcolor){var ab=
Db.getContext("2d");ab.fillStyle=ub.bgcolor;ab.fillRect(0,0,Db.width,Db.height)}ab=Db.getContext("2d");sb&&(ab.scale(fa,fa),ab.drawImage(sb,0,0));return Db})}function fe(sc,ub,sb){function fa(ab,eb,kc){ab=ab.childNodes;return 0===ab.length?Promise.resolve(eb):function(Vb,pb,Nb){var zb=Promise.resolve();pb.forEach(function(rb){zb=zb.then(function(){return fe(rb,Nb)}).then(function(Ib){Ib&&Vb.appendChild(Ib)})});return zb}(eb,ic.asArray(ab),kc).then(function(){return eb})}function Db(ab,eb){return eb instanceof
Element?Promise.resolve().then(function(){(function(kc,Vb){function pb(Nb,zb){ic.asArray(Nb).forEach(function(rb){zb.setProperty(rb,Nb.getPropertyValue(rb),Nb.getPropertyPriority(rb))})}kc.cssText?(Vb.cssText=kc.cssText,Vb.font=kc.font):pb(kc,Vb)})(window.getComputedStyle(ab),eb.style)}).then(function(){function kc(Vb){var pb=window.getComputedStyle(ab,Vb),Nb=pb.getPropertyValue("content");if(""!==Nb&&"none"!==Nb){Nb=ic.uid();var zb=eb.getAttribute("class");zb&&eb.setAttribute("class",zb+" "+Nb);
zb=document.createElement("style");zb.appendChild(function(rb,Ib,da){function ka(Fa){var M=Fa.getPropertyValue("content");return Fa.cssText+" content: "+M+";"}function va(Fa){return ic.asArray(Fa).map(function(M){return M+": "+Fa.getPropertyValue(M)+(Fa.getPropertyPriority(M)?" !important":"")}).join("; ")+";"}rb="."+rb+":"+Ib;da=da.cssText?ka(da):va(da);return document.createTextNode(rb+"{"+da+"}")}(Nb,Vb,pb));eb.appendChild(zb)}}[":before",":after"].forEach(function(Vb){kc(Vb)})}).then(function(){ab instanceof
HTMLTextAreaElement&&(eb.innerHTML=ab.value);ab instanceof HTMLInputElement&&eb.setAttribute("value",ab.value)}).then(function(){eb instanceof SVGElement&&(eb.setAttribute("xmlns","http://www.w3.org/2000/svg"),eb instanceof SVGRectElement&&["width","height"].forEach(function(kc){var Vb=eb.getAttribute(kc);Vb&&eb.style.setProperty(kc,Vb)}))}).then(function(){return eb}):eb}return sb||!ub||ub(sc)?Promise.resolve(sc).then(function(ab){return ab instanceof HTMLCanvasElement?ic.makeImage(ab.toDataURL()):
ab.cloneNode(!1)}).then(function(ab){return fa(sc,ab,ub)}).then(function(ab){return Db(sc,ab)}):Promise.resolve()}function jc(sc){return lc.resolveAll().then(function(ub){var sb=document.createElement("style");sc.appendChild(sb);sb.appendChild(document.createTextNode(ub));return sc})}function Od(sc){return db.inlineAll(sc).then(function(){return sc})}function qb(sc,ub,sb){return Promise.resolve(sc).then(function(fa){fa.setAttribute("xmlns","http://www.w3.org/1999/xhtml");return(new XMLSerializer).serializeToString(fa)}).then(ic.escapeXhtml).then(function(fa){return'<foreignObject x="0" y="0" width="100%" height="100%">'+
fa+"</foreignObject>"}).then(function(fa){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+ub+'" height="'+sb+'">'+fa+"</svg>"}).then(function(fa){return"data:image/svg+xml;charset=utf-8,"+fa})}var ic=function(){function sc(fa){return(fa=/\.([^\.\/]*?)(\?|$)/g.exec(fa))?fa[1]:""}function ub(fa){return new Promise(function(Db){for(var ab=window.atob(fa.toDataURL().split(",")[1]),eb=ab.length,kc=new Uint8Array(eb),Vb=0;Vb<eb;Vb++)kc[Vb]=ab.charCodeAt(Vb);Db(new Blob([kc],{type:"image/png"}))})}
function sb(fa,Db){fa=window.getComputedStyle(fa).getPropertyValue(Db);return parseFloat(fa.replace("px",""))}return{escape:function(fa){return fa.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:sc,mimeType:function(fa){return{woff:"application/font-woff",woff2:"application/font-woff",ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}[sc(fa).toLowerCase()]||""},dataAsUrl:function(fa,
Db){return"data:"+Db+";base64,"+fa},isDataUrl:function(fa){return-1!==fa.search(/^(data:)/)},canvasToBlob:function(fa){return fa.toBlob?new Promise(function(Db){fa.toBlob(Db)}):ub(fa)},resolveUrl:function(fa,Db){var ab=document.implementation.createHTMLDocument(),eb=ab.createElement("base");ab.head.appendChild(eb);var kc=ab.createElement("a");ab.body.appendChild(kc);eb.href=Db;kc.href=fa;return kc.href},getAndEncode:function(fa){Gb.impl.options.cacheBust&&(fa+=(/\?/.test(fa)?"&":"?")+(new Date).getTime());
return new Promise(function(Db){var ab=new XMLHttpRequest;ab.onreadystatechange=function(){if(4===ab.readyState)if(200!==ab.status)eb?Db(eb):(console.error("cannot fetch resource: "+fa+", status: "+ab.status),Db(""));else{var Vb=new FileReader;Vb.onloadend=function(){var pb=Vb.result.split(/,/)[1];Db(pb)};Vb.readAsDataURL(ab.response)}};ab.ontimeout=function(){eb?Db(eb):(console.error("timeout of 30000ms occured while fetching resource: "+fa),Db(""))};ab.responseType="blob";ab.timeout=3E4;Gb.impl.options.useCredentials&&
(ab.withCredentials=!0);ab.open("GET",fa,!0);ab.send();var eb;if(Gb.impl.options.imagePlaceholder){var kc=Gb.impl.options.imagePlaceholder.split(/,/);kc&&kc[1]&&(eb=kc[1])}})},uid:function(){var fa=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+fa++}}(),delay:function(fa){return function(Db){return new Promise(function(ab){setTimeout(function(){ab(Db)},fa)})}},asArray:function(fa){for(var Db=[],ab=fa.length,eb=0;eb<ab;eb++)Db.push(fa[eb]);return Db},
escapeXhtml:function(fa){return fa.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(fa){return"data:,"===fa?Promise.resolve():new Promise(function(Db,ab){var eb=new Image;Gb.impl.options.useCredentials&&(eb.crossOrigin="use-credentials");eb.onload=function(){Db(eb)};eb.onerror=ab;eb.src=fa})},width:function(fa){var Db=sb(fa,"border-left-width"),ab=sb(fa,"border-right-width");return fa.scrollWidth+Db+ab},height:function(fa){var Db=sb(fa,"border-top-width"),ab=sb(fa,"border-bottom-width");
return fa.scrollHeight+Db+ab}}}(),Wb=function(){function sc(Db){return-1!==Db.search(fa)}function ub(Db){for(var ab=[],eb;null!==(eb=fa.exec(Db));)ab.push(eb[1]);return ab.filter(function(kc){return!ic.isDataUrl(kc)})}function sb(Db,ab,eb,kc){return Promise.resolve(ab).then(function(Vb){return eb?ic.resolveUrl(Vb,eb):Vb}).then(kc||ic.getAndEncode).then(function(Vb){return ic.dataAsUrl(Vb,ic.mimeType(ab))}).then(function(Vb){return Db.replace(new RegExp("(url\\(['\"]?)("+ic.escape(ab)+")(['\"]?\\))",
"g"),"$1"+Vb+"$3")})}var fa=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(Db,ab,eb){return sc(Db)?Promise.resolve(Db).then(ub).then(function(kc){var Vb=Promise.resolve(Db);kc.forEach(function(pb){Vb=Vb.then(function(Nb){return sb(Nb,pb,ab,eb)})});return Vb}):Promise.resolve(Db)},shouldProcess:sc,impl:{readUrls:ub,inline:sb}}}(),lc=function(){function sc(){function ub(sb){return{resolve:function(){return Wb.inlineAll(sb.cssText,(sb.parentStyleSheet||{}).href)},src:function(){return sb.style.getPropertyValue("src")}}}
return Promise.resolve(ic.asArray(document.styleSheets)).then(function(sb){var fa=[];sb.forEach(function(Db){if(Db.hasOwnProperty("cssRules"))try{ic.asArray(Db.cssRules||[]).forEach(fa.push.bind(fa))}catch(ab){console.log("Error while reading CSS rules from "+Db.href,ab.toString())}});return fa}).then(function(sb){return sb.filter(function(fa){return fa.type===CSSRule.FONT_FACE_RULE}).filter(function(fa){return Wb.shouldProcess(fa.style.getPropertyValue("src"))})}).then(function(sb){return sb.map(ub)})}
return{resolveAll:function(){return sc().then(function(ub){return Promise.all(ub.map(function(sb){return sb.resolve()}))}).then(function(ub){return ub.join("\n")})},impl:{readAll:sc}}}(),db=function(){function sc(sb){return{inline:function(fa){return ic.isDataUrl(sb.src)?Promise.resolve():Promise.resolve(sb.src).then(fa||ic.getAndEncode).then(function(Db){return ic.dataAsUrl(Db,ic.mimeType(sb.src))}).then(function(Db){return new Promise(function(ab,eb){sb.onload=ab;sb.onerror=ab;sb.src=Db})})}}}function ub(sb){return sb instanceof
Element?function(fa){var Db=fa.style.getPropertyValue("background");return Db?Wb.inlineAll(Db).then(function(ab){fa.style.setProperty("background",ab,fa.style.getPropertyPriority("background"))}).then(function(){return fa}):Promise.resolve(fa)}(sb).then(function(){return sb instanceof HTMLImageElement?sc(sb).inline():Promise.all(ic.asArray(sb.childNodes).map(function(fa){return ub(fa)}))}):Promise.resolve(sb)}return{inlineAll:ub,impl:{newImage:sc}}}(),Xa={imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1},
Gb={toSvg:dd,toPng:function(sc,ub){return Ed(sc,ub||{}).then(function(sb){return sb.toDataURL()})},toJpeg:function(sc,ub){ub=ub||{};return Ed(sc,ub).then(function(sb){return sb.toDataURL("image/jpeg",ub.quality||1)})},toBlob:function(sc,ub){return Ed(sc,ub||{}).then(ic.canvasToBlob)},toPixelData:function(sc,ub){return Ed(sc,ub||{}).then(function(sb){return sb.getContext("2d").getImageData(0,0,ic.width(sc),ic.height(sc)).data})},toCanvas:function(sc,ub){return Ed(sc,ub||{})},impl:{fontFaces:lc,images:db,
util:ic,inliner:Wb,options:{}}};Cb=Gb})();var Sd=Cb,ve=window.lively.FreezerRuntime.recorderFor("lively.morphic/rendering/morph-to-image.js");ve.fixNodejs=function(uc,dd){var vd=System.global;dd.XMLSerializer||(dd.XMLSerializer=function(){},dd.XMLSerializer.prototype.serializeToString=function(jc){return jc.outerHTML});vd.window!==dd&&(vd.window=dd);vd.document!==uc&&(vd.document=uc);uc=0;for(var Ed="HTMLCanvasElement Element HTMLTextAreaElement HTMLInputElement SVGElement SVGRectElement XMLSerializer Blob Image XMLHttpRequest FileReader CSSRule HTMLImageElement".split(" ");uc<
Ed.length;uc++){var fe=Ed[uc];dd[fe]||(console.log("".concat(fe," is not available!")),dd[fe]=eval("(function ".concat(fe,'() { throw new Error("').concat(fe,' not supported"); })')));dd[fe]!=vd[fe]&&(vd[fe]=dd[fe])}};ve.renderMorphToDataURI=ad;ve.domToImage=Sd;ve.typeMethodMap={blob:"toBlob",jpeg:"toJpeg",pixeldata:"toPixelData",png:"toPng",svg:"toSvg"};ve.renderMorphToDataURI=ad}}});
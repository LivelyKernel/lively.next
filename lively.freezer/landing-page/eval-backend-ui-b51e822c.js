System.register("./__rootModule___commonjs-entry-51a55f66.js ./index-42118cd5.js ./index-61952933.js ./loading-indicator.cp-98e470a2.js @babel/plugin-syntax-import-meta ./interface-1a7f3c67.js ./index-616023be.js ./tooltips.cp-3c41b378.js".split(" "),function(bd){var Dd,se,Rc,ad,Ne,Cb,Sd,ve,uc,dd,vd,Ed,fe,jc,Od,qb,ic,Wb,lc;return{setters:[function(db){Dd=db.b;se=db.ah;Rc=db.C;ad=db.s;Ne=db.t;Cb=db.d;Sd=db.F;ve=db.bY;uc=db.bZ;dd=db.i;vd=db._;Ed=db.K;fe=db.m},function(db){jc=db.serverInterfaceFor;Od=
db.localInterface;qb=db.l2lInterfaceFor},function(db){ic=db.j},function(db){Wb=db.a;lc=db.B},function(){},function(){},function(){},function(){}],execute:function(){var db=window.lively.FreezerRuntime.recorderFor("lively.ide/js/eval-backend-ui.js");db.pt=Dd;db.LinearGradient=se;db.Color=Rc;db.arr=ad;db.string=Ne;db.connect=Cb;db.config=Sd;db.StyleSheet=ve;db.L2LClient=uc;db.serverInterfaceFor=jc;db.localInterface=Od;db.l2lInterfaceFor=qb;db.Button=Wb;db.DropDownList=ic;db.ButtonDefault=lc;var Xa=
bd("EvalBackendButton",function(Gb){var sc=window.lively.FreezerRuntime.recorderFor("lively.ide/js/eval-backend-ui.js"),ub=sc.hasOwnProperty("EvalBackendButton")&&"function"===typeof sc.EvalBackendButton?sc.EvalBackendButton:sc.EvalBackendButton=function(sb){if(!sb||!sb[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return dd(ub,Gb,[{key:"trigger",value:function(){var sb=vd(regeneratorRuntime.mark(function Db(){var ab,eb,
kc,Vb,pb,Nb,zb,rb,Ib,da,ka,va;return regeneratorRuntime.wrap(function(Fa){for(;;)switch(Fa.prev=Fa.next){case 0:return Fa.next=2,this.evalbackendChooser.allEvalBackends();case 2:return ab=Fa.sent,eb=this.currentBackend,kc=1,Vb=["edit..."].concat(fe(ab.map(function(M,Aa){eb===M&&(kc=Aa+1);return{isListItem:!0,label:[M.coreInterface.description||M.name,{fontSize:"90%"}],value:M}}))),Fa.next=8,this.world().filterableListPrompt("choose eval backend",Vb,{requester:this.target,preselect:kc});case 8:pb=
Fa.sent;Nb=Ed(pb.selected,1);zb=Nb[0];if("edit..."!==zb){Fa.next=25;break}Fa.next=14;return this.world().editListPrompt("choose and edit eval backends",this.evalbackendChooser.customBackends.map(function(M){return{isListItem:!0,label:[M.coreInterface.description||M.name,{fontSize:"90%"}],value:M}}),{historyId:"js-eval-backend-history"});case 14:rb=Fa.sent;Ib=rb.status;da=rb.list;ka=Ed(rb.selections,1);va=ka[0];if("canceled"!==Ib){Fa.next=21;break}return Fa.abrupt("return");case 21:this.evalbackendChooser.customBackends=
da;if(va){Fa.next=24;break}return Fa.abrupt("return");case 24:zb="string"===typeof va?this.evalbackendChooser.backendWithName(va):va;case 25:this.currentBackend=zb,this.fit(),120>this.width&&(this.width=120);case 28:case "end":return Fa.stop()}},Db,this)}));return function(){return sb.apply(this,arguments)}}()},{key:"ensureSimilarBackend",value:function(){var sb=vd(regeneratorRuntime.mark(function Db(){var ab,eb,kc,Vb,pb,Nb;return regeneratorRuntime.wrap(function(zb){for(;;)switch(zb.prev=zb.next){case 0:if(this.currentBackendName&&
this.currentBackendName.startsWith("l2l")){zb.next=2;break}return zb.abrupt("return");case 2:return ab=this.currentBackend.coreInterface,eb=ab.targetId,kc=ab.peer,zb.next=5,this.evalbackendChooser.l2lEvalBackends();case 5:Vb=zb.sent;if(!Vb.some(function(rb){return rb.coreInterface.targetId===eb})){zb.next=8;break}return zb.abrupt("return");case 8:kc&&kc.type&&(pb=Vb.find(function(rb){return rb.coreInterface.peer&&rb.coreInterface.peer.type===kc.type?kc.user&&kc.user.name&&rb.coreInterface.peer.user?
rb.coreInterface.peer.user.name===kc.user.name:!0:!1})),pb&&(Nb=$world.focusedMorph,this.currentBackend=pb,Nb&&setTimeout(function(){return Nb.focus()},0));case 10:case "end":return zb.stop()}},Db,this)}));return function(){return sb.apply(this,arguments)}}()},{key:"updateFromTarget",value:function(){this.currentBackend=this.target.systemInterface}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"EvalBackendButton"}},{key:"properties",get:function(){return{currentBackendName:{after:["label"],
defaultValue:"local",set:function(sb){this.setProperty("currentBackendName",sb);var fa=this.currentBackend;this.label=db.string.truncate(fa&&fa.coreInterface&&fa.coreInterface.description||sb||"local",25)}},currentBackend:{derived:!0,get:function(){return this.evalbackendChooser.backendWithName(this.currentBackendName)},set:function(sb){this.currentBackendName=sb?sb.name:"local"}},evalbackendChooser:{readOnly:!0,derived:!0,get:function(){return db.EvalBackendChooser["default"]}},extent:{defaultValue:db.pt(120,
20)},target:{}}}}],sc,{pathInPackage:function(){return"./js/eval-backend-ui.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:501,end:4047})}(db.Button));db.EvalBackendButton=Xa;db.EvalBackendButton=Xa;Xa=bd("default",function(Gb){var sc=window.lively.FreezerRuntime.recorderFor("lively.ide/js/eval-backend-ui.js"),ub=sc.hasOwnProperty("EvalBackendChooser")&&
"function"===typeof sc.EvalBackendChooser?sc.EvalBackendChooser:sc.EvalBackendChooser=function(sb){if(!sb||!sb[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return dd(ub,Gb,[{key:"customBackends",get:function(){try{var sb=localStorage["lively.morphic-ide/js/EvalBackendChooser-history"];return(sb?JSON.parse(sb):[]).map(function(fa){return fa.startsWith("http")?db.serverInterfaceFor(fa):null}).filter(Boolean)}catch(fa){}return[]}},
{key:"customBackends",set:function(sb){sb=sb.filter(function(fa){return!!fa&&"local"!==fa&&"edit..."!==fa});try{localStorage["lively.morphic-ide/js/EvalBackendChooser-history"]=JSON.stringify(sb)}catch(fa){}}},{key:"backendWithName",value:function(sb){return sb&&"local"!==sb?sb.startsWith("http")?db.serverInterfaceFor(sb):sb.startsWith("l2l")?db.l2lInterfaceFor(sb.split(" ")[1]):db.localInterface:db.localInterface}},{key:"httpEvalBackends",get:function(){return[db.serverInterfaceFor(db.config.remotes.server)]}},
{key:"l2lEvalBackends",value:function(){var sb=vd(regeneratorRuntime.mark(function Db(){var ab,eb;return regeneratorRuntime.wrap(function(kc){for(;;)switch(kc.prev=kc.next){case 0:return ab=db.L2LClient.forLivelyInBrowser(),kc.next=3,ab.listPeers();case 3:return eb=kc.sent,eb=eb.filter(function(Vb){return Vb.id!==ab.id}),kc.next=7,Promise.all(eb.map(function(){var Vb=vd(regeneratorRuntime.mark(function zb(Nb){return regeneratorRuntime.wrap(function(rb){for(;;)switch(rb.prev=rb.next){case 0:return rb.abrupt("return",
db.l2lInterfaceFor(Nb.id,Nb));case 1:case "end":return rb.stop()}},zb)}));return function(Nb){return Vb.apply(this,arguments)}}()));case 7:return kc.abrupt("return",kc.sent);case 8:case "end":return kc.stop()}},Db)}));return function(){return sb.apply(this,arguments)}}()},{key:"allEvalBackends",value:function(){var sb=vd(regeneratorRuntime.mark(function Db(){return regeneratorRuntime.wrap(function(ab){for(;;)switch(ab.prev=ab.next){case 0:return ab.t0=db.arr,ab.t1=[db.localInterface],ab.t2=fe(this.customBackends),
ab.t3=fe(this.httpEvalBackends),ab.t4=fe,ab.next=7,this.l2lEvalBackends();case 7:return ab.t5=ab.sent,ab.t6=(0,ab.t4)(ab.t5),ab.t7=ab.t1.concat.call(ab.t1,ab.t2,ab.t3,ab.t6),ab.abrupt("return",ab.t0.uniq.call(ab.t0,ab.t7));case 11:case "end":return ab.stop()}},Db,this)}));return function(){return sb.apply(this,arguments)}}()},{key:"buildEvalBackendDropdownFor",value:function(sb,fa){fa=fa||new db.EvalBackendButton({name:"eval backend button",master:db.ButtonDefault,fontSize:11,height:20,target:sb});
setTimeout(function(){return fa.updateFromTarget()},0);db.connect(fa,"currentBackend",this,"changeEvalBackend",{updater:function(Db,ab){Db(ab,this.sourceObj.target)}});fa.startStepping(5E3,"ensureSimilarBackend");return fa}},{key:"ensureEvalBackendDropdown",value:function(sb,fa){(fa=sb.getSubmorphNamed("eval backend button"))||(fa=this.buildEvalBackendDropdownFor(sb));return fa}},{key:"changeEvalBackend",value:function(){var sb=vd(regeneratorRuntime.mark(function eb(Db,ab){return regeneratorRuntime.wrap(function(kc){for(;;)switch(kc.prev=
kc.next){case 0:if(ab){kc.next=3;break}console.warn("Called EvalBackendChooser.changeEvalBackend without requester!");return kc.abrupt("return");case 3:try{Db||(Db=db.localInterface),ab.systemInterface!==Db&&(ab.setStatusMessage("Eval backend is now ".concat(Db.name)),ab.setEvalBackend(Db)),ab.focus()}catch(Vb){console.warn("changeEvalBackend error: ".concat(Vb))}case 4:case "end":return kc.stop()}},eb)}));return function(Db,ab){return sb.apply(this,arguments)}}()},{key:"activateEvalBackendCommand",
value:function(sb){return{name:"activate eval backend dropdown list",exec:function(){var fa=sb.getSubmorphNamed("eval backend button");fa&&fa.trigger();return!0}}}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"EvalBackendChooser"}},{key:"default",get:function(){return this._default||(this._default=new this)}}],sc,{pathInPackage:function(){return"./js/eval-backend-ui.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:4063,end:8073})}(void 0));db["default"]=Xa}}});
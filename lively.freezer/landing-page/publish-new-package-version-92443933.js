System.register("./__rootModule___commonjs-entry-51a55f66.js ./terminal-636691b6.js @babel/plugin-syntax-import-meta ./editor-plugin-5397d87c.js ./ui.cp-8dfc076f.js ./loading-indicator.cp-98e470a2.js ./index-61952933.js ./tooltips.cp-3c41b378.js ./index-42118cd5.js ./interface-1a7f3c67.js ./index-616023be.js ./popups.cp-5b9fb681.js ./list.cp-840d1cf8.js ./editor-modes-aae4d878.js ./mode-3092ef0b.js ./editor-plugin-2820dfc1.js ./ui.cp-499efc12.js ./index-81f98d16.js ./editor-plugin-80c3c4f5.js ./editor-plugin-0f29b6cf.js ./eval-backend-ui-b51e822c.js ./top-bar.cp-fa0cb96d.js ./canvas-2fd3d40b.js lively.collab ./messages.cp-817cc06d.js rollup @rollup/plugin-json ./helpers-94ca076d.js @rollup/plugin-commonjs rollup-plugin-polyfill-node ./user-ui-98206202.js ./object-classes-06d7e61a.js ./test-runner-15eee9f1.js ./linter-96a9a2d8.js".split(" "),function(bd){var Dd,
se,Rc,ad,Ne,Cb;return{setters:[function(Sd){Dd=Sd._;se=Sd.Y;Rc=Sd.o;ad=Sd.k;Ne=Sd.W},function(Sd){Cb=Sd["default"]},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},
function(){},function(){}],execute:function(){function Sd(){return ve.apply(this,arguments)}function ve(){ve=Dd(regeneratorRuntime.mark(function Wb(){var lc,db,Xa,Gb,sc,ub;return regeneratorRuntime.wrap(function(sb){for(;;)switch(sb.prev=sb.next){case 0:return lc=lively.modules.semver,sb.next=3,qb.$$world.prompt("Enter the package directory",{input:qb.defaultDirectory(),historyId:"pusblish-new-package-dir-history",useLastInput:!0});case 3:if(db=sb.sent){sb.next=6;break}throw Error("canceled");case 6:return sb.next=
8,qb.readConfig(db);case 8:return Xa=sb.sent,Gb=Xa.config,sc=Xa.configText,sb.next=13,qb.confirmPublish(Gb);case 13:if(sb.sent){sb.next=15;break}throw Error("canceled");case 15:return sb.next=17,qb.$$world.prompt("The current version is ".concat(Gb.version,". Please enter the new version number:"),{input:lc.inc(Gb.version,"patch")});case 17:if(ub=sb.sent){sb.next=20;break}throw Error("canceled");case 20:return sb.next=22,qb.addNewVersionToConfig(db,sc,Gb.version,ub);case 22:return sb.next=24,qb.publishToNPM(db);
case 24:return sb.next=26,qb.commitChanges(db);case 26:if(!sb.sent){sb.next=31;break}sb.next=29;return qb.gitTag(db,ub);case 29:return sb.next=31,qb.gitPush(db);case 31:return sb.abrupt("return",ub);case 32:case "end":return sb.stop()}},Wb)}));return ve.apply(this,arguments)}function uc(){uc=Dd(regeneratorRuntime.mark(function lc(Wb){var db;return regeneratorRuntime.wrap(function(Xa){for(;;)switch(Xa.prev=Xa.next){case 0:return Xa.next=2,qb.$$world.confirm("Do you want to publish a new version of ".concat(Wb.name,
"?"));case 2:return db=Xa.sent,Xa.abrupt("return",!0===db||0===db);case 4:case "end":return Xa.stop()}},lc)}));return uc.apply(this,arguments)}function dd(){dd=Dd(regeneratorRuntime.mark(function lc(Wb){var db;return regeneratorRuntime.wrap(function(Xa){for(;;)switch(Xa.prev=Xa.next){case 0:return Xa.next=2,qb.resource(Wb).join("package.json").read();case 2:return db=Xa.sent,Xa.abrupt("return",{config:JSON.parse(db),configText:db});case 4:case "end":return Xa.stop()}},lc)}));return dd.apply(this,
arguments)}function vd(){vd=Dd(regeneratorRuntime.mark(function Gb(Wb,lc,db,Xa){var sc;return regeneratorRuntime.wrap(function(ub){for(;;)switch(ub.prev=ub.next){case 0:return sc=lc.replace('"version": "'.concat(db,'"'),'"version": "'.concat(Xa,'"')),ub.next=3,qb.resource(Wb).join("package.json").write(sc);case 3:case "end":return ub.stop()}},Gb)}));return vd.apply(this,arguments)}function Ed(){Ed=Dd(regeneratorRuntime.mark(function lc(Wb){var db,Xa,Gb,sc,ub,sb,fa;return regeneratorRuntime.wrap(function(Db){for(;;)switch(Db.prev=
Db.next){case 0:return Db.next=2,qb.runCommand("git s",{cwd:Wb}).whenDone();case 2:db=Db.sent;Xa=db.exitCode;Gb=db.output;if(sc=Gb.match(/not a git repo/i)?null:Gb.trim()){Db.next=8;break}return Db.abrupt("return",!1);case 8:return ub=lively.lang.string.lines(sc),10<ub.length&&(ub=ub.slice(0,10).concat(["..."])),Db.next=12,qb.$$world.confirm("Local changes exist. Commit them all?\n"+ub.join("\n"));case 12:sb=Db.sent;if(!sb){Db.next=23;break}Db.next=16;return qb.runCommand("git ci -a",{cwd:Wb}).whenDone();
case 16:fa=Db.sent;Xa=fa.exitCode;Gb=fa.output;if(!Xa){Db.next=21;break}throw Error("Commit canceled");case 21:Db.next=24;break;case 23:throw Error("Local changes exist");case 24:return Db.abrupt("return",!0);case 25:case "end":return Db.stop()}},lc)}));return Ed.apply(this,arguments)}function fe(){fe=Dd(regeneratorRuntime.mark(function db(Wb,lc){var Xa,Gb,sc;return regeneratorRuntime.wrap(function(ub){for(;;)switch(ub.prev=ub.next){case 0:return ub.next=2,qb.runCommand('git tag "'.concat(lc,'"'),
{cwd:Wb}).whenDone();case 2:Xa=ub.sent;Gb=Xa.exitCode;sc=Xa.output;if(!Gb){ub.next=7;break}throw Error("git tag failed ".concat(sc));case 7:case "end":return ub.stop()}},db)}));return fe.apply(this,arguments)}function jc(){jc=Dd(regeneratorRuntime.mark(function lc(Wb){var db,Xa,Gb,sc,ub,sb,fa,Db,ab;return regeneratorRuntime.wrap(function(eb){for(;;)switch(eb.prev=eb.next){case 0:return eb.next=2,qb.runCommand("git remote -v | grep origin | head -n 1",{cwd:Wb}).whenDone();case 2:db=eb.sent;Xa=db.exitCode;
Gb=db.output;if(!Xa){eb.next=7;break}throw Error("git remote -v failed ".concat(Gb));case 7:return sc=Gb.split(/[\t\s]/)[1],eb.next=10,qb.runCommand("git branch | grep '*'",{cwd:Wb}).whenDone();case 10:ub=eb.sent;Xa=ub.exitCode;Gb=ub.output;if(!Xa){eb.next=15;break}throw Error("git branch failed ".concat(Gb));case 15:return sb=Gb.trim().replace(/^\*\s*/,""),eb.next=18,qb.$$world.confirm("Push branch ".concat(sb," to ").concat(sc,"?\n"));case 18:fa=eb.sent;if(!fa){eb.next=31;break}eb.next=22;return qb.Terminal.runCommand("git push origin ".concat(sb,
" && git push --tags"),{cwd:Wb});case 22:return Db=eb.sent,eb.next=25,Db.targetMorph.command.whenDone();case 25:ab=eb.sent;Gb=ab.output;Xa=ab.exitCode;if(!Xa){eb.next=30;break}throw Error("git push failed");case 30:Db.close();case 31:case "end":return eb.stop()}},lc)}));return jc.apply(this,arguments)}function Od(){Od=Dd(regeneratorRuntime.mark(function lc(Wb){var db,Xa,Gb,sc;return regeneratorRuntime.wrap(function(ub){for(;;)switch(ub.prev=ub.next){case 0:return ub.next=2,qb.$$world.confirm("Publish to npm?",
["yes","no"]);case 2:db=ub.sent;if(db=!0===db||0===db){ub.next=6;break}return ub.abrupt("return");case 6:return ub.next=8,qb.Terminal.runCommand("npm publish",{cwd:Wb});case 8:return Xa=ub.sent,ub.next=11,Xa.targetMorph.command.whenDone();case 11:Gb=ub.sent;sc=Gb.exitCode;if(!sc){ub.next=16;break}throw Error("npm publish failed");case 16:return ub.next=18,lively.lang.promise.delay(1E3);case 18:Xa.close();case 19:case "end":return ub.stop()}},lc)}));return Od.apply(this,arguments)}bd("default",Sd);
var qb=window.lively.FreezerRuntime.recorderFor("lively.installer/packages/publish-new-package-version.js");qb.interactivelyPublishNewPackageVersion=Sd;qb.confirmPublish=function(ic){return uc.apply(this,arguments)};qb.readConfig=function(ic){return dd.apply(this,arguments)};qb.addNewVersionToConfig=function(ic,Wb,lc,db){return vd.apply(this,arguments)};qb.commitChanges=function(ic){return Ed.apply(this,arguments)};qb.gitTag=function(ic,Wb){return fe.apply(this,arguments)};qb.gitPush=function(ic){return jc.apply(this,
arguments)};qb.publishToNPM=function(ic){return Od.apply(this,arguments)};qb.defaultDirectory=se;qb.runCommand=Rc;qb.Terminal=Cb;qb.resource=ad;qb.World=Ne;qb.$$world=qb.World.defaultWorld();qb["default"]=Sd}}});
System.register(["./__rootModule___commonjs-entry-51a55f66.js","./index-616023be.js","@babel/plugin-syntax-import-meta"],function(bd){var Dd,se,Rc,ad,Ne,Cb,Sd,ve,uc,dd,vd,Ed,fe,jc,Od,qb,ic;return{setters:[function(Wb){Dd=Wb._;se=Wb.t;Rc=Wb.u;ad=Wb.v;Ne=Wb.aY;Cb=Wb.bg;Sd=Wb.k;ve=Wb.ax;uc=Wb.bh;dd=Wb.bi;vd=Wb.bj;Ed=Wb.aQ;fe=Wb.aP;jc=Wb.as},function(Wb){Od=Wb.s;qb=Wb.E;ic=Wb.b},function(){}],execute:function(){function Wb(sb,fa,Db){var ab=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};ab=
ab["package"]||Gb.ObjectPackage.lookupModuleForClass(sb.constructor,ab);if(!ab)throw Error("Object is not part of an object package: ".concat(sb));return ab.addScript(sb,fa,Db)}function lc(sb,fa){fa=Gb.normalizeOptions(fa).System;sb=(sb=sb[Symbol["for"]("lively-module-meta")])?sb["package"].name:null;return(fa=(sb?Gb.lookupPackage(fa,sb):{}).pkg)?!!Gb.ObjectPackage.forSystemPackage(fa):!1}function db(sb,fa){return Xa.apply(this,arguments)}function Xa(){Xa=Dd(regeneratorRuntime.mark(function ab(fa,
Db){var eb,kc,Vb,pb,Nb;return regeneratorRuntime.wrap(function(zb){for(;;)switch(zb.prev=zb.next){case 0:return eb=fa.constructor,Gb.withSuperclasses(eb)[1],eb[Symbol["for"]("lively-module-meta")]["package"].name,kc=Gb.ObjectPackage.lookupPackageForObject(fa),Vb=kc.baseURL,pb=kc.System,zb.next=7,kc.fork(Db,{baseURL:Vb,System:pb});case 7:return Nb=zb.sent,zb.next=10,Gb.obj.adoptObject(fa,Nb.objectClass);case 10:return zb.abrupt("return",Nb.objectClass[Symbol["for"]("__LivelyClassName__")]);case 11:case "end":return zb.stop()}},
ab)}));return Xa.apply(this,arguments)}bd({addScript:Wb,interactivelyForkPackage:db,isObjectClass:lc});var Gb=window.lively.FreezerRuntime.recorderFor("lively.classes/object-classes.js");Gb.globalClasses=function(){return Object.keys(System.global).map(function(sb){sb=System.global[sb];return"function"===typeof sb&&sb.name&&sb}).filter(Boolean)};Gb.normalizeOptions=function(sb){sb=Object.assign({baseURL:Gb.defaultBaseURL,System},sb);sb.baseURL=sb.baseURL.replace(/\/$/,"");return sb};Gb.addScript=
Wb;Gb.isObjectClass=lc;Gb.interactivelyForkPackage=db;Gb.string=se;Gb.Path=Rc;Gb.obj=ad;Gb.isValidIdentifier=Ne;Gb.parseFunction=Cb;Gb.resource=Sd;Gb.runEval=ve;Gb.scripting=Od;Gb.ExportLookup=qb;var sc=Gb.scripting;Gb.ensurePackage=sc.ensurePackage;Gb.registerPackage=sc.registerPackage;Gb.importPackage=sc.importPackage;Gb.lookupPackage=sc.lookupPackage;Gb.module=sc.module;Gb.ImportInjector=sc.ImportInjector;Gb.RuntimeSourceDescriptor=uc;Gb.toJsIdentifier=dd;Gb.withSuperclasses=vd;Gb.classToFunctionTransform=
ic;Gb.objectPackageSym=Symbol["for"]("lively-object-package-data");Gb.defaultBaseURL="local://lively-object-modules";Gb.addScript=Wb;Gb.isObjectClass=lc;Gb._packageStore=Gb._packageStore||{};Gb.interactivelyForkPackage=db;sc=bd("default",function(){function sb(fa,Db){fe(this,sb);this._id=fa;this.options=Gb.normalizeOptions(Db)}Ed(sb,null,[{key:"lookupPackageForObject",value:function(fa,Db){return this.lookupPackageForClass(fa.constructor,Db)}},{key:"lookupPackageForClass",value:function(fa,Db){Db=
Gb.normalizeOptions(Db).System;fa=(fa=fa[Symbol["for"]("lively-module-meta")])?fa["package"].name:null;return(Db=(fa?Gb.lookupPackage(Db,fa):{}).pkg)?Gb.ObjectPackage.forSystemPackage(Db):null}},{key:"lookupModuleForClass",value:function(fa,Db){var ab=Gb.normalizeOptions(Db);ab.System;Db=this.lookupPackageForClass(fa,Db);fa=fa[Symbol["for"]("lively-module-meta")];return new Gb.ObjectModule(fa.pathInPackage,Db)}},{key:"forSystemPackage",value:function(fa){return this.packageStore[fa.name]}},{key:"withId",
value:function(fa,Db){return this.packageStore[fa]||(this.packageStore[fa]=new this(fa,Db))}},{key:"packageStore",get:function(){return this._packageStore||(this._packageStore=Gb._packageStore)}}]);Ed(sb,[{key:"ensureSubModule",value:function(){var fa=Dd(regeneratorRuntime.mark(function ab(){var eb,kc,Vb=arguments;return regeneratorRuntime.wrap(function(pb){for(;;)switch(pb.prev=pb.next){case 0:return eb=0<Vb.length&&void 0!==Vb[0]?Vb[0]:"index",kc=new Gb.ObjectModule(eb,this),pb.next=4,kc.ensureExistance();
case 4:return pb.abrupt("return",kc);case 5:case "end":return pb.stop()}},ab,this)}));return function(){return fa.apply(this,arguments)}}()},{key:"resource",value:function(){var fa=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return Gb.resource(this.packageURL).join(fa)}},{key:"load",value:function(){return Gb.importPackage(this.System,this.packageURL)}},{key:"ensureExistance",value:function(){var fa=Dd(regeneratorRuntime.mark(function ab(){var eb,kc,Vb,pb,Nb,zb,rb;return regeneratorRuntime.wrap(function(Ib){for(;;)switch(Ib.prev=
Ib.next){case 0:return eb=this.resource("/"),Ib.next=3,eb.exists();case 3:if(!Ib.sent){Ib.next=5;break}return Ib.abrupt("return");case 5:return kc=[{resource:eb}],Vb=[{resource:this.resource("package.json"),content:JSON.stringify(this.config,null,2)}],Ib.next=9,Promise.all(kc.map(function(da){return da.resource.mkdir()}));case 9:return Ib.next=11,Promise.all(Vb.map(function(){var da=Dd(regeneratorRuntime.mark(function Fa(va){return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=
2,va.resource.exists();case 2:M.t0=!M.sent;if(!M.t0){M.next=7;break}M.next=6;return va.resource.write(va.content);case 6:M.t0=M.sent;case 7:return M.abrupt("return",M.t0);case 8:case "end":return M.stop()}},Fa)}));return function(va){return da.apply(this,arguments)}}()));case 11:return Ib.next=13,this.objectModule.ensureExistance();case 13:return pb=this.System,Nb=this.packageURL,zb=this.config,Ib.next=16,Gb.ensurePackage(pb,Nb);case 16:return rb=Ib.sent,rb.registerWithConfig(zb),console.log("".concat(this.packageURL,
" REGISTERED")),Ib.abrupt("return",this);case 20:case "end":return Ib.stop()}},ab,this)}));return function(){return fa.apply(this,arguments)}}()},{key:"ensureObjectClass",value:function(){var fa=Dd(regeneratorRuntime.mark(function eb(ab){return regeneratorRuntime.wrap(function(kc){for(;;)switch(kc.prev=kc.next){case 0:return kc.next=2,this.ensureExistance();case 2:return kc.abrupt("return",this.objectModule.ensureObjectClass(ab));case 3:case "end":return kc.stop()}},eb,this)}));return function(ab){return fa.apply(this,
arguments)}}()},{key:"adoptObject",value:function(){var fa=Dd(regeneratorRuntime.mark(function eb(ab){var kc;return regeneratorRuntime.wrap(function(Vb){for(;;)switch(Vb.prev=Vb.next){case 0:if(this.objectClass!==ab.constructor){Vb.next=2;break}return Vb.abrupt("return");case 2:return Vb.next=4,this.ensureObjectClass(ab.constructor);case 4:kc=Vb.sent,Gb.obj.adoptObject(ab,kc);case 6:case "end":return Vb.stop()}},eb,this)}));return function(ab){return fa.apply(this,arguments)}}()},{key:"addScript",
value:function(fa,Db,ab){return this.objectModule.addScript(fa,Db,ab)}},{key:"remove",value:function(){this.systemPackage.remove();delete Gb.ObjectPackage.packageStore[this.id];return this.resource().remove()}},{key:"renameObjectClass",value:function(){var fa=Dd(regeneratorRuntime.mark(function eb(ab){var kc,Vb,pb,Nb,zb,rb,Ib,da,ka,va=arguments;return regeneratorRuntime.wrap(function(Fa){for(;;)switch(Fa.prev=Fa.next){case 0:kc=1<va.length&&void 0!==va[1]?va[1]:[];Vb=this.objectClass;pb=this.System;
if(Vb&&Vb[Symbol["for"]("__LivelyClassName__")]!==ab){Fa.next=4;break}return Fa.abrupt("return",Vb);case 4:if(Gb.isValidIdentifier(ab)){Fa.next=6;break}throw Error("".concat(ab," is not a valid name for a class"));case 6:return Nb=Gb.RuntimeSourceDescriptor["for"](Vb,pb),zb=Nb.source,rb=Nb.ast.id,Ib=rb.start,da=rb.end,Fa.next=10,Nb.changeSource(zb.slice(0,Ib)+ab+zb.slice(da));case 10:return ka=this.objectClass,kc.forEach(function(M){M.constructor=ka;M.__proto__=ka.prototype}),Fa.abrupt("return",ka);
case 13:case "end":return Fa.stop()}},eb,this)}));return function(ab){return fa.apply(this,arguments)}}()},{key:"fork",value:function(){var fa=Dd(regeneratorRuntime.mark(function kc(ab,eb){var Vb,pb,Nb,zb,rb,Ib,da,ka;return regeneratorRuntime.wrap(function(va){for(;;)switch(va.prev=va.next){case 0:return Vb=this.System,pb=this.baseURL,Nb=this.objectClass,eb=Object.assign({System:Vb,baseURL:pb},eb),zb=Gb.RuntimeSourceDescriptor["for"](Nb),rb=zb._renamedSource(ab),Ib=rb.moduleSource,da=Gb.ObjectPackage.withId(ab,
eb),va.next=7,da.ensureExistance();case 7:return ka=da.objectModule.systemModule,va.next=10,ka.load({format:"esm"});case 10:return va.next=12,ka.changeSource(Ib);case 12:return va.abrupt("return",da);case 13:case "end":return va.stop()}},kc,this)}));return function(ab,eb){return fa.apply(this,arguments)}}()},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this.id}},{key:"System",get:function(){return this.options.System}},{key:"baseURL",get:function(){return this.options.baseURL}},
{key:"packageURL",get:function(){return this.baseURL+"/".concat(this.id)}},{key:"config",get:function(){return{name:this.name,version:"0.1.0",lively:{isObjectPackage:!0}}}},{key:"systemPackage",get:function(){return Gb.lookupPackage(this.System,this.packageURL,!0).pkg}},{key:"objectModule",get:function(){return this._objectModule||(this._objectModule=new Gb.ObjectModule("index.js",this))}},{key:"objectClass",get:function(){return this.objectModule.objectClass}}]);return sb}());Gb.ObjectPackage=sc;
var ub=function(){function sb(fa,Db){fe(this,sb);if(!fa)throw Error("ObjectModule needs package!");if(!Db)throw Error("ObjectModule needs package!");this._moduleName=fa;this._objectPackage=Db}Ed(sb,[{key:"read",value:function(){return this.resource.read()}},{key:"write",value:function(fa){return this.resource.write(fa)}},{key:"ensureExistance",value:function(){var fa=Dd(regeneratorRuntime.mark(function ab(){var eb;return regeneratorRuntime.wrap(function(kc){for(;;)switch(kc.prev=kc.next){case 0:return eb=
this.resource,kc.next=3,eb.exists();case 3:if(kc.sent){kc.next=7;break}kc.next=6;return eb.write("'format esm';\n");case 6:this.System.config({meta:jc({},this.url,{format:"esm"})});case 7:return kc.abrupt("return",this);case 8:case "end":return kc.stop()}},ab,this)}));return function(){return fa.apply(this,arguments)}}()},{key:"adoptObject",value:function(){var fa=Dd(regeneratorRuntime.mark(function kc(ab,eb){var Vb;return regeneratorRuntime.wrap(function(pb){for(;;)switch(pb.prev=pb.next){case 0:if(this.objectClass!==
ab.constructor){pb.next=2;break}return pb.abrupt("return");case 2:return pb.next=4,this.ensureObjectClass(ab.constructor,eb);case 4:Vb=pb.sent,Gb.obj.adoptObject(ab,Vb);case 6:case "end":return pb.stop()}},kc,this)}));return function(ab,eb){return fa.apply(this,arguments)}}()},{key:"ensureObjectClass",value:function(fa,Db){var ab=this,eb=this.objectClass;return eb&&eb.prototype.__proto__===fa.prototype?eb:Promise.resolve(this.ensureObjectClassSource(fa,Db)).then(function(kc){var Vb=kc.source,pb=kc.moduleId,
Nb=kc.className,zb=kc.bindings,rb=ab.System;kc=Gb.module(rb,pb);if(zb)for(var Ib in zb)kc.define(Ib,zb[Ib]);Vb=Gb.runEval(Vb,{classTransform:Gb.classToFunctionTransform,sync:!0,targetModule:pb,System:rb});if(Vb.isError)throw Vb.value;Vb=kc.recorder[Nb];if(!Vb)throw Error("Failed to define class ".concat(Nb," in ").concat(pb));return Vb})}},{key:"ensureObjectClassSource",value:function(fa,Db){return this.createDefaultClassDeclaration(fa,Db)}},{key:"createDefaultClassDeclaration",value:function(){var fa=
Dd(regeneratorRuntime.mark(function ab(){var eb,kc,Vb,pb,Nb,zb,rb,Ib,da,ka,va,Fa,M,Aa,wb=arguments;return regeneratorRuntime.wrap(function(Na){for(;;)switch(Na.prev=Na.next){case 0:eb=0<wb.length&&void 0!==wb[0]?wb[0]:Object;kc=1<wb.length&&void 0!==wb[1]?wb[1]:!1;Vb=this.System;pb=this.systemModule;Nb=this.objectPackage;kc=kc||Gb.string.capitalize(Gb.toJsIdentifier(Nb.id));zb=eb[Symbol["for"]("__LivelyClassName__")]||eb.name;rb=!zb||"anonymous_class"==zb;Ib=Gb.globalClasses().includes(eb);da="";
ka=null;if(!rb){Na.next=15;break}zb="__anonymous_superclass__";ka=jc({},zb,eb);da+="let __anonymous_superclass__ = __anonymous_superclass__;\n";Na.next=20;break;case 15:if(Ib){Na.next=20;break}Na.next=18;return Gb.ExportLookup.findExportOfValue(eb,Vb);case 18:(va=Na.sent)?(Fa=Gb.ImportInjector.run(Vb,pb.id,pb["package"](),"",va),M=Fa.standaloneImport,da+=M+"\n\n"):ka=jc({},zb,eb);case 20:kc===zb&&(kc="Object"+kc);Aa="Object"===zb?"class ".concat(kc," {}\n"):"class ".concat(kc," extends ").concat(zb,
" {}\n");da+="export default ".concat(Aa,"\n");if(pb.isLoaded()){Na.next=27;break}Na.next=26;return pb.setSource('"format esm";');case 26:rb&&(pb.recorder[zb]=eb);case 27:return Na.next=29,pb.changeSource(da);case 29:return Na.next=31,pb.load();case 31:return Na.abrupt("return",{source:da,className:kc,moduleId:this.url,bindings:ka});case 32:case "end":return Na.stop()}},ab,this)}));return function(){return fa.apply(this,arguments)}}()},{key:"addScript",value:function(){var fa=Dd(regeneratorRuntime.mark(function Vb(ab,
eb,kc){var pb,Nb,zb,rb,Ib,da,ka,va,Fa,M,Aa,wb,Na,hb;return regeneratorRuntime.wrap(function(Bb){for(;;)switch(Bb.prev=Bb.next){case 0:if(ab.constructor!==this.objectClass){Bb.next=4;break}Bb.t0=ab.constructor;Bb.next=7;break;case 4:return Bb.next=6,this.ensureObjectClass(ab.constructor);case 6:Bb.t0=Bb.sent;case 7:pb=Bb.t0;Nb="function"===typeof eb?String(eb):eb;zb=Gb.parseFunction(Nb);rb=Gb.RuntimeSourceDescriptor["for"](pb,this.System);kc||(kc=Gb.Path("id.name").get(zb));if(kc){Bb.next=14;break}throw Error("No name, cannot add ".concat(Gb.string.truncate(Nb,
30).replace(/\n/g,""),"!"));case 14:Ib=Gb.toJsIdentifier(kc);console.assert("FunctionExpression"===zb.type||"ArrowFunctionExpression"===zb.type,"not a function expression but: "+zb.type);da=zb.params.map(function(ba){return Nb.slice(ba.start,ba.end)});ka="BlockStatement"===zb.body.type?Nb.slice(zb.body.start,zb.body.end):"{ return ".concat(Nb.slice(zb.body.start,zb.body.end)," }");va="".concat(Ib,"(").concat(da.join(","),") ").concat(ka);"ArrowFunctionExpression"===zb.type&&(zb.type="FunctionExpression");
Fa=rb.source;if(M=rb.ast){Bb.next=24;break}throw Error("cannot find class decl of "+rb.module.id);case 24:return(Aa=M.body.body.find(function(ba){return ba.key.name===Ib&&!ba["static"]}))?Fa=Fa.slice(0,Aa.start)+va+Fa.slice(Aa.end):(wb=Fa.lastIndexOf("}"),Na=Fa.slice(0,wb),hb=Fa.slice(wb),/\n\s*$/m.test(Na)||(Na+="\n"),va=Gb.string.changeIndent(va,"  ",1),/^[ ]*\n/m.test(hb)||(hb="\n"+hb),Fa=Na+va+hb),Bb.next=28,rb.changeSource(Fa);case 28:return Bb.abrupt("return",{script:pb.prototype[Ib],klass:pb,
module:rb.module.id,methodName:Ib});case 29:case "end":return Bb.stop()}},Vb,this)}));return function(ab,eb,kc){return fa.apply(this,arguments)}}()},{key:"objectPackage",get:function(){return this._objectPackage}},{key:"objectClass",get:function(){var fa=this.systemModule;return fa.isLoaded()?fa.System.get(fa.id)["default"]:null}},{key:"moduleName",get:function(){return this._moduleName}},{key:"systemModule",get:function(){return Gb.module(this.System,this.url)}},{key:"System",get:function(){return this.objectPackage.System}},
{key:"resource",get:function(){return this.objectPackage.resource(this.moduleName)}},{key:"url",get:function(){return this.resource.url}}]);return sb}();Gb.ObjectModule=ub;Gb["default"]=sc}}});
System.register("./__rootModule___commonjs-entry-51a55f66.js ./canvas-2fd3d40b.js lively.collab ./index-61952933.js ./index-616023be.js ./loading-indicator.cp-98e470a2.js ./ui.cp-8dfc076f.js ./messages.cp-817cc06d.js rollup @rollup/plugin-json ./list.cp-840d1cf8.js ./editor-plugin-5397d87c.js ./popups.cp-5b9fb681.js ./helpers-94ca076d.js @rollup/plugin-commonjs rollup-plugin-polyfill-node ./index-42118cd5.js ./user-ui-98206202.js ./tooltips.cp-3c41b378.js".split(" "),function(bd,Dd){var se,Rc,ad,
Ne,Cb,Sd,ve,uc,dd,vd,Ed,fe,jc,Od,qb,ic,Wb,lc,db,Xa,Gb,sc,ub,sb,fa,Db,ab,eb,kc,Vb,pb,Nb,zb,rb,Ib,da,ka,va,Fa,M,Aa,wb,Na,hb,Bb,ba,dc,la,Fb,vb,Ia,xb,Rb,yc,id,ob,Pb,tb,xc,Pc,nd,Id,Hb,Kd,vc,Qc,kb,Cc,zc,Fc,xd,Uc,Md,Ob,Le,We,xe,Fg,Zc,rd,ti,dg,Of,mg,wf,mf,Mb,gd,Vd,sf,hg,bh,Qf,he,Uf,$g,Ta,th,Be,cb,Yb,de,P,pa,wa,Ea,ia,Ca,w,ma,ua,ha,ra,mb,E,R,Ya,gb,$b,Sc,Ic,Pd,Zd,ge,Ce,$e,pf,ig,Xf,Vg,Re,ae,Sb,Hd,hf,zf,Gg,vg,tg,pd,Z,Ga,fb,ya,tc,Mc,Cd,Ee,bf,Oe,Fe,Pf,eg;return{setters:[function(be){se=be.I;Rc=be._;ad=be.b;Ne=be.C;
Cb=be.r;Sd=be.T;ve=be.e;uc=be.S;dd=be.H;vd=be.f;Ed=be.g;fe=be.L;jc=be.h;Od=be.c;qb=be.j;ic=be.p;Wb=be.k;lc=be.l;db=be.i;Xa=be.m;Gb=be.n;sc=be.o;ub=be.q;sb=be.s;fa=be.t;Db=be.u;ab=be.v;eb=be.w;kc=be.x;Vb=be.y;pb=be.z;Nb=be.A;zb=be.B;rb=be.D;Ib=be.E;da=be.F;ka=be.G;va=be.J;Fa=be.K;M=be.N;Aa=be.O;wb=be.Q;Na=be.R;hb=be.U;Bb=be.V;ba=be.X;dc=be.Y;la=be.Z;Fb=be.$;vb=be.a0;Ia=be.a1;xb=be.a2;Rb=be.a3;yc=be.a4;id=be.a5;ob=be.a;Pb=be.a6;tb=be.a7;xc=be.a8;Pc=be.a9;nd=be.d;Id=be.aa;Hb=be.ab;Kd=be.ac;vc=be.ad;
Qc=be.ae;kb=be.af;Cc=be.W;zc=be.ag;Fc=be.M;xd=be.ah;Uc=be.ai;Md=be.aj;Ob=be.ak;Le=be.al;We=be.am;xe=be.an;Fg=be.ao;Zc=be.ap;rd=be.aq;ti=be.ar;dg=be.as;Of=be.at;mg=be.au;wf=be.av;mf=be.aw;Mb=be.ax;gd=be.ay;Vd=be.az;sf=be.aA;hg=be.aB;bh=be.aC;Qf=be.aD;he=be.aE;Uf=be.aF;$g=be.aG;Ta=be.aH},function(be){th=be.C},function(be){Be=be.CommentData;cb=be.CommentBrowser},function(be){Yb=be.L;de=be.A;P=be.R;pa=be.G;wa=be.I;Ea=be.W;ia=be.F;Ca=be.P;w=be.M;ma=be.p;ua=be.a},function(be){ha=be.P;ra=be.m;mb=be.d;E=
be.c;R=be.G;Ya=be.a;gb=be.B},function(be){$b=be.D;Sc=be.L;Ic=be.B},function(be){Pd=be.s;Zd=be.a;ge=be.r;Ce=be.H;$e=be.M;pf=be.P;ig=be.G;Xf=be.F},function(be){Vg=be.StatusMessageDefault;Re=be.StatusMessageConfirm;ae=be.StatusMessageError},function(be){Sb=be.rollup},function(be){Hd=be["default"]},function(be){hf=be.D;zf=be.a},function(be){Gg=be["default"]},function(be){vg=be.S;tg=be.a},function(be){pd=be.f;Z=be.g;Ga=be.b;fb=be.R;ya=be.a;tc=be.i;Mc=be.c;Cd=be.t;Ee=be.w},function(be){bf=be["default"]},
function(be){Oe=be["default"]},function(be){Fe=be.localInterface},function(be){Pf=be.UserUI},function(be){eg=be.SystemTooltip}],execute:function(){function be(){}function v(Tc,td,hd){return oa.apply(this,arguments)}function oa(){oa=Rc(regeneratorRuntime.mark(function Sa(td,hd,aa){var Ma;return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:if(!hd.startsWith("image/")){jb.next=5;break}jb.next=3;return K.fileReadAsDataURL(td);case 3:return Ma=jb.sent,jb.abrupt("return",new K.Image({imageUrl:Ma,
autoResize:!0,name:td.name}));case 5:return jb.abrupt("return",null);case 6:case "end":return jb.stop()}},Sa)}));return oa.apply(this,arguments)}function Oc(){Oc=Rc(regeneratorRuntime.mark(function hd(td){return regeneratorRuntime.wrap(function(aa){for(;;)switch(aa.prev=aa.next){case 0:return aa.next=2,System.normalize(td);case 2:return aa.abrupt("return",aa.sent);case 3:case "end":return aa.stop()}},hd)}));return Oc.apply(this,arguments)}function Tb(Tc){return Ba.module(Tc)["package"]()}function ne(){ne=
Rc(regeneratorRuntime.mark(function hd(td){var aa;return regeneratorRuntime.wrap(function(Sa){for(;;)switch(Sa.prev=Sa.next){case 0:if("@empty"!==td){Sa.next=2;break}return Sa.abrupt("return","");case 2:return Sa.prev=2,Sa.next=5,Ba.resource(td).read();case 5:aa=Sa.sent;Sa.next=13;break;case 8:return Sa.prev=8,Sa.t0=Sa["catch"](2),Sa.next=12,Ba.resource(td).makeProxied().read();case 12:aa=Sa.sent;case 13:return Sa.abrupt("return",aa);case 14:case "end":return Sa.stop()}},hd,null,[[2,8]])}));return ne.apply(this,
arguments)}function Ye(Tc,td){switch(Tc.code){case "THIS_IS_UNDEFINED":case "EVAL":case "MODULE_LEVEL_DIRECTIVE":return}td(Tc)}function Kf(Tc){var td,hd,aa,Sa=new pc.LivelyRollup(Tc);Tc=Tc.map;var Ma=void 0===Tc?{}:Tc;return{name:"rollup-plugin-lively",buildStart:function(){return Sa.buildStart(this)},resolveId:function(){var jb=Rc(regeneratorRuntime.mark(function Kc(gc,ac){var md;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=ud.next){case 0:if(!gc.startsWith("\x00")){ud.next=
2;break}return ud.abrupt("return",null);case 2:if(!pc.isBuiltin(gc,Sa.resolver)&&!gc.includes("rollupPluginBabelHelpers.js")){ud.next=4;break}return ud.abrupt("return",null);case 4:return ud.next=6,Sa.resolveId(Ma[gc]||gc,ac);case 6:return md=ud.sent,ud.abrupt("return",md);case 8:case "end":return ud.stop()}},Kc)}));return function(gc,ac){return jb.apply(this,arguments)}}(),resolveDynamicImport:function(){var jb=Rc(regeneratorRuntime.mark(function Kc(gc,ac){var md;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=
ud.next){case 0:if("string"!==typeof gc||!pc.isBuiltin(gc,Sa.resolver)){ud.next=2;break}return ud.abrupt("return",gc.replace("node:",""));case 2:return ud.next=4,Sa.resolveDynamicImport(gc,ac);case 4:return md=ud.sent,ud.abrupt("return",md);case 6:case "end":return ud.stop()}},Kc)}));return function(gc,ac){return jb.apply(this,arguments)}}(),load:function(jb){if(jb.startsWith("\x00")||pc.isBuiltin(jb,Sa.resolver)||pc.isCommonJsModule(jb))return null;try{return Sa.load(jb)}catch(Jb){return null}},
transform:function(){var jb=Rc(regeneratorRuntime.mark(function Kc(gc,ac){return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=md.next){case 0:if(!ac.startsWith("\x00")){md.next=2;break}return md.abrupt("return",null);case 2:return md.prev=2,md.next=5,Sa.transform(gc,ac);case 5:return md.abrupt("return",md.sent);case 8:return md.prev=8,md.t0=md["catch"](2),md.abrupt("return",null);case 11:case "end":return md.stop()}},Kc,null,[[2,8]])}));return function(gc,ac){return jb.apply(this,arguments)}}(),
buildEnd:function(){return Rc(regeneratorRuntime.mark(function Jb(){return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=gc.next){case 0:return gc.next=2,Sa.generateGlobals();case 2:pc.__inter0__=gc.sent,aa=pc.__inter0__.code,td=pc.__inter0__.globals,hd=pc.__inter0__.importMap;case 6:case "end":return gc.stop()}},Jb)}))()},options:function(jb){if(Sa.snapshot||Sa.autoRun)Sa.rootModuleId=jb.input,delete jb.input;0<Sa.excludedModules.length&&(jb.shimMissingExports=!0);jb.onwarn||(jb.onwarn=
function(Kc,md){return pc.customWarn(Kc,md)});jb.plugins=[].concat(Xa(Sa.resolver.supportingPlugins(Sa.asBrowserModule?"browser":"node")),Xa(jb.plugins));var Jb=M(jb.plugins),gc;try{for(Jb.s();!(gc=Jb.n()).done;){var ac=gc.value;"rollup-plugin-lively"!==ac.name&&ac.options&&(jb=ac.options.bind(this)(jb)||jb)}}catch(Kc){Jb.e(Kc)}finally{Jb.f()}return jb},outputOptions:function(jb){if(jb.globals)if(pc.obj.isFunction(jb.globals)){var Jb=jb.globals;jb.globals=function(gc){return td[gc]||Jb(gc)}}else jb.globals=
Object.assign({},jb.globals,{},td);return jb},renderDynamicImport:function(){Sa.hasDynamicImports=!0;return null},generateBundle:function(jb,Jb,gc){var ac=this;return Rc(regeneratorRuntime.mark(function md(){return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=ud.next){case 0:return ud.next=2,Sa.generateBundle(ac,Jb,aa,hd,jb);case 2:case "end":return ud.stop()}},md)}))()}}}function jg(){jg=Rc(regeneratorRuntime.mark(function aa(td,hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md=arguments;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=
ud.next){case 0:return Sa=2<md.length&&void 0!==md[2]?md[2]:"Freeze Part",Ma=3<md.length&&void 0!==md[3]?md[3]:!1,jb=Dc.part(Dc.FreezerPrompt,{submorphs:[{name:"prompt title",textAndAttributes:[Sa,null]}]}),Jb=$world.getCurrentUser().name,gc=Ma||Dc.Path("metadata.excludedPackages").get(td)||Dc.DEFAULT_EXCLUDED_MODULES,ac=Dc.Path("metadata.publishedLocation").get(td)||Dc.resource(System.baseURL).join("users").join(Jb).join("published").join(td.name||Dc.BrowserResolver.resolvePackage(td).name).url,
ud.next=8,$world.withRequesterDo(hd,function(){var oe=Rc(regeneratorRuntime.mark(function Me(Ue){return regeneratorRuntime.wrap(function(xf){for(;;)switch(xf.prev=xf.next){case 0:return jb.isModuleBundle="string"===typeof td,jb.isModuleBundle&&hd.isBrowser&&(jb.mainCandidates=hd.renderedCodeEntities().filter(function(lf){return"function-decl"===lf.type}).map(function(lf){return lf.name})),jb.excludedPackages=gc,jb.directory=ac,jb.openInWorld(),xf.next=7,jb.whenRendered();case 7:return jb.center=Ue,
xf.next=10,jb.activate();case 10:Kc=xf.sent;case 11:case "end":return xf.stop()}},Me)}));return function(Ue){return oe.apply(this,arguments)}}());case 8:return ud.abrupt("return",Kc);case 9:case "end":return ud.stop()}},aa)}));return jg.apply(this,arguments)}function Og(Tc,td){return te.apply(this,arguments)}function te(){te=Rc(regeneratorRuntime.mark(function aa(td,hd){var Sa,Ma,jb,Jb,gc,ac;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=Kc.next){case 0:Sa=hd.exclude;Ma=void 0===
Sa?[]:Sa;jb=hd.useTerser;if(!td.isMorph){Kc.next=7;break}Kc.next=4;return Dc.createMorphSnapshot(td,{frozenSnapshot:!0});case 4:Kc.t0=Kc.sent;Kc.next=8;break;case 7:Kc.t0=td;case 8:return Jb=Kc.t0,Dc.transpileAttributeConnections(Jb),gc=Kf({excludedModules:Ma,snapshot:Jb,useTerser:jb,resolver:Dc.BrowserResolver}),Kc.next=13,Dc.rollup({plugins:[gc,Dc.jsonPlugin()]});case 13:return ac=Kc.sent,Kc.next=16,ac.generate({globalName:"frozenPart",format:"system",plugins:[gc]});case 16:return Kc.abrupt("return",
Kc.sent);case 17:case "end":return Kc.stop()}},aa)}));return te.apply(this,arguments)}function Eh(Tc,td){return $h.apply(this,arguments)}function $h(){$h=Rc(regeneratorRuntime.mark(function aa(td,hd){var Sa,Ma,jb,Jb,gc,ac;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=Kc.next){case 0:return Sa=hd.exclude,Ma=void 0===Sa?[]:Sa,jb=hd.mainFunction,Jb=hd.htmlConfig,gc=hd.useTerser,Kc.next=3,Dc.rollup({input:td,plugins:[Kf({excludedModules:Ma,mainFunction:jb,useTerser:gc,resolver:Dc.BrowserResolver,
autoRun:Jb}),Dc.jsonPlugin()]});case 3:return ac=Kc.sent,Kc.next=6,ac.generate({format:"system"});case 6:return Kc.abrupt("return",Kc.sent);case 7:case "end":return Kc.stop()}},aa)}));return $h.apply(this,arguments)}function Gi(Tc,td,hd){return Ng.apply(this,arguments)}function Ng(){Ng=Rc(regeneratorRuntime.mark(function Sa(td,hd,aa){var Ma,jb,Jb,gc=arguments;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return Ma=3<gc.length&&void 0!==gc[3]?gc[3]:{},jb=Kf({includePolyfills:!1,
redirect:Ma,resolver:Dc.BrowserResolver,excludedModules:["babel-plugin-transform-jsx"]}),ac.next=4,Dc.rollup({input:td,plugins:[jb,Dc.jsonPlugin()]});case 4:return Jb=ac.sent,ac.next=7,Jb.generate({globalName:aa,format:"system",plugins:[jb]});case 7:case "end":return ac.stop()}},Sa)}));return Ng.apply(this,arguments)}function Ii(Tc,td){return fi.apply(this,arguments)}function fi(){fi=Rc(regeneratorRuntime.mark(function aa(td,hd){var Sa,Ma,jb,Jb=arguments;return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=
gc.next){case 0:return Sa=2<Jb.length&&void 0!==Jb[2]?Jb[2]:!0,Ma=3<Jb.length?Jb[3]:void 0,gc.next=4,Dc.rollup({input:td,plugins:[Kf({asBrowserModule:Sa,resolver:Dc.BrowserResolver,excludedModules:["babel-plugin-transform-jsx"]}),Dc.jsonPlugin()]});case 4:return jb=gc.sent,gc.next=7,jb.generate({format:"system",globalName:Ma});case 7:case "end":return gc.stop()}},aa)}));return fi.apply(this,arguments)}function Ji(Tc){return gi.apply(this,arguments)}function gi(){gi=Rc(regeneratorRuntime.mark(function hd(td){var aa,
Sa,Ma,jb,Jb,gc,ac,Kc,md;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=ud.next){case 0:return aa=td.getCurrentUser().name,Sa=td.metadata.commit.name,ud.next=4,Dc.resource(System.baseURL).join("users").join(aa).join("published/").ensureExistance();case 4:return Ma=ud.sent,ud.t0=Dc,ud.next=8,Dc.defaultDirectory();case 8:ud.t1=ud.sent,ud.t2=aa,jb=ud.t0.resource.call(ud.t0,ud.t1).join("..").join("users").join(ud.t2).join("published/").withRelativePartsResolved().asDirectory(),Jb=Ma.join(Sa+
"/");case 12:return ud.next=14,Jb.exists();case 14:if(!ud.sent){ud.next=28;break}ud.next=17;return $world.confirm('A world published as "'.concat(Sa,'" already exists.\nDo you want to overwrite this publication?'),{rejectLabel:"CHANGE NAME"});case 17:gc=ud.sent;if(!gc){ud.next=20;break}return ud.abrupt("break",28);case 20:return ud.next=22,$world.prompt("Please enter a different name for this published world:");case 22:if(Sa=ud.sent){ud.next=25;break}return ud.abrupt("return");case 25:Jb=Ma.join(Sa+
"/");ud.next=12;break;case 28:return ud.next=30,Jb.ensureExistance();case 30:return ac=Dc.clearWorldSnapshot(Dc.serializeMorph(td)),ud.prev=31,ud.next=34,Dc.bundlePart(ac,{compress:!0,exclude:Dc.DEFAULT_EXCLUDED_MODULES_WORLD});case 34:Kc=ud.sent;Kc.part=td;ud.next=41;break;case 38:throw ud.prev=38,ud.t3=ud["catch"](31),ud.t3;case 41:return md=Dc.LoadingIndicator.open("Freezing World",{status:"Writing files..."}),ud.next=44,Dc.writeFiles(Kc,md,{dir:Jb,shell:jb,resolver:Dc.BrowserResolver});case 44:case "end":return ud.stop()}},
hd,null,[[31,38]])}));return gi.apply(this,arguments)}function xj(Tc){return yg.apply(this,arguments)}function yg(){yg=Rc(regeneratorRuntime.mark(function hd(td){var aa,Sa,Ma,jb,Jb,gc,ac,Kc=arguments;return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=md.next){case 0:return aa=1<Kc.length&&void 0!==Kc[1]?Kc[1]:!1,md.next=3,Dc.promptForFreezing(td,aa,"Freeze Part");case 3:if(Sa=md.sent){md.next=6;break}return md.abrupt("return");case 6:return md.next=8,Dc.resource(System.baseURL).join(Sa.location).asDirectory().ensureExistance();
case 8:return Ma=md.sent,md.t0=Dc,md.next=12,Dc.defaultDirectory();case 12:return md.t1=md.sent,md.t2=Sa.location,jb=md.t0.resource.call(md.t0,md.t1).join("..").join(md.t2).withRelativePartsResolved().asDirectory(),td.changeMetaData("excludedPackages",Sa.excludedPackages,!0,!1),td.changeMetaData("publishedLocation",Sa.location,!0,!1),td.isWorld&&(Jb=Dc.clearWorldSnapshot(Dc.serializeMorph(td))),md.prev=18,md.next=21,Dc.bundlePart(Jb||td,{compress:!0,useTerser:Sa.useTerser,exclude:Sa.excludedPackages,
requester:!1});case 21:gc=md.sent;gc.part=td;md.next=28;break;case 25:throw md.prev=25,md.t3=md["catch"](18),md.t3;case 28:return ac=Dc.LoadingIndicator.open("Freezing Part",{status:"Writing files..."}),md.next=31,Dc.writeFiles(gc,ac,{dir:Ma,shell:jb,resolver:Dc.BrowserResolver});case 31:case "end":return md.stop()}},hd,null,[[18,25]])}));return yg.apply(this,arguments)}function Ti(Tc,td){return ke.apply(this,arguments)}function ke(){ke=Rc(regeneratorRuntime.mark(function aa(td,hd){var Sa,Ma,jb,Jb,
gc,ac,Kc,md,ud,oe,ze,Ue;return regeneratorRuntime.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return Me.next=2,Dc.resource(td).read();case 2:Sa=Me.sent;Ma=Dc.topLevelDeclsAndRefs(Dc.parse(Sa));jb=Ma.varDecls;Jb=jb.find(function(xf){return"EXCLUDED_MODULES"===Dc.Path("declarations.0.id.name").get(xf)});gc=jb.find(function(xf){return"TITLE"===Dc.Path("declarations.0.id.name").get(xf)});ac=Dc.DEFAULT_EXCLUDED_MODULES;Kc=td;try{ac=eval(Dc.stringify(Jb.declarations[0].init)),Kc=eval(Dc.stringify(gc.declarations[0].init))}catch(xf){}Me.next=
11;return Dc.promptForFreezing(td,hd,"Freeze Module",ac);case 11:if(md=Me.sent){Me.next=14;break}return Me.abrupt("return");case 14:return Me.next=16,Dc.resource(System.baseURL).join(md.location).asDirectory().ensureExistance();case 16:return ud=Me.sent,Me.t0=Dc,Me.next=20,Dc.defaultDirectory();case 20:return Me.t1=Me.sent,Me.t2=md.location,oe=Me.t0.resource.call(Me.t0,Me.t1).join("..").join(Me.t2).withRelativePartsResolved().asDirectory(),Me.prev=23,Me.next=26,Dc.bundleModule(td,{compress:!0,useTerser:md.useTerser,
exclude:md.excludedPackages,htmlConfig:{title:Kc},requester:hd});case 26:ze=Me.sent;Me.next=32;break;case 29:throw Me.prev=29,Me.t3=Me["catch"](23),Me.t3;case 32:return Ue=Dc.LoadingIndicator.open("Freezing Module",{status:"Writing files..."}),Me.next=35,Dc.writeFiles(ze,Ue,{dir:ud,shell:oe,resolver:Dc.BrowserResolver});case 35:case "end":return Me.stop()}},aa,null,[[23,29]])}));return ke.apply(this,arguments)}function Mg(){Mg=Rc(regeneratorRuntime.mark(function td(){var hd,aa,Sa;return regeneratorRuntime.wrap(function(Ma){for(;;)switch(Ma.prev=
Ma.next){case 0:System.set("@lively-worker",System.newModule(kd.initWorker()));case 1:return Ma.next=3,kd.promise.delay(1E3);case 3:aa={};for(Sa in System._loader.modules)if(Sa.includes("local://")||Sa.includes("lively://"))aa[Sa]=kd.module(Sa)._source;Ma.next=7;return kd.callService("ensureModules",{loadedModules:Object.keys(System._loader.modules).filter(function(jb){return!jb.includes("@")}),sources:aa},!1);case 7:hd=Ma.sent;case 8:if(hd.error){Ma.next=1;break}case 9:case "end":return Ma.stop()}},
td)}));return Mg.apply(this,arguments)}function Hh(Tc,td){return Zf.apply(this,arguments)}function Zf(){Zf=Rc(regeneratorRuntime.mark(function aa(td,hd){var Sa,Ma,jb,Jb=arguments;return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=gc.next){case 0:return Ma=(Sa=2<Jb.length&&void 0!==Jb[2]?Jb[2]:!0)?kd.prepareArguments(hd):hd,jb=kd.detectProgressMonitor(hd),gc.abrupt("return",new Promise(function(ac,Kc){return System.get("@lively-worker").sendTo("@lively-worker",td,Ma,function(md,ud){jb&&
ud.expectMoreResponses?jb.step(ud.data.stepName,ud.data.progress):ac(ud.data)})}));case 4:case "end":return gc.stop()}},aa)}));return Zf.apply(this,arguments)}function z(Tc,td){return C.apply(this,arguments)}function C(){C=Rc(regeneratorRuntime.mark(function aa(td,hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze,Ue=arguments;return regeneratorRuntime.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:Sa=2<Ue.length&&void 0!==Ue[2]?Ue[2]:[/systemjs-plugin-babel|.*\.min\.js|.*browserified[^/]+js|dashboard|loading-screen/];
Ma=3<Ue.length&&void 0!==Ue[3]?Ue[3]:[];jb=4<Ue.length&&void 0!==Ue[4]?Ue[4]:!0;Jb=5<Ue.length&&void 0!==Ue[5]?Ue[5]:!1;gc=6<Ue.length&&void 0!==Ue[6]?Ue[6]:!1;ac=7<Ue.length?Ue[7]:void 0;if(!(2>=hd.length)){Me.next=8;break}return Me.abrupt("return",[]);case 8:if(System.get("@system-env").worker||!Rd.config.ide.workerEnabled){Me.next=12;break}Me.next=11;return Rd.callService("doSearch",{livelySystem:td,searchTerm:hd,excludedModules:Sa,excludedPackages:Ma,includeUnloaded:jb,caseSensitive:Jb,regexMode:gc,
progress:ac});case 11:return Me.abrupt("return",Me.sent);case 12:return Me.next=14,td.searchInAllPackages(hd,{caseSensitive:Jb,regexMode:gc,excludedModules:Sa,excludedPackages:Ma,includeUnloaded:jb,progress:ac});case 14:return Kc=Me.sent,md=Rd.arr.partition(Kc,function(xf){return xf.isError}),ud=Fa(md,2),oe=ud[0],ze=ud[1],oe.length&&Rd.show("Errors in search results:\n".concat(Rd.arr.pluck(oe,"value").join("\n"))),Me.abrupt("return",ze.reduce(function(xf,lf){var Rf="".concat(lf.packageName,"/").concat(lf.pathInPackage,
":").concat(lf.line);xf.maxModuleNameLength=Math.max(xf.maxModuleNameLength,Rf.length);xf.items.push({isListItem:!0,value:lf,get string(){return Rf+lf.lineString}});return xf},{items:[],maxModuleNameLength:0}).items);case 18:case "end":return Me.stop()}},aa)}));return C.apply(this,arguments)}bd({a:xj,c:Hh,i:Ti});var K=window.lively.FreezerRuntime.recorderFor("lively.morphic/events/html-drop-handler.js");K.uploadItem=be;K.uploadFile=v;K.fileReadAsDataURL=function(Tc){return new Promise(function(td,
hd){hd=new FileReader;hd.onload=function(aa){return td(aa.target.result)};hd.readAsDataURL(Tc)})};K.Image=se;K.uploadItem=be;K.uploadFile=v;var T=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js");T.LightPrompt=Yb;T.AbstractPromptModel=de;T.RedButton=P;T.GreenButton=pa;T.InputLineDefault=wa;T.DropDownList=hf;T.DefaultList=zf;T.pt=ad;T.Color=Ne;T.rect=Cb;T.TilingLayout=Sd;T.easings=ve;T.ShadowObject=uc;T.HorizontalLayout=dd;T.Icon=vd;T.ProportionalLayout=Ed;T.Label=fe;T.Text=jc;
T.component=Od;T.add=qb;T.part=ic;T.PackageRegistry=ha;T.EditorPlugin=Gg;T.resource=Wb;T.fun=lc;T.SystemList=vg;T.DarkButton=$b;(function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js"),hd=td.hasOwnProperty("PackageTextCompleter")&&"function"===typeof td.PackageTextCompleter?td.PackageTextCompleter:td.PackageTextCompleter=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};
return db(hd,Tc,[{key:"isValidPrefix",value:function(aa){return!!aa}},{key:"compute",value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){var gc;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return gc=T.PackageRegistry.ofSystem(System).allPackages(),ac.abrupt("return",gc.map(function(Kc){var md=Kc.name;return{info:"@".concat(Kc.version),completion:md,customInsertionFn:function(ud,oe,ze,Ue){Ue.start;Ue.end;ze.replace(ze.lineRange(),md)}}}));case 2:case "end":return ac.stop()}},
Jb)}));return function(Ma,jb){return aa.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"PackageTextCompleter"}}],td,{pathInPackage:function(){return"./src/ui.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:778,end:1319})})(void 0);(function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js"),
hd=td.hasOwnProperty("DirectoryTextCompleter")&&"function"===typeof td.DirectoryTextCompleter?td.DirectoryTextCompleter:td.DirectoryTextCompleter=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"isValidPrefix",value:function(aa){return!!aa}},{key:"compute",value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){var gc,ac,Kc;return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=
md.next){case 0:return gc=Ma.input,gc=jb?gc.slice(0,-jb.length):gc,ac=T.resource(System.baseURL+gc),Kc=[],md.next=6,ac.exists();case 6:if(!md.sent){md.next=10;break}md.next=9;return ac.dirList();case 9:Kc=md.sent;case 10:return md.abrupt("return",Kc.map(function(ud){var oe=ud.url;return{completion:oe.replace(ac.url,""),customInsertionFn:function(ze,Ue,Me,xf){xf.start;xf.end;Me.replace(Me.lineRange(),oe.replace(System.baseURL,"/"))}}}));case 11:case "end":return md.stop()}},Jb)}));return function(Ma,
jb){return aa.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"DirectoryTextCompleter"}}],td,{pathInPackage:function(){return"./src/ui.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:1321,end:2073})})(void 0);(function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js"),
hd=td.hasOwnProperty("DirectoryInputPlugin")&&"function"===typeof td.DirectoryInputPlugin?td.DirectoryInputPlugin:td.DirectoryInputPlugin=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"getCompleters",value:function(){return[new T.DirectoryTextCompleter]}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"DirectoryInputPlugin"}}],td,{pathInPackage:function(){return"./src/ui.cp.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:2075,end:2194})})(T.EditorPlugin);(function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js"),hd=td.hasOwnProperty("PackageInputPlugin")&&"function"===typeof td.PackageInputPlugin?td.PackageInputPlugin:td.PackageInputPlugin=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return db(hd,Tc,[{key:"getCompleters",value:function(){return[new T.PackageTextCompleter]}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"PackageInputPlugin"}}],td,{pathInPackage:function(){return"./src/ui.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:2196,end:2311})})(T.EditorPlugin);var O=
function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js"),hd=td.hasOwnProperty("FreezerPromptModel")&&"function"===typeof td.FreezerPromptModel?td.FreezerPromptModel:td.FreezerPromptModel=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"viewDidLoad",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=
Jb.next){case 0:return db._get(Object.getPrototypeOf(hd.prototype),"viewDidLoad",this).call(this),jb=this.ui.layoutWrapper,this.view.opacity=0,Jb.next=5,this.view.whenRendered();case 5:jb.layout.apply(),this.view.opacity=1;case 7:case "end":return Jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"cancel",value:function(){this.view.remove();this.reject()}},{key:"focus",value:function(){this.ui.compilerSelector.selection="Google Closure";this.ui.dirInput.focus()}},
{key:"resolve",value:function(){var aa=this.ui;aa.dirInput;aa.packageList;aa=aa.compilerSelector;return db._get(Object.getPrototypeOf(hd.prototype),"resolve",this).call(this,{location:this.directory,useTerser:"Terser + Babel"==aa.selection,excludedPackages:this.excludedPackages})}},{key:"checkDirStatus",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb=this;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:T.fun.debounceNamed("checkDirStatus",
500,Rc(regeneratorRuntime.mark(function ac(){var Kc,md,ud;return regeneratorRuntime.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:Kc=jb.ui;md=Kc.dirWarning;ud=Kc.dirInput;oe.t0=!!jb.directory;if(!oe.t0){oe.next=6;break}oe.next=5;return T.resource(System.baseURL).join(jb.directory).exists();case 5:oe.t0=oe.sent;case 6:if(!oe.t0){oe.next=12;break}md.textAndAttributes=[].concat(Xa(T.Icon.textAttribute("exclamation-circle")),["  Directory will be overwritten.",{fontFamily:"IBM Plex Sans",fontWeight:"600"}]);
md.fontColor=T.Color.rgb(231,76,60);!md.visible&&md.animate({visible:!0,isLayoutable:!0,top:ud.bottom,duration:200,easing:T.easings.inOutExpo});oe.next=13;break;case 12:md.animate({isLayoutable:!1,visible:!1,duration:200,easing:T.easings.inOutExpo});case 13:case "end":return oe.stop()}},ac)})))();case 1:case "end":return Jb.stop()}},Ma)}));return function(){return aa.apply(this,arguments)}}()},{key:"addExcludedPackage",value:function(){this.displayPackageInput(!0)}},{key:"removeExcludedPackage",value:function(){var aa=
this.ui.packageList;aa.removeItem(aa.selectedItems[0])}},{key:"confirmExcludedPackage",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return this.ui.packageList.addItem(this.ui.packageInput.input),jb.next=3,this.displayPackageInput(!1);case 3:this.ui.packageInput.input="";case 4:case "end":return jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"verifyPackageName",
value:function(aa){return T.PackageRegistry.ofSystem(System).allPackages().find(function(Sa){return Sa.name==aa})}},{key:"onMouseUp",value:function(aa){aa=this.ui;aa.packageInput;aa.addPackageButton;aa.removePackageButton;aa.confirmPackageButton;aa.packageList;this.ui.removePackageButton.deactivated=!this.ui.packageList.selections.length}},{key:"displayPackageInput",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc,ac,Kc,md;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=
ud.next){case 0:Jb=this.ui;gc=Jb.packageInput;ac=Jb.packageList;Kc=Jb.confirmPackageButton;md=200;if(!Ma){ud.next=8;break}gc.animate({visible:!0,top:ac.bottom+10,duration:md});ud.next=6;return Kc.animate({visible:!0,top:ac.bottom+15,duration:md});case 6:ud.next=11;break;case 8:return Kc.animate({visible:!1,bottom:ac.bottom-5,duration:md}),ud.next=11,gc.animate({visible:!1,bottom:ac.bottom,duration:md});case 11:case "end":return ud.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()}],
[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"FreezerPromptModel"}},{key:"properties",get:function(){return{directory:{derived:!0,set:function(aa){this.ui.dirInput.input=aa.replace(System.baseURL,"/")},get:function(){return this.ui.dirInput.input}},epiMorph:{defaultValue:!0},isModuleBundle:{defaultValue:!0},excludedPackages:{derived:!0,set:function(aa){this.ui.packageList.items=aa},get:function(){return this.ui.packageList.items.map(function(aa){return aa.value})}},expose:{get:function(){return[].concat(Xa(db._get(Object.getPrototypeOf(hd),
"prototype",this).expose),["excludedPackages","directory","isModuleBundle"])}},bindings:{get:function(){return[{signal:"onMouseDown",handler:"onMouseDown"},{model:"add package button",signal:"fire",handler:"addExcludedPackage"},{model:"remove package button",signal:"fire",handler:"removeExcludedPackage"},{model:"confirm excluded package",signal:"fire",handler:"confirmExcludedPackage"},{model:"cancel button",signal:"fire",handler:"cancel"},{model:"ok button",signal:"fire",handler:"resolve"}]}}}}}],
td,{pathInPackage:function(){return"./src/ui.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:2328,end:7085})}(T.AbstractPromptModel);T.FreezerPrompt=T.component["for"](function(){return T.component(T.LightPrompt,{defaultViewModel:T.FreezerPromptModel,name:"freezer prompt",extent:T.pt(481,440.8),clipMode:"hidden",layout:new T.TilingLayout({axis:"column",
hugContentsVertically:!0,orderByIndex:!0,padding:T.rect(16,16,0,0),resizePolicies:[["prompt title",{height:"fixed",width:"fill"}],["dir input",{height:"fixed",width:"fill"}],["compiler explaination",{height:"fixed",width:"fill"}],["exclusion expaination",{height:"fixed",width:"fill"}],["layout wrapper",{height:"fixed",width:"fill"}],["button wrapper",{height:"fixed",width:"fill"}]],spacing:16,wrapSubmorphs:!1}),position:T.pt(960.8,161.4),submorphs:[{name:"prompt title",textAndAttributes:["Freeze Part",
null]},T.add({type:T.Label,name:"dir label",fill:T.Color.rgba(255,255,255,0),fontColor:T.Color.rgb(45,45,45),fontSize:16,fontWeight:"Medium",nativeCursor:"pointer",textAndAttributes:["Directory to write files to:",null]}),T.add(T.part(T.InputLineDefault,{name:"dir input",placeholder:"Directory",submorphs:[{name:"placeholder",extent:T.pt(103,34.3),textAndAttributes:["Directory",null]}]})),T.add({type:T.Text,name:"dir warning",borderColor:T.Color.rgb(204,204,204),borderRadius:3,extent:T.pt(451.3,17.2),
fill:T.Color.rgba(255,255,255,0),fixedWidth:!0,fontColor:T.Color.rgb(231,76,60),fontFamily:"IBM Plex Sans",isLayoutable:!1,lineWrapping:!0,nativeCursor:"default",readOnly:!0,textAlign:"left",visible:!1}),T.add({type:T.Text,name:"compiler explaination",borderColor:T.Color.rgb(204,204,204),borderRadius:3,extent:T.pt(449,109),fill:T.Color.rgba(255,255,255,0),fixedWidth:!0,fontColor:T.Color.rgb(102,102,102),fontFamily:"IBM Plex Sans",lineWrapping:!0,nativeCursor:"default",readOnly:!0,textAlign:"left",
textAndAttributes:["Compression:",{textAlign:"left",fontSize:16,fontColor:T.Color.rgb(45,45,45)}," ",{textAlign:"left",fontSize:16}," ",{textAlign:"left"},T.part(T.DropDownList,{name:"compiler selector",extent:T.pt(127.3,25.9),position:T.pt(104.4,0),viewModel:{selection:"Google Closure",items:["Google Closure","Terser + Babel"],listAlign:"selection",listMaster:T.SystemList,openListInWorld:!0}}),{textAlign:"left"},"   \n",{fontSize:5},"\nSelect the compiler to be used to compress the resulting bundle. Generally speaking Google Closure will yield smaller bundles but may break some parts of your bundle due to aggressive optimization. Terser + Babel is less aggressive but may fail with very large bundles > 10MB.",
null]}),T.add({type:T.Label,name:"excluded package label",fill:T.Color.rgba(255,255,255,0),fontColor:T.Color.rgb(45,45,45),fontSize:16,fontWeight:"Medium",nativeCursor:"pointer",textAndAttributes:["Packages to exclude from bundle:",null]}),T.add({type:T.Text,name:"exclusion expaination",borderColor:T.Color.rgb(204,204,204),borderRadius:3,extent:T.pt(449,67),fill:T.Color.rgba(255,255,255,0),fixedWidth:!0,fontColor:T.Color.rgb(102,102,102),fontFamily:'"IBM Plex Sans",Sans-Serif',lineWrapping:!0,textAndAttributes:["Excluding packages from the bundle of the frozen part can reduce the total payload and its loading time ",
null,"dramatically",{fontWeight:"bold"},". This however needs to be done with care. Make sure that none of your functionality depends of these excluded packages. If you do not know what you are doing it is best to leave this list as is.",{textAlign:"left"}],nativeCursor:"default",textAlign:"center"}),T.add({name:"layout wrapper",extent:T.pt(450,155),fill:T.Color.rgba(46,75,223,0),layout:new T.ProportionalLayout({lastExtent:T.pt(450,155),submorphSettings:[["package list",{x:"resize",y:"resize"}],["add package button",
{x:"move",y:"move"}],["remove package button",{x:"move",y:"move"}],["package input",{x:"resize",y:"fixed"}]]}),submorphs:[T.part(T.InputLineDefault,{name:"package input",borderColor:T.Color.rgb(204,204,204),borderRadius:4,extent:T.pt(445,32),highlightWhenFocused:!0,padding:T.rect(10,3,0,0),placeholder:"Excluded package name",position:T.pt(0,120),visible:!1,submorphs:[{name:"placeholder",extent:T.pt(237,32),textAndAttributes:["Excluded package name",null]}]}),T.part(T.DarkButton,{name:"confirm excluded package",
extent:T.pt(25,21.9),viewModel:{label:T.Icon.textAttribute("check")},position:T.pt(0,126.1),tooltip:"add a new method",visible:!1}),T.part(T.DefaultList,{name:"package list",borderRadius:4,dropShadow:new T.ShadowObject({distance:3,rotation:75,color:T.Color.rgba(0,0,0,.2)}),extent:T.pt(442.4,148.6),fontFamily:"IBM Plex Sans",fontSize:20,itemHeight:29,manualItemHeight:!0,position:T.pt(2.8,4.5)}),T.part(T.DarkButton,{name:"add package button",extent:T.pt(25,25),position:T.pt(383.1,125.2),tooltip:"add a new method",
submorphs:[{name:"label",value:T.Icon.textAttribute("plus")}]}),T.part(T.DarkButton,{name:"remove package button",extent:T.pt(25,25),position:T.pt(414,125),tooltip:"remove a method or class",submorphs:[{name:"label",value:T.Icon.textAttribute("minus")}]})]}),T.add({name:"button wrapper",extent:T.pt(449,48.9),fill:T.Color.rgba(0,0,0,0),layout:new T.HorizontalLayout({align:"center",autoResize:!1,direction:"centered",orderByIndex:!0,padding:{height:0,width:0,x:20,y:20},reactToSubmorphAnimations:!1,renderViaCSS:!0,
resizeSubmorphs:!1,spacing:20}),submorphs:[T.part(T.GreenButton,{name:"ok button",extent:T.pt(90,39),label:"OK"}),T.part(T.RedButton,{name:"cancel button",extent:T.pt(94,39),label:"CANCEL"})]})]})},{module:"lively.freezer/src/ui.cp.js","export":"FreezerPrompt",range:{start:7124,end:14117}},T.FreezerPrompt);var qa=T.FreezerPrompt;T.FreezerPrompt=qa;T["default"]=O;var Ba=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/resolvers/browser.js");Ba.resolveModuleId=function(Tc,td){return Ba.module(Tc).id};
Ba.ensureFileFormat=function(Tc){return Tc};Ba.normalizeFileName=function(Tc){return Oc.apply(this,arguments)};Ba.decanonicalizeFileName=function(Tc){return System.decanonicalize(Tc)};Ba.resolvePackage=Tb;Ba.dontTransform=function(Tc){return Ba.module(Tc).dontTransform};Ba.pathInPackageFor=function(Tc){return Ba.module(Tc).pathInPackage()};Ba.detectFormatFromSource=function(Tc){return Ba.detectModuleFormat(Tc)};Ba.detectFormat=function(Tc){return Ba.module(Tc).format()};Ba.setStatus=function(Tc){var td=
Tc.status,hd=Tc.progress;Tc=Tc.label;Ba.li||(Ba.li=Ba.LoadingIndicator.open());Ba.li.world()||Ba.li.openInWorld();td&&(Ba.li.status=td);Tc&&(Ba.li.label=Tc);"undefined"!==typeof hd&&(Ba.li.progress=hd)};Ba.finish=function(){Ba.li.remove();Ba.li=null};Ba.whenReady=function(){return Ba.li.whenRendered()};Ba.spawn=function(Tc){return Ba.runCommand(Tc.command,{cwd:Tc.cwd})};Ba.load=function(Tc){return ne.apply(this,arguments)};Ba.supportingPlugins=function(){return[Ba.commonjs({sourceMap:!1,defaultIsModuleExports:!0,
transformMixedEsModules:!0,dynamicRequireRoot:System.baseURL}),Ba.nodePolyfills()]};Ba.commonjsHelpers=Gb;Ba.module=ra;Ba.LoadingIndicator=Sc;Ba.detectModuleFormat=mb;Ba.runCommand=sc;Ba.resource=Wb;Ba.commonjs=bf;Ba.nodePolyfills=Oe;Ba.resolvePackage=Tb;Ba.li=Ba.li||void 0;Ba.builtinModules=[];Ba.BrowserResolver={resolveModuleId:Ba.resolveModuleId,normalizeFileName:Ba.normalizeFileName,decanonicalizeFileName:Ba.decanonicalizeFileName,resolvePackage:Ba.resolvePackage,dontTransform:Ba.dontTransform,
pathInPackageFor:Ba.pathInPackageFor,detectFormat:Ba.detectFormat,detectFormatFromSource:Ba.detectFormatFromSource,setStatus:Ba.setStatus,finish:Ba.finish,whenReady:Ba.whenReady,spawn:Ba.spawn,load:Ba.load,builtinModules:Ba.builtinModules,ensureFileFormat:Ba.ensureFileFormat,supportingPlugins:Ba.supportingPlugins};O=Ba.BrowserResolver;Ba["default"]=O;var ib=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/bundler.js");ib.customWarn=Ye;ib.resolutionId=function(Tc,td){return td?td+" -> "+
Tc:Tc};ib.isCdnImport=function(Tc,td,hd){if(ib.ESM_CDNS.find(function(Sa){return Tc.includes(Sa)||td.includes(Sa)})&&td&&td!==ib.ROOT_ID){var aa=ib.resource(hd.ensureFileFormat(td)).root().url;return ib.ESM_CDNS.find(function(Sa){return aa.includes(Sa)})}return!1};ib.resource=Wb;ib.ast=ub;ib.classes=E;ib.arr=sb;ib.string=fa;ib.Path=Db;ib.fun=lc;ib.obj=ab;ib.es5Transpilation=eb;ib.ensureComponentDescriptors=kc;ib.rewriteToCaptureTopLevelVariables=Vb;ib.insertCapturesForExportedImports=pb;ib.locateClass=
Nb;ib.requiredModulesOfSnapshot=zb;ib.classNameOfId=rb;ib.moduleOfId=Ib;ib.config=da;ib.fixSourceForBugsInGoogleClosure=pd;ib.gzip=Z;ib.brotli=Ga;ib.ROOT_ID=fb;ib.generateLoadHtml=ya;ib.instrumentStaticSystemJS=tc;ib.compileOnServer=Mc;ib.joinPath=ka;ib.ensureFolder=va;ib.GlobalInjector=R;ib.separator="__".concat("Separator","__");ib.SYSTEMJS_STUB='\nvar G = typeof window !== "undefined" ? window :\n      typeof global!=="undefined" ? global :\n        typeof self!=="undefined" ? self : this;\nif (!G.System) G.System = G.lively.FreezerRuntime;';
ib.CLASS_INSTRUMENTATION_MODULES="lively.morphic lively.components lively.ide lively.halos lively.user lively.bindings lively-system-interface typeshift.components lively.collab https://jspm.dev/npm:rollup@2.28.2".split(" ");ib.ESM_CDNS=["jspm.dev","jspm.io","skypack.dev","esm://cache"];ib.CLASS_INSTRUMENTATION_MODULES_EXCLUSION=["lively.lang"];ib.ADVANCED_EXCLUDED_MODULES="lively.ast lively.vm lively.ide lively.modules babel-plugin-transform-jsx lively-system-interface lively.storage lively.collab localconfig.js".split(" ");
ib.baseURL="undefined"!==typeof System?System.baseURL:ib.ensureFolder(process.env.lv_next_dir||process.cwd());ib.customWarn=Ye;var Ub=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/bundler.js"),hd=td.hasOwnProperty("LivelyRollup")&&"function"===typeof td.LivelyRollup?td.LivelyRollup:td.LivelyRollup=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:Symbol["for"]("lively-instance-initialize"),
value:function(){this.setup(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}},{key:"setup",value:function(aa){var Sa=aa.snapshot,Ma=aa.rootModule,jb=aa.resolver,Jb=aa.excludedModules;Jb=void 0===Jb?[]:Jb;var gc=aa.autoRun;gc=void 0===gc?!1:gc;var ac=aa.asBrowserModule;ac=void 0===ac?!0:ac;var Kc=aa.useTerser,md=aa.isResurrectionBuild;md=void 0===md?!1:md;var ud=aa.includePolyfills,oe=aa.includeLivelyAssets;oe=void 0===oe?!0:oe;var ze=aa.compress;ze=void 0===ze?!0:ze;var Ue=aa.minify;Ue=
void 0===Ue?!0:Ue;aa=aa.captureModuleScope;aa=void 0===aa?!0:aa;this.resolver=jb;this.useTerser=void 0===Kc?!1:Kc;this.includePolyfills=void 0===ud?!0:ud;this.snapshot=Sa;Ma&&(this.rootModuleId=jb.resolveModuleId(Ma));this.autoRun=gc;this.asBrowserModule=ac;this.excludedModules=Jb;this.captureModuleScope=aa;this.isResurrectionBuild=md;this.includeLivelyAssets=oe;this.compress=ze;this.minify=Ue;this.globalMap={};this.dynamicParts={};this.modulesWithDynamicLoads=new Set;this.hasDynamicImports=!1;this.globalModules=
{};this.importedModules=[];this.resolved={};this.assetsToCopy=[]}},{key:"needsOldSystem",get:function(){return this.isResurrectionBuild||!this.excludedModules.includes("lively.modules")}},{key:"getResolutionContext",value:function(){return this.asBrowserModule?"systemjs-browser":"node"}},{key:"getRequiredModulesFromSnapshot",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return Jb.abrupt("return",
ib.requiredModulesOfSnapshot(Ma));case 1:case "end":return Jb.stop()}},jb)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"resolveRelativeImport",value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=gc.next){case 0:if(jb.startsWith(".")){gc.next=2;break}return gc.abrupt("return",this.resolver.normalizeFileName(jb));case 2:return gc.t0=this.resolver,gc.t1=ib.string,gc.next=6,this.resolver.normalizeFileName(Ma);
case 6:return gc.t2=gc.sent,gc.t3=jb,gc.t4=gc.t1.joinPath.call(gc.t1,gc.t2,"..",gc.t3),gc.next=11,gc.t0.normalizeFileName.call(gc.t0,gc.t4);case 11:return gc.abrupt("return",gc.sent);case 12:case "end":return gc.stop()}},Jb,this)}));return function(Ma,jb){return aa.apply(this,arguments)}}()},{key:"normalizedId",value:function(aa){return aa.replace(ib.baseURL,"").replace("local://lively-object-modules/","")}},{key:"getTransformOptions",value:function(aa,Sa){if("@empty"===aa)return{};var Ma;if(Ma=this.resolver.resolvePackage(aa)){var jb=
Ma.name;Ma=Ma.version}else Ma=aa.split("@")[1],jb=aa.split("npm:")[1].split("@")[0];jb={classHolder:ib.ast.parse('(window.lively.FreezerRuntime.recorderFor("'.concat(this.normalizedId(aa),'"))')),functionNode:{type:"Identifier",name:"initializeES6ClassForLively"},transform:ib.classes.classToFunctionTransform,currentModuleAccessor:ib.ast.parse('({\n        pathInPackage: () => {\n           return "'.concat(this.resolver.pathInPackageFor(aa),'"\n        },\n        unsubscribeFromToplevelDefinitionChanges: () => () => {},\n        subscribeToToplevelDefinitionChanges: () => () => {},\n        package: () => { \n          return {\n            name: "').concat(jb,
'",\n            version: "').concat(Ma,'"\n          } \n        } \n      })')).body[0].expression};return{exclude:["System"].concat(Xa(this.resolver.dontTransform(aa,[].concat(Xa(ib.ast.query.knownGlobals),Xa(ib.GlobalInjector.getGlobals(null,Sa))))),Xa(ib.arr.range(0,50).map(function(Jb){return"__captured".concat(Jb,"__")}))),classToFunction:jb}}},{key:"checkIfImportedPackageExcluded",value:function(aa){var Sa=this,Ma=ib.arr.compact(this.excludedModules.map(function(jb){return Sa.resolver.resolvePackage(jb)}));
aa=aa.map(function(jb){return Sa.resolver.resolvePackage(jb)});Ma=ib.arr.intersect(Ma,aa);if(0<Ma.length)throw aa=1<Ma.length,aa=Error("Package".concat(aa?"s":""," ").concat(Ma.map(function(jb){return'"'.concat(jb.name,'"')}),"\n").concat(aa?"are":"is"," directly required by part, yet set to be excluded.")),aa.name="Exclusion Conflict",aa.reducedExclusionSet=ib.arr.withoutAll(this.excludedModules,Ma.map(function(jb){return jb.name})),aa;}},{key:"getRootModule",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=
jb.next){case 0:if(!this.rootModuleId){jb.next=6;break}if(this.autoRun){jb.next=3;break}return jb.abrupt("return",'export * from "'.concat(this.rootModuleId,'";'));case 3:return jb.next=5,this.synthesizeMainModule();case 5:return jb.abrupt("return",jb.sent);case 6:return jb.next=8,this.synthesizeSnapshotModule();case 8:return jb.abrupt("return",jb.sent);case 9:case "end":return jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"synthesizeMainModule",value:function(){var aa=
Rc(regeneratorRuntime.mark(function Ma(){var jb;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return Jb.t0=ib,Jb.t1=this.resolver,Jb.next=4,this.resolver.normalizeFileName("lively.freezer/src/util/main-module.js");case 4:return Jb.t2=Jb.sent,Jb.t3=Jb.t1.ensureFileFormat.call(Jb.t1,Jb.t2),Jb.next=8,Jb.t0.resource.call(Jb.t0,Jb.t3).read();case 8:return jb=Jb.sent,Jb.abrupt("return",jb.replace("prepare()","const { main, WORLD_CLASS = World, TITLE } = await System.import('".concat(this.rootModuleId,
"')")));case 10:case "end":return Jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"synthesizeSnapshotModule",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return ac.t0=ib,ac.t1=this.resolver,ac.next=4,this.resolver.normalizeFileName("lively.freezer/src/util/snapshot-module.js");case 4:return ac.t2=ac.sent,ac.t3=ac.t1.ensureFileFormat.call(ac.t1,ac.t2),
ac.next=8,ac.t0.resource.call(ac.t0,ac.t3).read();case 8:return jb=ac.sent,ac.next=11,this.getRequiredModulesFromSnapshot(this.snapshot);case 11:Jb=ac.sent;gc=Jb.requiredModules;this.checkIfImportedPackageExcluded(gc);ac.t4=ib.arr.uniq(gc.map(function(Kc){return'import "'.concat(Kc,'"')})).join("\n");if(!this.excludedModules.includes("localconfig.js")){ac.next=19;break}ac.t5="";ac.next=22;break;case 19:return ac.next=21,this.resolver.load(ib.string.joinPath(ib.baseURL,"localconfig.js"));case 21:ac.t5=
ac.sent;case 22:return ac.t6=ac.t5,ac.t7=ac.t4+ac.t6,ac.t8=jb.replace('{"SNAPSHOT": "PLACEHOLDER"}',JSON.stringify(JSON.stringify(ib.obj.dissoc(this.snapshot,["preview","packages"])))),ac.abrupt("return",ac.t7+ac.t8);case 26:case "end":return ac.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"needsScopeToBeCaptured",value:function(aa,Sa){var Ma=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1;if(Ma&&"global"===this.resolver.detectFormatFromSource(Ma)||Sa&&
ib.resource(aa).host()!==ib.resource(Sa).host())return!1;if(!this.wasFetchedFromEsmCdn(aa))return!0}},{key:"wasFetchedFromEsmCdn",value:function(aa){return!!ib.ESM_CDNS.find(function(Sa){return aa.includes(Sa)})}},{key:"needsClassInstrumentation",value:function(aa,Sa){return ib.CLASS_INSTRUMENTATION_MODULES_EXCLUSION.some(function(Ma){return aa.includes(Ma)})?!1:ib.CLASS_INSTRUMENTATION_MODULES.some(function(Ma){return aa.includes(Ma)||Ma===aa})?!0:this.wasFetchedFromEsmCdn(aa)?!1:this.isComponentModule(aa)||
Sa&&Sa.match(/extends (Morph|Image|Ellipse|HTMLMorph|Path|Polygon|Text|InteractiveMorph|ViewModel)/)?!0:!1}},{key:"isComponentModule",value:function(aa){return aa.endsWith(".cp.js")}},{key:"isLivelyCoreModule",value:function(aa){return aa.includes("lively.")}},{key:"needsDynamicLoadTransform",value:function(aa){return aa.includes("System.import")}},{key:"instrumentDynamicLoads",value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){var gc,ac,Kc;return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=
md.next){case 0:return gc=ib.ast.parse(Ma),ac=[],Kc=[],ib.ast.AllNodesVisitor.run(gc,function(ud,oe){if("CallExpression"===ud.type&&"MemberExpression"===ud.callee.type&&"import"===ud.callee.property.name&&"System"===ud.callee.object.name&&1===ud.arguments.length)try{var ze=Kc.push(eval(ib.ast.stringify(ud.arguments[0])));ac.push({target:ud.arguments[0],replacementFunc:function(Ue,Me){return Kc[ze-1]?'"'.concat(Kc[ze-1],'"'):Me}});ac.push({target:ud.callee,replacementFunc:function(){return"import"}})}catch(Ue){}}),
md.next=6,Promise.all(Kc);case 6:return md.t0=function(ud){return ud.isError?void 0:ud.value},Kc=md.sent.map(md.t0),this.hasDynamicImports||(this.hasDynamicImports=0<Kc.length),md.abrupt("return",ib.ast.transform.replaceNodes(ac,Ma).source);case 10:case "end":return md.stop()}},Jb,this)}));return function(Ma,jb){return aa.apply(this,arguments)}}()},{key:"transform",value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=
gc.next){case 0:if(!jb.startsWith("\x00")&&!jb.endsWith(".json")){gc.next=2;break}return gc.abrupt("return",Ma);case 2:if(!this.needsDynamicLoadTransform(Ma)){gc.next=6;break}gc.next=5;return this.instrumentDynamicLoads(Ma,jb);case 5:Ma=gc.sent;case 6:if(jb!==ib.ROOT_ID){gc.next=8;break}return gc.abrupt("return",Ma);case 8:if(this.needsScopeToBeCaptured(jb,null,Ma)||this.needsClassInstrumentation(jb,Ma))Ma=this.captureScope(Ma,jb);return gc.abrupt("return",Ma);case 10:case "end":return gc.stop()}},
Jb,this)}));return function(Ma,jb){return aa.apply(this,arguments)}}()},{key:"resolveId",value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){var gc,ac;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=Kc.next){case 0:if(!this.resolved[ib.resolutionId(Ma,jb)]){Kc.next=2;break}return Kc.abrupt("return",this.resolved[ib.resolutionId(Ma,jb)]);case 2:if(Ma!==ib.ROOT_ID){Kc.next=4;break}return Kc.abrupt("return",Ma);case 4:if(jb){Kc.next=6;break}return Kc.abrupt("return",
this.resolver.resolveModuleId(Ma));case 6:ib.isCdnImport(Ma,jb,this.resolver)&&(Ma=Ma.startsWith(".")?ib.resource(jb).parent().join(Ma).withRelativePartsResolved().url:ib.resource(jb).root().join(Ma).withRelativePartsResolved().url);(gc=this.resolver.resolvePackage(jb))&&gc.map&&(this.globalMap=Object.assign({},this.globalMap,{},gc.map),gc.map[Ma]||this.globalMap[Ma])&&(!gc.map[Ma]&&this.globalMap[Ma]&&console.warn('[freezer] No mapping for "'.concat(Ma,'" provided by package "').concat(gc.name,'". Guessing "').concat(this.globalMap[Ma],
'" based on past resolutions. Please consider adding a map entry to this package config in oder to make the package definition sound and work independently of the current setup!')),Ma=gc.map[Ma]||this.globalMap[Ma],Ma["~node"]&&(Ma=Ma["~node"]),jb=gc.url);if(!Ma.startsWith(".")){Kc.next=22;break}Kc.prev=10;Kc.next=13;return this.resolveRelativeImport(jb,Ma);case 13:ac=Kc.sent;if(!this.belongsToExcludedPackage(ac)){Kc.next=16;break}return Kc.abrupt("return",null);case 16:return Kc.abrupt("return",
this.resolved[ib.resolutionId(Ma,jb)]=ac);case 19:return Kc.prev=19,Kc.t0=Kc["catch"](10),Kc.abrupt("return",null);case 22:if(Ma.endsWith(".js")||ib.isCdnImport){Kc.next=29;break}Kc.next=25;return this.resolver.normalizeFileName(Ma);case 25:ac=Kc.sent;if(!this.belongsToExcludedPackage(ac)){Kc.next=28;break}return Kc.abrupt("return",null);case 28:return Kc.abrupt("return",this.resolved[ib.resolutionId(Ma,jb)]=ac);case 29:ac=this.resolver.resolveModuleId(Ma,jb,this.getResolutionContext());if(!this.belongsToExcludedPackage(ac)){Kc.next=
32;break}return Kc.abrupt("return",null);case 32:return Kc.abrupt("return",this.resolved[ib.resolutionId(Ma,jb)]=ac);case 33:case "end":return Kc.stop()}},Jb,this,[[10,19]])}));return function(Ma,jb){return aa.apply(this,arguments)}}()},{key:"belongsToExcludedPackage",value:function(aa){var Sa=this.resolver.resolvePackage(aa);return Sa&&this.excludedModules.includes(Sa.name)?(console.log("excluding",aa),!0):!1}},{key:"resolveDynamicImport",value:function(aa,Sa){return aa.type&&this.isLivelyCoreModule(Sa)?
null:(aa=this.resolveId(aa,Sa))&&ib.obj.isString(aa)?{external:!1,id:aa}:aa}},{key:"load",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc,ac;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=Kc.next){case 0:if(!this.excludedModules.includes(Ma)){Kc.next=5;break}if("lively.ast"!==Ma){Kc.next=3;break}return Kc.abrupt("return","\n        let nodes = {}, query = {}, transform = {}, BaseVisitor = Object;\n        export { nodes, query, transform, BaseVisitor };");
case 3:if("lively.modules"!==Ma){Kc.next=5;break}return Kc.abrupt("return","\n        let scripting = {};\n        export { scripting };");case 5:if(Ma!==ib.ROOT_ID){Kc.next=10;break}Kc.next=8;return this.getRootModule();case 8:return Jb=Kc.sent,Kc.abrupt("return",Jb);case 10:gc=this.resolver.resolvePackage(Ma);if(!gc||!this.excludedModules.includes(gc.name)||Ma.endsWith(".json")){Kc.next=14;break}console.log("empty load",Ma);return Kc.abrupt("return","");case 14:return Kc.next=16,this.resolver.load(Ma);
case 16:ac=Kc.sent;if(!Ma.endsWith(".json")){Kc.next=19;break}return Kc.abrupt("return",ac);case 19:return ac=ib.fixSourceForBugsInGoogleClosure(Ma,ac),Kc.abrupt("return",ac);case 21:case "end":return Kc.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"buildStart",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return this.resolver.setStatus({status:"Bundling..."}),
this.snapshot&&this.getAssetsFromSnapshot(this.snapshot),Jb.next=4,this.resolver.whenReady();case 4:this.autoRun&&Ma.emitFile({type:"chunk",id:ib.ROOT_ID});case 5:case "end":return Jb.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"captureScope",value:function(aa,Sa){var Ma="",jb=this.captureModuleScope?"const ".concat("__varRecorder__",' = window.lively.FreezerRuntime.recorderFor("').concat(this.normalizedId(Sa),'");\n'):"",Jb={name:"__varRecorder__",type:"Identifier"},
gc=ib.ast.parse(aa),ac=ib.fun.compose(ib.rewriteToCaptureTopLevelVariables,ib.ast.transform.objectSpreadTransform),Kc=this.getTransformOptions(this.resolver.resolveModuleId(Sa),gc);this.needsClassInstrumentation(Sa,aa)?Ma='import { initializeClass as initializeES6ClassForLively } from "lively.classes/runtime.js";\n':Kc.classToFunction=!1;aa=gc;this.isComponentModule(Sa)&&(aa=ib.ensureComponentDescriptors(gc,this.normalizedId(Sa)));var md="";if(this.captureModuleScope){aa=ib.insertCapturesForExportedImports(ac(gc,
Jb,Kc),{captureObj:Jb});var ud=[];Sa=[];ib.ast.custom.forEachNode(aa,function(ze){"ImportDeclaration"===ze.type&&ib.arr.pushIfNotIncluded(ud,ze);if("ExportDefaultDeclaration"===ze.type){switch(ze.declaration.type){case "Literal":var Ue=ib.Path("declaration.raw").get(ze);break;case "Identifier":Ue=ib.Path("declaration.name").get(ze);break;case "ClassDeclaration":case "FunctionDeclaration":Ue=ib.Path("declaration.id.name").get(ze)}Ue&&(md="".concat(Jb.name,".default = ").concat(Ue,";\n"))}});gc=0;for(ac=
Object.values(ib.arr.groupBy(ud,function(ze){return ze.source.value}));gc<ac.length;gc++)if(Kc=ac[gc].filter(function(ze){return ze.specifiers.every(function(Ue){return"ImportSpecifier"===Ue.type})}),1<Kc.length){var oe=ib.arr.uniqBy(Kc.map(function(ze){return ze.specifiers}).flat(),function(ze,Ue){return"ImportSpecifier"===ze.type&&"ImportSpecifier"===Ue.type&&ze.imported.name===Ue.imported.name&&ze.local.name===Ue.local.name});Kc[0].specifiers=oe;Sa.push.apply(Sa,Xa(Kc.slice(1).map(function(ze){ze.body=
[];ze.type="Program";return ze})))}}return jb+Ma+ib.ast.stringify(aa)+md}},{key:"deriveVarName",value:function(aa){return ib.string.camelize(ib.arr.last(aa.split("/")).replace(/\.js|\.min/g,"").split(".").join(""))}},{key:"wrapStandalone",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc,ac;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=Kc.next){case 0:return Ma=this.resolver.resolveModuleId(Ma,void 0,this.getResolutionContext()),Kc.next=3,ib.resource(Ma).read();
case 3:return Jb=Kc.sent,gc=this.deriveVarName(Ma),ac="global"===this.resolver.detectFormat(Ma)?"var ".concat(gc,' = (function() {\n         var fetchGlobals = prepareGlobal("').concat(Ma,'");\n         ').concat(Jb,";\n         return fetchGlobals();\n      })();\n"):"\n      var ".concat(gc,";\n        (function(module /* exports, require */) {\n         // optional parameters\n         var exports = arguments.length > 0 && arguments[1] !== undefined ? arguments[1] : {};\n         var require = arguments.length > 1 && arguments[2] !== undefined ? arguments[2] : function () {};\n  \n         // try to simulate node.js context\n         var exec = function(exports, require) {\n            ").concat(Jb,
" \n         };\n         exec(exports, require);\n         if (typeof module.exports !== 'function' && Object.keys(module.exports).length === 0) Object.assign(module.exports, exports);\n         if (typeof module.exports !== 'function' && Object.keys(module.exports).length === 0) {\n            exec(); // try to run as global\n         }\n         ").concat(gc," = module.exports;\n       })({exports: {}});\n"),Kc.abrupt("return",{code:ac,global:gc});case 7:case "end":return Kc.stop()}},jb,this)}));
return function(Ma){return aa.apply(this,arguments)}}()},{key:"generateGlobals",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf,lf,Rf,Hg,ng=arguments;return regeneratorRuntime.wrap(function(fg){for(;;)switch(fg.prev=fg.next){case 0:return jb=0<ng.length&&void 0!==ng[0]?ng[0]:this.hasDynamicImports,fg.next=3,this.getRuntimeCode();case 3:Jb=fg.sent,gc=!1,ac={},jb||(Jb+="".concat(this.asBrowserModule?"var fs = {};":'var fs = require("fs");'," var _missingExportShim = () => {}, show, System, require, timing, lively, Namespace, localStorage;")),
fg.t0=regeneratorRuntime.keys(this.globalModules);case 8:if((fg.t1=fg.t0()).done){fg.next=19;break}Kc=fg.t1.value;fg.next=12;return this.wrapStandalone(Kc);case 12:md=fg.sent;ud=md.code;oe=md.global;Jb+=ud;ac[Kc]=oe;fg.next=8;break;case 19:if(!jb){fg.next=35;break}if(!this.needsOldSystem){fg.next=27;break}fg.t2=Jb;fg.next=24;return ib.resource("https://raw.githubusercontent.com/systemjs/systemjs/0.21/dist/system.src.js").read();case 24:Jb=fg.t2+=fg.sent;fg.next=31;break;case 27:return fg.t3=Jb,fg.next=
30,ib.resource("https://raw.githubusercontent.com/systemjs/systemjs/6.12.1/dist/system.js").read();case 30:Jb=fg.t3+=fg.sent;case 31:Jb+="(".concat(ib.instrumentStaticSystemJS.toString(),")(System);\n");if(this.needsOldSystem){ze=M(this.excludedModules.concat(this.asBrowserModule?["fs","events"]:[]));try{for(ze.s();!(Ue=ze.n()).done;)Me=Ue.value,Jb+='System.set("'.concat(Me,'", System.newModule({ default: {} }));\n')}catch(gg){ze.e(gg)}finally{ze.f()}}else gc='<script type="systemjs-importmap">\n{\n"imports": {\n',
gc+=this.excludedModules.concat(this.asBrowserModule?["fs","events"]:[]).map(function(gg){return'"'.concat(gg,'": "./@empty"')}).join(",\n"),gc+="\n  }\n}\n\x3c/script>";fg.next=37;break;case 35:xf=M(this.excludedModules);try{for(xf.s();!(lf=xf.n()).done;)Rf=lf.value,Hg=ac[Rf]=this.deriveVarName(Rf),Jb+="var ".concat(Hg," = {};\n")}catch(gg){xf.e(gg)}finally{xf.f()}case 37:return fg.abrupt("return",{code:Jb,globals:ac,importMap:gc});case 38:case "end":return fg.stop()}},Ma,this)}));return function(){return aa.apply(this,
arguments)}}()},{key:"getRuntimeCode",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc,ac;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=Kc.next){case 0:return jb=this.includePolyfills&&this.asBrowserModule,Kc.t0=ib,Kc.t1=this.resolver,Kc.next=5,this.resolver.normalizeFileName("lively.freezer/src/util/runtime.js");case 5:return Kc.t2=Kc.sent,Kc.t3=Kc.t1.ensureFileFormat.call(Kc.t1,Kc.t2),Kc.next=9,Kc.t0.resource.call(Kc.t0,Kc.t3).read();case 9:return Jb=
Kc.sent,Kc.next=12,ib.resource("https://unpkg.com/regenerator-runtime@0.13.7/runtime.js").read();case 12:gc=Kc.sent;if(!jb){Kc.next=25;break}Kc.t5=ib;Kc.t6=this.resolver;Kc.next=18;return this.resolver.normalizeFileName("lively.freezer/deps/fetch.umd.js");case 18:return Kc.t7=Kc.sent,Kc.t8=Kc.t6.ensureFileFormat.call(Kc.t6,Kc.t7),Kc.next=22,Kc.t5.resource.call(Kc.t5,Kc.t8).read();case 22:Kc.t4=Kc.sent;Kc.next=26;break;case 25:Kc.t4="";case 26:return ac=Kc.t4,Jb="(".concat(Jb.slice(0,-1).replace("export ",
""),")();\n"),this.hasDynamicImports||(Jb+=ib.SYSTEMJS_STUB),Jb+=gc,Jb+=ac,Kc.abrupt("return",ib.es5Transpilation(Jb));case 32:case "end":return Kc.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"getAssetsFromSnapshot",value:function(aa){var Sa=this,Ma=aa.snapshot;Object.entries(Ma).map(function(jb){jb=Fa(jb,2);var Jb=jb[0],gc=jb[1];if(ib.classNameOfId(Ma,Jb)&&ib.moduleOfId(Ma,Jb)["package"]){jb=ib.locateClass({className:ib.classNameOfId(Ma,Jb),module:ib.moduleOfId(Ma,
Jb)});jb=Object.entries(jb[Symbol["for"]("lively.classes-properties-and-settings")].properties).map(function(md){md=Fa(md,2);var ud=md[0];return md[1].copyAssetOnFreeze&&ud}).filter(Boolean);jb=M(jb);var ac;try{var Kc=function(){var md=ac.value;if(!gc.props[md]||gc.props[md].value.startsWith("assets"))return"continue";var ud=gc.props[md].value;if(""===ud||ud.startsWith("data:"))return"continue";var oe=ib.resource(ud);if(oe.host()!==ib.resource(ib.baseURL).host())return"continue";oe._from=Jb;Sa.assetsToCopy.find(function(ze){return ze.url===
oe.url})||Sa.assetsToCopy.push(oe);gc.props[md].value="assets/"+oe.name()};for(jb.s();!(ac=jb.n()).done;)Kc()}catch(md){jb.e(md)}finally{jb.f()}}})}},{key:"generateIndexHtml",value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=gc.next){case 0:return gc.next=2,ib.generateLoadHtml(this.autoRun,Ma,this.resolver,jb);case 2:return gc.abrupt("return",gc.sent);case 3:case "end":return gc.stop()}},Jb,this)}));return function(Ma,
jb){return aa.apply(this,arguments)}}()},{key:"generateBundle",value:function(){var aa=Rc(regeneratorRuntime.mark(function Kc(Ma,jb,Jb,gc,ac){var md,ud,oe,ze,Ue,Me,xf,lf,Rf,Hg,ng,fg,gg,Wh,wg,xh,Qi,Di,Zi,ni,Xd,ff,af,Gf,Jh,ci,di,vj,pj,kj,Ih,mk,fl,Al;return regeneratorRuntime.wrap(function(rg){for(;;)switch(rg.prev=rg.next){case 0:md=Object.values(jb);if(!this.minify||"esm"===ac.format){rg.next=15;break}md.forEach(function(Sg,Lj){Sg.instrumentedCode='"'.concat(ib.separator,'",').concat(Lj,";\n")+Sg.code});
ud=md.map(function(Sg){return Sg.instrumentedCode}).join("\n");rg.next=6;return ib.compileOnServer(ud,this.resolver,this.useTerser);case 6:oe=rg.sent;ze=oe.min;Ue=ze.split(new RegExp('"'.concat(ib.separator,'";\n?')));Me=new Map;md.forEach(function(Sg,Lj){Me.set(Lj,Sg.code)});Ue.forEach(function(Sg){var Lj=Sg.match(/^[0-9]+;\n?/);Lj&&(Lj=Number(Lj[0].replace(/;\n?/,"")),Me.set(Lj,Sg.replace(/^[0-9]+;\n?/,"")))});Ue=Xa(Me.values());xf=M(ib.arr.zip(md,Ue));try{for(xf.s();!(lf=xf.n()).done;)Rf=Fa(lf.value,
2),Hg=Rf[0],ng=Rf[1],Hg.code=ng}catch(Sg){xf.e(Sg)}finally{xf.f()}case 15:if(!this.compress){rg.next=45;break}fg=M(md);rg.prev=17;fg.s();case 19:if((gg=fg.n()).done){rg.next=37;break}Wh=gg.value;rg.t0=Ma;rg.t1=Wh.fileName+".gz";rg.next=25;return ib.gzip(Wh.code);case 25:return rg.t2=rg.sent,rg.t3={type:"asset",fileName:rg.t1,source:rg.t2},rg.t0.emitFile.call(rg.t0,rg.t3),rg.t4=Ma,rg.t5=Wh.fileName+".br",rg.next=32,ib.brotli(Wh.code);case 32:rg.t6=rg.sent,rg.t7={type:"asset",fileName:rg.t5,source:rg.t6},
rg.t4.emitFile.call(rg.t4,rg.t7);case 35:rg.next=19;break;case 37:rg.next=42;break;case 39:rg.prev=39,rg.t8=rg["catch"](17),fg.e(rg.t8);case 42:return rg.prev=42,fg.f(),rg.finish(42);case 45:if(!this.includeLivelyAssets){rg.next=142;break}wg=this.resolver.ensureFileFormat(this.resolver.decanonicalizeFileName("lively.morphic").replace("index.js",""));xh=ib.resource(ib.config.css.fontAwesome).parent().parent();rg.next=50;return xh.join("css").dirList();case 50:return Qi=rg.sent,rg.next=53,xh.join("webfonts").dirList();
case 53:return Di=rg.sent,rg.next=56,ib.resource(ib.config.css.inconsolata).parent().dirList();case 56:Zi=rg.sent,ni=M(Qi),rg.prev=58,ni.s();case 60:if((Xd=ni.n()).done){rg.next=71;break}ff=Xd.value;rg.t9=Ma;rg.t10=ib.joinPath(xh.url.replace(wg,""),"css",ff.name());rg.next=66;return ff.read();case 66:rg.t11=rg.sent,rg.t12={type:"asset",fileName:rg.t10,source:rg.t11},rg.t9.emitFile.call(rg.t9,rg.t12);case 69:rg.next=60;break;case 71:rg.next=76;break;case 73:rg.prev=73,rg.t13=rg["catch"](58),ni.e(rg.t13);
case 76:return rg.prev=76,ni.f(),rg.finish(76);case 79:af=M(Di),rg.prev=80,af.s();case 82:if((Gf=af.n()).done){rg.next=92;break}Jh=Gf.value;Jh.beBinary();rg.next=87;return Jh.read();case 87:ci=rg.sent,ci instanceof ArrayBuffer&&(ci=new Uint8Array(ci)),Ma.emitFile({type:"asset",fileName:ib.joinPath(xh.url.replace(wg,""),"webfonts",Jh.name()),source:ci});case 90:rg.next=82;break;case 92:rg.next=97;break;case 94:rg.prev=94,rg.t14=rg["catch"](80),af.e(rg.t14);case 97:return rg.prev=97,af.f(),rg.finish(97);
case 100:di=M(Zi),rg.prev=101,di.s();case 103:if((vj=di.n()).done){rg.next=113;break}pj=vj.value;pj.beBinary();rg.next=108;return pj.read();case 108:kj=rg.sent,kj instanceof ArrayBuffer&&(kj=new Uint8Array(kj)),Ma.emitFile({type:"asset",fileName:ib.joinPath("assets/inconsolata/",pj.name()),source:kj});case 111:rg.next=103;break;case 113:rg.next=118;break;case 115:rg.prev=115,rg.t15=rg["catch"](101),di.e(rg.t15);case 118:return rg.prev=118,di.f(),rg.finish(118);case 121:Ih=M(this.assetsToCopy),rg.prev=
122,Ih.s();case 124:if((mk=Ih.n()).done){rg.next=134;break}fl=mk.value;fl.beBinary();rg.next=129;return fl.read();case 129:Al=rg.sent,Al instanceof ArrayBuffer&&(Al=new Uint8Array(Al)),Ma.emitFile({type:"asset",fileName:ib.joinPath("assets",fl.name()),source:Al});case 132:rg.next=124;break;case 134:rg.next=139;break;case 136:rg.prev=136,rg.t16=rg["catch"](122),Ih.e(rg.t16);case 139:return rg.prev=139,Ih.f(),rg.finish(139);case 142:Ma.emitFile({type:"asset",fileName:"@empty",source:""});if(!this.autoRun){rg.next=
151;break}Ma.emitFile({type:"asset",fileName:"deps.js",source:Jb});rg.t17=Ma;rg.next=148;return this.generateIndexHtml(gc,md);case 148:rg.t18=rg.sent,rg.t19={type:"asset",fileName:"index.html",source:rg.t18},rg.t17.emitFile.call(rg.t17,rg.t19);case 151:this.resolver.finish();case 152:case "end":return rg.stop()}},Kc,this,[[17,39,42,45],[58,73,76,79],[80,94,97,100],[101,115,118,121],[122,136,139,142]])}));return function(Ma,jb,Jb,gc,ac){return aa.apply(this,arguments)}}()},{key:"finishBundle",value:function(){var aa=
Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc,ac,Kc,md;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=ud.next){case 0:return ud.next=2,this.generateGlobals();case 2:ib.__inter0__=ud.sent;Jb=ib.__inter0__.code;ac=ib.__inter0__.globals;gc=ib.__inter0__.importMap;if(!this.hasDynamicImports){ud.next=16;break}ud.next=9;return Ma.generate({format:"system",globals:ac});case 9:return Kc=ud.sent,ud.next=12,this.handleSplittedBuild(Kc.output,Jb);case 12:md=ud.sent;md.format="systemjs";
ud.next=23;break;case 16:return ud.next=18,Ma.generate({format:this.asBrowserModule?"iife":"cjs",globals:ac});case 18:return Kc=ud.sent,ud.next=21,this.transpileAndCompressOnServer({bundledCode:Kc.output[0].code,depsCode:Jb});case 21:md=ud.sent,md.format="global";case 23:return md.assets=this.assetsToCopy,md.rollup=this,md.importMap=gc,this.resolver.finish(),ud.abrupt("return",md);case 28:case "end":return ud.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"handleSplittedBuild",
value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){var gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf,lf,Rf,Hg;return regeneratorRuntime.wrap(function(ng){for(;;)switch(ng.prev=ng.next){case 0:return gc="\n        window.frozenPart = {\n          renderFrozenPart: (domNode, baseURL) => {\n            if (baseURL) System.config( { baseURL });\n            if (!baseURL) baseURL = './';\n            System.config({\n              meta: {\n               ".concat(Ma.map(function(fg){return"[baseURL + '".concat(fg.fileName,
'\']: {format: "system"}')}).join(",\n"),'\n              }\n            });\n            System.import("./').concat(ib.ROOT_ID,'").then(m => { System.trace = false; m.renderFrozenPart(domNode); });\n          }\n        }\n      '),Ma.forEach(function(fg,gg){fg.instrumentedCode=fg.code.replace("System.register(",'System.register("'.concat(gg,'",'))}),ng.next=4,this.transpileAndCompressOnServer({depsCode:jb,bundledCode:[gc].concat(Xa(Ma.map(function(fg){return fg.instrumentedCode}))).join('"'.concat(ib.separator,
'";'))});case 4:ac=ng.sent;Kc=ac.min;md=Kc.split(this.useTerser?/,System.register\(/:new RegExp('"'.concat(ib.separator,'";\n?System.register(')));ud=Aa(md);oe=ud[0];ze=ud.slice(1);Ue=new Map;Ma.forEach(function(fg,gg){Ue.set(gg,fg.code)});ze.forEach(function(fg){var gg=Number(fg.match(/"[0-9]+"/)[0].slice(1,-1));Ue.set(gg,fg.replace(/"[0-9]+",/,"System.register("))});ze=Xa(Ue.values());Ma.load={min:oe};Me=M(ib.arr.zip(Ma,ze));try{for(Me.s();!(xf=Me.n()).done;)lf=Fa(xf.value,2),Rf=lf[0],Hg=lf[1],
Rf.min=Hg}catch(fg){Me.e(fg)}finally{Me.f()}return ng.abrupt("return",Ma);case 15:case "end":return ng.stop()}},Jb,this)}));return function(Ma,jb){return aa.apply(this,arguments)}}()},{key:"transpileAndCompressOnServer",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc,ac,Kc,md,ud,oe,ze,Ue;return regeneratorRuntime.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:Jb=Ma.depsCode;gc=void 0===Jb?"":Jb;ac=Ma.bundledCode;Kc=Ma.fileName;md=void 0===Kc?"":Kc;ud=Ma.optimize;
oe=void 0===ud?!0:ud;this.resolver.setStatus({title:"Freezing Part",status:"Optimizing..."});ze=gc+ac;if(oe){Me.next=5;break}return Me.abrupt("return",{code:ze,min:ze});case 5:return Me.next=7,ib.compileOnServer(ze,this.resolver,md,this.useTerser);case 7:return Ue=Me.sent,Me.abrupt("return",Ue);case 9:case "end":return Me.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"LivelyRollup"}}],td,{pathInPackage:function(){return"./src/bundler.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:3786,end:43864})}(void 0);ib["default"]=Ub;var pc=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/plugins/rollup.js");pc.isBuiltin=function(Tc,td){return Tc.startsWith("node:")||td.builtinModules.includes(Tc)};pc.isCommonJsModule=function(Tc){return Tc.includes("?commonjs-external")||
Tc.includes("?commonjs-exports")||Tc.includes("?commonjs-entry")||Tc.includes("commonjsHelpers.js")};pc.LivelyRollup=Ub;pc.customWarn=Ye;pc.ROOT_ID=fb;pc.obj=ab;var Dc=window.lively.FreezerRuntime.recorderFor("lively.freezer/index.js");Dc.clearWorldSnapshot=function(Tc){var td=[],hd=[];Dc.obj.values(Tc.snapshot).forEach(function(gc){return delete gc.props.metadata});Dc.transpileAttributeConnections(Tc);for(var aa in Tc.snapshot){delete Tc.snapshot[aa].props.localComponents;delete Tc.snapshot[aa].props.metadata;
delete Tc.snapshot[aa]._cachedLineCharBounds;aa===Tc.id&&(Tc.snapshot[aa].props.showsUserFlap={value:!1});var Sa=Dc.moduleOfId(Tc.snapshot,aa);Sa["package"]&&("lively.ide"===Sa["package"].name&&hd.push(aa),Dc.DEFAULT_EXCLUDED_MODULES_WORLD.includes(Sa["package"].name)&&(delete Tc.snapshot[aa],td.push(aa)))}for(var Ma in Tc.snapshot)if(aa=Dc.classNameOfId(Tc.snapshot,Ma),0<Dc.arr.intersect(Dc.referencesOfId(Tc.snapshot,Ma),[].concat(td,hd)).length)if("Window"===aa)delete Tc.snapshot[Ma];else for(aa=
0,Sa=Object.entries(Tc.snapshot[Ma].props);aa<Sa.length;aa++){var jb=Fa(Sa[aa],2),Jb=jb[0];jb=jb[1].value;Dc.isReference(jb)&&td.includes(jb.id)&&delete Tc.snapshot[Ma].props[Jb];Array.isArray(jb)&&(Tc.snapshot[Ma].props[Jb].value=jb.filter(function(gc){return!(Dc.isReference(gc)&&td.includes(gc.id))}))}Dc.removeUnreachableObjects([Tc.id],Tc.snapshot);return Tc};Dc.promptForFreezing=function(Tc,td){return jg.apply(this,arguments)};Dc.bundlePart=Og;Dc.bundleModule=Eh;Dc.jspmCompile=Gi;Dc.bootstrapLibrary=
Ii;Dc.interactivelyFreezeWorld=Ji;Dc.interactivelyFreezePart=xj;Dc.interactivelyFreezeModule=Ti;Dc.rollup=Sb;Dc.jsonPlugin=Hd;Dc.part=ic;Dc.resource=Wb;Dc.Path=Db;Dc.obj=ab;Dc.arr=sb;Dc.LoadingIndicator=Sc;Dc.removeUnreachableObjects=wb;Dc.createMorphSnapshot=Na;Dc.serializeMorph=hb;Dc.moduleOfId=Ib;Dc.isReference=Bb;Dc.referencesOfId=ba;Dc.classNameOfId=rb;Dc.defaultDirectory=dc;Dc.FreezerPrompt=qa;Dc.transpileAttributeConnections=Cd;Dc.writeFiles=Ee;Dc.topLevelDeclsAndRefs=la;Dc.parse=Fb;Dc.stringify=
vb;Dc.BrowserResolver=O;Dc.lively=Kf;Dc.DEFAULT_EXCLUDED_MODULES_PART=["kld-intersections"];Dc.DEFAULT_EXCLUDED_MODULES_WORLD="lively.ast lively.vm lively-system-interface pouchdb pouchdb-adapter-mem rollup lively.halos".split(" ");Dc.DEFAULT_EXCLUDED_MODULES="lively.ast lively.vm lively-system-interface pouchdb pouchdb-adapter-mem rollup lively.halos lively.ide lively.freezer lively.modules lively.storage lively.user".split(" ");Dc.bundlePart=Og;Dc.bundleModule=Eh;Dc.jspmCompile=Gi;Dc.bootstrapLibrary=
Ii;Dc.interactivelyFreezeWorld=Ji;Dc.interactivelyFreezePart=xj;Dc.interactivelyFreezeModule=Ti;var kd=window.lively.FreezerRuntime.recorderFor("lively.ide/service-worker.js");kd.startWorker=function(){return Mg.apply(this,arguments)};kd.initWorker=function(){var Tc=kd.worker.create({workerId:"@lively-worker",scriptsToLoad:["lively.next-node_modules/babel-standalone/babel.js","lively.next-node_modules/systemjs/dist/system.src.js","lively.modules/dist/lively.modules.js","lively.ide/jsdom.worker.js"].map(function(td){return System.baseURL+
td})});Tc.eval("("+kd.stringifyFunctionWithoutToplevelRecorder(Rc(regeneratorRuntime.mark(function hd(){var aa,Sa,Ma,jb,Jb,gc,ac;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=Kc.next){case 0:return ac=function(){ac=Rc(regeneratorRuntime.mark(function ze(ud,oe){var Ue;return regeneratorRuntime.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return Ue=Sa(ud),Me.next=3,Ue.exists();case 3:Me.t0=!Me.sent;if(!Me.t0){Me.next=6;break}Me.t0=Ue.localBackend;case 6:if(!Me.t0){Me.next=
20;break}if(oe){Me.next=14;break}Me.next=10;return System._livelyModulesTranslationCache.fetchStoredModuleSource(ud);case 10:Me.t1=Me.sent;if(Me.t1){Me.next=13;break}Me.t1={};case 13:oe=Me.t1.source;case 14:if(!oe){Me.next=19;break}Me.next=17;return Ue.write(oe);case 17:Me.next=20;break;case 19:console.log("No source available for ",ud);case 20:return Me.prev=20,ud.includes("/package.json")&&Jb(ud.replace("/package.json","")),Me.next=24,jb(ud).source();case 24:Me.next=28;break;case 26:Me.prev=26,
Me.t2=Me["catch"](20);case 28:case "end":return Me.stop()}},ze,null,[[20,26]])}));return ac.apply(this,arguments)},gc=function(md,ud){return ac.apply(this,arguments)},Kc.next=4,lively.lang.promise.waitFor(5E3,function(){return self.initialized});case 4:return Kc.next=6,Dd.import("./index-42118cd5.js");case 6:return Kc.next=8,Promise.resolve().then(function(){return Ad});case 8:return Kc.next=10,Dd.import("./__rootModule___commonjs-entry-51a55f66.js").then(function(md){return md.cc});case 10:return aa=
Kc.sent,Sa=aa.resource,Kc.next=14,Dd.import("./index-616023be.js").then(function(md){return md.a});case 14:Ma=Kc.sent,jb=Ma.module,Jb=Ma.registerPackage,self.messenger.addServices({ensureModules:function(){var md=Rc(regeneratorRuntime.mark(function Ue(oe,ze){var Me,xf,lf,Rf,Hg,ng,fg;return regeneratorRuntime.wrap(function(gg){for(;;)switch(gg.prev=gg.next){case 0:Me=oe.data,xf=Me.loadedModules,lf=Me.sources,Rf=void 0===lf?{}:lf,Hg=M(xf),gg.prev=2,Hg.s();case 4:if((ng=Hg.n()).done){gg.next=11;break}fg=
ng.value;if(System._loader.modules[fg]){gg.next=9;break}gg.next=9;return gc(fg,Rf[fg]);case 9:gg.next=4;break;case 11:gg.next=16;break;case 13:gg.prev=13,gg.t0=gg["catch"](2),Hg.e(gg.t0);case 16:return gg.prev=16,Hg.f(),gg.finish(16);case 19:ze.answer(oe,!0);case 20:case "end":return gg.stop()}},Ue,null,[[2,13,16,19]])}));return function(oe,ze){return md.apply(this,arguments)}}(),updateModule:function(){var md=Rc(regeneratorRuntime.mark(function Ue(oe,ze){var Me,xf,lf,Rf,Hg;return regeneratorRuntime.wrap(function(ng){for(;;)switch(ng.prev=
ng.next){case 0:return ng.next=2,Dd.import("./index-616023be.js").then(function(fg){return fg.a});case 2:Me=ng.sent;xf=Me.module;lf=oe.data;Rf=lf.module;Hg=lf.newSource;if(System._loader.modules[Rf]){ng.next=11;break}ng.next=8;return gc(Rf,Hg);case 8:ze.answer(oe,!0);ng.next=14;break;case 11:return ng.next=13,xf(Rf).changeSource(Hg);case 13:ze.answer(oe,!0);case 14:case "end":return ng.stop()}},Ue)}));return function(oe,ze){return md.apply(this,arguments)}}(),loadModule:function(){var md=Rc(regeneratorRuntime.mark(function Ue(oe,
ze){var Me,xf,lf;return regeneratorRuntime.wrap(function(Rf){for(;;)switch(Rf.prev=Rf.next){case 0:Me=oe.data;xf=Me.module;lf=Me.source;if(System._loader.modules[xf]){Rf.next=4;break}Rf.next=4;return gc(xf,lf);case 4:ze.answer(oe,!0);case 5:case "end":return Rf.stop()}},Ue)}));return function(oe,ze){return md.apply(this,arguments)}}(),freezeSnapshot:function(){var md=Rc(regeneratorRuntime.mark(function Ue(oe,ze){return regeneratorRuntime.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:case "end":return Me.stop()}},
Ue)}));return function(oe,ze){return md.apply(this,arguments)}}(),exportsOfModules:function(){var md=Rc(regeneratorRuntime.mark(function Ue(oe,ze){var Me,xf,lf,Rf,Hg,ng,fg,gg,Wh,wg;return regeneratorRuntime.wrap(function(xh){for(;;)switch(xh.prev=xh.next){case 0:return xh.next=2,Dd.import("./index-42118cd5.js");case 2:return Me=xh.sent,xf=Me.localInterface,xh.next=6,Dd.import("./__rootModule___commonjs-entry-51a55f66.js").then(function(Qi){return Qi.cb});case 6:return lf=xh.sent,Rf=lf.deserialize,
Hg=Rf(oe.data),ng=Hg.livelySystem,fg=void 0===ng?xf:ng,gg=Hg.excludedPackages,Wh=void 0===gg?[]:gg,wg=Hg.progress,xh.next=11,lively.lang.promise.waitFor(5E3,function(){return!self.loadingModules});case 11:return xh.t0=ze,xh.t1=oe,xh.next=15,fg.exportsOfModules({excludedPackages:Wh,progress:wg&&wg.asWorkerEndpoint(oe)});case 15:xh.t2=xh.sent,xh.t0.answer.call(xh.t0,xh.t1,xh.t2);case 17:case "end":return xh.stop()}},Ue)}));return function(oe,ze){return md.apply(this,arguments)}}(),doSearch:function(){var md=
Rc(regeneratorRuntime.mark(function Ue(oe,ze){var Me,xf,lf,Rf,Hg,ng,fg,gg,Wh,wg,xh,Qi,Di;return regeneratorRuntime.wrap(function(Zi){for(;;)switch(Zi.prev=Zi.next){case 0:return Zi.next=2,Dd.import("./__rootModule___commonjs-entry-51a55f66.js").then(function(ni){return ni.cb});case 2:return Me=Zi.sent,xf=Me.deserialize,Zi.next=6,Promise.resolve().then(function(){return cf});case 6:return lf=Zi.sent,Rf=lf.doSearch,Hg=xf(oe.data),ng=Hg.excludedModules,fg=Hg.excludedPackages,gg=Hg.livelySystem,Wh=Hg.searchTerm,
wg=Hg.includeUnloaded,xh=Hg.caseSensitive,Qi=Hg.progress,Zi.next=11,Rf(gg,Wh,ng,fg,wg,xh,Qi&&Qi.asWorkerEndpoint(oe));case 11:Di=Zi.sent,ze.answer(oe,Di);case 13:case "end":return Zi.stop()}},Ue)}));return function(oe,ze){return md.apply(this,arguments)}}()});case 18:case "end":return Kc.stop()}},hd)})))+")()",function(){});kd.subscribe("lively.modules/moduleloaded",function(){var hd=Rc(regeneratorRuntime.mark(function Ma(Sa){return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.t0=
kd,jb.t1=Sa.module,jb.next=4,kd.module(Sa.module).source();case 4:jb.t2=jb.sent,jb.t3={module:jb.t1,source:jb.t2},jb.t0.callService.call(jb.t0,"loadModule",jb.t3,!1);case 7:case "end":return jb.stop()}},Ma)}));return function(Sa){return hd.apply(this,arguments)}}());kd.subscribe("lively.modules/modulechanged",function(hd){return kd.callService("updateModule",hd,!1)});return Tc};kd.callService=Hh;kd.detectProgressMonitor=function(Tc){if(Tc&&Tc.isProgressMonitor)return Tc;if(kd.obj.isObject(Tc))return kd.obj.values(Tc).find(function(td){return td&&
td.isProgressMonitor})};kd.prepareArguments=function(Tc){return kd.serialize(Tc,{plugins:[{serializeObject:function(td,hd,aa,Sa,Ma){if(kd.obj.isRegExp(td))return aa.expressionSerializer.exprStringEncode({__expr__:String(td)});if(kd.obj.isFunction(td))return aa.expressionSerializer.exprStringEncode({__expr__:String(td).replace("function ","function _lambda_")})}}].concat(Xa(kd.allPlugins))})};kd.commonjsHelpers=Gb;kd.allPlugins=Ia;kd.serialize=xb;kd.deserialize=Rb;kd.obj=ab;kd.string=fa;kd.properties=
yc;kd.worker=id;kd.promise=ob;kd.subscribe=Pb;kd.module=ra;kd.config=da;kd.stringifyFunctionWithoutToplevelRecorder=tb;!System.get("@system-env").worker&&kd.config.ide.workerEnabled&&!System.get("@lively-worker")&&kd.startWorker();kd.callService=Hh;qa=bd("P",function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/service-worker.js"),hd=td.hasOwnProperty("ProgressMonitor")&&"function"===typeof td.ProgressMonitor?td.ProgressMonitor:td.ProgressMonitor=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return db(hd,Tc,[{key:Symbol["for"]("lively-instance-initialize"),value:function(){var aa=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Sa=aa.id;Sa=void 0===Sa?xc():Sa;aa=aa.handlers;aa=void 0===aa?{}:aa;this.id=Sa;this.handlers=aa}},{key:"isProgressMonitor",get:function(){return!0}},{key:"step",value:function(aa,Sa){for(var Ma in this.handlers)this.handlers[Ma](aa,Sa)}},{key:"disconnectFromWorker",value:function(){System.get("@lively-worker").removeAllListeners(this.id)}},
{key:"asWorkerEndpoint",value:function(aa){var Sa=new kd.WorkerProgressMonitor({id:this.id});Sa.workerMessageObj=aa;return Sa}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ProgressMonitor"}}],td,{pathInPackage:function(){return"./service-worker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6713,end:7358})}(void 0));
kd.ProgressMonitor=qa;kd.ProgressMonitor=qa;O=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/service-worker.js"),hd=td.hasOwnProperty("WorkerProgressMonitor")&&"function"===typeof td.WorkerProgressMonitor?td.WorkerProgressMonitor:td.WorkerProgressMonitor=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"isWorkerEndpoint",get:function(){return!0}},{key:"step",
value:function(aa,Sa){self.messenger.answer(this.workerMessageObj,{stepName:aa,progress:Sa},!0)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"WorkerProgressMonitor"}}],td,{pathInPackage:function(){return"./service-worker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:7425,end:7659})}(kd.ProgressMonitor);kd.WorkerProgressMonitor=
O;kd.WorkerProgressMonitor=O;var Ad=Object.freeze({__proto__:null,callService:Hh,ProgressMonitor:qa,WorkerProgressMonitor:O}),Rd=window.lively.FreezerRuntime.recorderFor("lively.ide/code-search.js");Rd.doSearch=z;Rd.fun=lc;Rd.arr=sb;Rd.obj=ab;Rd.string=fa;Rd.pt=ad;Rd.Color=Ne;Rd.Rectangle=Pc;Rd.config=da;Rd.connect=nd;Rd.noUpdate=Id;Rd.localInterface=Fe;Rd.LoadingIndicator=Sc;Rd.Window=Ea;Rd.FilterableList=ia;Rd.MorphicDB=Hb;Rd.SnapshotEditor=Kd;Rd.callService=Hh;Rd.ProgressMonitor=qa;Rd.show=Pd;
Rd.ModeButtonActive=Ge;Rd.ModeButtonDisabled=Rg;Rd.ModeButtonInactiveClick=Rh;Rd.ModeButtonInactiveHover=eh;Rd.ModeButtonInactive=Se;Rd.ModeButtonActiveClick=mh;Rd.ModeButtonActiveHover=dh;Rd.doSearch=z;Ge=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/code-search.js"),hd=td.hasOwnProperty("CodeSearcher")&&"function"===typeof td.CodeSearcher?td.CodeSearcher:td.CodeSearcher=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return db(hd,Tc,[{key:Symbol["for"]("lively-instance-initialize"),value:function(){var aa=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};aa.targetBrowser&&(aa.browser=aa.targetBrowser);db._get(Object.getPrototypeOf(hd.prototype),Symbol["for"]("lively-instance-initialize"),this).call(this,aa);this.reset()}},{key:"onLoad",value:function(){this.reset()}},{key:"reset",value:function(){var aa=this;this.regexModeActive=this.caseModeActive=!1;this.currentSearchTerm="";Rd.connect(this,
"accepted",this,"openSelection");this.get("list").items=[];this.get("input").input="";this.get("search chooser").items=["in loaded modules","in loaded and unloaded modules","in parts","in worlds"];Rd.noUpdate(function(){aa.get("search chooser").selection="in loaded modules"});this.getWindow()&&(this.getWindow().title="code search");Rd.connect(this.get("caseMode").viewModel,"fire",this,"caseModeToggled",{converter:'() => target.searchModeToggled("case")'});Rd.connect(this.get("regexMode").viewModel,
"fire",this,"regexModeToggled",{converter:'() => target.searchModeToggled("regex")'});Rd.connect(this.get("search chooser").viewModel,"selection",this,"handleSpecialSearchModes");Rd.connect(this.get("search chooser").viewModel,"selection",this,"searchAgain");Rd.connect(this.get("input"),"inputChanged",this,"updateFilter");Rd.connect(this.get("list"),"selection",this,"selectionChanged");Rd.connect(this.get("list"),"onItemMorphDoubleClicked",this,"acceptInput")}},{key:"handleSpecialSearchModes",value:function(){this.regexModeActive=
this.caseModeActive=!1;var aa=this.get("search chooser").selection;"in worlds"===aa||"in parts"===aa?(this.get("caseMode").master={auto:Rd.ModeButtonDisabled},this.get("regexMode").master={auto:Rd.ModeButtonDisabled}):[this.get("caseMode"),this.get("regexMode")].forEach(function(Sa){return Sa.master={auto:Rd.ModeButtonInactive,hover:Rd.ModeButtonInactiveHover,click:Rd.ModeButtonInactiveClick}})}},{key:"searchModeToggled",value:function(aa){var Sa="case"===aa?this.get("caseMode"):this.get("regexMode");
if("case"===aa)var Ma=this.caseModeActive=!this.caseModeActive;"regex"===aa&&(Ma=this.regexModeActive=!this.regexModeActive);Sa.master=Ma?{auto:Rd.ModeButtonActive,hover:Rd.ModeButtonActiveHover,click:Rd.ModeButtonActiveClick}:{auto:Rd.ModeButtonInactive,hover:Rd.ModeButtonInactiveHover,click:Rd.ModeButtonInactiveClick};this.searchAgain()}},{key:"ensureIndicator",value:function(aa,Sa){if(!this.progressIndicator){var Ma=this.getWindow();this.progressIndicator=this.addMorph(Rd.LoadingIndicator.open());
Ma&&(this.progressIndicator.center=Ma.innerBounds().center())}this.progressIndicator.label="Searching Files";this.progressIndicator.status=aa;Sa&&(this.progressIndicator.progress=Sa)}},{key:"removeIndicator",value:function(){this.progressIndicator&&this.progressIndicator.remove();this.progressIndicator=null}},{key:"updateFilter",value:function(){var aa=this,Sa=this.get("input").textString;2>=Sa.length||(this.ensureIndicator("receiving input..."),Rd.fun.debounceNamed(this.id+"updateFilterDebounced",
1200,function(){var Ma=Rc(regeneratorRuntime.mark(function gc(Jb){return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return aa.removeIndicator(),ac.prev=1,ac.next=4,aa.searchAndUpdate(Jb);case 4:ac.next=9;break;case 6:ac.prev=6,ac.t0=ac["catch"](1),aa.world().logError(ac.t0);case 9:case "end":return ac.stop()}},gc,null,[[1,6]])}));return function(Jb){return Ma.apply(this,arguments)}}())(Sa))}},{key:"searchAgain",value:function(){var aa=this.currentSearchTerm;2>=aa||
(this.getSubmorphNamed("list").items=[],this.currentSearchTerm="",this.searchAndUpdate(aa))}},{key:"searchAndUpdate",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb=this,gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf,lf,Rf,Hg,ng;return regeneratorRuntime.wrap(function(fg){for(;;)switch(fg.prev=fg.next){case 0:this.get("search chooser").right=this.width-5;this.get("input").acceptInput();gc=Ma.split(/\s+/).filter(function(gg){return!!gg});(ac=this.getWindow())&&ac.targetMorph===this&&(ac.title=
"".concat(ac.title.split("-")[0].trim()," - ").concat(gc.join(" + ")));Kc=gc.shift();md=Kc!==this.currentSearchTerm;if(!md){fg.next=34;break}this.currentSearchTerm=Kc;ud=this.get("search chooser").selection;oe="in loaded modules"===ud;ze="in loaded and unloaded modules"===ud;Ue="in parts"===ud;Me="in worlds"===ud;this.ensureIndicator("searching...");xf=new Rd.ProgressMonitor({handlers:{loadingIndicatorUpdater:function(gg,Wh){Jb.ensureIndicator(gg,Wh)}}});if(!oe&&!ze){fg.next=22;break}fg.next=19;return Rd.doSearch(this.systemInterface,
Kc,void 0,Rd.config.ide.js.ignoredPackages,!!ze,this.caseModeActive,this.regexModeActive,xf);case 19:this.items=fg.sent;fg.next=32;break;case 22:if(!Ue&&!Me){fg.next=32;break}fg.next=25;return $world.addProgressBar({label:"morphicdb search"});case 25:return lf=fg.sent,Rf=Me?"world":"part",fg.next=29,Rd.MorphicDB["default"].codeSearchInPackages(Kc,Rf,function(gg,Wh,wg){return Object.assign(lf,{label:gg,progress:Wh/wg})});case 29:Hg=fg.sent,lf.remove(),this.items=Hg.map(function(gg){var Wh=gg.file.path.slice(1).reduce(function(wg,
xh){return Rd.string.joinPath(wg,xh)});300<=gg.lineString&&(gg.lineString=Rd.string.truncate(gg.lineString,300));gg.isMorphicDBFind=!0;return{isListItem:!0,string:"[".concat(gg.commit.type,"/").concat(gg.commit.name,"] ").concat(Wh,":").concat(gg.line," ").concat(gg.lineString),value:gg}});case 32:this.removeIndicator(),this.progressIndicator=null;case 34:if(gc=gc.map(function(gg){return gg.toLowerCase()}),md||this.currentFilters!==gc.join("+"))this.currentFilters=gc.join("+"),ng=this.items.filter(function(gg){return gc.every(function(Wh){return gg.string.toLowerCase().includes(Wh)})}),
this.get("list").items=ng;case 36:case "end":return fg.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"openSelection",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:if(jb=this.selection){Jb.next=3;break}return Jb.abrupt("return");case 3:if(!jb.isMorphicDBFind){Jb.next=5;break}return Jb.abrupt("return",(new Rd.SnapshotEditor(jb.commit)).interactivelyEditFileInSnapshotPackage(jb.file,
function(){},{row:jb.line,column:0}));case 5:return Jb.abrupt("return",this.openBrowserForSelection());case 6:case "end":return Jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"openBrowserForSelection",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc,ac,Kc,md,ud,oe,ze;return regeneratorRuntime.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:if(this.selection){Ue.next=2;break}return Ue.abrupt("return");case 2:return jb=this.browser,
Jb=this.selection,gc=Jb.column,ac=Jb.line,Kc=Jb.packageName,md=Jb.pathInPackage,ud=jb,oe={packageName:Kc,moduleName:md,textPosition:{column:gc,row:ac-1}},Ue.next=7,Dd.import("./ui.cp-499efc12.js");case 7:return ze=Ue.sent,Ue.next=10,ze.browse(oe,ud||{},jb?jb.systemInterface:this.systemInterface);case 10:return jb=Ue.sent,jb.associatedSearchPanel=this,Ue.abrupt("return",jb.getWindow().activate());case 13:case "end":return Ue.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},
{key:"onWindowActivated",value:function(){this.get("input").selectAll()}},{key:"commands",get:function(){var aa=this.get("search chooser");return db._get(Object.getPrototypeOf(hd.prototype),"commands",this).concat([{name:"toggle search in unloaded modules",exec:function(){aa.selection="in loaded modules"===aa.selection?"in loaded and unloaded modules":"in loaded modules";return!0}},{name:"toggle search in parts",exec:function(){aa.selection="in parts";return!0}},{name:"toggle search in worlds",exec:function(){aa.selection=
"in worlds";return!0}}])}},{key:"keybindings",get:function(){return[{keys:"F1",command:"toggle search in unloaded modules"},{keys:"F2",command:"toggle search in parts"},{keys:"F3",command:"toggle search in worlds"}].concat(db._get(Object.getPrototypeOf(hd.prototype),"keybindings",this))}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"CodeSearcher"}},{key:"inWindow",value:function(){var aa=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{title:"code search",targetBrowser:null,
systemInterface:null},Sa=new this(aa);aa=new Rd.Window(Object.assign({},Rd.obj.dissoc(aa,["targetBrowser","systemInterface"]),{extent:Sa.extent.addXY(0,25),targetMorph:Sa}));Rd.connect(aa,"windowActivated",Sa,"onWindowActivated");return aa}},{key:"properties",get:function(){return{fill:{defaultValue:Rd.Color.transparent},extent:{defaultValue:Rd.pt(800,500)},fontFamily:{defaultValue:"Monaco, monospace"},fontSize:{defaultValue:12},inputPadding:{defaultValue:Rd.Rectangle.inset(5)},itemPadding:{defaultValue:Rd.Rectangle.inset(4,
2)},borderWidth:{defaultValue:0},historyId:{defaultValue:"lively.morphic-code searcher"},submorphs:{initialize:function(){this.submorphs=[{type:"input",name:"input",placeholder:"Search Source Files",fontColor:Rd.Color.gray.darker(),defaultTextStyle:{fontSize:14},autofit:!0,fill:Rd.Color.white.withA(.5)},{name:"list",type:"list",items:[],clipMode:"auto",borderTop:{width:1,color:Rd.Color.gray}}]}},input:{after:["submorphs"],derived:!0,get:function(){return this.getSubmorphNamed("input").input},set:function(aa){this.getSubmorphNamed("input").input=
aa}},browser:{set:function(aa){this.setProperty("browser",aa?aa.id:null)},get:function(){var aa=this.world(),Sa=this.getProperty("browser");return aa&&Sa?aa.getMorphWithId(Sa):null}},systemInterface:{after:["browser"],derived:!0,get:function(){var aa=this.browser;return aa?aa.systemInterface:this.getProperty("systemInterface")||Rd.localInterface},set:function(aa){var Sa=this.browser;Sa?Sa.systemInterface=aa:this.setProperty("systemInterface",aa)}},currentSearchTerm:{defaultValue:""},currentFilters:{defaultValue:""}}}}],
td,{pathInPackage:function(){return"./code-search.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:2293,end:13959})}(Rd.FilterableList);Rd.CodeSearcher=Ge;Rd.CodeSearcher=Ge;var cf=Object.freeze({__proto__:null,doSearch:z,CodeSearcher:Ge}),Ud=window.lively.FreezerRuntime.recorderFor("lively.ide/code-search.cp.js");Ud.ProportionalLayout=
Ed;Ud.Icon=vd;Ud.TilingLayout=Sd;Ud.component=Od;Ud.add=qb;Ud.part=ic;Ud.pt=ad;Ud.Color=Ne;Ud.rect=Cb;Ud.InputLineDefault=wa;Ud.DropDownList=hf;Ud.DefaultList=zf;Ud.SystemList=vg;Ud.CodeSearcher=Ge;Ud.ButtonDefault=Ic;Ud.ModeButtonInactive=Ud.component["for"](function(){return Ud.component(Ud.ButtonDefault,{extent:Ud.pt(27,27),borderStyle:"none",fill:Ud.Color.transparent})},{module:"lively.ide/code-search.cp.js","export":"ModeButtonInactive",range:{start:460,end:581}},Ud.ModeButtonInactive);Ud.ModeButtonInactiveHover=
Ud.component["for"](function(){return Ud.component(Ud.ModeButtonInactive,{fill:Ud.Color.gray})},{module:"lively.ide/code-search.cp.js","export":"ModeButtonInactiveHover",range:{start:589,end:668}},Ud.ModeButtonInactiveHover);Ud.ModeButtonActiveClick=Ud.ModeButtonInactiveHover;Ud.ModeButtonInactiveClick=Ud.component["for"](function(){return Ud.component(Ud.ModeButtonInactive,{fill:Ud.Color.darkGray})},{module:"lively.ide/code-search.cp.js","export":"ModeButtonInactiveClick",range:{start:731,end:814}},
Ud.ModeButtonInactiveClick);Ud.ModeButtonActiveHover=Ud.ModeButtonInactiveClick;Ud.ModeButtonActive=Ud.component["for"](function(){return Ud.component(Ud.ModeButtonInactive,{fill:Ud.Color.darkGray,submorphs:[{name:"label",fontColor:Ud.Color.white}]})},{module:"lively.ide/code-search.cp.js","export":"ModeButtonActive",range:{start:877,end:1021}},Ud.ModeButtonActive);Ud.ModeButtonDisabled=Ud.component["for"](function(){return Ud.component(Ud.ModeButtonInactive,{visible:!1,reactsToPointer:!1})},{module:"lively.ide/code-search.cp.js",
"export":"ModeButtonDisabled",range:{start:1029,end:1127}},Ud.ModeButtonDisabled);Ud.CodeSearch=Ud.component["for"](function(){return Ud.component({type:Ud.CodeSearcher,name:"code search",acceptsDrops:!1,extent:Ud.pt(538,306),layout:new Ud.ProportionalLayout({lastExtent:{x:538,y:306},reactToSubmorphAnimations:!1,submorphSettings:[["input",{x:"resize",y:"fixed"}],["list",{x:"resize",y:"resize"}],["searchInUnloadedModulesCheckbox",{x:"move",y:"move"}],["search in parts checkbox",{x:"move",y:"move"}],
["search in worlds checkbox",{x:"move",y:"move"}],["search chooser",{x:"move",y:"fixed"}]]}),selectedAction:"default",submorphs:[Ud.part(Ud.DefaultList,{name:"list",extent:Ud.pt(538.7,279.6),fontFamily:"Monaco, monospace",itemPadding:Ud.rect(4,2,0,0),padding:Ud.rect(2,0,0,0),position:Ud.pt(0,27)}),Ud.part(Ud.InputLineDefault,{name:"input",layout:new Ud.TilingLayout({align:"center",axisAlign:"center",justifySubmorphs:"spaced",orderByIndex:!0,padding:Ud.rect(5,0,0,0),wrapSubmorphs:!1}),borderWidth:1,
dropShadow:null,fontSize:14,borderRadius:0,extent:Ud.pt(538.7,27),historyId:"lively.morphic-code searcher",placeholder:"Search Source Files",submorphs:[{name:"placeholder",extent:Ud.pt(133,27),fontSize:14,padding:Ud.rect(5,5,0,0),textAndAttributes:["Search Source Files",null]},Ud.add({name:"buffer",opacity:0,reactsToPointer:!1}),Ud.add({name:"holder",layout:new Ud.TilingLayout({axisAlign:"center",spacing:2,align:"center",axis:"column"}),submorphs:[Ud.part(Ud.ModeButtonInactive,{name:"caseMode",height:22,
submorphs:[{name:"label",textAndAttributes:Ud.Icon.textAttribute("circle-h")}],master:{auto:Ud.ModeButtonInactive,hover:Ud.ModeButtonInactiveHover,click:Ud.ModeButtonInactiveClick},tooltip:"Search Case Sensitive"}),Ud.part(Ud.ModeButtonInactive,{name:"regexMode",height:22,submorphs:[{name:"label",textAndAttributes:Ud.Icon.textAttribute("circle-question")}],master:{auto:Ud.ModeButtonInactive,hover:Ud.ModeButtonInactiveHover,click:Ud.ModeButtonInactiveClick},tooltip:"Search based on regular expressions.\nRegular expression should be given without quotes or literal mode slashes."}),
Ud.part(Ud.DropDownList,{name:"search chooser",master:{auto:Ud.ModeButtonActive,click:Ud.ModeButtonInactiveClick},layout:new Ud.TilingLayout({align:"center",axisAlign:"center",orderByIndex:!0,padding:Ud.rect(10,0,0,0),wrapSubmorphs:!1,hugContentsHorizontally:!0}),extent:Ud.pt(125.7,22),borderColor:Ud.Color.gray,viewModel:{openListInWorld:!0,listMaster:Ud.SystemList,items:["in loaded modules","in loaded and unloaded modules","in parts","in worlds"]},submorphs:[{name:"label",fontSize:12}]})]})]})]})},
{module:"lively.ide/code-search.cp.js","export":"CodeSearch",range:{start:1170,end:4639}},Ud.CodeSearch);qa=Ud.CodeSearch;var Ge=Ud.ModeButtonActive,Se=Ud.ModeButtonInactive,mh=Ud.ModeButtonActiveClick,Rh=Ud.ModeButtonInactiveClick,dh=Ud.ModeButtonActiveHover,eh=Ud.ModeButtonInactiveHover,Rg=Ud.ModeButtonDisabled;Ud.CodeSearch=qa;Ud.ModeButtonActive=Ge;Ud.ModeButtonInactive=Se;Ud.ModeButtonActiveClick=mh;Ud.ModeButtonInactiveClick=Rh;Ud.ModeButtonActiveHover=dh;Ud.ModeButtonInactiveHover=eh;Ud.ModeButtonDisabled=
Rg;var $c=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js");$c.InputLine=vc;$c.easings=ve;$c.touchInputDevice=Qc;$c.morph=kb;$c.World=Cc;$c.MorphicDB=Hb;$c.HorizontalLayout=dd;$c.Image=se;$c.HTMLMorph=zc;$c.Morph=Fc;$c.Icon=vd;$c.TilingLayout=Sd;$c.Label=fe;$c.ProportionalLayout=Ed;$c.ShadowObject=uc;$c.component=Od;$c.part=ic;$c.connect=nd;$c.moduleManager=Ya;$c.Color=Ne;$c.LinearGradient=xd;$c.rect=Cb;$c.pt=ad;$c.arr=sb;$c.promise=ob;$c.fun=lc;$c.graph=Uc;$c.date=
Md;$c.string=fa;$c.GreenButton=pa;$c.RedButton=P;$c.PlainButton=Ca;$c.DropDownList=hf;$c.MorphList=w;$c.LoadingIndicator=Sc;$c.UserUI=Pf;$c.Spinner=tg;$c.SystemList=vg;$c.missingSVG='data:image/svg+xml;utf8,\n<svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="question-circle" class="svg-inline--fa fa-question-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="lightgray" d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 448c-110.532 0-200-89.431-200-200 0-110.495 89.472-200 200-200 110.491 0 200 89.471 200 200 0 110.53-89.431 200-200 200zm107.244-255.2c0 67.052-72.421 68.084-72.421 92.863V300c0 6.627-5.373 12-12 12h-45.647c-6.627 0-12-5.373-12-12v-8.659c0-35.745 27.1-50.034 47.579-61.516 17.561-9.845 28.324-16.541 28.324-29.579 0-17.246-21.999-28.693-39.784-28.693-23.189 0-33.894 10.977-48.942 29.969-4.057 5.12-11.46 6.071-16.666 2.124l-27.824-21.098c-5.107-3.872-6.251-11.066-2.644-16.363C184.846 131.491 214.94 112 261.794 112c49.071 0 101.45 38.304 101.45 88.8zM298 368c0 23.159-18.841 42-42 42s-42-18.841-42-42 18.841-42 42-42 42 18.841 42 42z"></path></svg>\n';
$c.missingSVG='data:image/svg+xml;utf8,\n<svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="question-circle" class="svg-inline--fa fa-question-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="lightgray" d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 448c-110.532 0-200-89.431-200-200 0-110.495 89.472-200 200-200 110.491 0 200 89.471 200 200 0 110.53-89.431 200-200 200zm107.244-255.2c0 67.052-72.421 68.084-72.421 92.863V300c0 6.627-5.373 12-12 12h-45.647c-6.627 0-12-5.373-12-12v-8.659c0-35.745 27.1-50.034 47.579-61.516 17.561-9.845 28.324-16.541 28.324-29.579 0-17.246-21.999-28.693-39.784-28.693-23.189 0-33.894 10.977-48.942 29.969-4.057 5.12-11.46 6.071-16.666 2.124l-27.824-21.098c-5.107-3.872-6.251-11.066-2.644-16.363C184.846 131.491 214.94 112 261.794 112c49.071 0 101.45 38.304 101.45 88.8zM298 368c0 23.159-18.841 42-42 42s-42-18.841-42-42 18.841-42 42-42 42 18.841 42 42z"></path></svg>\n';
(function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js"),hd=td.hasOwnProperty("WorldVersion")&&"function"===typeof td.WorldVersion?td.WorldVersion:td.WorldVersion=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"update",value:function(){var aa=Fa(this.submorphs,2),Sa=aa[1];aa[0].imageUrl=this.commit.preview||$c.missingSVG;Sa.textAndAttributes=
this.info;Sa.fontColor=this.selected?$c.Color.white:$c.Color.darkGray}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"WorldVersion"}},{key:"properties",get:function(){return{commit:{},fill:{defaultValue:$c.Color.transparent},info:{derived:!0,get:function(){var aa=this.commit,Sa=aa.message,Ma=aa.name,jb=aa.timestamp;return["".concat(aa._id.slice(0,6)," "),{fontWeight:"bold"},"".concat($c.string.truncate(Sa.split("\n")[0],40)," "),{}," (".concat(Ma," "),{},"".concat($c.date.format(new Date(jb),
"yyyy-mm-dd HH:MM Z")),{}]}},selected:{set:function(aa){this.setProperty("selected",aa);this.update()}},layout:{initialize:function(){this.layout=new $c.HorizontalLayout({align:"center",spacing:5})}},submorphs:{initialize:function(){this.submorphs=[{type:"image",extent:$c.pt(30,30),name:"preview",reactsToPointer:!1},{reactsToPointer:!1,type:"label",fill:null,name:"commit info",fontFamily:"IBM Plex Sans",fontColor:$c.Color.gray}]}}}}}],td,{pathInPackage:function(){return"./studio/world-browser.cp.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1908,end:3486})})($c.Morph);Ge=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js"),hd=td.hasOwnProperty("WorldVersionViewer")&&"function"===typeof td.WorldVersionViewer?td.WorldVersionViewer:td.WorldVersionViewer=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return db(hd,Tc,[{key:"reset",value:function(){this.getSubmorphNamed("version list").items=[];this.getSubmorphNamed("version list spinner").visible=!1}},{key:"onMouseDown",value:function(aa){switch(aa.targetMorph.name){case "visit button":this.visitSelectedCommit();break;case "revert button":this.revertToSelectedCommit()}}},{key:"visitSelectedCommit",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc,ac,Kc,md;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=
ud.next){case 0:jb=this.get("version list").selection;Jb=$c.LoadingIndicator.open("Loading ".concat(jb.name,"..."));gc=$world;ac=this.db||$c.MorphicDB["default"];Kc=jb._id;ud.prev=5;if(!Kc){ud.next=12;break}ud.next=9;return $c.World.loadFromCommit(Kc,void 0,{morphicDB:ac});case 9:ud.t0=ud.sent;ud.next=15;break;case 12:return ud.next=14,$c.World.loadFromDB(jb.name,jb.ref,void 0,{morphicDB:ac});case 14:ud.t0=ud.sent;case 15:return md=ud.t0,ud.abrupt("return",md);case 19:ud.prev=19,ud.t1=ud["catch"](5),
console.error(ud.t1),gc.showError("Error loading world:"+ud.t1);case 23:return ud.prev=23,Jb.remove(),ud.finish(23);case 26:case "end":return ud.stop()}},Ma,this,[[5,19,23,26]])}));return function(){return aa.apply(this,arguments)}}()},{key:"revertToSelectedCommit",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc,ac,Kc;return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=md.next){case 0:if(jb=this.get("version list").selection){md.next=3;break}return md.abrupt("return");
case 3:return Jb=this.db||$c.MorphicDB["default"],gc=jb._id,ac=jb.name,Kc=jb.type,md.next=7,Jb.revert(Kc,ac,gc,"HEAD");case 7:return md.abrupt("return",this.initializeFromStartCommit(jb,Jb,{showRevertButton:!0}));case 8:case "end":return md.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"initializeFromStartCommit",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf,lf,Rf,Hg,ng,fg,gg,Wh,wg,xh,Qi,Di,Zi,ni,Xd,ff=arguments;
return regeneratorRuntime.wrap(function(af){for(;;)switch(af.prev=af.next){case 0:return Jb=1<ff.length&&void 0!==ff[1]?ff[1]:$c.MorphicDB["default"],gc=2<ff.length&&void 0!==ff[2]?ff[2]:{},ac=gc.showRefs,Kc=void 0===ac?!0:ac,md=this.startCommit=Ma,ud=md._id,oe=md.type,ze=md.name,Ue=this.getSubmorphNamed("version list spinner"),Ue.visible=!0,Ue.center=this.get("version list").center,this.db=Jb,af.next=10,Jb.history(oe,ze);case 10:Me=af.sent,xf=Me.refs,lf=Me.history,Rf=ud,Hg=$c.graph.invert(lf),ng=
$c.graph.hull(Hg,ud),fg={_id:!0},gg=[Ma],Wh=M(ng),af.prev=19,Wh.s();case 21:if((wg=Wh.n()).done){af.next=30;break}xh=wg.value;af.next=25;return Jb.log(xh,void 0,!0,fg);case 25:Qi=af.sent,gg.push.apply(gg,Xa(Qi)),Qi.forEach(function(Gf){return fg[Gf._id]=!0});case 28:af.next=21;break;case 30:af.next=35;break;case 32:af.prev=32,af.t0=af["catch"](19),Wh.e(af.t0);case 35:return af.prev=35,Wh.f(),af.finish(35);case 38:return Di=$c.arr.max(gg,function(Gf){return Gf.timestamp}),Rf=Di._id,af.next=42,Jb.log(Rf,
void 0,!0);case 42:Zi=af.sent;if(Kc)for(ni in xf);Xd=Zi.map(function(Gf){var Jh=new $c.WorldVersion({reactsToPointer:!1,commit:Gf});Jh.update();return{isListItem:!0,morph:Jh,value:Gf}});this.get("version list").items=Xd;Ue.visible=!1;case 50:case "end":return af.stop()}},jb,this,[[19,32,35,38]])}));return function(Ma){return aa.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"WorldVersionViewer"}}],td,{pathInPackage:function(){return"./studio/world-browser.cp.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3503,end:7492})}($c.Morph);(function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js"),hd=td.hasOwnProperty("TitleWrapper")&&"function"===typeof td.TitleWrapper?td.TitleWrapper:td.TitleWrapper=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return db(hd,Tc,[{key:"startMovingRight",value:function(){var aa=this;this.animate({customTween:function(Sa){aa._hoverDelta=Sa}})}},{key:"stopMovingRight",value:function(){var aa=this;this.animate({customTween:function(Sa){aa._hoverDelta=1-Sa}})}},{key:"startMovingLeft",value:function(){var aa=this;this.animate({customTween:function(Sa){aa._hoverDelta=-Sa}})}},{key:"stopMovingLeft",value:function(){var aa=this;this.animate({customTween:function(Sa){aa._hoverDelta=-1+Sa}})}},{key:"startOnce",
value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:if(!this._fn){Jb.next=2;break}return Jb.abrupt("return");case 2:return this._fn=Ma,Jb.next=5,Ma();case 5:this._fn=null;case 6:case "end":return Jb.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"updateTitle",value:function(){var aa=this;if(this.title){var Sa=Fa(this.submorphs,1)[0];Sa.left+=this._hoverDelta;Sa.right<
this.width-20&&-1===this._hoverDelta?this.startOnce(Rc(regeneratorRuntime.mark(function jb(){return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return Jb.next=2,aa.stopMovingLeft();case 2:return Jb.next=4,aa.startMovingRight();case 4:case "end":return Jb.stop()}},jb)}))):20<Sa.left&&1===this._hoverDelta&&this.startOnce(Rc(regeneratorRuntime.mark(function Jb(){return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=gc.next){case 0:return gc.next=2,aa.stopMovingRight();
case 2:return gc.next=4,aa.startMovingLeft();case 4:case "end":return gc.stop()}},Jb)})))}}},{key:"startShowingFullTitle",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb;return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=gc.next){case 0:if(this.title){gc.next=2;break}return gc.abrupt("return");case 2:return jb=Fa(this.submorphs,1),Jb=jb[0],Jb.textString=this.title,gc.next=6,Jb.whenRendered();case 6:this._hoverDelta=0,this.startStepping("updateTitle"),Jb.right>
this.width&&this.startMovingLeft();case 9:case "end":return gc.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"stopShowingFullTitle",value:function(){if(this.title){var aa=this.submorphs[0];aa.textString=$c.string.truncate(this.title,18,"...");this.stopStepping("updateTitle");this._hoverDelta=0;aa.left=0}}},{key:"onHoverIn",value:function(aa){db._get(Object.getPrototypeOf(hd.prototype),"onHoverIn",this).call(this,aa);this.startShowingFullTitle()}},{key:"onHoverOut",
value:function(aa){db._get(Object.getPrototypeOf(hd.prototype),"onHoverOut",this).call(this,aa);this.stopShowingFullTitle()}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"TitleWrapper"}},{key:"properties",get:function(){return{title:{derived:!0,set:function(aa){this.setProperty("title",aa);aa&&(this.submorphs[0].textString=$c.string.truncate(aa,18,"..."))}}}}}],td,{pathInPackage:function(){return"./studio/world-browser.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:7494,end:9715})})($c.Morph);(function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js"),hd=td.hasOwnProperty("StaticText")&&"function"===typeof td.StaticText?td.StaticText:td.StaticText=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return db(hd,Tc,[{key:"refresh",value:function(){this.html='<span style="line-height: 1.3; font-size: '.concat(this.fontSize,"px; color: ").concat(this.fontColor,"; font-family: ").concat(this.fontFamily,'">').concat(this.value,"</span>")}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"StaticText"}},{key:"properties",get:function(){return{html:{isStyleProp:!1},fontSize:{type:"Number",set:function(aa){this.setProperty("fontSize",aa);this.refresh()}},fontColor:{type:"Color",
set:function(aa){this.setProperty("fontColor",aa);this.refresh()}},fontFamily:{type:"Enum",set:function(aa){this.setProperty("fontFamily",aa);this.refresh()}},value:{set:function(aa){this.setProperty("value",aa);this.refresh()}}}}}],td,{pathInPackage:function(){return"./studio/world-browser.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:9717,end:10605})})($c.HTMLMorph);(function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js"),hd=td.hasOwnProperty("SearchInputLine")&&"function"===typeof td.SearchInputLine?td.SearchInputLine:td.SearchInputLine=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"fuzzyMatch",value:function(aa){var Sa=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:this.parseInput();if(Sa.lowercasedTokens.every(function(jb){return aa.toLowerCase().includes(jb)}))return!0;var Ma=aa.toLowerCase();return 3>=$c.arr.sum(Sa.lowercasedTokens.map(function(jb){return $c.string.levenshtein(Ma,jb)}))}},{key:"fuzzyFilter",value:function(aa){var Sa=this,Ma=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(Jb){return Jb},jb=this.parseInput();return aa.filter(function(Jb){return Sa.fuzzyMatch(Ma(Jb),jb)})}},{key:"parseInput",value:function(){var aa=
Array.from(this.textString).reduce(function(Ma,jb){if("\\"===jb&&!Ma.escaped)return Ma.escaped=!0,Ma;" "!==jb||Ma.escaped?(Ma.spaceSeen=!1,Ma.current+=jb):(!Ma.spaceSeen&&Ma.current&&(Ma.tokens.push(Ma.current),Ma.current=""),Ma.spaceSeen=!0);Ma.escaped=!1;return Ma},{tokens:[],current:"",escaped:!1,spaceSeen:!1});aa.current&&aa.tokens.push(aa.current);var Sa=aa.tokens.map(function(Ma){return Ma.toLowerCase()});return{tokens:aa.tokens,lowercasedTokens:Sa}}}],[{key:Symbol["for"]("__LivelyClassName__"),
get:function(){return"SearchInputLine"}}],td,{pathInPackage:function(){return"./studio/world-browser.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10607,end:12093})})($c.InputLine);(function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js"),hd=td.hasOwnProperty("WorldDashboard")&&"function"===
typeof td.WorldDashboard?td.WorldDashboard:td.WorldDashboard=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"onLoad",value:function(){if(!this.isComponent&&"undefined"!==typeof localStorage){var aa=localStorage.getItem("lively.morphic-projects-filter");aa&&this.ui.sortSelector.selection!==aa&&(this.ui.sortSelector.selection=aa);this.initConnections()}}},{key:"initConnections",
value:function(){var aa=this.ui,Sa=aa.searchField,Ma=aa.newProjectButton;$c.connect(aa.sortSelector.viewModel,"selection",this,"update");$c.connect(Sa,"inputChanged",this,"updateList");$c.connect(Ma,"onMouseDown",this,"createNewProject")}},{key:"onMouseDown",value:function(aa){db._get(Object.getPrototypeOf(hd.prototype),"onMouseDown",this).call(this,aa);aa.targetMorph===this.ui.closeButton&&this.remove()}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();
if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",this.ui.sortSelector.selection)}catch(aa){console.error(aa)}}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(){var aa=0<arguments.length&&void 0!==arguments[0]?arguments[0]:$world;this.owner!==aa&&aa.addMorph(this);this.center=
aa.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(aa){var Sa=$c.UserUI.getCurrentUser();aa=this.ui.searchField.fuzzyFilter(aa,function(Ma){return Ma._commit.name+Ma._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return $c.arr.sortBy(aa,function(Ma){return-Ma._commit.timestamp});case "TEMPLATES":return aa;case "MY PROJECTS":return aa.filter(function(Ma){return Ma._commit.author.name===Sa.name});case "PUBLISHED":return aa}}},{key:"updateList",value:function(){var aa=
this;this.previews&&$c.fun.debounceNamed("update world list",150,function(){aa.ui.worldList.items=aa.sortAndFilterPreviews(aa.previews)})()}},{key:"displayWorlds",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb;return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=gc.next){case 0:return this.reset(),jb=this.ui.loadingIndicator,jb.animate({opacity:1,duration:300}),gc.next=5,this.db.latestCommits("world");case 5:return Jb=gc.sent,this.previews=Jb.map(function(ac){var Kc=
$c.part($c.Placeholder);Kc._commit=ac;Kc.displayPreview=Rc(regeneratorRuntime.mark(function ud(){var oe;return regeneratorRuntime.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return oe=$c.part($c.WorldPreviewTile),oe.dropShadow=null,oe._commit=ac,oe.opacity=0,Kc.addMorph(oe),oe.displayPreview(),oe.position=$c.pt(0,0),ze.next=9,Kc.whenRendered();case 9:Kc.layout=new $c.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});case 10:case "end":return ze.stop()}},ud)}));return Kc}),
gc.next=9,jb.animate({opacity:0,duration:300});case 9:this.updateList(),0===Jb.length&&(this.ui.noWorldWarning.center=this.innerBounds().center(),this.ui.noWorldWarning.animate({visible:!0,duration:300}));case 11:case "end":return gc.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}},{key:"allFontsLoaded",value:function(){return this.ui.newProjectButton.submorphs[0].whenFontLoaded()}}],
[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(aa){this.ui.closeButton.visible=aa}},db:{serialize:!1,get:function(){return $c.MorphicDB["default"]}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),
closeButton:this.getSubmorphNamed("close button"),loadingIndicator:this.getSubmorphNamed("loading indicator"),noWorldWarning:this.getSubmorphNamed("no world warning"),newProjectButton:this.getSubmorphNamed("new project button")}}}}}}],td,{pathInPackage:function(){return"./studio/world-browser.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:12095,end:16817})})($c.Morph);(function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js"),hd=td.hasOwnProperty("GrowingWorldList")&&"function"===typeof td.GrowingWorldList?td.GrowingWorldList:td.GrowingWorldList=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(aa){db._get(Object.getPrototypeOf(hd.prototype),
"onScroll",this).call(this,aa);this.update()}},{key:"onChange",value:function(aa){db._get(Object.getPrototypeOf(hd.prototype),"onChange",this).call(this,aa);"extent"===aa.prop&&this.update(!0)}},{key:"onHoverIn",value:function(aa){this.clipMode="auto"}},{key:"onHoverOut",value:function(aa){$c.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(aa){var Sa=this.items;if(Sa&&0!==Sa.length){var Ma=this.scrollContainer,jb=Ma.layout.spacing;Ma.extent=this.extent;var Jb=this.ui,gc=
Jb.bufferTop;Jb=Jb.bufferBottom;gc=gc||Ma.addMorph({fill:null,name:"buffer top",height:10});Jb=Jb||Ma.addMorph({fill:null,name:"buffer bottom",height:10});gc.width=Jb.width=this.width-100;Ma.layout.disable();var ac=Sa[0];jb=Sa.slice(0,Math.floor(this.width/(ac.width+jb))*(Math.ceil((this.scroll.y+this.height)/(ac.height+jb))+1)).filter(function(oe){return oe.owner!==Ma});var Kc=this.scroll.y+2*this.height;ac=M(jb);var md;try{var ud=function(){var oe=md.value;Kc++;oe.top=Kc;Ma.addMorph(oe);oe._initialized||
oe.whenRendered().then(Rc(regeneratorRuntime.mark(function Ue(){return regeneratorRuntime.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return oe._initialized=!0,Me.next=3,oe.displayPreview();case 3:case "end":return Me.stop()}},Ue)})))};for(ac.s();!(md=ac.n()).done;)ud()}catch(oe){ac.e(oe)}finally{ac.f()}aa&&(gc.position=$c.pt(0,0),Sa.forEach(function(oe,ze){return oe.position=$c.pt(ze+1,ze+1)}),Jb.position=$c.pt(Sa.length+2,Sa.length+2));Ma.layout.enable();if(aa||0<jb.length)Jb.top=this.submorphBounds().height,
Ma.layout.apply()}}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new $c.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},
items:{after:["layout","scrollContainer"],set:function(aa){this.setProperty("items",aa);var Sa=this.scrollContainer;Sa.layout&&Sa.layout.disable();var Ma=this.ui,jb=Ma.bufferTop;Ma=Ma.bufferBottom;$c.arr.withoutAll(Sa.submorphs,[].concat(Xa(aa),[jb,Ma])).forEach(function(Jb){return Jb.remove()});this.update(!0)}}}}}],td,{pathInPackage:function(){return"./studio/world-browser.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:16819,end:20521})})($c.Morph);Se=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/world-browser.cp.js"),hd=td.hasOwnProperty("WorldPreview")&&"function"===typeof td.WorldPreview?td.WorldPreview:td.WorldPreview=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"relayout",value:function(){this.setBounds(this.world().visibleBounds())}},
{key:"onLoad",value:function(){this.ui.spinner.visible=!1}},{key:"displayPreview",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.next=2,this.initWithCommit(this._commit);case 2:case "end":return jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"initWithCommit",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc,ac,Kc,md,ud,oe;return regeneratorRuntime.wrap(function(ze){for(;;)switch(ze.prev=
ze.next){case 0:return Jb=this.ui,gc=Jb.preview,ac=Jb.timestamp,Kc=Jb.title,md=Jb.description,ud=Jb.previewContainer,this.opacity=.5,ud.opacity=0,ze.next=5,this.whenRendered();case 5:return this._commit=Ma,gc.imageUrl=Ma.preview||$c.missingSVG,oe=Ma.author.name,oe=oe.startsWith("guest-")?"guest":oe,ac.value=[oe,{fontSize:13,fontWeight:"bold",paddingTop:"1px"},$c.date.format(Ma.timestamp," - d.m.yy HH:MM"),{fontWeight:"bold",fontSize:12,paddingTop:"2px"}],Kc.title=Ma.name,md.value=Ma.description,ze.next=
14,this.whenRendered();case 14:ud.opacity=1,this.animate({opacity:1,duration:300});case 16:case "end":return ze.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"openAnimated",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc=arguments;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return jb=0<gc.length&&void 0!==gc[0]?gc[0]:$world.visibleBounds(),Jb=$c.morph(Object.assign({},this.spec(),{reactsToPointer:!1,
renderOnGPU:!0,submorphs:[this.ui.spinner.spec()]})).openInWorld(),Jb.hasFixedPosition=!0,Jb.globalPosition=this.globalPosition,Jb.opacity=0,ac.next=7,Jb.whenRendered();case 7:return ac.next=9,Jb.animate({opacity:1,duration:300});case 9:return Jb.dropShadow=!1,Jb.animate({bounds:jb,borderRadius:0,duration:500,easing:$c.easings.inOutQuint}),Jb.respondsToVisibleWindow=!0,ac.next=15,Jb.ui.spinner.animate({center:Jb.innerBounds().center(),easing:$c.easings.inOutQuint,duration:500});case 15:return ac.abrupt("return",
Jb);case 16:case "end":return ac.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"openWorld",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.next=2,this.openAnimated();case 2:this.loadWorld();case 3:case "end":return jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"loadWorld",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,
Jb,gc,ac,Kc;return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=md.next){case 0:jb=this._commit;Jb=jb._id;gc=jb.name;if(!lively.FreezerRuntime){md.next=6;break}ac=$c.LoadingIndicator.open("...starting bootstrap process...",{animated:!0,delay:1E3});this.transitionToLivelyWorld(document.location.origin,this._commit,ac);md.next=10;break;case 6:return Kc=$c.LoadingIndicator.open("loading "+gc),md.next=9,$c.World.loadFromCommit(Jb,void 0,{morphicDB:$c.MorphicDB["default"],moduleManager:$c.moduleManager});
case 9:Kc.remove();case 10:case "end":return md.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"transitionToLivelyWorld",value:function(){var aa=Rc(regeneratorRuntime.mark(function gc(Ma,jb,Jb){var ac,Kc,md,ud,oe;return regeneratorRuntime.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.next=2,Dd.import("./bootstrap-c7e82401.js");case 2:return ac=ze.sent,Kc=ac.bootstrap,ze.next=6,Dd.import("./loading-screen.cp-ab905269.js");case 6:return md=ze.sent,
ud=md.ProgressIndicator,oe=$c.part(ud,{opacity:0,hasFixedPosition:!0}).openInWorld(),oe.startStepping("updateProgressBar"),ze.next=12,Kc({commit:jb,loadingIndicator:Jb,progress:oe});case 12:case "end":return ze.stop()}},gc)}));return function(Ma,jb,Jb){return aa.apply(this,arguments)}}()},{key:"showVersions",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return jb=$c.easings.inOutExpo,
Jb=this.ui.previewContainer,gc=$c.part($c.VersionContainer,{name:"version container",position:$c.pt(0,0)}),this.addMorph(gc),gc.reactsToPointer=gc.visible=!0,gc.initializeFromStartCommit(this._commit),this.animate({width:515,duration:200,easing:jb}),Jb.animate({opacity:0,duration:200}),ac.next=11,gc.animate({opacity:1,duration:200});case 11:Jb.reactsToPointer=Jb.visible=!1;case 12:case "end":return ac.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"hideVersions",
value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc,ac;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=Kc.next){case 0:return jb=$c.easings.inOutExpo,Jb=this.ui,gc=Jb.previewContainer,ac=Jb.versionContainer,gc.reactsToPointer=gc.visible=!0,this.animate({width:245,duration:200,easing:jb}),gc.animate({opacity:1,duration:200}),Kc.next=8,ac.animate({opacity:0,duration:200});case 8:ac.reset(),ac.remove();case 10:case "end":return Kc.stop()}},Ma,this)}));return function(){return aa.apply(this,
arguments)}}()},{key:"toggleDeleteButton",value:function(aa){this.ui.deleteButton.visible=aa}},{key:"onHoverIn",value:function(aa){this.toggleDeleteButton(!0)}},{key:"onHoverOut",value:function(aa){this.toggleDeleteButton(!1)}},{key:"tryToDelete",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return Jb.next=2,$world.confirm(["Delete World\n",{},"Do you really want to remove this world from the database? This step can not be undone.",
{fontWeight:"normal",fontSize:16}]);case 2:jb=Jb.sent;if(!jb){Jb.next=6;break}Jb.next=6;return this.confirmDelete();case 6:case "end":return Jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"confirmDelete",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.next=2,$c.MorphicDB["default"].commit(Object.assign({},this._commit,{content:void 0,snapshot:null}));case 2:this.isComponent||
this.owner.isWorld||this.owner.remove();case 3:case "end":return jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"onMouseUp",value:function(aa){var Sa=this.ui,Ma=Sa.openButton,jb=Sa.versionButton,Jb=Sa.deleteButton,gc=Sa.closeVersionsButton,ac=Sa.cancelDeleteButton;Sa=Sa.confirmDeleteButton;switch(aa.targetMorph){case Ma:this.openWorld();break;case jb:this.showVersions();break;case Jb:this.tryToDelete();break;case gc:this.hideVersions();break;case Sa:this.confirmDelete();
break;case ac:this.cancelDelete()}}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"WorldPreview"}},{key:"properties",get:function(){return{ui:{readOnly:!0,get:function(){return{previewContainer:this.getSubmorphNamed("preview container"),versionContainer:this.getSubmorphNamed("version container"),preview:this.getSubmorphNamed("preview"),timestamp:this.getSubmorphNamed("timestamp"),title:this.getSubmorphNamed("title wrapper"),description:this.getSubmorphNamed("description"),openButton:this.getSubmorphNamed("open button"),
versionButton:this.getSubmorphNamed("version button"),spinner:this.getSubmorphNamed("spinner"),deleteButton:this.getSubmorphNamed("delete button"),closeVersionsButton:this.getSubmorphNamed("close versions button"),versionList:this.getSubmorphNamed("version list"),deleteWorldPrompt:this.getSubmorphNamed("delete world prompt"),cancelDeleteButton:this.getSubmorphNamed("cancel delete button"),confirmDeleteButton:this.getSubmorphNamed("confirm delete button")}}}}}}],td,{pathInPackage:function(){return"./studio/world-browser.cp.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:20530,end:27672})}($c.Morph);$c.WorldPreview=Se;$c.WorldPreview=Se;$c.Placeholder=$c.component["for"](function(){return $c.component({reactsToPointer:!1,fill:$c.Color.transparent,clipMode:"hidden",dropShadow:new $c.ShadowObject({distance:20,rotation:75,color:$c.Color.rgba(0,0,0,.11),blur:50}),
extent:$c.pt(245,368.2)})},{module:"lively.ide/studio/world-browser.cp.js","export":"Placeholder",range:{start:27679,end:27933}},$c.Placeholder);$c.VersionContainer=$c.component["for"](function(){return $c.component({type:$c.WorldVersionViewer,name:"version container",draggable:!0,extent:$c.pt(515.7,365.6),fill:$c.Color.rgb(253,254,254),grabbable:!0,position:$c.pt(1472.2,114.6),submorphs:[{type:$c.MorphList,name:"version list",clipMode:"hidden",master:$c.SystemList,extent:$c.pt(475.6,285),itemHeight:45,
padding:$c.rect(1,1,0,-1),position:$c.pt(20.1,16.8),touchInput:!1},$c.part($c.Spinner,{name:"version list spinner",extent:$c.pt(55.3,66.9),position:$c.pt(244,166.1),scale:.5,visible:!1}),$c.part($c.PlainButton,{name:"close versions button",dropShadow:new $c.ShadowObject({distance:3,color:$c.Color.rgba(0,0,0,.26),blur:10}),extent:$c.pt(84,31),fill:$c.Color.rgb(81,90,90),position:$c.pt(20.7,317.2),submorphs:[{name:"label",fontFamily:'"IBM Plex Sans"',fontWeight:600,textAndAttributes:["CLOSE",null]}]}),
$c.part($c.RedButton,{name:"revert button",extent:$c.pt(84,31),position:$c.pt(312.4,316.2),submorphs:[{name:"label",fontWeight:600,textAndAttributes:["REVERT",null]}]}),$c.part($c.GreenButton,{name:"visit button",dropShadow:new $c.ShadowObject({distance:3,color:$c.Color.rgba(0,0,0,.26),blur:10}),extent:$c.pt(84,31),label:"VISIT",position:$c.pt(413,315.6),submorphs:[{name:"label",fontWeight:600,textAndAttributes:["VISIT",null]}]})]})},{module:"lively.ide/studio/world-browser.cp.js","export":"VersionContainer",
range:{start:27976,end:29578}},$c.VersionContainer);$c.WorldPreviewTile=$c.component["for"](function(){return $c.component({type:$c.WorldPreview,name:"world preview",borderRadius:5,clipMode:"hidden",dropShadow:new $c.ShadowObject({distance:20,rotation:75,color:$c.Color.rgba(0,0,0,.11),blur:50}),extent:$c.pt(245,368.2),fill:$c.Color.rgb(253,254,254),position:$c.pt(1109.2,43.8),reactsToPointer:!1,submorphs:[{name:"preview container",extent:$c.pt(244.5,130),fill:$c.Color.rgba(46,75,223,0),position:$c.pt(0,
0),submorphs:[$c.part($c.PlainButton,{name:"version button",extent:$c.pt(85,31),position:$c.pt(148,316.7),submorphs:[{name:"label",fontFamily:'"IBM Plex Sans"',fontWeight:600,textAndAttributes:["VERSIONS",null]}]}),$c.part($c.GreenButton,{name:"open button",extent:$c.pt(122,30),position:$c.pt(14.6,317),submorphs:[{name:"label",fontWeight:600,textAndAttributes:["OPEN PROJECT",null]}]}),$c.part($c.Spinner,{name:"spinner",extent:$c.pt(55.3,66.9),position:$c.pt(111.3,158.1),visible:!1}),{name:"preview frame",
borderColor:$c.Color.rgb(23,160,251),clipMode:"hidden",extent:$c.pt(210.4,184),fill:$c.Color.rgba(0,0,0,0),position:$c.pt(16,16.2),submorphs:[{type:$c.Image,name:"preview",extent:$c.pt(210,216.6),imageUrl:"",naturalExtent:$c.pt(200,200),reactsToPointer:!1}]},{type:$c.Label,name:"delete button",dropShadow:!1,fontColor:$c.Color.rgb(231,76,60),fontSize:25.108,nativeCursor:"pointer",position:$c.pt(212.1,11.9),textAndAttributes:$c.Icon.textAttribute("trash-alt"),visible:!1},{type:$c.Label,name:"timestamp",
borderRadius:30,fill:$c.Color.rgba(0,0,0,.36),fontColor:$c.Color.rgb(253,254,254),fontSize:17,nativeCursor:"pointer",padding:$c.rect(10,3,0,2),position:$c.pt(16.7,167.8),reactsToPointer:!1,textAndAttributes:["robin.schreiber",{fontSize:13,fontWeight:"bold",paddingTop:"1px"}," - 3.1.19 19:30",{fontSize:12,fontWeight:"bold",paddingTop:"2px"}]},{type:$c.StaticText,name:"description",clipMode:"hidden",extent:$c.pt(199.9,70.3),fill:$c.Color.rgba(255,255,255,0),fontColor:$c.Color.rgb(97,106,107),fontFamily:"IBM Plex Sans, Sans-Serif",
fontSize:17,html:'<span style="line-height: 1.3; font-size: 17px; color: rgb(97,106,107); font-family: IBM Plex Sans, Sans-Serif">An interactive essay abouy eyesight.</span>',position:$c.pt(18.9,238.9),reactsToPointer:!1,renderOnGPU:!0,value:"An interactive essay abouy eyesight."},{type:$c.TitleWrapper,name:"title wrapper",borderColor:$c.Color.rgb(23,160,251),clipMode:"hidden",extent:$c.pt(217.4,32.5),fill:$c.Color.rgba(0,0,0,0),position:$c.pt(12.3,205.3),submorphs:[{type:$c.Label,name:"title",fill:$c.Color.rgba(255,
255,255,0),fontColor:$c.Color.rgb(64,64,64),fontSize:22,fontWeight:"bold",nativeCursor:"pointer",padding:$c.rect(4,3,1,0),reactsToPointer:!1,textAndAttributes:["Title",null]}]}]}]})},{module:"lively.ide/studio/world-browser.cp.js","export":"WorldPreviewTile",range:{start:29627,end:33199}},$c.WorldPreviewTile);$c.WorldBrowser=$c.component["for"](function(){return $c.component({type:$c.WorldDashboard,name:"world browser",borderRadius:10,clipMode:"hidden",draggable:!0,dropShadow:new $c.ShadowObject({color:$c.Color.rgba(0,
0,0,.52),blur:15}),extent:$c.pt(870,570),fill:$c.Color.rgb(112,123,124),layout:new $c.ProportionalLayout({lastExtent:{x:870,y:570},reactToSubmorphAnimations:!1,submorphSettings:[["fader bottom",{x:"resize",y:"move"}],["go back button",{x:"fixed",y:"move"}],["dropdown list",{x:"move",y:"fixed"}],["search-input",{x:"move",y:"fixed"}],["fader top",{x:"resize",y:"fixed"}],["world list",{x:"resize",y:"resize"}],["world search",{x:"move",y:"fixed"}],["search field",{x:"move",y:"fixed"}],["close button",
{x:"fixed",y:"move"}],["search selector",{x:"move",y:"fixed"}]]}),position:$c.pt(1182.2,536.7),renderOnGPU:!0,submorphs:[{type:$c.Label,name:"no world warning",fontColor:$c.Color.rgb(189,195,199),fontSize:30,fontWeight:"bold",position:$c.pt(170.8,265.5),textAndAttributes:["There are no projects yet. Create one!",null],visible:!1},{type:$c.GrowingWorldList,name:"world list",clipMode:"hidden",extent:$c.pt(869.6,568.7),fill:$c.Color.rgba(46,75,223,0),items:[],scrollContainer:null,submorphs:[{name:"scroll container",
extent:$c.pt(868.9,75),fill:$c.Color.transparent,layout:new $c.TilingLayout({align:"center",hugContentsVertically:!0,orderByIndex:!0,padding:$c.rect(0,0,0,30),reactToSubmorphAnimations:!0,spacing:25}),reactsToPointer:!1,submorphs:[{name:"buffer top",extent:$c.pt(768.9,10),fill:$c.Color.transparent},{name:"buffer bottom",extent:$c.pt(768.9,10),fill:$c.Color.transparent}]}]},{name:"fader top",extent:$c.pt(871.9,63.9),fill:new $c.LinearGradient({stops:[{offset:0,color:$c.Color.rgb(112,123,124)},{offset:1,
color:$c.Color.rgba(112,123,124,0)}],vector:$c.rect(0,0,0,1)}),submorphs:[$c.part($c.GreenButton,{name:"new project button",extent:$c.pt(145,30),position:$c.pt(19.8,17),submorphs:[{name:"label",fontWeight:600,textAndAttributes:[].concat(Xa($c.Icon.textAttribute("plus-circle",{paddingTop:"2px",paddingRight:"5px"})),[" NEW PROJECT"])}]})]},{type:$c.SearchInputLine,name:"search field",borderColor:$c.Color.rgb(189,195,199),borderRadius:30,dropShadow:new $c.ShadowObject({distance:1,color:$c.Color.rgba(0,
0,0,.26)}),extent:$c.pt(285.1,34),fill:$c.Color.rgb(234,237,237),fixedHeight:!1,fontColor:$c.Color.rgb(64,64,64),fontSize:17,padding:$c.rect(12,5,-4,0),placeholder:"Search Projects",position:$c.pt(574.3,13.6),selectionColor:$c.Color.rgba(52,152,219,.25)},{name:"fader bottom",extent:$c.pt(871.9,63.9),fill:new $c.LinearGradient({stops:[{offset:0,color:$c.Color.rgb(112,123,124)},{offset:.9073299632352941,color:$c.Color.rgba(127,127,127,0)}],vector:$c.rect(.498247508317511,.9999969287634702,.003504983364977972,
-.9999938575269406)}),position:$c.pt(0,506)},{name:"close button",nativeCursor:"pointer",borderColor:$c.Color.rgb(66,73,73),dropShadow:new $c.ShadowObject({distance:3,color:$c.Color.rgba(0,0,0,.26),blur:10}),extent:$c.pt(94.6,30),fill:$c.Color.rgb(81,90,90),label:"CLOSE",position:$c.pt(14.9,531),borderRadius:5,borderWidth:1,submorphs:[{type:$c.Label,name:"label",fontColor:$c.Color.rgb(215,219,221),fontWeight:"bold",position:$c.pt(28.8,7.5),reactsToPointer:!1,textAndAttributes:["CLOSE",null]}]},{name:"loading indicator",
layout:new $c.TilingLayout({align:"center",axisAlign:"center",hugContentsHorizontally:!0,hugContentsVertically:!0,orderByIndex:!0,padding:$c.rect(10,5,0,0),spacing:7,wrapSubmorphs:!1}),borderRadius:30,extent:$c.pt(90.5,10),fill:$c.Color.rgba(0,0,0,.36),opacity:1,position:$c.pt(353.5,253),submorphs:[$c.part($c.Spinner,{name:"loading spinner",cssDeclaration:'\n           .lds-spinner {\n            color: official;\n            display: inline-block;\n            position: relative;\n            width: 64px;\n            height: 64px;\n          }\n          .lds-spinner div {\n            transform-origin: 32px 32px;\n            animation: lds-spinner .6s linear infinite;\n          }\n          .white-spinner div:after {\n            content: " ";\n            display: block;\n            position: absolute;\n            top: 3px;\n            left: 29px;\n            width: 5px;\n            height: 14px;\n            border-radius: 20%;\n            background: white;\n          }\n          .lds-spinner div:nth-child(1) {\n            transform: rotate(0deg);\n            animation-delay: -.55s;\n          }\n          .lds-spinner div:nth-child(2) {\n            transform: rotate(30deg);\n            animation-delay: -.5s;\n          }\n          .lds-spinner div:nth-child(3) {\n            transform: rotate(60deg);\n            animation-delay: -0.45s;\n          }\n          .lds-spinner div:nth-child(4) {\n            transform: rotate(90deg);\n            animation-delay: -0.4s;\n          }\n          .lds-spinner div:nth-child(5) {\n            transform: rotate(120deg);\n            animation-delay: -0.35s;\n          }\n          .lds-spinner div:nth-child(6) {\n            transform: rotate(150deg);\n            animation-delay: -0.3s;\n          }\n          .lds-spinner div:nth-child(7) {\n            transform: rotate(180deg);\n            animation-delay: -0.25s;\n          }\n          .lds-spinner div:nth-child(8) {\n            transform: rotate(210deg);\n            animation-delay: -0.2s;\n          }\n          .lds-spinner div:nth-child(9) {\n            transform: rotate(240deg);\n            animation-delay: -0.15s;\n          }\n          .lds-spinner div:nth-child(10) {\n            transform: rotate(270deg);\n            animation-delay: -0.1s;\n          }\n          .lds-spinner div:nth-child(11) {\n            transform: rotate(300deg);\n            animation-delay: -0.05s;\n          }\n          .lds-spinner div:nth-child(12) {\n            transform: rotate(330deg);\n            animation-delay: 0s;\n          }\n          @keyframes lds-spinner {\n            0% {\n              opacity: 1;\n            }\n            100% {\n              opacity: 0;\n            }\n          }',
extent:$c.pt(68.2,70.2)}),{type:$c.Label,name:"loading label",fontColor:$c.Color.rgb(253,254,254),fontFamily:'"IBM Plex Sans"',fontSize:23,fontWeight:"500",reactsToPointer:!1,textString:"Loading..."}]},$c.part($c.DropDownList,{name:"search selector",position:$c.pt(432.9,17),borderColor:$c.Color.rgb(66,73,73),dropShadow:new $c.ShadowObject({distance:1,color:$c.Color.rgba(0,0,0,.26)}),extent:$c.pt(125.6,29.6),fill:$c.Color.rgb(81,90,90),viewModel:{items:["MY PROJECTS","TEMPLATES","PUBLISHED","RECENT"],
openListInWorld:!0,selection:"MY PROJECTS",listMaster:$c.SystemList},submorphs:[{name:"label",fontSize:12,fontWeight:600,fontColor:$c.Color.rgb(215,219,221),textAndAttributes:["MY PROJECTS",null," ",null,"\uf0d7",{fontFamily:'"Font Awesome 5 Free", "Font Awesome 5 Brands"',fontWeight:"900",paddingRight:"0px",paddingTop:"0px",textStyleClasses:["fa","annotation"]}]}]})]})},{module:"lively.ide/studio/world-browser.cp.js","export":"WorldBrowser",range:{start:33244,end:41688}},$c.WorldBrowser);Se=bd("W",
$c.WorldBrowser);mh=$c.WorldPreviewTile;Rh=$c.VersionContainer;$c.WorldBrowser=Se;$c.WorldPreviewTile=mh;$c.VersionContainer=Rh;$c["default"]=Ge;var vf=window.lively.FreezerRuntime.recorderFor("lively.ide/world-commands.js");vf.Rectangle=Pc;vf.rect=Cb;vf.Color=Ne;vf.pt=ad;vf.tree=Ob;vf.date=Md;vf.Path=Db;vf.arr=sb;vf.string=fa;vf.obj=ab;vf.inspect=Le;vf.morph=kb;vf.Text=jc;vf.config=da;vf.part=ic;vf.KeyHandler=We;vf.loadObjectFromPartsbinFolder=xe;vf.loadPart=Fg;vf.interactivelySaveWorld=Zc;vf.show=
Pd;vf.showAndSnapToGuides=Zd;vf.removeSnapToGuidesOf=ge;vf.LoadingIndicator=Sc;vf.createMorphSnapshot=Na;vf.interactivelyFreezeWorld=Ji;vf.BrowserModuleTranslationCache=gb;vf.modules=Ya;vf.once=rd;vf.CodeSearch=qa;vf.WorldBrowser=Se;vf.commands=[{name:"clear storage and reload",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function hd(){var aa,Sa;return regeneratorRuntime.wrap(function(Ma){for(;;)switch(Ma.prev=Ma.next){case 0:return Ma.next=2,$world.confirm(["Caution\n",{},"Proceeding will clear all local storage and reload the page! Make sure if you want to save your world before you continue.",
{fontSize:15,fontWeight:"normal"}],{width:400});case 2:if(aa=Ma.sent)localStorage.clear(),Sa=new vf.BrowserModuleTranslationCache("2"),Sa.closeDb(),Sa.deleteDb(),window.location.reload(!0);case 4:case "end":return Ma.stop()}},hd)}));return function(){return Tc.apply(this,arguments)}}()},{name:"undo",exec:function(Tc){if(Tc.focusedMorph&&Tc.focusedMorph!==Tc&&Tc.focusedMorph.undoManager)return!1;Tc.env.undoManager.undo();return!0}},{name:"redo",exec:function(Tc){if(Tc.focusedMorph&&Tc.focusedMorph!==
Tc&&Tc.focusedMorph.undoManager)return!1;Tc.env.undoManager.redo();return!0}},{name:"run command",handlesCount:!0,exec:function(){var Tc=Rc(regeneratorRuntime.mark(function Ma(hd,aa,Sa){var jb,Jb,gc,ac,Kc,md;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=ud.next){case 0:return jb=hd.focusedMorph||hd,Jb=vf.KeyHandler.generateCommandToKeybindingMap(jb,!0).map(function(oe){var ze=oe.prettyKeys,Ue=oe.command.name,Me=oe.target.constructor.name;ze=ze?ze.join(", "):"";return{isListItem:!0,
value:oe,label:["".concat(Me),{fontSize:"80%",textStyleClasses:["v-center-text"],paddingRight:"10px"},"".concat(Ue),null],annotation:[ze,{fontSize:"80%",textStyleClasses:["truncated-text"],paddingRight:"5px",maxWidth:140}]}}),ud.next=4,hd.filterableListPrompt("Run command",Jb,{historyId:"lively.morphic-run command",requester:jb,extent:vf.pt(700,600),prompt:hd._cachedRunCommandPrompt});case 4:return gc=ud.sent,ac=gc.prompt,Kc=Fa(gc.selected,1),md=Kc[0],hd._cachedRunCommandPrompt=ac,ud.abrupt("return",
md?md.target.execCommand(md.command,aa,Sa):!0);case 10:case "end":return ud.stop()}},Ma)}));return function(hd,aa,Sa){return Tc.apply(this,arguments)}}()},{name:"show command history",exec:function(Tc,td){var hd=Tc.commandHandler;td=vf.arr.sortBy(hd.history,function(aa){return-aa.time}).map(function(aa){return{isListItem:!0,string:hd.printCommand(aa),value:aa}});$world.editListPrompt("select commands",td,{multiSelect:!0,requester:Tc});return!0}},{name:"show halo for focused morph",exec:function(Tc){var td=
Tc.focusedMorph;Tc.showHaloFor(td.getWindow()||td,Tc.firstHand.pointerId);return!0}},{name:"show morph",exec:function(Tc,td){Tc=td.loop;vf.show(td.morph,void 0===Tc?!1:Tc)}},{name:"show and snap to guides",exec:function(Tc,td){vf.showAndSnapToGuides(td.target,td.showGuides,td.snap)}},{name:"remove snap to guides",exec:function(Tc,td){vf.removeSnapToGuidesOf(td)}},{name:"copy morph",exec:function(Tc){var td=Tc.focusedMorph;if(!td||td===Tc)return $world.setStatusMessage("no morph selected"),!0;Tc=td.getWindow()||
td;td=Tc.copy();td.openInWorld(Tc.globalPosition.addXY(10,10));td.isWindow&&td.activate();return td}},{name:"select morph",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze,Ue,Me=arguments;return regeneratorRuntime.wrap(function(xf){for(;;)switch(xf.prev=xf.next){case 0:return Sa=1<Me.length&&void 0!==Me[1]?Me[1]:{root:hd,selectionFn:null,justReturn:!1,requester:hd,filterFn:null,prependItems:[],prompt:null,remote:!1},Ma=0,jb=Sa.filterFn||function(){return!0},
Jb=Sa.selectionFn||function(lf,Rf,Hg){return hd.filterableListPrompt(lf,Rf,Hg)},xf.next=6,Dd.import("./object-classes-06d7e61a.js");case 6:return gc=xf.sent,ac=gc["default"],Kc=vf.arr.compact(vf.tree.map(Sa.root||hd,function(lf,Rf){if(!jb(lf))return null;var Hg=!!ac.lookupPackageForObject(lf);return{isListItem:!0,label:["".concat(String(++Ma)).concat("\u2003".repeat(Rf)),{fontSize:"80%",textStyleClasses:["v-center-text"],paddingRight:"10px"},"".concat(lf),{fontWeight:Hg?"bolder":"normal",fontStyle:Hg?
"normal":"italic",fontFamily:"Inconsolata",fontSize:16},Hg?" [Object Class]":"",{opacity:.5}],value:lf}},function(lf){return jb(lf)?lf.submorphs:[]})),md=["show halo","open object editor","open object inspector"],xf.next=12,Jb(Sa.prompt||"Choose morph",(Sa.prependItems||[]).concat(Kc),{historyId:"lively.morphic-select morph",onSelection:function(lf){(void 0).lastSelectionHalo&&(void 0).lastSelectionHalo.remove();lf&&lf.show&&ud!==lf&&((void 0).lastSelectionHalo=lf.show(),ud=lf)},selectedAction:"show halo",
actions:md});case 12:oe=xf.sent;ze=oe.selected;Ue=oe.action;if(!Sa.justReturn){xf.next=17;break}return xf.abrupt("return",ze);case 17:return ze.forEach(function(lf){Ue===md[0]?hd.showHaloFor(lf):Ue===md[1]?hd.execCommand("open object editor",{target:lf}):Ue===md[2]&&hd.execCommand("open object inspector",{target:lf})}),xf.abrupt("return",ze);case 19:case "end":return xf.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"print morph(s)",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,
Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf;return regeneratorRuntime.wrap(function(lf){for(;;)switch(lf.prev=lf.next){case 0:Sa=!1,Ma=[];case 2:if(Sa){lf.next=14;break}lf.next=5;return hd.execCommand("select morph",{justReturn:!0});case 5:return jb=lf.sent,Jb=Fa(jb,1),gc=Jb[0],Ma.push(gc),lf.next=11,hd.confirm("Select additional morphs?",{rejectLabel:"NO"});case 11:Sa=!lf.sent;lf.next=2;break;case 14:return ac=vf.LoadingIndicator.open("printing morph..."),lf.next=17,Dd.import("./__rootModule___commonjs-entry-51a55f66.js").then(function(Rf){return Rf.cd});
case 17:return Kc=lf.sent,md=Kc["default"],ud=md["default"](),lf.next=22,ud.listPeers(!0);case 22:return oe=lf.sent,ze=oe.find(function(Rf){return"pdf printer"===Rf.type}),Ue={ackTimeout:3E4},lf.t0=ud,lf.t1=ze.id,lf.next=29,Promise.all(Ma.map(function(Rf){return vf.createMorphSnapshot(Rf,{addPreview:!1,testLoad:!1})}));case 29:return lf.t2=lf.sent,lf.t3=Ue,lf.next=33,lf.t0.sendToAndWait.call(lf.t0,lf.t1,"[PDF printer] print",lf.t2,lf.t3);case 33:Me=lf.sent;xf=Me.error||Me.data.error;if(!xf){lf.next=
38;break}hd.showError(xf);throw xf;case 38:hd.serveFileAsDownload(Me.data,{fileName:Ma[0].name+(1<Ma.length?".etc":"")+".pdf",type:"application/pdf"}),ac.remove();case 40:case "end":return lf.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"escape",exec:function(Tc,td,hd,aa){td=Tc.env.eventDispatcher.eventState;td.menu&&td.menu.remove();td=Tc.halos();td.forEach(function(Sa){return Sa.remove()});Tc.hands.forEach(function(Sa){return Sa.cancelGrab(!0,aa)});Tc=vf.arr.last(td)&&
vf.arr.last(td).target||Tc.focusedMorph||Tc;Tc.focus();Tc.isText&&Tc.selection.disableMultiSelect&&Tc.selection.disableMultiSelect();return!1}},{name:"move or resize halo target",exec:function(Tc){var td=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{direction:"left",offset:1,what:"move"},hd=Tc.halos()[0];if(!hd||hd.changingName||Tc.focusedMorph!==hd)return!1;var aa=td.direction,Sa=td.offset;td=td.what;var Ma=hd.target;Sa=Sa||1;switch(aa){case "left":Ma["move"===td?"left":"width"]-=Sa;break;
case "right":Ma["move"===td?"left":"width"]+=Sa;break;case "up":Ma["move"===td?"top":"height"]-=Sa;break;case "down":Ma["move"===td?"top":"height"]+=Sa}hd.alignWithTarget();return!0}},{name:"close halo target",exec:function(Tc){var td=Tc.halos()[0],hd=$world.focusedMorph;if(!td||td.changingName||hd.isText||hd.isNumberWidget)return!1;td.target.selectedMorphs?(td.target.selectedMorphs.forEach(function(aa){return aa.abandon()}),Tc.halos()[0].remove()):td.target.abandon();return!0}},{name:"resize manually",
exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac=arguments;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=Kc.next){case 0:Sa=1<ac.length&&void 0!==ac[1]?ac[1]:{};Jb=hd.windowBounds();gc=hd.bounds();Kc.t0=Number;Kc.t1=Sa.width;if(Kc.t1){Kc.next=9;break}Kc.next=8;return hd.prompt("Enter world width",{input:Math.max(gc.width,Jb.width),requester:hd});case 8:Kc.t1=Kc.sent;case 9:Kc.t2=Kc.t1;Ma=(0,Kc.t0)(Kc.t2);if("number"!==typeof Ma){Kc.next=20;
break}Kc.t3=Number;Kc.t4=Sa.height;if(Kc.t4){Kc.next=18;break}Kc.next=17;return hd.prompt("Enter world height",{input:Math.max(gc.height,Jb.height),requester:hd});case 17:Kc.t4=Kc.sent;case 18:Kc.t5=Kc.t4,jb=(0,Kc.t3)(Kc.t5);case 20:return"number"!==typeof Ma||isNaN(Ma)||"number"!==typeof jb||isNaN(jb)||(hd.extent=vf.pt(Ma,jb)),Kc.abrupt("return",!0);case 22:case "end":return Kc.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"resize windows to fit visible world bounds",
exec:function(Tc){var td=Tc.getWindows().filter(function(Ma){return!Ma.minimized});if(!td.length)return!0;Tc=Tc.visibleBoundsExcludingTopBar();var hd=td.reduce(function(Ma,jb){return jb.bounds().union(Ma)},new vf.Rectangle(0,0,0,0)),aa=Tc.width/hd.width,Sa=Tc.height/hd.height;td.forEach(function(Ma){var jb=Ma.bounds();Ma.setBounds(new vf.Rectangle(jb.x*aa,jb.y*Sa,jb.width*aa,jb.height*Sa))});return!0}},{name:"window switcher",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,
Ma,jb,Jb,gc,ac,Kc;return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=md.next){case 0:Sa=hd.activePrompt();if(!Sa||"lively.morphic-window switcher"!==Sa.historyId){md.next=4;break}Sa.focus();return md.abrupt("return",Sa.get("list").execCommand("select down"));case 4:return Ma=hd.submorphs.filter(function(ud){return ud.isWindow}).reverse().map(function(ud){return{isListItem:!0,string:ud.title||String(ud),value:ud}}),Ma.forEach(function(ud){ud.value.opacity=.5;ud.value.blur=1}),md.next=
8,hd.filterableListPrompt("Choose window",Ma,{preselect:1,requester:hd,historyId:"lively.morphic-window switcher",onSelection:function(ud){jb&&(jb.minimized=Jb,jb.blur=1,jb.animate({opacity:.3,duration:200}));if(jb=ud)ud.animate({opacity:1,duration:200}),ud.blur=0,Jb=ud.minimized,ud.minimized=!1},width:1*hd.visibleBounds().extent().x/3,itemPadding:vf.Rectangle.inset(4)});case 8:return gc=md.sent,ac=Fa(gc.selected,1),Kc=ac[0],Ma.forEach(function(ud){ud.value.opacity=1;ud.value.blur=0}),Kc&&(Kc.activate(),
Kc.minimized=!1),md.abrupt("return",!0);case 13:case "end":return md.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"close active window or morph",exec:function(Tc){var td=Tc.focusedMorph;if(!td)return!0;var hd=td.getWindow();Tc.undoStart("window close");hd?hd.close():(vf.arr.last(vf.arr.without(td.ownerChain(),Tc)).remove(),(hd=Tc.activeWindow())&&hd.activate());Tc.undoStop("window close");return!0}},{name:"toggle minimize active window",exec:function(Tc){(Tc=Tc.activeWindow())&&
Tc.toggleMinimize();return!0}},{name:"toggle minimize all windows",exec:function(Tc){(Tc=Tc.getWindows())&&Tc.map(function(td){return td.toggleMinimize()});return!0}},{name:"toggle minimize all except active window",exec:function(Tc){(Tc=Tc.getWindows().filter(function(td){return!td.isActive()}))&&Tc.map(function(td){return td.toggleMinimize()});return!0}},{name:"close all except active window",exec:function(Tc){(Tc=Tc.getWindows().filter(function(td){return!td.isActive()}))&&Tc.map(function(td){return td.close()});
return!0}},{name:"close all like this window",exec:function(Tc){var td=Tc.getWindows().filter(function(hd){return hd.isActive()})[0].name.replace("window for","");Tc.getWindows().filter(function(hd){return hd.name.replace("window for","")===td}).map(function(hd){return hd.close()});return!0}},{name:"close all windows",exec:function(Tc){(Tc=Tc.getWindows())&&Tc.map(function(td){return td.close()});return!0}},{name:"open status message of focused morph",exec:function(Tc){var td=Tc.focusedMorph;Tc=td?
Tc.visibleStatusMessagesFor(td):[];if(Tc=Fa(Tc,1)[0])Tc.expand(),Tc.focus();return Tc||!0}},{name:"resize active window",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze,Ue=arguments;return regeneratorRuntime.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:ze=function(xf,lf){switch(xf){case "full":return gc;case "col1":case "left":return md.withTopLeft(gc.topLeft());case "col2":case "center":return md.withCenter(gc.center());case "col3":case "right":return md.translatedBy(vf.pt(gc.width-
Kc,0));case "top":return gc.divide([vf.rect(0,0,1,.5)])[0];case "bottom":return gc.divide([vf.rect(0,.5,1,.5)])[0];case "reset":return Jb._normalBounds||vf.pt(500,400).extentAsRectangle().withCenter(lf.center());default:return lf}};oe=function(){oe=Rc(regeneratorRuntime.mark(function lf(){var Rf,Hg,ng;return regeneratorRuntime.wrap(function(fg){for(;;)switch(fg.prev=fg.next){case 0:return fg.next=2,hd.filterableListPrompt("How to resize the window?","full center right left bottom top reset".split(" "),
{requester:hd});case 2:return Rf=fg.sent,Hg=Fa(Rf.selected,1),ng=Hg[0],fg.abrupt("return",ng);case 6:case "end":return fg.stop()}},lf)}));return oe.apply(this,arguments)};ud=function(){return oe.apply(this,arguments)};Sa=1<Ue.length&&void 0!==Ue[1]?Ue[1]:{how:null,window:null};Ma=Sa.window;jb=Sa.how;if(Jb=Ma||hd.activeWindow()){Me.next=8;break}return Me.abrupt("return");case 8:gc=hd.visibleBoundsExcludingTopBar().insetBy(15);ac=Jb.bounds();Jb._normalBounds||(Jb._normalBounds=ac);Kc=Math.min(700,Math.max(1E3,
gc.width/3));md=gc.withWidth(Kc);if(jb){Me.next=18;break}Me.next=17;return ud();case 17:jb=Me.sent;case 18:if(jb){Me.next=20;break}return Me.abrupt("return");case 20:return Jb.setBounds(ze(jb,gc)),"reset"===jb&&delete Jb._normalBounds,Me.abrupt("return",!0);case 23:case "end":return Me.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"[recovery] show last object editor saves",exec:function(Tc,td){return Tc.execCommand("[recovery] show last doits",Object.assign({},td,
{title:"logged ObjectEditor save",logAccessFn:function(){return JSON.parse(localStorage["oe helper"]).saves}}))}},{name:"[recovery] show last doits",description:"browse a list of your last doits",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf=arguments;return regeneratorRuntime.wrap(function(lf){for(;;)switch(lf.prev=lf.next){case 0:Sa=1<xf.length&&void 0!==xf[1]?xf[1]:{};(Ma=Sa.logAccessFn)||(Ma=function(){return JSON.parse(localStorage["lively.next-js-ide-doitlog"])});
try{jb=Ma()}catch(Rf){}if(jb){lf.next=6;break}return lf.abrupt("return",hd.inform("no log yet"));case 6:return Jb=vf.arr.sortBy(jb.map(function(Rf,Hg){var ng="string"===typeof Rf?Rf:Rf.source;Rf="string"===typeof Rf?Hg:Rf.time||Hg;Hg=vf.date.format(new Date(Rf),"yy-mm-dd HH:MM");return{time:Rf,source:ng,printedTime:Hg}}),function(Rf){return-Rf.time}),gc=Jb.map(function(Rf,Hg){return{isListItem:!0,string:"[".concat(Rf.printedTime,"] ").concat(Rf.source.slice(0,100).replace(/\n/g,"").trim()),value:Rf}}),
lf.next=10,hd.filterableListPrompt("select doit code",gc,{multiSelect:!0,requester:hd});case 10:ac=lf.sent;Kc=ac.selected;if(!Kc.length){lf.next=17;break}md=[];ud=M(Kc);try{for(ud.s();!(oe=ud.n()).done;)ze=oe.value,Ue=ze.source,Me=ze.printedTime,md.push("// ".concat(Me,"\n").concat(Ue))}catch(Rf){ud.e(Rf)}finally{ud.f()}return lf.abrupt("return",hd.execCommand("open workspace",Object.assign({title:"logged doits",mode:"js"},Sa,{content:md.join("\n\n")})));case 17:return lf.abrupt("return",!0);case 18:case "end":return lf.stop()}},
aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open loading indicator",exec:function(Tc,td){Tc={};"object"===ti(td)&&(Tc=td,td=Tc.label);return vf.LoadingIndicator.open(td,Tc)}},{name:"open workspace",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze,Ue,Me=arguments;return regeneratorRuntime.wrap(function(xf){for(;;)switch(xf.prev=xf.next){case 0:Sa=1<Me.length&&void 0!==Me[1]?Me[1]:{};jb=(Ma=3<Me.length?Me[3]:void 0)&&hd.relayCommandExecutionToFocusedMorph(Ma);
if(!jb){xf.next=6;break}return xf.abrupt("return",jb);case 6:Jb=Sa.language||Sa.mode||"javascript";gc={javascript:"lively.ide/js/workspace.js",shell:"lively.ide/shell/workspace.js",html:"lively.ide/html/workspace.js",py:"lively.ide/py/workspace.js",md:"lively.ide/md/workspace.js",sql:"lively.ide/sql/workspace.js",css:"lively.ide/css/workspace.js",less:"lively.ide/css/less/workspace.js",text:null};ac=Object.keys(vf.config.ide.modes.aliases).reduce(function(lf,Rf){return Object.assign(lf,dg({},vf.config.ide.modes.aliases[Rf],
Rf))},{});if(!Sa.askForMode){xf.next=17;break}ud=Object.keys(gc).concat("javascript console");xf.next=13;return hd.filterableListPrompt("Open workspace for...",ud);case 13:vf.__inter0__=xf.sent;Kc=vf.__inter0__.selected;md=Fa(Kc,1);if(Jb=md[0]){xf.next=17;break}return xf.abrupt("return",!0);case 17:if("javascript console"!==Jb){xf.next=19;break}return xf.abrupt("return",hd.execCommand("open console",Sa));case 19:Sa=Object.assign({content:""},Sa,{mode:Jb,language:Jb});oe=gc[Sa.language]||gc[ac[Sa.language]];
if("text"!==Jb&&oe){xf.next=23;break}return xf.abrupt("return",hd.execCommand("open text window",Object.assign({},vf.config.codeEditor.modes.text,{},Sa)));case 23:return xf.next=25,System["import"](oe);case 25:return ze=xf.sent,Ue=ze["default"],xf.abrupt("return",(new Ue({title:Sa.title||Sa.language+" workspace",center:hd.center,content:Sa.content,target:Sa.target,systemInterface:Sa.systemInterface||Sa.backend})).activate());case 28:case "end":return xf.stop()}},aa)}));return function(hd){return Tc.apply(this,
arguments)}}()},{name:"open console",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa;return regeneratorRuntime.wrap(function(Ma){for(;;)switch(Ma.prev=Ma.next){case 0:return Ma.next=3,vf.loadObjectFromPartsbinFolder("Console");case 3:return Sa=Ma.sent,Ma.abrupt("return",Sa.openInWorldNearHand());case 5:case "end":return Ma.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open shell workspace",exec:function(Tc,td){return Tc.execCommand("open workspace",
Object.assign({},td,{language:"shell"}))}},{name:"open javascript workspace",exec:function(Tc,td){return Tc.execCommand("open workspace",Object.assign({},td,{language:"javascript"}))}},{name:"open shell terminal",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function Sa(hd,aa){var Ma,jb;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return Jb.next=2,Dd.import("./terminal-636691b6.js");case 2:return Ma=Jb.sent,jb=Ma["default"],Jb.abrupt("return",jb.open(aa).openInWorldNearHand());
case 5:case "end":return Jb.stop()}},Sa)}));return function(hd,aa){return Tc.apply(this,arguments)}}()},{name:"open text window",exec:function(Tc){var td=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},hd=td.title,aa=td.extent,Sa=td.content,Ma=td.mode,jb=td.name,Jb=td.rangesAndStyles;hd=hd||"text window";Sa=Sa||"";aa=aa||vf.pt(500,400);jb=jb||"text workspace";Sa="string"===typeof Sa?[Sa,null]:Sa;td=new vf.Text(Object.assign({padding:vf.Rectangle.inset(3)},vf.obj.dissoc(td,["title","content"]),
{textAndAttributes:Sa,clipMode:"auto",name:jb,extent:aa}));Jb&&td.setTextAttributesWithSortedRanges(Jb);Ma&&td.changeEditorMode(Ma);return Tc.openInWindow(td,{title:hd}).activate()}},{name:"merge and open in window",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb=arguments;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return Sa=1<jb.length&&void 0!==jb[1]?jb[1]:{a:"",b:"",format:null,extent:vf.pt(500,600)},Jb.next=3,vf.loadObjectFromPartsbinFolder("text merger");
case 3:return Ma=Jb.sent,Jb.abrupt("return",Ma.targetMorph.open(Sa.a,Sa.b,Sa));case 5:case "end":return Jb.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"diff and open in window",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf,lf=arguments;return regeneratorRuntime.wrap(function(Rf){for(;;)switch(Rf.prev=Rf.next){case 0:return xf=function(){xf=Rc(regeneratorRuntime.mark(function Wh(ng,fg,gg){var wg,xh,
Qi,Di,Zi,ni,Xd,ff,af,Gf,Jh,ci;return regeneratorRuntime.wrap(function(di){for(;;)switch(di.prev=di.next){case 0:wg=gg.format;xh=null;if("patch"!==wg){di.next=12;break}Di=gg.headerA;Zi=gg.headerB;ni=gg.filenameA;Xd=gg.filenameB;ff=gg.context;Qi=[oe.createTwoFilesPatch(ni||"a",Xd||"b",ng,fg,Di,Zi,"number"===typeof ff?{context:ff}:void 0),{}];di.next=7;return Dd.import("./editor-plugin-2820dfc1.js");case 7:af=di.sent;Gf=af["default"];xh=new Gf;di.next=14;break;case 12:ze=oe[wg](ng,fg,gg),Qi=ze.flatMap(function(vj){vj.count;
var pj=vj.added;return[vj.value,vj.removed?{fontWeight:"normal",textDecoration:"line-through",fontColor:vf.Color.red}:pj?{fontWeight:"bold",textDecoration:"",fontColor:vf.Color.green}:{fontWeight:"normal",textDecoration:"",fontColor:vf.Color.darkGray}]});case 14:return Jh=hd.execCommand("open text window",gg),ci=Jh.targetMorph,Jh.extent=ud||vf.pt(300,200).maxPt(ci.textBounds().extent()),ci.textAndAttributes=Qi,xh&&ci.addPlugin(xh),di.abrupt("return",ci);case 20:case "end":return di.stop()}},Wh)}));
return xf.apply(this,arguments)},Me=function(Hg,ng,fg){return xf.apply(this,arguments)},Ue=function(Hg,ng){if(vf.obj.isPrimitive(Hg)||Hg instanceof RegExp||vf.obj.isPrimitive(ng)||ng instanceof RegExp)Hg=String(Hg),ng=String(ng);if("string"!==typeof Hg||"string"!==typeof ng)try{return JSON.stringify(Hg),JSON.stringify(ng),{format:"diffJson",a:Hg,b:ng}}catch(fg){Hg=String(Hg),ng=String(ng)}return{format:"diffLines",a:Hg,b:ng}},Sa=1<lf.length&&void 0!==lf[1]?lf[1]:{},Ma=Sa.a,jb=void 0===Ma?"":Ma,Jb=
Sa.b,gc=void 0===Jb?"":Jb,ac=Sa.format,Kc=void 0===ac?null:ac,md=Sa.extent,ud=void 0===md?ad(500,600):md,Kc?(jb=String(jb),gc=String(gc)):(vf.__inter1__=Ue(jb,gc),jb=vf.__inter1__.a,gc=vf.__inter1__.b,Kc=vf.__inter1__.format),Rf.next=8,Dd.import("./diff@5.0-976ac4cc.js");case 8:return oe=Rf.sent,Rf.next=11,Me(jb,gc,Object.assign({fontFamily:"monospace"},Sa,{format:Kc}));case 11:return ze=Rf.sent,Rf.abrupt("return",ze);case 13:case "end":return Rf.stop()}},aa)}));return function(hd){return Tc.apply(this,
arguments)}}()},{name:"merge workspaces",exec:function(Tc,td){return Tc.execCommand("diff workspace",Object.assign({},td,{merge:!0}))}},{name:"diff workspaces",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze=arguments;return regeneratorRuntime.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:oe=function(){oe=Rc(regeneratorRuntime.mark(function Rf(xf,lf){var Hg,ng,fg,gg;return regeneratorRuntime.wrap(function(Wh){for(;;)switch(Wh.prev=Wh.next){case 0:return Hg=
xf.map(function(wg){return{isListItem:!0,value:wg,string:wg.name||String(wg)}}),Wh.next=3,hd.filterableListPrompt("choose text: ",Hg,{onSelection:function(wg){wg&&wg.show()}});case 3:return ng=Wh.sent,fg=Fa(ng.selected,1),gg=fg[0],Wh.abrupt("return",gg);case 7:case "end":return Wh.stop()}},Rf)}));return oe.apply(this,arguments)};ud=function(Me,xf){return oe.apply(this,arguments)};md=function(){md=Rc(regeneratorRuntime.mark(function Rf(xf,lf){var Hg;return regeneratorRuntime.wrap(function(ng){for(;;)switch(ng.prev=
ng.next){case 0:return ng.next=2,vf.loadObjectFromPartsbinFolder("text merger");case 2:return Hg=ng.sent,ng.abrupt("return",Hg.targetMorph.open(xf.textString,lf.textString));case 4:case "end":return ng.stop()}},Rf)}));return md.apply(this,arguments)};Kc=function(Me,xf){return md.apply(this,arguments)};ac=function(Me,xf){var lf=Me.pluginFind(function(Hg){return Hg.evalEnvironment});lf=lf&&lf.evalEnvironment.targetModule||"no file";var Rf=xf.pluginFind(function(Hg){return Hg.evalEnvironment});return hd.execCommand("diff and open in window",
{a:Me.textString,b:xf.textString,filenameA:lf,filenameB:Rf&&Rf.evalEnvironment.targetModule||"no file"})};Sa=1<ze.length&&void 0!==ze[1]?ze[1]:{};Ma=Sa.editor1;jb=Sa.editor2;Jb=Sa.merge;gc=[];Ma&&jb||(gc=hd.withAllSubmorphsSelect(function(Me){return Me.isText&&!Me.isInputLine&&!Me.isUsedAsEpiMorph()}).reverse());if(Ma){Ue.next=13;break}Ue.next=12;return ud(gc);case 12:Ma=Ue.sent;case 13:if(Ma){Ue.next=15;break}return Ue.abrupt("return",hd.setStatusMessage("Canceled"));case 15:if(jb){Ue.next=19;break}Ue.next=
18;return ud(vf.arr.without(gc,Ma));case 18:jb=Ue.sent;case 19:if(jb){Ue.next=21;break}return Ue.abrupt("return",hd.setStatusMessage("Canceled"));case 21:return Ue.abrupt("return",Jb?Kc(Ma,jb):ac(Ma,jb));case 22:case "end":return Ue.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"search workspaces",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function hd(){var aa,Sa,Ma,jb,Jb,gc,ac,Kc;return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=md.next){case 0:return Kc=
function(ud){return $world.withAllSubmorphsDo(function(oe){oe.isWindow&&oe.minimized&&oe.targetMorph&&oe.targetMorph.isText&&(oe=oe.targetMorph);if(!oe.textString||!oe.isText||oe.isUsedAsEpiMorph())return null;var ze=oe.textString.toLowerCase();return ud.every(function(Ue){return ze.includes(Ue)})?oe:null}).filter(Boolean)},ac=function(ud,oe){return ud.map(function(ze){var Ue=ze.world()?ze.getWindow():$world.withAllSubmorphsDetect(function(Rf){return Rf.isWindow&&Rf.targetMorph===kb}),Me=0,xf=vf.string.lines(ze.textString).find(function(Rf,
Hg){Rf=Rf.toLowerCase();Me=Hg;return oe.every(function(ng){return Rf.includes(ng)})}),lf=Ue?Ue.title:ze.toString();return xf?{isListItem:!0,string:lf+" | "+xf,value:{window:Ue,morph:ze,row:Me}}:null}).filter(Boolean)},md.next=4,$world.filterableListPrompt("search workspaces",[],{historyId:"lively.morphic-ide-search-workspaces-hist",customize:function(ud){ud.getSubmorphNamed("list").updateFilter=function(){var oe=this.parseInput();if(!(3>oe.input.length)){var ze=Kc(oe.lowercasedTokens);this.listMorph.items=
ac(ze,oe.lowercasedTokens)}}}});case 4:aa=md.sent;Sa=Fa(aa.selected,1);Ma=Sa[0];if(!Ma){md.next=13;break}jb=Ma.morph;Jb=Ma.window;gc=Ma.row;Jb&&(Jb.minimized&&Jb.toggleMinimize(),Jb.activate());(Jb||jb).show();this.cursorPosition={row:gc,column:0};return md.abrupt("return",jb);case 13:return md.abrupt("return",null);case 14:case "end":return md.stop()}},hd,this)}));return function(){return Tc.apply(this,arguments)}}()},{name:"open PartsBin",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,
Ma,jb,Jb;return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=gc.next){case 0:return Sa=vf.LoadingIndicator.open("Loading Partsbin..."),gc.next=3,Dd.import("./__rootModule___commonjs-entry-51a55f66.js").then(function(ac){return ac.ch});case 3:return Ma=gc.sent,jb=Ma.loadPart,gc.next=7,jb("PartsBin");case 7:return Jb=gc.sent,Jb.openInWorldNearHand(),Jb.targetMorph.selectedCategory="*basics*",Jb.focus(),Sa.remove(),Jb.getWindow().activate(),gc.abrupt("return",Jb);case 14:case "end":return gc.stop()}},
aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"browse and load component",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return Sa=vf.LoadingIndicator.open("loading component browser"),ac.next=3,Dd.import("./component-browser.cp-99b38163.js");case 3:Ma=ac.sent;jb=Ma.ComponentBrowser;if(hd._componentsBrowser){ac.next=8;break}ac.next=8;return Sa.whenRendered();
case 8:return Jb=hd._componentsBrowser||(hd._componentsBrowser=vf.part(jb)),Sa.remove(),ac.next=12,Jb.activate();case 12:(gc=ac.sent)&&!gc.world()&&gc.openInWorld();case 14:case "end":return ac.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"load object from PartsBin",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe=arguments;return regeneratorRuntime.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:Sa=1<oe.length&&
void 0!==oe[1]?oe[1]:{};jb=Sa.name;Jb=Sa.open;gc=void 0===Jb?!0:Jb;if(!jb){ze.next=12;break}ze.next=5;return Dd.import("./__rootModule___commonjs-entry-51a55f66.js").then(function(Ue){return Ue.ch});case 5:return ac=ze.sent,Kc=ac.loadObjectFromPartsbinFolder,ze.next=9,Kc(jb);case 9:Ma=ze.sent;ze.next=19;break;case 12:return ze.next=14,Dd.import("./__rootModule___commonjs-entry-51a55f66.js").then(function(Ue){return Ue.ch});case 14:return md=ze.sent,ud=md.interactivelyLoadObjectFromPartsBinFolder,
ze.next=18,ud();case 18:Ma=ze.sent;case 19:return Ma&&gc&&Ma.openInWorldNearHand(),ze.abrupt("return",Ma);case 21:case "end":return ze.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open object drawer",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma;return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.next=2,Dd.import("./object-drawer-c3167821.js");case 2:return Sa=jb.sent,Ma=Sa["default"],jb.abrupt("return",
(new Ma).openInWorldNearHand());case 5:case "end":return jb.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open object editor",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc=arguments;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:Sa=1<gc.length&&void 0!==gc[1]?gc[1]:{target:null,selectedClass:null,selectedMethod:null,evalEnvironment:null};if(Sa.target){ac.next=4;break}hd.setStatusMessage("No target for ObjectEditor");
return ac.abrupt("return",null);case 4:return Ma=Sa.loadingIndicator=vf.LoadingIndicator.open("Open Object Editor..."),ac.next=7,Dd.import("./ui.cp-d4c2af17.js");case 7:return jb=ac.sent,ac.next=10,jb.open(Sa);case 10:return Jb=ac.sent,Ma.remove(),ac.abrupt("return",Jb);case 13:case "end":return ac.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open object inspector",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma=arguments;return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=
jb.next){case 0:Sa=1<Ma.length&&void 0!==Ma[1]?Ma[1]:{target:null};if(Sa.target){jb.next=4;break}hd.setStatusMessage("no target for Inspector");return jb.abrupt("return",null);case 4:return jb.abrupt("return",vf.inspect(Sa.target));case 5:case "end":return jb.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"inspect server",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=
ac.next){case 0:return ac.next=2,Dd.import("./ui.cp-8dfc076f.js").then(function(Kc){return Kc.I});case 2:return Sa=ac.sent,ac.next=5,Dd.import("./index-42118cd5.js");case 5:return Ma=ac.sent,jb=Ma.serverInterfaceFor,Jb=jb(System.baseURL+"eval"),gc={format:"esm",context:"global",targetModule:"lively://lively.next-workspace/world",sourceURL:"inspect-server_"+Date.now(),systemInterface:Jb},ac.next=11,Jb.runEval('\n           import LivelyServer from "lively.server/server.js";\n           let server = LivelyServer.servers.values().next().value;\n        ',
gc);case 11:Sa.openInWindow({remoteTarget:{code:"server",evalEnvironment:gc}});case 12:case "end":return ac.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open scene graph inspector",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb=arguments;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return Sa=1<jb.length&&void 0!==jb[1]?jb[1]:{target:null},Jb.next=3,vf.loadObjectFromPartsbinFolder("scene graph inspector");
case 3:return Ma=Jb.sent,Ma.targetMorph=Sa.target||hd,Jb.abrupt("return",Ma.openInWindow({title:"morph graph"}));case 6:case "end":return Jb.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open browser",progressIndicator:"opening browser...",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc=arguments;return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=md.next){case 0:Sa=1<Kc.length&&void 0!==Kc[1]?Kc[1]:{packageName:"lively.morphic",
moduleName:"morph.js",scroll:vf.pt(0,0)};jb=(Ma=3<Kc.length?Kc[3]:void 0)&&hd.relayCommandExecutionToFocusedMorph(Ma);if(!jb){md.next=6;break}return md.abrupt("return",jb);case 6:return md.next=8,Dd.import("./ui.cp-499efc12.js");case 8:Jb=md.sent;if(!Sa){md.next=16;break}ac=vf.obj.select(Sa,"packageName moduleName textPosition codeEntity systemInterface scroll".split(" "));md.next=13;return Jb.browse(ac,{extent:vf.pt(700,600)});case 13:gc=md.sent;md.next=19;break;case 16:return md.next=18,Jb.open();
case 18:gc=md.sent;case 19:return gc.getWindow().activate(),md.abrupt("return",gc);case 21:case "end":return md.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"choose and browse package resources",progressIndicator:"browsing resources...",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf,lf,Rf,Hg,ng,fg,gg,Wh=arguments;return regeneratorRuntime.wrap(function(wg){for(;;)switch(wg.prev=wg.next){case 0:Sa=1<
Wh.length&&void 0!==Wh[1]?Wh[1]:{browser:null,systemInterface:null};jb=(Ma=3<Wh.length?Wh[3]:void 0)&&hd.relayCommandExecutionToFocusedMorph(Ma);if(!jb){wg.next=6;break}return wg.abrupt("return",jb);case 6:return Jb=(Jb=Sa.browser||hd.focusedMorph&&hd.focusedMorph.ownerChain().find(function(xh){return xh.isBrowser}))&&Jb.isBrowser?Jb.getWindow():null,wg.next=10,Dd.import("./index-42118cd5.js");case 10:return gc=wg.sent,ac=gc.localInterface,Kc=Sa&&Sa.systemInterface?Sa.systemInterface:Jb?Jb.systemInterface:
ac,wg.next=15,Kc.getPackages({excluded:vf.config.ide.js.ignoredPackages});case 15:md=wg.sent,ud=[],oe=M(md),wg.prev=18,Ue=regeneratorRuntime.mark(function Qi(){var Di,Zi;return regeneratorRuntime.wrap(function(ni){for(;;)switch(ni.prev=ni.next){case 0:return Di=ze.value,Zi=(vf.Path("lively.ide.exclude").get(Di)||[]).map(function(Xd){return Xd.includes("*")?new RegExp(Xd.replace(/\*/g,".*")):Xd}),Zi.push(".git","node_modules",".module_cache"),ni.t0=ud.push,ni.t1=ud,ni.t2=Xa,ni.next=8,Kc.resourcesOfPackage(Di,
Zi);case 8:ni.t3=function(Xd){var ff=Xd.url;return!ff.endsWith("/")&&!Zi.some(function(af){return af instanceof RegExp?af.test(ff):ff.includes(af)})},ni.t4=function(Xd,ff){return Xd.isLoaded&&!ff.isLoaded?-1:!Xd.isLoaded&&ff.isLoaded?1:Xd.nameInPackage.toLowerCase()<ff.nameInPackage.toLowerCase()?-1:Xd.nameInPackage.toLowerCase()===ff.nameInPackage.toLowerCase()?0:1},ni.t5=function(Xd){return{isListItem:!0,string:"[".concat(Di.name,"] ").concat(Xd.nameInPackage).concat(Xd.isLoaded?"":" [not loaded]"),
value:Xd}},ni.t6=ni.sent.filter(ni.t3).sort(ni.t4).map(ni.t5),ni.t7=(0,ni.t2)(ni.t6),ni.t0.apply.call(ni.t0,ni.t1,ni.t7);case 14:case "end":return ni.stop()}},Qi)}),oe.s();case 21:if((ze=oe.n()).done){wg.next=25;break}return wg.delegateYield(Ue(),"t0",23);case 23:wg.next=21;break;case 25:wg.next=30;break;case 27:wg.prev=27,wg.t1=wg["catch"](18),oe.e(wg.t1);case 30:return wg.prev=30,oe.f(),wg.finish(30);case 33:return wg.next=35,hd.filterableListPrompt("Choose module to open",ud,{historyId:"lively.morphic-choose and browse package resources",
requester:Jb,width:700,multiSelect:!0,fuzzy:"value.shortName"});case 35:return Me=wg.sent,xf=Me.selected,lf=vf.arr.partition(xf,function(Qi){return Qi.url.match(/\.js(on)?/)}),Rf=Fa(lf,2),Hg=Rf[0],ng=Rf[1],wg.next=40,Dd.import("./index-81f98d16.js").then(function(Qi){return Qi.i});case 40:return fg=wg.sent,gg=fg["default"],wg.next=44,Promise.all(Hg.map(function(Qi){return gg.browse({packageName:Qi["package"],moduleName:Qi.url},Jb,Kc).then(function(Di){return Di.activate()})}));case 44:if(!ng.length){wg.next=
47;break}wg.next=47;return Promise.all(ng.map(function(Qi){return hd.execCommand("open file",{url:Qi.url})}));case 47:return wg.abrupt("return",!0);case 48:case "end":return wg.stop()}},aa,null,[[18,27,30,33]])}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"choose and browse module",progressIndicator:"browsing module...",handlesCount:!0,exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf,lf,Rf,Hg,ng,fg,gg,Wh=arguments;
return regeneratorRuntime.wrap(function(wg){for(;;)switch(wg.prev=wg.next){case 0:Sa=1<Wh.length&&void 0!==Wh[1]?Wh[1]:{browser:void 0,systemInterface:void 0};Ma=2<Wh.length?Wh[2]:void 0;if(Sa.browser){wg.next=7;break}Jb=(jb=hd.focusedMorph)&&jb.getWindow();if(!(Jb&&Jb.targetMorph&&Jb.targetMorph.isFileBrowser)){wg.next=7;break}return wg.abrupt("return",Jb.targetMorph.execCommand("find file and select",Sa,Ma));case 7:return gc=Sa.browser||jb&&jb.ownerChain().find(function(xh){return xh.isBrowser}),
wg.next=10,Dd.import("./ui.cp-499efc12.js");case 10:return ac=wg.sent,wg.next=13,Dd.import("./index-42118cd5.js");case 13:return Kc=wg.sent,md=Kc.localInterface,ud=Sa&&Sa.systemInterface?Sa.systemInterface:gc?gc.systemInterface:md,oe="local"===ud.name?"":" on [".concat(vf.string.truncate(ud.name,35,"..."),"]"),wg.next=19,ud.getPackages();case 19:ze=wg.sent,Ue=[],Me=M(ze),wg.prev=22,Me.s();case 24:if((xf=Me.n()).done){wg.next=48;break}lf=xf.value;Rf=vf.Path("lively.ide.exclude").get(lf)||[];Rf=Rf.map(function(xh){return xh.includes("*")?
new RegExp(xh.replace(/\*/g,".*")):xh});Hg=M(lf.modules);wg.prev=29;fg=function(){var xh=ng.value;if(Rf.some(function(Di){return Di instanceof RegExp?Di.test(xh.name):xh.name.includes(Di)}))return"continue";var Qi=ud.shortModuleName(xh.name,lf);Ue.push({isListItem:!0,string:"[".concat(lf.name,"] ").concat(Qi),value:{"package":lf,module:xh,shortName:Qi}})};Hg.s();case 32:if((ng=Hg.n()).done){wg.next=38;break}gg=fg();if("continue"!==gg){wg.next=36;break}return wg.abrupt("continue",36);case 36:wg.next=
32;break;case 38:wg.next=43;break;case 40:wg.prev=40,wg.t0=wg["catch"](29),Hg.e(wg.t0);case 43:return wg.prev=43,Hg.f(),wg.finish(43);case 46:wg.next=24;break;case 48:wg.next=53;break;case 50:wg.prev=50,wg.t1=wg["catch"](22),Me.e(wg.t1);case 53:return wg.prev=53,Me.f(),wg.finish(53);case 56:return Ue=vf.arr.sortBy(Ue,function(xh){return xh.string}),Rc(regeneratorRuntime.mark(function Qi(){var Di,Zi,ni,Xd,ff,af,Gf,Jh,ci;return regeneratorRuntime.wrap(function(di){for(;;)switch(di.prev=di.next){case 0:return Di=
gc||jb,di.next=3,hd.filterableListPrompt("Choose module to open".concat(oe),Ue,{historyId:"lively.morphic-choose and browse module",requester:Di,height:Math.min(Di.height,700),width:500,multiSelect:!0,listFontColor:"white",fuzzy:"value.shortName"});case 3:Zi=di.sent,ni=Zi.selected,Xd=0;case 6:if(!(Xd<ni.length)){di.next=17;break}ff=ni[Xd];af=ff["package"];Gf=ff.shortName;Jh={packageName:af.name,moduleName:Gf};di.next=11;return ac.browse(Jh,0===Xd?gc:void 0,ud);case 11:ci=di.sent,ci.moveBy(vf.pt(20*
Xd,20*Xd)),ci.getWindow().activate();case 14:Xd++;di.next=6;break;case 17:case "end":return di.stop()}},Qi)}))(),wg.abrupt("return",!0);case 59:case "end":return wg.stop()}},aa,null,[[22,50,53,56],[29,40,43,46]])}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open code search",progressIndicator:"opening code search...",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe=arguments;return regeneratorRuntime.wrap(function(ze){for(;;)switch(ze.prev=
ze.next){case 0:Sa=1<oe.length&&void 0!==oe[1]?oe[1]:{browser:null,systemInterface:null,input:null};Ma=hd.focusedMorph?hd.focusedMorph.ownerChain():[];jb=Sa.browser||Ma.find(function(Ue){return Ue.isBrowser});Jb=vf.LoadingIndicator.open("loading code search");if(!jb||!jb.isBrowser){ze.next=10;break}if(!jb.associatedSearchPanel){ze.next=8;break}Jb.remove();return ze.abrupt("return",jb.associatedSearchPanel.getWindow().activate());case 8:ze.next=11;break;case 10:jb=null;case 11:return ze.next=13,Dd.import("./index-42118cd5.js");
case 13:return gc=ze.sent,ac=gc.localInterface,Kc=Sa.systemInterface||jb&&jb.systemInterface,Kc||(Kc=(md=Ma.find(function(Ue){return Ue.isText&&Ue.editorPlugin&&Ue.editorPlugin.isJSEditorPlugin}))?md.editorPlugin.systemInterface():ac),ud=vf.part(vf.CodeSearch),Object.assign(ud,{browser:jb,input:Sa.input,systemInterface:Kc}),ud.openInWindow(),ud.focus(),Jb.remove(),jb&&(jb.associatedSearchPanel=ud),ze.abrupt("return",ud);case 24:case "end":return ze.stop()}},aa)}));return function(hd){return Tc.apply(this,
arguments)}}()},{name:"open grep search",progressIndicator:"opening code search...",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function Sa(hd,aa){var Ma;return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.next=2,vf.loadObjectFromPartsbinFolder("grep search");case 2:return Ma=jb.sent,jb.abrupt("return",Ma.openInWorldNearHand(hd).activate());case 4:case "end":return jb.stop()}},Sa)}));return function(hd,aa){return Tc.apply(this,arguments)}}()},{name:"open test runner",
progressIndicator:"opening test runner...",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma;return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.next=2,Dd.import("./test-runner-15eee9f1.js");case 2:return Sa=jb.sent,Ma=Sa["default"],jb.next=6,Ma.open();case 6:return jb.abrupt("return",jb.sent);case 7:case "end":return jb.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open file browser",progressIndicator:"opening file browser...",
exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md=arguments;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=ud.next){case 0:return Sa=1<md.length&&void 0!==md[1]?md[1]:{},ud.next=3,Dd.import("./http-file-browser-a72ec8ee.js");case 3:return Ma=ud.sent,jb=Ma["default"],Jb=Sa.location,gc=Sa.url,Kc=(ac=Sa.file)?jb.forFile(ac,Jb):jb.forLocation(gc||Jb||document.location.origin),ud.abrupt("return",hd.openInWindow(Kc).activate());case 8:case "end":return ud.stop()}},
aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open file",progressIndicator:"opening file...",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud=arguments;return regeneratorRuntime.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:Sa=1<ud.length&&void 0!==ud[1]?ud[1]:{url:null,lineNumber:null,reuse:!1};Ma=Sa.url;jb=Sa.lineNumber;Jb=Sa.reuse;gc=hd.commandHandler.progressIndicator;if(Ma){oe.next=9;break}gc.visible=!1;oe.next=
7;return hd.prompt("Enter file location",{historyId:"lively.morphic-text editor url",useLastInput:!0});case 7:Ma=oe.sent,gc.visible=!0;case 9:if(!Jb){oe.next=14;break}ac=vf.arr.findAndGet(hd.getWindows(),function(ze){return(ze=ze.targetMorph)&&ze.isTextEditor&&ze.location.split(":")[0]===Ma?ze:null});if(!ac){oe.next=14;break}"number"===typeof jb&&(ac.lineNumber=jb);return oe.abrupt("return",ac.getWindow().activate());case 14:return jb&&(Ma+=":"+jb),oe.next=17,Dd.import("./text-editor-7eb763f4.js");
case 17:return Kc=oe.sent,md=Kc["default"],oe.abrupt("return",Ma?md.openURL(Ma,vf.obj.dissoc(Sa,["url"])):null);case 20:case "end":return oe.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open file for EDITOR",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc=arguments;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return Sa=1<gc.length&&void 0!==gc[1]?gc[1]:{url:null,lineNumber:null},ac.next=3,
Dd.import("./text-editor-7eb763f4.js");case 3:return Ma=ac.sent,jb=Ma["default"],Jb=Sa.url,ac.next=8,jb.openAsEDITOR(Jb,{});case 8:return ac.abrupt("return",ac.sent);case 9:case "end":return ac.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"open subserver controller",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function Sa(hd,aa){var Ma;return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.next=2,vf.loadPart("subserver controller");
case 2:return Ma=jb.sent,jb.abrupt("return",Ma.openInWorld());case 4:case "end":return jb.stop()}},Sa)}));return function(hd,aa){return Tc.apply(this,arguments)}}()},{name:"[lively.installer] publish new version of a package",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma;return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.next=2,lively.modules.registerPackage(document.location.origin+"/lively.installer");case 2:return jb.next=4,
Dd.import("./publish-new-package-version-92443933.js");case 4:return Sa=jb.sent,Ma=Sa["default"],jb.next=8,Ma();case 8:return jb.abrupt("return",!0);case 9:case "end":return jb.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"report a bug",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){return regeneratorRuntime.wrap(function(Sa){for(;;)switch(Sa.prev=Sa.next){case 0:return window.open("https://github.com/LivelyKernel/lively.next/issues/new","_blank"),
Sa.abrupt("return",!0);case 2:case "end":return Sa.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"fix font metric",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){return regeneratorRuntime.wrap(function(Sa){for(;;)switch(Sa.prev=Sa.next){case 0:return hd.env.fontMetric.reset(),hd.withAllSubmorphsDo(function(Ma){return Ma.isText&&Ma.textLayout&&Ma.textLayout.reset()}),Sa.abrupt("return",!0);case 3:case "end":return Sa.stop()}},aa)}));return function(hd){return Tc.apply(this,
arguments)}}()},{name:"delete change history",exec:function(Tc){var td=Tc.env,hd=td.printStatus();td.deleteHistory();Tc.setStatusMessage(hd);Tc._componentsBrowser&&Tc._componentsBrowser.reset();return!0}},{name:"install global inspect and show",exec:function(Tc){window.show=vf.show;window.inspect=vf.inspect;Tc.setStatusMessage("inspect() and show() are now globally available");return!0}},{name:"save world",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function jb(hd,aa,Sa,Ma){var Jb,gc,ac;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=
Kc.next){case 0:Jb=Ma&&hd.relayCommandExecutionToFocusedMorph(Ma);if(!Jb){Kc.next=3;break}return Kc.abrupt("return",Jb);case 3:return aa=Object.assign({confirmOverwrite:!0,showSaveDialog:!0,moduleManager:vf.modules},aa),gc=hd.focusedMorph,Kc.next=7,vf.interactivelySaveWorld(hd,aa);case 7:return ac=Kc.sent,gc&&gc.focus(),Kc.abrupt("return",ac);case 10:case "end":return Kc.stop()}},jb)}));return function(hd,aa,Sa,Ma){return Tc.apply(this,arguments)}}()},{name:"freeze world",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){return regeneratorRuntime.wrap(function(Sa){for(;;)switch(Sa.prev=
Sa.next){case 0:return Sa.next=2,vf.interactivelyFreezeWorld(hd);case 2:case "end":return Sa.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"save this world",exec:function(Tc,td,hd,aa){return Tc.execCommand("save world",Object.assign({confirmOverwrite:!0},td,{showSaveDialog:!1}))}},{name:"load world",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac,Kc,md,ud,oe,ze=arguments;return regeneratorRuntime.wrap(function(Ue){for(;;)switch(Ue.prev=
Ue.next){case 0:Sa=1<ze.length&&void 0!==ze[1]?ze[1]:{};Ma=Sa.id;jb=Sa.commit;Jb=Sa.name;gc=Sa.ref;ac=Sa.world;Kc=hd.constructor;if(!ac){Ue.next=5;break}return Ue.abrupt("return",Kc.loadWorld(ac,hd,{moduleManager:vf.modules}));case 5:if(!Ma&&!jb){Ue.next=7;break}return Ue.abrupt("return",Kc.loadFromCommit(Ma||jb,hd,{moduleManager:vf.modules}));case 7:if(!Jb){Ue.next=9;break}return Ue.abrupt("return",Kc.loadFromDB(Jb,gc,hd,{moduleManager:vf.modules}));case 9:return md=vf.LoadingIndicator.open("loading project browser..."),
Ue.next=12,md.whenRendered();case 12:return ud=vf.morph({fill:vf.Color.black.withA(.5),extent:hd.extent,name:"dark overlay",opacity:0,reactsToPointer:!1,renderOnGPU:!0,halosEnabled:!1}),ud.openInWorld(vf.pt(0,0)),ud.animate({opacity:1,duration:300}),oe=hd.get("a project browser")||vf.part(vf.WorldBrowser,{name:"a project browser"}),oe.name="a project browser",oe.hasFixedPosition=!0,oe.epiMorph=!0,oe.bringToFront().alignInWorld(hd),oe.update(),oe.focus(),vf.once(oe,"remove",function(){return ud.animate({opacity:0}).then(function(){return ud.remove()})}),
md.remove(),Ue.abrupt("return",oe);case 25:case "end":return Ue.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()},{name:"add external package dependency to object",exec:function(){var Tc=Rc(regeneratorRuntime.mark(function aa(hd){var Sa,Ma,jb,Jb,gc,ac=arguments;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=Kc.next){case 0:return Sa=1<ac.length&&void 0!==ac[1]?ac[1]:{},Ma=Sa.target||hd,jb=Ma.metadata&&Ma.metadata.externalPackages||[],Kc.next=5,hd.editListPrompt("modify package dependencies of "+
Ma,jb);case 5:Jb=Kc.sent;if(gc=Jb.list){Kc.next=9;break}return Kc.abrupt("return");case 9:return gc.length?(Ma.metadata||(Ma.metadata={}),Ma.metadata.externalPackages=gc):Ma.metadata&&delete Ma.metadata.externalPackages,Kc.abrupt("return",!0);case 11:case "end":return Kc.stop()}},aa)}));return function(hd){return Tc.apply(this,arguments)}}()}];Ge=vf.commands;vf["default"]=Ge;var ye=window.lively.FreezerRuntime.recorderFor("lively.ide/world.js");ye.resource=Wb;ye.Rectangle=Pc;ye.Color=Ne;ye.pt=ad;
ye.arr=sb;ye.fun=lc;ye.obj=ab;ye.promise=ob;ye.PropertyPath=Db;ye.once=rd;ye.GridLayout=Of;ye.MorphicDB=Hb;ye.easings=ve;ye.HTMLMorph=zc;ye.Text=jc;ye.touchInputDevice=Qc;ye.Icon=vd;ye.Morph=Fc;ye.VerticalLayout=mg;ye.HorizontalLayout=dd;ye.ProportionalLayout=Ed;ye.Image=se;ye.inspect=Le;ye.config=da;ye.World=Cc;ye.loadMorphFromSnapshot=wf;ye.loadObjectFromPartsbinFolder=xe;ye.loadPart=Fg;ye.uploadFile=v;ye.prompts=ma;ye.moduleManager=Ya;ye.LoadingIndicator=Sc;ye.Halo=Ce;ye.MorphHighlighter=$e;ye.ProportionalLayoutHalo=
pf;ye.GridLayoutHalo=ig;ye.FlexLayoutHalo=Xf;ye.Window=Ea;ye.Menu=ua;ye.completions=mf;ye.runEval=Mb;ye.getClassName=gd;ye.serialize=xb;ye.StatusMessageDefault=Vg;ye.StatusMessageConfirm=Re;ye.StatusMessageError=ae;ye.part=ic;ye.worldCommands=Ge;ye.CommentData=Be;mh=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/world.js"),hd=td.hasOwnProperty("LivelyWorld")&&"function"===typeof td.LivelyWorld?td.LivelyWorld:td.LivelyWorld=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return db(hd,Tc,[{key:"isIDEWorld",get:function(){return!0}},{key:"visibleBoundsExcludingTopBar",value:function(){var aa=$world.getSubmorphNamed("lively top bar"),Sa=this.visibleBounds();return aa?new ye.Rectangle(Sa.x,Sa.y+aa.height,Sa.width,Sa.height-aa.height):Sa}},{key:"getListedComponents",value:function(){var aa=this,Sa=this.withAllSubmorphsSelect(function(Ma){return Ma.isComponent&&!aa.hiddenComponents.includes(Ma.name)});return ye.arr.uniq([].concat(Xa(Sa),Xa(this.localComponents)))}},
{key:"activeWindow",value:function(){return this.getWindows().reverse().find(function(aa){return aa.isActive()})}},{key:"getWindows",value:function(){return this.submorphs.filter(function(aa){return aa.isWindow})}},{key:"activePrompt",value:function(){return this.getPrompts().reverse().find(function(aa){return aa.isActive()})}},{key:"getPrompts",value:function(){return this.submorphs.filter(function(aa){return aa.isPrompt})}},{key:"openInWindow",value:function(aa){var Sa=(new ye.Window(Object.assign({},
1<arguments.length&&void 0!==arguments[1]?arguments[1]:{title:aa.name,name:"window for "+aa.name},{extent:aa.extent.addXY(0,25),targetMorph:aa}))).openInWorld();Sa.ensureNotOverTheTop();return Sa}},{key:"withTopBarDo",value:function(aa){var Sa=this.get("lively top bar");if(Sa)return aa(Sa.viewModel)}},{key:"onTopBarLoaded",value:function(){}},{key:"onKeyUp",value:function(aa){this.withTopBarDo(function(Sa){return Sa.onKeyUp(aa)})}},{key:"onKeyDown",value:function(aa){db._get(Object.getPrototypeOf(hd.prototype),
"onKeyDown",this).call(this,aa);aa.targetMorph===this&&this.withTopBarDo(function(Sa){return Sa.onKeyDown(aa)})}},{key:"onMouseDown",value:function(aa){db._get(Object.getPrototypeOf(hd.prototype),"onMouseDown",this).call(this,aa);var Sa=aa.state.clickedOnMorph,Ma=this.activeWindow();Ma&&Sa===this&&Ma.deactivate();this.handleHaloCycle(aa);aa.state.menu&&aa.state.menu.remove();this._tooltipViewer.mouseDown(aa)}},{key:"onMouseUp",value:function(aa){aa.isCommandKey()&&aa.stop();if(aa.isAltDown()&&ye.config.altClickDefinesThat){var Sa=
this.morphsContainingPoint(aa.position)[0];Sa.owner.isHalo&&(Sa=Sa.owner.target);setTimeout(function(){return System.global.that=Sa},100);Sa.show();aa.stop();console.log('Set global "that" to '.concat(Sa))}}},{key:"onDrag",value:function(aa){}},{key:"whenReady",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.next=2,this._styleLoading;case 2:return jb.abrupt("return",!0);case 3:case "end":return jb.stop()}},
Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"onLoad",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb=this;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:this.opacity=0,this.onWindowResize(),lively.modules&&lively.modules.removeHook("fetch",window.__logFetch),this.animate({opacity:1,blur:3,duration:1E3,easing:ye.easings.inOutExpo}).then(Rc(regeneratorRuntime.mark(function ac(){var Kc,md;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=
ud.next){case 0:if(!(Kc=window.worldLoadingIndicator)){ud.next=8;break}md=Kc.world();if(!md||md.env===jb.env){ud.next=8;break}Kc.withAllSubmorphsDo(function(oe){return oe._env=jb.env});jb.addMorph(Kc);ud.next=7;return md.whenRendered();case 7:md.env.renderer.stopRenderWorldLoop();case 8:case "end":return ud.stop()}},ac)}))),this.animate({blur:0,duration:1E3,easing:ye.easings.inOutExpo}),document.body.style.overflowX="visible",document.body.style.overflowY="visible";case 7:case "end":return Jb.stop()}},
Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"isNotUnique",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return Jb.next=2,ye.MorphicDB["default"].exists("world",Ma);case 2:Jb.t0=Jb.sent.exists;if(Jb.t0){Jb.next=12;break}Jb.t1=ye;Jb.next=7;return System.decanonicalize("lively.morphic/styleguides");case 7:return Jb.t2=Jb.sent,Jb.t3=Ma+".json",Jb.next=11,Jb.t1.resource.call(Jb.t1,
Jb.t2).join(Jb.t3).exists();case 11:Jb.t0=Jb.sent;case 12:return Jb.abrupt("return",Jb.t0);case 13:case "end":return Jb.stop()}},jb)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"askForName",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return ac.next=2,this.whenRendered();case 2:if(jb){ac.next=23;break}ac.next=5;return this.prompt(["New Project\n",{},"Enter a name for this project:",
{fontWeight:"normal"}],{width:400,hasFixedPosition:!0,forceConfirm:!0});case 5:return jb=ac.sent,ac.next=8,this.isNotUnique(jb);case 8:if(!ac.sent){ac.next=21;break}ac.next=11;return this.confirm("This Project name is already taken. Do you want to override it?",{hasFixedPosition:!0,width:400});case 11:Jb=ac.sent;if(!Jb){ac.next=20;break}ac.next=15;return this.confirm("The old project will be lost! Are you sure you want to override?",{hasFixedPosition:!0,width:400});case 15:gc=ac.sent;if(!gc){ac.next=
20;break}ac.next=19;return ye.MorphicDB["default"]["delete"]("world",jb);case 19:return ac.abrupt("return",jb);case 20:jb=!1;case 21:ac.next=2;break;case 23:return ac.abrupt("return",jb);case 24:case "end":return ac.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"onWindowResize",value:function(aa){db._get(Object.getPrototypeOf(hd.prototype),"onWindowResize",this).call(this,aa);"elastic"===this.resizePolicy&&this.execCommand("resize to fit window")}},{key:"nativeDrop_ensureUploadIndicator",
value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb=this,Jb;return regeneratorRuntime.wrap(function(gc){for(;;)switch(gc.prev=gc.next){case 0:return this._cachedDragIndicator||(this._cachedDragIndicator=ye.loadObjectFromPartsbinFolder("upload-indicator")),gc.next=3,this._cachedDragIndicator;case 3:Jb=gc.sent,Jb.world()||Jb.openInWorld(),ye.fun.debounceNamed("remove-upload-indicator",1E3,function(){jb.nativeDrop_removeUploadIndicator()})();case 6:case "end":return gc.stop()}},Ma,
this)}));return function(){return aa.apply(this,arguments)}}()},{key:"nativeDrop_removeUploadIndicator",value:function(){this._cachedDragIndicator&&this._cachedDragIndicator.then(function(aa){return aa.remove()})}},{key:"onNativeDragover",value:function(aa){aa.targetMorph===this&&this.nativeDrop_ensureUploadIndicator()}},{key:"onNativeDrop",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb=this,gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf,lf,Rf,Hg,ng,fg,gg,Wh,wg,xh,Qi,Di,Zi,ni,Xd,ff,af,Gf,
Jh,ci,di,vj,pj,kj,Ih,mk,fl,Al,rg;return regeneratorRuntime.wrap(function(Sg){for(;;)switch(Sg.prev=Sg.next){case 0:this.nativeDrop_removeUploadIndicator();if(Ma.targetMorph===this){Sg.next=3;break}return Sg.abrupt("return");case 3:gc=Ma.domEvt;ac=gc.dataTransfer.files;Kc=document.location.origin;if(!ac.length){Sg.next=94;break}md=this.getCurrentUser();ud=md.isGuestUser?"uploads/":"users/"+$world.getCurrentUser().name+"/uploads";if(!Ma.isAltDown()){Sg.next=15;break}Sg.next=12;return this.prompt("Choose upload location",
{history:"lively.morphic-html-drop-file-upload-location",input:ud});case 12:if(ud=Sg.sent){Sg.next=15;break}return Sg.abrupt("return",this.setStatusMessage("Canceled upload"));case 15:return Sg.next=17,this.confirm("Upload ".concat(ac.length," file").concat(1<ac.length?"s":"","?"));case 17:if(oe=Sg.sent){Sg.next=20;break}return Sg.abrupt("return");case 20:ze=new FormData;for(Ue=0;Ue<ac.length;Ue++)ze.append("file",ac[Ue],ac[Ue].name);lf=ye.LoadingIndicator.open("Uploading File");Sg.prev=23;Rf={};
Hg=function(Lj){Lj=Lj.loaded/Lj.total;lf.progress=Lj;lf.status="Uploaded "+(100*Lj).toFixed()+"%"};md.isGuestUser||(Rf.Authorization="Bearer ".concat(md.token));Me=ye.resource(System.baseURL,{headers:Rf,onProgress:Hg,onLoad:function(Lj){return xf=Lj}});Me=Me.join("/upload?uploadPath=".concat(encodeURIComponent(ud)));Sg.next=31;return Me.write(ze);case 31:Sg.next=36;break;case 33:return Sg.prev=33,Sg.t0=Sg["catch"](23),Sg.abrupt("return",this.showError("Upload failed: ".concat(Sg.t0.message,"\n")));
case 36:lf.remove();Sg.prev=37;this.setStatusMessage("Uploaded ".concat(xf.uploadedFiles.length," file"));ng=xf.uploadedFiles.map(function(Lj){var gl=ye.resource(Kc).join(Lj.path);return Object.assign({},Lj,{url:gl.url,name:gl.name()})});fg=[];gg=[];Wh=[];wg=M(ng);try{for(wg.s();!(xh=wg.n()).done;)Qi=xh.value,Qi.type.startsWith("image/")?fg.push(Qi):Qi.type.startsWith("video")?gg.push(Qi):Wh.push(Qi)}catch(Lj){wg.e(Lj)}finally{wg.f()}if(!gg.length){Sg.next=67;break}Di=M(gg);Sg.prev=47;Di.s();case 49:if((Zi=
Di.n()).done){Sg.next=59;break}ni=Zi.value;Sg.t1=Object;Sg.next=54;return ye.loadObjectFromPartsbinFolder("video morph");case 54:Sg.t2=Sg.sent,Sg.t3={videoURL:ni.url,name:ni.name},Sg.t1.assign.call(Sg.t1,Sg.t2,Sg.t3).openInWorld();case 57:Sg.next=49;break;case 59:Sg.next=64;break;case 61:Sg.prev=61,Sg.t4=Sg["catch"](47),Di.e(Sg.t4);case 64:return Sg.prev=64,Di.f(),Sg.finish(64);case 67:fg.length&&fg.forEach(function(Lj){var gl=new ye.Image({imageUrl:Lj.url,autoResize:!0,name:Lj.name});gl.whenLoaded().then(Rc(regeneratorRuntime.mark(function Dn(){return regeneratorRuntime.wrap(function(xm){for(;;)switch(xm.prev=
xm.next){case 0:return gl.extent=gl.naturalExtent.scaleBy(.8*Jb.visibleBounds().height/gl.height),gl.openInWorld(),xm.next=4,gl.whenRendered();case 4:gl.center=Jb.visibleBounds().center();case 5:case "end":return xm.stop()}},Dn)})))});if(!Wh.length){Sg.next=88;break}Xd=M(Wh);Sg.prev=70;Xd.s();case 72:if((ff=Xd.n()).done){Sg.next=80;break}af=ff.value;Sg.next=76;return this.confirm("open file ".concat(af.name," (").concat(af.type,")?"));case 76:(Gf=Sg.sent)&&this.execCommand("open file",{url:af.url});
case 78:Sg.next=72;break;case 80:Sg.next=85;break;case 82:Sg.prev=82,Sg.t5=Sg["catch"](70),Xd.e(Sg.t5);case 85:return Sg.prev=85,Xd.f(),Sg.finish(85);case 88:Sg.next=93;break;case 90:Sg.prev=90,Sg.t6=Sg["catch"](37),this.showError(Sg.t6);case 93:return Sg.abrupt("return");case 94:Jh=gc.dataTransfer.types;if(!Jh.includes("text/html")){Sg.next=112;break}ci=gc.dataTransfer.getData("text/html");di=(new DOMParser).parseFromString(ci,"text/html");vj=di.querySelectorAll("img");if(1!==vj.length||!vj[0].src||
!Jh.includes("text/uri-list")){Sg.next=105;break}pj=vj[0].src;kj=new ye.Image({imageUrl:pj,autoResize:!0,name:ye.arr.last(pj.split("/"))});kj.whenLoaded().then(function(){return kj.openInWorld()});Sg.next=111;break;case 105:return Sg.t7=Object,Sg.next=108,ye.loadObjectFromPartsbinFolder("html-morph");case 108:Sg.t8=Sg.sent,Sg.t9={html:ci},Sg.t7.assign.call(Sg.t7,Sg.t8,Sg.t9).openInWorld();case 111:return Sg.abrupt("return");case 112:Ih=0;case 113:if(!(Ih<gc.dataTransfer.items.length)){Sg.next=132;
break}mk=gc.dataTransfer.items[Ih];if("file"!==mk.kind){Sg.next=128;break}fl=mk.getAsFile();Sg.next=119;return this.confirm("Upload ".concat(fl.name,"?"));case 119:Al=Sg.sent;if(!Al){Sg.next=126;break}Sg.next=123;return ye.uploadFile(fl,fl.type);case 123:(rg=Sg.sent)&&rg.openInWorld(),rg.center=this.visibleBounds().center();case 126:Sg.next=129;break;case 128:"string"===mk.kind&&mk.getAsString(function(Lj){return ye.inspect(Lj)});case 129:Ih++;Sg.next=113;break;case 132:case "end":return Sg.stop()}},
jb,this,[[23,33],[37,90],[47,61,64,67],[70,82,85,88]])}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"menuItems",value:function(){var aa=this;return[{title:"World menu"},{command:"undo",target:this},{command:"redo",target:this},{isDivider:!0},["Debugging",[{command:"delete change history",target:this},{command:"fix font metric",target:this},{command:"inspect server",target:this}]],["Tools",[{command:"open javascript workspace",target:this},{command:"open browser",target:this},{command:"choose and browse module",
target:this},{command:"open code search",target:this},{command:"open file browser",target:this},{command:"open shell workspace",target:this,tooltip:"Opens a workspace like interface\nthat allows you to trigger shell comands\nvia select + eval by pressing either ".concat((new ye.Text).keysForCommand("doit")," or ").concat((new ye.Text).keysForCommand("printit"))},{command:"open shell terminal",target:this,tooltip:"Opens a classic remote shell interface,\nthat allows you to send commands to a\nbash session running on the server.\nAlso comes with advanced git support."},
{command:"open workspace",args:{askForMode:!0},target:this}]],{isDivider:!0},{command:"run command",target:this},{command:"select morph",target:this},{command:"window switcher",target:this},["Exported Components",[["Toggle Select All",function(){0===aa.getListedComponents().length?aa.hiddenComponents=[]:aa.hiddenComponents=aa.withAllSubmorphsSelect(function(Sa){return Sa.isComponent}).map(function(Sa){return Sa.name})}]].concat(Xa(this.withAllSubmorphsSelect(function(Sa){return Sa.isComponent}).map(function(Sa){var Ma=
aa.hiddenComponents.includes(Sa.name);return[[].concat(Xa(ye.Icon.textAttribute(Ma?"square":"check-square")),["  "+Sa.name,{}]),function(){aa.hiddenComponents=Ma?ye.arr.without(aa.hiddenComponents,Sa.name):[Sa.name].concat(Xa(aa.hiddenComponents))}]})))],["Resize","static"===this.resizePolicy?[{command:"resize to fit window",target:this},{command:"resize manually",target:this},["switch to automatic resizing of world",function(){return aa.resizePolicy="elastic"}]]:[["switch to manual resizing of world",
function(){return aa.resizePolicy="static"}]]],["Troubleshooting",[{command:"report a bug",target:this},{command:"clear storage and reload",target:this}]],{isDivider:!0},["Windows",[{command:"toggle minimize all windows",target:this},{command:"close all windows",target:this}]],{isDivider:!0},{command:"save world",target:this},{command:"load world",target:this}]}},{key:"openWorldMenu",value:function(aa,Sa){var Ma=this.env.eventDispatcher.eventState;Ma.menu&&Ma.menu.remove();return Ma.menu=Sa&&Sa.length?
ye.Menu.openAtHand(Sa,{hand:aa&&aa.hand||this.firstHand}):null}},{key:"onPaste",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc,ac,Kc,md,ud,oe,ze,Ue,Me,xf;return regeneratorRuntime.wrap(function(lf){for(;;)switch(lf.prev=lf.next){case 0:lf.prev=0;gc=Ma.domEvt.clipboardData;if(!gc.types.includes("application/morphic")){lf.next=31;break}Ma.stop();ac=JSON.parse(gc.getData("application/morphic"));Kc=[];Array.isArray(ac)||(ac=[ac]);Jb=ye.LoadingIndicator.open("pasting morphs...");
md=M(ac);lf.prev=9;md.s();case 11:if((ud=md.n()).done){lf.next=21;break}oe=ud.value;lf.next=15;return ye.loadMorphFromSnapshot(oe,{moduleManager:ye.moduleManager});case 15:ze=lf.sent,ze.openInWorld(Ma.hand.position),oe.copyMeta&&oe.copyMeta.offset&&(Ue=oe.copyMeta.offset,Me=Ue.x,xf=Ue.y,ze.moveBy(ye.pt(Me,xf))),Kc.push(ze);case 19:lf.next=11;break;case 21:lf.next=26;break;case 23:lf.prev=23,lf.t0=lf["catch"](9),md.e(lf.t0);case 26:return lf.prev=26,md.f(),lf.finish(26);case 29:this.halos().forEach(function(Rf){return Rf.remove()}),
this.showHaloFor(Kc);case 31:lf.next=36;break;case 33:lf.prev=33,lf.t1=lf["catch"](0),this.showError(lf.t1);case 36:return lf.prev=36,Jb&&Jb.remove(),lf.finish(36);case 39:case "end":return lf.stop()}},jb,this,[[0,33,36,39],[9,23,26,29]])}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"addCommentFor",value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){var gc,ac,Kc,md=arguments;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=ud.next){case 0:return gc=
2<md.length&&void 0!==md[2]?md[2]:ye.pt(0,0),ac=new ye.CommentData(jb,gc),this.morphCommentMap.has(Ma)?this.morphCommentMap.set(Ma,this.morphCommentMap.get(Ma).concat([ac])):this.morphCommentMap.set(Ma,[ac]),(Kc=$world.getSubmorphNamed("Comment Browser"))&&Kc.viewModel.addCommentForMorph(ac,Ma),ud.abrupt("return",ac);case 6:case "end":return ud.stop()}},Jb,this)}));return function(Ma,jb){return aa.apply(this,arguments)}}()},{key:"removeCommentFor",value:function(aa,Sa){var Ma=$world.getSubmorphNamed("Comment Browser");
Ma&&Ma.viewModel.removeCommentForMorph(Sa,aa);this.morphCommentMap.set(aa,ye.arr.without(this.morphCommentMap.get(aa),Sa))}},{key:"emptyCommentsFor",value:function(aa){var Sa=$world.getSubmorphNamed("Comment Browser");this.morphCommentMap.has(aa)&&(Sa&&this.morphCommentMap.get(aa).forEach(function(Ma){return Sa.viewModel.removeCommentForMorph(Ma,aa)}),this.morphCommentMap.set(aa,[]))}},{key:"commands",get:function(){return ye.worldCommands.concat(db._get(Object.getPrototypeOf(hd.prototype),"commands",
this)).concat([{name:"open in prototype box",exec:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){var gc;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return ac.next=2,ye.loadPart("prototype box");case 2:gc=ac.sent,gc.wrapProto(jb.target);case 4:case "end":return ac.stop()}},Jb)}));return function(Ma,jb){return aa.apply(this,arguments)}}()}])}},{key:"keybindings",get:function(){return db._get(Object.getPrototypeOf(hd.prototype),"keybindings",this).concat(ye.config.globalKeyBindings)}},
{key:"keybindings",set:function(aa){db._set(Object.getPrototypeOf(hd.prototype),"keybindings",aa,this)}},{key:"halos",value:function(){return this.submorphs.filter(function(aa){return aa.isHalo})}},{key:"haloForPointerId",value:function(aa){return this.submorphs.find(function(Sa){return Sa.isHalo&&Sa.state&&Sa.state.pointerId===aa})}},{key:"showHaloFor",value:function(aa){var Sa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.firstHand&&this.firstHand.pointerId,Ma=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:!0;if(ye.Halo)return Sa="function"===typeof aa.createHalo?aa.createHalo(ye.Halo,Sa):new ye.Halo({pointerId:Sa,target:aa}),this.addMorph(Sa),Ma&&Sa.focus(),Sa.alignWithTarget(),Sa}},{key:"showHaloForSelection",value:function(aa,Sa){return 0<aa.length&&this.showHaloFor(aa,Sa)}},{key:"layoutHaloForPointerId",value:function(){var aa=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.firstHand&&this.firstHand.pointerId;return this.submorphs.find(function(Sa){return Sa.isLayoutHalo&&
Sa.state&&Sa.state.pointerId===aa})}},{key:"showLayoutHaloFor",value:function(aa){var Sa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.firstHand&&this.firstHand.pointerId,Ma=aa===this?null:aa.owner===this?aa:aa.ownerChain().slice(-2)[0];Ma=Ma?this.submorphs.indexOf(Ma)+1:this.submorphs.length;switch(aa.layout.constructor){case ye.ProportionalLayout:var jb=new ye.ProportionalLayoutHalo({container:aa,pointerId:Sa});break;case ye.HorizontalLayout:case ye.VerticalLayout:jb=new ye.FlexLayoutHalo({container:aa,
pointerId:Sa});break;case ye.GridLayout:jb=new ye.GridLayoutHalo({container:this.container,pointerId:Sa})}return jb&&this.addMorphAt(jb,Ma)}},{key:"highlightMorph",value:function(aa,Sa){return ye.MorphHighlighter["for"](aa,Sa,2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,3<arguments.length&&void 0!==arguments[3]?arguments[3]:[])}},{key:"removeHighlighters",value:function(){return ye.MorphHighlighter.removeHighlighters(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this)}},{key:"visibleStatusMessages",
value:function(){return this.submorphs.filter(function(aa){return aa.isStatusMessage})}},{key:"visibleStatusMessagesFor",value:function(aa){return this.submorphs.filter(function(Sa){return Sa.isStatusMessage&&Sa.targetMorph===aa})}},{key:"logErrorPreperation",value:function(aa){var Sa=String(aa),Ma=aa.stack||"";Ma&&aa.message!==aa.stack&&(Ma=String(Ma),0===Ma.indexOf(Sa)&&(Ma=Ma.slice(Sa.length)),Sa+="\n"+Ma);return Sa}},{key:"logError",value:function(aa){this.setStatusMessage(this.logErrorPreperation(aa),
ye.StatusMessageError)}},{key:"showError",value:function(aa){return this.logError(aa)}},{key:"showErrorFor",value:function(aa,Sa){return this.setStatusMessageFor(aa,this.logErrorPreperation(Sa),ye.StatusMessageError)}},{key:"setStatusMessageFor",value:function(aa,Sa,Ma){var jb=3<arguments.length&&void 0!==arguments[3]?arguments[3]:5E3,Jb=4<arguments.length?arguments[4]:void 0;Ma||(Ma=ye.StatusMessageDefault);this.visibleStatusMessagesFor(aa).forEach(function(gc){return gc.remove()});Jb=ye.part(Ma,
{epiMorph:!0,viewModel:Object.assign({slidable:!1,message:Sa},Jb)});this.openStatusMessage(Jb,jb);Jb.alignAtBottomOf(aa);Jb.targetMorph=aa;Jb.fadeIn(300);if(Jb.removeOnTargetMorphChange&&aa.isText)ye.once(aa,"selectionChange",Jb,"fadeOut",{converter:function(){return 200},garbageCollect:!0});return Jb}},{key:"setStatusMessage",value:function(aa,Sa){var Ma=2<arguments.length&&void 0!==arguments[2]?arguments[2]:5E3,jb=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};Sa||(Sa=ye.StatusMessageDefault);
console[Sa===ye.StatusMessageError?"error":"log"](aa);return ye.config.verboseLogging?this.openStatusMessage(ye.part(Sa,Object.assign({epiMorph:!0,viewModel:{message:aa},hasFixedPosition:!0,width:300},jb)),Ma):null}},{key:"openStatusMessage",value:function(aa,Sa){this.addMorph(aa);if(aa.slidable){var Ma=this.visibleStatusMessages(),jb=M(Ma),Jb;try{for(jb.s();!(Jb=jb.n()).done;){var gc=Jb.value;if(Ma.length<=(ye.config.maxStatusMessages||0))break;!gc.stayOpen&&gc.slidable&&(gc.remove(),ye.arr.remove(Ma,
gc))}}catch(ac){jb.e(ac)}finally{jb.f()}ye.arr.without(Ma,aa).forEach(function(){var ac=Rc(regeneratorRuntime.mark(function ud(md){return regeneratorRuntime.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:!md.isMaximized&&md.slidable&&md.slideTo(md.position.subPt(ye.pt(0,aa.height+10)));case 1:case "end":return oe.stop()}},ud)}));return function(md){return ac.apply(this,arguments)}}());Ma=this.visibleBounds().bottomRight().addXY(-20,-20);aa.align(aa.bounds().bottomRight(),Ma);aa.topRight=
Ma.addPt(ye.pt(0,40));aa.animate({bottomRight:Ma,duration:500})}"number"===typeof Sa&&setTimeout(function(){return aa.stayOpen||aa.fadeOut()},Sa);return aa}},{key:"addProgressBar",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb,Jb,gc,ac,Kc=arguments;return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=md.next){case 0:return jb=0<Kc.length&&void 0!==Kc[0]?Kc[0]:{},Jb=jb.location,gc=void 0===Jb?"center":Jb,md.next=4,ye.loadObjectFromPartsbinFolder("progress bar");
case 4:return ac=md.sent,Object.assign(ac,{progress:0},ye.obj.dissoc(jb,["location"])),this.addMorph(ac),ac.align(ac[gc],this.visibleBounds()[gc]()),md.abrupt("return",ac);case 9:case "end":return md.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"withProgressBarDo",value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){var gc;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return ac.next=2,this.addProgressBar(jb);
case 2:return gc=ac.sent,ac.prev=3,ac.next=6,Ma(gc);case 6:return ac.abrupt("return",ac.sent);case 7:return ac.prev=7,gc.remove(),ac.finish(7);case 10:case "end":return ac.stop()}},Jb,this,[[3,,7,10]])}));return function(Ma,jb){return aa.apply(this,arguments)}}()},{key:"openPrompt",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb=this,gc,ac,Kc,md=arguments;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=ud.next){case 0:return gc=1<md.length&&void 0!==md[1]?
md[1]:{requester:null,animated:!1},ac=this.focusedMorph,Kc=this.visibleBounds(),ud.abrupt("return",this.withRequesterDo(gc.requester,function(){var oe=Rc(regeneratorRuntime.mark(function Me(Ue){return regeneratorRuntime.wrap(function(xf){for(;;)switch(xf.prev=xf.next){case 0:return Ma.openInWorld(),Ma.center=Ue,Ma.height>Kc.height&&(Ma.height=Kc.height-5),"function"===typeof gc.customize&&gc.customize(Ma),gc.animated&&Jb.previousPrompt&&Jb.previousPrompt.world()&&Jb.previousPrompt.transitionTo&&Jb.previousPrompt.transitionTo(Ma),
Jb.previousPrompt=Ma,xf.abrupt("return",ye.promise["finally"](Ma.activate(gc),function(){return ac&&ac.focus()}));case 7:case "end":return xf.stop()}},Me)}));return function(Ue){return oe.apply(this,arguments)}}()));case 4:case "end":return ud.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"withRequesterDo",value:function(){var aa=Rc(regeneratorRuntime.mark(function Jb(Ma,jb){var gc,ac,Kc;return regeneratorRuntime.wrap(function(md){for(;;)switch(md.prev=md.next){case 0:ac=
this.visibleBounds().center();if(!Ma){md.next=8;break}ac=Ma.globalBounds().center();Ma.isWorld&&(ac=Ma.visibleBounds().center());if(!(gc=Ma.getWindow())){md.next=8;break}md.next=7;return gc.toggleFader(!0);case 7:ac=gc.globalBounds().center();case 8:return md.next=10,jb(ac);case 10:return Kc=md.sent,gc&&gc.toggleFader(!1),md.abrupt("return",Kc);case 13:case "end":return md.stop()}},Jb,this)}));return function(Ma,jb){return aa.apply(this,arguments)}}()},{key:"inform",value:function(){var aa=1<arguments.length&&
void 0!==arguments[1]?arguments[1]:{fontSize:16,requester:null,animated:!0};return this.openPrompt(ye.part(ye.prompts.InformPrompt,{viewModel:Object.assign({label:0<arguments.length&&void 0!==arguments[0]?arguments[0]:"no message"},aa)}),aa)}},{key:"prompt",value:function(aa){var Sa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{requester:null,input:"",historyId:null,useLastInput:!1,selectInput:!1};return this.openPrompt(ye.part(ye.prompts.TextPrompt,{viewModel:Object.assign({label:aa},Sa)}),
Sa)}},{key:"editPrompt",value:function(aa){var Sa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{requester:null,input:"",historyId:null,useLastInput:!1,textStyle:null,mode:null,evalEnvironment:null};return this.openPrompt(ye.part(ye.prompts.EditPrompt,{viewModel:Object.assign({label:aa},Sa)}),Sa)}},{key:"passwordPrompt",value:function(aa){var Sa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{requester:null,input:""};return this.openPrompt(ye.part(ye.prompts.PasswordPrompt,{viewModel:Object.assign({label:aa},
Sa)}),Sa)}},{key:"confirm",value:function(aa){var Sa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{requester:null,animated:!0};return this.openPrompt(ye.part(ye.prompts.ConfirmPrompt,{viewModel:Object.assign({label:aa},Sa)}),Sa)}},{key:"multipleChoicePrompt",value:function(aa){var Sa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{requester:null,animated:!0,choices:[]};return this.openPrompt(ye.part(ye.prompts.MultipleChoicePrompt,{viewModel:Object.assign({label:aa},Sa)}),Sa)}},
{key:"listPrompt",value:function(){var aa=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",Sa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],Ma=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{requester:null,onSelection:null,preselect:0};return this.openPrompt(ye.part(ye.prompts.ListPrompt,{viewModel:Object.assign({filterable:!1,padding:ye.Rectangle.inset(3),label:aa,items:Sa},Ma)}),Ma)}},{key:"filterableListPrompt",value:function(){var aa=0<arguments.length&&void 0!==arguments[0]?
arguments[0]:"",Sa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],Ma=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{requester:null,onSelection:null,preselect:0,multiSelect:!1,historyId:null,fuzzy:!1,actions:["default"],selectedAction:"default",theme:"dark"};if(Ma.prompt)return Ma.prompt.items=Sa,Ma.prompt.ui.list.selectedIndex=Ma.preselect||0,this.openPrompt(Ma.prompt.view,Ma);aa=ye.part(ye.prompts.ListPrompt,{viewModel:Object.assign({filterable:!0,padding:ye.Rectangle.inset(3),
label:aa,items:Sa},Ma)});return this.openPrompt(aa,Ma)}},{key:"editListPrompt",value:function(){var aa=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{requester:null,multiSelect:!0,historyId:null};return this.openPrompt(ye.part(ye.prompts.EditListPrompt,{viewModel:Object.assign({label:0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",multiSelect:!0,items:1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],padding:ye.Rectangle.inset(3)},aa)}),aa)}},{key:"showLoadingIndicatorFor",
value:function(aa,Sa){return this.addMorph(ye.LoadingIndicator.open(Sa,{center:aa.globalBounds().center()}))}},{key:"defaultMenuItems",value:function(aa,Sa){function Ma(ze){var Ue=this,Me=Jb.morphsContainingPoint(ac.worldPoint(ye.pt(0,0)));Me.pop();var xf=Me.indexOf(ac);Me=Me.slice(xf+1);return Me.map(function(lf){return[String(lf),ze.bind(Ue,lf)]})}var jb=this,Jb=this,gc=[],ac=aa;this.reset&&"function"===typeof this.reset&&gc.push(["Reset",function(){jb.reset()}]);gc.push(["Open in...",[["Window",
function(){ac.openInWindow()}]]]);gc.push(["Add morph to...",{getItems:Ma.bind(ac,function(ze){return ze.addMorph(ac)})}]);gc.push(["Get halo on...",{getItems:Ma.bind(ac,function(ze){return ze.world().showHaloFor(ze)})}]);ac.owner&&1<ac.owner.submorphs.length&&gc.push(["Arrange morph",[["Bring to front",function(){return ac.owner.addMorph(ac)}],["Send to back",function(){return ac.owner.addMorphBack(ac)}],["Fit to submorphs",Rc(regeneratorRuntime.mark(function Ue(){var Me,xf,lf;return regeneratorRuntime.wrap(function(Rf){for(;;)switch(Rf.prev=
Rf.next){case 0:return Rf.next=2,ac.world().prompt("Padding around submorphs:",{input:"Rectangle.inset(5)",historyId:"lively.morphic-fit-to-submorphs-padding-hist",requester:ac});case 2:Me=Rf.sent;if("string"===typeof Me){Rf.next=5;break}return Rf.abrupt("return");case 5:return Rf.next=7,ye.runEval(Me,{topLevelVarRecorder:{Rectangle:ye.Rectangle}});case 7:xf=Rf.sent,Me=(lf=xf.value)&&lf.isRectangle?lf:ye.Rectangle.inset(0),ac.undoStart("fitToSubmorphs"),ac.fitToSubmorphs(Me),ac.undoStop("fitToSubmorphs");
case 13:case "end":return Rf.stop()}},Ue)}))]].concat(Xa(ye.PropertyPath("master.auto").get(ac)?[["Adjust to Master Component Submorph Hierarchy",function(){return ac.master.reconcileSubmorphs()}]]:[]))]);this.submorphs.length&&gc.push(["Select all submorphs",function(){return ac.world().showHaloFor(ac.submorphs.slice())}]);var Kc=[];ac.startSteppingScripts?Kc.push(["Start stepping",function(){ac.startSteppingScripts()}]):Kc.push(["Start stepping",Rc(regeneratorRuntime.mark(function Me(){var xf,lf,
Rf,Hg,ng,fg,gg,Wh,wg,xh,Qi,Di,Zi,ni,Xd,ff,af,Gf,Jh,ci,di,vj,pj,kj;return regeneratorRuntime.wrap(function(Ih){for(;;)switch(Ih.prev=Ih.next){case 0:return xf=[],Ih.t0=M,Ih.next=4,ye.completions.getCompletions(function(){return ac},"");case 4:Ih.t1=Ih.sent.completions,lf=(0,Ih.t0)(Ih.t1),Ih.prev=6,lf.s();case 8:if((Rf=lf.n()).done){Ih.next=34;break}Hg=Rf.value;ng=Fa(Hg,2);fg=ng[0];gg=ng[1];Wh=M(gg);Ih.prev=12;Wh.s();case 14:if((wg=Wh.n()).done){Ih.next=24;break}xh=wg.value;if(!xh.startsWith("_")&&
!xh.startsWith("$")){Ih.next=18;break}return Ih.abrupt("continue",22);case 18:Qi=xh.match(/^([^\(]+)\(?([^\)]+)?\)?$/)||[];Di=Fa(Qi,3);Zi=Di[1];ni=Di[2];if(Zi&&"function"===typeof ac[Zi]){Ih.next=21;break}return Ih.abrupt("continue",22);case 21:xf.push({isListItem:!0,string:"".concat(fg," ").concat(xh),value:{selector:Zi,args:ni}});case 22:Ih.next=14;break;case 24:Ih.next=29;break;case 26:Ih.prev=26,Ih.t2=Ih["catch"](12),Wh.e(Ih.t2);case 29:return Ih.prev=29,Wh.f(),Ih.finish(29);case 32:Ih.next=8;
break;case 34:Ih.next=39;break;case 36:Ih.prev=36,Ih.t3=Ih["catch"](6),lf.e(Ih.t3);case 39:return Ih.prev=39,lf.f(),Ih.finish(39);case 42:return Ih.next=44,$world.filterableListPrompt("Select method to start",xf,{requester:ac,historyId:"lively.morphic-start-stepping-chooser"});case 44:Xd=Ih.sent;ff=Fa(Xd.selected,1);if(af=ff[0]){Ih.next=49;break}return Ih.abrupt("return");case 49:return Ih.next=51,$world.prompt("Steptime in ms (how of the method will be called)?",{input:100});case 51:Gf=Ih.sent;Gf=
Number(Gf);if(!isNaN(Gf)){Ih.next=55;break}return Ih.abrupt("return");case 55:Jh=[Gf,af.selector];if(!af.args){Ih.next=70;break}ci={targetModule:"lively://lively.morphic-stepping-args/eval.js"};Ih.next=60;return $world.editPrompt("Arguments to pass",{input:"[".concat(af.args,"]"),mode:"js",evalEnvironment:ci});case 60:return di=Ih.sent,Ih.next=63,ye.runEval(di,ci);case 63:vj=Ih.sent;pj=vj.value;kj=vj.isError;if(!kj){Ih.next=69;break}$world.inform("Error evaluating the arguments: ".concat(pj));return Ih.abrupt("return");
case 69:Array.isArray(pj)&&Jh.push.apply(Jh,Xa(pj));case 70:ac.startStepping.apply(ac,Jh);case 71:case "end":return Ih.stop()}},Me,null,[[6,36,39,42],[12,26,29,32]])}))]);0!==ac.tickingScripts.length&&Kc.push(["Stop stepping",function(){return ac.stopStepping()}]);0!==Kc.length&&gc.push(["Stepping",Kc]);gc.push(["Change Tooltip",Rc(regeneratorRuntime.mark(function xf(){return regeneratorRuntime.wrap(function(lf){for(;;)switch(lf.prev=lf.next){case 0:return lf.next=2,ac.world().prompt("Enter Tooltip",
{placeholder:"Description",input:ac.tooltip||""});case 2:ac.tooltip=lf.sent;case 3:case "end":return lf.stop()}},xf)}))]);var md=["Morphic properties",[]];gc.push(md);gc.push(["display serialization info",Rc(regeneratorRuntime.mark(function lf(){var Rf,Hg,ng;return regeneratorRuntime.wrap(function(fg){for(;;)switch(fg.prev=fg.next){case 0:return fg.next=2,Dd.import("./debugging-4e46028e.js");case 2:Rf=fg.sent,Hg=Rf.SnapshotInspector,ng=ye.serialize(ac),Hg.forSnapshot(ng).openSummary();case 6:case "end":return fg.stop()}},
lf)}))]);gc.push(["display object report",Rc(regeneratorRuntime.mark(function Rf(){var Hg,ng,fg;return regeneratorRuntime.wrap(function(gg){for(;;)switch(gg.prev=gg.next){case 0:return gg.next=2,Dd.import("./debugging-4e46028e.js");case 2:Hg=gg.sent,ng=Hg.SnapshotInspector,fg=ye.serialize(ac),ng.forSnapshot(fg).openObjectReport();case 6:case "end":return gg.stop()}},Rf)}))]);var ud=ye.Icon.textAttribute("check-square"),oe=ye.Icon.textAttribute("square");Object.assign(ud[1],{"float":"none",display:"inline"});
["grabbable","draggable","acceptsDrops","halosEnabled"].forEach(function(Rf){return md[1].push([[].concat(Xa(aa[Rf]?ud:oe),[" "+Rf,{"float":"none"}]),function(){return aa[Rf]=!aa[Rf]}])});gc.push(["export to HTML",Rc(regeneratorRuntime.mark(function Hg(){var ng,fg;return regeneratorRuntime.wrap(function(gg){for(;;)switch(gg.prev=gg.next){case 0:return gg.next=2,Dd.import("./html-generator-dc10ef18.js");case 2:return ng=gg.sent,fg=ng.generateHTML,gg.t0=ye.HTMLMorph,gg.t1="exported-"+aa.name,gg.next=
8,fg(aa,null,{isFragment:!0,addStyles:!1});case 8:gg.t2=gg.sent,gg.t3={name:gg.t1,html:gg.t2},(new gg.t0(gg.t3)).openInWorld();case 11:case "end":return gg.stop()}},Hg)}))]);gc.push(["Remove Morph",function(){return ac.abandon(!0)}]);gc.push(["Open Inspector",function(){return ac.inspect()}]);gc.push({isDivider:!0});gc.push(["Add comment",Rc(regeneratorRuntime.mark(function ng(){var fg,gg,Wh,wg;return regeneratorRuntime.wrap(function(xh){for(;;)switch(xh.prev=xh.next){case 0:return xh.next=2,$world.prompt("Enter comment");
case 2:fg=xh.sent;if(!fg){xh.next=11;break}gg=ye.pt(0,0);Sa&&!Sa.halo&&(Wh=ac.localize(Sa.position).x/ac.width,wg=ac.localize(Sa.position).y/ac.height,gg=ye.pt(Wh,wg));xh.next=8;return $world.addCommentFor(ac,fg,gg);case 8:$world.setStatusMessage("Comment saved",ye.StatusMessageConfirm);xh.next=12;break;case 11:$world.setStatusMessage("Comment not saved",ye.StatusMessageError);case 12:case "end":return xh.stop()}},ng)}))]);return gc}},{key:"defaultConnectionMenuItems",value:function(aa){return aa.attributeConnections&&
aa.attributeConnections.length?aa.attributeConnections.map(function(Sa){return[String(Sa),[["show",Rc(regeneratorRuntime.mark(function jb(){var Jb,gc;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:return ac.next=2,Dd.import("./fabrik-a56580be.js");case 2:Jb=ac.sent,gc=Jb.interactivelyShowConnection,gc(Sa);case 5:case "end":return ac.stop()}},jb)}))],["edit",Rc(regeneratorRuntime.mark(function Jb(){var gc,ac;return regeneratorRuntime.wrap(function(Kc){for(;;)switch(Kc.prev=
Kc.next){case 0:return Kc.next=2,Dd.import("./fabrik-a56580be.js");case 2:gc=Kc.sent,ac=gc.interactivelyReEvaluateConnection,ac(Sa);case 5:case "end":return Kc.stop()}},Jb)}))],["disconnect",function(){Sa.disconnect();$world.setStatusMessage("disconnected "+Sa)}]]]}):null}},{key:"defaultSourceDataBindings",value:function(aa){var Sa=aa.propertiesAndPropertySettings().properties,Ma=ye.arr.groupByKey(Object.keys(Sa).map(function(Jb){Jb=Object.assign({name:Jb},Sa[Jb]);return Jb.group&&Jb.group.startsWith("_")?
null:Jb}).filter(Boolean),"group");aa=["core","geometry","interaction","styling","layouting"];var jb=[];aa.forEach(function(Jb){return jb.push(Ma[Jb])});ye.arr.withoutAll(Ma.keys(),aa).forEach(function(Jb){return jb.push(Ma[Jb])});return jb}},{key:"targetDataBindings",value:function(aa){for(var Sa=[],Ma=aa;Ma!==Object.prototype;){var jb=Ma===aa?String(this):ye.getClassName(Ma),Jb=null,gc=ye.obj.getOwnPropertyDescriptors(Ma),ac=Object.getPrototypeOf(Ma),Kc;for(Kc in gc){var md=gc[Kc].value;"function"!==
typeof md||md===Ma.constructor||Kc.startsWith("$")||Kc.startsWith("_")||(Jb||(Jb=[]),md=ye.fun.argumentNames(md),Jb.push({group:jb+" methods",signature:"".concat(Kc,"(").concat(md.join(", "),")"),name:Kc}))}Jb&&Sa.push(Jb);Ma=ac}return this.defaultSourceDataBindings(aa).concat(Sa)}},{key:"defaultConnectMenuItems",value:function(aa,Sa){var Ma=this,jb=this.defaultSourceDataBindings(Sa),Jb=Sa.world();jb=jb.map(function(gc){return[gc[0].group||"uncategorized",gc.map(function(ac){return[ac.name,aa?function(){return aa(ac.name,
Sa,ac)}:Rc(regeneratorRuntime.mark(function md(){var ud,oe;return regeneratorRuntime.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.next=2,Dd.import("./fabrik-a56580be.js");case 2:ud=ze.sent,oe=ud.interactiveConnectGivenSource,oe(Sa,ac.name);case 5:case "end":return ze.stop()}},md)}))]})]});Jb&&jb.push(["custom...",aa?function(){return aa("custom...",Sa,null)}:Rc(regeneratorRuntime.mark(function ac(){var Kc,md,ud;return regeneratorRuntime.wrap(function(oe){for(;;)switch(oe.prev=
oe.next){case 0:return oe.next=2,Dd.import("./fabrik-a56580be.js");case 2:return Kc=oe.sent,md=Kc.interactiveConnectGivenSource,oe.next=6,Jb.prompt("Enter custom connection point",{requester:Sa,historyId:"lively.morphic-custom-connection-points",useLastInput:!0});case 6:(ud=oe.sent)&&md(Ma,ud);case 8:case "end":return oe.stop()}},ac)}))]);return jb}},{key:"updateVisibleWindowMorphs",value:function(){var aa=this;db._get(Object.getPrototypeOf(hd.prototype),"updateVisibleWindowMorphs",this).call(this);
this.halos().forEach(function(Sa){Sa.maskBounds=aa.visibleBounds()})}},{key:"handleHaloCycle",value:function(aa){var Sa=aa.state.clickedOnMorph,Ma=aa.isCommandKey(),jb=aa.isShiftDown(),Jb;Ma&&!Sa.isHalo&&(Ma=Jb=aa.world.morphsContainingPoint(aa.position),Jb=Jb.filter(function(gc){return gc.halosEnabled}),Ma=Ma.filter(function(gc){return gc.halosEnabled}),Jb=Ma[0]||Jb[0]);jb&&!Sa.isHaloItem&&Jb&&aa.halo&&aa.halo.borderBox!==Jb?aa.halo.addMorphToSelection(Jb):(Sa=aa.halo&&!aa.targetMorphs.find(function(gc){return gc.isHaloItem||
gc.keepHalo&&gc.keepHalo(aa)}),jb=aa.layoutHalo&&!aa.targetMorphs.find(function(gc){return gc.isHaloItem}),Ma=(!aa.halo||Sa)&&Jb,jb&&aa.layoutHalo.remove(),Sa&&(aa.halo.remove(),this.withTopBarDo(function(gc){gc.stylingPalette&&gc.stylingPalette.clearFocus();gc.sideBar&&gc.sideBar.clearFocus()})),Ma&&(aa.stop(),this.showHaloFor(Jb,aa.domEvt.pointerId)))}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"LivelyWorld"}},{key:"properties",get:function(){return{localComponents:{initialize:function(){var aa=
this;this.whenRendered().then(function(){aa.localComponents?aa.localComponents.forEach(function(){var Sa=Rc(regeneratorRuntime.mark(function Jb(jb){var gc,ac,Kc,md,ud,oe;return regeneratorRuntime.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:if(jb.owner){ze.next=23;break}gc=jb.withAllSubmorphsSelect(function(Ue){return Ue.master&&!Ue.master._appliedMaster});ac=M(gc);ze.prev=3;ac.s();case 5:if((Kc=ac.n()).done){ze.next=11;break}md=Kc.value;ze.next=9;return md.master.applyIfNeeded(!0);case 9:ze.next=
5;break;case 11:ze.next=16;break;case 13:ze.prev=13,ze.t0=ze["catch"](3),ac.e(ze.t0);case 16:return ze.prev=16,ac.f(),ze.finish(16);case 19:ud=aa.withAllSubmorphsSelect(function(Ue){return Ue.master&&Ue.master.uses(jb)}),oe=aa.localComponents.filter(function(Ue){return Ue.master&&Ue.master.uses(jb)}),ud.forEach(function(Ue){Ue.requestMasterStyling()}),oe.forEach(function(Ue){return Ue.master.applyIfNeeded(!0)});case 23:case "end":return ze.stop()}},Jb,null,[[3,13,16,19]])}));return function(jb){return Sa.apply(this,
arguments)}}()):aa.localComponents=aa.withAllSubmorphsSelect(function(Sa){return Sa.isComponent})})}},name:{set:function(aa){this.setProperty("name",aa);document.title="lively.next - ".concat(aa)}},hiddenComponents:{initialize:function(){this.hiddenComponents=[]}},fill:{defaultValue:ye.Color.rgb(81,90,90)},draggable:{readOnly:!0,get:function(){return!ye.touchInputDevice}},morphCommentMap:{initialize:function(){this.morphCommentMap=new Map},doc:"Stores a mapping from Morphs to an Array with their comments (if they have any)."}}}}],
td,{pathInPackage:function(){return"./world.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1392,end:47806})}(ye.World);ye.LivelyWorld=mh;ye.LivelyWorld=mh;Ge=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/world.js"),hd=td.hasOwnProperty("SelectionElement")&&"function"===typeof td.SelectionElement?td.SelectionElement:
td.SelectionElement=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,void 0,[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"SelectionElement"}},{key:"properties",get:function(){return{borderColor:{defaultValue:ye.Color.red},borderWidth:{defaultValue:1},fill:{defaultValue:ye.Color.transparent},epiMorph:{defaultValue:!0},isSelectionElement:{readOnly:!0,get:function(){return!0}}}}}],
td,{pathInPackage:function(){return"./world.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:47814,end:48251})}(ye.Morph);ye.SelectionElement=Ge;ye.SelectionElement=Ge;Se=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/world.js"),hd=td.hasOwnProperty("Selection")&&"function"===typeof td.Selection?td.Selection:
td.Selection=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,void 0,[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"Selection"}},{key:"properties",get:function(){return{fill:{defaultValue:ye.Color.gray.withA(.2)},borderWidth:{defaultValue:2},borderColor:{defaultValue:ye.Color.gray},isSelectionElement:{readOnly:!0,get:function(){return!0}}}}}],td,{pathInPackage:function(){return"./world.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:48259,end:48640})}(ye.Morph);ye.Selection=Se;ye.Selection=Se;mh=Object.freeze({__proto__:null,LivelyWorld:mh,SelectionElement:Ge,Selection:Se});bd("w",mh);var Yc=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar.cp.js");Yc.Color=Ne;Yc.Rectangle=Pc;Yc.LinearGradient=xd;
Yc.rect=Cb;Yc.pt=ad;Yc.HorizontalLayout=dd;Yc.config=da;Yc.touchInputDevice=Qc;Yc.TilingLayout=Sd;Yc.Tooltip=Vd;Yc.morph=kb;Yc.Text=jc;Yc.Polygon=sf;Yc.Path=hg;Yc.HTMLMorph=zc;Yc.Ellipse=bh;Yc.Morph=Fc;Yc.Image=se;Yc.Label=fe;Yc.ShadowObject=uc;Yc.Icon=vd;Yc.component=Od;Yc.ViewModel=Qf;Yc.part=ic;Yc.Canvas=th;Yc.Closure=he;Yc.string=fa;Yc.obj=ab;Yc.arr=sb;Yc.resource=Wb;Yc.CommentBrowser=cb;Yc.once=rd;Yc.connect=nd;Yc.disconnect=Uf;Yc.signal=$g;Yc.getClassName=gd;Yc.Selection=Se;Yc.SelectionElement=
Ge;Yc.UserRegistry=Ta;Yc.UserUI=Pf;Yc.SystemTooltip=eg;Ge=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar.cp.js"),hd=td.hasOwnProperty("FastLoadToggler")&&"function"===typeof td.FastLoadToggler?td.FastLoadToggler:td.FastLoadToggler=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"onLoad",value:function(){localStorage.getItem("lively.load-config")||
localStorage.setItem("lively.load-config",JSON.stringify({"lively.lang":"dynamic","lively.ast":"dynamic","lively.source-transform":"dynamic","lively.classes":"dynamic","lively.vm":"dynamic","lively.modules":"dynamic","lively.user":"dynamic","lively.storage":"dynamic","lively.morphic":"dynamic"}))}},{key:"onMouseDown",value:function(aa){db._get(Object.getPrototypeOf(hd.prototype),"onMouseDown",this).call(this,aa);this.toggleFastLoad()}},{key:"refresh",value:function(){var aa=this.getSubmorphNamed("toggle indicator"),
Sa=this.getSubmorphNamed("label"),Ma=this.getSubmorphNamed("bolt"),jb=Object.values(this.loadConfig).every(function(Jb){return"frozen"===Jb});Sa.master=Ma.master=aa.master=jb?Yc.TopBarButtonSelected:null;aa.textAndAttributes=Yc.Icon.textAttribute(jb?"toggle-on":"toggle-off")}},{key:"toggleFastLoad",value:function(){var aa=this.loadConfig,Sa=Object.values(aa).every(function(jb){return"frozen"===jb}),Ma;for(Ma in aa)aa[Ma]=Sa?"dynamic":"frozen";this.loadConfig=aa;this.refresh()}}],[{key:Symbol["for"]("__LivelyClassName__"),
get:function(){return"FastLoadToggler"}},{key:"properties",get:function(){return{loadConfig:{derived:!0,get:function(){return JSON.parse(localStorage.getItem("lively.load-config")||"{}")},set:function(aa){localStorage.setItem("lively.load-config",JSON.stringify(aa))}}}}}],td,{pathInPackage:function(){return"./studio/top-bar.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:849,end:2582})}(Yc.Morph);Yc.FastLoadToggler=Ge;Yc.FastLoadToggler=Ge;Se=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar.cp.js"),hd=td.hasOwnProperty("TopBarModel")&&"function"===typeof td.TopBarModel?td.TopBarModel:td.TopBarModel=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"__additionally_serialize__",value:function(aa,
Sa,Ma,jb){jb("haloFilterFn",this.getProperty("haloFilterFn"))}},{key:"onMouseDown",value:function(aa){var Sa=this.ui.selectShapeType,Ma=this.ui.shapeModeButton,jb=this.primaryTarget||this.world();aa.targetMorph===Sa&&(this.world().openWorldMenu(aa,this.getShapeMenuItems()).position=Ma.globalBounds().bottomLeft().subPt(this.world().scroll));"undo button"===aa.targetMorph.name&&jb.execCommand("undo");"redo button"===aa.targetMorph.name&&jb.execCommand("redo");"save button"===aa.targetMorph.name&&$world.execCommand("save world");
aa.targetMorph===Ma&&this.setEditMode("Shape");"text mode button"===aa.targetMorph.name&&this.setEditMode("Text");"hand mode button"===aa.targetMorph.name&&this.setEditMode("Hand");"halo mode button"===aa.targetMorph.name&&this.setEditMode("Halo");"open component browser"===aa.targetMorph.name&&this.interactivelyLoadComponent();"load world button"===aa.targetMorph.name&&this.world().execCommand("load world");"comment browser button"===aa.targetMorph.name&&this.toggleCommentBrowser()}},{key:"onKeyUp",
value:function(aa){"Hand"===this._tmpEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(aa){if(aa.isCommandKey()&&"Hand"===this._tmpEditMode)this.setEditMode("Halo",!0);else if(!aa.isAltDown()){var Sa=this.keyToShape;if(Sa[aa.key])this.currentShapeMode=Sa[aa.key],this.setEditMode("Shape");else switch(aa.key){case "Escape":this.setEditMode("Halo");break;case "T":this.setEditMode("Text")}}}},{key:"registerCustomShape",value:function(aa,Sa,Ma,jb){this.shapeToClass[aa]=Sa;this.keyToShape[Ma]=
aa;this.shapeToIcon[aa]={shortcut:Ma,args:jb};this.shapesCreatedViaDrag.push(Sa)}},{key:"onUserChanged",value:function(aa){this.ui.userFlap.onUserChanged(aa)}},{key:"relayout",value:function(){this.ui.ipadStatusBar.width=this.view.width=this.world().visibleBounds().width;this.view.position=Yc.pt(0,0)}},{key:"adjustElements",value:function(){var aa=this.ui.ipadStatusBar;aa&&(aa.width=this.view.width);this.ui.userFlap.owner===this&&(this.ui.userFlap.right=this.width-10,this.ui.userFlap.visible=750<
this.width)}},{key:"getShapeMenuItems",value:function(){var aa=this;return Object.entries(this.shapeToIcon).map(function(Sa){var Ma;Sa=Fa(Sa,2);var jb=Sa[0],Jb=Sa[1];Sa=Jb.shortcut;Jb=Jb.args;return[[].concat(Xa(aa.currentShapeMode===jb?[].concat(Xa(Yc.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),Xa((Ma=Yc.Icon).textAttribute.apply(Ma,Xa(Jb))),["   ".concat(jb," "),{"float":"none"},"      "+Sa,{"float":"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),
function(){aa.currentShapeMode=jb;aa.setEditMode("Shape")}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("scene graph");this.openSideBar("properties panel")}},{key:"openSideBar",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc,ac,Kc,md;return regeneratorRuntime.wrap(function(ud){for(;;)switch(ud.prev=ud.next){case 0:this.activeSideBars.includes(Ma)?Yc.arr.remove(this.activeSideBars,
Ma):this.activeSideBars.push(Ma);if("scene graph"!==Ma){ud.next=17;break}if(this.sideBar){ud.next=15;break}ud.next=5;return Dd.import("./scene-graph.cp-4e8a9228.js");case 5:return Jb=ud.sent,gc=Jb.MorphPanel,this.sideBar=Yc.part(gc),this.sideBar.epiMorph=!0,this.sideBar.hasFixedPosition=!0,this.sideBar.respondsToVisibleWindow=!0,this.sideBar.openInWorld(),this.sideBar.right=0,ud.next=15,this.sideBar.whenRendered();case 15:return ud.next=17,this.sideBar.toggle(this.activeSideBars.includes("scene graph"));
case 17:if("properties panel"!==Ma){ud.next=29;break}if(this.stylingPalette){ud.next=27;break}ud.next=21;return Dd.import("./properties-panel.cp-88d87540.js");case 21:ac=ud.sent,Kc=ac.PropertiesPanel,this.stylingPalette=Yc.part(Kc),this.stylingPalette.epiMorph=!0,this.stylingPalette.hasFixedPosition=!0,this.stylingPalette.respondsToVisibleWindow=!0;case 27:return ud.next=29,this.stylingPalette.toggle(this.activeSideBars.includes("properties panel"));case 29:(md=this.ui.livelyVersionChecker)&&md.owner===
$world&&md.relayout();case 31:case "end":return ud.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"colorCommentBrowserButton",value:function(){this.ui.commentBrowserButton.master=Yc.TopBarButtonSelected}},{key:"uncolorCommentBrowserButton",value:function(){this.ui.commentBrowserButton.master=null}},{key:"toggleCommentBrowser",value:function(){var aa=$world.getSubmorphNamed("Comment Browser");aa?(this.uncolorCommentBrowserButton(),aa.getWindow().close()):(this.colorCommentBrowserButton(),
Yc.part(Yc.CommentBrowser).openInWindow())}},{key:"interactivelyLoadComponent",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return jb=this.ui.openComponentBrowser,jb.master=Yc.TopBarButtonSelected,Jb.next=4,this.world().execCommand("browse and load component");case 4:jb.master=null;case 5:case "end":return Jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"setEditMode",
value:function(aa){var Sa=this,Ma=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;this.editMode=aa;var jb=this.primaryTarget||this.world();if(jb){Ma||(this._tmpEditMode=aa);var Jb=this.ui;[["Shape",Jb.shapeModeButton.submorphs],["Text",[Jb.textModeButton]],["Hand",[Jb.handModeButton]],["Halo",[Jb.haloModeButton]]].forEach(function(gc){var ac=Fa(gc,2);gc=ac[0];ac=ac[1];"Shape"===aa?Sa.toggleShapeMode(jb,!0,Sa.currentShapeMode):"Text"===aa?Sa.toggleShapeMode(jb,!0,"Text"):Sa.toggleShapeMode(jb,
!1);Sa.showHaloPreviews("Halo"===aa);Ma||"Halo"===aa||Sa.world().halos().forEach(function(Kc){return Kc.remove()});gc===aa?ac.forEach(function(Kc){Kc.master=Yc.TopBarButtonSelected}):ac.forEach(function(Kc){Kc.master=null})})}}},{key:"canBeCreatedViaDrag",value:function(aa){return this.shapesCreatedViaDrag.includes(aa)}},{key:"toggleShapeMode",value:function(aa,Sa,Ma){var jb=this.shapeToClass;Sa?(aa.nativeCursor="crosshair",aa._yieldShapeOnClick=jb[Ma]):(aa._yieldShapeOnClick=!1,aa.nativeCursor="auto")}},
{key:"handleShapeCreation",value:function(aa){this._customDrag&&(this._customDrag=!1,this.world().halos()[0].onDragEnd());var Sa=this.primaryTarget||this.world(),Ma=Sa._yieldShapeOnClick;if(!Ma)return!1;Sa._sizeTooltip&&Sa._sizeTooltip.remove();if(aa.targetMorph!==Sa)return!1;if(Sa._shapeRequest&&Ma&&!Sa._yieldedShape){var jb=Sa.localize(this.world().firstHand.position);switch(Ma){case Yc.Image:Sa.addMorph(Yc.morph({type:Ma,position:jb,extent:Yc.pt(150,150),fill:Yc.Color.transparent,imageUrl:"https://i.imgur.com/uGRFZEs.jpg"}));
break;case Yc.Label:Sa.addMorph(Yc.morph({type:Ma,position:jb,value:"I am a label!",fill:Yc.Color.transparent}));break;case Yc.Text:if(aa.targetMorph.isText)return;Sa.addMorph(Yc.morph({type:Ma,position:jb,readOnly:!0,textString:"I am a text field!",fill:Yc.Color.transparent}))}}Ma===Yc.Text&&Sa._yieldedShape?Sa._yieldedShape.focus():Sa._yieldedShape&&Sa._yieldedShape.owner&&this.showHaloFor(Sa._yieldedShape);Sa._yieldedShape=null;Sa._shapeRequest=!1}},{key:"prepareShapeCreation",value:function(aa){var Sa=
this.primaryTarget||this.world(),Ma=Sa._yieldShapeOnClick;if(!Ma||!this.canBeCreatedViaDrag(Ma))return!1;Sa._yieldedShape=Yc.morph(Object.assign({type:Ma,position:aa.positionIn(Sa),extent:Yc.pt(1,1),fill:Yc.Color.transparent,borderWidth:1,borderColor:Yc.Color.rgb(23,160,251),fixedHeight:!0,fixedWidth:!0,lineWrapping:!0},Ma===Yc.Text?this.getDefaultTextAttrs():{},{},Ma===Yc.Image?this.getImageDefaultAttrs():{},{},Ma===Yc.Polygon?this.getPolyDefaultAttrs():{},{},Ma===Yc.Path?this.getPathDefaultAttrs():
{}));Sa._sizeTooltip=new Yc.Tooltip({master:Yc.SystemTooltip});Sa._sizeTooltip.openInWorld();return!0}},{key:"getPolyDefaultAttrs",value:function(){return{vertices:[Yc.pt(131.4,86.3),Yc.pt(171,139.6),Yc.pt(105.9,119.9),Yc.pt(65.3,172.5),Yc.pt(64.7,107),Yc.pt(0,86.3),Yc.pt(64.7,65.5),Yc.pt(65.3,0),Yc.pt(105.9,52.6),Yc.pt(171,32.9),Yc.pt(131.4,86.3)],borderWidth:1}}},{key:"getPathDefaultAttrs",value:function(){return{vertices:[Yc.pt(0,0),Yc.pt(1,1)],borderWidth:1}}},{key:"getImageDefaultAttrs",value:function(){return{imageUrl:"https://i.imgur.com/uGRFZEs.jpg"}}},
{key:"getDefaultTextAttrs",value:function(){return{readOnly:!0}}},{key:"yieldShapeIfNeeded",value:function(aa){var Sa=this.primaryTarget||this.world();return Sa._yieldedShape?(!Sa._yieldedShape.owner&&10<aa.state.absDragDelta.r()&&Sa.addMorph(Sa._yieldedShape),Sa._yieldedShape.extent=aa.positionIn(Sa.world()).subPt(aa.state.dragStartPosition).subPt(Yc.pt(1,1)).maxPt(Yc.pt(1,1)),Sa._sizeTooltip.description="".concat(Sa._yieldShapeOnClick[Symbol["for"]("__LivelyClassName__")],": ").concat(Sa._yieldedShape.width.toFixed(0),
"x").concat(Sa._yieldedShape.height.toFixed(0)),Sa._sizeTooltip.topLeft=aa.positionIn(Sa.world()).addXY(15,15),!0):!1}},{key:"handleHaloSelection",value:function(aa){var Sa=this.world(),Ma=this.primaryTarget||Sa,jb=Sa.halos();jb=Fa(jb,1)[0];this._showHaloPreview&&this._currentlyHighlighted&&0===Sa.halos().length&&(aa.stop(),Sa.getSubmorphsByStyleClassName("HaloPreview").forEach(function(Jb){return Jb.remove()}),this.showHaloFor(this._currentlyHighlighted));jb&&jb.target===aa.state.prevClick.clickedOnMorph&&
"border-box"===aa.targetMorph.name&&50>aa.state.timeOfLastActivity-aa.state.prevClick.clickedAtTime?jb.temporaryEditTextMorph(aa):aa.targetMorph===Ma&&(Ma._shapeRequest=!0)}},{key:"showHaloFor",value:function(aa){var Sa=this;if(aa){if(Yc.obj.isArray(aa)){if(0===aa.length)return;var Ma=this.world().showHaloForSelection(aa)}else Ma=this.world().showHaloFor(aa);Yc.once(Ma,"remove",function(){Ma.target!==Sa.world().focusedMorph&&Yc.signal(Sa.primaryTarget,"onHaloRemoved",aa)});this.activeHaloItems.includes("*")||
(Ma.activeItems=this.activeHaloItems);Ma.topBar=this;Yc.signal(this.primaryTarget,"onHaloOpened",aa)}}},{key:"handleHaloPreview",value:function(aa){var Sa=this;if(this._showHaloPreview){var Ma=this.haloFilterFn,jb=this.primaryTarget||this.world(),Jb=jb.morphsContainingPoint(aa.positionIn(jb.world()));"hoverout"===aa.type&&(Jb=[jb]);jb=Jb.filter(function(gc){return Ma(gc)&&gc.halosEnabled&&[gc].concat(Xa(gc.ownerChain())).every(function(ac){return ac.visible&&0<ac.opacity&&!ac.styleClasses.includes("HaloPreview")})})[0];
if(Jb.find(function(gc){return gc.isMenuItem||gc===Sa.sideBar||gc===Sa.stylingPalette})){this._currentlyHighlighted=!1;this.clearHaloPreviews();return}this.showHaloPreviewFor(jb)}aa.state.draggedMorph||(Jb=this.world().halos(),(Jb=Fa(Jb,1)[0])&&this._customDrag&&aa.leftMouseButtonPressed()&&Jb.customDrag(aa),aa.leftMouseButtonPressed()&&!this._customDrag&&!aa.state.draggedMorph&&aa.startPosition&&25<aa.startPosition.subPt(aa.position).r()&&Jb&&(Jb.onDragStart(aa),this._customDrag=!0))}},{key:"showHaloPreviewFor",
value:function(aa){var Sa=this.primaryTarget||this.world();if(aa&&(![aa].concat(Xa(aa.ownerChain())).find(function(Ma){return Ma.isComponent})&&aa.getWindow()?aa=null:[aa].concat(Xa(aa.ownerChain())).find(function(Ma){return Ma.isEpiMorph})?aa=null:aa===Sa&&(aa=null),this._currentlyHighlighted!==aa&&(this.clearHaloPreviews(),this._currentlyHighlighted=aa),!(0<this.world().halos().length)&&aa)){this._previewCache||(this._previewCache=new WeakMap);Sa=Yc.Morph;switch(Yc.getClassName(aa)){case "Ellipse":Sa=
Yc.Ellipse}Sa=this._previewCache.get(aa)||Yc.morph({type:Sa,styleClasses:["HaloPreview"],epiMorph:!0,fill:Yc.Color.transparent,reactsToPointer:!1,halosEnabled:!1,acceptsDrops:!1,border:{color:Yc.Color.rgb(23,160,251),width:1}});Sa.owner||this.world().addMorph(Sa);Sa.setBounds(aa.globalBounds());Sa.borderColor=Yc.Color.rgb(23,160,251);Sa.borderStyle="solid";aa.master&&(Sa.borderColor=Yc.Color.purple);aa.ownerChain().find(function(Ma){return Ma.master&&Ma.master.managesMorph(aa)})&&(Sa.borderColor=
Yc.Color.purple,Sa.borderStyle="dotted");aa.isComponent&&(Sa.borderColor=Yc.Color.magenta);this._previewCache.set(aa,Sa)}}},{key:"showHaloPreviews",value:function(aa){aa||this.clearHaloPreviews();this._showHaloPreview=aa}},{key:"clearHaloPreviews",value:function(){this.world().getSubmorphsByStyleClassName("HaloPreview").forEach(function(aa){return aa.remove()})}},{key:"prepareDragSelection",value:function(aa){var Sa=(this.primaryTarget||this.world()).world();this._selectionStartPos=aa.positionIn(Sa);
this._morphSelection=Sa.addMorph({type:Yc.Selection,epiMorph:!0,reactsToPointer:!1,position:this._selectionStartPos,extent:aa.state.dragDelta});this._selectedMorphs={}}},{key:"adjustDragSelection",value:function(aa){var Sa=this,Ma=this.primaryTarget||this.world(),jb=Ma.world(),Jb=Yc.Rectangle.fromAny(aa.position,this._selectionStartPos);this._morphSelection.setBounds(Jb);Ma.submorphs.forEach(function(gc){if(!gc.isSelectionElement&&!gc.isHand){var ac=gc.globalBounds(),Kc=Jb.containsRect(ac);!Sa._selectedMorphs[gc.id]&&
Kc&&(Sa._selectedMorphs[gc.id]=jb.addMorph({type:Yc.SelectionElement,bounds:ac},Sa._morphSelection));Sa._selectedMorphs[gc.id]&&!Kc&&(Sa._selectedMorphs[gc.id].remove(),delete Sa._selectedMorphs[gc.id])}})}},{key:"finishDragSelectionIfNeeded",value:function(aa){if(this._morphSelection){var Sa=this.world();this._morphSelection.fadeOut(200);Yc.obj.values(this._selectedMorphs).map(function(Ma){return Ma.remove()});this.showHaloFor(Object.keys(this._selectedMorphs).map(function(Ma){return Sa.getMorphWithId(Ma)}));
this._selectedMorphs={};this._morphSelection=null}}},{key:"onTargetDragStart",value:function(aa){!this.prepareShapeCreation(aa)&&aa.leftMouseButtonPressed()&&this.prepareDragSelection(aa)}},{key:"onTargetDrag",value:function(aa){!this.yieldShapeIfNeeded(aa)&&this._morphSelection&&this.adjustDragSelection(aa)}},{key:"showCurrentUser",value:function(){var aa=this.models.userFlap;aa.showUser(aa.currentUser(),!1)}},{key:"detachFromTarget",value:function(aa){Yc.disconnect(aa,"onMouseMove",this,"handleHaloPreview");
Yc.disconnect(aa,"onMouseDown",this,"handleHaloSelection");Yc.disconnect(aa,"onMouseUp",this,"handleShapeCreation");Yc.disconnect(aa,"onDragStart",this,"onTargetDragStart");Yc.disconnect(aa,"onDrag",this,"onTargetDrag");Yc.disconnect(aa,"onDragEnd",this,"finishDragSelectionIfNeeded")}},{key:"attachToTarget",value:function(aa){this.primaryTarget&&this.detachFromTarget(this.primaryTarget);this.primaryTarget=aa;this.setEditMode("Halo");Yc.connect(aa,"onMouseMove",this,"handleHaloPreview",{garbageCollect:!0});
Yc.connect(aa,"onHoverOut",this,"handleHaloPreview",{garbageCollect:!0});Yc.connect(aa,"onMouseDown",this,"handleHaloSelection",{garbageCollect:!0});Yc.connect(aa,"onMouseUp",this,"handleShapeCreation",{garbageCollect:!0});Yc.connect(aa,"onDragStart",this,"onTargetDragStart",{garbageCollect:!0});Yc.connect(aa,"onDrag",this,"onTargetDrag",{garbageCollect:!0});Yc.connect(aa,"onDragEnd",this,"finishDragSelectionIfNeeded",{garbageCollect:!0});try{aa.draggable=!0}catch(Sa){}}}],[{key:Symbol["for"]("__LivelyClassName__"),
get:function(){return"TopBarModel"}},{key:"properties",get:function(){return{isTopBar:{readOnly:!0,get:function(){return!0}},activeHaloItems:{initialize:function(aa){aa||(this.activeHaloItems=["*"])}},primaryTarget:{doc:"A reference to the morph that the top bar considers its primary target",defaultValue:null},haloFilterFn:{defaultValue:"() => true",derived:!0,set:function(aa){this.setProperty("haloFilterFn",aa)},get:function(){return Yc.Closure.fromSource(this.getProperty("haloFilterFn"),{target:this.primaryTarget}).asFunction()}},
activeSideBars:{initialize:function(){this.activeSideBars=[]}},currentShapeMode:{defaultValue:"Rectangle",set:function(aa){this.setProperty("currentShapeMode",aa);this.ui.shapeStatusIcon.textAndAttributes=Yc.Icon.textAttribute(this.shapeToIcon[aa].args[0])}},shapeToIcon:{initialize:function(aa){this.shapeToIcon=aa||{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],
paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}},keyToShape:{initialize:function(aa){this.keyToShape=aa||{R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"}}},shapeToClass:{serialize:!1,defaultValue:{Rectangle:Yc.Morph,
Ellipse:Yc.Ellipse,HTML:Yc.HTMLMorph,Canvas:Yc.Canvas,Image:Yc.Image,Path:Yc.Path,Label:Yc.Label,Polygon:Yc.Polygon,Text:Yc.Text}},shapesCreatedViaDrag:{serialize:!1,initialize:function(){this.shapesCreatedViaDrag=[Yc.Morph,Yc.Ellipse,Yc.HTMLMorph,Yc.Canvas,Yc.Text,Yc.Polygon,Yc.Path,Yc.Image]}},expose:{get:function(){return"relayout attachToTarget activeSideBars setEditMode showCurrentUser showHaloFor openSideBar colorCommentBrowserButton uncolorCommentBrowserButton".split(" ")}},bindings:{get:function(){return[{signal:"onMouseDown",
handler:"onMouseDown"},{signal:"onKeyDown",handler:"onKeyDown"},{signal:"onKeyUp",handler:"onKeyUp"}]}}}}}],td,{pathInPackage:function(){return"./studio/top-bar.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:2590,end:26709})}(Yc.ViewModel);Yc.TopBarModel=Se;Yc.TopBarModel=Se;mh=function(Tc){var td=window.lively.FreezerRuntime.recorderFor("lively.ide/studio/top-bar.cp.js"),
hd=td.hasOwnProperty("UserFlapModel")&&"function"===typeof td.UserFlapModel?td.UserFlapModel:td.UserFlapModel=function(aa){if(!aa||!aa[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return db(hd,Tc,[{key:"isUserFlap",get:function(){return!0}},{key:"collapse",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return this.minimize(),
jb.next=3,this.view.whenRendered();case 3:this.world().focusedMorph.ownerChain().includes(this.view)&&this.view.focus();case 4:case "end":return jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"open",value:function(){this.openInWorld();this.showUser(this.currentUser(),!1);this.alignInWorld(!1);this.hasFixedPosition=!0;return this}},{key:"showCurrentUserInfo",value:function(){this.showUserInfo(this.currentUser())}},{key:"logoutCurrentUser",value:function(){var aa=
Rc(regeneratorRuntime.mark(function Ma(){return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:return jb.next=2,this.minimize();case 2:return jb.next=4,this.logout(this.currentUser());case 4:case "end":return jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"showCurrentUserLogin",value:function(){this.showLogin(this.currentUser())}},{key:"toggleKeyboardInput",value:function(){var aa=this.ui.keyboardInput;(0<arguments.length&&void 0!==
arguments[0]?!arguments[0]:Yc.touchInputDevice)?(aa.fontColor=this.fontColor,aa.dropShadow=!1):(aa.fontColor=Yc.Color.rgb(0,176,255),aa.dropShadow=this.haloShadow)}},{key:"currentUser",value:function(){return Yc.UserRegistry.current.loadUserFromLocalStorage(Yc.config.users.authServerURL)}},{key:"onUserChanged",value:function(aa){this.showUser(aa.user||{name:"???"},!1)}},{key:"onWorldResize",value:function(aa){!this.isComponent&&this.alignInWorld()}},{key:"relayout",value:function(){this.alignInWorld()}},
{key:"alignInWorld",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc;return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:if(Jb=this.view.owner){ac.next=3;break}return ac.abrupt("return");case 3:return ac.next=5,this.view.whenRendered();case 5:this.view.hasFixedPosition&&Jb.isWorld?this.view.topRight=Yc.pt(this.world().visibleBounds().width,0):Jb.isWorld&&(gc=$world.visibleBounds().topRight().withY(0).subXY(10,0),Ma?this.view.animate({topRight:gc,
duration:200}):this.view.topRight=gc);case 6:case "end":return ac.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"minimize",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:if(jb=this.ui.userMenu){Jb.next=3;break}return Jb.abrupt("return");case 3:return Jb.next=5,jb.animate({opacity:0,scale:.8,duration:200});case 5:jb.visible=!1;case 6:case "end":return Jb.stop()}},
Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"ensureMenu",value:function(){var aa=this.ui.userMenu||this.view.addMorph(Yc.part(Yc.UserMenu,{name:"user menu"}));aa.visible=!1;aa.opacity=0;aa.scale=.8;aa.position=this.ui.avatar.bottomCenter.addXY(0,10);this.reifyBindings();return aa}},{key:"maximize",value:function(){var aa=Rc(regeneratorRuntime.mark(function Ma(){var jb;return regeneratorRuntime.wrap(function(Jb){for(;;)switch(Jb.prev=Jb.next){case 0:return this.view.focus(),
(jb=this.ui.userMenu)||(jb=this.ensureMenu()),jb.right=this.view.width-5,jb.visible=!0,Jb.next=7,jb.animate({opacity:1,scale:1,duration:200});case 7:case "end":return Jb.stop()}},Ma,this)}));return function(){return aa.apply(this,arguments)}}()},{key:"changeWidthAndHeight",value:function(){var aa=Rc(regeneratorRuntime.mark(function gc(Ma,jb,Jb){return regeneratorRuntime.wrap(function(ac){for(;;)switch(ac.prev=ac.next){case 0:if(!Jb){ac.next=5;break}ac.next=3;return this.animate({position:this.position.addXY(this.width-
Ma,0),extent:Yc.pt(Ma,jb),duration:200});case 3:ac.next=7;break;case 5:this.extent=Yc.pt(Ma,jb),this.position=this.position.addXY(this.width-Ma,0);case 7:case "end":return ac.stop()}},gc,this)}));return function(Ma,jb,Jb){return aa.apply(this,arguments)}}()},{key:"showMenuItems",value:function(aa){var Sa=this;this.view.withMetaDo({metaInteraction:!0},function(){Yc.arr.withoutAll(["login item","logout item","profile item","register item"],aa).map(function(Ma){return Sa.view.getSubmorphNamed(Ma)}).forEach(function(Ma){Ma.visible=
!1;Ma.bringToFront()});aa.map(function(Ma){return Sa.view.getSubmorphNamed(Ma)}).forEach(function(Ma){Ma.visible=!0})})}},{key:"showUser",value:function(){var aa=Rc(regeneratorRuntime.mark(function jb(Ma){var Jb,gc,ac,Kc,md,ud;return regeneratorRuntime.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return Jb=this.ui,gc=Jb.nameLabel,ac=Jb.userMenu,Kc=Jb.avatar,md=String(Ma.name),ud=Yc.resource("https://s.gravatar.com/avatar").join(Yc.string.md5(Ma.email||"")).withQuery({s:160}).url,this.ensureMenu(),
md.startsWith("guest-")?(this.showMenuItems(["login item","register item"]),md="guest"):this.showMenuItems(["logout item","profile item"]),gc.value=md,Kc.imageUrl=ud,ac&&(ac.position=Kc.bottomCenter.addXY(0,10)),oe.next=11,this.view.whenRendered();case 11:this.alignInWorld();case 12:case "end":return oe.stop()}},jb,this)}));return function(Ma){return aa.apply(this,arguments)}}()},{key:"showRegister",value:function(){return Yc.UserUI.showRegister()}},{key:"showUserInfo",value:function(aa){return Yc.UserUI.showUserInfo({user:aa})}},
{key:"showLogin",value:function(aa){return Yc.UserUI.showLogin({user:aa})}},{key:"logout",value:function(aa){return Yc.UserRegistry.current.logout(aa)}},{key:"updateNetworkIndicator",value:function(aa){var Sa="red";aa&&(aa.isOnline()&&(Sa="yellow"),aa.isRegistered()&&(Sa="green"));this.ui.networkIndicator.animate({fill:Yc.Color[Sa],duration:300})}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"UserFlapModel"}},{key:"properties",get:function(){return{expose:{get:function(){return["isUserFlap",
"isMaximized","updateNetworkIndicator","alignInWorld"]}},bindings:{get:function(){return[{signal:"onBlur",handler:"collapse"},{target:"avatar",signal:"onMouseDown",handler:"maximize"},{target:"keyboard input",signal:"onMouseDown",handler:"toggleKeyboardInput"},{target:"profile item",signal:"onMouseDown",handler:"showCurrentUserInfo"},{target:"logout item",signal:"onMouseDown",handler:"logoutCurrentUser"},{target:"login item",signal:"onMouseDown",handler:"showCurrentUserLogin"},{target:"register item",
signal:"onMouseDown",handler:"showRegister"}]}}}}}],td,{pathInPackage:function(){return"./studio/top-bar.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:26717,end:32724})}(Yc.ViewModel);Yc.UserFlapModel=mh;Yc.UserFlapModel=mh;Yc.TopBarButton=Yc.component["for"](function(){return Yc.component({type:Yc.Label,name:"top bar button",
fontColor:{value:Yc.Color.rgb(102,102,102),onlyAtInstantiation:!0},fontSize:{value:23,onlyAtInstantiation:!0},nativeCursor:"pointer",padding:{value:Yc.rect(0,1,0,-1),onlyAtInstantiation:!0}})},{module:"lively.ide/studio/top-bar.cp.js","export":"TopBarButton",range:{start:32731,end:33056}},Yc.TopBarButton);Yc.TopBarButtonSelected=Yc.component["for"](function(){return Yc.component(Yc.TopBarButton,{name:"top bar button selected",dropShadow:new Yc.ShadowObject({color:Yc.Color.rgba(64,196,255,.4),fast:!1}),
fontColor:Yc.Color.rgb(0,176,255)})},{module:"lively.ide/studio/top-bar.cp.js","export":"TopBarButtonSelected",range:{start:33064,end:33283}},Yc.TopBarButtonSelected);Yc.UserFlap=Yc.component["for"](function(){return Yc.component({name:"user flap",defaultViewModel:Yc.UserFlapModel,borderColor:{bottom:Yc.Color.rgb(204,204,204),left:Yc.Color.rgb(204,204,204),right:Yc.Color.rgb(204,204,204),top:Yc.Color.rgb(255,255,255)},position:Yc.pt(580.2,897.3),borderRadius:7,clipMode:"visible",extent:Yc.pt(362.3,
52.3),fontColor:Yc.Color.rgb(102,102,102),layout:new Yc.HorizontalLayout({align:"center",autoResize:!1,direction:"rightToLeft",orderByIndex:!0,padding:{height:0,width:0,x:10,y:10},reactToSubmorphAnimations:!1,renderViaCSS:!0,resizeSubmorphs:!1,spacing:10}),submorphs:[{type:Yc.FastLoadToggler,name:"fast load toggler",borderColor:Yc.Color.rgb(23,160,251),extent:Yc.pt(115.3,41.1),fill:Yc.Color.rgba(0,0,0,0),tooltip:"Toggle fast load",layout:new Yc.HorizontalLayout({align:"center",autoResize:!1,direction:"rightToLeft",
orderByIndex:!0,padding:{height:0,width:0,x:10,y:10},reactToSubmorphAnimations:!1,renderViaCSS:!0,resizeSubmorphs:!1,spacing:10}),submorphs:[Yc.part(Yc.TopBarButton,{name:"bolt",fontSize:17,padding:Yc.rect(0,4,0,-4),textAndAttributes:Yc.Icon.textAttribute("bolt")}),Yc.part(Yc.TopBarButton,{name:"label",fontSize:16,textAndAttributes:["Fast Load",null]}),Yc.part(Yc.TopBarButton,{name:"toggle indicator",fontSize:23,nativeCursor:"pointer",textAndAttributes:Yc.Icon.textAttribute("toggle-off")})]},{name:"network-indicator",
borderRadius:5,extent:Yc.pt(5,5),fill:Yc.Color.rgb(0,204,0),reactsToPointer:!1},{type:Yc.Label,name:"name label",draggable:!0,fill:Yc.Color.rgba(255,255,255,0),fontColor:{onlyAtInstantiation:!0,value:Yc.Color.rgb(102,102,102)},fontSize:16,grabbable:!0,nativeCursor:"pointer",reactsToPointer:!1,textAndAttributes:["guest",null]},{type:Yc.Image,name:"avatar",borderRadius:25,clipMode:"hidden",dropShadow:new Yc.ShadowObject({rotation:72,color:Yc.Color.rgba(0,0,0,.47),blur:5}),extent:Yc.pt(30,30),fill:Yc.Color.transparent,
imageUrl:"https://s.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=160",nativeCursor:"pointer",naturalExtent:Yc.pt(160,160)}]})},{module:"lively.ide/studio/top-bar.cp.js","export":"UserFlap",range:{start:33324,end:35947}},Yc.UserFlap);Yc.DarkUserFlap=Yc.component["for"](function(){return Yc.component(Yc.UserFlap,{name:"dark user flap",fill:Yc.Color.rgba(255,255,255,0),submorphs:[{name:"fast load toggler",submorphs:[{name:"bolt",fontColor:Yc.Color.rgb(255,255,255)},{name:"label",fontColor:Yc.Color.white},
{name:"toggle indicator",fontColor:Yc.Color.rgb(255,255,255)}]},{name:"name label",fontColor:Yc.Color.white},{name:"user menu",position:Yc.pt(15,40),scale:.8,opacity:0,borderColor:Yc.Color.rgb(202,207,210),borderRadius:5,borderWidth:1,dropShadow:new Yc.ShadowObject({distance:7,rotation:75,color:Yc.Color.rgba(0,0,0,.11),blur:20,fast:!1}),extent:Yc.pt(146.3,70.9),fill:Yc.Color.rgb(253,254,254),isLayoutable:!1,origin:Yc.pt(121.7,-4.7),visible:!1},{name:"avatar",imageUrl:"https://s.gravatar.com/avatar/81fca83dcbbab5d52e990f7b76aa97ca?s=160"}]})},
{module:"lively.ide/studio/top-bar.cp.js","export":"DarkUserFlap",range:{start:35993,end:37013}},Yc.DarkUserFlap);Yc.ProfileItem=Yc.component["for"](function(){return Yc.component({type:Yc.Text,name:"profile item",borderColor:Yc.Color.rgb(204,204,204),extent:Yc.pt(144,28.8),fill:Yc.Color.rgba(0,0,0,0),fixedHeight:!0,fixedWidth:!0,fontFamily:"IBM Plex Sans",fontSize:16,nativeCursor:"pointer",padding:Yc.rect(10,3,-5,0),position:Yc.pt(19.9,35.6),textString:"Profile",readOnly:!0,selectable:!1})},{module:"lively.ide/studio/top-bar.cp.js",
"export":"ProfileItem",range:{start:37021,end:37422}},Yc.ProfileItem);Yc.ProfileItemSelected=Yc.component["for"](function(){return Yc.component(Yc.ProfileItem,{name:"profile item selected",fill:Yc.Color.rgb(215,219,221)})},{module:"lively.ide/studio/top-bar.cp.js","export":"ProfileItemSelected",range:{start:37468,end:37583}},Yc.ProfileItemSelected);Yc.UserMenu=Yc.component["for"](function(){return Yc.component({name:"user menu",borderColor:Yc.Color.rgb(202,207,210),borderRadius:5,borderWidth:1,dropShadow:new Yc.ShadowObject({distance:7,
rotation:75,color:Yc.Color.rgba(0,0,0,.11),blur:20,fast:!1}),extent:Yc.pt(146.3,70.9),fill:Yc.Color.rgb(253,254,254),isLayoutable:!1,origin:Yc.pt(121.7,-4.7),position:Yc.pt(330.1,33.2),submorphs:[{type:Yc.Polygon,name:"menu shape",borderColor:Yc.Color.rgb(202,207,210),borderWidth:1,extent:Yc.pt(20.2,10.4),fill:Yc.Color.rgb(253,254,254),isLayoutable:!1,position:Yc.pt(-10.5,-5.4),vertices:[{position:Yc.pt(0,10),isSmooth:!1,controlPoints:{next:Yc.pt(0,0),previous:Yc.pt(0,0)}},{position:Yc.pt(10,0),isSmooth:!1,
controlPoints:{next:Yc.pt(0,0),previous:Yc.pt(0,0)}},{position:Yc.pt(20,10),isSmooth:!1,controlPoints:{next:Yc.pt(0,0),previous:Yc.pt(0,0)}}]},{name:"item container",layout:new Yc.TilingLayout({axis:"column",orderByIndex:!0,wrapSubmorphs:!1}),position:Yc.pt(-120.6,10.9),clipMode:"hidden",draggable:!0,extent:Yc.pt(144.2,65),fill:Yc.Color.rgba(46,75,223,0),grabbable:!0,submorphs:[Yc.part(Yc.ProfileItem,{name:"profile item",master:{auto:Yc.ProfileItem,hover:Yc.ProfileItemSelected}}),Yc.part(Yc.ProfileItem,
{name:"login item",textString:"Sign in",master:{auto:Yc.ProfileItem,hover:Yc.ProfileItemSelected}}),Yc.part(Yc.ProfileItem,{name:"logout item",textString:"Sign out",master:{auto:Yc.ProfileItem,hover:Yc.ProfileItemSelected}}),Yc.part(Yc.ProfileItem,{name:"register item",textString:"Create Account",master:{auto:Yc.ProfileItem,hover:Yc.ProfileItemSelected}})]}]})},{module:"lively.ide/studio/top-bar.cp.js","export":"UserMenu",range:{start:37618,end:39699}},Yc.UserMenu);Yc.TopBar=Yc.component["for"](function(){return Yc.component({name:"top bar",
layout:new Yc.TilingLayout({justifySubmorphs:"spaced",orderByIndex:!0,wrapSubmorphs:!1,padding:Yc.Rectangle.inset(10,0,10,0)}),defaultViewModel:Yc.TopBarModel,dropShadow:new Yc.ShadowObject({color:Yc.Color.rgba(0,0,0,.31),blur:20}),extent:Yc.pt(929.1,49.7),fill:new Yc.LinearGradient({stops:[{offset:0,color:Yc.Color.white},{offset:1,color:Yc.Color.rgb(229,231,233)}],vector:Yc.rect(0,0,0,1)}),submorphs:[{name:"horizontal layout",extent:Yc.pt(476.8,51.1),fill:Yc.Color.rgba(46,75,223,0),layout:new Yc.HorizontalLayout({align:"bottom",
autoResize:!1,direction:"leftToRight",orderByIndex:!0,padding:{height:0,width:0,x:13,y:13},reactToSubmorphAnimations:!1,renderViaCSS:!0,resizeSubmorphs:!1,spacing:13}),submorphs:[Yc.part(Yc.TopBarButton,{name:"undo button",textAndAttributes:Yc.Icon.textAttribute("reply"),tooltip:"Undo"}),Yc.part(Yc.TopBarButton,{name:"redo button",textAndAttributes:Yc.Icon.textAttribute("share"),tooltip:"Redo"}),Yc.part(Yc.TopBarButton,{name:"save button",padding:Yc.rect(0,1,16,-1),textAndAttributes:Yc.Icon.textAttribute("save"),
tooltip:"Save World"}),Yc.part(Yc.TopBarButton,{name:"halo mode button",padding:Yc.rect(0,0,3,0),textAndAttributes:Yc.Icon.textAttribute("mouse-pointer"),tooltip:"Halo mode"}),Yc.part(Yc.TopBarButton,{name:"hand mode button",textAndAttributes:Yc.Icon.textAttribute("hand-paper"),tooltip:"Interaction mode"}),Yc.part(Yc.TopBarButton,{name:"text mode button",textAndAttributes:Yc.Icon.textAttribute("font"),tooltip:"Create textbox mode"}),{name:"shape mode button",extent:Yc.pt(55.8,24.7),fill:Yc.Color.rgba(46,
75,223,0),layout:new Yc.HorizontalLayout({align:"center",autoResize:!1,direction:"leftToRight",padding:{height:0,width:0,x:5,y:5},resizeSubmorphs:!1,spacing:5}),nativeCursor:"pointer",submorphs:[Yc.part(Yc.TopBarButton,{name:"shape status icon",reactsToPointer:!1,textAndAttributes:Yc.Icon.textAttribute("square"),tooltip:"Create basic shape mode"}),Yc.part(Yc.TopBarButton,{name:"select shape type",fontSize:23,nativeCursor:"pointer",textAndAttributes:Yc.Icon.textAttribute("angle-down")})],tooltip:"Select different shape"},
Yc.part(Yc.TopBarButton,{name:"open component browser",fontSize:25,padding:Yc.rect(3,0,-3,0),textAndAttributes:Yc.Icon.textAttribute("cubes"),tooltip:"Browse master components"}),Yc.part(Yc.TopBarButton,{name:"load world button",padding:Yc.rect(3,0,-3,0),textAndAttributes:Yc.Icon.textAttribute("globe"),tooltip:"Load other project"}),Yc.part(Yc.TopBarButton,{name:"comment browser button",padding:Yc.rect(3,10,-3,-9),textAndAttributes:Yc.Icon.textAttribute("comment-alt"),tooltip:"Toggle Comment Browser"})]},
{name:"ipad status bar",isLayoutable:!1,borderColor:Yc.Color.rgba(0,0,0,0),extent:Yc.pt(929.2,26),fill:Yc.Color.rgb(0,0,0),position:Yc.pt(0,-26)},Yc.part(Yc.UserFlap,{name:"user flap",fill:Yc.Color.transparent})]})},{module:"lively.ide/studio/top-bar.cp.js","export":"TopBar",range:{start:39762,end:43451}},Yc.TopBar);Rh=bd("D",Yc.DarkUserFlap);dh=Yc.UserFlap;eh=Yc.TopBar;Rg=Yc.ProfileItem;qa=Yc.ProfileItemSelected;O=Yc.UserMenu;Yc.DarkUserFlap=Rh;Yc.UserFlap=dh;Yc.TopBar=eh;Yc.ProfileItem=Rg;Yc.ProfileItemSelected=
qa;Yc.UserMenu=O;Ge=Object.freeze({__proto__:null,FastLoadToggler:Ge,TopBarModel:Se,UserFlapModel:mh,DarkUserFlap:Rh,UserFlap:dh,TopBar:eh,ProfileItem:Rg,ProfileItemSelected:qa,UserMenu:O});bd("t",Ge)}}});
System.register(["./__root_module__-f418f9fd.js","lively.collab","kld-intersections"],function(Ha){var tb,Ab,kc,ac,Ld,Tc,$d,Uc,Pc,Jd,pe,Ze,Ff;return{setters:[function(te){tb=te.bp;Ab=te.a6;kc=te.r;ac=te.a8;Ld=te.$;Tc=te.bq;$d=te.br;Uc=te.T;Pc=te.a7;Jd=te.bs;pe=te.bt;Ze=te.l;Ff=te.bu},function(){},function(){}],execute:function(){function te(ha){try{var Pa=eval("("+Bb.ast.transform.wrapInFunction("var _; _ = ("+ha+")")+")()")}catch(T){return JSON.parse(ha)}return"object"!==typeof Pa?null:Pa}function Bc(ha,
Pa){var T,ia,Fa,$a,zb,Cc,Ba,Ca,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){switch(Ec.nextAddress){case 1:return T=Pa.world(),Ec.yield(T.prompt("Enter package name",{requester:Pa,input:"",historyId:"lively.vm-editor-add-package-name",useLastInput:!0}),2);case 2:ia=Ec.yieldResult;if(!ia)throw"Canceled";Ec.setCatchFinallyBlocks(3);$a=Va.resource(ia);ia=$a.name();Fa=$a.url;Ec.leaveTryBlock(4);break;case 3:return Ec.enterCatchBlock(),Ec.yield(ha.getConfig(),5);case 5:return zb=Ec.yieldResult.baseURL,
Cc=Va.resource(zb).join(ia).asDirectory().url,Ec.yield(ha.normalize(Cc),6);case 6:Fa=Ec.yieldResult.replace(/\/\.js$/,"/");case 4:return Ec.yield(T.prompt("Confirm or change package location",{requester:Pa,input:Fa,historyId:"lively.vm-editor-add-package-address"}),7);case 7:Ba=Ec.yieldResult;if(!Ba)throw"Canceled";Ca=Va.resource(Ba).asDirectory();Nb=Ca.asFile().url;return Ec.yield(ha.removePackage(Nb),8);case 8:return Ec.yield(ha.resourceCreateFiles(Nb,{"index.js":"'format esm';\n","package.json":'{\n  "name": "'+
ia+'",\n  "version": "0.1.0"\n}',".gitignore":"node_modules/","README.md":"# "+ia+"\n\nNo description for package "+ia+" yet.\n",tests:{"test.js":'import { expect } from "mocha-es6";\ndescribe("'+ia+'", () => {\n  it("works", () => {\n    expect(1 + 2).equals(3);\n  });\n});'}}),9);case 9:return Ec.return(Va.loadPackage(ha,{name:ia,address:Nb,configFile:Ca.join("package.json").url,main:Ca.join("index.js").url,test:Ca.join("tests/test.js").url,type:"package"}))}})}function sd(ha,Pa,T){T=void 0===T?
null:T;var ia,Fa,$a,zb,Cc,Ba,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){switch(Nb.nextAddress){case 1:return ia={name:"",address:"",type:"package"},Nb.yield(ha.getConfig(),2);case 2:Fa=Nb.yieldResult;if(!T){Nb.jumpTo(3);break}return Nb.yield(ha.getPackage(T),4);case 4:if($a=Nb.yieldResult){Nb.jumpTo(5);break}return Nb.yield(ha.getPackageForModule(T),6);case 6:$a=Nb.yieldResult;case 5:zb=$a;case 3:return Nb.yield(Pa.world().prompt("What is the package directory?",{requester:Pa,
input:zb?zb.address:Fa.baseURL,historyId:"lively.vm-editor-package-load-history",useLastInput:!1}),7);case 7:Cc=Nb.yieldResult;if(!Cc)throw"Canceled";ia.address=Cc.replace(/\/$/,"");ia.url=new URL(ia.address+"/");ia.configFile=Va.resource(ia.url).join("package.json").url;Nb.setCatchFinallyBlocks(8);Ba=JSON;Ca=Ba.parse;return Nb.yield(ha.moduleRead(ia.configFile),10);case 10:Ca.call(Ba,Nb.yieldResult).name;Nb.leaveTryBlock(9);break;case 8:Nb.enterCatchBlock(),ia.name=String(ia.url).replace(/\/$/,""),
ha.resourceEnsureExistance(ia.configFile,'{\n  "name": "'+ia.name+'",\n  "version": "0.1.0"\n}');case 9:return Nb.return(Va.loadPackage(ha,ia))}})}function le(ha,Pa,T){var ia,Fa,$a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:return ia=Va.resource(T).asFile().url,zb.yield(ha.getPackage(ia),2);case 2:if(Fa=zb.yieldResult){zb.jumpTo(3);break}return zb.yield(ha.getPackageForModule(ia),4);case 4:Fa=zb.yieldResult;case 3:$a=Fa;if(!$a)throw Error("Cannot find package for "+
ia);return zb.yield(ha.reloadPackage(ia),5);case 5:if(!Pa){zb.jumpTo(0);break}return zb.yield(Pa.updateModuleList(),7);case 7:return zb.yield(Pa.uiSelect(ia,!1),8);case 8:return zb.return(zb.yieldResult)}})}function jc(ha,Pa,T,ia){var Fa,$a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:return zb.yield(ha.getPackage(T),2);case 2:return Fa=zb.yieldResult,zb.yield((ia||$world).confirm("Unload package "+Fa.name+"?",{requester:Pa}),3);case 3:$a=zb.yieldResult;
if(!$a)throw"Canceled";return zb.yield(ha.removePackage(T),4);case 4:if(!Pa){zb.jumpTo(0);break}return zb.yield(Pa.updateModuleList(),6);case 6:return zb.yield(Pa.uiSelect(null),0)}})}function je(ha,Pa,T){var ia,Fa,$a,zb,Cc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ba){switch(Ba.nextAddress){case 1:return ia=Pa.world(),Ba.yield(ha.getPackage(T),2);case 2:return Fa=Ba.yieldResult,Fa?Ba.yield(ia.confirm("Really remove package "+Fa.name+"?",{requester:Pa}),3):($world.inform('No package "'+
T+'" found!',{requester:Pa}),Ba.return());case 3:$a=Ba.yieldResult;if(!$a)throw"Canceled";ha.removePackage(T);return Ba.yield(ia.confirm("Also remove directory "+Fa.name+" including "+Fa.modules.length+" modules?"),4);case 4:zb=Ba.yieldResult;if(!zb){Ba.jumpTo(0);break}return Ba.yield(ia.confirm("REALLY *remove* directory "+Fa.name+"? No undo possible..."),6);case 6:if(Cc=Ba.yieldResult)return Ba.yield(ha.resourceRemove(Fa.address),0);Ba.jumpTo(0)}})}function Ae(ha,Pa,T){T=void 0===T?$world:T;var ia,
Fa,$a,zb,Cc,Ba,Ca,Nb,Ec,fb,td;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xd){switch(Xd.nextAddress){case 1:return Xd.yield(ha.getPackage(Pa),2);case 2:ia=Xd.yieldResult;if(!ia)throw Error("Cannot find package "+Pa);Fa=[];$a=$jscomp.makeIterator(ia.modules);zb=$a.next();case 3:if(zb.done)return Xd.yield(T.execCommand("open text window",{title:"imports and exports of "+Pa,content:Fa.join("\n\n")}),0);Cc=zb.value;if(!Cc.name.match(/\.js$/)){Xd.jumpTo(4);break}Xd.setCatchFinallyBlocks(6);
Ba=ha;Ca=Ba.importsAndExportsOf;Nb=Cc.name;return Xd.yield(ha.moduleRead(Cc.name),9);case 9:return Xd.yield(Ca.call(Ba,Nb,Xd.yieldResult),8);case 8:Ec=Xd.yieldResult;Xd.leaveTryBlock(7);break;case 6:fb=Xd.enterCatchBlock();T.logError(Error("Error when getting imports/exports from module "+Cc.name+":\n"+fb.stack));Xd.jumpTo(4);break;case 7:td=""+Cc.name;if(!Ec.imports.length&&!Ec.exports.length){td+="\n  does not import / export anything";Xd.jumpTo(4);break}Ec.imports.length&&(td+="\n  imports:\n",
td+=Va.arr.groupByKey(Ec.imports,"fromModule").mapGroups(function(ae,Bf){return"from "+ae+": "+Bf.map(function(ie){return ie.local||ie.imported?ie.imported&&ie.imported!==ie.local?ie.imported+" as "+ie.local:ie.local:"nothing imported"}).join(", ")}).toArray().join("\n").split("\n").map(function(ae){return"    "+ae}).join("\n"));Ec.exports.length&&(td+="\n  exports:\n",td+=Ec.exports.map(function(ae){return ae.local?ae.local&&ae.local!==ae.exported?ae.local+" as "+ae.exported:ae.exported:ae.exported+
" from "+ae.fromModule}).join(", ").split("\n").map(function(ae){return"    "+ae}).join("\n"));Fa.push(td);case 4:zb=$a.next(),Xd.jumpTo(3)}})}function Dc(ha){return ha.match(/import.*['"]mocha(-es6)?['"]/)&&ha.match(/it\(['"]/)}function Mc(ha,Pa,T){T=T&&T.address;if(T&&0===Pa.indexOf(T))var ia=Pa.slice(T.length).replace(/^\//,"");else a:{T=ha.getConfig();if(!T||T.constructor!==Promise)try{ia=String((new Ta.URL(Pa)).relativePathFrom(new Ta.URL(ha.getConfig().baseURL)));break a}catch(Fa){}ia=Pa}return ia}
function bc(ha,Pa,T,ia){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){return 1==Fa.nextAddress?(ia=Object.assign({targetModule:Pa},ia),Fa.yield(ha.normalize(Pa),2)):3!=Fa.nextAddress?(Pa=Fa.yieldResult,Fa.yield(ha.moduleSourceChange(Pa,T,ia),3)):Fa.return(Pa)})}function Gc(ha,Pa,T,ia,Fa){ia=void 0===ia?!1:ia;Fa=void 0===Fa?!1:Fa;var $a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:return Pa&&Pa.setStatusMessage("Reloading "+T),zb.setCatchFinallyBlocks(2),
zb.yield(ha.reloadModule(T,{reloadDeps:ia,resetEnv:Fa}),4);case 4:if(!Pa){zb.jumpTo(5);break}return zb.yield(Pa.updateModuleList(),6);case 6:case 5:Pa&&Pa.setStatusMessage("Reloded "+T);zb.leaveTryBlock(0);break;case 2:$a=zb.enterCatchBlock();zb.setCatchFinallyBlocks(7);if(!Pa){zb.jumpTo(9);break}return zb.yield(Pa.updateEditorWithSourceOf(T),10);case 10:case 9:zb.leaveTryBlock(8);break;case 7:zb.enterCatchBlock();case 8:throw Pa&&Pa.showError($a),$a;}})}function Zc(ha,Pa,T){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ia){switch(ia.nextAddress){case 1:return ia.yield(ha.forgetModule(T,
{forgetEnv:!0,forgetDeps:!0}),2);case 2:if(!Pa){ia.jumpTo(3);break}return ia.yield(Pa.updateModuleList(),4);case 4:case 3:ia.jumpToEnd()}})}function Rd(ha,Pa,T){var ia,Fa,$a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:return zb.yield(ha.normalize(T),2);case 2:return ia=zb.yieldResult,zb.yield(Pa.world().confirm("Remove file "+ia+"?",{requester:Pa}),3);case 3:Fa=zb.yieldResult;if(!Fa)throw"Canceled";return zb.yield(ha.forgetModule(ia),4);case 4:return zb.yield(ha.resourceRemove(ia),
5);case 5:return zb.yield(ha.getPackageForModule(ia),6);case 6:return $a=zb.yieldResult,zb.return($a)}})}function Kd(ha,Pa,T){var ia,Fa,$a,zb,Cc,Ba,Ca,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){switch(Ec.nextAddress){case 1:return ia=Ta.URL,Ec.yield(ha.getConfig(),2);case 2:Fa=new ia(Ec.yieldResult.baseURL);$a=Pa.world();if(!T){Ec.jumpTo(3);break}return Ec.yield(ha.getPackage(T),4);case 4:if(zb=Ec.yieldResult){Ec.jumpTo(5);break}return Ec.yield(ha.getPackageForModule(T),6);
case 6:zb=Ec.yieldResult;case 5:(Cc=zb)&&(Fa=new Ta.URL(Cc.address));case 3:return Ec.yield(Ta._searchForExistingFiles(Pa,String(Fa),Cc),7);case 7:Ba=Ec.yieldResult;if(!Ba.includes("[create new module]")){Ec.jumpTo(8);break}return Ec.yield(Ta._askForModuleName(ha,T||String(Fa),$a),9);case 9:Ca=Ec.yieldResult,Ba=[Ca];case 8:return Ec.yield(Ta._createAndLoadModules(ha,Ba),10);case 10:return Nb=Ec.yieldResult,Ta.arr.compact(Nb.map(function(fb){return fb.error})),Ec.return(Nb)}})}function rb(ha,Pa){var T,
ia,Fa,$a,zb,Cc,Ba,Ca,Nb,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fb){if(1==fb.nextAddress)return fb.yield(ha.getPackage(Pa),2);if(3!=fb.nextAddress){T=fb.yieldResult;if(!T||!T.address.match(/^http/))throw Error("Cannot load package "+Pa);ia=Ta.resource(T.address);Fa=[];$a=$jscomp;zb=$a.makeIterator;return fb.yield(ia.dirList(5,{exclude:Ta.modulesInPackage_defaultExclude}),3)}Cc=zb.call($a,fb.yieldResult);for(Ba=Cc.next();!Ba.done;Ba=Cc.next())Nb=Ca=Ba.value,Ec=Nb.url,Ec.match(/\.js$/)&&
ha.isModuleLoaded(Ec,!0)&&Fa.push(ha.getModule(Ec));return fb.return(Fa)})}function ob(ha){ha||(ha="local");if(ha.isSystemInterface)var Pa=ha;else"string"===typeof ha&&ha.startsWith("l2l ")&&(ha={type:"l2l",id:ha.split(" ")[1]}),"string"!==typeof ha&&"l2l"===ha.type&&(Pa=kb.l2lInterfaceFor(ha.id,ha.info)),"string"!==typeof ha&&($world.setStatusMessage("Unknown system interface "+ha),ha="local"),Pa||(Pa=ha&&"local"!==ha?kb.serverInterfaceFor(ha):kb.localInterface);return Pa}Ha("systemInterfaceNamed",
ob);var Bb=lively.FreezerRuntime.recorderFor("lively-system-interface/helpers.js");Bb.parseJsonLikeObj=te;Bb.ast=tb;Bb.parseJsonLikeObj=te;Bb.parseJsonLikeObj=te;var Va=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/packages.js");Va.loadPackage=function(ha,Pa){var T,ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return Fa.yield(ha.importPackage(Pa.address+"/"),2);case 2:if(!Pa.main){Fa.jumpTo(3);break}return Fa.yield(ha.importModule(Pa.main.toString()),
3);case 3:if(!Pa.test){Fa.jumpTo(5);break}Fa.setCatchFinallyBlocks(6);return Fa.yield(ha.importPackage("mocha-es6"),8);case 8:return T=Fa.yieldResult,Fa.yield(T.installSystemInstantiateHook(),9);case 9:return Fa.yield(ha.importModule(Pa.test.toString()),10);case 10:Fa.leaveTryBlock(5);break;case 6:ia=Fa.enterCatchBlock(),console.warn("Cannot load test of new package: "+ia);case 5:return Fa.return(ha.getPackage(Pa.address))}})};Va.interactivelyCreatePackage=Bc;Va.interactivelyLoadPackage=sd;Va.interactivelyReloadPackage=
le;Va.interactivelyUnloadPackage=jc;Va.interactivelyRemovePackage=je;Va.showExportsAndImportsOf=Ae;Va.parseJsonLikeObj=te;Va.arr=Ab;Va.resource=kc;Va.interactivelyCreatePackage=Bc;Va.interactivelyCreatePackage=Bc;Va.interactivelyLoadPackage=sd;Va.interactivelyLoadPackage=sd;Va.interactivelyReloadPackage=le;Va.interactivelyReloadPackage=le;Va.interactivelyUnloadPackage=jc;Va.interactivelyUnloadPackage=jc;Va.interactivelyRemovePackage=je;Va.interactivelyRemovePackage=je;Va.showExportsAndImportsOf=Ae;
Va.showExportsAndImportsOf=Ae;var Ta=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/modules.js");Ta.isTestModule=Dc;Ta.shortModuleName=Mc;Ta.interactivelyChangeModule=bc;Ta.interactivelyReloadModule=Gc;Ta.interactivelyUnloadModule=Zc;Ta.interactivelyRemoveModule=Rd;Ta.interactivelyAddModule=Kd;Ta._askForModuleName=function(ha,Pa,T){var ia,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){switch($a.nextAddress){case 1:return $a.yield(T.prompt("Enter module name",
{input:Pa,historyId:"lively.vm-editor-add-module-name"}),2);case 2:Pa=$a.yieldResult;if(!Pa)throw"Canceled";return $a.yield(ha.normalize(Pa),3);case 3:return ia=$a.yieldResult,$a.yield(T.confirm(["Create module \n",{},ia,{fontStyle:"italic"}," ?",{}],{lineWrapping:!1}),4);case 4:Fa=$a.yieldResult;if(!Fa)throw"Canceled";return $a.return(ia)}})};Ta._searchForExistingFiles=function(ha,Pa,T){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ia){return String(Pa).match(/^http/)?ia.return(Ta._searchForExistingFilesWeb(ha,
Pa,T)):ia.return(Ta._searchForExistingFilesManually(ha,Pa,T))})};Ta._searchForExistingFilesManually=function(ha,Pa,T){var ia,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){switch($a.nextAddress){case 1:return $a.yield(ha.world().multipleChoicePrompt("Add Module",{requester:ha,choices:["Create New Module","Load Existing Module"]}),2);case 2:ia=$a.yieldResult;if("Create New Module"===ia)return $a.return("[create new module]");if("Load Existing Module"!==ia){$a.jumpTo(3);break}return $a.yield(ha.world().prompt("URL of module?",
{input:Pa,requester:ha,historyId:"lively.vm._searchForExistingFilesManually.url-of-module"}),4);case 4:if(Fa=$a.yieldResult)return $a.return([Fa]);case 3:throw"Canceled";}})};Ta._searchForExistingFilesWeb=function(ha,Pa,T){function ia(Nb){Nb.name();return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes(Nb.name())||T&&Ta.arr.pluck(T.modules,"name").includes(Nb.url)?!0:!1}var Fa,$a,zb,Cc,Ba,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){switch(Nb.nextAddress){case 1:return(Fa=
ha.world())&&($a=Fa.showLoadingIndicatorFor(ha,"Loading existing modules...")),Nb.yield(Ta.resource(Pa).dirList(5,{exclude:ia}),3);case 3:return Nb.yield(Nb.yieldResult.map(function(Ec){return Ec.url}),2);case 2:return zb=Nb.yieldResult,Cc=[{isListItem:!0,string:"[create new module]",value:"[create new module]"}].concat(zb.filter(function(Ec){return Ec.endsWith(".js")}).map(function(Ec){return{isListItem:!0,string:T&&0==Ec.indexOf(T.address)?T.name+Ec.slice(T.address.length):Ec,value:Ec}})),Nb.yield(Promise.resolve($a&&
$a.remove()).then(function(){return ha.world().filterableListPrompt("What module to load?",Cc,Object.assign({filterLabel:"filter: ",multiselect:!0,requester:ha},ha?{extent:ha.bounds().extent().withY(400).subXY(50,0)}:{}))}),4);case 4:Ba=Nb.yieldResult;if(!Ba||"canceled"===Ba.status||!Ba.selected.length)throw"Canceled";Ca=Ba.selected||Ba;Array.isArray(Ca)||(Ca=[Ca]);return Nb.return(Ca)}})};Ta._createAndLoadModules=function(ha,Pa){var T,ia,Fa,$a,zb,Cc,Ba,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){switch(Nb.nextAddress){case 1:Array.isArray(Pa)||
(Pa=[Pa]),T=[],ia=$jscomp.makeIterator(Pa),Fa=ia.next();case 2:if(Fa.done){Nb.jumpTo(4);break}$a=Fa.value;return Nb.yield(ha.forgetModule($a,{forgetDeps:!1,forgetEnv:!1}),5);case 5:return Nb.yield(ha.resourceEnsureExistance($a,'"format esm";\n'),6);case 6:return zb=Nb.yieldResult,Cc=Ta,Ba=Cc.isTestModule,Nb.yield(zb.read(),7);case 7:if(!Ba.call(Cc,Nb.yieldResult)){Nb.jumpTo(8);break}if(window.Mocha&&window.chai){Nb.jumpTo(8);break}return Nb.yield(System.import("mocha-es6"),10);case 10:return Nb.yield(Ta.promise.waitFor(function(){return!!window.Mocha&&
!!window.chai}),8);case 8:return Nb.setCatchFinallyBlocks(12),Nb.yield(ha.importModule($a),14);case 14:T.push({name:$a});Nb.leaveTryBlock(3);break;case 12:Ca=Nb.enterCatchBlock(),T.push({name:$a,error:Ca});case 3:Fa=ia.next();Nb.jumpTo(2);break;case 4:return Nb.return(T)}})};Ta.modulesInPackage_defaultExclude=function(ha){return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes(ha.name())?!0:!1};Ta.modulesInPackage=rb;Ta.obj=ac;Ta.promise=Ld;Ta.arr=Ab;Ta.resource=kc;Ta.isTestModule=
Dc;Ta.isTestModule=Dc;Ta.shortModuleName=Mc;Ta.shortModuleName=Mc;Ta.interactivelyChangeModule=bc;Ta.interactivelyChangeModule=bc;Ta.interactivelyReloadModule=Gc;Ta.interactivelyReloadModule=Gc;Ta.interactivelyUnloadModule=Zc;Ta.interactivelyUnloadModule=Zc;Ta.interactivelyRemoveModule=Rd;Ta.interactivelyRemoveModule=Rd;Ta.interactivelyAddModule=Kd;Ta.interactivelyAddModule=Kd;Ta.modulesInPackage=rb;Ta.modulesInPackage=rb;var xa=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/interface.js");
xa.todo=function(ha){throw Error(ha+" is not yet implemented!");};xa.parseJsonLikeObj=te;xa.arr=Ab;xa.Closure=Tc;xa.obj=ac;xa.resource=kc;xa.transform=$d;xa.modules=Uc;var wa=function(){};wa.prototype.dynamicCompletionsForPrefix=function(ha,Pa,T){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ia){xa.todo("dynamicCompletionsForPrefix");ia.jumpToEnd()})};wa.prototype.runEval=function(ha,Pa){xa.todo("runEval")};wa.prototype.resourceExists=function(ha){xa.todo("resourceExists")};wa.prototype.resourceEnsureExistance=
function(ha,Pa){xa.todo("resourceEnsureExistance")};wa.prototype.resourceMkdir=function(ha){xa.todo("resourceMkdir")};wa.prototype.resourceRead=function(ha){xa.todo("resourceRead")};wa.prototype.resourceRemove=function(ha){xa.todo("resourceRemove")};wa.prototype.resourceWrite=function(ha,Pa){xa.todo("resourceWrite")};wa.prototype.resourceCreateFiles=function(ha,Pa){xa.todo("resourceCreateFiles")};wa.prototype.resourceDirList=function(ha,Pa,T){xa.todo("resourceDirList")};wa.prototype.normalizeSync=
function(ha,Pa,T){xa.todo("normalizeSync")};wa.prototype.normalize=function(ha,Pa,T){xa.todo("normalize")};wa.prototype.printSystemConfig=function(){xa.todo("printSystemConfig")};wa.prototype.getConfig=function(){xa.todo("getConfig")};wa.prototype.setConfig=function(ha){xa.todo("setConfig")};wa.prototype.getPackages=function(ha){xa.todo("getPackages")};wa.prototype.isModuleLoaded=function(ha,Pa){xa.todo("isModuleLoaded")};wa.prototype.doesModuleExist=function(ha,Pa){xa.todo("doesModuleExist")};wa.prototype.getModules=
function(){var ha=this,Pa,T;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ia){return 1==ia.nextAddress?(Pa=xa.arr,T=Pa.flatmap,ia.yield(ha.getPackages(),2)):ia.return(T.call(Pa,ia.yieldResult,function(Fa){return Fa.modules}))})};wa.prototype.getModule=function(ha){var Pa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){return 1==T.nextAddress?T.yield(Pa.getModules(),2):T.return(T.yieldResult.find(function(ia){return ia.name===ha}))})};wa.prototype.getPackage=function(ha){var Pa=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){return 1==T.nextAddress?(ha=ha.replace(/\/+$/,""),T.yield(Pa.getPackages(),2)):T.return(T.yieldResult.find(function(ia){return ia.address===ha||ia.name===ha}))})};wa.prototype.getPackageForModule=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){xa.todo("getPackageForModule");Pa.jumpToEnd()})};wa.prototype.systemConfChange=function(ha){var Pa=xa.parseJsonLikeObj(ha);["baseURL"].forEach(function(T){return delete Pa[T]});
return this.setConfig(Pa)};wa.prototype.resourcesOfPackage=function(ha,Pa){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){xa.todo("resourcesOfPackage");T.jumpToEnd()})};wa.prototype.registerPackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){xa.todo("registerPackage");Pa.jumpToEnd()})};wa.prototype.importPackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){xa.todo("importPackage");Pa.jumpToEnd()})};wa.prototype.removePackage=
function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){xa.todo("removePackage");Pa.jumpToEnd()})};wa.prototype.reloadPackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){xa.todo("reloadPackage");Pa.jumpToEnd()})};wa.prototype.packageConfChange=function(ha,Pa){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){xa.todo("packageConfChange");T.jumpToEnd()})};wa.prototype.importModule=function(ha){xa.todo("importModule")};wa.prototype.forgetModule=
function(ha,Pa){xa.todo("forgetModule")};wa.prototype.reloadModule=function(ha,Pa){xa.todo("reloadModule")};wa.prototype.moduleFormat=function(ha){xa.todo("moduleFormat")};wa.prototype.moduleRead=function(ha){xa.todo("moduleRead")};wa.prototype.moduleSourceChange=function(ha,Pa,T){xa.todo("moduleSourceChange")};wa.prototype.importsAndExportsOf=function(ha,Pa){xa.todo("importsAndExportsOf")};wa.prototype.keyValueListOfVariablesInModule=function(ha,Pa){xa.todo("keyValueListOfVariablesInModule")};wa.prototype.moduleWrite=
function(ha,Pa){return this.moduleSourceChange(ha,Pa)};xa.AbstractCoreInterface=wa;var Qa=function(){var ha=xa.AbstractCoreInterface.call(this)||this;ha.currentEval=null;return ha};$jscomp.inherits(Qa,xa.AbstractCoreInterface);Qa.prototype.runEval=function(ha,Pa){throw Error("Not yet implemented");};Qa.prototype.runEvalAndStringify=function(ha,Pa){var T=this;return this.currentEval?this.currentEval.then(function(){return T.runEvalAndStringify(ha,Pa)}):this.currentEval=Promise.resolve().then(function(){var ia,
Fa,$a,zb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cc){switch(Cc.nextAddress){case 1:return Cc.yield(T.runEval("\n        Promise.resolve((async "+xa.transform.wrapInFunction(ha)+')())\n          .then(function(result) { return JSON.stringify(result); })\n          .catch(function(err) { return {isError: true, value: err}; })\n          .then(function(result) {\n            if (!result || typeof result === "string") return result;\n            return JSON.stringify(result.isError ?\n              {isError: true, value: (result.value + "\\n" + result.value.stack) || String(result.value)} :\n              result)\n          });',
Object.assign({targetModule:"lively://remote-lively-system/runEvalAndStringify",promiseTimeout:3E4,waitForPromise:!0},Pa)),2);case 2:if((ia=Cc.yieldResult)&&ia.isError)throw Error(String(ia.value||ia.error));if(!ia||!ia.value)return Cc.return(null);if(Fa=ia.promisedValue){Cc.jumpTo(3);break}return Cc.yield(ia.value,4);case 4:Fa=Cc.yieldResult;case 3:$a=Fa;if(!$a)return Cc.return();if("undefined"===$a)return Cc.return(void 0);if("null"===$a)return Cc.return(null);if("true"===$a)return Cc.return(!0);
if("false"===$a)return Cc.return(!1);try{zb=JSON.parse($a)}catch(Ba){return Cc.return($a)}if(zb&&zb.isError)throw Error(String(zb.value));return Cc.return(zb)}})}).then(function(ia){delete T.currentEval;return ia},function(ia){delete T.currentEval;return Promise.reject(ia)})};Qa.prototype.dynamicCompletionsForPrefix=function(ha,Pa,T){var ia=this,Fa,$a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){Fa=xa.obj.isString(T.context)?T.context:!1;T=xa.obj.dissoc(T,["systemInterface","System",
"context"]);$a="\n      var prefix = "+JSON.stringify(Pa)+",\n          opts = "+JSON.stringify(T)+";\n      opts.context = "+Fa+';\n      opts.classTransform = (await System.import("lively.classes")).classToFunctionTransform;\n      var evalFn = code => lively.vm.runEval(code, opts);\n      if (typeof System === "undefined") delete opts.targetModule;\n      lively.vm.completions.getCompletions(evalFn, prefix).then(function(result) {\n        if (result.isError) throw result.value;\n        return {\n          completions: result.completions,\n          prefix: result.startLetters\n        }\n      });';
return zb.return(ia.runEvalAndStringify($a))})};Qa.prototype.evalWithResource=function(ha,Pa,T){return this.runEvalAndStringify('\n      var {resource} = (typeof lively !== "undefined" && lively.resources)\n                    || await System.import("lively.resources");\n      await resource("'+ha+'").'+Pa+"("+(T?JSON.stringify(T):"")+");\n    ")};Qa.prototype.resourceExists=function(ha){return this.evalWithResource(ha,"exists")};Qa.prototype.resourceEnsureExistance=function(ha,Pa){return this.evalWithResource(ha,
"ensureExistance",Pa)};Qa.prototype.resourceMkdir=function(ha){return this.evalWithResource(ha,"mkdir")};Qa.prototype.resourceRead=function(ha){return this.evalWithResource(ha,"read")};Qa.prototype.resourceRemove=function(ha){return this.evalWithResource(ha,"remove")};Qa.prototype.resourceWrite=function(ha,Pa){return this.evalWithResource(ha,"write",Pa)};Qa.prototype.resourceCreateFiles=function(ha,Pa){return this.runEvalAndStringify('var {createFiles} = await System.import("lively.resources"); await createFiles("'+
ha+'", '+JSON.stringify(Pa)+")")};Qa.prototype.resourceDirList=function(ha,Pa,T){return this.runEvalAndStringify('\n      var {resource} = await System.import("lively.resources");\n      (await resource("'+ha+'").dirList('+JSON.stringify(Pa)+", "+JSON.stringify(T)+"))\n        .map(({url}) => ({url}))")};Qa.prototype.livelySystemAccessor=function(ha){ha=void 0===ha?"livelySystem":ha;return"var "+ha+' = (typeof lively !== "undefined" && lively.systemInterface)\n      || System.get(System.decanonicalize("lively-system-interface"))\n      || (typeof lively !== "undefined" && lively.modules && await lively.modules.importPackage("lively-system-interface"));\n    if (!'+
ha+') throw new Error("lively-system-interface not available!");'};Qa.prototype.normalizeSync=function(ha,Pa,T){return this.runEvalAndStringify("lively.modules.System.decanonicalize("+JSON.stringify(ha)+", "+JSON.stringify(Pa)+", "+T+")")};Qa.prototype.normalize=function(ha,Pa,T){return this.runEvalAndStringify("lively.modules.System.normalize("+JSON.stringify(ha)+", "+JSON.stringify(Pa)+", "+JSON.stringify(T)+")")};Qa.prototype.printSystemConfig=function(){return this.runEvalAndStringify("lively.modules.printSystemConfig()")};
Qa.prototype.getConfig=function(){return this.runEvalAndStringify('var c = Object.assign({}, lively.modules.System.getConfig()); for (var name in c) if (name.indexOf("__lively.modules__") === 0 || name.indexOf("loads") === 0) delete c[name]; c')};Qa.prototype.setConfig=function(ha){return this.runEvalAndStringify("lively.modules.System.config("+JSON.stringify(ha)+")")};Qa.prototype.getPackages=function(ha){ha=Object.assign({excluded:[]},ha);ha.excluded=ha.excluded.map(String);return this.runEvalAndStringify("\n      "+
this.livelySystemAccessor()+";\n      var options = "+JSON.stringify(ha)+';\n      options.excluded = options.excluded.map(ea => {\n        let evaled = lively.vm.syncEval(ea).value;\n        return typeof evaled === "function" ? evaled : ea;\n      });\n      await livelySystem.localInterface.getPackages(options)\n        .map(ea => Object.assign({}, ea, {System: null}));')};Qa.prototype.getPackageForModule=function(ha){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.getPackageForModule("+
JSON.stringify(ha)+")")};Qa.prototype.isModuleLoaded=function(ha,Pa){return this.runEvalAndStringify('lively.modules.isModuleLoaded("'+ha+'", '+Pa+")")};Qa.prototype.doesModuleExist=function(ha,Pa){return this.runEvalAndStringify('lively.modules.doesModuleExist("'+ha+'", '+Pa+")")};Qa.prototype.registerPackage=function(ha){var Pa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){return T.return(Pa.runEvalAndStringify("lively.modules.registerPackage("+JSON.stringify(ha)+")"))})};
Qa.prototype.importPackage=function(ha){var Pa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){return T.return(Pa.runEvalAndStringify("lively.modules.importPackage("+JSON.stringify(ha)+")"))})};Qa.prototype.removePackage=function(ha){var Pa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){return T.return(Pa.runEvalAndStringify("lively.modules.removePackage("+JSON.stringify(ha)+")"))})};Qa.prototype.reloadPackage=function(ha,Pa){var T=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ia){return ia.return(T.runEvalAndStringify("lively.modules.reloadPackage("+
JSON.stringify(ha)+", "+JSON.stringify(Pa)+")"))})};Qa.prototype.packageConfChange=function(ha,Pa){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.packageConfChange("+JSON.stringify(ha)+", "+JSON.stringify(Pa)+")")};Qa.prototype.resourcesOfPackage=function(ha,Pa){Pa=void 0===Pa?[".git","node_modules",".module_cache","lively.next-node_modules"]:Pa;var T=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ia){ha.address&&
(ha=ha.address);return ia.return(T.runEvalAndStringify("\n      "+T.livelySystemAccessor()+";\n      await livelySystem.localInterface.resourcesOfPackage("+JSON.stringify(ha)+", "+JSON.stringify(Pa)+");"))})};Qa.prototype.getModule=function(ha){var Pa=this,T;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ia){if(1==ia.nextAddress)return ia.yield(Pa.getModules(),2);T=ia.yieldResult.find(function(Fa){return Fa.name===ha});return ia.return(T?xa.modules.module(T.name):null)})};Qa.prototype.importModule=
function(ha){return this.runEvalAndStringify("lively.modules.System.import("+JSON.stringify(ha)+")")};Qa.prototype.forgetModule=function(ha,Pa){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(ha)+").unload("+JSON.stringify(Pa)+")")};Qa.prototype.reloadModule=function(ha,Pa){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(ha)+").reload("+JSON.stringify(Pa)+")")};Qa.prototype.moduleFormat=function(ha){return this.runEvalAndStringify("lively.modules.module("+
JSON.stringify(ha)+").format();")};Qa.prototype.moduleRead=function(ha){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(ha)+").source()")};Qa.prototype.moduleSourceChange=function(ha,Pa,T){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(ha)+").changeSource("+JSON.stringify(Pa)+", "+JSON.stringify(T)+")")};Qa.prototype.keyValueListOfVariablesInModule=function(ha,Pa){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.keyValueListOfVariablesInModule("+
JSON.stringify(ha)+", "+JSON.stringify(Pa)+")")};Qa.prototype.importsAndExportsOf=function(ha,Pa){return this.runEvalAndStringify("({\n      imports: await lively.modules.module("+JSON.stringify(ha)+").imports(),\n      exports: await lively.modules.module("+JSON.stringify(ha)+").exports()})")};Qa.prototype.exportsOfModules=function(ha){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+"\n      const options = "+JSON.stringify(ha)+";\n      options.excludedPackages = ["+ha.excludedPackages.map(function(Pa){return"function"===
typeof Pa?Pa.toString():JSON.stringify(Pa)}).join(",")+"]\n      await livelySystem.localInterface.exportsOfModules(options)")};Qa.prototype.searchInPackage=function(ha,Pa,T){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.searchInPackage("+JSON.stringify(ha)+", "+JSON.stringify(Pa)+", "+JSON.stringify(T)+")")};Qa.prototype.loadMochaTestFile=function(ha,Pa){Pa=void 0===Pa?[]:Pa;var T=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ia){return ia.return(T.runEvalAndStringify("\n      "+
T.livelySystemAccessor()+";\n      var {testsByFile} = await livelySystem.localInterface.loadMochaTestFile("+JSON.stringify(ha)+", "+JSON.stringify(Pa)+"), result;\n      result = {testsByFile}"))})};Qa.prototype.runMochaTests=function(ha,Pa,T,ia){var Fa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){ha&&ha instanceof RegExp&&(ha={isRegExp:!0,value:String(ha).replace(/^\/|\/$/g,"")});return $a.return(Fa.runEvalAndStringify("\n      var grep = "+JSON.stringify(ha)+";\n      if (grep && grep.isRegExp) grep = new RegExp(grep.value);\n      "+
Fa.livelySystemAccessor()+";\n      var {testsByFile, isError, value: error} = await livelySystem.localInterface.runMochaTests(grep, "+JSON.stringify(Pa||[])+"), result;\n      error = error ? String(error.stack || error) : null;\n      if (testsByFile) {\n        testsByFile.forEach(ea =>\n          ea.tests.forEach(ea => {\n            if (!ea.error) return;\n            var {message, stack, actual, expected} = ea.error;\n            ea.error = {\n              message: message || String(ea.error),\n              stack: stack,\n              actual, exected\n            }\n          }));\n      }\n      result = {testsByFile, isError, error}"))})};
xa.RemoteCoreInterface=Qa;var Eb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/local-system.js");Eb.obj=ac;Eb.string=Pc;Eb.arr=Ab;Eb.resource=kc;Eb.createFiles=Jd;Eb.ast=tb;Eb.modules=Uc;Eb.vm=pe;Eb.parseJsonLikeObj=te;Eb.AbstractCoreInterface=wa;Eb.classToFunctionTransform=Ze;wa=function(){return Eb.AbstractCoreInterface.apply(this,arguments)||this};$jscomp.inherits(wa,Eb.AbstractCoreInterface);wa.prototype.dynamicCompletionsForPrefix=function(ha,Pa,T){var ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){if(1==
Fa.nextAddress)return Fa.yield(Eb.vm.completions.getCompletions(function($a){return Eb.vm.runEval($a.replace("return ",""),Object.assign({targetModule:ha,classTransform:Eb.classToFunctionTransform},T))},Pa),2);ia=Fa.yieldResult;if(ia.isError)throw ia.value;return Fa.return({completions:ia.completions,prefix:ia.startLetters})})};wa.prototype.runEval=function(ha,Pa){return Eb.vm.runEval(ha,Object.assign({classTransform:Eb.classToFunctionTransform},Pa))};wa.prototype.resourceExists=function(ha){return Eb.resource(ha).exists()};
wa.prototype.resourceEnsureExistance=function(ha,Pa){return Eb.resource(ha).ensureExistance(Pa)};wa.prototype.resourceMkdir=function(ha){return Eb.resource(ha).mkdir()};wa.prototype.resourceRead=function(ha){return Eb.resource(ha).read()};wa.prototype.resourceRemove=function(ha){return Eb.resource(ha).remove()};wa.prototype.resourceWrite=function(ha,Pa){return Eb.resource(ha).write(Pa)};wa.prototype.resourceCreateFiles=function(ha,Pa){return Eb.createFiles(ha,Pa)};wa.prototype.resourceDirList=function(ha,
Pa,T){return Eb.resource(ha).dirList(Pa,T)};wa.prototype.normalizeSync=function(ha,Pa,T){return System.decanonicalize(ha,Pa,T)};wa.prototype.normalize=function(ha,Pa,T){return System.normalize(ha,Pa,T)};wa.prototype.printSystemConfig=function(){return Eb.modules.printSystemConfig()};wa.prototype.getConfig=function(){return System.getConfig()};wa.prototype.setConfig=function(ha){Eb.modules.System.config(ha)};wa.prototype.getPackages=function(ha){ha=Object.assign({},ha);ha=void 0===ha.excluded?[]:ha.excluded;
var Pa=ha.filter(function(ia){return"string"===typeof ia}),T=ha.filter(function(ia){return"function"===typeof ia});Pa=Pa.concat(Pa.map(function(ia){return System.decanonicalize(ia.replace(/\/?$/,"/")).replace(/\/$/,"")}));return Eb.modules.getPackages().filter(function(ia){return!Pa.includes(ia.url)&&!T.some(function(Fa){return Fa(ia.url)})})};wa.prototype.registerPackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){return Pa.return(Eb.modules.registerPackage(ha))})};
wa.prototype.importPackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){return Pa.return(Eb.modules.importPackage(ha))})};wa.prototype.removePackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){return Pa.return(Eb.modules.removePackage(ha))})};wa.prototype.reloadPackage=function(ha,Pa){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){return T.return(Eb.modules.reloadPackage(ha,Pa))})};wa.prototype.packageConfChange=function(ha,
Pa){var T=this,ia,Fa,$a,zb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cc){if(1==Cc.nextAddress)return ia=Eb.modules.System,Fa=Eb.parseJsonLikeObj(ha),$a=JSON.stringify(Fa,null,2),Cc.yield(Eb.modules.module(Pa).changeSource($a,{doEval:!1}),2);if(3!=Cc.nextAddress)return ia.set(Pa,ia.newModule(Fa)),Cc.yield(T.getPackageForModule(Pa),3);(zb=Cc.yieldResult)&&Eb.modules.applyPackageConfig(Fa,zb.address);Cc.jumpToEnd()})};wa.prototype.resourcesOfPackage=function(ha,Pa){Pa=void 0===Pa?[".git",
"node_modules",".module_cache"]:Pa;var T,ia,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){if(1==$a.nextAddress)return $a.setCatchFinallyBlocks(2),T=ha.address?ha.address:ha,ia=Eb.modules.getPackage(T),$a.yield(ia.resources(void 0,Pa),4);if(2!=$a.nextAddress)return $a.return($a.yieldResult.map(function(zb){return Object.assign(zb,{package:zb.package.url})}));Fa=$a.enterCatchBlock();console.warn("resourcesOfPackage error for "+ha+": "+Fa);return $a.return([])})};wa.prototype.getPackageForModule=
function(ha){return(ha=Eb.modules.getPackageOfModule(ha))?ha.asSpec():ha};wa.prototype.isModuleLoaded=function(ha,Pa){return Eb.modules.isModuleLoaded(ha,Pa)};wa.prototype.doesModuleExist=function(ha,Pa){return Eb.modules.isModuleLoaded(ha,Pa)};wa.prototype.getModule=function(ha){return Eb.modules.module(ha)};wa.prototype.importModule=function(ha){return Eb.modules.System.import(ha)};wa.prototype.forgetModule=function(ha,Pa){return Eb.modules.module(ha).unload(Pa)};wa.prototype.reloadModule=function(ha,
Pa){return Eb.modules.module(ha).reload(Pa)};wa.prototype.moduleFormat=function(ha){return Eb.modules.module(ha).format()};wa.prototype.moduleRead=function(ha){return Eb.modules.module(ha).source()};wa.prototype.moduleSourceChange=function(ha,Pa,T){return Eb.modules.module(ha).changeSource(Pa,T)};wa.prototype.keyValueListOfVariablesInModule=function(ha,Pa){var T=this,ia,Fa,$a,zb,Cc,Ba,Ca,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){switch(Ec.nextAddress){case 1:if(Pa){Ec.jumpTo(2);
break}return Ec.yield(T.resourceRead(ha),3);case 3:Pa=Ec.yieldResult;case 2:return ia="string"===typeof Pa?Eb.ast.parse(Pa):Pa,Fa=T.normalizeSync(ha),T.moduleFormat(Fa),$a=Eb.modules.module(Fa).env().recorder,Ec.yield(T.importsAndExportsOf(Fa,ia),4);case 4:return zb=Ec.yieldResult,Cc=Eb.ast.query.topLevelDeclsAndRefs(ia),Ba=Eb.arr.sortByKey(Eb.ast.query.declarationsOfScope(Cc.scope,!0),"start"),Ca=Eb.arr.pluck(Cc.scope.importSpecifiers,"name"),Nb=0,Ec.return(Ba.map(function(fb){var td=fb.name.length,
Xd=zb.exports.find(function(Bf){return Bf.local===fb.name}),ae=Eb.arr.include(Ca,fb.name);Xd&&(td+=9);ae&&(td+=9);Nb=Math.max(Nb,td);return{isExport:Xd,isImport:ae,name:fb.name,value:$a[fb.name],node:fb,printedName:fb.name+(Xd?" [export]":"")+(ae?" [import]":""),printedValue:Eb.obj.inspect($a[fb.name],{maxDepth:1}).replace(/\n/g,"")}}).map(function(fb){return{isListItem:!0,value:fb,string:fb.printedName+Eb.string.indent(" = "+fb.printedValue," ",Nb-fb.printedName.length)}}))}})};wa.prototype.importsAndExportsOf=
function(ha,Pa){var T;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ia){return 1==ia.nextAddress?ia.yield(Eb.modules.module(ha).imports(Pa),2):3!=ia.nextAddress?(T=ia.yieldResult,ia.yield(Eb.modules.module(ha).exports(Pa),3)):ia.return({imports:T,exports:ia.yieldResult})})};wa.prototype.exportsOfModules=function(ha){return Eb.modules.ExportLookup.run(System,ha)};wa.prototype.searchInPackage=function(ha,Pa,T){return Eb.modules.getPackage(ha).search(Pa,T)};wa.prototype.runMochaTests=function(ha,
Pa,T,ia){var Fa,$a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return zb.yield(System.import("lively-system-interface/commands/mocha-tests.js"),2);Fa=zb.yieldResult;$a=Fa.runMochaTests;return zb.return($a(ha,Pa,T,ia))})};wa.prototype.loadMochaTestFile=function(ha,Pa){var T,ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){if(1==Fa.nextAddress)return Fa.yield(System.import("lively-system-interface/commands/mocha-tests.js"),2);T=Fa.yieldResult;
ia=T.loadMochaTestFile;return Fa.return(ia(ha,Pa))})};$jscomp.global.Object.defineProperties(wa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"local"}}});Eb.LocalCoreInterface=wa;var rc=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/http-interface.js");rc.evalStrategies=Ff;rc.RemoteCoreInterface=Qa;var qb=function(ha){var Pa=rc.RemoteCoreInterface.call(this)||this;Pa.currentEval=null;Pa.url=ha;Pa.server=new rc.evalStrategies.HttpEvalStrategy(ha);return Pa};
$jscomp.inherits(qb,rc.RemoteCoreInterface);qb.prototype.runEval=function(ha,Pa){return this.server.runEval(ha,Pa)};$jscomp.global.Object.defineProperties(qb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this.url}},description:{configurable:!0,enumerable:!0,get:function(){return this.url.replace(/^https?:\/\//,"")}}});rc.HTTPCoreInterface=qb;var sb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/l2l-interface.js");sb.evalStrategies=Ff;sb.RemoteCoreInterface=
Qa;Qa=function(ha,Pa){var T=sb.RemoteCoreInterface.call(this)||this;T.targetId=ha;T.peer=Pa;return T};$jscomp.inherits(Qa,sb.RemoteCoreInterface);Qa.prototype.isConnected=function(){var ha=this,Pa,T,ia,Fa,$a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return Pa=ha,T=Pa.client,ia=Pa.targetId,zb.yield(T.sendToAndWait(T.trackerId,"getClients",{}),2);Fa=zb.yieldResult;$a=Fa.data;return zb.return($a.some(function(Cc){Cc=$jscomp.makeIterator(Cc).next().value;return ia===
Cc}))})};Qa.prototype.runEval=function(ha,Pa){var T=this,ia,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){ia=T.client;if(!ia)throw Error("No lively.2lively default client available!");Fa=new sb.evalStrategies.L2LEvalStrategy(ia,T.targetId);return $a.return(Fa.runEval(ha,Pa))})};$jscomp.global.Object.defineProperties(Qa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"l2l "+this.targetId}},description:{configurable:!0,enumerable:!0,get:function(){var ha=this.peer,
Pa="l2l "+this.targetId.slice(0,5);if(ha){var T=ha.location,ia=ha.type,Fa=ha.user;ha=ha.world;ia&&(Pa+=", "+ia);T&&(Pa+=", "+T.replace(/^https?:\/\//,"")+(ha?"/"+ha:""));Fa&&(Pa+=", "+Fa.name)}return Pa}},client:{configurable:!0,enumerable:!0,get:function(){return(lively.modules.module("lively.2lively/client.js").get()||{default:lively.l2l.L2LClient}).default.default()}}});sb.L2LCoreInterface=Qa;var kb=lively.FreezerRuntime.recorderFor("lively-system-interface/index.js");kb.systemInterfaceNamed=ob;
kb.interactivelyCreatePackage=Bc;kb.interactivelyLoadPackage=sd;kb.interactivelyReloadPackage=le;kb.interactivelyUnloadPackage=jc;kb.interactivelyRemovePackage=je;kb.showExportsAndImportsOf=Ae;kb.shortModuleName=Mc;kb.interactivelyChangeModule=bc;kb.interactivelyReloadModule=Gc;kb.interactivelyUnloadModule=Zc;kb.interactivelyRemoveModule=Rd;kb.interactivelyAddModule=Kd;kb.modulesInPackage=rb;kb.LocalCoreInterface=wa;kb.HTTPCoreInterface=qb;kb.L2LCoreInterface=Qa;Qa=function(ha){this.coreInterface=
ha};Qa.prototype.dynamicCompletionsForPrefix=function(ha,Pa,T){return this.coreInterface.dynamicCompletionsForPrefix(ha,Pa,T)};Qa.prototype.runEval=function(ha,Pa){return this.coreInterface.runEval(ha,Pa)};Qa.prototype.printSystemConfig=function(ha,Pa,T){return this.coreInterface.printSystemConfig(ha,Pa,T)};Qa.prototype.getConfig=function(ha,Pa,T){return this.coreInterface.getConfig(ha,Pa,T)};Qa.prototype.getPackages=function(ha){return this.coreInterface.getPackages(ha)};Qa.prototype.getModules=
function(ha,Pa,T){return this.coreInterface.getModules(ha,Pa,T)};Qa.prototype.getModule=function(ha,Pa,T){return this.coreInterface.getModule(ha,Pa,T)};Qa.prototype.getPackage=function(ha,Pa,T){return this.coreInterface.getPackage(ha,Pa,T)};Qa.prototype.getPackageForModule=function(ha,Pa,T){return this.coreInterface.getPackageForModule(ha,Pa,T)};Qa.prototype.resourcesOfPackage=function(ha,Pa){return this.coreInterface.resourcesOfPackage(ha,Pa)};Qa.prototype.systemConfChange=function(ha,Pa,T){return this.coreInterface.systemConfChange(ha,
Pa,T)};Qa.prototype.registerPackage=function(ha){return this.coreInterface.registerPackage(ha)};Qa.prototype.importPackage=function(ha){return this.coreInterface.importPackage(ha)};Qa.prototype.removePackage=function(ha){return this.coreInterface.removePackage(ha)};Qa.prototype.reloadPackage=function(ha){return this.coreInterface.reloadPackage(ha)};Qa.prototype.packageConfChange=function(ha,Pa){return this.coreInterface.packageConfChange(ha,Pa)};Qa.prototype.keyValueListOfVariablesInModule=function(ha,
Pa){return this.coreInterface.keyValueListOfVariablesInModule(ha,Pa)};Qa.prototype.interactivelyCreatePackage=function(ha){return kb.interactivelyCreatePackage(this.coreInterface,ha)};Qa.prototype.interactivelyLoadPackage=function(ha,Pa){return kb.interactivelyLoadPackage(this.coreInterface,ha,Pa)};Qa.prototype.interactivelyReloadPackage=function(ha,Pa){return kb.interactivelyReloadPackage(this.coreInterface,ha,Pa)};Qa.prototype.interactivelyUnloadPackage=function(ha,Pa,T){return kb.interactivelyUnloadPackage(this.coreInterface,
ha,Pa,T)};Qa.prototype.interactivelyRemovePackage=function(ha,Pa){return kb.interactivelyRemovePackage(this.coreInterface,ha,Pa)};Qa.prototype.isModuleLoaded=function(ha,Pa){return this.coreInterface.isModuleLoaded(ha,Pa)};Qa.prototype.doesModuleExist=function(ha,Pa){return this.coreInterface.doesModuleExist(ha,Pa)};Qa.prototype.importModule=function(ha){return this.coreInterface.importModule(ha)};Qa.prototype.forgetModule=function(ha,Pa){return this.coreInterface.forgetModule(ha,Pa)};Qa.prototype.reloadModule=
function(ha,Pa){return this.coreInterface.reloadModule(ha,Pa)};Qa.prototype.moduleFormat=function(ha){return this.coreInterface.moduleFormat(ha)};Qa.prototype.moduleRead=function(ha){return this.coreInterface.moduleRead(ha)};Qa.prototype.moduleWrite=function(ha,Pa){return this.coreInterface.moduleWrite(ha,Pa)};Qa.prototype.getModulesInPackage=function(ha){return kb.modulesInPackage(this.coreInterface,ha)};Qa.prototype.shortModuleName=function(ha,Pa){return kb.shortModuleName(this.coreInterface,ha,
Pa)};Qa.prototype.interactivelyChangeModule=function(ha,Pa,T){return kb.interactivelyChangeModule(this.coreInterface,ha,Pa,T)};Qa.prototype.interactivelyReloadModule=function(ha,Pa){return kb.interactivelyReloadModule(this.coreInterface,ha,Pa)};Qa.prototype.interactivelyUnloadModule=function(ha,Pa){return kb.interactivelyUnloadModule(this.coreInterface,ha,Pa)};Qa.prototype.interactivelyRemoveModule=function(ha,Pa){return kb.interactivelyRemoveModule(this.coreInterface,ha,Pa)};Qa.prototype.interactivelyAddModule=
function(ha,Pa){return kb.interactivelyAddModule(this.coreInterface,ha,Pa)};Qa.prototype.showExportsAndImportsOf=function(ha,Pa){return kb.showExportsAndImportsOf(this.coreInterface,ha,Pa)};Qa.prototype.exportsOfModules=function(ha){return this.coreInterface.exportsOfModules(ha)};Qa.prototype.searchInPackage=function(ha,Pa,T){return this.coreInterface.searchInPackage(ha,Pa,T)};Qa.prototype.searchInAllPackages=function(ha,Pa){Pa=void 0===Pa?{}:Pa;var T=this,ia,Fa,$a,zb,Cc,Ba,Ca,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){switch(Ec.nextAddress){case 1:return(ia=
Pa.progress)&&ia.step("Fetching Packages...",0),Ec.yield(T.coreInterface.getPackages({excluded:Pa.excludedPackages}),2);case 2:Fa=Ec.yieldResult,$a=[],ia&&ia.step("Fetching Packages...",.1),zb=0;case 3:if(!(zb<Fa.length)){Ec.jumpTo(5);break}Cc=Fa[zb];Ba=Cc.url;if(!Ba||"no group"===Ba){Ec.jumpTo(4);break}ia&&ia.step(Ba.replace(System.baseURL,"").slice(0,20),.1+zb/Fa.length*.9);Ec.setCatchFinallyBlocks(6);return Ec.yield(T.coreInterface.searchInPackage(Ba,ha,Pa),8);case 8:Ca=Ec.yieldResult;$a=$a.concat(Ca);
Ec.leaveTryBlock(4);break;case 6:Nb=Ec.enterCatchBlock(),console.error("Error searching in package "+Ba+":\n"+Nb.stack);case 4:zb++;Ec.jumpTo(3);break;case 5:return Ec.return($a)}})};Qa.prototype.loadMochaTestFile=function(ha,Pa){return this.coreInterface.loadMochaTestFile(ha,Pa)};Qa.prototype.runMochaTests=function(ha,Pa,T,ia){return this.coreInterface.runMochaTests(ha,Pa,T,ia)};$jscomp.global.Object.defineProperties(Qa.prototype,{isSystemInterface:{configurable:!0,enumerable:!0,get:function(){return!0}},
name:{configurable:!0,enumerable:!0,get:function(){return this.coreInterface.name}}});Ha("Interface",Qa);kb.Interface=Qa;kb.systemInterfaceNamed=ob;kb.systemInterfaceNamed=ob;Qa=Ha("localInterface",new kb.Interface(new kb.LocalCoreInterface));kb.localInterface=Qa;kb.localInterface=Qa;kb.localInterface=Qa;kb.httpInterfaces={};Qa=Ha("serverInterfaceFor",function(ha){return kb.httpInterfaces[ha]||(kb.httpInterfaces[ha]=new kb.Interface(new kb.HTTPCoreInterface(ha)))});kb.serverInterfaceFor=Qa;kb.serverInterfaceFor=
Qa;kb.serverInterfaceFor=Qa;kb.l2lInterfaces={};Qa=Ha("l2lInterfaceFor",function(ha,Pa){return kb.l2lInterfaces[ha]||(kb.l2lInterfaces[ha]=new kb.Interface(new kb.L2LCoreInterface(ha,Pa)))});kb.l2lInterfaceFor=Qa;kb.l2lInterfaceFor=Qa;kb.l2lInterfaceFor=Qa}}});
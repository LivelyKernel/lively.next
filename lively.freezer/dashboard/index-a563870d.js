System.register(["./__root_module__-7cbd94df.js"],function(Da){var Ab,Rb,jc,cc,je,fd,Yd,jd,Pc,vd,Ld,ge,Td,md,Za,Db,ac,ic,gd,fe,Yb,qc,Ob,Hc,Yc,cd,$b,pb,xc,Lc,Ga,Ra,rb,Kb,Ib,gb,ib,Lb,tc,Qc,sc,Vc;return{setters:[function(Q){Ab=Q.at;Rb=Q.a3;jc=Q.C;cc=Q.an;je=Q.ai;fd=Q.ax;Yd=Q.aV;jd=Q.aB;Pc=Q.ay;vd=Q.a9;Ld=Q.al;ge=Q.ao;Td=Q.h;md=Q.a2;Za=Q.a1;Db=Q.ah;ac=Q.a7;ic=Q.P;gd=Q.$;fe=Q.aW;Yb=Q.ap;qc=Q.a6;Ob=Q.aq;Hc=Q.ar;Yc=Q.aX;cd=Q.aY;$b=Q.au;pb=Q.as;xc=Q.s;Lc=Q.av;Ga=Q.aZ;Ra=Q.ak;rb=Q.a_;Kb=Q.a$;Ib=Q.b0;gb=
Q.aa;ib=Q.b1;Lb=Q.am;tc=Q.b2;Qc=Q.b3;sc=Q.b4;Vc=Q.aQ}],execute:function(){function Q(sa){(sa=Vb.cachedGuideLines.get(sa))&&sa.forEach(function(Aa){return Aa.remove()})}function fa(sa,Aa,Mb,P,wa){Aa=void 0===Aa?!0:Aa;Mb=void 0===Mb?!0:Mb;P=void 0===P?10:P;wa=void 0===wa?100:wa;if(Aa||Mb){var Qa=sa.owner,Nb=Qa.world();Qa=Qa.getGlobalTransform();var Gc=sa.owner.submorphs.filter(function(wd){return wd!==sa&&!wd.isEpiMorph&&wd.visible&&wd.reactsToPointer}),Uc=Vb.findAlignedMorphs(sa,Gc,P,wa,"left top right bottom hCenter vCenter".split(" "),
"left top right bottom hCenter vCenter".split(" "));wa=[];var le=0,Od=0,kf=0,ae=0;Qa.e-=Nb.scroll.x;Qa.f-=Nb.scroll.y;if(Uc){Uc=$jscomp.makeIterator(Uc);for(var Ke=Uc.next();!Ke.done;Ke=Uc.next()){Ke=$jscomp.makeIterator(Ke.value);Ke.next();var $e=Ke.next().value;Ke=$e.vertical;$e=$jscomp.makeIterator($e.horizontal);for(var Cf=$e.next();!Cf.done;Cf=$e.next()){Cf=Cf.value;var rg=Cf.edgeAVal,Qf=Cf.refPointsA,Tc=Cf.refPointsB,Rf=Cf.edgeBVal,Fg=Math.ceil(P-Cf.delta),Gg=Math.min(Qf.top,Tc.top);Qf=Math.max(Qf.bottom,
Tc.bottom);Cf.maxDist>P&&(Fg-=P/2);le<Fg&&(le=Fg,kf=Rf-rg);wa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Vb.guideWidth,start:Qa.transformPoint(Vb.pt(Rf,Gg)),end:Qa.transformPoint(Vb.pt(Rf,Qf)),fill:Vb.guideColor,guideType:"h",priority:Fg})}Ke=$jscomp.makeIterator(Ke);for($e=Ke.next();!$e.done;$e=Ke.next())$e=$e.value,Cf=$e.edgeAVal,Gg=$e.refPointsA,Qf=$e.refPointsB,rg=$e.edgeBVal,Rf=Math.ceil(P-$e.delta),Fg=Math.min(Gg.left,Qf.left),Gg=Math.max(Gg.right,Qf.right),$e.maxDist>P&&(Rf-=
P/2),Od<Rf&&Math.abs(rg-Cf)<=P&&(Od=Rf,ae=rg-Cf),wa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Vb.guideWidth,start:Qa.transformPoint(Vb.pt(Fg,rg)),end:Qa.transformPoint(Vb.pt(Gg,rg)),fill:Vb.guideColor,guideType:"v",priority:Rf})}}if(!le||!Od){Gc=[sa].concat($jscomp.arrayFromIterable(Gc));Cf=Vb.computeClosestMorphs(Gc);$e=Cf[0];Gc=$e.l;Uc=$e.r;Ke=$e.t;$e=$e.b;var rf;if(Gc||Uc||Ke||$e){var Ha=(Gc||Uc||Ke||$e).refPointsA;for(rg=1;rg<Cf.length&&(Qf=Cf[rg],Rf=Qf.l,Fg=Qf.r,Gg=Qf.t,Qf=Qf.b,
le||(Gc&&Rf&&Gc.index!==Rf.index&&Math.abs(Rf.dist-Gc.dist)<=P?rf=Object.assign({neighbor:rg,direction:"left"},Rf):Uc&&Fg&&Uc!==Fg.index&&Math.abs(Fg.dist-Uc.dist)<=P&&(rf=Object.assign({neighbor:rg,direction:"right"},Fg))),Od||(Ke&&Gg&&Ke.index!==Gg.index&&Math.abs(Gg.dist-Ke.dist)<=P?rf=Object.assign({neighbor:rg,direction:"top"},Gg):$e&&Qf&&$e.index!==Qf.index&&Math.abs(Qf.dist-$e.dist)<=P&&(rf=Object.assign({neighbor:rg,direction:"bottom"},Qf))),!rf);rg++);}if(rf){var cb=rf;P=cb.direction;Gg=
cb.dist;var Hb=Ha.left;Tc=Ha.top;var ba=Ha.bottom,Ja=Ha.right,nb=Ha.width,zb=Ha.height;Qf=cb.refPointsA;Ha=Qf.left;Cf=Qf.top;rg=Qf.bottom;Rf=Qf.right;Fg=Qf.width;Qf=Qf.height;var Ic=cb.refPointsB,vc=Ic.left;cb=Ic.top;var Ad=Ic.bottom;Ic=Ic.right;Ja="left"===P?Hb:"right"===P?Ja:Hb+nb/2;ba="bottom"===P?ba:"top"===P?Tc:Tc+zb/2;Hb="left"===P?Ja-Gg:"right"===P?Ja+Gg:Hb+nb/2;Gg="bottom"===P?ba+Gg:"top"===P?ba-Gg:Tc+zb/2;Tc="left"===P?Ic:"right"===P?vc:Ha+Fg/2;nb="bottom"===P?cb:"top"===P?Ad:Cf+Qf/2;!Mb||
le||"right"!==P&&"left"!==P||(le=10,kf=(rf.dist-(Uc||Gc).dist)*("right"===P?-1:1),Ja+=kf,Hb+=kf);!Mb||Od||"top"!==P&&"bottom"!==P||(Od=10,ae=((Ke||$e).dist-rf.dist)*("top"===P?-1:1),ba+=ae,Gg+=ae);wa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,start:Qa.transformPoint(Vb.pt("left"===P?Ha:"right"===P?Rf:Ha+Fg/2,"bottom"===P?rg:"top"===P?Cf:Cf+Qf/2)),end:Qa.transformPoint(Vb.pt(Tc,nb)),fill:Vb.Color.orange,height:Vb.guideWidth,guideType:P,priority:10},{type:"line",epiMorph:!0,hasFixedPosition:!0,
start:Qa.transformPoint(Vb.pt(Ja,ba)),end:Qa.transformPoint(Vb.pt(Hb,Gg)),fill:Vb.Color.orange,height:Vb.guideWidth,guideType:P,priority:10})}}Mb&&(kf||ae)&&sa.moveBy(Vb.pt(kf,ae));if(Aa){wa=wa.filter(function(wd){var yd=wd.guideType;wd=wd.priority;return"h"===yd?wd===le:"v"===yd?wd===Od:!0});(Aa=Vb.cachedGuideLines.get(sa))||Vb.cachedGuideLines.set(sa,Aa=[]);for(Mb=0;Mb<wa.length;Mb++)rf=void 0,Aa[Mb]?rf=Object.assign(Aa[Mb],wa[Mb]):(rf=Vb.morph(wa[Mb]),Aa.push(rf)),rf.owner||Nb.addMorph(rf);Aa.slice(Mb).forEach(function(wd){return wd.remove()});
Vb.fun.debounceNamed(sa.id+"-drag-guides-cleanup",1300,function(){var wd=Vb.cachedGuideLines.get(sa);wd&&wd.forEach(function(yd){return yd.remove()})})()}}}function Ia(sa,Aa,Mb,P,wa,Qa){Mb=void 0===Mb?!0:Mb;P=void 0===P?!0:P;wa=void 0===wa?5:wa;Qa=void 0===Qa?100:Qa;if(Mb||P){var Nb=sa.owner,Gc=Nb.world(),Uc=Nb.getGlobalTransform(),le=sa.owner.submorphs.filter(function(ba){return ba!==sa&&!ba.isEpiMorph&&ba.visible&&ba.reactsToPointer});Nb=(Aa.includes("left")||Aa.includes("right")?"x":"")+(Aa.includes("top")||
Aa.includes("bottom")?"y":"");var Od=Vb.findMorphsWithSimilarWidthOrHeight(sa,Nb,le,wa,Qa),kf=-Infinity,ae=-Infinity,Ke=0,$e=0,Cf=0,rg=0,Qf=0,Tc=0;Nb=[];Uc.e-=Gc.scroll.x;Uc.f-=Gc.scroll.y;if(Od){Od=$jscomp.makeIterator(Od);for(var Rf=Od.next();!Rf.done;Rf=Od.next()){Rf=$jscomp.makeIterator(Rf.value);Rf.next();var Fg=Rf.next().value;Rf=Fg.similarIn;var Gg=Fg.delta,rf=Fg.refPointsA,Ha=Fg.refPointsB;Fg=wa-Gg+(Qa-Fg.minDist);"width"===Rf?kf<Fg&&(kf=Fg,Aa.includes("left")&&($e=-Gg),Aa.includes("right")&&
(Ke=Gg)):ae<Fg&&(ae=Fg,Aa.includes("top")&&(Cf=-Gg),Aa.includes("bottom")&&(rg=Gg));Gg={type:"line",epiMorph:!0,hasFixedPosition:!0,height:Vb.guideWidth,fill:Vb.guideColor,guideType:Rf,priority:Fg,start:Uc.transformPoint("width"===Rf?Vb.pt(rf.left,rf.top+rf.height/2):Vb.pt(rf.left+rf.width/2,rf.top)),end:Uc.transformPoint("width"===Rf?Vb.pt(rf.right,rf.top+rf.height/2):Vb.pt(rf.left+rf.width/2,rf.bottom))};Rf=Object.assign({},Gg,{start:Uc.transformPoint("width"===Rf?Vb.pt(Ha.left,Ha.top+Ha.height/
2):Vb.pt(Ha.left+Ha.width/2,Ha.top)),end:Uc.transformPoint("width"===Rf?Vb.pt(Ha.right,Ha.top+Ha.height/2):Vb.pt(Ha.left+Ha.width/2,Ha.bottom))});Nb.push(Gg,Rf)}}if(Qa=Vb.findAlignedMorphs(sa,le,wa,Qa,Aa,void 0))for(Qa=$jscomp.makeIterator(Qa),le=Qa.next();!le.done;le=Qa.next()){le=$jscomp.makeIterator(le.value);le.next();Od=le.next().value;le=Od.vertical;Od=$jscomp.makeIterator(Od.horizontal);for(Rf=Od.next();!Rf.done;Rf=Od.next()){Rf=Rf.value;Ha=Rf.edgeAVal;var cb=Rf.refPointsA,Hb=Rf.refPointsB;
Gg=Rf.edgeBVal;rf=Math.ceil(wa-Rf.delta);Fg=Math.min(cb.top,Hb.top);cb=Math.max(cb.bottom,Hb.bottom);Rf.maxDist>wa&&(rf-=wa/2);Qf<rf&&(Qf=rf,Aa.includes("left")&&($e=-(Gg-Ha)),Aa.includes("right")&&(Ke=+(Gg-Ha)));Nb.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Vb.guideWidth,start:Uc.transformPoint(Vb.pt(Gg,Fg)),end:Uc.transformPoint(Vb.pt(Gg,cb)),fill:Vb.guideColor,guideType:"h",priority:rf})}le=$jscomp.makeIterator(le);for(Od=le.next();!Od.done;Od=le.next())Od=Od.value,Rf=Od.edgeAVal,
Fg=Od.refPointsA,cb=Od.refPointsB,Ha=Od.edgeBVal,Gg=Math.ceil(wa-Od.delta),rf=Math.min(Fg.left,cb.left),Fg=Math.max(Fg.right,cb.right),Od.maxDist>wa&&(Gg-=wa/2),Tc<Gg&&Math.abs(Ha-Rf)<=wa&&(Tc=Gg,Aa.includes("top")&&(Cf=Ha-Rf),Aa.includes("bottom")&&(rg=Ha-Rf)),Nb.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Vb.guideWidth,start:Uc.transformPoint(Vb.pt(rf,Ha)),end:Uc.transformPoint(Vb.pt(Fg,Ha)),fill:Vb.guideColor,guideType:"v",priority:Gg})}P&&($e&&(sa.left+=$e,sa.right-=$e),Cf&&(sa.top+=
Cf,sa.bottom-=Cf),Ke&&(sa.width+=Ke),rg&&(sa.height+=rg));if(Mb){Nb=Nb.filter(function(ba){var Ja=ba.guideType;ba=ba.priority;return"width"===Ja?ba===kf:"height"===Ja?ba===ae:"v"===Ja?ba===Tc:"h"===Ja?ba===Qf:!1});(Aa=Vb.cachedGuideLines.get(sa))||Vb.cachedGuideLines.set(sa,Aa=[]);for(Mb=0;Mb<Nb.length;Mb++)P=void 0,Aa[Mb]?P=Object.assign(Aa[Mb],Nb[Mb]):(P=Vb.morph(Nb[Mb]),Aa.push(P)),P.owner||Gc.addMorph(P);Aa.slice(Mb).forEach(function(ba){return ba.remove()});Vb.fun.debounceNamed(sa.id+"-drag-guides-cleanup",
1300,function(){var ba=Vb.cachedGuideLines.get(sa);ba&&ba.forEach(function(Ja){return Ja.remove()})})()}}}function Sa(sa,Aa){Aa=void 0===Aa?!1:Aa;var Mb=Ta.MorphicEnv.default().world;if(null===sa||void 0===sa)sa=String(sa);if(sa.isMorph)return Ta.showRect(sa.world(),sa.globalBounds().translatedBy(sa.world().scroll.negated()),Aa);if(sa.isPoint)return Ta.showRect(Mb,new Ta.Rectangle(sa.x-5,sa.y-5,10,10));if(sa.isLine)return Ta.showLine(Mb,sa);if(sa.isRectangle)return Ta.showRect(Mb,sa);if("undefined"!==
typeof Ta.Element&&sa instanceof Ta.Element)return Ta.showRect(Mb,Ta.Rectangle.fromElement(sa));if("number"===typeof sa||"symbol"===typeof sa||"boolean"===typeof sa||"undefined"!==typeof Ta.Node&&sa instanceof Ta.Node||sa instanceof RegExp)sa=String(sa);"object"===typeof sa&&(sa=Ta.obj.inspect(sa,{maxDepth:1}));return"string"===typeof sa&&1===arguments.length?Mb.setStatusMessage(sa):Mb.setStatusMessage(Ta.string.formatFromArray(Array.from(arguments)))}function ec(sa,Aa,Mb){Mb=void 0===Mb?3E3:Mb;var P,
wa,Qa,Nb,Gc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==Uc.nextAddress){if(!(sa&&sa.world()&&Aa&&Aa.world()))return Uc.return(null);P=sa.owner.worldPoint(sa.center);wa=Aa.owner.worldPoint(Aa.center);Qa=P.lineTo(wa).sampleN(2)[1];Nb={tagName:"marker",markerHeight:5,markerWidth:5,orient:"auto",refX:1,refY:5,viewBox:"0 0 10 10",children:[{tagName:"circle",stroke:Ta.Color.red,fill:Ta.Color.red,cx:5,cy:5,r:4}]};Gc=$world.addMorph(new Ta.Path({position:Qa,renderOnGPU:!0,vertices:[Ta.pt(0),
Ta.pt(0)],borderWidth:2,startMarker:Nb,endMarker:Nb,borderColor:Ta.Color.red}));return Uc.yield(Gc.whenRendered(),2)}if(3!=Uc.nextAddress)return Uc.yield(Gc.animate({opacity:1,customTween:function(le){var Od=Gc.center;Gc.vertices=[Ta.pt(0).interpolate(le,P.subPt(Qa)),Ta.pt(0).interpolate(le,wa.subPt(Qa))];Gc.center=Od},duration:400}),3);Mb&&setTimeout(function(){return Gc.fadeOut()},Mb);return Uc.return(Gc)})}Da({a:fa,d:ec,r:Q,s:Sa});var Vb=lively.FreezerRuntime.recorderFor("lively.halos/drag-guides.js");
Vb.removeSnapToGuidesOf=Q;Vb.showAndSnapToGuides=fa;Vb.showAndSnapToResizeGuides=Ia;Vb.computeRefPoints=function(sa){var Aa=sa.x,Mb=sa.y,P=sa.width;sa=sa.height;return{left:Aa,top:Mb,hCenter:Aa+P/2,vCenter:Mb+sa/2,right:Aa+P,bottom:Mb+sa,width:P,height:sa}};Vb.findEdgesInAlignment=function(sa,Aa,Mb,P,wa,Qa,Nb,Gc,Uc,le){Mb=void 0===Mb?15:Mb;Qa=void 0===Qa?0:Qa;Nb=void 0===Nb?0:Nb;Gc=void 0===Gc?0:Gc;Uc=void 0===Uc?0:Uc;le=void 0===le?0:le;for(var Od=[],kf=[],ae=0;ae<Vb.edges.length;ae++){var Ke=$jscomp.makeIterator(Vb.edges[ae]),
$e=Ke.next().value,Cf=Ke.next().value;Ke=Ke.next().value;var rg=sa[Cf],Qf=Aa[Ke],Tc=Math.max(rg,Qf)-Math.min(rg,Qf);Tc>Mb||!(P&&!P.includes(Cf)||wa&&!wa.includes(Ke))&&("vertical"===$e?Od:kf).push({delta:Tc,edgeA:Cf,edgeB:Ke,edgeAVal:rg,edgeBVal:Qf,refPointsA:sa,refPointsB:Aa,distLeft:Qa,distTop:Nb,distRight:Gc,distBottom:Uc,maxDist:le})}return Od.length||kf.length?{vertical:Od,horizontal:kf}:null};Vb.findAlignedMorphs=function(sa,Aa,Mb,P,wa,Qa){Mb=void 0===Mb?15:Mb;P=void 0===P?Infinity:P;for(var Nb,
Gc=Vb.computeRefPoints(sa.bounds()),Uc=0;Uc<Aa.length;Uc++){var le=Aa[Uc];if(le!==sa){var Od=Vb.computeRefPoints(le.bounds()),kf=Math.max(0,Gc.left-Od.right),ae=Math.max(0,Od.left-Gc.right),Ke=Math.max(0,Gc.top-Od.bottom),$e=Math.max(0,Od.top-Gc.bottom);Math.max($e,Ke,ae,kf)>P||!(Od=Vb.findEdgesInAlignment(Gc,Od,Mb,wa,Qa,kf,Ke,ae,$e,Math.max($e,Ke,ae,kf)))||(Nb||(Nb=new Map),Nb.set(le,Od))}}sa=sa.owner;Aa=Vb.computeRefPoints(sa.innerBounds());if(Mb=Vb.findEdgesInAlignment(Gc,Aa,Mb))Nb||(Nb=new Map),
Nb.set(sa,Mb);return Nb};Vb.findMorphsWithSimilarWidthOrHeight=function(sa,Aa,Mb,P,wa){P=void 0===P?15:P;wa=void 0===wa?Infinity:wa;for(var Qa,Nb=Vb.computeRefPoints(sa.bounds()),Gc=0;Gc<Mb.length;Gc++){var Uc=Mb[Gc];if(Uc!==sa){var le=Vb.computeRefPoints(Uc.bounds()),Od=Math.max(0,Nb.left-le.right),kf=Math.max(0,le.left-Nb.right),ae=Math.max(0,Nb.top-le.bottom),Ke=Math.max(0,le.top-Nb.bottom),$e=Math.min(Ke,ae,kf,Od),Cf=Math.max(Ke,ae,kf,Od);if(!(Math.max(Ke,ae,kf,Od)>wa)){kf=Nb;Od=kf.width;kf=kf.height;
Ke=le;ae=Ke.width;Ke=Ke.height;var rg=ae-Od,Qf=Ke-kf;("x"===Aa||"xy"===Aa)&&Math.abs(rg)<=P&&(Qa||(Qa=new Map),Qa.set(Uc,{similarIn:"width",minDist:$e,maxDist:Cf,refPointsA:Nb,refPointsB:le,valA:Od,valB:ae,delta:rg}));("y"===Aa||"xy"===Aa)&&Math.abs(Qf)<=P&&(Qa||(Qa=new Map),Qa.set(Uc,{similarIn:"height",minDist:$e,maxDist:Cf,refPointsA:Nb,refPointsB:le,valA:kf,valB:Ke,delta:Qf}))}}}return Qa};Vb.closest=function(sa,Aa,Mb,P,wa,Qa,Nb,Gc){Gc=void 0===Gc?!0:Gc;var Uc=P[sa],le=wa[sa],Od=Qa[sa];Aa=Nb[sa];
for(var kf,ae,Ke,$e,Cf=0;Cf<wa.length;Cf++)sa===Cf||Uc<wa[Cf]||kf&&wa[kf.index]>=wa[Cf]||Gc&&Nb[sa]<Qa[Cf]||Qa[sa]>Nb[Cf]||(kf={index:Cf,dist:Uc-wa[Cf],refPointsA:Mb[sa],refPointsB:Mb[Cf]});for(Uc=0;Uc<P.length;Uc++)sa===Uc||le>P[Uc]||ae&&P[ae.index]<=P[Uc]||Gc&&Nb[sa]<Qa[Uc]||Qa[sa]>Nb[Uc]||(ae={index:Uc,dist:P[Uc]-le,refPointsA:Mb[sa],refPointsB:Mb[Uc]});for(le=0;le<Nb.length;le++)sa===le||Od<Nb[le]||Ke&&Nb[Ke.index]>=Nb[le]||Gc&&P[sa]>wa[le]||wa[sa]<P[le]||(Ke={index:le,dist:Od-Nb[le],refPointsA:Mb[sa],
refPointsB:Mb[le]});for(Nb=0;Nb<Qa.length;Nb++)sa===Nb||Aa>Qa[Nb]||$e&&Qa[$e.index]<=Qa[Nb]||Gc&&P[sa]>wa[Nb]||wa[sa]<P[Nb]||($e={index:Nb,dist:Qa[Nb]-Aa,refPointsA:Mb[sa],refPointsB:Mb[Nb]});return{l:kf,r:ae,t:Ke,b:$e}};Vb.computeClosestMorphs=function(sa){for(var Aa=[],Mb=[],P=[],wa=[],Qa=[],Nb=[],Gc=0;Gc<sa.length;Gc++){var Uc=Vb.computeRefPoints(sa[Gc].bounds());Qa.push(Uc);var le=Uc.right,Od=Uc.top,kf=Uc.bottom;Aa.push(Uc.left);Mb.push(le);P.push(Od);wa.push(kf)}for(Gc=0;Gc<sa.length;Gc++)Nb.push(Vb.closest(Gc,
sa,Qa,Aa,Mb,P,wa));return Nb};Vb.fun=Ab;Vb.pt=Rb;Vb.Color=jc;Vb.morph=cc;Vb.cachedGuideLines=new WeakMap;Vb.guideWidth=1;Vb.guideColor=Vb.Color.orange.lighter();Vb.removeSnapToGuidesOf=Q;Vb.removeSnapToGuidesOf=Q;Vb.showAndSnapToGuides=fa;Vb.showAndSnapToGuides=fa;Vb.showAndSnapToResizeGuides=Ia;Vb.showAndSnapToResizeGuides=Ia;Vb.edges=[["vertical","top","top"],["vertical","vCenter","top"],["vertical","bottom","top"],["vertical","top","vCenter"],["vertical","vCenter","vCenter"],["vertical","bottom",
"vCenter"],["vertical","top","bottom"],["vertical","vCenter","bottom"],["vertical","bottom","bottom"],["horizontal","left","left"],["horizontal","hCenter","left"],["horizontal","right","left"],["horizontal","left","hCenter"],["horizontal","hCenter","hCenter"],["horizontal","right","hCenter"],["horizontal","left","right"],["horizontal","hCenter","right"],["horizontal","right","right"]];var Ua=lively.FreezerRuntime.recorderFor("lively.halos/morph.js");Ua.Morph=je;Ua.Label=fd;Ua.StyleSheet=Yd;Ua.HorizontalLayout=
jd;Ua.Path=Pc;Ua.Text=vd;Ua.GridLayout=Ld;Ua.morph=cc;Ua.Icon=ge;Ua.createMorphSnapshot=Td;Ua.Color=jc;Ua.pt=Rb;Ua.rect=md;Ua.Rectangle=Za;Ua.LinearGradient=Db;Ua.obj=ac;Ua.PropertyPath=ic;Ua.promise=gd;Ua.properties=fe;Ua.num=Yb;Ua.arr=qc;Ua.connect=Ob;Ua.signal=Hc;Ua.disconnect=Yc;Ua.disconnectAll=cd;Ua.once=$b;Ua.showAndSnapToGuides=fa;Ua.showAndSnapToResizeGuides=Ia;Ua.removeSnapToGuidesOf=Q;Ua.haloBlue=Ua.Color.rgb(23,160,251);Ua.componentAccent=Ua.Color.magenta;Ua.derivedAccent=Ua.Color.purple;
var wc=function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("Halo")&&"function"===typeof Aa.Halo?Aa.Halo:Aa.Halo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"relayout",value:function(){this.alignWithTarget()}},{key:"keybindings",get:function(){return[{keys:{mac:"Meta-C",win:"Ctrl-C"},command:{command:"clipboard copy",passEvent:!0}}]}},{key:"commands",
get:function(){return[{name:"clipboard copy",doc:"copy selected morph(s) to clipboard",scrollCursorIntoView:!1,exec:function(P){P.copyHalo().copyToClipBoard()}}]}},{key:"removeIfDetached",value:function(){var P=this;setTimeout(function(){P.target.owner||P.remove()})}},{key:"initLayout",value:function(){var P=this.layout=new Ua.GridLayout({autoAssign:!1,fitToCell:!1,columns:[0,{fixed:36,paddingRight:10},2,{fixed:26},4,{fixed:26},6,{fixed:36,paddingLeft:10}],rows:[0,{fixed:36,paddingBottom:10},2,{fixed:26},
4,{fixed:26},6,{fixed:26},7,{fixed:36,paddingTop:10}],grid:[["menu",null,"grab",null,"drag",null,"close"],[null,null,null,null,null,null,null],["copy",null,null,null,null,null,"edit"],[null,null,null,null,null,null,null],["component",null,null,null,null,null,"inspect"],[null,null,null,null,null,null,null],["rotate",null,null,null,null,null,"resize"],[null,"name","name","name","name","name",null]]});P.col(1).row(7).group.align="center";P.col(1).row(7).group.resize=!1}},{key:"initButtons",value:function(){this.submorphs=
[].concat($jscomp.arrayFromIterable(this.ensureResizeHandles()),$jscomp.arrayFromIterable(this.resizeOnly?[]:[this.closeHalo(),this.dragHalo(),this.grabHalo(),this.menuHalo(),this.inspectHalo(),this.editHalo(),this.copyHalo(),this.componentHalo(),this.rotateHalo(),this.nameHalo(),this.originHalo()]))}},{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"isHalo",get:function(){return!0}},{key:"borderBox",get:function(){return this.getSubmorphNamed("border-box")||
this.addMorphBack(Ua.morph({name:"border-box",fill:Ua.Color.transparent,borderColor:this.target.isComponent?Ua.componentAccent:Ua.haloBlue,borderWidth:1}))}},{key:"pointerId",get:function(){return this.state?this.state.pointerId:null}},{key:"pointerId",set:function(P){this.state||(this.state={});this.state.pointerId=P}},{key:"prepareTarget",value:function(P){if(!Ua.obj.isArray(P))return P;if(1>=P.length)return P[0];P=P[0].world().addMorph(new Ua.MultiSelectionTarget({selectedMorphs:P}));P.alignWithSelection();
P.modifiesSelectedMorphs=!0;return P}},{key:"refocus",value:function(P){this.target=P;this.alignWithTarget()}},{key:"alignWithTarget",value:function(){if(!this.active&&this.target){var P=this.target.world()||$world,wa=P.visibleBounds(),Qa=this.target.globalBounds(),Nb=Qa.insetBy(-36).intersection(wa);wa=Qa.intersection(wa);this.layout&&this.layout.disable();this.setBounds(Nb.translatedBy(P.scroll.negated()));this.borderBox.setBounds($world.transformRectToMorph(this,wa));this.state.activeButton?(this.buttonControls.forEach(function(Gc){return Gc.visible=
!1}),this.ensureResizeHandles().forEach(function(Gc){return Gc.visible=!1}),this.state.activeButton.visible=!0,this.updatePropertyDisplay(this.state.activeButton)):(this.changingName&&this.nameHalo().toggleActive([!1]),this.ensureResizeHandles().forEach(function(Gc){return Gc.visible=!0}),this.buttonControls.forEach(function(Gc){Gc.visible=!0}),this.propertyDisplay.disable());this.nameHalo().alignInHalo();this.ensureResizeHandles().forEach(function(Gc){return Gc.alignInHalo()});this.resizeOnly||this.originHalo().alignInHalo();
this.layout&&this.layout.enable();return this}}},{key:"detachFromTarget",value:function(){var P=this.target;P&&(Ua.disconnect(P,"onChange",this,"alignWithTarget"),Ua.disconnect(P,"onOwnerChanged",this,"removeIfDetached"),P instanceof Ua.MultiSelectionTarget?(P.modifiesSelectedMorphs=!1,P.remove()):"function"===typeof P.detachedHalo&&P.detachedHalo(this))}},{key:"remove",value:function(){this.detachFromTarget();pb._get(Object.getPrototypeOf(Mb.prototype),"remove",this).call(this)}},{key:"morphsContainingPoint",
value:function(P){return P}},{key:"propertyDisplay",get:function(){return Ua.HaloPropertyDisplay.for(this)}},{key:"nameHalo",value:function(){return Ua.NameHaloItem.for(this)}},{key:"closeHalo",value:function(){return Ua.CloseHaloItem.for(this)}},{key:"grabHalo",value:function(){return Ua.GrabHaloItem.for(this)}},{key:"dragHalo",value:function(){return Ua.DragHaloItem.for(this)}},{key:"menuHalo",value:function(){return Ua.MenuHaloItem.for(this)}},{key:"inspectHalo",value:function(){return Ua.InspectHaloItem.for(this)}},
{key:"editHalo",value:function(){return Ua.EditHaloItem.for(this)}},{key:"rotateHalo",value:function(){return Ua.RotateHaloItem.for(this)}},{key:"copyHalo",value:function(){return Ua.CopyHaloItem.for(this)}},{key:"originHalo",value:function(){return Ua.OriginHaloItem.for(this)}},{key:"componentHalo",value:function(){return Ua.ComponentHaloItem.for(this)}},{key:"buttonControls",get:function(){return this.submorphs.filter(function(P){return P.isHaloItem&&!P.isResizeHandle})}},{key:"addMorphToSelection",
value:function(P){var wa=this,Qa,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gc){return 1==Gc.nextAddress?(Qa=wa.world(),Nb=wa.target.isMorphSelection?wa.target.selectedMorphs:[wa.target],wa.remove(),Gc.yield(Qa.showHaloForSelection([].concat($jscomp.arrayFromIterable(Nb),[P]),wa.state.pointerId),2)):Gc.return(Gc.yieldResult)})}},{key:"removeMorphFromSelection",value:function(P){var wa=this,Qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress){Qa=
wa.world();wa.remove();if(!wa.target.isMorphSelection)return Nb.jumpTo(0);Ua.arr.remove(wa.target.selectedMorphs,P);return Nb.yield(Qa.showHaloForSelection(wa.target.selectedMorphs,wa.state.pointerId),3)}return Nb.return(Nb.yieldResult)})}},{key:"isAlreadySelected",value:function(P){return this.target==P||this.target.isMorphSelection&&this.target.selectsMorph(P)}},{key:"updateBoundsFor",value:function(P,wa,Qa,Nb,Gc){var Uc={topLeft:Ua.rect(-1,-1,1,1),topCenter:wa?Ua.rect(1,-1,0,1):Ua.rect(0,-1,0,
1),topRight:Ua.rect(0,-1,1,1),rightCenter:wa?Ua.rect(0,1,1,1):Ua.rect(0,0,1,0),bottomRight:Ua.rect(0,0,1,1),bottomCenter:wa?Ua.rect(1,0,0,1):Ua.rect(0,0,0,1),bottomLeft:Ua.rect(-1,0,1,1),leftCenter:wa?Ua.rect(-1,1,1,0):Ua.rect(-1,0,1,0)}[P];Gc=Uc.x;var le=Uc.y,Od=Uc.width;Uc=Uc.height;Qa=wa?this.proportionalDelta(P,Qa,Nb):Qa;P=Ua.rect(Qa.x*Gc,Qa.y*le,Qa.x*Od,Qa.y*Uc);this.active=!0;this.target.setBounds(Nb.insetByRect(P));(this.target.isPolygon||this.target.isPath)&&this.target.moveBy(this.target.origin.negated());
this.active=!1;this.alignWithTarget()}},{key:"proportionalDelta",value:function(P,wa,Qa){var Nb=Qa.width,Gc=Qa.height;Qa={topLeft:Ua.pt(-1,-1),topCenter:Ua.pt(0,-1),topRight:Ua.pt(1,-1),leftCenter:Ua.pt(-1,0),rightCenter:Ua.pt(1,0),bottomLeft:Ua.pt(-1,1),bottomCenter:Ua.pt(0,1),bottomRight:Ua.pt(1,1)};var Uc=Nb/Math.max(Nb,Gc),le=Gc/Math.max(Gc,Nb);Nb={topLeft:Ua.pt(-Uc,-le),topCenter:Ua.pt(1/(2*Gc/Nb),-1),topRight:Ua.pt(Uc,-le),leftCenter:Ua.pt(-1,Gc/(2*Nb)),rightCenter:Ua.pt(1,Gc/(3*Nb)),bottomLeft:Ua.pt(-Uc,
le),bottomCenter:Ua.pt(1/(2*Gc/Nb),1),bottomRight:Ua.pt(Uc,le)};Qa=Qa[P];return Nb[P].scaleBy(Qa.dotProduct(wa)/Qa.dotProduct(Qa))}},{key:"ensureResizeHandles",value:function(){return Ua.ResizeHandle.resizersFor(this)}},{key:"updatePropertyDisplay",value:function(P){P=P.valueForPropertyDisplay();"undefined"!==typeof P?this.propertyDisplay.displayProperty(P):this.propertyDisplay.disable()}},{key:"toggleDiagonal",value:function(P,wa){if(!Ua.rect(0).sides.includes(wa)){var Qa=this.getSubmorphNamed("diagonal");
if(P){P=this.target.globalBounds();var Nb=P.width,Gc=P.height;P=this.localize(Ua.pt(P.x,P.y)).extent(Ua.pt(Nb,Gc)).scaleRectTo(this.innerBounds());Nb={topLeft:[Ua.pt(Nb,Gc),Ua.pt(0,0)],topRight:[Ua.pt(0,Gc),Ua.pt(Nb,0)],bottomRight:[Ua.pt(0,0),Ua.pt(Nb,Gc)],bottomLeft:[Ua.pt(Nb,0),Ua.pt(0,Gc)]};Qa?Qa.setBounds(P):(Qa=$jscomp.makeIterator(Nb[wa]),wa=Qa.next().value,Qa=Qa.next().value,Nb=new Ua.LinearGradient({stops:[{offset:0,color:Ua.Color.orange.withA(0)},{offset:.2,color:Ua.Color.orange},{offset:.8,
color:Ua.Color.orange},{offset:1,color:Ua.Color.orange.withA(0)}]}),Qa=this.addMorphBack(new Ua.Path({opacity:0,name:"diagonal",borderStyle:"dotted",borderWidth:5,bounds:P,borderColor:Nb,vertices:[wa,Qa]})),Qa.setBounds(P),Qa.animate({opacity:1,duration:500}))}else Qa&&Qa.fadeOut(500)}}},{key:"toggleRotationIndicator",value:function(P,wa){var Qa=this.getSubmorphNamed("rotationIndicator");P&&wa?(P=this.getSubmorphNamed("origin").center,Qa=Qa||this.addMorphBack(new Ua.Path({name:"rotationIndicator",
borderColor:Ua.haloBlue,borderWidth:1,vertices:[]})),Qa.setBounds(wa.bounds().union(this.innerBounds())),Qa.vertices=[Qa.localizePointFrom(P,this),Qa.localizePointFrom(wa.center,this)]):Qa&&Qa.remove()}},{key:"toggleMorphHighlighter",value:function(P,wa,Qa){Qa=void 0===Qa?!1:Qa;if(wa.onHaloGrabover)wa.onHaloGrabover(P);else Qa=Ua.MorphHighlighter.for(this,wa,Qa),P&&wa&&wa!=this.world()?Qa&&Qa.show(wa):Qa&&Qa.deactivate()}},{key:"onMouseDown",value:function(P){var wa=P.state.clickedOnMorph;if(!P.isCommandKey()&&
wa==this.borderBox)return this.remove();if(P.isShiftDown()&&P.isCommandKey())P=this.target.isMorphSelection?this.target.morphBeneath(P.position):this.morphBeneath(P.position),this.isAlreadySelected(P)?this.removeMorphFromSelection(P):this.addMorphToSelection(P);else{if(wa==this.borderBox&&P.isCommandKey()){var Qa=P.world.morphsContainingPoint(P.position).filter(function(Nb){return Nb.halosEnabled});(Qa=Qa.slice(Qa.indexOf(this.target)+1)[0]||Qa[0]||P.world)&&P.world.showHaloFor(Qa,P.domEvt.pointerId);
this.remove()}wa==this&&P.isCommandKey()&&(Qa=this.morphBeneath(P.position),P.world.showHaloFor(Qa,P.domEvt.pointerId));wa==this&&this.remove()}}},{key:"onKeyUp",value:function(P){this.changingName||this.buttonControls.map(function(wa){return wa.onKeyUp(P)})}},{key:"getMesh",value:function(P,wa){var Qa=P.x;P=P.y;wa=void 0===wa?Ua.pt(0,0):wa;var Nb=this.world().visibleBounds(),Gc=Nb.height;Nb=Nb.width;var Uc={borderStyle:"dotted",borderWidth:2,borderColor:Ua.Color.orange};Uc=this.get("mesh")||this.addMorph(new Ua.Morph({name:"mesh",
styleClasses:["halo-mesh"],extent:Ua.pt(Nb,Gc),fill:null,submorphs:[new Ua.Path(Object.assign({name:"vertical"},Uc)),new Ua.Path(Object.assign({name:"horizontal"},Uc))]}));Uc.globalPosition=wa;Uc.getSubmorphNamed("vertical").vertices=[Ua.pt(Qa,0).subPt(wa),Ua.pt(Qa,Gc).subPt(wa)];Uc.getSubmorphNamed("horizontal").vertices=[Ua.pt(0,P).subPt(wa),Ua.pt(Nb,P).subPt(wa)];return Uc}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Halo"}},{key:"properties",get:function(){return{fill:{defaultValue:Ua.Color.transparent},
resizeOnly:{defaultValue:!1},pointerId:{},hasFixedPosition:{defaultValue:!0},respondsToVisibleWindow:{defaultValue:!0},submorphs:{after:["target"],initialize:function(){this.initButtons();this.alignWithTarget()}},layout:{after:["submorphs"],initialize:function(){this.initLayout()}},hasTinyTarget:{derived:!0,get:function(){return 40>this.target.bounds().extent().dist(Ua.pt(0))}},target:{get:function(){return this.state?this.state.target:null},set:function(P){this.state||(this.state={});var wa=!!this.state.target;
this.detachFromTarget();P=this.prepareTarget(P);this.state.target=P;wa&&this.alignWithTarget();Ua.connect(P,"onChange",this,"alignWithTarget");Ua.connect(P,"onOwnerChanged",this,"removeIfDetached")}}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:895,end:16994})}(Ua.Morph);wc=Ua.Halo;
var oe=Da("H",wc);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("HaloPropertyDisplay")&&"function"===typeof Aa.HaloPropertyDisplay?Aa.HaloPropertyDisplay:Aa.HaloPropertyDisplay=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"isHaloItem",get:function(){return!1}},{key:"halo",get:function(){return this.owner}},{key:"displayedValue",value:function(){return this.textString}},
{key:"displayProperty",value:function(P){var wa=this.halo.state.activeButton;P=String(P);this.visible=!0;this.textString=P;this.position=this.constructor.defaultPosition;this.bounds().insetBy(10).intersects(wa.bounds())&&(this.position=Ua.pt(wa.topRight.x+10,this.position.y))}},{key:"disable",value:function(){this.position=this.constructor.defaultPosition;this.visible=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"HaloPropertyDisplay"}},{key:"morphName",get:function(){return"propertyDisplay"}},
{key:"defaultPosition",get:function(){return Ua.pt(25,0)}},{key:"for",value:function(P){return P.getSubmorphNamed(this.morphName)||P.addMorph(new this({name:this.morphName}))}},{key:"properties",get:function(){return{name:{defaultValue:this.name},fill:{defaultValue:Ua.Color.black.withA(.7)},borderRadius:{defaultValue:7},padding:{defaultValue:Ua.Rectangle.inset(5)},visible:{defaultValue:!1},readOnly:{defaultValue:!0},fontSize:{defaultValue:12},fontColor:{defaultValue:Ua.Color.white},position:{defaultValue:this.defaultPosition}}}}],
Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:17185,end:18532})})(Ua.Label);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("MultiSelectionTarget")&&"function"===typeof Aa.MultiSelectionTarget?Aa.MultiSelectionTarget:Aa.MultiSelectionTarget=
function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"isHaloItem",get:function(){return!0}},{key:"isMorphSelection",get:function(){return!0}},{key:"selectsMorph",value:function(P){return this.selectedMorphs.includes(P)}},{key:"alignWithSelection",value:function(){var P=this.selectedMorphs.map(function(wa){return wa.globalBounds()}).reduce(function(wa,Qa){return wa.union(Qa)});this.setBounds(P)}},{key:"onGrab",
value:function(P){this.grabbingHand=P.hand;this.selectionGrabbed=!0;P.hand.grab(this.selectedMorphs);Ua.once(P.hand,"dropMorphsOn",this,"onGrabEnd");Ua.connect(P.hand,"position",this,"alignWithSelection")}},{key:"onGrabEnd",value:function(){this.selectionGrabbed=!1;Ua.disconnectAll(this.grabbingHand)}},{key:"updateExtent",value:function(P){var wa=P.value.subPt(P.prevValue);this.selectedMorphs.forEach(function(Qa){return Qa.resizeBy(wa)})}},{key:"updatePosition",value:function(P){if(!this.selectionGrabbed){var wa=
P.value.subPt(P.prevValue);this.selectedMorphs.forEach(function(Qa){return Qa.moveBy(wa)})}}},{key:"updateRotation",value:function(P){var wa=this,Qa=P.value-P.prevValue;this.selectedMorphs.forEach(function(Nb){var Gc=Nb.origin;Nb.adjustOrigin(Nb.localize(wa.worldPoint(Ua.pt(0,0))));Nb.rotation+=Qa;Nb.adjustOrigin(Gc)})}},{key:"updateScale",value:function(P){var wa=this,Qa=P.value-P.prevValue;this.selectedMorphs.forEach(function(Nb){var Gc=Nb.origin;Nb.adjustOrigin(Nb.localize(wa.worldPoint(Ua.pt(0,
0))));Nb.scale+=Qa;Nb.adjustOrigin(Gc)})}},{key:"onChange",value:function(P){pb._get(Object.getPrototypeOf(Mb.prototype),"onChange",this).call(this,P);if(this.modifiesSelectedMorphs){switch(P.prop){case "extent":this.updateExtent(P);break;case "scale":this.updateScale(P);break;case "position":this.updatePosition(P);break;case "rotation":this.updateRotation(P)}return P}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MultiSelectionTarget"}},{key:"properties",get:function(){return{visible:{defaultValue:!1},
modifiesSelectedMorphs:{defaultValue:!1},selectedMorphs:{defaultValue:[]}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:18600,end:20818})})(Ua.Morph);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("HaloItem")&&"function"===typeof Aa.HaloItem?
Aa.HaloItem:Aa.HaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"menuItems",value:function(){return[]}},{key:"init",value:function(){}},{key:"update",value:function(){}},{key:"stop",value:function(){}},{key:"valueForPropertyDisplay",value:function(){}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"HaloItem"}},
{key:"properties",get:function(){return{borderRadius:{defaultValue:15},nativeCursor:{defaultValue:"pointer"},fill:{defaultValue:Ua.Color.gray.withA(.7)},grabbable:{defaultValue:!1},extent:{defaultValue:Ua.pt(24,24)},halo:{}}}},{key:"for",value:function(P){return P.getSubmorphNamed(this.morphName)||P.addMorph(new this({halo:P,name:this.morphName}))}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:20984,end:21661})})(Ua.Morph);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("NameHolder")&&"function"===typeof Aa.NameHolder?Aa.NameHolder:Aa.NameHolder=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"onHoverIn",value:function(P){this.highlightOnHover&&this.nameHolder.active&&
(this.halo.toggleMorphHighlighter(!0,this.target),this.nameHolder.fontColor=Ua.Color.orange)}},{key:"onHoverOut",value:function(P){this.highlightOnHover&&(this.halo.toggleMorphHighlighter(!1,this.target),this.nameHolder.fontColor=Ua.Color.darkgray)}},{key:"accept",value:function(){this.target.name!==this.nameHolder.textString&&this.updateName(this.nameHolder.textString)}},{key:"onKeyDown",value:function(P){"Enter"==P.keyCombo?(this.accept(),P.stop()):pb._get(Object.getPrototypeOf(Mb.prototype),"onKeyDown",
this).call(this,P)}},{key:"onMouseUp",value:function(){Ua.signal(this,"active",[!0,this])}},{key:"onMouseDown",value:function(P){this.nameHolder.fontColor=Ua.Color.white;this.halo.toggleMorphHighlighter(!1,this.target)}},{key:"onKeyUp",value:function(P){P=this.nameHolder.textString;var wa=this.target.owner;this.validName=!wa||!wa.getSubmorphNamed(P)||this.target.name==P;Ua.signal(this,"valid",[this.validName,P])}},{key:"update",value:function(){var P=this;this.nameHolder.textString!==this.target.name&&
(this.nameHolder.textString=this.target.name,this.whenRendered().then(function(){return P.nameHolder.fit()}))}},{key:"activate",value:function(){this.nameHolder.readOnly=!1;this.nameHolder.active=!0;this.nameHolder.animate({opacity:1})}},{key:"deactivate",value:function(){this.nameHolder.readOnly=!0;this.nameHolder.active=!1;this.nameHolder.animate({opacity:.3})}},{key:"updateName",value:function(P){if(!this.forceUniqueName||this.validName)this.target.name=P,Ua.signal(this,"active",[!1,this])}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHolder"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Click to edit the morph's name"},draggable:{defaultValue:!1},fill:{defaultValue:Ua.Color.transparent},forceUniqueName:{defaultValue:!1},halo:{},layout:{after:["nameHolder"],initialize:function(){this.layout=new Ua.HorizontalLayout({resizeContainer:!0,spacing:7})}},nameHolder:{after:["submorphs"],initialize:function(){this.nameHolder=this.addMorph(new Ua.Text({fill:Ua.Color.transparent,
fontColor:Ua.Color.white,fontWeight:"bold",active:!0}));Ua.connect(this.nameHolder,"onBlur",this,"accept")}}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21698,end:24232})})(Ua.Morph);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("NameHaloItem")&&
"function"===typeof Aa.NameHaloItem?Aa.NameHaloItem:Aa.NameHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){pb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,P);this.initNameHolders();this.validityIndicator=Ua.Icon.makeLabel("check",{fontColor:Ua.Color.green,fontSize:15,padding:Ua.rect(4,
6,4,0)});this.fill=this.halo.target.isComponent?Ua.componentAccent:Ua.haloBlue;this.alignInHalo()}},{key:"targets",value:function(){return this.halo.target?this.halo.target.isMorphSelection?this.halo.target.selectedMorphs.map(function(P){return{target:P,highlightOnHover:!0}}):[{target:this.halo.target,highlightOnHover:!1}]:[]}},{key:"initNameHolders",value:function(){var P=this;this.nameHolders=this.targets().map(function(wa){wa=new Ua.NameHolder({halo:P.halo,highlightOnHover:wa.highlightOnHover,
target:wa.target});Ua.connect(wa,"active",P,"toggleActive");Ua.connect(wa,"valid",P,"toggleNameValid");return wa});this.submorphs=Ua.arr.interpose(this.nameHolders,{extent:Ua.pt(1,28),fill:Ua.Color.black.withA(.4)})}},{key:"toggleActive",value:function(P){P=$jscomp.makeIterator(P);var wa=P.next().value,Qa=P.next().value;this.halo.changingName!==wa&&((this.halo.changingName=wa)?(this.nameHolders.forEach(function(Nb){return Nb!=Qa&&Nb.deactivate()}),this.borderWidth=3,this.addMorph(this.validityIndicator),
this.fill=Ua.Color.darkGray,setTimeout(function(){return Qa.nameHolder.selectAll()})):(this.fill=Ua.haloBlue,this.nameHolders.forEach(function(Nb){return Nb!=Qa&&Nb.activate()}),this.borderWidth=0,this.validityIndicator.remove(),this.halo.focus()),this.alignInHalo())}},{key:"toggleNameValid",value:function(P){var wa=$jscomp.makeIterator(P);P=wa.next().value;wa=wa.next().value;(this.validName=P)?(this.conflictingMorph=null,this.borderColor=Ua.Color.green,this.validityIndicator.nativeCursor="auto",
this.validityIndicator.fontColor=Ua.Color.green,Ua.Icon.setIcon(this.validityIndicator,"check")):(this.conflictingMorph=this.get(wa),this.borderColor=Ua.Color.red,this.validityIndicator.fontColor=Ua.Color.red,this.validityIndicator.nativeCursor="pointer",Ua.Icon.setIcon(this.validityIndicator,"exclamation-circle"))}},{key:"alignInHalo",value:function(){Ua.arr.zip(this.targets(),this.nameHolders).map(function(wa){var Qa=$jscomp.makeIterator(wa);wa=Qa.next().value.target;Qa=Qa.next().value;Qa.target=
wa;Qa.update()});var P=this.halo.innerBounds().bottomCenter().addPt(Ua.pt(0,2));this.topCenter=Ua.pt(Math.max(P.x,30),Math.max(P.y,80))}},{key:"onMouseDown",value:function(P){var wa=this,Qa=this.conflictingMorph;Qa&&(this.halo.toggleMorphHighlighter(!0,Qa),setTimeout(function(){return wa.halo.toggleMorphHighlighter(!1,Qa)},1E3))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHaloItem"}},{key:"morphName",get:function(){return"name"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:4},
fill:{defaultValue:Ua.haloBlue},borderColor:{defaultValue:Ua.Color.green},layout:{initialize:function(){this.layout=new Ua.HorizontalLayout({resizeContainer:!0,spacing:0})}}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:24234,end:27401})})(Ua.HaloItem);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Mb=Aa.hasOwnProperty("CloseHaloItem")&&"function"===typeof Aa.CloseHaloItem?Aa.CloseHaloItem:Aa.CloseHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"update",value:function(){var P=this.halo,wa=P.target.owner;wa.undoStart("close-halo");P.target.selectedMorphs?P.target.selectedMorphs.forEach(function(Qa){return Qa.remove()}):P.target.remove();wa.undoStop("close-halo");P.remove()}},{key:"onMouseDown",
value:function(P){this.update()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CloseHaloItem"}},{key:"morphName",get:function(){return"close"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["fas","fa-times"]},draggable:{defaultValue:!1},tooltip:{defaultValue:"Remove this morph from the world"}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:27404,end:28010})})(Ua.HaloItem);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("GrabHaloItem")&&"function"===typeof Aa.GrabHaloItem?Aa.GrabHaloItem:Aa.GrabHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"adjustTarget",value:function(P,wa){Ua.PropertyPath("owner.layout.autoResize").get(P)&&
!P.globalBounds().insetBy(10).containsPoint(wa)&&(P=P.owner);return P}},{key:"valueForPropertyDisplay",value:function(){var P=this.hand,wa=this.halo,Qa=this.prevDropTarget,Nb=P.world(),Gc=P.findDropTarget(P.globalPosition,[wa.target],function(Uc){return!Uc.isHaloItem&&!Uc.ownerChain().some(function(le){return le.isHaloItem||!le.visible||0==le.opacity})});Gc=this.adjustTarget(Gc,P.globalPosition);wa.toggleMorphHighlighter(Gc&&Gc!=Nb,Gc,!0);Qa&&Qa!=Gc&&wa.toggleMorphHighlighter(!1,Qa);return(this.prevDropTarget=
Gc)&&Gc.name}},{key:"init",value:function(P){var wa=this.halo,Qa=wa.target.undoStart("grab-halo");Qa&&Qa.addTarget(wa.target.owner);this.hand=P;wa.target.onGrab({halo:wa,hand:P,isShiftDown:function(){return!1}});wa.state.activeButton=this;this.opacity=.3;var Nb=Ua.connect(P,"update",this,"update");Ua.once(wa.target,"remove",function(){return Nb.disconnect()})}},{key:"stop",value:function(P){var wa=this.halo,Qa=this.prevDropTarget,Nb=wa.target.undoInProgress,Gc=P.hand.findDropTarget(P.hand.globalPosition,
[wa.target],function(Uc){return!Uc.isHaloItem&&!Uc.ownerChain().some(function(le){return le.isHaloItem})});Gc=this.adjustTarget(Gc,P.hand.globalPosition);Ua.disconnect(P.hand,"update",this,"update");Ua.MorphHighlighter.interceptDrop(wa,Gc,wa.target);Nb.addTarget(Gc);Gc.onDrop(P);wa.state.activeButton=null;wa.alignWithTarget();wa.toggleMorphHighlighter(!1,Qa);Ua.MorphHighlighter.removeHighlighters(wa);wa.target.undoStop("grab-halo");this.opacity=1}},{key:"update",value:function(){this.halo.alignWithTarget()}},
{key:"onDragStart",value:function(P){this.init(P.hand)}},{key:"onDragEnd",value:function(P){this.stop(P)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrabHaloItem"}},{key:"morphName",get:function(){return"grab"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["far","fa-hand-rock"]},tooltip:{defaultValue:"Grab the morph"},draggable:{defaultValue:!0}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:28013,end:30518})})(Ua.HaloItem);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("DragHaloItem")&&"function"===typeof Aa.DragHaloItem?Aa.DragHaloItem:Aa.DragHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,
sa,[{key:"valueForPropertyDisplay",value:function(){return this.halo.target.position}},{key:"updateAlignmentGuide",value:function(P){var wa=this.halo.getSubmorphNamed("mesh");if(P)return wa=this.halo.getMesh(this.halo.target.worldPoint(Ua.pt(0,0))),this.focus(),wa;wa&&wa.remove()}},{key:"init",value:function(){var P=this.halo.target;P.undoStart("drag-halo");this.halo.state.activeButton=this;this.actualPos=P.position;this.targetTransform=P.owner.getGlobalTransform().inverse()}},{key:"stop",value:function(){this.halo.target.undoStop("drag-halo");
this.halo.state.activeButton=null;this.halo.alignWithTarget();this.updateAlignmentGuide(!1);Ua.removeSnapToGuidesOf(this.halo.target)}},{key:"update",value:function(P,wa,Qa){wa=void 0===wa?!1:wa;Qa=void 0===Qa?!1:Qa;this.actualPos=P=this.actualPos.addPt(this.targetTransform.transformDirection(P));wa&&(P=P.griddedBy(Ua.pt(10,10)));this.halo.target.position=P;this.updateAlignmentGuide(wa);wa||Ua.showAndSnapToGuides(this.halo.target,!0,Qa,5,500)}},{key:"onDragStart",value:function(P){this.init()}},{key:"onDrag",
value:function(P){this.update(P.state.dragDelta,P.isAltDown(),P.isCtrlDown())}},{key:"onDragEnd",value:function(P){this.stop()}},{key:"onKeyUp",value:function(P){this.updateAlignmentGuide(!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DragHaloItem"}},{key:"morphName",get:function(){return"drag"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},styleClasses:{defaultValue:["fas","fa-arrows-alt"]},tooltip:{defaultValue:"Change the morph's position. Press (alt) while dragging to align the morph's position along a grid."}}}}],
Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:30521,end:32332})})(Ua.HaloItem);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("InspectHaloItem")&&"function"===typeof Aa.InspectHaloItem?Aa.InspectHaloItem:Aa.InspectHaloItem=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"onMouseDown",value:function(P){var wa=this;(function(){var Qa,Nb,Gc,Uc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(le){if(1==le.nextAddress)return le.yield(System.import("lively.ide/js/inspector.js"),2);Qa=le.yieldResult;Nb=Qa.default;(Gc=wa.world().getSubmorphsByStyleClassName("Inspector").find(function(Od){return Od.targetObject==wa.halo.target}))&&
(Uc=Gc.getWindow())?(Uc.minimized=!1,Uc.animate({center:wa.world().visibleBounds().center(),duration:200})):Nb.openInWindow({targetObject:wa.halo.target});wa.halo.remove();le.jumpToEnd()})})()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectHaloItem"}},{key:"morphName",get:function(){return"inspect"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Inspect the morph's local state"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-cogs"]}}}}],
Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:32335,end:33237})})(Ua.HaloItem);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("EditHaloItem")&&"function"===typeof Aa.EditHaloItem?Aa.EditHaloItem:Aa.EditHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"onMouseDown",value:function(P){var wa=this;(P=this.world().getSubmorphsByStyleClassName("ObjectEditor").find(function(Qa){return Qa.target==wa.halo.target}))?(P=P.getWindow(),P.bringToFront(),P.minimized=!1,P.animate({center:this.world().visibleBounds().center(),duration:200})):$world.execCommand("open object editor",{target:this.halo.target});this.halo.remove()}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"EditHaloItem"}},{key:"morphName",get:function(){return"edit"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Edit the morph's definition"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-wrench"]}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:33240,end:34022})})(Ua.HaloItem);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("RotateHaloItem")&&"function"===typeof Aa.RotateHaloItem?Aa.RotateHaloItem:Aa.RotateHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){pb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,P);this.adaptAppearance(!1)}},{key:"angle",get:function(){return this.getProperty("angle")||0}},{key:"angle",set:function(P){this.setProperty("angle",P)}},{key:"scaleGauge",get:function(){return this.getProperty("scaleGauge")||null}},{key:"scaleGauge",set:function(P){this.setProperty("scaleGauge",P)}},{key:"initRotation",get:function(){return this.getProperty("initRotation")||0}},{key:"initRotation",set:function(P){this.setProperty("initRotation",P)}},{key:"valueForPropertyDisplay",
value:function(){var P=this.halo.target;return this.scaleGauge?P.scale.toFixed(4).toString():Ua.num.toDegrees(P.rotation).toFixed(1)+"\u00b0"}},{key:"init",value:function(P){this.detachFromLayout();this.halo.target.undoStart("rotate-halo");this.halo.state.activeButton=this;this.angle=P;this.initRotation=this.halo.target.rotation;this.halo.toggleRotationIndicator(!0,this)}},{key:"initScale",value:function(P){this.detachFromLayout();this.halo.state.activeButton=this;this.scaleGauge=P.scaleBy(1/this.halo.target.scale);
this.halo.toggleRotationIndicator(!0,this)}},{key:"update",value:function(P){this.scaleGauge=null;P=this.initRotation+(P-this.angle);P=Ua.num.toRadians(Ua.num.detent(Ua.num.toDegrees(P),10,45));this.halo.target.rotation=P;this.halo.toggleRotationIndicator(!0,this)}},{key:"updateScale",value:function(P){var wa=this.scaleGauge,Qa=this.halo;wa||(wa=this.scaleGauge=P.scaleBy(1/Qa.target.scale));this.angle=P.theta();this.initRotation=Qa.target.rotation;Qa.target.scale=Ua.num.detent(P.dist(Ua.pt(0,0))/
wa.dist(Ua.pt(0,0)),.1,.5);Qa.toggleRotationIndicator(!0,this)}},{key:"stop",value:function(){this.attachToLayout();this.scaleGauge=null;this.halo.state.activeButton=null;this.halo.alignWithTarget();this.halo.toggleRotationIndicator(!1,this);this.halo.target.undoStop("rotate-halo");this.halo.ensureResizeHandles()}},{key:"adaptAppearance",value:function(P){this.styleClasses=["fas",P?"fa-search-plus":"fa-redo"];this.tooltip=P?"Scale morph":"Rotate morph"}},{key:"detachFromLayout",value:function(){this.savedLayout=
this.halo.layout;this.halo.layout=null}},{key:"attachToLayout",value:function(){this.halo.layout=this.savedLayout}},{key:"onDragStart",value:function(P){this.adaptAppearance(P.isShiftDown());P.isShiftDown()?this.initScale(P.position.subPt(this.halo.target.globalPosition)):this.init(P.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDrag",value:function(P){this.globalPosition=P.position.addPt(Ua.pt(-10,-10));this.adaptAppearance(P.isShiftDown());P.isShiftDown()?this.updateScale(P.position.subPt(this.halo.target.globalPosition)):
this.update(P.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDragEnd",value:function(P){this.adaptAppearance(P.isShiftDown());this.stop()}},{key:"onKeyDown",value:function(P){this.adaptAppearance(P.isShiftDown())}},{key:"onKeyUp",value:function(P){this.adaptAppearance(P.isShiftDown())}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RotateHaloItem"}},{key:"morphName",get:function(){return"rotate"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0}}}}],
Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:34024,end:37468})})(Ua.HaloItem);Ua.nameNumberRe=/(.+)([0-9]+)$/;(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("ComponentHaloItem")&&"function"===typeof Aa.ComponentHaloItem?Aa.ComponentHaloItem:
Aa.ComponentHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"updateComponentIndicator",value:function(){var P=this.world(),wa=this.halo.target;this.halo.remove();P.showHaloFor(wa)}},{key:"onMouseDown",value:function(){this.halo.target.isComponent=!this.halo.target.isComponent;this.updateComponentIndicator()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ComponentHaloItem"}},
{key:"morphName",get:function(){return"component"}},{key:"properties",get:function(){return{tooltip:{get:function(){return this.halo.target.isComponent?"Retract Component":"Turn into Component"}},styleClasses:{initialize:function(){this.styleClasses=this.halo.target.isComponent?["fas","fa-eraser"]:["fas","fa-cube"]}}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:37510,end:38256})})(Ua.HaloItem);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("CopyHaloItem")&&"function"===typeof Aa.CopyHaloItem?Aa.CopyHaloItem:Aa.CopyHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"init",value:function(P){function wa(kf,ae){return ae.match(Ua.nameNumberRe)?
ae.replace(Ua.nameNumberRe,function(Ke,$e,Cf){Cf||(Cf="0");for(Ke=Number(Cf);kf.get($e+ ++Ke););return $e+Ke}):ae+"1"}var Qa=this.halo,Nb=Qa.target,Gc=Qa.world(),Uc=Nb instanceof Ua.MultiSelectionTarget;Qa.remove();Ua.connect(P,"update",this,"update");if(Uc){var le=Nb.selectedMorphs.map(function(kf){return Gc.addMorph(kf.copy())});Uc=le.map(function(kf){kf.name=wa(Nb,kf.name);return kf.position});le[0].undoStart("copy-halo");Gc.addMorph(Qa);Qa.refocus(le);P.grab(Qa.target);Qa.target.onGrab({halo:Qa,
hand:P,isShiftDown:function(){return!1}});Uc.forEach(function(kf,ae){return le[ae].globalPosition=kf});Qa.alignWithTarget()}else{Uc=Nb.globalPosition;var Od=Nb.copy();Nb.isComponent&&(Od.isComponent=!1,Od.withAllSubmorphsDoExcluding(function(kf){kf!=Od&&kf.master||delete kf._parametrizedProps},function(kf){return kf.master&&kf!=Od}),Od.master=Nb);Od.name=wa(Nb,Nb.name);Gc.addMorph(Od);Od.globalPosition=Uc;Od.undoStart("copy-halo");P.grab(Od);Gc.addMorph(Qa);Qa.visible=!1}}},{key:"stop",value:function(P){var wa=
this.halo,Qa=$jscomp.makeIterator(P.grabbedMorphs).next().value,Nb=P.findDropTarget(P.globalPosition,[wa.target],function(Uc){return!Uc.isHaloItem&&!Uc.ownerChain().some(function(le){return le.isHaloItem})}),Gc=wa.target.undoInProgress;Ua.disconnect(P,"update",this,"update");Gc.addTarget(Nb);P.dropMorphsOn(Nb);wa.target.undoStop("copy-halo");wa.remove();P.world().showHaloFor(Qa)}},{key:"onDragStart",value:function(P){this.init(P.hand)}},{key:"onDragEnd",value:function(P){this.stop(P.hand)}},{key:"update",
value:function(){this.halo.alignWithTarget()}},{key:"copyToClipBoard",value:function(){var P=this,wa,Qa,Nb,Gc,Uc,le,Od,kf,ae,Ke,$e,Cf,rg,Qf,Tc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rf){switch(Rf.nextAddress){case 1:wa=P;Qa=wa.halo;if(Qa.nameHalo().nameHolders.find(function(Fg){return Fg.nameHolder===$world.focusedMorph}))return Rf.return();Nb=Qa.target;Gc=Qa.world();Uc=Nb instanceof Ua.MultiSelectionTarget;le=Nb.globalBounds().topLeft();Od=Uc?Nb.selectedMorphs:[Nb];kf=[];ae=
'<!DOCTYPE html>\n          <html lang="en">\n          <head>\n            <meta charset="utf-8">\n            '+document.querySelector("#lively-morphic-css").outerHTML+"\n          </head>\n          <body>";Qa.remove();Rf.setCatchFinallyBlocks(2);Ke=$jscomp.makeIterator(Od);$e=Ke.next();case 4:if($e.done)return ae+="</body></html>",Qf=JSON.stringify(kf),Rf.yield(P.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/html",data:ae},{type:"application/morphic",data:Qf}]),8);Cf=$e.value;return Rf.yield(Ua.createMorphSnapshot(Cf,
{addPreview:!1,testLoad:!1}),7);case 7:rg=Rf.yieldResult;rg.copyMeta={offset:Cf.worldPoint(Ua.pt(0,0)).subPt(le)};kf.push(rg);ae+=Cf.renderPreview();$e=Ke.next();Rf.jumpTo(4);break;case 8:Rf.leaveTryBlock(3);break;case 2:return Tc=Rf.enterCatchBlock(),Gc.logError(Tc),Rf.return();case 3:Gc.addMorph(Qa),Qa.refocus(Od),Qa.setStatusMessage("copied"),Rf.jumpToEnd()}})}},{key:"onMouseUp",value:function(P){var wa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){P.stop();return Qa.yield(wa.copyToClipBoard(),
0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CopyHaloItem"}},{key:"morphName",get:function(){return"copy"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},tooltip:{defaultValue:"Copy morph"},styleClasses:{defaultValue:["far","fa-clone"]}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:38258,end:42247})})(Ua.HaloItem);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("OriginHaloItem")&&"function"===typeof Aa.OriginHaloItem?Aa.OriginHaloItem:Aa.OriginHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"fill",get:function(){return Ua.Color.white.interpolate(.2,this.borderColorTop)}},{key:"extent",get:function(){return Ua.pt(15,
15)}},{key:"tooltip",get:function(){return"Change the morph's origin"}},{key:"computePositionAtTarget",value:function(){return this.halo.localize(this.halo.target.globalPosition)}},{key:"alignInHalo",value:function(){this.visible=!this.halo.hasTinyTarget;this.center=this.computePositionAtTarget()}},{key:"valueForPropertyDisplay",value:function(){return this.halo.target.origin}},{key:"init",value:function(){this.halo.target.undoStart("origin-halo");this.halo.state.activeButton=this}},{key:"stop",value:function(){this.halo.target.undoStop("origin-halo");
this.halo.state.activeButton=null;this.halo.alignWithTarget()}},{key:"update",value:function(P){var wa=this.halo,Qa=wa.target.origin,Nb=wa.target.worldPoint(Qa);P=wa.target.localize(Nb.addPt(P)).subPt(wa.target.scroll).subPt(Qa);wa.target.adjustOrigin(wa.target.origin.addPt(P))}},{key:"onDragStart",value:function(P){this.init()}},{key:"onDragEnd",value:function(P){this.stop()}},{key:"onDrag",value:function(P){this.update(P.state.dragDelta)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"OriginHaloItem"}},
{key:"morphName",get:function(){return"origin"}},{key:"properties",get:function(){return{borderWidth:{defaultValue:3},nativeCursor:{defaultValue:"-webkit-grab"},draggable:{defaultValue:!0},borderColor:{after:["halo"],initialize:function(){this.borderColor=this.halo.target.isComponent?Ua.componentAccent:Ua.haloBlue}}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:42250,end:43881})})(Ua.HaloItem);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("ResizeHandle")&&"function"===typeof Aa.ResizeHandle?Aa.ResizeHandle:Aa.ResizeHandle=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"valueForPropertyDisplay",value:function(){var P=this.halo.target.extent,
wa=P.y;return P.x.toFixed(1)+"x"+wa.toFixed(1)}},{key:"positionInHalo",value:function(){var P=this.halo.borderBox.bounds();this.halo.hasTinyTarget&&(Ua.Rectangle.prototype.sides.includes(this.location)&&(this.visible=!1),P=P.insetBy(-4));return P.partNamed(this.location)}},{key:"alignInHalo",value:function(){this.center=this.positionInHalo();return this}},{key:"onKeyUp",value:function(P){this.halo.state.activeButton==this&&this.halo.toggleDiagonal(P.isShiftDown(),this.corner)}},{key:"onKeyDown",value:function(P){this.halo.state.activeButton==
this&&this.halo.toggleDiagonal(P.isShiftDown(),this.corner)}},{key:"onDragStart",value:function(P){this.init(P.position,P.isShiftDown())}},{key:"onDragEnd",value:function(P){this.stop(P.isShiftDown())}},{key:"onDrag",value:function(P){this.update(P.position,P.isShiftDown(),P.isAltDown(),P.isCtrlDown());this.focus()}},{key:"init",value:function(P,wa){wa=void 0===wa?!1:wa;var Qa=this.halo.target,Nb=Qa.origin,Gc=Qa.position;Qa=Qa.extent;this.startPos=P;this.startBounds=Gc.subPt(Nb).extent(Qa);this.startOrigin=
this.halo.target.origin;this.savedLayout=this.halo.layout;this.halo.layout=null;this.halo.state.activeButton=this;this.tfm=this.halo.target.getGlobalTransform().inverse();P=this.halo.target.getGlobalTransform().getRotation();this.offsetRotation=Ua.num.toRadians(P%45);this.halo.toggleDiagonal(wa,this.corner)}},{key:"update",value:function(P,wa,Qa,Nb){wa=void 0===wa?!1:wa;Qa=void 0===Qa?!1:Qa;Nb=void 0===Nb?!1:Nb;var Gc=this.corner,Uc=this.tfm;P=this.startPos.subPt(P);Uc=Uc.transformDirection(Ua.pt(P.x,
P.y));Qa&&(Uc=Uc.griddedBy(Ua.pt(10,10)));this.halo.updateBoundsFor(Gc,wa,Uc,this.startBounds,this.startOrigin);this.halo.toggleDiagonal(wa,Gc);this.updateAlignmentGuide(Qa);wa=[];Gc=Gc.toLowerCase();Gc.includes("left")&&wa.push("left");Gc.includes("top")&&wa.push("top");Gc.includes("bottom")&&wa.push("bottom");Gc.includes("right")&&wa.push("right");Ua.showAndSnapToResizeGuides(this.halo.target,wa,!0,Nb,5,200)}},{key:"stop",value:function(P){P=this.halo;P.layout=this.savedLayout;P.state.activeButton=
null;P.alignWithTarget();P.toggleDiagonal(!1);this.updateAlignmentGuide(!1);Ua.removeSnapToGuidesOf(P.target)}},{key:"updateAlignmentGuide",value:function(P){var wa=this.halo.getSubmorphNamed("mesh");if(P)return P=this.halo.target.extent,P=Ua.pt(P.x%10,P.y%10),wa=this.halo.getMesh(this.globalPosition.addPt(this.extent.scaleBy(.5)),P),this.focus(),wa;wa&&wa.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ResizeHandle"}},{key:"properties",get:function(){return{corner:{},location:{},
draggable:{defaultValue:!0},isResizeHandle:{readOnly:!0,get:function(){return!0}}}}},{key:"getResizeParts",value:function(P){0<P&&(P-=360);P=-8-(P/45).toFixed();0==P&&(P=8);return Ua.arr.zip(Ua.arr.rotate([["topLeft",function(wa){return wa.negated()}],["topCenter",function(wa){return wa.withX(0).negated()}],["topRight",function(wa){return wa.withX(0).negated()}],["rightCenter",function(wa){return Ua.pt(0,0)}],["bottomRight",function(wa){return Ua.pt(0,0)}],["bottomCenter",function(wa){return Ua.pt(0,
0)}],["bottomLeft",function(wa){return wa.withY(0).negated()}],["leftCenter",function(wa){return wa.withY(0).negated()}]],P),[["nwse-resize","topLeft"],["ns-resize","topCenter"],["nesw-resize","topRight"],["ew-resize","rightCenter"],["nwse-resize","bottomRight"],["ns-resize","bottomCenter"],["nesw-resize","bottomLeft"],["ew-resize","leftCenter"]])}},{key:"resizersFor",value:function(P){var wa=this;if(!P.target)return[];var Qa=P.target.getGlobalTransform().getRotation();return Ua.arr.compact(this.getResizeParts(Qa).map(function(Nb){var Gc=
$jscomp.makeIterator(Nb),Uc=$jscomp.makeIterator(Gc.next().value);Nb=Uc.next().value;Uc.next();Uc.next();Uc=$jscomp.makeIterator(Gc.next().value);Gc=Uc.next().value;Uc=Uc.next().value;return wa.for(P,Nb,Uc,Gc)})).map(function(Nb){return Nb.alignInHalo()})}},{key:"for",value:function(P,wa,Qa,Nb){var Gc="Resize "+wa;P=P.getSubmorphNamed(Gc)||new this({name:Gc,halo:P,corner:wa,tooltip:"Resize "+wa,extent:Ua.pt(10,10),borderWidth:1,borderRadius:0,borderColor:P.target.isComponent?Ua.componentAccent:Ua.haloBlue,
fill:Ua.Color.white});return Object.assign(P,{nativeCursor:Nb,location:Qa})}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:43941,end:49204})})(Ua.HaloItem);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("MenuHaloItem")&&"function"===
typeof Aa.MenuHaloItem?Aa.MenuHaloItem:Aa.MenuHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"onMouseDown",value:function(P){var wa=this,Qa,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gc){if(1==Gc.nextAddress)return Qa=wa.halo.target,wa.halo.remove(),Gc.yield(Qa.menuItems(),2);Nb=Gc.yieldResult;Qa.world().openMenu(Nb).hasFixedPosition=wa.halo.hasFixedPosition;Gc.jumpToEnd()})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MenuHaloItem"}},{key:"morphName",get:function(){return"menu"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},tooltip:{defaultValue:"Opens the morph menu"},styleClasses:{defaultValue:["fas","fa-bars"]}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:49207,end:49718})})(Ua.HaloItem);var Md=Da("M",function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Aa.hasOwnProperty("MorphHighlighter")&&"function"===typeof Aa.MorphHighlighter?Aa.MorphHighlighter:Aa.MorphHighlighter=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"alignWithHalo",value:function(){this.target&&(this.position=this.halo.localize(this.target.globalBounds().topLeft()),
this.halo.isWorld&&(this.position=this.position.subPt(this.halo.scroll)),this.extent=this.target.globalBounds().extent(),this.get("name tag").value=this.target.name,this.get("name tag").topCenter=this.innerBounds().insetBy(-10).bottomCenter())}},{key:"show",value:function(){if(this.target&&this.target.layout&&this.showLayout&&(this.layoutHalo=this.layoutHalo||this.world().showLayoutHaloFor(this.target,this.pointerId))&&this.layoutHalo.previewDrop){this.visible=!1;this.alignWithHalo();this.halo.get("grab").hand.grabbedMorphs&&
this.layoutHalo.previewDrop(this.halo.get("grab").hand.grabbedMorphs);return}this.visible=!0;this.alignWithHalo()}},{key:"handleDrop",value:function(P){this.layoutHalo&&this.layoutHalo.handleDrop(P)}},{key:"deactivate",value:function(){this.layoutHalo&&(this.layoutHalo.remove(),this.layoutHalo=null);this.visible=!1;this.alignWithHalo();this.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphHighlighter"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},
name:{defaultValue:"morphHighlighter"},styleClasses:{defaultValue:["inactive"]},reactsToPointer:{defaultValue:!1},hasFixedPosition:{defaultValue:!0},fill:{defaultValue:Ua.Color.orange.withA(.3)},borderWidth:{defaultValue:2},borderColor:{defaultValue:Ua.Color.orange},halo:{},epiMorph:{defaultValue:!0},isHighlighter:{readOnly:!0,defaultValue:!0},highlightedSides:{defaultValue:[],set:function(P){var wa=this;this.setProperty("highlightedSides",P);this.submorphs=P.map(function(Qa){return{type:"ellipse",
isHaloItem:!0,fill:Ua.Color.orange,center:wa.innerBounds()[Qa]()}});this.addMorph({type:"label",name:"name tag",padding:Ua.Rectangle.inset(5,5,5,5),fontColor:Ua.Color.white,fill:Ua.Color.orange,borderRadius:3});this.alignWithHalo()}},showLayout:{defaultValue:!1},targetId:{},target:{readOnly:!0,derived:!0,get:function(){return(this.world()||this.env.world).getMorphWithId(this.targetId)}}}}},{key:"removeHighlighters",value:function(P){P=void 0===P?$world:P;var wa=P._morphHighlighters,Qa;for(Qa in wa)wa[Qa].remove();
delete P._morphHighlighters}},{key:"for",value:function(P,wa,Qa,Nb){Qa=void 0===Qa?!1:Qa;Nb=void 0===Nb?[]:Nb;var Gc=P._morphHighlighters=P._morphHighlighters||{};Ua.properties.forEachOwn(Gc,function(Uc,le){return le.alignWithHalo()});if(!wa||wa.ownerChain().find(function(Uc){return Uc.isHaloItem}))return null;Gc[wa.id]=Gc[wa.id]||new this({targetId:wa.id,halo:P,showLayout:Qa});P.addMorph(Gc[wa.id]);Gc[wa.id].highlightedSides=Nb;return Gc[wa.id]}},{key:"interceptDrop",value:function(P,wa,Qa){(P=P._morphHighlighters=
P._morphHighlighters||{},P[wa.id])&&P[wa.id].handleDrop(Qa)}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:49908,end:53420})}(Ua.Morph));Ua.MorphHighlighter=Md;Ua.MorphHighlighter=Md;Ua.MorphHighlighter=Md;var id=Da("I",function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Mb=Aa.hasOwnProperty("InteractiveMorphSelector")&&"function"===typeof Aa.InteractiveMorphSelector?Aa.InteractiveMorphSelector:Aa.InteractiveMorphSelector=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:Symbol.for("lively-instance-initialize"),value:function(P,wa,Qa){P=void 0===P?$world:P;this.controllingMorph=void 0===wa?null:wa;this.possibleTarget=this.morphHighlighter=this.selectorMorph=null;this.world=
P;this.filterFn=Qa;this.whenDone=null}},{key:"selectNewTarget",value:function(){this.targetObject=null;var P=Ua.promise.deferred();P.promise.resolve=P.resolve;this.whenDone=P.promise;this.selectorMorph=Ua.Icon.makeLabel("crosshairs",{fontSize:20,hasFixedPosition:!0,epiMorph:!0}).openInWorld();Ua.connect(this.world.firstHand,"position",this,"scanForTargetAt");Ua.once(this.selectorMorph,"onMouseDown",this,"selectTarget");Ua.once(this.selectorMorph,"onKeyDown",this,"stopSelect");this.selectorMorph.focus();
this.scanForTargetAt(this.world.firstHand.position)}},{key:"scanForTargetAt",value:function(){var P=this.world.firstHand.globalPosition;this.selectorMorph.center=P;this.selectorMorph.focus();var wa=this.selectorMorph.morphBeneath(P),Qa,Nb=this.possibleTarget,Gc=this.controllingMorph,Uc=this.filterFn,le=this.world,Od=this.morphHighlighter;for(Od==wa?wa=Od.morphBeneath(P):wa&&wa.isEpiMorph&&(wa=wa.morphBeneath(P));wa&&(Qa=[wa].concat($jscomp.arrayFromIterable(wa.ownerChain())).find(function(kf){return!kf.visible}));)wa=
Qa=Qa.morphBeneath(P);if(wa&&Uc&&!Uc(wa))for(;wa&&![wa].concat($jscomp.arrayFromIterable(wa.ownerChain())).find(Uc);)wa=wa.morphBeneath(P);!wa||wa==Nb||Gc&&wa.ownerChain().includes(Gc.getWindow())||(Od&&Od.deactivate(),(this.possibleTarget=Nb=wa)&&!Nb.isWorld&&(P=this.morphHighlighter=Ua.MorphHighlighter.for(le,wa))&&P.show())}},{key:"selectTarget",value:function(){this.targetObject=this.possibleTarget;this.stopSelect()}},{key:"stopSelect",value:function(){Ua.MorphHighlighter.removeHighlighters(this.world);
Ua.disconnect(this.world.firstHand,"position",this,"scanForTargetAt");this.selectorMorph.remove();this.whenDone&&this.whenDone.resolve(this.targetObject)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveMorphSelector"}},{key:"selectMorph",value:function(P,wa,Qa){P=new this(P,wa,Qa);P.selectNewTarget();return P.whenDone}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:53429,end:56174})}(void 0));Ua.InteractiveMorphSelector=id;Ua.InteractiveMorphSelector=id;Ua.InteractiveMorphSelector=id;Ua.default=wc;var Ta=lively.FreezerRuntime.recorderFor("lively.halos/markers.js");Ta.show=Sa;Ta.showRect=function(sa,Aa,Mb){var P=Ta.BoundsMarker.highlightBounds(Aa);return Mb?Ta.showInLoop(sa,P,Aa):Ta.showThenHide(sa,P)};Ta.showInLoop=function(sa,Aa,Mb){var P;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){switch(wa.nextAddress){case 1:return Ta.showThenHide(sa,
Aa,!1),wa.yield(Ta.promise.delay(300),2);case 2:P=!1,Ta.once(sa,"onMouseDown",function(){return P=!0});case 3:if(P){wa.jumpTo(4);break}return wa.yield(Aa.retract(Mb),3);case 4:Aa.fadeOut(2E3),wa.jumpToEnd()}})};Ta.showThenHide=function(sa,Aa,Mb){Mb=void 0===Mb?3:Mb;if(sa){var P=Array.isArray(Aa)?Aa:[Aa];P.forEach(function(wa){return sa.addMorph(wa)});Mb&&setTimeout(function(){return P.forEach(function(wa){return wa.fadeOut(2E3)})},1E3*Mb);return Aa}};Ta.showLine=function(sa,Aa,Mb){Mb=void 0===Mb?
3E3:Mb;var P=Aa.start;Aa=Aa.end.subPt(P);var wa=sa.addMorph({position:P,rotation:Aa.theta(),border:{width:1,color:Ta.Color.red},width:Aa.fastR(),height:0});Mb&&setTimeout(function(){return wa.fadeOut()},Mb);return wa};Ta.showConnector=ec;Ta.obj=ac;Ta.promise=gd;Ta.string=xc;Ta.pt=Rb;Ta.Color=jc;Ta.Rectangle=Za;Ta.rect=md;Ta.morph=cc;Ta.easings=Lc;Ta.Path=Pc;Ta.Icon=ge;Ta.Morph=je;Ta.MorphicEnv=Ga;Ta.connect=Ob;Ta.once=$b;Ta.disconnect=Yc;Ta.show=Sa;Ta.show=Sa;(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),
Mb=Aa.hasOwnProperty("BoundsMarker")&&"function"===typeof Aa.BoundsMarker?Aa.BoundsMarker:Aa.BoundsMarker=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:Symbol.for("lively-instance-initialize"),value:function(){pb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{borderWidth:0,fill:Ta.Color.transparent,reactsToPointer:!1,hasFixedPosition:!0})}},{key:"isEpiMorph",
get:function(){return!0}},{key:"markerLength",value:function(P){P=P.insetBy(-2);P=Math.min(P.width,P.height);return Math.max(4,Math.floor(10>P/10?P/2-5:P/10))}},{key:"createMarkerEdge",value:function(){return Ta.morph({fill:Ta.Color.red,reactsToPointer:!1,borderRadius:10})}},{key:"ensureMarkerCorners",value:function(){var P=this.topLeftH||(this.topLeftH=this.addMorph(this.createMarkerEdge())),wa=this.topLeftV||(this.topLeftV=this.addMorph(this.createMarkerEdge())),Qa=this.topRightH||(this.topRightH=
this.addMorph(this.createMarkerEdge())),Nb=this.topRightV||(this.topRightV=this.addMorph(this.createMarkerEdge())),Gc=this.bottomRightH||(this.bottomRightH=this.addMorph(this.createMarkerEdge())),Uc=this.bottomRightV||(this.bottomRightV=this.addMorph(this.createMarkerEdge())),le=this.bottomLeftH||(this.bottomLeftH=this.addMorph(this.createMarkerEdge())),Od=this.bottomLeftV||(this.bottomLeftV=this.addMorph(this.createMarkerEdge()));return[P,wa,Qa,Nb,Gc,Uc,le,Od]}},{key:"alignWithMorph",value:function(P){return this.alignWithBounds(P.globalBounds().translatedBy($world.scroll.negated()))}},
{key:"alignWithBounds",value:function(P){this.alignWithRect(P.insetBy(-20));return this.alignWithRect(P,!0)}},{key:"alignWithRect",value:function(P,wa){var Qa=this.ensureMarkerCorners(),Nb=this.markerLength(P),Gc=[P.topLeft().addXY(0,0).extent(Ta.pt(Nb,5)),P.topLeft().addXY(0,0).extent(Ta.pt(5,Nb)),P.topRight().addXY(-Nb,0).extent(Ta.pt(Nb,5)),P.topRight().addXY(-5,0).extent(Ta.pt(5,Nb)),P.bottomRight().addXY(-5,-Nb).extent(Ta.pt(5,Nb)),P.bottomRight().addXY(-Nb,-5).extent(Ta.pt(Nb,5)),P.bottomLeft().addXY(0,
-5).extent(Ta.pt(Nb,5)),P.bottomLeft().addXY(0,-Nb).extent(Ta.pt(5,Nb))];Qa.forEach(function(Uc,le){return Uc.setBounds(Gc[le])});wa&&(this.adjustOrigin(P.center()),this.opacity=0,this.scale=1.5,this.animate({opacity:1,scale:1,duration:300}));return this}},{key:"retract",value:function(P){var wa=this,Qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress)return Nb.yield(wa.animate({scale:Math.max(30/P.width,1.05)}),2);Qa=wa.center;return Nb.yield(wa.animate({center:Qa,
scale:1,duration:300,easing:Ta.easings.inOutExpo}),0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BoundsMarker"}},{key:"highlightMorph",value:function(P){return(new this).alignWithMorph(P)}},{key:"highlightBounds",value:function(P){return(new this).alignWithBounds(P)}}],Aa,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:2261,end:5920})})(Ta.Morph);wc=Da("S",function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Mb=Aa.hasOwnProperty("StatusMessage")&&"function"===typeof Aa.StatusMessage?Aa.StatusMessage:Aa.StatusMessage=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"relayout",value:function(){this.title=Ta.string.truncate(this.message,(this.width/15).toFixed(),
"...")}},{key:"isEpiMorph",value:function(){return!0}},{key:"isStatusMessage",value:function(){return!0}},{key:"setMessage",value:function(P,wa){this.message=P;this.color=wa}},{key:"slideTo",value:function(P){var wa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==Qa.nextAddress)return wa.sliding=wa.animate({position:P,duration:500}),Qa.yield(wa.sliding,2);wa.sliding=!1;Qa.jumpToEnd()})}},{key:"expand",value:function(){var P=this,wa,Qa,Nb,Gc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==
Uc.nextAddress)return P.expandable?P.sliding?Uc.yield(P.sliding,2):Uc.jumpTo(2):Uc.return();wa=P.world();if(!wa||P.isMaximized)return Uc.return();P.isMaximized=!0;P.stayOpen=!0;Qa=P.getSubmorphNamed("message text");Qa.lineWrapping=!1;Object.assign(Qa,{clipMode:"auto",fixedWidth:!0,selectable:!0});P.expandedContent&&(Qa.value=P.expandedContent);Qa.fit();Nb=Qa.textBounds().extent();Gc=wa.visibleBounds();Nb.y>Gc.extent().y&&(Nb.y=Gc.extent().y-20);Nb.x>Gc.extent().x&&(Nb.x=Gc.extent().x-20);Nb=P.extent.maxPt(Nb);
P.animate({extent:Nb,center:Gc.center(),duration:200});P.relayout();P.focus();Uc.jumpToEnd()})}},{key:"fit",value:function(){var P=this.getSubmorphNamed("message text");P&&(this.extent=Ta.pt(100,35).maxPt(P.textBounds().extent()),this.relayout())}},{key:"focus",value:function(){var P=this.getSubmorphNamed("message text");P&&P.focus()}},{key:"onMouseUp",value:function(P){this.expand()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessage"}},{key:"properties",get:function(){return{extent:{defaultValue:Ta.pt(200,
100)},stayOpen:{defaultValue:!1},slidable:{defaultValue:!0},isMaximized:{defaultValue:!1},expandable:{initialize:function(){this.expandable=!0}},maxLines:{defaultValue:Infinity},name:{defaultValue:"messageMorph"},master:{initialize:function(){this.master={auto:"styleguide://System/message"}}},message:{after:["submorphs","extent"],set:function(P){this.setProperty("message",P);var wa=this.getSubmorphNamed("message text");if(wa){wa.value=P;var Qa=wa.documentEndPosition;Qa.row>this.maxLines&&(wa.replace({start:{row:this.maxLines,
column:0},end:Qa},"...\n"),this.expandedContent||(this.expandedContent=P));Qa=wa.documentEndPosition;0!==Qa.column&&wa.insertText("\n",Qa)}}},title:{isStyleProp:!0,derived:!0,set:function(P){this.getSubmorphNamed("message title").value=P},get:function(){return this.getSubmorphNamed("message title").value}},color:{after:["submorphs"],derived:!0,get:function(){return this.get("message icon").fontColor},set:function(P){this.get("message icon").fontColor=P;this.get("message icon")._parametrizedProps&&
(this.get("message icon")._parametrizedProps.fontColor=P)}},submorphs:{after:["extent"],initialize:function(){this.submorphs=[{name:"message icon",type:"label",value:Ta.Icon.textAttribute("check-circle")},{name:"message text",type:"text"},{name:"message title",type:"label"},{name:"close button",type:"button"}];Ta.connect(this.getSubmorphNamed("close button"),"fire",this,"remove");Ta.connect(this,"extent",this,"relayout")}}}}}],Aa,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:5964,end:10242})}(Ta.Morph));Ta.StatusMessage=wc;Ta.StatusMessage=wc;Ta.StatusMessage=wc;var rd=Da("b",function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Mb=Aa.hasOwnProperty("StatusMessageForMorph")&&"function"===typeof Aa.StatusMessageForMorph?Aa.StatusMessageForMorph:Aa.StatusMessageForMorph=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"alignAtBottomOf",value:function(P){var wa=this.world();wa&&(this.bringToFront(),this.fit(),this.width=P.bounds().width,this.relayout(),P.world()&&(this.position=P.owner.worldPoint(P.bounds().bottomLeft())),P=wa.visibleBounds(),P=this.bounds().top()+this.height-P.bottom(),0<P&&this.moveBy(Ta.pt(0,-P)))}},{key:"onMouseUp",value:function(P){}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessageForMorph"}},
{key:"properties",get:function(){return{slidable:{defaultValue:!1},renderOnGPU:{defaultValue:!0},removeOnTargetMorphChange:{defaultValue:!0},targetMorph:{defaultValue:null,get:function(){var P=this.getProperty("targetMorph");return P&&$world.getMorphWithId(P)},set:function(P){this.setProperty("targetMorph",P?P.id:null);this.alignAtBottomOf(P)}},expandable:{after:["submorphs"],set:function(P){this.setProperty("expandable",P);if(P){var wa=this.getSubmorphNamed("expand button")||this.addMorph({name:"expand button",
type:"button"});Ta.connect(wa,"fire",this,"expand")}else this.getSubmorphNamed("expand button")&&(this.getSubmorphNamed("expand button").remove(),Ta.disconnect(wa,"fire",this,"expand"))}}}}}],Aa,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10467,end:12318})}(Ta.StatusMessage));Ta.StatusMessageForMorph=
rd;Ta.StatusMessageForMorph=rd;Ta.StatusMessageForMorph=rd;Ta.showConnector=ec;Ta.showConnector=ec;var jb=lively.FreezerRuntime.recorderFor("lively.ide/index.js");jb.info="import via sub modules";jb.info="import via sub modules";jb.info="import via sub modules";var Qd=Da("v",{});jb.valueWidgets=Qd;jb.valueWidgets=Qd;jb.valueWidgets=Qd;var ab=Da("p",{});jb.popovers=ab;jb.popovers=ab;jb.popovers=ab;var lb=lively.FreezerRuntime.recorderFor("lively.components/popup.js");lb.Morph=je;lb.VerticalLayout=
Ra;lb.StyleSheet=Yd;lb.Icon=ge;lb.CustomLayout=rb;lb.Color=jc;lb.rect=md;lb.pt=Rb;lb.connect=Ob;lb.Path=ic;lb.duration=300;jb=Da("P",function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.components/popup.js"),Mb=Aa.hasOwnProperty("Popover")&&"function"===typeof Aa.Popover?Aa.Popover:Aa.Popover=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"relayout",value:function(P){var wa=this.get("body"),
Qa=this.get("arrow"),Nb=this.get("close button");Qa=Qa.height;P?(wa.animate({topCenter:lb.pt(0,Qa),duration:200}),Nb.animate({topRight:wa.topRight.addXY(8,-8),duration:200})):(wa.topCenter=lb.pt(0,Qa),Nb.topRight=wa.topRight.addXY(8,-8))}},{key:"close",value:function(){this.fadeOut(300)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Popover"}},{key:"properties",get:function(){return{epiMorph:{defaultValue:!0},hasFixedPosition:{defaultValue:!0},master:{initialize:function(){this.master=
{auto:"styleguide://SystemWidgets/popover/light"}}},targetMorph:{derived:!0,after:["submorphs"],defaultValue:{extent:lb.pt(200,200),fill:lb.Color.transparent,submorphs:[{name:"placeholder",type:"label",value:"No Target Specified"}]},get:function(){return this.get("body").submorphs[0]},set:function(P){var wa=this;this.get("body").addMorph(P);this.whenRendered().then(function(){return wa.relayout()})}},submorphs:{initialize:function(){var P=this;this.submorphs=[{type:"polygon",name:"arrow",topCenter:lb.pt(0,
0),borderColor:lb.Color.transparent,vertices:[lb.pt(-10,0),lb.pt(0,-15),lb.pt(10,0)]},{name:"body"},{name:"close button",type:"button",label:Object.assign(lb.Icon.makeLabel("times-circle"),{fontSize:18}),tooltip:"close",fill:null,extent:lb.pt(16,16),borderColor:lb.Color.transparent}];var wa=$jscomp.makeIterator(this.submorphs);wa.next();var Qa=wa.next().value;wa=wa.next().value;lb.connect(wa,"fire",this,"close");lb.connect(Qa,"extent",this,"relayout",{converter:"() => target.animated"});setTimeout(function(){return P.animated=
!0},1E3)}}}}}],Aa,{pathInPackage:function(){return"popup.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.components",version:"0.1.0"}}},{start:247,end:2617})}(lb.Morph));lb.Popover=jb;lb.Popover=jb;lb.Popover=jb;var vb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js");vb.Morph=je;vb.TilingLayout=Kb;vb.morph=cc;vb.Label=fd;vb.HorizontalLayout=jd;vb.Icon=
ge;vb.InputLine=Ib;vb.config=gb;vb.connect=Ob;vb.signal=Hc;vb.Color=jc;vb.LinearGradient=Db;vb.pt=Rb;vb.rect=md;vb.num=Yb;vb.obj=ac;vb.popovers=ab;vb.ValueScrubber=ib;vb.Popover=jb;(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("ContextSensitiveWidget")&&"function"===typeof Aa.ContextSensitiveWidget?Aa.ContextSensitiveWidget:Aa.ContextSensitiveWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return pb(Mb,sa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ContextSensitiveWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:vb.Color.transparent},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?vb.Color.white:vb.Color.black}},layout:{initialize:function(){this.layout=new vb.HorizontalLayout}},context:{serialize:!1}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1872,end:2439})})(vb.Morph);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("ShortcutWidget")&&"function"===typeof Aa.ShortcutWidget?Aa.ShortcutWidget:Aa.ShortcutWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,
sa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(P){P.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShortcutWidget"}},{key:"properties",get:function(){return{title:{defaultValue:"No Title",after:["submorphs"],set:function(P){this.setProperty("title",P);this.getSubmorphNamed("valueString").value=P}},nativeCursor:{defaultValue:"pointer"},fontColor:{derived:!0,
set:function(P){this.submorphs.forEach(function(wa){return wa.fontColor=P})}},submorphs:{initialize:function(){this.submorphs=[vb.Icon.makeLabel("arrow-right",{styleClasses:["TreeLabel"],fontSize:15,padding:vb.rect(1,1,4,1)}),{type:"label",value:this.title,styleClasses:["TreeLabel"],fontWeight:"bold",name:"valueString",opacity:.8,borderRadius:5,padding:vb.rect(0,0,0,2),nativeCursor:"pointer",fontSize:12,borderWidth:0}]}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:2441,end:3667})})(vb.ContextSensitiveWidget);ab=function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("LayoutWidget")&&"function"===typeof Aa.LayoutWidget?Aa.LayoutWidget:Aa.LayoutWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return pb(Mb,sa,[{key:"layoutChanged",value:function(){this.title=this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}},{key:"openPopover",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==Qa.nextAddress)return wa=new vb.popovers.LayoutPopover({hasFixedPosition:!!P.ownerChain().find(function(Nb){return Nb.hasFixedPosition}),container:P.context}),Qa.yield(wa.fadeIntoWorld(P.globalBounds().center()),2);vb.connect(wa,"layoutChanged",
P,"layoutChanged");vb.signal(P,"openWidget",wa);Qa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutWidget"}},{key:"properties",get:function(){return{title:{after:["submorphs"],initialize:function(){this.title=this.context&&this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3676,end:4493})}(vb.ShortcutWidget);vb.LayoutWidget=ab;vb.LayoutWidget=ab;vb.LayoutWidget=ab;jb=function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("ColorWidget")&&"function"===typeof Aa.ColorWidget?Aa.ColorWidget:Aa.ColorWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"relayout",
value:function(P){P?this.submorphs=this.color?this.color.isGradient?this.renderGradientValue():this.renderColorValue():this.renderNoColor():this.color&&(this.color.isGradient?this.updateGradientValue():this.updateColorValue())}},{key:"updateGradientValue",value:function(){var P=this.color;if(2*P.stops.length==this.submorphs.length-3){var wa;for(wa in this.color.stops){var Qa=P.stops[wa];var Nb=Qa.color,Gc=Qa.offset,Uc=$jscomp.makeIterator(this.submorphs[2+2*wa].submorphs).next().value;Qa=this.submorphs[3+
2*wa];Uc.fill=Nb;Qa.value=(100*Gc).toFixed()+"%"+(wa<P.stops.length-1?",":"")}}else this.submorphs=this.renderGradientValue()}},{key:"renderGradientValue",value:function(){return[{type:"label",styleClasses:["TreeLabel"],value:this.color.type+"(",name:"valueString"}].concat($jscomp.arrayFromIterable(this.renderStops()),[{type:"label",styleClasses:["TreeLabel"],value:")"}])}},{key:"updateColorValue",value:function(){this.getSubmorphNamed("color box").fill=this.color;this.getSubmorphNamed("valueString").value=
vb.obj.safeToString(this.color)}},{key:"renderNoColor",value:function(){return[{extent:vb.pt(15,15),fill:vb.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:vb.pt(5,7.5),fill:vb.Color.white,borderColor:vb.Color.gray.darker(),borderWidth:1,submorphs:[{type:"path",name:"no fill",vertices:[vb.pt(0,0),vb.pt(10,10)],borderColor:vb.Color.red}]}]},{type:"label",value:"No Color",fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderColorValue",value:function(){return[{extent:vb.pt(15,
15),fill:vb.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:vb.pt(5,7.5),fill:this.color,borderColor:vb.Color.gray.darker(),nativeCursor:"pointer",borderWidth:1}]},{type:"label",value:vb.obj.safeToString(this.color),fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderStops",value:function(){var P=this.color,wa=[{type:"label",padding:vb.rect(0,0,5,0),value:"linearGradient"==P.type?vb.num.toDegrees(P.vectorAsAngle()).toFixed()+"\u00b0,":""}],Qa;
for(Qa in P.stops){var Nb=P.stops[Qa],Gc=Nb.color;Nb=Nb.offset;wa.push({extent:vb.pt(this.fontSize,this.fontSize),fill:vb.Color.transparent,layout:new vb.HorizontalLayout({spacing:3}),submorphs:[{styleClasses:["colorValue"],fill:Gc}]});wa.push({type:"label",padding:vb.rect(0,0,5,0),value:(100*Nb).toFixed()+"%"+(Qa<P.stops.length-1?",":"")})}return wa}},{key:"onMouseDown",value:function(P){this.openFillEditor()}},{key:"update",value:function(P){this.color=P}},{key:"openFillEditor",value:function(){var P=
this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==Qa.nextAddress)return wa=new vb.popovers.FillPopover({hasFixedPosition:!!P.ownerChain().find(function(Nb){return Nb.hasFixedPosition}),handleMorph:P.context,fillValue:P.color,title:"Fill Control",gradientEnabled:P.gradientEnabled}),Qa.yield(wa.fadeIntoWorld(P.globalBounds().center()),2);vb.connect(wa,"fillValue",P,"update");vb.signal(P,"openWidget",wa);Qa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColorWidget"}},
{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new vb.HorizontalLayout({direction:"centered"})}},selectionFontColor:{defaultValue:vb.Color.white},nonSelectionFontColor:{defaultValue:vb.Color.black},color:{defaultValue:vb.Color.blue},gradientEnabled:{defaultValue:!1},fontSize:{defaultValue:14},isSelected:{after:["submorphs"],set:function(P){this.getProperty("isSelected")!=P&&(this.getSubmorphNamed("valueString").fontColor=P?this.selectionFontColor:this.nonSelectionFontColor,
this.setProperty("isSelected",P))}},submorphs:{after:["nonSelectionFontColor","selectionFontColor"],initialize:function(){vb.connect(this,"color",this,"relayout",{converter:function(P,wa){return(wa&&wa.isColor)!=(P&&P.isColor)}});this.relayout(!0)}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:4557,end:9992})}(vb.ContextSensitiveWidget);vb.ColorWidget=jb;vb.ColorWidget=jb;vb.ColorWidget=jb;var Bd=function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("BooleanWidget")&&"function"===typeof Aa.BooleanWidget?Aa.BooleanWidget:Aa.BooleanWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"onMouseDown",value:function(P){this.boolean=
!this.boolean}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BooleanWidget"}},{key:"properties",get:function(){return{fontFamily:{defaultValue:vb.config.codeEditor.defaultStyle.fontFamily},nativeCursor:{defaultValue:"pointer"},boolean:{set:function(P){this.setProperty("boolean",P);this.value=vb.obj.safeToString(P);this.fontColor=this.boolean?vb.Color.green:vb.Color.red}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10001,end:10481})}(vb.Label);vb.BooleanWidget=Bd;vb.BooleanWidget=Bd;vb.BooleanWidget=Bd;var de=Da("N",function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("NumberWidget")&&"function"===typeof Aa.NumberWidget?Aa.NumberWidget:Aa.NumberWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return pb(Mb,sa,[{key:"onMouseDown",value:function(P){pb._get(Object.getPrototypeOf(Mb.prototype),"onMouseDown",this).call(this,P);"up"==P.targetMorph.name&&this.increment();"down"==P.targetMorph.name&&this.decrement()}},{key:"spec",value:function(){return vb.obj.dissoc(pb._get(Object.getPrototypeOf(Mb.prototype),"spec",this).call(this),["submorphs"])}},{key:"update",value:function(P,wa){wa=void 0===wa?!0:wa;this.setProperty("number",wa?P/this.scaleFactor:P);vb.signal(this,"number",this.number);
this.relayout(wa)}},{key:"relayoutButtons",value:function(){var P=this.getSubmorphNamed("up"),wa=this.getSubmorphNamed("down");this.getSubmorphNamed("value");P.height=wa.height=(this.height-2)/2;P.width=wa.width=20}},{key:"onChange",value:function(P){pb._get(Object.getPrototypeOf(Mb.prototype),"onChange",this).call(this,P);"extent"!=P.prop||this.autofit||this.relayout()}},{key:"relayout",value:function(P){var wa=this.getSubmorphNamed("value");wa&&(this.autofit?(P||(wa.value=this.number*this.scaleFactor),
wa.fit(),this.height=wa.height,this.width=wa.width+20):P||(wa.width=this.width-20),this.relayoutButtons(),P||(wa.value=vb.num.roundTo(this.number*this.scaleFactor,1),wa.min=-Infinity!=this.min?this.min*this.scaleFactor:this.min,wa.max=Infinity!=this.max?this.max*this.scaleFactor:this.max,wa.unit=this.unit))}},{key:"increment",value:function(){void 0!=this.max&&this.number>=this.max||this.update(this.number+1/this.scaleFactor,!1)}},{key:"decrement",value:function(){void 0!=this.min&&this.number<=this.min||
this.update(this.number-1/this.scaleFactor,!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberWidget"}},{key:"properties",get:function(){return{unit:{type:"Enum",isStyleProp:!0,values:["px","%","pt",""]},autofit:{defaultValue:!0,after:["submorphs","extent"],set:function(P){this.setProperty("autofit",P);this.getSubmorphNamed("value").scaleToBounds=!P}},number:{defaultValue:0,after:["unit","autofit"],set:function(P){this.setProperty("number",P);this.relayout(!1)}},min:{defaultValue:-Infinity},
max:{defaultValue:Infinity},floatingPoint:{after:["number","submorphs"],set:function(P){this.setProperty("floatingPoint",P);this.get("value").floatingPoint=P},get:function(){var P=/[+-]?([0-9]*[.])?[0-9]+/.exec(this.number);return this.getProperty("floatingPoint")||1==this.scaleFactor&&P&&!!P[1]}},padding:{isStyleProp:!0,defaultValue:vb.rect(5,3,0,0),after:["submorphs"],set:function(P){this.setProperty("padding",P);this.getSubmorphNamed("value").padding=P}},extent:{defaultValue:vb.pt(70,25)},scaleFactor:{defaultValue:1,
get:function(){return this.getProperty("scaleFactor")||1}},baseFactor:{after:["submorphs"],derived:!0,get:function(){return this.get("value").baseFactor},set:function(P){this.get("value").baseFactor=P}},styleClasses:{defaultValue:["unfocused"]},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/number field/light"}}},fontColor:{isStyleProp:!0,defaultValue:vb.Color.rgbHex("#0086b3"),set:function(P){this.setProperty("fontColor",P)}},isSelected:{set:function(P){this.getProperty("isSelected")!=
P&&(P?(this.addStyleClass("selected"),this.removeStyleClass("unselected")):(this.removeStyleClass("selected"),this.addStyleClass("unselected")),this.setProperty("isSelected",P))}},fontFamily:{defaultValue:"Sans-Serif",isStyleProp:!0,set:function(P){this.setProperty("fontFamily",P)}},fontSize:{defaultValue:15,isStyleProp:!0,set:function(P){this.setProperty("fontSize",P)}},layout:{initialize:function(){this.layout=new vb.TilingLayout({axis:"column",orderByIndex:!0,align:"center"})}},submorphs:{after:["min",
"max"],initialize:function(){var P=this;this.submorphs=[new vb.ValueScrubber({name:"value",unit:this.unit,floatingPoint:this.floatingPoint,scaleToBounds:!1,min:this.min,max:this.max}),vb.Icon.makeLabel("sort-up",{name:"up"}),vb.Icon.makeLabel("sort-up",{name:"down",rotation:Math.PI})];vb.connect(this.get("value"),"scrub",this,"update");this.whenRendered().then(function(){return P.relayout()})}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10490,end:16426})}(vb.Morph));vb.NumberWidget=de;vb.NumberWidget=de;vb.NumberWidget=de;var Ee=function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("ShadowWidget")&&"function"===typeof Aa.ShadowWidget?Aa.ShadowWidget:Aa.ShadowWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return pb(Mb,sa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==Qa.nextAddress)return wa=new vb.popovers.ShadowPopover({hasFixedPosition:!!P.ownerChain().find(function(Nb){return Nb.hasFixedPosition}),shadowValue:P.shadowValue}),Qa.yield(wa.fadeIntoWorld(P.globalBounds().center()),2);vb.connect(wa,"shadowValue",P,"shadowValue");vb.connect(P,"shadowValue",P,
"update");vb.signal(P,"openWidget",wa);Qa.jumpToEnd()})}},{key:"update",value:function(){this.renderShadowDisplay()}},{key:"renderShadowDisplay",value:function(){this.shadowValue?1<this.submorphs.length?this.updateShadowDisplay():this.initShadowDisplay():this.submorphs=[{opacity:.8,reactsToPointer:!1,styleClasses:["TreeLabel"],name:"valueString",type:"label",value:"No Shadow"}]}},{key:"updateShadowDisplay",value:function(){var P=this.shadowValue,wa=P.blur,Qa=P.spread,Nb=P.distance;P=P.color;var Gc=
$jscomp.makeIterator(this.submorphs),Uc=Gc.next().value,le=Gc.next().value;le=$jscomp.makeIterator(le.submorphs).next().value;Gc=Gc.next().value;Uc.value=(this.shadowValue.inset?"inset":"drop")+"-shadow(";le.fill=P;Gc.value=", "+wa+"px, "+Nb+"px, "+Qa+"px)"}},{key:"initShadowDisplay",value:function(){var P=this.shadowValue,wa=P.blur,Qa=P.spread,Nb=P.distance;P=P.color;this.submorphs=[{name:"valueString",opacity:.7,reactsToPointer:!1,type:"label",value:(this.shadowValue.inset?"inset":"drop")+"-shadow("},
vb.morph({fill:vb.Color.transparent,extent:vb.pt(this.fontSize+6,this.fontSize+4),submorphs:[{extent:vb.pt(this.fontSize,this.fontSize),position:vb.pt(2,2),fill:P,borderColor:vb.Color.black,borderWidth:1}]}),{name:"valueString",type:"label",opacity:.7,reactsToPointer:!1,value:", "+wa+"px, "+Nb+"px, "+Qa+"px)"}]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShadowWidget"}},{key:"properties",get:function(){return{shadowValue:{after:["submorphs"],defaultValue:null,set:function(P){this.setProperty("shadowValue",
P);this.renderShadowDisplay()}},fill:{defaultValue:vb.Color.transparent},nativeCursor:{defaultValue:"pointer"},fontSize:{defaultValue:12},fontColor:{derived:!0,set:function(P){this.submorphs.forEach(function(wa){return wa.fontColor=P})}},isSelected:{defaultValue:!1,set:function(P){this.setProperty("isSelected",P);this.fontColor=P?vb.Color.white:vb.Color.black}},layout:{initialize:function(){this.layout=new vb.HorizontalLayout}},submorphs:{initialize:function(){this.update()}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:16435,end:19445})}(vb.Morph);vb.ShadowWidget=Ee;vb.ShadowWidget=Ee;vb.ShadowWidget=Ee;var Ze=function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("PointWidget")&&"function"===typeof Aa.PointWidget?Aa.PointWidget:Aa.PointWidget=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==Qa.nextAddress)return wa=new vb.popovers.PointPopover({pointValue:P.pointValue,hasFixedPosition:!!P.ownerChain().find(function(Nb){return Nb.hasFixedPosition})}),Qa.yield(wa.fadeIntoWorld(P.globalBounds().center()),
2);vb.connect(wa,"pointValue",P,"pointValue");vb.signal(P,"openWidget",wa);Qa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PointWidget"}},{key:"properties",get:function(){return{isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?this.selectionFontColor:this.nonSelectionFontColor}},selectionFontColor:{isStyleProp:!0,defaultValue:vb.Color.white},nonSelectionFontColor:{isStyleProp:!0,defaultValue:vb.Color.black},fontFamily:{defaultValue:vb.config.codeEditor.defaultStyle.fontFamily},
nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},pointValue:{after:["textAndAttributes"],set:function(P){var wa=vb.Color.rgbHex("#0086b3");this.setProperty("pointValue",P);this.textAndAttributes=["pt(",null,P.x.toFixed(),{fontColor:wa},",",{},P.y.toFixed(),{fontColor:wa},")",null];this.fixedHeight=this.fixedWidth=!0;this.height=20;this.width=this.textString.length*this.fontSize}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:19454,end:21082})}(vb.Label);vb.PointWidget=Ze;vb.PointWidget=Ze;vb.PointWidget=Ze;var Zc=function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("PaddingWidget")&&"function"===typeof Aa.PaddingWidget?Aa.PaddingWidget:Aa.PaddingWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return pb(Mb,sa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==Qa.nextAddress)return wa=new vb.popovers.RectanglePopover({hasFixedPosition:!!P.ownerChain().find(function(Nb){return Nb.hasFixedPosition}),rectangle:P.rectangle}),wa.relayout(),Qa.yield(wa.fadeIntoWorld(P.globalBounds().center()),2);vb.connect(wa,"rectangle",P,"rectangle");vb.signal(P,"openWidget",
wa);Qa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PaddingWidget"}},{key:"properties",get:function(){return{nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},fontFamily:{defaultValue:vb.config.codeEditor.defaultStyle.fontFamily},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?vb.Color.white:vb.Color.black}},rectangle:{defaultValue:vb.rect(0),set:function(P){this.setProperty("rectangle",
P);this.value=vb.obj.safeToString(P)}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:21091,end:22140})}(vb.Label);vb.PaddingWidget=Zc;vb.PaddingWidget=Zc;vb.PaddingWidget=Zc;var ye=function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("IconWidget")&&
"function"===typeof Aa.IconWidget?Aa.IconWidget:Aa.IconWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==Qa.nextAddress)return wa=new vb.popovers.IconPopover({hasFixedPosition:!!P.ownerChain().find(function(Nb){return Nb.hasFixedPosition})}),
Qa.yield(wa.fadeIntoWorld(P.globalBounds().center()),2);vb.connect(wa,"select",P,"iconValue",{converter:function(Nb){return Nb&&vb.Icon.makeLabel(Nb).value},varMapping:{Icon:ge}});vb.signal(P,"openWidget",wa);Qa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"IconWidget"}},{key:"properties",get:function(){return{fontColor:{defaultValue:vb.Color.gray.darker()},fontFamily:{defaultValue:"FontAwesome"},nativeCursor:{defaultValue:"pointer"},iconValue:{derived:!0,get:function(){return this.value},
set:function(P){this.value=P||"No Icon"}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22149,end:23045})}(vb.Label);vb.IconWidget=ye;vb.IconWidget=ye;vb.IconWidget=ye;var Hd=function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Aa.hasOwnProperty("StringWidget")&&
"function"===typeof Aa.StringWidget?Aa.StringWidget:Aa.StringWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"truncate",value:function(P){return 200<P.length?P.slice(0,20)+"...":P}},{key:"onFocus",value:function(P){var wa=this,Qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress)return pb._get(Object.getPrototypeOf(Mb.prototype),"onFocus",wa).call(wa,P),wa.readOnly?
Nb.return():wa.stringTooLong?Nb.yield(wa.world().editPrompt("edit string",{requester:wa,input:wa.stringValue}),2):(wa.borderColor=vb.Color.white.withA(.9),wa.textString=wa.stringValue,Nb.return());Qa=Nb.yieldResult;if("string"===typeof Qa)wa.onInput(Qa);Nb.jumpToEnd()})}},{key:"onBlur",value:function(P){pb._get(Object.getPrototypeOf(Mb.prototype),"onBlur",this).call(this,P);this.readOnly||(this.borderColor=vb.Color.transparent,this.onInput(this.textString))}},{key:"onInput",value:function(P){this.owner.focus();
vb.signal(this,"inputAccepted",P);this.stringValue=P}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:vb.Color.transparent},fontColor:{defaultValue:vb.Color.blue},nativeCursor:{defaultValue:"auto"},borderColor:{defaultValue:vb.Color.transparent},borderStyle:{defaultValue:"dashed"},borderRadius:{defaultValue:4},borderWidth:{defaultValue:1},padding:{defaultValue:vb.rect(0,0,0,0)},fixedWidth:{defaultValue:!1},
fixedHeight:{defaultValue:!1},stringValue:{after:["textString"],set:function(P){this.setProperty("stringValue",P);this.textString=this.truncate(P);this.nativeCursor=this.stringTooLong?"pointer":"auto"}},stringTooLong:{readOnly:!0,get:function(){return this.stringValue.includes("\n")}},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?vb.Color.white:vb.Color.blue}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23054,end:24974})}(vb.InputLine);vb.StringWidget=Hd;vb.StringWidget=Hd;vb.StringWidget=Hd;vb.valueWidgets=Qd;Object.assign(vb.valueWidgets,{NumberWidget:de,StringWidget:Hd,IconWidget:ye,PaddingWidget:Zc,ShadowWidget:Ee,PointWidget:Ze,BooleanWidget:Bd,LayoutWidget:ab,ColorWidget:jb});var Zb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js");Zb.Ellipse=
Lb;Zb.Icon=ge;Zb.Morph=je;Zb.Path=Pc;Zb.Text=vd;Zb.HorizontalLayout=jd;Zb.VerticalLayout=Ra;Zb.morph=cc;Zb.Color=jc;Zb.pt=Rb;Zb.rect=md;Zb.Rectangle=Za;Zb.arr=qc;Zb.connect=Ob;Zb.disconnect=Yc;Zb.LabeledCheckBox=tc;Zb.DropDownSelector=Qc;Zb.Button=sc;Zb.Menu=Vc;Zb.NumberWidget=de;Zb.InteractiveMorphSelector=id;Zb.easings=Lc;(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Aa.hasOwnProperty("AxisHalo")&&"function"===typeof Aa.AxisHalo?Aa.AxisHalo:Aa.AxisHalo=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var wa=P.halo;P=P.targetAxis;pb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{fill:Zb.Color.transparent,halo:wa,targetAxis:P,container:wa.container});this.initialize()}},{key:"initialize",value:function(){this.setBounds(this.fetchBounds());this.minSlider=
this.minSlider();this.axisMenu=this.axisMenu();this.proportionSlider=this.proportionSlider();this.proportionSlider.addMorph(this.minSlider);this.submorphs=[this.proportionSlider,this.axisMenu];this.halo.addGuide(this)}},{key:"forceMenuHidden",set:function(P){this._forceMenuHidden=P;this.axisMenu.visible=!P}},{key:"forceMenuHidden",get:function(){return this._forceMenuHidden}},{key:"lastAxis",get:function(){return!this.targetAxis.after}},{key:"fetchBounds",value:function(){return this.fetchPosition().extent(this.fetchExtent())}},
{key:"alignWithTarget",value:function(){this.extent=this.fetchExtent();this.position=this.fetchPosition();this.proportionSlider.alignWithTarget();this.axisMenu.alignWithTarget()}},{key:"onHoverIn",value:function(){this.minSlider.requestToShow();this.axisMenu.visible=!this.forceMenuHidden&&!0}},{key:"onHoverOut",value:function(P){this.minSlider.requestToHide();this.axisMenu.visible=this.forceMenuVisible||!1}},{key:"proportionSlider",value:function(){var P=this,wa=this,Qa=this.proportionViewer();return this.halo.addGuide(new Zb.Morph({nativeCursor:this.getResizeCursor(),
fill:Zb.Color.transparent,submorphs:[this.devider(),Qa],alignWithTarget:function(){this.setBounds(wa.getProportionSliderBounds(this))},onDragStart:function(){Qa.visible=!0},onDrag:function(Nb){P.adjustStretch(P.getDelta(Nb));P.halo.alignWithTarget()},onDragEnd:function(){Qa.visible=!1}}))}},{key:"devider",value:function(){return new Zb.Morph({visible:!this.lastAxis,fill:Zb.Color.black.withA(.5),bounds:this.getDeviderBounds(),draggable:!1,reactsToPointer:!1})}},{key:"minSlider",value:function(){var P=
this,wa=this,Qa=this.minSpaceVisualizer(),Nb=this.minViewer();return this.halo.addGuide(new Zb.Ellipse({nativeCursor:this.getResizeCursor(),fill:Zb.Color.green,extent:Zb.pt(10,10),visible:!1,submorphs:[Qa,Nb],becomesActiveOnHover:!0,alignWithTarget:function(){this.position=wa.getMinSliderPosition()},requestToShow:function(){this.visible=!wa.targetAxis.fixed},requestToHide:function(){this.active?this.shouldHide=!0:this.visible=!1},onDragStart:function(){wa.forceMenuHidden=!0;Nb.visible=!0;this.active=
Qa.visible=!0},onDrag:function(Gc){P.targetAxis.min+=-P.getDelta(Gc);P.halo.alignWithTarget()},onDragEnd:function(){wa.forceMenuHidden=!1;Nb.visible=!1;this.active=Qa.visible=!1;this.shouldHide&&(this.shouldHide=this.visible=!1)}}))}},{key:"minViewer",value:function(){var P=this;return this.viewer({position:this.getMinViewerPosition(),alignWithTarget:function(){this.textString="min: "+P.targetAxis.min.toFixed()+"px !"}})}},{key:"minSpaceBorder",value:function(){return new Zb.Path(Object.assign({position:Zb.pt(-1,
-1),borderStyle:"dashed",borderColor:Zb.Color.green,borderWidth:2},this.getMinSpaceBorder()))}},{key:"minSpaceVisualizer",value:function(){var P=this,wa=this.minSpaceBorder();return this.halo.addGuide(new Zb.Morph({fill:Zb.Color.green.withA(.1),visible:!1,isHaloItem:!0,submorphs:[wa],alignWithTarget:function(){this.extent=P.getMinSpaceExtent();this.topLeft=Zb.pt(5,5)}}))}},{key:"axisMenu",value:function(){var P=this.lockButton(),wa=this.menuButton(),Qa=this;return new Zb.Morph({layout:this.getMenuLayout(),
submorphs:[P,wa],fill:Zb.Color.transparent,visible:!1,becomesActiveOnHover:!0,alignWithTarget:function(){this.bottomRight=this.owner.extent.subPt(Qa.getMenuOffset(this))}})}},{key:"lockButton",value:function(){var P=this;return this.halo.addGuide(new Zb.Morph({fill:Zb.Color.transparent,extent:Zb.pt(25,25),submorphs:[{center:Zb.pt(12.5,12.5),fill:Zb.Color.transparent,styleClasses:["fa","fa-unlock"]}],alignWithTarget:function(){P.targetAxis.fixed?(this.fontColor=Zb.Color.red,this.submorphs[0].styleClasses=
["fa","fa-lock"]):(this.fontColor=Zb.Color.green,this.submorphs[0].styleClasses=["fa","fa-unlock"])},onMouseDown:function(){this.toggleLock()},toggleLock:function(){P.targetAxis.fixed=!P.targetAxis.fixed;P.halo.alignWithTarget()}}))}},{key:"menuButton",value:function(){var P=this,wa=this;return new Zb.Morph({fill:Zb.Color.transparent,extent:Zb.pt(25,25),submorphs:[{fill:Zb.Color.transparent,styleClasses:["fa","fa-cog"],center:Zb.pt(12.5,12.5)}],onMouseDown:function(Qa){wa.forceMenuVisible=!0;this.addMorph(Qa.state.menu=
new Zb.Menu({position:Zb.pt(15,15),items:[["Remove "+wa.subject,function(){P.targetAxis.remove();P.halo.initGuides();P.halo.alignWithTarget()}],["Insert "+wa.subject+" before",function(){P.targetAxis.addBefore();P.halo.initGuides();P.halo.alignWithTarget()}],["Insert "+wa.subject+" after",function(){P.targetAxis.addAfter();P.halo.initGuides();P.halo.alignWithTarget()}]]}))}})}},{key:"viewer",value:function(P){var wa=P.position;P=P.alignWithTarget;return this.halo.addGuide(new Zb.Text({styleClasses:["Halo"],
padding:Zb.Rectangle.inset(6),visible:!1,borderRadius:10,fontColor:Zb.Color.white,fill:Zb.Color.black.withA(.5),position:wa,alignWithTarget:P,readOnly:!0}))}},{key:"proportionViewer",value:function(){var P=this;return this.viewer({position:this.getProportionViewerPosition(),alignWithTarget:function(){this.textString=P.targetAxis.length.toFixed(1)+"px"}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"AxisHalo"}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:660,end:7979})})(Zb.Morph);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Aa.hasOwnProperty("RowHalo")&&"function"===typeof Aa.RowHalo?Aa.RowHalo:Aa.RowHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:Symbol.for("lively-instance-initialize"),
value:function(P){var wa=P.row;P=P.halo;pb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:P.target.row(wa),halo:P})}},{key:"subject",get:function(){return"row"}},{key:"adjustStretch",value:function(P){this.targetAxis.height+=P}},{key:"getDelta",value:function(P){return P.state.dragDelta.y}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.y}},{key:"fetchPosition",value:function(){return Zb.pt(-45,this.axisOffset()+
10)}},{key:"fetchExtent",value:function(){return Zb.pt(40,this.targetAxis.length-10)}},{key:"getMenuOffset",value:function(P){return this.targetAxis.length>P.height?Zb.pt(2,5):Zb.pt(26,10)}},{key:"getMenuLayout",value:function(){return new Zb.VerticalLayout}},{key:"getResizeCursor",value:function(){return"row-resize"}},{key:"getMinViewerPosition",value:function(){return Zb.pt(50,20)}},{key:"getMinSliderPosition",value:function(){return Zb.pt(0,-this.targetAxis.min)}},{key:"getMinSpaceExtent",value:function(){return Zb.pt(this.container.width+
45,this.targetAxis.min)}},{key:"getMinSpaceBorder",value:function(){return{extent:Zb.pt(this.container.width+50,2),vertices:[Zb.pt(0,1),Zb.pt(this.container.width+50,1)]}}},{key:"getProportionViewerPosition",value:function(){return Zb.pt(40,20)}},{key:"getProportionSliderBounds",value:function(P){return Zb.pt(0,P.owner.height-5).extent(Zb.pt(40,10))}},{key:"getDeviderBounds",value:function(){return Zb.pt(15,4).extent(Zb.pt(25,2))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RowHalo"}}],
Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:7981,end:9208})})(Zb.AxisHalo);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Aa.hasOwnProperty("ColumnHalo")&&"function"===typeof Aa.ColumnHalo?Aa.ColumnHalo:Aa.ColumnHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var wa=P.col;P=P.halo;pb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:P.target.col(wa),halo:P})}},{key:"subject",get:function(){return"column"}},{key:"adjustStretch",value:function(P){this.targetAxis.width+=P}},{key:"getDelta",value:function(P){return P.state.dragDelta.x}},{key:"axisOffset",
value:function(){return this.targetAxis.origin.position.x}},{key:"fetchPosition",value:function(){return Zb.pt(this.axisOffset()+10,-45)}},{key:"fetchExtent",value:function(){return Zb.pt(this.targetAxis.length-10,40)}},{key:"getMenuOffset",value:function(P){return this.targetAxis.length>P.width?Zb.pt(5,3):Zb.pt(8,26)}},{key:"getMenuLayout",value:function(){return new Zb.HorizontalLayout}},{key:"getResizeCursor",value:function(){return"col-resize"}},{key:"getMinViewerPosition",value:function(){return Zb.pt(20,
50)}},{key:"getMinSliderPosition",value:function(){return Zb.pt(-this.targetAxis.min,0)}},{key:"getMinSpaceExtent",value:function(){return Zb.pt(this.targetAxis.min,this.container.height+45)}},{key:"getMinSpaceBorder",value:function(){return{extent:Zb.pt(2,this.container.height+50),vertices:[Zb.pt(1,0),Zb.pt(1,this.container.height+50)]}}},{key:"getProportionViewerPosition",value:function(){return Zb.pt(20,40)}},{key:"getProportionSliderBounds",value:function(P){return Zb.pt(P.owner.width-5,0).extent(Zb.pt(10,
40))}},{key:"getDeviderBounds",value:function(){return Zb.pt(4,15).extent(Zb.pt(2,25))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColumnHalo"}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:9210,end:10442})})(Zb.AxisHalo);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
Mb=Aa.hasOwnProperty("CellGuide")&&"function"===typeof Aa.CellGuide?Aa.CellGuide:Aa.CellGuide=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"menuItems",value:function(){var P=this,wa=Zb.Icon.textAttribute("check-square-o"),Qa=Zb.Icon.textAttribute("square-o");wa[1].textStyleClasses.push("annotation");Qa[1].textStyleClasses.push("annotation");Qa[1].paddingRight="2px";return[["Resize Policy",[[["Rigid  ",
null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?Qa:wa)),function(){P.cellGroup.resize=!1}],[["Space Filling  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?wa:Qa)),function(){P.cellGroup.resize=!0}]]],["Align at...",["center"].concat($jscomp.arrayFromIterable((new Zb.Rectangle).sides),$jscomp.arrayFromIterable((new Zb.Rectangle).corners)).map(function(Nb){return[[Nb,{paddingRight:"2px"}].concat($jscomp.arrayFromIterable(P.cellGroup.align==Nb?wa:Qa),["  ",null]),function(){return P.cellGroup.align=
Nb}]})]].concat(this.cellGroup.morph?[["Release Morph from Cell",function(){var Nb=P.cellGroup.morph;Nb&&(P.world().firstHand.grab(Nb),P.world().firstHand.longClickGrab=!0,Nb.position=Zb.pt(0))}]]:[])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CellGuide"}},{key:"properties",get:function(){return{cellGroup:{}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10444,end:11722})})(Zb.Morph);(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Aa.hasOwnProperty("LayoutHalo")&&"function"===typeof Aa.LayoutHalo?Aa.LayoutHalo:Aa.LayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutHalo"}},
{key:"properties",get:function(){return{container:{},target:{},pointerId:{},halosEnabled:{defaultValue:!1},isEpiMorph:{defaultValue:!0},isHaloItem:{defaultValue:!0},borderColor:{defaultValue:Zb.Color.orange},borderWidth:{defaultValue:2},styleClasses:{defaultValue:["Halo"]}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:11724,end:12137})})(Zb.Morph);Qd=Da("G",function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Aa.hasOwnProperty("GridLayoutHalo")&&"function"===typeof Aa.GridLayoutHalo?Aa.GridLayoutHalo:Aa.GridLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"previewDrop",value:function(P){1>P.length||(P=this.cellGuides.find(function(wa){return wa.fullContainsWorldPoint($world.firstHand.position)}),
P!=this.currentCell&&this.currentCell&&this.currentCell.stopPreview(),(this.currentCell=P)&&this.currentCell.startPreview())}},{key:"handleDrop",value:function(P){var wa=this;this.currentCell&&P.whenRendered().then(function(){return wa.currentCell.cellGroup.morph=P})}},{key:"initialize",value:function(){this.initGuides();this.alignWithTarget();this.focus()}},{key:"optionControls",value:function(){var P=this.target,wa=new Zb.LabeledCheckBox({name:"compensateOrigin",label:"Compensate Origin",fill:Zb.Color.transparent,
checked:P.compensateOrigin}),Qa=new Zb.LabeledCheckBox({label:"Resize Submorphs",fill:Zb.Color.transparent,name:"fitToCell",checked:P.fitToCell});Zb.connect(wa,"checked",P,"compensateOrigin");Zb.connect(Qa,"checked",P,"fitToCell");Zb.connect(wa,"checked",this,"alignWithTarget");return[wa,Qa]}},{key:"isLayoutHalo",get:function(){return!1}},{key:"alignWithTarget",value:function(){this.target.apply();this.position=this.container.globalPosition;this.target.compensateOrigin&&this.moveBy(this.container.origin.negated());
this.extent=this.container.extent;this.addMissingGuides();Zb.arr.reverse(this.guides).forEach(function(P){return P.alignWithTarget()})}},{key:"addMissingGuides",value:function(){var P=this;Zb.arr.withoutAll(this.target.cellGroups,this.guides.map(function(wa){return wa.cellGroup})).forEach(function(wa){return P.addMorph(P.cellGuide(wa))})}},{key:"initGuides",value:function(){this.submorphs=[];this.guides=[];this.initCellGuides();this.initColumnGuides();this.initRowGuides()}},{key:"initCellGuides",
value:function(){var P=this,wa=this.addMorph({fill:Zb.Color.transparent,borderRadius:this.borderRadius,extent:this.extent});this.target.cellGroups.forEach(function(Qa){wa.addMorph(P.cellGuide(Qa))});this.cellGuides=wa.submorphs;this.addMorph(this.resizer())}},{key:"addGuide",value:function(P){P.isHaloItem=!0;this.guides.push(P);return P}},{key:"initRowGuides",value:function(){var P=this,wa=this;this.addGuide(this.addMorph(new Zb.Morph({width:25,fill:Zb.Color.gray.withA(.7),borderRadius:15,height:this.container.height,
topRight:Zb.pt(-5,0),alignWithTarget:function(){this.height=wa.container.height}})));Zb.arr.range(0,this.target.rowCount-1).forEach(function(Qa){P.addMorph(new Zb.RowHalo({row:Qa,halo:P}))})}},{key:"initColumnGuides",value:function(){var P=this,wa=this;this.addGuide(this.addMorph(new Zb.Morph({height:25,fill:Zb.Color.gray.withA(.7),borderRadius:15,width:this.container.width,bottomLeft:Zb.pt(0,-5),alignWithTarget:function(){this.width=wa.container.width}})));Zb.arr.range(0,this.target.columnCount-
1).forEach(function(Qa){P.addMorph(new Zb.ColumnHalo({col:Qa,halo:P}))})}},{key:"resizer",value:function(){var P=this;return this.addGuide(new Zb.Morph({fill:Zb.Color.transparent,extent:Zb.pt(25,25),nativeCursor:"nwse-resize",onDrag:function(wa){P.container.resizeBy(wa.state.dragDelta);P.alignWithTarget()},alignWithTarget:function(){this.bottomRight=P.extent}}))}},{key:"cellResizer",value:function(P,wa){var Qa=this,Nb="topLeft"==wa?"bottomRight":"topLeft";return new Zb.Ellipse({borderWidth:1,visible:!1,
borderColor:Zb.Color.black,nativeCursor:"nwse-resize",removeCell:function(Gc){P.disconnect(Gc);Qa.alignWithTarget()},addCell:function(Gc){P.connect(Gc);Qa.alignWithTarget()},start:function(){this.fixpointCell=P[Nb];this.draggedDelta=P.bounds().partNamed(wa);this.debugMorph=Qa.addMorph(new Zb.Morph({fill:Zb.Color.orange.withA(.5)}))},update:function(Gc){var Uc=this;this.draggedDelta=this.draggedDelta.addPt(Gc);var le=Zb.Rectangle.unionPts([this.draggedDelta]).union(this.fixpointCell.bounds());this.debugMorph.setBounds(le);
Qa.cells.forEach(function(Od){var kf=le.intersection(Od.bounds()).area()/Od.bounds().area();P.includes(Od)&&.1>kf&&Uc.removeCell(Od);!P.includes(Od)&&kf>1/3&&Uc.addCell(Od)})},onDragEnd:function(Gc){this.debugMorph.remove()},onDragStart:function(Gc){this.start(Gc.position)},onDrag:function(Gc){this.update(Gc.state.dragDelta)}})}},{key:"cellGuide",value:function(P){var wa=this,Qa=this.cellResizer(P,"topLeft"),Nb=this.cellResizer(P,"bottomRight");return this.addGuide(new Zb.CellGuide({cellGroup:P,bounds:P.bounds(),
fill:Zb.Color.transparent,borderColor:Zb.Color.orange,borderWidth:1,isHaloItem:!0,isCell:!0,draggable:!1,submorphs:[Qa,Nb],onMouseDown:function(Gc){this.becomeActive()},deactivate:function(){this.borderColor=Zb.Color.orange;this.fill=Zb.Color.transparent;this.submorphs.forEach(function(Gc){Gc.visible=!1})},becomeActive:function(){wa.guides.forEach(function(Gc){Gc.isCell&&Gc.deactivate()});this.borderColor=Zb.Color.rgbHex("#1565C0");this.fill=Zb.Color.rgbHex("#1565C0").withA(.3);wa.addMorph(this.remove());
this.submorphs.forEach(function(Gc){Gc.visible=!0})},startPreview:function(Gc){this.fill=Zb.Color.orange.withA(.7)},stopPreview:function(Gc){this.fill=Zb.Color.transparent},onDrop:function(Gc){var Uc=$jscomp.makeIterator(Gc.hand.grabbedMorphs).next().value;Gc.hand.dropMorphsOn(wa.container);P.morph=Uc},alignWithTarget:function(){P.bounds().isNonEmpty()?(this.setBounds(P.bounds()),Qa.center=this.innerBounds().topLeft(),Nb.center=this.innerBounds().bottomRight()):(Zb.arr.remove(wa.guides,this),this.remove())}}))}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GridLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:Zb.Color.transparent},cells:{derived:!0,get:function(){return Zb.arr.flatten(this.target.col(0).items.map(function(P){return P.row(0).items}))}},submorphs:{initialize:function(){this.initialize()}}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:12146,end:19501})}(Zb.LayoutHalo));Zb.GridLayoutHalo=Qd;Zb.GridLayoutHalo=Qd;Zb.GridLayoutHalo=Qd;ab=function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Aa.hasOwnProperty("TilingLayoutHalo")&&"function"===typeof Aa.TilingLayoutHalo?Aa.TilingLayoutHalo:Aa.TilingLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return pb(Mb,sa,[{key:"remove",value:function(){pb._get(Object.getPrototypeOf(Mb.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"handleDrop",value:function(P){}},{key:"removePreviews",value:function(){this.previews.forEach(function(P){return P.clear()})}},{key:"previewDrop",value:function(P){var wa=this;0<this.previews.length||(this.previews=P.map(function(Qa){return wa.container.addMorph({type:Zb.DropPreview,
bounds:Qa.bounds()})}),this.previews.forEach(function(Qa){Qa.step()}))}},{key:"updateSpacing",value:function(P){this.target.spacing=P}},{key:"updateAxis",value:function(P){this.target.axis=P}},{key:"updateAlign",value:function(P){this.target.align=P}},{key:"optionControls",value:function(){var P=this.target,wa=new Zb.DropDownSelector({borderRadius:2,padding:3,selectedValue:P.axis,values:["row","column"]}),Qa=new Zb.DropDownSelector({borderRadius:2,padding:3,selectedValue:P.align,values:["left","center"]});
P=new Zb.NumberWidget({min:0,number:P.spacing,padding:Zb.rect(5,3,0,0),borderRadius:3,borderWidth:1,borderColor:Zb.Color.gray,unit:"px"});Zb.connect(P,"update",this,"updateSpacing");Zb.connect(Qa,"update",this,"updateAlign");Zb.connect(wa,"update",this,"updateAxis");var Nb={type:"label",padding:Zb.rect(0,5,5,5),fill:Zb.Color.transparent,fontColor:Zb.Color.gray.darker(),readOnly:!0};return[[Object.assign({},Nb,{textString:"Submorph Spacing"}),P],[Object.assign({},Nb,{textString:"Tiling Align"}),Qa],
[Object.assign({},Nb,{textString:"Tiling Axis"}),wa]].map(function(Gc){return{submorphs:Gc,fill:null,layout:new Zb.HorizontalLayout({spacing:3})}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TilingLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:Zb.Color.transparent},previews:{defaultValue:[]}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:19510,end:21708})}(Zb.LayoutHalo);Zb.TilingLayoutHalo=ab;Zb.TilingLayoutHalo=ab;Zb.TilingLayoutHalo=ab;(function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Aa.hasOwnProperty("DropPreview")&&"function"===typeof Aa.DropPreview?Aa.DropPreview:Aa.DropPreview=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,
[{key:"clear",value:function(){this.stopped=!0;this.remove()}},{key:"step",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==Qa.nextAddress)return wa=Zb.easings.inOutQuad,Qa.yield(P.animate({opacity:.5,duration:(P.pulseDuration-10)/2,easing:wa}),2);if(3!=Qa.nextAddress)return Qa.yield(P.animate({opacity:1,duration:(P.pulseDuration-10)/2,easing:wa}),3);P.stopped||P.step();Qa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DropPreview"}},
{key:"properties",get:function(){return{isHaloItem:{readOnly:!0,get:function(){return!0}},epiMorph:{readOnly:!0,get:function(){return!0}},fill:{defaultValue:Zb.Color.orange.withA(.3)},hasFixedPosition:{defaultValue:!0},borderColor:{defaultValue:Zb.Color.orange},borderWidth:{defaultValue:2},borderStyle:{defaultValue:"dashed"},pulseDuration:{defaultValue:2E3}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21710,end:22534})})(Zb.Morph);ab=Da("F",function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Aa.hasOwnProperty("FlexLayoutHalo")&&"function"===typeof Aa.FlexLayoutHalo?Aa.FlexLayoutHalo:Aa.FlexLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"handleDrop",value:function(P){}},{key:"previewDrop",
value:function(P){var wa=this;0<this.previews.length||(this.previews=P.map(function(Qa){return wa.container.addMorph({type:Zb.DropPreview,position:wa.container.localize(wa.world().firstHand.position),extent:Qa.bounds().extent()})}),this.previews.forEach(function(Qa){Qa.step()}))}},{key:"remove",value:function(){pb._get(Object.getPrototypeOf(Mb.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"removePreviews",value:function(){this.previews.forEach(function(P){return P.clear()})}},
{key:"onDrop",value:function(P){this.removePreviews();P.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateAutoResizePolicy",value:function(P){P&&(this.originalExtent=this.container.extent);this.target.autoResize=P;P||(this.container.extent=this.originalExtent||this.container.extent);this.alignWithTarget()}},{key:"updateResizeSubmorphsPolicy",value:function(P){this.target.resizeSubmorphs=P;this.alignWithTarget()}},
{key:"updateAlignmentPolicy",value:function(P){this.target.align=P}},{key:"updateDirectionPolicy",value:function(P){this.target.direction=P}},{key:"updateSpacing",value:function(P){this.target.spacing=P}},{key:"optionControls",value:function(){var P=this.target,wa=P.possibleAlignValues?{fill:Zb.Color.transparent,layout:new Zb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"align: "},new Zb.DropDownSelector({name:"alignment",borderRadius:2,padding:3,
selectedValue:P.align,values:P.possibleAlignValues})]}:null,Qa=P.possibleDirectionValues?{fill:Zb.Color.transparent,layout:new Zb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"direction: "},new Zb.DropDownSelector({name:"direction",borderRadius:2,padding:3,selectedValue:P.direction,values:P.possibleDirectionValues})]}:null,Nb=new Zb.NumberWidget({fill:Zb.Color.white,borderWidth:1,borderRadius:4,padding:Zb.rect(5,4,0,0),borderColor:Zb.Color.gray,
min:0,number:P.spacing,unit:"px"}),Gc=new Zb.LabeledCheckBox({name:"autoResize",label:"Resize Container",alignCheckBox:"right",fill:Zb.Color.transparent,checked:P.autoResize});P=new Zb.LabeledCheckBox({label:"Resize Submorphs",name:"resizeSubmorphs",alignCheckBox:"right",fill:Zb.Color.transparent,checked:P.resizeSubmorphs});Zb.connect(Nb,"update",this,"updateSpacing");Zb.connect(Gc,"checked",this,"updateAutoResizePolicy");Zb.connect(P,"checked",this,"updateResizeSubmorphsPolicy");wa&&Zb.connect(wa.submorphs[1],
"selectedValue",this,"updateAlignmentPolicy");Qa&&Zb.connect(Qa.submorphs[1],"selectedValue",this,"updateDirectionPolicy");return[Gc,P].concat($jscomp.arrayFromIterable([wa,Qa].filter(Boolean)),[{fill:Zb.Color.transparent,layout:new Zb.HorizontalLayout,submorphs:[{type:"label",value:"Submorph Spacing",fontColor:Zb.Color.gray.darker(),padding:Zb.rect(0,5,5,5)},Nb]}])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FlexLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},
fill:{defaultValue:Zb.Color.transparent},halosEnabled:{defaultValue:!1},previews:{defaultValue:[]}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:22543,end:26761})}(Zb.LayoutHalo));Zb.FlexLayoutHalo=ab;Zb.FlexLayoutHalo=ab;Zb.FlexLayoutHalo=ab;jb=Da("c",function(sa){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
Mb=Aa.hasOwnProperty("ProportionalLayoutHalo")&&"function"===typeof Aa.ProportionalLayoutHalo?Aa.ProportionalLayoutHalo:Aa.ProportionalLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(Mb,sa,[{key:"handleDrop",value:function(P){}},{key:"onDrop",value:function(P){P.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateSubmorphProportionalLayoutSettings",
value:function(P){var wa={};this.target.changeSettingsFor(P.submorph,(wa[P.axis]=P.policy,wa),!0)}},{key:"onSubmorphSettingsDragStart",value:function(P,wa){var Qa=this;P.stop();var Nb=this.target.settingsFor(wa);wa="";for(var Gc in Nb)wa+=Gc+":"+Nb[Gc]+" ";var Uc=Zb.morph({type:"label",value:wa,isLayoutable:!1});Uc.wantsToBeDroppedOn=function(le){return Qa.target.layoutableSubmorphs.includes(le)};Uc.onBeingDroppedOn=function(le,Od){Uc.remove();if(le=Qa.target.layoutableSubmorphs.includes(Od)?Od:P.world.morphsContainingPoint(P.hand.position).find(function(kf){return Qa.target.layoutableSubmorphs.includes(kf)}))Qa.updateSubmorphProportionalLayoutSettings({policy:Nb.x,
axis:"x",submorph:le}),Qa.updateSubmorphProportionalLayoutSettings({policy:Nb.y,axis:"y",submorph:le}),le.show(),$world.setStatusMessage("layout settings applied")};P.hand.grab(Uc)}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var P=this,wa,Qa,Nb,Gc,Uc,le,Od,kf,ae,Ke,$e,Cf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rg){switch(rg.nextAddress){case 1:return wa=P.target.layoutableSubmorphs,P.env.eventDispatcher.isKeyPressed("Shift")?(Nb=wa.map(function(Qf){return{isListItem:!0,
string:String(Qf),value:Qf}}),rg.yield($world.listPrompt("Select morph",Nb,{requester:P,onSelection:function(Qf){return Qf.show()}}),5)):rg.yield(Zb.InteractiveMorphSelector.selectMorph(P.world(),P,function(Qf){return wa.includes(Qf)}),4);case 4:Qa=rg.yieldResult;rg.jumpTo(3);break;case 5:Gc=rg.yieldResult,Uc=$jscomp.makeIterator(Gc.selected),Qa=Uc.next().value;case 3:if(!Qa)return rg.return();le=P.state.popover.get("controlContainer");Od=le.getAllNamed(/submorph config/);kf=["move","resize","scale",
"fixed"];ae=P.target.settingsFor(Qa);Od.length||(le.submorphs=[].concat($jscomp.arrayFromIterable(le.submorphs),[{name:"submorph config X-Axis policy",position:Zb.pt(0,P.height),fill:Zb.Color.transparent,layout:new Zb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph X-Axis policy: "},new Zb.DropDownSelector({name:"x-axis policy selector",borderRadius:2,padding:3,selectedValue:ae.x,values:kf})]},{name:"submorph config Y-Axis policy",position:Zb.pt(0,
P.height),fill:Zb.Color.transparent,layout:new Zb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph Y-Axis policy: "},new Zb.DropDownSelector({name:"y-axis policy selector",borderRadius:2,padding:3,selectedValue:ae.y,values:kf})]},Zb.morph({position:Zb.pt(0,P.height+20),draggable:!0,name:"dragme",type:"label",value:"drag me to copy"})]));Ke=le.getSubmorphNamed("x-axis policy selector");$e=le.getSubmorphNamed("y-axis policy selector");Cf=le.getSubmorphNamed("dragme");
Zb.disconnect(Ke,"selectedValue",P,"updateSubmorphProportionalLayoutSettings");Zb.disconnect($e,"selectedValue",P,"updateSubmorphProportionalLayoutSettings");Ke.selectedValue=ae.x;$e.selectedValue=ae.y;Zb.connect(Cf,"onDragStart",P,"onSubmorphSettingsDragStart",{updater:function(Qf,Tc){return Qf(Tc,Qa)},varMapping:{submorph:Qa}});Zb.connect(Ke,"selectedValue",P,"updateSubmorphProportionalLayoutSettings",{converter:function(Qf){return{policy:Qf,axis:"x",submorph:Qa}},varMapping:{submorph:Qa}});Zb.connect($e,
"selectedValue",P,"updateSubmorphProportionalLayoutSettings",{converter:function(Qf){return{policy:Qf,axis:"y",submorph:Qa}},varMapping:{submorph:Qa}});rg.jumpToEnd()}})}},{key:"optionControls",value:function(P){this.state.popover=P;var wa=this.target;P=new Zb.LabeledCheckBox({name:"x-axis",label:"X-Axis",alignCheckBox:"right",fill:Zb.Color.transparent,checked:wa.xAxisEnabled});wa=new Zb.LabeledCheckBox({name:"y-axis",label:"Y-Axis",alignCheckBox:"right",fill:Zb.Color.transparent,checked:wa.yAxisEnabled});
var Qa=new Zb.Button({name:"modify submorph settings button",label:[].concat($jscomp.arrayFromIterable(Zb.Icon.textAttribute("crosshairs")),["\u00a0Change submorph settings"])});Zb.connect(P,"checked",this,"updateXAxisEnabled");Zb.connect(wa,"checked",this,"updateYAxisEnabled");Zb.connect(Qa,"fire",this,"chooseSubmorphToChangeLayoutSettings");return[Qa]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProportionalLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},
fill:{defaultValue:Zb.Color.transparent}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:26771,end:32465})}(Zb.LayoutHalo));Zb.ProportionalLayoutHalo=jb;Zb.ProportionalLayoutHalo=jb;Zb.ProportionalLayoutHalo=jb;Bd=lively.FreezerRuntime.recorderFor("lively.halos/index.js");Bd.Halo=oe;
Bd.MorphHighlighter=Md;Bd.InteractiveMorphSelector=id;Bd.StatusMessage=wc;Bd.StatusMessageForMorph=rd;Bd.show=Sa;Bd.showConnector=ec;Bd.ProportionalLayoutHalo=jb;Bd.GridLayoutHalo=Qd;Bd.FlexLayoutHalo=ab;Bd.showAndSnapToGuides=fa;Bd.removeSnapToGuidesOf=Q;Bd.StatusMessage=wc;Bd.StatusMessage=wc;Bd.StatusMessageForMorph=rd;Bd.StatusMessageForMorph=rd;Bd.show=Sa;Bd.show=Sa;Bd.showConnector=ec;Bd.showConnector=ec;Bd.Halo=oe;Bd.Halo=oe;Bd.MorphHighlighter=Md;Bd.MorphHighlighter=Md;Bd.InteractiveMorphSelector=
id;Bd.InteractiveMorphSelector=id;Bd.ProportionalLayoutHalo=jb;Bd.ProportionalLayoutHalo=jb;Bd.GridLayoutHalo=Qd;Bd.GridLayoutHalo=Qd;Bd.FlexLayoutHalo=ab;Bd.FlexLayoutHalo=ab;Bd.showAndSnapToGuides=fa;Bd.showAndSnapToGuides=fa;Bd.removeSnapToGuidesOf=Q;Bd.removeSnapToGuidesOf=Q;oe=Object.freeze({__proto__:null,StatusMessage:wc,StatusMessageForMorph:rd,show:Sa,showConnector:ec,Halo:oe,MorphHighlighter:Md,InteractiveMorphSelector:id,ProportionalLayoutHalo:jb,GridLayoutHalo:Qd,FlexLayoutHalo:ab,showAndSnapToGuides:fa,
removeSnapToGuidesOf:Q,SvgStyleHalo:void 0});Da("i",oe);Da("_",void 0)}}});
System.register(["./__root_module__-37c88ebd.js","kld-intersections"],function(Wa){var Ib,Sb,xc,ac,Cd,nd,Ud,bd,Ic,pd,yd,Ne,Pe,Ie,fd,me;return{setters:[function(Yb){Ib=Yb.c;Sb=Yb.P;xc=Yb.b;ac=Yb.x;Cd=Yb.y;nd=Yb.z;Ud=Yb.A;bd=Yb.r;Ic=Yb.D;pd=Yb.E;yd=Yb.F;Ne=Yb.G;Pe=Yb.H;Ie=Yb.J;fd=Yb.K;me=Yb.N},function(){}],execute:function(){function Yb(Wb,Cc,Td,Ec){Ec=void 0===Ec?{}:Ec;Ec=Ec.package||gd.ObjectPackage.lookupModuleForClass(Wb.constructor,Ec);if(!Ec)throw Error("Object is not part of an object package: "+
Wb);return Ec.addScript(Wb,Cc,Td)}function Yc(Wb,Cc){Cc=gd.normalizeOptions(Cc).System;Wb=(Wb=Wb[Symbol.for("lively-module-meta")])?Wb.package.name:null;return(Cc=(Wb?gd.lookupPackage(Cc,Wb):{}).pkg)?!!gd.ObjectPackage.forSystemPackage(Cc):!1}function Nd(Wb,Cc){var Td,Ec,Vd,Lb,ub,uc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(dc){return 1==dc.nextAddress?(Td=Wb.constructor,gd.withSuperclasses(Td),Symbol.for("lively-module-meta"),Vd=Ec=gd.ObjectPackage.lookupPackageForObject(Wb),Lb=
Vd.baseURL,ub=Vd.System,dc.yield(Ec.fork(Cc,{baseURL:Lb,System:ub}),2)):3!=dc.nextAddress?(uc=dc.yieldResult,dc.yield(gd.adoptObject(Wb,uc.objectClass),3)):dc.return(uc.objectClass[Symbol.for("__LivelyClassName__")])})}Wa({addScript:Yb,interactivelyForkPackage:Nd,isObjectClass:Yc});var gd=lively.FreezerRuntime.recorderFor("lively.classes/object-classes.js");gd.normalizeOptions=function(Wb){Wb=Object.assign({baseURL:gd.defaultBaseURL,System:System},Wb);Wb.baseURL=Wb.baseURL.replace(/\/$/,"");return Wb};
gd.addScript=Yb;gd.isObjectClass=Yc;gd.interactivelyForkPackage=Nd;gd.string=Ib;gd.Path=Sb;gd.arr=xc;gd.parse=ac;gd.isValidIdentifier=Cd;gd.stringify=nd;gd.parseFunction=Ud;gd.resource=bd;gd.runEval=Ic;gd.scripting=pd;gd.ExportLookup=yd;var ae=gd.scripting;gd.ensurePackage=ae.ensurePackage;gd.registerPackage=ae.registerPackage;gd.importPackage=ae.importPackage;gd.lookupPackage=ae.lookupPackage;gd.module=ae.module;gd.ImportInjector=ae.ImportInjector;gd.RuntimeSourceDescriptor=Ne;gd.toJsIdentifier=
Pe;gd.withSuperclasses=Ie;gd.adoptObject=fd;gd.classToFunctionTransform=me;gd.objectPackageSym=Symbol.for("lively-object-package-data");gd.defaultBaseURL="local://lively-object-modules";gd.globalClasses=Object.keys(System.global).map(function(Wb){Wb=System.global[Wb];return"function"===typeof Wb&&Wb.name&&Wb}).filter(Boolean);gd.addScript=Yb;gd.addScript=Yb;gd.isObjectClass=Yc;gd.isObjectClass=Yc;gd._packageStore=gd._packageStore||{};gd.interactivelyForkPackage=Nd;gd.interactivelyForkPackage=Nd;ae=
function(Wb,Cc){this._id=Wb;this.options=gd.normalizeOptions(Cc)};ae.lookupPackageForObject=function(Wb,Cc){return this.lookupPackageForClass(Wb.constructor,Cc)};ae.lookupPackageForClass=function(Wb,Cc){Cc=gd.normalizeOptions(Cc).System;Wb=(Wb=Wb[Symbol.for("lively-module-meta")])?Wb.package.name:null;return(Cc=(Wb?gd.lookupPackage(Cc,Wb):{}).pkg)?gd.ObjectPackage.forSystemPackage(Cc):null};ae.lookupModuleForClass=function(Wb,Cc){gd.normalizeOptions(Cc);Cc=this.lookupPackageForClass(Wb,Cc);Wb=Wb[Symbol.for("lively-module-meta")];
return new gd.ObjectModule(Wb.pathInPackage,Cc)};ae.forSystemPackage=function(Wb){return this.packageStore[Wb.name]};ae.withId=function(Wb,Cc){return this.packageStore[Wb]||(this.packageStore[Wb]=new this(Wb,Cc))};ae.prototype.ensureSubModule=function(Wb){Wb=void 0===Wb?"index":Wb;var Cc=this,Td;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){return 1==Ec.nextAddress?(Td=new gd.ObjectModule(Wb,Cc),Ec.yield(Td.ensureExistance(),2)):Ec.return(Td)})};ae.prototype.resource=function(Wb){Wb=
void 0===Wb?"":Wb;return gd.resource(this.packageURL).join(Wb)};ae.prototype.load=function(){return gd.importPackage(this.System,this.packageURL)};ae.prototype.ensureExistance=function(){var Wb=this,Cc,Td,Ec,Vd,Lb,ub,uc,dc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zb){switch(Zb.nextAddress){case 1:return Cc=Wb.resource("/"),Zb.yield(Cc.exists(),2);case 2:if(Zb.yieldResult)return Zb.return();Td=[{resource:Cc}];Ec=[{resource:Wb.resource("package.json"),content:JSON.stringify(Wb.config,
null,2)}];return Zb.yield(Promise.all(Td.map(function(Mc){return Mc.resource.mkdir()})),3);case 3:return Zb.yield(Promise.all(Ec.map(function(Mc){var $a;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){switch($b.nextAddress){case 1:return $b.yield(Mc.resource.exists(),2);case 2:if(!($a=!$b.yieldResult)){$b.jumpTo(3);break}return $b.yield(Mc.resource.write(Mc.content),4);case 4:$a=$b.yieldResult;case 3:return $b.return($a)}})})),4);case 4:return Zb.yield(Wb.objectModule.ensureExistance(),
5);case 5:return Vd=Wb,Lb=Vd.System,ub=Vd.packageURL,uc=Vd.config,Zb.yield(gd.ensurePackage(Lb,ub),6);case 6:return dc=Zb.yieldResult,dc.registerWithConfig(uc),console.log(Wb.packageURL+" REGISTERED"),Zb.return(Wb)}})};ae.prototype.ensureObjectClass=function(Wb){var Cc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Td){return 1==Td.nextAddress?Td.yield(Cc.ensureExistance(),2):Td.return(Cc.objectModule.ensureObjectClass(Wb))})};ae.prototype.adoptObject=function(Wb){var Cc=this,Td;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress)return Cc.objectClass===Wb.constructor?Ec.return():Ec.yield(Cc.ensureObjectClass(Wb.constructor),2);Td=Ec.yieldResult;gd.adoptObject(Wb,Td);Ec.jumpToEnd()})};ae.prototype.addScript=function(Wb,Cc,Td){return this.objectModule.addScript(Wb,Cc,Td)};ae.prototype.remove=function(){this.systemPackage.remove();delete gd.ObjectPackage.packageStore[this.id];return this.resource().remove()};ae.prototype.renameObjectClass=function(Wb,
Cc){Cc=void 0===Cc?[]:Cc;var Td=this,Ec,Vd,Lb,ub,uc,dc,Zb,Mc,$a,$b,Eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){if(1==kc.nextAddress){Ec=Td;Vd=Ec.objectClass;Lb=Ec.System;if(!Vd||Vd[Symbol.for("__LivelyClassName__")]===Wb)return kc.return(Vd);if(!gd.isValidIdentifier(Wb))throw Error(Wb+" is not a valid name for a class");uc=ub=gd.RuntimeSourceDescriptor.for(Vd,Lb);dc=uc.source;Zb=uc.ast;Mc=Zb.id;$a=Mc.start;$b=Mc.end;return kc.yield(ub.changeSource(dc.slice(0,$a)+Wb+dc.slice($b)),
2)}Eb=Td.objectClass;Cc.forEach(function(tc){tc.constructor=Eb;tc.__proto__=Eb.prototype});return kc.return(Eb)})};ae.prototype.fork=function(Wb,Cc){var Td=this,Ec,Vd,Lb,ub,uc,dc,Zb,Mc,$a,$b,Eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){switch(kc.nextAddress){case 1:return Ec=Td,Vd=Ec.System,Lb=Ec.baseURL,ub=Ec.objectClass,Cc=Object.assign({System:Vd,baseURL:Lb},Cc),uc=gd.RuntimeSourceDescriptor.for(ub),dc=uc._renamedSource(Wb),Zb=dc.moduleSource,Mc=gd.ObjectPackage.withId(Wb,
Cc),kc.yield(Mc.ensureExistance(),2);case 2:return $a=Mc,$b=$a.objectModule,Eb=$b.systemModule,kc.yield(Eb.load({format:"esm"}),3);case 3:return kc.yield(Eb.changeSource(Zb),4);case 4:return kc.return(Mc)}})};$jscomp.global.Object.defineProperties(ae.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},name:{configurable:!0,enumerable:!0,get:function(){return this.id}},System:{configurable:!0,enumerable:!0,get:function(){return this.options.System}},baseURL:{configurable:!0,
enumerable:!0,get:function(){return this.options.baseURL}},packageURL:{configurable:!0,enumerable:!0,get:function(){return this.baseURL+("/"+this.id)}},config:{configurable:!0,enumerable:!0,get:function(){return{name:this.name,version:"0.1.0",lively:{isObjectPackage:!0}}}},systemPackage:{configurable:!0,enumerable:!0,get:function(){return gd.lookupPackage(this.System,this.packageURL,!0).pkg}},objectModule:{configurable:!0,enumerable:!0,get:function(){return this._objectModule||(this._objectModule=
new gd.ObjectModule("index.js",this))}},objectClass:{configurable:!0,enumerable:!0,get:function(){return this.objectModule.objectClass}}});$jscomp.global.Object.defineProperties(ae,{packageStore:{configurable:!0,enumerable:!0,get:function(){return this._packageStore||(this._packageStore=gd._packageStore)}}});Wa("default",ae);gd.ObjectPackage=ae;var Fe=function(Wb,Cc){if(!Wb)throw Error("ObjectModule needs package!");if(!Cc)throw Error("ObjectModule needs package!");this._moduleName=Wb;this._objectPackage=
Cc};Fe.prototype.read=function(){return this.resource.read()};Fe.prototype.write=function(Wb){return this.resource.write(Wb)};Fe.prototype.ensureExistance=function(){var Wb=this,Cc,Td;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){switch(Ec.nextAddress){case 1:return Cc=Wb.resource,Ec.yield(Cc.exists(),2);case 2:if(Ec.yieldResult){Ec.jumpTo(3);break}return Ec.yield(Cc.write("'format esm';\n"),4);case 4:Td={},Wb.System.config({meta:(Td[Wb.url]={format:"esm"},Td)});case 3:return Ec.return(Wb)}})};
Fe.prototype.adoptObject=function(Wb,Cc){var Td=this,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Vd){if(1==Vd.nextAddress)return Td.objectClass===Wb.constructor?Vd.return():Vd.yield(Td.ensureObjectClass(Wb.constructor,Cc),2);Ec=Vd.yieldResult;gd.adoptObject(Wb,Ec);Vd.jumpToEnd()})};Fe.prototype.ensureObjectClass=function(Wb,Cc){var Td=this,Ec=this.objectClass;return Ec&&Ec.prototype.__proto__===Wb.prototype?Ec:Promise.resolve(this.ensureObjectClassSource(Wb,Cc)).then(function(Vd){var Lb=
Vd.source,ub=Vd.moduleId,uc=Vd.className,dc=Vd.bindings,Zb=Td.System;Vd=gd.module(Zb,ub);if(dc)for(var Mc in dc)Vd.define(Mc,dc[Mc]);Lb=gd.runEval(Lb,{classTransform:gd.classToFunctionTransform,sync:!0,targetModule:ub,System:Zb});if(Lb.isError)throw Lb.value;Lb=Vd.recorder[uc];if(!Lb)throw Error("Failed to define class "+uc+" in "+ub);return Lb})};Fe.prototype.ensureObjectClassSource=function(Wb,Cc){return this.createDefaultClassDeclaration(Wb,Cc)};Fe.prototype.createDefaultClassDeclaration=function(Wb,
Cc){Wb=void 0===Wb?Object:Wb;Cc=void 0===Cc?!1:Cc;var Td=this,Ec,Vd,Lb,ub,uc,dc,Zb,Mc,$a,$b,Eb,kc,tc,Sc,Pd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ec){switch(ec.nextAddress){case 1:Ec=Td;Vd=Ec.System;Lb=Ec.systemModule;ub=Ec.objectPackage;Cc=Cc||gd.string.capitalize(gd.toJsIdentifier(ub.id));uc=Wb[Symbol.for("__LivelyClassName__")];dc=!uc;Zb=gd.globalClasses.includes(Wb);Mc="";$a=null;if(dc){uc="__anonymous_superclass__";$b={};$a=($b[uc]=Wb,$b);ec.jumpTo(2);break}if(Zb){ec.jumpTo(2);
break}return ec.yield(gd.ExportLookup.findExportOfValue(Wb,Vd),4);case 4:(Eb=ec.yieldResult)?(kc=gd.ImportInjector.run(Vd,Lb.id,Lb.package(),"",Eb),tc=kc.standaloneImport,Mc+=tc+"\n\n"):(Sc={},$a=(Sc[uc]=Wb,Sc));case 2:return Cc===uc&&(Cc="Object"+Cc),Pd="Object"===uc?"class "+Cc+" {}\n":"class "+Cc+" extends "+uc+" {}\n",Mc+="export default "+Pd+"\n",ec.yield(Lb.changeSource(Mc),5);case 5:return ec.yield(Lb.load(),6);case 6:return ec.return({source:Mc,className:Cc,moduleId:Td.url,bindings:$a})}})};
Fe.prototype.addScript=function(Wb,Cc,Td){var Ec=this,Vd,Lb,ub,uc,dc,Zb,Mc,$a,$b,Eb,kc,tc,Sc,Pd,ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xb){switch(Xb.nextAddress){case 1:if(Wb.constructor===Ec.objectClass){Vd=Wb.constructor;Xb.jumpTo(2);break}return Xb.yield(Ec.ensureObjectClass(Wb.constructor),3);case 3:Vd=Xb.yieldResult;case 2:Lb=Vd;ub="function"===typeof Cc?String(Cc):Cc;uc=gd.parseFunction(ub);dc=gd.RuntimeSourceDescriptor.for(Lb,Ec.System);Td||(Td=gd.Path("id.name").get(uc));
if(!Td)throw Error("No name, cannot add "+gd.string.truncate(ub,30).replace(/\n/g,"")+"!");Zb=gd.toJsIdentifier(Td);console.assert("FunctionExpression"===uc.type||"ArrowFunctionExpression"===uc.type,"not a function expression but: "+uc.type);Mc=uc.params.map(function(Jb){return ub.slice(Jb.start,Jb.end)});$a="BlockStatement"===uc.body.type?ub.slice(uc.body.start,uc.body.end):"{ return "+ub.slice(uc.body.start,uc.body.end)+" }";$b=Zb+"("+Mc.join(",")+") "+$a;"ArrowFunctionExpression"===uc.type&&(uc.type=
"FunctionExpression");Eb=dc.source;kc=dc.ast;if(!kc)throw Error("cannot find class decl of "+dc.module.id);(tc=kc.body.body.find(function(Jb){return Jb.key.name===Zb&&!Jb.static}))?Eb=Eb.slice(0,tc.start)+$b+Eb.slice(tc.end):(Sc=Eb.lastIndexOf("}"),Pd=Eb.slice(0,Sc),ec=Eb.slice(Sc),/\n\s*$/m.test(Pd)||(Pd+="\n"),$b=gd.string.changeIndent($b,"  ",1),/^[ ]*\n/m.test(ec)||(ec="\n"+ec),Eb=Pd+$b+ec);return Xb.yield(dc.changeSource(Eb),4);case 4:return Xb.return({script:Lb.prototype[Zb],klass:Lb,module:dc.module.id,
methodName:Zb})}})};$jscomp.global.Object.defineProperties(Fe.prototype,{objectPackage:{configurable:!0,enumerable:!0,get:function(){return this._objectPackage}},objectClass:{configurable:!0,enumerable:!0,get:function(){var Wb=this.systemModule;return Wb.isLoaded()?Wb.System.get(Wb.id).default:null}},moduleName:{configurable:!0,enumerable:!0,get:function(){return this._moduleName}},systemModule:{configurable:!0,enumerable:!0,get:function(){return gd.module(this.System,this.url)}},System:{configurable:!0,
enumerable:!0,get:function(){return this.objectPackage.System}},resource:{configurable:!0,enumerable:!0,get:function(){return this.objectPackage.resource(this.moduleName)}},url:{configurable:!0,enumerable:!0,get:function(){return this.resource.url}}});gd.ObjectModule=Fe;gd.default=ae}}});
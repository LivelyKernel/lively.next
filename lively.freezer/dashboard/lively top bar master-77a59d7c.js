System.register("./__root_module__-cd530690.js kld-intersections ./user-ui-956488c9.js ./editor-plugin-26971e16.js ./index-cab7da24.js ./index-101f1e80.js ./index-349f6353.js".split(" "),function(Da,zb){var Rb,kc,dc,ke,hd,$d,md,Qc;return{setters:[function(xd){Rb=xd.ah;kc=xd.an;dc=xd.a2;ke=xd.C;hd=xd.a5;$d=xd.L;md=xd.r;Qc=xd.ar},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var xd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");xd.Morph=
Rb;xd.Icon=kc;xd.pt=dc;xd.Color=ke;xd.arr=hd;xd.LoadingIndicator=$d;xd.resource=md;var Od=function(ge){var Ud=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),nd=Ud.hasOwnProperty("LivelyTopBar")&&"function"===typeof Ud.LivelyTopBar?Ud.LivelyTopBar:Ud.LivelyTopBar=function(Za){Za&&Za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qc(nd,ge,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode=
"Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var Za=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cb){if(1==Cb.nextAddress)return Za.isComponent?Cb.return():Cb.yield(Za.whenRendered(),2);document.body.style.background="black";Za.setEditMode("Halo");Za.getSubmorphNamed("fast load toggler").refresh();Cb.jumpToEnd()})}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=xd.pt(0,0));var Za=
this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;Za.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var Za=this;return Object.entries(this.shapeToIcon).map(function(Cb){Cb=$jscomp.makeIterator(Cb);var bc=Cb.next().value,ic=Cb.next().value;Cb=ic.shortcut;ic=ic.args;return[[].concat($jscomp.arrayFromIterable(Za.currentShapeMode===bc?[].concat($jscomp.arrayFromIterable(xd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),
$jscomp.arrayFromIterable(xd.Icon.textAttribute.apply(xd.Icon,$jscomp.arrayFromIterable(ic))),["   "+bc+" ",{float:"none"},"      "+Cb,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){Za.currentShapeMode=bc;Za.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var Za=this;return Object.entries(this.sideBarToIcon).map(function(Cb){Cb=$jscomp.makeIterator(Cb);var bc=Cb.next().value;Cb=Cb.next().value.args;return[[].concat($jscomp.arrayFromIterable(Za.activeSideBars.includes(bc)?
[].concat($jscomp.arrayFromIterable(xd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(xd.Icon.textAttribute.apply(xd.Icon,$jscomp.arrayFromIterable(Cb))),["   "+bc+" ",{float:"none"}]),function(){return Za.openSideBar(bc)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",
value:function(Za){"Hand"==this._currentEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(Za){Qc._get(Object.getPrototypeOf(nd.prototype),"onKeyDown",this).call(this,Za);if(Za.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!Za.isAltDown()){var Cb={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(Za.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=
Cb[Za.key];this.setEditMode("Shape");break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(Za){var Cb=this,bc,ic,id,fe,Zb,rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lb){switch(Lb.nextAddress){case 1:Cb.activeSideBars.includes(Za)?xd.arr.remove(Cb.activeSideBars,Za):Cb.activeSideBars.push(Za);if("Scene Graph"!=Za){Lb.jumpTo(2);break}if(Cb.sideBar){Lb.jumpTo(3);break}bc=xd.LoadingIndicator.open("loading side bar");ic=Cb;return Lb.yield(zb.import("./scene graph side bar master-d818da98.js"),
5);case 5:if(!(id=Lb.yieldResult)){Lb.jumpTo(6);break}return Lb.yield(xd.resource("part://SystemIDE/scene graph side bar master"),7);case 7:id=Lb.yieldResult;case 6:return Lb.yield(id.read(),4);case 4:return ic.sideBar=Lb.yieldResult,Cb.sideBar.hasFixedPosition=!0,Cb.sideBar.openInWorld(),Cb.sideBar.right=0,Lb.yield(Cb.sideBar.whenRendered(),8);case 8:bc.remove();case 3:Cb.sideBar.toggle(Cb.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=Za){Lb.jumpTo(0);break}if(Cb.stylingPalette){Lb.jumpTo(10);
break}fe=xd.LoadingIndicator.open("loading side bar");Zb=Cb;return Lb.yield(zb.import("./styling side bar master-e5bdb5a9.js"),12);case 12:if(!(rc=Lb.yieldResult)){Lb.jumpTo(13);break}return Lb.yield(xd.resource("part://SystemIDE/styling side bar master"),14);case 14:rc=Lb.yieldResult;case 13:return Lb.yield(rc.read(),11);case 11:return Zb.stylingPalette=Lb.yieldResult,Cb.stylingPalette.hasFixedPosition=!0,Cb.stylingPalette.openInWorld(),Cb.stylingPalette.left=Cb.world().right,Lb.yield(Cb.stylingPalette.whenRendered(),
15);case 15:fe.remove();case 10:Cb.stylingPalette.toggle(Cb.activeSideBars.includes("Styling Palette")),Lb.jumpToEnd()}})}},{key:"onMouseDown",value:function(Za){var Cb=this.get("select shape type"),bc=this.get("shape mode button"),ic=this.get("side bar selector");Za.targetMorph==Cb&&(this.world().openWorldMenu(Za,this.getShapeMenuItems()).position=bc.globalBounds().bottomLeft().subPt(this.world().scroll));Za.targetMorph==bc&&this.setEditMode("Shape");"text mode button"==Za.targetMorph.name&&this.setEditMode("Text");
"hand mode button"==Za.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==Za.targetMorph.name&&this.setEditMode("Halo");"open component browser"==Za.targetMorph.name&&this.interactivelyLoadComponent();Za.targetMorph==ic&&(this.world().openWorldMenu(Za,this.getSideBarMenuItems()).position=ic.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var Za=this,Cb,bc,ic,id,fe;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zb){if(1==
Zb.nextAddress)return Cb=Za.get("open component browser"),bc=Za.get("user flap"),ic=bc.haloShadow,id=bc.haloColor,fe=xd.Color.rgb(102,102,102),Cb.fontColor=id,Cb.dropShadow=ic,Zb.yield(Za.world().execCommand("browse and load component"),2);Cb.dropShadow=!1;Cb.fontColor=fe;Zb.jumpToEnd()})}},{key:"setEditMode",value:function(Za,Cb){var bc=this;Cb=void 0===Cb?!1:Cb;var ic=this.get("user flap"),id=ic.haloShadow,fe=ic.haloColor,Zb=xd.Color.rgb(102,102,102);Cb||(this._currentEditMode=Za);Cb=this.get("shape mode button");
ic=this.get("text mode button");var rc=this.get("hand mode button"),Lb=this.get("halo mode button");[["Shape",Cb.submorphs],["Text",[ic]],["Hand",[rc]],["Halo",[Lb]]].forEach(function(Gc){var $c=$jscomp.makeIterator(Gc);Gc=$c.next().value;$c=$c.next().value;"Shape"==Za?bc.world().toggleShapeMode(!0,bc.currentShapeMode):"Text"==Za?bc.world().toggleShapeMode(!0,"Text"):bc.world().toggleShapeMode(!1);bc.world().showHaloPreviews("Halo"==Za);Gc==Za?$c.forEach(function(ed){ed.dropShadow=id;ed.fontColor=
fe}):$c.forEach(function(ed){ed.dropShadow=null;ed.fontColor=Zb})})}}],[{key:"className",get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],set:function(Za){this.setProperty("currentShapeMode",Za);this.get("shape status icon").textAndAttributes=xd.Icon.textAttribute(this.shapeToIcon[Za].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",
{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",
{paddingTop:"1px"}]},HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],Ud,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-151"}}},{start:328,end:9061})}(xd.Morph);Od=xd.LivelyTopBar;xd.default=Od}}});
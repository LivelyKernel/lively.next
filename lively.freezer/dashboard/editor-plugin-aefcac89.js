System.register(["./__root_module__-7cbd94df.js","./index-a563870d.js","./index-cfc100d1.js"],function(Da){var Ab,Rb,jc,cc,je,fd,Yd,jd,Pc,vd,Ld,ge,Td,md,Za,Db,ac,ic,gd,fe,Yb,qc,Ob,Hc,Yc,cd,$b,pb,xc,Lc,Ga,Ra,rb,Kb,Ib,gb,ib,Lb,tc,Qc,sc,Vc,Q,fa,Ia;return{setters:[function(Sa){Ab=Sa.C;Rb=Sa.as;jc=Sa.a6;cc=Sa.a1;je=Sa.a3;fd=Sa.an;Yd=Sa.bh;jd=Sa.aV;Pc=Sa.aq;vd=Sa.s;Ld=Sa.aP;ge=Sa.bo;Td=Sa.bp;md=Sa.a7;Za=Sa.au;Db=Sa.ap;ac=Sa.ar;ic=Sa.bq;gd=Sa.br;fe=Sa.a2;Yb=Sa.P;qc=Sa.$;Ob=Sa.aX;Hc=Sa.ai;Yc=Sa.aj;cd=
Sa.ak;$b=Sa.al;pb=Sa.aB;xc=Sa.a_;Lc=Sa.ax;Ga=Sa.ao;Ra=Sa.aa;rb=Sa.bs;Kb=Sa.L;Ib=Sa.bt;gb=Sa.b3;ib=Sa.bi;Lb=Sa.b2;tc=Sa.bu;Qc=Sa.at},function(Sa){sc=Sa.M;Vc=Sa.I;Q=Sa.v;fa=Sa.p},function(Sa){Ia=Sa.localInterface}],execute:function(){function Sa(Ha,cb){if(!0===cb)return cb;if(Ha.copyState)return Ha.copyState(cb);Ha={};for(var Hb in cb){var ba=cb[Hb];ba instanceof Array&&(ba=ba.concat([]));Ha[Hb]=ba}return Ha}function ec(Ha,cb,Hb){return Ha.startState?Ha.startState(cb,Hb):!0}function Vb(Ha,cb){return P.modes[Ha]=
cb}function Ua(Ha){if("string"==typeof Ha&&P.mimeModes.hasOwnProperty(Ha))Ha=P.mimeModes[Ha];else if(Ha&&"string"==typeof Ha.name&&P.mimeModes.hasOwnProperty(Ha.name)){var cb=P.mimeModes[Ha.name];"string"==typeof cb&&(cb={name:cb});Ha=Object.assign({},cb,Ha);Ha.name=cb.name}else{if("string"==typeof Ha&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ha))return Ua("application/xml");if("string"==typeof Ha&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ha))return Ua("application/json")}return"string"==typeof Ha?{name:Ha}:Ha||{name:"null"}}
function wc(Ha,cb){cb=P.resolveMode(cb);"string"===typeof cb&&(cb={name:cb});if(!cb.name)throw Error("parserConfig does not have a name of the mode to get");var Hb=P.modes[cb.name];if(!Hb)return wc(Ha,"text/plain");Ha=Object.assign({indentUnit:2},Ha);return Object.assign(Hb(Ha,cb),{name:cb.name})}function oe(Ha,cb){for(var Hb;Ha.innerMode;){Hb=Ha.innerMode(cb);if(!Hb||Hb.mode==Ha)break;cb=Hb.state;Ha=Hb.mode}return Hb||{mode:Ha,state:cb}}function Md(Ha,cb){P.mimeModes[Ha]=cb}function id(Ha,cb,Hb){}
function Ta(Ha,cb,Hb,ba,Ja,nb,zb){var Ic=Ha.editorPlugin._tokenizerValidBefore;Ic&&Ic.row>=Hb&&(Ic.row=Hb-1);var vc=P.linesToTokenize(Ha.document,Hb,ba,Ic);Ic=vc.lines;vc=vc.state;if(!Ic.length)return!1;vc=vc?P.copyState(cb,vc):P.startState(cb);for(var Ad=0;Ad<Ic.length;Ad++){var wd=Ic[Ad],yd=wd.row;yd>=Hb&&yd<=ba&&P.indentLine(Ha,cb,wd,vc,Ja,nb,zb);vc=P.tokenizeLine(cb,Ic[Ad],vc,function(){})}return!0}function rd(Ha,cb,Hb,ba,Ja,nb,zb){cb=P.linesToTokenize(cb,Hb,ba,Ja);Hb=cb.lines;P.tokenizeLines(Ha,
Hb,cb.state,nb,zb);return Hb}function jb(Ha,cb,Hb,ba,Ja){var nb=[],zb,Ic=function(wd){return nb.push(zb=[])},vc=function(wd,yd,He,gf,ng,Jh,Mi){return zb.push(He,gf,wd,ng.current(),yd.localMode||Mi)};try{var Ad=P.visitDocumentTokens(Ha,cb,Hb,ba,Ja,Ic,vc)}catch(wd){nb.length=0,Ad=P.visitDocumentTokens(Ha,cb,Hb,ba,null,Ic,vc)}return{tokens:nb,lines:Ad}}function Qd(Ha,cb,Hb,ba,Ja){null==cb&&(cb=Ha.search(/[^\s\u00a0]/),-1==cb&&(cb=Ha.length));ba=ba||0;for(Ja=Ja||0;;){var nb=Ha.indexOf("\t",ba);if(0>nb||
nb>=cb)return Ja+(cb-ba);Ja+=nb-ba;Ja+=Hb-Ja%Hb;ba=nb+1}}function ab(Ha){Ha=Ha.toLowerCase();for(var cb=0;cb<P.modeInfo.length;cb++){var Hb=P.modeInfo[cb];if(Hb.mime==Ha)return Hb;if(Hb.mimes)for(var ba=0;ba<Hb.mimes.length;ba++)if(Hb.mimes[ba]==Ha)return Hb}if(/\+xml$/.test(Ha))return ab("application/xml");if(/\+json$/.test(Ha))return ab("application/json")}function lb(Ha){for(var cb=0;cb<P.modeInfo.length;cb++){var Hb=P.modeInfo[cb];if(Hb.ext)for(var ba=0;ba<Hb.ext.length;ba++)if(Hb.ext[ba]==Ha)return Hb}}
function vb(Ha){for(var cb=0;cb<P.modeInfo.length;cb++){var Hb=P.modeInfo[cb];if(Hb.file&&Hb.file.test(Ha))return Hb}cb=Ha.lastIndexOf(".");if(Ha=-1<cb&&Ha.substring(cb+1,Ha.length))return P.findModeByExtension(Ha)}function Bd(Ha){Ha=Ha.toLowerCase();for(var cb=0;cb<P.modeInfo.length;cb++){var Hb=P.modeInfo[cb];if(Hb.name.toLowerCase()==Ha)return Hb;if(Hb.alias)for(var ba=0;ba<Hb.alias.length;ba++)if(Hb.alias[ba].toLowerCase()==Ha)return Hb}}function de(Ha){if(!Ha)return String(Ha);if(Array.isArray(Ha))return"["+
Ha.map(de).join(",")+"]";if("symbol"===typeof Ha)return ae.printSymbol(Ha);try{return String(Ha)}catch(cb){return"Cannot print object: "+cb}}function Ee(Ha,cb){return!ae.arr.every(cb.map(function(Hb){return Ha[Hb]}),function(Hb){return ae.obj.equals(Hb,Ha&&Ha.valueOf())})}function Ze(Ha){if(ae.obj.isPrimitive(Ha))var cb=ae.string.print(Ha);else Array.isArray(Ha)?((cb=3<Ha.length)&&(Ha=Ha.slice(0,3)),Ha=ae.string.print(Ha),cb&&(Ha=Ha.slice(0,-1)+", ...]"),cb=Ha):cb=ae.string.print(Ha);cb=cb.replace(/\n/g,
"");500<cb.length&&(cb=cb.slice(0,20)+("...["+(cb.length-20)+' CHARS]"'));return cb}function Zc(Ha){return Tc.Inspector.openInWindow({targetObject:Ha})}function ye(Ha,cb){return Tc.Inspector.openInWindow({remoteTarget:{code:Ha,evalEnvironment:cb}})}function Hd(Ha,cb){function Hb(Ic){var vc=Ic.name,Ad=Ic.ownerChain(),wd=Ic.owner,yd=Ic.world(),He;Ic===nb&&(He=[zb]);yd===Ic&&(He=["$world"]);if(!He&&vc&&wd){wd===yd&&1===Tc.arr.count(Tc.arr.pluck(yd.submorphs,"name"),vc)&&(He=['$world.get("'+vc+'")']);
if(!He&&wd!=yd)for(yd=Ad.length-1;yd--;)if(1===Ad[yd].getAllNamed(vc).length){He=[].concat($jscomp.arrayFromIterable(Hb(Ad[yd])),['get("'+vc+'")']);break}He||(vc=[].concat($jscomp.arrayFromIterable(Hb(wd)),['get("'+vc+'")']),Tc.syncEval(vc.join("."),{context:nb}).value===Ic&&(He=vc))}He||(He=[zb+'.getMorphById("'+Ic.id+'")']);return He}cb=void 0===cb?{}:cb;var ba=Ha.world(),Ja=cb;cb=void 0===Ja.maxLength?10:Ja.maxLength;var nb=void 0===Ja.fromMorph?ba:Ja.fromMorph;if(nb===Ha)return"this";var zb=ba===
nb?"$world":"this";if(!(ba||Ha.name&&nb.get(Ha.name)===Ha))return"morph";ba=Hb(Ha);return ba.length>cb?'$world.getMorphWithId("'+Ha.id+'")':ba.join(".")}function Zb(Ha,cb,Hb){var ba=(cb=void 0===cb?"":cb)&&rf.arr.last(cb.split(".")).toLowerCase(),Ja="",nb=0,zb=Math.pow(2,19);if("string"===typeof Ha){if(Ha.length>zb)return null}else if(Ha.document.stringSize>zb)return null;if("string"===typeof Ha)Ja=Ha.slice(0,1E3);else for(Ha=$jscomp.makeIterator(Ha.document.lines),zb=Ha.next();!zb.done;zb=Ha.next()){var Ic=
zb.value;zb=Ic.stringSize;Ic=Ic.text;var vc=!0;1E3<nb+zb&&(vc=!1,zb=1E3-nb);Ja+=Ic.slice(0,zb)+(vc?"\n":"");nb+=zb;if(1E3<=nb)break}nb=$jscomp.makeIterator(rf.modeInfo);for(Ha=nb.next();!Ha.done;Ha=nb.next()){vc=Ha.value;zb=vc.contentTest;Ha=vc.mode;Ic=vc.ext;vc=vc.file;if("function"===typeof zb)try{if(zb(Ja))return Ha}catch(Ad){}if(vc&&vc instanceof RegExp&&vc.test(cb))return Ha;if(Ic)for(zb=$jscomp.makeIterator(Ic),Ic=zb.next();!Ic.done;Ic=zb.next())if(Ic.value===ba)return Ha}return Hb}Da({a:Md,
d:Vb,r:id});var sa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");sa.Color=Ab;var Aa=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Hb=cb.hasOwnProperty("DefaultTheme")&&"function"===typeof cb.DefaultTheme?cb.DefaultTheme:cb.DefaultTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:"background",get:function(){return sa.Color.white}},
{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:sa.Color.white,fontWeight:"bold",backgroundColor:sa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:sa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:sa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],cb,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2867})}(void 0),Mb=Aa=sa.DefaultTheme;sa.default=Aa;var P=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");P.copyState=Sa;P.startState=ec;P.defineMode=Vb;P.resolveMode=Ua;P.getMode=wc;P.innerMode=oe;P.defineMIME=Md;P.registerHelper=id;P.indentLines=Ta;P.indentLine=function(Ha,cb,Hb,ba,Ja,nb,zb){zb=Object.assign({indentWithTabs:!Ha.useSoftTabs,indentUnit:Ha.tabWidth,tabSize:4,ignoreFollowingText:!1},zb);null==
Ja&&(Ja="add");"smart"==Ja&&(cb.indent||(Ja="prev"));var Ic=zb.tabSize,vc=Hb.text,Ad=P.countColumn(vc,null,Ic);Hb.modeState&&(Hb.modeState=null);var wd=vc.match(/^\s*/)[0];if(!nb&&!/\S/.test(vc)){var yd=0;Ja="not"}else if("smart"==Ja&&(yd=cb.indent(ba,zb.ignoreFollowingText?"":vc.slice(wd.length),vc),yd==P.passIndent||150<yd)){if(!nb)return;Ja="prev"}"prev"==Ja?yd=0<Hb.row?P.countColumn(Hb.prevLine().text,null,Ic):0:"add"==Ja?yd=Ad+zb.indentUnit:"subtract"==Ja?yd=Ad-zb.indentUnit:"number"==typeof Ja&&
(yd=Ad+Ja);yd=Math.max(0,yd);cb="";ba=0;if(zb.indentWithTabs)for(zb=Math.floor(yd/Ic);zb;--zb)ba+=Ic,cb+="\t";ba<yd&&(cb+=" ".repeat(yd-ba));if(cb!=wd)return Ha.replace({start:{row:Hb.row,column:0},end:{row:Hb.row,column:wd.length}},cb),!0};P.tokenizeLines=function(Ha,cb,Hb,ba,Ja){if(cb.length){Hb=Hb?P.copyState(Ha,Hb):P.startState(Ha);for(var nb=0;nb<cb.length;nb++){var zb=cb[nb];ba(zb);Hb=P.tokenizeLine(Ha,zb,Hb,Ja)}}};P.tokenizeLine=function(Ha,cb,Hb,ba){var Ja=cb.text;if(!Ja)return Hb;var nb=
new P.StringStream(Ja,2);Hb=cb.modeState="function"===typeof Ha.copyState?Ha.copyState(Hb):P.copyState(Ha,Hb);cb.prevLine();for(Hb._string=Ja;!nb.eol();)Ja=Ha.token(nb,Hb),ba(Ja,Hb,nb.start,nb.pos,nb,cb,Ha),nb.start=nb.pos;return Hb};P.printTokens=function(Ha){for(var cb="",Hb=0;Hb<Ha.length;Hb+=5)cb+=Ha[Hb+0]+" => "+Ha[Hb+1]+" "+Ha[Hb+2]+" "+Ha[Hb+3]+" "+Ha[Hb+4].name+"\n";return cb};P.visitDocumentTokens=rd;P.tokenizeDocument=jb;P.linesToTokenize=function(Ha,cb,Hb,ba){if(ba&&ba.row>=Hb)return{lines:[],
state:null};cb=ba?Math.max(0,ba.row-1):cb;var Ja=Ha.getLine(cb),nb=Ja.text;Ha=[Ja];ba=null;for(var zb=0,Ic;(Ic=Ja.prevLine())&&50>zb++;){Ja=Ic;if(Ja.modeState){ba=Ja.modeState;break}Ha.unshift(Ja)}if(!ba){for(var vc=Ja,Ad=Infinity;(Ic=Ja.prevLine())&&100>zb++;){Ja=Ic;if(Ja.modeState){ba=Ja.modeState;break}Ha.unshift(Ja);Ic=nb.match(/^\s*/)[0].length;if(0===Ic)break;Ic<Ad&&(Ad=Ic,vc=Ja)}!ba&&0<Ad&&(Ha=Ha.slice(Ha.indexOf(vc)))}if(Hb>cb)for(Ja=P.arr.last(Ha);cb<=Hb;cb++){Ja=Ja.nextLine();if(!Ja)break;
Ha.push(Ja)}return{lines:Ha,state:ba}};P.countColumn=Qd;P.findModeByMIME=ab;P.findModeByExtension=lb;P.findModeByFileName=vb;P.findModeByName=Bd;P.arr=jc;Aa=P.modes||{};P.modes=Aa;P.modes=Aa;P.modes=Aa;Aa=Da("p",{});P.passIndent=Aa;P.passIndent=Aa;P.passIndent=Aa;P.copyState=Sa;P.copyState=Sa;P.startState=ec;P.startState=ec;P.defineMode=Vb;P.defineMode=Vb;P.resolveMode=Ua;P.resolveMode=Ua;P.getMode=wc;P.getMode=wc;P.innerMode=oe;P.innerMode=oe;Aa={};P.mimeModes=Aa;P.mimeModes=Aa;P.mimeModes=Aa;P.defineMIME=
Md;P.defineMIME=Md;P.registerHelper=id;P.registerHelper=id;P.indentLines=Ta;P.indentLines=Ta;P.visitDocumentTokens=rd;P.visitDocumentTokens=rd;P.tokenizeDocument=jb;P.tokenizeDocument=jb;P.countColumn=Qd;P.countColumn=Qd;(function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Hb=cb.hasOwnProperty("StringStream")&&"function"===typeof cb.StringStream?cb.StringStream:cb.StringStream=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Rb(Hb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,Ja){this.reset(ba,Ja)}},{key:"reset",value:function(ba,Ja){this.pos=this.start=0;this.string=void 0===ba?"":ba;this.tabSize=void 0===Ja?2:Ja;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",
value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(ba){var Ja=this.string.charAt(this.pos);if("string"==typeof ba?Ja==ba:Ja&&(ba.test?ba.test(Ja):ba(Ja)))return++this.pos,Ja}},{key:"eatWhile",value:function(ba){for(var Ja=this.pos;this.eat(ba););return this.pos>Ja}},{key:"eatSpace",value:function(){for(var ba=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>ba}},{key:"skipToEnd",value:function(){this.pos=
this.string.length}},{key:"skipTo",value:function(ba){ba=this.string.indexOf(ba,this.pos);if(-1<ba)return this.pos=ba,!0}},{key:"backUp",value:function(ba){this.pos-=ba}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=P.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return P.countColumn(this.string,
null,this.tabSize)-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(ba,Ja,nb){if("string"==typeof ba){var zb=function(vc){return nb?vc.toLowerCase():vc},Ic=this.string.substr(this.pos,ba.length);if(zb(Ic)==zb(ba))return!1!==Ja&&(this.pos+=ba.length),!0}else{if((ba=this.string.slice(this.pos).match(ba))&&0<ba.index)return null;ba&&!1!==Ja&&(this.pos+=ba[0].length);return ba}}},{key:"current",value:function(){return this.string.slice(this.start,
this.pos)}},{key:"hideFirstChars",value:function(ba,Ja){this.lineStart+=ba;try{return Ja()}finally{this.lineStart-=ba}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],cb,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);Aa=[{name:"APL",
mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",
ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],
file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",
ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ha){return Ha.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",
ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",
ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",
mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},
{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",
mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],
alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown",
"md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",
mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",
ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},
{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},
{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",
mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Ha){return Ha.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",
mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel",
"formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},
{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",
mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",
ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",
mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];P.modeInfo=Aa;P.modeInfo=Aa;P.modeInfo=Aa;for(var wa=0;wa<P.modeInfo.length;wa++)P.info=P.modeInfo[wa],P.info.mimes&&
(P.info.mime=P.info.mimes[0]);P.defineMode("null",function(){return{token:function(Ha){return Ha.skipToEnd()}}});P.defineMIME("text/plain","null");P.findModeByMIME=ab;P.findModeByMIME=ab;P.findModeByExtension=lb;P.findModeByExtension=lb;P.findModeByFileName=vb;P.findModeByFileName=vb;P.findModeByName=Bd;P.findModeByName=Bd;var Qa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Qa.Color=Ab;Qa.Rectangle=cc;Qa.pt=je;Qa.morph=fd;Qa.ShadowObject=Yd;Qa.StyleSheet=jd;Qa.connect=Pc;Qa.arr=
jc;Qa.string=vd;Qa.FilterableList=Ld;Qa.Range=ge;wa=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Hb=cb.hasOwnProperty("Completer")&&"function"===typeof cb.Completer?cb.Completer:cb.Completer=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],
cb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:345,end:391})}(void 0);Qa.Completer=wa;Qa.Completer=wa;Qa.Completer=wa;wa=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Hb=cb.hasOwnProperty("WordCompleter")&&"function"===typeof cb.WordCompleter?
cb.WordCompleter:cb.WordCompleter=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:"compute",value:function(ba,Ja){var nb=[],zb=[],Ic=ba.document.lineStrings;ba=ba.cursorPosition.row;for(var vc=ba-1;0<=vc;vc--)for(var Ad=$jscomp.makeIterator(Ic[vc].split(/[^0-9a-z@_]+/i)),wd=Ad.next();!wd.done;wd=Ad.next())(wd=wd.value)&&!nb.includes(wd)&&wd!==Ja&&(nb.push(wd),zb.push({priority:1E3-(ba-vc),completion:wd}));
for(vc=ba+1;vc<Ic.length;vc++)for(Ad=$jscomp.makeIterator(Ic[vc].split(/[^0-9a-z_@]+/i)),wd=Ad.next();!wd.done;wd=Ad.next())(wd=wd.value)&&!nb.includes(wd)&&wd!==Ja&&(nb.push(wd),zb.push({priority:1E3-(vc-ba),completion:wd}));return zb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],cb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:400,end:1228})}(void 0);Qa.WordCompleter=wa;Qa.WordCompleter=wa;Qa.WordCompleter=wa;wa=[new Qa.WordCompleter];Qa.defaultCompleters=wa;Qa.defaultCompleters=wa;Qa.defaultCompleters=wa;wa=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Hb=cb.hasOwnProperty("CompletionController")&&"function"===typeof cb.CompletionController?cb.CompletionController:cb.CompletionController=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,Ja){Ja=void 0===Ja?[]:Ja;this.textMorph=ba;this.completers=Ja=ba.pluginCollect("getCompleters",Ja)}},{key:"computeCompletions",value:function(ba){var Ja=this,nb,zb,Ic,vc,Ad,wd,yd,He,gf,ng,Jh,Mi,Th,Mj,Kh,el;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lf){switch(Lf.nextAddress){case 1:nb=[],zb=$jscomp.makeIterator(Ja.completers),Ic=zb.next();
case 2:if(Ic.done){Lf.jumpTo(4);break}vc=Ic.value;Lf.setCatchFinallyBlocks(5);Ad=nb;wd=Ad.concat;return Lf.yield(vc.compute(Ja.textMorph,ba),7);case 7:nb=wd.call(Ad,Lf.yieldResult);Lf.leaveTryBlock(3);break;case 5:yd=Lf.enterCatchBlock(),console.warn("Error in completer "+vc+": "+(yd.stack||yd));case 3:Ic=zb.next();Lf.jumpTo(2);break;case 4:He=new Map;nb.forEach(function(Wj){var qi=He.get(Wj.completion);qi||(qi=[],He.set(Wj.completion,qi));qi.push(Wj)});gf=[];ng=$jscomp.makeIterator(He.values());
for(Jh=ng.next();!Jh.done;Jh=ng.next())Mi=Jh.value,gf.push(Qa.arr.last(Qa.arr.sortByKey(Mi,"priority")));Th=0;Mj=Qa.arr.sortByKey(gf,"priority").reverse();Kh=Mj.length&&Mj[0].priority||0;el=Mj.map(function(Wj){Wj.highestPriority=Kh;var qi=Wj.completion.replace(/\n/g,""),Je=String((Wj.info||"").replace(/\n/g,""));Th=Math.max(Th,qi.length+Je.length);return{isListItem:!0,string:qi,annotation:Je,value:Wj}});return Lf.return({items:el,maxCol:Th})}})}},{key:"computeSortedCompletions",value:function(ba,
Ja){Ja=void 0===Ja?!1:Ja;var nb=this,zb,Ic,vc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ad){if(1==Ad.nextAddress)return zb={tokens:[ba],lowercasedTokens:[ba],input:ba},Ad.yield(nb.computeCompletions(ba),2);Ic=Ad.yieldResult;vc=Qa.arr.sortBy(Ic.items.filter(function(wd){return nb.filterFunction(zb,wd,Ja)}),function(wd){return nb.sortFunction(zb,wd)});return Ad.return(vc)})}},{key:"_printCompletions",value:function(ba){var Ja=this,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==
zb.nextAddress)return zb.yield(Ja.computeSortedCompletions(ba),2);nb=zb.yieldResult.map(function(Ic){return{completion:Ic.value.completion,priority:Ic.value.priority,maxP:Ic.value.highestPriority,sortVal:Ic._cache[ba].sortVal,lev:JSON.stringify(Ic._cache[ba].levenshtein)}});return zb.return(Qa.string.printTable(lively.lang.grid.tableFromObjects(nb)))})}},{key:"prefix",value:function(){var ba=this.textMorph,Ja=ba.selection;return(Ja.isEmpty()?ba.getLine(Ja.lead.row).slice(0,Ja.lead.column):Ja.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(ba,Ja,nb){nb=void 0===nb?!1:nb;Ja._cache||(Ja._cache={});var zb=ba.tokens,Ic=ba.lowercasedTokens,vc=ba.input;vc=Ja._cache[vc]||(Ja._cache[vc]={});if(vc.hasOwnProperty("filtered"))return vc.filtered;Ja=Ja.value.completion.replace(/\([^\)]*\)$/,"");var Ad=Ja.toLowerCase();if(nb&&zb[0]&&!Ja.startsWith(zb[0]))return vc.filtered=!1;if(Ic.every(function(yd){return Ad.includes(yd)}))return!0;var wd=vc.levenshtein||(vc.levenshtein={});ba=nb||3>=Qa.arr.sum(ba.lowercasedTokens.map(function(yd){return wd[yd]||
(wd[yd]=Qa.string.levenshtein(Ad,yd))}));return vc.filtered=ba}},{key:"sortFunction",value:function(ba,Ja){Ja._cache||(Ja._cache={});var nb=Ja._cache[ba.input]||(Ja._cache[ba.input]={});if(nb.hasOwnProperty("sortVal"))return nb.sortVal;nb=Ja._cache[ba.input]={};var zb=Ja.value;Ja=zb.highestPriority;var Ic=zb.completion;zb=zb.priority;Ic=Ic.replace(/\([^\)]*\)$/,"").toLowerCase();var vc=0;ba.lowercasedTokens.forEach(function(wd){Ic.startsWith(wd)?vc+=12:3<=wd.length&&Ic.includes(wd)&&(vc+=5)});Ja=
-((zb||(vc?Ja:0))/Math.pow(10,String(Ja).length-2))-vc;var Ad=nb.levenshtein||(nb.levenshtein={});ba=Qa.arr.sum(ba.lowercasedTokens.map(function(wd){return Ad[wd]||(Ad[wd]=Qa.string.levenshtein(Ic,wd))}));vc&&(ba/=2);return nb.sortVal=ba+Ja}},{key:"positionForMenu",value:function(){var ba=this.textMorph,Ja=ba.charBoundsFromTextPosition(ba.cursorPosition);return ba.getGlobalTransform().transformRectToRect(Ja).topLeft().addXY(-ba.scroll.x,-ba.scroll.y).addPt(Qa.pt(ba.borderWidth+3,ba.borderWidth+3))}},
{key:"completionListSpec",value:function(){var ba=this,Ja,nb,zb,Ic,vc,Ad,wd,yd,He,gf,ng,Jh,Mi,Th,Mj,Kh,el,Lf,Wj,qi;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Je){if(1==Je.nextAddress)return nb=Ja=ba.textMorph,zb=nb.fontSize,Ic=nb.fontFamily,vc=ba.positionForMenu(),Ad=ba.prefix(),Je.yield(ba.computeCompletions(Ad),2);wd=Je.yieldResult;yd=wd.items;He=wd.maxCol;gf=Ja.env.fontMetric.sizeFor(Ic,zb,"M");ng=gf.width*He;Jh=Ja.document.getLine(0).height;Mi=Math.max(120,ng<Ja.width?ng:Ja.width);
Th=Jh*yd.length+Jh+10;Mj=Math.max(70,Math.min(700,Th));Kh=vc.extent(Qa.pt(Mi,Mj));if(el=Ja.world())Lf=el.visibleBounds().insetBy(5),Kh.bottom()>Lf.bottom()&&(Wj=Kh.bottom()-Lf.bottom(),Wj>Kh.height-50&&(Wj=Kh.height-50),Kh.height-=Wj),Kh.right()>Lf.right()&&(qi=Kh.right()-Lf.right(),Kh.width=120>Kh.width-qi?120:Kh.width-qi),Lf.containsRect(Kh)||(Kh=Kh.withTopLeft(Lf.translateForInclusion(Kh).topLeft())),Kh=Kh.translatedBy(Lf.insetBy(0).topLeft().negated());return Je.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:zb,position:Kh.topLeft(),extent:Kh.extent(),items:yd,input:Ad,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:ba.filterFunction,sortFunction:ba.sortFunction})})}},{key:"removeMenuOnBlur",value:function(ba){var Ja=ba.menu;setTimeout(function(){Ja.withAllSubmorphsDetect(function(nb){return nb.isFocused()})?Ja.inputMorph.focus():Ja.remove()})}},{key:"openCompletionList",value:function(){var ba=this,Ja,nb,zb,Ic,vc,Ad,wd,yd,
He,gf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ng){if(1==ng.nextAddress)return Ja=ba.textMorph.selection.start,ng.yield(ba.completionListSpec(),2);nb=ng.yieldResult;ba.textMorph.pluginFind(function(Jh){return Jh.theme});zb=new Qa.FilterableList(nb);Ic=new Qa.Range({start:Ja,end:ba.textMorph.selection.start});vc=ba.textMorph.textInRange(Ic);Ad=zb.inputMorph;wd=zb.listMorph;yd=nb.input;He=zb.addMorph({name:"prefix mask",fill:Qa.Color.transparent,bounds:Ad.textBounds()},Ad);wd.master=
null;Ic.isEmpty()||(ba.textMorph.deleteText(Ic),Ad.input=vc,Ad.gotoDocumentEnd());Ad.fontColor=ba.textMorph.fontColor;Qa.connect(Ad,"textString",He,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Ad}});Qa.connect(zb,"accepted",ba,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:yd}});Qa.connect(zb,"accepted",zb,"remove");Qa.connect(zb,"canceled",zb,"remove");Qa.connect(zb,"remove",ba.textMorph,"focus");Qa.connect(zb.inputMorph,"onBlur",ba,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:zb}});gf=ba.textMorph.world();gf.addMorph(zb);wd.addStyleClass("hiddenScrollbar");Ad.height=wd.itemHeight;Ad.fixedHeight=!0;Ad.fontSize=wd.fontSize;Ad.focus();zb.get("padding").height=0;zb.relayout();zb.selectedIndex=0;yd.length?(Ad.gotoDocumentEnd(),
zb.moveBy(Qa.pt(-Ad.textBounds().width+2,0))):zb.moveBy(Qa.pt(2,0));return ng.return(zb)})}},{key:"autoInsertBestMatchingCompletion",value:function(ba,Ja,nb){Ja=void 0===Ja?!0:Ja;var zb=this,Ic,vc,Ad,wd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yd){if(1==yd.nextAddress)return Ic=$jscomp,vc=Ic.makeIterator,yd.yield(zb.computeSortedCompletions(ba,Ja),2);Ad=vc.call(Ic,yd.yieldResult);(wd=Ad.next().value)&&zb.insertCompletion(wd.value.completion,ba,nb);yd.jumpToEnd()})}},{key:"insertCompletion",
value:function(ba,Ja,nb){var zb=this.textMorph,Ic=zb.document,vc=zb.selection.isMultiSelection?zb.selection.selections:[zb.selection];zb.undoManager.group();vc.forEach(function(Ad){Ad.collapseToEnd();var wd=Ad.lead,yd=Ja?Ic.indexToPosition(Ic.positionToIndex(wd)-Ja.length):wd;"function"===typeof nb?nb(ba,Ja,zb,{start:yd,end:wd},Ad):zb.replace({start:yd,end:wd},ba)});zb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],cb,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1355,end:12497})}(void 0);Qa.CompletionController=wa;Qa.CompletionController=wa;Qa.CompletionController=wa;wa=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ha,cb,Hb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){return 1==Ja.nextAddress?
(ba=new Qa.CompletionController(Ha,Qa.defaultCompleters),Ja.yield(ba.openCompletionList(),2)):Ja.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ha,cb,Hb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){return 1==Ja.nextAddress?(ba=new Qa.CompletionController(Ha,Qa.defaultCompleters),Ja.yield(ba.autoInsertBestMatchingCompletion(ba.prefix()),2)):Ja.return(!0)})}}];Qa.completionCommands=wa;Qa.completionCommands=wa;Qa.completionCommands=
wa;var Nb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Nb.chain=Td;Nb.arr=jc;Nb.obj=md;Nb.string=vd;var Gc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ha){var cb=Ha.selection.start;0<cb.row&&(cb=Ha.getPositionAboveOrBelow(1,cb,!0,0,Ha.charBoundsFromTextPosition(cb).x),Ha.selection.addRange({start:cb,end:cb}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Ha){var cb=Ha.selection.start;
cb.row<Ha.documentEndPosition.row&&(cb=Ha.getPositionAboveOrBelow(-1,cb,!0,0,Ha.charBoundsFromTextPosition(cb).x),Ha.selection.addRange({start:cb,end:cb}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ha){var cb=Ha.selection.selections[Ha.selection.selections.length-1];if(cb.isEmpty())return!0;Ha.searchForAll(cb.text,{start:{column:0,row:0}}).forEach(function(Hb){return Ha.selection.addRange(Hb.range,!1)});Ha.selection.mergeSelections();Nb.arr.remove(Ha.selection.selections,
cb);Ha.selection.selections.push(cb);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ha){var cb=Ha.selection.selections.length-1,Hb=Ha.selection.selections[cb];if(Hb.isEmpty())return!0;var ba=Ha.search(Hb.text,{start:Hb.end,backwards:!1});ba&&(Hb=Ha.selection.selections.findIndex(function(Ja){return Ja.range.equals(ba.range)}),-1<Hb?Nb.arr.swap(Ha.selection.selections,Hb,cb):Ha.selection.addRange(ba.range));return!0}},{name:"[multi select] more like this backward",
multiSelectAction:"single",exec:function(Ha){var cb=Ha.selection.selections.length-1,Hb=Ha.selection.selections[cb];if(Hb.isEmpty())return!0;var ba=Hb.start,Ja=Ha.search(Hb.text,{start:{row:ba.row,column:ba.column-(Hb.text.length-1)},backwards:!0});Ja&&(Hb=Ha.selection.selections.findIndex(function(nb){return nb.range.equals(Ja.range)}),-1<Hb?Nb.arr.swap(Ha.selection.selections,Hb,cb):Ha.selection.addRange(Ja.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",
exec:function(Ha){var cb=Ha.selection.selections.length;1<cb&&Ha.selection.removeSelections(cb-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ha){Ha.selection.selections=lively.lang.arr.rotate(Ha.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(Ha){Ha.selection.selections=lively.lang.arr.rotate(Ha.selection.selections,1);return!0}},{name:"[multi select] align cursors",
multiSelectAction:"single",exec:function(Ha){var cb=Ha.selection.selections;if(1>=cb.length)return!0;var Hb=Nb.arr.groupBy(cb,function(Ja){return Ja.range.start.row});cb=Hb.keys().map(function(Ja){Ja=Hb[Ja];var nb=Nb.arr.max(Ja,function(zb){return zb.range.start.column});Nb.arr.without(Ja,nb).forEach(function(zb){return zb.range=nb.range});return nb});var ba=Nb.arr.max(cb,function(Ja){return Ja.range.start.column}).range.start.column;cb.forEach(function(Ja){var nb=Ja.range.start;Ja=nb.row;nb=nb.column;
Ha.insertText(" ".repeat(ba-nb),{row:Ja,column:nb})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ha){Ha.selection.disableMultiSelect();if(Ha.selection.isEmpty())var cb=Ha.lastSavedMark&&Ha.lastSavedMark.position||(void 0).lineRange().start,Hb=Ha.cursorPosition;else cb=Ha.selection,Hb=cb.lead,cb=cb.anchor;Ha.selection.collapse();var ba=cb.column,Ja=Hb.column;Nb.arr.range(cb.row,Hb.row).forEach(function(nb){return Ha.getLine(nb).length>Math.min(Ja,
ba)&&Ha.selection.addRange({end:{row:nb,column:Ja},start:{row:nb,column:ba}},!1)});Ha.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ha,cb,Hb){Hb=void 0===Hb?1:Hb;Ha.undoManager.group();Ha.selection.selections.forEach(function(ba,Ja){return ba.text=String(Ja+Hb)});Ha.undoManager.group();return!0}}];Nb.multiSelectCommands=Gc;Nb.multiSelectCommands=Gc;Nb.multiSelectCommands=Gc;var Uc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");
Uc.pToI=function(Ha,cb){return Ha.positionToIndex(cb)};Uc.iToP=function(Ha,cb){return Ha.indexToPosition(cb)};Uc.execCodeNavigator=function(Ha){return function(cb,Hb,ba){var Ja=cb.pluginInvokeFirst("getNavigator");if(!Ja)return!0;cb.saveMark();ba=ba||1;for(var nb=0;nb<ba;nb++)Ja[Ha](cb,Hb);return!0}};Uc.once=Za;var le=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Uc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",
exec:Uc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Uc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Uc.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Uc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",
bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ha,cb){function Hb(){var nb=Ha.$expandRegionState,zb=Uc.pToI(Ha,Ha.cursorPosition);if(nb&&(nb.range[0]===zb||nb.range[1]===zb))return nb;nb=Ha.selection.range;return Ha.$expandRegionState={range:[Uc.pToI(Ha,nb.start),Uc.pToI(Ha,nb.end)]}}cb=cb||{};var ba=Ha.pluginInvokeFirst("getNavigator");if(!ba)return!0;var Ja=cb.start;cb=cb.end;if("number"===typeof Ja&&"number"===typeof cb)Hb(),ba={range:[Ja,
cb],prev:Hb()};else{Ja=ba.ensureAST(Ha);if(!Ja)return;ba=ba.expandRegion(Ha,Ha.textString,Ja,Hb())}ba&&ba.range&&(Ha.selection={start:Uc.iToP(Ha,ba.range[0]),end:Uc.iToP(Ha,ba.range[1])},Ha.$expandRegionState=ba);Uc.once(Ha,"selectionChange",function(){return Ha.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ha){if(Ha.selection.isEmpty())return!0;
var cb=Ha.pluginInvokeFirst("getNavigator");if(!cb)return!0;var Hb=cb.ensureAST(Ha);if(!Hb)return!0;var ba=Ha.$expandRegionState;if(!ba)return!0;(cb=cb.contractRegion(Ha,Ha.textString,Hb,ba))&&cb.range&&(Ha.selection={start:Uc.iToP(Ha,cb.range[0]),end:Uc.iToP(Ha,cb.range[1])},Ha.$expandRegionState=cb);Uc.once(Ha,"selectionChange",function(){return Ha.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Uc.commands=le;Uc.commands=le;Uc.commands=le;var Od=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");
Od.arr=jc;Od.chain=Td;Od.string=vd;var kf=[{name:"toggle comment",exec:function(Ha){var cb=Ha.pluginInvokeFirst("getComment");if(!cb)return!0;if(!cb.lineCommentStart)return cb.blockCommentStart?Ha.execCommand("toggle block comment"):!0;var Hb=cb.lineCommentStart,ba=new RegExp("^(\\s*)("+Hb+"\\s?)(.*)");cb=Ha.document;var Ja=Ha.selection;Ja.isEmpty()||0!==Ja.end.column||Ja.growRight(-1);var nb=Ja.start.row;cb=cb.lineStrings.slice(Ja.start.row,Ja.end.row+1);cb=cb.some(function(vc){return!!vc.trim()})?
Od.arr.dropWhile(cb,function(vc){return vc.trim()?!1:++nb&&!0}):cb;var zb=cb.every(function(vc){return vc.trim()&&vc.match(ba)});Ha.undoManager.group();if(zb)cb.forEach(function(vc,Ad){if(vc=vc.match(ba)){vc=$jscomp.makeIterator(vc);vc.next();var wd=vc.next().value,yd=vc.next().value;vc.next();Ha.deleteText({start:{row:nb+Ad,column:wd.length},end:{row:nb+Ad,column:wd.length+yd.length}})}});else{var Ic=cb.reduce(function(vc,Ad,wd){return Ad.trim()||Ja.isEmpty()&&Ja.start.row===Ja.end.row?Math.min(vc,
Ad.match(/^\s*/)[0].length):vc},Infinity);Ic=Infinity===Ic?0:Ic;cb.forEach(function(vc,Ad){vc=$jscomp.makeIterator(vc.match(/^(\s*)(.*)/));vc.next();vc.next();vc.next();Ha.insertText(Hb+" ",{row:nb+Ad,column:Ic})})}Ha.undoManager.group();return!0}},{name:"toggle block comment",exec:function(Ha){var cb=Ha.pluginInvokeFirst("getComment");if(!cb)return!0;if(!cb.blockCommentStart)return cb.lineCommentStart?Ha.execCommand("toggle comment"):!0;if(!cb||!cb.blockCommentStart)return!0;var Hb=cb.blockCommentStart;
cb=cb.blockCommentEnd;var ba=new RegExp("^"+Hb.replace(/\*/g,"\\*")),Ja=new RegExp(cb.replace(/\*/g,"\\*")+"$"),nb=Ha.tokenAt(Ha.cursorPosition);if(nb&&"comment"===nb.token){var zb=Ha.textInRange(nb);if(zb.match(ba)&&zb.match(Ja))return Ha.undoManager.group(),Ha.replace(nb,zb.slice(Hb.length,-cb.length)),Ha.undoManager.group(),!0}Ha.undoManager.group();Ha.insertText(Hb,Ha.selection.start);Ha.insertText(cb,Ha.selection.end);Ha.undoManager.group();Hb=!Ha.selection.isEmpty();Ha.selection.growLeft(cb.length);
Hb||Ha.selection.collapse();return!0}},{name:"comment box",exec:function(Ha,cb,Hb){cb=Ha.undoManager.ensureNewGroup(Ha,"comment box");if(Ha.selection.isEmpty())return Ha.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ha.execCommand("toggle comment"),Ha.undoManager.group(cb),!0;var ba=Ha.selection.range,Ja=Ha.withSelectedLinesDo(function(zb){return zb}),nb=Od.arr.min([ba.start.column].concat(Od.chain(Ja).map(function(zb){return zb.match(/^\s*/)}).flatten().compact().pluck("length").value()));
Ja=Od.arr.max(Ja.map(function(zb){return zb.length}))-nb;Ja=Array(Math.ceil(Ja/2)+1).join("-=")+"-";Ha.execCommand("toggle comment");Ha.collapseSelection();Ha.cursorPosition={row:ba.start.row,column:0};Hb?Ha.insertText(Od.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",nb)):Ha.insertText(Od.string.indent(Ja+"\n"," ",nb));Ha.selection.goUp();Ha.execCommand("toggle comment");Ha.cursorPosition={row:ba.end.row+2,column:0};Ha.insertText(Od.string.indent(Ja+"\n"," ",nb));Ha.selection.goUp();
Ha.execCommand("toggle comment");Ha.selection.range={start:{row:ba.start.row,column:0},end:Ha.cursorPosition};Ha.undoManager.group(cb);return!0},multiSelectAction:"forEach",handlesCount:!0}];Od.commands=kf;Od.commands=kf;Od.commands=kf;var ae=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");ae.printSymbol=function(Ha){if(Symbol.keyFor(Ha))return'Symbol.for("'+Symbol.keyFor(Ha)+'")';if(ae.knownSymbols.get(Ha))return ae.knownSymbols.get(Ha);String(Ha).match(ae.symMatcher);return String(Ha)};
ae.defaultSort=function(Ha,cb){if(Ha.hasOwnProperty("priority")||cb.hasOwnProperty("priority")){var Hb=Ha.priority||0,ba=cb.priority||0;if(Hb<ba)return-1;if(Hb>ba)return 1}Ha=(Ha.keyString||Ha.key).toLowerCase();cb=(cb.keyString||cb.key).toLowerCase();return Ha<cb?-1:Ha===cb?0:1};ae.safeToString=de;ae.propertyNamesOf=function(Ha,cb){if(!Ha)return[];if(Array.isArray(Ha)){var Hb=cb?cb.offset:0;return ae.arr.range(Hb,Hb+(cb?cb.partitionSize:Ha.length-1))}return ae.arr.sortBy(Object.keys(Ha),function(ba){return ba.toLowerCase()})};
ae.isMultiValue=Ee;ae.printValue=Ze;ae.partitionedChildren=function(Ha,cb){var Hb=void 0===cb?{}:cb;cb=void 0===Hb.originalValue?Ha:Hb.originalValue;var ba=void 0===Hb.offset?0:Hb.offset;Hb=void 0===Hb.partitionSize?Ha.length||Object.values(Ha).length:Hb.partitionSize;if(ae.obj.isArray(Ha)){Ha=ae.num.roundTo(Math.max(ae.MIN_PARTITION_SIZE,Hb/50),.1);Hb/=Ha;for(var Ja=[],nb=0;nb<Hb;nb++){var zb="["+(ba+nb*Ha)+"-"+(ba+(nb+1)*Ha)+"]";Ja.push({partition:{originalValue:cb,offset:ba+nb*Ha,partitionSize:Ha},
value:[],key:zb,keyString:zb,valueString:"...",isCollapsed:!0})}return Ja}Ha=ae.num.roundTo(Math.max(ae.MIN_PARTITION_SIZE,Hb/50),.1);Hb/=Ha;Ja=[];nb=ae.obj.keys(cb).sort();for(zb=0;zb<Hb;zb++){var Ic=ba+zb*Ha,vc=ba+(zb+1)*Ha,Ad=ae.obj.select(cb,nb.slice(Ic,vc));Ic="["+nb[Ic].slice(0,4)+"-"+(nb[vc]||ae.arr.last(nb)).slice(0,4)+"]";Ja.push({partition:{originalValue:Ad,offset:ba+zb*Ha,partitionSize:Ha},value:[],key:Ic,keyString:Ic,valueString:"...",isCollapsed:!0})}return Ja};ae.propertiesOf=function(Ha){var cb=
Ha.partition?Ha.target:Ha.value;if(!cb)return[];var Hb={_rev:!0},ba=[],Ja="function"===typeof cb.livelyCustomInspect?cb.livelyCustomInspect():{},nb=Object.assign({},ae.defaultPropertyOptions,{},Ja);if(Ja.properties){Ja=$jscomp.makeIterator(Ja.properties);for(var zb=Ja.next();!zb.done;zb=Ja.next()){var Ic=zb.value;zb=Ic.key;var vc=Ic.hidden,Ad=Ic.priority,wd=Ic.keyString,yd=Ic.value;Ic=Ic.valueString;Hb[zb]=!0;vc||ba.push(Ha.getSubNode({priority:Ad,key:zb,keyString:wd||ae.safeToString(zb),value:yd,
valueString:Ic,isCollapsed:!0}))}}if(nb.includeDefault){Ja=ae.propertyNamesOf(cb,Ha.partition);if(Ja.length>ae.MAX_NODE_THRESHOLD)for(Hb=$jscomp.makeIterator(ae.partitionedChildren(cb,Ha.partition)),Ja=Hb.next();!Ja.done;Ja=Hb.next())ba.push(Ha.getSubNode(Ja.value));else for(vc=$jscomp.makeIterator(Ja),Ja=vc.next();!Ja.done;Ja=vc.next())Ad=Ja.value,Ad in Hb||(Ja=cb[Ad],zb=ae.printValue(Ja),Ja={keyString:Ad,key:Ad,value:Ja,valueString:zb,isCollapsed:!0},ba.push(Ha.getSubNode(Ja)));if(nb.includeSymbols)for(Hb=
$jscomp.makeIterator(Object.getOwnPropertySymbols(cb)),Ja=Hb.next();!Ja.done;Ja=Hb.next())vc=Ja.value,Ad=ae.safeToString(vc),Ja=cb[vc],zb=ae.printValue(Ja),Ja={key:vc,keyString:Ad,value:Ja,valueString:zb,isCollapsed:!0},ba.push(Ha.getSubNode(Ja))}nb.sort&&(ba=nb.sortFunction(cb,ba));return ba};ae.obj=md;ae.num=Db;ae.arr=jc;ae.string=vd;ae.connect=Pc;ae.signal=ac;ae.TreeData=ic;ae.newUUID=gd;ae.localInterface=Ia;ae.MAX_NODE_THRESHOLD=1E3;ae.MIN_PARTITION_SIZE=250;ae.defaultPropertyOptions={includeDefault:!0,
includeSymbols:!0,sort:!0,sortFunction:function(Ha,cb){return Array.isArray(Ha)?cb:cb.sort(ae.defaultSort)}};ae.symMatcher=/^Symbol\((.*)\)$/;ae.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ha){return"symbol"===typeof Symbol[Ha]}).reduce(function(Ha,cb){return Ha.set(Symbol[cb],"Symbol."+cb)},new Map)}();ae.isMultiValue=Ee;ae.isMultiValue=Ee;ae.printValue=Ze;ae.printValue=Ze;var Ke=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Hb=cb.hasOwnProperty("InspectionTree")&&"function"===typeof cb.InspectionTree?cb.InspectionTree:cb.InspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Rb._get(Object.getPrototypeOf(Hb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.inspector=ba.inspector;this.root.isInspectionNode||(this.root=ae.InspectionNode.for(this.root,
this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(ba){ba=void 0===ba?!0:ba;return Rb._get(Object.getPrototypeOf(Hb.prototype),"asListWithIndexAndDepth",this).call(this,function(Ja){Ja=Ja.node;return ba?Ja.visible:!0})}},{key:"getContextFor",value:function(ba){return ba==this.root?this.root.value.inspectee:ba.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(ba){var Ja=void 0===ba.maxDepth?1:ba.maxDepth,nb=ba.iterator,
zb=ba.showUnknown,Ic=ba.showInternal,vc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ad){if(1==Ad.nextAddress)return Ad.yield(vc.uncollapseAll(function(wd,yd){return Ja>yd&&(wd==vc.root||wd.value.submorphs)}),2);vc.asListWithIndexAndDepth(!1).forEach(function(wd){var yd=wd.node;return 0==wd.depth?yd.visible=!0:!zb&&yd.keyString&&yd.keyString.includes("UNKNOWN PROPERTY")||!Ic&&yd.keyString&&yd.keyString.includes("internal")?yd.visible=!1:yd.value&&yd.value.submorphs?yd.visible=
!0:yd.visible=nb(yd)});Ad.jumpToEnd()})}},{key:"getChildren",value:function(ba){return ba.children}},{key:"display",value:function(ba){return ba.display(this.inspector)}},{key:"isCollapsed",value:function(ba){return ba.isCollapsed}},{key:"isLeaf",value:function(ba){return ae.obj.isPrimitive(ba.value)}},{key:"collapse",value:function(ba,Ja){var nb=this;ba.isCollapsed=Ja;Ja||this.isLeaf(ba)||ba.children.length||(ba.children=ae.propertiesOf(ba).map(function(zb){nb.parentMap.set(zb,ba);return zb}))}},
{key:"retrieveForRemoteProxy",value:function(ba){ba.uuid||(ba.uuid=ae.newUUID(),this.idToNodeMap[ba.uuid]=ba);return{uuid:ba.uuid,value:this.isLeaf(ba)?ba.value:{},keyString:ba.keyString,key:ba.keyString,valueString:ae.safeToString(ba.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return ae.localInterface}},{key:"getNodeViaId",value:function(ba){return this.idToNodeMap[ba]}},{key:"asRemoteDelegate",value:function(ba){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||
(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[ba]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionTree"}},{key:"forObject",value:function(ba,Ja){return new this({key:"inspectee",value:{inspectee:ba},isCollapsed:!0,inspector:Ja})}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5932,end:8631})}(ae.TreeData);ae.InspectionTree=Ke;ae.InspectionTree=Ke;ae.InspectionTree=Ke;var $e=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Hb=cb.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof cb.RemoteInspectionTree?cb.RemoteInspectionTree:cb.RemoteInspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(ba){this.parentMap=new WeakMap;this.root=ba.proxy;this.evalEnvironment=ba.evalEnvironment;this.inspector=ba.inspector;this.delegateId=ba.delegateId}},{key:"getContextFor",value:function(ba){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+
ba.uuid+'").value'}},{key:"dispose",value:function(){var ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){return Ja.yield(ba.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+ba.delegateId+"']\n    ",ba.evalEnvironment),0)})}},{key:"display",value:function(ba){return ba.keyString+": "+ba.valueString}},{key:"collapse",value:function(ba,Ja){var nb=this,zb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ic){if(1==
Ic.nextAddress)return(ba.isCollapsed=Ja)||nb.isLeaf(ba)?Ic.return():ba.children.length?Ic.jumpTo(0):Ic.yield(nb.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+ba.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+nb.delegateId+
'"]'}),3);zb=Ic.yieldResult;ba.children=zb.isError?[]:zb.value;Ic.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(ba,Ja){var nb=this,zb,Ic,vc,Ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wd){if(1==wd.nextAddress)return wd.yield(nb.createRemoteContext(ba,Ja),2);zb=wd.yieldResult;Ic=zb.proxy;vc=zb.delegateId;Ad=zb.evalEnvironment;return wd.return(new nb({key:"inspectee",proxy:Ic,delegateId:vc,evalEnvironment:Ad,
inspector:Ja}))})}},{key:"createRemoteContext",value:function(ba,Ja){var nb=ba.code,zb=ba.evalEnvironment,Ic=ba.delegateId,vc,Ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wd){if(1==wd.nextAddress)return Ic="lively://inspector-"+Ja.id,wd.yield(zb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+nb+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+
Ic+'");\n    ',zb),2);vc=wd.yieldResult;Ad=vc.value;return wd.return({delegateId:Ic,evalEnvironment:zb,proxy:Ad})})}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8640,end:10983})}(ae.InspectionTree);ae.RemoteInspectionTree=$e;ae.RemoteInspectionTree=$e;ae.RemoteInspectionTree=
$e;(function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Hb=cb.hasOwnProperty("InspectionNode")&&"function"===typeof cb.InspectionNode?cb.InspectionNode:cb.InspectionNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){var Ja=ba.root,nb=ba.priority,zb=ba.key,Ic=ba.keyString,vc=ba.value,Ad=ba.valueString,
wd=ba.isCollapsed,yd=void 0===ba.children?[]:ba.children,He=void 0===ba.isSelected?!1:ba.isSelected,gf=void 0===ba.visible?!0:ba.visible;this.partition=ba.partition;this.priority=nb;this.key=zb;this.keyString=String(Ic||zb);this.value=vc;this.valueString=Ad||ae.printValue(vc);this.isCollapsed=wd;this.children=yd;this.isSelected=He;this.visible=gf;this.root=Ja}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",get:function(){return!0}},{key:"getSubNode",value:function(ba){if(ba.value&&
ba.value.isMorph)return new ae.MorphNode(Object.assign({root:this.root},ba));var Ja=ba.key,nb=ba.keyString,zb=this.value,Ic=ba.partition;Ic&&(zb=Ic.originalValue,nb=Ja);return new ae.PropertyNode(Object.assign({},ba,{keyString:nb,key:Ja,target:zb,partition:Ic,root:this.root,spec:{}}))}},{key:"display",value:function(ba){var Ja=this.keyString,nb=this.valueString;if(!this.interactive)return Ja+": "+nb;this._propertyWidget||(this._propertyWidget=ba.renderDraggableTreeLabel({value:Ja+": "+nb}));this._propertyWidget.isSelected=
this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(ba,Ja){Ja=void 0===Ja?null:Ja;return ba.value&&ba.value.isMorph?new ae.MorphNode(Object.assign({root:Ja},ba)):new ae.InspectionNode(Object.assign({root:Ja},ba))}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10985,end:13522})})(void 0);(function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Hb=cb.hasOwnProperty("MorphNode")&&"function"===typeof cb.MorphNode?cb.MorphNode:cb.MorphNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Rb._get(Object.getPrototypeOf(Hb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this,ba);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(ba){var Ja=this.propertyInfo[ba.key]||{};return ba.value&&ba.value.isMorph?new ae.MorphNode(Object.assign({},ba,{root:this.root})):new ae.PropertyNode(Object.assign({},ba,{root:this.root,target:this.target,spec:Ja}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13524,end:14670})})(ae.InspectionNode);(function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Hb=cb.hasOwnProperty("PropertyNode")&&"function"===typeof cb.PropertyNode?cb.PropertyNode:cb.PropertyNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Rb._get(Object.getPrototypeOf(Hb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);var Ja=ba.spec,nb=ba.target;this.partition=ba.partition;this.target=nb;this.spec=Ja;this.foldedNodes={}}},{key:"__deserialize__",value:function(ba,Ja){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",
set:function(ba){this._interactive=ba}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(ba){return this.isFoldable?this.getFoldedContext(ba):Rb._get(Object.getPrototypeOf(Hb.prototype),"getSubNode",this).call(this,ba)}},{key:"getFoldedContext",value:function(ba){return this.foldedNodes[ba.key]=new ae.FoldedNode(Object.assign({},ba,{root:this.root,
target:this.target,foldableNode:this,spec:ae.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(ba,Ja){(Ja=void 0===Ja?!1:Ja)&&(this.target[this.key]=ba);this.value=this.target[this.key];this.valueString=ae.printValue(this.value);this.interactive&&(Ja||this._propertyWidget.highlight());if(this.isFoldable)for(var nb in this.foldedNodes)this.foldedNodes[nb].value=this.value[nb],this.foldedNodes[nb].valueString=
ae.printValue(this.value[nb]),this.foldedNodes[nb]._propertyWidget&&ae.signal(this.foldedNodes[nb]._propertyWidget,"update",this.value[nb])}},{key:"display",value:function(ba){var Ja=this,nb=this._propertyWidget,zb=this.keyString,Ic=this.valueString,vc=this.target,Ad=this.value,wd=this.spec;if(!(this.interactive||wd.foldable&&ae.isMultiValue(Ad,wd.foldable)))return ba.renderPropertyControl({target:vc,keyString:zb,valueString:Ic,tree:ba.ui.propertyTree,value:Ad,spec:wd,node:this,fastRender:!0});if(nb)return nb.keyString=
zb,nb.valueString=Ic,nb.isSelected=this.isSelected,nb.control&&(nb.control.isSelected=this.isSelected),nb;nb=this._propertyWidget=ba.renderPropertyControl({target:vc,keyString:zb,valueString:Ic,value:Ad,spec:wd,node:this,isSelected:this.isSelected,fontColor:ba.ui.propertyTree.fontColor});this.isInternalProperty||wd.readOnly||(ae.connect(nb,"propertyValue",this,"refreshProperty",{updater:function(yd,He){return yd(He,!0)}}),ae.connect(nb,"openWidget",this.root,"onWidgetOpened",{converter:function(yd){return{widget:yd,
node:Ja.sourceObj}}}));return nb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14672,end:18071})})(ae.InspectionNode);(function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Hb=cb.hasOwnProperty("FoldedNode")&&"function"===typeof cb.FoldedNode?cb.FoldedNode:cb.FoldedNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Rb._get(Object.getPrototypeOf(Hb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.foldableNode=ba=ba.foldableNode;this.foldedProp=ba.key+ae.string.capitalize(this.key)}},
{key:"refreshProperty",value:function(ba,Ja){Ja=void 0===Ja?!1:Ja;var nb={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(nb[this.key]=ba,nb)),Ja)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:18073,end:18749})})(ae.PropertyNode);var Cf=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Cf.Color=Ab;var rg=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Hb=cb.hasOwnProperty("DarkTheme")&&"function"===typeof cb.DarkTheme?cb.DarkTheme:cb.DarkTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:"background",get:function(){return Cf.Color.rgb(44,
62,80)}},{key:"cursorColor",get:function(){return Cf.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",
get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Cf.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Cf.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Cf.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},
{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},
{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Cf.Color.white,fontWeight:"bold",backgroundColor:Cf.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Cf.Color.rgba(204,
204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Cf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],cb,{pathInPackage:function(){return"themes/dark.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3048})}(void 0),Qf=rg=Cf.DarkTheme;Cf.default=rg;var Tc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Tc.inspect=Zc;Tc.remoteInspect=ye;Tc.generateReferenceExpression=Hd;Tc.onNumberDragStart=function(Ha,cb){cb.initPos=Ha.position;cb.factorLabel=(new Tc.Tooltip({description:"1x"})).openInWorld(Ha.hand.position.addXY(10,
10))};Tc.onNumberDrag=function(Ha,cb){var Hb=Tc.getScaleAndOffset(Ha,cb),ba=Hb.scale;Hb=Hb.offset;cb.factorLabel.position=Ha.hand.position.addXY(10,10);cb.factorLabel.description=ba+"x";return Tc.getCurrentValue(Hb,ba,cb)};Tc.onNumberDragEnd=function(Ha,cb){var Hb=Tc.getScaleAndOffset(Ha,cb);Ha=Hb.offset;Hb=Hb.scale;cb.factorLabel.softRemove();return Tc.getCurrentValue(Ha,Hb,cb)};Tc.getScaleAndOffset=function(Ha,cb){var Hb=Ha.position.subPt(cb.initPos);Ha=Hb.x;cb=Tc.num.roundTo(Math.exp(-Hb.y/$world.height*
6),.01)*cb.baseFactor;return{offset:Ha,scale:cb}};Tc.getCurrentValue=function(Ha,cb,Hb){return Math.max(Hb.min,Math.min(Hb.max,Hb.scrubbedValue+(Hb.floatingPoint?Ha*cb:Math.round(Ha*cb))))};Tc.Color=Ab;Tc.Rectangle=cc;Tc.rect=fe;Tc.pt=je;Tc.obj=md;Tc.num=Db;Tc.Path=Yb;Tc.arr=jc;Tc.promise=qc;Tc.connect=Pc;Tc.disconnect=Ob;Tc.once=Za;Tc.Morph=Hc;Tc.Tooltip=Yc;Tc.VerticalLayout=cd;Tc.GridLayout=$b;Tc.HorizontalLayout=pb;Tc.morph=fd;Tc.CustomLayout=xc;Tc.Label=Lc;Tc.Icon=Ga;Tc.StyleSheet=jd;Tc.config=
Ra;Tc.Tree=rb;Tc.LoadingIndicator=Kb;Tc.DropDownList=Ib;Tc.DropDownSelector=gb;Tc.SearchField=ib;Tc.LabeledCheckBox=Lb;Tc.MorphHighlighter=sc;Tc.InteractiveMorphSelector=Vc;Tc.printValue=Ze;Tc.RemoteInspectionTree=$e;Tc.InspectionTree=Ke;Tc.isMultiValue=Ee;Tc.valueWidgets=Q;Tc.popovers=fa;Tc.DarkTheme=Qf;Tc.DefaultTheme=Mb;Tc.syncEval=tc;Tc.inspectorCommands=[{name:"focus codeEditor",exec:function(Ha){Ha.get("codeEditor").show();Ha.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ha){Ha.get("propertyTree").show();
Ha.get("propertyTree").focus();return!0}}];(function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Hb=cb.hasOwnProperty("DraggedProp")&&"function"===typeof cb.DraggedProp?cb.DraggedProp:cb.DraggedProp=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:"applyToTarget",value:function(ba){var Ja=this.currentTarget,nb=this.control;this.remove();Tc.MorphHighlighter.removeHighlighters(ba.world);
if(Ja)if(Ja.isText&&"js"===Ja.editorModeName){var zb=Ja.evalEnvironment.context;ba=Ja.textPositionFromPoint(Ja.localize(ba.position));zb=Tc.generateReferenceExpression(this.sourceObject,{fromMorph:zb});nb.keyString&&(zb+="."+nb.keyString);Ja.insertTextAndSelect(zb,ba);Ja.focus()}else"propertyValue"in nb&&(Ja[nb.keyString]=nb.propertyValue)}},{key:"update",value:function(ba){ba=ba.hand.globalPosition;var Ja=this.morphBeneath(ba),nb;if(Ja){for(Ja==this.morphHighlighter&&(Ja=Ja.morphBeneath(ba));nb=
[Ja].concat($jscomp.arrayFromIterable(Ja.ownerChain())).find(function(zb){return!zb.visible});)Ja=nb=nb.morphBeneath(ba);if(Ja!=this.currentTarget){this.currentTarget=Ja;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Ja.isWorld)return;this.morphHighlighter=Tc.MorphHighlighter.for($world,Ja);this.morphHighlighter.show()}this.position=ba}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Tc.Color.rgb(169,
204,227)},fill:{defaultValue:Tc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var ba=this.control;if(!ba)return this.submorphs=[];this.height=22;this.submorphs=[ba];ba.top=0;ba.fontSize=14;"function"===typeof ba.relayout&&ba.relayout();this.width=ba.width+20;this.adjustOrigin(Tc.pt(10,10))}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1268,end:3690})})(Tc.Morph);(function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Hb=cb.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof cb.DraggableTreeLabel?cb.DraggableTreeLabel:cb.DraggableTreeLabel=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Rb(Hb,Ha,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(ba){this.draggedProp=new Tc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Tc.connect(ba.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(ba){}},{key:"onDragEnd",value:function(ba){Tc.disconnect(ba.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(ba)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Tc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:Tc.Color.transparent},padding:{defaultValue:Tc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(ba){this.setProperty("isSelected",ba);ba?(this.removeStyleClass("deselected"),
this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=ba)}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3692,end:5015})})(Tc.Label);Ke=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),
Hb=cb.hasOwnProperty("PropertyControl")&&"function"===typeof cb.PropertyControl?cb.PropertyControl:cb.PropertyControl=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(ba,Ja,nb){ba.control=new Tc.DropDownSelector({opacity:.8,fill:Tc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],
selectedValue:Ja,padding:0,values:nb});Tc.connect(ba.control,"update",ba,"propertyValue",{updater:function(zb,Ic){this.targetObj.propertyValue!=Ic&&zb(Ic)}});Tc.connect(ba,"update",ba.control,"selectedValue",{updater:function(zb,Ic){Ic=Ic&&Ic.valueOf?Ic.valueOf():Ic;this.targetObj.propertyValue!=Ic&&zb(Ic)}});return ba}},{key:"toggleMultiValuePlaceholder",value:function(ba){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:Tc.Color.transparent,layout:new Tc.HorizontalLayout({spacing:3}),
name:"multi value placeholder",nativeCursor:"pointer",submorphs:Tc.arr.range(0,2).map(function(Ja){return{type:"ellipse",fill:Tc.Color.gray.withA(.5),reactsToPointer:!1,extent:Tc.pt(7,7)}})});ba?(Tc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(Tc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=
1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(ba){this.foldableProperties&&this.toggleMultiValuePlaceholder(Tc.isMultiValue(ba,this.foldableProperties))}},{key:"asFoldable",value:function(ba){this.foldableProperties=ba;Tc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=
18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var ba=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});ba.isLayoutable=!1;ba.fontWeight="bold";ba.fontColor=Tc.Color.orange;ba.reactsToPointer=!1;ba.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(ba){this.submorphs=[ba]}},layout:{initialize:function(){this.layout=new Tc.CustomLayout({relayout:function(ba){ba.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(ba){return(ba=ba.value)&&
(ba.isColor||ba.isGradient)?"Color":ba&&ba.isPoint?"Point":Tc.obj.isBoolean(ba)?"Boolean":Tc.obj.isNumber(ba)?"Number":Tc.obj.isString(ba)?"String":ba&&ba.isRectangle?"Rectangle":!1}},{key:"render",value:function(ba){ba.spec.type||(ba.spec=Object.assign({},ba.spec,{type:this.inferType(ba)}));switch(ba.spec.type){case "Color":var Ja=this.renderColorControl(ba);break;case "ColorGradient":Ja=this.renderColorControl(Object.assign({},ba,{gradientEnabled:!0}));break;case "Number":Ja=this.renderNumberControl(ba);
break;case "String":Ja=this.renderStringControl(ba);break;case "RichText":Ja=this.renderStringControl(ba);break;case "Layout":Ja=this.renderLayoutControl(ba);break;case "Enum":Ja=this.renderEnumControl(ba);break;case "Shadow":Ja=this.renderShadowControl(ba);break;case "Point":Ja=this.renderPointControl(ba);break;case "Rectangle":Ja=this.renderRectangleControl(ba);break;case "Boolean":Ja=this.renderBooleanControl(ba);break;default:Ja=this.renderItSomehow(ba)}Ja.control&&(Tc.connect(Ja.control,"openWidget",
Ja,"openWidget"),Ja.toggleFoldableValue(ba.value));return Ja}},{key:"baseControl",value:function(ba){var Ja=ba.spec;ba=new this({keyString:ba.keyString,valueString:ba.valueString,isSelected:!1,propertyValue:ba.value});Ja.foldable&&ba.asFoldable(Ja.foldable);return ba}},{key:"renderGrabbableKey",value:function(ba){var Ja=this,nb=ba.target;return[ba.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(zb){zb.state.draggedProp=new Tc.DraggedProp({sourceObject:nb,control:Ja.baseControl(ba)});
zb.state.draggedProp.openInWorld();Tc.connect(zb.hand,"update",zb.state.draggedProp,"update")},onDrag:function(zb){},onDragEnd:function(zb){Tc.disconnect(zb.hand,"update",zb.state.draggedProp,"update");zb.state.draggedProp.applyToTarget(zb)}}]}},{key:"renderEnumControl",value:function(ba){var Ja=ba.value,nb=ba.spec.values,zb=ba.keyString,Ic=ba.target,vc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(Ja?Ja.valueOf?Ja.valueOf():Ja:"Not set"),{nativeCursor:"pointer",
onMouseDown:function(Ad,wd){return $jscomp.asyncExecutePromiseGeneratorProgram(function(yd){Ic.world().openWorldMenu(Ad,nb.map(function(He){return{string:He.toString(),action:function(){Ic[zb]=He;vc.rerender()}}}));yd.jumpToEnd()})}}],$jscomp.arrayFromIterable(Tc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7})))}},{key:"renderStringControl",value:function(ba){var Ja=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(200<Ja.length?
Ja.slice(0,20)+"...":Ja),{fontColor:Tc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(ba){var Ja=ba.value,nb=ba.keyString,zb=ba.valueString,Ic=ba.target,vc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+zb,{fontColor:Tc.Color.black,nativeCursor:"pointer",onMouseDown:function(Ad){var wd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yd){if(1==yd.nextAddress)return wd=new Tc.popovers.RectanglePopover({hasFixedPosition:!0,
rectangle:Ja}),wd.relayout(),yd.yield(wd.fadeIntoWorld(Ad.positionIn(Ic.world())),2);Tc.connect(wd,"rectangle",function(He){Ic[nb]=He;vc.rerender()});yd.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(ba){var Ja=ba.value,nb=ba.keyString,zb=ba.valueString,Ic=ba.target,vc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+zb,{nativeCursor:"pointer",fontColor:Ja?Tc.Color.green:Tc.Color.red,onMouseDown:function(Ad){Ic[nb]=!Ic[nb];vc.rerender()}}])}},{key:"renderNumberControl",
value:function(ba){var Ja=ba.value,nb=ba.spec,zb=ba.keyString,Ic=ba.valueString,vc=ba.node,Ad=ba.target,wd=ba.tree,yd=void 0===vc._numberControls?new Rf:vc._numberControls,He=$jscomp.makeIterator(yd.submorphs),gf=He.next().value,ng=He.next().value;yd.fontColor=wd.fontColor;var Jh=vc._numberControls=yd;"max"in nb&&"min"in nb&&-Infinity!=nb.min&&Infinity!=nb.max?(Jh.baseFactor=(nb.max-nb.min)/100,Jh.floatingPoint=nb.isFloat,Jh.max=nb.max,Jh.min=nb.min):(Jh.floatingPoint=nb.isFloat,Jh.baseFactor=.5,
Jh.min=void 0!=nb.min?nb.min:-Infinity,Jh.max=void 0!=nb.max?nb.max:Infinity);var Mi=Tc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),$jscomp.arrayFromIterable(vc._inputMorph?[vc._inputMorph,{}]:[" "+(void 0!=Ja&&(Ja.valueOf?Ja.valueOf():Ja).toFixed(nb.isFloat?3:0))+" ",{fontColor:Mi,onMouseUp:function(Th){vc._inputMorph=Tc.morph({type:"input",fill:null,fontColor:Mi,fontFamily:"IBM Plex Mono",fontSize:14,padding:Tc.rect(8,
2,-6,2),height:23,cursorColor:Tc.Color.white,value:Ja.valueOf?Ja.valueOf():Ic});Ad[zb]=Ja;vc._inputMorph.focus();Tc.once(vc._inputMorph,"inputAccepted",function(Mj){delete vc._inputMorph;Ad[zb]=nb.isFloat?Number.parseFloat(Mj):Number.parseInt(Mj);vc.rerender()});Tc.once(vc._inputMorph,"onBlur",function(Mj){vc._inputMorph&&(delete vc._inputMorph,Ad[zb]=Ja,vc.rerender())});vc.rerender()},onDragStart:function(Th){Jh.scrubbedValue=Ja;Tc.onNumberDragStart(Th,Jh)},onDrag:function(Th){Ad[zb]=Tc.onNumberDrag(Th,
Jh);vc.rerender()},onDragEnd:function(Th){return Tc.onNumberDragEnd(Th,Jh)}},yd,{onMouseUp:function(){gf.fill=ng.fill=null},onMouseDown:function(Th){if(Th.targetMorph===gf){gf.fill=Tc.Color.white.withA(.2);if("max"in nb&&Ad[zb]>=nb.max)return;Ad[zb]+=1}if(Th.targetMorph===ng){ng.fill=Tc.Color.white.withA(.2);if("min"in nb&&Ad[zb]<=nb.min)return;--Ad[zb]}vc.rerender()}}]))}},{key:"renderShadowControl",value:function(ba){var Ja=ba.keyString,nb=ba.value,zb=ba.target,Ic=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),
[""+(nb?nb.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(vc){var Ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wd){if(1==wd.nextAddress)return Ad=new Tc.popovers.ShadowPopover({shadowValue:zb[Ja],hasFixedPosition:!0}),wd.yield(Ad.fadeIntoWorld(vc.positionIn(zb.world())),2);Tc.connect(Ad,"shadowValue",function(yd){zb[Ja]=yd;Ic.rerender()});wd.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(ba){var Ja=ba.keyString,nb=ba.value,zb=ba.target,Ic=ba.node,
vc=Tc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Ad={nativeCursor:"pointer",onMouseDown:function(wd){var yd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(He){if(1==He.nextAddress)return yd=new Tc.popovers.PointPopover({pointValue:zb[Ja],hasFixedPosition:!0}),He.yield(yd.fadeIntoWorld(wd.positionIn(zb.world())),2);Tc.connect(yd,"pointValue",function(gf){zb[Ja]=gf;Ic.rerender()});He.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),
[" pt(",Object.assign({},Ad),""+nb.x.toFixed(),Object.assign({fontColor:vc},Ad),",",Object.assign({},Ad),""+nb.y.toFixed(),Object.assign({fontColor:vc},Ad),")",Object.assign({},Ad)])}},{key:"renderLayoutControl",value:function(ba){var Ja=ba.valueString,nb=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(nb?Ja:"No Layout"),{onMouseDown:function(zb){}}])}},{key:"renderColorControl",value:function(ba){var Ja=ba.node,nb=ba.gradientEnabled,zb=ba.valueString,Ic=ba.keyString,
vc=ba.value,Ad=ba.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[Tc.morph({fill:vc.valueOf?vc.valueOf():vc,extent:Tc.pt(15,15),borderColor:Tc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(vc?vc.valueOf?vc.valueOf():zb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(wd){var yd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(He){if(1==He.nextAddress)return yd=new Tc.popovers.FillPopover({hasFixedPosition:!0,
handleMorph:Ad,fillValue:vc,title:"Fill Control",gradientEnabled:nb}),He.yield(yd.fadeIntoWorld(wd.positionIn(Ad.world())),2);Tc.connect(yd,"fillValue",function(gf){Ad[Ic]=gf;Ja.rerender()});He.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(ba){var Ja=ba.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+Ja,{}])}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5024,end:20444})}(Tc.DraggableTreeLabel);Tc.PropertyControl=Ke;Tc.PropertyControl=Ke;Tc.PropertyControl=Ke;Tc.inspect=Zc;Tc.inspect=Zc;Tc.remoteInspect=ye;Tc.remoteInspect=ye;Tc.generateReferenceExpression=Hd;Tc.generateReferenceExpression=Hd;var Rf=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Hb=cb.hasOwnProperty("NumberControls")&&"function"===typeof cb.NumberControls?cb.NumberControls:cb.NumberControls=
function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Tc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Tc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(ba){this.submorphs.map(function(Ja){return Ja.fontColor=
ba})}},submorphs:{initialize:function(){this.submorphs=[Tc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Tc.rect(5,2,0,-6),fontSize:12}),Tc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Tc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23095,end:24127})}(Tc.Morph);(function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Hb=cb.hasOwnProperty("PropertyTree")&&"function"===typeof cb.PropertyTree?cb.PropertyTree:cb.PropertyTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:"onDrag",value:function(ba){this._onDragHandler&&this._onDragHandler(ba)}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25279,end:25389})})(Tc.Tree);Ke=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Hb=cb.hasOwnProperty("Inspector")&&"function"===
typeof cb.Inspector?cb.Inspector:cb.Inspector=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(ba){}},{key:"__after_deserialize__",value:function(ba,Ja,nb){var zb=this,Ic=new Tc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,
{treeData:Tc.InspectionTree.forObject(null,this)}));this.addMorph(Ic,this.getSubmorphNamed("terminal toggler"));this.layout.col(0).row(1).group.morph=Ic;this.whenRendered().then(function(){zb.targetObject&&(zb.targetObject=zb.targetObject)});Rb._get(Object.getPrototypeOf(Hb.prototype),"__after_deserialize__",this).call(this,ba,Ja,nb)}},{key:"__additionally_serialize__",value:function(ba,Ja,nb,zb){ba=ba.props.submorphs.value;for(Ja=ba.length;Ja--;)nb.refForId(ba[Ja].id).realObj==this.ui.propertyTree&&
Tc.arr.removeAt(ba,Ja)}},{key:"renderDraggableTreeLabel",value:function(ba){return new Tc.DraggableTreeLabel(ba)}},{key:"renderPropertyControl",value:function(ba){return Tc.PropertyControl.render(ba)}},{key:"onLoad",value:function(){var ba=this.ui,Ja=ba.codeEditor,nb=ba.thisBindingSelector,zb=ba.propertyTree;Ja.changeEditorMode("js").then(function(){return Ja.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==nb.selection?Ja.owner.selectedContext:Ja.owner.targetObject},
get systemInterface(){return Tc.Path("treeData.systemInterface").get(zb)},format:"esm"}}).catch(function(Ic){return $world.logError(Ic)})}},{key:Symbol.for("lively-instance-initialize"),value:function(ba){Rb._get(Object.getPrototypeOf(Hb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);ba=this.ui;var Ja=ba.targetPicker,nb=ba.propertyTree,zb=ba.resizer,Ic=ba.terminalToggler,vc=ba.unknowns,Ad=ba.internals,wd=ba.searchField,yd=ba.codeEditor,He=ba.fixImportButton,gf=ba.thisBindingSelector;
yd.changeEditorMode("js").then(function(){return yd.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==gf.selection?yd.owner.selectedContext:yd.owner.targetObject},get systemInterface(){return nb.treeData.systemInterface},format:"esm"}}).catch(function(ng){return $world.logError(ng)});Tc.connect(Ja,"onMouseDown",this,"selectTarget");Tc.connect(nb,"onScroll",this,"repositionOpenWidget");Tc.connect(zb,"onDrag",this,"adjustProportions");Tc.connect(Ic,"onMouseDown",
this,"toggleCodeEditor");Tc.connect(vc,"trigger",this,"filterProperties");Tc.connect(Ad,"trigger",this,"filterProperties");Tc.connect(wd,"searchInput",this,"filterProperties");Tc.connect(nb,"nodeCollapseChanged",this,"filterProperties");Tc.connect(this,"extent",this,"relayout");Tc.connect(gf,"selection",this,"bindCodeEditorThis");Tc.connect(He,"fire",yd,"execCommand",{updater:function(ng){return ng("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",
value:function(){var ba=this.ui.propertyTree.selectedIndex-1,Ja=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Ja=this.ui.propertyTree.document.getLine(ba).textAndAttributes.slice(0,4).concat(Ja.display(this));ba=this.ui.propertyTree.lineRange(ba,!1);this.ui.propertyTree.replace(ba,Ja,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&
this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var ba=Tc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(ba!=this.lastChange||this.lastSubmorphs!=Tc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==ba.prop&&this.repositionOpenWidget(),this.lastChange=ba,this.lastSubmorphs=Tc.printValue(this.targetObject&&
this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var ba;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Ja){Ja=Ja.node;Ja.target&&(ba=Ja.foldableNode?Ja.target[Ja.foldableNode.key][Ja.key]:Ja.target[Ja.key],!Tc.obj.equals(ba,Ja.value)&&Ja.refreshProperty&&Ja.refreshProperty(ba))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",
value:function(ba,Ja){Ja=void 0===Ja?!1:Ja;var nb=this,zb,Ic,vc,Ad,wd,yd,He,gf,ng,Jh,Mi,Th,Mj,Kh,el;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lf){switch(Lf.nextAddress){case 1:if(!nb.isUpdating()){Lf.jumpTo(2);break}return Lf.yield(nb.whenUpdated(),2);case 2:zb=Tc.promise.deferred();Ic=zb.promise;vc=!!nb.target;nb.updateInProgress=Ic;Lf.setCatchFinallyBlocks(4);Ja&&(Ad=Tc.LoadingIndicator.open("connecting to remote..."));if(!Ja){wd=Tc.InspectionTree.forObject(ba,nb);Lf.jumpTo(6);
break}return Lf.yield(Tc.RemoteInspectionTree.forObject(ba,nb),7);case 7:wd=Lf.yieldResult;case 6:return yd=wd,He=nb.ui.propertyTree,Lf.yield(yd.collapse(yd.root,!1),8);case 8:if(!yd.root.children){Lf.jumpTo(9);break}return Lf.yield(yd.collapse(yd.root.children[0],!1),9);case 9:if(gf=nb.originalTreeData&&nb.originalTreeData.diff(yd)){ng=$jscomp.makeIterator(gf);for(Jh=ng.next();!Jh.done;Jh=ng.next())Mi=Jh.value,Th=$jscomp.makeIterator(Mi),Mj=Th.next().value,Kh=Th.next().value,Mj.refreshProperty(Kh.value);
Lf.jumpTo(11);break}He.treeData=yd;return Lf.yield(nb.filterProperties(),12);case 12:if(!He.treeData.root.isCollapsed){Lf.jumpTo(13);break}return Lf.yield(He.onNodeCollapseChanged({node:yd.root,isCollapsed:!1}),14);case 14:He.selectedIndex=1;case 13:return Lf.yield(He.execCommand("uncollapse selected node"),11);case 11:nb.toggleWindowStyle(vc);Ad&&Ad.remove();Lf.leaveTryBlock(5);break;case 4:el=Lf.enterCatchBlock(),nb.showError(el);case 5:nb.startStepping(1E3,"refreshAllProperties"),nb.updateInProgress=
null,Lf.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(ba){ba=void 0===ba?!0:ba;var Ja=this,nb,zb,Ic,vc,Ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wd){if(1==wd.nextAddress)return nb=300,vc=Ja.ui.codeEditor.pluginFind(function(yd){return yd.runEval}),Ad=Ja.getWindow(),wd.yield(vc.runEval("System.get('@system-env').node"),2);wd.yieldResult.value?(Ic=[].concat($jscomp.arrayFromIterable(Tc.arr.without(Ad.styleClasses,"local")),["node"]),zb=Tc.DarkTheme.instance):(Ic=["local"].concat($jscomp.arrayFromIterable(Ad?
Tc.arr.without(Ad.styleClasses,"node"):[])),zb=Tc.DefaultTheme.instance);vc.theme=zb;ba?(Ad&&Ad.animate({duration:nb,styleClasses:Ic}),Ja.ui.codeEditor.animate({fill:zb.background,duration:nb})):Ad&&(Ad.styleClasses=Ic);Ja.ui.codeEditor.textString=Ja.ui.codeEditor.textString;vc.highlight();wd.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},
{key:"build",value:function(){var ba=this,Ja=Object.assign({type:"text",borderWidth:1,borderColor:Tc.Color.gray,lineWrapping:"by-chars"},Tc.config.codeEditor.defaultStyle,{textString:""}),nb=Tc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Tc.rect(0,0,this.width,30);var zb=new Tc.SearchField({styleClasses:["idle"],name:"searchField"});nb[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[zb,{type:"button",name:"targetPicker",padding:Tc.rect(2,2,0,0),borderRadius:15,
master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Tc.Icon.textAttribute("crosshairs")},new Tc.LabeledCheckBox({label:"Internals",name:"internals"}),new Tc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Tc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Tc.InspectionTree.forObject(null,this)})),Tc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},Ja),{name:"fix import button",
type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Tc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(nb),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(nb),[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){ba.ui.thisBindingSelector.selection=
"target"})}},{key:"selectTarget",value:function(){var ba=this,Ja,nb,zb,Ic;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vc){switch(vc.nextAddress){case 1:if(ba.env.eventDispatcher.isKeyPressed("Shift"))return nb=$jscomp,zb=nb.makeIterator,vc.yield($world.execCommand("select morph",{justReturn:!0}),5);ba.toggleSelectionInstructions(!0);return vc.yield(Tc.InteractiveMorphSelector.selectMorph(),4);case 4:Ja=vc.yieldResult;ba.toggleSelectionInstructions(!1);vc.jumpTo(3);break;case 5:Ic=
zb.call(nb,vc.yieldResult),Ja=Ic.next().value;case 3:Ja&&(ba.targetObject=Ja),vc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(ba){if(ba&&!this.instructionWidget){var Ja=Tc.morph({type:"label",name:"escapeKey",value:"esc"});Ja.whenRendered().then(function(){return Ja.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",
{},Ja,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(ba){ba=ba.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;ba.epiMorph=!0;this.openWidget=ba;Tc.once(ba,"close",this,"closeOpenWidget");Tc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",
value:function(){var ba=this.ui.propertyTree,Ja=ba.textLayout.boundsFor(ba,{column:0,row:ba.selectedIndex-1});Ja=ba.worldPoint(Tc.pt(Ja.x,Ja.y+Ja.height/2)).addPt(ba.scroll.negated());ba=ba.globalBounds();Ja.x=this.globalBounds().center().x;Ja.y<ba.top()?Ja=ba.topCenter():ba.bottom()-20<Ja.y&&(Ja=ba.bottomCenter().addXY(0,-20));return Ja}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",
value:function(ba){this.layout.row(1).height+=ba.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(ba){if(ba!==this.isEditorVisible()){var Ja=this.extent,nb=this.layout,zb=this.ui,Ic=zb.terminalToggler,vc=zb.codeEditor,Ad=zb.thisBindingSelector;zb=zb.fixImportButton;nb.disable();ba?(Ic.fontColor=Tc.Color.rgbHex("00e0ff"),nb.row(3).height=this.codeEditorHeight||180,nb.row(2).height=5,zb.animate({visible:!0,
duration:200}),Ad.animate({visible:!0,duration:200})):(this.codeEditorHeight=nb.row(3).height,Ic.fontColor=Tc.Color.white,nb.row(3).height=nb.row(2).height=0,zb.animate({visible:!1,duration:200}),Ad.animate({visible:!1,duration:200}));this.extent=Ja;nb.enable({duration:200});this.relayout({duration:200});vc.focus();vc.animate({opacity:ba?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){ba.makeEditorVisible(!ba.isEditorVisible());
Ja.jumpToEnd()})}},{key:"filterProperties",value:function(){var ba=this,Ja,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return Ja=ba.ui.searchField,nb=ba.ui.propertyTree,ba.originalTreeData||(ba.originalTreeData=nb.treeData),Tc.disconnect(nb.treeData,"onWidgetOpened",ba,"onWidgetOpened"),zb.yield(nb.treeData.filter({maxDepth:2,showUnknown:ba.ui.unknowns.checked,showInternal:ba.ui.internals.checked,iterator:function(Ic){return Ja.matches(Ic.key)}}),2);nb.update();
Tc.connect(nb.treeData,"onWidgetOpened",ba,"onWidgetOpened");zb.jumpToEnd()})}},{key:"relayout",value:function(ba){ba=void 0===ba?{}:ba;var Ja=this,nb,zb,Ic,vc,Ad,wd,yd,He,gf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ng){Ja.layout&&Ja.layout.forceLayout();nb=Ja;zb=nb.ui;Ic=zb.fixImportButton;vc=zb.terminalToggler;Ad=zb.propertyTree;wd=zb.thisBindingSelector;yd=Ad.bounds().insetBy(5).bottomLeft();He=Ad.bounds().insetBy(5).bottomRight();gf=He.subXY(Ic.width+10,0);wd.width=115;wd.listMorph.itemHeight=
20;ba.duration?(vc.animate(Object.assign({bottomLeft:yd},ba)),Ic.animate(Object.assign({bottomRight:He},ba)),wd.animate(Object.assign({bottomRight:gf},ba))):(vc.bottomLeft=yd,Ic.bottomRight=He,wd.bottomRight=gf);ng.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Rb._get(Object.getPrototypeOf(Hb.prototype),"keybindings",
this))}},{key:"commands",get:function(){return Tc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(ba){ba=new this(ba);ba.openInWindow();return ba}},{key:"properties",get:function(){return{extent:{defaultValue:Tc.pt(400,500)},fill:{defaultValue:Tc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(ba){this.setProperty("remoteTarget",
ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ba,!0))}},targetObject:{after:["submorphs"],set:function(ba){this._serializableTarget=ba&&ba.isMorph?ba.id:ba;this.setProperty("targetObject",ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ba))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var ba=this.ui.propertyTree,Ja=ba.selectedNode;ba=ba.treeData;return ba.getContextFor(Ja?Ja:ba.root)}},
submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),
searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Tc.Color.gray,fontSize:14,fontFamily:Tc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25406,end:45571})}(Tc.Morph);Ke=Tc.Inspector;$e=Da("I",Ke);Tc.default=Ke;var Fg=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");Fg.Inspector=$e;Fg.string=vd;Fg.Morph=Hc;Fg.pt=je;Fg.Color=Ab;Ke=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ha,cb,Hb){Hb=void 0===Hb?1:Hb;var ba,
Ja,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),zb.setCatchFinallyBlocks(2),cb=Object.assign({},cb,{logDoit:!0,inspect:!0,inspectDepth:Hb}),zb.yield(Ha.doEval(void 0,cb),4);case 4:ba=zb.yieldResult;Ja=ba.error?ba.error:ba.isError?ba.value:null;zb.leaveTryBlock(3);break;case 2:Ja=nb=zb.enterCatchBlock();case 3:return Ja?Ha.showError(Ja):Ha.setStatusMessage(Fg.string.truncate(ba.value,1E3)),zb.return(ba)}})}},{name:"eval all",
doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ha,cb){var Hb,ba,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nb){switch(nb.nextAddress){case 1:return nb.setCatchFinallyBlocks(2),nb.yield(Ha.doEval({start:{row:0,column:0},end:Ha.documentEndPosition},Object.assign({},cb,{logDoit:!0})),4);case 4:Hb=nb.yieldResult;ba=Hb.error?Hb.error:Hb.isError?Hb.value:null;nb.leaveTryBlock(3);break;case 2:ba=Ja=nb.enterCatchBlock();case 3:return ba?Ha.showError(ba):
Ha.setStatusMessage(String(Hb.value)),nb.return(Hb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ha,cb){var Hb,ba,Ja,nb,zb,Ic,vc,Ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wd){switch(wd.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),wd.setCatchFinallyBlocks(2),cb=Object.assign({},cb,{asString:!1,logDoit:!0}),wd.yield(Ha.doEval(void 0,cb),4);case 4:Hb=wd.yieldResult;ba=Hb.error?
Hb.error:Hb.isError?Hb.value:null;wd.leaveTryBlock(3);break;case 2:ba=Ja=wd.enterCatchBlock();case 3:Ha.selection.collapseToEnd();if(nb=Hb.value&&Hb.value.isColor)return Ha.selection.text=String(Hb.value),zb=new Fg.Morph({fill:Fg.Color.transparent,extent:Fg.pt(Ha.fontSize+2,Ha.fontSize+2),submorphs:[{fill:Hb.value,center:Fg.pt(Ha.fontSize+2,Ha.fontSize+2).scaleBy(.5)}]}),Ic=Ha.selection.start,vc=Ic.column,Ad=Ic.row,Ha.insertText([zb,{}],Ha.selection.start),Ha.selection.start={column:vc,row:Ad},wd.return(Hb);
Ha.insertTextAndSelect(ba?String(ba)+(ba.stack?"\n"+ba.stack:""):String(Hb.value));return wd.return(Hb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ha,cb){var Hb,ba,Ja,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:debugger;Ha.maybeSelectCommentOrLine();ba=Ha.textInRange(Ha.selection);Ja=Ha.evalEnvironment||{};nb=Ha.pluginFind(function(Ic){return Ic.isEditorPlugin&&"function"===
typeof Ic.runEval});Ja.systemInterface||(Ja.systemInterface=nb.systemInterface(cb));if("local"!==Ja.systemInterface.name){zb.jumpTo(2);break}zb.setCatchFinallyBlocks(3);return zb.yield(Ha.doEval(void 0,cb),5);case 5:Hb=zb.yieldResult;ba=Hb.value;zb.leaveTryBlock(2);break;case 3:zb.enterCatchBlock();case 2:return Ha.world().execCommand("open object editor",{target:ba,evalEnvironment:Ja}),zb.return(Hb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",
exec:function(Ha,cb){var Hb,ba,Ja,nb,zb,Ic;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vc){switch(vc.nextAddress){case 1:Ha.maybeSelectCommentOrLine();Ja=Ha.textInRange(Ha.selection);nb=Ha.evalEnvironment||{};zb=Ha.pluginFind(function(Ad){return Ad.isEditorPlugin&&"function"===typeof Ad.runEval});nb.systemInterface||(nb.systemInterface=zb.systemInterface(cb));if("local"!==nb.systemInterface.name){Fg.Inspector.openInWindow({remoteTarget:{code:Ja,evalEnvironment:nb}});vc.jumpTo(2);break}vc.setCatchFinallyBlocks(3);
return vc.yield(Ha.doEval(void 0,cb),5);case 5:Hb=vc.yieldResult;ba=Hb.error?Hb.error:Hb.isError?Hb.value:null;Ja=Hb.value;vc.leaveTryBlock(4);break;case 3:ba=Ic=vc.enterCatchBlock();case 4:Fg.Inspector.openInWindow({targetObject:ba?ba:Ja});case 2:return vc.return(Hb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",handlesCount:!0,exec:function(Ha,cb,Hb){Hb=void 0===Hb?1:Hb;
var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){switch(Ja.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),Ja.setCatchFinallyBlocks(2),cb=Object.assign({},cb,{inspect:!0,inspectDepth:Hb,logDoit:!0}),Ja.yield(Ha.doEval(void 0,cb),4);case 4:ba=Ja.yieldResult;Ja.leaveTryBlock(3);break;case 2:Ja.enterCatchBlock();case 3:return Ha.selection.collapseToEnd(),Ha.insertTextAndSelect(ba.value),Ja.return(ba)}})}}];Fg.codeEvaluationCommands=Ke;Fg.codeEvaluationCommands=Ke;Fg.codeEvaluationCommands=
Ke;var Gg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Gg.changeAttributeInSelectionOrMorph=function(Ha,cb,Hb){var ba=Ha.selection;Ha.keepPosAtSameScrollOffsetWhile(function(){ba.isEmpty()?Ha[cb]="function"===typeof Hb?Hb(Ha[cb]):Hb:(Ha.undoManager.group(),Ha.changeStyleProperty(cb,function(Ja){return"function"===typeof Hb?Hb(Ja):Hb}),Ha.undoManager.group())})};$e=[{name:"increase font size",scrollCursorIntoView:!1,exec:function(Ha){var cb=Ha.fontSize;Gg.changeAttributeInSelectionOrMorph(Ha,
"fontSize",function(Hb){Hb=Hb||cb;return Hb+(18<=Hb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ha){var cb=Ha.fontSize;Gg.changeAttributeInSelectionOrMorph(Ha,"fontSize",function(Hb){Hb=Hb||cb;return Hb-(18>=Hb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ha){var cb,Hb,ba,Ja,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress){cb=["serif","sans-serif","monospace"];if(Hb=localStorage["lively.morpic/text-change-font-additional-fonts"])Hb=
JSON.parse(Hb),cb.push.apply(cb,$jscomp.arrayFromIterable(Hb));cb.map(function(Ic){return Ic.toLowerCase()}).includes(Ha.fontFamily.toLowerCase())||(cb.push(Ha.fontFamily),Hb=[].concat($jscomp.arrayFromIterable(Hb||[]),[Ha.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Hb));return zb.yield($world.editListPrompt("choose font",cb,{requester:Ha,preselect:cb.indexOf(Ha.fontFamily),historyId:"lively.morpic/text-change-font-hist"}),2)}ba=zb.yieldResult;Ja=$jscomp.makeIterator(ba.selections);
if(nb=Ja.next().value)Ha.fontFamily=nb;return zb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ha,cb){cb=void 0===cb?{}:cb;var Hb,ba,Ja,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress){if(cb.hasOwnProperty("link"))return zb.jumpTo(2);ba=Ha.selection;Ja=Ha.getStyleInRange(ba);nb=Ja.link;return zb.yield(Ha.world().prompt("Set link",{input:nb||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=zb.nextAddress&&
(Hb=zb.yieldResult,!Hb))return zb.return();Ha.undoManager.group();Ha.setStyleInRange({link:Hb||void 0},ba);Ha.undoManager.group();zb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ha,cb){var Hb,ba,Ja,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return Hb=Ha.selection,ba=Ha.getStyleInRange(Hb),Ja=ba.doit,zb.yield(Ha.world().editPrompt("Enter doit code (runs on clicking the text)",{requester:Ha,input:Ja?Ja.code:"// empty doit",
historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ha.evalEnvForDoit(Ja||{})}),2);nb=zb.yieldResult;Ha.undoManager.group();nb?Ha.addTextAttribute({doit:{code:nb},nativeCursor:"pointer",textDecoration:"underline"},Hb):Ha.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Hb);Ha.undoManager.group();zb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ha,cb){cb=void 0===cb?{}:cb;Ha.undoManager.group();cb=!cb.onlySelection&&Ha.selection.isEmpty()?
Ha.documentRange:Ha.selection.range;Ha.setStyleInRange(null,cb);Ha.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ha){var cb,Hb,ba,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nb){if(1==nb.nextAddress)return nb.yield(System.import("lively.modules"),2);if(3!=nb.nextAddress)return cb=nb.yieldResult,Hb=cb.module,nb.yield(Hb("lively.ide/text/ui.js").load(),3);ba=nb.yieldResult;Ja=ba.RichTextControl;return nb.return(Ja.openFor(Ha))})}}];Gg.commands=
$e;Gg.commands=$e;Gg.commands=$e;var rf=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");rf.guessTextModeName=Zb;rf.rangedToken=function(Ha,cb,Hb,ba,Ja){return{start:{row:Ha,column:cb},end:{row:Ha,column:Hb},token:ba,mode:Ja}};rf.fun=Qc;rf.arr=jc;rf.connect=Pc;rf.disconnect=Ob;rf.DefaultTheme=Mb;rf.tokenizeDocument=jb;rf.modeInfo=Aa;rf.visitDocumentTokens=rd;rf.getMode=wc;rf.completionCommands=wa;rf.multiSelectCommands=Gc;rf.navCommands=le;rf.codeCommands=kf;rf.codeEvaluationCommands=
Ke;rf.richTextCommands=$e;rf.Color=Ab;rf.Range=ge;rf.guessTextModeName=Zb;rf.guessTextModeName=Zb;Mb=function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Hb=cb.hasOwnProperty("EditorPlugin")&&"function"===typeof cb.EditorPlugin?cb.EditorPlugin:cb.EditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(Hb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
rf.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(ba){var Ja=this;this.textMorph=ba;rf.connect(ba,"textChange",this,"onTextChange");rf.connect(ba,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Ja.highlight()})}},
{key:"detach",value:function(ba){rf.disconnect(ba,"textChange",this,"onTextChange");rf.disconnect(ba,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(ba){this._ast=null;if(ba){var Ja=this._tokenizerValidBefore;if("replace"===ba.selector){var nb=ba.args[0].start;ba=nb.row;nb=nb.column}else nb=ba=0;if(!Ja||ba<Ja.row||ba===Ja.row&&nb<Ja.column)ba=Math.max(0,ba),this._tokenizerValidBefore={row:ba,
column:nb}}this.requestHighlight()}},{key:"requestHighlight",value:function(ba){var Ja=this;(void 0===ba?0:ba)?this.highlight():rf.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return Ja.highlight()})()}},{key:"highlight",value:function(){var ba=this.textMorph,Ja=this.theme,nb=this.mode,zb=this._tokenizerValidBefore;if(Ja&&ba&&ba.document&&nb){ba.fill=Ja.background;ba.cursorColor=Ja.cursorColor||rf.Color.black;var Ic=ba.viewState,vc={};zb=rf.tokenizeDocument(nb,ba.document,Ic.firstVisibleRow,
Ic.lastVisibleRow,zb);nb=zb.lines;zb=zb.tokens;if(nb.length){Ic=nb[0].row;for(var Ad=[],wd=0;wd<zb.length;Ic++,wd++)for(var yd=zb[wd],He=0;He<yd.length;He+=5){var gf=yd[He],ng=yd[He+1],Jh=Ja[yd[He+2]]||Ja.default;Jh&&Ad.push({start:{row:Ic,column:gf},end:{row:Ic,column:ng}},Jh)}ba.embeddedMorphs.forEach(function(Mi){var Th=ba.embeddedMorphMap.get(Mi).anchor;vc[Mi.id]=ba.textAttributeAt(Th.position)});ba.setTextAttributesWithSortedRanges(Ad);ba.embeddedMorphs.forEach(function(Mi){var Th=ba.embeddedMorphMap.get(Mi).anchor;
Th=rf.Range.at(Th.position);Th.end.column+=1;ba.replace(Th,[Mi,vc[Mi.id]],!1)});this._tokenizerValidBefore={row:rf.arr.last(nb).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},ba,this)}}},{key:"visitTokensInRange",value:function(ba,Ja){var nb=ba.start,zb=ba.end,Ic=nb.row-1;rf.visitDocumentTokens(this.mode,this.textMorph.document,nb.row,zb.row,null,function(vc){return Ic++},function(vc,Ad,wd,yd,He,gf,ng){if(Ic===nb.row&&0<nb.column){if(nb.column>=yd)return;wd<nb.column&&nb.column<
yd&&(wd=nb.column)}if(Ic===zb.row){if(zb.column<=wd)return;wd<zb.column&&zb.column<yd&&(yd=zb.column)}Ja(vc,Ad,Ic,wd,yd,He,gf,ng)})}},{key:"tokensInRange",value:function(ba){var Ja=[];this.visitTokensInRange(ba,function(nb,zb,Ic,vc,Ad,wd,yd,He){return Ja.push(rf.rangedToken(Ic,vc,Ad,nb,He))});return Ja}},{key:"tokensOfRow",value:function(ba){var Ja=this.textMorph.getLine(ba).length;return this.tokensInRange({start:{row:ba,column:0},end:{row:ba,column:Ja}})}},{key:"tokenAt",value:function(ba){for(var Ja=
this.tokensOfRow(ba.row),nb=Ja.length;nb--;){var zb=Ja[nb];if(zb.token&&zb.start.column<=ba.column&&ba.column<=zb.end.column)return zb}return null}},{key:"getCommands",value:function(ba){return[].concat($jscomp.arrayFromIterable(ba),$jscomp.arrayFromIterable(rf.completionCommands),$jscomp.arrayFromIterable(rf.multiSelectCommands),$jscomp.arrayFromIterable(rf.navCommands),$jscomp.arrayFromIterable(rf.codeCommands),$jscomp.arrayFromIterable(rf.codeEvaluationCommands),$jscomp.arrayFromIterable(rf.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var ba=this.mode,Ja=ba.lineComment,nb=ba.blockCommentStart;ba=ba.blockCommentEnd;var zb={};Ja&&(zb.lineCommentStart=Ja);nb&&(zb.blockCommentStart=nb);ba&&(zb.blockCommentEnd=ba);return zb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(ba,Ja,nb){var zb=this.textMorph,Ic=ba.row,vc=ba.column;ba=Ja[vc-1];Ja=Ja[vc];zb.selection.text="\n";zb.selection.collapseToEnd();
"{"===ba&&"}"===Ja&&(zb.selection.text="\n"+" ".repeat(nb),zb.selection.collapse());zb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Ic+1,lastRow:Ic+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var ba=this.textMorph,Ja=this.openPairs,nb=ba.selection,zb=ba.getLine(nb.end.row),
Ic=zb[nb.end.column-1];zb=zb[nb.end.column];ba.autoInsertPairs&&nb.isEmpty()&&Ic in Ja&&zb===Ja[Ic]&&(nb.growRight(1),nb.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(ba){var Ja=this.openPairs,nb=this.closePairs,zb=this.textMorph,Ic=zb.selection,vc=zb.autoInsertPairs&&ba in Ja,Ad=zb.autoInsertPairs&&ba in nb;if(!vc&&!Ad)return!1;var wd=zb.getLine(Ic.end.row)[Ic.end.column];if(!Ic.isEmpty()){if(!vc)return!1;nb=zb.undoManager.ensureNewGroup(zb);zb.insertText(Ja[ba],Ic.end);zb.insertText(ba,
Ic.start);zb.undoManager.group(nb);Ic.growRight(-1);return!0}if(wd in nb&&ba===wd)return Ic.goRight(1),!0;if(Ad&&!vc)return!1;nb=zb.undoManager.ensureNewGroup(zb);zb.insertText(ba+Ja[ba]);zb.undoManager.group(nb);Ic.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],cb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);Aa=Mb=rf.EditorPlugin;wa=Da("C",function(Ha){var cb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Hb=cb.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof cb.CodeMirrorEnabledEditorPlugin?cb.CodeMirrorEnabledEditorPlugin:cb.CodeMirrorEnabledEditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Rb(Hb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(){Rb._get(Object.getPrototypeOf(Hb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(ba){this.mode=this.codeMirrorMode(ba);return Rb._get(Object.getPrototypeOf(Hb.prototype),"attach",this).call(this,ba)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",
value:function(ba){return{indentWithTabs:!ba.useSoftTabs,indentUnit:ba.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(ba){ba=this.defaultCodeMirrorModeConfig(ba);return rf.getMode(ba,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],cb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(rf.EditorPlugin));rf.CodeMirrorEnabledEditorPlugin=wa;rf.CodeMirrorEnabledEditorPlugin=wa;rf.CodeMirrorEnabledEditorPlugin=wa;rf.default=Mb;Mb=Object.freeze({__proto__:null,guessTextModeName:Zb,"default":Aa,CodeMirrorEnabledEditorPlugin:wa});Da("e",Mb)}}});
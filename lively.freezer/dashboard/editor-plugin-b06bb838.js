System.register(["./__root_module__-dce2a509.js","./index-133ff6c6.js","./index-3dc09926.js"],function(Ba){var zb,Ib,nc,bc,Sd,Vc,Ud,Yc,Oc,qd,ie,Ye,sf,ne,cc,Hc,Md,fc,$d,pe,Cc,Ic,Sb,Jc,dd,Jd,Kd,Hb,Bb,Mb,Na,Ua,Oa,Ia,eb,cb,ob,Zb,mc,Tb,pa,Ja,X,ua,ab;return{setters:[function(rb){zb=rb.C;Ib=rb.aw;nc=rb.a6;bc=rb.a1;Sd=rb.a3;Vc=rb.ab;Ud=rb.bk;Yc=rb.a_;Oc=rb.au;qd=rb.a7;ie=rb.aR;Ye=rb.bo;sf=rb.bp;ne=rb.a8;cc=rb.aj;Hc=rb.at;Md=rb.av;fc=rb.bq;$d=rb.br;pe=rb.a2;Cc=rb.P;Ic=rb.$;Sb=rb.aZ;Jc=rb.an;dd=rb.ao;Jd=
rb.ap;Kd=rb.aq;Hb=rb.aD;Bb=rb.b1;Mb=rb.az;Na=rb.as;Ua=rb.ad;Oa=rb.bs;Ia=rb.L;eb=rb.bt;cb=rb.b6;ob=rb.bl;Zb=rb.b5;mc=rb.bu;Tb=rb.ax},function(rb){pa=rb.M;Ja=rb.I;X=rb.v;ua=rb.p},function(rb){ab=rb.localInterface}],execute:function(){function rb(Ha,Va){if(!0===Va)return Va;if(Ha.copyState)return Ha.copyState(Va);Ha={};for(var Db in Va){var da=Va[Db];da instanceof Array&&(da=da.concat([]));Ha[Db]=da}return Ha}function vc(Ha,Va,Db){return Ha.startState?Ha.startState(Va,Db):!0}function Bd(Ha,Va){return qb.modes[Ha]=
Va}function sc(Ha){if("string"==typeof Ha&&qb.mimeModes.hasOwnProperty(Ha))Ha=qb.mimeModes[Ha];else if(Ha&&"string"==typeof Ha.name&&qb.mimeModes.hasOwnProperty(Ha.name)){var Va=qb.mimeModes[Ha.name];"string"==typeof Va&&(Va={name:Va});Ha=Object.assign({},Va,Ha);Ha.name=Va.name}else{if("string"==typeof Ha&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ha))return sc("application/xml");if("string"==typeof Ha&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ha))return sc("application/json")}return"string"==typeof Ha?{name:Ha}:Ha||
{name:"null"}}function Nb(Ha,Va){Va=qb.resolveMode(Va);"string"===typeof Va&&(Va={name:Va});if(!Va.name)throw Error("parserConfig does not have a name of the mode to get");var Db=qb.modes[Va.name];if(!Db)return Nb(Ha,"text/plain");Ha=Object.assign({indentUnit:2},Ha);return Object.assign(Db(Ha,Va),{name:Va.name})}function Yd(Ha,Va){for(var Db;Ha.innerMode;){Db=Ha.innerMode(Va);if(!Db||Db.mode==Ha)break;Va=Db.state;Ha=Db.mode}return Db||{mode:Ha,state:Va}}function Cd(Ha,Va){qb.mimeModes[Ha]=Va}function kb(Ha,
Va,Db){}function Cb(Ha,Va,Db,da,Fa,mb,xb){var yc=Ha.editorPlugin._tokenizerValidBefore;yc&&yc.row>=Db&&(yc.row=Db-1);var xc=qb.linesToTokenize(Ha.document,Db,da,yc);yc=xc.lines;xc=xc.state;if(!yc.length)return!1;xc=xc?qb.copyState(Va,xc):qb.startState(Va);for(var gd=0;gd<yc.length;gd++){var td=yc[gd],ad=td.row;ad>=Db&&ad<=da&&qb.indentLine(Ha,Va,td,xc,Fa,mb,xb);xc=qb.tokenizeLine(Va,yc[gd],xc,function(){})}return!0}function $c(Ha,Va,Db,da,Fa,mb,xb){Va=qb.linesToTokenize(Va,Db,da,Fa);Db=Va.lines;qb.tokenizeLines(Ha,
Db,Va.state,mb,xb);return Db}function sb(Ha,Va,Db,da,Fa){var mb=[],xb,yc=function(td){return mb.push(xb=[])},xc=function(td,ad,nf,mg,Yf,of,ui){return xb.push(nf,mg,td,Yf.current(),ad.localMode||ui)};try{var gd=qb.visitDocumentTokens(Ha,Va,Db,da,Fa,yc,xc)}catch(td){mb.length=0,gd=qb.visitDocumentTokens(Ha,Va,Db,da,null,yc,xc)}return{tokens:mb,lines:gd}}function hd(Ha,Va,Db,da,Fa){null==Va&&(Va=Ha.search(/[^\s\u00a0]/),-1==Va&&(Va=Ha.length));da=da||0;for(Fa=Fa||0;;){var mb=Ha.indexOf("\t",da);if(0>
mb||mb>=Va)return Fa+(Va-da);Fa+=mb-da;Fa+=Db-Fa%Db;da=mb+1}}function md(Ha){Ha=Ha.toLowerCase();for(var Va=0;Va<qb.modeInfo.length;Va++){var Db=qb.modeInfo[Va];if(Db.mime==Ha)return Db;if(Db.mimes)for(var da=0;da<Db.mimes.length;da++)if(Db.mimes[da]==Ha)return Db}if(/\+xml$/.test(Ha))return md("application/xml");if(/\+json$/.test(Ha))return md("application/json")}function pb(Ha){for(var Va=0;Va<qb.modeInfo.length;Va++){var Db=qb.modeInfo[Va];if(Db.ext)for(var da=0;da<Db.ext.length;da++)if(Db.ext[da]==
Ha)return Db}}function ub(Ha){for(var Va=0;Va<qb.modeInfo.length;Va++){var Db=qb.modeInfo[Va];if(Db.file&&Db.file.test(Ha))return Db}Va=Ha.lastIndexOf(".");if(Ha=-1<Va&&Ha.substring(Va+1,Ha.length))return qb.findModeByExtension(Ha)}function wb(Ha){Ha=Ha.toLowerCase();for(var Va=0;Va<qb.modeInfo.length;Va++){var Db=qb.modeInfo[Va];if(Db.name.toLowerCase()==Ha)return Db;if(Db.alias)for(var da=0;da<Db.alias.length;da++)if(Db.alias[da].toLowerCase()==Ha)return Db}}function yd(Ha){if(!Ha)return String(Ha);
if(Array.isArray(Ha))return"["+Ha.map(yd).join(",")+"]";if("symbol"===typeof Ha)return Sc.printSymbol(Ha);try{return String(Ha)}catch(Va){return"Cannot print object: "+Va}}function Zd(Ha,Va){return!Sc.arr.every(Va.map(function(Db){return Ha[Db]}),function(Db){return Sc.obj.equals(Db,Ha&&Ha.valueOf())})}function Je(Ha){if(Sc.obj.isPrimitive(Ha))var Va=Sc.string.print(Ha);else Array.isArray(Ha)?((Va=3<Ha.length)&&(Ha=Ha.slice(0,3)),Ha=Sc.string.print(Ha),Va&&(Ha=Ha.slice(0,-1)+", ...]"),Va=Ha):Va=Sc.string.print(Ha);
Va=Va.replace(/\n/g,"");500<Va.length&&(Va=Va.slice(0,20)+("...["+(Va.length-20)+' CHARS]"'));return Va}function Dc(Ha){return Vb.Inspector.openInWindow({targetObject:Ha})}function re(Ha,Va){return Vb.Inspector.openInWindow({remoteTarget:{code:Ha,evalEnvironment:Va}})}function cd(Ha,Va){function Db(yc){var xc=yc.name,gd=yc.ownerChain(),td=yc.owner,ad=yc.world(),nf;yc===mb&&(nf=[xb]);ad===yc&&(nf=["$world"]);if(!nf&&xc&&td){td===ad&&1===Vb.arr.count(Vb.arr.pluck(ad.submorphs,"name"),xc)&&(nf=['$world.get("'+
xc+'")']);if(!nf&&td!=ad)for(ad=gd.length-1;ad--;)if(1===gd[ad].getAllNamed(xc).length){nf=[].concat($jscomp.arrayFromIterable(Db(gd[ad])),['get("'+xc+'")']);break}nf||(xc=[].concat($jscomp.arrayFromIterable(Db(td)),['get("'+xc+'")']),Vb.syncEval(xc.join("."),{context:mb}).value===yc&&(nf=xc))}nf||(nf=[xb+'.getMorphById("'+yc.id+'")']);return nf}Va=void 0===Va?{}:Va;var da=Ha.world(),Fa=Va;Va=void 0===Fa.maxLength?10:Fa.maxLength;var mb=void 0===Fa.fromMorph?da:Fa.fromMorph;if(mb===Ha)return"this";
var xb=da===mb?"$world":"this";if(!(da||Ha.name&&mb.get(Ha.name)===Ha))return"morph";da=Db(Ha);return da.length>Va?'$world.getMorphWithId("'+Ha.id+'")':da.join(".")}function we(Ha,Va,Db){var da=(Va=void 0===Va?"":Va)&&Ve.arr.last(Va.split(".")).toLowerCase(),Fa="",mb=0,xb=Math.pow(2,19);if("string"===typeof Ha){if(Ha.length>xb)return null}else if(Ha.document.stringSize>xb)return null;if("string"===typeof Ha)Fa=Ha.slice(0,1E3);else for(Ha=$jscomp.makeIterator(Ha.document.lines),xb=Ha.next();!xb.done;xb=
Ha.next()){var yc=xb.value;xb=yc.stringSize;yc=yc.text;var xc=!0;1E3<mb+xb&&(xc=!1,xb=1E3-mb);Fa+=yc.slice(0,xb)+(xc?"\n":"");mb+=xb;if(1E3<=mb)break}mb=$jscomp.makeIterator(Ve.modeInfo);for(Ha=mb.next();!Ha.done;Ha=mb.next()){xc=Ha.value;xb=xc.contentTest;Ha=xc.mode;yc=xc.ext;xc=xc.file;if("function"===typeof xb)try{if(xb(Fa))return Ha}catch(gd){}if(xc&&xc instanceof RegExp&&xc.test(Va))return Ha;if(yc)for(xb=$jscomp.makeIterator(yc),yc=xb.next();!yc.done;yc=xb.next())if(yc.value===da)return Ha}return Db}
Ba({a:Cd,d:Bd,r:kb});var xa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");xa.Color=zb;var hb=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Db=Va.hasOwnProperty("DefaultTheme")&&"function"===typeof Va.DefaultTheme?Va.DefaultTheme:Va.DefaultTheme=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:"background",get:function(){return xa.Color.white}},
{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:xa.Color.white,fontWeight:"bold",backgroundColor:xa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:xa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:xa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Va,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Xa=hb=xa.DefaultTheme;xa.default=hb;var qb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");qb.copyState=rb;qb.startState=vc;qb.defineMode=Bd;qb.resolveMode=sc;qb.getMode=Nb;qb.innerMode=Yd;qb.defineMIME=Cd;qb.registerHelper=kb;qb.indentLines=Cb;qb.indentLine=function(Ha,Va,Db,da,Fa,mb,xb){xb=Object.assign({indentWithTabs:!Ha.useSoftTabs,indentUnit:Ha.tabWidth,tabSize:4,ignoreFollowingText:!1},
xb);null==Fa&&(Fa="add");"smart"==Fa&&(Va.indent||(Fa="prev"));var yc=xb.tabSize,xc=Db.text,gd=qb.countColumn(xc,null,yc);Db.modeState&&(Db.modeState=null);var td=xc.match(/^\s*/)[0];if(!mb&&!/\S/.test(xc)){var ad=0;Fa="not"}else if("smart"==Fa&&(ad=Va.indent(da,xb.ignoreFollowingText?"":xc.slice(td.length),xc),ad==qb.passIndent||150<ad)){if(!mb)return;Fa="prev"}"prev"==Fa?ad=0<Db.row?qb.countColumn(Db.prevLine().text,null,yc):0:"add"==Fa?ad=gd+xb.indentUnit:"subtract"==Fa?ad=gd-xb.indentUnit:"number"==
typeof Fa&&(ad=gd+Fa);ad=Math.max(0,ad);Va="";da=0;if(xb.indentWithTabs)for(xb=Math.floor(ad/yc);xb;--xb)da+=yc,Va+="\t";da<ad&&(Va+=" ".repeat(ad-da));if(Va!=td)return Ha.replace({start:{row:Db.row,column:0},end:{row:Db.row,column:td.length}},Va),!0};qb.tokenizeLines=function(Ha,Va,Db,da,Fa){if(Va.length){Db=Db?qb.copyState(Ha,Db):qb.startState(Ha);for(var mb=0;mb<Va.length;mb++){var xb=Va[mb];da(xb);Db=qb.tokenizeLine(Ha,xb,Db,Fa)}}};qb.tokenizeLine=function(Ha,Va,Db,da){var Fa=Va.text;if(!Fa)return Db;
var mb=new qb.StringStream(Fa,2);Db=Va.modeState="function"===typeof Ha.copyState?Ha.copyState(Db):qb.copyState(Ha,Db);Va.prevLine();for(Db._string=Fa;!mb.eol();)Fa=Ha.token(mb,Db),da(Fa,Db,mb.start,mb.pos,mb,Va,Ha),mb.start=mb.pos;return Db};qb.printTokens=function(Ha){for(var Va="",Db=0;Db<Ha.length;Db+=5)Va+=Ha[Db+0]+" => "+Ha[Db+1]+" "+Ha[Db+2]+" "+Ha[Db+3]+" "+Ha[Db+4].name+"\n";return Va};qb.visitDocumentTokens=$c;qb.tokenizeDocument=sb;qb.linesToTokenize=function(Ha,Va,Db,da){if(da&&da.row>=
Db)return{lines:[],state:null};Va=da?Math.max(0,da.row-1):Va;var Fa=Ha.getLine(Va),mb=Fa.text;Ha=[Fa];da=null;for(var xb=0,yc;(yc=Fa.prevLine())&&50>xb++;){Fa=yc;if(Fa.modeState){da=Fa.modeState;break}Ha.unshift(Fa)}if(!da){for(var xc=Fa,gd=Infinity;(yc=Fa.prevLine())&&100>xb++;){Fa=yc;if(Fa.modeState){da=Fa.modeState;break}Ha.unshift(Fa);yc=mb.match(/^\s*/)[0].length;if(0===yc)break;yc<gd&&(gd=yc,xc=Fa)}!da&&0<gd&&(Ha=Ha.slice(Ha.indexOf(xc)))}if(Db>Va)for(Fa=qb.arr.last(Ha);Va<=Db;Va++){Fa=Fa.nextLine();
if(!Fa)break;Ha.push(Fa)}return{lines:Ha,state:da}};qb.countColumn=hd;qb.findModeByMIME=md;qb.findModeByExtension=pb;qb.findModeByFileName=ub;qb.findModeByName=wb;qb.arr=nc;hb=qb.modes||{};qb.modes=hb;qb.modes=hb;qb.modes=hb;hb=Ba("p",{});qb.passIndent=hb;qb.passIndent=hb;qb.passIndent=hb;qb.copyState=rb;qb.copyState=rb;qb.startState=vc;qb.startState=vc;qb.defineMode=Bd;qb.defineMode=Bd;qb.resolveMode=sc;qb.resolveMode=sc;qb.getMode=Nb;qb.getMode=Nb;qb.innerMode=Yd;qb.innerMode=Yd;hb={};qb.mimeModes=
hb;qb.mimeModes=hb;qb.mimeModes=hb;qb.defineMIME=Cd;qb.defineMIME=Cd;qb.registerHelper=kb;qb.registerHelper=kb;qb.indentLines=Cb;qb.indentLines=Cb;qb.visitDocumentTokens=$c;qb.visitDocumentTokens=$c;qb.tokenizeDocument=sb;qb.tokenizeDocument=sb;qb.countColumn=hd;qb.countColumn=hd;(function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Db=Va.hasOwnProperty("StringStream")&&"function"===typeof Va.StringStream?Va.StringStream:Va.StringStream=function(da){da&&da[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da,Fa){this.reset(da,Fa)}},{key:"reset",value:function(da,Fa){this.pos=this.start=0;this.string=void 0===da?"":da;this.tabSize=void 0===Fa?2:Fa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||
void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(da){var Fa=this.string.charAt(this.pos);if("string"==typeof da?Fa==da:Fa&&(da.test?da.test(Fa):da(Fa)))return++this.pos,Fa}},{key:"eatWhile",value:function(da){for(var Fa=this.pos;this.eat(da););return this.pos>Fa}},{key:"eatSpace",value:function(){for(var da=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>da}},{key:"skipToEnd",
value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(da){da=this.string.indexOf(da,this.pos);if(-1<da)return this.pos=da,!0}},{key:"backUp",value:function(da){this.pos-=da}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=qb.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?qb.countColumn(this.string,this.lineStart,this.tabSize):
0)}},{key:"indentation",value:function(){return qb.countColumn(this.string,null,this.tabSize)-(this.lineStart?qb.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(da,Fa,mb){if("string"==typeof da){var xb=function(xc){return mb?xc.toLowerCase():xc},yc=this.string.substr(this.pos,da.length);if(xb(yc)==xb(da))return!1!==Fa&&(this.pos+=da.length),!0}else{if((da=this.string.slice(this.pos).match(da))&&0<da.index)return null;da&&!1!==Fa&&(this.pos+=da[0].length);return da}}},
{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(da,Fa){this.lineStart+=da;try{return Fa()}finally{this.lineStart-=da}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],Va,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:10431,end:12920})})(void 0);hb=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",
ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",
mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",
mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ha){return Ha.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",
file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",
ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",
mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",
mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",
ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},
{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},
{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},
{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",
mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},
{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",
ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",
mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Ha){return Ha.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",
mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",
mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",
mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn",
"ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",
mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",
ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];qb.modeInfo=hb;qb.modeInfo=hb;qb.modeInfo=hb;for(var P=0;P<qb.modeInfo.length;P++)qb.info=
qb.modeInfo[P],qb.info.mimes&&(qb.info.mime=qb.info.mimes[0]);qb.defineMode("null",function(){return{token:function(Ha){return Ha.skipToEnd()}}});qb.defineMIME("text/plain","null");qb.findModeByMIME=md;qb.findModeByMIME=md;qb.findModeByExtension=pb;qb.findModeByExtension=pb;qb.findModeByFileName=ub;qb.findModeByFileName=ub;qb.findModeByName=wb;qb.findModeByName=wb;var qa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");qa.Color=zb;qa.Rectangle=bc;qa.pt=Sd;qa.morph=Vc;qa.ShadowObject=
Ud;qa.StyleSheet=Yc;qa.connect=Oc;qa.arr=nc;qa.string=qd;qa.FilterableList=ie;qa.Range=Ye;P=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Db=Va.hasOwnProperty("Completer")&&"function"===typeof Va.Completer?Va.Completer:Va.Completer=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"Completer"}}],Va,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);qa.Completer=P;qa.Completer=P;qa.Completer=P;P=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Db=Va.hasOwnProperty("WordCompleter")&&
"function"===typeof Va.WordCompleter?Va.WordCompleter:Va.WordCompleter=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:"compute",value:function(da,Fa){var mb=[],xb=[],yc=da.document.lineStrings;da=da.cursorPosition.row;for(var xc=da-1;0<=xc;xc--)for(var gd=$jscomp.makeIterator(yc[xc].split(/[^0-9a-z@_]+/i)),td=gd.next();!td.done;td=gd.next())(td=td.value)&&!mb.includes(td)&&td!==Fa&&(mb.push(td),
xb.push({priority:1E3-(da-xc),completion:td}));for(xc=da+1;xc<yc.length;xc++)for(gd=$jscomp.makeIterator(yc[xc].split(/[^0-9a-z_@]+/i)),td=gd.next();!td.done;td=gd.next())(td=td.value)&&!mb.includes(td)&&td!==Fa&&(mb.push(td),xb.push({priority:1E3-(xc-da),completion:td}));return xb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Va,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);qa.WordCompleter=P;qa.WordCompleter=P;qa.WordCompleter=P;P=[new qa.WordCompleter];qa.defaultCompleters=P;qa.defaultCompleters=P;qa.defaultCompleters=P;P=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Db=Va.hasOwnProperty("CompletionController")&&"function"===typeof Va.CompletionController?Va.CompletionController:Va.CompletionController=function(da){da&&da[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da,Fa){Fa=void 0===Fa?[]:Fa;this.textMorph=da;this.completers=Fa=da.pluginCollect("getCompleters",Fa)}},{key:"computeCompletions",value:function(da){var Fa=this,mb,xb,yc,xc,gd,td,ad,nf,mg,Yf,of,ui,Ph,Pj,gi,hl;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yg){switch(yg.nextAddress){case 1:mb=[],xb=$jscomp.makeIterator(Fa.completers),yc=xb.next();
case 2:if(yc.done){yg.jumpTo(4);break}xc=yc.value;yg.setCatchFinallyBlocks(5);gd=mb;td=gd.concat;return yg.yield(xc.compute(Fa.textMorph,da),7);case 7:mb=td.call(gd,yg.yieldResult);yg.leaveTryBlock(3);break;case 5:ad=yg.enterCatchBlock(),console.warn("Error in completer "+xc+": "+(ad.stack||ad));case 3:yc=xb.next();yg.jumpTo(2);break;case 4:nf=new Map;mb.forEach(function(nk){var Vi=nf.get(nk.completion);Vi||(Vi=[],nf.set(nk.completion,Vi));Vi.push(nk)});mg=[];Yf=$jscomp.makeIterator(nf.values());
for(of=Yf.next();!of.done;of=Yf.next())ui=of.value,mg.push(qa.arr.last(qa.arr.sortByKey(ui,"priority")));Ph=0;Pj=qa.arr.sortByKey(mg,"priority").reverse();gi=Pj.length&&Pj[0].priority||0;hl=Pj.map(function(nk){nk.highestPriority=gi;var Vi=nk.completion.replace(/\n/g,""),Dk=String((nk.info||"").replace(/\n/g,""));Ph=Math.max(Ph,Vi.length+Dk.length);return{isListItem:!0,string:Vi,annotation:Dk,value:nk}});return yg.return({items:hl,maxCol:Ph})}})}},{key:"computeSortedCompletions",value:function(da,
Fa){Fa=void 0===Fa?!1:Fa;var mb=this,xb,yc,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gd){if(1==gd.nextAddress)return xb={tokens:[da],lowercasedTokens:[da],input:da},gd.yield(mb.computeCompletions(da),2);yc=gd.yieldResult;xc=qa.arr.sortBy(yc.items.filter(function(td){return mb.filterFunction(xb,td,Fa)}),function(td){return mb.sortFunction(xb,td)});return gd.return(xc)})}},{key:"_printCompletions",value:function(da){var Fa=this,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==
xb.nextAddress)return xb.yield(Fa.computeSortedCompletions(da),2);mb=xb.yieldResult.map(function(yc){return{completion:yc.value.completion,priority:yc.value.priority,maxP:yc.value.highestPriority,sortVal:yc._cache[da].sortVal,lev:JSON.stringify(yc._cache[da].levenshtein)}});return xb.return(qa.string.printTable(lively.lang.grid.tableFromObjects(mb)))})}},{key:"prefix",value:function(){var da=this.textMorph,Fa=da.selection;return(Fa.isEmpty()?da.getLine(Fa.lead.row).slice(0,Fa.lead.column):Fa.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(da,Fa,mb){mb=void 0===mb?!1:mb;Fa._cache||(Fa._cache={});var xb=da.tokens,yc=da.lowercasedTokens,xc=da.input;xc=Fa._cache[xc]||(Fa._cache[xc]={});if(xc.hasOwnProperty("filtered"))return xc.filtered;Fa=Fa.value.completion.replace(/\([^\)]*\)$/,"");var gd=Fa.toLowerCase();if(mb&&xb[0]&&!Fa.startsWith(xb[0]))return xc.filtered=!1;if(yc.every(function(ad){return gd.includes(ad)}))return!0;var td=xc.levenshtein||(xc.levenshtein={});da=mb||3>=qa.arr.sum(da.lowercasedTokens.map(function(ad){return td[ad]||
(td[ad]=qa.string.levenshtein(gd,ad))}));return xc.filtered=da}},{key:"sortFunction",value:function(da,Fa){Fa._cache||(Fa._cache={});var mb=Fa._cache[da.input]||(Fa._cache[da.input]={});if(mb.hasOwnProperty("sortVal"))return mb.sortVal;mb=Fa._cache[da.input]={};var xb=Fa.value;Fa=xb.highestPriority;var yc=xb.completion;xb=xb.priority;yc=yc.replace(/\([^\)]*\)$/,"").toLowerCase();var xc=0;da.lowercasedTokens.forEach(function(td){yc.startsWith(td)?xc+=12:3<=td.length&&yc.includes(td)&&(xc+=5)});Fa=
-((xb||(xc?Fa:0))/Math.pow(10,String(Fa).length-2))-xc;var gd=mb.levenshtein||(mb.levenshtein={});da=qa.arr.sum(da.lowercasedTokens.map(function(td){return gd[td]||(gd[td]=qa.string.levenshtein(yc,td))}));xc&&(da/=2);return mb.sortVal=da+Fa}},{key:"positionForMenu",value:function(){var da=this.textMorph,Fa=da.charBoundsFromTextPosition(da.cursorPosition);return da.getGlobalTransform().transformRectToRect(Fa).topLeft().addXY(-da.scroll.x,-da.scroll.y).addPt(qa.pt(da.borderWidth+4,da.borderWidth+4))}},
{key:"completionListSpec",value:function(){var da=this,Fa,mb,xb,yc,xc,gd,td,ad,nf,mg,Yf,of,ui,Ph,Pj,gi,hl,yg,nk,Vi;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Dk){if(1==Dk.nextAddress)return mb=Fa=da.textMorph,xb=mb.fontSize,yc=mb.fontFamily,xc=da.positionForMenu(),gd=da.prefix(),Dk.yield(da.computeCompletions(gd),2);td=Dk.yieldResult;ad=td.items;nf=td.maxCol;mg=Fa.env.fontMetric.sizeFor(yc,xb,"M");Yf=mg.width*nf;of=Fa.document.getLine(0).height;ui=Math.max(120,Yf<Fa.width?Yf:Fa.width);
Ph=of*ad.length+of+10;Pj=Math.max(70,Math.min(700,Ph));gi=xc.extent(qa.pt(ui,Pj));if(hl=Fa.world())yg=hl.visibleBounds().insetBy(5),gi.bottom()>yg.bottom()&&(nk=gi.bottom()-yg.bottom(),nk>gi.height-50&&(nk=gi.height-50),gi.height-=nk),gi.right()>yg.right()&&(Vi=gi.right()-yg.right(),gi.width=120>gi.width-Vi?120:gi.width-Vi),yg.containsRect(gi)||(gi=gi.withTopLeft(yg.translateForInclusion(gi).topLeft())),gi=gi.translatedBy(yg.insetBy(0).topLeft().negated());return Dk.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:xb,position:gi.topLeft(),extent:gi.extent(),items:ad,input:gd,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:da.filterFunction,sortFunction:da.sortFunction})})}},{key:"removeMenuOnBlur",value:function(da){var Fa=da.menu;setTimeout(function(){Fa.withAllSubmorphsDetect(function(mb){return mb.isFocused()})?Fa.inputMorph.focus():Fa.remove()})}},{key:"openCompletionList",value:function(){var da=this,Fa,mb,xb,yc,xc,gd,td,ad,
nf,mg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yf){if(1==Yf.nextAddress)return Fa=da.textMorph.selection.start,Yf.yield(da.completionListSpec(),2);if(3!=Yf.nextAddress)return mb=Yf.yieldResult,da.textMorph.pluginFind(function(of){return of.theme}),xb=new qa.FilterableList(mb),yc=new qa.Range({start:Fa,end:da.textMorph.selection.start}),xc=da.textMorph.textInRange(yc),gd=xb.inputMorph,td=xb.listMorph,ad=mb.input,nf=xb.addMorph({name:"prefix mask",fill:qa.Color.transparent,bounds:gd.textBounds()},
gd),td.master=null,yc.isEmpty()||(da.textMorph.deleteText(yc),gd.input=xc,gd.gotoDocumentEnd()),gd.fontColor=da.textMorph.fontColor,qa.connect(gd,"textString",nf,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:gd}}),qa.connect(xb,"accepted",da,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:ad}}),qa.connect(xb,"accepted",xb,"remove"),qa.connect(xb,"canceled",xb,"remove"),qa.connect(xb,"remove",da.textMorph,"focus"),qa.connect(xb.inputMorph,"onBlur",da,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:xb}}),mg=da.textMorph.world(),td.addStyleClass("hiddenScrollbar"),xb.paddingMorph.height=2,gd.height=td.itemHeight,gd.clipMode="visible",gd.fill=da.textMorph.fill,gd.fixedHeight=!0,gd.fixedWidth=!1,gd.fontSize=td.fontSize,xb.relayout(),xb.selectedIndex=
0,xb.master.applyIfNeeded(!0),gd.focus(),Yf.yield(xb.master.whenApplied(),3);ad.length&&(gd.gotoDocumentEnd(),xb.moveBy(qa.pt(-gd.textBounds().width,0)));mg.addMorph(xb);xb.inputPadding=qa.Rectangle.inset(0,0,0,0);return Yf.return(xb)})}},{key:"autoInsertBestMatchingCompletion",value:function(da,Fa,mb){Fa=void 0===Fa?!0:Fa;var xb=this,yc,xc,gd,td;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){if(1==ad.nextAddress)return yc=$jscomp,xc=yc.makeIterator,ad.yield(xb.computeSortedCompletions(da,
Fa),2);gd=xc.call(yc,ad.yieldResult);(td=gd.next().value)&&xb.insertCompletion(td.value.completion,da,mb);ad.jumpToEnd()})}},{key:"insertCompletion",value:function(da,Fa,mb){var xb=this.textMorph,yc=xb.document,xc=xb.selection.isMultiSelection?xb.selection.selections:[xb.selection];xb.undoManager.group();xc.forEach(function(gd){gd.collapseToEnd();var td=gd.lead,ad=Fa?yc.indexToPosition(yc.positionToIndex(td)-Fa.length):td;"function"===typeof mb?mb(da,Fa,xb,{start:ad,end:td},gd):xb.replace({start:ad,
end:td},da)});xb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],Va,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);qa.CompletionController=P;qa.CompletionController=P;qa.CompletionController=P;P=
[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ha,Va,Db){var da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){return 1==Fa.nextAddress?(da=new qa.CompletionController(Ha,qa.defaultCompleters),Fa.yield(da.openCompletionList(),2)):Fa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ha,Va,Db){var da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){return 1==Fa.nextAddress?(da=
new qa.CompletionController(Ha,qa.defaultCompleters),Fa.yield(da.autoInsertBestMatchingCompletion(da.prefix()),2)):Fa.return(!0)})}}];qa.completionCommands=P;qa.completionCommands=P;qa.completionCommands=P;var fb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");fb.chain=sf;fb.arr=nc;fb.obj=ne;fb.string=qd;var Lb=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ha){var Va=Ha.selection.start;0<Va.row&&(Va=Ha.getPositionAboveOrBelow(1,Va,
!0,0,Ha.charBoundsFromTextPosition(Va).x),Ha.selection.addRange({start:Va,end:Va}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Ha){var Va=Ha.selection.start;Va.row<Ha.documentEndPosition.row&&(Va=Ha.getPositionAboveOrBelow(-1,Va,!0,0,Ha.charBoundsFromTextPosition(Va).x),Ha.selection.addRange({start:Va,end:Va}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ha){var Va=Ha.selection.selections[Ha.selection.selections.length-
1];if(Va.isEmpty())return!0;Ha.searchForAll(Va.text,{start:{column:0,row:0}}).forEach(function(Db){return Ha.selection.addRange(Db.range,!1)});Ha.selection.mergeSelections();fb.arr.remove(Ha.selection.selections,Va);Ha.selection.selections.push(Va);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ha){var Va=Ha.selection.selections.length-1,Db=Ha.selection.selections[Va];if(Db.isEmpty())return!0;var da=Ha.search(Db.text,{start:Db.end,backwards:!1});
da&&(Db=Ha.selection.selections.findIndex(function(Fa){return Fa.range.equals(da.range)}),-1<Db?fb.arr.swap(Ha.selection.selections,Db,Va):Ha.selection.addRange(da.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Ha){var Va=Ha.selection.selections.length-1,Db=Ha.selection.selections[Va];if(Db.isEmpty())return!0;var da=Db.start,Fa=Ha.search(Db.text,{start:{row:da.row,column:da.column-(Db.text.length-1)},backwards:!0});Fa&&(Db=Ha.selection.selections.findIndex(function(mb){return mb.range.equals(Fa.range)}),
-1<Db?fb.arr.swap(Ha.selection.selections,Db,Va):Ha.selection.addRange(Fa.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Ha){var Va=Ha.selection.selections.length;1<Va&&Ha.selection.removeSelections(Va-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ha){Ha.selection.selections=lively.lang.arr.rotate(Ha.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(Ha){Ha.selection.selections=lively.lang.arr.rotate(Ha.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Ha){var Va=Ha.selection.selections;if(1>=Va.length)return!0;var Db=fb.arr.groupBy(Va,function(Fa){return Fa.range.start.row});Va=Db.keys().map(function(Fa){Fa=Db[Fa];var mb=fb.arr.max(Fa,function(xb){return xb.range.start.column});fb.arr.without(Fa,mb).forEach(function(xb){return xb.range=mb.range});
return mb});var da=fb.arr.max(Va,function(Fa){return Fa.range.start.column}).range.start.column;Va.forEach(function(Fa){var mb=Fa.range.start;Fa=mb.row;mb=mb.column;Ha.insertText(" ".repeat(da-mb),{row:Fa,column:mb})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ha){Ha.selection.disableMultiSelect();if(Ha.selection.isEmpty())var Va=Ha.lastSavedMark&&Ha.lastSavedMark.position||(void 0).lineRange().start,Db=Ha.cursorPosition;else Va=Ha.selection,
Db=Va.lead,Va=Va.anchor;Ha.selection.collapse();var da=Va.column,Fa=Db.column;fb.arr.range(Va.row,Db.row).forEach(function(mb){return Ha.getLine(mb).length>Math.min(Fa,da)&&Ha.selection.addRange({end:{row:mb,column:Fa},start:{row:mb,column:da}},!1)});Ha.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ha,Va,Db){Db=void 0===Db?1:Db;Ha.undoManager.group();Ha.selection.selections.forEach(function(da,Fa){return da.text=String(Fa+
Db)});Ha.undoManager.group();return!0}}];fb.multiSelectCommands=Lb;fb.multiSelectCommands=Lb;fb.multiSelectCommands=Lb;var gc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");gc.pToI=function(Ha,Va){return Ha.positionToIndex(Va)};gc.iToP=function(Ha,Va){return Ha.indexToPosition(Va)};gc.execCodeNavigator=function(Ha){return function(Va,Db,da){var Fa=Va.pluginInvokeFirst("getNavigator");if(!Fa)return!0;Va.saveMark();da=da||1;for(var mb=0;mb<da;mb++)Fa[Ha](Va,Db);return!0}};
gc.once=cc;var Zc=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:gc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:gc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:gc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:gc.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:gc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ha,Va){function Db(){var mb=Ha.$expandRegionState,xb=gc.pToI(Ha,Ha.cursorPosition);if(mb&&(mb.range[0]===xb||mb.range[1]===xb))return mb;mb=Ha.selection.range;return Ha.$expandRegionState={range:[gc.pToI(Ha,mb.start),
gc.pToI(Ha,mb.end)]}}Va=Va||{};var da=Ha.pluginInvokeFirst("getNavigator");if(!da)return!0;var Fa=Va.start;Va=Va.end;if("number"===typeof Fa&&"number"===typeof Va)Db(),da={range:[Fa,Va],prev:Db()};else{Fa=da.ensureAST(Ha);if(!Fa)return;da=da.expandRegion(Ha,Ha.textString,Fa,Db())}da&&da.range&&(Ha.selection={start:gc.iToP(Ha,da.range[0]),end:gc.iToP(Ha,da.range[1])},Ha.$expandRegionState=da);gc.once(Ha,"selectionChange",function(){return Ha.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ha){if(Ha.selection.isEmpty())return!0;var Va=Ha.pluginInvokeFirst("getNavigator");if(!Va)return!0;var Db=Va.ensureAST(Ha);if(!Db)return!0;var da=Ha.$expandRegionState;if(!da)return!0;(Va=Va.contractRegion(Ha,Ha.textString,Db,da))&&Va.range&&(Ha.selection={start:gc.iToP(Ha,Va.range[0]),end:gc.iToP(Ha,Va.range[1])},Ha.$expandRegionState=Va);gc.once(Ha,"selectionChange",
function(){return Ha.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];gc.commands=Zc;gc.commands=Zc;gc.commands=Zc;var Qd=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");Qd.arr=nc;Qd.chain=sf;Qd.string=qd;var ge=[{name:"toggle comment",exec:function(Ha){var Va=Ha.pluginInvokeFirst("getComment");if(!Va)return!0;if(!Va.lineCommentStart)return Va.blockCommentStart?Ha.execCommand("toggle block comment"):!0;var Db=Va.lineCommentStart,da=
new RegExp("^(\\s*)("+Db+"\\s?)(.*)");Va=Ha.document;var Fa=Ha.selection;Fa.isEmpty()||0!==Fa.end.column||Fa.growRight(-1);var mb=Fa.start.row;Va=Va.lineStrings.slice(Fa.start.row,Fa.end.row+1);Va=Va.some(function(xc){return!!xc.trim()})?Qd.arr.dropWhile(Va,function(xc){return xc.trim()?!1:++mb&&!0}):Va;var xb=Va.every(function(xc){return xc.trim()&&xc.match(da)});Ha.undoManager.group();if(xb)Va.forEach(function(xc,gd){if(xc=xc.match(da)){xc=$jscomp.makeIterator(xc);xc.next();var td=xc.next().value,
ad=xc.next().value;xc.next();Ha.deleteText({start:{row:mb+gd,column:td.length},end:{row:mb+gd,column:td.length+ad.length}})}});else{var yc=Va.reduce(function(xc,gd,td){return gd.trim()||Fa.isEmpty()&&Fa.start.row===Fa.end.row?Math.min(xc,gd.match(/^\s*/)[0].length):xc},Infinity);yc=Infinity===yc?0:yc;Va.forEach(function(xc,gd){xc=$jscomp.makeIterator(xc.match(/^(\s*)(.*)/));xc.next();xc.next();xc.next();Ha.insertText(Db+" ",{row:mb+gd,column:yc})})}Ha.undoManager.group();return!0}},{name:"toggle block comment",
exec:function(Ha){var Va=Ha.pluginInvokeFirst("getComment");if(!Va)return!0;if(!Va.blockCommentStart)return Va.lineCommentStart?Ha.execCommand("toggle comment"):!0;if(!Va||!Va.blockCommentStart)return!0;var Db=Va.blockCommentStart;Va=Va.blockCommentEnd;var da=new RegExp("^"+Db.replace(/\*/g,"\\*")),Fa=new RegExp(Va.replace(/\*/g,"\\*")+"$"),mb=Ha.tokenAt(Ha.cursorPosition);if(mb&&"comment"===mb.token){var xb=Ha.textInRange(mb);if(xb.match(da)&&xb.match(Fa))return Ha.undoManager.group(),Ha.replace(mb,
xb.slice(Db.length,-Va.length)),Ha.undoManager.group(),!0}Ha.undoManager.group();Ha.insertText(Db,Ha.selection.start);Ha.insertText(Va,Ha.selection.end);Ha.undoManager.group();Db=!Ha.selection.isEmpty();Ha.selection.growLeft(Va.length);Db||Ha.selection.collapse();return!0}},{name:"comment box",exec:function(Ha,Va,Db){Va=Ha.undoManager.ensureNewGroup(Ha,"comment box");if(Ha.selection.isEmpty())return Ha.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ha.execCommand("toggle comment"),
Ha.undoManager.group(Va),!0;var da=Ha.selection.range,Fa=Ha.withSelectedLinesDo(function(xb){return xb}),mb=Qd.arr.min([da.start.column].concat(Qd.chain(Fa).map(function(xb){return xb.match(/^\s*/)}).flatten().compact().pluck("length").value()));Fa=Qd.arr.max(Fa.map(function(xb){return xb.length}))-mb;Fa=Array(Math.ceil(Fa/2)+1).join("-=")+"-";Ha.execCommand("toggle comment");Ha.collapseSelection();Ha.cursorPosition={row:da.start.row,column:0};Db?Ha.insertText(Qd.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",mb)):Ha.insertText(Qd.string.indent(Fa+"\n"," ",mb));Ha.selection.goUp();Ha.execCommand("toggle comment");Ha.cursorPosition={row:da.end.row+2,column:0};Ha.insertText(Qd.string.indent(Fa+"\n"," ",mb));Ha.selection.goUp();Ha.execCommand("toggle comment");Ha.selection.range={start:{row:da.start.row,column:0},end:Ha.cursorPosition};Ha.undoManager.group(Va);return!0},multiSelectAction:"forEach",handlesCount:!0}];Qd.commands=ge;Qd.commands=ge;Qd.commands=ge;var Sc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
Sc.printSymbol=function(Ha){if(Symbol.keyFor(Ha))return'Symbol.for("'+Symbol.keyFor(Ha)+'")';if(Sc.knownSymbols.get(Ha))return Sc.knownSymbols.get(Ha);String(Ha).match(Sc.symMatcher);return String(Ha)};Sc.defaultSort=function(Ha,Va){if(Ha.hasOwnProperty("priority")||Va.hasOwnProperty("priority")){var Db=Ha.priority||0,da=Va.priority||0;if(Db<da)return-1;if(Db>da)return 1}Ha=(Ha.keyString||Ha.key).toLowerCase();Va=(Va.keyString||Va.key).toLowerCase();return Ha<Va?-1:Ha===Va?0:1};Sc.safeToString=yd;
Sc.propertyNamesOf=function(Ha,Va){if(!Ha)return[];if(Array.isArray(Ha)){var Db=Va?Va.offset:0;return Sc.arr.range(Db,Db+(Va?Va.partitionSize:Ha.length-1))}return Sc.arr.sortBy(Object.keys(Ha),function(da){return da.toLowerCase()})};Sc.isMultiValue=Zd;Sc.printValue=Je;Sc.partitionedChildren=function(Ha,Va){var Db=void 0===Va?{}:Va;Va=void 0===Db.originalValue?Ha:Db.originalValue;var da=void 0===Db.offset?0:Db.offset;Db=void 0===Db.partitionSize?Ha.length||Object.values(Ha).length:Db.partitionSize;
if(Sc.obj.isArray(Ha)){Ha=Sc.num.roundTo(Math.max(Sc.MIN_PARTITION_SIZE,Db/50),.1);Db/=Ha;for(var Fa=[],mb=0;mb<Db;mb++){var xb="["+(da+mb*Ha)+"-"+(da+(mb+1)*Ha)+"]";Fa.push({partition:{originalValue:Va,offset:da+mb*Ha,partitionSize:Ha},value:[],key:xb,keyString:xb,valueString:"...",isCollapsed:!0})}return Fa}Ha=Sc.num.roundTo(Math.max(Sc.MIN_PARTITION_SIZE,Db/50),.1);Db/=Ha;Fa=[];mb=Sc.obj.keys(Va).sort();for(xb=0;xb<Db;xb++){var yc=da+xb*Ha,xc=da+(xb+1)*Ha,gd=Sc.obj.select(Va,mb.slice(yc,xc));yc=
"["+mb[yc].slice(0,4)+"-"+(mb[xc]||Sc.arr.last(mb)).slice(0,4)+"]";Fa.push({partition:{originalValue:gd,offset:da+xb*Ha,partitionSize:Ha},value:[],key:yc,keyString:yc,valueString:"...",isCollapsed:!0})}return Fa};Sc.propertiesOf=function(Ha){var Va=Ha.partition?Ha.target:Ha.value;if(!Va)return[];var Db={_rev:!0},da=[],Fa="function"===typeof Va.livelyCustomInspect?Va.livelyCustomInspect():{},mb=Object.assign({},Sc.defaultPropertyOptions,{},Fa);if(Fa.properties){Fa=$jscomp.makeIterator(Fa.properties);
for(var xb=Fa.next();!xb.done;xb=Fa.next()){var yc=xb.value;xb=yc.key;var xc=yc.hidden,gd=yc.priority,td=yc.keyString,ad=yc.value;yc=yc.valueString;Db[xb]=!0;xc||da.push(Ha.getSubNode({priority:gd,key:xb,keyString:td||Sc.safeToString(xb),value:ad,valueString:yc,isCollapsed:!0}))}}if(mb.includeDefault){Fa=Sc.propertyNamesOf(Va,Ha.partition);if(Fa.length>Sc.MAX_NODE_THRESHOLD)for(Db=$jscomp.makeIterator(Sc.partitionedChildren(Va,Ha.partition)),Fa=Db.next();!Fa.done;Fa=Db.next())da.push(Ha.getSubNode(Fa.value));
else for(xc=$jscomp.makeIterator(Fa),Fa=xc.next();!Fa.done;Fa=xc.next())gd=Fa.value,gd in Db||(Fa=Va[gd],xb=Sc.printValue(Fa),Fa={keyString:gd,key:gd,value:Fa,valueString:xb,isCollapsed:!0},da.push(Ha.getSubNode(Fa)));if(mb.includeSymbols)for(Db=$jscomp.makeIterator(Object.getOwnPropertySymbols(Va)),Fa=Db.next();!Fa.done;Fa=Db.next())xc=Fa.value,gd=Sc.safeToString(xc),Fa=Va[xc],xb=Sc.printValue(Fa),Fa={key:xc,keyString:gd,value:Fa,valueString:xb,isCollapsed:!0},da.push(Ha.getSubNode(Fa))}mb.sort&&
(da=mb.sortFunction(Va,da));return da};Sc.obj=ne;Sc.num=Hc;Sc.arr=nc;Sc.string=qd;Sc.connect=Oc;Sc.signal=Md;Sc.TreeData=fc;Sc.newUUID=$d;Sc.localInterface=ab;Sc.MAX_NODE_THRESHOLD=1E3;Sc.MIN_PARTITION_SIZE=250;Sc.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Ha,Va){return Array.isArray(Ha)?Va:Va.sort(Sc.defaultSort)}};Sc.symMatcher=/^Symbol\((.*)\)$/;Sc.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ha){return"symbol"===
typeof Symbol[Ha]}).reduce(function(Ha,Va){return Ha.set(Symbol[Va],"Symbol."+Va)},new Map)}();Sc.isMultiValue=Zd;Sc.isMultiValue=Zd;Sc.printValue=Je;Sc.printValue=Je;var Pe=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Va.hasOwnProperty("InspectionTree")&&"function"===typeof Va.InspectionTree?Va.InspectionTree:Va.InspectionTree=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Ib(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da){Ib._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),this).call(this,da);this.inspector=da.inspector;this.root.isInspectionNode||(this.root=Sc.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(da){da=void 0===da?!0:da;return Ib._get(Object.getPrototypeOf(Db.prototype),"asListWithIndexAndDepth",
this).call(this,function(Fa){Fa=Fa.node;return da?Fa.visible:!0})}},{key:"getContextFor",value:function(da){return da==this.root?this.root.value.inspectee:da.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(da){var Fa=void 0===da.maxDepth?1:da.maxDepth,mb=da.iterator,xb=da.showUnknown,yc=da.showInternal,xc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gd){if(1==gd.nextAddress)return gd.yield(xc.uncollapseAll(function(td,ad){return Fa>ad&&(td==xc.root||td.value.submorphs)}),
2);xc.asListWithIndexAndDepth(!1).forEach(function(td){var ad=td.node;return 0==td.depth?ad.visible=!0:!xb&&ad.keyString&&ad.keyString.includes("UNKNOWN PROPERTY")||!yc&&ad.keyString&&ad.keyString.includes("internal")?ad.visible=!1:ad.value&&ad.value.submorphs?ad.visible=!0:ad.visible=mb(ad)});gd.jumpToEnd()})}},{key:"getChildren",value:function(da){return da.children}},{key:"display",value:function(da){return da.display(this.inspector)}},{key:"isCollapsed",value:function(da){return da.isCollapsed}},
{key:"isLeaf",value:function(da){return Sc.obj.isPrimitive(da.value)}},{key:"collapse",value:function(da,Fa){var mb=this;da.isCollapsed=Fa;Fa||this.isLeaf(da)||da.children.length||(da.children=Sc.propertiesOf(da).map(function(xb){mb.parentMap.set(xb,da);return xb}))}},{key:"retrieveForRemoteProxy",value:function(da){da.uuid||(da.uuid=Sc.newUUID(),this.idToNodeMap[da.uuid]=da);return{uuid:da.uuid,value:this.isLeaf(da)?da.value:{},keyString:da.keyString,key:da.keyString,valueString:Sc.safeToString(da.value),
isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Sc.localInterface}},{key:"getNodeViaId",value:function(da){return this.idToNodeMap[da]}},{key:"asRemoteDelegate",value:function(da){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[da]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(da,Fa){return new this({key:"inspectee",value:{inspectee:da},isCollapsed:!0,inspector:Fa})}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(Sc.TreeData);Sc.InspectionTree=Pe;Sc.InspectionTree=
Pe;Sc.InspectionTree=Pe;var Ue=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Va.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Va.RemoteInspectionTree?Va.RemoteInspectionTree:Va.RemoteInspectionTree=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(da){this.parentMap=new WeakMap;this.root=da.proxy;this.evalEnvironment=da.evalEnvironment;this.inspector=da.inspector;this.delegateId=da.delegateId}},{key:"getContextFor",value:function(da){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+da.uuid+'").value'}},{key:"dispose",value:function(){var da=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){return Fa.yield(da.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
da.delegateId+"']\n    ",da.evalEnvironment),0)})}},{key:"display",value:function(da){return da.keyString+": "+da.valueString}},{key:"collapse",value:function(da,Fa){var mb=this,xb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){if(1==yc.nextAddress)return(da.isCollapsed=Fa)||mb.isLeaf(da)?yc.return():da.children.length?yc.jumpTo(0):yc.yield(mb.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+da.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+mb.delegateId+'"]'}),3);xb=yc.yieldResult;da.children=xb.isError?[]:xb.value;yc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(da,Fa){var mb=this,xb,yc,xc,gd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return td.yield(mb.createRemoteContext(da,Fa),2);xb=td.yieldResult;
yc=xb.proxy;xc=xb.delegateId;gd=xb.evalEnvironment;return td.return(new mb({key:"inspectee",proxy:yc,delegateId:xc,evalEnvironment:gd,inspector:Fa}))})}},{key:"createRemoteContext",value:function(da,Fa){var mb=da.code,xb=da.evalEnvironment,yc=da.delegateId,xc,gd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return yc="lively://inspector-"+Fa.id,td.yield(xb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
mb+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+yc+'");\n    ',xb),2);xc=td.yieldResult;gd=xc.value;return td.return({delegateId:yc,evalEnvironment:xb,proxy:gd})})}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(Sc.InspectionTree);
Sc.RemoteInspectionTree=Ue;Sc.RemoteInspectionTree=Ue;Sc.RemoteInspectionTree=Ue;(function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Va.hasOwnProperty("InspectionNode")&&"function"===typeof Va.InspectionNode?Va.InspectionNode:Va.InspectionNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da){var Fa=
da.root,mb=da.priority,xb=da.key,yc=da.keyString,xc=da.value,gd=da.valueString,td=da.isCollapsed,ad=void 0===da.children?[]:da.children,nf=void 0===da.isSelected?!1:da.isSelected,mg=void 0===da.visible?!0:da.visible;this.partition=da.partition;this.priority=mb;this.key=xb;this.keyString=String(yc||xb);this.value=xc;this.valueString=gd||Sc.printValue(xc);this.isCollapsed=td;this.children=ad;this.isSelected=nf;this.visible=mg;this.root=Fa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(da){if(da.value&&da.value.isMorph)return new Sc.MorphNode(Object.assign({root:this.root},da));var Fa=da.key,mb=da.keyString,xb=this.value,yc=da.partition;yc&&(xb=yc.originalValue,mb=Fa);return new Sc.PropertyNode(Object.assign({},da,{keyString:mb,key:Fa,target:xb,partition:yc,root:this.root,spec:{}}))}},{key:"display",value:function(da){var Fa=this.keyString,mb=this.valueString;if(!this.interactive)return Fa+": "+mb;this._propertyWidget||
(this._propertyWidget=da.renderDraggableTreeLabel({value:Fa+": "+mb}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(da,Fa){Fa=void 0===Fa?null:Fa;return da.value&&da.value.isMorph?new Sc.MorphNode(Object.assign({root:Fa},da)):new Sc.InspectionNode(Object.assign({root:Fa},da))}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Va.hasOwnProperty("MorphNode")&&"function"===typeof Va.MorphNode?Va.MorphNode:Va.MorphNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,
[{key:Symbol.for("lively-instance-initialize"),value:function(da){Ib._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),this).call(this,da);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(da){var Fa=this.propertyInfo[da.key]||{};return da.value&&da.value.isMorph?new Sc.MorphNode(Object.assign({},da,{root:this.root})):new Sc.PropertyNode(Object.assign({},da,{root:this.root,target:this.target,
spec:Fa}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(Sc.InspectionNode);(function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Va.hasOwnProperty("PropertyNode")&&
"function"===typeof Va.PropertyNode?Va.PropertyNode:Va.PropertyNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da){Ib._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),this).call(this,da);var Fa=da.spec,mb=da.target;this.partition=da.partition;this.target=mb;this.spec=Fa;this.foldedNodes={}}},{key:"__deserialize__",
value:function(da,Fa){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(da){this._interactive=da}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(da){return this.isFoldable?this.getFoldedContext(da):Ib._get(Object.getPrototypeOf(Db.prototype),"getSubNode",this).call(this,da)}},{key:"getFoldedContext",
value:function(da){return this.foldedNodes[da.key]=new Sc.FoldedNode(Object.assign({},da,{root:this.root,target:this.target,foldableNode:this,spec:Sc.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(da,Fa){(Fa=void 0===Fa?!1:Fa)&&(this.target[this.key]=da);this.value=this.target[this.key];this.valueString=Sc.printValue(this.value);this.interactive&&(Fa||this._propertyWidget.highlight());if(this.isFoldable)for(var mb in this.foldedNodes)this.foldedNodes[mb].value=
this.value[mb],this.foldedNodes[mb].valueString=Sc.printValue(this.value[mb]),this.foldedNodes[mb]._propertyWidget&&Sc.signal(this.foldedNodes[mb]._propertyWidget,"update",this.value[mb])}},{key:"display",value:function(da){var Fa=this,mb=this._propertyWidget,xb=this.keyString,yc=this.valueString,xc=this.target,gd=this.value,td=this.spec;if(!(this.interactive||td.foldable&&Sc.isMultiValue(gd,td.foldable)))return da.renderPropertyControl({target:xc,keyString:xb,valueString:yc,tree:da.ui.propertyTree,
value:gd,spec:td,node:this,fastRender:!0});if(mb)return mb.keyString=xb,mb.valueString=yc,mb.isSelected=this.isSelected,mb.control&&(mb.control.isSelected=this.isSelected),mb;mb=this._propertyWidget=da.renderPropertyControl({target:xc,keyString:xb,valueString:yc,value:gd,spec:td,node:this,isSelected:this.isSelected,fontColor:da.ui.propertyTree.fontColor});this.isInternalProperty||td.readOnly||(Sc.connect(mb,"propertyValue",this,"refreshProperty",{updater:function(ad,nf){return ad(nf,!0)}}),Sc.connect(mb,
"openWidget",this.root,"onWidgetOpened",{converter:function(ad){return{widget:ad,node:Fa.sourceObj}}}));return mb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(Sc.InspectionNode);
(function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Va.hasOwnProperty("FoldedNode")&&"function"===typeof Va.FoldedNode?Va.FoldedNode:Va.FoldedNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da){Ib._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
da);this.foldableNode=da=da.foldableNode;this.foldedProp=da.key+Sc.string.capitalize(this.key)}},{key:"refreshProperty",value:function(da,Fa){Fa=void 0===Fa?!1:Fa;var mb={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(mb[this.key]=da,mb)),Fa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(Sc.PropertyNode);var Me=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Me.Color=zb;var Gf=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Db=Va.hasOwnProperty("DarkTheme")&&"function"===typeof Va.DarkTheme?Va.DarkTheme:Va.DarkTheme=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Ib(Db,Ha,[{key:"background",get:function(){return Me.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Me.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Me.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Me.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Me.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Me.Color.white,fontWeight:"bold",backgroundColor:Me.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Me.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Me.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],Va,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),Hf=Gf=Me.DarkTheme;Me.default=Gf;var Vb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Vb.inspect=Dc;Vb.remoteInspect=re;Vb.generateReferenceExpression=cd;Vb.onNumberDragStart=
function(Ha,Va){Va.initPos=Ha.position;Va.factorLabel=(new Vb.Tooltip({description:"1x"})).openInWorld(Ha.hand.position.addXY(10,10))};Vb.onNumberDrag=function(Ha,Va){var Db=Vb.getScaleAndOffset(Ha,Va),da=Db.scale;Db=Db.offset;Va.factorLabel.position=Ha.hand.position.addXY(10,10);Va.factorLabel.description=da+"x";return Vb.getCurrentValue(Db,da,Va)};Vb.onNumberDragEnd=function(Ha,Va){var Db=Vb.getScaleAndOffset(Ha,Va);Ha=Db.offset;Db=Db.scale;Va.factorLabel.softRemove();return Vb.getCurrentValue(Ha,
Db,Va)};Vb.getScaleAndOffset=function(Ha,Va){var Db=Ha.position.subPt(Va.initPos);Ha=Db.x;Va=Vb.num.roundTo(Math.exp(-Db.y/$world.height*6),.01)*Va.baseFactor;return{offset:Ha,scale:Va}};Vb.getCurrentValue=function(Ha,Va,Db){return Math.max(Db.min,Math.min(Db.max,Db.scrubbedValue+(Db.floatingPoint?Ha*Va:Math.round(Ha*Va))))};Vb.Color=zb;Vb.Rectangle=bc;Vb.rect=pe;Vb.pt=Sd;Vb.obj=ne;Vb.num=Hc;Vb.Path=Cc;Vb.arr=nc;Vb.promise=Ic;Vb.connect=Oc;Vb.disconnect=Sb;Vb.once=cc;Vb.Morph=Jc;Vb.Tooltip=dd;Vb.VerticalLayout=
Jd;Vb.GridLayout=Kd;Vb.HorizontalLayout=Hb;Vb.morph=Vc;Vb.CustomLayout=Bb;Vb.Label=Mb;Vb.Icon=Na;Vb.StyleSheet=Yc;Vb.config=Ua;Vb.Tree=Oa;Vb.LoadingIndicator=Ia;Vb.DropDownList=eb;Vb.DropDownSelector=cb;Vb.SearchField=ob;Vb.LabeledCheckBox=Zb;Vb.MorphHighlighter=pa;Vb.InteractiveMorphSelector=Ja;Vb.printValue=Je;Vb.RemoteInspectionTree=Ue;Vb.InspectionTree=Pe;Vb.isMultiValue=Zd;Vb.valueWidgets=X;Vb.popovers=ua;Vb.DarkTheme=Hf;Vb.DefaultTheme=Xa;Vb.syncEval=mc;Vb.inspectorCommands=[{name:"focus codeEditor",
exec:function(Ha){Ha.get("codeEditor").show();Ha.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ha){Ha.get("propertyTree").show();Ha.get("propertyTree").focus();return!0}}];(function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Va.hasOwnProperty("DraggedProp")&&"function"===typeof Va.DraggedProp?Va.DraggedProp:Va.DraggedProp=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ib(Db,Ha,[{key:"applyToTarget",value:function(da){var Fa=this.currentTarget,mb=this.control;this.remove();Vb.MorphHighlighter.removeHighlighters(da.world);if(Fa)if(Fa.isText&&"js"===Fa.editorModeName){var xb=Fa.evalEnvironment.context;da=Fa.textPositionFromPoint(Fa.localize(da.position));xb=Vb.generateReferenceExpression(this.sourceObject,{fromMorph:xb});mb.keyString&&(xb+="."+mb.keyString);Fa.insertTextAndSelect(xb,da);Fa.focus()}else"propertyValue"in mb&&(Fa[mb.keyString]=mb.propertyValue)}},
{key:"update",value:function(da){da=da.hand.globalPosition;var Fa=this.morphBeneath(da);if(Fa){for(Fa==this.morphHighlighter&&(Fa=Fa.morphBeneath(da));[Fa].concat($jscomp.arrayFromIterable(Fa.ownerChain())).find(function(mb){return!mb.visible});)Fa=Fa.morphBeneath(da);if(Fa!=this.currentTarget){this.currentTarget=Fa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Fa.isWorld)return;this.morphHighlighter=Vb.MorphHighlighter.for($world,Fa);this.morphHighlighter.show()}this.position=da}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Vb.Color.rgb(169,204,227)},fill:{defaultValue:Vb.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var da=this.control;if(!da)return this.submorphs=[];this.height=22;this.submorphs=[da];da.top=0;da.fontSize=14;"function"===typeof da.relayout&&
da.relayout();this.width=da.width+20;this.adjustOrigin(Vb.pt(10,10))}}}}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3714})})(Vb.Morph);(function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Va.hasOwnProperty("DraggableTreeLabel")&&"function"===
typeof Va.DraggableTreeLabel?Va.DraggableTreeLabel:Va.DraggableTreeLabel=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(da){this.draggedProp=new Vb.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Vb.connect(da.hand,"update",this.draggedProp,"update")}},
{key:"onDrag",value:function(da){}},{key:"onDragEnd",value:function(da){Vb.disconnect(da.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(da)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Vb.config.codeEditor.defaultStyle.fontFamily},
fill:{defaultValue:Vb.Color.transparent},padding:{defaultValue:Vb.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(da){this.setProperty("isSelected",da);da?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=da)}}}}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3716,end:5055})})(Vb.Label);Pe=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Va.hasOwnProperty("PropertyControl")&&"function"===typeof Va.PropertyControl?Va.PropertyControl:Va.PropertyControl=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(da,Fa,mb){da.control=new Vb.DropDownSelector({opacity:.8,fill:Vb.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Fa,padding:0,values:mb});Vb.connect(da.control,"update",da,"propertyValue",{updater:function(xb,yc){this.targetObj.propertyValue!=yc&&xb(yc)}});Vb.connect(da,"update",da.control,"selectedValue",{updater:function(xb,yc){yc=yc&&yc.valueOf?yc.valueOf():yc;this.targetObj.propertyValue!=yc&&xb(yc)}});return da}},
{key:"toggleMultiValuePlaceholder",value:function(da){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:Vb.Color.transparent,layout:new Vb.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:Vb.arr.range(0,2).map(function(Fa){return{type:"ellipse",fill:Vb.Color.gray.withA(.5),reactsToPointer:!1,extent:Vb.pt(7,7)}})});da?(Vb.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),
this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(Vb.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(da){this.foldableProperties&&this.toggleMultiValuePlaceholder(Vb.isMultiValue(da,this.foldableProperties))}},{key:"asFoldable",value:function(da){this.foldableProperties=da;Vb.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();
this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var da=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});
da.isLayoutable=!1;da.fontWeight="bold";da.fontColor=Vb.Color.orange;da.reactsToPointer=!1;da.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(da){this.submorphs=[da]}},layout:{initialize:function(){this.layout=new Vb.CustomLayout({relayout:function(da){da.relayout()}})}},
submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(da){return(da=da.value)&&(da.isColor||da.isGradient)?"Color":da&&da.isPoint?"Point":Vb.obj.isBoolean(da)?"Boolean":Vb.obj.isNumber(da)?"Number":Vb.obj.isString(da)?"String":da&&da.isRectangle?"Rectangle":!1}},{key:"render",value:function(da){da.spec.type||(da.spec=Object.assign({},da.spec,{type:this.inferType(da)}));switch(da.spec.type){case "Color":var Fa=this.renderColorControl(da);
break;case "ColorGradient":Fa=this.renderColorControl(Object.assign({},da,{gradientEnabled:!0}));break;case "Number":Fa=this.renderNumberControl(da);break;case "String":Fa=this.renderStringControl(da);break;case "RichText":Fa=this.renderStringControl(da);break;case "Layout":Fa=this.renderLayoutControl(da);break;case "Enum":Fa=this.renderEnumControl(da);break;case "Shadow":Fa=this.renderShadowControl(da);break;case "Point":Fa=this.renderPointControl(da);break;case "Rectangle":Fa=this.renderRectangleControl(da);
break;case "Boolean":Fa=this.renderBooleanControl(da);break;default:Fa=this.renderItSomehow(da)}Fa.control&&(Vb.connect(Fa.control,"openWidget",Fa,"openWidget"),Fa.toggleFoldableValue(da.value));return Fa}},{key:"baseControl",value:function(da){var Fa=da.spec;da=new this({keyString:da.keyString,valueString:da.valueString,isSelected:!1,propertyValue:da.value});Fa.foldable&&da.asFoldable(Fa.foldable);return da}},{key:"renderGrabbableKey",value:function(da){var Fa=this,mb=da.target;return[da.keyString+
":",{nativeCursor:"-webkit-grab",onDragStart:function(xb){xb.state.draggedProp=new Vb.DraggedProp({sourceObject:mb,control:Fa.baseControl(da)});xb.state.draggedProp.openInWorld();Vb.connect(xb.hand,"update",xb.state.draggedProp,"update")},onDrag:function(xb){},onDragEnd:function(xb){Vb.disconnect(xb.hand,"update",xb.state.draggedProp,"update");xb.state.draggedProp.applyToTarget(xb)}}]}},{key:"renderEnumControl",value:function(da){var Fa=da.value,mb=da.spec.values,xb=da.keyString,yc=da.target,xc=da.node,
gd=function(td,ad){return $jscomp.asyncExecutePromiseGeneratorProgram(function(nf){yc.world().openWorldMenu(td,mb.map(function(mg){return{string:mg.toString(),action:function(){yc[xb]=mg;xc.rerender()}}}));nf.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+(Fa?Fa.valueOf?Fa.valueOf():Fa:"Not set"),{nativeCursor:"pointer",onMouseDown:gd}],$jscomp.arrayFromIterable(Vb.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:gd})))}},
{key:"renderStringControl",value:function(da){var Fa=da.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+(200<Fa.length?Fa.slice(0,20)+"...":Fa),{fontColor:Vb.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(da){var Fa=da.value,mb=da.keyString,xb=da.valueString,yc=da.target,xc=da.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+xb,{fontColor:Vb.Color.black,nativeCursor:"pointer",onMouseDown:function(gd){var td;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){if(1==ad.nextAddress)return td=new Vb.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:Fa}),td.relayout(),ad.yield(td.fadeIntoWorld(gd.positionIn(yc.world())),2);Vb.connect(td,"rectangle",function(nf){yc[mb]=nf;xc.rerender()});ad.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(da){var Fa=da.value,mb=da.keyString,xb=da.valueString,yc=da.target,xc=da.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),
[" "+xb,{nativeCursor:"pointer",fontColor:Fa?Vb.Color.green:Vb.Color.red,onMouseDown:function(gd){yc[mb]=!yc[mb];xc.rerender()}}])}},{key:"renderNumberControl",value:function(da){var Fa=da.value,mb=da.spec,xb=da.keyString,yc=da.valueString,xc=da.node,gd=da.target,td=da.tree,ad=void 0===xc._numberControls?new Ng:xc._numberControls,nf=$jscomp.makeIterator(ad.submorphs),mg=nf.next().value,Yf=nf.next().value;ad.fontColor=td.fontColor;var of=xc._numberControls=ad;"max"in mb&&"min"in mb&&-Infinity!=mb.min&&
Infinity!=mb.max?(of.baseFactor=(mb.max-mb.min)/100,of.floatingPoint=mb.isFloat,of.max=mb.max,of.min=mb.min):(of.floatingPoint=mb.isFloat,of.baseFactor=.5,of.min=void 0!=mb.min?mb.min:-Infinity,of.max=void 0!=mb.max?mb.max:Infinity);var ui=Vb.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),$jscomp.arrayFromIterable(xc._inputMorph?[xc._inputMorph,{}]:[" "+(void 0!=Fa&&(Fa.valueOf?Fa.valueOf():Fa).toFixed(mb.isFloat?
3:0))+" ",{fontColor:ui,onMouseUp:function(Ph){xc._inputMorph=Vb.morph({type:"input",fill:null,fontColor:ui,fontFamily:"IBM Plex Mono",fontSize:14,padding:Vb.rect(8,2,-6,2),height:23,cursorColor:Vb.Color.white,value:Fa.valueOf?Fa.valueOf():yc});gd[xb]=Fa;xc._inputMorph.focus();Vb.once(xc._inputMorph,"inputAccepted",function(Pj){delete xc._inputMorph;gd[xb]=mb.isFloat?Number.parseFloat(Pj):Number.parseInt(Pj);xc.rerender()});Vb.once(xc._inputMorph,"onBlur",function(Pj){xc._inputMorph&&(delete xc._inputMorph,
gd[xb]=Fa,xc.rerender())});xc.rerender()},onDragStart:function(Ph){of.scrubbedValue=Fa;Vb.onNumberDragStart(Ph,of)},onDrag:function(Ph){gd[xb]=Vb.onNumberDrag(Ph,of);xc.rerender()},onDragEnd:function(Ph){return Vb.onNumberDragEnd(Ph,of)}},ad,{onMouseUp:function(){mg.fill=Yf.fill=null},onMouseDown:function(Ph){if(Ph.targetMorph===mg){mg.fill=Vb.Color.white.withA(.2);if("max"in mb&&gd[xb]>=mb.max)return;gd[xb]+=1}if(Ph.targetMorph===Yf){Yf.fill=Vb.Color.white.withA(.2);if("min"in mb&&gd[xb]<=mb.min)return;
--gd[xb]}xc.rerender()}}]))}},{key:"renderShadowControl",value:function(da){var Fa=da.keyString,mb=da.value,xb=da.target,yc=da.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[""+(mb?mb.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(xc){var gd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return gd=new Vb.popovers.ShadowPopover({shadowValue:xb[Fa],hasFixedPosition:!0}),td.yield(gd.fadeIntoWorld(xc.positionIn(xb.world())),
2);Vb.connect(gd,"shadowValue",function(ad){xb[Fa]=ad;yc.rerender()});td.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(da){var Fa=da.keyString,mb=da.value,xb=da.target,yc=da.node,xc=Vb.valueWidgets.NumberWidget.properties.fontColor.defaultValue,gd={nativeCursor:"pointer",onMouseDown:function(td){var ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nf){if(1==nf.nextAddress)return ad=new Vb.popovers.PointPopover({pointValue:xb[Fa],hasFixedPosition:!0}),nf.yield(ad.fadeIntoWorld(td.positionIn(xb.world())),
2);Vb.connect(ad,"pointValue",function(mg){xb[Fa]=mg;yc.rerender()});nf.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" pt(",Object.assign({},gd),""+mb.x.toFixed(),Object.assign({fontColor:xc},gd),",",Object.assign({},gd),""+mb.y.toFixed(),Object.assign({fontColor:xc},gd),")",Object.assign({},gd)])}},{key:"renderLayoutControl",value:function(da){var Fa=da.valueString,mb=da.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+(mb?
Fa:"No Layout"),{onMouseDown:function(xb){}}])}},{key:"renderColorControl",value:function(da){var Fa=da.node,mb=da.gradientEnabled,xb=da.valueString,yc=da.keyString,xc=da.value,gd=da.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[Vb.morph({fill:xc.valueOf?xc.valueOf():xc,extent:Vb.pt(15,15),borderColor:Vb.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(xc?xc.valueOf?xc.valueOf():xb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(td){var ad;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(nf){if(1==nf.nextAddress)return ad=new Vb.popovers.FillPopover({hasFixedPosition:!0,handleMorph:gd,fillValue:xc,title:"Fill Control",gradientEnabled:mb}),nf.yield(ad.fadeIntoWorld(td.positionIn(gd.world())),2);Vb.connect(ad,"fillValue",function(mg){gd[yc]=mg;Fa.rerender()});nf.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(da){var Fa=da.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+Fa,
{}])}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5064,end:20370})}(Vb.DraggableTreeLabel);Vb.PropertyControl=Pe;Vb.PropertyControl=Pe;Vb.PropertyControl=Pe;Vb.inspect=Dc;Vb.inspect=Dc;Vb.remoteInspect=re;Vb.remoteInspect=re;Vb.generateReferenceExpression=cd;Vb.generateReferenceExpression=
cd;var Ng=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Va.hasOwnProperty("NumberControls")&&"function"===typeof Va.NumberControls?Va.NumberControls:Va.NumberControls=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=
new Vb.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Vb.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(da){this.submorphs.map(function(Fa){return Fa.fontColor=da})}},submorphs:{initialize:function(){this.submorphs=[Vb.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Vb.rect(5,2,0,-6),fontSize:12}),Vb.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Vb.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",
fontSize:12})]}}}}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23043,end:24088})}(Vb.Morph);(function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Va.hasOwnProperty("PropertyTree")&&"function"===typeof Va.PropertyTree?Va.PropertyTree:Va.PropertyTree=
function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:"onDrag",value:function(da){this._onDragHandler&&this._onDragHandler(da)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25253,end:25364})})(Vb.Tree);Pe=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Va.hasOwnProperty("Inspector")&&"function"===typeof Va.Inspector?Va.Inspector:Va.Inspector=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();
this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(da){}},{key:"__after_deserialize__",value:function(da,Fa,mb){var xb=this,yc=new Vb.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Vb.InspectionTree.forObject(null,this)}));this.addMorph(yc,this.getSubmorphNamed("terminal toggler"));Ib._get(Object.getPrototypeOf(Db.prototype),"__after_deserialize__",this).call(this,da,Fa,mb);!this.isComponent&&this.master.whenApplied().then(function(){xb.layout.col(0).row(1).group.morph=
yc;xb.targetObject&&(xb.targetObject=xb.targetObject)})}},{key:"__additionally_serialize__",value:function(da,Fa,mb,xb){da=da.props.submorphs.value;for(Fa=da.length;Fa--;)mb.refForId(da[Fa].id).realObj==this.ui.propertyTree&&Vb.arr.removeAt(da,Fa)}},{key:"renderDraggableTreeLabel",value:function(da){return new Vb.DraggableTreeLabel(da)}},{key:"renderPropertyControl",value:function(da){return Vb.PropertyControl.render(da)}},{key:"onLoad",value:function(){var da=this.ui,Fa=da.codeEditor,mb=da.thisBindingSelector,
xb=da.propertyTree;Fa.changeEditorMode("js").then(function(){return Fa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==mb.selection?Fa.owner.selectedContext:Fa.owner.targetObject},get systemInterface(){return Vb.Path("treeData.systemInterface").get(xb)},format:"esm"}}).catch(function(yc){return $world.logError(yc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(da){Ib._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,da);da=this.ui;var Fa=da.targetPicker,mb=da.propertyTree,xb=da.resizer,yc=da.terminalToggler,xc=da.unknowns,gd=da.internals,td=da.searchField,ad=da.codeEditor,nf=da.fixImportButton,mg=da.thisBindingSelector;ad.changeEditorMode("js").then(function(){return ad.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==mg.selection?ad.owner.selectedContext:ad.owner.targetObject},get systemInterface(){return mb.treeData.systemInterface},format:"esm"}}).catch(function(Yf){return $world.logError(Yf)});
Vb.connect(Fa,"onMouseDown",this,"selectTarget");Vb.connect(mb,"onScroll",this,"repositionOpenWidget");Vb.connect(xb,"onDrag",this,"adjustProportions");Vb.connect(yc,"onMouseDown",this,"toggleCodeEditor");Vb.connect(xc,"trigger",this,"filterProperties");Vb.connect(gd,"trigger",this,"filterProperties");Vb.connect(td,"searchInput",this,"filterProperties");Vb.connect(mb,"nodeCollapseChanged",this,"filterProperties");Vb.connect(this,"extent",this,"relayout");Vb.connect(mg,"selection",this,"bindCodeEditorThis");
Vb.connect(nf,"fire",ad,"execCommand",{updater:function(Yf){return Yf("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var da=this.ui.propertyTree.selectedIndex-1,Fa=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Fa=this.ui.propertyTree.document.getLine(da).textAndAttributes.slice(0,4).concat(Fa.display(this));da=this.ui.propertyTree.lineRange(da,!1);this.ui.propertyTree.replace(da,Fa,!1,!1,
!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var da=Vb.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(da!=this.lastChange||this.lastSubmorphs!=Vb.printValue(this.targetObject&&
this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==da.prop&&this.repositionOpenWidget(),this.lastChange=da,this.lastSubmorphs=Vb.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var da;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Fa){Fa=Fa.node;Fa.target&&(da=Fa.foldableNode?Fa.target[Fa.foldableNode.key][Fa.key]:Fa.target[Fa.key],
!Vb.obj.equals(da,Fa.value)&&Fa.refreshProperty&&Fa.refreshProperty(da))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(da,Fa){Fa=void 0===Fa?!1:Fa;var mb=this,xb,yc,xc,gd,td,ad,nf,mg,Yf,of,ui,Ph,Pj,gi,hl;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yg){switch(yg.nextAddress){case 1:if(!mb.isUpdating()){yg.jumpTo(2);break}return yg.yield(mb.whenUpdated(),
2);case 2:xb=Vb.promise.deferred();yc=xb.promise;xc=!!mb.target;mb.updateInProgress=yc;yg.setCatchFinallyBlocks(4);Fa&&(gd=Vb.LoadingIndicator.open("connecting to remote..."));if(!Fa){td=Vb.InspectionTree.forObject(da,mb);yg.jumpTo(6);break}return yg.yield(Vb.RemoteInspectionTree.forObject(da,mb),7);case 7:td=yg.yieldResult;case 6:return ad=td,nf=mb.ui.propertyTree,yg.yield(ad.collapse(ad.root,!1),8);case 8:if(!ad.root.children){yg.jumpTo(9);break}return yg.yield(ad.collapse(ad.root.children[0],!1),
9);case 9:if(mg=mb.originalTreeData&&mb.originalTreeData.diff(ad)){Yf=$jscomp.makeIterator(mg);for(of=Yf.next();!of.done;of=Yf.next())ui=of.value,Ph=$jscomp.makeIterator(ui),Pj=Ph.next().value,gi=Ph.next().value,Pj.refreshProperty(gi.value);yg.jumpTo(11);break}nf.treeData=ad;return yg.yield(mb.filterProperties(),12);case 12:if(!nf.treeData.root.isCollapsed){yg.jumpTo(13);break}return yg.yield(nf.onNodeCollapseChanged({node:ad.root,isCollapsed:!1}),14);case 14:nf.selectedIndex=1;case 13:return yg.yield(nf.execCommand("uncollapse selected node"),
11);case 11:mb.toggleWindowStyle(xc);gd&&gd.remove();yg.leaveTryBlock(5);break;case 4:hl=yg.enterCatchBlock(),mb.showError(hl);case 5:mb.startStepping(1E3,"refreshAllProperties"),mb.updateInProgress=null,yg.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(da){da=void 0===da?!0:da;var Fa=this,mb,xb,yc,xc,gd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return mb=300,xc=Fa.ui.codeEditor.pluginFind(function(ad){return ad.runEval}),gd=Fa.getWindow(),td.yield(xc.runEval("System.get('@system-env').node"),
2);td.yieldResult.value?(yc=[].concat($jscomp.arrayFromIterable(Vb.arr.without(gd.styleClasses,"local")),["node"]),xb=Vb.DarkTheme.instance):(yc=["local"].concat($jscomp.arrayFromIterable(gd?Vb.arr.without(gd.styleClasses,"node"):[])),xb=Vb.DefaultTheme.instance);xc.theme=xb;da?(gd&&gd.animate({duration:mb,styleClasses:yc}),Fa.ui.codeEditor.animate({fill:xb.background,duration:mb})):gd&&(gd.styleClasses=yc);Fa.ui.codeEditor.textString=Fa.ui.codeEditor.textString;xc.highlight();td.jumpToEnd()})}},
{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var da=this,Fa=Object.assign({type:"text",borderWidth:1,borderColor:Vb.Color.gray,lineWrapping:"by-chars"},Vb.config.codeEditor.defaultStyle,{textString:""}),mb=Vb.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Vb.rect(0,0,this.width,30);
var xb=new Vb.SearchField({styleClasses:["idle"],name:"searchField"});mb[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[xb,{type:"button",name:"targetPicker",padding:Vb.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Vb.Icon.textAttribute("crosshairs")},new Vb.LabeledCheckBox({label:"Internals",name:"internals"}),new Vb.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Vb.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:Vb.InspectionTree.forObject(null,this)})),Vb.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},Fa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Vb.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(mb),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(mb),
[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){da.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var da=this,Fa,mb,xb,yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){switch(xc.nextAddress){case 1:if(da.env.eventDispatcher.isKeyPressed("Shift"))return mb=$jscomp,xb=mb.makeIterator,xc.yield($world.execCommand("select morph",
{justReturn:!0}),5);da.toggleSelectionInstructions(!0);return xc.yield(Vb.InteractiveMorphSelector.selectMorph(),4);case 4:Fa=xc.yieldResult;da.toggleSelectionInstructions(!1);xc.jumpTo(3);break;case 5:yc=xb.call(mb,xc.yieldResult),Fa=yc.next().value;case 3:Fa&&(da.targetObject=Fa),xc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(da){if(da&&!this.instructionWidget){var Fa=Vb.morph({type:"label",name:"escapeKey",value:"esc"});Fa.whenRendered().then(function(){return Fa.fit()});
this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},Fa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",
value:function(da){da=da.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;da.epiMorph=!0;this.openWidget=da;Vb.once(da,"close",this,"closeOpenWidget");Vb.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var da=this.ui.propertyTree,Fa=da.textLayout.boundsFor(da,{column:0,row:da.selectedIndex-1});Fa=da.worldPoint(Vb.pt(Fa.x,Fa.y+Fa.height/2)).addPt(da.scroll.negated());da=da.globalBounds();
Fa.x=this.globalBounds().center().x;Fa.y<da.top()?Fa=da.topCenter():da.bottom()-20<Fa.y&&(Fa=da.bottomCenter().addXY(0,-20));return Fa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(da){this.layout.row(1).height+=da.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(da){if(da!==
this.isEditorVisible()){var Fa=this.extent,mb=this.layout,xb=this.ui,yc=xb.terminalToggler,xc=xb.codeEditor,gd=xb.thisBindingSelector;xb=xb.fixImportButton;mb.disable();da?(yc.fontColor=Vb.Color.rgbHex("00e0ff"),mb.row(3).height=this.codeEditorHeight||180,mb.row(2).height=5,xb.animate({visible:!0,duration:200}),gd.animate({visible:!0,duration:200})):(this.codeEditorHeight=mb.row(3).height,yc.fontColor=Vb.Color.white,mb.row(3).height=mb.row(2).height=0,xb.animate({visible:!1,duration:200}),gd.animate({visible:!1,
duration:200}));this.extent=Fa;mb.enable({duration:200});this.relayout({duration:200});xc.focus();xc.animate({opacity:da?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var da=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){da.makeEditorVisible(!da.isEditorVisible());Fa.jumpToEnd()})}},{key:"filterProperties",value:function(){var da=this,Fa,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress)return Fa=da.ui.searchField,mb=da.ui.propertyTree,
da.originalTreeData||(da.originalTreeData=mb.treeData),Vb.disconnect(mb.treeData,"onWidgetOpened",da,"onWidgetOpened"),xb.yield(mb.treeData.filter({maxDepth:2,showUnknown:da.ui.unknowns.checked,showInternal:da.ui.internals.checked,iterator:function(yc){return Fa.matches(yc.key)}}),2);mb.update();Vb.connect(mb.treeData,"onWidgetOpened",da,"onWidgetOpened");xb.jumpToEnd()})}},{key:"relayout",value:function(da){da=void 0===da?{}:da;var Fa=this,mb,xb,yc,xc,gd,td,ad,nf,mg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yf){Fa.layout&&
Fa.layout.forceLayout();mb=Fa;xb=mb.ui;yc=xb.fixImportButton;xc=xb.terminalToggler;gd=xb.propertyTree;td=xb.thisBindingSelector;ad=gd.bounds().insetBy(5).bottomLeft();nf=gd.bounds().insetBy(5).bottomRight();mg=nf.subXY(yc.width+10,0);td.width=115;td.listMorph.itemHeight=20;da.duration?(xc.animate(Object.assign({bottomLeft:ad},da)),yc.animate(Object.assign({bottomRight:nf},da)),td.animate(Object.assign({bottomRight:mg},da))):(xc.bottomLeft=ad,yc.bottomRight=nf,td.bottomRight=mg);Yf.jumpToEnd()})}},
{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Ib._get(Object.getPrototypeOf(Db.prototype),"keybindings",this))}},{key:"commands",get:function(){return Vb.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(da){if(System._testsRunning)return console.log(da.targetObject);
da=new this(da);da.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return da}},{key:"properties",get:function(){return{extent:{defaultValue:Vb.pt(400,500)},fill:{defaultValue:Vb.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(da){this.setProperty("remoteTarget",da);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(da,!0))}},targetObject:{after:["submorphs"],set:function(da){this._serializableTarget=
da&&da.isMorph?da.id:da;this.setProperty("targetObject",da);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(da))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var da=this.ui.propertyTree,Fa=da.treeData;return Fa.getContextFor(da.selectedNode||Fa.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),
fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},
treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Vb.Color.gray,fontSize:14,fontFamily:Vb.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:25381,end:45915})}(Vb.Morph);Pe=Vb.Inspector;Ue=Ba("I",Pe);Vb.default=Pe;var pf=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");pf.Inspector=Ue;pf.string=qd;pf.Morph=Jc;pf.pt=Sd;pf.Color=zb;Pe=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ha,Va,Db){Db=void 0===Db?1:Db;var da,Fa,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){switch(xb.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),
xb.setCatchFinallyBlocks(2),Va=Object.assign({},Va,{logDoit:!0,inspect:!0,inspectDepth:Db}),xb.yield(Ha.doEval(void 0,Va),4);case 4:da=xb.yieldResult;Fa=da.error?da.error:da.isError?da.value:null;xb.leaveTryBlock(3);break;case 2:Fa=mb=xb.enterCatchBlock();case 3:return Fa?Ha.showError(Fa):Ha.setStatusMessage(pf.string.truncate(da.value,1E3)),xb.return(da)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ha,Va){var Db,da,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){switch(mb.nextAddress){case 1:return mb.setCatchFinallyBlocks(2),
mb.yield(Ha.doEval({start:{row:0,column:0},end:Ha.documentEndPosition},Object.assign({},Va,{logDoit:!0})),4);case 4:Db=mb.yieldResult;da=Db.error?Db.error:Db.isError?Db.value:null;mb.leaveTryBlock(3);break;case 2:da=Fa=mb.enterCatchBlock();case 3:return da?Ha.showError(da):Ha.setStatusMessage(String(Db.value)),mb.return(Db)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ha,Va){var Db,da,Fa,mb,xb,yc,xc,gd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){switch(td.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),
td.setCatchFinallyBlocks(2),Va=Object.assign({},Va,{asString:!1,logDoit:!0}),td.yield(Ha.doEval(void 0,Va),4);case 4:Db=td.yieldResult;da=Db.error?Db.error:Db.isError?Db.value:null;td.leaveTryBlock(3);break;case 2:da=Fa=td.enterCatchBlock();case 3:Ha.selection.collapseToEnd();if(mb=Db.value&&Db.value.isColor)return Ha.selection.text=String(Db.value),xb=new pf.Morph({fill:pf.Color.transparent,extent:pf.pt(Ha.fontSize+2,Ha.fontSize+2),submorphs:[{fill:Db.value,center:pf.pt(Ha.fontSize+2,Ha.fontSize+
2).scaleBy(.5)}]}),yc=Ha.selection.start,xc=yc.column,gd=yc.row,Ha.insertText([xb,{}],Ha.selection.start),Ha.selection.start={column:xc,row:gd},Ha.focus(),td.return(Db);Ha.insertTextAndSelect(da?String(da)+(da.stack?"\n"+da.stack:""):String(Db.value));Ha.focus();return td.return(Db)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ha,Va){var Db,da,Fa,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){switch(xb.nextAddress){case 1:Ha.maybeSelectCommentOrLine();
da=Ha.textInRange(Ha.selection);Fa=Ha.evalEnvironment||{};mb=Ha.pluginFind(function(yc){return yc.isEditorPlugin&&"function"===typeof yc.runEval});Fa.systemInterface||(Fa.systemInterface=mb.systemInterface(Va));if("local"!==Fa.systemInterface.name){xb.jumpTo(2);break}xb.setCatchFinallyBlocks(3);return xb.yield(Ha.doEval(void 0,Va),5);case 5:Db=xb.yieldResult;da=Db.value;xb.leaveTryBlock(2);break;case 3:xb.enterCatchBlock();case 2:return Ha.world().execCommand("open object editor",{target:da,evalEnvironment:Fa}),
xb.return(Db)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Ha,Va){var Db,da,Fa,mb,xb,yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){switch(xc.nextAddress){case 1:Ha.maybeSelectCommentOrLine();Fa=Ha.textInRange(Ha.selection);mb=Ha.evalEnvironment||{};xb=Ha.pluginFind(function(gd){return gd.isEditorPlugin&&"function"===typeof gd.runEval});mb.systemInterface||(mb.systemInterface=xb.systemInterface(Va));
if("local"!==mb.systemInterface.name){pf.Inspector.openInWindow({remoteTarget:{code:Fa,evalEnvironment:mb}});xc.jumpTo(2);break}xc.setCatchFinallyBlocks(3);return xc.yield(Ha.doEval(void 0,Va),5);case 5:Db=xc.yieldResult;da=Db.error?Db.error:Db.isError?Db.value:null;Fa=Db.value;xc.leaveTryBlock(4);break;case 3:da=yc=xc.enterCatchBlock();case 4:pf.Inspector.openInWindow({targetObject:da||Fa});case 2:return xc.return(Db)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(Ha,Va,Db){Db=void 0===Db?1:Db;var da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),Fa.setCatchFinallyBlocks(2),Va=Object.assign({},Va,{inspect:!0,inspectDepth:Db,logDoit:!0}),Fa.yield(Ha.doEval(void 0,Va),4);case 4:da=Fa.yieldResult;Fa.leaveTryBlock(3);break;case 2:Fa.enterCatchBlock();case 3:return Ha.selection.collapseToEnd(),Ha.insertTextAndSelect(da.value),Fa.return(da)}})}}];pf.codeEvaluationCommands=
Pe;pf.codeEvaluationCommands=Pe;pf.codeEvaluationCommands=Pe;var tg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");tg.changeAttributeInSelectionOrMorph=function(Ha,Va,Db){var da=Ha.selection;Ha.keepPosAtSameScrollOffsetWhile(function(){da.isEmpty()?Ha[Va]="function"===typeof Db?Db(Ha[Va]):Db:(Ha.undoManager.group(),Ha.changeStyleProperty(Va,function(Fa){return"function"===typeof Db?Db(Fa):Db}),Ha.undoManager.group())})};Ue=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(Ha){var Va=Ha.fontSize;tg.changeAttributeInSelectionOrMorph(Ha,"fontSize",function(Db){Db=Db||Va;return Db+(18<=Db?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ha){var Va=Ha.fontSize;tg.changeAttributeInSelectionOrMorph(Ha,"fontSize",function(Db){Db=Db||Va;return Db-(18>=Db?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ha){var Va,Db,da,Fa,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress){Va=
["serif","sans-serif","monospace"];if(Db=localStorage["lively.morpic/text-change-font-additional-fonts"])Db=JSON.parse(Db),Va.push.apply(Va,$jscomp.arrayFromIterable(Db));Va.map(function(yc){return yc.toLowerCase()}).includes(Ha.fontFamily.toLowerCase())||(Va.push(Ha.fontFamily),Db=[].concat($jscomp.arrayFromIterable(Db||[]),[Ha.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Db));return xb.yield($world.editListPrompt("choose font",Va,{requester:Ha,preselect:Va.indexOf(Ha.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}da=xb.yieldResult;Fa=$jscomp.makeIterator(da.selections);if(mb=Fa.next().value)Ha.fontFamily=mb;return xb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ha,Va){Va=void 0===Va?{}:Va;var Db,da,Fa,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress){if(Va.hasOwnProperty("link"))return xb.jumpTo(2);da=Ha.selection;Fa=Ha.getStyleInRange(da);mb=Fa.link;return xb.yield(Ha.world().prompt("Set link",
{input:mb||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=xb.nextAddress&&(Db=xb.yieldResult,!Db))return xb.return();Ha.undoManager.group();Ha.setStyleInRange({link:Db||void 0},da);Ha.undoManager.group();xb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ha,Va){var Db,da,Fa,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress)return Db=Ha.selection,da=Ha.getStyleInRange(Db),Fa=da.doit,xb.yield(Ha.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:Ha,input:Fa?Fa.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ha.evalEnvForDoit(Fa||{})}),2);mb=xb.yieldResult;Ha.undoManager.group();mb?Ha.addTextAttribute({doit:{code:mb},nativeCursor:"pointer",textDecoration:"underline"},Db):Ha.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Db);Ha.undoManager.group();xb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ha,Va){Va=void 0===Va?{}:Va;Ha.undoManager.group();
Va=!Va.onlySelection&&Ha.selection.isEmpty()?Ha.documentRange:Ha.selection.range;Ha.setStyleInRange(null,Va);Ha.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ha){var Va,Db,da,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){if(1==mb.nextAddress)return mb.yield(System.import("lively.modules"),2);if(3!=mb.nextAddress)return Va=mb.yieldResult,Db=Va.module,mb.yield(Db("lively.ide/text/ui.js").load(),3);da=mb.yieldResult;Fa=da.RichTextControl;return mb.return(Fa.openFor(Ha))})}}];
tg.commands=Ue;tg.commands=Ue;tg.commands=Ue;var Ve=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");Ve.guessTextModeName=we;Ve.rangedToken=function(Ha,Va,Db,da,Fa){return{start:{row:Ha,column:Va},end:{row:Ha,column:Db},token:da,mode:Fa}};Ve.fun=Tb;Ve.arr=nc;Ve.connect=Oc;Ve.disconnect=Sb;Ve.DefaultTheme=Xa;Ve.tokenizeDocument=sb;Ve.modeInfo=hb;Ve.visitDocumentTokens=$c;Ve.getMode=Nb;Ve.completionCommands=P;Ve.multiSelectCommands=Lb;Ve.navCommands=Zc;Ve.codeCommands=ge;Ve.codeEvaluationCommands=
Pe;Ve.richTextCommands=Ue;Ve.Color=zb;Ve.Range=Ye;Ve.guessTextModeName=we;Ve.guessTextModeName=we;Xa=function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Db=Va.hasOwnProperty("EditorPlugin")&&"function"===typeof Va.EditorPlugin?Va.EditorPlugin:Va.EditorPlugin=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
Ve.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(da){var Fa=this;this.textMorph=da;Ve.connect(da,"textChange",this,"onTextChange");Ve.connect(da,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Fa.highlight()})}},
{key:"detach",value:function(da){Ve.disconnect(da,"textChange",this,"onTextChange");Ve.disconnect(da,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(da){this._ast=null;if(da){var Fa=this._tokenizerValidBefore;if("replace"===da.selector){var mb=da.args[0].start;da=mb.row;mb=mb.column}else mb=da=0;if(!Fa||da<Fa.row||da===Fa.row&&mb<Fa.column)da=Math.max(0,da),this._tokenizerValidBefore={row:da,
column:mb}}this.requestHighlight()}},{key:"requestHighlight",value:function(da){var Fa=this;(void 0===da?0:da)?this.highlight():Ve.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return Fa.highlight()})()}},{key:"highlight",value:function(){var da=this.textMorph,Fa=this.theme,mb=this.mode,xb=this._tokenizerValidBefore;if(Fa&&da&&da.document&&mb){da.fill=Fa.background;da.cursorColor=Fa.cursorColor||Ve.Color.black;var yc=da.viewState,xc={};xb=Ve.tokenizeDocument(mb,da.document,yc.firstVisibleRow,
yc.lastVisibleRow,xb);mb=xb.lines;xb=xb.tokens;if(mb.length){yc=mb[0].row;for(var gd=[],td=0;td<xb.length;yc++,td++)for(var ad=xb[td],nf=0;nf<ad.length;nf+=5){var mg=ad[nf],Yf=ad[nf+1],of=Fa[ad[nf+2]]||Fa.default;of&&gd.push({start:{row:yc,column:mg},end:{row:yc,column:Yf}},of)}da.embeddedMorphs.forEach(function(ui){var Ph=da.embeddedMorphMap.get(ui).anchor;xc[ui.id]=da.textAttributeAt(Ph.position)});da.setTextAttributesWithSortedRanges(gd);da.embeddedMorphs.forEach(function(ui){var Ph=da.embeddedMorphMap.get(ui).anchor;
Ph=Ve.Range.at(Ph.position);Ph.end.column+=1;da.replace(Ph,[ui,xc[ui.id]],!1)});this._tokenizerValidBefore={row:Ve.arr.last(mb).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},da,this)}}},{key:"visitTokensInRange",value:function(da,Fa){var mb=da.start,xb=da.end,yc=mb.row-1;Ve.visitDocumentTokens(this.mode,this.textMorph.document,mb.row,xb.row,null,function(xc){return yc++},function(xc,gd,td,ad,nf,mg,Yf){if(yc===mb.row&&0<mb.column){if(mb.column>=ad)return;td<mb.column&&mb.column<
ad&&(td=mb.column)}if(yc===xb.row){if(xb.column<=td)return;td<xb.column&&xb.column<ad&&(ad=xb.column)}Fa(xc,gd,yc,td,ad,nf,mg,Yf)})}},{key:"tokensInRange",value:function(da){var Fa=[];this.visitTokensInRange(da,function(mb,xb,yc,xc,gd,td,ad,nf){return Fa.push(Ve.rangedToken(yc,xc,gd,mb,nf))});return Fa}},{key:"tokensOfRow",value:function(da){var Fa=this.textMorph.getLine(da).length;return this.tokensInRange({start:{row:da,column:0},end:{row:da,column:Fa}})}},{key:"tokenAt",value:function(da){for(var Fa=
this.tokensOfRow(da.row),mb=Fa.length;mb--;){var xb=Fa[mb];if(xb.token&&xb.start.column<=da.column&&da.column<=xb.end.column)return xb}return null}},{key:"getCommands",value:function(da){return[].concat($jscomp.arrayFromIterable(da),$jscomp.arrayFromIterable(Ve.completionCommands),$jscomp.arrayFromIterable(Ve.multiSelectCommands),$jscomp.arrayFromIterable(Ve.navCommands),$jscomp.arrayFromIterable(Ve.codeCommands),$jscomp.arrayFromIterable(Ve.codeEvaluationCommands),$jscomp.arrayFromIterable(Ve.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var da=this.mode,Fa=da.lineComment,mb=da.blockCommentStart;da=da.blockCommentEnd;var xb={};Fa&&(xb.lineCommentStart=Fa);mb&&(xb.blockCommentStart=mb);da&&(xb.blockCommentEnd=da);return xb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(da,Fa,mb){var xb=this.textMorph,yc=da.row,xc=da.column;da=Fa[xc-1];Fa=Fa[xc];xb.selection.text="\n";xb.selection.collapseToEnd();
"{"===da&&"}"===Fa&&(xb.selection.text="\n"+" ".repeat(mb),xb.selection.collapse());xb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:yc+1,lastRow:yc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var da=this.textMorph,Fa=this.openPairs,mb=da.selection,xb=da.getLine(mb.end.row),
yc=xb[mb.end.column-1];xb=xb[mb.end.column];da.autoInsertPairs&&mb.isEmpty()&&yc in Fa&&xb===Fa[yc]&&(mb.growRight(1),mb.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(da){var Fa=this.openPairs,mb=this.closePairs,xb=this.textMorph,yc=xb.selection,xc=xb.autoInsertPairs&&da in Fa,gd=xb.autoInsertPairs&&da in mb;if(!xc&&!gd)return!1;var td=xb.getLine(yc.end.row)[yc.end.column];if(!yc.isEmpty()){if(!xc)return!1;mb=xb.undoManager.ensureNewGroup(xb);xb.insertText(Fa[da],yc.end);xb.insertText(da,
yc.start);xb.undoManager.group(mb);yc.growRight(-1);return!0}if(td in mb&&da===td)return yc.goRight(1),!0;if(gd&&!xc)return!1;mb=xb.undoManager.ensureNewGroup(xb);xb.insertText(da+Fa[da]);xb.undoManager.group(mb);yc.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Va,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);hb=Xa=Ve.EditorPlugin;P=Ba("C",function(Ha){var Va=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Db=Va.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Va.CodeMirrorEnabledEditorPlugin?Va.CodeMirrorEnabledEditorPlugin:Va.CodeMirrorEnabledEditorPlugin=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ib(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(){Ib._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(da){this.mode=this.codeMirrorMode(da);return Ib._get(Object.getPrototypeOf(Db.prototype),"attach",this).call(this,da)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",
value:function(da){return{indentWithTabs:!da.useSoftTabs,indentUnit:da.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(da){da=this.defaultCodeMirrorModeConfig(da);return Ve.getMode(da,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Va,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(Ve.EditorPlugin));Ve.CodeMirrorEnabledEditorPlugin=P;Ve.CodeMirrorEnabledEditorPlugin=P;Ve.CodeMirrorEnabledEditorPlugin=P;Ve.default=Xa;Xa=Object.freeze({__proto__:null,guessTextModeName:we,"default":hb,CodeMirrorEnabledEditorPlugin:P});Ba("e",Xa)}}});
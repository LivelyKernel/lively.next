System.register("./__root_module__-aefa9179.js kld-intersections ./user-ui-0f5aeda0.js ./index-d5ea568c.js ./index-3100fe37.js ./editor-plugin-14253833.js ./index-dd2e460a.js".split(" "),function(Da,Bb){var Qb,hc,ac,be,bd,Sd,ed,Mc;return{setters:[function(pd){Qb=pd.ai;hc=pd.ao;ac=pd.a3;be=pd.C;bd=pd.a6;Sd=pd.L;ed=pd.r;Mc=pd.as},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var pd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");pd.Morph=
Qb;pd.Icon=hc;pd.pt=ac;pd.Color=be;pd.arr=bd;pd.LoadingIndicator=Sd;pd.resource=ed;var Dd=function(ke){var Kd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),jd=Kd.hasOwnProperty("LivelyTopBar")&&"function"===typeof Kd.LivelyTopBar?Kd.LivelyTopBar:Kd.LivelyTopBar=function(cb){cb&&cb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Mc(jd,ke,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode=
"Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var cb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ab){if(1==Ab.nextAddress)return cb.isComponent?Ab.return():Ab.yield(cb.whenRendered(),2);document.body.style.background="black";cb.setEditMode("Halo");cb.getSubmorphNamed("fast load toggler").refresh();Ab.jumpToEnd()})}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=pd.pt(0,0));var cb=
this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;cb.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var cb=this;return Object.entries(this.shapeToIcon).map(function(Ab){Ab=$jscomp.makeIterator(Ab);var Yb=Ab.next().value,gc=Ab.next().value;Ab=gc.shortcut;gc=gc.args;return[[].concat($jscomp.arrayFromIterable(cb.currentShapeMode===Yb?[].concat($jscomp.arrayFromIterable(pd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),
$jscomp.arrayFromIterable(pd.Icon.textAttribute.apply(pd.Icon,$jscomp.arrayFromIterable(gc))),["   "+Yb+" ",{float:"none"},"      "+Ab,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){cb.currentShapeMode=Yb;cb.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var cb=this;return Object.entries(this.sideBarToIcon).map(function(Ab){Ab=$jscomp.makeIterator(Ab);var Yb=Ab.next().value;Ab=Ab.next().value.args;return[[].concat($jscomp.arrayFromIterable(cb.activeSideBars.includes(Yb)?
[].concat($jscomp.arrayFromIterable(pd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(pd.Icon.textAttribute.apply(pd.Icon,$jscomp.arrayFromIterable(Ab))),["   "+Yb+" ",{float:"none"}]),function(){return cb.openSideBar(Yb)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",
value:function(cb){"Hand"==this._currentEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(cb){Mc._get(Object.getPrototypeOf(jd.prototype),"onKeyDown",this).call(this,cb);if(cb.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!cb.isAltDown()){var Ab={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(cb.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=
Ab[cb.key];this.setEditMode("Shape");break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(cb){var Ab=this,Yb,gc,dd,Zd,Wb,oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lb){switch(Lb.nextAddress){case 1:Ab.activeSideBars.includes(cb)?pd.arr.remove(Ab.activeSideBars,cb):Ab.activeSideBars.push(cb);if("Scene Graph"!=cb){Lb.jumpTo(2);break}if(Ab.sideBar){Lb.jumpTo(3);break}Yb=pd.LoadingIndicator.open("loading side bar");gc=Ab;return Lb.yield(Bb.import("./scene graph side bar master-9570340d.js"),
5);case 5:if(!(dd=Lb.yieldResult)){Lb.jumpTo(6);break}return Lb.yield(pd.resource("part://SystemIDE/scene graph side bar master"),7);case 7:dd=Lb.yieldResult;case 6:return Lb.yield(dd.read(),4);case 4:return gc.sideBar=Lb.yieldResult,Ab.sideBar.hasFixedPosition=!0,Ab.sideBar.respondsToVisibleWindow=!0,Ab.sideBar.openInWorld(),Ab.sideBar.right=0,Lb.yield(Ab.sideBar.whenRendered(),8);case 8:Yb.remove();case 3:Ab.sideBar.toggle(Ab.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=
cb){Lb.jumpTo(0);break}if(Ab.stylingPalette){Lb.jumpTo(10);break}Zd=pd.LoadingIndicator.open("loading side bar");Wb=Ab;return Lb.yield(Bb.import("./styling side bar master-0d7ec966.js"),12);case 12:if(!(oc=Lb.yieldResult)){Lb.jumpTo(13);break}return Lb.yield(pd.resource("part://SystemIDE/styling side bar master"),14);case 14:oc=Lb.yieldResult;case 13:return Lb.yield(oc.read(),11);case 11:return Wb.stylingPalette=Lb.yieldResult,Ab.stylingPalette.collapseAll(),Ab.stylingPalette.hasFixedPosition=!0,
Ab.stylingPalette.respondsToVisibleWindow=!0,Ab.stylingPalette.openInWorld(),Ab.stylingPalette.left=Ab.world().right,Lb.yield(Ab.stylingPalette.whenRendered(),15);case 15:Zd.remove();case 10:Ab.stylingPalette.toggle(Ab.activeSideBars.includes("Styling Palette")),Lb.jumpToEnd()}})}},{key:"onMouseDown",value:function(cb){var Ab=this.get("select shape type"),Yb=this.get("shape mode button"),gc=this.get("side bar selector");cb.targetMorph==Ab&&(this.world().openWorldMenu(cb,this.getShapeMenuItems()).position=
Yb.globalBounds().bottomLeft().subPt(this.world().scroll));cb.targetMorph==Yb&&this.setEditMode("Shape");"text mode button"==cb.targetMorph.name&&this.setEditMode("Text");"hand mode button"==cb.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==cb.targetMorph.name&&this.setEditMode("Halo");"open component browser"==cb.targetMorph.name&&this.interactivelyLoadComponent();"load world button"==cb.targetMorph.name&&this.world().execCommand("load world");cb.targetMorph==gc&&(this.world().openWorldMenu(cb,
this.getSideBarMenuItems()).position=gc.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var cb=this,Ab,Yb,gc,dd,Zd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wb){if(1==Wb.nextAddress)return Ab=cb.get("open component browser"),Yb=cb.get("user flap"),gc=Yb.haloShadow,dd=Yb.haloColor,Zd=pd.Color.rgb(102,102,102),Ab.fontColor=dd,Ab.dropShadow=gc,Wb.yield(cb.world().execCommand("browse and load component"),2);Ab.dropShadow=!1;
Ab.fontColor=Zd;Wb.jumpToEnd()})}},{key:"setEditMode",value:function(cb,Ab){var Yb=this;Ab=void 0===Ab?!1:Ab;var gc=this.get("user flap"),dd=gc.haloShadow,Zd=gc.haloColor,Wb=pd.Color.rgb(102,102,102);Ab||(this._currentEditMode=cb);Ab=this.get("shape mode button");gc=this.get("text mode button");var oc=this.get("hand mode button"),Lb=this.get("halo mode button");[["Shape",Ab.submorphs],["Text",[gc]],["Hand",[oc]],["Halo",[Lb]]].forEach(function(Bc){var Sc=$jscomp.makeIterator(Bc);Bc=Sc.next().value;
Sc=Sc.next().value;"Shape"==cb?Yb.world().toggleShapeMode(!0,Yb.currentShapeMode):"Text"==cb?Yb.world().toggleShapeMode(!0,"Text"):Yb.world().toggleShapeMode(!1);Yb.world().showHaloPreviews("Halo"==cb);Bc==cb?Sc.forEach(function(Yc){Yc.dropShadow=dd;Yc.fontColor=Zd}):Sc.forEach(function(Yc){Yc.dropShadow=null;Yc.fontColor=Wb})})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],
set:function(cb){this.setProperty("currentShapeMode",cb);this.get("shape status icon").textAndAttributes=pd.Icon.textAttribute(this.shapeToIcon[cb].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},
Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],Kd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-154"}}},{start:328,end:9325})}(pd.Morph);Dd=pd.LivelyTopBar;pd.default=Dd}}});System.register("22",["./__root_module__-aefa9179.js","kld-intersections","./user-ui-0f5aeda0.js","./index-ea95c5b9.js"],function(){return{setters:[function(){},function(){},function(){},function(){}],execute:function(){}}});
System.register("./__root_module__-aa47e4cd.js kld-intersections ./user-ui-a3f53bac.js ./editor-plugin-0f37a49e.js ./index-f9b193f7.js ./index-b8a9cfe8.js ./index-72b2bf52.js".split(" "),function(Ca,ub){var Tb,lc,mc,Zd,id,ce,kd,$c;return{setters:[function(Cd){Tb=Cd.ag;lc=Cd.am;mc=Cd.a1;Zd=Cd.C;id=Cd.a4;ce=Cd.L;kd=Cd.r;$c=Cd.aq},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var Cd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");Cd.Morph=
Tb;Cd.Icon=lc;Cd.pt=mc;Cd.Color=Zd;Cd.arr=id;Cd.LoadingIndicator=ce;Cd.resource=kd;var Fd=function(pe){var Xd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),nd=Xd.hasOwnProperty("LivelyTopBar")&&"function"===typeof Xd.LivelyTopBar?Xd.LivelyTopBar:Xd.LivelyTopBar=function(eb){eb&&eb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return $c(nd,pe,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode=
"Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var eb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hb){if(1==Hb.nextAddress)return eb.isComponent?Hb.return():Hb.yield(eb.whenRendered(),2);document.body.style.background="black";eb.setEditMode("Halo");eb.getSubmorphNamed("fast load toggler").refresh();Hb.jumpToEnd()})}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=Cd.pt(0,0));var eb=
this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;eb.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var eb=this;return Object.entries(this.shapeToIcon).map(function(Hb){Hb=$jscomp.makeIterator(Hb);var Cc=Hb.next().value,qc=Hb.next().value;Hb=qc.shortcut;qc=qc.args;return[[].concat($jscomp.arrayFromIterable(eb.currentShapeMode===Cc?[].concat($jscomp.arrayFromIterable(Cd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),
$jscomp.arrayFromIterable(Cd.Icon.textAttribute.apply(Cd.Icon,$jscomp.arrayFromIterable(qc))),["   "+Cc+" ",{float:"none"},"      "+Hb,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){eb.currentShapeMode=Cc;eb.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var eb=this;return Object.entries(this.sideBarToIcon).map(function(Hb){Hb=$jscomp.makeIterator(Hb);var Cc=Hb.next().value;Hb=Hb.next().value.args;return[[].concat($jscomp.arrayFromIterable(eb.activeSideBars.includes(Cc)?
[].concat($jscomp.arrayFromIterable(Cd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(Cd.Icon.textAttribute.apply(Cd.Icon,$jscomp.arrayFromIterable(Hb))),["   "+Cc+" ",{float:"none"}]),function(){return eb.openSideBar(Cc)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",
value:function(eb){"Hand"==this._currentEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(eb){$c._get(Object.getPrototypeOf(nd.prototype),"onKeyDown",this).call(this,eb);if(eb.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!eb.isAltDown()){var Hb={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(eb.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=
Hb[eb.key];this.setEditMode("Shape");break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(eb){var Hb=this,Cc,qc,ld,wd,Xc,gd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bc){switch(bc.nextAddress){case 1:Hb.activeSideBars.includes(eb)?Cd.arr.remove(Hb.activeSideBars,eb):Hb.activeSideBars.push(eb);if("Scene Graph"!=eb){bc.jumpTo(2);break}if(Hb.sideBar){bc.jumpTo(3);break}Cc=Cd.LoadingIndicator.open("loading side bar");qc=Hb;return bc.yield(ub.import("./scene graph side bar master-d8f83bbe.js"),
5);case 5:if(!(ld=bc.yieldResult)){bc.jumpTo(6);break}return bc.yield(Cd.resource("part://SystemIDE/scene graph side bar master"),7);case 7:ld=bc.yieldResult;case 6:return bc.yield(ld.read(),4);case 4:return qc.sideBar=bc.yieldResult,Hb.sideBar.openInWorld(),Hb.sideBar.right=0,bc.yield(Hb.sideBar.whenRendered(),8);case 8:Cc.remove();case 3:Hb.sideBar.toggle(Hb.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=eb){bc.jumpTo(0);break}if(Hb.stylingPalette){bc.jumpTo(10);break}wd=Cd.LoadingIndicator.open("loading side bar");
Xc=Hb;return bc.yield(ub.import("./styling side bar master-ca7ada6b.js"),12);case 12:if(!(gd=bc.yieldResult)){bc.jumpTo(13);break}return bc.yield(Cd.resource("part://SystemIDE/styling side bar master"),14);case 14:gd=bc.yieldResult;case 13:return bc.yield(gd.read(),11);case 11:return Xc.stylingPalette=bc.yieldResult,Hb.stylingPalette.openInWorld(),Hb.stylingPalette.left=Hb.world().right,bc.yield(Hb.stylingPalette.whenRendered(),15);case 15:wd.remove();case 10:Hb.stylingPalette.toggle(Hb.activeSideBars.includes("Styling Palette")),
bc.jumpToEnd()}})}},{key:"onMouseDown",value:function(eb){var Hb=this.get("select shape type"),Cc=this.get("shape mode button"),qc=this.get("side bar selector");eb.targetMorph==Hb&&(this.world().openWorldMenu(eb,this.getShapeMenuItems()).position=Cc.globalBounds().bottomLeft().subPt(this.world().scroll));eb.targetMorph==Cc&&this.setEditMode("Shape");"text mode button"==eb.targetMorph.name&&this.setEditMode("Text");"hand mode button"==eb.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==
eb.targetMorph.name&&this.setEditMode("Halo");"open component browser"==eb.targetMorph.name&&this.interactivelyLoadComponent();eb.targetMorph==qc&&(this.world().openWorldMenu(eb,this.getSideBarMenuItems()).position=qc.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var eb=this,Hb,Cc,qc,ld,wd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xc){if(1==Xc.nextAddress)return Hb=eb.get("open component browser"),Cc=eb.get("user flap"),
qc=Cc.haloShadow,ld=Cc.haloColor,wd=Cd.Color.rgb(102,102,102),Hb.fontColor=ld,Hb.dropShadow=qc,Xc.yield(eb.world().execCommand("browse and load component"),2);Hb.dropShadow=!1;Hb.fontColor=wd;Xc.jumpToEnd()})}},{key:"setEditMode",value:function(eb,Hb){var Cc=this;Hb=void 0===Hb?!1:Hb;var qc=this.get("user flap"),ld=qc.haloShadow,wd=qc.haloColor,Xc=Cd.Color.rgb(102,102,102);Hb||(this._currentEditMode=eb);Hb=this.get("shape mode button");qc=this.get("text mode button");var gd=this.get("hand mode button"),
bc=this.get("halo mode button");[["Shape",Hb.submorphs],["Text",[qc]],["Hand",[gd]],["Halo",[bc]]].forEach(function(ad){var ed=$jscomp.makeIterator(ad);ad=ed.next().value;ed=ed.next().value;"Shape"==eb?Cc.world().toggleShapeMode(!0,Cc.currentShapeMode):"Text"==eb?Cc.world().toggleShapeMode(!0,"Text"):Cc.world().toggleShapeMode(!1);Cc.world().showHaloPreviews("Halo"==eb);ad==eb?ed.forEach(function(Id){Id.dropShadow=ld;Id.fontColor=wd}):ed.forEach(function(Id){Id.dropShadow=null;Id.fontColor=Xc})})}}],
[{key:"className",get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],set:function(eb){this.setProperty("currentShapeMode",eb);this.get("shape status icon").textAndAttributes=Cd.Icon.textAttribute(this.shapeToIcon[eb].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,
get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},HTML:{shortcut:"H",
args:["code",{paddingTop:"1px"}]}}}}}}}],Xd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-150"}}},{start:328,end:8962})}(Cd.Morph);Fd=Cd.LivelyTopBar;Cd.default=Fd}}});
System.register(["./__root_module__-64e296ea.js"],function(Ba){var Ab,Qb,dc,Xb,Xd,ad,Nd,dd,Lc,rd,Gd,ke,Kd,Hc,fb,Db,mc,hc,Tc,Ld,oc,pc,Nb,Dc,Vc,Hd,Id,rb,Hb,Mc,qb,tb,eb,ob,wb,cb,Oa,Gb,sc,vc,fc,rc;return{setters:[function(Q){Ab=Q.au;Qb=Q.a3;dc=Q.C;Xb=Q.ao;Xd=Q.aj;ad=Q.ay;Nd=Q.aW;dd=Q.aC;Lc=Q.az;rd=Q.a9;Gd=Q.am;ke=Q.ap;Kd=Q.h;Hc=Q.a2;fb=Q.a1;Db=Q.ai;mc=Q.a7;hc=Q.P;Tc=Q.$;Ld=Q.aX;oc=Q.aq;pc=Q.a6;Nb=Q.ar;Dc=Q.as;Vc=Q.aY;Hd=Q.aZ;Id=Q.av;rb=Q.at;Hb=Q.s;Mc=Q.aw;qb=Q.a_;tb=Q.al;eb=Q.a$;ob=Q.b0;wb=Q.b1;cb=
Q.aa;Oa=Q.b2;Gb=Q.an;sc=Q.b3;vc=Q.b4;fc=Q.b5;rc=Q.aR}],execute:function(){function Q(xa){(xa=kc.cachedGuideLines.get(xa))&&xa.forEach(function(Ca){return Ca.remove()})}function ha(xa,Ca,Mb,P,za){Ca=void 0===Ca?!0:Ca;Mb=void 0===Mb?!0:Mb;P=void 0===P?10:P;za=void 0===za?100:za;if(Ca||Mb){var Ta=xa.owner,Fb=Ta.world();Ta=Ta.getGlobalTransform();var Cc=xa.owner.submorphs.filter(function(sd){return sd!==xa&&!sd.isEpiMorph&&sd.visible&&sd.reactsToPointer}),Uc=kc.findAlignedMorphs(xa,Cc,P,za,"left top right bottom hCenter vCenter".split(" "),
"left top right bottom hCenter vCenter".split(" "));za=[];var he=0,we=0,nf=0,yd=0;Ta.e-=Fb.scroll.x;Ta.f-=Fb.scroll.y;if(Uc){Uc=$jscomp.makeIterator(Uc);for(var Ce=Uc.next();!Ce.done;Ce=Uc.next()){Ce=$jscomp.makeIterator(Ce.value);Ce.next();var wf=Ce.next().value;Ce=wf.vertical;wf=$jscomp.makeIterator(wf.horizontal);for(var Ie=wf.next();!Ie.done;Ie=wf.next()){Ie=Ie.value;var Fg=Ie.edgeAVal,Rf=Ie.refPointsA,Jc=Ie.refPointsB,of=Ie.edgeBVal,pg=Math.ceil(P-Ie.delta),qg=Math.min(Rf.top,Jc.top);Rf=Math.max(Rf.bottom,
Jc.bottom);Ie.maxDist>P&&(pg-=P/2);he<pg&&(he=pg,nf=of-Fg);za.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:kc.guideWidth,start:Ta.transformPoint(kc.pt(of,qg)),end:Ta.transformPoint(kc.pt(of,Rf)),fill:kc.guideColor,guideType:"h",priority:pg})}Ce=$jscomp.makeIterator(Ce);for(wf=Ce.next();!wf.done;wf=Ce.next())wf=wf.value,Ie=wf.edgeAVal,qg=wf.refPointsA,Rf=wf.refPointsB,Fg=wf.edgeBVal,of=Math.ceil(P-wf.delta),pg=Math.min(qg.left,Rf.left),qg=Math.max(qg.right,Rf.right),wf.maxDist>P&&(of-=
P/2),we<of&&Math.abs(Fg-Ie)<=P&&(we=of,yd=Fg-Ie),za.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:kc.guideWidth,start:Ta.transformPoint(kc.pt(pg,Fg)),end:Ta.transformPoint(kc.pt(qg,Fg)),fill:kc.guideColor,guideType:"v",priority:of})}}if(!he||!we){Cc=[xa].concat($jscomp.arrayFromIterable(Cc));Ie=kc.computeClosestMorphs(Cc);wf=Ie[0];Cc=wf.l;Uc=wf.r;Ce=wf.t;wf=wf.b;var ff;if(Cc||Uc||Ce||wf){var Ja=(Cc||Uc||Ce||wf).refPointsA;for(Fg=1;Fg<Ie.length&&(Rf=Ie[Fg],of=Rf.l,pg=Rf.r,qg=Rf.t,Rf=Rf.b,
he||(Cc&&of&&Cc.index!==of.index&&Math.abs(of.dist-Cc.dist)<=P?ff=Object.assign({neighbor:Fg,direction:"left"},of):Uc&&pg&&Uc!==pg.index&&Math.abs(pg.dist-Uc.dist)<=P&&(ff=Object.assign({neighbor:Fg,direction:"right"},pg))),we||(Ce&&qg&&Ce.index!==qg.index&&Math.abs(qg.dist-Ce.dist)<=P?ff=Object.assign({neighbor:Fg,direction:"top"},qg):wf&&Rf&&wf.index!==Rf.index&&Math.abs(Rf.dist-wf.dist)<=P&&(ff=Object.assign({neighbor:Fg,direction:"bottom"},Rf))),!ff);Fg++);}if(ff){var $a=ff;P=$a.direction;qg=
$a.dist;var Bb=Ja.left;Jc=Ja.top;var ba=Ja.bottom,Ia=Ja.right,nb=Ja.width,zb=Ja.height;Rf=$a.refPointsA;Ja=Rf.left;Ie=Rf.top;Fg=Rf.bottom;of=Rf.right;pg=Rf.width;Rf=Rf.height;var Ec=$a.refPointsB,Gc=Ec.left;$a=Ec.top;var qd=Ec.bottom;Ec=Ec.right;Ia="left"===P?Bb:"right"===P?Ia:Bb+nb/2;ba="bottom"===P?ba:"top"===P?Jc:Jc+zb/2;Bb="left"===P?Ia-qg:"right"===P?Ia+qg:Bb+nb/2;qg="bottom"===P?ba+qg:"top"===P?ba-qg:Jc+zb/2;Jc="left"===P?Ec:"right"===P?Gc:Ja+pg/2;nb="bottom"===P?$a:"top"===P?qd:Ie+Rf/2;!Mb||
he||"right"!==P&&"left"!==P||(he=10,nf=(ff.dist-(Uc||Cc).dist)*("right"===P?-1:1),Ia+=nf,Bb+=nf);!Mb||we||"top"!==P&&"bottom"!==P||(we=10,yd=((Ce||wf).dist-ff.dist)*("top"===P?-1:1),ba+=yd,qg+=yd);za.push({type:"line",epiMorph:!0,hasFixedPosition:!0,start:Ta.transformPoint(kc.pt("left"===P?Ja:"right"===P?of:Ja+pg/2,"bottom"===P?Fg:"top"===P?Ie:Ie+Rf/2)),end:Ta.transformPoint(kc.pt(Jc,nb)),fill:kc.Color.orange,height:kc.guideWidth,guideType:P,priority:10},{type:"line",epiMorph:!0,hasFixedPosition:!0,
start:Ta.transformPoint(kc.pt(Ia,ba)),end:Ta.transformPoint(kc.pt(Bb,qg)),fill:kc.Color.orange,height:kc.guideWidth,guideType:P,priority:10})}}Mb&&(nf||yd)&&xa.moveBy(kc.pt(nf,yd));if(Ca){za=za.filter(function(sd){var vd=sd.guideType;sd=sd.priority;return"h"===vd?sd===he:"v"===vd?sd===we:!0});(Ca=kc.cachedGuideLines.get(xa))||kc.cachedGuideLines.set(xa,Ca=[]);for(Mb=0;Mb<za.length;Mb++)ff=void 0,Ca[Mb]?ff=Object.assign(Ca[Mb],za[Mb]):(ff=kc.morph(za[Mb]),Ca.push(ff)),ff.owner||Fb.addMorph(ff);Ca.slice(Mb).forEach(function(sd){return sd.remove()});
kc.fun.debounceNamed(xa.id+"-drag-guides-cleanup",1300,function(){var sd=kc.cachedGuideLines.get(xa);sd&&sd.forEach(function(vd){return vd.remove()})})()}}}function Ga(xa,Ca,Mb,P,za,Ta){Mb=void 0===Mb?!0:Mb;P=void 0===P?!0:P;za=void 0===za?5:za;Ta=void 0===Ta?100:Ta;if(Mb||P){var Fb=xa.owner,Cc=Fb.world(),Uc=Fb.getGlobalTransform(),he=xa.owner.submorphs.filter(function(ba){return ba!==xa&&!ba.isEpiMorph&&ba.visible&&ba.reactsToPointer});Fb=(Ca.includes("left")||Ca.includes("right")?"x":"")+(Ca.includes("top")||
Ca.includes("bottom")?"y":"");var we=kc.findMorphsWithSimilarWidthOrHeight(xa,Fb,he,za,Ta),nf=-Infinity,yd=-Infinity,Ce=0,wf=0,Ie=0,Fg=0,Rf=0,Jc=0;Fb=[];Uc.e-=Cc.scroll.x;Uc.f-=Cc.scroll.y;if(we){we=$jscomp.makeIterator(we);for(var of=we.next();!of.done;of=we.next()){of=$jscomp.makeIterator(of.value);of.next();var pg=of.next().value;of=pg.similarIn;var qg=pg.delta,ff=pg.refPointsA,Ja=pg.refPointsB;pg=za-qg+(Ta-pg.minDist);"width"===of?nf<pg&&(nf=pg,Ca.includes("left")&&(wf=-qg),Ca.includes("right")&&
(Ce=qg)):yd<pg&&(yd=pg,Ca.includes("top")&&(Ie=-qg),Ca.includes("bottom")&&(Fg=qg));qg={type:"line",epiMorph:!0,hasFixedPosition:!0,height:kc.guideWidth,fill:kc.guideColor,guideType:of,priority:pg,start:Uc.transformPoint("width"===of?kc.pt(ff.left,ff.top+ff.height/2):kc.pt(ff.left+ff.width/2,ff.top)),end:Uc.transformPoint("width"===of?kc.pt(ff.right,ff.top+ff.height/2):kc.pt(ff.left+ff.width/2,ff.bottom))};of=Object.assign({},qg,{start:Uc.transformPoint("width"===of?kc.pt(Ja.left,Ja.top+Ja.height/
2):kc.pt(Ja.left+Ja.width/2,Ja.top)),end:Uc.transformPoint("width"===of?kc.pt(Ja.right,Ja.top+Ja.height/2):kc.pt(Ja.left+Ja.width/2,Ja.bottom))});Fb.push(qg,of)}}if(Ta=kc.findAlignedMorphs(xa,he,za,Ta,Ca,void 0))for(Ta=$jscomp.makeIterator(Ta),he=Ta.next();!he.done;he=Ta.next()){he=$jscomp.makeIterator(he.value);he.next();we=he.next().value;he=we.vertical;we=$jscomp.makeIterator(we.horizontal);for(of=we.next();!of.done;of=we.next()){of=of.value;Ja=of.edgeAVal;var $a=of.refPointsA,Bb=of.refPointsB;
qg=of.edgeBVal;ff=Math.ceil(za-of.delta);pg=Math.min($a.top,Bb.top);$a=Math.max($a.bottom,Bb.bottom);of.maxDist>za&&(ff-=za/2);Rf<ff&&(Rf=ff,Ca.includes("left")&&(wf=-(qg-Ja)),Ca.includes("right")&&(Ce=+(qg-Ja)));Fb.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:kc.guideWidth,start:Uc.transformPoint(kc.pt(qg,pg)),end:Uc.transformPoint(kc.pt(qg,$a)),fill:kc.guideColor,guideType:"h",priority:ff})}he=$jscomp.makeIterator(he);for(we=he.next();!we.done;we=he.next())we=we.value,of=we.edgeAVal,
pg=we.refPointsA,$a=we.refPointsB,Ja=we.edgeBVal,qg=Math.ceil(za-we.delta),ff=Math.min(pg.left,$a.left),pg=Math.max(pg.right,$a.right),we.maxDist>za&&(qg-=za/2),Jc<qg&&Math.abs(Ja-of)<=za&&(Jc=qg,Ca.includes("top")&&(Ie=Ja-of),Ca.includes("bottom")&&(Fg=Ja-of)),Fb.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:kc.guideWidth,start:Uc.transformPoint(kc.pt(ff,Ja)),end:Uc.transformPoint(kc.pt(pg,Ja)),fill:kc.guideColor,guideType:"v",priority:qg})}P&&(wf&&(xa.left+=wf,xa.right-=wf),Ie&&(xa.top+=
Ie,xa.bottom-=Ie),Ce&&(xa.width+=Ce),Fg&&(xa.height+=Fg));if(Mb){Fb=Fb.filter(function(ba){var Ia=ba.guideType;ba=ba.priority;return"width"===Ia?ba===nf:"height"===Ia?ba===yd:"v"===Ia?ba===Jc:"h"===Ia?ba===Rf:!1});(Ca=kc.cachedGuideLines.get(xa))||kc.cachedGuideLines.set(xa,Ca=[]);for(Mb=0;Mb<Fb.length;Mb++)P=void 0,Ca[Mb]?P=Object.assign(Ca[Mb],Fb[Mb]):(P=kc.morph(Fb[Mb]),Ca.push(P)),P.owner||Cc.addMorph(P);Ca.slice(Mb).forEach(function(ba){return ba.remove()});kc.fun.debounceNamed(xa.id+"-drag-guides-cleanup",
1300,function(){var ba=kc.cachedGuideLines.get(xa);ba&&ba.forEach(function(Ia){return Ia.remove()})})()}}}function La(xa,Ca){Ca=void 0===Ca?!1:Ca;var Mb=ab.MorphicEnv.default().world;if(null===xa||void 0===xa)xa=String(xa);if(xa.isMorph)return ab.showRect(xa.world(),xa.globalBounds().translatedBy(xa.world().scroll.negated()),Ca);if(xa.isPoint)return ab.showRect(Mb,new ab.Rectangle(xa.x-5,xa.y-5,10,10));if(xa.isLine)return ab.showLine(Mb,xa);if(xa.isRectangle)return ab.showRect(Mb,xa);if("undefined"!==
typeof ab.Element&&xa instanceof ab.Element)return ab.showRect(Mb,ab.Rectangle.fromElement(xa));if("number"===typeof xa||"symbol"===typeof xa||"boolean"===typeof xa||"undefined"!==typeof ab.Node&&xa instanceof ab.Node||xa instanceof RegExp)xa=String(xa);"object"===typeof xa&&(xa=ab.obj.inspect(xa,{maxDepth:1}));return"string"===typeof xa&&1===arguments.length?Mb.setStatusMessage(xa):Mb.setStatusMessage(ab.string.formatFromArray(Array.from(arguments)))}function Yb(xa,Ca,Mb){Mb=void 0===Mb?3E3:Mb;var P,
za,Ta,Fb,Cc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==Uc.nextAddress){if(!(xa&&xa.world()&&Ca&&Ca.world()))return Uc.return(null);P=xa.owner.worldPoint(xa.center);za=Ca.owner.worldPoint(Ca.center);Ta=P.lineTo(za).sampleN(2)[1];Fb={tagName:"marker",markerHeight:5,markerWidth:5,orient:"auto",refX:1,refY:5,viewBox:"0 0 10 10",children:[{tagName:"circle",stroke:ab.Color.red,fill:ab.Color.red,cx:5,cy:5,r:4}]};Cc=$world.addMorph(new ab.Path({position:Ta,renderOnGPU:!0,vertices:[ab.pt(0),
ab.pt(0)],borderWidth:2,startMarker:Fb,endMarker:Fb,borderColor:ab.Color.red}));return Uc.yield(Cc.whenRendered(),2)}if(3!=Uc.nextAddress)return Uc.yield(Cc.animate({opacity:1,customTween:function(he){var we=Cc.center;Cc.vertices=[ab.pt(0).interpolate(he,P.subPt(Ta)),ab.pt(0).interpolate(he,za.subPt(Ta))];Cc.center=we},duration:400}),3);Mb&&setTimeout(function(){return Cc.fadeOut()},Mb);return Uc.return(Cc)})}Ba({a:ha,d:Yb,r:Q,s:La});var kc=lively.FreezerRuntime.recorderFor("lively.halos/drag-guides.js");
kc.removeSnapToGuidesOf=Q;kc.showAndSnapToGuides=ha;kc.showAndSnapToResizeGuides=Ga;kc.computeRefPoints=function(xa){var Ca=xa.x,Mb=xa.y,P=xa.width;xa=xa.height;return{left:Ca,top:Mb,hCenter:Ca+P/2,vCenter:Mb+xa/2,right:Ca+P,bottom:Mb+xa,width:P,height:xa}};kc.findEdgesInAlignment=function(xa,Ca,Mb,P,za,Ta,Fb,Cc,Uc,he){Mb=void 0===Mb?15:Mb;Ta=void 0===Ta?0:Ta;Fb=void 0===Fb?0:Fb;Cc=void 0===Cc?0:Cc;Uc=void 0===Uc?0:Uc;he=void 0===he?0:he;for(var we=[],nf=[],yd=0;yd<kc.edges.length;yd++){var Ce=$jscomp.makeIterator(kc.edges[yd]),
wf=Ce.next().value,Ie=Ce.next().value;Ce=Ce.next().value;var Fg=xa[Ie],Rf=Ca[Ce],Jc=Math.max(Fg,Rf)-Math.min(Fg,Rf);Jc>Mb||!(P&&!P.includes(Ie)||za&&!za.includes(Ce))&&("vertical"===wf?we:nf).push({delta:Jc,edgeA:Ie,edgeB:Ce,edgeAVal:Fg,edgeBVal:Rf,refPointsA:xa,refPointsB:Ca,distLeft:Ta,distTop:Fb,distRight:Cc,distBottom:Uc,maxDist:he})}return we.length||nf.length?{vertical:we,horizontal:nf}:null};kc.findAlignedMorphs=function(xa,Ca,Mb,P,za,Ta){Mb=void 0===Mb?15:Mb;P=void 0===P?Infinity:P;for(var Fb,
Cc=kc.computeRefPoints(xa.bounds()),Uc=0;Uc<Ca.length;Uc++){var he=Ca[Uc];if(he!==xa){var we=kc.computeRefPoints(he.bounds()),nf=Math.max(0,Cc.left-we.right),yd=Math.max(0,we.left-Cc.right),Ce=Math.max(0,Cc.top-we.bottom),wf=Math.max(0,we.top-Cc.bottom);Math.max(wf,Ce,yd,nf)>P||!(we=kc.findEdgesInAlignment(Cc,we,Mb,za,Ta,nf,Ce,yd,wf,Math.max(wf,Ce,yd,nf)))||(Fb||(Fb=new Map),Fb.set(he,we))}}xa=xa.owner;Ca=kc.computeRefPoints(xa.innerBounds());if(Mb=kc.findEdgesInAlignment(Cc,Ca,Mb))Fb||(Fb=new Map),
Fb.set(xa,Mb);return Fb};kc.findMorphsWithSimilarWidthOrHeight=function(xa,Ca,Mb,P,za){P=void 0===P?15:P;za=void 0===za?Infinity:za;for(var Ta,Fb=kc.computeRefPoints(xa.bounds()),Cc=0;Cc<Mb.length;Cc++){var Uc=Mb[Cc];if(Uc!==xa){var he=kc.computeRefPoints(Uc.bounds()),we=Math.max(0,Fb.left-he.right),nf=Math.max(0,he.left-Fb.right),yd=Math.max(0,Fb.top-he.bottom),Ce=Math.max(0,he.top-Fb.bottom),wf=Math.min(Ce,yd,nf,we),Ie=Math.max(Ce,yd,nf,we);if(!(Math.max(Ce,yd,nf,we)>za)){nf=Fb;we=nf.width;nf=nf.height;
Ce=he;yd=Ce.width;Ce=Ce.height;var Fg=yd-we,Rf=Ce-nf;("x"===Ca||"xy"===Ca)&&Math.abs(Fg)<=P&&(Ta||(Ta=new Map),Ta.set(Uc,{similarIn:"width",minDist:wf,maxDist:Ie,refPointsA:Fb,refPointsB:he,valA:we,valB:yd,delta:Fg}));("y"===Ca||"xy"===Ca)&&Math.abs(Rf)<=P&&(Ta||(Ta=new Map),Ta.set(Uc,{similarIn:"height",minDist:wf,maxDist:Ie,refPointsA:Fb,refPointsB:he,valA:nf,valB:Ce,delta:Rf}))}}}return Ta};kc.closest=function(xa,Ca,Mb,P,za,Ta,Fb,Cc){Cc=void 0===Cc?!0:Cc;var Uc=P[xa],he=za[xa],we=Ta[xa];Ca=Fb[xa];
for(var nf,yd,Ce,wf,Ie=0;Ie<za.length;Ie++)xa===Ie||Uc<za[Ie]||nf&&za[nf.index]>=za[Ie]||Cc&&Fb[xa]<Ta[Ie]||Ta[xa]>Fb[Ie]||(nf={index:Ie,dist:Uc-za[Ie],refPointsA:Mb[xa],refPointsB:Mb[Ie]});for(Uc=0;Uc<P.length;Uc++)xa===Uc||he>P[Uc]||yd&&P[yd.index]<=P[Uc]||Cc&&Fb[xa]<Ta[Uc]||Ta[xa]>Fb[Uc]||(yd={index:Uc,dist:P[Uc]-he,refPointsA:Mb[xa],refPointsB:Mb[Uc]});for(he=0;he<Fb.length;he++)xa===he||we<Fb[he]||Ce&&Fb[Ce.index]>=Fb[he]||Cc&&P[xa]>za[he]||za[xa]<P[he]||(Ce={index:he,dist:we-Fb[he],refPointsA:Mb[xa],
refPointsB:Mb[he]});for(Fb=0;Fb<Ta.length;Fb++)xa===Fb||Ca>Ta[Fb]||wf&&Ta[wf.index]<=Ta[Fb]||Cc&&P[xa]>za[Fb]||za[xa]<P[Fb]||(wf={index:Fb,dist:Ta[Fb]-Ca,refPointsA:Mb[xa],refPointsB:Mb[Fb]});return{l:nf,r:yd,t:Ce,b:wf}};kc.computeClosestMorphs=function(xa){for(var Ca=[],Mb=[],P=[],za=[],Ta=[],Fb=[],Cc=0;Cc<xa.length;Cc++){var Uc=kc.computeRefPoints(xa[Cc].bounds());Ta.push(Uc);var he=Uc.right,we=Uc.top,nf=Uc.bottom;Ca.push(Uc.left);Mb.push(he);P.push(we);za.push(nf)}for(Cc=0;Cc<xa.length;Cc++)Fb.push(kc.closest(Cc,
xa,Ta,Ca,Mb,P,za));return Fb};kc.fun=Ab;kc.pt=Qb;kc.Color=dc;kc.morph=Xb;kc.cachedGuideLines=new WeakMap;kc.guideWidth=1;kc.guideColor=kc.Color.orange.lighter();kc.removeSnapToGuidesOf=Q;kc.removeSnapToGuidesOf=Q;kc.showAndSnapToGuides=ha;kc.showAndSnapToGuides=ha;kc.showAndSnapToResizeGuides=Ga;kc.showAndSnapToResizeGuides=Ga;kc.edges=[["vertical","top","top"],["vertical","vCenter","top"],["vertical","bottom","top"],["vertical","top","vCenter"],["vertical","vCenter","vCenter"],["vertical","bottom",
"vCenter"],["vertical","top","bottom"],["vertical","vCenter","bottom"],["vertical","bottom","bottom"],["horizontal","left","left"],["horizontal","hCenter","left"],["horizontal","right","left"],["horizontal","left","hCenter"],["horizontal","hCenter","hCenter"],["horizontal","right","hCenter"],["horizontal","left","right"],["horizontal","hCenter","right"],["horizontal","right","right"]];var Ua=lively.FreezerRuntime.recorderFor("lively.halos/morph.js");Ua.Morph=Xd;Ua.Label=ad;Ua.StyleSheet=Nd;Ua.HorizontalLayout=
dd;Ua.Path=Lc;Ua.Text=rd;Ua.GridLayout=Gd;Ua.morph=Xb;Ua.Icon=ke;Ua.createMorphSnapshot=Kd;Ua.Color=dc;Ua.pt=Qb;Ua.rect=Hc;Ua.Rectangle=fb;Ua.LinearGradient=Db;Ua.obj=mc;Ua.PropertyPath=hc;Ua.promise=Tc;Ua.properties=Ld;Ua.num=oc;Ua.arr=pc;Ua.connect=Nb;Ua.signal=Dc;Ua.disconnect=Vc;Ua.disconnectAll=Hd;Ua.once=Id;Ua.showAndSnapToGuides=ha;Ua.showAndSnapToResizeGuides=Ga;Ua.removeSnapToGuidesOf=Q;Ua.haloBlue=Ua.Color.rgb(23,160,251);Ua.componentAccent=Ua.Color.magenta;Ua.derivedAccent=Ua.Color.purple;
var ec=function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("Halo")&&"function"===typeof Ca.Halo?Ca.Halo:Ca.Halo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"relayout",value:function(){this.alignWithTarget()}},{key:"keybindings",get:function(){return[{keys:{mac:"Meta-C",win:"Ctrl-C"},command:{command:"clipboard copy",passEvent:!0}}]}},{key:"commands",
get:function(){return[{name:"clipboard copy",doc:"copy selected morph(s) to clipboard",scrollCursorIntoView:!1,exec:function(P){P.copyHalo().copyToClipBoard()}}]}},{key:"removeIfDetached",value:function(){var P=this;setTimeout(function(){P.target.owner||P.remove()})}},{key:"initLayout",value:function(){var P=this.layout=new Ua.GridLayout({autoAssign:!1,fitToCell:!1,columns:[0,{fixed:36,paddingRight:10},2,{fixed:26},4,{fixed:26},6,{fixed:36,paddingLeft:10}],rows:[0,{fixed:36,paddingBottom:10},2,{fixed:26},
4,{fixed:26},6,{fixed:26},7,{fixed:36,paddingTop:10}],grid:[["menu",null,"grab",null,"drag",null,"close"],[null,null,null,null,null,null,null],["copy",null,null,null,null,null,"edit"],[null,null,null,null,null,null,null],["component",null,null,null,null,null,"inspect"],[null,null,null,null,null,null,null],["rotate",null,null,null,null,null,"resize"],[null,"name","name","name","name","name",null]]});P.col(1).row(7).group.align="center";P.col(1).row(7).group.resize=!1}},{key:"initButtons",value:function(){this.submorphs=
[].concat($jscomp.arrayFromIterable(this.ensureResizeHandles()),$jscomp.arrayFromIterable(this.resizeOnly?[]:[this.closeHalo(),this.dragHalo(),this.grabHalo(),this.menuHalo(),this.inspectHalo(),this.editHalo(),this.copyHalo(),this.componentHalo(),this.rotateHalo(),this.nameHalo(),this.originHalo()]))}},{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"isHalo",get:function(){return!0}},{key:"borderBox",get:function(){return this.getSubmorphNamed("border-box")||
this.addMorphBack(Ua.morph({name:"border-box",fill:Ua.Color.transparent,borderColor:this.target.isComponent?Ua.componentAccent:Ua.haloBlue,borderWidth:1}))}},{key:"pointerId",get:function(){return this.state?this.state.pointerId:null}},{key:"pointerId",set:function(P){this.state||(this.state={});this.state.pointerId=P}},{key:"prepareTarget",value:function(P){if(!Ua.obj.isArray(P))return P;if(1>=P.length)return P[0];P=P[0].world().addMorph(new Ua.MultiSelectionTarget({selectedMorphs:P}));P.alignWithSelection();
P.modifiesSelectedMorphs=!0;return P}},{key:"refocus",value:function(P){this.target=P;this.alignWithTarget()}},{key:"alignWithTarget",value:function(){if(!this.active&&this.target){var P=this.target.world()||$world,za=P.visibleBounds(),Ta=this.target.globalBounds(),Fb=Ta.insetBy(-36).intersection(za);za=Ta.intersection(za);this.layout&&this.layout.disable();this.setBounds(Fb.translatedBy(P.scroll.negated()));this.borderBox.setBounds($world.transformRectToMorph(this,za));this.state.activeButton?(this.buttonControls.forEach(function(Cc){return Cc.visible=
!1}),this.ensureResizeHandles().forEach(function(Cc){return Cc.visible=!1}),this.state.activeButton.visible=!0,this.updatePropertyDisplay(this.state.activeButton)):(this.changingName&&this.nameHalo().toggleActive([!1]),this.ensureResizeHandles().forEach(function(Cc){return Cc.visible=!0}),this.buttonControls.forEach(function(Cc){Cc.visible=!0}),this.propertyDisplay.disable());this.nameHalo().alignInHalo();this.ensureResizeHandles().forEach(function(Cc){return Cc.alignInHalo()});this.resizeOnly||this.originHalo().alignInHalo();
this.layout&&this.layout.enable();return this}}},{key:"detachFromTarget",value:function(){var P=this.target;P&&(Ua.disconnect(P,"onChange",this,"alignWithTarget"),Ua.disconnect(P,"onOwnerChanged",this,"removeIfDetached"),P instanceof Ua.MultiSelectionTarget?(P.modifiesSelectedMorphs=!1,P.remove()):"function"===typeof P.detachedHalo&&P.detachedHalo(this))}},{key:"remove",value:function(){this.detachFromTarget();rb._get(Object.getPrototypeOf(Mb.prototype),"remove",this).call(this)}},{key:"morphsContainingPoint",
value:function(P){return P}},{key:"propertyDisplay",get:function(){return Ua.HaloPropertyDisplay.for(this)}},{key:"nameHalo",value:function(){return Ua.NameHaloItem.for(this)}},{key:"closeHalo",value:function(){return Ua.CloseHaloItem.for(this)}},{key:"grabHalo",value:function(){return Ua.GrabHaloItem.for(this)}},{key:"dragHalo",value:function(){return Ua.DragHaloItem.for(this)}},{key:"menuHalo",value:function(){return Ua.MenuHaloItem.for(this)}},{key:"inspectHalo",value:function(){return Ua.InspectHaloItem.for(this)}},
{key:"editHalo",value:function(){return Ua.EditHaloItem.for(this)}},{key:"rotateHalo",value:function(){return Ua.RotateHaloItem.for(this)}},{key:"copyHalo",value:function(){return Ua.CopyHaloItem.for(this)}},{key:"originHalo",value:function(){return Ua.OriginHaloItem.for(this)}},{key:"componentHalo",value:function(){return Ua.ComponentHaloItem.for(this)}},{key:"buttonControls",get:function(){return this.submorphs.filter(function(P){return P.isHaloItem&&!P.isResizeHandle})}},{key:"addMorphToSelection",
value:function(P){var za=this,Ta,Fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cc){if(1==Cc.nextAddress){Ta=za.world();Fb=za.target.isMorphSelection?za.target.selectedMorphs:[za.target];if(Fb.includes(P))return Cc.return();za.remove();return Cc.yield(Ta.showHaloForSelection([].concat($jscomp.arrayFromIterable(Fb),[P]),za.state.pointerId),2)}return Cc.return(Cc.yieldResult)})}},{key:"removeMorphFromSelection",value:function(P){var za=this,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fb){if(1==
Fb.nextAddress){Ta=za.world();za.remove();if(!za.target.isMorphSelection)return Fb.jumpTo(0);Ua.arr.remove(za.target.selectedMorphs,P);return Fb.yield(Ta.showHaloForSelection(za.target.selectedMorphs,za.state.pointerId),3)}return Fb.return(Fb.yieldResult)})}},{key:"isAlreadySelected",value:function(P){return this.target==P||this.target.isMorphSelection&&this.target.selectsMorph(P)}},{key:"updateBoundsFor",value:function(P,za,Ta,Fb,Cc){var Uc={topLeft:Ua.rect(-1,-1,1,1),topCenter:za?Ua.rect(1,-1,0,
1):Ua.rect(0,-1,0,1),topRight:Ua.rect(0,-1,1,1),rightCenter:za?Ua.rect(0,1,1,1):Ua.rect(0,0,1,0),bottomRight:Ua.rect(0,0,1,1),bottomCenter:za?Ua.rect(1,0,0,1):Ua.rect(0,0,0,1),bottomLeft:Ua.rect(-1,0,1,1),leftCenter:za?Ua.rect(-1,1,1,0):Ua.rect(-1,0,1,0)}[P];Cc=Uc.x;var he=Uc.y,we=Uc.width;Uc=Uc.height;Ta=za?this.proportionalDelta(P,Ta,Fb):Ta;P=Ua.rect(Ta.x*Cc,Ta.y*he,Ta.x*we,Ta.y*Uc);this.active=!0;this.target.setBounds(Fb.insetByRect(P));(this.target.isPolygon||this.target.isPath)&&this.target.moveBy(this.target.origin.negated());
this.active=!1;this.alignWithTarget()}},{key:"proportionalDelta",value:function(P,za,Ta){var Fb=Ta.width,Cc=Ta.height;Ta={topLeft:Ua.pt(-1,-1),topCenter:Ua.pt(0,-1),topRight:Ua.pt(1,-1),leftCenter:Ua.pt(-1,0),rightCenter:Ua.pt(1,0),bottomLeft:Ua.pt(-1,1),bottomCenter:Ua.pt(0,1),bottomRight:Ua.pt(1,1)};var Uc=Fb/Math.max(Fb,Cc),he=Cc/Math.max(Cc,Fb);Fb={topLeft:Ua.pt(-Uc,-he),topCenter:Ua.pt(1/(2*Cc/Fb),-1),topRight:Ua.pt(Uc,-he),leftCenter:Ua.pt(-1,Cc/(2*Fb)),rightCenter:Ua.pt(1,Cc/(3*Fb)),bottomLeft:Ua.pt(-Uc,
he),bottomCenter:Ua.pt(1/(2*Cc/Fb),1),bottomRight:Ua.pt(Uc,he)};Ta=Ta[P];return Fb[P].scaleBy(Ta.dotProduct(za)/Ta.dotProduct(Ta))}},{key:"ensureResizeHandles",value:function(){return Ua.ResizeHandle.resizersFor(this)}},{key:"updatePropertyDisplay",value:function(P){P=P.valueForPropertyDisplay();"undefined"!==typeof P?this.propertyDisplay.displayProperty(P):this.propertyDisplay.disable()}},{key:"toggleDiagonal",value:function(P,za){if(!Ua.rect(0).sides.includes(za)){var Ta=this.getSubmorphNamed("diagonal");
if(P){P=this.target.globalBounds();var Fb=P.width,Cc=P.height;P=this.localize(Ua.pt(P.x,P.y)).extent(Ua.pt(Fb,Cc)).scaleRectTo(this.innerBounds());Fb={topLeft:[Ua.pt(Fb,Cc),Ua.pt(0,0)],topRight:[Ua.pt(0,Cc),Ua.pt(Fb,0)],bottomRight:[Ua.pt(0,0),Ua.pt(Fb,Cc)],bottomLeft:[Ua.pt(Fb,0),Ua.pt(0,Cc)]};Ta?Ta.setBounds(P):(Ta=$jscomp.makeIterator(Fb[za]),za=Ta.next().value,Ta=Ta.next().value,Fb=new Ua.LinearGradient({stops:[{offset:0,color:Ua.Color.orange.withA(0)},{offset:.2,color:Ua.Color.orange},{offset:.8,
color:Ua.Color.orange},{offset:1,color:Ua.Color.orange.withA(0)}]}),Ta=this.addMorphBack(new Ua.Path({opacity:0,name:"diagonal",borderStyle:"dotted",borderWidth:5,bounds:P,borderColor:Fb,vertices:[za,Ta]})),Ta.setBounds(P),Ta.animate({opacity:1,duration:500}))}else Ta&&Ta.fadeOut(500)}}},{key:"toggleRotationIndicator",value:function(P,za){var Ta=this.getSubmorphNamed("rotationIndicator");P&&za?(P=this.getSubmorphNamed("origin").center,Ta=Ta||this.addMorphBack(new Ua.Path({name:"rotationIndicator",
borderColor:Ua.haloBlue,borderWidth:1,vertices:[]})),Ta.setBounds(za.bounds().union(this.innerBounds())),Ta.vertices=[Ta.localizePointFrom(P,this),Ta.localizePointFrom(za.center,this)]):Ta&&Ta.remove()}},{key:"toggleMorphHighlighter",value:function(P,za,Ta){Ta=void 0===Ta?!1:Ta;if(za.onHaloGrabover)za.onHaloGrabover(P);else Ta=Ua.MorphHighlighter.for(this,za,Ta),P&&za&&za!=this.world()?Ta&&Ta.show(za):Ta&&Ta.deactivate()}},{key:"onMouseDown",value:function(P){var za=P.state.clickedOnMorph;if(!P.isCommandKey()&&
za==this.borderBox)return this.remove();if(P.isShiftDown()&&P.isCommandKey())P=this.target.isMorphSelection?this.target.morphBeneath(P.position):this.morphBeneath(P.position),this.isAlreadySelected(P)?this.removeMorphFromSelection(P):this.addMorphToSelection(P);else{if(za==this.borderBox&&P.isCommandKey()){var Ta=P.world.morphsContainingPoint(P.position).filter(function(Fb){return Fb.halosEnabled});(Ta=Ta.slice(Ta.indexOf(this.target)+1)[0]||Ta[0]||P.world)&&P.world.showHaloFor(Ta,P.domEvt.pointerId);
this.remove()}za==this&&P.isCommandKey()&&(Ta=this.morphBeneath(P.position),P.world.showHaloFor(Ta,P.domEvt.pointerId));za==this&&this.remove()}}},{key:"onKeyUp",value:function(P){this.changingName||this.buttonControls.map(function(za){return za.onKeyUp(P)})}},{key:"getMesh",value:function(P,za){var Ta=P.x;P=P.y;za=void 0===za?Ua.pt(0,0):za;var Fb=this.world().visibleBounds(),Cc=Fb.height;Fb=Fb.width;var Uc={borderStyle:"dotted",borderWidth:2,borderColor:Ua.Color.orange};Uc=this.get("mesh")||this.addMorph(new Ua.Morph({name:"mesh",
styleClasses:["halo-mesh"],extent:Ua.pt(Fb,Cc),fill:null,submorphs:[new Ua.Path(Object.assign({name:"vertical"},Uc)),new Ua.Path(Object.assign({name:"horizontal"},Uc))]}));Uc.globalPosition=za;Uc.getSubmorphNamed("vertical").vertices=[Ua.pt(Ta,0).subPt(za),Ua.pt(Ta,Cc).subPt(za)];Uc.getSubmorphNamed("horizontal").vertices=[Ua.pt(0,P).subPt(za),Ua.pt(Fb,P).subPt(za)];return Uc}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Halo"}},{key:"properties",get:function(){return{fill:{defaultValue:Ua.Color.transparent},
resizeOnly:{defaultValue:!1},pointerId:{},hasFixedPosition:{defaultValue:!0},respondsToVisibleWindow:{defaultValue:!0},submorphs:{after:["target"],initialize:function(){this.initButtons();this.alignWithTarget()}},layout:{after:["submorphs"],initialize:function(){this.initLayout()}},hasTinyTarget:{derived:!0,get:function(){return 40>this.target.bounds().extent().dist(Ua.pt(0))}},target:{get:function(){return this.state?this.state.target:null},set:function(P){this.state||(this.state={});var za=!!this.state.target;
this.detachFromTarget();P=this.prepareTarget(P);this.state.target=P;za&&this.alignWithTarget();Ua.connect(P,"onChange",this,"alignWithTarget");Ua.connect(P,"onOwnerChanged",this,"removeIfDetached")}}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:897,end:16889})}(Ua.Morph);ec=Ua.Halo;
var ge=Ba("H",ec);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("HaloPropertyDisplay")&&"function"===typeof Ca.HaloPropertyDisplay?Ca.HaloPropertyDisplay:Ca.HaloPropertyDisplay=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"isHaloItem",get:function(){return!1}},{key:"halo",get:function(){return this.owner}},{key:"displayedValue",value:function(){return this.textString}},
{key:"displayProperty",value:function(P){var za=this.halo.state.activeButton;P=String(P);this.visible=!0;this.textString=P;this.position=this.constructor.defaultPosition;this.bounds().insetBy(10).intersects(za.bounds())&&(this.position=Ua.pt(za.topRight.x+10,this.position.y))}},{key:"disable",value:function(){this.position=this.constructor.defaultPosition;this.visible=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"HaloPropertyDisplay"}},{key:"morphName",get:function(){return"propertyDisplay"}},
{key:"defaultPosition",get:function(){return Ua.pt(25,0)}},{key:"for",value:function(P){return P.getSubmorphNamed(this.morphName)||P.addMorph(new this({name:this.morphName}))}},{key:"properties",get:function(){return{name:{defaultValue:this.name},fill:{defaultValue:Ua.Color.black.withA(.7)},borderRadius:{defaultValue:7},padding:{defaultValue:Ua.Rectangle.inset(5)},visible:{defaultValue:!1},readOnly:{defaultValue:!0},fontSize:{defaultValue:12},fontColor:{defaultValue:Ua.Color.white},position:{defaultValue:this.defaultPosition}}}}],
Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:17079,end:18417})})(Ua.Label);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("MultiSelectionTarget")&&"function"===typeof Ca.MultiSelectionTarget?Ca.MultiSelectionTarget:Ca.MultiSelectionTarget=
function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"isHaloItem",get:function(){return!0}},{key:"isMorphSelection",get:function(){return!0}},{key:"selectsMorph",value:function(P){return this.selectedMorphs.includes(P)}},{key:"alignWithSelection",value:function(){var P=this.selectedMorphs.map(function(za){return za.globalBounds()}).reduce(function(za,Ta){return za.union(Ta)});this.setBounds(P)}},{key:"onGrab",
value:function(P){this.grabbingHand=P.hand;this.selectionGrabbed=!0;P.hand.grab(this.selectedMorphs);Ua.once(P.hand,"dropMorphsOn",this,"onGrabEnd");Ua.connect(P.hand,"position",this,"alignWithSelection")}},{key:"onGrabEnd",value:function(){this.selectionGrabbed=!1;Ua.disconnectAll(this.grabbingHand)}},{key:"updateExtent",value:function(P){var za=P.value.subPt(P.prevValue);this.selectedMorphs.forEach(function(Ta){return Ta.resizeBy(za)})}},{key:"updatePosition",value:function(P){if(!this.selectionGrabbed){var za=
P.value.subPt(P.prevValue);this.selectedMorphs.forEach(function(Ta){return Ta.moveBy(za)})}}},{key:"updateRotation",value:function(P){var za=this,Ta=P.value-P.prevValue;this.selectedMorphs.forEach(function(Fb){var Cc=Fb.origin;Fb.adjustOrigin(Fb.localize(za.worldPoint(Ua.pt(0,0))));Fb.rotation+=Ta;Fb.adjustOrigin(Cc)})}},{key:"updateScale",value:function(P){var za=this,Ta=P.value-P.prevValue;this.selectedMorphs.forEach(function(Fb){var Cc=Fb.origin;Fb.adjustOrigin(Fb.localize(za.worldPoint(Ua.pt(0,
0))));Fb.scale+=Ta;Fb.adjustOrigin(Cc)})}},{key:"onChange",value:function(P){rb._get(Object.getPrototypeOf(Mb.prototype),"onChange",this).call(this,P);if(this.modifiesSelectedMorphs){switch(P.prop){case "extent":this.updateExtent(P);break;case "scale":this.updateScale(P);break;case "position":this.updatePosition(P);break;case "rotation":this.updateRotation(P)}return P}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MultiSelectionTarget"}},{key:"properties",get:function(){return{visible:{defaultValue:!1},
modifiesSelectedMorphs:{defaultValue:!1},selectedMorphs:{defaultValue:[]},halosEnabled:{defaultValue:!1}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:18485,end:20756})})(Ua.Morph);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("HaloItem")&&
"function"===typeof Ca.HaloItem?Ca.HaloItem:Ca.HaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"menuItems",value:function(){return[]}},{key:"init",value:function(){}},{key:"update",value:function(){}},{key:"stop",value:function(){}},{key:"valueForPropertyDisplay",value:function(){}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"HaloItem"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:15},nativeCursor:{defaultValue:"pointer"},fill:{defaultValue:Ua.Color.gray.withA(.7)},grabbable:{defaultValue:!1},extent:{defaultValue:Ua.pt(24,24)},halo:{}}}},{key:"for",value:function(P){return P.getSubmorphNamed(this.morphName)||P.addMorph(new this({halo:P,name:this.morphName}))}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:20920,end:21593})})(Ua.Morph);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("NameHolder")&&"function"===typeof Ca.NameHolder?Ca.NameHolder:Ca.NameHolder=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"onHoverIn",
value:function(P){this.highlightOnHover&&this.nameHolder.active&&(this.halo.toggleMorphHighlighter(!0,this.target),this.nameHolder.fontColor=Ua.Color.orange)}},{key:"onHoverOut",value:function(P){this.highlightOnHover&&(this.halo.toggleMorphHighlighter(!1,this.target),this.nameHolder.fontColor=Ua.Color.darkgray)}},{key:"accept",value:function(){this.target.name!==this.nameHolder.textString&&this.updateName(this.nameHolder.textString)}},{key:"onKeyDown",value:function(P){"Enter"==P.keyCombo?(this.accept(),
P.stop()):rb._get(Object.getPrototypeOf(Mb.prototype),"onKeyDown",this).call(this,P)}},{key:"onMouseUp",value:function(){Ua.signal(this,"active",[!0,this])}},{key:"onMouseDown",value:function(P){this.nameHolder.fontColor=Ua.Color.white;this.halo.toggleMorphHighlighter(!1,this.target)}},{key:"onKeyUp",value:function(P){P=this.nameHolder.textString;var za=this.target.owner;this.validName=!za||!za.getSubmorphNamed(P)||this.target.name==P;Ua.signal(this,"valid",[this.validName,P])}},{key:"update",value:function(){var P=
this;this.nameHolder.textString!==this.target.name&&(this.nameHolder.textString=this.target.name,this.whenRendered().then(function(){return P.nameHolder.fit()}))}},{key:"activate",value:function(){this.nameHolder.readOnly=!1;this.nameHolder.active=!0;this.nameHolder.animate({opacity:1})}},{key:"deactivate",value:function(){this.nameHolder.readOnly=!0;this.nameHolder.active=!1;this.nameHolder.animate({opacity:.3})}},{key:"updateName",value:function(P){if(!this.forceUniqueName||this.validName)this.target.name=
P,Ua.signal(this,"active",[!1,this])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHolder"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Click to edit the morph's name"},draggable:{defaultValue:!1},fill:{defaultValue:Ua.Color.transparent},forceUniqueName:{defaultValue:!1},halo:{},layout:{after:["nameHolder"],initialize:function(){this.layout=new Ua.HorizontalLayout({resizeContainer:!0,spacing:7})}},nameHolder:{after:["submorphs"],initialize:function(){this.nameHolder=
this.addMorph(new Ua.Text({fill:Ua.Color.transparent,fontColor:Ua.Color.white,fontWeight:"bold",active:!0}));Ua.connect(this.nameHolder,"onBlur",this,"accept")}}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21628,end:24179})})(Ua.Morph);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Mb=Ca.hasOwnProperty("NameHaloItem")&&"function"===typeof Ca.NameHaloItem?Ca.NameHaloItem:Ca.NameHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){rb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,P);this.initNameHolders();this.validityIndicator=Ua.Icon.makeLabel("check",{fontColor:Ua.Color.green,
fontSize:15,padding:Ua.rect(4,6,4,0)});this.fill=this.halo.target.isComponent?Ua.componentAccent:Ua.haloBlue;this.alignInHalo()}},{key:"targets",value:function(){return this.halo.target?this.halo.target.isMorphSelection?this.halo.target.selectedMorphs.map(function(P){return{target:P,highlightOnHover:!0}}):[{target:this.halo.target,highlightOnHover:!1}]:[]}},{key:"initNameHolders",value:function(){var P=this;this.nameHolders=this.targets().map(function(za){za=new Ua.NameHolder({halo:P.halo,highlightOnHover:za.highlightOnHover,
target:za.target});Ua.connect(za,"active",P,"toggleActive");Ua.connect(za,"valid",P,"toggleNameValid");return za});this.submorphs=Ua.arr.interpose(this.nameHolders,{extent:Ua.pt(1,28),fill:Ua.Color.black.withA(.4)})}},{key:"toggleActive",value:function(P){P=$jscomp.makeIterator(P);var za=P.next().value,Ta=P.next().value;this.halo.changingName!==za&&((this.halo.changingName=za)?(this.nameHolders.forEach(function(Fb){return Fb!=Ta&&Fb.deactivate()}),this.borderWidth=3,this.addMorph(this.validityIndicator),
this.fill=Ua.Color.darkGray,setTimeout(function(){return Ta.nameHolder.selectAll()})):(this.fill=Ua.haloBlue,this.nameHolders.forEach(function(Fb){return Fb!=Ta&&Fb.activate()}),this.borderWidth=0,this.validityIndicator.remove(),this.halo.focus()),this.alignInHalo())}},{key:"toggleNameValid",value:function(P){var za=$jscomp.makeIterator(P);P=za.next().value;za=za.next().value;(this.validName=P)?(this.conflictingMorph=null,this.borderColor=Ua.Color.green,this.validityIndicator.nativeCursor="auto",
this.validityIndicator.fontColor=Ua.Color.green,Ua.Icon.setIcon(this.validityIndicator,"check")):(this.conflictingMorph=this.get(za),this.borderColor=Ua.Color.red,this.validityIndicator.fontColor=Ua.Color.red,this.validityIndicator.nativeCursor="pointer",Ua.Icon.setIcon(this.validityIndicator,"exclamation-circle"))}},{key:"alignInHalo",value:function(){Ua.arr.zip(this.targets(),this.nameHolders).map(function(za){var Ta=$jscomp.makeIterator(za);za=Ta.next().value.target;Ta=Ta.next().value;Ta.target=
za;Ta.update()});var P=this.halo.innerBounds().bottomCenter().addPt(Ua.pt(0,2));this.topCenter=Ua.pt(Math.max(P.x,30),Math.max(P.y,80))}},{key:"onMouseDown",value:function(P){var za=this,Ta=this.conflictingMorph;Ta&&(this.halo.toggleMorphHighlighter(!0,Ta),setTimeout(function(){return za.halo.toggleMorphHighlighter(!1,Ta)},1E3))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHaloItem"}},{key:"morphName",get:function(){return"name"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:4},
fill:{defaultValue:Ua.haloBlue},borderColor:{defaultValue:Ua.Color.green},layout:{initialize:function(){this.layout=new Ua.HorizontalLayout({resizeContainer:!0,spacing:0})}}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:24181,end:27375})})(Ua.HaloItem);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Mb=Ca.hasOwnProperty("CloseHaloItem")&&"function"===typeof Ca.CloseHaloItem?Ca.CloseHaloItem:Ca.CloseHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"update",value:function(){var P=this.halo,za=P.target.owner;za.undoStart("close-halo");P.target.selectedMorphs?P.target.selectedMorphs.forEach(function(Ta){return Ta.remove()}):P.target.remove();za.undoStop("close-halo");P.remove()}},{key:"onMouseDown",
value:function(P){this.update()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CloseHaloItem"}},{key:"morphName",get:function(){return"close"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["fas","fa-trash"]},draggable:{defaultValue:!1},tooltip:{defaultValue:"Remove this morph from the world"}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:27377,end:28002})})(Ua.HaloItem);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("GrabHaloItem")&&"function"===typeof Ca.GrabHaloItem?Ca.GrabHaloItem:Ca.GrabHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"adjustTarget",value:function(P,za){Ua.PropertyPath("owner.layout.autoResize").get(P)&&
!P.globalBounds().insetBy(10).containsPoint(za)&&(P=P.owner);return P}},{key:"valueForPropertyDisplay",value:function(){var P=this.hand,za=this.halo,Ta=this.prevDropTarget,Fb=P.world(),Cc=P.findDropTarget(P.globalPosition,[za.target],function(Uc){return!Uc.isHaloItem&&!Uc.ownerChain().some(function(he){return he.isHaloItem||!he.visible||0==he.opacity})});if(Cc)return Cc=this.adjustTarget(Cc,P.globalPosition),za.toggleMorphHighlighter(Cc&&Cc!=Fb,Cc,!0),Ta&&Ta!=Cc&&za.toggleMorphHighlighter(!1,Ta),
(this.prevDropTarget=Cc)&&Cc.name}},{key:"init",value:function(P){var za=this.halo,Ta=za.target.undoStart("grab-halo");Ta&&Ta.addTarget(za.target.owner);this.hand=P;za.target.onGrab({halo:za,hand:P,isShiftDown:function(){return!1}});za.state.activeButton=this;this.opacity=.3;var Fb=Ua.connect(P,"update",this,"update");Ua.once(za.target,"remove",function(){return Fb.disconnect()})}},{key:"stop",value:function(P){var za=this.halo,Ta=this.prevDropTarget,Fb=za.target.undoInProgress,Cc=P.hand.findDropTarget(P.hand.globalPosition,
[za.target],function(Uc){return!Uc.isHaloItem&&!Uc.ownerChain().some(function(he){return he.isHaloItem})});Cc=this.adjustTarget(Cc,P.hand.globalPosition);Ua.disconnect(P.hand,"update",this,"update");Ua.MorphHighlighter.interceptDrop(za,Cc,za.target);Fb.addTarget(Cc);Cc.onDrop(P);za.state.activeButton=null;za.alignWithTarget();za.toggleMorphHighlighter(!1,Ta);Ua.MorphHighlighter.removeHighlighters(za);za.target.undoStop("grab-halo");this.opacity=1}},{key:"update",value:function(){this.halo.alignWithTarget()}},
{key:"onDragStart",value:function(P){this.init(P.hand)}},{key:"onDragEnd",value:function(P){this.stop(P)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrabHaloItem"}},{key:"morphName",get:function(){return"grab"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["far","fa-hand-rock"]},tooltip:{defaultValue:"Grab the morph"},draggable:{defaultValue:!0}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:28004,end:30532})})(Ua.HaloItem);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("DragHaloItem")&&"function"===typeof Ca.DragHaloItem?Ca.DragHaloItem:Ca.DragHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,
xa,[{key:"valueForPropertyDisplay",value:function(){return this.halo.target.position}},{key:"updateAlignmentGuide",value:function(P){var za=this.halo.getSubmorphNamed("mesh");if(P)return za=this.halo.getMesh(this.halo.target.worldPoint(Ua.pt(0,0))),this.focus(),za;za&&za.remove()}},{key:"init",value:function(){var P=this.halo.target;P.undoStart("drag-halo");this.halo.state.activeButton=this;this.actualPos=P.position;this.targetTransform=P.owner.getGlobalTransform().inverse()}},{key:"stop",value:function(){this.halo.target.undoStop("drag-halo");
this.halo.state.activeButton=null;this.halo.alignWithTarget();this.updateAlignmentGuide(!1);Ua.removeSnapToGuidesOf(this.halo.target)}},{key:"update",value:function(P,za,Ta){za=void 0===za?!1:za;Ta=void 0===Ta?!1:Ta;this.actualPos=P=this.actualPos.addPt(this.targetTransform.transformDirection(P));za&&(P=P.griddedBy(Ua.pt(10,10)));this.halo.target.position=P;this.updateAlignmentGuide(za);za||Ua.showAndSnapToGuides(this.halo.target,!0,Ta,5,500)}},{key:"onDragStart",value:function(P){this.init()}},{key:"onDrag",
value:function(P){this.update(P.state.dragDelta,P.isAltDown(),P.isCtrlDown())}},{key:"onDragEnd",value:function(P){this.stop()}},{key:"onKeyUp",value:function(P){this.updateAlignmentGuide(!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DragHaloItem"}},{key:"morphName",get:function(){return"drag"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},styleClasses:{defaultValue:["fas","fa-arrows-alt"]},tooltip:{defaultValue:"Change the morph's position. Press (alt) while dragging to align the morph's position along a grid."}}}}],
Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:30534,end:32372})})(Ua.HaloItem);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("InspectHaloItem")&&"function"===typeof Ca.InspectHaloItem?Ca.InspectHaloItem:Ca.InspectHaloItem=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"onMouseDown",value:function(P){var za=this;(function(){var Ta,Fb,Cc,Uc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(he){if(1==he.nextAddress)return he.yield(System.import("lively.ide/js/inspector.js"),2);Ta=he.yieldResult;Fb=Ta.default;(Cc=za.world().getSubmorphsByStyleClassName("Inspector").find(function(we){return we.targetObject==za.halo.target}))&&
(Uc=Cc.getWindow())?(Uc.minimized=!1,Uc.activate(),Uc.animate({center:za.world().visibleBounds().center(),duration:200})):Fb.openInWindow({targetObject:za.halo.target});za.halo.remove();he.jumpToEnd()})})()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectHaloItem"}},{key:"morphName",get:function(){return"inspect"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Inspect the morph's local state"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-cogs"]}}}}],
Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:32374,end:33291})})(Ua.HaloItem);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("EditHaloItem")&&"function"===typeof Ca.EditHaloItem?Ca.EditHaloItem:Ca.EditHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"onMouseDown",value:function(P){var za=this;(P=this.world().getSubmorphsByStyleClassName("ObjectEditor").find(function(Ta){return Ta.target==za.halo.target}))?(P=P.getWindow(),P.bringToFront(),P.minimized=!1,P.animate({center:this.world().visibleBounds().center(),duration:200})):$world.execCommand("open object editor",{target:this.halo.target});this.halo.remove()}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"EditHaloItem"}},{key:"morphName",get:function(){return"edit"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Edit the morph's definition"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-wrench"]}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:33293,end:34073})})(Ua.HaloItem);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("RotateHaloItem")&&"function"===typeof Ca.RotateHaloItem?Ca.RotateHaloItem:Ca.RotateHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){rb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,P);this.adaptAppearance(!1)}},{key:"angle",get:function(){return this.getProperty("angle")||0}},{key:"angle",set:function(P){this.setProperty("angle",P)}},{key:"scaleGauge",get:function(){return this.getProperty("scaleGauge")||null}},{key:"scaleGauge",set:function(P){this.setProperty("scaleGauge",P)}},{key:"initRotation",get:function(){return this.getProperty("initRotation")||0}},{key:"initRotation",set:function(P){this.setProperty("initRotation",P)}},{key:"valueForPropertyDisplay",
value:function(){var P=this.halo.target;return this.scaleGauge?P.scale.toFixed(4).toString():Ua.num.toDegrees(P.rotation).toFixed(1)+"\u00b0"}},{key:"init",value:function(P){this.detachFromLayout();this.halo.target.undoStart("rotate-halo");this.halo.state.activeButton=this;this.angle=P;this.initRotation=this.halo.target.rotation;this.halo.toggleRotationIndicator(!0,this)}},{key:"initScale",value:function(P){this.detachFromLayout();this.halo.state.activeButton=this;this.scaleGauge=P.scaleBy(1/this.halo.target.scale);
this.halo.toggleRotationIndicator(!0,this)}},{key:"update",value:function(P){this.scaleGauge=null;P=this.initRotation+(P-this.angle);P=Ua.num.toRadians(Ua.num.detent(Ua.num.toDegrees(P),10,45));this.halo.target.rotation=P;this.halo.toggleRotationIndicator(!0,this)}},{key:"updateScale",value:function(P){var za=this.scaleGauge,Ta=this.halo;za||(za=this.scaleGauge=P.scaleBy(1/Ta.target.scale));this.angle=P.theta();this.initRotation=Ta.target.rotation;Ta.target.scale=Ua.num.detent(P.dist(Ua.pt(0,0))/
za.dist(Ua.pt(0,0)),.1,.5);Ta.toggleRotationIndicator(!0,this)}},{key:"stop",value:function(){this.attachToLayout();this.scaleGauge=null;this.halo.state.activeButton=null;this.halo.alignWithTarget();this.halo.toggleRotationIndicator(!1,this);this.halo.target.undoStop("rotate-halo");this.halo.ensureResizeHandles()}},{key:"adaptAppearance",value:function(P){this.styleClasses=["fas",P?"fa-search-plus":"fa-redo"];this.tooltip=P?"Scale morph":"Rotate morph"}},{key:"detachFromLayout",value:function(){this.savedLayout=
this.halo.layout;this.halo.layout=null}},{key:"attachToLayout",value:function(){this.halo.layout=this.savedLayout}},{key:"onDragStart",value:function(P){this.adaptAppearance(P.isShiftDown());P.isShiftDown()?this.initScale(P.position.subPt(this.halo.target.globalPosition)):this.init(P.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDrag",value:function(P){this.globalPosition=P.position.addPt(Ua.pt(-10,-10));this.adaptAppearance(P.isShiftDown());P.isShiftDown()?this.updateScale(P.position.subPt(this.halo.target.globalPosition)):
this.update(P.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDragEnd",value:function(P){this.adaptAppearance(P.isShiftDown());this.stop()}},{key:"onKeyDown",value:function(P){this.adaptAppearance(P.isShiftDown())}},{key:"onKeyUp",value:function(P){this.adaptAppearance(P.isShiftDown())}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RotateHaloItem"}},{key:"morphName",get:function(){return"rotate"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0}}}}],
Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:34075,end:37552})})(Ua.HaloItem);Ua.nameNumberRe=/(.+)([0-9]+)$/;(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("ComponentHaloItem")&&"function"===typeof Ca.ComponentHaloItem?Ca.ComponentHaloItem:
Ca.ComponentHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"updateComponentIndicator",value:function(){var P=this.world(),za=this.halo.target;this.halo.remove();P.showHaloFor(za)}},{key:"onMouseDown",value:function(){this.halo.target.isComponent=!this.halo.target.isComponent;this.updateComponentIndicator()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ComponentHaloItem"}},
{key:"morphName",get:function(){return"component"}},{key:"properties",get:function(){return{tooltip:{get:function(){return this.halo.target.isComponent?"Retract Component":"Turn into Component"}},styleClasses:{initialize:function(){this.styleClasses=this.halo.target.isComponent?["fas","fa-eraser"]:["fas","fa-cube"]}}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:37593,end:38343})})(Ua.HaloItem);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("CopyHaloItem")&&"function"===typeof Ca.CopyHaloItem?Ca.CopyHaloItem:Ca.CopyHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"init",value:function(P){function za(nf,yd){return yd.match(Ua.nameNumberRe)?
yd.replace(Ua.nameNumberRe,function(Ce,wf,Ie){Ie||(Ie="0");for(Ce=Number(Ie);nf.get(wf+ ++Ce););return wf+Ce}):yd+"1"}var Ta=this.halo,Fb=Ta.target,Cc=Ta.world(),Uc=Fb instanceof Ua.MultiSelectionTarget;Ta.remove();Ua.connect(P,"update",this,"update");if(Uc){var he=Fb.selectedMorphs.map(function(nf){return Cc.addMorph(nf.copy())});Uc=he.map(function(nf){nf.name=za(Fb,nf.name);return nf.position});he[0].undoStart("copy-halo");Cc.addMorph(Ta);Ta.refocus(he);P.grab(Ta.target);Ta.target.onGrab({halo:Ta,
hand:P,isShiftDown:function(){return!1}});Uc.forEach(function(nf,yd){return he[yd].globalPosition=nf});Ta.alignWithTarget()}else{Uc=Fb.globalPosition;var we=Fb.copy();Fb.isComponent&&(we.isComponent=!1,we.withAllSubmorphsDoExcluding(function(nf){nf!=we&&nf.master||delete nf._parametrizedProps},function(nf){return nf.master&&nf!=we}),we.master=Fb);we.name=za(Fb,Fb.name);Cc.addMorph(we);we.globalPosition=Uc;we.undoStart("copy-halo");P.grab(we);Cc.addMorph(Ta);Ta.visible=!1}}},{key:"stop",value:function(P){var za=
this.halo,Ta=$jscomp.makeIterator(P.grabbedMorphs).next().value,Fb=P.findDropTarget(P.globalPosition,[za.target],function(Uc){return!Uc.isHaloItem&&!Uc.ownerChain().some(function(he){return he.isHaloItem})}),Cc=za.target.undoInProgress;Ua.disconnect(P,"update",this,"update");Cc.addTarget(Fb);P.dropMorphsOn(Fb);za.target.undoStop("copy-halo");za.remove();P.world().showHaloFor(Ta)}},{key:"onDragStart",value:function(P){this.init(P.hand)}},{key:"onDragEnd",value:function(P){this.stop(P.hand)}},{key:"update",
value:function(){this.halo.alignWithTarget()}},{key:"copyToClipBoard",value:function(){var P=this,za,Ta,Fb,Cc,Uc,he,we,nf,yd,Ce,wf,Ie,Fg,Rf,Jc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(of){switch(of.nextAddress){case 1:za=P;Ta=za.halo;if(Ta.nameHalo().nameHolders.find(function(pg){return pg.nameHolder===$world.focusedMorph}))return of.return();Fb=Ta.target;Cc=Ta.world();Uc=Fb instanceof Ua.MultiSelectionTarget;he=Fb.globalBounds().topLeft();we=Uc?Fb.selectedMorphs:[Fb];nf=[];yd=
'<!DOCTYPE html>\n          <html lang="en">\n          <head>\n            <meta charset="utf-8">\n            '+document.querySelector("#lively-morphic-css").outerHTML+"\n          </head>\n          <body>";Ta.remove();of.setCatchFinallyBlocks(2);Ce=$jscomp.makeIterator(we);wf=Ce.next();case 4:if(wf.done)return yd+="</body></html>",Rf=JSON.stringify(nf),of.yield(P.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/html",data:yd},{type:"application/morphic",data:Rf}]),8);Ie=wf.value;return of.yield(Ua.createMorphSnapshot(Ie,
{addPreview:!1,testLoad:!1}),7);case 7:Fg=of.yieldResult;Fg.copyMeta={offset:Ie.worldPoint(Ua.pt(0,0)).subPt(he)};nf.push(Fg);yd+=Ie.renderPreview();wf=Ce.next();of.jumpTo(4);break;case 8:of.leaveTryBlock(3);break;case 2:return Jc=of.enterCatchBlock(),Cc.logError(Jc),of.return();case 3:Cc.addMorph(Ta),Ta.refocus(we),Ta.setStatusMessage("copied"),of.jumpToEnd()}})}},{key:"onMouseUp",value:function(P){var za=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){P.stop();return Ta.yield(za.copyToClipBoard(),
0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CopyHaloItem"}},{key:"morphName",get:function(){return"copy"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},tooltip:{defaultValue:"Copy morph"},styleClasses:{defaultValue:["far","fa-clone"]}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:38345,end:42379})})(Ua.HaloItem);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("OriginHaloItem")&&"function"===typeof Ca.OriginHaloItem?Ca.OriginHaloItem:Ca.OriginHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"fill",get:function(){return Ua.Color.white.interpolate(.2,this.borderColorTop)}},{key:"extent",get:function(){return Ua.pt(15,
15)}},{key:"tooltip",get:function(){return"Change the morph's origin"}},{key:"computePositionAtTarget",value:function(){return this.halo.localize(this.halo.target.globalPosition)}},{key:"alignInHalo",value:function(){this.visible=!this.halo.hasTinyTarget;this.center=this.computePositionAtTarget()}},{key:"valueForPropertyDisplay",value:function(){return this.halo.target.origin}},{key:"init",value:function(){this.halo.target.undoStart("origin-halo");this.halo.state.activeButton=this}},{key:"stop",value:function(){this.halo.target.undoStop("origin-halo");
this.halo.state.activeButton=null;this.halo.alignWithTarget()}},{key:"update",value:function(P){var za=this.halo,Ta=za.target.origin,Fb=za.target.worldPoint(Ta);P=za.target.localize(Fb.addPt(P)).subPt(za.target.scroll).subPt(Ta);za.target.adjustOrigin(za.target.origin.addPt(P))}},{key:"onDragStart",value:function(P){this.init()}},{key:"onDragEnd",value:function(P){this.stop()}},{key:"onDrag",value:function(P){this.update(P.state.dragDelta)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"OriginHaloItem"}},
{key:"morphName",get:function(){return"origin"}},{key:"properties",get:function(){return{borderWidth:{defaultValue:3},nativeCursor:{defaultValue:"-webkit-grab"},draggable:{defaultValue:!0},borderColor:{after:["halo"],initialize:function(){this.borderColor=this.halo.target.isComponent?Ua.componentAccent:Ua.haloBlue}}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:42381,end:44042})})(Ua.HaloItem);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("ResizeHandle")&&"function"===typeof Ca.ResizeHandle?Ca.ResizeHandle:Ca.ResizeHandle=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"valueForPropertyDisplay",value:function(){var P=this.halo.target.extent,
za=P.y;return P.x.toFixed(1)+"x"+za.toFixed(1)}},{key:"positionInHalo",value:function(){var P=this.halo.borderBox.bounds();this.halo.hasTinyTarget&&(Ua.Rectangle.prototype.sides.includes(this.location)&&(this.visible=!1),P=P.insetBy(-4));return P.partNamed(this.location)}},{key:"alignInHalo",value:function(){this.center=this.positionInHalo();return this}},{key:"onKeyUp",value:function(P){this.halo.state.activeButton==this&&this.halo.toggleDiagonal(P.isShiftDown(),this.corner)}},{key:"onKeyDown",value:function(P){this.halo.state.activeButton==
this&&this.halo.toggleDiagonal(P.isShiftDown(),this.corner)}},{key:"onDragStart",value:function(P){this.init(P.position,P.isShiftDown())}},{key:"onDragEnd",value:function(P){this.stop(P.isShiftDown())}},{key:"onDrag",value:function(P){this.update(P.position,P.isShiftDown(),P.isAltDown(),P.isCtrlDown());this.focus()}},{key:"init",value:function(P,za){za=void 0===za?!1:za;var Ta=this.halo.target,Fb=Ta.origin,Cc=Ta.position;Ta=Ta.extent;this.startPos=P;this.startBounds=Cc.subPt(Fb).extent(Ta);this.startOrigin=
this.halo.target.origin;this.savedLayout=this.halo.layout;this.halo.layout=null;this.halo.state.activeButton=this;this.tfm=this.halo.target.getGlobalTransform().inverse();P=this.halo.target.getGlobalTransform().getRotation();this.offsetRotation=Ua.num.toRadians(P%45);this.halo.toggleDiagonal(za,this.corner)}},{key:"update",value:function(P,za,Ta,Fb){za=void 0===za?!1:za;Ta=void 0===Ta?!1:Ta;Fb=void 0===Fb?!1:Fb;var Cc=this.corner,Uc=this.tfm;P=this.startPos.subPt(P);Uc=Uc.transformDirection(Ua.pt(P.x,
P.y));Ta&&(Uc=Uc.griddedBy(Ua.pt(10,10)));this.halo.updateBoundsFor(Cc,za,Uc,this.startBounds,this.startOrigin);this.halo.toggleDiagonal(za,Cc);this.updateAlignmentGuide(Ta);za=[];Cc=Cc.toLowerCase();Cc.includes("left")&&za.push("left");Cc.includes("top")&&za.push("top");Cc.includes("bottom")&&za.push("bottom");Cc.includes("right")&&za.push("right");Ua.showAndSnapToResizeGuides(this.halo.target,za,!0,Fb,5,200)}},{key:"stop",value:function(P){P=this.halo;P.layout=this.savedLayout;P.state.activeButton=
null;P.alignWithTarget();P.toggleDiagonal(!1);this.updateAlignmentGuide(!1);Ua.removeSnapToGuidesOf(P.target)}},{key:"updateAlignmentGuide",value:function(P){var za=this.halo.getSubmorphNamed("mesh");if(P)return P=this.halo.target.extent,P=Ua.pt(P.x%10,P.y%10),za=this.halo.getMesh(this.globalPosition.addPt(this.extent.scaleBy(.5)),P),this.focus(),za;za&&za.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ResizeHandle"}},{key:"properties",get:function(){return{corner:{},location:{},
draggable:{defaultValue:!0},isResizeHandle:{readOnly:!0,get:function(){return!0}}}}},{key:"getResizeParts",value:function(P){0<P&&(P-=360);P=-8-(P/45).toFixed();0==P&&(P=8);return Ua.arr.zip(Ua.arr.rotate([["topLeft",function(za){return za.negated()}],["topCenter",function(za){return za.withX(0).negated()}],["topRight",function(za){return za.withX(0).negated()}],["rightCenter",function(za){return Ua.pt(0,0)}],["bottomRight",function(za){return Ua.pt(0,0)}],["bottomCenter",function(za){return Ua.pt(0,
0)}],["bottomLeft",function(za){return za.withY(0).negated()}],["leftCenter",function(za){return za.withY(0).negated()}]],P),[["nwse-resize","topLeft"],["ns-resize","topCenter"],["nesw-resize","topRight"],["ew-resize","rightCenter"],["nwse-resize","bottomRight"],["ns-resize","bottomCenter"],["nesw-resize","bottomLeft"],["ew-resize","leftCenter"]])}},{key:"resizersFor",value:function(P){var za=this;if(!P.target)return[];var Ta=P.target.getGlobalTransform().getRotation();return Ua.arr.compact(this.getResizeParts(Ta).map(function(Fb){var Cc=
$jscomp.makeIterator(Fb),Uc=$jscomp.makeIterator(Cc.next().value);Fb=Uc.next().value;Uc.next();Uc.next();Uc=$jscomp.makeIterator(Cc.next().value);Cc=Uc.next().value;Uc=Uc.next().value;return za.for(P,Fb,Uc,Cc)})).map(function(Fb){return Fb.alignInHalo()})}},{key:"for",value:function(P,za,Ta,Fb){var Cc="Resize "+za;P=P.getSubmorphNamed(Cc)||new this({name:Cc,halo:P,corner:za,tooltip:"Resize "+za,extent:Ua.pt(10,10),borderWidth:1,borderRadius:0,borderColor:P.target.isComponent?Ua.componentAccent:Ua.haloBlue,
fill:Ua.Color.white});return Object.assign(P,{nativeCursor:Fb,location:Ta})}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:44101,end:49399})})(Ua.HaloItem);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("MenuHaloItem")&&"function"===
typeof Ca.MenuHaloItem?Ca.MenuHaloItem:Ca.MenuHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"onMouseDown",value:function(P){var za=this,Ta,Fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cc){if(1==Cc.nextAddress)return Ta=za.halo.target,za.halo.remove(),Cc.yield(Ta.menuItems(),2);Fb=Cc.yieldResult;Ta.world().openMenu(Fb).hasFixedPosition=za.halo.hasFixedPosition;Cc.jumpToEnd()})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MenuHaloItem"}},{key:"morphName",get:function(){return"menu"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},tooltip:{defaultValue:"Opens the morph menu"},styleClasses:{defaultValue:["fas","fa-bars"]}}}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:49401,end:49923})})(Ua.HaloItem);var ee=Ba("M",function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ca.hasOwnProperty("MorphHighlighter")&&"function"===typeof Ca.MorphHighlighter?Ca.MorphHighlighter:Ca.MorphHighlighter=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"alignWithHalo",value:function(){this.target&&(this.position=this.halo.localize(this.target.globalBounds().topLeft()),
this.halo.isWorld&&(this.position=this.position.subPt(this.halo.scroll)),this.extent=this.target.globalBounds().extent(),this.get("name tag").value=this.target.name,this.get("name tag").topCenter=this.innerBounds().insetBy(-10).bottomCenter())}},{key:"show",value:function(){if(this.target&&this.target.layout&&this.showLayout&&(this.layoutHalo=this.layoutHalo||this.world().showLayoutHaloFor(this.target,this.pointerId))&&this.layoutHalo.previewDrop){this.visible=!1;this.alignWithHalo();this.halo.get("grab").hand.grabbedMorphs&&
this.layoutHalo.previewDrop(this.halo.get("grab").hand.grabbedMorphs);return}this.visible=!0;this.alignWithHalo()}},{key:"handleDrop",value:function(P){this.layoutHalo&&this.layoutHalo.handleDrop(P)}},{key:"deactivate",value:function(){this.layoutHalo&&(this.layoutHalo.remove(),this.layoutHalo=null);this.visible=!1;this.alignWithHalo();this.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphHighlighter"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},
name:{defaultValue:"morphHighlighter"},styleClasses:{defaultValue:["inactive"]},reactsToPointer:{defaultValue:!1},hasFixedPosition:{defaultValue:!0},fill:{defaultValue:Ua.Color.orange.withA(.3)},borderWidth:{defaultValue:2},borderColor:{defaultValue:Ua.Color.orange},halo:{},epiMorph:{defaultValue:!0},isHighlighter:{readOnly:!0,defaultValue:!0},highlightedSides:{defaultValue:[],set:function(P){var za=this;this.setProperty("highlightedSides",P);this.submorphs=P.map(function(Ta){return{type:"ellipse",
isHaloItem:!0,fill:Ua.Color.orange,center:za.innerBounds()[Ta]()}});this.addMorph({type:"label",name:"name tag",padding:Ua.Rectangle.inset(5,5,5,5),fontColor:Ua.Color.white,fill:Ua.Color.orange,borderRadius:3});this.alignWithHalo()}},showLayout:{defaultValue:!1},targetId:{},target:{readOnly:!0,derived:!0,get:function(){return(this.world()||this.env.world).getMorphWithId(this.targetId)}}}}},{key:"removeHighlighters",value:function(P){P=void 0===P?$world:P;var za=P._morphHighlighters,Ta;for(Ta in za)za[Ta].remove();
delete P._morphHighlighters}},{key:"for",value:function(P,za,Ta,Fb){Ta=void 0===Ta?!1:Ta;Fb=void 0===Fb?[]:Fb;var Cc=P._morphHighlighters=P._morphHighlighters||{};Ua.properties.forEachOwn(Cc,function(Uc,he){return he.alignWithHalo()});if(!za||za.ownerChain().find(function(Uc){return Uc.isHaloItem}))return null;Cc[za.id]=Cc[za.id]||new this({targetId:za.id,halo:P,showLayout:Ta});P.addMorph(Cc[za.id]);Cc[za.id].highlightedSides=Fb;return Cc[za.id]}},{key:"interceptDrop",value:function(P,za,Ta){(P=P._morphHighlighters=
P._morphHighlighters||{},P[za.id])&&P[za.id].handleDrop(Ta)}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:50112,end:53723})}(Ua.Morph));Ua.MorphHighlighter=ee;Ua.MorphHighlighter=ee;Ua.MorphHighlighter=ee;var ed=Ba("I",function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Mb=Ca.hasOwnProperty("InteractiveMorphSelector")&&"function"===typeof Ca.InteractiveMorphSelector?Ca.InteractiveMorphSelector:Ca.InteractiveMorphSelector=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(P,za,Ta){P=void 0===P?$world:P;this.controllingMorph=void 0===za?null:za;this.possibleTarget=this.morphHighlighter=this.selectorMorph=null;this.world=
P;this.filterFn=Ta;this.whenDone=null}},{key:"selectNewTarget",value:function(){this.targetObject=null;var P=Ua.promise.deferred();P.promise.resolve=P.resolve;this.whenDone=P.promise;this.selectorMorph=Ua.Icon.makeLabel("crosshairs",{fontSize:20,hasFixedPosition:!0,epiMorph:!0}).openInWorld();Ua.connect(this.world.firstHand,"position",this,"scanForTargetAt");Ua.once(this.selectorMorph,"onMouseDown",this,"selectTarget");Ua.once(this.selectorMorph,"onKeyDown",this,"stopSelect");this.selectorMorph.focus();
this.scanForTargetAt(this.world.firstHand.position)}},{key:"scanForTargetAt",value:function(){var P=this.world.firstHand.globalPosition;this.selectorMorph.center=P;this.selectorMorph.focus();var za=this.selectorMorph.morphBeneath(P),Ta,Fb=this.possibleTarget,Cc=this.controllingMorph,Uc=this.filterFn,he=this.world,we=this.morphHighlighter;for(we==za?za=we.morphBeneath(P):za&&za.isEpiMorph&&(za=za.morphBeneath(P));za&&(Ta=[za].concat($jscomp.arrayFromIterable(za.ownerChain())).find(function(nf){return!nf.visible}));)za=
Ta=Ta.morphBeneath(P);if(za&&Uc&&!Uc(za))for(;za&&![za].concat($jscomp.arrayFromIterable(za.ownerChain())).find(Uc);)za=za.morphBeneath(P);!za||za==Fb||Cc&&za.ownerChain().includes(Cc.getWindow())||(we&&we.deactivate(),(this.possibleTarget=Fb=za)&&!Fb.isWorld&&(P=this.morphHighlighter=Ua.MorphHighlighter.for(he,za))&&P.show())}},{key:"selectTarget",value:function(){this.targetObject=this.possibleTarget;this.stopSelect()}},{key:"stopSelect",value:function(){Ua.MorphHighlighter.removeHighlighters(this.world);
Ua.disconnect(this.world.firstHand,"position",this,"scanForTargetAt");this.selectorMorph.remove();this.whenDone&&this.whenDone.resolve(this.targetObject)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveMorphSelector"}},{key:"selectMorph",value:function(P,za,Ta){P=new this(P,za,Ta);P.selectNewTarget();return P.whenDone}}],Ca,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:53732,end:56487})}(void 0));Ua.InteractiveMorphSelector=ed;Ua.InteractiveMorphSelector=ed;Ua.InteractiveMorphSelector=ed;Ua.default=ec;var ab=lively.FreezerRuntime.recorderFor("lively.halos/markers.js");ab.show=La;ab.showRect=function(xa,Ca,Mb){var P=ab.BoundsMarker.highlightBounds(Ca);return Mb?ab.showInLoop(xa,P,Ca):ab.showThenHide(xa,P)};ab.showInLoop=function(xa,Ca,Mb){var P;return $jscomp.asyncExecutePromiseGeneratorProgram(function(za){switch(za.nextAddress){case 1:return ab.showThenHide(xa,
Ca,!1),za.yield(ab.promise.delay(300),2);case 2:P=!1,ab.once(xa,"onMouseDown",function(){return P=!0});case 3:if(P){za.jumpTo(4);break}return za.yield(Ca.retract(Mb),3);case 4:Ca.fadeOut(2E3),za.jumpToEnd()}})};ab.showThenHide=function(xa,Ca,Mb){Mb=void 0===Mb?3:Mb;if(xa){var P=Array.isArray(Ca)?Ca:[Ca];P.forEach(function(za){return xa.addMorph(za)});Mb&&setTimeout(function(){return P.forEach(function(za){return za.fadeOut(2E3)})},1E3*Mb);return Ca}};ab.showLine=function(xa,Ca,Mb){Mb=void 0===Mb?
3E3:Mb;var P=Ca.start;Ca=Ca.end.subPt(P);var za=xa.addMorph({position:P,rotation:Ca.theta(),border:{width:1,color:ab.Color.red},width:Ca.fastR(),height:0});Mb&&setTimeout(function(){return za.fadeOut()},Mb);return za};ab.showConnector=Yb;ab.obj=mc;ab.promise=Tc;ab.string=Hb;ab.pt=Qb;ab.Color=dc;ab.Rectangle=fb;ab.rect=Hc;ab.morph=Xb;ab.easings=Mc;ab.Path=Lc;ab.Icon=ke;ab.Morph=Xd;ab.MorphicEnv=qb;ab.connect=Nb;ab.once=Id;ab.disconnect=Vc;ab.show=La;ab.show=La;(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),
Mb=Ca.hasOwnProperty("BoundsMarker")&&"function"===typeof Ca.BoundsMarker?Ca.BoundsMarker:Ca.BoundsMarker=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(){rb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{borderWidth:0,fill:ab.Color.transparent,reactsToPointer:!1,hasFixedPosition:!0})}},{key:"isEpiMorph",
get:function(){return!0}},{key:"markerLength",value:function(P){P=P.insetBy(-2);P=Math.min(P.width,P.height);return Math.max(4,Math.floor(10>P/10?P/2-5:P/10))}},{key:"createMarkerEdge",value:function(){return ab.morph({fill:ab.Color.red,reactsToPointer:!1,borderRadius:10})}},{key:"ensureMarkerCorners",value:function(){var P=this.topLeftH||(this.topLeftH=this.addMorph(this.createMarkerEdge())),za=this.topLeftV||(this.topLeftV=this.addMorph(this.createMarkerEdge())),Ta=this.topRightH||(this.topRightH=
this.addMorph(this.createMarkerEdge())),Fb=this.topRightV||(this.topRightV=this.addMorph(this.createMarkerEdge())),Cc=this.bottomRightH||(this.bottomRightH=this.addMorph(this.createMarkerEdge())),Uc=this.bottomRightV||(this.bottomRightV=this.addMorph(this.createMarkerEdge())),he=this.bottomLeftH||(this.bottomLeftH=this.addMorph(this.createMarkerEdge())),we=this.bottomLeftV||(this.bottomLeftV=this.addMorph(this.createMarkerEdge()));return[P,za,Ta,Fb,Cc,Uc,he,we]}},{key:"alignWithMorph",value:function(P){return this.alignWithBounds(P.globalBounds().translatedBy($world.scroll.negated()))}},
{key:"alignWithBounds",value:function(P){this.alignWithRect(P.insetBy(-20));return this.alignWithRect(P,!0)}},{key:"alignWithRect",value:function(P,za){var Ta=this.ensureMarkerCorners(),Fb=this.markerLength(P),Cc=[P.topLeft().addXY(0,0).extent(ab.pt(Fb,5)),P.topLeft().addXY(0,0).extent(ab.pt(5,Fb)),P.topRight().addXY(-Fb,0).extent(ab.pt(Fb,5)),P.topRight().addXY(-5,0).extent(ab.pt(5,Fb)),P.bottomRight().addXY(-5,-Fb).extent(ab.pt(5,Fb)),P.bottomRight().addXY(-Fb,-5).extent(ab.pt(Fb,5)),P.bottomLeft().addXY(0,
-5).extent(ab.pt(Fb,5)),P.bottomLeft().addXY(0,-Fb).extent(ab.pt(5,Fb))];Ta.forEach(function(Uc,he){return Uc.setBounds(Cc[he])});za&&(this.adjustOrigin(P.center()),this.opacity=0,this.scale=1.5,this.animate({opacity:1,scale:1,duration:300}));return this}},{key:"retract",value:function(P){var za=this,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fb){if(1==Fb.nextAddress)return Fb.yield(za.animate({scale:Math.max(30/P.width,1.05)}),2);Ta=za.center;return Fb.yield(za.animate({center:Ta,
scale:1,duration:300,easing:ab.easings.inOutExpo}),0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BoundsMarker"}},{key:"highlightMorph",value:function(P){return(new this).alignWithMorph(P)}},{key:"highlightBounds",value:function(P){return(new this).alignWithBounds(P)}}],Ca,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:2261,end:5920})})(ab.Morph);ec=Ba("S",function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Mb=Ca.hasOwnProperty("StatusMessage")&&"function"===typeof Ca.StatusMessage?Ca.StatusMessage:Ca.StatusMessage=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"relayout",value:function(){this.title=ab.string.truncate(this.message,(this.width/15).toFixed(),
"...")}},{key:"isEpiMorph",value:function(){return!0}},{key:"isStatusMessage",value:function(){return!0}},{key:"setMessage",value:function(P,za){this.message=P;this.color=za}},{key:"slideTo",value:function(P){var za=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return za.sliding=za.animate({position:P,duration:500}),Ta.yield(za.sliding,2);za.sliding=!1;Ta.jumpToEnd()})}},{key:"expand",value:function(){var P=this,za,Ta,Fb,Cc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==
Uc.nextAddress)return P.expandable?P.sliding?Uc.yield(P.sliding,2):Uc.jumpTo(2):Uc.return();za=P.world();if(!za||P.isMaximized)return Uc.return();P.isMaximized=!0;P.stayOpen=!0;Ta=P.getSubmorphNamed("message text");Ta.lineWrapping=!1;Object.assign(Ta,{clipMode:"auto",fixedWidth:!0,selectable:!0});P.expandedContent&&(Ta.value=P.expandedContent);Ta.fit();Fb=Ta.textBounds().extent();Cc=za.visibleBounds();Fb.y>Cc.extent().y&&(Fb.y=Cc.extent().y-20);Fb.x>Cc.extent().x&&(Fb.x=Cc.extent().x-20);Fb=P.extent.maxPt(Fb);
P.animate({extent:Fb,center:Cc.center(),duration:200});P.relayout();P.focus();Uc.jumpToEnd()})}},{key:"fit",value:function(){var P=this.getSubmorphNamed("message text");P&&(this.extent=ab.pt(100,35).maxPt(P.textBounds().extent()),this.relayout())}},{key:"focus",value:function(){var P=this.getSubmorphNamed("message text");P&&P.focus()}},{key:"onMouseUp",value:function(P){this.expand()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessage"}},{key:"properties",get:function(){return{extent:{defaultValue:ab.pt(200,
100)},stayOpen:{defaultValue:!1},slidable:{defaultValue:!0},isMaximized:{defaultValue:!1},expandable:{initialize:function(){this.expandable=!0}},maxLines:{defaultValue:Infinity},name:{defaultValue:"messageMorph"},master:{initialize:function(){this.master={auto:"styleguide://System/message"}}},message:{after:["submorphs","extent"],set:function(P){this.setProperty("message",P);var za=this.getSubmorphNamed("message text");if(za){za.value=P;var Ta=za.documentEndPosition;Ta.row>this.maxLines&&(za.replace({start:{row:this.maxLines,
column:0},end:Ta},"...\n"),this.expandedContent||(this.expandedContent=P));Ta=za.documentEndPosition;0!==Ta.column&&za.insertText("\n",Ta)}}},title:{isStyleProp:!0,derived:!0,set:function(P){this.getSubmorphNamed("message title").value=P},get:function(){return this.getSubmorphNamed("message title").value}},color:{after:["submorphs"],derived:!0,get:function(){return this.get("message icon").fontColor},set:function(P){this.get("message icon").fontColor=P;this.get("message icon")._parametrizedProps&&
(this.get("message icon")._parametrizedProps.fontColor=P)}},submorphs:{after:["extent"],initialize:function(){this.submorphs=[{name:"message icon",type:"label",value:ab.Icon.textAttribute("check-circle")},{name:"message text",type:"text"},{name:"message title",type:"label"},{name:"close button",type:"button"}];ab.connect(this.getSubmorphNamed("close button"),"fire",this,"remove");ab.connect(this,"extent",this,"relayout")}}}}}],Ca,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:5964,end:10242})}(ab.Morph));ab.StatusMessage=ec;ab.StatusMessage=ec;ab.StatusMessage=ec;var Rc=Ba("b",function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Mb=Ca.hasOwnProperty("StatusMessageForMorph")&&"function"===typeof Ca.StatusMessageForMorph?Ca.StatusMessageForMorph:Ca.StatusMessageForMorph=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"alignAtBottomOf",value:function(P){var za=this.world();za&&(this.bringToFront(),this.fit(),this.width=P.bounds().width,this.relayout(),P.world()&&(this.position=P.owner.worldPoint(P.bounds().bottomLeft())),P=za.visibleBounds(),P=this.bounds().top()+this.height-P.bottom(),0<P&&this.moveBy(ab.pt(0,-P)))}},{key:"onMouseUp",value:function(P){}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessageForMorph"}},
{key:"properties",get:function(){return{slidable:{defaultValue:!1},renderOnGPU:{defaultValue:!0},removeOnTargetMorphChange:{defaultValue:!0},targetMorph:{defaultValue:null,get:function(){var P=this.getProperty("targetMorph");return P&&$world.getMorphWithId(P)},set:function(P){this.setProperty("targetMorph",P?P.id:null);this.alignAtBottomOf(P)}},expandable:{after:["submorphs"],set:function(P){this.setProperty("expandable",P);if(P){var za=this.getSubmorphNamed("expand button")||this.addMorph({name:"expand button",
type:"button"});ab.connect(za,"fire",this,"expand")}else this.getSubmorphNamed("expand button")&&(this.getSubmorphNamed("expand button").remove(),ab.disconnect(za,"fire",this,"expand"))}}}}}],Ca,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10467,end:12318})}(ab.StatusMessage));ab.StatusMessageForMorph=
Rc;ab.StatusMessageForMorph=Rc;ab.StatusMessageForMorph=Rc;ab.showConnector=Yb;ab.showConnector=Yb;var pb=lively.FreezerRuntime.recorderFor("lively.ide/index.js");pb.info="import via sub modules";pb.info="import via sub modules";pb.info="import via sub modules";var bd=Ba("v",{});pb.valueWidgets=bd;pb.valueWidgets=bd;pb.valueWidgets=bd;var od=Ba("p",{});pb.popovers=od;pb.popovers=od;pb.popovers=od;var lb=lively.FreezerRuntime.recorderFor("lively.components/popup.js");lb.Morph=Xd;lb.VerticalLayout=
tb;lb.StyleSheet=Nd;lb.Icon=ke;lb.CustomLayout=eb;lb.Color=dc;lb.rect=Hc;lb.pt=Qb;lb.connect=Nb;lb.Path=hc;lb.duration=300;pb=Ba("P",function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.components/popup.js"),Mb=Ca.hasOwnProperty("Popover")&&"function"===typeof Ca.Popover?Ca.Popover:Ca.Popover=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"relayout",value:function(P){var za=this.get("body"),
Ta=this.get("arrow"),Fb=this.get("close button");Ta=Ta.height;P?(za.animate({topCenter:lb.pt(0,Ta),duration:200}),Fb.animate({topRight:za.topRight.addXY(8,-8),duration:200})):(za.topCenter=lb.pt(0,Ta),Fb.topRight=za.topRight.addXY(8,-8))}},{key:"close",value:function(){this.fadeOut(300)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Popover"}},{key:"properties",get:function(){return{epiMorph:{defaultValue:!0},hasFixedPosition:{defaultValue:!0},master:{initialize:function(){this.master=
{auto:"styleguide://SystemWidgets/popover/light"}}},targetMorph:{derived:!0,after:["submorphs"],defaultValue:{extent:lb.pt(200,200),fill:lb.Color.transparent,submorphs:[{name:"placeholder",type:"label",value:"No Target Specified"}]},get:function(){return this.get("body").submorphs[0]},set:function(P){var za=this;this.get("body").addMorph(P);this.whenRendered().then(function(){return za.relayout()})}},submorphs:{initialize:function(){var P=this;this.submorphs=[{type:"polygon",name:"arrow",topCenter:lb.pt(0,
0),borderColor:lb.Color.transparent,vertices:[lb.pt(-10,0),lb.pt(0,-15),lb.pt(10,0)]},{name:"body"},{name:"close button",type:"button",label:Object.assign(lb.Icon.makeLabel("times-circle"),{fontSize:18}),tooltip:"close",fill:null,extent:lb.pt(16,16),borderColor:lb.Color.transparent}];var za=$jscomp.makeIterator(this.submorphs);za.next();var Ta=za.next().value;za=za.next().value;lb.connect(za,"fire",this,"close");lb.connect(Ta,"extent",this,"relayout",{converter:"() => target.animated"});setTimeout(function(){return P.animated=
!0},1E3)}}}}}],Ca,{pathInPackage:function(){return"popup.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.components",version:"0.1.0"}}},{start:247,end:2617})}(lb.Morph));lb.Popover=pb;lb.Popover=pb;lb.Popover=pb;var Sa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js");Sa.Morph=Xd;Sa.TilingLayout=ob;Sa.morph=Xb;Sa.Label=ad;Sa.HorizontalLayout=dd;Sa.Icon=
ke;Sa.InputLine=wb;Sa.config=cb;Sa.connect=Nb;Sa.signal=Dc;Sa.Color=dc;Sa.LinearGradient=Db;Sa.pt=Qb;Sa.rect=Hc;Sa.num=oc;Sa.obj=mc;Sa.popovers=od;Sa.ValueScrubber=Oa;Sa.Popover=pb;(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("ContextSensitiveWidget")&&"function"===typeof Ca.ContextSensitiveWidget?Ca.ContextSensitiveWidget:Ca.ContextSensitiveWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return rb(Mb,xa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ContextSensitiveWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:Sa.Color.transparent},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?Sa.Color.white:Sa.Color.black}},layout:{initialize:function(){this.layout=new Sa.HorizontalLayout}},context:{serialize:!1}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1872,end:2441})})(Sa.Morph);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("ShortcutWidget")&&"function"===typeof Ca.ShortcutWidget?Ca.ShortcutWidget:Ca.ShortcutWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,
xa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(P){P.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShortcutWidget"}},{key:"properties",get:function(){return{title:{defaultValue:"No Title",after:["submorphs"],set:function(P){this.setProperty("title",P);this.getSubmorphNamed("valueString").value=P}},nativeCursor:{defaultValue:"pointer"},fontColor:{derived:!0,
set:function(P){this.submorphs.forEach(function(za){return za.fontColor=P})}},submorphs:{initialize:function(){this.submorphs=[Sa.Icon.makeLabel("arrow-right",{styleClasses:["TreeLabel"],fontSize:15,padding:Sa.rect(1,1,4,1)}),{type:"label",value:this.title,styleClasses:["TreeLabel"],fontWeight:"bold",name:"valueString",opacity:.8,borderRadius:5,padding:Sa.rect(0,0,0,2),nativeCursor:"pointer",fontSize:12,borderWidth:0}]}}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:2443,end:3793})})(Sa.ContextSensitiveWidget);od=function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("LayoutWidget")&&"function"===typeof Ca.LayoutWidget?Ca.LayoutWidget:Ca.LayoutWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return rb(Mb,xa,[{key:"layoutChanged",value:function(){this.title=this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}},{key:"openPopover",value:function(){var P=this,za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return za=new Sa.popovers.LayoutPopover({hasFixedPosition:!!P.ownerChain().find(function(Fb){return Fb.hasFixedPosition}),container:P.context}),Ta.yield(za.fadeIntoWorld(P.globalBounds().center()),2);Sa.connect(za,"layoutChanged",
P,"layoutChanged");Sa.signal(P,"openWidget",za);Ta.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutWidget"}},{key:"properties",get:function(){return{title:{after:["submorphs"],initialize:function(){this.title=this.context&&this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3802,end:4623})}(Sa.ShortcutWidget);Sa.LayoutWidget=od;Sa.LayoutWidget=od;Sa.LayoutWidget=od;pb=function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("ColorWidget")&&"function"===typeof Ca.ColorWidget?Ca.ColorWidget:Ca.ColorWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"relayout",
value:function(P){P?this.submorphs=this.color?this.color.isGradient?this.renderGradientValue():this.renderColorValue():this.renderNoColor():this.color&&(this.color.isGradient?this.updateGradientValue():this.updateColorValue())}},{key:"updateGradientValue",value:function(){var P=this.color;if(2*P.stops.length==this.submorphs.length-3){var za;for(za in this.color.stops){var Ta=P.stops[za];var Fb=Ta.color,Cc=Ta.offset,Uc=$jscomp.makeIterator(this.submorphs[2+2*za].submorphs).next().value;Ta=this.submorphs[3+
2*za];Uc.fill=Fb;Ta.value=(100*Cc).toFixed()+"%"+(za<P.stops.length-1?",":"")}}else this.submorphs=this.renderGradientValue()}},{key:"renderGradientValue",value:function(){return[{type:"label",styleClasses:["TreeLabel"],value:this.color.type+"(",name:"valueString"}].concat($jscomp.arrayFromIterable(this.renderStops()),[{type:"label",styleClasses:["TreeLabel"],value:")"}])}},{key:"updateColorValue",value:function(){this.getSubmorphNamed("color box").fill=this.color;this.getSubmorphNamed("valueString").value=
Sa.obj.safeToString(this.color)}},{key:"renderNoColor",value:function(){return[{extent:Sa.pt(15,15),fill:Sa.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:Sa.pt(5,7.5),fill:Sa.Color.white,borderColor:Sa.Color.gray.darker(),borderWidth:1,submorphs:[{type:"path",name:"no fill",vertices:[Sa.pt(0,0),Sa.pt(10,10)],borderColor:Sa.Color.red}]}]},{type:"label",value:"No Color",fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderColorValue",value:function(){return[{extent:Sa.pt(15,
15),fill:Sa.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:Sa.pt(5,7.5),fill:this.color,borderColor:Sa.Color.gray.darker(),nativeCursor:"pointer",borderWidth:1}]},{type:"label",value:Sa.obj.safeToString(this.color),fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderStops",value:function(){var P=this.color,za=[{type:"label",padding:Sa.rect(0,0,5,0),value:"linearGradient"==P.type?Sa.num.toDegrees(P.vectorAsAngle()).toFixed()+"\u00b0,":""}],Ta;
for(Ta in P.stops){var Fb=P.stops[Ta],Cc=Fb.color;Fb=Fb.offset;za.push({extent:Sa.pt(this.fontSize,this.fontSize),fill:Sa.Color.transparent,layout:new Sa.HorizontalLayout({spacing:3}),submorphs:[{styleClasses:["colorValue"],fill:Cc}]});za.push({type:"label",padding:Sa.rect(0,0,5,0),value:(100*Fb).toFixed()+"%"+(Ta<P.stops.length-1?",":"")})}return za}},{key:"onMouseDown",value:function(P){this.openFillEditor()}},{key:"update",value:function(P){this.color=P}},{key:"openFillEditor",value:function(){var P=
this,za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return za=new Sa.popovers.FillPopover({hasFixedPosition:!!P.ownerChain().find(function(Fb){return Fb.hasFixedPosition}),handleMorph:P.context,fillValue:P.color,title:"Fill Control",gradientEnabled:P.gradientEnabled}),Ta.yield(za.fadeIntoWorld(P.globalBounds().center()),2);Sa.connect(za,"fillValue",P,"update");Sa.signal(P,"openWidget",za);Ta.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColorWidget"}},
{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Sa.HorizontalLayout({direction:"centered"})}},selectionFontColor:{defaultValue:Sa.Color.white},nonSelectionFontColor:{defaultValue:Sa.Color.black},color:{defaultValue:Sa.Color.blue},gradientEnabled:{defaultValue:!1},fontSize:{defaultValue:14},isSelected:{after:["submorphs"],set:function(P){this.getProperty("isSelected")!=P&&(this.getSubmorphNamed("valueString").fontColor=P?this.selectionFontColor:this.nonSelectionFontColor,
this.setProperty("isSelected",P))}},submorphs:{after:["nonSelectionFontColor","selectionFontColor"],initialize:function(){Sa.connect(this,"color",this,"relayout",{converter:function(P,za){return(za&&za.isColor)!=(P&&P.isColor)}});this.relayout(!0)}}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:4687,end:10140})}(Sa.ContextSensitiveWidget);Sa.ColorWidget=pb;Sa.ColorWidget=pb;Sa.ColorWidget=pb;var qc=function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("BooleanWidget")&&"function"===typeof Ca.BooleanWidget?Ca.BooleanWidget:Ca.BooleanWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"onMouseDown",value:function(P){this.boolean=
!this.boolean}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BooleanWidget"}},{key:"properties",get:function(){return{fontFamily:{defaultValue:Sa.config.codeEditor.defaultStyle.fontFamily},nativeCursor:{defaultValue:"pointer"},boolean:{set:function(P){this.setProperty("boolean",P);this.value=Sa.obj.safeToString(P);this.fontColor=this.boolean?Sa.Color.green:Sa.Color.red}}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10149,end:10634})}(Sa.Label);Sa.BooleanWidget=qc;Sa.BooleanWidget=qc;Sa.BooleanWidget=qc;var le=Ba("N",function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("NumberWidget")&&"function"===typeof Ca.NumberWidget?Ca.NumberWidget:Ca.NumberWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return rb(Mb,xa,[{key:"onMouseDown",value:function(P){rb._get(Object.getPrototypeOf(Mb.prototype),"onMouseDown",this).call(this,P);"up"==P.targetMorph.name&&this.increment();"down"==P.targetMorph.name&&this.decrement()}},{key:"spec",value:function(){return Sa.obj.dissoc(rb._get(Object.getPrototypeOf(Mb.prototype),"spec",this).call(this),["submorphs"])}},{key:"update",value:function(P,za){za=void 0===za?!0:za;this.setProperty("number",za?P/this.scaleFactor:P);Sa.signal(this,"number",this.number);
this.relayout(za)}},{key:"relayoutButtons",value:function(){var P=this.getSubmorphNamed("up"),za=this.getSubmorphNamed("down");this.getSubmorphNamed("value");P.height=za.height=(this.height-2)/2;P.width=za.width=20}},{key:"onChange",value:function(P){rb._get(Object.getPrototypeOf(Mb.prototype),"onChange",this).call(this,P);"extent"!=P.prop||this.autofit||this.relayout()}},{key:"relayout",value:function(P){var za=this.getSubmorphNamed("value");za&&(this.autofit?(P||(za.value=this.number*this.scaleFactor),
za.fit(),this.height=za.height,this.width=za.width+20):P||(za.width=this.width-20),this.relayoutButtons(),P||(za.value=Sa.num.roundTo(this.number*this.scaleFactor,1),za.min=-Infinity!=this.min?this.min*this.scaleFactor:this.min,za.max=Infinity!=this.max?this.max*this.scaleFactor:this.max,za.unit=this.unit))}},{key:"increment",value:function(){void 0!=this.max&&this.number>=this.max||this.update(this.number+1/this.scaleFactor,!1)}},{key:"decrement",value:function(){void 0!=this.min&&this.number<=this.min||
this.update(this.number-1/this.scaleFactor,!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberWidget"}},{key:"properties",get:function(){return{unit:{type:"Enum",isStyleProp:!0,values:["px","%","pt",""]},autofit:{defaultValue:!0,after:["submorphs","extent"],set:function(P){this.setProperty("autofit",P);this.getSubmorphNamed("value").scaleToBounds=!P}},number:{defaultValue:0,after:["unit","autofit"],set:function(P){this.setProperty("number",P);this.relayout(!1)}},min:{defaultValue:-Infinity},
max:{defaultValue:Infinity},floatingPoint:{after:["number","submorphs"],set:function(P){this.setProperty("floatingPoint",P);this.get("value").floatingPoint=P},get:function(){var P=/[+-]?([0-9]*[.])?[0-9]+/.exec(this.number);return this.getProperty("floatingPoint")||1==this.scaleFactor&&P&&!!P[1]}},padding:{isStyleProp:!0,defaultValue:Sa.rect(5,3,0,0),after:["submorphs"],set:function(P){this.setProperty("padding",P);this.getSubmorphNamed("value").padding=P}},extent:{defaultValue:Sa.pt(70,25)},scaleFactor:{defaultValue:1,
get:function(){return this.getProperty("scaleFactor")||1}},baseFactor:{after:["submorphs"],derived:!0,get:function(){return this.get("value").baseFactor},set:function(P){this.get("value").baseFactor=P}},styleClasses:{defaultValue:["unfocused"]},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/number field/light"}}},fontColor:{isStyleProp:!0,defaultValue:Sa.Color.rgbHex("#0086b3"),set:function(P){this.setProperty("fontColor",P)}},isSelected:{set:function(P){this.getProperty("isSelected")!=
P&&(P?(this.addStyleClass("selected"),this.removeStyleClass("unselected")):(this.removeStyleClass("selected"),this.addStyleClass("unselected")),this.setProperty("isSelected",P))}},fontFamily:{defaultValue:"Sans-Serif",isStyleProp:!0,set:function(P){this.setProperty("fontFamily",P)}},fontSize:{defaultValue:15,isStyleProp:!0,set:function(P){this.setProperty("fontSize",P)}},layout:{initialize:function(){this.layout=new Sa.TilingLayout({axis:"column",orderByIndex:!0,align:"center"})}},submorphs:{after:["min",
"max"],initialize:function(){var P=this;this.submorphs=[new Sa.ValueScrubber({name:"value",unit:this.unit,floatingPoint:this.floatingPoint,scaleToBounds:!1,min:this.min,max:this.max}),Sa.Icon.makeLabel("sort-up",{name:"up"}),Sa.Icon.makeLabel("sort-up",{name:"down",rotation:Math.PI})];Sa.connect(this.get("value"),"scrub",this,"update");this.whenRendered().then(function(){return P.relayout()})}}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10643,end:16590})}(Sa.Morph));Sa.NumberWidget=le;Sa.NumberWidget=le;Sa.NumberWidget=le;var Zd=function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("ShadowWidget")&&"function"===typeof Ca.ShadowWidget?Ca.ShadowWidget:Ca.ShadowWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return rb(Mb,xa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return za=new Sa.popovers.ShadowPopover({hasFixedPosition:!!P.ownerChain().find(function(Fb){return Fb.hasFixedPosition}),shadowValue:P.shadowValue}),Ta.yield(za.fadeIntoWorld(P.globalBounds().center()),2);Sa.connect(za,"shadowValue",P,"shadowValue");Sa.connect(P,"shadowValue",P,
"update");Sa.signal(P,"openWidget",za);Ta.jumpToEnd()})}},{key:"update",value:function(){this.renderShadowDisplay()}},{key:"renderShadowDisplay",value:function(){this.shadowValue?1<this.submorphs.length?this.updateShadowDisplay():this.initShadowDisplay():this.submorphs=[{opacity:.8,reactsToPointer:!1,styleClasses:["TreeLabel"],name:"valueString",type:"label",value:"No Shadow"}]}},{key:"updateShadowDisplay",value:function(){var P=this.shadowValue,za=P.blur,Ta=P.spread,Fb=P.distance;P=P.color;var Cc=
$jscomp.makeIterator(this.submorphs),Uc=Cc.next().value,he=Cc.next().value;he=$jscomp.makeIterator(he.submorphs).next().value;Cc=Cc.next().value;Uc.value=(this.shadowValue.inset?"inset":"drop")+"-shadow(";he.fill=P;Cc.value=", "+za+"px, "+Fb+"px, "+Ta+"px)"}},{key:"initShadowDisplay",value:function(){var P=this.shadowValue,za=P.blur,Ta=P.spread,Fb=P.distance;P=P.color;this.submorphs=[{name:"valueString",opacity:.7,reactsToPointer:!1,type:"label",value:(this.shadowValue.inset?"inset":"drop")+"-shadow("},
Sa.morph({fill:Sa.Color.transparent,extent:Sa.pt(this.fontSize+6,this.fontSize+4),submorphs:[{extent:Sa.pt(this.fontSize,this.fontSize),position:Sa.pt(2,2),fill:P,borderColor:Sa.Color.black,borderWidth:1}]}),{name:"valueString",type:"label",opacity:.7,reactsToPointer:!1,value:", "+za+"px, "+Fb+"px, "+Ta+"px)"}]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShadowWidget"}},{key:"properties",get:function(){return{shadowValue:{after:["submorphs"],defaultValue:null,set:function(P){this.setProperty("shadowValue",
P);this.renderShadowDisplay()}},fill:{defaultValue:Sa.Color.transparent},nativeCursor:{defaultValue:"pointer"},fontSize:{defaultValue:12},fontColor:{derived:!0,set:function(P){this.submorphs.forEach(function(za){return za.fontColor=P})}},isSelected:{defaultValue:!1,set:function(P){this.setProperty("isSelected",P);this.fontColor=P?Sa.Color.white:Sa.Color.black}},layout:{initialize:function(){this.layout=new Sa.HorizontalLayout}},submorphs:{initialize:function(){this.update()}}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:16599,end:19722})}(Sa.Morph);Sa.ShadowWidget=Zd;Sa.ShadowWidget=Zd;Sa.ShadowWidget=Zd;var Fe=function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("PointWidget")&&"function"===typeof Ca.PointWidget?Ca.PointWidget:Ca.PointWidget=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return za=new Sa.popovers.PointPopover({pointValue:P.pointValue,hasFixedPosition:!!P.ownerChain().find(function(Fb){return Fb.hasFixedPosition})}),Ta.yield(za.fadeIntoWorld(P.globalBounds().center()),
2);Sa.connect(za,"pointValue",P,"pointValue");Sa.signal(P,"openWidget",za);Ta.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PointWidget"}},{key:"properties",get:function(){return{isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?this.selectionFontColor:this.nonSelectionFontColor}},selectionFontColor:{isStyleProp:!0,defaultValue:Sa.Color.white},nonSelectionFontColor:{isStyleProp:!0,defaultValue:Sa.Color.black},fontFamily:{defaultValue:Sa.config.codeEditor.defaultStyle.fontFamily},
nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},pointValue:{after:["textAndAttributes"],set:function(P){var za=Sa.Color.rgbHex("#0086b3");this.setProperty("pointValue",P);this.textAndAttributes=["pt(",null,P.x.toFixed(),{fontColor:za},",",{},P.y.toFixed(),{fontColor:za},")",null];this.fixedHeight=this.fixedWidth=!0;this.height=20;this.width=this.textString.length*this.fontSize}}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:19731,end:21375})}(Sa.Label);Sa.PointWidget=Fe;Sa.PointWidget=Fe;Sa.PointWidget=Fe;var Oc=function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("PaddingWidget")&&"function"===typeof Ca.PaddingWidget?Ca.PaddingWidget:Ca.PaddingWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return rb(Mb,xa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return za=new Sa.popovers.RectanglePopover({hasFixedPosition:!!P.ownerChain().find(function(Fb){return Fb.hasFixedPosition}),rectangle:P.rectangle}),za.relayout(),Ta.yield(za.fadeIntoWorld(P.globalBounds().center()),2);Sa.connect(za,"rectangle",P,"rectangle");Sa.signal(P,"openWidget",
za);Ta.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PaddingWidget"}},{key:"properties",get:function(){return{nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},fontFamily:{defaultValue:Sa.config.codeEditor.defaultStyle.fontFamily},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?Sa.Color.white:Sa.Color.black}},rectangle:{defaultValue:Sa.rect(0),set:function(P){this.setProperty("rectangle",
P);this.value=Sa.obj.safeToString(P)}}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:21384,end:22445})}(Sa.Label);Sa.PaddingWidget=Oc;Sa.PaddingWidget=Oc;Sa.PaddingWidget=Oc;var te=function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("IconWidget")&&
"function"===typeof Ca.IconWidget?Ca.IconWidget:Ca.IconWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return za=new Sa.popovers.IconPopover({hasFixedPosition:!!P.ownerChain().find(function(Fb){return Fb.hasFixedPosition})}),
Ta.yield(za.fadeIntoWorld(P.globalBounds().center()),2);Sa.connect(za,"select",P,"iconValue",{converter:function(Fb){return Fb&&Sa.Icon.makeLabel(Fb).value},varMapping:{Icon:ke}});Sa.signal(P,"openWidget",za);Ta.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"IconWidget"}},{key:"properties",get:function(){return{fontColor:{defaultValue:Sa.Color.gray.darker()},fontFamily:{defaultValue:"FontAwesome"},nativeCursor:{defaultValue:"pointer"},iconValue:{derived:!0,get:function(){return this.value},
set:function(P){this.value=P||"No Icon"}}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22454,end:23385})}(Sa.Label);Sa.IconWidget=te;Sa.IconWidget=te;Sa.IconWidget=te;var md=function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ca.hasOwnProperty("StringWidget")&&
"function"===typeof Ca.StringWidget?Ca.StringWidget:Ca.StringWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"truncate",value:function(P){return 200<P.length?P.slice(0,20)+"...":P}},{key:"onFocus",value:function(P){var za=this,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fb){if(1==Fb.nextAddress)return rb._get(Object.getPrototypeOf(Mb.prototype),"onFocus",za).call(za,P),za.readOnly?
Fb.return():za.stringTooLong?Fb.yield(za.world().editPrompt("edit string",{requester:za,input:za.stringValue}),2):(za.borderColor=Sa.Color.white.withA(.9),za.textString=za.stringValue,Fb.return());Ta=Fb.yieldResult;if("string"===typeof Ta)za.onInput(Ta);Fb.jumpToEnd()})}},{key:"onBlur",value:function(P){rb._get(Object.getPrototypeOf(Mb.prototype),"onBlur",this).call(this,P);this.readOnly||(this.borderColor=Sa.Color.transparent,this.onInput(this.textString))}},{key:"onInput",value:function(P){this.owner.focus();
Sa.signal(this,"inputAccepted",P);this.stringValue=P}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:Sa.Color.transparent},fontColor:{defaultValue:Sa.Color.blue},nativeCursor:{defaultValue:"auto"},borderColor:{defaultValue:Sa.Color.transparent},borderStyle:{defaultValue:"dashed"},borderRadius:{defaultValue:4},borderWidth:{defaultValue:1},padding:{defaultValue:Sa.rect(0,0,0,0)},fixedWidth:{defaultValue:!1},
fixedHeight:{defaultValue:!1},stringValue:{after:["textString"],set:function(P){this.setProperty("stringValue",P);this.textString=this.truncate(P);this.nativeCursor=this.stringTooLong?"pointer":"auto"}},stringTooLong:{readOnly:!0,get:function(){return this.stringValue.includes("\n")}},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?Sa.Color.white:Sa.Color.blue}}}}}],Ca,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23394,end:25345})}(Sa.InputLine);Sa.StringWidget=md;Sa.StringWidget=md;Sa.StringWidget=md;Sa.valueWidgets=bd;Object.assign(Sa.valueWidgets,{NumberWidget:le,StringWidget:md,IconWidget:te,PaddingWidget:Oc,ShadowWidget:Zd,PointWidget:Fe,BooleanWidget:qc,LayoutWidget:od,ColorWidget:pb});var Eb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js");Eb.Ellipse=
Gb;Eb.Icon=ke;Eb.Morph=Xd;Eb.Path=Lc;Eb.Text=rd;Eb.HorizontalLayout=dd;Eb.VerticalLayout=tb;Eb.morph=Xb;Eb.Color=dc;Eb.pt=Qb;Eb.rect=Hc;Eb.Rectangle=fb;Eb.arr=pc;Eb.connect=Nb;Eb.disconnect=Vc;Eb.LabeledCheckBox=sc;Eb.DropDownSelector=vc;Eb.Button=fc;Eb.Menu=rc;Eb.NumberWidget=le;Eb.InteractiveMorphSelector=ed;Eb.easings=Mc;(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ca.hasOwnProperty("AxisHalo")&&"function"===typeof Ca.AxisHalo?Ca.AxisHalo:Ca.AxisHalo=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var za=P.halo;P=P.targetAxis;rb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{fill:Eb.Color.transparent,halo:za,targetAxis:P,container:za.container});this.initialize()}},{key:"initialize",value:function(){this.setBounds(this.fetchBounds());this.minSlider=
this.minSlider();this.axisMenu=this.axisMenu();this.proportionSlider=this.proportionSlider();this.proportionSlider.addMorph(this.minSlider);this.submorphs=[this.proportionSlider,this.axisMenu];this.halo.addGuide(this)}},{key:"forceMenuHidden",set:function(P){this._forceMenuHidden=P;this.axisMenu.visible=!P}},{key:"forceMenuHidden",get:function(){return this._forceMenuHidden}},{key:"lastAxis",get:function(){return!this.targetAxis.after}},{key:"fetchBounds",value:function(){return this.fetchPosition().extent(this.fetchExtent())}},
{key:"alignWithTarget",value:function(){this.extent=this.fetchExtent();this.position=this.fetchPosition();this.proportionSlider.alignWithTarget();this.axisMenu.alignWithTarget()}},{key:"onHoverIn",value:function(){this.minSlider.requestToShow();this.axisMenu.visible=!this.forceMenuHidden&&!0}},{key:"onHoverOut",value:function(P){this.minSlider.requestToHide();this.axisMenu.visible=this.forceMenuVisible||!1}},{key:"proportionSlider",value:function(){var P=this,za=this,Ta=this.proportionViewer();return this.halo.addGuide(new Eb.Morph({nativeCursor:this.getResizeCursor(),
fill:Eb.Color.transparent,submorphs:[this.devider(),Ta],alignWithTarget:function(){this.setBounds(za.getProportionSliderBounds(this))},onDragStart:function(){Ta.visible=!0},onDrag:function(Fb){P.adjustStretch(P.getDelta(Fb));P.halo.alignWithTarget()},onDragEnd:function(){Ta.visible=!1}}))}},{key:"devider",value:function(){return new Eb.Morph({visible:!this.lastAxis,fill:Eb.Color.black.withA(.5),bounds:this.getDeviderBounds(),draggable:!1,reactsToPointer:!1})}},{key:"minSlider",value:function(){var P=
this,za=this,Ta=this.minSpaceVisualizer(),Fb=this.minViewer();return this.halo.addGuide(new Eb.Ellipse({nativeCursor:this.getResizeCursor(),fill:Eb.Color.green,extent:Eb.pt(10,10),visible:!1,submorphs:[Ta,Fb],becomesActiveOnHover:!0,alignWithTarget:function(){this.position=za.getMinSliderPosition()},requestToShow:function(){this.visible=!za.targetAxis.fixed},requestToHide:function(){this.active?this.shouldHide=!0:this.visible=!1},onDragStart:function(){za.forceMenuHidden=!0;Fb.visible=!0;this.active=
Ta.visible=!0},onDrag:function(Cc){P.targetAxis.min+=-P.getDelta(Cc);P.halo.alignWithTarget()},onDragEnd:function(){za.forceMenuHidden=!1;Fb.visible=!1;this.active=Ta.visible=!1;this.shouldHide&&(this.shouldHide=this.visible=!1)}}))}},{key:"minViewer",value:function(){var P=this;return this.viewer({position:this.getMinViewerPosition(),alignWithTarget:function(){this.textString="min: "+P.targetAxis.min.toFixed()+"px !"}})}},{key:"minSpaceBorder",value:function(){return new Eb.Path(Object.assign({position:Eb.pt(-1,
-1),borderStyle:"dashed",borderColor:Eb.Color.green,borderWidth:2},this.getMinSpaceBorder()))}},{key:"minSpaceVisualizer",value:function(){var P=this,za=this.minSpaceBorder();return this.halo.addGuide(new Eb.Morph({fill:Eb.Color.green.withA(.1),visible:!1,isHaloItem:!0,submorphs:[za],alignWithTarget:function(){this.extent=P.getMinSpaceExtent();this.topLeft=Eb.pt(5,5)}}))}},{key:"axisMenu",value:function(){var P=this.lockButton(),za=this.menuButton(),Ta=this;return new Eb.Morph({layout:this.getMenuLayout(),
submorphs:[P,za],fill:Eb.Color.transparent,visible:!1,becomesActiveOnHover:!0,alignWithTarget:function(){this.bottomRight=this.owner.extent.subPt(Ta.getMenuOffset(this))}})}},{key:"lockButton",value:function(){var P=this;return this.halo.addGuide(new Eb.Morph({fill:Eb.Color.transparent,extent:Eb.pt(25,25),submorphs:[{center:Eb.pt(12.5,12.5),fill:Eb.Color.transparent,styleClasses:["fa","fa-unlock"]}],alignWithTarget:function(){P.targetAxis.fixed?(this.fontColor=Eb.Color.red,this.submorphs[0].styleClasses=
["fa","fa-lock"]):(this.fontColor=Eb.Color.green,this.submorphs[0].styleClasses=["fa","fa-unlock"])},onMouseDown:function(){this.toggleLock()},toggleLock:function(){P.targetAxis.fixed=!P.targetAxis.fixed;P.halo.alignWithTarget()}}))}},{key:"menuButton",value:function(){var P=this,za=this;return new Eb.Morph({fill:Eb.Color.transparent,extent:Eb.pt(25,25),submorphs:[{fill:Eb.Color.transparent,styleClasses:["fa","fa-cog"],center:Eb.pt(12.5,12.5)}],onMouseDown:function(Ta){za.forceMenuVisible=!0;this.addMorph(Ta.state.menu=
new Eb.Menu({position:Eb.pt(15,15),items:[["Remove "+za.subject,function(){P.targetAxis.remove();P.halo.initGuides();P.halo.alignWithTarget()}],["Insert "+za.subject+" before",function(){P.targetAxis.addBefore();P.halo.initGuides();P.halo.alignWithTarget()}],["Insert "+za.subject+" after",function(){P.targetAxis.addAfter();P.halo.initGuides();P.halo.alignWithTarget()}]]}))}})}},{key:"viewer",value:function(P){var za=P.position;P=P.alignWithTarget;return this.halo.addGuide(new Eb.Text({styleClasses:["Halo"],
padding:Eb.Rectangle.inset(6),visible:!1,borderRadius:10,fontColor:Eb.Color.white,fill:Eb.Color.black.withA(.5),position:za,alignWithTarget:P,readOnly:!0}))}},{key:"proportionViewer",value:function(){var P=this;return this.viewer({position:this.getProportionViewerPosition(),alignWithTarget:function(){this.textString=P.targetAxis.length.toFixed(1)+"px"}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"AxisHalo"}}],Ca,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:660,end:7979})})(Eb.Morph);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ca.hasOwnProperty("RowHalo")&&"function"===typeof Ca.RowHalo?Ca.RowHalo:Ca.RowHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:Symbol.for("lively-instance-initialize"),
value:function(P){var za=P.row;P=P.halo;rb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:P.target.row(za),halo:P})}},{key:"subject",get:function(){return"row"}},{key:"adjustStretch",value:function(P){this.targetAxis.height+=P}},{key:"getDelta",value:function(P){return P.state.dragDelta.y}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.y}},{key:"fetchPosition",value:function(){return Eb.pt(-45,this.axisOffset()+
10)}},{key:"fetchExtent",value:function(){return Eb.pt(40,this.targetAxis.length-10)}},{key:"getMenuOffset",value:function(P){return this.targetAxis.length>P.height?Eb.pt(2,5):Eb.pt(26,10)}},{key:"getMenuLayout",value:function(){return new Eb.VerticalLayout}},{key:"getResizeCursor",value:function(){return"row-resize"}},{key:"getMinViewerPosition",value:function(){return Eb.pt(50,20)}},{key:"getMinSliderPosition",value:function(){return Eb.pt(0,-this.targetAxis.min)}},{key:"getMinSpaceExtent",value:function(){return Eb.pt(this.container.width+
45,this.targetAxis.min)}},{key:"getMinSpaceBorder",value:function(){return{extent:Eb.pt(this.container.width+50,2),vertices:[Eb.pt(0,1),Eb.pt(this.container.width+50,1)]}}},{key:"getProportionViewerPosition",value:function(){return Eb.pt(40,20)}},{key:"getProportionSliderBounds",value:function(P){return Eb.pt(0,P.owner.height-5).extent(Eb.pt(40,10))}},{key:"getDeviderBounds",value:function(){return Eb.pt(15,4).extent(Eb.pt(25,2))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RowHalo"}}],
Ca,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:7981,end:9208})})(Eb.AxisHalo);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ca.hasOwnProperty("ColumnHalo")&&"function"===typeof Ca.ColumnHalo?Ca.ColumnHalo:Ca.ColumnHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var za=P.col;P=P.halo;rb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:P.target.col(za),halo:P})}},{key:"subject",get:function(){return"column"}},{key:"adjustStretch",value:function(P){this.targetAxis.width+=P}},{key:"getDelta",value:function(P){return P.state.dragDelta.x}},{key:"axisOffset",
value:function(){return this.targetAxis.origin.position.x}},{key:"fetchPosition",value:function(){return Eb.pt(this.axisOffset()+10,-45)}},{key:"fetchExtent",value:function(){return Eb.pt(this.targetAxis.length-10,40)}},{key:"getMenuOffset",value:function(P){return this.targetAxis.length>P.width?Eb.pt(5,3):Eb.pt(8,26)}},{key:"getMenuLayout",value:function(){return new Eb.HorizontalLayout}},{key:"getResizeCursor",value:function(){return"col-resize"}},{key:"getMinViewerPosition",value:function(){return Eb.pt(20,
50)}},{key:"getMinSliderPosition",value:function(){return Eb.pt(-this.targetAxis.min,0)}},{key:"getMinSpaceExtent",value:function(){return Eb.pt(this.targetAxis.min,this.container.height+45)}},{key:"getMinSpaceBorder",value:function(){return{extent:Eb.pt(2,this.container.height+50),vertices:[Eb.pt(1,0),Eb.pt(1,this.container.height+50)]}}},{key:"getProportionViewerPosition",value:function(){return Eb.pt(20,40)}},{key:"getProportionSliderBounds",value:function(P){return Eb.pt(P.owner.width-5,0).extent(Eb.pt(10,
40))}},{key:"getDeviderBounds",value:function(){return Eb.pt(4,15).extent(Eb.pt(2,25))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColumnHalo"}}],Ca,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:9210,end:10442})})(Eb.AxisHalo);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
Mb=Ca.hasOwnProperty("CellGuide")&&"function"===typeof Ca.CellGuide?Ca.CellGuide:Ca.CellGuide=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"menuItems",value:function(){var P=this,za=Eb.Icon.textAttribute("check-square-o"),Ta=Eb.Icon.textAttribute("square-o");za[1].textStyleClasses.push("annotation");Ta[1].textStyleClasses.push("annotation");Ta[1].paddingRight="2px";return[["Resize Policy",[[["Rigid  ",
null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?Ta:za)),function(){P.cellGroup.resize=!1}],[["Space Filling  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?za:Ta)),function(){P.cellGroup.resize=!0}]]],["Align at...",["center"].concat($jscomp.arrayFromIterable((new Eb.Rectangle).sides),$jscomp.arrayFromIterable((new Eb.Rectangle).corners)).map(function(Fb){return[[Fb,{paddingRight:"2px"}].concat($jscomp.arrayFromIterable(P.cellGroup.align==Fb?za:Ta),["  ",null]),function(){return P.cellGroup.align=
Fb}]})]].concat(this.cellGroup.morph?[["Release Morph from Cell",function(){var Fb=P.cellGroup.morph;Fb&&(P.world().firstHand.grab(Fb),P.world().firstHand.longClickGrab=!0,Fb.position=Eb.pt(0))}]]:[])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CellGuide"}},{key:"properties",get:function(){return{cellGroup:{}}}}],Ca,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10444,end:11722})})(Eb.Morph);(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ca.hasOwnProperty("LayoutHalo")&&"function"===typeof Ca.LayoutHalo?Ca.LayoutHalo:Ca.LayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutHalo"}},
{key:"properties",get:function(){return{container:{},target:{},pointerId:{},halosEnabled:{defaultValue:!1},isEpiMorph:{defaultValue:!0},isHaloItem:{defaultValue:!0},borderColor:{defaultValue:Eb.Color.orange},borderWidth:{defaultValue:2},styleClasses:{defaultValue:["Halo"]}}}}],Ca,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:11724,end:12137})})(Eb.Morph);bd=Ba("G",function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ca.hasOwnProperty("GridLayoutHalo")&&"function"===typeof Ca.GridLayoutHalo?Ca.GridLayoutHalo:Ca.GridLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"previewDrop",value:function(P){1>P.length||(P=this.cellGuides.find(function(za){return za.fullContainsWorldPoint($world.firstHand.position)}),
P!=this.currentCell&&this.currentCell&&this.currentCell.stopPreview(),(this.currentCell=P)&&this.currentCell.startPreview())}},{key:"handleDrop",value:function(P){var za=this;this.currentCell&&P.whenRendered().then(function(){return za.currentCell.cellGroup.morph=P})}},{key:"initialize",value:function(){this.initGuides();this.alignWithTarget();this.focus()}},{key:"optionControls",value:function(){var P=this.target,za=new Eb.LabeledCheckBox({name:"compensateOrigin",label:"Compensate Origin",fill:Eb.Color.transparent,
checked:P.compensateOrigin}),Ta=new Eb.LabeledCheckBox({label:"Resize Submorphs",fill:Eb.Color.transparent,name:"fitToCell",checked:P.fitToCell});Eb.connect(za,"checked",P,"compensateOrigin");Eb.connect(Ta,"checked",P,"fitToCell");Eb.connect(za,"checked",this,"alignWithTarget");return[za,Ta]}},{key:"isLayoutHalo",get:function(){return!1}},{key:"alignWithTarget",value:function(){this.target.apply();this.position=this.container.globalPosition;this.target.compensateOrigin&&this.moveBy(this.container.origin.negated());
this.extent=this.container.extent;this.addMissingGuides();Eb.arr.reverse(this.guides).forEach(function(P){return P.alignWithTarget()})}},{key:"addMissingGuides",value:function(){var P=this;Eb.arr.withoutAll(this.target.cellGroups,this.guides.map(function(za){return za.cellGroup})).forEach(function(za){return P.addMorph(P.cellGuide(za))})}},{key:"initGuides",value:function(){this.submorphs=[];this.guides=[];this.initCellGuides();this.initColumnGuides();this.initRowGuides()}},{key:"initCellGuides",
value:function(){var P=this,za=this.addMorph({fill:Eb.Color.transparent,borderRadius:this.borderRadius,extent:this.extent});this.target.cellGroups.forEach(function(Ta){za.addMorph(P.cellGuide(Ta))});this.cellGuides=za.submorphs;this.addMorph(this.resizer())}},{key:"addGuide",value:function(P){P.isHaloItem=!0;this.guides.push(P);return P}},{key:"initRowGuides",value:function(){var P=this,za=this;this.addGuide(this.addMorph(new Eb.Morph({width:25,fill:Eb.Color.gray.withA(.7),borderRadius:15,height:this.container.height,
topRight:Eb.pt(-5,0),alignWithTarget:function(){this.height=za.container.height}})));Eb.arr.range(0,this.target.rowCount-1).forEach(function(Ta){P.addMorph(new Eb.RowHalo({row:Ta,halo:P}))})}},{key:"initColumnGuides",value:function(){var P=this,za=this;this.addGuide(this.addMorph(new Eb.Morph({height:25,fill:Eb.Color.gray.withA(.7),borderRadius:15,width:this.container.width,bottomLeft:Eb.pt(0,-5),alignWithTarget:function(){this.width=za.container.width}})));Eb.arr.range(0,this.target.columnCount-
1).forEach(function(Ta){P.addMorph(new Eb.ColumnHalo({col:Ta,halo:P}))})}},{key:"resizer",value:function(){var P=this;return this.addGuide(new Eb.Morph({fill:Eb.Color.transparent,extent:Eb.pt(25,25),nativeCursor:"nwse-resize",onDrag:function(za){P.container.resizeBy(za.state.dragDelta);P.alignWithTarget()},alignWithTarget:function(){this.bottomRight=P.extent}}))}},{key:"cellResizer",value:function(P,za){var Ta=this,Fb="topLeft"==za?"bottomRight":"topLeft";return new Eb.Ellipse({borderWidth:1,visible:!1,
borderColor:Eb.Color.black,nativeCursor:"nwse-resize",removeCell:function(Cc){P.disconnect(Cc);Ta.alignWithTarget()},addCell:function(Cc){P.connect(Cc);Ta.alignWithTarget()},start:function(){this.fixpointCell=P[Fb];this.draggedDelta=P.bounds().partNamed(za);this.debugMorph=Ta.addMorph(new Eb.Morph({fill:Eb.Color.orange.withA(.5)}))},update:function(Cc){var Uc=this;this.draggedDelta=this.draggedDelta.addPt(Cc);var he=Eb.Rectangle.unionPts([this.draggedDelta]).union(this.fixpointCell.bounds());this.debugMorph.setBounds(he);
Ta.cells.forEach(function(we){var nf=he.intersection(we.bounds()).area()/we.bounds().area();P.includes(we)&&.1>nf&&Uc.removeCell(we);!P.includes(we)&&nf>1/3&&Uc.addCell(we)})},onDragEnd:function(Cc){this.debugMorph.remove()},onDragStart:function(Cc){this.start(Cc.position)},onDrag:function(Cc){this.update(Cc.state.dragDelta)}})}},{key:"cellGuide",value:function(P){var za=this,Ta=this.cellResizer(P,"topLeft"),Fb=this.cellResizer(P,"bottomRight");return this.addGuide(new Eb.CellGuide({cellGroup:P,bounds:P.bounds(),
fill:Eb.Color.transparent,borderColor:Eb.Color.orange,borderWidth:1,isHaloItem:!0,isCell:!0,draggable:!1,submorphs:[Ta,Fb],onMouseDown:function(Cc){this.becomeActive()},deactivate:function(){this.borderColor=Eb.Color.orange;this.fill=Eb.Color.transparent;this.submorphs.forEach(function(Cc){Cc.visible=!1})},becomeActive:function(){za.guides.forEach(function(Cc){Cc.isCell&&Cc.deactivate()});this.borderColor=Eb.Color.rgbHex("#1565C0");this.fill=Eb.Color.rgbHex("#1565C0").withA(.3);za.addMorph(this.remove());
this.submorphs.forEach(function(Cc){Cc.visible=!0})},startPreview:function(Cc){this.fill=Eb.Color.orange.withA(.7)},stopPreview:function(Cc){this.fill=Eb.Color.transparent},onDrop:function(Cc){var Uc=$jscomp.makeIterator(Cc.hand.grabbedMorphs).next().value;Cc.hand.dropMorphsOn(za.container);P.morph=Uc},alignWithTarget:function(){P.bounds().isNonEmpty()?(this.setBounds(P.bounds()),Ta.center=this.innerBounds().topLeft(),Fb.center=this.innerBounds().bottomRight()):(Eb.arr.remove(za.guides,this),this.remove())}}))}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GridLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:Eb.Color.transparent},cells:{derived:!0,get:function(){return Eb.arr.flatten(this.target.col(0).items.map(function(P){return P.row(0).items}))}},submorphs:{initialize:function(){this.initialize()}}}}}],Ca,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:12146,end:19501})}(Eb.LayoutHalo));Eb.GridLayoutHalo=bd;Eb.GridLayoutHalo=bd;Eb.GridLayoutHalo=bd;od=function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ca.hasOwnProperty("TilingLayoutHalo")&&"function"===typeof Ca.TilingLayoutHalo?Ca.TilingLayoutHalo:Ca.TilingLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return rb(Mb,xa,[{key:"remove",value:function(){rb._get(Object.getPrototypeOf(Mb.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"handleDrop",value:function(P){}},{key:"removePreviews",value:function(){this.previews.forEach(function(P){return P.clear()})}},{key:"previewDrop",value:function(P){var za=this;0<this.previews.length||(this.previews=P.map(function(Ta){return za.container.addMorph({type:Eb.DropPreview,
bounds:Ta.bounds()})}),this.previews.forEach(function(Ta){Ta.step()}))}},{key:"updateSpacing",value:function(P){this.target.spacing=P}},{key:"updateAxis",value:function(P){this.target.axis=P}},{key:"updateAlign",value:function(P){this.target.align=P}},{key:"optionControls",value:function(){var P=this.target,za=new Eb.DropDownSelector({borderRadius:2,padding:3,selectedValue:P.axis,values:["row","column"]}),Ta=new Eb.DropDownSelector({borderRadius:2,padding:3,selectedValue:P.align,values:["left","center"]});
P=new Eb.NumberWidget({min:0,number:P.spacing,padding:Eb.rect(5,3,0,0),borderRadius:3,borderWidth:1,borderColor:Eb.Color.gray,unit:"px"});Eb.connect(P,"update",this,"updateSpacing");Eb.connect(Ta,"update",this,"updateAlign");Eb.connect(za,"update",this,"updateAxis");var Fb={type:"label",padding:Eb.rect(0,5,5,5),fill:Eb.Color.transparent,fontColor:Eb.Color.gray.darker(),readOnly:!0};return[[Object.assign({},Fb,{textString:"Submorph Spacing"}),P],[Object.assign({},Fb,{textString:"Tiling Align"}),Ta],
[Object.assign({},Fb,{textString:"Tiling Axis"}),za]].map(function(Cc){return{submorphs:Cc,fill:null,layout:new Eb.HorizontalLayout({spacing:3})}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TilingLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:Eb.Color.transparent},previews:{defaultValue:[]}}}}],Ca,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:19510,end:21708})}(Eb.LayoutHalo);Eb.TilingLayoutHalo=od;Eb.TilingLayoutHalo=od;Eb.TilingLayoutHalo=od;(function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ca.hasOwnProperty("DropPreview")&&"function"===typeof Ca.DropPreview?Ca.DropPreview:Ca.DropPreview=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,
[{key:"clear",value:function(){this.stopped=!0;this.remove()}},{key:"step",value:function(){var P=this,za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return za=Eb.easings.inOutQuad,Ta.yield(P.animate({opacity:.5,duration:(P.pulseDuration-10)/2,easing:za}),2);if(3!=Ta.nextAddress)return Ta.yield(P.animate({opacity:1,duration:(P.pulseDuration-10)/2,easing:za}),3);P.stopped||P.step();Ta.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DropPreview"}},
{key:"properties",get:function(){return{isHaloItem:{readOnly:!0,get:function(){return!0}},epiMorph:{readOnly:!0,get:function(){return!0}},fill:{defaultValue:Eb.Color.orange.withA(.3)},hasFixedPosition:{defaultValue:!0},borderColor:{defaultValue:Eb.Color.orange},borderWidth:{defaultValue:2},borderStyle:{defaultValue:"dashed"},pulseDuration:{defaultValue:2E3}}}}],Ca,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21710,end:22534})})(Eb.Morph);od=Ba("F",function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ca.hasOwnProperty("FlexLayoutHalo")&&"function"===typeof Ca.FlexLayoutHalo?Ca.FlexLayoutHalo:Ca.FlexLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"handleDrop",value:function(P){}},{key:"previewDrop",
value:function(P){var za=this;0<this.previews.length||(this.previews=P.map(function(Ta){return za.container.addMorph({type:Eb.DropPreview,position:za.container.localize(za.world().firstHand.position),extent:Ta.bounds().extent()})}),this.previews.forEach(function(Ta){Ta.step()}))}},{key:"remove",value:function(){rb._get(Object.getPrototypeOf(Mb.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"removePreviews",value:function(){this.previews.forEach(function(P){return P.clear()})}},
{key:"onDrop",value:function(P){this.removePreviews();P.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateAutoResizePolicy",value:function(P){P&&(this.originalExtent=this.container.extent);this.target.autoResize=P;P||(this.container.extent=this.originalExtent||this.container.extent);this.alignWithTarget()}},{key:"updateResizeSubmorphsPolicy",value:function(P){this.target.resizeSubmorphs=P;this.alignWithTarget()}},
{key:"updateAlignmentPolicy",value:function(P){this.target.align=P}},{key:"updateDirectionPolicy",value:function(P){this.target.direction=P}},{key:"updateSpacing",value:function(P){this.target.spacing=P}},{key:"optionControls",value:function(){var P=this.target,za=P.possibleAlignValues?{fill:Eb.Color.transparent,layout:new Eb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"align: "},new Eb.DropDownSelector({name:"alignment",borderRadius:2,padding:3,
selectedValue:P.align,values:P.possibleAlignValues})]}:null,Ta=P.possibleDirectionValues?{fill:Eb.Color.transparent,layout:new Eb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"direction: "},new Eb.DropDownSelector({name:"direction",borderRadius:2,padding:3,selectedValue:P.direction,values:P.possibleDirectionValues})]}:null,Fb=new Eb.NumberWidget({fill:Eb.Color.white,borderWidth:1,borderRadius:4,padding:Eb.rect(5,4,0,0),borderColor:Eb.Color.gray,
min:0,number:P.spacing,unit:"px"}),Cc=new Eb.LabeledCheckBox({name:"autoResize",label:"Resize Container",alignCheckBox:"right",fill:Eb.Color.transparent,checked:P.autoResize});P=new Eb.LabeledCheckBox({label:"Resize Submorphs",name:"resizeSubmorphs",alignCheckBox:"right",fill:Eb.Color.transparent,checked:P.resizeSubmorphs});Eb.connect(Fb,"update",this,"updateSpacing");Eb.connect(Cc,"checked",this,"updateAutoResizePolicy");Eb.connect(P,"checked",this,"updateResizeSubmorphsPolicy");za&&Eb.connect(za.submorphs[1],
"selectedValue",this,"updateAlignmentPolicy");Ta&&Eb.connect(Ta.submorphs[1],"selectedValue",this,"updateDirectionPolicy");return[Cc,P].concat($jscomp.arrayFromIterable([za,Ta].filter(Boolean)),[{fill:Eb.Color.transparent,layout:new Eb.HorizontalLayout,submorphs:[{type:"label",value:"Submorph Spacing",fontColor:Eb.Color.gray.darker(),padding:Eb.rect(0,5,5,5)},Fb]}])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FlexLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},
fill:{defaultValue:Eb.Color.transparent},halosEnabled:{defaultValue:!1},previews:{defaultValue:[]}}}}],Ca,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:22543,end:26761})}(Eb.LayoutHalo));Eb.FlexLayoutHalo=od;Eb.FlexLayoutHalo=od;Eb.FlexLayoutHalo=od;pb=Ba("c",function(xa){var Ca=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
Mb=Ca.hasOwnProperty("ProportionalLayoutHalo")&&"function"===typeof Ca.ProportionalLayoutHalo?Ca.ProportionalLayoutHalo:Ca.ProportionalLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Mb,xa,[{key:"handleDrop",value:function(P){}},{key:"onDrop",value:function(P){P.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateSubmorphProportionalLayoutSettings",
value:function(P){var za={};this.target.changeSettingsFor(P.submorph,(za[P.axis]=P.policy,za),!0)}},{key:"onSubmorphSettingsDragStart",value:function(P,za){var Ta=this;P.stop();var Fb=this.target.settingsFor(za);za="";for(var Cc in Fb)za+=Cc+":"+Fb[Cc]+" ";var Uc=Eb.morph({type:"label",value:za,isLayoutable:!1});Uc.wantsToBeDroppedOn=function(he){return Ta.target.layoutableSubmorphs.includes(he)};Uc.onBeingDroppedOn=function(he,we){Uc.remove();if(he=Ta.target.layoutableSubmorphs.includes(we)?we:P.world.morphsContainingPoint(P.hand.position).find(function(nf){return Ta.target.layoutableSubmorphs.includes(nf)}))Ta.updateSubmorphProportionalLayoutSettings({policy:Fb.x,
axis:"x",submorph:he}),Ta.updateSubmorphProportionalLayoutSettings({policy:Fb.y,axis:"y",submorph:he}),he.show(),$world.setStatusMessage("layout settings applied")};P.hand.grab(Uc)}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var P=this,za,Ta,Fb,Cc,Uc,he,we,nf,yd,Ce,wf,Ie;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fg){switch(Fg.nextAddress){case 1:return za=P.target.layoutableSubmorphs,P.env.eventDispatcher.isKeyPressed("Shift")?(Fb=za.map(function(Rf){return{isListItem:!0,
string:String(Rf),value:Rf}}),Fg.yield($world.listPrompt("Select morph",Fb,{requester:P,onSelection:function(Rf){return Rf.show()}}),5)):Fg.yield(Eb.InteractiveMorphSelector.selectMorph(P.world(),P,function(Rf){return za.includes(Rf)}),4);case 4:Ta=Fg.yieldResult;Fg.jumpTo(3);break;case 5:Cc=Fg.yieldResult,Uc=$jscomp.makeIterator(Cc.selected),Ta=Uc.next().value;case 3:if(!Ta)return Fg.return();he=P.state.popover.get("controlContainer");we=he.getAllNamed(/submorph config/);nf=["move","resize","scale",
"fixed"];yd=P.target.settingsFor(Ta);we.length||(he.submorphs=[].concat($jscomp.arrayFromIterable(he.submorphs),[{name:"submorph config X-Axis policy",position:Eb.pt(0,P.height),fill:Eb.Color.transparent,layout:new Eb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph X-Axis policy: "},new Eb.DropDownSelector({name:"x-axis policy selector",borderRadius:2,padding:3,selectedValue:yd.x,values:nf})]},{name:"submorph config Y-Axis policy",position:Eb.pt(0,
P.height),fill:Eb.Color.transparent,layout:new Eb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph Y-Axis policy: "},new Eb.DropDownSelector({name:"y-axis policy selector",borderRadius:2,padding:3,selectedValue:yd.y,values:nf})]},Eb.morph({position:Eb.pt(0,P.height+20),draggable:!0,name:"dragme",type:"label",value:"drag me to copy"})]));Ce=he.getSubmorphNamed("x-axis policy selector");wf=he.getSubmorphNamed("y-axis policy selector");Ie=he.getSubmorphNamed("dragme");
Eb.disconnect(Ce,"selectedValue",P,"updateSubmorphProportionalLayoutSettings");Eb.disconnect(wf,"selectedValue",P,"updateSubmorphProportionalLayoutSettings");Ce.selectedValue=yd.x;wf.selectedValue=yd.y;Eb.connect(Ie,"onDragStart",P,"onSubmorphSettingsDragStart",{updater:function(Rf,Jc){return Rf(Jc,Ta)},varMapping:{submorph:Ta}});Eb.connect(Ce,"selectedValue",P,"updateSubmorphProportionalLayoutSettings",{converter:function(Rf){return{policy:Rf,axis:"x",submorph:Ta}},varMapping:{submorph:Ta}});Eb.connect(wf,
"selectedValue",P,"updateSubmorphProportionalLayoutSettings",{converter:function(Rf){return{policy:Rf,axis:"y",submorph:Ta}},varMapping:{submorph:Ta}});Fg.jumpToEnd()}})}},{key:"optionControls",value:function(P){this.state.popover=P;var za=this.target;P=new Eb.LabeledCheckBox({name:"x-axis",label:"X-Axis",alignCheckBox:"right",fill:Eb.Color.transparent,checked:za.xAxisEnabled});za=new Eb.LabeledCheckBox({name:"y-axis",label:"Y-Axis",alignCheckBox:"right",fill:Eb.Color.transparent,checked:za.yAxisEnabled});
var Ta=new Eb.Button({name:"modify submorph settings button",label:[].concat($jscomp.arrayFromIterable(Eb.Icon.textAttribute("crosshairs")),["\u00a0Change submorph settings"])});Eb.connect(P,"checked",this,"updateXAxisEnabled");Eb.connect(za,"checked",this,"updateYAxisEnabled");Eb.connect(Ta,"fire",this,"chooseSubmorphToChangeLayoutSettings");return[Ta]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProportionalLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},
fill:{defaultValue:Eb.Color.transparent}}}}],Ca,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:26771,end:32465})}(Eb.LayoutHalo));Eb.ProportionalLayoutHalo=pb;Eb.ProportionalLayoutHalo=pb;Eb.ProportionalLayoutHalo=pb;qc=lively.FreezerRuntime.recorderFor("lively.halos/index.js");qc.Halo=ge;
qc.MorphHighlighter=ee;qc.InteractiveMorphSelector=ed;qc.StatusMessage=ec;qc.StatusMessageForMorph=Rc;qc.show=La;qc.showConnector=Yb;qc.ProportionalLayoutHalo=pb;qc.GridLayoutHalo=bd;qc.FlexLayoutHalo=od;qc.showAndSnapToGuides=ha;qc.removeSnapToGuidesOf=Q;qc.StatusMessage=ec;qc.StatusMessage=ec;qc.StatusMessageForMorph=Rc;qc.StatusMessageForMorph=Rc;qc.show=La;qc.show=La;qc.showConnector=Yb;qc.showConnector=Yb;qc.Halo=ge;qc.Halo=ge;qc.MorphHighlighter=ee;qc.MorphHighlighter=ee;qc.InteractiveMorphSelector=
ed;qc.InteractiveMorphSelector=ed;qc.ProportionalLayoutHalo=pb;qc.ProportionalLayoutHalo=pb;qc.GridLayoutHalo=bd;qc.GridLayoutHalo=bd;qc.FlexLayoutHalo=od;qc.FlexLayoutHalo=od;qc.showAndSnapToGuides=ha;qc.showAndSnapToGuides=ha;qc.removeSnapToGuidesOf=Q;qc.removeSnapToGuidesOf=Q;ge=Object.freeze({__proto__:null,StatusMessage:ec,StatusMessageForMorph:Rc,show:La,showConnector:Yb,Halo:ge,MorphHighlighter:ee,InteractiveMorphSelector:ed,ProportionalLayoutHalo:pb,GridLayoutHalo:bd,FlexLayoutHalo:od,showAndSnapToGuides:ha,
removeSnapToGuidesOf:Q,SvgStyleHalo:void 0});Ba("i",ge);Ba("_",void 0)}}});
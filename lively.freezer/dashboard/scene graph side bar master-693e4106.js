System.register("./__root_module__-f418f9fd.js lively.collab kld-intersections ./index-e1bb9574.js ./index-c551f254.js ./world-edf3c374.js ./index-96ee3fea.js ./index-6e65d49f.js ./editor-plugin-c26fc353.js ./editor-plugin-5bde6f0b.js ./index-7bb8b828.js".split(" "),function(){var Ha,tb,Ab,kc,ac,Ld,Tc,$d,Uc,Pc,Jd,pe,Ze,Ff,te,Bc,sd,le,jc,je,Ae,Dc,Mc,bc,Gc,Zc,Rd,Kd,rb,ob,Bb,Va;return{setters:[function(Ta){Ha=Ta.aJ;tb=Ta.av;Ab=Ta.a_;kc=Ta.aa;ac=Ta.a3;Ld=Ta.aO;Tc=Ta.aF;$d=Ta.ak;Uc=Ta.C;Pc=Ta.a2;
Jd=Ta.a6;pe=Ta.ab;Ze=Ta.bR;Ff=Ta.l;te=Ta.bz;Bc=Ta.bx;sd=Ta.aK;le=Ta.ay;jc=Ta.a1;je=Ta.bS;Ae=Ta.bi;Dc=Ta.bk;Mc=Ta.aH;bc=Ta.a4;Gc=Ta.$;Zc=Ta.be;Rd=Ta.aG;Kd=Ta.bT},function(){},function(){},function(){},function(){},function(){},function(Ta){rb=Ta.d;ob=Ta.s;Bb=Ta.I},function(){},function(Ta){Va=Ta.I},function(){},function(){}],execute:function(){function Ta($a){var zb=$a.sourceObj,Cc=$a.targetObj;zb.isMorph&&Cc.isMorph?(zb.show(),Cc.show(),T.showConnector&&T.showConnector(zb,Cc)):T.show(String($a))}
function xa($a){var zb=$a.sourceObj,Cc=$a.sourceAttrName,Ba=$a.targetObj,Ca=$a.targetMethodName,Nb=$a.getConverter();$a=$a.getUpdater();return T.printConnectionElements(zb,Cc,Ba,Ca,Nb,$a)}function wa($a,zb,Cc,Ba,Ca,Nb){$a="/* global connect, source, target */\nconnect(source, '"+zb+"', target, '"+Ba+"'";if(Ca||Nb)$a+=", {\n";Ca&&($a+="  converter: "+Ca);Ca&&Nb&&($a+=",");Ca&&($a+="\n");Nb&&($a+="  updater: "+Nb+"\n");if(Ca||Nb)$a+="}";return $a+");"}function Qa($a,zb){var Cc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ba){if(1==
Ba.nextAddress)return Ba.yield(T.InteractiveMorphSelector.selectMorph(),2);Cc=Ba.yieldResult;return Ba.return(Cc?T.interactiveConnectGivenSourceAndTarget($a,zb,Cc):null)})}function Eb($a,zb,Cc,Ba){var Ca,Nb,Ec,fb,td;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xd){switch(Xd.nextAddress){case 1:Ca=Cc&&Cc.world().targetDataBindings(Cc);Nb=$a.world();if(!Ca||!Ca.length)return Nb.setStatusMessage("connect canceled"),Xd.return();if(zb){Xd.jumpTo(2);break}Ec=[{isListItem:!0,string:"[Enter custom attribute..]",
value:{custom:!0}}].concat($jscomp.arrayFromIterable(T.arr.flatten($a.world().targetDataBindings($a)).map(function(ae){return{isListItem:!0,string:ae.signature||ae.name,value:ae}})));return Xd.yield(Nb.listPrompt(["Select Source Attribute\n",{},"Choose the attribute of the morph that is supposed to invoke the connection. This can be a method, property or a custom signal that is invoked upon the morph.",{paddingTop:"10px",fontSize:14,textAlign:"left",fontWeight:"normal"}],Ec,{filterable:!0}),3);case 3:zb=
Xd.yieldResult;if("canceled"==zb.status)return Xd.return();zb=zb.selected[0];zb=zb.custom?"sourceAttribute":zb.name;case 2:return fb=[{isListItem:!0,string:"[Enter custom attribute...]",value:{custom:!0}}].concat($jscomp.arrayFromIterable(T.arr.flatten(Ca).map(function(ae){return{isListItem:!0,value:ae,string:ae.signature||ae.name}}))),Xd.yield(Nb.listPrompt(["Select Target Attribute\n",{},"Choose the attribute of the morph that is supposed to invoked once the connection is triggered. This can be either a method or a property of the morph. When selecting a property, keep in mind that the value of the source attribute will be assigned to the property or passed to the method as an argument.",
{fontSize:14,textAlign:"left",fontWeight:"normal",paddingTop:"10px"}],fb,{filterable:!0}),4);case 4:td=Xd.yieldResult;if("canceled"==td.status)return Xd.return();td=td.selected[0];return Xd.yield(T.interactivelyEvaluateConnection({sourceObj:$a,sourceAttr:zb,targetObj:Cc,targetAttr:td.custom?"targetAttribute":td.name,onConnect:Ba,prompt:"Edit and confirm connection:"}),0)}})}function rc($a,zb,Cc,Ba){zb=void 0===zb?"confirm connection":zb;var Ca,Nb,Ec,fb,td,Xd,ae;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bf){Ca=
$a;Nb=Ca.sourceObj;Ec=Ca.sourceAttrName;fb=Ca.targetObj;td=Ca.targetMethodName;Xd=$a.getConverter();ae=$a.getUpdater();return Bf.return(T.interactivelyEvaluateConnection({sourceObj:Nb,sourceAttr:Ec,targetObj:fb,targetAttr:td,converter:Xd,updater:ae,prompt:zb,highlight:Cc,onConnect:Ba}))})}function qb($a,zb,Cc,Ba,Ca){Ba=void 0===Ba?{}:Ba;Ca=T.rect(0).sides.concat(T.rect(0).corners);Cc=Cc||new T.Leash(Object.assign({isSmooth:!0,styleClasses:["Halo"],borderColor:T.Color.orange,epiMorph:!0,endpointStyle:{start:{fill:T.Color.transparent,
nativeCursor:"auto"},end:{fill:T.Color.orange}}},Ba,{hasFixedPosition:!0}));Cc.startPoint.attachTo($a,"rightCenter");zb.isMorph?(Ba=zb.globalBounds().partNameNearest(Ca,$a.globalPosition),$a.globalPosition.equals(zb.globalBounds().partNamed(Ba))&&zb.globalBounds().partNameNearest(T.arr.without(Ca,Ba),$a.globalPosition),Cc.endPoint.attachTo(zb,"leftCenter")):(Ca=$a.globalBounds().topRight().addPt(T.pt(100,0)),zb=T.morph({type:"label",value:zb.toString(),styleClasses:["Tooltip"],padding:T.rect(8,4)}).openInWorld(Ca),
zb.position=$a.world().bounds().translateForInclusion(zb.bounds()).topLeft(),T.once(Cc,"remove",zb,"remove"),Cc.endPoint.attachTo(zb,"leftCenter"));return Cc}function sb($a){var zb,Cc,Ba,Ca,Nb,Ec,fb,td,Xd,ae,Bf,ie,Zf,Hg,Wc,vc,yf,tc,wb,uc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Q){switch(Q.nextAddress){case 1:zb=$a;Cc=zb.sourceObj;Ba=zb.sourceAttr;Ca=zb.targetObj;Nb=zb.targetAttr;Ec=zb.converter;fb=zb.updater;td=zb.prompt;Xd=void 0===zb.highlight?!0:zb.highlight;ae=zb.onConnect;
Bf="lively://lively.bindings-interactive-connect/x"+Cc.id;ie={context:window,format:"esm",targetModule:Bf,classTransform:T.classToFunctionTransform};Zf=T.printConnectionElements(Cc,Ba,Ca,Nb,Ec,fb);Ca.isMorph&&Cc.isMorph&&(Hg=Ca.propertiesAndPropertySettings().properties[Nb]||{type:typeof Ca[Nb]},Wc=Hg.type,vc=Cc.propertiesAndPropertySettings().properties[Ba]||{type:typeof Cc[Ba]},yf=vc.type,yf!==Wc&&(td=["Edit and confirm connection:\n",{},"Source: ",{fontSize:14,fontWeight:"normal"},Cc.toString(),
{fontSize:14,fontWeight:"normal",fontStyle:"italic"},"\nTarget: ",{fontSize:14,fontWeight:"normal"},Ca.toString(),{fontSize:14,fontWeight:"normal",fontStyle:"italic"}]));tc={};Object.assign(lively.modules.module(Bf).recorder,(tc.source=Cc,tc.target=Ca,tc.connect=T.connect,tc.once=T.once,tc[Ba]=Cc[Ba],tc));if(!td){wb=Zf;Q.jumpTo(2);break}return Q.yield($world.editPrompt(td,{input:Zf,historyId:"lively.bindings-interactive-morph-connect",mode:"js",requester:$world,evalEnvironment:ie,animated:!1}),3);
case 3:if(wb=Q.yieldResult,!wb)return $world.setStatusMessage("connect canceled"),Q.return();case 2:return Q.yield(lively.vm.runEval(wb,ie),4);case 4:uc=Q.yieldResult;if(uc.isError)return $world.logError(uc.value),Q.return(sb({sourceObj:Cc,sourceAttr:Ba,targetObj:Ca,targetAttr:Nb,converter:Ec,updater:fb,prompt:"confirm connection",highlight:Xd,onConnect:ae}));Xd&&($world.setStatusMessage("connected!",T.Color.green),T.interactivelyShowConnection(uc.value));"function"===typeof ae&&ae(uc);Q.jumpToEnd()}})}
var kb=lively.FreezerRuntime.recorderFor("ProtoInspector/index.js");kb.Inspector=Va;var ha=function($a){var zb=lively.FreezerRuntime.recorderFor("ProtoInspector/index.js"),Cc=zb.hasOwnProperty("ProtoInspector")&&"function"===typeof zb.ProtoInspector?zb.ProtoInspector:zb.ProtoInspector=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ha(Cc,$a,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoInspector"}},
{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],zb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoInspector",version:"0.1.1-0"}}},{start:68,end:210})}(kb.Inspector);ha=kb.ProtoInspector;kb.default=ha;var Pa=lively.FreezerRuntime.recorderFor("MorphicSideBar/index.js");Pa.Morph=tb;Pa.touchInputDevice=
Ab;Pa.easings=kc;Pa.pt=ac;Pa.fun=Ld;Pa.connect=Tc;kb=function($a){var zb=lively.FreezerRuntime.recorderFor("MorphicSideBar/index.js"),Cc=zb.hasOwnProperty("MorphicSideBar")&&"function"===typeof zb.MorphicSideBar?zb.MorphicSideBar:zb.MorphicSideBar=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ha(Cc,$a,[{key:"relayout",value:function(){this.onWorldResize()}},{key:"onWorldResize",value:function(Ba){Ba=void 0===
Ba?!0:Ba;if(this.respondsToVisibleWindow){var Ca=$world.visibleBounds(),Nb=navigator.standalone&&Pa.touchInputDevice?25:0;this.height=Ca.height-Nb;this.top=Nb+Ca.top();Nb=this.get("horizontal resizer");Nb.height=this.height;Nb.top=0;Ba&&(this.visible?this.topLeft=Ca.topLeft():this.topRight=Ca.topLeft())}}},{key:"switchMode",value:function(Ba){"inspector"==Ba&&this.showInspector();"connections"==Ba&&this.showConnections()}},{key:"showInspector",value:function(){this.get("inspector").visible=!0;this.get("connections tree").visible=
!1}},{key:"showConnections",value:function(){this.get("inspector").visible=!1;this.get("connections tree").visible=!0}},{key:"toggle",value:function(Ba){var Ca=this,Nb,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fb){switch(fb.nextAddress){case 1:Nb=$world.visibleBounds();Ec=navigator.standalone&&Pa.touchInputDevice?25:0;Ca.height=Nb.height-Ec;Ca.top=Ec+Nb.top();if(Ba)return $world.addMorph(Ca,$world.get("lively top bar")),Ca.topRight=Nb.topLeft(),Ca.attachToWorld($world),Ca.visible=
!0,fb.yield(Ca.whenRendered(),5);Ca.detachFromWorld($world);return fb.yield(Ca.animate({opacity:0,topRight:Nb.topLeft(),duration:300}),4);case 4:Ca.visible=!1;Ca.remove();fb.jumpTo(0);break;case 5:return Ca.onWorldResize(!1),Ca.get("scene graph").adjustProportions(),fb.yield(Ca.animate({opacity:1,easing:Pa.easings.outCirc,topLeft:Nb.topLeft(),duration:300}),6);case 6:Ca.get("scene graph").refresh(),fb.jumpToEnd()}})}},{key:"attachToWorld",value:function(Ba){Pa.connect(Ba,"onChange",this,"onHierarchyChange",
{garbageCollect:!0});Pa.connect(Ba,"onSubmorphChange",this,"onHierarchyChange",{garbageCollect:!0});Pa.connect(Ba,"showHaloFor",this,"selectNode",{garbageCollect:!0})}},{key:"detachFromWorld",value:function(Ba){var Ca=this;Ba.attributeConnections.forEach(function(Nb){Nb.targetObj===Ca&&Nb.disconnect()})}},{key:"selectNode",value:function(Ba){this.getSubmorphNamed("scene graph").selectMorphInTarget(Ba);this.getSubmorphNamed("connections tree").inspectConnectionsOf(Ba)}},{key:"onHierarchyChange",value:function(Ba){var Ca=
this,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if("addMorphAt"===Ba.selector||"removeMorph"===Ba.selector||"name"===Ba.prop){Nb=Ca._sceneGraph||(Ca._sceneGraph=Ca.getSubmorphNamed("scene graph"));if(!Nb||!Nb.owner.visible||Ba.target&&Ba.target.isHand||Ba.target&&Nb.ignoreMorph(Ba.target)||Ba.args&&!Ba.args[0].isHalo&&Nb.ignoreMorph(Ba.args[0])||Ba.target.ownerChain().find(function(fb){return Nb.ignoreMorph(fb)}))return Ec.return();Pa.fun.debounceNamed("scene-graph-update",
50,function(){return Nb.refresh()})()}Ec.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphicSideBar"}},{key:"properties",get:function(){return{isHaloItem:{get:function(){return!1}}}}}],zb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"MorphicSideBar",version:"0.1.1-76"}}},{start:226,end:3668})}(Pa.Morph);
kb=Pa.MorphicSideBar;Pa.default=kb;var T=lively.FreezerRuntime.recorderFor("lively.ide/fabrik.js");T.interactivelyShowConnection=Ta;T.printConnection=xa;T.printConnectionElements=wa;T.interactiveConnectGivenSource=Qa;T.interactiveConnectGivenSourceAndTarget=Eb;T.interactivelyReEvaluateConnection=rc;T.visualizeConnection=qb;T.interactivelyEvaluateConnection=sb;T.connect=Tc;T.once=$d;T.Color=Uc;T.rect=Pc;T.pt=ac;T.arr=Jd;T.morph=pe;T.Leash=Ze;T.showConnector=rb;T.show=ob;T.InteractiveMorphSelector=
Bb;T.classToFunctionTransform=Ff;T.interactivelyShowConnection=Ta;T.interactivelyShowConnection=Ta;T.printConnection=xa;T.printConnection=xa;T.printConnectionElements=wa;T.printConnectionElements=wa;T.interactiveConnectGivenSource=Qa;T.interactiveConnectGivenSource=Qa;T.interactiveConnectGivenSourceAndTarget=Eb;T.interactiveConnectGivenSourceAndTarget=Eb;T.interactivelyReEvaluateConnection=rc;T.interactivelyReEvaluateConnection=rc;T.visualizeConnection=qb;T.visualizeConnection=qb;T.interactivelyEvaluateConnection=
sb;T.interactivelyEvaluateConnection=sb;var ia=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js");ia.Tree=te;ia.TreeData=Bc;ia.morph=pe;ia.Icon=sd;ia.HorizontalLayout=le;ia.easings=kc;ia.Morph=tb;ia.Color=Uc;ia.Rectangle=jc;ia.rect=Pc;ia.pt=ac;ia.connect=Tc;ia.noUpdate=je;ia.disconnect=Ae;ia.disconnectAll=Dc;ia.once=$d;ia.arr=Jd;ia.num=Mc;ia.fun=Ld;ia.tree=bc;ia.promise=Gc;ia.ConnectionHalo=_missingExportShim;ia.getClassName=Zc;kb=function($a){var zb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),
Cc=zb.hasOwnProperty("InteractiveTreeContainer")&&"function"===typeof zb.InteractiveTreeContainer?zb.InteractiveTreeContainer:zb.InteractiveTreeContainer=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ha(Cc,$a,[{key:"onChildRemoved",value:function(Ba){}},{key:"onChildAdded",value:function(Ba){}},{key:"toggleSelected",value:function(Ba){if(this.tree){var Ca=this.tree,Nb=Ca.selectionFontColor,Ec=Ca.nonSelectionFontColor;
this.submorphs.filter(function(fb){return!fb._isControlElement&&fb.styleClasses.includes("Label")}).forEach(function(fb){fb.fontColor=Ba?Nb:Ec})}}},{key:"onGrab",value:function(Ba){var Ca=this.tree,Nb=this.node;this.fill=ia.Color.gray.withA(.5);this.fontColor=Ca.selectionFontColor;this.opacity=.8;Ha._get(Object.getPrototypeOf(Cc.prototype),"onGrab",this).call(this,Ba);Nb&&(this.toggleSelected(!1),Ca.collapse(Nb),Ca.treeData.parentNode(Nb).container.onChildRemoved(this),this._data=Ca.treeData.remove(Nb),
Nb.container.target.remove(),Ca.update(!0))}},{key:"wantsToBeDroppedOn",value:function(Ba){this.showPreviewOn(Ba);return!0}},{key:"showPreviewOn",value:function(Ba){if(Ba.isContainer)var Ca=Ba.tree;Ba.isTree&&(Ca=Ba);Ca&&Ca.showDropPreviewFor&&Ca.showDropPreviewFor(this)}},{key:"insertAsChild",value:function(Ba){var Ca=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress)return Ca.tree.treeData.add(Ba._data,Ca.node,Ca.node.children[0]),Ca.tree.uncollapse(Ca.node),
Ca.tree.treeData.remove(Ca.tree._previewNode),Nb.yield(Ca.tree.whenRendered(),2);Ca.tree.update(!0);Ca.onChildAdded(Ba);Nb.jumpToEnd()})}},{key:"onBeingDroppedOn",value:function(Ba,Ca){var Nb=this;debugger;this.tree._dropInProgress=!0;Ha._get(Object.getPrototypeOf(Cc.prototype),"onBeingDroppedOn",this).call(this,Ba,Ca);Ba=function(){Nb.fill=ia.Color.gray.withA(.5);Nb.opacity=1;Nb.tree._dropInProgress=!1;Nb.tree.refresh()};Ca.isTree?Ca.insertAtPlaceholder(this).then(Ba):Ca.isContainer?Ca.insertAsChild(this).then(Ba):
Ba()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveTreeContainer"}},{key:"properties",get:function(){return{fill:{defaultValue:ia.Color.transparent},isContainer:{get:function(){return!0}},tree:{},node:{readOnly:!0,get:function(){var Ba=this,Ca=this.tree.treeData;return Ca&&Ca.asList().find(function(Nb){return Nb.container===Ba})}}}}}],zb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"InteractiveTree",version:"0.1.1-1104"}}},{start:498,end:2975})}(ia.Morph);ia.InteractiveTreeContainer=kb;ia.InteractiveTreeContainer=kb;ia.InteractiveTreeContainer=kb;kb=function($a){var zb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Cc=zb.hasOwnProperty("InteractiveTreeData")&&"function"===typeof zb.InteractiveTreeData?zb.InteractiveTreeData:zb.InteractiveTreeData=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ha(Cc,$a,[{key:"display",value:function(Ba){return[Ba.container||"<NO CONTAINER>",{}]}},{key:"isCollapsed",value:function(Ba){return Ba.isCollapsed}},{key:"collapse",value:function(Ba,Ca){Ba.isCollapsed=Ca}},{key:"getChildren",value:function(Ba){var Ca=this;return Ba.isLeaf?null:Ba.children.filter(function(Nb){return Nb&&(Ca.filterActive?Nb.visible:!0)})}},{key:"isLeaf",value:function(Ba){var Ca=this;return!Ba.children||0==Ba.children.filter(function(Nb){return Nb&&(Ca.filterActive?
Nb.visible:!0)}).length}},{key:"add",value:function(Ba,Ca,Nb){Ca=void 0===Ca?this.root:Ca;Ca.children||(Ca.children=[]);Nb?ia.arr.pushAt(Ca.children,Ba,Ca.children.indexOf(Nb)):Ca.children.push(Ba);Ca.isLeaf=!1}},{key:"replace",value:function(Ba,Ca){var Nb=this.parentNode(Ba);Ba=Nb.children.indexOf(Ba);Nb.children[Ba]=Ca}},{key:"next",value:function(Ba){var Ca=this.parentNode(Ba);return Ca&&Ca.children[Ca.children.indexOf(Ba)+1]}},{key:"isBefore",value:function(Ba,Ca){this.next(Ba)===Ca}},{key:"isAfter",
value:function(Ba,Ca){this.next(Ca)===Ba}},{key:"addBefore",value:function(Ba,Ca){this.add(Ba,this.parentNode(Ca),Ca)}},{key:"addAfter",value:function(Ba,Ca){var Nb=this.parentNode(Ca);Ca=Nb.children.indexOf(Ca)+1;this.add(Ba,Nb,Nb.children[Ca])}},{key:"remove",value:function(Ba){var Ca=this.parentNode(Ba);if(Ca)return ia.arr.remove(Ca.children,Ba),Ca.children==[]&&(Ca.children=null),Ba}},{key:"filter",value:function(Ba,Ca){Ca=void 0===Ca?1:Ca;var Nb=this,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fb){if(1==
fb.nextAddress)return fb.yield(Nb.uncollapseAll(function(td,Xd){return Xd<Ca+1}),2);Ec=Nb.filterActive;Nb.filterActive=!1;Nb.asListWithIndexAndDepth(!1).reverse().forEach(function(td){var Xd=td.node;if(0==td.depth)return Xd.visible=!0;Xd.visible=Ba(Xd);Xd.visible||Xd.isCollapsed||!Xd.children.find(function(ae){return ae.visible})?Xd.container.opacity=1:(Xd.visible=!0,Xd.container.opacity=.5);return Xd.visible});Nb.filterActive=Ec;fb.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveTreeData"}}],
zb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1104"}}},{start:2984,end:5447})}(ia.TreeData);ia.InteractiveTreeData=kb;ia.InteractiveTreeData=kb;ia.InteractiveTreeData=kb;kb=function($a){var zb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Cc=zb.hasOwnProperty("InteractiveTree")&&
"function"===typeof zb.InteractiveTree?zb.InteractiveTree:zb.InteractiveTree=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ha(Cc,$a,[{key:"update",value:function(Ba){var Ca=this;Ha._get(Object.getPrototypeOf(Cc.prototype),"update",this).call(this,Ba);this.treeData&&this.relayoutContainers();Ba&&this.embeddedMorphs.forEach(function(Nb){Nb.isContainer&&(Nb.fill=ia.Color.transparent,Nb.fontFamily=Ca.fontFamily,
Nb.fontSize=Ca.fontSize)})}},{key:"onDrop",value:function(Ba){Ha._get(Object.getPrototypeOf(Cc.prototype),"onDrop",this).call(this,Ba);this.treeData.remove(this._previewNode);this.update(!0)}},{key:"onDropHoverIn",value:function(Ba){}},{key:"onDropHoverUpdate",value:function(Ba){}},{key:"onDropHoverOut",value:function(Ba){}},{key:"onHoverOut",value:function(Ba){var Ca=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){Ha._get(Object.getPrototypeOf(Cc.prototype),"onHoverOut",Ca).call(Ca,
Ba);Ca._previewNode&&Ca._previewNode.container.world()&&Ca.treeData.remove(Ca._previewNode);Ca.resetContainerSelection();Ca.update(!0);Nb.jumpToEnd()})}},{key:"insertAtPlaceholder",value:function(Ba){var Ca=this,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress)return Nb=Ca.treeData.parentNode(Ca._previewNode),Ca.treeData.replace(Ca._previewNode,Ba._data),Ca.treeData.remove(Ca._previewNode),Ec.yield(Ca.whenRendered(),2);Ca.update(!0);Nb.container.onChildAdded(Ba);
Ec.jumpToEnd()})}},{key:"scrollUpSlowly",value:function(){var Ba=this;if(!this._scrollingUp){this._scrollingUp=!0;var Ca=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress)return Ba._scrollingUp&&0<Ba.scroll.y?Nb.yield(Ba.animate({scroll:Ba.scroll.subXY(0,30),duration:300,easing:ia.easings.linear}),3):(Ba._scrollingUp=!1,Nb.jumpTo(0));Ca();Nb.jumpToEnd()})};Ca()}}},{key:"scrollDownSlowly",value:function(){var Ba=this;if(!this._scrollingDown){this._scrollingDown=
!0;var Ca=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress)return Ba._scrollingDown&&Ba.scroll.y<Ba.scrollExtent.y-Ba.height?Nb.yield(Ba.animate({scroll:Ba.scroll.addXY(0,30),duration:300,easing:ia.easings.linear}),3):(Ba._scrollingDown=!1,Nb.jumpTo(0));Ca();Nb.jumpToEnd()})};Ca()}}},{key:"stopScrollingSlowly",value:function(){this._scrollingUp=this._scrollingDown=!1}},{key:"resetContainerSelection",value:function(){this.embeddedMorphs.forEach(function(Ba){Ba.isContainer&&
(Ba.fill=ia.Color.transparent)})}},{key:"showDropPreviewFor",value:function(Ba){var Ca=this;Ba=this.localize(Ba.globalBounds().center());var Nb=this.textPositionFromPoint(Ba),Ec=this.treeData.asListWithIndexAndDepth(function(ie){ie=ie.node;return ie!=Ca._previewNode&&ie.container.world()}),fb=(Ec.find(function(ie){return ie.i-1===Nb.row})||{}).node,td=fb&&fb.container,Xd=this.ensurePlaceholder(),ae=!!Xd.container.world(),Bf=Ba.subPt(this.scroll).subPt(this.scrollbarOffset);10>Bf.y?this.scrollUpSlowly():
Bf.y>this.height-50?this.scrollDownSlowly():this.stopScrollingSlowly();this.resetContainerSelection();if(!td){if(Ec.length>Nb.row||ia.arr.last(this.treeData.root.children)===Xd)return;this.treeData.remove(Xd);this.treeData.add(Xd);this.update(!0)}if(td){Ec=this.textLayout.boundsFor(this,Nb);if(4>Math.abs(Ec.top()-Ba.y)){if(this.treeData.isBefore(Xd,fb))return;this.treeData.remove(Xd);this.treeData.addBefore(Xd,fb)}else if(4>Math.abs(Ec.bottom()-Ba.y)&&(fb.isCollapsed||this.treeData.isLeaf(fb))){if(this.treeData.isAfter(Xd,
fb))return;this.treeData.remove(Xd);this.treeData.addAfter(Xd,fb)}else{td.fill=ia.Color.gray;if(!ae)return;this.treeData.remove(Xd)}this.update(!0)}}},{key:"ensurePlaceholder",value:function(){var Ba=ia.pt(this.width-100,this.document.getLine(0).height);this._previewNode||(this._previewNode={container:ia.morph({acceptsDrops:!1,reactsToPointer:!1,fill:ia.Color.gray,borderRadius:5}),isCollapsed:!0,isLeaf:!0});this._previewNode.container.extent=Ba;return this._previewNode}},{key:"relayoutContainers",
value:function(){var Ba=this;this.charBoundsFromTextPosition({row:0,column:6});this.textLayout.charBoundsOfRow(this,0).map(function(Ca){return Ca.height});this.treeData.asListWithIndexAndDepth().forEach(function(Ca){var Nb=Ca.node;Ca=Ca.i;Nb.container.nativeCursor="grab";Nb.container.width=Ba.width-25-Nb.container.left;Nb.container.toggleSelected&&Nb.container.toggleSelected(Ca==Ba.selectedIndex)});this.anchors.forEach(function(Ca){return Ca.position=Ca.position})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InteractiveTree"}}],zb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1104"}}},{start:5456,end:10830})}(ia.Tree);ia.InteractiveTree=kb;ia.InteractiveTree=kb;ia.InteractiveTree=kb;kb=function($a){var zb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Cc=zb.hasOwnProperty("SceneGraphTree")&&
"function"===typeof zb.SceneGraphTree?zb.SceneGraphTree:zb.SceneGraphTree=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ha(Cc,$a,[{key:"beforePublish",value:function(){this.submorphs=[];this.reset()}},{key:"selectMorphInTarget",value:function(Ba){var Ca=this.treeData.asList().find(function(Nb){return Nb.container.target===Ba});Ca&&this.selectedNode!=Ca&&this.selectPath(this.treeData.pathOf(Ca))}},{key:"onLoad",
value:function(){var Ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ca){if(1==Ca.nextAddress)return Ca.yield(Ba.whenRendered(),2);if(3!=Ca.nextAddress){if(Ba.ownerChain().find(function(Nb){return Nb.isComponent}))return Ca.return();Ba.submorphs=[];return Ca.yield(Ba.whenRendered(),3)}Ba.get("inspector").makeEditorVisible(!0);Ba.get("inspector").makeEditorVisible(!1);Ba.setTarget($world);Ca.jumpToEnd()})}},{key:"adjustProportions",value:function(Ba){Ba=(Ba?Ba.state.dragDelta:{y:0}).y;
var Ca=this.get("inspector"),Nb=this.get("scene graph resizer"),Ec=this.get("mode selector"),fb=this.get("connections tree");this.height+=Ba;Ca.height-=Ba;fb.height-=Ba;Nb.top=this.bottom;Nb.left=0;Ec.top=Nb.bottom;fb.top=Ca.top=Ec.bottom+5}},{key:"reset",value:function(){var Ba=this;this.treeData=new ia.InteractiveTreeData({children:[],container:ia.morph()});this.get("inspector").targetObject={};this.selectedNode=null;this.anchors.filter(function(Ca){return null==Ca.id}).forEach(function(Ca){return Ba.removeAnchor(Ca)})}},
{key:"setTarget",value:function(Ba){this.target=Ba;this.treeData=this.getTreeFromSubmorphHierarchy(Ba);this.uncollapse(this.treeData.root)}},{key:"isNodeOutOfSync",value:function(Ba){var Ca=this;if(Ba===this._previewNode)return!1;if(Ba.container.nameNeedsUpdate)return!0;var Nb=Ba.container.target.submorphs.filter(function(Ec){return!Ca.ignoreMorph(Ec)});return Nb.length!=Ba.children.length||Nb.map(function(Ec){return Ec.name}).join("")!=Ba.children.map(function(Ec){return Ec.target?Ec.target.name:
""}).join("")?!0:!1}},{key:"getNewChildren",value:function(Ba){var Ca=this,Nb=Ba.container.target.submorphs.map(function(ae){return ae.__scene_graph_target__?ae.__scene_graph_target__():ae}).filter(function(ae){return!Ca.ignoreMorph(ae)}),Ec=[],fb={},td;for(td in Nb){fb.$jscomp$loop$prop$m$2712=Nb[td];var Xd=ia.arr.without(Ba.children,this._previewNode).find(function(ae){return function(Bf){return Bf.container.target.id==ae.$jscomp$loop$prop$m$2712.id}}(fb));Ec[td]=Xd?Xd:this.readMorphHierarchy(fb.$jscomp$loop$prop$m$2712);
fb={$jscomp$loop$prop$m$2712:fb.$jscomp$loop$prop$m$2712}}return Ec}},{key:"refresh",value:function(){var Ba=this;if(!this._updating&&!this._dropInProgress){var Ca=!1;ia.tree.prewalk(this.treeData.root,function(Nb){Ba.isNodeOutOfSync(Nb)&&(Ca=!0,Nb.name=Nb.container.target.name,Nb.container.refresh(),Nb.children=Ba.getNewChildren(Nb))},function(Nb){return Nb.children});this.update(Ca)}}},{key:"ignoreMorph",value:function(Ba){return Ba.isMorph?Ba.isContainer||Ba.isWindow||Ba.getWindow()||Ba.isEpiMorph||
Ba.isHand||["lively.halos"].includes(Ba.constructor[Symbol.for("lively-module-meta")].package.name)||["MorphicSideBar","SideBarToggler","UserFlap","Menu","CommentIndicator"].includes(Ba.constructor.name):!1}},{key:"onDropHoverOut",value:function(Ba){var Ca=Ba.hand.grabbedMorphs[0];Ba=Ba.hand.findDropTarget();if(!(Ba===this||Ba&&Ba.ownerChain().includes(this))&&Ca&&Ca.isContainer)Ca.onDragOutside()}},{key:"onDropHoverIn",value:function(Ba){var Ca=Ba.hand.grabbedMorphs[0];Ca&&!Ca.isContainer&&($world.halos().forEach(function(Nb){return Nb.remove()}),
Ca.remove(),Object.assign(Ca,Ba.hand._grabbedMorphProperties.get(Ca).pointerAndShadow),Ca=this.renderContainerFor(Ca,!1),Ba.hand.grab(Ca),Ca.leftCenter=ia.pt(-20,0))}},{key:"getTreeFromSubmorphHierarchy",value:function(Ba){return new ia.InteractiveTreeData(this.readMorphHierarchy(Ba))}},{key:"readMorphHierarchy",value:function(Ba){var Ca=this;return ia.tree.mapTree(Ba,function(Nb,Ec){return{name:Nb.name,isCollapsed:!0,container:Ca.renderContainerFor(Nb),visible:!0,children:Ec}},function(Nb){return Nb.submorphs.filter(function(Ec){return Nb.isWorld?
!Ca.ignoreMorph(Ec):!0})})}},{key:"renderContainerFor",value:function(Ba,Ca){Ba=void 0===Ba?ia.morph({name:"root"}):Ba;Ca=new ia.MorphContainer({tree:this,fill:void 0===Ca||Ca?ia.Color.transparent:ia.Color.gray.withA(.5),fontColor:this.nonSelectionFontColor,fontFamily:this.fontFamily,target:Ba,opacity:Ba.visible?1:.5});Ba._data?(Ca._data=Ba._data,Ba._data.container=Ca):Ca._data={name:Ba.name,isCollapsed:!0,container:Ca,children:[]};return Ca}},{key:"collapseAll",value:function(){var Ba=this;this.treeData.asList().forEach(function(Ca){return Ca!=
Ba.treeData.root?Ca.isCollapsed=!0:Ca.isCollapsed=!1})}},{key:"filterMorphs",value:function(Ba){var Ca=this,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress)return Nb=Ba.tokens[0],Ca.treeData.filterActive||(Ca._collapseState=new WeakMap(Ca.treeData.asList().map(function(fb){return[fb,fb.isCollapsed]}))),Ca.treeData.filterActive=!!Nb,Ec.yield(Ca.treeData.filter(function(fb){var td=!Nb||fb.container.target.name.includes(Nb);fb.container.highlightTerm(Nb);return td},
3),2);Ca.treeData.filterActive||Ca.treeData.asList().forEach(function(fb){return fb.isCollapsed=Ca._collapseState.has(fb)?Ca._collapseState.get(fb):!0});Ca.refresh();Ec.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SceneGraphTree"}},{key:"properties",get:function(){return{target:{serialize:!1}}}}],zb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"InteractiveTree",version:"0.1.1-1104"}}},{start:10839,end:17467})}(ia.InteractiveTree);ia.SceneGraphTree=kb;ia.SceneGraphTree=kb;ia.SceneGraphTree=kb;kb=function($a){var zb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Cc=zb.hasOwnProperty("MorphContainer")&&"function"===typeof zb.MorphContainer?zb.MorphContainer:zb.MorphContainer=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Ha(Cc,$a,[{key:"refresh",value:function(){var Ba=this,Ca,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){Ca=Ba.target;if(!Ca)return Ec.return();Ba.reactsToPointer=!0;Ba.dropShadow=!1;Ba.submorphs=[Ba.getLabel(),0<Ca.comments.length&&Ba.getCommentControls(),Ca.layout&&Ba.getLayoutControls(),Ba.getConnectionControls()].filter(Boolean).map(function(fb,td){fb.fitIfNeeded();fb.left=Nb?Nb.right+5:0;fb.top=2;return Nb=fb});Ba.height=20;Ba.opacity=Ca.visible?1:.5;Ec.jumpToEnd()})}},
{key:"getLabel",value:function(){var Ba=this.getSubmorphNamed("name label")||ia.morph({type:"label",name:"name label",reactsToPointer:!1,padding:ia.rect(0,0,0,0),acceptsDrops:!1,fontSize:this.tree.fontSize}),Ca=Ba.textString.slice(2,-1);Ca&&Ca==this.target.name||(Ba.value=[].concat($jscomp.arrayFromIterable(this.getIcon(this.target)),[" "+this.target.name+" "]));return Ba}},{key:"getIcon",value:function(Ba){return ia.Icon.textAttribute({Morph:"square",Ellipse:"circle",Text:"font",Label:"tag",Polygon:"draw-polygon",
Path:"bezier-curve",Image:"image",Canvas:"chess-board",HTMLMorph:"code"}[ia.getClassName(Ba)]||"codepen",{paddingTop:"4px",fontSize:this.tree.fontSize-2,opacity:.6})}},{key:"getLayoutControls",value:function(){var Ba=this.getSubmorphNamed("layout label")||ia.morph({type:"label",name:"layout label",borderRadius:3,acceptsDrops:!1,padding:ia.Rectangle.inset(4,2,4,2),fill:ia.Color.orange,fontColor:ia.Color.white});Ba._isControlElement=!0;Ba.textString!=this.target.layout.name()&&(Ba.value=this.target.layout.name());
return Ba}},{key:"getCommentControls",value:function(){var Ba=this.getSubmorphNamed("comment label")||ia.morph({type:"label",name:"comment label",tooltip:"Open comment browser to browse all comments",borderRadius:3,acceptsDrops:!1,padding:ia.Rectangle.inset(4,2,4,2),fill:ia.Color.rgb(241,196,15),fontColor:ia.Color.black});Ba._isControlElement=!0;var Ca=this.target.comments.length+" comment"+(1==this.target.comments.length?"":"s");Ba.textString!=Ca&&(Ba.value=Ca);return Ba}},{key:"getConnectionControls",
value:function(){this.connectionCount=this.target.attributeConnections?this.target.attributeConnections.filter(function(Nb){return!Nb.targetObj.isHalo}).length:0;var Ba=this.getSubmorphNamed("connections label")||ia.morph({acceptsDrops:!1,borderRadius:3,type:"label",name:"connections label",padding:ia.Rectangle.inset(4,2,4,2),nativeCursor:"pointer",fill:ia.Color.red,fontColor:ia.Color.white});Ba._isControlElement=!0;Ba.visible=!this.connectionHalo&&!!this.connectionCount;var Ca=this.connectionCount?
this.connectionCount+" connection"+(1<this.connectionCount?"s":""):"Manage Connections";Ba.textString!=Ca&&(Ba.value=Ca);return Ba}},{key:"highlightTerm",value:function(Ba){var Ca=this.submorphs[0],Nb=Ca.textAndAttributes.slice(0,2),Ec=Ca.textString.slice(1).split(Ba);Ca.textAndAttributes=1===Ec.length?[].concat($jscomp.arrayFromIterable(Nb),[Ec[0]]):[].concat($jscomp.arrayFromIterable(Nb),$jscomp.arrayFromIterable(ia.arr.flatten(ia.arr.interpose(Ec.map(function(fb){return[fb,{}]}),[Ba,{fontWeight:"900"}]))))}},
{key:"getClassControls",value:function(){}},{key:"wantsToBeDroppedOn",value:function(Ba){var Ca=Ha._get(Object.getPrototypeOf(Cc.prototype),"wantsToBeDroppedOn",this).call(this,Ba);if(![Ba].concat($jscomp.arrayFromIterable(Ba.ownerChain())).includes(this.tree))this.onDragOutside();return Ca}},{key:"onGrab",value:function(Ba){var Ca=this,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress)return Ca.tree._dropInProgress=!0,Nb=Ca.target.globalPosition,Ha._get(Object.getPrototypeOf(Cc.prototype),
"onGrab",Ca).call(Ca,Ba),Ca._data.globalTargetPosition=Nb,Ec.yield(Ca.whenRendered(),2);if(Ca.tree.fullContainsWorldPoint(Ca.globalPosition))Ca.leftCenter=ia.pt(-20,0);else Ca.onDragOutside();Ca.tree._dropInProgress=!1;Ec.jumpToEnd()})}},{key:"onDragOutside",value:function(){this._draggedOutside||(this._draggedOutside=!0,this.queue||(this.queue=ia.fun.createQueue("container-hover-queue",function(Ba,Ca){var Nb,Ec,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return Nb=
Ba.target,Ec=Nb.opacity,fb=Nb.scale,Ba.target.opacity=0,Ba.target.scale=.5,$world.halos().forEach(function(Xd){return Xd.remove()}),$world.firstHand.grab(Ba.target),Ba.target._data=Ba._data,Ba.remove(),Ba.target.position=ia.pt(0,0),td.yield(Ba.target.animate({opacity:Ec,scale:fb,duration:200}),2);Ca();td.jumpToEnd()})})),this.queue.push(this))}},{key:"onChildAdded",value:function(Ba){var Ca=this.node.children.indexOf(Ba.node||Ba._data)+1;Ca=this.node.children[Ca];Ba.target.remove();Ca?(Ca=this.target.submorphs.indexOf(Ca.container.target),
this.target.addMorphAt(Ba.target,Ca)):this.target.addMorph(Ba.target);Ba._data.globalTargetPosition&&(Ba.target.position=this.target.localize(Ba._data.globalTargetPosition))}},{key:"onChildRemoved",value:function(Ba){}},{key:"toggleConnectionControl",value:function(Ba){this.getSubmorphNamed("connections label").visible=Ba}},{key:"toggleSelected",value:function(Ba){var Ca=this,Nb,Ec,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return Ha._get(Object.getPrototypeOf(Cc.prototype),
"toggleSelected",Ca).call(Ca,Ba),Ca._active===Ba?td.return():(Ca._active=Ba)&&Ca.target&&Ca.target.isMorph&&Ca.world()?td.yield(Ca.target.whenRendered(),3):td.jumpTo(0);Ca.get("inspector").targetObject=Ca.target;Ca.get("connections tree").inspectConnectionsOf(Ca.target);if(Ca.connectionHalo)return td.return();Nb=$jscomp.makeIterator(Ca.world().halos());for(Ec=Nb.next();!Ec.done;Ec=Nb.next()){fb=Ec.value;if(fb.target===Ca.target)return td.return();fb.remove()}ia.noUpdate({sourceObj:Ca.world(),targetObj:Ca.sideBar,
sourceAttribute:"showHaloFor",targetAttribute:"selectNode"},function(){return Ca.world().showHaloFor(Ca.target)});td.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphContainer"}},{key:"properties",get:function(){return{fontFamily:{after:["submorphs"],derived:!0,set:function(Ba){this.submorphs[0].fontFamily=Ba}},fontColor:{after:["submorphs"],derived:!0,set:function(Ba){this.submorphs[0].fontColor=Ba}},fontSize:{derived:!0,set:function(Ba){this.submorphs[0].fontSize=
Ba}},target:{serialize:!1},dragTriggerDistance:{defaultValue:15},borderRadius:{defaultValue:4},nameNeedsUpdate:{derived:!0,get:function(){return!this.target||this.submorphs[0].textString.slice(2,-1)==this.target.name&&this.connectionCount==(this.target.attributeConnections||[]).length?!1:!0}},grabbable:{defaultValue:!0},draggable:{defaultValue:!0},submorphs:{after:["target","tree"],initialize:function(){this.refresh()}},sideBar:{derived:!0,get:function(){return this.owner.owner}}}}}],zb,{pathInPackage:function(){return"index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1104"}}},{start:17476,end:25894})}(ia.InteractiveTreeContainer);ia.MorphContainer=kb;ia.MorphContainer=kb;ia.MorphContainer=kb;var Fa=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js");Fa.visualizeConnection=function($a,zb,Cc,Ba,Ca){Ba=void 0===Ba?{}:Ba;Ca=Fa.rect(0).sides.concat(Fa.rect(0).corners);
Cc=Cc||new Fa.Leash(Object.assign({isSmooth:!0,styleClasses:["Halo"],borderColor:Fa.Color.orange,epiMorph:!0,endpointStyle:{start:{fill:Fa.Color.transparent,nativeCursor:"auto"},end:{fill:Fa.Color.orange}}},Ba,{hasFixedPosition:!0}));Cc.startPoint.attachTo($a,"rightCenter");zb.isMorph?(Ba=zb.globalBounds().partNameNearest(Ca,$a.globalPosition),$a.globalPosition.equals(zb.globalBounds().partNamed(Ba))&&zb.globalBounds().partNameNearest(Fa.arr.without(Ca,Ba),$a.globalPosition),Cc.endPoint.attachTo(zb,
"leftCenter")):(Ca=$a.globalBounds().topRight().addPt(Fa.pt(100,0)),zb=Fa.morph({type:"label",value:zb.toString(),styleClasses:["Tooltip"],padding:Fa.rect(8,4)}).openInWorld(Ca),zb.position=$a.world().bounds().translateForInclusion(zb.bounds()).topLeft(),Fa.once(Cc,"remove",zb,"remove"),Cc.endPoint.attachTo(zb,"leftCenter"));return Cc};Fa.startConnecting=function($a,zb){$a.animate({opacity:.8,duration:300});$a.startPoint.attachTo(zb,"center");$a.vertices[0].position=Fa.pt(2,2)};Fa.stopConnecting=
function($a,zb,Cc,Ba){function Ca(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return td.yield($a.animate({opacity:0,duration:300}),2);$a.startPoint.clearConnection();$a.endPoint.clearConnection();$a.remove();td.jumpToEnd()})}Ba=void 0===Ba?!1:Ba;var Nb,Ec,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){return 1==td.nextAddress?(Nb=$a,Ec=Nb.endPoint,(fb=Ec.connectedMorph)&&"MorphContainer"==Fa.getClassName(fb)&&(fb=fb.target),fb?td.yield(Fa.interactiveConnectGivenSourceAndTarget(Cc,
Ba,fb),2):td.jumpTo(2)):td.yield(Ca(),0)})};Fa.editConnection=function($a){var zb=$a.connection,Cc=$a.connectionPoint,Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ca){if(1==Ca.nextAddress)return Ba=Fa.visualizeConnection(Cc,zb.targetObj,!1,{borderColor:Fa.Color.gray.darker(),endpointStyle:{start:{fill:Fa.Color.transparent,nativeCursor:"auto"},end:{fill:Fa.Color.gray.darker()}}}),Ca.yield(Fa.interactivelyReEvaluateConnection(zb,"Edit Connection",!1),2);Ba.remove();Ca.jumpToEnd()})};
Fa.Tree=te;Fa.TreeData=Bc;Fa.Icon=sd;Fa.morph=pe;Fa.pt=ac;Fa.Rectangle=jc;Fa.rect=Pc;Fa.Color=Uc;Fa.arr=Jd;Fa.connect=Tc;Fa.signal=Rd;Fa.Leash=Ze;Fa.once=Kd;Fa.interactivelyReEvaluateConnection=rc;Fa.interactiveConnectGivenSource=Qa;Fa.interactiveConnectGivenSourceAndTarget=Eb;Fa.getClassName=Zc;(function($a){var zb=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js"),Cc=zb.hasOwnProperty("ConnectionsTreeData")&&"function"===typeof zb.ConnectionsTreeData?zb.ConnectionsTreeData:zb.ConnectionsTreeData=
function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ha(Cc,$a,[{key:"parseMorphConnections",value:function(Ba){for(var Ca={},Nb=$jscomp.makeIterator(void 0===Ba.attributeConnections?[]:Ba.attributeConnections),Ec=Nb.next();!Ec.done;Ec=Nb.next())Ec=Ec.value,Ec.targetObj.isHalo||(Ca[Ec.sourceAttrName]=Ca[Ec.sourceAttrName]||[{name:["      New Connection  ",{fontColor:Fa.Color.white.withA(.5),fontStyle:"italic"},this.renderPin(Ba,
Ec.sourceAttrName),{}]}],Fa.arr.pushAt(Ca[Ec.sourceAttrName],{name:[].concat($jscomp.arrayFromIterable(this.renderExistingConnection(Ec)))},0));return{children:Object.entries(Ca).map(function(fb){var td=$jscomp.makeIterator(fb);fb=td.next().value;td=td.next().value;return{name:[fb,{fontWeight:"bold"}," ",{},Fa.morph({fill:Fa.Color.white,opacity:.7,value:""+(td.length-1),borderRadius:15,fontWeight:"bold",padding:Fa.Rectangle.inset(5,0,5,0),type:"label"}),{paddingTop:"4px"}],children:td}}).concat([{name:["New Connection  ",
{fontColor:Fa.Color.white.withA(.5),fontStyle:"italic"},this.renderPin(Ba),{}]}])}}},{key:"renderExistingConnection",value:function(Ba){var Ca=this,Nb=Fa.morph({type:"label",fontColor:Fa.Color.gray,fontSize:16,nativeCursor:"pointer",value:[].concat($jscomp.arrayFromIterable(Fa.Icon.textAttribute("long-arrow-alt-right",{paddingTop:"4px"})),["  ",{},Ba.targetMethodName,{}])}),Ec=this.renderDeadPin(),fb=Ec.submorphs[0];Fa.connect(Nb,"onHoverIn",function(){Nb.fontColor=Fa.Color.orange;Nb._leash=Fa.visualizeConnection(fb,
Ba.targetObj,Nb._leash);fb.fill=Fa.Color.orange;fb.border={color:Fa.Color.orange,width:3}});Fa.connect(Nb,"onMouseDown",function(td){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xd){if(1==Xd.nextAddress)return td.stop(),Xd.yield(Fa.interactivelyReEvaluateConnection(Ba),2);Fa.signal(Ca,"refresh");Xd.jumpToEnd()})});Fa.connect(Nb,"onHoverOut",function(){Nb.fontColor=Fa.Color.gray;fb.fill=Fa.Color.gray;fb.border={color:Fa.Color.white,width:1};Nb._leash.remove();Nb._leash=void 0});return[Nb,
{},"  ",{}].concat($jscomp.arrayFromIterable(Fa.Icon.textAttribute("times",{nativeCursor:"pointer ",onMouseDown:function(){Ba.disconnect();Fa.signal(Ca,"refresh")}})),["  ",{},Ec,{}])}},{key:"renderDeadPin",value:function(){var Ba=Fa.morph({type:"ellipse",fill:Fa.Color.gray,extent:Fa.pt(10,10),center:Fa.pt(8,12),borderWidth:1});return Fa.morph({extent:Fa.pt(20,20),fill:Fa.Color.transparent,reactsToPointer:!1,submorphs:[Ba]})}},{key:"renderPin",value:function(Ba,Ca){var Nb=this,Ec=Fa.morph({type:"ellipse",
fill:Fa.Color.gray.withA(.5),extent:Fa.pt(10,10),center:Fa.pt(8,12),draggable:!1,borderWidth:1}),fb=new Fa.Leash({opacity:0,styleClasses:["Halo"],isSmooth:!0,epiMorph:!0,hasFixedPosition:!0,borderColor:Fa.Color.gray.darker(),endpointStyle:{fill:Fa.Color.gray.darker()},position:Fa.pt(1,1),vertices:[Fa.pt(0,0),Fa.pt(0,0)],getLabelFor:function(td){return"MorphContainer"==Fa.getClassName(td)?td.target.name:td.name},canConnectTo:function(td){return"MorphContainer"==Fa.getClassName(td)||2>Fa.arr.intersect([td].concat($jscomp.arrayFromIterable(td.ownerChain())),
[Ec].concat($jscomp.arrayFromIterable(Ec.ownerChain()))).length}});Ec.addMorph(fb);Fa.connect(fb.endPoint,"onDragStart",function(){Fa.startConnecting(fb,Ec)});Fa.connect(fb.endPoint,"onDragEnd",function(td){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xd){if(1==Xd.nextAddress)return Ec.center=Fa.pt(8,12),Xd.yield(Fa.stopConnecting(fb,Ec,Ba,Ca),2);Fa.signal(Nb,"refresh");Xd.jumpToEnd()})});return Fa.morph({extent:Fa.pt(20,20),fill:Fa.Color.transparent,reactsToPointer:!1,submorphs:[Ec]})}},
{key:"display",value:function(Ba){return Ba.name}},{key:"collapse",value:function(Ba,Ca){Ba.isCollapsed=Ca}},{key:"isCollapsed",value:function(Ba){return Ba.isCollapsed}},{key:"isLeaf",value:function(Ba){return!Ba.children}},{key:"getChildren",value:function(Ba){return Ba.children}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ConnectionsTreeData"}},{key:"for",value:function(Ba){var Ca=new this;Ca.root=Ca.parseMorphConnections(Ba);return Ca}}],zb,{pathInPackage:function(){return"index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ConnectionsTree",version:"0.1.1-16"}}},{start:3542,end:8259})})(Fa.TreeData);kb=function($a){var zb=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js"),Cc=zb.hasOwnProperty("ConnectionsTree")&&"function"===typeof zb.ConnectionsTree?zb.ConnectionsTree:zb.ConnectionsTree=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ha(Cc,$a,[{key:"inspectConnectionsOf",value:function(Ba){if(this.targetMorph=Ba)this.treeData=Fa.ConnectionsTreeData.for(Ba),Fa.connect(this.treeData,"refresh",this,"refresh")}},{key:"refresh",value:function(){this.targetMorph&&(this.treeData=Fa.ConnectionsTreeData.for(this.targetMorph),Fa.connect(this.treeData,"refresh",this,"refresh"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ConnectionsTree"}},
{key:"properties",get:function(){return{}}}],zb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ConnectionsTree",version:"0.1.1-16"}}},{start:8276,end:8829})}(Fa.Tree);kb=Fa.ConnectionsTree;Fa.default=kb}}});
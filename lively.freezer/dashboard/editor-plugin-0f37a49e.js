System.register(["./__root_module__-aa47e4cd.js","./index-f9b193f7.js","./index-b8a9cfe8.js"],function(Ca){var ub,Tb,lc,mc,Zd,id,ce,kd,$c,Cd,Fd,pe,Xd,nd,eb,Hb,Cc,qc,ld,wd,Xc,gd,bc,ad,ed,Id,hc,Qb,xb,Nb,kb,Db,Rb,vc,jc,qb,rb,cc,Vc,Bc,xc,kc,Q,ea,Ga;return{setters:[function(Ua){ub=Ua.C;Tb=Ua.aq;lc=Ua.a4;mc=Ua.$;Zd=Ua.a1;id=Ua.al;ce=Ua.bf;kd=Ua.aT;$c=Ua.ao;Cd=Ua.s;Fd=Ua.aN;pe=Ua.bm;Xd=Ua.bn;nd=Ua.a5;eb=Ua.as;Hb=Ua.an;Cc=Ua.ap;qc=Ua.bo;ld=Ua.bp;wd=Ua.a0;Xc=Ua.P;gd=Ua._;bc=Ua.aV;ad=Ua.ag;ed=Ua.ah;Id=
Ua.ai;hc=Ua.aj;Qb=Ua.az;xb=Ua.aY;Nb=Ua.av;kb=Ua.am;Db=Ua.a8;Rb=Ua.bq;vc=Ua.L;jc=Ua.br;qb=Ua.b1;rb=Ua.bg;cc=Ua.b0;Vc=Ua.bs;Bc=Ua.ar},function(Ua){xc=Ua.M;kc=Ua.I;Q=Ua.v;ea=Ua.p},function(Ua){Ga=Ua.localInterface}],execute:function(){function Ua(Ma,cb){if(!0===cb)return cb;if(Ma.copyState)return Ma.copyState(cb);Ma={};for(var Mb in cb){var ba=cb[Mb];ba instanceof Array&&(ba=ba.concat([]));Ma[Mb]=ba}return Ma}function fc(Ma,cb,Mb){return Ma.startState?Ma.startState(cb,Mb):!0}function Fb(Ma,cb){return P.modes[Ma]=
cb}function Va(Ma){if("string"==typeof Ma&&P.mimeModes.hasOwnProperty(Ma))Ma=P.mimeModes[Ma];else if(Ma&&"string"==typeof Ma.name&&P.mimeModes.hasOwnProperty(Ma.name)){var cb=P.mimeModes[Ma.name];"string"==typeof cb&&(cb={name:cb});Ma=Object.assign({},cb,Ma);Ma.name=cb.name}else{if("string"==typeof Ma&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ma))return Va("application/xml");if("string"==typeof Ma&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ma))return Va("application/json")}return"string"==typeof Ma?{name:Ma}:Ma||{name:"null"}}
function Ab(Ma,cb){cb=P.resolveMode(cb);"string"===typeof cb&&(cb={name:cb});if(!cb.name)throw Error("parserConfig does not have a name of the mode to get");var Mb=P.modes[cb.name];if(!Mb)return Ab(Ma,"text/plain");Ma=Object.assign({indentUnit:2},Ma);return Object.assign(Mb(Ma,cb),{name:cb.name})}function td(Ma,cb){for(var Mb;Ma.innerMode;){Mb=Ma.innerMode(cb);if(!Mb||Mb.mode==Ma)break;cb=Mb.state;Ma=Mb.mode}return Mb||{mode:Ma,state:cb}}function Pc(Ma,cb){P.mimeModes[Ma]=cb}function Vb(Ma,cb,Mb){}
function Oa(Ma,cb,Mb,ba,La,mb,zb){var Qc=Ma.editorPlugin._tokenizerValidBefore;Qc&&Qc.row>=Mb&&(Qc.row=Mb-1);var yc=P.linesToTokenize(Ma.document,Mb,ba,Qc);Qc=yc.lines;yc=yc.state;if(!Qc.length)return!1;yc=yc?P.copyState(cb,yc):P.startState(cb);for(var Ed=0;Ed<Qc.length;Ed++){var Ad=Qc[Ed],Bd=Ad.row;Bd>=Mb&&Bd<=ba&&P.indentLine(Ma,cb,Ad,yc,La,mb,zb);yc=P.tokenizeLine(cb,Qc[Ed],yc,function(){})}return!0}function Qa(Ma,cb,Mb,ba,La,mb,zb){cb=P.linesToTokenize(cb,Mb,ba,La);Mb=cb.lines;P.tokenizeLines(Ma,
Mb,cb.state,mb,zb);return Mb}function Aa(Ma,cb,Mb,ba,La){var mb=[],zb,Qc=function(Ad){return mb.push(zb=[])},yc=function(Ad,Bd,Ke,Jg,wg,Qh,Uf){return zb.push(Ke,Jg,Ad,wg.current(),Bd.localMode||Uf)};try{var Ed=P.visitDocumentTokens(Ma,cb,Mb,ba,La,Qc,yc)}catch(Ad){mb.length=0,Ed=P.visitDocumentTokens(Ma,cb,Mb,ba,null,Qc,yc)}return{tokens:mb,lines:Ed}}function za(Ma,cb,Mb,ba,La){null==cb&&(cb=Ma.search(/[^\s\u00a0]/),-1==cb&&(cb=Ma.length));ba=ba||0;for(La=La||0;;){var mb=Ma.indexOf("\t",ba);if(0>mb||
mb>=cb)return La+(cb-ba);La+=mb-ba;La+=Mb-La%Mb;ba=mb+1}}function Ka(Ma){Ma=Ma.toLowerCase();for(var cb=0;cb<P.modeInfo.length;cb++){var Mb=P.modeInfo[cb];if(Mb.mime==Ma)return Mb;if(Mb.mimes)for(var ba=0;ba<Mb.mimes.length;ba++)if(Mb.mimes[ba]==Ma)return Mb}if(/\+xml$/.test(Ma))return Ka("application/xml");if(/\+json$/.test(Ma))return Ka("application/json")}function tb(Ma){for(var cb=0;cb<P.modeInfo.length;cb++){var Mb=P.modeInfo[cb];if(Mb.ext)for(var ba=0;ba<Mb.ext.length;ba++)if(Mb.ext[ba]==Ma)return Mb}}
function yb(Ma){for(var cb=0;cb<P.modeInfo.length;cb++){var Mb=P.modeInfo[cb];if(Mb.file&&Mb.file.test(Ma))return Mb}cb=Ma.lastIndexOf(".");if(Ma=-1<cb&&Ma.substring(cb+1,Ma.length))return P.findModeByExtension(Ma)}function zc(Ma){Ma=Ma.toLowerCase();for(var cb=0;cb<P.modeInfo.length;cb++){var Mb=P.modeInfo[cb];if(Mb.name.toLowerCase()==Ma)return Mb;if(Mb.alias)for(var ba=0;ba<Mb.alias.length;ba++)if(Mb.alias[ba].toLowerCase()==Ma)return Mb}}function pd(Ma){if(!Ma)return String(Ma);if(Array.isArray(Ma))return"["+
Ma.map(pd).join(",")+"]";if("symbol"===typeof Ma)return Qd.printSymbol(Ma);try{return String(Ma)}catch(cb){return"Cannot print object: "+cb}}function Yd(Ma,cb){return!Qd.arr.every(cb.map(function(Mb){return Ma[Mb]}),function(Mb){return Qd.obj.equals(Mb,Ma&&Ma.valueOf())})}function Ge(Ma){if(Qd.obj.isPrimitive(Ma))var cb=Qd.string.print(Ma);else Array.isArray(Ma)?((cb=3<Ma.length)&&(Ma=Ma.slice(0,3)),Ma=Qd.string.print(Ma),cb&&(Ma=Ma.slice(0,-1)+", ...]"),cb=Ma):cb=Qd.string.print(Ma);cb=cb.replace(/\n/g,
"");500<cb.length&&(cb=cb.slice(0,20)+("...["+(cb.length-20)+' CHARS]"'));return cb}function Sc(Ma){return Yc.Inspector.openInWindow({targetObject:Ma})}function ye(Ma,cb){return Yc.Inspector.openInWindow({remoteTarget:{code:Ma,evalEnvironment:cb}})}function Gd(Ma,cb){function Mb(Qc){var yc=Qc.name,Ed=Qc.ownerChain(),Ad=Qc.owner,Bd=Qc.world(),Ke;Qc===mb&&(Ke=[zb]);Bd===Qc&&(Ke=["$world"]);if(!Ke&&yc&&Ad){Ad===Bd&&1===Yc.arr.count(Yc.arr.pluck(Bd.submorphs,"name"),yc)&&(Ke=['$world.get("'+yc+'")']);
if(!Ke&&Ad!=Bd)for(Bd=Ed.length-1;Bd--;)if(1===Ed[Bd].getAllNamed(yc).length){Ke=[].concat($jscomp.arrayFromIterable(Mb(Ed[Bd])),['get("'+yc+'")']);break}Ke||(yc=[].concat($jscomp.arrayFromIterable(Mb(Ad)),['get("'+yc+'")']),Yc.syncEval(yc.join("."),{context:mb}).value===Qc&&(Ke=yc))}Ke||(Ke=[zb+'.getMorphById("'+Qc.id+'")']);return Ke}cb=void 0===cb?{}:cb;var ba=Ma.world(),La=cb;cb=void 0===La.maxLength?10:La.maxLength;var mb=void 0===La.fromMorph?ba:La.fromMorph;if(mb===Ma)return"this";var zb=ba===
mb?"$world":"this";if(!(ba||Ma.name&&mb.get(Ma.name)===Ma))return"morph";ba=Mb(Ma);return ba.length>cb?'$world.getMorphWithId("'+Ma.id+'")':ba.join(".")}function Sb(Ma,cb,Mb){var ba=(cb=void 0===cb?"":cb)&&pf.arr.last(cb.split(".")).toLowerCase(),La="",mb=0,zb=Math.pow(2,19);if("string"===typeof Ma){if(Ma.length>zb)return null}else if(Ma.document.stringSize>zb)return null;if("string"===typeof Ma)La=Ma.slice(0,1E3);else for(Ma=$jscomp.makeIterator(Ma.document.lines),zb=Ma.next();!zb.done;zb=Ma.next()){var Qc=
zb.value;zb=Qc.stringSize;Qc=Qc.text;var yc=!0;1E3<mb+zb&&(yc=!1,zb=1E3-mb);La+=Qc.slice(0,zb)+(yc?"\n":"");mb+=zb;if(1E3<=mb)break}mb=$jscomp.makeIterator(pf.modeInfo);for(Ma=mb.next();!Ma.done;Ma=mb.next()){yc=Ma.value;zb=yc.contentTest;Ma=yc.mode;Qc=yc.ext;yc=yc.file;if("function"===typeof zb)try{if(zb(La))return Ma}catch(Ed){}if(yc&&yc instanceof RegExp&&yc.test(cb))return Ma;if(Qc)for(zb=$jscomp.makeIterator(Qc),Qc=zb.next();!Qc.done;Qc=zb.next())if(Qc.value===ba)return Ma}return Mb}Ca({a:Pc,
d:Fb,r:Vb});var oa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");oa.Color=ub;var Ha=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Mb=cb.hasOwnProperty("DefaultTheme")&&"function"===typeof cb.DefaultTheme?cb.DefaultTheme:cb.DefaultTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:"background",get:function(){return oa.Color.white}},
{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:oa.Color.white,fontWeight:"bold",backgroundColor:oa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:oa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:oa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:"className",get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],cb,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:42,end:2867})}(void 0),Kb=Ha=oa.DefaultTheme;oa.default=Ha;var P=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");P.copyState=Ua;P.startState=fc;P.defineMode=Fb;P.resolveMode=Va;P.getMode=Ab;P.innerMode=td;P.defineMIME=Pc;P.registerHelper=Vb;P.indentLines=Oa;P.indentLine=function(Ma,cb,Mb,ba,La,mb,zb){zb=Object.assign({indentWithTabs:!Ma.useSoftTabs,indentUnit:Ma.tabWidth,tabSize:4,ignoreFollowingText:!1},zb);null==La&&(La="add");"smart"==La&&(cb.indent||(La=
"prev"));var Qc=zb.tabSize,yc=Mb.text,Ed=P.countColumn(yc,null,Qc);Mb.modeState&&(Mb.modeState=null);var Ad=yc.match(/^\s*/)[0];if(!mb&&!/\S/.test(yc)){var Bd=0;La="not"}else if("smart"==La&&(Bd=cb.indent(ba,zb.ignoreFollowingText?"":yc.slice(Ad.length),yc),Bd==P.passIndent||150<Bd)){if(!mb)return;La="prev"}"prev"==La?Bd=0<Mb.row?P.countColumn(Mb.prevLine().text,null,Qc):0:"add"==La?Bd=Ed+zb.indentUnit:"subtract"==La?Bd=Ed-zb.indentUnit:"number"==typeof La&&(Bd=Ed+La);Bd=Math.max(0,Bd);cb="";ba=0;
if(zb.indentWithTabs)for(zb=Math.floor(Bd/Qc);zb;--zb)ba+=Qc,cb+="\t";ba<Bd&&(cb+=" ".repeat(Bd-ba));if(cb!=Ad)return Ma.replace({start:{row:Mb.row,column:0},end:{row:Mb.row,column:Ad.length}},cb),!0};P.tokenizeLines=function(Ma,cb,Mb,ba,La){if(cb.length){Mb=Mb?P.copyState(Ma,Mb):P.startState(Ma);for(var mb=0;mb<cb.length;mb++){var zb=cb[mb];ba(zb);Mb=P.tokenizeLine(Ma,zb,Mb,La)}}};P.tokenizeLine=function(Ma,cb,Mb,ba){var La=cb.text;if(!La)return Mb;var mb=new P.StringStream(La,2);Mb=cb.modeState=
"function"===typeof Ma.copyState?Ma.copyState(Mb):P.copyState(Ma,Mb);cb.prevLine();for(Mb._string=La;!mb.eol();)La=Ma.token(mb,Mb),ba(La,Mb,mb.start,mb.pos,mb,cb,Ma),mb.start=mb.pos;return Mb};P.printTokens=function(Ma){for(var cb="",Mb=0;Mb<Ma.length;Mb+=5)cb+=Ma[Mb+0]+" => "+Ma[Mb+1]+" "+Ma[Mb+2]+" "+Ma[Mb+3]+" "+Ma[Mb+4].name+"\n";return cb};P.visitDocumentTokens=Qa;P.tokenizeDocument=Aa;P.linesToTokenize=function(Ma,cb,Mb,ba){if(ba&&ba.row>=Mb)return{lines:[],state:null};cb=ba?Math.max(0,ba.row-
1):cb;var La=Ma.getLine(cb),mb=La.text;Ma=[La];ba=null;for(var zb=0,Qc;(Qc=La.prevLine())&&50>zb++;){La=Qc;if(La.modeState){ba=La.modeState;break}Ma.unshift(La)}if(!ba){for(var yc=La,Ed=Infinity;(Qc=La.prevLine())&&100>zb++;){La=Qc;if(La.modeState){ba=La.modeState;break}Ma.unshift(La);Qc=mb.match(/^\s*/)[0].length;if(0===Qc)break;Qc<Ed&&(Ed=Qc,yc=La)}!ba&&0<Ed&&(Ma=Ma.slice(Ma.indexOf(yc)))}if(Mb>cb)for(La=P.arr.last(Ma);cb<=Mb;cb++){La=La.nextLine();if(!La)break;Ma.push(La)}return{lines:Ma,state:ba}};
P.countColumn=za;P.findModeByMIME=Ka;P.findModeByExtension=tb;P.findModeByFileName=yb;P.findModeByName=zc;P.arr=lc;Ha=P.modes||{};P.modes=Ha;P.modes=Ha;P.modes=Ha;Ha=Ca("p",{});P.passIndent=Ha;P.passIndent=Ha;P.passIndent=Ha;P.copyState=Ua;P.copyState=Ua;P.startState=fc;P.startState=fc;P.defineMode=Fb;P.defineMode=Fb;P.resolveMode=Va;P.resolveMode=Va;P.getMode=Ab;P.getMode=Ab;P.innerMode=td;P.innerMode=td;Ha={};P.mimeModes=Ha;P.mimeModes=Ha;P.mimeModes=Ha;P.defineMIME=Pc;P.defineMIME=Pc;P.registerHelper=
Vb;P.registerHelper=Vb;P.indentLines=Oa;P.indentLines=Oa;P.visitDocumentTokens=Qa;P.visitDocumentTokens=Qa;P.tokenizeDocument=Aa;P.tokenizeDocument=Aa;P.countColumn=za;P.countColumn=za;(function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Mb=cb.hasOwnProperty("StringStream")&&"function"===typeof cb.StringStream?cb.StringStream:cb.StringStream=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Tb(Mb,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,La){this.reset(ba,La)}},{key:"reset",value:function(ba,La){this.pos=this.start=0;this.string=void 0===ba?"":ba;this.tabSize=void 0===La?2:La;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<
this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(ba){var La=this.string.charAt(this.pos);if("string"==typeof ba?La==ba:La&&(ba.test?ba.test(La):ba(La)))return++this.pos,La}},{key:"eatWhile",value:function(ba){for(var La=this.pos;this.eat(ba););return this.pos>La}},{key:"eatSpace",value:function(){for(var ba=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>ba}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",
value:function(ba){ba=this.string.indexOf(ba,this.pos);if(-1<ba)return this.pos=ba,!0}},{key:"backUp",value:function(ba){this.pos-=ba}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=P.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return P.countColumn(this.string,
null,this.tabSize)-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(ba,La,mb){if("string"==typeof ba){var zb=function(yc){return mb?yc.toLowerCase():yc},Qc=this.string.substr(this.pos,ba.length);if(zb(Qc)==zb(ba))return!1!==La&&(this.pos+=ba.length),!0}else{if((ba=this.string.slice(this.pos).match(ba))&&0<ba.index)return null;ba&&!1!==La&&(this.pos+=ba[0].length);return ba}}},{key:"current",value:function(){return this.string.slice(this.start,
this.pos)}},{key:"hideFirstChars",value:function(ba,La){this.lineStart+=ba;try{return La()}finally{this.lineStart-=ba}}}],[{key:"className",get:function(){return"StringStream"}}],cb,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);Ha=[{name:"APL",mime:"text/apl",
mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),
alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",
mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",
mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ma){return Ma.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",
mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",
mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",
mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",
mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",
mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},
{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",
mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",
mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p",
"pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",
ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},
{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",
mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Ma){return Ma.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},
{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},
{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",
mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",
mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",
ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml",
"text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];P.modeInfo=Ha;P.modeInfo=Ha;P.modeInfo=Ha;for(var sa=0;sa<P.modeInfo.length;sa++)P.info=P.modeInfo[sa],P.info.mimes&&(P.info.mime=P.info.mimes[0]);P.defineMode("null",function(){return{token:function(Ma){return Ma.skipToEnd()}}});
P.defineMIME("text/plain","null");P.findModeByMIME=Ka;P.findModeByMIME=Ka;P.findModeByExtension=tb;P.findModeByExtension=tb;P.findModeByFileName=yb;P.findModeByFileName=yb;P.findModeByName=zc;P.findModeByName=zc;var Ta=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Ta.Color=ub;Ta.Rectangle=mc;Ta.pt=Zd;Ta.morph=id;Ta.ShadowObject=ce;Ta.StyleSheet=kd;Ta.connect=$c;Ta.arr=lc;Ta.string=Cd;Ta.FilterableList=Fd;Ta.Range=pe;sa=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
Mb=cb.hasOwnProperty("Completer")&&"function"===typeof cb.Completer?cb.Completer:cb.Completer=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:"compute",value:function(){return[]}}],[{key:"className",get:function(){return"Completer"}}],cb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:345,end:391})}(void 0);Ta.Completer=sa;Ta.Completer=sa;Ta.Completer=sa;sa=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Mb=cb.hasOwnProperty("WordCompleter")&&"function"===typeof cb.WordCompleter?cb.WordCompleter:cb.WordCompleter=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:"compute",
value:function(ba,La){var mb=[],zb=[],Qc=ba.document.lineStrings;ba=ba.cursorPosition.row;for(var yc=ba-1;0<=yc;yc--)for(var Ed=$jscomp.makeIterator(Qc[yc].split(/[^0-9a-z@_]+/i)),Ad=Ed.next();!Ad.done;Ad=Ed.next())(Ad=Ad.value)&&!mb.includes(Ad)&&Ad!==La&&(mb.push(Ad),zb.push({priority:1E3-(ba-yc),completion:Ad}));for(yc=ba+1;yc<Qc.length;yc++)for(Ed=$jscomp.makeIterator(Qc[yc].split(/[^0-9a-z_@]+/i)),Ad=Ed.next();!Ad.done;Ad=Ed.next())(Ad=Ad.value)&&!mb.includes(Ad)&&Ad!==La&&(mb.push(Ad),zb.push({priority:1E3-
(yc-ba),completion:Ad}));return zb}}],[{key:"className",get:function(){return"WordCompleter"}}],cb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:400,end:1228})}(void 0);Ta.WordCompleter=sa;Ta.WordCompleter=sa;Ta.WordCompleter=sa;sa=[new Ta.WordCompleter];Ta.defaultCompleters=sa;Ta.defaultCompleters=
sa;Ta.defaultCompleters=sa;sa=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Mb=cb.hasOwnProperty("CompletionController")&&"function"===typeof cb.CompletionController?cb.CompletionController:cb.CompletionController=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,La){La=void 0===La?[]:La;this.textMorph=
ba;this.completers=La=ba.pluginCollect("getCompleters",La)}},{key:"computeCompletions",value:function(ba){var La=this,mb,zb,Qc,yc,Ed,Ad,Bd,Ke,Jg,wg,Qh,Uf,Hh,ek,Zh,ml;return $jscomp.asyncExecutePromiseGeneratorProgram(function(If){switch(If.nextAddress){case 1:mb=[],zb=$jscomp.makeIterator(La.completers),Qc=zb.next();case 2:if(Qc.done){If.jumpTo(4);break}yc=Qc.value;If.setCatchFinallyBlocks(5);Ed=mb;Ad=Ed.concat;return If.yield(yc.compute(La.textMorph,ba),7);case 7:mb=Ad.call(Ed,If.yieldResult);If.leaveTryBlock(3);
break;case 5:Bd=If.enterCatchBlock(),console.warn("Error in completer "+yc+": "+(Bd.stack||Bd));case 3:Qc=zb.next();If.jumpTo(2);break;case 4:Ke=new Map;mb.forEach(function(Gj){var bj=Ke.get(Gj.completion);bj||(bj=[],Ke.set(Gj.completion,bj));bj.push(Gj)});Jg=[];wg=$jscomp.makeIterator(Ke.values());for(Qh=wg.next();!Qh.done;Qh=wg.next())Uf=Qh.value,Jg.push(Ta.arr.last(Ta.arr.sortByKey(Uf,"priority")));Hh=0;ek=Ta.arr.sortByKey(Jg,"priority").reverse();Zh=ek.length&&ek[0].priority||0;ml=ek.map(function(Gj){Gj.highestPriority=
Zh;var bj=Gj.completion.replace(/\n/g,""),Pe=String((Gj.info||"").replace(/\n/g,""));Hh=Math.max(Hh,bj.length+Pe.length);return{isListItem:!0,string:bj,annotation:Pe,value:Gj}});return If.return({items:ml,maxCol:Hh})}})}},{key:"computeSortedCompletions",value:function(ba,La){La=void 0===La?!1:La;var mb=this,zb,Qc,yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ed){if(1==Ed.nextAddress)return zb={tokens:[ba],lowercasedTokens:[ba],input:ba},Ed.yield(mb.computeCompletions(ba),2);Qc=Ed.yieldResult;
yc=Ta.arr.sortBy(Qc.items.filter(function(Ad){return mb.filterFunction(zb,Ad,La)}),function(Ad){return mb.sortFunction(zb,Ad)});return Ed.return(yc)})}},{key:"_printCompletions",value:function(ba){var La=this,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return zb.yield(La.computeSortedCompletions(ba),2);mb=zb.yieldResult.map(function(Qc){return{completion:Qc.value.completion,priority:Qc.value.priority,maxP:Qc.value.highestPriority,sortVal:Qc._cache[ba].sortVal,
lev:JSON.stringify(Qc._cache[ba].levenshtein)}});return zb.return(Ta.string.printTable(lively.lang.grid.tableFromObjects(mb)))})}},{key:"prefix",value:function(){var ba=this.textMorph,La=ba.selection;return(La.isEmpty()?ba.getLine(La.lead.row).slice(0,La.lead.column):La.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(ba,La,mb){mb=void 0===mb?!1:mb;La._cache||(La._cache={});var zb=ba.tokens,Qc=ba.lowercasedTokens,yc=ba.input;yc=La._cache[yc]||(La._cache[yc]={});if(yc.hasOwnProperty("filtered"))return yc.filtered;
La=La.value.completion.replace(/\([^\)]*\)$/,"");var Ed=La.toLowerCase();if(mb&&zb[0]&&!La.startsWith(zb[0]))return yc.filtered=!1;if(Qc.every(function(Bd){return Ed.includes(Bd)}))return!0;var Ad=yc.levenshtein||(yc.levenshtein={});ba=mb||3>=Ta.arr.sum(ba.lowercasedTokens.map(function(Bd){return Ad[Bd]||(Ad[Bd]=Ta.string.levenshtein(Ed,Bd))}));return yc.filtered=ba}},{key:"sortFunction",value:function(ba,La){La._cache||(La._cache={});var mb=La._cache[ba.input]||(La._cache[ba.input]={});if(mb.hasOwnProperty("sortVal"))return mb.sortVal;
mb=La._cache[ba.input]={};var zb=La.value;La=zb.highestPriority;var Qc=zb.completion;zb=zb.priority;Qc=Qc.replace(/\([^\)]*\)$/,"").toLowerCase();var yc=0;ba.lowercasedTokens.forEach(function(Ad){Qc.startsWith(Ad)?yc+=12:3<=Ad.length&&Qc.includes(Ad)&&(yc+=5)});La=-((zb||(yc?La:0))/Math.pow(10,String(La).length-2))-yc;var Ed=mb.levenshtein||(mb.levenshtein={});ba=Ta.arr.sum(ba.lowercasedTokens.map(function(Ad){return Ed[Ad]||(Ed[Ad]=Ta.string.levenshtein(Qc,Ad))}));yc&&(ba/=2);return mb.sortVal=ba+
La}},{key:"positionForMenu",value:function(){var ba=this.textMorph,La=ba.charBoundsFromTextPosition(ba.cursorPosition);return ba.getGlobalTransform().transformRectToRect(La).topLeft().addXY(-ba.scroll.x,-ba.scroll.y).addPt(Ta.pt(ba.borderWidth+3,ba.borderWidth+3))}},{key:"completionListSpec",value:function(){var ba=this,La,mb,zb,Qc,yc,Ed,Ad,Bd,Ke,Jg,wg,Qh,Uf,Hh,ek,Zh,ml,If,Gj,bj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pe){if(1==Pe.nextAddress)return mb=La=ba.textMorph,zb=mb.fontSize,
Qc=mb.fontFamily,yc=ba.positionForMenu(),Ed=ba.prefix(),Pe.yield(ba.computeCompletions(Ed),2);Ad=Pe.yieldResult;Bd=Ad.items;Ke=Ad.maxCol;Jg=La.env.fontMetric.sizeFor(Qc,zb,"M");wg=Jg.width*Ke;Qh=La.document.getLine(0).height;Uf=Math.max(120,wg<La.width?wg:La.width);Hh=Qh*Bd.length+Qh+10;ek=Math.max(70,Math.min(700,Hh));Zh=yc.extent(Ta.pt(Uf,ek));if(ml=La.world())If=ml.visibleBounds().insetBy(5),Zh.bottom()>If.bottom()&&(Gj=Zh.bottom()-If.bottom(),Gj>Zh.height-50&&(Gj=Zh.height-50),Zh.height-=Gj),
Zh.right()>If.right()&&(bj=Zh.right()-If.right(),Zh.width=120>Zh.width-bj?120:Zh.width-bj),If.containsRect(Zh)||(Zh=Zh.withTopLeft(If.translateForInclusion(Zh).topLeft())),Zh=Zh.translatedBy(If.insetBy(0).topLeft().negated());return Pe.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},hasFixedPosition:!0,epiMorph:!0,fontSize:zb,position:Zh.topLeft(),extent:Zh.extent(),items:Bd,input:Ed,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:ba.filterFunction,
sortFunction:ba.sortFunction})})}},{key:"removeMenuOnBlur",value:function(ba){var La=ba.menu;setTimeout(function(){La.withAllSubmorphsDetect(function(mb){return mb.isFocused()})?La.inputMorph.focus():La.remove()})}},{key:"openCompletionList",value:function(){var ba=this,La,mb,zb,Qc,yc,Ed,Ad,Bd,Ke,Jg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wg){if(1==wg.nextAddress)return La=ba.textMorph.selection.start,wg.yield(ba.completionListSpec(),2);mb=wg.yieldResult;ba.textMorph.pluginFind(function(Qh){return Qh.theme});
zb=new Ta.FilterableList(mb);Qc=new Ta.Range({start:La,end:ba.textMorph.selection.start});yc=ba.textMorph.textInRange(Qc);Ed=zb.inputMorph;Ad=zb.listMorph;Bd=mb.input;Ke=zb.addMorph({name:"prefix mask",fill:Ta.Color.transparent,bounds:Ed.textBounds()},Ed);Ad.master=null;Qc.isEmpty()||(ba.textMorph.deleteText(Qc),Ed.input=yc,Ed.gotoDocumentEnd());Ed.fontColor=ba.textMorph.fontColor;Ta.connect(Ed,"textString",Ke,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Ed}});Ta.connect(zb,
"accepted",ba,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Bd}});Ta.connect(zb,"accepted",zb,"remove");Ta.connect(zb,"canceled",zb,"remove");Ta.connect(zb,"remove",ba.textMorph,"focus");Ta.connect(zb.inputMorph,"onBlur",ba,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:zb}});Jg=ba.textMorph.world();Jg.addMorph(zb);Ad.addStyleClass("hiddenScrollbar");Ed.height=Ad.itemHeight;Ed.fixedHeight=!0;Ed.fontSize=Ad.fontSize;Ed.focus();zb.get("padding").height=0;zb.relayout();zb.selectedIndex=0;Bd.length?(Ed.gotoDocumentEnd(),
zb.moveBy(Ta.pt(-Ed.textBounds().width+2,0))):zb.moveBy(Ta.pt(2,0));return wg.return(zb)})}},{key:"autoInsertBestMatchingCompletion",value:function(ba,La,mb){La=void 0===La?!0:La;var zb=this,Qc,yc,Ed,Ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bd){if(1==Bd.nextAddress)return Qc=$jscomp,yc=Qc.makeIterator,Bd.yield(zb.computeSortedCompletions(ba,La),2);Ed=yc.call(Qc,Bd.yieldResult);(Ad=Ed.next().value)&&zb.insertCompletion(Ad.value.completion,ba,mb);Bd.jumpToEnd()})}},{key:"insertCompletion",
value:function(ba,La,mb){var zb=this.textMorph,Qc=zb.document,yc=zb.selection.isMultiSelection?zb.selection.selections:[zb.selection];zb.undoManager.group();yc.forEach(function(Ed){Ed.collapseToEnd();var Ad=Ed.lead,Bd=La?Qc.indexToPosition(Qc.positionToIndex(Ad)-La.length):Ad;"function"===typeof mb?mb(ba,La,zb,{start:Bd,end:Ad},Ed):zb.replace({start:Bd,end:Ad},ba)});zb.undoManager.group()}}],[{key:"className",get:function(){return"CompletionController"}}],cb,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1355,end:12497})}(void 0);Ta.CompletionController=sa;Ta.CompletionController=sa;Ta.CompletionController=sa;sa=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ma,cb,Mb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){return 1==La.nextAddress?
(ba=new Ta.CompletionController(Ma,Ta.defaultCompleters),La.yield(ba.openCompletionList(),2)):La.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ma,cb,Mb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){return 1==La.nextAddress?(ba=new Ta.CompletionController(Ma,Ta.defaultCompleters),La.yield(ba.autoInsertBestMatchingCompletion(ba.prefix()),2)):La.return(!0)})}}];Ta.completionCommands=sa;Ta.completionCommands=sa;Ta.completionCommands=
sa;var Ib=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Ib.chain=Xd;Ib.arr=lc;Ib.obj=nd;Ib.string=Cd;var Lc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ma){var cb=Ma.selection.start;0<cb.row&&(cb=Ma.getPositionAboveOrBelow(1,cb,!0,0,Ma.charBoundsFromTextPosition(cb).x),Ma.selection.addRange({start:cb,end:cb}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Ma){var cb=Ma.selection.start;
cb.row<Ma.documentEndPosition.row&&(cb=Ma.getPositionAboveOrBelow(-1,cb,!0,0,Ma.charBoundsFromTextPosition(cb).x),Ma.selection.addRange({start:cb,end:cb}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ma){var cb=Ma.selection.selections[Ma.selection.selections.length-1];if(cb.isEmpty())return!0;Ma.searchForAll(cb.text,{start:{column:0,row:0}}).forEach(function(Mb){return Ma.selection.addRange(Mb.range,!1)});Ma.selection.mergeSelections();Ib.arr.remove(Ma.selection.selections,
cb);Ma.selection.selections.push(cb);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ma){var cb=Ma.selection.selections.length-1,Mb=Ma.selection.selections[cb];if(Mb.isEmpty())return!0;var ba=Ma.search(Mb.text,{start:Mb.end,backwards:!1});ba&&(Mb=Ma.selection.selections.findIndex(function(La){return La.range.equals(ba.range)}),-1<Mb?Ib.arr.swap(Ma.selection.selections,Mb,cb):Ma.selection.addRange(ba.range));return!0}},{name:"[multi select] more like this backward",
multiSelectAction:"single",exec:function(Ma){var cb=Ma.selection.selections.length-1,Mb=Ma.selection.selections[cb];if(Mb.isEmpty())return!0;var ba=Mb.start,La=Ma.search(Mb.text,{start:{row:ba.row,column:ba.column-(Mb.text.length-1)},backwards:!0});La&&(Mb=Ma.selection.selections.findIndex(function(mb){return mb.range.equals(La.range)}),-1<Mb?Ib.arr.swap(Ma.selection.selections,Mb,cb):Ma.selection.addRange(La.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",
exec:function(Ma){var cb=Ma.selection.selections.length;1<cb&&Ma.selection.removeSelections(cb-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ma){Ma.selection.selections=lively.lang.arr.rotate(Ma.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(Ma){Ma.selection.selections=lively.lang.arr.rotate(Ma.selection.selections,1);return!0}},{name:"[multi select] align cursors",
multiSelectAction:"single",exec:function(Ma){var cb=Ma.selection.selections;if(1>=cb.length)return!0;var Mb=Ib.arr.groupBy(cb,function(La){return La.range.start.row});cb=Mb.keys().map(function(La){La=Mb[La];var mb=Ib.arr.max(La,function(zb){return zb.range.start.column});Ib.arr.without(La,mb).forEach(function(zb){return zb.range=mb.range});return mb});var ba=Ib.arr.max(cb,function(La){return La.range.start.column}).range.start.column;cb.forEach(function(La){var mb=La.range.start;La=mb.row;mb=mb.column;
Ma.insertText(" ".repeat(ba-mb),{row:La,column:mb})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ma){Ma.selection.disableMultiSelect();if(Ma.selection.isEmpty())var cb=Ma.lastSavedMark&&Ma.lastSavedMark.position||(void 0).lineRange().start,Mb=Ma.cursorPosition;else cb=Ma.selection,Mb=cb.lead,cb=cb.anchor;Ma.selection.collapse();var ba=cb.column,La=Mb.column;Ib.arr.range(cb.row,Mb.row).forEach(function(mb){return Ma.getLine(mb).length>Math.min(La,
ba)&&Ma.selection.addRange({end:{row:mb,column:La},start:{row:mb,column:ba}},!1)});Ma.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ma,cb,Mb){Mb=void 0===Mb?1:Mb;Ma.undoManager.group();Ma.selection.selections.forEach(function(ba,La){return ba.text=String(La+Mb)});Ma.undoManager.group();return!0}}];Ib.multiSelectCommands=Lc;Ib.multiSelectCommands=Lc;Ib.multiSelectCommands=Lc;var Wc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");
Wc.pToI=function(Ma,cb){return Ma.positionToIndex(cb)};Wc.iToP=function(Ma,cb){return Ma.indexToPosition(cb)};Wc.execCodeNavigator=function(Ma){return function(cb,Mb,ba){var La=cb.pluginInvokeFirst("getNavigator");if(!La)return!0;cb.saveMark();ba=ba||1;for(var mb=0;mb<ba;mb++)La[Ma](cb,Mb);return!0}};Wc.once=eb;var he=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Wc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",
exec:Wc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Wc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Wc.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Wc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",
bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ma,cb){function Mb(){var mb=Ma.$expandRegionState,zb=Wc.pToI(Ma,Ma.cursorPosition);if(mb&&(mb.range[0]===zb||mb.range[1]===zb))return mb;mb=Ma.selection.range;return Ma.$expandRegionState={range:[Wc.pToI(Ma,mb.start),Wc.pToI(Ma,mb.end)]}}cb=cb||{};var ba=Ma.pluginInvokeFirst("getNavigator");if(!ba)return!0;var La=cb.start;cb=cb.end;if("number"===typeof La&&"number"===typeof cb)Mb(),ba={range:[La,
cb],prev:Mb()};else{La=ba.ensureAST(Ma);if(!La)return;ba=ba.expandRegion(Ma,Ma.textString,La,Mb())}ba&&ba.range&&(Ma.selection={start:Wc.iToP(Ma,ba.range[0]),end:Wc.iToP(Ma,ba.range[1])},Ma.$expandRegionState=ba);Wc.once(Ma,"selectionChange",function(){return Ma.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ma){if(Ma.selection.isEmpty())return!0;
var cb=Ma.pluginInvokeFirst("getNavigator");if(!cb)return!0;var Mb=cb.ensureAST(Ma);if(!Mb)return!0;var ba=Ma.$expandRegionState;if(!ba)return!0;(cb=cb.contractRegion(Ma,Ma.textString,Mb,ba))&&cb.range&&(Ma.selection={start:Wc.iToP(Ma,cb.range[0]),end:Wc.iToP(Ma,cb.range[1])},Ma.$expandRegionState=cb);Wc.once(Ma,"selectionChange",function(){return Ma.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Wc.commands=he;Wc.commands=he;Wc.commands=he;var ie=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");
ie.arr=lc;ie.chain=Xd;ie.string=Cd;var kf=[{name:"toggle comment",exec:function(Ma){var cb=Ma.pluginInvokeFirst("getComment");if(!cb)return!0;if(!cb.lineCommentStart)return cb.blockCommentStart?Ma.execCommand("toggle block comment"):!0;var Mb=cb.lineCommentStart,ba=new RegExp("^(\\s*)("+Mb+"\\s?)(.*)");cb=Ma.document;var La=Ma.selection;La.isEmpty()||0!==La.end.column||La.growRight(-1);var mb=La.start.row;cb=cb.lineStrings.slice(La.start.row,La.end.row+1);cb=cb.some(function(yc){return!!yc.trim()})?
ie.arr.dropWhile(cb,function(yc){return yc.trim()?!1:++mb&&!0}):cb;var zb=cb.every(function(yc){return yc.trim()&&yc.match(ba)});Ma.undoManager.group();if(zb)cb.forEach(function(yc,Ed){if(yc=yc.match(ba)){yc=$jscomp.makeIterator(yc);yc.next();var Ad=yc.next().value,Bd=yc.next().value;yc.next();Ma.deleteText({start:{row:mb+Ed,column:Ad.length},end:{row:mb+Ed,column:Ad.length+Bd.length}})}});else{var Qc=cb.reduce(function(yc,Ed,Ad){return Ed.trim()||La.isEmpty()&&La.start.row===La.end.row?Math.min(yc,
Ed.match(/^\s*/)[0].length):yc},Infinity);Qc=Infinity===Qc?0:Qc;cb.forEach(function(yc,Ed){yc=$jscomp.makeIterator(yc.match(/^(\s*)(.*)/));yc.next();yc.next();yc.next();Ma.insertText(Mb+" ",{row:mb+Ed,column:Qc})})}Ma.undoManager.group();return!0}},{name:"toggle block comment",exec:function(Ma){var cb=Ma.pluginInvokeFirst("getComment");if(!cb)return!0;if(!cb.blockCommentStart)return cb.lineCommentStart?Ma.execCommand("toggle comment"):!0;if(!cb||!cb.blockCommentStart)return!0;var Mb=cb.blockCommentStart;
cb=cb.blockCommentEnd;var ba=new RegExp("^"+Mb.replace(/\*/g,"\\*")),La=new RegExp(cb.replace(/\*/g,"\\*")+"$"),mb=Ma.tokenAt(Ma.cursorPosition);if(mb&&"comment"===mb.token){var zb=Ma.textInRange(mb);if(zb.match(ba)&&zb.match(La))return Ma.undoManager.group(),Ma.replace(mb,zb.slice(Mb.length,-cb.length)),Ma.undoManager.group(),!0}Ma.undoManager.group();Ma.insertText(Mb,Ma.selection.start);Ma.insertText(cb,Ma.selection.end);Ma.undoManager.group();Mb=!Ma.selection.isEmpty();Ma.selection.growLeft(cb.length);
Mb||Ma.selection.collapse();return!0}},{name:"comment box",exec:function(Ma,cb,Mb){cb=Ma.undoManager.ensureNewGroup(Ma,"comment box");if(Ma.selection.isEmpty())return Ma.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ma.execCommand("toggle comment"),Ma.undoManager.group(cb),!0;var ba=Ma.selection.range,La=Ma.withSelectedLinesDo(function(zb){return zb}),mb=ie.arr.min([ba.start.column].concat(ie.chain(La).map(function(zb){return zb.match(/^\s*/)}).flatten().compact().pluck("length").value()));
La=ie.arr.max(La.map(function(zb){return zb.length}))-mb;La=Array(Math.ceil(La/2)+1).join("-=")+"-";Ma.execCommand("toggle comment");Ma.collapseSelection();Ma.cursorPosition={row:ba.start.row,column:0};Mb?Ma.insertText(ie.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",mb)):Ma.insertText(ie.string.indent(La+"\n"," ",mb));Ma.selection.goUp();Ma.execCommand("toggle comment");Ma.cursorPosition={row:ba.end.row+2,column:0};Ma.insertText(ie.string.indent(La+"\n"," ",mb));Ma.selection.goUp();
Ma.execCommand("toggle comment");Ma.selection.range={start:{row:ba.start.row,column:0},end:Ma.cursorPosition};Ma.undoManager.group(cb);return!0},multiSelectAction:"forEach",handlesCount:!0}];ie.commands=kf;ie.commands=kf;ie.commands=kf;var Qd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");Qd.printSymbol=function(Ma){if(Symbol.keyFor(Ma))return'Symbol.for("'+Symbol.keyFor(Ma)+'")';if(Qd.knownSymbols.get(Ma))return Qd.knownSymbols.get(Ma);String(Ma).match(Qd.symMatcher);return String(Ma)};
Qd.defaultSort=function(Ma,cb){if(Ma.hasOwnProperty("priority")||cb.hasOwnProperty("priority")){var Mb=Ma.priority||0,ba=cb.priority||0;if(Mb<ba)return-1;if(Mb>ba)return 1}Ma=(Ma.keyString||Ma.key).toLowerCase();cb=(cb.keyString||cb.key).toLowerCase();return Ma<cb?-1:Ma===cb?0:1};Qd.safeToString=pd;Qd.propertyNamesOf=function(Ma,cb){if(!Ma)return[];if(Array.isArray(Ma)){var Mb=cb?cb.offset:0;return Qd.arr.range(Mb,Mb+(cb?cb.partitionSize:Ma.length-1))}return Qd.arr.sortBy(Object.keys(Ma),function(ba){return ba.toLowerCase()})};
Qd.isMultiValue=Yd;Qd.printValue=Ge;Qd.partitionedChildren=function(Ma,cb){var Mb=void 0===cb?{}:cb;cb=void 0===Mb.originalValue?Ma:Mb.originalValue;var ba=void 0===Mb.offset?0:Mb.offset;Mb=void 0===Mb.partitionSize?Ma.length||Object.values(Ma).length:Mb.partitionSize;if(Qd.obj.isArray(Ma)){Ma=Qd.num.roundTo(Math.max(Qd.MIN_PARTITION_SIZE,Mb/50),.1);Mb/=Ma;for(var La=[],mb=0;mb<Mb;mb++){var zb="["+(ba+mb*Ma)+"-"+(ba+(mb+1)*Ma)+"]";La.push({partition:{originalValue:cb,offset:ba+mb*Ma,partitionSize:Ma},
value:[],key:zb,keyString:zb,valueString:"...",isCollapsed:!0})}return La}Ma=Qd.num.roundTo(Math.max(Qd.MIN_PARTITION_SIZE,Mb/50),.1);Mb/=Ma;La=[];mb=Qd.obj.keys(cb).sort();for(zb=0;zb<Mb;zb++){var Qc=ba+zb*Ma,yc=ba+(zb+1)*Ma,Ed=Qd.obj.select(cb,mb.slice(Qc,yc));Qc="["+mb[Qc].slice(0,4)+"-"+(mb[yc]||Qd.arr.last(mb)).slice(0,4)+"]";La.push({partition:{originalValue:Ed,offset:ba+zb*Ma,partitionSize:Ma},value:[],key:Qc,keyString:Qc,valueString:"...",isCollapsed:!0})}return La};Qd.propertiesOf=function(Ma){var cb=
Ma.partition?Ma.target:Ma.value;if(!cb)return[];var Mb={_rev:!0},ba=[],La="function"===typeof cb.livelyCustomInspect?cb.livelyCustomInspect():{},mb=Object.assign({},Qd.defaultPropertyOptions,{},La);if(La.properties){La=$jscomp.makeIterator(La.properties);for(var zb=La.next();!zb.done;zb=La.next()){var Qc=zb.value;zb=Qc.key;var yc=Qc.hidden,Ed=Qc.priority,Ad=Qc.keyString,Bd=Qc.value;Qc=Qc.valueString;Mb[zb]=!0;yc||ba.push(Ma.getSubNode({priority:Ed,key:zb,keyString:Ad||Qd.safeToString(zb),value:Bd,
valueString:Qc,isCollapsed:!0}))}}if(mb.includeDefault){La=Qd.propertyNamesOf(cb,Ma.partition);if(La.length>Qd.MAX_NODE_THRESHOLD)for(Mb=$jscomp.makeIterator(Qd.partitionedChildren(cb,Ma.partition)),La=Mb.next();!La.done;La=Mb.next())ba.push(Ma.getSubNode(La.value));else for(yc=$jscomp.makeIterator(La),La=yc.next();!La.done;La=yc.next())Ed=La.value,Ed in Mb||(La=cb[Ed],zb=Qd.printValue(La),La={keyString:Ed,key:Ed,value:La,valueString:zb,isCollapsed:!0},ba.push(Ma.getSubNode(La)));if(mb.includeSymbols)for(Mb=
$jscomp.makeIterator(Object.getOwnPropertySymbols(cb)),La=Mb.next();!La.done;La=Mb.next())yc=La.value,Ed=Qd.safeToString(yc),La=cb[yc],zb=Qd.printValue(La),La={key:yc,keyString:Ed,value:La,valueString:zb,isCollapsed:!0},ba.push(Ma.getSubNode(La))}mb.sort&&(ba=mb.sortFunction(cb,ba));return ba};Qd.obj=nd;Qd.num=Hb;Qd.arr=lc;Qd.string=Cd;Qd.connect=$c;Qd.signal=Cc;Qd.TreeData=qc;Qd.newUUID=ld;Qd.localInterface=Ga;Qd.MAX_NODE_THRESHOLD=1E3;Qd.MIN_PARTITION_SIZE=250;Qd.defaultPropertyOptions={includeDefault:!0,
includeSymbols:!0,sort:!0,sortFunction:function(Ma,cb){return Array.isArray(Ma)?cb:cb.sort(Qd.defaultSort)}};Qd.symMatcher=/^Symbol\((.*)\)$/;Qd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ma){return"symbol"===typeof Symbol[Ma]}).reduce(function(Ma,cb){return Ma.set(Symbol[cb],"Symbol."+cb)},new Map)}();Qd.isMultiValue=Yd;Qd.isMultiValue=Yd;Qd.printValue=Ge;Qd.printValue=Ge;var qe=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Mb=cb.hasOwnProperty("InspectionTree")&&"function"===typeof cb.InspectionTree?cb.InspectionTree:cb.InspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Tb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.inspector=ba.inspector;this.root.isInspectionNode||(this.root=Qd.InspectionNode.for(this.root,
this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(ba){ba=void 0===ba?!0:ba;return Tb._get(Object.getPrototypeOf(Mb.prototype),"asListWithIndexAndDepth",this).call(this,function(La){La=La.node;return ba?La.visible:!0})}},{key:"getContextFor",value:function(ba){return ba==this.root?this.root.value.inspectee:ba.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(ba){var La=void 0===ba.maxDepth?1:ba.maxDepth,mb=ba.iterator,
zb=ba.showUnknown,Qc=ba.showInternal,yc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ed){if(1==Ed.nextAddress)return Ed.yield(yc.uncollapseAll(function(Ad,Bd){return La>Bd&&(Ad==yc.root||Ad.value.submorphs)}),2);yc.asListWithIndexAndDepth(!1).forEach(function(Ad){var Bd=Ad.node;return 0==Ad.depth?Bd.visible=!0:!zb&&Bd.keyString&&Bd.keyString.includes("UNKNOWN PROPERTY")||!Qc&&Bd.keyString&&Bd.keyString.includes("internal")?Bd.visible=!1:Bd.value&&Bd.value.submorphs?Bd.visible=
!0:Bd.visible=mb(Bd)});Ed.jumpToEnd()})}},{key:"getChildren",value:function(ba){return ba.children}},{key:"display",value:function(ba){return ba.display(this.inspector)}},{key:"isCollapsed",value:function(ba){return ba.isCollapsed}},{key:"isLeaf",value:function(ba){return Qd.obj.isPrimitive(ba.value)}},{key:"collapse",value:function(ba,La){var mb=this;ba.isCollapsed=La;La||this.isLeaf(ba)||ba.children.length||(ba.children=Qd.propertiesOf(ba).map(function(zb){mb.parentMap.set(zb,ba);return zb}))}},
{key:"retrieveForRemoteProxy",value:function(ba){ba.uuid||(ba.uuid=Qd.newUUID(),this.idToNodeMap[ba.uuid]=ba);return{uuid:ba.uuid,value:this.isLeaf(ba)?ba.value:{},keyString:ba.keyString,key:ba.keyString,valueString:Qd.safeToString(ba.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Qd.localInterface}},{key:"getNodeViaId",value:function(ba){return this.idToNodeMap[ba]}},{key:"asRemoteDelegate",value:function(ba){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||
(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[ba]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:"className",get:function(){return"InspectionTree"}},{key:"forObject",value:function(ba,La){return new this({key:"inspectee",value:{inspectee:ba},isCollapsed:!0,inspector:La})}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5932,end:8631})}(Qd.TreeData);Qd.InspectionTree=qe;Qd.InspectionTree=qe;Qd.InspectionTree=qe;var df=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Mb=cb.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof cb.RemoteInspectionTree?cb.RemoteInspectionTree:cb.RemoteInspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Mb,Ma,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(ba){this.parentMap=new WeakMap;this.root=ba.proxy;this.evalEnvironment=ba.evalEnvironment;this.inspector=ba.inspector;this.delegateId=ba.delegateId}},{key:"getContextFor",value:function(ba){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+ba.uuid+'").value'}},{key:"dispose",value:function(){var ba=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){return La.yield(ba.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+ba.delegateId+"']\n    ",ba.evalEnvironment),0)})}},{key:"display",value:function(ba){return ba.keyString+": "+ba.valueString}},{key:"collapse",value:function(ba,La){var mb=this,zb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qc){if(1==Qc.nextAddress)return(ba.isCollapsed=La)||mb.isLeaf(ba)?
Qc.return():ba.children.length?Qc.jumpTo(0):Qc.yield(mb.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+ba.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+mb.delegateId+'"]'}),3);zb=Qc.yieldResult;ba.children=zb.isError?
[]:zb.value;Qc.jumpToEnd()})}}],[{key:"className",get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(ba,La){var mb=this,zb,Qc,yc,Ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ad){if(1==Ad.nextAddress)return Ad.yield(mb.createRemoteContext(ba,La),2);zb=Ad.yieldResult;Qc=zb.proxy;yc=zb.delegateId;Ed=zb.evalEnvironment;return Ad.return(new mb({key:"inspectee",proxy:Qc,delegateId:yc,evalEnvironment:Ed,inspector:La}))})}},{key:"createRemoteContext",value:function(ba,
La){var mb=ba.code,zb=ba.evalEnvironment,Qc=ba.delegateId,yc,Ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ad){if(1==Ad.nextAddress)return Qc="lively://inspector-"+La.id,Ad.yield(zb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+mb+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Qc+'");\n    ',zb),2);yc=Ad.yieldResult;Ed=yc.value;return Ad.return({delegateId:Qc,
evalEnvironment:zb,proxy:Ed})})}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8640,end:10983})}(Qd.InspectionTree);Qd.RemoteInspectionTree=df;Qd.RemoteInspectionTree=df;Qd.RemoteInspectionTree=df;(function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Mb=cb.hasOwnProperty("InspectionNode")&&"function"===typeof cb.InspectionNode?cb.InspectionNode:cb.InspectionNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){var La=ba.root,mb=ba.priority,zb=ba.key,Qc=ba.keyString,yc=ba.value,Ed=ba.valueString,Ad=ba.isCollapsed,Bd=void 0===ba.children?[]:ba.children,Ke=void 0===ba.isSelected?!1:ba.isSelected,
Jg=void 0===ba.visible?!0:ba.visible;this.partition=ba.partition;this.priority=mb;this.key=zb;this.keyString=String(Qc||zb);this.value=yc;this.valueString=Ed||Qd.printValue(yc);this.isCollapsed=Ad;this.children=Bd;this.isSelected=Ke;this.visible=Jg;this.root=La}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",get:function(){return!0}},{key:"getSubNode",value:function(ba){if(ba.value&&ba.value.isMorph)return new Qd.MorphNode(Object.assign({root:this.root},ba));var La=ba.key,
mb=ba.keyString,zb=this.value,Qc=ba.partition;Qc&&(zb=Qc.originalValue,mb=La);return new Qd.PropertyNode(Object.assign({},ba,{keyString:mb,key:La,target:zb,partition:Qc,root:this.root,spec:{}}))}},{key:"display",value:function(ba){var La=this.keyString,mb=this.valueString;if(!this.interactive)return La+": "+mb;this._propertyWidget||(this._propertyWidget=ba.renderDraggableTreeLabel({value:La+": "+mb}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:"className",
get:function(){return"InspectionNode"}},{key:"for",value:function(ba,La){La=void 0===La?null:La;return ba.value&&ba.value.isMorph?new Qd.MorphNode(Object.assign({root:La},ba)):new Qd.InspectionNode(Object.assign({root:La},ba))}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10985,
end:13522})})(void 0);(function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Mb=cb.hasOwnProperty("MorphNode")&&"function"===typeof cb.MorphNode?cb.MorphNode:cb.MorphNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Tb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,ba);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(ba){var La=this.propertyInfo[ba.key]||{};return ba.value&&ba.value.isMorph?new Qd.MorphNode(Object.assign({},ba,{root:this.root})):new Qd.PropertyNode(Object.assign({},ba,{root:this.root,target:this.target,spec:La}))}}],[{key:"className",get:function(){return"MorphNode"}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13524,end:14670})})(Qd.InspectionNode);(function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Mb=cb.hasOwnProperty("PropertyNode")&&"function"===typeof cb.PropertyNode?cb.PropertyNode:cb.PropertyNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Tb(Mb,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Tb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);var La=ba.spec,mb=ba.target;this.partition=ba.partition;this.target=mb;this.spec=La;this.foldedNodes={}}},{key:"__deserialize__",value:function(ba,La){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(ba){this._interactive=ba}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},
{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(ba){return this.isFoldable?this.getFoldedContext(ba):Tb._get(Object.getPrototypeOf(Mb.prototype),"getSubNode",this).call(this,ba)}},{key:"getFoldedContext",value:function(ba){return this.foldedNodes[ba.key]=new Qd.FoldedNode(Object.assign({},ba,{root:this.root,target:this.target,foldableNode:this,spec:Qd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",
value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(ba,La){(La=void 0===La?!1:La)&&(this.target[this.key]=ba);this.value=this.target[this.key];this.valueString=Qd.printValue(this.value);this.interactive&&(La||this._propertyWidget.highlight());if(this.isFoldable)for(var mb in this.foldedNodes)this.foldedNodes[mb].value=this.value[mb],this.foldedNodes[mb].valueString=Qd.printValue(this.value[mb]),this.foldedNodes[mb]._propertyWidget&&Qd.signal(this.foldedNodes[mb]._propertyWidget,
"update",this.value[mb])}},{key:"display",value:function(ba){var La=this,mb=this._propertyWidget,zb=this.keyString,Qc=this.valueString,yc=this.target,Ed=this.value,Ad=this.spec;if(!(this.interactive||Ad.foldable&&Qd.isMultiValue(Ed,Ad.foldable)))return ba.renderPropertyControl({target:yc,keyString:zb,valueString:Qc,tree:ba.ui.propertyTree,value:Ed,spec:Ad,node:this,fastRender:!0});if(mb)return mb.keyString=zb,mb.valueString=Qc,mb.isSelected=this.isSelected,mb.control&&(mb.control.isSelected=this.isSelected),
mb;mb=this._propertyWidget=ba.renderPropertyControl({target:yc,keyString:zb,valueString:Qc,value:Ed,spec:Ad,node:this,isSelected:this.isSelected,fontColor:ba.ui.propertyTree.fontColor});this.isInternalProperty||Ad.readOnly||(Qd.connect(mb,"propertyValue",this,"refreshProperty",{updater:function(Bd,Ke){return Bd(Ke,!0)}}),Qd.connect(mb,"openWidget",this.root,"onWidgetOpened",{converter:function(Bd){return{widget:Bd,node:La.sourceObj}}}));return mb}}],[{key:"className",get:function(){return"PropertyNode"}}],
cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14672,end:18071})})(Qd.InspectionNode);(function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Mb=cb.hasOwnProperty("FoldedNode")&&"function"===typeof cb.FoldedNode?cb.FoldedNode:cb.FoldedNode=
function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Tb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.foldableNode=ba=ba.foldableNode;this.foldedProp=ba.key+Qd.string.capitalize(this.key)}},{key:"refreshProperty",value:function(ba,La){La=void 0===La?!1:La;var mb={};this.foldableNode.refreshProperty(Object.assign({},
this.target[this.foldableNode.key],(mb[this.key]=ba,mb)),La)}}],[{key:"className",get:function(){return"FoldedNode"}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18073,end:18749})})(Qd.PropertyNode);var Af=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Af.Color=
ub;var rg=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Mb=cb.hasOwnProperty("DarkTheme")&&"function"===typeof cb.DarkTheme?cb.DarkTheme:cb.DarkTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:"background",get:function(){return Af.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Af.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},
{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},
{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Af.Color.rgb(204,109,243)}}},{key:"atom",
get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Af.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Af.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",
get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},
{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Af.Color.white,fontWeight:"bold",backgroundColor:Af.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Af.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",
get:function(){return{backgroundColor:Af.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:"className",get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],cb,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3048})}(void 0),mg=rg=Af.DarkTheme;Af.default=rg;var Yc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Yc.inspect=Sc;Yc.remoteInspect=ye;Yc.generateReferenceExpression=Gd;Yc.onNumberDragStart=function(Ma,cb){cb.initPos=Ma.position;cb.factorLabel=(new Yc.Tooltip({description:"1x"})).openInWorld(Ma.hand.position.addXY(10,10))};Yc.onNumberDrag=
function(Ma,cb){var Mb=Yc.getScaleAndOffset(Ma,cb),ba=Mb.scale;Mb=Mb.offset;cb.factorLabel.position=Ma.hand.position.addXY(10,10);cb.factorLabel.description=ba+"x";return Yc.getCurrentValue(Mb,ba,cb)};Yc.onNumberDragEnd=function(Ma,cb){var Mb=Yc.getScaleAndOffset(Ma,cb);Ma=Mb.offset;Mb=Mb.scale;cb.factorLabel.softRemove();return Yc.getCurrentValue(Ma,Mb,cb)};Yc.getScaleAndOffset=function(Ma,cb){var Mb=Ma.position.subPt(cb.initPos);Ma=Mb.x;cb=Yc.num.roundTo(Math.exp(-Mb.y/$world.height*6),.01)*cb.baseFactor;
return{offset:Ma,scale:cb}};Yc.getCurrentValue=function(Ma,cb,Mb){return Math.max(Mb.min,Math.min(Mb.max,Mb.scrubbedValue+(Mb.floatingPoint?Ma*cb:Math.round(Ma*cb))))};Yc.Color=ub;Yc.Rectangle=mc;Yc.rect=wd;Yc.pt=Zd;Yc.obj=nd;Yc.num=Hb;Yc.Path=Xc;Yc.arr=lc;Yc.promise=gd;Yc.connect=$c;Yc.disconnect=bc;Yc.once=eb;Yc.Morph=ad;Yc.Tooltip=ed;Yc.VerticalLayout=Id;Yc.GridLayout=hc;Yc.HorizontalLayout=Qb;Yc.morph=id;Yc.CustomLayout=xb;Yc.Label=Nb;Yc.Icon=kb;Yc.StyleSheet=kd;Yc.config=Db;Yc.Tree=Rb;Yc.LoadingIndicator=
vc;Yc.DropDownList=jc;Yc.DropDownSelector=qb;Yc.SearchField=rb;Yc.LabeledCheckBox=cc;Yc.MorphHighlighter=xc;Yc.InteractiveMorphSelector=kc;Yc.printValue=Ge;Yc.RemoteInspectionTree=df;Yc.InspectionTree=qe;Yc.isMultiValue=Yd;Yc.valueWidgets=Q;Yc.popovers=ea;Yc.DarkTheme=mg;Yc.DefaultTheme=Kb;Yc.syncEval=Vc;Yc.inspectorCommands=[{name:"focus codeEditor",exec:function(Ma){Ma.get("codeEditor").show();Ma.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ma){Ma.get("propertyTree").show();
Ma.get("propertyTree").focus();return!0}}];(function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Mb=cb.hasOwnProperty("DraggedProp")&&"function"===typeof cb.DraggedProp?cb.DraggedProp:cb.DraggedProp=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:"applyToTarget",value:function(ba){var La=this.currentTarget,mb=this.control;this.remove();Yc.MorphHighlighter.removeHighlighters(ba.world);
if(La)if(La.isText&&"js"===La.editorModeName){var zb=La.evalEnvironment.context;ba=La.textPositionFromPoint(La.localize(ba.position));zb=Yc.generateReferenceExpression(this.sourceObject,{fromMorph:zb});mb.keyString&&(zb+="."+mb.keyString);La.insertTextAndSelect(zb,ba);La.focus()}else"propertyValue"in mb&&(La[mb.keyString]=mb.propertyValue)}},{key:"update",value:function(ba){ba=ba.hand.globalPosition;var La=this.morphBeneath(ba),mb;if(La){for(La==this.morphHighlighter&&(La=La.morphBeneath(ba));mb=
[La].concat($jscomp.arrayFromIterable(La.ownerChain())).find(function(zb){return!zb.visible});)La=mb=mb.morphBeneath(ba);if(La!=this.currentTarget){this.currentTarget=La;this.morphHighlighter&&this.morphHighlighter.deactivate();if(La.isWorld)return;this.morphHighlighter=Yc.MorphHighlighter.for($world,La);this.morphHighlighter.show()}this.position=ba}}}],[{key:"className",get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Yc.Color.rgb(169,
204,227)},fill:{defaultValue:Yc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var ba=this.control;if(!ba)return this.submorphs=[];this.height=22;this.submorphs=[ba];ba.top=0;ba.fontSize=14;"function"===typeof ba.relayout&&ba.relayout();this.width=ba.width+20;this.adjustOrigin(Yc.pt(10,10))}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1268,end:3690})})(Yc.Morph);(function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Mb=cb.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof cb.DraggableTreeLabel?cb.DraggableTreeLabel:cb.DraggableTreeLabel=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Mb,Ma,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(ba){this.draggedProp=new Yc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Yc.connect(ba.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(ba){}},{key:"onDragEnd",value:function(ba){Yc.disconnect(ba.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(ba)}}],[{key:"className",get:function(){return"DraggableTreeLabel"}},
{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Yc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:Yc.Color.transparent},padding:{defaultValue:Yc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(ba){this.setProperty("isSelected",ba);ba?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),
this.removeStyleClass("selected"));this.control&&(this.control.isSelected=ba)}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3692,end:5015})})(Yc.Label);qe=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Mb=cb.hasOwnProperty("PropertyControl")&&
"function"===typeof cb.PropertyControl?cb.PropertyControl:cb.PropertyControl=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(ba,La,mb){ba.control=new Yc.DropDownSelector({opacity:.8,fill:Yc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:La,padding:0,values:mb});
Yc.connect(ba.control,"update",ba,"propertyValue",{updater:function(zb,Qc){this.targetObj.propertyValue!=Qc&&zb(Qc)}});Yc.connect(ba,"update",ba.control,"selectedValue",{updater:function(zb,Qc){Qc=Qc&&Qc.valueOf?Qc.valueOf():Qc;this.targetObj.propertyValue!=Qc&&zb(Qc)}});return ba}},{key:"toggleMultiValuePlaceholder",value:function(ba){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:Yc.Color.transparent,layout:new Yc.HorizontalLayout({spacing:3}),name:"multi value placeholder",
nativeCursor:"pointer",submorphs:Yc.arr.range(0,2).map(function(La){return{type:"ellipse",fill:Yc.Color.gray.withA(.5),reactsToPointer:!1,extent:Yc.pt(7,7)}})});ba?(Yc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(Yc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=
!1)}},{key:"toggleFoldableValue",value:function(ba){this.foldableProperties&&this.toggleMultiValuePlaceholder(Yc.isMultiValue(ba,this.foldableProperties))}},{key:"asFoldable",value:function(ba){this.foldableProperties=ba;Yc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&
(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var ba=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});ba.isLayoutable=!1;ba.fontWeight="bold";ba.fontColor=Yc.Color.orange;ba.reactsToPointer=!1;ba.fadeOut(2E3)}}],[{key:"className",get:function(){return"PropertyControl"}},{key:"properties",
get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(ba){this.submorphs=[ba]}},layout:{initialize:function(){this.layout=new Yc.CustomLayout({relayout:function(ba){ba.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(ba){return(ba=ba.value)&&(ba.isColor||ba.isGradient)?"Color":ba&&ba.isPoint?"Point":
Yc.obj.isBoolean(ba)?"Boolean":Yc.obj.isNumber(ba)?"Number":Yc.obj.isString(ba)?"String":ba&&ba.isRectangle?"Rectangle":!1}},{key:"render",value:function(ba){ba.spec.type||(ba.spec=Object.assign({},ba.spec,{type:this.inferType(ba)}));switch(ba.spec.type){case "Color":var La=this.renderColorControl(ba);break;case "ColorGradient":La=this.renderColorControl(Object.assign({},ba,{gradientEnabled:!0}));break;case "Number":La=this.renderNumberControl(ba);break;case "String":La=this.renderStringControl(ba);
break;case "RichText":La=this.renderStringControl(ba);break;case "Layout":La=this.renderLayoutControl(ba);break;case "Enum":La=this.renderEnumControl(ba);break;case "Shadow":La=this.renderShadowControl(ba);break;case "Point":La=this.renderPointControl(ba);break;case "Rectangle":La=this.renderRectangleControl(ba);break;case "Boolean":La=this.renderBooleanControl(ba);break;default:La=this.renderItSomehow(ba)}La.control&&(Yc.connect(La.control,"openWidget",La,"openWidget"),La.toggleFoldableValue(ba.value));
return La}},{key:"baseControl",value:function(ba){var La=ba.spec;ba=new this({keyString:ba.keyString,valueString:ba.valueString,isSelected:!1,propertyValue:ba.value});La.foldable&&ba.asFoldable(La.foldable);return ba}},{key:"renderGrabbableKey",value:function(ba){var La=this,mb=ba.target;return[ba.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(zb){zb.state.draggedProp=new Yc.DraggedProp({sourceObject:mb,control:La.baseControl(ba)});zb.state.draggedProp.openInWorld();Yc.connect(zb.hand,
"update",zb.state.draggedProp,"update")},onDrag:function(zb){},onDragEnd:function(zb){Yc.disconnect(zb.hand,"update",zb.state.draggedProp,"update");zb.state.draggedProp.applyToTarget(zb)}}]}},{key:"renderEnumControl",value:function(ba){var La=ba.value,mb=ba.spec.values,zb=ba.keyString,Qc=ba.target,yc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(La?La.valueOf?La.valueOf():La:"Not set"),{nativeCursor:"pointer",onMouseDown:function(Ed,Ad){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bd){Qc.world().openWorldMenu(Ed,
mb.map(function(Ke){return{string:Ke.toString(),action:function(){Qc[zb]=Ke;yc.rerender()}}}));Bd.jumpToEnd()})}}],$jscomp.arrayFromIterable(Yc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7})))}},{key:"renderStringControl",value:function(ba){var La=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(200<La.length?La.slice(0,20)+"...":La),{fontColor:Yc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(ba){var La=
ba.value,mb=ba.keyString,zb=ba.valueString,Qc=ba.target,yc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+zb,{fontColor:Yc.Color.black,nativeCursor:"pointer",onMouseDown:function(Ed){var Ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bd){if(1==Bd.nextAddress)return Ad=new Yc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:La}),Ad.relayout(),Bd.yield(Ad.fadeIntoWorld(Ed.positionIn(Qc.world())),2);Yc.connect(Ad,"rectangle",function(Ke){Qc[mb]=
Ke;yc.rerender()});Bd.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(ba){var La=ba.value,mb=ba.keyString,zb=ba.valueString,Qc=ba.target,yc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+zb,{nativeCursor:"pointer",fontColor:La?Yc.Color.green:Yc.Color.red,onMouseDown:function(Ed){Qc[mb]=!Qc[mb];yc.rerender()}}])}},{key:"renderNumberControl",value:function(ba){var La=ba.value,mb=ba.spec,zb=ba.keyString,Qc=ba.valueString,yc=ba.node,Ed=ba.target,Ad=
ba.tree,Bd=void 0===yc._numberControls?new Bf:yc._numberControls,Ke=$jscomp.makeIterator(Bd.submorphs),Jg=Ke.next().value,wg=Ke.next().value;Bd.fontColor=Ad.fontColor;var Qh=yc._numberControls=Bd;"max"in mb&&"min"in mb&&-Infinity!=mb.min&&Infinity!=mb.max?(Qh.baseFactor=(mb.max-mb.min)/100,Qh.floatingPoint=mb.isFloat,Qh.max=mb.max,Qh.min=mb.min):(Qh.floatingPoint=mb.isFloat,Qh.baseFactor=.5,Qh.min=void 0!=mb.min?mb.min:-Infinity,Qh.max=void 0!=mb.max?mb.max:Infinity);var Uf=Yc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;
return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),$jscomp.arrayFromIterable(yc._inputMorph?[yc._inputMorph,{}]:[" "+(void 0!=La&&(La.valueOf?La.valueOf():La).toFixed(mb.isFloat?3:0))+" ",{fontColor:Uf,onMouseUp:function(Hh){yc._inputMorph=Yc.morph({type:"input",fill:null,fontColor:Uf,fontFamily:"IBM Plex Mono",fontSize:14,padding:Yc.rect(8,2,-6,2),height:23,cursorColor:Yc.Color.white,value:La.valueOf?La.valueOf():Qc});Ed[zb]=La;yc._inputMorph.focus();Yc.once(yc._inputMorph,"inputAccepted",
function(ek){delete yc._inputMorph;Ed[zb]=mb.isFloat?Number.parseFloat(ek):Number.parseInt(ek);yc.rerender()});Yc.once(yc._inputMorph,"onBlur",function(ek){yc._inputMorph&&(delete yc._inputMorph,Ed[zb]=La,yc.rerender())});yc.rerender()},onDragStart:function(Hh){Qh.scrubbedValue=La;Yc.onNumberDragStart(Hh,Qh)},onDrag:function(Hh){Ed[zb]=Yc.onNumberDrag(Hh,Qh);yc.rerender()},onDragEnd:function(Hh){return Yc.onNumberDragEnd(Hh,Qh)}},Bd,{onMouseUp:function(){Jg.fill=wg.fill=null},onMouseDown:function(Hh){if(Hh.targetMorph===
Jg){Jg.fill=Yc.Color.white.withA(.2);if("max"in mb&&Ed[zb]>=mb.max)return;Ed[zb]+=1}if(Hh.targetMorph===wg){wg.fill=Yc.Color.white.withA(.2);if("min"in mb&&Ed[zb]<=mb.min)return;--Ed[zb]}yc.rerender()}}]))}},{key:"renderShadowControl",value:function(ba){var La=ba.keyString,mb=ba.value,zb=ba.target,Qc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[""+(mb?mb.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(yc){var Ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ad){if(1==
Ad.nextAddress)return Ed=new Yc.popovers.ShadowPopover({shadowValue:zb[La],hasFixedPosition:!0}),Ad.yield(Ed.fadeIntoWorld(yc.positionIn(zb.world())),2);Yc.connect(Ed,"shadowValue",function(Bd){zb[La]=Bd;Qc.rerender()});Ad.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(ba){var La=ba.keyString,mb=ba.value,zb=ba.target,Qc=ba.node,yc=Yc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Ed={nativeCursor:"pointer",onMouseDown:function(Ad){var Bd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ke){if(1==
Ke.nextAddress)return Bd=new Yc.popovers.PointPopover({pointValue:zb[La],hasFixedPosition:!0}),Ke.yield(Bd.fadeIntoWorld(Ad.positionIn(zb.world())),2);Yc.connect(Bd,"pointValue",function(Jg){zb[La]=Jg;Qc.rerender()});Ke.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" pt(",Object.assign({},Ed),""+mb.x.toFixed(),Object.assign({fontColor:yc},Ed),",",Object.assign({},Ed),""+mb.y.toFixed(),Object.assign({fontColor:yc},Ed),")",Object.assign({},Ed)])}},{key:"renderLayoutControl",
value:function(ba){var La=ba.valueString,mb=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(mb?La:"No Layout"),{onMouseDown:function(zb){}}])}},{key:"renderColorControl",value:function(ba){var La=ba.node,mb=ba.gradientEnabled,zb=ba.valueString,Qc=ba.keyString,yc=ba.value,Ed=ba.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[Yc.morph({fill:yc.valueOf?yc.valueOf():yc,extent:Yc.pt(15,15),borderColor:Yc.Color.gray,borderWidth:1}),{paddingLeft:"5px",
paddingTop:"4px",paddingRight:"5px"},""+(yc?yc.valueOf?yc.valueOf():zb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Ad){var Bd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ke){if(1==Ke.nextAddress)return Bd=new Yc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Ed,fillValue:yc,title:"Fill Control",gradientEnabled:mb}),Ke.yield(Bd.fadeIntoWorld(Ad.positionIn(Ed.world())),2);Yc.connect(Bd,"fillValue",function(Jg){Ed[Qc]=Jg;La.rerender()});Ke.jumpToEnd()})}}])}},{key:"renderItSomehow",
value:function(ba){var La=ba.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+La,{}])}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5024,end:20444})}(Yc.DraggableTreeLabel);Yc.PropertyControl=qe;Yc.PropertyControl=qe;Yc.PropertyControl=qe;
Yc.inspect=Sc;Yc.inspect=Sc;Yc.remoteInspect=ye;Yc.remoteInspect=ye;Yc.generateReferenceExpression=Gd;Yc.generateReferenceExpression=Gd;var Bf=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Mb=cb.hasOwnProperty("NumberControls")&&"function"===typeof cb.NumberControls?cb.NumberControls:cb.NumberControls=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,void 0,[{key:"className",
get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Yc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Yc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(ba){this.submorphs.map(function(La){return La.fontColor=ba})}},submorphs:{initialize:function(){this.submorphs=[Yc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Yc.rect(5,2,0,-6),fontSize:12}),
Yc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Yc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23095,end:24127})}(Yc.Morph);(function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),
Mb=cb.hasOwnProperty("PropertyTree")&&"function"===typeof cb.PropertyTree?cb.PropertyTree:cb.PropertyTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:"onDrag",value:function(ba){this._onDragHandler&&this._onDragHandler(ba)}}],[{key:"className",get:function(){return"PropertyTree"}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25279,end:25389})})(Yc.Tree);qe=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Mb=cb.hasOwnProperty("Inspector")&&"function"===typeof cb.Inspector?cb.Inspector:cb.Inspector=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:"onWindowClose",
value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(ba){}},{key:"__after_deserialize__",value:function(){var ba=this,La=new Yc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Yc.InspectionTree.forObject(null,this)}));this.addMorph(La,this.getSubmorphNamed("terminal toggler"));this.layout.col(0).row(1).group.morph=La;this.whenRendered().then(function(){ba.targetObject&&(ba.targetObject=
ba.targetObject)});Tb._get(Object.getPrototypeOf(Mb.prototype),"__after_deserialize__",this).call(this)}},{key:"__additionally_serialize__",value:function(ba,La,mb,zb){ba=ba.props.submorphs.value;for(La=ba.length;La--;)mb.refForId(ba[La].id).realObj==this.ui.propertyTree&&Yc.arr.removeAt(ba,La)}},{key:"renderDraggableTreeLabel",value:function(ba){return new Yc.DraggableTreeLabel(ba)}},{key:"renderPropertyControl",value:function(ba){return Yc.PropertyControl.render(ba)}},{key:"onLoad",value:function(){var ba=
this.ui,La=ba.codeEditor,mb=ba.thisBindingSelector,zb=ba.propertyTree;La.changeEditorMode("js").then(function(){return La.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==mb.selection?La.owner.selectedContext:La.owner.targetObject},get systemInterface(){return Yc.Path("treeData.systemInterface").get(zb)},format:"esm"}}).catch(function(Qc){return $world.logError(Qc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(ba){Tb._get(Object.getPrototypeOf(Mb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this,ba);ba=this.ui;var La=ba.targetPicker,mb=ba.propertyTree,zb=ba.resizer,Qc=ba.terminalToggler,yc=ba.unknowns,Ed=ba.internals,Ad=ba.searchField,Bd=ba.codeEditor,Ke=ba.fixImportButton,Jg=ba.thisBindingSelector;Bd.changeEditorMode("js").then(function(){return Bd.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Jg.selection?Bd.owner.selectedContext:Bd.owner.targetObject},get systemInterface(){return mb.treeData.systemInterface},
format:"esm"}}).catch(function(wg){return $world.logError(wg)});Yc.connect(La,"onMouseDown",this,"selectTarget");Yc.connect(mb,"onScroll",this,"repositionOpenWidget");Yc.connect(zb,"onDrag",this,"adjustProportions");Yc.connect(Qc,"onMouseDown",this,"toggleCodeEditor");Yc.connect(yc,"trigger",this,"filterProperties");Yc.connect(Ed,"trigger",this,"filterProperties");Yc.connect(Ad,"searchInput",this,"filterProperties");Yc.connect(mb,"nodeCollapseChanged",this,"filterProperties");Yc.connect(this,"extent",
this,"relayout");Yc.connect(Jg,"selection",this,"bindCodeEditorThis");Yc.connect(Ke,"fire",Bd,"execCommand",{updater:function(wg){return wg("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var ba=this.ui.propertyTree.selectedIndex-1,La=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();La=this.ui.propertyTree.document.getLine(ba).textAndAttributes.slice(0,4).concat(La.display(this));ba=this.ui.propertyTree.lineRange(ba,
!1);this.ui.propertyTree.replace(ba,La,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var ba=Yc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(ba!=this.lastChange||
this.lastSubmorphs!=Yc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==ba.prop&&this.repositionOpenWidget(),this.lastChange=ba,this.lastSubmorphs=Yc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}}},{key:"refreshTreeView",value:function(){var ba;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(La){La=La.node;La.target&&(ba=La.foldableNode?La.target[La.foldableNode.key][La.key]:
La.target[La.key],!Yc.obj.equals(ba,La.value)&&La.refreshProperty&&La.refreshProperty(ba))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(ba,La){La=void 0===La?!1:La;var mb=this,zb,Qc,yc,Ed,Ad,Bd,Ke,Jg,wg,Qh,Uf,Hh,ek,Zh,ml;return $jscomp.asyncExecutePromiseGeneratorProgram(function(If){switch(If.nextAddress){case 1:if(!mb.isUpdating()){If.jumpTo(2);break}return If.yield(mb.whenUpdated(),2);case 2:zb=Yc.promise.deferred();
Qc=zb.promise;yc=!!mb.target;mb.updateInProgress=Qc;If.setCatchFinallyBlocks(4);La&&(Ed=Yc.LoadingIndicator.open("connecting to remote..."));if(!La){Ad=Yc.InspectionTree.forObject(ba,mb);If.jumpTo(6);break}return If.yield(Yc.RemoteInspectionTree.forObject(ba,mb),7);case 7:Ad=If.yieldResult;case 6:return Bd=Ad,Ke=mb.ui.propertyTree,If.yield(Bd.collapse(Bd.root,!1),8);case 8:if(!Bd.root.children){If.jumpTo(9);break}return If.yield(Bd.collapse(Bd.root.children[0],!1),9);case 9:if(Jg=mb.originalTreeData&&
mb.originalTreeData.diff(Bd)){wg=$jscomp.makeIterator(Jg);for(Qh=wg.next();!Qh.done;Qh=wg.next())Uf=Qh.value,Hh=$jscomp.makeIterator(Uf),ek=Hh.next().value,Zh=Hh.next().value,ek.refreshProperty(Zh.value);If.jumpTo(11);break}Ke.treeData=Bd;return If.yield(mb.filterProperties(),12);case 12:if(!Ke.treeData.root.isCollapsed){If.jumpTo(13);break}return If.yield(Ke.onNodeCollapseChanged({node:Bd.root,isCollapsed:!1}),14);case 14:Ke.selectedIndex=1;case 13:return If.yield(Ke.execCommand("uncollapse selected node"),
11);case 11:mb.toggleWindowStyle(yc);Ed&&Ed.remove();If.leaveTryBlock(5);break;case 4:ml=If.enterCatchBlock(),mb.showError(ml);case 5:mb.startStepping(1E3,"refreshAllProperties"),mb.updateInProgress=null,If.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(ba){ba=void 0===ba?!0:ba;var La=this,mb,zb,Qc,yc,Ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ad){if(1==Ad.nextAddress)return mb=300,yc=La.ui.codeEditor.pluginFind(function(Bd){return Bd.runEval}),Ed=La.getWindow(),Ad.yield(yc.runEval("System.get('@system-env').node"),
2);Ad.yieldResult.value?(Qc=[].concat($jscomp.arrayFromIterable(Yc.arr.without(Ed.styleClasses,"local")),["node"]),zb=Yc.DarkTheme.instance):(Qc=["local"].concat($jscomp.arrayFromIterable(Ed?Yc.arr.without(Ed.styleClasses,"node"):[])),zb=Yc.DefaultTheme.instance);yc.theme=zb;ba?(Ed&&Ed.animate({duration:mb,styleClasses:Qc}),La.ui.codeEditor.animate({fill:zb.background,duration:mb})):Ed&&(Ed.styleClasses=Qc);La.ui.codeEditor.textString=La.ui.codeEditor.textString;yc.highlight();Ad.jumpToEnd()})}},
{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var ba=this,La=Object.assign({type:"text",borderWidth:1,borderColor:Yc.Color.gray,lineWrapping:"by-chars"},Yc.config.codeEditor.defaultStyle,{textString:""}),mb=Yc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Yc.rect(0,0,this.width,30);
var zb=new Yc.SearchField({styleClasses:["idle"],name:"searchField"});mb[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[zb,{type:"button",name:"targetPicker",padding:Yc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Yc.Icon.textAttribute("crosshairs")},new Yc.LabeledCheckBox({label:"Internals",name:"internals"}),new Yc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Yc.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:Yc.InspectionTree.forObject(null,this)})),Yc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},La),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Yc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(mb),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(mb),
[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){ba.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var ba=this,La,mb,zb,Qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){switch(yc.nextAddress){case 1:if(ba.env.eventDispatcher.isKeyPressed("Shift"))return mb=$jscomp,zb=mb.makeIterator,yc.yield($world.execCommand("select morph",
{justReturn:!0}),5);ba.toggleSelectionInstructions(!0);return yc.yield(Yc.InteractiveMorphSelector.selectMorph(),4);case 4:La=yc.yieldResult;ba.toggleSelectionInstructions(!1);yc.jumpTo(3);break;case 5:Qc=zb.call(mb,yc.yieldResult),La=Qc.next().value;case 3:La&&(ba.targetObject=La),yc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(ba){if(ba&&!this.instructionWidget){var La=Yc.morph({type:"label",name:"escapeKey",value:"esc"});La.whenRendered().then(function(){return La.fit()});
this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},La,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",
value:function(ba){ba=ba.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;ba.epiMorph=!0;this.openWidget=ba;Yc.once(ba,"close",this,"closeOpenWidget");Yc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var ba=this.ui.propertyTree,La=ba.textLayout.boundsFor(ba,{column:0,row:ba.selectedIndex-1});La=ba.worldPoint(Yc.pt(La.x,La.y+La.height/2)).addPt(ba.scroll.negated());ba=ba.globalBounds();
La.x=this.globalBounds().center().x;La.y<ba.top()?La=ba.topCenter():ba.bottom()-20<La.y&&(La=ba.bottomCenter().addXY(0,-20));return La}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(ba){this.layout.row(1).height+=ba.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(ba){if(ba!==
this.isEditorVisible()){var La=this.extent,mb=this.layout,zb=this.ui,Qc=zb.terminalToggler,yc=zb.codeEditor,Ed=zb.thisBindingSelector;zb=zb.fixImportButton;mb.disable();ba?(Qc.fontColor=Yc.Color.rgbHex("00e0ff"),mb.row(3).height=this.codeEditorHeight||180,mb.row(2).height=5,zb.animate({visible:!0,duration:200}),Ed.animate({visible:!0,duration:200})):(this.codeEditorHeight=mb.row(3).height,Qc.fontColor=Yc.Color.white,mb.row(3).height=mb.row(2).height=0,zb.animate({visible:!1,duration:200}),Ed.animate({visible:!1,
duration:200}));this.extent=La;mb.enable({duration:200});this.relayout({duration:200});yc.focus();yc.animate({opacity:ba?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){ba.makeEditorVisible(!ba.isEditorVisible());La.jumpToEnd()})}},{key:"filterProperties",value:function(){var ba=this,La,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return La=ba.ui.searchField,mb=ba.ui.propertyTree,
ba.originalTreeData||(ba.originalTreeData=mb.treeData),Yc.disconnect(mb.treeData,"onWidgetOpened",ba,"onWidgetOpened"),zb.yield(mb.treeData.filter({maxDepth:2,showUnknown:ba.ui.unknowns.checked,showInternal:ba.ui.internals.checked,iterator:function(Qc){return La.matches(Qc.key)}}),2);mb.update();Yc.connect(mb.treeData,"onWidgetOpened",ba,"onWidgetOpened");zb.jumpToEnd()})}},{key:"relayout",value:function(ba){ba=void 0===ba?{}:ba;var La=this,mb,zb,Qc,yc,Ed,Ad,Bd,Ke,Jg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wg){La.layout&&
La.layout.forceLayout();mb=La;zb=mb.ui;Qc=zb.fixImportButton;yc=zb.terminalToggler;Ed=zb.propertyTree;Ad=zb.thisBindingSelector;Bd=Ed.bounds().insetBy(5).bottomLeft();Ke=Ed.bounds().insetBy(5).bottomRight();Jg=Ke.subXY(Qc.width+10,0);Ad.width=115;Ad.listMorph.itemHeight=20;ba.duration?(yc.animate(Object.assign({bottomLeft:Bd},ba)),Qc.animate(Object.assign({bottomRight:Ke},ba)),Ad.animate(Object.assign({bottomRight:Jg},ba))):(yc.bottomLeft=Bd,Qc.bottomRight=Ke,Ad.bottomRight=Jg);wg.jumpToEnd()})}},
{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Tb._get(Object.getPrototypeOf(Mb.prototype),"keybindings",this))}},{key:"commands",get:function(){return Yc.inspectorCommands}}],[{key:"className",get:function(){return"Inspector"}},{key:"openInWindow",value:function(ba){ba=new this(ba);ba.openInWindow().activate();return ba}},{key:"properties",
get:function(){return{extent:{defaultValue:Yc.pt(400,500)},fill:{defaultValue:Yc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(ba){this.setProperty("remoteTarget",ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ba,!0))}},targetObject:{after:["submorphs"],set:function(ba){this._serializableTarget=ba&&ba.isMorph?ba.id:ba;this.setProperty("targetObject",ba);this.ui.propertyTree&&
(this.originalTreeData=null,this.prepareForNewTargetObject(ba))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var ba=this.ui.propertyTree,La=ba.selectedNode;ba=ba.treeData;return ba.getContextFor(La?La:ba.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),
thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Yc.Color.gray,
fontSize:14,fontFamily:Yc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25406,end:45502})}(Yc.Morph);qe=Yc.Inspector;df=Ca("I",qe);Yc.default=
qe;var dg=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");dg.Inspector=df;dg.string=Cd;dg.Morph=ad;dg.pt=Zd;dg.Color=ub;qe=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ma,cb,Mb){Mb=void 0===Mb?1:Mb;var ba,La,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:return Ma.maybeSelectCommentOrLine(),zb.setCatchFinallyBlocks(2),cb=Object.assign({},cb,{logDoit:!0,inspect:!0,
inspectDepth:Mb}),zb.yield(Ma.doEval(void 0,cb),4);case 4:ba=zb.yieldResult;La=ba.error?ba.error:ba.isError?ba.value:null;zb.leaveTryBlock(3);break;case 2:La=mb=zb.enterCatchBlock();case 3:return La?Ma.showError(La):Ma.setStatusMessage(dg.string.truncate(ba.value,1E3)),zb.return(ba)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ma,cb){var Mb,ba,La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){switch(mb.nextAddress){case 1:return mb.setCatchFinallyBlocks(2),
mb.yield(Ma.doEval({start:{row:0,column:0},end:Ma.documentEndPosition},Object.assign({},cb,{logDoit:!0})),4);case 4:Mb=mb.yieldResult;ba=Mb.error?Mb.error:Mb.isError?Mb.value:null;mb.leaveTryBlock(3);break;case 2:ba=La=mb.enterCatchBlock();case 3:return ba?Ma.showError(ba):Ma.setStatusMessage(String(Mb.value)),mb.return(Mb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ma,cb){var Mb,ba,La,mb,zb,Qc,yc,Ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ad){switch(Ad.nextAddress){case 1:return Ma.maybeSelectCommentOrLine(),
Ad.setCatchFinallyBlocks(2),cb=Object.assign({},cb,{asString:!1,logDoit:!0}),Ad.yield(Ma.doEval(void 0,cb),4);case 4:Mb=Ad.yieldResult;ba=Mb.error?Mb.error:Mb.isError?Mb.value:null;Ad.leaveTryBlock(3);break;case 2:ba=La=Ad.enterCatchBlock();case 3:Ma.selection.collapseToEnd();if(mb=Mb.value&&Mb.value.isColor)return Ma.selection.text=String(Mb.value),zb=new dg.Morph({fill:dg.Color.transparent,extent:dg.pt(Ma.fontSize+2,Ma.fontSize+2),submorphs:[{fill:Mb.value,center:dg.pt(Ma.fontSize+2,Ma.fontSize+
2).scaleBy(.5)}]}),Qc=Ma.selection.start,yc=Qc.column,Ed=Qc.row,Ma.insertText([zb,{}],Ma.selection.start),Ma.selection.start={column:yc,row:Ed},Ad.return(Mb);Ma.insertTextAndSelect(ba?String(ba)+(ba.stack?"\n"+ba.stack:""):String(Mb.value));return Ad.return(Mb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ma,cb){var Mb,ba,La,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:debugger;
Ma.maybeSelectCommentOrLine();ba=Ma.textInRange(Ma.selection);La=Ma.evalEnvironment||{};mb=Ma.pluginFind(function(Qc){return Qc.isEditorPlugin&&"function"===typeof Qc.runEval});La.systemInterface||(La.systemInterface=mb.systemInterface(cb));if("local"!==La.systemInterface.name){zb.jumpTo(2);break}zb.setCatchFinallyBlocks(3);return zb.yield(Ma.doEval(void 0,cb),5);case 5:Mb=zb.yieldResult;ba=Mb.value;zb.leaveTryBlock(2);break;case 3:zb.enterCatchBlock();case 2:return Ma.world().execCommand("open object editor",
{target:ba,evalEnvironment:La}),zb.return(Mb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Ma,cb){var Mb,ba,La,mb,zb,Qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){switch(yc.nextAddress){case 1:Ma.maybeSelectCommentOrLine();La=Ma.textInRange(Ma.selection);mb=Ma.evalEnvironment||{};zb=Ma.pluginFind(function(Ed){return Ed.isEditorPlugin&&"function"===typeof Ed.runEval});mb.systemInterface||(mb.systemInterface=
zb.systemInterface(cb));if("local"!==mb.systemInterface.name){dg.Inspector.openInWindow({remoteTarget:{code:La,evalEnvironment:mb}});yc.jumpTo(2);break}yc.setCatchFinallyBlocks(3);return yc.yield(Ma.doEval(void 0,cb),5);case 5:Mb=yc.yieldResult;ba=Mb.error?Mb.error:Mb.isError?Mb.value:null;La=Mb.value;yc.leaveTryBlock(4);break;case 3:ba=Qc=yc.enterCatchBlock();case 4:dg.Inspector.openInWindow({targetObject:ba?ba:La});case 2:return yc.return(Mb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(Ma,cb,Mb){Mb=void 0===Mb?1:Mb;var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){switch(La.nextAddress){case 1:return Ma.maybeSelectCommentOrLine(),La.setCatchFinallyBlocks(2),cb=Object.assign({},cb,{inspect:!0,inspectDepth:Mb,logDoit:!0}),La.yield(Ma.doEval(void 0,cb),4);case 4:ba=La.yieldResult;La.leaveTryBlock(3);break;case 2:La.enterCatchBlock();case 3:return Ma.selection.collapseToEnd(),Ma.insertTextAndSelect(ba.value),La.return(ba)}})}}];dg.codeEvaluationCommands=
qe;dg.codeEvaluationCommands=qe;dg.codeEvaluationCommands=qe;var Gg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Gg.changeAttributeInSelectionOrMorph=function(Ma,cb,Mb){var ba=Ma.selection;Ma.keepPosAtSameScrollOffsetWhile(function(){ba.isEmpty()?Ma[cb]="function"===typeof Mb?Mb(Ma[cb]):Mb:(Ma.undoManager.group(),Ma.changeStyleProperty(cb,function(La){return"function"===typeof Mb?Mb(La):Mb}),Ma.undoManager.group())})};df=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(Ma){var cb=Ma.fontSize;Gg.changeAttributeInSelectionOrMorph(Ma,"fontSize",function(Mb){Mb=Mb||cb;return Mb+(18<=Mb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ma){var cb=Ma.fontSize;Gg.changeAttributeInSelectionOrMorph(Ma,"fontSize",function(Mb){Mb=Mb||cb;return Mb-(18>=Mb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ma){var cb,Mb,ba,La,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress){cb=
["serif","sans-serif","monospace"];if(Mb=localStorage["lively.morpic/text-change-font-additional-fonts"])Mb=JSON.parse(Mb),cb.push.apply(cb,$jscomp.arrayFromIterable(Mb));cb.map(function(Qc){return Qc.toLowerCase()}).includes(Ma.fontFamily.toLowerCase())||(cb.push(Ma.fontFamily),Mb=[].concat($jscomp.arrayFromIterable(Mb||[]),[Ma.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Mb));return zb.yield($world.editListPrompt("choose font",cb,{requester:Ma,preselect:cb.indexOf(Ma.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}ba=zb.yieldResult;La=$jscomp.makeIterator(ba.selections);if(mb=La.next().value)Ma.fontFamily=mb;return zb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ma,cb){cb=void 0===cb?{}:cb;var Mb,ba,La,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress){if(cb.hasOwnProperty("link"))return zb.jumpTo(2);ba=Ma.selection;La=Ma.getStyleInRange(ba);mb=La.link;return zb.yield(Ma.world().prompt("Set link",
{input:mb||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=zb.nextAddress&&(Mb=zb.yieldResult,!Mb))return zb.return();Ma.undoManager.group();Ma.setStyleInRange({link:Mb||void 0},ba);Ma.undoManager.group();zb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ma,cb){var Mb,ba,La,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return Mb=Ma.selection,ba=Ma.getStyleInRange(Mb),La=ba.doit,zb.yield(Ma.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:Ma,input:La?La.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ma.evalEnvForDoit(La||{})}),2);mb=zb.yieldResult;Ma.undoManager.group();mb?Ma.addTextAttribute({doit:{code:mb},nativeCursor:"pointer",textDecoration:"underline"},Mb):Ma.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Mb);Ma.undoManager.group();zb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ma,cb){cb=void 0===cb?{}:cb;Ma.undoManager.group();
cb=!cb.onlySelection&&Ma.selection.isEmpty()?Ma.documentRange:Ma.selection.range;Ma.setStyleInRange(null,cb);Ma.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ma){var cb,Mb,ba,La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){if(1==mb.nextAddress)return mb.yield(System.import("lively.modules"),2);if(3!=mb.nextAddress)return cb=mb.yieldResult,Mb=cb.module,mb.yield(Mb("lively.ide/text/ui.js").load(),3);ba=mb.yieldResult;La=ba.RichTextControl;return mb.return(La.openFor(Ma))})}}];
Gg.commands=df;Gg.commands=df;Gg.commands=df;var pf=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");pf.guessTextModeName=Sb;pf.rangedToken=function(Ma,cb,Mb,ba,La){return{start:{row:Ma,column:cb},end:{row:Ma,column:Mb},token:ba,mode:La}};pf.fun=Bc;pf.arr=lc;pf.connect=$c;pf.disconnect=bc;pf.DefaultTheme=Kb;pf.tokenizeDocument=Aa;pf.modeInfo=Ha;pf.visitDocumentTokens=Qa;pf.getMode=Ab;pf.completionCommands=sa;pf.multiSelectCommands=Lc;pf.navCommands=he;pf.codeCommands=kf;pf.codeEvaluationCommands=
qe;pf.richTextCommands=df;pf.Color=ub;pf.Range=pe;pf.guessTextModeName=Sb;pf.guessTextModeName=Sb;Kb=function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Mb=cb.hasOwnProperty("EditorPlugin")&&"function"===typeof cb.EditorPlugin?cb.EditorPlugin:cb.EditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
pf.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(ba){var La=this;this.textMorph=ba;pf.connect(ba,"textChange",this,"onTextChange");pf.connect(ba,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return La.highlight()})}},
{key:"detach",value:function(ba){pf.disconnect(ba,"textChange",this,"onTextChange");pf.disconnect(ba,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(ba){this._ast=null;if(ba){var La=this._tokenizerValidBefore;if("replace"===ba.selector){var mb=ba.args[0].start;ba=mb.row;mb=mb.column}else mb=ba=0;if(!La||ba<La.row||ba===La.row&&mb<La.column)ba=Math.max(0,ba),this._tokenizerValidBefore={row:ba,
column:mb}}this.requestHighlight()}},{key:"requestHighlight",value:function(ba){var La=this;(void 0===ba?0:ba)?this.highlight():pf.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return La.highlight()})()}},{key:"highlight",value:function(){var ba=this.textMorph,La=this.theme,mb=this.mode,zb=this._tokenizerValidBefore;if(La&&ba&&ba.document&&mb){ba.fill=La.background;ba.cursorColor=La.cursorColor||pf.Color.black;var Qc=ba.viewState,yc={};zb=pf.tokenizeDocument(mb,ba.document,Qc.firstVisibleRow,
Qc.lastVisibleRow,zb);mb=zb.lines;zb=zb.tokens;if(mb.length){Qc=mb[0].row;for(var Ed=[],Ad=0;Ad<zb.length;Qc++,Ad++)for(var Bd=zb[Ad],Ke=0;Ke<Bd.length;Ke+=5){var Jg=Bd[Ke],wg=Bd[Ke+1],Qh=La[Bd[Ke+2]]||La.default;Qh&&Ed.push({start:{row:Qc,column:Jg},end:{row:Qc,column:wg}},Qh)}ba.embeddedMorphs.forEach(function(Uf){var Hh=ba.embeddedMorphMap.get(Uf).anchor;yc[Uf.id]=ba.textAttributeAt(Hh.position)});ba.setTextAttributesWithSortedRanges(Ed);ba.embeddedMorphs.forEach(function(Uf){var Hh=ba.embeddedMorphMap.get(Uf).anchor;
Hh=pf.Range.at(Hh.position);Hh.end.column+=1;ba.replace(Hh,[Uf,yc[Uf.id]],!1)});this._tokenizerValidBefore={row:pf.arr.last(mb).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},ba,this)}}},{key:"visitTokensInRange",value:function(ba,La){var mb=ba.start,zb=ba.end,Qc=mb.row-1;pf.visitDocumentTokens(this.mode,this.textMorph.document,mb.row,zb.row,null,function(yc){return Qc++},function(yc,Ed,Ad,Bd,Ke,Jg,wg){if(Qc===mb.row&&0<mb.column){if(mb.column>=Bd)return;Ad<mb.column&&mb.column<
Bd&&(Ad=mb.column)}if(Qc===zb.row){if(zb.column<=Ad)return;Ad<zb.column&&zb.column<Bd&&(Bd=zb.column)}La(yc,Ed,Qc,Ad,Bd,Ke,Jg,wg)})}},{key:"tokensInRange",value:function(ba){var La=[];this.visitTokensInRange(ba,function(mb,zb,Qc,yc,Ed,Ad,Bd,Ke){return La.push(pf.rangedToken(Qc,yc,Ed,mb,Ke))});return La}},{key:"tokensOfRow",value:function(ba){var La=this.textMorph.getLine(ba).length;return this.tokensInRange({start:{row:ba,column:0},end:{row:ba,column:La}})}},{key:"tokenAt",value:function(ba){for(var La=
this.tokensOfRow(ba.row),mb=La.length;mb--;){var zb=La[mb];if(zb.token&&zb.start.column<=ba.column&&ba.column<=zb.end.column)return zb}return null}},{key:"getCommands",value:function(ba){return[].concat($jscomp.arrayFromIterable(ba),$jscomp.arrayFromIterable(pf.completionCommands),$jscomp.arrayFromIterable(pf.multiSelectCommands),$jscomp.arrayFromIterable(pf.navCommands),$jscomp.arrayFromIterable(pf.codeCommands),$jscomp.arrayFromIterable(pf.codeEvaluationCommands),$jscomp.arrayFromIterable(pf.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var ba=this.mode,La=ba.lineComment,mb=ba.blockCommentStart;ba=ba.blockCommentEnd;var zb={};La&&(zb.lineCommentStart=La);mb&&(zb.blockCommentStart=mb);ba&&(zb.blockCommentEnd=ba);return zb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(ba,La,mb){var zb=this.textMorph,Qc=ba.row,yc=ba.column;ba=La[yc-1];La=La[yc];zb.selection.text="\n";zb.selection.collapseToEnd();
"{"===ba&&"}"===La&&(zb.selection.text="\n"+" ".repeat(mb),zb.selection.collapse());zb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Qc+1,lastRow:Qc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var ba=this.textMorph,La=this.openPairs,mb=ba.selection,zb=ba.getLine(mb.end.row),
Qc=zb[mb.end.column-1];zb=zb[mb.end.column];ba.autoInsertPairs&&mb.isEmpty()&&Qc in La&&zb===La[Qc]&&(mb.growRight(1),mb.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(ba){var La=this.openPairs,mb=this.closePairs,zb=this.textMorph,Qc=zb.selection,yc=zb.autoInsertPairs&&ba in La,Ed=zb.autoInsertPairs&&ba in mb;if(!yc&&!Ed)return!1;var Ad=zb.getLine(Qc.end.row)[Qc.end.column];if(!Qc.isEmpty()){if(!yc)return!1;mb=zb.undoManager.ensureNewGroup(zb);zb.insertText(La[ba],Qc.end);zb.insertText(ba,
Qc.start);zb.undoManager.group(mb);Qc.growRight(-1);return!0}if(Ad in mb&&ba===Ad)return Qc.goRight(1),!0;if(Ed&&!yc)return!1;mb=zb.undoManager.ensureNewGroup(zb);zb.insertText(ba+La[ba]);zb.undoManager.group(mb);Qc.goLeft(1);return!0}}],[{key:"className",get:function(){return"EditorPlugin"}}],cb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:3088,end:11936})}(void 0);Ha=Kb=pf.EditorPlugin;sa=Ca("C",function(Ma){var cb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Mb=cb.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof cb.CodeMirrorEnabledEditorPlugin?cb.CodeMirrorEnabledEditorPlugin:cb.CodeMirrorEnabledEditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Mb,Ma,[{key:Symbol.for("lively-instance-initialize"),
value:function(){Tb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(ba){this.mode=this.codeMirrorMode(ba);return Tb._get(Object.getPrototypeOf(Mb.prototype),"attach",this).call(this,ba)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(ba){return{indentWithTabs:!ba.useSoftTabs,indentUnit:ba.tabWidth,
tabSize:4}}},{key:"codeMirrorMode",value:function(ba){ba=this.defaultCodeMirrorModeConfig(ba);return pf.getMode(ba,{name:this.longName})}}],[{key:"className",get:function(){return"CodeMirrorEnabledEditorPlugin"}}],cb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(pf.EditorPlugin));
pf.CodeMirrorEnabledEditorPlugin=sa;pf.CodeMirrorEnabledEditorPlugin=sa;pf.CodeMirrorEnabledEditorPlugin=sa;pf.default=Kb;Kb=Object.freeze({__proto__:null,guessTextModeName:Sb,"default":Ha,CodeMirrorEnabledEditorPlugin:sa});Ca("e",Kb)}}});
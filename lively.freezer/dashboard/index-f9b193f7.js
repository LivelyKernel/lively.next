System.register(["./__root_module__-aa47e4cd.js"],function(Ca){var ub,Tb,lc,mc,Zd,id,ce,kd,$c,Cd,Fd,pe,Xd,nd,eb,Hb,Cc,qc,ld,wd,Xc,gd,bc,ad,ed,Id,hc,Qb,xb,Nb,kb,Db,Rb,vc,jc,qb,rb,cc,Vc,Bc,xc,kc;return{setters:[function(Q){ub=Q.ar;Tb=Q.a1;lc=Q.C;mc=Q.al;Zd=Q.ag;id=Q.av;ce=Q.aT;kd=Q.az;$c=Q.aw;Cd=Q.a7;Fd=Q.aj;pe=Q.am;Xd=Q.h;nd=Q.a0;eb=Q.$;Hb=Q.af;Cc=Q.a5;qc=Q.P;ld=Q._;wd=Q.aU;Xc=Q.an;gd=Q.a4;bc=Q.ao;ad=Q.ap;ed=Q.aV;Id=Q.aW;hc=Q.as;Qb=Q.aq;xb=Q.s;Nb=Q.at;kb=Q.aX;Db=Q.ai;Rb=Q.aY;vc=Q.aZ;jc=Q.a_;qb=
Q.a8;rb=Q.a$;cc=Q.ak;Vc=Q.b0;Bc=Q.b1;xc=Q.b2;kc=Q.aO}],execute:function(){function Q(oa){(oa=Fb.cachedGuideLines.get(oa))&&oa.forEach(function(Ha){return Ha.remove()})}function ea(oa,Ha,Kb,P,sa){Ha=void 0===Ha?!0:Ha;Kb=void 0===Kb?!0:Kb;P=void 0===P?10:P;sa=void 0===sa?100:sa;if(Ha||Kb){var Ta=oa.owner,Ib=Ta.world();Ta=Ta.getGlobalTransform();var Lc=oa.owner.submorphs.filter(function(Ad){return Ad!==oa&&!Ad.isEpiMorph&&Ad.visible&&Ad.reactsToPointer}),Wc=Fb.findAlignedMorphs(oa,Lc,P,sa,"left top right bottom hCenter vCenter".split(" "),
"left top right bottom hCenter vCenter".split(" "));sa=[];var he=0,ie=0,kf=0,Qd=0;Ta.e-=Ib.scroll.x;Ta.f-=Ib.scroll.y;if(Wc){Wc=$jscomp.makeIterator(Wc);for(var qe=Wc.next();!qe.done;qe=Wc.next()){qe=$jscomp.makeIterator(qe.value);qe.next();var df=qe.next().value;qe=df.vertical;df=$jscomp.makeIterator(df.horizontal);for(var Af=df.next();!Af.done;Af=df.next()){Af=Af.value;var rg=Af.edgeAVal,mg=Af.refPointsA,Yc=Af.refPointsB,Bf=Af.edgeBVal,dg=Math.ceil(P-Af.delta),Gg=Math.min(mg.top,Yc.top);mg=Math.max(mg.bottom,
Yc.bottom);Af.maxDist>P&&(dg-=P/2);he<dg&&(he=dg,kf=Bf-rg);sa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Fb.guideWidth,start:Ta.transformPoint(Fb.pt(Bf,Gg)),end:Ta.transformPoint(Fb.pt(Bf,mg)),fill:Fb.guideColor,guideType:"h",priority:dg})}qe=$jscomp.makeIterator(qe);for(df=qe.next();!df.done;df=qe.next())df=df.value,Af=df.edgeAVal,Gg=df.refPointsA,mg=df.refPointsB,rg=df.edgeBVal,Bf=Math.ceil(P-df.delta),dg=Math.min(Gg.left,mg.left),Gg=Math.max(Gg.right,mg.right),df.maxDist>P&&(Bf-=
P/2),ie<Bf&&Math.abs(rg-Af)<=P&&(ie=Bf,Qd=rg-Af),sa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Fb.guideWidth,start:Ta.transformPoint(Fb.pt(dg,rg)),end:Ta.transformPoint(Fb.pt(Gg,rg)),fill:Fb.guideColor,guideType:"v",priority:Bf})}}if(!he||!ie){Lc=[oa].concat($jscomp.arrayFromIterable(Lc));Af=Fb.computeClosestMorphs(Lc);df=Af[0];Lc=df.l;Wc=df.r;qe=df.t;df=df.b;var pf;if(Lc||Wc||qe||df){var Ma=(Lc||Wc||qe||df).refPointsA;for(rg=1;rg<Af.length&&(mg=Af[rg],Bf=mg.l,dg=mg.r,Gg=mg.t,mg=mg.b,
he||(Lc&&Bf&&Lc.index!==Bf.index&&Math.abs(Bf.dist-Lc.dist)<=P?pf=Object.assign({neighbor:rg,direction:"left"},Bf):Wc&&dg&&Wc!==dg.index&&Math.abs(dg.dist-Wc.dist)<=P&&(pf=Object.assign({neighbor:rg,direction:"right"},dg))),ie||(qe&&Gg&&qe.index!==Gg.index&&Math.abs(Gg.dist-qe.dist)<=P?pf=Object.assign({neighbor:rg,direction:"top"},Gg):df&&mg&&df.index!==mg.index&&Math.abs(mg.dist-df.dist)<=P&&(pf=Object.assign({neighbor:rg,direction:"bottom"},mg))),!pf);rg++);}if(pf){var cb=pf;P=cb.direction;Gg=
cb.dist;var Mb=Ma.left;Yc=Ma.top;var ba=Ma.bottom,La=Ma.right,mb=Ma.width,zb=Ma.height;mg=cb.refPointsA;Ma=mg.left;Af=mg.top;rg=mg.bottom;Bf=mg.right;dg=mg.width;mg=mg.height;var Qc=cb.refPointsB,yc=Qc.left;cb=Qc.top;var Ed=Qc.bottom;Qc=Qc.right;La="left"===P?Mb:"right"===P?La:Mb+mb/2;ba="bottom"===P?ba:"top"===P?Yc:Yc+zb/2;Mb="left"===P?La-Gg:"right"===P?La+Gg:Mb+mb/2;Gg="bottom"===P?ba+Gg:"top"===P?ba-Gg:Yc+zb/2;Yc="left"===P?Qc:"right"===P?yc:Ma+dg/2;mb="bottom"===P?cb:"top"===P?Ed:Af+mg/2;!Kb||
he||"right"!==P&&"left"!==P||(he=10,kf=(pf.dist-(Wc||Lc).dist)*("right"===P?-1:1),La+=kf,Mb+=kf);!Kb||ie||"top"!==P&&"bottom"!==P||(ie=10,Qd=((qe||df).dist-pf.dist)*("top"===P?-1:1),ba+=Qd,Gg+=Qd);sa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,start:Ta.transformPoint(Fb.pt("left"===P?Ma:"right"===P?Bf:Ma+dg/2,"bottom"===P?rg:"top"===P?Af:Af+mg/2)),end:Ta.transformPoint(Fb.pt(Yc,mb)),fill:Fb.Color.orange,height:Fb.guideWidth,guideType:P,priority:10},{type:"line",epiMorph:!0,hasFixedPosition:!0,
start:Ta.transformPoint(Fb.pt(La,ba)),end:Ta.transformPoint(Fb.pt(Mb,Gg)),fill:Fb.Color.orange,height:Fb.guideWidth,guideType:P,priority:10})}}Kb&&(kf||Qd)&&oa.moveBy(Fb.pt(kf,Qd));if(Ha){sa=sa.filter(function(Ad){var Bd=Ad.guideType;Ad=Ad.priority;return"h"===Bd?Ad===he:"v"===Bd?Ad===ie:!0});(Ha=Fb.cachedGuideLines.get(oa))||Fb.cachedGuideLines.set(oa,Ha=[]);for(Kb=0;Kb<sa.length;Kb++)pf=void 0,Ha[Kb]?pf=Object.assign(Ha[Kb],sa[Kb]):(pf=Fb.morph(sa[Kb]),Ha.push(pf)),pf.owner||Ib.addMorph(pf);Ha.slice(Kb).forEach(function(Ad){return Ad.remove()});
Fb.fun.debounceNamed(oa.id+"-drag-guides-cleanup",1300,function(){var Ad=Fb.cachedGuideLines.get(oa);Ad&&Ad.forEach(function(Bd){return Bd.remove()})})()}}}function Ga(oa,Ha,Kb,P,sa,Ta){Kb=void 0===Kb?!0:Kb;P=void 0===P?!0:P;sa=void 0===sa?5:sa;Ta=void 0===Ta?100:Ta;if(Kb||P){var Ib=oa.owner,Lc=Ib.world(),Wc=Ib.getGlobalTransform(),he=oa.owner.submorphs.filter(function(ba){return ba!==oa&&!ba.isEpiMorph&&ba.visible&&ba.reactsToPointer});Ib=(Ha.includes("left")||Ha.includes("right")?"x":"")+(Ha.includes("top")||
Ha.includes("bottom")?"y":"");var ie=Fb.findMorphsWithSimilarWidthOrHeight(oa,Ib,he,sa,Ta),kf=-Infinity,Qd=-Infinity,qe=0,df=0,Af=0,rg=0,mg=0,Yc=0;Ib=[];Wc.e-=Lc.scroll.x;Wc.f-=Lc.scroll.y;if(ie){ie=$jscomp.makeIterator(ie);for(var Bf=ie.next();!Bf.done;Bf=ie.next()){Bf=$jscomp.makeIterator(Bf.value);Bf.next();var dg=Bf.next().value;Bf=dg.similarIn;var Gg=dg.delta,pf=dg.refPointsA,Ma=dg.refPointsB;dg=sa-Gg+(Ta-dg.minDist);"width"===Bf?kf<dg&&(kf=dg,Ha.includes("left")&&(df=-Gg),Ha.includes("right")&&
(qe=Gg)):Qd<dg&&(Qd=dg,Ha.includes("top")&&(Af=-Gg),Ha.includes("bottom")&&(rg=Gg));Gg={type:"line",epiMorph:!0,hasFixedPosition:!0,height:Fb.guideWidth,fill:Fb.guideColor,guideType:Bf,priority:dg,start:Wc.transformPoint("width"===Bf?Fb.pt(pf.left,pf.top+pf.height/2):Fb.pt(pf.left+pf.width/2,pf.top)),end:Wc.transformPoint("width"===Bf?Fb.pt(pf.right,pf.top+pf.height/2):Fb.pt(pf.left+pf.width/2,pf.bottom))};Bf=Object.assign({},Gg,{start:Wc.transformPoint("width"===Bf?Fb.pt(Ma.left,Ma.top+Ma.height/
2):Fb.pt(Ma.left+Ma.width/2,Ma.top)),end:Wc.transformPoint("width"===Bf?Fb.pt(Ma.right,Ma.top+Ma.height/2):Fb.pt(Ma.left+Ma.width/2,Ma.bottom))});Ib.push(Gg,Bf)}}if(Ta=Fb.findAlignedMorphs(oa,he,sa,Ta,Ha,void 0))for(Ta=$jscomp.makeIterator(Ta),he=Ta.next();!he.done;he=Ta.next()){he=$jscomp.makeIterator(he.value);he.next();ie=he.next().value;he=ie.vertical;ie=$jscomp.makeIterator(ie.horizontal);for(Bf=ie.next();!Bf.done;Bf=ie.next()){Bf=Bf.value;Ma=Bf.edgeAVal;var cb=Bf.refPointsA,Mb=Bf.refPointsB;
Gg=Bf.edgeBVal;pf=Math.ceil(sa-Bf.delta);dg=Math.min(cb.top,Mb.top);cb=Math.max(cb.bottom,Mb.bottom);Bf.maxDist>sa&&(pf-=sa/2);mg<pf&&(mg=pf,Ha.includes("left")&&(df=-(Gg-Ma)),Ha.includes("right")&&(qe=+(Gg-Ma)));Ib.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Fb.guideWidth,start:Wc.transformPoint(Fb.pt(Gg,dg)),end:Wc.transformPoint(Fb.pt(Gg,cb)),fill:Fb.guideColor,guideType:"h",priority:pf})}he=$jscomp.makeIterator(he);for(ie=he.next();!ie.done;ie=he.next())ie=ie.value,Bf=ie.edgeAVal,
dg=ie.refPointsA,cb=ie.refPointsB,Ma=ie.edgeBVal,Gg=Math.ceil(sa-ie.delta),pf=Math.min(dg.left,cb.left),dg=Math.max(dg.right,cb.right),ie.maxDist>sa&&(Gg-=sa/2),Yc<Gg&&Math.abs(Ma-Bf)<=sa&&(Yc=Gg,Ha.includes("top")&&(Af=Ma-Bf),Ha.includes("bottom")&&(rg=Ma-Bf)),Ib.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Fb.guideWidth,start:Wc.transformPoint(Fb.pt(pf,Ma)),end:Wc.transformPoint(Fb.pt(dg,Ma)),fill:Fb.guideColor,guideType:"v",priority:Gg})}P&&(df&&(oa.left+=df,oa.right-=df),Af&&(oa.top+=
Af,oa.bottom-=Af),qe&&(oa.width+=qe),rg&&(oa.height+=rg));if(Kb){Ib=Ib.filter(function(ba){var La=ba.guideType;ba=ba.priority;return"width"===La?ba===kf:"height"===La?ba===Qd:"v"===La?ba===Yc:"h"===La?ba===mg:!1});(Ha=Fb.cachedGuideLines.get(oa))||Fb.cachedGuideLines.set(oa,Ha=[]);for(Kb=0;Kb<Ib.length;Kb++)P=void 0,Ha[Kb]?P=Object.assign(Ha[Kb],Ib[Kb]):(P=Fb.morph(Ib[Kb]),Ha.push(P)),P.owner||Lc.addMorph(P);Ha.slice(Kb).forEach(function(ba){return ba.remove()});Fb.fun.debounceNamed(oa.id+"-drag-guides-cleanup",
1300,function(){var ba=Fb.cachedGuideLines.get(oa);ba&&ba.forEach(function(La){return La.remove()})})()}}}function Ua(oa,Ha){Ha=void 0===Ha?!1:Ha;var Kb=Oa.MorphicEnv.default().world;if(null===oa||void 0===oa)oa=String(oa);if(oa.isMorph)return Oa.showRect(oa.world(),oa.globalBounds().translatedBy(oa.world().scroll.negated()),Ha);if(oa.isPoint)return Oa.showRect(Kb,new Oa.Rectangle(oa.x-5,oa.y-5,10,10));if(oa.isLine)return Oa.showLine(Kb,oa);if(oa.isRectangle)return Oa.showRect(Kb,oa);if("undefined"!==
typeof Oa.Element&&oa instanceof Oa.Element)return Oa.showRect(Kb,Oa.Rectangle.fromElement(oa));if("number"===typeof oa||"symbol"===typeof oa||"boolean"===typeof oa||"undefined"!==typeof Oa.Node&&oa instanceof Oa.Node||oa instanceof RegExp)oa=String(oa);"object"===typeof oa&&(oa=Oa.obj.inspect(oa,{maxDepth:1}));return"string"===typeof oa&&1===arguments.length?Kb.setStatusMessage(oa):Kb.setStatusMessage(Oa.string.formatFromArray(Array.from(arguments)))}function fc(oa,Ha,Kb){Kb=void 0===Kb?3E3:Kb;var P,
sa,Ta,Ib,Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wc){if(1==Wc.nextAddress){if(!(oa&&oa.world()&&Ha&&Ha.world()))return Wc.return(null);P=oa.owner.worldPoint(oa.center);sa=Ha.owner.worldPoint(Ha.center);Ta=P.lineTo(sa).sampleN(2)[1];Ib={tagName:"marker",markerHeight:5,markerWidth:5,orient:"auto",refX:1,refY:5,viewBox:"0 0 10 10",children:[{tagName:"circle",stroke:Oa.Color.red,fill:Oa.Color.red,cx:5,cy:5,r:4}]};Lc=$world.addMorph(new Oa.Path({position:Ta,renderOnGPU:!0,vertices:[Oa.pt(0),
Oa.pt(0)],borderWidth:2,startMarker:Ib,endMarker:Ib,borderColor:Oa.Color.red}));return Wc.yield(Lc.whenRendered(),2)}if(3!=Wc.nextAddress)return Wc.yield(Lc.animate({opacity:1,customTween:function(he){var ie=Lc.center;Lc.vertices=[Oa.pt(0).interpolate(he,P.subPt(Ta)),Oa.pt(0).interpolate(he,sa.subPt(Ta))];Lc.center=ie},duration:400}),3);Kb&&setTimeout(function(){return Lc.fadeOut()},Kb);return Wc.return(Lc)})}Ca({a:ea,d:fc,r:Q,s:Ua});var Fb=lively.FreezerRuntime.recorderFor("lively.halos/drag-guides.js");
Fb.removeSnapToGuidesOf=Q;Fb.showAndSnapToGuides=ea;Fb.showAndSnapToResizeGuides=Ga;Fb.computeRefPoints=function(oa){var Ha=oa.x,Kb=oa.y,P=oa.width;oa=oa.height;return{left:Ha,top:Kb,hCenter:Ha+P/2,vCenter:Kb+oa/2,right:Ha+P,bottom:Kb+oa,width:P,height:oa}};Fb.findEdgesInAlignment=function(oa,Ha,Kb,P,sa,Ta,Ib,Lc,Wc,he){Kb=void 0===Kb?15:Kb;Ta=void 0===Ta?0:Ta;Ib=void 0===Ib?0:Ib;Lc=void 0===Lc?0:Lc;Wc=void 0===Wc?0:Wc;he=void 0===he?0:he;for(var ie=[],kf=[],Qd=0;Qd<Fb.edges.length;Qd++){var qe=$jscomp.makeIterator(Fb.edges[Qd]),
df=qe.next().value,Af=qe.next().value;qe=qe.next().value;var rg=oa[Af],mg=Ha[qe],Yc=Math.max(rg,mg)-Math.min(rg,mg);Yc>Kb||!(P&&!P.includes(Af)||sa&&!sa.includes(qe))&&("vertical"===df?ie:kf).push({delta:Yc,edgeA:Af,edgeB:qe,edgeAVal:rg,edgeBVal:mg,refPointsA:oa,refPointsB:Ha,distLeft:Ta,distTop:Ib,distRight:Lc,distBottom:Wc,maxDist:he})}return ie.length||kf.length?{vertical:ie,horizontal:kf}:null};Fb.findAlignedMorphs=function(oa,Ha,Kb,P,sa,Ta){Kb=void 0===Kb?15:Kb;P=void 0===P?Infinity:P;for(var Ib,
Lc=Fb.computeRefPoints(oa.bounds()),Wc=0;Wc<Ha.length;Wc++){var he=Ha[Wc];if(he!==oa){var ie=Fb.computeRefPoints(he.bounds()),kf=Math.max(0,Lc.left-ie.right),Qd=Math.max(0,ie.left-Lc.right),qe=Math.max(0,Lc.top-ie.bottom),df=Math.max(0,ie.top-Lc.bottom);Math.max(df,qe,Qd,kf)>P||!(ie=Fb.findEdgesInAlignment(Lc,ie,Kb,sa,Ta,kf,qe,Qd,df,Math.max(df,qe,Qd,kf)))||(Ib||(Ib=new Map),Ib.set(he,ie))}}oa=oa.owner;Ha=Fb.computeRefPoints(oa.innerBounds());if(Kb=Fb.findEdgesInAlignment(Lc,Ha,Kb))Ib||(Ib=new Map),
Ib.set(oa,Kb);return Ib};Fb.findMorphsWithSimilarWidthOrHeight=function(oa,Ha,Kb,P,sa){P=void 0===P?15:P;sa=void 0===sa?Infinity:sa;for(var Ta,Ib=Fb.computeRefPoints(oa.bounds()),Lc=0;Lc<Kb.length;Lc++){var Wc=Kb[Lc];if(Wc!==oa){var he=Fb.computeRefPoints(Wc.bounds()),ie=Math.max(0,Ib.left-he.right),kf=Math.max(0,he.left-Ib.right),Qd=Math.max(0,Ib.top-he.bottom),qe=Math.max(0,he.top-Ib.bottom),df=Math.min(qe,Qd,kf,ie),Af=Math.max(qe,Qd,kf,ie);if(!(Math.max(qe,Qd,kf,ie)>sa)){kf=Ib;ie=kf.width;kf=kf.height;
qe=he;Qd=qe.width;qe=qe.height;var rg=Qd-ie,mg=qe-kf;("x"===Ha||"xy"===Ha)&&Math.abs(rg)<=P&&(Ta||(Ta=new Map),Ta.set(Wc,{similarIn:"width",minDist:df,maxDist:Af,refPointsA:Ib,refPointsB:he,valA:ie,valB:Qd,delta:rg}));("y"===Ha||"xy"===Ha)&&Math.abs(mg)<=P&&(Ta||(Ta=new Map),Ta.set(Wc,{similarIn:"height",minDist:df,maxDist:Af,refPointsA:Ib,refPointsB:he,valA:kf,valB:qe,delta:mg}))}}}return Ta};Fb.closest=function(oa,Ha,Kb,P,sa,Ta,Ib,Lc){Lc=void 0===Lc?!0:Lc;var Wc=P[oa],he=sa[oa],ie=Ta[oa];Ha=Ib[oa];
for(var kf,Qd,qe,df,Af=0;Af<sa.length;Af++)oa===Af||Wc<sa[Af]||kf&&sa[kf.index]>=sa[Af]||Lc&&Ib[oa]<Ta[Af]||Ta[oa]>Ib[Af]||(kf={index:Af,dist:Wc-sa[Af],refPointsA:Kb[oa],refPointsB:Kb[Af]});for(Wc=0;Wc<P.length;Wc++)oa===Wc||he>P[Wc]||Qd&&P[Qd.index]<=P[Wc]||Lc&&Ib[oa]<Ta[Wc]||Ta[oa]>Ib[Wc]||(Qd={index:Wc,dist:P[Wc]-he,refPointsA:Kb[oa],refPointsB:Kb[Wc]});for(he=0;he<Ib.length;he++)oa===he||ie<Ib[he]||qe&&Ib[qe.index]>=Ib[he]||Lc&&P[oa]>sa[he]||sa[oa]<P[he]||(qe={index:he,dist:ie-Ib[he],refPointsA:Kb[oa],
refPointsB:Kb[he]});for(Ib=0;Ib<Ta.length;Ib++)oa===Ib||Ha>Ta[Ib]||df&&Ta[df.index]<=Ta[Ib]||Lc&&P[oa]>sa[Ib]||sa[oa]<P[Ib]||(df={index:Ib,dist:Ta[Ib]-Ha,refPointsA:Kb[oa],refPointsB:Kb[Ib]});return{l:kf,r:Qd,t:qe,b:df}};Fb.computeClosestMorphs=function(oa){for(var Ha=[],Kb=[],P=[],sa=[],Ta=[],Ib=[],Lc=0;Lc<oa.length;Lc++){var Wc=Fb.computeRefPoints(oa[Lc].bounds());Ta.push(Wc);var he=Wc.right,ie=Wc.top,kf=Wc.bottom;Ha.push(Wc.left);Kb.push(he);P.push(ie);sa.push(kf)}for(Lc=0;Lc<oa.length;Lc++)Ib.push(Fb.closest(Lc,
oa,Ta,Ha,Kb,P,sa));return Ib};Fb.fun=ub;Fb.pt=Tb;Fb.Color=lc;Fb.morph=mc;Fb.cachedGuideLines=new WeakMap;Fb.guideWidth=1;Fb.guideColor=Fb.Color.orange.lighter();Fb.removeSnapToGuidesOf=Q;Fb.removeSnapToGuidesOf=Q;Fb.showAndSnapToGuides=ea;Fb.showAndSnapToGuides=ea;Fb.showAndSnapToResizeGuides=Ga;Fb.showAndSnapToResizeGuides=Ga;Fb.edges=[["vertical","top","top"],["vertical","vCenter","top"],["vertical","bottom","top"],["vertical","top","vCenter"],["vertical","vCenter","vCenter"],["vertical","bottom",
"vCenter"],["vertical","top","bottom"],["vertical","vCenter","bottom"],["vertical","bottom","bottom"],["horizontal","left","left"],["horizontal","hCenter","left"],["horizontal","right","left"],["horizontal","left","hCenter"],["horizontal","hCenter","hCenter"],["horizontal","right","hCenter"],["horizontal","left","right"],["horizontal","hCenter","right"],["horizontal","right","right"]];var Va=lively.FreezerRuntime.recorderFor("lively.halos/morph.js");Va.Morph=Zd;Va.Label=id;Va.StyleSheet=ce;Va.HorizontalLayout=
kd;Va.Path=$c;Va.Text=Cd;Va.GridLayout=Fd;Va.morph=mc;Va.Icon=pe;Va.createMorphSnapshot=Xd;Va.Color=lc;Va.pt=Tb;Va.rect=nd;Va.Rectangle=eb;Va.LinearGradient=Hb;Va.obj=Cc;Va.PropertyPath=qc;Va.promise=ld;Va.properties=wd;Va.num=Xc;Va.arr=gd;Va.connect=bc;Va.signal=ad;Va.disconnect=ed;Va.disconnectAll=Id;Va.once=hc;Va.showAndSnapToGuides=ea;Va.showAndSnapToResizeGuides=Ga;Va.removeSnapToGuidesOf=Q;Va.haloBlue=Va.Color.rgb(23,160,251);Va.componentAccent=Va.Color.magenta;Va.derivedAccent=Va.Color.purple;
var Ab=function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("Halo")&&"function"===typeof Ha.Halo?Ha.Halo:Ha.Halo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"relayout",value:function(){this.alignWithTarget()}},{key:"keybindings",get:function(){return[{keys:{mac:"Meta-C",win:"Ctrl-C"},command:{command:"clipboard copy",passEvent:!0}}]}},{key:"commands",
get:function(){return[{name:"clipboard copy",doc:"copy selected morph(s) to clipboard",scrollCursorIntoView:!1,exec:function(P){P.copyHalo().copyToClipBoard()}}]}},{key:"removeIfDetached",value:function(){var P=this;setTimeout(function(){P.target.owner||P.remove()})}},{key:"initLayout",value:function(){var P=this.layout=new Va.GridLayout({autoAssign:!1,fitToCell:!1,columns:[0,{fixed:36,paddingRight:10},2,{fixed:26},4,{fixed:26},6,{fixed:36,paddingLeft:10}],rows:[0,{fixed:36,paddingBottom:10},2,{fixed:26},
4,{fixed:26},6,{fixed:26},7,{fixed:36,paddingTop:10}],grid:[["menu",null,"grab",null,"drag",null,"close"],[null,null,null,null,null,null,null],["copy",null,null,null,null,null,"edit"],[null,null,null,null,null,null,null],["component",null,null,null,null,null,"inspect"],[null,null,null,null,null,null,null],["rotate",null,null,null,null,null,"resize"],[null,"name","name","name","name","name",null]]});P.col(1).row(7).group.align="center";P.col(1).row(7).group.resize=!1}},{key:"initButtons",value:function(){this.submorphs=
[].concat($jscomp.arrayFromIterable(this.ensureResizeHandles()),$jscomp.arrayFromIterable(this.resizeOnly?[]:[this.closeHalo(),this.dragHalo(),this.grabHalo(),this.menuHalo(),this.inspectHalo(),this.editHalo(),this.copyHalo(),this.componentHalo(),this.rotateHalo(),this.nameHalo(),this.originHalo()]))}},{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"isHalo",get:function(){return!0}},{key:"borderBox",get:function(){return this.getSubmorphNamed("border-box")||
this.addMorphBack(Va.morph({name:"border-box",fill:Va.Color.transparent,borderColor:this.target.isComponent?Va.componentAccent:Va.haloBlue,borderWidth:1}))}},{key:"pointerId",get:function(){return this.state?this.state.pointerId:null}},{key:"pointerId",set:function(P){this.state||(this.state={});this.state.pointerId=P}},{key:"prepareTarget",value:function(P){if(!Va.obj.isArray(P))return P;if(1>=P.length)return P[0];P=P[0].world().addMorph(new Va.MultiSelectionTarget({selectedMorphs:P}));P.alignWithSelection();
P.modifiesSelectedMorphs=!0;return P}},{key:"refocus",value:function(P){this.target=P;this.alignWithTarget()}},{key:"alignWithTarget",value:function(){if(!this.active&&this.target){var P=this.target.world()||$world,sa=P.visibleBounds(),Ta=this.target.globalBounds(),Ib=Ta.insetBy(-36).intersection(sa);sa=Ta.intersection(sa);this.layout&&this.layout.disable();this.setBounds(Ib.translatedBy(P.scroll.negated()));this.borderBox.setBounds($world.transformRectToMorph(this,sa));this.state.activeButton?(this.buttonControls.forEach(function(Lc){return Lc.visible=
!1}),this.ensureResizeHandles().forEach(function(Lc){return Lc.visible=!1}),this.state.activeButton.visible=!0,this.updatePropertyDisplay(this.state.activeButton)):(this.changingName&&this.nameHalo().toggleActive([!1]),this.ensureResizeHandles().forEach(function(Lc){return Lc.visible=!0}),this.buttonControls.forEach(function(Lc){Lc.visible=!0}),this.propertyDisplay.disable());this.nameHalo().alignInHalo();this.ensureResizeHandles().forEach(function(Lc){return Lc.alignInHalo()});this.resizeOnly||this.originHalo().alignInHalo();
this.layout&&this.layout.enable();return this}}},{key:"detachFromTarget",value:function(){var P=this.target;P&&(Va.disconnect(P,"onChange",this,"alignWithTarget"),Va.disconnect(P,"onOwnerChanged",this,"removeIfDetached"),P instanceof Va.MultiSelectionTarget?(P.modifiesSelectedMorphs=!1,P.remove()):"function"===typeof P.detachedHalo&&P.detachedHalo(this))}},{key:"remove",value:function(){this.detachFromTarget();Qb._get(Object.getPrototypeOf(Kb.prototype),"remove",this).call(this)}},{key:"morphsContainingPoint",
value:function(P){return P}},{key:"propertyDisplay",get:function(){return Va.HaloPropertyDisplay.for(this)}},{key:"nameHalo",value:function(){return Va.NameHaloItem.for(this)}},{key:"closeHalo",value:function(){return Va.CloseHaloItem.for(this)}},{key:"grabHalo",value:function(){return Va.GrabHaloItem.for(this)}},{key:"dragHalo",value:function(){return Va.DragHaloItem.for(this)}},{key:"menuHalo",value:function(){return Va.MenuHaloItem.for(this)}},{key:"inspectHalo",value:function(){return Va.InspectHaloItem.for(this)}},
{key:"editHalo",value:function(){return Va.EditHaloItem.for(this)}},{key:"rotateHalo",value:function(){return Va.RotateHaloItem.for(this)}},{key:"copyHalo",value:function(){return Va.CopyHaloItem.for(this)}},{key:"originHalo",value:function(){return Va.OriginHaloItem.for(this)}},{key:"componentHalo",value:function(){return Va.ComponentHaloItem.for(this)}},{key:"buttonControls",get:function(){return this.submorphs.filter(function(P){return P.isHaloItem&&!P.isResizeHandle})}},{key:"addMorphToSelection",
value:function(P){var sa=this,Ta,Ib;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lc){return 1==Lc.nextAddress?(Ta=sa.world(),Ib=sa.target.isMorphSelection?sa.target.selectedMorphs:[sa.target],sa.remove(),Lc.yield(Ta.showHaloForSelection([].concat($jscomp.arrayFromIterable(Ib),[P]),sa.state.pointerId),2)):Lc.return(Lc.yieldResult)})}},{key:"removeMorphFromSelection",value:function(P){var sa=this,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ib){if(1==Ib.nextAddress){Ta=
sa.world();sa.remove();if(!sa.target.isMorphSelection)return Ib.jumpTo(0);Va.arr.remove(sa.target.selectedMorphs,P);return Ib.yield(Ta.showHaloForSelection(sa.target.selectedMorphs,sa.state.pointerId),3)}return Ib.return(Ib.yieldResult)})}},{key:"isAlreadySelected",value:function(P){return this.target==P||this.target.isMorphSelection&&this.target.selectsMorph(P)}},{key:"updateBoundsFor",value:function(P,sa,Ta,Ib,Lc){var Wc={topLeft:Va.rect(-1,-1,1,1),topCenter:sa?Va.rect(1,-1,0,1):Va.rect(0,-1,0,
1),topRight:Va.rect(0,-1,1,1),rightCenter:sa?Va.rect(0,1,1,1):Va.rect(0,0,1,0),bottomRight:Va.rect(0,0,1,1),bottomCenter:sa?Va.rect(1,0,0,1):Va.rect(0,0,0,1),bottomLeft:Va.rect(-1,0,1,1),leftCenter:sa?Va.rect(-1,1,1,0):Va.rect(-1,0,1,0)}[P];Lc=Wc.x;var he=Wc.y,ie=Wc.width;Wc=Wc.height;Ta=sa?this.proportionalDelta(P,Ta,Ib):Ta;P=Va.rect(Ta.x*Lc,Ta.y*he,Ta.x*ie,Ta.y*Wc);this.active=!0;this.target.setBounds(Ib.insetByRect(P));(this.target.isPolygon||this.target.isPath)&&this.target.moveBy(this.target.origin.negated());
this.active=!1;this.alignWithTarget()}},{key:"proportionalDelta",value:function(P,sa,Ta){var Ib=Ta.width,Lc=Ta.height;Ta={topLeft:Va.pt(-1,-1),topCenter:Va.pt(0,-1),topRight:Va.pt(1,-1),leftCenter:Va.pt(-1,0),rightCenter:Va.pt(1,0),bottomLeft:Va.pt(-1,1),bottomCenter:Va.pt(0,1),bottomRight:Va.pt(1,1)};var Wc=Ib/Math.max(Ib,Lc),he=Lc/Math.max(Lc,Ib);Ib={topLeft:Va.pt(-Wc,-he),topCenter:Va.pt(1/(2*Lc/Ib),-1),topRight:Va.pt(Wc,-he),leftCenter:Va.pt(-1,Lc/(2*Ib)),rightCenter:Va.pt(1,Lc/(3*Ib)),bottomLeft:Va.pt(-Wc,
he),bottomCenter:Va.pt(1/(2*Lc/Ib),1),bottomRight:Va.pt(Wc,he)};Ta=Ta[P];return Ib[P].scaleBy(Ta.dotProduct(sa)/Ta.dotProduct(Ta))}},{key:"ensureResizeHandles",value:function(){return Va.ResizeHandle.resizersFor(this)}},{key:"updatePropertyDisplay",value:function(P){P=P.valueForPropertyDisplay();"undefined"!==typeof P?this.propertyDisplay.displayProperty(P):this.propertyDisplay.disable()}},{key:"toggleDiagonal",value:function(P,sa){if(!Va.rect(0).sides.includes(sa)){var Ta=this.getSubmorphNamed("diagonal");
if(P){P=this.target.globalBounds();var Ib=P.width,Lc=P.height;P=this.localize(Va.pt(P.x,P.y)).extent(Va.pt(Ib,Lc)).scaleRectTo(this.innerBounds());Ib={topLeft:[Va.pt(Ib,Lc),Va.pt(0,0)],topRight:[Va.pt(0,Lc),Va.pt(Ib,0)],bottomRight:[Va.pt(0,0),Va.pt(Ib,Lc)],bottomLeft:[Va.pt(Ib,0),Va.pt(0,Lc)]};Ta?Ta.setBounds(P):(Ta=$jscomp.makeIterator(Ib[sa]),sa=Ta.next().value,Ta=Ta.next().value,Ib=new Va.LinearGradient({stops:[{offset:0,color:Va.Color.orange.withA(0)},{offset:.2,color:Va.Color.orange},{offset:.8,
color:Va.Color.orange},{offset:1,color:Va.Color.orange.withA(0)}]}),Ta=this.addMorphBack(new Va.Path({opacity:0,name:"diagonal",borderStyle:"dotted",borderWidth:5,bounds:P,borderColor:Ib,vertices:[sa,Ta]})),Ta.setBounds(P),Ta.animate({opacity:1,duration:500}))}else Ta&&Ta.fadeOut(500)}}},{key:"toggleRotationIndicator",value:function(P,sa){var Ta=this.getSubmorphNamed("rotationIndicator");P&&sa?(P=this.getSubmorphNamed("origin").center,Ta=Ta||this.addMorphBack(new Va.Path({name:"rotationIndicator",
borderColor:Va.haloBlue,borderWidth:1,vertices:[]})),Ta.setBounds(sa.bounds().union(this.innerBounds())),Ta.vertices=[Ta.localizePointFrom(P,this),Ta.localizePointFrom(sa.center,this)]):Ta&&Ta.remove()}},{key:"toggleMorphHighlighter",value:function(P,sa,Ta){Ta=void 0===Ta?!1:Ta;if(sa.onHaloGrabover)sa.onHaloGrabover(P);else Ta=Va.MorphHighlighter.for(this,sa,Ta),P&&sa&&sa!=this.world()?Ta&&Ta.show(sa):Ta&&Ta.deactivate()}},{key:"onMouseDown",value:function(P){var sa=P.state.clickedOnMorph;if(!P.isCommandKey()&&
sa==this.borderBox)return this.remove();if(P.isShiftDown()&&P.isCommandKey())P=this.target.isMorphSelection?this.target.morphBeneath(P.position):this.morphBeneath(P.position),this.isAlreadySelected(P)?this.removeMorphFromSelection(P):this.addMorphToSelection(P);else{if(sa==this.borderBox&&P.isCommandKey()){var Ta=P.world.morphsContainingPoint(P.position).filter(function(Ib){return Ib.halosEnabled});(Ta=Ta.slice(Ta.indexOf(this.target)+1)[0]||Ta[0]||P.world)&&P.world.showHaloFor(Ta,P.domEvt.pointerId);
this.remove()}sa==this&&P.isCommandKey()&&(Ta=this.morphBeneath(P.position),P.world.showHaloFor(Ta,P.domEvt.pointerId));sa==this&&this.remove()}}},{key:"onKeyUp",value:function(P){this.changingName||this.buttonControls.map(function(sa){return sa.onKeyUp(P)})}},{key:"getMesh",value:function(P,sa){var Ta=P.x;P=P.y;sa=void 0===sa?Va.pt(0,0):sa;var Ib=this.world().visibleBounds(),Lc=Ib.height;Ib=Ib.width;var Wc={borderStyle:"dotted",borderWidth:2,borderColor:Va.Color.orange};Wc=this.get("mesh")||this.addMorph(new Va.Morph({name:"mesh",
styleClasses:["halo-mesh"],extent:Va.pt(Ib,Lc),fill:null,submorphs:[new Va.Path(Object.assign({name:"vertical"},Wc)),new Va.Path(Object.assign({name:"horizontal"},Wc))]}));Wc.globalPosition=sa;Wc.getSubmorphNamed("vertical").vertices=[Va.pt(Ta,0).subPt(sa),Va.pt(Ta,Lc).subPt(sa)];Wc.getSubmorphNamed("horizontal").vertices=[Va.pt(0,P).subPt(sa),Va.pt(Ib,P).subPt(sa)];return Wc}}],[{key:"className",get:function(){return"Halo"}},{key:"properties",get:function(){return{fill:{defaultValue:Va.Color.transparent},
resizeOnly:{defaultValue:!1},pointerId:{},hasFixedPosition:{defaultValue:!0},respondsToVisibleWindow:{defaultValue:!0},submorphs:{after:["target"],initialize:function(){this.initButtons();this.alignWithTarget()}},layout:{after:["submorphs"],initialize:function(){this.initLayout()}},hasTinyTarget:{derived:!0,get:function(){return 40>this.target.bounds().extent().dist(Va.pt(0))}},target:{get:function(){return this.state?this.state.target:null},set:function(P){this.state||(this.state={});var sa=!!this.state.target;
this.detachFromTarget();P=this.prepareTarget(P);this.state.target=P;sa&&this.alignWithTarget();Va.connect(P,"onChange",this,"alignWithTarget");Va.connect(P,"onOwnerChanged",this,"removeIfDetached")}}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:895,end:16994})}(Va.Morph);Ab=Va.Halo;
var td=Ca("H",Ab);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("HaloPropertyDisplay")&&"function"===typeof Ha.HaloPropertyDisplay?Ha.HaloPropertyDisplay:Ha.HaloPropertyDisplay=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"isHaloItem",get:function(){return!1}},{key:"halo",get:function(){return this.owner}},{key:"displayedValue",value:function(){return this.textString}},
{key:"displayProperty",value:function(P){var sa=this.halo.state.activeButton;P=String(P);this.visible=!0;this.textString=P;this.position=this.constructor.defaultPosition;this.bounds().insetBy(10).intersects(sa.bounds())&&(this.position=Va.pt(sa.topRight.x+10,this.position.y))}},{key:"disable",value:function(){this.position=this.constructor.defaultPosition;this.visible=!1}}],[{key:"className",get:function(){return"HaloPropertyDisplay"}},{key:"morphName",get:function(){return"propertyDisplay"}},{key:"defaultPosition",
get:function(){return Va.pt(25,0)}},{key:"for",value:function(P){return P.getSubmorphNamed(this.morphName)||P.addMorph(new this({name:this.morphName}))}},{key:"properties",get:function(){return{name:{defaultValue:this.name},fill:{defaultValue:Va.Color.black.withA(.7)},borderRadius:{defaultValue:7},padding:{defaultValue:Va.Rectangle.inset(5)},visible:{defaultValue:!1},readOnly:{defaultValue:!0},fontSize:{defaultValue:12},fontColor:{defaultValue:Va.Color.white},position:{defaultValue:this.defaultPosition}}}}],
Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:17185,end:18532})})(Va.Label);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("MultiSelectionTarget")&&"function"===typeof Ha.MultiSelectionTarget?Ha.MultiSelectionTarget:Ha.MultiSelectionTarget=
function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"isHaloItem",get:function(){return!0}},{key:"isMorphSelection",get:function(){return!0}},{key:"selectsMorph",value:function(P){return this.selectedMorphs.includes(P)}},{key:"alignWithSelection",value:function(){var P=this.selectedMorphs.map(function(sa){return sa.globalBounds()}).reduce(function(sa,Ta){return sa.union(Ta)});this.setBounds(P)}},{key:"onGrab",
value:function(P){this.grabbingHand=P.hand;this.selectionGrabbed=!0;P.hand.grab(this.selectedMorphs);Va.once(P.hand,"dropMorphsOn",this,"onGrabEnd");Va.connect(P.hand,"position",this,"alignWithSelection")}},{key:"onGrabEnd",value:function(){this.selectionGrabbed=!1;Va.disconnectAll(this.grabbingHand)}},{key:"updateExtent",value:function(P){var sa=P.value.subPt(P.prevValue);this.selectedMorphs.forEach(function(Ta){return Ta.resizeBy(sa)})}},{key:"updatePosition",value:function(P){if(!this.selectionGrabbed){var sa=
P.value.subPt(P.prevValue);this.selectedMorphs.forEach(function(Ta){return Ta.moveBy(sa)})}}},{key:"updateRotation",value:function(P){var sa=this,Ta=P.value-P.prevValue;this.selectedMorphs.forEach(function(Ib){var Lc=Ib.origin;Ib.adjustOrigin(Ib.localize(sa.worldPoint(Va.pt(0,0))));Ib.rotation+=Ta;Ib.adjustOrigin(Lc)})}},{key:"updateScale",value:function(P){var sa=this,Ta=P.value-P.prevValue;this.selectedMorphs.forEach(function(Ib){var Lc=Ib.origin;Ib.adjustOrigin(Ib.localize(sa.worldPoint(Va.pt(0,
0))));Ib.scale+=Ta;Ib.adjustOrigin(Lc)})}},{key:"onChange",value:function(P){Qb._get(Object.getPrototypeOf(Kb.prototype),"onChange",this).call(this,P);if(this.modifiesSelectedMorphs){switch(P.prop){case "extent":this.updateExtent(P);break;case "scale":this.updateScale(P);break;case "position":this.updatePosition(P);break;case "rotation":this.updateRotation(P)}return P}}}],[{key:"className",get:function(){return"MultiSelectionTarget"}},{key:"properties",get:function(){return{visible:{defaultValue:!1},
modifiesSelectedMorphs:{defaultValue:!1},selectedMorphs:{defaultValue:[]}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:18600,end:20818})})(Va.Morph);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("HaloItem")&&"function"===typeof Ha.HaloItem?
Ha.HaloItem:Ha.HaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"menuItems",value:function(){return[]}},{key:"init",value:function(){}},{key:"update",value:function(){}},{key:"stop",value:function(){}},{key:"valueForPropertyDisplay",value:function(){}}],[{key:"className",get:function(){return"HaloItem"}},
{key:"properties",get:function(){return{borderRadius:{defaultValue:15},nativeCursor:{defaultValue:"pointer"},fill:{defaultValue:Va.Color.gray.withA(.7)},grabbable:{defaultValue:!1},extent:{defaultValue:Va.pt(24,24)},halo:{}}}},{key:"for",value:function(P){return P.getSubmorphNamed(this.morphName)||P.addMorph(new this({halo:P,name:this.morphName}))}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:20984,end:21661})})(Va.Morph);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("NameHolder")&&"function"===typeof Ha.NameHolder?Ha.NameHolder:Ha.NameHolder=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"onHoverIn",value:function(P){this.highlightOnHover&&this.nameHolder.active&&
(this.halo.toggleMorphHighlighter(!0,this.target),this.nameHolder.fontColor=Va.Color.orange)}},{key:"onHoverOut",value:function(P){this.highlightOnHover&&(this.halo.toggleMorphHighlighter(!1,this.target),this.nameHolder.fontColor=Va.Color.darkgray)}},{key:"accept",value:function(){this.target.name!==this.nameHolder.textString&&this.updateName(this.nameHolder.textString)}},{key:"onKeyDown",value:function(P){"Enter"==P.keyCombo?(this.accept(),P.stop()):Qb._get(Object.getPrototypeOf(Kb.prototype),"onKeyDown",
this).call(this,P)}},{key:"onMouseUp",value:function(){Va.signal(this,"active",[!0,this])}},{key:"onMouseDown",value:function(P){this.nameHolder.fontColor=Va.Color.white;this.halo.toggleMorphHighlighter(!1,this.target)}},{key:"onKeyUp",value:function(P){P=this.nameHolder.textString;var sa=this.target.owner;this.validName=!sa||!sa.getSubmorphNamed(P)||this.target.name==P;Va.signal(this,"valid",[this.validName,P])}},{key:"update",value:function(){var P=this;this.nameHolder.textString!==this.target.name&&
(this.nameHolder.textString=this.target.name,this.whenRendered().then(function(){return P.nameHolder.fit()}))}},{key:"activate",value:function(){this.nameHolder.readOnly=!1;this.nameHolder.active=!0;this.nameHolder.animate({opacity:1})}},{key:"deactivate",value:function(){this.nameHolder.readOnly=!0;this.nameHolder.active=!1;this.nameHolder.animate({opacity:.3})}},{key:"updateName",value:function(P){if(!this.forceUniqueName||this.validName)this.target.name=P,Va.signal(this,"active",[!1,this])}}],
[{key:"className",get:function(){return"NameHolder"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Click to edit the morph's name"},draggable:{defaultValue:!1},fill:{defaultValue:Va.Color.transparent},forceUniqueName:{defaultValue:!1},halo:{},layout:{after:["nameHolder"],initialize:function(){this.layout=new Va.HorizontalLayout({resizeContainer:!0,spacing:7})}},nameHolder:{after:["submorphs"],initialize:function(){this.nameHolder=this.addMorph(new Va.Text({fill:Va.Color.transparent,
fontColor:Va.Color.white,fontWeight:"bold",active:!0}));Va.connect(this.nameHolder,"onBlur",this,"accept")}}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21698,end:24232})})(Va.Morph);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("NameHaloItem")&&
"function"===typeof Ha.NameHaloItem?Ha.NameHaloItem:Ha.NameHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){Qb._get(Object.getPrototypeOf(Kb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,P);this.initNameHolders();this.validityIndicator=Va.Icon.makeLabel("check",{fontColor:Va.Color.green,fontSize:15,padding:Va.rect(4,
6,4,0)});this.fill=this.halo.target.isComponent?Va.componentAccent:Va.haloBlue;this.alignInHalo()}},{key:"targets",value:function(){return this.halo.target?this.halo.target.isMorphSelection?this.halo.target.selectedMorphs.map(function(P){return{target:P,highlightOnHover:!0}}):[{target:this.halo.target,highlightOnHover:!1}]:[]}},{key:"initNameHolders",value:function(){var P=this;this.nameHolders=this.targets().map(function(sa){sa=new Va.NameHolder({halo:P.halo,highlightOnHover:sa.highlightOnHover,
target:sa.target});Va.connect(sa,"active",P,"toggleActive");Va.connect(sa,"valid",P,"toggleNameValid");return sa});this.submorphs=Va.arr.interpose(this.nameHolders,{extent:Va.pt(1,28),fill:Va.Color.black.withA(.4)})}},{key:"toggleActive",value:function(P){P=$jscomp.makeIterator(P);var sa=P.next().value,Ta=P.next().value;this.halo.changingName!==sa&&((this.halo.changingName=sa)?(this.nameHolders.forEach(function(Ib){return Ib!=Ta&&Ib.deactivate()}),this.borderWidth=3,this.addMorph(this.validityIndicator),
this.fill=Va.Color.darkGray,setTimeout(function(){return Ta.nameHolder.selectAll()})):(this.fill=Va.haloBlue,this.nameHolders.forEach(function(Ib){return Ib!=Ta&&Ib.activate()}),this.borderWidth=0,this.validityIndicator.remove(),this.halo.focus()),this.alignInHalo())}},{key:"toggleNameValid",value:function(P){var sa=$jscomp.makeIterator(P);P=sa.next().value;sa=sa.next().value;(this.validName=P)?(this.conflictingMorph=null,this.borderColor=Va.Color.green,this.validityIndicator.nativeCursor="auto",
this.validityIndicator.fontColor=Va.Color.green,Va.Icon.setIcon(this.validityIndicator,"check")):(this.conflictingMorph=this.get(sa),this.borderColor=Va.Color.red,this.validityIndicator.fontColor=Va.Color.red,this.validityIndicator.nativeCursor="pointer",Va.Icon.setIcon(this.validityIndicator,"exclamation-circle"))}},{key:"alignInHalo",value:function(){Va.arr.zip(this.targets(),this.nameHolders).map(function(sa){var Ta=$jscomp.makeIterator(sa);sa=Ta.next().value.target;Ta=Ta.next().value;Ta.target=
sa;Ta.update()});var P=this.halo.innerBounds().bottomCenter().addPt(Va.pt(0,2));this.topCenter=Va.pt(Math.max(P.x,30),Math.max(P.y,80))}},{key:"onMouseDown",value:function(P){var sa=this,Ta=this.conflictingMorph;Ta&&(this.halo.toggleMorphHighlighter(!0,Ta),setTimeout(function(){return sa.halo.toggleMorphHighlighter(!1,Ta)},1E3))}}],[{key:"className",get:function(){return"NameHaloItem"}},{key:"morphName",get:function(){return"name"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:4},
fill:{defaultValue:Va.haloBlue},borderColor:{defaultValue:Va.Color.green},layout:{initialize:function(){this.layout=new Va.HorizontalLayout({resizeContainer:!0,spacing:0})}}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:24234,end:27401})})(Va.HaloItem);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Kb=Ha.hasOwnProperty("CloseHaloItem")&&"function"===typeof Ha.CloseHaloItem?Ha.CloseHaloItem:Ha.CloseHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"update",value:function(){var P=this.halo,sa=P.target.owner;sa.undoStart("close-halo");P.target.selectedMorphs?P.target.selectedMorphs.forEach(function(Ta){return Ta.remove()}):P.target.remove();sa.undoStop("close-halo");P.remove()}},{key:"onMouseDown",
value:function(P){this.update()}}],[{key:"className",get:function(){return"CloseHaloItem"}},{key:"morphName",get:function(){return"close"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["fas","fa-times"]},draggable:{defaultValue:!1},tooltip:{defaultValue:"Remove this morph from the world"}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:27404,end:28010})})(Va.HaloItem);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("GrabHaloItem")&&"function"===typeof Ha.GrabHaloItem?Ha.GrabHaloItem:Ha.GrabHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"adjustTarget",value:function(P,sa){Va.PropertyPath("owner.layout.autoResize").get(P)&&
!P.globalBounds().insetBy(10).containsPoint(sa)&&(P=P.owner);return P}},{key:"valueForPropertyDisplay",value:function(){var P=this.hand,sa=this.halo,Ta=this.prevDropTarget,Ib=P.world(),Lc=P.findDropTarget(P.globalPosition,[sa.target],function(Wc){return!Wc.isHaloItem&&!Wc.ownerChain().some(function(he){return he.isHaloItem||!he.visible||0==he.opacity})});Lc=this.adjustTarget(Lc,P.globalPosition);sa.toggleMorphHighlighter(Lc&&Lc!=Ib,Lc,!0);Ta&&Ta!=Lc&&sa.toggleMorphHighlighter(!1,Ta);return(this.prevDropTarget=
Lc)&&Lc.name}},{key:"init",value:function(P){var sa=this.halo,Ta=sa.target.undoStart("grab-halo");Ta&&Ta.addTarget(sa.target.owner);this.hand=P;sa.target.onGrab({halo:sa,hand:P,isShiftDown:function(){return!1}});sa.state.activeButton=this;this.opacity=.3;var Ib=Va.connect(P,"update",this,"update");Va.once(sa.target,"remove",function(){return Ib.disconnect()})}},{key:"stop",value:function(P){var sa=this.halo,Ta=this.prevDropTarget,Ib=sa.target.undoInProgress,Lc=P.hand.findDropTarget(P.hand.globalPosition,
[sa.target],function(Wc){return!Wc.isHaloItem&&!Wc.ownerChain().some(function(he){return he.isHaloItem})});Lc=this.adjustTarget(Lc,P.hand.globalPosition);Va.disconnect(P.hand,"update",this,"update");Va.MorphHighlighter.interceptDrop(sa,Lc,sa.target);Ib.addTarget(Lc);Lc.onDrop(P);sa.state.activeButton=null;sa.alignWithTarget();sa.toggleMorphHighlighter(!1,Ta);Va.MorphHighlighter.removeHighlighters(sa);sa.target.undoStop("grab-halo");this.opacity=1}},{key:"update",value:function(){this.halo.alignWithTarget()}},
{key:"onDragStart",value:function(P){this.init(P.hand)}},{key:"onDragEnd",value:function(P){this.stop(P)}}],[{key:"className",get:function(){return"GrabHaloItem"}},{key:"morphName",get:function(){return"grab"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["far","fa-hand-rock"]},tooltip:{defaultValue:"Grab the morph"},draggable:{defaultValue:!0}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:28013,end:30518})})(Va.HaloItem);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("DragHaloItem")&&"function"===typeof Ha.DragHaloItem?Ha.DragHaloItem:Ha.DragHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"valueForPropertyDisplay",value:function(){return this.halo.target.position}},
{key:"updateAlignmentGuide",value:function(P){var sa=this.halo.getSubmorphNamed("mesh");if(P)return sa=this.halo.getMesh(this.halo.target.worldPoint(Va.pt(0,0))),this.focus(),sa;sa&&sa.remove()}},{key:"init",value:function(){var P=this.halo.target;P.undoStart("drag-halo");this.halo.state.activeButton=this;this.actualPos=P.position;this.targetTransform=P.owner.getGlobalTransform().inverse()}},{key:"stop",value:function(){this.halo.target.undoStop("drag-halo");this.halo.state.activeButton=null;this.halo.alignWithTarget();
this.updateAlignmentGuide(!1);Va.removeSnapToGuidesOf(this.halo.target)}},{key:"update",value:function(P,sa,Ta){sa=void 0===sa?!1:sa;Ta=void 0===Ta?!1:Ta;this.actualPos=P=this.actualPos.addPt(this.targetTransform.transformDirection(P));sa&&(P=P.griddedBy(Va.pt(10,10)));this.halo.target.position=P;this.updateAlignmentGuide(sa);sa||Va.showAndSnapToGuides(this.halo.target,!0,Ta,5,500)}},{key:"onDragStart",value:function(P){this.init()}},{key:"onDrag",value:function(P){this.update(P.state.dragDelta,P.isAltDown(),
P.isCtrlDown())}},{key:"onDragEnd",value:function(P){this.stop()}},{key:"onKeyUp",value:function(P){this.updateAlignmentGuide(!1)}}],[{key:"className",get:function(){return"DragHaloItem"}},{key:"morphName",get:function(){return"drag"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},styleClasses:{defaultValue:["fas","fa-arrows-alt"]},tooltip:{defaultValue:"Change the morph's position. Press (alt) while dragging to align the morph's position along a grid."}}}}],Ha,{pathInPackage:function(){return"morph.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:30521,end:32332})})(Va.HaloItem);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("InspectHaloItem")&&"function"===typeof Ha.InspectHaloItem?Ha.InspectHaloItem:Ha.InspectHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"onMouseDown",value:function(P){var sa=this;(function(){var Ta,Ib,Lc,Wc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(he){if(1==he.nextAddress)return he.yield(System.import("lively.ide/js/inspector.js"),2);Ta=he.yieldResult;Ib=Ta.default;(Lc=sa.world().getSubmorphsByStyleClassName("Inspector").find(function(ie){return ie.targetObject==sa.halo.target}))&&(Wc=Lc.getWindow())?(Wc.minimized=!1,Wc.animate({center:sa.world().visibleBounds().center(),
duration:200})):Ib.openInWindow({targetObject:sa.halo.target});sa.halo.remove();he.jumpToEnd()})})()}}],[{key:"className",get:function(){return"InspectHaloItem"}},{key:"morphName",get:function(){return"inspect"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Inspect the morph's local state"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-cogs"]}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:32335,end:33237})})(Va.HaloItem);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("EditHaloItem")&&"function"===typeof Ha.EditHaloItem?Ha.EditHaloItem:Ha.EditHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,
oa,[{key:"onMouseDown",value:function(P){var sa=this;(P=this.world().getSubmorphsByStyleClassName("ObjectEditor").find(function(Ta){return Ta.target==sa.halo.target}))?(P=P.getWindow(),P.bringToFront(),P.minimized=!1,P.animate({center:this.world().visibleBounds().center(),duration:200})):$world.execCommand("open object editor",{target:this.halo.target});this.halo.remove()}}],[{key:"className",get:function(){return"EditHaloItem"}},{key:"morphName",get:function(){return"edit"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Edit the morph's definition"},
draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-wrench"]}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:33240,end:34022})})(Va.HaloItem);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("RotateHaloItem")&&"function"===
typeof Ha.RotateHaloItem?Ha.RotateHaloItem:Ha.RotateHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){Qb._get(Object.getPrototypeOf(Kb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,P);this.adaptAppearance(!1)}},{key:"angle",get:function(){return this.getProperty("angle")||0}},{key:"angle",set:function(P){this.setProperty("angle",
P)}},{key:"scaleGauge",get:function(){return this.getProperty("scaleGauge")||null}},{key:"scaleGauge",set:function(P){this.setProperty("scaleGauge",P)}},{key:"initRotation",get:function(){return this.getProperty("initRotation")||0}},{key:"initRotation",set:function(P){this.setProperty("initRotation",P)}},{key:"valueForPropertyDisplay",value:function(){var P=this.halo.target;return this.scaleGauge?P.scale.toFixed(4).toString():Va.num.toDegrees(P.rotation).toFixed(1)+"\u00b0"}},{key:"init",value:function(P){this.detachFromLayout();
this.halo.target.undoStart("rotate-halo");this.halo.state.activeButton=this;this.angle=P;this.initRotation=this.halo.target.rotation;this.halo.toggleRotationIndicator(!0,this)}},{key:"initScale",value:function(P){this.detachFromLayout();this.halo.state.activeButton=this;this.scaleGauge=P.scaleBy(1/this.halo.target.scale);this.halo.toggleRotationIndicator(!0,this)}},{key:"update",value:function(P){this.scaleGauge=null;P=this.initRotation+(P-this.angle);P=Va.num.toRadians(Va.num.detent(Va.num.toDegrees(P),
10,45));this.halo.target.rotation=P;this.halo.toggleRotationIndicator(!0,this)}},{key:"updateScale",value:function(P){var sa=this.scaleGauge,Ta=this.halo;sa||(sa=this.scaleGauge=P.scaleBy(1/Ta.target.scale));this.angle=P.theta();this.initRotation=Ta.target.rotation;Ta.target.scale=Va.num.detent(P.dist(Va.pt(0,0))/sa.dist(Va.pt(0,0)),.1,.5);Ta.toggleRotationIndicator(!0,this)}},{key:"stop",value:function(){this.attachToLayout();this.scaleGauge=null;this.halo.state.activeButton=null;this.halo.alignWithTarget();
this.halo.toggleRotationIndicator(!1,this);this.halo.target.undoStop("rotate-halo");this.halo.ensureResizeHandles()}},{key:"adaptAppearance",value:function(P){this.styleClasses=["fas",P?"fa-search-plus":"fa-redo"];this.tooltip=P?"Scale morph":"Rotate morph"}},{key:"detachFromLayout",value:function(){this.savedLayout=this.halo.layout;this.halo.layout=null}},{key:"attachToLayout",value:function(){this.halo.layout=this.savedLayout}},{key:"onDragStart",value:function(P){this.adaptAppearance(P.isShiftDown());
P.isShiftDown()?this.initScale(P.position.subPt(this.halo.target.globalPosition)):this.init(P.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDrag",value:function(P){this.globalPosition=P.position.addPt(Va.pt(-10,-10));this.adaptAppearance(P.isShiftDown());P.isShiftDown()?this.updateScale(P.position.subPt(this.halo.target.globalPosition)):this.update(P.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDragEnd",value:function(P){this.adaptAppearance(P.isShiftDown());
this.stop()}},{key:"onKeyDown",value:function(P){this.adaptAppearance(P.isShiftDown())}},{key:"onKeyUp",value:function(P){this.adaptAppearance(P.isShiftDown())}}],[{key:"className",get:function(){return"RotateHaloItem"}},{key:"morphName",get:function(){return"rotate"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:34024,end:37468})})(Va.HaloItem);Va.nameNumberRe=/(.+)([0-9]+)$/;(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("ComponentHaloItem")&&"function"===typeof Ha.ComponentHaloItem?Ha.ComponentHaloItem:Ha.ComponentHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"updateComponentIndicator",
value:function(){var P=this.world(),sa=this.halo.target;this.halo.remove();P.showHaloFor(sa)}},{key:"onMouseDown",value:function(){this.halo.target.isComponent=!this.halo.target.isComponent;this.updateComponentIndicator()}}],[{key:"className",get:function(){return"ComponentHaloItem"}},{key:"morphName",get:function(){return"component"}},{key:"properties",get:function(){return{tooltip:{get:function(){return this.halo.target.isComponent?"Retract Component":"Turn into Component"}},styleClasses:{initialize:function(){this.styleClasses=
this.halo.target.isComponent?["fas","fa-eraser"]:["fas","fa-cube"]}}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:37510,end:38256})})(Va.HaloItem);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("CopyHaloItem")&&"function"===typeof Ha.CopyHaloItem?
Ha.CopyHaloItem:Ha.CopyHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"init",value:function(P){function sa(kf,Qd){return Qd.match(Va.nameNumberRe)?Qd.replace(Va.nameNumberRe,function(qe,df,Af){Af||(Af="0");for(qe=Number(Af);kf.get(df+ ++qe););return df+qe}):Qd+"1"}var Ta=this.halo,Ib=Ta.target,Lc=Ta.world(),Wc=Ib instanceof Va.MultiSelectionTarget;Ta.remove();Va.connect(P,"update",this,
"update");if(Wc){var he=Ib.selectedMorphs.map(function(kf){return Lc.addMorph(kf.copy())});Wc=he.map(function(kf){kf.name=sa(Ib,kf.name);return kf.position});he[0].undoStart("copy-halo");Lc.addMorph(Ta);Ta.refocus(he);P.grab(Ta.target);Ta.target.onGrab({halo:Ta,hand:P,isShiftDown:function(){return!1}});Wc.forEach(function(kf,Qd){return he[Qd].globalPosition=kf});Ta.alignWithTarget()}else{Wc=Ib.globalPosition;var ie=Ib.copy();Ib.isComponent&&(ie.isComponent=!1,ie.withAllSubmorphsDoExcluding(function(kf){kf!=
ie&&kf.master||delete kf._parametrizedProps},function(kf){return kf.master&&kf!=ie}),ie.master=Ib);ie.name=sa(Ib,Ib.name);Lc.addMorph(ie);ie.globalPosition=Wc;ie.undoStart("copy-halo");P.grab(ie);Lc.addMorph(Ta);Ta.visible=!1}}},{key:"stop",value:function(P){var sa=this.halo,Ta=$jscomp.makeIterator(P.grabbedMorphs).next().value,Ib=P.findDropTarget(P.globalPosition,[sa.target],function(Wc){return!Wc.isHaloItem&&!Wc.ownerChain().some(function(he){return he.isHaloItem})}),Lc=sa.target.undoInProgress;
Va.disconnect(P,"update",this,"update");Lc.addTarget(Ib);P.dropMorphsOn(Ib);sa.target.undoStop("copy-halo");sa.remove();P.world().showHaloFor(Ta)}},{key:"onDragStart",value:function(P){this.init(P.hand)}},{key:"onDragEnd",value:function(P){this.stop(P.hand)}},{key:"update",value:function(){this.halo.alignWithTarget()}},{key:"copyToClipBoard",value:function(){var P=this,sa,Ta,Ib,Lc,Wc,he,ie,kf,Qd,qe,df,Af,rg,mg,Yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bf){switch(Bf.nextAddress){case 1:sa=
P;Ta=sa.halo;if(Ta.nameHalo().nameHolders.find(function(dg){return dg.nameHolder===$world.focusedMorph}))return Bf.return();Ib=Ta.target;Lc=Ta.world();Wc=Ib instanceof Va.MultiSelectionTarget;he=Ib.globalBounds().topLeft();ie=Wc?Ib.selectedMorphs:[Ib];kf=[];Qd='<!DOCTYPE html>\n          <html lang="en">\n          <head>\n            <meta charset="utf-8">\n            '+document.querySelector("#lively-morphic-css").outerHTML+"\n          </head>\n          <body>";Ta.remove();Bf.setCatchFinallyBlocks(2);
qe=$jscomp.makeIterator(ie);df=qe.next();case 4:if(df.done)return Qd+="</body></html>",mg=JSON.stringify(kf),Bf.yield(P.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/html",data:Qd},{type:"application/morphic",data:mg}]),8);Af=df.value;return Bf.yield(Va.createMorphSnapshot(Af,{addPreview:!1,testLoad:!1}),7);case 7:rg=Bf.yieldResult;rg.copyMeta={offset:Af.worldPoint(Va.pt(0,0)).subPt(he)};kf.push(rg);Qd+=Af.renderPreview();df=qe.next();Bf.jumpTo(4);break;case 8:Bf.leaveTryBlock(3);break;case 2:return Yc=
Bf.enterCatchBlock(),Lc.logError(Yc),Bf.return();case 3:Lc.addMorph(Ta),Ta.refocus(ie),Ta.setStatusMessage("copied"),Bf.jumpToEnd()}})}},{key:"onMouseUp",value:function(P){var sa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){P.stop();return Ta.yield(sa.copyToClipBoard(),0)})}}],[{key:"className",get:function(){return"CopyHaloItem"}},{key:"morphName",get:function(){return"copy"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},tooltip:{defaultValue:"Copy morph"},
styleClasses:{defaultValue:["far","fa-clone"]}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:38258,end:42247})})(Va.HaloItem);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("OriginHaloItem")&&"function"===typeof Ha.OriginHaloItem?
Ha.OriginHaloItem:Ha.OriginHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"fill",get:function(){return Va.Color.white.interpolate(.2,this.borderColorTop)}},{key:"extent",get:function(){return Va.pt(15,15)}},{key:"tooltip",get:function(){return"Change the morph's origin"}},{key:"computePositionAtTarget",value:function(){return this.halo.localize(this.halo.target.globalPosition)}},{key:"alignInHalo",
value:function(){this.visible=!this.halo.hasTinyTarget;this.center=this.computePositionAtTarget()}},{key:"valueForPropertyDisplay",value:function(){return this.halo.target.origin}},{key:"init",value:function(){this.halo.target.undoStart("origin-halo");this.halo.state.activeButton=this}},{key:"stop",value:function(){this.halo.target.undoStop("origin-halo");this.halo.state.activeButton=null;this.halo.alignWithTarget()}},{key:"update",value:function(P){var sa=this.halo,Ta=sa.target.origin,Ib=sa.target.worldPoint(Ta);
P=sa.target.localize(Ib.addPt(P)).subPt(sa.target.scroll).subPt(Ta);sa.target.adjustOrigin(sa.target.origin.addPt(P))}},{key:"onDragStart",value:function(P){this.init()}},{key:"onDragEnd",value:function(P){this.stop()}},{key:"onDrag",value:function(P){this.update(P.state.dragDelta)}}],[{key:"className",get:function(){return"OriginHaloItem"}},{key:"morphName",get:function(){return"origin"}},{key:"properties",get:function(){return{borderWidth:{defaultValue:3},nativeCursor:{defaultValue:"-webkit-grab"},
draggable:{defaultValue:!0},borderColor:{after:["halo"],initialize:function(){this.borderColor=this.halo.target.isComponent?Va.componentAccent:Va.haloBlue}}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:42250,end:43881})})(Va.HaloItem);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Kb=Ha.hasOwnProperty("ResizeHandle")&&"function"===typeof Ha.ResizeHandle?Ha.ResizeHandle:Ha.ResizeHandle=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"valueForPropertyDisplay",value:function(){var P=this.halo.target.extent,sa=P.y;return P.x.toFixed(1)+"x"+sa.toFixed(1)}},{key:"positionInHalo",value:function(){var P=this.halo.borderBox.bounds();this.halo.hasTinyTarget&&(Va.Rectangle.prototype.sides.includes(this.location)&&
(this.visible=!1),P=P.insetBy(-4));return P.partNamed(this.location)}},{key:"alignInHalo",value:function(){this.center=this.positionInHalo();return this}},{key:"onKeyUp",value:function(P){this.halo.state.activeButton==this&&this.halo.toggleDiagonal(P.isShiftDown(),this.corner)}},{key:"onKeyDown",value:function(P){this.halo.state.activeButton==this&&this.halo.toggleDiagonal(P.isShiftDown(),this.corner)}},{key:"onDragStart",value:function(P){this.init(P.position,P.isShiftDown())}},{key:"onDragEnd",
value:function(P){this.stop(P.isShiftDown())}},{key:"onDrag",value:function(P){this.update(P.position,P.isShiftDown(),P.isAltDown(),P.isCtrlDown());this.focus()}},{key:"init",value:function(P,sa){sa=void 0===sa?!1:sa;var Ta=this.halo.target,Ib=Ta.origin,Lc=Ta.position;Ta=Ta.extent;this.startPos=P;this.startBounds=Lc.subPt(Ib).extent(Ta);this.startOrigin=this.halo.target.origin;this.savedLayout=this.halo.layout;this.halo.layout=null;this.halo.state.activeButton=this;this.tfm=this.halo.target.getGlobalTransform().inverse();
P=this.halo.target.getGlobalTransform().getRotation();this.offsetRotation=Va.num.toRadians(P%45);this.halo.toggleDiagonal(sa,this.corner)}},{key:"update",value:function(P,sa,Ta,Ib){sa=void 0===sa?!1:sa;Ta=void 0===Ta?!1:Ta;Ib=void 0===Ib?!1:Ib;var Lc=this.corner,Wc=this.tfm;P=this.startPos.subPt(P);Wc=Wc.transformDirection(Va.pt(P.x,P.y));Ta&&(Wc=Wc.griddedBy(Va.pt(10,10)));this.halo.updateBoundsFor(Lc,sa,Wc,this.startBounds,this.startOrigin);this.halo.toggleDiagonal(sa,Lc);this.updateAlignmentGuide(Ta);
sa=[];Lc=Lc.toLowerCase();Lc.includes("left")&&sa.push("left");Lc.includes("top")&&sa.push("top");Lc.includes("bottom")&&sa.push("bottom");Lc.includes("right")&&sa.push("right");Va.showAndSnapToResizeGuides(this.halo.target,sa,!0,Ib,5,200)}},{key:"stop",value:function(P){P=this.halo;P.layout=this.savedLayout;P.state.activeButton=null;P.alignWithTarget();P.toggleDiagonal(!1);this.updateAlignmentGuide(!1);Va.removeSnapToGuidesOf(P.target)}},{key:"updateAlignmentGuide",value:function(P){var sa=this.halo.getSubmorphNamed("mesh");
if(P)return P=this.halo.target.extent,P=Va.pt(P.x%10,P.y%10),sa=this.halo.getMesh(this.globalPosition.addPt(this.extent.scaleBy(.5)),P),this.focus(),sa;sa&&sa.remove()}}],[{key:"className",get:function(){return"ResizeHandle"}},{key:"properties",get:function(){return{corner:{},location:{},draggable:{defaultValue:!0},isResizeHandle:{readOnly:!0,get:function(){return!0}}}}},{key:"getResizeParts",value:function(P){0<P&&(P-=360);P=-8-(P/45).toFixed();0==P&&(P=8);return Va.arr.zip(Va.arr.rotate([["topLeft",
function(sa){return sa.negated()}],["topCenter",function(sa){return sa.withX(0).negated()}],["topRight",function(sa){return sa.withX(0).negated()}],["rightCenter",function(sa){return Va.pt(0,0)}],["bottomRight",function(sa){return Va.pt(0,0)}],["bottomCenter",function(sa){return Va.pt(0,0)}],["bottomLeft",function(sa){return sa.withY(0).negated()}],["leftCenter",function(sa){return sa.withY(0).negated()}]],P),[["nwse-resize","topLeft"],["ns-resize","topCenter"],["nesw-resize","topRight"],["ew-resize",
"rightCenter"],["nwse-resize","bottomRight"],["ns-resize","bottomCenter"],["nesw-resize","bottomLeft"],["ew-resize","leftCenter"]])}},{key:"resizersFor",value:function(P){var sa=this;if(!P.target)return[];var Ta=P.target.getGlobalTransform().getRotation();return Va.arr.compact(this.getResizeParts(Ta).map(function(Ib){var Lc=$jscomp.makeIterator(Ib),Wc=$jscomp.makeIterator(Lc.next().value);Ib=Wc.next().value;Wc.next();Wc.next();Wc=$jscomp.makeIterator(Lc.next().value);Lc=Wc.next().value;Wc=Wc.next().value;
return sa.for(P,Ib,Wc,Lc)})).map(function(Ib){return Ib.alignInHalo()})}},{key:"for",value:function(P,sa,Ta,Ib){var Lc="Resize "+sa;P=P.getSubmorphNamed(Lc)||new this({name:Lc,halo:P,corner:sa,tooltip:"Resize "+sa,extent:Va.pt(10,10),borderWidth:1,borderRadius:0,borderColor:P.target.isComponent?Va.componentAccent:Va.haloBlue,fill:Va.Color.white});return Object.assign(P,{nativeCursor:Ib,location:Ta})}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:43941,end:49204})})(Va.HaloItem);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("MenuHaloItem")&&"function"===typeof Ha.MenuHaloItem?Ha.MenuHaloItem:Ha.MenuHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,
oa,[{key:"onMouseDown",value:function(P){var sa=this,Ta,Ib;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lc){if(1==Lc.nextAddress)return Ta=sa.halo.target,sa.halo.remove(),Lc.yield(Ta.menuItems(),2);Ib=Lc.yieldResult;Ta.world().openMenu(Ib).hasFixedPosition=sa.halo.hasFixedPosition;Lc.jumpToEnd()})}}],[{key:"className",get:function(){return"MenuHaloItem"}},{key:"morphName",get:function(){return"menu"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},tooltip:{defaultValue:"Opens the morph menu"},
styleClasses:{defaultValue:["fas","fa-bars"]}}}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:49207,end:49718})})(Va.HaloItem);var Pc=Ca("M",function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("MorphHighlighter")&&"function"===typeof Ha.MorphHighlighter?
Ha.MorphHighlighter:Ha.MorphHighlighter=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"alignWithHalo",value:function(){this.target&&(this.position=this.halo.localize(this.target.globalBounds().topLeft()),this.halo.isWorld&&(this.position=this.position.subPt(this.halo.scroll)),this.extent=this.target.globalBounds().extent(),this.get("name tag").value=this.target.name,this.get("name tag").topCenter=
this.innerBounds().insetBy(-10).bottomCenter())}},{key:"show",value:function(){if(this.target&&this.target.layout&&this.showLayout&&(this.layoutHalo=this.layoutHalo||this.world().showLayoutHaloFor(this.target,this.pointerId))&&this.layoutHalo.previewDrop){this.visible=!1;this.alignWithHalo();this.halo.get("grab").hand.grabbedMorphs&&this.layoutHalo.previewDrop(this.halo.get("grab").hand.grabbedMorphs);return}this.visible=!0;this.alignWithHalo()}},{key:"handleDrop",value:function(P){this.layoutHalo&&
this.layoutHalo.handleDrop(P)}},{key:"deactivate",value:function(){this.layoutHalo&&(this.layoutHalo.remove(),this.layoutHalo=null);this.visible=!1;this.alignWithHalo();this.remove()}}],[{key:"className",get:function(){return"MorphHighlighter"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},name:{defaultValue:"morphHighlighter"},styleClasses:{defaultValue:["inactive"]},reactsToPointer:{defaultValue:!1},hasFixedPosition:{defaultValue:!0},fill:{defaultValue:Va.Color.orange.withA(.3)},
borderWidth:{defaultValue:2},borderColor:{defaultValue:Va.Color.orange},halo:{},epiMorph:{defaultValue:!0},isHighlighter:{readOnly:!0,defaultValue:!0},highlightedSides:{defaultValue:[],set:function(P){var sa=this;this.setProperty("highlightedSides",P);this.submorphs=P.map(function(Ta){return{type:"ellipse",isHaloItem:!0,fill:Va.Color.orange,center:sa.innerBounds()[Ta]()}});this.addMorph({type:"label",name:"name tag",padding:Va.Rectangle.inset(5,5,5,5),fontColor:Va.Color.white,fill:Va.Color.orange,
borderRadius:3});this.alignWithHalo()}},showLayout:{defaultValue:!1},targetId:{},target:{readOnly:!0,derived:!0,get:function(){return(this.world()||this.env.world).getMorphWithId(this.targetId)}}}}},{key:"removeHighlighters",value:function(P){P=void 0===P?$world:P;var sa=P._morphHighlighters,Ta;for(Ta in sa)sa[Ta].remove();delete P._morphHighlighters}},{key:"for",value:function(P,sa,Ta,Ib){Ta=void 0===Ta?!1:Ta;Ib=void 0===Ib?[]:Ib;var Lc=P._morphHighlighters=P._morphHighlighters||{};Va.properties.forEachOwn(Lc,
function(Wc,he){return he.alignWithHalo()});if(!sa||sa.ownerChain().find(function(Wc){return Wc.isHaloItem}))return null;Lc[sa.id]=Lc[sa.id]||new this({targetId:sa.id,halo:P,showLayout:Ta});P.addMorph(Lc[sa.id]);Lc[sa.id].highlightedSides=Ib;return Lc[sa.id]}},{key:"interceptDrop",value:function(P,sa,Ta){(P=P._morphHighlighters=P._morphHighlighters||{},P[sa.id])&&P[sa.id].handleDrop(Ta)}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:49908,end:53420})}(Va.Morph));Va.MorphHighlighter=Pc;Va.MorphHighlighter=Pc;Va.MorphHighlighter=Pc;var Vb=Ca("I",function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Kb=Ha.hasOwnProperty("InteractiveMorphSelector")&&"function"===typeof Ha.InteractiveMorphSelector?Ha.InteractiveMorphSelector:Ha.InteractiveMorphSelector=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:Symbol.for("lively-instance-initialize"),value:function(P,sa,Ta){P=void 0===P?$world:P;this.controllingMorph=void 0===sa?null:sa;this.possibleTarget=this.morphHighlighter=this.selectorMorph=null;this.world=P;this.filterFn=Ta;this.whenDone=null}},{key:"selectNewTarget",value:function(){this.targetObject=null;var P=Va.promise.deferred();P.promise.resolve=P.resolve;this.whenDone=
P.promise;this.selectorMorph=Va.Icon.makeLabel("crosshairs",{fontSize:20,hasFixedPosition:!0,epiMorph:!0}).openInWorld();Va.connect(this.world.firstHand,"position",this,"scanForTargetAt");Va.once(this.selectorMorph,"onMouseDown",this,"selectTarget");Va.once(this.selectorMorph,"onKeyDown",this,"stopSelect");this.selectorMorph.focus();this.scanForTargetAt(this.world.firstHand.position)}},{key:"scanForTargetAt",value:function(){var P=this.world.firstHand.globalPosition;this.selectorMorph.center=P;this.selectorMorph.focus();
var sa=this.selectorMorph.morphBeneath(P),Ta,Ib=this.possibleTarget,Lc=this.controllingMorph,Wc=this.filterFn,he=this.world,ie=this.morphHighlighter;for(ie==sa?sa=ie.morphBeneath(P):sa&&sa.isEpiMorph&&(sa=sa.morphBeneath(P));sa&&(Ta=[sa].concat($jscomp.arrayFromIterable(sa.ownerChain())).find(function(kf){return!kf.visible}));)sa=Ta=Ta.morphBeneath(P);if(sa&&Wc&&!Wc(sa))for(;sa&&![sa].concat($jscomp.arrayFromIterable(sa.ownerChain())).find(Wc);)sa=sa.morphBeneath(P);!sa||sa==Ib||Lc&&sa.ownerChain().includes(Lc.getWindow())||
(ie&&ie.deactivate(),(this.possibleTarget=Ib=sa)&&!Ib.isWorld&&(P=this.morphHighlighter=Va.MorphHighlighter.for(he,sa))&&P.show())}},{key:"selectTarget",value:function(){this.targetObject=this.possibleTarget;this.stopSelect()}},{key:"stopSelect",value:function(){Va.MorphHighlighter.removeHighlighters(this.world);Va.disconnect(this.world.firstHand,"position",this,"scanForTargetAt");this.selectorMorph.remove();this.whenDone&&this.whenDone.resolve(this.targetObject)}}],[{key:"className",get:function(){return"InteractiveMorphSelector"}},
{key:"selectMorph",value:function(P,sa,Ta){P=new this(P,sa,Ta);P.selectNewTarget();return P.whenDone}}],Ha,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:53429,end:56174})}(void 0));Va.InteractiveMorphSelector=Vb;Va.InteractiveMorphSelector=Vb;Va.InteractiveMorphSelector=Vb;Va.default=Ab;var Oa=
lively.FreezerRuntime.recorderFor("lively.halos/markers.js");Oa.show=Ua;Oa.showRect=function(oa,Ha,Kb){var P=Oa.BoundsMarker.highlightBounds(Ha);return Kb?Oa.showInLoop(oa,P,Ha):Oa.showThenHide(oa,P)};Oa.showInLoop=function(oa,Ha,Kb){var P;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sa){switch(sa.nextAddress){case 1:return Oa.showThenHide(oa,Ha,!1),sa.yield(Oa.promise.delay(300),2);case 2:P=!1,Oa.once(oa,"onMouseDown",function(){return P=!0});case 3:if(P){sa.jumpTo(4);break}return sa.yield(Ha.retract(Kb),
3);case 4:Ha.fadeOut(2E3),sa.jumpToEnd()}})};Oa.showThenHide=function(oa,Ha,Kb){Kb=void 0===Kb?3:Kb;if(oa){var P=Array.isArray(Ha)?Ha:[Ha];P.forEach(function(sa){return oa.addMorph(sa)});Kb&&setTimeout(function(){return P.forEach(function(sa){return sa.fadeOut(2E3)})},1E3*Kb);return Ha}};Oa.showLine=function(oa,Ha,Kb){Kb=void 0===Kb?3E3:Kb;var P=Ha.start;Ha=Ha.end.subPt(P);var sa=oa.addMorph({position:P,rotation:Ha.theta(),border:{width:1,color:Oa.Color.red},width:Ha.fastR(),height:0});Kb&&setTimeout(function(){return sa.fadeOut()},
Kb);return sa};Oa.showConnector=fc;Oa.obj=Cc;Oa.promise=ld;Oa.string=xb;Oa.pt=Tb;Oa.Color=lc;Oa.Rectangle=eb;Oa.rect=nd;Oa.morph=mc;Oa.easings=Nb;Oa.Path=$c;Oa.Icon=pe;Oa.Morph=Zd;Oa.MorphicEnv=kb;Oa.connect=bc;Oa.once=hc;Oa.disconnect=ed;Oa.show=Ua;Oa.show=Ua;(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Kb=Ha.hasOwnProperty("BoundsMarker")&&"function"===typeof Ha.BoundsMarker?Ha.BoundsMarker:Ha.BoundsMarker=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:Symbol.for("lively-instance-initialize"),value:function(){Qb._get(Object.getPrototypeOf(Kb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{borderWidth:0,fill:Oa.Color.transparent,reactsToPointer:!1,hasFixedPosition:!0})}},{key:"isEpiMorph",get:function(){return!0}},{key:"markerLength",value:function(P){P=P.insetBy(-2);P=Math.min(P.width,P.height);return Math.max(4,Math.floor(10>P/10?P/
2-5:P/10))}},{key:"createMarkerEdge",value:function(){return Oa.morph({fill:Oa.Color.red,reactsToPointer:!1,borderRadius:10})}},{key:"ensureMarkerCorners",value:function(){var P=this.topLeftH||(this.topLeftH=this.addMorph(this.createMarkerEdge())),sa=this.topLeftV||(this.topLeftV=this.addMorph(this.createMarkerEdge())),Ta=this.topRightH||(this.topRightH=this.addMorph(this.createMarkerEdge())),Ib=this.topRightV||(this.topRightV=this.addMorph(this.createMarkerEdge())),Lc=this.bottomRightH||(this.bottomRightH=
this.addMorph(this.createMarkerEdge())),Wc=this.bottomRightV||(this.bottomRightV=this.addMorph(this.createMarkerEdge())),he=this.bottomLeftH||(this.bottomLeftH=this.addMorph(this.createMarkerEdge())),ie=this.bottomLeftV||(this.bottomLeftV=this.addMorph(this.createMarkerEdge()));return[P,sa,Ta,Ib,Lc,Wc,he,ie]}},{key:"alignWithMorph",value:function(P){return this.alignWithBounds(P.globalBounds().translatedBy($world.scroll.negated()))}},{key:"alignWithBounds",value:function(P){this.alignWithRect(P.insetBy(-20));
return this.alignWithRect(P,!0)}},{key:"alignWithRect",value:function(P,sa){var Ta=this.ensureMarkerCorners(),Ib=this.markerLength(P),Lc=[P.topLeft().addXY(0,0).extent(Oa.pt(Ib,5)),P.topLeft().addXY(0,0).extent(Oa.pt(5,Ib)),P.topRight().addXY(-Ib,0).extent(Oa.pt(Ib,5)),P.topRight().addXY(-5,0).extent(Oa.pt(5,Ib)),P.bottomRight().addXY(-5,-Ib).extent(Oa.pt(5,Ib)),P.bottomRight().addXY(-Ib,-5).extent(Oa.pt(Ib,5)),P.bottomLeft().addXY(0,-5).extent(Oa.pt(Ib,5)),P.bottomLeft().addXY(0,-Ib).extent(Oa.pt(5,
Ib))];Ta.forEach(function(Wc,he){return Wc.setBounds(Lc[he])});sa&&(this.adjustOrigin(P.center()),this.opacity=0,this.scale=1.5,this.animate({opacity:1,scale:1,duration:300}));return this}},{key:"retract",value:function(P){var sa=this,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ib){if(1==Ib.nextAddress)return Ib.yield(sa.animate({scale:Math.max(30/P.width,1.05)}),2);Ta=sa.center;return Ib.yield(sa.animate({center:Ta,scale:1,duration:300,easing:Oa.easings.inOutExpo}),0)})}}],[{key:"className",
get:function(){return"BoundsMarker"}},{key:"highlightMorph",value:function(P){return(new this).alignWithMorph(P)}},{key:"highlightBounds",value:function(P){return(new this).alignWithBounds(P)}}],Ha,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:2261,end:5920})})(Oa.Morph);Ab=Ca("S",function(oa){var Ha=
lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Kb=Ha.hasOwnProperty("StatusMessage")&&"function"===typeof Ha.StatusMessage?Ha.StatusMessage:Ha.StatusMessage=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"relayout",value:function(){this.title=Oa.string.truncate(this.message,(this.width/15).toFixed(),"...")}},{key:"isEpiMorph",value:function(){return!0}},{key:"isStatusMessage",value:function(){return!0}},
{key:"setMessage",value:function(P,sa){this.message=P;this.color=sa}},{key:"slideTo",value:function(P){var sa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return sa.sliding=sa.animate({position:P,duration:500}),Ta.yield(sa.sliding,2);sa.sliding=!1;Ta.jumpToEnd()})}},{key:"expand",value:function(){var P=this,sa,Ta,Ib,Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wc){if(1==Wc.nextAddress)return P.expandable?P.sliding?Wc.yield(P.sliding,2):
Wc.jumpTo(2):Wc.return();sa=P.world();if(!sa||P.isMaximized)return Wc.return();P.isMaximized=!0;P.stayOpen=!0;Ta=P.getSubmorphNamed("message text");Ta.lineWrapping=!1;Object.assign(Ta,{clipMode:"auto",fixedWidth:!0,selectable:!0});P.expandedContent&&(Ta.value=P.expandedContent);Ta.fit();Ib=Ta.textBounds().extent();Lc=sa.visibleBounds();Ib.y>Lc.extent().y&&(Ib.y=Lc.extent().y-20);Ib.x>Lc.extent().x&&(Ib.x=Lc.extent().x-20);Ib=P.extent.maxPt(Ib);P.animate({extent:Ib,center:Lc.center(),duration:200});
P.relayout();P.focus();Wc.jumpToEnd()})}},{key:"fit",value:function(){var P=this.getSubmorphNamed("message text");P&&(this.extent=Oa.pt(100,35).maxPt(P.textBounds().extent()),this.relayout())}},{key:"focus",value:function(){var P=this.getSubmorphNamed("message text");P&&P.focus()}},{key:"onMouseUp",value:function(P){this.expand()}}],[{key:"className",get:function(){return"StatusMessage"}},{key:"properties",get:function(){return{extent:{defaultValue:Oa.pt(200,100)},stayOpen:{defaultValue:!1},slidable:{defaultValue:!0},
isMaximized:{defaultValue:!1},expandable:{initialize:function(){this.expandable=!0}},maxLines:{defaultValue:Infinity},name:{defaultValue:"messageMorph"},master:{initialize:function(){this.master={auto:"styleguide://System/message"}}},message:{after:["submorphs","extent"],set:function(P){this.setProperty("message",P);var sa=this.getSubmorphNamed("message text");if(sa){sa.value=P;var Ta=sa.documentEndPosition;Ta.row>this.maxLines&&(sa.replace({start:{row:this.maxLines,column:0},end:Ta},"...\n"),this.expandedContent||
(this.expandedContent=P));Ta=sa.documentEndPosition;0!==Ta.column&&sa.insertText("\n",Ta)}}},title:{isStyleProp:!0,derived:!0,set:function(P){this.getSubmorphNamed("message title").value=P},get:function(){return this.getSubmorphNamed("message title").value}},color:{after:["submorphs"],derived:!0,get:function(){return this.get("message icon").fontColor},set:function(P){this.get("message icon").fontColor=P;this.get("message icon")._parametrizedProps&&(this.get("message icon")._parametrizedProps.fontColor=
P)}},submorphs:{after:["extent"],initialize:function(){this.submorphs=[{name:"message icon",type:"label",value:Oa.Icon.textAttribute("check-circle")},{name:"message text",type:"text"},{name:"message title",type:"label"},{name:"close button",type:"button"}];Oa.connect(this.getSubmorphNamed("close button"),"fire",this,"remove");Oa.connect(this,"extent",this,"relayout")}}}}}],Ha,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:5964,end:10242})}(Oa.Morph));Oa.StatusMessage=Ab;Oa.StatusMessage=Ab;Oa.StatusMessage=Ab;var Qa=Ca("b",function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Kb=Ha.hasOwnProperty("StatusMessageForMorph")&&"function"===typeof Ha.StatusMessageForMorph?Ha.StatusMessageForMorph:Ha.StatusMessageForMorph=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Qb(Kb,oa,[{key:"alignAtBottomOf",value:function(P){var sa=this.world();sa&&(this.bringToFront(),this.fit(),this.width=P.bounds().width,this.relayout(),P.world()&&(this.position=P.owner.worldPoint(P.bounds().bottomLeft())),P=sa.visibleBounds(),P=this.bounds().top()+this.height-P.bottom(),0<P&&this.moveBy(Oa.pt(0,-P)))}},{key:"onMouseUp",value:function(P){}}],[{key:"className",get:function(){return"StatusMessageForMorph"}},{key:"properties",get:function(){return{slidable:{defaultValue:!1},
renderOnGPU:{defaultValue:!0},removeOnTargetMorphChange:{defaultValue:!0},targetMorph:{defaultValue:null,get:function(){var P=this.getProperty("targetMorph");return P&&$world.getMorphWithId(P)},set:function(P){this.setProperty("targetMorph",P?P.id:null);this.alignAtBottomOf(P)}},expandable:{after:["submorphs"],set:function(P){this.setProperty("expandable",P);if(P){var sa=this.getSubmorphNamed("expand button")||this.addMorph({name:"expand button",type:"button"});Oa.connect(sa,"fire",this,"expand")}else this.getSubmorphNamed("expand button")&&
(this.getSubmorphNamed("expand button").remove(),Oa.disconnect(sa,"fire",this,"expand"))}}}}}],Ha,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10467,end:12318})}(Oa.StatusMessage));Oa.StatusMessageForMorph=Qa;Oa.StatusMessageForMorph=Qa;Oa.StatusMessageForMorph=Qa;Oa.showConnector=fc;Oa.showConnector=
fc;var Aa=lively.FreezerRuntime.recorderFor("lively.ide/index.js");Aa.info="import via sub modules";Aa.info="import via sub modules";Aa.info="import via sub modules";var za=Ca("v",{});Aa.valueWidgets=za;Aa.valueWidgets=za;Aa.valueWidgets=za;var Ka=Ca("p",{});Aa.popovers=Ka;Aa.popovers=Ka;Aa.popovers=Ka;var tb=lively.FreezerRuntime.recorderFor("lively.components/popup.js");tb.Morph=Zd;tb.VerticalLayout=Db;tb.StyleSheet=ce;tb.Icon=pe;tb.CustomLayout=Rb;tb.Color=lc;tb.rect=nd;tb.pt=Tb;tb.connect=bc;
tb.Path=qc;tb.duration=300;Aa=Ca("P",function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.components/popup.js"),Kb=Ha.hasOwnProperty("Popover")&&"function"===typeof Ha.Popover?Ha.Popover:Ha.Popover=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"relayout",value:function(P){var sa=this.get("body"),Ta=this.get("arrow"),Ib=this.get("close button");Ta=Ta.height;P?(sa.animate({topCenter:tb.pt(0,
Ta),duration:200}),Ib.animate({topRight:sa.topRight.addXY(8,-8),duration:200})):(sa.topCenter=tb.pt(0,Ta),Ib.topRight=sa.topRight.addXY(8,-8))}},{key:"close",value:function(){this.fadeOut(300)}}],[{key:"className",get:function(){return"Popover"}},{key:"properties",get:function(){return{epiMorph:{defaultValue:!0},hasFixedPosition:{defaultValue:!0},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/popover/light"}}},targetMorph:{derived:!0,after:["submorphs"],defaultValue:{extent:tb.pt(200,
200),fill:tb.Color.transparent,submorphs:[{name:"placeholder",type:"label",value:"No Target Specified"}]},get:function(){return this.get("body").submorphs[0]},set:function(P){var sa=this;this.get("body").addMorph(P);this.whenRendered().then(function(){return sa.relayout()})}},submorphs:{initialize:function(){var P=this;this.submorphs=[{type:"polygon",name:"arrow",topCenter:tb.pt(0,0),borderColor:tb.Color.transparent,vertices:[tb.pt(-10,0),tb.pt(0,-15),tb.pt(10,0)]},{name:"body"},{name:"close button",
type:"button",label:Object.assign(tb.Icon.makeLabel("times-circle"),{fontSize:18}),tooltip:"close",fill:null,extent:tb.pt(16,16),borderColor:tb.Color.transparent}];var sa=$jscomp.makeIterator(this.submorphs);sa.next();var Ta=sa.next().value;sa=sa.next().value;tb.connect(sa,"fire",this,"close");tb.connect(Ta,"extent",this,"relayout",{converter:"() => target.animated"});setTimeout(function(){return P.animated=!0},1E3)}}}}}],Ha,{pathInPackage:function(){return"popup.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.components",version:"0.1.0"}}},{start:247,end:2617})}(tb.Morph));tb.Popover=Aa;tb.Popover=Aa;tb.Popover=Aa;var yb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js");yb.Morph=Zd;yb.TilingLayout=vc;yb.morph=mc;yb.Label=id;yb.HorizontalLayout=kd;yb.Icon=pe;yb.InputLine=jc;yb.config=qb;yb.connect=bc;yb.signal=ad;yb.Color=lc;yb.LinearGradient=Hb;yb.pt=Tb;yb.rect=nd;yb.num=Xc;yb.obj=
Cc;yb.popovers=Ka;yb.ValueScrubber=rb;yb.Popover=Aa;(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("ContextSensitiveWidget")&&"function"===typeof Ha.ContextSensitiveWidget?Ha.ContextSensitiveWidget:Ha.ContextSensitiveWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,void 0,[{key:"className",get:function(){return"ContextSensitiveWidget"}},
{key:"properties",get:function(){return{fill:{defaultValue:yb.Color.transparent},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?yb.Color.white:yb.Color.black}},layout:{initialize:function(){this.layout=new yb.HorizontalLayout}},context:{serialize:!1}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1872,end:2439})})(yb.Morph);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("ShortcutWidget")&&"function"===typeof Ha.ShortcutWidget?Ha.ShortcutWidget:Ha.ShortcutWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"onMouseDown",value:function(P){this.openPopover()}},
{key:"openPopover",value:function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(P){P.jumpToEnd()})}}],[{key:"className",get:function(){return"ShortcutWidget"}},{key:"properties",get:function(){return{title:{defaultValue:"No Title",after:["submorphs"],set:function(P){this.setProperty("title",P);this.getSubmorphNamed("valueString").value=P}},nativeCursor:{defaultValue:"pointer"},fontColor:{derived:!0,set:function(P){this.submorphs.forEach(function(sa){return sa.fontColor=P})}},submorphs:{initialize:function(){this.submorphs=
[yb.Icon.makeLabel("arrow-right",{styleClasses:["TreeLabel"],fontSize:15,padding:yb.rect(1,1,4,1)}),{type:"label",value:this.title,styleClasses:["TreeLabel"],fontWeight:"bold",name:"valueString",opacity:.8,borderRadius:5,padding:yb.rect(0,0,0,2),nativeCursor:"pointer",fontSize:12,borderWidth:0}]}}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:2441,end:3667})})(yb.ContextSensitiveWidget);Ka=function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("LayoutWidget")&&"function"===typeof Ha.LayoutWidget?Ha.LayoutWidget:Ha.LayoutWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"layoutChanged",value:function(){this.title=this.context.layout?"Configure "+this.context.layout.name()+
" Layout":"No Layout"}},{key:"openPopover",value:function(){var P=this,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return sa=new yb.popovers.LayoutPopover({hasFixedPosition:!!P.ownerChain().find(function(Ib){return Ib.hasFixedPosition}),container:P.context}),Ta.yield(sa.fadeIntoWorld(P.globalBounds().center()),2);yb.connect(sa,"layoutChanged",P,"layoutChanged");yb.signal(P,"openWidget",sa);Ta.jumpToEnd()})}}],[{key:"className",get:function(){return"LayoutWidget"}},
{key:"properties",get:function(){return{title:{after:["submorphs"],initialize:function(){this.title=this.context&&this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3676,end:4493})}(yb.ShortcutWidget);
yb.LayoutWidget=Ka;yb.LayoutWidget=Ka;yb.LayoutWidget=Ka;Aa=function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("ColorWidget")&&"function"===typeof Ha.ColorWidget?Ha.ColorWidget:Ha.ColorWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"relayout",value:function(P){P?this.submorphs=this.color?this.color.isGradient?this.renderGradientValue():
this.renderColorValue():this.renderNoColor():this.color&&(this.color.isGradient?this.updateGradientValue():this.updateColorValue())}},{key:"updateGradientValue",value:function(){var P=this.color;if(2*P.stops.length==this.submorphs.length-3){var sa;for(sa in this.color.stops){var Ta=P.stops[sa];var Ib=Ta.color,Lc=Ta.offset,Wc=$jscomp.makeIterator(this.submorphs[2+2*sa].submorphs).next().value;Ta=this.submorphs[3+2*sa];Wc.fill=Ib;Ta.value=(100*Lc).toFixed()+"%"+(sa<P.stops.length-1?",":"")}}else this.submorphs=
this.renderGradientValue()}},{key:"renderGradientValue",value:function(){return[{type:"label",styleClasses:["TreeLabel"],value:this.color.type+"(",name:"valueString"}].concat($jscomp.arrayFromIterable(this.renderStops()),[{type:"label",styleClasses:["TreeLabel"],value:")"}])}},{key:"updateColorValue",value:function(){this.getSubmorphNamed("color box").fill=this.color;this.getSubmorphNamed("valueString").value=yb.obj.safeToString(this.color)}},{key:"renderNoColor",value:function(){return[{extent:yb.pt(15,
15),fill:yb.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:yb.pt(5,7.5),fill:yb.Color.white,borderColor:yb.Color.gray.darker(),borderWidth:1,submorphs:[{type:"path",name:"no fill",vertices:[yb.pt(0,0),yb.pt(10,10)],borderColor:yb.Color.red}]}]},{type:"label",value:"No Color",fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderColorValue",value:function(){return[{extent:yb.pt(15,15),fill:yb.Color.transparent,submorphs:[{styleClasses:["colorValue"],
name:"color box",center:yb.pt(5,7.5),fill:this.color,borderColor:yb.Color.gray.darker(),nativeCursor:"pointer",borderWidth:1}]},{type:"label",value:yb.obj.safeToString(this.color),fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderStops",value:function(){var P=this.color,sa=[{type:"label",padding:yb.rect(0,0,5,0),value:"linearGradient"==P.type?yb.num.toDegrees(P.vectorAsAngle()).toFixed()+"\u00b0,":""}],Ta;for(Ta in P.stops){var Ib=P.stops[Ta],Lc=Ib.color;Ib=Ib.offset;sa.push({extent:yb.pt(this.fontSize,
this.fontSize),fill:yb.Color.transparent,layout:new yb.HorizontalLayout({spacing:3}),submorphs:[{styleClasses:["colorValue"],fill:Lc}]});sa.push({type:"label",padding:yb.rect(0,0,5,0),value:(100*Ib).toFixed()+"%"+(Ta<P.stops.length-1?",":"")})}return sa}},{key:"onMouseDown",value:function(P){this.openFillEditor()}},{key:"update",value:function(P){this.color=P}},{key:"openFillEditor",value:function(){var P=this,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return sa=
new yb.popovers.FillPopover({hasFixedPosition:!!P.ownerChain().find(function(Ib){return Ib.hasFixedPosition}),handleMorph:P.context,fillValue:P.color,title:"Fill Control",gradientEnabled:P.gradientEnabled}),Ta.yield(sa.fadeIntoWorld(P.globalBounds().center()),2);yb.connect(sa,"fillValue",P,"update");yb.signal(P,"openWidget",sa);Ta.jumpToEnd()})}}],[{key:"className",get:function(){return"ColorWidget"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new yb.HorizontalLayout({direction:"centered"})}},
selectionFontColor:{defaultValue:yb.Color.white},nonSelectionFontColor:{defaultValue:yb.Color.black},color:{defaultValue:yb.Color.blue},gradientEnabled:{defaultValue:!1},fontSize:{defaultValue:14},isSelected:{after:["submorphs"],set:function(P){this.getProperty("isSelected")!=P&&(this.getSubmorphNamed("valueString").fontColor=P?this.selectionFontColor:this.nonSelectionFontColor,this.setProperty("isSelected",P))}},submorphs:{after:["nonSelectionFontColor","selectionFontColor"],initialize:function(){yb.connect(this,
"color",this,"relayout",{converter:function(P,sa){return(sa&&sa.isColor)!=(P&&P.isColor)}});this.relayout(!0)}}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:4557,end:9992})}(yb.ContextSensitiveWidget);yb.ColorWidget=Aa;yb.ColorWidget=Aa;yb.ColorWidget=Aa;var zc=function(oa){var Ha=
lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("BooleanWidget")&&"function"===typeof Ha.BooleanWidget?Ha.BooleanWidget:Ha.BooleanWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"onMouseDown",value:function(P){this.boolean=!this.boolean}}],[{key:"className",get:function(){return"BooleanWidget"}},{key:"properties",get:function(){return{fontFamily:{defaultValue:yb.config.codeEditor.defaultStyle.fontFamily},
nativeCursor:{defaultValue:"pointer"},boolean:{set:function(P){this.setProperty("boolean",P);this.value=yb.obj.safeToString(P);this.fontColor=this.boolean?yb.Color.green:yb.Color.red}}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10001,end:10481})}(yb.Label);yb.BooleanWidget=
zc;yb.BooleanWidget=zc;yb.BooleanWidget=zc;var pd=Ca("N",function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("NumberWidget")&&"function"===typeof Ha.NumberWidget?Ha.NumberWidget:Ha.NumberWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"onMouseDown",value:function(P){Qb._get(Object.getPrototypeOf(Kb.prototype),"onMouseDown",this).call(this,
P);"up"==P.targetMorph.name&&this.increment();"down"==P.targetMorph.name&&this.decrement()}},{key:"spec",value:function(){return yb.obj.dissoc(Qb._get(Object.getPrototypeOf(Kb.prototype),"spec",this).call(this),["submorphs"])}},{key:"update",value:function(P,sa){sa=void 0===sa?!0:sa;this.setProperty("number",sa?P/this.scaleFactor:P);yb.signal(this,"number",this.number);this.relayout(sa)}},{key:"relayoutButtons",value:function(){var P=this.getSubmorphNamed("up"),sa=this.getSubmorphNamed("down");this.getSubmorphNamed("value");
P.height=sa.height=(this.height-2)/2;P.width=sa.width=20}},{key:"onChange",value:function(P){Qb._get(Object.getPrototypeOf(Kb.prototype),"onChange",this).call(this,P);"extent"!=P.prop||this.autofit||this.relayout()}},{key:"relayout",value:function(P){var sa=this.getSubmorphNamed("value");sa&&(this.autofit?(P||(sa.value=this.number*this.scaleFactor),sa.fit(),this.height=sa.height,this.width=sa.width+20):P||(sa.width=this.width-20),this.relayoutButtons(),P||(sa.value=yb.num.roundTo(this.number*this.scaleFactor,
1),sa.min=-Infinity!=this.min?this.min*this.scaleFactor:this.min,sa.max=Infinity!=this.max?this.max*this.scaleFactor:this.max,sa.unit=this.unit))}},{key:"increment",value:function(){void 0!=this.max&&this.number>=this.max||this.update(this.number+1/this.scaleFactor,!1)}},{key:"decrement",value:function(){void 0!=this.min&&this.number<=this.min||this.update(this.number-1/this.scaleFactor,!1)}}],[{key:"className",get:function(){return"NumberWidget"}},{key:"properties",get:function(){return{unit:{},
autofit:{defaultValue:!0,after:["submorphs","extent"],set:function(P){this.setProperty("autofit",P);this.getSubmorphNamed("value").scaleToBounds=!P}},number:{defaultValue:0,after:["unit","autofit"],set:function(P){this.setProperty("number",P);this.relayout(!1)}},min:{defaultValue:-Infinity},max:{defaultValue:Infinity},floatingPoint:{after:["number","submorphs"],set:function(P){this.setProperty("floatingPoint",P);this.get("value").floatingPoint=P},get:function(){var P=/[+-]?([0-9]*[.])?[0-9]+/.exec(this.number);
return this.getProperty("floatingPoint")||1==this.scaleFactor&&P&&!!P[1]}},padding:{isStyleProp:!0,defaultValue:yb.rect(5,3,0,0),after:["submorphs"],set:function(P){this.setProperty("padding",P);this.getSubmorphNamed("value").padding=P}},extent:{defaultValue:yb.pt(70,25)},scaleFactor:{defaultValue:1,get:function(){return this.getProperty("scaleFactor")||1}},baseFactor:{after:["submorphs"],derived:!0,get:function(){return this.get("value").baseFactor},set:function(P){this.get("value").baseFactor=P}},
styleClasses:{defaultValue:["unfocused"]},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/number field/light"}}},fontColor:{isStyleProp:!0,defaultValue:yb.Color.rgbHex("#0086b3"),set:function(P){this.setProperty("fontColor",P)}},isSelected:{set:function(P){this.getProperty("isSelected")!=P&&(P?(this.addStyleClass("selected"),this.removeStyleClass("unselected")):(this.removeStyleClass("selected"),this.addStyleClass("unselected")),this.setProperty("isSelected",P))}},fontFamily:{defaultValue:"Sans-Serif",
isStyleProp:!0,set:function(P){this.setProperty("fontFamily",P)}},fontSize:{defaultValue:15,isStyleProp:!0,set:function(P){this.setProperty("fontSize",P)}},layout:{initialize:function(){this.layout=new yb.TilingLayout({axis:"column",orderByIndex:!0,align:"center"})}},submorphs:{after:["min","max"],initialize:function(){var P=this;this.submorphs=[new yb.ValueScrubber({name:"value",unit:this.unit,floatingPoint:this.floatingPoint,scaleToBounds:!1,min:this.min,max:this.max}),yb.Icon.makeLabel("sort-up",
{name:"up"}),yb.Icon.makeLabel("sort-up",{name:"down",rotation:Math.PI})];yb.connect(this.get("value"),"scrub",this,"update");this.whenRendered().then(function(){return P.relayout()})}}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10490,end:16340})}(yb.Morph));yb.NumberWidget=
pd;yb.NumberWidget=pd;yb.NumberWidget=pd;var Yd=function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("ShadowWidget")&&"function"===typeof Ha.ShadowWidget?Ha.ShadowWidget:Ha.ShadowWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==
Ta.nextAddress)return sa=new yb.popovers.ShadowPopover({hasFixedPosition:!!P.ownerChain().find(function(Ib){return Ib.hasFixedPosition}),shadowValue:P.shadowValue}),Ta.yield(sa.fadeIntoWorld(P.globalBounds().center()),2);yb.connect(sa,"shadowValue",P,"shadowValue");yb.connect(P,"shadowValue",P,"update");yb.signal(P,"openWidget",sa);Ta.jumpToEnd()})}},{key:"update",value:function(){this.renderShadowDisplay()}},{key:"renderShadowDisplay",value:function(){this.shadowValue?1<this.submorphs.length?this.updateShadowDisplay():
this.initShadowDisplay():this.submorphs=[{opacity:.8,reactsToPointer:!1,styleClasses:["TreeLabel"],name:"valueString",type:"label",value:"No Shadow"}]}},{key:"updateShadowDisplay",value:function(){var P=this.shadowValue,sa=P.blur,Ta=P.spread,Ib=P.distance;P=P.color;var Lc=$jscomp.makeIterator(this.submorphs),Wc=Lc.next().value,he=Lc.next().value;he=$jscomp.makeIterator(he.submorphs).next().value;Lc=Lc.next().value;Wc.value=(this.shadowValue.inset?"inset":"drop")+"-shadow(";he.fill=P;Lc.value=", "+
sa+"px, "+Ib+"px, "+Ta+"px)"}},{key:"initShadowDisplay",value:function(){var P=this.shadowValue,sa=P.blur,Ta=P.spread,Ib=P.distance;P=P.color;this.submorphs=[{name:"valueString",opacity:.7,reactsToPointer:!1,type:"label",value:(this.shadowValue.inset?"inset":"drop")+"-shadow("},yb.morph({fill:yb.Color.transparent,extent:yb.pt(this.fontSize+6,this.fontSize+4),submorphs:[{extent:yb.pt(this.fontSize,this.fontSize),position:yb.pt(2,2),fill:P,borderColor:yb.Color.black,borderWidth:1}]}),{name:"valueString",
type:"label",opacity:.7,reactsToPointer:!1,value:", "+sa+"px, "+Ib+"px, "+Ta+"px)"}]}}],[{key:"className",get:function(){return"ShadowWidget"}},{key:"properties",get:function(){return{shadowValue:{after:["submorphs"],defaultValue:null,set:function(P){this.setProperty("shadowValue",P);this.renderShadowDisplay()}},fill:{defaultValue:yb.Color.transparent},nativeCursor:{defaultValue:"pointer"},fontSize:{defaultValue:12},fontColor:{derived:!0,set:function(P){this.submorphs.forEach(function(sa){return sa.fontColor=
P})}},isSelected:{defaultValue:!1,set:function(P){this.setProperty("isSelected",P);this.fontColor=P?yb.Color.white:yb.Color.black}},layout:{initialize:function(){this.layout=new yb.HorizontalLayout}},submorphs:{initialize:function(){this.update()}}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:16349,end:19359})}(yb.Morph);yb.ShadowWidget=Yd;yb.ShadowWidget=Yd;yb.ShadowWidget=Yd;var Ge=function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("PointWidget")&&"function"===typeof Ha.PointWidget?Ha.PointWidget:Ha.PointWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",
value:function(){var P=this,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return sa=new yb.popovers.PointPopover({pointValue:P.pointValue,hasFixedPosition:!!P.ownerChain().find(function(Ib){return Ib.hasFixedPosition})}),Ta.yield(sa.fadeIntoWorld(P.globalBounds().center()),2);yb.connect(sa,"pointValue",P,"pointValue");yb.signal(P,"openWidget",sa);Ta.jumpToEnd()})}}],[{key:"className",get:function(){return"PointWidget"}},{key:"properties",get:function(){return{isSelected:{defaultValue:"false",
set:function(P){this.setProperty("isSelected",P);this.fontColor=P?this.selectionFontColor:this.nonSelectionFontColor}},selectionFontColor:{isStyleProp:!0,defaultValue:yb.Color.white},nonSelectionFontColor:{isStyleProp:!0,defaultValue:yb.Color.black},fontFamily:{defaultValue:yb.config.codeEditor.defaultStyle.fontFamily},nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},pointValue:{after:["textAndAttributes"],set:function(P){var sa=yb.Color.rgbHex("#0086b3");this.setProperty("pointValue",
P);this.textAndAttributes=["pt(",null,P.x.toFixed(),{fontColor:sa},",",{},P.y.toFixed(),{fontColor:sa},")",null];this.fixedHeight=this.fixedWidth=!0;this.height=20;this.width=this.textString.length*this.fontSize}}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:19368,end:20996})}(yb.Label);
yb.PointWidget=Ge;yb.PointWidget=Ge;yb.PointWidget=Ge;var Sc=function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("PaddingWidget")&&"function"===typeof Ha.PaddingWidget?Ha.PaddingWidget:Ha.PaddingWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=
this,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return sa=new yb.popovers.RectanglePopover({hasFixedPosition:!!P.ownerChain().find(function(Ib){return Ib.hasFixedPosition}),rectangle:P.rectangle}),sa.relayout(),Ta.yield(sa.fadeIntoWorld(P.globalBounds().center()),2);yb.connect(sa,"rectangle",P,"rectangle");yb.signal(P,"openWidget",sa);Ta.jumpToEnd()})}}],[{key:"className",get:function(){return"PaddingWidget"}},{key:"properties",get:function(){return{nativeCursor:{defaultValue:"pointer"},
styleClasses:{defaultValue:["TreeLabel"]},fontFamily:{defaultValue:yb.config.codeEditor.defaultStyle.fontFamily},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?yb.Color.white:yb.Color.black}},rectangle:{defaultValue:yb.rect(0),set:function(P){this.setProperty("rectangle",P);this.value=yb.obj.safeToString(P)}}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:21005,end:22054})}(yb.Label);yb.PaddingWidget=Sc;yb.PaddingWidget=Sc;yb.PaddingWidget=Sc;var ye=function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("IconWidget")&&"function"===typeof Ha.IconWidget?Ha.IconWidget:Ha.IconWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"onMouseDown",
value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return sa=new yb.popovers.IconPopover({hasFixedPosition:!!P.ownerChain().find(function(Ib){return Ib.hasFixedPosition})}),Ta.yield(sa.fadeIntoWorld(P.globalBounds().center()),2);yb.connect(sa,"select",P,"iconValue",{converter:function(Ib){return Ib&&yb.Icon.makeLabel(Ib).value},varMapping:{Icon:pe}});yb.signal(P,"openWidget",
sa);Ta.jumpToEnd()})}}],[{key:"className",get:function(){return"IconWidget"}},{key:"properties",get:function(){return{fontColor:{defaultValue:yb.Color.gray.darker()},fontFamily:{defaultValue:"FontAwesome"},nativeCursor:{defaultValue:"pointer"},iconValue:{derived:!0,get:function(){return this.value},set:function(P){this.value=P||"No Icon"}}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22063,end:22959})}(yb.Label);yb.IconWidget=ye;yb.IconWidget=ye;yb.IconWidget=ye;var Gd=function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Kb=Ha.hasOwnProperty("StringWidget")&&"function"===typeof Ha.StringWidget?Ha.StringWidget:Ha.StringWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"truncate",
value:function(P){return 200<P.length?P.slice(0,20)+"...":P}},{key:"onFocus",value:function(P){var sa=this,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ib){if(1==Ib.nextAddress)return Qb._get(Object.getPrototypeOf(Kb.prototype),"onFocus",sa).call(sa,P),sa.readOnly?Ib.return():sa.stringTooLong?Ib.yield(sa.world().editPrompt("edit string",{requester:sa,input:sa.stringValue}),2):(sa.borderColor=yb.Color.white.withA(.9),sa.textString=sa.stringValue,Ib.return());Ta=Ib.yieldResult;if("string"===
typeof Ta)sa.onInput(Ta);Ib.jumpToEnd()})}},{key:"onBlur",value:function(P){Qb._get(Object.getPrototypeOf(Kb.prototype),"onBlur",this).call(this,P);this.readOnly||(this.borderColor=yb.Color.transparent,this.onInput(this.textString))}},{key:"onInput",value:function(P){this.owner.focus();yb.signal(this,"inputAccepted",P);this.stringValue=P}}],[{key:"className",get:function(){return"StringWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:yb.Color.transparent},fontColor:{defaultValue:yb.Color.blue},
nativeCursor:{defaultValue:"auto"},borderColor:{defaultValue:yb.Color.transparent},borderStyle:{defaultValue:"dashed"},borderRadius:{defaultValue:4},borderWidth:{defaultValue:1},padding:{defaultValue:yb.rect(0,0,0,0)},fixedWidth:{defaultValue:!1},fixedHeight:{defaultValue:!1},stringValue:{after:["textString"],set:function(P){this.setProperty("stringValue",P);this.textString=this.truncate(P);this.nativeCursor=this.stringTooLong?"pointer":"auto"}},stringTooLong:{readOnly:!0,get:function(){return this.stringValue.includes("\n")}},
isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?yb.Color.white:yb.Color.blue}}}}}],Ha,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22968,end:24888})}(yb.InputLine);yb.StringWidget=Gd;yb.StringWidget=Gd;yb.StringWidget=Gd;yb.valueWidgets=
za;Object.assign(yb.valueWidgets,{NumberWidget:pd,StringWidget:Gd,IconWidget:ye,PaddingWidget:Sc,ShadowWidget:Yd,PointWidget:Ge,BooleanWidget:zc,LayoutWidget:Ka,ColorWidget:Aa});var Sb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js");Sb.Ellipse=cc;Sb.Icon=pe;Sb.Morph=Zd;Sb.Path=$c;Sb.Text=Cd;Sb.HorizontalLayout=kd;Sb.VerticalLayout=Db;Sb.morph=mc;Sb.Color=lc;Sb.pt=Tb;Sb.rect=nd;Sb.Rectangle=eb;Sb.arr=gd;Sb.connect=bc;Sb.disconnect=ed;Sb.LabeledCheckBox=Vc;Sb.DropDownSelector=Bc;Sb.Button=
xc;Sb.Menu=kc;Sb.NumberWidget=pd;Sb.InteractiveMorphSelector=Vb;Sb.easings=Nb;(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Kb=Ha.hasOwnProperty("AxisHalo")&&"function"===typeof Ha.AxisHalo?Ha.AxisHalo:Ha.AxisHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var sa=P.halo;P=P.targetAxis;Qb._get(Object.getPrototypeOf(Kb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this,{fill:Sb.Color.transparent,halo:sa,targetAxis:P,container:sa.container});this.initialize()}},{key:"initialize",value:function(){this.setBounds(this.fetchBounds());this.minSlider=this.minSlider();this.axisMenu=this.axisMenu();this.proportionSlider=this.proportionSlider();this.proportionSlider.addMorph(this.minSlider);this.submorphs=[this.proportionSlider,this.axisMenu];this.halo.addGuide(this)}},{key:"forceMenuHidden",set:function(P){this._forceMenuHidden=
P;this.axisMenu.visible=!P}},{key:"forceMenuHidden",get:function(){return this._forceMenuHidden}},{key:"lastAxis",get:function(){return!this.targetAxis.after}},{key:"fetchBounds",value:function(){return this.fetchPosition().extent(this.fetchExtent())}},{key:"alignWithTarget",value:function(){this.extent=this.fetchExtent();this.position=this.fetchPosition();this.proportionSlider.alignWithTarget();this.axisMenu.alignWithTarget()}},{key:"onHoverIn",value:function(){this.minSlider.requestToShow();this.axisMenu.visible=
!this.forceMenuHidden&&!0}},{key:"onHoverOut",value:function(P){this.minSlider.requestToHide();this.axisMenu.visible=this.forceMenuVisible||!1}},{key:"proportionSlider",value:function(){var P=this,sa=this,Ta=this.proportionViewer();return this.halo.addGuide(new Sb.Morph({nativeCursor:this.getResizeCursor(),fill:Sb.Color.transparent,submorphs:[this.devider(),Ta],alignWithTarget:function(){this.setBounds(sa.getProportionSliderBounds(this))},onDragStart:function(){Ta.visible=!0},onDrag:function(Ib){P.adjustStretch(P.getDelta(Ib));
P.halo.alignWithTarget()},onDragEnd:function(){Ta.visible=!1}}))}},{key:"devider",value:function(){return new Sb.Morph({visible:!this.lastAxis,fill:Sb.Color.black.withA(.5),bounds:this.getDeviderBounds(),draggable:!1,reactsToPointer:!1})}},{key:"minSlider",value:function(){var P=this,sa=this,Ta=this.minSpaceVisualizer(),Ib=this.minViewer();return this.halo.addGuide(new Sb.Ellipse({nativeCursor:this.getResizeCursor(),fill:Sb.Color.green,extent:Sb.pt(10,10),visible:!1,submorphs:[Ta,Ib],becomesActiveOnHover:!0,
alignWithTarget:function(){this.position=sa.getMinSliderPosition()},requestToShow:function(){this.visible=!sa.targetAxis.fixed},requestToHide:function(){this.active?this.shouldHide=!0:this.visible=!1},onDragStart:function(){sa.forceMenuHidden=!0;Ib.visible=!0;this.active=Ta.visible=!0},onDrag:function(Lc){P.targetAxis.min+=-P.getDelta(Lc);P.halo.alignWithTarget()},onDragEnd:function(){sa.forceMenuHidden=!1;Ib.visible=!1;this.active=Ta.visible=!1;this.shouldHide&&(this.shouldHide=this.visible=!1)}}))}},
{key:"minViewer",value:function(){var P=this;return this.viewer({position:this.getMinViewerPosition(),alignWithTarget:function(){this.textString="min: "+P.targetAxis.min.toFixed()+"px !"}})}},{key:"minSpaceBorder",value:function(){return new Sb.Path(Object.assign({position:Sb.pt(-1,-1),borderStyle:"dashed",borderColor:Sb.Color.green,borderWidth:2},this.getMinSpaceBorder()))}},{key:"minSpaceVisualizer",value:function(){var P=this,sa=this.minSpaceBorder();return this.halo.addGuide(new Sb.Morph({fill:Sb.Color.green.withA(.1),
visible:!1,isHaloItem:!0,submorphs:[sa],alignWithTarget:function(){this.extent=P.getMinSpaceExtent();this.topLeft=Sb.pt(5,5)}}))}},{key:"axisMenu",value:function(){var P=this.lockButton(),sa=this.menuButton(),Ta=this;return new Sb.Morph({layout:this.getMenuLayout(),submorphs:[P,sa],fill:Sb.Color.transparent,visible:!1,becomesActiveOnHover:!0,alignWithTarget:function(){this.bottomRight=this.owner.extent.subPt(Ta.getMenuOffset(this))}})}},{key:"lockButton",value:function(){var P=this;return this.halo.addGuide(new Sb.Morph({fill:Sb.Color.transparent,
extent:Sb.pt(25,25),submorphs:[{center:Sb.pt(12.5,12.5),fill:Sb.Color.transparent,styleClasses:["fa","fa-unlock"]}],alignWithTarget:function(){P.targetAxis.fixed?(this.fontColor=Sb.Color.red,this.submorphs[0].styleClasses=["fa","fa-lock"]):(this.fontColor=Sb.Color.green,this.submorphs[0].styleClasses=["fa","fa-unlock"])},onMouseDown:function(){this.toggleLock()},toggleLock:function(){P.targetAxis.fixed=!P.targetAxis.fixed;P.halo.alignWithTarget()}}))}},{key:"menuButton",value:function(){var P=this,
sa=this;return new Sb.Morph({fill:Sb.Color.transparent,extent:Sb.pt(25,25),submorphs:[{fill:Sb.Color.transparent,styleClasses:["fa","fa-cog"],center:Sb.pt(12.5,12.5)}],onMouseDown:function(Ta){sa.forceMenuVisible=!0;this.addMorph(Ta.state.menu=new Sb.Menu({position:Sb.pt(15,15),items:[["Remove "+sa.subject,function(){P.targetAxis.remove();P.halo.initGuides();P.halo.alignWithTarget()}],["Insert "+sa.subject+" before",function(){P.targetAxis.addBefore();P.halo.initGuides();P.halo.alignWithTarget()}],
["Insert "+sa.subject+" after",function(){P.targetAxis.addAfter();P.halo.initGuides();P.halo.alignWithTarget()}]]}))}})}},{key:"viewer",value:function(P){var sa=P.position;P=P.alignWithTarget;return this.halo.addGuide(new Sb.Text({styleClasses:["Halo"],padding:Sb.Rectangle.inset(6),visible:!1,borderRadius:10,fontColor:Sb.Color.white,fill:Sb.Color.black.withA(.5),position:sa,alignWithTarget:P,readOnly:!0}))}},{key:"proportionViewer",value:function(){var P=this;return this.viewer({position:this.getProportionViewerPosition(),
alignWithTarget:function(){this.textString=P.targetAxis.length.toFixed(1)+"px"}})}}],[{key:"className",get:function(){return"AxisHalo"}}],Ha,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:660,end:7979})})(Sb.Morph);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
Kb=Ha.hasOwnProperty("RowHalo")&&"function"===typeof Ha.RowHalo?Ha.RowHalo:Ha.RowHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var sa=P.row;P=P.halo;Qb._get(Object.getPrototypeOf(Kb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:P.target.row(sa),halo:P})}},{key:"subject",get:function(){return"row"}},
{key:"adjustStretch",value:function(P){this.targetAxis.height+=P}},{key:"getDelta",value:function(P){return P.state.dragDelta.y}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.y}},{key:"fetchPosition",value:function(){return Sb.pt(-45,this.axisOffset()+10)}},{key:"fetchExtent",value:function(){return Sb.pt(40,this.targetAxis.length-10)}},{key:"getMenuOffset",value:function(P){return this.targetAxis.length>P.height?Sb.pt(2,5):Sb.pt(26,10)}},{key:"getMenuLayout",value:function(){return new Sb.VerticalLayout}},
{key:"getResizeCursor",value:function(){return"row-resize"}},{key:"getMinViewerPosition",value:function(){return Sb.pt(50,20)}},{key:"getMinSliderPosition",value:function(){return Sb.pt(0,-this.targetAxis.min)}},{key:"getMinSpaceExtent",value:function(){return Sb.pt(this.container.width+45,this.targetAxis.min)}},{key:"getMinSpaceBorder",value:function(){return{extent:Sb.pt(this.container.width+50,2),vertices:[Sb.pt(0,1),Sb.pt(this.container.width+50,1)]}}},{key:"getProportionViewerPosition",value:function(){return Sb.pt(40,
20)}},{key:"getProportionSliderBounds",value:function(P){return Sb.pt(0,P.owner.height-5).extent(Sb.pt(40,10))}},{key:"getDeviderBounds",value:function(){return Sb.pt(15,4).extent(Sb.pt(25,2))}}],[{key:"className",get:function(){return"RowHalo"}}],Ha,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:7981,end:9208})})(Sb.AxisHalo);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Kb=Ha.hasOwnProperty("ColumnHalo")&&"function"===typeof Ha.ColumnHalo?Ha.ColumnHalo:Ha.ColumnHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var sa=P.col;P=P.halo;Qb._get(Object.getPrototypeOf(Kb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,{targetAxis:P.target.col(sa),halo:P})}},{key:"subject",get:function(){return"column"}},{key:"adjustStretch",value:function(P){this.targetAxis.width+=P}},{key:"getDelta",value:function(P){return P.state.dragDelta.x}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.x}},{key:"fetchPosition",value:function(){return Sb.pt(this.axisOffset()+10,-45)}},{key:"fetchExtent",value:function(){return Sb.pt(this.targetAxis.length-10,40)}},{key:"getMenuOffset",value:function(P){return this.targetAxis.length>
P.width?Sb.pt(5,3):Sb.pt(8,26)}},{key:"getMenuLayout",value:function(){return new Sb.HorizontalLayout}},{key:"getResizeCursor",value:function(){return"col-resize"}},{key:"getMinViewerPosition",value:function(){return Sb.pt(20,50)}},{key:"getMinSliderPosition",value:function(){return Sb.pt(-this.targetAxis.min,0)}},{key:"getMinSpaceExtent",value:function(){return Sb.pt(this.targetAxis.min,this.container.height+45)}},{key:"getMinSpaceBorder",value:function(){return{extent:Sb.pt(2,this.container.height+
50),vertices:[Sb.pt(1,0),Sb.pt(1,this.container.height+50)]}}},{key:"getProportionViewerPosition",value:function(){return Sb.pt(20,40)}},{key:"getProportionSliderBounds",value:function(P){return Sb.pt(P.owner.width-5,0).extent(Sb.pt(10,40))}},{key:"getDeviderBounds",value:function(){return Sb.pt(4,15).extent(Sb.pt(2,25))}}],[{key:"className",get:function(){return"ColumnHalo"}}],Ha,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:9210,end:10442})})(Sb.AxisHalo);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Kb=Ha.hasOwnProperty("CellGuide")&&"function"===typeof Ha.CellGuide?Ha.CellGuide:Ha.CellGuide=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"menuItems",
value:function(){var P=this,sa=Sb.Icon.textAttribute("check-square-o"),Ta=Sb.Icon.textAttribute("square-o");sa[1].textStyleClasses.push("annotation");Ta[1].textStyleClasses.push("annotation");Ta[1].paddingRight="2px";return[["Resize Policy",[[["Rigid  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?Ta:sa)),function(){P.cellGroup.resize=!1}],[["Space Filling  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?sa:Ta)),function(){P.cellGroup.resize=!0}]]],["Align at...",["center"].concat($jscomp.arrayFromIterable((new Sb.Rectangle).sides),
$jscomp.arrayFromIterable((new Sb.Rectangle).corners)).map(function(Ib){return[[Ib,{paddingRight:"2px"}].concat($jscomp.arrayFromIterable(P.cellGroup.align==Ib?sa:Ta),["  ",null]),function(){return P.cellGroup.align=Ib}]})]].concat(this.cellGroup.morph?[["Release Morph from Cell",function(){var Ib=P.cellGroup.morph;Ib&&(P.world().firstHand.grab(Ib),P.world().firstHand.longClickGrab=!0,Ib.position=Sb.pt(0))}]]:[])}}],[{key:"className",get:function(){return"CellGuide"}},{key:"properties",get:function(){return{cellGroup:{}}}}],
Ha,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10444,end:11722})})(Sb.Morph);(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Kb=Ha.hasOwnProperty("LayoutHalo")&&"function"===typeof Ha.LayoutHalo?Ha.LayoutHalo:Ha.LayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,void 0,[{key:"className",get:function(){return"LayoutHalo"}},{key:"properties",get:function(){return{container:{},target:{},pointerId:{},halosEnabled:{defaultValue:!1},isEpiMorph:{defaultValue:!0},isHaloItem:{defaultValue:!0},borderColor:{defaultValue:Sb.Color.orange},borderWidth:{defaultValue:2},styleClasses:{defaultValue:["Halo"]}}}}],Ha,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:11724,end:12137})})(Sb.Morph);za=Ca("G",function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Kb=Ha.hasOwnProperty("GridLayoutHalo")&&"function"===typeof Ha.GridLayoutHalo?Ha.GridLayoutHalo:Ha.GridLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Qb(Kb,oa,[{key:"previewDrop",value:function(P){1>P.length||(P=this.cellGuides.find(function(sa){return sa.fullContainsWorldPoint($world.firstHand.position)}),P!=this.currentCell&&this.currentCell&&this.currentCell.stopPreview(),(this.currentCell=P)&&this.currentCell.startPreview())}},{key:"handleDrop",value:function(P){var sa=this;this.currentCell&&P.whenRendered().then(function(){return sa.currentCell.cellGroup.morph=P})}},{key:"initialize",value:function(){this.initGuides();this.alignWithTarget();
this.focus()}},{key:"optionControls",value:function(){var P=this.target,sa=new Sb.LabeledCheckBox({name:"compensateOrigin",label:"Compensate Origin",fill:Sb.Color.transparent,checked:P.compensateOrigin}),Ta=new Sb.LabeledCheckBox({label:"Resize Submorphs",fill:Sb.Color.transparent,name:"fitToCell",checked:P.fitToCell});Sb.connect(sa,"checked",P,"compensateOrigin");Sb.connect(Ta,"checked",P,"fitToCell");Sb.connect(sa,"checked",this,"alignWithTarget");return[sa,Ta]}},{key:"isLayoutHalo",get:function(){return!1}},
{key:"alignWithTarget",value:function(){this.target.apply();this.position=this.container.globalPosition;this.target.compensateOrigin&&this.moveBy(this.container.origin.negated());this.extent=this.container.extent;this.addMissingGuides();Sb.arr.reverse(this.guides).forEach(function(P){return P.alignWithTarget()})}},{key:"addMissingGuides",value:function(){var P=this;Sb.arr.withoutAll(this.target.cellGroups,this.guides.map(function(sa){return sa.cellGroup})).forEach(function(sa){return P.addMorph(P.cellGuide(sa))})}},
{key:"initGuides",value:function(){this.submorphs=[];this.guides=[];this.initCellGuides();this.initColumnGuides();this.initRowGuides()}},{key:"initCellGuides",value:function(){var P=this,sa=this.addMorph({fill:Sb.Color.transparent,borderRadius:this.borderRadius,extent:this.extent});this.target.cellGroups.forEach(function(Ta){sa.addMorph(P.cellGuide(Ta))});this.cellGuides=sa.submorphs;this.addMorph(this.resizer())}},{key:"addGuide",value:function(P){P.isHaloItem=!0;this.guides.push(P);return P}},{key:"initRowGuides",
value:function(){var P=this,sa=this;this.addGuide(this.addMorph(new Sb.Morph({width:25,fill:Sb.Color.gray.withA(.7),borderRadius:15,height:this.container.height,topRight:Sb.pt(-5,0),alignWithTarget:function(){this.height=sa.container.height}})));Sb.arr.range(0,this.target.rowCount-1).forEach(function(Ta){P.addMorph(new Sb.RowHalo({row:Ta,halo:P}))})}},{key:"initColumnGuides",value:function(){var P=this,sa=this;this.addGuide(this.addMorph(new Sb.Morph({height:25,fill:Sb.Color.gray.withA(.7),borderRadius:15,
width:this.container.width,bottomLeft:Sb.pt(0,-5),alignWithTarget:function(){this.width=sa.container.width}})));Sb.arr.range(0,this.target.columnCount-1).forEach(function(Ta){P.addMorph(new Sb.ColumnHalo({col:Ta,halo:P}))})}},{key:"resizer",value:function(){var P=this;return this.addGuide(new Sb.Morph({fill:Sb.Color.transparent,extent:Sb.pt(25,25),nativeCursor:"nwse-resize",onDrag:function(sa){P.container.resizeBy(sa.state.dragDelta);P.alignWithTarget()},alignWithTarget:function(){this.bottomRight=
P.extent}}))}},{key:"cellResizer",value:function(P,sa){var Ta=this,Ib="topLeft"==sa?"bottomRight":"topLeft";return new Sb.Ellipse({borderWidth:1,visible:!1,borderColor:Sb.Color.black,nativeCursor:"nwse-resize",removeCell:function(Lc){P.disconnect(Lc);Ta.alignWithTarget()},addCell:function(Lc){P.connect(Lc);Ta.alignWithTarget()},start:function(){this.fixpointCell=P[Ib];this.draggedDelta=P.bounds().partNamed(sa);this.debugMorph=Ta.addMorph(new Sb.Morph({fill:Sb.Color.orange.withA(.5)}))},update:function(Lc){var Wc=
this;this.draggedDelta=this.draggedDelta.addPt(Lc);var he=Sb.Rectangle.unionPts([this.draggedDelta]).union(this.fixpointCell.bounds());this.debugMorph.setBounds(he);Ta.cells.forEach(function(ie){var kf=he.intersection(ie.bounds()).area()/ie.bounds().area();P.includes(ie)&&.1>kf&&Wc.removeCell(ie);!P.includes(ie)&&kf>1/3&&Wc.addCell(ie)})},onDragEnd:function(Lc){this.debugMorph.remove()},onDragStart:function(Lc){this.start(Lc.position)},onDrag:function(Lc){this.update(Lc.state.dragDelta)}})}},{key:"cellGuide",
value:function(P){var sa=this,Ta=this.cellResizer(P,"topLeft"),Ib=this.cellResizer(P,"bottomRight");return this.addGuide(new Sb.CellGuide({cellGroup:P,bounds:P.bounds(),fill:Sb.Color.transparent,borderColor:Sb.Color.orange,borderWidth:1,isHaloItem:!0,isCell:!0,draggable:!1,submorphs:[Ta,Ib],onMouseDown:function(Lc){this.becomeActive()},deactivate:function(){this.borderColor=Sb.Color.orange;this.fill=Sb.Color.transparent;this.submorphs.forEach(function(Lc){Lc.visible=!1})},becomeActive:function(){sa.guides.forEach(function(Lc){Lc.isCell&&
Lc.deactivate()});this.borderColor=Sb.Color.rgbHex("#1565C0");this.fill=Sb.Color.rgbHex("#1565C0").withA(.3);sa.addMorph(this.remove());this.submorphs.forEach(function(Lc){Lc.visible=!0})},startPreview:function(Lc){this.fill=Sb.Color.orange.withA(.7)},stopPreview:function(Lc){this.fill=Sb.Color.transparent},onDrop:function(Lc){var Wc=$jscomp.makeIterator(Lc.hand.grabbedMorphs).next().value;Lc.hand.dropMorphsOn(sa.container);P.morph=Wc},alignWithTarget:function(){P.bounds().isNonEmpty()?(this.setBounds(P.bounds()),
Ta.center=this.innerBounds().topLeft(),Ib.center=this.innerBounds().bottomRight()):(Sb.arr.remove(sa.guides,this),this.remove())}}))}}],[{key:"className",get:function(){return"GridLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:Sb.Color.transparent},cells:{derived:!0,get:function(){return Sb.arr.flatten(this.target.col(0).items.map(function(P){return P.row(0).items}))}},submorphs:{initialize:function(){this.initialize()}}}}}],Ha,{pathInPackage:function(){return"layout.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:12146,end:19501})}(Sb.LayoutHalo));Sb.GridLayoutHalo=za;Sb.GridLayoutHalo=za;Sb.GridLayoutHalo=za;Ka=function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Kb=Ha.hasOwnProperty("TilingLayoutHalo")&&"function"===typeof Ha.TilingLayoutHalo?Ha.TilingLayoutHalo:Ha.TilingLayoutHalo=
function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"remove",value:function(){Qb._get(Object.getPrototypeOf(Kb.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"handleDrop",value:function(P){}},{key:"removePreviews",value:function(){this.previews.forEach(function(P){return P.clear()})}},
{key:"previewDrop",value:function(P){var sa=this;0<this.previews.length||(this.previews=P.map(function(Ta){return sa.container.addMorph({type:Sb.DropPreview,bounds:Ta.bounds()})}),this.previews.forEach(function(Ta){Ta.step()}))}},{key:"updateSpacing",value:function(P){this.target.spacing=P}},{key:"updateAxis",value:function(P){this.target.axis=P}},{key:"updateAlign",value:function(P){this.target.align=P}},{key:"optionControls",value:function(){var P=this.target,sa=new Sb.DropDownSelector({borderRadius:2,
padding:3,selectedValue:P.axis,values:["row","column"]}),Ta=new Sb.DropDownSelector({borderRadius:2,padding:3,selectedValue:P.align,values:["left","center"]});P=new Sb.NumberWidget({min:0,number:P.spacing,padding:Sb.rect(5,3,0,0),borderRadius:3,borderWidth:1,borderColor:Sb.Color.gray,unit:"px"});Sb.connect(P,"update",this,"updateSpacing");Sb.connect(Ta,"update",this,"updateAlign");Sb.connect(sa,"update",this,"updateAxis");var Ib={type:"label",padding:Sb.rect(0,5,5,5),fill:Sb.Color.transparent,fontColor:Sb.Color.gray.darker(),
readOnly:!0};return[[Object.assign({},Ib,{textString:"Submorph Spacing"}),P],[Object.assign({},Ib,{textString:"Tiling Align"}),Ta],[Object.assign({},Ib,{textString:"Tiling Axis"}),sa]].map(function(Lc){return{submorphs:Lc,fill:null,layout:new Sb.HorizontalLayout({spacing:3})}})}}],[{key:"className",get:function(){return"TilingLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:Sb.Color.transparent},previews:{defaultValue:[]}}}}],Ha,{pathInPackage:function(){return"layout.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:19510,end:21708})}(Sb.LayoutHalo);Sb.TilingLayoutHalo=Ka;Sb.TilingLayoutHalo=Ka;Sb.TilingLayoutHalo=Ka;(function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Kb=Ha.hasOwnProperty("DropPreview")&&"function"===typeof Ha.DropPreview?Ha.DropPreview:Ha.DropPreview=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"clear",value:function(){this.stopped=!0;this.remove()}},{key:"step",value:function(){var P=this,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return sa=Sb.easings.inOutQuad,Ta.yield(P.animate({opacity:.5,duration:(P.pulseDuration-10)/2,easing:sa}),2);if(3!=Ta.nextAddress)return Ta.yield(P.animate({opacity:1,duration:(P.pulseDuration-
10)/2,easing:sa}),3);P.stopped||P.step();Ta.jumpToEnd()})}}],[{key:"className",get:function(){return"DropPreview"}},{key:"properties",get:function(){return{isHaloItem:{readOnly:!0,get:function(){return!0}},epiMorph:{readOnly:!0,get:function(){return!0}},fill:{defaultValue:Sb.Color.orange.withA(.3)},hasFixedPosition:{defaultValue:!0},borderColor:{defaultValue:Sb.Color.orange},borderWidth:{defaultValue:2},borderStyle:{defaultValue:"dashed"},pulseDuration:{defaultValue:2E3}}}}],Ha,{pathInPackage:function(){return"layout.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21710,end:22534})})(Sb.Morph);Ka=Ca("F",function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Kb=Ha.hasOwnProperty("FlexLayoutHalo")&&"function"===typeof Ha.FlexLayoutHalo?Ha.FlexLayoutHalo:Ha.FlexLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"handleDrop",value:function(P){}},{key:"previewDrop",value:function(P){var sa=this;0<this.previews.length||(this.previews=P.map(function(Ta){return sa.container.addMorph({type:Sb.DropPreview,position:sa.container.localize(sa.world().firstHand.position),extent:Ta.bounds().extent()})}),this.previews.forEach(function(Ta){Ta.step()}))}},{key:"remove",value:function(){Qb._get(Object.getPrototypeOf(Kb.prototype),
"remove",this).call(this);this.removePreviews();return this}},{key:"removePreviews",value:function(){this.previews.forEach(function(P){return P.clear()})}},{key:"onDrop",value:function(P){this.removePreviews();P.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateAutoResizePolicy",value:function(P){P&&(this.originalExtent=this.container.extent);this.target.autoResize=P;P||(this.container.extent=this.originalExtent||
this.container.extent);this.alignWithTarget()}},{key:"updateResizeSubmorphsPolicy",value:function(P){this.target.resizeSubmorphs=P;this.alignWithTarget()}},{key:"updateAlignmentPolicy",value:function(P){this.target.align=P}},{key:"updateDirectionPolicy",value:function(P){this.target.direction=P}},{key:"updateSpacing",value:function(P){this.target.spacing=P}},{key:"optionControls",value:function(){var P=this.target,sa=P.possibleAlignValues?{fill:Sb.Color.transparent,layout:new Sb.HorizontalLayout({spacing:3,
direction:"centered",align:"center"}),submorphs:[{type:"label",value:"align: "},new Sb.DropDownSelector({name:"alignment",borderRadius:2,padding:3,selectedValue:P.align,values:P.possibleAlignValues})]}:null,Ta=P.possibleDirectionValues?{fill:Sb.Color.transparent,layout:new Sb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"direction: "},new Sb.DropDownSelector({name:"direction",borderRadius:2,padding:3,selectedValue:P.direction,values:P.possibleDirectionValues})]}:
null,Ib=new Sb.NumberWidget({fill:Sb.Color.white,borderWidth:1,borderRadius:4,padding:Sb.rect(5,4,0,0),borderColor:Sb.Color.gray,min:0,number:P.spacing,unit:"px"}),Lc=new Sb.LabeledCheckBox({name:"autoResize",label:"Resize Container",alignCheckBox:"right",fill:Sb.Color.transparent,checked:P.autoResize});P=new Sb.LabeledCheckBox({label:"Resize Submorphs",name:"resizeSubmorphs",alignCheckBox:"right",fill:Sb.Color.transparent,checked:P.resizeSubmorphs});Sb.connect(Ib,"update",this,"updateSpacing");Sb.connect(Lc,
"checked",this,"updateAutoResizePolicy");Sb.connect(P,"checked",this,"updateResizeSubmorphsPolicy");sa&&Sb.connect(sa.submorphs[1],"selectedValue",this,"updateAlignmentPolicy");Ta&&Sb.connect(Ta.submorphs[1],"selectedValue",this,"updateDirectionPolicy");return[Lc,P].concat($jscomp.arrayFromIterable([sa,Ta].filter(Boolean)),[{fill:Sb.Color.transparent,layout:new Sb.HorizontalLayout,submorphs:[{type:"label",value:"Submorph Spacing",fontColor:Sb.Color.gray.darker(),padding:Sb.rect(0,5,5,5)},Ib]}])}}],
[{key:"className",get:function(){return"FlexLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},fill:{defaultValue:Sb.Color.transparent},halosEnabled:{defaultValue:!1},previews:{defaultValue:[]}}}}],Ha,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:22543,
end:26761})}(Sb.LayoutHalo));Sb.FlexLayoutHalo=Ka;Sb.FlexLayoutHalo=Ka;Sb.FlexLayoutHalo=Ka;Aa=Ca("c",function(oa){var Ha=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Kb=Ha.hasOwnProperty("ProportionalLayoutHalo")&&"function"===typeof Ha.ProportionalLayoutHalo?Ha.ProportionalLayoutHalo:Ha.ProportionalLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Kb,oa,[{key:"handleDrop",value:function(P){}},
{key:"onDrop",value:function(P){P.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateSubmorphProportionalLayoutSettings",value:function(P){var sa={};this.target.changeSettingsFor(P.submorph,(sa[P.axis]=P.policy,sa),!0)}},{key:"onSubmorphSettingsDragStart",value:function(P,sa){var Ta=this;P.stop();var Ib=this.target.settingsFor(sa);sa="";for(var Lc in Ib)sa+=Lc+":"+Ib[Lc]+" ";var Wc=Sb.morph({type:"label",value:sa,
isLayoutable:!1});Wc.wantsToBeDroppedOn=function(he){return Ta.target.layoutableSubmorphs.includes(he)};Wc.onBeingDroppedOn=function(he,ie){Wc.remove();if(he=Ta.target.layoutableSubmorphs.includes(ie)?ie:P.world.morphsContainingPoint(P.hand.position).find(function(kf){return Ta.target.layoutableSubmorphs.includes(kf)}))Ta.updateSubmorphProportionalLayoutSettings({policy:Ib.x,axis:"x",submorph:he}),Ta.updateSubmorphProportionalLayoutSettings({policy:Ib.y,axis:"y",submorph:he}),he.show(),$world.setStatusMessage("layout settings applied")};
P.hand.grab(Wc)}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var P=this,sa,Ta,Ib,Lc,Wc,he,ie,kf,Qd,qe,df,Af;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rg){switch(rg.nextAddress){case 1:return sa=P.target.layoutableSubmorphs,P.env.eventDispatcher.isKeyPressed("Shift")?(Ib=sa.map(function(mg){return{isListItem:!0,string:String(mg),value:mg}}),rg.yield($world.listPrompt("Select morph",Ib,{requester:P,onSelection:function(mg){return mg.show()}}),5)):rg.yield(Sb.InteractiveMorphSelector.selectMorph(P.world(),
P,function(mg){return sa.includes(mg)}),4);case 4:Ta=rg.yieldResult;rg.jumpTo(3);break;case 5:Lc=rg.yieldResult,Wc=$jscomp.makeIterator(Lc.selected),Ta=Wc.next().value;case 3:if(!Ta)return rg.return();he=P.state.popover.get("controlContainer");ie=he.getAllNamed(/submorph config/);kf=["move","resize","scale","fixed"];Qd=P.target.settingsFor(Ta);ie.length||(he.submorphs=[].concat($jscomp.arrayFromIterable(he.submorphs),[{name:"submorph config X-Axis policy",position:Sb.pt(0,P.height),fill:Sb.Color.transparent,
layout:new Sb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph X-Axis policy: "},new Sb.DropDownSelector({name:"x-axis policy selector",borderRadius:2,padding:3,selectedValue:Qd.x,values:kf})]},{name:"submorph config Y-Axis policy",position:Sb.pt(0,P.height),fill:Sb.Color.transparent,layout:new Sb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph Y-Axis policy: "},new Sb.DropDownSelector({name:"y-axis policy selector",
borderRadius:2,padding:3,selectedValue:Qd.y,values:kf})]},Sb.morph({position:Sb.pt(0,P.height+20),draggable:!0,name:"dragme",type:"label",value:"drag me to copy"})]));qe=he.getSubmorphNamed("x-axis policy selector");df=he.getSubmorphNamed("y-axis policy selector");Af=he.getSubmorphNamed("dragme");Sb.disconnect(qe,"selectedValue",P,"updateSubmorphProportionalLayoutSettings");Sb.disconnect(df,"selectedValue",P,"updateSubmorphProportionalLayoutSettings");qe.selectedValue=Qd.x;df.selectedValue=Qd.y;Sb.connect(Af,
"onDragStart",P,"onSubmorphSettingsDragStart",{updater:function(mg,Yc){return mg(Yc,Ta)},varMapping:{submorph:Ta}});Sb.connect(qe,"selectedValue",P,"updateSubmorphProportionalLayoutSettings",{converter:function(mg){return{policy:mg,axis:"x",submorph:Ta}},varMapping:{submorph:Ta}});Sb.connect(df,"selectedValue",P,"updateSubmorphProportionalLayoutSettings",{converter:function(mg){return{policy:mg,axis:"y",submorph:Ta}},varMapping:{submorph:Ta}});rg.jumpToEnd()}})}},{key:"optionControls",value:function(P){this.state.popover=
P;var sa=this.target;P=new Sb.LabeledCheckBox({name:"x-axis",label:"X-Axis",alignCheckBox:"right",fill:Sb.Color.transparent,checked:sa.xAxisEnabled});sa=new Sb.LabeledCheckBox({name:"y-axis",label:"Y-Axis",alignCheckBox:"right",fill:Sb.Color.transparent,checked:sa.yAxisEnabled});var Ta=new Sb.Button({name:"modify submorph settings button",label:[].concat($jscomp.arrayFromIterable(Sb.Icon.textAttribute("crosshairs")),["\u00a0Change submorph settings"])});Sb.connect(P,"checked",this,"updateXAxisEnabled");
Sb.connect(sa,"checked",this,"updateYAxisEnabled");Sb.connect(Ta,"fire",this,"chooseSubmorphToChangeLayoutSettings");return[Ta]}}],[{key:"className",get:function(){return"ProportionalLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},fill:{defaultValue:Sb.Color.transparent}}}}],Ha,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:26771,end:32465})}(Sb.LayoutHalo));Sb.ProportionalLayoutHalo=Aa;Sb.ProportionalLayoutHalo=Aa;Sb.ProportionalLayoutHalo=Aa;zc=lively.FreezerRuntime.recorderFor("lively.halos/index.js");zc.Halo=td;zc.MorphHighlighter=Pc;zc.InteractiveMorphSelector=Vb;zc.StatusMessage=Ab;zc.StatusMessageForMorph=Qa;zc.show=Ua;zc.showConnector=fc;zc.ProportionalLayoutHalo=Aa;zc.GridLayoutHalo=za;zc.FlexLayoutHalo=Ka;zc.showAndSnapToGuides=ea;zc.removeSnapToGuidesOf=
Q;zc.StatusMessage=Ab;zc.StatusMessage=Ab;zc.StatusMessageForMorph=Qa;zc.StatusMessageForMorph=Qa;zc.show=Ua;zc.show=Ua;zc.showConnector=fc;zc.showConnector=fc;zc.Halo=td;zc.Halo=td;zc.MorphHighlighter=Pc;zc.MorphHighlighter=Pc;zc.InteractiveMorphSelector=Vb;zc.InteractiveMorphSelector=Vb;zc.ProportionalLayoutHalo=Aa;zc.ProportionalLayoutHalo=Aa;zc.GridLayoutHalo=za;zc.GridLayoutHalo=za;zc.FlexLayoutHalo=Ka;zc.FlexLayoutHalo=Ka;zc.showAndSnapToGuides=ea;zc.showAndSnapToGuides=ea;zc.removeSnapToGuidesOf=
Q;zc.removeSnapToGuidesOf=Q;td=Object.freeze({__proto__:null,StatusMessage:Ab,StatusMessageForMorph:Qa,show:Ua,showConnector:fc,Halo:td,MorphHighlighter:Pc,InteractiveMorphSelector:Vb,ProportionalLayoutHalo:Aa,GridLayoutHalo:za,FlexLayoutHalo:Ka,showAndSnapToGuides:ea,removeSnapToGuidesOf:Q,SvgStyleHalo:void 0});Ca("i",td);Ca("_",void 0)}}});
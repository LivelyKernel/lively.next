System.register(["./__root_module__-06ff41f6.js","kld-intersections"],function(Ca){var Bb,Kb,lc,bc,Td,Xc,Wd,$c,Pc,md,ge,Qe,kf;return{setters:[function(ke){Bb=ke.bv;Kb=ke.a6;lc=ke.r;bc=ke.a8;Td=ke.$;Xc=ke.bw;Wd=ke.bx;$c=ke.T;Pc=ke.a7;md=ke.by;ge=ke.bz;Qe=ke.l;kf=ke.bA},function(){}],execute:function(){function ke(ha){try{var Ha=eval("("+Gb.ast.transform.wrapInFunction("var _; _ = ("+ha+")")+")()")}catch(W){return JSON.parse(ha)}return"object"!==typeof Ha?null:Ha}function cc(ha,Ha){var W,ra,Za,
qb,sc,wd,nc,Ob,$d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Id){switch(Id.nextAddress){case 1:return W=Ha.world(),Id.yield(W.prompt("Enter package name",{requester:Ha,input:"",historyId:"lively.vm-editor-add-package-name",useLastInput:!0}),2);case 2:ra=Id.yieldResult;if(!ra)throw"Canceled";Id.setCatchFinallyBlocks(3);qb=Oa.resource(ra);ra=qb.name();Za=qb.url;Id.leaveTryBlock(4);break;case 3:return Id.enterCatchBlock(),Id.yield(ha.getConfig(),5);case 5:return sc=Id.yieldResult.baseURL,
wd=Oa.resource(sc).join(ra).asDirectory().url,Id.yield(ha.normalize(wd),6);case 6:Za=Id.yieldResult.replace(/\/\.js$/,"/");case 4:return Id.yield(W.prompt("Confirm or change package location",{requester:Ha,input:Za,historyId:"lively.vm-editor-add-package-address"}),7);case 7:nc=Id.yieldResult;if(!nc)throw"Canceled";Ob=Oa.resource(nc).asDirectory();$d=Ob.asFile().url;return Id.yield(ha.removePackage($d),8);case 8:return Id.yield(ha.resourceCreateFiles($d,{"index.js":"'format esm';\n","package.json":'{\n  "name": "'+
ra+'",\n  "version": "0.1.0"\n}',".gitignore":"node_modules/","README.md":"# "+ra+"\n\nNo description for package "+ra+" yet.\n",tests:{"test.js":'import { expect } from "mocha-es6";\ndescribe("'+ra+'", () => {\n  it("works", () => {\n    expect(1 + 2).equals(3);\n  });\n});'}}),9);case 9:return Id.return(Oa.loadPackage(ha,{name:ra,address:$d,configFile:Ob.join("package.json").url,main:Ob.join("index.js").url,test:Ob.join("tests/test.js").url,type:"package"}))}})}function Jc(ha,Ha,W){W=void 0===W?
null:W;var ra,Za,qb,sc,wd,nc,Ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function($d){switch($d.nextAddress){case 1:return ra={name:"",address:"",type:"package"},$d.yield(ha.getConfig(),2);case 2:Za=$d.yieldResult;if(!W){$d.jumpTo(3);break}return $d.yield(ha.getPackage(W),4);case 4:if(qb=$d.yieldResult){$d.jumpTo(5);break}return $d.yield(ha.getPackageForModule(W),6);case 6:qb=$d.yieldResult;case 5:sc=qb;case 3:return $d.yield(Ha.world().prompt("What is the package directory?",{requester:Ha,
input:sc?sc.address:Za.baseURL,historyId:"lively.vm-editor-package-load-history",useLastInput:!1}),7);case 7:wd=$d.yieldResult;if(!wd)throw"Canceled";ra.address=wd.replace(/\/$/,"");ra.url=new URL(ra.address+"/");ra.configFile=Oa.resource(ra.url).join("package.json").url;$d.setCatchFinallyBlocks(8);nc=JSON;Ob=nc.parse;return $d.yield(ha.moduleRead(ra.configFile),10);case 10:Ob.call(nc,$d.yieldResult).name;$d.leaveTryBlock(9);break;case 8:$d.enterCatchBlock(),ra.name=String(ra.url).replace(/\/$/,""),
ha.resourceEnsureExistance(ra.configFile,'{\n  "name": "'+ra.name+'",\n  "version": "0.1.0"\n}');case 9:return $d.return(Oa.loadPackage(ha,ra))}})}function Nd(ha,Ha,W){var ra,Za,qb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sc){switch(sc.nextAddress){case 1:return ra=Oa.resource(W).asFile().url,sc.yield(ha.getPackage(ra),2);case 2:if(Za=sc.yieldResult){sc.jumpTo(3);break}return sc.yield(ha.getPackageForModule(ra),4);case 4:Za=sc.yieldResult;case 3:qb=Za;if(!qb)throw Error("Cannot find package for "+
ra);return sc.yield(ha.reloadPackage(ra),5);case 5:if(!Ha){sc.jumpTo(0);break}return sc.yield(Ha.updateModuleList(),7);case 7:return sc.yield(Ha.uiSelect(ra,!1),8);case 8:return sc.return(sc.yieldResult)}})}function ec(ha,Ha,W,ra){var Za,qb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sc){switch(sc.nextAddress){case 1:return sc.yield(ha.getPackage(W),2);case 2:return Za=sc.yieldResult,sc.yield((ra||$world).confirm("Unload package "+Za.name+"?",{requester:Ha}),3);case 3:qb=sc.yieldResult;
if(!qb)throw"Canceled";return sc.yield(ha.removePackage(W),4);case 4:if(!Ha){sc.jumpTo(0);break}return sc.yield(Ha.updateModuleList(),6);case 6:return sc.yield(Ha.uiSelect(null),0)}})}function Zd(ha,Ha,W){var ra,Za,qb,sc,wd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nc){switch(nc.nextAddress){case 1:return ra=Ha.world(),nc.yield(ha.getPackage(W),2);case 2:return Za=nc.yieldResult,Za?nc.yield(ra.confirm("Really remove package "+Za.name+"?",{requester:Ha}),3):($world.inform('No package "'+
W+'" found!',{requester:Ha}),nc.return());case 3:qb=nc.yieldResult;if(!qb)throw"Canceled";ha.removePackage(W);return nc.yield(ra.confirm("Also remove directory "+Za.name+" including "+Za.modules.length+" modules?"),4);case 4:sc=nc.yieldResult;if(!sc){nc.jumpTo(0);break}return nc.yield(ra.confirm("REALLY *remove* directory "+Za.name+"? No undo possible..."),6);case 6:if(wd=nc.yieldResult)return nc.yield(ha.resourceRemove(Za.address),0);nc.jumpTo(0)}})}function le(ha,Ha,W){W=void 0===W?$world:W;var ra,
Za,qb,sc,wd,nc,Ob,$d,Id,kb,Eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){switch(ad.nextAddress){case 1:return ad.yield(ha.getPackage(Ha),2);case 2:ra=ad.yieldResult;if(!ra)throw Error("Cannot find package "+Ha);Za=[];qb=$jscomp.makeIterator(ra.modules);sc=qb.next();case 3:if(sc.done)return ad.yield(W.execCommand("open text window",{title:"imports and exports of "+Ha,content:Za.join("\n\n")}),0);wd=sc.value;if(!wd.name.match(/\.js$/)){ad.jumpTo(4);break}ad.setCatchFinallyBlocks(6);
nc=ha;Ob=nc.importsAndExportsOf;$d=wd.name;return ad.yield(ha.moduleRead(wd.name),9);case 9:return ad.yield(Ob.call(nc,$d,ad.yieldResult),8);case 8:Id=ad.yieldResult;ad.leaveTryBlock(7);break;case 6:kb=ad.enterCatchBlock();W.logError(Error("Error when getting imports/exports from module "+wd.name+":\n"+kb.stack));ad.jumpTo(4);break;case 7:Eb=""+wd.name;if(!Id.imports.length&&!Id.exports.length){Eb+="\n  does not import / export anything";ad.jumpTo(4);break}Id.imports.length&&(Eb+="\n  imports:\n",
Eb+=Oa.arr.groupByKey(Id.imports,"fromModule").mapGroups(function(ub,cd){return"from "+ub+": "+cd.map(function(Vc){return Vc.local||Vc.imported?Vc.imported&&Vc.imported!==Vc.local?Vc.imported+" as "+Vc.local:Vc.local:"nothing imported"}).join(", ")}).toArray().join("\n").split("\n").map(function(ub){return"    "+ub}).join("\n"));Id.exports.length&&(Eb+="\n  exports:\n",Eb+=Id.exports.map(function(ub){return ub.local?ub.local&&ub.local!==ub.exported?ub.local+" as "+ub.exported:ub.exported:ub.exported+
" from "+ub.fromModule}).join(", ").split("\n").map(function(ub){return"    "+ub}).join("\n"));Za.push(Eb);case 4:sc=qb.next(),ad.jumpTo(3)}})}function yc(ha){return ha.match(/import.*['"]mocha(-es6)?['"]/)&&ha.match(/it\(['"]/)}function Gc(ha,Ha,W){W=W&&W.address;if(W&&0===Ha.indexOf(W))var ra=Ha.slice(W.length).replace(/^\//,"");else a:{W=ha.getConfig();if(!W||W.constructor!==Promise)try{ra=String((new ab.URL(Ha)).relativePathFrom(new ab.URL(ha.getConfig().baseURL)));break a}catch(Za){}ra=Ha}return ra}
function Qb(ha,Ha,W,ra){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){return 1==Za.nextAddress?(ra=Object.assign({targetModule:Ha},ra),Za.yield(ha.normalize(Ha),2)):3!=Za.nextAddress?(Ha=Za.yieldResult,Za.yield(ha.moduleSourceChange(Ha,W,ra),3)):Za.return(Ha)})}function Ec(ha,Ha,W,ra,Za){ra=void 0===ra?!1:ra;Za=void 0===Za?!1:Za;var qb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sc){switch(sc.nextAddress){case 1:return Ha&&Ha.setStatusMessage("Reloading "+W),sc.setCatchFinallyBlocks(2),
sc.yield(ha.reloadModule(W,{reloadDeps:ra,resetEnv:Za}),4);case 4:if(!Ha){sc.jumpTo(5);break}return sc.yield(Ha.updateModuleList(),6);case 6:case 5:Ha&&Ha.setStatusMessage("Reloded "+W);sc.leaveTryBlock(0);break;case 2:qb=sc.enterCatchBlock();sc.setCatchFinallyBlocks(7);if(!Ha){sc.jumpTo(9);break}return sc.yield(Ha.updateEditorWithSourceOf(W),10);case 10:case 9:sc.leaveTryBlock(8);break;case 7:sc.enterCatchBlock();case 8:throw Ha&&Ha.showError(qb),qb;}})}function dd(ha,Ha,W){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){switch(ra.nextAddress){case 1:return ra.yield(ha.forgetModule(W,
{forgetEnv:!0,forgetDeps:!0}),2);case 2:if(!Ha){ra.jumpTo(3);break}return ra.yield(Ha.updateModuleList(),4);case 4:case 3:ra.jumpToEnd()}})}function Hd(ha,Ha,W){var ra,Za,qb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sc){switch(sc.nextAddress){case 1:return sc.yield(ha.normalize(W),2);case 2:return ra=sc.yieldResult,sc.yield(Ha.world().confirm("Remove file "+ra+"?",{requester:Ha}),3);case 3:Za=sc.yieldResult;if(!Za)throw"Canceled";return sc.yield(ha.forgetModule(ra),4);case 4:return sc.yield(ha.resourceRemove(ra),
5);case 5:return sc.yield(ha.getPackageForModule(ra),6);case 6:return qb=sc.yieldResult,sc.return(qb)}})}function Ld(ha,Ha,W){var ra,Za,qb,sc,wd,nc,Ob,$d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Id){switch(Id.nextAddress){case 1:return ra=ab.URL,Id.yield(ha.getConfig(),2);case 2:Za=new ra(Id.yieldResult.baseURL);qb=Ha.world();if(!W){Id.jumpTo(3);break}return Id.yield(ha.getPackage(W),4);case 4:if(sc=Id.yieldResult){Id.jumpTo(5);break}return Id.yield(ha.getPackageForModule(W),6);
case 6:sc=Id.yieldResult;case 5:(wd=sc)&&(Za=new ab.URL(wd.address));case 3:return Id.yield(ab._searchForExistingFiles(Ha,String(Za),wd),7);case 7:nc=Id.yieldResult;if(!nc.includes("[create new module]")){Id.jumpTo(8);break}return Id.yield(ab._askForModuleName(ha,W||String(Za),qb),9);case 9:Ob=Id.yieldResult,nc=[Ob];case 8:return Id.yield(ab._createAndLoadModules(ha,nc),10);case 10:return $d=Id.yieldResult,ab.arr.compact($d.map(function(kb){return kb.error})),Id.return($d)}})}function uc(ha,Ha){var W,
ra,Za,qb,sc,wd,nc,Ob,$d,Id;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kb){if(1==kb.nextAddress)return kb.yield(ha.getPackage(Ha),2);if(3!=kb.nextAddress){W=kb.yieldResult;if(!W||!W.address.match(/^http/))throw Error("Cannot load package "+Ha);ra=ab.resource(W.address);Za=[];qb=$jscomp;sc=qb.makeIterator;return kb.yield(ra.dirList(5,{exclude:ab.modulesInPackage_defaultExclude}),3)}wd=sc.call(qb,kb.yieldResult);for(nc=wd.next();!nc.done;nc=wd.next())$d=Ob=nc.value,Id=$d.url,Id.match(/\.js$/)&&
ha.isModuleLoaded(Id,!0)&&Za.push(ha.getModule(Id));return kb.return(Za)})}function rb(ha){ha||(ha="local");if(ha.isSystemInterface)var Ha=ha;else"string"===typeof ha&&ha.startsWith("l2l ")&&(ha={type:"l2l",id:ha.split(" ")[1]}),"string"!==typeof ha&&"l2l"===ha.type&&(Ha=vb.l2lInterfaceFor(ha.id,ha.info)),"string"!==typeof ha&&($world.setStatusMessage("Unknown system interface "+ha),ha="local"),Ha||(Ha=ha&&"local"!==ha?vb.serverInterfaceFor(ha):vb.localInterface);return Ha}Ca("systemInterfaceNamed",
rb);var Gb=lively.FreezerRuntime.recorderFor("lively-system-interface/helpers.js");Gb.parseJsonLikeObj=ke;Gb.ast=Bb;Gb.parseJsonLikeObj=ke;Gb.parseJsonLikeObj=ke;var Oa=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/packages.js");Oa.loadPackage=function(ha,Ha){var W,ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){switch(Za.nextAddress){case 1:return Za.yield(ha.importPackage(Ha.address+"/"),2);case 2:if(!Ha.main){Za.jumpTo(3);break}return Za.yield(ha.importModule(Ha.main.toString()),
3);case 3:if(!Ha.test){Za.jumpTo(5);break}Za.setCatchFinallyBlocks(6);return Za.yield(ha.importPackage("mocha-es6"),8);case 8:return W=Za.yieldResult,Za.yield(W.installSystemInstantiateHook(),9);case 9:return Za.yield(ha.importModule(Ha.test.toString()),10);case 10:Za.leaveTryBlock(5);break;case 6:ra=Za.enterCatchBlock(),console.warn("Cannot load test of new package: "+ra);case 5:return Za.return(ha.getPackage(Ha.address))}})};Oa.interactivelyCreatePackage=cc;Oa.interactivelyLoadPackage=Jc;Oa.interactivelyReloadPackage=
Nd;Oa.interactivelyUnloadPackage=ec;Oa.interactivelyRemovePackage=Zd;Oa.showExportsAndImportsOf=le;Oa.parseJsonLikeObj=ke;Oa.arr=Kb;Oa.resource=lc;Oa.interactivelyCreatePackage=cc;Oa.interactivelyCreatePackage=cc;Oa.interactivelyLoadPackage=Jc;Oa.interactivelyLoadPackage=Jc;Oa.interactivelyReloadPackage=Nd;Oa.interactivelyReloadPackage=Nd;Oa.interactivelyUnloadPackage=ec;Oa.interactivelyUnloadPackage=ec;Oa.interactivelyRemovePackage=Zd;Oa.interactivelyRemovePackage=Zd;Oa.showExportsAndImportsOf=le;
Oa.showExportsAndImportsOf=le;var ab=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/modules.js");ab.isTestModule=yc;ab.shortModuleName=Gc;ab.interactivelyChangeModule=Qb;ab.interactivelyReloadModule=Ec;ab.interactivelyUnloadModule=dd;ab.interactivelyRemoveModule=Hd;ab.interactivelyAddModule=Ld;ab._askForModuleName=function(ha,Ha,W){var ra,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qb){switch(qb.nextAddress){case 1:return qb.yield(W.prompt("Enter module name",
{input:Ha,historyId:"lively.vm-editor-add-module-name"}),2);case 2:Ha=qb.yieldResult;if(!Ha)throw"Canceled";return qb.yield(ha.normalize(Ha),3);case 3:return ra=qb.yieldResult,qb.yield(W.confirm(["Create module \n",{},ra,{fontStyle:"italic"}," ?",{}],{lineWrapping:!1}),4);case 4:Za=qb.yieldResult;if(!Za)throw"Canceled";return qb.return(ra)}})};ab._searchForExistingFiles=function(ha,Ha,W){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return String(Ha).match(/^http/)?ra.return(ab._searchForExistingFilesWeb(ha,
Ha,W)):ra.return(ab._searchForExistingFilesManually(ha,Ha,W))})};ab._searchForExistingFilesManually=function(ha,Ha,W){var ra,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qb){switch(qb.nextAddress){case 1:return qb.yield(ha.world().multipleChoicePrompt("Add Module",{requester:ha,choices:["Create New Module","Load Existing Module"]}),2);case 2:ra=qb.yieldResult;if("Create New Module"===ra)return qb.return("[create new module]");if("Load Existing Module"!==ra){qb.jumpTo(3);break}return qb.yield(ha.world().prompt("URL of module?",
{input:Ha,requester:ha,historyId:"lively.vm._searchForExistingFilesManually.url-of-module"}),4);case 4:if(Za=qb.yieldResult)return qb.return([Za]);case 3:throw"Canceled";}})};ab._searchForExistingFilesWeb=function(ha,Ha,W){function ra($d){$d.name();return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes($d.name())||W&&ab.arr.pluck(W.modules,"name").includes($d.url)?!0:!1}var Za,qb,sc,wd,nc,Ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function($d){switch($d.nextAddress){case 1:return(Za=
ha.world())&&(qb=Za.showLoadingIndicatorFor(ha,"Loading existing modules...")),$d.yield(ab.resource(Ha).dirList(5,{exclude:ra}),3);case 3:return $d.yield($d.yieldResult.map(function(Id){return Id.url}),2);case 2:return sc=$d.yieldResult,wd=[{isListItem:!0,string:"[create new module]",value:"[create new module]"}].concat(sc.filter(function(Id){return Id.endsWith(".js")}).map(function(Id){return{isListItem:!0,string:W&&0==Id.indexOf(W.address)?W.name+Id.slice(W.address.length):Id,value:Id}})),$d.yield(Promise.resolve(qb&&
qb.remove()).then(function(){return ha.world().filterableListPrompt("What module to load?",wd,Object.assign({filterLabel:"filter: ",multiselect:!0,requester:ha},ha?{extent:ha.bounds().extent().withY(400).subXY(50,0)}:{}))}),4);case 4:nc=$d.yieldResult;if(!nc||"canceled"===nc.status||!nc.selected.length)throw"Canceled";Ob=nc.selected||nc;Array.isArray(Ob)||(Ob=[Ob]);return $d.return(Ob)}})};ab._createAndLoadModules=function(ha,Ha){var W,ra,Za,qb,sc,wd,nc,Ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function($d){switch($d.nextAddress){case 1:Array.isArray(Ha)||
(Ha=[Ha]),W=[],ra=$jscomp.makeIterator(Ha),Za=ra.next();case 2:if(Za.done){$d.jumpTo(4);break}qb=Za.value;return $d.yield(ha.forgetModule(qb,{forgetDeps:!1,forgetEnv:!1}),5);case 5:return $d.yield(ha.resourceEnsureExistance(qb,'"format esm";\n'),6);case 6:return sc=$d.yieldResult,wd=ab,nc=wd.isTestModule,$d.yield(sc.read(),7);case 7:if(!nc.call(wd,$d.yieldResult)){$d.jumpTo(8);break}if(window.Mocha&&window.chai){$d.jumpTo(8);break}return $d.yield(System.import("mocha-es6"),10);case 10:return $d.yield(ab.promise.waitFor(function(){return!!window.Mocha&&
!!window.chai}),8);case 8:return $d.setCatchFinallyBlocks(12),$d.yield(ha.importModule(qb),14);case 14:W.push({name:qb});$d.leaveTryBlock(3);break;case 12:Ob=$d.enterCatchBlock(),W.push({name:qb,error:Ob});case 3:Za=ra.next();$d.jumpTo(2);break;case 4:return $d.return(W)}})};ab.modulesInPackage_defaultExclude=function(ha){return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes(ha.name())?!0:!1};ab.modulesInPackage=uc;ab.obj=bc;ab.promise=Td;ab.arr=Kb;ab.resource=lc;ab.isTestModule=
yc;ab.isTestModule=yc;ab.shortModuleName=Gc;ab.shortModuleName=Gc;ab.interactivelyChangeModule=Qb;ab.interactivelyChangeModule=Qb;ab.interactivelyReloadModule=Ec;ab.interactivelyReloadModule=Ec;ab.interactivelyUnloadModule=dd;ab.interactivelyUnloadModule=dd;ab.interactivelyRemoveModule=Hd;ab.interactivelyRemoveModule=Hd;ab.interactivelyAddModule=Ld;ab.interactivelyAddModule=Ld;ab.modulesInPackage=uc;ab.modulesInPackage=uc;var Qa=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/interface.js");
Qa.todo=function(ha){throw Error(ha+" is not yet implemented!");};Qa.parseJsonLikeObj=ke;Qa.arr=Kb;Qa.Closure=Xc;Qa.obj=bc;Qa.resource=lc;Qa.transform=Wd;Qa.modules=$c;var Ja=function(){};Ja.prototype.dynamicCompletionsForPrefix=function(ha,Ha,W){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){Qa.todo("dynamicCompletionsForPrefix");ra.jumpToEnd()})};Ja.prototype.runEval=function(ha,Ha){Qa.todo("runEval")};Ja.prototype.resourceExists=function(ha){Qa.todo("resourceExists")};Ja.prototype.resourceEnsureExistance=
function(ha,Ha){Qa.todo("resourceEnsureExistance")};Ja.prototype.resourceMkdir=function(ha){Qa.todo("resourceMkdir")};Ja.prototype.resourceRead=function(ha){Qa.todo("resourceRead")};Ja.prototype.resourceRemove=function(ha){Qa.todo("resourceRemove")};Ja.prototype.resourceWrite=function(ha,Ha){Qa.todo("resourceWrite")};Ja.prototype.resourceCreateFiles=function(ha,Ha){Qa.todo("resourceCreateFiles")};Ja.prototype.resourceDirList=function(ha,Ha,W){Qa.todo("resourceDirList")};Ja.prototype.normalizeSync=
function(ha,Ha,W){Qa.todo("normalizeSync")};Ja.prototype.normalize=function(ha,Ha,W){Qa.todo("normalize")};Ja.prototype.printSystemConfig=function(){Qa.todo("printSystemConfig")};Ja.prototype.getConfig=function(){Qa.todo("getConfig")};Ja.prototype.setConfig=function(ha){Qa.todo("setConfig")};Ja.prototype.getPackages=function(ha){Qa.todo("getPackages")};Ja.prototype.isModuleLoaded=function(ha,Ha){Qa.todo("isModuleLoaded")};Ja.prototype.doesModuleExist=function(ha,Ha){Qa.todo("doesModuleExist")};Ja.prototype.getModules=
function(){var ha=this,Ha,W;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return 1==ra.nextAddress?(Ha=Qa.arr,W=Ha.flatmap,ra.yield(ha.getPackages(),2)):ra.return(W.call(Ha,ra.yieldResult,function(Za){return Za.modules}))})};Ja.prototype.getModule=function(ha){var Ha=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){return 1==W.nextAddress?W.yield(Ha.getModules(),2):W.return(W.yieldResult.find(function(ra){return ra.name===ha}))})};Ja.prototype.getPackage=function(ha){var Ha=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){return 1==W.nextAddress?(ha=ha.replace(/\/+$/,""),W.yield(Ha.getPackages(),2)):W.return(W.yieldResult.find(function(ra){return ra.address===ha||ra.name===ha}))})};Ja.prototype.getPackageForModule=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){Qa.todo("getPackageForModule");Ha.jumpToEnd()})};Ja.prototype.systemConfChange=function(ha){var Ha=Qa.parseJsonLikeObj(ha);["baseURL"].forEach(function(W){return delete Ha[W]});
return this.setConfig(Ha)};Ja.prototype.resourcesOfPackage=function(ha,Ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){Qa.todo("resourcesOfPackage");W.jumpToEnd()})};Ja.prototype.registerPackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){Qa.todo("registerPackage");Ha.jumpToEnd()})};Ja.prototype.importPackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){Qa.todo("importPackage");Ha.jumpToEnd()})};Ja.prototype.removePackage=
function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){Qa.todo("removePackage");Ha.jumpToEnd()})};Ja.prototype.reloadPackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){Qa.todo("reloadPackage");Ha.jumpToEnd()})};Ja.prototype.packageConfChange=function(ha,Ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){Qa.todo("packageConfChange");W.jumpToEnd()})};Ja.prototype.importModule=function(ha){Qa.todo("importModule")};Ja.prototype.forgetModule=
function(ha,Ha){Qa.todo("forgetModule")};Ja.prototype.reloadModule=function(ha,Ha){Qa.todo("reloadModule")};Ja.prototype.moduleFormat=function(ha){Qa.todo("moduleFormat")};Ja.prototype.moduleRead=function(ha){Qa.todo("moduleRead")};Ja.prototype.moduleSourceChange=function(ha,Ha,W){Qa.todo("moduleSourceChange")};Ja.prototype.importsAndExportsOf=function(ha,Ha){Qa.todo("importsAndExportsOf")};Ja.prototype.keyValueListOfVariablesInModule=function(ha,Ha){Qa.todo("keyValueListOfVariablesInModule")};Ja.prototype.moduleWrite=
function(ha,Ha){return this.moduleSourceChange(ha,Ha)};Qa.AbstractCoreInterface=Ja;var eb=function(){var ha=Qa.AbstractCoreInterface.call(this)||this;ha.currentEval=null;return ha};$jscomp.inherits(eb,Qa.AbstractCoreInterface);eb.prototype.runEval=function(ha,Ha){throw Error("Not yet implemented");};eb.prototype.runEvalAndStringify=function(ha,Ha){var W=this;return this.currentEval?this.currentEval.then(function(){return W.runEvalAndStringify(ha,Ha)}):this.currentEval=Promise.resolve().then(function(){var ra,
Za,qb,sc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wd){switch(wd.nextAddress){case 1:return wd.yield(W.runEval("\n        Promise.resolve((async "+Qa.transform.wrapInFunction(ha)+')())\n          .then(function(result) { return JSON.stringify(result); })\n          .catch(function(err) { return {isError: true, value: err}; })\n          .then(function(result) {\n            if (!result || typeof result === "string") return result;\n            return JSON.stringify(result.isError ?\n              {isError: true, value: (result.value + "\\n" + result.value.stack) || String(result.value)} :\n              result)\n          });',
Object.assign({targetModule:"lively://remote-lively-system/runEvalAndStringify",promiseTimeout:3E4,waitForPromise:!0},Ha)),2);case 2:if((ra=wd.yieldResult)&&ra.isError)throw Error(String(ra.value||ra.error));if(!ra||!ra.value)return wd.return(null);if(Za=ra.promisedValue){wd.jumpTo(3);break}return wd.yield(ra.value,4);case 4:Za=wd.yieldResult;case 3:qb=Za;if(!qb)return wd.return();if("undefined"===qb)return wd.return(void 0);if("null"===qb)return wd.return(null);if("true"===qb)return wd.return(!0);
if("false"===qb)return wd.return(!1);try{sc=JSON.parse(qb)}catch(nc){return wd.return(qb)}if(sc&&sc.isError)throw Error(String(sc.value));return wd.return(sc)}})}).then(function(ra){delete W.currentEval;return ra},function(ra){delete W.currentEval;return Promise.reject(ra)})};eb.prototype.dynamicCompletionsForPrefix=function(ha,Ha,W){var ra=this,Za,qb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sc){Za=Qa.obj.isString(W.context)?W.context:!1;W=Qa.obj.dissoc(W,["systemInterface","System",
"context"]);qb="\n      var prefix = "+JSON.stringify(Ha)+",\n          opts = "+JSON.stringify(W)+";\n      opts.context = "+Za+';\n      opts.classTransform = (await System.import("lively.classes")).classToFunctionTransform;\n      var evalFn = code => lively.vm.runEval(code, opts);\n      if (typeof System === "undefined") delete opts.targetModule;\n      lively.vm.completions.getCompletions(evalFn, prefix).then(function(result) {\n        if (result.isError) throw result.value;\n        return {\n          completions: result.completions,\n          prefix: result.startLetters\n        }\n      });';
return sc.return(ra.runEvalAndStringify(qb))})};eb.prototype.evalWithResource=function(ha,Ha,W){return this.runEvalAndStringify('\n      var {resource} = (typeof lively !== "undefined" && lively.resources)\n                    || await System.import("lively.resources");\n      await resource("'+ha+'").'+Ha+"("+(W?JSON.stringify(W):"")+");\n    ")};eb.prototype.resourceExists=function(ha){return this.evalWithResource(ha,"exists")};eb.prototype.resourceEnsureExistance=function(ha,Ha){return this.evalWithResource(ha,
"ensureExistance",Ha)};eb.prototype.resourceMkdir=function(ha){return this.evalWithResource(ha,"mkdir")};eb.prototype.resourceRead=function(ha){return this.evalWithResource(ha,"read")};eb.prototype.resourceRemove=function(ha){return this.evalWithResource(ha,"remove")};eb.prototype.resourceWrite=function(ha,Ha){return this.evalWithResource(ha,"write",Ha)};eb.prototype.resourceCreateFiles=function(ha,Ha){return this.runEvalAndStringify('var {createFiles} = await System.import("lively.resources"); await createFiles("'+
ha+'", '+JSON.stringify(Ha)+")")};eb.prototype.resourceDirList=function(ha,Ha,W){return this.runEvalAndStringify('\n      var {resource} = await System.import("lively.resources");\n      (await resource("'+ha+'").dirList('+JSON.stringify(Ha)+", "+JSON.stringify(W)+"))\n        .map(({url}) => ({url}))")};eb.prototype.livelySystemAccessor=function(ha){ha=void 0===ha?"livelySystem":ha;return"var "+ha+' = (typeof lively !== "undefined" && lively.systemInterface)\n      || System.get(System.decanonicalize("lively-system-interface"))\n      || (typeof lively !== "undefined" && lively.modules && await lively.modules.importPackage("lively-system-interface"));\n    if (!'+
ha+') throw new Error("lively-system-interface not available!");'};eb.prototype.normalizeSync=function(ha,Ha,W){return this.runEvalAndStringify("lively.modules.System.decanonicalize("+JSON.stringify(ha)+", "+JSON.stringify(Ha)+", "+W+")")};eb.prototype.normalize=function(ha,Ha,W){return this.runEvalAndStringify("lively.modules.System.normalize("+JSON.stringify(ha)+", "+JSON.stringify(Ha)+", "+JSON.stringify(W)+")")};eb.prototype.printSystemConfig=function(){return this.runEvalAndStringify("lively.modules.printSystemConfig()")};
eb.prototype.getConfig=function(){return this.runEvalAndStringify('var c = Object.assign({}, lively.modules.System.getConfig()); for (var name in c) if (name.indexOf("__lively.modules__") === 0 || name.indexOf("loads") === 0) delete c[name]; c')};eb.prototype.setConfig=function(ha){return this.runEvalAndStringify("lively.modules.System.config("+JSON.stringify(ha)+")")};eb.prototype.getPackages=function(ha){ha=Object.assign({excluded:[]},ha);ha.excluded=ha.excluded.map(String);return this.runEvalAndStringify("\n      "+
this.livelySystemAccessor()+";\n      var options = "+JSON.stringify(ha)+';\n      options.excluded = options.excluded.map(ea => {\n        let evaled = lively.vm.syncEval(ea).value;\n        return typeof evaled === "function" ? evaled : ea;\n      });\n      await livelySystem.localInterface.getPackages(options)\n        .map(ea => Object.assign({}, ea, {System: null}));')};eb.prototype.getPackageForModule=function(ha){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.getPackageForModule("+
JSON.stringify(ha)+")")};eb.prototype.isModuleLoaded=function(ha,Ha){return this.runEvalAndStringify('lively.modules.isModuleLoaded("'+ha+'", '+Ha+")")};eb.prototype.doesModuleExist=function(ha,Ha){return this.runEvalAndStringify('lively.modules.doesModuleExist("'+ha+'", '+Ha+")")};eb.prototype.registerPackage=function(ha){var Ha=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){return W.return(Ha.runEvalAndStringify("lively.modules.registerPackage("+JSON.stringify(ha)+")"))})};
eb.prototype.importPackage=function(ha){var Ha=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){return W.return(Ha.runEvalAndStringify("lively.modules.importPackage("+JSON.stringify(ha)+")"))})};eb.prototype.removePackage=function(ha){var Ha=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){return W.return(Ha.runEvalAndStringify("lively.modules.removePackage("+JSON.stringify(ha)+")"))})};eb.prototype.reloadPackage=function(ha,Ha){var W=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return ra.return(W.runEvalAndStringify("lively.modules.reloadPackage("+
JSON.stringify(ha)+", "+JSON.stringify(Ha)+")"))})};eb.prototype.packageConfChange=function(ha,Ha){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.packageConfChange("+JSON.stringify(ha)+", "+JSON.stringify(Ha)+")")};eb.prototype.resourcesOfPackage=function(ha,Ha){Ha=void 0===Ha?[".git","node_modules",".module_cache","lively.next-node_modules"]:Ha;var W=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){ha.address&&
(ha=ha.address);return ra.return(W.runEvalAndStringify("\n      "+W.livelySystemAccessor()+";\n      await livelySystem.localInterface.resourcesOfPackage("+JSON.stringify(ha)+", "+JSON.stringify(Ha)+");"))})};eb.prototype.getModule=function(ha){var Ha=this,W;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){if(1==ra.nextAddress)return ra.yield(Ha.getModules(),2);W=ra.yieldResult.find(function(Za){return Za.name===ha});return ra.return(W?Qa.modules.module(W.name):null)})};eb.prototype.importModule=
function(ha){return this.runEvalAndStringify("lively.modules.System.import("+JSON.stringify(ha)+")")};eb.prototype.forgetModule=function(ha,Ha){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(ha)+").unload("+JSON.stringify(Ha)+")")};eb.prototype.reloadModule=function(ha,Ha){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(ha)+").reload("+JSON.stringify(Ha)+")")};eb.prototype.moduleFormat=function(ha){return this.runEvalAndStringify("lively.modules.module("+
JSON.stringify(ha)+").format();")};eb.prototype.moduleRead=function(ha){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(ha)+").source()")};eb.prototype.moduleSourceChange=function(ha,Ha,W){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(ha)+").changeSource("+JSON.stringify(Ha)+", "+JSON.stringify(W)+")")};eb.prototype.keyValueListOfVariablesInModule=function(ha,Ha){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.keyValueListOfVariablesInModule("+
JSON.stringify(ha)+", "+JSON.stringify(Ha)+")")};eb.prototype.importsAndExportsOf=function(ha,Ha){return this.runEvalAndStringify("({\n      imports: await lively.modules.module("+JSON.stringify(ha)+").imports(),\n      exports: await lively.modules.module("+JSON.stringify(ha)+").exports()})")};eb.prototype.exportsOfModules=function(ha){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+"\n      const options = "+JSON.stringify(ha)+";\n      options.excludedPackages = ["+ha.excludedPackages.map(function(Ha){return"function"===
typeof Ha?Ha.toString():JSON.stringify(Ha)}).join(",")+"]\n      await livelySystem.localInterface.exportsOfModules(options)")};eb.prototype.searchInPackage=function(ha,Ha,W){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.searchInPackage("+JSON.stringify(ha)+", "+JSON.stringify(Ha)+", "+JSON.stringify(W)+")")};eb.prototype.loadMochaTestFile=function(ha,Ha){Ha=void 0===Ha?[]:Ha;var W=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return ra.return(W.runEvalAndStringify("\n      "+
W.livelySystemAccessor()+";\n      var {testsByFile} = await livelySystem.localInterface.loadMochaTestFile("+JSON.stringify(ha)+", "+JSON.stringify(Ha)+"), result;\n      result = {testsByFile}"))})};eb.prototype.runMochaTests=function(ha,Ha,W,ra){var Za=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qb){ha&&ha instanceof RegExp&&(ha={isRegExp:!0,value:String(ha).replace(/^\/|\/$/g,"")});return qb.return(Za.runEvalAndStringify("\n      var grep = "+JSON.stringify(ha)+";\n      if (grep && grep.isRegExp) grep = new RegExp(grep.value);\n      "+
Za.livelySystemAccessor()+";\n      var {testsByFile, isError, value: error} = await livelySystem.localInterface.runMochaTests(grep, "+JSON.stringify(Ha||[])+"), result;\n      error = error ? String(error.stack || error) : null;\n      if (testsByFile) {\n        testsByFile.forEach(ea =>\n          ea.tests.forEach(ea => {\n            if (!ea.error) return;\n            var {message, stack, actual, expected} = ea.error;\n            ea.error = {\n              message: message || String(ea.error),\n              stack: stack,\n              actual, exected\n            }\n          }));\n      }\n      result = {testsByFile, isError, error}"))})};
Qa.RemoteCoreInterface=eb;var Sb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/local-system.js");Sb.obj=bc;Sb.string=Pc;Sb.arr=Kb;Sb.resource=lc;Sb.createFiles=md;Sb.ast=Bb;Sb.modules=$c;Sb.vm=ge;Sb.parseJsonLikeObj=ke;Sb.AbstractCoreInterface=Ja;Sb.classToFunctionTransform=Qe;Ja=function(){return Sb.AbstractCoreInterface.apply(this,arguments)||this};$jscomp.inherits(Ja,Sb.AbstractCoreInterface);Ja.prototype.dynamicCompletionsForPrefix=function(ha,Ha,W){var ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==
Za.nextAddress)return Za.yield(Sb.vm.completions.getCompletions(function(qb){return Sb.vm.runEval(qb.replace("return ",""),Object.assign({targetModule:ha,classTransform:Sb.classToFunctionTransform},W))},Ha),2);ra=Za.yieldResult;if(ra.isError)throw ra.value;return Za.return({completions:ra.completions,prefix:ra.startLetters})})};Ja.prototype.runEval=function(ha,Ha){return Sb.vm.runEval(ha,Object.assign({classTransform:Sb.classToFunctionTransform},Ha))};Ja.prototype.resourceExists=function(ha){return Sb.resource(ha).exists()};
Ja.prototype.resourceEnsureExistance=function(ha,Ha){return Sb.resource(ha).ensureExistance(Ha)};Ja.prototype.resourceMkdir=function(ha){return Sb.resource(ha).mkdir()};Ja.prototype.resourceRead=function(ha){return Sb.resource(ha).read()};Ja.prototype.resourceRemove=function(ha){return Sb.resource(ha).remove()};Ja.prototype.resourceWrite=function(ha,Ha){return Sb.resource(ha).write(Ha)};Ja.prototype.resourceCreateFiles=function(ha,Ha){return Sb.createFiles(ha,Ha)};Ja.prototype.resourceDirList=function(ha,
Ha,W){return Sb.resource(ha).dirList(Ha,W)};Ja.prototype.normalizeSync=function(ha,Ha,W){return System.decanonicalize(ha,Ha,W)};Ja.prototype.normalize=function(ha,Ha,W){return System.normalize(ha,Ha,W)};Ja.prototype.printSystemConfig=function(){return Sb.modules.printSystemConfig()};Ja.prototype.getConfig=function(){return System.getConfig()};Ja.prototype.setConfig=function(ha){Sb.modules.System.config(ha)};Ja.prototype.getPackages=function(ha){ha=Object.assign({},ha);ha=void 0===ha.excluded?[]:ha.excluded;
var Ha=ha.filter(function(ra){return"string"===typeof ra}),W=ha.filter(function(ra){return"function"===typeof ra});Ha=Ha.concat(Ha.map(function(ra){return System.decanonicalize(ra.replace(/\/?$/,"/")).replace(/\/$/,"")}));return Sb.modules.getPackages().filter(function(ra){return!Ha.includes(ra.url)&&!W.some(function(Za){return Za(ra.url)})})};Ja.prototype.registerPackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){return Ha.return(Sb.modules.registerPackage(ha))})};
Ja.prototype.importPackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){return Ha.return(Sb.modules.importPackage(ha))})};Ja.prototype.removePackage=function(ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){return Ha.return(Sb.modules.removePackage(ha))})};Ja.prototype.reloadPackage=function(ha,Ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){return W.return(Sb.modules.reloadPackage(ha,Ha))})};Ja.prototype.packageConfChange=function(ha,
Ha){var W=this,ra,Za,qb,sc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wd){if(1==wd.nextAddress)return ra=Sb.modules.System,Za=Sb.parseJsonLikeObj(ha),qb=JSON.stringify(Za,null,2),wd.yield(Sb.modules.module(Ha).changeSource(qb,{doEval:!1}),2);if(3!=wd.nextAddress)return ra.set(Ha,ra.newModule(Za)),wd.yield(W.getPackageForModule(Ha),3);(sc=wd.yieldResult)&&Sb.modules.applyPackageConfig(Za,sc.address);wd.jumpToEnd()})};Ja.prototype.resourcesOfPackage=function(ha,Ha){Ha=void 0===Ha?[".git",
"node_modules",".module_cache"]:Ha;var W,ra,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qb){if(1==qb.nextAddress)return qb.setCatchFinallyBlocks(2),W=ha.address?ha.address:ha,ra=Sb.modules.getPackage(W),qb.yield(ra.resources(void 0,Ha),4);if(2!=qb.nextAddress)return qb.return(qb.yieldResult.map(function(sc){return Object.assign(sc,{package:sc.package.url})}));Za=qb.enterCatchBlock();console.warn("resourcesOfPackage error for "+ha+": "+Za);return qb.return([])})};Ja.prototype.getPackageForModule=
function(ha){return(ha=Sb.modules.getPackageOfModule(ha))?ha.asSpec():ha};Ja.prototype.isModuleLoaded=function(ha,Ha){return Sb.modules.isModuleLoaded(ha,Ha)};Ja.prototype.doesModuleExist=function(ha,Ha){return Sb.modules.isModuleLoaded(ha,Ha)};Ja.prototype.getModule=function(ha){return Sb.modules.module(ha)};Ja.prototype.importModule=function(ha){return Sb.modules.System.import(ha)};Ja.prototype.forgetModule=function(ha,Ha){return Sb.modules.module(ha).unload(Ha)};Ja.prototype.reloadModule=function(ha,
Ha){return Sb.modules.module(ha).reload(Ha)};Ja.prototype.moduleFormat=function(ha){return Sb.modules.module(ha).format()};Ja.prototype.moduleRead=function(ha){return Sb.modules.module(ha).source()};Ja.prototype.moduleSourceChange=function(ha,Ha,W){return Sb.modules.module(ha).changeSource(Ha,W)};Ja.prototype.keyValueListOfVariablesInModule=function(ha,Ha){var W=this,ra,Za,qb,sc,wd,nc,Ob,$d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Id){switch(Id.nextAddress){case 1:if(Ha){Id.jumpTo(2);
break}return Id.yield(W.resourceRead(ha),3);case 3:Ha=Id.yieldResult;case 2:return ra="string"===typeof Ha?Sb.ast.parse(Ha):Ha,Za=W.normalizeSync(ha),W.moduleFormat(Za),qb=Sb.modules.module(Za).env().recorder,Id.yield(W.importsAndExportsOf(Za,ra),4);case 4:return sc=Id.yieldResult,wd=Sb.ast.query.topLevelDeclsAndRefs(ra),nc=Sb.arr.sortByKey(Sb.ast.query.declarationsOfScope(wd.scope,!0),"start"),Ob=Sb.arr.pluck(wd.scope.importSpecifiers,"name"),$d=0,Id.return(nc.map(function(kb){var Eb=kb.name.length,
ad=sc.exports.find(function(cd){return cd.local===kb.name}),ub=Sb.arr.include(Ob,kb.name);ad&&(Eb+=9);ub&&(Eb+=9);$d=Math.max($d,Eb);return{isExport:ad,isImport:ub,name:kb.name,value:qb[kb.name],node:kb,printedName:kb.name+(ad?" [export]":"")+(ub?" [import]":""),printedValue:Sb.obj.inspect(qb[kb.name],{maxDepth:1}).replace(/\n/g,"")}}).map(function(kb){return{isListItem:!0,value:kb,string:kb.printedName+Sb.string.indent(" = "+kb.printedValue," ",$d-kb.printedName.length)}}))}})};Ja.prototype.importsAndExportsOf=
function(ha,Ha){var W;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return 1==ra.nextAddress?ra.yield(Sb.modules.module(ha).imports(Ha),2):3!=ra.nextAddress?(W=ra.yieldResult,ra.yield(Sb.modules.module(ha).exports(Ha),3)):ra.return({imports:W,exports:ra.yieldResult})})};Ja.prototype.exportsOfModules=function(ha){return Sb.modules.ExportLookup.run(System,ha)};Ja.prototype.searchInPackage=function(ha,Ha,W){return Sb.modules.getPackage(ha).search(Ha,W)};Ja.prototype.runMochaTests=function(ha,
Ha,W,ra){var Za,qb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sc){if(1==sc.nextAddress)return sc.yield(System.import("lively-system-interface/commands/mocha-tests.js"),2);Za=sc.yieldResult;qb=Za.runMochaTests;return sc.return(qb(ha,Ha,W,ra))})};Ja.prototype.loadMochaTestFile=function(ha,Ha){var W,ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==Za.nextAddress)return Za.yield(System.import("lively-system-interface/commands/mocha-tests.js"),2);W=Za.yieldResult;
ra=W.loadMochaTestFile;return Za.return(ra(ha,Ha))})};$jscomp.global.Object.defineProperties(Ja.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"local"}}});Sb.LocalCoreInterface=Ja;var Ac=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/http-interface.js");Ac.evalStrategies=kf;Ac.RemoteCoreInterface=eb;var sb=function(ha){var Ha=Ac.RemoteCoreInterface.call(this)||this;Ha.currentEval=null;Ha.url=ha;Ha.server=new Ac.evalStrategies.HttpEvalStrategy(ha);return Ha};
$jscomp.inherits(sb,Ac.RemoteCoreInterface);sb.prototype.runEval=function(ha,Ha){return this.server.runEval(ha,Ha)};$jscomp.global.Object.defineProperties(sb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this.url}},description:{configurable:!0,enumerable:!0,get:function(){return this.url.replace(/^https?:\/\//,"")}}});Ac.HTTPCoreInterface=sb;var Ab=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/l2l-interface.js");Ab.evalStrategies=kf;Ab.RemoteCoreInterface=
eb;eb=function(ha,Ha){var W=Ab.RemoteCoreInterface.call(this)||this;W.targetId=ha;W.peer=Ha;return W};$jscomp.inherits(eb,Ab.RemoteCoreInterface);eb.prototype.isConnected=function(){var ha=this,Ha,W,ra,Za,qb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sc){if(1==sc.nextAddress)return Ha=ha,W=Ha.client,ra=Ha.targetId,sc.yield(W.sendToAndWait(W.trackerId,"getClients",{}),2);Za=sc.yieldResult;qb=Za.data;return sc.return(qb.some(function(wd){wd=$jscomp.makeIterator(wd).next().value;return ra===
wd}))})};eb.prototype.runEval=function(ha,Ha){var W=this,ra,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qb){ra=W.client;if(!ra)throw Error("No lively.2lively default client available!");Za=new Ab.evalStrategies.L2LEvalStrategy(ra,W.targetId);return qb.return(Za.runEval(ha,Ha))})};$jscomp.global.Object.defineProperties(eb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"l2l "+this.targetId}},description:{configurable:!0,enumerable:!0,get:function(){var ha=this.peer,
Ha="l2l "+this.targetId.slice(0,5);if(ha){var W=ha.location,ra=ha.type,Za=ha.user;ha=ha.world;ra&&(Ha+=", "+ra);W&&(Ha+=", "+W.replace(/^https?:\/\//,"")+(ha?"/"+ha:""));Za&&(Ha+=", "+Za.name)}return Ha}},client:{configurable:!0,enumerable:!0,get:function(){return(lively.modules.module("lively.2lively/client.js").get()||{default:lively.l2l.L2LClient}).default.default()}}});Ab.L2LCoreInterface=eb;var vb=lively.FreezerRuntime.recorderFor("lively-system-interface/index.js");vb.systemInterfaceNamed=rb;
vb.interactivelyCreatePackage=cc;vb.interactivelyLoadPackage=Jc;vb.interactivelyReloadPackage=Nd;vb.interactivelyUnloadPackage=ec;vb.interactivelyRemovePackage=Zd;vb.showExportsAndImportsOf=le;vb.shortModuleName=Gc;vb.interactivelyChangeModule=Qb;vb.interactivelyReloadModule=Ec;vb.interactivelyUnloadModule=dd;vb.interactivelyRemoveModule=Hd;vb.interactivelyAddModule=Ld;vb.modulesInPackage=uc;vb.LocalCoreInterface=Ja;vb.HTTPCoreInterface=sb;vb.L2LCoreInterface=eb;eb=function(ha){this.coreInterface=
ha};eb.prototype.dynamicCompletionsForPrefix=function(ha,Ha,W){return this.coreInterface.dynamicCompletionsForPrefix(ha,Ha,W)};eb.prototype.runEval=function(ha,Ha){return this.coreInterface.runEval(ha,Ha)};eb.prototype.printSystemConfig=function(ha,Ha,W){return this.coreInterface.printSystemConfig(ha,Ha,W)};eb.prototype.getConfig=function(ha,Ha,W){return this.coreInterface.getConfig(ha,Ha,W)};eb.prototype.getPackages=function(ha){return this.coreInterface.getPackages(ha)};eb.prototype.getModules=
function(ha,Ha,W){return this.coreInterface.getModules(ha,Ha,W)};eb.prototype.getModule=function(ha,Ha,W){return this.coreInterface.getModule(ha,Ha,W)};eb.prototype.getPackage=function(ha,Ha,W){return this.coreInterface.getPackage(ha,Ha,W)};eb.prototype.getPackageForModule=function(ha,Ha,W){return this.coreInterface.getPackageForModule(ha,Ha,W)};eb.prototype.resourcesOfPackage=function(ha,Ha){return this.coreInterface.resourcesOfPackage(ha,Ha)};eb.prototype.systemConfChange=function(ha,Ha,W){return this.coreInterface.systemConfChange(ha,
Ha,W)};eb.prototype.registerPackage=function(ha){return this.coreInterface.registerPackage(ha)};eb.prototype.importPackage=function(ha){return this.coreInterface.importPackage(ha)};eb.prototype.removePackage=function(ha){return this.coreInterface.removePackage(ha)};eb.prototype.reloadPackage=function(ha){return this.coreInterface.reloadPackage(ha)};eb.prototype.packageConfChange=function(ha,Ha){return this.coreInterface.packageConfChange(ha,Ha)};eb.prototype.keyValueListOfVariablesInModule=function(ha,
Ha){return this.coreInterface.keyValueListOfVariablesInModule(ha,Ha)};eb.prototype.interactivelyCreatePackage=function(ha){return vb.interactivelyCreatePackage(this.coreInterface,ha)};eb.prototype.interactivelyLoadPackage=function(ha,Ha){return vb.interactivelyLoadPackage(this.coreInterface,ha,Ha)};eb.prototype.interactivelyReloadPackage=function(ha,Ha){return vb.interactivelyReloadPackage(this.coreInterface,ha,Ha)};eb.prototype.interactivelyUnloadPackage=function(ha,Ha,W){return vb.interactivelyUnloadPackage(this.coreInterface,
ha,Ha,W)};eb.prototype.interactivelyRemovePackage=function(ha,Ha){return vb.interactivelyRemovePackage(this.coreInterface,ha,Ha)};eb.prototype.isModuleLoaded=function(ha,Ha){return this.coreInterface.isModuleLoaded(ha,Ha)};eb.prototype.doesModuleExist=function(ha,Ha){return this.coreInterface.doesModuleExist(ha,Ha)};eb.prototype.importModule=function(ha){return this.coreInterface.importModule(ha)};eb.prototype.forgetModule=function(ha,Ha){return this.coreInterface.forgetModule(ha,Ha)};eb.prototype.reloadModule=
function(ha,Ha){return this.coreInterface.reloadModule(ha,Ha)};eb.prototype.moduleFormat=function(ha){return this.coreInterface.moduleFormat(ha)};eb.prototype.moduleRead=function(ha){return this.coreInterface.moduleRead(ha)};eb.prototype.moduleWrite=function(ha,Ha){return this.coreInterface.moduleWrite(ha,Ha)};eb.prototype.getModulesInPackage=function(ha){return vb.modulesInPackage(this.coreInterface,ha)};eb.prototype.shortModuleName=function(ha,Ha){return vb.shortModuleName(this.coreInterface,ha,
Ha)};eb.prototype.interactivelyChangeModule=function(ha,Ha,W){return vb.interactivelyChangeModule(this.coreInterface,ha,Ha,W)};eb.prototype.interactivelyReloadModule=function(ha,Ha){return vb.interactivelyReloadModule(this.coreInterface,ha,Ha)};eb.prototype.interactivelyUnloadModule=function(ha,Ha){return vb.interactivelyUnloadModule(this.coreInterface,ha,Ha)};eb.prototype.interactivelyRemoveModule=function(ha,Ha){return vb.interactivelyRemoveModule(this.coreInterface,ha,Ha)};eb.prototype.interactivelyAddModule=
function(ha,Ha){return vb.interactivelyAddModule(this.coreInterface,ha,Ha)};eb.prototype.showExportsAndImportsOf=function(ha,Ha){return vb.showExportsAndImportsOf(this.coreInterface,ha,Ha)};eb.prototype.exportsOfModules=function(ha){return this.coreInterface.exportsOfModules(ha)};eb.prototype.searchInPackage=function(ha,Ha,W){return this.coreInterface.searchInPackage(ha,Ha,W)};eb.prototype.searchInAllPackages=function(ha,Ha){Ha=void 0===Ha?{}:Ha;var W=this,ra,Za,qb,sc,wd,nc,Ob,$d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Id){switch(Id.nextAddress){case 1:return(ra=
Ha.progress)&&ra.step("Fetching Packages...",0),Id.yield(W.coreInterface.getPackages({excluded:Ha.excludedPackages}),2);case 2:Za=Id.yieldResult,qb=[],ra&&ra.step("Fetching Packages...",.1),sc=0;case 3:if(!(sc<Za.length)){Id.jumpTo(5);break}wd=Za[sc];nc=wd.url;if(!nc||"no group"===nc){Id.jumpTo(4);break}ra&&ra.step(nc.replace(System.baseURL,"").slice(0,20),.1+sc/Za.length*.9);Id.setCatchFinallyBlocks(6);return Id.yield(W.coreInterface.searchInPackage(nc,ha,Ha),8);case 8:Ob=Id.yieldResult;qb=qb.concat(Ob);
Id.leaveTryBlock(4);break;case 6:$d=Id.enterCatchBlock(),console.error("Error searching in package "+nc+":\n"+$d.stack);case 4:sc++;Id.jumpTo(3);break;case 5:return Id.return(qb)}})};eb.prototype.loadMochaTestFile=function(ha,Ha){return this.coreInterface.loadMochaTestFile(ha,Ha)};eb.prototype.runMochaTests=function(ha,Ha,W,ra){return this.coreInterface.runMochaTests(ha,Ha,W,ra)};$jscomp.global.Object.defineProperties(eb.prototype,{isSystemInterface:{configurable:!0,enumerable:!0,get:function(){return!0}},
name:{configurable:!0,enumerable:!0,get:function(){return this.coreInterface.name}}});Ca("Interface",eb);vb.Interface=eb;vb.systemInterfaceNamed=rb;vb.systemInterfaceNamed=rb;eb=Ca("localInterface",new vb.Interface(new vb.LocalCoreInterface));vb.localInterface=eb;vb.localInterface=eb;vb.localInterface=eb;vb.httpInterfaces={};eb=Ca("serverInterfaceFor",function(ha){return vb.httpInterfaces[ha]||(vb.httpInterfaces[ha]=new vb.Interface(new vb.HTTPCoreInterface(ha)))});vb.serverInterfaceFor=eb;vb.serverInterfaceFor=
eb;vb.serverInterfaceFor=eb;vb.l2lInterfaces={};eb=Ca("l2lInterfaceFor",function(ha,Ha){return vb.l2lInterfaces[ha]||(vb.l2lInterfaces[ha]=new vb.Interface(new vb.L2LCoreInterface(ha,Ha)))});vb.l2lInterfaceFor=eb;vb.l2lInterfaceFor=eb;vb.l2lInterfaceFor=eb}}});
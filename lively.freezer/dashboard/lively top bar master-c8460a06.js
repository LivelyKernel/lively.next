System.register("./__root_module__-7cbd94df.js kld-intersections ./user-ui-9501eee5.js ./index-074bddfe.js ./index-a563870d.js ./editor-plugin-aefcac89.js ./index-cfc100d1.js".split(" "),function(Da,Ab){var Rb,jc,cc,je,fd,Yd,jd,Pc;return{setters:[function(vd){Rb=vd.ai;jc=vd.ao;cc=vd.a3;je=vd.C;fd=vd.a6;Yd=vd.L;jd=vd.r;Pc=vd.as},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var vd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");vd.Morph=
Rb;vd.Icon=jc;vd.pt=cc;vd.Color=je;vd.arr=fd;vd.LoadingIndicator=Yd;vd.resource=jd;var Ld=function(ge){var Td=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),md=Td.hasOwnProperty("LivelyTopBar")&&"function"===typeof Td.LivelyTopBar?Td.LivelyTopBar:Td.LivelyTopBar=function(Za){Za&&Za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Pc(md,ge,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode=
"Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var Za=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){if(1==Db.nextAddress)return Za.isComponent?Db.return():Db.yield(Za.whenRendered(),2);document.body.style.background="black";Za.setEditMode("Halo");Za.getSubmorphNamed("fast load toggler").refresh();Db.jumpToEnd()})}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=vd.pt(0,0));var Za=
this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;Za.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var Za=this;return Object.entries(this.shapeToIcon).map(function(Db){Db=$jscomp.makeIterator(Db);var ac=Db.next().value,ic=Db.next().value;Db=ic.shortcut;ic=ic.args;return[[].concat($jscomp.arrayFromIterable(Za.currentShapeMode===ac?[].concat($jscomp.arrayFromIterable(vd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),
$jscomp.arrayFromIterable(vd.Icon.textAttribute.apply(vd.Icon,$jscomp.arrayFromIterable(ic))),["   "+ac+" ",{float:"none"},"      "+Db,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){Za.currentShapeMode=ac;Za.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var Za=this;return Object.entries(this.sideBarToIcon).map(function(Db){Db=$jscomp.makeIterator(Db);var ac=Db.next().value;Db=Db.next().value.args;return[[].concat($jscomp.arrayFromIterable(Za.activeSideBars.includes(ac)?
[].concat($jscomp.arrayFromIterable(vd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(vd.Icon.textAttribute.apply(vd.Icon,$jscomp.arrayFromIterable(Db))),["   "+ac+" ",{float:"none"}]),function(){return Za.openSideBar(ac)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",
value:function(Za){"Hand"==this._currentEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(Za){Pc._get(Object.getPrototypeOf(md.prototype),"onKeyDown",this).call(this,Za);if(Za.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!Za.isAltDown()){var Db={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(Za.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=
Db[Za.key];this.setEditMode("Shape");break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(Za){var Db=this,ac,ic,gd,fe,Yb,qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ob){switch(Ob.nextAddress){case 1:Db.activeSideBars.includes(Za)?vd.arr.remove(Db.activeSideBars,Za):Db.activeSideBars.push(Za);if("Scene Graph"!=Za){Ob.jumpTo(2);break}if(Db.sideBar){Ob.jumpTo(3);break}ac=vd.LoadingIndicator.open("loading side bar");ic=Db;return Ob.yield(Ab.import("./scene graph side bar master-c9dfde6f.js"),
5);case 5:if(!(gd=Ob.yieldResult)){Ob.jumpTo(6);break}return Ob.yield(vd.resource("part://SystemIDE/scene graph side bar master"),7);case 7:gd=Ob.yieldResult;case 6:return Ob.yield(gd.read(),4);case 4:return ic.sideBar=Ob.yieldResult,Db.sideBar.hasFixedPosition=!0,Db.sideBar.respondsToVisibleWindow=!0,Db.sideBar.openInWorld(),Db.sideBar.right=0,Ob.yield(Db.sideBar.whenRendered(),8);case 8:ac.remove();case 3:Db.sideBar.toggle(Db.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=
Za){Ob.jumpTo(0);break}if(Db.stylingPalette){Ob.jumpTo(10);break}fe=vd.LoadingIndicator.open("loading side bar");Yb=Db;return Ob.yield(Ab.import("./styling side bar master-fc28f868.js"),12);case 12:if(!(qc=Ob.yieldResult)){Ob.jumpTo(13);break}return Ob.yield(vd.resource("part://SystemIDE/styling side bar master"),14);case 14:qc=Ob.yieldResult;case 13:return Ob.yield(qc.read(),11);case 11:return Yb.stylingPalette=Ob.yieldResult,Db.stylingPalette.collapseAll(),Db.stylingPalette.hasFixedPosition=!0,
Db.stylingPalette.respondsToVisibleWindow=!0,Db.stylingPalette.openInWorld(),Db.stylingPalette.left=Db.world().right,Ob.yield(Db.stylingPalette.whenRendered(),15);case 15:fe.remove();case 10:Db.stylingPalette.toggle(Db.activeSideBars.includes("Styling Palette")),Ob.jumpToEnd()}})}},{key:"onMouseDown",value:function(Za){var Db=this.get("select shape type"),ac=this.get("shape mode button"),ic=this.get("side bar selector");Za.targetMorph==Db&&(this.world().openWorldMenu(Za,this.getShapeMenuItems()).position=
ac.globalBounds().bottomLeft().subPt(this.world().scroll));Za.targetMorph==ac&&this.setEditMode("Shape");"text mode button"==Za.targetMorph.name&&this.setEditMode("Text");"hand mode button"==Za.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==Za.targetMorph.name&&this.setEditMode("Halo");"open component browser"==Za.targetMorph.name&&this.interactivelyLoadComponent();"load world button"==Za.targetMorph.name&&this.world().execCommand("load world");Za.targetMorph==ic&&(this.world().openWorldMenu(Za,
this.getSideBarMenuItems()).position=ic.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var Za=this,Db,ac,ic,gd,fe;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yb){if(1==Yb.nextAddress)return Db=Za.get("open component browser"),ac=Za.get("user flap"),ic=ac.haloShadow,gd=ac.haloColor,fe=vd.Color.rgb(102,102,102),Db.fontColor=gd,Db.dropShadow=ic,Yb.yield(Za.world().execCommand("browse and load component"),2);Db.dropShadow=!1;
Db.fontColor=fe;Yb.jumpToEnd()})}},{key:"setEditMode",value:function(Za,Db){var ac=this;Db=void 0===Db?!1:Db;var ic=this.get("user flap"),gd=ic.haloShadow,fe=ic.haloColor,Yb=vd.Color.rgb(102,102,102);Db||(this._currentEditMode=Za);Db=this.get("shape mode button");ic=this.get("text mode button");var qc=this.get("hand mode button"),Ob=this.get("halo mode button");[["Shape",Db.submorphs],["Text",[ic]],["Hand",[qc]],["Halo",[Ob]]].forEach(function(Hc){var Yc=$jscomp.makeIterator(Hc);Hc=Yc.next().value;
Yc=Yc.next().value;"Shape"==Za?ac.world().toggleShapeMode(!0,ac.currentShapeMode):"Text"==Za?ac.world().toggleShapeMode(!0,"Text"):ac.world().toggleShapeMode(!1);ac.world().showHaloPreviews("Halo"==Za);Hc==Za?Yc.forEach(function(cd){cd.dropShadow=gd;cd.fontColor=fe}):Yc.forEach(function(cd){cd.dropShadow=null;cd.fontColor=Yb})})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],
set:function(Za){this.setProperty("currentShapeMode",Za);this.get("shape status icon").textAndAttributes=vd.Icon.textAttribute(this.shapeToIcon[Za].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},
Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],Td,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-154"}}},{start:328,end:9325})}(vd.Morph);Ld=vd.LivelyTopBar;vd.default=Ld}}});System.register("22",["./__root_module__-7cbd94df.js","kld-intersections","./user-ui-9501eee5.js","./index-6dd3a7ed.js"],function(){return{setters:[function(){},function(){},function(){},function(){}],execute:function(){}}});
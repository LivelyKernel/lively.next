System.register(["./__root_module__-7cbd94df.js","kld-intersections","./user-ui-9501eee5.js","./index-6dd3a7ed.js","./index-2043039c.js"],function(Da,Ab){var Rb,jc,cc,je,fd,Yd,jd,Pc,vd,Ld,ge,Td,md,Za,Db,ac,ic,gd,fe;return{setters:[function(Yb){Rb=Yb.ai;jc=Yb.aB;cc=Yb.ak;je=Yb.an;fd=Yb.Z;Yd=Yb.a6;jd=Yb.at;Pc=Yb.s;vd=Yb.C;Ld=Yb.a3;ge=Yb.r;Td=Yb.as;md=Yb.aA;Za=Yb.a$;Db=Yb.b0;ac=Yb.aq;ic=Yb.aY;gd=Yb.aX},function(){},function(Yb){fe=Yb.UserUI},function(){},function(){}],execute:function(){var Yb=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");Yb.Morph=Rb;Yb.HorizontalLayout=jc;Yb.VerticalLayout=cc;Yb.morph=je;Yb.MorphicDB=fd;Yb.arr=Yd;Yb.fun=jd;Yb.string=Pc;Yb.Color=vd;Yb.pt=Ld;Yb.UserUI=fe;Yb.resource=ge;var qc=function(Yc){var cd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),$b=cd.hasOwnProperty("WorldDashboard")&&"function"===typeof cd.WorldDashboard?cd.WorldDashboard:cd.WorldDashboard=function(pb){pb&&pb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Td($b,Yc,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(pb){pb=void 0===pb?$world:pb;this.owner!=pb&&pb.addMorph(this);this.center=pb.visibleBounds().center()}},{key:"sortAndFilterPreviews",
value:function(pb){var xc=Yb.UserUI.getCurrentUser();pb=this.ui.searchField.fuzzyFilter(pb,function(Lc){return Lc._commit.name+Lc._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return Yb.arr.sortBy(pb,function(Lc){return-Lc._commit.timestamp});case "TEMPLATES":return pb;case "MY PROJECTS":return Yb.arr.filter(pb,function(Lc){return Lc._commit.author.name===xc.name});case "PUBLISHED":return pb}}},{key:"updateList",value:function(){var pb=this;this.previews&&Yb.fun.debounceNamed("update world list",
150,function(){pb.ui.worldList.items=pb.sortAndFilterPreviews(pb.previews)})()}},{key:"displayWorlds",value:function(){var pb=this,xc,Lc,Ga,Ra,rb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Kb){switch(Kb.nextAddress){case 1:return pb.reset(),xc=pb.ui,Lc=xc.loadingLabel,Lc.animate({opacity:1,duration:300}),Kb.yield(pb.db.latestCommits("world"),2);case 2:return Ga=Kb.yieldResult,Kb.yield(Ab.import("./world preview-5afe074f.js"),4);case 4:if(!(Ra=Kb.yieldResult)){Kb.jumpTo(5);break}return Kb.yield(Yb.resource("part://partial freezing/world preview"),
6);case 6:Ra=Kb.yieldResult;case 5:return Kb.yield(Ra.read(),3);case 3:return rb=Kb.yieldResult,pb.previews=Ga.map(function(Ib){var gb=Yb.morph({reactsToPointer:!1,fill:Yb.Color.transparent,extent:rb.extent});gb._commit=Ib;gb.displayPreview=function(){var ib;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lb){if(1==Lb.nextAddress)return ib=rb.copy(),ib._commit=Ib,ib.opacity=0,gb.addMorph(ib),ib.displayPreview(),ib.position=Yb.pt(0,0),Lb.yield(gb.whenRendered(),2);gb.layout=new Yb.HorizontalLayout({autoResize:!0,
reactToSubmorphAnimations:!0});Lb.jumpToEnd()})};return gb}),Kb.yield(Lc.animate({opacity:0,duration:300}),7);case 7:pb.updateList(),0==Ga.length&&(pb.ui.noWorldWarning.center=pb.innerBounds().center(),pb.ui.noWorldWarning.animate({visible:!0,duration:300})),Kb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,
get:function(){return this.ui.closeButton.visible},set:function(pb){this.ui.closeButton.visible=pb}},db:{serialize:!1,get:function(){return Yb.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],
cd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-127"}}},{start:330,end:3954})}(Yb.Morph);qc=Yb.WorldDashboard;Yb.default=qc;var Ob=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");Ob.Morph=Rb;Ob.touchInputDevice=md;Ob.TilingLayout=Za;Ob.arr=Yd;Ob.pt=Ld;qc=function(Yc){var cd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),
$b=cd.hasOwnProperty("GrowingWorldList")&&"function"===typeof cd.GrowingWorldList?cd.GrowingWorldList:cd.GrowingWorldList=function(pb){pb&&pb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Td($b,Yc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(pb){Td._get(Object.getPrototypeOf($b.prototype),"onScroll",this).call(this,pb);this.update()}},{key:"onChange",value:function(pb){Td._get(Object.getPrototypeOf($b.prototype),
"onChange",this).call(this,pb);"extent"==pb.prop&&this.update(!0)}},{key:"onHoverIn",value:function(pb){this.clipMode="auto"}},{key:"onHoverOut",value:function(pb){Ob.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(pb){var xc=this.items;if(xc&&0!=xc.length){var Lc=this.scrollContainer,Ga=Lc.layout.spacing;Lc.extent=this.extent;var Ra=this.ui,rb=Ra.bufferTop;Ra=Ra.bufferBottom;rb=rb||Lc.addMorph({fill:null,name:"buffer top",height:10});Ra=Ra||Lc.addMorph({fill:null,name:"buffer bottom",
height:10});rb.width=Ra.width=this.width-100;Lc.layout.disable();var Kb=xc[0];Ga=xc.slice(0,Math.floor(this.width/(Kb.width+Ga))*(Math.ceil((this.scroll.y+this.height)/(Kb.height+Ga))+1)).filter(function(Lb){return Lb.owner!=Lc});Kb=this.scroll.y+2*this.height;for(var Ib={},gb=$jscomp.makeIterator(Ga),ib=gb.next();!ib.done;Ib={$jscomp$loop$prop$item$2284:Ib.$jscomp$loop$prop$item$2284},ib=gb.next())Ib.$jscomp$loop$prop$item$2284=ib.value,Kb++,Ib.$jscomp$loop$prop$item$2284.top=Kb,Lc.addMorph(Ib.$jscomp$loop$prop$item$2284),
Ib.$jscomp$loop$prop$item$2284._initialized||Ib.$jscomp$loop$prop$item$2284.whenRendered().then(function(Lb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(tc){Lb.$jscomp$loop$prop$item$2284._initialized=!0;return tc.yield(Lb.$jscomp$loop$prop$item$2284.displayPreview(),0)})}}(Ib));pb&&(rb.position=Ob.pt(0,0),xc.forEach(function(Lb,tc){return Lb.position=Ob.pt(tc+1,tc+1)}),Ra.position=Ob.pt(xc.length+2,xc.length+2));Lc.layout.enable();if(pb||0<Ga.length)Ra.top=this.submorphBounds().height,
Lc.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Ob.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},
items:{after:["layout","scrollContainer"],set:function(pb){this.setProperty("items",pb);var xc=this.scrollContainer;xc.layout&&xc.layout.disable();var Lc=this.ui,Ga=Lc.bufferTop;Lc=Lc.bufferBottom;Ob.arr.withoutAll(xc.submorphs,[].concat($jscomp.arrayFromIterable(pb),[Ga,Lc])).forEach(function(Ra){return Ra.remove()});this.update(!0)}}}}}],cd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Ob.Morph);qc=Ob.GrowingWorldList;Ob.default=qc;var Hc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");Hc.InputLine=Db;Hc.Color=vd;Hc.connect=ac;Hc.disconnectAll=ic;Hc.disconnect=gd;Hc.arr=Yd;Hc.string=Pc;qc=function(Yc){var cd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),$b=cd.hasOwnProperty("SearchInputLine")&&"function"===typeof cd.SearchInputLine?cd.SearchInputLine:cd.SearchInputLine=
function(pb){pb&&pb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Td($b,Yc,[{key:"fuzzyMatch",value:function(pb,xc){xc=void 0===xc?this.parseInput():xc;if(xc.lowercasedTokens.every(function(Ga){return pb.toLowerCase().includes(Ga)}))return!0;var Lc=pb.toLowerCase();return 3>=Hc.arr.sum(xc.lowercasedTokens.map(function(Ga){return Hc.string.levenshtein(Lc,Ga)}))}},{key:"fuzzyFilter",value:function(pb,xc){var Lc=this;xc=void 0===
xc?function(Ra){return Ra}:xc;var Ga=this.parseInput();return Hc.arr.filter(pb,function(Ra){return Lc.fuzzyMatch(xc(Ra),Ga)})}},{key:"parseInput",value:function(){var pb=Array.from(this.textString).reduce(function(Lc,Ga){if("\\"===Ga&&!Lc.escaped)return Lc.escaped=!0,Lc;" "!==Ga||Lc.escaped?(Lc.spaceSeen=!1,Lc.current+=Ga):(!Lc.spaceSeen&&Lc.current&&(Lc.tokens.push(Lc.current),Lc.current=""),Lc.spaceSeen=!0);Lc.escaped=!1;return Lc},{tokens:[],current:"",escaped:!1,spaceSeen:!1});pb.current&&pb.tokens.push(pb.current);
var xc=pb.tokens.map(function(Lc){return Lc.toLowerCase()});return{tokens:pb.tokens,lowercasedTokens:xc}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],cd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(Hc.InputLine);qc=Hc.SearchInputLine;
Hc.default=qc}}});
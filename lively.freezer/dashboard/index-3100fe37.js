System.register(["./__root_module__-aefa9179.js"],function(Da){var Bb,Qb,hc,ac,be,bd,Sd,ed,Mc,pd,Dd,ke,Kd,jd,cb,Ab,Yb,gc,dd,Zd,Wb,oc,Lb,Bc,Sc,Yc,Xb,qb,uc,Hc,Ia,Va,tb,Jb,Ib,ib,jb,Fb,rc,Ic,ec,Pc;return{setters:[function(Q){Bb=Q.at;Qb=Q.a3;hc=Q.C;ac=Q.an;be=Q.ai;bd=Q.ax;Sd=Q.aV;ed=Q.aB;Mc=Q.ay;pd=Q.a9;Dd=Q.al;ke=Q.ao;Kd=Q.h;jd=Q.a2;cb=Q.a1;Ab=Q.ah;Yb=Q.a7;gc=Q.P;dd=Q.$;Zd=Q.aW;Wb=Q.ap;oc=Q.a6;Lb=Q.aq;Bc=Q.ar;Sc=Q.aX;Yc=Q.aY;Xb=Q.au;qb=Q.as;uc=Q.s;Hc=Q.av;Ia=Q.aZ;Va=Q.ak;tb=Q.a_;Jb=Q.a$;Ib=Q.b0;ib=
Q.aa;jb=Q.b1;Fb=Q.am;rc=Q.b2;Ic=Q.b3;ec=Q.b4;Pc=Q.aQ}],execute:function(){function Q(wa){(wa=ic.cachedGuideLines.get(wa))&&wa.forEach(function(Ba){return Ba.remove()})}function ha(wa,Ba,Mb,P,ya){Ba=void 0===Ba?!0:Ba;Mb=void 0===Mb?!0:Mb;P=void 0===P?10:P;ya=void 0===ya?100:ya;if(Ba||Mb){var Ua=wa.owner,Eb=Ua.world();Ua=Ua.getGlobalTransform();var Cc=wa.owner.submorphs.filter(function(td){return td!==wa&&!td.isEpiMorph&&td.visible&&td.reactsToPointer}),cd=ic.findAlignedMorphs(wa,Cc,P,ya,"left top right bottom hCenter vCenter".split(" "),
"left top right bottom hCenter vCenter".split(" "));ya=[];var ee=0,Vd=0,Ze=0,Wd=0;Ua.e-=Eb.scroll.x;Ua.f-=Eb.scroll.y;if(cd){cd=$jscomp.makeIterator(cd);for(var Be=cd.next();!Be.done;Be=cd.next()){Be=$jscomp.makeIterator(Be.value);Be.next();var Qe=Be.next().value;Be=Qe.vertical;Qe=$jscomp.makeIterator(Qe.horizontal);for(var rf=Qe.next();!rf.done;rf=Qe.next()){rf=rf.value;var cg=rf.edgeAVal,Ef=rf.refPointsA,Oc=rf.refPointsB,Af=rf.edgeBVal,qg=Math.ceil(P-rf.delta),sg=Math.min(Ef.top,Oc.top);Ef=Math.max(Ef.bottom,
Oc.bottom);rf.maxDist>P&&(qg-=P/2);ee<qg&&(ee=qg,Ze=Af-cg);ya.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:ic.guideWidth,start:Ua.transformPoint(ic.pt(Af,sg)),end:Ua.transformPoint(ic.pt(Af,Ef)),fill:ic.guideColor,guideType:"h",priority:qg})}Be=$jscomp.makeIterator(Be);for(Qe=Be.next();!Qe.done;Qe=Be.next())Qe=Qe.value,rf=Qe.edgeAVal,sg=Qe.refPointsA,Ef=Qe.refPointsB,cg=Qe.edgeBVal,Af=Math.ceil(P-Qe.delta),qg=Math.min(sg.left,Ef.left),sg=Math.max(sg.right,Ef.right),Qe.maxDist>P&&(Af-=
P/2),Vd<Af&&Math.abs(cg-rf)<=P&&(Vd=Af,Wd=cg-rf),ya.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:ic.guideWidth,start:Ua.transformPoint(ic.pt(qg,cg)),end:Ua.transformPoint(ic.pt(sg,cg)),fill:ic.guideColor,guideType:"v",priority:Af})}}if(!ee||!Vd){Cc=[wa].concat($jscomp.arrayFromIterable(Cc));rf=ic.computeClosestMorphs(Cc);Qe=rf[0];Cc=Qe.l;cd=Qe.r;Be=Qe.t;Qe=Qe.b;var ff;if(Cc||cd||Be||Qe){var Ja=(Cc||cd||Be||Qe).refPointsA;for(cg=1;cg<rf.length&&(Ef=rf[cg],Af=Ef.l,qg=Ef.r,sg=Ef.t,Ef=Ef.b,
ee||(Cc&&Af&&Cc.index!==Af.index&&Math.abs(Af.dist-Cc.dist)<=P?ff=Object.assign({neighbor:cg,direction:"left"},Af):cd&&qg&&cd!==qg.index&&Math.abs(qg.dist-cd.dist)<=P&&(ff=Object.assign({neighbor:cg,direction:"right"},qg))),Vd||(Be&&sg&&Be.index!==sg.index&&Math.abs(sg.dist-Be.dist)<=P?ff=Object.assign({neighbor:cg,direction:"top"},sg):Qe&&Ef&&Qe.index!==Ef.index&&Math.abs(Ef.dist-Qe.dist)<=P&&(ff=Object.assign({neighbor:cg,direction:"bottom"},Ef))),!ff);cg++);}if(ff){var ab=ff;P=ab.direction;sg=
ab.dist;var Cb=Ja.left;Oc=Ja.top;var ba=Ja.bottom,Ka=Ja.right,nb=Ja.width,xb=Ja.height;Ef=ab.refPointsA;Ja=Ef.left;rf=Ef.top;cg=Ef.bottom;Af=Ef.right;qg=Ef.width;Ef=Ef.height;var Dc=ab.refPointsB,Fc=Dc.left;ab=Dc.top;var ud=Dc.bottom;Dc=Dc.right;Ka="left"===P?Cb:"right"===P?Ka:Cb+nb/2;ba="bottom"===P?ba:"top"===P?Oc:Oc+xb/2;Cb="left"===P?Ka-sg:"right"===P?Ka+sg:Cb+nb/2;sg="bottom"===P?ba+sg:"top"===P?ba-sg:Oc+xb/2;Oc="left"===P?Dc:"right"===P?Fc:Ja+qg/2;nb="bottom"===P?ab:"top"===P?ud:rf+Ef/2;!Mb||
ee||"right"!==P&&"left"!==P||(ee=10,Ze=(ff.dist-(cd||Cc).dist)*("right"===P?-1:1),Ka+=Ze,Cb+=Ze);!Mb||Vd||"top"!==P&&"bottom"!==P||(Vd=10,Wd=((Be||Qe).dist-ff.dist)*("top"===P?-1:1),ba+=Wd,sg+=Wd);ya.push({type:"line",epiMorph:!0,hasFixedPosition:!0,start:Ua.transformPoint(ic.pt("left"===P?Ja:"right"===P?Af:Ja+qg/2,"bottom"===P?cg:"top"===P?rf:rf+Ef/2)),end:Ua.transformPoint(ic.pt(Oc,nb)),fill:ic.Color.orange,height:ic.guideWidth,guideType:P,priority:10},{type:"line",epiMorph:!0,hasFixedPosition:!0,
start:Ua.transformPoint(ic.pt(Ka,ba)),end:Ua.transformPoint(ic.pt(Cb,sg)),fill:ic.Color.orange,height:ic.guideWidth,guideType:P,priority:10})}}Mb&&(Ze||Wd)&&wa.moveBy(ic.pt(Ze,Wd));if(Ba){ya=ya.filter(function(td){var rd=td.guideType;td=td.priority;return"h"===rd?td===ee:"v"===rd?td===Vd:!0});(Ba=ic.cachedGuideLines.get(wa))||ic.cachedGuideLines.set(wa,Ba=[]);for(Mb=0;Mb<ya.length;Mb++)ff=void 0,Ba[Mb]?ff=Object.assign(Ba[Mb],ya[Mb]):(ff=ic.morph(ya[Mb]),Ba.push(ff)),ff.owner||Eb.addMorph(ff);Ba.slice(Mb).forEach(function(td){return td.remove()});
ic.fun.debounceNamed(wa.id+"-drag-guides-cleanup",1300,function(){var td=ic.cachedGuideLines.get(wa);td&&td.forEach(function(rd){return rd.remove()})})()}}}function Ha(wa,Ba,Mb,P,ya,Ua){Mb=void 0===Mb?!0:Mb;P=void 0===P?!0:P;ya=void 0===ya?5:ya;Ua=void 0===Ua?100:Ua;if(Mb||P){var Eb=wa.owner,Cc=Eb.world(),cd=Eb.getGlobalTransform(),ee=wa.owner.submorphs.filter(function(ba){return ba!==wa&&!ba.isEpiMorph&&ba.visible&&ba.reactsToPointer});Eb=(Ba.includes("left")||Ba.includes("right")?"x":"")+(Ba.includes("top")||
Ba.includes("bottom")?"y":"");var Vd=ic.findMorphsWithSimilarWidthOrHeight(wa,Eb,ee,ya,Ua),Ze=-Infinity,Wd=-Infinity,Be=0,Qe=0,rf=0,cg=0,Ef=0,Oc=0;Eb=[];cd.e-=Cc.scroll.x;cd.f-=Cc.scroll.y;if(Vd){Vd=$jscomp.makeIterator(Vd);for(var Af=Vd.next();!Af.done;Af=Vd.next()){Af=$jscomp.makeIterator(Af.value);Af.next();var qg=Af.next().value;Af=qg.similarIn;var sg=qg.delta,ff=qg.refPointsA,Ja=qg.refPointsB;qg=ya-sg+(Ua-qg.minDist);"width"===Af?Ze<qg&&(Ze=qg,Ba.includes("left")&&(Qe=-sg),Ba.includes("right")&&
(Be=sg)):Wd<qg&&(Wd=qg,Ba.includes("top")&&(rf=-sg),Ba.includes("bottom")&&(cg=sg));sg={type:"line",epiMorph:!0,hasFixedPosition:!0,height:ic.guideWidth,fill:ic.guideColor,guideType:Af,priority:qg,start:cd.transformPoint("width"===Af?ic.pt(ff.left,ff.top+ff.height/2):ic.pt(ff.left+ff.width/2,ff.top)),end:cd.transformPoint("width"===Af?ic.pt(ff.right,ff.top+ff.height/2):ic.pt(ff.left+ff.width/2,ff.bottom))};Af=Object.assign({},sg,{start:cd.transformPoint("width"===Af?ic.pt(Ja.left,Ja.top+Ja.height/
2):ic.pt(Ja.left+Ja.width/2,Ja.top)),end:cd.transformPoint("width"===Af?ic.pt(Ja.right,Ja.top+Ja.height/2):ic.pt(Ja.left+Ja.width/2,Ja.bottom))});Eb.push(sg,Af)}}if(Ua=ic.findAlignedMorphs(wa,ee,ya,Ua,Ba,void 0))for(Ua=$jscomp.makeIterator(Ua),ee=Ua.next();!ee.done;ee=Ua.next()){ee=$jscomp.makeIterator(ee.value);ee.next();Vd=ee.next().value;ee=Vd.vertical;Vd=$jscomp.makeIterator(Vd.horizontal);for(Af=Vd.next();!Af.done;Af=Vd.next()){Af=Af.value;Ja=Af.edgeAVal;var ab=Af.refPointsA,Cb=Af.refPointsB;
sg=Af.edgeBVal;ff=Math.ceil(ya-Af.delta);qg=Math.min(ab.top,Cb.top);ab=Math.max(ab.bottom,Cb.bottom);Af.maxDist>ya&&(ff-=ya/2);Ef<ff&&(Ef=ff,Ba.includes("left")&&(Qe=-(sg-Ja)),Ba.includes("right")&&(Be=+(sg-Ja)));Eb.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:ic.guideWidth,start:cd.transformPoint(ic.pt(sg,qg)),end:cd.transformPoint(ic.pt(sg,ab)),fill:ic.guideColor,guideType:"h",priority:ff})}ee=$jscomp.makeIterator(ee);for(Vd=ee.next();!Vd.done;Vd=ee.next())Vd=Vd.value,Af=Vd.edgeAVal,
qg=Vd.refPointsA,ab=Vd.refPointsB,Ja=Vd.edgeBVal,sg=Math.ceil(ya-Vd.delta),ff=Math.min(qg.left,ab.left),qg=Math.max(qg.right,ab.right),Vd.maxDist>ya&&(sg-=ya/2),Oc<sg&&Math.abs(Ja-Af)<=ya&&(Oc=sg,Ba.includes("top")&&(rf=Ja-Af),Ba.includes("bottom")&&(cg=Ja-Af)),Eb.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:ic.guideWidth,start:cd.transformPoint(ic.pt(ff,Ja)),end:cd.transformPoint(ic.pt(qg,Ja)),fill:ic.guideColor,guideType:"v",priority:sg})}P&&(Qe&&(wa.left+=Qe,wa.right-=Qe),rf&&(wa.top+=
rf,wa.bottom-=rf),Be&&(wa.width+=Be),cg&&(wa.height+=cg));if(Mb){Eb=Eb.filter(function(ba){var Ka=ba.guideType;ba=ba.priority;return"width"===Ka?ba===Ze:"height"===Ka?ba===Wd:"v"===Ka?ba===Oc:"h"===Ka?ba===Ef:!1});(Ba=ic.cachedGuideLines.get(wa))||ic.cachedGuideLines.set(wa,Ba=[]);for(Mb=0;Mb<Eb.length;Mb++)P=void 0,Ba[Mb]?P=Object.assign(Ba[Mb],Eb[Mb]):(P=ic.morph(Eb[Mb]),Ba.push(P)),P.owner||Cc.addMorph(P);Ba.slice(Mb).forEach(function(ba){return ba.remove()});ic.fun.debounceNamed(wa.id+"-drag-guides-cleanup",
1300,function(){var ba=ic.cachedGuideLines.get(wa);ba&&ba.forEach(function(Ka){return Ka.remove()})})()}}}function Pa(wa,Ba){Ba=void 0===Ba?!1:Ba;var Mb=Wa.MorphicEnv.default().world;if(null===wa||void 0===wa)wa=String(wa);if(wa.isMorph)return Wa.showRect(wa.world(),wa.globalBounds().translatedBy(wa.world().scroll.negated()),Ba);if(wa.isPoint)return Wa.showRect(Mb,new Wa.Rectangle(wa.x-5,wa.y-5,10,10));if(wa.isLine)return Wa.showLine(Mb,wa);if(wa.isRectangle)return Wa.showRect(Mb,wa);if("undefined"!==
typeof Wa.Element&&wa instanceof Wa.Element)return Wa.showRect(Mb,Wa.Rectangle.fromElement(wa));if("number"===typeof wa||"symbol"===typeof wa||"boolean"===typeof wa||"undefined"!==typeof Wa.Node&&wa instanceof Wa.Node||wa instanceof RegExp)wa=String(wa);"object"===typeof wa&&(wa=Wa.obj.inspect(wa,{maxDepth:1}));return"string"===typeof wa&&1===arguments.length?Mb.setStatusMessage(wa):Mb.setStatusMessage(Wa.string.formatFromArray(Array.from(arguments)))}function bc(wa,Ba,Mb){Mb=void 0===Mb?3E3:Mb;var P,
ya,Ua,Eb,Cc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cd){if(1==cd.nextAddress){if(!(wa&&wa.world()&&Ba&&Ba.world()))return cd.return(null);P=wa.owner.worldPoint(wa.center);ya=Ba.owner.worldPoint(Ba.center);Ua=P.lineTo(ya).sampleN(2)[1];Eb={tagName:"marker",markerHeight:5,markerWidth:5,orient:"auto",refX:1,refY:5,viewBox:"0 0 10 10",children:[{tagName:"circle",stroke:Wa.Color.red,fill:Wa.Color.red,cx:5,cy:5,r:4}]};Cc=$world.addMorph(new Wa.Path({position:Ua,renderOnGPU:!0,vertices:[Wa.pt(0),
Wa.pt(0)],borderWidth:2,startMarker:Eb,endMarker:Eb,borderColor:Wa.Color.red}));return cd.yield(Cc.whenRendered(),2)}if(3!=cd.nextAddress)return cd.yield(Cc.animate({opacity:1,customTween:function(ee){var Vd=Cc.center;Cc.vertices=[Wa.pt(0).interpolate(ee,P.subPt(Ua)),Wa.pt(0).interpolate(ee,ya.subPt(Ua))];Cc.center=Vd},duration:400}),3);Mb&&setTimeout(function(){return Cc.fadeOut()},Mb);return cd.return(Cc)})}Da({a:ha,d:bc,r:Q,s:Pa});var ic=lively.FreezerRuntime.recorderFor("lively.halos/drag-guides.js");
ic.removeSnapToGuidesOf=Q;ic.showAndSnapToGuides=ha;ic.showAndSnapToResizeGuides=Ha;ic.computeRefPoints=function(wa){var Ba=wa.x,Mb=wa.y,P=wa.width;wa=wa.height;return{left:Ba,top:Mb,hCenter:Ba+P/2,vCenter:Mb+wa/2,right:Ba+P,bottom:Mb+wa,width:P,height:wa}};ic.findEdgesInAlignment=function(wa,Ba,Mb,P,ya,Ua,Eb,Cc,cd,ee){Mb=void 0===Mb?15:Mb;Ua=void 0===Ua?0:Ua;Eb=void 0===Eb?0:Eb;Cc=void 0===Cc?0:Cc;cd=void 0===cd?0:cd;ee=void 0===ee?0:ee;for(var Vd=[],Ze=[],Wd=0;Wd<ic.edges.length;Wd++){var Be=$jscomp.makeIterator(ic.edges[Wd]),
Qe=Be.next().value,rf=Be.next().value;Be=Be.next().value;var cg=wa[rf],Ef=Ba[Be],Oc=Math.max(cg,Ef)-Math.min(cg,Ef);Oc>Mb||!(P&&!P.includes(rf)||ya&&!ya.includes(Be))&&("vertical"===Qe?Vd:Ze).push({delta:Oc,edgeA:rf,edgeB:Be,edgeAVal:cg,edgeBVal:Ef,refPointsA:wa,refPointsB:Ba,distLeft:Ua,distTop:Eb,distRight:Cc,distBottom:cd,maxDist:ee})}return Vd.length||Ze.length?{vertical:Vd,horizontal:Ze}:null};ic.findAlignedMorphs=function(wa,Ba,Mb,P,ya,Ua){Mb=void 0===Mb?15:Mb;P=void 0===P?Infinity:P;for(var Eb,
Cc=ic.computeRefPoints(wa.bounds()),cd=0;cd<Ba.length;cd++){var ee=Ba[cd];if(ee!==wa){var Vd=ic.computeRefPoints(ee.bounds()),Ze=Math.max(0,Cc.left-Vd.right),Wd=Math.max(0,Vd.left-Cc.right),Be=Math.max(0,Cc.top-Vd.bottom),Qe=Math.max(0,Vd.top-Cc.bottom);Math.max(Qe,Be,Wd,Ze)>P||!(Vd=ic.findEdgesInAlignment(Cc,Vd,Mb,ya,Ua,Ze,Be,Wd,Qe,Math.max(Qe,Be,Wd,Ze)))||(Eb||(Eb=new Map),Eb.set(ee,Vd))}}wa=wa.owner;Ba=ic.computeRefPoints(wa.innerBounds());if(Mb=ic.findEdgesInAlignment(Cc,Ba,Mb))Eb||(Eb=new Map),
Eb.set(wa,Mb);return Eb};ic.findMorphsWithSimilarWidthOrHeight=function(wa,Ba,Mb,P,ya){P=void 0===P?15:P;ya=void 0===ya?Infinity:ya;for(var Ua,Eb=ic.computeRefPoints(wa.bounds()),Cc=0;Cc<Mb.length;Cc++){var cd=Mb[Cc];if(cd!==wa){var ee=ic.computeRefPoints(cd.bounds()),Vd=Math.max(0,Eb.left-ee.right),Ze=Math.max(0,ee.left-Eb.right),Wd=Math.max(0,Eb.top-ee.bottom),Be=Math.max(0,ee.top-Eb.bottom),Qe=Math.min(Be,Wd,Ze,Vd),rf=Math.max(Be,Wd,Ze,Vd);if(!(Math.max(Be,Wd,Ze,Vd)>ya)){Ze=Eb;Vd=Ze.width;Ze=Ze.height;
Be=ee;Wd=Be.width;Be=Be.height;var cg=Wd-Vd,Ef=Be-Ze;("x"===Ba||"xy"===Ba)&&Math.abs(cg)<=P&&(Ua||(Ua=new Map),Ua.set(cd,{similarIn:"width",minDist:Qe,maxDist:rf,refPointsA:Eb,refPointsB:ee,valA:Vd,valB:Wd,delta:cg}));("y"===Ba||"xy"===Ba)&&Math.abs(Ef)<=P&&(Ua||(Ua=new Map),Ua.set(cd,{similarIn:"height",minDist:Qe,maxDist:rf,refPointsA:Eb,refPointsB:ee,valA:Ze,valB:Be,delta:Ef}))}}}return Ua};ic.closest=function(wa,Ba,Mb,P,ya,Ua,Eb,Cc){Cc=void 0===Cc?!0:Cc;var cd=P[wa],ee=ya[wa],Vd=Ua[wa];Ba=Eb[wa];
for(var Ze,Wd,Be,Qe,rf=0;rf<ya.length;rf++)wa===rf||cd<ya[rf]||Ze&&ya[Ze.index]>=ya[rf]||Cc&&Eb[wa]<Ua[rf]||Ua[wa]>Eb[rf]||(Ze={index:rf,dist:cd-ya[rf],refPointsA:Mb[wa],refPointsB:Mb[rf]});for(cd=0;cd<P.length;cd++)wa===cd||ee>P[cd]||Wd&&P[Wd.index]<=P[cd]||Cc&&Eb[wa]<Ua[cd]||Ua[wa]>Eb[cd]||(Wd={index:cd,dist:P[cd]-ee,refPointsA:Mb[wa],refPointsB:Mb[cd]});for(ee=0;ee<Eb.length;ee++)wa===ee||Vd<Eb[ee]||Be&&Eb[Be.index]>=Eb[ee]||Cc&&P[wa]>ya[ee]||ya[wa]<P[ee]||(Be={index:ee,dist:Vd-Eb[ee],refPointsA:Mb[wa],
refPointsB:Mb[ee]});for(Eb=0;Eb<Ua.length;Eb++)wa===Eb||Ba>Ua[Eb]||Qe&&Ua[Qe.index]<=Ua[Eb]||Cc&&P[wa]>ya[Eb]||ya[wa]<P[Eb]||(Qe={index:Eb,dist:Ua[Eb]-Ba,refPointsA:Mb[wa],refPointsB:Mb[Eb]});return{l:Ze,r:Wd,t:Be,b:Qe}};ic.computeClosestMorphs=function(wa){for(var Ba=[],Mb=[],P=[],ya=[],Ua=[],Eb=[],Cc=0;Cc<wa.length;Cc++){var cd=ic.computeRefPoints(wa[Cc].bounds());Ua.push(cd);var ee=cd.right,Vd=cd.top,Ze=cd.bottom;Ba.push(cd.left);Mb.push(ee);P.push(Vd);ya.push(Ze)}for(Cc=0;Cc<wa.length;Cc++)Eb.push(ic.closest(Cc,
wa,Ua,Ba,Mb,P,ya));return Eb};ic.fun=Bb;ic.pt=Qb;ic.Color=hc;ic.morph=ac;ic.cachedGuideLines=new WeakMap;ic.guideWidth=1;ic.guideColor=ic.Color.orange.lighter();ic.removeSnapToGuidesOf=Q;ic.removeSnapToGuidesOf=Q;ic.showAndSnapToGuides=ha;ic.showAndSnapToGuides=ha;ic.showAndSnapToResizeGuides=Ha;ic.showAndSnapToResizeGuides=Ha;ic.edges=[["vertical","top","top"],["vertical","vCenter","top"],["vertical","bottom","top"],["vertical","top","vCenter"],["vertical","vCenter","vCenter"],["vertical","bottom",
"vCenter"],["vertical","top","bottom"],["vertical","vCenter","bottom"],["vertical","bottom","bottom"],["horizontal","left","left"],["horizontal","hCenter","left"],["horizontal","right","left"],["horizontal","left","hCenter"],["horizontal","hCenter","hCenter"],["horizontal","right","hCenter"],["horizontal","left","right"],["horizontal","hCenter","right"],["horizontal","right","right"]];var Ra=lively.FreezerRuntime.recorderFor("lively.halos/morph.js");Ra.Morph=be;Ra.Label=bd;Ra.StyleSheet=Sd;Ra.HorizontalLayout=
ed;Ra.Path=Mc;Ra.Text=pd;Ra.GridLayout=Dd;Ra.morph=ac;Ra.Icon=ke;Ra.createMorphSnapshot=Kd;Ra.Color=hc;Ra.pt=Qb;Ra.rect=jd;Ra.Rectangle=cb;Ra.LinearGradient=Ab;Ra.obj=Yb;Ra.PropertyPath=gc;Ra.promise=dd;Ra.properties=Zd;Ra.num=Wb;Ra.arr=oc;Ra.connect=Lb;Ra.signal=Bc;Ra.disconnect=Sc;Ra.disconnectAll=Yc;Ra.once=Xb;Ra.showAndSnapToGuides=ha;Ra.showAndSnapToResizeGuides=Ha;Ra.removeSnapToGuidesOf=Q;Ra.haloBlue=Ra.Color.rgb(23,160,251);Ra.componentAccent=Ra.Color.magenta;Ra.derivedAccent=Ra.Color.purple;
var tc=function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("Halo")&&"function"===typeof Ba.Halo?Ba.Halo:Ba.Halo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"relayout",value:function(){this.alignWithTarget()}},{key:"keybindings",get:function(){return[{keys:{mac:"Meta-C",win:"Ctrl-C"},command:{command:"clipboard copy",passEvent:!0}}]}},{key:"commands",
get:function(){return[{name:"clipboard copy",doc:"copy selected morph(s) to clipboard",scrollCursorIntoView:!1,exec:function(P){P.copyHalo().copyToClipBoard()}}]}},{key:"removeIfDetached",value:function(){var P=this;setTimeout(function(){P.target.owner||P.remove()})}},{key:"initLayout",value:function(){var P=this.layout=new Ra.GridLayout({autoAssign:!1,fitToCell:!1,columns:[0,{fixed:36,paddingRight:10},2,{fixed:26},4,{fixed:26},6,{fixed:36,paddingLeft:10}],rows:[0,{fixed:36,paddingBottom:10},2,{fixed:26},
4,{fixed:26},6,{fixed:26},7,{fixed:36,paddingTop:10}],grid:[["menu",null,"grab",null,"drag",null,"close"],[null,null,null,null,null,null,null],["copy",null,null,null,null,null,"edit"],[null,null,null,null,null,null,null],["component",null,null,null,null,null,"inspect"],[null,null,null,null,null,null,null],["rotate",null,null,null,null,null,"resize"],[null,"name","name","name","name","name",null]]});P.col(1).row(7).group.align="center";P.col(1).row(7).group.resize=!1}},{key:"initButtons",value:function(){this.submorphs=
[].concat($jscomp.arrayFromIterable(this.ensureResizeHandles()),$jscomp.arrayFromIterable(this.resizeOnly?[]:[this.closeHalo(),this.dragHalo(),this.grabHalo(),this.menuHalo(),this.inspectHalo(),this.editHalo(),this.copyHalo(),this.componentHalo(),this.rotateHalo(),this.nameHalo(),this.originHalo()]))}},{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"isHalo",get:function(){return!0}},{key:"borderBox",get:function(){return this.getSubmorphNamed("border-box")||
this.addMorphBack(Ra.morph({name:"border-box",fill:Ra.Color.transparent,borderColor:this.target.isComponent?Ra.componentAccent:Ra.haloBlue,borderWidth:1}))}},{key:"pointerId",get:function(){return this.state?this.state.pointerId:null}},{key:"pointerId",set:function(P){this.state||(this.state={});this.state.pointerId=P}},{key:"prepareTarget",value:function(P){if(!Ra.obj.isArray(P))return P;if(1>=P.length)return P[0];P=P[0].world().addMorph(new Ra.MultiSelectionTarget({selectedMorphs:P}));P.alignWithSelection();
P.modifiesSelectedMorphs=!0;return P}},{key:"refocus",value:function(P){this.target=P;this.alignWithTarget()}},{key:"alignWithTarget",value:function(){if(!this.active&&this.target){var P=this.target.world()||$world,ya=P.visibleBounds(),Ua=this.target.globalBounds(),Eb=Ua.insetBy(-36).intersection(ya);ya=Ua.intersection(ya);this.layout&&this.layout.disable();this.setBounds(Eb.translatedBy(P.scroll.negated()));this.borderBox.setBounds($world.transformRectToMorph(this,ya));this.state.activeButton?(this.buttonControls.forEach(function(Cc){return Cc.visible=
!1}),this.ensureResizeHandles().forEach(function(Cc){return Cc.visible=!1}),this.state.activeButton.visible=!0,this.updatePropertyDisplay(this.state.activeButton)):(this.changingName&&this.nameHalo().toggleActive([!1]),this.ensureResizeHandles().forEach(function(Cc){return Cc.visible=!0}),this.buttonControls.forEach(function(Cc){Cc.visible=!0}),this.propertyDisplay.disable());this.nameHalo().alignInHalo();this.ensureResizeHandles().forEach(function(Cc){return Cc.alignInHalo()});this.resizeOnly||this.originHalo().alignInHalo();
this.layout&&this.layout.enable();return this}}},{key:"detachFromTarget",value:function(){var P=this.target;P&&(Ra.disconnect(P,"onChange",this,"alignWithTarget"),Ra.disconnect(P,"onOwnerChanged",this,"removeIfDetached"),P instanceof Ra.MultiSelectionTarget?(P.modifiesSelectedMorphs=!1,P.remove()):"function"===typeof P.detachedHalo&&P.detachedHalo(this))}},{key:"remove",value:function(){this.detachFromTarget();qb._get(Object.getPrototypeOf(Mb.prototype),"remove",this).call(this)}},{key:"morphsContainingPoint",
value:function(P){return P}},{key:"propertyDisplay",get:function(){return Ra.HaloPropertyDisplay.for(this)}},{key:"nameHalo",value:function(){return Ra.NameHaloItem.for(this)}},{key:"closeHalo",value:function(){return Ra.CloseHaloItem.for(this)}},{key:"grabHalo",value:function(){return Ra.GrabHaloItem.for(this)}},{key:"dragHalo",value:function(){return Ra.DragHaloItem.for(this)}},{key:"menuHalo",value:function(){return Ra.MenuHaloItem.for(this)}},{key:"inspectHalo",value:function(){return Ra.InspectHaloItem.for(this)}},
{key:"editHalo",value:function(){return Ra.EditHaloItem.for(this)}},{key:"rotateHalo",value:function(){return Ra.RotateHaloItem.for(this)}},{key:"copyHalo",value:function(){return Ra.CopyHaloItem.for(this)}},{key:"originHalo",value:function(){return Ra.OriginHaloItem.for(this)}},{key:"componentHalo",value:function(){return Ra.ComponentHaloItem.for(this)}},{key:"buttonControls",get:function(){return this.submorphs.filter(function(P){return P.isHaloItem&&!P.isResizeHandle})}},{key:"addMorphToSelection",
value:function(P){var ya=this,Ua,Eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cc){if(1==Cc.nextAddress){Ua=ya.world();Eb=ya.target.isMorphSelection?ya.target.selectedMorphs:[ya.target];if(Eb.includes(P))return Cc.return();ya.remove();return Cc.yield(Ua.showHaloForSelection([].concat($jscomp.arrayFromIterable(Eb),[P]),ya.state.pointerId),2)}return Cc.return(Cc.yieldResult)})}},{key:"removeMorphFromSelection",value:function(P){var ya=this,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Eb){if(1==
Eb.nextAddress){Ua=ya.world();ya.remove();if(!ya.target.isMorphSelection)return Eb.jumpTo(0);Ra.arr.remove(ya.target.selectedMorphs,P);return Eb.yield(Ua.showHaloForSelection(ya.target.selectedMorphs,ya.state.pointerId),3)}return Eb.return(Eb.yieldResult)})}},{key:"isAlreadySelected",value:function(P){return this.target==P||this.target.isMorphSelection&&this.target.selectsMorph(P)}},{key:"updateBoundsFor",value:function(P,ya,Ua,Eb,Cc){var cd={topLeft:Ra.rect(-1,-1,1,1),topCenter:ya?Ra.rect(1,-1,0,
1):Ra.rect(0,-1,0,1),topRight:Ra.rect(0,-1,1,1),rightCenter:ya?Ra.rect(0,1,1,1):Ra.rect(0,0,1,0),bottomRight:Ra.rect(0,0,1,1),bottomCenter:ya?Ra.rect(1,0,0,1):Ra.rect(0,0,0,1),bottomLeft:Ra.rect(-1,0,1,1),leftCenter:ya?Ra.rect(-1,1,1,0):Ra.rect(-1,0,1,0)}[P];Cc=cd.x;var ee=cd.y,Vd=cd.width;cd=cd.height;Ua=ya?this.proportionalDelta(P,Ua,Eb):Ua;P=Ra.rect(Ua.x*Cc,Ua.y*ee,Ua.x*Vd,Ua.y*cd);this.active=!0;this.target.setBounds(Eb.insetByRect(P));(this.target.isPolygon||this.target.isPath)&&this.target.moveBy(this.target.origin.negated());
this.active=!1;this.alignWithTarget()}},{key:"proportionalDelta",value:function(P,ya,Ua){var Eb=Ua.width,Cc=Ua.height;Ua={topLeft:Ra.pt(-1,-1),topCenter:Ra.pt(0,-1),topRight:Ra.pt(1,-1),leftCenter:Ra.pt(-1,0),rightCenter:Ra.pt(1,0),bottomLeft:Ra.pt(-1,1),bottomCenter:Ra.pt(0,1),bottomRight:Ra.pt(1,1)};var cd=Eb/Math.max(Eb,Cc),ee=Cc/Math.max(Cc,Eb);Eb={topLeft:Ra.pt(-cd,-ee),topCenter:Ra.pt(1/(2*Cc/Eb),-1),topRight:Ra.pt(cd,-ee),leftCenter:Ra.pt(-1,Cc/(2*Eb)),rightCenter:Ra.pt(1,Cc/(3*Eb)),bottomLeft:Ra.pt(-cd,
ee),bottomCenter:Ra.pt(1/(2*Cc/Eb),1),bottomRight:Ra.pt(cd,ee)};Ua=Ua[P];return Eb[P].scaleBy(Ua.dotProduct(ya)/Ua.dotProduct(Ua))}},{key:"ensureResizeHandles",value:function(){return Ra.ResizeHandle.resizersFor(this)}},{key:"updatePropertyDisplay",value:function(P){P=P.valueForPropertyDisplay();"undefined"!==typeof P?this.propertyDisplay.displayProperty(P):this.propertyDisplay.disable()}},{key:"toggleDiagonal",value:function(P,ya){if(!Ra.rect(0).sides.includes(ya)){var Ua=this.getSubmorphNamed("diagonal");
if(P){P=this.target.globalBounds();var Eb=P.width,Cc=P.height;P=this.localize(Ra.pt(P.x,P.y)).extent(Ra.pt(Eb,Cc)).scaleRectTo(this.innerBounds());Eb={topLeft:[Ra.pt(Eb,Cc),Ra.pt(0,0)],topRight:[Ra.pt(0,Cc),Ra.pt(Eb,0)],bottomRight:[Ra.pt(0,0),Ra.pt(Eb,Cc)],bottomLeft:[Ra.pt(Eb,0),Ra.pt(0,Cc)]};Ua?Ua.setBounds(P):(Ua=$jscomp.makeIterator(Eb[ya]),ya=Ua.next().value,Ua=Ua.next().value,Eb=new Ra.LinearGradient({stops:[{offset:0,color:Ra.Color.orange.withA(0)},{offset:.2,color:Ra.Color.orange},{offset:.8,
color:Ra.Color.orange},{offset:1,color:Ra.Color.orange.withA(0)}]}),Ua=this.addMorphBack(new Ra.Path({opacity:0,name:"diagonal",borderStyle:"dotted",borderWidth:5,bounds:P,borderColor:Eb,vertices:[ya,Ua]})),Ua.setBounds(P),Ua.animate({opacity:1,duration:500}))}else Ua&&Ua.fadeOut(500)}}},{key:"toggleRotationIndicator",value:function(P,ya){var Ua=this.getSubmorphNamed("rotationIndicator");P&&ya?(P=this.getSubmorphNamed("origin").center,Ua=Ua||this.addMorphBack(new Ra.Path({name:"rotationIndicator",
borderColor:Ra.haloBlue,borderWidth:1,vertices:[]})),Ua.setBounds(ya.bounds().union(this.innerBounds())),Ua.vertices=[Ua.localizePointFrom(P,this),Ua.localizePointFrom(ya.center,this)]):Ua&&Ua.remove()}},{key:"toggleMorphHighlighter",value:function(P,ya,Ua){Ua=void 0===Ua?!1:Ua;if(ya.onHaloGrabover)ya.onHaloGrabover(P);else Ua=Ra.MorphHighlighter.for(this,ya,Ua),P&&ya&&ya!=this.world()?Ua&&Ua.show(ya):Ua&&Ua.deactivate()}},{key:"onMouseDown",value:function(P){var ya=P.state.clickedOnMorph;if(!P.isCommandKey()&&
ya==this.borderBox)return this.remove();if(P.isShiftDown()&&P.isCommandKey())P=this.target.isMorphSelection?this.target.morphBeneath(P.position):this.morphBeneath(P.position),this.isAlreadySelected(P)?this.removeMorphFromSelection(P):this.addMorphToSelection(P);else{if(ya==this.borderBox&&P.isCommandKey()){var Ua=P.world.morphsContainingPoint(P.position).filter(function(Eb){return Eb.halosEnabled});(Ua=Ua.slice(Ua.indexOf(this.target)+1)[0]||Ua[0]||P.world)&&P.world.showHaloFor(Ua,P.domEvt.pointerId);
this.remove()}ya==this&&P.isCommandKey()&&(Ua=this.morphBeneath(P.position),P.world.showHaloFor(Ua,P.domEvt.pointerId));ya==this&&this.remove()}}},{key:"onKeyUp",value:function(P){this.changingName||this.buttonControls.map(function(ya){return ya.onKeyUp(P)})}},{key:"getMesh",value:function(P,ya){var Ua=P.x;P=P.y;ya=void 0===ya?Ra.pt(0,0):ya;var Eb=this.world().visibleBounds(),Cc=Eb.height;Eb=Eb.width;var cd={borderStyle:"dotted",borderWidth:2,borderColor:Ra.Color.orange};cd=this.get("mesh")||this.addMorph(new Ra.Morph({name:"mesh",
styleClasses:["halo-mesh"],extent:Ra.pt(Eb,Cc),fill:null,submorphs:[new Ra.Path(Object.assign({name:"vertical"},cd)),new Ra.Path(Object.assign({name:"horizontal"},cd))]}));cd.globalPosition=ya;cd.getSubmorphNamed("vertical").vertices=[Ra.pt(Ua,0).subPt(ya),Ra.pt(Ua,Cc).subPt(ya)];cd.getSubmorphNamed("horizontal").vertices=[Ra.pt(0,P).subPt(ya),Ra.pt(Eb,P).subPt(ya)];return cd}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Halo"}},{key:"properties",get:function(){return{fill:{defaultValue:Ra.Color.transparent},
resizeOnly:{defaultValue:!1},pointerId:{},hasFixedPosition:{defaultValue:!0},respondsToVisibleWindow:{defaultValue:!0},submorphs:{after:["target"],initialize:function(){this.initButtons();this.alignWithTarget()}},layout:{after:["submorphs"],initialize:function(){this.initLayout()}},hasTinyTarget:{derived:!0,get:function(){return 40>this.target.bounds().extent().dist(Ra.pt(0))}},target:{get:function(){return this.state?this.state.target:null},set:function(P){this.state||(this.state={});var ya=!!this.state.target;
this.detachFromTarget();P=this.prepareTarget(P);this.state.target=P;ya&&this.alignWithTarget();Ra.connect(P,"onChange",this,"alignWithTarget");Ra.connect(P,"onOwnerChanged",this,"removeIfDetached")}}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:895,end:17042})}(Ra.Morph);tc=Ra.Halo;
var Qd=Da("H",tc);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("HaloPropertyDisplay")&&"function"===typeof Ba.HaloPropertyDisplay?Ba.HaloPropertyDisplay:Ba.HaloPropertyDisplay=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"isHaloItem",get:function(){return!1}},{key:"halo",get:function(){return this.owner}},{key:"displayedValue",value:function(){return this.textString}},
{key:"displayProperty",value:function(P){var ya=this.halo.state.activeButton;P=String(P);this.visible=!0;this.textString=P;this.position=this.constructor.defaultPosition;this.bounds().insetBy(10).intersects(ya.bounds())&&(this.position=Ra.pt(ya.topRight.x+10,this.position.y))}},{key:"disable",value:function(){this.position=this.constructor.defaultPosition;this.visible=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"HaloPropertyDisplay"}},{key:"morphName",get:function(){return"propertyDisplay"}},
{key:"defaultPosition",get:function(){return Ra.pt(25,0)}},{key:"for",value:function(P){return P.getSubmorphNamed(this.morphName)||P.addMorph(new this({name:this.morphName}))}},{key:"properties",get:function(){return{name:{defaultValue:this.name},fill:{defaultValue:Ra.Color.black.withA(.7)},borderRadius:{defaultValue:7},padding:{defaultValue:Ra.Rectangle.inset(5)},visible:{defaultValue:!1},readOnly:{defaultValue:!0},fontSize:{defaultValue:12},fontColor:{defaultValue:Ra.Color.white},position:{defaultValue:this.defaultPosition}}}}],
Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:17233,end:18580})})(Ra.Label);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("MultiSelectionTarget")&&"function"===typeof Ba.MultiSelectionTarget?Ba.MultiSelectionTarget:Ba.MultiSelectionTarget=
function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"isHaloItem",get:function(){return!0}},{key:"isMorphSelection",get:function(){return!0}},{key:"selectsMorph",value:function(P){return this.selectedMorphs.includes(P)}},{key:"alignWithSelection",value:function(){var P=this.selectedMorphs.map(function(ya){return ya.globalBounds()}).reduce(function(ya,Ua){return ya.union(Ua)});this.setBounds(P)}},{key:"onGrab",
value:function(P){this.grabbingHand=P.hand;this.selectionGrabbed=!0;P.hand.grab(this.selectedMorphs);Ra.once(P.hand,"dropMorphsOn",this,"onGrabEnd");Ra.connect(P.hand,"position",this,"alignWithSelection")}},{key:"onGrabEnd",value:function(){this.selectionGrabbed=!1;Ra.disconnectAll(this.grabbingHand)}},{key:"updateExtent",value:function(P){var ya=P.value.subPt(P.prevValue);this.selectedMorphs.forEach(function(Ua){return Ua.resizeBy(ya)})}},{key:"updatePosition",value:function(P){if(!this.selectionGrabbed){var ya=
P.value.subPt(P.prevValue);this.selectedMorphs.forEach(function(Ua){return Ua.moveBy(ya)})}}},{key:"updateRotation",value:function(P){var ya=this,Ua=P.value-P.prevValue;this.selectedMorphs.forEach(function(Eb){var Cc=Eb.origin;Eb.adjustOrigin(Eb.localize(ya.worldPoint(Ra.pt(0,0))));Eb.rotation+=Ua;Eb.adjustOrigin(Cc)})}},{key:"updateScale",value:function(P){var ya=this,Ua=P.value-P.prevValue;this.selectedMorphs.forEach(function(Eb){var Cc=Eb.origin;Eb.adjustOrigin(Eb.localize(ya.worldPoint(Ra.pt(0,
0))));Eb.scale+=Ua;Eb.adjustOrigin(Cc)})}},{key:"onChange",value:function(P){qb._get(Object.getPrototypeOf(Mb.prototype),"onChange",this).call(this,P);if(this.modifiesSelectedMorphs){switch(P.prop){case "extent":this.updateExtent(P);break;case "scale":this.updateScale(P);break;case "position":this.updatePosition(P);break;case "rotation":this.updateRotation(P)}return P}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MultiSelectionTarget"}},{key:"properties",get:function(){return{visible:{defaultValue:!1},
modifiesSelectedMorphs:{defaultValue:!1},selectedMorphs:{defaultValue:[]},halosEnabled:{defaultValue:!1}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:18648,end:20919})})(Ra.Morph);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("HaloItem")&&
"function"===typeof Ba.HaloItem?Ba.HaloItem:Ba.HaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"menuItems",value:function(){return[]}},{key:"init",value:function(){}},{key:"update",value:function(){}},{key:"stop",value:function(){}},{key:"valueForPropertyDisplay",value:function(){}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"HaloItem"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:15},nativeCursor:{defaultValue:"pointer"},fill:{defaultValue:Ra.Color.gray.withA(.7)},grabbable:{defaultValue:!1},extent:{defaultValue:Ra.pt(24,24)},halo:{}}}},{key:"for",value:function(P){return P.getSubmorphNamed(this.morphName)||P.addMorph(new this({halo:P,name:this.morphName}))}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21085,end:21762})})(Ra.Morph);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("NameHolder")&&"function"===typeof Ba.NameHolder?Ba.NameHolder:Ba.NameHolder=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"onHoverIn",
value:function(P){this.highlightOnHover&&this.nameHolder.active&&(this.halo.toggleMorphHighlighter(!0,this.target),this.nameHolder.fontColor=Ra.Color.orange)}},{key:"onHoverOut",value:function(P){this.highlightOnHover&&(this.halo.toggleMorphHighlighter(!1,this.target),this.nameHolder.fontColor=Ra.Color.darkgray)}},{key:"accept",value:function(){this.target.name!==this.nameHolder.textString&&this.updateName(this.nameHolder.textString)}},{key:"onKeyDown",value:function(P){"Enter"==P.keyCombo?(this.accept(),
P.stop()):qb._get(Object.getPrototypeOf(Mb.prototype),"onKeyDown",this).call(this,P)}},{key:"onMouseUp",value:function(){Ra.signal(this,"active",[!0,this])}},{key:"onMouseDown",value:function(P){this.nameHolder.fontColor=Ra.Color.white;this.halo.toggleMorphHighlighter(!1,this.target)}},{key:"onKeyUp",value:function(P){P=this.nameHolder.textString;var ya=this.target.owner;this.validName=!ya||!ya.getSubmorphNamed(P)||this.target.name==P;Ra.signal(this,"valid",[this.validName,P])}},{key:"update",value:function(){var P=
this;this.nameHolder.textString!==this.target.name&&(this.nameHolder.textString=this.target.name,this.whenRendered().then(function(){return P.nameHolder.fit()}))}},{key:"activate",value:function(){this.nameHolder.readOnly=!1;this.nameHolder.active=!0;this.nameHolder.animate({opacity:1})}},{key:"deactivate",value:function(){this.nameHolder.readOnly=!0;this.nameHolder.active=!1;this.nameHolder.animate({opacity:.3})}},{key:"updateName",value:function(P){if(!this.forceUniqueName||this.validName)this.target.name=
P,Ra.signal(this,"active",[!1,this])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHolder"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Click to edit the morph's name"},draggable:{defaultValue:!1},fill:{defaultValue:Ra.Color.transparent},forceUniqueName:{defaultValue:!1},halo:{},layout:{after:["nameHolder"],initialize:function(){this.layout=new Ra.HorizontalLayout({resizeContainer:!0,spacing:7})}},nameHolder:{after:["submorphs"],initialize:function(){this.nameHolder=
this.addMorph(new Ra.Text({fill:Ra.Color.transparent,fontColor:Ra.Color.white,fontWeight:"bold",active:!0}));Ra.connect(this.nameHolder,"onBlur",this,"accept")}}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21799,end:24333})})(Ra.Morph);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Mb=Ba.hasOwnProperty("NameHaloItem")&&"function"===typeof Ba.NameHaloItem?Ba.NameHaloItem:Ba.NameHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){qb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,P);this.initNameHolders();this.validityIndicator=Ra.Icon.makeLabel("check",{fontColor:Ra.Color.green,
fontSize:15,padding:Ra.rect(4,6,4,0)});this.fill=this.halo.target.isComponent?Ra.componentAccent:Ra.haloBlue;this.alignInHalo()}},{key:"targets",value:function(){return this.halo.target?this.halo.target.isMorphSelection?this.halo.target.selectedMorphs.map(function(P){return{target:P,highlightOnHover:!0}}):[{target:this.halo.target,highlightOnHover:!1}]:[]}},{key:"initNameHolders",value:function(){var P=this;this.nameHolders=this.targets().map(function(ya){ya=new Ra.NameHolder({halo:P.halo,highlightOnHover:ya.highlightOnHover,
target:ya.target});Ra.connect(ya,"active",P,"toggleActive");Ra.connect(ya,"valid",P,"toggleNameValid");return ya});this.submorphs=Ra.arr.interpose(this.nameHolders,{extent:Ra.pt(1,28),fill:Ra.Color.black.withA(.4)})}},{key:"toggleActive",value:function(P){P=$jscomp.makeIterator(P);var ya=P.next().value,Ua=P.next().value;this.halo.changingName!==ya&&((this.halo.changingName=ya)?(this.nameHolders.forEach(function(Eb){return Eb!=Ua&&Eb.deactivate()}),this.borderWidth=3,this.addMorph(this.validityIndicator),
this.fill=Ra.Color.darkGray,setTimeout(function(){return Ua.nameHolder.selectAll()})):(this.fill=Ra.haloBlue,this.nameHolders.forEach(function(Eb){return Eb!=Ua&&Eb.activate()}),this.borderWidth=0,this.validityIndicator.remove(),this.halo.focus()),this.alignInHalo())}},{key:"toggleNameValid",value:function(P){var ya=$jscomp.makeIterator(P);P=ya.next().value;ya=ya.next().value;(this.validName=P)?(this.conflictingMorph=null,this.borderColor=Ra.Color.green,this.validityIndicator.nativeCursor="auto",
this.validityIndicator.fontColor=Ra.Color.green,Ra.Icon.setIcon(this.validityIndicator,"check")):(this.conflictingMorph=this.get(ya),this.borderColor=Ra.Color.red,this.validityIndicator.fontColor=Ra.Color.red,this.validityIndicator.nativeCursor="pointer",Ra.Icon.setIcon(this.validityIndicator,"exclamation-circle"))}},{key:"alignInHalo",value:function(){Ra.arr.zip(this.targets(),this.nameHolders).map(function(ya){var Ua=$jscomp.makeIterator(ya);ya=Ua.next().value.target;Ua=Ua.next().value;Ua.target=
ya;Ua.update()});var P=this.halo.innerBounds().bottomCenter().addPt(Ra.pt(0,2));this.topCenter=Ra.pt(Math.max(P.x,30),Math.max(P.y,80))}},{key:"onMouseDown",value:function(P){var ya=this,Ua=this.conflictingMorph;Ua&&(this.halo.toggleMorphHighlighter(!0,Ua),setTimeout(function(){return ya.halo.toggleMorphHighlighter(!1,Ua)},1E3))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHaloItem"}},{key:"morphName",get:function(){return"name"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:4},
fill:{defaultValue:Ra.haloBlue},borderColor:{defaultValue:Ra.Color.green},layout:{initialize:function(){this.layout=new Ra.HorizontalLayout({resizeContainer:!0,spacing:0})}}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:24335,end:27502})})(Ra.HaloItem);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Mb=Ba.hasOwnProperty("CloseHaloItem")&&"function"===typeof Ba.CloseHaloItem?Ba.CloseHaloItem:Ba.CloseHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"update",value:function(){var P=this.halo,ya=P.target.owner;ya.undoStart("close-halo");P.target.selectedMorphs?P.target.selectedMorphs.forEach(function(Ua){return Ua.remove()}):P.target.remove();ya.undoStop("close-halo");P.remove()}},{key:"onMouseDown",
value:function(P){this.update()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CloseHaloItem"}},{key:"morphName",get:function(){return"close"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["fas","fa-times"]},draggable:{defaultValue:!1},tooltip:{defaultValue:"Remove this morph from the world"}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:27505,end:28111})})(Ra.HaloItem);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("GrabHaloItem")&&"function"===typeof Ba.GrabHaloItem?Ba.GrabHaloItem:Ba.GrabHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"adjustTarget",value:function(P,ya){Ra.PropertyPath("owner.layout.autoResize").get(P)&&
!P.globalBounds().insetBy(10).containsPoint(ya)&&(P=P.owner);return P}},{key:"valueForPropertyDisplay",value:function(){var P=this.hand,ya=this.halo,Ua=this.prevDropTarget,Eb=P.world(),Cc=P.findDropTarget(P.globalPosition,[ya.target],function(cd){return!cd.isHaloItem&&!cd.ownerChain().some(function(ee){return ee.isHaloItem||!ee.visible||0==ee.opacity})});Cc=this.adjustTarget(Cc,P.globalPosition);ya.toggleMorphHighlighter(Cc&&Cc!=Eb,Cc,!0);Ua&&Ua!=Cc&&ya.toggleMorphHighlighter(!1,Ua);return(this.prevDropTarget=
Cc)&&Cc.name}},{key:"init",value:function(P){var ya=this.halo,Ua=ya.target.undoStart("grab-halo");Ua&&Ua.addTarget(ya.target.owner);this.hand=P;ya.target.onGrab({halo:ya,hand:P,isShiftDown:function(){return!1}});ya.state.activeButton=this;this.opacity=.3;var Eb=Ra.connect(P,"update",this,"update");Ra.once(ya.target,"remove",function(){return Eb.disconnect()})}},{key:"stop",value:function(P){var ya=this.halo,Ua=this.prevDropTarget,Eb=ya.target.undoInProgress,Cc=P.hand.findDropTarget(P.hand.globalPosition,
[ya.target],function(cd){return!cd.isHaloItem&&!cd.ownerChain().some(function(ee){return ee.isHaloItem})});Cc=this.adjustTarget(Cc,P.hand.globalPosition);Ra.disconnect(P.hand,"update",this,"update");Ra.MorphHighlighter.interceptDrop(ya,Cc,ya.target);Eb.addTarget(Cc);Cc.onDrop(P);ya.state.activeButton=null;ya.alignWithTarget();ya.toggleMorphHighlighter(!1,Ua);Ra.MorphHighlighter.removeHighlighters(ya);ya.target.undoStop("grab-halo");this.opacity=1}},{key:"update",value:function(){this.halo.alignWithTarget()}},
{key:"onDragStart",value:function(P){this.init(P.hand)}},{key:"onDragEnd",value:function(P){this.stop(P)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrabHaloItem"}},{key:"morphName",get:function(){return"grab"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["far","fa-hand-rock"]},tooltip:{defaultValue:"Grab the morph"},draggable:{defaultValue:!0}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:28114,end:30619})})(Ra.HaloItem);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("DragHaloItem")&&"function"===typeof Ba.DragHaloItem?Ba.DragHaloItem:Ba.DragHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,
wa,[{key:"valueForPropertyDisplay",value:function(){return this.halo.target.position}},{key:"updateAlignmentGuide",value:function(P){var ya=this.halo.getSubmorphNamed("mesh");if(P)return ya=this.halo.getMesh(this.halo.target.worldPoint(Ra.pt(0,0))),this.focus(),ya;ya&&ya.remove()}},{key:"init",value:function(){var P=this.halo.target;P.undoStart("drag-halo");this.halo.state.activeButton=this;this.actualPos=P.position;this.targetTransform=P.owner.getGlobalTransform().inverse()}},{key:"stop",value:function(){this.halo.target.undoStop("drag-halo");
this.halo.state.activeButton=null;this.halo.alignWithTarget();this.updateAlignmentGuide(!1);Ra.removeSnapToGuidesOf(this.halo.target)}},{key:"update",value:function(P,ya,Ua){ya=void 0===ya?!1:ya;Ua=void 0===Ua?!1:Ua;this.actualPos=P=this.actualPos.addPt(this.targetTransform.transformDirection(P));ya&&(P=P.griddedBy(Ra.pt(10,10)));this.halo.target.position=P;this.updateAlignmentGuide(ya);ya||Ra.showAndSnapToGuides(this.halo.target,!0,Ua,5,500)}},{key:"onDragStart",value:function(P){this.init()}},{key:"onDrag",
value:function(P){this.update(P.state.dragDelta,P.isAltDown(),P.isCtrlDown())}},{key:"onDragEnd",value:function(P){this.stop()}},{key:"onKeyUp",value:function(P){this.updateAlignmentGuide(!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DragHaloItem"}},{key:"morphName",get:function(){return"drag"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},styleClasses:{defaultValue:["fas","fa-arrows-alt"]},tooltip:{defaultValue:"Change the morph's position. Press (alt) while dragging to align the morph's position along a grid."}}}}],
Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:30622,end:32433})})(Ra.HaloItem);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("InspectHaloItem")&&"function"===typeof Ba.InspectHaloItem?Ba.InspectHaloItem:Ba.InspectHaloItem=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"onMouseDown",value:function(P){var ya=this;(function(){var Ua,Eb,Cc,cd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ee){if(1==ee.nextAddress)return ee.yield(System.import("lively.ide/js/inspector.js"),2);Ua=ee.yieldResult;Eb=Ua.default;(Cc=ya.world().getSubmorphsByStyleClassName("Inspector").find(function(Vd){return Vd.targetObject==ya.halo.target}))&&
(cd=Cc.getWindow())?(cd.minimized=!1,cd.animate({center:ya.world().visibleBounds().center(),duration:200})):Eb.openInWindow({targetObject:ya.halo.target});ya.halo.remove();ee.jumpToEnd()})})()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectHaloItem"}},{key:"morphName",get:function(){return"inspect"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Inspect the morph's local state"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-cogs"]}}}}],
Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:32436,end:33338})})(Ra.HaloItem);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("EditHaloItem")&&"function"===typeof Ba.EditHaloItem?Ba.EditHaloItem:Ba.EditHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"onMouseDown",value:function(P){var ya=this;(P=this.world().getSubmorphsByStyleClassName("ObjectEditor").find(function(Ua){return Ua.target==ya.halo.target}))?(P=P.getWindow(),P.bringToFront(),P.minimized=!1,P.animate({center:this.world().visibleBounds().center(),duration:200})):$world.execCommand("open object editor",{target:this.halo.target});this.halo.remove()}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"EditHaloItem"}},{key:"morphName",get:function(){return"edit"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Edit the morph's definition"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-wrench"]}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:33341,end:34123})})(Ra.HaloItem);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("RotateHaloItem")&&"function"===typeof Ba.RotateHaloItem?Ba.RotateHaloItem:Ba.RotateHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){qb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,P);this.adaptAppearance(!1)}},{key:"angle",get:function(){return this.getProperty("angle")||0}},{key:"angle",set:function(P){this.setProperty("angle",P)}},{key:"scaleGauge",get:function(){return this.getProperty("scaleGauge")||null}},{key:"scaleGauge",set:function(P){this.setProperty("scaleGauge",P)}},{key:"initRotation",get:function(){return this.getProperty("initRotation")||0}},{key:"initRotation",set:function(P){this.setProperty("initRotation",P)}},{key:"valueForPropertyDisplay",
value:function(){var P=this.halo.target;return this.scaleGauge?P.scale.toFixed(4).toString():Ra.num.toDegrees(P.rotation).toFixed(1)+"\u00b0"}},{key:"init",value:function(P){this.detachFromLayout();this.halo.target.undoStart("rotate-halo");this.halo.state.activeButton=this;this.angle=P;this.initRotation=this.halo.target.rotation;this.halo.toggleRotationIndicator(!0,this)}},{key:"initScale",value:function(P){this.detachFromLayout();this.halo.state.activeButton=this;this.scaleGauge=P.scaleBy(1/this.halo.target.scale);
this.halo.toggleRotationIndicator(!0,this)}},{key:"update",value:function(P){this.scaleGauge=null;P=this.initRotation+(P-this.angle);P=Ra.num.toRadians(Ra.num.detent(Ra.num.toDegrees(P),10,45));this.halo.target.rotation=P;this.halo.toggleRotationIndicator(!0,this)}},{key:"updateScale",value:function(P){var ya=this.scaleGauge,Ua=this.halo;ya||(ya=this.scaleGauge=P.scaleBy(1/Ua.target.scale));this.angle=P.theta();this.initRotation=Ua.target.rotation;Ua.target.scale=Ra.num.detent(P.dist(Ra.pt(0,0))/
ya.dist(Ra.pt(0,0)),.1,.5);Ua.toggleRotationIndicator(!0,this)}},{key:"stop",value:function(){this.attachToLayout();this.scaleGauge=null;this.halo.state.activeButton=null;this.halo.alignWithTarget();this.halo.toggleRotationIndicator(!1,this);this.halo.target.undoStop("rotate-halo");this.halo.ensureResizeHandles()}},{key:"adaptAppearance",value:function(P){this.styleClasses=["fas",P?"fa-search-plus":"fa-redo"];this.tooltip=P?"Scale morph":"Rotate morph"}},{key:"detachFromLayout",value:function(){this.savedLayout=
this.halo.layout;this.halo.layout=null}},{key:"attachToLayout",value:function(){this.halo.layout=this.savedLayout}},{key:"onDragStart",value:function(P){this.adaptAppearance(P.isShiftDown());P.isShiftDown()?this.initScale(P.position.subPt(this.halo.target.globalPosition)):this.init(P.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDrag",value:function(P){this.globalPosition=P.position.addPt(Ra.pt(-10,-10));this.adaptAppearance(P.isShiftDown());P.isShiftDown()?this.updateScale(P.position.subPt(this.halo.target.globalPosition)):
this.update(P.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDragEnd",value:function(P){this.adaptAppearance(P.isShiftDown());this.stop()}},{key:"onKeyDown",value:function(P){this.adaptAppearance(P.isShiftDown())}},{key:"onKeyUp",value:function(P){this.adaptAppearance(P.isShiftDown())}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RotateHaloItem"}},{key:"morphName",get:function(){return"rotate"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0}}}}],
Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:34125,end:37569})})(Ra.HaloItem);Ra.nameNumberRe=/(.+)([0-9]+)$/;(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("ComponentHaloItem")&&"function"===typeof Ba.ComponentHaloItem?Ba.ComponentHaloItem:
Ba.ComponentHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"updateComponentIndicator",value:function(){var P=this.world(),ya=this.halo.target;this.halo.remove();P.showHaloFor(ya)}},{key:"onMouseDown",value:function(){this.halo.target.isComponent=!this.halo.target.isComponent;this.updateComponentIndicator()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ComponentHaloItem"}},
{key:"morphName",get:function(){return"component"}},{key:"properties",get:function(){return{tooltip:{get:function(){return this.halo.target.isComponent?"Retract Component":"Turn into Component"}},styleClasses:{initialize:function(){this.styleClasses=this.halo.target.isComponent?["fas","fa-eraser"]:["fas","fa-cube"]}}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:37611,end:38357})})(Ra.HaloItem);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("CopyHaloItem")&&"function"===typeof Ba.CopyHaloItem?Ba.CopyHaloItem:Ba.CopyHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"init",value:function(P){function ya(Ze,Wd){return Wd.match(Ra.nameNumberRe)?
Wd.replace(Ra.nameNumberRe,function(Be,Qe,rf){rf||(rf="0");for(Be=Number(rf);Ze.get(Qe+ ++Be););return Qe+Be}):Wd+"1"}var Ua=this.halo,Eb=Ua.target,Cc=Ua.world(),cd=Eb instanceof Ra.MultiSelectionTarget;Ua.remove();Ra.connect(P,"update",this,"update");if(cd){var ee=Eb.selectedMorphs.map(function(Ze){return Cc.addMorph(Ze.copy())});cd=ee.map(function(Ze){Ze.name=ya(Eb,Ze.name);return Ze.position});ee[0].undoStart("copy-halo");Cc.addMorph(Ua);Ua.refocus(ee);P.grab(Ua.target);Ua.target.onGrab({halo:Ua,
hand:P,isShiftDown:function(){return!1}});cd.forEach(function(Ze,Wd){return ee[Wd].globalPosition=Ze});Ua.alignWithTarget()}else{cd=Eb.globalPosition;var Vd=Eb.copy();Eb.isComponent&&(Vd.isComponent=!1,Vd.withAllSubmorphsDoExcluding(function(Ze){Ze!=Vd&&Ze.master||delete Ze._parametrizedProps},function(Ze){return Ze.master&&Ze!=Vd}),Vd.master=Eb);Vd.name=ya(Eb,Eb.name);Cc.addMorph(Vd);Vd.globalPosition=cd;Vd.undoStart("copy-halo");P.grab(Vd);Cc.addMorph(Ua);Ua.visible=!1}}},{key:"stop",value:function(P){var ya=
this.halo,Ua=$jscomp.makeIterator(P.grabbedMorphs).next().value,Eb=P.findDropTarget(P.globalPosition,[ya.target],function(cd){return!cd.isHaloItem&&!cd.ownerChain().some(function(ee){return ee.isHaloItem})}),Cc=ya.target.undoInProgress;Ra.disconnect(P,"update",this,"update");Cc.addTarget(Eb);P.dropMorphsOn(Eb);ya.target.undoStop("copy-halo");ya.remove();P.world().showHaloFor(Ua)}},{key:"onDragStart",value:function(P){this.init(P.hand)}},{key:"onDragEnd",value:function(P){this.stop(P.hand)}},{key:"update",
value:function(){this.halo.alignWithTarget()}},{key:"copyToClipBoard",value:function(){var P=this,ya,Ua,Eb,Cc,cd,ee,Vd,Ze,Wd,Be,Qe,rf,cg,Ef,Oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Af){switch(Af.nextAddress){case 1:ya=P;Ua=ya.halo;if(Ua.nameHalo().nameHolders.find(function(qg){return qg.nameHolder===$world.focusedMorph}))return Af.return();Eb=Ua.target;Cc=Ua.world();cd=Eb instanceof Ra.MultiSelectionTarget;ee=Eb.globalBounds().topLeft();Vd=cd?Eb.selectedMorphs:[Eb];Ze=[];Wd=
'<!DOCTYPE html>\n          <html lang="en">\n          <head>\n            <meta charset="utf-8">\n            '+document.querySelector("#lively-morphic-css").outerHTML+"\n          </head>\n          <body>";Ua.remove();Af.setCatchFinallyBlocks(2);Be=$jscomp.makeIterator(Vd);Qe=Be.next();case 4:if(Qe.done)return Wd+="</body></html>",Ef=JSON.stringify(Ze),Af.yield(P.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/html",data:Wd},{type:"application/morphic",data:Ef}]),8);rf=Qe.value;return Af.yield(Ra.createMorphSnapshot(rf,
{addPreview:!1,testLoad:!1}),7);case 7:cg=Af.yieldResult;cg.copyMeta={offset:rf.worldPoint(Ra.pt(0,0)).subPt(ee)};Ze.push(cg);Wd+=rf.renderPreview();Qe=Be.next();Af.jumpTo(4);break;case 8:Af.leaveTryBlock(3);break;case 2:return Oc=Af.enterCatchBlock(),Cc.logError(Oc),Af.return();case 3:Cc.addMorph(Ua),Ua.refocus(Vd),Ua.setStatusMessage("copied"),Af.jumpToEnd()}})}},{key:"onMouseUp",value:function(P){var ya=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){P.stop();return Ua.yield(ya.copyToClipBoard(),
0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CopyHaloItem"}},{key:"morphName",get:function(){return"copy"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},tooltip:{defaultValue:"Copy morph"},styleClasses:{defaultValue:["far","fa-clone"]}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:38359,end:42348})})(Ra.HaloItem);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("OriginHaloItem")&&"function"===typeof Ba.OriginHaloItem?Ba.OriginHaloItem:Ba.OriginHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"fill",get:function(){return Ra.Color.white.interpolate(.2,this.borderColorTop)}},{key:"extent",get:function(){return Ra.pt(15,
15)}},{key:"tooltip",get:function(){return"Change the morph's origin"}},{key:"computePositionAtTarget",value:function(){return this.halo.localize(this.halo.target.globalPosition)}},{key:"alignInHalo",value:function(){this.visible=!this.halo.hasTinyTarget;this.center=this.computePositionAtTarget()}},{key:"valueForPropertyDisplay",value:function(){return this.halo.target.origin}},{key:"init",value:function(){this.halo.target.undoStart("origin-halo");this.halo.state.activeButton=this}},{key:"stop",value:function(){this.halo.target.undoStop("origin-halo");
this.halo.state.activeButton=null;this.halo.alignWithTarget()}},{key:"update",value:function(P){var ya=this.halo,Ua=ya.target.origin,Eb=ya.target.worldPoint(Ua);P=ya.target.localize(Eb.addPt(P)).subPt(ya.target.scroll).subPt(Ua);ya.target.adjustOrigin(ya.target.origin.addPt(P))}},{key:"onDragStart",value:function(P){this.init()}},{key:"onDragEnd",value:function(P){this.stop()}},{key:"onDrag",value:function(P){this.update(P.state.dragDelta)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"OriginHaloItem"}},
{key:"morphName",get:function(){return"origin"}},{key:"properties",get:function(){return{borderWidth:{defaultValue:3},nativeCursor:{defaultValue:"-webkit-grab"},draggable:{defaultValue:!0},borderColor:{after:["halo"],initialize:function(){this.borderColor=this.halo.target.isComponent?Ra.componentAccent:Ra.haloBlue}}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:42351,end:43982})})(Ra.HaloItem);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("ResizeHandle")&&"function"===typeof Ba.ResizeHandle?Ba.ResizeHandle:Ba.ResizeHandle=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"valueForPropertyDisplay",value:function(){var P=this.halo.target.extent,
ya=P.y;return P.x.toFixed(1)+"x"+ya.toFixed(1)}},{key:"positionInHalo",value:function(){var P=this.halo.borderBox.bounds();this.halo.hasTinyTarget&&(Ra.Rectangle.prototype.sides.includes(this.location)&&(this.visible=!1),P=P.insetBy(-4));return P.partNamed(this.location)}},{key:"alignInHalo",value:function(){this.center=this.positionInHalo();return this}},{key:"onKeyUp",value:function(P){this.halo.state.activeButton==this&&this.halo.toggleDiagonal(P.isShiftDown(),this.corner)}},{key:"onKeyDown",value:function(P){this.halo.state.activeButton==
this&&this.halo.toggleDiagonal(P.isShiftDown(),this.corner)}},{key:"onDragStart",value:function(P){this.init(P.position,P.isShiftDown())}},{key:"onDragEnd",value:function(P){this.stop(P.isShiftDown())}},{key:"onDrag",value:function(P){this.update(P.position,P.isShiftDown(),P.isAltDown(),P.isCtrlDown());this.focus()}},{key:"init",value:function(P,ya){ya=void 0===ya?!1:ya;var Ua=this.halo.target,Eb=Ua.origin,Cc=Ua.position;Ua=Ua.extent;this.startPos=P;this.startBounds=Cc.subPt(Eb).extent(Ua);this.startOrigin=
this.halo.target.origin;this.savedLayout=this.halo.layout;this.halo.layout=null;this.halo.state.activeButton=this;this.tfm=this.halo.target.getGlobalTransform().inverse();P=this.halo.target.getGlobalTransform().getRotation();this.offsetRotation=Ra.num.toRadians(P%45);this.halo.toggleDiagonal(ya,this.corner)}},{key:"update",value:function(P,ya,Ua,Eb){ya=void 0===ya?!1:ya;Ua=void 0===Ua?!1:Ua;Eb=void 0===Eb?!1:Eb;var Cc=this.corner,cd=this.tfm;P=this.startPos.subPt(P);cd=cd.transformDirection(Ra.pt(P.x,
P.y));Ua&&(cd=cd.griddedBy(Ra.pt(10,10)));this.halo.updateBoundsFor(Cc,ya,cd,this.startBounds,this.startOrigin);this.halo.toggleDiagonal(ya,Cc);this.updateAlignmentGuide(Ua);ya=[];Cc=Cc.toLowerCase();Cc.includes("left")&&ya.push("left");Cc.includes("top")&&ya.push("top");Cc.includes("bottom")&&ya.push("bottom");Cc.includes("right")&&ya.push("right");Ra.showAndSnapToResizeGuides(this.halo.target,ya,!0,Eb,5,200)}},{key:"stop",value:function(P){P=this.halo;P.layout=this.savedLayout;P.state.activeButton=
null;P.alignWithTarget();P.toggleDiagonal(!1);this.updateAlignmentGuide(!1);Ra.removeSnapToGuidesOf(P.target)}},{key:"updateAlignmentGuide",value:function(P){var ya=this.halo.getSubmorphNamed("mesh");if(P)return P=this.halo.target.extent,P=Ra.pt(P.x%10,P.y%10),ya=this.halo.getMesh(this.globalPosition.addPt(this.extent.scaleBy(.5)),P),this.focus(),ya;ya&&ya.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ResizeHandle"}},{key:"properties",get:function(){return{corner:{},location:{},
draggable:{defaultValue:!0},isResizeHandle:{readOnly:!0,get:function(){return!0}}}}},{key:"getResizeParts",value:function(P){0<P&&(P-=360);P=-8-(P/45).toFixed();0==P&&(P=8);return Ra.arr.zip(Ra.arr.rotate([["topLeft",function(ya){return ya.negated()}],["topCenter",function(ya){return ya.withX(0).negated()}],["topRight",function(ya){return ya.withX(0).negated()}],["rightCenter",function(ya){return Ra.pt(0,0)}],["bottomRight",function(ya){return Ra.pt(0,0)}],["bottomCenter",function(ya){return Ra.pt(0,
0)}],["bottomLeft",function(ya){return ya.withY(0).negated()}],["leftCenter",function(ya){return ya.withY(0).negated()}]],P),[["nwse-resize","topLeft"],["ns-resize","topCenter"],["nesw-resize","topRight"],["ew-resize","rightCenter"],["nwse-resize","bottomRight"],["ns-resize","bottomCenter"],["nesw-resize","bottomLeft"],["ew-resize","leftCenter"]])}},{key:"resizersFor",value:function(P){var ya=this;if(!P.target)return[];var Ua=P.target.getGlobalTransform().getRotation();return Ra.arr.compact(this.getResizeParts(Ua).map(function(Eb){var Cc=
$jscomp.makeIterator(Eb),cd=$jscomp.makeIterator(Cc.next().value);Eb=cd.next().value;cd.next();cd.next();cd=$jscomp.makeIterator(Cc.next().value);Cc=cd.next().value;cd=cd.next().value;return ya.for(P,Eb,cd,Cc)})).map(function(Eb){return Eb.alignInHalo()})}},{key:"for",value:function(P,ya,Ua,Eb){var Cc="Resize "+ya;P=P.getSubmorphNamed(Cc)||new this({name:Cc,halo:P,corner:ya,tooltip:"Resize "+ya,extent:Ra.pt(10,10),borderWidth:1,borderRadius:0,borderColor:P.target.isComponent?Ra.componentAccent:Ra.haloBlue,
fill:Ra.Color.white});return Object.assign(P,{nativeCursor:Eb,location:Ua})}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:44042,end:49305})})(Ra.HaloItem);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("MenuHaloItem")&&"function"===
typeof Ba.MenuHaloItem?Ba.MenuHaloItem:Ba.MenuHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"onMouseDown",value:function(P){var ya=this,Ua,Eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cc){if(1==Cc.nextAddress)return Ua=ya.halo.target,ya.halo.remove(),Cc.yield(Ua.menuItems(),2);Eb=Cc.yieldResult;Ua.world().openMenu(Eb).hasFixedPosition=ya.halo.hasFixedPosition;Cc.jumpToEnd()})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MenuHaloItem"}},{key:"morphName",get:function(){return"menu"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},tooltip:{defaultValue:"Opens the morph menu"},styleClasses:{defaultValue:["fas","fa-bars"]}}}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:49308,end:49819})})(Ra.HaloItem);var md=Da("M",function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Mb=Ba.hasOwnProperty("MorphHighlighter")&&"function"===typeof Ba.MorphHighlighter?Ba.MorphHighlighter:Ba.MorphHighlighter=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"alignWithHalo",value:function(){this.target&&(this.position=this.halo.localize(this.target.globalBounds().topLeft()),
this.halo.isWorld&&(this.position=this.position.subPt(this.halo.scroll)),this.extent=this.target.globalBounds().extent(),this.get("name tag").value=this.target.name,this.get("name tag").topCenter=this.innerBounds().insetBy(-10).bottomCenter())}},{key:"show",value:function(){if(this.target&&this.target.layout&&this.showLayout&&(this.layoutHalo=this.layoutHalo||this.world().showLayoutHaloFor(this.target,this.pointerId))&&this.layoutHalo.previewDrop){this.visible=!1;this.alignWithHalo();this.halo.get("grab").hand.grabbedMorphs&&
this.layoutHalo.previewDrop(this.halo.get("grab").hand.grabbedMorphs);return}this.visible=!0;this.alignWithHalo()}},{key:"handleDrop",value:function(P){this.layoutHalo&&this.layoutHalo.handleDrop(P)}},{key:"deactivate",value:function(){this.layoutHalo&&(this.layoutHalo.remove(),this.layoutHalo=null);this.visible=!1;this.alignWithHalo();this.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphHighlighter"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},
name:{defaultValue:"morphHighlighter"},styleClasses:{defaultValue:["inactive"]},reactsToPointer:{defaultValue:!1},hasFixedPosition:{defaultValue:!0},fill:{defaultValue:Ra.Color.orange.withA(.3)},borderWidth:{defaultValue:2},borderColor:{defaultValue:Ra.Color.orange},halo:{},epiMorph:{defaultValue:!0},isHighlighter:{readOnly:!0,defaultValue:!0},highlightedSides:{defaultValue:[],set:function(P){var ya=this;this.setProperty("highlightedSides",P);this.submorphs=P.map(function(Ua){return{type:"ellipse",
isHaloItem:!0,fill:Ra.Color.orange,center:ya.innerBounds()[Ua]()}});this.addMorph({type:"label",name:"name tag",padding:Ra.Rectangle.inset(5,5,5,5),fontColor:Ra.Color.white,fill:Ra.Color.orange,borderRadius:3});this.alignWithHalo()}},showLayout:{defaultValue:!1},targetId:{},target:{readOnly:!0,derived:!0,get:function(){return(this.world()||this.env.world).getMorphWithId(this.targetId)}}}}},{key:"removeHighlighters",value:function(P){P=void 0===P?$world:P;var ya=P._morphHighlighters,Ua;for(Ua in ya)ya[Ua].remove();
delete P._morphHighlighters}},{key:"for",value:function(P,ya,Ua,Eb){Ua=void 0===Ua?!1:Ua;Eb=void 0===Eb?[]:Eb;var Cc=P._morphHighlighters=P._morphHighlighters||{};Ra.properties.forEachOwn(Cc,function(cd,ee){return ee.alignWithHalo()});if(!ya||ya.ownerChain().find(function(cd){return cd.isHaloItem}))return null;Cc[ya.id]=Cc[ya.id]||new this({targetId:ya.id,halo:P,showLayout:Ua});P.addMorph(Cc[ya.id]);Cc[ya.id].highlightedSides=Eb;return Cc[ya.id]}},{key:"interceptDrop",value:function(P,ya,Ua){(P=P._morphHighlighters=
P._morphHighlighters||{},P[ya.id])&&P[ya.id].handleDrop(Ua)}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:50009,end:53521})}(Ra.Morph));Ra.MorphHighlighter=md;Ra.MorphHighlighter=md;Ra.MorphHighlighter=md;var $c=Da("I",function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Mb=Ba.hasOwnProperty("InteractiveMorphSelector")&&"function"===typeof Ba.InteractiveMorphSelector?Ba.InteractiveMorphSelector:Ba.InteractiveMorphSelector=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(P,ya,Ua){P=void 0===P?$world:P;this.controllingMorph=void 0===ya?null:ya;this.possibleTarget=this.morphHighlighter=this.selectorMorph=null;this.world=
P;this.filterFn=Ua;this.whenDone=null}},{key:"selectNewTarget",value:function(){this.targetObject=null;var P=Ra.promise.deferred();P.promise.resolve=P.resolve;this.whenDone=P.promise;this.selectorMorph=Ra.Icon.makeLabel("crosshairs",{fontSize:20,hasFixedPosition:!0,epiMorph:!0}).openInWorld();Ra.connect(this.world.firstHand,"position",this,"scanForTargetAt");Ra.once(this.selectorMorph,"onMouseDown",this,"selectTarget");Ra.once(this.selectorMorph,"onKeyDown",this,"stopSelect");this.selectorMorph.focus();
this.scanForTargetAt(this.world.firstHand.position)}},{key:"scanForTargetAt",value:function(){var P=this.world.firstHand.globalPosition;this.selectorMorph.center=P;this.selectorMorph.focus();var ya=this.selectorMorph.morphBeneath(P),Ua,Eb=this.possibleTarget,Cc=this.controllingMorph,cd=this.filterFn,ee=this.world,Vd=this.morphHighlighter;for(Vd==ya?ya=Vd.morphBeneath(P):ya&&ya.isEpiMorph&&(ya=ya.morphBeneath(P));ya&&(Ua=[ya].concat($jscomp.arrayFromIterable(ya.ownerChain())).find(function(Ze){return!Ze.visible}));)ya=
Ua=Ua.morphBeneath(P);if(ya&&cd&&!cd(ya))for(;ya&&![ya].concat($jscomp.arrayFromIterable(ya.ownerChain())).find(cd);)ya=ya.morphBeneath(P);!ya||ya==Eb||Cc&&ya.ownerChain().includes(Cc.getWindow())||(Vd&&Vd.deactivate(),(this.possibleTarget=Eb=ya)&&!Eb.isWorld&&(P=this.morphHighlighter=Ra.MorphHighlighter.for(ee,ya))&&P.show())}},{key:"selectTarget",value:function(){this.targetObject=this.possibleTarget;this.stopSelect()}},{key:"stopSelect",value:function(){Ra.MorphHighlighter.removeHighlighters(this.world);
Ra.disconnect(this.world.firstHand,"position",this,"scanForTargetAt");this.selectorMorph.remove();this.whenDone&&this.whenDone.resolve(this.targetObject)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveMorphSelector"}},{key:"selectMorph",value:function(P,ya,Ua){P=new this(P,ya,Ua);P.selectNewTarget();return P.whenDone}}],Ba,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:53530,end:56275})}(void 0));Ra.InteractiveMorphSelector=$c;Ra.InteractiveMorphSelector=$c;Ra.InteractiveMorphSelector=$c;Ra.default=tc;var Wa=lively.FreezerRuntime.recorderFor("lively.halos/markers.js");Wa.show=Pa;Wa.showRect=function(wa,Ba,Mb){var P=Wa.BoundsMarker.highlightBounds(Ba);return Mb?Wa.showInLoop(wa,P,Ba):Wa.showThenHide(wa,P)};Wa.showInLoop=function(wa,Ba,Mb){var P;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){switch(ya.nextAddress){case 1:return Wa.showThenHide(wa,
Ba,!1),ya.yield(Wa.promise.delay(300),2);case 2:P=!1,Wa.once(wa,"onMouseDown",function(){return P=!0});case 3:if(P){ya.jumpTo(4);break}return ya.yield(Ba.retract(Mb),3);case 4:Ba.fadeOut(2E3),ya.jumpToEnd()}})};Wa.showThenHide=function(wa,Ba,Mb){Mb=void 0===Mb?3:Mb;if(wa){var P=Array.isArray(Ba)?Ba:[Ba];P.forEach(function(ya){return wa.addMorph(ya)});Mb&&setTimeout(function(){return P.forEach(function(ya){return ya.fadeOut(2E3)})},1E3*Mb);return Ba}};Wa.showLine=function(wa,Ba,Mb){Mb=void 0===Mb?
3E3:Mb;var P=Ba.start;Ba=Ba.end.subPt(P);var ya=wa.addMorph({position:P,rotation:Ba.theta(),border:{width:1,color:Wa.Color.red},width:Ba.fastR(),height:0});Mb&&setTimeout(function(){return ya.fadeOut()},Mb);return ya};Wa.showConnector=bc;Wa.obj=Yb;Wa.promise=dd;Wa.string=uc;Wa.pt=Qb;Wa.Color=hc;Wa.Rectangle=cb;Wa.rect=jd;Wa.morph=ac;Wa.easings=Hc;Wa.Path=Mc;Wa.Icon=ke;Wa.Morph=be;Wa.MorphicEnv=Ia;Wa.connect=Lb;Wa.once=Xb;Wa.disconnect=Sc;Wa.show=Pa;Wa.show=Pa;(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),
Mb=Ba.hasOwnProperty("BoundsMarker")&&"function"===typeof Ba.BoundsMarker?Ba.BoundsMarker:Ba.BoundsMarker=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(){qb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{borderWidth:0,fill:Wa.Color.transparent,reactsToPointer:!1,hasFixedPosition:!0})}},{key:"isEpiMorph",
get:function(){return!0}},{key:"markerLength",value:function(P){P=P.insetBy(-2);P=Math.min(P.width,P.height);return Math.max(4,Math.floor(10>P/10?P/2-5:P/10))}},{key:"createMarkerEdge",value:function(){return Wa.morph({fill:Wa.Color.red,reactsToPointer:!1,borderRadius:10})}},{key:"ensureMarkerCorners",value:function(){var P=this.topLeftH||(this.topLeftH=this.addMorph(this.createMarkerEdge())),ya=this.topLeftV||(this.topLeftV=this.addMorph(this.createMarkerEdge())),Ua=this.topRightH||(this.topRightH=
this.addMorph(this.createMarkerEdge())),Eb=this.topRightV||(this.topRightV=this.addMorph(this.createMarkerEdge())),Cc=this.bottomRightH||(this.bottomRightH=this.addMorph(this.createMarkerEdge())),cd=this.bottomRightV||(this.bottomRightV=this.addMorph(this.createMarkerEdge())),ee=this.bottomLeftH||(this.bottomLeftH=this.addMorph(this.createMarkerEdge())),Vd=this.bottomLeftV||(this.bottomLeftV=this.addMorph(this.createMarkerEdge()));return[P,ya,Ua,Eb,Cc,cd,ee,Vd]}},{key:"alignWithMorph",value:function(P){return this.alignWithBounds(P.globalBounds().translatedBy($world.scroll.negated()))}},
{key:"alignWithBounds",value:function(P){this.alignWithRect(P.insetBy(-20));return this.alignWithRect(P,!0)}},{key:"alignWithRect",value:function(P,ya){var Ua=this.ensureMarkerCorners(),Eb=this.markerLength(P),Cc=[P.topLeft().addXY(0,0).extent(Wa.pt(Eb,5)),P.topLeft().addXY(0,0).extent(Wa.pt(5,Eb)),P.topRight().addXY(-Eb,0).extent(Wa.pt(Eb,5)),P.topRight().addXY(-5,0).extent(Wa.pt(5,Eb)),P.bottomRight().addXY(-5,-Eb).extent(Wa.pt(5,Eb)),P.bottomRight().addXY(-Eb,-5).extent(Wa.pt(Eb,5)),P.bottomLeft().addXY(0,
-5).extent(Wa.pt(Eb,5)),P.bottomLeft().addXY(0,-Eb).extent(Wa.pt(5,Eb))];Ua.forEach(function(cd,ee){return cd.setBounds(Cc[ee])});ya&&(this.adjustOrigin(P.center()),this.opacity=0,this.scale=1.5,this.animate({opacity:1,scale:1,duration:300}));return this}},{key:"retract",value:function(P){var ya=this,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Eb){if(1==Eb.nextAddress)return Eb.yield(ya.animate({scale:Math.max(30/P.width,1.05)}),2);Ua=ya.center;return Eb.yield(ya.animate({center:Ua,
scale:1,duration:300,easing:Wa.easings.inOutExpo}),0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BoundsMarker"}},{key:"highlightMorph",value:function(P){return(new this).alignWithMorph(P)}},{key:"highlightBounds",value:function(P){return(new this).alignWithBounds(P)}}],Ba,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:2261,end:5920})})(Wa.Morph);tc=Da("S",function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Mb=Ba.hasOwnProperty("StatusMessage")&&"function"===typeof Ba.StatusMessage?Ba.StatusMessage:Ba.StatusMessage=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"relayout",value:function(){this.title=Wa.string.truncate(this.message,(this.width/15).toFixed(),
"...")}},{key:"isEpiMorph",value:function(){return!0}},{key:"isStatusMessage",value:function(){return!0}},{key:"setMessage",value:function(P,ya){this.message=P;this.color=ya}},{key:"slideTo",value:function(P){var ya=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return ya.sliding=ya.animate({position:P,duration:500}),Ua.yield(ya.sliding,2);ya.sliding=!1;Ua.jumpToEnd()})}},{key:"expand",value:function(){var P=this,ya,Ua,Eb,Cc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cd){if(1==
cd.nextAddress)return P.expandable?P.sliding?cd.yield(P.sliding,2):cd.jumpTo(2):cd.return();ya=P.world();if(!ya||P.isMaximized)return cd.return();P.isMaximized=!0;P.stayOpen=!0;Ua=P.getSubmorphNamed("message text");Ua.lineWrapping=!1;Object.assign(Ua,{clipMode:"auto",fixedWidth:!0,selectable:!0});P.expandedContent&&(Ua.value=P.expandedContent);Ua.fit();Eb=Ua.textBounds().extent();Cc=ya.visibleBounds();Eb.y>Cc.extent().y&&(Eb.y=Cc.extent().y-20);Eb.x>Cc.extent().x&&(Eb.x=Cc.extent().x-20);Eb=P.extent.maxPt(Eb);
P.animate({extent:Eb,center:Cc.center(),duration:200});P.relayout();P.focus();cd.jumpToEnd()})}},{key:"fit",value:function(){var P=this.getSubmorphNamed("message text");P&&(this.extent=Wa.pt(100,35).maxPt(P.textBounds().extent()),this.relayout())}},{key:"focus",value:function(){var P=this.getSubmorphNamed("message text");P&&P.focus()}},{key:"onMouseUp",value:function(P){this.expand()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessage"}},{key:"properties",get:function(){return{extent:{defaultValue:Wa.pt(200,
100)},stayOpen:{defaultValue:!1},slidable:{defaultValue:!0},isMaximized:{defaultValue:!1},expandable:{initialize:function(){this.expandable=!0}},maxLines:{defaultValue:Infinity},name:{defaultValue:"messageMorph"},master:{initialize:function(){this.master={auto:"styleguide://System/message"}}},message:{after:["submorphs","extent"],set:function(P){this.setProperty("message",P);var ya=this.getSubmorphNamed("message text");if(ya){ya.value=P;var Ua=ya.documentEndPosition;Ua.row>this.maxLines&&(ya.replace({start:{row:this.maxLines,
column:0},end:Ua},"...\n"),this.expandedContent||(this.expandedContent=P));Ua=ya.documentEndPosition;0!==Ua.column&&ya.insertText("\n",Ua)}}},title:{isStyleProp:!0,derived:!0,set:function(P){this.getSubmorphNamed("message title").value=P},get:function(){return this.getSubmorphNamed("message title").value}},color:{after:["submorphs"],derived:!0,get:function(){return this.get("message icon").fontColor},set:function(P){this.get("message icon").fontColor=P;this.get("message icon")._parametrizedProps&&
(this.get("message icon")._parametrizedProps.fontColor=P)}},submorphs:{after:["extent"],initialize:function(){this.submorphs=[{name:"message icon",type:"label",value:Wa.Icon.textAttribute("check-circle")},{name:"message text",type:"text"},{name:"message title",type:"label"},{name:"close button",type:"button"}];Wa.connect(this.getSubmorphNamed("close button"),"fire",this,"remove");Wa.connect(this,"extent",this,"relayout")}}}}}],Ba,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:5964,end:10242})}(Wa.Morph));Wa.StatusMessage=tc;Wa.StatusMessage=tc;Wa.StatusMessage=tc;var fd=Da("b",function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Mb=Ba.hasOwnProperty("StatusMessageForMorph")&&"function"===typeof Ba.StatusMessageForMorph?Ba.StatusMessageForMorph:Ba.StatusMessageForMorph=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"alignAtBottomOf",value:function(P){var ya=this.world();ya&&(this.bringToFront(),this.fit(),this.width=P.bounds().width,this.relayout(),P.world()&&(this.position=P.owner.worldPoint(P.bounds().bottomLeft())),P=ya.visibleBounds(),P=this.bounds().top()+this.height-P.bottom(),0<P&&this.moveBy(Wa.pt(0,-P)))}},{key:"onMouseUp",value:function(P){}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessageForMorph"}},
{key:"properties",get:function(){return{slidable:{defaultValue:!1},renderOnGPU:{defaultValue:!0},removeOnTargetMorphChange:{defaultValue:!0},targetMorph:{defaultValue:null,get:function(){var P=this.getProperty("targetMorph");return P&&$world.getMorphWithId(P)},set:function(P){this.setProperty("targetMorph",P?P.id:null);this.alignAtBottomOf(P)}},expandable:{after:["submorphs"],set:function(P){this.setProperty("expandable",P);if(P){var ya=this.getSubmorphNamed("expand button")||this.addMorph({name:"expand button",
type:"button"});Wa.connect(ya,"fire",this,"expand")}else this.getSubmorphNamed("expand button")&&(this.getSubmorphNamed("expand button").remove(),Wa.disconnect(ya,"fire",this,"expand"))}}}}}],Ba,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10467,end:12318})}(Wa.StatusMessage));Wa.StatusMessageForMorph=
fd;Wa.StatusMessageForMorph=fd;Wa.StatusMessageForMorph=fd;Wa.showConnector=bc;Wa.showConnector=bc;var lb=lively.FreezerRuntime.recorderFor("lively.ide/index.js");lb.info="import via sub modules";lb.info="import via sub modules";lb.info="import via sub modules";var Hd=Da("v",{});lb.valueWidgets=Hd;lb.valueWidgets=Hd;lb.valueWidgets=Hd;var db=Da("p",{});lb.popovers=db;lb.popovers=db;lb.popovers=db;var rb=lively.FreezerRuntime.recorderFor("lively.components/popup.js");rb.Morph=be;rb.VerticalLayout=
Va;rb.StyleSheet=Sd;rb.Icon=ke;rb.CustomLayout=tb;rb.Color=hc;rb.rect=jd;rb.pt=Qb;rb.connect=Lb;rb.Path=gc;rb.duration=300;lb=Da("P",function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.components/popup.js"),Mb=Ba.hasOwnProperty("Popover")&&"function"===typeof Ba.Popover?Ba.Popover:Ba.Popover=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"relayout",value:function(P){var ya=this.get("body"),
Ua=this.get("arrow"),Eb=this.get("close button");Ua=Ua.height;P?(ya.animate({topCenter:rb.pt(0,Ua),duration:200}),Eb.animate({topRight:ya.topRight.addXY(8,-8),duration:200})):(ya.topCenter=rb.pt(0,Ua),Eb.topRight=ya.topRight.addXY(8,-8))}},{key:"close",value:function(){this.fadeOut(300)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Popover"}},{key:"properties",get:function(){return{epiMorph:{defaultValue:!0},hasFixedPosition:{defaultValue:!0},master:{initialize:function(){this.master=
{auto:"styleguide://SystemWidgets/popover/light"}}},targetMorph:{derived:!0,after:["submorphs"],defaultValue:{extent:rb.pt(200,200),fill:rb.Color.transparent,submorphs:[{name:"placeholder",type:"label",value:"No Target Specified"}]},get:function(){return this.get("body").submorphs[0]},set:function(P){var ya=this;this.get("body").addMorph(P);this.whenRendered().then(function(){return ya.relayout()})}},submorphs:{initialize:function(){var P=this;this.submorphs=[{type:"polygon",name:"arrow",topCenter:rb.pt(0,
0),borderColor:rb.Color.transparent,vertices:[rb.pt(-10,0),rb.pt(0,-15),rb.pt(10,0)]},{name:"body"},{name:"close button",type:"button",label:Object.assign(rb.Icon.makeLabel("times-circle"),{fontSize:18}),tooltip:"close",fill:null,extent:rb.pt(16,16),borderColor:rb.Color.transparent}];var ya=$jscomp.makeIterator(this.submorphs);ya.next();var Ua=ya.next().value;ya=ya.next().value;rb.connect(ya,"fire",this,"close");rb.connect(Ua,"extent",this,"relayout",{converter:"() => target.animated"});setTimeout(function(){return P.animated=
!0},1E3)}}}}}],Ba,{pathInPackage:function(){return"popup.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.components",version:"0.1.0"}}},{start:247,end:2617})}(rb.Morph));rb.Popover=lb;rb.Popover=lb;rb.Popover=lb;var vb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js");vb.Morph=be;vb.TilingLayout=Jb;vb.morph=ac;vb.Label=bd;vb.HorizontalLayout=ed;vb.Icon=
ke;vb.InputLine=Ib;vb.config=ib;vb.connect=Lb;vb.signal=Bc;vb.Color=hc;vb.LinearGradient=Ab;vb.pt=Qb;vb.rect=jd;vb.num=Wb;vb.obj=Yb;vb.popovers=db;vb.ValueScrubber=jb;vb.Popover=lb;(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("ContextSensitiveWidget")&&"function"===typeof Ba.ContextSensitiveWidget?Ba.ContextSensitiveWidget:Ba.ContextSensitiveWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return qb(Mb,wa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ContextSensitiveWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:vb.Color.transparent},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?vb.Color.white:vb.Color.black}},layout:{initialize:function(){this.layout=new vb.HorizontalLayout}},context:{serialize:!1}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1872,end:2439})})(vb.Morph);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("ShortcutWidget")&&"function"===typeof Ba.ShortcutWidget?Ba.ShortcutWidget:Ba.ShortcutWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,
wa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(P){P.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShortcutWidget"}},{key:"properties",get:function(){return{title:{defaultValue:"No Title",after:["submorphs"],set:function(P){this.setProperty("title",P);this.getSubmorphNamed("valueString").value=P}},nativeCursor:{defaultValue:"pointer"},fontColor:{derived:!0,
set:function(P){this.submorphs.forEach(function(ya){return ya.fontColor=P})}},submorphs:{initialize:function(){this.submorphs=[vb.Icon.makeLabel("arrow-right",{styleClasses:["TreeLabel"],fontSize:15,padding:vb.rect(1,1,4,1)}),{type:"label",value:this.title,styleClasses:["TreeLabel"],fontWeight:"bold",name:"valueString",opacity:.8,borderRadius:5,padding:vb.rect(0,0,0,2),nativeCursor:"pointer",fontSize:12,borderWidth:0}]}}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:2441,end:3667})})(vb.ContextSensitiveWidget);db=function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("LayoutWidget")&&"function"===typeof Ba.LayoutWidget?Ba.LayoutWidget:Ba.LayoutWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return qb(Mb,wa,[{key:"layoutChanged",value:function(){this.title=this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}},{key:"openPopover",value:function(){var P=this,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return ya=new vb.popovers.LayoutPopover({hasFixedPosition:!!P.ownerChain().find(function(Eb){return Eb.hasFixedPosition}),container:P.context}),Ua.yield(ya.fadeIntoWorld(P.globalBounds().center()),2);vb.connect(ya,"layoutChanged",
P,"layoutChanged");vb.signal(P,"openWidget",ya);Ua.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutWidget"}},{key:"properties",get:function(){return{title:{after:["submorphs"],initialize:function(){this.title=this.context&&this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3676,end:4493})}(vb.ShortcutWidget);vb.LayoutWidget=db;vb.LayoutWidget=db;vb.LayoutWidget=db;lb=function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("ColorWidget")&&"function"===typeof Ba.ColorWidget?Ba.ColorWidget:Ba.ColorWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"relayout",
value:function(P){P?this.submorphs=this.color?this.color.isGradient?this.renderGradientValue():this.renderColorValue():this.renderNoColor():this.color&&(this.color.isGradient?this.updateGradientValue():this.updateColorValue())}},{key:"updateGradientValue",value:function(){var P=this.color;if(2*P.stops.length==this.submorphs.length-3){var ya;for(ya in this.color.stops){var Ua=P.stops[ya];var Eb=Ua.color,Cc=Ua.offset,cd=$jscomp.makeIterator(this.submorphs[2+2*ya].submorphs).next().value;Ua=this.submorphs[3+
2*ya];cd.fill=Eb;Ua.value=(100*Cc).toFixed()+"%"+(ya<P.stops.length-1?",":"")}}else this.submorphs=this.renderGradientValue()}},{key:"renderGradientValue",value:function(){return[{type:"label",styleClasses:["TreeLabel"],value:this.color.type+"(",name:"valueString"}].concat($jscomp.arrayFromIterable(this.renderStops()),[{type:"label",styleClasses:["TreeLabel"],value:")"}])}},{key:"updateColorValue",value:function(){this.getSubmorphNamed("color box").fill=this.color;this.getSubmorphNamed("valueString").value=
vb.obj.safeToString(this.color)}},{key:"renderNoColor",value:function(){return[{extent:vb.pt(15,15),fill:vb.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:vb.pt(5,7.5),fill:vb.Color.white,borderColor:vb.Color.gray.darker(),borderWidth:1,submorphs:[{type:"path",name:"no fill",vertices:[vb.pt(0,0),vb.pt(10,10)],borderColor:vb.Color.red}]}]},{type:"label",value:"No Color",fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderColorValue",value:function(){return[{extent:vb.pt(15,
15),fill:vb.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:vb.pt(5,7.5),fill:this.color,borderColor:vb.Color.gray.darker(),nativeCursor:"pointer",borderWidth:1}]},{type:"label",value:vb.obj.safeToString(this.color),fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderStops",value:function(){var P=this.color,ya=[{type:"label",padding:vb.rect(0,0,5,0),value:"linearGradient"==P.type?vb.num.toDegrees(P.vectorAsAngle()).toFixed()+"\u00b0,":""}],Ua;
for(Ua in P.stops){var Eb=P.stops[Ua],Cc=Eb.color;Eb=Eb.offset;ya.push({extent:vb.pt(this.fontSize,this.fontSize),fill:vb.Color.transparent,layout:new vb.HorizontalLayout({spacing:3}),submorphs:[{styleClasses:["colorValue"],fill:Cc}]});ya.push({type:"label",padding:vb.rect(0,0,5,0),value:(100*Eb).toFixed()+"%"+(Ua<P.stops.length-1?",":"")})}return ya}},{key:"onMouseDown",value:function(P){this.openFillEditor()}},{key:"update",value:function(P){this.color=P}},{key:"openFillEditor",value:function(){var P=
this,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return ya=new vb.popovers.FillPopover({hasFixedPosition:!!P.ownerChain().find(function(Eb){return Eb.hasFixedPosition}),handleMorph:P.context,fillValue:P.color,title:"Fill Control",gradientEnabled:P.gradientEnabled}),Ua.yield(ya.fadeIntoWorld(P.globalBounds().center()),2);vb.connect(ya,"fillValue",P,"update");vb.signal(P,"openWidget",ya);Ua.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColorWidget"}},
{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new vb.HorizontalLayout({direction:"centered"})}},selectionFontColor:{defaultValue:vb.Color.white},nonSelectionFontColor:{defaultValue:vb.Color.black},color:{defaultValue:vb.Color.blue},gradientEnabled:{defaultValue:!1},fontSize:{defaultValue:14},isSelected:{after:["submorphs"],set:function(P){this.getProperty("isSelected")!=P&&(this.getSubmorphNamed("valueString").fontColor=P?this.selectionFontColor:this.nonSelectionFontColor,
this.setProperty("isSelected",P))}},submorphs:{after:["nonSelectionFontColor","selectionFontColor"],initialize:function(){vb.connect(this,"color",this,"relayout",{converter:function(P,ya){return(ya&&ya.isColor)!=(P&&P.isColor)}});this.relayout(!0)}}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:4557,end:9992})}(vb.ContextSensitiveWidget);vb.ColorWidget=lb;vb.ColorWidget=lb;vb.ColorWidget=lb;var vd=function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("BooleanWidget")&&"function"===typeof Ba.BooleanWidget?Ba.BooleanWidget:Ba.BooleanWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"onMouseDown",value:function(P){this.boolean=
!this.boolean}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BooleanWidget"}},{key:"properties",get:function(){return{fontFamily:{defaultValue:vb.config.codeEditor.defaultStyle.fontFamily},nativeCursor:{defaultValue:"pointer"},boolean:{set:function(P){this.setProperty("boolean",P);this.value=vb.obj.safeToString(P);this.fontColor=this.boolean?vb.Color.green:vb.Color.red}}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10001,end:10481})}(vb.Label);vb.BooleanWidget=vd;vb.BooleanWidget=vd;vb.BooleanWidget=vd;var me=Da("N",function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("NumberWidget")&&"function"===typeof Ba.NumberWidget?Ba.NumberWidget:Ba.NumberWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return qb(Mb,wa,[{key:"onMouseDown",value:function(P){qb._get(Object.getPrototypeOf(Mb.prototype),"onMouseDown",this).call(this,P);"up"==P.targetMorph.name&&this.increment();"down"==P.targetMorph.name&&this.decrement()}},{key:"spec",value:function(){return vb.obj.dissoc(qb._get(Object.getPrototypeOf(Mb.prototype),"spec",this).call(this),["submorphs"])}},{key:"update",value:function(P,ya){ya=void 0===ya?!0:ya;this.setProperty("number",ya?P/this.scaleFactor:P);vb.signal(this,"number",this.number);
this.relayout(ya)}},{key:"relayoutButtons",value:function(){var P=this.getSubmorphNamed("up"),ya=this.getSubmorphNamed("down");this.getSubmorphNamed("value");P.height=ya.height=(this.height-2)/2;P.width=ya.width=20}},{key:"onChange",value:function(P){qb._get(Object.getPrototypeOf(Mb.prototype),"onChange",this).call(this,P);"extent"!=P.prop||this.autofit||this.relayout()}},{key:"relayout",value:function(P){var ya=this.getSubmorphNamed("value");ya&&(this.autofit?(P||(ya.value=this.number*this.scaleFactor),
ya.fit(),this.height=ya.height,this.width=ya.width+20):P||(ya.width=this.width-20),this.relayoutButtons(),P||(ya.value=vb.num.roundTo(this.number*this.scaleFactor,1),ya.min=-Infinity!=this.min?this.min*this.scaleFactor:this.min,ya.max=Infinity!=this.max?this.max*this.scaleFactor:this.max,ya.unit=this.unit))}},{key:"increment",value:function(){void 0!=this.max&&this.number>=this.max||this.update(this.number+1/this.scaleFactor,!1)}},{key:"decrement",value:function(){void 0!=this.min&&this.number<=this.min||
this.update(this.number-1/this.scaleFactor,!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberWidget"}},{key:"properties",get:function(){return{unit:{type:"Enum",isStyleProp:!0,values:["px","%","pt",""]},autofit:{defaultValue:!0,after:["submorphs","extent"],set:function(P){this.setProperty("autofit",P);this.getSubmorphNamed("value").scaleToBounds=!P}},number:{defaultValue:0,after:["unit","autofit"],set:function(P){this.setProperty("number",P);this.relayout(!1)}},min:{defaultValue:-Infinity},
max:{defaultValue:Infinity},floatingPoint:{after:["number","submorphs"],set:function(P){this.setProperty("floatingPoint",P);this.get("value").floatingPoint=P},get:function(){var P=/[+-]?([0-9]*[.])?[0-9]+/.exec(this.number);return this.getProperty("floatingPoint")||1==this.scaleFactor&&P&&!!P[1]}},padding:{isStyleProp:!0,defaultValue:vb.rect(5,3,0,0),after:["submorphs"],set:function(P){this.setProperty("padding",P);this.getSubmorphNamed("value").padding=P}},extent:{defaultValue:vb.pt(70,25)},scaleFactor:{defaultValue:1,
get:function(){return this.getProperty("scaleFactor")||1}},baseFactor:{after:["submorphs"],derived:!0,get:function(){return this.get("value").baseFactor},set:function(P){this.get("value").baseFactor=P}},styleClasses:{defaultValue:["unfocused"]},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/number field/light"}}},fontColor:{isStyleProp:!0,defaultValue:vb.Color.rgbHex("#0086b3"),set:function(P){this.setProperty("fontColor",P)}},isSelected:{set:function(P){this.getProperty("isSelected")!=
P&&(P?(this.addStyleClass("selected"),this.removeStyleClass("unselected")):(this.removeStyleClass("selected"),this.addStyleClass("unselected")),this.setProperty("isSelected",P))}},fontFamily:{defaultValue:"Sans-Serif",isStyleProp:!0,set:function(P){this.setProperty("fontFamily",P)}},fontSize:{defaultValue:15,isStyleProp:!0,set:function(P){this.setProperty("fontSize",P)}},layout:{initialize:function(){this.layout=new vb.TilingLayout({axis:"column",orderByIndex:!0,align:"center"})}},submorphs:{after:["min",
"max"],initialize:function(){var P=this;this.submorphs=[new vb.ValueScrubber({name:"value",unit:this.unit,floatingPoint:this.floatingPoint,scaleToBounds:!1,min:this.min,max:this.max}),vb.Icon.makeLabel("sort-up",{name:"up"}),vb.Icon.makeLabel("sort-up",{name:"down",rotation:Math.PI})];vb.connect(this.get("value"),"scrub",this,"update");this.whenRendered().then(function(){return P.relayout()})}}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10490,end:16426})}(vb.Morph));vb.NumberWidget=me;vb.NumberWidget=me;vb.NumberWidget=me;var ye=function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("ShadowWidget")&&"function"===typeof Ba.ShadowWidget?Ba.ShadowWidget:Ba.ShadowWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return qb(Mb,wa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return ya=new vb.popovers.ShadowPopover({hasFixedPosition:!!P.ownerChain().find(function(Eb){return Eb.hasFixedPosition}),shadowValue:P.shadowValue}),Ua.yield(ya.fadeIntoWorld(P.globalBounds().center()),2);vb.connect(ya,"shadowValue",P,"shadowValue");vb.connect(P,"shadowValue",P,
"update");vb.signal(P,"openWidget",ya);Ua.jumpToEnd()})}},{key:"update",value:function(){this.renderShadowDisplay()}},{key:"renderShadowDisplay",value:function(){this.shadowValue?1<this.submorphs.length?this.updateShadowDisplay():this.initShadowDisplay():this.submorphs=[{opacity:.8,reactsToPointer:!1,styleClasses:["TreeLabel"],name:"valueString",type:"label",value:"No Shadow"}]}},{key:"updateShadowDisplay",value:function(){var P=this.shadowValue,ya=P.blur,Ua=P.spread,Eb=P.distance;P=P.color;var Cc=
$jscomp.makeIterator(this.submorphs),cd=Cc.next().value,ee=Cc.next().value;ee=$jscomp.makeIterator(ee.submorphs).next().value;Cc=Cc.next().value;cd.value=(this.shadowValue.inset?"inset":"drop")+"-shadow(";ee.fill=P;Cc.value=", "+ya+"px, "+Eb+"px, "+Ua+"px)"}},{key:"initShadowDisplay",value:function(){var P=this.shadowValue,ya=P.blur,Ua=P.spread,Eb=P.distance;P=P.color;this.submorphs=[{name:"valueString",opacity:.7,reactsToPointer:!1,type:"label",value:(this.shadowValue.inset?"inset":"drop")+"-shadow("},
vb.morph({fill:vb.Color.transparent,extent:vb.pt(this.fontSize+6,this.fontSize+4),submorphs:[{extent:vb.pt(this.fontSize,this.fontSize),position:vb.pt(2,2),fill:P,borderColor:vb.Color.black,borderWidth:1}]}),{name:"valueString",type:"label",opacity:.7,reactsToPointer:!1,value:", "+ya+"px, "+Eb+"px, "+Ua+"px)"}]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShadowWidget"}},{key:"properties",get:function(){return{shadowValue:{after:["submorphs"],defaultValue:null,set:function(P){this.setProperty("shadowValue",
P);this.renderShadowDisplay()}},fill:{defaultValue:vb.Color.transparent},nativeCursor:{defaultValue:"pointer"},fontSize:{defaultValue:12},fontColor:{derived:!0,set:function(P){this.submorphs.forEach(function(ya){return ya.fontColor=P})}},isSelected:{defaultValue:!1,set:function(P){this.setProperty("isSelected",P);this.fontColor=P?vb.Color.white:vb.Color.black}},layout:{initialize:function(){this.layout=new vb.HorizontalLayout}},submorphs:{initialize:function(){this.update()}}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:16435,end:19445})}(vb.Morph);vb.ShadowWidget=ye;vb.ShadowWidget=ye;vb.ShadowWidget=ye;var Pe=function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("PointWidget")&&"function"===typeof Ba.PointWidget?Ba.PointWidget:Ba.PointWidget=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return ya=new vb.popovers.PointPopover({pointValue:P.pointValue,hasFixedPosition:!!P.ownerChain().find(function(Eb){return Eb.hasFixedPosition})}),Ua.yield(ya.fadeIntoWorld(P.globalBounds().center()),
2);vb.connect(ya,"pointValue",P,"pointValue");vb.signal(P,"openWidget",ya);Ua.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PointWidget"}},{key:"properties",get:function(){return{isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?this.selectionFontColor:this.nonSelectionFontColor}},selectionFontColor:{isStyleProp:!0,defaultValue:vb.Color.white},nonSelectionFontColor:{isStyleProp:!0,defaultValue:vb.Color.black},fontFamily:{defaultValue:vb.config.codeEditor.defaultStyle.fontFamily},
nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},pointValue:{after:["textAndAttributes"],set:function(P){var ya=vb.Color.rgbHex("#0086b3");this.setProperty("pointValue",P);this.textAndAttributes=["pt(",null,P.x.toFixed(),{fontColor:ya},",",{},P.y.toFixed(),{fontColor:ya},")",null];this.fixedHeight=this.fixedWidth=!0;this.height=20;this.width=this.textString.length*this.fontSize}}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:19454,end:21082})}(vb.Label);vb.PointWidget=Pe;vb.PointWidget=Pe;vb.PointWidget=Pe;var Tc=function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("PaddingWidget")&&"function"===typeof Ba.PaddingWidget?Ba.PaddingWidget:Ba.PaddingWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return qb(Mb,wa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return ya=new vb.popovers.RectanglePopover({hasFixedPosition:!!P.ownerChain().find(function(Eb){return Eb.hasFixedPosition}),rectangle:P.rectangle}),ya.relayout(),Ua.yield(ya.fadeIntoWorld(P.globalBounds().center()),2);vb.connect(ya,"rectangle",P,"rectangle");vb.signal(P,"openWidget",
ya);Ua.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PaddingWidget"}},{key:"properties",get:function(){return{nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},fontFamily:{defaultValue:vb.config.codeEditor.defaultStyle.fontFamily},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?vb.Color.white:vb.Color.black}},rectangle:{defaultValue:vb.rect(0),set:function(P){this.setProperty("rectangle",
P);this.value=vb.obj.safeToString(P)}}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:21091,end:22140})}(vb.Label);vb.PaddingWidget=Tc;vb.PaddingWidget=Tc;vb.PaddingWidget=Tc;var re=function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("IconWidget")&&
"function"===typeof Ba.IconWidget?Ba.IconWidget:Ba.IconWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return ya=new vb.popovers.IconPopover({hasFixedPosition:!!P.ownerChain().find(function(Eb){return Eb.hasFixedPosition})}),
Ua.yield(ya.fadeIntoWorld(P.globalBounds().center()),2);vb.connect(ya,"select",P,"iconValue",{converter:function(Eb){return Eb&&vb.Icon.makeLabel(Eb).value},varMapping:{Icon:ke}});vb.signal(P,"openWidget",ya);Ua.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"IconWidget"}},{key:"properties",get:function(){return{fontColor:{defaultValue:vb.Color.gray.darker()},fontFamily:{defaultValue:"FontAwesome"},nativeCursor:{defaultValue:"pointer"},iconValue:{derived:!0,get:function(){return this.value},
set:function(P){this.value=P||"No Icon"}}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22149,end:23045})}(vb.Label);vb.IconWidget=re;vb.IconWidget=re;vb.IconWidget=re;var Ed=function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Mb=Ba.hasOwnProperty("StringWidget")&&
"function"===typeof Ba.StringWidget?Ba.StringWidget:Ba.StringWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"truncate",value:function(P){return 200<P.length?P.slice(0,20)+"...":P}},{key:"onFocus",value:function(P){var ya=this,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Eb){if(1==Eb.nextAddress)return qb._get(Object.getPrototypeOf(Mb.prototype),"onFocus",ya).call(ya,P),ya.readOnly?
Eb.return():ya.stringTooLong?Eb.yield(ya.world().editPrompt("edit string",{requester:ya,input:ya.stringValue}),2):(ya.borderColor=vb.Color.white.withA(.9),ya.textString=ya.stringValue,Eb.return());Ua=Eb.yieldResult;if("string"===typeof Ua)ya.onInput(Ua);Eb.jumpToEnd()})}},{key:"onBlur",value:function(P){qb._get(Object.getPrototypeOf(Mb.prototype),"onBlur",this).call(this,P);this.readOnly||(this.borderColor=vb.Color.transparent,this.onInput(this.textString))}},{key:"onInput",value:function(P){this.owner.focus();
vb.signal(this,"inputAccepted",P);this.stringValue=P}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:vb.Color.transparent},fontColor:{defaultValue:vb.Color.blue},nativeCursor:{defaultValue:"auto"},borderColor:{defaultValue:vb.Color.transparent},borderStyle:{defaultValue:"dashed"},borderRadius:{defaultValue:4},borderWidth:{defaultValue:1},padding:{defaultValue:vb.rect(0,0,0,0)},fixedWidth:{defaultValue:!1},
fixedHeight:{defaultValue:!1},stringValue:{after:["textString"],set:function(P){this.setProperty("stringValue",P);this.textString=this.truncate(P);this.nativeCursor=this.stringTooLong?"pointer":"auto"}},stringTooLong:{readOnly:!0,get:function(){return this.stringValue.includes("\n")}},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?vb.Color.white:vb.Color.blue}}}}}],Ba,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23054,end:24974})}(vb.InputLine);vb.StringWidget=Ed;vb.StringWidget=Ed;vb.StringWidget=Ed;vb.valueWidgets=Hd;Object.assign(vb.valueWidgets,{NumberWidget:me,StringWidget:Ed,IconWidget:re,PaddingWidget:Tc,ShadowWidget:ye,PointWidget:Pe,BooleanWidget:vd,LayoutWidget:db,ColorWidget:lb});var Nb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js");Nb.Ellipse=
Fb;Nb.Icon=ke;Nb.Morph=be;Nb.Path=Mc;Nb.Text=pd;Nb.HorizontalLayout=ed;Nb.VerticalLayout=Va;Nb.morph=ac;Nb.Color=hc;Nb.pt=Qb;Nb.rect=jd;Nb.Rectangle=cb;Nb.arr=oc;Nb.connect=Lb;Nb.disconnect=Sc;Nb.LabeledCheckBox=rc;Nb.DropDownSelector=Ic;Nb.Button=ec;Nb.Menu=Pc;Nb.NumberWidget=me;Nb.InteractiveMorphSelector=$c;Nb.easings=Hc;(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ba.hasOwnProperty("AxisHalo")&&"function"===typeof Ba.AxisHalo?Ba.AxisHalo:Ba.AxisHalo=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var ya=P.halo;P=P.targetAxis;qb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{fill:Nb.Color.transparent,halo:ya,targetAxis:P,container:ya.container});this.initialize()}},{key:"initialize",value:function(){this.setBounds(this.fetchBounds());this.minSlider=
this.minSlider();this.axisMenu=this.axisMenu();this.proportionSlider=this.proportionSlider();this.proportionSlider.addMorph(this.minSlider);this.submorphs=[this.proportionSlider,this.axisMenu];this.halo.addGuide(this)}},{key:"forceMenuHidden",set:function(P){this._forceMenuHidden=P;this.axisMenu.visible=!P}},{key:"forceMenuHidden",get:function(){return this._forceMenuHidden}},{key:"lastAxis",get:function(){return!this.targetAxis.after}},{key:"fetchBounds",value:function(){return this.fetchPosition().extent(this.fetchExtent())}},
{key:"alignWithTarget",value:function(){this.extent=this.fetchExtent();this.position=this.fetchPosition();this.proportionSlider.alignWithTarget();this.axisMenu.alignWithTarget()}},{key:"onHoverIn",value:function(){this.minSlider.requestToShow();this.axisMenu.visible=!this.forceMenuHidden&&!0}},{key:"onHoverOut",value:function(P){this.minSlider.requestToHide();this.axisMenu.visible=this.forceMenuVisible||!1}},{key:"proportionSlider",value:function(){var P=this,ya=this,Ua=this.proportionViewer();return this.halo.addGuide(new Nb.Morph({nativeCursor:this.getResizeCursor(),
fill:Nb.Color.transparent,submorphs:[this.devider(),Ua],alignWithTarget:function(){this.setBounds(ya.getProportionSliderBounds(this))},onDragStart:function(){Ua.visible=!0},onDrag:function(Eb){P.adjustStretch(P.getDelta(Eb));P.halo.alignWithTarget()},onDragEnd:function(){Ua.visible=!1}}))}},{key:"devider",value:function(){return new Nb.Morph({visible:!this.lastAxis,fill:Nb.Color.black.withA(.5),bounds:this.getDeviderBounds(),draggable:!1,reactsToPointer:!1})}},{key:"minSlider",value:function(){var P=
this,ya=this,Ua=this.minSpaceVisualizer(),Eb=this.minViewer();return this.halo.addGuide(new Nb.Ellipse({nativeCursor:this.getResizeCursor(),fill:Nb.Color.green,extent:Nb.pt(10,10),visible:!1,submorphs:[Ua,Eb],becomesActiveOnHover:!0,alignWithTarget:function(){this.position=ya.getMinSliderPosition()},requestToShow:function(){this.visible=!ya.targetAxis.fixed},requestToHide:function(){this.active?this.shouldHide=!0:this.visible=!1},onDragStart:function(){ya.forceMenuHidden=!0;Eb.visible=!0;this.active=
Ua.visible=!0},onDrag:function(Cc){P.targetAxis.min+=-P.getDelta(Cc);P.halo.alignWithTarget()},onDragEnd:function(){ya.forceMenuHidden=!1;Eb.visible=!1;this.active=Ua.visible=!1;this.shouldHide&&(this.shouldHide=this.visible=!1)}}))}},{key:"minViewer",value:function(){var P=this;return this.viewer({position:this.getMinViewerPosition(),alignWithTarget:function(){this.textString="min: "+P.targetAxis.min.toFixed()+"px !"}})}},{key:"minSpaceBorder",value:function(){return new Nb.Path(Object.assign({position:Nb.pt(-1,
-1),borderStyle:"dashed",borderColor:Nb.Color.green,borderWidth:2},this.getMinSpaceBorder()))}},{key:"minSpaceVisualizer",value:function(){var P=this,ya=this.minSpaceBorder();return this.halo.addGuide(new Nb.Morph({fill:Nb.Color.green.withA(.1),visible:!1,isHaloItem:!0,submorphs:[ya],alignWithTarget:function(){this.extent=P.getMinSpaceExtent();this.topLeft=Nb.pt(5,5)}}))}},{key:"axisMenu",value:function(){var P=this.lockButton(),ya=this.menuButton(),Ua=this;return new Nb.Morph({layout:this.getMenuLayout(),
submorphs:[P,ya],fill:Nb.Color.transparent,visible:!1,becomesActiveOnHover:!0,alignWithTarget:function(){this.bottomRight=this.owner.extent.subPt(Ua.getMenuOffset(this))}})}},{key:"lockButton",value:function(){var P=this;return this.halo.addGuide(new Nb.Morph({fill:Nb.Color.transparent,extent:Nb.pt(25,25),submorphs:[{center:Nb.pt(12.5,12.5),fill:Nb.Color.transparent,styleClasses:["fa","fa-unlock"]}],alignWithTarget:function(){P.targetAxis.fixed?(this.fontColor=Nb.Color.red,this.submorphs[0].styleClasses=
["fa","fa-lock"]):(this.fontColor=Nb.Color.green,this.submorphs[0].styleClasses=["fa","fa-unlock"])},onMouseDown:function(){this.toggleLock()},toggleLock:function(){P.targetAxis.fixed=!P.targetAxis.fixed;P.halo.alignWithTarget()}}))}},{key:"menuButton",value:function(){var P=this,ya=this;return new Nb.Morph({fill:Nb.Color.transparent,extent:Nb.pt(25,25),submorphs:[{fill:Nb.Color.transparent,styleClasses:["fa","fa-cog"],center:Nb.pt(12.5,12.5)}],onMouseDown:function(Ua){ya.forceMenuVisible=!0;this.addMorph(Ua.state.menu=
new Nb.Menu({position:Nb.pt(15,15),items:[["Remove "+ya.subject,function(){P.targetAxis.remove();P.halo.initGuides();P.halo.alignWithTarget()}],["Insert "+ya.subject+" before",function(){P.targetAxis.addBefore();P.halo.initGuides();P.halo.alignWithTarget()}],["Insert "+ya.subject+" after",function(){P.targetAxis.addAfter();P.halo.initGuides();P.halo.alignWithTarget()}]]}))}})}},{key:"viewer",value:function(P){var ya=P.position;P=P.alignWithTarget;return this.halo.addGuide(new Nb.Text({styleClasses:["Halo"],
padding:Nb.Rectangle.inset(6),visible:!1,borderRadius:10,fontColor:Nb.Color.white,fill:Nb.Color.black.withA(.5),position:ya,alignWithTarget:P,readOnly:!0}))}},{key:"proportionViewer",value:function(){var P=this;return this.viewer({position:this.getProportionViewerPosition(),alignWithTarget:function(){this.textString=P.targetAxis.length.toFixed(1)+"px"}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"AxisHalo"}}],Ba,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:660,end:7979})})(Nb.Morph);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ba.hasOwnProperty("RowHalo")&&"function"===typeof Ba.RowHalo?Ba.RowHalo:Ba.RowHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:Symbol.for("lively-instance-initialize"),
value:function(P){var ya=P.row;P=P.halo;qb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:P.target.row(ya),halo:P})}},{key:"subject",get:function(){return"row"}},{key:"adjustStretch",value:function(P){this.targetAxis.height+=P}},{key:"getDelta",value:function(P){return P.state.dragDelta.y}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.y}},{key:"fetchPosition",value:function(){return Nb.pt(-45,this.axisOffset()+
10)}},{key:"fetchExtent",value:function(){return Nb.pt(40,this.targetAxis.length-10)}},{key:"getMenuOffset",value:function(P){return this.targetAxis.length>P.height?Nb.pt(2,5):Nb.pt(26,10)}},{key:"getMenuLayout",value:function(){return new Nb.VerticalLayout}},{key:"getResizeCursor",value:function(){return"row-resize"}},{key:"getMinViewerPosition",value:function(){return Nb.pt(50,20)}},{key:"getMinSliderPosition",value:function(){return Nb.pt(0,-this.targetAxis.min)}},{key:"getMinSpaceExtent",value:function(){return Nb.pt(this.container.width+
45,this.targetAxis.min)}},{key:"getMinSpaceBorder",value:function(){return{extent:Nb.pt(this.container.width+50,2),vertices:[Nb.pt(0,1),Nb.pt(this.container.width+50,1)]}}},{key:"getProportionViewerPosition",value:function(){return Nb.pt(40,20)}},{key:"getProportionSliderBounds",value:function(P){return Nb.pt(0,P.owner.height-5).extent(Nb.pt(40,10))}},{key:"getDeviderBounds",value:function(){return Nb.pt(15,4).extent(Nb.pt(25,2))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RowHalo"}}],
Ba,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:7981,end:9208})})(Nb.AxisHalo);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ba.hasOwnProperty("ColumnHalo")&&"function"===typeof Ba.ColumnHalo?Ba.ColumnHalo:Ba.ColumnHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var ya=P.col;P=P.halo;qb._get(Object.getPrototypeOf(Mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:P.target.col(ya),halo:P})}},{key:"subject",get:function(){return"column"}},{key:"adjustStretch",value:function(P){this.targetAxis.width+=P}},{key:"getDelta",value:function(P){return P.state.dragDelta.x}},{key:"axisOffset",
value:function(){return this.targetAxis.origin.position.x}},{key:"fetchPosition",value:function(){return Nb.pt(this.axisOffset()+10,-45)}},{key:"fetchExtent",value:function(){return Nb.pt(this.targetAxis.length-10,40)}},{key:"getMenuOffset",value:function(P){return this.targetAxis.length>P.width?Nb.pt(5,3):Nb.pt(8,26)}},{key:"getMenuLayout",value:function(){return new Nb.HorizontalLayout}},{key:"getResizeCursor",value:function(){return"col-resize"}},{key:"getMinViewerPosition",value:function(){return Nb.pt(20,
50)}},{key:"getMinSliderPosition",value:function(){return Nb.pt(-this.targetAxis.min,0)}},{key:"getMinSpaceExtent",value:function(){return Nb.pt(this.targetAxis.min,this.container.height+45)}},{key:"getMinSpaceBorder",value:function(){return{extent:Nb.pt(2,this.container.height+50),vertices:[Nb.pt(1,0),Nb.pt(1,this.container.height+50)]}}},{key:"getProportionViewerPosition",value:function(){return Nb.pt(20,40)}},{key:"getProportionSliderBounds",value:function(P){return Nb.pt(P.owner.width-5,0).extent(Nb.pt(10,
40))}},{key:"getDeviderBounds",value:function(){return Nb.pt(4,15).extent(Nb.pt(2,25))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColumnHalo"}}],Ba,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:9210,end:10442})})(Nb.AxisHalo);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
Mb=Ba.hasOwnProperty("CellGuide")&&"function"===typeof Ba.CellGuide?Ba.CellGuide:Ba.CellGuide=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"menuItems",value:function(){var P=this,ya=Nb.Icon.textAttribute("check-square-o"),Ua=Nb.Icon.textAttribute("square-o");ya[1].textStyleClasses.push("annotation");Ua[1].textStyleClasses.push("annotation");Ua[1].paddingRight="2px";return[["Resize Policy",[[["Rigid  ",
null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?Ua:ya)),function(){P.cellGroup.resize=!1}],[["Space Filling  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?ya:Ua)),function(){P.cellGroup.resize=!0}]]],["Align at...",["center"].concat($jscomp.arrayFromIterable((new Nb.Rectangle).sides),$jscomp.arrayFromIterable((new Nb.Rectangle).corners)).map(function(Eb){return[[Eb,{paddingRight:"2px"}].concat($jscomp.arrayFromIterable(P.cellGroup.align==Eb?ya:Ua),["  ",null]),function(){return P.cellGroup.align=
Eb}]})]].concat(this.cellGroup.morph?[["Release Morph from Cell",function(){var Eb=P.cellGroup.morph;Eb&&(P.world().firstHand.grab(Eb),P.world().firstHand.longClickGrab=!0,Eb.position=Nb.pt(0))}]]:[])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CellGuide"}},{key:"properties",get:function(){return{cellGroup:{}}}}],Ba,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10444,end:11722})})(Nb.Morph);(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ba.hasOwnProperty("LayoutHalo")&&"function"===typeof Ba.LayoutHalo?Ba.LayoutHalo:Ba.LayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutHalo"}},
{key:"properties",get:function(){return{container:{},target:{},pointerId:{},halosEnabled:{defaultValue:!1},isEpiMorph:{defaultValue:!0},isHaloItem:{defaultValue:!0},borderColor:{defaultValue:Nb.Color.orange},borderWidth:{defaultValue:2},styleClasses:{defaultValue:["Halo"]}}}}],Ba,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:11724,end:12137})})(Nb.Morph);Hd=Da("G",function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ba.hasOwnProperty("GridLayoutHalo")&&"function"===typeof Ba.GridLayoutHalo?Ba.GridLayoutHalo:Ba.GridLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"previewDrop",value:function(P){1>P.length||(P=this.cellGuides.find(function(ya){return ya.fullContainsWorldPoint($world.firstHand.position)}),
P!=this.currentCell&&this.currentCell&&this.currentCell.stopPreview(),(this.currentCell=P)&&this.currentCell.startPreview())}},{key:"handleDrop",value:function(P){var ya=this;this.currentCell&&P.whenRendered().then(function(){return ya.currentCell.cellGroup.morph=P})}},{key:"initialize",value:function(){this.initGuides();this.alignWithTarget();this.focus()}},{key:"optionControls",value:function(){var P=this.target,ya=new Nb.LabeledCheckBox({name:"compensateOrigin",label:"Compensate Origin",fill:Nb.Color.transparent,
checked:P.compensateOrigin}),Ua=new Nb.LabeledCheckBox({label:"Resize Submorphs",fill:Nb.Color.transparent,name:"fitToCell",checked:P.fitToCell});Nb.connect(ya,"checked",P,"compensateOrigin");Nb.connect(Ua,"checked",P,"fitToCell");Nb.connect(ya,"checked",this,"alignWithTarget");return[ya,Ua]}},{key:"isLayoutHalo",get:function(){return!1}},{key:"alignWithTarget",value:function(){this.target.apply();this.position=this.container.globalPosition;this.target.compensateOrigin&&this.moveBy(this.container.origin.negated());
this.extent=this.container.extent;this.addMissingGuides();Nb.arr.reverse(this.guides).forEach(function(P){return P.alignWithTarget()})}},{key:"addMissingGuides",value:function(){var P=this;Nb.arr.withoutAll(this.target.cellGroups,this.guides.map(function(ya){return ya.cellGroup})).forEach(function(ya){return P.addMorph(P.cellGuide(ya))})}},{key:"initGuides",value:function(){this.submorphs=[];this.guides=[];this.initCellGuides();this.initColumnGuides();this.initRowGuides()}},{key:"initCellGuides",
value:function(){var P=this,ya=this.addMorph({fill:Nb.Color.transparent,borderRadius:this.borderRadius,extent:this.extent});this.target.cellGroups.forEach(function(Ua){ya.addMorph(P.cellGuide(Ua))});this.cellGuides=ya.submorphs;this.addMorph(this.resizer())}},{key:"addGuide",value:function(P){P.isHaloItem=!0;this.guides.push(P);return P}},{key:"initRowGuides",value:function(){var P=this,ya=this;this.addGuide(this.addMorph(new Nb.Morph({width:25,fill:Nb.Color.gray.withA(.7),borderRadius:15,height:this.container.height,
topRight:Nb.pt(-5,0),alignWithTarget:function(){this.height=ya.container.height}})));Nb.arr.range(0,this.target.rowCount-1).forEach(function(Ua){P.addMorph(new Nb.RowHalo({row:Ua,halo:P}))})}},{key:"initColumnGuides",value:function(){var P=this,ya=this;this.addGuide(this.addMorph(new Nb.Morph({height:25,fill:Nb.Color.gray.withA(.7),borderRadius:15,width:this.container.width,bottomLeft:Nb.pt(0,-5),alignWithTarget:function(){this.width=ya.container.width}})));Nb.arr.range(0,this.target.columnCount-
1).forEach(function(Ua){P.addMorph(new Nb.ColumnHalo({col:Ua,halo:P}))})}},{key:"resizer",value:function(){var P=this;return this.addGuide(new Nb.Morph({fill:Nb.Color.transparent,extent:Nb.pt(25,25),nativeCursor:"nwse-resize",onDrag:function(ya){P.container.resizeBy(ya.state.dragDelta);P.alignWithTarget()},alignWithTarget:function(){this.bottomRight=P.extent}}))}},{key:"cellResizer",value:function(P,ya){var Ua=this,Eb="topLeft"==ya?"bottomRight":"topLeft";return new Nb.Ellipse({borderWidth:1,visible:!1,
borderColor:Nb.Color.black,nativeCursor:"nwse-resize",removeCell:function(Cc){P.disconnect(Cc);Ua.alignWithTarget()},addCell:function(Cc){P.connect(Cc);Ua.alignWithTarget()},start:function(){this.fixpointCell=P[Eb];this.draggedDelta=P.bounds().partNamed(ya);this.debugMorph=Ua.addMorph(new Nb.Morph({fill:Nb.Color.orange.withA(.5)}))},update:function(Cc){var cd=this;this.draggedDelta=this.draggedDelta.addPt(Cc);var ee=Nb.Rectangle.unionPts([this.draggedDelta]).union(this.fixpointCell.bounds());this.debugMorph.setBounds(ee);
Ua.cells.forEach(function(Vd){var Ze=ee.intersection(Vd.bounds()).area()/Vd.bounds().area();P.includes(Vd)&&.1>Ze&&cd.removeCell(Vd);!P.includes(Vd)&&Ze>1/3&&cd.addCell(Vd)})},onDragEnd:function(Cc){this.debugMorph.remove()},onDragStart:function(Cc){this.start(Cc.position)},onDrag:function(Cc){this.update(Cc.state.dragDelta)}})}},{key:"cellGuide",value:function(P){var ya=this,Ua=this.cellResizer(P,"topLeft"),Eb=this.cellResizer(P,"bottomRight");return this.addGuide(new Nb.CellGuide({cellGroup:P,bounds:P.bounds(),
fill:Nb.Color.transparent,borderColor:Nb.Color.orange,borderWidth:1,isHaloItem:!0,isCell:!0,draggable:!1,submorphs:[Ua,Eb],onMouseDown:function(Cc){this.becomeActive()},deactivate:function(){this.borderColor=Nb.Color.orange;this.fill=Nb.Color.transparent;this.submorphs.forEach(function(Cc){Cc.visible=!1})},becomeActive:function(){ya.guides.forEach(function(Cc){Cc.isCell&&Cc.deactivate()});this.borderColor=Nb.Color.rgbHex("#1565C0");this.fill=Nb.Color.rgbHex("#1565C0").withA(.3);ya.addMorph(this.remove());
this.submorphs.forEach(function(Cc){Cc.visible=!0})},startPreview:function(Cc){this.fill=Nb.Color.orange.withA(.7)},stopPreview:function(Cc){this.fill=Nb.Color.transparent},onDrop:function(Cc){var cd=$jscomp.makeIterator(Cc.hand.grabbedMorphs).next().value;Cc.hand.dropMorphsOn(ya.container);P.morph=cd},alignWithTarget:function(){P.bounds().isNonEmpty()?(this.setBounds(P.bounds()),Ua.center=this.innerBounds().topLeft(),Eb.center=this.innerBounds().bottomRight()):(Nb.arr.remove(ya.guides,this),this.remove())}}))}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GridLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:Nb.Color.transparent},cells:{derived:!0,get:function(){return Nb.arr.flatten(this.target.col(0).items.map(function(P){return P.row(0).items}))}},submorphs:{initialize:function(){this.initialize()}}}}}],Ba,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:12146,end:19501})}(Nb.LayoutHalo));Nb.GridLayoutHalo=Hd;Nb.GridLayoutHalo=Hd;Nb.GridLayoutHalo=Hd;db=function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ba.hasOwnProperty("TilingLayoutHalo")&&"function"===typeof Ba.TilingLayoutHalo?Ba.TilingLayoutHalo:Ba.TilingLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return qb(Mb,wa,[{key:"remove",value:function(){qb._get(Object.getPrototypeOf(Mb.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"handleDrop",value:function(P){}},{key:"removePreviews",value:function(){this.previews.forEach(function(P){return P.clear()})}},{key:"previewDrop",value:function(P){var ya=this;0<this.previews.length||(this.previews=P.map(function(Ua){return ya.container.addMorph({type:Nb.DropPreview,
bounds:Ua.bounds()})}),this.previews.forEach(function(Ua){Ua.step()}))}},{key:"updateSpacing",value:function(P){this.target.spacing=P}},{key:"updateAxis",value:function(P){this.target.axis=P}},{key:"updateAlign",value:function(P){this.target.align=P}},{key:"optionControls",value:function(){var P=this.target,ya=new Nb.DropDownSelector({borderRadius:2,padding:3,selectedValue:P.axis,values:["row","column"]}),Ua=new Nb.DropDownSelector({borderRadius:2,padding:3,selectedValue:P.align,values:["left","center"]});
P=new Nb.NumberWidget({min:0,number:P.spacing,padding:Nb.rect(5,3,0,0),borderRadius:3,borderWidth:1,borderColor:Nb.Color.gray,unit:"px"});Nb.connect(P,"update",this,"updateSpacing");Nb.connect(Ua,"update",this,"updateAlign");Nb.connect(ya,"update",this,"updateAxis");var Eb={type:"label",padding:Nb.rect(0,5,5,5),fill:Nb.Color.transparent,fontColor:Nb.Color.gray.darker(),readOnly:!0};return[[Object.assign({},Eb,{textString:"Submorph Spacing"}),P],[Object.assign({},Eb,{textString:"Tiling Align"}),Ua],
[Object.assign({},Eb,{textString:"Tiling Axis"}),ya]].map(function(Cc){return{submorphs:Cc,fill:null,layout:new Nb.HorizontalLayout({spacing:3})}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TilingLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:Nb.Color.transparent},previews:{defaultValue:[]}}}}],Ba,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:19510,end:21708})}(Nb.LayoutHalo);Nb.TilingLayoutHalo=db;Nb.TilingLayoutHalo=db;Nb.TilingLayoutHalo=db;(function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ba.hasOwnProperty("DropPreview")&&"function"===typeof Ba.DropPreview?Ba.DropPreview:Ba.DropPreview=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,
[{key:"clear",value:function(){this.stopped=!0;this.remove()}},{key:"step",value:function(){var P=this,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return ya=Nb.easings.inOutQuad,Ua.yield(P.animate({opacity:.5,duration:(P.pulseDuration-10)/2,easing:ya}),2);if(3!=Ua.nextAddress)return Ua.yield(P.animate({opacity:1,duration:(P.pulseDuration-10)/2,easing:ya}),3);P.stopped||P.step();Ua.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DropPreview"}},
{key:"properties",get:function(){return{isHaloItem:{readOnly:!0,get:function(){return!0}},epiMorph:{readOnly:!0,get:function(){return!0}},fill:{defaultValue:Nb.Color.orange.withA(.3)},hasFixedPosition:{defaultValue:!0},borderColor:{defaultValue:Nb.Color.orange},borderWidth:{defaultValue:2},borderStyle:{defaultValue:"dashed"},pulseDuration:{defaultValue:2E3}}}}],Ba,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21710,end:22534})})(Nb.Morph);db=Da("F",function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Mb=Ba.hasOwnProperty("FlexLayoutHalo")&&"function"===typeof Ba.FlexLayoutHalo?Ba.FlexLayoutHalo:Ba.FlexLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"handleDrop",value:function(P){}},{key:"previewDrop",
value:function(P){var ya=this;0<this.previews.length||(this.previews=P.map(function(Ua){return ya.container.addMorph({type:Nb.DropPreview,position:ya.container.localize(ya.world().firstHand.position),extent:Ua.bounds().extent()})}),this.previews.forEach(function(Ua){Ua.step()}))}},{key:"remove",value:function(){qb._get(Object.getPrototypeOf(Mb.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"removePreviews",value:function(){this.previews.forEach(function(P){return P.clear()})}},
{key:"onDrop",value:function(P){this.removePreviews();P.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateAutoResizePolicy",value:function(P){P&&(this.originalExtent=this.container.extent);this.target.autoResize=P;P||(this.container.extent=this.originalExtent||this.container.extent);this.alignWithTarget()}},{key:"updateResizeSubmorphsPolicy",value:function(P){this.target.resizeSubmorphs=P;this.alignWithTarget()}},
{key:"updateAlignmentPolicy",value:function(P){this.target.align=P}},{key:"updateDirectionPolicy",value:function(P){this.target.direction=P}},{key:"updateSpacing",value:function(P){this.target.spacing=P}},{key:"optionControls",value:function(){var P=this.target,ya=P.possibleAlignValues?{fill:Nb.Color.transparent,layout:new Nb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"align: "},new Nb.DropDownSelector({name:"alignment",borderRadius:2,padding:3,
selectedValue:P.align,values:P.possibleAlignValues})]}:null,Ua=P.possibleDirectionValues?{fill:Nb.Color.transparent,layout:new Nb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"direction: "},new Nb.DropDownSelector({name:"direction",borderRadius:2,padding:3,selectedValue:P.direction,values:P.possibleDirectionValues})]}:null,Eb=new Nb.NumberWidget({fill:Nb.Color.white,borderWidth:1,borderRadius:4,padding:Nb.rect(5,4,0,0),borderColor:Nb.Color.gray,
min:0,number:P.spacing,unit:"px"}),Cc=new Nb.LabeledCheckBox({name:"autoResize",label:"Resize Container",alignCheckBox:"right",fill:Nb.Color.transparent,checked:P.autoResize});P=new Nb.LabeledCheckBox({label:"Resize Submorphs",name:"resizeSubmorphs",alignCheckBox:"right",fill:Nb.Color.transparent,checked:P.resizeSubmorphs});Nb.connect(Eb,"update",this,"updateSpacing");Nb.connect(Cc,"checked",this,"updateAutoResizePolicy");Nb.connect(P,"checked",this,"updateResizeSubmorphsPolicy");ya&&Nb.connect(ya.submorphs[1],
"selectedValue",this,"updateAlignmentPolicy");Ua&&Nb.connect(Ua.submorphs[1],"selectedValue",this,"updateDirectionPolicy");return[Cc,P].concat($jscomp.arrayFromIterable([ya,Ua].filter(Boolean)),[{fill:Nb.Color.transparent,layout:new Nb.HorizontalLayout,submorphs:[{type:"label",value:"Submorph Spacing",fontColor:Nb.Color.gray.darker(),padding:Nb.rect(0,5,5,5)},Eb]}])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FlexLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},
fill:{defaultValue:Nb.Color.transparent},halosEnabled:{defaultValue:!1},previews:{defaultValue:[]}}}}],Ba,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:22543,end:26761})}(Nb.LayoutHalo));Nb.FlexLayoutHalo=db;Nb.FlexLayoutHalo=db;Nb.FlexLayoutHalo=db;lb=Da("c",function(wa){var Ba=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
Mb=Ba.hasOwnProperty("ProportionalLayoutHalo")&&"function"===typeof Ba.ProportionalLayoutHalo?Ba.ProportionalLayoutHalo:Ba.ProportionalLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return qb(Mb,wa,[{key:"handleDrop",value:function(P){}},{key:"onDrop",value:function(P){P.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateSubmorphProportionalLayoutSettings",
value:function(P){var ya={};this.target.changeSettingsFor(P.submorph,(ya[P.axis]=P.policy,ya),!0)}},{key:"onSubmorphSettingsDragStart",value:function(P,ya){var Ua=this;P.stop();var Eb=this.target.settingsFor(ya);ya="";for(var Cc in Eb)ya+=Cc+":"+Eb[Cc]+" ";var cd=Nb.morph({type:"label",value:ya,isLayoutable:!1});cd.wantsToBeDroppedOn=function(ee){return Ua.target.layoutableSubmorphs.includes(ee)};cd.onBeingDroppedOn=function(ee,Vd){cd.remove();if(ee=Ua.target.layoutableSubmorphs.includes(Vd)?Vd:P.world.morphsContainingPoint(P.hand.position).find(function(Ze){return Ua.target.layoutableSubmorphs.includes(Ze)}))Ua.updateSubmorphProportionalLayoutSettings({policy:Eb.x,
axis:"x",submorph:ee}),Ua.updateSubmorphProportionalLayoutSettings({policy:Eb.y,axis:"y",submorph:ee}),ee.show(),$world.setStatusMessage("layout settings applied")};P.hand.grab(cd)}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var P=this,ya,Ua,Eb,Cc,cd,ee,Vd,Ze,Wd,Be,Qe,rf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cg){switch(cg.nextAddress){case 1:return ya=P.target.layoutableSubmorphs,P.env.eventDispatcher.isKeyPressed("Shift")?(Eb=ya.map(function(Ef){return{isListItem:!0,
string:String(Ef),value:Ef}}),cg.yield($world.listPrompt("Select morph",Eb,{requester:P,onSelection:function(Ef){return Ef.show()}}),5)):cg.yield(Nb.InteractiveMorphSelector.selectMorph(P.world(),P,function(Ef){return ya.includes(Ef)}),4);case 4:Ua=cg.yieldResult;cg.jumpTo(3);break;case 5:Cc=cg.yieldResult,cd=$jscomp.makeIterator(Cc.selected),Ua=cd.next().value;case 3:if(!Ua)return cg.return();ee=P.state.popover.get("controlContainer");Vd=ee.getAllNamed(/submorph config/);Ze=["move","resize","scale",
"fixed"];Wd=P.target.settingsFor(Ua);Vd.length||(ee.submorphs=[].concat($jscomp.arrayFromIterable(ee.submorphs),[{name:"submorph config X-Axis policy",position:Nb.pt(0,P.height),fill:Nb.Color.transparent,layout:new Nb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph X-Axis policy: "},new Nb.DropDownSelector({name:"x-axis policy selector",borderRadius:2,padding:3,selectedValue:Wd.x,values:Ze})]},{name:"submorph config Y-Axis policy",position:Nb.pt(0,
P.height),fill:Nb.Color.transparent,layout:new Nb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph Y-Axis policy: "},new Nb.DropDownSelector({name:"y-axis policy selector",borderRadius:2,padding:3,selectedValue:Wd.y,values:Ze})]},Nb.morph({position:Nb.pt(0,P.height+20),draggable:!0,name:"dragme",type:"label",value:"drag me to copy"})]));Be=ee.getSubmorphNamed("x-axis policy selector");Qe=ee.getSubmorphNamed("y-axis policy selector");rf=ee.getSubmorphNamed("dragme");
Nb.disconnect(Be,"selectedValue",P,"updateSubmorphProportionalLayoutSettings");Nb.disconnect(Qe,"selectedValue",P,"updateSubmorphProportionalLayoutSettings");Be.selectedValue=Wd.x;Qe.selectedValue=Wd.y;Nb.connect(rf,"onDragStart",P,"onSubmorphSettingsDragStart",{updater:function(Ef,Oc){return Ef(Oc,Ua)},varMapping:{submorph:Ua}});Nb.connect(Be,"selectedValue",P,"updateSubmorphProportionalLayoutSettings",{converter:function(Ef){return{policy:Ef,axis:"x",submorph:Ua}},varMapping:{submorph:Ua}});Nb.connect(Qe,
"selectedValue",P,"updateSubmorphProportionalLayoutSettings",{converter:function(Ef){return{policy:Ef,axis:"y",submorph:Ua}},varMapping:{submorph:Ua}});cg.jumpToEnd()}})}},{key:"optionControls",value:function(P){this.state.popover=P;var ya=this.target;P=new Nb.LabeledCheckBox({name:"x-axis",label:"X-Axis",alignCheckBox:"right",fill:Nb.Color.transparent,checked:ya.xAxisEnabled});ya=new Nb.LabeledCheckBox({name:"y-axis",label:"Y-Axis",alignCheckBox:"right",fill:Nb.Color.transparent,checked:ya.yAxisEnabled});
var Ua=new Nb.Button({name:"modify submorph settings button",label:[].concat($jscomp.arrayFromIterable(Nb.Icon.textAttribute("crosshairs")),["\u00a0Change submorph settings"])});Nb.connect(P,"checked",this,"updateXAxisEnabled");Nb.connect(ya,"checked",this,"updateYAxisEnabled");Nb.connect(Ua,"fire",this,"chooseSubmorphToChangeLayoutSettings");return[Ua]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProportionalLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},
fill:{defaultValue:Nb.Color.transparent}}}}],Ba,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:26771,end:32465})}(Nb.LayoutHalo));Nb.ProportionalLayoutHalo=lb;Nb.ProportionalLayoutHalo=lb;Nb.ProportionalLayoutHalo=lb;vd=lively.FreezerRuntime.recorderFor("lively.halos/index.js");vd.Halo=Qd;
vd.MorphHighlighter=md;vd.InteractiveMorphSelector=$c;vd.StatusMessage=tc;vd.StatusMessageForMorph=fd;vd.show=Pa;vd.showConnector=bc;vd.ProportionalLayoutHalo=lb;vd.GridLayoutHalo=Hd;vd.FlexLayoutHalo=db;vd.showAndSnapToGuides=ha;vd.removeSnapToGuidesOf=Q;vd.StatusMessage=tc;vd.StatusMessage=tc;vd.StatusMessageForMorph=fd;vd.StatusMessageForMorph=fd;vd.show=Pa;vd.show=Pa;vd.showConnector=bc;vd.showConnector=bc;vd.Halo=Qd;vd.Halo=Qd;vd.MorphHighlighter=md;vd.MorphHighlighter=md;vd.InteractiveMorphSelector=
$c;vd.InteractiveMorphSelector=$c;vd.ProportionalLayoutHalo=lb;vd.ProportionalLayoutHalo=lb;vd.GridLayoutHalo=Hd;vd.GridLayoutHalo=Hd;vd.FlexLayoutHalo=db;vd.FlexLayoutHalo=db;vd.showAndSnapToGuides=ha;vd.showAndSnapToGuides=ha;vd.removeSnapToGuidesOf=Q;vd.removeSnapToGuidesOf=Q;Qd=Object.freeze({__proto__:null,StatusMessage:tc,StatusMessageForMorph:fd,show:Pa,showConnector:bc,Halo:Qd,MorphHighlighter:md,InteractiveMorphSelector:$c,ProportionalLayoutHalo:lb,GridLayoutHalo:Hd,FlexLayoutHalo:db,showAndSnapToGuides:ha,
removeSnapToGuidesOf:Q,SvgStyleHalo:void 0});Da("i",Qd);Da("_",void 0)}}});
System.register("./__root_module__-37c88ebd.js kld-intersections ./index-d63033cc.js ./index-9714fb53.js ./editor-plugin-4a930e6a.js ./editor-plugin-2c84a098.js ./index-d9e4dc7e.js ./index-e7af5c89.js ./index-22cfc8d9.js".split(" "),function(){var Wa,Ib,Sb,xc,ac,Cd,nd,Ud,bd,Ic,pd,yd,Ne,Pe,Ie,fd,me,Yb,Yc,Nd,gd,ae,Fe,Wb,Cc,Td,Ec,Vd,Lb,ub,uc;return{setters:[function(dc){Wa=dc.i;Ib=dc.M;Sb=dc.t;xc=dc.e;ac=dc.p;Cd=dc.f;nd=dc.d;Ud=dc.o;bd=dc.C;Ic=dc.a2;pd=dc.b;yd=dc.m;Ne=dc.bG;Pe=dc.N;Ie=dc.bD;fd=
dc.bB;me=dc.I;Yb=dc.ah;Yc=dc.R;Nd=dc.bH;gd=dc.a1;ae=dc.az;Fe=dc.n;Wb=dc.a3;Cc=dc.a;Td=dc.a0;Ec=dc.g},function(){},function(dc){Vd=dc.e;Lb=dc.s;ub=dc.I},function(){},function(dc){uc=dc.I},function(){},function(){},function(){},function(){}],execute:function(){function dc(Ga){var ea=Ga.sourceObj,Da=Ga.targetObj;ea.isMorph&&Da.isMorph?(ea.show(),Da.show(),Xb.showConnector&&Xb.showConnector(ea,Da)):Xb.show(String(Ga))}function Zb(Ga){var ea=Ga.sourceObj,Da=Ga.sourceAttrName,ta=Ga.targetObj,Pa=Ga.targetMethodName,
Ha=Ga.getConverter();Ga=Ga.getUpdater();return Xb.printConnectionElements(ea,Da,ta,Pa,Ha,Ga)}function Mc(Ga,ea,Da,ta,Pa,Ha){Ga="/* global connect, source, target */\nconnect(source, '"+ea+"', target, '"+ta+"'";if(Pa||Ha)Ga+=", {\n";Pa&&(Ga+="  converter: "+Pa);Pa&&Ha&&(Ga+=",");Pa&&(Ga+="\n");Ha&&(Ga+="  updater: "+Ha+"\n");if(Pa||Ha)Ga+="}";return Ga+");"}function $a(Ga,ea){var Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ta){if(1==ta.nextAddress)return ta.yield(Xb.InteractiveMorphSelector.selectMorph(),
2);Da=ta.yieldResult;return ta.return(Da?Xb.interactiveConnectGivenSourceAndTarget(Ga,ea,Da):null)})}function $b(Ga,ea,Da,ta){var Pa,Ha,tb,Ac,wb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){switch(ud.nextAddress){case 1:Pa=Da&&Da.world().targetDataBindings(Da);Ha=Ga.world();if(!Pa||!Pa.length)return Ha.setStatusMessage("connect canceled"),ud.return();if(ea){ud.jumpTo(2);break}tb=[{isListItem:!0,string:"[Enter custom attribute..]",value:{custom:!0}}].concat($jscomp.arrayFromIterable(Xb.arr.flatten(Ga.world().targetDataBindings(Ga)).map(function(Tb){return{isListItem:!0,
string:Tb.signature||Tb.name,value:Tb}})));return ud.yield(Ha.listPrompt(["Select Source Attribute\n",{},"Choose the attribute of the morph that is supposed to invoke the connection. This can be a method, property or a custom signal that is invoked upon the morph.",{paddingTop:"10px",fontSize:14,textAlign:"left",fontWeight:"normal"}],tb,{filterable:!0}),3);case 3:ea=ud.yieldResult;if("canceled"==ea.status)return ud.return();ea=ea.selected[0];ea=ea.custom?"sourceAttribute":ea.name;case 2:return Ac=
[{isListItem:!0,string:"[Enter custom attribute...]",value:{custom:!0}}].concat($jscomp.arrayFromIterable(Xb.arr.flatten(Pa).map(function(Tb){return{isListItem:!0,value:Tb,string:Tb.signature||Tb.name}}))),ud.yield(Ha.listPrompt(["Select Target Attribute\n",{},"Choose the attribute of the morph that is supposed to invoked once the connection is triggered. This can be either a method or a property of the morph. When selecting a property, keep in mind that the value of the source attribute will be assigned to the property or passed to the method as an argument.",
{fontSize:14,textAlign:"left",fontWeight:"normal",paddingTop:"10px"}],Ac,{filterable:!0}),4);case 4:wb=ud.yieldResult;if("canceled"==wb.status)return ud.return();wb=wb.selected[0];return ud.yield(Xb.interactivelyEvaluateConnection({sourceObj:Ga,sourceAttr:ea,targetObj:Da,targetAttr:wb.custom?"targetAttribute":wb.name,onConnect:ta,prompt:"Edit and confirm connection:"}),0)}})}function Eb(Ga,ea,Da,ta){ea=void 0===ea?"confirm connection":ea;var Pa,Ha,tb,Ac,wb,ud,Tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(te){Pa=
Ga;Ha=Pa.sourceObj;tb=Pa.sourceAttrName;Ac=Pa.targetObj;wb=Pa.targetMethodName;ud=Ga.getConverter();Tb=Ga.getUpdater();return te.return(Xb.interactivelyEvaluateConnection({sourceObj:Ha,sourceAttr:tb,targetObj:Ac,targetAttr:wb,converter:ud,updater:Tb,prompt:ea,highlight:Da,onConnect:ta}))})}function kc(Ga,ea,Da,ta,Pa){ta=void 0===ta?{}:ta;Pa=Xb.rect(0).sides.concat(Xb.rect(0).corners);Da=Da||new Xb.Leash(Object.assign({isSmooth:!0,styleClasses:["Halo"],borderColor:Xb.Color.orange,epiMorph:!0,endpointStyle:{start:{fill:Xb.Color.transparent,
nativeCursor:"auto"},end:{fill:Xb.Color.orange}}},ta,{hasFixedPosition:!0}));Da.startPoint.attachTo(Ga,"rightCenter");ea.isMorph?(ta=ea.globalBounds().partNameNearest(Pa,Ga.globalPosition),Ga.globalPosition.equals(ea.globalBounds().partNamed(ta))&&ea.globalBounds().partNameNearest(Xb.arr.without(Pa,ta),Ga.globalPosition),Da.endPoint.attachTo(ea,"leftCenter")):(Pa=Ga.globalBounds().topRight().addPt(Xb.pt(100,0)),ea=Xb.morph({type:"label",value:ea.toString(),styleClasses:["Tooltip"],padding:Xb.rect(8,
4)}).openInWorld(Pa),ea.position=Ga.world().bounds().translateForInclusion(ea.bounds()).topLeft(),Xb.once(Da,"remove",ea,"remove"),Da.endPoint.attachTo(ea,"leftCenter"));return Da}function tc(Ga){var ea,Da,ta,Pa,Ha,tb,Ac,wb,ud,Tb,te,cd,Lc,Hb,Be,Ob,Gb,Ta,Y,Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){switch(gb.nextAddress){case 1:ea=Ga;Da=ea.sourceObj;ta=ea.sourceAttr;Pa=ea.targetObj;Ha=ea.targetAttr;tb=ea.converter;Ac=ea.updater;wb=ea.prompt;ud=void 0===ea.highlight?!0:ea.highlight;
Tb=ea.onConnect;te="lively://lively.bindings-interactive-connect/x"+Da.id;cd={context:window,format:"esm",targetModule:te,classTransform:Xb.classToFunctionTransform};Lc=Xb.printConnectionElements(Da,ta,Pa,Ha,tb,Ac);Pa.isMorph&&Da.isMorph&&(Hb=Pa.propertiesAndPropertySettings().properties[Ha]||{type:typeof Pa[Ha]},Be=Hb.type,Ob=Da.propertiesAndPropertySettings().properties[ta]||{type:typeof Da[ta]},Gb=Ob.type,Gb!==Be&&(wb=["Edit and confirm connection:\n",{},"Source: ",{fontSize:14,fontWeight:"normal"},
Da.toString(),{fontSize:14,fontWeight:"normal",fontStyle:"italic"},"\nTarget: ",{fontSize:14,fontWeight:"normal"},Pa.toString(),{fontSize:14,fontWeight:"normal",fontStyle:"italic"}]));Ta={};Object.assign(lively.modules.module(te).recorder,(Ta.source=Da,Ta.target=Pa,Ta.connect=Xb.connect,Ta.once=Xb.once,Ta[ta]=Da[ta],Ta));if(!wb){Y=Lc;gb.jumpTo(2);break}return gb.yield($world.editPrompt(wb,{input:Lc,historyId:"lively.bindings-interactive-morph-connect",mode:"js",requester:$world,evalEnvironment:cd,
animated:!1}),3);case 3:if(Y=gb.yieldResult,!Y)return $world.setStatusMessage("connect canceled"),gb.return();case 2:return gb.yield(lively.vm.runEval(Y,cd),4);case 4:Ma=gb.yieldResult;if(Ma.isError)return $world.logError(Ma.value),gb.return(tc({sourceObj:Da,sourceAttr:ta,targetObj:Pa,targetAttr:Ha,converter:tb,updater:Ac,prompt:"confirm connection",highlight:ud,onConnect:Tb}));ud&&($world.setStatusMessage("connected!",Xb.Color.green),Xb.interactivelyShowConnection(Ma.value));"function"===typeof Tb&&
Tb(Ma);gb.jumpToEnd()}})}var Sc=lively.FreezerRuntime.recorderFor("ProtoInspector/index.js");Sc.Inspector=uc;var Pd=function(Ga){var ea=lively.FreezerRuntime.recorderFor("ProtoInspector/index.js"),Da=ea.hasOwnProperty("ProtoInspector")&&"function"===typeof ea.ProtoInspector?ea.ProtoInspector:ea.ProtoInspector=function(ta){ta&&ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Wa(Da,Ga,void 0,[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"ProtoInspector"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],ea,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoInspector",version:"0.1.1-0"}}},{start:68,end:210})}(Sc.Inspector);Pd=Sc.ProtoInspector;Sc.default=Pd;var ec=lively.FreezerRuntime.recorderFor("MorphicSideBar/index.js");
ec.Morph=Ib;ec.touchInputDevice=Sb;ec.easings=xc;ec.pt=ac;ec.fun=Cd;ec.connect=nd;Sc=function(Ga){var ea=lively.FreezerRuntime.recorderFor("MorphicSideBar/index.js"),Da=ea.hasOwnProperty("MorphicSideBar")&&"function"===typeof ea.MorphicSideBar?ea.MorphicSideBar:ea.MorphicSideBar=function(ta){ta&&ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Wa(Da,Ga,[{key:"relayout",value:function(){this.onWorldResize()}},{key:"onWorldResize",
value:function(ta){ta=void 0===ta?!0:ta;if(this.respondsToVisibleWindow){var Pa=$world.visibleBounds(),Ha=navigator.standalone&&ec.touchInputDevice?25:0;this.height=Pa.height-Ha;this.top=Ha+Pa.top();Ha=this.get("horizontal resizer");Ha.height=this.height;Ha.top=0;ta&&(this.visible?this.topLeft=Pa.topLeft():this.topRight=Pa.topLeft())}}},{key:"switchMode",value:function(ta){"inspector"==ta&&this.showInspector();"connections"==ta&&this.showConnections()}},{key:"showInspector",value:function(){this.get("inspector").visible=
!0;this.get("connections tree").visible=!1}},{key:"showConnections",value:function(){this.get("inspector").visible=!1;this.get("connections tree").visible=!0}},{key:"toggle",value:function(ta){var Pa=this,Ha,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ac){switch(Ac.nextAddress){case 1:Ha=$world.visibleBounds();tb=navigator.standalone&&ec.touchInputDevice?25:0;Pa.height=Ha.height-tb;Pa.top=tb+Ha.top();if(ta)return $world.addMorph(Pa,$world.get("lively top bar")),Pa.topRight=Ha.topLeft(),
Pa.attachToWorld($world),Pa.visible=!0,Ac.yield(Pa.whenRendered(),5);Pa.detachFromWorld($world);return Ac.yield(Pa.animate({opacity:0,topRight:Ha.topLeft(),duration:300}),4);case 4:Pa.visible=!1;Pa.remove();Ac.jumpTo(0);break;case 5:return Pa.onWorldResize(!1),Pa.get("scene graph").adjustProportions(),Ac.yield(Pa.animate({opacity:1,easing:ec.easings.outCirc,topLeft:Ha.topLeft(),duration:300}),6);case 6:Pa.get("scene graph").refresh(),Ac.jumpToEnd()}})}},{key:"attachToWorld",value:function(ta){ec.connect(ta,
"onChange",this,"onHierarchyChange",{garbageCollect:!0});ec.connect(ta,"onSubmorphChange",this,"onHierarchyChange",{garbageCollect:!0});ec.connect(ta,"showHaloFor",this,"selectNode",{garbageCollect:!0})}},{key:"detachFromWorld",value:function(ta){var Pa=this;ta.attributeConnections.forEach(function(Ha){Ha.targetObj===Pa&&Ha.disconnect()})}},{key:"selectNode",value:function(ta){this.getSubmorphNamed("scene graph").selectMorphInTarget(ta);this.getSubmorphNamed("connections tree").inspectConnectionsOf(ta)}},
{key:"onHierarchyChange",value:function(ta){var Pa=this,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if("addMorphAt"===ta.selector||"removeMorph"===ta.selector||"name"===ta.prop){Ha=Pa._sceneGraph||(Pa._sceneGraph=Pa.getSubmorphNamed("scene graph"));if(!Ha||!Ha.owner.visible||ta.target&&ta.target.isHand||ta.target&&Ha.ignoreMorph(ta.target)||ta.args&&!ta.args[0].isHalo&&Ha.ignoreMorph(ta.args[0])||ta.target.ownerChain().find(function(Ac){return Ha.ignoreMorph(Ac)}))return tb.return();
ec.fun.debounceNamed("scene-graph-update",50,function(){return Ha.refresh()})()}tb.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphicSideBar"}},{key:"properties",get:function(){return{isHaloItem:{get:function(){return!1}}}}}],ea,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"MorphicSideBar",version:"0.1.1-76"}}},
{start:226,end:3668})}(ec.Morph);Sc=ec.MorphicSideBar;ec.default=Sc;var Xb=lively.FreezerRuntime.recorderFor("lively.ide/fabrik.js");Xb.interactivelyShowConnection=dc;Xb.printConnection=Zb;Xb.printConnectionElements=Mc;Xb.interactiveConnectGivenSource=$a;Xb.interactiveConnectGivenSourceAndTarget=$b;Xb.interactivelyReEvaluateConnection=Eb;Xb.visualizeConnection=kc;Xb.interactivelyEvaluateConnection=tc;Xb.connect=nd;Xb.once=Ud;Xb.Color=bd;Xb.rect=Ic;Xb.pt=ac;Xb.arr=pd;Xb.morph=yd;Xb.Leash=Ne;Xb.showConnector=
Vd;Xb.show=Lb;Xb.InteractiveMorphSelector=ub;Xb.classToFunctionTransform=Pe;Xb.interactivelyShowConnection=dc;Xb.interactivelyShowConnection=dc;Xb.printConnection=Zb;Xb.printConnection=Zb;Xb.printConnectionElements=Mc;Xb.printConnectionElements=Mc;Xb.interactiveConnectGivenSource=$a;Xb.interactiveConnectGivenSource=$a;Xb.interactiveConnectGivenSourceAndTarget=$b;Xb.interactiveConnectGivenSourceAndTarget=$b;Xb.interactivelyReEvaluateConnection=Eb;Xb.interactivelyReEvaluateConnection=Eb;Xb.visualizeConnection=
kc;Xb.visualizeConnection=kc;Xb.interactivelyEvaluateConnection=tc;Xb.interactivelyEvaluateConnection=tc;var Jb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js");Jb.Tree=Ie;Jb.TreeData=fd;Jb.morph=yd;Jb.Icon=me;Jb.HorizontalLayout=Yb;Jb.easings=xc;Jb.Morph=Ib;Jb.Color=bd;Jb.Rectangle=Yc;Jb.rect=Ic;Jb.pt=ac;Jb.connect=nd;Jb.noUpdate=Nd;Jb.disconnect=gd;Jb.disconnectAll=ae;Jb.once=Ud;Jb.arr=pd;Jb.num=Fe;Jb.fun=Cd;Jb.tree=Wb;Jb.promise=Cc;Jb.ConnectionHalo=_missingExportShim;Jb.getClassName=
Td;Sc=function(Ga){var ea=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Da=ea.hasOwnProperty("InteractiveTreeContainer")&&"function"===typeof ea.InteractiveTreeContainer?ea.InteractiveTreeContainer:ea.InteractiveTreeContainer=function(ta){ta&&ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Wa(Da,Ga,[{key:"onChildRemoved",value:function(ta){}},{key:"onChildAdded",value:function(ta){}},{key:"toggleSelected",value:function(ta){if(this.tree){var Pa=
this.tree,Ha=Pa.selectionFontColor,tb=Pa.nonSelectionFontColor;this.submorphs.filter(function(Ac){return!Ac._isControlElement&&Ac.styleClasses.includes("Label")}).forEach(function(Ac){Ac.fontColor=ta?Ha:tb})}}},{key:"onGrab",value:function(ta){var Pa=this.tree,Ha=this.node;this.fill=Jb.Color.gray.withA(.5);this.fontColor=Pa.selectionFontColor;this.opacity=.8;Wa._get(Object.getPrototypeOf(Da.prototype),"onGrab",this).call(this,ta);Ha&&(this.toggleSelected(!1),Pa.collapse(Ha),Pa.treeData.parentNode(Ha).container.onChildRemoved(this),
this._data=Pa.treeData.remove(Ha),Ha.container.target.remove(),Pa.update(!0))}},{key:"wantsToBeDroppedOn",value:function(ta){this.showPreviewOn(ta);return!0}},{key:"showPreviewOn",value:function(ta){if(ta.isContainer)var Pa=ta.tree;ta.isTree&&(Pa=ta);Pa&&Pa.showDropPreviewFor&&Pa.showDropPreviewFor(this)}},{key:"insertAsChild",value:function(ta){var Pa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){if(1==Ha.nextAddress)return Pa.tree.treeData.add(ta._data,Pa.node,Pa.node.children[0]),
Pa.tree.uncollapse(Pa.node),Pa.tree.treeData.remove(Pa.tree._previewNode),Ha.yield(Pa.tree.whenRendered(),2);Pa.tree.update(!0);Pa.onChildAdded(ta);Ha.jumpToEnd()})}},{key:"onBeingDroppedOn",value:function(ta,Pa){var Ha=this;this.tree._dropInProgress=!0;Wa._get(Object.getPrototypeOf(Da.prototype),"onBeingDroppedOn",this).call(this,ta,Pa);ta=function(){Ha.fill=Jb.Color.gray.withA(.5);Ha.opacity=1;Ha.tree._dropInProgress=!1;Ha.tree.refresh()};Pa.isTree?Pa.insertAtPlaceholder(this).then(ta):Pa.isContainer?
Pa.insertAsChild(this).then(ta):ta()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveTreeContainer"}},{key:"properties",get:function(){return{fill:{defaultValue:Jb.Color.transparent},isContainer:{get:function(){return!0}},tree:{},node:{readOnly:!0,get:function(){var ta=this,Pa=this.tree.treeData;return Pa&&Pa.asList().find(function(Ha){return Ha.container===ta})}}}}}],ea,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1105"}}},{start:498,end:2961})}(Jb.Morph);Jb.InteractiveTreeContainer=Sc;Jb.InteractiveTreeContainer=Sc;Jb.InteractiveTreeContainer=Sc;Sc=function(Ga){var ea=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Da=ea.hasOwnProperty("InteractiveTreeData")&&"function"===typeof ea.InteractiveTreeData?ea.InteractiveTreeData:ea.InteractiveTreeData=function(ta){ta&&
ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Wa(Da,Ga,[{key:"display",value:function(ta){return[ta.container||"<NO CONTAINER>",{}]}},{key:"isCollapsed",value:function(ta){return ta.isCollapsed}},{key:"collapse",value:function(ta,Pa){ta.isCollapsed=Pa}},{key:"getChildren",value:function(ta){var Pa=this;return ta.isLeaf?null:ta.children.filter(function(Ha){return Ha&&(Pa.filterActive?Ha.visible:!0)})}},{key:"isLeaf",value:function(ta){var Pa=
this;return!ta.children||0==ta.children.filter(function(Ha){return Ha&&(Pa.filterActive?Ha.visible:!0)}).length}},{key:"add",value:function(ta,Pa,Ha){Pa=void 0===Pa?this.root:Pa;Pa.children||(Pa.children=[]);Ha?Jb.arr.pushAt(Pa.children,ta,Pa.children.indexOf(Ha)):Pa.children.push(ta);Pa.isLeaf=!1}},{key:"replace",value:function(ta,Pa){var Ha=this.parentNode(ta);ta=Ha.children.indexOf(ta);Ha.children[ta]=Pa}},{key:"next",value:function(ta){var Pa=this.parentNode(ta);return Pa&&Pa.children[Pa.children.indexOf(ta)+
1]}},{key:"isBefore",value:function(ta,Pa){this.next(ta)===Pa}},{key:"isAfter",value:function(ta,Pa){this.next(Pa)===ta}},{key:"addBefore",value:function(ta,Pa){this.add(ta,this.parentNode(Pa),Pa)}},{key:"addAfter",value:function(ta,Pa){var Ha=this.parentNode(Pa);Pa=Ha.children.indexOf(Pa)+1;this.add(ta,Ha,Ha.children[Pa])}},{key:"remove",value:function(ta){var Pa=this.parentNode(ta);if(Pa)return Jb.arr.remove(Pa.children,ta),Pa.children==[]&&(Pa.children=null),ta}},{key:"filter",value:function(ta,
Pa){Pa=void 0===Pa?1:Pa;var Ha=this,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ac){if(1==Ac.nextAddress)return Ac.yield(Ha.uncollapseAll(function(wb,ud){return ud<Pa+1}),2);tb=Ha.filterActive;Ha.filterActive=!1;Ha.asListWithIndexAndDepth(!1).reverse().forEach(function(wb){var ud=wb.node;if(0==wb.depth)return ud.visible=!0;ud.visible=ta(ud);ud.visible||ud.isCollapsed||!ud.children.find(function(Tb){return Tb.visible})?ud.container.opacity=1:(ud.visible=!0,ud.container.opacity=.5);
return ud.visible});Ha.filterActive=tb;Ac.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveTreeData"}}],ea,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1105"}}},{start:2970,end:5433})}(Jb.TreeData);Jb.InteractiveTreeData=Sc;Jb.InteractiveTreeData=Sc;Jb.InteractiveTreeData=
Sc;Sc=function(Ga){var ea=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Da=ea.hasOwnProperty("InteractiveTree")&&"function"===typeof ea.InteractiveTree?ea.InteractiveTree:ea.InteractiveTree=function(ta){ta&&ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Wa(Da,Ga,[{key:"update",value:function(ta){var Pa=this;Wa._get(Object.getPrototypeOf(Da.prototype),"update",this).call(this,ta);this.treeData&&this.relayoutContainers();
ta&&this.embeddedMorphs.forEach(function(Ha){Ha.isContainer&&(Ha.fill=Jb.Color.transparent,Ha.fontFamily=Pa.fontFamily,Ha.fontSize=Pa.fontSize)})}},{key:"onDrop",value:function(ta){Wa._get(Object.getPrototypeOf(Da.prototype),"onDrop",this).call(this,ta);this.treeData.remove(this._previewNode);this.update(!0)}},{key:"onDropHoverIn",value:function(ta){}},{key:"onDropHoverUpdate",value:function(ta){}},{key:"onDropHoverOut",value:function(ta){}},{key:"onHoverOut",value:function(ta){var Pa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){Wa._get(Object.getPrototypeOf(Da.prototype),
"onHoverOut",Pa).call(Pa,ta);Pa._previewNode&&Pa._previewNode.container.world()&&Pa.treeData.remove(Pa._previewNode);Pa.resetContainerSelection();Pa.update(!0);Ha.jumpToEnd()})}},{key:"insertAtPlaceholder",value:function(ta){var Pa=this,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress)return Ha=Pa.treeData.parentNode(Pa._previewNode),Pa.treeData.replace(Pa._previewNode,ta._data),Pa.treeData.remove(Pa._previewNode),tb.yield(Pa.whenRendered(),2);Pa.update(!0);
Ha.container.onChildAdded(ta);tb.jumpToEnd()})}},{key:"scrollUpSlowly",value:function(){var ta=this;if(!this._scrollingUp){this._scrollingUp=!0;var Pa=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){if(1==Ha.nextAddress)return ta._scrollingUp&&0<ta.scroll.y?Ha.yield(ta.animate({scroll:ta.scroll.subXY(0,30),duration:300,easing:Jb.easings.linear}),3):(ta._scrollingUp=!1,Ha.jumpTo(0));Pa();Ha.jumpToEnd()})};Pa()}}},{key:"scrollDownSlowly",value:function(){var ta=this;if(!this._scrollingDown){this._scrollingDown=
!0;var Pa=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){if(1==Ha.nextAddress)return ta._scrollingDown&&ta.scroll.y<ta.scrollExtent.y-ta.height?Ha.yield(ta.animate({scroll:ta.scroll.addXY(0,30),duration:300,easing:Jb.easings.linear}),3):(ta._scrollingDown=!1,Ha.jumpTo(0));Pa();Ha.jumpToEnd()})};Pa()}}},{key:"stopScrollingSlowly",value:function(){this._scrollingUp=this._scrollingDown=!1}},{key:"resetContainerSelection",value:function(){this.embeddedMorphs.forEach(function(ta){ta.isContainer&&
(ta.fill=Jb.Color.transparent)})}},{key:"showDropPreviewFor",value:function(ta){var Pa=this;ta=this.localize(ta.globalBounds().center());var Ha=this.textPositionFromPoint(ta),tb=this.treeData.asListWithIndexAndDepth(function(cd){cd=cd.node;return cd!=Pa._previewNode&&cd.container.world()}),Ac=(tb.find(function(cd){return cd.i-1===Ha.row})||{}).node,wb=Ac&&Ac.container,ud=this.ensurePlaceholder(),Tb=!!ud.container.world(),te=ta.subPt(this.scroll).subPt(this.scrollbarOffset);10>te.y?this.scrollUpSlowly():
te.y>this.height-50?this.scrollDownSlowly():this.stopScrollingSlowly();this.resetContainerSelection();if(!wb){if(tb.length>Ha.row||Jb.arr.last(this.treeData.root.children)===ud)return;this.treeData.remove(ud);this.treeData.add(ud);this.update(!0)}if(wb){tb=this.textLayout.boundsFor(this,Ha);if(4>Math.abs(tb.top()-ta.y)){if(this.treeData.isBefore(ud,Ac))return;this.treeData.remove(ud);this.treeData.addBefore(ud,Ac)}else if(4>Math.abs(tb.bottom()-ta.y)&&(Ac.isCollapsed||this.treeData.isLeaf(Ac))){if(this.treeData.isAfter(ud,
Ac))return;this.treeData.remove(ud);this.treeData.addAfter(ud,Ac)}else{wb.fill=Jb.Color.gray;if(!Tb)return;this.treeData.remove(ud)}this.update(!0)}}},{key:"ensurePlaceholder",value:function(){var ta=Jb.pt(this.width-100,this.document.getLine(0).height);this._previewNode||(this._previewNode={container:Jb.morph({acceptsDrops:!1,reactsToPointer:!1,fill:Jb.Color.gray,borderRadius:5}),isCollapsed:!0,isLeaf:!0});this._previewNode.container.extent=ta;return this._previewNode}},{key:"relayoutContainers",
value:function(){var ta=this;this.charBoundsFromTextPosition({row:0,column:6});this.textLayout.charBoundsOfRow(this,0).map(function(Pa){return Pa.height});this.treeData.asListWithIndexAndDepth().forEach(function(Pa){var Ha=Pa.node;Pa=Pa.i;Ha.container.nativeCursor="grab";Ha.container.width=ta.width-25-Ha.container.left;Ha.container.toggleSelected&&Ha.container.toggleSelected(Pa==ta.selectedIndex)});this.anchors.forEach(function(Pa){return Pa.position=Pa.position})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InteractiveTree"}}],ea,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1105"}}},{start:5442,end:10816})}(Jb.Tree);Jb.InteractiveTree=Sc;Jb.InteractiveTree=Sc;Jb.InteractiveTree=Sc;Sc=function(Ga){var ea=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Da=ea.hasOwnProperty("SceneGraphTree")&&
"function"===typeof ea.SceneGraphTree?ea.SceneGraphTree:ea.SceneGraphTree=function(ta){ta&&ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Wa(Da,Ga,[{key:"beforePublish",value:function(){this.submorphs=[];this.reset()}},{key:"selectMorphInTarget",value:function(ta){var Pa=this.treeData.asList().find(function(Ha){return Ha.container.target===ta});Pa&&this.selectedNode!=Pa&&this.selectPath(this.treeData.pathOf(Pa))}},{key:"onLoad",
value:function(){var ta=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){if(1==Pa.nextAddress)return Pa.yield(ta.whenRendered(),2);if(3!=Pa.nextAddress){if(ta.ownerChain().find(function(Ha){return Ha.isComponent}))return Pa.return();ta.submorphs=[];return Pa.yield(ta.whenRendered(),3)}ta.get("inspector").makeEditorVisible(!0);ta.get("inspector").makeEditorVisible(!1);ta.setTarget($world);Pa.jumpToEnd()})}},{key:"adjustProportions",value:function(ta){ta=(ta?ta.state.dragDelta:{y:0}).y;
var Pa=this.get("inspector"),Ha=this.get("scene graph resizer"),tb=this.get("mode selector"),Ac=this.get("connections tree");this.height+=ta;Pa.height-=ta;Ac.height-=ta;Ha.top=this.bottom;Ha.left=0;tb.top=Ha.bottom;Ac.top=Pa.top=tb.bottom+5}},{key:"reset",value:function(){var ta=this;this.treeData=new Jb.InteractiveTreeData({children:[],container:Jb.morph()});this.get("inspector").targetObject={};this.selectedNode=null;this.anchors.filter(function(Pa){return null==Pa.id}).forEach(function(Pa){return ta.removeAnchor(Pa)})}},
{key:"setTarget",value:function(ta){this.target=ta;this.treeData=this.getTreeFromSubmorphHierarchy(ta);this.uncollapse(this.treeData.root)}},{key:"isNodeOutOfSync",value:function(ta){var Pa=this;if(ta===this._previewNode)return!1;if(ta.container.nameNeedsUpdate)return!0;var Ha=ta.container.target.submorphs.filter(function(tb){return!Pa.ignoreMorph(tb)});return Ha.length!=ta.children.length||Ha.map(function(tb){return tb.name}).join("")!=ta.children.map(function(tb){return tb.target?tb.target.name:
""}).join("")?!0:!1}},{key:"getNewChildren",value:function(ta){var Pa=this,Ha=ta.container.target.submorphs.map(function(Tb){return Tb.__scene_graph_target__?Tb.__scene_graph_target__():Tb}).filter(function(Tb){return!Pa.ignoreMorph(Tb)}),tb=[],Ac={},wb;for(wb in Ha){Ac.$jscomp$loop$prop$m$2852=Ha[wb];var ud=Jb.arr.without(ta.children,this._previewNode).find(function(Tb){return function(te){return te.container.target.id==Tb.$jscomp$loop$prop$m$2852.id}}(Ac));tb[wb]=ud?ud:this.readMorphHierarchy(Ac.$jscomp$loop$prop$m$2852);
Ac={$jscomp$loop$prop$m$2852:Ac.$jscomp$loop$prop$m$2852}}return tb}},{key:"refresh",value:function(){var ta=this;if(!this._updating&&!this._dropInProgress){var Pa=!1;Jb.tree.prewalk(this.treeData.root,function(Ha){ta.isNodeOutOfSync(Ha)&&(Pa=!0,Ha.name=Ha.container.target.name,Ha.container.refresh(),Ha.children=ta.getNewChildren(Ha))},function(Ha){return Ha.children});this.update(Pa)}}},{key:"ignoreMorph",value:function(ta){return ta.isMorph?ta.isContainer||ta.isWindow||ta.getWindow()||ta.isEpiMorph||
ta.isHand||["lively.halos"].includes(ta.constructor[Symbol.for("lively-module-meta")].package.name)||["MorphicSideBar","SideBarToggler","UserFlap","Menu","CommentIndicator"].includes(ta.constructor.name):!1}},{key:"onDropHoverOut",value:function(ta){var Pa=ta.hand.grabbedMorphs[0];ta=ta.hand.findDropTarget();if(!(ta===this||ta&&ta.ownerChain().includes(this))&&Pa&&Pa.isContainer)Pa.onDragOutside()}},{key:"onDropHoverIn",value:function(ta){var Pa=ta.hand.grabbedMorphs[0];Pa&&!Pa.isContainer&&($world.halos().forEach(function(Ha){return Ha.remove()}),
Pa.remove(),Object.assign(Pa,ta.hand._grabbedMorphProperties.get(Pa).pointerAndShadow),Pa=this.renderContainerFor(Pa,!1),ta.hand.grab(Pa),Pa.leftCenter=Jb.pt(-20,0))}},{key:"getTreeFromSubmorphHierarchy",value:function(ta){return new Jb.InteractiveTreeData(this.readMorphHierarchy(ta))}},{key:"readMorphHierarchy",value:function(ta){var Pa=this;return Jb.tree.mapTree(ta,function(Ha,tb){return{name:Ha.name,isCollapsed:!0,container:Pa.renderContainerFor(Ha),visible:!0,children:tb}},function(Ha){return Ha.submorphs.filter(function(tb){return Ha.isWorld?
!Pa.ignoreMorph(tb):!0})})}},{key:"renderContainerFor",value:function(ta,Pa){ta=void 0===ta?Jb.morph({name:"root"}):ta;Pa=void 0===Pa?!0:Pa;var Ha=new Jb.MorphContainer({tree:this,fill:Pa?Jb.Color.transparent:Jb.Color.gray.withA(.5),fontColor:this.nonSelectionFontColor,fontFamily:this.fontFamily,target:ta,opacity:ta.visible?1:.5});Pa||(Ha.layout=new Jb.HorizontalLayout({spacing:2,align:"center"}));ta._data?(Ha._data=ta._data,ta._data.container=Ha):Ha._data={name:ta.name,isCollapsed:!0,container:Ha,
children:[]};return Ha}},{key:"collapseAll",value:function(){var ta=this;this.treeData.asList().forEach(function(Pa){return Pa!=ta.treeData.root?Pa.isCollapsed=!0:Pa.isCollapsed=!1})}},{key:"filterMorphs",value:function(ta){var Pa=this,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress)return Ha=ta.tokens[0],Pa.treeData.filterActive||(Pa._collapseState=new WeakMap(Pa.treeData.asList().map(function(Ac){return[Ac,Ac.isCollapsed]}))),Pa.treeData.filterActive=!!Ha,
tb.yield(Pa.treeData.filter(function(Ac){var wb=!Ha||Ac.container.target.name.includes(Ha);Ac.container.highlightTerm(Ha);return wb},3),2);Pa.treeData.filterActive||Pa.treeData.asList().forEach(function(Ac){return Ac.isCollapsed=Pa._collapseState.has(Ac)?Pa._collapseState.get(Ac):!0});Pa.refresh();tb.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SceneGraphTree"}},{key:"properties",get:function(){return{target:{serialize:!1}}}}],ea,{pathInPackage:function(){return"index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1105"}}},{start:10825,end:17474})}(Jb.InteractiveTree);Jb.SceneGraphTree=Sc;Jb.SceneGraphTree=Sc;Jb.SceneGraphTree=Sc;Sc=function(Ga){var ea=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Da=ea.hasOwnProperty("MorphContainer")&&"function"===typeof ea.MorphContainer?ea.MorphContainer:
ea.MorphContainer=function(ta){ta&&ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Wa(Da,Ga,[{key:"refresh",value:function(){var ta=this,Pa,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){Pa=ta.target;if(!Pa)return tb.return();ta.reactsToPointer=!0;ta.dropShadow=!1;ta.submorphs=[ta.getLabel(),0<Pa.comments.length&&ta.getCommentControls(),Pa.layout&&ta.getLayoutControls(),ta.getConnectionControls()].filter(Boolean).map(function(Ac,
wb){Ac.fitIfNeeded();Ac.left=Ha?Ha.right+5:0;Ac.top=2;return Ha=Ac});ta.height=20;ta.opacity=Pa.visible?1:.5;tb.jumpToEnd()})}},{key:"getLabel",value:function(){var ta=this.getSubmorphNamed("name label")||Jb.morph({type:"label",name:"name label",reactsToPointer:!1,padding:Jb.rect(0,0,0,0),acceptsDrops:!1,fontSize:this.tree.fontSize}),Pa=ta.textString.slice(2,-1);Pa&&Pa==this.target.name||(ta.value=[].concat($jscomp.arrayFromIterable(this.getIcon(this.target)),[" "+this.target.name+" "]));return ta}},
{key:"getIcon",value:function(ta){return Jb.Icon.textAttribute({Morph:"square",Ellipse:"circle",Text:"font",Label:"tag",Polygon:"draw-polygon",Path:"bezier-curve",Image:"image",Canvas:"chess-board",HTMLMorph:"code"}[Jb.getClassName(ta)]||"codepen",{paddingTop:"4px",fontSize:this.tree.fontSize-2,opacity:.6})}},{key:"getLayoutControls",value:function(){var ta=this.getSubmorphNamed("layout label")||Jb.morph({type:"label",name:"layout label",borderRadius:3,acceptsDrops:!1,padding:Jb.Rectangle.inset(4,
2,4,2),fill:Jb.Color.orange,fontColor:Jb.Color.white});ta._isControlElement=!0;ta.textString!=this.target.layout.name()&&(ta.value=this.target.layout.name());return ta}},{key:"getCommentControls",value:function(){var ta=this.getSubmorphNamed("comment label")||Jb.morph({type:"label",name:"comment label",tooltip:"Open comment browser to browse all comments",borderRadius:3,acceptsDrops:!1,padding:Jb.Rectangle.inset(4,2,4,2),fill:Jb.Color.rgb(241,196,15),fontColor:Jb.Color.black});ta._isControlElement=
!0;var Pa=this.target.comments.length+" comment"+(1==this.target.comments.length?"":"s");ta.textString!=Pa&&(ta.value=Pa);return ta}},{key:"getConnectionControls",value:function(){this.connectionCount=this.target.attributeConnections?this.target.attributeConnections.filter(function(Ha){return!Ha.targetObj.isHalo}).length:0;var ta=this.getSubmorphNamed("connections label")||Jb.morph({acceptsDrops:!1,borderRadius:3,type:"label",name:"connections label",padding:Jb.Rectangle.inset(4,2,4,2),nativeCursor:"pointer",
fill:Jb.Color.red,fontColor:Jb.Color.white});ta._isControlElement=!0;ta.visible=!this.connectionHalo&&!!this.connectionCount;var Pa=this.connectionCount?this.connectionCount+" connection"+(1<this.connectionCount?"s":""):"Manage Connections";ta.textString!=Pa&&(ta.value=Pa);return ta}},{key:"highlightTerm",value:function(ta){var Pa=this.submorphs[0],Ha=Pa.textAndAttributes.slice(0,2),tb=Pa.textString.slice(1).split(ta);Pa.textAndAttributes=1===tb.length?[].concat($jscomp.arrayFromIterable(Ha),[tb[0]]):
[].concat($jscomp.arrayFromIterable(Ha),$jscomp.arrayFromIterable(Jb.arr.flatten(Jb.arr.interpose(tb.map(function(Ac){return[Ac,{}]}),[ta,{fontWeight:"900"}]))))}},{key:"getClassControls",value:function(){}},{key:"wantsToBeDroppedOn",value:function(ta){var Pa=Wa._get(Object.getPrototypeOf(Da.prototype),"wantsToBeDroppedOn",this).call(this,ta);if(![ta].concat($jscomp.arrayFromIterable(ta.ownerChain())).includes(this.tree))this.onDragOutside();return Pa}},{key:"onGrab",value:function(ta){var Pa=this,
Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress)return Pa.tree._dropInProgress=!0,Ha=Pa.target.globalPosition,Wa._get(Object.getPrototypeOf(Da.prototype),"onGrab",Pa).call(Pa,ta),Pa._data.globalTargetPosition=Ha,tb.yield(Pa.whenRendered(),2);if(Pa.tree.fullContainsWorldPoint(Pa.globalPosition))Pa.leftCenter=Jb.pt(-20,0);else Pa.onDragOutside();Pa.tree._dropInProgress=!1;tb.jumpToEnd()})}},{key:"onDragOutside",value:function(){this._draggedOutside||(this._draggedOutside=
!0,this.queue||(this.queue=Jb.fun.createQueue("container-hover-queue",function(ta,Pa){var Ha,tb,Ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){if(1==wb.nextAddress)return Ha=ta.target,tb=Ha.opacity,Ac=Ha.scale,ta.target.opacity=0,ta.target.scale=.5,$world.halos().forEach(function(ud){return ud.remove()}),$world.firstHand.grab(ta.target),ta.target._data=ta._data,ta.remove(),ta.target.position=Jb.pt(0,0),wb.yield(ta.target.animate({opacity:tb,scale:Ac,duration:200}),2);Pa();wb.jumpToEnd()})})),
this.queue.push(this))}},{key:"onChildAdded",value:function(ta){var Pa=this.node.children.indexOf(ta.node||ta._data)+1;Pa=this.node.children[Pa];ta.target.remove();Pa?(Pa=this.target.submorphs.indexOf(Pa.container.target),this.target.addMorphAt(ta.target,Pa)):this.target.addMorph(ta.target);ta._data.globalTargetPosition&&(ta.target.position=this.target.localize(ta._data.globalTargetPosition))}},{key:"onChildRemoved",value:function(ta){}},{key:"toggleConnectionControl",value:function(ta){this.getSubmorphNamed("connections label").visible=
ta}},{key:"toggleSelected",value:function(ta){var Pa=this,Ha,tb,Ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){if(1==wb.nextAddress)return Wa._get(Object.getPrototypeOf(Da.prototype),"toggleSelected",Pa).call(Pa,ta),Pa._active===ta?wb.return():(Pa._active=ta)&&Pa.target&&Pa.target.isMorph&&Pa.world()?wb.yield(Pa.target.whenRendered(),3):wb.jumpTo(0);Pa.get("inspector").targetObject=Pa.target;Pa.get("connections tree").inspectConnectionsOf(Pa.target);if(Pa.connectionHalo)return wb.return();
Ha=$jscomp.makeIterator(Pa.world().halos());for(tb=Ha.next();!tb.done;tb=Ha.next()){Ac=tb.value;if(Ac.target===Pa.target)return wb.return();Ac.remove()}Jb.noUpdate({sourceObj:Pa.world(),targetObj:Pa.sideBar,sourceAttribute:"showHaloFor",targetAttribute:"selectNode"},function(){return Pa.world().showHaloFor(Pa.target)});wb.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphContainer"}},{key:"properties",get:function(){return{fontFamily:{after:["submorphs"],derived:!0,
set:function(ta){this.submorphs[0].fontFamily=ta}},fontColor:{after:["submorphs"],derived:!0,set:function(ta){this.submorphs[0].fontColor=ta}},fontSize:{derived:!0,set:function(ta){this.submorphs[0].fontSize=ta}},target:{serialize:!1},dragTriggerDistance:{defaultValue:15},borderRadius:{defaultValue:4},nameNeedsUpdate:{derived:!0,get:function(){return!this.target||this.submorphs[0].textString.slice(2,-1)==this.target.name&&this.connectionCount==(this.target.attributeConnections||[]).length?!1:!0}},
grabbable:{defaultValue:!0},draggable:{defaultValue:!0},submorphs:{after:["target","tree"],initialize:function(){this.refresh()}},sideBar:{derived:!0,get:function(){return this.owner.owner}}}}}],ea,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1105"}}},{start:17483,end:25901})}(Jb.InteractiveTreeContainer);
Jb.MorphContainer=Sc;Jb.MorphContainer=Sc;Jb.MorphContainer=Sc;var Ra=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js");Ra.visualizeConnection=function(Ga,ea,Da,ta,Pa){ta=void 0===ta?{}:ta;Pa=Ra.rect(0).sides.concat(Ra.rect(0).corners);Da=Da||new Ra.Leash(Object.assign({isSmooth:!0,styleClasses:["Halo"],borderColor:Ra.Color.orange,epiMorph:!0,endpointStyle:{start:{fill:Ra.Color.transparent,nativeCursor:"auto"},end:{fill:Ra.Color.orange}}},ta,{hasFixedPosition:!0}));Da.startPoint.attachTo(Ga,
"rightCenter");ea.isMorph?(ta=ea.globalBounds().partNameNearest(Pa,Ga.globalPosition),Ga.globalPosition.equals(ea.globalBounds().partNamed(ta))&&ea.globalBounds().partNameNearest(Ra.arr.without(Pa,ta),Ga.globalPosition),Da.endPoint.attachTo(ea,"leftCenter")):(Pa=Ga.globalBounds().topRight().addPt(Ra.pt(100,0)),ea=Ra.morph({type:"label",value:ea.toString(),styleClasses:["Tooltip"],padding:Ra.rect(8,4)}).openInWorld(Pa),ea.position=Ga.world().bounds().translateForInclusion(ea.bounds()).topLeft(),Ra.once(Da,
"remove",ea,"remove"),Da.endPoint.attachTo(ea,"leftCenter"));return Da};Ra.startConnecting=function(Ga,ea){Ga.animate({opacity:.8,duration:300});Ga.startPoint.attachTo(ea,"center");Ga.vertices[0].position=Ra.pt(2,2)};Ra.stopConnecting=function(Ga,ea,Da,ta){function Pa(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){if(1==wb.nextAddress)return wb.yield(Ga.animate({opacity:0,duration:300}),2);Ga.startPoint.clearConnection();Ga.endPoint.clearConnection();Ga.remove();wb.jumpToEnd()})}
ta=void 0===ta?!1:ta;var Ha,tb,Ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){return 1==wb.nextAddress?(Ha=Ga,tb=Ha.endPoint,(Ac=tb.connectedMorph)&&"MorphContainer"==Ra.getClassName(Ac)&&(Ac=Ac.target),Ac?wb.yield(Ra.interactiveConnectGivenSourceAndTarget(Da,ta,Ac),2):wb.jumpTo(2)):wb.yield(Pa(),0)})};Ra.editConnection=function(Ga){var ea=Ga.connection,Da=Ga.connectionPoint,ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){if(1==Pa.nextAddress)return ta=Ra.visualizeConnection(Da,
ea.targetObj,!1,{borderColor:Ra.Color.gray.darker(),endpointStyle:{start:{fill:Ra.Color.transparent,nativeCursor:"auto"},end:{fill:Ra.Color.gray.darker()}}}),Pa.yield(Ra.interactivelyReEvaluateConnection(ea,"Edit Connection",!1),2);ta.remove();Pa.jumpToEnd()})};Ra.Tree=Ie;Ra.TreeData=fd;Ra.Icon=me;Ra.morph=yd;Ra.pt=ac;Ra.Rectangle=Yc;Ra.rect=Ic;Ra.Color=bd;Ra.arr=pd;Ra.connect=nd;Ra.signal=Ec;Ra.Leash=Ne;Ra.once=Ud;Ra.interactivelyReEvaluateConnection=Eb;Ra.interactiveConnectGivenSource=$a;Ra.interactiveConnectGivenSourceAndTarget=
$b;Ra.getClassName=Td;(function(Ga){var ea=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js"),Da=ea.hasOwnProperty("ConnectionsTreeData")&&"function"===typeof ea.ConnectionsTreeData?ea.ConnectionsTreeData:ea.ConnectionsTreeData=function(ta){ta&&ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Wa(Da,Ga,[{key:"parseMorphConnections",value:function(ta){for(var Pa={},Ha=$jscomp.makeIterator(void 0===ta.attributeConnections?
[]:ta.attributeConnections),tb=Ha.next();!tb.done;tb=Ha.next())tb=tb.value,tb.targetObj.isHalo||(Pa[tb.sourceAttrName]=Pa[tb.sourceAttrName]||[{name:["      New Connection  ",{fontColor:Ra.Color.white.withA(.5),fontStyle:"italic"},this.renderPin(ta,tb.sourceAttrName),{}]}],Ra.arr.pushAt(Pa[tb.sourceAttrName],{name:[].concat($jscomp.arrayFromIterable(this.renderExistingConnection(tb)))},0));return{children:Object.entries(Pa).map(function(Ac){var wb=$jscomp.makeIterator(Ac);Ac=wb.next().value;wb=wb.next().value;
return{name:[Ac,{fontWeight:"bold"}," ",{},Ra.morph({fill:Ra.Color.white,opacity:.7,value:""+(wb.length-1),borderRadius:15,fontWeight:"bold",padding:Ra.Rectangle.inset(5,0,5,0),type:"label"}),{paddingTop:"4px"}],children:wb}}).concat([{name:["New Connection  ",{fontColor:Ra.Color.white.withA(.5),fontStyle:"italic"},this.renderPin(ta),{}]}])}}},{key:"renderExistingConnection",value:function(ta){var Pa=this,Ha=Ra.morph({type:"label",fontColor:Ra.Color.gray,fontSize:16,nativeCursor:"pointer",value:[].concat($jscomp.arrayFromIterable(Ra.Icon.textAttribute("long-arrow-alt-right",
{paddingTop:"4px"})),["  ",{},ta.targetMethodName,{}])}),tb=this.renderDeadPin(),Ac=tb.submorphs[0];Ra.connect(Ha,"onHoverIn",function(){Ha.fontColor=Ra.Color.orange;Ha._leash=Ra.visualizeConnection(Ac,ta.targetObj,Ha._leash);Ac.fill=Ra.Color.orange;Ac.border={color:Ra.Color.orange,width:3}});Ra.connect(Ha,"onMouseDown",function(wb){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){if(1==ud.nextAddress)return wb.stop(),ud.yield(Ra.interactivelyReEvaluateConnection(ta),2);Ra.signal(Pa,
"refresh");ud.jumpToEnd()})});Ra.connect(Ha,"onHoverOut",function(){Ha.fontColor=Ra.Color.gray;Ac.fill=Ra.Color.gray;Ac.border={color:Ra.Color.white,width:1};Ha._leash.remove();Ha._leash=void 0});return[Ha,{},"  ",{}].concat($jscomp.arrayFromIterable(Ra.Icon.textAttribute("times",{nativeCursor:"pointer ",onMouseDown:function(){ta.disconnect();Ra.signal(Pa,"refresh")}})),["  ",{},tb,{}])}},{key:"renderDeadPin",value:function(){var ta=Ra.morph({type:"ellipse",fill:Ra.Color.gray,extent:Ra.pt(10,10),
center:Ra.pt(8,12),borderWidth:1});return Ra.morph({extent:Ra.pt(20,20),fill:Ra.Color.transparent,reactsToPointer:!1,submorphs:[ta]})}},{key:"renderPin",value:function(ta,Pa){var Ha=this,tb=Ra.morph({type:"ellipse",fill:Ra.Color.gray.withA(.5),extent:Ra.pt(10,10),center:Ra.pt(8,12),draggable:!1,borderWidth:1}),Ac=new Ra.Leash({opacity:0,styleClasses:["Halo"],isSmooth:!0,epiMorph:!0,hasFixedPosition:!0,borderColor:Ra.Color.gray.darker(),endpointStyle:{fill:Ra.Color.gray.darker()},position:Ra.pt(1,
1),vertices:[Ra.pt(0,0),Ra.pt(0,0)],getLabelFor:function(wb){return"MorphContainer"==Ra.getClassName(wb)?wb.target.name:wb.name},canConnectTo:function(wb){return"MorphContainer"==Ra.getClassName(wb)||2>Ra.arr.intersect([wb].concat($jscomp.arrayFromIterable(wb.ownerChain())),[tb].concat($jscomp.arrayFromIterable(tb.ownerChain()))).length}});tb.addMorph(Ac);Ra.connect(Ac.endPoint,"onDragStart",function(){Ra.startConnecting(Ac,tb)});Ra.connect(Ac.endPoint,"onDragEnd",function(wb){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){if(1==
ud.nextAddress)return tb.center=Ra.pt(8,12),ud.yield(Ra.stopConnecting(Ac,tb,ta,Pa),2);Ra.signal(Ha,"refresh");ud.jumpToEnd()})});return Ra.morph({extent:Ra.pt(20,20),fill:Ra.Color.transparent,reactsToPointer:!1,submorphs:[tb]})}},{key:"display",value:function(ta){return ta.name}},{key:"collapse",value:function(ta,Pa){ta.isCollapsed=Pa}},{key:"isCollapsed",value:function(ta){return ta.isCollapsed}},{key:"isLeaf",value:function(ta){return!ta.children}},{key:"getChildren",value:function(ta){return ta.children}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ConnectionsTreeData"}},{key:"for",value:function(ta){var Pa=new this;Pa.root=Pa.parseMorphConnections(ta);return Pa}}],ea,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ConnectionsTree",version:"0.1.1-16"}}},{start:3534,end:8251})})(Ra.TreeData);Sc=function(Ga){var ea=
lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js"),Da=ea.hasOwnProperty("ConnectionsTree")&&"function"===typeof ea.ConnectionsTree?ea.ConnectionsTree:ea.ConnectionsTree=function(ta){ta&&ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Wa(Da,Ga,[{key:"inspectConnectionsOf",value:function(ta){if(this.targetMorph=ta)this.treeData=Ra.ConnectionsTreeData.for(ta),Ra.connect(this.treeData,"refresh",this,"refresh")}},{key:"refresh",
value:function(){this.targetMorph&&(this.treeData=Ra.ConnectionsTreeData.for(this.targetMorph),Ra.connect(this.treeData,"refresh",this,"refresh"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ConnectionsTree"}},{key:"properties",get:function(){return{}}}],ea,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ConnectionsTree",
version:"0.1.1-16"}}},{start:8268,end:8821})}(Ra.Tree);Sc=Ra.ConnectionsTree;Ra.default=Sc}}});
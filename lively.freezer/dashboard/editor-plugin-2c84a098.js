System.register(["./__root_module__-37c88ebd.js","kld-intersections","./index-d63033cc.js","./index-9714fb53.js","./editor-plugin-4a930e6a.js"],function(Wa){var Ib,Sb,xc,ac,Cd,nd,Ud,bd,Ic,pd,yd,Ne,Pe,Ie,fd,me,Yb,Yc,Nd,gd,ae,Fe,Wb,Cc,Td;return{setters:[function(Ec){Ib=Ec.i;Sb=Ec.bI;xc=Ec.bJ;ac=Ec.bK;Cd=Ec.bL;nd=Ec.bM;Ud=Ec.d;bd=Ec.a1;Ic=Ec.c;pd=Ec.a6;yd=Ec.bz;Ne=Ec.b;Pe=Ec.a;Ie=Ec.bN;fd=Ec.a_},function(){},function(Ec){me=Ec.s},function(Ec){Yb=Ec.localInterface;Yc=Ec.systemInterfaceNamed;Nd=Ec.serverInterfaceFor;
gd=Ec.l2lInterfaceFor},function(Ec){ae=Ec.p;Fe=Ec.d;Wb=Ec.a;Cc=Ec.r;Td=Ec.C}],execute:function(){var Ec=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");Ec.warnStyle={"border-bottom":"2px dotted orange"};Ec.errorStyle={"background-color":"red"};var Vd=function(ec){var Xb=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),Jb=Xb.hasOwnProperty("JavaScriptChecker")&&"function"===typeof Xb.JavaScriptChecker?Xb.JavaScriptChecker:Xb.JavaScriptChecker=function(Ra){Ra&&Ra[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Jb,ec,[{key:"uninstall",value:function(Ra){var Ga=Ra.text||Ra;(Ga.markers||[]).forEach(function(ea){return ea.id.startsWith("js-checker-")&&Ga.removeMarker(ea)});Ga.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(Ra,Ga){return[].concat($jscomp.arrayFromIterable(Ra.embeddedMorphMap.values())).find(function(ea){return Ga.containsPosition(ea.anchor.position)})}},{key:"onDocumentChange",value:function(Ra,
Ga,ea){var Da=Ga.document;try{var ta=ea.parse()}catch(Pa){ta=Pa}ta&&(Ra=(Ga.markers||[]).filter(function(Pa){return Pa.id.startsWith("js-checker-")}),ea=ea.undeclaredVariables().map(function(Pa,Ha){var tb=Pa.start;Pa=Pa.end;tb=Da.indexToPosition(tb);Pa=Da.indexToPosition(Pa);return Ga.addMarker({id:"js-checker-"+Ha,style:Ec.warnStyle,range:{start:tb,end:Pa},type:"js-undeclared-var"})}),Ra.slice(ea.length).forEach(function(Pa){return Ga.removeMarker(Pa)}),ta.parseError?(Ra=ta.parseError.loc,ea=Ra.column,
Ra=Ra.line-1,ta=Da.indexToPosition(ta.parseError.pos),ea=ta.column,Ra=ta.row,ta={start:{column:ea-1,row:Ra},end:{column:ea+1,row:Ra}},this.hasEmbeddedMorphInRange(Ga,ta)||Ga.addMarker({id:"js-syntax-error",range:ta,style:Ec.errorStyle,type:"js-syntax-error"})):Ga.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],Xb,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),Lb=Vd=Ec.JavaScriptChecker;Ec.default=Vd;var ub=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");ub.query=Sb;ub.fuzzyParse=xc;ub.acorn=ac;ub.custom=Cd;ub.walk=nd;var uc=function(ec){var Xb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),Jb=Xb.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof Xb.JavaScriptNavigator?
Xb.JavaScriptNavigator:Xb.JavaScriptNavigator=function(Ra){Ra&&Ra[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Jb,ec,[{key:"ensureAST",value:function(Ra){return this.parse(Ra.textString)}},{key:"parse",value:function(Ra){return ub.fuzzyParse(Ra)}},{key:"move",value:function(Ra,Ga){var ea=!!Ga.activeMark||!Ga.selection.isEmpty(),Da=Ga.selection,ta=Ga.positionToIndex(Da.lead);Ra=this[Ra](Ga.textString,ta);Ra=Ga.indexToPosition(Ra);
Da.lead=Ra;ea||(Da.anchor=Ra);Ga.scrollCursorIntoView()}},{key:"forwardSexp",value:function(Ra){this.move("_forwardSexp",Ra)}},{key:"backwardSexp",value:function(Ra){this.move("_backwardSexp",Ra)}},{key:"backwardUpSexp",value:function(Ra){this.move("_backwardUpSexp",Ra)}},{key:"forwardDownSexp",value:function(Ra){this.move("_forwardDownSexp",Ra)}},{key:"_forwardSexp",value:function(Ra,Ga){Ra=this.parse(Ra);Ra=ub.custom.findNodesIncluding(Ra,Ga).reverse().find(function(Da){return Da.end!==Ga});if(!Ra)return Ga;
if("BlockStatement"===Ra.type){var ea=Ra.body.find(function(Da){return Da.start>Ga});if(ea)return ea.start}return Ra.end}},{key:"_backwardSexp",value:function(Ra,Ga){Ra=this.parse(Ra);Ra=ub.custom.findNodesIncluding(Ra,Ga).reverse().find(function(Da){return Da.start!==Ga});if(!Ra)return Ga;if("BlockStatement"===Ra.type){var ea=Ra.body.slice().reverse().find(function(Da){return Da.end<Ga});if(ea)return ea.end}return Ra?Ra.start:Ga}},{key:"_backwardUpSexp",value:function(Ra,Ga){Ra=this.parse(Ra);return(Ra=
ub.custom.findNodesIncluding(Ra,Ga).reverse().find(function(ea){return ea.start!==Ga}))?Ra.start:Ga}},{key:"_forwardDownSexp",value:function(Ra,Ga){Ra=this.parse(Ra);return(Ra=ub.walk.findNodeAfter(Ra,Ga,function(ea,Da){return Da.start>Ga}))?Ra.node.start:Ga}},{key:"markDefun",value:function(Ra){var Ga=this.rangeForFunctionOrDefinition(Ra.textString,[Ra.positionToIndex(Ra.selection.range.start),Ra.positionToIndex(Ra.selection.range.end)]);Ga&&Ra.execCommand("expandRegion",{start:Ga[0],end:Ga[1]})}},
{key:"rangeForNodesMatching",value:function(Ra,Ga,ea){Ra=this.parse(Ra);return(Ga=ub.custom.findNodesIncluding(Ra,Ga).reverse().find(ea))?[Ga.start,Ga.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(Ra,Ga){var ea=Ga[0]===Ga[1];return this.rangeForNodesMatching(Ra,Ga[1],function(Da){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(Da.type)&&(ea&&Da.end!==Ga[1]||!ea&&Da.start<Ga[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(Ra,
Ga){"number"!==typeof Ga&&(Ga=Ra.positionToIndex(Ga));Ra=this.ensureAST(Ra);var ea=ub.query.nodesAt(Ga,Ra).reverse(),Da=ea.find(function(Pa){return"Identifier"===Pa.type});if(!Da&&((ea=ea[0])&&ea.type.includes("Specifier")&&ea.local&&"Identifier"===ea.local.type&&(Da=ea.local),!Da))return;Ga=(ea=ub.query.findDeclarationClosestToIndex(Ra,Da.name,Ga))?ub.query.scopeAtIndex(Ra,ea.start):ub.query.scopeAtIndex(Ra,Ga);var ta=ub.query.findReferencesAndDeclsInScope(Ga,Da.name).refs;return{parsed:Ra,scope:Ga,
id:Da,name:Da.name,decl:ea,refs:ta}}},{key:"expandRegion",value:function(Ra,Ga,ea,Da){function ta(Ac){Ac=Ra.positionToIndex({column:0,row:Ha.row});return{range:[Ac+tb.start,Ac+tb.start+tb.value.length],prev:Da}}var Pa=Da.range[0]!==Da.range[1],Ha=Ra.indexToPosition(Da.range[0]),tb=Ra.tokenAt(Ha);if(!Pa&&tb&&["keyword","identifier"].includes(tb.type))return ta();ea=ea||this.parse(Ga);Ga=ub.query.nodesAtIndex(ea,Da.range[0]).reverse().find(function(Ac){return Ac.start<Da.range[0]||Ac.end>Da.range[1]});
if(!Ga)return Da;ea=Ga.start;Pa=Ga.end;return"Literal"===Ga.type&&(Ga.raw||"").match(/^['"`]/)&&Da.range[0]!==Ga.start&&Da.range[1]!==Ga.end&&(Ga.start+1<Da.range[0]||Ga.end-1>Da.range[1])?{range:[ea+1,Pa-1],prev:Da}:{range:[ea,Pa],prev:Da}}},{key:"contractRegion",value:function(Ra,Ga,ea,Da){return Da.prev||Da}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],Xb,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:127,end:6784})}(void 0);Vd=uc=ub.JavaScriptNavigator;ub.default=uc;var dc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");dc.addIndexToTextPos=function(ec,Xb,Jb){return ec.indexToPosition(ec.positionToIndex(Xb)+Jb)};dc.connect=Ud;dc.disconnect=bd;dc.string=Ic;dc.KeyHandler=pd;dc.Range=yd;uc=function(ec){var Xb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),
Jb=Xb.hasOwnProperty("Snippet")&&"function"===typeof Xb.Snippet?Xb.Snippet:Xb.Snippet=function(Ra){Ra&&Ra[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Jb,ec,[{key:Symbol.for("lively-instance-initialize"),value:function(Ra){Ra=void 0===Ra?{trigger:null,expansion:""}:Ra;var Ga=Ra.expansion;this.trigger=Ra.trigger;this.expansion=Ga;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(Ra){this.isExpanding&&
(this.textMorph=Ra,dc.connect(this.textMorph,"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(Ra){this.isExpanding&&(dc.disconnect(Ra,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var Ra=this.expansionState,Ga=Ra.startAnchor,ea=Ra.endAnchor;Ra.isExpanding?dc.Range.fromPositions(Ga.position,ea.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",
value:function(){var Ra=this.textMorph;if(Ra){var Ga=this.expansionState||{},ea=Ga.marker,Da=Ga.startAnchor,ta=Ga.endAnchor;Ga=Ga.steps;Da&&Ra.removeAnchor(Da);ta&&Ra.removeAnchor(ta);ea&&Ra.removeMarker(ea);Ga.forEach(function(Pa){return Ra.removeAnchor(Pa.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};Ra&&Ra.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(Ra){var Ga=
[],ea=0;dc.string.reMatches(Ra,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(Da){var ta=Da.start,Pa=Da.end;Da=Da.match;var Ha="";Da.startsWith("${")?(Ha=$jscomp.makeIterator(Da.match(/^\$\{([0-9]+):([^\}]*)\}/)),Ha.next(),Da=Ha.next().value,Ha=Ha.next().value,Da=Number(Da)):Da=Number(Da.replace(/^\$/,""));Ra=Ra.slice(0,ta-ea)+Ha+Ra.slice(Pa-ea);Ga[Da]={index:ta-ea,prefill:Ha,anchor:null};ea+=Pa-ta-Ha.length});return{steps:Ga,expansion:Ra}}},{key:"expandAtCursor",value:function(Ra){var Ga=Ra.selection,
ea=Ra.cursorPosition.column,Da=this.expansion;this.trigger&&(ea-=this.trigger.length);if(ea=Math.max(0,ea))Da=dc.string.lines(Da),Da=[Da[0]].concat($jscomp.arrayFromIterable(Da.slice(1).map(function(wb){return dc.string.indent(wb," ",ea)}))),Da=Da.join("\n");var ta=this.createExpansionSteps(Da);Da=ta.expansion;ta=ta.steps;this.trigger&&Ga.growLeft(this.trigger.length);Ga.text=Da;var Pa=Ga.start;Da=Ga.end;Ga.collapseToEnd();if(ta.length){var Ha=dc.string.newUUID();ta.forEach(function(wb,ud){return wb.anchor=
Ra.addAnchor(Object.assign({id:"snippet-step-"+ud+"-"+Ha},dc.addIndexToTextPos(Ra,Pa,wb.index)))});var tb=Ra.addAnchor(Object.assign({id:"snippet-start-"+Ha},Pa,{insertBehavior:"stay"})),Ac=Ra.addAnchor(Object.assign({id:"snippet-end-"+Ha},Da));this.expansionState={marker:Ra.addMarker({id:"snippet-marker-"+Ha,get range(){return{start:tb.position,end:Ac.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",
content:"fooooo"}}),startAnchor:tb,endAnchor:Ac,stepIndex:0,steps:ta,isExpanding:!0};Ra.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var Ra=this.expansionState,Ga=Ra.steps,ea=this.textMorph;if(Ra.isExpanding&&ea){ea=ea.selection;Ra=Ga[Ra.stepIndex];var Da=Ra.prefill;ea.lead=ea.anchor=Ra.anchor.position;ea.growRight(Da.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=Ga.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+
" done"))}}},{key:"canExpand",value:function(Ra,Ga){Ga=Ra.positionToIndex(Ra.cursorPosition);return Ra.textString.slice(Ga-this.trigger.length,Ga)===this.trigger}},{key:"tryTrigger",value:function(Ra,Ga){if(!this.canExpand(Ra,Ra.cursorPosition))return!1;this.expandAtCursor(Ra);return!0}},{key:"getCommands",value:function(Ra){var Ga=this;return Ra.concat([{name:"[snippet] next expansion step",exec:function(ea){Ga.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(ea){Ga.resetExpansionState();
return!0}}])}},{key:"getKeyHandlers",value:function(Ra){return Ra.concat(dc.KeyHandler.withBindings([{keys:"Tab",command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],Xb,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:357,end:6029})}(void 0);dc.Snippet=uc;dc.Snippet=uc;dc.Snippet=uc;var Zb=[{name:"get snippets",exec:function(ec){return ec.pluginCollect("getSnippets",[])}}];dc.snippetCommands=Zb;dc.snippetCommands=Zb;dc.snippetCommands=Zb;var Mc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");Mc.buildEvalOpts=function(ec,Xb){return ec.plugins.find(function(Jb){return Jb.isJSEditorPlugin}).sanatizedJsEnv(Xb)};Mc.Snippet=uc;Zb=function(ec){var Xb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),
Jb=Xb.hasOwnProperty("ModuleTopLevelVarCompleter")&&"function"===typeof Xb.ModuleTopLevelVarCompleter?Xb.ModuleTopLevelVarCompleter:Xb.ModuleTopLevelVarCompleter=function(Ra){Ra&&Ra[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Jb,ec,[{key:"compute",value:function(Ra,Ga){var ea,Da,ta,Pa,Ha,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ac){if(1==Ac.nextAddress){Da=(ea=Ra.pluginFind(function(wb){return wb.isJSEditorPlugin}))&&
ea.systemInterface();if(!Da)return Ac.return([]);ta=Mc.buildEvalOpts(Ra);Pa=ta.targetModule;return"local"===Da.name?(Ha=Object.getOwnPropertyNames(Da.getModule(Pa).recorder),Ac.jumpTo(2)):Ac.yield(Da.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+
Pa+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',{targetModule:"lively://module-recorder-completer"}),3)}if(2!=Ac.nextAddress){tb=Ac.yieldResult;if(tb.isError)return Ac.return([]);Ha=JSON.parse(tb.value)}Ha=Ha.filter(function(wb){return!wb.startsWith("defVar_")&&!["System","__currentLivelyModule",
"initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(wb)});return Ac.return(Ha.map(function(wb){return{priority:1100,completion:wb}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],Xb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:227,end:1700})}(void 0);Mc.ModuleTopLevelVarCompleter=Zb;Mc.ModuleTopLevelVarCompleter=Zb;Mc.ModuleTopLevelVarCompleter=Zb;Zb=function(ec){var Xb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Jb=Xb.hasOwnProperty("DynamicJavaScriptCompleter")&&"function"===typeof Xb.DynamicJavaScriptCompleter?Xb.DynamicJavaScriptCompleter:Xb.DynamicJavaScriptCompleter=function(Ra){Ra&&Ra[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Ib(Jb,ec,[{key:"isValidPrefix",value:function(Ra){return/\.[a-z0-9_]*$/i.test(Ra)}},{key:"isMethodCallCompletion",value:function(Ra){return Ra.endsWith(")")&&0<Ra.indexOf("(")}},{key:"isValidIdentifier",value:function(Ra){if("string"!==typeof Ra)return!1;this.isMethodCallCompletion(Ra)&&(Ra=Ra.slice(0,Ra.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(Ra)?!0:!1}},{key:"wrapInBrackets",value:function(Ra){if(!isNaN(Number(Ra))||Ra.startsWith("Symbol."))return"["+Ra+"]";var Ga="";this.isMethodCallCompletion(Ra)&&
(Ga=Ra.slice(Ra.indexOf("(")),Ra=Ra.slice(0,Ra.indexOf("(")));return'["'+Ra.replace(/"/g,'\\"')+'"]'+Ga}},{key:"compute",value:function(Ra){var Ga=this,ea,Da,ta,Pa,Ha,tb,Ac,wb,ud,Tb,te;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cd){if(1==cd.nextAddress){ea=Ra.selection;ea.isEmpty()?(Da=Ra.getLine(ea.lead.row),Da=Da.slice(Da.lastIndexOf(":")+1,ea.lead.column)):Da=ea.text.slice(Math.max(0,ea.text.indexOf(":")),0);if(!Ga.isValidPrefix(Da))return cd.return([]);Pa=(ta=Ra.pluginFind(function(Lc){return Lc.isJSEditorPlugin}))&&
ta.systemInterface();if(!Pa)return cd.return([]);Ha=Mc.buildEvalOpts(Ra);return cd.yield(Pa.dynamicCompletionsForPrefix(Ha.targetModule,Da,Ha),2)}tb=cd.yieldResult;Ac=tb.isError;wb=tb.value;ud=tb.completions;Tb=tb.prefix;if(Ac)return console.warn("javascript completer encountered error: "+(wb.stack||wb)),cd.return([]);ud.reduce(function(Lc,Hb){Hb=$jscomp.makeIterator(Hb);Hb.next();Hb=Hb.next().value;return Lc+Hb.length},0);te=ud.reduce(function(Lc,Hb,Be){Hb=$jscomp.makeIterator(Hb);var Ob=Hb.next().value;
Hb=Hb.next().value;return Lc.concat(Hb.map(function(Gb){var Ta=Ga.isValidIdentifier(Gb);return{info:Ob,completion:Gb,prefix:Ta?Tb:"."+Tb,customInsertionFn:Ta?Ga.isMethodCallCompletion(Gb)?function(Y,Ma,gb,Nb){Ma=Nb.start;Nb=Nb.end;Y=Y.replace(/\((.*)\)/,function(oc){return"("+oc.slice(1,-1).split(", ").map(function(Wc,Gc){return"${"+Gc+":"+Wc+"}"}).join(", ")+")"});Y=new Mc.Snippet({expansion:Y});gb.replace({start:Ma,end:Nb},"");Y.expandAtCursor(gb)}:null:function(Y,Ma,gb,Nb){Y=Nb.start;Nb=Nb.end;
Ma={row:Y.row,column:Y.column-1};Nb="."===gb.textInRange({start:Ma,end:Y})?{start:Ma,end:Nb}:{start:Y,end:Nb};gb.replace(Nb,Ga.wrapInBrackets(Gb))}}}))},[]);te.forEach(function(Lc,Hb){return Object.assign(Lc,{priority:2E3+te.length-Hb})});return cd.return(te)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DynamicJavaScriptCompleter"}}],Xb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5155})}(void 0);Mc.DynamicJavaScriptCompleter=Zb;Mc.DynamicJavaScriptCompleter=Zb;Mc.DynamicJavaScriptCompleter=Zb;Mc.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
Zb=function(ec){var Xb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Jb=Xb.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof Xb.JavaScriptKeywordCompleter?Xb.JavaScriptKeywordCompleter:Xb.JavaScriptKeywordCompleter=function(Ra){Ra&&Ra[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Jb,ec,[{key:"compute",value:function(Ra,Ga){return Mc.keywords.map(function(ea){return{completion:ea,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],Xb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6157,end:6295})}(void 0);Mc.JavaScriptKeywordCompleter=Zb;Mc.JavaScriptKeywordCompleter=Zb;Mc.JavaScriptKeywordCompleter=Zb;Zb=[new Mc.DynamicJavaScriptCompleter,
new Mc.JavaScriptKeywordCompleter,new Mc.ModuleTopLevelVarCompleter];Mc.completers=Zb;Mc.completers=Zb;Mc.completers=Zb;var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");$a.Snippet=uc;var $b=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];$a.snippets=$b;$a.snippets=$b;$a.snippets=$b;var Eb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");Eb.getEvalEnv=function(ec){return(ec=ec.pluginFind(function(Xb){return Xb.isJSEditorPlugin}))?ec.evalEnvironment:null};Eb.setEvalEnv=function(ec,Xb){(ec=ec.pluginFind(function(Jb){return Jb.isJSEditorPlugin}))&&Object.assign(ec.evalEnvironment,Xb);return ec.evalEnvironment};
Eb.pToI=function(ec,Xb){return ec.positionToIndex(Xb)};Eb.iToP=function(ec,Xb){return ec.indexToPosition(Xb)};Eb.arr=Ne;Eb.promise=Pe;Eb.string=Ic;Eb.show=me;Eb.Range=yd;Eb.query=Sb;Eb.BaseVisitor=Ie;$a=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(ec,Xb){Xb=void 0===Xb?{varName:null,position:null}:Xb;var Jb,Ra,Ga,ea,Da,ta,Pa,Ha,tb,Ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){switch(wb.nextAddress){case 1:Jb=
Xb;Ra=Jb.varName;Ga=Jb.position;if(!Ra){Ga||(Ga=ec.cursorPosition);ea=ec.pluginInvokeFirst("getNavigator");Da=ea.ensureAST(ec);ta=Eb.query.nodesAt(ec.positionToIndex(Ga),Da).reverse().find(function(ud){return"Identifier"===ud.type});if(!ta)return ec.showError(Error("no identifier found!")),wb.return(!0);Ra=ta.name}Xb=ec.pluginFind(function(ud){return ud.isJSEditorPlugin}).sanatizedJsEnv();Pa='lively.modules.module("'+Xb.targetModule+'").undefine("'+Ra+'")';wb.setCatchFinallyBlocks(2);return wb.yield(ec.doEval(null,
Xb,Pa),4);case 4:Ha=wb.yieldResult;tb=Ha.error?Ha.error:Ha.isError?Ha.value:null;wb.leaveTryBlock(3);break;case 2:tb=Ac=wb.enterCatchBlock();case 3:return tb?ec.showError(tb):ec.setStatusMessage(Ra+" undefined"),wb.return(!0)}})}},{name:"change doitContext",exec:function(ec){var Xb,Jb,Ra,Ga,ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){if(1==Da.nextAddress)return Xb=$jscomp,Jb=Xb.makeIterator,Da.yield(ec.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(ta){return!ta.isUsedAsEpiMorph()}}),2);Ra=Jb.call(Xb,Da.yieldResult);if(Ga=Ra.next().value)ea="reset"===Ga,ec.doitContext=ea?null:Ga,ec.setStatusMessage(ea?"doitContext is now\n"+Ga:"doitContext reset");return Da.return(!0)})}},{name:"change eval backend",exec:function(ec,Xb){Xb=void 0===Xb?{backend:void 0}:Xb;var Jb,Ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){if(1==Ga.nextAddress)return Jb=Xb,Ra=Jb.backend,void 0!==Ra?
Ga.jumpTo(2):Ga.yield(ec.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=Ga.nextAddress&&(Ra=Ga.yieldResult,!Ra))return ec.setStatusMessage("Canceled"),Ga.return(!0);"local"===Ra&&(Ra=null);ec.setStatusMessage("Eval backend is now "+(Ra||"local"));return Ga.return(Eb.setEvalEnv(ec,{remote:Ra}))})}},{name:"copy current module name to clipboard",exec:function(ec){var Xb=ec.evalEnvironment.targetModule;ec.setStatusMessage(Xb||"Cannot find module name");ec.env.eventDispatcher.killRing.add(ec);
ec.env.eventDispatcher.doCopy(Xb);return!0}}];Eb.jsEditorCommands=$a;Eb.jsEditorCommands=$a;Eb.jsEditorCommands=$a;var kc=[{name:"[javascript] list errors and warnings",exec:function(ec){var Xb,Jb,Ra,Ga,ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){if(1==Da.nextAddress){Xb=(ec.markers||[]).filter(function(ta){ta=ta.type;return"js-undeclared-var"===ta||"js-syntax-error"===ta});if(!Xb.length)return Eb.show("no warnings or errors"),Da.return(!0);Jb=Xb.map(function(ta){var Pa=ta.range;
return{isListItem:!0,string:"["+ta.type.split("-").slice(1).join(" ")+"] "+ec.textInRange(Pa),value:Pa}});return Da.yield(ec.world().filterableListPrompt("jump to warning or error",Jb),2)}Ra=Da.yieldResult;Ga=$jscomp.makeIterator(Ra.selected);if(ea=Ga.next().value)ec.saveMark(),ec.selection=ea,ec.centerRow(ea.start.row);return Da.return(!0)})}},{name:"[javascript] inject import",exec:function(ec,Xb){Xb=void 0===Xb?{gotoImport:!1,insertImportAtCursor:!0}:Xb;var Jb,Ra,Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){switch(ea.nextAddress){case 1:return ea.yield(Eb.promise.delay(0),
2);case 2:return ea.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return Jb=ea.yieldResult,Ra=Jb.interactivelyInjectImportIntoText,ea.yield(Ra(ec,Xb),4);case 4:return(Ga=ea.yieldResult)||ec.setStatusMessage("canceled"),ea.return(Ga)}})}},{name:"[javascript] fix undeclared variables",exec:function(ec,Xb){Xb=void 0===Xb?{ignore:[],autoApplyIfSingleChoice:!1,requester:ec}:Xb;var Jb,Ra,Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){if(1==ea.nextAddress)return ea.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=ea.nextAddress)return Jb=ea.yieldResult,Ra=Jb.interactivlyFixUndeclaredVariables,ea.yield(Ra(ec,Xb),3);Ga=ea.yieldResult;ec.focus();return ea.return(Ga)})}},{name:"[javascript] remove unused imports",exec:function(ec,Xb){Xb=void 0===Xb?{query:!0}:Xb;var Jb,Ra,Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){if(1==ea.nextAddress)return ea.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=ea.nextAddress)return Jb=ea.yieldResult,Ra=Jb.cleanupUnusedImports,ea.yield(Ra(ec,
Xb),3);Ga=ea.yieldResult;ec.setStatusMessage(Ga);return ea.return(!0)})}},{name:"[javascript] eslint report",exec:function(ec){var Xb,Jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ra){if(1==Ra.nextAddress)return Ra.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);Xb=Ra.yieldResult;Jb=Xb.default;try{return Ra.return(Jb.reportOnMorph(ec))}catch(Ga){ec.showError(Ga)}Ra.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(ec){var Xb,Jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ra){if(1==
Ra.nextAddress)return Ra.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);Xb=Ra.yieldResult;Jb=Xb.default;try{return Ra.return(Jb.previewFixesOnMorph(ec))}catch(Ga){ec.showError(Ga)}Ra.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(ec,Xb,Jb){function Ra(cd,Lc){Lc||(Lc=Ha(cd,{allowReturnOutsideFunction:!0}));var Hb=Eb.string.lineRanges(cd),Be=cd.split("\n"),Ob=[],Gb=new Eb.BaseVisitor,Ta=Gb.visitVariableDeclaration;Gb.visitVariableDeclaration=
function(Nb,oc,Wc){if(1<Nb.declarations.length)for(var Gc=Eb.string.findLineWithIndexInLineRanges(Hb,Nb.start),Zd=Nb.declarations[0].start-Hb[Gc][0],je={},Bf=1;Bf<Nb.declarations.length;je={$jscomp$loop$prop$actionType$2854:je.$jscomp$loop$prop$actionType$2854,$jscomp$loop$prop$arg$2855:je.$jscomp$loop$prop$arg$2855},Bf++){var lf=Nb.declarations[Bf],bf=Eb.string.findLineWithIndexInLineRanges(Hb,lf.start);if(Gc!==bf){var z=Be[bf].match(/\s*/)[0].length;z=Zd-z;0!==z&&(lf=Eb.string.findLineWithIndexInLineRanges(Hb,
lf.end),je.$jscomp$loop$prop$actionType$2854=0<z?"insert":"delete",je.$jscomp$loop$prop$arg$2855=0<z?" ".repeat(z):-z,Ob.push.apply(Ob,$jscomp.arrayFromIterable(Eb.arr.range(bf,lf).map(function(pf){return function(nf){return[pf.$jscomp$loop$prop$actionType$2854,Hb[nf][0],pf.$jscomp$loop$prop$arg$2855]}}(je)))))}}return Ta.call(Gb,Nb,oc,Wc)};Gb.accept(Lc,{},[]);for(Lc=Ob.length;Lc--;){var Y=$jscomp.makeIterator(Ob[Lc]),Ma=Y.next().value,gb=Y.next().value;Y=Y.next().value;"insert"===Ma?cd=cd.slice(0,
gb)+Y+cd.slice(gb):"delete"===Ma&&(cd=cd.slice(0,gb)+cd.slice(gb+Y))}return cd}var Ga,ea,Da,ta,Pa,Ha,tb,Ac,wb,ud,Tb,te;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cd){switch(cd.nextAddress){case 1:return Ga=Jb||Math.floor(ec.width/ec.defaultCharExtent().width),Xb=Object.assign({printWidth:Ga,tabWidth:2,useTabs:!1,bracketSpacing:!1},Xb),ea=lively.modules.module,Da=System.normalizeSync("prettier/standalone.js"),cd.yield(ea(Da).load({format:"global",instrument:!1}),2);case 2:return ta=
cd.yieldResult,cd.yield(ea("lively.ast/lib/acorn-extension.js").load(),3);case 3:return cd.yield(ea("lively.ast").load(),4);case 4:return Pa=cd.yieldResult,Ha=Pa.parse,cd.yield(ea("lively.ast/lib/query.js").load(),5);case 5:return cd.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return tb=cd.yieldResult,Ac=ec.selection.isEmpty()?ec.documentRange:ec.selection.range,wb=ec.positionToIndex(Ac.start),ud=ec.positionToIndex(Ac.end),Tb=ta.format(ec.textString,Object.assign({},
Xb,{rangeStart:wb,rangeEnd:ud,parser:function(Lc,Hb,Be){return Ha(Lc,{allowReturnOutsideFunction:!0})}})),ec.undoManager.group(),te=tb.diffChars(ec.textString,Tb),ec.applyJsDiffPatch(te),ec.selection.text=Ra(ec.selection.text),ec.undoManager.group(),cd.return(!0)}})}}];Eb.jsIdeCommands=kc;Eb.jsIdeCommands=kc;Eb.jsIdeCommands=kc;var tc=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(ec,Xb){Xb=ec.pluginInvokeFirst("getNavigator");if(!Xb)return!0;Xb=Xb.resolveIdentifierAt(ec,ec.cursorPosition);
if(!Xb||!Xb.id)return Eb.show("No symbol identifier selected"),!0;if(!Xb.decl)return Eb.show("Cannot find declaration of "+Xb.name),!0;ec.saveMark();ec.selection={start:ec.indexToPosition(Xb.decl.start),end:ec.indexToPosition(Xb.decl.end)};ec.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(ec){ec.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(ec){ec.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(ec,Xb){Xb=void 0===Xb?{direction:null}:Xb;var Jb=ec.pluginInvokeFirst("getNavigator");if(!Jb)return!0;Jb=Jb.resolveIdentifierAt(ec,
ec.cursorPosition);if(!Jb||!Jb.refs)return Eb.show("No symbol identifier selected"),!0;var Ra=ec.selection;Jb=Jb.refs.map(function(ea){var Da=ea.end;return Eb.Range.fromPositions(Eb.iToP(ec,ea.start),Eb.iToP(ec,Da))}).concat(Jb.decl?Eb.Range.fromPositions(Eb.iToP(ec,Jb.decl.start),Eb.iToP(ec,Jb.decl.end)):[]).sort(Eb.Range.compare);if(!Jb.length)return!0;var Ga=Jb.map(String).indexOf(String(Ra.range));if("next"===Xb.direction||"prev"===Xb.direction)-1===Ga&&Jb.length?Jb=[Jb[0]]:(Xb=Ga+("next"===Xb.direction?
1:-1),0>Xb?Xb=Jb.length-1:Xb>=Jb.length&&(Xb=0),Jb=[Jb[Xb]]);Jb.forEach(function(ea){var Da=Ra.selections.findIndex(function(Pa){return Pa.range.equals(ea)}),ta=Ra.selections.length-1;-1<Da?Eb.arr.swap(Ra.selections,Da,ta):Ra.addRange(ea,!1)});Ra.mergeSelections();return!0}}];Eb.astEditorCommands=tc;Eb.astEditorCommands=tc;Eb.astEditorCommands=tc;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var Sc=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
Sc.expressionAllowed=function(ec,Xb,Jb){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(Xb.lastType)||"quasi"==Xb.lastType&&/\{\s*$/.test(ec.string.slice(0,ec.pos-(Jb||0)))};Sc.passIndent=ae;Sc.defineMode=Fe;Sc.defineMIME=Wb;Sc.registerHelper=Cc;Sc.defaultConfig={indentUnit:2};Sc.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};Sc.defineMode("javascript",
function(ec,Xb){function Jb(mc,vd,ee){Rg=mc;ah=ee;return vd}function Ra(mc,vd){var ee=mc.next();if('"'==ee||"'"==ee)return vd.tokenize=Ga(ee),vd.tokenize(mc,vd);if("."==ee&&mc.match(/^\d+(?:[eE][+\-]?\d+)?/))return Jb("number","number");if("."==ee&&mc.match(".."))return Jb("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(ee))return Jb(ee);if("="==ee&&mc.eat(">"))return Jb("=>","operator");if("0"==ee&&mc.eat(/x/i))return mc.eatWhile(/[\da-f]/i),Jb("number","number");if("0"==ee&&mc.eat(/o/i))return mc.eatWhile(/[0-7]/i),
Jb("number","number");if("0"==ee&&mc.eat(/b/i))return mc.eatWhile(/[01]/i),Jb("number","number");if(/\d/.test(ee))return mc.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),Jb("number","number");if("/"==ee){if(mc.eat("*"))return vd.tokenize=ea,ea(mc,vd);if(mc.eat("/"))return mc.skipToEnd(),Jb("comment","comment");if(Sc.expressionAllowed(mc,vd,1)){a:for(var ye=vd=!1;null!=(ee=mc.next());){if(!vd){if("/"==ee&&!ye)break a;"["==ee?ye=!0:ye&&"]"==ee&&(ye=!1)}vd=!vd&&"\\"==ee}mc.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return Jb("regexp","string-2")}mc.eatWhile(Kf);return Jb("operator","operator",mc.current())}if("`"==ee)return vd.tokenize=Da,Da(mc,vd);if("#"==ee)return mc.skipToEnd(),Jb("error","error");if(Kf.test(ee))return">"==ee&&vd.lexical&&">"==vd.lexical.type||mc.eatWhile(Kf),Jb("operator","operator",mc.current());if(Hi.test(ee))return mc.eatWhile(Hi),mc=mc.current(),(ee=Mi.propertyIsEnumerable(mc)&&Mi[mc])&&"."!=vd.lastType?Jb(ee.type,ee.style,mc):Jb("variable","variable",mc)}function Ga(mc){return function(vd,
ee){var ye=!1,jg;if($g&&"@"==vd.peek()&&vd.match(Ui))return ee.tokenize=Ra,Jb("jsonld-keyword","meta");for(;null!=(jg=vd.next())&&(jg!=mc||ye);)ye=!ye&&"\\"==jg;ye||(ee.tokenize=Ra);return Jb("string","string")}}function ea(mc,vd){for(var ee=!1,ye;ye=mc.next();){if("/"==ye&&ee){vd.tokenize=Ra;break}ee="*"==ye}return Jb("comment","comment")}function Da(mc,vd){for(var ee=!1,ye;null!=(ye=mc.next());){if(!ee&&("`"==ye||"$"==ye&&mc.eat("{"))){vd.tokenize=Ra;break}ee=!ee&&"\\"==ye}return Jb("quasi","string-2",
mc.current())}function ta(mc,vd){vd.fatArrowAt&&(vd.fatArrowAt=null);var ee=mc.string.indexOf("=>",mc.start);if(!(0>ee)){if(Qg){var ye=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(mc.string.slice(mc.start,ee));ye&&(ee=ye.index)}ye=0;var jg=!1;for(--ee;0<=ee;--ee){var mg=mc.string.charAt(ee),Ah="([{}])".indexOf(mg);if(0<=Ah&&3>Ah){if(!ye){++ee;break}if(0==--ye){"("==mg&&(jg=!0);break}}else if(3<=Ah&&6>Ah)++ye;else if(Hi.test(mg))jg=!0;else{if(/["'\/]/.test(mg))return;if(jg&&!ye){++ee;break}}}jg&&
!ye&&(vd.fatArrowAt=ee)}}function Pa(mc,vd,ee,ye,jg,mg){this.indented=mc;this.column=vd;this.type=ee;this.prev=jg;this.info=mg;null!=ye&&(this.align=ye)}function Ha(){for(var mc=arguments.length-1;0<=mc;mc--)rf.cc.push(arguments[mc])}function tb(){Ha.apply(null,arguments);return!0}function Ac(mc){function vd(ye){for(;ye;ye=ye.next)if(ye.name==mc)return!0;return!1}var ee=rf.state;rf.marked="def";ee.context?vd(ee.localVars)||(ee.localVars={name:mc,next:ee.localVars}):!vd(ee.globalVars)&&Xb.globalVars&&
(ee.globalVars={name:mc,next:ee.globalVars})}function wb(){rf.state.context={prev:rf.state.context,vars:rf.state.localVars};rf.state.localVars=aj}function ud(){rf.state.localVars=rf.state.context.vars;rf.state.context=rf.state.context.prev}function Tb(mc,vd){var ee=function(){var ye=rf.state,jg=ye.indented;if("stat"==ye.lexical.type)jg=ye.lexical.indented;else for(var mg=ye.lexical;mg&&")"==mg.type&&mg.align;mg=mg.prev)jg=mg.indented;ye.lexical=new Pa(jg,rf.stream.column(),mc,null,ye.lexical,vd)};
ee.lex=!0;return ee}function te(){var mc=rf.state;mc.lexical.prev&&(")"==mc.lexical.type&&(mc.indented=mc.lexical.indented),mc.lexical=mc.lexical.prev)}function cd(mc){function vd(ee){return ee==mc?tb():";"==mc?Ha():tb(vd)}return vd}function Lc(mc,vd){return"var"==mc?tb(Tb("vardef",vd.length),ph,cd(";"),te):"keyword a"==mc?tb(Tb("form"),Ob,Lc,te):"keyword b"==mc?tb(Tb("form"),Lc,te):"{"==mc?tb(Tb("}"),Rf,te):";"==mc?tb():"if"==mc?("else"==rf.state.lexical.info&&rf.state.cc[rf.state.cc.length-1]==
te&&rf.state.cc.pop()(),tb(Tb("form"),Ob,Lc,te,Ba)):"function"==mc?tb(Ua):"for"==mc?tb(Tb("form"),Ja,Lc,te):"variable"==mc?Qg&&"type"==vd?(rf.marked="keyword",tb(dg,cd("operator"),dg,cd(";"))):tb(Tb("stat"),lf):"switch"==mc?tb(Tb("form"),Ob,cd("{"),Tb("}","switch"),Rf,te,te):"case"==mc?tb(Hb,cd(":")):"default"==mc?tb(cd(":")):"catch"==mc?tb(Tb("form"),wb,cd("("),mb,cd(")"),Lc,te,ud):"class"==mc?tb(Tb("form"),yc,te):"export"==mc?tb(Tb("stat"),Ld,te):"import"==mc?tb(Tb("stat"),af,te):"module"==mc?tb(Tb("form"),
id,cd("{"),Tb("}"),Rf,te,te):"async"==mc?tb(Lc):"@"==vd?tb(Hb,Lc):Ha(Tb("stat"),Hb,cd(";"),te)}function Hb(mc){return Gb(mc,!1)}function Be(mc){return Gb(mc,!0)}function Ob(mc){return"("!=mc?Ha():tb(Tb(")"),Hb,cd(")"),te)}function Gb(mc,vd){if(rf.state.fatArrowAt==rf.stream.start){var ee=vd?Gc:Wc;if("("==mc)return tb(wb,Tb(")"),De(id,")"),te,cd("=>"),ee,ud);if("variable"==mc)return Ha(wb,id,cd("=>"),ee,ud)}ee=vd?gb:Ma;return ci.hasOwnProperty(mc)?tb(ee):"function"==mc?tb(Ua,ee):"class"==mc?tb(Tb("form"),
Ub,te):"keyword c"==mc||"async"==mc?tb(vd?Y:Ta):"("==mc?tb(Tb(")"),Ta,cd(")"),te,ee):"operator"==mc||"spread"==mc?tb(vd?Be:Hb):"["==mc?tb(Tb("]"),Pf,te,ee):"{"==mc?Cf(z,"}",null,ee):"quasi"==mc?Ha(Nb,ee):"new"==mc?tb(Zd(vd)):tb()}function Ta(mc){return mc.match(/[;\}\)\],]/)?Ha():Ha(Hb)}function Y(mc){return mc.match(/[;\}\)\],]/)?Ha():Ha(Be)}function Ma(mc,vd){return","==mc?tb(Hb):gb(mc,vd,!1)}function gb(mc,vd,ee){var ye=0==ee?Ma:gb,jg=0==ee?Hb:Be;if("=>"==mc)return tb(wb,ee?Gc:Wc,ud);if("operator"==
mc)return/\+\+|--/.test(vd)?tb(ye):"?"==vd?tb(Hb,cd(":"),jg):tb(jg);if("quasi"==mc)return Ha(Nb,ye);if(";"!=mc){if("("==mc)return Cf(Be,")","call",ye);if("."==mc)return tb(bf,ye);if("["==mc)return tb(Tb("]"),Ta,cd("]"),te,ye)}}function Nb(mc,vd){return"quasi"!=mc?Ha():"${"!=vd.slice(vd.length-2)?tb(Nb):tb(Hb,oc)}function oc(mc){if("}"==mc)return rf.marked="string-2",rf.state.tokenize=Da,tb(Nb)}function Wc(mc){ta(rf.stream,rf.state);return Ha("{"==mc?Lc:Hb)}function Gc(mc){ta(rf.stream,rf.state);return Ha("{"==
mc?Lc:Be)}function Zd(mc){return function(vd){return"."==vd?tb(mc?Bf:je):Ha(mc?Be:Hb)}}function je(mc,vd){if("target"==vd)return rf.marked="keyword",tb(Ma)}function Bf(mc,vd){if("target"==vd)return rf.marked="keyword",tb(gb)}function lf(mc){return":"==mc?tb(te,Lc):Ha(Ma,cd(";"),te)}function bf(mc){if("variable"==mc)return rf.marked="property",tb()}function z(mc,vd){if("async"==mc)return rf.marked="property",tb(z);if("variable"==mc||"keyword"==rf.style)return rf.marked="property","get"==vd||"set"==
vd?tb(pf):tb(nf);if("number"==mc||"string"==mc)return rf.marked=$g?"property":rf.style+" property",tb(nf);if("jsonld-keyword"==mc)return tb(nf);if("modifier"==mc)return tb(z);if("["==mc)return tb(Hb,cd("]"),nf);if("spread"==mc)return tb(Hb);if(":"==mc)return Ha(nf)}function pf(mc){if("variable"!=mc)return Ha(nf);rf.marked="property";return tb(Ua)}function nf(mc){if(":"==mc)return tb(Be);if("("==mc)return Ha(Ua)}function De(mc,vd,ee){function ye(jg,mg){return(ee?-1<ee.indexOf(jg):","==jg)?(jg=rf.state.lexical,
"call"==jg.info&&(jg.pos=(jg.pos||0)+1),tb(function(Ah,kl){return Ah==vd||kl==vd?Ha():Ha(mc)},ye)):jg==vd||mg==vd?tb():tb(cd(vd))}return function(jg,mg){return jg==vd||mg==vd?tb():Ha(mc,ye)}}function Cf(mc,vd,ee){for(var ye=3;ye<arguments.length;ye++)rf.cc.push(arguments[ye]);return tb(Tb(vd,ee),De(mc,vd),te)}function Rf(mc){return"}"==mc?tb():Ha(Lc,Rf)}function Vf(mc,vd){if(Qg){if(":"==mc)return tb(dg);if("?"==vd)return tb(Vf)}}function dg(mc){if("variable"==mc)return rf.marked="variable-3",tb(og);
if("string"==mc||"number"==mc||"atom"==mc)return tb(og);if("{"==mc)return tb(Tb("}"),De($c,"}",",;"),te);if("("==mc)return tb(De(Oe,")"),eg)}function eg(mc){if("=>"==mc)return tb(dg)}function $c(mc,vd){if("variable"==mc||"keyword"==rf.style)return rf.marked="property",tb($c);if("?"==vd)return tb($c);if(":"==mc)return tb(dg)}function Oe(mc){if("variable"==mc)return tb(Oe);if(":"==mc)return tb(dg)}function og(mc,vd){if("<"==vd)return tb(Tb(">"),De(dg,">"),te,og);if("|"==vd||"."==mc)return tb(dg);if("["==
mc)return tb(cd("]"),og);if("extends"==vd)return tb(dg)}function ph(){return Ha(id,Vf,Va,cc)}function id(mc,vd){if("modifier"==mc)return tb(id);if("variable"==mc)return Ac(vd),tb();if("spread"==mc)return tb(id);if("["==mc)return Cf(id,"]");if("{"==mc)return Cf(cb,"}")}function cb(mc,vd){if("variable"==mc&&!rf.stream.match(/^\s*:/,!1))return Ac(vd),tb(Va);"variable"==mc&&(rf.marked="property");return"spread"==mc?tb(id):"}"==mc?Ha():tb(cd(":"),id,Va)}function Va(mc,vd){if("="==vd)return tb(Be)}function cc(mc){if(","==
mc)return tb(ph)}function Ba(mc,vd){if("keyword b"==mc&&"else"==vd)return tb(Tb("form","else"),Lc,te)}function Ja(mc){if("("==mc)return tb(Tb(")"),Sa,cd(")"),te)}function Sa(mc){return"var"==mc?tb(ph,cd(";"),Fb):";"==mc?tb(Fb):"variable"==mc?tb(ba):Ha(Hb,cd(";"),Fb)}function ba(mc,vd){return"in"==vd||"of"==vd?(rf.marked="keyword",tb(Hb)):tb(Ma,Fb)}function Fb(mc,vd){return";"==mc?tb(va):"in"==vd||"of"==vd?(rf.marked="keyword",tb(Hb)):Ha(Hb,cd(";"),va)}function va(mc){")"!=mc&&tb(Hb)}function Ua(mc,
vd){if("*"==vd)return rf.marked="keyword",tb(Ua);if("variable"==mc)return Ac(vd),tb(Ua);if("("==mc)return tb(wb,Tb(")"),De(mb,")"),te,Vf,Lc,ud);if(Qg&&"<"==vd)return tb(Tb(">"),De(dg,">"),te,Ua)}function mb(mc){return"spread"==mc?tb(mb):Ha(id,Vf,Va)}function Ub(mc,vd){return"variable"==mc?yc(mc,vd):Pc(mc,vd)}function yc(mc,vd){if("variable"==mc)return Ac(vd),tb(Pc)}function Pc(mc,vd){if("<"==vd)return tb(Tb(">"),De(dg,">"),te,Pc);if("extends"==vd||"implements"==vd||Qg&&","==mc)return tb(Qg?dg:Hb,
Pc);if("{"==mc)return tb(Tb("}"),Zc,te)}function Zc(mc,vd){if("variable"==mc||"keyword"==rf.style){if(("async"==vd||"static"==vd||"get"==vd||"set"==vd||Qg&&("public"==vd||"private"==vd||"protected"==vd||"readonly"==vd||"abstract"==vd))&&rf.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return rf.marked="keyword",tb(Zc);rf.marked="property";return tb(Qg?Qc:Ua,Zc)}if("["==mc)return tb(Hb,cd("]"),Qg?Qc:Ua,Zc);if("*"==vd)return rf.marked="keyword",tb(Zc);if(";"==mc)return tb(Zc);if("}"==mc)return tb();if("@"==
vd)return tb(Hb,Zc)}function Qc(mc,vd){return"?"==vd?tb(Qc):":"==mc?tb(dg,Va):"="==vd?tb(Be):Ha(Ua)}function Ld(mc,vd){return"*"==vd?(rf.marked="keyword",tb(Ke,cd(";"))):"default"==vd?(rf.marked="keyword",tb(Hb,cd(";"))):"{"==mc?tb(De(we,"}"),Ke,cd(";")):Ha(Lc)}function we(mc,vd){if("as"==vd)return rf.marked="keyword",tb(cd("variable"));if("variable"==mc)return Ha(Be,we)}function af(mc){return"string"==mc?tb():Ha(de,kf,Ke)}function de(mc,vd){if("{"==mc)return Cf(de,"}");"variable"==mc&&Ac(vd);"*"==
vd&&(rf.marked="keyword");return tb(Qe)}function kf(mc){if(","==mc)return tb(de,kf)}function Qe(mc,vd){if("as"==vd)return rf.marked="keyword",tb(de)}function Ke(mc,vd){if("from"==vd)return rf.marked="keyword",tb(Hb)}function Pf(mc){return"]"==mc?tb():Ha(De(Be,"]"))}ec=Object.assign({},Sc.defaultConfig,{},ec);Xb=Object.assign({},Sc.defaultParserConfig,{},Xb);var xg=ec.indentUnit,Eg=Xb.statementIndent,$g=Xb.jsonld,Kg=Xb.json||$g,Qg=Xb.typescript,Hi=Xb.wordCharacters||/[\w$\xa1-\uffff]/,Mi=function(){function mc(kl){return{type:kl,
style:"keyword"}}var vd=mc("keyword a"),ee=mc("keyword b"),ye=mc("keyword c"),jg=mc("operator"),mg={type:"atom",style:"atom"};vd={if:mc("if"),while:vd,with:vd,else:ee,do:ee,try:ee,finally:ee,return:ye,break:ye,continue:ye,new:mc("new"),delete:ye,throw:ye,debugger:ye,var:mc("var"),const:mc("var"),let:mc("var"),function:mc("function"),catch:mc("catch"),for:mc("for"),switch:mc("switch"),case:mc("case"),default:mc("default"),in:jg,typeof:jg,instanceof:jg,true:mg,false:mg,null:mg,undefined:mg,NaN:mg,Infinity:mg,
this:mc("this"),class:mc("class"),super:mc("atom"),yield:ye,export:mc("export"),import:mc("import"),extends:ye,await:ye,async:mc("async")};if(Qg){ee={type:"variable",style:"variable-3"};ye={interface:mc("class"),implements:ye,namespace:ye,module:mc("module"),enum:mc("module"),public:mc("modifier"),private:mc("modifier"),protected:mc("modifier"),abstract:mc("modifier"),as:jg,string:ee,number:ee,boolean:ee,any:ee};for(var Ah in ye)vd[Ah]=ye[Ah]}return vd}(),Kf=/[+\-*&%=<>!?|~^@]/,Ui=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
Rg,ah,ci={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},rf={state:null,column:null,marked:null,cc:null},aj={name:"this",next:{name:"arguments"}};te.lex=!0;return{startState:function(mc){mc={tokenize:Ra,lastType:"sof",cc:[],lexical:new Pa((mc||0)-xg,0,"block",!1),localVars:Xb.localVars,context:Xb.localVars&&{vars:Xb.localVars},indented:mc||0};Xb.globalVars&&"object"===typeof Xb.globalVars&&(mc.globalVars=Xb.globalVars);return mc},token:function(mc,vd){mc.sol()&&(vd.lexical.hasOwnProperty("align")||
(vd.lexical.align=!1),vd.indented=mc.indentation(),ta(mc,vd));if(vd.tokenize!=ea&&mc.eatSpace())return null;var ee=vd.tokenize(mc,vd);if("comment"==Rg)return ee;vd.lastType="operator"!=Rg||"++"!=ah&&"--"!=ah?Rg:"incdec";a:{var ye=Rg,jg=ah,mg=vd.cc;rf.state=vd;rf.stream=mc;rf.marked=null;rf.cc=mg;rf.style=ee;vd.lexical.hasOwnProperty("align")||(vd.lexical.align=!0);for(mc=0;;){if(1E5<mc++)throw Error("endless");if((mg.length?mg.pop():Kg?Hb:Lc)(ye,jg)){for(;mg.length&&mg[mg.length-1].lex;)mg.pop()();
if(rf.marked){ee=rf.marked;break a}if(ye="variable"==ye)b:{for(ye=vd.localVars;ye;ye=ye.next)if(ye.name==jg){ye=!0;break b}for(vd=vd.context;vd;vd=vd.prev)for(ye=vd.vars;ye;ye=ye.next)if(ye.name==jg){ye=!0;break b}ye=void 0}if(ye){ee="variable-2";break a}break a}}}return ee},indent:function(mc,vd){if(mc.tokenize==ea)return Sc.passIndent;if(mc.tokenize!=Ra)return 0;var ee=vd&&vd.charAt(0),ye=mc.lexical,jg;if(!/^\s*else\b/.test(vd))for(var mg=mc.cc.length-1;0<=mg;--mg){var Ah=mc.cc[mg];if(Ah==te)ye=
ye.prev;else if(Ah!=Ba)break}for(;!("stat"!=ye.type&&"form"!=ye.type||"}"!=ee&&(!(jg=mc.cc[mc.cc.length-1])||jg!=Ma&&jg!=gb||/^[,\.=+\-*:?[\(]/.test(vd)));)ye=ye.prev;Eg&&")"==ye.type&&"stat"==ye.prev.type&&(ye=ye.prev);jg=ye.type;mg=ee==jg;return(Ah=mc._string)&&Ah.trimLeft().startsWith("?")&&":"===ee?Ah.indexOf("?"):Ah&&":"===mc.lastType&&"}"!==ye.type?Ah.match(/^\s*/)[0].length:"vardef"==jg?(vd=ye.indented+ye.info+2+mc.localVars.name.length,"?"===ee||":"===ee||"|"===ee||"&"===ee?vd:","==mc.lastType?
ye.indented+ye.info+1:"operator"==mc.lastType?vd+3:ye.indented):"form"==jg&&"{"==ee?ye.indented:"form"==jg?ye.indented+xg:"stat"==jg?(ee=ye.indented,mc="operator"==mc.lastType||","==mc.lastType||Kf.test(vd.charAt(0))||/[,.]/.test(vd.charAt(0)),ee+(mc?Eg||xg:0)):"switch"!=ye.info||mg||0==Xb.doubleIndentSwitch?ye.align?ye.column+(mg?0:1):ye.indented+(mg?0:xg):ye.indented+(/^(?:case|default)\b/.test(vd)?xg:2*xg)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:Kg?null:"/*",blockCommentEnd:Kg?
null:"*/",lineComment:Kg?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:Kg?"json":"javascript",jsonldMode:$g,jsonMode:Kg,expressionAllowed:Sc.expressionAllowed,skipExpression:function(mc){var vd=mc.cc[mc.cc.length-1];vd!=Hb&&vd!=Be||mc.cc.pop()}}});Sc.registerHelper("wordChars","javascript",/[\w$]/);Sc.defineMIME("text/javascript","javascript");Sc.defineMIME("text/ecmascript","javascript");Sc.defineMIME("application/javascript","javascript");Sc.defineMIME("application/x-javascript",
"javascript");Sc.defineMIME("application/ecmascript","javascript");Sc.defineMIME("application/json",{name:"javascript",json:!0});Sc.defineMIME("application/x-json",{name:"javascript",json:!0});Sc.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});Sc.defineMIME("text/typescript",{name:"javascript",typescript:!0});Sc.defineMIME("application/typescript",{name:"javascript",typescript:!0});var Pd=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");Pd.string=Ic;Pd.JavaScriptChecker=
Lb;Pd.JavaScriptNavigator=Vd;Pd.completers=Zb;Pd.jsSnippets=$b;Pd.jsIdeCommands=kc;Pd.jsEditorCommands=$a;Pd.astEditorCommands=tc;Pd.CodeMirrorEnabledEditorPlugin=Td;Pd.Snippet=uc;Pd.parser=fd;Pd.localInterface=Yb;Pd.systemInterfaceNamed=Yc;Pd.serverInterfaceFor=Nd;Pd.l2lInterfaceFor=gd;Lb=function(ec){var Xb=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),Jb=Xb.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof Xb.JavaScriptEditorPlugin?Xb.JavaScriptEditorPlugin:Xb.JavaScriptEditorPlugin=
function(Ra){Ra&&Ra[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ib(Jb,ec,[{key:Symbol.for("lively-instance-initialize"),value:function(){Ib._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new Pd.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(Ra){Ib._get(Object.getPrototypeOf(Jb.prototype),"attach",this).call(this,Ra);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:Ra})}},{key:"detach",value:function(Ra){this.checker.uninstall(this.textMorph);Ib._get(Object.getPrototypeOf(Jb.prototype),"detach",this).call(this,Ra)}},{key:"getNavigator",value:function(){return new Pd.JavaScriptNavigator}},{key:"getCompleters",value:function(Ra){return Pd.completers.concat(Ra)}},
{key:"getCommands",value:function(Ra){return[].concat($jscomp.arrayFromIterable(Ib._get(Object.getPrototypeOf(Jb.prototype),"getCommands",this).call(this,Ra)),$jscomp.arrayFromIterable(Pd.jsIdeCommands),$jscomp.arrayFromIterable(Pd.jsEditorCommands),$jscomp.arrayFromIterable(Pd.astEditorCommands))}},{key:"getKeyBindings",value:function(Ra){return[].concat($jscomp.arrayFromIterable(Ra),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(Ra){var Ga=this,ea,Da,ta,Pa,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){ea=Ga.textMorph;Da=[{command:"doit",target:ea,showKeyShortcuts:!0},{command:"inspectit",target:ea,showKeyShortcuts:!0},{command:"editit",target:ea,showKeyShortcuts:!0},{command:"printit",target:ea,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:ea,showKeyShortcuts:!0},{command:"eval all",target:ea,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:ea,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:ea,showKeyShortcuts:!0},{isDivider:!0}];Ga.evalEnvironment.targetModule&&Da.push({command:"[javascript] inject import",alias:"add import",target:ea},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:ea},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:ea});ta=Ga.getNavigator();(Pa=ta.resolveIdentifierAt(ea,
ea.cursorPosition))&&Da.push({command:"selectDefinition",alias:'jump to definition of "'+Pa.name+'"',target:ea},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+Pa.name+'"',target:ea});(Ha=ea.selection.text.trim())&&Da.push({command:"open code search",alias:'code search for "'+Pd.string.truncate(Ha,30)+'"',target:ea.world(),args:{input:Ha,backend:Ga.backend()}});Da.push({isDivider:!0});return tb.return(Da.concat(Ra))})}},{key:"getSnippets",value:function(){return Pd.jsSnippets.map(function(Ra){var Ga=
$jscomp.makeIterator(Ra);Ra=Ga.next().value;Ga=Ga.next().value;return new Pd.Snippet({trigger:Ra,expansion:Ga})})}},{key:"sanatizedJsEnv",value:function(Ra){Ra=Object.assign({},this.evalEnvironment,{},Ra);Ra.format||(Ra.formatd="esm");Ra.context||(Ra.context=this.textMorph);Ra.sourceURL||(Ra.sourceURL=Ra.targetModule+"_doit_"+Date.now());Ra.systemInterface||(Ra.systemInterface=Pd.localInterface);return Ra}},{key:"backend",value:function(Ra){Ra=this.sanatizedJsEnv(Ra);return Ra.remote?Ra.remote:"local"}},
{key:"systemInterface",value:function(Ra){return this.sanatizedJsEnv(Ra).systemInterface||Pd.localInterface}},{key:"setSystemInterface",value:function(Ra){return this.evalEnvironment.systemInterface=Ra}},{key:"setSystemInterfaceNamed",value:function(Ra){return this.setSystemInterface(Pd.systemInterfaceNamed(Ra))}},{key:"runEval",value:function(Ra,Ga){Ga=this.sanatizedJsEnv(Ga);return this.systemInterface(Ga).runEval(Ra,Ga)}},{key:"parser",get:function(){return Pd.parser}},{key:"parse",value:function(Ra){Ra=
void 0===Ra?null:Ra;if(this._ast&&this._ast._astType===Ra)return this._ast;var Ga=this.parser,ea=this.textMorph.textString;if(!Ga)return null;var Da={withComments:!0,allowReturnOutsideFunction:!0};Ra&&(Da.type=Ra);if(ea.startsWith("#!")){var ta=ea.indexOf("\n");ea=" ".repeat(ta)+ea.slice(ta)}Ga=Ga.fuzzyParse(ea,Da);Ga._astType=Ra;return this._ast=Ga}},{key:"undeclaredVariables",value:function(Ra){var Ga=this.parser,ea=this.evalEnvironment.knownGlobals||[];Ra=this.parse(void 0===Ra?null:Ra);return Ga&&
Ra?Ga.query.findGlobalVarRefs(Ra,{jslintGlobalComment:!0}).filter(function(Da){return!ea.includes(Da.name)}):[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],Xb,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(Pd.CodeMirrorEnabledEditorPlugin);
Lb=Pd.JavaScriptEditorPlugin;Wa("default",Lb);Pd.default=Lb}}});
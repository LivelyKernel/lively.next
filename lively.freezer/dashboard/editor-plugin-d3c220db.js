System.register(["./__root_module__-dce2a509.js","kld-intersections","./index-133ff6c6.js","./editor-plugin-b06bb838.js","./index-3dc09926.js"],function(Ba){var zb,Ib,nc,bc,Sd,Vc,Ud,Yc,Oc,qd,ie,Ye,sf,ne,cc,Hc,Md,fc,$d,pe,Cc,Ic,Sb,Jc;return{setters:[function(dd){zb=dd.aw;Ib=dd.bB;nc=dd.bC;bc=dd.bD;Sd=dd.E;Vc=dd.au;Ud=dd.aZ;Yc=dd.a7;Oc=dd.ae;qd=dd.bo;ie=dd.a6;Ye=dd.$;sf=dd.bE;ne=dd.bv},function(){},function(dd){cc=dd.s},function(dd){Hc=dd.p;Md=dd.d;fc=dd.a;$d=dd.r;pe=dd.C},function(dd){Cc=dd.localInterface;
Ic=dd.systemInterfaceNamed;Sb=dd.serverInterfaceFor;Jc=dd.l2lInterfaceFor}],execute:function(){var dd=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");dd.warnStyle={"border-bottom":"2px dotted orange"};dd.errorStyle={"background-color":"red"};var Jd=function(Tb){var pa=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),Ja=pa.hasOwnProperty("JavaScriptChecker")&&"function"===typeof pa.JavaScriptChecker?pa.JavaScriptChecker:pa.JavaScriptChecker=function(X){X&&X[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(Ja,Tb,[{key:"uninstall",value:function(X){var ua=X.text||X;(ua.markers||[]).forEach(function(ab){return ab.id.startsWith("js-checker-")&&ua.removeMarker(ab)});ua.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(X,ua){return[].concat($jscomp.arrayFromIterable(X.embeddedMorphMap.values())).find(function(ab){return ua.containsPosition(ab.anchor.position)})}},{key:"onDocumentChange",value:function(X,
ua,ab){var rb=ua.document;try{var vc=ab.parse()}catch(Bd){vc=Bd}vc&&(X=(ua.markers||[]).filter(function(Bd){return Bd.id.startsWith("js-checker-")}),ab=ab.undeclaredVariables().map(function(Bd,sc){var Nb=Bd.start;Bd=Bd.end;Nb=rb.indexToPosition(Nb);Bd=rb.indexToPosition(Bd);return ua.addMarker({id:"js-checker-"+sc,style:dd.warnStyle,range:{start:Nb,end:Bd},type:"js-undeclared-var"})}),X.slice(ab.length).forEach(function(Bd){return ua.removeMarker(Bd)}),vc.parseError?(X=vc.parseError.loc,ab=X.column,
X=X.line-1,vc=rb.indexToPosition(vc.parseError.pos),ab=vc.column,X=vc.row,vc={start:{column:ab-1,row:X},end:{column:ab+1,row:X}},this.hasEmbeddedMorphInRange(ua,vc)||ua.addMarker({id:"js-syntax-error",range:vc,style:dd.errorStyle,type:"js-syntax-error"})):ua.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],pa,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),Kd=Jd=dd.JavaScriptChecker;dd.default=Jd;var Hb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");Hb.query=Ib;Hb.fuzzyParse=nc;Hb.acorn=bc;Hb.custom=Sd;var Bb=function(Tb){var pa=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),Ja=pa.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof pa.JavaScriptNavigator?
pa.JavaScriptNavigator:pa.JavaScriptNavigator=function(X){X&&X[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(Ja,Tb,[{key:"ensureAST",value:function(X){return this.parse(X.textString)}},{key:"parse",value:function(X){return Hb.fuzzyParse(X)}},{key:"move",value:function(X,ua){var ab=!!ua.activeMark||!ua.selection.isEmpty(),rb=ua.selection,vc=ua.positionToIndex(rb.lead);X=this[X](ua.textString,vc);X=ua.indexToPosition(X);rb.lead=
X;ab||(rb.anchor=X);ua.scrollCursorIntoView()}},{key:"forwardSexp",value:function(X){this.move("_forwardSexp",X)}},{key:"backwardSexp",value:function(X){this.move("_backwardSexp",X)}},{key:"backwardUpSexp",value:function(X){this.move("_backwardUpSexp",X)}},{key:"forwardDownSexp",value:function(X){this.move("_forwardDownSexp",X)}},{key:"_forwardSexp",value:function(X,ua){X=this.parse(X);X=Hb.custom.findNodesIncluding(X,ua).reverse().find(function(rb){return rb.end!==ua});if(!X)return ua;if("BlockStatement"===
X.type){var ab=X.body.find(function(rb){return rb.start>ua});if(ab)return ab.start}return X.end}},{key:"_backwardSexp",value:function(X,ua){X=this.parse(X);X=Hb.custom.findNodesIncluding(X,ua).reverse().find(function(rb){return rb.start!==ua});if(!X)return ua;if("BlockStatement"===X.type){var ab=X.body.slice().reverse().find(function(rb){return rb.end<ua});if(ab)return ab.end}return X?X.start:ua}},{key:"_backwardUpSexp",value:function(X,ua){X=this.parse(X);return(X=Hb.custom.findNodesIncluding(X,
ua).reverse().find(function(ab){return ab.start!==ua}))?X.start:ua}},{key:"_forwardDownSexp",value:function(X,ua){X=this.parse(X);return(X=Hb.custom.findNodeAfter(X,ua,function(ab,rb){return rb.start>ua}))?X.node.start:ua}},{key:"markDefun",value:function(X){var ua=this.rangeForFunctionOrDefinition(X.textString,[X.positionToIndex(X.selection.range.start),X.positionToIndex(X.selection.range.end)]);ua&&X.execCommand("expandRegion",{start:ua[0],end:ua[1]})}},{key:"rangeForNodesMatching",value:function(X,
ua,ab){X=this.parse(X);return(ua=Hb.custom.findNodesIncluding(X,ua).reverse().find(ab))?[ua.start,ua.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(X,ua){var ab=ua[0]===ua[1];return this.rangeForNodesMatching(X,ua[1],function(rb){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(rb.type)&&(ab&&rb.end!==ua[1]||!ab&&rb.start<ua[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(X,ua){"number"!==typeof ua&&(ua=X.positionToIndex(ua));
X=this.ensureAST(X);var ab=Hb.query.nodesAt(ua,X).reverse(),rb=ab.find(function(Bd){return"Identifier"===Bd.type});if(!rb&&((ab=ab[0])&&ab.type.includes("Specifier")&&ab.local&&"Identifier"===ab.local.type&&(rb=ab.local),!rb))return;ua=(ab=Hb.query.findDeclarationClosestToIndex(X,rb.name,ua))?Hb.query.scopeAtIndex(X,ab.start):Hb.query.scopeAtIndex(X,ua);var vc=Hb.query.findReferencesAndDeclsInScope(ua,rb.name).refs;return{parsed:X,scope:ua,id:rb,name:rb.name,decl:ab,refs:vc}}},{key:"expandRegion",
value:function(X,ua,ab,rb){function vc(Yd){Yd=X.positionToIndex({column:0,row:sc.row});return{range:[Yd+Nb.start,Yd+Nb.start+Nb.value.length],prev:rb}}var Bd=rb.range[0]!==rb.range[1],sc=X.indexToPosition(rb.range[0]),Nb=X.tokenAt(sc);if(!Bd&&Nb&&["keyword","identifier"].includes(Nb.type))return vc();ab=ab||this.parse(ua);ua=Hb.query.nodesAtIndex(ab,rb.range[0]).reverse().find(function(Yd){return Yd.start<rb.range[0]||Yd.end>rb.range[1]});if(!ua)return rb;ab=ua.start;Bd=ua.end;return"Literal"===ua.type&&
(ua.raw||"").match(/^['"`]/)&&rb.range[0]!==ua.start&&rb.range[1]!==ua.end&&(ua.start+1<rb.range[0]||ua.end-1>rb.range[1])?{range:[ab+1,Bd-1],prev:rb}:{range:[ab,Bd],prev:rb}}},{key:"contractRegion",value:function(X,ua,ab,rb){return rb.prev||rb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],pa,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6780})}(void 0);Jd=Bb=Hb.JavaScriptNavigator;Hb.default=Bb;var Mb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");Mb.addIndexToTextPos=function(Tb,pa,Ja){return Tb.indexToPosition(Tb.positionToIndex(pa)+Ja)};Mb.connect=Vc;Mb.disconnect=Ud;Mb.string=Yc;Mb.KeyHandler=Oc;Mb.Range=qd;Bb=function(Tb){var pa=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),Ja=pa.hasOwnProperty("Snippet")&&"function"===
typeof pa.Snippet?pa.Snippet:pa.Snippet=function(X){X&&X[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(Ja,Tb,[{key:Symbol.for("lively-instance-initialize"),value:function(X){X=void 0===X?{trigger:null,expansion:""}:X;var ua=X.expansion;this.trigger=X.trigger;this.expansion=ua;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(X){this.isExpanding&&(this.textMorph=X,Mb.connect(this.textMorph,
"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(X){this.isExpanding&&(Mb.disconnect(X,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var X=this.expansionState,ua=X.startAnchor,ab=X.endAnchor;X.isExpanding?Mb.Range.fromPositions(ua.position,ab.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var X=this.textMorph;if(X){var ua=
this.expansionState||{},ab=ua.marker,rb=ua.startAnchor,vc=ua.endAnchor;ua=ua.steps;rb&&X.removeAnchor(rb);vc&&X.removeAnchor(vc);ab&&X.removeMarker(ab);ua.forEach(function(Bd){return X.removeAnchor(Bd.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};X&&X.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(X){var ua=[],ab=0;Mb.string.reMatches(X,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(rb){var vc=
rb.start,Bd=rb.end;rb=rb.match;var sc="";rb.startsWith("${")?(sc=$jscomp.makeIterator(rb.match(/^\$\{([0-9]+):([^\}]*)\}/)),sc.next(),rb=sc.next().value,sc=sc.next().value,rb=Number(rb)):rb=Number(rb.replace(/^\$/,""));X=X.slice(0,vc-ab)+sc+X.slice(Bd-ab);ua[rb]={index:vc-ab,prefill:sc,anchor:null};ab+=Bd-vc-sc.length});return{steps:ua,expansion:X}}},{key:"expandAtCursor",value:function(X){var ua=X.selection,ab=X.cursorPosition.column,rb=this.expansion;this.trigger&&(ab-=this.trigger.length);if(ab=
Math.max(0,ab))rb=Mb.string.lines(rb),rb=[rb[0]].concat($jscomp.arrayFromIterable(rb.slice(1).map(function(Cd){return Mb.string.indent(Cd," ",ab)}))),rb=rb.join("\n");var vc=this.createExpansionSteps(rb);rb=vc.expansion;vc=vc.steps;this.trigger&&ua.growLeft(this.trigger.length);ua.text=rb;var Bd=ua.start;rb=ua.end;ua.collapseToEnd();if(vc.length){var sc=Mb.string.newUUID();vc.forEach(function(Cd,kb){return Cd.anchor=X.addAnchor(Object.assign({id:"snippet-step-"+kb+"-"+sc},Mb.addIndexToTextPos(X,Bd,
Cd.index)))});var Nb=X.addAnchor(Object.assign({id:"snippet-start-"+sc},Bd,{insertBehavior:"stay"})),Yd=X.addAnchor(Object.assign({id:"snippet-end-"+sc},rb));this.expansionState={marker:X.addMarker({id:"snippet-marker-"+sc,get range(){return{start:Nb.position,end:Yd.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:Nb,endAnchor:Yd,stepIndex:0,steps:vc,isExpanding:!0};
X.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var X=this.expansionState,ua=X.steps,ab=this.textMorph;if(X.isExpanding&&ab){ab=ab.selection;X=ua[X.stepIndex];var rb=X.prefill;ab.lead=ab.anchor=X.anchor.position;ab.growRight(rb.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=ua.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(X,ua){ua=X.positionToIndex(X.cursorPosition);
return X.textString.slice(ua-this.trigger.length,ua)===this.trigger}},{key:"tryTrigger",value:function(X,ua){if(!this.canExpand(X,X.cursorPosition))return!1;this.expandAtCursor(X);return!0}},{key:"getCommands",value:function(X){var ua=this;return X.concat([{name:"[snippet] next expansion step",exec:function(ab){ua.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(ab){ua.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(X){return X.concat(Mb.KeyHandler.withBindings([{keys:"Tab",
command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],pa,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:357,end:6029})}(void 0);Mb.Snippet=Bb;Mb.Snippet=Bb;Mb.Snippet=
Bb;var Na=[{name:"get snippets",exec:function(Tb){return Tb.pluginCollect("getSnippets",[])}}];Mb.snippetCommands=Na;Mb.snippetCommands=Na;Mb.snippetCommands=Na;var Ua=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");Ua.buildEvalOpts=function(Tb,pa){return Tb.plugins.find(function(Ja){return Ja.isJSEditorPlugin}).sanatizedJsEnv(pa)};Ua.Snippet=Bb;Na=function(Tb){var pa=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ja=pa.hasOwnProperty("ModuleTopLevelVarCompleter")&&
"function"===typeof pa.ModuleTopLevelVarCompleter?pa.ModuleTopLevelVarCompleter:pa.ModuleTopLevelVarCompleter=function(X){X&&X[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(Ja,Tb,[{key:"compute",value:function(X,ua){var ab,rb,vc,Bd,sc,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){if(1==Yd.nextAddress){rb=(ab=X.pluginFind(function(Cd){return Cd.isJSEditorPlugin}))&&ab.systemInterface();if(!rb)return Yd.return([]);
vc=Ua.buildEvalOpts(X);Bd=vc.targetModule;return"local"===rb.name?(sc=Object.getOwnPropertyNames(rb.getModule(Bd).recorder),Yd.jumpTo(2)):Yd.yield(rb.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+Bd+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',
{targetModule:"lively://module-recorder-completer"}),3)}if(2!=Yd.nextAddress){Nb=Yd.yieldResult;if(Nb.isError)return Yd.return([]);sc=JSON.parse(Nb.value)}sc=sc.filter(function(Cd){return!Cd.startsWith("defVar_")&&!["System","__currentLivelyModule","initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(Cd)});return Yd.return(sc.map(function(Cd){return{priority:1100,completion:Cd}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],
pa,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:227,end:1700})}(void 0);Ua.ModuleTopLevelVarCompleter=Na;Ua.ModuleTopLevelVarCompleter=Na;Ua.ModuleTopLevelVarCompleter=Na;Na=function(Tb){var pa=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ja=pa.hasOwnProperty("DynamicJavaScriptCompleter")&&
"function"===typeof pa.DynamicJavaScriptCompleter?pa.DynamicJavaScriptCompleter:pa.DynamicJavaScriptCompleter=function(X){X&&X[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(Ja,Tb,[{key:"isValidPrefix",value:function(X){return/\.[a-z0-9_]*$/i.test(X)}},{key:"isMethodCallCompletion",value:function(X){return X.endsWith(")")&&0<X.indexOf("(")}},{key:"isValidIdentifier",value:function(X){if("string"!==typeof X)return!1;this.isMethodCallCompletion(X)&&
(X=X.slice(0,X.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(X)?!0:!1}},{key:"wrapInBrackets",value:function(X){if(!isNaN(Number(X))||X.startsWith("Symbol."))return"["+X+"]";var ua="";this.isMethodCallCompletion(X)&&(ua=X.slice(X.indexOf("(")),X=X.slice(0,X.indexOf("(")));return'["'+X.replace(/"/g,'\\"')+'"]'+ua}},{key:"compute",value:function(X){var ua=this,ab,rb,vc,Bd,sc,Nb,Yd,Cd,kb,Cb,$c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){if(1==sb.nextAddress){ab=X.selection;
ab.isEmpty()?(rb=X.getLine(ab.lead.row),rb=rb.slice(rb.lastIndexOf(":")+1,ab.lead.column)):rb=ab.text.slice(Math.max(0,ab.text.indexOf(":")),0);if(!ua.isValidPrefix(rb))return sb.return([]);Bd=(vc=X.pluginFind(function(hd){return hd.isJSEditorPlugin}))&&vc.systemInterface();if(!Bd)return sb.return([]);sc=Ua.buildEvalOpts(X);return sb.yield(Bd.dynamicCompletionsForPrefix(sc.targetModule,rb,sc),2)}Nb=sb.yieldResult;Yd=Nb.isError;Cd=Nb.value;kb=Nb.completions;Cb=Nb.prefix;if(Yd)return console.warn("javascript completer encountered error: "+
(Cd.stack||Cd)),sb.return([]);kb.reduce(function(hd,md){md=$jscomp.makeIterator(md);md.next();md=md.next().value;return hd+md.length},0);$c=kb.reduce(function(hd,md,pb){md=$jscomp.makeIterator(md);var ub=md.next().value;md=md.next().value;return hd.concat(md.map(function(wb){var yd=ua.isValidIdentifier(wb);return{info:ub,completion:wb,prefix:yd?Cb:"."+Cb,customInsertionFn:yd?ua.isMethodCallCompletion(wb)?function(Zd,Je,Dc,re){Je=re.start;re=re.end;Zd=Zd.replace(/\((.*)\)/,function(cd){return"("+cd.slice(1,
-1).split(", ").map(function(we,xa){return"${"+xa+":"+we+"}"}).join(", ")+")"});Zd=new Ua.Snippet({expansion:Zd});Dc.replace({start:Je,end:re},"");Zd.expandAtCursor(Dc)}:null:function(Zd,Je,Dc,re){Zd=re.start;re=re.end;Je={row:Zd.row,column:Zd.column-1};re="."===Dc.textInRange({start:Je,end:Zd})?{start:Je,end:re}:{start:Zd,end:re};Dc.replace(re,ua.wrapInBrackets(wb))}}}))},[]);$c.forEach(function(hd,md){return Object.assign(hd,{priority:2E3+$c.length-md})});return sb.return($c)})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DynamicJavaScriptCompleter"}}],pa,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5085})}(void 0);Ua.DynamicJavaScriptCompleter=Na;Ua.DynamicJavaScriptCompleter=Na;Ua.DynamicJavaScriptCompleter=Na;Ua.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
Na=function(Tb){var pa=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ja=pa.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof pa.JavaScriptKeywordCompleter?pa.JavaScriptKeywordCompleter:pa.JavaScriptKeywordCompleter=function(X){X&&X[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(Ja,Tb,[{key:"compute",value:function(X,ua){return Ua.keywords.map(function(ab){return{completion:ab,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],pa,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6087,end:6225})}(void 0);Ua.JavaScriptKeywordCompleter=Na;Ua.JavaScriptKeywordCompleter=Na;Ua.JavaScriptKeywordCompleter=Na;Na=[new Ua.DynamicJavaScriptCompleter,
new Ua.JavaScriptKeywordCompleter,new Ua.ModuleTopLevelVarCompleter];Ua.completers=Na;Ua.completers=Na;Ua.completers=Na;var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");Oa.Snippet=Bb;var Ia=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];Oa.snippets=Ia;Oa.snippets=Ia;Oa.snippets=Ia;var eb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");eb.getEvalEnv=function(Tb){return(Tb=Tb.pluginFind(function(pa){return pa.isJSEditorPlugin}))?Tb.evalEnvironment:null};eb.setEvalEnv=function(Tb,pa){(Tb=Tb.pluginFind(function(Ja){return Ja.isJSEditorPlugin}))&&Object.assign(Tb.evalEnvironment,pa);return Tb.evalEnvironment};
eb.pToI=function(Tb,pa){return Tb.positionToIndex(pa)};eb.iToP=function(Tb,pa){return Tb.indexToPosition(pa)};eb.arr=ie;eb.promise=Ye;eb.string=Yc;eb.show=cc;eb.Range=qd;eb.query=Ib;eb.BaseVisitor=sf;Oa=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(Tb,pa){pa=void 0===pa?{varName:null,position:null}:pa;var Ja,X,ua,ab,rb,vc,Bd,sc,Nb,Yd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cd){switch(Cd.nextAddress){case 1:Ja=
pa;X=Ja.varName;ua=Ja.position;if(!X){ua||(ua=Tb.cursorPosition);ab=Tb.pluginInvokeFirst("getNavigator");rb=ab.ensureAST(Tb);vc=eb.query.nodesAt(Tb.positionToIndex(ua),rb).reverse().find(function(kb){return"Identifier"===kb.type});if(!vc)return Tb.showError(Error("no identifier found!")),Cd.return(!0);X=vc.name}pa=Tb.pluginFind(function(kb){return kb.isJSEditorPlugin}).sanatizedJsEnv();Bd='lively.modules.module("'+pa.targetModule+'").undefine("'+X+'")';Cd.setCatchFinallyBlocks(2);return Cd.yield(Tb.doEval(null,
pa,Bd),4);case 4:sc=Cd.yieldResult;Nb=sc.error?sc.error:sc.isError?sc.value:null;Cd.leaveTryBlock(3);break;case 2:Nb=Yd=Cd.enterCatchBlock();case 3:return Nb?Tb.showError(Nb):Tb.setStatusMessage(X+" undefined"),Cd.return(!0)}})}},{name:"change doitContext",exec:function(Tb){var pa,Ja,X,ua,ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){if(1==rb.nextAddress)return pa=$jscomp,Ja=pa.makeIterator,rb.yield(Tb.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(vc){return!vc.isUsedAsEpiMorph()}}),2);X=Ja.call(pa,rb.yieldResult);if(ua=X.next().value)ab="reset"===ua,Tb.doitContext=ab?null:ua,Tb.setStatusMessage(ab?"doitContext is now\n"+ua:"doitContext reset");return rb.return(!0)})}},{name:"change eval backend",exec:function(Tb,pa){pa=void 0===pa?{backend:void 0}:pa;var Ja,X;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){if(1==ua.nextAddress)return Ja=pa,X=Ja.backend,void 0!==X?ua.jumpTo(2):
ua.yield(Tb.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=ua.nextAddress&&(X=ua.yieldResult,!X))return Tb.setStatusMessage("Canceled"),ua.return(!0);"local"===X&&(X=null);Tb.setStatusMessage("Eval backend is now "+(X||"local"));return ua.return(eb.setEvalEnv(Tb,{remote:X}))})}},{name:"copy current module name to clipboard",exec:function(Tb){var pa=Tb.evalEnvironment.targetModule;Tb.setStatusMessage(pa||"Cannot find module name");Tb.env.eventDispatcher.killRing.add(Tb);
Tb.env.eventDispatcher.doCopy(pa);return!0}}];eb.jsEditorCommands=Oa;eb.jsEditorCommands=Oa;eb.jsEditorCommands=Oa;var cb=[{name:"[javascript] list errors and warnings",exec:function(Tb){var pa,Ja,X,ua,ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){if(1==rb.nextAddress){pa=(Tb.markers||[]).filter(function(vc){vc=vc.type;return"js-undeclared-var"===vc||"js-syntax-error"===vc});if(!pa.length)return eb.show("no warnings or errors"),rb.return(!0);Ja=pa.map(function(vc){var Bd=vc.range;
return{isListItem:!0,string:"["+vc.type.split("-").slice(1).join(" ")+"] "+Tb.textInRange(Bd),value:Bd}});return rb.yield(Tb.world().filterableListPrompt("jump to warning or error",Ja),2)}X=rb.yieldResult;ua=$jscomp.makeIterator(X.selected);if(ab=ua.next().value)Tb.saveMark(),Tb.selection=ab,Tb.centerRow(ab.start.row);return rb.return(!0)})}},{name:"[javascript] inject import",exec:function(Tb,pa){pa=void 0===pa?{gotoImport:!1,insertImportAtCursor:!0}:pa;var Ja,X,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){switch(ab.nextAddress){case 1:return ab.yield(eb.promise.delay(0),
2);case 2:return ab.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return Ja=ab.yieldResult,X=Ja.interactivelyInjectImportIntoText,ab.yield(X(Tb,pa),4);case 4:return(ua=ab.yieldResult)||Tb.setStatusMessage("canceled"),ab.return(ua)}})}},{name:"[javascript] fix undeclared variables",exec:function(Tb,pa){pa=void 0===pa?{ignore:[],autoApplyIfSingleChoice:!1,requester:Tb}:pa;var Ja,X,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){if(1==ab.nextAddress)return ab.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=ab.nextAddress)return Ja=ab.yieldResult,X=Ja.interactivlyFixUndeclaredVariables,ab.yield(X(Tb,pa),3);ua=ab.yieldResult;Tb.focus();return ab.return(ua)})}},{name:"[javascript] remove unused imports",exec:function(Tb,pa){pa=void 0===pa?{query:!0}:pa;var Ja,X,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){if(1==ab.nextAddress)return ab.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=ab.nextAddress)return Ja=ab.yieldResult,X=Ja.cleanupUnusedImports,ab.yield(X(Tb,
pa),3);ua=ab.yieldResult;Tb.setStatusMessage(ua);return ab.return(!0)})}},{name:"[javascript] eslint report",exec:function(Tb){var pa,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){if(1==X.nextAddress)return X.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);pa=X.yieldResult;Ja=pa.default;try{return X.return(Ja.reportOnMorph(Tb))}catch(ua){Tb.showError(ua)}X.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(Tb){var pa,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){if(1==
X.nextAddress)return X.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);pa=X.yieldResult;Ja=pa.default;try{return X.return(Ja.previewFixesOnMorph(Tb))}catch(ua){Tb.showError(ua)}X.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(Tb,pa,Ja){function X(sb,hd){hd||(hd=sc(sb,{allowReturnOutsideFunction:!0}));var md=eb.string.lineRanges(sb),pb=sb.split("\n"),ub=[],wb=new eb.BaseVisitor,yd=wb.visitVariableDeclaration;wb.visitVariableDeclaration=function(re,
cd,we){if(1<re.declarations.length)for(var xa=eb.string.findLineWithIndexInLineRanges(md,re.start),hb=re.declarations[0].start-md[xa][0],Xa={},qb=1;qb<re.declarations.length;Xa={$jscomp$loop$prop$actionType$2569:Xa.$jscomp$loop$prop$actionType$2569,$jscomp$loop$prop$arg$2570:Xa.$jscomp$loop$prop$arg$2570},qb++){var P=re.declarations[qb],qa=eb.string.findLineWithIndexInLineRanges(md,P.start);if(xa!==qa){var fb=pb[qa].match(/\s*/)[0].length;fb=hb-fb;0!==fb&&(P=eb.string.findLineWithIndexInLineRanges(md,
P.end),Xa.$jscomp$loop$prop$actionType$2569=0<fb?"insert":"delete",Xa.$jscomp$loop$prop$arg$2570=0<fb?" ".repeat(fb):-fb,ub.push.apply(ub,$jscomp.arrayFromIterable(eb.arr.range(qa,P).map(function(Lb){return function(gc){return[Lb.$jscomp$loop$prop$actionType$2569,md[gc][0],Lb.$jscomp$loop$prop$arg$2570]}}(Xa)))))}}return yd.call(wb,re,cd,we)};wb.accept(hd,{},[]);for(hd=ub.length;hd--;){var Zd=$jscomp.makeIterator(ub[hd]),Je=Zd.next().value,Dc=Zd.next().value;Zd=Zd.next().value;"insert"===Je?sb=sb.slice(0,
Dc)+Zd+sb.slice(Dc):"delete"===Je&&(sb=sb.slice(0,Dc)+sb.slice(Dc+Zd))}return sb}var ua,ab,rb,vc,Bd,sc,Nb,Yd,Cd,kb,Cb,$c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){switch(sb.nextAddress){case 1:return ua=Ja||Math.floor(Tb.width/Tb.defaultCharExtent().width),pa=Object.assign({printWidth:ua,tabWidth:2,useTabs:!1,bracketSpacing:!1},pa),ab=lively.modules.module,rb=System.normalizeSync("prettier/standalone.js"),sb.yield(ab(rb).load({format:"global",instrument:!1}),2);case 2:return vc=
sb.yieldResult,sb.yield(ab("lively.ast/lib/acorn-extension.js").load(),3);case 3:return sb.yield(ab("lively.ast").load(),4);case 4:return Bd=sb.yieldResult,sc=Bd.parse,sb.yield(ab("lively.ast/lib/query.js").load(),5);case 5:return sb.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return Nb=sb.yieldResult,Yd=Tb.selection.isEmpty()?Tb.documentRange:Tb.selection.range,Cd=Tb.positionToIndex(Yd.start),kb=Tb.positionToIndex(Yd.end),Cb=vc.format(Tb.textString,Object.assign({},
pa,{rangeStart:Cd,rangeEnd:kb,parser:function(hd,md,pb){return sc(hd,{allowReturnOutsideFunction:!0})}})),Tb.undoManager.group(),$c=Nb.diffChars(Tb.textString,Cb),Tb.applyJsDiffPatch($c),Tb.selection.text=X(Tb.selection.text),Tb.undoManager.group(),sb.return(!0)}})}}];eb.jsIdeCommands=cb;eb.jsIdeCommands=cb;eb.jsIdeCommands=cb;var ob=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(Tb,pa){pa=Tb.pluginInvokeFirst("getNavigator");if(!pa)return!0;pa=pa.resolveIdentifierAt(Tb,Tb.cursorPosition);
if(!pa||!pa.id)return eb.show("No symbol identifier selected"),!0;if(!pa.decl)return eb.show("Cannot find declaration of "+pa.name),!0;Tb.saveMark();Tb.selection={start:Tb.indexToPosition(pa.decl.start),end:Tb.indexToPosition(pa.decl.end)};Tb.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(Tb){Tb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(Tb){Tb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(Tb,pa){pa=void 0===pa?{direction:null}:pa;var Ja=Tb.pluginInvokeFirst("getNavigator");if(!Ja)return!0;Ja=Ja.resolveIdentifierAt(Tb,
Tb.cursorPosition);if(!Ja||!Ja.refs)return eb.show("No symbol identifier selected"),!0;var X=Tb.selection;Ja=Ja.refs.map(function(ab){var rb=ab.end;return eb.Range.fromPositions(eb.iToP(Tb,ab.start),eb.iToP(Tb,rb))}).concat(Ja.decl?eb.Range.fromPositions(eb.iToP(Tb,Ja.decl.start),eb.iToP(Tb,Ja.decl.end)):[]).sort(eb.Range.compare);if(!Ja.length)return!0;var ua=Ja.map(String).indexOf(String(X.range));if("next"===pa.direction||"prev"===pa.direction)-1===ua&&Ja.length?Ja=[Ja[0]]:(pa=ua+("next"===pa.direction?
1:-1),0>pa?pa=Ja.length-1:pa>=Ja.length&&(pa=0),Ja=[Ja[pa]]);Ja.forEach(function(ab){var rb=X.selections.findIndex(function(Bd){return Bd.range.equals(ab)}),vc=X.selections.length-1;-1<rb?eb.arr.swap(X.selections,rb,vc):X.addRange(ab,!1)});X.mergeSelections();return!0}}];eb.astEditorCommands=ob;eb.astEditorCommands=ob;eb.astEditorCommands=ob;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var Zb=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
Zb.expressionAllowed=function(Tb,pa,Ja){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(pa.lastType)||"quasi"==pa.lastType&&/\{\s*$/.test(Tb.string.slice(0,Tb.pos-(Ja||0)))};Zb.passIndent=Hc;Zb.defineMode=Md;Zb.defineMIME=fc;Zb.registerHelper=$d;Zb.defaultConfig={indentUnit:2};Zb.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};Zb.defineMode("javascript",
function(Tb,pa){function Ja(Qb,jd,zc){mk=Qb;jk=zc;return jd}function X(Qb,jd){var zc=Qb.next();if('"'==zc||"'"==zc)return jd.tokenize=ua(zc),jd.tokenize(Qb,jd);if("."==zc&&Qb.match(/^\d+(?:[eE][+\-]?\d+)?/))return Ja("number","number");if("."==zc&&Qb.match(".."))return Ja("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(zc))return Ja(zc);if("="==zc&&Qb.eat(">"))return Ja("=>","operator");if("0"==zc&&Qb.eat(/x/i))return Qb.eatWhile(/[\da-f]/i),Ja("number","number");if("0"==zc&&Qb.eat(/o/i))return Qb.eatWhile(/[0-7]/i),
Ja("number","number");if("0"==zc&&Qb.eat(/b/i))return Qb.eatWhile(/[01]/i),Ja("number","number");if(/\d/.test(zc))return Qb.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),Ja("number","number");if("/"==zc){if(Qb.eat("*"))return jd.tokenize=ab,ab(Qb,jd);if(Qb.eat("/"))return Qb.skipToEnd(),Ja("comment","comment");if(Zb.expressionAllowed(Qb,jd,1)){a:for(var je=jd=!1;null!=(zc=Qb.next());){if(!jd){if("/"==zc&&!je)break a;"["==zc?je=!0:je&&"]"==zc&&(je=!1)}jd=!jd&&"\\"==zc}Qb.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return Ja("regexp","string-2")}Qb.eatWhile(Pm);return Ja("operator","operator",Qb.current())}if("`"==zc)return jd.tokenize=rb,rb(Qb,jd);if("#"==zc)return Qb.skipToEnd(),Ja("error","error");if(Pm.test(zc))return">"==zc&&jd.lexical&&">"==jd.lexical.type||Qb.eatWhile(Pm),Ja("operator","operator",Qb.current());if(cm.test(zc))return Qb.eatWhile(cm),Qb=Qb.current(),(zc=Om.propertyIsEnumerable(Qb)&&Om[Qb])&&"."!=jd.lastType?Ja(zc.type,zc.style,Qb):Ja("variable","variable",Qb)}function ua(Qb){return function(jd,
zc){var je=!1,rg;if(Vi&&"@"==jd.peek()&&jd.match(gl))return zc.tokenize=X,Ja("jsonld-keyword","meta");for(;null!=(rg=jd.next())&&(rg!=Qb||je);)je=!je&&"\\"==rg;je||(zc.tokenize=X);return Ja("string","string")}}function ab(Qb,jd){for(var zc=!1,je;je=Qb.next();){if("/"==je&&zc){jd.tokenize=X;break}zc="*"==je}return Ja("comment","comment")}function rb(Qb,jd){for(var zc=!1,je;null!=(je=Qb.next());){if(!zc&&("`"==je||"$"==je&&Qb.eat("{"))){jd.tokenize=X;break}zc=!zc&&"\\"==je}return Ja("quasi","string-2",
Qb.current())}function vc(Qb,jd){jd.fatArrowAt&&(jd.fatArrowAt=null);var zc=Qb.string.indexOf("=>",Qb.start);if(!(0>zc)){if(ik){var je=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Qb.string.slice(Qb.start,zc));je&&(zc=je.index)}je=0;var rg=!1;for(--zc;0<=zc;--zc){var Ag=Qb.string.charAt(zc),Ek="([{}])".indexOf(Ag);if(0<=Ek&&3>Ek){if(!je){++zc;break}if(0==--je){"("==Ag&&(rg=!0);break}}else if(3<=Ek&&6>Ek)++je;else if(cm.test(Ag))rg=!0;else{if(/["'\/]/.test(Ag))return;if(rg&&!je){++zc;break}}}rg&&
!je&&(jd.fatArrowAt=zc)}}function Bd(Qb,jd,zc,je,rg,Ag){this.indented=Qb;this.column=jd;this.type=zc;this.prev=rg;this.info=Ag;null!=je&&(this.align=je)}function sc(){for(var Qb=arguments.length-1;0<=Qb;Qb--)Lf.cc.push(arguments[Qb])}function Nb(){sc.apply(null,arguments);return!0}function Yd(Qb){function jd(je){for(;je;je=je.next)if(je.name==Qb)return!0;return!1}var zc=Lf.state;Lf.marked="def";zc.context?jd(zc.localVars)||(zc.localVars={name:Qb,next:zc.localVars}):!jd(zc.globalVars)&&pa.globalVars&&
(zc.globalVars={name:Qb,next:zc.globalVars})}function Cd(){Lf.state.context={prev:Lf.state.context,vars:Lf.state.localVars};Lf.state.localVars=vo}function kb(){Lf.state.localVars=Lf.state.context.vars;Lf.state.context=Lf.state.context.prev}function Cb(Qb,jd){var zc=function(){var je=Lf.state,rg=je.indented;if("stat"==je.lexical.type)rg=je.lexical.indented;else for(var Ag=je.lexical;Ag&&")"==Ag.type&&Ag.align;Ag=Ag.prev)rg=Ag.indented;je.lexical=new Bd(rg,Lf.stream.column(),Qb,null,je.lexical,jd)};
zc.lex=!0;return zc}function $c(){var Qb=Lf.state;Qb.lexical.prev&&(")"==Qb.lexical.type&&(Qb.indented=Qb.lexical.indented),Qb.lexical=Qb.lexical.prev)}function sb(Qb){function jd(zc){return zc==Qb?Nb():";"==Qb?sc():Nb(jd)}return jd}function hd(Qb,jd){return"var"==Qb?Nb(Cb("vardef",jd.length),Vb,sb(";"),$c):"keyword a"==Qb?Nb(Cb("form"),ub,hd,$c):"keyword b"==Qb?Nb(Cb("form"),hd,$c):"{"==Qb?Nb(Cb("}"),ge,$c):";"==Qb?Nb():"if"==Qb?("else"==Lf.state.lexical.info&&Lf.state.cc[Lf.state.cc.length-1]==
$c&&Lf.state.cc.pop()(),Nb(Cb("form"),ub,hd,$c,Ha)):"function"==Qb?Nb(xb):"for"==Qb?Nb(Cb("form"),Va,hd,$c):"variable"==Qb?ik&&"type"==jd?(Lf.marked="keyword",Nb(Pe,sb("operator"),Pe,sb(";"))):Nb(Cb("stat"),P):"switch"==Qb?Nb(Cb("form"),ub,sb("{"),Cb("}","switch"),ge,$c,$c):"case"==Qb?Nb(md,sb(":")):"default"==Qb?Nb(sb(":")):"catch"==Qb?Nb(Cb("form"),Cd,sb("("),yc,sb(")"),hd,$c,kb):"class"==Qb?Nb(Cb("form"),gd,$c):"export"==Qb?Nb(Cb("stat"),mg,$c):"import"==Qb?Nb(Cb("stat"),of,$c):"module"==Qb?Nb(Cb("form"),
Ng,sb("{"),Cb("}"),ge,$c,$c):"async"==Qb?Nb(hd):"@"==jd?Nb(md,hd):sc(Cb("stat"),md,sb(";"),$c)}function md(Qb){return wb(Qb,!1)}function pb(Qb){return wb(Qb,!0)}function ub(Qb){return"("!=Qb?sc():Nb(Cb(")"),md,sb(")"),$c)}function wb(Qb,jd){if(Lf.state.fatArrowAt==Lf.stream.start){var zc=jd?xa:we;if("("==Qb)return Nb(Cd,Cb(")"),Zc(Ng,")"),$c,sb("=>"),zc,kb);if("variable"==Qb)return sc(Cd,Ng,sb("=>"),zc,kb)}zc=jd?Dc:Je;return $n.hasOwnProperty(Qb)?Nb(zc):"function"==Qb?Nb(xb,zc):"class"==Qb?Nb(Cb("form"),
xc,$c):"keyword c"==Qb||"async"==Qb?Nb(jd?Zd:yd):"("==Qb?Nb(Cb(")"),yd,sb(")"),$c,zc):"operator"==Qb||"spread"==Qb?Nb(jd?pb:md):"["==Qb?Nb(Cb("]"),hl,$c,zc):"{"==Qb?Qd(fb,"}",null,zc):"quasi"==Qb?sc(re,zc):"new"==Qb?Nb(hb(jd)):Nb()}function yd(Qb){return Qb.match(/[;\}\)\],]/)?sc():sc(md)}function Zd(Qb){return Qb.match(/[;\}\)\],]/)?sc():sc(pb)}function Je(Qb,jd){return","==Qb?Nb(md):Dc(Qb,jd,!1)}function Dc(Qb,jd,zc){var je=0==zc?Je:Dc,rg=0==zc?md:pb;if("=>"==Qb)return Nb(Cd,zc?xa:we,kb);if("operator"==
Qb)return/\+\+|--/.test(jd)?Nb(je):"?"==jd?Nb(md,sb(":"),rg):Nb(rg);if("quasi"==Qb)return sc(re,je);if(";"!=Qb){if("("==Qb)return Qd(pb,")","call",je);if("."==Qb)return Nb(qa,je);if("["==Qb)return Nb(Cb("]"),yd,sb("]"),$c,je)}}function re(Qb,jd){return"quasi"!=Qb?sc():"${"!=jd.slice(jd.length-2)?Nb(re):Nb(md,cd)}function cd(Qb){if("}"==Qb)return Lf.marked="string-2",Lf.state.tokenize=rb,Nb(re)}function we(Qb){vc(Lf.stream,Lf.state);return sc("{"==Qb?hd:md)}function xa(Qb){vc(Lf.stream,Lf.state);return sc("{"==
Qb?hd:pb)}function hb(Qb){return function(jd){return"."==jd?Nb(Qb?qb:Xa):sc(Qb?pb:md)}}function Xa(Qb,jd){if("target"==jd)return Lf.marked="keyword",Nb(Je)}function qb(Qb,jd){if("target"==jd)return Lf.marked="keyword",Nb(Dc)}function P(Qb){return":"==Qb?Nb($c,hd):sc(Je,sb(";"),$c)}function qa(Qb){if("variable"==Qb)return Lf.marked="property",Nb()}function fb(Qb,jd){if("async"==Qb)return Lf.marked="property",Nb(fb);if("variable"==Qb||"keyword"==Lf.style)return Lf.marked="property","get"==jd||"set"==
jd?Nb(Lb):Nb(gc);if("number"==Qb||"string"==Qb)return Lf.marked=Vi?"property":Lf.style+" property",Nb(gc);if("jsonld-keyword"==Qb)return Nb(gc);if("modifier"==Qb)return Nb(fb);if("["==Qb)return Nb(md,sb("]"),gc);if("spread"==Qb)return Nb(md);if(":"==Qb)return sc(gc)}function Lb(Qb){if("variable"!=Qb)return sc(gc);Lf.marked="property";return Nb(xb)}function gc(Qb){if(":"==Qb)return Nb(pb);if("("==Qb)return sc(xb)}function Zc(Qb,jd,zc){function je(rg,Ag){return(zc?-1<zc.indexOf(rg):","==rg)?(rg=Lf.state.lexical,
"call"==rg.info&&(rg.pos=(rg.pos||0)+1),Nb(function(Ek,Yn){return Ek==jd||Yn==jd?sc():sc(Qb)},je)):rg==jd||Ag==jd?Nb():Nb(sb(jd))}return function(rg,Ag){return rg==jd||Ag==jd?Nb():sc(Qb,je)}}function Qd(Qb,jd,zc){for(var je=3;je<arguments.length;je++)Lf.cc.push(arguments[je]);return Nb(Cb(jd,zc),Zc(Qb,jd),$c)}function ge(Qb){return"}"==Qb?Nb():sc(hd,ge)}function Sc(Qb,jd){if(ik){if(":"==Qb)return Nb(Pe);if("?"==jd)return Nb(Sc)}}function Pe(Qb){if("variable"==Qb)return Lf.marked="variable-3",Nb(Hf);
if("string"==Qb||"number"==Qb||"atom"==Qb)return Nb(Hf);if("{"==Qb)return Nb(Cb("}"),Zc(Me,"}",",;"),$c);if("("==Qb)return Nb(Zc(Gf,")"),Ue)}function Ue(Qb){if("=>"==Qb)return Nb(Pe)}function Me(Qb,jd){if("variable"==Qb||"keyword"==Lf.style)return Lf.marked="property",Nb(Me);if("?"==jd)return Nb(Me);if(":"==Qb)return Nb(Pe)}function Gf(Qb){if("variable"==Qb)return Nb(Gf);if(":"==Qb)return Nb(Pe)}function Hf(Qb,jd){if("<"==jd)return Nb(Cb(">"),Zc(Pe,">"),$c,Hf);if("|"==jd||"."==Qb)return Nb(Pe);if("["==
Qb)return Nb(sb("]"),Hf);if("extends"==jd)return Nb(Pe)}function Vb(){return sc(Ng,Sc,tg,Ve)}function Ng(Qb,jd){if("modifier"==Qb)return Nb(Ng);if("variable"==Qb)return Yd(jd),Nb();if("spread"==Qb)return Nb(Ng);if("["==Qb)return Qd(Ng,"]");if("{"==Qb)return Qd(pf,"}")}function pf(Qb,jd){if("variable"==Qb&&!Lf.stream.match(/^\s*:/,!1))return Yd(jd),Nb(tg);"variable"==Qb&&(Lf.marked="property");return"spread"==Qb?Nb(Ng):"}"==Qb?sc():Nb(sb(":"),Ng,tg)}function tg(Qb,jd){if("="==jd)return Nb(pb)}function Ve(Qb){if(","==
Qb)return Nb(Vb)}function Ha(Qb,jd){if("keyword b"==Qb&&"else"==jd)return Nb(Cb("form","else"),hd,$c)}function Va(Qb){if("("==Qb)return Nb(Cb(")"),Db,sb(")"),$c)}function Db(Qb){return"var"==Qb?Nb(Vb,sb(";"),Fa):";"==Qb?Nb(Fa):"variable"==Qb?Nb(da):sc(md,sb(";"),Fa)}function da(Qb,jd){return"in"==jd||"of"==jd?(Lf.marked="keyword",Nb(md)):Nb(Je,Fa)}function Fa(Qb,jd){return";"==Qb?Nb(mb):"in"==jd||"of"==jd?(Lf.marked="keyword",Nb(md)):sc(md,sb(";"),mb)}function mb(Qb){")"!=Qb&&Nb(md)}function xb(Qb,
jd){if("*"==jd)return Lf.marked="keyword",Nb(xb);if("variable"==Qb)return Yd(jd),Nb(xb);if("("==Qb)return Nb(Cd,Cb(")"),Zc(yc,")"),$c,Sc,hd,kb);if(ik&&"<"==jd)return Nb(Cb(">"),Zc(Pe,">"),$c,xb)}function yc(Qb){return"spread"==Qb?Nb(yc):sc(Ng,Sc,tg)}function xc(Qb,jd){return"variable"==Qb?gd(Qb,jd):td(Qb,jd)}function gd(Qb,jd){if("variable"==Qb)return Yd(jd),Nb(td)}function td(Qb,jd){if("<"==jd)return Nb(Cb(">"),Zc(Pe,">"),$c,td);if("extends"==jd||"implements"==jd||ik&&","==Qb)return Nb(ik?Pe:md,
td);if("{"==Qb)return Nb(Cb("}"),ad,$c)}function ad(Qb,jd){if("variable"==Qb||"keyword"==Lf.style){if(("async"==jd||"static"==jd||"get"==jd||"set"==jd||ik&&("public"==jd||"private"==jd||"protected"==jd||"readonly"==jd||"abstract"==jd))&&Lf.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Lf.marked="keyword",Nb(ad);Lf.marked="property";return Nb(ik?nf:xb,ad)}if("["==Qb)return Nb(md,sb("]"),ik?nf:xb,ad);if("*"==jd)return Lf.marked="keyword",Nb(ad);if(";"==Qb)return Nb(ad);if("}"==Qb)return Nb();if("@"==
jd)return Nb(md,ad)}function nf(Qb,jd){return"?"==jd?Nb(nf):":"==Qb?Nb(Pe,tg):"="==jd?Nb(pb):sc(xb)}function mg(Qb,jd){return"*"==jd?(Lf.marked="keyword",Nb(gi,sb(";"))):"default"==jd?(Lf.marked="keyword",Nb(md,sb(";"))):"{"==Qb?Nb(Zc(Yf,"}"),gi,sb(";")):sc(hd)}function Yf(Qb,jd){if("as"==jd)return Lf.marked="keyword",Nb(sb("variable"));if("variable"==Qb)return sc(pb,Yf)}function of(Qb){return"string"==Qb?Nb():sc(ui,Ph,gi)}function ui(Qb,jd){if("{"==Qb)return Qd(ui,"}");"variable"==Qb&&Yd(jd);"*"==
jd&&(Lf.marked="keyword");return Nb(Pj)}function Ph(Qb){if(","==Qb)return Nb(ui,Ph)}function Pj(Qb,jd){if("as"==jd)return Lf.marked="keyword",Nb(ui)}function gi(Qb,jd){if("from"==jd)return Lf.marked="keyword",Nb(md)}function hl(Qb){return"]"==Qb?Nb():sc(Zc(pb,"]"))}Tb=Object.assign({},Zb.defaultConfig,{},Tb);pa=Object.assign({},Zb.defaultParserConfig,{},pa);var yg=Tb.indentUnit,nk=pa.statementIndent,Vi=pa.jsonld,Dk=pa.json||Vi,ik=pa.typescript,cm=pa.wordCharacters||/[\w$\xa1-\uffff]/,Om=function(){function Qb(Yn){return{type:Yn,
style:"keyword"}}var jd=Qb("keyword a"),zc=Qb("keyword b"),je=Qb("keyword c"),rg=Qb("operator"),Ag={type:"atom",style:"atom"};jd={if:Qb("if"),while:jd,with:jd,else:zc,do:zc,try:zc,finally:zc,return:je,break:je,continue:je,new:Qb("new"),delete:je,throw:je,debugger:je,var:Qb("var"),const:Qb("var"),let:Qb("var"),function:Qb("function"),catch:Qb("catch"),for:Qb("for"),switch:Qb("switch"),case:Qb("case"),default:Qb("default"),in:rg,typeof:rg,instanceof:rg,true:Ag,false:Ag,null:Ag,undefined:Ag,NaN:Ag,Infinity:Ag,
this:Qb("this"),class:Qb("class"),super:Qb("atom"),yield:je,export:Qb("export"),import:Qb("import"),extends:je,await:je,async:Qb("async")};if(ik){zc={type:"variable",style:"variable-3"};je={interface:Qb("class"),implements:je,namespace:je,module:Qb("module"),enum:Qb("module"),public:Qb("modifier"),private:Qb("modifier"),protected:Qb("modifier"),abstract:Qb("modifier"),as:rg,string:zc,number:zc,boolean:zc,any:zc};for(var Ek in je)jd[Ek]=je[Ek]}return jd}(),Pm=/[+\-*&%=<>!?|~^@]/,gl=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
mk,jk,$n={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Lf={state:null,column:null,marked:null,cc:null},vo={name:"this",next:{name:"arguments"}};$c.lex=!0;return{startState:function(Qb){Qb={tokenize:X,lastType:"sof",cc:[],lexical:new Bd((Qb||0)-yg,0,"block",!1),localVars:pa.localVars,context:pa.localVars&&{vars:pa.localVars},indented:Qb||0};pa.globalVars&&"object"===typeof pa.globalVars&&(Qb.globalVars=pa.globalVars);return Qb},token:function(Qb,jd){Qb.sol()&&(jd.lexical.hasOwnProperty("align")||
(jd.lexical.align=!1),jd.indented=Qb.indentation(),vc(Qb,jd));if(jd.tokenize!=ab&&Qb.eatSpace())return null;var zc=jd.tokenize(Qb,jd);if("comment"==mk)return zc;jd.lastType="operator"!=mk||"++"!=jk&&"--"!=jk?mk:"incdec";a:{var je=mk,rg=jk,Ag=jd.cc;Lf.state=jd;Lf.stream=Qb;Lf.marked=null;Lf.cc=Ag;Lf.style=zc;jd.lexical.hasOwnProperty("align")||(jd.lexical.align=!0);for(Qb=0;;){if(1E5<Qb++)throw Error("endless");if((Ag.length?Ag.pop():Dk?md:hd)(je,rg)){for(;Ag.length&&Ag[Ag.length-1].lex;)Ag.pop()();
if(Lf.marked){zc=Lf.marked;break a}if(je="variable"==je)b:{for(je=jd.localVars;je;je=je.next)if(je.name==rg){je=!0;break b}for(jd=jd.context;jd;jd=jd.prev)for(je=jd.vars;je;je=je.next)if(je.name==rg){je=!0;break b}je=void 0}if(je){zc="variable-2";break a}break a}}}return zc},indent:function(Qb,jd){if(Qb.tokenize==ab)return Zb.passIndent;if(Qb.tokenize!=X)return 0;var zc=jd&&jd.charAt(0),je=Qb.lexical,rg;if(!/^\s*else\b/.test(jd))for(var Ag=Qb.cc.length-1;0<=Ag;--Ag){var Ek=Qb.cc[Ag];if(Ek==$c)je=
je.prev;else if(Ek!=Ha)break}for(;!("stat"!=je.type&&"form"!=je.type||"}"!=zc&&(!(rg=Qb.cc[Qb.cc.length-1])||rg!=Je&&rg!=Dc||/^[,\.=+\-*:?[\(]/.test(jd)));)je=je.prev;nk&&")"==je.type&&"stat"==je.prev.type&&(je=je.prev);rg=je.type;Ag=zc==rg;return(Ek=Qb._string)&&Ek.trimLeft().startsWith("?")&&":"===zc?Ek.indexOf("?"):Ek&&":"===Qb.lastType&&"}"!==je.type?Ek.match(/^\s*/)[0].length:"vardef"==rg?(jd=je.indented+je.info+2+Qb.localVars.name.length,"?"===zc||":"===zc||"|"===zc||"&"===zc?jd:","==Qb.lastType?
je.indented+je.info+1:"operator"==Qb.lastType?jd+3:je.indented):"form"==rg&&"{"==zc?je.indented:"form"==rg?je.indented+yg:"stat"==rg?(zc=je.indented,Qb="operator"==Qb.lastType||","==Qb.lastType||Pm.test(jd.charAt(0))||/[,.]/.test(jd.charAt(0)),zc+(Qb?nk||yg:0)):"switch"!=je.info||Ag||0==pa.doubleIndentSwitch?je.align?je.column+(Ag?0:1):je.indented+(Ag?0:yg):je.indented+(/^(?:case|default)\b/.test(jd)?yg:2*yg)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:Dk?null:"/*",blockCommentEnd:Dk?
null:"*/",lineComment:Dk?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:Dk?"json":"javascript",jsonldMode:Vi,jsonMode:Dk,expressionAllowed:Zb.expressionAllowed,skipExpression:function(Qb){var jd=Qb.cc[Qb.cc.length-1];jd!=md&&jd!=pb||Qb.cc.pop()}}});Zb.registerHelper("wordChars","javascript",/[\w$]/);Zb.defineMIME("text/javascript","javascript");Zb.defineMIME("text/ecmascript","javascript");Zb.defineMIME("application/javascript","javascript");Zb.defineMIME("application/x-javascript",
"javascript");Zb.defineMIME("application/ecmascript","javascript");Zb.defineMIME("application/json",{name:"javascript",json:!0});Zb.defineMIME("application/x-json",{name:"javascript",json:!0});Zb.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});Zb.defineMIME("text/typescript",{name:"javascript",typescript:!0});Zb.defineMIME("application/typescript",{name:"javascript",typescript:!0});var mc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");mc.string=Yc;mc.JavaScriptChecker=
Kd;mc.JavaScriptNavigator=Jd;mc.completers=Na;mc.jsSnippets=Ia;mc.jsIdeCommands=cb;mc.jsEditorCommands=Oa;mc.astEditorCommands=ob;mc.CodeMirrorEnabledEditorPlugin=pe;mc.Snippet=Bb;mc.parser=ne;mc.localInterface=Cc;mc.systemInterfaceNamed=Ic;mc.serverInterfaceFor=Sb;mc.l2lInterfaceFor=Jc;Kd=function(Tb){var pa=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),Ja=pa.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof pa.JavaScriptEditorPlugin?pa.JavaScriptEditorPlugin:pa.JavaScriptEditorPlugin=
function(X){X&&X[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(Ja,Tb,[{key:Symbol.for("lively-instance-initialize"),value:function(){zb._get(Object.getPrototypeOf(Ja.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new mc.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(X){zb._get(Object.getPrototypeOf(Ja.prototype),"attach",this).call(this,X);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:X})}},{key:"detach",value:function(X){this.checker.uninstall(this.textMorph);zb._get(Object.getPrototypeOf(Ja.prototype),"detach",this).call(this,X)}},{key:"getNavigator",value:function(){return new mc.JavaScriptNavigator}},{key:"getCompleters",value:function(X){return mc.completers.concat(X)}},
{key:"getCommands",value:function(X){return[].concat($jscomp.arrayFromIterable(zb._get(Object.getPrototypeOf(Ja.prototype),"getCommands",this).call(this,X)),$jscomp.arrayFromIterable(mc.jsIdeCommands),$jscomp.arrayFromIterable(mc.jsEditorCommands),$jscomp.arrayFromIterable(mc.astEditorCommands))}},{key:"getKeyBindings",value:function(X){return[].concat($jscomp.arrayFromIterable(X),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(X){var ua=this,ab,rb,vc,Bd,sc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){ab=ua.textMorph;rb=[{command:"doit",target:ab,showKeyShortcuts:!0},{command:"inspectit",target:ab,showKeyShortcuts:!0},{command:"editit",target:ab,showKeyShortcuts:!0},{command:"printit",target:ab,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:ab,showKeyShortcuts:!0},{command:"eval all",target:ab,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:ab,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:ab,showKeyShortcuts:!0},{isDivider:!0}];ua.evalEnvironment.targetModule&&rb.push({command:"[javascript] inject import",alias:"add import",target:ab},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:ab},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:ab});vc=ua.getNavigator();(Bd=vc.resolveIdentifierAt(ab,
ab.cursorPosition))&&rb.push({command:"selectDefinition",alias:'jump to definition of "'+Bd.name+'"',target:ab},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+Bd.name+'"',target:ab});(sc=ab.selection.text.trim())&&rb.push({command:"open code search",alias:'code search for "'+mc.string.truncate(sc,30)+'"',target:ab.world(),args:{input:sc,backend:ua.backend()}});rb.push({isDivider:!0});return Nb.return(rb.concat(X))})}},{key:"getSnippets",value:function(){return mc.jsSnippets.map(function(X){var ua=
$jscomp.makeIterator(X);X=ua.next().value;ua=ua.next().value;return new mc.Snippet({trigger:X,expansion:ua})})}},{key:"sanatizedJsEnv",value:function(X){X=Object.assign({},this.evalEnvironment,{},X);X.format||(X.formatd="esm");X.context||(X.context=this.textMorph);X.sourceURL||(X.sourceURL=X.targetModule+"_doit_"+Date.now());X.systemInterface||(X.systemInterface=mc.localInterface);return X}},{key:"backend",value:function(X){X=this.sanatizedJsEnv(X);return X.remote?X.remote:"local"}},{key:"systemInterface",
value:function(X){return this.sanatizedJsEnv(X).systemInterface||mc.localInterface}},{key:"setSystemInterface",value:function(X){return this.evalEnvironment.systemInterface=X}},{key:"setSystemInterfaceNamed",value:function(X){return this.setSystemInterface(mc.systemInterfaceNamed(X))}},{key:"runEval",value:function(X,ua){ua=this.sanatizedJsEnv(ua);return this.systemInterface(ua).runEval(X,ua)}},{key:"parser",get:function(){return mc.parser}},{key:"parse",value:function(X){X=void 0===X?null:X;if(this._ast&&
this._ast._astType===X)return this._ast;var ua=this.parser,ab=this.textMorph.textString;if(!ua)return null;var rb={withComments:!0,allowReturnOutsideFunction:!0};X&&(rb.type=X);if(ab.startsWith("#!")){var vc=ab.indexOf("\n");ab=" ".repeat(vc)+ab.slice(vc)}ua=ua.fuzzyParse(ab,rb);ua._astType=X;return this._ast=ua}},{key:"undeclaredVariables",value:function(X){var ua=this.parser,ab=this.evalEnvironment.knownGlobals||[];X=this.parse(void 0===X?null:X);return ua&&X?ua.query.findGlobalVarRefs(X,{jslintGlobalComment:!0}).filter(function(rb){return!ab.includes(rb.name)}):
[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],pa,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(mc.CodeMirrorEnabledEditorPlugin);Kd=mc.JavaScriptEditorPlugin;Ba("default",Kd);mc.default=Kd}}});
System.register(["./__root_module__-cd530690.js","kld-intersections","./index-e341c34b.js","./index-459b301d.js"],function(){var Da,zb,Rb,kc,dc,ke,hd,$d,md,Qc,xd,Od,ge,Ud,nd;return{setters:[function(Za){Da=Za.av;zb=Za.ar;Rb=Za.ah;kc=Za.aC;dc=Za.aA;ke=Za.am;hd=Za.Y;$d=Za.bP;md=Za._;Qc=Za.a4;xd=Za.s;Od=Za.a5;ge=Za.C;Ud=Za.a2;nd=Za.L},function(){},function(){},function(){}],execute:function(){var Za=lively.FreezerRuntime.recorderFor("StaticText/index.js");Za.HTMLMorph=Da;var Cb=function(ic){var id=
lively.FreezerRuntime.recorderFor("StaticText/index.js"),fe=id.hasOwnProperty("StaticText")&&"function"===typeof id.StaticText?id.StaticText:id.StaticText=function(Zb){Zb&&Zb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(fe,ic,[{key:"refresh",value:function(){this.html='<span style="line-height: 1.3; font-size: '+this.fontSize+"px; color: "+this.fontColor+"; font-family: "+this.fontFamily+'">'+this.value+"</span>"}}],[{key:"className",
get:function(){return"StaticText"}},{key:"properties",get:function(){return{html:{isStyleProp:!1},fontSize:{type:"Number",set:function(Zb){this.setProperty("fontSize",Zb);this.refresh()}},fontColor:{type:"Color",set:function(Zb){this.setProperty("fontColor",Zb);this.refresh()}},fontFamily:{type:"Enum",set:function(Zb){this.setProperty("fontFamily",Zb);this.refresh()}},value:{set:function(Zb){this.setProperty("value",Zb);this.refresh()}}}}}],id,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"StaticText",version:"0.1.1-10"}}},{start:74,end:953})}(Za.HTMLMorph);Cb=Za.StaticText;Za.default=Cb;var bc=lively.FreezerRuntime.recorderFor("WorldVersionViewer/index.js");bc.Morph=Rb;bc.World=kc;bc.HorizontalLayout=dc;bc.morph=ke;bc.MorphicDB=hd;bc.graph=$d;bc.promise=md;bc.date=Qc;bc.string=xd;bc.arr=Od;bc.Color=ge;bc.pt=Ud;bc.LoadingIndicator=nd;(function(ic){var id=lively.FreezerRuntime.recorderFor("WorldVersionViewer/index.js"),
fe=id.hasOwnProperty("WorldVersion")&&"function"===typeof id.WorldVersion?id.WorldVersion:id.WorldVersion=function(Zb){Zb&&Zb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(fe,ic,[{key:"update",value:function(){var Zb=$jscomp.makeIterator(this.submorphs),rc=Zb.next().value;Zb=Zb.next().value;rc.imageUrl=this.commit.preview;Zb.textAndAttributes=this.info;Zb.fontColor=this.selected?bc.Color.white:bc.Color.darkGray}}],[{key:"className",
get:function(){return"WorldVersion"}},{key:"properties",get:function(){return{commit:{},fill:{defaultValue:bc.Color.transparent},info:{derived:!0,get:function(){var Zb=this.commit,rc=Zb.message,Lb=Zb.name,Gc=Zb.timestamp;return[Zb._id.slice(0,6)+" ",{fontWeight:"bold"},bc.string.truncate(rc.split("\n")[0],40)+" ",{}," ("+Lb+" ",{},""+bc.date.format(new Date(Gc),"yyyy-mm-dd HH:MM Z"),{}]}},selected:{set:function(Zb){this.setProperty("selected",Zb);this.update()}},layout:{initialize:function(){this.layout=
new bc.HorizontalLayout({align:"center",spacing:5})}},submorphs:{initialize:function(){this.submorphs=[{type:"image",extent:bc.pt(30,30),name:"preview",reactsToPointer:!1},{reactsToPointer:!1,type:"label",fill:null,name:"commit info",fontFamily:"Nunito",fontColor:bc.Color.gray}]}}}}}],id,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldVersionViewer",
version:"0.1.1-33"}}},{start:274,end:1824})})(bc.Morph);Za=function(ic){var id=lively.FreezerRuntime.recorderFor("WorldVersionViewer/index.js"),fe=id.hasOwnProperty("WorldVersionViewer")&&"function"===typeof id.WorldVersionViewer?id.WorldVersionViewer:id.WorldVersionViewer=function(Zb){Zb&&Zb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(fe,ic,[{key:"reset",value:function(){this.getSubmorphNamed("version list").items=[]}},
{key:"onMouseDown",value:function(Zb){switch(Zb.targetMorph.name){case "visit button":this.visitSelectedCommit();break;case "revert button":this.revertToSelectedCommit()}}},{key:"visitSelectedCommit",value:function(){var Zb=this,rc,Lb,Gc,$c,ed,$b,ob,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){switch(Mc.nextAddress){case 1:return rc=Zb.get("version list").selection,Lb=bc.LoadingIndicator.open("Loading "+rc.name+"..."),Gc=$world,$c=Zb.db||bc.MorphicDB.default,ed=rc._id,Mc.setCatchFinallyBlocks(2,
3),ed?Mc.yield(bc.World.loadFromCommit(ed,void 0,{morphicDB:$c}),8):Mc.yield(bc.World.loadFromDB(rc.name,rc.ref,void 0,{morphicDB:$c}),7);case 7:$b=Mc.yieldResult;Mc.jumpTo(6);break;case 8:$b=Mc.yieldResult;case 6:return ob=$b,Mc.return(ob);case 3:Mc.enterFinallyBlock();Lb.remove();Mc.leaveFinallyBlock(0);break;case 2:zc=Mc.enterCatchBlock(),console.error(zc),Gc.showError("Error loading world:"+zc),Mc.jumpTo(3)}})}},{key:"revertToSelectedCommit",value:function(){var Zb=this,rc,Lb,Gc,$c,ed,$b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){if(1==
ob.nextAddress){rc=Zb.get("version list").selection;if(!rc)return ob.return();Lb=Zb.db||bc.MorphicDB.default;Gc=rc;$c=Gc._id;ed=Gc.name;$b=Gc.type;return ob.yield(Lb.revert($b,ed,$c,"HEAD"),2)}return ob.return(Zb.initializeFromStartCommit(rc,Lb,{showRevertButton:!0}))})}},{key:"initializeFromStartCommit",value:function(Zb,rc,Lb){rc=void 0===rc?bc.MorphicDB.default:rc;Lb=void 0===Lb?{}:Lb;var Gc=this,$c,ed,$b,ob,zc,Mc,Ja,Ra,ub,Mb,Ob,kb,ib,Jb,vc,sc,Uc,Xc,Q,fa,Ha,Qa,fc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){switch(Nb.nextAddress){case 1:return $c=
Lb,ed=void 0===$c.showRefs?!0:$c.showRefs,$b=Gc.startCommit=Zb,ob=$b._id,zc=$b.type,Mc=$b.name,Ja=Gc.getSubmorphNamed("version list spinner"),Ja.visible=!0,Ja.center=Gc.get("version list").center,Gc.db=rc,Nb.yield(rc.history(zc,Mc),2);case 2:Ra=Nb.yieldResult,ub=Ra.refs,Mb=Ra.history,Ob=ob,kb=bc.graph.invert(Mb),ib=bc.graph.hull(kb,ob),Jb={_id:!0},vc=[Zb],sc=$jscomp.makeIterator(ib),Uc=sc.next();case 3:if(Uc.done)return fa=bc.arr.max(vc,function(ab){return ab.timestamp}),Ob=fa._id,Nb.yield(rc.log(Ob,
void 0,!0),7);Xc=Uc.value;return Nb.yield(rc.log(Xc,void 0,!0,Jb),6);case 6:Q=Nb.yieldResult;vc.push.apply(vc,$jscomp.arrayFromIterable(Q));Q.forEach(function(ab){return Jb[ab._id]=!0});Uc=sc.next();Nb.jumpTo(3);break;case 7:Ha=Nb.yieldResult;if(ed)for(Qa in ub);fc=Ha.map(function(ab){var lc=new bc.WorldVersion({reactsToPointer:!1,commit:ab});lc.update();return{isListItem:!0,morph:lc,value:ab}});Gc.get("version list").items=fc;Ja.visible=!1;Nb.jumpToEnd()}})}}],[{key:"className",get:function(){return"WorldVersionViewer"}}],
id,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldVersionViewer",version:"0.1.1-33"}}},{start:1841,end:5600})}(bc.Morph);Za=bc.WorldVersionViewer;bc.default=Za}}});
System.register(["./__root_module__-aefa9179.js","./index-3100fe37.js","./color-picker-4e266839.js"],function(){var Da,Bb,Qb,hc,ac,be,bd,Sd,ed,Mc,pd,Dd,ke,Kd,jd,cb,Ab,Yb,gc,dd,Zd,Wb,oc,Lb,Bc,Sc,Yc,Xb;return{setters:[function(qb){Da=qb.at;Bb=qb.s;Qb=qb.a7;hc=qb.aW;ac=qb.a6;be=qb.a9;bd=qb.aa;Sd=qb.aB;ed=qb.ak;Mc=qb.an;pd=qb.ai;Dd=qb.ao;ke=qb.a3;Kd=qb.a1;jd=qb.C;cb=qb.aq;Ab=qb.au;Yb=qb.bS;gc=qb.bt;dd=qb.ac;Zd=qb.as;Wb=qb.bi;oc=qb.bs;Lb=qb.bq;Bc=qb.bU},function(qb){Sc=qb.N;Yc=qb.I},function(qb){Xb=
qb.a}],execute:function(){var qb=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js");qb.fun=Da;qb.string=Bb;qb.obj=Qb;qb.properties=hc;qb.arr=ac;qb.Text=be;qb.config=bd;qb.HorizontalLayout=Sd;qb.VerticalLayout=ed;qb.morph=Mc;qb.Morph=pd;qb.Icon=Dd;qb.pt=ke;qb.Rectangle=Kd;qb.Color=jd;qb.connect=cb;qb.once=Ab;qb.noUpdate=Yb;qb.ColorPicker=Xb;qb.DropDownList=gc;qb.loadObjectFromPartsbinFolder=dd;qb.cachedControls=new WeakMap;var uc=function(tb){var Jb=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js"),
Ib=Jb.hasOwnProperty("RichTextControl")&&"function"===typeof Jb.RichTextControl?Jb.RichTextControl:Jb.RichTextControl=function(ib){ib&&ib[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Zd(Ib,tb,[{key:"toggleButton",value:function(ib,jb){ib.master=jb?{auto:"styleguide://SystemIDE/selected button"}:{auto:"styleguide://System/dark button"}}},{key:"reset",value:function(){var ib=this.ui.fontSelection;ib.items=qb.RichTextControl.basicFontItems();
ib.selection=ib.items[0].value;qb.connect(this.target,"selectionChange",this,"update")}},{key:"alignAtTarget",value:function(ib){ib=void 0===ib?!!this.world():ib;var jb=this.target,Fb=jb.world()||$world,rc=this.globalBounds();jb=(jb.selection.isEmpty()?jb.globalBounds():jb.getGlobalTransform().transformRectToRect(jb.selectionBounds().translatedBy(jb.scroll.negated()))).bottomCenter().subPt(rc.topCenter());Fb=Fb.visibleBounds().translateForInclusion(rc.translatedBy(jb)).topLeft().subPt(rc.topLeft());
Fb=this.position.addPt(Fb);ib?this.animate({duration:300,position:Fb}):this.position=Fb}},{key:"removeFocus",value:function(){this.autoRemove&&this.target&&(this.remove(),this.target=null)}},{key:"focusOn",value:function(ib,jb){jb=void 0===jb?!0:jb;var Fb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rc){if(1==rc.nextAddress)return Fb.target=ib,Fb.update(),rc.yield(Fb.whenRendered(),2);Fb.ui.fontSizeField.relayout();jb&&Fb.alignAtTarget();rc.jumpToEnd()})}},{key:"setupConnections",
value:function(){qb.connect(this.ui.paddingField,"number",this,"setPadding");qb.connect(this.ui.paddingFieldTop,"number",this,"setPaddingTop");qb.connect(this.ui.paddingFieldBottom,"number",this,"setPaddingBottom");qb.connect(this.ui.paddingFieldLeft,"number",this,"setPaddingLeft");qb.connect(this.ui.paddingFieldRight,"number",this,"setPaddingRight")}},{key:"update",value:function(){var ib=this,jb=this.target,Fb=this.updateSpec,rc=jb.selection;rc=rc?rc.isEmpty()?jb.textAttributeAt(rc.start):jb.getStyleInRange(rc):
{};var Ic=this.managedProps,ec=qb.obj.select(jb,Ic);jb=$jscomp.makeIterator(Object.entries(qb.obj.select(rc||{},Ic)));for(rc=jb.next();!rc.done;rc=jb.next())Ic=$jscomp.makeIterator(rc.value),rc=Ic.next().value,Ic=Ic.next().value,"undefined"!==typeof Ic&&(ec[rc]=Ic);qb.noUpdate(function(){for(var Pc=$jscomp.makeIterator(Object.entries(ib.ui)),Q=Pc.next();!Q.done;Q=Pc.next()){var ha=$jscomp.makeIterator(Q.value);Q=ha.next().value;ha=ha.next().value;if(Fb[Q])Fb[Q](ec,ha)}})}},{key:"relayout",value:function(){}},
{key:"changeAttributeInSelectionOrMorph",value:function(ib,jb){var Fb=this.target,rc=Fb.selection;Fb.isLabel||rc.isEmpty()?Fb[ib]="function"===typeof jb?jb(Fb[ib]):jb:(Fb.undoManager.group(),Fb.changeStyleProperty(ib,function(Ic){return"function"===typeof jb?jb(Ic):jb}),Fb.undoManager.group())}},{key:"changeFont",value:function(ib){var jb=this,Fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rc){if(1==rc.nextAddress)return jb._last=ib,(Fb="custom..."===ib)?rc.yield($world.prompt("Enter font family name",
{requester:jb.target,historyId:"lively.morphic-rich-text-font-names",useLastInput:!0}),3):rc.jumpTo(2);if(2!=rc.nextAddress&&(ib=rc.yieldResult,!ib))return rc.return();jb.changeAttributeInSelectionOrMorph("fontFamily",ib);rc.jumpToEnd()})}},{key:"setPadding",value:function(ib){this.target.padding=qb.Rectangle.inset(ib)}},{key:"setPaddingTop",value:function(ib){var jb=this.target.padding;this.target.padding=qb.Rectangle.inset(jb.left(),ib,jb.right(),jb.bottom())}},{key:"setPaddingLeft",value:function(ib){var jb=
this.target.padding;this.target.padding=qb.Rectangle.inset(ib,jb.top(),jb.right(),jb.bottom())}},{key:"setPaddingRight",value:function(ib){var jb=this.target.padding;this.target.padding=qb.Rectangle.inset(jb.left(),jb.top(),ib,jb.bottom())}},{key:"setPaddingBottom",value:function(ib){var jb=this.target.padding;this.target.padding=qb.Rectangle.inset(jb.left(),jb.top(),jb.right(),ib)}},{key:"setLineWrapping",value:function(ib){this.target.lineWrapping=ib}},{key:"changeFontWeight",value:function(ib){this.changeAttributeInSelectionOrMorph("fontWeight",
ib)}},{key:"changeTextAlign",value:function(ib){this.changeAttributeInSelectionOrMorph("textAlign",ib)}},{key:"changeFontColor",value:function(ib){this.changeAttributeInSelectionOrMorph("fontColor",ib)}},{key:"changeFontSize",value:function(ib){this.changeAttributeInSelectionOrMorph("fontSize",ib)}},{key:"changeFixedWidth",value:function(ib){this.target.fixedWidth=ib}},{key:"changeFixedHeight",value:function(ib){this.target.fixedHeight=ib}},{key:"changeLink",value:function(){var ib=this,jb,Fb,rc,
Ic,ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){if(1==Pc.nextAddress)return jb=ib.target,Fb=jb.selection,rc=jb.getStyleInRange(Fb),Ic=rc.link,Pc.yield(ib.world().prompt("Set link",{input:Ic||"https://"}),2);ec=Pc.yieldResult;jb.undoManager.group();jb.setStyleInRange({link:ec||void 0},Fb);jb.undoManager.group();ib.autoRemove&&ib.remove();Pc.jumpToEnd()})}},{key:"toggleUnderline",value:function(){this.changeAttributeInSelectionOrMorph("textDecoration",function(ib){return"underline"===
ib?"none":"underline"})}},{key:"toggleItalic",value:function(){this.changeAttributeInSelectionOrMorph("fontStyle",function(ib){return"italic"===ib?"normal":"italic"})}},{key:"toggleBold",value:function(){this.changeAttributeInSelectionOrMorph("fontWeight",function(ib){return"bold"===ib||"700"===ib?"normal":"bold"})}},{key:"copyStyle",value:function(){var ib=this,jb=this.target,Fb=this.ui.applyStyleButton;jb=jb.selection.isEmpty()?jb.defaultTextStyle:jb.getStyleInRange(jb.selection);var rc=JSON.stringify(jb,
null,2);this.constructor.copiedStyle=jb;Fb.tooltip="paste style\n"+rc;this.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/plain",data:rc},{type:"application/morphic-text-style",styleString:rc}]).then(function(){return ib.setStatusMessage("Copied style\n"+rc)}).catch(function(Ic){return ib.showError(Ic)})}},{key:"pasteStyle",value:function(){var ib=this,jb=this.target,Fb=this.constructor.copiedStyle;jb.selection.isEmpty()?Object.assign(jb,Fb):jb.selections.forEach(function(rc){return jb.addTextAttribute(ib.constructor.copiedStyle,
rc)});this.update()}},{key:"clearStyle",value:function(){var ib=this.target;ib.selections.forEach(function(jb){return ib.resetStyleInRange(jb)});this.update()}},{key:"configureRichTextOptions",value:function(){this.getSubmorphNamed("config panel")&&this.getSubmorphNamed("config panel").remove();var ib=this.defaultSpec,jb=this.uiSpec;ib=this.addMorph({name:"config panel",layout:new qb.VerticalLayout({spacing:5}),epiMorph:!0,submorphs:[].concat($jscomp.arrayFromIterable(Object.keys(ib).map(function(Fb){var rc=
jb.rows.some(function(Ic){return Ic.some(function(ec){return ec===Fb})});return{type:"labeledcheckbox",label:Fb,name:Fb,checked:rc}})),[{layout:new qb.HorizontalLayout({spacing:3}),submorphs:[{type:"button",name:"OK button",label:"OK"},{type:"button",name:"cancel button",label:"Cancel"}]}])});ib.center=this.innerBounds().center();qb.connect(ib.getSubmorphNamed("OK button"),"fire",this,"configureAccepted");qb.connect(ib.getSubmorphNamed("cancel button"),"fire",this,"configureCanceled")}},{key:"configureAccepted",
value:function(){var ib=this.getSubmorphNamed("config panel");ib&&(ib.remove(),ib.submorphs.filter(function(jb){return"LabeledCheckBox"===jb.constructor.name}))}},{key:"configureCanceled",value:function(){var ib=this.getSubmorphNamed("config panel");ib&&ib.remove()}},{key:"close",value:function(){var ib=this;this.target&&this.target.attributeConnections&&this.target.attributeConnections.forEach(function(jb){return jb.targetObj===ib&&jb.disconnect()});this.remove()}},{key:"alwaysTargetFocusedMorph",
value:function(){this.startStepping(1500,"updateTarget")}},{key:"updateTarget",value:function(){var ib=this.world();ib&&(ib=ib.focusedMorph)&&(ib.isLabel||ib.isText)&&!this.isAncestorOf(ib)&&this.target!==ib&&this.focusOn(ib,!1)}},{key:"onMouseUp",value:function(ib){var jb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fb){if(1==Fb.nextAddress)return Fb.yield(jb.whenRendered(),2);jb.update();Fb.jumpToEnd()})}},{key:"attachToWorld",value:function(){qb.connect($world,"onMouseDown",
this,"updateTarget",{garbageCollect:!0})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RichTextControl"}},{key:"properties",get:function(){return{autoRemove:{defaultValue:!1},target:{},toggleColor:{},managedProps:{readOnly:!0,get:function(){return"fontFamily fontWeight fontSize fontStyle isText fontColor textAlign link textDecoration fixedWidth fixedHeight lineWrapping padding".split(" ")}},updateSpec:{get:function(){var ib=this;return Object.assign({fontSelection:function(jb,Fb){var rc=
jb.fontFamily;(jb=rc&&Fb.items.find(function(Ic){return Ic.value.toLowerCase()===rc.toLowerCase()}))?Fb.selection=jb.value:rc&&(Fb.items=Fb.items.concat({isListItem:!0,label:[rc,{fontFamily:rc}],value:rc}),Fb.selection=qb.arr.last(Fb.items));Fb.fit();Fb.width=Math.max(Fb.width,170)},fontWeightSelection:function(jb,Fb){Fb.selection="normal"==jb.fontWeight?"Medium":jb.fontWeight?qb.string.capitalize(jb.fontWeight):"Medium"},boldButton:function(jb,Fb){ib.toggleButton(Fb,"bold"===jb.fontWeight)},italicButton:function(jb,
Fb){ib.toggleButton(Fb,"italic"===jb.fontStyle)},underlineButton:function(jb,Fb){ib.toggleButton(Fb,"underline"===jb.textDecoration)},linkButton:function(jb,Fb){ib.toggleButton(Fb,!!jb.link)},colorPicker:function(jb,Fb){Fb.colorValue=jb.fontColor},fontSizeField:function(jb,Fb){Fb.number=jb.fontSize},fixedWidthControl:function(jb,Fb){jb.isText?Fb.enable():Fb.disable();Fb.checked=jb.fixedWidth},fixedHeightControl:function(jb,Fb){jb.isText?Fb.enable():Fb.disable();Fb.checked=jb.fixedHeight},lineWrappingControl:function(jb,
Fb){var rc=$jscomp.makeIterator(Fb.submorphs);Fb=rc.next().value;rc=rc.next().value;Fb.checked=!!jb.lineWrapping;rc.deactivated=!jb.lineWrapping;rc.deactivated?rc.opacity=.5:(rc.opacity=1,rc.selection=jb.lineWrapping)},paddingControl:function(jb,Fb){var rc=jb.padding,Ic=rc.left();jb=rc.top();var ec=rc.right();rc=rc.bottom();var Pc=!qb.arr.every([Ic,jb,ec,rc],function(Q){return Q==Ic});Fb.get("multi value indicator").visible=Pc;qb.connect(Fb.get("multi value indicator"),"onMouseDown",Fb.get("padding field"),
"number",{converter:"() => left",varMapping:{left:Ic}});Fb.get("padding field").number=Ic;Fb.get("padding field").visible=!Pc;Fb.get("padding field top").number=jb;Fb.get("padding field left").number=Ic;Fb.get("padding field right").number=ec;Fb.get("padding field bottom").number=rc}},["left","center","right","block"].reduce(function(jb,Fb){jb[Fb+"Align"]=function(rc,Ic){ib.toggleButton(Ic,rc.textAlign==Fb)};return jb},{}))}},ui:{get:function(){var ib=this,jb={fontSelection:"font selection",fontWeightSelection:"font weight selection",
boldButton:"bold button",italicButton:"italic button",underlineButton:"underline button",linkButton:"link button",leftAlign:"left align",centerAlign:"center align",rightAlign:"right align",blockAlign:"block align",fontSizeField:"font size field",colorPicker:"color picker",copyStyleButton:"copy style",applyStyleButton:"apply style",removeStyleButton:"remove style",fixedHeightControl:"fixed height control",fixedWidthControl:"fixed width control",lineWrappingControl:"line wrapping control",paddingControl:"padding control",
paddingField:"padding field",paddingFieldTop:"padding field top",paddingFieldLeft:"padding field left",paddingFieldRight:"padding field right",paddingFieldBottom:"padding field bottom"};return qb.obj.extract(jb,qb.obj.keys(jb),function(Fb,rc){return ib.getSubmorphNamed(rc)})}}}}},{key:"openDebouncedFor",value:function(ib){var jb=ib.selection;if(jb.isEmpty()){var Fb=qb.cachedControls.get(ib);Fb&&(Fb.update(),Fb.alignAtTarget(),Fb.world()||ib.world().addMorph(Fb))}else qb.fun.debounceNamed(ib.id+"openRichTextControl",
600,function(){var rc=qb.cachedControls.get(ib);jb.isEmpty()?rc&&rc.removeFocus():(rc&&rc.world()||(rc=new qb.RichTextControl,qb.cachedControls.set(ib,rc)),ib.world().addMorph(rc),rc.focusOn(ib,!0),rc.alwaysTargetFocusedMorph())})()}},{key:"openFor",value:function(ib){var jb=qb.cachedControls.get(ib);jb?jb.update():(jb=new qb.RichTextControl,qb.cachedControls.set(ib,jb),jb.focusOn(ib,!0),jb.alwaysTargetFocusedMorph());jb.alignAtTarget();jb.world()||ib.world().addMorph(jb);return jb}}],Jb,{pathInPackage:function(){return"text/ui.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:624,end:16984})}(qb.Morph);qb.RichTextControl=uc;qb.RichTextControl=uc;qb.RichTextControl=uc;uc=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js");uc.SearchField=Wb;var Hc=function(tb){var Jb=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js"),Ib=Jb.hasOwnProperty("ProtoSearchField")&&
"function"===typeof Jb.ProtoSearchField?Jb.ProtoSearchField:Jb.ProtoSearchField=function(ib){ib&&ib[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Zd(Ib,tb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoSearchField"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],Jb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoSearchField",version:"0.1.1-0"}}},{start:76,end:221})}(uc.SearchField);Hc=uc.ProtoSearchField;uc.default=Hc;var Ia=lively.FreezerRuntime.recorderFor("ProtoTree/index.js");Ia.Tree=oc;Ia.TreeData=Lb;uc=function(tb){var Jb=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),Ib=Jb.hasOwnProperty("TestTreeData")&&"function"===typeof Jb.TestTreeData?Jb.TestTreeData:Jb.TestTreeData=function(ib){ib&&
ib[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Zd(Ib,tb,[{key:"display",value:function(ib){return ib.name}},{key:"isCollapsed",value:function(ib){return ib.isCollapsed}},{key:"collapse",value:function(ib,jb){ib.isCollapsed=jb}},{key:"getChildren",value:function(ib){return ib.isLeaf?null:ib.isCollapsed?[]:ib.children}},{key:"isLeaf",value:function(ib){return ib.isLeaf}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TestTreeData"}}],
Jb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:113,end:417})}(Ia.TreeData);Ia.TestTreeData=uc;Ia.TestTreeData=uc;Ia.TestTreeData=uc;uc=function(tb){var Jb=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),Ib=Jb.hasOwnProperty("ProtoTree")&&"function"===typeof Jb.ProtoTree?Jb.ProtoTree:
Jb.ProtoTree=function(ib){ib&&ib[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Zd(Ib,tb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoTree"}},{key:"properties",get:function(){return{treeData:{initialize:function(){this.treeData=new Ia.TestTreeData({name:"root",isCollapsed:!1,isLeaf:!1,children:[{name:"child 1",isLeaf:!0},{name:"child 2",isLeaf:!1,isCollapsed:!0,children:[{name:"child 2 - 1",isLeaf:!0}]},
{name:"child 3",isLeaf:!1,isCollapsed:!1,children:[{name:"child 3 - 1",isLeaf:!0},{name:"child 3 - 2",isLeaf:!0}]},{name:"child 4",isLeaf:!0}]})}},master:{initialize:function(){}}}}}],Jb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:434,end:1297})}(Ia.Tree);uc=Ia.ProtoTree;Ia.default=uc;uc=
lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js");uc.NumberWidget=Sc;Hc=function(tb){var Jb=lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js"),Ib=Jb.hasOwnProperty("ProtoNumberWidget")&&"function"===typeof Jb.ProtoNumberWidget?Jb.ProtoNumberWidget:Jb.ProtoNumberWidget=function(ib){ib&&ib[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Zd(Ib,tb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoNumberWidget"}},
{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],Jb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoNumberWidget",version:"0.1.1-0"}}},{start:76,end:224})}(uc.NumberWidget);Hc=uc.ProtoNumberWidget;uc.default=Hc;uc=lively.FreezerRuntime.recorderFor("FrameResizer/index.js");uc.Morph=pd;Hc=function(tb){var Jb=
lively.FreezerRuntime.recorderFor("FrameResizer/index.js"),Ib=Jb.hasOwnProperty("FrameResizer")&&"function"===typeof Jb.FrameResizer?Jb.FrameResizer:Jb.FrameResizer=function(ib){ib&&ib[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Zd(Ib,tb,[{key:"onDrag",value:function(ib){var jb=this.owner.left;ib=ib.positionIn(this).x;ib*="left"==this.direction?-1:1;this.owner.width+=ib;350>this.owner.width&&(ib+=350-this.owner.width,this.owner.width=
350);this.owner.left="left"==this.direction?jb-ib:jb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FrameResizer"}},{key:"properties",get:function(){return{direction:{type:"Enum",values:["left","right"]}}}}],Jb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"FrameResizer",version:"0.1.1-24"}}},{start:56,end:840})}(uc.Morph);
Hc=uc.FrameResizer;uc.default=Hc;var Va=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js");Va.Morph=pd;Va.morph=Mc;Va.layouts=Bc;Va.string=Bb;Va.connect=cb;Va.noUpdate=Yb;Va.InteractiveMorphSelector=Yc;Va.Color=jd;Va.pt=ke;uc=function(tb){var Jb=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js"),Ib=Jb.hasOwnProperty("ShapeLayoutControl")&&"function"===typeof Jb.ShapeLayoutControl?Jb.ShapeLayoutControl:Jb.ShapeLayoutControl=function(ib){ib&&ib[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Zd(Ib,tb,[{key:"focusOn",value:function(ib){this.target=ib;this.update(!1)}},{key:"setupConnections",value:function(){var ib=this.ui;Va.connect(ib.submorphSettingsControl,"fire",this,"chooseSubmorphToChangeLayoutSettings");Va.connect(ib.dragmeControl,"onDragStart",this,"onSubmorphSettingsDragStart");Va.connect(ib.xAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "x",\n        submorph: self.selectedSubmorph,\n      })',
varMapping:{self:this}});Va.connect(ib.yAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "y",\n        submorph: self.selectedSubmorph,\n      })',varMapping:{self:this}});for(var jb={},Fb=$jscomp.makeIterator(this.managedProps),rc=Fb.next();!rc.done;jb={$jscomp$loop$prop$prop$2267:jb.$jscomp$loop$prop$prop$2267},rc=Fb.next()){var Ic=$jscomp.makeIterator(rc.value),ec=Ic.next().value;rc=Ic.next().value;Ic.next().value||
(jb.$jscomp$loop$prop$prop$2267=this.join(ec),Ic=ib[this.join(ec,"control")],Va.connect(Ic,rc,this,"updateLayout",{updater:function(Pc){return function(Q,ha){Q(Pc.$jscomp$loop$prop$prop$2267,ha)}}(jb),varMapping:{prop:jb.$jscomp$loop$prop$prop$2267}}))}}},{key:"lower",value:function(ib){return ib.charAt(0).toLowerCase()+ib.slice(1)}},{key:"join",value:function(ib,jb){return this.lower(Va.string.camelCaseString(ib+(jb?" "+jb:"")))}},{key:"updateLayoutOfTarget",value:function(ib){ib=Va.layouts[Va.string.camelCaseString(ib)];
this.target.layout=ib?new ib({autoResize:!1}):null;this.update()}},{key:"updateLayout",value:function(ib,jb){this.target.layout[ib]=jb}},{key:"update",value:function(ib){var jb=this;this.target&&Va.noUpdate(function(){for(var Fb=jb.ui,rc=jb.target.layout||{name:function(){return"No"}},Ic=$jscomp.makeIterator(jb.managedProps),ec=Ic.next();!ec.done;ec=Ic.next()){var Pc=$jscomp.makeIterator(ec.value);ec=Pc.next().value;var Q=Pc.next().value;Pc.next();Pc=Fb[jb.join(ec,"control")];var ha=Fb[jb.join(ec,
"label")];if(Q)if("type"===ec)Pc.selection=rc.name()+" Layout";else{var Ha=rc[jb.join(ec)],Pa="undefined"!==typeof Ha;if(Pa){switch(ec){case "align":Pc.items=rc.possibleAlignValues;break;case "direction":Pc.items=rc.possibleDirectionValues;break;case "axis":Pc.items=rc.possibleAxisValues}Pc[Q]=Ha}ha.isLayoutable=ha.visible=Pa}}jb.showGridLayoutControl("Grid"===rc.name());jb.showProportionalControl("Proportional"===rc.name())})}},{key:"updateSubmorphProportionalLayoutSettings",value:function(ib){var jb=
{};this.target.layout.changeSettingsFor(ib.submorph,(jb[ib.axis]=ib.policy,jb),!0)}},{key:"onSubmorphSettingsDragStart",value:function(ib){var jb=this;ib.stop();var Fb=this.target.layout,rc=Fb.settingsFor(this.selectedSubmorph),Ic=[],ec;for(ec in rc)Ic=[].concat($jscomp.arrayFromIterable(Ic),[ec+": ",{fontWeight:"bold"},rc[ec]+" ",{}]);var Pc=Va.morph({type:"label",fontColor:Va.Color.white,value:Ic,fill:Va.Color.black.withA(.7),padding:5,borderRadius:10,isLayoutable:!1});Pc.wantsToBeDroppedOn=function(Q){return Fb.layoutableSubmorphs.includes(Q)};
Pc.onBeingDroppedOn=function(Q,ha){Pc.remove();if(Q=Fb.layoutableSubmorphs.includes(ha)?ha:ib.world.morphsContainingPoint(ib.hand.position).find(function(Ha){return Fb.layoutableSubmorphs.includes(Ha)}))jb.updateSubmorphProportionalLayoutSettings({policy:rc.x,axis:"x",submorph:Q}),jb.updateSubmorphProportionalLayoutSettings({policy:rc.y,axis:"y",submorph:Q}),Q.show(),$world.setStatusMessage("layout settings applied")};ib.hand.grab(Pc);Pc.moveBy(Va.pt(10,10))}},{key:"chooseSubmorphToChangeLayoutSettings",
value:function(){var ib=this,jb,Fb,rc,Ic,ec,Pc,Q,ha,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){switch(Pa.nextAddress){case 1:return jb=ib.target.layout.layoutableSubmorphs,ib.manageFocus=!0,ib.env.eventDispatcher.isKeyPressed("Shift")?(rc=jb.map(function(bc){return{isListItem:!0,string:String(bc),value:bc}}),Pa.yield($world.listPrompt("Select morph",rc,{onSelection:function(bc){return bc.show()}}),5)):Pa.yield(Va.InteractiveMorphSelector.selectMorph(ib.world(),ib,function(bc){return jb.includes(bc)}),
4);case 4:Fb=Pa.yieldResult;Pa.jumpTo(3);break;case 5:Ic=Pa.yieldResult,ec=$jscomp.makeIterator(Ic.selected),Fb=ec.next().value;case 3:ib.manageFocus=!1;ib.selectedSubmorph=Fb;if(!Fb)return Pa.return();Pc=ib.ui;Q=Pc.xAxisPolicyControl;ha=Pc.yAxisPolicyControl;Ha=ib.target.layout.settingsFor(Fb);Va.noUpdate(function(){Q.selection=Ha.x;ha.selection=Ha.y});Pa.jumpToEnd()}})}},{key:"showProportionalControl",value:function(ib){var jb=this.ui;[jb.submorphSettingsControl,jb.dragmeControl,jb.xAxisPolicyControl,
jb.xAxisPolicyLabel,jb.yAxisPolicyControl,jb.yAxisPolicyLabel].forEach(function(Fb){Fb.isLayoutable=ib;Fb.visible=ib})}},{key:"showGridLayoutHalo",value:function(){$world.showLayoutHaloFor(this.target)}},{key:"showGridLayoutControl",value:function(ib){var jb=this.ui.configureGridLayoutControl;jb.visible=jb.isLayoutable=ib}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShapeLayoutControl"}},{key:"properties",get:function(){return{managedProps:{get:function(){return[["type","selection",
!0],["align","selection"],["direction","selection"],["axis","selection"],["spacing","number"],["auto resize","checked"],["resize submorphs","checked"],["x axis policy","selection",!0],["y axis policy","selection",!0],["react to submorph animations","checked"],["submorph settings",!1,!0],["order by index","checked"],["dragme",!1,!0],["configure grid layout",!1,!0]]}},ui:{readOnly:!0,get:function(){for(var ib={labelContainer:this.getSubmorphNamed("label container"),controlContainer:this.getSubmorphNamed("control container")},
jb=$jscomp.makeIterator(this.managedProps),Fb=jb.next();!Fb.done;Fb=jb.next()){var rc=$jscomp.makeIterator(Fb.value).next().value;Fb=rc+" label";rc+=" control";ib[this.join(Fb)]=this.getSubmorphNamed(Fb);ib[this.join(rc)]=this.getSubmorphNamed(rc)}return ib}}}}}],Jb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ShapeLayoutControl",
version:"0.1.1-166"}}},{start:345,end:7771})}(Va.Morph);uc=Va.ShapeLayoutControl;Va.default=uc}}});
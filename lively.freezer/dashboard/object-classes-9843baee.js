System.register(["./__root_module__-073d42f8.js","kld-intersections"],function($a){var Vb,jc,Wc,wc,Ud,Kd,he,xd,gd,Ld,Pd,af,bf,Ve,Ad,xe;return{setters:[function(qc){Vb=qc.c;jc=qc.P;Wc=qc.b;wc=qc.x;Ud=qc.y;Kd=qc.z;he=qc.A;xd=qc.r;gd=qc.D;Ld=qc.E;Pd=qc.F;af=qc.G;bf=qc.H;Ve=qc.J;Ad=qc.K;xe=qc.N},function(){}],execute:function(){function qc(nc,$c,ge,ad){ad=void 0===ad?{}:ad;ad=ad.package||Bd.ObjectPackage.lookupModuleForClass(nc.constructor,ad);if(!ad)throw Error("Object is not part of an object package: "+
nc);return ad.addScript(nc,$c,ge)}function td(nc,$c){$c=Bd.normalizeOptions($c).System;nc=(nc=nc[Symbol.for("lively-module-meta")])?nc.package.name:null;return($c=(nc?Bd.lookupPackage($c,nc):{}).pkg)?!!Bd.ObjectPackage.forSystemPackage($c):!1}function be(nc,$c){var ge,ad,ie,Yb,zb,Rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){return 1==Mc.nextAddress?(ge=nc.constructor,Bd.withSuperclasses(ge),Symbol.for("lively-module-meta"),ie=ad=Bd.ObjectPackage.lookupPackageForObject(nc),Yb=
ie.baseURL,zb=ie.System,Mc.yield(ad.fork($c,{baseURL:Yb,System:zb}),2)):3!=Mc.nextAddress?(Rc=Mc.yieldResult,Mc.yield(Bd.adoptObject(nc,Rc.objectClass),3)):Mc.return(Rc.objectClass[Symbol.for("__LivelyClassName__")])})}$a({addScript:qc,interactivelyForkPackage:be,isObjectClass:td});var Bd=lively.FreezerRuntime.recorderFor("lively.classes/object-classes.js");Bd.normalizeOptions=function(nc){nc=Object.assign({baseURL:Bd.defaultBaseURL,System:System},nc);nc.baseURL=nc.baseURL.replace(/\/$/,"");return nc};
Bd.addScript=qc;Bd.isObjectClass=td;Bd.interactivelyForkPackage=be;Bd.string=Vb;Bd.Path=jc;Bd.arr=Wc;Bd.parse=wc;Bd.isValidIdentifier=Ud;Bd.stringify=Kd;Bd.parseFunction=he;Bd.resource=xd;Bd.runEval=gd;Bd.scripting=Ld;Bd.ExportLookup=Pd;var pe=Bd.scripting;Bd.ensurePackage=pe.ensurePackage;Bd.registerPackage=pe.registerPackage;Bd.importPackage=pe.importPackage;Bd.lookupPackage=pe.lookupPackage;Bd.module=pe.module;Bd.ImportInjector=pe.ImportInjector;Bd.RuntimeSourceDescriptor=af;Bd.toJsIdentifier=
bf;Bd.withSuperclasses=Ve;Bd.adoptObject=Ad;Bd.classToFunctionTransform=xe;Bd.objectPackageSym=Symbol.for("lively-object-package-data");Bd.defaultBaseURL="local://lively-object-modules";Bd.globalClasses=Object.keys(System.global).map(function(nc){nc=System.global[nc];return"function"===typeof nc&&nc.name&&nc}).filter(Boolean);Bd.addScript=qc;Bd.addScript=qc;Bd.isObjectClass=td;Bd.isObjectClass=td;Bd._packageStore=Bd._packageStore||{};Bd.interactivelyForkPackage=be;Bd.interactivelyForkPackage=be;pe=
function(nc,$c){this._id=nc;this.options=Bd.normalizeOptions($c)};pe.lookupPackageForObject=function(nc,$c){return this.lookupPackageForClass(nc.constructor,$c)};pe.lookupPackageForClass=function(nc,$c){$c=Bd.normalizeOptions($c).System;nc=(nc=nc[Symbol.for("lively-module-meta")])?nc.package.name:null;return($c=(nc?Bd.lookupPackage($c,nc):{}).pkg)?Bd.ObjectPackage.forSystemPackage($c):null};pe.lookupModuleForClass=function(nc,$c){Bd.normalizeOptions($c);$c=this.lookupPackageForClass(nc,$c);nc=nc[Symbol.for("lively-module-meta")];
return new Bd.ObjectModule(nc.pathInPackage,$c)};pe.forSystemPackage=function(nc){return this.packageStore[nc.name]};pe.withId=function(nc,$c){return this.packageStore[nc]||(this.packageStore[nc]=new this(nc,$c))};pe.prototype.ensureSubModule=function(nc){nc=void 0===nc?"index":nc;var $c=this,ge;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){return 1==ad.nextAddress?(ge=new Bd.ObjectModule(nc,$c),ad.yield(ge.ensureExistance(),2)):ad.return(ge)})};pe.prototype.resource=function(nc){nc=
void 0===nc?"":nc;return Bd.resource(this.packageURL).join(nc)};pe.prototype.load=function(){return Bd.importPackage(this.System,this.packageURL)};pe.prototype.ensureExistance=function(){var nc=this,$c,ge,ad,ie,Yb,zb,Rc,Mc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tc){switch(tc.nextAddress){case 1:return $c=nc.resource("/"),tc.yield($c.exists(),2);case 2:if(tc.yieldResult)return tc.return();ge=[{resource:$c}];ad=[{resource:nc.resource("package.json"),content:JSON.stringify(nc.config,
null,2)}];return tc.yield(Promise.all(ge.map(function(Tc){return Tc.resource.mkdir()})),3);case 3:return tc.yield(Promise.all(ad.map(function(Tc){var fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(uc){switch(uc.nextAddress){case 1:return uc.yield(Tc.resource.exists(),2);case 2:if(!(fb=!uc.yieldResult)){uc.jumpTo(3);break}return uc.yield(Tc.resource.write(Tc.content),4);case 4:fb=uc.yieldResult;case 3:return uc.return(fb)}})})),4);case 4:return tc.yield(nc.objectModule.ensureExistance(),
5);case 5:return ie=nc,Yb=ie.System,zb=ie.packageURL,Rc=ie.config,tc.yield(Bd.ensurePackage(Yb,zb),6);case 6:return Mc=tc.yieldResult,Mc.registerWithConfig(Rc),console.log(nc.packageURL+" REGISTERED"),tc.return(nc)}})};pe.prototype.ensureObjectClass=function(nc){var $c=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ge){return 1==ge.nextAddress?ge.yield($c.ensureExistance(),2):ge.return($c.objectModule.ensureObjectClass(nc))})};pe.prototype.adoptObject=function(nc){var $c=this,ge;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){if(1==ad.nextAddress)return $c.objectClass===nc.constructor?ad.return():ad.yield($c.ensureObjectClass(nc.constructor),2);ge=ad.yieldResult;Bd.adoptObject(nc,ge);ad.jumpToEnd()})};pe.prototype.addScript=function(nc,$c,ge){return this.objectModule.addScript(nc,$c,ge)};pe.prototype.remove=function(){this.systemPackage.remove();delete Bd.ObjectPackage.packageStore[this.id];return this.resource().remove()};pe.prototype.renameObjectClass=function(nc,
$c){$c=void 0===$c?[]:$c;var ge=this,ad,ie,Yb,zb,Rc,Mc,tc,Tc,fb,uc,Rb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fc){if(1==Fc.nextAddress){ad=ge;ie=ad.objectClass;Yb=ad.System;if(!ie||ie[Symbol.for("__LivelyClassName__")]===nc)return Fc.return(ie);if(!Bd.isValidIdentifier(nc))throw Error(nc+" is not a valid name for a class");Rc=zb=Bd.RuntimeSourceDescriptor.for(ie,Yb);Mc=Rc.source;tc=Rc.ast;Tc=tc.id;fb=Tc.start;uc=Tc.end;return Fc.yield(zb.changeSource(Mc.slice(0,fb)+nc+Mc.slice(uc)),
2)}Rb=ge.objectClass;$c.forEach(function(Uc){Uc.constructor=Rb;Uc.__proto__=Rb.prototype});return Fc.return(Rb)})};pe.prototype.fork=function(nc,$c){var ge=this,ad,ie,Yb,zb,Rc,Mc,tc,Tc,fb,uc,Rb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fc){switch(Fc.nextAddress){case 1:return ad=ge,ie=ad.System,Yb=ad.baseURL,zb=ad.objectClass,$c=Object.assign({System:ie,baseURL:Yb},$c),Rc=Bd.RuntimeSourceDescriptor.for(zb),Mc=Rc._renamedSource(nc),tc=Mc.moduleSource,Tc=Bd.ObjectPackage.withId(nc,
$c),Fc.yield(Tc.ensureExistance(),2);case 2:return fb=Tc,uc=fb.objectModule,Rb=uc.systemModule,Fc.yield(Rb.load({format:"esm"}),3);case 3:return Fc.yield(Rb.changeSource(tc),4);case 4:return Fc.return(Tc)}})};$jscomp.global.Object.defineProperties(pe.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},name:{configurable:!0,enumerable:!0,get:function(){return this.id}},System:{configurable:!0,enumerable:!0,get:function(){return this.options.System}},baseURL:{configurable:!0,
enumerable:!0,get:function(){return this.options.baseURL}},packageURL:{configurable:!0,enumerable:!0,get:function(){return this.baseURL+("/"+this.id)}},config:{configurable:!0,enumerable:!0,get:function(){return{name:this.name,version:"0.1.0",lively:{isObjectPackage:!0}}}},systemPackage:{configurable:!0,enumerable:!0,get:function(){return Bd.lookupPackage(this.System,this.packageURL,!0).pkg}},objectModule:{configurable:!0,enumerable:!0,get:function(){return this._objectModule||(this._objectModule=
new Bd.ObjectModule("index.js",this))}},objectClass:{configurable:!0,enumerable:!0,get:function(){return this.objectModule.objectClass}}});$jscomp.global.Object.defineProperties(pe,{packageStore:{configurable:!0,enumerable:!0,get:function(){return this._packageStore||(this._packageStore=Bd._packageStore)}}});$a("default",pe);Bd.ObjectPackage=pe;var Se=function(nc,$c){if(!nc)throw Error("ObjectModule needs package!");if(!$c)throw Error("ObjectModule needs package!");this._moduleName=nc;this._objectPackage=
$c};Se.prototype.read=function(){return this.resource.read()};Se.prototype.write=function(nc){return this.resource.write(nc)};Se.prototype.ensureExistance=function(){var nc=this,$c,ge;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){switch(ad.nextAddress){case 1:return $c=nc.resource,ad.yield($c.exists(),2);case 2:if(ad.yieldResult){ad.jumpTo(3);break}return ad.yield($c.write("'format esm';\n"),4);case 4:ge={},nc.System.config({meta:(ge[nc.url]={format:"esm"},ge)});case 3:return ad.return(nc)}})};
Se.prototype.adoptObject=function(nc,$c){var ge=this,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ie){if(1==ie.nextAddress)return ge.objectClass===nc.constructor?ie.return():ie.yield(ge.ensureObjectClass(nc.constructor,$c),2);ad=ie.yieldResult;Bd.adoptObject(nc,ad);ie.jumpToEnd()})};Se.prototype.ensureObjectClass=function(nc,$c){var ge=this,ad=this.objectClass;return ad&&ad.prototype.__proto__===nc.prototype?ad:Promise.resolve(this.ensureObjectClassSource(nc,$c)).then(function(ie){var Yb=
ie.source,zb=ie.moduleId,Rc=ie.className,Mc=ie.bindings,tc=ge.System;ie=Bd.module(tc,zb);if(Mc)for(var Tc in Mc)ie.define(Tc,Mc[Tc]);Yb=Bd.runEval(Yb,{classTransform:Bd.classToFunctionTransform,sync:!0,targetModule:zb,System:tc});if(Yb.isError)throw Yb.value;Yb=ie.recorder[Rc];if(!Yb)throw Error("Failed to define class "+Rc+" in "+zb);return Yb})};Se.prototype.ensureObjectClassSource=function(nc,$c){return this.createDefaultClassDeclaration(nc,$c)};Se.prototype.createDefaultClassDeclaration=function(nc,
$c){nc=void 0===nc?Object:nc;$c=void 0===$c?!1:$c;var ge=this,ad,ie,Yb,zb,Rc,Mc,tc,Tc,fb,uc,Rb,Fc,Uc,vd,Xd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vc){switch(vc.nextAddress){case 1:ad=ge;ie=ad.System;Yb=ad.systemModule;zb=ad.objectPackage;$c=$c||Bd.string.capitalize(Bd.toJsIdentifier(zb.id));Rc=nc[Symbol.for("__LivelyClassName__")];Mc=!Rc;tc=Bd.globalClasses.includes(nc);Tc="";fb=null;if(Mc){Rc="__anonymous_superclass__";uc={};fb=(uc[Rc]=nc,uc);vc.jumpTo(2);break}if(tc){vc.jumpTo(2);
break}return vc.yield(Bd.ExportLookup.findExportOfValue(nc,ie),4);case 4:(Rb=vc.yieldResult)?(Fc=Bd.ImportInjector.run(ie,Yb.id,Yb.package(),"",Rb),Uc=Fc.standaloneImport,Tc+=Uc+"\n\n"):(vd={},fb=(vd[Rc]=nc,vd));case 2:return $c===Rc&&($c="Object"+$c),Xd="Object"===Rc?"class "+$c+" {}\n":"class "+$c+" extends "+Rc+" {}\n",Tc+="export default "+Xd+"\n",vc.yield(Yb.changeSource(Tc),5);case 5:return vc.yield(Yb.load(),6);case 6:return vc.return({source:Tc,className:$c,moduleId:ge.url,bindings:fb})}})};
Se.prototype.addScript=function(nc,$c,ge){var ad=this,ie,Yb,zb,Rc,Mc,tc,Tc,fb,uc,Rb,Fc,Uc,vd,Xd,vc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oc){switch(Oc.nextAddress){case 1:if(nc.constructor===ad.objectClass){ie=nc.constructor;Oc.jumpTo(2);break}return Oc.yield(ad.ensureObjectClass(nc.constructor),3);case 3:ie=Oc.yieldResult;case 2:Yb=ie;zb="function"===typeof $c?String($c):$c;Rc=Bd.parseFunction(zb);Mc=Bd.RuntimeSourceDescriptor.for(Yb,ad.System);ge||(ge=Bd.Path("id.name").get(Rc));
if(!ge)throw Error("No name, cannot add "+Bd.string.truncate(zb,30).replace(/\n/g,"")+"!");tc=Bd.toJsIdentifier(ge);console.assert("FunctionExpression"===Rc.type||"ArrowFunctionExpression"===Rc.type,"not a function expression but: "+Rc.type);Tc=Rc.params.map(function(pc){return zb.slice(pc.start,pc.end)});fb="BlockStatement"===Rc.body.type?zb.slice(Rc.body.start,Rc.body.end):"{ return "+zb.slice(Rc.body.start,Rc.body.end)+" }";uc=tc+"("+Tc.join(",")+") "+fb;"ArrowFunctionExpression"===Rc.type&&(Rc.type=
"FunctionExpression");Rb=Mc.source;Fc=Mc.ast;if(!Fc)throw Error("cannot find class decl of "+Mc.module.id);(Uc=Fc.body.body.find(function(pc){return pc.key.name===tc&&!pc.static}))?Rb=Rb.slice(0,Uc.start)+uc+Rb.slice(Uc.end):(vd=Rb.lastIndexOf("}"),Xd=Rb.slice(0,vd),vc=Rb.slice(vd),/\n\s*$/m.test(Xd)||(Xd+="\n"),uc=Bd.string.changeIndent(uc,"  ",1),/^[ ]*\n/m.test(vc)||(vc="\n"+vc),Rb=Xd+uc+vc);return Oc.yield(Mc.changeSource(Rb),4);case 4:return Oc.return({script:Yb.prototype[tc],klass:Yb,module:Mc.module.id,
methodName:tc})}})};$jscomp.global.Object.defineProperties(Se.prototype,{objectPackage:{configurable:!0,enumerable:!0,get:function(){return this._objectPackage}},objectClass:{configurable:!0,enumerable:!0,get:function(){var nc=this.systemModule;return nc.isLoaded()?nc.System.get(nc.id).default:null}},moduleName:{configurable:!0,enumerable:!0,get:function(){return this._moduleName}},systemModule:{configurable:!0,enumerable:!0,get:function(){return Bd.module(this.System,this.url)}},System:{configurable:!0,
enumerable:!0,get:function(){return this.objectPackage.System}},resource:{configurable:!0,enumerable:!0,get:function(){return this.objectPackage.resource(this.moduleName)}},url:{configurable:!0,enumerable:!0,get:function(){return this.resource.url}}});Bd.ObjectModule=Se;Bd.default=pe}}});
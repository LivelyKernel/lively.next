System.register("./__root_module__-37c88ebd.js kld-intersections ./object-classes-c991d4d3.js ./user-ui-72dbfbe5.js ./index-d9e4dc7e.js ./index-53f40a2c.js".split(" "),function(){var Wa,Ib,Sb,xc,ac,Cd,nd,Ud,bd,Ic,pd,yd,Ne,Pe,Ie,fd,me,Yb,Yc;return{setters:[function(Nd){Wa=Nd.M;Ib=Nd.ah;Sb=Nd.ad;xc=Nd.m;ac=Nd.ag;Cd=Nd.b;nd=Nd.f;Ud=Nd.c;bd=Nd.C;Ic=Nd.p;pd=Nd.r;yd=Nd.i;Ne=Nd.t;Pe=Nd.aA;Ie=Nd.aB;fd=Nd.d;me=Nd.az;Yb=Nd.a1},function(){},function(){},function(Nd){Yc=Nd.UserUI},function(){},function(){}],
execute:function(){var Nd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");Nd.Morph=Wa;Nd.HorizontalLayout=Ib;Nd.VerticalLayout=Sb;Nd.morph=xc;Nd.MorphicDB=ac;Nd.arr=Cd;Nd.fun=nd;Nd.string=Ud;Nd.Color=bd;Nd.pt=Ic;Nd.UserUI=Yc;Nd.resource=pd;var gd=function(Wb){var Cc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),Td=Cc.hasOwnProperty("WorldDashboard")&&"function"===typeof Cc.WorldDashboard?Cc.WorldDashboard:Cc.WorldDashboard=function(Ec){Ec&&Ec[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yd(Td,Wb,[{key:"onLoad",value:function(){if(!this.isComponent&&"undefined"!==typeof localStorage){var Ec=localStorage.getItem("lively.morphic-projects-filter");Ec&&this.ui.sortSelector.selection!=Ec&&(this.ui.sortSelector.selection=Ec)}}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",
this.ui.sortSelector.selection)}catch(Ec){console.error(Ec)}}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(Ec){Ec=void 0===Ec?$world:Ec;this.owner!=Ec&&Ec.addMorph(this);this.center=Ec.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(Ec){var Vd=Nd.UserUI.getCurrentUser();Ec=this.ui.searchField.fuzzyFilter(Ec,
function(Lb){return Lb._commit.name+Lb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return Nd.arr.sortBy(Ec,function(Lb){return-Lb._commit.timestamp});case "TEMPLATES":return Ec;case "MY PROJECTS":return Nd.arr.filter(Ec,function(Lb){return Lb._commit.author.name===Vd.name});case "PUBLISHED":return Ec}}},{key:"updateList",value:function(){var Ec=this;this.previews&&Nd.fun.debounceNamed("update world list",150,function(){Ec.ui.worldList.items=Ec.sortAndFilterPreviews(Ec.previews)})()}},
{key:"displayWorlds",value:function(){var Ec=this,Vd,Lb,ub,uc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(dc){switch(dc.nextAddress){case 1:return Ec.reset(),Vd=Ec.ui,Lb=Vd.loadingLabel,Lb.fit(),Lb.animate({opacity:1,duration:300}),dc.yield(Ec.db.latestCommits("world"),2);case 2:return ub=dc.yieldResult,dc.yield(Nd.resource("part://partial freezing/world preview").read(),3);case 3:return uc=dc.yieldResult,Ec.previews=ub.map(function(Zb){var Mc=Nd.morph({reactsToPointer:!1,fill:Nd.Color.transparent,
extent:uc.extent});Mc._commit=Zb;Mc.displayPreview=function(){var $a;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){if(1==$b.nextAddress)return $a=uc.copy(),$a._commit=Zb,$a.opacity=0,Mc.addMorph($a),$a.displayPreview(),$a.position=Nd.pt(0,0),$b.yield(Mc.whenRendered(),2);Mc.layout=new Nd.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});$b.jumpToEnd()})};return Mc}),dc.yield(Lb.animate({opacity:0,duration:300}),4);case 4:Ec.updateList(),0==ub.length&&(Ec.ui.noWorldWarning.center=
Ec.innerBounds().center(),Ec.ui.noWorldWarning.animate({visible:!0,duration:300})),dc.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(Ec){this.ui.closeButton.visible=Ec}},db:{serialize:!1,get:function(){return Nd.MorphicDB.default}},
ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],Cc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"WorldDashboard",version:"0.1.1-135"}}},{start:330,end:4417})}(Nd.Morph);gd=Nd.WorldDashboard;Nd.default=gd;var ae=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");ae.Morph=Wa;ae.touchInputDevice=Ne;ae.TilingLayout=Pe;ae.arr=Cd;ae.pt=Ic;gd=function(Wb){var Cc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),Td=Cc.hasOwnProperty("GrowingWorldList")&&"function"===typeof Cc.GrowingWorldList?Cc.GrowingWorldList:Cc.GrowingWorldList=function(Ec){Ec&&
Ec[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yd(Td,Wb,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(Ec){yd._get(Object.getPrototypeOf(Td.prototype),"onScroll",this).call(this,Ec);this.update()}},{key:"onChange",value:function(Ec){yd._get(Object.getPrototypeOf(Td.prototype),"onChange",this).call(this,Ec);"extent"==Ec.prop&&this.update(!0)}},{key:"onHoverIn",value:function(Ec){this.clipMode=
"auto"}},{key:"onHoverOut",value:function(Ec){ae.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(Ec){var Vd=this.items;if(Vd&&0!=Vd.length){var Lb=this.scrollContainer,ub=Lb.layout.spacing;Lb.extent=this.extent;var uc=this.ui,dc=uc.bufferTop;uc=uc.bufferBottom;dc=dc||Lb.addMorph({fill:null,name:"buffer top",height:10});uc=uc||Lb.addMorph({fill:null,name:"buffer bottom",height:10});dc.width=uc.width=this.width-100;Lb.layout.disable();var Zb=Vd[0];ub=Vd.slice(0,Math.floor(this.width/
(Zb.width+ub))*(Math.ceil((this.scroll.y+this.height)/(Zb.height+ub))+1)).filter(function(Eb){return Eb.owner!=Lb});Zb=this.scroll.y+2*this.height;for(var Mc={},$a=$jscomp.makeIterator(ub),$b=$a.next();!$b.done;Mc={$jscomp$loop$prop$item$2869:Mc.$jscomp$loop$prop$item$2869},$b=$a.next())Mc.$jscomp$loop$prop$item$2869=$b.value,Zb++,Mc.$jscomp$loop$prop$item$2869.top=Zb,Lb.addMorph(Mc.$jscomp$loop$prop$item$2869),Mc.$jscomp$loop$prop$item$2869._initialized||Mc.$jscomp$loop$prop$item$2869.whenRendered().then(function(Eb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){Eb.$jscomp$loop$prop$item$2869._initialized=
!0;return kc.yield(Eb.$jscomp$loop$prop$item$2869.displayPreview(),0)})}}(Mc));Ec&&(dc.position=ae.pt(0,0),Vd.forEach(function(Eb,kc){return Eb.position=ae.pt(kc+1,kc+1)}),uc.position=ae.pt(Vd.length+2,Vd.length+2));Lb.layout.enable();if(Ec||0<ub.length)uc.top=this.submorphBounds().height,Lb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new ae.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(Ec){this.setProperty("items",Ec);var Vd=this.scrollContainer;Vd.layout&&Vd.layout.disable();var Lb=this.ui,ub=Lb.bufferTop;Lb=Lb.bufferBottom;ae.arr.withoutAll(Vd.submorphs,
[].concat($jscomp.arrayFromIterable(Ec),[ub,Lb])).forEach(function(uc){return uc.remove()});this.update(!0)}}}}}],Cc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(ae.Morph);gd=ae.GrowingWorldList;ae.default=gd;var Fe=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
Fe.InputLine=Ie;Fe.Color=bd;Fe.connect=fd;Fe.disconnectAll=me;Fe.disconnect=Yb;Fe.arr=Cd;Fe.string=Ud;gd=function(Wb){var Cc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),Td=Cc.hasOwnProperty("SearchInputLine")&&"function"===typeof Cc.SearchInputLine?Cc.SearchInputLine:Cc.SearchInputLine=function(Ec){Ec&&Ec[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yd(Td,Wb,[{key:"fuzzyMatch",value:function(Ec,Vd){Vd=void 0===
Vd?this.parseInput():Vd;if(Vd.lowercasedTokens.every(function(ub){return Ec.toLowerCase().includes(ub)}))return!0;var Lb=Ec.toLowerCase();return 3>=Fe.arr.sum(Vd.lowercasedTokens.map(function(ub){return Fe.string.levenshtein(Lb,ub)}))}},{key:"fuzzyFilter",value:function(Ec,Vd){var Lb=this;Vd=void 0===Vd?function(uc){return uc}:Vd;var ub=this.parseInput();return Fe.arr.filter(Ec,function(uc){return Lb.fuzzyMatch(Vd(uc),ub)})}},{key:"parseInput",value:function(){var Ec=Array.from(this.textString).reduce(function(Lb,
ub){if("\\"===ub&&!Lb.escaped)return Lb.escaped=!0,Lb;" "!==ub||Lb.escaped?(Lb.spaceSeen=!1,Lb.current+=ub):(!Lb.spaceSeen&&Lb.current&&(Lb.tokens.push(Lb.current),Lb.current=""),Lb.spaceSeen=!0);Lb.escaped=!1;return Lb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});Ec.current&&Ec.tokens.push(Ec.current);var Vd=Ec.tokens.map(function(Lb){return Lb.toLowerCase()});return{tokens:Ec.tokens,lowercasedTokens:Vd}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],Cc,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(Fe.InputLine);gd=Fe.SearchInputLine;Fe.default=gd}}});
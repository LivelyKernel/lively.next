System.register("./__root_module__-896eff71.js kld-intersections ./object-classes-261b7ba8.js ./user-ui-e35c48e6.js ./index-28129ea8.js ./index-4b5fc10c.js".split(" "),function(){var $a,Vb,jc,Wc,wc,Ud,Kd,he,xd,gd,Ld,Pd,af,bf,Ve,Ad,xe,qc,td;return{setters:[function(be){$a=be.M;Vb=be.ah;jc=be.ad;Wc=be.m;wc=be.ag;Ud=be.b;Kd=be.f;he=be.c;xd=be.C;gd=be.p;Ld=be.r;Pd=be.i;af=be.t;bf=be.aA;Ve=be.aB;Ad=be.d;xe=be.az;qc=be.a1},function(){},function(){},function(be){td=be.UserUI},function(){},function(){}],
execute:function(){var be=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");be.Morph=$a;be.HorizontalLayout=Vb;be.VerticalLayout=jc;be.morph=Wc;be.MorphicDB=wc;be.arr=Ud;be.fun=Kd;be.string=he;be.Color=xd;be.pt=gd;be.UserUI=td;be.resource=Ld;var Bd=function(nc){var $c=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),ge=$c.hasOwnProperty("WorldDashboard")&&"function"===typeof $c.WorldDashboard?$c.WorldDashboard:$c.WorldDashboard=function(ad){ad&&ad[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Pd(ge,nc,[{key:"onLoad",value:function(){if(!this.isComponent&&"undefined"!==typeof localStorage){var ad=localStorage.getItem("lively.morphic-projects-filter");ad&&this.ui.sortSelector.selection!=ad&&(this.ui.sortSelector.selection=ad)}}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",
this.ui.sortSelector.selection)}catch(ad){console.error(ad)}}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(ad){ad=void 0===ad?$world:ad;this.owner!=ad&&ad.addMorph(this);this.center=ad.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(ad){var ie=be.UserUI.getCurrentUser();ad=this.ui.searchField.fuzzyFilter(ad,
function(Yb){return Yb._commit.name+Yb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return be.arr.sortBy(ad,function(Yb){return-Yb._commit.timestamp});case "TEMPLATES":return ad;case "MY PROJECTS":return be.arr.filter(ad,function(Yb){return Yb._commit.author.name===ie.name});case "PUBLISHED":return ad}}},{key:"updateList",value:function(){var ad=this;this.previews&&be.fun.debounceNamed("update world list",150,function(){ad.ui.worldList.items=ad.sortAndFilterPreviews(ad.previews)})()}},
{key:"displayWorlds",value:function(){var ad=this,ie,Yb,zb,Rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){switch(Mc.nextAddress){case 1:return ad.reset(),ie=ad.ui,Yb=ie.loadingLabel,Yb.fit(),Yb.animate({opacity:1,duration:300}),Mc.yield(ad.db.latestCommits("world"),2);case 2:return zb=Mc.yieldResult,Mc.yield(be.resource("part://partial freezing/world preview").read(),3);case 3:return Rc=Mc.yieldResult,ad.previews=zb.map(function(tc){var Tc=be.morph({reactsToPointer:!1,fill:be.Color.transparent,
clipMode:"hidden",dropShadow:Rc.dropShadow,extent:Rc.extent});Tc._commit=tc;Tc.displayPreview=function(){var fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(uc){if(1==uc.nextAddress)return fb=Rc.copy(),fb.dropShadow=null,fb._commit=tc,fb.opacity=0,Tc.addMorph(fb),fb.displayPreview(),fb.position=be.pt(0,0),uc.yield(Tc.whenRendered(),2);Tc.layout=new be.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});uc.jumpToEnd()})};return Tc}),Mc.yield(Yb.animate({opacity:0,duration:300}),
4);case 4:ad.updateList(),0==zb.length&&(ad.ui.noWorldWarning.center=ad.innerBounds().center(),ad.ui.noWorldWarning.animate({visible:!0,duration:300})),Mc.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(ad){this.ui.closeButton.visible=
ad}},db:{serialize:!1,get:function(){return be.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],$c,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-140"}}},{start:330,end:4524})}(be.Morph);Bd=be.WorldDashboard;be.default=Bd;var pe=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");pe.Morph=$a;pe.touchInputDevice=af;pe.TilingLayout=bf;pe.arr=Ud;pe.pt=gd;Bd=function(nc){var $c=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),ge=$c.hasOwnProperty("GrowingWorldList")&&"function"===typeof $c.GrowingWorldList?
$c.GrowingWorldList:$c.GrowingWorldList=function(ad){ad&&ad[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Pd(ge,nc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(ad){Pd._get(Object.getPrototypeOf(ge.prototype),"onScroll",this).call(this,ad);this.update()}},{key:"onChange",value:function(ad){Pd._get(Object.getPrototypeOf(ge.prototype),"onChange",this).call(this,ad);"extent"==ad.prop&&this.update(!0)}},
{key:"onHoverIn",value:function(ad){this.clipMode="auto"}},{key:"onHoverOut",value:function(ad){pe.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(ad){var ie=this.items;if(ie&&0!=ie.length){var Yb=this.scrollContainer,zb=Yb.layout.spacing;Yb.extent=this.extent;var Rc=this.ui,Mc=Rc.bufferTop;Rc=Rc.bufferBottom;Mc=Mc||Yb.addMorph({fill:null,name:"buffer top",height:10});Rc=Rc||Yb.addMorph({fill:null,name:"buffer bottom",height:10});Mc.width=Rc.width=this.width-100;Yb.layout.disable();
var tc=ie[0];zb=ie.slice(0,Math.floor(this.width/(tc.width+zb))*(Math.ceil((this.scroll.y+this.height)/(tc.height+zb))+1)).filter(function(Rb){return Rb.owner!=Yb});tc=this.scroll.y+2*this.height;for(var Tc={},fb=$jscomp.makeIterator(zb),uc=fb.next();!uc.done;Tc={$jscomp$loop$prop$item$3009:Tc.$jscomp$loop$prop$item$3009},uc=fb.next())Tc.$jscomp$loop$prop$item$3009=uc.value,tc++,Tc.$jscomp$loop$prop$item$3009.top=tc,Yb.addMorph(Tc.$jscomp$loop$prop$item$3009),Tc.$jscomp$loop$prop$item$3009._initialized||
Tc.$jscomp$loop$prop$item$3009.whenRendered().then(function(Rb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fc){Rb.$jscomp$loop$prop$item$3009._initialized=!0;return Fc.yield(Rb.$jscomp$loop$prop$item$3009.displayPreview(),0)})}}(Tc));ad&&(Mc.position=pe.pt(0,0),ie.forEach(function(Rb,Fc){return Rb.position=pe.pt(Fc+1,Fc+1)}),Rc.position=pe.pt(ie.length+2,ie.length+2));Yb.layout.enable();if(ad||0<zb.length)Rc.top=this.submorphBounds().height,Yb.layout.apply()}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new pe.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout",
"scrollContainer"],set:function(ad){this.setProperty("items",ad);var ie=this.scrollContainer;ie.layout&&ie.layout.disable();var Yb=this.ui,zb=Yb.bufferTop;Yb=Yb.bufferBottom;pe.arr.withoutAll(ie.submorphs,[].concat($jscomp.arrayFromIterable(ad),[zb,Yb])).forEach(function(Rc){return Rc.remove()});this.update(!0)}}}}}],$c,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(pe.Morph);Bd=pe.GrowingWorldList;pe.default=Bd;var Se=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");Se.InputLine=Ve;Se.Color=xd;Se.connect=Ad;Se.disconnectAll=xe;Se.disconnect=qc;Se.arr=Ud;Se.string=he;Bd=function(nc){var $c=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),ge=$c.hasOwnProperty("SearchInputLine")&&"function"===typeof $c.SearchInputLine?$c.SearchInputLine:$c.SearchInputLine=
function(ad){ad&&ad[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Pd(ge,nc,[{key:"fuzzyMatch",value:function(ad,ie){ie=void 0===ie?this.parseInput():ie;if(ie.lowercasedTokens.every(function(zb){return ad.toLowerCase().includes(zb)}))return!0;var Yb=ad.toLowerCase();return 3>=Se.arr.sum(ie.lowercasedTokens.map(function(zb){return Se.string.levenshtein(Yb,zb)}))}},{key:"fuzzyFilter",value:function(ad,ie){var Yb=this;ie=void 0===
ie?function(Rc){return Rc}:ie;var zb=this.parseInput();return Se.arr.filter(ad,function(Rc){return Yb.fuzzyMatch(ie(Rc),zb)})}},{key:"parseInput",value:function(){var ad=Array.from(this.textString).reduce(function(Yb,zb){if("\\"===zb&&!Yb.escaped)return Yb.escaped=!0,Yb;" "!==zb||Yb.escaped?(Yb.spaceSeen=!1,Yb.current+=zb):(!Yb.spaceSeen&&Yb.current&&(Yb.tokens.push(Yb.current),Yb.current=""),Yb.spaceSeen=!0);Yb.escaped=!1;return Yb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});ad.current&&ad.tokens.push(ad.current);
var ie=ad.tokens.map(function(Yb){return Yb.toLowerCase()});return{tokens:ad.tokens,lowercasedTokens:ie}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],$c,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(Se.InputLine);Bd=Se.SearchInputLine;
Se.default=Bd}}});
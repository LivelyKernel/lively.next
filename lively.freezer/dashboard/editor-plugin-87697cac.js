System.register(["./__root_module__-64e296ea.js","kld-intersections","./index-1222f918.js","./editor-plugin-c8470ec8.js","./index-9c46491a.js"],function(Ba){var Ab,Qb,dc,Xb,Xd,ad,Nd,dd,Lc,rd,Gd,ke,Kd,Hc,fb,Db,mc,hc,Tc,Ld,oc,pc,Nb,Dc;return{setters:[function(Vc){Ab=Vc.at;Qb=Vc.bC;dc=Vc.bD;Xb=Vc.bE;Xd=Vc.F;ad=Vc.ar;Nd=Vc.aY;dd=Vc.s;Lc=Vc.ab;rd=Vc.bp;Gd=Vc.a6;ke=Vc.$;Kd=Vc.bF;Hc=Vc.bw},function(){},function(Vc){fb=Vc.s},function(Vc){Db=Vc.p;mc=Vc.d;hc=Vc.a;Tc=Vc.r;Ld=Vc.C},function(Vc){oc=Vc.localInterface;
pc=Vc.systemInterfaceNamed;Nb=Vc.serverInterfaceFor;Dc=Vc.l2lInterfaceFor}],execute:function(){var Vc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");Vc.warnStyle={"border-bottom":"2px dotted orange"};Vc.errorStyle={"background-color":"red"};var Hd=function(vc){var fc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),rc=fc.hasOwnProperty("JavaScriptChecker")&&"function"===typeof fc.JavaScriptChecker?fc.JavaScriptChecker:fc.JavaScriptChecker=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(rc,vc,[{key:"uninstall",value:function(Q){var ha=Q.text||Q;(ha.markers||[]).forEach(function(Ga){return Ga.id.startsWith("js-checker-")&&ha.removeMarker(Ga)});ha.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(Q,ha){return[].concat($jscomp.arrayFromIterable(Q.embeddedMorphMap.values())).find(function(Ga){return ha.containsPosition(Ga.anchor.position)})}},{key:"onDocumentChange",value:function(Q,
ha,Ga){var La=ha.document;try{var Yb=Ga.parse()}catch(kc){Yb=kc}Yb&&(Q=(ha.markers||[]).filter(function(kc){return kc.id.startsWith("js-checker-")}),Ga=Ga.undeclaredVariables().map(function(kc,Ua){var ec=kc.start;kc=kc.end;ec=La.indexToPosition(ec);kc=La.indexToPosition(kc);return ha.addMarker({id:"js-checker-"+Ua,style:Vc.warnStyle,range:{start:ec,end:kc},type:"js-undeclared-var"})}),Q.slice(Ga.length).forEach(function(kc){return ha.removeMarker(kc)}),Yb.parseError?(Q=Yb.parseError.loc,Ga=Q.column,
Q=Q.line-1,Yb=La.indexToPosition(Yb.parseError.pos),Ga=Yb.column,Q=Yb.row,Yb={start:{column:Ga-1,row:Q},end:{column:Ga+1,row:Q}},this.hasEmbeddedMorphInRange(ha,Yb)||ha.addMarker({id:"js-syntax-error",range:Yb,style:Vc.errorStyle,type:"js-syntax-error"})):ha.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],fc,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),Id=Hd=Vc.JavaScriptChecker;Vc.default=Hd;var rb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");rb.query=Qb;rb.fuzzyParse=dc;rb.acorn=Xb;rb.custom=Xd;var Hb=function(vc){var fc=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),rc=fc.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof fc.JavaScriptNavigator?
fc.JavaScriptNavigator:fc.JavaScriptNavigator=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(rc,vc,[{key:"ensureAST",value:function(Q){return this.parse(Q.textString)}},{key:"parse",value:function(Q){return rb.fuzzyParse(Q)}},{key:"move",value:function(Q,ha){var Ga=!!ha.activeMark||!ha.selection.isEmpty(),La=ha.selection,Yb=ha.positionToIndex(La.lead);Q=this[Q](ha.textString,Yb);Q=ha.indexToPosition(Q);La.lead=
Q;Ga||(La.anchor=Q);ha.scrollCursorIntoView()}},{key:"forwardSexp",value:function(Q){this.move("_forwardSexp",Q)}},{key:"backwardSexp",value:function(Q){this.move("_backwardSexp",Q)}},{key:"backwardUpSexp",value:function(Q){this.move("_backwardUpSexp",Q)}},{key:"forwardDownSexp",value:function(Q){this.move("_forwardDownSexp",Q)}},{key:"_forwardSexp",value:function(Q,ha){Q=this.parse(Q);Q=rb.custom.findNodesIncluding(Q,ha).reverse().find(function(La){return La.end!==ha});if(!Q)return ha;if("BlockStatement"===
Q.type){var Ga=Q.body.find(function(La){return La.start>ha});if(Ga)return Ga.start}return Q.end}},{key:"_backwardSexp",value:function(Q,ha){Q=this.parse(Q);Q=rb.custom.findNodesIncluding(Q,ha).reverse().find(function(La){return La.start!==ha});if(!Q)return ha;if("BlockStatement"===Q.type){var Ga=Q.body.slice().reverse().find(function(La){return La.end<ha});if(Ga)return Ga.end}return Q?Q.start:ha}},{key:"_backwardUpSexp",value:function(Q,ha){Q=this.parse(Q);return(Q=rb.custom.findNodesIncluding(Q,
ha).reverse().find(function(Ga){return Ga.start!==ha}))?Q.start:ha}},{key:"_forwardDownSexp",value:function(Q,ha){Q=this.parse(Q);return(Q=rb.custom.findNodeAfter(Q,ha,function(Ga,La){return La.start>ha}))?Q.node.start:ha}},{key:"markDefun",value:function(Q){var ha=this.rangeForFunctionOrDefinition(Q.textString,[Q.positionToIndex(Q.selection.range.start),Q.positionToIndex(Q.selection.range.end)]);ha&&Q.execCommand("expandRegion",{start:ha[0],end:ha[1]})}},{key:"rangeForNodesMatching",value:function(Q,
ha,Ga){Q=this.parse(Q);return(ha=rb.custom.findNodesIncluding(Q,ha).reverse().find(Ga))?[ha.start,ha.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(Q,ha){var Ga=ha[0]===ha[1];return this.rangeForNodesMatching(Q,ha[1],function(La){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(La.type)&&(Ga&&La.end!==ha[1]||!Ga&&La.start<ha[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(Q,ha){"number"!==typeof ha&&(ha=Q.positionToIndex(ha));
Q=this.ensureAST(Q);var Ga=rb.query.nodesAt(ha,Q).reverse(),La=Ga.find(function(kc){return"Identifier"===kc.type});if(!La&&((Ga=Ga[0])&&Ga.type.includes("Specifier")&&Ga.local&&"Identifier"===Ga.local.type&&(La=Ga.local),!La))return;ha=(Ga=rb.query.findDeclarationClosestToIndex(Q,La.name,ha))?rb.query.scopeAtIndex(Q,Ga.start):rb.query.scopeAtIndex(Q,ha);var Yb=rb.query.findReferencesAndDeclsInScope(ha,La.name).refs;return{parsed:Q,scope:ha,id:La,name:La.name,decl:Ga,refs:Yb}}},{key:"expandRegion",
value:function(Q,ha,Ga,La){function Yb(ge){ge=Q.positionToIndex({column:0,row:Ua.row});return{range:[ge+ec.start,ge+ec.start+ec.value.length],prev:La}}var kc=La.range[0]!==La.range[1],Ua=Q.indexToPosition(La.range[0]),ec=Q.tokenAt(Ua);if(!kc&&ec&&["keyword","identifier"].includes(ec.type))return Yb();Ga=Ga||this.parse(ha);ha=rb.query.nodesAtIndex(Ga,La.range[0]).reverse().find(function(ge){return ge.start<La.range[0]||ge.end>La.range[1]});if(!ha)return La;Ga=ha.start;kc=ha.end;return"Literal"===ha.type&&
(ha.raw||"").match(/^['"`]/)&&La.range[0]!==ha.start&&La.range[1]!==ha.end&&(ha.start+1<La.range[0]||ha.end-1>La.range[1])?{range:[Ga+1,kc-1],prev:La}:{range:[Ga,kc],prev:La}}},{key:"contractRegion",value:function(Q,ha,Ga,La){return La.prev||La}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],fc,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6780})}(void 0);Hd=Hb=rb.JavaScriptNavigator;rb.default=Hb;var Mc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");Mc.addIndexToTextPos=function(vc,fc,rc){return vc.indexToPosition(vc.positionToIndex(fc)+rc)};Mc.connect=ad;Mc.disconnect=Nd;Mc.string=dd;Mc.KeyHandler=Lc;Mc.Range=rd;Hb=function(vc){var fc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),rc=fc.hasOwnProperty("Snippet")&&"function"===
typeof fc.Snippet?fc.Snippet:fc.Snippet=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(rc,vc,[{key:Symbol.for("lively-instance-initialize"),value:function(Q){Q=void 0===Q?{trigger:null,expansion:""}:Q;var ha=Q.expansion;this.trigger=Q.trigger;this.expansion=ha;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(Q){this.isExpanding&&(this.textMorph=Q,Mc.connect(this.textMorph,
"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(Q){this.isExpanding&&(Mc.disconnect(Q,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var Q=this.expansionState,ha=Q.startAnchor,Ga=Q.endAnchor;Q.isExpanding?Mc.Range.fromPositions(ha.position,Ga.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var Q=this.textMorph;if(Q){var ha=
this.expansionState||{},Ga=ha.marker,La=ha.startAnchor,Yb=ha.endAnchor;ha=ha.steps;La&&Q.removeAnchor(La);Yb&&Q.removeAnchor(Yb);Ga&&Q.removeMarker(Ga);ha.forEach(function(kc){return Q.removeAnchor(kc.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};Q&&Q.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(Q){var ha=[],Ga=0;Mc.string.reMatches(Q,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(La){var Yb=
La.start,kc=La.end;La=La.match;var Ua="";La.startsWith("${")?(Ua=$jscomp.makeIterator(La.match(/^\$\{([0-9]+):([^\}]*)\}/)),Ua.next(),La=Ua.next().value,Ua=Ua.next().value,La=Number(La)):La=Number(La.replace(/^\$/,""));Q=Q.slice(0,Yb-Ga)+Ua+Q.slice(kc-Ga);ha[La]={index:Yb-Ga,prefill:Ua,anchor:null};Ga+=kc-Yb-Ua.length});return{steps:ha,expansion:Q}}},{key:"expandAtCursor",value:function(Q){var ha=Q.selection,Ga=Q.cursorPosition.column,La=this.expansion;this.trigger&&(Ga-=this.trigger.length);if(Ga=
Math.max(0,Ga))La=Mc.string.lines(La),La=[La[0]].concat($jscomp.arrayFromIterable(La.slice(1).map(function(ee){return Mc.string.indent(ee," ",Ga)}))),La=La.join("\n");var Yb=this.createExpansionSteps(La);La=Yb.expansion;Yb=Yb.steps;this.trigger&&ha.growLeft(this.trigger.length);ha.text=La;var kc=ha.start;La=ha.end;ha.collapseToEnd();if(Yb.length){var Ua=Mc.string.newUUID();Yb.forEach(function(ee,ed){return ee.anchor=Q.addAnchor(Object.assign({id:"snippet-step-"+ed+"-"+Ua},Mc.addIndexToTextPos(Q,kc,
ee.index)))});var ec=Q.addAnchor(Object.assign({id:"snippet-start-"+Ua},kc,{insertBehavior:"stay"})),ge=Q.addAnchor(Object.assign({id:"snippet-end-"+Ua},La));this.expansionState={marker:Q.addMarker({id:"snippet-marker-"+Ua,get range(){return{start:ec.position,end:ge.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:ec,endAnchor:ge,stepIndex:0,steps:Yb,isExpanding:!0};
Q.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var Q=this.expansionState,ha=Q.steps,Ga=this.textMorph;if(Q.isExpanding&&Ga){Ga=Ga.selection;Q=ha[Q.stepIndex];var La=Q.prefill;Ga.lead=Ga.anchor=Q.anchor.position;Ga.growRight(La.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=ha.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(Q,ha){ha=Q.positionToIndex(Q.cursorPosition);
return Q.textString.slice(ha-this.trigger.length,ha)===this.trigger}},{key:"tryTrigger",value:function(Q,ha){if(!this.canExpand(Q,Q.cursorPosition))return!1;this.expandAtCursor(Q);return!0}},{key:"getCommands",value:function(Q){var ha=this;return Q.concat([{name:"[snippet] next expansion step",exec:function(Ga){ha.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(Ga){ha.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(Q){return Q.concat(Mc.KeyHandler.withBindings([{keys:"Tab",
command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],fc,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:357,end:6029})}(void 0);Mc.Snippet=Hb;Mc.Snippet=Hb;Mc.Snippet=
Hb;var qb=[{name:"get snippets",exec:function(vc){return vc.pluginCollect("getSnippets",[])}}];Mc.snippetCommands=qb;Mc.snippetCommands=qb;Mc.snippetCommands=qb;var tb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");tb.buildEvalOpts=function(vc,fc){return vc.plugins.find(function(rc){return rc.isJSEditorPlugin}).sanatizedJsEnv(fc)};tb.Snippet=Hb;qb=function(vc){var fc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),rc=fc.hasOwnProperty("ModuleTopLevelVarCompleter")&&
"function"===typeof fc.ModuleTopLevelVarCompleter?fc.ModuleTopLevelVarCompleter:fc.ModuleTopLevelVarCompleter=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(rc,vc,[{key:"compute",value:function(Q,ha){var Ga,La,Yb,kc,Ua,ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ge){if(1==ge.nextAddress){La=(Ga=Q.pluginFind(function(ee){return ee.isJSEditorPlugin}))&&Ga.systemInterface();if(!La)return ge.return([]);
Yb=tb.buildEvalOpts(Q);kc=Yb.targetModule;return"local"===La.name?(Ua=Object.getOwnPropertyNames(La.getModule(kc).recorder),ge.jumpTo(2)):ge.yield(La.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+kc+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',
{targetModule:"lively://module-recorder-completer"}),3)}if(2!=ge.nextAddress){ec=ge.yieldResult;if(ec.isError)return ge.return([]);Ua=JSON.parse(ec.value)}Ua=Ua.filter(function(ee){return!ee.startsWith("defVar_")&&!["System","__currentLivelyModule","initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(ee)});return ge.return(Ua.map(function(ee){return{priority:1100,completion:ee}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],
fc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:227,end:1700})}(void 0);tb.ModuleTopLevelVarCompleter=qb;tb.ModuleTopLevelVarCompleter=qb;tb.ModuleTopLevelVarCompleter=qb;qb=function(vc){var fc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),rc=fc.hasOwnProperty("DynamicJavaScriptCompleter")&&
"function"===typeof fc.DynamicJavaScriptCompleter?fc.DynamicJavaScriptCompleter:fc.DynamicJavaScriptCompleter=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(rc,vc,[{key:"isValidPrefix",value:function(Q){return/\.[a-z0-9_]*$/i.test(Q)}},{key:"isMethodCallCompletion",value:function(Q){return Q.endsWith(")")&&0<Q.indexOf("(")}},{key:"isValidIdentifier",value:function(Q){if("string"!==typeof Q)return!1;this.isMethodCallCompletion(Q)&&
(Q=Q.slice(0,Q.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(Q)?!0:!1}},{key:"wrapInBrackets",value:function(Q){if(!isNaN(Number(Q))||Q.startsWith("Symbol."))return"["+Q+"]";var ha="";this.isMethodCallCompletion(Q)&&(ha=Q.slice(Q.indexOf("(")),Q=Q.slice(0,Q.indexOf("(")));return'["'+Q.replace(/"/g,'\\"')+'"]'+ha}},{key:"compute",value:function(Q){var ha=this,Ga,La,Yb,kc,Ua,ec,ge,ee,ed,ab,Rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pb){if(1==pb.nextAddress){Ga=Q.selection;
Ga.isEmpty()?(La=Q.getLine(Ga.lead.row),La=La.slice(La.lastIndexOf(":")+1,Ga.lead.column)):La=Ga.text.slice(Math.max(0,Ga.text.indexOf(":")),0);if(!ha.isValidPrefix(La))return pb.return([]);kc=(Yb=Q.pluginFind(function(bd){return bd.isJSEditorPlugin}))&&Yb.systemInterface();if(!kc)return pb.return([]);Ua=tb.buildEvalOpts(Q);return pb.yield(kc.dynamicCompletionsForPrefix(Ua.targetModule,La,Ua),2)}ec=pb.yieldResult;ge=ec.isError;ee=ec.value;ed=ec.completions;ab=ec.prefix;if(ge)return console.warn("javascript completer encountered error: "+
(ee.stack||ee)),pb.return([]);ed.reduce(function(bd,od){od=$jscomp.makeIterator(od);od.next();od=od.next().value;return bd+od.length},0);Rc=ed.reduce(function(bd,od,lb){od=$jscomp.makeIterator(od);var Sa=od.next().value;od=od.next().value;return bd.concat(od.map(function(qc){var le=ha.isValidIdentifier(qc);return{info:Sa,completion:qc,prefix:le?ab:"."+ab,customInsertionFn:le?ha.isMethodCallCompletion(qc)?function(Zd,Fe,Oc,te){Fe=te.start;te=te.end;Zd=Zd.replace(/\((.*)\)/,function(md){return"("+md.slice(1,
-1).split(", ").map(function(Eb,xa){return"${"+xa+":"+Eb+"}"}).join(", ")+")"});Zd=new tb.Snippet({expansion:Zd});Oc.replace({start:Fe,end:te},"");Zd.expandAtCursor(Oc)}:null:function(Zd,Fe,Oc,te){Zd=te.start;te=te.end;Fe={row:Zd.row,column:Zd.column-1};te="."===Oc.textInRange({start:Fe,end:Zd})?{start:Fe,end:te}:{start:Zd,end:te};Oc.replace(te,ha.wrapInBrackets(qc))}}}))},[]);Rc.forEach(function(bd,od){return Object.assign(bd,{priority:2E3+Rc.length-od})});return pb.return(Rc)})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DynamicJavaScriptCompleter"}}],fc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5085})}(void 0);tb.DynamicJavaScriptCompleter=qb;tb.DynamicJavaScriptCompleter=qb;tb.DynamicJavaScriptCompleter=qb;tb.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
qb=function(vc){var fc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),rc=fc.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof fc.JavaScriptKeywordCompleter?fc.JavaScriptKeywordCompleter:fc.JavaScriptKeywordCompleter=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(rc,vc,[{key:"compute",value:function(Q,ha){return tb.keywords.map(function(Ga){return{completion:Ga,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],fc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6087,end:6225})}(void 0);tb.JavaScriptKeywordCompleter=qb;tb.JavaScriptKeywordCompleter=qb;tb.JavaScriptKeywordCompleter=qb;qb=[new tb.DynamicJavaScriptCompleter,
new tb.JavaScriptKeywordCompleter,new tb.ModuleTopLevelVarCompleter];tb.completers=qb;tb.completers=qb;tb.completers=qb;var eb=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");eb.Snippet=Hb;var ob=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];eb.snippets=ob;eb.snippets=ob;eb.snippets=ob;var wb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");wb.getEvalEnv=function(vc){return(vc=vc.pluginFind(function(fc){return fc.isJSEditorPlugin}))?vc.evalEnvironment:null};wb.setEvalEnv=function(vc,fc){(vc=vc.pluginFind(function(rc){return rc.isJSEditorPlugin}))&&Object.assign(vc.evalEnvironment,fc);return vc.evalEnvironment};
wb.pToI=function(vc,fc){return vc.positionToIndex(fc)};wb.iToP=function(vc,fc){return vc.indexToPosition(fc)};wb.arr=Gd;wb.promise=ke;wb.string=dd;wb.show=fb;wb.Range=rd;wb.query=Qb;wb.BaseVisitor=Kd;eb=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(vc,fc){fc=void 0===fc?{varName:null,position:null}:fc;var rc,Q,ha,Ga,La,Yb,kc,Ua,ec,ge;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ee){switch(ee.nextAddress){case 1:rc=
fc;Q=rc.varName;ha=rc.position;if(!Q){ha||(ha=vc.cursorPosition);Ga=vc.pluginInvokeFirst("getNavigator");La=Ga.ensureAST(vc);Yb=wb.query.nodesAt(vc.positionToIndex(ha),La).reverse().find(function(ed){return"Identifier"===ed.type});if(!Yb)return vc.showError(Error("no identifier found!")),ee.return(!0);Q=Yb.name}fc=vc.pluginFind(function(ed){return ed.isJSEditorPlugin}).sanatizedJsEnv();kc='lively.modules.module("'+fc.targetModule+'").undefine("'+Q+'")';ee.setCatchFinallyBlocks(2);return ee.yield(vc.doEval(null,
fc,kc),4);case 4:Ua=ee.yieldResult;ec=Ua.error?Ua.error:Ua.isError?Ua.value:null;ee.leaveTryBlock(3);break;case 2:ec=ge=ee.enterCatchBlock();case 3:return ec?vc.showError(ec):vc.setStatusMessage(Q+" undefined"),ee.return(!0)}})}},{name:"change doitContext",exec:function(vc){var fc,rc,Q,ha,Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){if(1==La.nextAddress)return fc=$jscomp,rc=fc.makeIterator,La.yield(vc.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(Yb){return!Yb.isUsedAsEpiMorph()}}),2);Q=rc.call(fc,La.yieldResult);if(ha=Q.next().value)Ga="reset"===ha,vc.doitContext=Ga?null:ha,vc.setStatusMessage(Ga?"doitContext is now\n"+ha:"doitContext reset");return La.return(!0)})}},{name:"change eval backend",exec:function(vc,fc){fc=void 0===fc?{backend:void 0}:fc;var rc,Q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){if(1==ha.nextAddress)return rc=fc,Q=rc.backend,void 0!==Q?ha.jumpTo(2):
ha.yield(vc.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=ha.nextAddress&&(Q=ha.yieldResult,!Q))return vc.setStatusMessage("Canceled"),ha.return(!0);"local"===Q&&(Q=null);vc.setStatusMessage("Eval backend is now "+(Q||"local"));return ha.return(wb.setEvalEnv(vc,{remote:Q}))})}},{name:"copy current module name to clipboard",exec:function(vc){var fc=vc.evalEnvironment.targetModule;vc.setStatusMessage(fc||"Cannot find module name");vc.env.eventDispatcher.killRing.add(vc);
vc.env.eventDispatcher.doCopy(fc);return!0}}];wb.jsEditorCommands=eb;wb.jsEditorCommands=eb;wb.jsEditorCommands=eb;var cb=[{name:"[javascript] list errors and warnings",exec:function(vc){var fc,rc,Q,ha,Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){if(1==La.nextAddress){fc=(vc.markers||[]).filter(function(Yb){Yb=Yb.type;return"js-undeclared-var"===Yb||"js-syntax-error"===Yb});if(!fc.length)return wb.show("no warnings or errors"),La.return(!0);rc=fc.map(function(Yb){var kc=Yb.range;
return{isListItem:!0,string:"["+Yb.type.split("-").slice(1).join(" ")+"] "+vc.textInRange(kc),value:kc}});return La.yield(vc.world().filterableListPrompt("jump to warning or error",rc),2)}Q=La.yieldResult;ha=$jscomp.makeIterator(Q.selected);if(Ga=ha.next().value)vc.saveMark(),vc.selection=Ga,vc.centerRow(Ga.start.row);return La.return(!0)})}},{name:"[javascript] inject import",exec:function(vc,fc){fc=void 0===fc?{gotoImport:!1,insertImportAtCursor:!0}:fc;var rc,Q,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){switch(Ga.nextAddress){case 1:return Ga.yield(wb.promise.delay(0),
2);case 2:return Ga.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return rc=Ga.yieldResult,Q=rc.interactivelyInjectImportIntoText,Ga.yield(Q(vc,fc),4);case 4:return(ha=Ga.yieldResult)||vc.setStatusMessage("canceled"),Ga.return(ha)}})}},{name:"[javascript] fix undeclared variables",exec:function(vc,fc){fc=void 0===fc?{ignore:[],autoApplyIfSingleChoice:!1,requester:vc}:fc;var rc,Q,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){if(1==Ga.nextAddress)return Ga.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=Ga.nextAddress)return rc=Ga.yieldResult,Q=rc.interactivlyFixUndeclaredVariables,Ga.yield(Q(vc,fc),3);ha=Ga.yieldResult;vc.focus();return Ga.return(ha)})}},{name:"[javascript] remove unused imports",exec:function(vc,fc){fc=void 0===fc?{query:!0}:fc;var rc,Q,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){if(1==Ga.nextAddress)return Ga.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=Ga.nextAddress)return rc=Ga.yieldResult,Q=rc.cleanupUnusedImports,Ga.yield(Q(vc,
fc),3);ha=Ga.yieldResult;vc.setStatusMessage(ha);return Ga.return(!0)})}},{name:"[javascript] eslint report",exec:function(vc){var fc,rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Q){if(1==Q.nextAddress)return Q.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);fc=Q.yieldResult;rc=fc.default;try{return Q.return(rc.reportOnMorph(vc))}catch(ha){vc.showError(ha)}Q.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(vc){var fc,rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Q){if(1==
Q.nextAddress)return Q.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);fc=Q.yieldResult;rc=fc.default;try{return Q.return(rc.previewFixesOnMorph(vc))}catch(ha){vc.showError(ha)}Q.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(vc,fc,rc){function Q(pb,bd){bd||(bd=Ua(pb,{allowReturnOutsideFunction:!0}));var od=wb.string.lineRanges(pb),lb=pb.split("\n"),Sa=[],qc=new wb.BaseVisitor,le=qc.visitVariableDeclaration;qc.visitVariableDeclaration=function(te,
md,Eb){if(1<te.declarations.length)for(var xa=wb.string.findLineWithIndexInLineRanges(od,te.start),Ca=te.declarations[0].start-od[xa][0],Mb={},P=1;P<te.declarations.length;Mb={$jscomp$loop$prop$actionType$2418:Mb.$jscomp$loop$prop$actionType$2418,$jscomp$loop$prop$arg$2419:Mb.$jscomp$loop$prop$arg$2419},P++){var za=te.declarations[P],Ta=wb.string.findLineWithIndexInLineRanges(od,za.start);if(xa!==Ta){var Fb=lb[Ta].match(/\s*/)[0].length;Fb=Ca-Fb;0!==Fb&&(za=wb.string.findLineWithIndexInLineRanges(od,
za.end),Mb.$jscomp$loop$prop$actionType$2418=0<Fb?"insert":"delete",Mb.$jscomp$loop$prop$arg$2419=0<Fb?" ".repeat(Fb):-Fb,Sa.push.apply(Sa,$jscomp.arrayFromIterable(wb.arr.range(Ta,za).map(function(Cc){return function(Uc){return[Cc.$jscomp$loop$prop$actionType$2418,od[Uc][0],Cc.$jscomp$loop$prop$arg$2419]}}(Mb)))))}}return le.call(qc,te,md,Eb)};qc.accept(bd,{},[]);for(bd=Sa.length;bd--;){var Zd=$jscomp.makeIterator(Sa[bd]),Fe=Zd.next().value,Oc=Zd.next().value;Zd=Zd.next().value;"insert"===Fe?pb=
pb.slice(0,Oc)+Zd+pb.slice(Oc):"delete"===Fe&&(pb=pb.slice(0,Oc)+pb.slice(Oc+Zd))}return pb}var ha,Ga,La,Yb,kc,Ua,ec,ge,ee,ed,ab,Rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pb){switch(pb.nextAddress){case 1:return ha=rc||Math.floor(vc.width/vc.defaultCharExtent().width),fc=Object.assign({printWidth:ha,tabWidth:2,useTabs:!1,bracketSpacing:!1},fc),Ga=lively.modules.module,La=System.normalizeSync("prettier/standalone.js"),pb.yield(Ga(La).load({format:"global",instrument:!1}),2);case 2:return Yb=
pb.yieldResult,pb.yield(Ga("lively.ast/lib/acorn-extension.js").load(),3);case 3:return pb.yield(Ga("lively.ast").load(),4);case 4:return kc=pb.yieldResult,Ua=kc.parse,pb.yield(Ga("lively.ast/lib/query.js").load(),5);case 5:return pb.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return ec=pb.yieldResult,ge=vc.selection.isEmpty()?vc.documentRange:vc.selection.range,ee=vc.positionToIndex(ge.start),ed=vc.positionToIndex(ge.end),ab=Yb.format(vc.textString,Object.assign({},
fc,{rangeStart:ee,rangeEnd:ed,parser:function(bd,od,lb){return Ua(bd,{allowReturnOutsideFunction:!0})}})),vc.undoManager.group(),Rc=ec.diffChars(vc.textString,ab),vc.applyJsDiffPatch(Rc),vc.selection.text=Q(vc.selection.text),vc.undoManager.group(),pb.return(!0)}})}}];wb.jsIdeCommands=cb;wb.jsIdeCommands=cb;wb.jsIdeCommands=cb;var Oa=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(vc,fc){fc=vc.pluginInvokeFirst("getNavigator");if(!fc)return!0;fc=fc.resolveIdentifierAt(vc,vc.cursorPosition);
if(!fc||!fc.id)return wb.show("No symbol identifier selected"),!0;if(!fc.decl)return wb.show("Cannot find declaration of "+fc.name),!0;vc.saveMark();vc.selection={start:vc.indexToPosition(fc.decl.start),end:vc.indexToPosition(fc.decl.end)};vc.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(vc){vc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(vc){vc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(vc,fc){fc=void 0===fc?{direction:null}:fc;var rc=vc.pluginInvokeFirst("getNavigator");if(!rc)return!0;rc=rc.resolveIdentifierAt(vc,
vc.cursorPosition);if(!rc||!rc.refs)return wb.show("No symbol identifier selected"),!0;var Q=vc.selection;rc=rc.refs.map(function(Ga){var La=Ga.end;return wb.Range.fromPositions(wb.iToP(vc,Ga.start),wb.iToP(vc,La))}).concat(rc.decl?wb.Range.fromPositions(wb.iToP(vc,rc.decl.start),wb.iToP(vc,rc.decl.end)):[]).sort(wb.Range.compare);if(!rc.length)return!0;var ha=rc.map(String).indexOf(String(Q.range));if("next"===fc.direction||"prev"===fc.direction)-1===ha&&rc.length?rc=[rc[0]]:(fc=ha+("next"===fc.direction?
1:-1),0>fc?fc=rc.length-1:fc>=rc.length&&(fc=0),rc=[rc[fc]]);rc.forEach(function(Ga){var La=Q.selections.findIndex(function(kc){return kc.range.equals(Ga)}),Yb=Q.selections.length-1;-1<La?wb.arr.swap(Q.selections,La,Yb):Q.addRange(Ga,!1)});Q.mergeSelections();return!0}}];wb.astEditorCommands=Oa;wb.astEditorCommands=Oa;wb.astEditorCommands=Oa;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var Gb=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
Gb.expressionAllowed=function(vc,fc,rc){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(fc.lastType)||"quasi"==fc.lastType&&/\{\s*$/.test(vc.string.slice(0,vc.pos-(rc||0)))};Gb.passIndent=Db;Gb.defineMode=mc;Gb.defineMIME=hc;Gb.registerHelper=Tc;Gb.defaultConfig={indentUnit:2};Gb.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};Gb.defineMode("javascript",
function(vc,fc){function rc(Ub,td,ue){qi=Ub;ek=ue;return td}function Q(Ub,td){var ue=Ub.next();if('"'==ue||"'"==ue)return td.tokenize=ha(ue),td.tokenize(Ub,td);if("."==ue&&Ub.match(/^\d+(?:[eE][+\-]?\d+)?/))return rc("number","number");if("."==ue&&Ub.match(".."))return rc("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(ue))return rc(ue);if("="==ue&&Ub.eat(">"))return rc("=>","operator");if("0"==ue&&Ub.eat(/x/i))return Ub.eatWhile(/[\da-f]/i),rc("number","number");if("0"==ue&&Ub.eat(/o/i))return Ub.eatWhile(/[0-7]/i),
rc("number","number");if("0"==ue&&Ub.eat(/b/i))return Ub.eatWhile(/[01]/i),rc("number","number");if(/\d/.test(ue))return Ub.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),rc("number","number");if("/"==ue){if(Ub.eat("*"))return td.tokenize=Ga,Ga(Ub,td);if(Ub.eat("/"))return Ub.skipToEnd(),rc("comment","comment");if(Gb.expressionAllowed(Ub,td,1)){a:for(var Ud=td=!1;null!=(ue=Ub.next());){if(!td){if("/"==ue&&!Ud)break a;"["==ue?Ud=!0:Ud&&"]"==ue&&(Ud=!1)}td=!td&&"\\"==ue}Ub.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return rc("regexp","string-2")}Ub.eatWhile(mm);return rc("operator","operator",Ub.current())}if("`"==ue)return td.tokenize=La,La(Ub,td);if("#"==ue)return Ub.skipToEnd(),rc("error","error");if(mm.test(ue))return">"==ue&&td.lexical&&">"==td.lexical.type||Ub.eatWhile(mm),rc("operator","operator",Ub.current());if(rl.test(ue))return Ub.eatWhile(rl),Ub=Ub.current(),(ue=Al.propertyIsEnumerable(Ub)&&Al[Ub])&&"."!=td.lastType?rc(ue.type,ue.style,Ub):rc("variable","variable",Ub)}function ha(Ub){return function(td,
ue){var Ud=!1,pd;if(Hi&&"@"==td.peek()&&td.match(Uk))return ue.tokenize=Q,rc("jsonld-keyword","meta");for(;null!=(pd=td.next())&&(pd!=Ub||Ud);)Ud=!Ud&&"\\"==pd;Ud||(ue.tokenize=Q);return rc("string","string")}}function Ga(Ub,td){for(var ue=!1,Ud;Ud=Ub.next();){if("/"==Ud&&ue){td.tokenize=Q;break}ue="*"==Ud}return rc("comment","comment")}function La(Ub,td){for(var ue=!1,Ud;null!=(Ud=Ub.next());){if(!ue&&("`"==Ud||"$"==Ud&&Ub.eat("{"))){td.tokenize=Q;break}ue=!ue&&"\\"==Ud}return rc("quasi","string-2",
Ub.current())}function Yb(Ub,td){td.fatArrowAt&&(td.fatArrowAt=null);var ue=Ub.string.indexOf("=>",Ub.start);if(!(0>ue)){if(rj){var Ud=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Ub.string.slice(Ub.start,ue));Ud&&(ue=Ud.index)}Ud=0;var pd=!1;for(--ue;0<=ue;--ue){var Ig=Ub.string.charAt(ue),Ij="([{}])".indexOf(Ig);if(0<=Ij&&3>Ij){if(!Ud){++ue;break}if(0==--Ud){"("==Ig&&(pd=!0);break}}else if(3<=Ij&&6>Ij)++Ud;else if(rl.test(Ig))pd=!0;else{if(/["'\/]/.test(Ig))return;if(pd&&!Ud){++ue;break}}}pd&&
!Ud&&(td.fatArrowAt=ue)}}function kc(Ub,td,ue,Ud,pd,Ig){this.indented=Ub;this.column=td;this.type=ue;this.prev=pd;this.info=Ig;null!=Ud&&(this.align=Ud)}function Ua(){for(var Ub=arguments.length-1;0<=Ub;Ub--)Nf.cc.push(arguments[Ub])}function ec(){Ua.apply(null,arguments);return!0}function ge(Ub){function td(Ud){for(;Ud;Ud=Ud.next)if(Ud.name==Ub)return!0;return!1}var ue=Nf.state;Nf.marked="def";ue.context?td(ue.localVars)||(ue.localVars={name:Ub,next:ue.localVars}):!td(ue.globalVars)&&fc.globalVars&&
(ue.globalVars={name:Ub,next:ue.globalVars})}function ee(){Nf.state.context={prev:Nf.state.context,vars:Nf.state.localVars};Nf.state.localVars=Wk}function ed(){Nf.state.localVars=Nf.state.context.vars;Nf.state.context=Nf.state.context.prev}function ab(Ub,td){var ue=function(){var Ud=Nf.state,pd=Ud.indented;if("stat"==Ud.lexical.type)pd=Ud.lexical.indented;else for(var Ig=Ud.lexical;Ig&&")"==Ig.type&&Ig.align;Ig=Ig.prev)pd=Ig.indented;Ud.lexical=new kc(pd,Nf.stream.column(),Ub,null,Ud.lexical,td)};
ue.lex=!0;return ue}function Rc(){var Ub=Nf.state;Ub.lexical.prev&&(")"==Ub.lexical.type&&(Ub.indented=Ub.lexical.indented),Ub.lexical=Ub.lexical.prev)}function pb(Ub){function td(ue){return ue==Ub?ec():";"==Ub?Ua():ec(td)}return td}function bd(Ub,td){return"var"==Ub?ec(ab("vardef",td.length),Jc,pb(";"),Rc):"keyword a"==Ub?ec(ab("form"),Sa,bd,Rc):"keyword b"==Ub?ec(ab("form"),bd,Rc):"{"==Ub?ec(ab("}"),nf,Rc):";"==Ub?ec():"if"==Ub?("else"==Nf.state.lexical.info&&Nf.state.cc[Nf.state.cc.length-1]==
Rc&&Nf.state.cc.pop()(),ec(ab("form"),Sa,bd,Rc,Ja)):"function"==Ub?ec(zb):"for"==Ub?ec(ab("form"),$a,bd,Rc):"variable"==Ub?rj&&"type"==td?(Nf.marked="keyword",ec(Ce,pb("operator"),Ce,pb(";"))):ec(ab("stat"),za):"switch"==Ub?ec(ab("form"),Sa,pb("{"),ab("}","switch"),nf,Rc,Rc):"case"==Ub?ec(od,pb(":")):"default"==Ub?ec(pb(":")):"catch"==Ub?ec(ab("form"),ee,pb("("),Ec,pb(")"),bd,Rc,ed):"class"==Ub?ec(ab("form"),qd,Rc):"export"==Ub?ec(ab("stat"),yg,Rc):"import"==Ub?ec(ab("stat"),xf,Rc):"module"==Ub?ec(ab("form"),
of,pb("{"),ab("}"),nf,Rc,Rc):"async"==Ub?ec(bd):"@"==td?ec(od,bd):Ua(ab("stat"),od,pb(";"),Rc)}function od(Ub){return qc(Ub,!1)}function lb(Ub){return qc(Ub,!0)}function Sa(Ub){return"("!=Ub?Ua():ec(ab(")"),od,pb(")"),Rc)}function qc(Ub,td){if(Nf.state.fatArrowAt==Nf.stream.start){var ue=td?xa:Eb;if("("==Ub)return ec(ee,ab(")"),he(of,")"),Rc,pb("=>"),ue,ed);if("variable"==Ub)return Ua(ee,of,pb("=>"),ue,ed)}ue=td?Oc:Fe;return gn.hasOwnProperty(Ub)?ec(ue):"function"==Ub?ec(zb,ue):"class"==Ub?ec(ab("form"),
Gc,Rc):"keyword c"==Ub||"async"==Ub?ec(td?Zd:le):"("==Ub?ec(ab(")"),le,pb(")"),Rc,ue):"operator"==Ub||"spread"==Ub?ec(td?lb:od):"["==Ub?ec(ab("]"),qk,Rc,ue):"{"==Ub?we(Fb,"}",null,ue):"quasi"==Ub?Ua(te,ue):"new"==Ub?ec(Ca(td)):ec()}function le(Ub){return Ub.match(/[;\}\)\],]/)?Ua():Ua(od)}function Zd(Ub){return Ub.match(/[;\}\)\],]/)?Ua():Ua(lb)}function Fe(Ub,td){return","==Ub?ec(od):Oc(Ub,td,!1)}function Oc(Ub,td,ue){var Ud=0==ue?Fe:Oc,pd=0==ue?od:lb;if("=>"==Ub)return ec(ee,ue?xa:Eb,ed);if("operator"==
Ub)return/\+\+|--/.test(td)?ec(Ud):"?"==td?ec(od,pb(":"),pd):ec(pd);if("quasi"==Ub)return Ua(te,Ud);if(";"!=Ub){if("("==Ub)return we(lb,")","call",Ud);if("."==Ub)return ec(Ta,Ud);if("["==Ub)return ec(ab("]"),le,pb("]"),Rc,Ud)}}function te(Ub,td){return"quasi"!=Ub?Ua():"${"!=td.slice(td.length-2)?ec(te):ec(od,md)}function md(Ub){if("}"==Ub)return Nf.marked="string-2",Nf.state.tokenize=La,ec(te)}function Eb(Ub){Yb(Nf.stream,Nf.state);return Ua("{"==Ub?bd:od)}function xa(Ub){Yb(Nf.stream,Nf.state);return Ua("{"==
Ub?bd:lb)}function Ca(Ub){return function(td){return"."==td?ec(Ub?P:Mb):Ua(Ub?lb:od)}}function Mb(Ub,td){if("target"==td)return Nf.marked="keyword",ec(Fe)}function P(Ub,td){if("target"==td)return Nf.marked="keyword",ec(Oc)}function za(Ub){return":"==Ub?ec(Rc,bd):Ua(Fe,pb(";"),Rc)}function Ta(Ub){if("variable"==Ub)return Nf.marked="property",ec()}function Fb(Ub,td){if("async"==Ub)return Nf.marked="property",ec(Fb);if("variable"==Ub||"keyword"==Nf.style)return Nf.marked="property","get"==td||"set"==
td?ec(Cc):ec(Uc);if("number"==Ub||"string"==Ub)return Nf.marked=Hi?"property":Nf.style+" property",ec(Uc);if("jsonld-keyword"==Ub)return ec(Uc);if("modifier"==Ub)return ec(Fb);if("["==Ub)return ec(od,pb("]"),Uc);if("spread"==Ub)return ec(od);if(":"==Ub)return Ua(Uc)}function Cc(Ub){if("variable"!=Ub)return Ua(Uc);Nf.marked="property";return ec(zb)}function Uc(Ub){if(":"==Ub)return ec(lb);if("("==Ub)return Ua(zb)}function he(Ub,td,ue){function Ud(pd,Ig){return(ue?-1<ue.indexOf(pd):","==pd)?(pd=Nf.state.lexical,
"call"==pd.info&&(pd.pos=(pd.pos||0)+1),ec(function(Ij,$l){return Ij==td||$l==td?Ua():Ua(Ub)},Ud)):pd==td||Ig==td?ec():ec(pb(td))}return function(pd,Ig){return pd==td||Ig==td?ec():Ua(Ub,Ud)}}function we(Ub,td,ue){for(var Ud=3;Ud<arguments.length;Ud++)Nf.cc.push(arguments[Ud]);return ec(ab(td,ue),he(Ub,td),Rc)}function nf(Ub){return"}"==Ub?ec():Ua(bd,nf)}function yd(Ub,td){if(rj){if(":"==Ub)return ec(Ce);if("?"==td)return ec(yd)}}function Ce(Ub){if("variable"==Ub)return Nf.marked="variable-3",ec(Rf);
if("string"==Ub||"number"==Ub||"atom"==Ub)return ec(Rf);if("{"==Ub)return ec(ab("}"),he(Ie,"}",",;"),Rc);if("("==Ub)return ec(he(Fg,")"),wf)}function wf(Ub){if("=>"==Ub)return ec(Ce)}function Ie(Ub,td){if("variable"==Ub||"keyword"==Nf.style)return Nf.marked="property",ec(Ie);if("?"==td)return ec(Ie);if(":"==Ub)return ec(Ce)}function Fg(Ub){if("variable"==Ub)return ec(Fg);if(":"==Ub)return ec(Ce)}function Rf(Ub,td){if("<"==td)return ec(ab(">"),he(Ce,">"),Rc,Rf);if("|"==td||"."==Ub)return ec(Ce);if("["==
Ub)return ec(pb("]"),Rf);if("extends"==td)return ec(Ce)}function Jc(){return Ua(of,yd,qg,ff)}function of(Ub,td){if("modifier"==Ub)return ec(of);if("variable"==Ub)return ge(td),ec();if("spread"==Ub)return ec(of);if("["==Ub)return we(of,"]");if("{"==Ub)return we(pg,"}")}function pg(Ub,td){if("variable"==Ub&&!Nf.stream.match(/^\s*:/,!1))return ge(td),ec(qg);"variable"==Ub&&(Nf.marked="property");return"spread"==Ub?ec(of):"}"==Ub?Ua():ec(pb(":"),of,qg)}function qg(Ub,td){if("="==td)return ec(lb)}function ff(Ub){if(","==
Ub)return ec(Jc)}function Ja(Ub,td){if("keyword b"==Ub&&"else"==td)return ec(ab("form","else"),bd,Rc)}function $a(Ub){if("("==Ub)return ec(ab(")"),Bb,pb(")"),Rc)}function Bb(Ub){return"var"==Ub?ec(Jc,pb(";"),Ia):";"==Ub?ec(Ia):"variable"==Ub?ec(ba):Ua(od,pb(";"),Ia)}function ba(Ub,td){return"in"==td||"of"==td?(Nf.marked="keyword",ec(od)):ec(Fe,Ia)}function Ia(Ub,td){return";"==Ub?ec(nb):"in"==td||"of"==td?(Nf.marked="keyword",ec(od)):Ua(od,pb(";"),nb)}function nb(Ub){")"!=Ub&&ec(od)}function zb(Ub,
td){if("*"==td)return Nf.marked="keyword",ec(zb);if("variable"==Ub)return ge(td),ec(zb);if("("==Ub)return ec(ee,ab(")"),he(Ec,")"),Rc,yd,bd,ed);if(rj&&"<"==td)return ec(ab(">"),he(Ce,">"),Rc,zb)}function Ec(Ub){return"spread"==Ub?ec(Ec):Ua(of,yd,qg)}function Gc(Ub,td){return"variable"==Ub?qd(Ub,td):sd(Ub,td)}function qd(Ub,td){if("variable"==Ub)return ge(td),ec(sd)}function sd(Ub,td){if("<"==td)return ec(ab(">"),he(Ce,">"),Rc,sd);if("extends"==td||"implements"==td||rj&&","==Ub)return ec(rj?Ce:od,
sd);if("{"==Ub)return ec(ab("}"),vd,Rc)}function vd(Ub,td){if("variable"==Ub||"keyword"==Nf.style){if(("async"==td||"static"==td||"get"==td||"set"==td||rj&&("public"==td||"private"==td||"protected"==td||"readonly"==td||"abstract"==td))&&Nf.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Nf.marked="keyword",ec(vd);Nf.marked="property";return ec(rj?Cf:zb,vd)}if("["==Ub)return ec(od,pb("]"),rj?Cf:zb,vd);if("*"==td)return Nf.marked="keyword",ec(vd);if(";"==Ub)return ec(vd);if("}"==Ub)return ec();if("@"==
td)return ec(od,vd)}function Cf(Ub,td){return"?"==td?ec(Cf):":"==Ub?ec(Ce,qg):"="==td?ec(lb):Ua(zb)}function yg(Ub,td){return"*"==td?(Nf.marked="keyword",ec(Zh,pb(";"))):"default"==td?(Nf.marked="keyword",ec(od,pb(";"))):"{"==Ub?ec(he(fg,"}"),Zh,pb(";")):Ua(bd)}function fg(Ub,td){if("as"==td)return Nf.marked="keyword",ec(pb("variable"));if("variable"==Ub)return Ua(lb,fg)}function xf(Ub){return"string"==Ub?ec():Ua(ri,Lh,Zh)}function ri(Ub,td){if("{"==Ub)return we(ri,"}");"variable"==Ub&&ge(td);"*"==
td&&(Nf.marked="keyword");return ec(Aj)}function Lh(Ub){if(","==Ub)return ec(ri,Lh)}function Aj(Ub,td){if("as"==td)return Nf.marked="keyword",ec(ri)}function Zh(Ub,td){if("from"==td)return Nf.marked="keyword",ec(od)}function qk(Ub){return"]"==Ub?ec():Ua(he(lb,"]"))}vc=Object.assign({},Gb.defaultConfig,{},vc);fc=Object.assign({},Gb.defaultParserConfig,{},fc);var Gg=vc.indentUnit,fk=fc.statementIndent,Hi=fc.jsonld,dk=fc.json||Hi,rj=fc.typescript,rl=fc.wordCharacters||/[\w$\xa1-\uffff]/,Al=function(){function Ub($l){return{type:$l,
style:"keyword"}}var td=Ub("keyword a"),ue=Ub("keyword b"),Ud=Ub("keyword c"),pd=Ub("operator"),Ig={type:"atom",style:"atom"};td={if:Ub("if"),while:td,with:td,else:ue,do:ue,try:ue,finally:ue,return:Ud,break:Ud,continue:Ud,new:Ub("new"),delete:Ud,throw:Ud,debugger:Ud,var:Ub("var"),const:Ub("var"),let:Ub("var"),function:Ub("function"),catch:Ub("catch"),for:Ub("for"),switch:Ub("switch"),case:Ub("case"),default:Ub("default"),in:pd,typeof:pd,instanceof:pd,true:Ig,false:Ig,null:Ig,undefined:Ig,NaN:Ig,Infinity:Ig,
this:Ub("this"),class:Ub("class"),super:Ub("atom"),yield:Ud,export:Ub("export"),import:Ub("import"),extends:Ud,await:Ud,async:Ub("async")};if(rj){ue={type:"variable",style:"variable-3"};Ud={interface:Ub("class"),implements:Ud,namespace:Ud,module:Ub("module"),enum:Ub("module"),public:Ub("modifier"),private:Ub("modifier"),protected:Ub("modifier"),abstract:Ub("modifier"),as:pd,string:ue,number:ue,boolean:ue,any:ue};for(var Ij in Ud)td[Ij]=Ud[Ij]}return td}(),mm=/[+\-*&%=<>!?|~^@]/,Uk=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
qi,ek,gn={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Nf={state:null,column:null,marked:null,cc:null},Wk={name:"this",next:{name:"arguments"}};Rc.lex=!0;return{startState:function(Ub){Ub={tokenize:Q,lastType:"sof",cc:[],lexical:new kc((Ub||0)-Gg,0,"block",!1),localVars:fc.localVars,context:fc.localVars&&{vars:fc.localVars},indented:Ub||0};fc.globalVars&&"object"===typeof fc.globalVars&&(Ub.globalVars=fc.globalVars);return Ub},token:function(Ub,td){Ub.sol()&&(td.lexical.hasOwnProperty("align")||
(td.lexical.align=!1),td.indented=Ub.indentation(),Yb(Ub,td));if(td.tokenize!=Ga&&Ub.eatSpace())return null;var ue=td.tokenize(Ub,td);if("comment"==qi)return ue;td.lastType="operator"!=qi||"++"!=ek&&"--"!=ek?qi:"incdec";a:{var Ud=qi,pd=ek,Ig=td.cc;Nf.state=td;Nf.stream=Ub;Nf.marked=null;Nf.cc=Ig;Nf.style=ue;td.lexical.hasOwnProperty("align")||(td.lexical.align=!0);for(Ub=0;;){if(1E5<Ub++)throw Error("endless");if((Ig.length?Ig.pop():dk?od:bd)(Ud,pd)){for(;Ig.length&&Ig[Ig.length-1].lex;)Ig.pop()();
if(Nf.marked){ue=Nf.marked;break a}if(Ud="variable"==Ud)b:{for(Ud=td.localVars;Ud;Ud=Ud.next)if(Ud.name==pd){Ud=!0;break b}for(td=td.context;td;td=td.prev)for(Ud=td.vars;Ud;Ud=Ud.next)if(Ud.name==pd){Ud=!0;break b}Ud=void 0}if(Ud){ue="variable-2";break a}break a}}}return ue},indent:function(Ub,td){if(Ub.tokenize==Ga)return Gb.passIndent;if(Ub.tokenize!=Q)return 0;var ue=td&&td.charAt(0),Ud=Ub.lexical,pd;if(!/^\s*else\b/.test(td))for(var Ig=Ub.cc.length-1;0<=Ig;--Ig){var Ij=Ub.cc[Ig];if(Ij==Rc)Ud=
Ud.prev;else if(Ij!=Ja)break}for(;!("stat"!=Ud.type&&"form"!=Ud.type||"}"!=ue&&(!(pd=Ub.cc[Ub.cc.length-1])||pd!=Fe&&pd!=Oc||/^[,\.=+\-*:?[\(]/.test(td)));)Ud=Ud.prev;fk&&")"==Ud.type&&"stat"==Ud.prev.type&&(Ud=Ud.prev);pd=Ud.type;Ig=ue==pd;return(Ij=Ub._string)&&Ij.trimLeft().startsWith("?")&&":"===ue?Ij.indexOf("?"):Ij&&":"===Ub.lastType&&"}"!==Ud.type?Ij.match(/^\s*/)[0].length:"vardef"==pd?(td=Ud.indented+Ud.info+2+Ub.localVars.name.length,"?"===ue||":"===ue||"|"===ue||"&"===ue?td:","==Ub.lastType?
Ud.indented+Ud.info+1:"operator"==Ub.lastType?td+3:Ud.indented):"form"==pd&&"{"==ue?Ud.indented:"form"==pd?Ud.indented+Gg:"stat"==pd?(ue=Ud.indented,Ub="operator"==Ub.lastType||","==Ub.lastType||mm.test(td.charAt(0))||/[,.]/.test(td.charAt(0)),ue+(Ub?fk||Gg:0)):"switch"!=Ud.info||Ig||0==fc.doubleIndentSwitch?Ud.align?Ud.column+(Ig?0:1):Ud.indented+(Ig?0:Gg):Ud.indented+(/^(?:case|default)\b/.test(td)?Gg:2*Gg)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:dk?null:"/*",blockCommentEnd:dk?
null:"*/",lineComment:dk?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:dk?"json":"javascript",jsonldMode:Hi,jsonMode:dk,expressionAllowed:Gb.expressionAllowed,skipExpression:function(Ub){var td=Ub.cc[Ub.cc.length-1];td!=od&&td!=lb||Ub.cc.pop()}}});Gb.registerHelper("wordChars","javascript",/[\w$]/);Gb.defineMIME("text/javascript","javascript");Gb.defineMIME("text/ecmascript","javascript");Gb.defineMIME("application/javascript","javascript");Gb.defineMIME("application/x-javascript",
"javascript");Gb.defineMIME("application/ecmascript","javascript");Gb.defineMIME("application/json",{name:"javascript",json:!0});Gb.defineMIME("application/x-json",{name:"javascript",json:!0});Gb.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});Gb.defineMIME("text/typescript",{name:"javascript",typescript:!0});Gb.defineMIME("application/typescript",{name:"javascript",typescript:!0});var sc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");sc.string=dd;sc.JavaScriptChecker=
Id;sc.JavaScriptNavigator=Hd;sc.completers=qb;sc.jsSnippets=ob;sc.jsIdeCommands=cb;sc.jsEditorCommands=eb;sc.astEditorCommands=Oa;sc.CodeMirrorEnabledEditorPlugin=Ld;sc.Snippet=Hb;sc.parser=Hc;sc.localInterface=oc;sc.systemInterfaceNamed=pc;sc.serverInterfaceFor=Nb;sc.l2lInterfaceFor=Dc;Id=function(vc){var fc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),rc=fc.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof fc.JavaScriptEditorPlugin?fc.JavaScriptEditorPlugin:fc.JavaScriptEditorPlugin=
function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(rc,vc,[{key:Symbol.for("lively-instance-initialize"),value:function(){Ab._get(Object.getPrototypeOf(rc.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new sc.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(Q){Ab._get(Object.getPrototypeOf(rc.prototype),"attach",this).call(this,Q);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:Q})}},{key:"detach",value:function(Q){this.checker.uninstall(this.textMorph);Ab._get(Object.getPrototypeOf(rc.prototype),"detach",this).call(this,Q)}},{key:"getNavigator",value:function(){return new sc.JavaScriptNavigator}},{key:"getCompleters",value:function(Q){return sc.completers.concat(Q)}},
{key:"getCommands",value:function(Q){return[].concat($jscomp.arrayFromIterable(Ab._get(Object.getPrototypeOf(rc.prototype),"getCommands",this).call(this,Q)),$jscomp.arrayFromIterable(sc.jsIdeCommands),$jscomp.arrayFromIterable(sc.jsEditorCommands),$jscomp.arrayFromIterable(sc.astEditorCommands))}},{key:"getKeyBindings",value:function(Q){return[].concat($jscomp.arrayFromIterable(Q),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(Q){var ha=this,Ga,La,Yb,kc,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ec){Ga=ha.textMorph;La=[{command:"doit",target:Ga,showKeyShortcuts:!0},{command:"inspectit",target:Ga,showKeyShortcuts:!0},{command:"editit",target:Ga,showKeyShortcuts:!0},{command:"printit",target:Ga,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:Ga,showKeyShortcuts:!0},{command:"eval all",target:Ga,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:Ga,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:Ga,showKeyShortcuts:!0},{isDivider:!0}];ha.evalEnvironment.targetModule&&La.push({command:"[javascript] inject import",alias:"add import",target:Ga},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:Ga},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:Ga});Yb=ha.getNavigator();(kc=Yb.resolveIdentifierAt(Ga,
Ga.cursorPosition))&&La.push({command:"selectDefinition",alias:'jump to definition of "'+kc.name+'"',target:Ga},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+kc.name+'"',target:Ga});(Ua=Ga.selection.text.trim())&&La.push({command:"open code search",alias:'code search for "'+sc.string.truncate(Ua,30)+'"',target:Ga.world(),args:{input:Ua,backend:ha.backend()}});La.push({isDivider:!0});return ec.return(La.concat(Q))})}},{key:"getSnippets",value:function(){return sc.jsSnippets.map(function(Q){var ha=
$jscomp.makeIterator(Q);Q=ha.next().value;ha=ha.next().value;return new sc.Snippet({trigger:Q,expansion:ha})})}},{key:"sanatizedJsEnv",value:function(Q){Q=Object.assign({},this.evalEnvironment,{},Q);Q.format||(Q.formatd="esm");Q.context||(Q.context=this.textMorph);Q.sourceURL||(Q.sourceURL=Q.targetModule+"_doit_"+Date.now());Q.systemInterface||(Q.systemInterface=sc.localInterface);return Q}},{key:"backend",value:function(Q){Q=this.sanatizedJsEnv(Q);return Q.remote?Q.remote:"local"}},{key:"systemInterface",
value:function(Q){return this.sanatizedJsEnv(Q).systemInterface||sc.localInterface}},{key:"setSystemInterface",value:function(Q){return this.evalEnvironment.systemInterface=Q}},{key:"setSystemInterfaceNamed",value:function(Q){return this.setSystemInterface(sc.systemInterfaceNamed(Q))}},{key:"runEval",value:function(Q,ha){ha=this.sanatizedJsEnv(ha);return this.systemInterface(ha).runEval(Q,ha)}},{key:"parser",get:function(){return sc.parser}},{key:"parse",value:function(Q){Q=void 0===Q?null:Q;if(this._ast&&
this._ast._astType===Q)return this._ast;var ha=this.parser,Ga=this.textMorph.textString;if(!ha)return null;var La={withComments:!0,allowReturnOutsideFunction:!0};Q&&(La.type=Q);if(Ga.startsWith("#!")){var Yb=Ga.indexOf("\n");Ga=" ".repeat(Yb)+Ga.slice(Yb)}ha=ha.fuzzyParse(Ga,La);ha._astType=Q;return this._ast=ha}},{key:"undeclaredVariables",value:function(Q){var ha=this.parser,Ga=this.evalEnvironment.knownGlobals||[];Q=this.parse(void 0===Q?null:Q);return ha&&Q?ha.query.findGlobalVarRefs(Q,{jslintGlobalComment:!0}).filter(function(La){return!Ga.includes(La.name)}):
[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],fc,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(sc.CodeMirrorEnabledEditorPlugin);Id=sc.JavaScriptEditorPlugin;Ba("default",Id);sc.default=Id}}});
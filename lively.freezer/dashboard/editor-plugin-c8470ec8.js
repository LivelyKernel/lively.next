System.register(["./__root_module__-64e296ea.js","./index-1222f918.js","./index-9c46491a.js"],function(Ba){var Ab,Qb,dc,Xb,Xd,ad,Nd,dd,Lc,rd,Gd,ke,Kd,Hc,fb,Db,mc,hc,Tc,Ld,oc,pc,Nb,Dc,Vc,Hd,Id,rb,Hb,Mc,qb,tb,eb,ob,wb,cb,Oa,Gb,sc,vc,fc,rc,Q,ha,Ga;return{setters:[function(La){Ab=La.C;Qb=La.at;dc=La.a6;Xb=La.a1;Xd=La.a3;ad=La.ao;Nd=La.bi;dd=La.aW;Lc=La.ar;rd=La.s;Gd=La.aQ;ke=La.bp;Kd=La.bq;Hc=La.a7;fb=La.av;Db=La.aq;mc=La.as;hc=La.br;Tc=La.bs;Ld=La.a2;oc=La.P;pc=La.$;Nb=La.aY;Dc=La.aj;Vc=La.ak;Hd=
La.al;Id=La.am;rb=La.aC;Hb=La.a$;Mc=La.ay;qb=La.ap;tb=La.aa;eb=La.bt;ob=La.L;wb=La.bu;cb=La.b4;Oa=La.bj;Gb=La.b3;sc=La.bv;vc=La.au},function(La){fc=La.M;rc=La.I;Q=La.v;ha=La.p},function(La){Ga=La.localInterface}],execute:function(){function La(Ja,$a){if(!0===$a)return $a;if(Ja.copyState)return Ja.copyState($a);Ja={};for(var Bb in $a){var ba=$a[Bb];ba instanceof Array&&(ba=ba.concat([]));Ja[Bb]=ba}return Ja}function Yb(Ja,$a,Bb){return Ja.startState?Ja.startState($a,Bb):!0}function kc(Ja,$a){return P.modes[Ja]=
$a}function Ua(Ja){if("string"==typeof Ja&&P.mimeModes.hasOwnProperty(Ja))Ja=P.mimeModes[Ja];else if(Ja&&"string"==typeof Ja.name&&P.mimeModes.hasOwnProperty(Ja.name)){var $a=P.mimeModes[Ja.name];"string"==typeof $a&&($a={name:$a});Ja=Object.assign({},$a,Ja);Ja.name=$a.name}else{if("string"==typeof Ja&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ja))return Ua("application/xml");if("string"==typeof Ja&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ja))return Ua("application/json")}return"string"==typeof Ja?{name:Ja}:Ja||{name:"null"}}
function ec(Ja,$a){$a=P.resolveMode($a);"string"===typeof $a&&($a={name:$a});if(!$a.name)throw Error("parserConfig does not have a name of the mode to get");var Bb=P.modes[$a.name];if(!Bb)return ec(Ja,"text/plain");Ja=Object.assign({indentUnit:2},Ja);return Object.assign(Bb(Ja,$a),{name:$a.name})}function ge(Ja,$a){for(var Bb;Ja.innerMode;){Bb=Ja.innerMode($a);if(!Bb||Bb.mode==Ja)break;$a=Bb.state;Ja=Bb.mode}return Bb||{mode:Ja,state:$a}}function ee(Ja,$a){P.mimeModes[Ja]=$a}function ed(Ja,$a,Bb){}
function ab(Ja,$a,Bb,ba,Ia,nb,zb){var Ec=Ja.editorPlugin._tokenizerValidBefore;Ec&&Ec.row>=Bb&&(Ec.row=Bb-1);var Gc=P.linesToTokenize(Ja.document,Bb,ba,Ec);Ec=Gc.lines;Gc=Gc.state;if(!Ec.length)return!1;Gc=Gc?P.copyState($a,Gc):P.startState($a);for(var qd=0;qd<Ec.length;qd++){var sd=Ec[qd],vd=sd.row;vd>=Bb&&vd<=ba&&P.indentLine(Ja,$a,sd,Gc,Ia,nb,zb);Gc=P.tokenizeLine($a,Ec[qd],Gc,function(){})}return!0}function Rc(Ja,$a,Bb,ba,Ia,nb,zb){$a=P.linesToTokenize($a,Bb,ba,Ia);Bb=$a.lines;P.tokenizeLines(Ja,
Bb,$a.state,nb,zb);return Bb}function pb(Ja,$a,Bb,ba,Ia){var nb=[],zb,Ec=function(sd){return nb.push(zb=[])},Gc=function(sd,vd,Cf,yg,fg,xf,ri){return zb.push(Cf,yg,sd,fg.current(),vd.localMode||ri)};try{var qd=P.visitDocumentTokens(Ja,$a,Bb,ba,Ia,Ec,Gc)}catch(sd){nb.length=0,qd=P.visitDocumentTokens(Ja,$a,Bb,ba,null,Ec,Gc)}return{tokens:nb,lines:qd}}function bd(Ja,$a,Bb,ba,Ia){null==$a&&($a=Ja.search(/[^\s\u00a0]/),-1==$a&&($a=Ja.length));ba=ba||0;for(Ia=Ia||0;;){var nb=Ja.indexOf("\t",ba);if(0>nb||
nb>=$a)return Ia+($a-ba);Ia+=nb-ba;Ia+=Bb-Ia%Bb;ba=nb+1}}function od(Ja){Ja=Ja.toLowerCase();for(var $a=0;$a<P.modeInfo.length;$a++){var Bb=P.modeInfo[$a];if(Bb.mime==Ja)return Bb;if(Bb.mimes)for(var ba=0;ba<Bb.mimes.length;ba++)if(Bb.mimes[ba]==Ja)return Bb}if(/\+xml$/.test(Ja))return od("application/xml");if(/\+json$/.test(Ja))return od("application/json")}function lb(Ja){for(var $a=0;$a<P.modeInfo.length;$a++){var Bb=P.modeInfo[$a];if(Bb.ext)for(var ba=0;ba<Bb.ext.length;ba++)if(Bb.ext[ba]==Ja)return Bb}}
function Sa(Ja){for(var $a=0;$a<P.modeInfo.length;$a++){var Bb=P.modeInfo[$a];if(Bb.file&&Bb.file.test(Ja))return Bb}$a=Ja.lastIndexOf(".");if(Ja=-1<$a&&Ja.substring($a+1,Ja.length))return P.findModeByExtension(Ja)}function qc(Ja){Ja=Ja.toLowerCase();for(var $a=0;$a<P.modeInfo.length;$a++){var Bb=P.modeInfo[$a];if(Bb.name.toLowerCase()==Ja)return Bb;if(Bb.alias)for(var ba=0;ba<Bb.alias.length;ba++)if(Bb.alias[ba].toLowerCase()==Ja)return Bb}}function le(Ja){if(!Ja)return String(Ja);if(Array.isArray(Ja))return"["+
Ja.map(le).join(",")+"]";if("symbol"===typeof Ja)return yd.printSymbol(Ja);try{return String(Ja)}catch($a){return"Cannot print object: "+$a}}function Zd(Ja,$a){return!yd.arr.every($a.map(function(Bb){return Ja[Bb]}),function(Bb){return yd.obj.equals(Bb,Ja&&Ja.valueOf())})}function Fe(Ja){if(yd.obj.isPrimitive(Ja))var $a=yd.string.print(Ja);else Array.isArray(Ja)?(($a=3<Ja.length)&&(Ja=Ja.slice(0,3)),Ja=yd.string.print(Ja),$a&&(Ja=Ja.slice(0,-1)+", ...]"),$a=Ja):$a=yd.string.print(Ja);$a=$a.replace(/\n/g,
"");500<$a.length&&($a=$a.slice(0,20)+("...["+($a.length-20)+' CHARS]"'));return $a}function Oc(Ja){return Jc.Inspector.openInWindow({targetObject:Ja})}function te(Ja,$a){return Jc.Inspector.openInWindow({remoteTarget:{code:Ja,evalEnvironment:$a}})}function md(Ja,$a){function Bb(Ec){var Gc=Ec.name,qd=Ec.ownerChain(),sd=Ec.owner,vd=Ec.world(),Cf;Ec===nb&&(Cf=[zb]);vd===Ec&&(Cf=["$world"]);if(!Cf&&Gc&&sd){sd===vd&&1===Jc.arr.count(Jc.arr.pluck(vd.submorphs,"name"),Gc)&&(Cf=['$world.get("'+Gc+'")']);
if(!Cf&&sd!=vd)for(vd=qd.length-1;vd--;)if(1===qd[vd].getAllNamed(Gc).length){Cf=[].concat($jscomp.arrayFromIterable(Bb(qd[vd])),['get("'+Gc+'")']);break}Cf||(Gc=[].concat($jscomp.arrayFromIterable(Bb(sd)),['get("'+Gc+'")']),Jc.syncEval(Gc.join("."),{context:nb}).value===Ec&&(Cf=Gc))}Cf||(Cf=[zb+'.getMorphById("'+Ec.id+'")']);return Cf}$a=void 0===$a?{}:$a;var ba=Ja.world(),Ia=$a;$a=void 0===Ia.maxLength?10:Ia.maxLength;var nb=void 0===Ia.fromMorph?ba:Ia.fromMorph;if(nb===Ja)return"this";var zb=ba===
nb?"$world":"this";if(!(ba||Ja.name&&nb.get(Ja.name)===Ja))return"morph";ba=Bb(Ja);return ba.length>$a?'$world.getMorphWithId("'+Ja.id+'")':ba.join(".")}function Eb(Ja,$a,Bb){var ba=($a=void 0===$a?"":$a)&&ff.arr.last($a.split(".")).toLowerCase(),Ia="",nb=0,zb=Math.pow(2,19);if("string"===typeof Ja){if(Ja.length>zb)return null}else if(Ja.document.stringSize>zb)return null;if("string"===typeof Ja)Ia=Ja.slice(0,1E3);else for(Ja=$jscomp.makeIterator(Ja.document.lines),zb=Ja.next();!zb.done;zb=Ja.next()){var Ec=
zb.value;zb=Ec.stringSize;Ec=Ec.text;var Gc=!0;1E3<nb+zb&&(Gc=!1,zb=1E3-nb);Ia+=Ec.slice(0,zb)+(Gc?"\n":"");nb+=zb;if(1E3<=nb)break}nb=$jscomp.makeIterator(ff.modeInfo);for(Ja=nb.next();!Ja.done;Ja=nb.next()){Gc=Ja.value;zb=Gc.contentTest;Ja=Gc.mode;Ec=Gc.ext;Gc=Gc.file;if("function"===typeof zb)try{if(zb(Ia))return Ja}catch(qd){}if(Gc&&Gc instanceof RegExp&&Gc.test($a))return Ja;if(Ec)for(zb=$jscomp.makeIterator(Ec),Ec=zb.next();!Ec.done;Ec=zb.next())if(Ec.value===ba)return Ja}return Bb}Ba({a:ee,
d:kc,r:ed});var xa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");xa.Color=Ab;var Ca=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Bb=$a.hasOwnProperty("DefaultTheme")&&"function"===typeof $a.DefaultTheme?$a.DefaultTheme:$a.DefaultTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:"background",get:function(){return xa.Color.white}},
{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:xa.Color.white,fontWeight:"bold",backgroundColor:xa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:xa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:xa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],$a,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Mb=Ca=xa.DefaultTheme;xa.default=Ca;var P=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");P.copyState=La;P.startState=Yb;P.defineMode=kc;P.resolveMode=Ua;P.getMode=ec;P.innerMode=ge;P.defineMIME=ee;P.registerHelper=ed;P.indentLines=ab;P.indentLine=function(Ja,$a,Bb,ba,Ia,nb,zb){zb=Object.assign({indentWithTabs:!Ja.useSoftTabs,indentUnit:Ja.tabWidth,tabSize:4,ignoreFollowingText:!1},zb);null==
Ia&&(Ia="add");"smart"==Ia&&($a.indent||(Ia="prev"));var Ec=zb.tabSize,Gc=Bb.text,qd=P.countColumn(Gc,null,Ec);Bb.modeState&&(Bb.modeState=null);var sd=Gc.match(/^\s*/)[0];if(!nb&&!/\S/.test(Gc)){var vd=0;Ia="not"}else if("smart"==Ia&&(vd=$a.indent(ba,zb.ignoreFollowingText?"":Gc.slice(sd.length),Gc),vd==P.passIndent||150<vd)){if(!nb)return;Ia="prev"}"prev"==Ia?vd=0<Bb.row?P.countColumn(Bb.prevLine().text,null,Ec):0:"add"==Ia?vd=qd+zb.indentUnit:"subtract"==Ia?vd=qd-zb.indentUnit:"number"==typeof Ia&&
(vd=qd+Ia);vd=Math.max(0,vd);$a="";ba=0;if(zb.indentWithTabs)for(zb=Math.floor(vd/Ec);zb;--zb)ba+=Ec,$a+="\t";ba<vd&&($a+=" ".repeat(vd-ba));if($a!=sd)return Ja.replace({start:{row:Bb.row,column:0},end:{row:Bb.row,column:sd.length}},$a),!0};P.tokenizeLines=function(Ja,$a,Bb,ba,Ia){if($a.length){Bb=Bb?P.copyState(Ja,Bb):P.startState(Ja);for(var nb=0;nb<$a.length;nb++){var zb=$a[nb];ba(zb);Bb=P.tokenizeLine(Ja,zb,Bb,Ia)}}};P.tokenizeLine=function(Ja,$a,Bb,ba){var Ia=$a.text;if(!Ia)return Bb;var nb=
new P.StringStream(Ia,2);Bb=$a.modeState="function"===typeof Ja.copyState?Ja.copyState(Bb):P.copyState(Ja,Bb);$a.prevLine();for(Bb._string=Ia;!nb.eol();)Ia=Ja.token(nb,Bb),ba(Ia,Bb,nb.start,nb.pos,nb,$a,Ja),nb.start=nb.pos;return Bb};P.printTokens=function(Ja){for(var $a="",Bb=0;Bb<Ja.length;Bb+=5)$a+=Ja[Bb+0]+" => "+Ja[Bb+1]+" "+Ja[Bb+2]+" "+Ja[Bb+3]+" "+Ja[Bb+4].name+"\n";return $a};P.visitDocumentTokens=Rc;P.tokenizeDocument=pb;P.linesToTokenize=function(Ja,$a,Bb,ba){if(ba&&ba.row>=Bb)return{lines:[],
state:null};$a=ba?Math.max(0,ba.row-1):$a;var Ia=Ja.getLine($a),nb=Ia.text;Ja=[Ia];ba=null;for(var zb=0,Ec;(Ec=Ia.prevLine())&&50>zb++;){Ia=Ec;if(Ia.modeState){ba=Ia.modeState;break}Ja.unshift(Ia)}if(!ba){for(var Gc=Ia,qd=Infinity;(Ec=Ia.prevLine())&&100>zb++;){Ia=Ec;if(Ia.modeState){ba=Ia.modeState;break}Ja.unshift(Ia);Ec=nb.match(/^\s*/)[0].length;if(0===Ec)break;Ec<qd&&(qd=Ec,Gc=Ia)}!ba&&0<qd&&(Ja=Ja.slice(Ja.indexOf(Gc)))}if(Bb>$a)for(Ia=P.arr.last(Ja);$a<=Bb;$a++){Ia=Ia.nextLine();if(!Ia)break;
Ja.push(Ia)}return{lines:Ja,state:ba}};P.countColumn=bd;P.findModeByMIME=od;P.findModeByExtension=lb;P.findModeByFileName=Sa;P.findModeByName=qc;P.arr=dc;Ca=P.modes||{};P.modes=Ca;P.modes=Ca;P.modes=Ca;Ca=Ba("p",{});P.passIndent=Ca;P.passIndent=Ca;P.passIndent=Ca;P.copyState=La;P.copyState=La;P.startState=Yb;P.startState=Yb;P.defineMode=kc;P.defineMode=kc;P.resolveMode=Ua;P.resolveMode=Ua;P.getMode=ec;P.getMode=ec;P.innerMode=ge;P.innerMode=ge;Ca={};P.mimeModes=Ca;P.mimeModes=Ca;P.mimeModes=Ca;P.defineMIME=
ee;P.defineMIME=ee;P.registerHelper=ed;P.registerHelper=ed;P.indentLines=ab;P.indentLines=ab;P.visitDocumentTokens=Rc;P.visitDocumentTokens=Rc;P.tokenizeDocument=pb;P.tokenizeDocument=pb;P.countColumn=bd;P.countColumn=bd;(function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Bb=$a.hasOwnProperty("StringStream")&&"function"===typeof $a.StringStream?$a.StringStream:$a.StringStream=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Qb(Bb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,Ia){this.reset(ba,Ia)}},{key:"reset",value:function(ba,Ia){this.pos=this.start=0;this.string=void 0===ba?"":ba;this.tabSize=void 0===Ia?2:Ia;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",
value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(ba){var Ia=this.string.charAt(this.pos);if("string"==typeof ba?Ia==ba:Ia&&(ba.test?ba.test(Ia):ba(Ia)))return++this.pos,Ia}},{key:"eatWhile",value:function(ba){for(var Ia=this.pos;this.eat(ba););return this.pos>Ia}},{key:"eatSpace",value:function(){for(var ba=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>ba}},{key:"skipToEnd",value:function(){this.pos=
this.string.length}},{key:"skipTo",value:function(ba){ba=this.string.indexOf(ba,this.pos);if(-1<ba)return this.pos=ba,!0}},{key:"backUp",value:function(ba){this.pos-=ba}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=P.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return P.countColumn(this.string,
null,this.tabSize)-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(ba,Ia,nb){if("string"==typeof ba){var zb=function(Gc){return nb?Gc.toLowerCase():Gc},Ec=this.string.substr(this.pos,ba.length);if(zb(Ec)==zb(ba))return!1!==Ia&&(this.pos+=ba.length),!0}else{if((ba=this.string.slice(this.pos).match(ba))&&0<ba.index)return null;ba&&!1!==Ia&&(this.pos+=ba[0].length);return ba}}},{key:"current",value:function(){return this.string.slice(this.start,
this.pos)}},{key:"hideFirstChars",value:function(ba,Ia){this.lineStart+=ba;try{return Ia()}finally{this.lineStart-=ba}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],$a,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);Ca=[{name:"APL",
mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",
ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],
file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",
ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ja){return Ja.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",
ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",
ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",
mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},
{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",
mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],
alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown",
"md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",
mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",
ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},
{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},
{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",
mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Ja){return Ja.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",
mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel",
"formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},
{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",
mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",
ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",
mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];P.modeInfo=Ca;P.modeInfo=Ca;P.modeInfo=Ca;for(var za=0;za<P.modeInfo.length;za++)P.info=P.modeInfo[za],P.info.mimes&&
(P.info.mime=P.info.mimes[0]);P.defineMode("null",function(){return{token:function(Ja){return Ja.skipToEnd()}}});P.defineMIME("text/plain","null");P.findModeByMIME=od;P.findModeByMIME=od;P.findModeByExtension=lb;P.findModeByExtension=lb;P.findModeByFileName=Sa;P.findModeByFileName=Sa;P.findModeByName=qc;P.findModeByName=qc;var Ta=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Ta.Color=Ab;Ta.Rectangle=Xb;Ta.pt=Xd;Ta.morph=ad;Ta.ShadowObject=Nd;Ta.StyleSheet=dd;Ta.connect=Lc;Ta.arr=
dc;Ta.string=rd;Ta.FilterableList=Gd;Ta.Range=ke;za=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Bb=$a.hasOwnProperty("Completer")&&"function"===typeof $a.Completer?$a.Completer:$a.Completer=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],
$a,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);Ta.Completer=za;Ta.Completer=za;Ta.Completer=za;za=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Bb=$a.hasOwnProperty("WordCompleter")&&"function"===typeof $a.WordCompleter?
$a.WordCompleter:$a.WordCompleter=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:"compute",value:function(ba,Ia){var nb=[],zb=[],Ec=ba.document.lineStrings;ba=ba.cursorPosition.row;for(var Gc=ba-1;0<=Gc;Gc--)for(var qd=$jscomp.makeIterator(Ec[Gc].split(/[^0-9a-z@_]+/i)),sd=qd.next();!sd.done;sd=qd.next())(sd=sd.value)&&!nb.includes(sd)&&sd!==Ia&&(nb.push(sd),zb.push({priority:1E3-(ba-Gc),completion:sd}));
for(Gc=ba+1;Gc<Ec.length;Gc++)for(qd=$jscomp.makeIterator(Ec[Gc].split(/[^0-9a-z_@]+/i)),sd=qd.next();!sd.done;sd=qd.next())(sd=sd.value)&&!nb.includes(sd)&&sd!==Ia&&(nb.push(sd),zb.push({priority:1E3-(Gc-ba),completion:sd}));return zb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],$a,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);Ta.WordCompleter=za;Ta.WordCompleter=za;Ta.WordCompleter=za;za=[new Ta.WordCompleter];Ta.defaultCompleters=za;Ta.defaultCompleters=za;Ta.defaultCompleters=za;za=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Bb=$a.hasOwnProperty("CompletionController")&&"function"===typeof $a.CompletionController?$a.CompletionController:$a.CompletionController=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,Ia){Ia=void 0===Ia?[]:Ia;this.textMorph=ba;this.completers=Ia=ba.pluginCollect("getCompleters",Ia)}},{key:"computeCompletions",value:function(ba){var Ia=this,nb,zb,Ec,Gc,qd,sd,vd,Cf,yg,fg,xf,ri,Lh,Aj,Zh,qk;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gg){switch(Gg.nextAddress){case 1:nb=[],zb=$jscomp.makeIterator(Ia.completers),Ec=zb.next();
case 2:if(Ec.done){Gg.jumpTo(4);break}Gc=Ec.value;Gg.setCatchFinallyBlocks(5);qd=nb;sd=qd.concat;return Gg.yield(Gc.compute(Ia.textMorph,ba),7);case 7:nb=sd.call(qd,Gg.yieldResult);Gg.leaveTryBlock(3);break;case 5:vd=Gg.enterCatchBlock(),console.warn("Error in completer "+Gc+": "+(vd.stack||vd));case 3:Ec=zb.next();Gg.jumpTo(2);break;case 4:Cf=new Map;nb.forEach(function(fk){var Hi=Cf.get(fk.completion);Hi||(Hi=[],Cf.set(fk.completion,Hi));Hi.push(fk)});yg=[];fg=$jscomp.makeIterator(Cf.values());
for(xf=fg.next();!xf.done;xf=fg.next())ri=xf.value,yg.push(Ta.arr.last(Ta.arr.sortByKey(ri,"priority")));Lh=0;Aj=Ta.arr.sortByKey(yg,"priority").reverse();Zh=Aj.length&&Aj[0].priority||0;qk=Aj.map(function(fk){fk.highestPriority=Zh;var Hi=fk.completion.replace(/\n/g,""),dk=String((fk.info||"").replace(/\n/g,""));Lh=Math.max(Lh,Hi.length+dk.length);return{isListItem:!0,string:Hi,annotation:dk,value:fk}});return Gg.return({items:qk,maxCol:Lh})}})}},{key:"computeSortedCompletions",value:function(ba,
Ia){Ia=void 0===Ia?!1:Ia;var nb=this,zb,Ec,Gc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qd){if(1==qd.nextAddress)return zb={tokens:[ba],lowercasedTokens:[ba],input:ba},qd.yield(nb.computeCompletions(ba),2);Ec=qd.yieldResult;Gc=Ta.arr.sortBy(Ec.items.filter(function(sd){return nb.filterFunction(zb,sd,Ia)}),function(sd){return nb.sortFunction(zb,sd)});return qd.return(Gc)})}},{key:"_printCompletions",value:function(ba){var Ia=this,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==
zb.nextAddress)return zb.yield(Ia.computeSortedCompletions(ba),2);nb=zb.yieldResult.map(function(Ec){return{completion:Ec.value.completion,priority:Ec.value.priority,maxP:Ec.value.highestPriority,sortVal:Ec._cache[ba].sortVal,lev:JSON.stringify(Ec._cache[ba].levenshtein)}});return zb.return(Ta.string.printTable(lively.lang.grid.tableFromObjects(nb)))})}},{key:"prefix",value:function(){var ba=this.textMorph,Ia=ba.selection;return(Ia.isEmpty()?ba.getLine(Ia.lead.row).slice(0,Ia.lead.column):Ia.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(ba,Ia,nb){nb=void 0===nb?!1:nb;Ia._cache||(Ia._cache={});var zb=ba.tokens,Ec=ba.lowercasedTokens,Gc=ba.input;Gc=Ia._cache[Gc]||(Ia._cache[Gc]={});if(Gc.hasOwnProperty("filtered"))return Gc.filtered;Ia=Ia.value.completion.replace(/\([^\)]*\)$/,"");var qd=Ia.toLowerCase();if(nb&&zb[0]&&!Ia.startsWith(zb[0]))return Gc.filtered=!1;if(Ec.every(function(vd){return qd.includes(vd)}))return!0;var sd=Gc.levenshtein||(Gc.levenshtein={});ba=nb||3>=Ta.arr.sum(ba.lowercasedTokens.map(function(vd){return sd[vd]||
(sd[vd]=Ta.string.levenshtein(qd,vd))}));return Gc.filtered=ba}},{key:"sortFunction",value:function(ba,Ia){Ia._cache||(Ia._cache={});var nb=Ia._cache[ba.input]||(Ia._cache[ba.input]={});if(nb.hasOwnProperty("sortVal"))return nb.sortVal;nb=Ia._cache[ba.input]={};var zb=Ia.value;Ia=zb.highestPriority;var Ec=zb.completion;zb=zb.priority;Ec=Ec.replace(/\([^\)]*\)$/,"").toLowerCase();var Gc=0;ba.lowercasedTokens.forEach(function(sd){Ec.startsWith(sd)?Gc+=12:3<=sd.length&&Ec.includes(sd)&&(Gc+=5)});Ia=
-((zb||(Gc?Ia:0))/Math.pow(10,String(Ia).length-2))-Gc;var qd=nb.levenshtein||(nb.levenshtein={});ba=Ta.arr.sum(ba.lowercasedTokens.map(function(sd){return qd[sd]||(qd[sd]=Ta.string.levenshtein(Ec,sd))}));Gc&&(ba/=2);return nb.sortVal=ba+Ia}},{key:"positionForMenu",value:function(){var ba=this.textMorph,Ia=ba.charBoundsFromTextPosition(ba.cursorPosition);return ba.getGlobalTransform().transformRectToRect(Ia).topLeft().addXY(-ba.scroll.x,-ba.scroll.y).addPt(Ta.pt(ba.borderWidth+4,ba.borderWidth+4))}},
{key:"completionListSpec",value:function(){var ba=this,Ia,nb,zb,Ec,Gc,qd,sd,vd,Cf,yg,fg,xf,ri,Lh,Aj,Zh,qk,Gg,fk,Hi;return $jscomp.asyncExecutePromiseGeneratorProgram(function(dk){if(1==dk.nextAddress)return nb=Ia=ba.textMorph,zb=nb.fontSize,Ec=nb.fontFamily,Gc=ba.positionForMenu(),qd=ba.prefix(),dk.yield(ba.computeCompletions(qd),2);sd=dk.yieldResult;vd=sd.items;Cf=sd.maxCol;yg=Ia.env.fontMetric.sizeFor(Ec,zb,"M");fg=yg.width*Cf;xf=Ia.document.getLine(0).height;ri=Math.max(120,fg<Ia.width?fg:Ia.width);
Lh=xf*vd.length+xf+10;Aj=Math.max(70,Math.min(700,Lh));Zh=Gc.extent(Ta.pt(ri,Aj));if(qk=Ia.world())Gg=qk.visibleBounds().insetBy(5),Zh.bottom()>Gg.bottom()&&(fk=Zh.bottom()-Gg.bottom(),fk>Zh.height-50&&(fk=Zh.height-50),Zh.height-=fk),Zh.right()>Gg.right()&&(Hi=Zh.right()-Gg.right(),Zh.width=120>Zh.width-Hi?120:Zh.width-Hi),Gg.containsRect(Zh)||(Zh=Zh.withTopLeft(Gg.translateForInclusion(Zh).topLeft())),Zh=Zh.translatedBy(Gg.insetBy(0).topLeft().negated());return dk.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:zb,position:Zh.topLeft(),extent:Zh.extent(),items:vd,input:qd,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:ba.filterFunction,sortFunction:ba.sortFunction})})}},{key:"removeMenuOnBlur",value:function(ba){var Ia=ba.menu;setTimeout(function(){Ia.withAllSubmorphsDetect(function(nb){return nb.isFocused()})?Ia.inputMorph.focus():Ia.remove()})}},{key:"openCompletionList",value:function(){var ba=this,Ia,nb,zb,Ec,Gc,qd,sd,vd,
Cf,yg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fg){if(1==fg.nextAddress)return Ia=ba.textMorph.selection.start,fg.yield(ba.completionListSpec(),2);if(3!=fg.nextAddress)return nb=fg.yieldResult,ba.textMorph.pluginFind(function(xf){return xf.theme}),zb=new Ta.FilterableList(nb),Ec=new Ta.Range({start:Ia,end:ba.textMorph.selection.start}),Gc=ba.textMorph.textInRange(Ec),qd=zb.inputMorph,sd=zb.listMorph,vd=nb.input,Cf=zb.addMorph({name:"prefix mask",fill:Ta.Color.transparent,bounds:qd.textBounds()},
qd),sd.master=null,Ec.isEmpty()||(ba.textMorph.deleteText(Ec),qd.input=Gc,qd.gotoDocumentEnd()),qd.fontColor=ba.textMorph.fontColor,Ta.connect(qd,"textString",Cf,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:qd}}),Ta.connect(zb,"accepted",ba,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:vd}}),Ta.connect(zb,"accepted",zb,"remove"),Ta.connect(zb,"canceled",zb,"remove"),Ta.connect(zb,"remove",ba.textMorph,"focus"),Ta.connect(zb.inputMorph,"onBlur",ba,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:zb}}),yg=ba.textMorph.world(),sd.addStyleClass("hiddenScrollbar"),zb.paddingMorph.height=2,qd.height=sd.itemHeight,qd.clipMode="visible",qd.fill=ba.textMorph.fill,qd.fixedHeight=!0,qd.fixedWidth=!1,qd.fontSize=sd.fontSize,zb.relayout(),zb.selectedIndex=
0,zb.master.applyIfNeeded(!0),qd.focus(),fg.yield(zb.master.whenApplied(),3);vd.length&&(qd.gotoDocumentEnd(),zb.moveBy(Ta.pt(-qd.textBounds().width,0)));yg.addMorph(zb);zb.inputPadding=Ta.Rectangle.inset(0,0,0,0);return fg.return(zb)})}},{key:"autoInsertBestMatchingCompletion",value:function(ba,Ia,nb){Ia=void 0===Ia?!0:Ia;var zb=this,Ec,Gc,qd,sd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vd){if(1==vd.nextAddress)return Ec=$jscomp,Gc=Ec.makeIterator,vd.yield(zb.computeSortedCompletions(ba,
Ia),2);qd=Gc.call(Ec,vd.yieldResult);(sd=qd.next().value)&&zb.insertCompletion(sd.value.completion,ba,nb);vd.jumpToEnd()})}},{key:"insertCompletion",value:function(ba,Ia,nb){var zb=this.textMorph,Ec=zb.document,Gc=zb.selection.isMultiSelection?zb.selection.selections:[zb.selection];zb.undoManager.group();Gc.forEach(function(qd){qd.collapseToEnd();var sd=qd.lead,vd=Ia?Ec.indexToPosition(Ec.positionToIndex(sd)-Ia.length):sd;"function"===typeof nb?nb(ba,Ia,zb,{start:vd,end:sd},qd):zb.replace({start:vd,
end:sd},ba)});zb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],$a,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);Ta.CompletionController=za;Ta.CompletionController=za;Ta.CompletionController=za;
za=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ja,$a,Bb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){return 1==Ia.nextAddress?(ba=new Ta.CompletionController(Ja,Ta.defaultCompleters),Ia.yield(ba.openCompletionList(),2)):Ia.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ja,$a,Bb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){return 1==Ia.nextAddress?
(ba=new Ta.CompletionController(Ja,Ta.defaultCompleters),Ia.yield(ba.autoInsertBestMatchingCompletion(ba.prefix()),2)):Ia.return(!0)})}}];Ta.completionCommands=za;Ta.completionCommands=za;Ta.completionCommands=za;var Fb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Fb.chain=Kd;Fb.arr=dc;Fb.obj=Hc;Fb.string=rd;var Cc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ja){var $a=Ja.selection.start;0<$a.row&&($a=Ja.getPositionAboveOrBelow(1,
$a,!0,0,Ja.charBoundsFromTextPosition($a).x),Ja.selection.addRange({start:$a,end:$a}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Ja){var $a=Ja.selection.start;$a.row<Ja.documentEndPosition.row&&($a=Ja.getPositionAboveOrBelow(-1,$a,!0,0,Ja.charBoundsFromTextPosition($a).x),Ja.selection.addRange({start:$a,end:$a}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ja){var $a=Ja.selection.selections[Ja.selection.selections.length-
1];if($a.isEmpty())return!0;Ja.searchForAll($a.text,{start:{column:0,row:0}}).forEach(function(Bb){return Ja.selection.addRange(Bb.range,!1)});Ja.selection.mergeSelections();Fb.arr.remove(Ja.selection.selections,$a);Ja.selection.selections.push($a);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ja){var $a=Ja.selection.selections.length-1,Bb=Ja.selection.selections[$a];if(Bb.isEmpty())return!0;var ba=Ja.search(Bb.text,{start:Bb.end,backwards:!1});
ba&&(Bb=Ja.selection.selections.findIndex(function(Ia){return Ia.range.equals(ba.range)}),-1<Bb?Fb.arr.swap(Ja.selection.selections,Bb,$a):Ja.selection.addRange(ba.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Ja){var $a=Ja.selection.selections.length-1,Bb=Ja.selection.selections[$a];if(Bb.isEmpty())return!0;var ba=Bb.start,Ia=Ja.search(Bb.text,{start:{row:ba.row,column:ba.column-(Bb.text.length-1)},backwards:!0});Ia&&(Bb=Ja.selection.selections.findIndex(function(nb){return nb.range.equals(Ia.range)}),
-1<Bb?Fb.arr.swap(Ja.selection.selections,Bb,$a):Ja.selection.addRange(Ia.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Ja){var $a=Ja.selection.selections.length;1<$a&&Ja.selection.removeSelections($a-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ja){Ja.selection.selections=lively.lang.arr.rotate(Ja.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(Ja){Ja.selection.selections=lively.lang.arr.rotate(Ja.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Ja){var $a=Ja.selection.selections;if(1>=$a.length)return!0;var Bb=Fb.arr.groupBy($a,function(Ia){return Ia.range.start.row});$a=Bb.keys().map(function(Ia){Ia=Bb[Ia];var nb=Fb.arr.max(Ia,function(zb){return zb.range.start.column});Fb.arr.without(Ia,nb).forEach(function(zb){return zb.range=nb.range});
return nb});var ba=Fb.arr.max($a,function(Ia){return Ia.range.start.column}).range.start.column;$a.forEach(function(Ia){var nb=Ia.range.start;Ia=nb.row;nb=nb.column;Ja.insertText(" ".repeat(ba-nb),{row:Ia,column:nb})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ja){Ja.selection.disableMultiSelect();if(Ja.selection.isEmpty())var $a=Ja.lastSavedMark&&Ja.lastSavedMark.position||(void 0).lineRange().start,Bb=Ja.cursorPosition;else $a=Ja.selection,
Bb=$a.lead,$a=$a.anchor;Ja.selection.collapse();var ba=$a.column,Ia=Bb.column;Fb.arr.range($a.row,Bb.row).forEach(function(nb){return Ja.getLine(nb).length>Math.min(Ia,ba)&&Ja.selection.addRange({end:{row:nb,column:Ia},start:{row:nb,column:ba}},!1)});Ja.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ja,$a,Bb){Bb=void 0===Bb?1:Bb;Ja.undoManager.group();Ja.selection.selections.forEach(function(ba,Ia){return ba.text=String(Ia+
Bb)});Ja.undoManager.group();return!0}}];Fb.multiSelectCommands=Cc;Fb.multiSelectCommands=Cc;Fb.multiSelectCommands=Cc;var Uc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");Uc.pToI=function(Ja,$a){return Ja.positionToIndex($a)};Uc.iToP=function(Ja,$a){return Ja.indexToPosition($a)};Uc.execCodeNavigator=function(Ja){return function($a,Bb,ba){var Ia=$a.pluginInvokeFirst("getNavigator");if(!Ia)return!0;$a.saveMark();ba=ba||1;for(var nb=0;nb<ba;nb++)Ia[Ja]($a,Bb);return!0}};
Uc.once=fb;var he=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Uc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:Uc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Uc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Uc.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Uc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ja,$a){function Bb(){var nb=Ja.$expandRegionState,zb=Uc.pToI(Ja,Ja.cursorPosition);if(nb&&(nb.range[0]===zb||nb.range[1]===zb))return nb;nb=Ja.selection.range;return Ja.$expandRegionState={range:[Uc.pToI(Ja,nb.start),
Uc.pToI(Ja,nb.end)]}}$a=$a||{};var ba=Ja.pluginInvokeFirst("getNavigator");if(!ba)return!0;var Ia=$a.start;$a=$a.end;if("number"===typeof Ia&&"number"===typeof $a)Bb(),ba={range:[Ia,$a],prev:Bb()};else{Ia=ba.ensureAST(Ja);if(!Ia)return;ba=ba.expandRegion(Ja,Ja.textString,Ia,Bb())}ba&&ba.range&&(Ja.selection={start:Uc.iToP(Ja,ba.range[0]),end:Uc.iToP(Ja,ba.range[1])},Ja.$expandRegionState=ba);Uc.once(Ja,"selectionChange",function(){return Ja.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ja){if(Ja.selection.isEmpty())return!0;var $a=Ja.pluginInvokeFirst("getNavigator");if(!$a)return!0;var Bb=$a.ensureAST(Ja);if(!Bb)return!0;var ba=Ja.$expandRegionState;if(!ba)return!0;($a=$a.contractRegion(Ja,Ja.textString,Bb,ba))&&$a.range&&(Ja.selection={start:Uc.iToP(Ja,$a.range[0]),end:Uc.iToP(Ja,$a.range[1])},Ja.$expandRegionState=$a);Uc.once(Ja,"selectionChange",
function(){return Ja.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Uc.commands=he;Uc.commands=he;Uc.commands=he;var we=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");we.arr=dc;we.chain=Kd;we.string=rd;var nf=[{name:"toggle comment",exec:function(Ja){var $a=Ja.pluginInvokeFirst("getComment");if(!$a)return!0;if(!$a.lineCommentStart)return $a.blockCommentStart?Ja.execCommand("toggle block comment"):!0;var Bb=$a.lineCommentStart,ba=
new RegExp("^(\\s*)("+Bb+"\\s?)(.*)");$a=Ja.document;var Ia=Ja.selection;Ia.isEmpty()||0!==Ia.end.column||Ia.growRight(-1);var nb=Ia.start.row;$a=$a.lineStrings.slice(Ia.start.row,Ia.end.row+1);$a=$a.some(function(Gc){return!!Gc.trim()})?we.arr.dropWhile($a,function(Gc){return Gc.trim()?!1:++nb&&!0}):$a;var zb=$a.every(function(Gc){return Gc.trim()&&Gc.match(ba)});Ja.undoManager.group();if(zb)$a.forEach(function(Gc,qd){if(Gc=Gc.match(ba)){Gc=$jscomp.makeIterator(Gc);Gc.next();var sd=Gc.next().value,
vd=Gc.next().value;Gc.next();Ja.deleteText({start:{row:nb+qd,column:sd.length},end:{row:nb+qd,column:sd.length+vd.length}})}});else{var Ec=$a.reduce(function(Gc,qd,sd){return qd.trim()||Ia.isEmpty()&&Ia.start.row===Ia.end.row?Math.min(Gc,qd.match(/^\s*/)[0].length):Gc},Infinity);Ec=Infinity===Ec?0:Ec;$a.forEach(function(Gc,qd){Gc=$jscomp.makeIterator(Gc.match(/^(\s*)(.*)/));Gc.next();Gc.next();Gc.next();Ja.insertText(Bb+" ",{row:nb+qd,column:Ec})})}Ja.undoManager.group();return!0}},{name:"toggle block comment",
exec:function(Ja){var $a=Ja.pluginInvokeFirst("getComment");if(!$a)return!0;if(!$a.blockCommentStart)return $a.lineCommentStart?Ja.execCommand("toggle comment"):!0;if(!$a||!$a.blockCommentStart)return!0;var Bb=$a.blockCommentStart;$a=$a.blockCommentEnd;var ba=new RegExp("^"+Bb.replace(/\*/g,"\\*")),Ia=new RegExp($a.replace(/\*/g,"\\*")+"$"),nb=Ja.tokenAt(Ja.cursorPosition);if(nb&&"comment"===nb.token){var zb=Ja.textInRange(nb);if(zb.match(ba)&&zb.match(Ia))return Ja.undoManager.group(),Ja.replace(nb,
zb.slice(Bb.length,-$a.length)),Ja.undoManager.group(),!0}Ja.undoManager.group();Ja.insertText(Bb,Ja.selection.start);Ja.insertText($a,Ja.selection.end);Ja.undoManager.group();Bb=!Ja.selection.isEmpty();Ja.selection.growLeft($a.length);Bb||Ja.selection.collapse();return!0}},{name:"comment box",exec:function(Ja,$a,Bb){$a=Ja.undoManager.ensureNewGroup(Ja,"comment box");if(Ja.selection.isEmpty())return Ja.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ja.execCommand("toggle comment"),
Ja.undoManager.group($a),!0;var ba=Ja.selection.range,Ia=Ja.withSelectedLinesDo(function(zb){return zb}),nb=we.arr.min([ba.start.column].concat(we.chain(Ia).map(function(zb){return zb.match(/^\s*/)}).flatten().compact().pluck("length").value()));Ia=we.arr.max(Ia.map(function(zb){return zb.length}))-nb;Ia=Array(Math.ceil(Ia/2)+1).join("-=")+"-";Ja.execCommand("toggle comment");Ja.collapseSelection();Ja.cursorPosition={row:ba.start.row,column:0};Bb?Ja.insertText(we.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",nb)):Ja.insertText(we.string.indent(Ia+"\n"," ",nb));Ja.selection.goUp();Ja.execCommand("toggle comment");Ja.cursorPosition={row:ba.end.row+2,column:0};Ja.insertText(we.string.indent(Ia+"\n"," ",nb));Ja.selection.goUp();Ja.execCommand("toggle comment");Ja.selection.range={start:{row:ba.start.row,column:0},end:Ja.cursorPosition};Ja.undoManager.group($a);return!0},multiSelectAction:"forEach",handlesCount:!0}];we.commands=nf;we.commands=nf;we.commands=nf;var yd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
yd.printSymbol=function(Ja){if(Symbol.keyFor(Ja))return'Symbol.for("'+Symbol.keyFor(Ja)+'")';if(yd.knownSymbols.get(Ja))return yd.knownSymbols.get(Ja);String(Ja).match(yd.symMatcher);return String(Ja)};yd.defaultSort=function(Ja,$a){if(Ja.hasOwnProperty("priority")||$a.hasOwnProperty("priority")){var Bb=Ja.priority||0,ba=$a.priority||0;if(Bb<ba)return-1;if(Bb>ba)return 1}Ja=(Ja.keyString||Ja.key).toLowerCase();$a=($a.keyString||$a.key).toLowerCase();return Ja<$a?-1:Ja===$a?0:1};yd.safeToString=le;
yd.propertyNamesOf=function(Ja,$a){if(!Ja)return[];if(Array.isArray(Ja)){var Bb=$a?$a.offset:0;return yd.arr.range(Bb,Bb+($a?$a.partitionSize:Ja.length-1))}return yd.arr.sortBy(Object.keys(Ja),function(ba){return ba.toLowerCase()})};yd.isMultiValue=Zd;yd.printValue=Fe;yd.partitionedChildren=function(Ja,$a){var Bb=void 0===$a?{}:$a;$a=void 0===Bb.originalValue?Ja:Bb.originalValue;var ba=void 0===Bb.offset?0:Bb.offset;Bb=void 0===Bb.partitionSize?Ja.length||Object.values(Ja).length:Bb.partitionSize;
if(yd.obj.isArray(Ja)){Ja=yd.num.roundTo(Math.max(yd.MIN_PARTITION_SIZE,Bb/50),.1);Bb/=Ja;for(var Ia=[],nb=0;nb<Bb;nb++){var zb="["+(ba+nb*Ja)+"-"+(ba+(nb+1)*Ja)+"]";Ia.push({partition:{originalValue:$a,offset:ba+nb*Ja,partitionSize:Ja},value:[],key:zb,keyString:zb,valueString:"...",isCollapsed:!0})}return Ia}Ja=yd.num.roundTo(Math.max(yd.MIN_PARTITION_SIZE,Bb/50),.1);Bb/=Ja;Ia=[];nb=yd.obj.keys($a).sort();for(zb=0;zb<Bb;zb++){var Ec=ba+zb*Ja,Gc=ba+(zb+1)*Ja,qd=yd.obj.select($a,nb.slice(Ec,Gc));Ec=
"["+nb[Ec].slice(0,4)+"-"+(nb[Gc]||yd.arr.last(nb)).slice(0,4)+"]";Ia.push({partition:{originalValue:qd,offset:ba+zb*Ja,partitionSize:Ja},value:[],key:Ec,keyString:Ec,valueString:"...",isCollapsed:!0})}return Ia};yd.propertiesOf=function(Ja){var $a=Ja.partition?Ja.target:Ja.value;if(!$a)return[];var Bb={_rev:!0},ba=[],Ia="function"===typeof $a.livelyCustomInspect?$a.livelyCustomInspect():{},nb=Object.assign({},yd.defaultPropertyOptions,{},Ia);if(Ia.properties){Ia=$jscomp.makeIterator(Ia.properties);
for(var zb=Ia.next();!zb.done;zb=Ia.next()){var Ec=zb.value;zb=Ec.key;var Gc=Ec.hidden,qd=Ec.priority,sd=Ec.keyString,vd=Ec.value;Ec=Ec.valueString;Bb[zb]=!0;Gc||ba.push(Ja.getSubNode({priority:qd,key:zb,keyString:sd||yd.safeToString(zb),value:vd,valueString:Ec,isCollapsed:!0}))}}if(nb.includeDefault){Ia=yd.propertyNamesOf($a,Ja.partition);if(Ia.length>yd.MAX_NODE_THRESHOLD)for(Bb=$jscomp.makeIterator(yd.partitionedChildren($a,Ja.partition)),Ia=Bb.next();!Ia.done;Ia=Bb.next())ba.push(Ja.getSubNode(Ia.value));
else for(Gc=$jscomp.makeIterator(Ia),Ia=Gc.next();!Ia.done;Ia=Gc.next())qd=Ia.value,qd in Bb||(Ia=$a[qd],zb=yd.printValue(Ia),Ia={keyString:qd,key:qd,value:Ia,valueString:zb,isCollapsed:!0},ba.push(Ja.getSubNode(Ia)));if(nb.includeSymbols)for(Bb=$jscomp.makeIterator(Object.getOwnPropertySymbols($a)),Ia=Bb.next();!Ia.done;Ia=Bb.next())Gc=Ia.value,qd=yd.safeToString(Gc),Ia=$a[Gc],zb=yd.printValue(Ia),Ia={key:Gc,keyString:qd,value:Ia,valueString:zb,isCollapsed:!0},ba.push(Ja.getSubNode(Ia))}nb.sort&&
(ba=nb.sortFunction($a,ba));return ba};yd.obj=Hc;yd.num=Db;yd.arr=dc;yd.string=rd;yd.connect=Lc;yd.signal=mc;yd.TreeData=hc;yd.newUUID=Tc;yd.localInterface=Ga;yd.MAX_NODE_THRESHOLD=1E3;yd.MIN_PARTITION_SIZE=250;yd.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Ja,$a){return Array.isArray(Ja)?$a:$a.sort(yd.defaultSort)}};yd.symMatcher=/^Symbol\((.*)\)$/;yd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ja){return"symbol"===
typeof Symbol[Ja]}).reduce(function(Ja,$a){return Ja.set(Symbol[$a],"Symbol."+$a)},new Map)}();yd.isMultiValue=Zd;yd.isMultiValue=Zd;yd.printValue=Fe;yd.printValue=Fe;var Ce=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=$a.hasOwnProperty("InspectionTree")&&"function"===typeof $a.InspectionTree?$a.InspectionTree:$a.InspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Qb(Bb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Qb._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.inspector=ba.inspector;this.root.isInspectionNode||(this.root=yd.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(ba){ba=void 0===ba?!0:ba;return Qb._get(Object.getPrototypeOf(Bb.prototype),"asListWithIndexAndDepth",
this).call(this,function(Ia){Ia=Ia.node;return ba?Ia.visible:!0})}},{key:"getContextFor",value:function(ba){return ba==this.root?this.root.value.inspectee:ba.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(ba){var Ia=void 0===ba.maxDepth?1:ba.maxDepth,nb=ba.iterator,zb=ba.showUnknown,Ec=ba.showInternal,Gc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qd){if(1==qd.nextAddress)return qd.yield(Gc.uncollapseAll(function(sd,vd){return Ia>vd&&(sd==Gc.root||sd.value.submorphs)}),
2);Gc.asListWithIndexAndDepth(!1).forEach(function(sd){var vd=sd.node;return 0==sd.depth?vd.visible=!0:!zb&&vd.keyString&&vd.keyString.includes("UNKNOWN PROPERTY")||!Ec&&vd.keyString&&vd.keyString.includes("internal")?vd.visible=!1:vd.value&&vd.value.submorphs?vd.visible=!0:vd.visible=nb(vd)});qd.jumpToEnd()})}},{key:"getChildren",value:function(ba){return ba.children}},{key:"display",value:function(ba){return ba.display(this.inspector)}},{key:"isCollapsed",value:function(ba){return ba.isCollapsed}},
{key:"isLeaf",value:function(ba){return yd.obj.isPrimitive(ba.value)}},{key:"collapse",value:function(ba,Ia){var nb=this;ba.isCollapsed=Ia;Ia||this.isLeaf(ba)||ba.children.length||(ba.children=yd.propertiesOf(ba).map(function(zb){nb.parentMap.set(zb,ba);return zb}))}},{key:"retrieveForRemoteProxy",value:function(ba){ba.uuid||(ba.uuid=yd.newUUID(),this.idToNodeMap[ba.uuid]=ba);return{uuid:ba.uuid,value:this.isLeaf(ba)?ba.value:{},keyString:ba.keyString,key:ba.keyString,valueString:yd.safeToString(ba.value),
isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return yd.localInterface}},{key:"getNodeViaId",value:function(ba){return this.idToNodeMap[ba]}},{key:"asRemoteDelegate",value:function(ba){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[ba]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(ba,Ia){return new this({key:"inspectee",value:{inspectee:ba},isCollapsed:!0,inspector:Ia})}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(yd.TreeData);yd.InspectionTree=Ce;yd.InspectionTree=
Ce;yd.InspectionTree=Ce;var wf=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=$a.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof $a.RemoteInspectionTree?$a.RemoteInspectionTree:$a.RemoteInspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(ba){this.parentMap=new WeakMap;this.root=ba.proxy;this.evalEnvironment=ba.evalEnvironment;this.inspector=ba.inspector;this.delegateId=ba.delegateId}},{key:"getContextFor",value:function(ba){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+ba.uuid+'").value'}},{key:"dispose",value:function(){var ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){return Ia.yield(ba.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
ba.delegateId+"']\n    ",ba.evalEnvironment),0)})}},{key:"display",value:function(ba){return ba.keyString+": "+ba.valueString}},{key:"collapse",value:function(ba,Ia){var nb=this,zb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress)return(ba.isCollapsed=Ia)||nb.isLeaf(ba)?Ec.return():ba.children.length?Ec.jumpTo(0):Ec.yield(nb.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+ba.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+nb.delegateId+'"]'}),3);zb=Ec.yieldResult;ba.children=zb.isError?[]:zb.value;Ec.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(ba,Ia){var nb=this,zb,Ec,Gc,qd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sd){if(1==sd.nextAddress)return sd.yield(nb.createRemoteContext(ba,Ia),2);zb=sd.yieldResult;
Ec=zb.proxy;Gc=zb.delegateId;qd=zb.evalEnvironment;return sd.return(new nb({key:"inspectee",proxy:Ec,delegateId:Gc,evalEnvironment:qd,inspector:Ia}))})}},{key:"createRemoteContext",value:function(ba,Ia){var nb=ba.code,zb=ba.evalEnvironment,Ec=ba.delegateId,Gc,qd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sd){if(1==sd.nextAddress)return Ec="lively://inspector-"+Ia.id,sd.yield(zb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
nb+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Ec+'");\n    ',zb),2);Gc=sd.yieldResult;qd=Gc.value;return sd.return({delegateId:Ec,evalEnvironment:zb,proxy:qd})})}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(yd.InspectionTree);
yd.RemoteInspectionTree=wf;yd.RemoteInspectionTree=wf;yd.RemoteInspectionTree=wf;(function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=$a.hasOwnProperty("InspectionNode")&&"function"===typeof $a.InspectionNode?$a.InspectionNode:$a.InspectionNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){var Ia=
ba.root,nb=ba.priority,zb=ba.key,Ec=ba.keyString,Gc=ba.value,qd=ba.valueString,sd=ba.isCollapsed,vd=void 0===ba.children?[]:ba.children,Cf=void 0===ba.isSelected?!1:ba.isSelected,yg=void 0===ba.visible?!0:ba.visible;this.partition=ba.partition;this.priority=nb;this.key=zb;this.keyString=String(Ec||zb);this.value=Gc;this.valueString=qd||yd.printValue(Gc);this.isCollapsed=sd;this.children=vd;this.isSelected=Cf;this.visible=yg;this.root=Ia}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(ba){if(ba.value&&ba.value.isMorph)return new yd.MorphNode(Object.assign({root:this.root},ba));var Ia=ba.key,nb=ba.keyString,zb=this.value,Ec=ba.partition;Ec&&(zb=Ec.originalValue,nb=Ia);return new yd.PropertyNode(Object.assign({},ba,{keyString:nb,key:Ia,target:zb,partition:Ec,root:this.root,spec:{}}))}},{key:"display",value:function(ba){var Ia=this.keyString,nb=this.valueString;if(!this.interactive)return Ia+": "+nb;this._propertyWidget||
(this._propertyWidget=ba.renderDraggableTreeLabel({value:Ia+": "+nb}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(ba,Ia){Ia=void 0===Ia?null:Ia;return ba.value&&ba.value.isMorph?new yd.MorphNode(Object.assign({root:Ia},ba)):new yd.InspectionNode(Object.assign({root:Ia},ba))}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=$a.hasOwnProperty("MorphNode")&&"function"===typeof $a.MorphNode?$a.MorphNode:$a.MorphNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,
[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Qb._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(ba){var Ia=this.propertyInfo[ba.key]||{};return ba.value&&ba.value.isMorph?new yd.MorphNode(Object.assign({},ba,{root:this.root})):new yd.PropertyNode(Object.assign({},ba,{root:this.root,target:this.target,
spec:Ia}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(yd.InspectionNode);(function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=$a.hasOwnProperty("PropertyNode")&&
"function"===typeof $a.PropertyNode?$a.PropertyNode:$a.PropertyNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Qb._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);var Ia=ba.spec,nb=ba.target;this.partition=ba.partition;this.target=nb;this.spec=Ia;this.foldedNodes={}}},{key:"__deserialize__",
value:function(ba,Ia){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(ba){this._interactive=ba}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(ba){return this.isFoldable?this.getFoldedContext(ba):Qb._get(Object.getPrototypeOf(Bb.prototype),"getSubNode",this).call(this,ba)}},{key:"getFoldedContext",
value:function(ba){return this.foldedNodes[ba.key]=new yd.FoldedNode(Object.assign({},ba,{root:this.root,target:this.target,foldableNode:this,spec:yd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(ba,Ia){(Ia=void 0===Ia?!1:Ia)&&(this.target[this.key]=ba);this.value=this.target[this.key];this.valueString=yd.printValue(this.value);this.interactive&&(Ia||this._propertyWidget.highlight());if(this.isFoldable)for(var nb in this.foldedNodes)this.foldedNodes[nb].value=
this.value[nb],this.foldedNodes[nb].valueString=yd.printValue(this.value[nb]),this.foldedNodes[nb]._propertyWidget&&yd.signal(this.foldedNodes[nb]._propertyWidget,"update",this.value[nb])}},{key:"display",value:function(ba){var Ia=this,nb=this._propertyWidget,zb=this.keyString,Ec=this.valueString,Gc=this.target,qd=this.value,sd=this.spec;if(!(this.interactive||sd.foldable&&yd.isMultiValue(qd,sd.foldable)))return ba.renderPropertyControl({target:Gc,keyString:zb,valueString:Ec,tree:ba.ui.propertyTree,
value:qd,spec:sd,node:this,fastRender:!0});if(nb)return nb.keyString=zb,nb.valueString=Ec,nb.isSelected=this.isSelected,nb.control&&(nb.control.isSelected=this.isSelected),nb;nb=this._propertyWidget=ba.renderPropertyControl({target:Gc,keyString:zb,valueString:Ec,value:qd,spec:sd,node:this,isSelected:this.isSelected,fontColor:ba.ui.propertyTree.fontColor});this.isInternalProperty||sd.readOnly||(yd.connect(nb,"propertyValue",this,"refreshProperty",{updater:function(vd,Cf){return vd(Cf,!0)}}),yd.connect(nb,
"openWidget",this.root,"onWidgetOpened",{converter:function(vd){return{widget:vd,node:Ia.sourceObj}}}));return nb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(yd.InspectionNode);
(function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=$a.hasOwnProperty("FoldedNode")&&"function"===typeof $a.FoldedNode?$a.FoldedNode:$a.FoldedNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Qb._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
ba);this.foldableNode=ba=ba.foldableNode;this.foldedProp=ba.key+yd.string.capitalize(this.key)}},{key:"refreshProperty",value:function(ba,Ia){Ia=void 0===Ia?!1:Ia;var nb={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(nb[this.key]=ba,nb)),Ia)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(yd.PropertyNode);var Ie=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Ie.Color=Ab;var Fg=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Bb=$a.hasOwnProperty("DarkTheme")&&"function"===typeof $a.DarkTheme?$a.DarkTheme:$a.DarkTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Qb(Bb,Ja,[{key:"background",get:function(){return Ie.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Ie.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Ie.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Ie.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Ie.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Ie.Color.white,fontWeight:"bold",backgroundColor:Ie.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Ie.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Ie.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],$a,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),Rf=Fg=Ie.DarkTheme;Ie.default=Fg;var Jc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Jc.inspect=Oc;Jc.remoteInspect=te;Jc.generateReferenceExpression=md;Jc.onNumberDragStart=
function(Ja,$a){$a.initPos=Ja.position;$a.factorLabel=(new Jc.Tooltip({description:"1x"})).openInWorld(Ja.hand.position.addXY(10,10))};Jc.onNumberDrag=function(Ja,$a){var Bb=Jc.getScaleAndOffset(Ja,$a),ba=Bb.scale;Bb=Bb.offset;$a.factorLabel.position=Ja.hand.position.addXY(10,10);$a.factorLabel.description=ba+"x";return Jc.getCurrentValue(Bb,ba,$a)};Jc.onNumberDragEnd=function(Ja,$a){var Bb=Jc.getScaleAndOffset(Ja,$a);Ja=Bb.offset;Bb=Bb.scale;$a.factorLabel.softRemove();return Jc.getCurrentValue(Ja,
Bb,$a)};Jc.getScaleAndOffset=function(Ja,$a){var Bb=Ja.position.subPt($a.initPos);Ja=Bb.x;$a=Jc.num.roundTo(Math.exp(-Bb.y/$world.height*6),.01)*$a.baseFactor;return{offset:Ja,scale:$a}};Jc.getCurrentValue=function(Ja,$a,Bb){return Math.max(Bb.min,Math.min(Bb.max,Bb.scrubbedValue+(Bb.floatingPoint?Ja*$a:Math.round(Ja*$a))))};Jc.Color=Ab;Jc.Rectangle=Xb;Jc.rect=Ld;Jc.pt=Xd;Jc.obj=Hc;Jc.num=Db;Jc.Path=oc;Jc.arr=dc;Jc.promise=pc;Jc.connect=Lc;Jc.disconnect=Nb;Jc.once=fb;Jc.Morph=Dc;Jc.Tooltip=Vc;Jc.VerticalLayout=
Hd;Jc.GridLayout=Id;Jc.HorizontalLayout=rb;Jc.morph=ad;Jc.CustomLayout=Hb;Jc.Label=Mc;Jc.Icon=qb;Jc.StyleSheet=dd;Jc.config=tb;Jc.Tree=eb;Jc.LoadingIndicator=ob;Jc.DropDownList=wb;Jc.DropDownSelector=cb;Jc.SearchField=Oa;Jc.LabeledCheckBox=Gb;Jc.MorphHighlighter=fc;Jc.InteractiveMorphSelector=rc;Jc.printValue=Fe;Jc.RemoteInspectionTree=wf;Jc.InspectionTree=Ce;Jc.isMultiValue=Zd;Jc.valueWidgets=Q;Jc.popovers=ha;Jc.DarkTheme=Rf;Jc.DefaultTheme=Mb;Jc.syncEval=sc;Jc.inspectorCommands=[{name:"focus codeEditor",
exec:function(Ja){Ja.get("codeEditor").show();Ja.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ja){Ja.get("propertyTree").show();Ja.get("propertyTree").focus();return!0}}];(function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=$a.hasOwnProperty("DraggedProp")&&"function"===typeof $a.DraggedProp?$a.DraggedProp:$a.DraggedProp=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Qb(Bb,Ja,[{key:"applyToTarget",value:function(ba){var Ia=this.currentTarget,nb=this.control;this.remove();Jc.MorphHighlighter.removeHighlighters(ba.world);if(Ia)if(Ia.isText&&"js"===Ia.editorModeName){var zb=Ia.evalEnvironment.context;ba=Ia.textPositionFromPoint(Ia.localize(ba.position));zb=Jc.generateReferenceExpression(this.sourceObject,{fromMorph:zb});nb.keyString&&(zb+="."+nb.keyString);Ia.insertTextAndSelect(zb,ba);Ia.focus()}else"propertyValue"in nb&&(Ia[nb.keyString]=nb.propertyValue)}},
{key:"update",value:function(ba){ba=ba.hand.globalPosition;var Ia=this.morphBeneath(ba),nb;if(Ia){for(Ia==this.morphHighlighter&&(Ia=Ia.morphBeneath(ba));nb=[Ia].concat($jscomp.arrayFromIterable(Ia.ownerChain())).find(function(zb){return!zb.visible});)Ia=nb=nb.morphBeneath(ba);if(Ia!=this.currentTarget){this.currentTarget=Ia;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Ia.isWorld)return;this.morphHighlighter=Jc.MorphHighlighter.for($world,Ia);this.morphHighlighter.show()}this.position=
ba}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Jc.Color.rgb(169,204,227)},fill:{defaultValue:Jc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var ba=this.control;if(!ba)return this.submorphs=[];this.height=22;this.submorphs=[ba];ba.top=0;ba.fontSize=14;"function"===typeof ba.relayout&&
ba.relayout();this.width=ba.width+20;this.adjustOrigin(Jc.pt(10,10))}}}}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3719})})(Jc.Morph);(function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=$a.hasOwnProperty("DraggableTreeLabel")&&"function"===
typeof $a.DraggableTreeLabel?$a.DraggableTreeLabel:$a.DraggableTreeLabel=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(ba){this.draggedProp=new Jc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Jc.connect(ba.hand,"update",this.draggedProp,"update")}},
{key:"onDrag",value:function(ba){}},{key:"onDragEnd",value:function(ba){Jc.disconnect(ba.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(ba)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Jc.config.codeEditor.defaultStyle.fontFamily},
fill:{defaultValue:Jc.Color.transparent},padding:{defaultValue:Jc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(ba){this.setProperty("isSelected",ba);ba?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=ba)}}}}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3721,end:5060})})(Jc.Label);Ce=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=$a.hasOwnProperty("PropertyControl")&&"function"===typeof $a.PropertyControl?$a.PropertyControl:$a.PropertyControl=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(ba,Ia,nb){ba.control=new Jc.DropDownSelector({opacity:.8,fill:Jc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Ia,padding:0,values:nb});Jc.connect(ba.control,"update",ba,"propertyValue",{updater:function(zb,Ec){this.targetObj.propertyValue!=Ec&&zb(Ec)}});Jc.connect(ba,"update",ba.control,"selectedValue",{updater:function(zb,Ec){Ec=Ec&&Ec.valueOf?Ec.valueOf():Ec;this.targetObj.propertyValue!=Ec&&zb(Ec)}});return ba}},
{key:"toggleMultiValuePlaceholder",value:function(ba){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:Jc.Color.transparent,layout:new Jc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:Jc.arr.range(0,2).map(function(Ia){return{type:"ellipse",fill:Jc.Color.gray.withA(.5),reactsToPointer:!1,extent:Jc.pt(7,7)}})});ba?(Jc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),
this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(Jc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(ba){this.foldableProperties&&this.toggleMultiValuePlaceholder(Jc.isMultiValue(ba,this.foldableProperties))}},{key:"asFoldable",value:function(ba){this.foldableProperties=ba;Jc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();
this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var ba=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});
ba.isLayoutable=!1;ba.fontWeight="bold";ba.fontColor=Jc.Color.orange;ba.reactsToPointer=!1;ba.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(ba){this.submorphs=[ba]}},layout:{initialize:function(){this.layout=new Jc.CustomLayout({relayout:function(ba){ba.relayout()}})}},
submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(ba){return(ba=ba.value)&&(ba.isColor||ba.isGradient)?"Color":ba&&ba.isPoint?"Point":Jc.obj.isBoolean(ba)?"Boolean":Jc.obj.isNumber(ba)?"Number":Jc.obj.isString(ba)?"String":ba&&ba.isRectangle?"Rectangle":!1}},{key:"render",value:function(ba){ba.spec.type||(ba.spec=Object.assign({},ba.spec,{type:this.inferType(ba)}));switch(ba.spec.type){case "Color":var Ia=this.renderColorControl(ba);
break;case "ColorGradient":Ia=this.renderColorControl(Object.assign({},ba,{gradientEnabled:!0}));break;case "Number":Ia=this.renderNumberControl(ba);break;case "String":Ia=this.renderStringControl(ba);break;case "RichText":Ia=this.renderStringControl(ba);break;case "Layout":Ia=this.renderLayoutControl(ba);break;case "Enum":Ia=this.renderEnumControl(ba);break;case "Shadow":Ia=this.renderShadowControl(ba);break;case "Point":Ia=this.renderPointControl(ba);break;case "Rectangle":Ia=this.renderRectangleControl(ba);
break;case "Boolean":Ia=this.renderBooleanControl(ba);break;default:Ia=this.renderItSomehow(ba)}Ia.control&&(Jc.connect(Ia.control,"openWidget",Ia,"openWidget"),Ia.toggleFoldableValue(ba.value));return Ia}},{key:"baseControl",value:function(ba){var Ia=ba.spec;ba=new this({keyString:ba.keyString,valueString:ba.valueString,isSelected:!1,propertyValue:ba.value});Ia.foldable&&ba.asFoldable(Ia.foldable);return ba}},{key:"renderGrabbableKey",value:function(ba){var Ia=this,nb=ba.target;return[ba.keyString+
":",{nativeCursor:"-webkit-grab",onDragStart:function(zb){zb.state.draggedProp=new Jc.DraggedProp({sourceObject:nb,control:Ia.baseControl(ba)});zb.state.draggedProp.openInWorld();Jc.connect(zb.hand,"update",zb.state.draggedProp,"update")},onDrag:function(zb){},onDragEnd:function(zb){Jc.disconnect(zb.hand,"update",zb.state.draggedProp,"update");zb.state.draggedProp.applyToTarget(zb)}}]}},{key:"renderEnumControl",value:function(ba){var Ia=ba.value,nb=ba.spec.values,zb=ba.keyString,Ec=ba.target,Gc=ba.node;
return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(Ia?Ia.valueOf?Ia.valueOf():Ia:"Not set"),{nativeCursor:"pointer",onMouseDown:function(qd,sd){return $jscomp.asyncExecutePromiseGeneratorProgram(function(vd){Ec.world().openWorldMenu(qd,nb.map(function(Cf){return{string:Cf.toString(),action:function(){Ec[zb]=Cf;Gc.rerender()}}}));vd.jumpToEnd()})}}],$jscomp.arrayFromIterable(Jc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7})))}},{key:"renderStringControl",
value:function(ba){var Ia=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(200<Ia.length?Ia.slice(0,20)+"...":Ia),{fontColor:Jc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(ba){var Ia=ba.value,nb=ba.keyString,zb=ba.valueString,Ec=ba.target,Gc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+zb,{fontColor:Jc.Color.black,nativeCursor:"pointer",onMouseDown:function(qd){var sd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vd){if(1==
vd.nextAddress)return sd=new Jc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:Ia}),sd.relayout(),vd.yield(sd.fadeIntoWorld(qd.positionIn(Ec.world())),2);Jc.connect(sd,"rectangle",function(Cf){Ec[nb]=Cf;Gc.rerender()});vd.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(ba){var Ia=ba.value,nb=ba.keyString,zb=ba.valueString,Ec=ba.target,Gc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+zb,{nativeCursor:"pointer",fontColor:Ia?Jc.Color.green:
Jc.Color.red,onMouseDown:function(qd){Ec[nb]=!Ec[nb];Gc.rerender()}}])}},{key:"renderNumberControl",value:function(ba){var Ia=ba.value,nb=ba.spec,zb=ba.keyString,Ec=ba.valueString,Gc=ba.node,qd=ba.target,sd=ba.tree,vd=void 0===Gc._numberControls?new of:Gc._numberControls,Cf=$jscomp.makeIterator(vd.submorphs),yg=Cf.next().value,fg=Cf.next().value;vd.fontColor=sd.fontColor;var xf=Gc._numberControls=vd;"max"in nb&&"min"in nb&&-Infinity!=nb.min&&Infinity!=nb.max?(xf.baseFactor=(nb.max-nb.min)/100,xf.floatingPoint=
nb.isFloat,xf.max=nb.max,xf.min=nb.min):(xf.floatingPoint=nb.isFloat,xf.baseFactor=.5,xf.min=void 0!=nb.min?nb.min:-Infinity,xf.max=void 0!=nb.max?nb.max:Infinity);var ri=Jc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),$jscomp.arrayFromIterable(Gc._inputMorph?[Gc._inputMorph,{}]:[" "+(void 0!=Ia&&(Ia.valueOf?Ia.valueOf():Ia).toFixed(nb.isFloat?3:0))+" ",{fontColor:ri,onMouseUp:function(Lh){Gc._inputMorph=Jc.morph({type:"input",
fill:null,fontColor:ri,fontFamily:"IBM Plex Mono",fontSize:14,padding:Jc.rect(8,2,-6,2),height:23,cursorColor:Jc.Color.white,value:Ia.valueOf?Ia.valueOf():Ec});qd[zb]=Ia;Gc._inputMorph.focus();Jc.once(Gc._inputMorph,"inputAccepted",function(Aj){delete Gc._inputMorph;qd[zb]=nb.isFloat?Number.parseFloat(Aj):Number.parseInt(Aj);Gc.rerender()});Jc.once(Gc._inputMorph,"onBlur",function(Aj){Gc._inputMorph&&(delete Gc._inputMorph,qd[zb]=Ia,Gc.rerender())});Gc.rerender()},onDragStart:function(Lh){xf.scrubbedValue=
Ia;Jc.onNumberDragStart(Lh,xf)},onDrag:function(Lh){qd[zb]=Jc.onNumberDrag(Lh,xf);Gc.rerender()},onDragEnd:function(Lh){return Jc.onNumberDragEnd(Lh,xf)}},vd,{onMouseUp:function(){yg.fill=fg.fill=null},onMouseDown:function(Lh){if(Lh.targetMorph===yg){yg.fill=Jc.Color.white.withA(.2);if("max"in nb&&qd[zb]>=nb.max)return;qd[zb]+=1}if(Lh.targetMorph===fg){fg.fill=Jc.Color.white.withA(.2);if("min"in nb&&qd[zb]<=nb.min)return;--qd[zb]}Gc.rerender()}}]))}},{key:"renderShadowControl",value:function(ba){var Ia=
ba.keyString,nb=ba.value,zb=ba.target,Ec=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[""+(nb?nb.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(Gc){var qd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sd){if(1==sd.nextAddress)return qd=new Jc.popovers.ShadowPopover({shadowValue:zb[Ia],hasFixedPosition:!0}),sd.yield(qd.fadeIntoWorld(Gc.positionIn(zb.world())),2);Jc.connect(qd,"shadowValue",function(vd){zb[Ia]=vd;Ec.rerender()});
sd.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(ba){var Ia=ba.keyString,nb=ba.value,zb=ba.target,Ec=ba.node,Gc=Jc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,qd={nativeCursor:"pointer",onMouseDown:function(sd){var vd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cf){if(1==Cf.nextAddress)return vd=new Jc.popovers.PointPopover({pointValue:zb[Ia],hasFixedPosition:!0}),Cf.yield(vd.fadeIntoWorld(sd.positionIn(zb.world())),2);Jc.connect(vd,"pointValue",function(yg){zb[Ia]=
yg;Ec.rerender()});Cf.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" pt(",Object.assign({},qd),""+nb.x.toFixed(),Object.assign({fontColor:Gc},qd),",",Object.assign({},qd),""+nb.y.toFixed(),Object.assign({fontColor:Gc},qd),")",Object.assign({},qd)])}},{key:"renderLayoutControl",value:function(ba){var Ia=ba.valueString,nb=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(nb?Ia:"No Layout"),{onMouseDown:function(zb){}}])}},
{key:"renderColorControl",value:function(ba){var Ia=ba.node,nb=ba.gradientEnabled,zb=ba.valueString,Ec=ba.keyString,Gc=ba.value,qd=ba.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[Jc.morph({fill:Gc.valueOf?Gc.valueOf():Gc,extent:Jc.pt(15,15),borderColor:Jc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(Gc?Gc.valueOf?Gc.valueOf():zb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(sd){var vd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cf){if(1==
Cf.nextAddress)return vd=new Jc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:qd,fillValue:Gc,title:"Fill Control",gradientEnabled:nb}),Cf.yield(vd.fadeIntoWorld(sd.positionIn(qd.world())),2);Jc.connect(vd,"fillValue",function(yg){qd[Ec]=yg;Ia.rerender()});Cf.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(ba){var Ia=ba.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+Ia,{}])}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5069,end:20353})}(Jc.DraggableTreeLabel);Jc.PropertyControl=Ce;Jc.PropertyControl=Ce;Jc.PropertyControl=Ce;Jc.inspect=Oc;Jc.inspect=Oc;Jc.remoteInspect=te;Jc.remoteInspect=te;Jc.generateReferenceExpression=md;Jc.generateReferenceExpression=md;var of=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=$a.hasOwnProperty("NumberControls")&&
"function"===typeof $a.NumberControls?$a.NumberControls:$a.NumberControls=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Jc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Jc.Color.transparent},width:{defaultValue:15},
fontColor:{derived:!0,set:function(ba){this.submorphs.map(function(Ia){return Ia.fontColor=ba})}},submorphs:{initialize:function(){this.submorphs=[Jc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Jc.rect(5,2,0,-6),fontSize:12}),Jc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Jc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23026,end:24071})}(Jc.Morph);(function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=$a.hasOwnProperty("PropertyTree")&&"function"===typeof $a.PropertyTree?$a.PropertyTree:$a.PropertyTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,
Ja,[{key:"onDrag",value:function(ba){this._onDragHandler&&this._onDragHandler(ba)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25236,end:25347})})(Jc.Tree);Ce=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),
Bb=$a.hasOwnProperty("Inspector")&&"function"===typeof $a.Inspector?$a.Inspector:$a.Inspector=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(ba){}},{key:"__after_deserialize__",value:function(ba,Ia,nb){var zb=this,Ec=new Jc.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:Jc.InspectionTree.forObject(null,this)}));this.addMorph(Ec,this.getSubmorphNamed("terminal toggler"));Qb._get(Object.getPrototypeOf(Bb.prototype),"__after_deserialize__",this).call(this,ba,Ia,nb);!this.isComponent&&this.master.whenApplied().then(function(){zb.layout.col(0).row(1).group.morph=Ec;zb.targetObject&&(zb.targetObject=zb.targetObject)})}},{key:"__additionally_serialize__",value:function(ba,Ia,nb,zb){ba=ba.props.submorphs.value;for(Ia=ba.length;Ia--;)nb.refForId(ba[Ia].id).realObj==
this.ui.propertyTree&&Jc.arr.removeAt(ba,Ia)}},{key:"renderDraggableTreeLabel",value:function(ba){return new Jc.DraggableTreeLabel(ba)}},{key:"renderPropertyControl",value:function(ba){return Jc.PropertyControl.render(ba)}},{key:"onLoad",value:function(){var ba=this.ui,Ia=ba.codeEditor,nb=ba.thisBindingSelector,zb=ba.propertyTree;Ia.changeEditorMode("js").then(function(){return Ia.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==nb.selection?Ia.owner.selectedContext:
Ia.owner.targetObject},get systemInterface(){return Jc.Path("treeData.systemInterface").get(zb)},format:"esm"}}).catch(function(Ec){return $world.logError(Ec)})}},{key:Symbol.for("lively-instance-initialize"),value:function(ba){Qb._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);ba=this.ui;var Ia=ba.targetPicker,nb=ba.propertyTree,zb=ba.resizer,Ec=ba.terminalToggler,Gc=ba.unknowns,qd=ba.internals,sd=ba.searchField,vd=ba.codeEditor,Cf=ba.fixImportButton,
yg=ba.thisBindingSelector;vd.changeEditorMode("js").then(function(){return vd.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==yg.selection?vd.owner.selectedContext:vd.owner.targetObject},get systemInterface(){return nb.treeData.systemInterface},format:"esm"}}).catch(function(fg){return $world.logError(fg)});Jc.connect(Ia,"onMouseDown",this,"selectTarget");Jc.connect(nb,"onScroll",this,"repositionOpenWidget");Jc.connect(zb,"onDrag",this,"adjustProportions");
Jc.connect(Ec,"onMouseDown",this,"toggleCodeEditor");Jc.connect(Gc,"trigger",this,"filterProperties");Jc.connect(qd,"trigger",this,"filterProperties");Jc.connect(sd,"searchInput",this,"filterProperties");Jc.connect(nb,"nodeCollapseChanged",this,"filterProperties");Jc.connect(this,"extent",this,"relayout");Jc.connect(yg,"selection",this,"bindCodeEditorThis");Jc.connect(Cf,"fire",vd,"execCommand",{updater:function(fg){return fg("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},
{key:"refreshSelectedLine",value:function(){var ba=this.ui.propertyTree.selectedIndex-1,Ia=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Ia=this.ui.propertyTree.document.getLine(ba).textAndAttributes.slice(0,4).concat(Ia.display(this));ba=this.ui.propertyTree.lineRange(ba,!1);this.ui.propertyTree.replace(ba,Ia,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();
if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var ba=Jc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(ba!=this.lastChange||this.lastSubmorphs!=Jc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==ba.prop&&this.repositionOpenWidget(),this.lastChange=ba,this.lastSubmorphs=
Jc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var ba;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Ia){Ia=Ia.node;Ia.target&&(ba=Ia.foldableNode?Ia.target[Ia.foldableNode.key][Ia.key]:Ia.target[Ia.key],!Jc.obj.equals(ba,Ia.value)&&Ia.refreshProperty&&Ia.refreshProperty(ba))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},
{key:"prepareForNewTargetObject",value:function(ba,Ia){Ia=void 0===Ia?!1:Ia;var nb=this,zb,Ec,Gc,qd,sd,vd,Cf,yg,fg,xf,ri,Lh,Aj,Zh,qk;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gg){switch(Gg.nextAddress){case 1:if(!nb.isUpdating()){Gg.jumpTo(2);break}return Gg.yield(nb.whenUpdated(),2);case 2:zb=Jc.promise.deferred();Ec=zb.promise;Gc=!!nb.target;nb.updateInProgress=Ec;Gg.setCatchFinallyBlocks(4);Ia&&(qd=Jc.LoadingIndicator.open("connecting to remote..."));if(!Ia){sd=Jc.InspectionTree.forObject(ba,
nb);Gg.jumpTo(6);break}return Gg.yield(Jc.RemoteInspectionTree.forObject(ba,nb),7);case 7:sd=Gg.yieldResult;case 6:return vd=sd,Cf=nb.ui.propertyTree,Gg.yield(vd.collapse(vd.root,!1),8);case 8:if(!vd.root.children){Gg.jumpTo(9);break}return Gg.yield(vd.collapse(vd.root.children[0],!1),9);case 9:if(yg=nb.originalTreeData&&nb.originalTreeData.diff(vd)){fg=$jscomp.makeIterator(yg);for(xf=fg.next();!xf.done;xf=fg.next())ri=xf.value,Lh=$jscomp.makeIterator(ri),Aj=Lh.next().value,Zh=Lh.next().value,Aj.refreshProperty(Zh.value);
Gg.jumpTo(11);break}Cf.treeData=vd;return Gg.yield(nb.filterProperties(),12);case 12:if(!Cf.treeData.root.isCollapsed){Gg.jumpTo(13);break}return Gg.yield(Cf.onNodeCollapseChanged({node:vd.root,isCollapsed:!1}),14);case 14:Cf.selectedIndex=1;case 13:return Gg.yield(Cf.execCommand("uncollapse selected node"),11);case 11:nb.toggleWindowStyle(Gc);qd&&qd.remove();Gg.leaveTryBlock(5);break;case 4:qk=Gg.enterCatchBlock(),nb.showError(qk);case 5:nb.startStepping(1E3,"refreshAllProperties"),nb.updateInProgress=
null,Gg.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(ba){ba=void 0===ba?!0:ba;var Ia=this,nb,zb,Ec,Gc,qd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sd){if(1==sd.nextAddress)return nb=300,Gc=Ia.ui.codeEditor.pluginFind(function(vd){return vd.runEval}),qd=Ia.getWindow(),sd.yield(Gc.runEval("System.get('@system-env').node"),2);sd.yieldResult.value?(Ec=[].concat($jscomp.arrayFromIterable(Jc.arr.without(qd.styleClasses,"local")),["node"]),zb=Jc.DarkTheme.instance):(Ec=["local"].concat($jscomp.arrayFromIterable(qd?
Jc.arr.without(qd.styleClasses,"node"):[])),zb=Jc.DefaultTheme.instance);Gc.theme=zb;ba?(qd&&qd.animate({duration:nb,styleClasses:Ec}),Ia.ui.codeEditor.animate({fill:zb.background,duration:nb})):qd&&(qd.styleClasses=Ec);Ia.ui.codeEditor.textString=Ia.ui.codeEditor.textString;Gc.highlight();sd.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},
{key:"build",value:function(){var ba=this,Ia=Object.assign({type:"text",borderWidth:1,borderColor:Jc.Color.gray,lineWrapping:"by-chars"},Jc.config.codeEditor.defaultStyle,{textString:""}),nb=Jc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Jc.rect(0,0,this.width,30);var zb=new Jc.SearchField({styleClasses:["idle"],name:"searchField"});nb[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[zb,{type:"button",name:"targetPicker",padding:Jc.rect(2,2,0,0),borderRadius:15,
master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Jc.Icon.textAttribute("crosshairs")},new Jc.LabeledCheckBox({label:"Internals",name:"internals"}),new Jc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Jc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Jc.InspectionTree.forObject(null,this)})),Jc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},Ia),{name:"fix import button",
type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Jc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(nb),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(nb),[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){ba.ui.thisBindingSelector.selection=
"target"})}},{key:"selectTarget",value:function(){var ba=this,Ia,nb,zb,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gc){switch(Gc.nextAddress){case 1:if(ba.env.eventDispatcher.isKeyPressed("Shift"))return nb=$jscomp,zb=nb.makeIterator,Gc.yield($world.execCommand("select morph",{justReturn:!0}),5);ba.toggleSelectionInstructions(!0);return Gc.yield(Jc.InteractiveMorphSelector.selectMorph(),4);case 4:Ia=Gc.yieldResult;ba.toggleSelectionInstructions(!1);Gc.jumpTo(3);break;case 5:Ec=
zb.call(nb,Gc.yieldResult),Ia=Ec.next().value;case 3:Ia&&(ba.targetObject=Ia),Gc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(ba){if(ba&&!this.instructionWidget){var Ia=Jc.morph({type:"label",name:"escapeKey",value:"esc"});Ia.whenRendered().then(function(){return Ia.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",
{},Ia,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(ba){ba=ba.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;ba.epiMorph=!0;this.openWidget=ba;Jc.once(ba,"close",this,"closeOpenWidget");Jc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",
value:function(){var ba=this.ui.propertyTree,Ia=ba.textLayout.boundsFor(ba,{column:0,row:ba.selectedIndex-1});Ia=ba.worldPoint(Jc.pt(Ia.x,Ia.y+Ia.height/2)).addPt(ba.scroll.negated());ba=ba.globalBounds();Ia.x=this.globalBounds().center().x;Ia.y<ba.top()?Ia=ba.topCenter():ba.bottom()-20<Ia.y&&(Ia=ba.bottomCenter().addXY(0,-20));return Ia}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",
value:function(ba){this.layout.row(1).height+=ba.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(ba){if(ba!==this.isEditorVisible()){var Ia=this.extent,nb=this.layout,zb=this.ui,Ec=zb.terminalToggler,Gc=zb.codeEditor,qd=zb.thisBindingSelector;zb=zb.fixImportButton;nb.disable();ba?(Ec.fontColor=Jc.Color.rgbHex("00e0ff"),nb.row(3).height=this.codeEditorHeight||180,nb.row(2).height=5,zb.animate({visible:!0,
duration:200}),qd.animate({visible:!0,duration:200})):(this.codeEditorHeight=nb.row(3).height,Ec.fontColor=Jc.Color.white,nb.row(3).height=nb.row(2).height=0,zb.animate({visible:!1,duration:200}),qd.animate({visible:!1,duration:200}));this.extent=Ia;nb.enable({duration:200});this.relayout({duration:200});Gc.focus();Gc.animate({opacity:ba?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){ba.makeEditorVisible(!ba.isEditorVisible());
Ia.jumpToEnd()})}},{key:"filterProperties",value:function(){var ba=this,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return Ia=ba.ui.searchField,nb=ba.ui.propertyTree,ba.originalTreeData||(ba.originalTreeData=nb.treeData),Jc.disconnect(nb.treeData,"onWidgetOpened",ba,"onWidgetOpened"),zb.yield(nb.treeData.filter({maxDepth:2,showUnknown:ba.ui.unknowns.checked,showInternal:ba.ui.internals.checked,iterator:function(Ec){return Ia.matches(Ec.key)}}),2);nb.update();
Jc.connect(nb.treeData,"onWidgetOpened",ba,"onWidgetOpened");zb.jumpToEnd()})}},{key:"relayout",value:function(ba){ba=void 0===ba?{}:ba;var Ia=this,nb,zb,Ec,Gc,qd,sd,vd,Cf,yg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fg){Ia.layout&&Ia.layout.forceLayout();nb=Ia;zb=nb.ui;Ec=zb.fixImportButton;Gc=zb.terminalToggler;qd=zb.propertyTree;sd=zb.thisBindingSelector;vd=qd.bounds().insetBy(5).bottomLeft();Cf=qd.bounds().insetBy(5).bottomRight();yg=Cf.subXY(Ec.width+10,0);sd.width=115;sd.listMorph.itemHeight=
20;ba.duration?(Gc.animate(Object.assign({bottomLeft:vd},ba)),Ec.animate(Object.assign({bottomRight:Cf},ba)),sd.animate(Object.assign({bottomRight:yg},ba))):(Gc.bottomLeft=vd,Ec.bottomRight=Cf,sd.bottomRight=yg);fg.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Qb._get(Object.getPrototypeOf(Bb.prototype),"keybindings",
this))}},{key:"commands",get:function(){return Jc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(ba){if(System._testsRunning)return console.log(ba.targetObject);ba=new this(ba);ba.openInWindow();return ba}},{key:"properties",get:function(){return{extent:{defaultValue:Jc.pt(400,500)},fill:{defaultValue:Jc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],
set:function(ba){this.setProperty("remoteTarget",ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ba,!0))}},targetObject:{after:["submorphs"],set:function(ba){this._serializableTarget=ba&&ba.isMorph?ba.id:ba;this.setProperty("targetObject",ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ba))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var ba=this.ui.propertyTree,Ia=ba.treeData;return Ia.getContextFor(ba.selectedNode||
Ia.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),
searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Jc.Color.gray,fontSize:14,fontFamily:Jc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25364,end:45723})}(Jc.Morph);Ce=Jc.Inspector;wf=Ba("I",Ce);Jc.default=Ce;var pg=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");pg.Inspector=wf;pg.string=rd;pg.Morph=Dc;pg.pt=Xd;pg.Color=Ab;Ce=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ja,$a,Bb){Bb=void 0===Bb?1:Bb;var ba,
Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:return Ja.maybeSelectCommentOrLine(),zb.setCatchFinallyBlocks(2),$a=Object.assign({},$a,{logDoit:!0,inspect:!0,inspectDepth:Bb}),zb.yield(Ja.doEval(void 0,$a),4);case 4:ba=zb.yieldResult;Ia=ba.error?ba.error:ba.isError?ba.value:null;zb.leaveTryBlock(3);break;case 2:Ia=nb=zb.enterCatchBlock();case 3:return Ia?Ja.showError(Ia):Ja.setStatusMessage(pg.string.truncate(ba.value,1E3)),zb.return(ba)}})}},{name:"eval all",
doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ja,$a){var Bb,ba,Ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nb){switch(nb.nextAddress){case 1:return nb.setCatchFinallyBlocks(2),nb.yield(Ja.doEval({start:{row:0,column:0},end:Ja.documentEndPosition},Object.assign({},$a,{logDoit:!0})),4);case 4:Bb=nb.yieldResult;ba=Bb.error?Bb.error:Bb.isError?Bb.value:null;nb.leaveTryBlock(3);break;case 2:ba=Ia=nb.enterCatchBlock();case 3:return ba?Ja.showError(ba):
Ja.setStatusMessage(String(Bb.value)),nb.return(Bb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ja,$a){var Bb,ba,Ia,nb,zb,Ec,Gc,qd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sd){switch(sd.nextAddress){case 1:return Ja.maybeSelectCommentOrLine(),sd.setCatchFinallyBlocks(2),$a=Object.assign({},$a,{asString:!1,logDoit:!0}),sd.yield(Ja.doEval(void 0,$a),4);case 4:Bb=sd.yieldResult;ba=Bb.error?
Bb.error:Bb.isError?Bb.value:null;sd.leaveTryBlock(3);break;case 2:ba=Ia=sd.enterCatchBlock();case 3:Ja.selection.collapseToEnd();if(nb=Bb.value&&Bb.value.isColor)return Ja.selection.text=String(Bb.value),zb=new pg.Morph({fill:pg.Color.transparent,extent:pg.pt(Ja.fontSize+2,Ja.fontSize+2),submorphs:[{fill:Bb.value,center:pg.pt(Ja.fontSize+2,Ja.fontSize+2).scaleBy(.5)}]}),Ec=Ja.selection.start,Gc=Ec.column,qd=Ec.row,Ja.insertText([zb,{}],Ja.selection.start),Ja.selection.start={column:Gc,row:qd},Ja.focus(),
sd.return(Bb);Ja.insertTextAndSelect(ba?String(ba)+(ba.stack?"\n"+ba.stack:""):String(Bb.value));Ja.focus();return sd.return(Bb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ja,$a){var Bb,ba,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:debugger;Ja.maybeSelectCommentOrLine();ba=Ja.textInRange(Ja.selection);Ia=Ja.evalEnvironment||{};nb=Ja.pluginFind(function(Ec){return Ec.isEditorPlugin&&
"function"===typeof Ec.runEval});Ia.systemInterface||(Ia.systemInterface=nb.systemInterface($a));if("local"!==Ia.systemInterface.name){zb.jumpTo(2);break}zb.setCatchFinallyBlocks(3);return zb.yield(Ja.doEval(void 0,$a),5);case 5:Bb=zb.yieldResult;ba=Bb.value;zb.leaveTryBlock(2);break;case 3:zb.enterCatchBlock();case 2:return Ja.world().execCommand("open object editor",{target:ba,evalEnvironment:Ia}),zb.return(Bb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",
exec:function(Ja,$a){var Bb,ba,Ia,nb,zb,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gc){switch(Gc.nextAddress){case 1:Ja.maybeSelectCommentOrLine();Ia=Ja.textInRange(Ja.selection);nb=Ja.evalEnvironment||{};zb=Ja.pluginFind(function(qd){return qd.isEditorPlugin&&"function"===typeof qd.runEval});nb.systemInterface||(nb.systemInterface=zb.systemInterface($a));if("local"!==nb.systemInterface.name){pg.Inspector.openInWindow({remoteTarget:{code:Ia,evalEnvironment:nb}});Gc.jumpTo(2);break}Gc.setCatchFinallyBlocks(3);
return Gc.yield(Ja.doEval(void 0,$a),5);case 5:Bb=Gc.yieldResult;ba=Bb.error?Bb.error:Bb.isError?Bb.value:null;Ia=Bb.value;Gc.leaveTryBlock(4);break;case 3:ba=Ec=Gc.enterCatchBlock();case 4:pg.Inspector.openInWindow({targetObject:ba||Ia});case 2:return Gc.return(Bb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",handlesCount:!0,exec:function(Ja,$a,Bb){Bb=void 0===Bb?1:Bb;var ba;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){switch(Ia.nextAddress){case 1:return Ja.maybeSelectCommentOrLine(),Ia.setCatchFinallyBlocks(2),$a=Object.assign({},$a,{inspect:!0,inspectDepth:Bb,logDoit:!0}),Ia.yield(Ja.doEval(void 0,$a),4);case 4:ba=Ia.yieldResult;Ia.leaveTryBlock(3);break;case 2:Ia.enterCatchBlock();case 3:return Ja.selection.collapseToEnd(),Ja.insertTextAndSelect(ba.value),Ia.return(ba)}})}}];pg.codeEvaluationCommands=Ce;pg.codeEvaluationCommands=Ce;pg.codeEvaluationCommands=
Ce;var qg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");qg.changeAttributeInSelectionOrMorph=function(Ja,$a,Bb){var ba=Ja.selection;Ja.keepPosAtSameScrollOffsetWhile(function(){ba.isEmpty()?Ja[$a]="function"===typeof Bb?Bb(Ja[$a]):Bb:(Ja.undoManager.group(),Ja.changeStyleProperty($a,function(Ia){return"function"===typeof Bb?Bb(Ia):Bb}),Ja.undoManager.group())})};wf=[{name:"increase font size",scrollCursorIntoView:!1,exec:function(Ja){var $a=Ja.fontSize;qg.changeAttributeInSelectionOrMorph(Ja,
"fontSize",function(Bb){Bb=Bb||$a;return Bb+(18<=Bb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ja){var $a=Ja.fontSize;qg.changeAttributeInSelectionOrMorph(Ja,"fontSize",function(Bb){Bb=Bb||$a;return Bb-(18>=Bb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ja){var $a,Bb,ba,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress){$a=["serif","sans-serif","monospace"];if(Bb=localStorage["lively.morpic/text-change-font-additional-fonts"])Bb=
JSON.parse(Bb),$a.push.apply($a,$jscomp.arrayFromIterable(Bb));$a.map(function(Ec){return Ec.toLowerCase()}).includes(Ja.fontFamily.toLowerCase())||($a.push(Ja.fontFamily),Bb=[].concat($jscomp.arrayFromIterable(Bb||[]),[Ja.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Bb));return zb.yield($world.editListPrompt("choose font",$a,{requester:Ja,preselect:$a.indexOf(Ja.fontFamily),historyId:"lively.morpic/text-change-font-hist"}),2)}ba=zb.yieldResult;Ia=$jscomp.makeIterator(ba.selections);
if(nb=Ia.next().value)Ja.fontFamily=nb;return zb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ja,$a){$a=void 0===$a?{}:$a;var Bb,ba,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress){if($a.hasOwnProperty("link"))return zb.jumpTo(2);ba=Ja.selection;Ia=Ja.getStyleInRange(ba);nb=Ia.link;return zb.yield(Ja.world().prompt("Set link",{input:nb||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=zb.nextAddress&&
(Bb=zb.yieldResult,!Bb))return zb.return();Ja.undoManager.group();Ja.setStyleInRange({link:Bb||void 0},ba);Ja.undoManager.group();zb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ja,$a){var Bb,ba,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return Bb=Ja.selection,ba=Ja.getStyleInRange(Bb),Ia=ba.doit,zb.yield(Ja.world().editPrompt("Enter doit code (runs on clicking the text)",{requester:Ja,input:Ia?Ia.code:"// empty doit",
historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ja.evalEnvForDoit(Ia||{})}),2);nb=zb.yieldResult;Ja.undoManager.group();nb?Ja.addTextAttribute({doit:{code:nb},nativeCursor:"pointer",textDecoration:"underline"},Bb):Ja.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Bb);Ja.undoManager.group();zb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ja,$a){$a=void 0===$a?{}:$a;Ja.undoManager.group();$a=!$a.onlySelection&&Ja.selection.isEmpty()?
Ja.documentRange:Ja.selection.range;Ja.setStyleInRange(null,$a);Ja.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ja){var $a,Bb,ba,Ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nb){if(1==nb.nextAddress)return nb.yield(System.import("lively.modules"),2);if(3!=nb.nextAddress)return $a=nb.yieldResult,Bb=$a.module,nb.yield(Bb("lively.ide/text/ui.js").load(),3);ba=nb.yieldResult;Ia=ba.RichTextControl;return nb.return(Ia.openFor(Ja))})}}];qg.commands=
wf;qg.commands=wf;qg.commands=wf;var ff=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");ff.guessTextModeName=Eb;ff.rangedToken=function(Ja,$a,Bb,ba,Ia){return{start:{row:Ja,column:$a},end:{row:Ja,column:Bb},token:ba,mode:Ia}};ff.fun=vc;ff.arr=dc;ff.connect=Lc;ff.disconnect=Nb;ff.DefaultTheme=Mb;ff.tokenizeDocument=pb;ff.modeInfo=Ca;ff.visitDocumentTokens=Rc;ff.getMode=ec;ff.completionCommands=za;ff.multiSelectCommands=Cc;ff.navCommands=he;ff.codeCommands=nf;ff.codeEvaluationCommands=
Ce;ff.richTextCommands=wf;ff.Color=Ab;ff.Range=ke;ff.guessTextModeName=Eb;ff.guessTextModeName=Eb;Mb=function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Bb=$a.hasOwnProperty("EditorPlugin")&&"function"===typeof $a.EditorPlugin?$a.EditorPlugin:$a.EditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Bb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
ff.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(ba){var Ia=this;this.textMorph=ba;ff.connect(ba,"textChange",this,"onTextChange");ff.connect(ba,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Ia.highlight()})}},
{key:"detach",value:function(ba){ff.disconnect(ba,"textChange",this,"onTextChange");ff.disconnect(ba,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(ba){this._ast=null;if(ba){var Ia=this._tokenizerValidBefore;if("replace"===ba.selector){var nb=ba.args[0].start;ba=nb.row;nb=nb.column}else nb=ba=0;if(!Ia||ba<Ia.row||ba===Ia.row&&nb<Ia.column)ba=Math.max(0,ba),this._tokenizerValidBefore={row:ba,
column:nb}}this.requestHighlight()}},{key:"requestHighlight",value:function(ba){var Ia=this;(void 0===ba?0:ba)?this.highlight():ff.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return Ia.highlight()})()}},{key:"highlight",value:function(){var ba=this.textMorph,Ia=this.theme,nb=this.mode,zb=this._tokenizerValidBefore;if(Ia&&ba&&ba.document&&nb){ba.fill=Ia.background;ba.cursorColor=Ia.cursorColor||ff.Color.black;var Ec=ba.viewState,Gc={};zb=ff.tokenizeDocument(nb,ba.document,Ec.firstVisibleRow,
Ec.lastVisibleRow,zb);nb=zb.lines;zb=zb.tokens;if(nb.length){Ec=nb[0].row;for(var qd=[],sd=0;sd<zb.length;Ec++,sd++)for(var vd=zb[sd],Cf=0;Cf<vd.length;Cf+=5){var yg=vd[Cf],fg=vd[Cf+1],xf=Ia[vd[Cf+2]]||Ia.default;xf&&qd.push({start:{row:Ec,column:yg},end:{row:Ec,column:fg}},xf)}ba.embeddedMorphs.forEach(function(ri){var Lh=ba.embeddedMorphMap.get(ri).anchor;Gc[ri.id]=ba.textAttributeAt(Lh.position)});ba.setTextAttributesWithSortedRanges(qd);ba.embeddedMorphs.forEach(function(ri){var Lh=ba.embeddedMorphMap.get(ri).anchor;
Lh=ff.Range.at(Lh.position);Lh.end.column+=1;ba.replace(Lh,[ri,Gc[ri.id]],!1)});this._tokenizerValidBefore={row:ff.arr.last(nb).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},ba,this)}}},{key:"visitTokensInRange",value:function(ba,Ia){var nb=ba.start,zb=ba.end,Ec=nb.row-1;ff.visitDocumentTokens(this.mode,this.textMorph.document,nb.row,zb.row,null,function(Gc){return Ec++},function(Gc,qd,sd,vd,Cf,yg,fg){if(Ec===nb.row&&0<nb.column){if(nb.column>=vd)return;sd<nb.column&&nb.column<
vd&&(sd=nb.column)}if(Ec===zb.row){if(zb.column<=sd)return;sd<zb.column&&zb.column<vd&&(vd=zb.column)}Ia(Gc,qd,Ec,sd,vd,Cf,yg,fg)})}},{key:"tokensInRange",value:function(ba){var Ia=[];this.visitTokensInRange(ba,function(nb,zb,Ec,Gc,qd,sd,vd,Cf){return Ia.push(ff.rangedToken(Ec,Gc,qd,nb,Cf))});return Ia}},{key:"tokensOfRow",value:function(ba){var Ia=this.textMorph.getLine(ba).length;return this.tokensInRange({start:{row:ba,column:0},end:{row:ba,column:Ia}})}},{key:"tokenAt",value:function(ba){for(var Ia=
this.tokensOfRow(ba.row),nb=Ia.length;nb--;){var zb=Ia[nb];if(zb.token&&zb.start.column<=ba.column&&ba.column<=zb.end.column)return zb}return null}},{key:"getCommands",value:function(ba){return[].concat($jscomp.arrayFromIterable(ba),$jscomp.arrayFromIterable(ff.completionCommands),$jscomp.arrayFromIterable(ff.multiSelectCommands),$jscomp.arrayFromIterable(ff.navCommands),$jscomp.arrayFromIterable(ff.codeCommands),$jscomp.arrayFromIterable(ff.codeEvaluationCommands),$jscomp.arrayFromIterable(ff.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var ba=this.mode,Ia=ba.lineComment,nb=ba.blockCommentStart;ba=ba.blockCommentEnd;var zb={};Ia&&(zb.lineCommentStart=Ia);nb&&(zb.blockCommentStart=nb);ba&&(zb.blockCommentEnd=ba);return zb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(ba,Ia,nb){var zb=this.textMorph,Ec=ba.row,Gc=ba.column;ba=Ia[Gc-1];Ia=Ia[Gc];zb.selection.text="\n";zb.selection.collapseToEnd();
"{"===ba&&"}"===Ia&&(zb.selection.text="\n"+" ".repeat(nb),zb.selection.collapse());zb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Ec+1,lastRow:Ec+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var ba=this.textMorph,Ia=this.openPairs,nb=ba.selection,zb=ba.getLine(nb.end.row),
Ec=zb[nb.end.column-1];zb=zb[nb.end.column];ba.autoInsertPairs&&nb.isEmpty()&&Ec in Ia&&zb===Ia[Ec]&&(nb.growRight(1),nb.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(ba){var Ia=this.openPairs,nb=this.closePairs,zb=this.textMorph,Ec=zb.selection,Gc=zb.autoInsertPairs&&ba in Ia,qd=zb.autoInsertPairs&&ba in nb;if(!Gc&&!qd)return!1;var sd=zb.getLine(Ec.end.row)[Ec.end.column];if(!Ec.isEmpty()){if(!Gc)return!1;nb=zb.undoManager.ensureNewGroup(zb);zb.insertText(Ia[ba],Ec.end);zb.insertText(ba,
Ec.start);zb.undoManager.group(nb);Ec.growRight(-1);return!0}if(sd in nb&&ba===sd)return Ec.goRight(1),!0;if(qd&&!Gc)return!1;nb=zb.undoManager.ensureNewGroup(zb);zb.insertText(ba+Ia[ba]);zb.undoManager.group(nb);Ec.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],$a,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);Ca=Mb=ff.EditorPlugin;za=Ba("C",function(Ja){var $a=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Bb=$a.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof $a.CodeMirrorEnabledEditorPlugin?$a.CodeMirrorEnabledEditorPlugin:$a.CodeMirrorEnabledEditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Qb(Bb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(){Qb._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(ba){this.mode=this.codeMirrorMode(ba);return Qb._get(Object.getPrototypeOf(Bb.prototype),"attach",this).call(this,ba)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",
value:function(ba){return{indentWithTabs:!ba.useSoftTabs,indentUnit:ba.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(ba){ba=this.defaultCodeMirrorModeConfig(ba);return ff.getMode(ba,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],$a,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(ff.EditorPlugin));ff.CodeMirrorEnabledEditorPlugin=za;ff.CodeMirrorEnabledEditorPlugin=za;ff.CodeMirrorEnabledEditorPlugin=za;ff.default=Mb;Mb=Object.freeze({__proto__:null,guessTextModeName:Eb,"default":Ca,CodeMirrorEnabledEditorPlugin:za});Ba("e",Mb)}}});
System.register(["./__root_module__-db735625.js","./index-705f6bba.js","./index-7ce4e91c.js"],function(){var db,Zb,lc,Uc,Bc;return{setters:[function(Vd){db=Vd.M;Zb=Vd.bc;lc=Vd.r;Uc=Vd.i},function(Vd){Bc=Vd.e},function(){}],execute:function(){var Vd=lively.FreezerRuntime.recorderFor("VersionChecker/index.js");Vd.Morph=db;Vd.runCommand=Zb;Vd.evalOnServer=Bc;Vd.resource=lc;var Od=function(je){var Bd=lively.FreezerRuntime.recorderFor("VersionChecker/index.js"),jd=Bd.hasOwnProperty("VersionChecker")&&
"function"===typeof Bd.VersionChecker?Bd.VersionChecker:Bd.VersionChecker=function(zd){zd&&zd[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Uc(jd,je,[{key:"onLoad",value:function(){this.isComponent||this.withAllSubmorphsDo(function(zd){return zd.halosEnabled=!1})}},{key:"checkVersion",value:function(){this.reset();this.checkIfUpToDate()}},{key:"onMouseDown",value:function(zd){Uc._get(Object.getPrototypeOf(jd.prototype),"onMouseDown",
this).call(this,zd);this.isComponent||this.checkVersion()}},{key:"relayout",value:function(){var zd=this;this.world().withTopBarDo(function(ge){zd.bottomLeft=ge.sideBar&&ge.sideBar.visible?ge.sideBar.bottomRight.addXY(10,-10):zd.world().visibleBounds().insetBy(10).bottomLeft()})}},{key:"checkIfUpToDate",value:function(){var zd=this,ge,We,kf,bf,Hd,Ae,uc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wd){switch(wd.nextAddress){case 1:return ge="git rev-parse master",wd.yield(Vd.evalOnServer("System.baseURL").then(function(ce){return ce.replace("file://",
"")}),2);case 2:return We=wd.yieldResult,wd.yield(Vd.runCommand("git fetch",{cwd:We}).whenDone(),3);case 3:return wd.yield(Vd.runCommand(ge,{cwd:We}).whenDone(),4);case 4:return kf=wd.yieldResult,bf=kf.stdout,Hd=bf.split("\n")[0],wd.yield(Vd.resource("https://api.github.com/repos/LivelyKernel/lively.next/commits/master").readJson(),5);case 5:return Ae=wd.yieldResult,uc=Ae.sha,Hd!=uc?wd.return(zd.showOutdated(Hd.slice(0,6))):wd.return(zd.showUpToDate(Hd.slice(0,6)))}})}},{key:"showOutdated",value:function(zd){var ge=
this.ui,We=ge.checking,kf=ge.outdated;ge.status.value=["Version: ",{},"["+zd+"]",{fontWeight:"bold"}," (Please update!)"];We.visible=We.isLayoutable=!1;kf.visible=kf.isLayoutable=!0}},{key:"showUpToDate",value:function(zd){var ge=this.ui,We=ge.checking,kf=ge.latest;ge.status.value=["Version: ",{},"["+zd+"]",{fontWeight:"bold"}];We.visible=We.isLayoutable=!1;kf.visible=kf.isLayoutable=!0}},{key:"reset",value:function(){var zd=this.ui,ge=zd.checking,We=zd.outdated,kf=zd.latest;zd.status.value="Checking version...";
ge.visible=ge.isLayoutable=!0;We.visible=kf.visible=We.isLayoutable=kf.isLayoutable=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"VersionChecker"}},{key:"properties",get:function(){return{isEpiMorph:{derived:!0,get:function(){return!this.isComponent}},respondsToVisibleWindow:{derived:!0,get:function(){return!this.isComponent}},ui:{derived:!0,get:function(){return{status:this.get("version status label"),checking:this.get("loading indicator"),outdated:this.get("icon outdated"),
latest:this.get("icon latest")}}}}}}],Bd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"VersionChecker",version:"0.1.1-27"}}},{start:232,end:2913})}(Vd.Morph);Od=Vd.VersionChecker;Vd.default=Od}}});
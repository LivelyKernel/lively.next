System.register("./__root_module__-aa47e4cd.js kld-intersections ./editor-plugin-0f37a49e.js ./index-f9b193f7.js ./index-b8a9cfe8.js ./index-67dc020a.js ./index-751356d3.js ./color-picker-698f55da.js ./editor-plugin-e6d6c88a.js ./index-153adde0.js".split(" "),function(){var Ca,ub,Tb,lc,mc,Zd,id,ce,kd,$c,Cd,Fd,pe,Xd,nd,eb,Hb,Cc,qc,ld,wd,Xc,gd,bc,ad,ed,Id,hc,Qb,xb,Nb,kb,Db,Rb,vc,jc,qb,rb,cc,Vc;return{setters:[function(Bc){Ca=Bc.aq;ub=Bc.ag;Tb=Bc.ay;lc=Bc.at;mc=Bc.a1;Zd=Bc.ar;id=Bc.ao;ce=Bc.as;
kd=Bc.C;$c=Bc.a0;Cd=Bc.a4;Fd=Bc._;pe=Bc.aU;Xd=Bc.P;nd=Bc.a5;eb=Bc.az;Hb=Bc.ai;Cc=Bc.aT;qc=Bc.am;ld=Bc.aj;wd=Bc.al;Xc=Bc.bo;gd=Bc.bq;bc=Bc.bT;ad=Bc.b0;ed=Bc.bg;Id=Bc.aL;hc=Bc.n;Qb=Bc.$;xb=Bc.aV;Nb=Bc.aW;kb=Bc.an;Db=Bc.a2;Rb=Bc.ap;vc=Bc.bU},function(){},function(Bc){jc=Bc.I},function(Bc){qb=Bc.d;rb=Bc.s;cc=Bc.I;Vc=Bc.M},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){function Bc(Oa){var Qa=Oa.sourceObj,Aa=Oa.targetObj;Qa.isMorph&&Aa.isMorph?(Qa.show(),
Aa.show(),td.showConnector&&td.showConnector(Qa,Aa)):td.show(String(Oa))}function xc(Oa){var Qa=Oa.sourceObj,Aa=Oa.sourceAttrName,za=Oa.targetObj,Ka=Oa.targetMethodName,tb=Oa.getConverter();Oa=Oa.getUpdater();return td.printConnectionElements(Qa,Aa,za,Ka,tb,Oa)}function kc(Oa,Qa,Aa,za,Ka,tb){Oa="/* global connect, source, target */\nconnect(source, '"+Qa+"', target, '"+za+"'";if(Ka||tb)Oa+=", {\n";Ka&&(Oa+="  converter: "+Ka);Ka&&tb&&(Oa+=",");Ka&&(Oa+="\n");tb&&(Oa+="  updater: "+tb+"\n");if(Ka||
tb)Oa+="}";return Oa+");"}function Q(Oa,Qa){var Aa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(za){if(1==za.nextAddress)return za.yield(td.InteractiveMorphSelector.selectMorph(),2);Aa=za.yieldResult;return za.return(Aa?td.interactiveConnectGivenSourceAndTarget(Oa,Qa,Aa):null)})}function ea(Oa,Qa,Aa,za){var Ka,tb,yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zc){Ka=Aa&&Aa.world().targetDataBindings(Aa);tb=Oa.world();if(!Ka||!Ka.length)return tb.setStatusMessage("connect canceled"),
zc.return();yb=Ka.map(function(pd){return[pd[0].group||"uncategorized",pd.map(function(Yd){return[Yd.signature||Yd.name,function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ge){return 1==Ge.nextAddress?Ge.yield(td.interactivelyEvaluateConnection({sourceObj:Oa,sourceAttr:Qa,targetObj:Aa,targetAttr:Yd.name,onConnect:za}),2):Ge.return(Ge.yieldResult)})}]})]});yb.push(["custom...",function(){var pd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){return 1==Yd.nextAddress?
Yd.yield(tb.prompt("Enter custom connection point",{requester:$world,historyId:"lively.morphic-custom-connection-points",useLastInput:!0}),2):(pd=Yd.yieldResult)?Yd.yield(td.interactivelyEvaluateConnection({sourceObj:Oa,sourceAttr:Qa,targetObj:Aa,targetAttr:pd,onConnect:za}),0):Yd.jumpTo(0)})}]);return zc.yield(Aa.openMenu(yb).whenFinished(),0)})}function Ga(Oa,Qa,Aa,za){Qa=void 0===Qa?"confirm connection":Qa;var Ka,tb,yb,zc,pd,Yd,Ge;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){Ka=
Oa;tb=Ka.sourceObj;yb=Ka.sourceAttrName;zc=Ka.targetObj;pd=Ka.targetMethodName;Yd=Oa.getConverter();Ge=Oa.getUpdater();return Sc.return(td.interactivelyEvaluateConnection({sourceObj:tb,sourceAttr:yb,targetObj:zc,targetAttr:pd,converter:Yd,updater:Ge,prompt:Qa,highlight:Aa,onConnect:za}))})}function Ua(Oa,Qa,Aa,za,Ka){za=void 0===za?{}:za;Ka=td.rect(0).sides.concat(td.rect(0).corners);Aa=Aa||new td.Leash(Object.assign({isSmooth:!0,styleClasses:["Halo"],borderColor:td.Color.orange,epiMorph:!0,endpointStyle:{start:{fill:td.Color.transparent,
nativeCursor:"auto"},end:{fill:td.Color.orange}}},za,{hasFixedPosition:!0}));Aa.startPoint.attachTo(Oa,"rightCenter");Qa.isMorph?(za=Qa.globalBounds().partNameNearest(Ka,Oa.globalPosition),Oa.globalPosition.equals(Qa.globalBounds().partNamed(za))&&Qa.globalBounds().partNameNearest(td.arr.without(Ka,za),Oa.globalPosition),Aa.endPoint.attachTo(Qa,"leftCenter")):(Ka=Oa.globalBounds().topRight().addPt(td.pt(100,0)),Qa=td.morph({type:"label",value:Qa.toString(),styleClasses:["Tooltip"],padding:td.rect(8,
4)}).openInWorld(Ka),Qa.position=Oa.world().bounds().translateForInclusion(Qa.bounds()).topLeft(),td.once(Aa,"remove",Qa,"remove"),Aa.endPoint.attachTo(Qa,"leftCenter"));return Aa}function fc(Oa){var Qa,Aa,za,Ka,tb,yb,zc,pd,Yd,Ge,Sc,ye,Gd,Sb,oa,Ha,Kb,P,sa,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ib){switch(Ib.nextAddress){case 1:Qa=Oa;Aa=Qa.sourceObj;za=Qa.sourceAttr;Ka=Qa.targetObj;tb=Qa.targetAttr;yb=Qa.converter;zc=Qa.updater;pd=Qa.prompt;Yd=void 0===Qa.highlight?!0:Qa.highlight;
Ge=Qa.onConnect;Sc="lively://lively.bindings-interactive-connect/x"+Aa.id;ye={context:window,format:"esm",targetModule:Sc,classTransform:td.classToFunctionTransform};Gd=td.printConnectionElements(Aa,za,Ka,tb,yb,zc);Ka.isMorph&&Aa.isMorph&&(Sb=Ka.propertiesAndPropertySettings().properties[tb]||{type:typeof Ka[tb]},oa=Sb.type,Ha=Aa.propertiesAndPropertySettings().properties[za]||{type:typeof Aa[za]},Kb=Ha.type,Kb!==oa&&(pd=!0));P={};Object.assign(lively.modules.module(Sc).recorder,(P.source=Aa,P.target=
Ka,P.connect=id,P.once=ce,P[za]=Aa[za],P));if(!pd){sa=Gd;Ib.jumpTo(2);break}return Ib.yield($world.editPrompt(pd,{input:Gd,historyId:"lively.bindings-interactive-morph-connect",mode:"js",requester:$world,evalEnvironment:ye,animated:!1}),3);case 3:if(sa=Ib.yieldResult,!sa)return $world.setStatusMessage("connect canceled"),Ib.return();case 2:return Ib.yield(lively.vm.runEval(sa,ye),4);case 4:Ta=Ib.yieldResult;if(Ta.isError)return $world.logError(Ta.value),Ib.return(fc({sourceObj:Aa,sourceAttr:za,targetObj:Ka,
targetAttr:tb,converter:yb,updater:zc,prompt:"confirm connection",highlight:Yd,onConnect:Ge}));Yd&&($world.setStatusMessage("connected!",td.Color.green),td.interactivelyShowConnection(Ta.value));"function"===typeof Ge&&Ge(Ta);Ib.jumpToEnd()}})}var Fb=lively.FreezerRuntime.recorderFor("ProtoInspector/index.js");Fb.Inspector=jc;var Va=function(Oa){var Qa=lively.FreezerRuntime.recorderFor("ProtoInspector/index.js"),Aa=Qa.hasOwnProperty("ProtoInspector")&&"function"===typeof Qa.ProtoInspector?Qa.ProtoInspector:
Qa.ProtoInspector=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ca(Aa,Oa,void 0,[{key:"className",get:function(){return"ProtoInspector"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],Qa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoInspector",
version:"0.1.1-0"}}},{start:68,end:210})}(Fb.Inspector);Va=Fb.ProtoInspector;Fb.default=Va;var Ab=lively.FreezerRuntime.recorderFor("MorphicSideBar/index.js");Ab.Morph=ub;Ab.touchInputDevice=Tb;Ab.easings=lc;Ab.pt=mc;Ab.fun=Zd;Ab.connect=id;Fb=function(Oa){var Qa=lively.FreezerRuntime.recorderFor("MorphicSideBar/index.js"),Aa=Qa.hasOwnProperty("MorphicSideBar")&&"function"===typeof Qa.MorphicSideBar?Qa.MorphicSideBar:Qa.MorphicSideBar=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ca(Aa,Oa,[{key:"onWorldResize",value:function(za){za=void 0===za?!0:za;if(this.respondsToVisibleWindow){var Ka=$world.visibleBounds(),tb=navigator.standalone&&Ab.touchInputDevice?25:0;this.height=Ka.height-tb;this.top=tb+Ka.top();tb=this.get("horizontal resizer");tb.height=this.height;tb.top=0;za&&(this.visible?this.topLeft=Ka.topLeft():this.topRight=Ka.topLeft())}}},{key:"switchMode",value:function(za){"inspector"==za&&this.showInspector();"connections"==za&&this.showConnections()}},
{key:"showInspector",value:function(){this.get("inspector").visible=!0;this.get("connections tree").visible=!1}},{key:"showConnections",value:function(){this.get("inspector").visible=!1;this.get("connections tree").visible=!0}},{key:"toggle",value:function(za){var Ka=this,tb,yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zc){switch(zc.nextAddress){case 1:tb=$world.visibleBounds();yb=navigator.standalone&&Ab.touchInputDevice?25:0;Ka.height=tb.height-yb;Ka.top=yb+tb.top();if(za)return $world.addMorph(Ka,
$world.get("lively top bar")),Ka.right=0,Ka.attachToWorld($world),Ka.visible=!0,zc.yield(Ka.whenRendered(),5);Ka.detachFromWorld($world);return zc.yield(Ka.animate({opacity:0,right:0,duration:300}),4);case 4:Ka.visible=!1;Ka.remove();zc.jumpTo(0);break;case 5:return Ka.onWorldResize(!1),Ka.get("scene graph").adjustProportions(),zc.yield(Ka.animate({opacity:1,easing:Ab.easings.outCirc,left:1,duration:300}),6);case 6:Ka.get("scene graph").refresh(),zc.jumpToEnd()}})}},{key:"attachToWorld",value:function(za){Ab.connect(za,
"onChange",this,"onHierarchyChange",{garbageCollect:!0});Ab.connect(za,"onSubmorphChange",this,"onHierarchyChange",{garbageCollect:!0});Ab.connect(za,"showHaloFor",this,"selectNode",{garbageCollect:!0})}},{key:"detachFromWorld",value:function(za){var Ka=this;za.attributeConnections.forEach(function(tb){tb.targetObj===Ka&&tb.disconnect()})}},{key:"selectNode",value:function(za){this.getSubmorphNamed("scene graph").selectMorphInTarget(za);this.getSubmorphNamed("connections tree").inspectConnectionsOf(za)}},
{key:"onHierarchyChange",value:function(za){var Ka=this,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if("addMorphAt"===za.selector||"removeMorph"===za.selector||"name"===za.prop){tb=Ka._sceneGraph||(Ka._sceneGraph=Ka.getSubmorphNamed("scene graph"));if(!tb||!tb.owner.visible||za.target&&za.target.isHand||za.target&&tb.ignoreMorph(za.target)||za.args&&!za.args[0].isHalo&&tb.ignoreMorph(za.args[0])||za.target.ownerChain().find(function(zc){return tb.ignoreMorph(zc)}))return yb.return();
Ab.fun.debounceNamed("scene-graph-update",50,function(){return tb.refresh()})()}yb.jumpToEnd()})}}],[{key:"className",get:function(){return"MorphicSideBar"}},{key:"properties",get:function(){return{isHaloItem:{get:function(){return!1}}}}}],Qa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"MorphicSideBar",version:"0.1.1-69"}}},{start:226,
end:3566})}(Ab.Morph);Fb=Ab.MorphicSideBar;Ab.default=Fb;var td=lively.FreezerRuntime.recorderFor("lively.ide/fabrik.js");td.interactivelyShowConnection=Bc;td.printConnection=xc;td.printConnectionElements=kc;td.interactiveConnectGivenSource=Q;td.interactiveConnectGivenSourceAndTarget=ea;td.interactivelyReEvaluateConnection=Ga;td.visualizeConnection=Ua;td.interactivelyEvaluateConnection=fc;td.connect=id;td.once=ce;td.Color=kd;td.rect=$c;td.pt=mc;td.arr=Cd;td.promise=Fd;td.properties=pe;td.Path=Xd;
td.obj=nd;td.HorizontalLayout=eb;td.Morph=ub;td.VerticalLayout=Hb;td.StyleSheet=Cc;td.Icon=qc;td.GridLayout=ld;td.morph=wd;td.TreeData=Xc;td.Tree=gd;td.Leash=bc;td.LabeledCheckBox=ad;td.SearchField=ed;td.showConnector=qb;td.show=rb;td.InteractiveMorphSelector=cc;td.MorphHighlighter=Vc;td.Window=Id;td.classToFunctionTransform=hc;td.interactivelyShowConnection=Bc;td.interactivelyShowConnection=Bc;td.printConnection=xc;td.printConnection=xc;td.printConnectionElements=kc;td.printConnectionElements=kc;
td.interactiveConnectGivenSource=Q;td.interactiveConnectGivenSource=Q;td.interactiveConnectGivenSourceAndTarget=ea;td.interactiveConnectGivenSourceAndTarget=ea;td.interactivelyReEvaluateConnection=Ga;td.interactivelyReEvaluateConnection=Ga;td.visualizeConnection=Ua;td.visualizeConnection=Ua;td.interactivelyEvaluateConnection=fc;td.interactivelyEvaluateConnection=fc;var Pc=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js");Pc.Tree=gd;Pc.TreeData=Xc;Pc.morph=wd;Pc.Icon=qc;Pc.HorizontalLayout=
eb;Pc.easings=lc;Pc.Morph=ub;Pc.Color=kd;Pc.Rectangle=Qb;Pc.rect=$c;Pc.pt=mc;Pc.connect=id;Pc.disconnect=xb;Pc.disconnectAll=Nb;Pc.once=ce;Pc.arr=Cd;Pc.num=kb;Pc.fun=Zd;Pc.tree=Db;Pc.promise=Fd;Pc.ConnectionHalo=_missingExportShim;Fb=function(Oa){var Qa=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Aa=Qa.hasOwnProperty("InteractiveTreeContainer")&&"function"===typeof Qa.InteractiveTreeContainer?Qa.InteractiveTreeContainer:Qa.InteractiveTreeContainer=function(za){za&&za[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ca(Aa,Oa,[{key:"onChildRemoved",value:function(za){}},{key:"onChildAdded",value:function(za){}},{key:"toggleSelected",value:function(za){if(this.tree){var Ka=this.tree,tb=Ka.selectionFontColor,yb=Ka.nonSelectionFontColor;this.submorphs.filter(function(zc){return!zc._isControlElement&&zc.styleClasses.includes("Label")}).forEach(function(zc){zc.fontColor=za?tb:yb})}}},{key:"onGrab",value:function(za){var Ka=this.tree,tb=this.node;
this.fill=Pc.Color.gray.withA(.5);this.fontColor=Ka.selectionFontColor;this.opacity=.8;Ca._get(Object.getPrototypeOf(Aa.prototype),"onGrab",this).call(this,za);tb&&(this.toggleSelected(!1),Ka.collapse(tb),Ka.treeData.parentNode(tb).container.onChildRemoved(this),this._data=Ka.treeData.remove(tb),tb.container.target.remove(),Ka.update(!0))}},{key:"wantsToBeDroppedOn",value:function(za){this.showPreviewOn(za);return!0}},{key:"showPreviewOn",value:function(za){if(za.isContainer)var Ka=za.tree;za.isTree&&
(Ka=za);Ka&&Ka.showDropPreviewFor&&Ka.showDropPreviewFor(this)}},{key:"insertAsChild",value:function(za){var Ka=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress)return Ka.tree.treeData.add(za._data,Ka.node,Ka.node.children[0]),Ka.tree.uncollapse(Ka.node),Ka.tree.treeData.remove(Ka.tree._previewNode),tb.yield(Ka.tree.whenRendered(),2);Ka.tree.update(!0);Ka.onChildAdded(za);tb.jumpToEnd()})}},{key:"onBeingDroppedOn",value:function(za,Ka){var tb=this;debugger;
this.tree._dropInProgress=!0;Ca._get(Object.getPrototypeOf(Aa.prototype),"onBeingDroppedOn",this).call(this,za,Ka);za=function(){tb.fill=Pc.Color.gray.withA(.5);tb.opacity=1;tb.tree._dropInProgress=!1;tb.tree.refresh()};Ka.isTree?Ka.insertAtPlaceholder(this).then(za):Ka.isContainer?Ka.insertAsChild(this).then(za):za()}}],[{key:"className",get:function(){return"InteractiveTreeContainer"}},{key:"properties",get:function(){return{fill:{defaultValue:Pc.Color.transparent},isContainer:{get:function(){return!0}},
tree:{},node:{readOnly:!0,get:function(){var za=this,Ka=this.tree.treeData;return Ka&&Ka.asList().find(function(tb){return tb.container===za})}}}}}],Qa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1102"}}},{start:437,end:2917})}(Pc.Morph);Pc.InteractiveTreeContainer=Fb;Pc.InteractiveTreeContainer=
Fb;Pc.InteractiveTreeContainer=Fb;Fb=function(Oa){var Qa=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Aa=Qa.hasOwnProperty("InteractiveTreeData")&&"function"===typeof Qa.InteractiveTreeData?Qa.InteractiveTreeData:Qa.InteractiveTreeData=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ca(Aa,Oa,[{key:"display",value:function(za){return[za.container||"<NO CONTAINER>",{}]}},{key:"isCollapsed",value:function(za){return za.isCollapsed}},
{key:"collapse",value:function(za,Ka){za.isCollapsed=Ka}},{key:"getChildren",value:function(za){var Ka=this;return za.isLeaf?null:za.children.filter(function(tb){return tb&&(Ka.filterActive?tb.visible:!0)})}},{key:"isLeaf",value:function(za){var Ka=this;return!za.children||0==za.children.filter(function(tb){return tb&&(Ka.filterActive?tb.visible:!0)}).length}},{key:"add",value:function(za,Ka,tb){Ka=void 0===Ka?this.root:Ka;Ka.children||(Ka.children=[]);tb?Pc.arr.pushAt(Ka.children,za,Ka.children.indexOf(tb)):
Ka.children.push(za);Ka.isLeaf=!1}},{key:"replace",value:function(za,Ka){var tb=this.parentNode(za);za=tb.children.indexOf(za);tb.children[za]=Ka}},{key:"next",value:function(za){var Ka=this.parentNode(za);return Ka&&Ka.children[Ka.children.indexOf(za)+1]}},{key:"isBefore",value:function(za,Ka){this.next(za)===Ka}},{key:"isAfter",value:function(za,Ka){this.next(Ka)===za}},{key:"addBefore",value:function(za,Ka){this.add(za,this.parentNode(Ka),Ka)}},{key:"addAfter",value:function(za,Ka){var tb=this.parentNode(Ka);
Ka=tb.children.indexOf(Ka)+1;this.add(za,tb,tb.children[Ka])}},{key:"remove",value:function(za){var Ka=this.parentNode(za);if(Ka)return Pc.arr.remove(Ka.children,za),Ka.children==[]&&(Ka.children=null),za}},{key:"filter",value:function(za,Ka){Ka=void 0===Ka?1:Ka;var tb=this,yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zc){if(1==zc.nextAddress)return zc.yield(tb.uncollapseAll(function(pd,Yd){return Yd<Ka+1}),2);yb=tb.filterActive;tb.filterActive=!1;tb.asListWithIndexAndDepth(!1).reverse().forEach(function(pd){var Yd=
pd.node;if(0==pd.depth)return Yd.visible=!0;Yd.visible=za(Yd);Yd.visible||Yd.isCollapsed||!Yd.children.find(function(Ge){return Ge.visible})?Yd.container.opacity=1:(Yd.visible=!0,Yd.container.opacity=.5);return Yd.visible});tb.filterActive=yb;zc.jumpToEnd()})}}],[{key:"className",get:function(){return"InteractiveTreeData"}}],Qa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"InteractiveTree",version:"0.1.1-1102"}}},{start:2926,end:5365})}(Pc.TreeData);Pc.InteractiveTreeData=Fb;Pc.InteractiveTreeData=Fb;Pc.InteractiveTreeData=Fb;Fb=function(Oa){var Qa=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Aa=Qa.hasOwnProperty("InteractiveTree")&&"function"===typeof Qa.InteractiveTree?Qa.InteractiveTree:Qa.InteractiveTree=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ca(Aa,Oa,[{key:"update",value:function(za){var Ka=this;Ca._get(Object.getPrototypeOf(Aa.prototype),"update",this).call(this,za);this.treeData&&this.relayoutContainers();za&&this.embeddedMorphs.forEach(function(tb){tb.isContainer&&(tb.fill=Pc.Color.transparent,tb.fontFamily=Ka.fontFamily,tb.fontSize=Ka.fontSize)})}},{key:"onDrop",value:function(za){Ca._get(Object.getPrototypeOf(Aa.prototype),"onDrop",this).call(this,za);this.treeData.remove(this._previewNode);this.update(!0)}},{key:"onDropHoverIn",
value:function(za){}},{key:"onDropHoverUpdate",value:function(za){}},{key:"onDropHoverOut",value:function(za){}},{key:"onHoverOut",value:function(za){var Ka=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){Ca._get(Object.getPrototypeOf(Aa.prototype),"onHoverOut",Ka).call(Ka,za);Ka._previewNode&&Ka._previewNode.container.world()&&Ka.treeData.remove(Ka._previewNode);Ka.resetContainerSelection();Ka.update(!0);tb.jumpToEnd()})}},{key:"insertAtPlaceholder",value:function(za){var Ka=
this,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress)return tb=Ka.treeData.parentNode(Ka._previewNode),Ka.treeData.replace(Ka._previewNode,za._data),Ka.treeData.remove(Ka._previewNode),yb.yield(Ka.whenRendered(),2);Ka.update(!0);tb.container.onChildAdded(za);yb.jumpToEnd()})}},{key:"scrollUpSlowly",value:function(){var za=this;if(!this._scrollingUp){this._scrollingUp=!0;var Ka=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==
tb.nextAddress)return za._scrollingUp&&0<za.scroll.y?tb.yield(za.animate({scroll:za.scroll.subXY(0,30),duration:300,easing:Pc.easings.linear}),3):(za._scrollingUp=!1,tb.jumpTo(0));Ka();tb.jumpToEnd()})};Ka()}}},{key:"scrollDownSlowly",value:function(){var za=this;if(!this._scrollingDown){this._scrollingDown=!0;var Ka=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress)return za._scrollingDown&&za.scroll.y<za.scrollExtent.y-za.height?tb.yield(za.animate({scroll:za.scroll.addXY(0,
30),duration:300,easing:Pc.easings.linear}),3):(za._scrollingDown=!1,tb.jumpTo(0));Ka();tb.jumpToEnd()})};Ka()}}},{key:"stopScrollingSlowly",value:function(){this._scrollingUp=this._scrollingDown=!1}},{key:"resetContainerSelection",value:function(){this.embeddedMorphs.forEach(function(za){za.isContainer&&(za.fill=Pc.Color.transparent)})}},{key:"showDropPreviewFor",value:function(za){var Ka=this;za=this.localize(za.globalBounds().center());var tb=this.textPositionFromPoint(za),yb=this.treeData.asListWithIndexAndDepth(function(ye){ye=
ye.node;return ye!=Ka._previewNode&&ye.container.world()}),zc=(yb.find(function(ye){return ye.i-1===tb.row})||{}).node,pd=zc&&zc.container,Yd=this.ensurePlaceholder(),Ge=!!Yd.container.world(),Sc=za.subPt(this.scroll).subPt(this.scrollbarOffset);10>Sc.y?this.scrollUpSlowly():Sc.y>this.height-50?this.scrollDownSlowly():this.stopScrollingSlowly();this.resetContainerSelection();if(!pd){if(yb.length>tb.row||Pc.arr.last(this.treeData.root.children)===Yd)return;this.treeData.remove(Yd);this.treeData.add(Yd);
this.update(!0)}if(pd){yb=this.textLayout.boundsFor(this,tb);if(4>Math.abs(yb.top()-za.y)){if(this.treeData.isBefore(Yd,zc))return;this.treeData.remove(Yd);this.treeData.addBefore(Yd,zc)}else if(4>Math.abs(yb.bottom()-za.y)&&(zc.isCollapsed||this.treeData.isLeaf(zc))){if(this.treeData.isAfter(Yd,zc))return;this.treeData.remove(Yd);this.treeData.addAfter(Yd,zc)}else{pd.fill=Pc.Color.gray;if(!Ge)return;this.treeData.remove(Yd)}this.update(!0)}}},{key:"ensurePlaceholder",value:function(){var za=Pc.pt(this.width-
100,this.document.getLine(0).height);this._previewNode||(this._previewNode={container:Pc.morph({acceptsDrops:!1,reactsToPointer:!1,fill:Pc.Color.gray,borderRadius:5}),isCollapsed:!0,isLeaf:!0});this._previewNode.container.extent=za;return this._previewNode}},{key:"relayoutContainers",value:function(){var za=this;this.charBoundsFromTextPosition({row:0,column:6});this.textLayout.charBoundsOfRow(this,0).map(function(Ka){return Ka.height});this.treeData.asListWithIndexAndDepth().forEach(function(Ka){var tb=
Ka.node;Ka=Ka.i;tb.container.nativeCursor="grab";tb.container.width=za.width-25-tb.container.left;tb.container.toggleSelected&&tb.container.toggleSelected(Ka==za.selectedIndex)});this.anchors.forEach(function(Ka){return Ka.position=Ka.position})}}],[{key:"className",get:function(){return"InteractiveTree"}}],Qa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",
version:"0.1.1-1102"}}},{start:5374,end:10711})}(Pc.Tree);Pc.InteractiveTree=Fb;Pc.InteractiveTree=Fb;Pc.InteractiveTree=Fb;Fb=function(Oa){var Qa=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Aa=Qa.hasOwnProperty("SceneGraphTree")&&"function"===typeof Qa.SceneGraphTree?Qa.SceneGraphTree:Qa.SceneGraphTree=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ca(Aa,Oa,[{key:"beforePublish",value:function(){this.submorphs=
[];this.reset()}},{key:"selectMorphInTarget",value:function(za){var Ka=this.treeData.asList().find(function(tb){return tb.container.target===za});Ka&&this.selectedNode!=Ka&&this.selectPath(this.treeData.pathOf(Ka))}},{key:"onLoad",value:function(){var za=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){if(1==Ka.nextAddress)return za.submorphs=[],Ka.yield(za.whenRendered(),2);za.get("inspector").makeEditorVisible(!0);za.get("inspector").makeEditorVisible(!1);za.setTarget($world);
Ka.jumpToEnd()})}},{key:"adjustProportions",value:function(za){za=(za?za.state.dragDelta:{y:0}).y;var Ka=this.get("inspector"),tb=this.get("scene graph resizer"),yb=this.get("mode selector"),zc=this.get("connections tree");this.height+=za;Ka.height-=za;zc.height-=za;tb.top=this.bottom;tb.left=0;yb.top=tb.bottom;zc.top=Ka.top=yb.bottom+5}},{key:"reset",value:function(){var za=this;this.treeData=new Pc.InteractiveTreeData({children:[],container:Pc.morph()});this.get("inspector").targetObject={};this.selectedNode=
null;this.anchors.filter(function(Ka){return null==Ka.id}).forEach(function(Ka){return za.removeAnchor(Ka)})}},{key:"setTarget",value:function(za){this.target=za;this.treeData=this.getTreeFromSubmorphHierarchy(za);this.uncollapse(this.treeData.root)}},{key:"isNodeOutOfSync",value:function(za){var Ka=this;if(za===this._previewNode)return!1;if(za.container.nameNeedsUpdate)return!0;var tb=za.container.target.submorphs.filter(function(yb){return!Ka.ignoreMorph(yb)});return tb.length!=za.children.length||
tb.map(function(yb){return yb.name}).join("")!=za.children.map(function(yb){return yb.target?yb.target.name:""}).join("")?!0:!1}},{key:"getNewChildren",value:function(za){var Ka=this,tb=za.container.target.submorphs.map(function(Ge){return Ge.__scene_graph_target__?Ge.__scene_graph_target__():Ge}).filter(function(Ge){return!Ka.ignoreMorph(Ge)}),yb=[],zc={},pd;for(pd in tb){zc.$jscomp$loop$prop$m$2288=tb[pd];var Yd=Pc.arr.without(za.children,this._previewNode).find(function(Ge){return function(Sc){return Sc.container.target.id==
Ge.$jscomp$loop$prop$m$2288.id}}(zc));yb[pd]=Yd?Yd:this.readMorphHierarchy(zc.$jscomp$loop$prop$m$2288);zc={$jscomp$loop$prop$m$2288:zc.$jscomp$loop$prop$m$2288}}return yb}},{key:"refresh",value:function(){var za=this;if(!this._updating&&!this._dropInProgress){var Ka=!1;Pc.tree.prewalk(this.treeData.root,function(tb){za.isNodeOutOfSync(tb)&&(Ka=!0,tb.name=tb.container.target.name,tb.container.refresh(),tb.children=za.getNewChildren(tb))},function(tb){return tb.children});this.update(Ka)}}},{key:"ignoreMorph",
value:function(za){return za.isMorph?za.isContainer||za.isWindow||za.getWindow()||za.isEpiMorph||za.isHand||["lively.halos"].includes(za.constructor[Symbol.for("lively-module-meta")].package.name)||["MorphicSideBar","SideBarToggler","UserFlap","Menu"].includes(za.constructor.name):!1}},{key:"onDropHoverOut",value:function(za){var Ka=za.hand.grabbedMorphs[0];za=za.hand.findDropTarget();if(!(za===this||za&&za.ownerChain().includes(this))&&Ka&&Ka.isContainer)Ka.onDragOutside()}},{key:"onDropHoverIn",
value:function(za){var Ka=za.hand.grabbedMorphs[0];Ka&&!Ka.isContainer&&($world.halos().forEach(function(tb){return tb.remove()}),Ka.remove(),Object.assign(Ka,za.hand._grabbedMorphProperties.get(Ka).pointerAndShadow),Ka=this.renderContainerFor(Ka,!1),za.hand.grab(Ka),Ka.leftCenter=Pc.pt(-20,0))}},{key:"getTreeFromSubmorphHierarchy",value:function(za){return new Pc.InteractiveTreeData(this.readMorphHierarchy(za))}},{key:"readMorphHierarchy",value:function(za){var Ka=this;return Pc.tree.mapTree(za,
function(tb,yb){return{name:tb.name,isCollapsed:!0,container:Ka.renderContainerFor(tb),visible:!0,children:yb}},function(tb){return tb.submorphs.filter(function(yb){return tb.isWorld?!Ka.ignoreMorph(yb):!0})})}},{key:"renderContainerFor",value:function(za,Ka){za=void 0===za?Pc.morph({name:"root"}):za;Ka=new Pc.MorphContainer({tree:this,fill:void 0===Ka||Ka?Pc.Color.transparent:Pc.Color.gray.withA(.5),fontColor:this.nonSelectionFontColor,fontFamily:this.fontFamily,target:za,opacity:za.visible?1:.5});
za._data?(Ka._data=za._data,za._data.container=Ka):Ka._data={name:za.name,isCollapsed:!0,container:Ka,children:[]};return Ka}},{key:"collapseAll",value:function(){var za=this;this.treeData.asList().forEach(function(Ka){return Ka!=za.treeData.root?Ka.isCollapsed=!0:Ka.isCollapsed=!1})}},{key:"filterMorphs",value:function(za){var Ka=this,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress)return tb=za.tokens[0],Ka.treeData.filterActive||(Ka._collapseState=new WeakMap(Ka.treeData.asList().map(function(zc){return[zc,
zc.isCollapsed]}))),Ka.treeData.filterActive=!!tb,yb.yield(Ka.treeData.filter(function(zc){var pd=!tb||zc.container.target.name.includes(tb);zc.container.highlightTerm(tb);return pd},3),2);Ka.treeData.filterActive||Ka.treeData.asList().forEach(function(zc){return zc.isCollapsed=Ka._collapseState.has(zc)?Ka._collapseState.get(zc):!0});Ka.refresh();yb.jumpToEnd()})}}],[{key:"className",get:function(){return"SceneGraphTree"}},{key:"properties",get:function(){return{target:{serialize:!1}}}}],Qa,{pathInPackage:function(){return"index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1102"}}},{start:10720,end:17193})}(Pc.InteractiveTree);Pc.SceneGraphTree=Fb;Pc.SceneGraphTree=Fb;Pc.SceneGraphTree=Fb;Fb=function(Oa){var Qa=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),Aa=Qa.hasOwnProperty("MorphContainer")&&"function"===typeof Qa.MorphContainer?Qa.MorphContainer:
Qa.MorphContainer=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ca(Aa,Oa,[{key:"refresh",value:function(){var za=this,Ka,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){Ka=za.target;if(!Ka)return yb.return();za.reactsToPointer=!0;za.dropShadow=!1;za.submorphs=[za.getLabel(),Ka.layout&&za.getLayoutControls(),za.getConnectionControls()].filter(Boolean).map(function(zc,pd){zc.fitIfNeeded();
zc.left=tb?tb.right+5:0;zc.top=2;return tb=zc});za.height=20;za.opacity=Ka.visible?1:.5;yb.jumpToEnd()})}},{key:"getLabel",value:function(){var za=this.getSubmorphNamed("name label")||Pc.morph({type:"label",name:"name label",reactsToPointer:!1,padding:Pc.rect(0,0,0,0),acceptsDrops:!1,fontSize:this.tree.fontSize}),Ka=za.textString.slice(2,-1);Ka&&Ka==this.target.name||(za.value=[].concat($jscomp.arrayFromIterable(this.getIcon(this.target)),[" "+this.target.name+" "]));return za}},{key:"getIcon",value:function(za){return Pc.Icon.textAttribute({Morph:"square",
Ellipse:"circle",Text:"font",Label:"tag",Polygon:"draw-polygon",Path:"bezier-curve",Image:"image",Canvas:"chess-board",HTMLMorph:"code"}[za.constructor.className]||"codepen",{paddingTop:"4px",fontSize:this.tree.fontSize-2,opacity:.6})}},{key:"getLayoutControls",value:function(){var za=this.getSubmorphNamed("layout label")||Pc.morph({type:"label",name:"layout label",borderRadius:3,acceptsDrops:!1,padding:Pc.Rectangle.inset(4,2,4,2),fill:Pc.Color.orange,fontColor:Pc.Color.white});za._isControlElement=
!0;za.textString!=this.target.layout.name()&&(za.value=this.target.layout.name());return za}},{key:"onMouseDown",value:function(za){var Ka=this,tb,yb,zc,pd,Yd,Ge,Sc,ye,Gd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sb){if(1==Sb.nextAddress)return Ca._get(Object.getPrototypeOf(Aa.prototype),"onMouseDown",Ka).call(Ka,za),za.targetMorph!=Ka.get("connections label")?Sb.jumpTo(0):Sb.yield(Ka.whenRendered(),3);tb=$jscomp.makeIterator(Ka.world().halos());for(yb=tb.next();!yb.done;yb=tb.next())zc=
yb.value,zc.remove();pd=$jscomp.makeIterator(Ka.world().getSubmorphsByStyleClassName("ConnectionHalo"));for(yb=pd.next();!yb.done;yb=pd.next())Yd=yb.value,Yd.remove();Ka.owner.animate({opacity:.5,duration:300});Ge=new Pc.ConnectionHalo({target:Ka.target});Ge.openInWorld();Ge.topLeft=Ka.getSubmorphNamed("connections label").globalPosition.addXY(0,-2);Pc.connect(Ka,"position",function(){Ge.topLeft=Ka.getSubmorphNamed("connections label").globalPosition.addXY(0,-2)});Sc=Ka;ye=Ka.owner;Gd=Ka.get("side bar");
Pc.once(Ge,"remove",Ka,"toggleConnectionControl",{varMapping:{self:Sc,disconnectAll:Nb,disconnect:xb,connectionHalo:Ge,tree:ye,sideBar:Gd},updater:function(oa){Sc.connectionHalo=null;ye.animate({opacity:1,duration:300});Pc.disconnect(Gd,"toggle",Ge,"remove");Pc.disconnectAll(Sc);oa(!0)}});Pc.once(Ka,"remove",Ge,"remove");Pc.once(Ka.get("side bar"),"toggle",Ge,"remove");Ka.toggleConnectionControl(!1);Ka.connectionHalo=Ge;Sb.jumpToEnd()})}},{key:"getConnectionControls",value:function(){this.connectionCount=
this.target.attributeConnections?this.target.attributeConnections.filter(function(tb){return!tb.targetObj.isHalo}).length:0;var za=this.getSubmorphNamed("connections label")||Pc.morph({acceptsDrops:!1,borderRadius:3,type:"label",name:"connections label",padding:Pc.Rectangle.inset(4,2,4,2),nativeCursor:"pointer",fill:Pc.Color.red,fontColor:Pc.Color.white});za._isControlElement=!0;za.visible=!this.connectionHalo&&!!this.connectionCount;var Ka=this.connectionCount?this.connectionCount+" connection"+
(1<this.connectionCount?"s":""):"Manage Connections";za.textString!=Ka&&(za.value=Ka);return za}},{key:"highlightTerm",value:function(za){var Ka=this.submorphs[0],tb=Ka.textAndAttributes.slice(0,2),yb=Ka.textString.slice(1).split(za);Ka.textAndAttributes=1===yb.length?[].concat($jscomp.arrayFromIterable(tb),[yb[0]]):[].concat($jscomp.arrayFromIterable(tb),$jscomp.arrayFromIterable(Pc.arr.flatten(Pc.arr.interpose(yb.map(function(zc){return[zc,{}]}),[za,{fontWeight:"900"}]))))}},{key:"getClassControls",
value:function(){}},{key:"wantsToBeDroppedOn",value:function(za){var Ka=Ca._get(Object.getPrototypeOf(Aa.prototype),"wantsToBeDroppedOn",this).call(this,za);if(![za].concat($jscomp.arrayFromIterable(za.ownerChain())).includes(this.tree))this.onDragOutside();return Ka}},{key:"onGrab",value:function(za){var Ka=this,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress)return Ka.tree._dropInProgress=!0,tb=Ka.target.globalPosition,Ca._get(Object.getPrototypeOf(Aa.prototype),
"onGrab",Ka).call(Ka,za),Ka._data.globalTargetPosition=tb,yb.yield(Ka.whenRendered(),2);if(Ka.tree.fullContainsWorldPoint(Ka.globalPosition))Ka.leftCenter=Pc.pt(-20,0);else Ka.onDragOutside();Ka.tree._dropInProgress=!1;yb.jumpToEnd()})}},{key:"onDragOutside",value:function(){this._draggedOutside||(this._draggedOutside=!0,this.queue||(this.queue=Pc.fun.createQueue("container-hover-queue",function(za,Ka){var tb,yb,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pd){if(1==pd.nextAddress)return tb=
za.target,yb=tb.opacity,zc=tb.scale,za.target.opacity=0,za.target.scale=.5,$world.halos().forEach(function(Yd){return Yd.remove()}),$world.firstHand.grab(za.target),za.target._data=za._data,za.remove(),za.target.position=Pc.pt(0,0),pd.yield(za.target.animate({opacity:yb,scale:zc,duration:200}),2);Ka();pd.jumpToEnd()})})),this.queue.push(this))}},{key:"onChildAdded",value:function(za){var Ka=this.node.children.indexOf(za.node||za._data)+1;Ka=this.node.children[Ka];za.target.remove();Ka?(Ka=this.target.submorphs.indexOf(Ka.container.target),
this.target.addMorphAt(za.target,Ka)):this.target.addMorph(za.target);za._data.globalTargetPosition&&(za.target.position=this.target.localize(za._data.globalTargetPosition))}},{key:"onChildRemoved",value:function(za){}},{key:"toggleConnectionControl",value:function(za){this.getSubmorphNamed("connections label").visible=za}},{key:"toggleSelected",value:function(za){var Ka=this,tb,yb,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pd){if(1==pd.nextAddress)return Ca._get(Object.getPrototypeOf(Aa.prototype),
"toggleSelected",Ka).call(Ka,za),Ka._active===za?pd.return():(Ka._active=za)&&Ka.target&&Ka.target.isMorph&&Ka.world()?pd.yield(Ka.target.whenRendered(),3):pd.jumpTo(0);Ka.get("inspector").targetObject=Ka.target;if(Ka.connectionHalo)return pd.return();tb=$jscomp.makeIterator(Ka.world().halos());for(yb=tb.next();!yb.done;yb=tb.next()){zc=yb.value;if(zc.target===Ka.target)return pd.return();zc.remove()}Ka.world().showHaloFor(Ka.target);pd.jumpToEnd()})}}],[{key:"className",get:function(){return"MorphContainer"}},
{key:"properties",get:function(){return{fontFamily:{after:["submorphs"],derived:!0,set:function(za){this.submorphs[0].fontFamily=za}},fontColor:{after:["submorphs"],derived:!0,set:function(za){this.submorphs[0].fontColor=za}},fontSize:{derived:!0,set:function(za){this.submorphs[0].fontSize=za}},target:{serialize:!1},dragTriggerDistance:{defaultValue:15},borderRadius:{defaultValue:4},nameNeedsUpdate:{derived:!0,get:function(){return!this.target||this.submorphs[0].textString.slice(2,-1)==this.target.name&&
this.connectionCount==(this.target.attributeConnections||[]).length?!1:!0}},grabbable:{defaultValue:!0},draggable:{defaultValue:!0},submorphs:{after:["target","tree"],initialize:function(){this.refresh()}}}}}],Qa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1102"}}},{start:17202,end:25985})}(Pc.InteractiveTreeContainer);
Pc.MorphContainer=Fb;Pc.MorphContainer=Fb;Pc.MorphContainer=Fb;var Vb=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js");Vb.visualizeConnection=function(Oa,Qa,Aa,za,Ka){za=void 0===za?{}:za;Ka=Vb.rect(0).sides.concat(Vb.rect(0).corners);Aa=Aa||new Vb.Leash(Object.assign({isSmooth:!0,styleClasses:["Halo"],borderColor:Vb.Color.orange,epiMorph:!0,endpointStyle:{start:{fill:Vb.Color.transparent,nativeCursor:"auto"},end:{fill:Vb.Color.orange}}},za,{hasFixedPosition:!0}));Aa.startPoint.attachTo(Oa,
"rightCenter");Qa.isMorph?(za=Qa.globalBounds().partNameNearest(Ka,Oa.globalPosition),Oa.globalPosition.equals(Qa.globalBounds().partNamed(za))&&Qa.globalBounds().partNameNearest(Vb.arr.without(Ka,za),Oa.globalPosition),Aa.endPoint.attachTo(Qa,"leftCenter")):(Ka=Oa.globalBounds().topRight().addPt(Vb.pt(100,0)),Qa=Vb.morph({type:"label",value:Qa.toString(),styleClasses:["Tooltip"],padding:Vb.rect(8,4)}).openInWorld(Ka),Qa.position=Oa.world().bounds().translateForInclusion(Qa.bounds()).topLeft(),Vb.once(Aa,
"remove",Qa,"remove"),Aa.endPoint.attachTo(Qa,"leftCenter"));return Aa};Vb.startConnecting=function(Oa,Qa){Oa.animate({opacity:.8,duration:300});Oa.startPoint.attachTo(Qa,"center");Oa.vertices[0].position=Vb.pt(2,2)};Vb.stopConnecting=function(Oa,Qa,Aa,za){function Ka(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(pd){if(1==pd.nextAddress)return pd.yield(Oa.animate({opacity:0,duration:300}),2);Oa.startPoint.clearConnection();Oa.endPoint.clearConnection();Oa.remove();pd.jumpToEnd()})}
za=void 0===za?"sourceAttrName":za;var tb,yb,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pd){return 1==pd.nextAddress?(tb=Oa,yb=tb.endPoint,(zc=yb.connectedMorph)&&"MorphContainer"==zc.constructor.className&&(zc=zc.target),zc?pd.yield(Vb.interactiveConnectGivenSourceAndTarget(Aa,za,zc),2):pd.jumpTo(2)):pd.yield(Ka(),0)})};Vb.editConnection=function(Oa){var Qa=Oa.connection,Aa=Oa.connectionPoint,za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){if(1==Ka.nextAddress)return za=
Vb.visualizeConnection(Aa,Qa.targetObj,!1,{borderColor:Vb.Color.gray.darker(),endpointStyle:{start:{fill:Vb.Color.transparent,nativeCursor:"auto"},end:{fill:Vb.Color.gray.darker()}}}),Ka.yield(Vb.interactivelyReEvaluateConnection(Qa,"Edit Connection",!1),2);za.remove();Ka.jumpToEnd()})};Vb.Tree=gd;Vb.TreeData=Xc;Vb.Icon=qc;Vb.morph=wd;Vb.pt=mc;Vb.Rectangle=Qb;Vb.rect=$c;Vb.Color=kd;Vb.arr=Cd;Vb.connect=id;Vb.signal=Rb;Vb.Leash=bc;Vb.once=vc;Vb.interactivelyReEvaluateConnection=Ga;Vb.interactiveConnectGivenSource=
Q;Vb.interactiveConnectGivenSourceAndTarget=ea;(function(Oa){var Qa=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js"),Aa=Qa.hasOwnProperty("ConnectionsTreeData")&&"function"===typeof Qa.ConnectionsTreeData?Qa.ConnectionsTreeData:Qa.ConnectionsTreeData=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ca(Aa,Oa,[{key:"parseMorphConnections",value:function(za){for(var Ka={},tb=$jscomp.makeIterator(void 0===
za.attributeConnections?[]:za.attributeConnections),yb=tb.next();!yb.done;yb=tb.next())yb=yb.value,yb.targetObj.isHalo||(Ka[yb.sourceAttrName]=Ka[yb.sourceAttrName]||[{name:["      New Connection  ",{fontColor:Vb.Color.white.withA(.5),fontStyle:"italic"},this.renderPin(za,yb.sourceAttrName),{}]}],Vb.arr.pushAt(Ka[yb.sourceAttrName],{name:[].concat($jscomp.arrayFromIterable(this.renderExistingConnection(yb)))},0));return{children:Object.entries(Ka).map(function(zc){var pd=$jscomp.makeIterator(zc);
zc=pd.next().value;pd=pd.next().value;return{name:[zc,{fontWeight:"bold"}," ",{},Vb.morph({fill:Vb.Color.white,opacity:.7,value:""+(pd.length-1),borderRadius:15,fontWeight:"bold",padding:Vb.Rectangle.inset(5,0,5,0),type:"label"}),{paddingTop:"4px"}],children:pd}}).concat([{name:["New Connection  ",{fontColor:Vb.Color.white.withA(.5),fontStyle:"italic"},this.renderPin(za),{}]}])}}},{key:"renderExistingConnection",value:function(za){var Ka=this,tb=Vb.morph({type:"label",fontColor:Vb.Color.gray,fontSize:16,
nativeCursor:"pointer",value:[].concat($jscomp.arrayFromIterable(Vb.Icon.textAttribute("long-arrow-alt-right",{paddingTop:"4px"})),["  ",{},za.targetMethodName,{}])}),yb=this.renderDeadPin(),zc=yb.submorphs[0];Vb.connect(tb,"onHoverIn",function(){tb.fontColor=Vb.Color.orange;tb._leash=Vb.visualizeConnection(zc,za.targetObj,tb._leash);zc.fill=Vb.Color.orange;zc.border={color:Vb.Color.orange,width:3}});Vb.connect(tb,"onMouseDown",function(pd){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){if(1==
Yd.nextAddress)return pd.stop(),Yd.yield(Vb.interactivelyReEvaluateConnection(za),2);Vb.signal(Ka,"refresh");Yd.jumpToEnd()})});Vb.connect(tb,"onHoverOut",function(){tb.fontColor=Vb.Color.gray;zc.fill=Vb.Color.gray;zc.border={color:Vb.Color.white,width:1};tb._leash.remove();tb._leash=void 0});return[tb,{},"  ",{}].concat($jscomp.arrayFromIterable(Vb.Icon.textAttribute("times",{nativeCursor:"pointer ",onMouseDown:function(){za.disconnect();Vb.signal(Ka,"refresh")}})),["  ",{},yb,{}])}},{key:"renderDeadPin",
value:function(){var za=Vb.morph({type:"ellipse",fill:Vb.Color.gray,extent:Vb.pt(10,10),center:Vb.pt(8,12),borderWidth:1});return Vb.morph({extent:Vb.pt(20,20),fill:Vb.Color.transparent,reactsToPointer:!1,submorphs:[za]})}},{key:"renderPin",value:function(za,Ka){var tb=this,yb=Vb.morph({type:"ellipse",fill:Vb.Color.gray.withA(.5),extent:Vb.pt(10,10),center:Vb.pt(8,12),draggable:!1,borderWidth:1}),zc=new Vb.Leash({opacity:0,styleClasses:["Halo"],isSmooth:!0,epiMorph:!0,hasFixedPosition:!0,borderColor:Vb.Color.gray.darker(),
endpointStyle:{fill:Vb.Color.gray.darker()},position:Vb.pt(1,1),vertices:[Vb.pt(0,0),Vb.pt(0,0)],canConnectTo:function(pd){return"MorphContainer"==pd.constructor.className||2>Vb.arr.intersect([pd].concat($jscomp.arrayFromIterable(pd.ownerChain())),[yb].concat($jscomp.arrayFromIterable(yb.ownerChain()))).length}});yb.addMorph(zc);Vb.connect(zc.endPoint,"onDragStart",function(){Vb.startConnecting(zc,yb)});Vb.connect(zc.endPoint,"onDragEnd",function(pd){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){if(1==
Yd.nextAddress)return yb.center=Vb.pt(8,12),Yd.yield(Vb.stopConnecting(zc,yb,za,Ka),2);Vb.signal(tb,"refresh");Yd.jumpToEnd()})});return Vb.morph({extent:Vb.pt(20,20),fill:Vb.Color.transparent,reactsToPointer:!1,submorphs:[yb]})}},{key:"display",value:function(za){return za.name}},{key:"collapse",value:function(za,Ka){za.isCollapsed=Ka}},{key:"isCollapsed",value:function(za){return za.isCollapsed}},{key:"isLeaf",value:function(za){return!za.children}},{key:"getChildren",value:function(za){return za.children}}],
[{key:"className",get:function(){return"ConnectionsTreeData"}},{key:"for",value:function(za){var Ka=new this;Ka.root=Ka.parseMorphConnections(za);return Ka}}],Qa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ConnectionsTree",version:"0.1.1-16"}}},{start:3535,end:8087})})(Vb.TreeData);Fb=function(Oa){var Qa=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js"),
Aa=Qa.hasOwnProperty("ConnectionsTree")&&"function"===typeof Qa.ConnectionsTree?Qa.ConnectionsTree:Qa.ConnectionsTree=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ca(Aa,Oa,[{key:"inspectConnectionsOf",value:function(za){if(this.targetMorph=za)this.treeData=Vb.ConnectionsTreeData.for(za),Vb.connect(this.treeData,"refresh",this,"refresh")}},{key:"refresh",value:function(){this.targetMorph&&(this.treeData=Vb.ConnectionsTreeData.for(this.targetMorph),
Vb.connect(this.treeData,"refresh",this,"refresh"))}}],[{key:"className",get:function(){return"ConnectionsTree"}},{key:"properties",get:function(){return{}}}],Qa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ConnectionsTree",version:"0.1.1-16"}}},{start:8104,end:8657})}(Vb.Tree);Fb=Vb.ConnectionsTree;Vb.default=Fb}}});
System.register(["./__root_module__-aefa9179.js","./index-3100fe37.js","./index-dd2e460a.js"],function(Da){var Bb,Qb,hc,ac,be,bd,Sd,ed,Mc,pd,Dd,ke,Kd,jd,cb,Ab,Yb,gc,dd,Zd,Wb,oc,Lb,Bc,Sc,Yc,Xb,qb,uc,Hc,Ia,Va,tb,Jb,Ib,ib,jb,Fb,rc,Ic,ec,Pc,Q,ha,Ha;return{setters:[function(Pa){Bb=Pa.C;Qb=Pa.as;hc=Pa.a6;ac=Pa.a1;be=Pa.a3;bd=Pa.an;Sd=Pa.bh;ed=Pa.aV;Mc=Pa.aq;pd=Pa.s;Dd=Pa.aP;ke=Pa.bo;Kd=Pa.bp;jd=Pa.a7;cb=Pa.au;Ab=Pa.ap;Yb=Pa.ar;gc=Pa.bq;dd=Pa.br;Zd=Pa.a2;Wb=Pa.P;oc=Pa.$;Lb=Pa.aX;Bc=Pa.ai;Sc=Pa.aj;Yc=
Pa.ak;Xb=Pa.al;qb=Pa.aB;uc=Pa.a_;Hc=Pa.ax;Ia=Pa.ao;Va=Pa.aa;tb=Pa.bs;Jb=Pa.L;Ib=Pa.bt;ib=Pa.b3;jb=Pa.bi;Fb=Pa.b2;rc=Pa.bu;Ic=Pa.at},function(Pa){ec=Pa.M;Pc=Pa.I;Q=Pa.v;ha=Pa.p},function(Pa){Ha=Pa.localInterface}],execute:function(){function Pa(Ja,ab){if(!0===ab)return ab;if(Ja.copyState)return Ja.copyState(ab);Ja={};for(var Cb in ab){var ba=ab[Cb];ba instanceof Array&&(ba=ba.concat([]));Ja[Cb]=ba}return Ja}function bc(Ja,ab,Cb){return Ja.startState?Ja.startState(ab,Cb):!0}function ic(Ja,ab){return P.modes[Ja]=
ab}function Ra(Ja){if("string"==typeof Ja&&P.mimeModes.hasOwnProperty(Ja))Ja=P.mimeModes[Ja];else if(Ja&&"string"==typeof Ja.name&&P.mimeModes.hasOwnProperty(Ja.name)){var ab=P.mimeModes[Ja.name];"string"==typeof ab&&(ab={name:ab});Ja=Object.assign({},ab,Ja);Ja.name=ab.name}else{if("string"==typeof Ja&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ja))return Ra("application/xml");if("string"==typeof Ja&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ja))return Ra("application/json")}return"string"==typeof Ja?{name:Ja}:Ja||{name:"null"}}
function tc(Ja,ab){ab=P.resolveMode(ab);"string"===typeof ab&&(ab={name:ab});if(!ab.name)throw Error("parserConfig does not have a name of the mode to get");var Cb=P.modes[ab.name];if(!Cb)return tc(Ja,"text/plain");Ja=Object.assign({indentUnit:2},Ja);return Object.assign(Cb(Ja,ab),{name:ab.name})}function Qd(Ja,ab){for(var Cb;Ja.innerMode;){Cb=Ja.innerMode(ab);if(!Cb||Cb.mode==Ja)break;ab=Cb.state;Ja=Cb.mode}return Cb||{mode:Ja,state:ab}}function md(Ja,ab){P.mimeModes[Ja]=ab}function $c(Ja,ab,Cb){}
function Wa(Ja,ab,Cb,ba,Ka,nb,xb){var Dc=Ja.editorPlugin._tokenizerValidBefore;Dc&&Dc.row>=Cb&&(Dc.row=Cb-1);var Fc=P.linesToTokenize(Ja.document,Cb,ba,Dc);Dc=Fc.lines;Fc=Fc.state;if(!Dc.length)return!1;Fc=Fc?P.copyState(ab,Fc):P.startState(ab);for(var ud=0;ud<Dc.length;ud++){var td=Dc[ud],rd=td.row;rd>=Cb&&rd<=ba&&P.indentLine(Ja,ab,td,Fc,Ka,nb,xb);Fc=P.tokenizeLine(ab,Dc[ud],Fc,function(){})}return!0}function fd(Ja,ab,Cb,ba,Ka,nb,xb){ab=P.linesToTokenize(ab,Cb,ba,Ka);Cb=ab.lines;P.tokenizeLines(Ja,
Cb,ab.state,nb,xb);return Cb}function lb(Ja,ab,Cb,ba,Ka){var nb=[],xb,Dc=function(td){return nb.push(xb=[])},Fc=function(td,rd,zf,Ye,Zf,vh,Hi){return xb.push(zf,Ye,td,Zf.current(),rd.localMode||Hi)};try{var ud=P.visitDocumentTokens(Ja,ab,Cb,ba,Ka,Dc,Fc)}catch(td){nb.length=0,ud=P.visitDocumentTokens(Ja,ab,Cb,ba,null,Dc,Fc)}return{tokens:nb,lines:ud}}function Hd(Ja,ab,Cb,ba,Ka){null==ab&&(ab=Ja.search(/[^\s\u00a0]/),-1==ab&&(ab=Ja.length));ba=ba||0;for(Ka=Ka||0;;){var nb=Ja.indexOf("\t",ba);if(0>nb||
nb>=ab)return Ka+(ab-ba);Ka+=nb-ba;Ka+=Cb-Ka%Cb;ba=nb+1}}function db(Ja){Ja=Ja.toLowerCase();for(var ab=0;ab<P.modeInfo.length;ab++){var Cb=P.modeInfo[ab];if(Cb.mime==Ja)return Cb;if(Cb.mimes)for(var ba=0;ba<Cb.mimes.length;ba++)if(Cb.mimes[ba]==Ja)return Cb}if(/\+xml$/.test(Ja))return db("application/xml");if(/\+json$/.test(Ja))return db("application/json")}function rb(Ja){for(var ab=0;ab<P.modeInfo.length;ab++){var Cb=P.modeInfo[ab];if(Cb.ext)for(var ba=0;ba<Cb.ext.length;ba++)if(Cb.ext[ba]==Ja)return Cb}}
function vb(Ja){for(var ab=0;ab<P.modeInfo.length;ab++){var Cb=P.modeInfo[ab];if(Cb.file&&Cb.file.test(Ja))return Cb}ab=Ja.lastIndexOf(".");if(Ja=-1<ab&&Ja.substring(ab+1,Ja.length))return P.findModeByExtension(Ja)}function vd(Ja){Ja=Ja.toLowerCase();for(var ab=0;ab<P.modeInfo.length;ab++){var Cb=P.modeInfo[ab];if(Cb.name.toLowerCase()==Ja)return Cb;if(Cb.alias)for(var ba=0;ba<Cb.alias.length;ba++)if(Cb.alias[ba].toLowerCase()==Ja)return Cb}}function me(Ja){if(!Ja)return String(Ja);if(Array.isArray(Ja))return"["+
Ja.map(me).join(",")+"]";if("symbol"===typeof Ja)return Wd.printSymbol(Ja);try{return String(Ja)}catch(ab){return"Cannot print object: "+ab}}function ye(Ja,ab){return!Wd.arr.every(ab.map(function(Cb){return Ja[Cb]}),function(Cb){return Wd.obj.equals(Cb,Ja&&Ja.valueOf())})}function Pe(Ja){if(Wd.obj.isPrimitive(Ja))var ab=Wd.string.print(Ja);else Array.isArray(Ja)?((ab=3<Ja.length)&&(Ja=Ja.slice(0,3)),Ja=Wd.string.print(Ja),ab&&(Ja=Ja.slice(0,-1)+", ...]"),ab=Ja):ab=Wd.string.print(Ja);ab=ab.replace(/\n/g,
"");500<ab.length&&(ab=ab.slice(0,20)+("...["+(ab.length-20)+' CHARS]"'));return ab}function Tc(Ja){return Oc.Inspector.openInWindow({targetObject:Ja})}function re(Ja,ab){return Oc.Inspector.openInWindow({remoteTarget:{code:Ja,evalEnvironment:ab}})}function Ed(Ja,ab){function Cb(Dc){var Fc=Dc.name,ud=Dc.ownerChain(),td=Dc.owner,rd=Dc.world(),zf;Dc===nb&&(zf=[xb]);rd===Dc&&(zf=["$world"]);if(!zf&&Fc&&td){td===rd&&1===Oc.arr.count(Oc.arr.pluck(rd.submorphs,"name"),Fc)&&(zf=['$world.get("'+Fc+'")']);
if(!zf&&td!=rd)for(rd=ud.length-1;rd--;)if(1===ud[rd].getAllNamed(Fc).length){zf=[].concat($jscomp.arrayFromIterable(Cb(ud[rd])),['get("'+Fc+'")']);break}zf||(Fc=[].concat($jscomp.arrayFromIterable(Cb(td)),['get("'+Fc+'")']),Oc.syncEval(Fc.join("."),{context:nb}).value===Dc&&(zf=Fc))}zf||(zf=[xb+'.getMorphById("'+Dc.id+'")']);return zf}ab=void 0===ab?{}:ab;var ba=Ja.world(),Ka=ab;ab=void 0===Ka.maxLength?10:Ka.maxLength;var nb=void 0===Ka.fromMorph?ba:Ka.fromMorph;if(nb===Ja)return"this";var xb=ba===
nb?"$world":"this";if(!(ba||Ja.name&&nb.get(Ja.name)===Ja))return"morph";ba=Cb(Ja);return ba.length>ab?'$world.getMorphWithId("'+Ja.id+'")':ba.join(".")}function Nb(Ja,ab,Cb){var ba=(ab=void 0===ab?"":ab)&&ff.arr.last(ab.split(".")).toLowerCase(),Ka="",nb=0,xb=Math.pow(2,19);if("string"===typeof Ja){if(Ja.length>xb)return null}else if(Ja.document.stringSize>xb)return null;if("string"===typeof Ja)Ka=Ja.slice(0,1E3);else for(Ja=$jscomp.makeIterator(Ja.document.lines),xb=Ja.next();!xb.done;xb=Ja.next()){var Dc=
xb.value;xb=Dc.stringSize;Dc=Dc.text;var Fc=!0;1E3<nb+xb&&(Fc=!1,xb=1E3-nb);Ka+=Dc.slice(0,xb)+(Fc?"\n":"");nb+=xb;if(1E3<=nb)break}nb=$jscomp.makeIterator(ff.modeInfo);for(Ja=nb.next();!Ja.done;Ja=nb.next()){Fc=Ja.value;xb=Fc.contentTest;Ja=Fc.mode;Dc=Fc.ext;Fc=Fc.file;if("function"===typeof xb)try{if(xb(Ka))return Ja}catch(ud){}if(Fc&&Fc instanceof RegExp&&Fc.test(ab))return Ja;if(Dc)for(xb=$jscomp.makeIterator(Dc),Dc=xb.next();!Dc.done;Dc=xb.next())if(Dc.value===ba)return Ja}return Cb}Da({a:md,
d:ic,r:$c});var wa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");wa.Color=Bb;var Ba=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Cb=ab.hasOwnProperty("DefaultTheme")&&"function"===typeof ab.DefaultTheme?ab.DefaultTheme:ab.DefaultTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:"background",get:function(){return wa.Color.white}},
{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:wa.Color.white,fontWeight:"bold",backgroundColor:wa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:wa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:wa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],ab,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2867})}(void 0),Mb=Ba=wa.DefaultTheme;wa.default=Ba;var P=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");P.copyState=Pa;P.startState=bc;P.defineMode=ic;P.resolveMode=Ra;P.getMode=tc;P.innerMode=Qd;P.defineMIME=md;P.registerHelper=$c;P.indentLines=Wa;P.indentLine=function(Ja,ab,Cb,ba,Ka,nb,xb){xb=Object.assign({indentWithTabs:!Ja.useSoftTabs,indentUnit:Ja.tabWidth,tabSize:4,ignoreFollowingText:!1},xb);null==
Ka&&(Ka="add");"smart"==Ka&&(ab.indent||(Ka="prev"));var Dc=xb.tabSize,Fc=Cb.text,ud=P.countColumn(Fc,null,Dc);Cb.modeState&&(Cb.modeState=null);var td=Fc.match(/^\s*/)[0];if(!nb&&!/\S/.test(Fc)){var rd=0;Ka="not"}else if("smart"==Ka&&(rd=ab.indent(ba,xb.ignoreFollowingText?"":Fc.slice(td.length),Fc),rd==P.passIndent||150<rd)){if(!nb)return;Ka="prev"}"prev"==Ka?rd=0<Cb.row?P.countColumn(Cb.prevLine().text,null,Dc):0:"add"==Ka?rd=ud+xb.indentUnit:"subtract"==Ka?rd=ud-xb.indentUnit:"number"==typeof Ka&&
(rd=ud+Ka);rd=Math.max(0,rd);ab="";ba=0;if(xb.indentWithTabs)for(xb=Math.floor(rd/Dc);xb;--xb)ba+=Dc,ab+="\t";ba<rd&&(ab+=" ".repeat(rd-ba));if(ab!=td)return Ja.replace({start:{row:Cb.row,column:0},end:{row:Cb.row,column:td.length}},ab),!0};P.tokenizeLines=function(Ja,ab,Cb,ba,Ka){if(ab.length){Cb=Cb?P.copyState(Ja,Cb):P.startState(Ja);for(var nb=0;nb<ab.length;nb++){var xb=ab[nb];ba(xb);Cb=P.tokenizeLine(Ja,xb,Cb,Ka)}}};P.tokenizeLine=function(Ja,ab,Cb,ba){var Ka=ab.text;if(!Ka)return Cb;var nb=
new P.StringStream(Ka,2);Cb=ab.modeState="function"===typeof Ja.copyState?Ja.copyState(Cb):P.copyState(Ja,Cb);ab.prevLine();for(Cb._string=Ka;!nb.eol();)Ka=Ja.token(nb,Cb),ba(Ka,Cb,nb.start,nb.pos,nb,ab,Ja),nb.start=nb.pos;return Cb};P.printTokens=function(Ja){for(var ab="",Cb=0;Cb<Ja.length;Cb+=5)ab+=Ja[Cb+0]+" => "+Ja[Cb+1]+" "+Ja[Cb+2]+" "+Ja[Cb+3]+" "+Ja[Cb+4].name+"\n";return ab};P.visitDocumentTokens=fd;P.tokenizeDocument=lb;P.linesToTokenize=function(Ja,ab,Cb,ba){if(ba&&ba.row>=Cb)return{lines:[],
state:null};ab=ba?Math.max(0,ba.row-1):ab;var Ka=Ja.getLine(ab),nb=Ka.text;Ja=[Ka];ba=null;for(var xb=0,Dc;(Dc=Ka.prevLine())&&50>xb++;){Ka=Dc;if(Ka.modeState){ba=Ka.modeState;break}Ja.unshift(Ka)}if(!ba){for(var Fc=Ka,ud=Infinity;(Dc=Ka.prevLine())&&100>xb++;){Ka=Dc;if(Ka.modeState){ba=Ka.modeState;break}Ja.unshift(Ka);Dc=nb.match(/^\s*/)[0].length;if(0===Dc)break;Dc<ud&&(ud=Dc,Fc=Ka)}!ba&&0<ud&&(Ja=Ja.slice(Ja.indexOf(Fc)))}if(Cb>ab)for(Ka=P.arr.last(Ja);ab<=Cb;ab++){Ka=Ka.nextLine();if(!Ka)break;
Ja.push(Ka)}return{lines:Ja,state:ba}};P.countColumn=Hd;P.findModeByMIME=db;P.findModeByExtension=rb;P.findModeByFileName=vb;P.findModeByName=vd;P.arr=hc;Ba=P.modes||{};P.modes=Ba;P.modes=Ba;P.modes=Ba;Ba=Da("p",{});P.passIndent=Ba;P.passIndent=Ba;P.passIndent=Ba;P.copyState=Pa;P.copyState=Pa;P.startState=bc;P.startState=bc;P.defineMode=ic;P.defineMode=ic;P.resolveMode=Ra;P.resolveMode=Ra;P.getMode=tc;P.getMode=tc;P.innerMode=Qd;P.innerMode=Qd;Ba={};P.mimeModes=Ba;P.mimeModes=Ba;P.mimeModes=Ba;P.defineMIME=
md;P.defineMIME=md;P.registerHelper=$c;P.registerHelper=$c;P.indentLines=Wa;P.indentLines=Wa;P.visitDocumentTokens=fd;P.visitDocumentTokens=fd;P.tokenizeDocument=lb;P.tokenizeDocument=lb;P.countColumn=Hd;P.countColumn=Hd;(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Cb=ab.hasOwnProperty("StringStream")&&"function"===typeof ab.StringStream?ab.StringStream:ab.StringStream=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Qb(Cb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,Ka){this.reset(ba,Ka)}},{key:"reset",value:function(ba,Ka){this.pos=this.start=0;this.string=void 0===ba?"":ba;this.tabSize=void 0===Ka?2:Ka;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",
value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(ba){var Ka=this.string.charAt(this.pos);if("string"==typeof ba?Ka==ba:Ka&&(ba.test?ba.test(Ka):ba(Ka)))return++this.pos,Ka}},{key:"eatWhile",value:function(ba){for(var Ka=this.pos;this.eat(ba););return this.pos>Ka}},{key:"eatSpace",value:function(){for(var ba=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>ba}},{key:"skipToEnd",value:function(){this.pos=
this.string.length}},{key:"skipTo",value:function(ba){ba=this.string.indexOf(ba,this.pos);if(-1<ba)return this.pos=ba,!0}},{key:"backUp",value:function(ba){this.pos-=ba}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=P.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return P.countColumn(this.string,
null,this.tabSize)-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(ba,Ka,nb){if("string"==typeof ba){var xb=function(Fc){return nb?Fc.toLowerCase():Fc},Dc=this.string.substr(this.pos,ba.length);if(xb(Dc)==xb(ba))return!1!==Ka&&(this.pos+=ba.length),!0}else{if((ba=this.string.slice(this.pos).match(ba))&&0<ba.index)return null;ba&&!1!==Ka&&(this.pos+=ba[0].length);return ba}}},{key:"current",value:function(){return this.string.slice(this.start,
this.pos)}},{key:"hideFirstChars",value:function(ba,Ka){this.lineStart+=ba;try{return Ka()}finally{this.lineStart-=ba}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],ab,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);Ba=[{name:"APL",
mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",
ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],
file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",
ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ja){return Ja.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",
ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",
ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",
mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},
{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",
mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],
alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown",
"md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",
mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",
ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},
{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},
{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",
mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Ja){return Ja.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",
mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel",
"formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},
{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",
mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",
ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",
mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];P.modeInfo=Ba;P.modeInfo=Ba;P.modeInfo=Ba;for(var ya=0;ya<P.modeInfo.length;ya++)P.info=P.modeInfo[ya],P.info.mimes&&
(P.info.mime=P.info.mimes[0]);P.defineMode("null",function(){return{token:function(Ja){return Ja.skipToEnd()}}});P.defineMIME("text/plain","null");P.findModeByMIME=db;P.findModeByMIME=db;P.findModeByExtension=rb;P.findModeByExtension=rb;P.findModeByFileName=vb;P.findModeByFileName=vb;P.findModeByName=vd;P.findModeByName=vd;var Ua=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Ua.Color=Bb;Ua.Rectangle=ac;Ua.pt=be;Ua.morph=bd;Ua.ShadowObject=Sd;Ua.StyleSheet=ed;Ua.connect=Mc;Ua.arr=
hc;Ua.string=pd;Ua.FilterableList=Dd;Ua.Range=ke;ya=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Cb=ab.hasOwnProperty("Completer")&&"function"===typeof ab.Completer?ab.Completer:ab.Completer=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],
ab,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:345,end:391})}(void 0);Ua.Completer=ya;Ua.Completer=ya;Ua.Completer=ya;ya=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Cb=ab.hasOwnProperty("WordCompleter")&&"function"===typeof ab.WordCompleter?
ab.WordCompleter:ab.WordCompleter=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:"compute",value:function(ba,Ka){var nb=[],xb=[],Dc=ba.document.lineStrings;ba=ba.cursorPosition.row;for(var Fc=ba-1;0<=Fc;Fc--)for(var ud=$jscomp.makeIterator(Dc[Fc].split(/[^0-9a-z@_]+/i)),td=ud.next();!td.done;td=ud.next())(td=td.value)&&!nb.includes(td)&&td!==Ka&&(nb.push(td),xb.push({priority:1E3-(ba-Fc),completion:td}));
for(Fc=ba+1;Fc<Dc.length;Fc++)for(ud=$jscomp.makeIterator(Dc[Fc].split(/[^0-9a-z_@]+/i)),td=ud.next();!td.done;td=ud.next())(td=td.value)&&!nb.includes(td)&&td!==Ka&&(nb.push(td),xb.push({priority:1E3-(Fc-ba),completion:td}));return xb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],ab,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:400,end:1228})}(void 0);Ua.WordCompleter=ya;Ua.WordCompleter=ya;Ua.WordCompleter=ya;ya=[new Ua.WordCompleter];Ua.defaultCompleters=ya;Ua.defaultCompleters=ya;Ua.defaultCompleters=ya;ya=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Cb=ab.hasOwnProperty("CompletionController")&&"function"===typeof ab.CompletionController?ab.CompletionController:ab.CompletionController=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,Ka){Ka=void 0===Ka?[]:Ka;this.textMorph=ba;this.completers=Ka=ba.pluginCollect("getCompleters",Ka)}},{key:"computeCompletions",value:function(ba){var Ka=this,nb,xb,Dc,Fc,ud,td,rd,zf,Ye,Zf,vh,Hi,Nh,pj,Gh,xk;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ng){switch(Ng.nextAddress){case 1:nb=[],xb=$jscomp.makeIterator(Ka.completers),Dc=xb.next();
case 2:if(Dc.done){Ng.jumpTo(4);break}Fc=Dc.value;Ng.setCatchFinallyBlocks(5);ud=nb;td=ud.concat;return Ng.yield(Fc.compute(Ka.textMorph,ba),7);case 7:nb=td.call(ud,Ng.yieldResult);Ng.leaveTryBlock(3);break;case 5:rd=Ng.enterCatchBlock(),console.warn("Error in completer "+Fc+": "+(rd.stack||rd));case 3:Dc=xb.next();Ng.jumpTo(2);break;case 4:zf=new Map;nb.forEach(function(fk){var Sh=zf.get(fk.completion);Sh||(Sh=[],zf.set(fk.completion,Sh));Sh.push(fk)});Ye=[];Zf=$jscomp.makeIterator(zf.values());
for(vh=Zf.next();!vh.done;vh=Zf.next())Hi=vh.value,Ye.push(Ua.arr.last(Ua.arr.sortByKey(Hi,"priority")));Nh=0;pj=Ua.arr.sortByKey(Ye,"priority").reverse();Gh=pj.length&&pj[0].priority||0;xk=pj.map(function(fk){fk.highestPriority=Gh;var Sh=fk.completion.replace(/\n/g,""),Oj=String((fk.info||"").replace(/\n/g,""));Nh=Math.max(Nh,Sh.length+Oj.length);return{isListItem:!0,string:Sh,annotation:Oj,value:fk}});return Ng.return({items:xk,maxCol:Nh})}})}},{key:"computeSortedCompletions",value:function(ba,
Ka){Ka=void 0===Ka?!1:Ka;var nb=this,xb,Dc,Fc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){if(1==ud.nextAddress)return xb={tokens:[ba],lowercasedTokens:[ba],input:ba},ud.yield(nb.computeCompletions(ba),2);Dc=ud.yieldResult;Fc=Ua.arr.sortBy(Dc.items.filter(function(td){return nb.filterFunction(xb,td,Ka)}),function(td){return nb.sortFunction(xb,td)});return ud.return(Fc)})}},{key:"_printCompletions",value:function(ba){var Ka=this,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==
xb.nextAddress)return xb.yield(Ka.computeSortedCompletions(ba),2);nb=xb.yieldResult.map(function(Dc){return{completion:Dc.value.completion,priority:Dc.value.priority,maxP:Dc.value.highestPriority,sortVal:Dc._cache[ba].sortVal,lev:JSON.stringify(Dc._cache[ba].levenshtein)}});return xb.return(Ua.string.printTable(lively.lang.grid.tableFromObjects(nb)))})}},{key:"prefix",value:function(){var ba=this.textMorph,Ka=ba.selection;return(Ka.isEmpty()?ba.getLine(Ka.lead.row).slice(0,Ka.lead.column):Ka.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(ba,Ka,nb){nb=void 0===nb?!1:nb;Ka._cache||(Ka._cache={});var xb=ba.tokens,Dc=ba.lowercasedTokens,Fc=ba.input;Fc=Ka._cache[Fc]||(Ka._cache[Fc]={});if(Fc.hasOwnProperty("filtered"))return Fc.filtered;Ka=Ka.value.completion.replace(/\([^\)]*\)$/,"");var ud=Ka.toLowerCase();if(nb&&xb[0]&&!Ka.startsWith(xb[0]))return Fc.filtered=!1;if(Dc.every(function(rd){return ud.includes(rd)}))return!0;var td=Fc.levenshtein||(Fc.levenshtein={});ba=nb||3>=Ua.arr.sum(ba.lowercasedTokens.map(function(rd){return td[rd]||
(td[rd]=Ua.string.levenshtein(ud,rd))}));return Fc.filtered=ba}},{key:"sortFunction",value:function(ba,Ka){Ka._cache||(Ka._cache={});var nb=Ka._cache[ba.input]||(Ka._cache[ba.input]={});if(nb.hasOwnProperty("sortVal"))return nb.sortVal;nb=Ka._cache[ba.input]={};var xb=Ka.value;Ka=xb.highestPriority;var Dc=xb.completion;xb=xb.priority;Dc=Dc.replace(/\([^\)]*\)$/,"").toLowerCase();var Fc=0;ba.lowercasedTokens.forEach(function(td){Dc.startsWith(td)?Fc+=12:3<=td.length&&Dc.includes(td)&&(Fc+=5)});Ka=
-((xb||(Fc?Ka:0))/Math.pow(10,String(Ka).length-2))-Fc;var ud=nb.levenshtein||(nb.levenshtein={});ba=Ua.arr.sum(ba.lowercasedTokens.map(function(td){return ud[td]||(ud[td]=Ua.string.levenshtein(Dc,td))}));Fc&&(ba/=2);return nb.sortVal=ba+Ka}},{key:"positionForMenu",value:function(){var ba=this.textMorph,Ka=ba.charBoundsFromTextPosition(ba.cursorPosition);return ba.getGlobalTransform().transformRectToRect(Ka).topLeft().addXY(-ba.scroll.x,-ba.scroll.y).addPt(Ua.pt(ba.borderWidth+4,ba.borderWidth+4))}},
{key:"completionListSpec",value:function(){var ba=this,Ka,nb,xb,Dc,Fc,ud,td,rd,zf,Ye,Zf,vh,Hi,Nh,pj,Gh,xk,Ng,fk,Sh;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oj){if(1==Oj.nextAddress)return nb=Ka=ba.textMorph,xb=nb.fontSize,Dc=nb.fontFamily,Fc=ba.positionForMenu(),ud=ba.prefix(),Oj.yield(ba.computeCompletions(ud),2);td=Oj.yieldResult;rd=td.items;zf=td.maxCol;Ye=Ka.env.fontMetric.sizeFor(Dc,xb,"M");Zf=Ye.width*zf;vh=Ka.document.getLine(0).height;Hi=Math.max(120,Zf<Ka.width?Zf:Ka.width);
Nh=vh*rd.length+vh+10;pj=Math.max(70,Math.min(700,Nh));Gh=Fc.extent(Ua.pt(Hi,pj));if(xk=Ka.world())Ng=xk.visibleBounds().insetBy(5),Gh.bottom()>Ng.bottom()&&(fk=Gh.bottom()-Ng.bottom(),fk>Gh.height-50&&(fk=Gh.height-50),Gh.height-=fk),Gh.right()>Ng.right()&&(Sh=Gh.right()-Ng.right(),Gh.width=120>Gh.width-Sh?120:Gh.width-Sh),Ng.containsRect(Gh)||(Gh=Gh.withTopLeft(Ng.translateForInclusion(Gh).topLeft())),Gh=Gh.translatedBy(Ng.insetBy(0).topLeft().negated());return Oj.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:xb,position:Gh.topLeft(),extent:Gh.extent(),items:rd,input:ud,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:ba.filterFunction,sortFunction:ba.sortFunction})})}},{key:"removeMenuOnBlur",value:function(ba){var Ka=ba.menu;setTimeout(function(){Ka.withAllSubmorphsDetect(function(nb){return nb.isFocused()})?Ka.inputMorph.focus():Ka.remove()})}},{key:"openCompletionList",value:function(){var ba=this,Ka,nb,xb,Dc,Fc,ud,td,rd,
zf,Ye;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zf){if(1==Zf.nextAddress)return Ka=ba.textMorph.selection.start,Zf.yield(ba.completionListSpec(),2);if(3!=Zf.nextAddress)return nb=Zf.yieldResult,ba.textMorph.pluginFind(function(vh){return vh.theme}),xb=new Ua.FilterableList(nb),Dc=new Ua.Range({start:Ka,end:ba.textMorph.selection.start}),Fc=ba.textMorph.textInRange(Dc),ud=xb.inputMorph,td=xb.listMorph,rd=nb.input,zf=xb.addMorph({name:"prefix mask",fill:Ua.Color.transparent,bounds:ud.textBounds()},
ud),td.master=null,Dc.isEmpty()||(ba.textMorph.deleteText(Dc),ud.input=Fc,ud.gotoDocumentEnd()),ud.fontColor=ba.textMorph.fontColor,Ua.connect(ud,"textString",zf,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:ud}}),Ua.connect(xb,"accepted",ba,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:rd}}),Ua.connect(xb,"accepted",xb,"remove"),Ua.connect(xb,"canceled",xb,"remove"),Ua.connect(xb,"remove",ba.textMorph,"focus"),Ua.connect(xb.inputMorph,"onBlur",ba,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:xb}}),Ye=ba.textMorph.world(),td.addStyleClass("hiddenScrollbar"),xb.paddingMorph.height=2,ud.height=td.itemHeight,ud.clipMode="visible",ud.fill=ba.textMorph.fill,ud.fixedHeight=!0,ud.fixedWidth=!1,ud.fontSize=td.fontSize,xb.relayout(),xb.selectedIndex=
0,xb.master.applyIfNeeded(!0),Zf.yield(xb.master.whenApplied(),3);rd.length&&(ud.gotoDocumentEnd(),xb.moveBy(Ua.pt(-ud.textBounds().width,0)));Ye.addMorph(xb);ud.focus();xb.inputPadding=Ua.Rectangle.inset(0,0,0,0);return Zf.return(xb)})}},{key:"autoInsertBestMatchingCompletion",value:function(ba,Ka,nb){Ka=void 0===Ka?!0:Ka;var xb=this,Dc,Fc,ud,td;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rd){if(1==rd.nextAddress)return Dc=$jscomp,Fc=Dc.makeIterator,rd.yield(xb.computeSortedCompletions(ba,
Ka),2);ud=Fc.call(Dc,rd.yieldResult);(td=ud.next().value)&&xb.insertCompletion(td.value.completion,ba,nb);rd.jumpToEnd()})}},{key:"insertCompletion",value:function(ba,Ka,nb){var xb=this.textMorph,Dc=xb.document,Fc=xb.selection.isMultiSelection?xb.selection.selections:[xb.selection];xb.undoManager.group();Fc.forEach(function(ud){ud.collapseToEnd();var td=ud.lead,rd=Ka?Dc.indexToPosition(Dc.positionToIndex(td)-Ka.length):td;"function"===typeof nb?nb(ba,Ka,xb,{start:rd,end:td},ud):xb.replace({start:rd,
end:td},ba)});xb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],ab,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1355,end:12762})}(void 0);Ua.CompletionController=ya;Ua.CompletionController=ya;Ua.CompletionController=ya;
ya=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ja,ab,Cb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){return 1==Ka.nextAddress?(ba=new Ua.CompletionController(Ja,Ua.defaultCompleters),Ka.yield(ba.openCompletionList(),2)):Ka.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ja,ab,Cb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){return 1==Ka.nextAddress?
(ba=new Ua.CompletionController(Ja,Ua.defaultCompleters),Ka.yield(ba.autoInsertBestMatchingCompletion(ba.prefix()),2)):Ka.return(!0)})}}];Ua.completionCommands=ya;Ua.completionCommands=ya;Ua.completionCommands=ya;var Eb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Eb.chain=Kd;Eb.arr=hc;Eb.obj=jd;Eb.string=pd;var Cc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.start;0<ab.row&&(ab=Ja.getPositionAboveOrBelow(1,
ab,!0,0,Ja.charBoundsFromTextPosition(ab).x),Ja.selection.addRange({start:ab,end:ab}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.start;ab.row<Ja.documentEndPosition.row&&(ab=Ja.getPositionAboveOrBelow(-1,ab,!0,0,Ja.charBoundsFromTextPosition(ab).x),Ja.selection.addRange({start:ab,end:ab}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.selections[Ja.selection.selections.length-
1];if(ab.isEmpty())return!0;Ja.searchForAll(ab.text,{start:{column:0,row:0}}).forEach(function(Cb){return Ja.selection.addRange(Cb.range,!1)});Ja.selection.mergeSelections();Eb.arr.remove(Ja.selection.selections,ab);Ja.selection.selections.push(ab);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.selections.length-1,Cb=Ja.selection.selections[ab];if(Cb.isEmpty())return!0;var ba=Ja.search(Cb.text,{start:Cb.end,backwards:!1});
ba&&(Cb=Ja.selection.selections.findIndex(function(Ka){return Ka.range.equals(ba.range)}),-1<Cb?Eb.arr.swap(Ja.selection.selections,Cb,ab):Ja.selection.addRange(ba.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.selections.length-1,Cb=Ja.selection.selections[ab];if(Cb.isEmpty())return!0;var ba=Cb.start,Ka=Ja.search(Cb.text,{start:{row:ba.row,column:ba.column-(Cb.text.length-1)},backwards:!0});Ka&&(Cb=Ja.selection.selections.findIndex(function(nb){return nb.range.equals(Ka.range)}),
-1<Cb?Eb.arr.swap(Ja.selection.selections,Cb,ab):Ja.selection.addRange(Ka.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.selections.length;1<ab&&Ja.selection.removeSelections(ab-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ja){Ja.selection.selections=lively.lang.arr.rotate(Ja.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(Ja){Ja.selection.selections=lively.lang.arr.rotate(Ja.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.selections;if(1>=ab.length)return!0;var Cb=Eb.arr.groupBy(ab,function(Ka){return Ka.range.start.row});ab=Cb.keys().map(function(Ka){Ka=Cb[Ka];var nb=Eb.arr.max(Ka,function(xb){return xb.range.start.column});Eb.arr.without(Ka,nb).forEach(function(xb){return xb.range=nb.range});
return nb});var ba=Eb.arr.max(ab,function(Ka){return Ka.range.start.column}).range.start.column;ab.forEach(function(Ka){var nb=Ka.range.start;Ka=nb.row;nb=nb.column;Ja.insertText(" ".repeat(ba-nb),{row:Ka,column:nb})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ja){Ja.selection.disableMultiSelect();if(Ja.selection.isEmpty())var ab=Ja.lastSavedMark&&Ja.lastSavedMark.position||(void 0).lineRange().start,Cb=Ja.cursorPosition;else ab=Ja.selection,
Cb=ab.lead,ab=ab.anchor;Ja.selection.collapse();var ba=ab.column,Ka=Cb.column;Eb.arr.range(ab.row,Cb.row).forEach(function(nb){return Ja.getLine(nb).length>Math.min(Ka,ba)&&Ja.selection.addRange({end:{row:nb,column:Ka},start:{row:nb,column:ba}},!1)});Ja.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ja,ab,Cb){Cb=void 0===Cb?1:Cb;Ja.undoManager.group();Ja.selection.selections.forEach(function(ba,Ka){return ba.text=String(Ka+
Cb)});Ja.undoManager.group();return!0}}];Eb.multiSelectCommands=Cc;Eb.multiSelectCommands=Cc;Eb.multiSelectCommands=Cc;var cd=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");cd.pToI=function(Ja,ab){return Ja.positionToIndex(ab)};cd.iToP=function(Ja,ab){return Ja.indexToPosition(ab)};cd.execCodeNavigator=function(Ja){return function(ab,Cb,ba){var Ka=ab.pluginInvokeFirst("getNavigator");if(!Ka)return!0;ab.saveMark();ba=ba||1;for(var nb=0;nb<ba;nb++)Ka[Ja](ab,Cb);return!0}};
cd.once=cb;var ee=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:cd.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:cd.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:cd.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:cd.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:cd.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ja,ab){function Cb(){var nb=Ja.$expandRegionState,xb=cd.pToI(Ja,Ja.cursorPosition);if(nb&&(nb.range[0]===xb||nb.range[1]===xb))return nb;nb=Ja.selection.range;return Ja.$expandRegionState={range:[cd.pToI(Ja,nb.start),
cd.pToI(Ja,nb.end)]}}ab=ab||{};var ba=Ja.pluginInvokeFirst("getNavigator");if(!ba)return!0;var Ka=ab.start;ab=ab.end;if("number"===typeof Ka&&"number"===typeof ab)Cb(),ba={range:[Ka,ab],prev:Cb()};else{Ka=ba.ensureAST(Ja);if(!Ka)return;ba=ba.expandRegion(Ja,Ja.textString,Ka,Cb())}ba&&ba.range&&(Ja.selection={start:cd.iToP(Ja,ba.range[0]),end:cd.iToP(Ja,ba.range[1])},Ja.$expandRegionState=ba);cd.once(Ja,"selectionChange",function(){return Ja.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ja){if(Ja.selection.isEmpty())return!0;var ab=Ja.pluginInvokeFirst("getNavigator");if(!ab)return!0;var Cb=ab.ensureAST(Ja);if(!Cb)return!0;var ba=Ja.$expandRegionState;if(!ba)return!0;(ab=ab.contractRegion(Ja,Ja.textString,Cb,ba))&&ab.range&&(Ja.selection={start:cd.iToP(Ja,ab.range[0]),end:cd.iToP(Ja,ab.range[1])},Ja.$expandRegionState=ab);cd.once(Ja,"selectionChange",
function(){return Ja.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];cd.commands=ee;cd.commands=ee;cd.commands=ee;var Vd=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");Vd.arr=hc;Vd.chain=Kd;Vd.string=pd;var Ze=[{name:"toggle comment",exec:function(Ja){var ab=Ja.pluginInvokeFirst("getComment");if(!ab)return!0;if(!ab.lineCommentStart)return ab.blockCommentStart?Ja.execCommand("toggle block comment"):!0;var Cb=ab.lineCommentStart,ba=
new RegExp("^(\\s*)("+Cb+"\\s?)(.*)");ab=Ja.document;var Ka=Ja.selection;Ka.isEmpty()||0!==Ka.end.column||Ka.growRight(-1);var nb=Ka.start.row;ab=ab.lineStrings.slice(Ka.start.row,Ka.end.row+1);ab=ab.some(function(Fc){return!!Fc.trim()})?Vd.arr.dropWhile(ab,function(Fc){return Fc.trim()?!1:++nb&&!0}):ab;var xb=ab.every(function(Fc){return Fc.trim()&&Fc.match(ba)});Ja.undoManager.group();if(xb)ab.forEach(function(Fc,ud){if(Fc=Fc.match(ba)){Fc=$jscomp.makeIterator(Fc);Fc.next();var td=Fc.next().value,
rd=Fc.next().value;Fc.next();Ja.deleteText({start:{row:nb+ud,column:td.length},end:{row:nb+ud,column:td.length+rd.length}})}});else{var Dc=ab.reduce(function(Fc,ud,td){return ud.trim()||Ka.isEmpty()&&Ka.start.row===Ka.end.row?Math.min(Fc,ud.match(/^\s*/)[0].length):Fc},Infinity);Dc=Infinity===Dc?0:Dc;ab.forEach(function(Fc,ud){Fc=$jscomp.makeIterator(Fc.match(/^(\s*)(.*)/));Fc.next();Fc.next();Fc.next();Ja.insertText(Cb+" ",{row:nb+ud,column:Dc})})}Ja.undoManager.group();return!0}},{name:"toggle block comment",
exec:function(Ja){var ab=Ja.pluginInvokeFirst("getComment");if(!ab)return!0;if(!ab.blockCommentStart)return ab.lineCommentStart?Ja.execCommand("toggle comment"):!0;if(!ab||!ab.blockCommentStart)return!0;var Cb=ab.blockCommentStart;ab=ab.blockCommentEnd;var ba=new RegExp("^"+Cb.replace(/\*/g,"\\*")),Ka=new RegExp(ab.replace(/\*/g,"\\*")+"$"),nb=Ja.tokenAt(Ja.cursorPosition);if(nb&&"comment"===nb.token){var xb=Ja.textInRange(nb);if(xb.match(ba)&&xb.match(Ka))return Ja.undoManager.group(),Ja.replace(nb,
xb.slice(Cb.length,-ab.length)),Ja.undoManager.group(),!0}Ja.undoManager.group();Ja.insertText(Cb,Ja.selection.start);Ja.insertText(ab,Ja.selection.end);Ja.undoManager.group();Cb=!Ja.selection.isEmpty();Ja.selection.growLeft(ab.length);Cb||Ja.selection.collapse();return!0}},{name:"comment box",exec:function(Ja,ab,Cb){ab=Ja.undoManager.ensureNewGroup(Ja,"comment box");if(Ja.selection.isEmpty())return Ja.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ja.execCommand("toggle comment"),
Ja.undoManager.group(ab),!0;var ba=Ja.selection.range,Ka=Ja.withSelectedLinesDo(function(xb){return xb}),nb=Vd.arr.min([ba.start.column].concat(Vd.chain(Ka).map(function(xb){return xb.match(/^\s*/)}).flatten().compact().pluck("length").value()));Ka=Vd.arr.max(Ka.map(function(xb){return xb.length}))-nb;Ka=Array(Math.ceil(Ka/2)+1).join("-=")+"-";Ja.execCommand("toggle comment");Ja.collapseSelection();Ja.cursorPosition={row:ba.start.row,column:0};Cb?Ja.insertText(Vd.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",nb)):Ja.insertText(Vd.string.indent(Ka+"\n"," ",nb));Ja.selection.goUp();Ja.execCommand("toggle comment");Ja.cursorPosition={row:ba.end.row+2,column:0};Ja.insertText(Vd.string.indent(Ka+"\n"," ",nb));Ja.selection.goUp();Ja.execCommand("toggle comment");Ja.selection.range={start:{row:ba.start.row,column:0},end:Ja.cursorPosition};Ja.undoManager.group(ab);return!0},multiSelectAction:"forEach",handlesCount:!0}];Vd.commands=Ze;Vd.commands=Ze;Vd.commands=Ze;var Wd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
Wd.printSymbol=function(Ja){if(Symbol.keyFor(Ja))return'Symbol.for("'+Symbol.keyFor(Ja)+'")';if(Wd.knownSymbols.get(Ja))return Wd.knownSymbols.get(Ja);String(Ja).match(Wd.symMatcher);return String(Ja)};Wd.defaultSort=function(Ja,ab){if(Ja.hasOwnProperty("priority")||ab.hasOwnProperty("priority")){var Cb=Ja.priority||0,ba=ab.priority||0;if(Cb<ba)return-1;if(Cb>ba)return 1}Ja=(Ja.keyString||Ja.key).toLowerCase();ab=(ab.keyString||ab.key).toLowerCase();return Ja<ab?-1:Ja===ab?0:1};Wd.safeToString=me;
Wd.propertyNamesOf=function(Ja,ab){if(!Ja)return[];if(Array.isArray(Ja)){var Cb=ab?ab.offset:0;return Wd.arr.range(Cb,Cb+(ab?ab.partitionSize:Ja.length-1))}return Wd.arr.sortBy(Object.keys(Ja),function(ba){return ba.toLowerCase()})};Wd.isMultiValue=ye;Wd.printValue=Pe;Wd.partitionedChildren=function(Ja,ab){var Cb=void 0===ab?{}:ab;ab=void 0===Cb.originalValue?Ja:Cb.originalValue;var ba=void 0===Cb.offset?0:Cb.offset;Cb=void 0===Cb.partitionSize?Ja.length||Object.values(Ja).length:Cb.partitionSize;
if(Wd.obj.isArray(Ja)){Ja=Wd.num.roundTo(Math.max(Wd.MIN_PARTITION_SIZE,Cb/50),.1);Cb/=Ja;for(var Ka=[],nb=0;nb<Cb;nb++){var xb="["+(ba+nb*Ja)+"-"+(ba+(nb+1)*Ja)+"]";Ka.push({partition:{originalValue:ab,offset:ba+nb*Ja,partitionSize:Ja},value:[],key:xb,keyString:xb,valueString:"...",isCollapsed:!0})}return Ka}Ja=Wd.num.roundTo(Math.max(Wd.MIN_PARTITION_SIZE,Cb/50),.1);Cb/=Ja;Ka=[];nb=Wd.obj.keys(ab).sort();for(xb=0;xb<Cb;xb++){var Dc=ba+xb*Ja,Fc=ba+(xb+1)*Ja,ud=Wd.obj.select(ab,nb.slice(Dc,Fc));Dc=
"["+nb[Dc].slice(0,4)+"-"+(nb[Fc]||Wd.arr.last(nb)).slice(0,4)+"]";Ka.push({partition:{originalValue:ud,offset:ba+xb*Ja,partitionSize:Ja},value:[],key:Dc,keyString:Dc,valueString:"...",isCollapsed:!0})}return Ka};Wd.propertiesOf=function(Ja){var ab=Ja.partition?Ja.target:Ja.value;if(!ab)return[];var Cb={_rev:!0},ba=[],Ka="function"===typeof ab.livelyCustomInspect?ab.livelyCustomInspect():{},nb=Object.assign({},Wd.defaultPropertyOptions,{},Ka);if(Ka.properties){Ka=$jscomp.makeIterator(Ka.properties);
for(var xb=Ka.next();!xb.done;xb=Ka.next()){var Dc=xb.value;xb=Dc.key;var Fc=Dc.hidden,ud=Dc.priority,td=Dc.keyString,rd=Dc.value;Dc=Dc.valueString;Cb[xb]=!0;Fc||ba.push(Ja.getSubNode({priority:ud,key:xb,keyString:td||Wd.safeToString(xb),value:rd,valueString:Dc,isCollapsed:!0}))}}if(nb.includeDefault){Ka=Wd.propertyNamesOf(ab,Ja.partition);if(Ka.length>Wd.MAX_NODE_THRESHOLD)for(Cb=$jscomp.makeIterator(Wd.partitionedChildren(ab,Ja.partition)),Ka=Cb.next();!Ka.done;Ka=Cb.next())ba.push(Ja.getSubNode(Ka.value));
else for(Fc=$jscomp.makeIterator(Ka),Ka=Fc.next();!Ka.done;Ka=Fc.next())ud=Ka.value,ud in Cb||(Ka=ab[ud],xb=Wd.printValue(Ka),Ka={keyString:ud,key:ud,value:Ka,valueString:xb,isCollapsed:!0},ba.push(Ja.getSubNode(Ka)));if(nb.includeSymbols)for(Cb=$jscomp.makeIterator(Object.getOwnPropertySymbols(ab)),Ka=Cb.next();!Ka.done;Ka=Cb.next())Fc=Ka.value,ud=Wd.safeToString(Fc),Ka=ab[Fc],xb=Wd.printValue(Ka),Ka={key:Fc,keyString:ud,value:Ka,valueString:xb,isCollapsed:!0},ba.push(Ja.getSubNode(Ka))}nb.sort&&
(ba=nb.sortFunction(ab,ba));return ba};Wd.obj=jd;Wd.num=Ab;Wd.arr=hc;Wd.string=pd;Wd.connect=Mc;Wd.signal=Yb;Wd.TreeData=gc;Wd.newUUID=dd;Wd.localInterface=Ha;Wd.MAX_NODE_THRESHOLD=1E3;Wd.MIN_PARTITION_SIZE=250;Wd.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Ja,ab){return Array.isArray(Ja)?ab:ab.sort(Wd.defaultSort)}};Wd.symMatcher=/^Symbol\((.*)\)$/;Wd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ja){return"symbol"===
typeof Symbol[Ja]}).reduce(function(Ja,ab){return Ja.set(Symbol[ab],"Symbol."+ab)},new Map)}();Wd.isMultiValue=ye;Wd.isMultiValue=ye;Wd.printValue=Pe;Wd.printValue=Pe;var Be=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cb=ab.hasOwnProperty("InspectionTree")&&"function"===typeof ab.InspectionTree?ab.InspectionTree:ab.InspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Qb(Cb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Qb._get(Object.getPrototypeOf(Cb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.inspector=ba.inspector;this.root.isInspectionNode||(this.root=Wd.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(ba){ba=void 0===ba?!0:ba;return Qb._get(Object.getPrototypeOf(Cb.prototype),"asListWithIndexAndDepth",
this).call(this,function(Ka){Ka=Ka.node;return ba?Ka.visible:!0})}},{key:"getContextFor",value:function(ba){return ba==this.root?this.root.value.inspectee:ba.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(ba){var Ka=void 0===ba.maxDepth?1:ba.maxDepth,nb=ba.iterator,xb=ba.showUnknown,Dc=ba.showInternal,Fc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){if(1==ud.nextAddress)return ud.yield(Fc.uncollapseAll(function(td,rd){return Ka>rd&&(td==Fc.root||td.value.submorphs)}),
2);Fc.asListWithIndexAndDepth(!1).forEach(function(td){var rd=td.node;return 0==td.depth?rd.visible=!0:!xb&&rd.keyString&&rd.keyString.includes("UNKNOWN PROPERTY")||!Dc&&rd.keyString&&rd.keyString.includes("internal")?rd.visible=!1:rd.value&&rd.value.submorphs?rd.visible=!0:rd.visible=nb(rd)});ud.jumpToEnd()})}},{key:"getChildren",value:function(ba){return ba.children}},{key:"display",value:function(ba){return ba.display(this.inspector)}},{key:"isCollapsed",value:function(ba){return ba.isCollapsed}},
{key:"isLeaf",value:function(ba){return Wd.obj.isPrimitive(ba.value)}},{key:"collapse",value:function(ba,Ka){var nb=this;ba.isCollapsed=Ka;Ka||this.isLeaf(ba)||ba.children.length||(ba.children=Wd.propertiesOf(ba).map(function(xb){nb.parentMap.set(xb,ba);return xb}))}},{key:"retrieveForRemoteProxy",value:function(ba){ba.uuid||(ba.uuid=Wd.newUUID(),this.idToNodeMap[ba.uuid]=ba);return{uuid:ba.uuid,value:this.isLeaf(ba)?ba.value:{},keyString:ba.keyString,key:ba.keyString,valueString:Wd.safeToString(ba.value),
isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Wd.localInterface}},{key:"getNodeViaId",value:function(ba){return this.idToNodeMap[ba]}},{key:"asRemoteDelegate",value:function(ba){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[ba]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(ba,Ka){return new this({key:"inspectee",value:{inspectee:ba},isCollapsed:!0,inspector:Ka})}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5932,end:8631})}(Wd.TreeData);Wd.InspectionTree=Be;Wd.InspectionTree=
Be;Wd.InspectionTree=Be;var Qe=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cb=ab.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof ab.RemoteInspectionTree?ab.RemoteInspectionTree:ab.RemoteInspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(ba){this.parentMap=new WeakMap;this.root=ba.proxy;this.evalEnvironment=ba.evalEnvironment;this.inspector=ba.inspector;this.delegateId=ba.delegateId}},{key:"getContextFor",value:function(ba){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+ba.uuid+'").value'}},{key:"dispose",value:function(){var ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){return Ka.yield(ba.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
ba.delegateId+"']\n    ",ba.evalEnvironment),0)})}},{key:"display",value:function(ba){return ba.keyString+": "+ba.valueString}},{key:"collapse",value:function(ba,Ka){var nb=this,xb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Dc){if(1==Dc.nextAddress)return(ba.isCollapsed=Ka)||nb.isLeaf(ba)?Dc.return():ba.children.length?Dc.jumpTo(0):Dc.yield(nb.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+ba.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+nb.delegateId+'"]'}),3);xb=Dc.yieldResult;ba.children=xb.isError?[]:xb.value;Dc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(ba,Ka){var nb=this,xb,Dc,Fc,ud;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return td.yield(nb.createRemoteContext(ba,Ka),2);xb=td.yieldResult;
Dc=xb.proxy;Fc=xb.delegateId;ud=xb.evalEnvironment;return td.return(new nb({key:"inspectee",proxy:Dc,delegateId:Fc,evalEnvironment:ud,inspector:Ka}))})}},{key:"createRemoteContext",value:function(ba,Ka){var nb=ba.code,xb=ba.evalEnvironment,Dc=ba.delegateId,Fc,ud;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return Dc="lively://inspector-"+Ka.id,td.yield(xb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
nb+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Dc+'");\n    ',xb),2);Fc=td.yieldResult;ud=Fc.value;return td.return({delegateId:Dc,evalEnvironment:xb,proxy:ud})})}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8640,end:10983})}(Wd.InspectionTree);
Wd.RemoteInspectionTree=Qe;Wd.RemoteInspectionTree=Qe;Wd.RemoteInspectionTree=Qe;(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cb=ab.hasOwnProperty("InspectionNode")&&"function"===typeof ab.InspectionNode?ab.InspectionNode:ab.InspectionNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){var Ka=
ba.root,nb=ba.priority,xb=ba.key,Dc=ba.keyString,Fc=ba.value,ud=ba.valueString,td=ba.isCollapsed,rd=void 0===ba.children?[]:ba.children,zf=void 0===ba.isSelected?!1:ba.isSelected,Ye=void 0===ba.visible?!0:ba.visible;this.partition=ba.partition;this.priority=nb;this.key=xb;this.keyString=String(Dc||xb);this.value=Fc;this.valueString=ud||Wd.printValue(Fc);this.isCollapsed=td;this.children=rd;this.isSelected=zf;this.visible=Ye;this.root=Ka}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(ba){if(ba.value&&ba.value.isMorph)return new Wd.MorphNode(Object.assign({root:this.root},ba));var Ka=ba.key,nb=ba.keyString,xb=this.value,Dc=ba.partition;Dc&&(xb=Dc.originalValue,nb=Ka);return new Wd.PropertyNode(Object.assign({},ba,{keyString:nb,key:Ka,target:xb,partition:Dc,root:this.root,spec:{}}))}},{key:"display",value:function(ba){var Ka=this.keyString,nb=this.valueString;if(!this.interactive)return Ka+": "+nb;this._propertyWidget||
(this._propertyWidget=ba.renderDraggableTreeLabel({value:Ka+": "+nb}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(ba,Ka){Ka=void 0===Ka?null:Ka;return ba.value&&ba.value.isMorph?new Wd.MorphNode(Object.assign({root:Ka},ba)):new Wd.InspectionNode(Object.assign({root:Ka},ba))}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10985,end:13522})})(void 0);(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cb=ab.hasOwnProperty("MorphNode")&&"function"===typeof ab.MorphNode?ab.MorphNode:ab.MorphNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,
[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Qb._get(Object.getPrototypeOf(Cb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(ba){var Ka=this.propertyInfo[ba.key]||{};return ba.value&&ba.value.isMorph?new Wd.MorphNode(Object.assign({},ba,{root:this.root})):new Wd.PropertyNode(Object.assign({},ba,{root:this.root,target:this.target,
spec:Ka}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13524,end:14670})})(Wd.InspectionNode);(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cb=ab.hasOwnProperty("PropertyNode")&&
"function"===typeof ab.PropertyNode?ab.PropertyNode:ab.PropertyNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Qb._get(Object.getPrototypeOf(Cb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);var Ka=ba.spec,nb=ba.target;this.partition=ba.partition;this.target=nb;this.spec=Ka;this.foldedNodes={}}},{key:"__deserialize__",
value:function(ba,Ka){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(ba){this._interactive=ba}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(ba){return this.isFoldable?this.getFoldedContext(ba):Qb._get(Object.getPrototypeOf(Cb.prototype),"getSubNode",this).call(this,ba)}},{key:"getFoldedContext",
value:function(ba){return this.foldedNodes[ba.key]=new Wd.FoldedNode(Object.assign({},ba,{root:this.root,target:this.target,foldableNode:this,spec:Wd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(ba,Ka){(Ka=void 0===Ka?!1:Ka)&&(this.target[this.key]=ba);this.value=this.target[this.key];this.valueString=Wd.printValue(this.value);this.interactive&&(Ka||this._propertyWidget.highlight());if(this.isFoldable)for(var nb in this.foldedNodes)this.foldedNodes[nb].value=
this.value[nb],this.foldedNodes[nb].valueString=Wd.printValue(this.value[nb]),this.foldedNodes[nb]._propertyWidget&&Wd.signal(this.foldedNodes[nb]._propertyWidget,"update",this.value[nb])}},{key:"display",value:function(ba){var Ka=this,nb=this._propertyWidget,xb=this.keyString,Dc=this.valueString,Fc=this.target,ud=this.value,td=this.spec;if(!(this.interactive||td.foldable&&Wd.isMultiValue(ud,td.foldable)))return ba.renderPropertyControl({target:Fc,keyString:xb,valueString:Dc,tree:ba.ui.propertyTree,
value:ud,spec:td,node:this,fastRender:!0});if(nb)return nb.keyString=xb,nb.valueString=Dc,nb.isSelected=this.isSelected,nb.control&&(nb.control.isSelected=this.isSelected),nb;nb=this._propertyWidget=ba.renderPropertyControl({target:Fc,keyString:xb,valueString:Dc,value:ud,spec:td,node:this,isSelected:this.isSelected,fontColor:ba.ui.propertyTree.fontColor});this.isInternalProperty||td.readOnly||(Wd.connect(nb,"propertyValue",this,"refreshProperty",{updater:function(rd,zf){return rd(zf,!0)}}),Wd.connect(nb,
"openWidget",this.root,"onWidgetOpened",{converter:function(rd){return{widget:rd,node:Ka.sourceObj}}}));return nb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14672,end:18071})})(Wd.InspectionNode);
(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cb=ab.hasOwnProperty("FoldedNode")&&"function"===typeof ab.FoldedNode?ab.FoldedNode:ab.FoldedNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Qb._get(Object.getPrototypeOf(Cb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
ba);this.foldableNode=ba=ba.foldableNode;this.foldedProp=ba.key+Wd.string.capitalize(this.key)}},{key:"refreshProperty",value:function(ba,Ka){Ka=void 0===Ka?!1:Ka;var nb={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(nb[this.key]=ba,nb)),Ka)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18073,end:18749})})(Wd.PropertyNode);var rf=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");rf.Color=Bb;var cg=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Cb=ab.hasOwnProperty("DarkTheme")&&"function"===typeof ab.DarkTheme?ab.DarkTheme:ab.DarkTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Qb(Cb,Ja,[{key:"background",get:function(){return rf.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return rf.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:rf.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:rf.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:rf.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:rf.Color.white,fontWeight:"bold",backgroundColor:rf.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:rf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:rf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],ab,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3048})}(void 0),Ef=cg=rf.DarkTheme;rf.default=cg;var Oc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Oc.inspect=Tc;Oc.remoteInspect=re;Oc.generateReferenceExpression=Ed;Oc.onNumberDragStart=
function(Ja,ab){ab.initPos=Ja.position;ab.factorLabel=(new Oc.Tooltip({description:"1x"})).openInWorld(Ja.hand.position.addXY(10,10))};Oc.onNumberDrag=function(Ja,ab){var Cb=Oc.getScaleAndOffset(Ja,ab),ba=Cb.scale;Cb=Cb.offset;ab.factorLabel.position=Ja.hand.position.addXY(10,10);ab.factorLabel.description=ba+"x";return Oc.getCurrentValue(Cb,ba,ab)};Oc.onNumberDragEnd=function(Ja,ab){var Cb=Oc.getScaleAndOffset(Ja,ab);Ja=Cb.offset;Cb=Cb.scale;ab.factorLabel.softRemove();return Oc.getCurrentValue(Ja,
Cb,ab)};Oc.getScaleAndOffset=function(Ja,ab){var Cb=Ja.position.subPt(ab.initPos);Ja=Cb.x;ab=Oc.num.roundTo(Math.exp(-Cb.y/$world.height*6),.01)*ab.baseFactor;return{offset:Ja,scale:ab}};Oc.getCurrentValue=function(Ja,ab,Cb){return Math.max(Cb.min,Math.min(Cb.max,Cb.scrubbedValue+(Cb.floatingPoint?Ja*ab:Math.round(Ja*ab))))};Oc.Color=Bb;Oc.Rectangle=ac;Oc.rect=Zd;Oc.pt=be;Oc.obj=jd;Oc.num=Ab;Oc.Path=Wb;Oc.arr=hc;Oc.promise=oc;Oc.connect=Mc;Oc.disconnect=Lb;Oc.once=cb;Oc.Morph=Bc;Oc.Tooltip=Sc;Oc.VerticalLayout=
Yc;Oc.GridLayout=Xb;Oc.HorizontalLayout=qb;Oc.morph=bd;Oc.CustomLayout=uc;Oc.Label=Hc;Oc.Icon=Ia;Oc.StyleSheet=ed;Oc.config=Va;Oc.Tree=tb;Oc.LoadingIndicator=Jb;Oc.DropDownList=Ib;Oc.DropDownSelector=ib;Oc.SearchField=jb;Oc.LabeledCheckBox=Fb;Oc.MorphHighlighter=ec;Oc.InteractiveMorphSelector=Pc;Oc.printValue=Pe;Oc.RemoteInspectionTree=Qe;Oc.InspectionTree=Be;Oc.isMultiValue=ye;Oc.valueWidgets=Q;Oc.popovers=ha;Oc.DarkTheme=Ef;Oc.DefaultTheme=Mb;Oc.syncEval=rc;Oc.inspectorCommands=[{name:"focus codeEditor",
exec:function(Ja){Ja.get("codeEditor").show();Ja.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ja){Ja.get("propertyTree").show();Ja.get("propertyTree").focus();return!0}}];(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cb=ab.hasOwnProperty("DraggedProp")&&"function"===typeof ab.DraggedProp?ab.DraggedProp:ab.DraggedProp=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Qb(Cb,Ja,[{key:"applyToTarget",value:function(ba){var Ka=this.currentTarget,nb=this.control;this.remove();Oc.MorphHighlighter.removeHighlighters(ba.world);if(Ka)if(Ka.isText&&"js"===Ka.editorModeName){var xb=Ka.evalEnvironment.context;ba=Ka.textPositionFromPoint(Ka.localize(ba.position));xb=Oc.generateReferenceExpression(this.sourceObject,{fromMorph:xb});nb.keyString&&(xb+="."+nb.keyString);Ka.insertTextAndSelect(xb,ba);Ka.focus()}else"propertyValue"in nb&&(Ka[nb.keyString]=nb.propertyValue)}},
{key:"update",value:function(ba){ba=ba.hand.globalPosition;var Ka=this.morphBeneath(ba),nb;if(Ka){for(Ka==this.morphHighlighter&&(Ka=Ka.morphBeneath(ba));nb=[Ka].concat($jscomp.arrayFromIterable(Ka.ownerChain())).find(function(xb){return!xb.visible});)Ka=nb=nb.morphBeneath(ba);if(Ka!=this.currentTarget){this.currentTarget=Ka;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Ka.isWorld)return;this.morphHighlighter=Oc.MorphHighlighter.for($world,Ka);this.morphHighlighter.show()}this.position=
ba}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Oc.Color.rgb(169,204,227)},fill:{defaultValue:Oc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var ba=this.control;if(!ba)return this.submorphs=[];this.height=22;this.submorphs=[ba];ba.top=0;ba.fontSize=14;"function"===typeof ba.relayout&&
ba.relayout();this.width=ba.width+20;this.adjustOrigin(Oc.pt(10,10))}}}}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1268,end:3690})})(Oc.Morph);(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cb=ab.hasOwnProperty("DraggableTreeLabel")&&"function"===
typeof ab.DraggableTreeLabel?ab.DraggableTreeLabel:ab.DraggableTreeLabel=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(ba){this.draggedProp=new Oc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Oc.connect(ba.hand,"update",this.draggedProp,"update")}},
{key:"onDrag",value:function(ba){}},{key:"onDragEnd",value:function(ba){Oc.disconnect(ba.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(ba)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Oc.config.codeEditor.defaultStyle.fontFamily},
fill:{defaultValue:Oc.Color.transparent},padding:{defaultValue:Oc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(ba){this.setProperty("isSelected",ba);ba?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=ba)}}}}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3692,end:5015})})(Oc.Label);Be=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cb=ab.hasOwnProperty("PropertyControl")&&"function"===typeof ab.PropertyControl?ab.PropertyControl:ab.PropertyControl=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(ba,Ka,nb){ba.control=new Oc.DropDownSelector({opacity:.8,fill:Oc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Ka,padding:0,values:nb});Oc.connect(ba.control,"update",ba,"propertyValue",{updater:function(xb,Dc){this.targetObj.propertyValue!=Dc&&xb(Dc)}});Oc.connect(ba,"update",ba.control,"selectedValue",{updater:function(xb,Dc){Dc=Dc&&Dc.valueOf?Dc.valueOf():Dc;this.targetObj.propertyValue!=Dc&&xb(Dc)}});return ba}},
{key:"toggleMultiValuePlaceholder",value:function(ba){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:Oc.Color.transparent,layout:new Oc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:Oc.arr.range(0,2).map(function(Ka){return{type:"ellipse",fill:Oc.Color.gray.withA(.5),reactsToPointer:!1,extent:Oc.pt(7,7)}})});ba?(Oc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),
this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(Oc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(ba){this.foldableProperties&&this.toggleMultiValuePlaceholder(Oc.isMultiValue(ba,this.foldableProperties))}},{key:"asFoldable",value:function(ba){this.foldableProperties=ba;Oc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();
this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var ba=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});
ba.isLayoutable=!1;ba.fontWeight="bold";ba.fontColor=Oc.Color.orange;ba.reactsToPointer=!1;ba.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(ba){this.submorphs=[ba]}},layout:{initialize:function(){this.layout=new Oc.CustomLayout({relayout:function(ba){ba.relayout()}})}},
submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(ba){return(ba=ba.value)&&(ba.isColor||ba.isGradient)?"Color":ba&&ba.isPoint?"Point":Oc.obj.isBoolean(ba)?"Boolean":Oc.obj.isNumber(ba)?"Number":Oc.obj.isString(ba)?"String":ba&&ba.isRectangle?"Rectangle":!1}},{key:"render",value:function(ba){ba.spec.type||(ba.spec=Object.assign({},ba.spec,{type:this.inferType(ba)}));switch(ba.spec.type){case "Color":var Ka=this.renderColorControl(ba);
break;case "ColorGradient":Ka=this.renderColorControl(Object.assign({},ba,{gradientEnabled:!0}));break;case "Number":Ka=this.renderNumberControl(ba);break;case "String":Ka=this.renderStringControl(ba);break;case "RichText":Ka=this.renderStringControl(ba);break;case "Layout":Ka=this.renderLayoutControl(ba);break;case "Enum":Ka=this.renderEnumControl(ba);break;case "Shadow":Ka=this.renderShadowControl(ba);break;case "Point":Ka=this.renderPointControl(ba);break;case "Rectangle":Ka=this.renderRectangleControl(ba);
break;case "Boolean":Ka=this.renderBooleanControl(ba);break;default:Ka=this.renderItSomehow(ba)}Ka.control&&(Oc.connect(Ka.control,"openWidget",Ka,"openWidget"),Ka.toggleFoldableValue(ba.value));return Ka}},{key:"baseControl",value:function(ba){var Ka=ba.spec;ba=new this({keyString:ba.keyString,valueString:ba.valueString,isSelected:!1,propertyValue:ba.value});Ka.foldable&&ba.asFoldable(Ka.foldable);return ba}},{key:"renderGrabbableKey",value:function(ba){var Ka=this,nb=ba.target;return[ba.keyString+
":",{nativeCursor:"-webkit-grab",onDragStart:function(xb){xb.state.draggedProp=new Oc.DraggedProp({sourceObject:nb,control:Ka.baseControl(ba)});xb.state.draggedProp.openInWorld();Oc.connect(xb.hand,"update",xb.state.draggedProp,"update")},onDrag:function(xb){},onDragEnd:function(xb){Oc.disconnect(xb.hand,"update",xb.state.draggedProp,"update");xb.state.draggedProp.applyToTarget(xb)}}]}},{key:"renderEnumControl",value:function(ba){var Ka=ba.value,nb=ba.spec.values,xb=ba.keyString,Dc=ba.target,Fc=ba.node;
return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(Ka?Ka.valueOf?Ka.valueOf():Ka:"Not set"),{nativeCursor:"pointer",onMouseDown:function(ud,td){return $jscomp.asyncExecutePromiseGeneratorProgram(function(rd){Dc.world().openWorldMenu(ud,nb.map(function(zf){return{string:zf.toString(),action:function(){Dc[xb]=zf;Fc.rerender()}}}));rd.jumpToEnd()})}}],$jscomp.arrayFromIterable(Oc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7})))}},{key:"renderStringControl",
value:function(ba){var Ka=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(200<Ka.length?Ka.slice(0,20)+"...":Ka),{fontColor:Oc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(ba){var Ka=ba.value,nb=ba.keyString,xb=ba.valueString,Dc=ba.target,Fc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+xb,{fontColor:Oc.Color.black,nativeCursor:"pointer",onMouseDown:function(ud){var td;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rd){if(1==
rd.nextAddress)return td=new Oc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:Ka}),td.relayout(),rd.yield(td.fadeIntoWorld(ud.positionIn(Dc.world())),2);Oc.connect(td,"rectangle",function(zf){Dc[nb]=zf;Fc.rerender()});rd.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(ba){var Ka=ba.value,nb=ba.keyString,xb=ba.valueString,Dc=ba.target,Fc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+xb,{nativeCursor:"pointer",fontColor:Ka?Oc.Color.green:
Oc.Color.red,onMouseDown:function(ud){Dc[nb]=!Dc[nb];Fc.rerender()}}])}},{key:"renderNumberControl",value:function(ba){var Ka=ba.value,nb=ba.spec,xb=ba.keyString,Dc=ba.valueString,Fc=ba.node,ud=ba.target,td=ba.tree,rd=void 0===Fc._numberControls?new Af:Fc._numberControls,zf=$jscomp.makeIterator(rd.submorphs),Ye=zf.next().value,Zf=zf.next().value;rd.fontColor=td.fontColor;var vh=Fc._numberControls=rd;"max"in nb&&"min"in nb&&-Infinity!=nb.min&&Infinity!=nb.max?(vh.baseFactor=(nb.max-nb.min)/100,vh.floatingPoint=
nb.isFloat,vh.max=nb.max,vh.min=nb.min):(vh.floatingPoint=nb.isFloat,vh.baseFactor=.5,vh.min=void 0!=nb.min?nb.min:-Infinity,vh.max=void 0!=nb.max?nb.max:Infinity);var Hi=Oc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),$jscomp.arrayFromIterable(Fc._inputMorph?[Fc._inputMorph,{}]:[" "+(void 0!=Ka&&(Ka.valueOf?Ka.valueOf():Ka).toFixed(nb.isFloat?3:0))+" ",{fontColor:Hi,onMouseUp:function(Nh){Fc._inputMorph=Oc.morph({type:"input",
fill:null,fontColor:Hi,fontFamily:"IBM Plex Mono",fontSize:14,padding:Oc.rect(8,2,-6,2),height:23,cursorColor:Oc.Color.white,value:Ka.valueOf?Ka.valueOf():Dc});ud[xb]=Ka;Fc._inputMorph.focus();Oc.once(Fc._inputMorph,"inputAccepted",function(pj){delete Fc._inputMorph;ud[xb]=nb.isFloat?Number.parseFloat(pj):Number.parseInt(pj);Fc.rerender()});Oc.once(Fc._inputMorph,"onBlur",function(pj){Fc._inputMorph&&(delete Fc._inputMorph,ud[xb]=Ka,Fc.rerender())});Fc.rerender()},onDragStart:function(Nh){vh.scrubbedValue=
Ka;Oc.onNumberDragStart(Nh,vh)},onDrag:function(Nh){ud[xb]=Oc.onNumberDrag(Nh,vh);Fc.rerender()},onDragEnd:function(Nh){return Oc.onNumberDragEnd(Nh,vh)}},rd,{onMouseUp:function(){Ye.fill=Zf.fill=null},onMouseDown:function(Nh){if(Nh.targetMorph===Ye){Ye.fill=Oc.Color.white.withA(.2);if("max"in nb&&ud[xb]>=nb.max)return;ud[xb]+=1}if(Nh.targetMorph===Zf){Zf.fill=Oc.Color.white.withA(.2);if("min"in nb&&ud[xb]<=nb.min)return;--ud[xb]}Fc.rerender()}}]))}},{key:"renderShadowControl",value:function(ba){var Ka=
ba.keyString,nb=ba.value,xb=ba.target,Dc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[""+(nb?nb.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(Fc){var ud;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return ud=new Oc.popovers.ShadowPopover({shadowValue:xb[Ka],hasFixedPosition:!0}),td.yield(ud.fadeIntoWorld(Fc.positionIn(xb.world())),2);Oc.connect(ud,"shadowValue",function(rd){xb[Ka]=rd;Dc.rerender()});
td.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(ba){var Ka=ba.keyString,nb=ba.value,xb=ba.target,Dc=ba.node,Fc=Oc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,ud={nativeCursor:"pointer",onMouseDown:function(td){var rd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zf){if(1==zf.nextAddress)return rd=new Oc.popovers.PointPopover({pointValue:xb[Ka],hasFixedPosition:!0}),zf.yield(rd.fadeIntoWorld(td.positionIn(xb.world())),2);Oc.connect(rd,"pointValue",function(Ye){xb[Ka]=
Ye;Dc.rerender()});zf.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" pt(",Object.assign({},ud),""+nb.x.toFixed(),Object.assign({fontColor:Fc},ud),",",Object.assign({},ud),""+nb.y.toFixed(),Object.assign({fontColor:Fc},ud),")",Object.assign({},ud)])}},{key:"renderLayoutControl",value:function(ba){var Ka=ba.valueString,nb=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(nb?Ka:"No Layout"),{onMouseDown:function(xb){}}])}},
{key:"renderColorControl",value:function(ba){var Ka=ba.node,nb=ba.gradientEnabled,xb=ba.valueString,Dc=ba.keyString,Fc=ba.value,ud=ba.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[Oc.morph({fill:Fc.valueOf?Fc.valueOf():Fc,extent:Oc.pt(15,15),borderColor:Oc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(Fc?Fc.valueOf?Fc.valueOf():xb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(td){var rd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zf){if(1==
zf.nextAddress)return rd=new Oc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:ud,fillValue:Fc,title:"Fill Control",gradientEnabled:nb}),zf.yield(rd.fadeIntoWorld(td.positionIn(ud.world())),2);Oc.connect(rd,"fillValue",function(Ye){ud[Dc]=Ye;Ka.rerender()});zf.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(ba){var Ka=ba.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+Ka,{}])}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5024,end:20444})}(Oc.DraggableTreeLabel);Oc.PropertyControl=Be;Oc.PropertyControl=Be;Oc.PropertyControl=Be;Oc.inspect=Tc;Oc.inspect=Tc;Oc.remoteInspect=re;Oc.remoteInspect=re;Oc.generateReferenceExpression=Ed;Oc.generateReferenceExpression=Ed;var Af=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cb=ab.hasOwnProperty("NumberControls")&&
"function"===typeof ab.NumberControls?ab.NumberControls:ab.NumberControls=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Oc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Oc.Color.transparent},width:{defaultValue:15},
fontColor:{derived:!0,set:function(ba){this.submorphs.map(function(Ka){return Ka.fontColor=ba})}},submorphs:{initialize:function(){this.submorphs=[Oc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Oc.rect(5,2,0,-6),fontSize:12}),Oc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Oc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23095,end:24127})}(Oc.Morph);(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cb=ab.hasOwnProperty("PropertyTree")&&"function"===typeof ab.PropertyTree?ab.PropertyTree:ab.PropertyTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,
Ja,[{key:"onDrag",value:function(ba){this._onDragHandler&&this._onDragHandler(ba)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25279,end:25389})})(Oc.Tree);Be=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),
Cb=ab.hasOwnProperty("Inspector")&&"function"===typeof ab.Inspector?ab.Inspector:ab.Inspector=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(ba){}},{key:"__after_deserialize__",value:function(ba,Ka,nb){var xb=this,Dc=new Oc.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:Oc.InspectionTree.forObject(null,this)}));this.addMorph(Dc,this.getSubmorphNamed("terminal toggler"));this.layout.col(0).row(1).group.morph=Dc;this.whenRendered().then(function(){xb.targetObject&&(xb.targetObject=xb.targetObject)});Qb._get(Object.getPrototypeOf(Cb.prototype),"__after_deserialize__",this).call(this,ba,Ka,nb)}},{key:"__additionally_serialize__",value:function(ba,Ka,nb,xb){ba=ba.props.submorphs.value;for(Ka=ba.length;Ka--;)nb.refForId(ba[Ka].id).realObj==this.ui.propertyTree&&
Oc.arr.removeAt(ba,Ka)}},{key:"renderDraggableTreeLabel",value:function(ba){return new Oc.DraggableTreeLabel(ba)}},{key:"renderPropertyControl",value:function(ba){return Oc.PropertyControl.render(ba)}},{key:"onLoad",value:function(){var ba=this.ui,Ka=ba.codeEditor,nb=ba.thisBindingSelector,xb=ba.propertyTree;Ka.changeEditorMode("js").then(function(){return Ka.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==nb.selection?Ka.owner.selectedContext:Ka.owner.targetObject},
get systemInterface(){return Oc.Path("treeData.systemInterface").get(xb)},format:"esm"}}).catch(function(Dc){return $world.logError(Dc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(ba){Qb._get(Object.getPrototypeOf(Cb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);ba=this.ui;var Ka=ba.targetPicker,nb=ba.propertyTree,xb=ba.resizer,Dc=ba.terminalToggler,Fc=ba.unknowns,ud=ba.internals,td=ba.searchField,rd=ba.codeEditor,zf=ba.fixImportButton,Ye=ba.thisBindingSelector;
rd.changeEditorMode("js").then(function(){return rd.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Ye.selection?rd.owner.selectedContext:rd.owner.targetObject},get systemInterface(){return nb.treeData.systemInterface},format:"esm"}}).catch(function(Zf){return $world.logError(Zf)});Oc.connect(Ka,"onMouseDown",this,"selectTarget");Oc.connect(nb,"onScroll",this,"repositionOpenWidget");Oc.connect(xb,"onDrag",this,"adjustProportions");Oc.connect(Dc,"onMouseDown",
this,"toggleCodeEditor");Oc.connect(Fc,"trigger",this,"filterProperties");Oc.connect(ud,"trigger",this,"filterProperties");Oc.connect(td,"searchInput",this,"filterProperties");Oc.connect(nb,"nodeCollapseChanged",this,"filterProperties");Oc.connect(this,"extent",this,"relayout");Oc.connect(Ye,"selection",this,"bindCodeEditorThis");Oc.connect(zf,"fire",rd,"execCommand",{updater:function(Zf){return Zf("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",
value:function(){var ba=this.ui.propertyTree.selectedIndex-1,Ka=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Ka=this.ui.propertyTree.document.getLine(ba).textAndAttributes.slice(0,4).concat(Ka.display(this));ba=this.ui.propertyTree.lineRange(ba,!1);this.ui.propertyTree.replace(ba,Ka,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&
this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var ba=Oc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(ba!=this.lastChange||this.lastSubmorphs!=Oc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==ba.prop&&this.repositionOpenWidget(),this.lastChange=ba,this.lastSubmorphs=Oc.printValue(this.targetObject&&
this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var ba;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Ka){Ka=Ka.node;Ka.target&&(ba=Ka.foldableNode?Ka.target[Ka.foldableNode.key][Ka.key]:Ka.target[Ka.key],!Oc.obj.equals(ba,Ka.value)&&Ka.refreshProperty&&Ka.refreshProperty(ba))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",
value:function(ba,Ka){Ka=void 0===Ka?!1:Ka;var nb=this,xb,Dc,Fc,ud,td,rd,zf,Ye,Zf,vh,Hi,Nh,pj,Gh,xk;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ng){switch(Ng.nextAddress){case 1:if(!nb.isUpdating()){Ng.jumpTo(2);break}return Ng.yield(nb.whenUpdated(),2);case 2:xb=Oc.promise.deferred();Dc=xb.promise;Fc=!!nb.target;nb.updateInProgress=Dc;Ng.setCatchFinallyBlocks(4);Ka&&(ud=Oc.LoadingIndicator.open("connecting to remote..."));if(!Ka){td=Oc.InspectionTree.forObject(ba,nb);Ng.jumpTo(6);
break}return Ng.yield(Oc.RemoteInspectionTree.forObject(ba,nb),7);case 7:td=Ng.yieldResult;case 6:return rd=td,zf=nb.ui.propertyTree,Ng.yield(rd.collapse(rd.root,!1),8);case 8:if(!rd.root.children){Ng.jumpTo(9);break}return Ng.yield(rd.collapse(rd.root.children[0],!1),9);case 9:if(Ye=nb.originalTreeData&&nb.originalTreeData.diff(rd)){Zf=$jscomp.makeIterator(Ye);for(vh=Zf.next();!vh.done;vh=Zf.next())Hi=vh.value,Nh=$jscomp.makeIterator(Hi),pj=Nh.next().value,Gh=Nh.next().value,pj.refreshProperty(Gh.value);
Ng.jumpTo(11);break}zf.treeData=rd;return Ng.yield(nb.filterProperties(),12);case 12:if(!zf.treeData.root.isCollapsed){Ng.jumpTo(13);break}return Ng.yield(zf.onNodeCollapseChanged({node:rd.root,isCollapsed:!1}),14);case 14:zf.selectedIndex=1;case 13:return Ng.yield(zf.execCommand("uncollapse selected node"),11);case 11:nb.toggleWindowStyle(Fc);ud&&ud.remove();Ng.leaveTryBlock(5);break;case 4:xk=Ng.enterCatchBlock(),nb.showError(xk);case 5:nb.startStepping(1E3,"refreshAllProperties"),nb.updateInProgress=
null,Ng.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(ba){ba=void 0===ba?!0:ba;var Ka=this,nb,xb,Dc,Fc,ud;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){if(1==td.nextAddress)return nb=300,Fc=Ka.ui.codeEditor.pluginFind(function(rd){return rd.runEval}),ud=Ka.getWindow(),td.yield(Fc.runEval("System.get('@system-env').node"),2);td.yieldResult.value?(Dc=[].concat($jscomp.arrayFromIterable(Oc.arr.without(ud.styleClasses,"local")),["node"]),xb=Oc.DarkTheme.instance):(Dc=["local"].concat($jscomp.arrayFromIterable(ud?
Oc.arr.without(ud.styleClasses,"node"):[])),xb=Oc.DefaultTheme.instance);Fc.theme=xb;ba?(ud&&ud.animate({duration:nb,styleClasses:Dc}),Ka.ui.codeEditor.animate({fill:xb.background,duration:nb})):ud&&(ud.styleClasses=Dc);Ka.ui.codeEditor.textString=Ka.ui.codeEditor.textString;Fc.highlight();td.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},
{key:"build",value:function(){var ba=this,Ka=Object.assign({type:"text",borderWidth:1,borderColor:Oc.Color.gray,lineWrapping:"by-chars"},Oc.config.codeEditor.defaultStyle,{textString:""}),nb=Oc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Oc.rect(0,0,this.width,30);var xb=new Oc.SearchField({styleClasses:["idle"],name:"searchField"});nb[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[xb,{type:"button",name:"targetPicker",padding:Oc.rect(2,2,0,0),borderRadius:15,
master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Oc.Icon.textAttribute("crosshairs")},new Oc.LabeledCheckBox({label:"Internals",name:"internals"}),new Oc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Oc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Oc.InspectionTree.forObject(null,this)})),Oc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},Ka),{name:"fix import button",
type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Oc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(nb),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(nb),[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){ba.ui.thisBindingSelector.selection=
"target"})}},{key:"selectTarget",value:function(){var ba=this,Ka,nb,xb,Dc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fc){switch(Fc.nextAddress){case 1:if(ba.env.eventDispatcher.isKeyPressed("Shift"))return nb=$jscomp,xb=nb.makeIterator,Fc.yield($world.execCommand("select morph",{justReturn:!0}),5);ba.toggleSelectionInstructions(!0);return Fc.yield(Oc.InteractiveMorphSelector.selectMorph(),4);case 4:Ka=Fc.yieldResult;ba.toggleSelectionInstructions(!1);Fc.jumpTo(3);break;case 5:Dc=
xb.call(nb,Fc.yieldResult),Ka=Dc.next().value;case 3:Ka&&(ba.targetObject=Ka),Fc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(ba){if(ba&&!this.instructionWidget){var Ka=Oc.morph({type:"label",name:"escapeKey",value:"esc"});Ka.whenRendered().then(function(){return Ka.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",
{},Ka,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(ba){ba=ba.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;ba.epiMorph=!0;this.openWidget=ba;Oc.once(ba,"close",this,"closeOpenWidget");Oc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",
value:function(){var ba=this.ui.propertyTree,Ka=ba.textLayout.boundsFor(ba,{column:0,row:ba.selectedIndex-1});Ka=ba.worldPoint(Oc.pt(Ka.x,Ka.y+Ka.height/2)).addPt(ba.scroll.negated());ba=ba.globalBounds();Ka.x=this.globalBounds().center().x;Ka.y<ba.top()?Ka=ba.topCenter():ba.bottom()-20<Ka.y&&(Ka=ba.bottomCenter().addXY(0,-20));return Ka}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",
value:function(ba){this.layout.row(1).height+=ba.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(ba){if(ba!==this.isEditorVisible()){var Ka=this.extent,nb=this.layout,xb=this.ui,Dc=xb.terminalToggler,Fc=xb.codeEditor,ud=xb.thisBindingSelector;xb=xb.fixImportButton;nb.disable();ba?(Dc.fontColor=Oc.Color.rgbHex("00e0ff"),nb.row(3).height=this.codeEditorHeight||180,nb.row(2).height=5,xb.animate({visible:!0,
duration:200}),ud.animate({visible:!0,duration:200})):(this.codeEditorHeight=nb.row(3).height,Dc.fontColor=Oc.Color.white,nb.row(3).height=nb.row(2).height=0,xb.animate({visible:!1,duration:200}),ud.animate({visible:!1,duration:200}));this.extent=Ka;nb.enable({duration:200});this.relayout({duration:200});Fc.focus();Fc.animate({opacity:ba?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){ba.makeEditorVisible(!ba.isEditorVisible());
Ka.jumpToEnd()})}},{key:"filterProperties",value:function(){var ba=this,Ka,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress)return Ka=ba.ui.searchField,nb=ba.ui.propertyTree,ba.originalTreeData||(ba.originalTreeData=nb.treeData),Oc.disconnect(nb.treeData,"onWidgetOpened",ba,"onWidgetOpened"),xb.yield(nb.treeData.filter({maxDepth:2,showUnknown:ba.ui.unknowns.checked,showInternal:ba.ui.internals.checked,iterator:function(Dc){return Ka.matches(Dc.key)}}),2);nb.update();
Oc.connect(nb.treeData,"onWidgetOpened",ba,"onWidgetOpened");xb.jumpToEnd()})}},{key:"relayout",value:function(ba){ba=void 0===ba?{}:ba;var Ka=this,nb,xb,Dc,Fc,ud,td,rd,zf,Ye;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zf){Ka.layout&&Ka.layout.forceLayout();nb=Ka;xb=nb.ui;Dc=xb.fixImportButton;Fc=xb.terminalToggler;ud=xb.propertyTree;td=xb.thisBindingSelector;rd=ud.bounds().insetBy(5).bottomLeft();zf=ud.bounds().insetBy(5).bottomRight();Ye=zf.subXY(Dc.width+10,0);td.width=115;td.listMorph.itemHeight=
20;ba.duration?(Fc.animate(Object.assign({bottomLeft:rd},ba)),Dc.animate(Object.assign({bottomRight:zf},ba)),td.animate(Object.assign({bottomRight:Ye},ba))):(Fc.bottomLeft=rd,Dc.bottomRight=zf,td.bottomRight=Ye);Zf.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Qb._get(Object.getPrototypeOf(Cb.prototype),"keybindings",
this))}},{key:"commands",get:function(){return Oc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(ba){ba=new this(ba);ba.openInWindow();return ba}},{key:"properties",get:function(){return{extent:{defaultValue:Oc.pt(400,500)},fill:{defaultValue:Oc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(ba){this.setProperty("remoteTarget",
ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ba,!0))}},targetObject:{after:["submorphs"],set:function(ba){this._serializableTarget=ba&&ba.isMorph?ba.id:ba;this.setProperty("targetObject",ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ba))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var ba=this.ui.propertyTree,Ka=ba.selectedNode;ba=ba.treeData;return ba.getContextFor(Ka?Ka:ba.root)}},
submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),
searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Oc.Color.gray,fontSize:14,fontFamily:Oc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25406,end:45571})}(Oc.Morph);Be=Oc.Inspector;Qe=Da("I",Be);Oc.default=Be;var qg=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");qg.Inspector=Qe;qg.string=pd;qg.Morph=Bc;qg.pt=be;qg.Color=Bb;Be=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ja,ab,Cb){Cb=void 0===Cb?1:Cb;var ba,
Ka,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){switch(xb.nextAddress){case 1:return Ja.maybeSelectCommentOrLine(),xb.setCatchFinallyBlocks(2),ab=Object.assign({},ab,{logDoit:!0,inspect:!0,inspectDepth:Cb}),xb.yield(Ja.doEval(void 0,ab),4);case 4:ba=xb.yieldResult;Ka=ba.error?ba.error:ba.isError?ba.value:null;xb.leaveTryBlock(3);break;case 2:Ka=nb=xb.enterCatchBlock();case 3:return Ka?Ja.showError(Ka):Ja.setStatusMessage(qg.string.truncate(ba.value,1E3)),xb.return(ba)}})}},{name:"eval all",
doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ja,ab){var Cb,ba,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nb){switch(nb.nextAddress){case 1:return nb.setCatchFinallyBlocks(2),nb.yield(Ja.doEval({start:{row:0,column:0},end:Ja.documentEndPosition},Object.assign({},ab,{logDoit:!0})),4);case 4:Cb=nb.yieldResult;ba=Cb.error?Cb.error:Cb.isError?Cb.value:null;nb.leaveTryBlock(3);break;case 2:ba=Ka=nb.enterCatchBlock();case 3:return ba?Ja.showError(ba):
Ja.setStatusMessage(String(Cb.value)),nb.return(Cb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ja,ab){var Cb,ba,Ka,nb,xb,Dc,Fc,ud;return $jscomp.asyncExecutePromiseGeneratorProgram(function(td){switch(td.nextAddress){case 1:return Ja.maybeSelectCommentOrLine(),td.setCatchFinallyBlocks(2),ab=Object.assign({},ab,{asString:!1,logDoit:!0}),td.yield(Ja.doEval(void 0,ab),4);case 4:Cb=td.yieldResult;ba=Cb.error?
Cb.error:Cb.isError?Cb.value:null;td.leaveTryBlock(3);break;case 2:ba=Ka=td.enterCatchBlock();case 3:Ja.selection.collapseToEnd();if(nb=Cb.value&&Cb.value.isColor)return Ja.selection.text=String(Cb.value),xb=new qg.Morph({fill:qg.Color.transparent,extent:qg.pt(Ja.fontSize+2,Ja.fontSize+2),submorphs:[{fill:Cb.value,center:qg.pt(Ja.fontSize+2,Ja.fontSize+2).scaleBy(.5)}]}),Dc=Ja.selection.start,Fc=Dc.column,ud=Dc.row,Ja.insertText([xb,{}],Ja.selection.start),Ja.selection.start={column:Fc,row:ud},Ja.focus(),
td.return(Cb);Ja.insertTextAndSelect(ba?String(ba)+(ba.stack?"\n"+ba.stack:""):String(Cb.value));Ja.focus();return td.return(Cb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ja,ab){var Cb,ba,Ka,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){switch(xb.nextAddress){case 1:debugger;Ja.maybeSelectCommentOrLine();ba=Ja.textInRange(Ja.selection);Ka=Ja.evalEnvironment||{};nb=Ja.pluginFind(function(Dc){return Dc.isEditorPlugin&&
"function"===typeof Dc.runEval});Ka.systemInterface||(Ka.systemInterface=nb.systemInterface(ab));if("local"!==Ka.systemInterface.name){xb.jumpTo(2);break}xb.setCatchFinallyBlocks(3);return xb.yield(Ja.doEval(void 0,ab),5);case 5:Cb=xb.yieldResult;ba=Cb.value;xb.leaveTryBlock(2);break;case 3:xb.enterCatchBlock();case 2:return Ja.world().execCommand("open object editor",{target:ba,evalEnvironment:Ka}),xb.return(Cb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",
exec:function(Ja,ab){var Cb,ba,Ka,nb,xb,Dc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fc){switch(Fc.nextAddress){case 1:Ja.maybeSelectCommentOrLine();Ka=Ja.textInRange(Ja.selection);nb=Ja.evalEnvironment||{};xb=Ja.pluginFind(function(ud){return ud.isEditorPlugin&&"function"===typeof ud.runEval});nb.systemInterface||(nb.systemInterface=xb.systemInterface(ab));if("local"!==nb.systemInterface.name){qg.Inspector.openInWindow({remoteTarget:{code:Ka,evalEnvironment:nb}});Fc.jumpTo(2);break}Fc.setCatchFinallyBlocks(3);
return Fc.yield(Ja.doEval(void 0,ab),5);case 5:Cb=Fc.yieldResult;ba=Cb.error?Cb.error:Cb.isError?Cb.value:null;Ka=Cb.value;Fc.leaveTryBlock(4);break;case 3:ba=Dc=Fc.enterCatchBlock();case 4:qg.Inspector.openInWindow({targetObject:ba?ba:Ka});case 2:return Fc.return(Cb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",handlesCount:!0,exec:function(Ja,ab,Cb){Cb=void 0===Cb?1:Cb;
var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){switch(Ka.nextAddress){case 1:return Ja.maybeSelectCommentOrLine(),Ka.setCatchFinallyBlocks(2),ab=Object.assign({},ab,{inspect:!0,inspectDepth:Cb,logDoit:!0}),Ka.yield(Ja.doEval(void 0,ab),4);case 4:ba=Ka.yieldResult;Ka.leaveTryBlock(3);break;case 2:Ka.enterCatchBlock();case 3:return Ja.selection.collapseToEnd(),Ja.insertTextAndSelect(ba.value),Ka.return(ba)}})}}];qg.codeEvaluationCommands=Be;qg.codeEvaluationCommands=Be;qg.codeEvaluationCommands=
Be;var sg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");sg.changeAttributeInSelectionOrMorph=function(Ja,ab,Cb){var ba=Ja.selection;Ja.keepPosAtSameScrollOffsetWhile(function(){ba.isEmpty()?Ja[ab]="function"===typeof Cb?Cb(Ja[ab]):Cb:(Ja.undoManager.group(),Ja.changeStyleProperty(ab,function(Ka){return"function"===typeof Cb?Cb(Ka):Cb}),Ja.undoManager.group())})};Qe=[{name:"increase font size",scrollCursorIntoView:!1,exec:function(Ja){var ab=Ja.fontSize;sg.changeAttributeInSelectionOrMorph(Ja,
"fontSize",function(Cb){Cb=Cb||ab;return Cb+(18<=Cb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ja){var ab=Ja.fontSize;sg.changeAttributeInSelectionOrMorph(Ja,"fontSize",function(Cb){Cb=Cb||ab;return Cb-(18>=Cb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ja){var ab,Cb,ba,Ka,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress){ab=["serif","sans-serif","monospace"];if(Cb=localStorage["lively.morpic/text-change-font-additional-fonts"])Cb=
JSON.parse(Cb),ab.push.apply(ab,$jscomp.arrayFromIterable(Cb));ab.map(function(Dc){return Dc.toLowerCase()}).includes(Ja.fontFamily.toLowerCase())||(ab.push(Ja.fontFamily),Cb=[].concat($jscomp.arrayFromIterable(Cb||[]),[Ja.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Cb));return xb.yield($world.editListPrompt("choose font",ab,{requester:Ja,preselect:ab.indexOf(Ja.fontFamily),historyId:"lively.morpic/text-change-font-hist"}),2)}ba=xb.yieldResult;Ka=$jscomp.makeIterator(ba.selections);
if(nb=Ka.next().value)Ja.fontFamily=nb;return xb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ja,ab){ab=void 0===ab?{}:ab;var Cb,ba,Ka,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress){if(ab.hasOwnProperty("link"))return xb.jumpTo(2);ba=Ja.selection;Ka=Ja.getStyleInRange(ba);nb=Ka.link;return xb.yield(Ja.world().prompt("Set link",{input:nb||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=xb.nextAddress&&
(Cb=xb.yieldResult,!Cb))return xb.return();Ja.undoManager.group();Ja.setStyleInRange({link:Cb||void 0},ba);Ja.undoManager.group();xb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ja,ab){var Cb,ba,Ka,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress)return Cb=Ja.selection,ba=Ja.getStyleInRange(Cb),Ka=ba.doit,xb.yield(Ja.world().editPrompt("Enter doit code (runs on clicking the text)",{requester:Ja,input:Ka?Ka.code:"// empty doit",
historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ja.evalEnvForDoit(Ka||{})}),2);nb=xb.yieldResult;Ja.undoManager.group();nb?Ja.addTextAttribute({doit:{code:nb},nativeCursor:"pointer",textDecoration:"underline"},Cb):Ja.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Cb);Ja.undoManager.group();xb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ja,ab){ab=void 0===ab?{}:ab;Ja.undoManager.group();ab=!ab.onlySelection&&Ja.selection.isEmpty()?
Ja.documentRange:Ja.selection.range;Ja.setStyleInRange(null,ab);Ja.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ja){var ab,Cb,ba,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nb){if(1==nb.nextAddress)return nb.yield(System.import("lively.modules"),2);if(3!=nb.nextAddress)return ab=nb.yieldResult,Cb=ab.module,nb.yield(Cb("lively.ide/text/ui.js").load(),3);ba=nb.yieldResult;Ka=ba.RichTextControl;return nb.return(Ka.openFor(Ja))})}}];sg.commands=
Qe;sg.commands=Qe;sg.commands=Qe;var ff=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");ff.guessTextModeName=Nb;ff.rangedToken=function(Ja,ab,Cb,ba,Ka){return{start:{row:Ja,column:ab},end:{row:Ja,column:Cb},token:ba,mode:Ka}};ff.fun=Ic;ff.arr=hc;ff.connect=Mc;ff.disconnect=Lb;ff.DefaultTheme=Mb;ff.tokenizeDocument=lb;ff.modeInfo=Ba;ff.visitDocumentTokens=fd;ff.getMode=tc;ff.completionCommands=ya;ff.multiSelectCommands=Cc;ff.navCommands=ee;ff.codeCommands=Ze;ff.codeEvaluationCommands=
Be;ff.richTextCommands=Qe;ff.Color=Bb;ff.Range=ke;ff.guessTextModeName=Nb;ff.guessTextModeName=Nb;Mb=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Cb=ab.hasOwnProperty("EditorPlugin")&&"function"===typeof ab.EditorPlugin?ab.EditorPlugin:ab.EditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Qb(Cb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
ff.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(ba){var Ka=this;this.textMorph=ba;ff.connect(ba,"textChange",this,"onTextChange");ff.connect(ba,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Ka.highlight()})}},
{key:"detach",value:function(ba){ff.disconnect(ba,"textChange",this,"onTextChange");ff.disconnect(ba,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(ba){this._ast=null;if(ba){var Ka=this._tokenizerValidBefore;if("replace"===ba.selector){var nb=ba.args[0].start;ba=nb.row;nb=nb.column}else nb=ba=0;if(!Ka||ba<Ka.row||ba===Ka.row&&nb<Ka.column)ba=Math.max(0,ba),this._tokenizerValidBefore={row:ba,
column:nb}}this.requestHighlight()}},{key:"requestHighlight",value:function(ba){var Ka=this;(void 0===ba?0:ba)?this.highlight():ff.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return Ka.highlight()})()}},{key:"highlight",value:function(){var ba=this.textMorph,Ka=this.theme,nb=this.mode,xb=this._tokenizerValidBefore;if(Ka&&ba&&ba.document&&nb){ba.fill=Ka.background;ba.cursorColor=Ka.cursorColor||ff.Color.black;var Dc=ba.viewState,Fc={};xb=ff.tokenizeDocument(nb,ba.document,Dc.firstVisibleRow,
Dc.lastVisibleRow,xb);nb=xb.lines;xb=xb.tokens;if(nb.length){Dc=nb[0].row;for(var ud=[],td=0;td<xb.length;Dc++,td++)for(var rd=xb[td],zf=0;zf<rd.length;zf+=5){var Ye=rd[zf],Zf=rd[zf+1],vh=Ka[rd[zf+2]]||Ka.default;vh&&ud.push({start:{row:Dc,column:Ye},end:{row:Dc,column:Zf}},vh)}ba.embeddedMorphs.forEach(function(Hi){var Nh=ba.embeddedMorphMap.get(Hi).anchor;Fc[Hi.id]=ba.textAttributeAt(Nh.position)});ba.setTextAttributesWithSortedRanges(ud);ba.embeddedMorphs.forEach(function(Hi){var Nh=ba.embeddedMorphMap.get(Hi).anchor;
Nh=ff.Range.at(Nh.position);Nh.end.column+=1;ba.replace(Nh,[Hi,Fc[Hi.id]],!1)});this._tokenizerValidBefore={row:ff.arr.last(nb).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},ba,this)}}},{key:"visitTokensInRange",value:function(ba,Ka){var nb=ba.start,xb=ba.end,Dc=nb.row-1;ff.visitDocumentTokens(this.mode,this.textMorph.document,nb.row,xb.row,null,function(Fc){return Dc++},function(Fc,ud,td,rd,zf,Ye,Zf){if(Dc===nb.row&&0<nb.column){if(nb.column>=rd)return;td<nb.column&&nb.column<
rd&&(td=nb.column)}if(Dc===xb.row){if(xb.column<=td)return;td<xb.column&&xb.column<rd&&(rd=xb.column)}Ka(Fc,ud,Dc,td,rd,zf,Ye,Zf)})}},{key:"tokensInRange",value:function(ba){var Ka=[];this.visitTokensInRange(ba,function(nb,xb,Dc,Fc,ud,td,rd,zf){return Ka.push(ff.rangedToken(Dc,Fc,ud,nb,zf))});return Ka}},{key:"tokensOfRow",value:function(ba){var Ka=this.textMorph.getLine(ba).length;return this.tokensInRange({start:{row:ba,column:0},end:{row:ba,column:Ka}})}},{key:"tokenAt",value:function(ba){for(var Ka=
this.tokensOfRow(ba.row),nb=Ka.length;nb--;){var xb=Ka[nb];if(xb.token&&xb.start.column<=ba.column&&ba.column<=xb.end.column)return xb}return null}},{key:"getCommands",value:function(ba){return[].concat($jscomp.arrayFromIterable(ba),$jscomp.arrayFromIterable(ff.completionCommands),$jscomp.arrayFromIterable(ff.multiSelectCommands),$jscomp.arrayFromIterable(ff.navCommands),$jscomp.arrayFromIterable(ff.codeCommands),$jscomp.arrayFromIterable(ff.codeEvaluationCommands),$jscomp.arrayFromIterable(ff.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var ba=this.mode,Ka=ba.lineComment,nb=ba.blockCommentStart;ba=ba.blockCommentEnd;var xb={};Ka&&(xb.lineCommentStart=Ka);nb&&(xb.blockCommentStart=nb);ba&&(xb.blockCommentEnd=ba);return xb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(ba,Ka,nb){var xb=this.textMorph,Dc=ba.row,Fc=ba.column;ba=Ka[Fc-1];Ka=Ka[Fc];xb.selection.text="\n";xb.selection.collapseToEnd();
"{"===ba&&"}"===Ka&&(xb.selection.text="\n"+" ".repeat(nb),xb.selection.collapse());xb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Dc+1,lastRow:Dc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var ba=this.textMorph,Ka=this.openPairs,nb=ba.selection,xb=ba.getLine(nb.end.row),
Dc=xb[nb.end.column-1];xb=xb[nb.end.column];ba.autoInsertPairs&&nb.isEmpty()&&Dc in Ka&&xb===Ka[Dc]&&(nb.growRight(1),nb.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(ba){var Ka=this.openPairs,nb=this.closePairs,xb=this.textMorph,Dc=xb.selection,Fc=xb.autoInsertPairs&&ba in Ka,ud=xb.autoInsertPairs&&ba in nb;if(!Fc&&!ud)return!1;var td=xb.getLine(Dc.end.row)[Dc.end.column];if(!Dc.isEmpty()){if(!Fc)return!1;nb=xb.undoManager.ensureNewGroup(xb);xb.insertText(Ka[ba],Dc.end);xb.insertText(ba,
Dc.start);xb.undoManager.group(nb);Dc.growRight(-1);return!0}if(td in nb&&ba===td)return Dc.goRight(1),!0;if(ud&&!Fc)return!1;nb=xb.undoManager.ensureNewGroup(xb);xb.insertText(ba+Ka[ba]);xb.undoManager.group(nb);Dc.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],ab,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);Ba=Mb=ff.EditorPlugin;ya=Da("C",function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Cb=ab.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof ab.CodeMirrorEnabledEditorPlugin?ab.CodeMirrorEnabledEditorPlugin:ab.CodeMirrorEnabledEditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Qb(Cb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(){Qb._get(Object.getPrototypeOf(Cb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(ba){this.mode=this.codeMirrorMode(ba);return Qb._get(Object.getPrototypeOf(Cb.prototype),"attach",this).call(this,ba)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",
value:function(ba){return{indentWithTabs:!ba.useSoftTabs,indentUnit:ba.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(ba){ba=this.defaultCodeMirrorModeConfig(ba);return ff.getMode(ba,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],ab,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(ff.EditorPlugin));ff.CodeMirrorEnabledEditorPlugin=ya;ff.CodeMirrorEnabledEditorPlugin=ya;ff.CodeMirrorEnabledEditorPlugin=ya;ff.default=Mb;Mb=Object.freeze({__proto__:null,guessTextModeName:Nb,"default":Ba,CodeMirrorEnabledEditorPlugin:ya});Da("e",Mb)}}});
System.register(["./__root_module__-073d42f8.js","kld-intersections","./index-ae6defdd.js","./index-88d60c6b.js","./editor-plugin-4637c93d.js"],function($a){var Vb,jc,Wc,wc,Ud,Kd,he,xd,gd,Ld,Pd,af,bf,Ve,Ad,xe,qc,td,be,Bd,pe,Se,nc,$c,ge;return{setters:[function(ad){Vb=ad.i;jc=ad.bJ;Wc=ad.bK;wc=ad.bL;Ud=ad.bM;Kd=ad.bN;he=ad.d;xd=ad.a1;gd=ad.c;Ld=ad.a6;Pd=ad.bz;af=ad.b;bf=ad.a;Ve=ad.bO;Ad=ad.a_},function(){},function(ad){xe=ad.s},function(ad){qc=ad.localInterface;td=ad.systemInterfaceNamed;be=ad.serverInterfaceFor;
Bd=ad.l2lInterfaceFor},function(ad){pe=ad.p;Se=ad.d;nc=ad.a;$c=ad.r;ge=ad.C}],execute:function(){var ad=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");ad.warnStyle={"border-bottom":"2px dotted orange"};ad.errorStyle={"background-color":"red"};var ie=function(vc){var Oc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),pc=Oc.hasOwnProperty("JavaScriptChecker")&&"function"===typeof Oc.JavaScriptChecker?Oc.JavaScriptChecker:Oc.JavaScriptChecker=function(bb){bb&&bb[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(pc,vc,[{key:"uninstall",value:function(bb){var Ma=bb.text||bb;(Ma.markers||[]).forEach(function(oa){return oa.id.startsWith("js-checker-")&&Ma.removeMarker(oa)});Ma.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(bb,Ma){return[].concat($jscomp.arrayFromIterable(bb.embeddedMorphMap.values())).find(function(oa){return Ma.containsPosition(oa.anchor.position)})}},{key:"onDocumentChange",value:function(bb,
Ma,oa){var La=Ma.document;try{var Ua=oa.parse()}catch(Sb){Ua=Sb}Ua&&(bb=(Ma.markers||[]).filter(function(Sb){return Sb.id.startsWith("js-checker-")}),oa=oa.undeclaredVariables().map(function(Sb,Ca){var Va=Sb.start;Sb=Sb.end;Va=La.indexToPosition(Va);Sb=La.indexToPosition(Sb);return Ma.addMarker({id:"js-checker-"+Ca,style:ad.warnStyle,range:{start:Va,end:Sb},type:"js-undeclared-var"})}),bb.slice(oa.length).forEach(function(Sb){return Ma.removeMarker(Sb)}),Ua.parseError?(bb=Ua.parseError.loc,oa=bb.column,
bb=bb.line-1,Ua=La.indexToPosition(Ua.parseError.pos),oa=Ua.column,bb=Ua.row,Ua={start:{column:oa-1,row:bb},end:{column:oa+1,row:bb}},this.hasEmbeddedMorphInRange(Ma,Ua)||Ma.addMarker({id:"js-syntax-error",range:Ua,style:ad.errorStyle,type:"js-syntax-error"})):Ma.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],Oc,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),Yb=ie=ad.JavaScriptChecker;ad.default=ie;var zb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");zb.query=jc;zb.fuzzyParse=Wc;zb.acorn=wc;zb.custom=Ud;zb.walk=Kd;var Rc=function(vc){var Oc=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),pc=Oc.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof Oc.JavaScriptNavigator?
Oc.JavaScriptNavigator:Oc.JavaScriptNavigator=function(bb){bb&&bb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(pc,vc,[{key:"ensureAST",value:function(bb){return this.parse(bb.textString)}},{key:"parse",value:function(bb){return zb.fuzzyParse(bb)}},{key:"move",value:function(bb,Ma){var oa=!!Ma.activeMark||!Ma.selection.isEmpty(),La=Ma.selection,Ua=Ma.positionToIndex(La.lead);bb=this[bb](Ma.textString,Ua);bb=Ma.indexToPosition(bb);
La.lead=bb;oa||(La.anchor=bb);Ma.scrollCursorIntoView()}},{key:"forwardSexp",value:function(bb){this.move("_forwardSexp",bb)}},{key:"backwardSexp",value:function(bb){this.move("_backwardSexp",bb)}},{key:"backwardUpSexp",value:function(bb){this.move("_backwardUpSexp",bb)}},{key:"forwardDownSexp",value:function(bb){this.move("_forwardDownSexp",bb)}},{key:"_forwardSexp",value:function(bb,Ma){bb=this.parse(bb);bb=zb.custom.findNodesIncluding(bb,Ma).reverse().find(function(La){return La.end!==Ma});if(!bb)return Ma;
if("BlockStatement"===bb.type){var oa=bb.body.find(function(La){return La.start>Ma});if(oa)return oa.start}return bb.end}},{key:"_backwardSexp",value:function(bb,Ma){bb=this.parse(bb);bb=zb.custom.findNodesIncluding(bb,Ma).reverse().find(function(La){return La.start!==Ma});if(!bb)return Ma;if("BlockStatement"===bb.type){var oa=bb.body.slice().reverse().find(function(La){return La.end<Ma});if(oa)return oa.end}return bb?bb.start:Ma}},{key:"_backwardUpSexp",value:function(bb,Ma){bb=this.parse(bb);return(bb=
zb.custom.findNodesIncluding(bb,Ma).reverse().find(function(oa){return oa.start!==Ma}))?bb.start:Ma}},{key:"_forwardDownSexp",value:function(bb,Ma){bb=this.parse(bb);return(bb=zb.walk.findNodeAfter(bb,Ma,function(oa,La){return La.start>Ma}))?bb.node.start:Ma}},{key:"markDefun",value:function(bb){var Ma=this.rangeForFunctionOrDefinition(bb.textString,[bb.positionToIndex(bb.selection.range.start),bb.positionToIndex(bb.selection.range.end)]);Ma&&bb.execCommand("expandRegion",{start:Ma[0],end:Ma[1]})}},
{key:"rangeForNodesMatching",value:function(bb,Ma,oa){bb=this.parse(bb);return(Ma=zb.custom.findNodesIncluding(bb,Ma).reverse().find(oa))?[Ma.start,Ma.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(bb,Ma){var oa=Ma[0]===Ma[1];return this.rangeForNodesMatching(bb,Ma[1],function(La){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(La.type)&&(oa&&La.end!==Ma[1]||!oa&&La.start<Ma[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(bb,
Ma){"number"!==typeof Ma&&(Ma=bb.positionToIndex(Ma));bb=this.ensureAST(bb);var oa=zb.query.nodesAt(Ma,bb).reverse(),La=oa.find(function(Sb){return"Identifier"===Sb.type});if(!La&&((oa=oa[0])&&oa.type.includes("Specifier")&&oa.local&&"Identifier"===oa.local.type&&(La=oa.local),!La))return;Ma=(oa=zb.query.findDeclarationClosestToIndex(bb,La.name,Ma))?zb.query.scopeAtIndex(bb,oa.start):zb.query.scopeAtIndex(bb,Ma);var Ua=zb.query.findReferencesAndDeclsInScope(Ma,La.name).refs;return{parsed:bb,scope:Ma,
id:La,name:La.name,decl:oa,refs:Ua}}},{key:"expandRegion",value:function(bb,Ma,oa,La){function Ua(dc){dc=bb.positionToIndex({column:0,row:Ca.row});return{range:[dc+Va.start,dc+Va.start+Va.value.length],prev:La}}var Sb=La.range[0]!==La.range[1],Ca=bb.indexToPosition(La.range[0]),Va=bb.tokenAt(Ca);if(!Sb&&Va&&["keyword","identifier"].includes(Va.type))return Ua();oa=oa||this.parse(Ma);Ma=zb.query.nodesAtIndex(oa,La.range[0]).reverse().find(function(dc){return dc.start<La.range[0]||dc.end>La.range[1]});
if(!Ma)return La;oa=Ma.start;Sb=Ma.end;return"Literal"===Ma.type&&(Ma.raw||"").match(/^['"`]/)&&La.range[0]!==Ma.start&&La.range[1]!==Ma.end&&(Ma.start+1<La.range[0]||Ma.end-1>La.range[1])?{range:[oa+1,Sb-1],prev:La}:{range:[oa,Sb],prev:La}}},{key:"contractRegion",value:function(bb,Ma,oa,La){return La.prev||La}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],Oc,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:127,end:6784})}(void 0);ie=Rc=zb.JavaScriptNavigator;zb.default=Rc;var Mc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");Mc.addIndexToTextPos=function(vc,Oc,pc){return vc.indexToPosition(vc.positionToIndex(Oc)+pc)};Mc.connect=he;Mc.disconnect=xd;Mc.string=gd;Mc.KeyHandler=Ld;Mc.Range=Pd;Rc=function(vc){var Oc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),
pc=Oc.hasOwnProperty("Snippet")&&"function"===typeof Oc.Snippet?Oc.Snippet:Oc.Snippet=function(bb){bb&&bb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(pc,vc,[{key:Symbol.for("lively-instance-initialize"),value:function(bb){bb=void 0===bb?{trigger:null,expansion:""}:bb;var Ma=bb.expansion;this.trigger=bb.trigger;this.expansion=Ma;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(bb){this.isExpanding&&
(this.textMorph=bb,Mc.connect(this.textMorph,"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(bb){this.isExpanding&&(Mc.disconnect(bb,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var bb=this.expansionState,Ma=bb.startAnchor,oa=bb.endAnchor;bb.isExpanding?Mc.Range.fromPositions(Ma.position,oa.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",
value:function(){var bb=this.textMorph;if(bb){var Ma=this.expansionState||{},oa=Ma.marker,La=Ma.startAnchor,Ua=Ma.endAnchor;Ma=Ma.steps;La&&bb.removeAnchor(La);Ua&&bb.removeAnchor(Ua);oa&&bb.removeMarker(oa);Ma.forEach(function(Sb){return bb.removeAnchor(Sb.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};bb&&bb.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(bb){var Ma=
[],oa=0;Mc.string.reMatches(bb,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(La){var Ua=La.start,Sb=La.end;La=La.match;var Ca="";La.startsWith("${")?(Ca=$jscomp.makeIterator(La.match(/^\$\{([0-9]+):([^\}]*)\}/)),Ca.next(),La=Ca.next().value,Ca=Ca.next().value,La=Number(La)):La=Number(La.replace(/^\$/,""));bb=bb.slice(0,Ua-oa)+Ca+bb.slice(Sb-oa);Ma[La]={index:Ua-oa,prefill:Ca,anchor:null};oa+=Sb-Ua-Ca.length});return{steps:Ma,expansion:bb}}},{key:"expandAtCursor",value:function(bb){var Ma=bb.selection,
oa=bb.cursorPosition.column,La=this.expansion;this.trigger&&(oa-=this.trigger.length);if(oa=Math.max(0,oa))La=Mc.string.lines(La),La=[La[0]].concat($jscomp.arrayFromIterable(La.slice(1).map(function(sb){return Mc.string.indent(sb," ",oa)}))),La=La.join("\n");var Ua=this.createExpansionSteps(La);La=Ua.expansion;Ua=Ua.steps;this.trigger&&Ma.growLeft(this.trigger.length);Ma.text=La;var Sb=Ma.start;La=Ma.end;Ma.collapseToEnd();if(Ua.length){var Ca=Mc.string.newUUID();Ua.forEach(function(sb,od){return sb.anchor=
bb.addAnchor(Object.assign({id:"snippet-step-"+od+"-"+Ca},Mc.addIndexToTextPos(bb,Sb,sb.index)))});var Va=bb.addAnchor(Object.assign({id:"snippet-start-"+Ca},Sb,{insertBehavior:"stay"})),dc=bb.addAnchor(Object.assign({id:"snippet-end-"+Ca},La));this.expansionState={marker:bb.addMarker({id:"snippet-marker-"+Ca,get range(){return{start:Va.position,end:dc.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",
content:"fooooo"}}),startAnchor:Va,endAnchor:dc,stepIndex:0,steps:Ua,isExpanding:!0};bb.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var bb=this.expansionState,Ma=bb.steps,oa=this.textMorph;if(bb.isExpanding&&oa){oa=oa.selection;bb=Ma[bb.stepIndex];var La=bb.prefill;oa.lead=oa.anchor=bb.anchor.position;oa.growRight(La.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=Ma.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+
" done"))}}},{key:"canExpand",value:function(bb,Ma){Ma=bb.positionToIndex(bb.cursorPosition);return bb.textString.slice(Ma-this.trigger.length,Ma)===this.trigger}},{key:"tryTrigger",value:function(bb,Ma){if(!this.canExpand(bb,bb.cursorPosition))return!1;this.expandAtCursor(bb);return!0}},{key:"getCommands",value:function(bb){var Ma=this;return bb.concat([{name:"[snippet] next expansion step",exec:function(oa){Ma.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(oa){Ma.resetExpansionState();
return!0}}])}},{key:"getKeyHandlers",value:function(bb){return bb.concat(Mc.KeyHandler.withBindings([{keys:"Tab",command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],Oc,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:357,end:6029})}(void 0);Mc.Snippet=Rc;Mc.Snippet=Rc;Mc.Snippet=Rc;var tc=[{name:"get snippets",exec:function(vc){return vc.pluginCollect("getSnippets",[])}}];Mc.snippetCommands=tc;Mc.snippetCommands=tc;Mc.snippetCommands=tc;var Tc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");Tc.buildEvalOpts=function(vc,Oc){return vc.plugins.find(function(pc){return pc.isJSEditorPlugin}).sanatizedJsEnv(Oc)};Tc.Snippet=Rc;tc=function(vc){var Oc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),
pc=Oc.hasOwnProperty("ModuleTopLevelVarCompleter")&&"function"===typeof Oc.ModuleTopLevelVarCompleter?Oc.ModuleTopLevelVarCompleter:Oc.ModuleTopLevelVarCompleter=function(bb){bb&&bb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(pc,vc,[{key:"compute",value:function(bb,Ma){var oa,La,Ua,Sb,Ca,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(dc){if(1==dc.nextAddress){La=(oa=bb.pluginFind(function(sb){return sb.isJSEditorPlugin}))&&
oa.systemInterface();if(!La)return dc.return([]);Ua=Tc.buildEvalOpts(bb);Sb=Ua.targetModule;return"local"===La.name?(Ca=Object.getOwnPropertyNames(La.getModule(Sb).recorder),dc.jumpTo(2)):dc.yield(La.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+
Sb+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',{targetModule:"lively://module-recorder-completer"}),3)}if(2!=dc.nextAddress){Va=dc.yieldResult;if(Va.isError)return dc.return([]);Ca=JSON.parse(Va.value)}Ca=Ca.filter(function(sb){return!sb.startsWith("defVar_")&&!["System","__currentLivelyModule",
"initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(sb)});return dc.return(Ca.map(function(sb){return{priority:1100,completion:sb}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],Oc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:227,end:1700})}(void 0);Tc.ModuleTopLevelVarCompleter=tc;Tc.ModuleTopLevelVarCompleter=tc;Tc.ModuleTopLevelVarCompleter=tc;tc=function(vc){var Oc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),pc=Oc.hasOwnProperty("DynamicJavaScriptCompleter")&&"function"===typeof Oc.DynamicJavaScriptCompleter?Oc.DynamicJavaScriptCompleter:Oc.DynamicJavaScriptCompleter=function(bb){bb&&bb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Vb(pc,vc,[{key:"isValidPrefix",value:function(bb){return/\.[a-z0-9_]*$/i.test(bb)}},{key:"isMethodCallCompletion",value:function(bb){return bb.endsWith(")")&&0<bb.indexOf("(")}},{key:"isValidIdentifier",value:function(bb){if("string"!==typeof bb)return!1;this.isMethodCallCompletion(bb)&&(bb=bb.slice(0,bb.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(bb)?!0:!1}},{key:"wrapInBrackets",value:function(bb){if(!isNaN(Number(bb))||bb.startsWith("Symbol."))return"["+bb+"]";var Ma="";this.isMethodCallCompletion(bb)&&
(Ma=bb.slice(bb.indexOf("(")),bb=bb.slice(0,bb.indexOf("(")));return'["'+bb.replace(/"/g,'\\"')+'"]'+Ma}},{key:"compute",value:function(bb){var Ma=this,oa,La,Ua,Sb,Ca,Va,dc,sb,od,bc,Td;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rd){if(1==rd.nextAddress){oa=bb.selection;oa.isEmpty()?(La=bb.getLine(oa.lead.row),La=La.slice(La.lastIndexOf(":")+1,oa.lead.column)):La=oa.text.slice(Math.max(0,oa.text.indexOf(":")),0);if(!Ma.isValidPrefix(La))return rd.return([]);Sb=(Ua=bb.pluginFind(function(dd){return dd.isJSEditorPlugin}))&&
Ua.systemInterface();if(!Sb)return rd.return([]);Ca=Tc.buildEvalOpts(bb);return rd.yield(Sb.dynamicCompletionsForPrefix(Ca.targetModule,La,Ca),2)}Va=rd.yieldResult;dc=Va.isError;sb=Va.value;od=Va.completions;bc=Va.prefix;if(dc)return console.warn("javascript completer encountered error: "+(sb.stack||sb)),rd.return([]);od.reduce(function(dd,Ub){Ub=$jscomp.makeIterator(Ub);Ub.next();Ub=Ub.next().value;return dd+Ub.length},0);Td=od.reduce(function(dd,Ub,Ne){Ub=$jscomp.makeIterator(Ub);var gc=Ub.next().value;
Ub=Ub.next().value;return dd.concat(Ub.map(function(Tb){var Ya=Ma.isValidIdentifier(Tb);return{info:gc,completion:Tb,prefix:Ya?bc:"."+bc,customInsertionFn:Ya?Ma.isMethodCallCompletion(Tb)?function(ha,Pa,nb,cc){Pa=cc.start;cc=cc.end;ha=ha.replace(/\((.*)\)/,function(Lc){return"("+Lc.slice(1,-1).split(", ").map(function(pd,ce){return"${"+ce+":"+pd+"}"}).join(", ")+")"});ha=new Tc.Snippet({expansion:ha});nb.replace({start:Pa,end:cc},"");ha.expandAtCursor(nb)}:null:function(ha,Pa,nb,cc){ha=cc.start;cc=
cc.end;Pa={row:ha.row,column:ha.column-1};cc="."===nb.textInRange({start:Pa,end:ha})?{start:Pa,end:cc}:{start:ha,end:cc};nb.replace(cc,Ma.wrapInBrackets(Tb))}}}))},[]);Td.forEach(function(dd,Ub){return Object.assign(dd,{priority:2E3+Td.length-Ub})});return rd.return(Td)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DynamicJavaScriptCompleter"}}],Oc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5155})}(void 0);Tc.DynamicJavaScriptCompleter=tc;Tc.DynamicJavaScriptCompleter=tc;Tc.DynamicJavaScriptCompleter=tc;Tc.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
tc=function(vc){var Oc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),pc=Oc.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof Oc.JavaScriptKeywordCompleter?Oc.JavaScriptKeywordCompleter:Oc.JavaScriptKeywordCompleter=function(bb){bb&&bb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(pc,vc,[{key:"compute",value:function(bb,Ma){return Tc.keywords.map(function(oa){return{completion:oa,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],Oc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6157,end:6295})}(void 0);Tc.JavaScriptKeywordCompleter=tc;Tc.JavaScriptKeywordCompleter=tc;Tc.JavaScriptKeywordCompleter=tc;tc=[new Tc.DynamicJavaScriptCompleter,
new Tc.JavaScriptKeywordCompleter,new Tc.ModuleTopLevelVarCompleter];Tc.completers=tc;Tc.completers=tc;Tc.completers=tc;var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");fb.Snippet=Rc;var uc=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];fb.snippets=uc;fb.snippets=uc;fb.snippets=uc;var Rb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");Rb.getEvalEnv=function(vc){return(vc=vc.pluginFind(function(Oc){return Oc.isJSEditorPlugin}))?vc.evalEnvironment:null};Rb.setEvalEnv=function(vc,Oc){(vc=vc.pluginFind(function(pc){return pc.isJSEditorPlugin}))&&Object.assign(vc.evalEnvironment,Oc);return vc.evalEnvironment};
Rb.pToI=function(vc,Oc){return vc.positionToIndex(Oc)};Rb.iToP=function(vc,Oc){return vc.indexToPosition(Oc)};Rb.arr=af;Rb.promise=bf;Rb.string=gd;Rb.show=xe;Rb.Range=Pd;Rb.query=jc;Rb.BaseVisitor=Ve;fb=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(vc,Oc){Oc=void 0===Oc?{varName:null,position:null}:Oc;var pc,bb,Ma,oa,La,Ua,Sb,Ca,Va,dc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){switch(sb.nextAddress){case 1:pc=
Oc;bb=pc.varName;Ma=pc.position;if(!bb){Ma||(Ma=vc.cursorPosition);oa=vc.pluginInvokeFirst("getNavigator");La=oa.ensureAST(vc);Ua=Rb.query.nodesAt(vc.positionToIndex(Ma),La).reverse().find(function(od){return"Identifier"===od.type});if(!Ua)return vc.showError(Error("no identifier found!")),sb.return(!0);bb=Ua.name}Oc=vc.pluginFind(function(od){return od.isJSEditorPlugin}).sanatizedJsEnv();Sb='lively.modules.module("'+Oc.targetModule+'").undefine("'+bb+'")';sb.setCatchFinallyBlocks(2);return sb.yield(vc.doEval(null,
Oc,Sb),4);case 4:Ca=sb.yieldResult;Va=Ca.error?Ca.error:Ca.isError?Ca.value:null;sb.leaveTryBlock(3);break;case 2:Va=dc=sb.enterCatchBlock();case 3:return Va?vc.showError(Va):vc.setStatusMessage(bb+" undefined"),sb.return(!0)}})}},{name:"change doitContext",exec:function(vc){var Oc,pc,bb,Ma,oa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){if(1==La.nextAddress)return Oc=$jscomp,pc=Oc.makeIterator,La.yield(vc.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(Ua){return!Ua.isUsedAsEpiMorph()}}),2);bb=pc.call(Oc,La.yieldResult);if(Ma=bb.next().value)oa="reset"===Ma,vc.doitContext=oa?null:Ma,vc.setStatusMessage(oa?"doitContext is now\n"+Ma:"doitContext reset");return La.return(!0)})}},{name:"change eval backend",exec:function(vc,Oc){Oc=void 0===Oc?{backend:void 0}:Oc;var pc,bb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){if(1==Ma.nextAddress)return pc=Oc,bb=pc.backend,void 0!==bb?
Ma.jumpTo(2):Ma.yield(vc.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=Ma.nextAddress&&(bb=Ma.yieldResult,!bb))return vc.setStatusMessage("Canceled"),Ma.return(!0);"local"===bb&&(bb=null);vc.setStatusMessage("Eval backend is now "+(bb||"local"));return Ma.return(Rb.setEvalEnv(vc,{remote:bb}))})}},{name:"copy current module name to clipboard",exec:function(vc){var Oc=vc.evalEnvironment.targetModule;vc.setStatusMessage(Oc||"Cannot find module name");vc.env.eventDispatcher.killRing.add(vc);
vc.env.eventDispatcher.doCopy(Oc);return!0}}];Rb.jsEditorCommands=fb;Rb.jsEditorCommands=fb;Rb.jsEditorCommands=fb;var Fc=[{name:"[javascript] list errors and warnings",exec:function(vc){var Oc,pc,bb,Ma,oa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){if(1==La.nextAddress){Oc=(vc.markers||[]).filter(function(Ua){Ua=Ua.type;return"js-undeclared-var"===Ua||"js-syntax-error"===Ua});if(!Oc.length)return Rb.show("no warnings or errors"),La.return(!0);pc=Oc.map(function(Ua){var Sb=Ua.range;
return{isListItem:!0,string:"["+Ua.type.split("-").slice(1).join(" ")+"] "+vc.textInRange(Sb),value:Sb}});return La.yield(vc.world().filterableListPrompt("jump to warning or error",pc),2)}bb=La.yieldResult;Ma=$jscomp.makeIterator(bb.selected);if(oa=Ma.next().value)vc.saveMark(),vc.selection=oa,vc.centerRow(oa.start.row);return La.return(!0)})}},{name:"[javascript] inject import",exec:function(vc,Oc){Oc=void 0===Oc?{gotoImport:!1,insertImportAtCursor:!0}:Oc;var pc,bb,Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){switch(oa.nextAddress){case 1:return oa.yield(Rb.promise.delay(0),
2);case 2:return oa.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return pc=oa.yieldResult,bb=pc.interactivelyInjectImportIntoText,oa.yield(bb(vc,Oc),4);case 4:return(Ma=oa.yieldResult)||vc.setStatusMessage("canceled"),oa.return(Ma)}})}},{name:"[javascript] fix undeclared variables",exec:function(vc,Oc){Oc=void 0===Oc?{ignore:[],autoApplyIfSingleChoice:!1,requester:vc}:Oc;var pc,bb,Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){if(1==oa.nextAddress)return oa.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=oa.nextAddress)return pc=oa.yieldResult,bb=pc.interactivlyFixUndeclaredVariables,oa.yield(bb(vc,Oc),3);Ma=oa.yieldResult;vc.focus();return oa.return(Ma)})}},{name:"[javascript] remove unused imports",exec:function(vc,Oc){Oc=void 0===Oc?{query:!0}:Oc;var pc,bb,Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){if(1==oa.nextAddress)return oa.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=oa.nextAddress)return pc=oa.yieldResult,bb=pc.cleanupUnusedImports,oa.yield(bb(vc,
Oc),3);Ma=oa.yieldResult;vc.setStatusMessage(Ma);return oa.return(!0)})}},{name:"[javascript] eslint report",exec:function(vc){var Oc,pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bb){if(1==bb.nextAddress)return bb.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);Oc=bb.yieldResult;pc=Oc.default;try{return bb.return(pc.reportOnMorph(vc))}catch(Ma){vc.showError(Ma)}bb.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(vc){var Oc,pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bb){if(1==
bb.nextAddress)return bb.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);Oc=bb.yieldResult;pc=Oc.default;try{return bb.return(pc.previewFixesOnMorph(vc))}catch(Ma){vc.showError(Ma)}bb.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(vc,Oc,pc){function bb(rd,dd){dd||(dd=Ca(rd,{allowReturnOutsideFunction:!0}));var Ub=Rb.string.lineRanges(rd),Ne=rd.split("\n"),gc=[],Tb=new Rb.BaseVisitor,Ya=Tb.visitVariableDeclaration;Tb.visitVariableDeclaration=
function(cc,Lc,pd){if(1<cc.declarations.length)for(var ce=Rb.string.findLineWithIndexInLineRanges(Ub,cc.start),Ie=cc.declarations[0].start-Ub[ce][0],Gd={},Af=1;Af<cc.declarations.length;Gd={$jscomp$loop$prop$actionType$2994:Gd.$jscomp$loop$prop$actionType$2994,$jscomp$loop$prop$arg$2995:Gd.$jscomp$loop$prop$arg$2995},Af++){var Ce=cc.declarations[Af],zf=Rb.string.findLineWithIndexInLineRanges(Ub,Ce.start);if(ce!==zf){var C=Ne[zf].match(/\s*/)[0].length;C=Ie-C;0!==C&&(Ce=Rb.string.findLineWithIndexInLineRanges(Ub,
Ce.end),Gd.$jscomp$loop$prop$actionType$2994=0<C?"insert":"delete",Gd.$jscomp$loop$prop$arg$2995=0<C?" ".repeat(C):-C,gc.push.apply(gc,$jscomp.arrayFromIterable(Rb.arr.range(zf,Ce).map(function(uf){return function(Cf){return[uf.$jscomp$loop$prop$actionType$2994,Ub[Cf][0],uf.$jscomp$loop$prop$arg$2995]}}(Gd)))))}}return Ya.call(Tb,cc,Lc,pd)};Tb.accept(dd,{},[]);for(dd=gc.length;dd--;){var ha=$jscomp.makeIterator(gc[dd]),Pa=ha.next().value,nb=ha.next().value;ha=ha.next().value;"insert"===Pa?rd=rd.slice(0,
nb)+ha+rd.slice(nb):"delete"===Pa&&(rd=rd.slice(0,nb)+rd.slice(nb+ha))}return rd}var Ma,oa,La,Ua,Sb,Ca,Va,dc,sb,od,bc,Td;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rd){switch(rd.nextAddress){case 1:return Ma=pc||Math.floor(vc.width/vc.defaultCharExtent().width),Oc=Object.assign({printWidth:Ma,tabWidth:2,useTabs:!1,bracketSpacing:!1},Oc),oa=lively.modules.module,La=System.normalizeSync("prettier/standalone.js"),rd.yield(oa(La).load({format:"global",instrument:!1}),2);case 2:return Ua=
rd.yieldResult,rd.yield(oa("lively.ast/lib/acorn-extension.js").load(),3);case 3:return rd.yield(oa("lively.ast").load(),4);case 4:return Sb=rd.yieldResult,Ca=Sb.parse,rd.yield(oa("lively.ast/lib/query.js").load(),5);case 5:return rd.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return Va=rd.yieldResult,dc=vc.selection.isEmpty()?vc.documentRange:vc.selection.range,sb=vc.positionToIndex(dc.start),od=vc.positionToIndex(dc.end),bc=Ua.format(vc.textString,Object.assign({},
Oc,{rangeStart:sb,rangeEnd:od,parser:function(dd,Ub,Ne){return Ca(dd,{allowReturnOutsideFunction:!0})}})),vc.undoManager.group(),Td=Va.diffChars(vc.textString,bc),vc.applyJsDiffPatch(Td),vc.selection.text=bb(vc.selection.text),vc.undoManager.group(),rd.return(!0)}})}}];Rb.jsIdeCommands=Fc;Rb.jsIdeCommands=Fc;Rb.jsIdeCommands=Fc;var Uc=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(vc,Oc){Oc=vc.pluginInvokeFirst("getNavigator");if(!Oc)return!0;Oc=Oc.resolveIdentifierAt(vc,vc.cursorPosition);
if(!Oc||!Oc.id)return Rb.show("No symbol identifier selected"),!0;if(!Oc.decl)return Rb.show("Cannot find declaration of "+Oc.name),!0;vc.saveMark();vc.selection={start:vc.indexToPosition(Oc.decl.start),end:vc.indexToPosition(Oc.decl.end)};vc.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(vc){vc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(vc){vc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(vc,Oc){Oc=void 0===Oc?{direction:null}:Oc;var pc=vc.pluginInvokeFirst("getNavigator");if(!pc)return!0;pc=pc.resolveIdentifierAt(vc,
vc.cursorPosition);if(!pc||!pc.refs)return Rb.show("No symbol identifier selected"),!0;var bb=vc.selection;pc=pc.refs.map(function(oa){var La=oa.end;return Rb.Range.fromPositions(Rb.iToP(vc,oa.start),Rb.iToP(vc,La))}).concat(pc.decl?Rb.Range.fromPositions(Rb.iToP(vc,pc.decl.start),Rb.iToP(vc,pc.decl.end)):[]).sort(Rb.Range.compare);if(!pc.length)return!0;var Ma=pc.map(String).indexOf(String(bb.range));if("next"===Oc.direction||"prev"===Oc.direction)-1===Ma&&pc.length?pc=[pc[0]]:(Oc=Ma+("next"===Oc.direction?
1:-1),0>Oc?Oc=pc.length-1:Oc>=pc.length&&(Oc=0),pc=[pc[Oc]]);pc.forEach(function(oa){var La=bb.selections.findIndex(function(Sb){return Sb.range.equals(oa)}),Ua=bb.selections.length-1;-1<La?Rb.arr.swap(bb.selections,La,Ua):bb.addRange(oa,!1)});bb.mergeSelections();return!0}}];Rb.astEditorCommands=Uc;Rb.astEditorCommands=Uc;Rb.astEditorCommands=Uc;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var vd=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
vd.expressionAllowed=function(vc,Oc,pc){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(Oc.lastType)||"quasi"==Oc.lastType&&/\{\s*$/.test(vc.string.slice(0,vc.pos-(pc||0)))};vd.passIndent=pe;vd.defineMode=Se;vd.defineMIME=nc;vd.registerHelper=$c;vd.defaultConfig={indentUnit:2};vd.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};vd.defineMode("javascript",
function(vc,Oc){function pc(Jc,Rd,Re){eh=Jc;vh=Re;return Rd}function bb(Jc,Rd){var Re=Jc.next();if('"'==Re||"'"==Re)return Rd.tokenize=Ma(Re),Rd.tokenize(Jc,Rd);if("."==Re&&Jc.match(/^\d+(?:[eE][+\-]?\d+)?/))return pc("number","number");if("."==Re&&Jc.match(".."))return pc("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(Re))return pc(Re);if("="==Re&&Jc.eat(">"))return pc("=>","operator");if("0"==Re&&Jc.eat(/x/i))return Jc.eatWhile(/[\da-f]/i),pc("number","number");if("0"==Re&&Jc.eat(/o/i))return Jc.eatWhile(/[0-7]/i),
pc("number","number");if("0"==Re&&Jc.eat(/b/i))return Jc.eatWhile(/[01]/i),pc("number","number");if(/\d/.test(Re))return Jc.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),pc("number","number");if("/"==Re){if(Jc.eat("*"))return Rd.tokenize=oa,oa(Jc,Rd);if(Jc.eat("/"))return Jc.skipToEnd(),pc("comment","comment");if(vd.expressionAllowed(Jc,Rd,1)){a:for(var re=Rd=!1;null!=(Re=Jc.next());){if(!Rd){if("/"==Re&&!re)break a;"["==Re?re=!0:re&&"]"==Re&&(re=!1)}Rd=!Rd&&"\\"==Re}Jc.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return pc("regexp","string-2")}Jc.eatWhile(Th);return pc("operator","operator",Jc.current())}if("`"==Re)return Rd.tokenize=La,La(Jc,Rd);if("#"==Re)return Jc.skipToEnd(),pc("error","error");if(Th.test(Re))return">"==Re&&Rd.lexical&&">"==Rd.lexical.type||Jc.eatWhile(Th),pc("operator","operator",Jc.current());if(Hi.test(Re))return Jc.eatWhile(Hi),Jc=Jc.current(),(Re=xj.propertyIsEnumerable(Jc)&&xj[Jc])&&"."!=Rd.lastType?pc(Re.type,Re.style,Jc):pc("variable","variable",Jc)}function Ma(Jc){return function(Rd,
Re){var re=!1,jg;if(nh&&"@"==Rd.peek()&&Rd.match(sg))return Re.tokenize=bb,pc("jsonld-keyword","meta");for(;null!=(jg=Rd.next())&&(jg!=Jc||re);)re=!re&&"\\"==jg;re||(Re.tokenize=bb);return pc("string","string")}}function oa(Jc,Rd){for(var Re=!1,re;re=Jc.next();){if("/"==re&&Re){Rd.tokenize=bb;break}Re="*"==re}return pc("comment","comment")}function La(Jc,Rd){for(var Re=!1,re;null!=(re=Jc.next());){if(!Re&&("`"==re||"$"==re&&Jc.eat("{"))){Rd.tokenize=bb;break}Re=!Re&&"\\"==re}return pc("quasi","string-2",
Jc.current())}function Ua(Jc,Rd){Rd.fatArrowAt&&(Rd.fatArrowAt=null);var Re=Jc.string.indexOf("=>",Jc.start);if(!(0>Re)){if(qg){var re=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Jc.string.slice(Jc.start,Re));re&&(Re=re.index)}re=0;var jg=!1;for(--Re;0<=Re;--Re){var $g=Jc.string.charAt(Re),ih="([{}])".indexOf($g);if(0<=ih&&3>ih){if(!re){++Re;break}if(0==--re){"("==$g&&(jg=!0);break}}else if(3<=ih&&6>ih)++re;else if(Hi.test($g))jg=!0;else{if(/["'\/]/.test($g))return;if(jg&&!re){++Re;break}}}jg&&
!re&&(Rd.fatArrowAt=Re)}}function Sb(Jc,Rd,Re,re,jg,$g){this.indented=Jc;this.column=Rd;this.type=Re;this.prev=jg;this.info=$g;null!=re&&(this.align=re)}function Ca(){for(var Jc=arguments.length-1;0<=Jc;Jc--)Ff.cc.push(arguments[Jc])}function Va(){Ca.apply(null,arguments);return!0}function dc(Jc){function Rd(re){for(;re;re=re.next)if(re.name==Jc)return!0;return!1}var Re=Ff.state;Ff.marked="def";Re.context?Rd(Re.localVars)||(Re.localVars={name:Jc,next:Re.localVars}):!Rd(Re.globalVars)&&Oc.globalVars&&
(Re.globalVars={name:Jc,next:Re.globalVars})}function sb(){Ff.state.context={prev:Ff.state.context,vars:Ff.state.localVars};Ff.state.localVars=yj}function od(){Ff.state.localVars=Ff.state.context.vars;Ff.state.context=Ff.state.context.prev}function bc(Jc,Rd){var Re=function(){var re=Ff.state,jg=re.indented;if("stat"==re.lexical.type)jg=re.lexical.indented;else for(var $g=re.lexical;$g&&")"==$g.type&&$g.align;$g=$g.prev)jg=$g.indented;re.lexical=new Sb(jg,Ff.stream.column(),Jc,null,re.lexical,Rd)};
Re.lex=!0;return Re}function Td(){var Jc=Ff.state;Jc.lexical.prev&&(")"==Jc.lexical.type&&(Jc.indented=Jc.lexical.indented),Jc.lexical=Jc.lexical.prev)}function rd(Jc){function Rd(Re){return Re==Jc?Va():";"==Jc?Ca():Va(Rd)}return Rd}function dd(Jc,Rd){return"var"==Jc?Va(bc("vardef",Rd.length),fi,rd(";"),Td):"keyword a"==Jc?Va(bc("form"),gc,dd,Td):"keyword b"==Jc?Va(bc("form"),dd,Td):"{"==Jc?Va(bc("}"),we,Td):";"==Jc?Va():"if"==Jc?("else"==Ff.state.lexical.info&&Ff.state.cc[Ff.state.cc.length-1]==
Td&&Ff.state.cc.pop()(),Va(bc("form"),gc,dd,Td,yb)):"function"==Jc?Va(Wa):"for"==Jc?Va(bc("form"),lb,dd,Td):"variable"==Jc?qg&&"type"==Rd?(Ff.marked="keyword",Va(dg,rd("operator"),dg,rd(";"))):Va(bc("stat"),Ce):"switch"==Jc?Va(bc("form"),gc,rd("{"),bc("}","switch"),we,Td,Td):"case"==Jc?Va(Ub,rd(":")):"default"==Jc?Va(rd(":")):"catch"==Jc?Va(bc("form"),sb,rd("("),gb,rd(")"),dd,Td,od):"class"==Jc?Va(bc("form"),fc,Td):"export"==Jc?Va(bc("stat"),Qd,Td):"import"==Jc?Va(bc("stat"),cf,Td):"module"==Jc?Va(bc("form"),
Vd,rd("{"),bc("}"),we,Td,Td):"async"==Jc?Va(dd):"@"==Rd?Va(Ub,dd):Ca(bc("stat"),Ub,rd(";"),Td)}function Ub(Jc){return Tb(Jc,!1)}function Ne(Jc){return Tb(Jc,!0)}function gc(Jc){return"("!=Jc?Ca():Va(bc(")"),Ub,rd(")"),Td)}function Tb(Jc,Rd){if(Ff.state.fatArrowAt==Ff.stream.start){var Re=Rd?ce:pd;if("("==Jc)return Va(sb,bc(")"),fh(Vd,")"),Td,rd("=>"),Re,od);if("variable"==Jc)return Ca(sb,Vd,rd("=>"),Re,od)}Re=Rd?nb:Pa;return wi.hasOwnProperty(Jc)?Va(Re):"function"==Jc?Va(Wa,Re):"class"==Jc?Va(bc("form"),
ac,Td):"keyword c"==Jc||"async"==Jc?Va(Rd?ha:Ya):"("==Jc?Va(bc(")"),Ya,rd(")"),Td,Re):"operator"==Jc||"spread"==Jc?Va(Rd?Ne:Ub):"["==Jc?Va(bc("]"),vf,Td,Re):"{"==Jc?mg(C,"}",null,Re):"quasi"==Jc?Ca(cc,Re):"new"==Jc?Va(Ie(Rd)):Va()}function Ya(Jc){return Jc.match(/[;\}\)\],]/)?Ca():Ca(Ub)}function ha(Jc){return Jc.match(/[;\}\)\],]/)?Ca():Ca(Ne)}function Pa(Jc,Rd){return","==Jc?Va(Ub):nb(Jc,Rd,!1)}function nb(Jc,Rd,Re){var re=0==Re?Pa:nb,jg=0==Re?Ub:Ne;if("=>"==Jc)return Va(sb,Re?ce:pd,od);if("operator"==
Jc)return/\+\+|--/.test(Rd)?Va(re):"?"==Rd?Va(Ub,rd(":"),jg):Va(jg);if("quasi"==Jc)return Ca(cc,re);if(";"!=Jc){if("("==Jc)return mg(Ne,")","call",re);if("."==Jc)return Va(zf,re);if("["==Jc)return Va(bc("]"),Ya,rd("]"),Td,re)}}function cc(Jc,Rd){return"quasi"!=Jc?Ca():"${"!=Rd.slice(Rd.length-2)?Va(cc):Va(Ub,Lc)}function Lc(Jc){if("}"==Jc)return Ff.marked="string-2",Ff.state.tokenize=La,Va(cc)}function pd(Jc){Ua(Ff.stream,Ff.state);return Ca("{"==Jc?dd:Ub)}function ce(Jc){Ua(Ff.stream,Ff.state);return Ca("{"==
Jc?dd:Ne)}function Ie(Jc){return function(Rd){return"."==Rd?Va(Jc?Af:Gd):Ca(Jc?Ne:Ub)}}function Gd(Jc,Rd){if("target"==Rd)return Ff.marked="keyword",Va(Pa)}function Af(Jc,Rd){if("target"==Rd)return Ff.marked="keyword",Va(nb)}function Ce(Jc){return":"==Jc?Va(Td,dd):Ca(Pa,rd(";"),Td)}function zf(Jc){if("variable"==Jc)return Ff.marked="property",Va()}function C(Jc,Rd){if("async"==Jc)return Ff.marked="property",Va(C);if("variable"==Jc||"keyword"==Ff.style)return Ff.marked="property","get"==Rd||"set"==
Rd?Va(uf):Va(Cf);if("number"==Jc||"string"==Jc)return Ff.marked=nh?"property":Ff.style+" property",Va(Cf);if("jsonld-keyword"==Jc)return Va(Cf);if("modifier"==Jc)return Va(C);if("["==Jc)return Va(Ub,rd("]"),Cf);if("spread"==Jc)return Va(Ub);if(":"==Jc)return Ca(Cf)}function uf(Jc){if("variable"!=Jc)return Ca(Cf);Ff.marked="property";return Va(Wa)}function Cf(Jc){if(":"==Jc)return Va(Ne);if("("==Jc)return Ca(Wa)}function fh(Jc,Rd,Re){function re(jg,$g){return(Re?-1<Re.indexOf(jg):","==jg)?(jg=Ff.state.lexical,
"call"==jg.info&&(jg.pos=(jg.pos||0)+1),Va(function(ih,bn){return ih==Rd||bn==Rd?Ca():Ca(Jc)},re)):jg==Rd||$g==Rd?Va():Va(rd(Rd))}return function(jg,$g){return jg==Rd||$g==Rd?Va():Ca(Jc,re)}}function mg(Jc,Rd,Re){for(var re=3;re<arguments.length;re++)Ff.cc.push(arguments[re]);return Va(bc(Rd,Re),fh(Jc,Rd),Td)}function we(Jc){return"}"==Jc?Va():Ca(dd,we)}function $f(Jc,Rd){if(qg){if(":"==Jc)return Va(dg);if("?"==Rd)return Va($f)}}function dg(Jc){if("variable"==Jc)return Ff.marked="variable-3",Va(ld);
if("string"==Jc||"number"==Jc||"atom"==Jc)return Va(ld);if("{"==Jc)return Va(bc("}"),fh(Ah,"}",",;"),Td);if("("==Jc)return Va(fh(Ze,")"),tg)}function tg(Jc){if("=>"==Jc)return Va(dg)}function Ah(Jc,Rd){if("variable"==Jc||"keyword"==Ff.style)return Ff.marked="property",Va(Ah);if("?"==Rd)return Va(Ah);if(":"==Jc)return Va(dg)}function Ze(Jc){if("variable"==Jc)return Va(Ze);if(":"==Jc)return Va(dg)}function ld(Jc,Rd){if("<"==Rd)return Va(bc(">"),fh(dg,">"),Td,ld);if("|"==Rd||"."==Jc)return Va(dg);if("["==
Jc)return Va(rd("]"),ld);if("extends"==Rd)return Va(dg)}function fi(){return Ca(Vd,$f,wd,hb)}function Vd(Jc,Rd){if("modifier"==Jc)return Va(Vd);if("variable"==Jc)return dc(Rd),Va();if("spread"==Jc)return Va(Vd);if("["==Jc)return mg(Vd,"]");if("{"==Jc)return mg(si,"}")}function si(Jc,Rd){if("variable"==Jc&&!Ff.stream.match(/^\s*:/,!1))return dc(Rd),Va(wd);"variable"==Jc&&(Ff.marked="property");return"spread"==Jc?Va(Vd):"}"==Jc?Ca():Va(rd(":"),Vd,wd)}function wd(Jc,Rd){if("="==Rd)return Va(Ne)}function hb(Jc){if(","==
Jc)return Va(fi)}function yb(Jc,Rd){if("keyword b"==Jc&&"else"==Rd)return Va(bc("form","else"),dd,Td)}function lb(Jc){if("("==Jc)return Va(bc(")"),qa,rd(")"),Td)}function qa(Jc){return"var"==Jc?Va(fi,rd(";"),cb):";"==Jc?Va(cb):"variable"==Jc?Va(ba):Ca(Ub,rd(";"),cb)}function ba(Jc,Rd){return"in"==Rd||"of"==Rd?(Ff.marked="keyword",Va(Ub)):Va(Pa,cb)}function cb(Jc,Rd){return";"==Jc?Va(za):"in"==Rd||"of"==Rd?(Ff.marked="keyword",Va(Ub)):Ca(Ub,rd(";"),za)}function za(Jc){")"!=Jc&&Va(Ub)}function Wa(Jc,
Rd){if("*"==Rd)return Ff.marked="keyword",Va(Wa);if("variable"==Jc)return dc(Rd),Va(Wa);if("("==Jc)return Va(sb,bc(")"),fh(gb,")"),Td,$f,dd,od);if(qg&&"<"==Rd)return Va(bc(">"),fh(dg,">"),Td,Wa)}function gb(Jc){return"spread"==Jc?Va(gb):Ca(Vd,$f,wd)}function ac(Jc,Rd){return"variable"==Jc?fc(Jc,Rd):xc(Jc,Rd)}function fc(Jc,Rd){if("variable"==Jc)return dc(Rd),Va(xc)}function xc(Jc,Rd){if("<"==Rd)return Va(bc(">"),fh(dg,">"),Td,xc);if("extends"==Rd||"implements"==Rd||qg&&","==Jc)return Va(qg?dg:Ub,
xc);if("{"==Jc)return Va(bc("}"),ed,Td)}function ed(Jc,Rd){if("variable"==Jc||"keyword"==Ff.style){if(("async"==Rd||"static"==Rd||"get"==Rd||"set"==Rd||qg&&("public"==Rd||"private"==Rd||"protected"==Rd||"readonly"==Rd||"abstract"==Rd))&&Ff.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Ff.marked="keyword",Va(ed);Ff.marked="property";return Va(qg?kd:Wa,ed)}if("["==Jc)return Va(Ub,rd("]"),qg?kd:Wa,ed);if("*"==Rd)return Ff.marked="keyword",Va(ed);if(";"==Jc)return Va(ed);if("}"==Jc)return Va();if("@"==
Rd)return Va(Ub,ed)}function kd(Jc,Rd){return"?"==Rd?Va(kd):":"==Jc?Va(dg,wd):"="==Rd?Va(Ne):Ca(Wa)}function Qd(Jc,Rd){return"*"==Rd?(Ff.marked="keyword",Va(ff,rd(";"))):"default"==Rd?(Ff.marked="keyword",Va(Ub,rd(";"))):"{"==Jc?Va(fh(Ge,"}"),ff,rd(";")):Ca(dd)}function Ge(Jc,Rd){if("as"==Rd)return Ff.marked="keyword",Va(rd("variable"));if("variable"==Jc)return Ca(Ne,Ge)}function cf(Jc){return"string"==Jc?Va():Ca(ne,qf,ff)}function ne(Jc,Rd){if("{"==Jc)return mg(ne,"}");"variable"==Jc&&dc(Rd);"*"==
Rd&&(Ff.marked="keyword");return Va(pf)}function qf(Jc){if(","==Jc)return Va(ne,qf)}function pf(Jc,Rd){if("as"==Rd)return Ff.marked="keyword",Va(ne)}function ff(Jc,Rd){if("from"==Rd)return Ff.marked="keyword",Va(Ub)}function vf(Jc){return"]"==Jc?Va():Ca(fh(Ne,"]"))}vc=Object.assign({},vd.defaultConfig,{},vc);Oc=Object.assign({},vd.defaultParserConfig,{},Oc);var xg=vc.indentUnit,dh=Oc.statementIndent,nh=Oc.jsonld,Vg=Oc.json||nh,qg=Oc.typescript,Hi=Oc.wordCharacters||/[\w$\xa1-\uffff]/,xj=function(){function Jc(bn){return{type:bn,
style:"keyword"}}var Rd=Jc("keyword a"),Re=Jc("keyword b"),re=Jc("keyword c"),jg=Jc("operator"),$g={type:"atom",style:"atom"};Rd={if:Jc("if"),while:Rd,with:Rd,else:Re,do:Re,try:Re,finally:Re,return:re,break:re,continue:re,new:Jc("new"),delete:re,throw:re,debugger:re,var:Jc("var"),const:Jc("var"),let:Jc("var"),function:Jc("function"),catch:Jc("catch"),for:Jc("for"),switch:Jc("switch"),case:Jc("case"),default:Jc("default"),in:jg,typeof:jg,instanceof:jg,true:$g,false:$g,null:$g,undefined:$g,NaN:$g,Infinity:$g,
this:Jc("this"),class:Jc("class"),super:Jc("atom"),yield:re,export:Jc("export"),import:Jc("import"),extends:re,await:re,async:Jc("async")};if(qg){Re={type:"variable",style:"variable-3"};re={interface:Jc("class"),implements:re,namespace:re,module:Jc("module"),enum:Jc("module"),public:Jc("modifier"),private:Jc("modifier"),protected:Jc("modifier"),abstract:Jc("modifier"),as:jg,string:Re,number:Re,boolean:Re,any:Re};for(var ih in re)Rd[ih]=re[ih]}return Rd}(),Th=/[+\-*&%=<>!?|~^@]/,sg=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
eh,vh,wi={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Ff={state:null,column:null,marked:null,cc:null},yj={name:"this",next:{name:"arguments"}};Td.lex=!0;return{startState:function(Jc){Jc={tokenize:bb,lastType:"sof",cc:[],lexical:new Sb((Jc||0)-xg,0,"block",!1),localVars:Oc.localVars,context:Oc.localVars&&{vars:Oc.localVars},indented:Jc||0};Oc.globalVars&&"object"===typeof Oc.globalVars&&(Jc.globalVars=Oc.globalVars);return Jc},token:function(Jc,Rd){Jc.sol()&&(Rd.lexical.hasOwnProperty("align")||
(Rd.lexical.align=!1),Rd.indented=Jc.indentation(),Ua(Jc,Rd));if(Rd.tokenize!=oa&&Jc.eatSpace())return null;var Re=Rd.tokenize(Jc,Rd);if("comment"==eh)return Re;Rd.lastType="operator"!=eh||"++"!=vh&&"--"!=vh?eh:"incdec";a:{var re=eh,jg=vh,$g=Rd.cc;Ff.state=Rd;Ff.stream=Jc;Ff.marked=null;Ff.cc=$g;Ff.style=Re;Rd.lexical.hasOwnProperty("align")||(Rd.lexical.align=!0);for(Jc=0;;){if(1E5<Jc++)throw Error("endless");if(($g.length?$g.pop():Vg?Ub:dd)(re,jg)){for(;$g.length&&$g[$g.length-1].lex;)$g.pop()();
if(Ff.marked){Re=Ff.marked;break a}if(re="variable"==re)b:{for(re=Rd.localVars;re;re=re.next)if(re.name==jg){re=!0;break b}for(Rd=Rd.context;Rd;Rd=Rd.prev)for(re=Rd.vars;re;re=re.next)if(re.name==jg){re=!0;break b}re=void 0}if(re){Re="variable-2";break a}break a}}}return Re},indent:function(Jc,Rd){if(Jc.tokenize==oa)return vd.passIndent;if(Jc.tokenize!=bb)return 0;var Re=Rd&&Rd.charAt(0),re=Jc.lexical,jg;if(!/^\s*else\b/.test(Rd))for(var $g=Jc.cc.length-1;0<=$g;--$g){var ih=Jc.cc[$g];if(ih==Td)re=
re.prev;else if(ih!=yb)break}for(;!("stat"!=re.type&&"form"!=re.type||"}"!=Re&&(!(jg=Jc.cc[Jc.cc.length-1])||jg!=Pa&&jg!=nb||/^[,\.=+\-*:?[\(]/.test(Rd)));)re=re.prev;dh&&")"==re.type&&"stat"==re.prev.type&&(re=re.prev);jg=re.type;$g=Re==jg;return(ih=Jc._string)&&ih.trimLeft().startsWith("?")&&":"===Re?ih.indexOf("?"):ih&&":"===Jc.lastType&&"}"!==re.type?ih.match(/^\s*/)[0].length:"vardef"==jg?(Rd=re.indented+re.info+2+Jc.localVars.name.length,"?"===Re||":"===Re||"|"===Re||"&"===Re?Rd:","==Jc.lastType?
re.indented+re.info+1:"operator"==Jc.lastType?Rd+3:re.indented):"form"==jg&&"{"==Re?re.indented:"form"==jg?re.indented+xg:"stat"==jg?(Re=re.indented,Jc="operator"==Jc.lastType||","==Jc.lastType||Th.test(Rd.charAt(0))||/[,.]/.test(Rd.charAt(0)),Re+(Jc?dh||xg:0)):"switch"!=re.info||$g||0==Oc.doubleIndentSwitch?re.align?re.column+($g?0:1):re.indented+($g?0:xg):re.indented+(/^(?:case|default)\b/.test(Rd)?xg:2*xg)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:Vg?null:"/*",blockCommentEnd:Vg?
null:"*/",lineComment:Vg?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:Vg?"json":"javascript",jsonldMode:nh,jsonMode:Vg,expressionAllowed:vd.expressionAllowed,skipExpression:function(Jc){var Rd=Jc.cc[Jc.cc.length-1];Rd!=Ub&&Rd!=Ne||Jc.cc.pop()}}});vd.registerHelper("wordChars","javascript",/[\w$]/);vd.defineMIME("text/javascript","javascript");vd.defineMIME("text/ecmascript","javascript");vd.defineMIME("application/javascript","javascript");vd.defineMIME("application/x-javascript",
"javascript");vd.defineMIME("application/ecmascript","javascript");vd.defineMIME("application/json",{name:"javascript",json:!0});vd.defineMIME("application/x-json",{name:"javascript",json:!0});vd.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});vd.defineMIME("text/typescript",{name:"javascript",typescript:!0});vd.defineMIME("application/typescript",{name:"javascript",typescript:!0});var Xd=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");Xd.string=gd;Xd.JavaScriptChecker=
Yb;Xd.JavaScriptNavigator=ie;Xd.completers=tc;Xd.jsSnippets=uc;Xd.jsIdeCommands=Fc;Xd.jsEditorCommands=fb;Xd.astEditorCommands=Uc;Xd.CodeMirrorEnabledEditorPlugin=ge;Xd.Snippet=Rc;Xd.parser=Ad;Xd.localInterface=qc;Xd.systemInterfaceNamed=td;Xd.serverInterfaceFor=be;Xd.l2lInterfaceFor=Bd;Yb=function(vc){var Oc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),pc=Oc.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof Oc.JavaScriptEditorPlugin?Oc.JavaScriptEditorPlugin:Oc.JavaScriptEditorPlugin=
function(bb){bb&&bb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(pc,vc,[{key:Symbol.for("lively-instance-initialize"),value:function(){Vb._get(Object.getPrototypeOf(pc.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new Xd.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(bb){Vb._get(Object.getPrototypeOf(pc.prototype),"attach",this).call(this,bb);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:bb})}},{key:"detach",value:function(bb){this.checker.uninstall(this.textMorph);Vb._get(Object.getPrototypeOf(pc.prototype),"detach",this).call(this,bb)}},{key:"getNavigator",value:function(){return new Xd.JavaScriptNavigator}},{key:"getCompleters",value:function(bb){return Xd.completers.concat(bb)}},
{key:"getCommands",value:function(bb){return[].concat($jscomp.arrayFromIterable(Vb._get(Object.getPrototypeOf(pc.prototype),"getCommands",this).call(this,bb)),$jscomp.arrayFromIterable(Xd.jsIdeCommands),$jscomp.arrayFromIterable(Xd.jsEditorCommands),$jscomp.arrayFromIterable(Xd.astEditorCommands))}},{key:"getKeyBindings",value:function(bb){return[].concat($jscomp.arrayFromIterable(bb),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(bb){var Ma=this,oa,La,Ua,Sb,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Va){oa=Ma.textMorph;La=[{command:"doit",target:oa,showKeyShortcuts:!0},{command:"inspectit",target:oa,showKeyShortcuts:!0},{command:"editit",target:oa,showKeyShortcuts:!0},{command:"printit",target:oa,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:oa,showKeyShortcuts:!0},{command:"eval all",target:oa,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:oa,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:oa,showKeyShortcuts:!0},{isDivider:!0}];Ma.evalEnvironment.targetModule&&La.push({command:"[javascript] inject import",alias:"add import",target:oa},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:oa},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:oa});Ua=Ma.getNavigator();(Sb=Ua.resolveIdentifierAt(oa,
oa.cursorPosition))&&La.push({command:"selectDefinition",alias:'jump to definition of "'+Sb.name+'"',target:oa},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+Sb.name+'"',target:oa});(Ca=oa.selection.text.trim())&&La.push({command:"open code search",alias:'code search for "'+Xd.string.truncate(Ca,30)+'"',target:oa.world(),args:{input:Ca,backend:Ma.backend()}});La.push({isDivider:!0});return Va.return(La.concat(bb))})}},{key:"getSnippets",value:function(){return Xd.jsSnippets.map(function(bb){var Ma=
$jscomp.makeIterator(bb);bb=Ma.next().value;Ma=Ma.next().value;return new Xd.Snippet({trigger:bb,expansion:Ma})})}},{key:"sanatizedJsEnv",value:function(bb){bb=Object.assign({},this.evalEnvironment,{},bb);bb.format||(bb.formatd="esm");bb.context||(bb.context=this.textMorph);bb.sourceURL||(bb.sourceURL=bb.targetModule+"_doit_"+Date.now());bb.systemInterface||(bb.systemInterface=Xd.localInterface);return bb}},{key:"backend",value:function(bb){bb=this.sanatizedJsEnv(bb);return bb.remote?bb.remote:"local"}},
{key:"systemInterface",value:function(bb){return this.sanatizedJsEnv(bb).systemInterface||Xd.localInterface}},{key:"setSystemInterface",value:function(bb){return this.evalEnvironment.systemInterface=bb}},{key:"setSystemInterfaceNamed",value:function(bb){return this.setSystemInterface(Xd.systemInterfaceNamed(bb))}},{key:"runEval",value:function(bb,Ma){Ma=this.sanatizedJsEnv(Ma);return this.systemInterface(Ma).runEval(bb,Ma)}},{key:"parser",get:function(){return Xd.parser}},{key:"parse",value:function(bb){bb=
void 0===bb?null:bb;if(this._ast&&this._ast._astType===bb)return this._ast;var Ma=this.parser,oa=this.textMorph.textString;if(!Ma)return null;var La={withComments:!0,allowReturnOutsideFunction:!0};bb&&(La.type=bb);if(oa.startsWith("#!")){var Ua=oa.indexOf("\n");oa=" ".repeat(Ua)+oa.slice(Ua)}Ma=Ma.fuzzyParse(oa,La);Ma._astType=bb;return this._ast=Ma}},{key:"undeclaredVariables",value:function(bb){var Ma=this.parser,oa=this.evalEnvironment.knownGlobals||[];bb=this.parse(void 0===bb?null:bb);return Ma&&
bb?Ma.query.findGlobalVarRefs(bb,{jslintGlobalComment:!0}).filter(function(La){return!oa.includes(La.name)}):[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],Oc,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(Xd.CodeMirrorEnabledEditorPlugin);
Yb=Xd.JavaScriptEditorPlugin;$a("default",Yb);Xd.default=Yb}}});
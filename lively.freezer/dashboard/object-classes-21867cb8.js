System.register(["./__root_module__-7efb35ac.js","kld-intersections"],function(Ba){var Cb,Sb,jc,lc,Xd,ed,Yd,id,Wc,Ad,Cd,fe,Sd,jd,bb;return{setters:[function(Fb){Cb=Fb.s;Sb=Fb.P;jc=Fb.a4;lc=Fb.p;Xd=Fb.bE;ed=Fb.B;Yd=Fb.bF;id=Fb.r;Wc=Fb.aQ;Ad=Fb.bG;Cd=Fb.bH;fe=Fb.bI;Sd=Fb.bJ;jd=Fb.bK;bb=Fb.n},function(){}],execute:function(){function Fb(tc,bd,Xb,Tb){Tb=void 0===Tb?{}:Tb;Tb=Tb.package||pc.ObjectPackage.lookupPackageForObject(tc,Tb);if(!Tb)throw Error("Object is not part of an object package: "+tc);
return Tb.addScript(tc,bd,Xb)}function vc(tc,bd){bd=pc.normalizeOptions(bd).System;tc=(tc=tc[Symbol.for("lively-module-meta")])?tc.package.name:null;return(bd=(tc?pc.lookupPackage(bd,tc):{}).pkg)?!!pc.ObjectPackage.forSystemPackage(bd):!1}Ba({addScript:Fb,isObjectClass:vc});var pc=lively.FreezerRuntime.recorderFor("lively.classes/object-classes.js");pc.normalizeOptions=function(tc){tc=Object.assign({baseURL:pc.defaultBaseURL,System:System},tc);tc.baseURL=tc.baseURL.replace(/\/$/,"");return tc};pc.addScript=
Fb;pc.isObjectClass=vc;pc.string=Cb;pc.Path=Sb;pc.arr=jc;pc.parse=lc;pc.isValidIdentifier=Xd;pc.stringify=ed;pc.parseFunction=Yd;pc.resource=id;pc.runEval=Wc;pc.scripting=Ad;pc.ExportLookup=Cd;var sd=pc.scripting;pc.ensurePackage=sd.ensurePackage;pc.registerPackage=sd.registerPackage;pc.importPackage=sd.importPackage;pc.lookupPackage=sd.lookupPackage;pc.module=sd.module;pc.ImportInjector=sd.ImportInjector;pc.RuntimeSourceDescriptor=fe;pc.toJsIdentifier=Sd;pc.adoptObject=jd;pc.classToFunctionTransform=
bb;pc.objectPackageSym=Symbol.for("lively-object-package-data");pc.defaultBaseURL="local://lively-object-modules";pc.globalClasses=Object.keys(System.global).map(function(tc){tc=System.global[tc];return"function"===typeof tc&&tc.name&&tc}).filter(Boolean);pc.addScript=Fb;pc.addScript=Fb;pc.isObjectClass=vc;pc.isObjectClass=vc;pc._packageStore=pc._packageStore||{};sd=function(tc,bd){this._id=tc;this.options=pc.normalizeOptions(bd)};sd.lookupPackageForObject=function(tc,bd){return this.lookupPackageForClass(tc.constructor,
bd)};sd.lookupPackageForClass=function(tc,bd){bd=pc.normalizeOptions(bd).System;tc=(tc=tc[Symbol.for("lively-module-meta")])?tc.package.name:null;return(bd=(tc?pc.lookupPackage(bd,tc):{}).pkg)?pc.ObjectPackage.forSystemPackage(bd):null};sd.forSystemPackage=function(tc){return this.packageStore[tc.name]};sd.withId=function(tc,bd){return this.packageStore[tc]||(this.packageStore[tc]=new this(tc,bd))};sd.prototype.resource=function(tc){tc=void 0===tc?"":tc;return pc.resource(this.packageURL).join(tc)};
sd.prototype.load=function(){return pc.importPackage(this.System,this.packageURL)};sd.prototype.ensureExistance=function(){var tc=this,bd,Xb,Tb,Oc,td,Pb,tb,hb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qb){switch(qb.nextAddress){case 1:return bd=tc.resource("/"),qb.yield(bd.exists(),2);case 2:if(qb.yieldResult)return qb.return();Xb=[{resource:bd}];Tb=[{resource:tc.resource("package.json"),content:JSON.stringify(tc.config,null,2)}];return qb.yield(Promise.all(Xb.map(function(za){return za.resource.mkdir()})),
3);case 3:return qb.yield(Promise.all(Tb.map(function(za){var cb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){switch(wb.nextAddress){case 1:return wb.yield(za.resource.exists(),2);case 2:if(!(cb=!wb.yieldResult)){wb.jumpTo(3);break}return wb.yield(za.resource.write(za.content),4);case 4:cb=wb.yieldResult;case 3:return wb.return(cb)}})})),4);case 4:return qb.yield(tc.objectModule.ensureExistance(),5);case 5:return Oc=tc,td=Oc.System,Pb=Oc.packageURL,tb=Oc.config,qb.yield(pc.ensurePackage(td,
Pb),6);case 6:return hb=qb.yieldResult,hb.registerWithConfig(tb),console.log(tc.packageURL+" REGISTERED"),qb.return(tc)}})};sd.prototype.ensureObjectClass=function(tc){var bd=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xb){return 1==Xb.nextAddress?Xb.yield(bd.ensureExistance(),2):Xb.return(bd.objectModule.ensureObjectClass(tc))})};sd.prototype.adoptObject=function(tc){var bd=this,Xb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tb){if(1==Tb.nextAddress)return bd.objectClass===
tc.constructor?Tb.return():Tb.yield(bd.ensureObjectClass(tc.constructor),2);Xb=Tb.yieldResult;pc.adoptObject(tc,Xb);Tb.jumpToEnd()})};sd.prototype.addScript=function(tc,bd,Xb){return this.objectModule.addScript(tc,bd,Xb)};sd.prototype.remove=function(){this.systemPackage.remove();delete pc.ObjectPackage.packageStore[this.id];return this.resource().remove()};sd.prototype.renameObjectClass=function(tc,bd){bd=void 0===bd?[]:bd;var Xb=this,Tb,Oc,td,Pb,tb,hb,qb,za,cb,wb,Hb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ub){if(1==
Ub.nextAddress){Tb=Xb;Oc=Tb.objectClass;td=Tb.System;if(!Oc||Oc.className===tc)return Ub.return(Oc);if(!pc.isValidIdentifier(tc))throw Error(tc+" is not a valid name for a class");tb=Pb=pc.RuntimeSourceDescriptor.for(Oc,td);hb=tb.source;qb=tb.ast;za=qb.id;cb=za.start;wb=za.end;return Ub.yield(Pb.changeSource(hb.slice(0,cb)+tc+hb.slice(wb)),2)}Hb=Xb.objectClass;bd.forEach(function(lb){lb.constructor=Hb;lb.__proto__=Hb.prototype});return Ub.return(Hb)})};sd.prototype.fork=function(tc,bd){var Xb=this,
Tb,Oc,td,Pb,tb,hb,qb,za,cb,wb,Hb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ub){switch(Ub.nextAddress){case 1:return Tb=Xb,Oc=Tb.System,td=Tb.baseURL,Pb=Tb.objectClass,bd=Object.assign({System:Oc,baseURL:td},bd),tb=pc.RuntimeSourceDescriptor.for(Pb),hb=tb._renamedSource(tc),qb=hb.moduleSource,za=pc.ObjectPackage.withId(tc,bd),Ub.yield(za.ensureExistance(),2);case 2:return cb=za,wb=cb.objectModule,Hb=wb.systemModule,Ub.yield(Hb.load({format:"esm"}),3);case 3:return Ub.yield(Hb.changeSource(qb),
4);case 4:return Ub.return(za)}})};$jscomp.global.Object.defineProperties(sd.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},name:{configurable:!0,enumerable:!0,get:function(){return this.id}},System:{configurable:!0,enumerable:!0,get:function(){return this.options.System}},baseURL:{configurable:!0,enumerable:!0,get:function(){return this.options.baseURL}},packageURL:{configurable:!0,enumerable:!0,get:function(){return this.baseURL+("/"+this.id)}},config:{configurable:!0,
enumerable:!0,get:function(){return{name:this.name,version:"0.1.0",lively:{isObjectPackage:!0}}}},systemPackage:{configurable:!0,enumerable:!0,get:function(){return pc.lookupPackage(this.System,this.packageURL,!0).pkg}},objectModule:{configurable:!0,enumerable:!0,get:function(){return this._objectModule||(this._objectModule=new pc.ObjectModule("index.js",this))}},objectClass:{configurable:!0,enumerable:!0,get:function(){return this.objectModule.objectClass}}});$jscomp.global.Object.defineProperties(sd,
{packageStore:{configurable:!0,enumerable:!0,get:function(){return this._packageStore||(this._packageStore=pc._packageStore)}}});Ba("default",sd);pc.ObjectPackage=sd;var pd=function(tc,bd){if(!tc)throw Error("ObjectModule needs package!");if(!bd)throw Error("ObjectModule needs package!");this._moduleName=tc;this._objectPackage=bd};pd.prototype.read=function(){return this.resource.read()};pd.prototype.write=function(tc){return this.resource.write(tc)};pd.prototype.ensureExistance=function(){var tc=
this,bd,Xb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tb){switch(Tb.nextAddress){case 1:return bd=tc.resource,Tb.yield(bd.exists(),2);case 2:if(Tb.yieldResult){Tb.jumpTo(3);break}return Tb.yield(bd.write("'format esm';\n"),4);case 4:Xb={},tc.System.config({meta:(Xb[tc.url]={format:"esm"},Xb)});case 3:return Tb.return(tc)}})};pd.prototype.ensureObjectClass=function(tc){var bd=this,Xb=this.objectClass;return Xb&&Xb.prototype.__proto__===tc.prototype?Xb:Promise.resolve(this.ensureObjectClassSource(tc)).then(function(Tb){var Oc=
Tb.source,td=Tb.moduleId,Pb=Tb.className,tb=Tb.bindings,hb=bd.System;Tb=pc.module(hb,td);if(tb)for(var qb in tb)Tb.define(qb,tb[qb]);Oc=pc.runEval(Oc,{classTransform:pc.classToFunctionTransform,sync:!0,targetModule:td,System:hb});if(Oc.isError)throw Oc.value;Oc=Tb.recorder[Pb];if(!Oc)throw Error("Failed to define class "+Pb+" in "+td);return Oc})};pd.prototype.ensureObjectClassSource=function(tc){return this.createDefaultClassDeclaration(tc)};pd.prototype.createDefaultClassDeclaration=function(tc){tc=
void 0===tc?Object:tc;var bd=this,Xb,Tb,Oc,td,Pb,tb,hb,qb,za,cb,wb,Hb,Ub,lb,mb,Qb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gc){switch(Gc.nextAddress){case 1:Xb=bd;Tb=Xb.System;Oc=Xb.systemModule;td=Xb.objectPackage;Pb=pc.string.capitalize(pc.toJsIdentifier(td.id));tb=tc.className;hb=!tb;qb=pc.globalClasses.includes(tc);za="";cb=null;if(hb){tb="__anonymous_superclass__";wb={};cb=(wb[tb]=tc,wb);Gc.jumpTo(2);break}if(qb){Gc.jumpTo(2);break}return Gc.yield(pc.ExportLookup.findExportOfValue(tc,
Tb),4);case 4:(Hb=Gc.yieldResult)?(Ub=pc.ImportInjector.run(Tb,Oc.id,Oc.package(),"",Hb),lb=Ub.standaloneImport,za+=lb+"\n\n"):(mb={},cb=(mb[tb]=tc,mb));case 2:return Pb===tb&&(Pb="Object"+Pb),Qb="Object"===tb?"class "+Pb+" {}\n":"class "+Pb+" extends "+tb+" {}\n",za+="export default "+Qb+"\n",Gc.yield(Oc.changeSource(za),5);case 5:return Gc.yield(Oc.load(),6);case 6:return Gc.return({source:za,className:Pb,moduleId:bd.url,bindings:cb})}})};pd.prototype.addScript=function(tc,bd,Xb){var Tb=this,Oc,
td,Pb,tb,hb,qb,za,cb,wb,Hb,Ub,lb,mb,Qb,Gc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mc){switch(mc.nextAddress){case 1:if(tc.constructor===Tb.objectClass){Oc=tc.constructor;mc.jumpTo(2);break}return mc.yield(Tb.ensureObjectClass(tc.constructor),3);case 3:Oc=mc.yieldResult;case 2:td=Oc;Pb="function"===typeof bd?String(bd):bd;tb=pc.parseFunction(Pb);hb=pc.RuntimeSourceDescriptor.for(td,Tb.System);Xb||(Xb=pc.Path("id.name").get(tb));if(!Xb)throw Error("No name, cannot add "+pc.string.truncate(Pb,
30).replace(/\n/g,"")+"!");qb=pc.toJsIdentifier(Xb);console.assert("FunctionExpression"===tb.type||"ArrowFunctionExpression"===tb.type,"not a function expression but: "+tb.type);za=tb.params.map(function(Pc){return Pb.slice(Pc.start,Pc.end)});cb="BlockStatement"===tb.body.type?Pb.slice(tb.body.start,tb.body.end):"{ return "+Pb.slice(tb.body.start,tb.body.end)+" }";wb=qb+"("+za.join(",")+") "+cb;"ArrowFunctionExpression"===tb.type&&(tb.type="FunctionExpression");Hb=hb.source;Ub=hb.ast;if(!Ub)throw Error("cannot find class decl of "+
hb.module.id);(lb=Ub.body.body.find(function(Pc){return Pc.key.name===qb&&!Pc.static}))?Hb=Hb.slice(0,lb.start)+wb+Hb.slice(lb.end):(mb=Hb.lastIndexOf("}"),Qb=Hb.slice(0,mb),Gc=Hb.slice(mb),/\n\s*$/m.test(Qb)||(Qb+="\n"),wb=pc.string.changeIndent(wb,"  ",1),/^[ ]*\n/m.test(Gc)||(Gc="\n"+Gc),Hb=Qb+wb+Gc);return mc.yield(hb.changeSource(Hb),4);case 4:return mc.return({script:td.prototype[qb],klass:td,module:hb.module.id,methodName:qb})}})};$jscomp.global.Object.defineProperties(pd.prototype,{objectPackage:{configurable:!0,
enumerable:!0,get:function(){return this._objectPackage}},objectClass:{configurable:!0,enumerable:!0,get:function(){var tc=this.systemModule;return tc.isLoaded()?tc.System.get(tc.id).default:null}},moduleName:{configurable:!0,enumerable:!0,get:function(){return this._moduleName}},systemModule:{configurable:!0,enumerable:!0,get:function(){return pc.module(this.System,this.url)}},System:{configurable:!0,enumerable:!0,get:function(){return this.objectPackage.System}},resource:{configurable:!0,enumerable:!0,
get:function(){return this.objectPackage.resource(this.moduleName)}},url:{configurable:!0,enumerable:!0,get:function(){return this.resource.url}}});pc.ObjectModule=pd;pc.default=sd}}});
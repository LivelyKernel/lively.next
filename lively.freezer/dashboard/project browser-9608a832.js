System.register(["./__root_module__-5a58cfed.js","kld-intersections","./user-ui-f14b43d5.js","./index-0f8ae983.js","./index-0e8213f8.js"],function(Ca,Cb){var Vb,lc,gc,fe,fd,Zd,id,Uc,Ad,Nd,ee,Ud,kd,cb,Fb,vc,pc,sd,pd;return{setters:[function(tc){Vb=tc.ag;lc=tc.az;gc=tc.ai;fe=tc.al;fd=tc.Y;Zd=tc.a4;id=tc.ar;Uc=tc.s;Ad=tc.C;Nd=tc.a1;ee=tc.r;Ud=tc.aq;kd=tc.ay;cb=tc.aZ;Fb=tc.a_;vc=tc.ao;pc=tc.aW;sd=tc.aV},function(){},function(tc){pd=tc.UserUI},function(){},function(){}],execute:function(){var tc=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");tc.Morph=Vb;tc.HorizontalLayout=lc;tc.VerticalLayout=gc;tc.morph=fe;tc.MorphicDB=fd;tc.arr=Zd;tc.fun=id;tc.string=Uc;tc.Color=Ad;tc.pt=Nd;tc.UserUI=pd;tc.resource=ee;var bd=function(Oc){var td=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),Ob=td.hasOwnProperty("WorldDashboard")&&"function"===typeof td.WorldDashboard?td.WorldDashboard:td.WorldDashboard=function(sb){sb&&sb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ud(Ob,Oc,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(sb){sb=void 0===sb?$world:sb;this.owner!=sb&&sb.addMorph(this);this.center=sb.visibleBounds().center()}},{key:"sortAndFilterPreviews",
value:function(sb){var hb=tc.UserUI.getCurrentUser();sb=this.ui.searchField.fuzzyFilter(sb,function(qb){return qb._commit.name+qb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return tc.arr.sortBy(sb,function(qb){return-qb._commit.timestamp});case "TEMPLATES":return sb;case "MY PROJECTS":return tc.arr.filter(sb,function(qb){return qb._commit.author.name===hb.name});case "PUBLISHED":return sb}}},{key:"updateList",value:function(){var sb=this;this.previews&&tc.fun.debounceNamed("update world list",
150,function(){sb.ui.worldList.items=sb.sortAndFilterPreviews(sb.previews)})()}},{key:"displayWorlds",value:function(){var sb=this,hb,qb,Aa,bb,wb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hb){switch(Hb.nextAddress){case 1:return sb.reset(),hb=sb.ui,qb=hb.loadingLabel,qb.visible=!0,qb.animate({opacity:1,duration:300}),Hb.yield(sb.db.latestCommits("world"),2);case 2:return Aa=Hb.yieldResult,Hb.yield(Cb.import("./world preview-df706098.js"),4);case 4:if(!(bb=Hb.yieldResult)){Hb.jumpTo(5);
break}return Hb.yield(tc.resource("part://partial freezing/world preview"),6);case 6:bb=Hb.yieldResult;case 5:return Hb.yield(bb.read(),3);case 3:return wb=Hb.yieldResult,sb.previews=Aa.map(function(Qb){var lb=tc.morph({reactsToPointer:!1,fill:tc.Color.transparent,extent:wb.extent});lb._commit=Qb;lb.displayPreview=function(){var mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rb){if(1==Rb.nextAddress)return mb=wb.copy(),mb._commit=Qb,mb.opacity=0,lb.addMorph(mb),mb.displayPreview(),
mb.position=tc.pt(0,0),Rb.yield(lb.whenRendered(),2);lb.layout=new tc.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});Rb.jumpToEnd()})};return lb}),Hb.yield(qb.animate({opacity:0,duration:300}),7);case 7:qb.visible=!1,sb.updateList(),0==Aa.length&&(sb.ui.noWorldWarning.center=sb.innerBounds().center(),sb.ui.noWorldWarning.animate({visible:!0,duration:300})),Hb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:"className",
get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(sb){this.ui.closeButton.visible=sb}},db:{serialize:!1,get:function(){return tc.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),
loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],td,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-124"}}},{start:330,end:4020})}(tc.Morph);bd=tc.WorldDashboard;tc.default=bd;var Xb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");
Xb.Morph=Vb;Xb.touchInputDevice=kd;Xb.TilingLayout=cb;Xb.arr=Zd;Xb.pt=Nd;bd=function(Oc){var td=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),Ob=td.hasOwnProperty("GrowingWorldList")&&"function"===typeof td.GrowingWorldList?td.GrowingWorldList:td.GrowingWorldList=function(sb){sb&&sb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ud(Ob,Oc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(sb){Ud._get(Object.getPrototypeOf(Ob.prototype),
"onScroll",this).call(this,sb);this.update()}},{key:"onChange",value:function(sb){Ud._get(Object.getPrototypeOf(Ob.prototype),"onChange",this).call(this,sb);"extent"==sb.prop&&this.update(!0)}},{key:"onHoverIn",value:function(sb){this.clipMode="auto"}},{key:"onHoverOut",value:function(sb){Xb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(sb){var hb=this.items;if(hb&&0!=hb.length){var qb=this.scrollContainer,Aa=qb.layout.spacing;qb.extent=this.extent;var bb=this.ui,wb=bb.bufferTop;
bb=bb.bufferBottom;wb=wb||qb.addMorph({fill:null,name:"buffer top",height:10});bb=bb||qb.addMorph({fill:null,name:"buffer bottom",height:10});wb.width=bb.width=this.width-100;qb.layout.disable();var Hb=hb[0];Aa=hb.slice(0,Math.floor(this.width/(Hb.width+Aa))*(Math.ceil((this.scroll.y+this.height)/(Hb.height+Aa))+1)).filter(function(Rb){return Rb.owner!=qb});Hb=this.scroll.y+2*this.height;for(var Qb={},lb=$jscomp.makeIterator(Aa),mb=lb.next();!mb.done;Qb={$jscomp$loop$prop$item$2287:Qb.$jscomp$loop$prop$item$2287},
mb=lb.next())Qb.$jscomp$loop$prop$item$2287=mb.value,Hb++,Qb.$jscomp$loop$prop$item$2287.top=Hb,qb.addMorph(Qb.$jscomp$loop$prop$item$2287),Qb.$jscomp$loop$prop$item$2287._initialized||Qb.$jscomp$loop$prop$item$2287.whenRendered().then(function(Rb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gc){Rb.$jscomp$loop$prop$item$2287._initialized=!0;return Gc.yield(Rb.$jscomp$loop$prop$item$2287.displayPreview(),0)})}}(Qb));sb&&(wb.position=Xb.pt(0,0),hb.forEach(function(Rb,
Gc){return Rb.position=Xb.pt(Gc+1,Gc+1)}),bb.position=Xb.pt(hb.length+2,hb.length+2));qb.layout.enable();if(sb||0<Aa.length)bb.top=this.submorphBounds().height,qb.layout.apply()}}}],[{key:"className",get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Xb.TilingLayout({spacing:25,align:"center",
autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(sb){this.setProperty("items",sb);var hb=this.scrollContainer;hb.layout&&hb.layout.disable();var qb=this.ui,Aa=qb.bufferTop;qb=qb.bufferBottom;Xb.arr.withoutAll(hb.submorphs,[].concat($jscomp.arrayFromIterable(sb),[Aa,qb])).forEach(function(bb){return bb.remove()});this.update(!0)}}}}}],td,{pathInPackage:function(){return"index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Xb.Morph);bd=Xb.GrowingWorldList;Xb.default=bd;var Tb=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");Tb.InputLine=Fb;Tb.Color=Ad;Tb.connect=vc;Tb.disconnectAll=pc;Tb.disconnect=sd;Tb.arr=Zd;Tb.string=Uc;bd=function(Oc){var td=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),
Ob=td.hasOwnProperty("SearchInputLine")&&"function"===typeof td.SearchInputLine?td.SearchInputLine:td.SearchInputLine=function(sb){sb&&sb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ud(Ob,Oc,[{key:"fuzzyMatch",value:function(sb,hb){hb=void 0===hb?this.parseInput():hb;if(hb.lowercasedTokens.every(function(Aa){return sb.toLowerCase().includes(Aa)}))return!0;var qb=sb.toLowerCase();return 3>=Tb.arr.sum(hb.lowercasedTokens.map(function(Aa){return Tb.string.levenshtein(qb,
Aa)}))}},{key:"fuzzyFilter",value:function(sb,hb){var qb=this;hb=void 0===hb?function(bb){return bb}:hb;var Aa=this.parseInput();return Tb.arr.filter(sb,function(bb){return qb.fuzzyMatch(hb(bb),Aa)})}},{key:"parseInput",value:function(){var sb=Array.from(this.textString).reduce(function(qb,Aa){if("\\"===Aa&&!qb.escaped)return qb.escaped=!0,qb;" "!==Aa||qb.escaped?(qb.spaceSeen=!1,qb.current+=Aa):(!qb.spaceSeen&&qb.current&&(qb.tokens.push(qb.current),qb.current=""),qb.spaceSeen=!0);qb.escaped=!1;
return qb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});sb.current&&sb.tokens.push(sb.current);var hb=sb.tokens.map(function(qb){return qb.toLowerCase()});return{tokens:sb.tokens,lowercasedTokens:hb}}}],[{key:"className",get:function(){return"SearchInputLine"}}],td,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",
version:"0.1.1-4"}}},{start:239,end:1834})}(Tb.InputLine);bd=Tb.SearchInputLine;Tb.default=bd}}});
System.register(["./__root_module__-37c88ebd.js","./index-d63033cc.js","./index-9714fb53.js"],function(Wa){var Ib,Sb,xc,ac,Cd,nd,Ud,bd,Ic,pd,yd,Ne,Pe,Ie,fd,me,Yb,Yc,Nd,gd,ae,Fe,Wb,Cc,Td,Ec,Vd,Lb,ub,uc,dc,Zb,Mc,$a,$b,Eb,kc,tc,Sc,Pd,ec,Xb,Jb;return{setters:[function(Ra){Ib=Ra.C;Sb=Ra.i;xc=Ra.b;ac=Ra.R;Cd=Ra.p;nd=Ra.m;Ud=Ra.bq;bd=Ra.br;Ic=Ra.d;pd=Ra.c;yd=Ra.at;Ne=Ra.bz;Pe=Ra.bA;Ie=Ra._;fd=Ra.o;me=Ra.n;Yb=Ra.g;Yc=Ra.bB;Nd=Ra.bC;gd=Ra.a2;ae=Ra.P;Fe=Ra.a;Wb=Ra.a1;Cc=Ra.M;Td=Ra.T;Ec=Ra.ad;Vd=Ra.ah;
Lb=Ra.S;ub=Ra.I;uc=Ra.h;dc=Ra.bD;Zb=Ra.v;Mc=Ra.bE;$a=Ra.aE;$b=Ra.bs;Eb=Ra.aD;kc=Ra.bF;tc=Ra.f},function(Ra){Sc=Ra.M;Pd=Ra.I;ec=Ra.v;Xb=Ra.p},function(Ra){Jb=Ra.localInterface}],execute:function(){function Ra(cb,Va){if(!0===Va)return Va;if(cb.copyState)return cb.copyState(Va);cb={};for(var cc in Va){var Ba=Va[cc];Ba instanceof Array&&(Ba=Ba.concat([]));cb[cc]=Ba}return cb}function Ga(cb,Va,cc){return cb.startState?cb.startState(Va,cc):!0}function ea(cb,Va){return Gc.modes[cb]=Va}function Da(cb){if("string"===
typeof cb&&Gc.mimeModes.hasOwnProperty(cb))cb=Gc.mimeModes[cb];else if(cb&&"string"===typeof cb.name&&Gc.mimeModes.hasOwnProperty(cb.name)){var Va=Gc.mimeModes[cb.name];"string"===typeof Va&&(Va={name:Va});cb=Object.assign({},Va,cb);cb.name=Va.name}else{if("string"===typeof cb&&/^[\w\-]+\/[\w\-]+\+xml$/.test(cb))return Da("application/xml");if("string"===typeof cb&&/^[\w\-]+\/[\w\-]+\+json$/.test(cb))return Da("application/json")}return"string"===typeof cb?{name:cb}:cb||{name:"null"}}function ta(cb,
Va){Va=Gc.resolveMode(Va);"string"===typeof Va&&(Va={name:Va});if(!Va.name)throw Error("parserConfig does not have a name of the mode to get");var cc=Gc.modes[Va.name];if(!cc)return ta(cb,"text/plain");cb=Object.assign({indentUnit:2},cb);return Object.assign(cc(cb,Va),{name:Va.name})}function Pa(cb,Va){for(var cc;cb.innerMode;){cc=cb.innerMode(Va);if(!cc||cc.mode==cb)break;Va=cc.state;cb=cc.mode}return cc||{mode:cb,state:Va}}function Ha(cb,Va){Gc.mimeModes[cb]=Va}function tb(cb,Va,cc){}function Ac(cb,
Va,cc,Ba,Ja,Sa,ba){var Fb=cb.editorPlugin._tokenizerValidBefore;Fb&&Fb.row>=cc&&(Fb.row=cc-1);var va=Gc.linesToTokenize(cb.document,cc,Ba,Fb);Fb=va.lines;va=va.state;if(!Fb.length)return!1;va=va?Gc.copyState(Va,va):Gc.startState(Va);for(var Ua=0;Ua<Fb.length;Ua++){var mb=Fb[Ua],Ub=mb.row;Ub>=cc&&Ub<=Ba&&Gc.indentLine(cb,Va,mb,va,Ja,Sa,ba);va=Gc.tokenizeLine(Va,Fb[Ua],va,function(){})}return!0}function wb(cb,Va,cc,Ba,Ja,Sa,ba){Va=Gc.linesToTokenize(Va,cc,Ba,Ja);cc=Va.lines;Gc.tokenizeLines(cb,cc,Va.state,
Sa,ba);return cc}function ud(cb,Va,cc,Ba,Ja){var Sa=[],ba,Fb=function(mb){return Sa.push(ba=[])},va=function(mb,Ub,yc,Pc,Zc,Qc,Ld){return ba.push(yc,Pc,mb,Zc.current(),Ub.localMode||Ld)};try{var Ua=Gc.visitDocumentTokens(cb,Va,cc,Ba,Ja,Fb,va)}catch(mb){Sa.length=0,Ua=Gc.visitDocumentTokens(cb,Va,cc,Ba,null,Fb,va)}return{tokens:Sa,lines:Ua}}function Tb(cb,Va,cc,Ba,Ja){null==Va&&(Va=cb.search(/[^\s\u00a0]/),-1==Va&&(Va=cb.length));Ba=Ba||0;for(Ja=Ja||0;;){var Sa=cb.indexOf("\t",Ba);if(0>Sa||Sa>=Va)return Ja+
(Va-Ba);Ja+=Sa-Ba;Ja+=cc-Ja%cc;Ba=Sa+1}}function te(cb){cb=cb.toLowerCase();for(var Va=0;Va<Gc.modeInfo.length;Va++){var cc=Gc.modeInfo[Va];if(cc.mime==cb)return cc;if(cc.mimes)for(var Ba=0;Ba<cc.mimes.length;Ba++)if(cc.mimes[Ba]==cb)return cc}if(/\+xml$/.test(cb))return te("application/xml");if(/\+json$/.test(cb))return te("application/json")}function cd(cb){for(var Va=0;Va<Gc.modeInfo.length;Va++){var cc=Gc.modeInfo[Va];if(cc.ext)for(var Ba=0;Ba<cc.ext.length;Ba++)if(cc.ext[Ba]==cb)return cc}}function Lc(cb){for(var Va=
0;Va<Gc.modeInfo.length;Va++){var cc=Gc.modeInfo[Va];if(cc.file&&cc.file.test(cb))return cc}Va=cb.lastIndexOf(".");if(cb=-1<Va&&cb.substring(Va+1,cb.length))return Gc.findModeByExtension(cb)}function Hb(cb){cb=cb.toLowerCase();for(var Va=0;Va<Gc.modeInfo.length;Va++){var cc=Gc.modeInfo[Va];if(cc.name.toLowerCase()==cb)return cc;if(cc.alias)for(var Ba=0;Ba<cc.alias.length;Ba++)if(cc.alias[Ba].toLowerCase()==cb)return cc}}function Be(cb){if(!cb)return String(cb);if(Array.isArray(cb))return"["+cb.map(Be).join(",")+
"]";if("symbol"===typeof cb)return De.printSymbol(cb);try{return String(cb)}catch(Va){return"Cannot print object: "+Va}}function Ob(cb,Va){return!De.arr.every(Va.map(function(cc){return cb[cc]}),function(cc){return De.obj.equals(cc,cb&&cb.valueOf())})}function Gb(cb){if(De.obj.isPrimitive(cb))var Va=De.string.print(cb);else Array.isArray(cb)?((Va=3<cb.length)&&(cb=cb.slice(0,3)),cb=De.string.print(cb),Va&&(cb=cb.slice(0,-1)+", ...]"),Va=cb):Va=De.string.print(cb);Va=Va.replace(/\n/g,"");500<Va.length&&
(Va=Va.slice(0,20)+("...["+(Va.length-20)+' CHARS]"'));return Va}function Ta(cb){return $c.Inspector.openInWindow({targetObject:cb})}function Y(cb,Va){return $c.Inspector.openInWindow({remoteTarget:{code:cb,evalEnvironment:Va}})}function Ma(cb,Va){function cc(Fb){var va=Fb.name,Ua=Fb.ownerChain(),mb=Fb.owner,Ub=Fb.world(),yc;Fb===Sa&&(yc=[ba]);Ub===Fb&&(yc=["$world"]);if(!yc&&va&&mb){mb===Ub&&1===$c.arr.count($c.arr.pluck(Ub.submorphs,"name"),va)&&(yc=['$world.get("'+va+'")']);if(!yc&&mb!=Ub)for(Ub=
Ua.length-1;Ub--;)if(1===Ua[Ub].getAllNamed(va).length){yc=[].concat($jscomp.arrayFromIterable(cc(Ua[Ub])),['get("'+va+'")']);break}yc||(va=[].concat($jscomp.arrayFromIterable(cc(mb)),['get("'+va+'")']),$c.syncEval(va.join("."),{context:Sa}).value===Fb&&(yc=va))}yc||(yc=[ba+'.getMorphById("'+Fb.id+'")']);return yc}Va=void 0===Va?{}:Va;var Ba=cb.world(),Ja=Va;Va=void 0===Ja.maxLength?10:Ja.maxLength;var Sa=void 0===Ja.fromMorph?Ba:Ja.fromMorph;if(Sa===cb)return"this";var ba=Ba===Sa?"$world":"this";
if(!(Ba||cb.name&&Sa.get(cb.name)===cb))return"morph";Ba=cc(cb);return Ba.length>Va?'$world.getMorphWithId("'+cb.id+'")':Ba.join(".")}function gb(cb,Va,cc){var Ba=(Va=void 0===Va?"":Va)&&id.arr.last(Va.split(".")).toLowerCase(),Ja="",Sa=0,ba=Math.pow(2,19);if("string"===typeof cb){if(cb.length>ba)return null}else if(cb.document.stringSize>ba)return null;if("string"===typeof cb)Ja=cb.slice(0,1E3);else for(cb=$jscomp.makeIterator(cb.document.lines),ba=cb.next();!ba.done;ba=cb.next()){var Fb=ba.value;
ba=Fb.stringSize;Fb=Fb.text;var va=!0;1E3<Sa+ba&&(va=!1,ba=1E3-Sa);Ja+=Fb.slice(0,ba)+(va?"\n":"");Sa+=ba;if(1E3<=Sa)break}Sa=$jscomp.makeIterator(id.modeInfo);for(cb=Sa.next();!cb.done;cb=Sa.next()){va=cb.value;ba=va.contentTest;cb=va.mode;Fb=va.ext;va=va.file;if("function"===typeof ba)try{if(ba(Ja))return cb}catch(Ua){}if(va&&va instanceof RegExp&&va.test(Va))return cb;if(Fb)for(ba=$jscomp.makeIterator(Fb),Fb=ba.next();!Fb.done;Fb=ba.next())if(Fb.value===Ba)return cb}return cc}Wa({a:Ha,d:ea,r:tb});
var Nb=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");Nb.Color=Ib;var oc=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),cc=Va.hasOwnProperty("DefaultTheme")&&"function"===typeof Va.DefaultTheme?Va.DefaultTheme:Va.DefaultTheme=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:"background",get:function(){return Nb.Color.white}},{key:"default",
get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Nb.Color.white,fontWeight:"bold",backgroundColor:Nb.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Nb.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Nb.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Va,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Wc=oc=Nb.DefaultTheme;Nb.default=oc;var Gc=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");Gc.copyState=Ra;Gc.startState=Ga;Gc.defineMode=ea;Gc.resolveMode=Da;Gc.getMode=ta;Gc.innerMode=Pa;Gc.defineMIME=Ha;Gc.registerHelper=tb;Gc.indentLines=Ac;Gc.indentLine=function(cb,Va,cc,Ba,Ja,Sa,ba){ba=Object.assign({indentWithTabs:!cb.useSoftTabs,indentUnit:cb.tabWidth,tabSize:4,ignoreFollowingText:!1},
ba);null==Ja&&(Ja="add");"smart"==Ja&&(Va.indent||(Ja="prev"));var Fb=ba.tabSize,va=cc.text,Ua=Gc.countColumn(va,null,Fb);cc.modeState&&(cc.modeState=null);var mb=va.match(/^\s*/)[0];if(!Sa&&!/\S/.test(va)){var Ub=0;Ja="not"}else if("smart"==Ja&&(Ub=Va.indent(Ba,ba.ignoreFollowingText?"":va.slice(mb.length),va),Ub==Gc.passIndent||150<Ub)){if(!Sa)return;Ja="prev"}"prev"==Ja?Ub=0<cc.row?Gc.countColumn(cc.prevLine().text,null,Fb):0:"add"==Ja?Ub=Ua+ba.indentUnit:"subtract"==Ja?Ub=Ua-ba.indentUnit:"number"===
typeof Ja&&(Ub=Ua+Ja);Ub=Math.max(0,Ub);Va="";Ba=0;if(ba.indentWithTabs)for(ba=Math.floor(Ub/Fb);ba;--ba)Ba+=Fb,Va+="\t";Ba<Ub&&(Va+=" ".repeat(Ub-Ba));if(Va!=mb)return cb.replace({start:{row:cc.row,column:0},end:{row:cc.row,column:mb.length}},Va),!0};Gc.tokenizeLines=function(cb,Va,cc,Ba,Ja){if(Va.length){cc=cc?Gc.copyState(cb,cc):Gc.startState(cb);for(var Sa=0;Sa<Va.length;Sa++){var ba=Va[Sa];Ba(ba);cc=Gc.tokenizeLine(cb,ba,cc,Ja)}}};Gc.tokenizeLine=function(cb,Va,cc,Ba){var Ja=Va.text;if(!Ja)return cc;
var Sa=new Gc.StringStream(Ja,2);cc=Va.modeState="function"===typeof cb.copyState?cb.copyState(cc):Gc.copyState(cb,cc);Va.prevLine();for(cc._string=Ja;!Sa.eol();)Ja=cb.token(Sa,cc),Ba(Ja,cc,Sa.start,Sa.pos,Sa,Va,cb),Sa.start=Sa.pos;return cc};Gc.printTokens=function(cb){for(var Va="",cc=0;cc<cb.length;cc+=5)Va+=cb[cc+0]+" => "+cb[cc+1]+" "+cb[cc+2]+" "+cb[cc+3]+" "+cb[cc+4].name+"\n";return Va};Gc.visitDocumentTokens=wb;Gc.tokenizeDocument=ud;Gc.linesToTokenize=function(cb,Va,cc,Ba){if(Ba&&Ba.row>=
cc)return{lines:[],state:null};Va=Ba?Math.max(0,Ba.row-1):Va;var Ja=cb.getLine(Va),Sa=Ja.text;cb=[Ja];Ba=null;for(var ba=0,Fb;(Fb=Ja.prevLine())&&50>ba++;){Ja=Fb;if(Ja.modeState){Ba=Ja.modeState;break}cb.unshift(Ja)}if(!Ba){for(var va=Ja,Ua=Infinity;(Fb=Ja.prevLine())&&100>ba++;){Ja=Fb;if(Ja.modeState){Ba=Ja.modeState;break}cb.unshift(Ja);Fb=Sa.match(/^\s*/)[0].length;if(0===Fb)break;Fb<Ua&&(Ua=Fb,va=Ja)}!Ba&&0<Ua&&(cb=cb.slice(cb.indexOf(va)))}if(cc>Va)for(Ja=Gc.arr.last(cb);Va<=cc;Va++){Ja=Ja.nextLine();
if(!Ja)break;cb.push(Ja)}return{lines:cb,state:Ba}};Gc.countColumn=Tb;Gc.findModeByMIME=te;Gc.findModeByExtension=cd;Gc.findModeByFileName=Lc;Gc.findModeByName=Hb;Gc.arr=xc;oc=Gc.modes||{};Gc.modes=oc;Gc.modes=oc;Gc.modes=oc;oc=Wa("p",{});Gc.passIndent=oc;Gc.passIndent=oc;Gc.passIndent=oc;Gc.copyState=Ra;Gc.copyState=Ra;Gc.startState=Ga;Gc.startState=Ga;Gc.defineMode=ea;Gc.defineMode=ea;Gc.resolveMode=Da;Gc.resolveMode=Da;Gc.getMode=ta;Gc.getMode=ta;Gc.innerMode=Pa;Gc.innerMode=Pa;oc={};Gc.mimeModes=
oc;Gc.mimeModes=oc;Gc.mimeModes=oc;Gc.defineMIME=Ha;Gc.defineMIME=Ha;Gc.registerHelper=tb;Gc.registerHelper=tb;Gc.indentLines=Ac;Gc.indentLines=Ac;Gc.visitDocumentTokens=wb;Gc.visitDocumentTokens=wb;Gc.tokenizeDocument=ud;Gc.tokenizeDocument=ud;Gc.countColumn=Tb;Gc.countColumn=Tb;(function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),cc=Va.hasOwnProperty("StringStream")&&"function"===typeof Va.StringStream?Va.StringStream:Va.StringStream=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:Symbol.for("lively-instance-initialize"),value:function(Ba,Ja){this.reset(Ba,Ja)}},{key:"reset",value:function(Ba,Ja){this.pos=this.start=0;this.string=void 0===Ba?"":Ba;this.tabSize=void 0===Ja?2:Ja;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||
void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(Ba){var Ja=this.string.charAt(this.pos);if("string"===typeof Ba?Ja==Ba:Ja&&(Ba.test?Ba.test(Ja):Ba(Ja)))return++this.pos,Ja}},{key:"eatWhile",value:function(Ba){for(var Ja=this.pos;this.eat(Ba););return this.pos>Ja}},{key:"eatSpace",value:function(){for(var Ba=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>Ba}},{key:"skipToEnd",
value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(Ba){Ba=this.string.indexOf(Ba,this.pos);if(-1<Ba)return this.pos=Ba,!0}},{key:"backUp",value:function(Ba){this.pos-=Ba}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=Gc.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?Gc.countColumn(this.string,this.lineStart,this.tabSize):
0)}},{key:"indentation",value:function(){return Gc.countColumn(this.string,null,this.tabSize)-(this.lineStart?Gc.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(Ba,Ja,Sa){if("string"===typeof Ba){var ba=function(va){return Sa?va.toLowerCase():va},Fb=this.string.substr(this.pos,Ba.length);if(ba(Fb)==ba(Ba))return!1!==Ja&&(this.pos+=Ba.length),!0}else{if((Ba=this.string.slice(this.pos).match(Ba))&&0<Ba.index)return null;Ba&&!1!==Ja&&(this.pos+=Ba[0].length);return Ba}}},
{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(Ba,Ja){this.lineStart+=Ba;try{return Ja()}finally{this.lineStart-=Ba}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],Va,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:10526,end:13053})})(void 0);oc=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",
ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",
mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",
mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(cb){return cb.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",
mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",
mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",
ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",
ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},
{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",
ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",
mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",
ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},
{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},
{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",
ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",
mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(cb){return cb.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",
mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",
mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",
mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn",
"ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",
mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",
ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];Gc.modeInfo=oc;Gc.modeInfo=oc;Gc.modeInfo=oc;for(var Zd=0;Zd<Gc.modeInfo.length;Zd++)Gc.info=
Gc.modeInfo[Zd],Gc.info.mimes&&(Gc.info.mime=Gc.info.mimes[0]);Gc.defineMode("null",function(){return{token:function(cb){return cb.skipToEnd()}}});Gc.defineMIME("text/plain","null");Gc.findModeByMIME=te;Gc.findModeByMIME=te;Gc.findModeByExtension=cd;Gc.findModeByExtension=cd;Gc.findModeByFileName=Lc;Gc.findModeByFileName=Lc;Gc.findModeByName=Hb;Gc.findModeByName=Hb;var je=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");je.Color=Ib;je.Rectangle=ac;je.pt=Cd;je.morph=nd;je.ShadowObject=
Ud;je.StyleSheet=bd;je.connect=Ic;je.arr=xc;je.string=pd;je.FilterableList=yd;je.Range=Ne;Zd=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),cc=Va.hasOwnProperty("Completer")&&"function"===typeof Va.Completer?Va.Completer:Va.Completer=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"Completer"}}],Va,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);je.Completer=Zd;je.Completer=Zd;je.Completer=Zd;Zd=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),cc=Va.hasOwnProperty("WordCompleter")&&
"function"===typeof Va.WordCompleter?Va.WordCompleter:Va.WordCompleter=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:"compute",value:function(Ba,Ja){var Sa=[],ba=[],Fb=Ba.document.lineStrings;Ba=Ba.cursorPosition.row;for(var va=Ba-1;0<=va;va--)for(var Ua=$jscomp.makeIterator(Fb[va].split(/[^0-9a-z@_]+/i)),mb=Ua.next();!mb.done;mb=Ua.next())(mb=mb.value)&&!Sa.includes(mb)&&mb!==Ja&&(Sa.push(mb),
ba.push({priority:1E3-(Ba-va),completion:mb}));for(va=Ba+1;va<Fb.length;va++)for(Ua=$jscomp.makeIterator(Fb[va].split(/[^0-9a-z_@]+/i)),mb=Ua.next();!mb.done;mb=Ua.next())(mb=mb.value)&&!Sa.includes(mb)&&mb!==Ja&&(Sa.push(mb),ba.push({priority:1E3-(va-Ba),completion:mb}));return ba}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Va,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);je.WordCompleter=Zd;je.WordCompleter=Zd;je.WordCompleter=Zd;Zd=[new je.WordCompleter];je.defaultCompleters=Zd;je.defaultCompleters=Zd;je.defaultCompleters=Zd;Zd=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),cc=Va.hasOwnProperty("CompletionController")&&"function"===typeof Va.CompletionController?Va.CompletionController:Va.CompletionController=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:Symbol.for("lively-instance-initialize"),value:function(Ba,Ja){Ja=void 0===Ja?[]:Ja;this.textMorph=Ba;this.completers=Ja=Ba.pluginCollect("getCompleters",Ja)}},{key:"computeCompletions",value:function(Ba){var Ja=this,Sa,ba,Fb,va,Ua,mb,Ub,yc,Pc,Zc,Qc,Ld,we,af,de,kf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qe){switch(Qe.nextAddress){case 1:Sa=[],ba=$jscomp.makeIterator(Ja.completers),Fb=ba.next();
case 2:if(Fb.done){Qe.jumpTo(4);break}va=Fb.value;Qe.setCatchFinallyBlocks(5);Ua=Sa;mb=Ua.concat;return Qe.yield(va.compute(Ja.textMorph,Ba),7);case 7:Sa=mb.call(Ua,Qe.yieldResult);Qe.leaveTryBlock(3);break;case 5:Ub=Qe.enterCatchBlock(),console.warn("Error in completer "+va+": "+(Ub.stack||Ub));case 3:Fb=ba.next();Qe.jumpTo(2);break;case 4:yc=new Map;Sa.forEach(function(Ke){var Pf=yc.get(Ke.completion);Pf||(Pf=[],yc.set(Ke.completion,Pf));Pf.push(Ke)});Pc=[];Zc=$jscomp.makeIterator(yc.values());
for(Qc=Zc.next();!Qc.done;Qc=Zc.next())Ld=Qc.value,Pc.push(je.arr.last(je.arr.sortByKey(Ld,"priority")));we=0;af=je.arr.sortByKey(Pc,"priority").reverse();de=af.length&&af[0].priority||0;kf=af.map(function(Ke){Ke.highestPriority=de;var Pf=Ke.completion.replace(/\n/g,""),xg=String((Ke.info||"").replace(/\n/g,""));we=Math.max(we,Pf.length+xg.length);return{isListItem:!0,string:Pf,annotation:xg,value:Ke}});return Qe.return({items:kf,maxCol:we})}})}},{key:"computeSortedCompletions",value:function(Ba,
Ja){Ja=void 0===Ja?!1:Ja;var Sa=this,ba,Fb,va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return ba={tokens:[Ba],lowercasedTokens:[Ba],input:Ba},Ua.yield(Sa.computeCompletions(Ba),2);Fb=Ua.yieldResult;va=je.arr.sortBy(Fb.items.filter(function(mb){return Sa.filterFunction(ba,mb,Ja)}),function(mb){return Sa.sortFunction(ba,mb)});return Ua.return(va)})}},{key:"_printCompletions",value:function(Ba){var Ja=this,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ba){if(1==
ba.nextAddress)return ba.yield(Ja.computeSortedCompletions(Ba),2);Sa=ba.yieldResult.map(function(Fb){return{completion:Fb.value.completion,priority:Fb.value.priority,maxP:Fb.value.highestPriority,sortVal:Fb._cache[Ba].sortVal,lev:JSON.stringify(Fb._cache[Ba].levenshtein)}});return ba.return(je.string.printTable(lively.lang.grid.tableFromObjects(Sa)))})}},{key:"prefix",value:function(){var Ba=this.textMorph,Ja=Ba.selection;return(Ja.isEmpty()?Ba.getLine(Ja.lead.row).slice(0,Ja.lead.column):Ja.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(Ba,Ja,Sa){Sa=void 0===Sa?!1:Sa;Ja._cache||(Ja._cache={});var ba=Ba.tokens,Fb=Ba.lowercasedTokens,va=Ba.input;va=Ja._cache[va]||(Ja._cache[va]={});if(va.hasOwnProperty("filtered"))return va.filtered;Ja=Ja.value.completion.replace(/\([^\)]*\)$/,"");var Ua=Ja.toLowerCase();if(Sa&&ba[0]&&!Ja.startsWith(ba[0]))return va.filtered=!1;if(Fb.every(function(Ub){return Ua.includes(Ub)}))return!0;var mb=va.levenshtein||(va.levenshtein={});Ba=Sa||3>=je.arr.sum(Ba.lowercasedTokens.map(function(Ub){return mb[Ub]||
(mb[Ub]=je.string.levenshtein(Ua,Ub))}));return va.filtered=Ba}},{key:"sortFunction",value:function(Ba,Ja){Ja._cache||(Ja._cache={});var Sa=Ja._cache[Ba.input]||(Ja._cache[Ba.input]={});if(Sa.hasOwnProperty("sortVal"))return Sa.sortVal;Sa=Ja._cache[Ba.input]={};var ba=Ja.value;Ja=ba.highestPriority;var Fb=ba.completion;ba=ba.priority;Fb=Fb.replace(/\([^\)]*\)$/,"").toLowerCase();var va=0;Ba.lowercasedTokens.forEach(function(mb){Fb.startsWith(mb)?va+=12:3<=mb.length&&Fb.includes(mb)&&(va+=5)});Ja=
-((ba||(va?Ja:0))/Math.pow(10,String(Ja).length-2))-va;var Ua=Sa.levenshtein||(Sa.levenshtein={});Ba=je.arr.sum(Ba.lowercasedTokens.map(function(mb){return Ua[mb]||(Ua[mb]=je.string.levenshtein(Fb,mb))}));va&&(Ba/=2);return Sa.sortVal=Ba+Ja}},{key:"positionForMenu",value:function(){var Ba=this.textMorph,Ja=Ba.charBoundsFromTextPosition(Ba.cursorPosition);return Ba.getGlobalTransform().transformRectToRect(Ja).topLeft().addXY(-Ba.scroll.x,-Ba.scroll.y).addPt(je.pt(Ba.borderWidth+4,Ba.borderWidth+4))}},
{key:"completionListSpec",value:function(){var Ba=this,Ja,Sa,ba,Fb,va,Ua,mb,Ub,yc,Pc,Zc,Qc,Ld,we,af,de,kf,Qe,Ke,Pf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xg){if(1==xg.nextAddress)return Sa=Ja=Ba.textMorph,ba=Sa.fontSize,Fb=Sa.fontFamily,va=Ba.positionForMenu(),Ua=Ba.prefix(),xg.yield(Ba.computeCompletions(Ua),2);mb=xg.yieldResult;Ub=mb.items;yc=mb.maxCol;Pc=Ja.env.fontMetric.sizeFor(Fb,ba,"M");Zc=Pc.width*yc;Qc=Ja.document.getLine(0).height;Ld=Math.max(120,Zc<Ja.width?Zc:Ja.width);
we=Qc*Ub.length+Qc+10;af=Math.max(70,Math.min(700,we));de=va.extent(je.pt(Ld,af));if(kf=Ja.world())Qe=kf.visibleBounds().insetBy(5),de.bottom()>Qe.bottom()&&(Ke=de.bottom()-Qe.bottom(),Ke>de.height-50&&(Ke=de.height-50),de.height-=Ke),de.right()>Qe.right()&&(Pf=de.right()-Qe.right(),de.width=120>de.width-Pf?120:de.width-Pf),Qe.containsRect(de)||(de=de.withTopLeft(Qe.translateForInclusion(de).topLeft())),de=de.translatedBy(Qe.insetBy(0).topLeft().negated());return xg.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:ba,position:de.topLeft(),extent:de.extent(),items:Ub,input:Ua,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:Ba.filterFunction,sortFunction:Ba.sortFunction})})}},{key:"removeMenuOnBlur",value:function(Ba){var Ja=Ba.menu;setTimeout(function(){Ja.withAllSubmorphsDetect(function(Sa){return Sa.isFocused()})?Ja.inputMorph.focus():Ja.remove()})}},{key:"openCompletionList",value:function(){var Ba=this,Ja,Sa,ba,Fb,va,Ua,mb,Ub,
yc,Pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zc){if(1==Zc.nextAddress)return Ja=Ba.textMorph.selection.start,Zc.yield(Ba.completionListSpec(),2);if(3!=Zc.nextAddress)return Sa=Zc.yieldResult,Ba.textMorph.pluginFind(function(Qc){return Qc.theme}),ba=new je.FilterableList(Sa),Fb=new je.Range({start:Ja,end:Ba.textMorph.selection.start}),va=Ba.textMorph.textInRange(Fb),Ua=ba.inputMorph,mb=ba.listMorph,Ub=Sa.input,yc=ba.addMorph({name:"prefix mask",fill:je.Color.transparent,bounds:Ua.textBounds()},
Ua),mb.master=null,Fb.isEmpty()||(Ba.textMorph.deleteText(Fb),Ua.input=va,Ua.gotoDocumentEnd()),Ua.fontColor=Ba.textMorph.fontColor,je.connect(Ua,"textString",yc,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Ua}}),je.connect(ba,"accepted",Ba,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Ub}}),je.connect(ba,"accepted",ba,"remove"),je.connect(ba,"canceled",ba,"remove"),je.connect(ba,"remove",Ba.textMorph,"focus"),je.connect(ba.inputMorph,"onBlur",Ba,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:ba}}),Pc=Ba.textMorph.world(),mb.addStyleClass("hiddenScrollbar"),ba.paddingMorph.height=2,Ua.height=mb.itemHeight,Ua.clipMode="visible",Ua.fill=Ba.textMorph.fill,Ua.fixedHeight=!0,Ua.fixedWidth=!1,Ua.fontSize=mb.fontSize,ba.relayout(),ba.selectedIndex=
0,ba.master.applyIfNeeded(!0),Ua.focus(),Zc.yield(ba.master.whenApplied(),3);Ub.length&&(Ua.gotoDocumentEnd(),ba.moveBy(je.pt(-Ua.textBounds().width,0)));Pc.addMorph(ba);ba.inputPadding=je.Rectangle.inset(0,0,0,0);return Zc.return(ba)})}},{key:"autoInsertBestMatchingCompletion",value:function(Ba,Ja,Sa){Ja=void 0===Ja?!0:Ja;var ba=this,Fb,va,Ua,mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ub){if(1==Ub.nextAddress)return Fb=$jscomp,va=Fb.makeIterator,Ub.yield(ba.computeSortedCompletions(Ba,
Ja),2);Ua=va.call(Fb,Ub.yieldResult);(mb=Ua.next().value)&&ba.insertCompletion(mb.value.completion,Ba,Sa);Ub.jumpToEnd()})}},{key:"insertCompletion",value:function(Ba,Ja,Sa){var ba=this.textMorph,Fb=ba.document,va=ba.selection.isMultiSelection?ba.selection.selections:[ba.selection];ba.undoManager.group();va.forEach(function(Ua){Ua.collapseToEnd();var mb=Ua.lead,Ub=Ja?Fb.indexToPosition(Fb.positionToIndex(mb)-Ja.length):mb;"function"===typeof Sa?Sa(Ba,Ja,ba,{start:Ub,end:mb},Ua):ba.replace({start:Ub,
end:mb},Ba)});ba.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],Va,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13044})}(void 0);je.CompletionController=Zd;je.CompletionController=Zd;je.CompletionController=Zd;
Zd=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(cb,Va,cc){var Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){return 1==Ja.nextAddress?(Ba=new je.CompletionController(cb,je.defaultCompleters),Ja.yield(Ba.openCompletionList(),2)):Ja.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(cb,Va,cc){var Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){return 1==Ja.nextAddress?
(Ba=new je.CompletionController(cb,je.defaultCompleters),Ja.yield(Ba.autoInsertBestMatchingCompletion(Ba.prefix()),2)):Ja.return(!0)})}}];je.completionCommands=Zd;je.completionCommands=Zd;je.completionCommands=Zd;var Bf=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Bf.chain=Pe;Bf.arr=xc;Bf.obj=Ie;Bf.string=pd;var lf=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(cb){var Va=cb.selection.start;0<Va.row&&(Va=cb.getPositionAboveOrBelow(1,
Va,!0,0,cb.charBoundsFromTextPosition(Va).x),cb.selection.addRange({start:Va,end:Va}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(cb){var Va=cb.selection.start;Va.row<cb.documentEndPosition.row&&(Va=cb.getPositionAboveOrBelow(-1,Va,!0,0,cb.charBoundsFromTextPosition(Va).x),cb.selection.addRange({start:Va,end:Va}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(cb){var Va=cb.selection.selections[cb.selection.selections.length-
1];if(Va.isEmpty())return!0;cb.searchForAll(Va.text,{start:{column:0,row:0}}).forEach(function(cc){return cb.selection.addRange(cc.range,!1)});cb.selection.mergeSelections();Bf.arr.remove(cb.selection.selections,Va);cb.selection.selections.push(Va);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(cb){var Va=cb.selection.selections.length-1,cc=cb.selection.selections[Va];if(cc.isEmpty())return!0;var Ba=cb.search(cc.text,{start:cc.end,backwards:!1});
Ba&&(cc=cb.selection.selections.findIndex(function(Ja){return Ja.range.equals(Ba.range)}),-1<cc?Bf.arr.swap(cb.selection.selections,cc,Va):cb.selection.addRange(Ba.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(cb){var Va=cb.selection.selections.length-1,cc=cb.selection.selections[Va];if(cc.isEmpty())return!0;var Ba=cc.start,Ja=cb.search(cc.text,{start:{row:Ba.row,column:Ba.column-(cc.text.length-1)},backwards:!0});Ja&&(cc=cb.selection.selections.findIndex(function(Sa){return Sa.range.equals(Ja.range)}),
-1<cc?Bf.arr.swap(cb.selection.selections,cc,Va):cb.selection.addRange(Ja.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(cb){var Va=cb.selection.selections.length;1<Va&&cb.selection.removeSelections(Va-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(cb){cb.selection.selections=lively.lang.arr.rotate(cb.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(cb){cb.selection.selections=lively.lang.arr.rotate(cb.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(cb){var Va=cb.selection.selections;if(1>=Va.length)return!0;var cc=Bf.arr.groupBy(Va,function(Ja){return Ja.range.start.row});Va=cc.keys().map(function(Ja){Ja=cc[Ja];var Sa=Bf.arr.max(Ja,function(ba){return ba.range.start.column});Bf.arr.without(Ja,Sa).forEach(function(ba){return ba.range=Sa.range});
return Sa});var Ba=Bf.arr.max(Va,function(Ja){return Ja.range.start.column}).range.start.column;Va.forEach(function(Ja){var Sa=Ja.range.start;Ja=Sa.row;Sa=Sa.column;cb.insertText(" ".repeat(Ba-Sa),{row:Ja,column:Sa})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(cb){cb.selection.disableMultiSelect();if(cb.selection.isEmpty())var Va=cb.lastSavedMark&&cb.lastSavedMark.position||(void 0).lineRange().start,cc=cb.cursorPosition;else Va=cb.selection,
cc=Va.lead,Va=Va.anchor;cb.selection.collapse();var Ba=Va.column,Ja=cc.column;Bf.arr.range(Va.row,cc.row).forEach(function(Sa){return cb.getLine(Sa).length>Math.min(Ja,Ba)&&cb.selection.addRange({end:{row:Sa,column:Ja},start:{row:Sa,column:Ba}},!1)});cb.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(cb,Va,cc){cc=void 0===cc?1:cc;cb.undoManager.group();cb.selection.selections.forEach(function(Ba,Ja){return Ba.text=String(Ja+
cc)});cb.undoManager.group();return!0}}];Bf.multiSelectCommands=lf;Bf.multiSelectCommands=lf;Bf.multiSelectCommands=lf;var bf=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");bf.pToI=function(cb,Va){return cb.positionToIndex(Va)};bf.iToP=function(cb,Va){return cb.indexToPosition(Va)};bf.execCodeNavigator=function(cb){return function(Va,cc,Ba){var Ja=Va.pluginInvokeFirst("getNavigator");if(!Ja)return!0;Va.saveMark();Ba=Ba||1;for(var Sa=0;Sa<Ba;Sa++)Ja[cb](Va,cc);return!0}};
bf.once=fd;var z=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:bf.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:bf.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:bf.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:bf.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:bf.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(cb,Va){function cc(){var Sa=cb.$expandRegionState,ba=bf.pToI(cb,cb.cursorPosition);if(Sa&&(Sa.range[0]===ba||Sa.range[1]===ba))return Sa;Sa=cb.selection.range;return cb.$expandRegionState={range:[bf.pToI(cb,Sa.start),
bf.pToI(cb,Sa.end)]}}Va=Va||{};var Ba=cb.pluginInvokeFirst("getNavigator");if(!Ba)return!0;var Ja=Va.start;Va=Va.end;if("number"===typeof Ja&&"number"===typeof Va)cc(),Ba={range:[Ja,Va],prev:cc()};else{Ja=Ba.ensureAST(cb);if(!Ja)return;Ba=Ba.expandRegion(cb,cb.textString,Ja,cc())}Ba&&Ba.range&&(cb.selection={start:bf.iToP(cb,Ba.range[0]),end:bf.iToP(cb,Ba.range[1])},cb.$expandRegionState=Ba);bf.once(cb,"selectionChange",function(){return cb.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(cb){if(cb.selection.isEmpty())return!0;var Va=cb.pluginInvokeFirst("getNavigator");if(!Va)return!0;var cc=Va.ensureAST(cb);if(!cc)return!0;var Ba=cb.$expandRegionState;if(!Ba)return!0;(Va=Va.contractRegion(cb,cb.textString,cc,Ba))&&Va.range&&(cb.selection={start:bf.iToP(cb,Va.range[0]),end:bf.iToP(cb,Va.range[1])},cb.$expandRegionState=Va);bf.once(cb,"selectionChange",
function(){return cb.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];bf.commands=z;bf.commands=z;bf.commands=z;var pf=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");pf.arr=xc;pf.chain=Pe;pf.string=pd;var nf=[{name:"toggle comment",exec:function(cb){var Va=cb.pluginInvokeFirst("getComment");if(!Va)return!0;if(!Va.lineCommentStart)return Va.blockCommentStart?cb.execCommand("toggle block comment"):!0;var cc=Va.lineCommentStart,Ba=new RegExp("^(\\s*)("+
cc+"\\s?)(.*)");Va=cb.document;var Ja=cb.selection;Ja.isEmpty()||0!==Ja.end.column||Ja.growRight(-1);var Sa=Ja.start.row;Va=Va.lineStrings.slice(Ja.start.row,Ja.end.row+1);Va=Va.some(function(va){return!!va.trim()})?pf.arr.dropWhile(Va,function(va){return va.trim()?!1:++Sa&&!0}):Va;var ba=Va.every(function(va){return va.trim()&&va.match(Ba)});cb.undoManager.group();if(ba)Va.forEach(function(va,Ua){if(va=va.match(Ba)){va=$jscomp.makeIterator(va);va.next();var mb=va.next().value,Ub=va.next().value;
va.next();cb.deleteText({start:{row:Sa+Ua,column:mb.length},end:{row:Sa+Ua,column:mb.length+Ub.length}})}});else{var Fb=Va.reduce(function(va,Ua,mb){return Ua.trim()||Ja.isEmpty()&&Ja.start.row===Ja.end.row?Math.min(va,Ua.match(/^\s*/)[0].length):va},Infinity);Fb=Infinity===Fb?0:Fb;Va.forEach(function(va,Ua){va=$jscomp.makeIterator(va.match(/^(\s*)(.*)/));va.next();va.next();va.next();cb.insertText(cc+" ",{row:Sa+Ua,column:Fb})})}cb.undoManager.group();return!0}},{name:"toggle block comment",exec:function(cb){var Va=
cb.pluginInvokeFirst("getComment");if(!Va)return!0;if(!Va.blockCommentStart)return Va.lineCommentStart?cb.execCommand("toggle comment"):!0;if(!Va||!Va.blockCommentStart)return!0;var cc=Va.blockCommentStart;Va=Va.blockCommentEnd;var Ba=new RegExp("^"+cc.replace(/\*/g,"\\*")),Ja=new RegExp(Va.replace(/\*/g,"\\*")+"$"),Sa=cb.tokenAt(cb.cursorPosition);if(Sa&&"comment"===Sa.token){var ba=cb.textInRange(Sa);if(ba.match(Ba)&&ba.match(Ja))return cb.undoManager.group(),cb.replace(Sa,ba.slice(cc.length,-Va.length)),
cb.undoManager.group(),!0}cb.undoManager.group();cb.insertText(cc,cb.selection.start);cb.insertText(Va,cb.selection.end);cb.undoManager.group();cc=!cb.selection.isEmpty();cb.selection.growLeft(Va.length);cc||cb.selection.collapse();return!0}},{name:"comment box",exec:function(cb,Va,cc){Va=cb.undoManager.ensureNewGroup(cb,"comment box");if(cb.selection.isEmpty())return cb.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),cb.execCommand("toggle comment"),cb.undoManager.group(Va),
!0;var Ba=cb.selection.range,Ja=cb.withSelectedLinesDo(function(ba){return ba}),Sa=pf.arr.min([Ba.start.column].concat(pf.chain(Ja).map(function(ba){return ba.match(/^\s*/)}).flatten().compact().pluck("length").value()));Ja=pf.arr.max(Ja.map(function(ba){return ba.length}))-Sa;Ja=Array(Math.ceil(Ja/2)+1).join("-=")+"-";cb.execCommand("toggle comment");cb.collapseSelection();cb.cursorPosition={row:Ba.start.row,column:0};cc?cb.insertText(pf.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",Sa)):cb.insertText(pf.string.indent(Ja+"\n"," ",Sa));cb.selection.goUp();cb.execCommand("toggle comment");cb.cursorPosition={row:Ba.end.row+2,column:0};cb.insertText(pf.string.indent(Ja+"\n"," ",Sa));cb.selection.goUp();cb.execCommand("toggle comment");cb.selection.range={start:{row:Ba.start.row,column:0},end:cb.cursorPosition};cb.undoManager.group(Va);return!0},multiSelectAction:"forEach",handlesCount:!0}];pf.commands=nf;pf.commands=nf;pf.commands=nf;var De=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
De.printSymbol=function(cb){if(Symbol.keyFor(cb))return'Symbol.for("'+Symbol.keyFor(cb)+'")';if(De.knownSymbols.get(cb))return De.knownSymbols.get(cb);String(cb).match(De.symMatcher);return String(cb)};De.defaultSort=function(cb,Va){if(cb.hasOwnProperty("priority")||Va.hasOwnProperty("priority")){var cc=cb.priority||0,Ba=Va.priority||0;if(cc<Ba)return-1;if(cc>Ba)return 1}cb=(cb.keyString||cb.key).toLowerCase();Va=(Va.keyString||Va.key).toLowerCase();return cb<Va?-1:cb===Va?0:1};De.safeToString=Be;
De.propertyNamesOf=function(cb,Va){if(!cb)return[];if(Array.isArray(cb)){var cc=Va?Va.offset:0;return De.arr.range(cc,cc+(Va?Va.partitionSize:cb.length-1))}return De.arr.sortBy(Object.keys(cb),function(Ba){return Ba.toLowerCase()})};De.isMultiValue=Ob;De.printValue=Gb;De.partitionedChildren=function(cb,Va){var cc=void 0===Va?{}:Va;Va=void 0===cc.originalValue?cb:cc.originalValue;var Ba=void 0===cc.offset?0:cc.offset;cc=void 0===cc.partitionSize?cb.length||Object.values(cb).length:cc.partitionSize;
if(De.obj.isArray(cb)){cb=De.num.roundTo(Math.max(De.MIN_PARTITION_SIZE,cc/50),.1);cc/=cb;for(var Ja=[],Sa=0;Sa<cc;Sa++){var ba="["+(Ba+Sa*cb)+"-"+(Ba+(Sa+1)*cb)+"]";Ja.push({partition:{originalValue:Va,offset:Ba+Sa*cb,partitionSize:cb},value:[],key:ba,keyString:ba,valueString:"...",isCollapsed:!0})}return Ja}cb=De.num.roundTo(Math.max(De.MIN_PARTITION_SIZE,cc/50),.1);cc/=cb;Ja=[];Sa=De.obj.keys(Va).sort();for(ba=0;ba<cc;ba++){var Fb=Ba+ba*cb,va=Ba+(ba+1)*cb,Ua=De.obj.select(Va,Sa.slice(Fb,va));Fb=
"["+Sa[Fb].slice(0,4)+"-"+(Sa[va]||De.arr.last(Sa)).slice(0,4)+"]";Ja.push({partition:{originalValue:Ua,offset:Ba+ba*cb,partitionSize:cb},value:[],key:Fb,keyString:Fb,valueString:"...",isCollapsed:!0})}return Ja};De.propertiesOf=function(cb){var Va=cb.partition?cb.target:cb.value;if(!Va)return[];var cc={_rev:!0},Ba=[],Ja="function"===typeof Va.livelyCustomInspect?Va.livelyCustomInspect():{},Sa=Object.assign({},De.defaultPropertyOptions,{},Ja);if(Ja.properties){Ja=$jscomp.makeIterator(Ja.properties);
for(var ba=Ja.next();!ba.done;ba=Ja.next()){var Fb=ba.value;ba=Fb.key;var va=Fb.hidden,Ua=Fb.priority,mb=Fb.keyString,Ub=Fb.value;Fb=Fb.valueString;cc[ba]=!0;va||Ba.push(cb.getSubNode({priority:Ua,key:ba,keyString:mb||De.safeToString(ba),value:Ub,valueString:Fb,isCollapsed:!0}))}}if(Sa.includeDefault){Ja=De.propertyNamesOf(Va,cb.partition);if(Ja.length>De.MAX_NODE_THRESHOLD)for(cc=$jscomp.makeIterator(De.partitionedChildren(Va,cb.partition)),Ja=cc.next();!Ja.done;Ja=cc.next())Ba.push(cb.getSubNode(Ja.value));
else for(va=$jscomp.makeIterator(Ja),Ja=va.next();!Ja.done;Ja=va.next())Ua=Ja.value,Ua in cc||(Ja=Va[Ua],ba=De.printValue(Ja),Ja={keyString:Ua,key:Ua,value:Ja,valueString:ba,isCollapsed:!0},Ba.push(cb.getSubNode(Ja)));if(Sa.includeSymbols)for(cc=$jscomp.makeIterator(Object.getOwnPropertySymbols(Va)),Ja=cc.next();!Ja.done;Ja=cc.next())va=Ja.value,Ua=De.safeToString(va),Ja=Va[va],ba=De.printValue(Ja),Ja={key:va,keyString:Ua,value:Ja,valueString:ba,isCollapsed:!0},Ba.push(cb.getSubNode(Ja))}Sa.sort&&
(Ba=Sa.sortFunction(Va,Ba));return Ba};De.obj=Ie;De.num=me;De.arr=xc;De.string=pd;De.connect=Ic;De.signal=Yb;De.TreeData=Yc;De.newUUID=Nd;De.localInterface=Jb;De.MAX_NODE_THRESHOLD=1E3;De.MIN_PARTITION_SIZE=250;De.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(cb,Va){return Array.isArray(cb)?Va:Va.sort(De.defaultSort)}};De.symMatcher=/^Symbol\((.*)\)$/;De.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(cb){return"symbol"===
typeof Symbol[cb]}).reduce(function(cb,Va){return cb.set(Symbol[Va],"Symbol."+Va)},new Map)}();De.isMultiValue=Ob;De.isMultiValue=Ob;De.printValue=Gb;De.printValue=Gb;var Cf=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),cc=Va.hasOwnProperty("InspectionTree")&&"function"===typeof Va.InspectionTree?Va.InspectionTree:Va.InspectionTree=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Sb(cc,cb,[{key:Symbol.for("lively-instance-initialize"),value:function(Ba){Sb._get(Object.getPrototypeOf(cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Ba);this.inspector=Ba.inspector;this.root.isInspectionNode||(this.root=De.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(Ba){Ba=void 0===Ba?!0:Ba;return Sb._get(Object.getPrototypeOf(cc.prototype),"asListWithIndexAndDepth",
this).call(this,function(Ja){Ja=Ja.node;return Ba?Ja.visible:!0})}},{key:"getContextFor",value:function(Ba){return Ba==this.root?this.root.value.inspectee:Ba.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(Ba){var Ja=void 0===Ba.maxDepth?1:Ba.maxDepth,Sa=Ba.iterator,ba=Ba.showUnknown,Fb=Ba.showInternal,va=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return Ua.yield(va.uncollapseAll(function(mb,Ub){return Ja>Ub&&(mb==va.root||mb.value.submorphs)}),
2);va.asListWithIndexAndDepth(!1).forEach(function(mb){var Ub=mb.node;return 0==mb.depth?Ub.visible=!0:!ba&&Ub.keyString&&Ub.keyString.includes("UNKNOWN PROPERTY")||!Fb&&Ub.keyString&&Ub.keyString.includes("internal")?Ub.visible=!1:Ub.value&&Ub.value.submorphs?Ub.visible=!0:Ub.visible=Sa(Ub)});Ua.jumpToEnd()})}},{key:"getChildren",value:function(Ba){return Ba.children}},{key:"display",value:function(Ba){return Ba.display(this.inspector)}},{key:"isCollapsed",value:function(Ba){return Ba.isCollapsed}},
{key:"isLeaf",value:function(Ba){return De.obj.isPrimitive(Ba.value)}},{key:"collapse",value:function(Ba,Ja){var Sa=this;Ba.isCollapsed=Ja;Ja||this.isLeaf(Ba)||Ba.children.length||(Ba.children=De.propertiesOf(Ba).map(function(ba){Sa.parentMap.set(ba,Ba);return ba}))}},{key:"retrieveForRemoteProxy",value:function(Ba){Ba.uuid||(Ba.uuid=De.newUUID(),this.idToNodeMap[Ba.uuid]=Ba);return{uuid:Ba.uuid,value:this.isLeaf(Ba)?Ba.value:{},keyString:Ba.keyString,key:Ba.keyString,valueString:De.safeToString(Ba.value),
isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return De.localInterface}},{key:"getNodeViaId",value:function(Ba){return this.idToNodeMap[Ba]}},{key:"asRemoteDelegate",value:function(Ba){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[Ba]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(Ba,Ja){return new this({key:"inspectee",value:{inspectee:Ba},isCollapsed:!0,inspector:Ja})}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(De.TreeData);De.InspectionTree=Cf;De.InspectionTree=
Cf;De.InspectionTree=Cf;var Rf=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),cc=Va.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Va.RemoteInspectionTree?Va.RemoteInspectionTree:Va.RemoteInspectionTree=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(Ba){this.parentMap=new WeakMap;this.root=Ba.proxy;this.evalEnvironment=Ba.evalEnvironment;this.inspector=Ba.inspector;this.delegateId=Ba.delegateId}},{key:"getContextFor",value:function(Ba){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+Ba.uuid+'").value'}},{key:"dispose",value:function(){var Ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){return Ja.yield(Ba.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
Ba.delegateId+"']\n    ",Ba.evalEnvironment),0)})}},{key:"display",value:function(Ba){return Ba.keyString+": "+Ba.valueString}},{key:"collapse",value:function(Ba,Ja){var Sa=this,ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fb){if(1==Fb.nextAddress)return(Ba.isCollapsed=Ja)||Sa.isLeaf(Ba)?Fb.return():Ba.children.length?Fb.jumpTo(0):Fb.yield(Sa.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+Ba.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Sa.delegateId+'"]'}),3);ba=Fb.yieldResult;Ba.children=ba.isError?[]:ba.value;Fb.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(Ba,Ja){var Sa=this,ba,Fb,va,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){if(1==mb.nextAddress)return mb.yield(Sa.createRemoteContext(Ba,Ja),2);ba=mb.yieldResult;
Fb=ba.proxy;va=ba.delegateId;Ua=ba.evalEnvironment;return mb.return(new Sa({key:"inspectee",proxy:Fb,delegateId:va,evalEnvironment:Ua,inspector:Ja}))})}},{key:"createRemoteContext",value:function(Ba,Ja){var Sa=Ba.code,ba=Ba.evalEnvironment,Fb=Ba.delegateId,va,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){if(1==mb.nextAddress)return Fb="lively://inspector-"+Ja.id,mb.yield(ba.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Sa+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Fb+'");\n    ',ba),2);va=mb.yieldResult;Ua=va.value;return mb.return({delegateId:Fb,evalEnvironment:ba,proxy:Ua})})}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(De.InspectionTree);
De.RemoteInspectionTree=Rf;De.RemoteInspectionTree=Rf;De.RemoteInspectionTree=Rf;(function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),cc=Va.hasOwnProperty("InspectionNode")&&"function"===typeof Va.InspectionNode?Va.InspectionNode:Va.InspectionNode=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:Symbol.for("lively-instance-initialize"),value:function(Ba){var Ja=
Ba.root,Sa=Ba.priority,ba=Ba.key,Fb=Ba.keyString,va=Ba.value,Ua=Ba.valueString,mb=Ba.isCollapsed,Ub=void 0===Ba.children?[]:Ba.children,yc=void 0===Ba.isSelected?!1:Ba.isSelected,Pc=void 0===Ba.visible?!0:Ba.visible;this.partition=Ba.partition;this.priority=Sa;this.key=ba;this.keyString=String(Fb||ba);this.value=va;this.valueString=Ua||De.printValue(va);this.isCollapsed=mb;this.children=Ub;this.isSelected=yc;this.visible=Pc;this.root=Ja}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(Ba){if(Ba.value&&Ba.value.isMorph)return new De.MorphNode(Object.assign({root:this.root},Ba));var Ja=Ba.key,Sa=Ba.keyString,ba=this.value,Fb=Ba.partition;Fb&&(ba=Fb.originalValue,Sa=Ja);return new De.PropertyNode(Object.assign({},Ba,{keyString:Sa,key:Ja,target:ba,partition:Fb,root:this.root,spec:{}}))}},{key:"display",value:function(Ba){var Ja=this.keyString,Sa=this.valueString;if(!this.interactive)return Ja+": "+Sa;this._propertyWidget||
(this._propertyWidget=Ba.renderDraggableTreeLabel({value:Ja+": "+Sa}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(Ba,Ja){Ja=void 0===Ja?null:Ja;return Ba.value&&Ba.value.isMorph?new De.MorphNode(Object.assign({root:Ja},Ba)):new De.InspectionNode(Object.assign({root:Ja},Ba))}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),cc=Va.hasOwnProperty("MorphNode")&&"function"===typeof Va.MorphNode?Va.MorphNode:Va.MorphNode=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,
[{key:Symbol.for("lively-instance-initialize"),value:function(Ba){Sb._get(Object.getPrototypeOf(cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Ba);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(Ba){var Ja=this.propertyInfo[Ba.key]||{};return Ba.value&&Ba.value.isMorph?new De.MorphNode(Object.assign({},Ba,{root:this.root})):new De.PropertyNode(Object.assign({},Ba,{root:this.root,target:this.target,
spec:Ja}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(De.InspectionNode);(function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),cc=Va.hasOwnProperty("PropertyNode")&&
"function"===typeof Va.PropertyNode?Va.PropertyNode:Va.PropertyNode=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:Symbol.for("lively-instance-initialize"),value:function(Ba){Sb._get(Object.getPrototypeOf(cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Ba);var Ja=Ba.spec,Sa=Ba.target;this.partition=Ba.partition;this.target=Sa;this.spec=Ja;this.foldedNodes={}}},{key:"__deserialize__",
value:function(Ba,Ja){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(Ba){this._interactive=Ba}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(Ba){return this.isFoldable?this.getFoldedContext(Ba):Sb._get(Object.getPrototypeOf(cc.prototype),"getSubNode",this).call(this,Ba)}},{key:"getFoldedContext",
value:function(Ba){return this.foldedNodes[Ba.key]=new De.FoldedNode(Object.assign({},Ba,{root:this.root,target:this.target,foldableNode:this,spec:De.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(Ba,Ja){(Ja=void 0===Ja?!1:Ja)&&(this.target[this.key]=Ba);this.value=this.target[this.key];this.valueString=De.printValue(this.value);this.interactive&&(Ja||this._propertyWidget.highlight());if(this.isFoldable)for(var Sa in this.foldedNodes)this.foldedNodes[Sa].value=
this.value[Sa],this.foldedNodes[Sa].valueString=De.printValue(this.value[Sa]),this.foldedNodes[Sa]._propertyWidget&&De.signal(this.foldedNodes[Sa]._propertyWidget,"update",this.value[Sa])}},{key:"display",value:function(Ba){var Ja=this,Sa=this._propertyWidget,ba=this.keyString,Fb=this.valueString,va=this.target,Ua=this.value,mb=this.spec;if(!(this.interactive||mb.foldable&&De.isMultiValue(Ua,mb.foldable)))return Ba.renderPropertyControl({target:va,keyString:ba,valueString:Fb,tree:Ba.ui.propertyTree,
value:Ua,spec:mb,node:this,fastRender:!0});if(Sa)return Sa.keyString=ba,Sa.valueString=Fb,Sa.isSelected=this.isSelected,Sa.control&&(Sa.control.isSelected=this.isSelected),Sa;Sa=this._propertyWidget=Ba.renderPropertyControl({target:va,keyString:ba,valueString:Fb,value:Ua,spec:mb,node:this,isSelected:this.isSelected,fontColor:Ba.ui.propertyTree.fontColor});this.isInternalProperty||mb.readOnly||(De.connect(Sa,"propertyValue",this,"refreshProperty",{updater:function(Ub,yc){return Ub(yc,!0)}}),De.connect(Sa,
"openWidget",this.root,"onWidgetOpened",{converter:function(Ub){return{widget:Ub,node:Ja.sourceObj}}}));return Sa}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(De.InspectionNode);
(function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),cc=Va.hasOwnProperty("FoldedNode")&&"function"===typeof Va.FoldedNode?Va.FoldedNode:Va.FoldedNode=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:Symbol.for("lively-instance-initialize"),value:function(Ba){Sb._get(Object.getPrototypeOf(cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
Ba);this.foldableNode=Ba=Ba.foldableNode;this.foldedProp=Ba.key+De.string.capitalize(this.key)}},{key:"refreshProperty",value:function(Ba,Ja){Ja=void 0===Ja?!1:Ja;var Sa={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Sa[this.key]=Ba,Sa)),Ja)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Va,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(De.PropertyNode);var Vf=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Vf.Color=Ib;var dg=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),cc=Va.hasOwnProperty("DarkTheme")&&"function"===typeof Va.DarkTheme?Va.DarkTheme:Va.DarkTheme=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Sb(cc,cb,[{key:"background",get:function(){return Vf.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Vf.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Vf.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Vf.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Vf.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Vf.Color.white,fontWeight:"bold",backgroundColor:Vf.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Vf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Vf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],Va,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),eg=dg=Vf.DarkTheme;Vf.default=dg;var $c=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");$c.inspect=Ta;$c.remoteInspect=Y;$c.generateReferenceExpression=Ma;$c.onNumberDragStart=
function(cb,Va){Va.initPos=cb.position;Va.factorLabel=(new $c.Tooltip({description:"1x"})).openInWorld(cb.hand.position.addXY(10,10))};$c.onNumberDrag=function(cb,Va){var cc=$c.getScaleAndOffset(cb,Va),Ba=cc.scale;cc=cc.offset;Va.factorLabel.position=cb.hand.position.addXY(10,10);Va.factorLabel.description=Ba+"x";return $c.getCurrentValue(cc,Ba,Va)};$c.onNumberDragEnd=function(cb,Va){var cc=$c.getScaleAndOffset(cb,Va);cb=cc.offset;cc=cc.scale;Va.factorLabel.softRemove();return $c.getCurrentValue(cb,
cc,Va)};$c.getScaleAndOffset=function(cb,Va){var cc=cb.position.subPt(Va.initPos);cb=cc.x;Va=$c.num.roundTo(Math.exp(-cc.y/$world.height*6),.01)*Va.baseFactor;return{offset:cb,scale:Va}};$c.getCurrentValue=function(cb,Va,cc){return Math.max(cc.min,Math.min(cc.max,cc.scrubbedValue+(cc.floatingPoint?cb*Va:Math.round(cb*Va))))};$c.Color=Ib;$c.rect=gd;$c.pt=Cd;$c.obj=Ie;$c.num=me;$c.Path=ae;$c.arr=xc;$c.promise=Fe;$c.connect=Ic;$c.disconnect=Wb;$c.once=fd;$c.Morph=Cc;$c.Tooltip=Td;$c.VerticalLayout=Ec;
$c.HorizontalLayout=Vd;$c.morph=nd;$c.Label=Lb;$c.Icon=ub;$c.config=uc;$c.Tree=dc;$c.LoadingIndicator=Zb;$c.DropDownList=Mc;$c.DropDownSelector=$a;$c.SearchField=$b;$c.LabeledCheckBox=Eb;$c.MorphHighlighter=Sc;$c.InteractiveMorphSelector=Pd;$c.printValue=Gb;$c.RemoteInspectionTree=Rf;$c.InspectionTree=Cf;$c.isMultiValue=Ob;$c.valueWidgets=ec;$c.popovers=Xb;$c.DarkTheme=eg;$c.DefaultTheme=Wc;$c.syncEval=kc;$c.inspectorCommands=[{name:"focus codeEditor",exec:function(cb){cb.get("codeEditor").show();
cb.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(cb){cb.get("propertyTree").show();cb.get("propertyTree").focus();return!0}}];(function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),cc=Va.hasOwnProperty("DraggedProp")&&"function"===typeof Va.DraggedProp?Va.DraggedProp:Va.DraggedProp=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:"applyToTarget",
value:function(Ba){var Ja=this.currentTarget,Sa=this.control;this.remove();$c.MorphHighlighter.removeHighlighters(Ba.world);if(Ja)if(Ja.isText&&"js"===Ja.editorModeName){var ba=Ja.evalEnvironment.context;Ba=Ja.textPositionFromPoint(Ja.localize(Ba.position));ba=$c.generateReferenceExpression(this.sourceObject,{fromMorph:ba});Sa.keyString&&(ba+="."+Sa.keyString);Ja.insertTextAndSelect(ba,Ba);Ja.focus()}else"propertyValue"in Sa&&(Ja[Sa.keyString]=Sa.propertyValue)}},{key:"update",value:function(Ba){Ba=
Ba.hand.globalPosition;var Ja=this.morphBeneath(Ba);if(Ja){for(Ja==this.morphHighlighter&&(Ja=Ja.morphBeneath(Ba));[Ja].concat($jscomp.arrayFromIterable(Ja.ownerChain())).find(function(Sa){return!Sa.visible});)Ja=Ja.morphBeneath(Ba);if(Ja!=this.currentTarget){this.currentTarget=Ja;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Ja.isWorld)return;this.morphHighlighter=$c.MorphHighlighter.for($world,Ja);this.morphHighlighter.show()}this.position=Ba}}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:$c.Color.rgb(169,204,227)},fill:{defaultValue:$c.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var Ba=this.control;if(!Ba)return this.submorphs=[];this.height=22;this.submorphs=[Ba];Ba.top=0;Ba.fontSize=14;"function"===typeof Ba.relayout&&Ba.relayout();this.width=Ba.width+
20;this.adjustOrigin($c.pt(10,10))}}}}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1223,end:3665})})($c.Morph);(function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),cc=Va.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Va.DraggableTreeLabel?
Va.DraggableTreeLabel:Va.DraggableTreeLabel=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(Ba){this.draggedProp=new $c.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();$c.connect(Ba.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(Ba){}},
{key:"onDragEnd",value:function(Ba){$c.disconnect(Ba.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(Ba)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:$c.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:$c.Color.transparent},
padding:{defaultValue:$c.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(Ba){this.setProperty("isSelected",Ba);Ba?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=Ba)}}}}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3667,end:5006})})($c.Label);Cf=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),cc=Va.hasOwnProperty("PropertyControl")&&"function"===typeof Va.PropertyControl?Va.PropertyControl:Va.PropertyControl=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(Ba,Ja,Sa){Ba.control=new $c.DropDownSelector({opacity:.8,fill:$c.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Ja,padding:0,values:Sa});$c.connect(Ba.control,"update",Ba,"propertyValue",{updater:function(ba,Fb){this.targetObj.propertyValue!=Fb&&ba(Fb)}});$c.connect(Ba,"update",Ba.control,"selectedValue",{updater:function(ba,Fb){Fb=Fb&&Fb.valueOf?Fb.valueOf():Fb;this.targetObj.propertyValue!=Fb&&ba(Fb)}});return Ba}},
{key:"toggleMultiValuePlaceholder",value:function(Ba){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:$c.Color.transparent,layout:new $c.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:$c.arr.range(0,2).map(function(Ja){return{type:"ellipse",fill:$c.Color.gray.withA(.5),reactsToPointer:!1,extent:$c.pt(7,7)}})});Ba?($c.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),
this.control.opacity=0,this.multiValuePlaceholder.visible=!0):($c.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(Ba){this.foldableProperties&&this.toggleMultiValuePlaceholder($c.isMultiValue(Ba,this.foldableProperties))}},{key:"asFoldable",value:function(Ba){this.foldableProperties=Ba;$c.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();
this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var Ba=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});
Ba.isLayoutable=!1;Ba.fontWeight="bold";Ba.fontColor=$c.Color.orange;Ba.reactsToPointer=!1;Ba.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(Ba){this.submorphs=[Ba]}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[];$c.connect(this,
"extent",this,"relayout")}}}}},{key:"inferType",value:function(Ba){return(Ba=Ba.value)&&(Ba.isColor||Ba.isGradient)?"Color":Ba&&Ba.isPoint?"Point":$c.obj.isBoolean(Ba)?"Boolean":$c.obj.isNumber(Ba)?"Number":$c.obj.isString(Ba)?"String":Ba&&Ba.isRectangle?"Rectangle":!1}},{key:"render",value:function(Ba){Ba.spec.type||(Ba.spec=Object.assign({},Ba.spec,{isFloat:!Number.isInteger(Ba.value),type:this.inferType(Ba)}));switch(Ba.spec.type){case "Color":var Ja=this.renderColorControl(Ba);break;case "ColorGradient":Ja=
this.renderColorControl(Object.assign({},Ba,{gradientEnabled:!0}));break;case "Number":Ja=this.renderNumberControl(Ba);break;case "String":Ja=this.renderStringControl(Ba);break;case "RichText":Ja=this.renderStringControl(Ba);break;case "Layout":Ja=this.renderLayoutControl(Ba);break;case "Enum":Ja=this.renderEnumControl(Ba);break;case "Shadow":Ja=this.renderShadowControl(Ba);break;case "Point":Ja=this.renderPointControl(Ba);break;case "Rectangle":Ja=this.renderRectangleControl(Ba);break;case "Boolean":Ja=
this.renderBooleanControl(Ba);break;default:Ja=this.renderItSomehow(Ba)}Ja.control&&($c.connect(Ja.control,"openWidget",Ja,"openWidget"),Ja.toggleFoldableValue(Ba.value));return Ja}},{key:"baseControl",value:function(Ba){var Ja=Ba.spec;Ba=new this({keyString:Ba.keyString,valueString:Ba.valueString,isSelected:!1,propertyValue:Ba.value});Ja.foldable&&Ba.asFoldable(Ja.foldable);return Ba}},{key:"renderGrabbableKey",value:function(Ba){var Ja=this,Sa=Ba.target;return[Ba.keyString+":",{nativeCursor:"-webkit-grab",
onDragStart:function(ba){ba.state.draggedProp=new $c.DraggedProp({sourceObject:Sa,control:Ja.baseControl(Ba)});ba.state.draggedProp.openInWorld();$c.connect(ba.hand,"update",ba.state.draggedProp,"update")},onDrag:function(ba){},onDragEnd:function(ba){$c.disconnect(ba.hand,"update",ba.state.draggedProp,"update");ba.state.draggedProp.applyToTarget(ba)}}]}},{key:"renderEnumControl",value:function(Ba){var Ja=Ba.value,Sa=Ba.spec.values,ba=Ba.keyString,Fb=Ba.target,va=Ba.node,Ua=function(mb,Ub){return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){Fb.world().openWorldMenu(mb,
Sa.map(function(Pc){return{string:Pc.toString(),action:function(){Fb[ba]=Pc;va.rerender()}}}));yc.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Ba)),[" "+(Ja?Ja.valueOf?Ja.valueOf():Ja:"Not set"),{nativeCursor:"pointer",onMouseDown:Ua}],$jscomp.arrayFromIterable($c.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:Ua})))}},{key:"renderStringControl",value:function(Ba){var Ja=Ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Ba)),
[" "+(200<Ja.length?Ja.slice(0,20)+"...":Ja),{fontColor:$c.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(Ba){var Ja=Ba.value,Sa=Ba.keyString,ba=Ba.valueString,Fb=Ba.target,va=Ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Ba)),[" "+ba,{fontColor:$c.Color.black,nativeCursor:"pointer",onMouseDown:function(Ua){var mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ub){if(1==Ub.nextAddress)return mb=new $c.popovers.RectanglePopover({hasFixedPosition:!0,
rectangle:Ja}),mb.relayout(),Ub.yield(mb.fadeIntoWorld(Ua.positionIn(Fb.world())),2);$c.connect(mb,"rectangle",function(yc){Fb[Sa]=yc;va.rerender()});Ub.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(Ba){var Ja=Ba.value,Sa=Ba.keyString,ba=Ba.valueString,Fb=Ba.target,va=Ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Ba)),[" "+ba,{nativeCursor:"pointer",fontColor:Ja?$c.Color.green:$c.Color.red,onMouseDown:function(Ua){Fb[Sa]=!Fb[Sa];va.rerender()}}])}},{key:"renderNumberControl",
value:function(Ba){var Ja=Ba.value,Sa=Ba.spec,ba=Ba.keyString,Fb=Ba.valueString,va=Ba.node,Ua=Ba.target,mb=Ba.tree,Ub=void 0===va._numberControls?new Oe:va._numberControls,yc=$jscomp.makeIterator(Ub.submorphs),Pc=yc.next().value,Zc=yc.next().value;Ub.fontColor=mb.fontColor;var Qc=va._numberControls=Ub;"max"in Sa&&"min"in Sa&&-Infinity!=Sa.min&&Infinity!=Sa.max?(Qc.baseFactor=(Sa.max-Sa.min)/100,Qc.floatingPoint=Sa.isFloat,Qc.max=Sa.max,Qc.min=Sa.min):(Qc.floatingPoint=Sa.isFloat,Qc.baseFactor=.5,
Qc.min=void 0!=Sa.min?Sa.min:-Infinity,Qc.max=void 0!=Sa.max?Sa.max:Infinity);var Ld=$c.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Ba)),$jscomp.arrayFromIterable(va._inputMorph?[va._inputMorph,{}]:[" "+(void 0!=Ja&&(Ja.valueOf?Ja.valueOf():Ja).toFixed(Sa.isFloat?Math.max(4,$c.num.precision(Ja)):0))+" ",{fontColor:Ld,onMouseUp:function(we){va._inputMorph=$c.morph({type:"input",fill:null,fontColor:Ld,fontFamily:"IBM Plex Mono",
fontSize:14,padding:$c.rect(8,2,-6,2),height:23,cursorColor:$c.Color.white,value:Ja.valueOf?Ja.valueOf():Fb});Ua[ba]=Ja;va._inputMorph.focus();$c.once(va._inputMorph,"inputAccepted",function(af){delete va._inputMorph;Ua[ba]=Sa.isFloat?Number.parseFloat(af):Number.parseInt(af);va.rerender()});$c.once(va._inputMorph,"onBlur",function(af){va._inputMorph&&(delete va._inputMorph,Ua[ba]=Ja,va.rerender())});va.rerender()},onDragStart:function(we){Qc.scrubbedValue=Ja;$c.onNumberDragStart(we,Qc)},onDrag:function(we){Ua[ba]=
$c.onNumberDrag(we,Qc);va.rerender()},onDragEnd:function(we){return $c.onNumberDragEnd(we,Qc)}},Ub,{onMouseUp:function(){Pc.fill=Zc.fill=null},onMouseDown:function(we){if(we.targetMorph===Pc){Pc.fill=$c.Color.white.withA(.2);if("max"in Sa&&Ua[ba]>=Sa.max)return;Ua[ba]+=1}if(we.targetMorph===Zc){Zc.fill=$c.Color.white.withA(.2);if("min"in Sa&&Ua[ba]<=Sa.min)return;--Ua[ba]}va.rerender()}}]))}},{key:"renderShadowControl",value:function(Ba){var Ja=Ba.keyString,Sa=Ba.value,ba=Ba.target,Fb=Ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Ba)),
[""+(Sa?Sa.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(va){var Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){if(1==mb.nextAddress)return Ua=new $c.popovers.ShadowPopover({shadowValue:ba[Ja],hasFixedPosition:!0}),mb.yield(Ua.fadeIntoWorld(va.positionIn(ba.world())),2);$c.connect(Ua,"shadowValue",function(Ub){ba[Ja]=Ub;Fb.rerender()});mb.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(Ba){var Ja=Ba.keyString,Sa=Ba.value,ba=Ba.target,Fb=Ba.node,
va=$c.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Ua={nativeCursor:"pointer",onMouseDown:function(mb){var Ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){if(1==yc.nextAddress)return Ub=new $c.popovers.PointPopover({pointValue:ba[Ja],hasFixedPosition:!0}),yc.yield(Ub.fadeIntoWorld(mb.positionIn(ba.world())),2);$c.connect(Ub,"pointValue",function(Pc){ba[Ja]=Pc;Fb.rerender()});yc.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Ba)),
[" pt(",Object.assign({},Ua),""+Sa.x.toFixed(),Object.assign({fontColor:va},Ua),",",Object.assign({},Ua),""+Sa.y.toFixed(),Object.assign({fontColor:va},Ua),")",Object.assign({},Ua)])}},{key:"renderLayoutControl",value:function(Ba){var Ja=Ba.valueString,Sa=Ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Ba)),[" "+(Sa?Ja:"No Layout"),{onMouseDown:function(ba){}}])}},{key:"renderColorControl",value:function(Ba){var Ja=Ba.node,Sa=Ba.gradientEnabled,ba=Ba.valueString,Fb=Ba.keyString,
va=Ba.value,Ua=Ba.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Ba)),[$c.morph({fill:va.valueOf?va.valueOf():va,extent:$c.pt(15,15),borderColor:$c.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(va?va.valueOf?va.valueOf():ba:"No Color"),{nativeCursor:"pointer",onMouseDown:function(mb){var Ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){if(1==yc.nextAddress)return Ub=new $c.popovers.FillPopover({hasFixedPosition:!0,
handleMorph:Ua,fillValue:va,title:"Fill Control",gradientEnabled:Sa}),yc.yield(Ub.fadeIntoWorld(mb.positionIn(Ua.world())),2);$c.connect(Ub,"fillValue",function(Pc){Ua[Fb]=Pc;Ja.rerender()});yc.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(Ba){var Ja=Ba.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Ba)),[" "+Ja,{}])}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5015,end:20308})}($c.DraggableTreeLabel);$c.PropertyControl=Cf;$c.PropertyControl=Cf;$c.PropertyControl=Cf;$c.inspect=Ta;$c.inspect=Ta;$c.remoteInspect=Y;$c.remoteInspect=Y;$c.generateReferenceExpression=Ma;$c.generateReferenceExpression=Ma;var Oe=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),cc=Va.hasOwnProperty("NumberControls")&&"function"===typeof Va.NumberControls?Va.NumberControls:Va.NumberControls=
function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new $c.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:$c.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(Ba){this.submorphs.map(function(Ja){return Ja.fontColor=
Ba})}},submorphs:{initialize:function(){this.submorphs=[$c.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:$c.rect(5,2,0,-6),fontSize:12}),$c.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:$c.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22981,end:24026})}($c.Morph);(function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),cc=Va.hasOwnProperty("PropertyTree")&&"function"===typeof Va.PropertyTree?Va.PropertyTree:Va.PropertyTree=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:"onDrag",value:function(Ba){this._onDragHandler&&this._onDragHandler(Ba)}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25191,end:25302})})($c.Tree);Cf=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),cc=Va.hasOwnProperty("Inspector")&&"function"===
typeof Va.Inspector?Va.Inspector:Va.Inspector=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(Ba){}},{key:"__after_deserialize__",value:function(Ba,Ja,Sa){var ba=this,Fb=new $c.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,
{treeData:$c.InspectionTree.forObject(null,this)}));this.addMorph(Fb,this.getSubmorphNamed("terminal toggler"));Sb._get(Object.getPrototypeOf(cc.prototype),"__after_deserialize__",this).call(this,Ba,Ja,Sa);!this.isComponent&&this.master.whenApplied().then(function(){ba.layout.col(0).row(1).group.morph=Fb;ba.targetObject&&(ba.targetObject=ba.targetObject)})}},{key:"__additionally_serialize__",value:function(Ba,Ja,Sa,ba){Ba=Ba.props.submorphs.value;for(Ja=Ba.length;Ja--;)Sa.refForId(Ba[Ja].id).realObj==
this.ui.propertyTree&&$c.arr.removeAt(Ba,Ja)}},{key:"renderDraggableTreeLabel",value:function(Ba){return new $c.DraggableTreeLabel(Ba)}},{key:"renderPropertyControl",value:function(Ba){return $c.PropertyControl.render(Ba)}},{key:"onLoad",value:function(){var Ba=this.ui,Ja=Ba.codeEditor,Sa=Ba.thisBindingSelector,ba=Ba.propertyTree;Ja.changeEditorMode("js").then(function(){return Ja.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Sa.selection?Ja.owner.selectedContext:
Ja.owner.targetObject},get systemInterface(){return $c.Path("treeData.systemInterface").get(ba)},format:"esm"}}).catch(function(Fb){return $world.logError(Fb)})}},{key:Symbol.for("lively-instance-initialize"),value:function(Ba){Sb._get(Object.getPrototypeOf(cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Ba);Ba=this.ui;var Ja=Ba.targetPicker,Sa=Ba.propertyTree,ba=Ba.resizer,Fb=Ba.terminalToggler,va=Ba.unknowns,Ua=Ba.internals,mb=Ba.searchField,Ub=Ba.codeEditor,yc=Ba.fixImportButton,
Pc=Ba.thisBindingSelector;Ub.changeEditorMode("js").then(function(){return Ub.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Pc.selection?Ub.owner.selectedContext:Ub.owner.targetObject},get systemInterface(){return Sa.treeData.systemInterface},format:"esm"}}).catch(function(Zc){return $world.logError(Zc)});$c.connect(Ja,"onMouseUp",this,"selectTarget");$c.connect(Sa,"onScroll",this,"repositionOpenWidget");$c.connect(ba,"onDrag",this,"adjustProportions");
$c.connect(Fb,"onMouseDown",this,"toggleCodeEditor");$c.connect(va,"trigger",this,"filterProperties");$c.connect(Ua,"trigger",this,"filterProperties");$c.connect(mb,"searchInput",this,"filterProperties");$c.connect(Sa,"nodeCollapseChanged",this,"filterProperties");$c.connect(this,"extent",this,"relayout");$c.connect(Pc,"selection",this,"bindCodeEditorThis");$c.connect(yc,"fire",Ub,"execCommand",{updater:function(Zc){return Zc("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},
{key:"refreshSelectedLine",value:function(){var Ba=this.ui.propertyTree.selectedIndex-1,Ja=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Ja=this.ui.propertyTree.document.getLine(Ba).textAndAttributes.slice(0,4).concat(Ja.display(this));Ba=this.ui.propertyTree.lineRange(Ba,!1);this.ui.propertyTree.replace(Ba,Ja,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();
if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var Ba=$c.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(Ba!=this.lastChange||this.lastSubmorphs!=$c.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==Ba.prop&&this.repositionOpenWidget(),this.lastChange=Ba,this.lastSubmorphs=
$c.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var Ba;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Ja){Ja=Ja.node;Ja.target&&(Ba=Ja.foldableNode?Ja.target[Ja.foldableNode.key][Ja.key]:Ja.target[Ja.key],!$c.obj.equals(Ba,Ja.value)&&Ja.refreshProperty&&Ja.refreshProperty(Ba))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},
{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(Ba,Ja){Ja=void 0===Ja?!1:Ja;var Sa=this,ba,Fb,va,Ua,mb,Ub,yc,Pc,Zc,Qc,Ld,we,af,de,kf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qe){switch(Qe.nextAddress){case 1:if(!Sa.isUpdating()){Qe.jumpTo(2);break}return Qe.yield(Sa.whenUpdated(),2);case 2:ba=$c.promise.deferred();Fb=ba.promise;va=!!Sa.target;Sa.updateInProgress=Fb;Qe.setCatchFinallyBlocks(4);Ja&&(Ua=$c.LoadingIndicator.open("connecting to remote..."));
if(!Ja){mb=$c.InspectionTree.forObject(Ba,Sa);Qe.jumpTo(6);break}return Qe.yield($c.RemoteInspectionTree.forObject(Ba,Sa),7);case 7:mb=Qe.yieldResult;case 6:return Ub=mb,yc=Sa.ui.propertyTree,Qe.yield(Ub.collapse(Ub.root,!1),8);case 8:if(!Ub.root.children){Qe.jumpTo(9);break}return Qe.yield(Ub.collapse(Ub.root.children[0],!1),9);case 9:if(Pc=Sa.originalTreeData&&Sa.originalTreeData.diff(Ub)){Zc=$jscomp.makeIterator(Pc);for(Qc=Zc.next();!Qc.done;Qc=Zc.next())Ld=Qc.value,we=$jscomp.makeIterator(Ld),
af=we.next().value,de=we.next().value,af.refreshProperty(de.value);Qe.jumpTo(11);break}yc.treeData=Ub;return Qe.yield(Sa.filterProperties(),12);case 12:if(!yc.treeData.root.isCollapsed){Qe.jumpTo(13);break}return Qe.yield(yc.onNodeCollapseChanged({node:Ub.root,isCollapsed:!1}),14);case 14:yc.selectedIndex=1;case 13:return Qe.yield(yc.execCommand("uncollapse selected node"),11);case 11:Sa.toggleWindowStyle(va);Ua&&Ua.remove();Qe.leaveTryBlock(5);break;case 4:kf=Qe.enterCatchBlock(),Sa.showError(kf);
case 5:Sa.startStepping(1E3,"refreshAllProperties"),Sa.updateInProgress=null,Qe.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(Ba){Ba=void 0===Ba?!0:Ba;var Ja=this,Sa,ba,Fb,va,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){if(1==mb.nextAddress)return Sa=300,va=Ja.ui.codeEditor.pluginFind(function(Ub){return Ub.runEval}),Ua=Ja.getWindow(),mb.yield(va.runEval("System.get('@system-env').node"),2);mb.yieldResult.value?(Fb=[].concat($jscomp.arrayFromIterable($c.arr.without(Ua.styleClasses,
"local")),["node"]),ba=$c.DarkTheme.instance):(Fb=["local"].concat($jscomp.arrayFromIterable(Ua?$c.arr.without(Ua.styleClasses,"node"):[])),ba=$c.DefaultTheme.instance);va.theme=ba;Ba?(Ua&&Ua.animate({duration:Sa,styleClasses:Fb}),Ja.ui.codeEditor.animate({fill:ba.background,duration:Sa})):Ua&&(Ua.styleClasses=Fb);Ja.ui.codeEditor.textString=Ja.ui.codeEditor.textString;va.highlight();mb.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||
Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var Ba=this,Ja=Object.assign({type:"text",borderWidth:1,borderColor:$c.Color.gray,lineWrapping:"by-chars"},$c.config.codeEditor.defaultStyle,{textString:""}),Sa=$c.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});$c.rect(0,0,this.width,30);var ba=new $c.SearchField({styleClasses:["idle"],name:"searchField"});Sa[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[ba,
{type:"button",name:"targetPicker",padding:$c.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:$c.Icon.textAttribute("crosshairs")},new $c.LabeledCheckBox({label:"Internals",name:"internals"}),new $c.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new $c.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:$c.InspectionTree.forObject(null,this)})),$c.Icon.makeLabel("keyboard",{name:"terminal toggler"}),
{name:"resizer"},Object.assign({name:"codeEditor"},Ja),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:$c.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Sa),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Sa),[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=
3;this.ui.thisBindingSelector.whenRendered().then(function(){Ba.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var Ba=this,Ja,Sa,ba,Fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(va){switch(va.nextAddress){case 1:if(Ba.env.eventDispatcher.isKeyPressed("Shift"))return Sa=$jscomp,ba=Sa.makeIterator,va.yield($world.execCommand("select morph",{justReturn:!0}),5);Ba.toggleSelectionInstructions(!0);return va.yield($c.InteractiveMorphSelector.selectMorph(),
4);case 4:Ja=va.yieldResult;Ba.toggleSelectionInstructions(!1);va.jumpTo(3);break;case 5:Fb=ba.call(Sa,va.yieldResult),Ja=Fb.next().value;case 3:Ja&&(Ba.targetObject=Ja),va.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(Ba){if(Ba&&!this.instructionWidget){var Ja=$c.morph({type:"label",name:"escapeKey",value:"esc"});Ja.whenRendered().then(function(){return Ja.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,
lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},Ja,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(Ba){Ba=Ba.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;
Ba.epiMorph=!0;this.openWidget=Ba;$c.once(Ba,"close",this,"closeOpenWidget");$c.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var Ba=this.ui.propertyTree,Ja=Ba.textLayout.boundsFor(Ba,{column:0,row:Ba.selectedIndex-1});Ja=Ba.worldPoint($c.pt(Ja.x,Ja.y+Ja.height/2)).addPt(Ba.scroll.negated());Ba=Ba.globalBounds();Ja.x=this.globalBounds().center().x;Ja.y<Ba.top()?Ja=Ba.topCenter():Ba.bottom()-20<Ja.y&&(Ja=Ba.bottomCenter().addXY(0,-20));
return Ja}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(Ba){var Ja=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){Ja.layout.row(1).height+=Ba.state.dragDelta.y;Ja.relayout();Sa.jumpToEnd()})}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(Ba){if(Ba!==this.isEditorVisible()){var Ja=
this.extent,Sa=this.layout,ba=this.ui,Fb=ba.terminalToggler,va=ba.codeEditor,Ua=ba.thisBindingSelector;ba=ba.fixImportButton;Sa.disable();Ba?(Fb.fontColor=$c.Color.rgbHex("00e0ff"),Sa.row(3).height=this.codeEditorHeight||180,Sa.row(2).height=5,ba.animate({visible:!0,duration:200}),Ua.animate({visible:!0,duration:200})):(this.codeEditorHeight=Sa.row(3).height,Fb.fontColor=$c.Color.white,Sa.row(3).height=Sa.row(2).height=0,ba.animate({visible:!1,duration:200}),Ua.animate({visible:!1,duration:200}));
this.extent=Ja;Sa.enable({duration:200});this.relayout({duration:200});va.focus();va.animate({opacity:Ba?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var Ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){Ba.makeEditorVisible(!Ba.isEditorVisible());Ja.jumpToEnd()})}},{key:"filterProperties",value:function(){var Ba=this,Ja,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ba){if(1==ba.nextAddress)return Ja=Ba.ui.searchField,Sa=Ba.ui.propertyTree,
Ba.originalTreeData||(Ba.originalTreeData=Sa.treeData),$c.disconnect(Sa.treeData,"onWidgetOpened",Ba,"onWidgetOpened"),ba.yield(Sa.treeData.filter({maxDepth:2,showUnknown:Ba.ui.unknowns.checked,showInternal:Ba.ui.internals.checked,iterator:function(Fb){return Ja.matches(Fb.key)}}),2);Sa.update();$c.connect(Sa.treeData,"onWidgetOpened",Ba,"onWidgetOpened");ba.jumpToEnd()})}},{key:"relayout",value:function(Ba){Ba=void 0===Ba?{}:Ba;var Ja=this,Sa,ba,Fb,va,Ua,mb,Ub,yc,Pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zc){Ja.layout&&
Ja.layout.forceLayout();Sa=Ja;ba=Sa.ui;Fb=ba.fixImportButton;va=ba.terminalToggler;Ua=ba.propertyTree;mb=ba.thisBindingSelector;Ub=Ua.bounds().insetBy(5).bottomLeft();yc=Ua.bounds().insetBy(5).bottomRight();Pc=yc.subXY(Fb.width+10,0);mb.width=115;mb.listMorph.itemHeight=20;Ba.duration?(va.animate(Object.assign({bottomLeft:Ub},Ba)),Fb.animate(Object.assign({bottomRight:yc},Ba)),mb.animate(Object.assign({bottomRight:Pc},Ba))):(va.bottomLeft=Ub,Fb.bottomRight=yc,mb.bottomRight=Pc);Zc.jumpToEnd()})}},
{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Sb._get(Object.getPrototypeOf(cc.prototype),"keybindings",this))}},{key:"commands",get:function(){return $c.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(Ba){if(System._testsRunning)return console.log(Ba.targetObject);
Ba=new this(Ba);Ba.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return Ba}},{key:"properties",get:function(){return{extent:{defaultValue:$c.pt(400,500)},fill:{defaultValue:$c.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(Ba){this.setProperty("remoteTarget",Ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(Ba,!0))}},targetObject:{after:["submorphs"],set:function(Ba){this._serializableTarget=
Ba&&Ba.isMorph?Ba.id:Ba;this.setProperty("targetObject",Ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(Ba))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var Ba=this.ui.propertyTree,Ja=Ba.treeData;return Ja.getContextFor(Ba.selectedNode||Ja.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),
fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},
treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:$c.Color.gray,fontSize:14,fontFamily:$c.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Va,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:25319,end:45916})}($c.Morph);Cf=$c.Inspector;Rf=Wa("I",Cf);$c.default=Cf;var og=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");og.Inspector=Rf;og.string=pd;og.Morph=Cc;og.pt=Cd;og.Color=Ib;Cf=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(cb,Va,cc){cc=void 0===cc?1:cc;var Ba,Ja,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ba){switch(ba.nextAddress){case 1:return cb.maybeSelectCommentOrLine(),
ba.setCatchFinallyBlocks(2),Va=Object.assign({},Va,{logDoit:!0,inspect:!0,inspectDepth:cc}),ba.yield(cb.doEval(void 0,Va),4);case 4:Ba=ba.yieldResult;Ja=Ba.error?Ba.error:Ba.isError?Ba.value:null;ba.leaveTryBlock(3);break;case 2:Ja=Sa=ba.enterCatchBlock();case 3:return Ja?cb.showError(Ja):cb.setStatusMessage(og.string.truncate(Ba.value,1E3)),ba.return(Ba)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(cb,Va){var cc,Ba,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){switch(Sa.nextAddress){case 1:return Sa.setCatchFinallyBlocks(2),
Sa.yield(cb.doEval({start:{row:0,column:0},end:cb.documentEndPosition},Object.assign({},Va,{logDoit:!0})),4);case 4:cc=Sa.yieldResult;Ba=cc.error?cc.error:cc.isError?cc.value:null;Sa.leaveTryBlock(3);break;case 2:Ba=Ja=Sa.enterCatchBlock();case 3:return Ba?cb.showError(Ba):cb.setStatusMessage(String(cc.value)),Sa.return(cc)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(cb,Va){var cc,Ba,Ja,Sa,ba,Fb,va,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){switch(mb.nextAddress){case 1:return cb.maybeSelectCommentOrLine(),
mb.setCatchFinallyBlocks(2),Va=Object.assign({},Va,{asString:!1,logDoit:!0}),mb.yield(cb.doEval(void 0,Va),4);case 4:cc=mb.yieldResult;Ba=cc.error?cc.error:cc.isError?cc.value:null;mb.leaveTryBlock(3);break;case 2:Ba=Ja=mb.enterCatchBlock();case 3:cb.selection.collapseToEnd();if(Sa=cc.value&&cc.value.isColor)return cb.selection.text=String(cc.value),ba=new og.Morph({fill:og.Color.transparent,extent:og.pt(cb.fontSize+2,cb.fontSize+2),submorphs:[{fill:cc.value,center:og.pt(cb.fontSize+2,cb.fontSize+
2).scaleBy(.5)}]}),Fb=cb.selection.start,va=Fb.column,Ua=Fb.row,cb.insertText([ba,{}],cb.selection.start),cb.selection.start={column:va,row:Ua},cb.focus(),mb.return(cc);cb.insertTextAndSelect(Ba?String(Ba)+(Ba.stack?"\n"+Ba.stack:""):String(cc.value));cb.focus();return mb.return(cc)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(cb,Va){var cc,Ba,Ja,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ba){switch(ba.nextAddress){case 1:cb.maybeSelectCommentOrLine();
Ba=cb.textInRange(cb.selection);Ja=cb.evalEnvironment||{};Sa=cb.pluginFind(function(Fb){return Fb.isEditorPlugin&&"function"===typeof Fb.runEval});Ja.systemInterface||(Ja.systemInterface=Sa.systemInterface(Va));if("local"!==Ja.systemInterface.name){ba.jumpTo(2);break}ba.setCatchFinallyBlocks(3);return ba.yield(cb.doEval(void 0,Va),5);case 5:cc=ba.yieldResult;Ba=cc.value;ba.leaveTryBlock(2);break;case 3:ba.enterCatchBlock();case 2:return cb.world().execCommand("open object editor",{target:Ba,evalEnvironment:Ja}),
ba.return(cc)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(cb,Va){var cc,Ba,Ja,Sa,ba,Fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(va){switch(va.nextAddress){case 1:cb.maybeSelectCommentOrLine();Ja=cb.textInRange(cb.selection);Sa=cb.evalEnvironment||{};ba=cb.pluginFind(function(Ua){return Ua.isEditorPlugin&&"function"===typeof Ua.runEval});Sa.systemInterface||(Sa.systemInterface=ba.systemInterface(Va));
if("local"!==Sa.systemInterface.name){og.Inspector.openInWindow({remoteTarget:{code:Ja,evalEnvironment:Sa}});va.jumpTo(2);break}va.setCatchFinallyBlocks(3);return va.yield(cb.doEval(void 0,Va),5);case 5:cc=va.yieldResult;Ba=cc.error?cc.error:cc.isError?cc.value:null;Ja=cc.value;va.leaveTryBlock(4);break;case 3:Ba=Fb=va.enterCatchBlock();case 4:og.Inspector.openInWindow({targetObject:Ba||Ja});case 2:return va.return(cc)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(cb,Va,cc){cc=void 0===cc?1:cc;var Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){switch(Ja.nextAddress){case 1:return cb.maybeSelectCommentOrLine(),Ja.setCatchFinallyBlocks(2),Va=Object.assign({},Va,{inspect:!0,inspectDepth:cc,logDoit:!0}),Ja.yield(cb.doEval(void 0,Va),4);case 4:Ba=Ja.yieldResult;Ja.leaveTryBlock(3);break;case 2:Ja.enterCatchBlock();case 3:return cb.selection.collapseToEnd(),cb.insertTextAndSelect(Ba.value),Ja.return(Ba)}})}}];og.codeEvaluationCommands=
Cf;og.codeEvaluationCommands=Cf;og.codeEvaluationCommands=Cf;var ph=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");ph.changeAttributeInSelectionOrMorph=function(cb,Va,cc){var Ba=cb.selection;cb.keepPosAtSameScrollOffsetWhile(function(){Ba.isEmpty()?cb[Va]="function"===typeof cc?cc(cb[Va]):cc:cb.undoManager&&(cb.undoManager.group(),cb.changeStyleProperty(Va,function(Ja){return"function"===typeof cc?cc(Ja):cc}),cb.undoManager.group())})};Rf=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(cb){var Va=cb.fontSize;ph.changeAttributeInSelectionOrMorph(cb,"fontSize",function(cc){cc=cc||Va;return cc+(18<=cc?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(cb){var Va=cb.fontSize;ph.changeAttributeInSelectionOrMorph(cb,"fontSize",function(cc){cc=cc||Va;return cc-(18>=cc?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(cb){var Va,cc,Ba,Ja,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ba){if(1==ba.nextAddress){Va=
["serif","sans-serif","monospace"];if(cc=localStorage["lively.morpic/text-change-font-additional-fonts"])cc=JSON.parse(cc),Va.push.apply(Va,$jscomp.arrayFromIterable(cc));Va.map(function(Fb){return Fb.toLowerCase()}).includes(cb.fontFamily.toLowerCase())||(Va.push(cb.fontFamily),cc=[].concat($jscomp.arrayFromIterable(cc||[]),[cb.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(cc));return ba.yield($world.editListPrompt("choose font",Va,{requester:cb,preselect:Va.indexOf(cb.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}Ba=ba.yieldResult;Ja=$jscomp.makeIterator(Ba.selections);if(Sa=Ja.next().value)cb.fontFamily=Sa;return ba.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(cb,Va){Va=void 0===Va?{}:Va;var cc,Ba,Ja,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ba){if(1==ba.nextAddress){if(Va.hasOwnProperty("link"))return ba.jumpTo(2);Ba=cb.selection;Ja=cb.getStyleInRange(Ba);Sa=Ja.link;return ba.yield(cb.world().prompt("Set link",
{input:Sa||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=ba.nextAddress&&(cc=ba.yieldResult,!cc))return ba.return();cb.undoManager.group();cb.setStyleInRange({link:cc||void 0},Ba);cb.undoManager.group();ba.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(cb,Va){var cc,Ba,Ja,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ba){if(1==ba.nextAddress)return cc=cb.selection,Ba=cb.getStyleInRange(cc),Ja=Ba.doit,ba.yield(cb.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:cb,input:Ja?Ja.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:cb.evalEnvForDoit(Ja||{})}),2);Sa=ba.yieldResult;cb.undoManager.group();Sa?cb.addTextAttribute({doit:{code:Sa},nativeCursor:"pointer",textDecoration:"underline"},cc):cb.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},cc);cb.undoManager.group();ba.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(cb,Va){Va=void 0===Va?{}:Va;cb.undoManager.group();
Va=!Va.onlySelection&&cb.selection.isEmpty()?cb.documentRange:cb.selection.range;cb.setStyleInRange(null,Va);cb.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(cb){var Va,cc,Ba,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){if(1==Sa.nextAddress)return Sa.yield(System.import("lively.modules"),2);if(3!=Sa.nextAddress)return Va=Sa.yieldResult,cc=Va.module,Sa.yield(cc("lively.ide/text/ui.js").load(),3);Ba=Sa.yieldResult;Ja=Ba.RichTextControl;return Sa.return(Ja.openFor(cb))})}}];
ph.commands=Rf;ph.commands=Rf;ph.commands=Rf;var id=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");id.guessTextModeName=gb;id.rangedToken=function(cb,Va,cc,Ba,Ja){return{start:{row:cb,column:Va},end:{row:cb,column:cc},token:Ba,mode:Ja}};id.fun=tc;id.arr=xc;id.connect=Ic;id.disconnect=Wb;id.DefaultTheme=Wc;id.tokenizeDocument=ud;id.modeInfo=oc;id.visitDocumentTokens=wb;id.getMode=ta;id.completionCommands=Zd;id.multiSelectCommands=lf;id.navCommands=z;id.codeCommands=nf;id.codeEvaluationCommands=
Cf;id.richTextCommands=Rf;id.Color=Ib;id.Range=Ne;id.guessTextModeName=gb;id.guessTextModeName=gb;Wc=function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),cc=Va.hasOwnProperty("EditorPlugin")&&"function"===typeof Va.EditorPlugin?Va.EditorPlugin:Va.EditorPlugin=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb(cc,cb,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
id.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(Ba){var Ja=this;this.textMorph=Ba;id.connect(Ba,"textChange",this,"onTextChange");id.connect(Ba,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Ja.highlight()})}},
{key:"detach",value:function(Ba){id.disconnect(Ba,"textChange",this,"onTextChange");id.disconnect(Ba,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(Ba){this._ast=null;if(Ba){var Ja=this._tokenizerValidBefore;if("replace"===Ba.selector){var Sa=Ba.args[0].start;Ba=Sa.row;Sa=Sa.column}else Sa=Ba=0;if(!Ja||Ba<Ja.row||Ba===Ja.row&&Sa<Ja.column)Ba=Math.max(0,Ba),this._tokenizerValidBefore={row:Ba,
column:Sa}}this.requestHighlight()}},{key:"requestHighlight",value:function(Ba){var Ja=this;(void 0===Ba?0:Ba)?this.highlight():id.fun.debounceNamed(this.textMorph.id+"-requestHighlight",300,function(){Ja.highlight()})()}},{key:"highlight",value:function(){var Ba=this.textMorph,Ja=this.theme,Sa=this.mode,ba=this._tokenizerValidBefore;if(Ja&&Ba&&Ba.document&&Sa){Ba.fill=Ja.background;Ba.cursorColor=Ja.cursorColor||Ba.fontColor;var Fb=Ba.viewState,va={};ba=id.tokenizeDocument(Sa,Ba.document,Fb.firstVisibleRow,
Fb.lastVisibleRow,ba);Sa=ba.lines;ba=ba.tokens;if(Sa.length){Fb=Sa[0].row;for(var Ua=[],mb=0;mb<ba.length;Fb++,mb++)for(var Ub=ba[mb],yc=0;yc<Ub.length;yc+=5){var Pc=Ub[yc],Zc=Ub[yc+1],Qc=Ja[Ub[yc+2]]||Ja.default;Qc&&Ua.push({start:{row:Fb,column:Pc},end:{row:Fb,column:Zc}},Qc)}Ba.embeddedMorphs.forEach(function(Ld){var we=Ba.embeddedMorphMap.get(Ld).anchor;va[Ld.id]=Ba.textAttributeAt(we.position)});Ba.setTextAttributesWithSortedRanges(Ua);Ba.embeddedMorphs.forEach(function(Ld){var we=Ba.embeddedMorphMap.get(Ld).anchor;
we=id.Range.at(we.position);we.end.column+=1;Ba.replace(we,[Ld,va[Ld.id]],!1)});this._tokenizerValidBefore={row:id.arr.last(Sa).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},Ba,this)}}},{key:"visitTokensInRange",value:function(Ba,Ja){var Sa=Ba.start,ba=Ba.end,Fb=Sa.row-1;id.visitDocumentTokens(this.mode,this.textMorph.document,Sa.row,ba.row,null,function(va){return Fb++},function(va,Ua,mb,Ub,yc,Pc,Zc){if(Fb===Sa.row&&0<Sa.column){if(Sa.column>=Ub)return;mb<Sa.column&&Sa.column<
Ub&&(mb=Sa.column)}if(Fb===ba.row){if(ba.column<=mb)return;mb<ba.column&&ba.column<Ub&&(Ub=ba.column)}Ja(va,Ua,Fb,mb,Ub,yc,Pc,Zc)})}},{key:"tokensInRange",value:function(Ba){var Ja=[];this.visitTokensInRange(Ba,function(Sa,ba,Fb,va,Ua,mb,Ub,yc){return Ja.push(id.rangedToken(Fb,va,Ua,Sa,yc))});return Ja}},{key:"tokensOfRow",value:function(Ba){var Ja=this.textMorph.getLine(Ba).length;return this.tokensInRange({start:{row:Ba,column:0},end:{row:Ba,column:Ja}})}},{key:"tokenAt",value:function(Ba){for(var Ja=
this.tokensOfRow(Ba.row),Sa=Ja.length;Sa--;){var ba=Ja[Sa];if(ba.token&&ba.start.column<=Ba.column&&Ba.column<=ba.end.column)return ba}return null}},{key:"getCommands",value:function(Ba){return[].concat($jscomp.arrayFromIterable(Ba),$jscomp.arrayFromIterable(id.completionCommands),$jscomp.arrayFromIterable(id.multiSelectCommands),$jscomp.arrayFromIterable(id.navCommands),$jscomp.arrayFromIterable(id.codeCommands),$jscomp.arrayFromIterable(id.codeEvaluationCommands),$jscomp.arrayFromIterable(id.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var Ba=this.mode,Ja=Ba.lineComment,Sa=Ba.blockCommentStart;Ba=Ba.blockCommentEnd;var ba={};Ja&&(ba.lineCommentStart=Ja);Sa&&(ba.blockCommentStart=Sa);Ba&&(ba.blockCommentEnd=Ba);return ba}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(Ba,Ja,Sa){var ba=this.textMorph,Fb=Ba.row,va=Ba.column;Ba=Ja[va-1];Ja=Ja[va];ba.selection.text="\n";ba.selection.collapseToEnd();
"{"===Ba&&"}"===Ja&&(ba.selection.text="\n"+" ".repeat(Sa),ba.selection.collapse());ba.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Fb+1,lastRow:Fb+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var Ba=this.textMorph,Ja=this.openPairs,Sa=Ba.selection,ba=Ba.getLine(Sa.end.row),
Fb=ba[Sa.end.column-1];ba=ba[Sa.end.column];Ba.autoInsertPairs&&Sa.isEmpty()&&Fb in Ja&&ba===Ja[Fb]&&(Sa.growRight(1),Sa.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(Ba){var Ja=this.openPairs,Sa=this.closePairs,ba=this.textMorph,Fb=ba.selection,va=ba.autoInsertPairs&&Ba in Ja,Ua=ba.autoInsertPairs&&Ba in Sa;if(!va&&!Ua)return!1;var mb=ba.getLine(Fb.end.row)[Fb.end.column];if(!Fb.isEmpty()){if(!va)return!1;Sa=ba.undoManager.ensureNewGroup(ba);ba.insertText(Ja[Ba],Fb.end);ba.insertText(Ba,
Fb.start);ba.undoManager.group(Sa);Fb.growRight(-1);return!0}if(mb in Sa&&Ba===mb)return Fb.goRight(1),!0;if(Ua&&!va)return!1;Sa=ba.undoManager.ensureNewGroup(ba);ba.insertText(Ba+Ja[Ba]);ba.undoManager.group(Sa);Fb.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Va,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3148,end:12030})}(void 0);oc=Wc=id.EditorPlugin;Zd=Wa("C",function(cb){var Va=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),cc=Va.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Va.CodeMirrorEnabledEditorPlugin?Va.CodeMirrorEnabledEditorPlugin:Va.CodeMirrorEnabledEditorPlugin=function(Ba){Ba&&Ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Sb(cc,cb,[{key:Symbol.for("lively-instance-initialize"),value:function(){Sb._get(Object.getPrototypeOf(cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(Ba){this.mode=this.codeMirrorMode(Ba);return Sb._get(Object.getPrototypeOf(cc.prototype),"attach",this).call(this,Ba)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",
value:function(Ba){return{indentWithTabs:!Ba.useSoftTabs,indentUnit:Ba.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(Ba){Ba=this.defaultCodeMirrorModeConfig(Ba);return id.getMode(Ba,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Va,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:12041,end:12735})}(id.EditorPlugin));id.CodeMirrorEnabledEditorPlugin=Zd;id.CodeMirrorEnabledEditorPlugin=Zd;id.CodeMirrorEnabledEditorPlugin=Zd;id.default=Wc;Wc=Object.freeze({__proto__:null,guessTextModeName:gb,"default":oc,CodeMirrorEnabledEditorPlugin:Zd});Wa("e",Wc)}}});
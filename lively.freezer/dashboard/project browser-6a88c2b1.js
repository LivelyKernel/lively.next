System.register(["./__root_module__-fd8ea0c8.js","kld-intersections","./index-0b494524.js","./index-b8f51b00.js","./user-ui-84db94da.js"],function(Ca,Bb){var Kb,lc,bc,Td,Xc,Wd,$c,Pc,md,ge,Qe,kf,ke,cc,Hc,Nd,ec,$d,le;return{setters:[function(Dc){Kb=Dc.an;lc=Dc.aD;bc=Dc.ap;Td=Dc.ab;Xc=Dc.Y;Wd=Dc.a6;$c=Dc.ax;Pc=Dc.a7;md=Dc.C;ge=Dc.a3;Qe=Dc.r;kf=Dc.aw;ke=Dc.aC;cc=Dc.b2;Hc=Dc.b3;Nd=Dc.au;ec=Dc.b0;$d=Dc.aZ},function(){},function(){},function(){},function(Dc){le=Dc.UserUI}],execute:function(){var Dc=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");Dc.Morph=Kb;Dc.HorizontalLayout=lc;Dc.VerticalLayout=bc;Dc.morph=Td;Dc.MorphicDB=Xc;Dc.arr=Wd;Dc.fun=$c;Dc.string=Pc;Dc.Color=md;Dc.pt=ge;Dc.UserUI=le;Dc.resource=Qe;var Ic=function(dd){var Hd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),Ld=Hd.hasOwnProperty("WorldDashboard")&&"function"===typeof Hd.WorldDashboard?Hd.WorldDashboard:Hd.WorldDashboard=function(wc){wc&&wc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return kf(Ld,dd,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(wc){wc=void 0===wc?$world:wc;this.owner!=wc&&wc.addMorph(this);this.center=wc.visibleBounds().center()}},{key:"sortAndFilterPreviews",
value:function(wc){var rb=Dc.UserUI.getCurrentUser();wc=this.ui.searchField.fuzzyFilter(wc,function(Gb){return Gb._commit.name+Gb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return Dc.arr.sortBy(wc,function(Gb){return-Gb._commit.timestamp});case "TEMPLATES":return wc;case "MY PROJECTS":return Dc.arr.filter(wc,function(Gb){return Gb._commit.author.name===rb.name});case "PUBLISHED":return wc}}},{key:"updateList",value:function(){var wc=this;this.previews&&Dc.fun.debounceNamed("update world list",
150,function(){wc.ui.worldList.items=wc.sortAndFilterPreviews(wc.previews)})()}},{key:"displayWorlds",value:function(){var wc=this,rb,Gb,Oa,ab,Qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){switch(Ja.nextAddress){case 1:return wc.reset(),rb=wc.ui,Gb=rb.loadingLabel,Gb.animate({opacity:1,duration:300}),Ja.yield(wc.db.latestCommits("world"),2);case 2:return Oa=Ja.yieldResult,Ja.yield(Bb.import("./world preview-780e8a75.js"),4);case 4:if(!(ab=Ja.yieldResult)){Ja.jumpTo(5);break}return Ja.yield(Dc.resource("part://partial freezing/world preview"),
6);case 6:ab=Ja.yieldResult;case 5:return Ja.yield(ab.read(),3);case 3:return Qa=Ja.yieldResult,wc.previews=Oa.map(function(eb){var Rb=Dc.morph({reactsToPointer:!1,fill:Dc.Color.transparent,extent:Qa.extent});Rb._commit=eb;Rb.displayPreview=function(){var zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){if(1==sb.nextAddress)return zc=Qa.copy(),zc._commit=eb,zc.opacity=0,Rb.addMorph(zc),zc.displayPreview(),zc.position=Dc.pt(0,0),sb.yield(Rb.whenRendered(),2);Rb.layout=new Dc.HorizontalLayout({autoResize:!0,
reactToSubmorphAnimations:!0});sb.jumpToEnd()})};return Rb}),Ja.yield(Gb.animate({opacity:0,duration:300}),7);case 7:wc.updateList(),0==Oa.length&&(wc.ui.noWorldWarning.center=wc.innerBounds().center(),wc.ui.noWorldWarning.animate({visible:!0,duration:300})),Ja.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,
get:function(){return this.ui.closeButton.visible},set:function(wc){this.ui.closeButton.visible=wc}},db:{serialize:!1,get:function(){return Dc.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],
Hd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-127"}}},{start:330,end:3954})}(Dc.Morph);Ic=Dc.WorldDashboard;Dc.default=Ic;var Vb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");Vb.Morph=Kb;Vb.touchInputDevice=ke;Vb.TilingLayout=cc;Vb.arr=Wd;Vb.pt=ge;Ic=function(dd){var Hd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),
Ld=Hd.hasOwnProperty("GrowingWorldList")&&"function"===typeof Hd.GrowingWorldList?Hd.GrowingWorldList:Hd.GrowingWorldList=function(wc){wc&&wc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return kf(Ld,dd,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(wc){kf._get(Object.getPrototypeOf(Ld.prototype),"onScroll",this).call(this,wc);this.update()}},{key:"onChange",value:function(wc){kf._get(Object.getPrototypeOf(Ld.prototype),
"onChange",this).call(this,wc);"extent"==wc.prop&&this.update(!0)}},{key:"onHoverIn",value:function(wc){this.clipMode="auto"}},{key:"onHoverOut",value:function(wc){Vb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(wc){var rb=this.items;if(rb&&0!=rb.length){var Gb=this.scrollContainer,Oa=Gb.layout.spacing;Gb.extent=this.extent;var ab=this.ui,Qa=ab.bufferTop;ab=ab.bufferBottom;Qa=Qa||Gb.addMorph({fill:null,name:"buffer top",height:10});ab=ab||Gb.addMorph({fill:null,name:"buffer bottom",
height:10});Qa.width=ab.width=this.width-100;Gb.layout.disable();var Ja=rb[0];Oa=rb.slice(0,Math.floor(this.width/(Ja.width+Oa))*(Math.ceil((this.scroll.y+this.height)/(Ja.height+Oa))+1)).filter(function(sb){return sb.owner!=Gb});Ja=this.scroll.y+2*this.height;for(var eb={},Rb=$jscomp.makeIterator(Oa),zc=Rb.next();!zc.done;eb={$jscomp$loop$prop$item$2587:eb.$jscomp$loop$prop$item$2587},zc=Rb.next())eb.$jscomp$loop$prop$item$2587=zc.value,Ja++,eb.$jscomp$loop$prop$item$2587.top=Ja,Gb.addMorph(eb.$jscomp$loop$prop$item$2587),
eb.$jscomp$loop$prop$item$2587._initialized||eb.$jscomp$loop$prop$item$2587.whenRendered().then(function(sb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ab){sb.$jscomp$loop$prop$item$2587._initialized=!0;return Ab.yield(sb.$jscomp$loop$prop$item$2587.displayPreview(),0)})}}(eb));wc&&(Qa.position=Vb.pt(0,0),rb.forEach(function(sb,Ab){return sb.position=Vb.pt(Ab+1,Ab+1)}),ab.position=Vb.pt(rb.length+2,rb.length+2));Gb.layout.enable();if(wc||0<Oa.length)ab.top=this.submorphBounds().height,
Gb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Vb.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},
items:{after:["layout","scrollContainer"],set:function(wc){this.setProperty("items",wc);var rb=this.scrollContainer;rb.layout&&rb.layout.disable();var Gb=this.ui,Oa=Gb.bufferTop;Gb=Gb.bufferBottom;Vb.arr.withoutAll(rb.submorphs,[].concat($jscomp.arrayFromIterable(wc),[Oa,Gb])).forEach(function(ab){return ab.remove()});this.update(!0)}}}}}],Hd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Vb.Morph);Ic=Vb.GrowingWorldList;Vb.default=Ic;var Lc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");Lc.InputLine=Hc;Lc.Color=md;Lc.connect=Nd;Lc.disconnectAll=ec;Lc.disconnect=$d;Lc.arr=Wd;Lc.string=Pc;Ic=function(dd){var Hd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),Ld=Hd.hasOwnProperty("SearchInputLine")&&"function"===typeof Hd.SearchInputLine?Hd.SearchInputLine:Hd.SearchInputLine=
function(wc){wc&&wc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return kf(Ld,dd,[{key:"fuzzyMatch",value:function(wc,rb){rb=void 0===rb?this.parseInput():rb;if(rb.lowercasedTokens.every(function(Oa){return wc.toLowerCase().includes(Oa)}))return!0;var Gb=wc.toLowerCase();return 3>=Lc.arr.sum(rb.lowercasedTokens.map(function(Oa){return Lc.string.levenshtein(Gb,Oa)}))}},{key:"fuzzyFilter",value:function(wc,rb){var Gb=this;rb=void 0===
rb?function(ab){return ab}:rb;var Oa=this.parseInput();return Lc.arr.filter(wc,function(ab){return Gb.fuzzyMatch(rb(ab),Oa)})}},{key:"parseInput",value:function(){var wc=Array.from(this.textString).reduce(function(Gb,Oa){if("\\"===Oa&&!Gb.escaped)return Gb.escaped=!0,Gb;" "!==Oa||Gb.escaped?(Gb.spaceSeen=!1,Gb.current+=Oa):(!Gb.spaceSeen&&Gb.current&&(Gb.tokens.push(Gb.current),Gb.current=""),Gb.spaceSeen=!0);Gb.escaped=!1;return Gb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});wc.current&&wc.tokens.push(wc.current);
var rb=wc.tokens.map(function(Gb){return Gb.toLowerCase()});return{tokens:wc.tokens,lowercasedTokens:rb}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],Hd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(Lc.InputLine);Ic=Lc.SearchInputLine;
Lc.default=Ic}}});
System.register("./__root_module__-64e296ea.js kld-intersections ./user-ui-494b4ae6.js ./index-90fad7a9.js ./index-1222f918.js ./editor-plugin-c8470ec8.js ./index-9c46491a.js".split(" "),function(Ba,Ab){var Qb,dc,Xb,Xd,ad,Nd,dd,Lc;return{setters:[function(rd){Qb=rd.aj;dc=rd.ap;Xb=rd.a3;Xd=rd.C;ad=rd.a6;Nd=rd.L;dd=rd.r;Lc=rd.at},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var rd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");rd.Morph=
Qb;rd.Icon=dc;rd.pt=Xb;rd.Color=Xd;rd.arr=ad;rd.LoadingIndicator=Nd;rd.resource=dd;var Gd=function(ke){var Kd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),Hc=Kd.hasOwnProperty("LivelyTopBar")&&"function"===typeof Kd.LivelyTopBar?Kd.LivelyTopBar:Kd.LivelyTopBar=function(fb){fb&&fb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lc(Hc,ke,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode=
"Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var fb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){if(1==Db.nextAddress)return fb.isComponent?Db.return():Db.yield(fb.whenRendered(),2);document.body.style.background="black";fb.setEditMode("Halo");fb.getSubmorphNamed("fast load toggler").refresh();Db.jumpToEnd()})}},{key:"onUserChanged",value:function(fb){this.getSubmorphNamed("user flap").onUserChanged(fb)}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&
(this.width=this.world().visibleBounds().width,this.position=rd.pt(0,0));var fb=this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;fb.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var fb=this;return Object.entries(this.shapeToIcon).map(function(Db){Db=$jscomp.makeIterator(Db);var mc=Db.next().value,hc=Db.next().value;Db=hc.shortcut;hc=hc.args;return[[].concat($jscomp.arrayFromIterable(fb.currentShapeMode===mc?[].concat($jscomp.arrayFromIterable(rd.Icon.textAttribute("check",
{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(rd.Icon.textAttribute.apply(rd.Icon,$jscomp.arrayFromIterable(hc))),["   "+mc+" ",{float:"none"},"      "+Db,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){fb.currentShapeMode=mc;fb.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var fb=this;return Object.entries(this.sideBarToIcon).map(function(Db){Db=$jscomp.makeIterator(Db);var mc=Db.next().value;Db=Db.next().value.args;
return[[].concat($jscomp.arrayFromIterable(fb.activeSideBars.includes(mc)?[].concat($jscomp.arrayFromIterable(rd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(rd.Icon.textAttribute.apply(rd.Icon,$jscomp.arrayFromIterable(Db))),["   "+mc+" ",{float:"none"}]),function(){return fb.openSideBar(mc)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");
this.openSideBar("Styling Palette")}},{key:"onKeyUp",value:function(fb){"Hand"==this._currentEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(fb){Lc._get(Object.getPrototypeOf(Hc.prototype),"onKeyDown",this).call(this,fb);if(fb.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!fb.isAltDown()){var Db={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(fb.key){case "Escape":this.setEditMode("Halo");break;
case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=Db[fb.key];this.setEditMode("Shape");break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(fb){var Db=this,mc,hc,Tc,Ld,oc,pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){switch(Nb.nextAddress){case 1:Db.activeSideBars.includes(fb)?rd.arr.remove(Db.activeSideBars,fb):Db.activeSideBars.push(fb);if("Scene Graph"!=fb){Nb.jumpTo(2);break}if(Db.sideBar){Nb.jumpTo(3);break}mc=
rd.LoadingIndicator.open("loading side bar");return Nb.yield(mc.whenRendered(),4);case 4:return hc=Db,Nb.yield(Ab.import("./scene graph side bar master-47a02f69.js"),6);case 6:if(!(Tc=Nb.yieldResult)){Nb.jumpTo(7);break}return Nb.yield(rd.resource("part://SystemIDE/scene graph side bar master"),8);case 8:Tc=Nb.yieldResult;case 7:return Nb.yield(Tc.read(),5);case 5:return hc.sideBar=Nb.yieldResult,Db.sideBar.hasFixedPosition=!0,Db.sideBar.respondsToVisibleWindow=!0,Db.sideBar.openInWorld(),Db.sideBar.right=
0,Nb.yield(Db.sideBar.whenRendered(),9);case 9:mc.remove();case 3:Db.sideBar.toggle(Db.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=fb){Nb.jumpTo(0);break}if(Db.stylingPalette){Nb.jumpTo(11);break}Ld=rd.LoadingIndicator.open("loading side bar");return Nb.yield(Ld.whenRendered(),12);case 12:return oc=Db,Nb.yield(Ab.import("./styling side bar master-6b64ac9a.js"),14);case 14:if(!(pc=Nb.yieldResult)){Nb.jumpTo(15);break}return Nb.yield(rd.resource("part://SystemIDE/styling side bar master"),
16);case 16:pc=Nb.yieldResult;case 15:return Nb.yield(pc.read(),13);case 13:return oc.stylingPalette=Nb.yieldResult,Db.stylingPalette.collapseAll(),Db.stylingPalette.hasFixedPosition=!0,Db.stylingPalette.respondsToVisibleWindow=!0,Db.stylingPalette.openInWorld(),Db.stylingPalette.left=Db.world().right,Nb.yield(Db.stylingPalette.whenRendered(),17);case 17:Ld.remove();case 11:Db.stylingPalette.toggle(Db.activeSideBars.includes("Styling Palette")),Nb.jumpToEnd()}})}},{key:"onMouseDown",value:function(fb){var Db=
this.get("select shape type"),mc=this.get("shape mode button"),hc=this.get("side bar selector");fb.targetMorph==Db&&(this.world().openWorldMenu(fb,this.getShapeMenuItems()).position=mc.globalBounds().bottomLeft().subPt(this.world().scroll));fb.targetMorph==mc&&this.setEditMode("Shape");"text mode button"==fb.targetMorph.name&&this.setEditMode("Text");"hand mode button"==fb.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==fb.targetMorph.name&&this.setEditMode("Halo");"open component browser"==
fb.targetMorph.name&&this.interactivelyLoadComponent();"load world button"==fb.targetMorph.name&&this.world().execCommand("load world");fb.targetMorph==hc&&(this.world().openWorldMenu(fb,this.getSideBarMenuItems()).position=hc.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var fb=this,Db,mc,hc,Tc,Ld;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oc){if(1==oc.nextAddress)return Db=fb.get("open component browser"),mc=fb.get("user flap"),
hc=mc.haloShadow,Tc=mc.haloColor,Ld=rd.Color.rgb(102,102,102),Db.fontColor=Tc,Db.dropShadow=hc,oc.yield(fb.world().execCommand("browse and load component"),2);Db.dropShadow=!1;Db.fontColor=Ld;oc.jumpToEnd()})}},{key:"setEditMode",value:function(fb,Db){var mc=this;Db=void 0===Db?!1:Db;var hc=this.get("user flap"),Tc=hc.haloShadow,Ld=hc.haloColor,oc=rd.Color.rgb(102,102,102);Db||(this._currentEditMode=fb);Db=this.get("shape mode button");hc=this.get("text mode button");var pc=this.get("hand mode button"),
Nb=this.get("halo mode button");[["Shape",Db.submorphs],["Text",[hc]],["Hand",[pc]],["Halo",[Nb]]].forEach(function(Dc){var Vc=$jscomp.makeIterator(Dc);Dc=Vc.next().value;Vc=Vc.next().value;"Shape"==fb?mc.world().toggleShapeMode(!0,mc.currentShapeMode):"Text"==fb?mc.world().toggleShapeMode(!0,"Text"):mc.world().toggleShapeMode(!1);mc.world().showHaloPreviews("Halo"==fb);Dc==fb?Vc.forEach(function(Hd){Hd.dropShadow=Tc;Hd.fontColor=Ld}):Vc.forEach(function(Hd){Hd.dropShadow=null;Hd.fontColor=oc})})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],set:function(fb){this.setProperty("currentShapeMode",fb);this.get("shape status icon").textAndAttributes=rd.Icon.textAttribute(this.shapeToIcon[fb].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",{textStyleClasses:["fas"]}]}}}},
shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},
HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],Kd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-156"}}},{start:328,end:9508})}(rd.Morph);Gd=rd.LivelyTopBar;rd.default=Gd}}});
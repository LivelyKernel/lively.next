System.register(["./__root_module__-64e296ea.js","./index-1222f918.js","./color-picker-9739352b.js"],function(){var Ba,Ab,Qb,dc,Xb,Xd,ad,Nd,dd,Lc,rd,Gd,ke,Kd,Hc,fb,Db,mc,hc,Tc,Ld,oc,pc,Nb,Dc,Vc,Hd,Id;return{setters:[function(rb){Ba=rb.au;Ab=rb.s;Qb=rb.a7;dc=rb.aX;Xb=rb.a6;Xd=rb.a9;ad=rb.aa;Nd=rb.aC;dd=rb.al;Lc=rb.ao;rd=rb.aj;Gd=rb.ap;ke=rb.a3;Kd=rb.a1;Hc=rb.C;fb=rb.ar;Db=rb.av;mc=rb.bU;hc=rb.bu;Tc=rb.ac;Ld=rb.at;oc=rb.bj;pc=rb.bt;Nb=rb.br;Dc=rb.bW},function(rb){Vc=rb.N;Hd=rb.I},function(rb){Id=
rb.a}],execute:function(){var rb=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js");rb.fun=Ba;rb.string=Ab;rb.obj=Qb;rb.properties=dc;rb.arr=Xb;rb.Text=Xd;rb.config=ad;rb.HorizontalLayout=Nd;rb.VerticalLayout=dd;rb.morph=Lc;rb.Morph=rd;rb.Icon=Gd;rb.pt=ke;rb.Rectangle=Kd;rb.Color=Hc;rb.connect=fb;rb.once=Db;rb.noUpdate=mc;rb.ColorPicker=Id;rb.DropDownList=hc;rb.loadObjectFromPartsbinFolder=Tc;rb.cachedControls=new WeakMap;var Hb=function(eb){var ob=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js"),
wb=ob.hasOwnProperty("RichTextControl")&&"function"===typeof ob.RichTextControl?ob.RichTextControl:ob.RichTextControl=function(cb){cb&&cb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ld(wb,eb,[{key:"toggleButton",value:function(cb,Oa){cb.master=Oa?{auto:"styleguide://SystemIDE/selected button"}:{auto:"styleguide://System/dark button"}}},{key:"reset",value:function(){var cb=this.ui.fontSelection;cb.items=rb.RichTextControl.basicFontItems();
cb.selection=cb.items[0].value;rb.connect(this.target,"selectionChange",this,"update")}},{key:"alignAtTarget",value:function(cb){cb=void 0===cb?!!this.world():cb;var Oa=this.target,Gb=Oa.world()||$world,sc=this.globalBounds();Oa=(Oa.selection.isEmpty()?Oa.globalBounds():Oa.getGlobalTransform().transformRectToRect(Oa.selectionBounds().translatedBy(Oa.scroll.negated()))).bottomCenter().subPt(sc.topCenter());Gb=Gb.visibleBounds().translateForInclusion(sc.translatedBy(Oa)).topLeft().subPt(sc.topLeft());
Gb=this.position.addPt(Gb);cb?this.animate({duration:300,position:Gb}):this.position=Gb}},{key:"removeFocus",value:function(){this.autoRemove&&this.target&&(this.remove(),this.target=null)}},{key:"focusOn",value:function(cb,Oa){Oa=void 0===Oa?!0:Oa;var Gb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sc){if(1==sc.nextAddress)return Gb.target=cb,Gb.update(),sc.yield(Gb.whenRendered(),2);Gb.ui.fontSizeField.relayout();Oa&&Gb.alignAtTarget();sc.jumpToEnd()})}},{key:"setupConnections",
value:function(){rb.connect(this.ui.paddingField,"number",this,"setPadding");rb.connect(this.ui.paddingFieldTop,"number",this,"setPaddingTop");rb.connect(this.ui.paddingFieldBottom,"number",this,"setPaddingBottom");rb.connect(this.ui.paddingFieldLeft,"number",this,"setPaddingLeft");rb.connect(this.ui.paddingFieldRight,"number",this,"setPaddingRight")}},{key:"update",value:function(){var cb=this,Oa=this.target,Gb=this.updateSpec,sc=Oa.selection;sc=sc?sc.isEmpty()?Oa.textAttributeAt(sc.start):Oa.getStyleInRange(sc):
{};var vc=this.managedProps,fc=rb.obj.select(Oa,vc);Oa=$jscomp.makeIterator(Object.entries(rb.obj.select(sc||{},vc)));for(sc=Oa.next();!sc.done;sc=Oa.next())vc=$jscomp.makeIterator(sc.value),sc=vc.next().value,vc=vc.next().value,"undefined"!==typeof vc&&(fc[sc]=vc);rb.noUpdate(function(){for(var rc=$jscomp.makeIterator(Object.entries(cb.ui)),Q=rc.next();!Q.done;Q=rc.next()){var ha=$jscomp.makeIterator(Q.value);Q=ha.next().value;ha=ha.next().value;if(Gb[Q])Gb[Q](fc,ha)}})}},{key:"relayout",value:function(){}},
{key:"changeAttributeInSelectionOrMorph",value:function(cb,Oa){var Gb=this.target,sc=Gb.selection;Gb.isLabel||sc.isEmpty()?Gb[cb]="function"===typeof Oa?Oa(Gb[cb]):Oa:(Gb.undoManager.group(),Gb.changeStyleProperty(cb,function(vc){return"function"===typeof Oa?Oa(vc):Oa}),Gb.undoManager.group())}},{key:"changeFont",value:function(cb){var Oa=this,Gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sc){if(1==sc.nextAddress)return Oa._last=cb,(Gb="custom..."===cb)?sc.yield($world.prompt("Enter font family name",
{requester:Oa.target,historyId:"lively.morphic-rich-text-font-names",useLastInput:!0}),3):sc.jumpTo(2);if(2!=sc.nextAddress&&(cb=sc.yieldResult,!cb))return sc.return();Oa.changeAttributeInSelectionOrMorph("fontFamily",cb);sc.jumpToEnd()})}},{key:"setPadding",value:function(cb){this.target.padding=rb.Rectangle.inset(cb)}},{key:"setPaddingTop",value:function(cb){var Oa=this.target.padding;this.target.padding=rb.Rectangle.inset(Oa.left(),cb,Oa.right(),Oa.bottom())}},{key:"setPaddingLeft",value:function(cb){var Oa=
this.target.padding;this.target.padding=rb.Rectangle.inset(cb,Oa.top(),Oa.right(),Oa.bottom())}},{key:"setPaddingRight",value:function(cb){var Oa=this.target.padding;this.target.padding=rb.Rectangle.inset(Oa.left(),Oa.top(),cb,Oa.bottom())}},{key:"setPaddingBottom",value:function(cb){var Oa=this.target.padding;this.target.padding=rb.Rectangle.inset(Oa.left(),Oa.top(),Oa.right(),cb)}},{key:"setLineWrapping",value:function(cb){this.target.lineWrapping=cb}},{key:"changeFontWeight",value:function(cb){this.changeAttributeInSelectionOrMorph("fontWeight",
cb)}},{key:"changeTextAlign",value:function(cb){this.changeAttributeInSelectionOrMorph("textAlign",cb)}},{key:"changeFontColor",value:function(cb){this.changeAttributeInSelectionOrMorph("fontColor",cb)}},{key:"changeFontSize",value:function(cb){this.changeAttributeInSelectionOrMorph("fontSize",cb)}},{key:"changeFixedWidth",value:function(cb){this.target.fixedWidth=cb}},{key:"changeFixedHeight",value:function(cb){this.target.fixedHeight=cb}},{key:"changeLink",value:function(){var cb=this,Oa,Gb,sc,
vc,fc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rc){if(1==rc.nextAddress)return Oa=cb.target,Gb=Oa.selection,sc=Oa.getStyleInRange(Gb),vc=sc.link,rc.yield(cb.world().prompt("Set link",{input:vc||"https://"}),2);fc=rc.yieldResult;Oa.undoManager.group();Oa.setStyleInRange({link:fc||void 0},Gb);Oa.undoManager.group();cb.autoRemove&&cb.remove();rc.jumpToEnd()})}},{key:"toggleUnderline",value:function(){this.changeAttributeInSelectionOrMorph("textDecoration",function(cb){return"underline"===
cb?"none":"underline"})}},{key:"toggleItalic",value:function(){this.changeAttributeInSelectionOrMorph("fontStyle",function(cb){return"italic"===cb?"normal":"italic"})}},{key:"toggleBold",value:function(){this.changeAttributeInSelectionOrMorph("fontWeight",function(cb){return"bold"===cb||"700"===cb?"normal":"bold"})}},{key:"copyStyle",value:function(){var cb=this,Oa=this.target,Gb=this.ui.applyStyleButton;Oa=Oa.selection.isEmpty()?Oa.defaultTextStyle:Oa.getStyleInRange(Oa.selection);var sc=JSON.stringify(Oa,
null,2);this.constructor.copiedStyle=Oa;Gb.tooltip="paste style\n"+sc;this.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/plain",data:sc},{type:"application/morphic-text-style",styleString:sc}]).then(function(){return cb.setStatusMessage("Copied style\n"+sc)}).catch(function(vc){return cb.showError(vc)})}},{key:"pasteStyle",value:function(){var cb=this,Oa=this.target,Gb=this.constructor.copiedStyle;Oa.selection.isEmpty()?Object.assign(Oa,Gb):Oa.selections.forEach(function(sc){return Oa.addTextAttribute(cb.constructor.copiedStyle,
sc)});this.update()}},{key:"clearStyle",value:function(){var cb=this.target;cb.selections.forEach(function(Oa){return cb.resetStyleInRange(Oa)});this.update()}},{key:"configureRichTextOptions",value:function(){this.getSubmorphNamed("config panel")&&this.getSubmorphNamed("config panel").remove();var cb=this.defaultSpec,Oa=this.uiSpec;cb=this.addMorph({name:"config panel",layout:new rb.VerticalLayout({spacing:5}),epiMorph:!0,submorphs:[].concat($jscomp.arrayFromIterable(Object.keys(cb).map(function(Gb){var sc=
Oa.rows.some(function(vc){return vc.some(function(fc){return fc===Gb})});return{type:"labeledcheckbox",label:Gb,name:Gb,checked:sc}})),[{layout:new rb.HorizontalLayout({spacing:3}),submorphs:[{type:"button",name:"OK button",label:"OK"},{type:"button",name:"cancel button",label:"Cancel"}]}])});cb.center=this.innerBounds().center();rb.connect(cb.getSubmorphNamed("OK button"),"fire",this,"configureAccepted");rb.connect(cb.getSubmorphNamed("cancel button"),"fire",this,"configureCanceled")}},{key:"configureAccepted",
value:function(){var cb=this.getSubmorphNamed("config panel");cb&&(cb.remove(),cb.submorphs.filter(function(Oa){return"LabeledCheckBox"===Oa.constructor.name}))}},{key:"configureCanceled",value:function(){var cb=this.getSubmorphNamed("config panel");cb&&cb.remove()}},{key:"close",value:function(){var cb=this;this.target&&this.target.attributeConnections&&this.target.attributeConnections.forEach(function(Oa){return Oa.targetObj===cb&&Oa.disconnect()});this.remove()}},{key:"alwaysTargetFocusedMorph",
value:function(){this.startStepping(1500,"updateTarget")}},{key:"updateTarget",value:function(){var cb=this.world();cb&&(cb=cb.focusedMorph)&&(cb.isLabel||cb.isText)&&!this.isAncestorOf(cb)&&this.target!==cb&&this.focusOn(cb,!1)}},{key:"onMouseUp",value:function(cb){var Oa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gb){if(1==Gb.nextAddress)return Gb.yield(Oa.whenRendered(),2);Oa.update();Gb.jumpToEnd()})}},{key:"attachToWorld",value:function(){rb.connect($world,"onMouseDown",
this,"updateTarget",{garbageCollect:!0})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RichTextControl"}},{key:"properties",get:function(){return{autoRemove:{defaultValue:!1},target:{},toggleColor:{},managedProps:{readOnly:!0,get:function(){return"fontFamily fontWeight fontSize fontStyle isText fontColor textAlign link textDecoration fixedWidth fixedHeight lineWrapping padding".split(" ")}},updateSpec:{get:function(){var cb=this;return Object.assign({fontSelection:function(Oa,Gb){var sc=
Oa.fontFamily;(Oa=sc&&Gb.items.find(function(vc){return vc.value.toLowerCase()===sc.toLowerCase()}))?Gb.selection=Oa.value:sc&&(Gb.items=Gb.items.concat({isListItem:!0,label:[sc,{fontFamily:sc}],value:sc}),Gb.selection=rb.arr.last(Gb.items));Gb.fit();Gb.width=Math.max(Gb.width,170)},fontWeightSelection:function(Oa,Gb){Gb.selection="normal"==Oa.fontWeight?"Medium":Oa.fontWeight?rb.string.capitalize(Oa.fontWeight):"Medium"},boldButton:function(Oa,Gb){cb.toggleButton(Gb,"bold"===Oa.fontWeight)},italicButton:function(Oa,
Gb){cb.toggleButton(Gb,"italic"===Oa.fontStyle)},underlineButton:function(Oa,Gb){cb.toggleButton(Gb,"underline"===Oa.textDecoration)},linkButton:function(Oa,Gb){cb.toggleButton(Gb,!!Oa.link)},colorPicker:function(Oa,Gb){Gb.colorValue=Oa.fontColor},fontSizeField:function(Oa,Gb){Gb.number=Oa.fontSize},fixedWidthControl:function(Oa,Gb){Oa.isText?Gb.enable():Gb.disable();Gb.checked=Oa.fixedWidth},fixedHeightControl:function(Oa,Gb){Oa.isText?Gb.enable():Gb.disable();Gb.checked=Oa.fixedHeight},lineWrappingControl:function(Oa,
Gb){var sc=$jscomp.makeIterator(Gb.submorphs);Gb=sc.next().value;sc=sc.next().value;Gb.checked=!!Oa.lineWrapping;sc.deactivated=!Oa.lineWrapping;sc.deactivated?sc.opacity=.5:(sc.opacity=1,sc.selection=Oa.lineWrapping)},paddingControl:function(Oa,Gb){var sc=Oa.padding,vc=sc.left();Oa=sc.top();var fc=sc.right();sc=sc.bottom();var rc=!rb.arr.every([vc,Oa,fc,sc],function(Q){return Q==vc});Gb.get("multi value indicator").visible=rc;rb.connect(Gb.get("multi value indicator"),"onMouseDown",Gb.get("padding field"),
"number",{converter:"() => left",varMapping:{left:vc}});Gb.get("padding field").number=vc;Gb.get("padding field").visible=!rc;Gb.get("padding field top").number=Oa;Gb.get("padding field left").number=vc;Gb.get("padding field right").number=fc;Gb.get("padding field bottom").number=sc}},["left","center","right","block"].reduce(function(Oa,Gb){Oa[Gb+"Align"]=function(sc,vc){cb.toggleButton(vc,sc.textAlign==Gb)};return Oa},{}))}},ui:{get:function(){var cb=this,Oa={fontSelection:"font selection",fontWeightSelection:"font weight selection",
boldButton:"bold button",italicButton:"italic button",underlineButton:"underline button",linkButton:"link button",leftAlign:"left align",centerAlign:"center align",rightAlign:"right align",blockAlign:"block align",fontSizeField:"font size field",colorPicker:"color picker",copyStyleButton:"copy style",applyStyleButton:"apply style",removeStyleButton:"remove style",fixedHeightControl:"fixed height control",fixedWidthControl:"fixed width control",lineWrappingControl:"line wrapping control",paddingControl:"padding control",
paddingField:"padding field",paddingFieldTop:"padding field top",paddingFieldLeft:"padding field left",paddingFieldRight:"padding field right",paddingFieldBottom:"padding field bottom"};return rb.obj.extract(Oa,rb.obj.keys(Oa),function(Gb,sc){return cb.getSubmorphNamed(sc)})}}}}},{key:"openDebouncedFor",value:function(cb){var Oa=cb.selection;if(Oa.isEmpty()){var Gb=rb.cachedControls.get(cb);Gb&&(Gb.update(),Gb.alignAtTarget(),Gb.world()||cb.world().addMorph(Gb))}else rb.fun.debounceNamed(cb.id+"openRichTextControl",
600,function(){var sc=rb.cachedControls.get(cb);Oa.isEmpty()?sc&&sc.removeFocus():(sc&&sc.world()||(sc=new rb.RichTextControl,rb.cachedControls.set(cb,sc)),cb.world().addMorph(sc),sc.focusOn(cb,!0),sc.alwaysTargetFocusedMorph())})()}},{key:"openFor",value:function(cb){var Oa=rb.cachedControls.get(cb);Oa?Oa.update():(Oa=new rb.RichTextControl,rb.cachedControls.set(cb,Oa),Oa.focusOn(cb,!0),Oa.alwaysTargetFocusedMorph());Oa.alignAtTarget();Oa.world()||cb.world().addMorph(Oa);return Oa}}],ob,{pathInPackage:function(){return"text/ui.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:624,end:16944})}(rb.Morph);rb.RichTextControl=Hb;rb.RichTextControl=Hb;rb.RichTextControl=Hb;Hb=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js");Hb.SearchField=oc;var Mc=function(eb){var ob=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js"),wb=ob.hasOwnProperty("ProtoSearchField")&&
"function"===typeof ob.ProtoSearchField?ob.ProtoSearchField:ob.ProtoSearchField=function(cb){cb&&cb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ld(wb,eb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoSearchField"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],ob,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoSearchField",version:"0.1.1-0"}}},{start:76,end:221})}(Hb.SearchField);Mc=Hb.ProtoSearchField;Hb.default=Mc;var qb=lively.FreezerRuntime.recorderFor("ProtoTree/index.js");qb.Tree=pc;qb.TreeData=Nb;Hb=function(eb){var ob=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),wb=ob.hasOwnProperty("TestTreeData")&&"function"===typeof ob.TestTreeData?ob.TestTreeData:ob.TestTreeData=function(cb){cb&&
cb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ld(wb,eb,[{key:"display",value:function(cb){return cb.name}},{key:"isCollapsed",value:function(cb){return cb.isCollapsed}},{key:"collapse",value:function(cb,Oa){cb.isCollapsed=Oa}},{key:"getChildren",value:function(cb){return cb.isLeaf?null:cb.isCollapsed?[]:cb.children}},{key:"isLeaf",value:function(cb){return cb.isLeaf}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TestTreeData"}}],
ob,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:113,end:417})}(qb.TreeData);qb.TestTreeData=Hb;qb.TestTreeData=Hb;qb.TestTreeData=Hb;Hb=function(eb){var ob=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),wb=ob.hasOwnProperty("ProtoTree")&&"function"===typeof ob.ProtoTree?ob.ProtoTree:
ob.ProtoTree=function(cb){cb&&cb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ld(wb,eb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoTree"}},{key:"properties",get:function(){return{treeData:{initialize:function(){this.treeData=new qb.TestTreeData({name:"root",isCollapsed:!1,isLeaf:!1,children:[{name:"child 1",isLeaf:!0},{name:"child 2",isLeaf:!1,isCollapsed:!0,children:[{name:"child 2 - 1",isLeaf:!0}]},
{name:"child 3",isLeaf:!1,isCollapsed:!1,children:[{name:"child 3 - 1",isLeaf:!0},{name:"child 3 - 2",isLeaf:!0}]},{name:"child 4",isLeaf:!0}]})}},master:{initialize:function(){}}}}}],ob,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:434,end:1297})}(qb.Tree);Hb=qb.ProtoTree;qb.default=Hb;Hb=
lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js");Hb.NumberWidget=Vc;Mc=function(eb){var ob=lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js"),wb=ob.hasOwnProperty("ProtoNumberWidget")&&"function"===typeof ob.ProtoNumberWidget?ob.ProtoNumberWidget:ob.ProtoNumberWidget=function(cb){cb&&cb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ld(wb,eb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoNumberWidget"}},
{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],ob,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoNumberWidget",version:"0.1.1-0"}}},{start:76,end:224})}(Hb.NumberWidget);Mc=Hb.ProtoNumberWidget;Hb.default=Mc;Hb=lively.FreezerRuntime.recorderFor("FrameResizer/index.js");Hb.Morph=rd;Mc=function(eb){var ob=
lively.FreezerRuntime.recorderFor("FrameResizer/index.js"),wb=ob.hasOwnProperty("FrameResizer")&&"function"===typeof ob.FrameResizer?ob.FrameResizer:ob.FrameResizer=function(cb){cb&&cb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ld(wb,eb,[{key:"onDrag",value:function(cb){var Oa=this.owner.left;cb=cb.positionIn(this).x;cb*="left"==this.direction?-1:1;this.owner.width+=cb;350>this.owner.width&&(cb+=350-this.owner.width,this.owner.width=
350);this.owner.left="left"==this.direction?Oa-cb:Oa}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FrameResizer"}},{key:"properties",get:function(){return{direction:{type:"Enum",values:["left","right"]}}}}],ob,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"FrameResizer",version:"0.1.1-24"}}},{start:56,end:840})}(Hb.Morph);
Mc=Hb.FrameResizer;Hb.default=Mc;var tb=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js");tb.Morph=rd;tb.morph=Lc;tb.layouts=Dc;tb.string=Ab;tb.connect=fb;tb.noUpdate=mc;tb.InteractiveMorphSelector=Hd;tb.Color=Hc;tb.pt=ke;Hb=function(eb){var ob=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js"),wb=ob.hasOwnProperty("ShapeLayoutControl")&&"function"===typeof ob.ShapeLayoutControl?ob.ShapeLayoutControl:ob.ShapeLayoutControl=function(cb){cb&&cb[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ld(wb,eb,[{key:"focusOn",value:function(cb){this.target=cb;this.update(!1)}},{key:"setupConnections",value:function(){var cb=this.ui;tb.connect(cb.submorphSettingsControl,"fire",this,"chooseSubmorphToChangeLayoutSettings");tb.connect(cb.dragmeControl,"onDragStart",this,"onSubmorphSettingsDragStart");tb.connect(cb.xAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "x",\n        submorph: self.selectedSubmorph,\n      })',
varMapping:{self:this}});tb.connect(cb.yAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "y",\n        submorph: self.selectedSubmorph,\n      })',varMapping:{self:this}});for(var Oa={},Gb=$jscomp.makeIterator(this.managedProps),sc=Gb.next();!sc.done;Oa={$jscomp$loop$prop$prop$2425:Oa.$jscomp$loop$prop$prop$2425},sc=Gb.next()){var vc=$jscomp.makeIterator(sc.value),fc=vc.next().value;sc=vc.next().value;vc.next().value||
(Oa.$jscomp$loop$prop$prop$2425=this.join(fc),vc=cb[this.join(fc,"control")],tb.connect(vc,sc,this,"updateLayout",{updater:function(rc){return function(Q,ha){Q(rc.$jscomp$loop$prop$prop$2425,ha)}}(Oa),varMapping:{prop:Oa.$jscomp$loop$prop$prop$2425}}))}}},{key:"lower",value:function(cb){return cb.charAt(0).toLowerCase()+cb.slice(1)}},{key:"join",value:function(cb,Oa){return this.lower(tb.string.camelCaseString(cb+(Oa?" "+Oa:"")))}},{key:"updateLayoutOfTarget",value:function(cb){cb=tb.layouts[tb.string.camelCaseString(cb)];
this.target.layout=cb?new cb({autoResize:!1}):null;this.update()}},{key:"updateLayout",value:function(cb,Oa){this.target.layout[cb]=Oa}},{key:"update",value:function(cb){var Oa=this;this.target&&tb.noUpdate(function(){for(var Gb=Oa.ui,sc=Oa.target.layout||{name:function(){return"No"}},vc=$jscomp.makeIterator(Oa.managedProps),fc=vc.next();!fc.done;fc=vc.next()){var rc=$jscomp.makeIterator(fc.value);fc=rc.next().value;var Q=rc.next().value;rc.next();rc=Gb[Oa.join(fc,"control")];var ha=Gb[Oa.join(fc,
"label")];if(Q)if("type"===fc)rc.selection=sc.name()+" Layout";else{var Ga=sc[Oa.join(fc)],La="undefined"!==typeof Ga;if(La){switch(fc){case "align":rc.items=sc.possibleAlignValues;break;case "direction":rc.items=sc.possibleDirectionValues;break;case "axis":rc.items=sc.possibleAxisValues}rc[Q]=Ga}ha.isLayoutable=ha.visible=La}}Oa.showGridLayoutControl("Grid"===sc.name());Oa.showProportionalControl("Proportional"===sc.name())})}},{key:"updateSubmorphProportionalLayoutSettings",value:function(cb){var Oa=
{};this.target.layout.changeSettingsFor(cb.submorph,(Oa[cb.axis]=cb.policy,Oa),!0)}},{key:"onSubmorphSettingsDragStart",value:function(cb){var Oa=this;cb.stop();var Gb=this.target.layout,sc=Gb.settingsFor(this.selectedSubmorph),vc=[],fc;for(fc in sc)vc=[].concat($jscomp.arrayFromIterable(vc),[fc+": ",{fontWeight:"bold"},sc[fc]+" ",{}]);var rc=tb.morph({type:"label",fontColor:tb.Color.white,value:vc,fill:tb.Color.black.withA(.7),padding:5,borderRadius:10,isLayoutable:!1});rc.wantsToBeDroppedOn=function(Q){return Gb.layoutableSubmorphs.includes(Q)};
rc.onBeingDroppedOn=function(Q,ha){rc.remove();if(Q=Gb.layoutableSubmorphs.includes(ha)?ha:cb.world.morphsContainingPoint(cb.hand.position).find(function(Ga){return Gb.layoutableSubmorphs.includes(Ga)}))Oa.updateSubmorphProportionalLayoutSettings({policy:sc.x,axis:"x",submorph:Q}),Oa.updateSubmorphProportionalLayoutSettings({policy:sc.y,axis:"y",submorph:Q}),Q.show(),$world.setStatusMessage("layout settings applied")};cb.hand.grab(rc);rc.moveBy(tb.pt(10,10))}},{key:"chooseSubmorphToChangeLayoutSettings",
value:function(){var cb=this,Oa,Gb,sc,vc,fc,rc,Q,ha,Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){switch(La.nextAddress){case 1:return Oa=cb.target.layout.layoutableSubmorphs,cb.manageFocus=!0,cb.env.eventDispatcher.isKeyPressed("Shift")?(sc=Oa.map(function(Yb){return{isListItem:!0,string:String(Yb),value:Yb}}),La.yield($world.listPrompt("Select morph",sc,{onSelection:function(Yb){return Yb.show()}}),5)):La.yield(tb.InteractiveMorphSelector.selectMorph(cb.world(),cb,function(Yb){return Oa.includes(Yb)}),
4);case 4:Gb=La.yieldResult;La.jumpTo(3);break;case 5:vc=La.yieldResult,fc=$jscomp.makeIterator(vc.selected),Gb=fc.next().value;case 3:cb.manageFocus=!1;cb.selectedSubmorph=Gb;if(!Gb)return La.return();rc=cb.ui;Q=rc.xAxisPolicyControl;ha=rc.yAxisPolicyControl;Ga=cb.target.layout.settingsFor(Gb);tb.noUpdate(function(){Q.selection=Ga.x;ha.selection=Ga.y});La.jumpToEnd()}})}},{key:"showProportionalControl",value:function(cb){var Oa=this.ui;[Oa.submorphSettingsControl,Oa.dragmeControl,Oa.xAxisPolicyControl,
Oa.xAxisPolicyLabel,Oa.yAxisPolicyControl,Oa.yAxisPolicyLabel].forEach(function(Gb){Gb.isLayoutable=cb;Gb.visible=cb})}},{key:"showGridLayoutHalo",value:function(){$world.showLayoutHaloFor(this.target)}},{key:"showGridLayoutControl",value:function(cb){var Oa=this.ui.configureGridLayoutControl;Oa.visible=Oa.isLayoutable=cb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShapeLayoutControl"}},{key:"properties",get:function(){return{managedProps:{get:function(){return[["type","selection",
!0],["align","selection"],["direction","selection"],["axis","selection"],["spacing","number"],["auto resize","checked"],["resize submorphs","checked"],["x axis policy","selection",!0],["y axis policy","selection",!0],["react to submorph animations","checked"],["submorph settings",!1,!0],["order by index","checked"],["dragme",!1,!0],["configure grid layout",!1,!0]]}},ui:{readOnly:!0,get:function(){for(var cb={labelContainer:this.getSubmorphNamed("label container"),controlContainer:this.getSubmorphNamed("control container")},
Oa=$jscomp.makeIterator(this.managedProps),Gb=Oa.next();!Gb.done;Gb=Oa.next()){var sc=$jscomp.makeIterator(Gb.value).next().value;Gb=sc+" label";sc+=" control";cb[this.join(Gb)]=this.getSubmorphNamed(Gb);cb[this.join(sc)]=this.getSubmorphNamed(sc)}return cb}}}}}],ob,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ShapeLayoutControl",
version:"0.1.1-166"}}},{start:345,end:7771})}(tb.Morph);Hb=tb.ShapeLayoutControl;tb.default=Hb}}});
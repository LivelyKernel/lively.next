System.register(["./__root_module__-5a58cfed.js","./index-ce89c89c.js","./index-dcbaecb9.js"],function(Ca){var Cb,Vb,lc,gc,fe,fd,Zd,id,Uc,Ad,Nd,ee,Ud,kd,cb,Fb,vc,pc,sd,pd,tc,bd,Xb,Tb,Oc,td,Ob,sb,hb,qb,Aa,bb,wb,Hb,Qb,lb,mb,Rb,Gc,mc,Pc,Xc,Q,fa,Ia;return{setters:[function(Qa){Cb=Qa.C;Vb=Qa.aq;lc=Qa.a4;gc=Qa.$;fe=Qa.a1;fd=Qa.al;Zd=Qa.bf;id=Qa.aT;Uc=Qa.ao;Ad=Qa.s;Nd=Qa.aN;ee=Qa.bm;Ud=Qa.bn;kd=Qa.a5;cb=Qa.as;Fb=Qa.an;vc=Qa.ap;pc=Qa.bo;sd=Qa.bp;pd=Qa.a0;tc=Qa.P;bd=Qa._;Xb=Qa.aV;Tb=Qa.ag;Oc=Qa.ah;td=
Qa.ai;Ob=Qa.aj;sb=Qa.az;hb=Qa.aY;qb=Qa.av;Aa=Qa.am;bb=Qa.a8;wb=Qa.bq;Hb=Qa.L;Qb=Qa.br;lb=Qa.b1;mb=Qa.bg;Rb=Qa.b0;Gc=Qa.bs;mc=Qa.ar},function(Qa){Pc=Qa.M;Xc=Qa.I;Q=Qa.v;fa=Qa.p},function(Qa){Ia=Qa.localInterface}],execute:function(){function Qa(Ka,$a){if(!0===$a)return $a;if(Ka.copyState)return Ka.copyState($a);Ka={};for(var Kb in $a){var ba=$a[Kb];ba instanceof Array&&(ba=ba.concat([]));Ka[Kb]=ba}return Ka}function ec(Ka,$a,Kb){return Ka.startState?Ka.startState($a,Kb):!0}function Nb(Ka,$a){return P.modes[Ka]=
$a}function Za(Ka){if("string"==typeof Ka&&P.mimeModes.hasOwnProperty(Ka))Ka=P.mimeModes[Ka];else if(Ka&&"string"==typeof Ka.name&&P.mimeModes.hasOwnProperty(Ka.name)){var $a=P.mimeModes[Ka.name];"string"==typeof $a&&($a={name:$a});Ka=Object.assign({},$a,Ka);Ka.name=$a.name}else{if("string"==typeof Ka&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ka))return Za("application/xml");if("string"==typeof Ka&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ka))return Za("application/json")}return"string"==typeof Ka?{name:Ka}:Ka||{name:"null"}}
function jc(Ka,$a){$a=P.resolveMode($a);"string"===typeof $a&&($a={name:$a});if(!$a.name)throw Error("parserConfig does not have a name of the mode to get");var Kb=P.modes[$a.name];if(!Kb)return jc(Ka,"text/plain");Ka=Object.assign({indentUnit:2},Ka);return Object.assign(Kb(Ka,$a),{name:$a.name})}function ld(Ka,$a){for(var Kb;Ka.innerMode;){Kb=Ka.innerMode($a);if(!Kb||Kb.mode==Ka)break;$a=Kb.state;Ka=Kb.mode}return Kb||{mode:Ka,state:$a}}function xd(Ka,$a){P.mimeModes[Ka]=$a}function Yc(Ka,$a,Kb){}
function Ua(Ka,$a,Kb,ba,Ja,ob,zb){var Nc=Ka.editorPlugin._tokenizerValidBefore;Nc&&Nc.row>=Kb&&(Nc.row=Kb-1);var yc=P.linesToTokenize(Ka.document,Kb,ba,Nc);Nc=yc.lines;yc=yc.state;if(!Nc.length)return!1;yc=yc?P.copyState($a,yc):P.startState($a);for(var Dd=0;Dd<Nc.length;Dd++){var zd=Nc[Dd],Bd=zd.row;Bd>=Kb&&Bd<=ba&&P.indentLine(Ka,$a,zd,yc,Ja,ob,zb);yc=P.tokenizeLine($a,Nc[Dd],yc,function(){})}return!0}function Mc(Ka,$a,Kb,ba,Ja,ob,zb){$a=P.linesToTokenize($a,Kb,ba,Ja);Kb=$a.lines;P.tokenizeLines(Ka,
Kb,$a.state,ob,zb);return Kb}function pb(Ka,$a,Kb,ba,Ja){var ob=[],zb,Nc=function(zd){return ob.push(zb=[])},yc=function(zd,Bd,Ie,Jg,wg,Qh,Vf){return zb.push(Ie,Jg,zd,wg.current(),Bd.localMode||Vf)};try{var Dd=P.visitDocumentTokens(Ka,$a,Kb,ba,Ja,Nc,yc)}catch(zd){ob.length=0,Dd=P.visitDocumentTokens(Ka,$a,Kb,ba,null,Nc,yc)}return{tokens:ob,lines:Dd}}function fb(Ka,$a,Kb,ba,Ja){null==$a&&($a=Ka.search(/[^\s\u00a0]/),-1==$a&&($a=Ka.length));ba=ba||0;for(Ja=Ja||0;;){var ob=Ka.indexOf("\t",ba);if(0>ob||
ob>=$a)return Ja+($a-ba);Ja+=ob-ba;Ja+=Kb-Ja%Kb;ba=ob+1}}function eb(Ka){Ka=Ka.toLowerCase();for(var $a=0;$a<P.modeInfo.length;$a++){var Kb=P.modeInfo[$a];if(Kb.mime==Ka)return Kb;if(Kb.mimes)for(var ba=0;ba<Kb.mimes.length;ba++)if(Kb.mimes[ba]==Ka)return Kb}if(/\+xml$/.test(Ka))return eb("application/xml");if(/\+json$/.test(Ka))return eb("application/json")}function bc(Ka){for(var $a=0;$a<P.modeInfo.length;$a++){var Kb=P.modeInfo[$a];if(Kb.ext)for(var ba=0;ba<Kb.ext.length;ba++)if(Kb.ext[ba]==Ka)return Kb}}
function ac(Ka){for(var $a=0;$a<P.modeInfo.length;$a++){var Kb=P.modeInfo[$a];if(Kb.file&&Kb.file.test(Ka))return Kb}$a=Ka.lastIndexOf(".");if(Ka=-1<$a&&Ka.substring($a+1,Ka.length))return P.findModeByExtension(Ka)}function Ed(Ka){Ka=Ka.toLowerCase();for(var $a=0;$a<P.modeInfo.length;$a++){var Kb=P.modeInfo[$a];if(Kb.name.toLowerCase()==Ka)return Kb;if(Kb.alias)for(var ba=0;ba<Kb.alias.length;ba++)if(Kb.alias[ba].toLowerCase()==Ka)return Kb}}function we(Ka){if(!Ka)return String(Ka);if(Array.isArray(Ka))return"["+
Ka.map(we).join(",")+"]";if("symbol"===typeof Ka)return Qd.printSymbol(Ka);try{return String(Ka)}catch($a){return"Cannot print object: "+$a}}function Je(Ka,$a){return!Qd.arr.every($a.map(function(Kb){return Ka[Kb]}),function(Kb){return Qd.obj.equals(Kb,Ka&&Ka.valueOf())})}function Lf(Ka){if(Qd.obj.isPrimitive(Ka))var $a=Qd.string.print(Ka);else Array.isArray(Ka)?(($a=3<Ka.length)&&(Ka=Ka.slice(0,3)),Ka=Qd.string.print(Ka),$a&&(Ka=Ka.slice(0,-1)+", ...]"),$a=Ka):$a=Qd.string.print(Ka);$a=$a.replace(/\n/g,
"");500<$a.length&&($a=$a.slice(0,20)+("...["+($a.length-20)+' CHARS]"'));return $a}function ud(Ka){return Vc.Inspector.openInWindow({targetObject:Ka})}function Fe(Ka,$a){return Vc.Inspector.openInWindow({remoteTarget:{code:Ka,evalEnvironment:$a}})}function Pd(Ka,$a){function Kb(Nc){var yc=Nc.name,Dd=Nc.ownerChain(),zd=Nc.owner,Bd=Nc.world(),Ie;Nc===ob&&(Ie=[zb]);Bd===Nc&&(Ie=["$world"]);if(!Ie&&yc&&zd){zd===Bd&&1===Vc.arr.count(Vc.arr.pluck(Bd.submorphs,"name"),yc)&&(Ie=['$world.get("'+yc+'")']);
if(!Ie&&zd!=Bd)for(Bd=Dd.length-1;Bd--;)if(1===Dd[Bd].getAllNamed(yc).length){Ie=[].concat($jscomp.arrayFromIterable(Kb(Dd[Bd])),['get("'+yc+'")']);break}Ie||(yc=[].concat($jscomp.arrayFromIterable(Kb(zd)),['get("'+yc+'")']),Vc.syncEval(yc.join("."),{context:ob}).value===Nc&&(Ie=yc))}Ie||(Ie=[zb+'.getMorphById("'+Nc.id+'")']);return Ie}$a=void 0===$a?{}:$a;var ba=Ka.world(),Ja=$a;$a=void 0===Ja.maxLength?10:Ja.maxLength;var ob=void 0===Ja.fromMorph?ba:Ja.fromMorph;if(ob===Ka)return"this";var zb=ba===
ob?"$world":"this";if(!(ba||Ka.name&&ob.get(Ka.name)===Ka))return"morph";ba=Kb(Ka);return ba.length>$a?'$world.getMorphWithId("'+Ka.id+'")':ba.join(".")}function Sb(Ka,$a,Kb){var ba=($a=void 0===$a?"":$a)&&mf.arr.last($a.split(".")).toLowerCase(),Ja="",ob=0,zb=Math.pow(2,19);if("string"===typeof Ka){if(Ka.length>zb)return null}else if(Ka.document.stringSize>zb)return null;if("string"===typeof Ka)Ja=Ka.slice(0,1E3);else for(Ka=$jscomp.makeIterator(Ka.document.lines),zb=Ka.next();!zb.done;zb=Ka.next()){var Nc=
zb.value;zb=Nc.stringSize;Nc=Nc.text;var yc=!0;1E3<ob+zb&&(yc=!1,zb=1E3-ob);Ja+=Nc.slice(0,zb)+(yc?"\n":"");ob+=zb;if(1E3<=ob)break}ob=$jscomp.makeIterator(mf.modeInfo);for(Ka=ob.next();!Ka.done;Ka=ob.next()){yc=Ka.value;zb=yc.contentTest;Ka=yc.mode;Nc=yc.ext;yc=yc.file;if("function"===typeof zb)try{if(zb(Ja))return Ka}catch(Dd){}if(yc&&yc instanceof RegExp&&yc.test($a))return Ka;if(Nc)for(zb=$jscomp.makeIterator(Nc),Nc=zb.next();!Nc.done;Nc=zb.next())if(Nc.value===ba)return Ka}return Kb}Ca({a:xd,
d:Nb,r:Yc});var oa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");oa.Color=Cb;var Ha=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Kb=$a.hasOwnProperty("DefaultTheme")&&"function"===typeof $a.DefaultTheme?$a.DefaultTheme:$a.DefaultTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:"background",get:function(){return oa.Color.white}},
{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:oa.Color.white,fontWeight:"bold",backgroundColor:oa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:oa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:oa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:"className",get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],$a,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:42,end:2867})}(void 0),Mb=Ha=oa.DefaultTheme;oa.default=Ha;var P=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");P.copyState=Qa;P.startState=ec;P.defineMode=Nb;P.resolveMode=Za;P.getMode=jc;P.innerMode=ld;P.defineMIME=xd;P.registerHelper=Yc;P.indentLines=Ua;P.indentLine=function(Ka,$a,Kb,ba,Ja,ob,zb){zb=Object.assign({indentWithTabs:!Ka.useSoftTabs,indentUnit:Ka.tabWidth,tabSize:4,ignoreFollowingText:!1},zb);null==Ja&&(Ja="add");"smart"==Ja&&($a.indent||(Ja=
"prev"));var Nc=zb.tabSize,yc=Kb.text,Dd=P.countColumn(yc,null,Nc);Kb.modeState&&(Kb.modeState=null);var zd=yc.match(/^\s*/)[0];if(!ob&&!/\S/.test(yc)){var Bd=0;Ja="not"}else if("smart"==Ja&&(Bd=$a.indent(ba,zb.ignoreFollowingText?"":yc.slice(zd.length),yc),Bd==P.passIndent||150<Bd)){if(!ob)return;Ja="prev"}"prev"==Ja?Bd=0<Kb.row?P.countColumn(Kb.prevLine().text,null,Nc):0:"add"==Ja?Bd=Dd+zb.indentUnit:"subtract"==Ja?Bd=Dd-zb.indentUnit:"number"==typeof Ja&&(Bd=Dd+Ja);Bd=Math.max(0,Bd);$a="";ba=0;
if(zb.indentWithTabs)for(zb=Math.floor(Bd/Nc);zb;--zb)ba+=Nc,$a+="\t";ba<Bd&&($a+=" ".repeat(Bd-ba));if($a!=zd)return Ka.replace({start:{row:Kb.row,column:0},end:{row:Kb.row,column:zd.length}},$a),!0};P.tokenizeLines=function(Ka,$a,Kb,ba,Ja){if($a.length){Kb=Kb?P.copyState(Ka,Kb):P.startState(Ka);for(var ob=0;ob<$a.length;ob++){var zb=$a[ob];ba(zb);Kb=P.tokenizeLine(Ka,zb,Kb,Ja)}}};P.tokenizeLine=function(Ka,$a,Kb,ba){var Ja=$a.text;if(!Ja)return Kb;var ob=new P.StringStream(Ja,2);Kb=$a.modeState=
"function"===typeof Ka.copyState?Ka.copyState(Kb):P.copyState(Ka,Kb);$a.prevLine();for(Kb._string=Ja;!ob.eol();)Ja=Ka.token(ob,Kb),ba(Ja,Kb,ob.start,ob.pos,ob,$a,Ka),ob.start=ob.pos;return Kb};P.printTokens=function(Ka){for(var $a="",Kb=0;Kb<Ka.length;Kb+=5)$a+=Ka[Kb+0]+" => "+Ka[Kb+1]+" "+Ka[Kb+2]+" "+Ka[Kb+3]+" "+Ka[Kb+4].name+"\n";return $a};P.visitDocumentTokens=Mc;P.tokenizeDocument=pb;P.linesToTokenize=function(Ka,$a,Kb,ba){if(ba&&ba.row>=Kb)return{lines:[],state:null};$a=ba?Math.max(0,ba.row-
1):$a;var Ja=Ka.getLine($a),ob=Ja.text;Ka=[Ja];ba=null;for(var zb=0,Nc;(Nc=Ja.prevLine())&&50>zb++;){Ja=Nc;if(Ja.modeState){ba=Ja.modeState;break}Ka.unshift(Ja)}if(!ba){for(var yc=Ja,Dd=Infinity;(Nc=Ja.prevLine())&&100>zb++;){Ja=Nc;if(Ja.modeState){ba=Ja.modeState;break}Ka.unshift(Ja);Nc=ob.match(/^\s*/)[0].length;if(0===Nc)break;Nc<Dd&&(Dd=Nc,yc=Ja)}!ba&&0<Dd&&(Ka=Ka.slice(Ka.indexOf(yc)))}if(Kb>$a)for(Ja=P.arr.last(Ka);$a<=Kb;$a++){Ja=Ja.nextLine();if(!Ja)break;Ka.push(Ja)}return{lines:Ka,state:ba}};
P.countColumn=fb;P.findModeByMIME=eb;P.findModeByExtension=bc;P.findModeByFileName=ac;P.findModeByName=Ed;P.arr=lc;Ha=P.modes||{};P.modes=Ha;P.modes=Ha;P.modes=Ha;Ha=Ca("p",{});P.passIndent=Ha;P.passIndent=Ha;P.passIndent=Ha;P.copyState=Qa;P.copyState=Qa;P.startState=ec;P.startState=ec;P.defineMode=Nb;P.defineMode=Nb;P.resolveMode=Za;P.resolveMode=Za;P.getMode=jc;P.getMode=jc;P.innerMode=ld;P.innerMode=ld;Ha={};P.mimeModes=Ha;P.mimeModes=Ha;P.mimeModes=Ha;P.defineMIME=xd;P.defineMIME=xd;P.registerHelper=
Yc;P.registerHelper=Yc;P.indentLines=Ua;P.indentLines=Ua;P.visitDocumentTokens=Mc;P.visitDocumentTokens=Mc;P.tokenizeDocument=pb;P.tokenizeDocument=pb;P.countColumn=fb;P.countColumn=fb;(function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Kb=$a.hasOwnProperty("StringStream")&&"function"===typeof $a.StringStream?$a.StringStream:$a.StringStream=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Vb(Kb,Ka,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,Ja){this.reset(ba,Ja)}},{key:"reset",value:function(ba,Ja){this.pos=this.start=0;this.string=void 0===ba?"":ba;this.tabSize=void 0===Ja?2:Ja;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<
this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(ba){var Ja=this.string.charAt(this.pos);if("string"==typeof ba?Ja==ba:Ja&&(ba.test?ba.test(Ja):ba(Ja)))return++this.pos,Ja}},{key:"eatWhile",value:function(ba){for(var Ja=this.pos;this.eat(ba););return this.pos>Ja}},{key:"eatSpace",value:function(){for(var ba=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>ba}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",
value:function(ba){ba=this.string.indexOf(ba,this.pos);if(-1<ba)return this.pos=ba,!0}},{key:"backUp",value:function(ba){this.pos-=ba}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=P.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return P.countColumn(this.string,
null,this.tabSize)-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(ba,Ja,ob){if("string"==typeof ba){var zb=function(yc){return ob?yc.toLowerCase():yc},Nc=this.string.substr(this.pos,ba.length);if(zb(Nc)==zb(ba))return!1!==Ja&&(this.pos+=ba.length),!0}else{if((ba=this.string.slice(this.pos).match(ba))&&0<ba.index)return null;ba&&!1!==Ja&&(this.pos+=ba[0].length);return ba}}},{key:"current",value:function(){return this.string.slice(this.start,
this.pos)}},{key:"hideFirstChars",value:function(ba,Ja){this.lineStart+=ba;try{return Ja()}finally{this.lineStart-=ba}}}],[{key:"className",get:function(){return"StringStream"}}],$a,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);Ha=[{name:"APL",mime:"text/apl",
mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),
alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",
mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",
mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ka){return Ka.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",
mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",
mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",
mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",
mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",
mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},
{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",
mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",
mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p",
"pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",
ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},
{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",
mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Ka){return Ka.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},
{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},
{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",
mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",
mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",
ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml",
"text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];P.modeInfo=Ha;P.modeInfo=Ha;P.modeInfo=Ha;for(var ta=0;ta<P.modeInfo.length;ta++)P.info=P.modeInfo[ta],P.info.mimes&&(P.info.mime=P.info.mimes[0]);P.defineMode("null",function(){return{token:function(Ka){return Ka.skipToEnd()}}});
P.defineMIME("text/plain","null");P.findModeByMIME=eb;P.findModeByMIME=eb;P.findModeByExtension=bc;P.findModeByExtension=bc;P.findModeByFileName=ac;P.findModeByFileName=ac;P.findModeByName=Ed;P.findModeByName=Ed;var Pa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Pa.Color=Cb;Pa.Rectangle=gc;Pa.pt=fe;Pa.morph=fd;Pa.ShadowObject=Zd;Pa.StyleSheet=id;Pa.connect=Uc;Pa.arr=lc;Pa.string=Ad;Pa.FilterableList=Nd;Pa.Range=ee;ta=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
Kb=$a.hasOwnProperty("Completer")&&"function"===typeof $a.Completer?$a.Completer:$a.Completer=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:"compute",value:function(){return[]}}],[{key:"className",get:function(){return"Completer"}}],$a,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:345,end:391})}(void 0);Pa.Completer=ta;Pa.Completer=ta;Pa.Completer=ta;ta=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Kb=$a.hasOwnProperty("WordCompleter")&&"function"===typeof $a.WordCompleter?$a.WordCompleter:$a.WordCompleter=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:"compute",
value:function(ba,Ja){var ob=[],zb=[],Nc=ba.document.lineStrings;ba=ba.cursorPosition.row;for(var yc=ba-1;0<=yc;yc--)for(var Dd=$jscomp.makeIterator(Nc[yc].split(/[^0-9a-z@_]+/i)),zd=Dd.next();!zd.done;zd=Dd.next())(zd=zd.value)&&!ob.includes(zd)&&zd!==Ja&&(ob.push(zd),zb.push({priority:1E3-(ba-yc),completion:zd}));for(yc=ba+1;yc<Nc.length;yc++)for(Dd=$jscomp.makeIterator(Nc[yc].split(/[^0-9a-z_@]+/i)),zd=Dd.next();!zd.done;zd=Dd.next())(zd=zd.value)&&!ob.includes(zd)&&zd!==Ja&&(ob.push(zd),zb.push({priority:1E3-
(yc-ba),completion:zd}));return zb}}],[{key:"className",get:function(){return"WordCompleter"}}],$a,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:400,end:1228})}(void 0);Pa.WordCompleter=ta;Pa.WordCompleter=ta;Pa.WordCompleter=ta;ta=[new Pa.WordCompleter];Pa.defaultCompleters=ta;Pa.defaultCompleters=
ta;Pa.defaultCompleters=ta;ta=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Kb=$a.hasOwnProperty("CompletionController")&&"function"===typeof $a.CompletionController?$a.CompletionController:$a.CompletionController=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,Ja){Ja=void 0===Ja?[]:Ja;this.textMorph=
ba;this.completers=Ja=ba.pluginCollect("getCompleters",Ja)}},{key:"computeCompletions",value:function(ba){var Ja=this,ob,zb,Nc,yc,Dd,zd,Bd,Ie,Jg,wg,Qh,Vf,Hh,ek,Zh,ml;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hf){switch(Hf.nextAddress){case 1:ob=[],zb=$jscomp.makeIterator(Ja.completers),Nc=zb.next();case 2:if(Nc.done){Hf.jumpTo(4);break}yc=Nc.value;Hf.setCatchFinallyBlocks(5);Dd=ob;zd=Dd.concat;return Hf.yield(yc.compute(Ja.textMorph,ba),7);case 7:ob=zd.call(Dd,Hf.yieldResult);Hf.leaveTryBlock(3);
break;case 5:Bd=Hf.enterCatchBlock(),console.warn("Error in completer "+yc+": "+(Bd.stack||Bd));case 3:Nc=zb.next();Hf.jumpTo(2);break;case 4:Ie=new Map;ob.forEach(function(Gj){var bj=Ie.get(Gj.completion);bj||(bj=[],Ie.set(Gj.completion,bj));bj.push(Gj)});Jg=[];wg=$jscomp.makeIterator(Ie.values());for(Qh=wg.next();!Qh.done;Qh=wg.next())Vf=Qh.value,Jg.push(Pa.arr.last(Pa.arr.sortByKey(Vf,"priority")));Hh=0;ek=Pa.arr.sortByKey(Jg,"priority").reverse();Zh=ek.length&&ek[0].priority||0;ml=ek.map(function(Gj){Gj.highestPriority=
Zh;var bj=Gj.completion.replace(/\n/g,""),Oe=String((Gj.info||"").replace(/\n/g,""));Hh=Math.max(Hh,bj.length+Oe.length);return{isListItem:!0,string:bj,annotation:Oe,value:Gj}});return Hf.return({items:ml,maxCol:Hh})}})}},{key:"computeSortedCompletions",value:function(ba,Ja){Ja=void 0===Ja?!1:Ja;var ob=this,zb,Nc,yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Dd){if(1==Dd.nextAddress)return zb={tokens:[ba],lowercasedTokens:[ba],input:ba},Dd.yield(ob.computeCompletions(ba),2);Nc=Dd.yieldResult;
yc=Pa.arr.sortBy(Nc.items.filter(function(zd){return ob.filterFunction(zb,zd,Ja)}),function(zd){return ob.sortFunction(zb,zd)});return Dd.return(yc)})}},{key:"_printCompletions",value:function(ba){var Ja=this,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return zb.yield(Ja.computeSortedCompletions(ba),2);ob=zb.yieldResult.map(function(Nc){return{completion:Nc.value.completion,priority:Nc.value.priority,maxP:Nc.value.highestPriority,sortVal:Nc._cache[ba].sortVal,
lev:JSON.stringify(Nc._cache[ba].levenshtein)}});return zb.return(Pa.string.printTable(lively.lang.grid.tableFromObjects(ob)))})}},{key:"prefix",value:function(){var ba=this.textMorph,Ja=ba.selection;return(Ja.isEmpty()?ba.getLine(Ja.lead.row).slice(0,Ja.lead.column):Ja.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(ba,Ja,ob){ob=void 0===ob?!1:ob;Ja._cache||(Ja._cache={});var zb=ba.tokens,Nc=ba.lowercasedTokens,yc=ba.input;yc=Ja._cache[yc]||(Ja._cache[yc]={});if(yc.hasOwnProperty("filtered"))return yc.filtered;
Ja=Ja.value.completion.replace(/\([^\)]*\)$/,"");var Dd=Ja.toLowerCase();if(ob&&zb[0]&&!Ja.startsWith(zb[0]))return yc.filtered=!1;if(Nc.every(function(Bd){return Dd.includes(Bd)}))return!0;var zd=yc.levenshtein||(yc.levenshtein={});ba=ob||3>=Pa.arr.sum(ba.lowercasedTokens.map(function(Bd){return zd[Bd]||(zd[Bd]=Pa.string.levenshtein(Dd,Bd))}));return yc.filtered=ba}},{key:"sortFunction",value:function(ba,Ja){Ja._cache||(Ja._cache={});var ob=Ja._cache[ba.input]||(Ja._cache[ba.input]={});if(ob.hasOwnProperty("sortVal"))return ob.sortVal;
ob=Ja._cache[ba.input]={};var zb=Ja.value;Ja=zb.highestPriority;var Nc=zb.completion;zb=zb.priority;Nc=Nc.replace(/\([^\)]*\)$/,"").toLowerCase();var yc=0;ba.lowercasedTokens.forEach(function(zd){Nc.startsWith(zd)?yc+=12:3<=zd.length&&Nc.includes(zd)&&(yc+=5)});Ja=-((zb||(yc?Ja:0))/Math.pow(10,String(Ja).length-2))-yc;var Dd=ob.levenshtein||(ob.levenshtein={});ba=Pa.arr.sum(ba.lowercasedTokens.map(function(zd){return Dd[zd]||(Dd[zd]=Pa.string.levenshtein(Nc,zd))}));yc&&(ba/=2);return ob.sortVal=ba+
Ja}},{key:"positionForMenu",value:function(){var ba=this.textMorph,Ja=ba.charBoundsFromTextPosition(ba.cursorPosition);return ba.getGlobalTransform().transformRectToRect(Ja).topLeft().addXY(-ba.scroll.x,-ba.scroll.y).addPt(Pa.pt(ba.borderWidth+3,ba.borderWidth+3))}},{key:"completionListSpec",value:function(){var ba=this,Ja,ob,zb,Nc,yc,Dd,zd,Bd,Ie,Jg,wg,Qh,Vf,Hh,ek,Zh,ml,Hf,Gj,bj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oe){if(1==Oe.nextAddress)return ob=Ja=ba.textMorph,zb=ob.fontSize,
Nc=ob.fontFamily,yc=ba.positionForMenu(),Dd=ba.prefix(),Oe.yield(ba.computeCompletions(Dd),2);zd=Oe.yieldResult;Bd=zd.items;Ie=zd.maxCol;Jg=Ja.env.fontMetric.sizeFor(Nc,zb,"M");wg=Jg.width*Ie;Qh=Ja.document.getLine(0).height;Vf=Math.max(120,wg<Ja.width?wg:Ja.width);Hh=Qh*Bd.length+Qh+10;ek=Math.max(70,Math.min(700,Hh));Zh=yc.extent(Pa.pt(Vf,ek));if(ml=Ja.world())Hf=ml.visibleBounds().insetBy(5),Zh.bottom()>Hf.bottom()&&(Gj=Zh.bottom()-Hf.bottom(),Gj>Zh.height-50&&(Gj=Zh.height-50),Zh.height-=Gj),
Zh.right()>Hf.right()&&(bj=Zh.right()-Hf.right(),Zh.width=120>Zh.width-bj?120:Zh.width-bj),Hf.containsRect(Zh)||(Zh=Zh.withTopLeft(Hf.translateForInclusion(Zh).topLeft())),Zh=Zh.translatedBy(Hf.insetBy(0).topLeft().negated());return Oe.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},hasFixedPosition:!0,epiMorph:!0,fontSize:zb,position:Zh.topLeft(),extent:Zh.extent(),items:Bd,input:Dd,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:ba.filterFunction,
sortFunction:ba.sortFunction})})}},{key:"removeMenuOnBlur",value:function(ba){var Ja=ba.menu;setTimeout(function(){Ja.withAllSubmorphsDetect(function(ob){return ob.isFocused()})?Ja.inputMorph.focus():Ja.remove()})}},{key:"openCompletionList",value:function(){var ba=this,Ja,ob,zb,Nc,yc,Dd,zd,Bd,Ie,Jg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wg){if(1==wg.nextAddress)return Ja=ba.textMorph.selection.start,wg.yield(ba.completionListSpec(),2);ob=wg.yieldResult;ba.textMorph.pluginFind(function(Qh){return Qh.theme});
zb=new Pa.FilterableList(ob);Nc=new Pa.Range({start:Ja,end:ba.textMorph.selection.start});yc=ba.textMorph.textInRange(Nc);Dd=zb.inputMorph;zd=zb.listMorph;Bd=ob.input;Ie=zb.addMorph({name:"prefix mask",fill:Pa.Color.transparent,bounds:Dd.textBounds()},Dd);zd.master=null;Nc.isEmpty()||(ba.textMorph.deleteText(Nc),Dd.input=yc,Dd.gotoDocumentEnd());Dd.fontColor=ba.textMorph.fontColor;Pa.connect(Dd,"textString",Ie,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Dd}});Pa.connect(zb,
"accepted",ba,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Bd}});Pa.connect(zb,"accepted",zb,"remove");Pa.connect(zb,"canceled",zb,"remove");Pa.connect(zb,"remove",ba.textMorph,"focus");Pa.connect(zb.inputMorph,"onBlur",ba,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:zb}});Jg=ba.textMorph.world();Jg.addMorph(zb);zd.addStyleClass("hiddenScrollbar");Dd.height=zd.itemHeight;Dd.fixedHeight=!0;Dd.fontSize=zd.fontSize;Dd.focus();zb.get("padding").height=0;zb.relayout();zb.selectedIndex=0;Bd.length?(Dd.gotoDocumentEnd(),
zb.moveBy(Pa.pt(-Dd.textBounds().width+2,0))):zb.moveBy(Pa.pt(2,0));return wg.return(zb)})}},{key:"autoInsertBestMatchingCompletion",value:function(ba,Ja,ob){Ja=void 0===Ja?!0:Ja;var zb=this,Nc,yc,Dd,zd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bd){if(1==Bd.nextAddress)return Nc=$jscomp,yc=Nc.makeIterator,Bd.yield(zb.computeSortedCompletions(ba,Ja),2);Dd=yc.call(Nc,Bd.yieldResult);(zd=Dd.next().value)&&zb.insertCompletion(zd.value.completion,ba,ob);Bd.jumpToEnd()})}},{key:"insertCompletion",
value:function(ba,Ja,ob){var zb=this.textMorph,Nc=zb.document,yc=zb.selection.isMultiSelection?zb.selection.selections:[zb.selection];zb.undoManager.group();yc.forEach(function(Dd){Dd.collapseToEnd();var zd=Dd.lead,Bd=Ja?Nc.indexToPosition(Nc.positionToIndex(zd)-Ja.length):zd;"function"===typeof ob?ob(ba,Ja,zb,{start:Bd,end:zd},Dd):zb.replace({start:Bd,end:zd},ba)});zb.undoManager.group()}}],[{key:"className",get:function(){return"CompletionController"}}],$a,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1355,end:12497})}(void 0);Pa.CompletionController=ta;Pa.CompletionController=ta;Pa.CompletionController=ta;ta=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ka,$a,Kb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){return 1==Ja.nextAddress?
(ba=new Pa.CompletionController(Ka,Pa.defaultCompleters),Ja.yield(ba.openCompletionList(),2)):Ja.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ka,$a,Kb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){return 1==Ja.nextAddress?(ba=new Pa.CompletionController(Ka,Pa.defaultCompleters),Ja.yield(ba.autoInsertBestMatchingCompletion(ba.prefix()),2)):Ja.return(!0)})}}];Pa.completionCommands=ta;Pa.completionCommands=ta;Pa.completionCommands=
ta;var Jb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Jb.chain=Ud;Jb.arr=lc;Jb.obj=kd;Jb.string=Ad;var Rc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ka){var $a=Ka.selection.start;0<$a.row&&($a=Ka.getPositionAboveOrBelow(1,$a,!0,0,Ka.charBoundsFromTextPosition($a).x),Ka.selection.addRange({start:$a,end:$a}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Ka){var $a=Ka.selection.start;
$a.row<Ka.documentEndPosition.row&&($a=Ka.getPositionAboveOrBelow(-1,$a,!0,0,Ka.charBoundsFromTextPosition($a).x),Ka.selection.addRange({start:$a,end:$a}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ka){var $a=Ka.selection.selections[Ka.selection.selections.length-1];if($a.isEmpty())return!0;Ka.searchForAll($a.text,{start:{column:0,row:0}}).forEach(function(Kb){return Ka.selection.addRange(Kb.range,!1)});Ka.selection.mergeSelections();Jb.arr.remove(Ka.selection.selections,
$a);Ka.selection.selections.push($a);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ka){var $a=Ka.selection.selections.length-1,Kb=Ka.selection.selections[$a];if(Kb.isEmpty())return!0;var ba=Ka.search(Kb.text,{start:Kb.end,backwards:!1});ba&&(Kb=Ka.selection.selections.findIndex(function(Ja){return Ja.range.equals(ba.range)}),-1<Kb?Jb.arr.swap(Ka.selection.selections,Kb,$a):Ka.selection.addRange(ba.range));return!0}},{name:"[multi select] more like this backward",
multiSelectAction:"single",exec:function(Ka){var $a=Ka.selection.selections.length-1,Kb=Ka.selection.selections[$a];if(Kb.isEmpty())return!0;var ba=Kb.start,Ja=Ka.search(Kb.text,{start:{row:ba.row,column:ba.column-(Kb.text.length-1)},backwards:!0});Ja&&(Kb=Ka.selection.selections.findIndex(function(ob){return ob.range.equals(Ja.range)}),-1<Kb?Jb.arr.swap(Ka.selection.selections,Kb,$a):Ka.selection.addRange(Ja.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",
exec:function(Ka){var $a=Ka.selection.selections.length;1<$a&&Ka.selection.removeSelections($a-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ka){Ka.selection.selections=lively.lang.arr.rotate(Ka.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(Ka){Ka.selection.selections=lively.lang.arr.rotate(Ka.selection.selections,1);return!0}},{name:"[multi select] align cursors",
multiSelectAction:"single",exec:function(Ka){var $a=Ka.selection.selections;if(1>=$a.length)return!0;var Kb=Jb.arr.groupBy($a,function(Ja){return Ja.range.start.row});$a=Kb.keys().map(function(Ja){Ja=Kb[Ja];var ob=Jb.arr.max(Ja,function(zb){return zb.range.start.column});Jb.arr.without(Ja,ob).forEach(function(zb){return zb.range=ob.range});return ob});var ba=Jb.arr.max($a,function(Ja){return Ja.range.start.column}).range.start.column;$a.forEach(function(Ja){var ob=Ja.range.start;Ja=ob.row;ob=ob.column;
Ka.insertText(" ".repeat(ba-ob),{row:Ja,column:ob})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ka){Ka.selection.disableMultiSelect();if(Ka.selection.isEmpty())var $a=Ka.lastSavedMark&&Ka.lastSavedMark.position||(void 0).lineRange().start,Kb=Ka.cursorPosition;else $a=Ka.selection,Kb=$a.lead,$a=$a.anchor;Ka.selection.collapse();var ba=$a.column,Ja=Kb.column;Jb.arr.range($a.row,Kb.row).forEach(function(ob){return Ka.getLine(ob).length>Math.min(Ja,
ba)&&Ka.selection.addRange({end:{row:ob,column:Ja},start:{row:ob,column:ba}},!1)});Ka.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ka,$a,Kb){Kb=void 0===Kb?1:Kb;Ka.undoManager.group();Ka.selection.selections.forEach(function(ba,Ja){return ba.text=String(Ja+Kb)});Ka.undoManager.group();return!0}}];Jb.multiSelectCommands=Rc;Jb.multiSelectCommands=Rc;Jb.multiSelectCommands=Rc;var Zc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");
Zc.pToI=function(Ka,$a){return Ka.positionToIndex($a)};Zc.iToP=function(Ka,$a){return Ka.indexToPosition($a)};Zc.execCodeNavigator=function(Ka){return function($a,Kb,ba){var Ja=$a.pluginInvokeFirst("getNavigator");if(!Ja)return!0;$a.saveMark();ba=ba||1;for(var ob=0;ob<ba;ob++)Ja[Ka]($a,Kb);return!0}};Zc.once=cb;var oe=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Zc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",
exec:Zc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Zc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Zc.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Zc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",
bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ka,$a){function Kb(){var ob=Ka.$expandRegionState,zb=Zc.pToI(Ka,Ka.cursorPosition);if(ob&&(ob.range[0]===zb||ob.range[1]===zb))return ob;ob=Ka.selection.range;return Ka.$expandRegionState={range:[Zc.pToI(Ka,ob.start),Zc.pToI(Ka,ob.end)]}}$a=$a||{};var ba=Ka.pluginInvokeFirst("getNavigator");if(!ba)return!0;var Ja=$a.start;$a=$a.end;if("number"===typeof Ja&&"number"===typeof $a)Kb(),ba={range:[Ja,
$a],prev:Kb()};else{Ja=ba.ensureAST(Ka);if(!Ja)return;ba=ba.expandRegion(Ka,Ka.textString,Ja,Kb())}ba&&ba.range&&(Ka.selection={start:Zc.iToP(Ka,ba.range[0]),end:Zc.iToP(Ka,ba.range[1])},Ka.$expandRegionState=ba);Zc.once(Ka,"selectionChange",function(){return Ka.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ka){if(Ka.selection.isEmpty())return!0;
var $a=Ka.pluginInvokeFirst("getNavigator");if(!$a)return!0;var Kb=$a.ensureAST(Ka);if(!Kb)return!0;var ba=Ka.$expandRegionState;if(!ba)return!0;($a=$a.contractRegion(Ka,Ka.textString,Kb,ba))&&$a.range&&(Ka.selection={start:Zc.iToP(Ka,$a.range[0]),end:Zc.iToP(Ka,$a.range[1])},Ka.$expandRegionState=$a);Zc.once(Ka,"selectionChange",function(){return Ka.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Zc.commands=oe;Zc.commands=oe;Zc.commands=oe;var se=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");
se.arr=lc;se.chain=Ud;se.string=Ad;var Df=[{name:"toggle comment",exec:function(Ka){var $a=Ka.pluginInvokeFirst("getComment");if(!$a)return!0;if(!$a.lineCommentStart)return $a.blockCommentStart?Ka.execCommand("toggle block comment"):!0;var Kb=$a.lineCommentStart,ba=new RegExp("^(\\s*)("+Kb+"\\s?)(.*)");$a=Ka.document;var Ja=Ka.selection;Ja.isEmpty()||0!==Ja.end.column||Ja.growRight(-1);var ob=Ja.start.row;$a=$a.lineStrings.slice(Ja.start.row,Ja.end.row+1);$a=$a.some(function(yc){return!!yc.trim()})?
se.arr.dropWhile($a,function(yc){return yc.trim()?!1:++ob&&!0}):$a;var zb=$a.every(function(yc){return yc.trim()&&yc.match(ba)});Ka.undoManager.group();if(zb)$a.forEach(function(yc,Dd){if(yc=yc.match(ba)){yc=$jscomp.makeIterator(yc);yc.next();var zd=yc.next().value,Bd=yc.next().value;yc.next();Ka.deleteText({start:{row:ob+Dd,column:zd.length},end:{row:ob+Dd,column:zd.length+Bd.length}})}});else{var Nc=$a.reduce(function(yc,Dd,zd){return Dd.trim()||Ja.isEmpty()&&Ja.start.row===Ja.end.row?Math.min(yc,
Dd.match(/^\s*/)[0].length):yc},Infinity);Nc=Infinity===Nc?0:Nc;$a.forEach(function(yc,Dd){yc=$jscomp.makeIterator(yc.match(/^(\s*)(.*)/));yc.next();yc.next();yc.next();Ka.insertText(Kb+" ",{row:ob+Dd,column:Nc})})}Ka.undoManager.group();return!0}},{name:"toggle block comment",exec:function(Ka){var $a=Ka.pluginInvokeFirst("getComment");if(!$a)return!0;if(!$a.blockCommentStart)return $a.lineCommentStart?Ka.execCommand("toggle comment"):!0;if(!$a||!$a.blockCommentStart)return!0;var Kb=$a.blockCommentStart;
$a=$a.blockCommentEnd;var ba=new RegExp("^"+Kb.replace(/\*/g,"\\*")),Ja=new RegExp($a.replace(/\*/g,"\\*")+"$"),ob=Ka.tokenAt(Ka.cursorPosition);if(ob&&"comment"===ob.token){var zb=Ka.textInRange(ob);if(zb.match(ba)&&zb.match(Ja))return Ka.undoManager.group(),Ka.replace(ob,zb.slice(Kb.length,-$a.length)),Ka.undoManager.group(),!0}Ka.undoManager.group();Ka.insertText(Kb,Ka.selection.start);Ka.insertText($a,Ka.selection.end);Ka.undoManager.group();Kb=!Ka.selection.isEmpty();Ka.selection.growLeft($a.length);
Kb||Ka.selection.collapse();return!0}},{name:"comment box",exec:function(Ka,$a,Kb){$a=Ka.undoManager.ensureNewGroup(Ka,"comment box");if(Ka.selection.isEmpty())return Ka.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ka.execCommand("toggle comment"),Ka.undoManager.group($a),!0;var ba=Ka.selection.range,Ja=Ka.withSelectedLinesDo(function(zb){return zb}),ob=se.arr.min([ba.start.column].concat(se.chain(Ja).map(function(zb){return zb.match(/^\s*/)}).flatten().compact().pluck("length").value()));
Ja=se.arr.max(Ja.map(function(zb){return zb.length}))-ob;Ja=Array(Math.ceil(Ja/2)+1).join("-=")+"-";Ka.execCommand("toggle comment");Ka.collapseSelection();Ka.cursorPosition={row:ba.start.row,column:0};Kb?Ka.insertText(se.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",ob)):Ka.insertText(se.string.indent(Ja+"\n"," ",ob));Ka.selection.goUp();Ka.execCommand("toggle comment");Ka.cursorPosition={row:ba.end.row+2,column:0};Ka.insertText(se.string.indent(Ja+"\n"," ",ob));Ka.selection.goUp();
Ka.execCommand("toggle comment");Ka.selection.range={start:{row:ba.start.row,column:0},end:Ka.cursorPosition};Ka.undoManager.group($a);return!0},multiSelectAction:"forEach",handlesCount:!0}];se.commands=Df;se.commands=Df;se.commands=Df;var Qd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");Qd.printSymbol=function(Ka){if(Symbol.keyFor(Ka))return'Symbol.for("'+Symbol.keyFor(Ka)+'")';if(Qd.knownSymbols.get(Ka))return Qd.knownSymbols.get(Ka);String(Ka).match(Qd.symMatcher);return String(Ka)};
Qd.defaultSort=function(Ka,$a){if(Ka.hasOwnProperty("priority")||$a.hasOwnProperty("priority")){var Kb=Ka.priority||0,ba=$a.priority||0;if(Kb<ba)return-1;if(Kb>ba)return 1}Ka=(Ka.keyString||Ka.key).toLowerCase();$a=($a.keyString||$a.key).toLowerCase();return Ka<$a?-1:Ka===$a?0:1};Qd.safeToString=we;Qd.propertyNamesOf=function(Ka,$a){if(!Ka)return[];if(Array.isArray(Ka)){var Kb=$a?$a.offset:0;return Qd.arr.range(Kb,Kb+($a?$a.partitionSize:Ka.length-1))}return Qd.arr.sortBy(Object.keys(Ka),function(ba){return ba.toLowerCase()})};
Qd.isMultiValue=Je;Qd.printValue=Lf;Qd.partitionedChildren=function(Ka,$a){var Kb=void 0===$a?{}:$a;$a=void 0===Kb.originalValue?Ka:Kb.originalValue;var ba=void 0===Kb.offset?0:Kb.offset;Kb=void 0===Kb.partitionSize?Ka.length||Object.values(Ka).length:Kb.partitionSize;if(Qd.obj.isArray(Ka)){Ka=Qd.num.roundTo(Math.max(Qd.MIN_PARTITION_SIZE,Kb/50),.1);Kb/=Ka;for(var Ja=[],ob=0;ob<Kb;ob++){var zb="["+(ba+ob*Ka)+"-"+(ba+(ob+1)*Ka)+"]";Ja.push({partition:{originalValue:$a,offset:ba+ob*Ka,partitionSize:Ka},
value:[],key:zb,keyString:zb,valueString:"...",isCollapsed:!0})}return Ja}Ka=Qd.num.roundTo(Math.max(Qd.MIN_PARTITION_SIZE,Kb/50),.1);Kb/=Ka;Ja=[];ob=Qd.obj.keys($a).sort();for(zb=0;zb<Kb;zb++){var Nc=ba+zb*Ka,yc=ba+(zb+1)*Ka,Dd=Qd.obj.select($a,ob.slice(Nc,yc));Nc="["+ob[Nc].slice(0,4)+"-"+(ob[yc]||Qd.arr.last(ob)).slice(0,4)+"]";Ja.push({partition:{originalValue:Dd,offset:ba+zb*Ka,partitionSize:Ka},value:[],key:Nc,keyString:Nc,valueString:"...",isCollapsed:!0})}return Ja};Qd.propertiesOf=function(Ka){var $a=
Ka.partition?Ka.target:Ka.value;if(!$a)return[];var Kb={_rev:!0},ba=[],Ja="function"===typeof $a.livelyCustomInspect?$a.livelyCustomInspect():{},ob=Object.assign({},Qd.defaultPropertyOptions,{},Ja);if(Ja.properties){Ja=$jscomp.makeIterator(Ja.properties);for(var zb=Ja.next();!zb.done;zb=Ja.next()){var Nc=zb.value;zb=Nc.key;var yc=Nc.hidden,Dd=Nc.priority,zd=Nc.keyString,Bd=Nc.value;Nc=Nc.valueString;Kb[zb]=!0;yc||ba.push(Ka.getSubNode({priority:Dd,key:zb,keyString:zd||Qd.safeToString(zb),value:Bd,
valueString:Nc,isCollapsed:!0}))}}if(ob.includeDefault){Ja=Qd.propertyNamesOf($a,Ka.partition);if(Ja.length>Qd.MAX_NODE_THRESHOLD)for(Kb=$jscomp.makeIterator(Qd.partitionedChildren($a,Ka.partition)),Ja=Kb.next();!Ja.done;Ja=Kb.next())ba.push(Ka.getSubNode(Ja.value));else for(yc=$jscomp.makeIterator(Ja),Ja=yc.next();!Ja.done;Ja=yc.next())Dd=Ja.value,Dd in Kb||(Ja=$a[Dd],zb=Qd.printValue(Ja),Ja={keyString:Dd,key:Dd,value:Ja,valueString:zb,isCollapsed:!0},ba.push(Ka.getSubNode(Ja)));if(ob.includeSymbols)for(Kb=
$jscomp.makeIterator(Object.getOwnPropertySymbols($a)),Ja=Kb.next();!Ja.done;Ja=Kb.next())yc=Ja.value,Dd=Qd.safeToString(yc),Ja=$a[yc],zb=Qd.printValue(Ja),Ja={key:yc,keyString:Dd,value:Ja,valueString:zb,isCollapsed:!0},ba.push(Ka.getSubNode(Ja))}ob.sort&&(ba=ob.sortFunction($a,ba));return ba};Qd.obj=kd;Qd.num=Fb;Qd.arr=lc;Qd.string=Ad;Qd.connect=Uc;Qd.signal=vc;Qd.TreeData=pc;Qd.newUUID=sd;Qd.localInterface=Ia;Qd.MAX_NODE_THRESHOLD=1E3;Qd.MIN_PARTITION_SIZE=250;Qd.defaultPropertyOptions={includeDefault:!0,
includeSymbols:!0,sort:!0,sortFunction:function(Ka,$a){return Array.isArray(Ka)?$a:$a.sort(Qd.defaultSort)}};Qd.symMatcher=/^Symbol\((.*)\)$/;Qd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ka){return"symbol"===typeof Symbol[Ka]}).reduce(function(Ka,$a){return Ka.set(Symbol[$a],"Symbol."+$a)},new Map)}();Qd.isMultiValue=Je;Qd.isMultiValue=Je;Qd.printValue=Lf;Qd.printValue=Lf;var ue=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Kb=$a.hasOwnProperty("InspectionTree")&&"function"===typeof $a.InspectionTree?$a.InspectionTree:$a.InspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Vb._get(Object.getPrototypeOf(Kb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.inspector=ba.inspector;this.root.isInspectionNode||(this.root=Qd.InspectionNode.for(this.root,
this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(ba){ba=void 0===ba?!0:ba;return Vb._get(Object.getPrototypeOf(Kb.prototype),"asListWithIndexAndDepth",this).call(this,function(Ja){Ja=Ja.node;return ba?Ja.visible:!0})}},{key:"getContextFor",value:function(ba){return ba==this.root?this.root.value.inspectee:ba.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(ba){var Ja=void 0===ba.maxDepth?1:ba.maxDepth,ob=ba.iterator,
zb=ba.showUnknown,Nc=ba.showInternal,yc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Dd){if(1==Dd.nextAddress)return Dd.yield(yc.uncollapseAll(function(zd,Bd){return Ja>Bd&&(zd==yc.root||zd.value.submorphs)}),2);yc.asListWithIndexAndDepth(!1).forEach(function(zd){var Bd=zd.node;return 0==zd.depth?Bd.visible=!0:!zb&&Bd.keyString&&Bd.keyString.includes("UNKNOWN PROPERTY")||!Nc&&Bd.keyString&&Bd.keyString.includes("internal")?Bd.visible=!1:Bd.value&&Bd.value.submorphs?Bd.visible=
!0:Bd.visible=ob(Bd)});Dd.jumpToEnd()})}},{key:"getChildren",value:function(ba){return ba.children}},{key:"display",value:function(ba){return ba.display(this.inspector)}},{key:"isCollapsed",value:function(ba){return ba.isCollapsed}},{key:"isLeaf",value:function(ba){return Qd.obj.isPrimitive(ba.value)}},{key:"collapse",value:function(ba,Ja){var ob=this;ba.isCollapsed=Ja;Ja||this.isLeaf(ba)||ba.children.length||(ba.children=Qd.propertiesOf(ba).map(function(zb){ob.parentMap.set(zb,ba);return zb}))}},
{key:"retrieveForRemoteProxy",value:function(ba){ba.uuid||(ba.uuid=Qd.newUUID(),this.idToNodeMap[ba.uuid]=ba);return{uuid:ba.uuid,value:this.isLeaf(ba)?ba.value:{},keyString:ba.keyString,key:ba.keyString,valueString:Qd.safeToString(ba.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Qd.localInterface}},{key:"getNodeViaId",value:function(ba){return this.idToNodeMap[ba]}},{key:"asRemoteDelegate",value:function(ba){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||
(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[ba]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:"className",get:function(){return"InspectionTree"}},{key:"forObject",value:function(ba,Ja){return new this({key:"inspectee",value:{inspectee:ba},isCollapsed:!0,inspector:Ja})}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5932,end:8631})}(Qd.TreeData);Qd.InspectionTree=ue;Qd.InspectionTree=ue;Qd.InspectionTree=ue;var of=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Kb=$a.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof $a.RemoteInspectionTree?$a.RemoteInspectionTree:$a.RemoteInspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Vb(Kb,Ka,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(ba){this.parentMap=new WeakMap;this.root=ba.proxy;this.evalEnvironment=ba.evalEnvironment;this.inspector=ba.inspector;this.delegateId=ba.delegateId}},{key:"getContextFor",value:function(ba){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+ba.uuid+'").value'}},{key:"dispose",value:function(){var ba=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){return Ja.yield(ba.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+ba.delegateId+"']\n    ",ba.evalEnvironment),0)})}},{key:"display",value:function(ba){return ba.keyString+": "+ba.valueString}},{key:"collapse",value:function(ba,Ja){var ob=this,zb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){if(1==Nc.nextAddress)return(ba.isCollapsed=Ja)||ob.isLeaf(ba)?
Nc.return():ba.children.length?Nc.jumpTo(0):Nc.yield(ob.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+ba.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+ob.delegateId+'"]'}),3);zb=Nc.yieldResult;ba.children=zb.isError?
[]:zb.value;Nc.jumpToEnd()})}}],[{key:"className",get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(ba,Ja){var ob=this,zb,Nc,yc,Dd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zd){if(1==zd.nextAddress)return zd.yield(ob.createRemoteContext(ba,Ja),2);zb=zd.yieldResult;Nc=zb.proxy;yc=zb.delegateId;Dd=zb.evalEnvironment;return zd.return(new ob({key:"inspectee",proxy:Nc,delegateId:yc,evalEnvironment:Dd,inspector:Ja}))})}},{key:"createRemoteContext",value:function(ba,
Ja){var ob=ba.code,zb=ba.evalEnvironment,Nc=ba.delegateId,yc,Dd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zd){if(1==zd.nextAddress)return Nc="lively://inspector-"+Ja.id,zd.yield(zb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+ob+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Nc+'");\n    ',zb),2);yc=zd.yieldResult;Dd=yc.value;return zd.return({delegateId:Nc,
evalEnvironment:zb,proxy:Dd})})}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8640,end:10983})}(Qd.InspectionTree);Qd.RemoteInspectionTree=of;Qd.RemoteInspectionTree=of;Qd.RemoteInspectionTree=of;(function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Kb=$a.hasOwnProperty("InspectionNode")&&"function"===typeof $a.InspectionNode?$a.InspectionNode:$a.InspectionNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){var Ja=ba.root,ob=ba.priority,zb=ba.key,Nc=ba.keyString,yc=ba.value,Dd=ba.valueString,zd=ba.isCollapsed,Bd=void 0===ba.children?[]:ba.children,Ie=void 0===ba.isSelected?!1:ba.isSelected,
Jg=void 0===ba.visible?!0:ba.visible;this.partition=ba.partition;this.priority=ob;this.key=zb;this.keyString=String(Nc||zb);this.value=yc;this.valueString=Dd||Qd.printValue(yc);this.isCollapsed=zd;this.children=Bd;this.isSelected=Ie;this.visible=Jg;this.root=Ja}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",get:function(){return!0}},{key:"getSubNode",value:function(ba){if(ba.value&&ba.value.isMorph)return new Qd.MorphNode(Object.assign({root:this.root},ba));var Ja=ba.key,
ob=ba.keyString,zb=this.value,Nc=ba.partition;Nc&&(zb=Nc.originalValue,ob=Ja);return new Qd.PropertyNode(Object.assign({},ba,{keyString:ob,key:Ja,target:zb,partition:Nc,root:this.root,spec:{}}))}},{key:"display",value:function(ba){var Ja=this.keyString,ob=this.valueString;if(!this.interactive)return Ja+": "+ob;this._propertyWidget||(this._propertyWidget=ba.renderDraggableTreeLabel({value:Ja+": "+ob}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:"className",
get:function(){return"InspectionNode"}},{key:"for",value:function(ba,Ja){Ja=void 0===Ja?null:Ja;return ba.value&&ba.value.isMorph?new Qd.MorphNode(Object.assign({root:Ja},ba)):new Qd.InspectionNode(Object.assign({root:Ja},ba))}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10985,
end:13522})})(void 0);(function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Kb=$a.hasOwnProperty("MorphNode")&&"function"===typeof $a.MorphNode?$a.MorphNode:$a.MorphNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Vb._get(Object.getPrototypeOf(Kb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,ba);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(ba){var Ja=this.propertyInfo[ba.key]||{};return ba.value&&ba.value.isMorph?new Qd.MorphNode(Object.assign({},ba,{root:this.root})):new Qd.PropertyNode(Object.assign({},ba,{root:this.root,target:this.target,spec:Ja}))}}],[{key:"className",get:function(){return"MorphNode"}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13524,end:14670})})(Qd.InspectionNode);(function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Kb=$a.hasOwnProperty("PropertyNode")&&"function"===typeof $a.PropertyNode?$a.PropertyNode:$a.PropertyNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Vb(Kb,Ka,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Vb._get(Object.getPrototypeOf(Kb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);var Ja=ba.spec,ob=ba.target;this.partition=ba.partition;this.target=ob;this.spec=Ja;this.foldedNodes={}}},{key:"__deserialize__",value:function(ba,Ja){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(ba){this._interactive=ba}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},
{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(ba){return this.isFoldable?this.getFoldedContext(ba):Vb._get(Object.getPrototypeOf(Kb.prototype),"getSubNode",this).call(this,ba)}},{key:"getFoldedContext",value:function(ba){return this.foldedNodes[ba.key]=new Qd.FoldedNode(Object.assign({},ba,{root:this.root,target:this.target,foldableNode:this,spec:Qd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",
value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(ba,Ja){(Ja=void 0===Ja?!1:Ja)&&(this.target[this.key]=ba);this.value=this.target[this.key];this.valueString=Qd.printValue(this.value);this.interactive&&(Ja||this._propertyWidget.highlight());if(this.isFoldable)for(var ob in this.foldedNodes)this.foldedNodes[ob].value=this.value[ob],this.foldedNodes[ob].valueString=Qd.printValue(this.value[ob]),this.foldedNodes[ob]._propertyWidget&&Qd.signal(this.foldedNodes[ob]._propertyWidget,
"update",this.value[ob])}},{key:"display",value:function(ba){var Ja=this,ob=this._propertyWidget,zb=this.keyString,Nc=this.valueString,yc=this.target,Dd=this.value,zd=this.spec;if(!(this.interactive||zd.foldable&&Qd.isMultiValue(Dd,zd.foldable)))return ba.renderPropertyControl({target:yc,keyString:zb,valueString:Nc,tree:ba.ui.propertyTree,value:Dd,spec:zd,node:this,fastRender:!0});if(ob)return ob.keyString=zb,ob.valueString=Nc,ob.isSelected=this.isSelected,ob.control&&(ob.control.isSelected=this.isSelected),
ob;ob=this._propertyWidget=ba.renderPropertyControl({target:yc,keyString:zb,valueString:Nc,value:Dd,spec:zd,node:this,isSelected:this.isSelected,fontColor:ba.ui.propertyTree.fontColor});this.isInternalProperty||zd.readOnly||(Qd.connect(ob,"propertyValue",this,"refreshProperty",{updater:function(Bd,Ie){return Bd(Ie,!0)}}),Qd.connect(ob,"openWidget",this.root,"onWidgetOpened",{converter:function(Bd){return{widget:Bd,node:Ja.sourceObj}}}));return ob}}],[{key:"className",get:function(){return"PropertyNode"}}],
$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14672,end:18071})})(Qd.InspectionNode);(function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Kb=$a.hasOwnProperty("FoldedNode")&&"function"===typeof $a.FoldedNode?$a.FoldedNode:$a.FoldedNode=
function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Vb._get(Object.getPrototypeOf(Kb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.foldableNode=ba=ba.foldableNode;this.foldedProp=ba.key+Qd.string.capitalize(this.key)}},{key:"refreshProperty",value:function(ba,Ja){Ja=void 0===Ja?!1:Ja;var ob={};this.foldableNode.refreshProperty(Object.assign({},
this.target[this.foldableNode.key],(ob[this.key]=ba,ob)),Ja)}}],[{key:"className",get:function(){return"FoldedNode"}}],$a,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18073,end:18749})})(Qd.PropertyNode);var Gf=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Gf.Color=
Cb;var rg=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Kb=$a.hasOwnProperty("DarkTheme")&&"function"===typeof $a.DarkTheme?$a.DarkTheme:$a.DarkTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:"background",get:function(){return Gf.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Gf.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},
{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},
{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Gf.Color.rgb(204,109,243)}}},{key:"atom",
get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Gf.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Gf.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",
get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},
{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Gf.Color.white,fontWeight:"bold",backgroundColor:Gf.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Gf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",
get:function(){return{backgroundColor:Gf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:"className",get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],$a,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3048})}(void 0),mg=rg=Gf.DarkTheme;Gf.default=rg;var Vc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Vc.inspect=ud;Vc.remoteInspect=Fe;Vc.generateReferenceExpression=Pd;Vc.onNumberDragStart=function(Ka,$a){$a.initPos=Ka.position;$a.factorLabel=(new Vc.Tooltip({description:"1x"})).openInWorld(Ka.hand.position.addXY(10,10))};Vc.onNumberDrag=
function(Ka,$a){var Kb=Vc.getScaleAndOffset(Ka,$a),ba=Kb.scale;Kb=Kb.offset;$a.factorLabel.position=Ka.hand.position.addXY(10,10);$a.factorLabel.description=ba+"x";return Vc.getCurrentValue(Kb,ba,$a)};Vc.onNumberDragEnd=function(Ka,$a){var Kb=Vc.getScaleAndOffset(Ka,$a);Ka=Kb.offset;Kb=Kb.scale;$a.factorLabel.softRemove();return Vc.getCurrentValue(Ka,Kb,$a)};Vc.getScaleAndOffset=function(Ka,$a){var Kb=Ka.position.subPt($a.initPos);Ka=Kb.x;$a=Vc.num.roundTo(Math.exp(-Kb.y/$world.height*6),.01)*$a.baseFactor;
return{offset:Ka,scale:$a}};Vc.getCurrentValue=function(Ka,$a,Kb){return Math.max(Kb.min,Math.min(Kb.max,Kb.scrubbedValue+(Kb.floatingPoint?Ka*$a:Math.round(Ka*$a))))};Vc.Color=Cb;Vc.Rectangle=gc;Vc.rect=pd;Vc.pt=fe;Vc.obj=kd;Vc.num=Fb;Vc.Path=tc;Vc.arr=lc;Vc.promise=bd;Vc.connect=Uc;Vc.disconnect=Xb;Vc.once=cb;Vc.Morph=Tb;Vc.Tooltip=Oc;Vc.VerticalLayout=td;Vc.GridLayout=Ob;Vc.HorizontalLayout=sb;Vc.morph=fd;Vc.CustomLayout=hb;Vc.Label=qb;Vc.Icon=Aa;Vc.StyleSheet=id;Vc.config=bb;Vc.Tree=wb;Vc.LoadingIndicator=
Hb;Vc.DropDownList=Qb;Vc.DropDownSelector=lb;Vc.SearchField=mb;Vc.LabeledCheckBox=Rb;Vc.MorphHighlighter=Pc;Vc.InteractiveMorphSelector=Xc;Vc.printValue=Lf;Vc.RemoteInspectionTree=of;Vc.InspectionTree=ue;Vc.isMultiValue=Je;Vc.valueWidgets=Q;Vc.popovers=fa;Vc.DarkTheme=mg;Vc.DefaultTheme=Mb;Vc.syncEval=Gc;Vc.inspectorCommands=[{name:"focus codeEditor",exec:function(Ka){Ka.get("codeEditor").show();Ka.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ka){Ka.get("propertyTree").show();
Ka.get("propertyTree").focus();return!0}}];(function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Kb=$a.hasOwnProperty("DraggedProp")&&"function"===typeof $a.DraggedProp?$a.DraggedProp:$a.DraggedProp=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:"applyToTarget",value:function(ba){var Ja=this.currentTarget,ob=this.control;this.remove();Vc.MorphHighlighter.removeHighlighters(ba.world);
if(Ja)if(Ja.isText&&"js"===Ja.editorModeName){var zb=Ja.evalEnvironment.context;ba=Ja.textPositionFromPoint(Ja.localize(ba.position));zb=Vc.generateReferenceExpression(this.sourceObject,{fromMorph:zb});ob.keyString&&(zb+="."+ob.keyString);Ja.insertTextAndSelect(zb,ba);Ja.focus()}else"propertyValue"in ob&&(Ja[ob.keyString]=ob.propertyValue)}},{key:"update",value:function(ba){ba=ba.hand.globalPosition;var Ja=this.morphBeneath(ba),ob;if(Ja){for(Ja==this.morphHighlighter&&(Ja=Ja.morphBeneath(ba));ob=
[Ja].concat($jscomp.arrayFromIterable(Ja.ownerChain())).find(function(zb){return!zb.visible});)Ja=ob=ob.morphBeneath(ba);if(Ja!=this.currentTarget){this.currentTarget=Ja;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Ja.isWorld)return;this.morphHighlighter=Vc.MorphHighlighter.for($world,Ja);this.morphHighlighter.show()}this.position=ba}}}],[{key:"className",get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Vc.Color.rgb(169,
204,227)},fill:{defaultValue:Vc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var ba=this.control;if(!ba)return this.submorphs=[];this.height=22;this.submorphs=[ba];ba.top=0;ba.fontSize=14;"function"===typeof ba.relayout&&ba.relayout();this.width=ba.width+20;this.adjustOrigin(Vc.pt(10,10))}}}}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1268,end:3690})})(Vc.Morph);(function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Kb=$a.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof $a.DraggableTreeLabel?$a.DraggableTreeLabel:$a.DraggableTreeLabel=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Vb(Kb,Ka,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(ba){this.draggedProp=new Vc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Vc.connect(ba.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(ba){}},{key:"onDragEnd",value:function(ba){Vc.disconnect(ba.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(ba)}}],[{key:"className",get:function(){return"DraggableTreeLabel"}},
{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Vc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:Vc.Color.transparent},padding:{defaultValue:Vc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(ba){this.setProperty("isSelected",ba);ba?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),
this.removeStyleClass("selected"));this.control&&(this.control.isSelected=ba)}}}}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3692,end:5015})})(Vc.Label);ue=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Kb=$a.hasOwnProperty("PropertyControl")&&
"function"===typeof $a.PropertyControl?$a.PropertyControl:$a.PropertyControl=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(ba,Ja,ob){ba.control=new Vc.DropDownSelector({opacity:.8,fill:Vc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Ja,padding:0,values:ob});
Vc.connect(ba.control,"update",ba,"propertyValue",{updater:function(zb,Nc){this.targetObj.propertyValue!=Nc&&zb(Nc)}});Vc.connect(ba,"update",ba.control,"selectedValue",{updater:function(zb,Nc){Nc=Nc&&Nc.valueOf?Nc.valueOf():Nc;this.targetObj.propertyValue!=Nc&&zb(Nc)}});return ba}},{key:"toggleMultiValuePlaceholder",value:function(ba){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:Vc.Color.transparent,layout:new Vc.HorizontalLayout({spacing:3}),name:"multi value placeholder",
nativeCursor:"pointer",submorphs:Vc.arr.range(0,2).map(function(Ja){return{type:"ellipse",fill:Vc.Color.gray.withA(.5),reactsToPointer:!1,extent:Vc.pt(7,7)}})});ba?(Vc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(Vc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=
!1)}},{key:"toggleFoldableValue",value:function(ba){this.foldableProperties&&this.toggleMultiValuePlaceholder(Vc.isMultiValue(ba,this.foldableProperties))}},{key:"asFoldable",value:function(ba){this.foldableProperties=ba;Vc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&
(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var ba=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});ba.isLayoutable=!1;ba.fontWeight="bold";ba.fontColor=Vc.Color.orange;ba.reactsToPointer=!1;ba.fadeOut(2E3)}}],[{key:"className",get:function(){return"PropertyControl"}},{key:"properties",
get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(ba){this.submorphs=[ba]}},layout:{initialize:function(){this.layout=new Vc.CustomLayout({relayout:function(ba){ba.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(ba){return(ba=ba.value)&&(ba.isColor||ba.isGradient)?"Color":ba&&ba.isPoint?"Point":
Vc.obj.isBoolean(ba)?"Boolean":Vc.obj.isNumber(ba)?"Number":Vc.obj.isString(ba)?"String":ba&&ba.isRectangle?"Rectangle":!1}},{key:"render",value:function(ba){ba.spec.type||(ba.spec=Object.assign({},ba.spec,{type:this.inferType(ba)}));switch(ba.spec.type){case "Color":var Ja=this.renderColorControl(ba);break;case "ColorGradient":Ja=this.renderColorControl(Object.assign({},ba,{gradientEnabled:!0}));break;case "Number":Ja=this.renderNumberControl(ba);break;case "String":Ja=this.renderStringControl(ba);
break;case "RichText":Ja=this.renderStringControl(ba);break;case "Layout":Ja=this.renderLayoutControl(ba);break;case "Enum":Ja=this.renderEnumControl(ba);break;case "Shadow":Ja=this.renderShadowControl(ba);break;case "Point":Ja=this.renderPointControl(ba);break;case "Rectangle":Ja=this.renderRectangleControl(ba);break;case "Boolean":Ja=this.renderBooleanControl(ba);break;default:Ja=this.renderItSomehow(ba)}Ja.control&&(Vc.connect(Ja.control,"openWidget",Ja,"openWidget"),Ja.toggleFoldableValue(ba.value));
return Ja}},{key:"baseControl",value:function(ba){var Ja=ba.spec;ba=new this({keyString:ba.keyString,valueString:ba.valueString,isSelected:!1,propertyValue:ba.value});Ja.foldable&&ba.asFoldable(Ja.foldable);return ba}},{key:"renderGrabbableKey",value:function(ba){var Ja=this,ob=ba.target;return[ba.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(zb){zb.state.draggedProp=new Vc.DraggedProp({sourceObject:ob,control:Ja.baseControl(ba)});zb.state.draggedProp.openInWorld();Vc.connect(zb.hand,
"update",zb.state.draggedProp,"update")},onDrag:function(zb){},onDragEnd:function(zb){Vc.disconnect(zb.hand,"update",zb.state.draggedProp,"update");zb.state.draggedProp.applyToTarget(zb)}}]}},{key:"renderEnumControl",value:function(ba){var Ja=ba.value,ob=ba.spec.values,zb=ba.keyString,Nc=ba.target,yc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(Ja?Ja.valueOf?Ja.valueOf():Ja:"Not set"),{nativeCursor:"pointer",onMouseDown:function(Dd,zd){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bd){Nc.world().openWorldMenu(Dd,
ob.map(function(Ie){return{string:Ie.toString(),action:function(){Nc[zb]=Ie;yc.rerender()}}}));Bd.jumpToEnd()})}}],$jscomp.arrayFromIterable(Vc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7})))}},{key:"renderStringControl",value:function(ba){var Ja=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(200<Ja.length?Ja.slice(0,20)+"...":Ja),{fontColor:Vc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(ba){var Ja=
ba.value,ob=ba.keyString,zb=ba.valueString,Nc=ba.target,yc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+zb,{fontColor:Vc.Color.black,nativeCursor:"pointer",onMouseDown:function(Dd){var zd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bd){if(1==Bd.nextAddress)return zd=new Vc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:Ja}),zd.relayout(),Bd.yield(zd.fadeIntoWorld(Dd.positionIn(Nc.world())),2);Vc.connect(zd,"rectangle",function(Ie){Nc[ob]=
Ie;yc.rerender()});Bd.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(ba){var Ja=ba.value,ob=ba.keyString,zb=ba.valueString,Nc=ba.target,yc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+zb,{nativeCursor:"pointer",fontColor:Ja?Vc.Color.green:Vc.Color.red,onMouseDown:function(Dd){Nc[ob]=!Nc[ob];yc.rerender()}}])}},{key:"renderNumberControl",value:function(ba){var Ja=ba.value,ob=ba.spec,zb=ba.keyString,Nc=ba.valueString,yc=ba.node,Dd=ba.target,zd=
ba.tree,Bd=void 0===yc._numberControls?new yf:yc._numberControls,Ie=$jscomp.makeIterator(Bd.submorphs),Jg=Ie.next().value,wg=Ie.next().value;Bd.fontColor=zd.fontColor;var Qh=yc._numberControls=Bd;"max"in ob&&"min"in ob&&-Infinity!=ob.min&&Infinity!=ob.max?(Qh.baseFactor=(ob.max-ob.min)/100,Qh.floatingPoint=ob.isFloat,Qh.max=ob.max,Qh.min=ob.min):(Qh.floatingPoint=ob.isFloat,Qh.baseFactor=.5,Qh.min=void 0!=ob.min?ob.min:-Infinity,Qh.max=void 0!=ob.max?ob.max:Infinity);var Vf=Vc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;
return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),$jscomp.arrayFromIterable(yc._inputMorph?[yc._inputMorph,{}]:[" "+(void 0!=Ja&&(Ja.valueOf?Ja.valueOf():Ja).toFixed(ob.isFloat?3:0))+" ",{fontColor:Vf,onMouseUp:function(Hh){yc._inputMorph=Vc.morph({type:"input",fill:null,fontColor:Vf,fontFamily:"IBM Plex Mono",fontSize:14,padding:Vc.rect(8,2,-6,2),height:23,cursorColor:Vc.Color.white,value:Ja.valueOf?Ja.valueOf():Nc});Dd[zb]=Ja;yc._inputMorph.focus();Vc.once(yc._inputMorph,"inputAccepted",
function(ek){delete yc._inputMorph;Dd[zb]=ob.isFloat?Number.parseFloat(ek):Number.parseInt(ek);yc.rerender()});Vc.once(yc._inputMorph,"onBlur",function(ek){yc._inputMorph&&(delete yc._inputMorph,Dd[zb]=Ja,yc.rerender())});yc.rerender()},onDragStart:function(Hh){Qh.scrubbedValue=Ja;Vc.onNumberDragStart(Hh,Qh)},onDrag:function(Hh){Dd[zb]=Vc.onNumberDrag(Hh,Qh);yc.rerender()},onDragEnd:function(Hh){return Vc.onNumberDragEnd(Hh,Qh)}},Bd,{onMouseUp:function(){Jg.fill=wg.fill=null},onMouseDown:function(Hh){if(Hh.targetMorph===
Jg){Jg.fill=Vc.Color.white.withA(.2);if("max"in ob&&Dd[zb]>=ob.max)return;Dd[zb]+=1}if(Hh.targetMorph===wg){wg.fill=Vc.Color.white.withA(.2);if("min"in ob&&Dd[zb]<=ob.min)return;--Dd[zb]}yc.rerender()}}]))}},{key:"renderShadowControl",value:function(ba){var Ja=ba.keyString,ob=ba.value,zb=ba.target,Nc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[""+(ob?ob.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(yc){var Dd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zd){if(1==
zd.nextAddress)return Dd=new Vc.popovers.ShadowPopover({shadowValue:zb[Ja],hasFixedPosition:!0}),zd.yield(Dd.fadeIntoWorld(yc.positionIn(zb.world())),2);Vc.connect(Dd,"shadowValue",function(Bd){zb[Ja]=Bd;Nc.rerender()});zd.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(ba){var Ja=ba.keyString,ob=ba.value,zb=ba.target,Nc=ba.node,yc=Vc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Dd={nativeCursor:"pointer",onMouseDown:function(zd){var Bd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ie){if(1==
Ie.nextAddress)return Bd=new Vc.popovers.PointPopover({pointValue:zb[Ja],hasFixedPosition:!0}),Ie.yield(Bd.fadeIntoWorld(zd.positionIn(zb.world())),2);Vc.connect(Bd,"pointValue",function(Jg){zb[Ja]=Jg;Nc.rerender()});Ie.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" pt(",Object.assign({},Dd),""+ob.x.toFixed(),Object.assign({fontColor:yc},Dd),",",Object.assign({},Dd),""+ob.y.toFixed(),Object.assign({fontColor:yc},Dd),")",Object.assign({},Dd)])}},{key:"renderLayoutControl",
value:function(ba){var Ja=ba.valueString,ob=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(ob?Ja:"No Layout"),{onMouseDown:function(zb){}}])}},{key:"renderColorControl",value:function(ba){var Ja=ba.node,ob=ba.gradientEnabled,zb=ba.valueString,Nc=ba.keyString,yc=ba.value,Dd=ba.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[Vc.morph({fill:yc.valueOf?yc.valueOf():yc,extent:Vc.pt(15,15),borderColor:Vc.Color.gray,borderWidth:1}),{paddingLeft:"5px",
paddingTop:"4px",paddingRight:"5px"},""+(yc?yc.valueOf?yc.valueOf():zb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(zd){var Bd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ie){if(1==Ie.nextAddress)return Bd=new Vc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Dd,fillValue:yc,title:"Fill Control",gradientEnabled:ob}),Ie.yield(Bd.fadeIntoWorld(zd.positionIn(Dd.world())),2);Vc.connect(Bd,"fillValue",function(Jg){Dd[Nc]=Jg;Ja.rerender()});Ie.jumpToEnd()})}}])}},{key:"renderItSomehow",
value:function(ba){var Ja=ba.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+Ja,{}])}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5024,end:20444})}(Vc.DraggableTreeLabel);Vc.PropertyControl=ue;Vc.PropertyControl=ue;Vc.PropertyControl=ue;
Vc.inspect=ud;Vc.inspect=ud;Vc.remoteInspect=Fe;Vc.remoteInspect=Fe;Vc.generateReferenceExpression=Pd;Vc.generateReferenceExpression=Pd;var yf=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Kb=$a.hasOwnProperty("NumberControls")&&"function"===typeof $a.NumberControls?$a.NumberControls:$a.NumberControls=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,void 0,[{key:"className",
get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Vc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Vc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(ba){this.submorphs.map(function(Ja){return Ja.fontColor=ba})}},submorphs:{initialize:function(){this.submorphs=[Vc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Vc.rect(5,2,0,-6),fontSize:12}),
Vc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Vc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23095,end:24127})}(Vc.Morph);(function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),
Kb=$a.hasOwnProperty("PropertyTree")&&"function"===typeof $a.PropertyTree?$a.PropertyTree:$a.PropertyTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:"onDrag",value:function(ba){this._onDragHandler&&this._onDragHandler(ba)}}],[{key:"className",get:function(){return"PropertyTree"}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25279,end:25389})})(Vc.Tree);ue=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Kb=$a.hasOwnProperty("Inspector")&&"function"===typeof $a.Inspector?$a.Inspector:$a.Inspector=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:"onWindowClose",
value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(ba){}},{key:"__after_deserialize__",value:function(){var ba=this,Ja=new Vc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Vc.InspectionTree.forObject(null,this)}));this.addMorph(Ja,this.getSubmorphNamed("terminal toggler"));this.layout.col(0).row(1).group.morph=Ja;this.whenRendered().then(function(){ba.targetObject&&(ba.targetObject=
ba.targetObject)});Vb._get(Object.getPrototypeOf(Kb.prototype),"__after_deserialize__",this).call(this)}},{key:"__additionally_serialize__",value:function(ba,Ja,ob,zb){ba=ba.props.submorphs.value;for(Ja=ba.length;Ja--;)ob.refForId(ba[Ja].id).realObj==this.ui.propertyTree&&Vc.arr.removeAt(ba,Ja)}},{key:"renderDraggableTreeLabel",value:function(ba){return new Vc.DraggableTreeLabel(ba)}},{key:"renderPropertyControl",value:function(ba){return Vc.PropertyControl.render(ba)}},{key:"onLoad",value:function(){var ba=
this.ui,Ja=ba.codeEditor,ob=ba.thisBindingSelector,zb=ba.propertyTree;Ja.changeEditorMode("js").then(function(){return Ja.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==ob.selection?Ja.owner.selectedContext:Ja.owner.targetObject},get systemInterface(){return Vc.Path("treeData.systemInterface").get(zb)},format:"esm"}}).catch(function(Nc){return $world.logError(Nc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(ba){Vb._get(Object.getPrototypeOf(Kb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this,ba);ba=this.ui;var Ja=ba.targetPicker,ob=ba.propertyTree,zb=ba.resizer,Nc=ba.terminalToggler,yc=ba.unknowns,Dd=ba.internals,zd=ba.searchField,Bd=ba.codeEditor,Ie=ba.fixImportButton,Jg=ba.thisBindingSelector;Bd.changeEditorMode("js").then(function(){return Bd.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Jg.selection?Bd.owner.selectedContext:Bd.owner.targetObject},get systemInterface(){return ob.treeData.systemInterface},
format:"esm"}}).catch(function(wg){return $world.logError(wg)});Vc.connect(Ja,"onMouseDown",this,"selectTarget");Vc.connect(ob,"onScroll",this,"repositionOpenWidget");Vc.connect(zb,"onDrag",this,"adjustProportions");Vc.connect(Nc,"onMouseDown",this,"toggleCodeEditor");Vc.connect(yc,"trigger",this,"filterProperties");Vc.connect(Dd,"trigger",this,"filterProperties");Vc.connect(zd,"searchInput",this,"filterProperties");Vc.connect(ob,"nodeCollapseChanged",this,"filterProperties");Vc.connect(this,"extent",
this,"relayout");Vc.connect(Jg,"selection",this,"bindCodeEditorThis");Vc.connect(Ie,"fire",Bd,"execCommand",{updater:function(wg){return wg("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var ba=this.ui.propertyTree.selectedIndex-1,Ja=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Ja=this.ui.propertyTree.document.getLine(ba).textAndAttributes.slice(0,4).concat(Ja.display(this));ba=this.ui.propertyTree.lineRange(ba,
!1);this.ui.propertyTree.replace(ba,Ja,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var ba=Vc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(ba!=this.lastChange||
this.lastSubmorphs!=Vc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==ba.prop&&this.repositionOpenWidget(),this.lastChange=ba,this.lastSubmorphs=Vc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}}},{key:"refreshTreeView",value:function(){var ba;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Ja){Ja=Ja.node;Ja.target&&(ba=Ja.foldableNode?Ja.target[Ja.foldableNode.key][Ja.key]:
Ja.target[Ja.key],!Vc.obj.equals(ba,Ja.value)&&Ja.refreshProperty&&Ja.refreshProperty(ba))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(ba,Ja){Ja=void 0===Ja?!1:Ja;var ob=this,zb,Nc,yc,Dd,zd,Bd,Ie,Jg,wg,Qh,Vf,Hh,ek,Zh,ml;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hf){switch(Hf.nextAddress){case 1:if(!ob.isUpdating()){Hf.jumpTo(2);break}return Hf.yield(ob.whenUpdated(),2);case 2:zb=Vc.promise.deferred();
Nc=zb.promise;yc=!!ob.target;ob.updateInProgress=Nc;Hf.setCatchFinallyBlocks(4);Ja&&(Dd=Vc.LoadingIndicator.open("connecting to remote..."));if(!Ja){zd=Vc.InspectionTree.forObject(ba,ob);Hf.jumpTo(6);break}return Hf.yield(Vc.RemoteInspectionTree.forObject(ba,ob),7);case 7:zd=Hf.yieldResult;case 6:return Bd=zd,Ie=ob.ui.propertyTree,Hf.yield(Bd.collapse(Bd.root,!1),8);case 8:if(!Bd.root.children){Hf.jumpTo(9);break}return Hf.yield(Bd.collapse(Bd.root.children[0],!1),9);case 9:if(Jg=ob.originalTreeData&&
ob.originalTreeData.diff(Bd)){wg=$jscomp.makeIterator(Jg);for(Qh=wg.next();!Qh.done;Qh=wg.next())Vf=Qh.value,Hh=$jscomp.makeIterator(Vf),ek=Hh.next().value,Zh=Hh.next().value,ek.refreshProperty(Zh.value);Hf.jumpTo(11);break}Ie.treeData=Bd;return Hf.yield(ob.filterProperties(),12);case 12:if(!Ie.treeData.root.isCollapsed){Hf.jumpTo(13);break}return Hf.yield(Ie.onNodeCollapseChanged({node:Bd.root,isCollapsed:!1}),14);case 14:Ie.selectedIndex=1;case 13:return Hf.yield(Ie.execCommand("uncollapse selected node"),
11);case 11:ob.toggleWindowStyle(yc);Dd&&Dd.remove();Hf.leaveTryBlock(5);break;case 4:ml=Hf.enterCatchBlock(),ob.showError(ml);case 5:ob.startStepping(1E3,"refreshAllProperties"),ob.updateInProgress=null,Hf.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(ba){ba=void 0===ba?!0:ba;var Ja=this,ob,zb,Nc,yc,Dd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zd){if(1==zd.nextAddress)return ob=300,yc=Ja.ui.codeEditor.pluginFind(function(Bd){return Bd.runEval}),Dd=Ja.getWindow(),zd.yield(yc.runEval("System.get('@system-env').node"),
2);zd.yieldResult.value?(Nc=[].concat($jscomp.arrayFromIterable(Vc.arr.without(Dd.styleClasses,"local")),["node"]),zb=Vc.DarkTheme.instance):(Nc=["local"].concat($jscomp.arrayFromIterable(Dd?Vc.arr.without(Dd.styleClasses,"node"):[])),zb=Vc.DefaultTheme.instance);yc.theme=zb;ba?(Dd&&Dd.animate({duration:ob,styleClasses:Nc}),Ja.ui.codeEditor.animate({fill:zb.background,duration:ob})):Dd&&(Dd.styleClasses=Nc);Ja.ui.codeEditor.textString=Ja.ui.codeEditor.textString;yc.highlight();zd.jumpToEnd()})}},
{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var ba=this,Ja=Object.assign({type:"text",borderWidth:1,borderColor:Vc.Color.gray,lineWrapping:"by-chars"},Vc.config.codeEditor.defaultStyle,{textString:""}),ob=Vc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Vc.rect(0,0,this.width,30);
var zb=new Vc.SearchField({styleClasses:["idle"],name:"searchField"});ob[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[zb,{type:"button",name:"targetPicker",padding:Vc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Vc.Icon.textAttribute("crosshairs")},new Vc.LabeledCheckBox({label:"Internals",name:"internals"}),new Vc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Vc.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:Vc.InspectionTree.forObject(null,this)})),Vc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},Ja),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Vc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(ob),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(ob),
[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){ba.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var ba=this,Ja,ob,zb,Nc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){switch(yc.nextAddress){case 1:if(ba.env.eventDispatcher.isKeyPressed("Shift"))return ob=$jscomp,zb=ob.makeIterator,yc.yield($world.execCommand("select morph",
{justReturn:!0}),5);ba.toggleSelectionInstructions(!0);return yc.yield(Vc.InteractiveMorphSelector.selectMorph(),4);case 4:Ja=yc.yieldResult;ba.toggleSelectionInstructions(!1);yc.jumpTo(3);break;case 5:Nc=zb.call(ob,yc.yieldResult),Ja=Nc.next().value;case 3:Ja&&(ba.targetObject=Ja),yc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(ba){if(ba&&!this.instructionWidget){var Ja=Vc.morph({type:"label",name:"escapeKey",value:"esc"});Ja.whenRendered().then(function(){return Ja.fit()});
this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},Ja,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",
value:function(ba){ba=ba.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;ba.epiMorph=!0;this.openWidget=ba;Vc.once(ba,"close",this,"closeOpenWidget");Vc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var ba=this.ui.propertyTree,Ja=ba.textLayout.boundsFor(ba,{column:0,row:ba.selectedIndex-1});Ja=ba.worldPoint(Vc.pt(Ja.x,Ja.y+Ja.height/2)).addPt(ba.scroll.negated());ba=ba.globalBounds();
Ja.x=this.globalBounds().center().x;Ja.y<ba.top()?Ja=ba.topCenter():ba.bottom()-20<Ja.y&&(Ja=ba.bottomCenter().addXY(0,-20));return Ja}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(ba){this.layout.row(1).height+=ba.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(ba){if(ba!==
this.isEditorVisible()){var Ja=this.extent,ob=this.layout,zb=this.ui,Nc=zb.terminalToggler,yc=zb.codeEditor,Dd=zb.thisBindingSelector;zb=zb.fixImportButton;ob.disable();ba?(Nc.fontColor=Vc.Color.rgbHex("00e0ff"),ob.row(3).height=this.codeEditorHeight||180,ob.row(2).height=5,zb.animate({visible:!0,duration:200}),Dd.animate({visible:!0,duration:200})):(this.codeEditorHeight=ob.row(3).height,Nc.fontColor=Vc.Color.white,ob.row(3).height=ob.row(2).height=0,zb.animate({visible:!1,duration:200}),Dd.animate({visible:!1,
duration:200}));this.extent=Ja;ob.enable({duration:200});this.relayout({duration:200});yc.focus();yc.animate({opacity:ba?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){ba.makeEditorVisible(!ba.isEditorVisible());Ja.jumpToEnd()})}},{key:"filterProperties",value:function(){var ba=this,Ja,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return Ja=ba.ui.searchField,ob=ba.ui.propertyTree,
ba.originalTreeData||(ba.originalTreeData=ob.treeData),Vc.disconnect(ob.treeData,"onWidgetOpened",ba,"onWidgetOpened"),zb.yield(ob.treeData.filter({maxDepth:2,showUnknown:ba.ui.unknowns.checked,showInternal:ba.ui.internals.checked,iterator:function(Nc){return Ja.matches(Nc.key)}}),2);ob.update();Vc.connect(ob.treeData,"onWidgetOpened",ba,"onWidgetOpened");zb.jumpToEnd()})}},{key:"relayout",value:function(ba){ba=void 0===ba?{}:ba;var Ja=this,ob,zb,Nc,yc,Dd,zd,Bd,Ie,Jg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wg){Ja.layout&&
Ja.layout.forceLayout();ob=Ja;zb=ob.ui;Nc=zb.fixImportButton;yc=zb.terminalToggler;Dd=zb.propertyTree;zd=zb.thisBindingSelector;Bd=Dd.bounds().insetBy(5).bottomLeft();Ie=Dd.bounds().insetBy(5).bottomRight();Jg=Ie.subXY(Nc.width+10,0);zd.width=115;zd.listMorph.itemHeight=20;ba.duration?(yc.animate(Object.assign({bottomLeft:Bd},ba)),Nc.animate(Object.assign({bottomRight:Ie},ba)),zd.animate(Object.assign({bottomRight:Jg},ba))):(yc.bottomLeft=Bd,Nc.bottomRight=Ie,zd.bottomRight=Jg);wg.jumpToEnd()})}},
{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Vb._get(Object.getPrototypeOf(Kb.prototype),"keybindings",this))}},{key:"commands",get:function(){return Vc.inspectorCommands}}],[{key:"className",get:function(){return"Inspector"}},{key:"openInWindow",value:function(ba){ba=new this(ba);ba.openInWindow().activate();return ba}},{key:"properties",
get:function(){return{extent:{defaultValue:Vc.pt(400,500)},fill:{defaultValue:Vc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(ba){this.setProperty("remoteTarget",ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ba,!0))}},targetObject:{after:["submorphs"],set:function(ba){this._serializableTarget=ba&&ba.isMorph?ba.id:ba;this.setProperty("targetObject",ba);this.ui.propertyTree&&
(this.originalTreeData=null,this.prepareForNewTargetObject(ba))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var ba=this.ui.propertyTree,Ja=ba.selectedNode;ba=ba.treeData;return ba.getContextFor(Ja?Ja:ba.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),
thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Vc.Color.gray,
fontSize:14,fontFamily:Vc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],$a,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25406,end:45502})}(Vc.Morph);ue=Vc.Inspector;of=Ca("I",ue);Vc.default=
ue;var dg=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");dg.Inspector=of;dg.string=Ad;dg.Morph=Tb;dg.pt=fe;dg.Color=Cb;ue=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ka,$a,Kb){Kb=void 0===Kb?1:Kb;var ba,Ja,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:return Ka.maybeSelectCommentOrLine(),zb.setCatchFinallyBlocks(2),$a=Object.assign({},$a,{logDoit:!0,inspect:!0,
inspectDepth:Kb}),zb.yield(Ka.doEval(void 0,$a),4);case 4:ba=zb.yieldResult;Ja=ba.error?ba.error:ba.isError?ba.value:null;zb.leaveTryBlock(3);break;case 2:Ja=ob=zb.enterCatchBlock();case 3:return Ja?Ka.showError(Ja):Ka.setStatusMessage(dg.string.truncate(ba.value,1E3)),zb.return(ba)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ka,$a){var Kb,ba,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){switch(ob.nextAddress){case 1:return ob.setCatchFinallyBlocks(2),
ob.yield(Ka.doEval({start:{row:0,column:0},end:Ka.documentEndPosition},Object.assign({},$a,{logDoit:!0})),4);case 4:Kb=ob.yieldResult;ba=Kb.error?Kb.error:Kb.isError?Kb.value:null;ob.leaveTryBlock(3);break;case 2:ba=Ja=ob.enterCatchBlock();case 3:return ba?Ka.showError(ba):Ka.setStatusMessage(String(Kb.value)),ob.return(Kb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ka,$a){var Kb,ba,Ja,ob,zb,Nc,yc,Dd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zd){switch(zd.nextAddress){case 1:return Ka.maybeSelectCommentOrLine(),
zd.setCatchFinallyBlocks(2),$a=Object.assign({},$a,{asString:!1,logDoit:!0}),zd.yield(Ka.doEval(void 0,$a),4);case 4:Kb=zd.yieldResult;ba=Kb.error?Kb.error:Kb.isError?Kb.value:null;zd.leaveTryBlock(3);break;case 2:ba=Ja=zd.enterCatchBlock();case 3:Ka.selection.collapseToEnd();if(ob=Kb.value&&Kb.value.isColor)return Ka.selection.text=String(Kb.value),zb=new dg.Morph({fill:dg.Color.transparent,extent:dg.pt(Ka.fontSize+2,Ka.fontSize+2),submorphs:[{fill:Kb.value,center:dg.pt(Ka.fontSize+2,Ka.fontSize+
2).scaleBy(.5)}]}),Nc=Ka.selection.start,yc=Nc.column,Dd=Nc.row,Ka.insertText([zb,{}],Ka.selection.start),Ka.selection.start={column:yc,row:Dd},zd.return(Kb);Ka.insertTextAndSelect(ba?String(ba)+(ba.stack?"\n"+ba.stack:""):String(Kb.value));return zd.return(Kb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ka,$a){var Kb,ba,Ja,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:debugger;
Ka.maybeSelectCommentOrLine();ba=Ka.textInRange(Ka.selection);Ja=Ka.evalEnvironment||{};ob=Ka.pluginFind(function(Nc){return Nc.isEditorPlugin&&"function"===typeof Nc.runEval});Ja.systemInterface||(Ja.systemInterface=ob.systemInterface($a));if("local"!==Ja.systemInterface.name){zb.jumpTo(2);break}zb.setCatchFinallyBlocks(3);return zb.yield(Ka.doEval(void 0,$a),5);case 5:Kb=zb.yieldResult;ba=Kb.value;zb.leaveTryBlock(2);break;case 3:zb.enterCatchBlock();case 2:return Ka.world().execCommand("open object editor",
{target:ba,evalEnvironment:Ja}),zb.return(Kb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Ka,$a){var Kb,ba,Ja,ob,zb,Nc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){switch(yc.nextAddress){case 1:Ka.maybeSelectCommentOrLine();Ja=Ka.textInRange(Ka.selection);ob=Ka.evalEnvironment||{};zb=Ka.pluginFind(function(Dd){return Dd.isEditorPlugin&&"function"===typeof Dd.runEval});ob.systemInterface||(ob.systemInterface=
zb.systemInterface($a));if("local"!==ob.systemInterface.name){dg.Inspector.openInWindow({remoteTarget:{code:Ja,evalEnvironment:ob}});yc.jumpTo(2);break}yc.setCatchFinallyBlocks(3);return yc.yield(Ka.doEval(void 0,$a),5);case 5:Kb=yc.yieldResult;ba=Kb.error?Kb.error:Kb.isError?Kb.value:null;Ja=Kb.value;yc.leaveTryBlock(4);break;case 3:ba=Nc=yc.enterCatchBlock();case 4:dg.Inspector.openInWindow({targetObject:ba?ba:Ja});case 2:return yc.return(Kb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(Ka,$a,Kb){Kb=void 0===Kb?1:Kb;var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){switch(Ja.nextAddress){case 1:return Ka.maybeSelectCommentOrLine(),Ja.setCatchFinallyBlocks(2),$a=Object.assign({},$a,{inspect:!0,inspectDepth:Kb,logDoit:!0}),Ja.yield(Ka.doEval(void 0,$a),4);case 4:ba=Ja.yieldResult;Ja.leaveTryBlock(3);break;case 2:Ja.enterCatchBlock();case 3:return Ka.selection.collapseToEnd(),Ka.insertTextAndSelect(ba.value),Ja.return(ba)}})}}];dg.codeEvaluationCommands=
ue;dg.codeEvaluationCommands=ue;dg.codeEvaluationCommands=ue;var Gg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Gg.changeAttributeInSelectionOrMorph=function(Ka,$a,Kb){var ba=Ka.selection;Ka.keepPosAtSameScrollOffsetWhile(function(){ba.isEmpty()?Ka[$a]="function"===typeof Kb?Kb(Ka[$a]):Kb:(Ka.undoManager.group(),Ka.changeStyleProperty($a,function(Ja){return"function"===typeof Kb?Kb(Ja):Kb}),Ka.undoManager.group())})};of=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(Ka){var $a=Ka.fontSize;Gg.changeAttributeInSelectionOrMorph(Ka,"fontSize",function(Kb){Kb=Kb||$a;return Kb+(18<=Kb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ka){var $a=Ka.fontSize;Gg.changeAttributeInSelectionOrMorph(Ka,"fontSize",function(Kb){Kb=Kb||$a;return Kb-(18>=Kb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ka){var $a,Kb,ba,Ja,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress){$a=
["serif","sans-serif","monospace"];if(Kb=localStorage["lively.morpic/text-change-font-additional-fonts"])Kb=JSON.parse(Kb),$a.push.apply($a,$jscomp.arrayFromIterable(Kb));$a.map(function(Nc){return Nc.toLowerCase()}).includes(Ka.fontFamily.toLowerCase())||($a.push(Ka.fontFamily),Kb=[].concat($jscomp.arrayFromIterable(Kb||[]),[Ka.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Kb));return zb.yield($world.editListPrompt("choose font",$a,{requester:Ka,preselect:$a.indexOf(Ka.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}ba=zb.yieldResult;Ja=$jscomp.makeIterator(ba.selections);if(ob=Ja.next().value)Ka.fontFamily=ob;return zb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ka,$a){$a=void 0===$a?{}:$a;var Kb,ba,Ja,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress){if($a.hasOwnProperty("link"))return zb.jumpTo(2);ba=Ka.selection;Ja=Ka.getStyleInRange(ba);ob=Ja.link;return zb.yield(Ka.world().prompt("Set link",
{input:ob||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=zb.nextAddress&&(Kb=zb.yieldResult,!Kb))return zb.return();Ka.undoManager.group();Ka.setStyleInRange({link:Kb||void 0},ba);Ka.undoManager.group();zb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ka,$a){var Kb,ba,Ja,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return Kb=Ka.selection,ba=Ka.getStyleInRange(Kb),Ja=ba.doit,zb.yield(Ka.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:Ka,input:Ja?Ja.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ka.evalEnvForDoit(Ja||{})}),2);ob=zb.yieldResult;Ka.undoManager.group();ob?Ka.addTextAttribute({doit:{code:ob},nativeCursor:"pointer",textDecoration:"underline"},Kb):Ka.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Kb);Ka.undoManager.group();zb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ka,$a){$a=void 0===$a?{}:$a;Ka.undoManager.group();
$a=!$a.onlySelection&&Ka.selection.isEmpty()?Ka.documentRange:Ka.selection.range;Ka.setStyleInRange(null,$a);Ka.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ka){var $a,Kb,ba,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){if(1==ob.nextAddress)return ob.yield(System.import("lively.modules"),2);if(3!=ob.nextAddress)return $a=ob.yieldResult,Kb=$a.module,ob.yield(Kb("lively.ide/text/ui.js").load(),3);ba=ob.yieldResult;Ja=ba.RichTextControl;return ob.return(Ja.openFor(Ka))})}}];
Gg.commands=of;Gg.commands=of;Gg.commands=of;var mf=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");mf.guessTextModeName=Sb;mf.rangedToken=function(Ka,$a,Kb,ba,Ja){return{start:{row:Ka,column:$a},end:{row:Ka,column:Kb},token:ba,mode:Ja}};mf.fun=mc;mf.arr=lc;mf.connect=Uc;mf.disconnect=Xb;mf.DefaultTheme=Mb;mf.tokenizeDocument=pb;mf.modeInfo=Ha;mf.visitDocumentTokens=Mc;mf.getMode=jc;mf.completionCommands=ta;mf.multiSelectCommands=Rc;mf.navCommands=oe;mf.codeCommands=Df;mf.codeEvaluationCommands=
ue;mf.richTextCommands=of;mf.Color=Cb;mf.Range=ee;mf.guessTextModeName=Sb;mf.guessTextModeName=Sb;Mb=function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Kb=$a.hasOwnProperty("EditorPlugin")&&"function"===typeof $a.EditorPlugin?$a.EditorPlugin:$a.EditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
mf.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(ba){var Ja=this;this.textMorph=ba;mf.connect(ba,"textChange",this,"onTextChange");mf.connect(ba,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Ja.highlight()})}},
{key:"detach",value:function(ba){mf.disconnect(ba,"textChange",this,"onTextChange");mf.disconnect(ba,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(ba){this._ast=null;if(ba){var Ja=this._tokenizerValidBefore;if("replace"===ba.selector){var ob=ba.args[0].start;ba=ob.row;ob=ob.column}else ob=ba=0;if(!Ja||ba<Ja.row||ba===Ja.row&&ob<Ja.column)ba=Math.max(0,ba),this._tokenizerValidBefore={row:ba,
column:ob}}this.requestHighlight()}},{key:"requestHighlight",value:function(ba){var Ja=this;(void 0===ba?0:ba)?this.highlight():mf.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return Ja.highlight()})()}},{key:"highlight",value:function(){var ba=this.textMorph,Ja=this.theme,ob=this.mode,zb=this._tokenizerValidBefore;if(Ja&&ba&&ba.document&&ob){ba.fill=Ja.background;ba.cursorColor=Ja.cursorColor||mf.Color.black;var Nc=ba.viewState,yc={};zb=mf.tokenizeDocument(ob,ba.document,Nc.firstVisibleRow,
Nc.lastVisibleRow,zb);ob=zb.lines;zb=zb.tokens;if(ob.length){Nc=ob[0].row;for(var Dd=[],zd=0;zd<zb.length;Nc++,zd++)for(var Bd=zb[zd],Ie=0;Ie<Bd.length;Ie+=5){var Jg=Bd[Ie],wg=Bd[Ie+1],Qh=Ja[Bd[Ie+2]]||Ja.default;Qh&&Dd.push({start:{row:Nc,column:Jg},end:{row:Nc,column:wg}},Qh)}ba.embeddedMorphs.forEach(function(Vf){var Hh=ba.embeddedMorphMap.get(Vf).anchor;yc[Vf.id]=ba.textAttributeAt(Hh.position)});ba.setTextAttributesWithSortedRanges(Dd);ba.embeddedMorphs.forEach(function(Vf){var Hh=ba.embeddedMorphMap.get(Vf).anchor;
Hh=mf.Range.at(Hh.position);Hh.end.column+=1;ba.replace(Hh,[Vf,yc[Vf.id]],!1)});this._tokenizerValidBefore={row:mf.arr.last(ob).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},ba,this)}}},{key:"visitTokensInRange",value:function(ba,Ja){var ob=ba.start,zb=ba.end,Nc=ob.row-1;mf.visitDocumentTokens(this.mode,this.textMorph.document,ob.row,zb.row,null,function(yc){return Nc++},function(yc,Dd,zd,Bd,Ie,Jg,wg){if(Nc===ob.row&&0<ob.column){if(ob.column>=Bd)return;zd<ob.column&&ob.column<
Bd&&(zd=ob.column)}if(Nc===zb.row){if(zb.column<=zd)return;zd<zb.column&&zb.column<Bd&&(Bd=zb.column)}Ja(yc,Dd,Nc,zd,Bd,Ie,Jg,wg)})}},{key:"tokensInRange",value:function(ba){var Ja=[];this.visitTokensInRange(ba,function(ob,zb,Nc,yc,Dd,zd,Bd,Ie){return Ja.push(mf.rangedToken(Nc,yc,Dd,ob,Ie))});return Ja}},{key:"tokensOfRow",value:function(ba){var Ja=this.textMorph.getLine(ba).length;return this.tokensInRange({start:{row:ba,column:0},end:{row:ba,column:Ja}})}},{key:"tokenAt",value:function(ba){for(var Ja=
this.tokensOfRow(ba.row),ob=Ja.length;ob--;){var zb=Ja[ob];if(zb.token&&zb.start.column<=ba.column&&ba.column<=zb.end.column)return zb}return null}},{key:"getCommands",value:function(ba){return[].concat($jscomp.arrayFromIterable(ba),$jscomp.arrayFromIterable(mf.completionCommands),$jscomp.arrayFromIterable(mf.multiSelectCommands),$jscomp.arrayFromIterable(mf.navCommands),$jscomp.arrayFromIterable(mf.codeCommands),$jscomp.arrayFromIterable(mf.codeEvaluationCommands),$jscomp.arrayFromIterable(mf.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var ba=this.mode,Ja=ba.lineComment,ob=ba.blockCommentStart;ba=ba.blockCommentEnd;var zb={};Ja&&(zb.lineCommentStart=Ja);ob&&(zb.blockCommentStart=ob);ba&&(zb.blockCommentEnd=ba);return zb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(ba,Ja,ob){var zb=this.textMorph,Nc=ba.row,yc=ba.column;ba=Ja[yc-1];Ja=Ja[yc];zb.selection.text="\n";zb.selection.collapseToEnd();
"{"===ba&&"}"===Ja&&(zb.selection.text="\n"+" ".repeat(ob),zb.selection.collapse());zb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Nc+1,lastRow:Nc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var ba=this.textMorph,Ja=this.openPairs,ob=ba.selection,zb=ba.getLine(ob.end.row),
Nc=zb[ob.end.column-1];zb=zb[ob.end.column];ba.autoInsertPairs&&ob.isEmpty()&&Nc in Ja&&zb===Ja[Nc]&&(ob.growRight(1),ob.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(ba){var Ja=this.openPairs,ob=this.closePairs,zb=this.textMorph,Nc=zb.selection,yc=zb.autoInsertPairs&&ba in Ja,Dd=zb.autoInsertPairs&&ba in ob;if(!yc&&!Dd)return!1;var zd=zb.getLine(Nc.end.row)[Nc.end.column];if(!Nc.isEmpty()){if(!yc)return!1;ob=zb.undoManager.ensureNewGroup(zb);zb.insertText(Ja[ba],Nc.end);zb.insertText(ba,
Nc.start);zb.undoManager.group(ob);Nc.growRight(-1);return!0}if(zd in ob&&ba===zd)return Nc.goRight(1),!0;if(Dd&&!yc)return!1;ob=zb.undoManager.ensureNewGroup(zb);zb.insertText(ba+Ja[ba]);zb.undoManager.group(ob);Nc.goLeft(1);return!0}}],[{key:"className",get:function(){return"EditorPlugin"}}],$a,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:3088,end:11936})}(void 0);Ha=Mb=mf.EditorPlugin;ta=Ca("C",function(Ka){var $a=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Kb=$a.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof $a.CodeMirrorEnabledEditorPlugin?$a.CodeMirrorEnabledEditorPlugin:$a.CodeMirrorEnabledEditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(Kb,Ka,[{key:Symbol.for("lively-instance-initialize"),
value:function(){Vb._get(Object.getPrototypeOf(Kb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(ba){this.mode=this.codeMirrorMode(ba);return Vb._get(Object.getPrototypeOf(Kb.prototype),"attach",this).call(this,ba)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(ba){return{indentWithTabs:!ba.useSoftTabs,indentUnit:ba.tabWidth,
tabSize:4}}},{key:"codeMirrorMode",value:function(ba){ba=this.defaultCodeMirrorModeConfig(ba);return mf.getMode(ba,{name:this.longName})}}],[{key:"className",get:function(){return"CodeMirrorEnabledEditorPlugin"}}],$a,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(mf.EditorPlugin));
mf.CodeMirrorEnabledEditorPlugin=ta;mf.CodeMirrorEnabledEditorPlugin=ta;mf.CodeMirrorEnabledEditorPlugin=ta;mf.default=Mb;Mb=Object.freeze({__proto__:null,guessTextModeName:Sb,"default":Ha,CodeMirrorEnabledEditorPlugin:ta});Ca("e",Mb)}}});
System.register(["./__root_module__-cddb8267.js","./index-51795659.js","./index-d91b3b8e.js"],function(Ea){var Cb,Kb,lc,$b,Qd,Zc,Rd,ad,Nc,nd,he,af,Af,rd,cc,Ic,Kd,Kc,Bd,be,yc,Cc,Pb,Dc,Xc,Cd,Od,Gb,sb,Bc,gb,rb,Sa,Ua,cb,ab,qb,Zb,kc,Rb,ma,Ia,W,sa,Za;return{setters:[function(mb){Cb=mb.C;Kb=mb.aw;lc=mb.a6;$b=mb.a1;Qd=mb.a3;Zc=mb.ab;Rd=mb.bj;ad=mb.aX;Nc=mb.au;nd=mb.a7;he=mb.aR;af=mb.bn;Af=mb.bo;rd=mb.a8;cc=mb.aj;Ic=mb.at;Kd=mb.av;Kc=mb.bp;Bd=mb.bq;be=mb.a2;yc=mb.P;Cc=mb.$;Pb=mb.aZ;Dc=mb.an;Xc=mb.ao;Cd=
mb.ap;Od=mb.aq;Gb=mb.aD;sb=mb.b0;Bc=mb.az;gb=mb.as;rb=mb.ad;Sa=mb.br;Ua=mb.L;cb=mb.bs;ab=mb.b5;qb=mb.bk;Zb=mb.b4;kc=mb.bt;Rb=mb.ax},function(mb){ma=mb.M;Ia=mb.I;W=mb.v;sa=mb.p},function(mb){Za=mb.localInterface}],execute:function(){function mb(Ha,Ta){if(!0===Ta)return Ta;if(Ha.copyState)return Ha.copyState(Ta);Ha={};for(var Db in Ta){var da=Ta[Db];da instanceof Array&&(da=da.concat([]));Ha[Db]=da}return Ha}function rc(Ha,Ta,Db){return Ha.startState?Ha.startState(Ta,Db):!0}function xd(Ha,Ta){return ob.modes[Ha]=
Ta}function sc(Ha){if("string"==typeof Ha&&ob.mimeModes.hasOwnProperty(Ha))Ha=ob.mimeModes[Ha];else if(Ha&&"string"==typeof Ha.name&&ob.mimeModes.hasOwnProperty(Ha.name)){var Ta=ob.mimeModes[Ha.name];"string"==typeof Ta&&(Ta={name:Ta});Ha=Object.assign({},Ta,Ha);Ha.name=Ta.name}else{if("string"==typeof Ha&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ha))return sc("application/xml");if("string"==typeof Ha&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ha))return sc("application/json")}return"string"==typeof Ha?{name:Ha}:Ha||
{name:"null"}}function Na(Ha,Ta){Ta=ob.resolveMode(Ta);"string"===typeof Ta&&(Ta={name:Ta});if(!Ta.name)throw Error("parserConfig does not have a name of the mode to get");var Db=ob.modes[Ta.name];if(!Db)return Na(Ha,"text/plain");Ha=Object.assign({indentUnit:2},Ha);return Object.assign(Db(Ha,Ta),{name:Ta.name})}function Xd(Ha,Ta){for(var Db;Ha.innerMode;){Db=Ha.innerMode(Ta);if(!Db||Db.mode==Ha)break;Ta=Db.state;Ha=Db.mode}return Db||{mode:Ha,state:Ta}}function Gd(Ha,Ta){ob.mimeModes[Ha]=Ta}function td(Ha,
Ta,Db){}function Ib(Ha,Ta,Db,da,Fa,jb,zb){var zc=Ha.editorPlugin._tokenizerValidBefore;zc&&zc.row>=Db&&(zc.row=Db-1);var wc=ob.linesToTokenize(Ha.document,Db,da,zc);zc=wc.lines;wc=wc.state;if(!zc.length)return!1;wc=wc?ob.copyState(Ta,wc):ob.startState(Ta);for(var id=0;id<zc.length;id++){var qd=zc[id],cd=qd.row;cd>=Db&&cd<=da&&ob.indentLine(Ha,Ta,qd,wc,Fa,jb,zb);wc=ob.tokenizeLine(Ta,zc[id],wc,function(){})}return!0}function jc(Ha,Ta,Db,da,Fa,jb,zb){Ta=ob.linesToTokenize(Ta,Db,da,Fa);Db=Ta.lines;ob.tokenizeLines(Ha,
Db,Ta.state,jb,zb);return Db}function tb(Ha,Ta,Db,da,Fa){var jb=[],zb,zc=function(qd){return jb.push(zb=[])},wc=function(qd,cd,of,mg,Yf,pf,wi){return zb.push(of,mg,qd,Yf.current(),cd.localMode||wi)};try{var id=ob.visitDocumentTokens(Ha,Ta,Db,da,Fa,zc,wc)}catch(qd){jb.length=0,id=ob.visitDocumentTokens(Ha,Ta,Db,da,null,zc,wc)}return{tokens:jb,lines:id}}function Sc(Ha,Ta,Db,da,Fa){null==Ta&&(Ta=Ha.search(/[^\s\u00a0]/),-1==Ta&&(Ta=Ha.length));da=da||0;for(Fa=Fa||0;;){var jb=Ha.indexOf("\t",da);if(0>
jb||jb>=Ta)return Fa+(Ta-da);Fa+=jb-da;Fa+=Db-Fa%Db;da=jb+1}}function vd(Ha){Ha=Ha.toLowerCase();for(var Ta=0;Ta<ob.modeInfo.length;Ta++){var Db=ob.modeInfo[Ta];if(Db.mime==Ha)return Db;if(Db.mimes)for(var da=0;da<Db.mimes.length;da++)if(Db.mimes[da]==Ha)return Db}if(/\+xml$/.test(Ha))return vd("application/xml");if(/\+json$/.test(Ha))return vd("application/json")}function nb(Ha){for(var Ta=0;Ta<ob.modeInfo.length;Ta++){var Db=ob.modeInfo[Ta];if(Db.ext)for(var da=0;da<Db.ext.length;da++)if(Db.ext[da]==
Ha)return Db}}function vb(Ha){for(var Ta=0;Ta<ob.modeInfo.length;Ta++){var Db=ob.modeInfo[Ta];if(Db.file&&Db.file.test(Ha))return Db}Ta=Ha.lastIndexOf(".");if(Ha=-1<Ta&&Ha.substring(Ta+1,Ha.length))return ob.findModeByExtension(Ha)}function yb(Ha){Ha=Ha.toLowerCase();for(var Ta=0;Ta<ob.modeInfo.length;Ta++){var Db=ob.modeInfo[Ta];if(Db.name.toLowerCase()==Ha)return Db;if(Db.alias)for(var da=0;da<Db.alias.length;da++)if(Db.alias[da].toLowerCase()==Ha)return Db}}function yd(Ha){if(!Ha)return String(Ha);
if(Array.isArray(Ha))return"["+Ha.map(yd).join(",")+"]";if("symbol"===typeof Ha)return $c.printSymbol(Ha);try{return String(Ha)}catch(Ta){return"Cannot print object: "+Ta}}function ae(Ha,Ta){return!$c.arr.every(Ta.map(function(Db){return Ha[Db]}),function(Db){return $c.obj.equals(Db,Ha&&Ha.valueOf())})}function He(Ha){if($c.obj.isPrimitive(Ha))var Ta=$c.string.print(Ha);else Array.isArray(Ha)?((Ta=3<Ha.length)&&(Ha=Ha.slice(0,3)),Ha=$c.string.print(Ha),Ta&&(Ha=Ha.slice(0,-1)+", ...]"),Ta=Ha):Ta=$c.string.print(Ha);
Ta=Ta.replace(/\n/g,"");500<Ta.length&&(Ta=Ta.slice(0,20)+("...["+(Ta.length-20)+' CHARS]"'));return Ta}function Fc(Ha){return ac.Inspector.openInWindow({targetObject:Ha})}function oe(Ha,Ta){return ac.Inspector.openInWindow({remoteTarget:{code:Ha,evalEnvironment:Ta}})}function ed(Ha,Ta){function Db(zc){var wc=zc.name,id=zc.ownerChain(),qd=zc.owner,cd=zc.world(),of;zc===jb&&(of=[zb]);cd===zc&&(of=["$world"]);if(!of&&wc&&qd){qd===cd&&1===ac.arr.count(ac.arr.pluck(cd.submorphs,"name"),wc)&&(of=['$world.get("'+
wc+'")']);if(!of&&qd!=cd)for(cd=id.length-1;cd--;)if(1===id[cd].getAllNamed(wc).length){of=[].concat($jscomp.arrayFromIterable(Db(id[cd])),['get("'+wc+'")']);break}of||(wc=[].concat($jscomp.arrayFromIterable(Db(qd)),['get("'+wc+'")']),ac.syncEval(wc.join("."),{context:jb}).value===zc&&(of=wc))}of||(of=[zb+'.getMorphById("'+zc.id+'")']);return of}Ta=void 0===Ta?{}:Ta;var da=Ha.world(),Fa=Ta;Ta=void 0===Fa.maxLength?10:Fa.maxLength;var jb=void 0===Fa.fromMorph?da:Fa.fromMorph;if(jb===Ha)return"this";
var zb=da===jb?"$world":"this";if(!(da||Ha.name&&jb.get(Ha.name)===Ha))return"morph";da=Db(Ha);return da.length>Ta?'$world.getMorphWithId("'+Ha.id+'")':da.join(".")}function te(Ha,Ta,Db){var da=(Ta=void 0===Ta?"":Ta)&&Ve.arr.last(Ta.split(".")).toLowerCase(),Fa="",jb=0,zb=Math.pow(2,19);if("string"===typeof Ha){if(Ha.length>zb)return null}else if(Ha.document.stringSize>zb)return null;if("string"===typeof Ha)Fa=Ha.slice(0,1E3);else for(Ha=$jscomp.makeIterator(Ha.document.lines),zb=Ha.next();!zb.done;zb=
Ha.next()){var zc=zb.value;zb=zc.stringSize;zc=zc.text;var wc=!0;1E3<jb+zb&&(wc=!1,zb=1E3-jb);Fa+=zc.slice(0,zb)+(wc?"\n":"");jb+=zb;if(1E3<=jb)break}jb=$jscomp.makeIterator(Ve.modeInfo);for(Ha=jb.next();!Ha.done;Ha=jb.next()){wc=Ha.value;zb=wc.contentTest;Ha=wc.mode;zc=wc.ext;wc=wc.file;if("function"===typeof zb)try{if(zb(Fa))return Ha}catch(id){}if(wc&&wc instanceof RegExp&&wc.test(Ta))return Ha;if(zc)for(zb=$jscomp.makeIterator(zc),zc=zb.next();!zc.done;zc=zb.next())if(zc.value===da)return Ha}return Db}
Ea({a:Gd,d:xd,r:td});var wa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");wa.Color=Cb;var fb=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Db=Ta.hasOwnProperty("DefaultTheme")&&"function"===typeof Ta.DefaultTheme?Ta.DefaultTheme:Ta.DefaultTheme=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:"background",get:function(){return wa.Color.white}},
{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:wa.Color.white,fontWeight:"bold",backgroundColor:wa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:wa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:wa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ta,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Va=fb=wa.DefaultTheme;wa.default=fb;var ob=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");ob.copyState=mb;ob.startState=rc;ob.defineMode=xd;ob.resolveMode=sc;ob.getMode=Na;ob.innerMode=Xd;ob.defineMIME=Gd;ob.registerHelper=td;ob.indentLines=Ib;ob.indentLine=function(Ha,Ta,Db,da,Fa,jb,zb){zb=Object.assign({indentWithTabs:!Ha.useSoftTabs,indentUnit:Ha.tabWidth,tabSize:4,ignoreFollowingText:!1},
zb);null==Fa&&(Fa="add");"smart"==Fa&&(Ta.indent||(Fa="prev"));var zc=zb.tabSize,wc=Db.text,id=ob.countColumn(wc,null,zc);Db.modeState&&(Db.modeState=null);var qd=wc.match(/^\s*/)[0];if(!jb&&!/\S/.test(wc)){var cd=0;Fa="not"}else if("smart"==Fa&&(cd=Ta.indent(da,zb.ignoreFollowingText?"":wc.slice(qd.length),wc),cd==ob.passIndent||150<cd)){if(!jb)return;Fa="prev"}"prev"==Fa?cd=0<Db.row?ob.countColumn(Db.prevLine().text,null,zc):0:"add"==Fa?cd=id+zb.indentUnit:"subtract"==Fa?cd=id-zb.indentUnit:"number"==
typeof Fa&&(cd=id+Fa);cd=Math.max(0,cd);Ta="";da=0;if(zb.indentWithTabs)for(zb=Math.floor(cd/zc);zb;--zb)da+=zc,Ta+="\t";da<cd&&(Ta+=" ".repeat(cd-da));if(Ta!=qd)return Ha.replace({start:{row:Db.row,column:0},end:{row:Db.row,column:qd.length}},Ta),!0};ob.tokenizeLines=function(Ha,Ta,Db,da,Fa){if(Ta.length){Db=Db?ob.copyState(Ha,Db):ob.startState(Ha);for(var jb=0;jb<Ta.length;jb++){var zb=Ta[jb];da(zb);Db=ob.tokenizeLine(Ha,zb,Db,Fa)}}};ob.tokenizeLine=function(Ha,Ta,Db,da){var Fa=Ta.text;if(!Fa)return Db;
var jb=new ob.StringStream(Fa,2);Db=Ta.modeState="function"===typeof Ha.copyState?Ha.copyState(Db):ob.copyState(Ha,Db);Ta.prevLine();for(Db._string=Fa;!jb.eol();)Fa=Ha.token(jb,Db),da(Fa,Db,jb.start,jb.pos,jb,Ta,Ha),jb.start=jb.pos;return Db};ob.printTokens=function(Ha){for(var Ta="",Db=0;Db<Ha.length;Db+=5)Ta+=Ha[Db+0]+" => "+Ha[Db+1]+" "+Ha[Db+2]+" "+Ha[Db+3]+" "+Ha[Db+4].name+"\n";return Ta};ob.visitDocumentTokens=jc;ob.tokenizeDocument=tb;ob.linesToTokenize=function(Ha,Ta,Db,da){if(da&&da.row>=
Db)return{lines:[],state:null};Ta=da?Math.max(0,da.row-1):Ta;var Fa=Ha.getLine(Ta),jb=Fa.text;Ha=[Fa];da=null;for(var zb=0,zc;(zc=Fa.prevLine())&&50>zb++;){Fa=zc;if(Fa.modeState){da=Fa.modeState;break}Ha.unshift(Fa)}if(!da){for(var wc=Fa,id=Infinity;(zc=Fa.prevLine())&&100>zb++;){Fa=zc;if(Fa.modeState){da=Fa.modeState;break}Ha.unshift(Fa);zc=jb.match(/^\s*/)[0].length;if(0===zc)break;zc<id&&(id=zc,wc=Fa)}!da&&0<id&&(Ha=Ha.slice(Ha.indexOf(wc)))}if(Db>Ta)for(Fa=ob.arr.last(Ha);Ta<=Db;Ta++){Fa=Fa.nextLine();
if(!Fa)break;Ha.push(Fa)}return{lines:Ha,state:da}};ob.countColumn=Sc;ob.findModeByMIME=vd;ob.findModeByExtension=nb;ob.findModeByFileName=vb;ob.findModeByName=yb;ob.arr=lc;fb=ob.modes||{};ob.modes=fb;ob.modes=fb;ob.modes=fb;fb=Ea("p",{});ob.passIndent=fb;ob.passIndent=fb;ob.passIndent=fb;ob.copyState=mb;ob.copyState=mb;ob.startState=rc;ob.startState=rc;ob.defineMode=xd;ob.defineMode=xd;ob.resolveMode=sc;ob.resolveMode=sc;ob.getMode=Na;ob.getMode=Na;ob.innerMode=Xd;ob.innerMode=Xd;fb={};ob.mimeModes=
fb;ob.mimeModes=fb;ob.mimeModes=fb;ob.defineMIME=Gd;ob.defineMIME=Gd;ob.registerHelper=td;ob.registerHelper=td;ob.indentLines=Ib;ob.indentLines=Ib;ob.visitDocumentTokens=jc;ob.visitDocumentTokens=jc;ob.tokenizeDocument=tb;ob.tokenizeDocument=tb;ob.countColumn=Sc;ob.countColumn=Sc;(function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Db=Ta.hasOwnProperty("StringStream")&&"function"===typeof Ta.StringStream?Ta.StringStream:Ta.StringStream=function(da){da&&da[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da,Fa){this.reset(da,Fa)}},{key:"reset",value:function(da,Fa){this.pos=this.start=0;this.string=void 0===da?"":da;this.tabSize=void 0===Fa?2:Fa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||
void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(da){var Fa=this.string.charAt(this.pos);if("string"==typeof da?Fa==da:Fa&&(da.test?da.test(Fa):da(Fa)))return++this.pos,Fa}},{key:"eatWhile",value:function(da){for(var Fa=this.pos;this.eat(da););return this.pos>Fa}},{key:"eatSpace",value:function(){for(var da=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>da}},{key:"skipToEnd",
value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(da){da=this.string.indexOf(da,this.pos);if(-1<da)return this.pos=da,!0}},{key:"backUp",value:function(da){this.pos-=da}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=ob.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?ob.countColumn(this.string,this.lineStart,this.tabSize):
0)}},{key:"indentation",value:function(){return ob.countColumn(this.string,null,this.tabSize)-(this.lineStart?ob.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(da,Fa,jb){if("string"==typeof da){var zb=function(wc){return jb?wc.toLowerCase():wc},zc=this.string.substr(this.pos,da.length);if(zb(zc)==zb(da))return!1!==Fa&&(this.pos+=da.length),!0}else{if((da=this.string.slice(this.pos).match(da))&&0<da.index)return null;da&&!1!==Fa&&(this.pos+=da[0].length);return da}}},
{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(da,Fa){this.lineStart+=da;try{return Fa()}finally{this.lineStart-=da}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],Ta,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:10431,end:12920})})(void 0);fb=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",
ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",
mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",
mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ha){return Ha.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",
file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",
ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",
mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",
mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",
ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},
{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},
{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},
{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",
mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},
{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",
ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",
mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Ha){return Ha.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",
mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",
mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",
mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn",
"ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",
mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",
ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];ob.modeInfo=fb;ob.modeInfo=fb;ob.modeInfo=fb;for(var P=0;P<ob.modeInfo.length;P++)ob.info=
ob.modeInfo[P],ob.info.mimes&&(ob.info.mime=ob.info.mimes[0]);ob.defineMode("null",function(){return{token:function(Ha){return Ha.skipToEnd()}}});ob.defineMIME("text/plain","null");ob.findModeByMIME=vd;ob.findModeByMIME=vd;ob.findModeByExtension=nb;ob.findModeByExtension=nb;ob.findModeByFileName=vb;ob.findModeByFileName=vb;ob.findModeByName=yb;ob.findModeByName=yb;var ua=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");ua.Color=Cb;ua.Rectangle=$b;ua.pt=Qd;ua.morph=Zc;ua.ShadowObject=
Rd;ua.StyleSheet=ad;ua.connect=Nc;ua.arr=lc;ua.string=nd;ua.FilterableList=he;ua.Range=af;P=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Db=Ta.hasOwnProperty("Completer")&&"function"===typeof Ta.Completer?Ta.Completer:Ta.Completer=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"Completer"}}],Ta,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);ua.Completer=P;ua.Completer=P;ua.Completer=P;P=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Db=Ta.hasOwnProperty("WordCompleter")&&
"function"===typeof Ta.WordCompleter?Ta.WordCompleter:Ta.WordCompleter=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:"compute",value:function(da,Fa){var jb=[],zb=[],zc=da.document.lineStrings;da=da.cursorPosition.row;for(var wc=da-1;0<=wc;wc--)for(var id=$jscomp.makeIterator(zc[wc].split(/[^0-9a-z@_]+/i)),qd=id.next();!qd.done;qd=id.next())(qd=qd.value)&&!jb.includes(qd)&&qd!==Fa&&(jb.push(qd),
zb.push({priority:1E3-(da-wc),completion:qd}));for(wc=da+1;wc<zc.length;wc++)for(id=$jscomp.makeIterator(zc[wc].split(/[^0-9a-z_@]+/i)),qd=id.next();!qd.done;qd=id.next())(qd=qd.value)&&!jb.includes(qd)&&qd!==Fa&&(jb.push(qd),zb.push({priority:1E3-(wc-da),completion:qd}));return zb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Ta,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);ua.WordCompleter=P;ua.WordCompleter=P;ua.WordCompleter=P;P=[new ua.WordCompleter];ua.defaultCompleters=P;ua.defaultCompleters=P;ua.defaultCompleters=P;P=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Db=Ta.hasOwnProperty("CompletionController")&&"function"===typeof Ta.CompletionController?Ta.CompletionController:Ta.CompletionController=function(da){da&&da[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da,Fa){Fa=void 0===Fa?[]:Fa;this.textMorph=da;this.completers=Fa=da.pluginCollect("getCompleters",Fa)}},{key:"computeCompletions",value:function(da){var Fa=this,jb,zb,zc,wc,id,qd,cd,of,mg,Yf,pf,wi,Rh,Oj,ii,bl;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wg){switch(wg.nextAddress){case 1:jb=[],zb=$jscomp.makeIterator(Fa.completers),zc=zb.next();
case 2:if(zc.done){wg.jumpTo(4);break}wc=zc.value;wg.setCatchFinallyBlocks(5);id=jb;qd=id.concat;return wg.yield(wc.compute(Fa.textMorph,da),7);case 7:jb=qd.call(id,wg.yieldResult);wg.leaveTryBlock(3);break;case 5:cd=wg.enterCatchBlock(),console.warn("Error in completer "+wc+": "+(cd.stack||cd));case 3:zc=zb.next();wg.jumpTo(2);break;case 4:of=new Map;jb.forEach(function(nk){var Ui=of.get(nk.completion);Ui||(Ui=[],of.set(nk.completion,Ui));Ui.push(nk)});mg=[];Yf=$jscomp.makeIterator(of.values());
for(pf=Yf.next();!pf.done;pf=Yf.next())wi=pf.value,mg.push(ua.arr.last(ua.arr.sortByKey(wi,"priority")));Rh=0;Oj=ua.arr.sortByKey(mg,"priority").reverse();ii=Oj.length&&Oj[0].priority||0;bl=Oj.map(function(nk){nk.highestPriority=ii;var Ui=nk.completion.replace(/\n/g,""),Bk=String((nk.info||"").replace(/\n/g,""));Rh=Math.max(Rh,Ui.length+Bk.length);return{isListItem:!0,string:Ui,annotation:Bk,value:nk}});return wg.return({items:bl,maxCol:Rh})}})}},{key:"computeSortedCompletions",value:function(da,
Fa){Fa=void 0===Fa?!1:Fa;var jb=this,zb,zc,wc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(id){if(1==id.nextAddress)return zb={tokens:[da],lowercasedTokens:[da],input:da},id.yield(jb.computeCompletions(da),2);zc=id.yieldResult;wc=ua.arr.sortBy(zc.items.filter(function(qd){return jb.filterFunction(zb,qd,Fa)}),function(qd){return jb.sortFunction(zb,qd)});return id.return(wc)})}},{key:"_printCompletions",value:function(da){var Fa=this,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==
zb.nextAddress)return zb.yield(Fa.computeSortedCompletions(da),2);jb=zb.yieldResult.map(function(zc){return{completion:zc.value.completion,priority:zc.value.priority,maxP:zc.value.highestPriority,sortVal:zc._cache[da].sortVal,lev:JSON.stringify(zc._cache[da].levenshtein)}});return zb.return(ua.string.printTable(lively.lang.grid.tableFromObjects(jb)))})}},{key:"prefix",value:function(){var da=this.textMorph,Fa=da.selection;return(Fa.isEmpty()?da.getLine(Fa.lead.row).slice(0,Fa.lead.column):Fa.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(da,Fa,jb){jb=void 0===jb?!1:jb;Fa._cache||(Fa._cache={});var zb=da.tokens,zc=da.lowercasedTokens,wc=da.input;wc=Fa._cache[wc]||(Fa._cache[wc]={});if(wc.hasOwnProperty("filtered"))return wc.filtered;Fa=Fa.value.completion.replace(/\([^\)]*\)$/,"");var id=Fa.toLowerCase();if(jb&&zb[0]&&!Fa.startsWith(zb[0]))return wc.filtered=!1;if(zc.every(function(cd){return id.includes(cd)}))return!0;var qd=wc.levenshtein||(wc.levenshtein={});da=jb||3>=ua.arr.sum(da.lowercasedTokens.map(function(cd){return qd[cd]||
(qd[cd]=ua.string.levenshtein(id,cd))}));return wc.filtered=da}},{key:"sortFunction",value:function(da,Fa){Fa._cache||(Fa._cache={});var jb=Fa._cache[da.input]||(Fa._cache[da.input]={});if(jb.hasOwnProperty("sortVal"))return jb.sortVal;jb=Fa._cache[da.input]={};var zb=Fa.value;Fa=zb.highestPriority;var zc=zb.completion;zb=zb.priority;zc=zc.replace(/\([^\)]*\)$/,"").toLowerCase();var wc=0;da.lowercasedTokens.forEach(function(qd){zc.startsWith(qd)?wc+=12:3<=qd.length&&zc.includes(qd)&&(wc+=5)});Fa=
-((zb||(wc?Fa:0))/Math.pow(10,String(Fa).length-2))-wc;var id=jb.levenshtein||(jb.levenshtein={});da=ua.arr.sum(da.lowercasedTokens.map(function(qd){return id[qd]||(id[qd]=ua.string.levenshtein(zc,qd))}));wc&&(da/=2);return jb.sortVal=da+Fa}},{key:"positionForMenu",value:function(){var da=this.textMorph,Fa=da.charBoundsFromTextPosition(da.cursorPosition);return da.getGlobalTransform().transformRectToRect(Fa).topLeft().addXY(-da.scroll.x,-da.scroll.y).addPt(ua.pt(da.borderWidth+4,da.borderWidth+4))}},
{key:"completionListSpec",value:function(){var da=this,Fa,jb,zb,zc,wc,id,qd,cd,of,mg,Yf,pf,wi,Rh,Oj,ii,bl,wg,nk,Ui;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bk){if(1==Bk.nextAddress)return jb=Fa=da.textMorph,zb=jb.fontSize,zc=jb.fontFamily,wc=da.positionForMenu(),id=da.prefix(),Bk.yield(da.computeCompletions(id),2);qd=Bk.yieldResult;cd=qd.items;of=qd.maxCol;mg=Fa.env.fontMetric.sizeFor(zc,zb,"M");Yf=mg.width*of;pf=Fa.document.getLine(0).height;wi=Math.max(120,Yf<Fa.width?Yf:Fa.width);
Rh=pf*cd.length+pf+10;Oj=Math.max(70,Math.min(700,Rh));ii=wc.extent(ua.pt(wi,Oj));if(bl=Fa.world())wg=bl.visibleBounds().insetBy(5),ii.bottom()>wg.bottom()&&(nk=ii.bottom()-wg.bottom(),nk>ii.height-50&&(nk=ii.height-50),ii.height-=nk),ii.right()>wg.right()&&(Ui=ii.right()-wg.right(),ii.width=120>ii.width-Ui?120:ii.width-Ui),wg.containsRect(ii)||(ii=ii.withTopLeft(wg.translateForInclusion(ii).topLeft())),ii=ii.translatedBy(wg.insetBy(0).topLeft().negated());return Bk.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:zb,position:ii.topLeft(),extent:ii.extent(),items:cd,input:id,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:da.filterFunction,sortFunction:da.sortFunction})})}},{key:"removeMenuOnBlur",value:function(da){var Fa=da.menu;setTimeout(function(){Fa.withAllSubmorphsDetect(function(jb){return jb.isFocused()})?Fa.inputMorph.focus():Fa.remove()})}},{key:"openCompletionList",value:function(){var da=this,Fa,jb,zb,zc,wc,id,qd,cd,
of,mg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yf){if(1==Yf.nextAddress)return Fa=da.textMorph.selection.start,Yf.yield(da.completionListSpec(),2);if(3!=Yf.nextAddress)return jb=Yf.yieldResult,da.textMorph.pluginFind(function(pf){return pf.theme}),zb=new ua.FilterableList(jb),zc=new ua.Range({start:Fa,end:da.textMorph.selection.start}),wc=da.textMorph.textInRange(zc),id=zb.inputMorph,qd=zb.listMorph,cd=jb.input,of=zb.addMorph({name:"prefix mask",fill:ua.Color.transparent,bounds:id.textBounds()},
id),qd.master=null,zc.isEmpty()||(da.textMorph.deleteText(zc),id.input=wc,id.gotoDocumentEnd()),id.fontColor=da.textMorph.fontColor,ua.connect(id,"textString",of,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:id}}),ua.connect(zb,"accepted",da,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:cd}}),ua.connect(zb,"accepted",zb,"remove"),ua.connect(zb,"canceled",zb,"remove"),ua.connect(zb,"remove",da.textMorph,"focus"),ua.connect(zb.inputMorph,"onBlur",da,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:zb}}),mg=da.textMorph.world(),qd.addStyleClass("hiddenScrollbar"),zb.paddingMorph.height=2,id.height=qd.itemHeight,id.clipMode="visible",id.fill=da.textMorph.fill,id.fixedHeight=!0,id.fixedWidth=!1,id.fontSize=qd.fontSize,zb.relayout(),zb.selectedIndex=
0,zb.master.applyIfNeeded(!0),id.focus(),Yf.yield(zb.master.whenApplied(),3);cd.length&&(id.gotoDocumentEnd(),zb.moveBy(ua.pt(-id.textBounds().width,0)));mg.addMorph(zb);zb.inputPadding=ua.Rectangle.inset(0,0,0,0);return Yf.return(zb)})}},{key:"autoInsertBestMatchingCompletion",value:function(da,Fa,jb){Fa=void 0===Fa?!0:Fa;var zb=this,zc,wc,id,qd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cd){if(1==cd.nextAddress)return zc=$jscomp,wc=zc.makeIterator,cd.yield(zb.computeSortedCompletions(da,
Fa),2);id=wc.call(zc,cd.yieldResult);(qd=id.next().value)&&zb.insertCompletion(qd.value.completion,da,jb);cd.jumpToEnd()})}},{key:"insertCompletion",value:function(da,Fa,jb){var zb=this.textMorph,zc=zb.document,wc=zb.selection.isMultiSelection?zb.selection.selections:[zb.selection];zb.undoManager.group();wc.forEach(function(id){id.collapseToEnd();var qd=id.lead,cd=Fa?zc.indexToPosition(zc.positionToIndex(qd)-Fa.length):qd;"function"===typeof jb?jb(da,Fa,zb,{start:cd,end:qd},id):zb.replace({start:cd,
end:qd},da)});zb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],Ta,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);ua.CompletionController=P;ua.CompletionController=P;ua.CompletionController=P;P=
[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ha,Ta,Db){var da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){return 1==Fa.nextAddress?(da=new ua.CompletionController(Ha,ua.defaultCompleters),Fa.yield(da.openCompletionList(),2)):Fa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ha,Ta,Db){var da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){return 1==Fa.nextAddress?(da=
new ua.CompletionController(Ha,ua.defaultCompleters),Fa.yield(da.autoInsertBestMatchingCompletion(da.prefix()),2)):Fa.return(!0)})}}];ua.completionCommands=P;ua.completionCommands=P;ua.completionCommands=P;var bb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");bb.chain=Af;bb.arr=lc;bb.obj=rd;bb.string=nd;var Nb=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ha){var Ta=Ha.selection.start;0<Ta.row&&(Ta=Ha.getPositionAboveOrBelow(1,Ta,
!0,0,Ha.charBoundsFromTextPosition(Ta).x),Ha.selection.addRange({start:Ta,end:Ta}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Ha){var Ta=Ha.selection.start;Ta.row<Ha.documentEndPosition.row&&(Ta=Ha.getPositionAboveOrBelow(-1,Ta,!0,0,Ha.charBoundsFromTextPosition(Ta).x),Ha.selection.addRange({start:Ta,end:Ta}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ha){var Ta=Ha.selection.selections[Ha.selection.selections.length-
1];if(Ta.isEmpty())return!0;Ha.searchForAll(Ta.text,{start:{column:0,row:0}}).forEach(function(Db){return Ha.selection.addRange(Db.range,!1)});Ha.selection.mergeSelections();bb.arr.remove(Ha.selection.selections,Ta);Ha.selection.selections.push(Ta);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ha){var Ta=Ha.selection.selections.length-1,Db=Ha.selection.selections[Ta];if(Db.isEmpty())return!0;var da=Ha.search(Db.text,{start:Db.end,backwards:!1});
da&&(Db=Ha.selection.selections.findIndex(function(Fa){return Fa.range.equals(da.range)}),-1<Db?bb.arr.swap(Ha.selection.selections,Db,Ta):Ha.selection.addRange(da.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Ha){var Ta=Ha.selection.selections.length-1,Db=Ha.selection.selections[Ta];if(Db.isEmpty())return!0;var da=Db.start,Fa=Ha.search(Db.text,{start:{row:da.row,column:da.column-(Db.text.length-1)},backwards:!0});Fa&&(Db=Ha.selection.selections.findIndex(function(jb){return jb.range.equals(Fa.range)}),
-1<Db?bb.arr.swap(Ha.selection.selections,Db,Ta):Ha.selection.addRange(Fa.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Ha){var Ta=Ha.selection.selections.length;1<Ta&&Ha.selection.removeSelections(Ta-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ha){Ha.selection.selections=lively.lang.arr.rotate(Ha.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(Ha){Ha.selection.selections=lively.lang.arr.rotate(Ha.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Ha){var Ta=Ha.selection.selections;if(1>=Ta.length)return!0;var Db=bb.arr.groupBy(Ta,function(Fa){return Fa.range.start.row});Ta=Db.keys().map(function(Fa){Fa=Db[Fa];var jb=bb.arr.max(Fa,function(zb){return zb.range.start.column});bb.arr.without(Fa,jb).forEach(function(zb){return zb.range=jb.range});
return jb});var da=bb.arr.max(Ta,function(Fa){return Fa.range.start.column}).range.start.column;Ta.forEach(function(Fa){var jb=Fa.range.start;Fa=jb.row;jb=jb.column;Ha.insertText(" ".repeat(da-jb),{row:Fa,column:jb})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ha){Ha.selection.disableMultiSelect();if(Ha.selection.isEmpty())var Ta=Ha.lastSavedMark&&Ha.lastSavedMark.position||(void 0).lineRange().start,Db=Ha.cursorPosition;else Ta=Ha.selection,
Db=Ta.lead,Ta=Ta.anchor;Ha.selection.collapse();var da=Ta.column,Fa=Db.column;bb.arr.range(Ta.row,Db.row).forEach(function(jb){return Ha.getLine(jb).length>Math.min(Fa,da)&&Ha.selection.addRange({end:{row:jb,column:Fa},start:{row:jb,column:da}},!1)});Ha.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ha,Ta,Db){Db=void 0===Db?1:Db;Ha.undoManager.group();Ha.selection.selections.forEach(function(da,Fa){return da.text=String(Fa+
Db)});Ha.undoManager.group();return!0}}];bb.multiSelectCommands=Nb;bb.multiSelectCommands=Nb;bb.multiSelectCommands=Nb;var ic=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");ic.pToI=function(Ha,Ta){return Ha.positionToIndex(Ta)};ic.iToP=function(Ha,Ta){return Ha.indexToPosition(Ta)};ic.execCodeNavigator=function(Ha){return function(Ta,Db,da){var Fa=Ta.pluginInvokeFirst("getNavigator");if(!Fa)return!0;Ta.saveMark();da=da||1;for(var jb=0;jb<da;jb++)Fa[Ha](Ta,Db);return!0}};
ic.once=cc;var fd=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:ic.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:ic.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:ic.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:ic.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:ic.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ha,Ta){function Db(){var jb=Ha.$expandRegionState,zb=ic.pToI(Ha,Ha.cursorPosition);if(jb&&(jb.range[0]===zb||jb.range[1]===zb))return jb;jb=Ha.selection.range;return Ha.$expandRegionState={range:[ic.pToI(Ha,jb.start),
ic.pToI(Ha,jb.end)]}}Ta=Ta||{};var da=Ha.pluginInvokeFirst("getNavigator");if(!da)return!0;var Fa=Ta.start;Ta=Ta.end;if("number"===typeof Fa&&"number"===typeof Ta)Db(),da={range:[Fa,Ta],prev:Db()};else{Fa=da.ensureAST(Ha);if(!Fa)return;da=da.expandRegion(Ha,Ha.textString,Fa,Db())}da&&da.range&&(Ha.selection={start:ic.iToP(Ha,da.range[0]),end:ic.iToP(Ha,da.range[1])},Ha.$expandRegionState=da);ic.once(Ha,"selectionChange",function(){return Ha.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ha){if(Ha.selection.isEmpty())return!0;var Ta=Ha.pluginInvokeFirst("getNavigator");if(!Ta)return!0;var Db=Ta.ensureAST(Ha);if(!Db)return!0;var da=Ha.$expandRegionState;if(!da)return!0;(Ta=Ta.contractRegion(Ha,Ha.textString,Db,da))&&Ta.range&&(Ha.selection={start:ic.iToP(Ha,Ta.range[0]),end:ic.iToP(Ha,Ta.range[1])},Ha.$expandRegionState=Ta);ic.once(Ha,"selectionChange",
function(){return Ha.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];ic.commands=fd;ic.commands=fd;ic.commands=fd;var Td=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");Td.arr=lc;Td.chain=Af;Td.string=nd;var qe=[{name:"toggle comment",exec:function(Ha){var Ta=Ha.pluginInvokeFirst("getComment");if(!Ta)return!0;if(!Ta.lineCommentStart)return Ta.blockCommentStart?Ha.execCommand("toggle block comment"):!0;var Db=Ta.lineCommentStart,da=
new RegExp("^(\\s*)("+Db+"\\s?)(.*)");Ta=Ha.document;var Fa=Ha.selection;Fa.isEmpty()||0!==Fa.end.column||Fa.growRight(-1);var jb=Fa.start.row;Ta=Ta.lineStrings.slice(Fa.start.row,Fa.end.row+1);Ta=Ta.some(function(wc){return!!wc.trim()})?Td.arr.dropWhile(Ta,function(wc){return wc.trim()?!1:++jb&&!0}):Ta;var zb=Ta.every(function(wc){return wc.trim()&&wc.match(da)});Ha.undoManager.group();if(zb)Ta.forEach(function(wc,id){if(wc=wc.match(da)){wc=$jscomp.makeIterator(wc);wc.next();var qd=wc.next().value,
cd=wc.next().value;wc.next();Ha.deleteText({start:{row:jb+id,column:qd.length},end:{row:jb+id,column:qd.length+cd.length}})}});else{var zc=Ta.reduce(function(wc,id,qd){return id.trim()||Fa.isEmpty()&&Fa.start.row===Fa.end.row?Math.min(wc,id.match(/^\s*/)[0].length):wc},Infinity);zc=Infinity===zc?0:zc;Ta.forEach(function(wc,id){wc=$jscomp.makeIterator(wc.match(/^(\s*)(.*)/));wc.next();wc.next();wc.next();Ha.insertText(Db+" ",{row:jb+id,column:zc})})}Ha.undoManager.group();return!0}},{name:"toggle block comment",
exec:function(Ha){var Ta=Ha.pluginInvokeFirst("getComment");if(!Ta)return!0;if(!Ta.blockCommentStart)return Ta.lineCommentStart?Ha.execCommand("toggle comment"):!0;if(!Ta||!Ta.blockCommentStart)return!0;var Db=Ta.blockCommentStart;Ta=Ta.blockCommentEnd;var da=new RegExp("^"+Db.replace(/\*/g,"\\*")),Fa=new RegExp(Ta.replace(/\*/g,"\\*")+"$"),jb=Ha.tokenAt(Ha.cursorPosition);if(jb&&"comment"===jb.token){var zb=Ha.textInRange(jb);if(zb.match(da)&&zb.match(Fa))return Ha.undoManager.group(),Ha.replace(jb,
zb.slice(Db.length,-Ta.length)),Ha.undoManager.group(),!0}Ha.undoManager.group();Ha.insertText(Db,Ha.selection.start);Ha.insertText(Ta,Ha.selection.end);Ha.undoManager.group();Db=!Ha.selection.isEmpty();Ha.selection.growLeft(Ta.length);Db||Ha.selection.collapse();return!0}},{name:"comment box",exec:function(Ha,Ta,Db){Ta=Ha.undoManager.ensureNewGroup(Ha,"comment box");if(Ha.selection.isEmpty())return Ha.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ha.execCommand("toggle comment"),
Ha.undoManager.group(Ta),!0;var da=Ha.selection.range,Fa=Ha.withSelectedLinesDo(function(zb){return zb}),jb=Td.arr.min([da.start.column].concat(Td.chain(Fa).map(function(zb){return zb.match(/^\s*/)}).flatten().compact().pluck("length").value()));Fa=Td.arr.max(Fa.map(function(zb){return zb.length}))-jb;Fa=Array(Math.ceil(Fa/2)+1).join("-=")+"-";Ha.execCommand("toggle comment");Ha.collapseSelection();Ha.cursorPosition={row:da.start.row,column:0};Db?Ha.insertText(Td.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",jb)):Ha.insertText(Td.string.indent(Fa+"\n"," ",jb));Ha.selection.goUp();Ha.execCommand("toggle comment");Ha.cursorPosition={row:da.end.row+2,column:0};Ha.insertText(Td.string.indent(Fa+"\n"," ",jb));Ha.selection.goUp();Ha.execCommand("toggle comment");Ha.selection.range={start:{row:da.start.row,column:0},end:Ha.cursorPosition};Ha.undoManager.group(Ta);return!0},multiSelectAction:"forEach",handlesCount:!0}];Td.commands=qe;Td.commands=qe;Td.commands=qe;var $c=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
$c.printSymbol=function(Ha){if(Symbol.keyFor(Ha))return'Symbol.for("'+Symbol.keyFor(Ha)+'")';if($c.knownSymbols.get(Ha))return $c.knownSymbols.get(Ha);String(Ha).match($c.symMatcher);return String(Ha)};$c.defaultSort=function(Ha,Ta){if(Ha.hasOwnProperty("priority")||Ta.hasOwnProperty("priority")){var Db=Ha.priority||0,da=Ta.priority||0;if(Db<da)return-1;if(Db>da)return 1}Ha=(Ha.keyString||Ha.key).toLowerCase();Ta=(Ta.keyString||Ta.key).toLowerCase();return Ha<Ta?-1:Ha===Ta?0:1};$c.safeToString=yd;
$c.propertyNamesOf=function(Ha,Ta){if(!Ha)return[];if(Array.isArray(Ha)){var Db=Ta?Ta.offset:0;return $c.arr.range(Db,Db+(Ta?Ta.partitionSize:Ha.length-1))}return $c.arr.sortBy(Object.keys(Ha),function(da){return da.toLowerCase()})};$c.isMultiValue=ae;$c.printValue=He;$c.partitionedChildren=function(Ha,Ta){var Db=void 0===Ta?{}:Ta;Ta=void 0===Db.originalValue?Ha:Db.originalValue;var da=void 0===Db.offset?0:Db.offset;Db=void 0===Db.partitionSize?Ha.length||Object.values(Ha).length:Db.partitionSize;
if($c.obj.isArray(Ha)){Ha=$c.num.roundTo(Math.max($c.MIN_PARTITION_SIZE,Db/50),.1);Db/=Ha;for(var Fa=[],jb=0;jb<Db;jb++){var zb="["+(da+jb*Ha)+"-"+(da+(jb+1)*Ha)+"]";Fa.push({partition:{originalValue:Ta,offset:da+jb*Ha,partitionSize:Ha},value:[],key:zb,keyString:zb,valueString:"...",isCollapsed:!0})}return Fa}Ha=$c.num.roundTo(Math.max($c.MIN_PARTITION_SIZE,Db/50),.1);Db/=Ha;Fa=[];jb=$c.obj.keys(Ta).sort();for(zb=0;zb<Db;zb++){var zc=da+zb*Ha,wc=da+(zb+1)*Ha,id=$c.obj.select(Ta,jb.slice(zc,wc));zc=
"["+jb[zc].slice(0,4)+"-"+(jb[wc]||$c.arr.last(jb)).slice(0,4)+"]";Fa.push({partition:{originalValue:id,offset:da+zb*Ha,partitionSize:Ha},value:[],key:zc,keyString:zc,valueString:"...",isCollapsed:!0})}return Fa};$c.propertiesOf=function(Ha){var Ta=Ha.partition?Ha.target:Ha.value;if(!Ta)return[];var Db={_rev:!0},da=[],Fa="function"===typeof Ta.livelyCustomInspect?Ta.livelyCustomInspect():{},jb=Object.assign({},$c.defaultPropertyOptions,{},Fa);if(Fa.properties){Fa=$jscomp.makeIterator(Fa.properties);
for(var zb=Fa.next();!zb.done;zb=Fa.next()){var zc=zb.value;zb=zc.key;var wc=zc.hidden,id=zc.priority,qd=zc.keyString,cd=zc.value;zc=zc.valueString;Db[zb]=!0;wc||da.push(Ha.getSubNode({priority:id,key:zb,keyString:qd||$c.safeToString(zb),value:cd,valueString:zc,isCollapsed:!0}))}}if(jb.includeDefault){Fa=$c.propertyNamesOf(Ta,Ha.partition);if(Fa.length>$c.MAX_NODE_THRESHOLD)for(Db=$jscomp.makeIterator($c.partitionedChildren(Ta,Ha.partition)),Fa=Db.next();!Fa.done;Fa=Db.next())da.push(Ha.getSubNode(Fa.value));
else for(wc=$jscomp.makeIterator(Fa),Fa=wc.next();!Fa.done;Fa=wc.next())id=Fa.value,id in Db||(Fa=Ta[id],zb=$c.printValue(Fa),Fa={keyString:id,key:id,value:Fa,valueString:zb,isCollapsed:!0},da.push(Ha.getSubNode(Fa)));if(jb.includeSymbols)for(Db=$jscomp.makeIterator(Object.getOwnPropertySymbols(Ta)),Fa=Db.next();!Fa.done;Fa=Db.next())wc=Fa.value,id=$c.safeToString(wc),Fa=Ta[wc],zb=$c.printValue(Fa),Fa={key:wc,keyString:id,value:Fa,valueString:zb,isCollapsed:!0},da.push(Ha.getSubNode(Fa))}jb.sort&&
(da=jb.sortFunction(Ta,da));return da};$c.obj=rd;$c.num=Ic;$c.arr=lc;$c.string=nd;$c.connect=Nc;$c.signal=Kd;$c.TreeData=Kc;$c.newUUID=Bd;$c.localInterface=Za;$c.MAX_NODE_THRESHOLD=1E3;$c.MIN_PARTITION_SIZE=250;$c.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Ha,Ta){return Array.isArray(Ha)?Ta:Ta.sort($c.defaultSort)}};$c.symMatcher=/^Symbol\((.*)\)$/;$c.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ha){return"symbol"===
typeof Symbol[Ha]}).reduce(function(Ha,Ta){return Ha.set(Symbol[Ta],"Symbol."+Ta)},new Map)}();$c.isMultiValue=ae;$c.isMultiValue=ae;$c.printValue=He;$c.printValue=He;var Re=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Ta.hasOwnProperty("InspectionTree")&&"function"===typeof Ta.InspectionTree?Ta.InspectionTree:Ta.InspectionTree=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Kb(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da){Kb._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),this).call(this,da);this.inspector=da.inspector;this.root.isInspectionNode||(this.root=$c.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(da){da=void 0===da?!0:da;return Kb._get(Object.getPrototypeOf(Db.prototype),"asListWithIndexAndDepth",
this).call(this,function(Fa){Fa=Fa.node;return da?Fa.visible:!0})}},{key:"getContextFor",value:function(da){return da==this.root?this.root.value.inspectee:da.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(da){var Fa=void 0===da.maxDepth?1:da.maxDepth,jb=da.iterator,zb=da.showUnknown,zc=da.showInternal,wc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(id){if(1==id.nextAddress)return id.yield(wc.uncollapseAll(function(qd,cd){return Fa>cd&&(qd==wc.root||qd.value.submorphs)}),
2);wc.asListWithIndexAndDepth(!1).forEach(function(qd){var cd=qd.node;return 0==qd.depth?cd.visible=!0:!zb&&cd.keyString&&cd.keyString.includes("UNKNOWN PROPERTY")||!zc&&cd.keyString&&cd.keyString.includes("internal")?cd.visible=!1:cd.value&&cd.value.submorphs?cd.visible=!0:cd.visible=jb(cd)});id.jumpToEnd()})}},{key:"getChildren",value:function(da){return da.children}},{key:"display",value:function(da){return da.display(this.inspector)}},{key:"isCollapsed",value:function(da){return da.isCollapsed}},
{key:"isLeaf",value:function(da){return $c.obj.isPrimitive(da.value)}},{key:"collapse",value:function(da,Fa){var jb=this;da.isCollapsed=Fa;Fa||this.isLeaf(da)||da.children.length||(da.children=$c.propertiesOf(da).map(function(zb){jb.parentMap.set(zb,da);return zb}))}},{key:"retrieveForRemoteProxy",value:function(da){da.uuid||(da.uuid=$c.newUUID(),this.idToNodeMap[da.uuid]=da);return{uuid:da.uuid,value:this.isLeaf(da)?da.value:{},keyString:da.keyString,key:da.keyString,valueString:$c.safeToString(da.value),
isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return $c.localInterface}},{key:"getNodeViaId",value:function(da){return this.idToNodeMap[da]}},{key:"asRemoteDelegate",value:function(da){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[da]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(da,Fa){return new this({key:"inspectee",value:{inspectee:da},isCollapsed:!0,inspector:Fa})}}],Ta,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}($c.TreeData);$c.InspectionTree=Re;$c.InspectionTree=
Re;$c.InspectionTree=Re;var jf=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Ta.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Ta.RemoteInspectionTree?Ta.RemoteInspectionTree:Ta.RemoteInspectionTree=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(da){this.parentMap=new WeakMap;this.root=da.proxy;this.evalEnvironment=da.evalEnvironment;this.inspector=da.inspector;this.delegateId=da.delegateId}},{key:"getContextFor",value:function(da){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+da.uuid+'").value'}},{key:"dispose",value:function(){var da=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){return Fa.yield(da.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
da.delegateId+"']\n    ",da.evalEnvironment),0)})}},{key:"display",value:function(da){return da.keyString+": "+da.valueString}},{key:"collapse",value:function(da,Fa){var jb=this,zb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zc){if(1==zc.nextAddress)return(da.isCollapsed=Fa)||jb.isLeaf(da)?zc.return():da.children.length?zc.jumpTo(0):zc.yield(jb.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+da.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+jb.delegateId+'"]'}),3);zb=zc.yieldResult;da.children=zb.isError?[]:zb.value;zc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(da,Fa){var jb=this,zb,zc,wc,id;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qd){if(1==qd.nextAddress)return qd.yield(jb.createRemoteContext(da,Fa),2);zb=qd.yieldResult;
zc=zb.proxy;wc=zb.delegateId;id=zb.evalEnvironment;return qd.return(new jb({key:"inspectee",proxy:zc,delegateId:wc,evalEnvironment:id,inspector:Fa}))})}},{key:"createRemoteContext",value:function(da,Fa){var jb=da.code,zb=da.evalEnvironment,zc=da.delegateId,wc,id;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qd){if(1==qd.nextAddress)return zc="lively://inspector-"+Fa.id,qd.yield(zb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
jb+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+zc+'");\n    ',zb),2);wc=qd.yieldResult;id=wc.value;return qd.return({delegateId:zc,evalEnvironment:zb,proxy:id})})}}],Ta,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}($c.InspectionTree);
$c.RemoteInspectionTree=jf;$c.RemoteInspectionTree=jf;$c.RemoteInspectionTree=jf;(function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Ta.hasOwnProperty("InspectionNode")&&"function"===typeof Ta.InspectionNode?Ta.InspectionNode:Ta.InspectionNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da){var Fa=
da.root,jb=da.priority,zb=da.key,zc=da.keyString,wc=da.value,id=da.valueString,qd=da.isCollapsed,cd=void 0===da.children?[]:da.children,of=void 0===da.isSelected?!1:da.isSelected,mg=void 0===da.visible?!0:da.visible;this.partition=da.partition;this.priority=jb;this.key=zb;this.keyString=String(zc||zb);this.value=wc;this.valueString=id||$c.printValue(wc);this.isCollapsed=qd;this.children=cd;this.isSelected=of;this.visible=mg;this.root=Fa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(da){if(da.value&&da.value.isMorph)return new $c.MorphNode(Object.assign({root:this.root},da));var Fa=da.key,jb=da.keyString,zb=this.value,zc=da.partition;zc&&(zb=zc.originalValue,jb=Fa);return new $c.PropertyNode(Object.assign({},da,{keyString:jb,key:Fa,target:zb,partition:zc,root:this.root,spec:{}}))}},{key:"display",value:function(da){var Fa=this.keyString,jb=this.valueString;if(!this.interactive)return Fa+": "+jb;this._propertyWidget||
(this._propertyWidget=da.renderDraggableTreeLabel({value:Fa+": "+jb}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(da,Fa){Fa=void 0===Fa?null:Fa;return da.value&&da.value.isMorph?new $c.MorphNode(Object.assign({root:Fa},da)):new $c.InspectionNode(Object.assign({root:Fa},da))}}],Ta,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Ta.hasOwnProperty("MorphNode")&&"function"===typeof Ta.MorphNode?Ta.MorphNode:Ta.MorphNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,
[{key:Symbol.for("lively-instance-initialize"),value:function(da){Kb._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),this).call(this,da);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(da){var Fa=this.propertyInfo[da.key]||{};return da.value&&da.value.isMorph?new $c.MorphNode(Object.assign({},da,{root:this.root})):new $c.PropertyNode(Object.assign({},da,{root:this.root,target:this.target,
spec:Fa}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],Ta,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})($c.InspectionNode);(function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Ta.hasOwnProperty("PropertyNode")&&
"function"===typeof Ta.PropertyNode?Ta.PropertyNode:Ta.PropertyNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da){Kb._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),this).call(this,da);var Fa=da.spec,jb=da.target;this.partition=da.partition;this.target=jb;this.spec=Fa;this.foldedNodes={}}},{key:"__deserialize__",
value:function(da,Fa){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(da){this._interactive=da}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(da){return this.isFoldable?this.getFoldedContext(da):Kb._get(Object.getPrototypeOf(Db.prototype),"getSubNode",this).call(this,da)}},{key:"getFoldedContext",
value:function(da){return this.foldedNodes[da.key]=new $c.FoldedNode(Object.assign({},da,{root:this.root,target:this.target,foldableNode:this,spec:$c.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(da,Fa){(Fa=void 0===Fa?!1:Fa)&&(this.target[this.key]=da);this.value=this.target[this.key];this.valueString=$c.printValue(this.value);this.interactive&&(Fa||this._propertyWidget.highlight());if(this.isFoldable)for(var jb in this.foldedNodes)this.foldedNodes[jb].value=
this.value[jb],this.foldedNodes[jb].valueString=$c.printValue(this.value[jb]),this.foldedNodes[jb]._propertyWidget&&$c.signal(this.foldedNodes[jb]._propertyWidget,"update",this.value[jb])}},{key:"display",value:function(da){var Fa=this,jb=this._propertyWidget,zb=this.keyString,zc=this.valueString,wc=this.target,id=this.value,qd=this.spec;if(!(this.interactive||qd.foldable&&$c.isMultiValue(id,qd.foldable)))return da.renderPropertyControl({target:wc,keyString:zb,valueString:zc,tree:da.ui.propertyTree,
value:id,spec:qd,node:this,fastRender:!0});if(jb)return jb.keyString=zb,jb.valueString=zc,jb.isSelected=this.isSelected,jb.control&&(jb.control.isSelected=this.isSelected),jb;jb=this._propertyWidget=da.renderPropertyControl({target:wc,keyString:zb,valueString:zc,value:id,spec:qd,node:this,isSelected:this.isSelected,fontColor:da.ui.propertyTree.fontColor});this.isInternalProperty||qd.readOnly||($c.connect(jb,"propertyValue",this,"refreshProperty",{updater:function(cd,of){return cd(of,!0)}}),$c.connect(jb,
"openWidget",this.root,"onWidgetOpened",{converter:function(cd){return{widget:cd,node:Fa.sourceObj}}}));return jb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Ta,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})($c.InspectionNode);
(function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Db=Ta.hasOwnProperty("FoldedNode")&&"function"===typeof Ta.FoldedNode?Ta.FoldedNode:Ta.FoldedNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(da){Kb._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
da);this.foldableNode=da=da.foldableNode;this.foldedProp=da.key+$c.string.capitalize(this.key)}},{key:"refreshProperty",value:function(da,Fa){Fa=void 0===Fa?!1:Fa;var jb={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(jb[this.key]=da,jb)),Fa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Ta,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})($c.PropertyNode);var We=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");We.Color=Cb;var Rf=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Db=Ta.hasOwnProperty("DarkTheme")&&"function"===typeof Ta.DarkTheme?Ta.DarkTheme:Ta.DarkTheme=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Kb(Db,Ha,[{key:"background",get:function(){return We.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return We.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:We.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:We.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:We.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:We.Color.white,fontWeight:"bold",backgroundColor:We.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:We.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:We.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],Ta,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),gg=Rf=We.DarkTheme;We.default=Rf;var ac=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");ac.inspect=Fc;ac.remoteInspect=oe;ac.generateReferenceExpression=ed;ac.onNumberDragStart=
function(Ha,Ta){Ta.initPos=Ha.position;Ta.factorLabel=(new ac.Tooltip({description:"1x"})).openInWorld(Ha.hand.position.addXY(10,10))};ac.onNumberDrag=function(Ha,Ta){var Db=ac.getScaleAndOffset(Ha,Ta),da=Db.scale;Db=Db.offset;Ta.factorLabel.position=Ha.hand.position.addXY(10,10);Ta.factorLabel.description=da+"x";return ac.getCurrentValue(Db,da,Ta)};ac.onNumberDragEnd=function(Ha,Ta){var Db=ac.getScaleAndOffset(Ha,Ta);Ha=Db.offset;Db=Db.scale;Ta.factorLabel.softRemove();return ac.getCurrentValue(Ha,
Db,Ta)};ac.getScaleAndOffset=function(Ha,Ta){var Db=Ha.position.subPt(Ta.initPos);Ha=Db.x;Ta=ac.num.roundTo(Math.exp(-Db.y/$world.height*6),.01)*Ta.baseFactor;return{offset:Ha,scale:Ta}};ac.getCurrentValue=function(Ha,Ta,Db){return Math.max(Db.min,Math.min(Db.max,Db.scrubbedValue+(Db.floatingPoint?Ha*Ta:Math.round(Ha*Ta))))};ac.Color=Cb;ac.Rectangle=$b;ac.rect=be;ac.pt=Qd;ac.obj=rd;ac.num=Ic;ac.Path=yc;ac.arr=lc;ac.promise=Cc;ac.connect=Nc;ac.disconnect=Pb;ac.once=cc;ac.Morph=Dc;ac.Tooltip=Xc;ac.VerticalLayout=
Cd;ac.GridLayout=Od;ac.HorizontalLayout=Gb;ac.morph=Zc;ac.CustomLayout=sb;ac.Label=Bc;ac.Icon=gb;ac.StyleSheet=ad;ac.config=rb;ac.Tree=Sa;ac.LoadingIndicator=Ua;ac.DropDownList=cb;ac.DropDownSelector=ab;ac.SearchField=qb;ac.LabeledCheckBox=Zb;ac.MorphHighlighter=ma;ac.InteractiveMorphSelector=Ia;ac.printValue=He;ac.RemoteInspectionTree=jf;ac.InspectionTree=Re;ac.isMultiValue=ae;ac.valueWidgets=W;ac.popovers=sa;ac.DarkTheme=gg;ac.DefaultTheme=Va;ac.syncEval=kc;ac.inspectorCommands=[{name:"focus codeEditor",
exec:function(Ha){Ha.get("codeEditor").show();Ha.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ha){Ha.get("propertyTree").show();Ha.get("propertyTree").focus();return!0}}];(function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Ta.hasOwnProperty("DraggedProp")&&"function"===typeof Ta.DraggedProp?Ta.DraggedProp:Ta.DraggedProp=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Kb(Db,Ha,[{key:"applyToTarget",value:function(da){var Fa=this.currentTarget,jb=this.control;this.remove();ac.MorphHighlighter.removeHighlighters(da.world);if(Fa)if(Fa.isText&&"js"===Fa.editorModeName){var zb=Fa.evalEnvironment.context;da=Fa.textPositionFromPoint(Fa.localize(da.position));zb=ac.generateReferenceExpression(this.sourceObject,{fromMorph:zb});jb.keyString&&(zb+="."+jb.keyString);Fa.insertTextAndSelect(zb,da);Fa.focus()}else"propertyValue"in jb&&(Fa[jb.keyString]=jb.propertyValue)}},
{key:"update",value:function(da){da=da.hand.globalPosition;var Fa=this.morphBeneath(da),jb;if(Fa){for(Fa==this.morphHighlighter&&(Fa=Fa.morphBeneath(da));jb=[Fa].concat($jscomp.arrayFromIterable(Fa.ownerChain())).find(function(zb){return!zb.visible});)Fa=jb=jb.morphBeneath(da);if(Fa!=this.currentTarget){this.currentTarget=Fa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Fa.isWorld)return;this.morphHighlighter=ac.MorphHighlighter.for($world,Fa);this.morphHighlighter.show()}this.position=
da}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:ac.Color.rgb(169,204,227)},fill:{defaultValue:ac.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var da=this.control;if(!da)return this.submorphs=[];this.height=22;this.submorphs=[da];da.top=0;da.fontSize=14;"function"===typeof da.relayout&&
da.relayout();this.width=da.width+20;this.adjustOrigin(ac.pt(10,10))}}}}}],Ta,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3719})})(ac.Morph);(function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Ta.hasOwnProperty("DraggableTreeLabel")&&"function"===
typeof Ta.DraggableTreeLabel?Ta.DraggableTreeLabel:Ta.DraggableTreeLabel=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(da){this.draggedProp=new ac.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();ac.connect(da.hand,"update",this.draggedProp,"update")}},
{key:"onDrag",value:function(da){}},{key:"onDragEnd",value:function(da){ac.disconnect(da.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(da)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:ac.config.codeEditor.defaultStyle.fontFamily},
fill:{defaultValue:ac.Color.transparent},padding:{defaultValue:ac.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(da){this.setProperty("isSelected",da);da?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=da)}}}}}],Ta,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3721,end:5060})})(ac.Label);Re=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Ta.hasOwnProperty("PropertyControl")&&"function"===typeof Ta.PropertyControl?Ta.PropertyControl:Ta.PropertyControl=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(da,Fa,jb){da.control=new ac.DropDownSelector({opacity:.8,fill:ac.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Fa,padding:0,values:jb});ac.connect(da.control,"update",da,"propertyValue",{updater:function(zb,zc){this.targetObj.propertyValue!=zc&&zb(zc)}});ac.connect(da,"update",da.control,"selectedValue",{updater:function(zb,zc){zc=zc&&zc.valueOf?zc.valueOf():zc;this.targetObj.propertyValue!=zc&&zb(zc)}});return da}},
{key:"toggleMultiValuePlaceholder",value:function(da){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:ac.Color.transparent,layout:new ac.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:ac.arr.range(0,2).map(function(Fa){return{type:"ellipse",fill:ac.Color.gray.withA(.5),reactsToPointer:!1,extent:ac.pt(7,7)}})});da?(ac.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),
this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(ac.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(da){this.foldableProperties&&this.toggleMultiValuePlaceholder(ac.isMultiValue(da,this.foldableProperties))}},{key:"asFoldable",value:function(da){this.foldableProperties=da;ac.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();
this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var da=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});
da.isLayoutable=!1;da.fontWeight="bold";da.fontColor=ac.Color.orange;da.reactsToPointer=!1;da.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(da){this.submorphs=[da]}},layout:{initialize:function(){this.layout=new ac.CustomLayout({relayout:function(da){da.relayout()}})}},
submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(da){return(da=da.value)&&(da.isColor||da.isGradient)?"Color":da&&da.isPoint?"Point":ac.obj.isBoolean(da)?"Boolean":ac.obj.isNumber(da)?"Number":ac.obj.isString(da)?"String":da&&da.isRectangle?"Rectangle":!1}},{key:"render",value:function(da){da.spec.type||(da.spec=Object.assign({},da.spec,{type:this.inferType(da)}));switch(da.spec.type){case "Color":var Fa=this.renderColorControl(da);
break;case "ColorGradient":Fa=this.renderColorControl(Object.assign({},da,{gradientEnabled:!0}));break;case "Number":Fa=this.renderNumberControl(da);break;case "String":Fa=this.renderStringControl(da);break;case "RichText":Fa=this.renderStringControl(da);break;case "Layout":Fa=this.renderLayoutControl(da);break;case "Enum":Fa=this.renderEnumControl(da);break;case "Shadow":Fa=this.renderShadowControl(da);break;case "Point":Fa=this.renderPointControl(da);break;case "Rectangle":Fa=this.renderRectangleControl(da);
break;case "Boolean":Fa=this.renderBooleanControl(da);break;default:Fa=this.renderItSomehow(da)}Fa.control&&(ac.connect(Fa.control,"openWidget",Fa,"openWidget"),Fa.toggleFoldableValue(da.value));return Fa}},{key:"baseControl",value:function(da){var Fa=da.spec;da=new this({keyString:da.keyString,valueString:da.valueString,isSelected:!1,propertyValue:da.value});Fa.foldable&&da.asFoldable(Fa.foldable);return da}},{key:"renderGrabbableKey",value:function(da){var Fa=this,jb=da.target;return[da.keyString+
":",{nativeCursor:"-webkit-grab",onDragStart:function(zb){zb.state.draggedProp=new ac.DraggedProp({sourceObject:jb,control:Fa.baseControl(da)});zb.state.draggedProp.openInWorld();ac.connect(zb.hand,"update",zb.state.draggedProp,"update")},onDrag:function(zb){},onDragEnd:function(zb){ac.disconnect(zb.hand,"update",zb.state.draggedProp,"update");zb.state.draggedProp.applyToTarget(zb)}}]}},{key:"renderEnumControl",value:function(da){var Fa=da.value,jb=da.spec.values,zb=da.keyString,zc=da.target,wc=da.node,
id=function(qd,cd){return $jscomp.asyncExecutePromiseGeneratorProgram(function(of){zc.world().openWorldMenu(qd,jb.map(function(mg){return{string:mg.toString(),action:function(){zc[zb]=mg;wc.rerender()}}}));of.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+(Fa?Fa.valueOf?Fa.valueOf():Fa:"Not set"),{nativeCursor:"pointer",onMouseDown:id}],$jscomp.arrayFromIterable(ac.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:id})))}},
{key:"renderStringControl",value:function(da){var Fa=da.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+(200<Fa.length?Fa.slice(0,20)+"...":Fa),{fontColor:ac.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(da){var Fa=da.value,jb=da.keyString,zb=da.valueString,zc=da.target,wc=da.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+zb,{fontColor:ac.Color.black,nativeCursor:"pointer",onMouseDown:function(id){var qd;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(cd){if(1==cd.nextAddress)return qd=new ac.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:Fa}),qd.relayout(),cd.yield(qd.fadeIntoWorld(id.positionIn(zc.world())),2);ac.connect(qd,"rectangle",function(of){zc[jb]=of;wc.rerender()});cd.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(da){var Fa=da.value,jb=da.keyString,zb=da.valueString,zc=da.target,wc=da.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),
[" "+zb,{nativeCursor:"pointer",fontColor:Fa?ac.Color.green:ac.Color.red,onMouseDown:function(id){zc[jb]=!zc[jb];wc.rerender()}}])}},{key:"renderNumberControl",value:function(da){var Fa=da.value,jb=da.spec,zb=da.keyString,zc=da.valueString,wc=da.node,id=da.target,qd=da.tree,cd=void 0===wc._numberControls?new Ng:wc._numberControls,of=$jscomp.makeIterator(cd.submorphs),mg=of.next().value,Yf=of.next().value;cd.fontColor=qd.fontColor;var pf=wc._numberControls=cd;"max"in jb&&"min"in jb&&-Infinity!=jb.min&&
Infinity!=jb.max?(pf.baseFactor=(jb.max-jb.min)/100,pf.floatingPoint=jb.isFloat,pf.max=jb.max,pf.min=jb.min):(pf.floatingPoint=jb.isFloat,pf.baseFactor=.5,pf.min=void 0!=jb.min?jb.min:-Infinity,pf.max=void 0!=jb.max?jb.max:Infinity);var wi=ac.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),$jscomp.arrayFromIterable(wc._inputMorph?[wc._inputMorph,{}]:[" "+(void 0!=Fa&&(Fa.valueOf?Fa.valueOf():Fa).toFixed(jb.isFloat?
3:0))+" ",{fontColor:wi,onMouseUp:function(Rh){wc._inputMorph=ac.morph({type:"input",fill:null,fontColor:wi,fontFamily:"IBM Plex Mono",fontSize:14,padding:ac.rect(8,2,-6,2),height:23,cursorColor:ac.Color.white,value:Fa.valueOf?Fa.valueOf():zc});id[zb]=Fa;wc._inputMorph.focus();ac.once(wc._inputMorph,"inputAccepted",function(Oj){delete wc._inputMorph;id[zb]=jb.isFloat?Number.parseFloat(Oj):Number.parseInt(Oj);wc.rerender()});ac.once(wc._inputMorph,"onBlur",function(Oj){wc._inputMorph&&(delete wc._inputMorph,
id[zb]=Fa,wc.rerender())});wc.rerender()},onDragStart:function(Rh){pf.scrubbedValue=Fa;ac.onNumberDragStart(Rh,pf)},onDrag:function(Rh){id[zb]=ac.onNumberDrag(Rh,pf);wc.rerender()},onDragEnd:function(Rh){return ac.onNumberDragEnd(Rh,pf)}},cd,{onMouseUp:function(){mg.fill=Yf.fill=null},onMouseDown:function(Rh){if(Rh.targetMorph===mg){mg.fill=ac.Color.white.withA(.2);if("max"in jb&&id[zb]>=jb.max)return;id[zb]+=1}if(Rh.targetMorph===Yf){Yf.fill=ac.Color.white.withA(.2);if("min"in jb&&id[zb]<=jb.min)return;
--id[zb]}wc.rerender()}}]))}},{key:"renderShadowControl",value:function(da){var Fa=da.keyString,jb=da.value,zb=da.target,zc=da.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[""+(jb?jb.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(wc){var id;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qd){if(1==qd.nextAddress)return id=new ac.popovers.ShadowPopover({shadowValue:zb[Fa],hasFixedPosition:!0}),qd.yield(id.fadeIntoWorld(wc.positionIn(zb.world())),
2);ac.connect(id,"shadowValue",function(cd){zb[Fa]=cd;zc.rerender()});qd.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(da){var Fa=da.keyString,jb=da.value,zb=da.target,zc=da.node,wc=ac.valueWidgets.NumberWidget.properties.fontColor.defaultValue,id={nativeCursor:"pointer",onMouseDown:function(qd){var cd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(of){if(1==of.nextAddress)return cd=new ac.popovers.PointPopover({pointValue:zb[Fa],hasFixedPosition:!0}),of.yield(cd.fadeIntoWorld(qd.positionIn(zb.world())),
2);ac.connect(cd,"pointValue",function(mg){zb[Fa]=mg;zc.rerender()});of.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" pt(",Object.assign({},id),""+jb.x.toFixed(),Object.assign({fontColor:wc},id),",",Object.assign({},id),""+jb.y.toFixed(),Object.assign({fontColor:wc},id),")",Object.assign({},id)])}},{key:"renderLayoutControl",value:function(da){var Fa=da.valueString,jb=da.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+(jb?
Fa:"No Layout"),{onMouseDown:function(zb){}}])}},{key:"renderColorControl",value:function(da){var Fa=da.node,jb=da.gradientEnabled,zb=da.valueString,zc=da.keyString,wc=da.value,id=da.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[ac.morph({fill:wc.valueOf?wc.valueOf():wc,extent:ac.pt(15,15),borderColor:ac.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(wc?wc.valueOf?wc.valueOf():zb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(qd){var cd;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(of){if(1==of.nextAddress)return cd=new ac.popovers.FillPopover({hasFixedPosition:!0,handleMorph:id,fillValue:wc,title:"Fill Control",gradientEnabled:jb}),of.yield(cd.fadeIntoWorld(qd.positionIn(id.world())),2);ac.connect(cd,"fillValue",function(mg){id[zc]=mg;Fa.rerender()});of.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(da){var Fa=da.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+Fa,
{}])}}],Ta,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5069,end:20375})}(ac.DraggableTreeLabel);ac.PropertyControl=Re;ac.PropertyControl=Re;ac.PropertyControl=Re;ac.inspect=Fc;ac.inspect=Fc;ac.remoteInspect=oe;ac.remoteInspect=oe;ac.generateReferenceExpression=ed;ac.generateReferenceExpression=
ed;var Ng=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Ta.hasOwnProperty("NumberControls")&&"function"===typeof Ta.NumberControls?Ta.NumberControls:Ta.NumberControls=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=
new ac.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:ac.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(da){this.submorphs.map(function(Fa){return Fa.fontColor=da})}},submorphs:{initialize:function(){this.submorphs=[ac.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:ac.rect(5,2,0,-6),fontSize:12}),ac.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:ac.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",
fontSize:12})]}}}}}],Ta,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23048,end:24093})}(ac.Morph);(function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Ta.hasOwnProperty("PropertyTree")&&"function"===typeof Ta.PropertyTree?Ta.PropertyTree:Ta.PropertyTree=
function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:"onDrag",value:function(da){this._onDragHandler&&this._onDragHandler(da)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Ta,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25258,end:25369})})(ac.Tree);Re=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Db=Ta.hasOwnProperty("Inspector")&&"function"===typeof Ta.Inspector?Ta.Inspector:Ta.Inspector=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();
this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(da){}},{key:"__after_deserialize__",value:function(da,Fa,jb){var zb=this,zc=new ac.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:ac.InspectionTree.forObject(null,this)}));this.addMorph(zc,this.getSubmorphNamed("terminal toggler"));Kb._get(Object.getPrototypeOf(Db.prototype),"__after_deserialize__",this).call(this,da,Fa,jb);!this.isComponent&&this.master.whenApplied().then(function(){zb.layout.col(0).row(1).group.morph=
zc;zb.targetObject&&(zb.targetObject=zb.targetObject)})}},{key:"__additionally_serialize__",value:function(da,Fa,jb,zb){da=da.props.submorphs.value;for(Fa=da.length;Fa--;)jb.refForId(da[Fa].id).realObj==this.ui.propertyTree&&ac.arr.removeAt(da,Fa)}},{key:"renderDraggableTreeLabel",value:function(da){return new ac.DraggableTreeLabel(da)}},{key:"renderPropertyControl",value:function(da){return ac.PropertyControl.render(da)}},{key:"onLoad",value:function(){var da=this.ui,Fa=da.codeEditor,jb=da.thisBindingSelector,
zb=da.propertyTree;Fa.changeEditorMode("js").then(function(){return Fa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==jb.selection?Fa.owner.selectedContext:Fa.owner.targetObject},get systemInterface(){return ac.Path("treeData.systemInterface").get(zb)},format:"esm"}}).catch(function(zc){return $world.logError(zc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(da){Kb._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,da);da=this.ui;var Fa=da.targetPicker,jb=da.propertyTree,zb=da.resizer,zc=da.terminalToggler,wc=da.unknowns,id=da.internals,qd=da.searchField,cd=da.codeEditor,of=da.fixImportButton,mg=da.thisBindingSelector;cd.changeEditorMode("js").then(function(){return cd.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==mg.selection?cd.owner.selectedContext:cd.owner.targetObject},get systemInterface(){return jb.treeData.systemInterface},format:"esm"}}).catch(function(Yf){return $world.logError(Yf)});
ac.connect(Fa,"onMouseDown",this,"selectTarget");ac.connect(jb,"onScroll",this,"repositionOpenWidget");ac.connect(zb,"onDrag",this,"adjustProportions");ac.connect(zc,"onMouseDown",this,"toggleCodeEditor");ac.connect(wc,"trigger",this,"filterProperties");ac.connect(id,"trigger",this,"filterProperties");ac.connect(qd,"searchInput",this,"filterProperties");ac.connect(jb,"nodeCollapseChanged",this,"filterProperties");ac.connect(this,"extent",this,"relayout");ac.connect(mg,"selection",this,"bindCodeEditorThis");
ac.connect(of,"fire",cd,"execCommand",{updater:function(Yf){return Yf("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var da=this.ui.propertyTree.selectedIndex-1,Fa=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Fa=this.ui.propertyTree.document.getLine(da).textAndAttributes.slice(0,4).concat(Fa.display(this));da=this.ui.propertyTree.lineRange(da,!1);this.ui.propertyTree.replace(da,Fa,!1,!1,
!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var da=ac.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(da!=this.lastChange||this.lastSubmorphs!=ac.printValue(this.targetObject&&
this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==da.prop&&this.repositionOpenWidget(),this.lastChange=da,this.lastSubmorphs=ac.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var da;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Fa){Fa=Fa.node;Fa.target&&(da=Fa.foldableNode?Fa.target[Fa.foldableNode.key][Fa.key]:Fa.target[Fa.key],
!ac.obj.equals(da,Fa.value)&&Fa.refreshProperty&&Fa.refreshProperty(da))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(da,Fa){Fa=void 0===Fa?!1:Fa;var jb=this,zb,zc,wc,id,qd,cd,of,mg,Yf,pf,wi,Rh,Oj,ii,bl;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wg){switch(wg.nextAddress){case 1:if(!jb.isUpdating()){wg.jumpTo(2);break}return wg.yield(jb.whenUpdated(),
2);case 2:zb=ac.promise.deferred();zc=zb.promise;wc=!!jb.target;jb.updateInProgress=zc;wg.setCatchFinallyBlocks(4);Fa&&(id=ac.LoadingIndicator.open("connecting to remote..."));if(!Fa){qd=ac.InspectionTree.forObject(da,jb);wg.jumpTo(6);break}return wg.yield(ac.RemoteInspectionTree.forObject(da,jb),7);case 7:qd=wg.yieldResult;case 6:return cd=qd,of=jb.ui.propertyTree,wg.yield(cd.collapse(cd.root,!1),8);case 8:if(!cd.root.children){wg.jumpTo(9);break}return wg.yield(cd.collapse(cd.root.children[0],!1),
9);case 9:if(mg=jb.originalTreeData&&jb.originalTreeData.diff(cd)){Yf=$jscomp.makeIterator(mg);for(pf=Yf.next();!pf.done;pf=Yf.next())wi=pf.value,Rh=$jscomp.makeIterator(wi),Oj=Rh.next().value,ii=Rh.next().value,Oj.refreshProperty(ii.value);wg.jumpTo(11);break}of.treeData=cd;return wg.yield(jb.filterProperties(),12);case 12:if(!of.treeData.root.isCollapsed){wg.jumpTo(13);break}return wg.yield(of.onNodeCollapseChanged({node:cd.root,isCollapsed:!1}),14);case 14:of.selectedIndex=1;case 13:return wg.yield(of.execCommand("uncollapse selected node"),
11);case 11:jb.toggleWindowStyle(wc);id&&id.remove();wg.leaveTryBlock(5);break;case 4:bl=wg.enterCatchBlock(),jb.showError(bl);case 5:jb.startStepping(1E3,"refreshAllProperties"),jb.updateInProgress=null,wg.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(da){da=void 0===da?!0:da;var Fa=this,jb,zb,zc,wc,id;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qd){if(1==qd.nextAddress)return jb=300,wc=Fa.ui.codeEditor.pluginFind(function(cd){return cd.runEval}),id=Fa.getWindow(),qd.yield(wc.runEval("System.get('@system-env').node"),
2);qd.yieldResult.value?(zc=[].concat($jscomp.arrayFromIterable(ac.arr.without(id.styleClasses,"local")),["node"]),zb=ac.DarkTheme.instance):(zc=["local"].concat($jscomp.arrayFromIterable(id?ac.arr.without(id.styleClasses,"node"):[])),zb=ac.DefaultTheme.instance);wc.theme=zb;da?(id&&id.animate({duration:jb,styleClasses:zc}),Fa.ui.codeEditor.animate({fill:zb.background,duration:jb})):id&&(id.styleClasses=zc);Fa.ui.codeEditor.textString=Fa.ui.codeEditor.textString;wc.highlight();qd.jumpToEnd()})}},
{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var da=this,Fa=Object.assign({type:"text",borderWidth:1,borderColor:ac.Color.gray,lineWrapping:"by-chars"},ac.config.codeEditor.defaultStyle,{textString:""}),jb=ac.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});ac.rect(0,0,this.width,30);
var zb=new ac.SearchField({styleClasses:["idle"],name:"searchField"});jb[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[zb,{type:"button",name:"targetPicker",padding:ac.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:ac.Icon.textAttribute("crosshairs")},new ac.LabeledCheckBox({label:"Internals",name:"internals"}),new ac.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new ac.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:ac.InspectionTree.forObject(null,this)})),ac.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},Fa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:ac.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(jb),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(jb),
[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){da.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var da=this,Fa,jb,zb,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){switch(wc.nextAddress){case 1:if(da.env.eventDispatcher.isKeyPressed("Shift"))return jb=$jscomp,zb=jb.makeIterator,wc.yield($world.execCommand("select morph",
{justReturn:!0}),5);da.toggleSelectionInstructions(!0);return wc.yield(ac.InteractiveMorphSelector.selectMorph(),4);case 4:Fa=wc.yieldResult;da.toggleSelectionInstructions(!1);wc.jumpTo(3);break;case 5:zc=zb.call(jb,wc.yieldResult),Fa=zc.next().value;case 3:Fa&&(da.targetObject=Fa),wc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(da){if(da&&!this.instructionWidget){var Fa=ac.morph({type:"label",name:"escapeKey",value:"esc"});Fa.whenRendered().then(function(){return Fa.fit()});
this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},Fa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",
value:function(da){da=da.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;da.epiMorph=!0;this.openWidget=da;ac.once(da,"close",this,"closeOpenWidget");ac.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var da=this.ui.propertyTree,Fa=da.textLayout.boundsFor(da,{column:0,row:da.selectedIndex-1});Fa=da.worldPoint(ac.pt(Fa.x,Fa.y+Fa.height/2)).addPt(da.scroll.negated());da=da.globalBounds();
Fa.x=this.globalBounds().center().x;Fa.y<da.top()?Fa=da.topCenter():da.bottom()-20<Fa.y&&(Fa=da.bottomCenter().addXY(0,-20));return Fa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(da){this.layout.row(1).height+=da.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(da){if(da!==
this.isEditorVisible()){var Fa=this.extent,jb=this.layout,zb=this.ui,zc=zb.terminalToggler,wc=zb.codeEditor,id=zb.thisBindingSelector;zb=zb.fixImportButton;jb.disable();da?(zc.fontColor=ac.Color.rgbHex("00e0ff"),jb.row(3).height=this.codeEditorHeight||180,jb.row(2).height=5,zb.animate({visible:!0,duration:200}),id.animate({visible:!0,duration:200})):(this.codeEditorHeight=jb.row(3).height,zc.fontColor=ac.Color.white,jb.row(3).height=jb.row(2).height=0,zb.animate({visible:!1,duration:200}),id.animate({visible:!1,
duration:200}));this.extent=Fa;jb.enable({duration:200});this.relayout({duration:200});wc.focus();wc.animate({opacity:da?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var da=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){da.makeEditorVisible(!da.isEditorVisible());Fa.jumpToEnd()})}},{key:"filterProperties",value:function(){var da=this,Fa,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return Fa=da.ui.searchField,jb=da.ui.propertyTree,
da.originalTreeData||(da.originalTreeData=jb.treeData),ac.disconnect(jb.treeData,"onWidgetOpened",da,"onWidgetOpened"),zb.yield(jb.treeData.filter({maxDepth:2,showUnknown:da.ui.unknowns.checked,showInternal:da.ui.internals.checked,iterator:function(zc){return Fa.matches(zc.key)}}),2);jb.update();ac.connect(jb.treeData,"onWidgetOpened",da,"onWidgetOpened");zb.jumpToEnd()})}},{key:"relayout",value:function(da){da=void 0===da?{}:da;var Fa=this,jb,zb,zc,wc,id,qd,cd,of,mg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yf){Fa.layout&&
Fa.layout.forceLayout();jb=Fa;zb=jb.ui;zc=zb.fixImportButton;wc=zb.terminalToggler;id=zb.propertyTree;qd=zb.thisBindingSelector;cd=id.bounds().insetBy(5).bottomLeft();of=id.bounds().insetBy(5).bottomRight();mg=of.subXY(zc.width+10,0);qd.width=115;qd.listMorph.itemHeight=20;da.duration?(wc.animate(Object.assign({bottomLeft:cd},da)),zc.animate(Object.assign({bottomRight:of},da)),qd.animate(Object.assign({bottomRight:mg},da))):(wc.bottomLeft=cd,zc.bottomRight=of,qd.bottomRight=mg);Yf.jumpToEnd()})}},
{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Kb._get(Object.getPrototypeOf(Db.prototype),"keybindings",this))}},{key:"commands",get:function(){return ac.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(da){if(System._testsRunning)return console.log(da.targetObject);
da=new this(da);da.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return da}},{key:"properties",get:function(){return{extent:{defaultValue:ac.pt(400,500)},fill:{defaultValue:ac.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(da){this.setProperty("remoteTarget",da);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(da,!0))}},targetObject:{after:["submorphs"],set:function(da){this._serializableTarget=
da&&da.isMorph?da.id:da;this.setProperty("targetObject",da);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(da))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var da=this.ui.propertyTree,Fa=da.treeData;return Fa.getContextFor(da.selectedNode||Fa.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),
fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},
treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:ac.Color.gray,fontSize:14,fontFamily:ac.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Ta,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:25386,end:45920})}(ac.Morph);Re=ac.Inspector;jf=Ea("I",Re);ac.default=Re;var qf=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");qf.Inspector=jf;qf.string=nd;qf.Morph=Dc;qf.pt=Qd;qf.Color=Cb;Re=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ha,Ta,Db){Db=void 0===Db?1:Db;var da,Fa,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),
zb.setCatchFinallyBlocks(2),Ta=Object.assign({},Ta,{logDoit:!0,inspect:!0,inspectDepth:Db}),zb.yield(Ha.doEval(void 0,Ta),4);case 4:da=zb.yieldResult;Fa=da.error?da.error:da.isError?da.value:null;zb.leaveTryBlock(3);break;case 2:Fa=jb=zb.enterCatchBlock();case 3:return Fa?Ha.showError(Fa):Ha.setStatusMessage(qf.string.truncate(da.value,1E3)),zb.return(da)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ha,Ta){var Db,da,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(jb){switch(jb.nextAddress){case 1:return jb.setCatchFinallyBlocks(2),
jb.yield(Ha.doEval({start:{row:0,column:0},end:Ha.documentEndPosition},Object.assign({},Ta,{logDoit:!0})),4);case 4:Db=jb.yieldResult;da=Db.error?Db.error:Db.isError?Db.value:null;jb.leaveTryBlock(3);break;case 2:da=Fa=jb.enterCatchBlock();case 3:return da?Ha.showError(da):Ha.setStatusMessage(String(Db.value)),jb.return(Db)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ha,Ta){var Db,da,Fa,jb,zb,zc,wc,id;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qd){switch(qd.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),
qd.setCatchFinallyBlocks(2),Ta=Object.assign({},Ta,{asString:!1,logDoit:!0}),qd.yield(Ha.doEval(void 0,Ta),4);case 4:Db=qd.yieldResult;da=Db.error?Db.error:Db.isError?Db.value:null;qd.leaveTryBlock(3);break;case 2:da=Fa=qd.enterCatchBlock();case 3:Ha.selection.collapseToEnd();if(jb=Db.value&&Db.value.isColor)return Ha.selection.text=String(Db.value),zb=new qf.Morph({fill:qf.Color.transparent,extent:qf.pt(Ha.fontSize+2,Ha.fontSize+2),submorphs:[{fill:Db.value,center:qf.pt(Ha.fontSize+2,Ha.fontSize+
2).scaleBy(.5)}]}),zc=Ha.selection.start,wc=zc.column,id=zc.row,Ha.insertText([zb,{}],Ha.selection.start),Ha.selection.start={column:wc,row:id},Ha.focus(),qd.return(Db);Ha.insertTextAndSelect(da?String(da)+(da.stack?"\n"+da.stack:""):String(Db.value));Ha.focus();return qd.return(Db)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ha,Ta){var Db,da,Fa,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){switch(zb.nextAddress){case 1:Ha.maybeSelectCommentOrLine();
da=Ha.textInRange(Ha.selection);Fa=Ha.evalEnvironment||{};jb=Ha.pluginFind(function(zc){return zc.isEditorPlugin&&"function"===typeof zc.runEval});Fa.systemInterface||(Fa.systemInterface=jb.systemInterface(Ta));if("local"!==Fa.systemInterface.name){zb.jumpTo(2);break}zb.setCatchFinallyBlocks(3);return zb.yield(Ha.doEval(void 0,Ta),5);case 5:Db=zb.yieldResult;da=Db.value;zb.leaveTryBlock(2);break;case 3:zb.enterCatchBlock();case 2:return Ha.world().execCommand("open object editor",{target:da,evalEnvironment:Fa}),
zb.return(Db)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Ha,Ta){var Db,da,Fa,jb,zb,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){switch(wc.nextAddress){case 1:Ha.maybeSelectCommentOrLine();Fa=Ha.textInRange(Ha.selection);jb=Ha.evalEnvironment||{};zb=Ha.pluginFind(function(id){return id.isEditorPlugin&&"function"===typeof id.runEval});jb.systemInterface||(jb.systemInterface=zb.systemInterface(Ta));
if("local"!==jb.systemInterface.name){qf.Inspector.openInWindow({remoteTarget:{code:Fa,evalEnvironment:jb}});wc.jumpTo(2);break}wc.setCatchFinallyBlocks(3);return wc.yield(Ha.doEval(void 0,Ta),5);case 5:Db=wc.yieldResult;da=Db.error?Db.error:Db.isError?Db.value:null;Fa=Db.value;wc.leaveTryBlock(4);break;case 3:da=zc=wc.enterCatchBlock();case 4:qf.Inspector.openInWindow({targetObject:da||Fa});case 2:return wc.return(Db)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(Ha,Ta,Db){Db=void 0===Db?1:Db;var da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),Fa.setCatchFinallyBlocks(2),Ta=Object.assign({},Ta,{inspect:!0,inspectDepth:Db,logDoit:!0}),Fa.yield(Ha.doEval(void 0,Ta),4);case 4:da=Fa.yieldResult;Fa.leaveTryBlock(3);break;case 2:Fa.enterCatchBlock();case 3:return Ha.selection.collapseToEnd(),Ha.insertTextAndSelect(da.value),Fa.return(da)}})}}];qf.codeEvaluationCommands=
Re;qf.codeEvaluationCommands=Re;qf.codeEvaluationCommands=Re;var rg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");rg.changeAttributeInSelectionOrMorph=function(Ha,Ta,Db){var da=Ha.selection;Ha.keepPosAtSameScrollOffsetWhile(function(){da.isEmpty()?Ha[Ta]="function"===typeof Db?Db(Ha[Ta]):Db:(Ha.undoManager.group(),Ha.changeStyleProperty(Ta,function(Fa){return"function"===typeof Db?Db(Fa):Db}),Ha.undoManager.group())})};jf=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(Ha){var Ta=Ha.fontSize;rg.changeAttributeInSelectionOrMorph(Ha,"fontSize",function(Db){Db=Db||Ta;return Db+(18<=Db?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ha){var Ta=Ha.fontSize;rg.changeAttributeInSelectionOrMorph(Ha,"fontSize",function(Db){Db=Db||Ta;return Db-(18>=Db?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ha){var Ta,Db,da,Fa,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress){Ta=
["serif","sans-serif","monospace"];if(Db=localStorage["lively.morpic/text-change-font-additional-fonts"])Db=JSON.parse(Db),Ta.push.apply(Ta,$jscomp.arrayFromIterable(Db));Ta.map(function(zc){return zc.toLowerCase()}).includes(Ha.fontFamily.toLowerCase())||(Ta.push(Ha.fontFamily),Db=[].concat($jscomp.arrayFromIterable(Db||[]),[Ha.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Db));return zb.yield($world.editListPrompt("choose font",Ta,{requester:Ha,preselect:Ta.indexOf(Ha.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}da=zb.yieldResult;Fa=$jscomp.makeIterator(da.selections);if(jb=Fa.next().value)Ha.fontFamily=jb;return zb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ha,Ta){Ta=void 0===Ta?{}:Ta;var Db,da,Fa,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress){if(Ta.hasOwnProperty("link"))return zb.jumpTo(2);da=Ha.selection;Fa=Ha.getStyleInRange(da);jb=Fa.link;return zb.yield(Ha.world().prompt("Set link",
{input:jb||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=zb.nextAddress&&(Db=zb.yieldResult,!Db))return zb.return();Ha.undoManager.group();Ha.setStyleInRange({link:Db||void 0},da);Ha.undoManager.group();zb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ha,Ta){var Db,da,Fa,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){if(1==zb.nextAddress)return Db=Ha.selection,da=Ha.getStyleInRange(Db),Fa=da.doit,zb.yield(Ha.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:Ha,input:Fa?Fa.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ha.evalEnvForDoit(Fa||{})}),2);jb=zb.yieldResult;Ha.undoManager.group();jb?Ha.addTextAttribute({doit:{code:jb},nativeCursor:"pointer",textDecoration:"underline"},Db):Ha.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Db);Ha.undoManager.group();zb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ha,Ta){Ta=void 0===Ta?{}:Ta;Ha.undoManager.group();
Ta=!Ta.onlySelection&&Ha.selection.isEmpty()?Ha.documentRange:Ha.selection.range;Ha.setStyleInRange(null,Ta);Ha.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ha){var Ta,Db,da,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(jb){if(1==jb.nextAddress)return jb.yield(System.import("lively.modules"),2);if(3!=jb.nextAddress)return Ta=jb.yieldResult,Db=Ta.module,jb.yield(Db("lively.ide/text/ui.js").load(),3);da=jb.yieldResult;Fa=da.RichTextControl;return jb.return(Fa.openFor(Ha))})}}];
rg.commands=jf;rg.commands=jf;rg.commands=jf;var Ve=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");Ve.guessTextModeName=te;Ve.rangedToken=function(Ha,Ta,Db,da,Fa){return{start:{row:Ha,column:Ta},end:{row:Ha,column:Db},token:da,mode:Fa}};Ve.fun=Rb;Ve.arr=lc;Ve.connect=Nc;Ve.disconnect=Pb;Ve.DefaultTheme=Va;Ve.tokenizeDocument=tb;Ve.modeInfo=fb;Ve.visitDocumentTokens=jc;Ve.getMode=Na;Ve.completionCommands=P;Ve.multiSelectCommands=Nb;Ve.navCommands=fd;Ve.codeCommands=qe;Ve.codeEvaluationCommands=
Re;Ve.richTextCommands=jf;Ve.Color=Cb;Ve.Range=af;Ve.guessTextModeName=te;Ve.guessTextModeName=te;Va=function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Db=Ta.hasOwnProperty("EditorPlugin")&&"function"===typeof Ta.EditorPlugin?Ta.EditorPlugin:Ta.EditorPlugin=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
Ve.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(da){var Fa=this;this.textMorph=da;Ve.connect(da,"textChange",this,"onTextChange");Ve.connect(da,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Fa.highlight()})}},
{key:"detach",value:function(da){Ve.disconnect(da,"textChange",this,"onTextChange");Ve.disconnect(da,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(da){this._ast=null;if(da){var Fa=this._tokenizerValidBefore;if("replace"===da.selector){var jb=da.args[0].start;da=jb.row;jb=jb.column}else jb=da=0;if(!Fa||da<Fa.row||da===Fa.row&&jb<Fa.column)da=Math.max(0,da),this._tokenizerValidBefore={row:da,
column:jb}}this.requestHighlight()}},{key:"requestHighlight",value:function(da){var Fa=this;(void 0===da?0:da)?this.highlight():Ve.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return Fa.highlight()})()}},{key:"highlight",value:function(){var da=this.textMorph,Fa=this.theme,jb=this.mode,zb=this._tokenizerValidBefore;if(Fa&&da&&da.document&&jb){da.fill=Fa.background;da.cursorColor=Fa.cursorColor||Ve.Color.black;var zc=da.viewState,wc={};zb=Ve.tokenizeDocument(jb,da.document,zc.firstVisibleRow,
zc.lastVisibleRow,zb);jb=zb.lines;zb=zb.tokens;if(jb.length){zc=jb[0].row;for(var id=[],qd=0;qd<zb.length;zc++,qd++)for(var cd=zb[qd],of=0;of<cd.length;of+=5){var mg=cd[of],Yf=cd[of+1],pf=Fa[cd[of+2]]||Fa.default;pf&&id.push({start:{row:zc,column:mg},end:{row:zc,column:Yf}},pf)}da.embeddedMorphs.forEach(function(wi){var Rh=da.embeddedMorphMap.get(wi).anchor;wc[wi.id]=da.textAttributeAt(Rh.position)});da.setTextAttributesWithSortedRanges(id);da.embeddedMorphs.forEach(function(wi){var Rh=da.embeddedMorphMap.get(wi).anchor;
Rh=Ve.Range.at(Rh.position);Rh.end.column+=1;da.replace(Rh,[wi,wc[wi.id]],!1)});this._tokenizerValidBefore={row:Ve.arr.last(jb).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},da,this)}}},{key:"visitTokensInRange",value:function(da,Fa){var jb=da.start,zb=da.end,zc=jb.row-1;Ve.visitDocumentTokens(this.mode,this.textMorph.document,jb.row,zb.row,null,function(wc){return zc++},function(wc,id,qd,cd,of,mg,Yf){if(zc===jb.row&&0<jb.column){if(jb.column>=cd)return;qd<jb.column&&jb.column<
cd&&(qd=jb.column)}if(zc===zb.row){if(zb.column<=qd)return;qd<zb.column&&zb.column<cd&&(cd=zb.column)}Fa(wc,id,zc,qd,cd,of,mg,Yf)})}},{key:"tokensInRange",value:function(da){var Fa=[];this.visitTokensInRange(da,function(jb,zb,zc,wc,id,qd,cd,of){return Fa.push(Ve.rangedToken(zc,wc,id,jb,of))});return Fa}},{key:"tokensOfRow",value:function(da){var Fa=this.textMorph.getLine(da).length;return this.tokensInRange({start:{row:da,column:0},end:{row:da,column:Fa}})}},{key:"tokenAt",value:function(da){for(var Fa=
this.tokensOfRow(da.row),jb=Fa.length;jb--;){var zb=Fa[jb];if(zb.token&&zb.start.column<=da.column&&da.column<=zb.end.column)return zb}return null}},{key:"getCommands",value:function(da){return[].concat($jscomp.arrayFromIterable(da),$jscomp.arrayFromIterable(Ve.completionCommands),$jscomp.arrayFromIterable(Ve.multiSelectCommands),$jscomp.arrayFromIterable(Ve.navCommands),$jscomp.arrayFromIterable(Ve.codeCommands),$jscomp.arrayFromIterable(Ve.codeEvaluationCommands),$jscomp.arrayFromIterable(Ve.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var da=this.mode,Fa=da.lineComment,jb=da.blockCommentStart;da=da.blockCommentEnd;var zb={};Fa&&(zb.lineCommentStart=Fa);jb&&(zb.blockCommentStart=jb);da&&(zb.blockCommentEnd=da);return zb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(da,Fa,jb){var zb=this.textMorph,zc=da.row,wc=da.column;da=Fa[wc-1];Fa=Fa[wc];zb.selection.text="\n";zb.selection.collapseToEnd();
"{"===da&&"}"===Fa&&(zb.selection.text="\n"+" ".repeat(jb),zb.selection.collapse());zb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:zc+1,lastRow:zc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var da=this.textMorph,Fa=this.openPairs,jb=da.selection,zb=da.getLine(jb.end.row),
zc=zb[jb.end.column-1];zb=zb[jb.end.column];da.autoInsertPairs&&jb.isEmpty()&&zc in Fa&&zb===Fa[zc]&&(jb.growRight(1),jb.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(da){var Fa=this.openPairs,jb=this.closePairs,zb=this.textMorph,zc=zb.selection,wc=zb.autoInsertPairs&&da in Fa,id=zb.autoInsertPairs&&da in jb;if(!wc&&!id)return!1;var qd=zb.getLine(zc.end.row)[zc.end.column];if(!zc.isEmpty()){if(!wc)return!1;jb=zb.undoManager.ensureNewGroup(zb);zb.insertText(Fa[da],zc.end);zb.insertText(da,
zc.start);zb.undoManager.group(jb);zc.growRight(-1);return!0}if(qd in jb&&da===qd)return zc.goRight(1),!0;if(id&&!wc)return!1;jb=zb.undoManager.ensureNewGroup(zb);zb.insertText(da+Fa[da]);zb.undoManager.group(jb);zc.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Ta,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);fb=Va=Ve.EditorPlugin;P=Ea("C",function(Ha){var Ta=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Db=Ta.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Ta.CodeMirrorEnabledEditorPlugin?Ta.CodeMirrorEnabledEditorPlugin:Ta.CodeMirrorEnabledEditorPlugin=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Kb(Db,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(){Kb._get(Object.getPrototypeOf(Db.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(da){this.mode=this.codeMirrorMode(da);return Kb._get(Object.getPrototypeOf(Db.prototype),"attach",this).call(this,da)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",
value:function(da){return{indentWithTabs:!da.useSoftTabs,indentUnit:da.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(da){da=this.defaultCodeMirrorModeConfig(da);return Ve.getMode(da,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Ta,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(Ve.EditorPlugin));Ve.CodeMirrorEnabledEditorPlugin=P;Ve.CodeMirrorEnabledEditorPlugin=P;Ve.CodeMirrorEnabledEditorPlugin=P;Ve.default=Va;Va=Object.freeze({__proto__:null,guessTextModeName:te,"default":fb,CodeMirrorEnabledEditorPlugin:P});Ea("e",Va)}}});
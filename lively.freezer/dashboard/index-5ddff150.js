System.register(["./__root_module__-cddb8267.js","./index-51795659.js","./color-picker-3ee1bf1f.js"],function(){var Ea,Cb,Kb,lc,$b,Qd,Zc,Rd,ad,Nc,nd,he,af,Af,rd,cc,Ic,Kd,Kc,Bd,be,yc,Cc,Pb,Dc,Xc,Cd,Od;return{setters:[function(Gb){Ea=Gb.ax;Cb=Gb.a7;Kb=Gb.a8;lc=Gb.aY;$b=Gb.a6;Qd=Gb.ac;Zc=Gb.ad;Rd=Gb.aD;ad=Gb.ap;Nc=Gb.ab;nd=Gb.an;he=Gb.as;af=Gb.a3;Af=Gb.a1;rd=Gb.C;cc=Gb.au;Ic=Gb.aj;Kd=Gb.bR;Kc=Gb.bs;Bd=Gb.af;be=Gb.aw;yc=Gb.bk;Cc=Gb.br;Pb=Gb.bp;Dc=Gb.bT},function(Gb){Xc=Gb.N;Cd=Gb.I},function(Gb){Od=
Gb.a}],execute:function(){var Gb=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js");Gb.fun=Ea;Gb.string=Cb;Gb.obj=Kb;Gb.properties=lc;Gb.arr=$b;Gb.Text=Qd;Gb.config=Zc;Gb.HorizontalLayout=Rd;Gb.VerticalLayout=ad;Gb.morph=Nc;Gb.Morph=nd;Gb.Icon=he;Gb.pt=af;Gb.Rectangle=Af;Gb.Color=rd;Gb.connect=cc;Gb.once=Ic;Gb.noUpdate=Kd;Gb.ColorPicker=Od;Gb.DropDownList=Kc;Gb.loadObjectFromPartsbinFolder=Bd;Gb.cachedControls=new WeakMap;var sb=function(Sa){var Ua=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js"),
cb=Ua.hasOwnProperty("RichTextControl")&&"function"===typeof Ua.RichTextControl?Ua.RichTextControl:Ua.RichTextControl=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return be(cb,Sa,[{key:"toggleButton",value:function(ab,qb){ab.master=qb?{auto:"styleguide://SystemIDE/selected button"}:{auto:"styleguide://System/dark button"}}},{key:"reset",value:function(){var ab=this.ui.fontSelection;ab.items=Gb.RichTextControl.basicFontItems();
ab.selection=ab.items[0].value;Gb.connect(this.target,"selectionChange",this,"update")}},{key:"alignAtTarget",value:function(ab){ab=void 0===ab?!!this.world():ab;var qb=this.target,Zb=qb.world()||$world,kc=this.globalBounds();qb=(qb.selection.isEmpty()?qb.globalBounds():qb.getGlobalTransform().transformRectToRect(qb.selectionBounds().translatedBy(qb.scroll.negated()))).bottomCenter().subPt(kc.topCenter());Zb=Zb.visibleBounds().translateForInclusion(kc.translatedBy(qb)).topLeft().subPt(kc.topLeft());
Zb=this.position.addPt(Zb);ab?this.animate({duration:300,position:Zb}):this.position=Zb}},{key:"removeFocus",value:function(){this.autoRemove&&this.target&&(this.remove(),this.target=null)}},{key:"focusOn",value:function(ab,qb){qb=void 0===qb?!0:qb;var Zb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){if(1==kc.nextAddress)return Zb.target=ab,Zb.update(),kc.yield(Zb.whenRendered(),2);Zb.ui.fontSizeField.relayout();qb&&Zb.alignAtTarget();kc.jumpToEnd()})}},{key:"setupConnections",
value:function(){Gb.connect(this.ui.paddingField,"number",this,"setPadding");Gb.connect(this.ui.paddingFieldTop,"number",this,"setPaddingTop");Gb.connect(this.ui.paddingFieldBottom,"number",this,"setPaddingBottom");Gb.connect(this.ui.paddingFieldLeft,"number",this,"setPaddingLeft");Gb.connect(this.ui.paddingFieldRight,"number",this,"setPaddingRight")}},{key:"update",value:function(){var ab=this,qb=this.target,Zb=this.updateSpec,kc=qb.selection;kc=kc?kc.isEmpty()?qb.textAttributeAt(kc.start):qb.getStyleInRange(kc):
{};var Rb=this.managedProps,ma=Gb.obj.select(qb,Rb);qb=$jscomp.makeIterator(Object.entries(Gb.obj.select(kc||{},Rb)));for(kc=qb.next();!kc.done;kc=qb.next())Rb=$jscomp.makeIterator(kc.value),kc=Rb.next().value,Rb=Rb.next().value,"undefined"!==typeof Rb&&(ma[kc]=Rb);Gb.noUpdate(function(){for(var Ia=$jscomp.makeIterator(Object.entries(ab.ui)),W=Ia.next();!W.done;W=Ia.next()){var sa=$jscomp.makeIterator(W.value);W=sa.next().value;sa=sa.next().value;if(Zb[W])Zb[W](ma,sa)}})}},{key:"relayout",value:function(){}},
{key:"changeAttributeInSelectionOrMorph",value:function(ab,qb){var Zb=this.target,kc=Zb.selection;Zb.isLabel||kc.isEmpty()?Zb[ab]="function"===typeof qb?qb(Zb[ab]):qb:(Zb.undoManager.group(),Zb.changeStyleProperty(ab,function(Rb){return"function"===typeof qb?qb(Rb):qb}),Zb.undoManager.group())}},{key:"changeFont",value:function(ab){var qb=this,Zb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){if(1==kc.nextAddress)return qb._last=ab,(Zb="custom..."===ab)?kc.yield($world.prompt("Enter font family name",
{requester:qb.target,historyId:"lively.morphic-rich-text-font-names",useLastInput:!0}),3):kc.jumpTo(2);if(2!=kc.nextAddress&&(ab=kc.yieldResult,!ab))return kc.return();qb.changeAttributeInSelectionOrMorph("fontFamily",ab);kc.jumpToEnd()})}},{key:"setPadding",value:function(ab){this.target.padding=Gb.Rectangle.inset(ab)}},{key:"setPaddingTop",value:function(ab){var qb=this.target.padding;this.target.padding=Gb.Rectangle.inset(qb.left(),ab,qb.right(),qb.bottom())}},{key:"setPaddingLeft",value:function(ab){var qb=
this.target.padding;this.target.padding=Gb.Rectangle.inset(ab,qb.top(),qb.right(),qb.bottom())}},{key:"setPaddingRight",value:function(ab){var qb=this.target.padding;this.target.padding=Gb.Rectangle.inset(qb.left(),qb.top(),ab,qb.bottom())}},{key:"setPaddingBottom",value:function(ab){var qb=this.target.padding;this.target.padding=Gb.Rectangle.inset(qb.left(),qb.top(),qb.right(),ab)}},{key:"setLineWrapping",value:function(ab){this.target.lineWrapping=ab}},{key:"changeFontWeight",value:function(ab){this.changeAttributeInSelectionOrMorph("fontWeight",
ab)}},{key:"changeTextAlign",value:function(ab){this.changeAttributeInSelectionOrMorph("textAlign",ab)}},{key:"changeFontColor",value:function(ab){this.changeAttributeInSelectionOrMorph("fontColor",ab)}},{key:"changeFontSize",value:function(ab){this.changeAttributeInSelectionOrMorph("fontSize",ab)}},{key:"changeFixedWidth",value:function(ab){this.target.fixedWidth=ab}},{key:"changeFixedHeight",value:function(ab){this.target.fixedHeight=ab}},{key:"changeLink",value:function(){var ab=this,qb,Zb,kc,
Rb,ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){if(1==Ia.nextAddress)return qb=ab.target,Zb=qb.selection,kc=qb.getStyleInRange(Zb),Rb=kc.link,Ia.yield(ab.world().prompt("Set link",{input:Rb||"https://"}),2);ma=Ia.yieldResult;qb.undoManager.group();qb.setStyleInRange({link:ma||void 0},Zb);qb.undoManager.group();ab.autoRemove&&ab.remove();Ia.jumpToEnd()})}},{key:"toggleUnderline",value:function(){this.changeAttributeInSelectionOrMorph("textDecoration",function(ab){return"underline"===
ab?"none":"underline"})}},{key:"toggleItalic",value:function(){this.changeAttributeInSelectionOrMorph("fontStyle",function(ab){return"italic"===ab?"normal":"italic"})}},{key:"toggleBold",value:function(){this.changeAttributeInSelectionOrMorph("fontWeight",function(ab){return"bold"===ab||"700"===ab?"normal":"bold"})}},{key:"copyStyle",value:function(){var ab=this,qb=this.target,Zb=this.ui.applyStyleButton;qb=qb.selection.isEmpty()?qb.defaultTextStyle:qb.getStyleInRange(qb.selection);var kc=JSON.stringify(qb,
null,2);this.constructor.copiedStyle=qb;Zb.tooltip="paste style\n"+kc;this.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/plain",data:kc},{type:"application/morphic-text-style",styleString:kc}]).then(function(){return ab.setStatusMessage("Copied style\n"+kc)}).catch(function(Rb){return ab.showError(Rb)})}},{key:"pasteStyle",value:function(){var ab=this,qb=this.target,Zb=this.constructor.copiedStyle;qb.selection.isEmpty()?Object.assign(qb,Zb):qb.selections.forEach(function(kc){return qb.addTextAttribute(ab.constructor.copiedStyle,
kc)});this.update()}},{key:"clearStyle",value:function(){var ab=this.target;ab.selections.forEach(function(qb){return ab.resetStyleInRange(qb)});this.update()}},{key:"configureRichTextOptions",value:function(){this.getSubmorphNamed("config panel")&&this.getSubmorphNamed("config panel").remove();var ab=this.defaultSpec,qb=this.uiSpec;ab=this.addMorph({name:"config panel",layout:new Gb.VerticalLayout({spacing:5}),epiMorph:!0,submorphs:[].concat($jscomp.arrayFromIterable(Object.keys(ab).map(function(Zb){var kc=
qb.rows.some(function(Rb){return Rb.some(function(ma){return ma===Zb})});return{type:"labeledcheckbox",label:Zb,name:Zb,checked:kc}})),[{layout:new Gb.HorizontalLayout({spacing:3}),submorphs:[{type:"button",name:"OK button",label:"OK"},{type:"button",name:"cancel button",label:"Cancel"}]}])});ab.center=this.innerBounds().center();Gb.connect(ab.getSubmorphNamed("OK button"),"fire",this,"configureAccepted");Gb.connect(ab.getSubmorphNamed("cancel button"),"fire",this,"configureCanceled")}},{key:"configureAccepted",
value:function(){var ab=this.getSubmorphNamed("config panel");ab&&(ab.remove(),ab.submorphs.filter(function(qb){return"LabeledCheckBox"===qb.constructor.name}))}},{key:"configureCanceled",value:function(){var ab=this.getSubmorphNamed("config panel");ab&&ab.remove()}},{key:"close",value:function(){var ab=this;this.target&&this.target.attributeConnections&&this.target.attributeConnections.forEach(function(qb){return qb.targetObj===ab&&qb.disconnect()});this.remove()}},{key:"alwaysTargetFocusedMorph",
value:function(){this.startStepping(1500,"updateTarget")}},{key:"updateTarget",value:function(){var ab=this.world();ab&&(ab=ab.focusedMorph)&&(ab.isLabel||ab.isText)&&!this.isAncestorOf(ab)&&this.target!==ab&&this.focusOn(ab,!1)}},{key:"onMouseUp",value:function(ab){var qb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zb){if(1==Zb.nextAddress)return Zb.yield(qb.whenRendered(),2);qb.update();Zb.jumpToEnd()})}},{key:"attachToWorld",value:function(){Gb.connect($world,"onMouseDown",
this,"updateTarget",{garbageCollect:!0})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RichTextControl"}},{key:"properties",get:function(){return{autoRemove:{defaultValue:!1},target:{},toggleColor:{},managedProps:{readOnly:!0,get:function(){return"fontFamily fontWeight fontSize fontStyle isText fontColor textAlign link textDecoration fixedWidth fixedHeight lineWrapping padding".split(" ")}},updateSpec:{get:function(){var ab=this;return Object.assign({fontSelection:function(qb,Zb){var kc=
qb.fontFamily;(qb=kc&&Zb.items.find(function(Rb){return Rb.value.toLowerCase()===kc.toLowerCase()}))?Zb.selection=qb.value:kc&&(Zb.items=Zb.items.concat({isListItem:!0,label:[kc,{fontFamily:kc}],value:kc}),Zb.selection=Gb.arr.last(Zb.items));Zb.fit();Zb.width=Math.max(Zb.width,170)},fontWeightSelection:function(qb,Zb){Zb.selection="normal"==qb.fontWeight?"Medium":qb.fontWeight?Gb.string.capitalize(qb.fontWeight):"Medium"},boldButton:function(qb,Zb){ab.toggleButton(Zb,"bold"===qb.fontWeight)},italicButton:function(qb,
Zb){ab.toggleButton(Zb,"italic"===qb.fontStyle)},underlineButton:function(qb,Zb){ab.toggleButton(Zb,"underline"===qb.textDecoration)},linkButton:function(qb,Zb){ab.toggleButton(Zb,!!qb.link)},colorPicker:function(qb,Zb){Zb.colorValue=qb.fontColor},fontSizeField:function(qb,Zb){Zb.number=qb.fontSize},fixedWidthControl:function(qb,Zb){qb.isText?Zb.enable():Zb.disable();Zb.checked=qb.fixedWidth},fixedHeightControl:function(qb,Zb){qb.isText?Zb.enable():Zb.disable();Zb.checked=qb.fixedHeight},lineWrappingControl:function(qb,
Zb){var kc=$jscomp.makeIterator(Zb.submorphs);Zb=kc.next().value;kc=kc.next().value;Zb.checked=!!qb.lineWrapping;qb.isText?Zb.enable():Zb.disable();kc.deactivated=!qb.lineWrapping;kc.deactivated?kc.opacity=.5:(kc.opacity=1,kc.selection=qb.lineWrapping)},paddingControl:function(qb,Zb){var kc=qb.padding,Rb=kc.left();qb=kc.top();var ma=kc.right();kc=kc.bottom();var Ia=!Gb.arr.every([Rb,qb,ma,kc],function(W){return W==Rb});Zb.get("multi value indicator").visible=Ia;Gb.connect(Zb.get("multi value indicator"),
"onMouseDown",Zb.get("padding field"),"number",{converter:"() => left",varMapping:{left:Rb}});Zb.get("padding field").number=Rb;Zb.get("padding field").visible=!Ia;Zb.get("padding field top").number=qb;Zb.get("padding field left").number=Rb;Zb.get("padding field right").number=ma;Zb.get("padding field bottom").number=kc}},["left","center","right","block"].reduce(function(qb,Zb){qb[Zb+"Align"]=function(kc,Rb){Rb.deactivated=!kc.isText;ab.toggleButton(Rb,kc.textAlign==Zb)};return qb},{}))}},ui:{get:function(){var ab=
this,qb={fontSelection:"font selection",fontWeightSelection:"font weight selection",boldButton:"bold button",italicButton:"italic button",underlineButton:"underline button",linkButton:"link button",leftAlign:"left align",centerAlign:"center align",rightAlign:"right align",blockAlign:"block align",fontSizeField:"font size field",colorPicker:"color picker",copyStyleButton:"copy style",applyStyleButton:"apply style",removeStyleButton:"remove style",fixedHeightControl:"fixed height control",fixedWidthControl:"fixed width control",
lineWrappingControl:"line wrapping control",paddingControl:"padding control",paddingField:"padding field",paddingFieldTop:"padding field top",paddingFieldLeft:"padding field left",paddingFieldRight:"padding field right",paddingFieldBottom:"padding field bottom"};return Gb.obj.extract(qb,Gb.obj.keys(qb),function(Zb,kc){return ab.getSubmorphNamed(kc)})}}}}},{key:"openDebouncedFor",value:function(ab){var qb=ab.selection;if(qb.isEmpty()){var Zb=Gb.cachedControls.get(ab);Zb&&(Zb.update(),Zb.alignAtTarget(),
Zb.world()||ab.world().addMorph(Zb))}else Gb.fun.debounceNamed(ab.id+"openRichTextControl",600,function(){var kc=Gb.cachedControls.get(ab);qb.isEmpty()?kc&&kc.removeFocus():(kc&&kc.world()||(kc=new Gb.RichTextControl,Gb.cachedControls.set(ab,kc)),ab.world().addMorph(kc),kc.focusOn(ab,!0),kc.alwaysTargetFocusedMorph())})()}},{key:"openFor",value:function(ab){var qb=Gb.cachedControls.get(ab);qb?qb.update():(qb=new Gb.RichTextControl,Gb.cachedControls.set(ab,qb),qb.focusOn(ab,!0),qb.alwaysTargetFocusedMorph());
qb.alignAtTarget();qb.world()||ab.world().addMorph(qb);return qb}}],Ua,{pathInPackage:function(){return"text/ui.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:624,end:17067})}(Gb.Morph);Gb.RichTextControl=sb;Gb.RichTextControl=sb;Gb.RichTextControl=sb;sb=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js");sb.SearchField=
yc;var Bc=function(Sa){var Ua=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js"),cb=Ua.hasOwnProperty("ProtoSearchField")&&"function"===typeof Ua.ProtoSearchField?Ua.ProtoSearchField:Ua.ProtoSearchField=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return be(cb,Sa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoSearchField"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],
Ua,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoSearchField",version:"0.1.1-0"}}},{start:76,end:221})}(sb.SearchField);Bc=sb.ProtoSearchField;sb.default=Bc;var gb=lively.FreezerRuntime.recorderFor("ProtoTree/index.js");gb.Tree=Cc;gb.TreeData=Pb;sb=function(Sa){var Ua=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),
cb=Ua.hasOwnProperty("TestTreeData")&&"function"===typeof Ua.TestTreeData?Ua.TestTreeData:Ua.TestTreeData=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return be(cb,Sa,[{key:"display",value:function(ab){return ab.name}},{key:"isCollapsed",value:function(ab){return ab.isCollapsed}},{key:"collapse",value:function(ab,qb){ab.isCollapsed=qb}},{key:"getChildren",value:function(ab){return ab.isLeaf?null:ab.isCollapsed?[]:
ab.children}},{key:"isLeaf",value:function(ab){return ab.isLeaf}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TestTreeData"}}],Ua,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:113,end:417})}(gb.TreeData);gb.TestTreeData=sb;gb.TestTreeData=sb;gb.TestTreeData=sb;sb=function(Sa){var Ua=
lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),cb=Ua.hasOwnProperty("ProtoTree")&&"function"===typeof Ua.ProtoTree?Ua.ProtoTree:Ua.ProtoTree=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return be(cb,Sa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoTree"}},{key:"properties",get:function(){return{treeData:{initialize:function(){this.treeData=new gb.TestTreeData({name:"root",isCollapsed:!1,
isLeaf:!1,children:[{name:"child 1",isLeaf:!0},{name:"child 2",isLeaf:!1,isCollapsed:!0,children:[{name:"child 2 - 1",isLeaf:!0}]},{name:"child 3",isLeaf:!1,isCollapsed:!1,children:[{name:"child 3 - 1",isLeaf:!0},{name:"child 3 - 2",isLeaf:!0}]},{name:"child 4",isLeaf:!0}]})}},master:{initialize:function(){}}}}}],Ua,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:434,end:1297})}(gb.Tree);sb=gb.ProtoTree;gb.default=sb;sb=lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js");sb.NumberWidget=Xc;Bc=function(Sa){var Ua=lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js"),cb=Ua.hasOwnProperty("ProtoNumberWidget")&&"function"===typeof Ua.ProtoNumberWidget?Ua.ProtoNumberWidget:Ua.ProtoNumberWidget=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return be(cb,Sa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoNumberWidget"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],Ua,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoNumberWidget",version:"0.1.1-0"}}},{start:76,end:224})}(sb.NumberWidget);Bc=sb.ProtoNumberWidget;
sb.default=Bc;sb=lively.FreezerRuntime.recorderFor("FrameResizer/index.js");sb.Morph=nd;Bc=function(Sa){var Ua=lively.FreezerRuntime.recorderFor("FrameResizer/index.js"),cb=Ua.hasOwnProperty("FrameResizer")&&"function"===typeof Ua.FrameResizer?Ua.FrameResizer:Ua.FrameResizer=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return be(cb,Sa,[{key:"onDrag",value:function(ab){var qb=this.owner.left;ab=ab.positionIn(this).x;
ab*="left"==this.direction?-1:1;this.owner.width+=ab;350>this.owner.width&&(ab+=350-this.owner.width,this.owner.width=350);this.owner.left="left"==this.direction?qb-ab:qb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FrameResizer"}},{key:"properties",get:function(){return{direction:{type:"Enum",values:["left","right"]}}}}],Ua,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"FrameResizer",version:"0.1.1-24"}}},{start:56,end:840})}(sb.Morph);Bc=sb.FrameResizer;sb.default=Bc;var rb=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js");rb.Morph=nd;rb.morph=Nc;rb.layouts=Dc;rb.string=Cb;rb.connect=cc;rb.noUpdate=Kd;rb.InteractiveMorphSelector=Cd;rb.Color=rd;rb.pt=af;sb=function(Sa){var Ua=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js"),cb=Ua.hasOwnProperty("ShapeLayoutControl")&&"function"===typeof Ua.ShapeLayoutControl?
Ua.ShapeLayoutControl:Ua.ShapeLayoutControl=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return be(cb,Sa,[{key:"focusOn",value:function(ab){this.target=ab;this.update(!1)}},{key:"setupConnections",value:function(){var ab=this.ui;rb.connect(ab.submorphSettingsControl,"fire",this,"chooseSubmorphToChangeLayoutSettings");rb.connect(ab.dragmeControl,"onDragStart",this,"onSubmorphSettingsDragStart");rb.connect(ab.xAxisPolicyControl,
"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "x",\n        submorph: self.selectedSubmorph,\n      })',varMapping:{self:this}});rb.connect(ab.yAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "y",\n        submorph: self.selectedSubmorph,\n      })',varMapping:{self:this}});for(var qb={},Zb=$jscomp.makeIterator(this.managedProps),kc=Zb.next();!kc.done;qb=
{$jscomp$loop$prop$prop$2545:qb.$jscomp$loop$prop$prop$2545},kc=Zb.next()){var Rb=$jscomp.makeIterator(kc.value),ma=Rb.next().value;kc=Rb.next().value;Rb.next().value||(qb.$jscomp$loop$prop$prop$2545=this.join(ma),Rb=ab[this.join(ma,"control")],rb.connect(Rb,kc,this,"updateLayout",{updater:function(Ia){return function(W,sa){W(Ia.$jscomp$loop$prop$prop$2545,sa)}}(qb),varMapping:{prop:qb.$jscomp$loop$prop$prop$2545}}))}}},{key:"lower",value:function(ab){return ab.charAt(0).toLowerCase()+ab.slice(1)}},
{key:"join",value:function(ab,qb){return this.lower(rb.string.camelCaseString(ab+(qb?" "+qb:"")))}},{key:"updateLayoutOfTarget",value:function(ab){ab=rb.layouts[rb.string.camelCaseString(ab)];this.target.layout=ab?new ab({autoResize:!1}):null;this.update()}},{key:"updateLayout",value:function(ab,qb){this.target.layout[ab]=qb}},{key:"update",value:function(ab){var qb=this;this.target&&rb.noUpdate(function(){for(var Zb=qb.ui,kc=qb.target.layout||{name:function(){return"No"}},Rb=$jscomp.makeIterator(qb.managedProps),
ma=Rb.next();!ma.done;ma=Rb.next()){var Ia=$jscomp.makeIterator(ma.value);ma=Ia.next().value;var W=Ia.next().value;Ia.next();Ia=Zb[qb.join(ma,"control")];var sa=Zb[qb.join(ma,"label")];if(W)if("type"===ma)Ia.selection=kc.name()+" Layout";else{var Za=kc[qb.join(ma)],mb="undefined"!==typeof Za;if(mb){switch(ma){case "align":Ia.items=kc.possibleAlignValues;break;case "direction":Ia.items=kc.possibleDirectionValues;break;case "axis":Ia.items=kc.possibleAxisValues}Ia[W]=Za}sa.isLayoutable=sa.visible=mb}}qb.showGridLayoutControl("Grid"===
kc.name());qb.showProportionalControl("Proportional"===kc.name())})}},{key:"updateSubmorphProportionalLayoutSettings",value:function(ab){var qb={};this.target.layout.changeSettingsFor(ab.submorph,(qb[ab.axis]=ab.policy,qb),!0)}},{key:"onSubmorphSettingsDragStart",value:function(ab){var qb=this;ab.stop();var Zb=this.target.layout,kc=Zb.settingsFor(this.selectedSubmorph),Rb=[],ma;for(ma in kc)Rb=[].concat($jscomp.arrayFromIterable(Rb),[ma+": ",{fontWeight:"bold"},kc[ma]+" ",{}]);var Ia=rb.morph({type:"label",
fontColor:rb.Color.white,value:Rb,fill:rb.Color.black.withA(.7),padding:5,borderRadius:10,isLayoutable:!1});Ia.wantsToBeDroppedOn=function(W){return Zb.layoutableSubmorphs.includes(W)};Ia.onBeingDroppedOn=function(W,sa){Ia.remove();if(W=Zb.layoutableSubmorphs.includes(sa)?sa:ab.world.morphsContainingPoint(ab.hand.position).find(function(Za){return Zb.layoutableSubmorphs.includes(Za)}))qb.updateSubmorphProportionalLayoutSettings({policy:kc.x,axis:"x",submorph:W}),qb.updateSubmorphProportionalLayoutSettings({policy:kc.y,
axis:"y",submorph:W}),W.show(),$world.setStatusMessage("layout settings applied")};ab.hand.grab(Ia);Ia.moveBy(rb.pt(10,10))}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var ab=this,qb,Zb,kc,Rb,ma,Ia,W,sa,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){switch(mb.nextAddress){case 1:return qb=ab.target.layout.layoutableSubmorphs,ab.manageFocus=!0,ab.env.eventDispatcher.isKeyPressed("Shift")?(kc=qb.map(function(rc){return{isListItem:!0,string:String(rc),value:rc}}),
mb.yield($world.listPrompt("Select morph",kc,{onSelection:function(rc){return rc.show()}}),5)):mb.yield(rb.InteractiveMorphSelector.selectMorph(ab.world(),ab,function(rc){return qb.includes(rc)}),4);case 4:Zb=mb.yieldResult;mb.jumpTo(3);break;case 5:Rb=mb.yieldResult,ma=$jscomp.makeIterator(Rb.selected),Zb=ma.next().value;case 3:ab.manageFocus=!1;ab.selectedSubmorph=Zb;if(!Zb)return mb.return();Ia=ab.ui;W=Ia.xAxisPolicyControl;sa=Ia.yAxisPolicyControl;Za=ab.target.layout.settingsFor(Zb);rb.noUpdate(function(){W.selection=
Za.x;sa.selection=Za.y});mb.jumpToEnd()}})}},{key:"showProportionalControl",value:function(ab){var qb=this.ui;[qb.submorphSettingsControl,qb.dragmeControl,qb.xAxisPolicyControl,qb.xAxisPolicyLabel,qb.yAxisPolicyControl,qb.yAxisPolicyLabel].forEach(function(Zb){Zb.isLayoutable=ab;Zb.visible=ab})}},{key:"showGridLayoutHalo",value:function(){$world.showLayoutHaloFor(this.target)}},{key:"showGridLayoutControl",value:function(ab){var qb=this.ui.configureGridLayoutControl;qb.visible=qb.isLayoutable=ab}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShapeLayoutControl"}},{key:"properties",get:function(){return{managedProps:{get:function(){return[["type","selection",!0],["align","selection"],["direction","selection"],["axis","selection"],["spacing","number"],["auto resize","checked"],["resize submorphs","checked"],["x axis policy","selection",!0],["y axis policy","selection",!0],["react to submorph animations","checked"],["submorph settings",!1,!0],["order by index","checked"],["dragme",
!1,!0],["configure grid layout",!1,!0]]}},ui:{readOnly:!0,get:function(){for(var ab={labelContainer:this.getSubmorphNamed("label container"),controlContainer:this.getSubmorphNamed("control container")},qb=$jscomp.makeIterator(this.managedProps),Zb=qb.next();!Zb.done;Zb=qb.next()){var kc=$jscomp.makeIterator(Zb.value).next().value;Zb=kc+" label";kc+=" control";ab[this.join(Zb)]=this.getSubmorphNamed(Zb);ab[this.join(kc)]=this.getSubmorphNamed(kc)}return ab}}}}}],Ua,{pathInPackage:function(){return"index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ShapeLayoutControl",version:"0.1.1-166"}}},{start:345,end:7771})}(rb.Morph);sb=rb.ShapeLayoutControl;rb.default=sb}}});
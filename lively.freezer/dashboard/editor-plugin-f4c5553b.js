System.register(["./__root_module__-255c8c26.js","./index-e74b4e71.js","./index-4d90b762.js"],function(Da){var Ab,Tb,kc,ec,he,gd,Zd,kd,Sc,yd,Od,fe,Ud,md,db,Fb,tc,nc,td,ke,zc,Ec,Pb,Qb,Tc,ld,Rb,qb,bc,Ic,ra,Fa,mb,ub,Db,cb,fb,Eb,qc,gc,Oc,Wc,Q,ea,Ia;return{setters:[function(Ra){Ab=Ra.C;Tb=Ra.ar;kc=Ra.a5;ec=Ra.a0;he=Ra.a2;gd=Ra.am;Zd=Ra.bg;kd=Ra.aU;Sc=Ra.ap;yd=Ra.s;Od=Ra.aO;fe=Ra.bn;Ud=Ra.bo;md=Ra.a6;db=Ra.at;Fb=Ra.ao;tc=Ra.aq;nc=Ra.bp;td=Ra.bq;ke=Ra.a1;zc=Ra.P;Ec=Ra._;Pb=Ra.aW;Qb=Ra.ah;Tc=Ra.ai;ld=
Ra.aj;Rb=Ra.ak;qb=Ra.aA;bc=Ra.aZ;Ic=Ra.aw;ra=Ra.an;Fa=Ra.a9;mb=Ra.br;ub=Ra.L;Db=Ra.bs;cb=Ra.b2;fb=Ra.bh;Eb=Ra.b1;qc=Ra.bt;gc=Ra.as},function(Ra){Oc=Ra.M;Wc=Ra.I;Q=Ra.v;ea=Ra.p},function(Ra){Ia=Ra.localInterface}],execute:function(){function Ra(Ja,ab){if(!0===ab)return ab;if(Ja.copyState)return Ja.copyState(ab);Ja={};for(var Jb in ab){var ba=ab[Jb];ba instanceof Array&&(ba=ba.concat([]));Ja[Jb]=ba}return Ja}function cc(Ja,ab,Jb){return Ja.startState?Ja.startState(ab,Jb):!0}function Nb(Ja,ab){return P.modes[Ja]=
ab}function $a(Ja){if("string"==typeof Ja&&P.mimeModes.hasOwnProperty(Ja))Ja=P.mimeModes[Ja];else if(Ja&&"string"==typeof Ja.name&&P.mimeModes.hasOwnProperty(Ja.name)){var ab=P.mimeModes[Ja.name];"string"==typeof ab&&(ab={name:ab});Ja=Object.assign({},ab,Ja);Ja.name=ab.name}else{if("string"==typeof Ja&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ja))return $a("application/xml");if("string"==typeof Ja&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ja))return $a("application/json")}return"string"==typeof Ja?{name:Ja}:Ja||{name:"null"}}
function ic(Ja,ab){ab=P.resolveMode(ab);"string"===typeof ab&&(ab={name:ab});if(!ab.name)throw Error("parserConfig does not have a name of the mode to get");var Jb=P.modes[ab.name];if(!Jb)return ic(Ja,"text/plain");Ja=Object.assign({indentUnit:2},Ja);return Object.assign(Jb(Ja,ab),{name:ab.name})}function nd(Ja,ab){for(var Jb;Ja.innerMode;){Jb=Ja.innerMode(ab);if(!Jb||Jb.mode==Ja)break;ab=Jb.state;Ja=Jb.mode}return Jb||{mode:Ja,state:ab}}function vd(Ja,ab){P.mimeModes[Ja]=ab}function Xc(Ja,ab,Jb){}
function Wa(Ja,ab,Jb,ba,Ka,ob,yb){var Jc=Ja.editorPlugin._tokenizerValidBefore;Jc&&Jc.row>=Jb&&(Jc.row=Jb-1);var wc=P.linesToTokenize(Ja.document,Jb,ba,Jc);Jc=wc.lines;wc=wc.state;if(!Jc.length)return!1;wc=wc?P.copyState(ab,wc):P.startState(ab);for(var Dd=0;Dd<Jc.length;Dd++){var zd=Jc[Dd],Ad=zd.row;Ad>=Jb&&Ad<=ba&&P.indentLine(Ja,ab,zd,wc,Ka,ob,yb);wc=P.tokenizeLine(ab,Jc[Dd],wc,function(){})}return!0}function Nc(Ja,ab,Jb,ba,Ka,ob,yb){ab=P.linesToTokenize(ab,Jb,ba,Ka);Jb=ab.lines;P.tokenizeLines(Ja,
Jb,ab.state,ob,yb);return Jb}function pb(Ja,ab,Jb,ba,Ka){var ob=[],yb,Jc=function(zd){return ob.push(yb=[])},wc=function(zd,Ad,He,df,og,Jh,Oi){return yb.push(He,df,zd,og.current(),Ad.localMode||Oi)};try{var Dd=P.visitDocumentTokens(Ja,ab,Jb,ba,Ka,Jc,wc)}catch(zd){ob.length=0,Dd=P.visitDocumentTokens(Ja,ab,Jb,ba,null,Jc,wc)}return{tokens:ob,lines:Dd}}function gb(Ja,ab,Jb,ba,Ka){null==ab&&(ab=Ja.search(/[^\s\u00a0]/),-1==ab&&(ab=Ja.length));ba=ba||0;for(Ka=Ka||0;;){var ob=Ja.indexOf("\t",ba);if(0>ob||
ob>=ab)return Ka+(ab-ba);Ka+=ob-ba;Ka+=Jb-Ka%Jb;ba=ob+1}}function hb(Ja){Ja=Ja.toLowerCase();for(var ab=0;ab<P.modeInfo.length;ab++){var Jb=P.modeInfo[ab];if(Jb.mime==Ja)return Jb;if(Jb.mimes)for(var ba=0;ba<Jb.mimes.length;ba++)if(Jb.mimes[ba]==Ja)return Jb}if(/\+xml$/.test(Ja))return hb("application/xml");if(/\+json$/.test(Ja))return hb("application/json")}function Yb(Ja){for(var ab=0;ab<P.modeInfo.length;ab++){var Jb=P.modeInfo[ab];if(Jb.ext)for(var ba=0;ba<Jb.ext.length;ba++)if(Jb.ext[ba]==Ja)return Jb}}
function Xb(Ja){for(var ab=0;ab<P.modeInfo.length;ab++){var Jb=P.modeInfo[ab];if(Jb.file&&Jb.file.test(Ja))return Jb}ab=Ja.lastIndexOf(".");if(Ja=-1<ab&&Ja.substring(ab+1,Ja.length))return P.findModeByExtension(Ja)}function Fd(Ja){Ja=Ja.toLowerCase();for(var ab=0;ab<P.modeInfo.length;ab++){var Jb=P.modeInfo[ab];if(Jb.name.toLowerCase()==Ja)return Jb;if(Jb.alias)for(var ba=0;ba<Jb.alias.length;ba++)if(Jb.alias[ba].toLowerCase()==Ja)return Jb}}function Be(Ja){if(!Ja)return String(Ja);if(Array.isArray(Ja))return"["+
Ja.map(Be).join(",")+"]";if("symbol"===typeof Ja)return ce.printSymbol(Ja);try{return String(Ja)}catch(ab){return"Cannot print object: "+ab}}function Ie(Ja,ab){return!ce.arr.every(ab.map(function(Jb){return Ja[Jb]}),function(Jb){return ce.obj.equals(Jb,Ja&&Ja.valueOf())})}function Lf(Ja){if(ce.obj.isPrimitive(Ja))var ab=ce.string.print(Ja);else Array.isArray(Ja)?((ab=3<Ja.length)&&(Ja=Ja.slice(0,3)),Ja=ce.string.print(Ja),ab&&(Ja=Ja.slice(0,-1)+", ...]"),ab=Ja):ab=ce.string.print(Ja);ab=ab.replace(/\n/g,
"");500<ab.length&&(ab=ab.slice(0,20)+("...["+(ab.length-20)+' CHARS]"'));return ab}function ed(Ja){return Yc.Inspector.openInWindow({targetObject:Ja})}function ue(Ja,ab){return Yc.Inspector.openInWindow({remoteTarget:{code:Ja,evalEnvironment:ab}})}function Md(Ja,ab){function Jb(Jc){var wc=Jc.name,Dd=Jc.ownerChain(),zd=Jc.owner,Ad=Jc.world(),He;Jc===ob&&(He=[yb]);Ad===Jc&&(He=["$world"]);if(!He&&wc&&zd){zd===Ad&&1===Yc.arr.count(Yc.arr.pluck(Ad.submorphs,"name"),wc)&&(He=['$world.get("'+wc+'")']);
if(!He&&zd!=Ad)for(Ad=Dd.length-1;Ad--;)if(1===Dd[Ad].getAllNamed(wc).length){He=[].concat($jscomp.arrayFromIterable(Jb(Dd[Ad])),['get("'+wc+'")']);break}He||(wc=[].concat($jscomp.arrayFromIterable(Jb(zd)),['get("'+wc+'")']),Yc.syncEval(wc.join("."),{context:ob}).value===Jc&&(He=wc))}He||(He=[yb+'.getMorphById("'+Jc.id+'")']);return He}ab=void 0===ab?{}:ab;var ba=Ja.world(),Ka=ab;ab=void 0===Ka.maxLength?10:Ka.maxLength;var ob=void 0===Ka.fromMorph?ba:Ka.fromMorph;if(ob===Ja)return"this";var yb=ba===
ob?"$world":"this";if(!(ba||Ja.name&&ob.get(Ja.name)===Ja))return"morph";ba=Jb(Ja);return ba.length>ab?'$world.getMorphWithId("'+Ja.id+'")':ba.join(".")}function Zb(Ja,ab,Jb){var ba=(ab=void 0===ab?"":ab)&&qf.arr.last(ab.split(".")).toLowerCase(),Ka="",ob=0,yb=Math.pow(2,19);if("string"===typeof Ja){if(Ja.length>yb)return null}else if(Ja.document.stringSize>yb)return null;if("string"===typeof Ja)Ka=Ja.slice(0,1E3);else for(Ja=$jscomp.makeIterator(Ja.document.lines),yb=Ja.next();!yb.done;yb=Ja.next()){var Jc=
yb.value;yb=Jc.stringSize;Jc=Jc.text;var wc=!0;1E3<ob+yb&&(wc=!1,yb=1E3-ob);Ka+=Jc.slice(0,yb)+(wc?"\n":"");ob+=yb;if(1E3<=ob)break}ob=$jscomp.makeIterator(qf.modeInfo);for(Ja=ob.next();!Ja.done;Ja=ob.next()){wc=Ja.value;yb=wc.contentTest;Ja=wc.mode;Jc=wc.ext;wc=wc.file;if("function"===typeof yb)try{if(yb(Ka))return Ja}catch(Dd){}if(wc&&wc instanceof RegExp&&wc.test(ab))return Ja;if(Jc)for(yb=$jscomp.makeIterator(Jc),Jc=yb.next();!Jc.done;Jc=yb.next())if(Jc.value===ba)return Ja}return Jb}Da({a:vd,
d:Nb,r:Xc});var ta=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");ta.Color=Ab;var Ba=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Jb=ab.hasOwnProperty("DefaultTheme")&&"function"===typeof ab.DefaultTheme?ab.DefaultTheme:ab.DefaultTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:"background",get:function(){return ta.Color.white}},
{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:ta.Color.white,fontWeight:"bold",backgroundColor:ta.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:ta.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:ta.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:"className",get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],ab,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:42,end:2867})}(void 0),Mb=Ba=ta.DefaultTheme;ta.default=Ba;var P=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");P.copyState=Ra;P.startState=cc;P.defineMode=Nb;P.resolveMode=$a;P.getMode=ic;P.innerMode=nd;P.defineMIME=vd;P.registerHelper=Xc;P.indentLines=Wa;P.indentLine=function(Ja,ab,Jb,ba,Ka,ob,yb){yb=Object.assign({indentWithTabs:!Ja.useSoftTabs,indentUnit:Ja.tabWidth,tabSize:4,ignoreFollowingText:!1},yb);null==Ka&&(Ka="add");"smart"==Ka&&(ab.indent||(Ka=
"prev"));var Jc=yb.tabSize,wc=Jb.text,Dd=P.countColumn(wc,null,Jc);Jb.modeState&&(Jb.modeState=null);var zd=wc.match(/^\s*/)[0];if(!ob&&!/\S/.test(wc)){var Ad=0;Ka="not"}else if("smart"==Ka&&(Ad=ab.indent(ba,yb.ignoreFollowingText?"":wc.slice(zd.length),wc),Ad==P.passIndent||150<Ad)){if(!ob)return;Ka="prev"}"prev"==Ka?Ad=0<Jb.row?P.countColumn(Jb.prevLine().text,null,Jc):0:"add"==Ka?Ad=Dd+yb.indentUnit:"subtract"==Ka?Ad=Dd-yb.indentUnit:"number"==typeof Ka&&(Ad=Dd+Ka);Ad=Math.max(0,Ad);ab="";ba=0;
if(yb.indentWithTabs)for(yb=Math.floor(Ad/Jc);yb;--yb)ba+=Jc,ab+="\t";ba<Ad&&(ab+=" ".repeat(Ad-ba));if(ab!=zd)return Ja.replace({start:{row:Jb.row,column:0},end:{row:Jb.row,column:zd.length}},ab),!0};P.tokenizeLines=function(Ja,ab,Jb,ba,Ka){if(ab.length){Jb=Jb?P.copyState(Ja,Jb):P.startState(Ja);for(var ob=0;ob<ab.length;ob++){var yb=ab[ob];ba(yb);Jb=P.tokenizeLine(Ja,yb,Jb,Ka)}}};P.tokenizeLine=function(Ja,ab,Jb,ba){var Ka=ab.text;if(!Ka)return Jb;var ob=new P.StringStream(Ka,2);Jb=ab.modeState=
"function"===typeof Ja.copyState?Ja.copyState(Jb):P.copyState(Ja,Jb);ab.prevLine();for(Jb._string=Ka;!ob.eol();)Ka=Ja.token(ob,Jb),ba(Ka,Jb,ob.start,ob.pos,ob,ab,Ja),ob.start=ob.pos;return Jb};P.printTokens=function(Ja){for(var ab="",Jb=0;Jb<Ja.length;Jb+=5)ab+=Ja[Jb+0]+" => "+Ja[Jb+1]+" "+Ja[Jb+2]+" "+Ja[Jb+3]+" "+Ja[Jb+4].name+"\n";return ab};P.visitDocumentTokens=Nc;P.tokenizeDocument=pb;P.linesToTokenize=function(Ja,ab,Jb,ba){if(ba&&ba.row>=Jb)return{lines:[],state:null};ab=ba?Math.max(0,ba.row-
1):ab;var Ka=Ja.getLine(ab),ob=Ka.text;Ja=[Ka];ba=null;for(var yb=0,Jc;(Jc=Ka.prevLine())&&50>yb++;){Ka=Jc;if(Ka.modeState){ba=Ka.modeState;break}Ja.unshift(Ka)}if(!ba){for(var wc=Ka,Dd=Infinity;(Jc=Ka.prevLine())&&100>yb++;){Ka=Jc;if(Ka.modeState){ba=Ka.modeState;break}Ja.unshift(Ka);Jc=ob.match(/^\s*/)[0].length;if(0===Jc)break;Jc<Dd&&(Dd=Jc,wc=Ka)}!ba&&0<Dd&&(Ja=Ja.slice(Ja.indexOf(wc)))}if(Jb>ab)for(Ka=P.arr.last(Ja);ab<=Jb;ab++){Ka=Ka.nextLine();if(!Ka)break;Ja.push(Ka)}return{lines:Ja,state:ba}};
P.countColumn=gb;P.findModeByMIME=hb;P.findModeByExtension=Yb;P.findModeByFileName=Xb;P.findModeByName=Fd;P.arr=kc;Ba=P.modes||{};P.modes=Ba;P.modes=Ba;P.modes=Ba;Ba=Da("p",{});P.passIndent=Ba;P.passIndent=Ba;P.passIndent=Ba;P.copyState=Ra;P.copyState=Ra;P.startState=cc;P.startState=cc;P.defineMode=Nb;P.defineMode=Nb;P.resolveMode=$a;P.resolveMode=$a;P.getMode=ic;P.getMode=ic;P.innerMode=nd;P.innerMode=nd;Ba={};P.mimeModes=Ba;P.mimeModes=Ba;P.mimeModes=Ba;P.defineMIME=vd;P.defineMIME=vd;P.registerHelper=
Xc;P.registerHelper=Xc;P.indentLines=Wa;P.indentLines=Wa;P.visitDocumentTokens=Nc;P.visitDocumentTokens=Nc;P.tokenizeDocument=pb;P.tokenizeDocument=pb;P.countColumn=gb;P.countColumn=gb;(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Jb=ab.hasOwnProperty("StringStream")&&"function"===typeof ab.StringStream?ab.StringStream:ab.StringStream=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Tb(Jb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,Ka){this.reset(ba,Ka)}},{key:"reset",value:function(ba,Ka){this.pos=this.start=0;this.string=void 0===ba?"":ba;this.tabSize=void 0===Ka?2:Ka;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<
this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(ba){var Ka=this.string.charAt(this.pos);if("string"==typeof ba?Ka==ba:Ka&&(ba.test?ba.test(Ka):ba(Ka)))return++this.pos,Ka}},{key:"eatWhile",value:function(ba){for(var Ka=this.pos;this.eat(ba););return this.pos>Ka}},{key:"eatSpace",value:function(){for(var ba=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>ba}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",
value:function(ba){ba=this.string.indexOf(ba,this.pos);if(-1<ba)return this.pos=ba,!0}},{key:"backUp",value:function(ba){this.pos-=ba}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=P.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return P.countColumn(this.string,
null,this.tabSize)-(this.lineStart?P.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(ba,Ka,ob){if("string"==typeof ba){var yb=function(wc){return ob?wc.toLowerCase():wc},Jc=this.string.substr(this.pos,ba.length);if(yb(Jc)==yb(ba))return!1!==Ka&&(this.pos+=ba.length),!0}else{if((ba=this.string.slice(this.pos).match(ba))&&0<ba.index)return null;ba&&!1!==Ka&&(this.pos+=ba[0].length);return ba}}},{key:"current",value:function(){return this.string.slice(this.start,
this.pos)}},{key:"hideFirstChars",value:function(ba,Ka){this.lineStart+=ba;try{return Ka()}finally{this.lineStart-=ba}}}],[{key:"className",get:function(){return"StringStream"}}],ab,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);Ba=[{name:"APL",mime:"text/apl",
mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),
alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",
mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",
mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ja){return Ja.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",
mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",
mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",
mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",
mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",
mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},
{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",
mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",
mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p",
"pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",
ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},
{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",
mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Ja){return Ja.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},
{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},
{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",
mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",
mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",
ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml",
"text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];P.modeInfo=Ba;P.modeInfo=Ba;P.modeInfo=Ba;for(var xa=0;xa<P.modeInfo.length;xa++)P.info=P.modeInfo[xa],P.info.mimes&&(P.info.mime=P.info.mimes[0]);P.defineMode("null",function(){return{token:function(Ja){return Ja.skipToEnd()}}});
P.defineMIME("text/plain","null");P.findModeByMIME=hb;P.findModeByMIME=hb;P.findModeByExtension=Yb;P.findModeByExtension=Yb;P.findModeByFileName=Xb;P.findModeByFileName=Xb;P.findModeByName=Fd;P.findModeByName=Fd;var Qa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Qa.Color=Ab;Qa.Rectangle=ec;Qa.pt=he;Qa.morph=gd;Qa.ShadowObject=Zd;Qa.StyleSheet=kd;Qa.connect=Sc;Qa.arr=kc;Qa.string=yd;Qa.FilterableList=Od;Qa.Range=fe;xa=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
Jb=ab.hasOwnProperty("Completer")&&"function"===typeof ab.Completer?ab.Completer:ab.Completer=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:"compute",value:function(){return[]}}],[{key:"className",get:function(){return"Completer"}}],ab,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:345,end:391})}(void 0);Qa.Completer=xa;Qa.Completer=xa;Qa.Completer=xa;xa=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Jb=ab.hasOwnProperty("WordCompleter")&&"function"===typeof ab.WordCompleter?ab.WordCompleter:ab.WordCompleter=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:"compute",
value:function(ba,Ka){var ob=[],yb=[],Jc=ba.document.lineStrings;ba=ba.cursorPosition.row;for(var wc=ba-1;0<=wc;wc--)for(var Dd=$jscomp.makeIterator(Jc[wc].split(/[^0-9a-z@_]+/i)),zd=Dd.next();!zd.done;zd=Dd.next())(zd=zd.value)&&!ob.includes(zd)&&zd!==Ka&&(ob.push(zd),yb.push({priority:1E3-(ba-wc),completion:zd}));for(wc=ba+1;wc<Jc.length;wc++)for(Dd=$jscomp.makeIterator(Jc[wc].split(/[^0-9a-z_@]+/i)),zd=Dd.next();!zd.done;zd=Dd.next())(zd=zd.value)&&!ob.includes(zd)&&zd!==Ka&&(ob.push(zd),yb.push({priority:1E3-
(wc-ba),completion:zd}));return yb}}],[{key:"className",get:function(){return"WordCompleter"}}],ab,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:400,end:1228})}(void 0);Qa.WordCompleter=xa;Qa.WordCompleter=xa;Qa.WordCompleter=xa;xa=[new Qa.WordCompleter];Qa.defaultCompleters=xa;Qa.defaultCompleters=
xa;Qa.defaultCompleters=xa;xa=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Jb=ab.hasOwnProperty("CompletionController")&&"function"===typeof ab.CompletionController?ab.CompletionController:ab.CompletionController=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba,Ka){Ka=void 0===Ka?[]:Ka;this.textMorph=
ba;this.completers=Ka=ba.pluginCollect("getCompleters",Ka)}},{key:"computeCompletions",value:function(ba){var Ka=this,ob,yb,Jc,wc,Dd,zd,Ad,He,df,og,Jh,Oi,Th,Kj,Kh,gl;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Kf){switch(Kf.nextAddress){case 1:ob=[],yb=$jscomp.makeIterator(Ka.completers),Jc=yb.next();case 2:if(Jc.done){Kf.jumpTo(4);break}wc=Jc.value;Kf.setCatchFinallyBlocks(5);Dd=ob;zd=Dd.concat;return Kf.yield(wc.compute(Ka.textMorph,ba),7);case 7:ob=zd.call(Dd,Kf.yieldResult);Kf.leaveTryBlock(3);
break;case 5:Ad=Kf.enterCatchBlock(),console.warn("Error in completer "+wc+": "+(Ad.stack||Ad));case 3:Jc=yb.next();Kf.jumpTo(2);break;case 4:He=new Map;ob.forEach(function(Uj){var oi=He.get(Uj.completion);oi||(oi=[],He.set(Uj.completion,oi));oi.push(Uj)});df=[];og=$jscomp.makeIterator(He.values());for(Jh=og.next();!Jh.done;Jh=og.next())Oi=Jh.value,df.push(Qa.arr.last(Qa.arr.sortByKey(Oi,"priority")));Th=0;Kj=Qa.arr.sortByKey(df,"priority").reverse();Kh=Kj.length&&Kj[0].priority||0;gl=Kj.map(function(Uj){Uj.highestPriority=
Kh;var oi=Uj.completion.replace(/\n/g,""),Ke=String((Uj.info||"").replace(/\n/g,""));Th=Math.max(Th,oi.length+Ke.length);return{isListItem:!0,string:oi,annotation:Ke,value:Uj}});return Kf.return({items:gl,maxCol:Th})}})}},{key:"computeSortedCompletions",value:function(ba,Ka){Ka=void 0===Ka?!1:Ka;var ob=this,yb,Jc,wc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Dd){if(1==Dd.nextAddress)return yb={tokens:[ba],lowercasedTokens:[ba],input:ba},Dd.yield(ob.computeCompletions(ba),2);Jc=Dd.yieldResult;
wc=Qa.arr.sortBy(Jc.items.filter(function(zd){return ob.filterFunction(yb,zd,Ka)}),function(zd){return ob.sortFunction(yb,zd)});return Dd.return(wc)})}},{key:"_printCompletions",value:function(ba){var Ka=this,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress)return yb.yield(Ka.computeSortedCompletions(ba),2);ob=yb.yieldResult.map(function(Jc){return{completion:Jc.value.completion,priority:Jc.value.priority,maxP:Jc.value.highestPriority,sortVal:Jc._cache[ba].sortVal,
lev:JSON.stringify(Jc._cache[ba].levenshtein)}});return yb.return(Qa.string.printTable(lively.lang.grid.tableFromObjects(ob)))})}},{key:"prefix",value:function(){var ba=this.textMorph,Ka=ba.selection;return(Ka.isEmpty()?ba.getLine(Ka.lead.row).slice(0,Ka.lead.column):Ka.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(ba,Ka,ob){ob=void 0===ob?!1:ob;Ka._cache||(Ka._cache={});var yb=ba.tokens,Jc=ba.lowercasedTokens,wc=ba.input;wc=Ka._cache[wc]||(Ka._cache[wc]={});if(wc.hasOwnProperty("filtered"))return wc.filtered;
Ka=Ka.value.completion.replace(/\([^\)]*\)$/,"");var Dd=Ka.toLowerCase();if(ob&&yb[0]&&!Ka.startsWith(yb[0]))return wc.filtered=!1;if(Jc.every(function(Ad){return Dd.includes(Ad)}))return!0;var zd=wc.levenshtein||(wc.levenshtein={});ba=ob||3>=Qa.arr.sum(ba.lowercasedTokens.map(function(Ad){return zd[Ad]||(zd[Ad]=Qa.string.levenshtein(Dd,Ad))}));return wc.filtered=ba}},{key:"sortFunction",value:function(ba,Ka){Ka._cache||(Ka._cache={});var ob=Ka._cache[ba.input]||(Ka._cache[ba.input]={});if(ob.hasOwnProperty("sortVal"))return ob.sortVal;
ob=Ka._cache[ba.input]={};var yb=Ka.value;Ka=yb.highestPriority;var Jc=yb.completion;yb=yb.priority;Jc=Jc.replace(/\([^\)]*\)$/,"").toLowerCase();var wc=0;ba.lowercasedTokens.forEach(function(zd){Jc.startsWith(zd)?wc+=12:3<=zd.length&&Jc.includes(zd)&&(wc+=5)});Ka=-((yb||(wc?Ka:0))/Math.pow(10,String(Ka).length-2))-wc;var Dd=ob.levenshtein||(ob.levenshtein={});ba=Qa.arr.sum(ba.lowercasedTokens.map(function(zd){return Dd[zd]||(Dd[zd]=Qa.string.levenshtein(Jc,zd))}));wc&&(ba/=2);return ob.sortVal=ba+
Ka}},{key:"positionForMenu",value:function(){var ba=this.textMorph,Ka=ba.charBoundsFromTextPosition(ba.cursorPosition);return ba.getGlobalTransform().transformRectToRect(Ka).topLeft().addXY(-ba.scroll.x,-ba.scroll.y).addPt(Qa.pt(ba.borderWidth+3,ba.borderWidth+3))}},{key:"completionListSpec",value:function(){var ba=this,Ka,ob,yb,Jc,wc,Dd,zd,Ad,He,df,og,Jh,Oi,Th,Kj,Kh,gl,Kf,Uj,oi;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ke){if(1==Ke.nextAddress)return ob=Ka=ba.textMorph,yb=ob.fontSize,
Jc=ob.fontFamily,wc=ba.positionForMenu(),Dd=ba.prefix(),Ke.yield(ba.computeCompletions(Dd),2);zd=Ke.yieldResult;Ad=zd.items;He=zd.maxCol;df=Ka.env.fontMetric.sizeFor(Jc,yb,"M");og=df.width*He;Jh=Ka.document.getLine(0).height;Oi=Math.max(120,og<Ka.width?og:Ka.width);Th=Jh*Ad.length+Jh+10;Kj=Math.max(70,Math.min(700,Th));Kh=wc.extent(Qa.pt(Oi,Kj));if(gl=Ka.world())Kf=gl.visibleBounds().insetBy(5),Kh.bottom()>Kf.bottom()&&(Uj=Kh.bottom()-Kf.bottom(),Uj>Kh.height-50&&(Uj=Kh.height-50),Kh.height-=Uj),
Kh.right()>Kf.right()&&(oi=Kh.right()-Kf.right(),Kh.width=120>Kh.width-oi?120:Kh.width-oi),Kf.containsRect(Kh)||(Kh=Kh.withTopLeft(Kf.translateForInclusion(Kh).topLeft())),Kh=Kh.translatedBy(Kf.insetBy(0).topLeft().negated());return Ke.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},hasFixedPosition:!0,epiMorph:!0,fontSize:yb,position:Kh.topLeft(),extent:Kh.extent(),items:Ad,input:Dd,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:ba.filterFunction,
sortFunction:ba.sortFunction})})}},{key:"removeMenuOnBlur",value:function(ba){var Ka=ba.menu;setTimeout(function(){Ka.withAllSubmorphsDetect(function(ob){return ob.isFocused()})?Ka.inputMorph.focus():Ka.remove()})}},{key:"openCompletionList",value:function(){var ba=this,Ka,ob,yb,Jc,wc,Dd,zd,Ad,He,df;return $jscomp.asyncExecutePromiseGeneratorProgram(function(og){if(1==og.nextAddress)return Ka=ba.textMorph.selection.start,og.yield(ba.completionListSpec(),2);ob=og.yieldResult;ba.textMorph.pluginFind(function(Jh){return Jh.theme});
yb=new Qa.FilterableList(ob);Jc=new Qa.Range({start:Ka,end:ba.textMorph.selection.start});wc=ba.textMorph.textInRange(Jc);Dd=yb.inputMorph;zd=yb.listMorph;Ad=ob.input;He=yb.addMorph({name:"prefix mask",fill:Qa.Color.transparent,bounds:Dd.textBounds()},Dd);zd.master=null;Jc.isEmpty()||(ba.textMorph.deleteText(Jc),Dd.input=wc,Dd.gotoDocumentEnd());Dd.fontColor=ba.textMorph.fontColor;Qa.connect(Dd,"textString",He,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Dd}});Qa.connect(yb,
"accepted",ba,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Ad}});Qa.connect(yb,"accepted",yb,"remove");Qa.connect(yb,"canceled",yb,"remove");Qa.connect(yb,"remove",ba.textMorph,"focus");Qa.connect(yb.inputMorph,"onBlur",ba,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:yb}});df=ba.textMorph.world();df.addMorph(yb);zd.addStyleClass("hiddenScrollbar");Dd.height=zd.itemHeight;Dd.fixedHeight=!0;Dd.fontSize=zd.fontSize;Dd.focus();yb.get("padding").height=0;yb.relayout();yb.selectedIndex=0;Ad.length?(Dd.gotoDocumentEnd(),
yb.moveBy(Qa.pt(-Dd.textBounds().width+2,0))):yb.moveBy(Qa.pt(2,0));return og.return(yb)})}},{key:"autoInsertBestMatchingCompletion",value:function(ba,Ka,ob){Ka=void 0===Ka?!0:Ka;var yb=this,Jc,wc,Dd,zd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ad){if(1==Ad.nextAddress)return Jc=$jscomp,wc=Jc.makeIterator,Ad.yield(yb.computeSortedCompletions(ba,Ka),2);Dd=wc.call(Jc,Ad.yieldResult);(zd=Dd.next().value)&&yb.insertCompletion(zd.value.completion,ba,ob);Ad.jumpToEnd()})}},{key:"insertCompletion",
value:function(ba,Ka,ob){var yb=this.textMorph,Jc=yb.document,wc=yb.selection.isMultiSelection?yb.selection.selections:[yb.selection];yb.undoManager.group();wc.forEach(function(Dd){Dd.collapseToEnd();var zd=Dd.lead,Ad=Ka?Jc.indexToPosition(Jc.positionToIndex(zd)-Ka.length):zd;"function"===typeof ob?ob(ba,Ka,yb,{start:Ad,end:zd},Dd):yb.replace({start:Ad,end:zd},ba)});yb.undoManager.group()}}],[{key:"className",get:function(){return"CompletionController"}}],ab,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1355,end:12497})}(void 0);Qa.CompletionController=xa;Qa.CompletionController=xa;Qa.CompletionController=xa;xa=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ja,ab,Jb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){return 1==Ka.nextAddress?
(ba=new Qa.CompletionController(Ja,Qa.defaultCompleters),Ka.yield(ba.openCompletionList(),2)):Ka.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ja,ab,Jb){var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){return 1==Ka.nextAddress?(ba=new Qa.CompletionController(Ja,Qa.defaultCompleters),Ka.yield(ba.autoInsertBestMatchingCompletion(ba.prefix()),2)):Ka.return(!0)})}}];Qa.completionCommands=xa;Qa.completionCommands=xa;Qa.completionCommands=
xa;var Kb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Kb.chain=Ud;Kb.arr=kc;Kb.obj=md;Kb.string=yd;var Pc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.start;0<ab.row&&(ab=Ja.getPositionAboveOrBelow(1,ab,!0,0,Ja.charBoundsFromTextPosition(ab).x),Ja.selection.addRange({start:ab,end:ab}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.start;
ab.row<Ja.documentEndPosition.row&&(ab=Ja.getPositionAboveOrBelow(-1,ab,!0,0,Ja.charBoundsFromTextPosition(ab).x),Ja.selection.addRange({start:ab,end:ab}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.selections[Ja.selection.selections.length-1];if(ab.isEmpty())return!0;Ja.searchForAll(ab.text,{start:{column:0,row:0}}).forEach(function(Jb){return Ja.selection.addRange(Jb.range,!1)});Ja.selection.mergeSelections();Kb.arr.remove(Ja.selection.selections,
ab);Ja.selection.selections.push(ab);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.selections.length-1,Jb=Ja.selection.selections[ab];if(Jb.isEmpty())return!0;var ba=Ja.search(Jb.text,{start:Jb.end,backwards:!1});ba&&(Jb=Ja.selection.selections.findIndex(function(Ka){return Ka.range.equals(ba.range)}),-1<Jb?Kb.arr.swap(Ja.selection.selections,Jb,ab):Ja.selection.addRange(ba.range));return!0}},{name:"[multi select] more like this backward",
multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.selections.length-1,Jb=Ja.selection.selections[ab];if(Jb.isEmpty())return!0;var ba=Jb.start,Ka=Ja.search(Jb.text,{start:{row:ba.row,column:ba.column-(Jb.text.length-1)},backwards:!0});Ka&&(Jb=Ja.selection.selections.findIndex(function(ob){return ob.range.equals(Ka.range)}),-1<Jb?Kb.arr.swap(Ja.selection.selections,Jb,ab):Ja.selection.addRange(Ka.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",
exec:function(Ja){var ab=Ja.selection.selections.length;1<ab&&Ja.selection.removeSelections(ab-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ja){Ja.selection.selections=lively.lang.arr.rotate(Ja.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(Ja){Ja.selection.selections=lively.lang.arr.rotate(Ja.selection.selections,1);return!0}},{name:"[multi select] align cursors",
multiSelectAction:"single",exec:function(Ja){var ab=Ja.selection.selections;if(1>=ab.length)return!0;var Jb=Kb.arr.groupBy(ab,function(Ka){return Ka.range.start.row});ab=Jb.keys().map(function(Ka){Ka=Jb[Ka];var ob=Kb.arr.max(Ka,function(yb){return yb.range.start.column});Kb.arr.without(Ka,ob).forEach(function(yb){return yb.range=ob.range});return ob});var ba=Kb.arr.max(ab,function(Ka){return Ka.range.start.column}).range.start.column;ab.forEach(function(Ka){var ob=Ka.range.start;Ka=ob.row;ob=ob.column;
Ja.insertText(" ".repeat(ba-ob),{row:Ka,column:ob})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ja){Ja.selection.disableMultiSelect();if(Ja.selection.isEmpty())var ab=Ja.lastSavedMark&&Ja.lastSavedMark.position||(void 0).lineRange().start,Jb=Ja.cursorPosition;else ab=Ja.selection,Jb=ab.lead,ab=ab.anchor;Ja.selection.collapse();var ba=ab.column,Ka=Jb.column;Kb.arr.range(ab.row,Jb.row).forEach(function(ob){return Ja.getLine(ob).length>Math.min(Ka,
ba)&&Ja.selection.addRange({end:{row:ob,column:Ka},start:{row:ob,column:ba}},!1)});Ja.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ja,ab,Jb){Jb=void 0===Jb?1:Jb;Ja.undoManager.group();Ja.selection.selections.forEach(function(ba,Ka){return ba.text=String(Ka+Jb)});Ja.undoManager.group();return!0}}];Kb.multiSelectCommands=Pc;Kb.multiSelectCommands=Pc;Kb.multiSelectCommands=Pc;var Zc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");
Zc.pToI=function(Ja,ab){return Ja.positionToIndex(ab)};Zc.iToP=function(Ja,ab){return Ja.indexToPosition(ab)};Zc.execCodeNavigator=function(Ja){return function(ab,Jb,ba){var Ka=ab.pluginInvokeFirst("getNavigator");if(!Ka)return!0;ab.saveMark();ba=ba||1;for(var ob=0;ob<ba;ob++)Ka[Ja](ab,Jb);return!0}};Zc.once=db;var le=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Zc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",
exec:Zc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Zc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Zc.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Zc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",
bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ja,ab){function Jb(){var ob=Ja.$expandRegionState,yb=Zc.pToI(Ja,Ja.cursorPosition);if(ob&&(ob.range[0]===yb||ob.range[1]===yb))return ob;ob=Ja.selection.range;return Ja.$expandRegionState={range:[Zc.pToI(Ja,ob.start),Zc.pToI(Ja,ob.end)]}}ab=ab||{};var ba=Ja.pluginInvokeFirst("getNavigator");if(!ba)return!0;var Ka=ab.start;ab=ab.end;if("number"===typeof Ka&&"number"===typeof ab)Jb(),ba={range:[Ka,
ab],prev:Jb()};else{Ka=ba.ensureAST(Ja);if(!Ka)return;ba=ba.expandRegion(Ja,Ja.textString,Ka,Jb())}ba&&ba.range&&(Ja.selection={start:Zc.iToP(Ja,ba.range[0]),end:Zc.iToP(Ja,ba.range[1])},Ja.$expandRegionState=ba);Zc.once(Ja,"selectionChange",function(){return Ja.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ja){if(Ja.selection.isEmpty())return!0;
var ab=Ja.pluginInvokeFirst("getNavigator");if(!ab)return!0;var Jb=ab.ensureAST(Ja);if(!Jb)return!0;var ba=Ja.$expandRegionState;if(!ba)return!0;(ab=ab.contractRegion(Ja,Ja.textString,Jb,ba))&&ab.range&&(Ja.selection={start:Zc.iToP(Ja,ab.range[0]),end:Zc.iToP(Ja,ab.range[1])},Ja.$expandRegionState=ab);Zc.once(Ja,"selectionChange",function(){return Ja.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Zc.commands=le;Zc.commands=le;Zc.commands=le;var Rd=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");
Rd.arr=kc;Rd.chain=Ud;Rd.string=yd;var jf=[{name:"toggle comment",exec:function(Ja){var ab=Ja.pluginInvokeFirst("getComment");if(!ab)return!0;if(!ab.lineCommentStart)return ab.blockCommentStart?Ja.execCommand("toggle block comment"):!0;var Jb=ab.lineCommentStart,ba=new RegExp("^(\\s*)("+Jb+"\\s?)(.*)");ab=Ja.document;var Ka=Ja.selection;Ka.isEmpty()||0!==Ka.end.column||Ka.growRight(-1);var ob=Ka.start.row;ab=ab.lineStrings.slice(Ka.start.row,Ka.end.row+1);ab=ab.some(function(wc){return!!wc.trim()})?
Rd.arr.dropWhile(ab,function(wc){return wc.trim()?!1:++ob&&!0}):ab;var yb=ab.every(function(wc){return wc.trim()&&wc.match(ba)});Ja.undoManager.group();if(yb)ab.forEach(function(wc,Dd){if(wc=wc.match(ba)){wc=$jscomp.makeIterator(wc);wc.next();var zd=wc.next().value,Ad=wc.next().value;wc.next();Ja.deleteText({start:{row:ob+Dd,column:zd.length},end:{row:ob+Dd,column:zd.length+Ad.length}})}});else{var Jc=ab.reduce(function(wc,Dd,zd){return Dd.trim()||Ka.isEmpty()&&Ka.start.row===Ka.end.row?Math.min(wc,
Dd.match(/^\s*/)[0].length):wc},Infinity);Jc=Infinity===Jc?0:Jc;ab.forEach(function(wc,Dd){wc=$jscomp.makeIterator(wc.match(/^(\s*)(.*)/));wc.next();wc.next();wc.next();Ja.insertText(Jb+" ",{row:ob+Dd,column:Jc})})}Ja.undoManager.group();return!0}},{name:"toggle block comment",exec:function(Ja){var ab=Ja.pluginInvokeFirst("getComment");if(!ab)return!0;if(!ab.blockCommentStart)return ab.lineCommentStart?Ja.execCommand("toggle comment"):!0;if(!ab||!ab.blockCommentStart)return!0;var Jb=ab.blockCommentStart;
ab=ab.blockCommentEnd;var ba=new RegExp("^"+Jb.replace(/\*/g,"\\*")),Ka=new RegExp(ab.replace(/\*/g,"\\*")+"$"),ob=Ja.tokenAt(Ja.cursorPosition);if(ob&&"comment"===ob.token){var yb=Ja.textInRange(ob);if(yb.match(ba)&&yb.match(Ka))return Ja.undoManager.group(),Ja.replace(ob,yb.slice(Jb.length,-ab.length)),Ja.undoManager.group(),!0}Ja.undoManager.group();Ja.insertText(Jb,Ja.selection.start);Ja.insertText(ab,Ja.selection.end);Ja.undoManager.group();Jb=!Ja.selection.isEmpty();Ja.selection.growLeft(ab.length);
Jb||Ja.selection.collapse();return!0}},{name:"comment box",exec:function(Ja,ab,Jb){ab=Ja.undoManager.ensureNewGroup(Ja,"comment box");if(Ja.selection.isEmpty())return Ja.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ja.execCommand("toggle comment"),Ja.undoManager.group(ab),!0;var ba=Ja.selection.range,Ka=Ja.withSelectedLinesDo(function(yb){return yb}),ob=Rd.arr.min([ba.start.column].concat(Rd.chain(Ka).map(function(yb){return yb.match(/^\s*/)}).flatten().compact().pluck("length").value()));
Ka=Rd.arr.max(Ka.map(function(yb){return yb.length}))-ob;Ka=Array(Math.ceil(Ka/2)+1).join("-=")+"-";Ja.execCommand("toggle comment");Ja.collapseSelection();Ja.cursorPosition={row:ba.start.row,column:0};Jb?Ja.insertText(Rd.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",ob)):Ja.insertText(Rd.string.indent(Ka+"\n"," ",ob));Ja.selection.goUp();Ja.execCommand("toggle comment");Ja.cursorPosition={row:ba.end.row+2,column:0};Ja.insertText(Rd.string.indent(Ka+"\n"," ",ob));Ja.selection.goUp();
Ja.execCommand("toggle comment");Ja.selection.range={start:{row:ba.start.row,column:0},end:Ja.cursorPosition};Ja.undoManager.group(ab);return!0},multiSelectAction:"forEach",handlesCount:!0}];Rd.commands=jf;Rd.commands=jf;Rd.commands=jf;var ce=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");ce.printSymbol=function(Ja){if(Symbol.keyFor(Ja))return'Symbol.for("'+Symbol.keyFor(Ja)+'")';if(ce.knownSymbols.get(Ja))return ce.knownSymbols.get(Ja);String(Ja).match(ce.symMatcher);return String(Ja)};
ce.defaultSort=function(Ja,ab){if(Ja.hasOwnProperty("priority")||ab.hasOwnProperty("priority")){var Jb=Ja.priority||0,ba=ab.priority||0;if(Jb<ba)return-1;if(Jb>ba)return 1}Ja=(Ja.keyString||Ja.key).toLowerCase();ab=(ab.keyString||ab.key).toLowerCase();return Ja<ab?-1:Ja===ab?0:1};ce.safeToString=Be;ce.propertyNamesOf=function(Ja,ab){if(!Ja)return[];if(Array.isArray(Ja)){var Jb=ab?ab.offset:0;return ce.arr.range(Jb,Jb+(ab?ab.partitionSize:Ja.length-1))}return ce.arr.sortBy(Object.keys(Ja),function(ba){return ba.toLowerCase()})};
ce.isMultiValue=Ie;ce.printValue=Lf;ce.partitionedChildren=function(Ja,ab){var Jb=void 0===ab?{}:ab;ab=void 0===Jb.originalValue?Ja:Jb.originalValue;var ba=void 0===Jb.offset?0:Jb.offset;Jb=void 0===Jb.partitionSize?Ja.length||Object.values(Ja).length:Jb.partitionSize;if(ce.obj.isArray(Ja)){Ja=ce.num.roundTo(Math.max(ce.MIN_PARTITION_SIZE,Jb/50),.1);Jb/=Ja;for(var Ka=[],ob=0;ob<Jb;ob++){var yb="["+(ba+ob*Ja)+"-"+(ba+(ob+1)*Ja)+"]";Ka.push({partition:{originalValue:ab,offset:ba+ob*Ja,partitionSize:Ja},
value:[],key:yb,keyString:yb,valueString:"...",isCollapsed:!0})}return Ka}Ja=ce.num.roundTo(Math.max(ce.MIN_PARTITION_SIZE,Jb/50),.1);Jb/=Ja;Ka=[];ob=ce.obj.keys(ab).sort();for(yb=0;yb<Jb;yb++){var Jc=ba+yb*Ja,wc=ba+(yb+1)*Ja,Dd=ce.obj.select(ab,ob.slice(Jc,wc));Jc="["+ob[Jc].slice(0,4)+"-"+(ob[wc]||ce.arr.last(ob)).slice(0,4)+"]";Ka.push({partition:{originalValue:Dd,offset:ba+yb*Ja,partitionSize:Ja},value:[],key:Jc,keyString:Jc,valueString:"...",isCollapsed:!0})}return Ka};ce.propertiesOf=function(Ja){var ab=
Ja.partition?Ja.target:Ja.value;if(!ab)return[];var Jb={_rev:!0},ba=[],Ka="function"===typeof ab.livelyCustomInspect?ab.livelyCustomInspect():{},ob=Object.assign({},ce.defaultPropertyOptions,{},Ka);if(Ka.properties){Ka=$jscomp.makeIterator(Ka.properties);for(var yb=Ka.next();!yb.done;yb=Ka.next()){var Jc=yb.value;yb=Jc.key;var wc=Jc.hidden,Dd=Jc.priority,zd=Jc.keyString,Ad=Jc.value;Jc=Jc.valueString;Jb[yb]=!0;wc||ba.push(Ja.getSubNode({priority:Dd,key:yb,keyString:zd||ce.safeToString(yb),value:Ad,
valueString:Jc,isCollapsed:!0}))}}if(ob.includeDefault){Ka=ce.propertyNamesOf(ab,Ja.partition);if(Ka.length>ce.MAX_NODE_THRESHOLD)for(Jb=$jscomp.makeIterator(ce.partitionedChildren(ab,Ja.partition)),Ka=Jb.next();!Ka.done;Ka=Jb.next())ba.push(Ja.getSubNode(Ka.value));else for(wc=$jscomp.makeIterator(Ka),Ka=wc.next();!Ka.done;Ka=wc.next())Dd=Ka.value,Dd in Jb||(Ka=ab[Dd],yb=ce.printValue(Ka),Ka={keyString:Dd,key:Dd,value:Ka,valueString:yb,isCollapsed:!0},ba.push(Ja.getSubNode(Ka)));if(ob.includeSymbols)for(Jb=
$jscomp.makeIterator(Object.getOwnPropertySymbols(ab)),Ka=Jb.next();!Ka.done;Ka=Jb.next())wc=Ka.value,Dd=ce.safeToString(wc),Ka=ab[wc],yb=ce.printValue(Ka),Ka={key:wc,keyString:Dd,value:Ka,valueString:yb,isCollapsed:!0},ba.push(Ja.getSubNode(Ka))}ob.sort&&(ba=ob.sortFunction(ab,ba));return ba};ce.obj=md;ce.num=Fb;ce.arr=kc;ce.string=yd;ce.connect=Sc;ce.signal=tc;ce.TreeData=nc;ce.newUUID=td;ce.localInterface=Ia;ce.MAX_NODE_THRESHOLD=1E3;ce.MIN_PARTITION_SIZE=250;ce.defaultPropertyOptions={includeDefault:!0,
includeSymbols:!0,sort:!0,sortFunction:function(Ja,ab){return Array.isArray(Ja)?ab:ab.sort(ce.defaultSort)}};ce.symMatcher=/^Symbol\((.*)\)$/;ce.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ja){return"symbol"===typeof Symbol[Ja]}).reduce(function(Ja,ab){return Ja.set(Symbol[ab],"Symbol."+ab)},new Map)}();ce.isMultiValue=Ie;ce.isMultiValue=Ie;ce.printValue=Lf;ce.printValue=Lf;var we=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Jb=ab.hasOwnProperty("InspectionTree")&&"function"===typeof ab.InspectionTree?ab.InspectionTree:ab.InspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Tb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.inspector=ba.inspector;this.root.isInspectionNode||(this.root=ce.InspectionNode.for(this.root,
this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(ba){ba=void 0===ba?!0:ba;return Tb._get(Object.getPrototypeOf(Jb.prototype),"asListWithIndexAndDepth",this).call(this,function(Ka){Ka=Ka.node;return ba?Ka.visible:!0})}},{key:"getContextFor",value:function(ba){return ba==this.root?this.root.value.inspectee:ba.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(ba){var Ka=void 0===ba.maxDepth?1:ba.maxDepth,ob=ba.iterator,
yb=ba.showUnknown,Jc=ba.showInternal,wc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Dd){if(1==Dd.nextAddress)return Dd.yield(wc.uncollapseAll(function(zd,Ad){return Ka>Ad&&(zd==wc.root||zd.value.submorphs)}),2);wc.asListWithIndexAndDepth(!1).forEach(function(zd){var Ad=zd.node;return 0==zd.depth?Ad.visible=!0:!yb&&Ad.keyString&&Ad.keyString.includes("UNKNOWN PROPERTY")||!Jc&&Ad.keyString&&Ad.keyString.includes("internal")?Ad.visible=!1:Ad.value&&Ad.value.submorphs?Ad.visible=
!0:Ad.visible=ob(Ad)});Dd.jumpToEnd()})}},{key:"getChildren",value:function(ba){return ba.children}},{key:"display",value:function(ba){return ba.display(this.inspector)}},{key:"isCollapsed",value:function(ba){return ba.isCollapsed}},{key:"isLeaf",value:function(ba){return ce.obj.isPrimitive(ba.value)}},{key:"collapse",value:function(ba,Ka){var ob=this;ba.isCollapsed=Ka;Ka||this.isLeaf(ba)||ba.children.length||(ba.children=ce.propertiesOf(ba).map(function(yb){ob.parentMap.set(yb,ba);return yb}))}},
{key:"retrieveForRemoteProxy",value:function(ba){ba.uuid||(ba.uuid=ce.newUUID(),this.idToNodeMap[ba.uuid]=ba);return{uuid:ba.uuid,value:this.isLeaf(ba)?ba.value:{},keyString:ba.keyString,key:ba.keyString,valueString:ce.safeToString(ba.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return ce.localInterface}},{key:"getNodeViaId",value:function(ba){return this.idToNodeMap[ba]}},{key:"asRemoteDelegate",value:function(ba){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||
(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[ba]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:"className",get:function(){return"InspectionTree"}},{key:"forObject",value:function(ba,Ka){return new this({key:"inspectee",value:{inspectee:ba},isCollapsed:!0,inspector:Ka})}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5932,end:8631})}(ce.TreeData);ce.InspectionTree=we;ce.InspectionTree=we;ce.InspectionTree=we;var Mf=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Jb=ab.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof ab.RemoteInspectionTree?ab.RemoteInspectionTree:ab.RemoteInspectionTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Jb,Ja,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(ba){this.parentMap=new WeakMap;this.root=ba.proxy;this.evalEnvironment=ba.evalEnvironment;this.inspector=ba.inspector;this.delegateId=ba.delegateId}},{key:"getContextFor",value:function(ba){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+ba.uuid+'").value'}},{key:"dispose",value:function(){var ba=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){return Ka.yield(ba.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+ba.delegateId+"']\n    ",ba.evalEnvironment),0)})}},{key:"display",value:function(ba){return ba.keyString+": "+ba.valueString}},{key:"collapse",value:function(ba,Ka){var ob=this,yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jc){if(1==Jc.nextAddress)return(ba.isCollapsed=Ka)||ob.isLeaf(ba)?
Jc.return():ba.children.length?Jc.jumpTo(0):Jc.yield(ob.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+ba.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+ob.delegateId+'"]'}),3);yb=Jc.yieldResult;ba.children=yb.isError?
[]:yb.value;Jc.jumpToEnd()})}}],[{key:"className",get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(ba,Ka){var ob=this,yb,Jc,wc,Dd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zd){if(1==zd.nextAddress)return zd.yield(ob.createRemoteContext(ba,Ka),2);yb=zd.yieldResult;Jc=yb.proxy;wc=yb.delegateId;Dd=yb.evalEnvironment;return zd.return(new ob({key:"inspectee",proxy:Jc,delegateId:wc,evalEnvironment:Dd,inspector:Ka}))})}},{key:"createRemoteContext",value:function(ba,
Ka){var ob=ba.code,yb=ba.evalEnvironment,Jc=ba.delegateId,wc,Dd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zd){if(1==zd.nextAddress)return Jc="lively://inspector-"+Ka.id,zd.yield(yb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+ob+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Jc+'");\n    ',yb),2);wc=zd.yieldResult;Dd=wc.value;return zd.return({delegateId:Jc,
evalEnvironment:yb,proxy:Dd})})}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8640,end:10983})}(ce.InspectionTree);ce.RemoteInspectionTree=Mf;ce.RemoteInspectionTree=Mf;ce.RemoteInspectionTree=Mf;(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Jb=ab.hasOwnProperty("InspectionNode")&&"function"===typeof ab.InspectionNode?ab.InspectionNode:ab.InspectionNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){var Ka=ba.root,ob=ba.priority,yb=ba.key,Jc=ba.keyString,wc=ba.value,Dd=ba.valueString,zd=ba.isCollapsed,Ad=void 0===ba.children?[]:ba.children,He=void 0===ba.isSelected?!1:ba.isSelected,
df=void 0===ba.visible?!0:ba.visible;this.partition=ba.partition;this.priority=ob;this.key=yb;this.keyString=String(Jc||yb);this.value=wc;this.valueString=Dd||ce.printValue(wc);this.isCollapsed=zd;this.children=Ad;this.isSelected=He;this.visible=df;this.root=Ka}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",get:function(){return!0}},{key:"getSubNode",value:function(ba){if(ba.value&&ba.value.isMorph)return new ce.MorphNode(Object.assign({root:this.root},ba));var Ka=ba.key,
ob=ba.keyString,yb=this.value,Jc=ba.partition;Jc&&(yb=Jc.originalValue,ob=Ka);return new ce.PropertyNode(Object.assign({},ba,{keyString:ob,key:Ka,target:yb,partition:Jc,root:this.root,spec:{}}))}},{key:"display",value:function(ba){var Ka=this.keyString,ob=this.valueString;if(!this.interactive)return Ka+": "+ob;this._propertyWidget||(this._propertyWidget=ba.renderDraggableTreeLabel({value:Ka+": "+ob}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:"className",
get:function(){return"InspectionNode"}},{key:"for",value:function(ba,Ka){Ka=void 0===Ka?null:Ka;return ba.value&&ba.value.isMorph?new ce.MorphNode(Object.assign({root:Ka},ba)):new ce.InspectionNode(Object.assign({root:Ka},ba))}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10985,
end:13522})})(void 0);(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Jb=ab.hasOwnProperty("MorphNode")&&"function"===typeof ab.MorphNode?ab.MorphNode:ab.MorphNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Tb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,ba);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(ba){var Ka=this.propertyInfo[ba.key]||{};return ba.value&&ba.value.isMorph?new ce.MorphNode(Object.assign({},ba,{root:this.root})):new ce.PropertyNode(Object.assign({},ba,{root:this.root,target:this.target,spec:Ka}))}}],[{key:"className",get:function(){return"MorphNode"}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13524,end:14670})})(ce.InspectionNode);(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Jb=ab.hasOwnProperty("PropertyNode")&&"function"===typeof ab.PropertyNode?ab.PropertyNode:ab.PropertyNode=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Tb(Jb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Tb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);var Ka=ba.spec,ob=ba.target;this.partition=ba.partition;this.target=ob;this.spec=Ka;this.foldedNodes={}}},{key:"__deserialize__",value:function(ba,Ka){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(ba){this._interactive=ba}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},
{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(ba){return this.isFoldable?this.getFoldedContext(ba):Tb._get(Object.getPrototypeOf(Jb.prototype),"getSubNode",this).call(this,ba)}},{key:"getFoldedContext",value:function(ba){return this.foldedNodes[ba.key]=new ce.FoldedNode(Object.assign({},ba,{root:this.root,target:this.target,foldableNode:this,spec:ce.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",
value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(ba,Ka){(Ka=void 0===Ka?!1:Ka)&&(this.target[this.key]=ba);this.value=this.target[this.key];this.valueString=ce.printValue(this.value);this.interactive&&(Ka||this._propertyWidget.highlight());if(this.isFoldable)for(var ob in this.foldedNodes)this.foldedNodes[ob].value=this.value[ob],this.foldedNodes[ob].valueString=ce.printValue(this.value[ob]),this.foldedNodes[ob]._propertyWidget&&ce.signal(this.foldedNodes[ob]._propertyWidget,
"update",this.value[ob])}},{key:"display",value:function(ba){var Ka=this,ob=this._propertyWidget,yb=this.keyString,Jc=this.valueString,wc=this.target,Dd=this.value,zd=this.spec;if(!(this.interactive||zd.foldable&&ce.isMultiValue(Dd,zd.foldable)))return ba.renderPropertyControl({target:wc,keyString:yb,valueString:Jc,tree:ba.ui.propertyTree,value:Dd,spec:zd,node:this,fastRender:!0});if(ob)return ob.keyString=yb,ob.valueString=Jc,ob.isSelected=this.isSelected,ob.control&&(ob.control.isSelected=this.isSelected),
ob;ob=this._propertyWidget=ba.renderPropertyControl({target:wc,keyString:yb,valueString:Jc,value:Dd,spec:zd,node:this,isSelected:this.isSelected,fontColor:ba.ui.propertyTree.fontColor});this.isInternalProperty||zd.readOnly||(ce.connect(ob,"propertyValue",this,"refreshProperty",{updater:function(Ad,He){return Ad(He,!0)}}),ce.connect(ob,"openWidget",this.root,"onWidgetOpened",{converter:function(Ad){return{widget:Ad,node:Ka.sourceObj}}}));return ob}}],[{key:"className",get:function(){return"PropertyNode"}}],
ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14672,end:18071})})(ce.InspectionNode);(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Jb=ab.hasOwnProperty("FoldedNode")&&"function"===typeof ab.FoldedNode?ab.FoldedNode:ab.FoldedNode=
function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(ba){Tb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);this.foldableNode=ba=ba.foldableNode;this.foldedProp=ba.key+ce.string.capitalize(this.key)}},{key:"refreshProperty",value:function(ba,Ka){Ka=void 0===Ka?!1:Ka;var ob={};this.foldableNode.refreshProperty(Object.assign({},
this.target[this.foldableNode.key],(ob[this.key]=ba,ob)),Ka)}}],[{key:"className",get:function(){return"FoldedNode"}}],ab,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18073,end:18749})})(ce.PropertyNode);var Bf=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Bf.Color=
Ab;var rg=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Jb=ab.hasOwnProperty("DarkTheme")&&"function"===typeof ab.DarkTheme?ab.DarkTheme:ab.DarkTheme=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:"background",get:function(){return Bf.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Bf.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},
{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},
{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Bf.Color.rgb(204,109,243)}}},{key:"atom",
get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Bf.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Bf.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",
get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},
{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Bf.Color.white,fontWeight:"bold",backgroundColor:Bf.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Bf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",
get:function(){return{backgroundColor:Bf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:"className",get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],ab,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3048})}(void 0),Qf=rg=Bf.DarkTheme;Bf.default=rg;var Yc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Yc.inspect=ed;Yc.remoteInspect=ue;Yc.generateReferenceExpression=Md;Yc.onNumberDragStart=function(Ja,ab){ab.initPos=Ja.position;ab.factorLabel=(new Yc.Tooltip({description:"1x"})).openInWorld(Ja.hand.position.addXY(10,10))};Yc.onNumberDrag=
function(Ja,ab){var Jb=Yc.getScaleAndOffset(Ja,ab),ba=Jb.scale;Jb=Jb.offset;ab.factorLabel.position=Ja.hand.position.addXY(10,10);ab.factorLabel.description=ba+"x";return Yc.getCurrentValue(Jb,ba,ab)};Yc.onNumberDragEnd=function(Ja,ab){var Jb=Yc.getScaleAndOffset(Ja,ab);Ja=Jb.offset;Jb=Jb.scale;ab.factorLabel.softRemove();return Yc.getCurrentValue(Ja,Jb,ab)};Yc.getScaleAndOffset=function(Ja,ab){var Jb=Ja.position.subPt(ab.initPos);Ja=Jb.x;ab=Yc.num.roundTo(Math.exp(-Jb.y/$world.height*6),.01)*ab.baseFactor;
return{offset:Ja,scale:ab}};Yc.getCurrentValue=function(Ja,ab,Jb){return Math.max(Jb.min,Math.min(Jb.max,Jb.scrubbedValue+(Jb.floatingPoint?Ja*ab:Math.round(Ja*ab))))};Yc.Color=Ab;Yc.Rectangle=ec;Yc.rect=ke;Yc.pt=he;Yc.obj=md;Yc.num=Fb;Yc.Path=zc;Yc.arr=kc;Yc.promise=Ec;Yc.connect=Sc;Yc.disconnect=Pb;Yc.once=db;Yc.Morph=Qb;Yc.Tooltip=Tc;Yc.VerticalLayout=ld;Yc.GridLayout=Rb;Yc.HorizontalLayout=qb;Yc.morph=gd;Yc.CustomLayout=bc;Yc.Label=Ic;Yc.Icon=ra;Yc.StyleSheet=kd;Yc.config=Fa;Yc.Tree=mb;Yc.LoadingIndicator=
ub;Yc.DropDownList=Db;Yc.DropDownSelector=cb;Yc.SearchField=fb;Yc.LabeledCheckBox=Eb;Yc.MorphHighlighter=Oc;Yc.InteractiveMorphSelector=Wc;Yc.printValue=Lf;Yc.RemoteInspectionTree=Mf;Yc.InspectionTree=we;Yc.isMultiValue=Ie;Yc.valueWidgets=Q;Yc.popovers=ea;Yc.DarkTheme=Qf;Yc.DefaultTheme=Mb;Yc.syncEval=qc;Yc.inspectorCommands=[{name:"focus codeEditor",exec:function(Ja){Ja.get("codeEditor").show();Ja.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ja){Ja.get("propertyTree").show();
Ja.get("propertyTree").focus();return!0}}];(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=ab.hasOwnProperty("DraggedProp")&&"function"===typeof ab.DraggedProp?ab.DraggedProp:ab.DraggedProp=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:"applyToTarget",value:function(ba){var Ka=this.currentTarget,ob=this.control;this.remove();Yc.MorphHighlighter.removeHighlighters(ba.world);
if(Ka)if(Ka.isText&&"js"===Ka.editorModeName){var yb=Ka.evalEnvironment.context;ba=Ka.textPositionFromPoint(Ka.localize(ba.position));yb=Yc.generateReferenceExpression(this.sourceObject,{fromMorph:yb});ob.keyString&&(yb+="."+ob.keyString);Ka.insertTextAndSelect(yb,ba);Ka.focus()}else"propertyValue"in ob&&(Ka[ob.keyString]=ob.propertyValue)}},{key:"update",value:function(ba){ba=ba.hand.globalPosition;var Ka=this.morphBeneath(ba),ob;if(Ka){for(Ka==this.morphHighlighter&&(Ka=Ka.morphBeneath(ba));ob=
[Ka].concat($jscomp.arrayFromIterable(Ka.ownerChain())).find(function(yb){return!yb.visible});)Ka=ob=ob.morphBeneath(ba);if(Ka!=this.currentTarget){this.currentTarget=Ka;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Ka.isWorld)return;this.morphHighlighter=Yc.MorphHighlighter.for($world,Ka);this.morphHighlighter.show()}this.position=ba}}}],[{key:"className",get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Yc.Color.rgb(169,
204,227)},fill:{defaultValue:Yc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var ba=this.control;if(!ba)return this.submorphs=[];this.height=22;this.submorphs=[ba];ba.top=0;ba.fontSize=14;"function"===typeof ba.relayout&&ba.relayout();this.width=ba.width+20;this.adjustOrigin(Yc.pt(10,10))}}}}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1268,end:3690})})(Yc.Morph);(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=ab.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof ab.DraggableTreeLabel?ab.DraggableTreeLabel:ab.DraggableTreeLabel=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Jb,Ja,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(ba){this.draggedProp=new Yc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Yc.connect(ba.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(ba){}},{key:"onDragEnd",value:function(ba){Yc.disconnect(ba.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(ba)}}],[{key:"className",get:function(){return"DraggableTreeLabel"}},
{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Yc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:Yc.Color.transparent},padding:{defaultValue:Yc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(ba){this.setProperty("isSelected",ba);ba?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),
this.removeStyleClass("selected"));this.control&&(this.control.isSelected=ba)}}}}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3692,end:5015})})(Yc.Label);we=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=ab.hasOwnProperty("PropertyControl")&&
"function"===typeof ab.PropertyControl?ab.PropertyControl:ab.PropertyControl=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(ba,Ka,ob){ba.control=new Yc.DropDownSelector({opacity:.8,fill:Yc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Ka,padding:0,values:ob});
Yc.connect(ba.control,"update",ba,"propertyValue",{updater:function(yb,Jc){this.targetObj.propertyValue!=Jc&&yb(Jc)}});Yc.connect(ba,"update",ba.control,"selectedValue",{updater:function(yb,Jc){Jc=Jc&&Jc.valueOf?Jc.valueOf():Jc;this.targetObj.propertyValue!=Jc&&yb(Jc)}});return ba}},{key:"toggleMultiValuePlaceholder",value:function(ba){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:Yc.Color.transparent,layout:new Yc.HorizontalLayout({spacing:3}),name:"multi value placeholder",
nativeCursor:"pointer",submorphs:Yc.arr.range(0,2).map(function(Ka){return{type:"ellipse",fill:Yc.Color.gray.withA(.5),reactsToPointer:!1,extent:Yc.pt(7,7)}})});ba?(Yc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(Yc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=
!1)}},{key:"toggleFoldableValue",value:function(ba){this.foldableProperties&&this.toggleMultiValuePlaceholder(Yc.isMultiValue(ba,this.foldableProperties))}},{key:"asFoldable",value:function(ba){this.foldableProperties=ba;Yc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&
(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var ba=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});ba.isLayoutable=!1;ba.fontWeight="bold";ba.fontColor=Yc.Color.orange;ba.reactsToPointer=!1;ba.fadeOut(2E3)}}],[{key:"className",get:function(){return"PropertyControl"}},{key:"properties",
get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(ba){this.submorphs=[ba]}},layout:{initialize:function(){this.layout=new Yc.CustomLayout({relayout:function(ba){ba.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(ba){return(ba=ba.value)&&(ba.isColor||ba.isGradient)?"Color":ba&&ba.isPoint?"Point":
Yc.obj.isBoolean(ba)?"Boolean":Yc.obj.isNumber(ba)?"Number":Yc.obj.isString(ba)?"String":ba&&ba.isRectangle?"Rectangle":!1}},{key:"render",value:function(ba){ba.spec.type||(ba.spec=Object.assign({},ba.spec,{type:this.inferType(ba)}));switch(ba.spec.type){case "Color":var Ka=this.renderColorControl(ba);break;case "ColorGradient":Ka=this.renderColorControl(Object.assign({},ba,{gradientEnabled:!0}));break;case "Number":Ka=this.renderNumberControl(ba);break;case "String":Ka=this.renderStringControl(ba);
break;case "RichText":Ka=this.renderStringControl(ba);break;case "Layout":Ka=this.renderLayoutControl(ba);break;case "Enum":Ka=this.renderEnumControl(ba);break;case "Shadow":Ka=this.renderShadowControl(ba);break;case "Point":Ka=this.renderPointControl(ba);break;case "Rectangle":Ka=this.renderRectangleControl(ba);break;case "Boolean":Ka=this.renderBooleanControl(ba);break;default:Ka=this.renderItSomehow(ba)}Ka.control&&(Yc.connect(Ka.control,"openWidget",Ka,"openWidget"),Ka.toggleFoldableValue(ba.value));
return Ka}},{key:"baseControl",value:function(ba){var Ka=ba.spec;ba=new this({keyString:ba.keyString,valueString:ba.valueString,isSelected:!1,propertyValue:ba.value});Ka.foldable&&ba.asFoldable(Ka.foldable);return ba}},{key:"renderGrabbableKey",value:function(ba){var Ka=this,ob=ba.target;return[ba.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(yb){yb.state.draggedProp=new Yc.DraggedProp({sourceObject:ob,control:Ka.baseControl(ba)});yb.state.draggedProp.openInWorld();Yc.connect(yb.hand,
"update",yb.state.draggedProp,"update")},onDrag:function(yb){},onDragEnd:function(yb){Yc.disconnect(yb.hand,"update",yb.state.draggedProp,"update");yb.state.draggedProp.applyToTarget(yb)}}]}},{key:"renderEnumControl",value:function(ba){var Ka=ba.value,ob=ba.spec.values,yb=ba.keyString,Jc=ba.target,wc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(Ka?Ka.valueOf?Ka.valueOf():Ka:"Not set"),{nativeCursor:"pointer",onMouseDown:function(Dd,zd){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ad){Jc.world().openWorldMenu(Dd,
ob.map(function(He){return{string:He.toString(),action:function(){Jc[yb]=He;wc.rerender()}}}));Ad.jumpToEnd()})}}],$jscomp.arrayFromIterable(Yc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7})))}},{key:"renderStringControl",value:function(ba){var Ka=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(200<Ka.length?Ka.slice(0,20)+"...":Ka),{fontColor:Yc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(ba){var Ka=
ba.value,ob=ba.keyString,yb=ba.valueString,Jc=ba.target,wc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+yb,{fontColor:Yc.Color.black,nativeCursor:"pointer",onMouseDown:function(Dd){var zd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ad){if(1==Ad.nextAddress)return zd=new Yc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:Ka}),zd.relayout(),Ad.yield(zd.fadeIntoWorld(Dd.positionIn(Jc.world())),2);Yc.connect(zd,"rectangle",function(He){Jc[ob]=
He;wc.rerender()});Ad.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(ba){var Ka=ba.value,ob=ba.keyString,yb=ba.valueString,Jc=ba.target,wc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+yb,{nativeCursor:"pointer",fontColor:Ka?Yc.Color.green:Yc.Color.red,onMouseDown:function(Dd){Jc[ob]=!Jc[ob];wc.rerender()}}])}},{key:"renderNumberControl",value:function(ba){var Ka=ba.value,ob=ba.spec,yb=ba.keyString,Jc=ba.valueString,wc=ba.node,Dd=ba.target,zd=
ba.tree,Ad=void 0===wc._numberControls?new Rf:wc._numberControls,He=$jscomp.makeIterator(Ad.submorphs),df=He.next().value,og=He.next().value;Ad.fontColor=zd.fontColor;var Jh=wc._numberControls=Ad;"max"in ob&&"min"in ob&&-Infinity!=ob.min&&Infinity!=ob.max?(Jh.baseFactor=(ob.max-ob.min)/100,Jh.floatingPoint=ob.isFloat,Jh.max=ob.max,Jh.min=ob.min):(Jh.floatingPoint=ob.isFloat,Jh.baseFactor=.5,Jh.min=void 0!=ob.min?ob.min:-Infinity,Jh.max=void 0!=ob.max?ob.max:Infinity);var Oi=Yc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;
return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),$jscomp.arrayFromIterable(wc._inputMorph?[wc._inputMorph,{}]:[" "+(void 0!=Ka&&(Ka.valueOf?Ka.valueOf():Ka).toFixed(ob.isFloat?3:0))+" ",{fontColor:Oi,onMouseUp:function(Th){wc._inputMorph=Yc.morph({type:"input",fill:null,fontColor:Oi,fontFamily:"IBM Plex Mono",fontSize:14,padding:Yc.rect(8,2,-6,2),height:23,cursorColor:Yc.Color.white,value:Ka.valueOf?Ka.valueOf():Jc});Dd[yb]=Ka;wc._inputMorph.focus();Yc.once(wc._inputMorph,"inputAccepted",
function(Kj){delete wc._inputMorph;Dd[yb]=ob.isFloat?Number.parseFloat(Kj):Number.parseInt(Kj);wc.rerender()});Yc.once(wc._inputMorph,"onBlur",function(Kj){wc._inputMorph&&(delete wc._inputMorph,Dd[yb]=Ka,wc.rerender())});wc.rerender()},onDragStart:function(Th){Jh.scrubbedValue=Ka;Yc.onNumberDragStart(Th,Jh)},onDrag:function(Th){Dd[yb]=Yc.onNumberDrag(Th,Jh);wc.rerender()},onDragEnd:function(Th){return Yc.onNumberDragEnd(Th,Jh)}},Ad,{onMouseUp:function(){df.fill=og.fill=null},onMouseDown:function(Th){if(Th.targetMorph===
df){df.fill=Yc.Color.white.withA(.2);if("max"in ob&&Dd[yb]>=ob.max)return;Dd[yb]+=1}if(Th.targetMorph===og){og.fill=Yc.Color.white.withA(.2);if("min"in ob&&Dd[yb]<=ob.min)return;--Dd[yb]}wc.rerender()}}]))}},{key:"renderShadowControl",value:function(ba){var Ka=ba.keyString,ob=ba.value,yb=ba.target,Jc=ba.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[""+(ob?ob.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(wc){var Dd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zd){if(1==
zd.nextAddress)return Dd=new Yc.popovers.ShadowPopover({shadowValue:yb[Ka],hasFixedPosition:!0}),zd.yield(Dd.fadeIntoWorld(wc.positionIn(yb.world())),2);Yc.connect(Dd,"shadowValue",function(Ad){yb[Ka]=Ad;Jc.rerender()});zd.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(ba){var Ka=ba.keyString,ob=ba.value,yb=ba.target,Jc=ba.node,wc=Yc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Dd={nativeCursor:"pointer",onMouseDown:function(zd){var Ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(He){if(1==
He.nextAddress)return Ad=new Yc.popovers.PointPopover({pointValue:yb[Ka],hasFixedPosition:!0}),He.yield(Ad.fadeIntoWorld(zd.positionIn(yb.world())),2);Yc.connect(Ad,"pointValue",function(df){yb[Ka]=df;Jc.rerender()});He.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" pt(",Object.assign({},Dd),""+ob.x.toFixed(),Object.assign({fontColor:wc},Dd),",",Object.assign({},Dd),""+ob.y.toFixed(),Object.assign({fontColor:wc},Dd),")",Object.assign({},Dd)])}},{key:"renderLayoutControl",
value:function(ba){var Ka=ba.valueString,ob=ba.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+(ob?Ka:"No Layout"),{onMouseDown:function(yb){}}])}},{key:"renderColorControl",value:function(ba){var Ka=ba.node,ob=ba.gradientEnabled,yb=ba.valueString,Jc=ba.keyString,wc=ba.value,Dd=ba.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[Yc.morph({fill:wc.valueOf?wc.valueOf():wc,extent:Yc.pt(15,15),borderColor:Yc.Color.gray,borderWidth:1}),{paddingLeft:"5px",
paddingTop:"4px",paddingRight:"5px"},""+(wc?wc.valueOf?wc.valueOf():yb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(zd){var Ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(He){if(1==He.nextAddress)return Ad=new Yc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Dd,fillValue:wc,title:"Fill Control",gradientEnabled:ob}),He.yield(Ad.fadeIntoWorld(zd.positionIn(Dd.world())),2);Yc.connect(Ad,"fillValue",function(df){Dd[Jc]=df;Ka.rerender()});He.jumpToEnd()})}}])}},{key:"renderItSomehow",
value:function(ba){var Ka=ba.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ba)),[" "+Ka,{}])}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5024,end:20444})}(Yc.DraggableTreeLabel);Yc.PropertyControl=we;Yc.PropertyControl=we;Yc.PropertyControl=we;
Yc.inspect=ed;Yc.inspect=ed;Yc.remoteInspect=ue;Yc.remoteInspect=ue;Yc.generateReferenceExpression=Md;Yc.generateReferenceExpression=Md;var Rf=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=ab.hasOwnProperty("NumberControls")&&"function"===typeof ab.NumberControls?ab.NumberControls:ab.NumberControls=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,void 0,[{key:"className",
get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Yc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Yc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(ba){this.submorphs.map(function(Ka){return Ka.fontColor=ba})}},submorphs:{initialize:function(){this.submorphs=[Yc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Yc.rect(5,2,0,-6),fontSize:12}),
Yc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Yc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23095,end:24127})}(Yc.Morph);(function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),
Jb=ab.hasOwnProperty("PropertyTree")&&"function"===typeof ab.PropertyTree?ab.PropertyTree:ab.PropertyTree=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:"onDrag",value:function(ba){this._onDragHandler&&this._onDragHandler(ba)}}],[{key:"className",get:function(){return"PropertyTree"}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25279,end:25389})})(Yc.Tree);we=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=ab.hasOwnProperty("Inspector")&&"function"===typeof ab.Inspector?ab.Inspector:ab.Inspector=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:"onWindowClose",
value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(ba){}},{key:"__after_deserialize__",value:function(ba,Ka,ob){var yb=this,Jc=new Yc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Yc.InspectionTree.forObject(null,this)}));this.addMorph(Jc,this.getSubmorphNamed("terminal toggler"));this.layout.col(0).row(1).group.morph=Jc;this.whenRendered().then(function(){yb.targetObject&&
(yb.targetObject=yb.targetObject)});Tb._get(Object.getPrototypeOf(Jb.prototype),"__after_deserialize__",this).call(this,ba,Ka,ob)}},{key:"__additionally_serialize__",value:function(ba,Ka,ob,yb){ba=ba.props.submorphs.value;for(Ka=ba.length;Ka--;)ob.refForId(ba[Ka].id).realObj==this.ui.propertyTree&&Yc.arr.removeAt(ba,Ka)}},{key:"renderDraggableTreeLabel",value:function(ba){return new Yc.DraggableTreeLabel(ba)}},{key:"renderPropertyControl",value:function(ba){return Yc.PropertyControl.render(ba)}},
{key:"onLoad",value:function(){var ba=this.ui,Ka=ba.codeEditor,ob=ba.thisBindingSelector,yb=ba.propertyTree;Ka.changeEditorMode("js").then(function(){return Ka.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==ob.selection?Ka.owner.selectedContext:Ka.owner.targetObject},get systemInterface(){return Yc.Path("treeData.systemInterface").get(yb)},format:"esm"}}).catch(function(Jc){return $world.logError(Jc)})}},{key:Symbol.for("lively-instance-initialize"),
value:function(ba){Tb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ba);ba=this.ui;var Ka=ba.targetPicker,ob=ba.propertyTree,yb=ba.resizer,Jc=ba.terminalToggler,wc=ba.unknowns,Dd=ba.internals,zd=ba.searchField,Ad=ba.codeEditor,He=ba.fixImportButton,df=ba.thisBindingSelector;Ad.changeEditorMode("js").then(function(){return Ad.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==df.selection?Ad.owner.selectedContext:
Ad.owner.targetObject},get systemInterface(){return ob.treeData.systemInterface},format:"esm"}}).catch(function(og){return $world.logError(og)});Yc.connect(Ka,"onMouseDown",this,"selectTarget");Yc.connect(ob,"onScroll",this,"repositionOpenWidget");Yc.connect(yb,"onDrag",this,"adjustProportions");Yc.connect(Jc,"onMouseDown",this,"toggleCodeEditor");Yc.connect(wc,"trigger",this,"filterProperties");Yc.connect(Dd,"trigger",this,"filterProperties");Yc.connect(zd,"searchInput",this,"filterProperties");
Yc.connect(ob,"nodeCollapseChanged",this,"filterProperties");Yc.connect(this,"extent",this,"relayout");Yc.connect(df,"selection",this,"bindCodeEditorThis");Yc.connect(He,"fire",Ad,"execCommand",{updater:function(og){return og("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var ba=this.ui.propertyTree.selectedIndex-1,Ka=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Ka=this.ui.propertyTree.document.getLine(ba).textAndAttributes.slice(0,
4).concat(Ka.display(this));ba=this.ui.propertyTree.lineRange(ba,!1);this.ui.propertyTree.replace(ba,Ka,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var ba=Yc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));
if(ba!=this.lastChange||this.lastSubmorphs!=Yc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==ba.prop&&this.repositionOpenWidget(),this.lastChange=ba,this.lastSubmorphs=Yc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var ba;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Ka){Ka=Ka.node;Ka.target&&
(ba=Ka.foldableNode?Ka.target[Ka.foldableNode.key][Ka.key]:Ka.target[Ka.key],!Yc.obj.equals(ba,Ka.value)&&Ka.refreshProperty&&Ka.refreshProperty(ba))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(ba,Ka){Ka=void 0===Ka?!1:Ka;var ob=this,yb,Jc,wc,Dd,zd,Ad,He,df,og,Jh,Oi,Th,Kj,Kh,gl;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Kf){switch(Kf.nextAddress){case 1:if(!ob.isUpdating()){Kf.jumpTo(2);break}return Kf.yield(ob.whenUpdated(),
2);case 2:yb=Yc.promise.deferred();Jc=yb.promise;wc=!!ob.target;ob.updateInProgress=Jc;Kf.setCatchFinallyBlocks(4);Ka&&(Dd=Yc.LoadingIndicator.open("connecting to remote..."));if(!Ka){zd=Yc.InspectionTree.forObject(ba,ob);Kf.jumpTo(6);break}return Kf.yield(Yc.RemoteInspectionTree.forObject(ba,ob),7);case 7:zd=Kf.yieldResult;case 6:return Ad=zd,He=ob.ui.propertyTree,Kf.yield(Ad.collapse(Ad.root,!1),8);case 8:if(!Ad.root.children){Kf.jumpTo(9);break}return Kf.yield(Ad.collapse(Ad.root.children[0],!1),
9);case 9:if(df=ob.originalTreeData&&ob.originalTreeData.diff(Ad)){og=$jscomp.makeIterator(df);for(Jh=og.next();!Jh.done;Jh=og.next())Oi=Jh.value,Th=$jscomp.makeIterator(Oi),Kj=Th.next().value,Kh=Th.next().value,Kj.refreshProperty(Kh.value);Kf.jumpTo(11);break}He.treeData=Ad;return Kf.yield(ob.filterProperties(),12);case 12:if(!He.treeData.root.isCollapsed){Kf.jumpTo(13);break}return Kf.yield(He.onNodeCollapseChanged({node:Ad.root,isCollapsed:!1}),14);case 14:He.selectedIndex=1;case 13:return Kf.yield(He.execCommand("uncollapse selected node"),
11);case 11:ob.toggleWindowStyle(wc);Dd&&Dd.remove();Kf.leaveTryBlock(5);break;case 4:gl=Kf.enterCatchBlock(),ob.showError(gl);case 5:ob.startStepping(1E3,"refreshAllProperties"),ob.updateInProgress=null,Kf.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(ba){ba=void 0===ba?!0:ba;var Ka=this,ob,yb,Jc,wc,Dd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zd){if(1==zd.nextAddress)return ob=300,wc=Ka.ui.codeEditor.pluginFind(function(Ad){return Ad.runEval}),Dd=Ka.getWindow(),zd.yield(wc.runEval("System.get('@system-env').node"),
2);zd.yieldResult.value?(Jc=[].concat($jscomp.arrayFromIterable(Yc.arr.without(Dd.styleClasses,"local")),["node"]),yb=Yc.DarkTheme.instance):(Jc=["local"].concat($jscomp.arrayFromIterable(Dd?Yc.arr.without(Dd.styleClasses,"node"):[])),yb=Yc.DefaultTheme.instance);wc.theme=yb;ba?(Dd&&Dd.animate({duration:ob,styleClasses:Jc}),Ka.ui.codeEditor.animate({fill:yb.background,duration:ob})):Dd&&(Dd.styleClasses=Jc);Ka.ui.codeEditor.textString=Ka.ui.codeEditor.textString;wc.highlight();zd.jumpToEnd()})}},
{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var ba=this,Ka=Object.assign({type:"text",borderWidth:1,borderColor:Yc.Color.gray,lineWrapping:"by-chars"},Yc.config.codeEditor.defaultStyle,{textString:""}),ob=Yc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Yc.rect(0,0,this.width,30);
var yb=new Yc.SearchField({styleClasses:["idle"],name:"searchField"});ob[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[yb,{type:"button",name:"targetPicker",padding:Yc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Yc.Icon.textAttribute("crosshairs")},new Yc.LabeledCheckBox({label:"Internals",name:"internals"}),new Yc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Yc.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:Yc.InspectionTree.forObject(null,this)})),Yc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},Ka),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Yc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(ob),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(ob),
[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){ba.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var ba=this,Ka,ob,yb,Jc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){switch(wc.nextAddress){case 1:if(ba.env.eventDispatcher.isKeyPressed("Shift"))return ob=$jscomp,yb=ob.makeIterator,wc.yield($world.execCommand("select morph",
{justReturn:!0}),5);ba.toggleSelectionInstructions(!0);return wc.yield(Yc.InteractiveMorphSelector.selectMorph(),4);case 4:Ka=wc.yieldResult;ba.toggleSelectionInstructions(!1);wc.jumpTo(3);break;case 5:Jc=yb.call(ob,wc.yieldResult),Ka=Jc.next().value;case 3:Ka&&(ba.targetObject=Ka),wc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(ba){if(ba&&!this.instructionWidget){var Ka=Yc.morph({type:"label",name:"escapeKey",value:"esc"});Ka.whenRendered().then(function(){return Ka.fit()});
this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},Ka,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",
value:function(ba){ba=ba.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;ba.epiMorph=!0;this.openWidget=ba;Yc.once(ba,"close",this,"closeOpenWidget");Yc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var ba=this.ui.propertyTree,Ka=ba.textLayout.boundsFor(ba,{column:0,row:ba.selectedIndex-1});Ka=ba.worldPoint(Yc.pt(Ka.x,Ka.y+Ka.height/2)).addPt(ba.scroll.negated());ba=ba.globalBounds();
Ka.x=this.globalBounds().center().x;Ka.y<ba.top()?Ka=ba.topCenter():ba.bottom()-20<Ka.y&&(Ka=ba.bottomCenter().addXY(0,-20));return Ka}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(ba){this.layout.row(1).height+=ba.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(ba){if(ba!==
this.isEditorVisible()){var Ka=this.extent,ob=this.layout,yb=this.ui,Jc=yb.terminalToggler,wc=yb.codeEditor,Dd=yb.thisBindingSelector;yb=yb.fixImportButton;ob.disable();ba?(Jc.fontColor=Yc.Color.rgbHex("00e0ff"),ob.row(3).height=this.codeEditorHeight||180,ob.row(2).height=5,yb.animate({visible:!0,duration:200}),Dd.animate({visible:!0,duration:200})):(this.codeEditorHeight=ob.row(3).height,Jc.fontColor=Yc.Color.white,ob.row(3).height=ob.row(2).height=0,yb.animate({visible:!1,duration:200}),Dd.animate({visible:!1,
duration:200}));this.extent=Ka;ob.enable({duration:200});this.relayout({duration:200});wc.focus();wc.animate({opacity:ba?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var ba=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){ba.makeEditorVisible(!ba.isEditorVisible());Ka.jumpToEnd()})}},{key:"filterProperties",value:function(){var ba=this,Ka,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress)return Ka=ba.ui.searchField,ob=ba.ui.propertyTree,
ba.originalTreeData||(ba.originalTreeData=ob.treeData),Yc.disconnect(ob.treeData,"onWidgetOpened",ba,"onWidgetOpened"),yb.yield(ob.treeData.filter({maxDepth:2,showUnknown:ba.ui.unknowns.checked,showInternal:ba.ui.internals.checked,iterator:function(Jc){return Ka.matches(Jc.key)}}),2);ob.update();Yc.connect(ob.treeData,"onWidgetOpened",ba,"onWidgetOpened");yb.jumpToEnd()})}},{key:"relayout",value:function(ba){ba=void 0===ba?{}:ba;var Ka=this,ob,yb,Jc,wc,Dd,zd,Ad,He,df;return $jscomp.asyncExecutePromiseGeneratorProgram(function(og){Ka.layout&&
Ka.layout.forceLayout();ob=Ka;yb=ob.ui;Jc=yb.fixImportButton;wc=yb.terminalToggler;Dd=yb.propertyTree;zd=yb.thisBindingSelector;Ad=Dd.bounds().insetBy(5).bottomLeft();He=Dd.bounds().insetBy(5).bottomRight();df=He.subXY(Jc.width+10,0);zd.width=115;zd.listMorph.itemHeight=20;ba.duration?(wc.animate(Object.assign({bottomLeft:Ad},ba)),Jc.animate(Object.assign({bottomRight:He},ba)),zd.animate(Object.assign({bottomRight:df},ba))):(wc.bottomLeft=Ad,Jc.bottomRight=He,zd.bottomRight=df);og.jumpToEnd()})}},
{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Tb._get(Object.getPrototypeOf(Jb.prototype),"keybindings",this))}},{key:"commands",get:function(){return Yc.inspectorCommands}}],[{key:"className",get:function(){return"Inspector"}},{key:"openInWindow",value:function(ba){ba=new this(ba);ba.openInWindow();return ba}},{key:"properties",
get:function(){return{extent:{defaultValue:Yc.pt(400,500)},fill:{defaultValue:Yc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(ba){this.setProperty("remoteTarget",ba);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ba,!0))}},targetObject:{after:["submorphs"],set:function(ba){this._serializableTarget=ba&&ba.isMorph?ba.id:ba;this.setProperty("targetObject",ba);this.ui.propertyTree&&
(this.originalTreeData=null,this.prepareForNewTargetObject(ba))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var ba=this.ui.propertyTree,Ka=ba.selectedNode;ba=ba.treeData;return ba.getContextFor(Ka?Ka:ba.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),
thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Yc.Color.gray,
fontSize:14,fontFamily:Yc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],ab,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25406,end:45571})}(Yc.Morph);we=Yc.Inspector;Mf=Da("I",we);Yc.default=
we;var Fg=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");Fg.Inspector=Mf;Fg.string=yd;Fg.Morph=Qb;Fg.pt=he;Fg.Color=Ab;we=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ja,ab,Jb){Jb=void 0===Jb?1:Jb;var ba,Ka,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){switch(yb.nextAddress){case 1:return Ja.maybeSelectCommentOrLine(),yb.setCatchFinallyBlocks(2),ab=Object.assign({},ab,{logDoit:!0,inspect:!0,
inspectDepth:Jb}),yb.yield(Ja.doEval(void 0,ab),4);case 4:ba=yb.yieldResult;Ka=ba.error?ba.error:ba.isError?ba.value:null;yb.leaveTryBlock(3);break;case 2:Ka=ob=yb.enterCatchBlock();case 3:return Ka?Ja.showError(Ka):Ja.setStatusMessage(Fg.string.truncate(ba.value,1E3)),yb.return(ba)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ja,ab){var Jb,ba,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){switch(ob.nextAddress){case 1:return ob.setCatchFinallyBlocks(2),
ob.yield(Ja.doEval({start:{row:0,column:0},end:Ja.documentEndPosition},Object.assign({},ab,{logDoit:!0})),4);case 4:Jb=ob.yieldResult;ba=Jb.error?Jb.error:Jb.isError?Jb.value:null;ob.leaveTryBlock(3);break;case 2:ba=Ka=ob.enterCatchBlock();case 3:return ba?Ja.showError(ba):Ja.setStatusMessage(String(Jb.value)),ob.return(Jb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ja,ab){var Jb,ba,Ka,ob,yb,Jc,wc,Dd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zd){switch(zd.nextAddress){case 1:return Ja.maybeSelectCommentOrLine(),
zd.setCatchFinallyBlocks(2),ab=Object.assign({},ab,{asString:!1,logDoit:!0}),zd.yield(Ja.doEval(void 0,ab),4);case 4:Jb=zd.yieldResult;ba=Jb.error?Jb.error:Jb.isError?Jb.value:null;zd.leaveTryBlock(3);break;case 2:ba=Ka=zd.enterCatchBlock();case 3:Ja.selection.collapseToEnd();if(ob=Jb.value&&Jb.value.isColor)return Ja.selection.text=String(Jb.value),yb=new Fg.Morph({fill:Fg.Color.transparent,extent:Fg.pt(Ja.fontSize+2,Ja.fontSize+2),submorphs:[{fill:Jb.value,center:Fg.pt(Ja.fontSize+2,Ja.fontSize+
2).scaleBy(.5)}]}),Jc=Ja.selection.start,wc=Jc.column,Dd=Jc.row,Ja.insertText([yb,{}],Ja.selection.start),Ja.selection.start={column:wc,row:Dd},zd.return(Jb);Ja.insertTextAndSelect(ba?String(ba)+(ba.stack?"\n"+ba.stack:""):String(Jb.value));return zd.return(Jb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ja,ab){var Jb,ba,Ka,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){switch(yb.nextAddress){case 1:debugger;
Ja.maybeSelectCommentOrLine();ba=Ja.textInRange(Ja.selection);Ka=Ja.evalEnvironment||{};ob=Ja.pluginFind(function(Jc){return Jc.isEditorPlugin&&"function"===typeof Jc.runEval});Ka.systemInterface||(Ka.systemInterface=ob.systemInterface(ab));if("local"!==Ka.systemInterface.name){yb.jumpTo(2);break}yb.setCatchFinallyBlocks(3);return yb.yield(Ja.doEval(void 0,ab),5);case 5:Jb=yb.yieldResult;ba=Jb.value;yb.leaveTryBlock(2);break;case 3:yb.enterCatchBlock();case 2:return Ja.world().execCommand("open object editor",
{target:ba,evalEnvironment:Ka}),yb.return(Jb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Ja,ab){var Jb,ba,Ka,ob,yb,Jc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){switch(wc.nextAddress){case 1:Ja.maybeSelectCommentOrLine();Ka=Ja.textInRange(Ja.selection);ob=Ja.evalEnvironment||{};yb=Ja.pluginFind(function(Dd){return Dd.isEditorPlugin&&"function"===typeof Dd.runEval});ob.systemInterface||(ob.systemInterface=
yb.systemInterface(ab));if("local"!==ob.systemInterface.name){Fg.Inspector.openInWindow({remoteTarget:{code:Ka,evalEnvironment:ob}});wc.jumpTo(2);break}wc.setCatchFinallyBlocks(3);return wc.yield(Ja.doEval(void 0,ab),5);case 5:Jb=wc.yieldResult;ba=Jb.error?Jb.error:Jb.isError?Jb.value:null;Ka=Jb.value;wc.leaveTryBlock(4);break;case 3:ba=Jc=wc.enterCatchBlock();case 4:Fg.Inspector.openInWindow({targetObject:ba?ba:Ka});case 2:return wc.return(Jb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(Ja,ab,Jb){Jb=void 0===Jb?1:Jb;var ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){switch(Ka.nextAddress){case 1:return Ja.maybeSelectCommentOrLine(),Ka.setCatchFinallyBlocks(2),ab=Object.assign({},ab,{inspect:!0,inspectDepth:Jb,logDoit:!0}),Ka.yield(Ja.doEval(void 0,ab),4);case 4:ba=Ka.yieldResult;Ka.leaveTryBlock(3);break;case 2:Ka.enterCatchBlock();case 3:return Ja.selection.collapseToEnd(),Ja.insertTextAndSelect(ba.value),Ka.return(ba)}})}}];Fg.codeEvaluationCommands=
we;Fg.codeEvaluationCommands=we;Fg.codeEvaluationCommands=we;var Hg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Hg.changeAttributeInSelectionOrMorph=function(Ja,ab,Jb){var ba=Ja.selection;Ja.keepPosAtSameScrollOffsetWhile(function(){ba.isEmpty()?Ja[ab]="function"===typeof Jb?Jb(Ja[ab]):Jb:(Ja.undoManager.group(),Ja.changeStyleProperty(ab,function(Ka){return"function"===typeof Jb?Jb(Ka):Jb}),Ja.undoManager.group())})};Mf=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(Ja){var ab=Ja.fontSize;Hg.changeAttributeInSelectionOrMorph(Ja,"fontSize",function(Jb){Jb=Jb||ab;return Jb+(18<=Jb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ja){var ab=Ja.fontSize;Hg.changeAttributeInSelectionOrMorph(Ja,"fontSize",function(Jb){Jb=Jb||ab;return Jb-(18>=Jb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ja){var ab,Jb,ba,Ka,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress){ab=
["serif","sans-serif","monospace"];if(Jb=localStorage["lively.morpic/text-change-font-additional-fonts"])Jb=JSON.parse(Jb),ab.push.apply(ab,$jscomp.arrayFromIterable(Jb));ab.map(function(Jc){return Jc.toLowerCase()}).includes(Ja.fontFamily.toLowerCase())||(ab.push(Ja.fontFamily),Jb=[].concat($jscomp.arrayFromIterable(Jb||[]),[Ja.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Jb));return yb.yield($world.editListPrompt("choose font",ab,{requester:Ja,preselect:ab.indexOf(Ja.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}ba=yb.yieldResult;Ka=$jscomp.makeIterator(ba.selections);if(ob=Ka.next().value)Ja.fontFamily=ob;return yb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ja,ab){ab=void 0===ab?{}:ab;var Jb,ba,Ka,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress){if(ab.hasOwnProperty("link"))return yb.jumpTo(2);ba=Ja.selection;Ka=Ja.getStyleInRange(ba);ob=Ka.link;return yb.yield(Ja.world().prompt("Set link",
{input:ob||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=yb.nextAddress&&(Jb=yb.yieldResult,!Jb))return yb.return();Ja.undoManager.group();Ja.setStyleInRange({link:Jb||void 0},ba);Ja.undoManager.group();yb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ja,ab){var Jb,ba,Ka,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress)return Jb=Ja.selection,ba=Ja.getStyleInRange(Jb),Ka=ba.doit,yb.yield(Ja.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:Ja,input:Ka?Ka.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ja.evalEnvForDoit(Ka||{})}),2);ob=yb.yieldResult;Ja.undoManager.group();ob?Ja.addTextAttribute({doit:{code:ob},nativeCursor:"pointer",textDecoration:"underline"},Jb):Ja.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Jb);Ja.undoManager.group();yb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ja,ab){ab=void 0===ab?{}:ab;Ja.undoManager.group();
ab=!ab.onlySelection&&Ja.selection.isEmpty()?Ja.documentRange:Ja.selection.range;Ja.setStyleInRange(null,ab);Ja.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ja){var ab,Jb,ba,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){if(1==ob.nextAddress)return ob.yield(System.import("lively.modules"),2);if(3!=ob.nextAddress)return ab=ob.yieldResult,Jb=ab.module,ob.yield(Jb("lively.ide/text/ui.js").load(),3);ba=ob.yieldResult;Ka=ba.RichTextControl;return ob.return(Ka.openFor(Ja))})}}];
Hg.commands=Mf;Hg.commands=Mf;Hg.commands=Mf;var qf=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");qf.guessTextModeName=Zb;qf.rangedToken=function(Ja,ab,Jb,ba,Ka){return{start:{row:Ja,column:ab},end:{row:Ja,column:Jb},token:ba,mode:Ka}};qf.fun=gc;qf.arr=kc;qf.connect=Sc;qf.disconnect=Pb;qf.DefaultTheme=Mb;qf.tokenizeDocument=pb;qf.modeInfo=Ba;qf.visitDocumentTokens=Nc;qf.getMode=ic;qf.completionCommands=xa;qf.multiSelectCommands=Pc;qf.navCommands=le;qf.codeCommands=jf;qf.codeEvaluationCommands=
we;qf.richTextCommands=Mf;qf.Color=Ab;qf.Range=fe;qf.guessTextModeName=Zb;qf.guessTextModeName=Zb;Mb=function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Jb=ab.hasOwnProperty("EditorPlugin")&&"function"===typeof ab.EditorPlugin?ab.EditorPlugin:ab.EditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
qf.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(ba){var Ka=this;this.textMorph=ba;qf.connect(ba,"textChange",this,"onTextChange");qf.connect(ba,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Ka.highlight()})}},
{key:"detach",value:function(ba){qf.disconnect(ba,"textChange",this,"onTextChange");qf.disconnect(ba,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(ba){this._ast=null;if(ba){var Ka=this._tokenizerValidBefore;if("replace"===ba.selector){var ob=ba.args[0].start;ba=ob.row;ob=ob.column}else ob=ba=0;if(!Ka||ba<Ka.row||ba===Ka.row&&ob<Ka.column)ba=Math.max(0,ba),this._tokenizerValidBefore={row:ba,
column:ob}}this.requestHighlight()}},{key:"requestHighlight",value:function(ba){var Ka=this;(void 0===ba?0:ba)?this.highlight():qf.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return Ka.highlight()})()}},{key:"highlight",value:function(){var ba=this.textMorph,Ka=this.theme,ob=this.mode,yb=this._tokenizerValidBefore;if(Ka&&ba&&ba.document&&ob){ba.fill=Ka.background;ba.cursorColor=Ka.cursorColor||qf.Color.black;var Jc=ba.viewState,wc={};yb=qf.tokenizeDocument(ob,ba.document,Jc.firstVisibleRow,
Jc.lastVisibleRow,yb);ob=yb.lines;yb=yb.tokens;if(ob.length){Jc=ob[0].row;for(var Dd=[],zd=0;zd<yb.length;Jc++,zd++)for(var Ad=yb[zd],He=0;He<Ad.length;He+=5){var df=Ad[He],og=Ad[He+1],Jh=Ka[Ad[He+2]]||Ka.default;Jh&&Dd.push({start:{row:Jc,column:df},end:{row:Jc,column:og}},Jh)}ba.embeddedMorphs.forEach(function(Oi){var Th=ba.embeddedMorphMap.get(Oi).anchor;wc[Oi.id]=ba.textAttributeAt(Th.position)});ba.setTextAttributesWithSortedRanges(Dd);ba.embeddedMorphs.forEach(function(Oi){var Th=ba.embeddedMorphMap.get(Oi).anchor;
Th=qf.Range.at(Th.position);Th.end.column+=1;ba.replace(Th,[Oi,wc[Oi.id]],!1)});this._tokenizerValidBefore={row:qf.arr.last(ob).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},ba,this)}}},{key:"visitTokensInRange",value:function(ba,Ka){var ob=ba.start,yb=ba.end,Jc=ob.row-1;qf.visitDocumentTokens(this.mode,this.textMorph.document,ob.row,yb.row,null,function(wc){return Jc++},function(wc,Dd,zd,Ad,He,df,og){if(Jc===ob.row&&0<ob.column){if(ob.column>=Ad)return;zd<ob.column&&ob.column<
Ad&&(zd=ob.column)}if(Jc===yb.row){if(yb.column<=zd)return;zd<yb.column&&yb.column<Ad&&(Ad=yb.column)}Ka(wc,Dd,Jc,zd,Ad,He,df,og)})}},{key:"tokensInRange",value:function(ba){var Ka=[];this.visitTokensInRange(ba,function(ob,yb,Jc,wc,Dd,zd,Ad,He){return Ka.push(qf.rangedToken(Jc,wc,Dd,ob,He))});return Ka}},{key:"tokensOfRow",value:function(ba){var Ka=this.textMorph.getLine(ba).length;return this.tokensInRange({start:{row:ba,column:0},end:{row:ba,column:Ka}})}},{key:"tokenAt",value:function(ba){for(var Ka=
this.tokensOfRow(ba.row),ob=Ka.length;ob--;){var yb=Ka[ob];if(yb.token&&yb.start.column<=ba.column&&ba.column<=yb.end.column)return yb}return null}},{key:"getCommands",value:function(ba){return[].concat($jscomp.arrayFromIterable(ba),$jscomp.arrayFromIterable(qf.completionCommands),$jscomp.arrayFromIterable(qf.multiSelectCommands),$jscomp.arrayFromIterable(qf.navCommands),$jscomp.arrayFromIterable(qf.codeCommands),$jscomp.arrayFromIterable(qf.codeEvaluationCommands),$jscomp.arrayFromIterable(qf.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var ba=this.mode,Ka=ba.lineComment,ob=ba.blockCommentStart;ba=ba.blockCommentEnd;var yb={};Ka&&(yb.lineCommentStart=Ka);ob&&(yb.blockCommentStart=ob);ba&&(yb.blockCommentEnd=ba);return yb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(ba,Ka,ob){var yb=this.textMorph,Jc=ba.row,wc=ba.column;ba=Ka[wc-1];Ka=Ka[wc];yb.selection.text="\n";yb.selection.collapseToEnd();
"{"===ba&&"}"===Ka&&(yb.selection.text="\n"+" ".repeat(ob),yb.selection.collapse());yb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Jc+1,lastRow:Jc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var ba=this.textMorph,Ka=this.openPairs,ob=ba.selection,yb=ba.getLine(ob.end.row),
Jc=yb[ob.end.column-1];yb=yb[ob.end.column];ba.autoInsertPairs&&ob.isEmpty()&&Jc in Ka&&yb===Ka[Jc]&&(ob.growRight(1),ob.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(ba){var Ka=this.openPairs,ob=this.closePairs,yb=this.textMorph,Jc=yb.selection,wc=yb.autoInsertPairs&&ba in Ka,Dd=yb.autoInsertPairs&&ba in ob;if(!wc&&!Dd)return!1;var zd=yb.getLine(Jc.end.row)[Jc.end.column];if(!Jc.isEmpty()){if(!wc)return!1;ob=yb.undoManager.ensureNewGroup(yb);yb.insertText(Ka[ba],Jc.end);yb.insertText(ba,
Jc.start);yb.undoManager.group(ob);Jc.growRight(-1);return!0}if(zd in ob&&ba===zd)return Jc.goRight(1),!0;if(Dd&&!wc)return!1;ob=yb.undoManager.ensureNewGroup(yb);yb.insertText(ba+Ka[ba]);yb.undoManager.group(ob);Jc.goLeft(1);return!0}}],[{key:"className",get:function(){return"EditorPlugin"}}],ab,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:3088,end:11936})}(void 0);Ba=Mb=qf.EditorPlugin;xa=Da("C",function(Ja){var ab=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Jb=ab.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof ab.CodeMirrorEnabledEditorPlugin?ab.CodeMirrorEnabledEditorPlugin:ab.CodeMirrorEnabledEditorPlugin=function(ba){ba&&ba[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Jb,Ja,[{key:Symbol.for("lively-instance-initialize"),
value:function(){Tb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(ba){this.mode=this.codeMirrorMode(ba);return Tb._get(Object.getPrototypeOf(Jb.prototype),"attach",this).call(this,ba)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(ba){return{indentWithTabs:!ba.useSoftTabs,indentUnit:ba.tabWidth,
tabSize:4}}},{key:"codeMirrorMode",value:function(ba){ba=this.defaultCodeMirrorModeConfig(ba);return qf.getMode(ba,{name:this.longName})}}],[{key:"className",get:function(){return"CodeMirrorEnabledEditorPlugin"}}],ab,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(qf.EditorPlugin));
qf.CodeMirrorEnabledEditorPlugin=xa;qf.CodeMirrorEnabledEditorPlugin=xa;qf.CodeMirrorEnabledEditorPlugin=xa;qf.default=Mb;Mb=Object.freeze({__proto__:null,guessTextModeName:Zb,"default":Ba,CodeMirrorEnabledEditorPlugin:xa});Da("e",Mb)}}});
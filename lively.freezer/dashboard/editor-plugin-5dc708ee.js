System.register(["./__root_module__-aefa9179.js","kld-intersections","./index-3100fe37.js","./editor-plugin-14253833.js","./index-dd2e460a.js"],function(Da){var Bb,Qb,hc,ac,be,bd,Sd,ed,Mc,pd,Dd,ke,Kd,jd,cb,Ab,Yb,gc,dd,Zd,Wb,oc,Lb,Bc;return{setters:[function(Sc){Bb=Sc.as;Qb=Sc.bB;hc=Sc.bC;ac=Sc.bD;be=Sc.F;bd=Sc.aq;Sd=Sc.aX;ed=Sc.s;Mc=Sc.ab;pd=Sc.bo;Dd=Sc.a6;ke=Sc.$;Kd=Sc.bE;jd=Sc.bv},function(){},function(Sc){cb=Sc.s},function(Sc){Ab=Sc.p;Yb=Sc.d;gc=Sc.a;dd=Sc.r;Zd=Sc.C},function(Sc){Wb=Sc.localInterface;
oc=Sc.systemInterfaceNamed;Lb=Sc.serverInterfaceFor;Bc=Sc.l2lInterfaceFor}],execute:function(){var Sc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");Sc.warnStyle={"border-bottom":"2px dotted orange"};Sc.errorStyle={"background-color":"red"};var Yc=function(Ic){var ec=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),Pc=ec.hasOwnProperty("JavaScriptChecker")&&"function"===typeof ec.JavaScriptChecker?ec.JavaScriptChecker:ec.JavaScriptChecker=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Pc,Ic,[{key:"uninstall",value:function(Q){var ha=Q.text||Q;(ha.markers||[]).forEach(function(Ha){return Ha.id.startsWith("js-checker-")&&ha.removeMarker(Ha)});ha.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(Q,ha){return[].concat($jscomp.arrayFromIterable(Q.embeddedMorphMap.values())).find(function(Ha){return ha.containsPosition(Ha.anchor.position)})}},{key:"onDocumentChange",value:function(Q,
ha,Ha){var Pa=ha.document;try{var bc=Ha.parse()}catch(ic){bc=ic}bc&&(Q=(ha.markers||[]).filter(function(ic){return ic.id.startsWith("js-checker-")}),Ha=Ha.undeclaredVariables().map(function(ic,Ra){var tc=ic.start;ic=ic.end;tc=Pa.indexToPosition(tc);ic=Pa.indexToPosition(ic);return ha.addMarker({id:"js-checker-"+Ra,style:Sc.warnStyle,range:{start:tc,end:ic},type:"js-undeclared-var"})}),Q.slice(Ha.length).forEach(function(ic){return ha.removeMarker(ic)}),bc.parseError?(Q=bc.parseError.loc,Ha=Q.column,
Q=Q.line-1,bc=Pa.indexToPosition(bc.parseError.pos),Ha=bc.column,Q=bc.row,bc={start:{column:Ha-1,row:Q},end:{column:Ha+1,row:Q}},this.hasEmbeddedMorphInRange(ha,bc)||ha.addMarker({id:"js-syntax-error",range:bc,style:Sc.errorStyle,type:"js-syntax-error"})):ha.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],ec,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:118,end:1882})}(void 0),Xb=Yc=Sc.JavaScriptChecker;Sc.default=Yc;var qb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");qb.query=Qb;qb.fuzzyParse=hc;qb.acorn=ac;qb.custom=be;var uc=function(Ic){var ec=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),Pc=ec.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof ec.JavaScriptNavigator?
ec.JavaScriptNavigator:ec.JavaScriptNavigator=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Pc,Ic,[{key:"ensureAST",value:function(Q){return this.parse(Q.textString)}},{key:"parse",value:function(Q){return qb.fuzzyParse(Q)}},{key:"move",value:function(Q,ha){var Ha=!!ha.activeMark||!ha.selection.isEmpty(),Pa=ha.selection,bc=ha.positionToIndex(Pa.lead);Q=this[Q](ha.textString,bc);Q=ha.indexToPosition(Q);Pa.lead=
Q;Ha||(Pa.anchor=Q);ha.scrollCursorIntoView()}},{key:"forwardSexp",value:function(Q){this.move("_forwardSexp",Q)}},{key:"backwardSexp",value:function(Q){this.move("_backwardSexp",Q)}},{key:"backwardUpSexp",value:function(Q){this.move("_backwardUpSexp",Q)}},{key:"forwardDownSexp",value:function(Q){this.move("_forwardDownSexp",Q)}},{key:"_forwardSexp",value:function(Q,ha){Q=this.parse(Q);Q=qb.custom.findNodesIncluding(Q,ha).reverse().find(function(Pa){return Pa.end!==ha});if(!Q)return ha;if("BlockStatement"===
Q.type){var Ha=Q.body.find(function(Pa){return Pa.start>ha});if(Ha)return Ha.start}return Q.end}},{key:"_backwardSexp",value:function(Q,ha){Q=this.parse(Q);Q=qb.custom.findNodesIncluding(Q,ha).reverse().find(function(Pa){return Pa.start!==ha});if(!Q)return ha;if("BlockStatement"===Q.type){var Ha=Q.body.slice().reverse().find(function(Pa){return Pa.end<ha});if(Ha)return Ha.end}return Q?Q.start:ha}},{key:"_backwardUpSexp",value:function(Q,ha){Q=this.parse(Q);return(Q=qb.custom.findNodesIncluding(Q,
ha).reverse().find(function(Ha){return Ha.start!==ha}))?Q.start:ha}},{key:"_forwardDownSexp",value:function(Q,ha){Q=this.parse(Q);return(Q=qb.custom.findNodeAfter(Q,ha,function(Ha,Pa){return Pa.start>ha}))?Q.node.start:ha}},{key:"markDefun",value:function(Q){var ha=this.rangeForFunctionOrDefinition(Q.textString,[Q.positionToIndex(Q.selection.range.start),Q.positionToIndex(Q.selection.range.end)]);ha&&Q.execCommand("expandRegion",{start:ha[0],end:ha[1]})}},{key:"rangeForNodesMatching",value:function(Q,
ha,Ha){Q=this.parse(Q);return(ha=qb.custom.findNodesIncluding(Q,ha).reverse().find(Ha))?[ha.start,ha.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(Q,ha){var Ha=ha[0]===ha[1];return this.rangeForNodesMatching(Q,ha[1],function(Pa){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(Pa.type)&&(Ha&&Pa.end!==ha[1]||!Ha&&Pa.start<ha[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(Q,ha){"number"!==typeof ha&&(ha=Q.positionToIndex(ha));
Q=this.ensureAST(Q);var Ha=qb.query.nodesAt(ha,Q).reverse(),Pa=Ha.find(function(ic){return"Identifier"===ic.type});if(!Pa&&((Ha=Ha[0])&&Ha.type.includes("Specifier")&&Ha.local&&"Identifier"===Ha.local.type&&(Pa=Ha.local),!Pa))return;ha=(Ha=qb.query.findDeclarationClosestToIndex(Q,Pa.name,ha))?qb.query.scopeAtIndex(Q,Ha.start):qb.query.scopeAtIndex(Q,ha);var bc=qb.query.findReferencesAndDeclsInScope(ha,Pa.name).refs;return{parsed:Q,scope:ha,id:Pa,name:Pa.name,decl:Ha,refs:bc}}},{key:"expandRegion",
value:function(Q,ha,Ha,Pa){function bc(Qd){Qd=Q.positionToIndex({column:0,row:Ra.row});return{range:[Qd+tc.start,Qd+tc.start+tc.value.length],prev:Pa}}var ic=Pa.range[0]!==Pa.range[1],Ra=Q.indexToPosition(Pa.range[0]),tc=Q.tokenAt(Ra);if(!ic&&tc&&["keyword","identifier"].includes(tc.type))return bc();Ha=Ha||this.parse(ha);ha=qb.query.nodesAtIndex(Ha,Pa.range[0]).reverse().find(function(Qd){return Qd.start<Pa.range[0]||Qd.end>Pa.range[1]});if(!ha)return Pa;Ha=ha.start;ic=ha.end;return"Literal"===ha.type&&
(ha.raw||"").match(/^['"`]/)&&Pa.range[0]!==ha.start&&Pa.range[1]!==ha.end&&(ha.start+1<Pa.range[0]||ha.end-1>Pa.range[1])?{range:[Ha+1,ic-1],prev:Pa}:{range:[Ha,ic],prev:Pa}}},{key:"contractRegion",value:function(Q,ha,Ha,Pa){return Pa.prev||Pa}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],ec,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6658})}(void 0);Yc=uc=qb.JavaScriptNavigator;qb.default=uc;var Hc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");Hc.addIndexToTextPos=function(Ic,ec,Pc){return Ic.indexToPosition(Ic.positionToIndex(ec)+Pc)};Hc.connect=bd;Hc.disconnect=Sd;Hc.string=ed;Hc.KeyHandler=Mc;Hc.Range=pd;uc=function(Ic){var ec=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),Pc=ec.hasOwnProperty("Snippet")&&"function"===
typeof ec.Snippet?ec.Snippet:ec.Snippet=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Pc,Ic,[{key:Symbol.for("lively-instance-initialize"),value:function(Q){Q=void 0===Q?{trigger:null,expansion:""}:Q;var ha=Q.expansion;this.trigger=Q.trigger;this.expansion=ha;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(Q){this.isExpanding&&(this.textMorph=Q,Hc.connect(this.textMorph,
"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(Q){this.isExpanding&&(Hc.disconnect(Q,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var Q=this.expansionState,ha=Q.startAnchor,Ha=Q.endAnchor;Q.isExpanding?Hc.Range.fromPositions(ha.position,Ha.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var Q=this.textMorph;if(Q){var ha=
this.expansionState||{},Ha=ha.marker,Pa=ha.startAnchor,bc=ha.endAnchor;ha=ha.steps;Pa&&Q.removeAnchor(Pa);bc&&Q.removeAnchor(bc);Ha&&Q.removeMarker(Ha);ha.forEach(function(ic){return Q.removeAnchor(ic.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};Q&&Q.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(Q){var ha=[],Ha=0;Hc.string.reMatches(Q,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(Pa){var bc=
Pa.start,ic=Pa.end;Pa=Pa.match;var Ra="";Pa.startsWith("${")?(Ra=$jscomp.makeIterator(Pa.match(/^\$\{([0-9]+):([^\}]*)\}/)),Ra.next(),Pa=Ra.next().value,Ra=Ra.next().value,Pa=Number(Pa)):Pa=Number(Pa.replace(/^\$/,""));Q=Q.slice(0,bc-Ha)+Ra+Q.slice(ic-Ha);ha[Pa]={index:bc-Ha,prefill:Ra,anchor:null};Ha+=ic-bc-Ra.length});return{steps:ha,expansion:Q}}},{key:"expandAtCursor",value:function(Q){var ha=Q.selection,Ha=Q.cursorPosition.column,Pa=this.expansion;this.trigger&&(Ha-=this.trigger.length);if(Ha=
Math.max(0,Ha))Pa=Hc.string.lines(Pa),Pa=[Pa[0]].concat($jscomp.arrayFromIterable(Pa.slice(1).map(function(md){return Hc.string.indent(md," ",Ha)}))),Pa=Pa.join("\n");var bc=this.createExpansionSteps(Pa);Pa=bc.expansion;bc=bc.steps;this.trigger&&ha.growLeft(this.trigger.length);ha.text=Pa;var ic=ha.start;Pa=ha.end;ha.collapseToEnd();if(bc.length){var Ra=Hc.string.newUUID();bc.forEach(function(md,$c){return md.anchor=Q.addAnchor(Object.assign({id:"snippet-step-"+$c+"-"+Ra},Hc.addIndexToTextPos(Q,ic,
md.index)))});var tc=Q.addAnchor(Object.assign({id:"snippet-start-"+Ra},ic,{insertBehavior:"stay"})),Qd=Q.addAnchor(Object.assign({id:"snippet-end-"+Ra},Pa));this.expansionState={marker:Q.addMarker({id:"snippet-marker-"+Ra,get range(){return{start:tc.position,end:Qd.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:tc,endAnchor:Qd,stepIndex:0,steps:bc,isExpanding:!0};
Q.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var Q=this.expansionState,ha=Q.steps,Ha=this.textMorph;if(Q.isExpanding&&Ha){Ha=Ha.selection;Q=ha[Q.stepIndex];var Pa=Q.prefill;Ha.lead=Ha.anchor=Q.anchor.position;Ha.growRight(Pa.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=ha.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(Q,ha){ha=Q.positionToIndex(Q.cursorPosition);
return Q.textString.slice(ha-this.trigger.length,ha)===this.trigger}},{key:"tryTrigger",value:function(Q,ha){if(!this.canExpand(Q,Q.cursorPosition))return!1;this.expandAtCursor(Q);return!0}},{key:"getCommands",value:function(Q){var ha=this;return Q.concat([{name:"[snippet] next expansion step",exec:function(Ha){ha.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(Ha){ha.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(Q){return Q.concat(Hc.KeyHandler.withBindings([{keys:"Tab",
command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],ec,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:356,end:5934})}(void 0);Hc.Snippet=uc;Hc.Snippet=uc;Hc.Snippet=
uc;var Ia=[{name:"get snippets",exec:function(Ic){return Ic.pluginCollect("getSnippets",[])}}];Hc.snippetCommands=Ia;Hc.snippetCommands=Ia;Hc.snippetCommands=Ia;var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");Va.buildEvalOpts=function(Ic,ec){return Ic.plugins.find(function(Pc){return Pc.isJSEditorPlugin}).sanatizedJsEnv(ec)};Va.Snippet=uc;Ia=function(Ic){var ec=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Pc=ec.hasOwnProperty("ModuleTopLevelVarCompleter")&&
"function"===typeof ec.ModuleTopLevelVarCompleter?ec.ModuleTopLevelVarCompleter:ec.ModuleTopLevelVarCompleter=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Pc,Ic,[{key:"compute",value:function(Q,ha){var Ha,Pa,bc,ic,Ra,tc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qd){if(1==Qd.nextAddress){Pa=(Ha=Q.pluginFind(function(md){return md.isJSEditorPlugin}))&&Ha.systemInterface();if(!Pa)return Qd.return([]);
bc=Va.buildEvalOpts(Q);ic=bc.targetModule;return"local"===Pa.name?(Ra=Object.getOwnPropertyNames(Pa.getModule(ic).recorder),Qd.jumpTo(2)):Qd.yield(Pa.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+ic+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',
{targetModule:"lively://module-recorder-completer"}),3)}if(2!=Qd.nextAddress){tc=Qd.yieldResult;if(tc.isError)return Qd.return([]);Ra=JSON.parse(tc.value)}Ra=Ra.filter(function(md){return!md.startsWith("defVar_")&&!["System","__currentLivelyModule","initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(md)});return Qd.return(Ra.map(function(md){return{priority:1100,completion:md}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],
ec,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:222,end:1678})}(void 0);Va.ModuleTopLevelVarCompleter=Ia;Va.ModuleTopLevelVarCompleter=Ia;Va.ModuleTopLevelVarCompleter=Ia;Ia=function(Ic){var ec=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Pc=ec.hasOwnProperty("DynamicJavaScriptCompleter")&&
"function"===typeof ec.DynamicJavaScriptCompleter?ec.DynamicJavaScriptCompleter:ec.DynamicJavaScriptCompleter=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Pc,Ic,[{key:"isValidPrefix",value:function(Q){return/\.[a-z0-9_]*$/i.test(Q)}},{key:"isMethodCallCompletion",value:function(Q){return Q.endsWith(")")&&0<Q.indexOf("(")}},{key:"isValidIdentifier",value:function(Q){if("string"!==typeof Q)return!1;this.isMethodCallCompletion(Q)&&
(Q=Q.slice(0,Q.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(Q)?!0:!1}},{key:"wrapInBrackets",value:function(Q){if(!isNaN(Number(Q))||Q.startsWith("Symbol."))return"["+Q+"]";var ha="";this.isMethodCallCompletion(Q)&&(ha=Q.slice(Q.indexOf("(")),Q=Q.slice(0,Q.indexOf("(")));return'["'+Q.replace(/"/g,'\\"')+'"]'+ha}},{key:"compute",value:function(Q){var ha=this,Ha,Pa,bc,ic,Ra,tc,Qd,md,$c,Wa,fd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){if(1==lb.nextAddress){Ha=Q.selection;
Ha.isEmpty()?(Pa=Q.getLine(Ha.lead.row),Pa=Pa.slice(Pa.lastIndexOf(":")+1,Ha.lead.column)):Pa=Ha.text.slice(Math.max(0,Ha.text.indexOf(":")),0);if(!ha.isValidPrefix(Pa))return lb.return([]);ic=(bc=Q.pluginFind(function(Hd){return Hd.isJSEditorPlugin}))&&bc.systemInterface();if(!ic)return lb.return([]);Ra=Va.buildEvalOpts(Q);return lb.yield(ic.dynamicCompletionsForPrefix(Ra.targetModule,Pa,Ra),2)}tc=lb.yieldResult;Qd=tc.isError;md=tc.value;$c=tc.completions;Wa=tc.prefix;if(Qd)return console.warn("javascript completer encountered error: "+
(md.stack||md)),lb.return([]);$c.reduce(function(Hd,db){db=$jscomp.makeIterator(db);db.next();db=db.next().value;return Hd+db.length},0);fd=$c.reduce(function(Hd,db,rb){db=$jscomp.makeIterator(db);var vb=db.next().value;db=db.next().value;return Hd.concat(db.map(function(vd){var me=ha.isValidIdentifier(vd);return{info:vb,completion:vd,prefix:me?Wa:"."+Wa,customInsertionFn:me?ha.isMethodCallCompletion(vd)?function(ye,Pe,Tc,re){Pe=re.start;re=re.end;ye=ye.replace(/\((.*)\)/,function(Ed){return"("+Ed.slice(1,
-1).split(", ").map(function(Nb,wa){return"${"+wa+":"+Nb+"}"}).join(", ")+")"});ye=new Va.Snippet({expansion:ye});Tc.replace({start:Pe,end:re},"");ye.expandAtCursor(Tc)}:null:function(ye,Pe,Tc,re){ye=re.start;re=re.end;Pe={row:ye.row,column:ye.column-1};re="."===Tc.textInRange({start:Pe,end:ye})?{start:Pe,end:re}:{start:ye,end:re};Tc.replace(re,ha.wrapInBrackets(vd))}}}))},[]);fd.forEach(function(Hd,db){return Object.assign(Hd,{priority:2E3+fd.length-db})});return lb.return(fd)})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DynamicJavaScriptCompleter"}}],ec,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1687,end:5122})}(void 0);Va.DynamicJavaScriptCompleter=Ia;Va.DynamicJavaScriptCompleter=Ia;Va.DynamicJavaScriptCompleter=Ia;Va.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
Ia=function(Ic){var ec=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Pc=ec.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof ec.JavaScriptKeywordCompleter?ec.JavaScriptKeywordCompleter:ec.JavaScriptKeywordCompleter=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Pc,Ic,[{key:"compute",value:function(Q,ha){return Va.keywords.map(function(Ha){return{completion:Ha,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],ec,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6125,end:6262})}(void 0);Va.JavaScriptKeywordCompleter=Ia;Va.JavaScriptKeywordCompleter=Ia;Va.JavaScriptKeywordCompleter=Ia;Ia=[new Va.DynamicJavaScriptCompleter,
new Va.JavaScriptKeywordCompleter,new Va.ModuleTopLevelVarCompleter];Va.completers=Ia;Va.completers=Ia;Va.completers=Ia;var tb=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");tb.Snippet=uc;var Jb=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];tb.snippets=Jb;tb.snippets=Jb;tb.snippets=Jb;var Ib=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");Ib.getEvalEnv=function(Ic){return(Ic=Ic.pluginFind(function(ec){return ec.isJSEditorPlugin}))?Ic.evalEnvironment:null};Ib.setEvalEnv=function(Ic,ec){(Ic=Ic.pluginFind(function(Pc){return Pc.isJSEditorPlugin}))&&Object.assign(Ic.evalEnvironment,ec);return Ic.evalEnvironment};
Ib.pToI=function(Ic,ec){return Ic.positionToIndex(ec)};Ib.iToP=function(Ic,ec){return Ic.indexToPosition(ec)};Ib.arr=Dd;Ib.promise=ke;Ib.string=ed;Ib.show=cb;Ib.Range=pd;Ib.query=Qb;Ib.BaseVisitor=Kd;tb=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(Ic,ec){ec=void 0===ec?{varName:null,position:null}:ec;var Pc,Q,ha,Ha,Pa,bc,ic,Ra,tc,Qd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(md){switch(md.nextAddress){case 1:Pc=
ec;Q=Pc.varName;ha=Pc.position;if(!Q){ha||(ha=Ic.cursorPosition);Ha=Ic.pluginInvokeFirst("getNavigator");Pa=Ha.ensureAST(Ic);bc=Ib.query.nodesAt(Ic.positionToIndex(ha),Pa).reverse().find(function($c){return"Identifier"===$c.type});if(!bc)return Ic.showError(Error("no identifier found!")),md.return(!0);Q=bc.name}ec=Ic.pluginFind(function($c){return $c.isJSEditorPlugin}).sanatizedJsEnv();ic='lively.modules.module("'+ec.targetModule+'").undefine("'+Q+'")';md.setCatchFinallyBlocks(2);return md.yield(Ic.doEval(null,
ec,ic),4);case 4:Ra=md.yieldResult;tc=Ra.error?Ra.error:Ra.isError?Ra.value:null;md.leaveTryBlock(3);break;case 2:tc=Qd=md.enterCatchBlock();case 3:return tc?Ic.showError(tc):Ic.setStatusMessage(Q+" undefined"),md.return(!0)}})}},{name:"change doitContext",exec:function(Ic){var ec,Pc,Q,ha,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){if(1==Pa.nextAddress)return ec=$jscomp,Pc=ec.makeIterator,Pa.yield(Ic.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(bc){return!bc.isUsedAsEpiMorph()}}),2);Q=Pc.call(ec,Pa.yieldResult);if(ha=Q.next().value)Ha="reset"===ha,Ic.doitContext=Ha?null:ha,Ic.setStatusMessage(Ha?"doitContext is now\n"+ha:"doitContext reset");return Pa.return(!0)})}},{name:"change eval backend",exec:function(Ic,ec){ec=void 0===ec?{backend:void 0}:ec;var Pc,Q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){if(1==ha.nextAddress)return Pc=ec,Q=Pc.backend,void 0!==Q?ha.jumpTo(2):
ha.yield(Ic.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=ha.nextAddress&&(Q=ha.yieldResult,!Q))return Ic.setStatusMessage("Canceled"),ha.return(!0);"local"===Q&&(Q=null);Ic.setStatusMessage("Eval backend is now "+(Q||"local"));return ha.return(Ib.setEvalEnv(Ic,{remote:Q}))})}},{name:"copy current module name to clipboard",exec:function(Ic){var ec=Ic.evalEnvironment.targetModule;Ic.setStatusMessage(ec?ec:"Cannot find module name");Ic.env.eventDispatcher.killRing.add(Ic);
Ic.env.eventDispatcher.doCopy(ec);return!0}}];Ib.jsEditorCommands=tb;Ib.jsEditorCommands=tb;Ib.jsEditorCommands=tb;var ib=[{name:"[javascript] list errors and warnings",exec:function(Ic){var ec,Pc,Q,ha,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pa){if(1==Pa.nextAddress){ec=(Ic.markers||[]).filter(function(bc){bc=bc.type;return"js-undeclared-var"===bc||"js-syntax-error"===bc});if(!ec.length)return Ib.show("no warnings or errors"),Pa.return(!0);Pc=ec.map(function(bc){var ic=bc.range;
return{isListItem:!0,string:"["+bc.type.split("-").slice(1).join(" ")+"] "+Ic.textInRange(ic),value:ic}});return Pa.yield(Ic.world().filterableListPrompt("jump to warning or error",Pc),2)}Q=Pa.yieldResult;ha=$jscomp.makeIterator(Q.selected);if(Ha=ha.next().value)Ic.saveMark(),Ic.selection=Ha,Ic.centerRow(Ha.start.row);return Pa.return(!0)})}},{name:"[javascript] inject import",exec:function(Ic,ec){ec=void 0===ec?{gotoImport:!1,insertImportAtCursor:!0}:ec;var Pc,Q,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){switch(Ha.nextAddress){case 1:return Ha.yield(Ib.promise.delay(0),
2);case 2:return Ha.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return Pc=Ha.yieldResult,Q=Pc.interactivelyInjectImportIntoText,Ha.yield(Q(Ic,ec),4);case 4:return(ha=Ha.yieldResult)||Ic.setStatusMessage("canceled"),Ha.return(ha)}})}},{name:"[javascript] fix undeclared variables",exec:function(Ic,ec){ec=void 0===ec?{ignore:[],autoApplyIfSingleChoice:!1,requester:Ic}:ec;var Pc,Q,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){if(1==Ha.nextAddress)return Ha.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=Ha.nextAddress)return Pc=Ha.yieldResult,Q=Pc.interactivlyFixUndeclaredVariables,Ha.yield(Q(Ic,ec),3);ha=Ha.yieldResult;Ic.focus();return Ha.return(ha)})}},{name:"[javascript] remove unused imports",exec:function(Ic,ec){ec=void 0===ec?{query:!0}:ec;var Pc,Q,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){if(1==Ha.nextAddress)return Ha.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=Ha.nextAddress)return Pc=Ha.yieldResult,Q=Pc.cleanupUnusedImports,Ha.yield(Q(Ic,
ec),3);ha=Ha.yieldResult;Ic.setStatusMessage(ha);return Ha.return(!0)})}},{name:"[javascript] eslint report",exec:function(Ic){var ec,Pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Q){if(1==Q.nextAddress)return Q.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);ec=Q.yieldResult;Pc=ec.default;try{return Q.return(Pc.reportOnMorph(Ic))}catch(ha){Ic.showError(ha)}Q.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(Ic){var ec,Pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Q){if(1==
Q.nextAddress)return Q.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);ec=Q.yieldResult;Pc=ec.default;try{return Q.return(Pc.previewFixesOnMorph(Ic))}catch(ha){Ic.showError(ha)}Q.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(Ic,ec,Pc){function Q(lb,Hd){Hd||(Hd=Ra(lb,{allowReturnOutsideFunction:!0}));var db=Ib.string.lineRanges(lb),rb=lb.split("\n"),vb=[],vd=new Ib.BaseVisitor,me=vd.visitVariableDeclaration;vd.visitVariableDeclaration=function(re,
Ed,Nb){if(1<re.declarations.length)for(var wa=Ib.string.findLineWithIndexInLineRanges(db,re.start),Ba=re.declarations[0].start-db[wa][0],Mb={},P=1;P<re.declarations.length;Mb={$jscomp$loop$prop$actionType$2260:Mb.$jscomp$loop$prop$actionType$2260,$jscomp$loop$prop$arg$2261:Mb.$jscomp$loop$prop$arg$2261},P++){var ya=re.declarations[P],Ua=Ib.string.findLineWithIndexInLineRanges(db,ya.start);if(wa!==Ua){var Eb=rb[Ua].match(/\s*/)[0].length;Eb=Ba-Eb;0!==Eb&&(ya=Ib.string.findLineWithIndexInLineRanges(db,
ya.end),Mb.$jscomp$loop$prop$actionType$2260=0<Eb?"insert":"delete",Mb.$jscomp$loop$prop$arg$2261=0<Eb?" ".repeat(Eb):-Eb,vb.push.apply(vb,$jscomp.arrayFromIterable(Ib.arr.range(Ua,ya).map(function(Cc){return function(cd){return[Cc.$jscomp$loop$prop$actionType$2260,db[cd][0],Cc.$jscomp$loop$prop$arg$2261]}}(Mb)))))}}return me.call(vd,re,Ed,Nb)};vd.accept(Hd,{},[]);for(Hd=vb.length;Hd--;){var ye=$jscomp.makeIterator(vb[Hd]),Pe=ye.next().value,Tc=ye.next().value;ye=ye.next().value;"insert"===Pe?lb=
lb.slice(0,Tc)+ye+lb.slice(Tc):"delete"===Pe&&(lb=lb.slice(0,Tc)+lb.slice(Tc+ye))}return lb}var ha,Ha,Pa,bc,ic,Ra,tc,Qd,md,$c,Wa,fd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){switch(lb.nextAddress){case 1:return ha=Pc?Pc:Math.floor(Ic.width/Ic.defaultCharExtent().width),ec=Object.assign({printWidth:ha,tabWidth:2,useTabs:!1,bracketSpacing:!1},ec),Ha=lively.modules.module,Pa=System.normalizeSync("prettier/standalone.js"),lb.yield(Ha(Pa).load({format:"global",instrument:!1}),2);
case 2:return bc=lb.yieldResult,lb.yield(Ha("lively.ast/lib/acorn-extension.js").load(),3);case 3:return lb.yield(Ha("lively.ast").load(),4);case 4:return ic=lb.yieldResult,Ra=ic.parse,lb.yield(Ha("lively.ast/lib/query.js").load(),5);case 5:return lb.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return tc=lb.yieldResult,Qd=Ic.selection.isEmpty()?Ic.documentRange:Ic.selection.range,md=Ic.positionToIndex(Qd.start),$c=Ic.positionToIndex(Qd.end),Wa=bc.format(Ic.textString,
Object.assign({},ec,{rangeStart:md,rangeEnd:$c,parser:function(Hd,db,rb){return Ra(Hd,{allowReturnOutsideFunction:!0})}})),Ic.undoManager.group(),fd=tc.diffChars(Ic.textString,Wa),Ic.applyJsDiffPatch(fd),Ic.selection.text=Q(Ic.selection.text),Ic.undoManager.group(),lb.return(!0)}})}}];Ib.jsIdeCommands=ib;Ib.jsIdeCommands=ib;Ib.jsIdeCommands=ib;var jb=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(Ic,ec){ec=Ic.pluginInvokeFirst("getNavigator");if(!ec)return!0;ec=ec.resolveIdentifierAt(Ic,
Ic.cursorPosition);if(!ec||!ec.id)return Ib.show("No symbol identifier selected"),!0;if(!ec.decl)return Ib.show("Cannot find declaration of "+ec.name),!0;Ic.saveMark();Ic.selection={start:Ic.indexToPosition(ec.decl.start),end:Ic.indexToPosition(ec.decl.end)};Ic.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(Ic){Ic.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(Ic){Ic.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(Ic,ec){ec=void 0===ec?{direction:null}:ec;var Pc=Ic.pluginInvokeFirst("getNavigator");if(!Pc)return!0;Pc=Pc.resolveIdentifierAt(Ic,
Ic.cursorPosition);if(!Pc||!Pc.refs)return Ib.show("No symbol identifier selected"),!0;var Q=Ic.selection;Pc=Pc.refs.map(function(Ha){var Pa=Ha.end;return Ib.Range.fromPositions(Ib.iToP(Ic,Ha.start),Ib.iToP(Ic,Pa))}).concat(Pc.decl?Ib.Range.fromPositions(Ib.iToP(Ic,Pc.decl.start),Ib.iToP(Ic,Pc.decl.end)):[]).sort(Ib.Range.compare);if(!Pc.length)return!0;var ha=Pc.map(String).indexOf(String(Q.range));if("next"===ec.direction||"prev"===ec.direction)-1===ha&&Pc.length?Pc=[Pc[0]]:(ec=ha+("next"===ec.direction?
1:-1),0>ec?ec=Pc.length-1:ec>=Pc.length&&(ec=0),Pc=[Pc[ec]]);Pc.forEach(function(Ha){var Pa=Q.selections.findIndex(function(ic){return ic.range.equals(Ha)}),bc=Q.selections.length-1;-1<Pa?Ib.arr.swap(Q.selections,Pa,bc):Q.addRange(Ha,!1)});Q.mergeSelections();return!0}}];Ib.astEditorCommands=jb;Ib.astEditorCommands=jb;Ib.astEditorCommands=jb;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var Fb=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
Fb.expressionAllowed=function(Ic,ec,Pc){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(ec.lastType)||"quasi"==ec.lastType&&/\{\s*$/.test(Ic.string.slice(0,Ic.pos-(Pc||0)))};Fb.passIndent=Ab;Fb.defineMode=Yb;Fb.defineMIME=gc;Fb.registerHelper=dd;Fb.defaultConfig={indentUnit:2};Fb.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};Fb.defineMode("javascript",
function(Ic,ec){function Pc(Tb,qd,te){Gj=Tb;dk=te;return qd}function Q(Tb,qd){var te=Tb.next();if('"'==te||"'"==te)return qd.tokenize=ha(te),qd.tokenize(Tb,qd);if("."==te&&Tb.match(/^\d+(?:[eE][+\-]?\d+)?/))return Pc("number","number");if("."==te&&Tb.match(".."))return Pc("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(te))return Pc(te);if("="==te&&Tb.eat(">"))return Pc("=>","operator");if("0"==te&&Tb.eat(/x/i))return Tb.eatWhile(/[\da-f]/i),Pc("number","number");if("0"==te&&Tb.eat(/o/i))return Tb.eatWhile(/[0-7]/i),
Pc("number","number");if("0"==te&&Tb.eat(/b/i))return Tb.eatWhile(/[01]/i),Pc("number","number");if(/\d/.test(te))return Tb.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),Pc("number","number");if("/"==te){if(Tb.eat("*"))return qd.tokenize=Ha,Ha(Tb,qd);if(Tb.eat("/"))return Tb.skipToEnd(),Pc("comment","comment");if(Fb.expressionAllowed(Tb,qd,1)){a:for(var lc=qd=!1;null!=(te=Tb.next());){if(!qd){if("/"==te&&!lc)break a;"["==te?lc=!0:lc&&"]"==te&&(lc=!1)}qd=!qd&&"\\"==te}Tb.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return Pc("regexp","string-2")}Tb.eatWhile(ok);return Pc("operator","operator",Tb.current())}if("`"==te)return qd.tokenize=Pa,Pa(Tb,qd);if("#"==te)return Tb.skipToEnd(),Pc("error","error");if(ok.test(te))return">"==te&&qd.lexical&&">"==qd.lexical.type||Tb.eatWhile(ok),Pc("operator","operator",Tb.current());if(Ql.test(te))return Tb.eatWhile(Ql),Tb=Tb.current(),(te=Tk.propertyIsEnumerable(Tb)&&Tk[Tb])&&"."!=qd.lastType?Pc(te.type,te.style,Tb):Pc("variable","variable",Tb)}function ha(Tb){return function(qd,
te){var lc=!1,zg;if(Sh&&"@"==qd.peek()&&qd.match(Rl))return te.tokenize=Q,Pc("jsonld-keyword","meta");for(;null!=(zg=qd.next())&&(zg!=Tb||lc);)lc=!lc&&"\\"==zg;lc||(te.tokenize=Q);return Pc("string","string")}}function Ha(Tb,qd){for(var te=!1,lc;lc=Tb.next();){if("/"==lc&&te){qd.tokenize=Q;break}te="*"==lc}return Pc("comment","comment")}function Pa(Tb,qd){for(var te=!1,lc;null!=(lc=Tb.next());){if(!te&&("`"==lc||"$"==lc&&Tb.eat("{"))){qd.tokenize=Q;break}te=!te&&"\\"==lc}return Pc("quasi","string-2",
Tb.current())}function bc(Tb,qd){qd.fatArrowAt&&(qd.fatArrowAt=null);var te=Tb.string.indexOf("=>",Tb.start);if(!(0>te)){if(Zj){var lc=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Tb.string.slice(Tb.start,te));lc&&(te=lc.index)}lc=0;var zg=!1;for(--te;0<=te;--te){var Vg=Tb.string.charAt(te),qj="([{}])".indexOf(Vg);if(0<=qj&&3>qj){if(!lc){++te;break}if(0==--lc){"("==Vg&&(zg=!0);break}}else if(3<=qj&&6>qj)++lc;else if(Ql.test(Vg))zg=!0;else{if(/["'\/]/.test(Vg))return;if(zg&&!lc){++te;break}}}zg&&
!lc&&(qd.fatArrowAt=te)}}function ic(Tb,qd,te,lc,zg,Vg){this.indented=Tb;this.column=qd;this.type=te;this.prev=zg;this.info=Vg;null!=lc&&(this.align=lc)}function Ra(){for(var Tb=arguments.length-1;0<=Tb;Tb--)Of.cc.push(arguments[Tb])}function tc(){Ra.apply(null,arguments);return!0}function Qd(Tb){function qd(lc){for(;lc;lc=lc.next)if(lc.name==Tb)return!0;return!1}var te=Of.state;Of.marked="def";te.context?qd(te.localVars)||(te.localVars={name:Tb,next:te.localVars}):!qd(te.globalVars)&&ec.globalVars&&
(te.globalVars={name:Tb,next:te.globalVars})}function md(){Of.state.context={prev:Of.state.context,vars:Of.state.localVars};Of.state.localVars=Vk}function $c(){Of.state.localVars=Of.state.context.vars;Of.state.context=Of.state.context.prev}function Wa(Tb,qd){var te=function(){var lc=Of.state,zg=lc.indented;if("stat"==lc.lexical.type)zg=lc.lexical.indented;else for(var Vg=lc.lexical;Vg&&")"==Vg.type&&Vg.align;Vg=Vg.prev)zg=Vg.indented;lc.lexical=new ic(zg,Of.stream.column(),Tb,null,lc.lexical,qd)};
te.lex=!0;return te}function fd(){var Tb=Of.state;Tb.lexical.prev&&(")"==Tb.lexical.type&&(Tb.indented=Tb.lexical.indented),Tb.lexical=Tb.lexical.prev)}function lb(Tb){function qd(te){return te==Tb?tc():";"==Tb?Ra():tc(qd)}return qd}function Hd(Tb,qd){return"var"==Tb?tc(Wa("vardef",qd.length),Oc,lb(";"),fd):"keyword a"==Tb?tc(Wa("form"),vb,Hd,fd):"keyword b"==Tb?tc(Wa("form"),Hd,fd):"{"==Tb?tc(Wa("}"),Ze,fd):";"==Tb?tc():"if"==Tb?("else"==Of.state.lexical.info&&Of.state.cc[Of.state.cc.length-1]==
fd&&Of.state.cc.pop()(),tc(Wa("form"),vb,Hd,fd,Ja)):"function"==Tb?tc(xb):"for"==Tb?tc(Wa("form"),ab,Hd,fd):"variable"==Tb?Zj&&"type"==qd?(Of.marked="keyword",tc(Be,lb("operator"),Be,lb(";"))):tc(Wa("stat"),ya):"switch"==Tb?tc(Wa("form"),vb,lb("{"),Wa("}","switch"),Ze,fd,fd):"case"==Tb?tc(db,lb(":")):"default"==Tb?tc(lb(":")):"catch"==Tb?tc(Wa("form"),md,lb("("),Dc,lb(")"),Hd,fd,$c):"class"==Tb?tc(Wa("form"),ud,fd):"export"==Tb?tc(Wa("stat"),Ye,fd):"import"==Tb?tc(Wa("stat"),vh,fd):"module"==Tb?tc(Wa("form"),
Af,lb("{"),Wa("}"),Ze,fd,fd):"async"==Tb?tc(Hd):"@"==qd?tc(db,Hd):Ra(Wa("stat"),db,lb(";"),fd)}function db(Tb){return vd(Tb,!1)}function rb(Tb){return vd(Tb,!0)}function vb(Tb){return"("!=Tb?Ra():tc(Wa(")"),db,lb(")"),fd)}function vd(Tb,qd){if(Of.state.fatArrowAt==Of.stream.start){var te=qd?wa:Nb;if("("==Tb)return tc(md,Wa(")"),ee(Af,")"),fd,lb("=>"),te,$c);if("variable"==Tb)return Ra(md,Af,lb("=>"),te,$c)}te=qd?Tc:Pe;return Ln.hasOwnProperty(Tb)?tc(te):"function"==Tb?tc(xb,te):"class"==Tb?tc(Wa("form"),
Fc,fd):"keyword c"==Tb||"async"==Tb?tc(qd?ye:me):"("==Tb?tc(Wa(")"),me,lb(")"),fd,te):"operator"==Tb||"spread"==Tb?tc(qd?rb:db):"["==Tb?tc(Wa("]"),xk,fd,te):"{"==Tb?Vd(Eb,"}",null,te):"quasi"==Tb?Ra(re,te):"new"==Tb?tc(Ba(qd)):tc()}function me(Tb){return Tb.match(/[;\}\)\],]/)?Ra():Ra(db)}function ye(Tb){return Tb.match(/[;\}\)\],]/)?Ra():Ra(rb)}function Pe(Tb,qd){return","==Tb?tc(db):Tc(Tb,qd,!1)}function Tc(Tb,qd,te){var lc=0==te?Pe:Tc,zg=0==te?db:rb;if("=>"==Tb)return tc(md,te?wa:Nb,$c);if("operator"==
Tb)return/\+\+|--/.test(qd)?tc(lc):"?"==qd?tc(db,lb(":"),zg):tc(zg);if("quasi"==Tb)return Ra(re,lc);if(";"!=Tb){if("("==Tb)return Vd(rb,")","call",lc);if("."==Tb)return tc(Ua,lc);if("["==Tb)return tc(Wa("]"),me,lb("]"),fd,lc)}}function re(Tb,qd){return"quasi"!=Tb?Ra():"${"!=qd.slice(qd.length-2)?tc(re):tc(db,Ed)}function Ed(Tb){if("}"==Tb)return Of.marked="string-2",Of.state.tokenize=Pa,tc(re)}function Nb(Tb){bc(Of.stream,Of.state);return Ra("{"==Tb?Hd:db)}function wa(Tb){bc(Of.stream,Of.state);return Ra("{"==
Tb?Hd:rb)}function Ba(Tb){return function(qd){return"."==qd?tc(Tb?P:Mb):Ra(Tb?rb:db)}}function Mb(Tb,qd){if("target"==qd)return Of.marked="keyword",tc(Pe)}function P(Tb,qd){if("target"==qd)return Of.marked="keyword",tc(Tc)}function ya(Tb){return":"==Tb?tc(fd,Hd):Ra(Pe,lb(";"),fd)}function Ua(Tb){if("variable"==Tb)return Of.marked="property",tc()}function Eb(Tb,qd){if("async"==Tb)return Of.marked="property",tc(Eb);if("variable"==Tb||"keyword"==Of.style)return Of.marked="property","get"==qd||"set"==
qd?tc(Cc):tc(cd);if("number"==Tb||"string"==Tb)return Of.marked=Sh?"property":Of.style+" property",tc(cd);if("jsonld-keyword"==Tb)return tc(cd);if("modifier"==Tb)return tc(Eb);if("["==Tb)return tc(db,lb("]"),cd);if("spread"==Tb)return tc(db);if(":"==Tb)return Ra(cd)}function Cc(Tb){if("variable"!=Tb)return Ra(cd);Of.marked="property";return tc(xb)}function cd(Tb){if(":"==Tb)return tc(rb);if("("==Tb)return Ra(xb)}function ee(Tb,qd,te){function lc(zg,Vg){return(te?-1<te.indexOf(zg):","==zg)?(zg=Of.state.lexical,
"call"==zg.info&&(zg.pos=(zg.pos||0)+1),tc(function(qj,Jn){return qj==qd||Jn==qd?Ra():Ra(Tb)},lc)):zg==qd||Vg==qd?tc():tc(lb(qd))}return function(zg,Vg){return zg==qd||Vg==qd?tc():Ra(Tb,lc)}}function Vd(Tb,qd,te){for(var lc=3;lc<arguments.length;lc++)Of.cc.push(arguments[lc]);return tc(Wa(qd,te),ee(Tb,qd),fd)}function Ze(Tb){return"}"==Tb?tc():Ra(Hd,Ze)}function Wd(Tb,qd){if(Zj){if(":"==Tb)return tc(Be);if("?"==qd)return tc(Wd)}}function Be(Tb){if("variable"==Tb)return Of.marked="variable-3",tc(Ef);
if("string"==Tb||"number"==Tb||"atom"==Tb)return tc(Ef);if("{"==Tb)return tc(Wa("}"),ee(rf,"}",",;"),fd);if("("==Tb)return tc(ee(cg,")"),Qe)}function Qe(Tb){if("=>"==Tb)return tc(Be)}function rf(Tb,qd){if("variable"==Tb||"keyword"==Of.style)return Of.marked="property",tc(rf);if("?"==qd)return tc(rf);if(":"==Tb)return tc(Be)}function cg(Tb){if("variable"==Tb)return tc(cg);if(":"==Tb)return tc(Be)}function Ef(Tb,qd){if("<"==qd)return tc(Wa(">"),ee(Be,">"),fd,Ef);if("|"==qd||"."==Tb)return tc(Be);if("["==
Tb)return tc(lb("]"),Ef);if("extends"==qd)return tc(Be)}function Oc(){return Ra(Af,Wd,sg,ff)}function Af(Tb,qd){if("modifier"==Tb)return tc(Af);if("variable"==Tb)return Qd(qd),tc();if("spread"==Tb)return tc(Af);if("["==Tb)return Vd(Af,"]");if("{"==Tb)return Vd(qg,"}")}function qg(Tb,qd){if("variable"==Tb&&!Of.stream.match(/^\s*:/,!1))return Qd(qd),tc(sg);"variable"==Tb&&(Of.marked="property");return"spread"==Tb?tc(Af):"}"==Tb?Ra():tc(lb(":"),Af,sg)}function sg(Tb,qd){if("="==qd)return tc(rb)}function ff(Tb){if(","==
Tb)return tc(Oc)}function Ja(Tb,qd){if("keyword b"==Tb&&"else"==qd)return tc(Wa("form","else"),Hd,fd)}function ab(Tb){if("("==Tb)return tc(Wa(")"),Cb,lb(")"),fd)}function Cb(Tb){return"var"==Tb?tc(Oc,lb(";"),Ka):";"==Tb?tc(Ka):"variable"==Tb?tc(ba):Ra(db,lb(";"),Ka)}function ba(Tb,qd){return"in"==qd||"of"==qd?(Of.marked="keyword",tc(db)):tc(Pe,Ka)}function Ka(Tb,qd){return";"==Tb?tc(nb):"in"==qd||"of"==qd?(Of.marked="keyword",tc(db)):Ra(db,lb(";"),nb)}function nb(Tb){")"!=Tb&&tc(db)}function xb(Tb,
qd){if("*"==qd)return Of.marked="keyword",tc(xb);if("variable"==Tb)return Qd(qd),tc(xb);if("("==Tb)return tc(md,Wa(")"),ee(Dc,")"),fd,Wd,Hd,$c);if(Zj&&"<"==qd)return tc(Wa(">"),ee(Be,">"),fd,xb)}function Dc(Tb){return"spread"==Tb?tc(Dc):Ra(Af,Wd,sg)}function Fc(Tb,qd){return"variable"==Tb?ud(Tb,qd):td(Tb,qd)}function ud(Tb,qd){if("variable"==Tb)return Qd(qd),tc(td)}function td(Tb,qd){if("<"==qd)return tc(Wa(">"),ee(Be,">"),fd,td);if("extends"==qd||"implements"==qd||Zj&&","==Tb)return tc(Zj?Be:db,
td);if("{"==Tb)return tc(Wa("}"),rd,fd)}function rd(Tb,qd){if("variable"==Tb||"keyword"==Of.style){if(("async"==qd||"static"==qd||"get"==qd||"set"==qd||Zj&&("public"==qd||"private"==qd||"protected"==qd||"readonly"==qd||"abstract"==qd))&&Of.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Of.marked="keyword",tc(rd);Of.marked="property";return tc(Zj?zf:xb,rd)}if("["==Tb)return tc(db,lb("]"),Zj?zf:xb,rd);if("*"==qd)return Of.marked="keyword",tc(rd);if(";"==Tb)return tc(rd);if("}"==Tb)return tc();if("@"==
qd)return tc(db,rd)}function zf(Tb,qd){return"?"==qd?tc(zf):":"==Tb?tc(Be,sg):"="==qd?tc(rb):Ra(xb)}function Ye(Tb,qd){return"*"==qd?(Of.marked="keyword",tc(Gh,lb(";"))):"default"==qd?(Of.marked="keyword",tc(db,lb(";"))):"{"==Tb?tc(ee(Zf,"}"),Gh,lb(";")):Ra(Hd)}function Zf(Tb,qd){if("as"==qd)return Of.marked="keyword",tc(lb("variable"));if("variable"==Tb)return Ra(rb,Zf)}function vh(Tb){return"string"==Tb?tc():Ra(Hi,Nh,Gh)}function Hi(Tb,qd){if("{"==Tb)return Vd(Hi,"}");"variable"==Tb&&Qd(qd);"*"==
qd&&(Of.marked="keyword");return tc(pj)}function Nh(Tb){if(","==Tb)return tc(Hi,Nh)}function pj(Tb,qd){if("as"==qd)return Of.marked="keyword",tc(Hi)}function Gh(Tb,qd){if("from"==qd)return Of.marked="keyword",tc(db)}function xk(Tb){return"]"==Tb?tc():Ra(ee(rb,"]"))}Ic=Object.assign({},Fb.defaultConfig,{},Ic);ec=Object.assign({},Fb.defaultParserConfig,{},ec);var Ng=Ic.indentUnit,fk=ec.statementIndent,Sh=ec.jsonld,Oj=ec.json||Sh,Zj=ec.typescript,Ql=ec.wordCharacters||/[\w$\xa1-\uffff]/,Tk=function(){function Tb(Jn){return{type:Jn,
style:"keyword"}}var qd=Tb("keyword a"),te=Tb("keyword b"),lc=Tb("keyword c"),zg=Tb("operator"),Vg={type:"atom",style:"atom"};qd={"if":Tb("if"),"while":qd,"with":qd,"else":te,"do":te,"try":te,"finally":te,"return":lc,"break":lc,"continue":lc,"new":Tb("new"),"delete":lc,"throw":lc,"debugger":lc,"var":Tb("var"),"const":Tb("var"),let:Tb("var"),"function":Tb("function"),"catch":Tb("catch"),"for":Tb("for"),"switch":Tb("switch"),"case":Tb("case"),"default":Tb("default"),"in":zg,"typeof":zg,"instanceof":zg,
"true":Vg,"false":Vg,"null":Vg,undefined:Vg,NaN:Vg,Infinity:Vg,"this":Tb("this"),"class":Tb("class"),"super":Tb("atom"),yield:lc,"export":Tb("export"),"import":Tb("import"),"extends":lc,await:lc,async:Tb("async")};if(Zj){te={type:"variable",style:"variable-3"};lc={"interface":Tb("class"),"implements":lc,namespace:lc,module:Tb("module"),"enum":Tb("module"),"public":Tb("modifier"),"private":Tb("modifier"),"protected":Tb("modifier"),"abstract":Tb("modifier"),as:zg,string:te,number:te,"boolean":te,any:te};
for(var qj in lc)qd[qj]=lc[qj]}return qd}(),ok=/[+\-*&%=<>!?|~^@]/,Rl=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,Gj,dk,Ln={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0,"jsonld-keyword":!0},Of={state:null,column:null,marked:null,cc:null},Vk={name:"this",next:{name:"arguments"}};fd.lex=!0;return{startState:function(Tb){Tb={tokenize:Q,lastType:"sof",cc:[],lexical:new ic((Tb||0)-Ng,0,"block",!1),localVars:ec.localVars,context:ec.localVars&&{vars:ec.localVars},
indented:Tb||0};ec.globalVars&&"object"==typeof ec.globalVars&&(Tb.globalVars=ec.globalVars);return Tb},token:function(Tb,qd){Tb.sol()&&(qd.lexical.hasOwnProperty("align")||(qd.lexical.align=!1),qd.indented=Tb.indentation(),bc(Tb,qd));if(qd.tokenize!=Ha&&Tb.eatSpace())return null;var te=qd.tokenize(Tb,qd);if("comment"==Gj)return te;qd.lastType="operator"!=Gj||"++"!=dk&&"--"!=dk?Gj:"incdec";a:{var lc=Gj,zg=dk,Vg=qd.cc;Of.state=qd;Of.stream=Tb;Of.marked=null;Of.cc=Vg;Of.style=te;qd.lexical.hasOwnProperty("align")||
(qd.lexical.align=!0);for(Tb=0;;){if(1E5<Tb++)throw Error("endless");if((Vg.length?Vg.pop():Oj?db:Hd)(lc,zg)){for(;Vg.length&&Vg[Vg.length-1].lex;)Vg.pop()();if(Of.marked){te=Of.marked;break a}if(lc="variable"==lc)b:{for(lc=qd.localVars;lc;lc=lc.next)if(lc.name==zg){lc=!0;break b}for(qd=qd.context;qd;qd=qd.prev)for(lc=qd.vars;lc;lc=lc.next)if(lc.name==zg){lc=!0;break b}lc=void 0}if(lc){te="variable-2";break a}break a}}}return te},indent:function(Tb,qd){if(Tb.tokenize==Ha)return Fb.passIndent;if(Tb.tokenize!=
Q)return 0;var te=qd&&qd.charAt(0),lc=Tb.lexical,zg;if(!/^\s*else\b/.test(qd))for(var Vg=Tb.cc.length-1;0<=Vg;--Vg){var qj=Tb.cc[Vg];if(qj==fd)lc=lc.prev;else if(qj!=Ja)break}for(;!("stat"!=lc.type&&"form"!=lc.type||"}"!=te&&(!(zg=Tb.cc[Tb.cc.length-1])||zg!=Pe&&zg!=Tc||/^[,\.=+\-*:?[\(]/.test(qd)));)lc=lc.prev;fk&&")"==lc.type&&"stat"==lc.prev.type&&(lc=lc.prev);zg=lc.type;Vg=te==zg;return(qj=Tb._string)&&qj.trimLeft().startsWith("?")&&":"===te?qj.indexOf("?"):qj&&":"===Tb.lastType&&"}"!==lc.type?
qj.match(/^\s*/)[0].length:"vardef"==zg?(qd=lc.indented+lc.info+2+Tb.localVars.name.length,"?"===te||":"===te||"|"===te||"&"===te?qd:","==Tb.lastType?lc.indented+lc.info+1:"operator"==Tb.lastType?qd+3:lc.indented):"form"==zg&&"{"==te?lc.indented:"form"==zg?lc.indented+Ng:"stat"==zg?(te=lc.indented,Tb="operator"==Tb.lastType||","==Tb.lastType||ok.test(qd.charAt(0))||/[,.]/.test(qd.charAt(0)),te+(Tb?fk||Ng:0)):"switch"!=lc.info||Vg||0==ec.doubleIndentSwitch?lc.align?lc.column+(Vg?0:1):lc.indented+(Vg?
0:Ng):lc.indented+(/^(?:case|default)\b/.test(qd)?Ng:2*Ng)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:Oj?null:"/*",blockCommentEnd:Oj?null:"*/",lineComment:Oj?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:Oj?"json":"javascript",jsonldMode:Sh,jsonMode:Oj,expressionAllowed:Fb.expressionAllowed,skipExpression:function(Tb){var qd=Tb.cc[Tb.cc.length-1];qd!=db&&qd!=rb||Tb.cc.pop()}}});Fb.registerHelper("wordChars","javascript",/[\w$]/);Fb.defineMIME("text/javascript",
"javascript");Fb.defineMIME("text/ecmascript","javascript");Fb.defineMIME("application/javascript","javascript");Fb.defineMIME("application/x-javascript","javascript");Fb.defineMIME("application/ecmascript","javascript");Fb.defineMIME("application/json",{name:"javascript",json:!0});Fb.defineMIME("application/x-json",{name:"javascript",json:!0});Fb.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});Fb.defineMIME("text/typescript",{name:"javascript",typescript:!0});Fb.defineMIME("application/typescript",
{name:"javascript",typescript:!0});var rc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");rc.string=ed;rc.JavaScriptChecker=Xb;rc.JavaScriptNavigator=Yc;rc.completers=Ia;rc.jsSnippets=Jb;rc.jsIdeCommands=ib;rc.jsEditorCommands=tb;rc.astEditorCommands=jb;rc.CodeMirrorEnabledEditorPlugin=Zd;rc.Snippet=uc;rc.parser=jd;rc.localInterface=Wb;rc.systemInterfaceNamed=oc;rc.serverInterfaceFor=Lb;rc.l2lInterfaceFor=Bc;Xb=function(Ic){var ec=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),
Pc=ec.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof ec.JavaScriptEditorPlugin?ec.JavaScriptEditorPlugin:ec.JavaScriptEditorPlugin=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Pc,Ic,[{key:Symbol.for("lively-instance-initialize"),value:function(){Bb._get(Object.getPrototypeOf(Pc.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new rc.JavaScriptChecker;this.evalEnvironment=
{format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(Q){Bb._get(Object.getPrototypeOf(Pc.prototype),"attach",this).call(this,Q);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:Q})}},{key:"detach",value:function(Q){this.checker.uninstall(this.textMorph);Bb._get(Object.getPrototypeOf(Pc.prototype),"detach",this).call(this,
Q)}},{key:"getNavigator",value:function(){return new rc.JavaScriptNavigator}},{key:"getCompleters",value:function(Q){return rc.completers.concat(Q)}},{key:"getCommands",value:function(Q){return[].concat($jscomp.arrayFromIterable(Bb._get(Object.getPrototypeOf(Pc.prototype),"getCommands",this).call(this,Q)),$jscomp.arrayFromIterable(rc.jsIdeCommands),$jscomp.arrayFromIterable(rc.jsEditorCommands),$jscomp.arrayFromIterable(rc.astEditorCommands))}},{key:"getKeyBindings",value:function(Q){return[].concat($jscomp.arrayFromIterable(Q),
[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},
command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},{key:"getMenuItems",value:function(Q){var ha=this,Ha,Pa,bc,ic,Ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tc){Ha=ha.textMorph;Pa=[{command:"doit",target:Ha,showKeyShortcuts:!0},{command:"inspectit",target:Ha,showKeyShortcuts:!0},{command:"printit",target:Ha,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",
target:Ha,showKeyShortcuts:!0},{command:"eval all",target:Ha,showKeyShortcuts:!0},{command:"text completion",alias:"code completion",target:Ha,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:Ha,showKeyShortcuts:!0},{isDivider:!0}];ha.evalEnvironment.targetModule&&Pa.push({command:"[javascript] inject import",alias:"add import",target:Ha},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:Ha},{command:"[javascript] remove unused imports",
alias:"remove unused imports",target:Ha});bc=ha.getNavigator();(ic=bc.resolveIdentifierAt(Ha,Ha.cursorPosition))&&Pa.push({command:"selectDefinition",alias:'jump to definition of "'+ic.name+'"',target:Ha},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+ic.name+'"',target:Ha});(Ra=Ha.selection.text.trim())&&Pa.push({command:"open code search",alias:'code search for "'+rc.string.truncate(Ra,30)+'"',target:Ha.world(),args:{input:Ra,backend:ha.backend()}});Pa.push({isDivider:!0});
return tc.return(Pa.concat(Q))})}},{key:"getSnippets",value:function(){return rc.jsSnippets.map(function(Q){var ha=$jscomp.makeIterator(Q);Q=ha.next().value;ha=ha.next().value;return new rc.Snippet({trigger:Q,expansion:ha})})}},{key:"sanatizedJsEnv",value:function(Q){Q=Object.assign({},this.evalEnvironment,{},Q);Q.format||(Q.formatd="esm");Q.context||(Q.context=this.textMorph);Q.sourceURL||(Q.sourceURL=Q.targetModule+"_doit_"+Date.now());Q.systemInterface||(Q.systemInterface=rc.localInterface);return Q}},
{key:"backend",value:function(Q){Q=this.sanatizedJsEnv(Q);return Q.remote?Q.remote:"local"}},{key:"systemInterface",value:function(Q){return this.sanatizedJsEnv(Q).systemInterface||rc.localInterface}},{key:"setSystemInterface",value:function(Q){return this.evalEnvironment.systemInterface=Q}},{key:"setSystemInterfaceNamed",value:function(Q){return this.setSystemInterface(rc.systemInterfaceNamed(Q))}},{key:"runEval",value:function(Q,ha){ha=this.sanatizedJsEnv(ha);return this.systemInterface(ha).runEval(Q,
ha)}},{key:"parser",get:function(){return rc.parser}},{key:"parse",value:function(Q){Q=void 0===Q?null:Q;if(this._ast&&this._ast._astType===Q)return this._ast;var ha=this.parser,Ha=this.textMorph.textString;if(!ha)return null;var Pa={withComments:!0,allowReturnOutsideFunction:!0};Q&&(Pa.type=Q);if(Ha.startsWith("#!")){var bc=Ha.indexOf("\n");Ha=" ".repeat(bc)+Ha.slice(bc)}ha=ha.fuzzyParse(Ha,Pa);ha._astType=Q;return this._ast=ha}},{key:"undeclaredVariables",value:function(Q){var ha=this.parser,Ha=
this.evalEnvironment.knownGlobals||[];Q=this.parse(void 0===Q?null:Q);return ha&&Q?ha.query.findGlobalVarRefs(Q,{jslintGlobalComment:!0}).filter(function(Pa){return!Ha.includes(Pa.name)}):[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],ec,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:662,end:6694})}(rc.CodeMirrorEnabledEditorPlugin);Xb=rc.JavaScriptEditorPlugin;Da("default",Xb);rc.default=Xb}}});System.register("10",[],function(){return{execute:function(){lively.FreezerRuntime.recorderFor("lively.shell/index.js")}}});
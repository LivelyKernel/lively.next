System.register(["./__root_module__-db735625.js"],function(db){var Zb,lc,Uc,Bc,Vd,Od,je,Bd,jd,zd,ge,We,kf,bf,Hd,Ae;return{setters:[function(uc){Zb=uc.c;lc=uc.P;Uc=uc.b;Bc=uc.x;Vd=uc.y;Od=uc.z;je=uc.A;Bd=uc.r;jd=uc.D;zd=uc.E;ge=uc.F;We=uc.G;kf=uc.H;bf=uc.J;Hd=uc.K;Ae=uc.N}],execute:function(){function uc(rc,bd,he,cd){cd=void 0===cd?{}:cd;cd=cd.package||Gd.ObjectPackage.lookupModuleForClass(rc.constructor,cd);if(!cd)throw Error("Object is not part of an object package: "+rc);return cd.addScript(rc,
bd,he)}function wd(rc,bd){bd=Gd.normalizeOptions(bd).System;rc=(rc=rc[Symbol.for("lively-module-meta")])?rc.package.name:null;return(bd=(rc?Gd.lookupPackage(bd,rc):{}).pkg)?!!Gd.ObjectPackage.forSystemPackage(bd):!1}function ce(rc,bd){var he,cd,ie,ac,Db,Tc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){return 1==Nc.nextAddress?(he=rc.constructor,Gd.withSuperclasses(he),Symbol.for("lively-module-meta"),ie=cd=Gd.ObjectPackage.lookupPackageForObject(rc),ac=ie.baseURL,Db=ie.System,Nc.yield(cd.fork(bd,
{baseURL:ac,System:Db}),2)):3!=Nc.nextAddress?(Tc=Nc.yieldResult,Nc.yield(Gd.adoptObject(rc,Tc.objectClass),3)):Nc.return(Tc.objectClass[Symbol.for("__LivelyClassName__")])})}db({addScript:uc,interactivelyForkPackage:ce,isObjectClass:wd});var Gd=lively.FreezerRuntime.recorderFor("lively.classes/object-classes.js");Gd.normalizeOptions=function(rc){rc=Object.assign({baseURL:Gd.defaultBaseURL,System:System},rc);rc.baseURL=rc.baseURL.replace(/\/$/,"");return rc};Gd.addScript=uc;Gd.isObjectClass=wd;Gd.interactivelyForkPackage=
ce;Gd.string=Zb;Gd.Path=lc;Gd.arr=Uc;Gd.parse=Bc;Gd.isValidIdentifier=Vd;Gd.stringify=Od;Gd.parseFunction=je;Gd.resource=Bd;Gd.runEval=jd;Gd.scripting=zd;Gd.ExportLookup=ge;var pe=Gd.scripting;Gd.ensurePackage=pe.ensurePackage;Gd.registerPackage=pe.registerPackage;Gd.importPackage=pe.importPackage;Gd.lookupPackage=pe.lookupPackage;Gd.module=pe.module;Gd.ImportInjector=pe.ImportInjector;Gd.RuntimeSourceDescriptor=We;Gd.toJsIdentifier=kf;Gd.withSuperclasses=bf;Gd.adoptObject=Hd;Gd.classToFunctionTransform=
Ae;Gd.objectPackageSym=Symbol.for("lively-object-package-data");Gd.defaultBaseURL="local://lively-object-modules";Gd.globalClasses=Object.keys(System.global).map(function(rc){rc=System.global[rc];return"function"===typeof rc&&rc.name&&rc}).filter(Boolean);Gd.addScript=uc;Gd.addScript=uc;Gd.isObjectClass=wd;Gd.isObjectClass=wd;Gd._packageStore=Gd._packageStore||{};Gd.interactivelyForkPackage=ce;Gd.interactivelyForkPackage=ce;pe=function(rc,bd){this._id=rc;this.options=Gd.normalizeOptions(bd)};pe.lookupPackageForObject=
function(rc,bd){return this.lookupPackageForClass(rc.constructor,bd)};pe.lookupPackageForClass=function(rc,bd){bd=Gd.normalizeOptions(bd).System;rc=(rc=rc[Symbol.for("lively-module-meta")])?rc.package.name:null;return(bd=(rc?Gd.lookupPackage(bd,rc):{}).pkg)?Gd.ObjectPackage.forSystemPackage(bd):null};pe.lookupModuleForClass=function(rc,bd){Gd.normalizeOptions(bd);bd=this.lookupPackageForClass(rc,bd);rc=rc[Symbol.for("lively-module-meta")];return new Gd.ObjectModule(rc.pathInPackage,bd)};pe.forSystemPackage=
function(rc){return this.packageStore[rc.name]};pe.withId=function(rc,bd){return this.packageStore[rc]||(this.packageStore[rc]=new this(rc,bd))};pe.prototype.ensureSubModule=function(rc){rc=void 0===rc?"index":rc;var bd=this,he;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cd){return 1==cd.nextAddress?(he=new Gd.ObjectModule(rc,bd),cd.yield(he.ensureExistance(),2)):cd.return(he)})};pe.prototype.resource=function(rc){rc=void 0===rc?"":rc;return Gd.resource(this.packageURL).join(rc)};
pe.prototype.load=function(){return Gd.importPackage(this.System,this.packageURL)};pe.prototype.ensureExistance=function(){var rc=this,bd,he,cd,ie,ac,Db,Tc,Nc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){switch(wc.nextAddress){case 1:return bd=rc.resource("/"),wc.yield(bd.exists(),2);case 2:if(wc.yieldResult)return wc.return();he=[{resource:bd}];cd=[{resource:rc.resource("package.json"),content:JSON.stringify(rc.config,null,2)}];return wc.yield(Promise.all(he.map(function(Vc){return Vc.resource.mkdir()})),
3);case 3:return wc.yield(Promise.all(cd.map(function(Vc){var hb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zc){switch(zc.nextAddress){case 1:return zc.yield(Vc.resource.exists(),2);case 2:if(!(hb=!zc.yieldResult)){zc.jumpTo(3);break}return zc.yield(Vc.resource.write(Vc.content),4);case 4:hb=zc.yieldResult;case 3:return zc.return(hb)}})})),4);case 4:return wc.yield(rc.objectModule.ensureExistance(),5);case 5:return ie=rc,ac=ie.System,Db=ie.packageURL,Tc=ie.config,wc.yield(Gd.ensurePackage(ac,
Db),6);case 6:return Nc=wc.yieldResult,Nc.registerWithConfig(Tc),console.log(rc.packageURL+" REGISTERED"),wc.return(rc)}})};pe.prototype.ensureObjectClass=function(rc){var bd=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(he){return 1==he.nextAddress?he.yield(bd.ensureExistance(),2):he.return(bd.objectModule.ensureObjectClass(rc))})};pe.prototype.adoptObject=function(rc){var bd=this,he;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cd){if(1==cd.nextAddress)return bd.objectClass===
rc.constructor?cd.return():cd.yield(bd.ensureObjectClass(rc.constructor),2);he=cd.yieldResult;Gd.adoptObject(rc,he);cd.jumpToEnd()})};pe.prototype.addScript=function(rc,bd,he){return this.objectModule.addScript(rc,bd,he)};pe.prototype.remove=function(){this.systemPackage.remove();delete Gd.ObjectPackage.packageStore[this.id];return this.resource().remove()};pe.prototype.renameObjectClass=function(rc,bd){bd=void 0===bd?[]:bd;var he=this,cd,ie,ac,Db,Tc,Nc,wc,Vc,hb,zc,Ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jc){if(1==
Jc.nextAddress){cd=he;ie=cd.objectClass;ac=cd.System;if(!ie||ie[Symbol.for("__LivelyClassName__")]===rc)return Jc.return(ie);if(!Gd.isValidIdentifier(rc))throw Error(rc+" is not a valid name for a class");Tc=Db=Gd.RuntimeSourceDescriptor.for(ie,ac);Nc=Tc.source;wc=Tc.ast;Vc=wc.id;hb=Vc.start;zc=Vc.end;return Jc.yield(Db.changeSource(Nc.slice(0,hb)+rc+Nc.slice(zc)),2)}Ub=he.objectClass;bd.forEach(function(Wc){Wc.constructor=Ub;Wc.__proto__=Ub.prototype});return Jc.return(Ub)})};pe.prototype.fork=function(rc,
bd){var he=this,cd,ie,ac,Db,Tc,Nc,wc,Vc,hb,zc,Ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jc){switch(Jc.nextAddress){case 1:return cd=he,ie=cd.System,ac=cd.baseURL,Db=cd.objectClass,bd=Object.assign({System:ie,baseURL:ac},bd),Tc=Gd.RuntimeSourceDescriptor.for(Db),Nc=Tc._renamedSource(rc),wc=Nc.moduleSource,Vc=Gd.ObjectPackage.withId(rc,bd),Jc.yield(Vc.ensureExistance(),2);case 2:return hb=Vc,zc=hb.objectModule,Ub=zc.systemModule,Jc.yield(Ub.load({format:"esm"}),3);case 3:return Jc.yield(Ub.changeSource(wc),
4);case 4:return Jc.return(Vc)}})};$jscomp.global.Object.defineProperties(pe.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},name:{configurable:!0,enumerable:!0,get:function(){return this.id}},System:{configurable:!0,enumerable:!0,get:function(){return this.options.System}},baseURL:{configurable:!0,enumerable:!0,get:function(){return this.options.baseURL}},packageURL:{configurable:!0,enumerable:!0,get:function(){return this.baseURL+("/"+this.id)}},config:{configurable:!0,
enumerable:!0,get:function(){return{name:this.name,version:"0.1.0",lively:{isObjectPackage:!0}}}},systemPackage:{configurable:!0,enumerable:!0,get:function(){return Gd.lookupPackage(this.System,this.packageURL,!0).pkg}},objectModule:{configurable:!0,enumerable:!0,get:function(){return this._objectModule||(this._objectModule=new Gd.ObjectModule("index.js",this))}},objectClass:{configurable:!0,enumerable:!0,get:function(){return this.objectModule.objectClass}}});$jscomp.global.Object.defineProperties(pe,
{packageStore:{configurable:!0,enumerable:!0,get:function(){return this._packageStore||(this._packageStore=Gd._packageStore)}}});db("default",pe);Gd.ObjectPackage=pe;var Te=function(rc,bd){if(!rc)throw Error("ObjectModule needs package!");if(!bd)throw Error("ObjectModule needs package!");this._moduleName=rc;this._objectPackage=bd};Te.prototype.read=function(){return this.resource.read()};Te.prototype.write=function(rc){return this.resource.write(rc)};Te.prototype.ensureExistance=function(){var rc=
this,bd,he;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cd){switch(cd.nextAddress){case 1:return bd=rc.resource,cd.yield(bd.exists(),2);case 2:if(cd.yieldResult){cd.jumpTo(3);break}return cd.yield(bd.write("'format esm';\n"),4);case 4:he={},rc.System.config({meta:(he[rc.url]={format:"esm"},he)});case 3:return cd.return(rc)}})};Te.prototype.adoptObject=function(rc,bd){var he=this,cd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ie){if(1==ie.nextAddress)return he.objectClass===
rc.constructor?ie.return():ie.yield(he.ensureObjectClass(rc.constructor,bd),2);cd=ie.yieldResult;Gd.adoptObject(rc,cd);ie.jumpToEnd()})};Te.prototype.ensureObjectClass=function(rc,bd){var he=this,cd=this.objectClass;return cd&&cd.prototype.__proto__===rc.prototype?cd:Promise.resolve(this.ensureObjectClassSource(rc,bd)).then(function(ie){var ac=ie.source,Db=ie.moduleId,Tc=ie.className,Nc=ie.bindings,wc=he.System;ie=Gd.module(wc,Db);if(Nc)for(var Vc in Nc)ie.define(Vc,Nc[Vc]);ac=Gd.runEval(ac,{classTransform:Gd.classToFunctionTransform,
sync:!0,targetModule:Db,System:wc});if(ac.isError)throw ac.value;ac=ie.recorder[Tc];if(!ac)throw Error("Failed to define class "+Tc+" in "+Db);return ac})};Te.prototype.ensureObjectClassSource=function(rc,bd){return this.createDefaultClassDeclaration(rc,bd)};Te.prototype.createDefaultClassDeclaration=function(rc,bd){rc=void 0===rc?Object:rc;bd=void 0===bd?!1:bd;var he=this,cd,ie,ac,Db,Tc,Nc,wc,Vc,hb,zc,Ub,Jc,Wc,Ad,Xd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){switch(xc.nextAddress){case 1:cd=
he;ie=cd.System;ac=cd.systemModule;Db=cd.objectPackage;bd=bd||Gd.string.capitalize(Gd.toJsIdentifier(Db.id));Tc=rc[Symbol.for("__LivelyClassName__")];Nc=!Tc;wc=Gd.globalClasses.includes(rc);Vc="";hb=null;if(Nc){Tc="__anonymous_superclass__";zc={};hb=(zc[Tc]=rc,zc);xc.jumpTo(2);break}if(wc){xc.jumpTo(2);break}return xc.yield(Gd.ExportLookup.findExportOfValue(rc,ie),4);case 4:(Ub=xc.yieldResult)?(Jc=Gd.ImportInjector.run(ie,ac.id,ac.package(),"",Ub),Wc=Jc.standaloneImport,Vc+=Wc+"\n\n"):(Ad={},hb=(Ad[Tc]=
rc,Ad));case 2:return bd===Tc&&(bd="Object"+bd),Xd="Object"===Tc?"class "+bd+" {}\n":"class "+bd+" extends "+Tc+" {}\n",Vc+="export default "+Xd+"\n",xc.yield(ac.changeSource(Vc),5);case 5:return xc.yield(ac.load(),6);case 6:return xc.return({source:Vc,className:bd,moduleId:he.url,bindings:hb})}})};Te.prototype.addScript=function(rc,bd,he){var cd=this,ie,ac,Db,Tc,Nc,wc,Vc,hb,zc,Ub,Jc,Wc,Ad,Xd,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){switch(Pc.nextAddress){case 1:if(rc.constructor===
cd.objectClass){ie=rc.constructor;Pc.jumpTo(2);break}return Pc.yield(cd.ensureObjectClass(rc.constructor),3);case 3:ie=Pc.yieldResult;case 2:ac=ie;Db="function"===typeof bd?String(bd):bd;Tc=Gd.parseFunction(Db);Nc=Gd.RuntimeSourceDescriptor.for(ac,cd.System);he||(he=Gd.Path("id.name").get(Tc));if(!he)throw Error("No name, cannot add "+Gd.string.truncate(Db,30).replace(/\n/g,"")+"!");wc=Gd.toJsIdentifier(he);console.assert("FunctionExpression"===Tc.type||"ArrowFunctionExpression"===Tc.type,"not a function expression but: "+
Tc.type);Vc=Tc.params.map(function(sc){return Db.slice(sc.start,sc.end)});hb="BlockStatement"===Tc.body.type?Db.slice(Tc.body.start,Tc.body.end):"{ return "+Db.slice(Tc.body.start,Tc.body.end)+" }";zc=wc+"("+Vc.join(",")+") "+hb;"ArrowFunctionExpression"===Tc.type&&(Tc.type="FunctionExpression");Ub=Nc.source;Jc=Nc.ast;if(!Jc)throw Error("cannot find class decl of "+Nc.module.id);(Wc=Jc.body.body.find(function(sc){return sc.key.name===wc&&!sc.static}))?Ub=Ub.slice(0,Wc.start)+zc+Ub.slice(Wc.end):(Ad=
Ub.lastIndexOf("}"),Xd=Ub.slice(0,Ad),xc=Ub.slice(Ad),/\n\s*$/m.test(Xd)||(Xd+="\n"),zc=Gd.string.changeIndent(zc,"  ",1),/^[ ]*\n/m.test(xc)||(xc="\n"+xc),Ub=Xd+zc+xc);return Pc.yield(Nc.changeSource(Ub),4);case 4:return Pc.return({script:ac.prototype[wc],klass:ac,module:Nc.module.id,methodName:wc})}})};$jscomp.global.Object.defineProperties(Te.prototype,{objectPackage:{configurable:!0,enumerable:!0,get:function(){return this._objectPackage}},objectClass:{configurable:!0,enumerable:!0,get:function(){var rc=
this.systemModule;return rc.isLoaded()?rc.System.get(rc.id).default:null}},moduleName:{configurable:!0,enumerable:!0,get:function(){return this._moduleName}},systemModule:{configurable:!0,enumerable:!0,get:function(){return Gd.module(this.System,this.url)}},System:{configurable:!0,enumerable:!0,get:function(){return this.objectPackage.System}},resource:{configurable:!0,enumerable:!0,get:function(){return this.objectPackage.resource(this.moduleName)}},url:{configurable:!0,enumerable:!0,get:function(){return this.resource.url}}});
Gd.ObjectModule=Te;Gd.default=pe}}});
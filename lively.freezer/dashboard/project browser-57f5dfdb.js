System.register(["./__root_module__-06ff41f6.js","kld-intersections","./index-2b842a27.js","./index-1eaba422.js","./user-ui-538db77c.js"],function(Ca,Bb){var Kb,lc,bc,Td,Xc,Wd,$c,Pc,md,ge,Qe,kf,ke,cc,Jc,Nd,ec,Zd,le;return{setters:[function(yc){Kb=yc.an;lc=yc.aD;bc=yc.ap;Td=yc.ab;Xc=yc.Y;Wd=yc.a6;$c=yc.ax;Pc=yc.a7;md=yc.C;ge=yc.a3;Qe=yc.r;kf=yc.aw;ke=yc.aC;cc=yc.b2;Jc=yc.b3;Nd=yc.au;ec=yc.b0;Zd=yc.aZ},function(){},function(){},function(){},function(yc){le=yc.UserUI}],execute:function(){var yc=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");yc.Morph=Kb;yc.HorizontalLayout=lc;yc.VerticalLayout=bc;yc.morph=Td;yc.MorphicDB=Xc;yc.arr=Wd;yc.fun=$c;yc.string=Pc;yc.Color=md;yc.pt=ge;yc.UserUI=le;yc.resource=Qe;var Gc=function(dd){var Hd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),Ld=Hd.hasOwnProperty("WorldDashboard")&&"function"===typeof Hd.WorldDashboard?Hd.WorldDashboard:Hd.WorldDashboard=function(uc){uc&&uc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return kf(Ld,dd,[{key:"onLoad",value:function(){"undefined"!==typeof localStorage&&(this.ui.sortSelector.selection=localStorage.getItem("lively.morphic-projects-filter"))}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if(!this.isComponent&&"undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",this.ui.sortSelector.selection)}catch(uc){console.error(uc)}}},{key:"beforePublish",value:function(){this.reset()}},
{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(uc){uc=void 0===uc?$world:uc;this.owner!=uc&&uc.addMorph(this);this.center=uc.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(uc){var rb=yc.UserUI.getCurrentUser();uc=this.ui.searchField.fuzzyFilter(uc,function(Gb){return Gb._commit.name+Gb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return yc.arr.sortBy(uc,
function(Gb){return-Gb._commit.timestamp});case "TEMPLATES":return uc;case "MY PROJECTS":return yc.arr.filter(uc,function(Gb){return Gb._commit.author.name===rb.name});case "PUBLISHED":return uc}}},{key:"updateList",value:function(){var uc=this;this.previews&&yc.fun.debounceNamed("update world list",150,function(){uc.ui.worldList.items=uc.sortAndFilterPreviews(uc.previews)})()}},{key:"displayWorlds",value:function(){var uc=this,rb,Gb,Oa,ab,Qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){switch(Ja.nextAddress){case 1:return uc.reset(),
rb=uc.ui,Gb=rb.loadingLabel,Gb.animate({opacity:1,duration:300}),Ja.yield(uc.db.latestCommits("world"),2);case 2:return Oa=Ja.yieldResult,Ja.yield(Bb.import("./world preview-ab2b5fa1.js"),4);case 4:if(!(ab=Ja.yieldResult)){Ja.jumpTo(5);break}return Ja.yield(yc.resource("part://partial freezing/world preview"),6);case 6:ab=Ja.yieldResult;case 5:return Ja.yield(ab.read(),3);case 3:return Qa=Ja.yieldResult,uc.previews=Oa.map(function(eb){var Sb=yc.morph({reactsToPointer:!1,fill:yc.Color.transparent,
extent:Qa.extent});Sb._commit=eb;Sb.displayPreview=function(){var Ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){if(1==sb.nextAddress)return Ac=Qa.copy(),Ac._commit=eb,Ac.opacity=0,Sb.addMorph(Ac),Ac.displayPreview(),Ac.position=yc.pt(0,0),sb.yield(Sb.whenRendered(),2);Sb.layout=new yc.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});sb.jumpToEnd()})};return Sb}),Ja.yield(Gb.animate({opacity:0,duration:300}),7);case 7:uc.updateList(),0==Oa.length&&(uc.ui.noWorldWarning.center=
uc.innerBounds().center(),uc.ui.noWorldWarning.animate({visible:!0,duration:300})),Ja.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(uc){this.ui.closeButton.visible=uc}},db:{serialize:!1,get:function(){return yc.MorphicDB.default}},
ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],Hd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"WorldDashboard",version:"0.1.1-131"}}},{start:330,end:4350})}(yc.Morph);Gc=yc.WorldDashboard;yc.default=Gc;var Qb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");Qb.Morph=Kb;Qb.touchInputDevice=ke;Qb.TilingLayout=cc;Qb.arr=Wd;Qb.pt=ge;Gc=function(dd){var Hd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),Ld=Hd.hasOwnProperty("GrowingWorldList")&&"function"===typeof Hd.GrowingWorldList?Hd.GrowingWorldList:Hd.GrowingWorldList=function(uc){uc&&
uc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return kf(Ld,dd,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(uc){kf._get(Object.getPrototypeOf(Ld.prototype),"onScroll",this).call(this,uc);this.update()}},{key:"onChange",value:function(uc){kf._get(Object.getPrototypeOf(Ld.prototype),"onChange",this).call(this,uc);"extent"==uc.prop&&this.update(!0)}},{key:"onHoverIn",value:function(uc){this.clipMode=
"auto"}},{key:"onHoverOut",value:function(uc){Qb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(uc){var rb=this.items;if(rb&&0!=rb.length){var Gb=this.scrollContainer,Oa=Gb.layout.spacing;Gb.extent=this.extent;var ab=this.ui,Qa=ab.bufferTop;ab=ab.bufferBottom;Qa=Qa||Gb.addMorph({fill:null,name:"buffer top",height:10});ab=ab||Gb.addMorph({fill:null,name:"buffer bottom",height:10});Qa.width=ab.width=this.width-100;Gb.layout.disable();var Ja=rb[0];Oa=rb.slice(0,Math.floor(this.width/
(Ja.width+Oa))*(Math.ceil((this.scroll.y+this.height)/(Ja.height+Oa))+1)).filter(function(sb){return sb.owner!=Gb});Ja=this.scroll.y+2*this.height;for(var eb={},Sb=$jscomp.makeIterator(Oa),Ac=Sb.next();!Ac.done;eb={$jscomp$loop$prop$item$2588:eb.$jscomp$loop$prop$item$2588},Ac=Sb.next())eb.$jscomp$loop$prop$item$2588=Ac.value,Ja++,eb.$jscomp$loop$prop$item$2588.top=Ja,Gb.addMorph(eb.$jscomp$loop$prop$item$2588),eb.$jscomp$loop$prop$item$2588._initialized||eb.$jscomp$loop$prop$item$2588.whenRendered().then(function(sb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ab){sb.$jscomp$loop$prop$item$2588._initialized=
!0;return Ab.yield(sb.$jscomp$loop$prop$item$2588.displayPreview(),0)})}}(eb));uc&&(Qa.position=Qb.pt(0,0),rb.forEach(function(sb,Ab){return sb.position=Qb.pt(Ab+1,Ab+1)}),ab.position=Qb.pt(rb.length+2,rb.length+2));Gb.layout.enable();if(uc||0<Oa.length)ab.top=this.submorphBounds().height,Gb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Qb.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(uc){this.setProperty("items",uc);var rb=this.scrollContainer;rb.layout&&rb.layout.disable();var Gb=this.ui,Oa=Gb.bufferTop;Gb=Gb.bufferBottom;Qb.arr.withoutAll(rb.submorphs,
[].concat($jscomp.arrayFromIterable(uc),[Oa,Gb])).forEach(function(ab){return ab.remove()});this.update(!0)}}}}}],Hd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Qb.Morph);Gc=Qb.GrowingWorldList;Qb.default=Gc;var Ec=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
Ec.InputLine=Jc;Ec.Color=md;Ec.connect=Nd;Ec.disconnectAll=ec;Ec.disconnect=Zd;Ec.arr=Wd;Ec.string=Pc;Gc=function(dd){var Hd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),Ld=Hd.hasOwnProperty("SearchInputLine")&&"function"===typeof Hd.SearchInputLine?Hd.SearchInputLine:Hd.SearchInputLine=function(uc){uc&&uc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return kf(Ld,dd,[{key:"fuzzyMatch",value:function(uc,rb){rb=void 0===
rb?this.parseInput():rb;if(rb.lowercasedTokens.every(function(Oa){return uc.toLowerCase().includes(Oa)}))return!0;var Gb=uc.toLowerCase();return 3>=Ec.arr.sum(rb.lowercasedTokens.map(function(Oa){return Ec.string.levenshtein(Gb,Oa)}))}},{key:"fuzzyFilter",value:function(uc,rb){var Gb=this;rb=void 0===rb?function(ab){return ab}:rb;var Oa=this.parseInput();return Ec.arr.filter(uc,function(ab){return Gb.fuzzyMatch(rb(ab),Oa)})}},{key:"parseInput",value:function(){var uc=Array.from(this.textString).reduce(function(Gb,
Oa){if("\\"===Oa&&!Gb.escaped)return Gb.escaped=!0,Gb;" "!==Oa||Gb.escaped?(Gb.spaceSeen=!1,Gb.current+=Oa):(!Gb.spaceSeen&&Gb.current&&(Gb.tokens.push(Gb.current),Gb.current=""),Gb.spaceSeen=!0);Gb.escaped=!1;return Gb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});uc.current&&uc.tokens.push(uc.current);var rb=uc.tokens.map(function(Gb){return Gb.toLowerCase()});return{tokens:uc.tokens,lowercasedTokens:rb}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],Hd,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(Ec.InputLine);Gc=Ec.SearchInputLine;Ec.default=Gc}}});
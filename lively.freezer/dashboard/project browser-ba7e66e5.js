System.register(["./__root_module__-cddb8267.js","kld-intersections","./index-6d7025d7.js","./index-5e61fbf0.js","./user-ui-6e4b2086.js"],function(Ea,Cb){var Kb,lc,$b,Qd,Zc,Rd,ad,Nc,nd,he,af,Af,rd,cc,Ic,Kd,Kc,Bd,be;return{setters:[function(yc){Kb=yc.an;lc=yc.aD;$b=yc.ap;Qd=yc.ab;Zc=yc.Y;Rd=yc.a6;ad=yc.ax;Nc=yc.a7;nd=yc.C;he=yc.a3;af=yc.r;Af=yc.aw;rd=yc.aC;cc=yc.b1;Ic=yc.b2;Kd=yc.au;Kc=yc.a_;Bd=yc.aZ},function(){},function(){},function(){},function(yc){be=yc.UserUI}],execute:function(){var yc=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");yc.Morph=Kb;yc.HorizontalLayout=lc;yc.VerticalLayout=$b;yc.morph=Qd;yc.MorphicDB=Zc;yc.arr=Rd;yc.fun=ad;yc.string=Nc;yc.Color=nd;yc.pt=he;yc.UserUI=be;yc.resource=af;var Cc=function(Xc){var Cd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),Od=Cd.hasOwnProperty("WorldDashboard")&&"function"===typeof Cd.WorldDashboard?Cd.WorldDashboard:Cd.WorldDashboard=function(Gb){Gb&&Gb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Af(Od,Xc,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(Gb){Gb=void 0===Gb?$world:Gb;this.owner!=Gb&&Gb.addMorph(this);this.center=Gb.visibleBounds().center()}},{key:"sortAndFilterPreviews",
value:function(Gb){var sb=yc.UserUI.getCurrentUser();Gb=this.ui.searchField.fuzzyFilter(Gb,function(Bc){return Bc._commit.name+Bc._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return yc.arr.sortBy(Gb,function(Bc){return-Bc._commit.timestamp});case "TEMPLATES":return Gb;case "MY PROJECTS":return yc.arr.filter(Gb,function(Bc){return Bc._commit.author.name===sb.name});case "PUBLISHED":return Gb}}},{key:"updateList",value:function(){var Gb=this;this.previews&&yc.fun.debounceNamed("update world list",
150,function(){Gb.ui.worldList.items=Gb.sortAndFilterPreviews(Gb.previews)})()}},{key:"displayWorlds",value:function(){var Gb=this,sb,Bc,gb,rb,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){switch(Ua.nextAddress){case 1:return Gb.reset(),sb=Gb.ui,Bc=sb.loadingLabel,Bc.animate({opacity:1,duration:300}),Ua.yield(Gb.db.latestCommits("world"),2);case 2:return gb=Ua.yieldResult,Ua.yield(Cb.import("./world preview-fccc6ccf.js"),4);case 4:if(!(rb=Ua.yieldResult)){Ua.jumpTo(5);break}return Ua.yield(yc.resource("part://partial freezing/world preview"),
6);case 6:rb=Ua.yieldResult;case 5:return Ua.yield(rb.read(),3);case 3:return Sa=Ua.yieldResult,Gb.previews=gb.map(function(cb){var ab=yc.morph({reactsToPointer:!1,fill:yc.Color.transparent,extent:Sa.extent});ab._commit=cb;ab.displayPreview=function(){var qb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zb){if(1==Zb.nextAddress)return qb=Sa.copy(),qb._commit=cb,qb.opacity=0,ab.addMorph(qb),qb.displayPreview(),qb.position=yc.pt(0,0),Zb.yield(ab.whenRendered(),2);ab.layout=new yc.HorizontalLayout({autoResize:!0,
reactToSubmorphAnimations:!0});Zb.jumpToEnd()})};return ab}),Ua.yield(Bc.animate({opacity:0,duration:300}),7);case 7:Gb.updateList(),0==gb.length&&(Gb.ui.noWorldWarning.center=Gb.innerBounds().center(),Gb.ui.noWorldWarning.animate({visible:!0,duration:300})),Ua.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,
get:function(){return this.ui.closeButton.visible},set:function(Gb){this.ui.closeButton.visible=Gb}},db:{serialize:!1,get:function(){return yc.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],
Cd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-127"}}},{start:330,end:3954})}(yc.Morph);Cc=yc.WorldDashboard;yc.default=Cc;var Pb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");Pb.Morph=Kb;Pb.touchInputDevice=rd;Pb.TilingLayout=cc;Pb.arr=Rd;Pb.pt=he;Cc=function(Xc){var Cd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),
Od=Cd.hasOwnProperty("GrowingWorldList")&&"function"===typeof Cd.GrowingWorldList?Cd.GrowingWorldList:Cd.GrowingWorldList=function(Gb){Gb&&Gb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Af(Od,Xc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(Gb){Af._get(Object.getPrototypeOf(Od.prototype),"onScroll",this).call(this,Gb);this.update()}},{key:"onChange",value:function(Gb){Af._get(Object.getPrototypeOf(Od.prototype),
"onChange",this).call(this,Gb);"extent"==Gb.prop&&this.update(!0)}},{key:"onHoverIn",value:function(Gb){this.clipMode="auto"}},{key:"onHoverOut",value:function(Gb){Pb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(Gb){var sb=this.items;if(sb&&0!=sb.length){var Bc=this.scrollContainer,gb=Bc.layout.spacing;Bc.extent=this.extent;var rb=this.ui,Sa=rb.bufferTop;rb=rb.bufferBottom;Sa=Sa||Bc.addMorph({fill:null,name:"buffer top",height:10});rb=rb||Bc.addMorph({fill:null,name:"buffer bottom",
height:10});Sa.width=rb.width=this.width-100;Bc.layout.disable();var Ua=sb[0];gb=sb.slice(0,Math.floor(this.width/(Ua.width+gb))*(Math.ceil((this.scroll.y+this.height)/(Ua.height+gb))+1)).filter(function(Zb){return Zb.owner!=Bc});Ua=this.scroll.y+2*this.height;for(var cb={},ab=$jscomp.makeIterator(gb),qb=ab.next();!qb.done;cb={$jscomp$loop$prop$item$2541:cb.$jscomp$loop$prop$item$2541},qb=ab.next())cb.$jscomp$loop$prop$item$2541=qb.value,Ua++,cb.$jscomp$loop$prop$item$2541.top=Ua,Bc.addMorph(cb.$jscomp$loop$prop$item$2541),
cb.$jscomp$loop$prop$item$2541._initialized||cb.$jscomp$loop$prop$item$2541.whenRendered().then(function(Zb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){Zb.$jscomp$loop$prop$item$2541._initialized=!0;return kc.yield(Zb.$jscomp$loop$prop$item$2541.displayPreview(),0)})}}(cb));Gb&&(Sa.position=Pb.pt(0,0),sb.forEach(function(Zb,kc){return Zb.position=Pb.pt(kc+1,kc+1)}),rb.position=Pb.pt(sb.length+2,sb.length+2));Bc.layout.enable();if(Gb||0<gb.length)rb.top=this.submorphBounds().height,
Bc.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Pb.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},
items:{after:["layout","scrollContainer"],set:function(Gb){this.setProperty("items",Gb);var sb=this.scrollContainer;sb.layout&&sb.layout.disable();var Bc=this.ui,gb=Bc.bufferTop;Bc=Bc.bufferBottom;Pb.arr.withoutAll(sb.submorphs,[].concat($jscomp.arrayFromIterable(Gb),[gb,Bc])).forEach(function(rb){return rb.remove()});this.update(!0)}}}}}],Cd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Pb.Morph);Cc=Pb.GrowingWorldList;Pb.default=Cc;var Dc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");Dc.InputLine=Ic;Dc.Color=nd;Dc.connect=Kd;Dc.disconnectAll=Kc;Dc.disconnect=Bd;Dc.arr=Rd;Dc.string=Nc;Cc=function(Xc){var Cd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),Od=Cd.hasOwnProperty("SearchInputLine")&&"function"===typeof Cd.SearchInputLine?Cd.SearchInputLine:Cd.SearchInputLine=
function(Gb){Gb&&Gb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Af(Od,Xc,[{key:"fuzzyMatch",value:function(Gb,sb){sb=void 0===sb?this.parseInput():sb;if(sb.lowercasedTokens.every(function(gb){return Gb.toLowerCase().includes(gb)}))return!0;var Bc=Gb.toLowerCase();return 3>=Dc.arr.sum(sb.lowercasedTokens.map(function(gb){return Dc.string.levenshtein(Bc,gb)}))}},{key:"fuzzyFilter",value:function(Gb,sb){var Bc=this;sb=void 0===
sb?function(rb){return rb}:sb;var gb=this.parseInput();return Dc.arr.filter(Gb,function(rb){return Bc.fuzzyMatch(sb(rb),gb)})}},{key:"parseInput",value:function(){var Gb=Array.from(this.textString).reduce(function(Bc,gb){if("\\"===gb&&!Bc.escaped)return Bc.escaped=!0,Bc;" "!==gb||Bc.escaped?(Bc.spaceSeen=!1,Bc.current+=gb):(!Bc.spaceSeen&&Bc.current&&(Bc.tokens.push(Bc.current),Bc.current=""),Bc.spaceSeen=!0);Bc.escaped=!1;return Bc},{tokens:[],current:"",escaped:!1,spaceSeen:!1});Gb.current&&Gb.tokens.push(Gb.current);
var sb=Gb.tokens.map(function(Bc){return Bc.toLowerCase()});return{tokens:Gb.tokens,lowercasedTokens:sb}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],Cd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(Dc.InputLine);Cc=Dc.SearchInputLine;
Dc.default=Cc}}});
System.register(["./__root_module__-06ff41f6.js","kld-intersections","./index-df7aed39.js","./editor-plugin-3f8b115f.js","./index-1bff5bbb.js"],function(Ca){var Bb,Kb,lc,bc,Td,Xc,Wd,$c,Pc,md,ge,Qe,kf,ke,cc,Jc,Nd,ec,Zd,le,yc,Gc,Qb,Ec;return{setters:[function(dd){Bb=dd.aw;Kb=dd.bB;lc=dd.bC;bc=dd.bD;Td=dd.E;Xc=dd.au;Wd=dd.aZ;$c=dd.a7;Pc=dd.ae;md=dd.bo;ge=dd.a6;Qe=dd.$;kf=dd.bE;ke=dd.bv},function(){},function(dd){cc=dd.s},function(dd){Jc=dd.p;Nd=dd.d;ec=dd.a;Zd=dd.r;le=dd.C},function(dd){yc=dd.localInterface;
Gc=dd.systemInterfaceNamed;Qb=dd.serverInterfaceFor;Ec=dd.l2lInterfaceFor}],execute:function(){var dd=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");dd.warnStyle={"border-bottom":"2px dotted orange"};dd.errorStyle={"background-color":"red"};var Hd=function(vb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),Ha=ha.hasOwnProperty("JavaScriptChecker")&&"function"===typeof ha.JavaScriptChecker?ha.JavaScriptChecker:ha.JavaScriptChecker=function(W){W&&W[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Ha,vb,[{key:"uninstall",value:function(W){var ra=W.text||W;(ra.markers||[]).forEach(function(Za){return Za.id.startsWith("js-checker-")&&ra.removeMarker(Za)});ra.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(W,ra){return[].concat($jscomp.arrayFromIterable(W.embeddedMorphMap.values())).find(function(Za){return ra.containsPosition(Za.anchor.position)})}},{key:"onDocumentChange",value:function(W,
ra,Za){var qb=ra.document;try{var sc=Za.parse()}catch(wd){sc=wd}sc&&(W=(ra.markers||[]).filter(function(wd){return wd.id.startsWith("js-checker-")}),Za=Za.undeclaredVariables().map(function(wd,nc){var Ob=wd.start;wd=wd.end;Ob=qb.indexToPosition(Ob);wd=qb.indexToPosition(wd);return ra.addMarker({id:"js-checker-"+nc,style:dd.warnStyle,range:{start:Ob,end:wd},type:"js-undeclared-var"})}),W.slice(Za.length).forEach(function(wd){return ra.removeMarker(wd)}),sc.parseError?(W=sc.parseError.loc,Za=W.column,
W=W.line-1,sc=qb.indexToPosition(sc.parseError.pos),Za=sc.column,W=sc.row,sc={start:{column:Za-1,row:W},end:{column:Za+1,row:W}},this.hasEmbeddedMorphInRange(ra,sc)||ra.addMarker({id:"js-syntax-error",range:sc,style:dd.errorStyle,type:"js-syntax-error"})):ra.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],ha,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),Ld=Hd=dd.JavaScriptChecker;dd.default=Hd;var uc=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");uc.query=Kb;uc.fuzzyParse=lc;uc.acorn=bc;uc.custom=Td;var rb=function(vb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),Ha=ha.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof ha.JavaScriptNavigator?
ha.JavaScriptNavigator:ha.JavaScriptNavigator=function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Ha,vb,[{key:"ensureAST",value:function(W){return this.parse(W.textString)}},{key:"parse",value:function(W){return uc.fuzzyParse(W)}},{key:"move",value:function(W,ra){var Za=!!ra.activeMark||!ra.selection.isEmpty(),qb=ra.selection,sc=ra.positionToIndex(qb.lead);W=this[W](ra.textString,sc);W=ra.indexToPosition(W);qb.lead=
W;Za||(qb.anchor=W);ra.scrollCursorIntoView()}},{key:"forwardSexp",value:function(W){this.move("_forwardSexp",W)}},{key:"backwardSexp",value:function(W){this.move("_backwardSexp",W)}},{key:"backwardUpSexp",value:function(W){this.move("_backwardUpSexp",W)}},{key:"forwardDownSexp",value:function(W){this.move("_forwardDownSexp",W)}},{key:"_forwardSexp",value:function(W,ra){W=this.parse(W);W=uc.custom.findNodesIncluding(W,ra).reverse().find(function(qb){return qb.end!==ra});if(!W)return ra;if("BlockStatement"===
W.type){var Za=W.body.find(function(qb){return qb.start>ra});if(Za)return Za.start}return W.end}},{key:"_backwardSexp",value:function(W,ra){W=this.parse(W);W=uc.custom.findNodesIncluding(W,ra).reverse().find(function(qb){return qb.start!==ra});if(!W)return ra;if("BlockStatement"===W.type){var Za=W.body.slice().reverse().find(function(qb){return qb.end<ra});if(Za)return Za.end}return W?W.start:ra}},{key:"_backwardUpSexp",value:function(W,ra){W=this.parse(W);return(W=uc.custom.findNodesIncluding(W,
ra).reverse().find(function(Za){return Za.start!==ra}))?W.start:ra}},{key:"_forwardDownSexp",value:function(W,ra){W=this.parse(W);return(W=uc.custom.findNodeAfter(W,ra,function(Za,qb){return qb.start>ra}))?W.node.start:ra}},{key:"markDefun",value:function(W){var ra=this.rangeForFunctionOrDefinition(W.textString,[W.positionToIndex(W.selection.range.start),W.positionToIndex(W.selection.range.end)]);ra&&W.execCommand("expandRegion",{start:ra[0],end:ra[1]})}},{key:"rangeForNodesMatching",value:function(W,
ra,Za){W=this.parse(W);return(ra=uc.custom.findNodesIncluding(W,ra).reverse().find(Za))?[ra.start,ra.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(W,ra){var Za=ra[0]===ra[1];return this.rangeForNodesMatching(W,ra[1],function(qb){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(qb.type)&&(Za&&qb.end!==ra[1]||!Za&&qb.start<ra[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(W,ra){"number"!==typeof ra&&(ra=W.positionToIndex(ra));
W=this.ensureAST(W);var Za=uc.query.nodesAt(ra,W).reverse(),qb=Za.find(function(wd){return"Identifier"===wd.type});if(!qb&&((Za=Za[0])&&Za.type.includes("Specifier")&&Za.local&&"Identifier"===Za.local.type&&(qb=Za.local),!qb))return;ra=(Za=uc.query.findDeclarationClosestToIndex(W,qb.name,ra))?uc.query.scopeAtIndex(W,Za.start):uc.query.scopeAtIndex(W,ra);var sc=uc.query.findReferencesAndDeclsInScope(ra,qb.name).refs;return{parsed:W,scope:ra,id:qb,name:qb.name,decl:Za,refs:sc}}},{key:"expandRegion",
value:function(W,ra,Za,qb){function sc($d){$d=W.positionToIndex({column:0,row:nc.row});return{range:[$d+Ob.start,$d+Ob.start+Ob.value.length],prev:qb}}var wd=qb.range[0]!==qb.range[1],nc=W.indexToPosition(qb.range[0]),Ob=W.tokenAt(nc);if(!wd&&Ob&&["keyword","identifier"].includes(Ob.type))return sc();Za=Za||this.parse(ra);ra=uc.query.nodesAtIndex(Za,qb.range[0]).reverse().find(function($d){return $d.start<qb.range[0]||$d.end>qb.range[1]});if(!ra)return qb;Za=ra.start;wd=ra.end;return"Literal"===ra.type&&
(ra.raw||"").match(/^['"`]/)&&qb.range[0]!==ra.start&&qb.range[1]!==ra.end&&(ra.start+1<qb.range[0]||ra.end-1>qb.range[1])?{range:[Za+1,wd-1],prev:qb}:{range:[Za,wd],prev:qb}}},{key:"contractRegion",value:function(W,ra,Za,qb){return qb.prev||qb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],ha,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6780})}(void 0);Hd=rb=uc.JavaScriptNavigator;uc.default=rb;var Gb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");Gb.addIndexToTextPos=function(vb,ha,Ha){return vb.indexToPosition(vb.positionToIndex(ha)+Ha)};Gb.connect=Xc;Gb.disconnect=Wd;Gb.string=$c;Gb.KeyHandler=Pc;Gb.Range=md;rb=function(vb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),Ha=ha.hasOwnProperty("Snippet")&&"function"===
typeof ha.Snippet?ha.Snippet:ha.Snippet=function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Ha,vb,[{key:Symbol.for("lively-instance-initialize"),value:function(W){W=void 0===W?{trigger:null,expansion:""}:W;var ra=W.expansion;this.trigger=W.trigger;this.expansion=ra;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(W){this.isExpanding&&(this.textMorph=W,Gb.connect(this.textMorph,
"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(W){this.isExpanding&&(Gb.disconnect(W,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var W=this.expansionState,ra=W.startAnchor,Za=W.endAnchor;W.isExpanding?Gb.Range.fromPositions(ra.position,Za.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var W=this.textMorph;if(W){var ra=
this.expansionState||{},Za=ra.marker,qb=ra.startAnchor,sc=ra.endAnchor;ra=ra.steps;qb&&W.removeAnchor(qb);sc&&W.removeAnchor(sc);Za&&W.removeMarker(Za);ra.forEach(function(wd){return W.removeAnchor(wd.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};W&&W.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(W){var ra=[],Za=0;Gb.string.reMatches(W,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(qb){var sc=
qb.start,wd=qb.end;qb=qb.match;var nc="";qb.startsWith("${")?(nc=$jscomp.makeIterator(qb.match(/^\$\{([0-9]+):([^\}]*)\}/)),nc.next(),qb=nc.next().value,nc=nc.next().value,qb=Number(qb)):qb=Number(qb.replace(/^\$/,""));W=W.slice(0,sc-Za)+nc+W.slice(wd-Za);ra[qb]={index:sc-Za,prefill:nc,anchor:null};Za+=wd-sc-nc.length});return{steps:ra,expansion:W}}},{key:"expandAtCursor",value:function(W){var ra=W.selection,Za=W.cursorPosition.column,qb=this.expansion;this.trigger&&(Za-=this.trigger.length);if(Za=
Math.max(0,Za))qb=Gb.string.lines(qb),qb=[qb[0]].concat($jscomp.arrayFromIterable(qb.slice(1).map(function(Id){return Gb.string.indent(Id," ",Za)}))),qb=qb.join("\n");var sc=this.createExpansionSteps(qb);qb=sc.expansion;sc=sc.steps;this.trigger&&ra.growLeft(this.trigger.length);ra.text=qb;var wd=ra.start;qb=ra.end;ra.collapseToEnd();if(sc.length){var nc=Gb.string.newUUID();sc.forEach(function(Id,kb){return Id.anchor=W.addAnchor(Object.assign({id:"snippet-step-"+kb+"-"+nc},Gb.addIndexToTextPos(W,wd,
Id.index)))});var Ob=W.addAnchor(Object.assign({id:"snippet-start-"+nc},wd,{insertBehavior:"stay"})),$d=W.addAnchor(Object.assign({id:"snippet-end-"+nc},qb));this.expansionState={marker:W.addMarker({id:"snippet-marker-"+nc,get range(){return{start:Ob.position,end:$d.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:Ob,endAnchor:$d,stepIndex:0,steps:sc,isExpanding:!0};
W.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var W=this.expansionState,ra=W.steps,Za=this.textMorph;if(W.isExpanding&&Za){Za=Za.selection;W=ra[W.stepIndex];var qb=W.prefill;Za.lead=Za.anchor=W.anchor.position;Za.growRight(qb.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=ra.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(W,ra){ra=W.positionToIndex(W.cursorPosition);
return W.textString.slice(ra-this.trigger.length,ra)===this.trigger}},{key:"tryTrigger",value:function(W,ra){if(!this.canExpand(W,W.cursorPosition))return!1;this.expandAtCursor(W);return!0}},{key:"getCommands",value:function(W){var ra=this;return W.concat([{name:"[snippet] next expansion step",exec:function(Za){ra.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(Za){ra.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(W){return W.concat(Gb.KeyHandler.withBindings([{keys:"Tab",
command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],ha,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:357,end:6029})}(void 0);Gb.Snippet=rb;Gb.Snippet=rb;Gb.Snippet=
rb;var Oa=[{name:"get snippets",exec:function(vb){return vb.pluginCollect("getSnippets",[])}}];Gb.snippetCommands=Oa;Gb.snippetCommands=Oa;Gb.snippetCommands=Oa;var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");ab.buildEvalOpts=function(vb,ha){return vb.plugins.find(function(Ha){return Ha.isJSEditorPlugin}).sanatizedJsEnv(ha)};ab.Snippet=rb;Oa=function(vb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ha=ha.hasOwnProperty("ModuleTopLevelVarCompleter")&&
"function"===typeof ha.ModuleTopLevelVarCompleter?ha.ModuleTopLevelVarCompleter:ha.ModuleTopLevelVarCompleter=function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Ha,vb,[{key:"compute",value:function(W,ra){var Za,qb,sc,wd,nc,Ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function($d){if(1==$d.nextAddress){qb=(Za=W.pluginFind(function(Id){return Id.isJSEditorPlugin}))&&Za.systemInterface();if(!qb)return $d.return([]);
sc=ab.buildEvalOpts(W);wd=sc.targetModule;return"local"===qb.name?(nc=Object.getOwnPropertyNames(qb.getModule(wd).recorder),$d.jumpTo(2)):$d.yield(qb.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+wd+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',
{targetModule:"lively://module-recorder-completer"}),3)}if(2!=$d.nextAddress){Ob=$d.yieldResult;if(Ob.isError)return $d.return([]);nc=JSON.parse(Ob.value)}nc=nc.filter(function(Id){return!Id.startsWith("defVar_")&&!["System","__currentLivelyModule","initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(Id)});return $d.return(nc.map(function(Id){return{priority:1100,completion:Id}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],
ha,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:227,end:1700})}(void 0);ab.ModuleTopLevelVarCompleter=Oa;ab.ModuleTopLevelVarCompleter=Oa;ab.ModuleTopLevelVarCompleter=Oa;Oa=function(vb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ha=ha.hasOwnProperty("DynamicJavaScriptCompleter")&&
"function"===typeof ha.DynamicJavaScriptCompleter?ha.DynamicJavaScriptCompleter:ha.DynamicJavaScriptCompleter=function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Ha,vb,[{key:"isValidPrefix",value:function(W){return/\.[a-z0-9_]*$/i.test(W)}},{key:"isMethodCallCompletion",value:function(W){return W.endsWith(")")&&0<W.indexOf("(")}},{key:"isValidIdentifier",value:function(W){if("string"!==typeof W)return!1;this.isMethodCallCompletion(W)&&
(W=W.slice(0,W.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(W)?!0:!1}},{key:"wrapInBrackets",value:function(W){if(!isNaN(Number(W))||W.startsWith("Symbol."))return"["+W+"]";var ra="";this.isMethodCallCompletion(W)&&(ra=W.slice(W.indexOf("(")),W=W.slice(0,W.indexOf("(")));return'["'+W.replace(/"/g,'\\"')+'"]'+ra}},{key:"compute",value:function(W){var ra=this,Za,qb,sc,wd,nc,Ob,$d,Id,kb,Eb,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ub){if(1==ub.nextAddress){Za=W.selection;
Za.isEmpty()?(qb=W.getLine(Za.lead.row),qb=qb.slice(qb.lastIndexOf(":")+1,Za.lead.column)):qb=Za.text.slice(Math.max(0,Za.text.indexOf(":")),0);if(!ra.isValidPrefix(qb))return ub.return([]);wd=(sc=W.pluginFind(function(cd){return cd.isJSEditorPlugin}))&&sc.systemInterface();if(!wd)return ub.return([]);nc=ab.buildEvalOpts(W);return ub.yield(wd.dynamicCompletionsForPrefix(nc.targetModule,qb,nc),2)}Ob=ub.yieldResult;$d=Ob.isError;Id=Ob.value;kb=Ob.completions;Eb=Ob.prefix;if($d)return console.warn("javascript completer encountered error: "+
(Id.stack||Id)),ub.return([]);kb.reduce(function(cd,Vc){Vc=$jscomp.makeIterator(Vc);Vc.next();Vc=Vc.next().value;return cd+Vc.length},0);ad=kb.reduce(function(cd,Vc,ib){Vc=$jscomp.makeIterator(Vc);var Ra=Vc.next().value;Vc=Vc.next().value;return cd.concat(Vc.map(function(pb){var bb=ra.isValidIdentifier(pb);return{info:Ra,completion:pb,prefix:bb?Eb:"."+Eb,customInsertionFn:bb?ra.isMethodCallCompletion(pb)?function(Oc,ma,Aa,xb){ma=xb.start;xb=xb.end;Oc=Oc.replace(/\((.*)\)/,function(P){return"("+P.slice(1,
-1).split(", ").map(function(va,Va){return"${"+Va+":"+va+"}"}).join(", ")+")"});Oc=new ab.Snippet({expansion:Oc});Aa.replace({start:ma,end:xb},"");Oc.expandAtCursor(Aa)}:null:function(Oc,ma,Aa,xb){Oc=xb.start;xb=xb.end;ma={row:Oc.row,column:Oc.column-1};xb="."===Aa.textInRange({start:ma,end:Oc})?{start:ma,end:xb}:{start:Oc,end:xb};Aa.replace(xb,ra.wrapInBrackets(pb))}}}))},[]);ad.forEach(function(cd,Vc){return Object.assign(cd,{priority:2E3+ad.length-Vc})});return ub.return(ad)})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DynamicJavaScriptCompleter"}}],ha,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5085})}(void 0);ab.DynamicJavaScriptCompleter=Oa;ab.DynamicJavaScriptCompleter=Oa;ab.DynamicJavaScriptCompleter=Oa;ab.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
Oa=function(vb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ha=ha.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof ha.JavaScriptKeywordCompleter?ha.JavaScriptKeywordCompleter:ha.JavaScriptKeywordCompleter=function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Ha,vb,[{key:"compute",value:function(W,ra){return ab.keywords.map(function(Za){return{completion:Za,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],ha,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6087,end:6225})}(void 0);ab.JavaScriptKeywordCompleter=Oa;ab.JavaScriptKeywordCompleter=Oa;ab.JavaScriptKeywordCompleter=Oa;Oa=[new ab.DynamicJavaScriptCompleter,
new ab.JavaScriptKeywordCompleter,new ab.ModuleTopLevelVarCompleter];ab.completers=Oa;ab.completers=Oa;ab.completers=Oa;var Qa=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");Qa.Snippet=rb;var Ja=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];Qa.snippets=Ja;Qa.snippets=Ja;Qa.snippets=Ja;var eb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");eb.getEvalEnv=function(vb){return(vb=vb.pluginFind(function(ha){return ha.isJSEditorPlugin}))?vb.evalEnvironment:null};eb.setEvalEnv=function(vb,ha){(vb=vb.pluginFind(function(Ha){return Ha.isJSEditorPlugin}))&&Object.assign(vb.evalEnvironment,ha);return vb.evalEnvironment};
eb.pToI=function(vb,ha){return vb.positionToIndex(ha)};eb.iToP=function(vb,ha){return vb.indexToPosition(ha)};eb.arr=ge;eb.promise=Qe;eb.string=$c;eb.show=cc;eb.Range=md;eb.query=Kb;eb.BaseVisitor=kf;Qa=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(vb,ha){ha=void 0===ha?{varName:null,position:null}:ha;var Ha,W,ra,Za,qb,sc,wd,nc,Ob,$d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Id){switch(Id.nextAddress){case 1:Ha=
ha;W=Ha.varName;ra=Ha.position;if(!W){ra||(ra=vb.cursorPosition);Za=vb.pluginInvokeFirst("getNavigator");qb=Za.ensureAST(vb);sc=eb.query.nodesAt(vb.positionToIndex(ra),qb).reverse().find(function(kb){return"Identifier"===kb.type});if(!sc)return vb.showError(Error("no identifier found!")),Id.return(!0);W=sc.name}ha=vb.pluginFind(function(kb){return kb.isJSEditorPlugin}).sanatizedJsEnv();wd='lively.modules.module("'+ha.targetModule+'").undefine("'+W+'")';Id.setCatchFinallyBlocks(2);return Id.yield(vb.doEval(null,
ha,wd),4);case 4:nc=Id.yieldResult;Ob=nc.error?nc.error:nc.isError?nc.value:null;Id.leaveTryBlock(3);break;case 2:Ob=$d=Id.enterCatchBlock();case 3:return Ob?vb.showError(Ob):vb.setStatusMessage(W+" undefined"),Id.return(!0)}})}},{name:"change doitContext",exec:function(vb){var ha,Ha,W,ra,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qb){if(1==qb.nextAddress)return ha=$jscomp,Ha=ha.makeIterator,qb.yield(vb.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(sc){return!sc.isUsedAsEpiMorph()}}),2);W=Ha.call(ha,qb.yieldResult);if(ra=W.next().value)Za="reset"===ra,vb.doitContext=Za?null:ra,vb.setStatusMessage(Za?"doitContext is now\n"+ra:"doitContext reset");return qb.return(!0)})}},{name:"change eval backend",exec:function(vb,ha){ha=void 0===ha?{backend:void 0}:ha;var Ha,W;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){if(1==ra.nextAddress)return Ha=ha,W=Ha.backend,void 0!==W?ra.jumpTo(2):
ra.yield(vb.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=ra.nextAddress&&(W=ra.yieldResult,!W))return vb.setStatusMessage("Canceled"),ra.return(!0);"local"===W&&(W=null);vb.setStatusMessage("Eval backend is now "+(W||"local"));return ra.return(eb.setEvalEnv(vb,{remote:W}))})}},{name:"copy current module name to clipboard",exec:function(vb){var ha=vb.evalEnvironment.targetModule;vb.setStatusMessage(ha||"Cannot find module name");vb.env.eventDispatcher.killRing.add(vb);
vb.env.eventDispatcher.doCopy(ha);return!0}}];eb.jsEditorCommands=Qa;eb.jsEditorCommands=Qa;eb.jsEditorCommands=Qa;var Sb=[{name:"[javascript] list errors and warnings",exec:function(vb){var ha,Ha,W,ra,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qb){if(1==qb.nextAddress){ha=(vb.markers||[]).filter(function(sc){sc=sc.type;return"js-undeclared-var"===sc||"js-syntax-error"===sc});if(!ha.length)return eb.show("no warnings or errors"),qb.return(!0);Ha=ha.map(function(sc){var wd=sc.range;
return{isListItem:!0,string:"["+sc.type.split("-").slice(1).join(" ")+"] "+vb.textInRange(wd),value:wd}});return qb.yield(vb.world().filterableListPrompt("jump to warning or error",Ha),2)}W=qb.yieldResult;ra=$jscomp.makeIterator(W.selected);if(Za=ra.next().value)vb.saveMark(),vb.selection=Za,vb.centerRow(Za.start.row);return qb.return(!0)})}},{name:"[javascript] inject import",exec:function(vb,ha){ha=void 0===ha?{gotoImport:!1,insertImportAtCursor:!0}:ha;var Ha,W,ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){switch(Za.nextAddress){case 1:return Za.yield(eb.promise.delay(0),
2);case 2:return Za.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return Ha=Za.yieldResult,W=Ha.interactivelyInjectImportIntoText,Za.yield(W(vb,ha),4);case 4:return(ra=Za.yieldResult)||vb.setStatusMessage("canceled"),Za.return(ra)}})}},{name:"[javascript] fix undeclared variables",exec:function(vb,ha){ha=void 0===ha?{ignore:[],autoApplyIfSingleChoice:!1,requester:vb}:ha;var Ha,W,ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==Za.nextAddress)return Za.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=Za.nextAddress)return Ha=Za.yieldResult,W=Ha.interactivlyFixUndeclaredVariables,Za.yield(W(vb,ha),3);ra=Za.yieldResult;vb.focus();return Za.return(ra)})}},{name:"[javascript] remove unused imports",exec:function(vb,ha){ha=void 0===ha?{query:!0}:ha;var Ha,W,ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==Za.nextAddress)return Za.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=Za.nextAddress)return Ha=Za.yieldResult,W=Ha.cleanupUnusedImports,Za.yield(W(vb,
ha),3);ra=Za.yieldResult;vb.setStatusMessage(ra);return Za.return(!0)})}},{name:"[javascript] eslint report",exec:function(vb){var ha,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){if(1==W.nextAddress)return W.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);ha=W.yieldResult;Ha=ha.default;try{return W.return(Ha.reportOnMorph(vb))}catch(ra){vb.showError(ra)}W.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(vb){var ha,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){if(1==
W.nextAddress)return W.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);ha=W.yieldResult;Ha=ha.default;try{return W.return(Ha.previewFixesOnMorph(vb))}catch(ra){vb.showError(ra)}W.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(vb,ha,Ha){function W(ub,cd){cd||(cd=nc(ub,{allowReturnOutsideFunction:!0}));var Vc=eb.string.lineRanges(ub),ib=ub.split("\n"),Ra=[],pb=new eb.BaseVisitor,bb=pb.visitVariableDeclaration;pb.visitVariableDeclaration=function(xb,
P,va){if(1<xb.declarations.length)for(var Va=eb.string.findLineWithIndexInLineRanges(Vc,xb.start),Db=xb.declarations[0].start-Vc[Va][0],mc={},Tb=1;Tb<xb.declarations.length;mc={$jscomp$loop$prop$actionType$2585:mc.$jscomp$loop$prop$actionType$2585,$jscomp$loop$prop$arg$2586:mc.$jscomp$loop$prop$arg$2586},Tb++){var Tc=xb.declarations[Tb],gd=eb.string.findLineWithIndexInLineRanges(Vc,Tc.start);if(Va!==gd){var se=ib[gd].match(/\s*/)[0].length;se=Db-se;0!==se&&(Tc=eb.string.findLineWithIndexInLineRanges(Vc,
Tc.end),mc.$jscomp$loop$prop$actionType$2585=0<se?"insert":"delete",mc.$jscomp$loop$prop$arg$2586=0<se?" ".repeat(se):-se,Ra.push.apply(Ra,$jscomp.arrayFromIterable(eb.arr.range(gd,Tc).map(function(Cf){return function(me){return[Cf.$jscomp$loop$prop$actionType$2585,Vc[me][0],Cf.$jscomp$loop$prop$arg$2586]}}(mc)))))}}return bb.call(pb,xb,P,va)};pb.accept(cd,{},[]);for(cd=Ra.length;cd--;){var Oc=$jscomp.makeIterator(Ra[cd]),ma=Oc.next().value,Aa=Oc.next().value;Oc=Oc.next().value;"insert"===ma?ub=ub.slice(0,
Aa)+Oc+ub.slice(Aa):"delete"===ma&&(ub=ub.slice(0,Aa)+ub.slice(Aa+Oc))}return ub}var ra,Za,qb,sc,wd,nc,Ob,$d,Id,kb,Eb,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ub){switch(ub.nextAddress){case 1:return ra=Ha||Math.floor(vb.width/vb.defaultCharExtent().width),ha=Object.assign({printWidth:ra,tabWidth:2,useTabs:!1,bracketSpacing:!1},ha),Za=lively.modules.module,qb=System.normalizeSync("prettier/standalone.js"),ub.yield(Za(qb).load({format:"global",instrument:!1}),2);case 2:return sc=
ub.yieldResult,ub.yield(Za("lively.ast/lib/acorn-extension.js").load(),3);case 3:return ub.yield(Za("lively.ast").load(),4);case 4:return wd=ub.yieldResult,nc=wd.parse,ub.yield(Za("lively.ast/lib/query.js").load(),5);case 5:return ub.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return Ob=ub.yieldResult,$d=vb.selection.isEmpty()?vb.documentRange:vb.selection.range,Id=vb.positionToIndex($d.start),kb=vb.positionToIndex($d.end),Eb=sc.format(vb.textString,Object.assign({},
ha,{rangeStart:Id,rangeEnd:kb,parser:function(cd,Vc,ib){return nc(cd,{allowReturnOutsideFunction:!0})}})),vb.undoManager.group(),ad=Ob.diffChars(vb.textString,Eb),vb.applyJsDiffPatch(ad),vb.selection.text=W(vb.selection.text),vb.undoManager.group(),ub.return(!0)}})}}];eb.jsIdeCommands=Sb;eb.jsIdeCommands=Sb;eb.jsIdeCommands=Sb;var Ac=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(vb,ha){ha=vb.pluginInvokeFirst("getNavigator");if(!ha)return!0;ha=ha.resolveIdentifierAt(vb,vb.cursorPosition);
if(!ha||!ha.id)return eb.show("No symbol identifier selected"),!0;if(!ha.decl)return eb.show("Cannot find declaration of "+ha.name),!0;vb.saveMark();vb.selection={start:vb.indexToPosition(ha.decl.start),end:vb.indexToPosition(ha.decl.end)};vb.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(vb){vb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(vb){vb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(vb,ha){ha=void 0===ha?{direction:null}:ha;var Ha=vb.pluginInvokeFirst("getNavigator");if(!Ha)return!0;Ha=Ha.resolveIdentifierAt(vb,
vb.cursorPosition);if(!Ha||!Ha.refs)return eb.show("No symbol identifier selected"),!0;var W=vb.selection;Ha=Ha.refs.map(function(Za){var qb=Za.end;return eb.Range.fromPositions(eb.iToP(vb,Za.start),eb.iToP(vb,qb))}).concat(Ha.decl?eb.Range.fromPositions(eb.iToP(vb,Ha.decl.start),eb.iToP(vb,Ha.decl.end)):[]).sort(eb.Range.compare);if(!Ha.length)return!0;var ra=Ha.map(String).indexOf(String(W.range));if("next"===ha.direction||"prev"===ha.direction)-1===ra&&Ha.length?Ha=[Ha[0]]:(ha=ra+("next"===ha.direction?
1:-1),0>ha?ha=Ha.length-1:ha>=Ha.length&&(ha=0),Ha=[Ha[ha]]);Ha.forEach(function(Za){var qb=W.selections.findIndex(function(wd){return wd.range.equals(Za)}),sc=W.selections.length-1;-1<qb?eb.arr.swap(W.selections,qb,sc):W.addRange(Za,!1)});W.mergeSelections();return!0}}];eb.astEditorCommands=Ac;eb.astEditorCommands=Ac;eb.astEditorCommands=Ac;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var sb=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
sb.expressionAllowed=function(vb,ha,Ha){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(ha.lastType)||"quasi"==ha.lastType&&/\{\s*$/.test(vb.string.slice(0,vb.pos-(Ha||0)))};sb.passIndent=Jc;sb.defineMode=Nd;sb.defineMIME=ec;sb.registerHelper=Zd;sb.defaultConfig={indentUnit:2};sb.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};sb.defineMode("javascript",
function(vb,ha){function Ha(Rb,id,zc){zl=Rb;Hi=zc;return id}function W(Rb,id){var zc=Rb.next();if('"'==zc||"'"==zc)return id.tokenize=ra(zc),id.tokenize(Rb,id);if("."==zc&&Rb.match(/^\d+(?:[eE][+\-]?\d+)?/))return Ha("number","number");if("."==zc&&Rb.match(".."))return Ha("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(zc))return Ha(zc);if("="==zc&&Rb.eat(">"))return Ha("=>","operator");if("0"==zc&&Rb.eat(/x/i))return Rb.eatWhile(/[\da-f]/i),Ha("number","number");if("0"==zc&&Rb.eat(/o/i))return Rb.eatWhile(/[0-7]/i),
Ha("number","number");if("0"==zc&&Rb.eat(/b/i))return Rb.eatWhile(/[01]/i),Ha("number","number");if(/\d/.test(zc))return Rb.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),Ha("number","number");if("/"==zc){if(Rb.eat("*"))return id.tokenize=Za,Za(Rb,id);if(Rb.eat("/"))return Rb.skipToEnd(),Ha("comment","comment");if(sb.expressionAllowed(Rb,id,1)){a:for(var he=id=!1;null!=(zc=Rb.next());){if(!id){if("/"==zc&&!he)break a;"["==zc?he=!0:he&&"]"==zc&&(he=!1)}id=!id&&"\\"==zc}Rb.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return Ha("regexp","string-2")}Rb.eatWhile(Km);return Ha("operator","operator",Rb.current())}if("`"==zc)return id.tokenize=qb,qb(Rb,id);if("#"==zc)return Rb.skipToEnd(),Ha("error","error");if(Km.test(zc))return">"==zc&&id.lexical&&">"==id.lexical.type||Rb.eatWhile(Km),Ha("operator","operator",Rb.current());if(wl.test(zc))return Rb.eatWhile(wl),Rb=Rb.current(),(zc=$l.propertyIsEnumerable(Rb)&&$l[Rb])&&"."!=id.lastType?Ha(zc.type,zc.style,Rb):Ha("variable","variable",Rb)}function ra(Rb){return function(id,
zc){var he=!1,qg;if(Ri&&"@"==id.peek()&&id.match(Kl))return zc.tokenize=W,Ha("jsonld-keyword","meta");for(;null!=(qg=id.next())&&(qg!=Rb||he);)he=!he&&"\\"==qg;he||(zc.tokenize=W);return Ha("string","string")}}function Za(Rb,id){for(var zc=!1,he;he=Rb.next();){if("/"==he&&zc){id.tokenize=W;break}zc="*"==he}return Ha("comment","comment")}function qb(Rb,id){for(var zc=!1,he;null!=(he=Rb.next());){if(!zc&&("`"==he||"$"==he&&Rb.eat("{"))){id.tokenize=W;break}zc=!zc&&"\\"==he}return Ha("quasi","string-2",
Rb.current())}function sc(Rb,id){id.fatArrowAt&&(id.fatArrowAt=null);var zc=Rb.string.indexOf("=>",Rb.start);if(!(0>zc)){if(cl){var he=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Rb.string.slice(Rb.start,zc));he&&(zc=he.index)}he=0;var qg=!1;for(--zc;0<=zc;--zc){var Gg=Rb.string.charAt(zc),Uj="([{}])".indexOf(Gg);if(0<=Uj&&3>Uj){if(!he){++zc;break}if(0==--he){"("==Gg&&(qg=!0);break}}else if(3<=Uj&&6>Uj)++he;else if(wl.test(Gg))qg=!0;else{if(/["'\/]/.test(Gg))return;if(qg&&!he){++zc;break}}}qg&&
!he&&(id.fatArrowAt=zc)}}function wd(Rb,id,zc,he,qg,Gg){this.indented=Rb;this.column=id;this.type=zc;this.prev=qg;this.info=Gg;null!=he&&(this.align=he)}function nc(){for(var Rb=arguments.length-1;0<=Rb;Rb--)Bf.cc.push(arguments[Rb])}function Ob(){nc.apply(null,arguments);return!0}function $d(Rb){function id(he){for(;he;he=he.next)if(he.name==Rb)return!0;return!1}var zc=Bf.state;Bf.marked="def";zc.context?id(zc.localVars)||(zc.localVars={name:Rb,next:zc.localVars}):!id(zc.globalVars)&&ha.globalVars&&
(zc.globalVars={name:Rb,next:zc.globalVars})}function Id(){Bf.state.context={prev:Bf.state.context,vars:Bf.state.localVars};Bf.state.localVars=wo}function kb(){Bf.state.localVars=Bf.state.context.vars;Bf.state.context=Bf.state.context.prev}function Eb(Rb,id){var zc=function(){var he=Bf.state,qg=he.indented;if("stat"==he.lexical.type)qg=he.lexical.indented;else for(var Gg=he.lexical;Gg&&")"==Gg.type&&Gg.align;Gg=Gg.prev)qg=Gg.indented;he.lexical=new wd(qg,Bf.stream.column(),Rb,null,he.lexical,id)};
zc.lex=!0;return zc}function ad(){var Rb=Bf.state;Rb.lexical.prev&&(")"==Rb.lexical.type&&(Rb.indented=Rb.lexical.indented),Rb.lexical=Rb.lexical.prev)}function ub(Rb){function id(zc){return zc==Rb?Ob():";"==Rb?nc():Ob(id)}return id}function cd(Rb,id){return"var"==Rb?Ob(Eb("vardef",id.length),pc,ub(";"),ad):"keyword a"==Rb?Ob(Eb("form"),Ra,cd,ad):"keyword b"==Rb?Ob(Eb("form"),cd,ad):"{"==Rb?Ob(Eb("}"),yf,ad):";"==Rb?Ob():"if"==Rb?("else"==Bf.state.lexical.info&&Bf.state.cc[Bf.state.cc.length-1]==
ad&&Bf.state.cc.pop()(),Ob(Eb("form"),Ra,cd,ad,Na)):"function"==Rb?Ob(yb):"for"==Rb?Ob(Eb("form"),fb,cd,ad):"variable"==Rb?cl&&"type"==id?(Bf.marked="keyword",Ob(Ve,ub("operator"),Ve,ub(";"))):Ob(Eb("stat"),Tc):"switch"==Rb?Ob(Eb("form"),Ra,ub("{"),Eb("}","switch"),yf,ad,ad):"case"==Rb?Ob(Vc,ub(":")):"default"==Rb?Ob(ub(":")):"catch"==Rb?Ob(Eb("form"),Id,ub("("),Cc,ub(")"),cd,ad,kb):"class"==Rb?Ob(Eb("form"),jd,ad):"export"==Rb?Ob(Eb("stat"),kg,ad):"import"==Rb?Ob(Eb("stat"),Fh,ad):"module"==Rb?Ob(Eb("form"),
qh,ub("{"),Eb("}"),yf,ad,ad):"async"==Rb?Ob(cd):"@"==id?Ob(Vc,cd):nc(Eb("stat"),Vc,ub(";"),ad)}function Vc(Rb){return pb(Rb,!1)}function ib(Rb){return pb(Rb,!0)}function Ra(Rb){return"("!=Rb?nc():Ob(Eb(")"),Vc,ub(")"),ad)}function pb(Rb,id){if(Bf.state.fatArrowAt==Bf.stream.start){var zc=id?Va:va;if("("==Rb)return Ob(Id,Eb(")"),Se(qh,")"),ad,ub("=>"),zc,kb);if("variable"==Rb)return nc(Id,qh,ub("=>"),zc,kb)}zc=id?Aa:ma;return vo.hasOwnProperty(Rb)?Ob(zc):"function"==Rb?Ob(yb,zc):"class"==Rb?Ob(Eb("form"),
xc,ad):"keyword c"==Rb||"async"==Rb?Ob(id?Oc:bb):"("==Rb?Ob(Eb(")"),bb,ub(")"),ad,zc):"operator"==Rb||"spread"==Rb?Ob(id?ib:Vc):"["==Rb?Ob(Eb("]"),Al,ad,zc):"{"==Rb?Ze(se,"}",null,zc):"quasi"==Rb?nc(xb,zc):"new"==Rb?Ob(Db(id)):Ob()}function bb(Rb){return Rb.match(/[;\}\)\],]/)?nc():nc(Vc)}function Oc(Rb){return Rb.match(/[;\}\)\],]/)?nc():nc(ib)}function ma(Rb,id){return","==Rb?Ob(Vc):Aa(Rb,id,!1)}function Aa(Rb,id,zc){var he=0==zc?ma:Aa,qg=0==zc?Vc:ib;if("=>"==Rb)return Ob(Id,zc?Va:va,kb);if("operator"==
Rb)return/\+\+|--/.test(id)?Ob(he):"?"==id?Ob(Vc,ub(":"),qg):Ob(qg);if("quasi"==Rb)return nc(xb,he);if(";"!=Rb){if("("==Rb)return Ze(ib,")","call",he);if("."==Rb)return Ob(gd,he);if("["==Rb)return Ob(Eb("]"),bb,ub("]"),ad,he)}}function xb(Rb,id){return"quasi"!=Rb?nc():"${"!=id.slice(id.length-2)?Ob(xb):Ob(Vc,P)}function P(Rb){if("}"==Rb)return Bf.marked="string-2",Bf.state.tokenize=qb,Ob(xb)}function va(Rb){sc(Bf.stream,Bf.state);return nc("{"==Rb?cd:Vc)}function Va(Rb){sc(Bf.stream,Bf.state);return nc("{"==
Rb?cd:ib)}function Db(Rb){return function(id){return"."==id?Ob(Rb?Tb:mc):nc(Rb?ib:Vc)}}function mc(Rb,id){if("target"==id)return Bf.marked="keyword",Ob(ma)}function Tb(Rb,id){if("target"==id)return Bf.marked="keyword",Ob(Aa)}function Tc(Rb){return":"==Rb?Ob(ad,cd):nc(ma,ub(";"),ad)}function gd(Rb){if("variable"==Rb)return Bf.marked="property",Ob()}function se(Rb,id){if("async"==Rb)return Bf.marked="property",Ob(se);if("variable"==Rb||"keyword"==Bf.style)return Bf.marked="property","get"==id||"set"==
id?Ob(Cf):Ob(me);if("number"==Rb||"string"==Rb)return Bf.marked=Ri?"property":Bf.style+" property",Ob(me);if("jsonld-keyword"==Rb)return Ob(me);if("modifier"==Rb)return Ob(se);if("["==Rb)return Ob(Vc,ub("]"),me);if("spread"==Rb)return Ob(Vc);if(":"==Rb)return nc(me)}function Cf(Rb){if("variable"!=Rb)return nc(me);Bf.marked="property";return Ob(yb)}function me(Rb){if(":"==Rb)return Ob(ib);if("("==Rb)return nc(yb)}function Se(Rb,id,zc){function he(qg,Gg){return(zc?-1<zc.indexOf(qg):","==qg)?(qg=Bf.state.lexical,
"call"==qg.info&&(qg.pos=(qg.pos||0)+1),Ob(function(Uj,Xn){return Uj==id||Xn==id?nc():nc(Rb)},he)):qg==id||Gg==id?Ob():Ob(ub(id))}return function(qg,Gg){return qg==id||Gg==id?Ob():nc(Rb,he)}}function Ze(Rb,id,zc){for(var he=3;he<arguments.length;he++)Bf.cc.push(arguments[he]);return Ob(Eb(id,zc),Se(Rb,id),ad)}function yf(Rb){return"}"==Rb?Ob():nc(cd,yf)}function vd(Rb,id){if(cl){if(":"==Rb)return Ob(Ve);if("?"==id)return Ob(vd)}}function Ve(Rb){if("variable"==Rb)return Bf.marked="variable-3",Ob(Vg);
if("string"==Rb||"number"==Rb||"atom"==Rb)return Ob(Vg);if("{"==Rb)return Ob(Eb("}"),Se(cg,"}",",;"),ad);if("("==Rb)return Ob(Se(eg,")"),Ye)}function Ye(Rb){if("=>"==Rb)return Ob(Ve)}function cg(Rb,id){if("variable"==Rb||"keyword"==Bf.style)return Bf.marked="property",Ob(cg);if("?"==id)return Ob(cg);if(":"==Rb)return Ob(Ve)}function eg(Rb){if("variable"==Rb)return Ob(eg);if(":"==Rb)return Ob(Ve)}function Vg(Rb,id){if("<"==id)return Ob(Eb(">"),Se(Ve,">"),ad,Vg);if("|"==id||"."==Rb)return Ob(Ve);if("["==
Rb)return Ob(ub("]"),Vg);if("extends"==id)return Ob(Ve)}function pc(){return nc(qh,vd,nh,Jf)}function qh(Rb,id){if("modifier"==Rb)return Ob(qh);if("variable"==Rb)return $d(id),Ob();if("spread"==Rb)return Ob(qh);if("["==Rb)return Ze(qh,"]");if("{"==Rb)return Ze(rh,"}")}function rh(Rb,id){if("variable"==Rb&&!Bf.stream.match(/^\s*:/,!1))return $d(id),Ob(nh);"variable"==Rb&&(Bf.marked="property");return"spread"==Rb?Ob(qh):"}"==Rb?nc():Ob(ub(":"),qh,nh)}function nh(Rb,id){if("="==id)return Ob(ib)}function Jf(Rb){if(","==
Rb)return Ob(pc)}function Na(Rb,id){if("keyword b"==Rb&&"else"==id)return Ob(Eb("form","else"),cd,ad)}function fb(Rb){if("("==Rb)return Ob(Eb(")"),Jb,ub(")"),ad)}function Jb(Rb){return"var"==Rb?Ob(pc,ub(";"),Ia):";"==Rb?Ob(Ia):"variable"==Rb?Ob(da):nc(Vc,ub(";"),Ia)}function da(Rb,id){return"in"==id||"of"==id?(Bf.marked="keyword",Ob(Vc)):Ob(ma,Ia)}function Ia(Rb,id){return";"==Rb?Ob(nb):"in"==id||"of"==id?(Bf.marked="keyword",Ob(Vc)):nc(Vc,ub(";"),nb)}function nb(Rb){")"!=Rb&&Ob(Vc)}function yb(Rb,
id){if("*"==id)return Bf.marked="keyword",Ob(yb);if("variable"==Rb)return $d(id),Ob(yb);if("("==Rb)return Ob(Id,Eb(")"),Se(Cc,")"),ad,vd,cd,kb);if(cl&&"<"==id)return Ob(Eb(">"),Se(Ve,">"),ad,yb)}function Cc(Rb){return"spread"==Rb?Ob(Cc):nc(qh,vd,nh)}function xc(Rb,id){return"variable"==Rb?jd(Rb,id):ud(Rb,id)}function jd(Rb,id){if("variable"==Rb)return $d(id),Ob(ud)}function ud(Rb,id){if("<"==id)return Ob(Eb(">"),Se(Ve,">"),ad,ud);if("extends"==id||"implements"==id||cl&&","==Rb)return Ob(cl?Ve:Vc,
ud);if("{"==Rb)return Ob(Eb("}"),nd,ad)}function nd(Rb,id){if("variable"==Rb||"keyword"==Bf.style){if(("async"==id||"static"==id||"get"==id||"set"==id||cl&&("public"==id||"private"==id||"protected"==id||"readonly"==id||"abstract"==id))&&Bf.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Bf.marked="keyword",Ob(nd);Bf.marked="property";return Ob(cl?pf:yb,nd)}if("["==Rb)return Ob(Vc,ub("]"),cl?pf:yb,nd);if("*"==id)return Bf.marked="keyword",Ob(nd);if(";"==Rb)return Ob(nd);if("}"==Rb)return Ob();if("@"==
id)return Ob(Vc,nd)}function pf(Rb,id){return"?"==id?Ob(pf):":"==Rb?Ob(Ve,nh):"="==id?Ob(ib):nc(yb)}function kg(Rb,id){return"*"==id?(Bf.marked="keyword",Ob(bi,ub(";"))):"default"==id?(Bf.marked="keyword",Ob(Vc,ub(";"))):"{"==Rb?Ob(Se(Wf,"}"),bi,ub(";")):nc(cd)}function Wf(Rb,id){if("as"==id)return Bf.marked="keyword",Ob(ub("variable"));if("variable"==Rb)return nc(ib,Wf)}function Fh(Rb){return"string"==Rb?Ob():nc(Df,wh,bi)}function Df(Rb,id){if("{"==Rb)return Ze(Df,"}");"variable"==Rb&&$d(id);"*"==
id&&(Bf.marked="keyword");return Ob(ck)}function wh(Rb){if(","==Rb)return Ob(Df,wh)}function ck(Rb,id){if("as"==id)return Bf.marked="keyword",Ob(Df)}function bi(Rb,id){if("from"==id)return Bf.marked="keyword",Ob(Vc)}function Al(Rb){return"]"==Rb?Ob():nc(Se(ib,"]"))}vb=Object.assign({},sb.defaultConfig,{},vb);ha=Object.assign({},sb.defaultParserConfig,{},ha);var yg=vb.indentUnit,Vj=ha.statementIndent,Ri=ha.jsonld,Jk=ha.json||Ri,cl=ha.typescript,wl=ha.wordCharacters||/[\w$\xa1-\uffff]/,$l=function(){function Rb(Xn){return{type:Xn,
style:"keyword"}}var id=Rb("keyword a"),zc=Rb("keyword b"),he=Rb("keyword c"),qg=Rb("operator"),Gg={type:"atom",style:"atom"};id={if:Rb("if"),while:id,with:id,else:zc,do:zc,try:zc,finally:zc,return:he,break:he,continue:he,new:Rb("new"),delete:he,throw:he,debugger:he,var:Rb("var"),const:Rb("var"),let:Rb("var"),function:Rb("function"),catch:Rb("catch"),for:Rb("for"),switch:Rb("switch"),case:Rb("case"),default:Rb("default"),in:qg,typeof:qg,instanceof:qg,true:Gg,false:Gg,null:Gg,undefined:Gg,NaN:Gg,Infinity:Gg,
this:Rb("this"),class:Rb("class"),super:Rb("atom"),yield:he,export:Rb("export"),import:Rb("import"),extends:he,await:he,async:Rb("async")};if(cl){zc={type:"variable",style:"variable-3"};he={interface:Rb("class"),implements:he,namespace:he,module:Rb("module"),enum:Rb("module"),public:Rb("modifier"),private:Rb("modifier"),protected:Rb("modifier"),abstract:Rb("modifier"),as:qg,string:zc,number:zc,boolean:zc,any:zc};for(var Uj in he)id[Uj]=he[Uj]}return id}(),Km=/[+\-*&%=<>!?|~^@]/,Kl=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
zl,Hi,vo={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Bf={state:null,column:null,marked:null,cc:null},wo={name:"this",next:{name:"arguments"}};ad.lex=!0;return{startState:function(Rb){Rb={tokenize:W,lastType:"sof",cc:[],lexical:new wd((Rb||0)-yg,0,"block",!1),localVars:ha.localVars,context:ha.localVars&&{vars:ha.localVars},indented:Rb||0};ha.globalVars&&"object"===typeof ha.globalVars&&(Rb.globalVars=ha.globalVars);return Rb},token:function(Rb,id){Rb.sol()&&(id.lexical.hasOwnProperty("align")||
(id.lexical.align=!1),id.indented=Rb.indentation(),sc(Rb,id));if(id.tokenize!=Za&&Rb.eatSpace())return null;var zc=id.tokenize(Rb,id);if("comment"==zl)return zc;id.lastType="operator"!=zl||"++"!=Hi&&"--"!=Hi?zl:"incdec";a:{var he=zl,qg=Hi,Gg=id.cc;Bf.state=id;Bf.stream=Rb;Bf.marked=null;Bf.cc=Gg;Bf.style=zc;id.lexical.hasOwnProperty("align")||(id.lexical.align=!0);for(Rb=0;;){if(1E5<Rb++)throw Error("endless");if((Gg.length?Gg.pop():Jk?Vc:cd)(he,qg)){for(;Gg.length&&Gg[Gg.length-1].lex;)Gg.pop()();
if(Bf.marked){zc=Bf.marked;break a}if(he="variable"==he)b:{for(he=id.localVars;he;he=he.next)if(he.name==qg){he=!0;break b}for(id=id.context;id;id=id.prev)for(he=id.vars;he;he=he.next)if(he.name==qg){he=!0;break b}he=void 0}if(he){zc="variable-2";break a}break a}}}return zc},indent:function(Rb,id){if(Rb.tokenize==Za)return sb.passIndent;if(Rb.tokenize!=W)return 0;var zc=id&&id.charAt(0),he=Rb.lexical,qg;if(!/^\s*else\b/.test(id))for(var Gg=Rb.cc.length-1;0<=Gg;--Gg){var Uj=Rb.cc[Gg];if(Uj==ad)he=
he.prev;else if(Uj!=Na)break}for(;!("stat"!=he.type&&"form"!=he.type||"}"!=zc&&(!(qg=Rb.cc[Rb.cc.length-1])||qg!=ma&&qg!=Aa||/^[,\.=+\-*:?[\(]/.test(id)));)he=he.prev;Vj&&")"==he.type&&"stat"==he.prev.type&&(he=he.prev);qg=he.type;Gg=zc==qg;return(Uj=Rb._string)&&Uj.trimLeft().startsWith("?")&&":"===zc?Uj.indexOf("?"):Uj&&":"===Rb.lastType&&"}"!==he.type?Uj.match(/^\s*/)[0].length:"vardef"==qg?(id=he.indented+he.info+2+Rb.localVars.name.length,"?"===zc||":"===zc||"|"===zc||"&"===zc?id:","==Rb.lastType?
he.indented+he.info+1:"operator"==Rb.lastType?id+3:he.indented):"form"==qg&&"{"==zc?he.indented:"form"==qg?he.indented+yg:"stat"==qg?(zc=he.indented,Rb="operator"==Rb.lastType||","==Rb.lastType||Km.test(id.charAt(0))||/[,.]/.test(id.charAt(0)),zc+(Rb?Vj||yg:0)):"switch"!=he.info||Gg||0==ha.doubleIndentSwitch?he.align?he.column+(Gg?0:1):he.indented+(Gg?0:yg):he.indented+(/^(?:case|default)\b/.test(id)?yg:2*yg)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:Jk?null:"/*",blockCommentEnd:Jk?
null:"*/",lineComment:Jk?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:Jk?"json":"javascript",jsonldMode:Ri,jsonMode:Jk,expressionAllowed:sb.expressionAllowed,skipExpression:function(Rb){var id=Rb.cc[Rb.cc.length-1];id!=Vc&&id!=ib||Rb.cc.pop()}}});sb.registerHelper("wordChars","javascript",/[\w$]/);sb.defineMIME("text/javascript","javascript");sb.defineMIME("text/ecmascript","javascript");sb.defineMIME("application/javascript","javascript");sb.defineMIME("application/x-javascript",
"javascript");sb.defineMIME("application/ecmascript","javascript");sb.defineMIME("application/json",{name:"javascript",json:!0});sb.defineMIME("application/x-json",{name:"javascript",json:!0});sb.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});sb.defineMIME("text/typescript",{name:"javascript",typescript:!0});sb.defineMIME("application/typescript",{name:"javascript",typescript:!0});var Ab=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");Ab.string=$c;Ab.JavaScriptChecker=
Ld;Ab.JavaScriptNavigator=Hd;Ab.completers=Oa;Ab.jsSnippets=Ja;Ab.jsIdeCommands=Sb;Ab.jsEditorCommands=Qa;Ab.astEditorCommands=Ac;Ab.CodeMirrorEnabledEditorPlugin=le;Ab.Snippet=rb;Ab.parser=ke;Ab.localInterface=yc;Ab.systemInterfaceNamed=Gc;Ab.serverInterfaceFor=Qb;Ab.l2lInterfaceFor=Ec;Ld=function(vb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),Ha=ha.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof ha.JavaScriptEditorPlugin?ha.JavaScriptEditorPlugin:ha.JavaScriptEditorPlugin=
function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(Ha,vb,[{key:Symbol.for("lively-instance-initialize"),value:function(){Bb._get(Object.getPrototypeOf(Ha.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new Ab.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(W){Bb._get(Object.getPrototypeOf(Ha.prototype),"attach",this).call(this,W);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:W})}},{key:"detach",value:function(W){this.checker.uninstall(this.textMorph);Bb._get(Object.getPrototypeOf(Ha.prototype),"detach",this).call(this,W)}},{key:"getNavigator",value:function(){return new Ab.JavaScriptNavigator}},{key:"getCompleters",value:function(W){return Ab.completers.concat(W)}},
{key:"getCommands",value:function(W){return[].concat($jscomp.arrayFromIterable(Bb._get(Object.getPrototypeOf(Ha.prototype),"getCommands",this).call(this,W)),$jscomp.arrayFromIterable(Ab.jsIdeCommands),$jscomp.arrayFromIterable(Ab.jsEditorCommands),$jscomp.arrayFromIterable(Ab.astEditorCommands))}},{key:"getKeyBindings",value:function(W){return[].concat($jscomp.arrayFromIterable(W),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(W){var ra=this,Za,qb,sc,wd,nc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ob){Za=ra.textMorph;qb=[{command:"doit",target:Za,showKeyShortcuts:!0},{command:"inspectit",target:Za,showKeyShortcuts:!0},{command:"editit",target:Za,showKeyShortcuts:!0},{command:"printit",target:Za,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:Za,showKeyShortcuts:!0},{command:"eval all",target:Za,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:Za,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:Za,showKeyShortcuts:!0},{isDivider:!0}];ra.evalEnvironment.targetModule&&qb.push({command:"[javascript] inject import",alias:"add import",target:Za},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:Za},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:Za});sc=ra.getNavigator();(wd=sc.resolveIdentifierAt(Za,
Za.cursorPosition))&&qb.push({command:"selectDefinition",alias:'jump to definition of "'+wd.name+'"',target:Za},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+wd.name+'"',target:Za});(nc=Za.selection.text.trim())&&qb.push({command:"open code search",alias:'code search for "'+Ab.string.truncate(nc,30)+'"',target:Za.world(),args:{input:nc,backend:ra.backend()}});qb.push({isDivider:!0});return Ob.return(qb.concat(W))})}},{key:"getSnippets",value:function(){return Ab.jsSnippets.map(function(W){var ra=
$jscomp.makeIterator(W);W=ra.next().value;ra=ra.next().value;return new Ab.Snippet({trigger:W,expansion:ra})})}},{key:"sanatizedJsEnv",value:function(W){W=Object.assign({},this.evalEnvironment,{},W);W.format||(W.formatd="esm");W.context||(W.context=this.textMorph);W.sourceURL||(W.sourceURL=W.targetModule+"_doit_"+Date.now());W.systemInterface||(W.systemInterface=Ab.localInterface);return W}},{key:"backend",value:function(W){W=this.sanatizedJsEnv(W);return W.remote?W.remote:"local"}},{key:"systemInterface",
value:function(W){return this.sanatizedJsEnv(W).systemInterface||Ab.localInterface}},{key:"setSystemInterface",value:function(W){return this.evalEnvironment.systemInterface=W}},{key:"setSystemInterfaceNamed",value:function(W){return this.setSystemInterface(Ab.systemInterfaceNamed(W))}},{key:"runEval",value:function(W,ra){ra=this.sanatizedJsEnv(ra);return this.systemInterface(ra).runEval(W,ra)}},{key:"parser",get:function(){return Ab.parser}},{key:"parse",value:function(W){W=void 0===W?null:W;if(this._ast&&
this._ast._astType===W)return this._ast;var ra=this.parser,Za=this.textMorph.textString;if(!ra)return null;var qb={withComments:!0,allowReturnOutsideFunction:!0};W&&(qb.type=W);if(Za.startsWith("#!")){var sc=Za.indexOf("\n");Za=" ".repeat(sc)+Za.slice(sc)}ra=ra.fuzzyParse(Za,qb);ra._astType=W;return this._ast=ra}},{key:"undeclaredVariables",value:function(W){var ra=this.parser,Za=this.evalEnvironment.knownGlobals||[];W=this.parse(void 0===W?null:W);return ra&&W?ra.query.findGlobalVarRefs(W,{jslintGlobalComment:!0}).filter(function(qb){return!Za.includes(qb.name)}):
[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],ha,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(Ab.CodeMirrorEnabledEditorPlugin);Ld=Ab.JavaScriptEditorPlugin;Ca("default",Ld);Ab.default=Ld}}});
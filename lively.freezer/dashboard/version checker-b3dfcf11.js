System.register(["./__root_module__-37c88ebd.js","./index-02cc248f.js","kld-intersections","./index-9714fb53.js"],function(){var Wa,Ib,Sb,xc,ac;return{setters:[function(Cd){Wa=Cd.M;Ib=Cd.bc;Sb=Cd.r;xc=Cd.i},function(Cd){ac=Cd.e},function(){},function(){}],execute:function(){var Cd=lively.FreezerRuntime.recorderFor("VersionChecker/index.js");Cd.Morph=Wa;Cd.runCommand=Ib;Cd.evalOnServer=ac;Cd.resource=Sb;var nd=function(Ud){var bd=lively.FreezerRuntime.recorderFor("VersionChecker/index.js"),Ic=
bd.hasOwnProperty("VersionChecker")&&"function"===typeof bd.VersionChecker?bd.VersionChecker:bd.VersionChecker=function(pd){pd&&pd[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xc(Ic,Ud,[{key:"onLoad",value:function(){this.isComponent||this.withAllSubmorphsDo(function(pd){return pd.halosEnabled=!1})}},{key:"checkVersion",value:function(){this.reset();this.checkIfUpToDate()}},{key:"onMouseDown",value:function(pd){xc._get(Object.getPrototypeOf(Ic.prototype),
"onMouseDown",this).call(this,pd);this.isComponent||this.checkVersion()}},{key:"relayout",value:function(){var pd=this;this.world().withTopBarDo(function(yd){pd.bottomLeft=yd.sideBar&&yd.sideBar.visible?yd.sideBar.bottomRight.addXY(10,-10):pd.world().visibleBounds().insetBy(10).bottomLeft()})}},{key:"checkIfUpToDate",value:function(){var pd=this,yd,Ne,Pe,Ie,fd,me,Yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yc){switch(Yc.nextAddress){case 1:return yd="git rev-parse master",Yc.yield(Cd.evalOnServer("System.baseURL").then(function(Nd){return Nd.replace("file://",
"")}),2);case 2:return Ne=Yc.yieldResult,Yc.yield(Cd.runCommand("git fetch",{cwd:Ne}).whenDone(),3);case 3:return Yc.yield(Cd.runCommand(yd,{cwd:Ne}).whenDone(),4);case 4:return Pe=Yc.yieldResult,Ie=Pe.stdout,fd=Ie.split("\n")[0],Yc.yield(Cd.resource("https://api.github.com/repos/LivelyKernel/lively.next/commits/master").readJson(),5);case 5:return me=Yc.yieldResult,Yb=me.sha,fd!=Yb?Yc.return(pd.showOutdated(fd.slice(0,6))):Yc.return(pd.showUpToDate(fd.slice(0,6)))}})}},{key:"showOutdated",value:function(pd){var yd=
this.ui,Ne=yd.checking,Pe=yd.outdated;yd.status.value=["Version: ",{},"["+pd+"]",{fontWeight:"bold"}," (Please update!)"];Ne.visible=Ne.isLayoutable=!1;Pe.visible=Pe.isLayoutable=!0}},{key:"showUpToDate",value:function(pd){var yd=this.ui,Ne=yd.checking,Pe=yd.latest;yd.status.value=["Version: ",{},"["+pd+"]",{fontWeight:"bold"}];Ne.visible=Ne.isLayoutable=!1;Pe.visible=Pe.isLayoutable=!0}},{key:"reset",value:function(){var pd=this.ui,yd=pd.checking,Ne=pd.outdated,Pe=pd.latest;pd.status.value="Checking version...";
yd.visible=yd.isLayoutable=!0;Ne.visible=Pe.visible=Ne.isLayoutable=Pe.isLayoutable=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"VersionChecker"}},{key:"properties",get:function(){return{isEpiMorph:{derived:!0,get:function(){return!this.isComponent}},respondsToVisibleWindow:{derived:!0,get:function(){return!this.isComponent}},ui:{derived:!0,get:function(){return{status:this.get("version status label"),checking:this.get("loading indicator"),outdated:this.get("icon outdated"),
latest:this.get("icon latest")}}}}}}],bd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"VersionChecker",version:"0.1.1-27"}}},{start:232,end:2913})}(Cd.Morph);nd=Cd.VersionChecker;Cd.default=nd}}});
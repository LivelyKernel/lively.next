System.register(["./__root_module__-6d2e743c.js","kld-intersections","./index-ecae4ac2.js","./index-9d4f3df2.js","./editor-plugin-6888753a.js"],function(Ma){var rb,Db,hc,Kb,id,Zc,yd,Kc,sc,bd,hd,se,xe,ne,Rc,Pd,Hb,Gc,ud,Vc,Id,ie,Fb,Ac;return{setters:[function($c){rb=$c.i;Db=$c.bL;hc=$c.bM;Kb=$c.bN;id=$c.bO;Zc=$c.d;yd=$c.a1;Kc=$c.c;sc=$c.a6;bd=$c.bB;hd=$c.b;se=$c.a;xe=$c.bP;ne=$c.b0},function(){},function($c){Rc=$c.s},function($c){Pd=$c.localInterface;Hb=$c.systemInterfaceNamed;Gc=$c.serverInterfaceFor;ud=
$c.l2lInterfaceFor},function($c){Vc=$c.p;Id=$c.d;ie=$c.a;Fb=$c.r;Ac=$c.C}],execute:function(){var $c=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");$c.warnStyle={"border-bottom":"2px dotted orange"};$c.errorStyle={"background-color":"red"};var Bc=function(cc){var Vb=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),Ub=Vb.hasOwnProperty("JavaScriptChecker")&&"function"===typeof Vb.JavaScriptChecker?Vb.JavaScriptChecker:Vb.JavaScriptChecker=function(Ga){Ga&&Ga[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Ub,cc,[{key:"uninstall",value:function(Ga){var jb=Ga.text||Ga;(jb.markers||[]).forEach(function(X){return X.id.startsWith("js-checker-")&&jb.removeMarker(X)});jb.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(Ga,jb){return[].concat($jscomp.arrayFromIterable(Ga.embeddedMorphMap.values())).find(function(X){return jb.containsPosition(X.anchor.position)})}},{key:"onDocumentChange",value:function(Ga,
jb,X){var ha=jb.document;try{var Fa=X.parse()}catch(Ja){Fa=Ja}Fa&&(Ga=(jb.markers||[]).filter(function(Ja){return Ja.id.startsWith("js-checker-")}),X=X.undeclaredVariables().map(function(Ja,Ca){var ra=Ja.start;Ja=Ja.end;ra=ha.indexToPosition(ra);Ja=ha.indexToPosition(Ja);return jb.addMarker({id:"js-checker-"+Ca,style:$c.warnStyle,range:{start:ra,end:Ja},type:"js-undeclared-var"})}),Ga.slice(X.length).forEach(function(Ja){return jb.removeMarker(Ja)}),Fa.parseError?(Ga=Fa.parseError.loc,X=Ga.column,
Ga=Ga.line-1,Fa=ha.indexToPosition(Fa.parseError.pos),X=Fa.column,Ga=Fa.row,Fa={start:{column:X-1,row:Ga},end:{column:X+1,row:Ga}},this.hasEmbeddedMorphInRange(jb,Fa)||jb.addMarker({id:"js-syntax-error",range:Fa,style:$c.errorStyle,type:"js-syntax-error"})):jb.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],Vb,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),vd=Bc=$c.JavaScriptChecker;$c.default=Bc;var pb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");pb.query=Db;pb.fuzzyParse=hc;pb.acorn=Kb;pb.custom=id;var lb=function(cc){var Vb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),Ub=Vb.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof Vb.JavaScriptNavigator?
Vb.JavaScriptNavigator:Vb.JavaScriptNavigator=function(Ga){Ga&&Ga[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Ub,cc,[{key:"ensureAST",value:function(Ga){return this.parse(Ga.textString)}},{key:"parse",value:function(Ga){return pb.fuzzyParse(Ga)}},{key:"move",value:function(Ga,jb){var X=!!jb.activeMark||!jb.selection.isEmpty(),ha=jb.selection,Fa=jb.positionToIndex(ha.lead);Ga=this[Ga](jb.textString,Fa);Ga=jb.indexToPosition(Ga);
ha.lead=Ga;X||(ha.anchor=Ga);jb.scrollCursorIntoView()}},{key:"forwardSexp",value:function(Ga){this.move("_forwardSexp",Ga)}},{key:"backwardSexp",value:function(Ga){this.move("_backwardSexp",Ga)}},{key:"backwardUpSexp",value:function(Ga){this.move("_backwardUpSexp",Ga)}},{key:"forwardDownSexp",value:function(Ga){this.move("_forwardDownSexp",Ga)}},{key:"_forwardSexp",value:function(Ga,jb){Ga=this.parse(Ga);Ga=pb.custom.findNodesIncluding(Ga,jb).reverse().find(function(ha){return ha.end!==jb});if(!Ga)return jb;
if("BlockStatement"===Ga.type){var X=Ga.body.find(function(ha){return ha.start>jb});if(X)return X.start}return Ga.end}},{key:"_backwardSexp",value:function(Ga,jb){Ga=this.parse(Ga);Ga=pb.custom.findNodesIncluding(Ga,jb).reverse().find(function(ha){return ha.start!==jb});if(!Ga)return jb;if("BlockStatement"===Ga.type){var X=Ga.body.slice().reverse().find(function(ha){return ha.end<jb});if(X)return X.end}return Ga?Ga.start:jb}},{key:"_backwardUpSexp",value:function(Ga,jb){Ga=this.parse(Ga);return(Ga=
pb.custom.findNodesIncluding(Ga,jb).reverse().find(function(X){return X.start!==jb}))?Ga.start:jb}},{key:"_forwardDownSexp",value:function(Ga,jb){Ga=this.parse(Ga);return(Ga=pb.custom.findNodeAfter(Ga,jb,function(X,ha){return ha.start>jb}))?Ga.node.start:jb}},{key:"markDefun",value:function(Ga){var jb=this.rangeForFunctionOrDefinition(Ga.textString,[Ga.positionToIndex(Ga.selection.range.start),Ga.positionToIndex(Ga.selection.range.end)]);jb&&Ga.execCommand("expandRegion",{start:jb[0],end:jb[1]})}},
{key:"rangeForNodesMatching",value:function(Ga,jb,X){Ga=this.parse(Ga);return(jb=pb.custom.findNodesIncluding(Ga,jb).reverse().find(X))?[jb.start,jb.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(Ga,jb){var X=jb[0]===jb[1];return this.rangeForNodesMatching(Ga,jb[1],function(ha){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(ha.type)&&(X&&ha.end!==jb[1]||!X&&ha.start<jb[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(Ga,
jb){"number"!==typeof jb&&(jb=Ga.positionToIndex(jb));Ga=this.ensureAST(Ga);var X=pb.query.nodesAt(jb,Ga).reverse(),ha=X.find(function(Ja){return"Identifier"===Ja.type});if(!ha&&((X=X[0])&&X.type.includes("Specifier")&&X.local&&"Identifier"===X.local.type&&(ha=X.local),!ha))return;jb=(X=pb.query.findDeclarationClosestToIndex(Ga,ha.name,jb))?pb.query.scopeAtIndex(Ga,X.start):pb.query.scopeAtIndex(Ga,jb);var Fa=pb.query.findReferencesAndDeclsInScope(jb,ha.name).refs;return{parsed:Ga,scope:jb,id:ha,
name:ha.name,decl:X,refs:Fa}}},{key:"expandRegion",value:function(Ga,jb,X,ha){function Fa(tb){tb=Ga.positionToIndex({column:0,row:Ca.row});return{range:[tb+ra.start,tb+ra.start+ra.value.length],prev:ha}}var Ja=ha.range[0]!==ha.range[1],Ca=Ga.indexToPosition(ha.range[0]),ra=Ga.tokenAt(Ca);if(!Ja&&ra&&["keyword","identifier"].includes(ra.type))return Fa();X=X||this.parse(jb);jb=pb.query.nodesAtIndex(X,ha.range[0]).reverse().find(function(tb){return tb.start<ha.range[0]||tb.end>ha.range[1]});if(!jb)return ha;
X=jb.start;Ja=jb.end;return"Literal"===jb.type&&(jb.raw||"").match(/^['"`]/)&&ha.range[0]!==jb.start&&ha.range[1]!==jb.end&&(jb.start+1<ha.range[0]||jb.end-1>ha.range[1])?{range:[X+1,Ja-1],prev:ha}:{range:[X,Ja],prev:ha}}},{key:"contractRegion",value:function(Ga,jb,X,ha){return ha.prev||ha}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],Vb,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6780})}(void 0);Bc=lb=pb.JavaScriptNavigator;pb.default=lb;var Zb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");Zb.addIndexToTextPos=function(cc,Vb,Ub){return cc.indexToPosition(cc.positionToIndex(Vb)+Ub)};Zb.connect=Zc;Zb.disconnect=yd;Zb.string=Kc;Zb.KeyHandler=sc;Zb.Range=bd;lb=function(cc){var Vb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),
Ub=Vb.hasOwnProperty("Snippet")&&"function"===typeof Vb.Snippet?Vb.Snippet:Vb.Snippet=function(Ga){Ga&&Ga[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Ub,cc,[{key:Symbol.for("lively-instance-initialize"),value:function(Ga){Ga=void 0===Ga?{trigger:null,expansion:""}:Ga;var jb=Ga.expansion;this.trigger=Ga.trigger;this.expansion=jb;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(Ga){this.isExpanding&&
(this.textMorph=Ga,Zb.connect(this.textMorph,"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(Ga){this.isExpanding&&(Zb.disconnect(Ga,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var Ga=this.expansionState,jb=Ga.startAnchor,X=Ga.endAnchor;Ga.isExpanding?Zb.Range.fromPositions(jb.position,X.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",
value:function(){var Ga=this.textMorph;if(Ga){var jb=this.expansionState||{},X=jb.marker,ha=jb.startAnchor,Fa=jb.endAnchor;jb=jb.steps;ha&&Ga.removeAnchor(ha);Fa&&Ga.removeAnchor(Fa);X&&Ga.removeMarker(X);jb.forEach(function(Ja){return Ga.removeAnchor(Ja.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};Ga&&Ga.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(Ga){var jb=
[],X=0;Zb.string.reMatches(Ga,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(ha){var Fa=ha.start,Ja=ha.end;ha=ha.match;var Ca="";ha.startsWith("${")?(Ca=$jscomp.makeIterator(ha.match(/^\$\{([0-9]+):([^\}]*)\}/)),Ca.next(),ha=Ca.next().value,Ca=Ca.next().value,ha=Number(ha)):ha=Number(ha.replace(/^\$/,""));Ga=Ga.slice(0,Fa-X)+Ca+Ga.slice(Ja-X);jb[ha]={index:Fa-X,prefill:Ca,anchor:null};X+=Ja-Fa-Ca.length});return{steps:jb,expansion:Ga}}},{key:"expandAtCursor",value:function(Ga){var jb=Ga.selection,
X=Ga.cursorPosition.column,ha=this.expansion;this.trigger&&(X-=this.trigger.length);if(X=Math.max(0,X))ha=Zb.string.lines(ha),ha=[ha[0]].concat($jscomp.arrayFromIterable(ha.slice(1).map(function(Na){return Zb.string.indent(Na," ",X)}))),ha=ha.join("\n");var Fa=this.createExpansionSteps(ha);ha=Fa.expansion;Fa=Fa.steps;this.trigger&&jb.growLeft(this.trigger.length);jb.text=ha;var Ja=jb.start;ha=jb.end;jb.collapseToEnd();if(Fa.length){var Ca=Zb.string.newUUID();Fa.forEach(function(Na,lc){return Na.anchor=
Ga.addAnchor(Object.assign({id:"snippet-step-"+lc+"-"+Ca},Zb.addIndexToTextPos(Ga,Ja,Na.index)))});var ra=Ga.addAnchor(Object.assign({id:"snippet-start-"+Ca},Ja,{insertBehavior:"stay"})),tb=Ga.addAnchor(Object.assign({id:"snippet-end-"+Ca},ha));this.expansionState={marker:Ga.addMarker({id:"snippet-marker-"+Ca,get range(){return{start:ra.position,end:tb.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",
content:"fooooo"}}),startAnchor:ra,endAnchor:tb,stepIndex:0,steps:Fa,isExpanding:!0};Ga.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var Ga=this.expansionState,jb=Ga.steps,X=this.textMorph;if(Ga.isExpanding&&X){X=X.selection;Ga=jb[Ga.stepIndex];var ha=Ga.prefill;X.lead=X.anchor=Ga.anchor.position;X.growRight(ha.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=jb.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},
{key:"canExpand",value:function(Ga,jb){jb=Ga.positionToIndex(Ga.cursorPosition);return Ga.textString.slice(jb-this.trigger.length,jb)===this.trigger}},{key:"tryTrigger",value:function(Ga,jb){if(!this.canExpand(Ga,Ga.cursorPosition))return!1;this.expandAtCursor(Ga);return!0}},{key:"getCommands",value:function(Ga){var jb=this;return Ga.concat([{name:"[snippet] next expansion step",exec:function(X){jb.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(X){jb.resetExpansionState();
return!0}}])}},{key:"getKeyHandlers",value:function(Ga){return Ga.concat(Zb.KeyHandler.withBindings([{keys:"Tab",command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],Vb,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:357,end:6029})}(void 0);Zb.Snippet=lb;Zb.Snippet=lb;Zb.Snippet=lb;var Mb=[{name:"get snippets",exec:function(cc){return cc.pluginCollect("getSnippets",[])}}];Zb.snippetCommands=Mb;Zb.snippetCommands=Mb;Zb.snippetCommands=Mb;var ub=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");ub.buildEvalOpts=function(cc,Vb){return cc.plugins.find(function(Ub){return Ub.isJSEditorPlugin}).sanatizedJsEnv(Vb)};ub.Snippet=lb;Mb=function(cc){var Vb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),
Ub=Vb.hasOwnProperty("ModuleTopLevelVarCompleter")&&"function"===typeof Vb.ModuleTopLevelVarCompleter?Vb.ModuleTopLevelVarCompleter:Vb.ModuleTopLevelVarCompleter=function(Ga){Ga&&Ga[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Ub,cc,[{key:"compute",value:function(Ga,jb){var X,ha,Fa,Ja,Ca,ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress){ha=(X=Ga.pluginFind(function(Na){return Na.isJSEditorPlugin}))&&
X.systemInterface();if(!ha)return tb.return([]);Fa=ub.buildEvalOpts(Ga);Ja=Fa.targetModule;return"local"===ha.name?(Ca=Object.getOwnPropertyNames(ha.getModule(Ja).recorder),tb.jumpTo(2)):tb.yield(ha.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+
Ja+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',{targetModule:"lively://module-recorder-completer"}),3)}if(2!=tb.nextAddress){ra=tb.yieldResult;if(ra.isError)return tb.return([]);Ca=JSON.parse(ra.value)}Ca=Ca.filter(function(Na){return!Na.startsWith("defVar_")&&!["System","__currentLivelyModule",
"initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(Na)});return tb.return(Ca.map(function(Na){return{priority:1100,completion:Na}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],Vb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:227,end:1700})}(void 0);ub.ModuleTopLevelVarCompleter=Mb;ub.ModuleTopLevelVarCompleter=Mb;ub.ModuleTopLevelVarCompleter=Mb;Mb=function(cc){var Vb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ub=Vb.hasOwnProperty("DynamicJavaScriptCompleter")&&"function"===typeof Vb.DynamicJavaScriptCompleter?Vb.DynamicJavaScriptCompleter:Vb.DynamicJavaScriptCompleter=function(Ga){Ga&&Ga[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return rb(Ub,cc,[{key:"isValidPrefix",value:function(Ga){return/\.[a-z0-9_]*$/i.test(Ga)}},{key:"isMethodCallCompletion",value:function(Ga){return Ga.endsWith(")")&&0<Ga.indexOf("(")}},{key:"isValidIdentifier",value:function(Ga){if("string"!==typeof Ga)return!1;this.isMethodCallCompletion(Ga)&&(Ga=Ga.slice(0,Ga.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(Ga)?!0:!1}},{key:"wrapInBrackets",value:function(Ga){if(!isNaN(Number(Ga))||Ga.startsWith("Symbol."))return"["+Ga+"]";var jb="";this.isMethodCallCompletion(Ga)&&
(jb=Ga.slice(Ga.indexOf("(")),Ga=Ga.slice(0,Ga.indexOf("(")));return'["'+Ga.replace(/"/g,'\\"')+'"]'+jb}},{key:"compute",value:function(Ga){var jb=this,X,ha,Fa,Ja,Ca,ra,tb,Na,lc,kd,Tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(md){if(1==md.nextAddress){X=Ga.selection;X.isEmpty()?(ha=Ga.getLine(X.lead.row),ha=ha.slice(ha.lastIndexOf(":")+1,X.lead.column)):ha=X.text.slice(Math.max(0,X.text.indexOf(":")),0);if(!jb.isValidPrefix(ha))return md.return([]);Ja=(Fa=Ga.pluginFind(function(wb){return wb.isJSEditorPlugin}))&&
Fa.systemInterface();if(!Ja)return md.return([]);Ca=ub.buildEvalOpts(Ga);return md.yield(Ja.dynamicCompletionsForPrefix(Ca.targetModule,ha,Ca),2)}ra=md.yieldResult;tb=ra.isError;Na=ra.value;lc=ra.completions;kd=ra.prefix;if(tb)return console.warn("javascript completer encountered error: "+(Na.stack||Na)),md.return([]);lc.reduce(function(wb,je){je=$jscomp.makeIterator(je);je.next();je=je.next().value;return wb+je.length},0);Tb=lc.reduce(function(wb,je,bf){je=$jscomp.makeIterator(je);var Wc=je.next().value;
je=je.next().value;return wb.concat(je.map(function(xb){var ze=jb.isValidIdentifier(xb);return{info:Wc,completion:xb,prefix:ze?kd:"."+kd,customInsertionFn:ze?jb.isMethodCallCompletion(xb)?function(yb,nb,Ha,R){nb=R.start;R=R.end;yb=yb.replace(/\((.*)\)/,function(xa){return"("+xa.slice(1,-1).split(", ").map(function($a,Ab){return"${"+Ab+":"+$a+"}"}).join(", ")+")"});yb=new ub.Snippet({expansion:yb});Ha.replace({start:nb,end:R},"");yb.expandAtCursor(Ha)}:null:function(yb,nb,Ha,R){yb=R.start;R=R.end;
nb={row:yb.row,column:yb.column-1};R="."===Ha.textInRange({start:nb,end:yb})?{start:nb,end:R}:{start:yb,end:R};Ha.replace(R,jb.wrapInBrackets(xb))}}}))},[]);Tb.forEach(function(wb,je){return Object.assign(wb,{priority:2E3+Tb.length-je})});return md.return(Tb)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DynamicJavaScriptCompleter"}}],Vb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5155})}(void 0);ub.DynamicJavaScriptCompleter=Mb;ub.DynamicJavaScriptCompleter=Mb;ub.DynamicJavaScriptCompleter=Mb;ub.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
Mb=function(cc){var Vb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ub=Vb.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof Vb.JavaScriptKeywordCompleter?Vb.JavaScriptKeywordCompleter:Vb.JavaScriptKeywordCompleter=function(Ga){Ga&&Ga[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Ub,cc,[{key:"compute",value:function(Ga,jb){return ub.keywords.map(function(X){return{completion:X,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],Vb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6157,end:6295})}(void 0);ub.JavaScriptKeywordCompleter=Mb;ub.JavaScriptKeywordCompleter=Mb;ub.JavaScriptKeywordCompleter=Mb;Mb=[new ub.DynamicJavaScriptCompleter,
new ub.JavaScriptKeywordCompleter,new ub.ModuleTopLevelVarCompleter];ub.completers=Mb;ub.completers=Mb;ub.completers=Mb;var rc=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");rc.Snippet=lb;var Ua=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];rc.snippets=Ua;rc.snippets=Ua;rc.snippets=Ua;var Lb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");Lb.getEvalEnv=function(cc){return(cc=cc.pluginFind(function(Vb){return Vb.isJSEditorPlugin}))?cc.evalEnvironment:null};Lb.setEvalEnv=function(cc,Vb){(cc=cc.pluginFind(function(Ub){return Ub.isJSEditorPlugin}))&&Object.assign(cc.evalEnvironment,Vb);return cc.evalEnvironment};
Lb.pToI=function(cc,Vb){return cc.positionToIndex(Vb)};Lb.iToP=function(cc,Vb){return cc.indexToPosition(Vb)};Lb.arr=hd;Lb.promise=se;Lb.string=Kc;Lb.show=Rc;Lb.Range=bd;Lb.query=Db;Lb.BaseVisitor=xe;rc=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(cc,Vb){Vb=void 0===Vb?{varName:null,position:null}:Vb;var Ub,Ga,jb,X,ha,Fa,Ja,Ca,ra,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Na){switch(Na.nextAddress){case 1:Ub=
Vb;Ga=Ub.varName;jb=Ub.position;if(!Ga){jb||(jb=cc.cursorPosition);X=cc.pluginInvokeFirst("getNavigator");ha=X.ensureAST(cc);Fa=Lb.query.nodesAt(cc.positionToIndex(jb),ha).reverse().find(function(lc){return"Identifier"===lc.type});if(!Fa)return cc.showError(Error("no identifier found!")),Na.return(!0);Ga=Fa.name}Vb=cc.pluginFind(function(lc){return lc.isJSEditorPlugin}).sanatizedJsEnv();Ja='lively.modules.module("'+Vb.targetModule+'").undefine("'+Ga+'")';Na.setCatchFinallyBlocks(2);return Na.yield(cc.doEval(null,
Vb,Ja),4);case 4:Ca=Na.yieldResult;ra=Ca.error?Ca.error:Ca.isError?Ca.value:null;Na.leaveTryBlock(3);break;case 2:ra=tb=Na.enterCatchBlock();case 3:return ra?cc.showError(ra):cc.setStatusMessage(Ga+" undefined"),Na.return(!0)}})}},{name:"change doitContext",exec:function(cc){var Vb,Ub,Ga,jb,X;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){if(1==ha.nextAddress)return Vb=$jscomp,Ub=Vb.makeIterator,ha.yield(cc.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(Fa){return!Fa.isUsedAsEpiMorph()}}),2);Ga=Ub.call(Vb,ha.yieldResult);if(jb=Ga.next().value)X="reset"===jb,cc.doitContext=X?null:jb,cc.setStatusMessage(X?"doitContext is now\n"+jb:"doitContext reset");return ha.return(!0)})}},{name:"change eval backend",exec:function(cc,Vb){Vb=void 0===Vb?{backend:void 0}:Vb;var Ub,Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(jb){if(1==jb.nextAddress)return Ub=Vb,Ga=Ub.backend,void 0!==Ga?jb.jumpTo(2):
jb.yield(cc.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=jb.nextAddress&&(Ga=jb.yieldResult,!Ga))return cc.setStatusMessage("Canceled"),jb.return(!0);"local"===Ga&&(Ga=null);cc.setStatusMessage("Eval backend is now "+(Ga||"local"));return jb.return(Lb.setEvalEnv(cc,{remote:Ga}))})}},{name:"copy current module name to clipboard",exec:function(cc){var Vb=cc.evalEnvironment.targetModule;cc.setStatusMessage(Vb||"Cannot find module name");cc.env.eventDispatcher.killRing.add(cc);
cc.env.eventDispatcher.doCopy(Vb);return!0}}];Lb.jsEditorCommands=rc;Lb.jsEditorCommands=rc;Lb.jsEditorCommands=rc;var mb=[{name:"[javascript] list errors and warnings",exec:function(cc){var Vb,Ub,Ga,jb,X;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){if(1==ha.nextAddress){Vb=(cc.markers||[]).filter(function(Fa){Fa=Fa.type;return"js-undeclared-var"===Fa||"js-syntax-error"===Fa});if(!Vb.length)return Lb.show("no warnings or errors"),ha.return(!0);Ub=Vb.map(function(Fa){var Ja=Fa.range;
return{isListItem:!0,string:"["+Fa.type.split("-").slice(1).join(" ")+"] "+cc.textInRange(Ja),value:Ja}});return ha.yield(cc.world().filterableListPrompt("jump to warning or error",Ub),2)}Ga=ha.yieldResult;jb=$jscomp.makeIterator(Ga.selected);if(X=jb.next().value)cc.saveMark(),cc.selection=X,cc.centerRow(X.start.row);return ha.return(!0)})}},{name:"[javascript] inject import",exec:function(cc,Vb){Vb=void 0===Vb?{gotoImport:!1,insertImportAtCursor:!0}:Vb;var Ub,Ga,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){switch(X.nextAddress){case 1:return X.yield(Lb.promise.delay(0),
2);case 2:return X.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return Ub=X.yieldResult,Ga=Ub.interactivelyInjectImportIntoText,X.yield(Ga(cc,Vb),4);case 4:return(jb=X.yieldResult)||cc.setStatusMessage("canceled"),X.return(jb)}})}},{name:"[javascript] fix undeclared variables",exec:function(cc,Vb){Vb=void 0===Vb?{ignore:[],autoApplyIfSingleChoice:!1,requester:cc}:Vb;var Ub,Ga,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){if(1==X.nextAddress)return X.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=X.nextAddress)return Ub=X.yieldResult,Ga=Ub.interactivlyFixUndeclaredVariables,X.yield(Ga(cc,Vb),3);jb=X.yieldResult;cc.focus();return X.return(jb)})}},{name:"[javascript] remove unused imports",exec:function(cc,Vb){Vb=void 0===Vb?{query:!0}:Vb;var Ub,Ga,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){if(1==X.nextAddress)return X.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=X.nextAddress)return Ub=X.yieldResult,Ga=Ub.cleanupUnusedImports,X.yield(Ga(cc,
Vb),3);jb=X.yieldResult;cc.setStatusMessage(jb);return X.return(!0)})}},{name:"[javascript] eslint report",exec:function(cc){var Vb,Ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){if(1==Ga.nextAddress)return Ga.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);Vb=Ga.yieldResult;Ub=Vb.default;try{return Ga.return(Ub.reportOnMorph(cc))}catch(jb){cc.showError(jb)}Ga.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(cc){var Vb,Ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){if(1==
Ga.nextAddress)return Ga.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);Vb=Ga.yieldResult;Ub=Vb.default;try{return Ga.return(Ub.previewFixesOnMorph(cc))}catch(jb){cc.showError(jb)}Ga.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(cc,Vb,Ub){function Ga(md,wb){wb||(wb=Ca(md,{allowReturnOutsideFunction:!0}));var je=Lb.string.lineRanges(md),bf=md.split("\n"),Wc=[],xb=new Lb.BaseVisitor,ze=xb.visitVariableDeclaration;xb.visitVariableDeclaration=
function(R,xa,$a){if(1<R.declarations.length)for(var Ab=Lb.string.findLineWithIndexInLineRanges(je,R.start),bc=R.declarations[0].start-je[Ab][0],Ec={},pc=1;pc<R.declarations.length;Ec={$jscomp$loop$prop$actionType$2765:Ec.$jscomp$loop$prop$actionType$2765,$jscomp$loop$prop$arg$2766:Ec.$jscomp$loop$prop$arg$2766},pc++){var wd=R.declarations[pc],xd=Lb.string.findLineWithIndexInLineRanges(je,wd.start);if(Ab!==xd){var Se=bf[xd].match(/\s*/)[0].length;Se=bc-Se;0!==Se&&(wd=Lb.string.findLineWithIndexInLineRanges(je,
wd.end),Ec.$jscomp$loop$prop$actionType$2765=0<Se?"insert":"delete",Ec.$jscomp$loop$prop$arg$2766=0<Se?" ".repeat(Se):-Se,Wc.push.apply(Wc,$jscomp.arrayFromIterable(Lb.arr.range(xd,wd).map(function(v){return function(Ie){return[v.$jscomp$loop$prop$actionType$2765,je[Ie][0],v.$jscomp$loop$prop$arg$2766]}}(Ec)))))}}return ze.call(xb,R,xa,$a)};xb.accept(wb,{},[]);for(wb=Wc.length;wb--;){var yb=$jscomp.makeIterator(Wc[wb]),nb=yb.next().value,Ha=yb.next().value;yb=yb.next().value;"insert"===nb?md=md.slice(0,
Ha)+yb+md.slice(Ha):"delete"===nb&&(md=md.slice(0,Ha)+md.slice(Ha+yb))}return md}var jb,X,ha,Fa,Ja,Ca,ra,tb,Na,lc,kd,Tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(md){switch(md.nextAddress){case 1:return jb=Ub||Math.floor(cc.width/cc.defaultCharExtent().width),Vb=Object.assign({printWidth:jb,tabWidth:2,useTabs:!1,bracketSpacing:!1},Vb),X=lively.modules.module,ha=System.normalizeSync("prettier/standalone.js"),md.yield(X(ha).load({format:"global",instrument:!1}),2);case 2:return Fa=
md.yieldResult,md.yield(X("lively.ast/lib/acorn-extension.js").load(),3);case 3:return md.yield(X("lively.ast").load(),4);case 4:return Ja=md.yieldResult,Ca=Ja.parse,md.yield(X("lively.ast/lib/query.js").load(),5);case 5:return md.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return ra=md.yieldResult,tb=cc.selection.isEmpty()?cc.documentRange:cc.selection.range,Na=cc.positionToIndex(tb.start),lc=cc.positionToIndex(tb.end),kd=Fa.format(cc.textString,Object.assign({},
Vb,{rangeStart:Na,rangeEnd:lc,parser:function(wb,je,bf){return Ca(wb,{allowReturnOutsideFunction:!0})}})),cc.undoManager.group(),Tb=ra.diffChars(cc.textString,kd),cc.applyJsDiffPatch(Tb),cc.selection.text=Ga(cc.selection.text),cc.undoManager.group(),md.return(!0)}})}}];Lb.jsIdeCommands=mb;Lb.jsIdeCommands=mb;Lb.jsIdeCommands=mb;var Gb=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(cc,Vb){Vb=cc.pluginInvokeFirst("getNavigator");if(!Vb)return!0;Vb=Vb.resolveIdentifierAt(cc,cc.cursorPosition);
if(!Vb||!Vb.id)return Lb.show("No symbol identifier selected"),!0;if(!Vb.decl)return Lb.show("Cannot find declaration of "+Vb.name),!0;cc.saveMark();cc.selection={start:cc.indexToPosition(Vb.decl.start),end:cc.indexToPosition(Vb.decl.end)};cc.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(cc){cc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(cc){cc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(cc,Vb){Vb=void 0===Vb?{direction:null}:Vb;var Ub=cc.pluginInvokeFirst("getNavigator");if(!Ub)return!0;Ub=Ub.resolveIdentifierAt(cc,
cc.cursorPosition);if(!Ub||!Ub.refs)return Lb.show("No symbol identifier selected"),!0;var Ga=cc.selection;Ub=Ub.refs.map(function(X){var ha=X.end;return Lb.Range.fromPositions(Lb.iToP(cc,X.start),Lb.iToP(cc,ha))}).concat(Ub.decl?Lb.Range.fromPositions(Lb.iToP(cc,Ub.decl.start),Lb.iToP(cc,Ub.decl.end)):[]).sort(Lb.Range.compare);if(!Ub.length)return!0;var jb=Ub.map(String).indexOf(String(Ga.range));if("next"===Vb.direction||"prev"===Vb.direction)-1===jb&&Ub.length?Ub=[Ub[0]]:(Vb=jb+("next"===Vb.direction?
1:-1),0>Vb?Vb=Ub.length-1:Vb>=Ub.length&&(Vb=0),Ub=[Ub[Vb]]);Ub.forEach(function(X){var ha=Ga.selections.findIndex(function(Ja){return Ja.range.equals(X)}),Fa=Ga.selections.length-1;-1<ha?Lb.arr.swap(Ga.selections,ha,Fa):Ga.addRange(X,!1)});Ga.mergeSelections();return!0}}];Lb.astEditorCommands=Gb;Lb.astEditorCommands=Gb;Lb.astEditorCommands=Gb;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var vc=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
vc.expressionAllowed=function(cc,Vb,Ub){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(Vb.lastType)||"quasi"==Vb.lastType&&/\{\s*$/.test(cc.string.slice(0,cc.pos-(Ub||0)))};vc.passIndent=Vc;vc.defineMode=Id;vc.defineMIME=ie;vc.registerHelper=Fb;vc.defaultConfig={indentUnit:2};vc.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};vc.defineMode("javascript",
function(cc,Vb){function Ub(Ob,Nc,fe){ni=Ob;wg=fe;return Nc}function Ga(Ob,Nc){var fe=Ob.next();if('"'==fe||"'"==fe)return Nc.tokenize=jb(fe),Nc.tokenize(Ob,Nc);if("."==fe&&Ob.match(/^\d+(?:[eE][+\-]?\d+)?/))return Ub("number","number");if("."==fe&&Ob.match(".."))return Ub("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(fe))return Ub(fe);if("="==fe&&Ob.eat(">"))return Ub("=>","operator");if("0"==fe&&Ob.eat(/x/i))return Ob.eatWhile(/[\da-f]/i),Ub("number","number");if("0"==fe&&Ob.eat(/o/i))return Ob.eatWhile(/[0-7]/i),
Ub("number","number");if("0"==fe&&Ob.eat(/b/i))return Ob.eatWhile(/[01]/i),Ub("number","number");if(/\d/.test(fe))return Ob.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),Ub("number","number");if("/"==fe){if(Ob.eat("*"))return Nc.tokenize=X,X(Ob,Nc);if(Ob.eat("/"))return Ob.skipToEnd(),Ub("comment","comment");if(vc.expressionAllowed(Ob,Nc,1)){a:for(var ge=Nc=!1;null!=(fe=Ob.next());){if(!Nc){if("/"==fe&&!ge)break a;"["==fe?ge=!0:ge&&"]"==fe&&(ge=!1)}Nc=!Nc&&"\\"==fe}Ob.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return Ub("regexp","string-2")}Ob.eatWhile(ei);return Ub("operator","operator",Ob.current())}if("`"==fe)return Nc.tokenize=ha,ha(Ob,Nc);if("#"==fe)return Ob.skipToEnd(),Ub("error","error");if(ei.test(fe))return">"==fe&&Nc.lexical&&">"==Nc.lexical.type||Ob.eatWhile(ei),Ub("operator","operator",Ob.current());if($g.test(fe))return Ob.eatWhile($g),Ob=Ob.current(),(fe=Hf.propertyIsEnumerable(Ob)&&Hf[Ob])&&"."!=Nc.lastType?Ub(fe.type,fe.style,Ob):Ub("variable","variable",Ob)}function jb(Ob){return function(Nc,
fe){var ge=!1,Mf;if(Cf&&"@"==Nc.peek()&&Nc.match(Gh))return fe.tokenize=Ga,Ub("jsonld-keyword","meta");for(;null!=(Mf=Nc.next())&&(Mf!=Ob||ge);)ge=!ge&&"\\"==Mf;ge||(fe.tokenize=Ga);return Ub("string","string")}}function X(Ob,Nc){for(var fe=!1,ge;ge=Ob.next();){if("/"==ge&&fe){Nc.tokenize=Ga;break}fe="*"==ge}return Ub("comment","comment")}function ha(Ob,Nc){for(var fe=!1,ge;null!=(ge=Ob.next());){if(!fe&&("`"==ge||"$"==ge&&Ob.eat("{"))){Nc.tokenize=Ga;break}fe=!fe&&"\\"==ge}return Ub("quasi","string-2",
Ob.current())}function Fa(Ob,Nc){Nc.fatArrowAt&&(Nc.fatArrowAt=null);var fe=Ob.string.indexOf("=>",Ob.start);if(!(0>fe)){if(Bh){var ge=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Ob.string.slice(Ob.start,fe));ge&&(fe=ge.index)}ge=0;var Mf=!1;for(--fe;0<=fe;--fe){var jg=Ob.string.charAt(fe),fi="([{}])".indexOf(jg);if(0<=fi&&3>fi){if(!ge){++fe;break}if(0==--ge){"("==jg&&(Mf=!0);break}}else if(3<=fi&&6>fi)++ge;else if($g.test(jg))Mf=!0;else{if(/["'\/]/.test(jg))return;if(Mf&&!ge){++fe;break}}}Mf&&
!ge&&(Nc.fatArrowAt=fe)}}function Ja(Ob,Nc,fe,ge,Mf,jg){this.indented=Ob;this.column=Nc;this.type=fe;this.prev=Mf;this.info=jg;null!=ge&&(this.align=ge)}function Ca(){for(var Ob=arguments.length-1;0<=Ob;Ob--)Pe.cc.push(arguments[Ob])}function ra(){Ca.apply(null,arguments);return!0}function tb(Ob){function Nc(ge){for(;ge;ge=ge.next)if(ge.name==Ob)return!0;return!1}var fe=Pe.state;Pe.marked="def";fe.context?Nc(fe.localVars)||(fe.localVars={name:Ob,next:fe.localVars}):!Nc(fe.globalVars)&&Vb.globalVars&&
(fe.globalVars={name:Ob,next:fe.globalVars})}function Na(){Pe.state.context={prev:Pe.state.context,vars:Pe.state.localVars};Pe.state.localVars=Vi}function lc(){Pe.state.localVars=Pe.state.context.vars;Pe.state.context=Pe.state.context.prev}function kd(Ob,Nc){var fe=function(){var ge=Pe.state,Mf=ge.indented;if("stat"==ge.lexical.type)Mf=ge.lexical.indented;else for(var jg=ge.lexical;jg&&")"==jg.type&&jg.align;jg=jg.prev)Mf=jg.indented;ge.lexical=new Ja(Mf,Pe.stream.column(),Ob,null,ge.lexical,Nc)};
fe.lex=!0;return fe}function Tb(){var Ob=Pe.state;Ob.lexical.prev&&(")"==Ob.lexical.type&&(Ob.indented=Ob.lexical.indented),Ob.lexical=Ob.lexical.prev)}function md(Ob){function Nc(fe){return fe==Ob?ra():";"==Ob?Ca():ra(Nc)}return Nc}function wb(Ob,Nc){return"var"==Ob?ra(kd("vardef",Nc.length),Hc,md(";"),Tb):"keyword a"==Ob?ra(kd("form"),Wc,wb,Tb):"keyword b"==Ob?ra(kd("form"),wb,Tb):"{"==Ob?ra(kd("}"),Ze,Tb):";"==Ob?ra():"if"==Ob?("else"==Pe.state.lexical.info&&Pe.state.cc[Pe.state.cc.length-1]==
Tb&&Pe.state.cc.pop()(),ra(kd("form"),Wc,wb,Tb,Va)):"function"==Ob?ra(ea):"for"==Ob?ra(kd("form"),gb,wb,Tb):"variable"==Ob?Bh&&"type"==Nc?(Pe.marked="keyword",ra(Ke,md("operator"),Ke,md(";"))):ra(kd("stat"),wd):"switch"==Ob?ra(kd("form"),Wc,md("{"),kd("}","switch"),Ze,Tb,Tb):"case"==Ob?ra(je,md(":")):"default"==Ob?ra(md(":")):"catch"==Ob?ra(kd("form"),Na,md("("),Da,md(")"),wb,Tb,lc):"class"==Ob?ra(kd("form"),vb,Tb):"export"==Ob?ra(kd("stat"),yc,Tb):"import"==Ob?ra(kd("stat"),$d,Tb):"module"==Ob?ra(kd("form"),
dh,md("{"),kd("}"),Ze,Tb,Tb):"async"==Ob?ra(wb):"@"==Nc?ra(je,wb):Ca(kd("stat"),je,md(";"),Tb)}function je(Ob){return xb(Ob,!1)}function bf(Ob){return xb(Ob,!0)}function Wc(Ob){return"("!=Ob?Ca():ra(kd(")"),je,md(")"),Tb)}function xb(Ob,Nc){if(Pe.state.fatArrowAt==Pe.stream.start){var fe=Nc?Ab:$a;if("("==Ob)return ra(Na,kd(")"),cf(dh,")"),Tb,md("=>"),fe,lc);if("variable"==Ob)return Ca(Na,dh,md("=>"),fe,lc)}fe=Nc?Ha:nb;return Lg.hasOwnProperty(Ob)?ra(fe):"function"==Ob?ra(ea,fe):"class"==Ob?ra(kd("form"),
Ta,Tb):"keyword c"==Ob||"async"==Ob?ra(Nc?yb:ze):"("==Ob?ra(kd(")"),ze,md(")"),Tb,fe):"operator"==Ob||"spread"==Ob?ra(Nc?bf:je):"["==Ob?ra(kd("]"),ye,Tb,fe):"{"==Ob?df(Se,"}",null,fe):"quasi"==Ob?Ca(R,fe):"new"==Ob?ra(bc(Nc)):ra()}function ze(Ob){return Ob.match(/[;\}\)\],]/)?Ca():Ca(je)}function yb(Ob){return Ob.match(/[;\}\)\],]/)?Ca():Ca(bf)}function nb(Ob,Nc){return","==Ob?ra(je):Ha(Ob,Nc,!1)}function Ha(Ob,Nc,fe){var ge=0==fe?nb:Ha,Mf=0==fe?je:bf;if("=>"==Ob)return ra(Na,fe?Ab:$a,lc);if("operator"==
Ob)return/\+\+|--/.test(Nc)?ra(ge):"?"==Nc?ra(je,md(":"),Mf):ra(Mf);if("quasi"==Ob)return Ca(R,ge);if(";"!=Ob){if("("==Ob)return df(bf,")","call",ge);if("."==Ob)return ra(xd,ge);if("["==Ob)return ra(kd("]"),ze,md("]"),Tb,ge)}}function R(Ob,Nc){return"quasi"!=Ob?Ca():"${"!=Nc.slice(Nc.length-2)?ra(R):ra(je,xa)}function xa(Ob){if("}"==Ob)return Pe.marked="string-2",Pe.state.tokenize=ha,ra(R)}function $a(Ob){Fa(Pe.stream,Pe.state);return Ca("{"==Ob?wb:je)}function Ab(Ob){Fa(Pe.stream,Pe.state);return Ca("{"==
Ob?wb:bf)}function bc(Ob){return function(Nc){return"."==Nc?ra(Ob?pc:Ec):Ca(Ob?bf:je)}}function Ec(Ob,Nc){if("target"==Nc)return Pe.marked="keyword",ra(nb)}function pc(Ob,Nc){if("target"==Nc)return Pe.marked="keyword",ra(Ha)}function wd(Ob){return":"==Ob?ra(Tb,wb):Ca(nb,md(";"),Tb)}function xd(Ob){if("variable"==Ob)return Pe.marked="property",ra()}function Se(Ob,Nc){if("async"==Ob)return Pe.marked="property",ra(Se);if("variable"==Ob||"keyword"==Pe.style)return Pe.marked="property","get"==Nc||"set"==
Nc?ra(v):ra(Ie);if("number"==Ob||"string"==Ob)return Pe.marked=Cf?"property":Pe.style+" property",ra(Ie);if("jsonld-keyword"==Ob)return ra(Ie);if("modifier"==Ob)return ra(Se);if("["==Ob)return ra(je,md("]"),Ie);if("spread"==Ob)return ra(je);if(":"==Ob)return Ca(Ie)}function v(Ob){if("variable"!=Ob)return Ca(Ie);Pe.marked="property";return ra(ea)}function Ie(Ob){if(":"==Ob)return ra(bf);if("("==Ob)return Ca(ea)}function cf(Ob,Nc,fe){function ge(Mf,jg){return(fe?-1<fe.indexOf(Mf):","==Mf)?(Mf=Pe.state.lexical,
"call"==Mf.info&&(Mf.pos=(Mf.pos||0)+1),ra(function(fi,Ch){return fi==Nc||Ch==Nc?Ca():Ca(Ob)},ge)):Mf==Nc||jg==Nc?ra():ra(md(Nc))}return function(Mf,jg){return Mf==Nc||jg==Nc?ra():Ca(Ob,ge)}}function df(Ob,Nc,fe){for(var ge=3;ge<arguments.length;ge++)Pe.cc.push(arguments[ge]);return ra(kd(Nc,fe),cf(Ob,Nc),Tb)}function Ze(Ob){return"}"==Ob?ra():Ca(wb,Ze)}function ke(Ob,Nc){if(Bh){if(":"==Ob)return ra(Ke);if("?"==Nc)return ra(ke)}}function Ke(Ob){if("variable"==Ob)return Pe.marked="variable-3",ra(Zd);
if("string"==Ob||"number"==Ob||"atom"==Ob)return ra(Zd);if("{"==Ob)return ra(kd("}"),cf(wf,"}",",;"),Tb);if("("==Ob)return ra(cf(ug,")"),yf)}function yf(Ob){if("=>"==Ob)return ra(Ke)}function wf(Ob,Nc){if("variable"==Ob||"keyword"==Pe.style)return Pe.marked="property",ra(wf);if("?"==Nc)return ra(wf);if(":"==Ob)return ra(Ke)}function ug(Ob){if("variable"==Ob)return ra(ug);if(":"==Ob)return ra(Ke)}function Zd(Ob,Nc){if("<"==Nc)return ra(kd(">"),cf(Ke,">"),Tb,Zd);if("|"==Nc||"."==Ob)return ra(Ke);if("["==
Ob)return ra(md("]"),Zd);if("extends"==Nc)return ra(Ke)}function Hc(){return Ca(dh,ke,pg,Qc)}function dh(Ob,Nc){if("modifier"==Ob)return ra(dh);if("variable"==Ob)return tb(Nc),ra();if("spread"==Ob)return ra(dh);if("["==Ob)return df(dh,"]");if("{"==Ob)return df(ed,"}")}function ed(Ob,Nc){if("variable"==Ob&&!Pe.stream.match(/^\s*:/,!1))return tb(Nc),ra(pg);"variable"==Ob&&(Pe.marked="property");return"spread"==Ob?ra(dh):"}"==Ob?Ca():ra(md(":"),dh,pg)}function pg(Ob,Nc){if("="==Nc)return ra(bf)}function Qc(Ob){if(","==
Ob)return ra(Hc)}function Va(Ob,Nc){if("keyword b"==Ob&&"else"==Nc)return ra(kd("form","else"),wb,Tb)}function gb(Ob){if("("==Ob)return ra(kd(")"),Za,md(")"),Tb)}function Za(Ob){return"var"==Ob?ra(Hc,md(";"),O):";"==Ob?ra(O):"variable"==Ob?ra(V):Ca(je,md(";"),O)}function V(Ob,Nc){return"in"==Nc||"of"==Nc?(Pe.marked="keyword",ra(je)):ra(nb,O)}function O(Ob,Nc){return";"==Ob?ra(Ka):"in"==Nc||"of"==Nc?(Pe.marked="keyword",ra(je)):Ca(je,md(";"),Ka)}function Ka(Ob){")"!=Ob&&ra(je)}function ea(Ob,Nc){if("*"==
Nc)return Pe.marked="keyword",ra(ea);if("variable"==Ob)return tb(Nc),ra(ea);if("("==Ob)return ra(Na,kd(")"),cf(Da,")"),Tb,ke,wb,lc);if(Bh&&"<"==Nc)return ra(kd(">"),cf(Ke,">"),Tb,ea)}function Da(Ob){return"spread"==Ob?ra(Da):Ca(dh,ke,pg)}function Ta(Ob,Nc){return"variable"==Ob?vb(Ob,Nc):Bb(Ob,Nc)}function vb(Ob,Nc){if("variable"==Ob)return tb(Nc),ra(Bb)}function Bb(Ob,Nc){if("<"==Nc)return ra(kd(">"),cf(Ke,">"),Tb,Bb);if("extends"==Nc||"implements"==Nc||Bh&&","==Ob)return ra(Bh?Ke:je,Bb);if("{"==
Ob)return ra(kd("}"),Ib,Tb)}function Ib(Ob,Nc){if("variable"==Ob||"keyword"==Pe.style){if(("async"==Nc||"static"==Nc||"get"==Nc||"set"==Nc||Bh&&("public"==Nc||"private"==Nc||"protected"==Nc||"readonly"==Nc||"abstract"==Nc))&&Pe.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Pe.marked="keyword",ra(Ib);Pe.marked="property";return ra(Bh?wc:ea,Ib)}if("["==Ob)return ra(je,md("]"),Bh?wc:ea,Ib);if("*"==Nc)return Pe.marked="keyword",ra(Ib);if(";"==Ob)return ra(Ib);if("}"==Ob)return ra();if("@"==Nc)return ra(je,
Ib)}function wc(Ob,Nc){return"?"==Nc?ra(wc):":"==Ob?ra(Ke,pg):"="==Nc?ra(bf):Ca(ea)}function yc(Ob,Nc){return"*"==Nc?(Pe.marked="keyword",ra(He,md(";"))):"default"==Nc?(Pe.marked="keyword",ra(je,md(";"))):"{"==Ob?ra(cf(gd,"}"),He,md(";")):Ca(wb)}function gd(Ob,Nc){if("as"==Nc)return Pe.marked="keyword",ra(md("variable"));if("variable"==Ob)return Ca(bf,gd)}function $d(Ob){return"string"==Ob?ra():Ca(te,Ed,He)}function te(Ob,Nc){if("{"==Ob)return df(te,"}");"variable"==Ob&&tb(Nc);"*"==Nc&&(Pe.marked=
"keyword");return ra(Je)}function Ed(Ob){if(","==Ob)return ra(te,Ed)}function Je(Ob,Nc){if("as"==Nc)return Pe.marked="keyword",ra(te)}function He(Ob,Nc){if("from"==Nc)return Pe.marked="keyword",ra(je)}function ye(Ob){return"]"==Ob?ra():Ca(cf(bf,"]"))}cc=Object.assign({},vc.defaultConfig,{},cc);Vb=Object.assign({},vc.defaultParserConfig,{},Vb);var oe=cc.indentUnit,of=Vb.statementIndent,Cf=Vb.jsonld,rh=Vb.json||Cf,Bh=Vb.typescript,$g=Vb.wordCharacters||/[\w$\xa1-\uffff]/,Hf=function(){function Ob(Ch){return{type:Ch,
style:"keyword"}}var Nc=Ob("keyword a"),fe=Ob("keyword b"),ge=Ob("keyword c"),Mf=Ob("operator"),jg={type:"atom",style:"atom"};Nc={if:Ob("if"),while:Nc,with:Nc,else:fe,do:fe,try:fe,finally:fe,return:ge,break:ge,continue:ge,new:Ob("new"),delete:ge,throw:ge,debugger:ge,var:Ob("var"),const:Ob("var"),let:Ob("var"),function:Ob("function"),catch:Ob("catch"),for:Ob("for"),switch:Ob("switch"),case:Ob("case"),default:Ob("default"),in:Mf,typeof:Mf,instanceof:Mf,true:jg,false:jg,null:jg,undefined:jg,NaN:jg,Infinity:jg,
this:Ob("this"),class:Ob("class"),super:Ob("atom"),yield:ge,export:Ob("export"),import:Ob("import"),extends:ge,await:ge,async:Ob("async")};if(Bh){fe={type:"variable",style:"variable-3"};ge={interface:Ob("class"),implements:ge,namespace:ge,module:Ob("module"),enum:Ob("module"),public:Ob("modifier"),private:Ob("modifier"),protected:Ob("modifier"),abstract:Ob("modifier"),as:Mf,string:fe,number:fe,boolean:fe,any:fe};for(var fi in ge)Nc[fi]=ge[fi]}return Nc}(),ei=/[+\-*&%=<>!?|~^@]/,Gh=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
ni,wg,Lg={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Pe={state:null,column:null,marked:null,cc:null},Vi={name:"this",next:{name:"arguments"}};Tb.lex=!0;return{startState:function(Ob){Ob={tokenize:Ga,lastType:"sof",cc:[],lexical:new Ja((Ob||0)-oe,0,"block",!1),localVars:Vb.localVars,context:Vb.localVars&&{vars:Vb.localVars},indented:Ob||0};Vb.globalVars&&"object"===typeof Vb.globalVars&&(Ob.globalVars=Vb.globalVars);return Ob},token:function(Ob,Nc){Ob.sol()&&(Nc.lexical.hasOwnProperty("align")||
(Nc.lexical.align=!1),Nc.indented=Ob.indentation(),Fa(Ob,Nc));if(Nc.tokenize!=X&&Ob.eatSpace())return null;var fe=Nc.tokenize(Ob,Nc);if("comment"==ni)return fe;Nc.lastType="operator"!=ni||"++"!=wg&&"--"!=wg?ni:"incdec";a:{var ge=ni,Mf=wg,jg=Nc.cc;Pe.state=Nc;Pe.stream=Ob;Pe.marked=null;Pe.cc=jg;Pe.style=fe;Nc.lexical.hasOwnProperty("align")||(Nc.lexical.align=!0);for(Ob=0;;){if(1E5<Ob++)throw Error("endless");if((jg.length?jg.pop():rh?je:wb)(ge,Mf)){for(;jg.length&&jg[jg.length-1].lex;)jg.pop()();
if(Pe.marked){fe=Pe.marked;break a}if(ge="variable"==ge)b:{for(ge=Nc.localVars;ge;ge=ge.next)if(ge.name==Mf){ge=!0;break b}for(Nc=Nc.context;Nc;Nc=Nc.prev)for(ge=Nc.vars;ge;ge=ge.next)if(ge.name==Mf){ge=!0;break b}ge=void 0}if(ge){fe="variable-2";break a}break a}}}return fe},indent:function(Ob,Nc){if(Ob.tokenize==X)return vc.passIndent;if(Ob.tokenize!=Ga)return 0;var fe=Nc&&Nc.charAt(0),ge=Ob.lexical,Mf;if(!/^\s*else\b/.test(Nc))for(var jg=Ob.cc.length-1;0<=jg;--jg){var fi=Ob.cc[jg];if(fi==Tb)ge=
ge.prev;else if(fi!=Va)break}for(;!("stat"!=ge.type&&"form"!=ge.type||"}"!=fe&&(!(Mf=Ob.cc[Ob.cc.length-1])||Mf!=nb&&Mf!=Ha||/^[,\.=+\-*:?[\(]/.test(Nc)));)ge=ge.prev;of&&")"==ge.type&&"stat"==ge.prev.type&&(ge=ge.prev);Mf=ge.type;jg=fe==Mf;return(fi=Ob._string)&&fi.trimLeft().startsWith("?")&&":"===fe?fi.indexOf("?"):fi&&":"===Ob.lastType&&"}"!==ge.type?fi.match(/^\s*/)[0].length:"vardef"==Mf?(Nc=ge.indented+ge.info+2+Ob.localVars.name.length,"?"===fe||":"===fe||"|"===fe||"&"===fe?Nc:","==Ob.lastType?
ge.indented+ge.info+1:"operator"==Ob.lastType?Nc+3:ge.indented):"form"==Mf&&"{"==fe?ge.indented:"form"==Mf?ge.indented+oe:"stat"==Mf?(fe=ge.indented,Ob="operator"==Ob.lastType||","==Ob.lastType||ei.test(Nc.charAt(0))||/[,.]/.test(Nc.charAt(0)),fe+(Ob?of||oe:0)):"switch"!=ge.info||jg||0==Vb.doubleIndentSwitch?ge.align?ge.column+(jg?0:1):ge.indented+(jg?0:oe):ge.indented+(/^(?:case|default)\b/.test(Nc)?oe:2*oe)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:rh?null:"/*",blockCommentEnd:rh?
null:"*/",lineComment:rh?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:rh?"json":"javascript",jsonldMode:Cf,jsonMode:rh,expressionAllowed:vc.expressionAllowed,skipExpression:function(Ob){var Nc=Ob.cc[Ob.cc.length-1];Nc!=je&&Nc!=bf||Ob.cc.pop()}}});vc.registerHelper("wordChars","javascript",/[\w$]/);vc.defineMIME("text/javascript","javascript");vc.defineMIME("text/ecmascript","javascript");vc.defineMIME("application/javascript","javascript");vc.defineMIME("application/x-javascript",
"javascript");vc.defineMIME("application/ecmascript","javascript");vc.defineMIME("application/json",{name:"javascript",json:!0});vc.defineMIME("application/x-json",{name:"javascript",json:!0});vc.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});vc.defineMIME("text/typescript",{name:"javascript",typescript:!0});vc.defineMIME("application/typescript",{name:"javascript",typescript:!0});var Lc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");Lc.string=Kc;Lc.JavaScriptChecker=
vd;Lc.JavaScriptNavigator=Bc;Lc.completers=Mb;Lc.jsSnippets=Ua;Lc.jsIdeCommands=mb;Lc.jsEditorCommands=rc;Lc.astEditorCommands=Gb;Lc.CodeMirrorEnabledEditorPlugin=Ac;Lc.Snippet=lb;Lc.parser=ne;Lc.localInterface=Pd;Lc.systemInterfaceNamed=Hb;Lc.serverInterfaceFor=Gc;Lc.l2lInterfaceFor=ud;vd=function(cc){var Vb=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),Ub=Vb.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof Vb.JavaScriptEditorPlugin?Vb.JavaScriptEditorPlugin:Vb.JavaScriptEditorPlugin=
function(Ga){Ga&&Ga[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return rb(Ub,cc,[{key:Symbol.for("lively-instance-initialize"),value:function(){rb._get(Object.getPrototypeOf(Ub.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new Lc.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(Ga){rb._get(Object.getPrototypeOf(Ub.prototype),"attach",this).call(this,Ga);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:Ga})}},{key:"detach",value:function(Ga){this.checker.uninstall(this.textMorph);rb._get(Object.getPrototypeOf(Ub.prototype),"detach",this).call(this,Ga)}},{key:"getNavigator",value:function(){return new Lc.JavaScriptNavigator}},{key:"getCompleters",value:function(Ga){return Lc.completers.concat(Ga)}},
{key:"getCommands",value:function(Ga){return[].concat($jscomp.arrayFromIterable(rb._get(Object.getPrototypeOf(Ub.prototype),"getCommands",this).call(this,Ga)),$jscomp.arrayFromIterable(Lc.jsIdeCommands),$jscomp.arrayFromIterable(Lc.jsEditorCommands),$jscomp.arrayFromIterable(Lc.astEditorCommands))}},{key:"getKeyBindings",value:function(Ga){return[].concat($jscomp.arrayFromIterable(Ga),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(Ga){var jb=this,X,ha,Fa,Ja,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){X=jb.textMorph;ha=[{command:"doit",target:X,showKeyShortcuts:!0},{command:"inspectit",target:X,showKeyShortcuts:!0},{command:"editit",target:X,showKeyShortcuts:!0},{command:"printit",target:X,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:X,showKeyShortcuts:!0},{command:"eval all",target:X,showKeyShortcuts:!0},{command:"text completion",alias:"code completion",
target:X,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:X,showKeyShortcuts:!0},{isDivider:!0}];jb.evalEnvironment.targetModule&&ha.push({command:"[javascript] inject import",alias:"add import",target:X},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:X},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:X});Fa=jb.getNavigator();(Ja=Fa.resolveIdentifierAt(X,X.cursorPosition))&&
ha.push({command:"selectDefinition",alias:'jump to definition of "'+Ja.name+'"',target:X},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+Ja.name+'"',target:X});(Ca=X.selection.text.trim())&&ha.push({command:"open code search",alias:'code search for "'+Lc.string.truncate(Ca,30)+'"',target:X.world(),args:{input:Ca,backend:jb.backend()}});ha.push({isDivider:!0});return ra.return(ha.concat(Ga))})}},{key:"getSnippets",value:function(){return Lc.jsSnippets.map(function(Ga){var jb=
$jscomp.makeIterator(Ga);Ga=jb.next().value;jb=jb.next().value;return new Lc.Snippet({trigger:Ga,expansion:jb})})}},{key:"sanatizedJsEnv",value:function(Ga){Ga=Object.assign({},this.evalEnvironment,{},Ga);Ga.format||(Ga.formatd="esm");Ga.context||(Ga.context=this.textMorph);Ga.sourceURL||(Ga.sourceURL=Ga.targetModule+"_doit_"+Date.now());Ga.systemInterface||(Ga.systemInterface=Lc.localInterface);return Ga}},{key:"backend",value:function(Ga){Ga=this.sanatizedJsEnv(Ga);return Ga.remote?Ga.remote:"local"}},
{key:"systemInterface",value:function(Ga){return this.sanatizedJsEnv(Ga).systemInterface||Lc.localInterface}},{key:"setSystemInterface",value:function(Ga){return this.evalEnvironment.systemInterface=Ga}},{key:"setSystemInterfaceNamed",value:function(Ga){return this.setSystemInterface(Lc.systemInterfaceNamed(Ga))}},{key:"runEval",value:function(Ga,jb){jb=this.sanatizedJsEnv(jb);return this.systemInterface(jb).runEval(Ga,jb)}},{key:"parser",get:function(){return Lc.parser}},{key:"parse",value:function(Ga){Ga=
void 0===Ga?null:Ga;if(this._ast&&this._ast._astType===Ga)return this._ast;var jb=this.parser,X=this.textMorph.textString;if(!jb)return null;var ha={withComments:!0,allowReturnOutsideFunction:!0};Ga&&(ha.type=Ga);if(X.startsWith("#!")){var Fa=X.indexOf("\n");X=" ".repeat(Fa)+X.slice(Fa)}jb=jb.fuzzyParse(X,ha);jb._astType=Ga;return this._ast=jb}},{key:"undeclaredVariables",value:function(Ga){var jb=this.parser,X=this.evalEnvironment.knownGlobals||[];Ga=this.parse(void 0===Ga?null:Ga);return jb&&Ga?
jb.query.findGlobalVarRefs(Ga,{jslintGlobalComment:!0}).filter(function(ha){return!X.includes(ha.name)}):[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],Vb,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(Lc.CodeMirrorEnabledEditorPlugin);
vd=Lc.JavaScriptEditorPlugin;Ma("default",vd);Lc.default=vd}}});
System.register("./__root_module__-f418f9fd.js lively.collab kld-intersections ./index-e1bb9574.js ./index-c551f254.js ./user-ui-983ba0be.js".split(" "),function(Ha,tb){var Ab,kc,ac,Ld,Tc,$d,Uc,Pc,Jd,pe,Ze,Ff,te,Bc,sd,le,jc,je,Ae;return{setters:[function(Dc){Ab=Dc.av;kc=Dc.ay;ac=Dc.ax;Ld=Dc.ab;Tc=Dc.Y;$d=Dc.a6;Uc=Dc.aO;Pc=Dc.a7;Jd=Dc.C;pe=Dc.a3;Ze=Dc.r;Ff=Dc.aJ;te=Dc.a_;Bc=Dc.az;sd=Dc.bl;le=Dc.aF;jc=Dc.bk;je=Dc.bi},function(){},function(){},function(){},function(){},function(Dc){Ae=Dc.UserUI}],
execute:function(){var Dc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");Dc.Morph=Ab;Dc.HorizontalLayout=kc;Dc.VerticalLayout=ac;Dc.morph=Ld;Dc.MorphicDB=Tc;Dc.arr=$d;Dc.fun=Uc;Dc.string=Pc;Dc.Color=Jd;Dc.pt=pe;Dc.UserUI=Ae;Dc.resource=Ze;var Mc=function(Zc){var Rd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),Kd=Rd.hasOwnProperty("WorldDashboard")&&"function"===typeof Rd.WorldDashboard?Rd.WorldDashboard:Rd.WorldDashboard=function(rb){rb&&rb[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ff(Kd,Zc,[{key:"onLoad",value:function(){if(!this.isComponent&&"undefined"!==typeof localStorage){var rb=localStorage.getItem("lively.morphic-projects-filter");rb&&this.ui.sortSelector.selection!=rb&&(this.ui.sortSelector.selection=rb)}}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",
this.ui.sortSelector.selection)}catch(rb){console.error(rb)}}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(rb){rb=void 0===rb?$world:rb;this.owner!=rb&&rb.addMorph(this);this.center=rb.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(rb){var ob=Dc.UserUI.getCurrentUser();rb=this.ui.searchField.fuzzyFilter(rb,
function(Bb){return Bb._commit.name+Bb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return Dc.arr.sortBy(rb,function(Bb){return-Bb._commit.timestamp});case "TEMPLATES":return rb;case "MY PROJECTS":return Dc.arr.filter(rb,function(Bb){return Bb._commit.author.name===ob.name});case "PUBLISHED":return rb}}},{key:"updateList",value:function(){var rb=this;this.previews&&Dc.fun.debounceNamed("update world list",150,function(){rb.ui.worldList.items=rb.sortAndFilterPreviews(rb.previews)})()}},
{key:"displayWorlds",value:function(){var rb=this,ob,Bb,Va,Ta,xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){switch(wa.nextAddress){case 1:return rb.reset(),ob=rb.ui,Bb=ob.loadingLabel,Bb.fit(),Bb.animate({opacity:1,duration:300}),wa.yield(rb.db.latestCommits("world"),2);case 2:return Va=wa.yieldResult,wa.yield(tb.import("./world preview-d7106192.js"),4);case 4:if(!(Ta=wa.yieldResult)){wa.jumpTo(5);break}return wa.yield(Dc.resource("part://partial freezing/world preview"),6);case 6:Ta=
wa.yieldResult;case 5:return wa.yield(Ta.read(),3);case 3:return xa=wa.yieldResult,rb.previews=Va.map(function(Qa){var Eb=Dc.morph({reactsToPointer:!1,fill:Dc.Color.transparent,extent:xa.extent});Eb._commit=Qa;Eb.displayPreview=function(){var rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qb){if(1==qb.nextAddress)return rc=xa.copy(),rc._commit=Qa,rc.opacity=0,Eb.addMorph(rc),rc.displayPreview(),rc.position=Dc.pt(0,0),qb.yield(Eb.whenRendered(),2);Eb.layout=new Dc.HorizontalLayout({autoResize:!0,
reactToSubmorphAnimations:!0});qb.jumpToEnd()})};return Eb}),wa.yield(Bb.animate({opacity:0,duration:300}),7);case 7:rb.updateList(),0==Va.length&&(rb.ui.noWorldWarning.center=rb.innerBounds().center(),rb.ui.noWorldWarning.animate({visible:!0,duration:300})),wa.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,
get:function(){return this.ui.closeButton.visible},set:function(rb){this.ui.closeButton.visible=rb}},db:{serialize:!1,get:function(){return Dc.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],
Rd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-135"}}},{start:330,end:4495})}(Dc.Morph);Mc=Dc.WorldDashboard;Dc.default=Mc;var bc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");bc.Morph=Ab;bc.touchInputDevice=te;bc.TilingLayout=Bc;bc.arr=$d;bc.pt=pe;Mc=function(Zc){var Rd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),
Kd=Rd.hasOwnProperty("GrowingWorldList")&&"function"===typeof Rd.GrowingWorldList?Rd.GrowingWorldList:Rd.GrowingWorldList=function(rb){rb&&rb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ff(Kd,Zc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(rb){Ff._get(Object.getPrototypeOf(Kd.prototype),"onScroll",this).call(this,rb);this.update()}},{key:"onChange",value:function(rb){Ff._get(Object.getPrototypeOf(Kd.prototype),
"onChange",this).call(this,rb);"extent"==rb.prop&&this.update(!0)}},{key:"onHoverIn",value:function(rb){this.clipMode="auto"}},{key:"onHoverOut",value:function(rb){bc.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(rb){var ob=this.items;if(ob&&0!=ob.length){var Bb=this.scrollContainer,Va=Bb.layout.spacing;Bb.extent=this.extent;var Ta=this.ui,xa=Ta.bufferTop;Ta=Ta.bufferBottom;xa=xa||Bb.addMorph({fill:null,name:"buffer top",height:10});Ta=Ta||Bb.addMorph({fill:null,name:"buffer bottom",
height:10});xa.width=Ta.width=this.width-100;Bb.layout.disable();var wa=ob[0];Va=ob.slice(0,Math.floor(this.width/(wa.width+Va))*(Math.ceil((this.scroll.y+this.height)/(wa.height+Va))+1)).filter(function(qb){return qb.owner!=Bb});wa=this.scroll.y+2*this.height;for(var Qa={},Eb=$jscomp.makeIterator(Va),rc=Eb.next();!rc.done;Qa={$jscomp$loop$prop$item$2710:Qa.$jscomp$loop$prop$item$2710},rc=Eb.next())Qa.$jscomp$loop$prop$item$2710=rc.value,wa++,Qa.$jscomp$loop$prop$item$2710.top=wa,Bb.addMorph(Qa.$jscomp$loop$prop$item$2710),
Qa.$jscomp$loop$prop$item$2710._initialized||Qa.$jscomp$loop$prop$item$2710.whenRendered().then(function(qb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){qb.$jscomp$loop$prop$item$2710._initialized=!0;return sb.yield(qb.$jscomp$loop$prop$item$2710.displayPreview(),0)})}}(Qa));rb&&(xa.position=bc.pt(0,0),ob.forEach(function(qb,sb){return qb.position=bc.pt(sb+1,sb+1)}),Ta.position=bc.pt(ob.length+2,ob.length+2));Bb.layout.enable();if(rb||0<Va.length)Ta.top=this.submorphBounds().height,
Bb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new bc.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},
items:{after:["layout","scrollContainer"],set:function(rb){this.setProperty("items",rb);var ob=this.scrollContainer;ob.layout&&ob.layout.disable();var Bb=this.ui,Va=Bb.bufferTop;Bb=Bb.bufferBottom;bc.arr.withoutAll(ob.submorphs,[].concat($jscomp.arrayFromIterable(rb),[Va,Bb])).forEach(function(Ta){return Ta.remove()});this.update(!0)}}}}}],Rd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(bc.Morph);Mc=bc.GrowingWorldList;bc.default=Mc;var Gc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");Gc.InputLine=sd;Gc.Color=Jd;Gc.connect=le;Gc.disconnectAll=jc;Gc.disconnect=je;Gc.arr=$d;Gc.string=Pc;Mc=function(Zc){var Rd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),Kd=Rd.hasOwnProperty("SearchInputLine")&&"function"===typeof Rd.SearchInputLine?Rd.SearchInputLine:Rd.SearchInputLine=
function(rb){rb&&rb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ff(Kd,Zc,[{key:"fuzzyMatch",value:function(rb,ob){ob=void 0===ob?this.parseInput():ob;if(ob.lowercasedTokens.every(function(Va){return rb.toLowerCase().includes(Va)}))return!0;var Bb=rb.toLowerCase();return 3>=Gc.arr.sum(ob.lowercasedTokens.map(function(Va){return Gc.string.levenshtein(Bb,Va)}))}},{key:"fuzzyFilter",value:function(rb,ob){var Bb=this;ob=void 0===
ob?function(Ta){return Ta}:ob;var Va=this.parseInput();return Gc.arr.filter(rb,function(Ta){return Bb.fuzzyMatch(ob(Ta),Va)})}},{key:"parseInput",value:function(){var rb=Array.from(this.textString).reduce(function(Bb,Va){if("\\"===Va&&!Bb.escaped)return Bb.escaped=!0,Bb;" "!==Va||Bb.escaped?(Bb.spaceSeen=!1,Bb.current+=Va):(!Bb.spaceSeen&&Bb.current&&(Bb.tokens.push(Bb.current),Bb.current=""),Bb.spaceSeen=!0);Bb.escaped=!1;return Bb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});rb.current&&rb.tokens.push(rb.current);
var ob=rb.tokens.map(function(Bb){return Bb.toLowerCase()});return{tokens:rb.tokens,lowercasedTokens:ob}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],Rd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(Gc.InputLine);Mc=Gc.SearchInputLine;
Gc.default=Mc}}});
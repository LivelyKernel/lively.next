System.register(["./__root_module__-db735625.js","./object-classes-d20badfc.js","./user-ui-f27547c5.js","./index-a5b95ed8.js","./index-4222eff9.js"],function(){var db,Zb,lc,Uc,Bc,Vd,Od,je,Bd,jd,zd,ge,We,kf,bf,Hd,Ae,uc,wd;return{setters:[function(ce){db=ce.M;Zb=ce.ah;lc=ce.ad;Uc=ce.m;Bc=ce.ag;Vd=ce.b;Od=ce.f;je=ce.c;Bd=ce.C;jd=ce.p;zd=ce.r;ge=ce.i;We=ce.t;kf=ce.aA;bf=ce.aB;Hd=ce.d;Ae=ce.az;uc=ce.a1},function(){},function(ce){wd=ce.UserUI},function(){},function(){}],execute:function(){var ce=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");
ce.Morph=db;ce.HorizontalLayout=Zb;ce.VerticalLayout=lc;ce.morph=Uc;ce.MorphicDB=Bc;ce.arr=Vd;ce.fun=Od;ce.string=je;ce.Color=Bd;ce.pt=jd;ce.UserUI=wd;ce.resource=zd;var Gd=function(rc){var bd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),he=bd.hasOwnProperty("WorldDashboard")&&"function"===typeof bd.WorldDashboard?bd.WorldDashboard:bd.WorldDashboard=function(cd){cd&&cd[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ge(he,
rc,[{key:"onLoad",value:function(){if(!this.isComponent&&"undefined"!==typeof localStorage){var cd=localStorage.getItem("lively.morphic-projects-filter");cd&&this.ui.sortSelector.selection!=cd&&(this.ui.sortSelector.selection=cd)}}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",this.ui.sortSelector.selection)}catch(cd){console.error(cd)}}},
{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(cd){cd=void 0===cd?$world:cd;this.owner!=cd&&cd.addMorph(this);this.center=cd.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(cd){var ie=ce.UserUI.getCurrentUser();cd=this.ui.searchField.fuzzyFilter(cd,function(ac){return ac._commit.name+ac._commit.description});
switch(this.ui.sortSelector.selection){case "RECENT":return ce.arr.sortBy(cd,function(ac){return-ac._commit.timestamp});case "TEMPLATES":return cd;case "MY PROJECTS":return ce.arr.filter(cd,function(ac){return ac._commit.author.name===ie.name});case "PUBLISHED":return cd}}},{key:"updateList",value:function(){var cd=this;this.previews&&ce.fun.debounceNamed("update world list",150,function(){cd.ui.worldList.items=cd.sortAndFilterPreviews(cd.previews)})()}},{key:"displayWorlds",value:function(){var cd=
this,ie,ac,Db,Tc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){switch(Nc.nextAddress){case 1:return cd.reset(),ie=cd.ui,ac=ie.loadingLabel,ac.fit(),ac.animate({opacity:1,duration:300}),Nc.yield(cd.db.latestCommits("world"),2);case 2:return Db=Nc.yieldResult,Nc.yield(ce.resource("part://partial freezing/world preview").read(),3);case 3:return Tc=Nc.yieldResult,cd.previews=Db.map(function(wc){var Vc=ce.morph({reactsToPointer:!1,fill:ce.Color.transparent,clipMode:"hidden",dropShadow:Tc.dropShadow,
extent:Tc.extent});Vc._commit=wc;Vc.displayPreview=function(){var hb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zc){if(1==zc.nextAddress)return hb=Tc.copy(),hb.dropShadow=null,hb._commit=wc,hb.opacity=0,Vc.addMorph(hb),hb.displayPreview(),hb.position=ce.pt(0,0),zc.yield(Vc.whenRendered(),2);Vc.layout=new ce.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});zc.jumpToEnd()})};return Vc}),Nc.yield(ac.animate({opacity:0,duration:300}),4);case 4:cd.updateList(),0==Db.length&&
(cd.ui.noWorldWarning.center=cd.innerBounds().center(),cd.ui.noWorldWarning.animate({visible:!0,duration:300})),Nc.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(cd){this.ui.closeButton.visible=cd}},db:{serialize:!1,get:function(){return ce.MorphicDB.default}},
ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],bd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"WorldDashboard",version:"0.1.1-140"}}},{start:330,end:4524})}(ce.Morph);Gd=ce.WorldDashboard;ce.default=Gd;var pe=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");pe.Morph=db;pe.touchInputDevice=We;pe.TilingLayout=kf;pe.arr=Vd;pe.pt=jd;Gd=function(rc){var bd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),he=bd.hasOwnProperty("GrowingWorldList")&&"function"===typeof bd.GrowingWorldList?bd.GrowingWorldList:bd.GrowingWorldList=function(cd){cd&&
cd[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ge(he,rc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(cd){ge._get(Object.getPrototypeOf(he.prototype),"onScroll",this).call(this,cd);this.update()}},{key:"onChange",value:function(cd){ge._get(Object.getPrototypeOf(he.prototype),"onChange",this).call(this,cd);"extent"==cd.prop&&this.update(!0)}},{key:"onHoverIn",value:function(cd){this.clipMode=
"auto"}},{key:"onHoverOut",value:function(cd){pe.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(cd){var ie=this.items;if(ie&&0!=ie.length){var ac=this.scrollContainer,Db=ac.layout.spacing;ac.extent=this.extent;var Tc=this.ui,Nc=Tc.bufferTop;Tc=Tc.bufferBottom;Nc=Nc||ac.addMorph({fill:null,name:"buffer top",height:10});Tc=Tc||ac.addMorph({fill:null,name:"buffer bottom",height:10});Nc.width=Tc.width=this.width-100;ac.layout.disable();var wc=ie[0];Db=ie.slice(0,Math.floor(this.width/
(wc.width+Db))*(Math.ceil((this.scroll.y+this.height)/(wc.height+Db))+1)).filter(function(Ub){return Ub.owner!=ac});wc=this.scroll.y+2*this.height;for(var Vc={},hb=$jscomp.makeIterator(Db),zc=hb.next();!zc.done;Vc={$jscomp$loop$prop$item$3024:Vc.$jscomp$loop$prop$item$3024},zc=hb.next())Vc.$jscomp$loop$prop$item$3024=zc.value,wc++,Vc.$jscomp$loop$prop$item$3024.top=wc,ac.addMorph(Vc.$jscomp$loop$prop$item$3024),Vc.$jscomp$loop$prop$item$3024._initialized||Vc.$jscomp$loop$prop$item$3024.whenRendered().then(function(Ub){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jc){Ub.$jscomp$loop$prop$item$3024._initialized=
!0;return Jc.yield(Ub.$jscomp$loop$prop$item$3024.displayPreview(),0)})}}(Vc));cd&&(Nc.position=pe.pt(0,0),ie.forEach(function(Ub,Jc){return Ub.position=pe.pt(Jc+1,Jc+1)}),Tc.position=pe.pt(ie.length+2,ie.length+2));ac.layout.enable();if(cd||0<Db.length)Tc.top=this.submorphBounds().height,ac.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new pe.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(cd){this.setProperty("items",cd);var ie=this.scrollContainer;ie.layout&&ie.layout.disable();var ac=this.ui,Db=ac.bufferTop;ac=ac.bufferBottom;pe.arr.withoutAll(ie.submorphs,
[].concat($jscomp.arrayFromIterable(cd),[Db,ac])).forEach(function(Tc){return Tc.remove()});this.update(!0)}}}}}],bd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(pe.Morph);Gd=pe.GrowingWorldList;pe.default=Gd;var Te=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
Te.InputLine=bf;Te.Color=Bd;Te.connect=Hd;Te.disconnectAll=Ae;Te.disconnect=uc;Te.arr=Vd;Te.string=je;Gd=function(rc){var bd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),he=bd.hasOwnProperty("SearchInputLine")&&"function"===typeof bd.SearchInputLine?bd.SearchInputLine:bd.SearchInputLine=function(cd){cd&&cd[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ge(he,rc,[{key:"fuzzyMatch",value:function(cd,ie){ie=void 0===
ie?this.parseInput():ie;if(ie.lowercasedTokens.every(function(Db){return cd.toLowerCase().includes(Db)}))return!0;var ac=cd.toLowerCase();return 3>=Te.arr.sum(ie.lowercasedTokens.map(function(Db){return Te.string.levenshtein(ac,Db)}))}},{key:"fuzzyFilter",value:function(cd,ie){var ac=this;ie=void 0===ie?function(Tc){return Tc}:ie;var Db=this.parseInput();return Te.arr.filter(cd,function(Tc){return ac.fuzzyMatch(ie(Tc),Db)})}},{key:"parseInput",value:function(){var cd=Array.from(this.textString).reduce(function(ac,
Db){if("\\"===Db&&!ac.escaped)return ac.escaped=!0,ac;" "!==Db||ac.escaped?(ac.spaceSeen=!1,ac.current+=Db):(!ac.spaceSeen&&ac.current&&(ac.tokens.push(ac.current),ac.current=""),ac.spaceSeen=!0);ac.escaped=!1;return ac},{tokens:[],current:"",escaped:!1,spaceSeen:!1});cd.current&&cd.tokens.push(cd.current);var ie=cd.tokens.map(function(ac){return ac.toLowerCase()});return{tokens:cd.tokens,lowercasedTokens:ie}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],bd,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(Te.InputLine);Gd=Te.SearchInputLine;Te.default=Gd}}});
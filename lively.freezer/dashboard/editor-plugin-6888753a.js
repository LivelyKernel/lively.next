System.register(["./__root_module__-6d2e743c.js","./index-ecae4ac2.js","./index-9d4f3df2.js"],function(Ma){var rb,Db,hc,Kb,id,Zc,yd,Kc,sc,bd,hd,se,xe,ne,Rc,Pd,Hb,Gc,ud,Vc,Id,ie,Fb,Ac,$c,Bc,vd,pb,lb,Zb,Mb,ub,rc,Ua,Lb,mb,Gb,vc,Lc,cc,Vb,Ub,Ga,jb,X;return{setters:[function(ha){rb=ha.C;Db=ha.i;hc=ha.b;Kb=ha.R;id=ha.p;Zc=ha.m;yd=ha.bt;Kc=ha.aA;sc=ha.d;bd=ha.c;hd=ha.at;se=ha.bB;xe=ha.bC;ne=ha._;Rc=ha.o;Pd=ha.n;Hb=ha.g;Gc=ha.bD;ud=ha.bE;Vc=ha.a2;Id=ha.P;ie=ha.a;Fb=ha.a1;Ac=ha.M;$c=ha.T;Bc=ha.ad;vd=ha.ae;
pb=ha.ah;lb=ha.aB;Zb=ha.S;Mb=ha.I;ub=ha.h;rc=ha.bF;Ua=ha.v;Lb=ha.bG;mb=ha.aG;Gb=ha.bu;vc=ha.aF;Lc=ha.bH;cc=ha.f},function(ha){Vb=ha.M;Ub=ha.I;Ga=ha.v;jb=ha.p},function(ha){X=ha.localInterface}],execute:function(){function ha(Va,gb){if(!0===gb)return gb;if(Va.copyState)return Va.copyState(gb);Va={};for(var Za in gb){var V=gb[Za];V instanceof Array&&(V=V.concat([]));Va[Za]=V}return Va}function Fa(Va,gb,Za){return Va.startState?Va.startState(gb,Za):!0}function Ja(Va,gb){return pc.modes[Va]=gb}function Ca(Va){if("string"===
typeof Va&&pc.mimeModes.hasOwnProperty(Va))Va=pc.mimeModes[Va];else if(Va&&"string"===typeof Va.name&&pc.mimeModes.hasOwnProperty(Va.name)){var gb=pc.mimeModes[Va.name];"string"===typeof gb&&(gb={name:gb});Va=Object.assign({},gb,Va);Va.name=gb.name}else{if("string"===typeof Va&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Va))return Ca("application/xml");if("string"===typeof Va&&/^[\w\-]+\/[\w\-]+\+json$/.test(Va))return Ca("application/json")}return"string"===typeof Va?{name:Va}:Va||{name:"null"}}function ra(Va,
gb){gb=pc.resolveMode(gb);"string"===typeof gb&&(gb={name:gb});if(!gb.name)throw Error("parserConfig does not have a name of the mode to get");var Za=pc.modes[gb.name];if(!Za)return ra(Va,"text/plain");Va=Object.assign({indentUnit:2},Va);return Object.assign(Za(Va,gb),{name:gb.name})}function tb(Va,gb){for(var Za;Va.innerMode;){Za=Va.innerMode(gb);if(!Za||Za.mode==Va)break;gb=Za.state;Va=Za.mode}return Za||{mode:Va,state:gb}}function Na(Va,gb){pc.mimeModes[Va]=gb}function lc(Va,gb,Za){}function kd(Va,
gb,Za,V,O,Ka,ea){var Da=Va.editorPlugin._tokenizerValidBefore;Da&&Da.row>=Za&&(Da.row=Za-1);var Ta=pc.linesToTokenize(Va.document,Za,V,Da);Da=Ta.lines;Ta=Ta.state;if(!Da.length)return!1;Ta=Ta?pc.copyState(gb,Ta):pc.startState(gb);for(var vb=0;vb<Da.length;vb++){var Bb=Da[vb],Ib=Bb.row;Ib>=Za&&Ib<=V&&pc.indentLine(Va,gb,Bb,Ta,O,Ka,ea);Ta=pc.tokenizeLine(gb,Da[vb],Ta,function(){})}return!0}function Tb(Va,gb,Za,V,O,Ka,ea){gb=pc.linesToTokenize(gb,Za,V,O);Za=gb.lines;pc.tokenizeLines(Va,Za,gb.state,Ka,
ea);return Za}function md(Va,gb,Za,V,O){var Ka=[],ea,Da=function(Bb){return Ka.push(ea=[])},Ta=function(Bb,Ib,wc,yc,gd,$d,te){return ea.push(wc,yc,Bb,gd.current(),Ib.localMode||te)};try{var vb=pc.visitDocumentTokens(Va,gb,Za,V,O,Da,Ta)}catch(Bb){Ka.length=0,vb=pc.visitDocumentTokens(Va,gb,Za,V,null,Da,Ta)}return{tokens:Ka,lines:vb}}function wb(Va,gb,Za,V,O){null==gb&&(gb=Va.search(/[^\s\u00a0]/),-1==gb&&(gb=Va.length));V=V||0;for(O=O||0;;){var Ka=Va.indexOf("\t",V);if(0>Ka||Ka>=gb)return O+(gb-V);
O+=Ka-V;O+=Za-O%Za;V=Ka+1}}function je(Va){Va=Va.toLowerCase();for(var gb=0;gb<pc.modeInfo.length;gb++){var Za=pc.modeInfo[gb];if(Za.mime==Va)return Za;if(Za.mimes)for(var V=0;V<Za.mimes.length;V++)if(Za.mimes[V]==Va)return Za}if(/\+xml$/.test(Va))return je("application/xml");if(/\+json$/.test(Va))return je("application/json")}function bf(Va){for(var gb=0;gb<pc.modeInfo.length;gb++){var Za=pc.modeInfo[gb];if(Za.ext)for(var V=0;V<Za.ext.length;V++)if(Za.ext[V]==Va)return Za}}function Wc(Va){for(var gb=
0;gb<pc.modeInfo.length;gb++){var Za=pc.modeInfo[gb];if(Za.file&&Za.file.test(Va))return Za}gb=Va.lastIndexOf(".");if(Va=-1<gb&&Va.substring(gb+1,Va.length))return pc.findModeByExtension(Va)}function xb(Va){Va=Va.toLowerCase();for(var gb=0;gb<pc.modeInfo.length;gb++){var Za=pc.modeInfo[gb];if(Za.name.toLowerCase()==Va)return Za;if(Za.alias)for(var V=0;V<Za.alias.length;V++)if(Za.alias[V].toLowerCase()==Va)return Za}}function ze(Va){if(!Va)return String(Va);if(Array.isArray(Va))return"["+Va.map(ze).join(",")+
"]";if("symbol"===typeof Va)return ke.printSymbol(Va);try{return String(Va)}catch(gb){return"Cannot print object: "+gb}}function yb(Va,gb){return!ke.arr.every(gb.map(function(Za){return Va[Za]}),function(Za){return ke.obj.equals(Za,Va&&Va.valueOf())})}function nb(Va){if(ke.obj.isPrimitive(Va))var gb=ke.string.print(Va);else Array.isArray(Va)?((gb=3<Va.length)&&(Va=Va.slice(0,3)),Va=ke.string.print(Va),gb&&(Va=Va.slice(0,-1)+", ...]"),gb=Va):gb=ke.string.print(Va);gb=gb.replace(/\n/g,"");500<gb.length&&
(gb=gb.slice(0,20)+("...["+(gb.length-20)+' CHARS]"'));return gb}function Ha(Va){return Hc.Inspector.openInWindow({targetObject:Va})}function R(Va,gb){return Hc.Inspector.openInWindow({remoteTarget:{code:Va,evalEnvironment:gb}})}function xa(Va,gb){function Za(Da){var Ta=Da.name,vb=Da.ownerChain(),Bb=Da.owner,Ib=Da.world(),wc;Da===Ka&&(wc=[ea]);Ib===Da&&(wc=["$world"]);if(!wc&&Ta&&Bb){Bb===Ib&&1===Hc.arr.count(Hc.arr.pluck(Ib.submorphs,"name"),Ta)&&(wc=['$world.get("'+Ta+'")']);if(!wc&&Bb!=Ib)for(Ib=
vb.length-1;Ib--;)if(1===vb[Ib].getAllNamed(Ta).length){wc=[].concat($jscomp.arrayFromIterable(Za(vb[Ib])),['get("'+Ta+'")']);break}wc||(Ta=[].concat($jscomp.arrayFromIterable(Za(Bb)),['get("'+Ta+'")']),Hc.syncEval(Ta.join("."),{context:Ka}).value===Da&&(wc=Ta))}wc||(wc=[ea+'.getMorphById("'+Da.id+'")']);return wc}gb=void 0===gb?{}:gb;var V=Va.world(),O=gb;gb=void 0===O.maxLength?10:O.maxLength;var Ka=void 0===O.fromMorph?V:O.fromMorph;if(Ka===Va)return"this";var ea=V===Ka?"$world":"this";if(!(V||
Va.name&&Ka.get(Va.name)===Va))return"morph";V=Za(Va);return V.length>gb?'$world.getMorphWithId("'+Va.id+'")':V.join(".")}function $a(Va,gb,Za){var V=(gb=void 0===gb?"":gb)&&Qc.arr.last(gb.split(".")).toLowerCase(),O="",Ka=0,ea=Math.pow(2,19);if("string"===typeof Va){if(Va.length>ea)return null}else if(Va.document.stringSize>ea)return null;if("string"===typeof Va)O=Va.slice(0,1E3);else for(Va=$jscomp.makeIterator(Va.document.lines),ea=Va.next();!ea.done;ea=Va.next()){var Da=ea.value;ea=Da.stringSize;
Da=Da.text;var Ta=!0;1E3<Ka+ea&&(Ta=!1,ea=1E3-Ka);O+=Da.slice(0,ea)+(Ta?"\n":"");Ka+=ea;if(1E3<=Ka)break}Ka=$jscomp.makeIterator(Qc.modeInfo);for(Va=Ka.next();!Va.done;Va=Ka.next()){Ta=Va.value;ea=Ta.contentTest;Va=Ta.mode;Da=Ta.ext;Ta=Ta.file;if("function"===typeof ea)try{if(ea(O))return Va}catch(vb){}if(Ta&&Ta instanceof RegExp&&Ta.test(gb))return Va;if(Da)for(ea=$jscomp.makeIterator(Da),Da=ea.next();!Da.done;Da=ea.next())if(Da.value===V)return Va}return Za}Ma({a:Na,d:Ja,r:lc});var Ab=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");
Ab.Color=rb;var bc=function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Za=gb.hasOwnProperty("DefaultTheme")&&"function"===typeof gb.DefaultTheme?gb.DefaultTheme:gb.DefaultTheme=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:"background",get:function(){return Ab.Color.white}},{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",
fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},
{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},
{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},
{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},
{key:"diff-file-header",get:function(){return{fontColor:Ab.Color.white,fontWeight:"bold",backgroundColor:Ab.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Ab.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Ab.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],gb,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Ec=bc=Ab.DefaultTheme;Ab.default=bc;var pc=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");
pc.copyState=ha;pc.startState=Fa;pc.defineMode=Ja;pc.resolveMode=Ca;pc.getMode=ra;pc.innerMode=tb;pc.defineMIME=Na;pc.registerHelper=lc;pc.indentLines=kd;pc.indentLine=function(Va,gb,Za,V,O,Ka,ea){ea=Object.assign({indentWithTabs:!Va.useSoftTabs,indentUnit:Va.tabWidth,tabSize:4,ignoreFollowingText:!1},ea);null==O&&(O="add");"smart"==O&&(gb.indent||(O="prev"));var Da=ea.tabSize,Ta=Za.text,vb=pc.countColumn(Ta,null,Da);Za.modeState&&(Za.modeState=null);var Bb=Ta.match(/^\s*/)[0];if(!Ka&&!/\S/.test(Ta)){var Ib=
0;O="not"}else if("smart"==O&&(Ib=gb.indent(V,ea.ignoreFollowingText?"":Ta.slice(Bb.length),Ta),Ib==pc.passIndent||150<Ib)){if(!Ka)return;O="prev"}"prev"==O?Ib=0<Za.row?pc.countColumn(Za.prevLine().text,null,Da):0:"add"==O?Ib=vb+ea.indentUnit:"subtract"==O?Ib=vb-ea.indentUnit:"number"===typeof O&&(Ib=vb+O);Ib=Math.max(0,Ib);gb="";V=0;if(ea.indentWithTabs)for(ea=Math.floor(Ib/Da);ea;--ea)V+=Da,gb+="\t";V<Ib&&(gb+=" ".repeat(Ib-V));if(gb!=Bb)return Va.replace({start:{row:Za.row,column:0},end:{row:Za.row,
column:Bb.length}},gb),!0};pc.tokenizeLines=function(Va,gb,Za,V,O){if(gb.length){Za=Za?pc.copyState(Va,Za):pc.startState(Va);for(var Ka=0;Ka<gb.length;Ka++){var ea=gb[Ka];V(ea);Za=pc.tokenizeLine(Va,ea,Za,O)}}};pc.tokenizeLine=function(Va,gb,Za,V){var O=gb.text;if(!O)return Za;var Ka=new pc.StringStream(O,2);Za=gb.modeState="function"===typeof Va.copyState?Va.copyState(Za):pc.copyState(Va,Za);gb.prevLine();for(Za._string=O;!Ka.eol();)O=Va.token(Ka,Za),V(O,Za,Ka.start,Ka.pos,Ka,gb,Va),Ka.start=Ka.pos;
return Za};pc.printTokens=function(Va){for(var gb="",Za=0;Za<Va.length;Za+=5)gb+=Va[Za+0]+" => "+Va[Za+1]+" "+Va[Za+2]+" "+Va[Za+3]+" "+Va[Za+4].name+"\n";return gb};pc.visitDocumentTokens=Tb;pc.tokenizeDocument=md;pc.linesToTokenize=function(Va,gb,Za,V){if(V&&V.row>=Za)return{lines:[],state:null};gb=V?Math.max(0,V.row-1):gb;var O=Va.getLine(gb),Ka=O.text;Va=[O];V=null;for(var ea=0,Da;(Da=O.prevLine())&&50>ea++;){O=Da;if(O.modeState){V=O.modeState;break}Va.unshift(O)}if(!V){for(var Ta=O,vb=Infinity;(Da=
O.prevLine())&&100>ea++;){O=Da;if(O.modeState){V=O.modeState;break}Va.unshift(O);Da=Ka.match(/^\s*/)[0].length;if(0===Da)break;Da<vb&&(vb=Da,Ta=O)}!V&&0<vb&&(Va=Va.slice(Va.indexOf(Ta)))}if(Za>gb)for(O=pc.arr.last(Va);gb<=Za;gb++){O=O.nextLine();if(!O)break;Va.push(O)}return{lines:Va,state:V}};pc.countColumn=wb;pc.findModeByMIME=je;pc.findModeByExtension=bf;pc.findModeByFileName=Wc;pc.findModeByName=xb;pc.arr=hc;bc=pc.modes||{};pc.modes=bc;pc.modes=bc;pc.modes=bc;bc=Ma("p",{});pc.passIndent=bc;pc.passIndent=
bc;pc.passIndent=bc;pc.copyState=ha;pc.copyState=ha;pc.startState=Fa;pc.startState=Fa;pc.defineMode=Ja;pc.defineMode=Ja;pc.resolveMode=Ca;pc.resolveMode=Ca;pc.getMode=ra;pc.getMode=ra;pc.innerMode=tb;pc.innerMode=tb;bc={};pc.mimeModes=bc;pc.mimeModes=bc;pc.mimeModes=bc;pc.defineMIME=Na;pc.defineMIME=Na;pc.registerHelper=lc;pc.registerHelper=lc;pc.indentLines=kd;pc.indentLines=kd;pc.visitDocumentTokens=Tb;pc.visitDocumentTokens=Tb;pc.tokenizeDocument=md;pc.tokenizeDocument=md;pc.countColumn=wb;pc.countColumn=
wb;(function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Za=gb.hasOwnProperty("StringStream")&&"function"===typeof gb.StringStream?gb.StringStream:gb.StringStream=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:Symbol.for("lively-instance-initialize"),value:function(V,O){this.reset(V,O)}},{key:"reset",value:function(V,O){this.pos=this.start=0;this.string=void 0===V?
"":V;this.tabSize=void 0===O?2:O;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(V){var O=this.string.charAt(this.pos);if("string"===typeof V?O==V:O&&(V.test?V.test(O):
V(O)))return++this.pos,O}},{key:"eatWhile",value:function(V){for(var O=this.pos;this.eat(V););return this.pos>O}},{key:"eatSpace",value:function(){for(var V=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>V}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(V){V=this.string.indexOf(V,this.pos);if(-1<V)return this.pos=V,!0}},{key:"backUp",value:function(V){this.pos-=V}},{key:"column",value:function(){this.lastColumnPos<
this.start&&(this.lastColumnValue=pc.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?pc.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return pc.countColumn(this.string,null,this.tabSize)-(this.lineStart?pc.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(V,O,Ka){if("string"===typeof V){var ea=function(Ta){return Ka?
Ta.toLowerCase():Ta},Da=this.string.substr(this.pos,V.length);if(ea(Da)==ea(V))return!1!==O&&(this.pos+=V.length),!0}else{if((V=this.string.slice(this.pos).match(V))&&0<V.index)return null;V&&!1!==O&&(this.pos+=V[0].length);return V}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(V,O){this.lineStart+=V;try{return O()}finally{this.lineStart-=V}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],gb,
{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10526,end:13053})})(void 0);bc=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",
mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",
mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl",
"lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",
mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Va){return Va.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",
mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",
mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",
mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",
mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript",
"application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},
{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",
mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},
{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",
mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",
mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",
mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",
mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Va){return Va.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",
mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",
mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",
mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",
ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue",
"text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen",
"mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];pc.modeInfo=bc;pc.modeInfo=bc;pc.modeInfo=bc;for(var wd=0;wd<pc.modeInfo.length;wd++)pc.info=pc.modeInfo[wd],pc.info.mimes&&(pc.info.mime=pc.info.mimes[0]);pc.defineMode("null",function(){return{token:function(Va){return Va.skipToEnd()}}});pc.defineMIME("text/plain","null");pc.findModeByMIME=je;pc.findModeByMIME=je;pc.findModeByExtension=bf;pc.findModeByExtension=
bf;pc.findModeByFileName=Wc;pc.findModeByFileName=Wc;pc.findModeByName=xb;pc.findModeByName=xb;var xd=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");xd.Color=rb;xd.Rectangle=Kb;xd.pt=id;xd.morph=Zc;xd.ShadowObject=yd;xd.StyleSheet=Kc;xd.connect=sc;xd.arr=hc;xd.string=bd;xd.FilterableList=hd;xd.Range=se;wd=function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Za=gb.hasOwnProperty("Completer")&&"function"===typeof gb.Completer?gb.Completer:gb.Completer=
function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],gb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:347,end:394})}(void 0);xd.Completer=wd;xd.Completer=wd;xd.Completer=wd;wd=function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Za=gb.hasOwnProperty("WordCompleter")&&"function"===typeof gb.WordCompleter?gb.WordCompleter:gb.WordCompleter=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:"compute",value:function(V,O){var Ka=[],ea=[],Da=V.document.lineStrings;
V=V.cursorPosition.row;for(var Ta=V-1;0<=Ta;Ta--)for(var vb=$jscomp.makeIterator(Da[Ta].split(/[^0-9a-z@_]+/i)),Bb=vb.next();!Bb.done;Bb=vb.next())(Bb=Bb.value)&&!Ka.includes(Bb)&&Bb!==O&&(Ka.push(Bb),ea.push({priority:1E3-(V-Ta),completion:Bb}));for(Ta=V+1;Ta<Da.length;Ta++)for(vb=$jscomp.makeIterator(Da[Ta].split(/[^0-9a-z_@]+/i)),Bb=vb.next();!Bb.done;Bb=vb.next())(Bb=Bb.value)&&!Ka.includes(Bb)&&Bb!==O&&(Ka.push(Bb),ea.push({priority:1E3-(Ta-V),completion:Bb}));return ea}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"WordCompleter"}}],gb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);xd.WordCompleter=wd;xd.WordCompleter=wd;xd.WordCompleter=wd;wd=[new xd.WordCompleter];xd.defaultCompleters=wd;xd.defaultCompleters=wd;xd.defaultCompleters=wd;wd=function(Va){var gb=
lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Za=gb.hasOwnProperty("CompletionController")&&"function"===typeof gb.CompletionController?gb.CompletionController:gb.CompletionController=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:Symbol.for("lively-instance-initialize"),value:function(V,O){O=void 0===O?[]:O;this.textMorph=V;this.completers=O=V.pluginCollect("getCompleters",
O)}},{key:"computeCompletions",value:function(V){var O=this,Ka,ea,Da,Ta,vb,Bb,Ib,wc,yc,gd,$d,te,Ed,Je,He,ye;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oe){switch(oe.nextAddress){case 1:Ka=[],ea=$jscomp.makeIterator(O.completers),Da=ea.next();case 2:if(Da.done){oe.jumpTo(4);break}Ta=Da.value;oe.setCatchFinallyBlocks(5);vb=Ka;Bb=vb.concat;return oe.yield(Ta.compute(O.textMorph,V),7);case 7:Ka=Bb.call(vb,oe.yieldResult);oe.leaveTryBlock(3);break;case 5:Ib=oe.enterCatchBlock(),console.warn("Error in completer "+
Ta+": "+(Ib.stack||Ib));case 3:Da=ea.next();oe.jumpTo(2);break;case 4:wc=new Map;Ka.forEach(function(of){var Cf=wc.get(of.completion);Cf||(Cf=[],wc.set(of.completion,Cf));Cf.push(of)});yc=[];gd=$jscomp.makeIterator(wc.values());for($d=gd.next();!$d.done;$d=gd.next())te=$d.value,yc.push(xd.arr.last(xd.arr.sortByKey(te,"priority")));Ed=0;Je=xd.arr.sortByKey(yc,"priority").reverse();He=Je.length&&Je[0].priority||0;ye=Je.map(function(of){of.highestPriority=He;var Cf=of.completion.replace(/\n/g,""),rh=
String((of.info||"").replace(/\n/g,""));Ed=Math.max(Ed,Cf.length+rh.length);return{isListItem:!0,string:Cf,annotation:rh,value:of}});return oe.return({items:ye,maxCol:Ed})}})}},{key:"computeSortedCompletions",value:function(V,O){O=void 0===O?!1:O;var Ka=this,ea,Da,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vb){if(1==vb.nextAddress)return ea={tokens:[V],lowercasedTokens:[V],input:V},vb.yield(Ka.computeCompletions(V),2);Da=vb.yieldResult;Ta=xd.arr.sortBy(Da.items.filter(function(Bb){return Ka.filterFunction(ea,
Bb,O)}),function(Bb){return Ka.sortFunction(ea,Bb)});return vb.return(Ta)})}},{key:"_printCompletions",value:function(V){var O=this,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){if(1==ea.nextAddress)return ea.yield(O.computeSortedCompletions(V),2);Ka=ea.yieldResult.map(function(Da){return{completion:Da.value.completion,priority:Da.value.priority,maxP:Da.value.highestPriority,sortVal:Da._cache[V].sortVal,lev:JSON.stringify(Da._cache[V].levenshtein)}});return ea.return(xd.string.printTable(lively.lang.grid.tableFromObjects(Ka)))})}},
{key:"prefix",value:function(){var V=this.textMorph,O=V.selection;return(O.isEmpty()?V.getLine(O.lead.row).slice(0,O.lead.column):O.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(V,O,Ka){Ka=void 0===Ka?!1:Ka;O._cache||(O._cache={});var ea=V.tokens,Da=V.lowercasedTokens,Ta=V.input;Ta=O._cache[Ta]||(O._cache[Ta]={});if(Ta.hasOwnProperty("filtered"))return Ta.filtered;O=O.value.completion.replace(/\([^\)]*\)$/,"");var vb=O.toLowerCase();if(Ka&&ea[0]&&!O.startsWith(ea[0]))return Ta.filtered=
!1;if(Da.every(function(Ib){return vb.includes(Ib)}))return!0;var Bb=Ta.levenshtein||(Ta.levenshtein={});V=Ka||3>=xd.arr.sum(V.lowercasedTokens.map(function(Ib){return Bb[Ib]||(Bb[Ib]=xd.string.levenshtein(vb,Ib))}));return Ta.filtered=V}},{key:"sortFunction",value:function(V,O){O._cache||(O._cache={});var Ka=O._cache[V.input]||(O._cache[V.input]={});if(Ka.hasOwnProperty("sortVal"))return Ka.sortVal;Ka=O._cache[V.input]={};var ea=O.value;O=ea.highestPriority;var Da=ea.completion;ea=ea.priority;Da=
Da.replace(/\([^\)]*\)$/,"").toLowerCase();var Ta=0;V.lowercasedTokens.forEach(function(Bb){Da.startsWith(Bb)?Ta+=12:3<=Bb.length&&Da.includes(Bb)&&(Ta+=5)});O=-((ea||(Ta?O:0))/Math.pow(10,String(O).length-2))-Ta;var vb=Ka.levenshtein||(Ka.levenshtein={});V=xd.arr.sum(V.lowercasedTokens.map(function(Bb){return vb[Bb]||(vb[Bb]=xd.string.levenshtein(Da,Bb))}));Ta&&(V/=2);return Ka.sortVal=V+O}},{key:"positionForMenu",value:function(){var V=this.textMorph,O=V.charBoundsFromTextPosition(V.cursorPosition);
return V.getGlobalTransform().transformRectToRect(O).topLeft().addXY(-V.scroll.x,-V.scroll.y).addPt(xd.pt(V.borderWidth+4,V.borderWidth+4))}},{key:"completionListSpec",value:function(){var V=this,O,Ka,ea,Da,Ta,vb,Bb,Ib,wc,yc,gd,$d,te,Ed,Je,He,ye,oe,of,Cf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rh){if(1==rh.nextAddress)return Ka=O=V.textMorph,ea=Ka.fontSize,Da=Ka.fontFamily,Ta=V.positionForMenu(),vb=V.prefix(),rh.yield(V.computeCompletions(vb),2);Bb=rh.yieldResult;Ib=Bb.items;wc=
Bb.maxCol;yc=O.env.fontMetric.sizeFor(Da,ea,"M");gd=yc.width*wc;$d=O.document.getLine(0).height;te=Math.max(120,gd<O.width?gd:O.width);Ed=$d*Ib.length+$d+10;Je=Math.max(70,Math.min(700,Ed));He=Ta.extent(xd.pt(te,Je));if(ye=O.world())oe=ye.visibleBounds().insetBy(5),He.bottom()>oe.bottom()&&(of=He.bottom()-oe.bottom(),of>He.height-50&&(of=He.height-50),He.height-=of),He.right()>oe.right()&&(Cf=He.right()-oe.right(),He.width=120>He.width-Cf?120:He.width-Cf),oe.containsRect(He)||(He=He.withTopLeft(oe.translateForInclusion(He).topLeft())),
He=He.translatedBy(oe.insetBy(0).topLeft().negated());return rh.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},hasFixedPosition:!0,epiMorph:!0,fontSize:ea,position:He.topLeft(),extent:He.extent(),items:Ib,input:vb,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:V.filterFunction,sortFunction:V.sortFunction})})}},{key:"removeMenuOnBlur",value:function(V){var O=V.menu;setTimeout(function(){O.withAllSubmorphsDetect(function(Ka){return Ka.isFocused()})?
O.inputMorph.focus():O.remove()})}},{key:"openCompletionList",value:function(){var V=this,O,Ka,ea,Da,Ta,vb,Bb,Ib,wc,yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gd){if(1==gd.nextAddress)return O=V.textMorph.selection.start,gd.yield(V.completionListSpec(),2);if(3!=gd.nextAddress)return Ka=gd.yieldResult,V.textMorph.pluginFind(function($d){return $d.theme}),ea=new xd.FilterableList(Ka),Da=new xd.Range({start:O,end:V.textMorph.selection.start}),Ta=V.textMorph.textInRange(Da),vb=ea.inputMorph,
Bb=ea.listMorph,Ib=Ka.input,wc=ea.addMorph({name:"prefix mask",fill:xd.Color.transparent,bounds:vb.textBounds()},vb),Bb.master=null,Da.isEmpty()||(V.textMorph.deleteText(Da),vb.input=Ta,vb.gotoDocumentEnd()),vb.fontColor=V.textMorph.fontColor,xd.connect(vb,"textString",wc,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:vb}}),xd.connect(ea,"accepted",V,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Ib}}),xd.connect(ea,"accepted",ea,"remove"),xd.connect(ea,"canceled",ea,"remove"),xd.connect(ea,"remove",V.textMorph,"focus"),xd.connect(ea.inputMorph,"onBlur",V,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:ea}}),yc=V.textMorph.world(),Bb.addStyleClass("hiddenScrollbar"),ea.paddingMorph.height=2,vb.height=Bb.itemHeight,vb.clipMode="visible",vb.fill=V.textMorph.fill,vb.fixedHeight=!0,vb.fixedWidth=!1,vb.fontSize=Bb.fontSize,ea.relayout(),ea.selectedIndex=
0,ea.master.applyIfNeeded(!0),vb.focus(),gd.yield(ea.master.whenApplied(),3);Ib.length&&(vb.gotoDocumentEnd(),ea.moveBy(xd.pt(-vb.textBounds().width,0)));yc.addMorph(ea);ea.inputPadding=xd.Rectangle.inset(0,0,0,0);return gd.return(ea)})}},{key:"autoInsertBestMatchingCompletion",value:function(V,O,Ka){O=void 0===O?!0:O;var ea=this,Da,Ta,vb,Bb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ib){if(1==Ib.nextAddress)return Da=$jscomp,Ta=Da.makeIterator,Ib.yield(ea.computeSortedCompletions(V,
O),2);vb=Ta.call(Da,Ib.yieldResult);(Bb=vb.next().value)&&ea.insertCompletion(Bb.value.completion,V,Ka);Ib.jumpToEnd()})}},{key:"insertCompletion",value:function(V,O,Ka){var ea=this.textMorph,Da=ea.document,Ta=ea.selection.isMultiSelection?ea.selection.selections:[ea.selection];ea.undoManager.group();Ta.forEach(function(vb){vb.collapseToEnd();var Bb=vb.lead,Ib=O?Da.indexToPosition(Da.positionToIndex(Bb)-O.length):Bb;"function"===typeof Ka?Ka(V,O,ea,{start:Ib,end:Bb},vb):ea.replace({start:Ib,end:Bb},
V)});ea.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],gb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);xd.CompletionController=wd;xd.CompletionController=wd;xd.CompletionController=wd;wd=[{name:"text completion",
handlesCount:!0,multiSelectAction:"single",exec:function(Va,gb,Za){var V;return $jscomp.asyncExecutePromiseGeneratorProgram(function(O){return 1==O.nextAddress?(V=new xd.CompletionController(Va,xd.defaultCompleters),O.yield(V.openCompletionList(),2)):O.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Va,gb,Za){var V;return $jscomp.asyncExecutePromiseGeneratorProgram(function(O){return 1==O.nextAddress?(V=new xd.CompletionController(Va,xd.defaultCompleters),
O.yield(V.autoInsertBestMatchingCompletion(V.prefix()),2)):O.return(!0)})}}];xd.completionCommands=wd;xd.completionCommands=wd;xd.completionCommands=wd;var Se=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Se.chain=xe;Se.arr=hc;Se.obj=ne;Se.string=bd;var v=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Va){var gb=Va.selection.start;0<gb.row&&(gb=Va.getPositionAboveOrBelow(1,gb,!0,0,Va.charBoundsFromTextPosition(gb).x),Va.selection.addRange({start:gb,
end:gb}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Va){var gb=Va.selection.start;gb.row<Va.documentEndPosition.row&&(gb=Va.getPositionAboveOrBelow(-1,gb,!0,0,Va.charBoundsFromTextPosition(gb).x),Va.selection.addRange({start:gb,end:gb}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Va){var gb=Va.selection.selections[Va.selection.selections.length-1];if(gb.isEmpty())return!0;Va.searchForAll(gb.text,{start:{column:0,
row:0}}).forEach(function(Za){return Va.selection.addRange(Za.range,!1)});Va.selection.mergeSelections();Se.arr.remove(Va.selection.selections,gb);Va.selection.selections.push(gb);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Va){var gb=Va.selection.selections.length-1,Za=Va.selection.selections[gb];if(Za.isEmpty())return!0;var V=Va.search(Za.text,{start:Za.end,backwards:!1});V&&(Za=Va.selection.selections.findIndex(function(O){return O.range.equals(V.range)}),
-1<Za?Se.arr.swap(Va.selection.selections,Za,gb):Va.selection.addRange(V.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Va){var gb=Va.selection.selections.length-1,Za=Va.selection.selections[gb];if(Za.isEmpty())return!0;var V=Za.start,O=Va.search(Za.text,{start:{row:V.row,column:V.column-(Za.text.length-1)},backwards:!0});O&&(Za=Va.selection.selections.findIndex(function(Ka){return Ka.range.equals(O.range)}),-1<Za?Se.arr.swap(Va.selection.selections,
Za,gb):Va.selection.addRange(O.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Va){var gb=Va.selection.selections.length;1<gb&&Va.selection.removeSelections(gb-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Va){Va.selection.selections=lively.lang.arr.rotate(Va.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(Va){Va.selection.selections=
lively.lang.arr.rotate(Va.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Va){var gb=Va.selection.selections;if(1>=gb.length)return!0;var Za=Se.arr.groupBy(gb,function(O){return O.range.start.row});gb=Za.keys().map(function(O){O=Za[O];var Ka=Se.arr.max(O,function(ea){return ea.range.start.column});Se.arr.without(O,Ka).forEach(function(ea){return ea.range=Ka.range});return Ka});var V=Se.arr.max(gb,function(O){return O.range.start.column}).range.start.column;
gb.forEach(function(O){var Ka=O.range.start;O=Ka.row;Ka=Ka.column;Va.insertText(" ".repeat(V-Ka),{row:O,column:Ka})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Va){Va.selection.disableMultiSelect();if(Va.selection.isEmpty())var gb=Va.lastSavedMark&&Va.lastSavedMark.position||(void 0).lineRange().start,Za=Va.cursorPosition;else gb=Va.selection,Za=gb.lead,gb=gb.anchor;Va.selection.collapse();var V=gb.column,O=Za.column;Se.arr.range(gb.row,
Za.row).forEach(function(Ka){return Va.getLine(Ka).length>Math.min(O,V)&&Va.selection.addRange({end:{row:Ka,column:O},start:{row:Ka,column:V}},!1)});Va.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Va,gb,Za){Za=void 0===Za?1:Za;Va.undoManager.group();Va.selection.selections.forEach(function(V,O){return V.text=String(O+Za)});Va.undoManager.group();return!0}}];Se.multiSelectCommands=v;Se.multiSelectCommands=v;Se.multiSelectCommands=
v;var Ie=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");Ie.pToI=function(Va,gb){return Va.positionToIndex(gb)};Ie.iToP=function(Va,gb){return Va.indexToPosition(gb)};Ie.execCodeNavigator=function(Va){return function(gb,Za,V){var O=gb.pluginInvokeFirst("getNavigator");if(!O)return!0;gb.saveMark();V=V||1;for(var Ka=0;Ka<V;Ka++)O[Va](gb,Za);return!0}};Ie.once=Rc;var cf=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Ie.execCodeNavigator("forwardSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:Ie.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Ie.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Ie.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",
exec:Ie.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Va,gb){function Za(){var Ka=Va.$expandRegionState,ea=Ie.pToI(Va,Va.cursorPosition);if(Ka&&(Ka.range[0]===ea||Ka.range[1]===ea))return Ka;Ka=Va.selection.range;return Va.$expandRegionState={range:[Ie.pToI(Va,Ka.start),Ie.pToI(Va,Ka.end)]}}gb=gb||{};var V=Va.pluginInvokeFirst("getNavigator");if(!V)return!0;
var O=gb.start;gb=gb.end;if("number"===typeof O&&"number"===typeof gb)Za(),V={range:[O,gb],prev:Za()};else{O=V.ensureAST(Va);if(!O)return;V=V.expandRegion(Va,Va.textString,O,Za())}V&&V.range&&(Va.selection={start:Ie.iToP(Va,V.range[0]),end:Ie.iToP(Va,V.range[1])},Va.$expandRegionState=V);Ie.once(Va,"selectionChange",function(){return Va.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},
exec:function(Va){if(Va.selection.isEmpty())return!0;var gb=Va.pluginInvokeFirst("getNavigator");if(!gb)return!0;var Za=gb.ensureAST(Va);if(!Za)return!0;var V=Va.$expandRegionState;if(!V)return!0;(gb=gb.contractRegion(Va,Va.textString,Za,V))&&gb.range&&(Va.selection={start:Ie.iToP(Va,gb.range[0]),end:Ie.iToP(Va,gb.range[1])},Va.$expandRegionState=gb);Ie.once(Va,"selectionChange",function(){return Va.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Ie.commands=cf;
Ie.commands=cf;Ie.commands=cf;var df=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");df.arr=hc;df.chain=xe;df.string=bd;var Ze=[{name:"toggle comment",exec:function(Va){var gb=Va.pluginInvokeFirst("getComment");if(!gb)return!0;if(!gb.lineCommentStart)return gb.blockCommentStart?Va.execCommand("toggle block comment"):!0;var Za=gb.lineCommentStart,V=new RegExp("^(\\s*)("+Za+"\\s?)(.*)");gb=Va.document;var O=Va.selection;O.isEmpty()||0!==O.end.column||O.growRight(-1);var Ka=
O.start.row;gb=gb.lineStrings.slice(O.start.row,O.end.row+1);gb=gb.some(function(Ta){return!!Ta.trim()})?df.arr.dropWhile(gb,function(Ta){return Ta.trim()?!1:++Ka&&!0}):gb;var ea=gb.every(function(Ta){return Ta.trim()&&Ta.match(V)});Va.undoManager.group();if(ea)gb.forEach(function(Ta,vb){if(Ta=Ta.match(V)){Ta=$jscomp.makeIterator(Ta);Ta.next();var Bb=Ta.next().value,Ib=Ta.next().value;Ta.next();Va.deleteText({start:{row:Ka+vb,column:Bb.length},end:{row:Ka+vb,column:Bb.length+Ib.length}})}});else{var Da=
gb.reduce(function(Ta,vb,Bb){return vb.trim()||O.isEmpty()&&O.start.row===O.end.row?Math.min(Ta,vb.match(/^\s*/)[0].length):Ta},Infinity);Da=Infinity===Da?0:Da;gb.forEach(function(Ta,vb){Ta=$jscomp.makeIterator(Ta.match(/^(\s*)(.*)/));Ta.next();Ta.next();Ta.next();Va.insertText(Za+" ",{row:Ka+vb,column:Da})})}Va.undoManager.group();return!0}},{name:"toggle block comment",exec:function(Va){var gb=Va.pluginInvokeFirst("getComment");if(!gb)return!0;if(!gb.blockCommentStart)return gb.lineCommentStart?
Va.execCommand("toggle comment"):!0;if(!gb||!gb.blockCommentStart)return!0;var Za=gb.blockCommentStart;gb=gb.blockCommentEnd;var V=new RegExp("^"+Za.replace(/\*/g,"\\*")),O=new RegExp(gb.replace(/\*/g,"\\*")+"$"),Ka=Va.tokenAt(Va.cursorPosition);if(Ka&&"comment"===Ka.token){var ea=Va.textInRange(Ka);if(ea.match(V)&&ea.match(O))return Va.undoManager.group(),Va.replace(Ka,ea.slice(Za.length,-gb.length)),Va.undoManager.group(),!0}Va.undoManager.group();Va.insertText(Za,Va.selection.start);Va.insertText(gb,
Va.selection.end);Va.undoManager.group();Za=!Va.selection.isEmpty();Va.selection.growLeft(gb.length);Za||Va.selection.collapse();return!0}},{name:"comment box",exec:function(Va,gb,Za){gb=Va.undoManager.ensureNewGroup(Va,"comment box");if(Va.selection.isEmpty())return Va.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Va.execCommand("toggle comment"),Va.undoManager.group(gb),!0;var V=Va.selection.range,O=Va.withSelectedLinesDo(function(ea){return ea}),Ka=df.arr.min([V.start.column].concat(df.chain(O).map(function(ea){return ea.match(/^\s*/)}).flatten().compact().pluck("length").value()));
O=df.arr.max(O.map(function(ea){return ea.length}))-Ka;O=Array(Math.ceil(O/2)+1).join("-=")+"-";Va.execCommand("toggle comment");Va.collapseSelection();Va.cursorPosition={row:V.start.row,column:0};Za?Va.insertText(df.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",Ka)):Va.insertText(df.string.indent(O+"\n"," ",Ka));Va.selection.goUp();Va.execCommand("toggle comment");Va.cursorPosition={row:V.end.row+2,column:0};Va.insertText(df.string.indent(O+"\n"," ",Ka));Va.selection.goUp();
Va.execCommand("toggle comment");Va.selection.range={start:{row:V.start.row,column:0},end:Va.cursorPosition};Va.undoManager.group(gb);return!0},multiSelectAction:"forEach",handlesCount:!0}];df.commands=Ze;df.commands=Ze;df.commands=Ze;var ke=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");ke.printSymbol=function(Va){if(Symbol.keyFor(Va))return'Symbol.for("'+Symbol.keyFor(Va)+'")';if(ke.knownSymbols.get(Va))return ke.knownSymbols.get(Va);String(Va).match(ke.symMatcher);return String(Va)};
ke.defaultSort=function(Va,gb){if(Va.hasOwnProperty("priority")||gb.hasOwnProperty("priority")){var Za=Va.priority||0,V=gb.priority||0;if(Za<V)return-1;if(Za>V)return 1}Va=(Va.keyString||Va.key).toLowerCase();gb=(gb.keyString||gb.key).toLowerCase();return Va<gb?-1:Va===gb?0:1};ke.safeToString=ze;ke.propertyNamesOf=function(Va,gb){if(!Va)return[];if(Array.isArray(Va)){var Za=gb?gb.offset:0;return ke.arr.range(Za,Za+(gb?gb.partitionSize:Va.length-1))}return ke.arr.sortBy(Object.keys(Va),function(V){return V.toLowerCase()})};
ke.isMultiValue=yb;ke.printValue=nb;ke.partitionedChildren=function(Va,gb){var Za=void 0===gb?{}:gb;gb=void 0===Za.originalValue?Va:Za.originalValue;var V=void 0===Za.offset?0:Za.offset;Za=void 0===Za.partitionSize?Va.length||Object.values(Va).length:Za.partitionSize;if(ke.obj.isArray(Va)){Va=ke.num.roundTo(Math.max(ke.MIN_PARTITION_SIZE,Za/50),.1);Za/=Va;for(var O=[],Ka=0;Ka<Za;Ka++){var ea="["+(V+Ka*Va)+"-"+(V+(Ka+1)*Va)+"]";O.push({partition:{originalValue:gb,offset:V+Ka*Va,partitionSize:Va},value:[],
key:ea,keyString:ea,valueString:"...",isCollapsed:!0})}return O}Va=ke.num.roundTo(Math.max(ke.MIN_PARTITION_SIZE,Za/50),.1);Za/=Va;O=[];Ka=ke.obj.keys(gb).sort();for(ea=0;ea<Za;ea++){var Da=V+ea*Va,Ta=V+(ea+1)*Va,vb=ke.obj.select(gb,Ka.slice(Da,Ta));Da="["+Ka[Da].slice(0,4)+"-"+(Ka[Ta]||ke.arr.last(Ka)).slice(0,4)+"]";O.push({partition:{originalValue:vb,offset:V+ea*Va,partitionSize:Va},value:[],key:Da,keyString:Da,valueString:"...",isCollapsed:!0})}return O};ke.propertiesOf=function(Va){var gb=Va.partition?
Va.target:Va.value;if(!gb)return[];var Za={_rev:!0},V=[],O="function"===typeof gb.livelyCustomInspect?gb.livelyCustomInspect():{},Ka=Object.assign({},ke.defaultPropertyOptions,{},O);if(O.properties){O=$jscomp.makeIterator(O.properties);for(var ea=O.next();!ea.done;ea=O.next()){var Da=ea.value;ea=Da.key;var Ta=Da.hidden,vb=Da.priority,Bb=Da.keyString,Ib=Da.value;Da=Da.valueString;Za[ea]=!0;Ta||V.push(Va.getSubNode({priority:vb,key:ea,keyString:Bb||ke.safeToString(ea),value:Ib,valueString:Da,isCollapsed:!0}))}}if(Ka.includeDefault){O=
ke.propertyNamesOf(gb,Va.partition);if(O.length>ke.MAX_NODE_THRESHOLD)for(Za=$jscomp.makeIterator(ke.partitionedChildren(gb,Va.partition)),O=Za.next();!O.done;O=Za.next())V.push(Va.getSubNode(O.value));else for(Ta=$jscomp.makeIterator(O),O=Ta.next();!O.done;O=Ta.next())vb=O.value,vb in Za||(O=gb[vb],ea=ke.printValue(O),O={keyString:vb,key:vb,value:O,valueString:ea,isCollapsed:!0},V.push(Va.getSubNode(O)));if(Ka.includeSymbols)for(Za=$jscomp.makeIterator(Object.getOwnPropertySymbols(gb)),O=Za.next();!O.done;O=
Za.next())Ta=O.value,vb=ke.safeToString(Ta),O=gb[Ta],ea=ke.printValue(O),O={key:Ta,keyString:vb,value:O,valueString:ea,isCollapsed:!0},V.push(Va.getSubNode(O))}Ka.sort&&(V=Ka.sortFunction(gb,V));return V};ke.obj=ne;ke.num=Pd;ke.arr=hc;ke.string=bd;ke.connect=sc;ke.signal=Hb;ke.TreeData=Gc;ke.newUUID=ud;ke.localInterface=X;ke.MAX_NODE_THRESHOLD=1E3;ke.MIN_PARTITION_SIZE=250;ke.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Va,gb){return Array.isArray(Va)?
gb:gb.sort(ke.defaultSort)}};ke.symMatcher=/^Symbol\((.*)\)$/;ke.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Va){return"symbol"===typeof Symbol[Va]}).reduce(function(Va,gb){return Va.set(Symbol[gb],"Symbol."+gb)},new Map)}();ke.isMultiValue=yb;ke.isMultiValue=yb;ke.printValue=nb;ke.printValue=nb;var Ke=function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Za=gb.hasOwnProperty("InspectionTree")&&"function"===typeof gb.InspectionTree?
gb.InspectionTree:gb.InspectionTree=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:Symbol.for("lively-instance-initialize"),value:function(V){Db._get(Object.getPrototypeOf(Za.prototype),Symbol.for("lively-instance-initialize"),this).call(this,V);this.inspector=V.inspector;this.root.isInspectionNode||(this.root=ke.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},
{key:"asListWithIndexAndDepth",value:function(V){V=void 0===V?!0:V;return Db._get(Object.getPrototypeOf(Za.prototype),"asListWithIndexAndDepth",this).call(this,function(O){O=O.node;return V?O.visible:!0})}},{key:"getContextFor",value:function(V){return V==this.root?this.root.value.inspectee:V.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(V){var O=void 0===V.maxDepth?1:V.maxDepth,Ka=V.iterator,ea=V.showUnknown,Da=V.showInternal,Ta=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vb){if(1==
vb.nextAddress)return vb.yield(Ta.uncollapseAll(function(Bb,Ib){return O>Ib&&(Bb==Ta.root||Bb.value.submorphs)}),2);Ta.asListWithIndexAndDepth(!1).forEach(function(Bb){var Ib=Bb.node;return 0==Bb.depth?Ib.visible=!0:!ea&&Ib.keyString&&Ib.keyString.includes("UNKNOWN PROPERTY")||!Da&&Ib.keyString&&Ib.keyString.includes("internal")?Ib.visible=!1:Ib.value&&Ib.value.submorphs?Ib.visible=!0:Ib.visible=Ka(Ib)});vb.jumpToEnd()})}},{key:"getChildren",value:function(V){return V.children}},{key:"display",value:function(V){return V.display(this.inspector)}},
{key:"isCollapsed",value:function(V){return V.isCollapsed}},{key:"isLeaf",value:function(V){return ke.obj.isPrimitive(V.value)}},{key:"collapse",value:function(V,O){var Ka=this;V.isCollapsed=O;O||this.isLeaf(V)||V.children.length||(V.children=ke.propertiesOf(V).map(function(ea){Ka.parentMap.set(ea,V);return ea}))}},{key:"retrieveForRemoteProxy",value:function(V){V.uuid||(V.uuid=ke.newUUID(),this.idToNodeMap[V.uuid]=V);return{uuid:V.uuid,value:this.isLeaf(V)?V.value:{},keyString:V.keyString,key:V.keyString,
valueString:ke.safeToString(V.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return ke.localInterface}},{key:"getNodeViaId",value:function(V){return this.idToNodeMap[V]}},{key:"asRemoteDelegate",value:function(V){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[V]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(V,O){return new this({key:"inspectee",value:{inspectee:V},isCollapsed:!0,inspector:O})}}],gb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(ke.TreeData);ke.InspectionTree=Ke;ke.InspectionTree=
Ke;ke.InspectionTree=Ke;var yf=function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Za=gb.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof gb.RemoteInspectionTree?gb.RemoteInspectionTree:gb.RemoteInspectionTree=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(V){this.parentMap=new WeakMap;this.root=V.proxy;this.evalEnvironment=V.evalEnvironment;this.inspector=V.inspector;this.delegateId=V.delegateId}},{key:"getContextFor",value:function(V){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+V.uuid+'").value'}},{key:"dispose",value:function(){var V=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(O){return O.yield(V.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
V.delegateId+"']\n    ",V.evalEnvironment),0)})}},{key:"display",value:function(V){return V.keyString+": "+V.valueString}},{key:"collapse",value:function(V,O){var Ka=this,ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){if(1==Da.nextAddress)return(V.isCollapsed=O)||Ka.isLeaf(V)?Da.return():V.children.length?Da.jumpTo(0):Da.yield(Ka.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+V.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Ka.delegateId+'"]'}),3);ea=Da.yieldResult;V.children=ea.isError?[]:ea.value;Da.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(V,O){var Ka=this,ea,Da,Ta,vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bb){if(1==Bb.nextAddress)return Bb.yield(Ka.createRemoteContext(V,O),2);ea=Bb.yieldResult;
Da=ea.proxy;Ta=ea.delegateId;vb=ea.evalEnvironment;return Bb.return(new Ka({key:"inspectee",proxy:Da,delegateId:Ta,evalEnvironment:vb,inspector:O}))})}},{key:"createRemoteContext",value:function(V,O){var Ka=V.code,ea=V.evalEnvironment,Da=V.delegateId,Ta,vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bb){if(1==Bb.nextAddress)return Da="lively://inspector-"+O.id,Bb.yield(ea.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Ka+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Da+'");\n    ',ea),2);Ta=Bb.yieldResult;vb=Ta.value;return Bb.return({delegateId:Da,evalEnvironment:ea,proxy:vb})})}}],gb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(ke.InspectionTree);
ke.RemoteInspectionTree=yf;ke.RemoteInspectionTree=yf;ke.RemoteInspectionTree=yf;(function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Za=gb.hasOwnProperty("InspectionNode")&&"function"===typeof gb.InspectionNode?gb.InspectionNode:gb.InspectionNode=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:Symbol.for("lively-instance-initialize"),value:function(V){var O=
V.root,Ka=V.priority,ea=V.key,Da=V.keyString,Ta=V.value,vb=V.valueString,Bb=V.isCollapsed,Ib=void 0===V.children?[]:V.children,wc=void 0===V.isSelected?!1:V.isSelected,yc=void 0===V.visible?!0:V.visible;this.partition=V.partition;this.priority=Ka;this.key=ea;this.keyString=String(Da||ea);this.value=Ta;this.valueString=vb||ke.printValue(Ta);this.isCollapsed=Bb;this.children=Ib;this.isSelected=wc;this.visible=yc;this.root=O}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(V){if(V.value&&V.value.isMorph)return new ke.MorphNode(Object.assign({root:this.root},V));var O=V.key,Ka=V.keyString,ea=this.value,Da=V.partition;Da&&(ea=Da.originalValue,Ka=O);return new ke.PropertyNode(Object.assign({},V,{keyString:Ka,key:O,target:ea,partition:Da,root:this.root,spec:{}}))}},{key:"display",value:function(V){var O=this.keyString,Ka=this.valueString;if(!this.interactive)return O+": "+Ka;this._propertyWidget||(this._propertyWidget=
V.renderDraggableTreeLabel({value:O+": "+Ka}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(V,O){O=void 0===O?null:O;return V.value&&V.value.isMorph?new ke.MorphNode(Object.assign({root:O},V)):new ke.InspectionNode(Object.assign({root:O},V))}}],gb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Za=gb.hasOwnProperty("MorphNode")&&"function"===typeof gb.MorphNode?gb.MorphNode:gb.MorphNode=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:Symbol.for("lively-instance-initialize"),
value:function(V){Db._get(Object.getPrototypeOf(Za.prototype),Symbol.for("lively-instance-initialize"),this).call(this,V);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(V){var O=this.propertyInfo[V.key]||{};return V.value&&V.value.isMorph?new ke.MorphNode(Object.assign({},V,{root:this.root})):new ke.PropertyNode(Object.assign({},V,{root:this.root,target:this.target,spec:O}))}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"MorphNode"}}],gb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(ke.InspectionNode);(function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Za=gb.hasOwnProperty("PropertyNode")&&"function"===typeof gb.PropertyNode?
gb.PropertyNode:gb.PropertyNode=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:Symbol.for("lively-instance-initialize"),value:function(V){Db._get(Object.getPrototypeOf(Za.prototype),Symbol.for("lively-instance-initialize"),this).call(this,V);var O=V.spec,Ka=V.target;this.partition=V.partition;this.target=Ka;this.spec=O;this.foldedNodes={}}},{key:"__deserialize__",value:function(V,O){this.spec={}}},
{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(V){this._interactive=V}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(V){return this.isFoldable?this.getFoldedContext(V):Db._get(Object.getPrototypeOf(Za.prototype),"getSubNode",this).call(this,V)}},{key:"getFoldedContext",value:function(V){return this.foldedNodes[V.key]=
new ke.FoldedNode(Object.assign({},V,{root:this.root,target:this.target,foldableNode:this,spec:ke.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(V,O){(O=void 0===O?!1:O)&&(this.target[this.key]=V);this.value=this.target[this.key];this.valueString=ke.printValue(this.value);this.interactive&&(O||this._propertyWidget.highlight());if(this.isFoldable)for(var Ka in this.foldedNodes)this.foldedNodes[Ka].value=
this.value[Ka],this.foldedNodes[Ka].valueString=ke.printValue(this.value[Ka]),this.foldedNodes[Ka]._propertyWidget&&ke.signal(this.foldedNodes[Ka]._propertyWidget,"update",this.value[Ka])}},{key:"display",value:function(V){var O=this,Ka=this._propertyWidget,ea=this.keyString,Da=this.valueString,Ta=this.target,vb=this.value,Bb=this.spec;if(!(this.interactive||Bb.foldable&&ke.isMultiValue(vb,Bb.foldable)))return V.renderPropertyControl({target:Ta,keyString:ea,valueString:Da,tree:V.ui.propertyTree,value:vb,
spec:Bb,node:this,fastRender:!0});if(Ka)return Ka.keyString=ea,Ka.valueString=Da,Ka.isSelected=this.isSelected,Ka.control&&(Ka.control.isSelected=this.isSelected),Ka;Ka=this._propertyWidget=V.renderPropertyControl({target:Ta,keyString:ea,valueString:Da,value:vb,spec:Bb,node:this,isSelected:this.isSelected,fontColor:V.ui.propertyTree.fontColor});this.isInternalProperty||Bb.readOnly||(ke.connect(Ka,"propertyValue",this,"refreshProperty",{updater:function(Ib,wc){return Ib(wc,!0)}}),ke.connect(Ka,"openWidget",
this.root,"onWidgetOpened",{converter:function(Ib){return{widget:Ib,node:O.sourceObj}}}));return Ka}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],gb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(ke.InspectionNode);(function(Va){var gb=
lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Za=gb.hasOwnProperty("FoldedNode")&&"function"===typeof gb.FoldedNode?gb.FoldedNode:gb.FoldedNode=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:Symbol.for("lively-instance-initialize"),value:function(V){Db._get(Object.getPrototypeOf(Za.prototype),Symbol.for("lively-instance-initialize"),this).call(this,V);this.foldableNode=
V=V.foldableNode;this.foldedProp=V.key+ke.string.capitalize(this.key)}},{key:"refreshProperty",value:function(V,O){O=void 0===O?!1:O;var Ka={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Ka[this.key]=V,Ka)),O)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],gb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(ke.PropertyNode);var wf=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");wf.Color=rb;var ug=function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Za=gb.hasOwnProperty("DarkTheme")&&"function"===typeof gb.DarkTheme?gb.DarkTheme:gb.DarkTheme=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Db(Za,Va,[{key:"background",get:function(){return wf.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return wf.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:wf.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:wf.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:wf.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:wf.Color.white,fontWeight:"bold",backgroundColor:wf.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:wf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:wf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],gb,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),Zd=ug=wf.DarkTheme;wf.default=ug;var Hc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Hc.inspect=Ha;Hc.remoteInspect=R;Hc.generateReferenceExpression=xa;Hc.onNumberDragStart=
function(Va,gb){gb.initPos=Va.position;gb.factorLabel=(new Hc.Tooltip({description:"1x"})).openInWorld(Va.hand.position.addXY(10,10))};Hc.onNumberDrag=function(Va,gb){var Za=Hc.getScaleAndOffset(Va,gb),V=Za.scale;Za=Za.offset;gb.factorLabel.position=Va.hand.position.addXY(10,10);gb.factorLabel.description=V+"x";return Hc.getCurrentValue(Za,V,gb)};Hc.onNumberDragEnd=function(Va,gb){var Za=Hc.getScaleAndOffset(Va,gb);Va=Za.offset;Za=Za.scale;gb.factorLabel.softRemove();return Hc.getCurrentValue(Va,
Za,gb)};Hc.getScaleAndOffset=function(Va,gb){var Za=Va.position.subPt(gb.initPos);Va=Za.x;gb=Hc.num.roundTo(Math.exp(-Za.y/$world.height*6),.01)*gb.baseFactor;return{offset:Va,scale:gb}};Hc.getCurrentValue=function(Va,gb,Za){return Math.max(Za.min,Math.min(Za.max,Za.scrubbedValue+(Za.floatingPoint?Va*gb:Math.round(Va*gb))))};Hc.Color=rb;Hc.Rectangle=Kb;Hc.rect=Vc;Hc.pt=id;Hc.obj=ne;Hc.num=Pd;Hc.Path=Id;Hc.arr=hc;Hc.promise=ie;Hc.connect=sc;Hc.disconnect=Fb;Hc.once=Rc;Hc.Morph=Ac;Hc.Tooltip=$c;Hc.VerticalLayout=
Bc;Hc.GridLayout=vd;Hc.HorizontalLayout=pb;Hc.morph=Zc;Hc.CustomLayout=lb;Hc.Label=Zb;Hc.Icon=Mb;Hc.StyleSheet=Kc;Hc.config=ub;Hc.Tree=rc;Hc.LoadingIndicator=Ua;Hc.DropDownList=Lb;Hc.DropDownSelector=mb;Hc.SearchField=Gb;Hc.LabeledCheckBox=vc;Hc.MorphHighlighter=Vb;Hc.InteractiveMorphSelector=Ub;Hc.printValue=nb;Hc.RemoteInspectionTree=yf;Hc.InspectionTree=Ke;Hc.isMultiValue=yb;Hc.valueWidgets=Ga;Hc.popovers=jb;Hc.DarkTheme=Zd;Hc.DefaultTheme=Ec;Hc.syncEval=Lc;Hc.inspectorCommands=[{name:"focus codeEditor",
exec:function(Va){Va.get("codeEditor").show();Va.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Va){Va.get("propertyTree").show();Va.get("propertyTree").focus();return!0}}];(function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Za=gb.hasOwnProperty("DraggedProp")&&"function"===typeof gb.DraggedProp?gb.DraggedProp:gb.DraggedProp=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Db(Za,Va,[{key:"applyToTarget",value:function(V){var O=this.currentTarget,Ka=this.control;this.remove();Hc.MorphHighlighter.removeHighlighters(V.world);if(O)if(O.isText&&"js"===O.editorModeName){var ea=O.evalEnvironment.context;V=O.textPositionFromPoint(O.localize(V.position));ea=Hc.generateReferenceExpression(this.sourceObject,{fromMorph:ea});Ka.keyString&&(ea+="."+Ka.keyString);O.insertTextAndSelect(ea,V);O.focus()}else"propertyValue"in Ka&&(O[Ka.keyString]=Ka.propertyValue)}},
{key:"update",value:function(V){V=V.hand.globalPosition;var O=this.morphBeneath(V);if(O){for(O==this.morphHighlighter&&(O=O.morphBeneath(V));[O].concat($jscomp.arrayFromIterable(O.ownerChain())).find(function(Ka){return!Ka.visible});)O=O.morphBeneath(V);if(O!=this.currentTarget){this.currentTarget=O;this.morphHighlighter&&this.morphHighlighter.deactivate();if(O.isWorld)return;this.morphHighlighter=Hc.MorphHighlighter.for($world,O);this.morphHighlighter.show()}this.position=V}}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Hc.Color.rgb(169,204,227)},fill:{defaultValue:Hc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var V=this.control;if(!V)return this.submorphs=[];this.height=22;this.submorphs=[V];V.top=0;V.fontSize=14;"function"===typeof V.relayout&&V.relayout();this.width=V.width+20;this.adjustOrigin(Hc.pt(10,
10))}}}}}],gb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3714})})(Hc.Morph);(function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Za=gb.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof gb.DraggableTreeLabel?gb.DraggableTreeLabel:gb.DraggableTreeLabel=
function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(V){this.draggedProp=new Hc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Hc.connect(V.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(V){}},{key:"onDragEnd",value:function(V){Hc.disconnect(V.hand,
"update",this.draggedProp,"update");this.draggedProp.applyToTarget(V)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Hc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:Hc.Color.transparent},padding:{defaultValue:Hc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],
set:function(V){this.setProperty("isSelected",V);V?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=V)}}}}}],gb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3716,
end:5055})})(Hc.Label);Ke=function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Za=gb.hasOwnProperty("PropertyControl")&&"function"===typeof gb.PropertyControl?gb.PropertyControl:gb.PropertyControl=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(V,O,Ka){V.control=
new Hc.DropDownSelector({opacity:.8,fill:Hc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:O,padding:0,values:Ka});Hc.connect(V.control,"update",V,"propertyValue",{updater:function(ea,Da){this.targetObj.propertyValue!=Da&&ea(Da)}});Hc.connect(V,"update",V.control,"selectedValue",{updater:function(ea,Da){Da=Da&&Da.valueOf?Da.valueOf():Da;this.targetObj.propertyValue!=Da&&ea(Da)}});return V}},{key:"toggleMultiValuePlaceholder",value:function(V){this.multiValuePlaceholder=
this.multiValuePlaceholder||this.addMorph({fill:Hc.Color.transparent,layout:new Hc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:Hc.arr.range(0,2).map(function(O){return{type:"ellipse",fill:Hc.Color.gray.withA(.5),reactsToPointer:!1,extent:Hc.pt(7,7)}})});V?(Hc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=
!0):(Hc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(V){this.foldableProperties&&this.toggleMultiValuePlaceholder(Hc.isMultiValue(V,this.foldableProperties))}},{key:"asFoldable",value:function(V){this.foldableProperties=V;Hc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,
1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var V=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});V.isLayoutable=!1;V.fontWeight="bold";V.fontColor=Hc.Color.orange;V.reactsToPointer=
!1;V.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(V){this.submorphs=[V]}},layout:{initialize:function(){this.layout=new Hc.CustomLayout({relayout:function(V){V.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},
{key:"inferType",value:function(V){return(V=V.value)&&(V.isColor||V.isGradient)?"Color":V&&V.isPoint?"Point":Hc.obj.isBoolean(V)?"Boolean":Hc.obj.isNumber(V)?"Number":Hc.obj.isString(V)?"String":V&&V.isRectangle?"Rectangle":!1}},{key:"render",value:function(V){V.spec.type||(V.spec=Object.assign({},V.spec,{isFloat:!Number.isInteger(V.value),type:this.inferType(V)}));switch(V.spec.type){case "Color":var O=this.renderColorControl(V);break;case "ColorGradient":O=this.renderColorControl(Object.assign({},
V,{gradientEnabled:!0}));break;case "Number":O=this.renderNumberControl(V);break;case "String":O=this.renderStringControl(V);break;case "RichText":O=this.renderStringControl(V);break;case "Layout":O=this.renderLayoutControl(V);break;case "Enum":O=this.renderEnumControl(V);break;case "Shadow":O=this.renderShadowControl(V);break;case "Point":O=this.renderPointControl(V);break;case "Rectangle":O=this.renderRectangleControl(V);break;case "Boolean":O=this.renderBooleanControl(V);break;default:O=this.renderItSomehow(V)}O.control&&
(Hc.connect(O.control,"openWidget",O,"openWidget"),O.toggleFoldableValue(V.value));return O}},{key:"baseControl",value:function(V){var O=V.spec;V=new this({keyString:V.keyString,valueString:V.valueString,isSelected:!1,propertyValue:V.value});O.foldable&&V.asFoldable(O.foldable);return V}},{key:"renderGrabbableKey",value:function(V){var O=this,Ka=V.target;return[V.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(ea){ea.state.draggedProp=new Hc.DraggedProp({sourceObject:Ka,control:O.baseControl(V)});
ea.state.draggedProp.openInWorld();Hc.connect(ea.hand,"update",ea.state.draggedProp,"update")},onDrag:function(ea){},onDragEnd:function(ea){Hc.disconnect(ea.hand,"update",ea.state.draggedProp,"update");ea.state.draggedProp.applyToTarget(ea)}}]}},{key:"renderEnumControl",value:function(V){var O=V.value,Ka=V.spec.values,ea=V.keyString,Da=V.target,Ta=V.node,vb=function(Bb,Ib){return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){Da.world().openWorldMenu(Bb,Ka.map(function(yc){return{string:yc.toString(),
action:function(){Da[ea]=yc;Ta.rerender()}}}));wc.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+(O?O.valueOf?O.valueOf():O:"Not set"),{nativeCursor:"pointer",onMouseDown:vb}],$jscomp.arrayFromIterable(Hc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:vb})))}},{key:"renderStringControl",value:function(V){var O=V.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+(200<O.length?O.slice(0,
20)+"...":O),{fontColor:Hc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(V){var O=V.value,Ka=V.keyString,ea=V.valueString,Da=V.target,Ta=V.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+ea,{fontColor:Hc.Color.black,nativeCursor:"pointer",onMouseDown:function(vb){var Bb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ib){if(1==Ib.nextAddress)return Bb=new Hc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:O}),Bb.relayout(),
Ib.yield(Bb.fadeIntoWorld(vb.positionIn(Da.world())),2);Hc.connect(Bb,"rectangle",function(wc){Da[Ka]=wc;Ta.rerender()});Ib.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(V){var O=V.value,Ka=V.keyString,ea=V.valueString,Da=V.target,Ta=V.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+ea,{nativeCursor:"pointer",fontColor:O?Hc.Color.green:Hc.Color.red,onMouseDown:function(vb){Da[Ka]=!Da[Ka];Ta.rerender()}}])}},{key:"renderNumberControl",value:function(V){var O=
V.value,Ka=V.spec,ea=V.keyString,Da=V.valueString,Ta=V.node,vb=V.target,Bb=V.tree,Ib=void 0===Ta._numberControls?new dh:Ta._numberControls,wc=$jscomp.makeIterator(Ib.submorphs),yc=wc.next().value,gd=wc.next().value;Ib.fontColor=Bb.fontColor;var $d=Ta._numberControls=Ib;"max"in Ka&&"min"in Ka&&-Infinity!=Ka.min&&Infinity!=Ka.max?($d.baseFactor=(Ka.max-Ka.min)/100,$d.floatingPoint=Ka.isFloat,$d.max=Ka.max,$d.min=Ka.min):($d.floatingPoint=Ka.isFloat,$d.baseFactor=.5,$d.min=void 0!=Ka.min?Ka.min:-Infinity,
$d.max=void 0!=Ka.max?Ka.max:Infinity);var te=Hc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),$jscomp.arrayFromIterable(Ta._inputMorph?[Ta._inputMorph,{}]:[" "+(void 0!=O&&(O.valueOf?O.valueOf():O).toFixed(Ka.isFloat?Math.max(4,Hc.num.precision(O)):0))+" ",{fontColor:te,onMouseUp:function(Ed){Ta._inputMorph=Hc.morph({type:"input",fill:null,fontColor:te,fontFamily:"IBM Plex Mono",fontSize:14,padding:Hc.rect(8,2,-6,
2),height:23,cursorColor:Hc.Color.white,value:O.valueOf?O.valueOf():Da});vb[ea]=O;Ta._inputMorph.focus();Hc.once(Ta._inputMorph,"inputAccepted",function(Je){delete Ta._inputMorph;vb[ea]=Ka.isFloat?Number.parseFloat(Je):Number.parseInt(Je);Ta.rerender()});Hc.once(Ta._inputMorph,"onBlur",function(Je){Ta._inputMorph&&(delete Ta._inputMorph,vb[ea]=O,Ta.rerender())});Ta.rerender()},onDragStart:function(Ed){$d.scrubbedValue=O;Hc.onNumberDragStart(Ed,$d)},onDrag:function(Ed){vb[ea]=Hc.onNumberDrag(Ed,$d);
Ta.rerender()},onDragEnd:function(Ed){return Hc.onNumberDragEnd(Ed,$d)}},Ib,{onMouseUp:function(){yc.fill=gd.fill=null},onMouseDown:function(Ed){if(Ed.targetMorph===yc){yc.fill=Hc.Color.white.withA(.2);if("max"in Ka&&vb[ea]>=Ka.max)return;vb[ea]+=1}if(Ed.targetMorph===gd){gd.fill=Hc.Color.white.withA(.2);if("min"in Ka&&vb[ea]<=Ka.min)return;--vb[ea]}Ta.rerender()}}]))}},{key:"renderShadowControl",value:function(V){var O=V.keyString,Ka=V.value,ea=V.target,Da=V.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),
[""+(Ka?Ka.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(Ta){var vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bb){if(1==Bb.nextAddress)return vb=new Hc.popovers.ShadowPopover({shadowValue:ea[O],hasFixedPosition:!0}),Bb.yield(vb.fadeIntoWorld(Ta.positionIn(ea.world())),2);Hc.connect(vb,"shadowValue",function(Ib){ea[O]=Ib;Da.rerender()});Bb.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(V){var O=V.keyString,Ka=V.value,ea=V.target,Da=V.node,Ta=
Hc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,vb={nativeCursor:"pointer",onMouseDown:function(Bb){var Ib;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){if(1==wc.nextAddress)return Ib=new Hc.popovers.PointPopover({pointValue:ea[O],hasFixedPosition:!0}),wc.yield(Ib.fadeIntoWorld(Bb.positionIn(ea.world())),2);Hc.connect(Ib,"pointValue",function(yc){ea[O]=yc;Da.rerender()});wc.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" pt(",
Object.assign({},vb),""+Ka.x.toFixed(),Object.assign({fontColor:Ta},vb),",",Object.assign({},vb),""+Ka.y.toFixed(),Object.assign({fontColor:Ta},vb),")",Object.assign({},vb)])}},{key:"renderLayoutControl",value:function(V){var O=V.valueString,Ka=V.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+(Ka?O:"No Layout"),{onMouseDown:function(ea){}}])}},{key:"renderColorControl",value:function(V){var O=V.node,Ka=V.gradientEnabled,ea=V.valueString,Da=V.keyString,Ta=V.value,
vb=V.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[Hc.morph({fill:Ta.valueOf?Ta.valueOf():Ta,extent:Hc.pt(15,15),borderColor:Hc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(Ta?Ta.valueOf?Ta.valueOf():ea:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Bb){var Ib;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){if(1==wc.nextAddress)return Ib=new Hc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:vb,
fillValue:Ta,title:"Fill Control",gradientEnabled:Ka}),wc.yield(Ib.fadeIntoWorld(Bb.positionIn(vb.world())),2);Hc.connect(Ib,"fillValue",function(yc){vb[Da]=yc;O.rerender()});wc.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(V){var O=V.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+O,{}])}}],gb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5064,end:20451})}(Hc.DraggableTreeLabel);Hc.PropertyControl=Ke;Hc.PropertyControl=Ke;Hc.PropertyControl=Ke;Hc.inspect=Ha;Hc.inspect=Ha;Hc.remoteInspect=R;Hc.remoteInspect=R;Hc.generateReferenceExpression=xa;Hc.generateReferenceExpression=xa;var dh=function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Za=gb.hasOwnProperty("NumberControls")&&"function"===typeof gb.NumberControls?gb.NumberControls:gb.NumberControls=
function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Hc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Hc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(V){this.submorphs.map(function(O){return O.fontColor=
V})}},submorphs:{initialize:function(){this.submorphs=[Hc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Hc.rect(5,2,0,-6),fontSize:12}),Hc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Hc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],gb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23124,end:24169})}(Hc.Morph);(function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Za=gb.hasOwnProperty("PropertyTree")&&"function"===typeof gb.PropertyTree?gb.PropertyTree:gb.PropertyTree=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:"onDrag",value:function(V){this._onDragHandler&&this._onDragHandler(V)}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],gb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25334,end:25445})})(Hc.Tree);Ke=function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Za=gb.hasOwnProperty("Inspector")&&"function"===
typeof gb.Inspector?gb.Inspector:gb.Inspector=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(V){}},{key:"__after_deserialize__",value:function(V,O,Ka){var ea=this,Da=new Hc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,
{treeData:Hc.InspectionTree.forObject(null,this)}));this.addMorph(Da,this.getSubmorphNamed("terminal toggler"));Db._get(Object.getPrototypeOf(Za.prototype),"__after_deserialize__",this).call(this,V,O,Ka);!this.isComponent&&this.master.whenApplied().then(function(){ea.layout.col(0).row(1).group.morph=Da;ea.targetObject&&(ea.targetObject=ea.targetObject)})}},{key:"__additionally_serialize__",value:function(V,O,Ka,ea){V=V.props.submorphs.value;for(O=V.length;O--;)Ka.refForId(V[O].id).realObj==this.ui.propertyTree&&
Hc.arr.removeAt(V,O)}},{key:"renderDraggableTreeLabel",value:function(V){return new Hc.DraggableTreeLabel(V)}},{key:"renderPropertyControl",value:function(V){return Hc.PropertyControl.render(V)}},{key:"onLoad",value:function(){var V=this.ui,O=V.codeEditor,Ka=V.thisBindingSelector,ea=V.propertyTree;O.changeEditorMode("js").then(function(){return O.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Ka.selection?O.owner.selectedContext:O.owner.targetObject},
get systemInterface(){return Hc.Path("treeData.systemInterface").get(ea)},format:"esm"}}).catch(function(Da){return $world.logError(Da)})}},{key:Symbol.for("lively-instance-initialize"),value:function(V){Db._get(Object.getPrototypeOf(Za.prototype),Symbol.for("lively-instance-initialize"),this).call(this,V);V=this.ui;var O=V.targetPicker,Ka=V.propertyTree,ea=V.resizer,Da=V.terminalToggler,Ta=V.unknowns,vb=V.internals,Bb=V.searchField,Ib=V.codeEditor,wc=V.fixImportButton,yc=V.thisBindingSelector;Ib.changeEditorMode("js").then(function(){return Ib.evalEnvironment=
{targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==yc.selection?Ib.owner.selectedContext:Ib.owner.targetObject},get systemInterface(){return Ka.treeData.systemInterface},format:"esm"}}).catch(function(gd){return $world.logError(gd)});Hc.connect(O,"onMouseUp",this,"selectTarget");Hc.connect(Ka,"onScroll",this,"repositionOpenWidget");Hc.connect(ea,"onDrag",this,"adjustProportions");Hc.connect(Da,"onMouseDown",this,"toggleCodeEditor");Hc.connect(Ta,"trigger",this,"filterProperties");
Hc.connect(vb,"trigger",this,"filterProperties");Hc.connect(Bb,"searchInput",this,"filterProperties");Hc.connect(Ka,"nodeCollapseChanged",this,"filterProperties");Hc.connect(this,"extent",this,"relayout");Hc.connect(yc,"selection",this,"bindCodeEditorThis");Hc.connect(wc,"fire",Ib,"execCommand",{updater:function(gd){return gd("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var V=this.ui.propertyTree.selectedIndex-1,O=this.ui.propertyTree.selectedNode;
this.ui.propertyTree.selectedNode.refreshProperty();O=this.ui.propertyTree.document.getLine(V).textAndAttributes.slice(0,4).concat(O.display(this));V=this.ui.propertyTree.lineRange(V,!1);this.ui.propertyTree.replace(V,O,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),
this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var V=Hc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(V!=this.lastChange||this.lastSubmorphs!=Hc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==V.prop&&this.repositionOpenWidget(),this.lastChange=V,this.lastSubmorphs=Hc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",
value:function(){var V;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(O){O=O.node;O.target&&(V=O.foldableNode?O.target[O.foldableNode.key][O.key]:O.target[O.key],!Hc.obj.equals(V,O.value)&&O.refreshProperty&&O.refreshProperty(V))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(V,O){O=void 0===O?!1:O;var Ka=this,ea,Da,
Ta,vb,Bb,Ib,wc,yc,gd,$d,te,Ed,Je,He,ye;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oe){switch(oe.nextAddress){case 1:if(!Ka.isUpdating()){oe.jumpTo(2);break}return oe.yield(Ka.whenUpdated(),2);case 2:ea=Hc.promise.deferred();Da=ea.promise;Ta=!!Ka.target;Ka.updateInProgress=Da;oe.setCatchFinallyBlocks(4);O&&(vb=Hc.LoadingIndicator.open("connecting to remote..."));if(!O){Bb=Hc.InspectionTree.forObject(V,Ka);oe.jumpTo(6);break}return oe.yield(Hc.RemoteInspectionTree.forObject(V,Ka),7);
case 7:Bb=oe.yieldResult;case 6:return Ib=Bb,wc=Ka.ui.propertyTree,oe.yield(Ib.collapse(Ib.root,!1),8);case 8:if(!Ib.root.children){oe.jumpTo(9);break}return oe.yield(Ib.collapse(Ib.root.children[0],!1),9);case 9:if(yc=Ka.originalTreeData&&Ka.originalTreeData.diff(Ib)){gd=$jscomp.makeIterator(yc);for($d=gd.next();!$d.done;$d=gd.next())te=$d.value,Ed=$jscomp.makeIterator(te),Je=Ed.next().value,He=Ed.next().value,Je.refreshProperty(He.value);oe.jumpTo(11);break}wc.treeData=Ib;return oe.yield(Ka.filterProperties(),
12);case 12:if(!wc.treeData.root.isCollapsed){oe.jumpTo(13);break}return oe.yield(wc.onNodeCollapseChanged({node:Ib.root,isCollapsed:!1}),14);case 14:wc.selectedIndex=1;case 13:return oe.yield(wc.execCommand("uncollapse selected node"),11);case 11:Ka.toggleWindowStyle(Ta);vb&&vb.remove();oe.leaveTryBlock(5);break;case 4:ye=oe.enterCatchBlock(),Ka.showError(ye);case 5:Ka.startStepping(1E3,"refreshAllProperties"),Ka.updateInProgress=null,oe.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(V){V=
void 0===V?!0:V;var O=this,Ka,ea,Da,Ta,vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bb){if(1==Bb.nextAddress)return Ka=300,Ta=O.ui.codeEditor.pluginFind(function(Ib){return Ib.runEval}),vb=O.getWindow(),Bb.yield(Ta.runEval("System.get('@system-env').node"),2);Bb.yieldResult.value?(Da=[].concat($jscomp.arrayFromIterable(Hc.arr.without(vb.styleClasses,"local")),["node"]),ea=Hc.DarkTheme.instance):(Da=["local"].concat($jscomp.arrayFromIterable(vb?Hc.arr.without(vb.styleClasses,"node"):
[])),ea=Hc.DefaultTheme.instance);Ta.theme=ea;V?(vb&&vb.animate({duration:Ka,styleClasses:Da}),O.ui.codeEditor.animate({fill:ea.background,duration:Ka})):vb&&(vb.styleClasses=Da);O.ui.codeEditor.textString=O.ui.codeEditor.textString;Ta.highlight();Bb.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var V=
this,O=Object.assign({type:"text",borderWidth:1,borderColor:Hc.Color.gray,lineWrapping:"by-chars"},Hc.config.codeEditor.defaultStyle,{textString:""}),Ka=Hc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Hc.rect(0,0,this.width,30);var ea=new Hc.SearchField({styleClasses:["idle"],name:"searchField"});Ka[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[ea,{type:"button",name:"targetPicker",padding:Hc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},
tooltip:"Change Inspection Target",label:Hc.Icon.textAttribute("crosshairs")},new Hc.LabeledCheckBox({label:"Internals",name:"internals"}),new Hc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Hc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Hc.InspectionTree.forObject(null,this)})),Hc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},O),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},
{name:"this binding selector",type:Hc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Ka),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Ka),[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){V.ui.thisBindingSelector.selection=
"target"})}},{key:"selectTarget",value:function(){var V=this,O,Ka,ea,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){switch(Ta.nextAddress){case 1:if(V.env.eventDispatcher.isKeyPressed("Shift"))return Ka=$jscomp,ea=Ka.makeIterator,Ta.yield($world.execCommand("select morph",{justReturn:!0}),5);V.toggleSelectionInstructions(!0);return Ta.yield(Hc.InteractiveMorphSelector.selectMorph(),4);case 4:O=Ta.yieldResult;V.toggleSelectionInstructions(!1);Ta.jumpTo(3);break;case 5:Da=ea.call(Ka,
Ta.yieldResult),O=Da.next().value;case 3:O&&(V.targetObject=O),Ta.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(V){if(V&&!this.instructionWidget){var O=Hc.morph({type:"label",name:"escapeKey",value:"esc"});O.whenRendered().then(function(){return O.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",
{},O,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(V){V=V.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;V.epiMorph=!0;this.openWidget=V;Hc.once(V,"close",this,"closeOpenWidget");Hc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",
value:function(){var V=this.ui.propertyTree,O=V.textLayout.boundsFor(V,{column:0,row:V.selectedIndex-1});O=V.worldPoint(Hc.pt(O.x,O.y+O.height/2)).addPt(V.scroll.negated());V=V.globalBounds();O.x=this.globalBounds().center().x;O.y<V.top()?O=V.topCenter():V.bottom()-20<O.y&&(O=V.bottomCenter().addXY(0,-20));return O}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(V){this.layout.row(1).height+=
V.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(V){if(V!==this.isEditorVisible()){var O=this.extent,Ka=this.layout,ea=this.ui,Da=ea.terminalToggler,Ta=ea.codeEditor,vb=ea.thisBindingSelector;ea=ea.fixImportButton;Ka.disable();V?(Da.fontColor=Hc.Color.rgbHex("00e0ff"),Ka.row(3).height=this.codeEditorHeight||180,Ka.row(2).height=5,ea.animate({visible:!0,duration:200}),vb.animate({visible:!0,duration:200})):
(this.codeEditorHeight=Ka.row(3).height,Da.fontColor=Hc.Color.white,Ka.row(3).height=Ka.row(2).height=0,ea.animate({visible:!1,duration:200}),vb.animate({visible:!1,duration:200}));this.extent=O;Ka.enable({duration:200});this.relayout({duration:200});Ta.focus();Ta.animate({opacity:V?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var V=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(O){V.makeEditorVisible(!V.isEditorVisible());O.jumpToEnd()})}},{key:"filterProperties",
value:function(){var V=this,O,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){if(1==ea.nextAddress)return O=V.ui.searchField,Ka=V.ui.propertyTree,V.originalTreeData||(V.originalTreeData=Ka.treeData),Hc.disconnect(Ka.treeData,"onWidgetOpened",V,"onWidgetOpened"),ea.yield(Ka.treeData.filter({maxDepth:2,showUnknown:V.ui.unknowns.checked,showInternal:V.ui.internals.checked,iterator:function(Da){return O.matches(Da.key)}}),2);Ka.update();Hc.connect(Ka.treeData,"onWidgetOpened",V,"onWidgetOpened");
ea.jumpToEnd()})}},{key:"relayout",value:function(V){V=void 0===V?{}:V;var O=this,Ka,ea,Da,Ta,vb,Bb,Ib,wc,yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gd){O.layout&&O.layout.forceLayout();Ka=O;ea=Ka.ui;Da=ea.fixImportButton;Ta=ea.terminalToggler;vb=ea.propertyTree;Bb=ea.thisBindingSelector;Ib=vb.bounds().insetBy(5).bottomLeft();wc=vb.bounds().insetBy(5).bottomRight();yc=wc.subXY(Da.width+10,0);Bb.width=115;Bb.listMorph.itemHeight=20;V.duration?(Ta.animate(Object.assign({bottomLeft:Ib},
V)),Da.animate(Object.assign({bottomRight:wc},V)),Bb.animate(Object.assign({bottomRight:yc},V))):(Ta.bottomLeft=Ib,Da.bottomRight=wc,Bb.bottomRight=yc);gd.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Db._get(Object.getPrototypeOf(Za.prototype),"keybindings",this))}},{key:"commands",get:function(){return Hc.inspectorCommands}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(V){if(System._testsRunning)return console.log(V.targetObject);V=new this(V);V.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return V}},{key:"properties",get:function(){return{extent:{defaultValue:Hc.pt(400,500)},fill:{defaultValue:Hc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(V){this.setProperty("remoteTarget",
V);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(V,!0))}},targetObject:{after:["submorphs"],set:function(V){this._serializableTarget=V&&V.isMorph?V.id:V;this.setProperty("targetObject",V);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(V))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var V=this.ui.propertyTree,O=V.treeData;return O.getContextFor(V.selectedNode||O.root)}},submorphs:{initialize:function(){this.build()}},
ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),
searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Hc.Color.gray,fontSize:14,fontFamily:Hc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],gb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25462,end:46018})}(Hc.Morph);Ke=Hc.Inspector;yf=Ma("I",Ke);Hc.default=Ke;var ed=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");ed.Inspector=yf;ed.string=bd;ed.Morph=Ac;ed.pt=id;ed.Color=rb;Ke=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Va,gb,Za){Za=void 0===Za?1:Za;var V,
O,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){switch(ea.nextAddress){case 1:return Va.maybeSelectCommentOrLine(),ea.setCatchFinallyBlocks(2),gb=Object.assign({},gb,{logDoit:!0,inspect:!0,inspectDepth:Za}),ea.yield(Va.doEval(void 0,gb),4);case 4:V=ea.yieldResult;O=V.error?V.error:V.isError?V.value:null;ea.leaveTryBlock(3);break;case 2:O=Ka=ea.enterCatchBlock();case 3:return O?Va.showError(O):Va.setStatusMessage(ed.string.truncate(V.value,1E3)),ea.return(V)}})}},{name:"eval all",
doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Va,gb){var Za,V,O;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){switch(Ka.nextAddress){case 1:return Ka.setCatchFinallyBlocks(2),Ka.yield(Va.doEval({start:{row:0,column:0},end:Va.documentEndPosition},Object.assign({},gb,{logDoit:!0})),4);case 4:Za=Ka.yieldResult;V=Za.error?Za.error:Za.isError?Za.value:null;Ka.leaveTryBlock(3);break;case 2:V=O=Ka.enterCatchBlock();case 3:return V?Va.showError(V):Va.setStatusMessage(String(Za.value)),
Ka.return(Za)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Va,gb){var Za,V,O,Ka,ea,Da,Ta,vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bb){switch(Bb.nextAddress){case 1:return Va.maybeSelectCommentOrLine(),Bb.setCatchFinallyBlocks(2),gb=Object.assign({},gb,{asString:!1,logDoit:!0}),Bb.yield(Va.doEval(void 0,gb),4);case 4:Za=Bb.yieldResult;V=Za.error?Za.error:Za.isError?Za.value:null;Bb.leaveTryBlock(3);
break;case 2:V=O=Bb.enterCatchBlock();case 3:Va.selection.collapseToEnd();if(Ka=Za.value&&Za.value.isColor)return Va.selection.text=String(Za.value),ea=new ed.Morph({fill:ed.Color.transparent,extent:ed.pt(Va.fontSize+2,Va.fontSize+2),submorphs:[{fill:Za.value,center:ed.pt(Va.fontSize+2,Va.fontSize+2).scaleBy(.5)}]}),Da=Va.selection.start,Ta=Da.column,vb=Da.row,Va.insertText([ea,{}],Va.selection.start),Va.selection.start={column:Ta,row:vb},Va.focus(),Bb.return(Za);Va.insertTextAndSelect(V?String(V)+
(V.stack?"\n"+V.stack:""):String(Za.value));Va.focus();return Bb.return(Za)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Va,gb){var Za,V,O,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){switch(ea.nextAddress){case 1:Va.maybeSelectCommentOrLine();V=Va.textInRange(Va.selection);O=Va.evalEnvironment||{};Ka=Va.pluginFind(function(Da){return Da.isEditorPlugin&&"function"===typeof Da.runEval});O.systemInterface||
(O.systemInterface=Ka.systemInterface(gb));if("local"!==O.systemInterface.name){ea.jumpTo(2);break}ea.setCatchFinallyBlocks(3);return ea.yield(Va.doEval(void 0,gb),5);case 5:Za=ea.yieldResult;V=Za.value;ea.leaveTryBlock(2);break;case 3:ea.enterCatchBlock();case 2:return Va.world().execCommand("open object editor",{target:V,evalEnvironment:O}),ea.return(Za)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Va,gb){var Za,V,O,Ka,
ea,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){switch(Ta.nextAddress){case 1:Va.maybeSelectCommentOrLine();O=Va.textInRange(Va.selection);Ka=Va.evalEnvironment||{};ea=Va.pluginFind(function(vb){return vb.isEditorPlugin&&"function"===typeof vb.runEval});Ka.systemInterface||(Ka.systemInterface=ea.systemInterface(gb));if("local"!==Ka.systemInterface.name){ed.Inspector.openInWindow({remoteTarget:{code:O,evalEnvironment:Ka}});Ta.jumpTo(2);break}Ta.setCatchFinallyBlocks(3);return Ta.yield(Va.doEval(void 0,
gb),5);case 5:Za=Ta.yieldResult;V=Za.error?Za.error:Za.isError?Za.value:null;O=Za.value;Ta.leaveTryBlock(4);break;case 3:V=Da=Ta.enterCatchBlock();case 4:ed.Inspector.openInWindow({targetObject:V||O});case 2:return Ta.return(Za)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",handlesCount:!0,exec:function(Va,gb,Za){Za=void 0===Za?1:Za;var V;return $jscomp.asyncExecutePromiseGeneratorProgram(function(O){switch(O.nextAddress){case 1:return Va.maybeSelectCommentOrLine(),
O.setCatchFinallyBlocks(2),gb=Object.assign({},gb,{inspect:!0,inspectDepth:Za,logDoit:!0}),O.yield(Va.doEval(void 0,gb),4);case 4:V=O.yieldResult;O.leaveTryBlock(3);break;case 2:O.enterCatchBlock();case 3:return Va.selection.collapseToEnd(),Va.insertTextAndSelect(V.value),O.return(V)}})}}];ed.codeEvaluationCommands=Ke;ed.codeEvaluationCommands=Ke;ed.codeEvaluationCommands=Ke;var pg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");pg.changeAttributeInSelectionOrMorph=function(Va,
gb,Za){var V=Va.selection;Va.keepPosAtSameScrollOffsetWhile(function(){V.isEmpty()?Va[gb]="function"===typeof Za?Za(Va[gb]):Za:(Va.undoManager.group(),Va.changeStyleProperty(gb,function(O){return"function"===typeof Za?Za(O):Za}),Va.undoManager.group())})};yf=[{name:"increase font size",scrollCursorIntoView:!1,exec:function(Va){var gb=Va.fontSize;pg.changeAttributeInSelectionOrMorph(Va,"fontSize",function(Za){Za=Za||gb;return Za+(18<=Za?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,
exec:function(Va){var gb=Va.fontSize;pg.changeAttributeInSelectionOrMorph(Va,"fontSize",function(Za){Za=Za||gb;return Za-(18>=Za?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Va){var gb,Za,V,O,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){if(1==ea.nextAddress){gb=["serif","sans-serif","monospace"];if(Za=localStorage["lively.morpic/text-change-font-additional-fonts"])Za=JSON.parse(Za),gb.push.apply(gb,$jscomp.arrayFromIterable(Za));gb.map(function(Da){return Da.toLowerCase()}).includes(Va.fontFamily.toLowerCase())||
(gb.push(Va.fontFamily),Za=[].concat($jscomp.arrayFromIterable(Za||[]),[Va.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Za));return ea.yield($world.editListPrompt("choose font",gb,{requester:Va,preselect:gb.indexOf(Va.fontFamily),historyId:"lively.morpic/text-change-font-hist"}),2)}V=ea.yieldResult;O=$jscomp.makeIterator(V.selections);if(Ka=O.next().value)Va.fontFamily=Ka;return ea.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,
exec:function(Va,gb){gb=void 0===gb?{}:gb;var Za,V,O,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){if(1==ea.nextAddress){if(gb.hasOwnProperty("link"))return ea.jumpTo(2);V=Va.selection;O=Va.getStyleInRange(V);Ka=O.link;return ea.yield(Va.world().prompt("Set link",{input:Ka||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=ea.nextAddress&&(Za=ea.yieldResult,!Za))return ea.return();Va.undoManager.group();Va.setStyleInRange({link:Za||void 0},V);Va.undoManager.group();
ea.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Va,gb){var Za,V,O,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){if(1==ea.nextAddress)return Za=Va.selection,V=Va.getStyleInRange(Za),O=V.doit,ea.yield(Va.world().editPrompt("Enter doit code (runs on clicking the text)",{requester:Va,input:O?O.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Va.evalEnvForDoit(O||{})}),2);Ka=ea.yieldResult;Va.undoManager.group();
Ka?Va.addTextAttribute({doit:{code:Ka},nativeCursor:"pointer",textDecoration:"underline"},Za):Va.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Za);Va.undoManager.group();ea.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Va,gb){gb=void 0===gb?{}:gb;Va.undoManager.group();gb=!gb.onlySelection&&Va.selection.isEmpty()?Va.documentRange:Va.selection.range;Va.setStyleInRange(null,gb);Va.undoManager.group();return!0}},{name:"open text attribute controls",
exec:function(Va){var gb,Za,V,O;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){if(1==Ka.nextAddress)return Ka.yield(System.import("lively.modules"),2);if(3!=Ka.nextAddress)return gb=Ka.yieldResult,Za=gb.module,Ka.yield(Za("lively.ide/text/ui.js").load(),3);V=Ka.yieldResult;O=V.RichTextControl;return Ka.return(O.openFor(Va))})}}];pg.commands=yf;pg.commands=yf;pg.commands=yf;var Qc=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");Qc.guessTextModeName=$a;Qc.rangedToken=
function(Va,gb,Za,V,O){return{start:{row:Va,column:gb},end:{row:Va,column:Za},token:V,mode:O}};Qc.fun=cc;Qc.arr=hc;Qc.connect=sc;Qc.disconnect=Fb;Qc.DefaultTheme=Ec;Qc.tokenizeDocument=md;Qc.modeInfo=bc;Qc.visitDocumentTokens=Tb;Qc.getMode=ra;Qc.completionCommands=wd;Qc.multiSelectCommands=v;Qc.navCommands=cf;Qc.codeCommands=Ze;Qc.codeEvaluationCommands=Ke;Qc.richTextCommands=yf;Qc.Color=rb;Qc.Range=se;Qc.guessTextModeName=$a;Qc.guessTextModeName=$a;Ec=function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),
Za=gb.hasOwnProperty("EditorPlugin")&&"function"===typeof gb.EditorPlugin?gb.EditorPlugin:gb.EditorPlugin=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=Qc.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},
{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(V){var O=this;this.textMorph=V;Qc.connect(V,"textChange",this,"onTextChange");Qc.connect(V,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return O.highlight()})}},{key:"detach",value:function(V){Qc.disconnect(V,"textChange",this,"onTextChange");Qc.disconnect(V,"viewChange",this,"onViewChange");
this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(V){this._ast=null;if(V){var O=this._tokenizerValidBefore;if("replace"===V.selector){var Ka=V.args[0].start;V=Ka.row;Ka=Ka.column}else Ka=V=0;if(!O||V<O.row||V===O.row&&Ka<O.column)V=Math.max(0,V),this._tokenizerValidBefore={row:V,column:Ka}}this.requestHighlight()}},{key:"requestHighlight",value:function(V){var O=this;(void 0===V?0:V)?this.highlight():Qc.fun.debounceNamed(this.id+
"-requestHighlight",300,function(){return O.highlight()})()}},{key:"highlight",value:function(){var V=this.textMorph,O=this.theme,Ka=this.mode,ea=this._tokenizerValidBefore;if(O&&V&&V.document&&Ka){V.fill=O.background;V.cursorColor=O.cursorColor||Qc.Color.black;var Da=V.viewState,Ta={};ea=Qc.tokenizeDocument(Ka,V.document,Da.firstVisibleRow,Da.lastVisibleRow,ea);Ka=ea.lines;ea=ea.tokens;if(Ka.length){Da=Ka[0].row;for(var vb=[],Bb=0;Bb<ea.length;Da++,Bb++)for(var Ib=ea[Bb],wc=0;wc<Ib.length;wc+=5){var yc=
Ib[wc],gd=Ib[wc+1],$d=O[Ib[wc+2]]||O.default;$d&&vb.push({start:{row:Da,column:yc},end:{row:Da,column:gd}},$d)}V.embeddedMorphs.forEach(function(te){var Ed=V.embeddedMorphMap.get(te).anchor;Ta[te.id]=V.textAttributeAt(Ed.position)});V.setTextAttributesWithSortedRanges(vb);V.embeddedMorphs.forEach(function(te){var Ed=V.embeddedMorphMap.get(te).anchor;Ed=Qc.Range.at(Ed.position);Ed.end.column+=1;V.replace(Ed,[te,Ta[te.id]],!1)});this._tokenizerValidBefore={row:Qc.arr.last(Ka).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},
V,this)}}},{key:"visitTokensInRange",value:function(V,O){var Ka=V.start,ea=V.end,Da=Ka.row-1;Qc.visitDocumentTokens(this.mode,this.textMorph.document,Ka.row,ea.row,null,function(Ta){return Da++},function(Ta,vb,Bb,Ib,wc,yc,gd){if(Da===Ka.row&&0<Ka.column){if(Ka.column>=Ib)return;Bb<Ka.column&&Ka.column<Ib&&(Bb=Ka.column)}if(Da===ea.row){if(ea.column<=Bb)return;Bb<ea.column&&ea.column<Ib&&(Ib=ea.column)}O(Ta,vb,Da,Bb,Ib,wc,yc,gd)})}},{key:"tokensInRange",value:function(V){var O=[];this.visitTokensInRange(V,
function(Ka,ea,Da,Ta,vb,Bb,Ib,wc){return O.push(Qc.rangedToken(Da,Ta,vb,Ka,wc))});return O}},{key:"tokensOfRow",value:function(V){var O=this.textMorph.getLine(V).length;return this.tokensInRange({start:{row:V,column:0},end:{row:V,column:O}})}},{key:"tokenAt",value:function(V){for(var O=this.tokensOfRow(V.row),Ka=O.length;Ka--;){var ea=O[Ka];if(ea.token&&ea.start.column<=V.column&&V.column<=ea.end.column)return ea}return null}},{key:"getCommands",value:function(V){return[].concat($jscomp.arrayFromIterable(V),
$jscomp.arrayFromIterable(Qc.completionCommands),$jscomp.arrayFromIterable(Qc.multiSelectCommands),$jscomp.arrayFromIterable(Qc.navCommands),$jscomp.arrayFromIterable(Qc.codeCommands),$jscomp.arrayFromIterable(Qc.codeEvaluationCommands),$jscomp.arrayFromIterable(Qc.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;var V=this.mode,O=V.lineComment,Ka=V.blockCommentStart;V=V.blockCommentEnd;var ea={};O&&(ea.lineCommentStart=O);Ka&&(ea.blockCommentStart=Ka);V&&(ea.blockCommentEnd=
V);return ea}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(V,O,Ka){var ea=this.textMorph,Da=V.row,Ta=V.column;V=O[Ta-1];O=O[Ta];ea.selection.text="\n";ea.selection.collapseToEnd();"{"===V&&"}"===O&&(ea.selection.text="\n"+" ".repeat(Ka),ea.selection.collapse());ea.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Da+1,lastRow:Da+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]",
"(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var V=this.textMorph,O=this.openPairs,Ka=V.selection,ea=V.getLine(Ka.end.row),Da=ea[Ka.end.column-1];ea=ea[Ka.end.column];V.autoInsertPairs&&Ka.isEmpty()&&Da in O&&ea===O[Da]&&(Ka.growRight(1),Ka.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(V){var O=this.openPairs,Ka=this.closePairs,ea=this.textMorph,Da=ea.selection,
Ta=ea.autoInsertPairs&&V in O,vb=ea.autoInsertPairs&&V in Ka;if(!Ta&&!vb)return!1;var Bb=ea.getLine(Da.end.row)[Da.end.column];if(!Da.isEmpty()){if(!Ta)return!1;Ka=ea.undoManager.ensureNewGroup(ea);ea.insertText(O[V],Da.end);ea.insertText(V,Da.start);ea.undoManager.group(Ka);Da.growRight(-1);return!0}if(Bb in Ka&&V===Bb)return Da.goRight(1),!0;if(vb&&!Ta)return!1;Ka=ea.undoManager.ensureNewGroup(ea);ea.insertText(V+O[V]);ea.undoManager.group(Ka);Da.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"EditorPlugin"}}],gb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3148,end:11979})}(void 0);bc=Ec=Qc.EditorPlugin;wd=Ma("C",function(Va){var gb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Za=gb.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&
"function"===typeof gb.CodeMirrorEnabledEditorPlugin?gb.CodeMirrorEnabledEditorPlugin:gb.CodeMirrorEnabledEditorPlugin=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Db(Za,Va,[{key:Symbol.for("lively-instance-initialize"),value:function(){Db._get(Object.getPrototypeOf(Za.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(V){this.mode=this.codeMirrorMode(V);
return Db._get(Object.getPrototypeOf(Za.prototype),"attach",this).call(this,V)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(V){return{indentWithTabs:!V.useSoftTabs,indentUnit:V.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(V){V=this.defaultCodeMirrorModeConfig(V);return Qc.getMode(V,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],
gb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11988,end:12682})}(Qc.EditorPlugin));Qc.CodeMirrorEnabledEditorPlugin=wd;Qc.CodeMirrorEnabledEditorPlugin=wd;Qc.CodeMirrorEnabledEditorPlugin=wd;Qc.default=Ec;Ec=Object.freeze({__proto__:null,guessTextModeName:$a,"default":bc,CodeMirrorEnabledEditorPlugin:wd});
Ma("e",Ec)}}});
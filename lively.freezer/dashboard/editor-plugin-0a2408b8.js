System.register(["./__root_module__-cddb8267.js","kld-intersections","./index-51795659.js","./editor-plugin-b03f3727.js","./index-d91b3b8e.js"],function(Ea){var Cb,Kb,lc,$b,Qd,Zc,Rd,ad,Nc,nd,he,af,Af,rd,cc,Ic,Kd,Kc,Bd,be,yc,Cc,Pb,Dc;return{setters:[function(Xc){Cb=Xc.aw;Kb=Xc.bA;lc=Xc.bB;$b=Xc.bC;Qd=Xc.E;Zc=Xc.au;Rd=Xc.aZ;ad=Xc.a7;Nc=Xc.ae;nd=Xc.bn;he=Xc.a6;af=Xc.$;Af=Xc.bD;rd=Xc.bu},function(){},function(Xc){cc=Xc.s},function(Xc){Ic=Xc.p;Kd=Xc.d;Kc=Xc.a;Bd=Xc.r;be=Xc.C},function(Xc){yc=Xc.localInterface;
Cc=Xc.systemInterfaceNamed;Pb=Xc.serverInterfaceFor;Dc=Xc.l2lInterfaceFor}],execute:function(){var Xc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");Xc.warnStyle={"border-bottom":"2px dotted orange"};Xc.errorStyle={"background-color":"red"};var Cd=function(Rb){var ma=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),Ia=ma.hasOwnProperty("JavaScriptChecker")&&"function"===typeof ma.JavaScriptChecker?ma.JavaScriptChecker:ma.JavaScriptChecker=function(W){W&&W[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Cb(Ia,Rb,[{key:"uninstall",value:function(W){var sa=W.text||W;(sa.markers||[]).forEach(function(Za){return Za.id.startsWith("js-checker-")&&sa.removeMarker(Za)});sa.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(W,sa){return[].concat($jscomp.arrayFromIterable(W.embeddedMorphMap.values())).find(function(Za){return sa.containsPosition(Za.anchor.position)})}},{key:"onDocumentChange",value:function(W,
sa,Za){var mb=sa.document;try{var rc=Za.parse()}catch(xd){rc=xd}rc&&(W=(sa.markers||[]).filter(function(xd){return xd.id.startsWith("js-checker-")}),Za=Za.undeclaredVariables().map(function(xd,sc){var Na=xd.start;xd=xd.end;Na=mb.indexToPosition(Na);xd=mb.indexToPosition(xd);return sa.addMarker({id:"js-checker-"+sc,style:Xc.warnStyle,range:{start:Na,end:xd},type:"js-undeclared-var"})}),W.slice(Za.length).forEach(function(xd){return sa.removeMarker(xd)}),rc.parseError?(W=rc.parseError.loc,Za=W.column,
W=W.line-1,rc=mb.indexToPosition(rc.parseError.pos),Za=rc.column,W=rc.row,rc={start:{column:Za-1,row:W},end:{column:Za+1,row:W}},this.hasEmbeddedMorphInRange(sa,rc)||sa.addMarker({id:"js-syntax-error",range:rc,style:Xc.errorStyle,type:"js-syntax-error"})):sa.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],ma,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),Od=Cd=Xc.JavaScriptChecker;Xc.default=Cd;var Gb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");Gb.query=Kb;Gb.fuzzyParse=lc;Gb.acorn=$b;Gb.custom=Qd;var sb=function(Rb){var ma=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),Ia=ma.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof ma.JavaScriptNavigator?
ma.JavaScriptNavigator:ma.JavaScriptNavigator=function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Cb(Ia,Rb,[{key:"ensureAST",value:function(W){return this.parse(W.textString)}},{key:"parse",value:function(W){return Gb.fuzzyParse(W)}},{key:"move",value:function(W,sa){var Za=!!sa.activeMark||!sa.selection.isEmpty(),mb=sa.selection,rc=sa.positionToIndex(mb.lead);W=this[W](sa.textString,rc);W=sa.indexToPosition(W);mb.lead=
W;Za||(mb.anchor=W);sa.scrollCursorIntoView()}},{key:"forwardSexp",value:function(W){this.move("_forwardSexp",W)}},{key:"backwardSexp",value:function(W){this.move("_backwardSexp",W)}},{key:"backwardUpSexp",value:function(W){this.move("_backwardUpSexp",W)}},{key:"forwardDownSexp",value:function(W){this.move("_forwardDownSexp",W)}},{key:"_forwardSexp",value:function(W,sa){W=this.parse(W);W=Gb.custom.findNodesIncluding(W,sa).reverse().find(function(mb){return mb.end!==sa});if(!W)return sa;if("BlockStatement"===
W.type){var Za=W.body.find(function(mb){return mb.start>sa});if(Za)return Za.start}return W.end}},{key:"_backwardSexp",value:function(W,sa){W=this.parse(W);W=Gb.custom.findNodesIncluding(W,sa).reverse().find(function(mb){return mb.start!==sa});if(!W)return sa;if("BlockStatement"===W.type){var Za=W.body.slice().reverse().find(function(mb){return mb.end<sa});if(Za)return Za.end}return W?W.start:sa}},{key:"_backwardUpSexp",value:function(W,sa){W=this.parse(W);return(W=Gb.custom.findNodesIncluding(W,
sa).reverse().find(function(Za){return Za.start!==sa}))?W.start:sa}},{key:"_forwardDownSexp",value:function(W,sa){W=this.parse(W);return(W=Gb.custom.findNodeAfter(W,sa,function(Za,mb){return mb.start>sa}))?W.node.start:sa}},{key:"markDefun",value:function(W){var sa=this.rangeForFunctionOrDefinition(W.textString,[W.positionToIndex(W.selection.range.start),W.positionToIndex(W.selection.range.end)]);sa&&W.execCommand("expandRegion",{start:sa[0],end:sa[1]})}},{key:"rangeForNodesMatching",value:function(W,
sa,Za){W=this.parse(W);return(sa=Gb.custom.findNodesIncluding(W,sa).reverse().find(Za))?[sa.start,sa.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(W,sa){var Za=sa[0]===sa[1];return this.rangeForNodesMatching(W,sa[1],function(mb){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(mb.type)&&(Za&&mb.end!==sa[1]||!Za&&mb.start<sa[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(W,sa){"number"!==typeof sa&&(sa=W.positionToIndex(sa));
W=this.ensureAST(W);var Za=Gb.query.nodesAt(sa,W).reverse(),mb=Za.find(function(xd){return"Identifier"===xd.type});if(!mb&&((Za=Za[0])&&Za.type.includes("Specifier")&&Za.local&&"Identifier"===Za.local.type&&(mb=Za.local),!mb))return;sa=(Za=Gb.query.findDeclarationClosestToIndex(W,mb.name,sa))?Gb.query.scopeAtIndex(W,Za.start):Gb.query.scopeAtIndex(W,sa);var rc=Gb.query.findReferencesAndDeclsInScope(sa,mb.name).refs;return{parsed:W,scope:sa,id:mb,name:mb.name,decl:Za,refs:rc}}},{key:"expandRegion",
value:function(W,sa,Za,mb){function rc(Xd){Xd=W.positionToIndex({column:0,row:sc.row});return{range:[Xd+Na.start,Xd+Na.start+Na.value.length],prev:mb}}var xd=mb.range[0]!==mb.range[1],sc=W.indexToPosition(mb.range[0]),Na=W.tokenAt(sc);if(!xd&&Na&&["keyword","identifier"].includes(Na.type))return rc();Za=Za||this.parse(sa);sa=Gb.query.nodesAtIndex(Za,mb.range[0]).reverse().find(function(Xd){return Xd.start<mb.range[0]||Xd.end>mb.range[1]});if(!sa)return mb;Za=sa.start;xd=sa.end;return"Literal"===sa.type&&
(sa.raw||"").match(/^['"`]/)&&mb.range[0]!==sa.start&&mb.range[1]!==sa.end&&(sa.start+1<mb.range[0]||sa.end-1>mb.range[1])?{range:[Za+1,xd-1],prev:mb}:{range:[Za,xd],prev:mb}}},{key:"contractRegion",value:function(W,sa,Za,mb){return mb.prev||mb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],ma,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6780})}(void 0);Cd=sb=Gb.JavaScriptNavigator;Gb.default=sb;var Bc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");Bc.addIndexToTextPos=function(Rb,ma,Ia){return Rb.indexToPosition(Rb.positionToIndex(ma)+Ia)};Bc.connect=Zc;Bc.disconnect=Rd;Bc.string=ad;Bc.KeyHandler=Nc;Bc.Range=nd;sb=function(Rb){var ma=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),Ia=ma.hasOwnProperty("Snippet")&&"function"===
typeof ma.Snippet?ma.Snippet:ma.Snippet=function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Cb(Ia,Rb,[{key:Symbol.for("lively-instance-initialize"),value:function(W){W=void 0===W?{trigger:null,expansion:""}:W;var sa=W.expansion;this.trigger=W.trigger;this.expansion=sa;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(W){this.isExpanding&&(this.textMorph=W,Bc.connect(this.textMorph,
"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(W){this.isExpanding&&(Bc.disconnect(W,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var W=this.expansionState,sa=W.startAnchor,Za=W.endAnchor;W.isExpanding?Bc.Range.fromPositions(sa.position,Za.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var W=this.textMorph;if(W){var sa=
this.expansionState||{},Za=sa.marker,mb=sa.startAnchor,rc=sa.endAnchor;sa=sa.steps;mb&&W.removeAnchor(mb);rc&&W.removeAnchor(rc);Za&&W.removeMarker(Za);sa.forEach(function(xd){return W.removeAnchor(xd.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};W&&W.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(W){var sa=[],Za=0;Bc.string.reMatches(W,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(mb){var rc=
mb.start,xd=mb.end;mb=mb.match;var sc="";mb.startsWith("${")?(sc=$jscomp.makeIterator(mb.match(/^\$\{([0-9]+):([^\}]*)\}/)),sc.next(),mb=sc.next().value,sc=sc.next().value,mb=Number(mb)):mb=Number(mb.replace(/^\$/,""));W=W.slice(0,rc-Za)+sc+W.slice(xd-Za);sa[mb]={index:rc-Za,prefill:sc,anchor:null};Za+=xd-rc-sc.length});return{steps:sa,expansion:W}}},{key:"expandAtCursor",value:function(W){var sa=W.selection,Za=W.cursorPosition.column,mb=this.expansion;this.trigger&&(Za-=this.trigger.length);if(Za=
Math.max(0,Za))mb=Bc.string.lines(mb),mb=[mb[0]].concat($jscomp.arrayFromIterable(mb.slice(1).map(function(Gd){return Bc.string.indent(Gd," ",Za)}))),mb=mb.join("\n");var rc=this.createExpansionSteps(mb);mb=rc.expansion;rc=rc.steps;this.trigger&&sa.growLeft(this.trigger.length);sa.text=mb;var xd=sa.start;mb=sa.end;sa.collapseToEnd();if(rc.length){var sc=Bc.string.newUUID();rc.forEach(function(Gd,td){return Gd.anchor=W.addAnchor(Object.assign({id:"snippet-step-"+td+"-"+sc},Bc.addIndexToTextPos(W,xd,
Gd.index)))});var Na=W.addAnchor(Object.assign({id:"snippet-start-"+sc},xd,{insertBehavior:"stay"})),Xd=W.addAnchor(Object.assign({id:"snippet-end-"+sc},mb));this.expansionState={marker:W.addMarker({id:"snippet-marker-"+sc,get range(){return{start:Na.position,end:Xd.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:Na,endAnchor:Xd,stepIndex:0,steps:rc,isExpanding:!0};
W.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var W=this.expansionState,sa=W.steps,Za=this.textMorph;if(W.isExpanding&&Za){Za=Za.selection;W=sa[W.stepIndex];var mb=W.prefill;Za.lead=Za.anchor=W.anchor.position;Za.growRight(mb.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=sa.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(W,sa){sa=W.positionToIndex(W.cursorPosition);
return W.textString.slice(sa-this.trigger.length,sa)===this.trigger}},{key:"tryTrigger",value:function(W,sa){if(!this.canExpand(W,W.cursorPosition))return!1;this.expandAtCursor(W);return!0}},{key:"getCommands",value:function(W){var sa=this;return W.concat([{name:"[snippet] next expansion step",exec:function(Za){sa.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(Za){sa.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(W){return W.concat(Bc.KeyHandler.withBindings([{keys:"Tab",
command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],ma,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:357,end:6029})}(void 0);Bc.Snippet=sb;Bc.Snippet=sb;Bc.Snippet=
sb;var gb=[{name:"get snippets",exec:function(Rb){return Rb.pluginCollect("getSnippets",[])}}];Bc.snippetCommands=gb;Bc.snippetCommands=gb;Bc.snippetCommands=gb;var rb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");rb.buildEvalOpts=function(Rb,ma){return Rb.plugins.find(function(Ia){return Ia.isJSEditorPlugin}).sanatizedJsEnv(ma)};rb.Snippet=sb;gb=function(Rb){var ma=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ia=ma.hasOwnProperty("ModuleTopLevelVarCompleter")&&
"function"===typeof ma.ModuleTopLevelVarCompleter?ma.ModuleTopLevelVarCompleter:ma.ModuleTopLevelVarCompleter=function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Cb(Ia,Rb,[{key:"compute",value:function(W,sa){var Za,mb,rc,xd,sc,Na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xd){if(1==Xd.nextAddress){mb=(Za=W.pluginFind(function(Gd){return Gd.isJSEditorPlugin}))&&Za.systemInterface();if(!mb)return Xd.return([]);
rc=rb.buildEvalOpts(W);xd=rc.targetModule;return"local"===mb.name?(sc=Object.getOwnPropertyNames(mb.getModule(xd).recorder),Xd.jumpTo(2)):Xd.yield(mb.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+xd+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',
{targetModule:"lively://module-recorder-completer"}),3)}if(2!=Xd.nextAddress){Na=Xd.yieldResult;if(Na.isError)return Xd.return([]);sc=JSON.parse(Na.value)}sc=sc.filter(function(Gd){return!Gd.startsWith("defVar_")&&!["System","__currentLivelyModule","initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(Gd)});return Xd.return(sc.map(function(Gd){return{priority:1100,completion:Gd}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],
ma,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:227,end:1700})}(void 0);rb.ModuleTopLevelVarCompleter=gb;rb.ModuleTopLevelVarCompleter=gb;rb.ModuleTopLevelVarCompleter=gb;gb=function(Rb){var ma=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ia=ma.hasOwnProperty("DynamicJavaScriptCompleter")&&
"function"===typeof ma.DynamicJavaScriptCompleter?ma.DynamicJavaScriptCompleter:ma.DynamicJavaScriptCompleter=function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Cb(Ia,Rb,[{key:"isValidPrefix",value:function(W){return/\.[a-z0-9_]*$/i.test(W)}},{key:"isMethodCallCompletion",value:function(W){return W.endsWith(")")&&0<W.indexOf("(")}},{key:"isValidIdentifier",value:function(W){if("string"!==typeof W)return!1;this.isMethodCallCompletion(W)&&
(W=W.slice(0,W.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(W)?!0:!1}},{key:"wrapInBrackets",value:function(W){if(!isNaN(Number(W))||W.startsWith("Symbol."))return"["+W+"]";var sa="";this.isMethodCallCompletion(W)&&(sa=W.slice(W.indexOf("(")),W=W.slice(0,W.indexOf("(")));return'["'+W.replace(/"/g,'\\"')+'"]'+sa}},{key:"compute",value:function(W){var sa=this,Za,mb,rc,xd,sc,Na,Xd,Gd,td,Ib,jc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress){Za=W.selection;
Za.isEmpty()?(mb=W.getLine(Za.lead.row),mb=mb.slice(mb.lastIndexOf(":")+1,Za.lead.column)):mb=Za.text.slice(Math.max(0,Za.text.indexOf(":")),0);if(!sa.isValidPrefix(mb))return tb.return([]);xd=(rc=W.pluginFind(function(Sc){return Sc.isJSEditorPlugin}))&&rc.systemInterface();if(!xd)return tb.return([]);sc=rb.buildEvalOpts(W);return tb.yield(xd.dynamicCompletionsForPrefix(sc.targetModule,mb,sc),2)}Na=tb.yieldResult;Xd=Na.isError;Gd=Na.value;td=Na.completions;Ib=Na.prefix;if(Xd)return console.warn("javascript completer encountered error: "+
(Gd.stack||Gd)),tb.return([]);td.reduce(function(Sc,vd){vd=$jscomp.makeIterator(vd);vd.next();vd=vd.next().value;return Sc+vd.length},0);jc=td.reduce(function(Sc,vd,nb){vd=$jscomp.makeIterator(vd);var vb=vd.next().value;vd=vd.next().value;return Sc.concat(vd.map(function(yb){var yd=sa.isValidIdentifier(yb);return{info:vb,completion:yb,prefix:yd?Ib:"."+Ib,customInsertionFn:yd?sa.isMethodCallCompletion(yb)?function(ae,He,Fc,oe){He=oe.start;oe=oe.end;ae=ae.replace(/\((.*)\)/,function(ed){return"("+ed.slice(1,
-1).split(", ").map(function(te,wa){return"${"+wa+":"+te+"}"}).join(", ")+")"});ae=new rb.Snippet({expansion:ae});Fc.replace({start:He,end:oe},"");ae.expandAtCursor(Fc)}:null:function(ae,He,Fc,oe){ae=oe.start;oe=oe.end;He={row:ae.row,column:ae.column-1};oe="."===Fc.textInRange({start:He,end:ae})?{start:He,end:oe}:{start:ae,end:oe};Fc.replace(oe,sa.wrapInBrackets(yb))}}}))},[]);jc.forEach(function(Sc,vd){return Object.assign(Sc,{priority:2E3+jc.length-vd})});return tb.return(jc)})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DynamicJavaScriptCompleter"}}],ma,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5085})}(void 0);rb.DynamicJavaScriptCompleter=gb;rb.DynamicJavaScriptCompleter=gb;rb.DynamicJavaScriptCompleter=gb;rb.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
gb=function(Rb){var ma=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Ia=ma.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof ma.JavaScriptKeywordCompleter?ma.JavaScriptKeywordCompleter:ma.JavaScriptKeywordCompleter=function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Cb(Ia,Rb,[{key:"compute",value:function(W,sa){return rb.keywords.map(function(Za){return{completion:Za,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],ma,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6087,end:6225})}(void 0);rb.JavaScriptKeywordCompleter=gb;rb.JavaScriptKeywordCompleter=gb;rb.JavaScriptKeywordCompleter=gb;gb=[new rb.DynamicJavaScriptCompleter,
new rb.JavaScriptKeywordCompleter,new rb.ModuleTopLevelVarCompleter];rb.completers=gb;rb.completers=gb;rb.completers=gb;var Sa=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");Sa.Snippet=sb;var Ua=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];Sa.snippets=Ua;Sa.snippets=Ua;Sa.snippets=Ua;var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");cb.getEvalEnv=function(Rb){return(Rb=Rb.pluginFind(function(ma){return ma.isJSEditorPlugin}))?Rb.evalEnvironment:null};cb.setEvalEnv=function(Rb,ma){(Rb=Rb.pluginFind(function(Ia){return Ia.isJSEditorPlugin}))&&Object.assign(Rb.evalEnvironment,ma);return Rb.evalEnvironment};
cb.pToI=function(Rb,ma){return Rb.positionToIndex(ma)};cb.iToP=function(Rb,ma){return Rb.indexToPosition(ma)};cb.arr=he;cb.promise=af;cb.string=ad;cb.show=cc;cb.Range=nd;cb.query=Kb;cb.BaseVisitor=Af;Sa=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(Rb,ma){ma=void 0===ma?{varName:null,position:null}:ma;var Ia,W,sa,Za,mb,rc,xd,sc,Na,Xd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gd){switch(Gd.nextAddress){case 1:Ia=
ma;W=Ia.varName;sa=Ia.position;if(!W){sa||(sa=Rb.cursorPosition);Za=Rb.pluginInvokeFirst("getNavigator");mb=Za.ensureAST(Rb);rc=cb.query.nodesAt(Rb.positionToIndex(sa),mb).reverse().find(function(td){return"Identifier"===td.type});if(!rc)return Rb.showError(Error("no identifier found!")),Gd.return(!0);W=rc.name}ma=Rb.pluginFind(function(td){return td.isJSEditorPlugin}).sanatizedJsEnv();xd='lively.modules.module("'+ma.targetModule+'").undefine("'+W+'")';Gd.setCatchFinallyBlocks(2);return Gd.yield(Rb.doEval(null,
ma,xd),4);case 4:sc=Gd.yieldResult;Na=sc.error?sc.error:sc.isError?sc.value:null;Gd.leaveTryBlock(3);break;case 2:Na=Xd=Gd.enterCatchBlock();case 3:return Na?Rb.showError(Na):Rb.setStatusMessage(W+" undefined"),Gd.return(!0)}})}},{name:"change doitContext",exec:function(Rb){var ma,Ia,W,sa,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){if(1==mb.nextAddress)return ma=$jscomp,Ia=ma.makeIterator,mb.yield(Rb.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(rc){return!rc.isUsedAsEpiMorph()}}),2);W=Ia.call(ma,mb.yieldResult);if(sa=W.next().value)Za="reset"===sa,Rb.doitContext=Za?null:sa,Rb.setStatusMessage(Za?"doitContext is now\n"+sa:"doitContext reset");return mb.return(!0)})}},{name:"change eval backend",exec:function(Rb,ma){ma=void 0===ma?{backend:void 0}:ma;var Ia,W;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sa){if(1==sa.nextAddress)return Ia=ma,W=Ia.backend,void 0!==W?sa.jumpTo(2):
sa.yield(Rb.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=sa.nextAddress&&(W=sa.yieldResult,!W))return Rb.setStatusMessage("Canceled"),sa.return(!0);"local"===W&&(W=null);Rb.setStatusMessage("Eval backend is now "+(W||"local"));return sa.return(cb.setEvalEnv(Rb,{remote:W}))})}},{name:"copy current module name to clipboard",exec:function(Rb){var ma=Rb.evalEnvironment.targetModule;Rb.setStatusMessage(ma||"Cannot find module name");Rb.env.eventDispatcher.killRing.add(Rb);
Rb.env.eventDispatcher.doCopy(ma);return!0}}];cb.jsEditorCommands=Sa;cb.jsEditorCommands=Sa;cb.jsEditorCommands=Sa;var ab=[{name:"[javascript] list errors and warnings",exec:function(Rb){var ma,Ia,W,sa,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){if(1==mb.nextAddress){ma=(Rb.markers||[]).filter(function(rc){rc=rc.type;return"js-undeclared-var"===rc||"js-syntax-error"===rc});if(!ma.length)return cb.show("no warnings or errors"),mb.return(!0);Ia=ma.map(function(rc){var xd=rc.range;
return{isListItem:!0,string:"["+rc.type.split("-").slice(1).join(" ")+"] "+Rb.textInRange(xd),value:xd}});return mb.yield(Rb.world().filterableListPrompt("jump to warning or error",Ia),2)}W=mb.yieldResult;sa=$jscomp.makeIterator(W.selected);if(Za=sa.next().value)Rb.saveMark(),Rb.selection=Za,Rb.centerRow(Za.start.row);return mb.return(!0)})}},{name:"[javascript] inject import",exec:function(Rb,ma){ma=void 0===ma?{gotoImport:!1,insertImportAtCursor:!0}:ma;var Ia,W,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){switch(Za.nextAddress){case 1:return Za.yield(cb.promise.delay(0),
2);case 2:return Za.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return Ia=Za.yieldResult,W=Ia.interactivelyInjectImportIntoText,Za.yield(W(Rb,ma),4);case 4:return(sa=Za.yieldResult)||Rb.setStatusMessage("canceled"),Za.return(sa)}})}},{name:"[javascript] fix undeclared variables",exec:function(Rb,ma){ma=void 0===ma?{ignore:[],autoApplyIfSingleChoice:!1,requester:Rb}:ma;var Ia,W,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==Za.nextAddress)return Za.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=Za.nextAddress)return Ia=Za.yieldResult,W=Ia.interactivlyFixUndeclaredVariables,Za.yield(W(Rb,ma),3);sa=Za.yieldResult;Rb.focus();return Za.return(sa)})}},{name:"[javascript] remove unused imports",exec:function(Rb,ma){ma=void 0===ma?{query:!0}:ma;var Ia,W,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==Za.nextAddress)return Za.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=Za.nextAddress)return Ia=Za.yieldResult,W=Ia.cleanupUnusedImports,Za.yield(W(Rb,
ma),3);sa=Za.yieldResult;Rb.setStatusMessage(sa);return Za.return(!0)})}},{name:"[javascript] eslint report",exec:function(Rb){var ma,Ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){if(1==W.nextAddress)return W.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);ma=W.yieldResult;Ia=ma.default;try{return W.return(Ia.reportOnMorph(Rb))}catch(sa){Rb.showError(sa)}W.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(Rb){var ma,Ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(W){if(1==
W.nextAddress)return W.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);ma=W.yieldResult;Ia=ma.default;try{return W.return(Ia.previewFixesOnMorph(Rb))}catch(sa){Rb.showError(sa)}W.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(Rb,ma,Ia){function W(tb,Sc){Sc||(Sc=sc(tb,{allowReturnOutsideFunction:!0}));var vd=cb.string.lineRanges(tb),nb=tb.split("\n"),vb=[],yb=new cb.BaseVisitor,yd=yb.visitVariableDeclaration;yb.visitVariableDeclaration=function(oe,
ed,te){if(1<oe.declarations.length)for(var wa=cb.string.findLineWithIndexInLineRanges(vd,oe.start),fb=oe.declarations[0].start-vd[wa][0],Va={},ob=1;ob<oe.declarations.length;Va={$jscomp$loop$prop$actionType$2538:Va.$jscomp$loop$prop$actionType$2538,$jscomp$loop$prop$arg$2539:Va.$jscomp$loop$prop$arg$2539},ob++){var P=oe.declarations[ob],ua=cb.string.findLineWithIndexInLineRanges(vd,P.start);if(wa!==ua){var bb=nb[ua].match(/\s*/)[0].length;bb=fb-bb;0!==bb&&(P=cb.string.findLineWithIndexInLineRanges(vd,
P.end),Va.$jscomp$loop$prop$actionType$2538=0<bb?"insert":"delete",Va.$jscomp$loop$prop$arg$2539=0<bb?" ".repeat(bb):-bb,vb.push.apply(vb,$jscomp.arrayFromIterable(cb.arr.range(ua,P).map(function(Nb){return function(ic){return[Nb.$jscomp$loop$prop$actionType$2538,vd[ic][0],Nb.$jscomp$loop$prop$arg$2539]}}(Va)))))}}return yd.call(yb,oe,ed,te)};yb.accept(Sc,{},[]);for(Sc=vb.length;Sc--;){var ae=$jscomp.makeIterator(vb[Sc]),He=ae.next().value,Fc=ae.next().value;ae=ae.next().value;"insert"===He?tb=tb.slice(0,
Fc)+ae+tb.slice(Fc):"delete"===He&&(tb=tb.slice(0,Fc)+tb.slice(Fc+ae))}return tb}var sa,Za,mb,rc,xd,sc,Na,Xd,Gd,td,Ib,jc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){switch(tb.nextAddress){case 1:return sa=Ia||Math.floor(Rb.width/Rb.defaultCharExtent().width),ma=Object.assign({printWidth:sa,tabWidth:2,useTabs:!1,bracketSpacing:!1},ma),Za=lively.modules.module,mb=System.normalizeSync("prettier/standalone.js"),tb.yield(Za(mb).load({format:"global",instrument:!1}),2);case 2:return rc=
tb.yieldResult,tb.yield(Za("lively.ast/lib/acorn-extension.js").load(),3);case 3:return tb.yield(Za("lively.ast").load(),4);case 4:return xd=tb.yieldResult,sc=xd.parse,tb.yield(Za("lively.ast/lib/query.js").load(),5);case 5:return tb.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return Na=tb.yieldResult,Xd=Rb.selection.isEmpty()?Rb.documentRange:Rb.selection.range,Gd=Rb.positionToIndex(Xd.start),td=Rb.positionToIndex(Xd.end),Ib=rc.format(Rb.textString,Object.assign({},
ma,{rangeStart:Gd,rangeEnd:td,parser:function(Sc,vd,nb){return sc(Sc,{allowReturnOutsideFunction:!0})}})),Rb.undoManager.group(),jc=Na.diffChars(Rb.textString,Ib),Rb.applyJsDiffPatch(jc),Rb.selection.text=W(Rb.selection.text),Rb.undoManager.group(),tb.return(!0)}})}}];cb.jsIdeCommands=ab;cb.jsIdeCommands=ab;cb.jsIdeCommands=ab;var qb=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(Rb,ma){ma=Rb.pluginInvokeFirst("getNavigator");if(!ma)return!0;ma=ma.resolveIdentifierAt(Rb,Rb.cursorPosition);
if(!ma||!ma.id)return cb.show("No symbol identifier selected"),!0;if(!ma.decl)return cb.show("Cannot find declaration of "+ma.name),!0;Rb.saveMark();Rb.selection={start:Rb.indexToPosition(ma.decl.start),end:Rb.indexToPosition(ma.decl.end)};Rb.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(Rb){Rb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(Rb){Rb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(Rb,ma){ma=void 0===ma?{direction:null}:ma;var Ia=Rb.pluginInvokeFirst("getNavigator");if(!Ia)return!0;Ia=Ia.resolveIdentifierAt(Rb,
Rb.cursorPosition);if(!Ia||!Ia.refs)return cb.show("No symbol identifier selected"),!0;var W=Rb.selection;Ia=Ia.refs.map(function(Za){var mb=Za.end;return cb.Range.fromPositions(cb.iToP(Rb,Za.start),cb.iToP(Rb,mb))}).concat(Ia.decl?cb.Range.fromPositions(cb.iToP(Rb,Ia.decl.start),cb.iToP(Rb,Ia.decl.end)):[]).sort(cb.Range.compare);if(!Ia.length)return!0;var sa=Ia.map(String).indexOf(String(W.range));if("next"===ma.direction||"prev"===ma.direction)-1===sa&&Ia.length?Ia=[Ia[0]]:(ma=sa+("next"===ma.direction?
1:-1),0>ma?ma=Ia.length-1:ma>=Ia.length&&(ma=0),Ia=[Ia[ma]]);Ia.forEach(function(Za){var mb=W.selections.findIndex(function(xd){return xd.range.equals(Za)}),rc=W.selections.length-1;-1<mb?cb.arr.swap(W.selections,mb,rc):W.addRange(Za,!1)});W.mergeSelections();return!0}}];cb.astEditorCommands=qb;cb.astEditorCommands=qb;cb.astEditorCommands=qb;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var Zb=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
Zb.expressionAllowed=function(Rb,ma,Ia){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(ma.lastType)||"quasi"==ma.lastType&&/\{\s*$/.test(Rb.string.slice(0,Rb.pos-(Ia||0)))};Zb.passIndent=Ic;Zb.defineMode=Kd;Zb.defineMIME=Kc;Zb.registerHelper=Bd;Zb.defaultConfig={indentUnit:2};Zb.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};Zb.defineMode("javascript",
function(Rb,ma){function Ia(Qb,Tb,me){mk=Qb;lk=me;return Tb}function W(Qb,Tb){var me=Qb.next();if('"'==me||"'"==me)return Tb.tokenize=sa(me),Tb.tokenize(Qb,Tb);if("."==me&&Qb.match(/^\d+(?:[eE][+\-]?\d+)?/))return Ia("number","number");if("."==me&&Qb.match(".."))return Ia("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(me))return Ia(me);if("="==me&&Qb.eat(">"))return Ia("=>","operator");if("0"==me&&Qb.eat(/x/i))return Qb.eatWhile(/[\da-f]/i),Ia("number","number");if("0"==me&&Qb.eat(/o/i))return Qb.eatWhile(/[0-7]/i),
Ia("number","number");if("0"==me&&Qb.eat(/b/i))return Qb.eatWhile(/[01]/i),Ia("number","number");if(/\d/.test(me))return Qb.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),Ia("number","number");if("/"==me){if(Qb.eat("*"))return Tb.tokenize=Za,Za(Qb,Tb);if(Qb.eat("/"))return Qb.skipToEnd(),Ia("comment","comment");if(Zb.expressionAllowed(Qb,Tb,1)){a:for(var ie=Tb=!1;null!=(me=Qb.next());){if(!Tb){if("/"==me&&!ie)break a;"["==me?ie=!0:ie&&"]"==me&&(ie=!1)}Tb=!Tb&&"\\"==me}Qb.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return Ia("regexp","string-2")}Qb.eatWhile(Im);return Ia("operator","operator",Qb.current())}if("`"==me)return Tb.tokenize=mb,mb(Qb,Tb);if("#"==me)return Qb.skipToEnd(),Ia("error","error");if(Im.test(me))return">"==me&&Tb.lexical&&">"==Tb.lexical.type||Qb.eatWhile(Im),Ia("operator","operator",Qb.current());if($l.test(me))return Qb.eatWhile($l),Qb=Qb.current(),(me=Hm.propertyIsEnumerable(Qb)&&Hm[Qb])&&"."!=Tb.lastType?Ia(me.type,me.style,Qb):Ia("variable","variable",Qb)}function sa(Qb){return function(Tb,
me){var ie=!1,jg;if(Ui&&"@"==Tb.peek()&&Tb.match(al))return me.tokenize=W,Ia("jsonld-keyword","meta");for(;null!=(jg=Tb.next())&&(jg!=Qb||ie);)ie=!ie&&"\\"==jg;ie||(me.tokenize=W);return Ia("string","string")}}function Za(Qb,Tb){for(var me=!1,ie;ie=Qb.next();){if("/"==ie&&me){Tb.tokenize=W;break}me="*"==ie}return Ia("comment","comment")}function mb(Qb,Tb){for(var me=!1,ie;null!=(ie=Qb.next());){if(!me&&("`"==ie||"$"==ie&&Qb.eat("{"))){Tb.tokenize=W;break}me=!me&&"\\"==ie}return Ia("quasi","string-2",
Qb.current())}function rc(Qb,Tb){Tb.fatArrowAt&&(Tb.fatArrowAt=null);var me=Qb.string.indexOf("=>",Qb.start);if(!(0>me)){if(jk){var ie=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Qb.string.slice(Qb.start,me));ie&&(me=ie.index)}ie=0;var jg=!1;for(--me;0<=me;--me){var Mg=Qb.string.charAt(me),kk="([{}])".indexOf(Mg);if(0<=kk&&3>kk){if(!ie){++me;break}if(0==--ie){"("==Mg&&(jg=!0);break}}else if(3<=kk&&6>kk)++ie;else if($l.test(Mg))jg=!0;else{if(/["'\/]/.test(Mg))return;if(jg&&!ie){++me;break}}}jg&&
!ie&&(Tb.fatArrowAt=me)}}function xd(Qb,Tb,me,ie,jg,Mg){this.indented=Qb;this.column=Tb;this.type=me;this.prev=jg;this.info=Mg;null!=ie&&(this.align=ie)}function sc(){for(var Qb=arguments.length-1;0<=Qb;Qb--)Hf.cc.push(arguments[Qb])}function Na(){sc.apply(null,arguments);return!0}function Xd(Qb){function Tb(ie){for(;ie;ie=ie.next)if(ie.name==Qb)return!0;return!1}var me=Hf.state;Hf.marked="def";me.context?Tb(me.localVars)||(me.localVars={name:Qb,next:me.localVars}):!Tb(me.globalVars)&&ma.globalVars&&
(me.globalVars={name:Qb,next:me.globalVars})}function Gd(){Hf.state.context={prev:Hf.state.context,vars:Hf.state.localVars};Hf.state.localVars=to}function td(){Hf.state.localVars=Hf.state.context.vars;Hf.state.context=Hf.state.context.prev}function Ib(Qb,Tb){var me=function(){var ie=Hf.state,jg=ie.indented;if("stat"==ie.lexical.type)jg=ie.lexical.indented;else for(var Mg=ie.lexical;Mg&&")"==Mg.type&&Mg.align;Mg=Mg.prev)jg=Mg.indented;ie.lexical=new xd(jg,Hf.stream.column(),Qb,null,ie.lexical,Tb)};
me.lex=!0;return me}function jc(){var Qb=Hf.state;Qb.lexical.prev&&(")"==Qb.lexical.type&&(Qb.indented=Qb.lexical.indented),Qb.lexical=Qb.lexical.prev)}function tb(Qb){function Tb(me){return me==Qb?Na():";"==Qb?sc():Na(Tb)}return Tb}function Sc(Qb,Tb){return"var"==Qb?Na(Ib("vardef",Tb.length),ac,tb(";"),jc):"keyword a"==Qb?Na(Ib("form"),vb,Sc,jc):"keyword b"==Qb?Na(Ib("form"),Sc,jc):"{"==Qb?Na(Ib("}"),qe,jc):";"==Qb?Na():"if"==Qb?("else"==Hf.state.lexical.info&&Hf.state.cc[Hf.state.cc.length-1]==
jc&&Hf.state.cc.pop()(),Na(Ib("form"),vb,Sc,jc,Ha)):"function"==Qb?Na(zb):"for"==Qb?Na(Ib("form"),Ta,Sc,jc):"variable"==Qb?jk&&"type"==Tb?(Hf.marked="keyword",Na(Re,tb("operator"),Re,tb(";"))):Na(Ib("stat"),P):"switch"==Qb?Na(Ib("form"),vb,tb("{"),Ib("}","switch"),qe,jc,jc):"case"==Qb?Na(vd,tb(":")):"default"==Qb?Na(tb(":")):"catch"==Qb?Na(Ib("form"),Gd,tb("("),zc,tb(")"),Sc,jc,td):"class"==Qb?Na(Ib("form"),id,jc):"export"==Qb?Na(Ib("stat"),mg,jc):"import"==Qb?Na(Ib("stat"),pf,jc):"module"==Qb?Na(Ib("form"),
Ng,tb("{"),Ib("}"),qe,jc,jc):"async"==Qb?Na(Sc):"@"==Tb?Na(vd,Sc):sc(Ib("stat"),vd,tb(";"),jc)}function vd(Qb){return yb(Qb,!1)}function nb(Qb){return yb(Qb,!0)}function vb(Qb){return"("!=Qb?sc():Na(Ib(")"),vd,tb(")"),jc)}function yb(Qb,Tb){if(Hf.state.fatArrowAt==Hf.stream.start){var me=Tb?wa:te;if("("==Qb)return Na(Gd,Ib(")"),fd(Ng,")"),jc,tb("=>"),me,td);if("variable"==Qb)return sc(Gd,Ng,tb("=>"),me,td)}me=Tb?Fc:He;return Un.hasOwnProperty(Qb)?Na(me):"function"==Qb?Na(zb,me):"class"==Qb?Na(Ib("form"),
wc,jc):"keyword c"==Qb||"async"==Qb?Na(Tb?ae:yd):"("==Qb?Na(Ib(")"),yd,tb(")"),jc,me):"operator"==Qb||"spread"==Qb?Na(Tb?nb:vd):"["==Qb?Na(Ib("]"),bl,jc,me):"{"==Qb?Td(bb,"}",null,me):"quasi"==Qb?sc(oe,me):"new"==Qb?Na(fb(Tb)):Na()}function yd(Qb){return Qb.match(/[;\}\)\],]/)?sc():sc(vd)}function ae(Qb){return Qb.match(/[;\}\)\],]/)?sc():sc(nb)}function He(Qb,Tb){return","==Qb?Na(vd):Fc(Qb,Tb,!1)}function Fc(Qb,Tb,me){var ie=0==me?He:Fc,jg=0==me?vd:nb;if("=>"==Qb)return Na(Gd,me?wa:te,td);if("operator"==
Qb)return/\+\+|--/.test(Tb)?Na(ie):"?"==Tb?Na(vd,tb(":"),jg):Na(jg);if("quasi"==Qb)return sc(oe,ie);if(";"!=Qb){if("("==Qb)return Td(nb,")","call",ie);if("."==Qb)return Na(ua,ie);if("["==Qb)return Na(Ib("]"),yd,tb("]"),jc,ie)}}function oe(Qb,Tb){return"quasi"!=Qb?sc():"${"!=Tb.slice(Tb.length-2)?Na(oe):Na(vd,ed)}function ed(Qb){if("}"==Qb)return Hf.marked="string-2",Hf.state.tokenize=mb,Na(oe)}function te(Qb){rc(Hf.stream,Hf.state);return sc("{"==Qb?Sc:vd)}function wa(Qb){rc(Hf.stream,Hf.state);return sc("{"==
Qb?Sc:nb)}function fb(Qb){return function(Tb){return"."==Tb?Na(Qb?ob:Va):sc(Qb?nb:vd)}}function Va(Qb,Tb){if("target"==Tb)return Hf.marked="keyword",Na(He)}function ob(Qb,Tb){if("target"==Tb)return Hf.marked="keyword",Na(Fc)}function P(Qb){return":"==Qb?Na(jc,Sc):sc(He,tb(";"),jc)}function ua(Qb){if("variable"==Qb)return Hf.marked="property",Na()}function bb(Qb,Tb){if("async"==Qb)return Hf.marked="property",Na(bb);if("variable"==Qb||"keyword"==Hf.style)return Hf.marked="property","get"==Tb||"set"==
Tb?Na(Nb):Na(ic);if("number"==Qb||"string"==Qb)return Hf.marked=Ui?"property":Hf.style+" property",Na(ic);if("jsonld-keyword"==Qb)return Na(ic);if("modifier"==Qb)return Na(bb);if("["==Qb)return Na(vd,tb("]"),ic);if("spread"==Qb)return Na(vd);if(":"==Qb)return sc(ic)}function Nb(Qb){if("variable"!=Qb)return sc(ic);Hf.marked="property";return Na(zb)}function ic(Qb){if(":"==Qb)return Na(nb);if("("==Qb)return sc(zb)}function fd(Qb,Tb,me){function ie(jg,Mg){return(me?-1<me.indexOf(jg):","==jg)?(jg=Hf.state.lexical,
"call"==jg.info&&(jg.pos=(jg.pos||0)+1),Na(function(kk,nn){return kk==Tb||nn==Tb?sc():sc(Qb)},ie)):jg==Tb||Mg==Tb?Na():Na(tb(Tb))}return function(jg,Mg){return jg==Tb||Mg==Tb?Na():sc(Qb,ie)}}function Td(Qb,Tb,me){for(var ie=3;ie<arguments.length;ie++)Hf.cc.push(arguments[ie]);return Na(Ib(Tb,me),fd(Qb,Tb),jc)}function qe(Qb){return"}"==Qb?Na():sc(Sc,qe)}function $c(Qb,Tb){if(jk){if(":"==Qb)return Na(Re);if("?"==Tb)return Na($c)}}function Re(Qb){if("variable"==Qb)return Hf.marked="variable-3",Na(gg);
if("string"==Qb||"number"==Qb||"atom"==Qb)return Na(gg);if("{"==Qb)return Na(Ib("}"),fd(We,"}",",;"),jc);if("("==Qb)return Na(fd(Rf,")"),jf)}function jf(Qb){if("=>"==Qb)return Na(Re)}function We(Qb,Tb){if("variable"==Qb||"keyword"==Hf.style)return Hf.marked="property",Na(We);if("?"==Tb)return Na(We);if(":"==Qb)return Na(Re)}function Rf(Qb){if("variable"==Qb)return Na(Rf);if(":"==Qb)return Na(Re)}function gg(Qb,Tb){if("<"==Tb)return Na(Ib(">"),fd(Re,">"),jc,gg);if("|"==Tb||"."==Qb)return Na(Re);if("["==
Qb)return Na(tb("]"),gg);if("extends"==Tb)return Na(Re)}function ac(){return sc(Ng,$c,rg,Ve)}function Ng(Qb,Tb){if("modifier"==Qb)return Na(Ng);if("variable"==Qb)return Xd(Tb),Na();if("spread"==Qb)return Na(Ng);if("["==Qb)return Td(Ng,"]");if("{"==Qb)return Td(qf,"}")}function qf(Qb,Tb){if("variable"==Qb&&!Hf.stream.match(/^\s*:/,!1))return Xd(Tb),Na(rg);"variable"==Qb&&(Hf.marked="property");return"spread"==Qb?Na(Ng):"}"==Qb?sc():Na(tb(":"),Ng,rg)}function rg(Qb,Tb){if("="==Tb)return Na(nb)}function Ve(Qb){if(","==
Qb)return Na(ac)}function Ha(Qb,Tb){if("keyword b"==Qb&&"else"==Tb)return Na(Ib("form","else"),Sc,jc)}function Ta(Qb){if("("==Qb)return Na(Ib(")"),Db,tb(")"),jc)}function Db(Qb){return"var"==Qb?Na(ac,tb(";"),Fa):";"==Qb?Na(Fa):"variable"==Qb?Na(da):sc(vd,tb(";"),Fa)}function da(Qb,Tb){return"in"==Tb||"of"==Tb?(Hf.marked="keyword",Na(vd)):Na(He,Fa)}function Fa(Qb,Tb){return";"==Qb?Na(jb):"in"==Tb||"of"==Tb?(Hf.marked="keyword",Na(vd)):sc(vd,tb(";"),jb)}function jb(Qb){")"!=Qb&&Na(vd)}function zb(Qb,
Tb){if("*"==Tb)return Hf.marked="keyword",Na(zb);if("variable"==Qb)return Xd(Tb),Na(zb);if("("==Qb)return Na(Gd,Ib(")"),fd(zc,")"),jc,$c,Sc,td);if(jk&&"<"==Tb)return Na(Ib(">"),fd(Re,">"),jc,zb)}function zc(Qb){return"spread"==Qb?Na(zc):sc(Ng,$c,rg)}function wc(Qb,Tb){return"variable"==Qb?id(Qb,Tb):qd(Qb,Tb)}function id(Qb,Tb){if("variable"==Qb)return Xd(Tb),Na(qd)}function qd(Qb,Tb){if("<"==Tb)return Na(Ib(">"),fd(Re,">"),jc,qd);if("extends"==Tb||"implements"==Tb||jk&&","==Qb)return Na(jk?Re:vd,
qd);if("{"==Qb)return Na(Ib("}"),cd,jc)}function cd(Qb,Tb){if("variable"==Qb||"keyword"==Hf.style){if(("async"==Tb||"static"==Tb||"get"==Tb||"set"==Tb||jk&&("public"==Tb||"private"==Tb||"protected"==Tb||"readonly"==Tb||"abstract"==Tb))&&Hf.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Hf.marked="keyword",Na(cd);Hf.marked="property";return Na(jk?of:zb,cd)}if("["==Qb)return Na(vd,tb("]"),jk?of:zb,cd);if("*"==Tb)return Hf.marked="keyword",Na(cd);if(";"==Qb)return Na(cd);if("}"==Qb)return Na();if("@"==
Tb)return Na(vd,cd)}function of(Qb,Tb){return"?"==Tb?Na(of):":"==Qb?Na(Re,rg):"="==Tb?Na(nb):sc(zb)}function mg(Qb,Tb){return"*"==Tb?(Hf.marked="keyword",Na(ii,tb(";"))):"default"==Tb?(Hf.marked="keyword",Na(vd,tb(";"))):"{"==Qb?Na(fd(Yf,"}"),ii,tb(";")):sc(Sc)}function Yf(Qb,Tb){if("as"==Tb)return Hf.marked="keyword",Na(tb("variable"));if("variable"==Qb)return sc(nb,Yf)}function pf(Qb){return"string"==Qb?Na():sc(wi,Rh,ii)}function wi(Qb,Tb){if("{"==Qb)return Td(wi,"}");"variable"==Qb&&Xd(Tb);"*"==
Tb&&(Hf.marked="keyword");return Na(Oj)}function Rh(Qb){if(","==Qb)return Na(wi,Rh)}function Oj(Qb,Tb){if("as"==Tb)return Hf.marked="keyword",Na(wi)}function ii(Qb,Tb){if("from"==Tb)return Hf.marked="keyword",Na(vd)}function bl(Qb){return"]"==Qb?Na():sc(fd(nb,"]"))}Rb=Object.assign({},Zb.defaultConfig,{},Rb);ma=Object.assign({},Zb.defaultParserConfig,{},ma);var wg=Rb.indentUnit,nk=ma.statementIndent,Ui=ma.jsonld,Bk=ma.json||Ui,jk=ma.typescript,$l=ma.wordCharacters||/[\w$\xa1-\uffff]/,Hm=function(){function Qb(nn){return{type:nn,
style:"keyword"}}var Tb=Qb("keyword a"),me=Qb("keyword b"),ie=Qb("keyword c"),jg=Qb("operator"),Mg={type:"atom",style:"atom"};Tb={if:Qb("if"),while:Tb,with:Tb,else:me,do:me,try:me,finally:me,return:ie,break:ie,continue:ie,new:Qb("new"),delete:ie,throw:ie,debugger:ie,var:Qb("var"),const:Qb("var"),let:Qb("var"),function:Qb("function"),catch:Qb("catch"),for:Qb("for"),switch:Qb("switch"),case:Qb("case"),default:Qb("default"),in:jg,typeof:jg,instanceof:jg,true:Mg,false:Mg,null:Mg,undefined:Mg,NaN:Mg,Infinity:Mg,
this:Qb("this"),class:Qb("class"),super:Qb("atom"),yield:ie,export:Qb("export"),import:Qb("import"),extends:ie,await:ie,async:Qb("async")};if(jk){me={type:"variable",style:"variable-3"};ie={interface:Qb("class"),implements:ie,namespace:ie,module:Qb("module"),enum:Qb("module"),public:Qb("modifier"),private:Qb("modifier"),protected:Qb("modifier"),abstract:Qb("modifier"),as:jg,string:me,number:me,boolean:me,any:me};for(var kk in ie)Tb[kk]=ie[kk]}return Tb}(),Im=/[+\-*&%=<>!?|~^@]/,al=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
mk,lk,Un={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Hf={state:null,column:null,marked:null,cc:null},to={name:"this",next:{name:"arguments"}};jc.lex=!0;return{startState:function(Qb){Qb={tokenize:W,lastType:"sof",cc:[],lexical:new xd((Qb||0)-wg,0,"block",!1),localVars:ma.localVars,context:ma.localVars&&{vars:ma.localVars},indented:Qb||0};ma.globalVars&&"object"===typeof ma.globalVars&&(Qb.globalVars=ma.globalVars);return Qb},token:function(Qb,Tb){Qb.sol()&&(Tb.lexical.hasOwnProperty("align")||
(Tb.lexical.align=!1),Tb.indented=Qb.indentation(),rc(Qb,Tb));if(Tb.tokenize!=Za&&Qb.eatSpace())return null;var me=Tb.tokenize(Qb,Tb);if("comment"==mk)return me;Tb.lastType="operator"!=mk||"++"!=lk&&"--"!=lk?mk:"incdec";a:{var ie=mk,jg=lk,Mg=Tb.cc;Hf.state=Tb;Hf.stream=Qb;Hf.marked=null;Hf.cc=Mg;Hf.style=me;Tb.lexical.hasOwnProperty("align")||(Tb.lexical.align=!0);for(Qb=0;;){if(1E5<Qb++)throw Error("endless");if((Mg.length?Mg.pop():Bk?vd:Sc)(ie,jg)){for(;Mg.length&&Mg[Mg.length-1].lex;)Mg.pop()();
if(Hf.marked){me=Hf.marked;break a}if(ie="variable"==ie)b:{for(ie=Tb.localVars;ie;ie=ie.next)if(ie.name==jg){ie=!0;break b}for(Tb=Tb.context;Tb;Tb=Tb.prev)for(ie=Tb.vars;ie;ie=ie.next)if(ie.name==jg){ie=!0;break b}ie=void 0}if(ie){me="variable-2";break a}break a}}}return me},indent:function(Qb,Tb){if(Qb.tokenize==Za)return Zb.passIndent;if(Qb.tokenize!=W)return 0;var me=Tb&&Tb.charAt(0),ie=Qb.lexical,jg;if(!/^\s*else\b/.test(Tb))for(var Mg=Qb.cc.length-1;0<=Mg;--Mg){var kk=Qb.cc[Mg];if(kk==jc)ie=
ie.prev;else if(kk!=Ha)break}for(;!("stat"!=ie.type&&"form"!=ie.type||"}"!=me&&(!(jg=Qb.cc[Qb.cc.length-1])||jg!=He&&jg!=Fc||/^[,\.=+\-*:?[\(]/.test(Tb)));)ie=ie.prev;nk&&")"==ie.type&&"stat"==ie.prev.type&&(ie=ie.prev);jg=ie.type;Mg=me==jg;return(kk=Qb._string)&&kk.trimLeft().startsWith("?")&&":"===me?kk.indexOf("?"):kk&&":"===Qb.lastType&&"}"!==ie.type?kk.match(/^\s*/)[0].length:"vardef"==jg?(Tb=ie.indented+ie.info+2+Qb.localVars.name.length,"?"===me||":"===me||"|"===me||"&"===me?Tb:","==Qb.lastType?
ie.indented+ie.info+1:"operator"==Qb.lastType?Tb+3:ie.indented):"form"==jg&&"{"==me?ie.indented:"form"==jg?ie.indented+wg:"stat"==jg?(me=ie.indented,Qb="operator"==Qb.lastType||","==Qb.lastType||Im.test(Tb.charAt(0))||/[,.]/.test(Tb.charAt(0)),me+(Qb?nk||wg:0)):"switch"!=ie.info||Mg||0==ma.doubleIndentSwitch?ie.align?ie.column+(Mg?0:1):ie.indented+(Mg?0:wg):ie.indented+(/^(?:case|default)\b/.test(Tb)?wg:2*wg)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:Bk?null:"/*",blockCommentEnd:Bk?
null:"*/",lineComment:Bk?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:Bk?"json":"javascript",jsonldMode:Ui,jsonMode:Bk,expressionAllowed:Zb.expressionAllowed,skipExpression:function(Qb){var Tb=Qb.cc[Qb.cc.length-1];Tb!=vd&&Tb!=nb||Qb.cc.pop()}}});Zb.registerHelper("wordChars","javascript",/[\w$]/);Zb.defineMIME("text/javascript","javascript");Zb.defineMIME("text/ecmascript","javascript");Zb.defineMIME("application/javascript","javascript");Zb.defineMIME("application/x-javascript",
"javascript");Zb.defineMIME("application/ecmascript","javascript");Zb.defineMIME("application/json",{name:"javascript",json:!0});Zb.defineMIME("application/x-json",{name:"javascript",json:!0});Zb.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});Zb.defineMIME("text/typescript",{name:"javascript",typescript:!0});Zb.defineMIME("application/typescript",{name:"javascript",typescript:!0});var kc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");kc.string=ad;kc.JavaScriptChecker=
Od;kc.JavaScriptNavigator=Cd;kc.completers=gb;kc.jsSnippets=Ua;kc.jsIdeCommands=ab;kc.jsEditorCommands=Sa;kc.astEditorCommands=qb;kc.CodeMirrorEnabledEditorPlugin=be;kc.Snippet=sb;kc.parser=rd;kc.localInterface=yc;kc.systemInterfaceNamed=Cc;kc.serverInterfaceFor=Pb;kc.l2lInterfaceFor=Dc;Od=function(Rb){var ma=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),Ia=ma.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof ma.JavaScriptEditorPlugin?ma.JavaScriptEditorPlugin:ma.JavaScriptEditorPlugin=
function(W){W&&W[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Cb(Ia,Rb,[{key:Symbol.for("lively-instance-initialize"),value:function(){Cb._get(Object.getPrototypeOf(Ia.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new kc.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(W){Cb._get(Object.getPrototypeOf(Ia.prototype),"attach",this).call(this,W);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:W})}},{key:"detach",value:function(W){this.checker.uninstall(this.textMorph);Cb._get(Object.getPrototypeOf(Ia.prototype),"detach",this).call(this,W)}},{key:"getNavigator",value:function(){return new kc.JavaScriptNavigator}},{key:"getCompleters",value:function(W){return kc.completers.concat(W)}},
{key:"getCommands",value:function(W){return[].concat($jscomp.arrayFromIterable(Cb._get(Object.getPrototypeOf(Ia.prototype),"getCommands",this).call(this,W)),$jscomp.arrayFromIterable(kc.jsIdeCommands),$jscomp.arrayFromIterable(kc.jsEditorCommands),$jscomp.arrayFromIterable(kc.astEditorCommands))}},{key:"getKeyBindings",value:function(W){return[].concat($jscomp.arrayFromIterable(W),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(W){var sa=this,Za,mb,rc,xd,sc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Na){Za=sa.textMorph;mb=[{command:"doit",target:Za,showKeyShortcuts:!0},{command:"inspectit",target:Za,showKeyShortcuts:!0},{command:"editit",target:Za,showKeyShortcuts:!0},{command:"printit",target:Za,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:Za,showKeyShortcuts:!0},{command:"eval all",target:Za,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:Za,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:Za,showKeyShortcuts:!0},{isDivider:!0}];sa.evalEnvironment.targetModule&&mb.push({command:"[javascript] inject import",alias:"add import",target:Za},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:Za},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:Za});rc=sa.getNavigator();(xd=rc.resolveIdentifierAt(Za,
Za.cursorPosition))&&mb.push({command:"selectDefinition",alias:'jump to definition of "'+xd.name+'"',target:Za},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+xd.name+'"',target:Za});(sc=Za.selection.text.trim())&&mb.push({command:"open code search",alias:'code search for "'+kc.string.truncate(sc,30)+'"',target:Za.world(),args:{input:sc,backend:sa.backend()}});mb.push({isDivider:!0});return Na.return(mb.concat(W))})}},{key:"getSnippets",value:function(){return kc.jsSnippets.map(function(W){var sa=
$jscomp.makeIterator(W);W=sa.next().value;sa=sa.next().value;return new kc.Snippet({trigger:W,expansion:sa})})}},{key:"sanatizedJsEnv",value:function(W){W=Object.assign({},this.evalEnvironment,{},W);W.format||(W.formatd="esm");W.context||(W.context=this.textMorph);W.sourceURL||(W.sourceURL=W.targetModule+"_doit_"+Date.now());W.systemInterface||(W.systemInterface=kc.localInterface);return W}},{key:"backend",value:function(W){W=this.sanatizedJsEnv(W);return W.remote?W.remote:"local"}},{key:"systemInterface",
value:function(W){return this.sanatizedJsEnv(W).systemInterface||kc.localInterface}},{key:"setSystemInterface",value:function(W){return this.evalEnvironment.systemInterface=W}},{key:"setSystemInterfaceNamed",value:function(W){return this.setSystemInterface(kc.systemInterfaceNamed(W))}},{key:"runEval",value:function(W,sa){sa=this.sanatizedJsEnv(sa);return this.systemInterface(sa).runEval(W,sa)}},{key:"parser",get:function(){return kc.parser}},{key:"parse",value:function(W){W=void 0===W?null:W;if(this._ast&&
this._ast._astType===W)return this._ast;var sa=this.parser,Za=this.textMorph.textString;if(!sa)return null;var mb={withComments:!0,allowReturnOutsideFunction:!0};W&&(mb.type=W);if(Za.startsWith("#!")){var rc=Za.indexOf("\n");Za=" ".repeat(rc)+Za.slice(rc)}sa=sa.fuzzyParse(Za,mb);sa._astType=W;return this._ast=sa}},{key:"undeclaredVariables",value:function(W){var sa=this.parser,Za=this.evalEnvironment.knownGlobals||[];W=this.parse(void 0===W?null:W);return sa&&W?sa.query.findGlobalVarRefs(W,{jslintGlobalComment:!0}).filter(function(mb){return!Za.includes(mb.name)}):
[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],ma,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(kc.CodeMirrorEnabledEditorPlugin);Od=kc.JavaScriptEditorPlugin;Ea("default",Od);kc.default=Od}}});
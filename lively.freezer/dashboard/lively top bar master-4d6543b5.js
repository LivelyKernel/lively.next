System.register(["./__root_module__-dce2a509.js","kld-intersections","./user-ui-2b4d12a6.js","./index-230ef1f1.js"],function(Ba,zb){var Ib,nc,bc,Sd,Vc,Ud,Yc,Oc;return{setters:[function(qd){Ib=qd.an;nc=qd.as;bc=qd.a3;Sd=qd.C;Vc=qd.a6;Ud=qd.L;Yc=qd.r;Oc=qd.aw},function(){},function(){},function(){}],execute:function(){var qd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");qd.Morph=Ib;qd.Icon=nc;qd.pt=bc;qd.Color=Sd;qd.arr=Vc;qd.LoadingIndicator=Ud;qd.resource=Yc;var ie=function(Ye){var sf=
lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),ne=sf.hasOwnProperty("LivelyTopBar")&&"function"===typeof sf.LivelyTopBar?sf.LivelyTopBar:sf.LivelyTopBar=function(cc){cc&&cc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Oc(ne,Ye,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode="Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var cc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hc){if(1==
Hc.nextAddress)return cc.isComponent?Hc.return():Hc.yield(cc.whenRendered(),2);document.body.style.background="black";cc.setEditMode("Halo");cc.getSubmorphNamed("fast load toggler").refresh();Hc.jumpToEnd()})}},{key:"onUserChanged",value:function(cc){this.getSubmorphNamed("user flap").onUserChanged(cc)}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=qd.pt(0,0));var cc=this.getSubmorphNamed("user flap");this.get("ipad status bar").width=
this.width;cc.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var cc=this;return Object.entries(this.shapeToIcon).map(function(Hc){Hc=$jscomp.makeIterator(Hc);var Md=Hc.next().value,fc=Hc.next().value;Hc=fc.shortcut;fc=fc.args;return[[].concat($jscomp.arrayFromIterable(cc.currentShapeMode===Md?[].concat($jscomp.arrayFromIterable(qd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(qd.Icon.textAttribute.apply(qd.Icon,$jscomp.arrayFromIterable(fc))),
["   "+Md+" ",{float:"none"},"      "+Hc,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){cc.currentShapeMode=Md;cc.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var cc=this;return Object.entries(this.sideBarToIcon).map(function(Hc){Hc=$jscomp.makeIterator(Hc);var Md=Hc.next().value;Hc=Hc.next().value.args;return[[].concat($jscomp.arrayFromIterable(cc.activeSideBars.includes(Md)?[].concat($jscomp.arrayFromIterable(qd.Icon.textAttribute("check",
{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(qd.Icon.textAttribute.apply(qd.Icon,$jscomp.arrayFromIterable(Hc))),["   "+Md+" ",{float:"none"}]),function(){return cc.openSideBar(Md)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",value:function(cc){"Hand"==this._currentEditMode&&this.setEditMode("Hand",
!0)}},{key:"onKeyDown",value:function(cc){Oc._get(Object.getPrototypeOf(ne.prototype),"onKeyDown",this).call(this,cc);if(cc.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!cc.isAltDown()){var Hc={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(cc.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=Hc[cc.key];this.setEditMode("Shape");
break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(cc){var Hc=this,Md,fc,$d,pe,Cc,Ic;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sb){switch(Sb.nextAddress){case 1:Hc.activeSideBars.includes(cc)?qd.arr.remove(Hc.activeSideBars,cc):Hc.activeSideBars.push(cc);if("Scene Graph"!=cc){Sb.jumpTo(2);break}if(Hc.sideBar){Sb.jumpTo(3);break}Md=qd.LoadingIndicator.open("loading side bar");return Sb.yield(Md.whenRendered(),4);case 4:return fc=Hc,Sb.yield(zb.import("./scene graph side bar master-e8fb688c.js"),
6);case 6:if(!($d=Sb.yieldResult)){Sb.jumpTo(7);break}return Sb.yield(qd.resource("part://SystemIDE/scene graph side bar master"),8);case 8:$d=Sb.yieldResult;case 7:return Sb.yield($d.read(),5);case 5:return fc.sideBar=Sb.yieldResult,Hc.sideBar.hasFixedPosition=!0,Hc.sideBar.respondsToVisibleWindow=!0,Hc.sideBar.openInWorld(),Hc.sideBar.right=0,Sb.yield(Hc.sideBar.whenRendered(),9);case 9:Md.remove();case 3:Hc.sideBar.toggle(Hc.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=
cc){Sb.jumpTo(0);break}if(Hc.stylingPalette){Sb.jumpTo(11);break}pe=qd.LoadingIndicator.open("loading side bar");return Sb.yield(pe.whenRendered(),12);case 12:return Cc=Hc,Sb.yield(zb.import("./styling side bar master-d3707149.js"),14);case 14:if(!(Ic=Sb.yieldResult)){Sb.jumpTo(15);break}return Sb.yield(qd.resource("part://SystemIDE/styling side bar master"),16);case 16:Ic=Sb.yieldResult;case 15:return Sb.yield(Ic.read(),13);case 13:return Cc.stylingPalette=Sb.yieldResult,Hc.stylingPalette.collapseAll(),
Hc.stylingPalette.hasFixedPosition=!0,Hc.stylingPalette.respondsToVisibleWindow=!0,Hc.stylingPalette.openInWorld(),Hc.stylingPalette.left=Hc.world().width,Sb.yield(Hc.stylingPalette.whenRendered(),17);case 17:pe.remove();case 11:Hc.stylingPalette.toggle(Hc.activeSideBars.includes("Styling Palette")),Sb.jumpToEnd()}})}},{key:"onMouseDown",value:function(cc){var Hc=this.get("select shape type"),Md=this.get("shape mode button"),fc=this.get("side bar selector");cc.targetMorph==Hc&&(this.world().openWorldMenu(cc,
this.getShapeMenuItems()).position=Md.globalBounds().bottomLeft().subPt(this.world().scroll));cc.targetMorph==Md&&this.setEditMode("Shape");"text mode button"==cc.targetMorph.name&&this.setEditMode("Text");"hand mode button"==cc.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==cc.targetMorph.name&&this.setEditMode("Halo");"open component browser"==cc.targetMorph.name&&this.interactivelyLoadComponent();"load world button"==cc.targetMorph.name&&this.world().execCommand("load world");cc.targetMorph==
fc&&(this.world().openWorldMenu(cc,this.getSideBarMenuItems()).position=fc.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var cc=this,Hc,Md,fc,$d,pe;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cc){if(1==Cc.nextAddress)return Hc=cc.get("open component browser"),Md=cc.get("user flap"),fc=Md.haloShadow,$d=Md.haloColor,pe=qd.Color.rgb(102,102,102),Hc.fontColor=$d,Hc.dropShadow=fc,Cc.yield(cc.world().execCommand("browse and load component"),
2);Hc.dropShadow=!1;Hc.fontColor=pe;Cc.jumpToEnd()})}},{key:"setEditMode",value:function(cc,Hc){var Md=this;Hc=void 0===Hc?!1:Hc;var fc=this.get("user flap"),$d=fc.haloShadow,pe=fc.haloColor,Cc=qd.Color.rgb(102,102,102);Hc||(this._currentEditMode=cc);Hc=this.get("shape mode button");fc=this.get("text mode button");var Ic=this.get("hand mode button"),Sb=this.get("halo mode button");[["Shape",Hc.submorphs],["Text",[fc]],["Hand",[Ic]],["Halo",[Sb]]].forEach(function(Jc){var dd=$jscomp.makeIterator(Jc);
Jc=dd.next().value;dd=dd.next().value;"Shape"==cc?Md.world().toggleShapeMode(!0,Md.currentShapeMode):"Text"==cc?Md.world().toggleShapeMode(!0,"Text"):Md.world().toggleShapeMode(!1);Md.world().showHaloPreviews("Halo"==cc);Jc==cc?dd.forEach(function(Jd){Jd.dropShadow=$d;Jd.fontColor=pe}):dd.forEach(function(Jd){Jd.dropShadow=null;Jd.fontColor=Cc})})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],
set:function(cc){this.setProperty("currentShapeMode",cc);this.get("shape status icon").textAndAttributes=qd.Icon.textAttribute(this.shapeToIcon[cc].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},
Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],sf,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-157"}}},{start:328,end:9460})}(qd.Morph);ie=qd.LivelyTopBar;qd.default=ie}}});System.register("21",["./__root_module__-dce2a509.js","kld-intersections","./index-0a258dcd.js","./user-ui-2b4d12a6.js"],function(){return{setters:[function(){},function(){},function(){},function(){}],execute:function(){}}});
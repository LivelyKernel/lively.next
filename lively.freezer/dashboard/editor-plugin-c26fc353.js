System.register(["./__root_module__-f418f9fd.js","./index-96ee3fea.js","./index-6e65d49f.js"],function(Ha){var tb,Ab,kc,ac,Ld,Tc,$d,Uc,Pc,Jd,pe,Ze,Ff,te,Bc,sd,le,jc,je,Ae,Dc,Mc,bc,Gc,Zc,Rd,Kd,rb,ob,Bb,Va,Ta,xa,wa,Qa,Eb,rc,qb,sb,kb,ha,Pa,T,ia,Fa;return{setters:[function($a){tb=$a.C;Ab=$a.aJ;kc=$a.a6;ac=$a.a1;Ld=$a.a3;Tc=$a.ab;$d=$a.aM;Uc=$a.aB;Pc=$a.aF;Jd=$a.a7;pe=$a.ba;Ze=$a.bv;Ff=$a.bw;te=$a.a8;Bc=$a.ak;sd=$a.aH;le=$a.aG;jc=$a.bx;je=$a.by;Ae=$a.a2;Dc=$a.P;Mc=$a.$;bc=$a.bi;Gc=$a.av;Zc=$a.aV;Rd=
$a.ax;Kd=$a.aN;rb=$a.ay;ob=$a.aw;Bb=$a.aX;Va=$a.aK;Ta=$a.ad;xa=$a.bz;wa=$a.L;Qa=$a.bA;Eb=$a.aC;rc=$a.aP;qb=$a.bn;sb=$a.bB;kb=$a.aO},function($a){ha=$a.M;Pa=$a.I;T=$a.v;ia=$a.p},function($a){Fa=$a.localInterface}],execute:function(){function $a(Oa,db){if(!0===db)return db;if(Oa.copyState)return Oa.copyState(db);Oa={};for(var Fb in db){var ea=db[Fb];ea instanceof Array&&(ea=ea.concat([]));Oa[Fb]=ea}return Oa}function zb(Oa,db,Fb){return Oa.startState?Oa.startState(db,Fb):!0}function Cc(Oa,db){return Wb.modes[Oa]=
db}function Ba(Oa){if("string"==typeof Oa&&Wb.mimeModes.hasOwnProperty(Oa))Oa=Wb.mimeModes[Oa];else if(Oa&&"string"==typeof Oa.name&&Wb.mimeModes.hasOwnProperty(Oa.name)){var db=Wb.mimeModes[Oa.name];"string"==typeof db&&(db={name:db});Oa=Object.assign({},db,Oa);Oa.name=db.name}else{if("string"==typeof Oa&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Oa))return Ba("application/xml");if("string"==typeof Oa&&/^[\w\-]+\/[\w\-]+\+json$/.test(Oa))return Ba("application/json")}return"string"==typeof Oa?{name:Oa}:Oa||
{name:"null"}}function Ca(Oa,db){db=Wb.resolveMode(db);"string"===typeof db&&(db={name:db});if(!db.name)throw Error("parserConfig does not have a name of the mode to get");var Fb=Wb.modes[db.name];if(!Fb)return Ca(Oa,"text/plain");Oa=Object.assign({indentUnit:2},Oa);return Object.assign(Fb(Oa,db),{name:db.name})}function Nb(Oa,db){for(var Fb;Oa.innerMode;){Fb=Oa.innerMode(db);if(!Fb||Fb.mode==Oa)break;db=Fb.state;Oa=Fb.mode}return Fb||{mode:Oa,state:db}}function Ec(Oa,db){Wb.mimeModes[Oa]=db}function fb(Oa,
db,Fb){}function td(Oa,db,Fb,ea,Ma,lb,xb){var yc=Oa.editorPlugin._tokenizerValidBefore;yc&&yc.row>=Fb&&(yc.row=Fb-1);var Yb=Wb.linesToTokenize(Oa.document,Fb,ea,yc);yc=Yb.lines;Yb=Yb.state;if(!yc.length)return!1;Yb=Yb?Wb.copyState(db,Yb):Wb.startState(db);for(var ad=0;ad<yc.length;ad++){var od=yc[ad],ed=od.row;ed>=Fb&&ed<=ea&&Wb.indentLine(Oa,db,od,Yb,Ma,lb,xb);Yb=Wb.tokenizeLine(db,yc[ad],Yb,function(){})}return!0}function Xd(Oa,db,Fb,ea,Ma,lb,xb){db=Wb.linesToTokenize(db,Fb,ea,Ma);Fb=db.lines;Wb.tokenizeLines(Oa,
Fb,db.state,lb,xb);return Fb}function ae(Oa,db,Fb,ea,Ma){var lb=[],xb,yc=function(od){return lb.push(xb=[])},Yb=function(od,ed,mf,qg,Yf,Mh,Ui){return xb.push(mf,qg,od,Yf.current(),ed.localMode||Ui)};try{var ad=Wb.visitDocumentTokens(Oa,db,Fb,ea,Ma,yc,Yb)}catch(od){lb.length=0,ad=Wb.visitDocumentTokens(Oa,db,Fb,ea,null,yc,Yb)}return{tokens:lb,lines:ad}}function Bf(Oa,db,Fb,ea,Ma){null==db&&(db=Oa.search(/[^\s\u00a0]/),-1==db&&(db=Oa.length));ea=ea||0;for(Ma=Ma||0;;){var lb=Oa.indexOf("\t",ea);if(0>
lb||lb>=db)return Ma+(db-ea);Ma+=lb-ea;Ma+=Fb-Ma%Fb;ea=lb+1}}function ie(Oa){Oa=Oa.toLowerCase();for(var db=0;db<Wb.modeInfo.length;db++){var Fb=Wb.modeInfo[db];if(Fb.mime==Oa)return Fb;if(Fb.mimes)for(var ea=0;ea<Fb.mimes.length;ea++)if(Fb.mimes[ea]==Oa)return Fb}if(/\+xml$/.test(Oa))return ie("application/xml");if(/\+json$/.test(Oa))return ie("application/json")}function Zf(Oa){for(var db=0;db<Wb.modeInfo.length;db++){var Fb=Wb.modeInfo[db];if(Fb.ext)for(var ea=0;ea<Fb.ext.length;ea++)if(Fb.ext[ea]==
Oa)return Fb}}function Hg(Oa){for(var db=0;db<Wb.modeInfo.length;db++){var Fb=Wb.modeInfo[db];if(Fb.file&&Fb.file.test(Oa))return Fb}db=Oa.lastIndexOf(".");if(Oa=-1<db&&Oa.substring(db+1,Oa.length))return Wb.findModeByExtension(Oa)}function Wc(Oa){Oa=Oa.toLowerCase();for(var db=0;db<Wb.modeInfo.length;db++){var Fb=Wb.modeInfo[db];if(Fb.name.toLowerCase()==Oa)return Fb;if(Fb.alias)for(var ea=0;ea<Fb.alias.length;ea++)if(Fb.alias[ea].toLowerCase()==Oa)return Fb}}function vc(Oa){if(!Oa)return String(Oa);
if(Array.isArray(Oa))return"["+Oa.map(vc).join(",")+"]";if("symbol"===typeof Oa)return pd.printSymbol(Oa);try{return String(Oa)}catch(db){return"Cannot print object: "+db}}function yf(Oa,db){return!pd.arr.every(db.map(function(Fb){return Oa[Fb]}),function(Fb){return pd.obj.equals(Fb,Oa&&Oa.valueOf())})}function tc(Oa){if(pd.obj.isPrimitive(Oa))var db=pd.string.print(Oa);else Array.isArray(Oa)?((db=3<Oa.length)&&(Oa=Oa.slice(0,3)),Oa=pd.string.print(Oa),db&&(Oa=Oa.slice(0,-1)+", ...]"),db=Oa):db=pd.string.print(Oa);
db=db.replace(/\n/g,"");500<db.length&&(db=db.slice(0,20)+("...["+(db.length-20)+' CHARS]"'));return db}function wb(Oa){return xc.Inspector.openInWindow({targetObject:Oa})}function uc(Oa,db){return xc.Inspector.openInWindow({remoteTarget:{code:Oa,evalEnvironment:db}})}function Q(Oa,db){function Fb(yc){var Yb=yc.name,ad=yc.ownerChain(),od=yc.owner,ed=yc.world(),mf;yc===lb&&(mf=[xb]);ed===yc&&(mf=["$world"]);if(!mf&&Yb&&od){od===ed&&1===xc.arr.count(xc.arr.pluck(ed.submorphs,"name"),Yb)&&(mf=['$world.get("'+
Yb+'")']);if(!mf&&od!=ed)for(ed=ad.length-1;ed--;)if(1===ad[ed].getAllNamed(Yb).length){mf=[].concat($jscomp.arrayFromIterable(Fb(ad[ed])),['get("'+Yb+'")']);break}mf||(Yb=[].concat($jscomp.arrayFromIterable(Fb(od)),['get("'+Yb+'")']),xc.syncEval(Yb.join("."),{context:lb}).value===yc&&(mf=Yb))}mf||(mf=[xb+'.getMorphById("'+yc.id+'")']);return mf}db=void 0===db?{}:db;var ea=Oa.world(),Ma=db;db=void 0===Ma.maxLength?10:Ma.maxLength;var lb=void 0===Ma.fromMorph?ea:Ma.fromMorph;if(lb===Oa)return"this";
var xb=ea===lb?"$world":"this";if(!(ea||Oa.name&&lb.get(Oa.name)===Oa))return"morph";ea=Fb(Oa);return ea.length>db?'$world.getMorphWithId("'+Oa.id+'")':ea.join(".")}function Da(Oa,db,Fb){var ea=(db=void 0===db?"":db)&&If.arr.last(db.split(".")).toLowerCase(),Ma="",lb=0,xb=Math.pow(2,19);if("string"===typeof Oa){if(Oa.length>xb)return null}else if(Oa.document.stringSize>xb)return null;if("string"===typeof Oa)Ma=Oa.slice(0,1E3);else for(Oa=$jscomp.makeIterator(Oa.document.lines),xb=Oa.next();!xb.done;xb=
Oa.next()){var yc=xb.value;xb=yc.stringSize;yc=yc.text;var Yb=!0;1E3<lb+xb&&(Yb=!1,xb=1E3-lb);Ma+=yc.slice(0,xb)+(Yb?"\n":"");lb+=xb;if(1E3<=lb)break}lb=$jscomp.makeIterator(If.modeInfo);for(Oa=lb.next();!Oa.done;Oa=lb.next()){Yb=Oa.value;xb=Yb.contentTest;Oa=Yb.mode;yc=Yb.ext;Yb=Yb.file;if("function"===typeof xb)try{if(xb(Ma))return Oa}catch(ad){}if(Yb&&Yb instanceof RegExp&&Yb.test(db))return Oa;if(yc)for(xb=$jscomp.makeIterator(yc),yc=xb.next();!yc.done;yc=xb.next())if(yc.value===ea)return Oa}return Fb}
Ha({a:Ec,d:Cc,r:fb});var ib=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");ib.Color=tb;var Kb=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Fb=db.hasOwnProperty("DefaultTheme")&&"function"===typeof db.DefaultTheme?db.DefaultTheme:db.DefaultTheme=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:"background",get:function(){return ib.Color.white}},
{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:ib.Color.white,fontWeight:"bold",backgroundColor:ib.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:ib.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:ib.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],db,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),pc=Kb=ib.DefaultTheme;ib.default=Kb;var Wb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");Wb.copyState=$a;Wb.startState=zb;Wb.defineMode=Cc;Wb.resolveMode=Ba;Wb.getMode=Ca;Wb.innerMode=Nb;Wb.defineMIME=Ec;Wb.registerHelper=fb;Wb.indentLines=td;Wb.indentLine=function(Oa,db,Fb,ea,Ma,lb,xb){xb=Object.assign({indentWithTabs:!Oa.useSoftTabs,indentUnit:Oa.tabWidth,tabSize:4,ignoreFollowingText:!1},
xb);null==Ma&&(Ma="add");"smart"==Ma&&(db.indent||(Ma="prev"));var yc=xb.tabSize,Yb=Fb.text,ad=Wb.countColumn(Yb,null,yc);Fb.modeState&&(Fb.modeState=null);var od=Yb.match(/^\s*/)[0];if(!lb&&!/\S/.test(Yb)){var ed=0;Ma="not"}else if("smart"==Ma&&(ed=db.indent(ea,xb.ignoreFollowingText?"":Yb.slice(od.length),Yb),ed==Wb.passIndent||150<ed)){if(!lb)return;Ma="prev"}"prev"==Ma?ed=0<Fb.row?Wb.countColumn(Fb.prevLine().text,null,yc):0:"add"==Ma?ed=ad+xb.indentUnit:"subtract"==Ma?ed=ad-xb.indentUnit:"number"==
typeof Ma&&(ed=ad+Ma);ed=Math.max(0,ed);db="";ea=0;if(xb.indentWithTabs)for(xb=Math.floor(ed/yc);xb;--xb)ea+=yc,db+="\t";ea<ed&&(db+=" ".repeat(ed-ea));if(db!=od)return Oa.replace({start:{row:Fb.row,column:0},end:{row:Fb.row,column:od.length}},db),!0};Wb.tokenizeLines=function(Oa,db,Fb,ea,Ma){if(db.length){Fb=Fb?Wb.copyState(Oa,Fb):Wb.startState(Oa);for(var lb=0;lb<db.length;lb++){var xb=db[lb];ea(xb);Fb=Wb.tokenizeLine(Oa,xb,Fb,Ma)}}};Wb.tokenizeLine=function(Oa,db,Fb,ea){var Ma=db.text;if(!Ma)return Fb;
var lb=new Wb.StringStream(Ma,2);Fb=db.modeState="function"===typeof Oa.copyState?Oa.copyState(Fb):Wb.copyState(Oa,Fb);db.prevLine();for(Fb._string=Ma;!lb.eol();)Ma=Oa.token(lb,Fb),ea(Ma,Fb,lb.start,lb.pos,lb,db,Oa),lb.start=lb.pos;return Fb};Wb.printTokens=function(Oa){for(var db="",Fb=0;Fb<Oa.length;Fb+=5)db+=Oa[Fb+0]+" => "+Oa[Fb+1]+" "+Oa[Fb+2]+" "+Oa[Fb+3]+" "+Oa[Fb+4].name+"\n";return db};Wb.visitDocumentTokens=Xd;Wb.tokenizeDocument=ae;Wb.linesToTokenize=function(Oa,db,Fb,ea){if(ea&&ea.row>=
Fb)return{lines:[],state:null};db=ea?Math.max(0,ea.row-1):db;var Ma=Oa.getLine(db),lb=Ma.text;Oa=[Ma];ea=null;for(var xb=0,yc;(yc=Ma.prevLine())&&50>xb++;){Ma=yc;if(Ma.modeState){ea=Ma.modeState;break}Oa.unshift(Ma)}if(!ea){for(var Yb=Ma,ad=Infinity;(yc=Ma.prevLine())&&100>xb++;){Ma=yc;if(Ma.modeState){ea=Ma.modeState;break}Oa.unshift(Ma);yc=lb.match(/^\s*/)[0].length;if(0===yc)break;yc<ad&&(ad=yc,Yb=Ma)}!ea&&0<ad&&(Oa=Oa.slice(Oa.indexOf(Yb)))}if(Fb>db)for(Ma=Wb.arr.last(Oa);db<=Fb;db++){Ma=Ma.nextLine();
if(!Ma)break;Oa.push(Ma)}return{lines:Oa,state:ea}};Wb.countColumn=Bf;Wb.findModeByMIME=ie;Wb.findModeByExtension=Zf;Wb.findModeByFileName=Hg;Wb.findModeByName=Wc;Wb.arr=kc;Kb=Wb.modes||{};Wb.modes=Kb;Wb.modes=Kb;Wb.modes=Kb;Kb=Ha("p",{});Wb.passIndent=Kb;Wb.passIndent=Kb;Wb.passIndent=Kb;Wb.copyState=$a;Wb.copyState=$a;Wb.startState=zb;Wb.startState=zb;Wb.defineMode=Cc;Wb.defineMode=Cc;Wb.resolveMode=Ba;Wb.resolveMode=Ba;Wb.getMode=Ca;Wb.getMode=Ca;Wb.innerMode=Nb;Wb.innerMode=Nb;Kb={};Wb.mimeModes=
Kb;Wb.mimeModes=Kb;Wb.mimeModes=Kb;Wb.defineMIME=Ec;Wb.defineMIME=Ec;Wb.registerHelper=fb;Wb.registerHelper=fb;Wb.indentLines=td;Wb.indentLines=td;Wb.visitDocumentTokens=Xd;Wb.visitDocumentTokens=Xd;Wb.tokenizeDocument=ae;Wb.tokenizeDocument=ae;Wb.countColumn=Bf;Wb.countColumn=Bf;(function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Fb=db.hasOwnProperty("StringStream")&&"function"===typeof db.StringStream?db.StringStream:db.StringStream=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:Symbol.for("lively-instance-initialize"),value:function(ea,Ma){this.reset(ea,Ma)}},{key:"reset",value:function(ea,Ma){this.pos=this.start=0;this.string=void 0===ea?"":ea;this.tabSize=void 0===Ma?2:Ma;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||
void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(ea){var Ma=this.string.charAt(this.pos);if("string"==typeof ea?Ma==ea:Ma&&(ea.test?ea.test(Ma):ea(Ma)))return++this.pos,Ma}},{key:"eatWhile",value:function(ea){for(var Ma=this.pos;this.eat(ea););return this.pos>Ma}},{key:"eatSpace",value:function(){for(var ea=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>ea}},{key:"skipToEnd",
value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(ea){ea=this.string.indexOf(ea,this.pos);if(-1<ea)return this.pos=ea,!0}},{key:"backUp",value:function(ea){this.pos-=ea}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=Wb.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?Wb.countColumn(this.string,this.lineStart,this.tabSize):
0)}},{key:"indentation",value:function(){return Wb.countColumn(this.string,null,this.tabSize)-(this.lineStart?Wb.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(ea,Ma,lb){if("string"==typeof ea){var xb=function(Yb){return lb?Yb.toLowerCase():Yb},yc=this.string.substr(this.pos,ea.length);if(xb(yc)==xb(ea))return!1!==Ma&&(this.pos+=ea.length),!0}else{if((ea=this.string.slice(this.pos).match(ea))&&0<ea.index)return null;ea&&!1!==Ma&&(this.pos+=ea[0].length);return ea}}},
{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(ea,Ma){this.lineStart+=ea;try{return Ma()}finally{this.lineStart-=ea}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],db,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:10431,end:12920})})(void 0);Kb=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",
ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",
mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",
mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Oa){return Oa.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",
file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",
ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",
mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",
mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",
ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},
{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},
{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},
{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",
mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},
{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",
ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",
mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Oa){return Oa.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",
mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",
mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",
mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn",
"ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",
mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",
ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];Wb.modeInfo=Kb;Wb.modeInfo=Kb;Wb.modeInfo=Kb;for(var rd=0;rd<Wb.modeInfo.length;rd++)Wb.info=
Wb.modeInfo[rd],Wb.info.mimes&&(Wb.info.mime=Wb.info.mimes[0]);Wb.defineMode("null",function(){return{token:function(Oa){return Oa.skipToEnd()}}});Wb.defineMIME("text/plain","null");Wb.findModeByMIME=ie;Wb.findModeByMIME=ie;Wb.findModeByExtension=Zf;Wb.findModeByExtension=Zf;Wb.findModeByFileName=Hg;Wb.findModeByFileName=Hg;Wb.findModeByName=Wc;Wb.findModeByName=Wc;var id=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");id.Color=tb;id.Rectangle=ac;id.pt=Ld;id.morph=Tc;id.ShadowObject=
$d;id.StyleSheet=Uc;id.connect=Pc;id.arr=kc;id.string=Jd;id.FilterableList=pe;id.Range=Ze;rd=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Fb=db.hasOwnProperty("Completer")&&"function"===typeof db.Completer?db.Completer:db.Completer=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"Completer"}}],db,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);id.Completer=rd;id.Completer=rd;id.Completer=rd;rd=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Fb=db.hasOwnProperty("WordCompleter")&&
"function"===typeof db.WordCompleter?db.WordCompleter:db.WordCompleter=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:"compute",value:function(ea,Ma){var lb=[],xb=[],yc=ea.document.lineStrings;ea=ea.cursorPosition.row;for(var Yb=ea-1;0<=Yb;Yb--)for(var ad=$jscomp.makeIterator(yc[Yb].split(/[^0-9a-z@_]+/i)),od=ad.next();!od.done;od=ad.next())(od=od.value)&&!lb.includes(od)&&od!==Ma&&(lb.push(od),
xb.push({priority:1E3-(ea-Yb),completion:od}));for(Yb=ea+1;Yb<yc.length;Yb++)for(ad=$jscomp.makeIterator(yc[Yb].split(/[^0-9a-z_@]+/i)),od=ad.next();!od.done;od=ad.next())(od=od.value)&&!lb.includes(od)&&od!==Ma&&(lb.push(od),xb.push({priority:1E3-(Yb-ea),completion:od}));return xb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],db,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);id.WordCompleter=rd;id.WordCompleter=rd;id.WordCompleter=rd;rd=[new id.WordCompleter];id.defaultCompleters=rd;id.defaultCompleters=rd;id.defaultCompleters=rd;rd=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Fb=db.hasOwnProperty("CompletionController")&&"function"===typeof db.CompletionController?db.CompletionController:db.CompletionController=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:Symbol.for("lively-instance-initialize"),value:function(ea,Ma){Ma=void 0===Ma?[]:Ma;this.textMorph=ea;this.completers=Ma=ea.pluginCollect("getCompleters",Ma)}},{key:"computeCompletions",value:function(ea){var Ma=this,lb,xb,yc,Yb,ad,od,ed,mf,qg,Yf,Mh,Ui,Fg,ph,Bg,cl;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rg){switch(Rg.nextAddress){case 1:lb=[],xb=$jscomp.makeIterator(Ma.completers),yc=xb.next();
case 2:if(yc.done){Rg.jumpTo(4);break}Yb=yc.value;Rg.setCatchFinallyBlocks(5);ad=lb;od=ad.concat;return Rg.yield(Yb.compute(Ma.textMorph,ea),7);case 7:lb=od.call(ad,Rg.yieldResult);Rg.leaveTryBlock(3);break;case 5:ed=Rg.enterCatchBlock(),console.warn("Error in completer "+Yb+": "+(ed.stack||ed));case 3:yc=xb.next();Rg.jumpTo(2);break;case 4:mf=new Map;lb.forEach(function(sk){var Qf=mf.get(sk.completion);Qf||(Qf=[],mf.set(sk.completion,Qf));Qf.push(sk)});qg=[];Yf=$jscomp.makeIterator(mf.values());
for(Mh=Yf.next();!Mh.done;Mh=Yf.next())Ui=Mh.value,qg.push(id.arr.last(id.arr.sortByKey(Ui,"priority")));Fg=0;ph=id.arr.sortByKey(qg,"priority").reverse();Bg=ph.length&&ph[0].priority||0;cl=ph.map(function(sk){sk.highestPriority=Bg;var Qf=sk.completion.replace(/\n/g,""),Dk=String((sk.info||"").replace(/\n/g,""));Fg=Math.max(Fg,Qf.length+Dk.length);return{isListItem:!0,string:Qf,annotation:Dk,value:sk}});return Rg.return({items:cl,maxCol:Fg})}})}},{key:"computeSortedCompletions",value:function(ea,
Ma){Ma=void 0===Ma?!1:Ma;var lb=this,xb,yc,Yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){if(1==ad.nextAddress)return xb={tokens:[ea],lowercasedTokens:[ea],input:ea},ad.yield(lb.computeCompletions(ea),2);yc=ad.yieldResult;Yb=id.arr.sortBy(yc.items.filter(function(od){return lb.filterFunction(xb,od,Ma)}),function(od){return lb.sortFunction(xb,od)});return ad.return(Yb)})}},{key:"_printCompletions",value:function(ea){var Ma=this,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==
xb.nextAddress)return xb.yield(Ma.computeSortedCompletions(ea),2);lb=xb.yieldResult.map(function(yc){return{completion:yc.value.completion,priority:yc.value.priority,maxP:yc.value.highestPriority,sortVal:yc._cache[ea].sortVal,lev:JSON.stringify(yc._cache[ea].levenshtein)}});return xb.return(id.string.printTable(lively.lang.grid.tableFromObjects(lb)))})}},{key:"prefix",value:function(){var ea=this.textMorph,Ma=ea.selection;return(Ma.isEmpty()?ea.getLine(Ma.lead.row).slice(0,Ma.lead.column):Ma.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(ea,Ma,lb){lb=void 0===lb?!1:lb;Ma._cache||(Ma._cache={});var xb=ea.tokens,yc=ea.lowercasedTokens,Yb=ea.input;Yb=Ma._cache[Yb]||(Ma._cache[Yb]={});if(Yb.hasOwnProperty("filtered"))return Yb.filtered;Ma=Ma.value.completion.replace(/\([^\)]*\)$/,"");var ad=Ma.toLowerCase();if(lb&&xb[0]&&!Ma.startsWith(xb[0]))return Yb.filtered=!1;if(yc.every(function(ed){return ad.includes(ed)}))return!0;var od=Yb.levenshtein||(Yb.levenshtein={});ea=lb||3>=id.arr.sum(ea.lowercasedTokens.map(function(ed){return od[ed]||
(od[ed]=id.string.levenshtein(ad,ed))}));return Yb.filtered=ea}},{key:"sortFunction",value:function(ea,Ma){Ma._cache||(Ma._cache={});var lb=Ma._cache[ea.input]||(Ma._cache[ea.input]={});if(lb.hasOwnProperty("sortVal"))return lb.sortVal;lb=Ma._cache[ea.input]={};var xb=Ma.value;Ma=xb.highestPriority;var yc=xb.completion;xb=xb.priority;yc=yc.replace(/\([^\)]*\)$/,"").toLowerCase();var Yb=0;ea.lowercasedTokens.forEach(function(od){yc.startsWith(od)?Yb+=12:3<=od.length&&yc.includes(od)&&(Yb+=5)});Ma=
-((xb||(Yb?Ma:0))/Math.pow(10,String(Ma).length-2))-Yb;var ad=lb.levenshtein||(lb.levenshtein={});ea=id.arr.sum(ea.lowercasedTokens.map(function(od){return ad[od]||(ad[od]=id.string.levenshtein(yc,od))}));Yb&&(ea/=2);return lb.sortVal=ea+Ma}},{key:"positionForMenu",value:function(){var ea=this.textMorph,Ma=ea.charBoundsFromTextPosition(ea.cursorPosition);return ea.getGlobalTransform().transformRectToRect(Ma).topLeft().addXY(-ea.scroll.x,-ea.scroll.y).addPt(id.pt(ea.borderWidth+4,ea.borderWidth+4))}},
{key:"completionListSpec",value:function(){var ea=this,Ma,lb,xb,yc,Yb,ad,od,ed,mf,qg,Yf,Mh,Ui,Fg,ph,Bg,cl,Rg,sk,Qf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Dk){if(1==Dk.nextAddress)return lb=Ma=ea.textMorph,xb=lb.fontSize,yc=lb.fontFamily,Yb=ea.positionForMenu(),ad=ea.prefix(),Dk.yield(ea.computeCompletions(ad),2);od=Dk.yieldResult;ed=od.items;mf=od.maxCol;qg=Ma.env.fontMetric.sizeFor(yc,xb,"M");Yf=qg.width*mf;Mh=Ma.document.getLine(0).height;Ui=Math.max(120,Yf<Ma.width?Yf:Ma.width);
Fg=Mh*ed.length+Mh+10;ph=Math.max(70,Math.min(700,Fg));Bg=Yb.extent(id.pt(Ui,ph));if(cl=Ma.world())Rg=cl.visibleBounds().insetBy(5),Bg.bottom()>Rg.bottom()&&(sk=Bg.bottom()-Rg.bottom(),sk>Bg.height-50&&(sk=Bg.height-50),Bg.height-=sk),Bg.right()>Rg.right()&&(Qf=Bg.right()-Rg.right(),Bg.width=120>Bg.width-Qf?120:Bg.width-Qf),Rg.containsRect(Bg)||(Bg=Bg.withTopLeft(Rg.translateForInclusion(Bg).topLeft())),Bg=Bg.translatedBy(Rg.insetBy(0).topLeft().negated());return Dk.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:xb,position:Bg.topLeft(),extent:Bg.extent(),items:ed,input:ad,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:ea.filterFunction,sortFunction:ea.sortFunction})})}},{key:"removeMenuOnBlur",value:function(ea){var Ma=ea.menu;setTimeout(function(){Ma.withAllSubmorphsDetect(function(lb){return lb.isFocused()})?Ma.inputMorph.focus():Ma.remove()})}},{key:"openCompletionList",value:function(){var ea=this,Ma,lb,xb,yc,Yb,ad,od,ed,
mf,qg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yf){if(1==Yf.nextAddress)return Ma=ea.textMorph.selection.start,Yf.yield(ea.completionListSpec(),2);if(3!=Yf.nextAddress)return lb=Yf.yieldResult,ea.textMorph.pluginFind(function(Mh){return Mh.theme}),xb=new id.FilterableList(lb),yc=new id.Range({start:Ma,end:ea.textMorph.selection.start}),Yb=ea.textMorph.textInRange(yc),ad=xb.inputMorph,od=xb.listMorph,ed=lb.input,mf=xb.addMorph({name:"prefix mask",fill:id.Color.transparent,bounds:ad.textBounds()},
ad),od.master=null,yc.isEmpty()||(ea.textMorph.deleteText(yc),ad.input=Yb,ad.gotoDocumentEnd()),ad.fontColor=ea.textMorph.fontColor,id.connect(ad,"textString",mf,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:ad}}),id.connect(xb,"accepted",ea,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:ed}}),id.connect(xb,"accepted",xb,"remove"),id.connect(xb,"canceled",xb,"remove"),id.connect(xb,"remove",ea.textMorph,"focus"),id.connect(xb.inputMorph,"onBlur",ea,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:xb}}),qg=ea.textMorph.world(),od.addStyleClass("hiddenScrollbar"),xb.paddingMorph.height=2,ad.height=od.itemHeight,ad.clipMode="visible",ad.fill=ea.textMorph.fill,ad.fixedHeight=!0,ad.fixedWidth=!1,ad.fontSize=od.fontSize,xb.relayout(),xb.selectedIndex=
0,xb.master.applyIfNeeded(!0),ad.focus(),Yf.yield(xb.master.whenApplied(),3);ed.length&&(ad.gotoDocumentEnd(),xb.moveBy(id.pt(-ad.textBounds().width,0)));qg.addMorph(xb);xb.inputPadding=id.Rectangle.inset(0,0,0,0);return Yf.return(xb)})}},{key:"autoInsertBestMatchingCompletion",value:function(ea,Ma,lb){Ma=void 0===Ma?!0:Ma;var xb=this,yc,Yb,ad,od;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ed){if(1==ed.nextAddress)return yc=$jscomp,Yb=yc.makeIterator,ed.yield(xb.computeSortedCompletions(ea,
Ma),2);ad=Yb.call(yc,ed.yieldResult);(od=ad.next().value)&&xb.insertCompletion(od.value.completion,ea,lb);ed.jumpToEnd()})}},{key:"insertCompletion",value:function(ea,Ma,lb){var xb=this.textMorph,yc=xb.document,Yb=xb.selection.isMultiSelection?xb.selection.selections:[xb.selection];xb.undoManager.group();Yb.forEach(function(ad){ad.collapseToEnd();var od=ad.lead,ed=Ma?yc.indexToPosition(yc.positionToIndex(od)-Ma.length):od;"function"===typeof lb?lb(ea,Ma,xb,{start:ed,end:od},ad):xb.replace({start:ed,
end:od},ea)});xb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],db,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);id.CompletionController=rd;id.CompletionController=rd;id.CompletionController=rd;
rd=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Oa,db,Fb){var ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){return 1==Ma.nextAddress?(ea=new id.CompletionController(Oa,id.defaultCompleters),Ma.yield(ea.openCompletionList(),2)):Ma.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Oa,db,Fb){var ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){return 1==Ma.nextAddress?
(ea=new id.CompletionController(Oa,id.defaultCompleters),Ma.yield(ea.autoInsertBestMatchingCompletion(ea.prefix()),2)):Ma.return(!0)})}}];id.completionCommands=rd;id.completionCommands=rd;id.completionCommands=rd;var oe=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");oe.chain=Ff;oe.arr=kc;oe.obj=te;oe.string=Jd;var Tf=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Oa){var db=Oa.selection.start;0<db.row&&(db=Oa.getPositionAboveOrBelow(1,
db,!0,0,Oa.charBoundsFromTextPosition(db).x),Oa.selection.addRange({start:db,end:db}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Oa){var db=Oa.selection.start;db.row<Oa.documentEndPosition.row&&(db=Oa.getPositionAboveOrBelow(-1,db,!0,0,Oa.charBoundsFromTextPosition(db).x),Oa.selection.addRange({start:db,end:db}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Oa){var db=Oa.selection.selections[Oa.selection.selections.length-
1];if(db.isEmpty())return!0;Oa.searchForAll(db.text,{start:{column:0,row:0}}).forEach(function(Fb){return Oa.selection.addRange(Fb.range,!1)});Oa.selection.mergeSelections();oe.arr.remove(Oa.selection.selections,db);Oa.selection.selections.push(db);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Oa){var db=Oa.selection.selections.length-1,Fb=Oa.selection.selections[db];if(Fb.isEmpty())return!0;var ea=Oa.search(Fb.text,{start:Fb.end,backwards:!1});
ea&&(Fb=Oa.selection.selections.findIndex(function(Ma){return Ma.range.equals(ea.range)}),-1<Fb?oe.arr.swap(Oa.selection.selections,Fb,db):Oa.selection.addRange(ea.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Oa){var db=Oa.selection.selections.length-1,Fb=Oa.selection.selections[db];if(Fb.isEmpty())return!0;var ea=Fb.start,Ma=Oa.search(Fb.text,{start:{row:ea.row,column:ea.column-(Fb.text.length-1)},backwards:!0});Ma&&(Fb=Oa.selection.selections.findIndex(function(lb){return lb.range.equals(Ma.range)}),
-1<Fb?oe.arr.swap(Oa.selection.selections,Fb,db):Oa.selection.addRange(Ma.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Oa){var db=Oa.selection.selections.length;1<db&&Oa.selection.removeSelections(db-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Oa){Oa.selection.selections=lively.lang.arr.rotate(Oa.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(Oa){Oa.selection.selections=lively.lang.arr.rotate(Oa.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Oa){var db=Oa.selection.selections;if(1>=db.length)return!0;var Fb=oe.arr.groupBy(db,function(Ma){return Ma.range.start.row});db=Fb.keys().map(function(Ma){Ma=Fb[Ma];var lb=oe.arr.max(Ma,function(xb){return xb.range.start.column});oe.arr.without(Ma,lb).forEach(function(xb){return xb.range=lb.range});
return lb});var ea=oe.arr.max(db,function(Ma){return Ma.range.start.column}).range.start.column;db.forEach(function(Ma){var lb=Ma.range.start;Ma=lb.row;lb=lb.column;Oa.insertText(" ".repeat(ea-lb),{row:Ma,column:lb})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Oa){Oa.selection.disableMultiSelect();if(Oa.selection.isEmpty())var db=Oa.lastSavedMark&&Oa.lastSavedMark.position||(void 0).lineRange().start,Fb=Oa.cursorPosition;else db=Oa.selection,
Fb=db.lead,db=db.anchor;Oa.selection.collapse();var ea=db.column,Ma=Fb.column;oe.arr.range(db.row,Fb.row).forEach(function(lb){return Oa.getLine(lb).length>Math.min(Ma,ea)&&Oa.selection.addRange({end:{row:lb,column:Ma},start:{row:lb,column:ea}},!1)});Oa.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Oa,db,Fb){Fb=void 0===Fb?1:Fb;Oa.undoManager.group();Oa.selection.selections.forEach(function(ea,Ma){return ea.text=String(Ma+
Fb)});Oa.undoManager.group();return!0}}];oe.multiSelectCommands=Tf;oe.multiSelectCommands=Tf;oe.multiSelectCommands=Tf;var Ce=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");Ce.pToI=function(Oa,db){return Oa.positionToIndex(db)};Ce.iToP=function(Oa,db){return Oa.indexToPosition(db)};Ce.execCodeNavigator=function(Oa){return function(db,Fb,ea){var Ma=db.pluginInvokeFirst("getNavigator");if(!Ma)return!0;db.saveMark();ea=ea||1;for(var lb=0;lb<ea;lb++)Ma[Oa](db,Fb);return!0}};
Ce.once=Bc;var $e=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Ce.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:Ce.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Ce.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Ce.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Ce.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Oa,db){function Fb(){var lb=Oa.$expandRegionState,xb=Ce.pToI(Oa,Oa.cursorPosition);if(lb&&(lb.range[0]===xb||lb.range[1]===xb))return lb;lb=Oa.selection.range;return Oa.$expandRegionState={range:[Ce.pToI(Oa,lb.start),
Ce.pToI(Oa,lb.end)]}}db=db||{};var ea=Oa.pluginInvokeFirst("getNavigator");if(!ea)return!0;var Ma=db.start;db=db.end;if("number"===typeof Ma&&"number"===typeof db)Fb(),ea={range:[Ma,db],prev:Fb()};else{Ma=ea.ensureAST(Oa);if(!Ma)return;ea=ea.expandRegion(Oa,Oa.textString,Ma,Fb())}ea&&ea.range&&(Oa.selection={start:Ce.iToP(Oa,ea.range[0]),end:Ce.iToP(Oa,ea.range[1])},Oa.$expandRegionState=ea);Ce.once(Oa,"selectionChange",function(){return Oa.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Oa){if(Oa.selection.isEmpty())return!0;var db=Oa.pluginInvokeFirst("getNavigator");if(!db)return!0;var Fb=db.ensureAST(Oa);if(!Fb)return!0;var ea=Oa.$expandRegionState;if(!ea)return!0;(db=db.contractRegion(Oa,Oa.textString,Fb,ea))&&db.range&&(Oa.selection={start:Ce.iToP(Oa,db.range[0]),end:Ce.iToP(Oa,db.range[1])},Oa.$expandRegionState=db);Ce.once(Oa,"selectionChange",
function(){return Oa.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Ce.commands=$e;Ce.commands=$e;Ce.commands=$e;var af=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");af.arr=kc;af.chain=Ff;af.string=Jd;var of=[{name:"toggle comment",exec:function(Oa){var db=Oa.pluginInvokeFirst("getComment");if(!db)return!0;if(!db.lineCommentStart)return db.blockCommentStart?Oa.execCommand("toggle block comment"):!0;var Fb=db.lineCommentStart,ea=
new RegExp("^(\\s*)("+Fb+"\\s?)(.*)");db=Oa.document;var Ma=Oa.selection;Ma.isEmpty()||0!==Ma.end.column||Ma.growRight(-1);var lb=Ma.start.row;db=db.lineStrings.slice(Ma.start.row,Ma.end.row+1);db=db.some(function(Yb){return!!Yb.trim()})?af.arr.dropWhile(db,function(Yb){return Yb.trim()?!1:++lb&&!0}):db;var xb=db.every(function(Yb){return Yb.trim()&&Yb.match(ea)});Oa.undoManager.group();if(xb)db.forEach(function(Yb,ad){if(Yb=Yb.match(ea)){Yb=$jscomp.makeIterator(Yb);Yb.next();var od=Yb.next().value,
ed=Yb.next().value;Yb.next();Oa.deleteText({start:{row:lb+ad,column:od.length},end:{row:lb+ad,column:od.length+ed.length}})}});else{var yc=db.reduce(function(Yb,ad,od){return ad.trim()||Ma.isEmpty()&&Ma.start.row===Ma.end.row?Math.min(Yb,ad.match(/^\s*/)[0].length):Yb},Infinity);yc=Infinity===yc?0:yc;db.forEach(function(Yb,ad){Yb=$jscomp.makeIterator(Yb.match(/^(\s*)(.*)/));Yb.next();Yb.next();Yb.next();Oa.insertText(Fb+" ",{row:lb+ad,column:yc})})}Oa.undoManager.group();return!0}},{name:"toggle block comment",
exec:function(Oa){var db=Oa.pluginInvokeFirst("getComment");if(!db)return!0;if(!db.blockCommentStart)return db.lineCommentStart?Oa.execCommand("toggle comment"):!0;if(!db||!db.blockCommentStart)return!0;var Fb=db.blockCommentStart;db=db.blockCommentEnd;var ea=new RegExp("^"+Fb.replace(/\*/g,"\\*")),Ma=new RegExp(db.replace(/\*/g,"\\*")+"$"),lb=Oa.tokenAt(Oa.cursorPosition);if(lb&&"comment"===lb.token){var xb=Oa.textInRange(lb);if(xb.match(ea)&&xb.match(Ma))return Oa.undoManager.group(),Oa.replace(lb,
xb.slice(Fb.length,-db.length)),Oa.undoManager.group(),!0}Oa.undoManager.group();Oa.insertText(Fb,Oa.selection.start);Oa.insertText(db,Oa.selection.end);Oa.undoManager.group();Fb=!Oa.selection.isEmpty();Oa.selection.growLeft(db.length);Fb||Oa.selection.collapse();return!0}},{name:"comment box",exec:function(Oa,db,Fb){db=Oa.undoManager.ensureNewGroup(Oa,"comment box");if(Oa.selection.isEmpty())return Oa.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Oa.execCommand("toggle comment"),
Oa.undoManager.group(db),!0;var ea=Oa.selection.range,Ma=Oa.withSelectedLinesDo(function(xb){return xb}),lb=af.arr.min([ea.start.column].concat(af.chain(Ma).map(function(xb){return xb.match(/^\s*/)}).flatten().compact().pluck("length").value()));Ma=af.arr.max(Ma.map(function(xb){return xb.length}))-lb;Ma=Array(Math.ceil(Ma/2)+1).join("-=")+"-";Oa.execCommand("toggle comment");Oa.collapseSelection();Oa.cursorPosition={row:ea.start.row,column:0};Fb?Oa.insertText(af.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",lb)):Oa.insertText(af.string.indent(Ma+"\n"," ",lb));Oa.selection.goUp();Oa.execCommand("toggle comment");Oa.cursorPosition={row:ea.end.row+2,column:0};Oa.insertText(af.string.indent(Ma+"\n"," ",lb));Oa.selection.goUp();Oa.execCommand("toggle comment");Oa.selection.range={start:{row:ea.start.row,column:0},end:Oa.cursorPosition};Oa.undoManager.group(db);return!0},multiSelectAction:"forEach",handlesCount:!0}];af.commands=of;af.commands=of;af.commands=of;var pd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
pd.printSymbol=function(Oa){if(Symbol.keyFor(Oa))return'Symbol.for("'+Symbol.keyFor(Oa)+'")';if(pd.knownSymbols.get(Oa))return pd.knownSymbols.get(Oa);String(Oa).match(pd.symMatcher);return String(Oa)};pd.defaultSort=function(Oa,db){if(Oa.hasOwnProperty("priority")||db.hasOwnProperty("priority")){var Fb=Oa.priority||0,ea=db.priority||0;if(Fb<ea)return-1;if(Fb>ea)return 1}Oa=(Oa.keyString||Oa.key).toLowerCase();db=(db.keyString||db.key).toLowerCase();return Oa<db?-1:Oa===db?0:1};pd.safeToString=vc;
pd.propertyNamesOf=function(Oa,db){if(!Oa)return[];if(Array.isArray(Oa)){var Fb=db?db.offset:0;return pd.arr.range(Fb,Fb+(db?db.partitionSize:Oa.length-1))}return pd.arr.sortBy(Object.keys(Oa),function(ea){return ea.toLowerCase()})};pd.isMultiValue=yf;pd.printValue=tc;pd.partitionedChildren=function(Oa,db){var Fb=void 0===db?{}:db;db=void 0===Fb.originalValue?Oa:Fb.originalValue;var ea=void 0===Fb.offset?0:Fb.offset;Fb=void 0===Fb.partitionSize?Oa.length||Object.values(Oa).length:Fb.partitionSize;
if(pd.obj.isArray(Oa)){Oa=pd.num.roundTo(Math.max(pd.MIN_PARTITION_SIZE,Fb/50),.1);Fb/=Oa;for(var Ma=[],lb=0;lb<Fb;lb++){var xb="["+(ea+lb*Oa)+"-"+(ea+(lb+1)*Oa)+"]";Ma.push({partition:{originalValue:db,offset:ea+lb*Oa,partitionSize:Oa},value:[],key:xb,keyString:xb,valueString:"...",isCollapsed:!0})}return Ma}Oa=pd.num.roundTo(Math.max(pd.MIN_PARTITION_SIZE,Fb/50),.1);Fb/=Oa;Ma=[];lb=pd.obj.keys(db).sort();for(xb=0;xb<Fb;xb++){var yc=ea+xb*Oa,Yb=ea+(xb+1)*Oa,ad=pd.obj.select(db,lb.slice(yc,Yb));yc=
"["+lb[yc].slice(0,4)+"-"+(lb[Yb]||pd.arr.last(lb)).slice(0,4)+"]";Ma.push({partition:{originalValue:ad,offset:ea+xb*Oa,partitionSize:Oa},value:[],key:yc,keyString:yc,valueString:"...",isCollapsed:!0})}return Ma};pd.propertiesOf=function(Oa){var db=Oa.partition?Oa.target:Oa.value;if(!db)return[];var Fb={_rev:!0},ea=[],Ma="function"===typeof db.livelyCustomInspect?db.livelyCustomInspect():{},lb=Object.assign({},pd.defaultPropertyOptions,{},Ma);if(Ma.properties){Ma=$jscomp.makeIterator(Ma.properties);
for(var xb=Ma.next();!xb.done;xb=Ma.next()){var yc=xb.value;xb=yc.key;var Yb=yc.hidden,ad=yc.priority,od=yc.keyString,ed=yc.value;yc=yc.valueString;Fb[xb]=!0;Yb||ea.push(Oa.getSubNode({priority:ad,key:xb,keyString:od||pd.safeToString(xb),value:ed,valueString:yc,isCollapsed:!0}))}}if(lb.includeDefault){Ma=pd.propertyNamesOf(db,Oa.partition);if(Ma.length>pd.MAX_NODE_THRESHOLD)for(Fb=$jscomp.makeIterator(pd.partitionedChildren(db,Oa.partition)),Ma=Fb.next();!Ma.done;Ma=Fb.next())ea.push(Oa.getSubNode(Ma.value));
else for(Yb=$jscomp.makeIterator(Ma),Ma=Yb.next();!Ma.done;Ma=Yb.next())ad=Ma.value,ad in Fb||(Ma=db[ad],xb=pd.printValue(Ma),Ma={keyString:ad,key:ad,value:Ma,valueString:xb,isCollapsed:!0},ea.push(Oa.getSubNode(Ma)));if(lb.includeSymbols)for(Fb=$jscomp.makeIterator(Object.getOwnPropertySymbols(db)),Ma=Fb.next();!Ma.done;Ma=Fb.next())Yb=Ma.value,ad=pd.safeToString(Yb),Ma=db[Yb],xb=pd.printValue(Ma),Ma={key:Yb,keyString:ad,value:Ma,valueString:xb,isCollapsed:!0},ea.push(Oa.getSubNode(Ma))}lb.sort&&
(ea=lb.sortFunction(db,ea));return ea};pd.obj=te;pd.num=sd;pd.arr=kc;pd.string=Jd;pd.connect=Pc;pd.signal=le;pd.TreeData=jc;pd.newUUID=je;pd.localInterface=Fa;pd.MAX_NODE_THRESHOLD=1E3;pd.MIN_PARTITION_SIZE=250;pd.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Oa,db){return Array.isArray(Oa)?db:db.sort(pd.defaultSort)}};pd.symMatcher=/^Symbol\((.*)\)$/;pd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Oa){return"symbol"===
typeof Symbol[Oa]}).reduce(function(Oa,db){return Oa.set(Symbol[db],"Symbol."+db)},new Map)}();pd.isMultiValue=yf;pd.isMultiValue=yf;pd.printValue=tc;pd.printValue=tc;var gg=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Fb=db.hasOwnProperty("InspectionTree")&&"function"===typeof db.InspectionTree?db.InspectionTree:db.InspectionTree=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Ab(Fb,Oa,[{key:Symbol.for("lively-instance-initialize"),value:function(ea){Ab._get(Object.getPrototypeOf(Fb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ea);this.inspector=ea.inspector;this.root.isInspectionNode||(this.root=pd.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(ea){ea=void 0===ea?!0:ea;return Ab._get(Object.getPrototypeOf(Fb.prototype),"asListWithIndexAndDepth",
this).call(this,function(Ma){Ma=Ma.node;return ea?Ma.visible:!0})}},{key:"getContextFor",value:function(ea){return ea==this.root?this.root.value.inspectee:ea.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(ea){var Ma=void 0===ea.maxDepth?1:ea.maxDepth,lb=ea.iterator,xb=ea.showUnknown,yc=ea.showInternal,Yb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){if(1==ad.nextAddress)return ad.yield(Yb.uncollapseAll(function(od,ed){return Ma>ed&&(od==Yb.root||od.value.submorphs)}),
2);Yb.asListWithIndexAndDepth(!1).forEach(function(od){var ed=od.node;return 0==od.depth?ed.visible=!0:!xb&&ed.keyString&&ed.keyString.includes("UNKNOWN PROPERTY")||!yc&&ed.keyString&&ed.keyString.includes("internal")?ed.visible=!1:ed.value&&ed.value.submorphs?ed.visible=!0:ed.visible=lb(ed)});ad.jumpToEnd()})}},{key:"getChildren",value:function(ea){return ea.children}},{key:"display",value:function(ea){return ea.display(this.inspector)}},{key:"isCollapsed",value:function(ea){return ea.isCollapsed}},
{key:"isLeaf",value:function(ea){return pd.obj.isPrimitive(ea.value)}},{key:"collapse",value:function(ea,Ma){var lb=this;ea.isCollapsed=Ma;Ma||this.isLeaf(ea)||ea.children.length||(ea.children=pd.propertiesOf(ea).map(function(xb){lb.parentMap.set(xb,ea);return xb}))}},{key:"retrieveForRemoteProxy",value:function(ea){ea.uuid||(ea.uuid=pd.newUUID(),this.idToNodeMap[ea.uuid]=ea);return{uuid:ea.uuid,value:this.isLeaf(ea)?ea.value:{},keyString:ea.keyString,key:ea.keyString,valueString:pd.safeToString(ea.value),
isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return pd.localInterface}},{key:"getNodeViaId",value:function(ea){return this.idToNodeMap[ea]}},{key:"asRemoteDelegate",value:function(ea){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[ea]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(ea,Ma){return new this({key:"inspectee",value:{inspectee:ea},isCollapsed:!0,inspector:Ma})}}],db,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(pd.TreeData);pd.InspectionTree=gg;pd.InspectionTree=
gg;pd.InspectionTree=gg;var Sf=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Fb=db.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof db.RemoteInspectionTree?db.RemoteInspectionTree:db.RemoteInspectionTree=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(ea){this.parentMap=new WeakMap;this.root=ea.proxy;this.evalEnvironment=ea.evalEnvironment;this.inspector=ea.inspector;this.delegateId=ea.delegateId}},{key:"getContextFor",value:function(ea){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+ea.uuid+'").value'}},{key:"dispose",value:function(){var ea=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){return Ma.yield(ea.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
ea.delegateId+"']\n    ",ea.evalEnvironment),0)})}},{key:"display",value:function(ea){return ea.keyString+": "+ea.valueString}},{key:"collapse",value:function(ea,Ma){var lb=this,xb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){if(1==yc.nextAddress)return(ea.isCollapsed=Ma)||lb.isLeaf(ea)?yc.return():ea.children.length?yc.jumpTo(0):yc.yield(lb.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+ea.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+lb.delegateId+'"]'}),3);xb=yc.yieldResult;ea.children=xb.isError?[]:xb.value;yc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(ea,Ma){var lb=this,xb,yc,Yb,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(od){if(1==od.nextAddress)return od.yield(lb.createRemoteContext(ea,Ma),2);xb=od.yieldResult;
yc=xb.proxy;Yb=xb.delegateId;ad=xb.evalEnvironment;return od.return(new lb({key:"inspectee",proxy:yc,delegateId:Yb,evalEnvironment:ad,inspector:Ma}))})}},{key:"createRemoteContext",value:function(ea,Ma){var lb=ea.code,xb=ea.evalEnvironment,yc=ea.delegateId,Yb,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(od){if(1==od.nextAddress)return yc="lively://inspector-"+Ma.id,od.yield(xb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
lb+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+yc+'");\n    ',xb),2);Yb=od.yieldResult;ad=Yb.value;return od.return({delegateId:yc,evalEnvironment:xb,proxy:ad})})}}],db,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(pd.InspectionTree);
pd.RemoteInspectionTree=Sf;pd.RemoteInspectionTree=Sf;pd.RemoteInspectionTree=Sf;(function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Fb=db.hasOwnProperty("InspectionNode")&&"function"===typeof db.InspectionNode?db.InspectionNode:db.InspectionNode=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:Symbol.for("lively-instance-initialize"),value:function(ea){var Ma=
ea.root,lb=ea.priority,xb=ea.key,yc=ea.keyString,Yb=ea.value,ad=ea.valueString,od=ea.isCollapsed,ed=void 0===ea.children?[]:ea.children,mf=void 0===ea.isSelected?!1:ea.isSelected,qg=void 0===ea.visible?!0:ea.visible;this.partition=ea.partition;this.priority=lb;this.key=xb;this.keyString=String(yc||xb);this.value=Yb;this.valueString=ad||pd.printValue(Yb);this.isCollapsed=od;this.children=ed;this.isSelected=mf;this.visible=qg;this.root=Ma}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(ea){if(ea.value&&ea.value.isMorph)return new pd.MorphNode(Object.assign({root:this.root},ea));var Ma=ea.key,lb=ea.keyString,xb=this.value,yc=ea.partition;yc&&(xb=yc.originalValue,lb=Ma);return new pd.PropertyNode(Object.assign({},ea,{keyString:lb,key:Ma,target:xb,partition:yc,root:this.root,spec:{}}))}},{key:"display",value:function(ea){var Ma=this.keyString,lb=this.valueString;if(!this.interactive)return Ma+": "+lb;this._propertyWidget||
(this._propertyWidget=ea.renderDraggableTreeLabel({value:Ma+": "+lb}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(ea,Ma){Ma=void 0===Ma?null:Ma;return ea.value&&ea.value.isMorph?new pd.MorphNode(Object.assign({root:Ma},ea)):new pd.InspectionNode(Object.assign({root:Ma},ea))}}],db,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Fb=db.hasOwnProperty("MorphNode")&&"function"===typeof db.MorphNode?db.MorphNode:db.MorphNode=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,
[{key:Symbol.for("lively-instance-initialize"),value:function(ea){Ab._get(Object.getPrototypeOf(Fb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ea);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(ea){var Ma=this.propertyInfo[ea.key]||{};return ea.value&&ea.value.isMorph?new pd.MorphNode(Object.assign({},ea,{root:this.root})):new pd.PropertyNode(Object.assign({},ea,{root:this.root,target:this.target,
spec:Ma}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],db,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(pd.InspectionNode);(function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Fb=db.hasOwnProperty("PropertyNode")&&
"function"===typeof db.PropertyNode?db.PropertyNode:db.PropertyNode=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:Symbol.for("lively-instance-initialize"),value:function(ea){Ab._get(Object.getPrototypeOf(Fb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ea);var Ma=ea.spec,lb=ea.target;this.partition=ea.partition;this.target=lb;this.spec=Ma;this.foldedNodes={}}},{key:"__deserialize__",
value:function(ea,Ma){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(ea){this._interactive=ea}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(ea){return this.isFoldable?this.getFoldedContext(ea):Ab._get(Object.getPrototypeOf(Fb.prototype),"getSubNode",this).call(this,ea)}},{key:"getFoldedContext",
value:function(ea){return this.foldedNodes[ea.key]=new pd.FoldedNode(Object.assign({},ea,{root:this.root,target:this.target,foldableNode:this,spec:pd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(ea,Ma){(Ma=void 0===Ma?!1:Ma)&&(this.target[this.key]=ea);this.value=this.target[this.key];this.valueString=pd.printValue(this.value);this.interactive&&(Ma||this._propertyWidget.highlight());if(this.isFoldable)for(var lb in this.foldedNodes)this.foldedNodes[lb].value=
this.value[lb],this.foldedNodes[lb].valueString=pd.printValue(this.value[lb]),this.foldedNodes[lb]._propertyWidget&&pd.signal(this.foldedNodes[lb]._propertyWidget,"update",this.value[lb])}},{key:"display",value:function(ea){var Ma=this,lb=this._propertyWidget,xb=this.keyString,yc=this.valueString,Yb=this.target,ad=this.value,od=this.spec;if(!(this.interactive||od.foldable&&pd.isMultiValue(ad,od.foldable)))return ea.renderPropertyControl({target:Yb,keyString:xb,valueString:yc,tree:ea.ui.propertyTree,
value:ad,spec:od,node:this,fastRender:!0});if(lb)return lb.keyString=xb,lb.valueString=yc,lb.isSelected=this.isSelected,lb.control&&(lb.control.isSelected=this.isSelected),lb;lb=this._propertyWidget=ea.renderPropertyControl({target:Yb,keyString:xb,valueString:yc,value:ad,spec:od,node:this,isSelected:this.isSelected,fontColor:ea.ui.propertyTree.fontColor});this.isInternalProperty||od.readOnly||(pd.connect(lb,"propertyValue",this,"refreshProperty",{updater:function(ed,mf){return ed(mf,!0)}}),pd.connect(lb,
"openWidget",this.root,"onWidgetOpened",{converter:function(ed){return{widget:ed,node:Ma.sourceObj}}}));return lb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],db,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(pd.InspectionNode);
(function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Fb=db.hasOwnProperty("FoldedNode")&&"function"===typeof db.FoldedNode?db.FoldedNode:db.FoldedNode=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:Symbol.for("lively-instance-initialize"),value:function(ea){Ab._get(Object.getPrototypeOf(Fb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
ea);this.foldableNode=ea=ea.foldableNode;this.foldedProp=ea.key+pd.string.capitalize(this.key)}},{key:"refreshProperty",value:function(ea,Ma){Ma=void 0===Ma?!1:Ma;var lb={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(lb[this.key]=ea,lb)),Ma)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],db,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(pd.PropertyNode);var Nf=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Nf.Color=tb;var Ag=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Fb=db.hasOwnProperty("DarkTheme")&&"function"===typeof db.DarkTheme?db.DarkTheme:db.DarkTheme=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Ab(Fb,Oa,[{key:"background",get:function(){return Nf.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Nf.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Nf.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Nf.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Nf.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Nf.Color.white,fontWeight:"bold",backgroundColor:Nf.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Nf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Nf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],db,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),Ig=Ag=Nf.DarkTheme;Nf.default=Ag;var xc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");xc.inspect=wb;xc.remoteInspect=uc;xc.generateReferenceExpression=Q;xc.onNumberDragStart=
function(Oa,db){db.initPos=Oa.position;db.factorLabel=(new xc.Tooltip({description:"1x"})).openInWorld(Oa.hand.position.addXY(10,10))};xc.onNumberDrag=function(Oa,db){var Fb=xc.getScaleAndOffset(Oa,db),ea=Fb.scale;Fb=Fb.offset;db.factorLabel.position=Oa.hand.position.addXY(10,10);db.factorLabel.description=ea+"x";return xc.getCurrentValue(Fb,ea,db)};xc.onNumberDragEnd=function(Oa,db){var Fb=xc.getScaleAndOffset(Oa,db);Oa=Fb.offset;Fb=Fb.scale;db.factorLabel.softRemove();return xc.getCurrentValue(Oa,
Fb,db)};xc.getScaleAndOffset=function(Oa,db){var Fb=Oa.position.subPt(db.initPos);Oa=Fb.x;db=xc.num.roundTo(Math.exp(-Fb.y/$world.height*6),.01)*db.baseFactor;return{offset:Oa,scale:db}};xc.getCurrentValue=function(Oa,db,Fb){return Math.max(Fb.min,Math.min(Fb.max,Fb.scrubbedValue+(Fb.floatingPoint?Oa*db:Math.round(Oa*db))))};xc.Color=tb;xc.Rectangle=ac;xc.rect=Ae;xc.pt=Ld;xc.obj=te;xc.num=sd;xc.Path=Dc;xc.arr=kc;xc.promise=Mc;xc.connect=Pc;xc.disconnect=bc;xc.once=Bc;xc.Morph=Gc;xc.Tooltip=Zc;xc.VerticalLayout=
Rd;xc.GridLayout=Kd;xc.HorizontalLayout=rb;xc.morph=Tc;xc.CustomLayout=ob;xc.Label=Bb;xc.Icon=Va;xc.StyleSheet=Uc;xc.config=Ta;xc.Tree=xa;xc.LoadingIndicator=wa;xc.DropDownList=Qa;xc.DropDownSelector=Eb;xc.SearchField=rc;xc.LabeledCheckBox=qb;xc.MorphHighlighter=ha;xc.InteractiveMorphSelector=Pa;xc.printValue=tc;xc.RemoteInspectionTree=Sf;xc.InspectionTree=gg;xc.isMultiValue=yf;xc.valueWidgets=T;xc.popovers=ia;xc.DarkTheme=Ig;xc.DefaultTheme=pc;xc.syncEval=sb;xc.inspectorCommands=[{name:"focus codeEditor",
exec:function(Oa){Oa.get("codeEditor").show();Oa.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Oa){Oa.get("propertyTree").show();Oa.get("propertyTree").focus();return!0}}];(function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Fb=db.hasOwnProperty("DraggedProp")&&"function"===typeof db.DraggedProp?db.DraggedProp:db.DraggedProp=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ab(Fb,Oa,[{key:"applyToTarget",value:function(ea){var Ma=this.currentTarget,lb=this.control;this.remove();xc.MorphHighlighter.removeHighlighters(ea.world);if(Ma)if(Ma.isText&&"js"===Ma.editorModeName){var xb=Ma.evalEnvironment.context;ea=Ma.textPositionFromPoint(Ma.localize(ea.position));xb=xc.generateReferenceExpression(this.sourceObject,{fromMorph:xb});lb.keyString&&(xb+="."+lb.keyString);Ma.insertTextAndSelect(xb,ea);Ma.focus()}else"propertyValue"in lb&&(Ma[lb.keyString]=lb.propertyValue)}},
{key:"update",value:function(ea){ea=ea.hand.globalPosition;var Ma=this.morphBeneath(ea);if(Ma){for(Ma==this.morphHighlighter&&(Ma=Ma.morphBeneath(ea));[Ma].concat($jscomp.arrayFromIterable(Ma.ownerChain())).find(function(lb){return!lb.visible});)Ma=Ma.morphBeneath(ea);if(Ma!=this.currentTarget){this.currentTarget=Ma;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Ma.isWorld)return;this.morphHighlighter=xc.MorphHighlighter.for($world,Ma);this.morphHighlighter.show()}this.position=ea}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:xc.Color.rgb(169,204,227)},fill:{defaultValue:xc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var ea=this.control;if(!ea)return this.submorphs=[];this.height=22;this.submorphs=[ea];ea.top=0;ea.fontSize=14;"function"===typeof ea.relayout&&
ea.relayout();this.width=ea.width+20;this.adjustOrigin(xc.pt(10,10))}}}}}],db,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3714})})(xc.Morph);(function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Fb=db.hasOwnProperty("DraggableTreeLabel")&&"function"===
typeof db.DraggableTreeLabel?db.DraggableTreeLabel:db.DraggableTreeLabel=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(ea){this.draggedProp=new xc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();xc.connect(ea.hand,"update",this.draggedProp,"update")}},
{key:"onDrag",value:function(ea){}},{key:"onDragEnd",value:function(ea){xc.disconnect(ea.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(ea)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:xc.config.codeEditor.defaultStyle.fontFamily},
fill:{defaultValue:xc.Color.transparent},padding:{defaultValue:xc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(ea){this.setProperty("isSelected",ea);ea?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=ea)}}}}}],db,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3716,end:5055})})(xc.Label);gg=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Fb=db.hasOwnProperty("PropertyControl")&&"function"===typeof db.PropertyControl?db.PropertyControl:db.PropertyControl=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(ea,Ma,lb){ea.control=new xc.DropDownSelector({opacity:.8,fill:xc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Ma,padding:0,values:lb});xc.connect(ea.control,"update",ea,"propertyValue",{updater:function(xb,yc){this.targetObj.propertyValue!=yc&&xb(yc)}});xc.connect(ea,"update",ea.control,"selectedValue",{updater:function(xb,yc){yc=yc&&yc.valueOf?yc.valueOf():yc;this.targetObj.propertyValue!=yc&&xb(yc)}});return ea}},
{key:"toggleMultiValuePlaceholder",value:function(ea){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:xc.Color.transparent,layout:new xc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:xc.arr.range(0,2).map(function(Ma){return{type:"ellipse",fill:xc.Color.gray.withA(.5),reactsToPointer:!1,extent:xc.pt(7,7)}})});ea?(xc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),
this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(xc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(ea){this.foldableProperties&&this.toggleMultiValuePlaceholder(xc.isMultiValue(ea,this.foldableProperties))}},{key:"asFoldable",value:function(ea){this.foldableProperties=ea;xc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();
this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var ea=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});
ea.isLayoutable=!1;ea.fontWeight="bold";ea.fontColor=xc.Color.orange;ea.reactsToPointer=!1;ea.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(ea){this.submorphs=[ea]}},layout:{initialize:function(){this.layout=new xc.CustomLayout({relayout:function(ea){ea.relayout()}})}},
submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(ea){return(ea=ea.value)&&(ea.isColor||ea.isGradient)?"Color":ea&&ea.isPoint?"Point":xc.obj.isBoolean(ea)?"Boolean":xc.obj.isNumber(ea)?"Number":xc.obj.isString(ea)?"String":ea&&ea.isRectangle?"Rectangle":!1}},{key:"render",value:function(ea){ea.spec.type||(ea.spec=Object.assign({},ea.spec,{isFloat:!Number.isInteger(ea.value),type:this.inferType(ea)}));switch(ea.spec.type){case "Color":var Ma=
this.renderColorControl(ea);break;case "ColorGradient":Ma=this.renderColorControl(Object.assign({},ea,{gradientEnabled:!0}));break;case "Number":Ma=this.renderNumberControl(ea);break;case "String":Ma=this.renderStringControl(ea);break;case "RichText":Ma=this.renderStringControl(ea);break;case "Layout":Ma=this.renderLayoutControl(ea);break;case "Enum":Ma=this.renderEnumControl(ea);break;case "Shadow":Ma=this.renderShadowControl(ea);break;case "Point":Ma=this.renderPointControl(ea);break;case "Rectangle":Ma=
this.renderRectangleControl(ea);break;case "Boolean":Ma=this.renderBooleanControl(ea);break;default:Ma=this.renderItSomehow(ea)}Ma.control&&(xc.connect(Ma.control,"openWidget",Ma,"openWidget"),Ma.toggleFoldableValue(ea.value));return Ma}},{key:"baseControl",value:function(ea){var Ma=ea.spec;ea=new this({keyString:ea.keyString,valueString:ea.valueString,isSelected:!1,propertyValue:ea.value});Ma.foldable&&ea.asFoldable(Ma.foldable);return ea}},{key:"renderGrabbableKey",value:function(ea){var Ma=this,
lb=ea.target;return[ea.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(xb){xb.state.draggedProp=new xc.DraggedProp({sourceObject:lb,control:Ma.baseControl(ea)});xb.state.draggedProp.openInWorld();xc.connect(xb.hand,"update",xb.state.draggedProp,"update")},onDrag:function(xb){},onDragEnd:function(xb){xc.disconnect(xb.hand,"update",xb.state.draggedProp,"update");xb.state.draggedProp.applyToTarget(xb)}}]}},{key:"renderEnumControl",value:function(ea){var Ma=ea.value,lb=ea.spec.values,
xb=ea.keyString,yc=ea.target,Yb=ea.node,ad=function(od,ed){return $jscomp.asyncExecutePromiseGeneratorProgram(function(mf){yc.world().openWorldMenu(od,lb.map(function(qg){return{string:qg.toString(),action:function(){yc[xb]=qg;Yb.rerender()}}}));mf.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ea)),[" "+(Ma?Ma.valueOf?Ma.valueOf():Ma:"Not set"),{nativeCursor:"pointer",onMouseDown:ad}],$jscomp.arrayFromIterable(xc.Icon.textAttribute("angle-down",{paddingTop:"4px",
paddingLeft:"4px",opacity:.7,onMouseDown:ad})))}},{key:"renderStringControl",value:function(ea){var Ma=ea.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ea)),[" "+(200<Ma.length?Ma.slice(0,20)+"...":Ma),{fontColor:xc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(ea){var Ma=ea.value,lb=ea.keyString,xb=ea.valueString,yc=ea.target,Yb=ea.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ea)),[" "+xb,{fontColor:xc.Color.black,
nativeCursor:"pointer",onMouseDown:function(ad){var od;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ed){if(1==ed.nextAddress)return od=new xc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:Ma}),od.relayout(),ed.yield(od.fadeIntoWorld(ad.positionIn(yc.world())),2);xc.connect(od,"rectangle",function(mf){yc[lb]=mf;Yb.rerender()});ed.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(ea){var Ma=ea.value,lb=ea.keyString,xb=ea.valueString,yc=ea.target,Yb=ea.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ea)),
[" "+xb,{nativeCursor:"pointer",fontColor:Ma?xc.Color.green:xc.Color.red,onMouseDown:function(ad){yc[lb]=!yc[lb];Yb.rerender()}}])}},{key:"renderNumberControl",value:function(ea){var Ma=ea.value,lb=ea.spec,xb=ea.keyString,yc=ea.valueString,Yb=ea.node,ad=ea.target,od=ea.tree,ed=void 0===Yb._numberControls?new Wh:Yb._numberControls,mf=$jscomp.makeIterator(ed.submorphs),qg=mf.next().value,Yf=mf.next().value;ed.fontColor=od.fontColor;var Mh=Yb._numberControls=ed;"max"in lb&&"min"in lb&&-Infinity!=lb.min&&
Infinity!=lb.max?(Mh.baseFactor=(lb.max-lb.min)/100,Mh.floatingPoint=lb.isFloat,Mh.max=lb.max,Mh.min=lb.min):(Mh.floatingPoint=lb.isFloat,Mh.baseFactor=.5,Mh.min=void 0!=lb.min?lb.min:-Infinity,Mh.max=void 0!=lb.max?lb.max:Infinity);var Ui=xc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ea)),$jscomp.arrayFromIterable(Yb._inputMorph?[Yb._inputMorph,{}]:[" "+(void 0!=Ma&&(Ma.valueOf?Ma.valueOf():Ma).toFixed(lb.isFloat?
Math.max(4,xc.num.precision(Ma)):0))+" ",{fontColor:Ui,onMouseUp:function(Fg){Yb._inputMorph=xc.morph({type:"input",fill:null,fontColor:Ui,fontFamily:"IBM Plex Mono",fontSize:14,padding:xc.rect(8,2,-6,2),height:23,cursorColor:xc.Color.white,value:Ma.valueOf?Ma.valueOf():yc});ad[xb]=Ma;Yb._inputMorph.focus();xc.once(Yb._inputMorph,"inputAccepted",function(ph){delete Yb._inputMorph;ad[xb]=lb.isFloat?Number.parseFloat(ph):Number.parseInt(ph);Yb.rerender()});xc.once(Yb._inputMorph,"onBlur",function(ph){Yb._inputMorph&&
(delete Yb._inputMorph,ad[xb]=Ma,Yb.rerender())});Yb.rerender()},onDragStart:function(Fg){Mh.scrubbedValue=Ma;xc.onNumberDragStart(Fg,Mh)},onDrag:function(Fg){ad[xb]=xc.onNumberDrag(Fg,Mh);Yb.rerender()},onDragEnd:function(Fg){return xc.onNumberDragEnd(Fg,Mh)}},ed,{onMouseUp:function(){qg.fill=Yf.fill=null},onMouseDown:function(Fg){if(Fg.targetMorph===qg){qg.fill=xc.Color.white.withA(.2);if("max"in lb&&ad[xb]>=lb.max)return;ad[xb]+=1}if(Fg.targetMorph===Yf){Yf.fill=xc.Color.white.withA(.2);if("min"in
lb&&ad[xb]<=lb.min)return;--ad[xb]}Yb.rerender()}}]))}},{key:"renderShadowControl",value:function(ea){var Ma=ea.keyString,lb=ea.value,xb=ea.target,yc=ea.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ea)),[""+(lb?lb.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(Yb){var ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(od){if(1==od.nextAddress)return ad=new xc.popovers.ShadowPopover({shadowValue:xb[Ma],hasFixedPosition:!0}),od.yield(ad.fadeIntoWorld(Yb.positionIn(xb.world())),
2);xc.connect(ad,"shadowValue",function(ed){xb[Ma]=ed;yc.rerender()});od.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(ea){var Ma=ea.keyString,lb=ea.value,xb=ea.target,yc=ea.node,Yb=xc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,ad={nativeCursor:"pointer",onMouseDown:function(od){var ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mf){if(1==mf.nextAddress)return ed=new xc.popovers.PointPopover({pointValue:xb[Ma],hasFixedPosition:!0}),mf.yield(ed.fadeIntoWorld(od.positionIn(xb.world())),
2);xc.connect(ed,"pointValue",function(qg){xb[Ma]=qg;yc.rerender()});mf.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ea)),[" pt(",Object.assign({},ad),""+lb.x.toFixed(),Object.assign({fontColor:Yb},ad),",",Object.assign({},ad),""+lb.y.toFixed(),Object.assign({fontColor:Yb},ad),")",Object.assign({},ad)])}},{key:"renderLayoutControl",value:function(ea){var Ma=ea.valueString,lb=ea.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ea)),[" "+(lb?
Ma:"No Layout"),{onMouseDown:function(xb){}}])}},{key:"renderColorControl",value:function(ea){var Ma=ea.node,lb=ea.gradientEnabled,xb=ea.valueString,yc=ea.keyString,Yb=ea.value,ad=ea.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ea)),[xc.morph({fill:Yb.valueOf?Yb.valueOf():Yb,extent:xc.pt(15,15),borderColor:xc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(Yb?Yb.valueOf?Yb.valueOf():xb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(od){var ed;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(mf){if(1==mf.nextAddress)return ed=new xc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:ad,fillValue:Yb,title:"Fill Control",gradientEnabled:lb}),mf.yield(ed.fadeIntoWorld(od.positionIn(ad.world())),2);xc.connect(ed,"fillValue",function(qg){ad[yc]=qg;Ma.rerender()});mf.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(ea){var Ma=ea.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ea)),[" "+Ma,
{}])}}],db,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5064,end:20451})}(xc.DraggableTreeLabel);xc.PropertyControl=gg;xc.PropertyControl=gg;xc.PropertyControl=gg;xc.inspect=wb;xc.inspect=wb;xc.remoteInspect=uc;xc.remoteInspect=uc;xc.generateReferenceExpression=Q;xc.generateReferenceExpression=
Q;var Wh=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Fb=db.hasOwnProperty("NumberControls")&&"function"===typeof db.NumberControls?db.NumberControls:db.NumberControls=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=
new xc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:xc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(ea){this.submorphs.map(function(Ma){return Ma.fontColor=ea})}},submorphs:{initialize:function(){this.submorphs=[xc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:xc.rect(5,2,0,-6),fontSize:12}),xc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:xc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",
fontSize:12})]}}}}}],db,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23124,end:24169})}(xc.Morph);(function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Fb=db.hasOwnProperty("PropertyTree")&&"function"===typeof db.PropertyTree?db.PropertyTree:db.PropertyTree=
function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:"onDrag",value:function(ea){this._onDragHandler&&this._onDragHandler(ea)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],db,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25334,end:25445})})(xc.Tree);gg=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Fb=db.hasOwnProperty("Inspector")&&"function"===typeof db.Inspector?db.Inspector:db.Inspector=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();
this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(ea){}},{key:"__after_deserialize__",value:function(ea,Ma,lb){var xb=this,yc=new xc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:xc.InspectionTree.forObject(null,this)}));this.addMorph(yc,this.getSubmorphNamed("terminal toggler"));Ab._get(Object.getPrototypeOf(Fb.prototype),"__after_deserialize__",this).call(this,ea,Ma,lb);!this.isComponent&&this.master.whenApplied().then(function(){xb.layout.col(0).row(1).group.morph=
yc;xb.targetObject&&(xb.targetObject=xb.targetObject)})}},{key:"__additionally_serialize__",value:function(ea,Ma,lb,xb){ea=ea.props.submorphs.value;for(Ma=ea.length;Ma--;)lb.refForId(ea[Ma].id).realObj==this.ui.propertyTree&&xc.arr.removeAt(ea,Ma)}},{key:"renderDraggableTreeLabel",value:function(ea){return new xc.DraggableTreeLabel(ea)}},{key:"renderPropertyControl",value:function(ea){return xc.PropertyControl.render(ea)}},{key:"onLoad",value:function(){var ea=this.ui,Ma=ea.codeEditor,lb=ea.thisBindingSelector,
xb=ea.propertyTree;Ma.changeEditorMode("js").then(function(){return Ma.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==lb.selection?Ma.owner.selectedContext:Ma.owner.targetObject},get systemInterface(){return xc.Path("treeData.systemInterface").get(xb)},format:"esm"}}).catch(function(yc){return $world.logError(yc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(ea){Ab._get(Object.getPrototypeOf(Fb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,ea);ea=this.ui;var Ma=ea.targetPicker,lb=ea.propertyTree,xb=ea.resizer,yc=ea.terminalToggler,Yb=ea.unknowns,ad=ea.internals,od=ea.searchField,ed=ea.codeEditor,mf=ea.fixImportButton,qg=ea.thisBindingSelector;ed.changeEditorMode("js").then(function(){return ed.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==qg.selection?ed.owner.selectedContext:ed.owner.targetObject},get systemInterface(){return lb.treeData.systemInterface},format:"esm"}}).catch(function(Yf){return $world.logError(Yf)});
xc.connect(Ma,"onMouseDown",this,"selectTarget");xc.connect(lb,"onScroll",this,"repositionOpenWidget");xc.connect(xb,"onDrag",this,"adjustProportions");xc.connect(yc,"onMouseDown",this,"toggleCodeEditor");xc.connect(Yb,"trigger",this,"filterProperties");xc.connect(ad,"trigger",this,"filterProperties");xc.connect(od,"searchInput",this,"filterProperties");xc.connect(lb,"nodeCollapseChanged",this,"filterProperties");xc.connect(this,"extent",this,"relayout");xc.connect(qg,"selection",this,"bindCodeEditorThis");
xc.connect(mf,"fire",ed,"execCommand",{updater:function(Yf){return Yf("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var ea=this.ui.propertyTree.selectedIndex-1,Ma=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Ma=this.ui.propertyTree.document.getLine(ea).textAndAttributes.slice(0,4).concat(Ma.display(this));ea=this.ui.propertyTree.lineRange(ea,!1);this.ui.propertyTree.replace(ea,Ma,!1,!1,
!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var ea=xc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(ea!=this.lastChange||this.lastSubmorphs!=xc.printValue(this.targetObject&&
this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==ea.prop&&this.repositionOpenWidget(),this.lastChange=ea,this.lastSubmorphs=xc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var ea;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Ma){Ma=Ma.node;Ma.target&&(ea=Ma.foldableNode?Ma.target[Ma.foldableNode.key][Ma.key]:Ma.target[Ma.key],
!xc.obj.equals(ea,Ma.value)&&Ma.refreshProperty&&Ma.refreshProperty(ea))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(ea,Ma){Ma=void 0===Ma?!1:Ma;var lb=this,xb,yc,Yb,ad,od,ed,mf,qg,Yf,Mh,Ui,Fg,ph,Bg,cl;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rg){switch(Rg.nextAddress){case 1:if(!lb.isUpdating()){Rg.jumpTo(2);break}return Rg.yield(lb.whenUpdated(),
2);case 2:xb=xc.promise.deferred();yc=xb.promise;Yb=!!lb.target;lb.updateInProgress=yc;Rg.setCatchFinallyBlocks(4);Ma&&(ad=xc.LoadingIndicator.open("connecting to remote..."));if(!Ma){od=xc.InspectionTree.forObject(ea,lb);Rg.jumpTo(6);break}return Rg.yield(xc.RemoteInspectionTree.forObject(ea,lb),7);case 7:od=Rg.yieldResult;case 6:return ed=od,mf=lb.ui.propertyTree,Rg.yield(ed.collapse(ed.root,!1),8);case 8:if(!ed.root.children){Rg.jumpTo(9);break}return Rg.yield(ed.collapse(ed.root.children[0],!1),
9);case 9:if(qg=lb.originalTreeData&&lb.originalTreeData.diff(ed)){Yf=$jscomp.makeIterator(qg);for(Mh=Yf.next();!Mh.done;Mh=Yf.next())Ui=Mh.value,Fg=$jscomp.makeIterator(Ui),ph=Fg.next().value,Bg=Fg.next().value,ph.refreshProperty(Bg.value);Rg.jumpTo(11);break}mf.treeData=ed;return Rg.yield(lb.filterProperties(),12);case 12:if(!mf.treeData.root.isCollapsed){Rg.jumpTo(13);break}return Rg.yield(mf.onNodeCollapseChanged({node:ed.root,isCollapsed:!1}),14);case 14:mf.selectedIndex=1;case 13:return Rg.yield(mf.execCommand("uncollapse selected node"),
11);case 11:lb.toggleWindowStyle(Yb);ad&&ad.remove();Rg.leaveTryBlock(5);break;case 4:cl=Rg.enterCatchBlock(),lb.showError(cl);case 5:lb.startStepping(1E3,"refreshAllProperties"),lb.updateInProgress=null,Rg.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(ea){ea=void 0===ea?!0:ea;var Ma=this,lb,xb,yc,Yb,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(od){if(1==od.nextAddress)return lb=300,Yb=Ma.ui.codeEditor.pluginFind(function(ed){return ed.runEval}),ad=Ma.getWindow(),od.yield(Yb.runEval("System.get('@system-env').node"),
2);od.yieldResult.value?(yc=[].concat($jscomp.arrayFromIterable(xc.arr.without(ad.styleClasses,"local")),["node"]),xb=xc.DarkTheme.instance):(yc=["local"].concat($jscomp.arrayFromIterable(ad?xc.arr.without(ad.styleClasses,"node"):[])),xb=xc.DefaultTheme.instance);Yb.theme=xb;ea?(ad&&ad.animate({duration:lb,styleClasses:yc}),Ma.ui.codeEditor.animate({fill:xb.background,duration:lb})):ad&&(ad.styleClasses=yc);Ma.ui.codeEditor.textString=Ma.ui.codeEditor.textString;Yb.highlight();od.jumpToEnd()})}},
{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var ea=this,Ma=Object.assign({type:"text",borderWidth:1,borderColor:xc.Color.gray,lineWrapping:"by-chars"},xc.config.codeEditor.defaultStyle,{textString:""}),lb=xc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});xc.rect(0,0,this.width,30);
var xb=new xc.SearchField({styleClasses:["idle"],name:"searchField"});lb[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[xb,{type:"button",name:"targetPicker",padding:xc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:xc.Icon.textAttribute("crosshairs")},new xc.LabeledCheckBox({label:"Internals",name:"internals"}),new xc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new xc.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:xc.InspectionTree.forObject(null,this)})),xc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},Ma),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:xc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(lb),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(lb),
[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){ea.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var ea=this,Ma,lb,xb,yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yb){switch(Yb.nextAddress){case 1:if(ea.env.eventDispatcher.isKeyPressed("Shift"))return lb=$jscomp,xb=lb.makeIterator,Yb.yield($world.execCommand("select morph",
{justReturn:!0}),5);ea.toggleSelectionInstructions(!0);return Yb.yield(xc.InteractiveMorphSelector.selectMorph(),4);case 4:Ma=Yb.yieldResult;ea.toggleSelectionInstructions(!1);Yb.jumpTo(3);break;case 5:yc=xb.call(lb,Yb.yieldResult),Ma=yc.next().value;case 3:Ma&&(ea.targetObject=Ma),Yb.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(ea){if(ea&&!this.instructionWidget){var Ma=xc.morph({type:"label",name:"escapeKey",value:"esc"});Ma.whenRendered().then(function(){return Ma.fit()});
this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},Ma,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",
value:function(ea){ea=ea.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;ea.epiMorph=!0;this.openWidget=ea;xc.once(ea,"close",this,"closeOpenWidget");xc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var ea=this.ui.propertyTree,Ma=ea.textLayout.boundsFor(ea,{column:0,row:ea.selectedIndex-1});Ma=ea.worldPoint(xc.pt(Ma.x,Ma.y+Ma.height/2)).addPt(ea.scroll.negated());ea=ea.globalBounds();
Ma.x=this.globalBounds().center().x;Ma.y<ea.top()?Ma=ea.topCenter():ea.bottom()-20<Ma.y&&(Ma=ea.bottomCenter().addXY(0,-20));return Ma}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(ea){this.layout.row(1).height+=ea.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(ea){if(ea!==
this.isEditorVisible()){var Ma=this.extent,lb=this.layout,xb=this.ui,yc=xb.terminalToggler,Yb=xb.codeEditor,ad=xb.thisBindingSelector;xb=xb.fixImportButton;lb.disable();ea?(yc.fontColor=xc.Color.rgbHex("00e0ff"),lb.row(3).height=this.codeEditorHeight||180,lb.row(2).height=5,xb.animate({visible:!0,duration:200}),ad.animate({visible:!0,duration:200})):(this.codeEditorHeight=lb.row(3).height,yc.fontColor=xc.Color.white,lb.row(3).height=lb.row(2).height=0,xb.animate({visible:!1,duration:200}),ad.animate({visible:!1,
duration:200}));this.extent=Ma;lb.enable({duration:200});this.relayout({duration:200});Yb.focus();Yb.animate({opacity:ea?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var ea=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){ea.makeEditorVisible(!ea.isEditorVisible());Ma.jumpToEnd()})}},{key:"filterProperties",value:function(){var ea=this,Ma,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress)return Ma=ea.ui.searchField,lb=ea.ui.propertyTree,
ea.originalTreeData||(ea.originalTreeData=lb.treeData),xc.disconnect(lb.treeData,"onWidgetOpened",ea,"onWidgetOpened"),xb.yield(lb.treeData.filter({maxDepth:2,showUnknown:ea.ui.unknowns.checked,showInternal:ea.ui.internals.checked,iterator:function(yc){return Ma.matches(yc.key)}}),2);lb.update();xc.connect(lb.treeData,"onWidgetOpened",ea,"onWidgetOpened");xb.jumpToEnd()})}},{key:"relayout",value:function(ea){ea=void 0===ea?{}:ea;var Ma=this,lb,xb,yc,Yb,ad,od,ed,mf,qg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yf){Ma.layout&&
Ma.layout.forceLayout();lb=Ma;xb=lb.ui;yc=xb.fixImportButton;Yb=xb.terminalToggler;ad=xb.propertyTree;od=xb.thisBindingSelector;ed=ad.bounds().insetBy(5).bottomLeft();mf=ad.bounds().insetBy(5).bottomRight();qg=mf.subXY(yc.width+10,0);od.width=115;od.listMorph.itemHeight=20;ea.duration?(Yb.animate(Object.assign({bottomLeft:ed},ea)),yc.animate(Object.assign({bottomRight:mf},ea)),od.animate(Object.assign({bottomRight:qg},ea))):(Yb.bottomLeft=ed,yc.bottomRight=mf,od.bottomRight=qg);Yf.jumpToEnd()})}},
{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Ab._get(Object.getPrototypeOf(Fb.prototype),"keybindings",this))}},{key:"commands",get:function(){return xc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(ea){if(System._testsRunning)return console.log(ea.targetObject);
ea=new this(ea);ea.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return ea}},{key:"properties",get:function(){return{extent:{defaultValue:xc.pt(400,500)},fill:{defaultValue:xc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(ea){this.setProperty("remoteTarget",ea);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ea,!0))}},targetObject:{after:["submorphs"],set:function(ea){this._serializableTarget=
ea&&ea.isMorph?ea.id:ea;this.setProperty("targetObject",ea);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ea))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var ea=this.ui.propertyTree,Ma=ea.treeData;return Ma.getContextFor(ea.selectedNode||Ma.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),
fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},
treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:xc.Color.gray,fontSize:14,fontFamily:xc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],db,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:25462,end:45996})}(xc.Morph);gg=xc.Inspector;Sf=Ha("I",gg);xc.default=gg;var Di=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");Di.Inspector=Sf;Di.string=Jd;Di.Morph=Gc;Di.pt=Ld;Di.Color=tb;gg=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Oa,db,Fb){Fb=void 0===Fb?1:Fb;var ea,Ma,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){switch(xb.nextAddress){case 1:return Oa.maybeSelectCommentOrLine(),
xb.setCatchFinallyBlocks(2),db=Object.assign({},db,{logDoit:!0,inspect:!0,inspectDepth:Fb}),xb.yield(Oa.doEval(void 0,db),4);case 4:ea=xb.yieldResult;Ma=ea.error?ea.error:ea.isError?ea.value:null;xb.leaveTryBlock(3);break;case 2:Ma=lb=xb.enterCatchBlock();case 3:return Ma?Oa.showError(Ma):Oa.setStatusMessage(Di.string.truncate(ea.value,1E3)),xb.return(ea)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Oa,db){var Fb,ea,Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){switch(lb.nextAddress){case 1:return lb.setCatchFinallyBlocks(2),
lb.yield(Oa.doEval({start:{row:0,column:0},end:Oa.documentEndPosition},Object.assign({},db,{logDoit:!0})),4);case 4:Fb=lb.yieldResult;ea=Fb.error?Fb.error:Fb.isError?Fb.value:null;lb.leaveTryBlock(3);break;case 2:ea=Ma=lb.enterCatchBlock();case 3:return ea?Oa.showError(ea):Oa.setStatusMessage(String(Fb.value)),lb.return(Fb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Oa,db){var Fb,ea,Ma,lb,xb,yc,Yb,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(od){switch(od.nextAddress){case 1:return Oa.maybeSelectCommentOrLine(),
od.setCatchFinallyBlocks(2),db=Object.assign({},db,{asString:!1,logDoit:!0}),od.yield(Oa.doEval(void 0,db),4);case 4:Fb=od.yieldResult;ea=Fb.error?Fb.error:Fb.isError?Fb.value:null;od.leaveTryBlock(3);break;case 2:ea=Ma=od.enterCatchBlock();case 3:Oa.selection.collapseToEnd();if(lb=Fb.value&&Fb.value.isColor)return Oa.selection.text=String(Fb.value),xb=new Di.Morph({fill:Di.Color.transparent,extent:Di.pt(Oa.fontSize+2,Oa.fontSize+2),submorphs:[{fill:Fb.value,center:Di.pt(Oa.fontSize+2,Oa.fontSize+
2).scaleBy(.5)}]}),yc=Oa.selection.start,Yb=yc.column,ad=yc.row,Oa.insertText([xb,{}],Oa.selection.start),Oa.selection.start={column:Yb,row:ad},Oa.focus(),od.return(Fb);Oa.insertTextAndSelect(ea?String(ea)+(ea.stack?"\n"+ea.stack:""):String(Fb.value));Oa.focus();return od.return(Fb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Oa,db){var Fb,ea,Ma,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){switch(xb.nextAddress){case 1:Oa.maybeSelectCommentOrLine();
ea=Oa.textInRange(Oa.selection);Ma=Oa.evalEnvironment||{};lb=Oa.pluginFind(function(yc){return yc.isEditorPlugin&&"function"===typeof yc.runEval});Ma.systemInterface||(Ma.systemInterface=lb.systemInterface(db));if("local"!==Ma.systemInterface.name){xb.jumpTo(2);break}xb.setCatchFinallyBlocks(3);return xb.yield(Oa.doEval(void 0,db),5);case 5:Fb=xb.yieldResult;ea=Fb.value;xb.leaveTryBlock(2);break;case 3:xb.enterCatchBlock();case 2:return Oa.world().execCommand("open object editor",{target:ea,evalEnvironment:Ma}),
xb.return(Fb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Oa,db){var Fb,ea,Ma,lb,xb,yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yb){switch(Yb.nextAddress){case 1:Oa.maybeSelectCommentOrLine();Ma=Oa.textInRange(Oa.selection);lb=Oa.evalEnvironment||{};xb=Oa.pluginFind(function(ad){return ad.isEditorPlugin&&"function"===typeof ad.runEval});lb.systemInterface||(lb.systemInterface=xb.systemInterface(db));
if("local"!==lb.systemInterface.name){Di.Inspector.openInWindow({remoteTarget:{code:Ma,evalEnvironment:lb}});Yb.jumpTo(2);break}Yb.setCatchFinallyBlocks(3);return Yb.yield(Oa.doEval(void 0,db),5);case 5:Fb=Yb.yieldResult;ea=Fb.error?Fb.error:Fb.isError?Fb.value:null;Ma=Fb.value;Yb.leaveTryBlock(4);break;case 3:ea=yc=Yb.enterCatchBlock();case 4:Di.Inspector.openInWindow({targetObject:ea||Ma});case 2:return Yb.return(Fb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(Oa,db,Fb){Fb=void 0===Fb?1:Fb;var ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){switch(Ma.nextAddress){case 1:return Oa.maybeSelectCommentOrLine(),Ma.setCatchFinallyBlocks(2),db=Object.assign({},db,{inspect:!0,inspectDepth:Fb,logDoit:!0}),Ma.yield(Oa.doEval(void 0,db),4);case 4:ea=Ma.yieldResult;Ma.leaveTryBlock(3);break;case 2:Ma.enterCatchBlock();case 3:return Oa.selection.collapseToEnd(),Oa.insertTextAndSelect(ea.value),Ma.return(ea)}})}}];Di.codeEvaluationCommands=
gg;Di.codeEvaluationCommands=gg;Di.codeEvaluationCommands=gg;var Bh=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Bh.changeAttributeInSelectionOrMorph=function(Oa,db,Fb){var ea=Oa.selection;Oa.keepPosAtSameScrollOffsetWhile(function(){ea.isEmpty()?Oa[db]="function"===typeof Fb?Fb(Oa[db]):Fb:(Oa.undoManager.group(),Oa.changeStyleProperty(db,function(Ma){return"function"===typeof Fb?Fb(Ma):Fb}),Oa.undoManager.group())})};Sf=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(Oa){var db=Oa.fontSize;Bh.changeAttributeInSelectionOrMorph(Oa,"fontSize",function(Fb){Fb=Fb||db;return Fb+(18<=Fb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Oa){var db=Oa.fontSize;Bh.changeAttributeInSelectionOrMorph(Oa,"fontSize",function(Fb){Fb=Fb||db;return Fb-(18>=Fb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Oa){var db,Fb,ea,Ma,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress){db=
["serif","sans-serif","monospace"];if(Fb=localStorage["lively.morpic/text-change-font-additional-fonts"])Fb=JSON.parse(Fb),db.push.apply(db,$jscomp.arrayFromIterable(Fb));db.map(function(yc){return yc.toLowerCase()}).includes(Oa.fontFamily.toLowerCase())||(db.push(Oa.fontFamily),Fb=[].concat($jscomp.arrayFromIterable(Fb||[]),[Oa.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Fb));return xb.yield($world.editListPrompt("choose font",db,{requester:Oa,preselect:db.indexOf(Oa.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}ea=xb.yieldResult;Ma=$jscomp.makeIterator(ea.selections);if(lb=Ma.next().value)Oa.fontFamily=lb;return xb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Oa,db){db=void 0===db?{}:db;var Fb,ea,Ma,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress){if(db.hasOwnProperty("link"))return xb.jumpTo(2);ea=Oa.selection;Ma=Oa.getStyleInRange(ea);lb=Ma.link;return xb.yield(Oa.world().prompt("Set link",
{input:lb||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=xb.nextAddress&&(Fb=xb.yieldResult,!Fb))return xb.return();Oa.undoManager.group();Oa.setStyleInRange({link:Fb||void 0},ea);Oa.undoManager.group();xb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Oa,db){var Fb,ea,Ma,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xb){if(1==xb.nextAddress)return Fb=Oa.selection,ea=Oa.getStyleInRange(Fb),Ma=ea.doit,xb.yield(Oa.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:Oa,input:Ma?Ma.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Oa.evalEnvForDoit(Ma||{})}),2);lb=xb.yieldResult;Oa.undoManager.group();lb?Oa.addTextAttribute({doit:{code:lb},nativeCursor:"pointer",textDecoration:"underline"},Fb):Oa.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Fb);Oa.undoManager.group();xb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Oa,db){db=void 0===db?{}:db;Oa.undoManager.group();
db=!db.onlySelection&&Oa.selection.isEmpty()?Oa.documentRange:Oa.selection.range;Oa.setStyleInRange(null,db);Oa.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Oa){var db,Fb,ea,Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){if(1==lb.nextAddress)return lb.yield(System.import("lively.modules"),2);if(3!=lb.nextAddress)return db=lb.yieldResult,Fb=db.module,lb.yield(Fb("lively.ide/text/ui.js").load(),3);ea=lb.yieldResult;Ma=ea.RichTextControl;return lb.return(Ma.openFor(Oa))})}}];
Bh.commands=Sf;Bh.commands=Sf;Bh.commands=Sf;var If=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");If.guessTextModeName=Da;If.rangedToken=function(Oa,db,Fb,ea,Ma){return{start:{row:Oa,column:db},end:{row:Oa,column:Fb},token:ea,mode:Ma}};If.fun=kb;If.arr=kc;If.connect=Pc;If.disconnect=bc;If.DefaultTheme=pc;If.tokenizeDocument=ae;If.modeInfo=Kb;If.visitDocumentTokens=Xd;If.getMode=Ca;If.completionCommands=rd;If.multiSelectCommands=Tf;If.navCommands=$e;If.codeCommands=of;If.codeEvaluationCommands=
gg;If.richTextCommands=Sf;If.Color=tb;If.Range=Ze;If.guessTextModeName=Da;If.guessTextModeName=Da;pc=function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Fb=db.hasOwnProperty("EditorPlugin")&&"function"===typeof db.EditorPlugin?db.EditorPlugin:db.EditorPlugin=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Fb,Oa,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
If.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(ea){var Ma=this;this.textMorph=ea;If.connect(ea,"textChange",this,"onTextChange");If.connect(ea,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Ma.highlight()})}},
{key:"detach",value:function(ea){If.disconnect(ea,"textChange",this,"onTextChange");If.disconnect(ea,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(ea){this._ast=null;if(ea){var Ma=this._tokenizerValidBefore;if("replace"===ea.selector){var lb=ea.args[0].start;ea=lb.row;lb=lb.column}else lb=ea=0;if(!Ma||ea<Ma.row||ea===Ma.row&&lb<Ma.column)ea=Math.max(0,ea),this._tokenizerValidBefore={row:ea,
column:lb}}this.requestHighlight()}},{key:"requestHighlight",value:function(ea){var Ma=this;(void 0===ea?0:ea)?this.highlight():If.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return Ma.highlight()})()}},{key:"highlight",value:function(){var ea=this.textMorph,Ma=this.theme,lb=this.mode,xb=this._tokenizerValidBefore;if(Ma&&ea&&ea.document&&lb){ea.fill=Ma.background;ea.cursorColor=Ma.cursorColor||If.Color.black;var yc=ea.viewState,Yb={};xb=If.tokenizeDocument(lb,ea.document,yc.firstVisibleRow,
yc.lastVisibleRow,xb);lb=xb.lines;xb=xb.tokens;if(lb.length){yc=lb[0].row;for(var ad=[],od=0;od<xb.length;yc++,od++)for(var ed=xb[od],mf=0;mf<ed.length;mf+=5){var qg=ed[mf],Yf=ed[mf+1],Mh=Ma[ed[mf+2]]||Ma.default;Mh&&ad.push({start:{row:yc,column:qg},end:{row:yc,column:Yf}},Mh)}ea.embeddedMorphs.forEach(function(Ui){var Fg=ea.embeddedMorphMap.get(Ui).anchor;Yb[Ui.id]=ea.textAttributeAt(Fg.position)});ea.setTextAttributesWithSortedRanges(ad);ea.embeddedMorphs.forEach(function(Ui){var Fg=ea.embeddedMorphMap.get(Ui).anchor;
Fg=If.Range.at(Fg.position);Fg.end.column+=1;ea.replace(Fg,[Ui,Yb[Ui.id]],!1)});this._tokenizerValidBefore={row:If.arr.last(lb).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},ea,this)}}},{key:"visitTokensInRange",value:function(ea,Ma){var lb=ea.start,xb=ea.end,yc=lb.row-1;If.visitDocumentTokens(this.mode,this.textMorph.document,lb.row,xb.row,null,function(Yb){return yc++},function(Yb,ad,od,ed,mf,qg,Yf){if(yc===lb.row&&0<lb.column){if(lb.column>=ed)return;od<lb.column&&lb.column<
ed&&(od=lb.column)}if(yc===xb.row){if(xb.column<=od)return;od<xb.column&&xb.column<ed&&(ed=xb.column)}Ma(Yb,ad,yc,od,ed,mf,qg,Yf)})}},{key:"tokensInRange",value:function(ea){var Ma=[];this.visitTokensInRange(ea,function(lb,xb,yc,Yb,ad,od,ed,mf){return Ma.push(If.rangedToken(yc,Yb,ad,lb,mf))});return Ma}},{key:"tokensOfRow",value:function(ea){var Ma=this.textMorph.getLine(ea).length;return this.tokensInRange({start:{row:ea,column:0},end:{row:ea,column:Ma}})}},{key:"tokenAt",value:function(ea){for(var Ma=
this.tokensOfRow(ea.row),lb=Ma.length;lb--;){var xb=Ma[lb];if(xb.token&&xb.start.column<=ea.column&&ea.column<=xb.end.column)return xb}return null}},{key:"getCommands",value:function(ea){return[].concat($jscomp.arrayFromIterable(ea),$jscomp.arrayFromIterable(If.completionCommands),$jscomp.arrayFromIterable(If.multiSelectCommands),$jscomp.arrayFromIterable(If.navCommands),$jscomp.arrayFromIterable(If.codeCommands),$jscomp.arrayFromIterable(If.codeEvaluationCommands),$jscomp.arrayFromIterable(If.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var ea=this.mode,Ma=ea.lineComment,lb=ea.blockCommentStart;ea=ea.blockCommentEnd;var xb={};Ma&&(xb.lineCommentStart=Ma);lb&&(xb.blockCommentStart=lb);ea&&(xb.blockCommentEnd=ea);return xb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(ea,Ma,lb){var xb=this.textMorph,yc=ea.row,Yb=ea.column;ea=Ma[Yb-1];Ma=Ma[Yb];xb.selection.text="\n";xb.selection.collapseToEnd();
"{"===ea&&"}"===Ma&&(xb.selection.text="\n"+" ".repeat(lb),xb.selection.collapse());xb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:yc+1,lastRow:yc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var ea=this.textMorph,Ma=this.openPairs,lb=ea.selection,xb=ea.getLine(lb.end.row),
yc=xb[lb.end.column-1];xb=xb[lb.end.column];ea.autoInsertPairs&&lb.isEmpty()&&yc in Ma&&xb===Ma[yc]&&(lb.growRight(1),lb.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(ea){var Ma=this.openPairs,lb=this.closePairs,xb=this.textMorph,yc=xb.selection,Yb=xb.autoInsertPairs&&ea in Ma,ad=xb.autoInsertPairs&&ea in lb;if(!Yb&&!ad)return!1;var od=xb.getLine(yc.end.row)[yc.end.column];if(!yc.isEmpty()){if(!Yb)return!1;lb=xb.undoManager.ensureNewGroup(xb);xb.insertText(Ma[ea],yc.end);xb.insertText(ea,
yc.start);xb.undoManager.group(lb);yc.growRight(-1);return!0}if(od in lb&&ea===od)return yc.goRight(1),!0;if(ad&&!Yb)return!1;lb=xb.undoManager.ensureNewGroup(xb);xb.insertText(ea+Ma[ea]);xb.undoManager.group(lb);yc.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],db,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);Kb=pc=If.EditorPlugin;rd=Ha("C",function(Oa){var db=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Fb=db.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof db.CodeMirrorEnabledEditorPlugin?db.CodeMirrorEnabledEditorPlugin:db.CodeMirrorEnabledEditorPlugin=function(ea){ea&&ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ab(Fb,Oa,[{key:Symbol.for("lively-instance-initialize"),value:function(){Ab._get(Object.getPrototypeOf(Fb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(ea){this.mode=this.codeMirrorMode(ea);return Ab._get(Object.getPrototypeOf(Fb.prototype),"attach",this).call(this,ea)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",
value:function(ea){return{indentWithTabs:!ea.useSoftTabs,indentUnit:ea.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(ea){ea=this.defaultCodeMirrorModeConfig(ea);return If.getMode(ea,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],db,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(If.EditorPlugin));If.CodeMirrorEnabledEditorPlugin=rd;If.CodeMirrorEnabledEditorPlugin=rd;If.CodeMirrorEnabledEditorPlugin=rd;If.default=pc;pc=Object.freeze({__proto__:null,guessTextModeName:Da,"default":Kb,CodeMirrorEnabledEditorPlugin:rd});Ha("e",pc)}}});
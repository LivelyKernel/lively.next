System.register(["./__root_module__-fd8ea0c8.js"],function(Ca){var Bb,Kb,lc,bc,Td,Xc,Wd,$c,Pc,md,ge,Qe,kf,ke,cc,Hc,Nd,ec,$d,le,Dc,Ic,Vb,Lc,dd,Hd,Ld,wc,rb,Gb,Oa,ab,Qa,Ja,eb,Rb,zc,sb,Ab,vb,ha,Ha,W;return{setters:[function(ra){Bb=ra.ax;Kb=ra.a3;lc=ra.C;bc=ra.ab;Td=ra.a8;Xc=ra.$;Wd=ra.a7;$c=ra.a1;Pc=ra.a2;md=ra.aa;ge=ra.aA;Qe=ra.as;kf=ra.an;ke=ra.aY;cc=ra.au;Hc=ra.aj;Nd=ra.aZ;ec=ra.aw;$d=ra.az;le=ra.a_;Dc=ra.aD;Ic=ra.ac;Vb=ra.aq;Lc=ra.g;dd=ra.am;Hd=ra.P;Ld=ra.a$;wc=ra.at;rb=ra.a6;Gb=ra.av;Oa=ra.b0;
ab=ra.r;Qa=ra.ap;Ja=ra.b1;eb=ra.b2;Rb=ra.b3;zc=ra.ad;sb=ra.b4;Ab=ra.ar;vb=ra.b5;ha=ra.b6;Ha=ra.b7;W=ra.aS}],execute:function(){function ra(ma){(ma=nc.cachedGuideLines.get(ma))&&ma.forEach(function(Aa){return Aa.remove()})}function Za(ma,Aa,xb,P,wa){Aa=void 0===Aa?!0:Aa;xb=void 0===xb?!0:xb;P=void 0===P?10:P;wa=void 0===wa?100:wa;if(Aa||xb){var Xa=ma.owner,Db=Xa.world();Xa=Xa.getGlobalTransform();var mc=ma.owner.submorphs.filter(function(nb){return nb!==ma&&!nb.isEpiMorph&&nb.visible&&nb.reactsToPointer}),
Sb=nc.findAlignedMorphs(ma,mc,P,wa,"left top right bottom hCenter vCenter".split(" "),"left top right bottom hCenter vCenter".split(" "));wa=[];var Tc=0,gd=0,se=0,Cf=0;Xa.e-=Db.scroll.x;Xa.f-=Db.scroll.y;if(Sb){Sb=$jscomp.makeIterator(Sb);for(var me=Sb.next();!me.done;me=Sb.next()){me=$jscomp.makeIterator(me.value);me.next();var Se=me.next().value;me=Se.vertical;Se=$jscomp.makeIterator(Se.horizontal);for(var Ze=Se.next();!Ze.done;Ze=Se.next()){Ze=Ze.value;var yf=Ze.edgeAVal,vd=Ze.refPointsA,Ve=Ze.refPointsB,
Ye=Ze.edgeBVal,cg=Math.ceil(P-Ze.delta),eg=Math.min(vd.top,Ve.top);vd=Math.max(vd.bottom,Ve.bottom);Ze.maxDist>P&&(cg-=P/2);Tc<cg&&(Tc=cg,se=Ye-yf);wa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:nc.guideWidth,start:Xa.transformPoint(nc.pt(Ye,eg)),end:Xa.transformPoint(nc.pt(Ye,vd)),fill:nc.guideColor,guideType:"h",priority:cg})}me=$jscomp.makeIterator(me);for(Se=me.next();!Se.done;Se=me.next())Se=Se.value,Ze=Se.edgeAVal,eg=Se.refPointsA,vd=Se.refPointsB,yf=Se.edgeBVal,Ye=Math.ceil(P-
Se.delta),cg=Math.min(eg.left,vd.left),eg=Math.max(eg.right,vd.right),Se.maxDist>P&&(Ye-=P/2),gd<Ye&&Math.abs(yf-Ze)<=P&&(gd=Ye,Cf=yf-Ze),wa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:nc.guideWidth,start:Xa.transformPoint(nc.pt(cg,yf)),end:Xa.transformPoint(nc.pt(eg,yf)),fill:nc.guideColor,guideType:"v",priority:Ye})}}if(!Tc||!gd){mc=[ma].concat($jscomp.arrayFromIterable(mc));Ze=nc.computeClosestMorphs(mc);Se=Ze[0];mc=Se.l;Sb=Se.r;me=Se.t;Se=Se.b;var Vg;if(mc||Sb||me||Se){var pc=(mc||
Sb||me||Se).refPointsA;for(yf=1;yf<Ze.length&&(vd=Ze[yf],Ye=vd.l,cg=vd.r,eg=vd.t,vd=vd.b,Tc||(mc&&Ye&&mc.index!==Ye.index&&Math.abs(Ye.dist-mc.dist)<=P?Vg=Object.assign({neighbor:yf,direction:"left"},Ye):Sb&&cg&&Sb!==cg.index&&Math.abs(cg.dist-Sb.dist)<=P&&(Vg=Object.assign({neighbor:yf,direction:"right"},cg))),gd||(me&&eg&&me.index!==eg.index&&Math.abs(eg.dist-me.dist)<=P?Vg=Object.assign({neighbor:yf,direction:"top"},eg):Se&&vd&&Se.index!==vd.index&&Math.abs(vd.dist-Se.dist)<=P&&(Vg=Object.assign({neighbor:yf,
direction:"bottom"},vd))),!Vg);yf++);}if(Vg){var qh=Vg;P=qh.direction;eg=qh.dist;var rh=pc.left;Ve=pc.top;var nh=pc.bottom,Jf=pc.right,Na=pc.width,fb=pc.height;vd=qh.refPointsA;pc=vd.left;Ze=vd.top;yf=vd.bottom;Ye=vd.right;cg=vd.width;vd=vd.height;var Jb=qh.refPointsB,da=Jb.left;qh=Jb.top;var Ia=Jb.bottom;Jb=Jb.right;Jf="left"===P?rh:"right"===P?Jf:rh+Na/2;nh="bottom"===P?nh:"top"===P?Ve:Ve+fb/2;rh="left"===P?Jf-eg:"right"===P?Jf+eg:rh+Na/2;eg="bottom"===P?nh+eg:"top"===P?nh-eg:Ve+fb/2;Ve="left"===
P?Jb:"right"===P?da:pc+cg/2;Na="bottom"===P?qh:"top"===P?Ia:Ze+vd/2;!xb||Tc||"right"!==P&&"left"!==P||(Tc=10,se=(Vg.dist-(Sb||mc).dist)*("right"===P?-1:1),Jf+=se,rh+=se);!xb||gd||"top"!==P&&"bottom"!==P||(gd=10,Cf=((me||Se).dist-Vg.dist)*("top"===P?-1:1),nh+=Cf,eg+=Cf);wa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,start:Xa.transformPoint(nc.pt("left"===P?pc:"right"===P?Ye:pc+cg/2,"bottom"===P?yf:"top"===P?Ze:Ze+vd/2)),end:Xa.transformPoint(nc.pt(Ve,Na)),fill:nc.Color.orange,height:nc.guideWidth,
guideType:P,priority:10},{type:"line",epiMorph:!0,hasFixedPosition:!0,start:Xa.transformPoint(nc.pt(Jf,nh)),end:Xa.transformPoint(nc.pt(rh,eg)),fill:nc.Color.orange,height:nc.guideWidth,guideType:P,priority:10})}}xb&&(se||Cf)&&ma.moveBy(nc.pt(se,Cf));if(Aa){wa=wa.filter(function(nb){var yb=nb.guideType;nb=nb.priority;return"h"===yb?nb===Tc:"v"===yb?nb===gd:!0});(Aa=nc.cachedGuideLines.get(ma))||nc.cachedGuideLines.set(ma,Aa=[]);for(xb=0;xb<wa.length;xb++)Vg=void 0,Aa[xb]?Vg=Object.assign(Aa[xb],wa[xb]):
(Vg=nc.morph(wa[xb]),Aa.push(Vg)),Vg.owner||Db.addMorph(Vg);Aa.slice(xb).forEach(function(nb){return nb.remove()});nc.fun.debounceNamed(ma.id+"-drag-guides-cleanup",1300,function(){var nb=nc.cachedGuideLines.get(ma);nb&&nb.forEach(function(yb){return yb.remove()})})()}}}function qb(ma,Aa,xb,P,wa,Xa){xb=void 0===xb?!0:xb;P=void 0===P?!0:P;wa=void 0===wa?5:wa;Xa=void 0===Xa?100:Xa;if(xb||P){var Db=ma.owner,mc=Db.world(),Sb=Db.getGlobalTransform(),Tc=ma.owner.submorphs.filter(function(nh){return nh!==
ma&&!nh.isEpiMorph&&nh.visible&&nh.reactsToPointer});Db=(Aa.includes("left")||Aa.includes("right")?"x":"")+(Aa.includes("top")||Aa.includes("bottom")?"y":"");var gd=nc.findMorphsWithSimilarWidthOrHeight(ma,Db,Tc,wa,Xa),se=-Infinity,Cf=-Infinity,me=0,Se=0,Ze=0,yf=0,vd=0,Ve=0;Db=[];Sb.e-=mc.scroll.x;Sb.f-=mc.scroll.y;if(gd){gd=$jscomp.makeIterator(gd);for(var Ye=gd.next();!Ye.done;Ye=gd.next()){Ye=$jscomp.makeIterator(Ye.value);Ye.next();var cg=Ye.next().value;Ye=cg.similarIn;var eg=cg.delta,Vg=cg.refPointsA,
pc=cg.refPointsB;cg=wa-eg+(Xa-cg.minDist);"width"===Ye?se<cg&&(se=cg,Aa.includes("left")&&(Se=-eg),Aa.includes("right")&&(me=eg)):Cf<cg&&(Cf=cg,Aa.includes("top")&&(Ze=-eg),Aa.includes("bottom")&&(yf=eg));eg={type:"line",epiMorph:!0,hasFixedPosition:!0,height:nc.guideWidth,fill:nc.guideColor,guideType:Ye,priority:cg,start:Sb.transformPoint("width"===Ye?nc.pt(Vg.left,Vg.top+Vg.height/2):nc.pt(Vg.left+Vg.width/2,Vg.top)),end:Sb.transformPoint("width"===Ye?nc.pt(Vg.right,Vg.top+Vg.height/2):nc.pt(Vg.left+
Vg.width/2,Vg.bottom))};Ye=Object.assign({},eg,{start:Sb.transformPoint("width"===Ye?nc.pt(pc.left,pc.top+pc.height/2):nc.pt(pc.left+pc.width/2,pc.top)),end:Sb.transformPoint("width"===Ye?nc.pt(pc.right,pc.top+pc.height/2):nc.pt(pc.left+pc.width/2,pc.bottom))});Db.push(eg,Ye)}}if(Xa=nc.findAlignedMorphs(ma,Tc,wa,Xa,Aa,void 0))for(Xa=$jscomp.makeIterator(Xa),Tc=Xa.next();!Tc.done;Tc=Xa.next()){Tc=$jscomp.makeIterator(Tc.value);Tc.next();gd=Tc.next().value;Tc=gd.vertical;gd=$jscomp.makeIterator(gd.horizontal);
for(Ye=gd.next();!Ye.done;Ye=gd.next()){Ye=Ye.value;pc=Ye.edgeAVal;var qh=Ye.refPointsA,rh=Ye.refPointsB;eg=Ye.edgeBVal;Vg=Math.ceil(wa-Ye.delta);cg=Math.min(qh.top,rh.top);qh=Math.max(qh.bottom,rh.bottom);Ye.maxDist>wa&&(Vg-=wa/2);vd<Vg&&(vd=Vg,Aa.includes("left")&&(Se=-(eg-pc)),Aa.includes("right")&&(me=+(eg-pc)));Db.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:nc.guideWidth,start:Sb.transformPoint(nc.pt(eg,cg)),end:Sb.transformPoint(nc.pt(eg,qh)),fill:nc.guideColor,guideType:"h",priority:Vg})}Tc=
$jscomp.makeIterator(Tc);for(gd=Tc.next();!gd.done;gd=Tc.next())gd=gd.value,Ye=gd.edgeAVal,cg=gd.refPointsA,qh=gd.refPointsB,pc=gd.edgeBVal,eg=Math.ceil(wa-gd.delta),Vg=Math.min(cg.left,qh.left),cg=Math.max(cg.right,qh.right),gd.maxDist>wa&&(eg-=wa/2),Ve<eg&&Math.abs(pc-Ye)<=wa&&(Ve=eg,Aa.includes("top")&&(Ze=pc-Ye),Aa.includes("bottom")&&(yf=pc-Ye)),Db.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:nc.guideWidth,start:Sb.transformPoint(nc.pt(Vg,pc)),end:Sb.transformPoint(nc.pt(cg,pc)),
fill:nc.guideColor,guideType:"v",priority:eg})}P&&(Se&&(ma.left+=Se,ma.right-=Se),Ze&&(ma.top+=Ze,ma.bottom-=Ze),me&&(ma.width+=me),yf&&(ma.height+=yf));if(xb){Db=Db.filter(function(nh){var Jf=nh.guideType;nh=nh.priority;return"width"===Jf?nh===se:"height"===Jf?nh===Cf:"v"===Jf?nh===Ve:"h"===Jf?nh===vd:!1});(Aa=nc.cachedGuideLines.get(ma))||nc.cachedGuideLines.set(ma,Aa=[]);for(xb=0;xb<Db.length;xb++)P=void 0,Aa[xb]?P=Object.assign(Aa[xb],Db[xb]):(P=nc.morph(Db[xb]),Aa.push(P)),P.owner||mc.addMorph(P);
Aa.slice(xb).forEach(function(nh){return nh.remove()});nc.fun.debounceNamed(ma.id+"-drag-guides-cleanup",1300,function(){var nh=nc.cachedGuideLines.get(ma);nh&&nh.forEach(function(Jf){return Jf.remove()})})()}}}function sc(ma,Aa){Aa=void 0===Aa?!1:Aa;var xb=Ob.MorphicEnv.default().world;if(null===ma||void 0===ma)ma=String(ma);if(ma.isMorph)return Ob.showRect(ma.world(),ma.globalBounds().translatedBy(ma.world().scroll.negated()),Aa);if(ma.isPoint)return Ob.showRect(xb,new Ob.Rectangle(ma.x-5,ma.y-
5,10,10));if(ma.isLine)return Ob.showLine(xb,ma);if(ma.isRectangle)return Ob.showRect(xb,ma);if("undefined"!==typeof Ob.Element&&ma instanceof Ob.Element)return Ob.showRect(xb,Ob.Rectangle.fromElement(ma));if("number"===typeof ma||"symbol"===typeof ma||"boolean"===typeof ma||"undefined"!==typeof Ob.Node&&ma instanceof Ob.Node||ma instanceof RegExp)ma=String(ma);"object"===typeof ma&&(ma=Ob.obj.inspect(ma,{maxDepth:1}));return"string"===typeof ma&&1===arguments.length?xb.setStatusMessage(ma):xb.setStatusMessage(Ob.string.formatFromArray(Array.from(arguments)))}
function wd(ma,Aa,xb){xb=void 0===xb?3E3:xb;var P,wa,Xa,Db,mc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sb){if(1==Sb.nextAddress){if(!(ma&&ma.world()&&Aa&&Aa.world()))return Sb.return(null);P=ma.owner.worldPoint(ma.center);wa=Aa.owner.worldPoint(Aa.center);Xa=P.lineTo(wa).sampleN(2)[1];Db={tagName:"marker",markerHeight:5,markerWidth:5,orient:"auto",refX:1,refY:5,viewBox:"0 0 10 10",children:[{tagName:"circle",stroke:Ob.Color.red,fill:Ob.Color.red,cx:5,cy:5,r:4}]};mc=$world.addMorph(new Ob.Path({position:Xa,
renderOnGPU:!0,vertices:[Ob.pt(0),Ob.pt(0)],borderWidth:2,startMarker:Db,endMarker:Db,borderColor:Ob.Color.red}));return Sb.yield(mc.whenRendered(),2)}if(3!=Sb.nextAddress)return Sb.yield(mc.animate({opacity:1,customTween:function(Tc){var gd=mc.center;mc.vertices=[Ob.pt(0).interpolate(Tc,P.subPt(Xa)),Ob.pt(0).interpolate(Tc,wa.subPt(Xa))];mc.center=gd},duration:400}),3);xb&&setTimeout(function(){return mc.fadeOut()},xb);return Sb.return(mc)})}Ca({a:Za,d:wd,r:ra,s:sc});var nc=lively.FreezerRuntime.recorderFor("lively.halos/drag-guides.js");
nc.removeSnapToGuidesOf=ra;nc.showAndSnapToGuides=Za;nc.showAndSnapToResizeGuides=qb;nc.computeRefPoints=function(ma){var Aa=ma.x,xb=ma.y,P=ma.width;ma=ma.height;return{left:Aa,top:xb,hCenter:Aa+P/2,vCenter:xb+ma/2,right:Aa+P,bottom:xb+ma,width:P,height:ma}};nc.findEdgesInAlignment=function(ma,Aa,xb,P,wa,Xa,Db,mc,Sb,Tc){xb=void 0===xb?15:xb;Xa=void 0===Xa?0:Xa;Db=void 0===Db?0:Db;mc=void 0===mc?0:mc;Sb=void 0===Sb?0:Sb;Tc=void 0===Tc?0:Tc;for(var gd=[],se=[],Cf=0;Cf<nc.edges.length;Cf++){var me=$jscomp.makeIterator(nc.edges[Cf]),
Se=me.next().value,Ze=me.next().value;me=me.next().value;var yf=ma[Ze],vd=Aa[me],Ve=Math.max(yf,vd)-Math.min(yf,vd);Ve>xb||!(P&&!P.includes(Ze)||wa&&!wa.includes(me))&&("vertical"===Se?gd:se).push({delta:Ve,edgeA:Ze,edgeB:me,edgeAVal:yf,edgeBVal:vd,refPointsA:ma,refPointsB:Aa,distLeft:Xa,distTop:Db,distRight:mc,distBottom:Sb,maxDist:Tc})}return gd.length||se.length?{vertical:gd,horizontal:se}:null};nc.findAlignedMorphs=function(ma,Aa,xb,P,wa,Xa){xb=void 0===xb?15:xb;P=void 0===P?Infinity:P;for(var Db,
mc=nc.computeRefPoints(ma.bounds()),Sb=0;Sb<Aa.length;Sb++){var Tc=Aa[Sb];if(Tc!==ma){var gd=nc.computeRefPoints(Tc.bounds()),se=Math.max(0,mc.left-gd.right),Cf=Math.max(0,gd.left-mc.right),me=Math.max(0,mc.top-gd.bottom),Se=Math.max(0,gd.top-mc.bottom);Math.max(Se,me,Cf,se)>P||!(gd=nc.findEdgesInAlignment(mc,gd,xb,wa,Xa,se,me,Cf,Se,Math.max(Se,me,Cf,se)))||(Db||(Db=new Map),Db.set(Tc,gd))}}ma=ma.owner;Aa=nc.computeRefPoints(ma.innerBounds());if(xb=nc.findEdgesInAlignment(mc,Aa,xb))Db||(Db=new Map),
Db.set(ma,xb);return Db};nc.findMorphsWithSimilarWidthOrHeight=function(ma,Aa,xb,P,wa){P=void 0===P?15:P;wa=void 0===wa?Infinity:wa;for(var Xa,Db=nc.computeRefPoints(ma.bounds()),mc=0;mc<xb.length;mc++){var Sb=xb[mc];if(Sb!==ma){var Tc=nc.computeRefPoints(Sb.bounds()),gd=Math.max(0,Db.left-Tc.right),se=Math.max(0,Tc.left-Db.right),Cf=Math.max(0,Db.top-Tc.bottom),me=Math.max(0,Tc.top-Db.bottom),Se=Math.min(me,Cf,se,gd),Ze=Math.max(me,Cf,se,gd);if(!(Math.max(me,Cf,se,gd)>wa)){se=Db;gd=se.width;se=se.height;
me=Tc;Cf=me.width;me=me.height;var yf=Cf-gd,vd=me-se;("x"===Aa||"xy"===Aa)&&Math.abs(yf)<=P&&(Xa||(Xa=new Map),Xa.set(Sb,{similarIn:"width",minDist:Se,maxDist:Ze,refPointsA:Db,refPointsB:Tc,valA:gd,valB:Cf,delta:yf}));("y"===Aa||"xy"===Aa)&&Math.abs(vd)<=P&&(Xa||(Xa=new Map),Xa.set(Sb,{similarIn:"height",minDist:Se,maxDist:Ze,refPointsA:Db,refPointsB:Tc,valA:se,valB:me,delta:vd}))}}}return Xa};nc.closest=function(ma,Aa,xb,P,wa,Xa,Db,mc){mc=void 0===mc?!0:mc;var Sb=P[ma],Tc=wa[ma],gd=Xa[ma];Aa=Db[ma];
for(var se,Cf,me,Se,Ze=0;Ze<wa.length;Ze++)ma===Ze||Sb<wa[Ze]||se&&wa[se.index]>=wa[Ze]||mc&&Db[ma]<Xa[Ze]||Xa[ma]>Db[Ze]||(se={index:Ze,dist:Sb-wa[Ze],refPointsA:xb[ma],refPointsB:xb[Ze]});for(Sb=0;Sb<P.length;Sb++)ma===Sb||Tc>P[Sb]||Cf&&P[Cf.index]<=P[Sb]||mc&&Db[ma]<Xa[Sb]||Xa[ma]>Db[Sb]||(Cf={index:Sb,dist:P[Sb]-Tc,refPointsA:xb[ma],refPointsB:xb[Sb]});for(Tc=0;Tc<Db.length;Tc++)ma===Tc||gd<Db[Tc]||me&&Db[me.index]>=Db[Tc]||mc&&P[ma]>wa[Tc]||wa[ma]<P[Tc]||(me={index:Tc,dist:gd-Db[Tc],refPointsA:xb[ma],
refPointsB:xb[Tc]});for(Db=0;Db<Xa.length;Db++)ma===Db||Aa>Xa[Db]||Se&&Xa[Se.index]<=Xa[Db]||mc&&P[ma]>wa[Db]||wa[ma]<P[Db]||(Se={index:Db,dist:Xa[Db]-Aa,refPointsA:xb[ma],refPointsB:xb[Db]});return{l:se,r:Cf,t:me,b:Se}};nc.computeClosestMorphs=function(ma){for(var Aa=[],xb=[],P=[],wa=[],Xa=[],Db=[],mc=0;mc<ma.length;mc++){var Sb=nc.computeRefPoints(ma[mc].bounds());Xa.push(Sb);var Tc=Sb.right,gd=Sb.top,se=Sb.bottom;Aa.push(Sb.left);xb.push(Tc);P.push(gd);wa.push(se)}for(mc=0;mc<ma.length;mc++)Db.push(nc.closest(mc,
ma,Xa,Aa,xb,P,wa));return Db};nc.fun=Bb;nc.pt=Kb;nc.Color=lc;nc.morph=bc;nc.cachedGuideLines=new WeakMap;nc.guideWidth=1;nc.guideColor=nc.Color.orange.lighter();nc.removeSnapToGuidesOf=ra;nc.removeSnapToGuidesOf=ra;nc.showAndSnapToGuides=Za;nc.showAndSnapToGuides=Za;nc.showAndSnapToResizeGuides=qb;nc.showAndSnapToResizeGuides=qb;nc.edges=[["vertical","top","top"],["vertical","vCenter","top"],["vertical","bottom","top"],["vertical","top","vCenter"],["vertical","vCenter","vCenter"],["vertical","bottom",
"vCenter"],["vertical","top","bottom"],["vertical","vCenter","bottom"],["vertical","bottom","bottom"],["horizontal","left","left"],["horizontal","hCenter","left"],["horizontal","right","left"],["horizontal","left","hCenter"],["horizontal","hCenter","hCenter"],["horizontal","right","hCenter"],["horizontal","left","right"],["horizontal","hCenter","right"],["horizontal","right","right"]];var Ob=lively.FreezerRuntime.recorderFor("lively.halos/markers.js");Ob.show=sc;Ob.showRect=function(ma,Aa,xb){var P=
Ob.BoundsMarker.highlightBounds(Aa);return xb?Ob.showInLoop(ma,P,Aa):Ob.showThenHide(ma,P)};Ob.showInLoop=function(ma,Aa,xb){var P;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){switch(wa.nextAddress){case 1:return Ob.showThenHide(ma,Aa,!1),wa.yield(Ob.promise.delay(300),2);case 2:P=!1,Ob.once(ma,"onMouseDown",function(){return P=!0}),Ob.once(ma,"hideMarkers",function(){return P=!0});case 3:if(P){wa.jumpTo(4);break}return wa.yield(Aa.retract(xb),3);case 4:Aa.fadeOut(2E3),wa.jumpToEnd()}})};
Ob.showThenHide=function(ma,Aa,xb){xb=void 0===xb?3:xb;if(ma){var P=Array.isArray(Aa)?Aa:[Aa];P.forEach(function(wa){return ma.addMorph(wa)});xb&&setTimeout(function(){return P.forEach(function(wa){return wa.fadeOut(2E3)})},1E3*xb);return Aa}};Ob.showLine=function(ma,Aa,xb){xb=void 0===xb?3E3:xb;var P=Aa.start;Aa=Aa.end.subPt(P);var wa=ma.addMorph({position:P,rotation:Aa.theta(),border:{width:1,color:Ob.Color.red},width:Aa.fastR(),height:0});xb&&setTimeout(function(){return wa.fadeOut()},xb);return wa};
Ob.showConnector=wd;Ob.obj=Td;Ob.promise=Xc;Ob.string=Wd;Ob.pt=Kb;Ob.Color=lc;Ob.Rectangle=$c;Ob.rect=Pc;Ob.morph=bc;Ob.easings=md;Ob.Path=ge;Ob.Icon=Qe;Ob.Morph=kf;Ob.MorphicEnv=ke;Ob.connect=cc;Ob.once=Hc;Ob.disconnect=Nd;Ob.show=sc;Ob.show=sc;(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),xb=Aa.hasOwnProperty("BoundsMarker")&&"function"===typeof Aa.BoundsMarker?Aa.BoundsMarker:Aa.BoundsMarker=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return ec(xb,ma,[{key:Symbol.for("lively-instance-initialize"),value:function(){ec._get(Object.getPrototypeOf(xb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{borderWidth:0,fill:Ob.Color.transparent,reactsToPointer:!1,hasFixedPosition:!0})}},{key:"isEpiMorph",get:function(){return!0}},{key:"markerLength",value:function(P){P=P.insetBy(-2);P=Math.min(P.width,P.height);return Math.max(4,Math.floor(10>P/10?P/2-5:P/10))}},{key:"createMarkerEdge",value:function(){return Ob.morph({fill:Ob.Color.red,
reactsToPointer:!1,borderRadius:10})}},{key:"ensureMarkerCorners",value:function(){var P=this.topLeftH||(this.topLeftH=this.addMorph(this.createMarkerEdge())),wa=this.topLeftV||(this.topLeftV=this.addMorph(this.createMarkerEdge())),Xa=this.topRightH||(this.topRightH=this.addMorph(this.createMarkerEdge())),Db=this.topRightV||(this.topRightV=this.addMorph(this.createMarkerEdge())),mc=this.bottomRightH||(this.bottomRightH=this.addMorph(this.createMarkerEdge())),Sb=this.bottomRightV||(this.bottomRightV=
this.addMorph(this.createMarkerEdge())),Tc=this.bottomLeftH||(this.bottomLeftH=this.addMorph(this.createMarkerEdge())),gd=this.bottomLeftV||(this.bottomLeftV=this.addMorph(this.createMarkerEdge()));return[P,wa,Xa,Db,mc,Sb,Tc,gd]}},{key:"alignWithMorph",value:function(P){return this.alignWithBounds(P.globalBounds().translatedBy($world.scroll.negated()))}},{key:"alignWithBounds",value:function(P){this.alignWithRect(P.insetBy(-20));return this.alignWithRect(P,!0)}},{key:"alignWithRect",value:function(P,
wa){var Xa=this.ensureMarkerCorners(),Db=this.markerLength(P),mc=[P.topLeft().addXY(0,0).extent(Ob.pt(Db,5)),P.topLeft().addXY(0,0).extent(Ob.pt(5,Db)),P.topRight().addXY(-Db,0).extent(Ob.pt(Db,5)),P.topRight().addXY(-5,0).extent(Ob.pt(5,Db)),P.bottomRight().addXY(-5,-Db).extent(Ob.pt(5,Db)),P.bottomRight().addXY(-Db,-5).extent(Ob.pt(Db,5)),P.bottomLeft().addXY(0,-5).extent(Ob.pt(Db,5)),P.bottomLeft().addXY(0,-Db).extent(Ob.pt(5,Db))];Xa.forEach(function(Sb,Tc){return Sb.setBounds(mc[Tc])});wa&&(this.adjustOrigin(P.center()),
this.opacity=0,this.scale=1.5,this.animate({opacity:1,scale:1,duration:300}));return this}},{key:"retract",value:function(P){var wa=this,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){if(1==Db.nextAddress)return Db.yield(wa.animate({scale:Math.max(30/P.width,1.05)}),2);Xa=wa.center;return Db.yield(wa.animate({center:Xa,scale:1,duration:300,easing:Ob.easings.inOutExpo}),0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BoundsMarker"}},{key:"highlightMorph",value:function(P){return(new this).alignWithMorph(P)}},
{key:"highlightBounds",value:function(P){return(new this).alignWithBounds(P)}}],Aa,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:2332,end:6009})})(Ob.Morph);var Zd=Ca("S",function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),xb=Aa.hasOwnProperty("StatusMessage")&&
"function"===typeof Aa.StatusMessage?Aa.StatusMessage:Aa.StatusMessage=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"relayout",value:function(){this.title=Ob.string.truncate(this.message,(this.width/15).toFixed(),"...")}},{key:"isEpiMorph",value:function(){return!0}},{key:"isStatusMessage",value:function(){return!0}},{key:"setMessage",value:function(P,wa){this.message=P;this.color=wa}},{key:"slideTo",
value:function(P){var wa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==Xa.nextAddress)return wa.sliding=wa.animate({position:P,duration:500}),Xa.yield(wa.sliding,2);wa.sliding=!1;Xa.jumpToEnd()})}},{key:"expand",value:function(){var P=this,wa,Xa,Db,mc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sb){if(1==Sb.nextAddress)return P.expandable?P.sliding?Sb.yield(P.sliding,2):Sb.jumpTo(2):Sb.return();wa=P.world();if(!wa||P.isMaximized)return Sb.return();P.isMaximized=
!0;P.stayOpen=!0;Xa=P.getSubmorphNamed("message text");Xa.lineWrapping=!1;Object.assign(Xa,{clipMode:"auto",fixedWidth:!0,selectable:!0});P.expandedContent&&(Xa.value=P.expandedContent);Xa.fit();Db=Xa.textBounds().extent();mc=wa.visibleBounds();Db.y>mc.extent().y&&(Db.y=mc.extent().y-20);Db.x>mc.extent().x&&(Db.x=mc.extent().x-20);Db=P.extent.maxPt(Db);P.animate({extent:Db,center:mc.center(),duration:200});P.relayout();P.focus();Sb.jumpToEnd()})}},{key:"fit",value:function(){var P=this.getSubmorphNamed("message text");
P&&(this.extent=Ob.pt(100,35).maxPt(P.textBounds().extent()),this.relayout())}},{key:"focus",value:function(){var P=this.getSubmorphNamed("message text");P&&P.focus()}},{key:"onMouseUp",value:function(P){this.expand()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessage"}},{key:"properties",get:function(){return{extent:{defaultValue:Ob.pt(200,100)},stayOpen:{defaultValue:!1},slidable:{defaultValue:!0},isMaximized:{defaultValue:!1},expandable:{initialize:function(){this.expandable=
!0}},maxLines:{defaultValue:Infinity},name:{defaultValue:"messageMorph"},master:{initialize:function(){this.master={auto:"styleguide://System/message"}}},message:{after:["submorphs","extent"],set:function(P){this.setProperty("message",P);var wa=this.getSubmorphNamed("message text");if(wa){wa.value=P;var Xa=wa.documentEndPosition;Xa.row>this.maxLines&&(wa.replace({start:{row:this.maxLines,column:0},end:Xa},"...\n"),this.expandedContent||(this.expandedContent=P));Xa=wa.documentEndPosition;0!==Xa.column&&
wa.insertText("\n",Xa)}}},title:{isStyleProp:!0,derived:!0,set:function(P){this.getSubmorphNamed("message title").value=P},get:function(){return this.getSubmorphNamed("message title").value}},color:{after:["submorphs"],derived:!0,get:function(){return this.get("message icon").fontColor},set:function(P){this.get("message icon").fontColor=P;this.get("message icon")._parametrizedProps&&(this.get("message icon")._parametrizedProps.fontColor=P)}},submorphs:{after:["extent"],initialize:function(){this.submorphs=
[{name:"message icon",type:"label",value:Ob.Icon.textAttribute("check-circle")},{name:"message text",type:"text"},{name:"message title",type:"label"},{name:"close button",type:"button"}];Ob.connect(this.getSubmorphNamed("close button"),"fire",this,"remove");Ob.connect(this,"extent",this,"relayout")}}}}}],Aa,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:6053,end:10382})}(Ob.Morph));Ob.StatusMessage=Zd;Ob.StatusMessage=Zd;Ob.StatusMessage=Zd;var Id=Ca("b",function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),xb=Aa.hasOwnProperty("StatusMessageForMorph")&&"function"===typeof Aa.StatusMessageForMorph?Aa.StatusMessageForMorph:Aa.StatusMessageForMorph=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"alignAtBottomOf",
value:function(P){var wa=this.world();wa&&(this.bringToFront(),this.fit(),this.width=P.bounds().width,this.relayout(),P.world()&&(this.position=P.owner.worldPoint(P.bounds().bottomLeft())),P=wa.visibleBounds(),P=this.bounds().top()+this.height-P.bottom(),0<P&&this.moveBy(Ob.pt(0,-P)))}},{key:"onMouseUp",value:function(P){}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessageForMorph"}},{key:"properties",get:function(){return{slidable:{defaultValue:!1},renderOnGPU:{defaultValue:!0},
removeOnTargetMorphChange:{defaultValue:!0},targetMorph:{defaultValue:null,get:function(){var P=this.getProperty("targetMorph");return P&&$world.getMorphWithId(P)},set:function(P){this.setProperty("targetMorph",P?P.id:null);this.alignAtBottomOf(P)}},expandable:{after:["submorphs"],set:function(P){this.setProperty("expandable",P);if(P){var wa=this.getSubmorphNamed("expand button")||this.addMorph({name:"expand button",type:"button"});Ob.connect(wa,"fire",this,"expand")}else this.getSubmorphNamed("expand button")&&
(this.getSubmorphNamed("expand button").remove(),Ob.disconnect(wa,"fire",this,"expand"))}}}}}],Aa,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10607,end:12475})}(Ob.StatusMessage));Ob.StatusMessageForMorph=Id;Ob.StatusMessageForMorph=Id;Ob.StatusMessageForMorph=Id;Ob.showConnector=wd;Ob.showConnector=
wd;var kb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js");kb.Morph=kf;kb.Label=$d;kb.StyleSheet=le;kb.HorizontalLayout=Dc;kb.Path=ge;kb.Text=Ic;kb.GridLayout=Vb;kb.morph=bc;kb.Icon=Qe;kb.createMorphSnapshot=Lc;kb.Color=lc;kb.pt=Kb;kb.rect=Pc;kb.Rectangle=$c;kb.LinearGradient=dd;kb.obj=Td;kb.PropertyPath=Hd;kb.promise=Xc;kb.properties=Ld;kb.num=wc;kb.arr=rb;kb.connect=cc;kb.signal=Gb;kb.disconnect=Nd;kb.disconnectAll=Oa;kb.once=Hc;kb.showAndSnapToGuides=Za;kb.showAndSnapToResizeGuides=qb;
kb.removeSnapToGuidesOf=ra;kb.resource=ab;kb.show=sc;kb.haloBlue=kb.Color.rgb(23,160,251);kb.componentAccent=kb.Color.magenta;kb.derivedAccent=kb.Color.purple;var Eb=function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("Halo")&&"function"===typeof Aa.Halo?Aa.Halo:Aa.Halo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"relayout",value:function(){this.alignWithTarget()}},
{key:"keybindings",get:function(){return[{keys:{mac:"Meta-C",win:"Ctrl-C"},command:{command:"clipboard copy",passEvent:!0}}]}},{key:"commands",get:function(){return[{name:"clipboard copy",doc:"copy selected morph(s) to clipboard",scrollCursorIntoView:!1,exec:function(P){P.copyHalo().copyToClipBoard()}}]}},{key:"removeIfDetached",value:function(){var P=this;setTimeout(function(){P.target.owner||P.remove()})}},{key:"initLayout",value:function(){var P=this.layout=new kb.GridLayout({autoAssign:!1,fitToCell:!1,
columns:[0,{fixed:36,paddingRight:10},2,{fixed:26},4,{fixed:26},6,{fixed:36,paddingLeft:10}],rows:[0,{fixed:36,paddingBottom:10},2,{fixed:26},4,{fixed:26},6,{fixed:26},7,{fixed:36,paddingTop:10}],grid:[["menu",null,"grab",null,"drag",null,"close"],[null,null,null,null,null,null,null],["copy",null,null,null,null,null,"edit"],[null,null,null,null,null,null,null],["component",null,null,null,null,null,"inspect"],[null,null,null,null,null,null,null],["rotate",null,null,null,null,null,"resize"],[null,"name",
"name","name","name","name",null]]});P.col(1).row(7).group.align="center";P.col(1).row(7).group.resize=!1}},{key:"initButtons",value:function(){this.submorphs=[].concat($jscomp.arrayFromIterable(this.ensureResizeHandles()),$jscomp.arrayFromIterable(this.resizeOnly?[]:[this.closeHalo(),this.dragHalo(),this.grabHalo(),this.menuHalo(),this.inspectHalo(),this.editHalo(),this.copyHalo(),this.componentHalo(),this.rotateHalo(),this.nameHalo(),this.originHalo()]))}},{key:"isEpiMorph",get:function(){return!0}},
{key:"isHaloItem",get:function(){return!0}},{key:"isHalo",get:function(){return!0}},{key:"borderBox",get:function(){return this.getSubmorphNamed("border-box")||this.addMorphBack(kb.morph({name:"border-box",fill:kb.Color.transparent,borderColor:this.target.isComponent?kb.componentAccent:kb.haloBlue,borderWidth:1}))}},{key:"pointerId",get:function(){return this.state?this.state.pointerId:null}},{key:"pointerId",set:function(P){this.state||(this.state={});this.state.pointerId=P}},{key:"prepareTarget",
value:function(P){if(!kb.obj.isArray(P))return P;if(1>=P.length)return P[0];P=P[0].world().addMorph(new kb.MultiSelectionTarget({selectedMorphs:P}));P.alignWithSelection();P.modifiesSelectedMorphs=!0;return P}},{key:"refocus",value:function(P){this.target=P;this.alignWithTarget()}},{key:"alignWithTarget",value:function(P){if((!P||["extent","position","scale","rotation"].includes(P.prop))&&!this.active&&this.target){P=this.target.world()||$world;var wa=P.visibleBounds(),Xa=this.target.globalBounds(),
Db=Xa.insetBy(-36).intersection(wa);wa=Xa.intersection(wa);this.layout&&this.layout.disable();this.setBounds(Db.translatedBy(P.scroll.negated()));this.borderBox.setBounds($world.transformRectToMorph(this,wa));this.state.activeButton?(this.buttonControls.forEach(function(mc){return mc.visible=!1}),this.ensureResizeHandles().forEach(function(mc){return mc.visible=!1}),this.state.activeButton.visible=!0,this.updatePropertyDisplay(this.state.activeButton)):(this.changingName&&this.nameHalo().toggleActive([!1]),
this.ensureResizeHandles().forEach(function(mc){return mc.visible=!0}),this.buttonControls.forEach(function(mc){mc.visible=!0}),this.propertyDisplay.disable());this.nameHalo().alignInHalo();this.ensureResizeHandles().forEach(function(mc){return mc.alignInHalo()});this.resizeOnly||this.originHalo().alignInHalo();this.layout&&this.layout.enable();return this}}},{key:"detachFromTarget",value:function(){var P=this.target;P&&(kb.disconnect(P,"onChange",this,"alignWithTarget"),kb.disconnect(P,"onOwnerChanged",
this,"removeIfDetached"),P instanceof kb.MultiSelectionTarget?(P.modifiesSelectedMorphs=!1,P.remove()):"function"===typeof P.detachedHalo&&P.detachedHalo(this))}},{key:"remove",value:function(){this.detachFromTarget();ec._get(Object.getPrototypeOf(xb.prototype),"remove",this).call(this)}},{key:"morphsContainingPoint",value:function(P){return P}},{key:"propertyDisplay",get:function(){return kb.HaloPropertyDisplay.for(this)}},{key:"nameHalo",value:function(){return kb.NameHaloItem.for(this)}},{key:"closeHalo",
value:function(){return kb.CloseHaloItem.for(this)}},{key:"grabHalo",value:function(){return kb.GrabHaloItem.for(this)}},{key:"dragHalo",value:function(){return kb.DragHaloItem.for(this)}},{key:"menuHalo",value:function(){return kb.MenuHaloItem.for(this)}},{key:"inspectHalo",value:function(){return kb.InspectHaloItem.for(this)}},{key:"editHalo",value:function(){return kb.EditHaloItem.for(this)}},{key:"rotateHalo",value:function(){return kb.RotateHaloItem.for(this)}},{key:"copyHalo",value:function(){return kb.CopyHaloItem.for(this)}},
{key:"originHalo",value:function(){return kb.OriginHaloItem.for(this)}},{key:"componentHalo",value:function(){return kb.ComponentHaloItem.for(this)}},{key:"buttonControls",get:function(){return this.submorphs.filter(function(P){return P.isHaloItem&&!P.isResizeHandle})}},{key:"addMorphToSelection",value:function(P){var wa=this,Xa,Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mc){if(1==mc.nextAddress){Xa=wa.world();Db=wa.target.isMorphSelection?wa.target.selectedMorphs:[wa.target];
if(Db.includes(P))return mc.return();wa.remove();return mc.yield(Xa.showHaloForSelection([].concat($jscomp.arrayFromIterable(Db),[P]),wa.state.pointerId),2)}return mc.return(mc.yieldResult)})}},{key:"removeMorphFromSelection",value:function(P){var wa=this,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){if(1==Db.nextAddress){Xa=wa.world();wa.remove();if(!wa.target.isMorphSelection)return Db.jumpTo(0);kb.arr.remove(wa.target.selectedMorphs,P);return Db.yield(Xa.showHaloForSelection(wa.target.selectedMorphs,
wa.state.pointerId),3)}return Db.return(Db.yieldResult)})}},{key:"isAlreadySelected",value:function(P){return this.target==P||this.target.isMorphSelection&&this.target.selectsMorph(P)}},{key:"updateBoundsFor",value:function(P,wa,Xa,Db,mc){var Sb={topLeft:kb.rect(-1,-1,1,1),topCenter:wa?kb.rect(1,-1,0,1):kb.rect(0,-1,0,1),topRight:kb.rect(0,-1,1,1),rightCenter:wa?kb.rect(0,1,1,1):kb.rect(0,0,1,0),bottomRight:kb.rect(0,0,1,1),bottomCenter:wa?kb.rect(1,0,0,1):kb.rect(0,0,0,1),bottomLeft:kb.rect(-1,0,
1,1),leftCenter:wa?kb.rect(-1,1,1,0):kb.rect(-1,0,1,0)}[P];mc=Sb.x;var Tc=Sb.y,gd=Sb.width;Sb=Sb.height;Xa=wa?this.proportionalDelta(P,Xa,Db):Xa;P=kb.rect(Xa.x*mc,Xa.y*Tc,Xa.x*gd,Xa.y*Sb);this.active=!0;this.target.setBounds(Db.insetByRect(P));(this.target.isPolygon||this.target.isPath)&&this.target.moveBy(this.target.origin.negated());this.active=!1;this.alignWithTarget();this.world().withTopBarDo(function(se){if(se.activeSideBars.includes("Styling Palette"))se.stylingPalette.onHierarchyChange()})}},
{key:"proportionalDelta",value:function(P,wa,Xa){var Db=Xa.width,mc=Xa.height;Xa={topLeft:kb.pt(-1,-1),topCenter:kb.pt(0,-1),topRight:kb.pt(1,-1),leftCenter:kb.pt(-1,0),rightCenter:kb.pt(1,0),bottomLeft:kb.pt(-1,1),bottomCenter:kb.pt(0,1),bottomRight:kb.pt(1,1)};var Sb=Db/Math.max(Db,mc),Tc=mc/Math.max(mc,Db);Db={topLeft:kb.pt(-Sb,-Tc),topCenter:kb.pt(1/(2*mc/Db),-1),topRight:kb.pt(Sb,-Tc),leftCenter:kb.pt(-1,mc/(2*Db)),rightCenter:kb.pt(1,mc/(3*Db)),bottomLeft:kb.pt(-Sb,Tc),bottomCenter:kb.pt(1/
(2*mc/Db),1),bottomRight:kb.pt(Sb,Tc)};Xa=Xa[P];return Db[P].scaleBy(Xa.dotProduct(wa)/Xa.dotProduct(Xa))}},{key:"ensureResizeHandles",value:function(){return kb.ResizeHandle.resizersFor(this)}},{key:"updatePropertyDisplay",value:function(P){P=P.valueForPropertyDisplay();"undefined"!==typeof P?this.propertyDisplay.displayProperty(P):this.propertyDisplay.disable()}},{key:"toggleDiagonal",value:function(P,wa){if(!kb.rect(0).sides.includes(wa)){var Xa=this.getSubmorphNamed("diagonal");if(P){P=this.target.globalBounds();
var Db=P.width,mc=P.height;P=this.localize(kb.pt(P.x,P.y)).extent(kb.pt(Db,mc)).scaleRectTo(this.innerBounds());Db={topLeft:[kb.pt(Db,mc),kb.pt(0,0)],topRight:[kb.pt(0,mc),kb.pt(Db,0)],bottomRight:[kb.pt(0,0),kb.pt(Db,mc)],bottomLeft:[kb.pt(Db,0),kb.pt(0,mc)]};Xa?Xa.setBounds(P):(Xa=$jscomp.makeIterator(Db[wa]),wa=Xa.next().value,Xa=Xa.next().value,Db=new kb.LinearGradient({stops:[{offset:0,color:kb.Color.orange.withA(0)},{offset:.2,color:kb.Color.orange},{offset:.8,color:kb.Color.orange},{offset:1,
color:kb.Color.orange.withA(0)}]}),Xa=this.addMorphBack(new kb.Path({opacity:0,name:"diagonal",borderStyle:"dotted",borderWidth:5,bounds:P,borderColor:Db,vertices:[wa,Xa]})),Xa.setBounds(P),Xa.animate({opacity:1,duration:500}))}else Xa&&Xa.fadeOut(500)}}},{key:"toggleRotationIndicator",value:function(P,wa){var Xa=this.getSubmorphNamed("rotationIndicator");P&&wa?(P=this.getSubmorphNamed("origin").center,Xa=Xa||this.addMorphBack(new kb.Path({name:"rotationIndicator",borderColor:kb.haloBlue,borderWidth:1,
vertices:[]})),Xa.setBounds(wa.bounds().union(this.innerBounds())),Xa.vertices=[Xa.localizePointFrom(P,this),Xa.localizePointFrom(wa.center,this)]):Xa&&Xa.remove()}},{key:"toggleMorphHighlighter",value:function(P,wa,Xa){Xa=void 0===Xa?!1:Xa;if(wa)if(wa.onHaloGrabover)wa.onHaloGrabover(P);else Xa=kb.MorphHighlighter.for(this,wa,Xa),P&&wa&&wa!=this.world()?Xa&&Xa.show(wa):Xa&&Xa.deactivate()}},{key:"onMouseDown",value:function(P){var wa=P.state.clickedOnMorph;if(!P.isCommandKey()&&wa==this.borderBox)return this.remove();
if(P.isShiftDown()&&P.isCommandKey())P=this.target.isMorphSelection?this.target.morphBeneath(P.position):this.morphBeneath(P.position),this.isAlreadySelected(P)?this.removeMorphFromSelection(P):this.addMorphToSelection(P);else{if(wa==this.borderBox&&P.isCommandKey()){var Xa=P.world.morphsContainingPoint(P.position).filter(function(Db){return Db.halosEnabled});(Xa=Xa.slice(Xa.indexOf(this.target)+1)[0]||Xa[0]||P.world)&&P.world.showHaloFor(Xa,P.domEvt.pointerId);this.remove()}wa==this&&P.isCommandKey()&&
(Xa=this.morphBeneath(P.position),P.world.showHaloFor(Xa,P.domEvt.pointerId));wa==this&&this.remove()}}},{key:"onKeyUp",value:function(P){this.changingName||this.buttonControls.map(function(wa){return wa.onKeyUp(P)})}},{key:"getMesh",value:function(P,wa){var Xa=P.x;P=P.y;wa=void 0===wa?kb.pt(0,0):wa;var Db=this.world().visibleBounds(),mc=Db.height;Db=Db.width;var Sb={borderStyle:"dotted",borderWidth:2,borderColor:kb.Color.orange};Sb=this.get("mesh")||this.addMorph(new kb.Morph({name:"mesh",styleClasses:["halo-mesh"],
extent:kb.pt(Db,mc),fill:null,submorphs:[new kb.Path(Object.assign({name:"vertical"},Sb)),new kb.Path(Object.assign({name:"horizontal"},Sb))]}));Sb.globalPosition=wa;Sb.getSubmorphNamed("vertical").vertices=[kb.pt(Xa,0).subPt(wa),kb.pt(Xa,mc).subPt(wa)];Sb.getSubmorphNamed("horizontal").vertices=[kb.pt(0,P).subPt(wa),kb.pt(Db,P).subPt(wa)];return Sb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Halo"}},{key:"properties",get:function(){return{fill:{defaultValue:kb.Color.transparent},
resizeOnly:{defaultValue:!1},pointerId:{},hasFixedPosition:{defaultValue:!0},respondsToVisibleWindow:{defaultValue:!0},submorphs:{after:["target"],initialize:function(){this.initButtons();this.alignWithTarget()}},layout:{after:["submorphs"],initialize:function(){this.initLayout()}},hasTinyTarget:{derived:!0,get:function(){return 40>this.target.bounds().extent().dist(kb.pt(0))}},target:{get:function(){return this.state?this.state.target:null},set:function(P){this.state||(this.state={});var wa=!!this.state.target;
this.detachFromTarget();P=this.prepareTarget(P);this.state.target=P;wa&&this.alignWithTarget();kb.connect(P,"onChange",this,"alignWithTarget");kb.connect(P,"onOwnerChanged",this,"removeIfDetached")}}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:979,end:17338})}(kb.Morph);Eb=kb.Halo;
var ad=Ca("H",Eb);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("HaloPropertyDisplay")&&"function"===typeof Aa.HaloPropertyDisplay?Aa.HaloPropertyDisplay:Aa.HaloPropertyDisplay=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"isHaloItem",get:function(){return!1}},{key:"halo",get:function(){return this.owner}},{key:"displayedValue",value:function(){return this.textString}},
{key:"displayProperty",value:function(P){var wa=this.halo.state.activeButton;P=String(P);this.visible=!0;this.textString=P;this.position=this.constructor.defaultPosition;this.bounds().insetBy(10).intersects(wa.bounds())&&(this.position=kb.pt(wa.topRight.x+10,this.position.y))}},{key:"disable",value:function(){this.position=this.constructor.defaultPosition;this.visible=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"HaloPropertyDisplay"}},{key:"morphName",get:function(){return"propertyDisplay"}},
{key:"defaultPosition",get:function(){return kb.pt(25,0)}},{key:"for",value:function(P){return P.getSubmorphNamed(this.morphName)||P.addMorph(new this({name:this.morphName}))}},{key:"properties",get:function(){return{name:{defaultValue:this.name},fill:{defaultValue:kb.Color.black.withA(.7)},borderRadius:{defaultValue:7},padding:{defaultValue:kb.Rectangle.inset(5)},visible:{defaultValue:!1},readOnly:{defaultValue:!0},fontSize:{defaultValue:12},fontColor:{defaultValue:kb.Color.white},position:{defaultValue:this.defaultPosition}}}}],
Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:17528,end:18866})})(kb.Label);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("MultiSelectionTarget")&&"function"===typeof Aa.MultiSelectionTarget?Aa.MultiSelectionTarget:Aa.MultiSelectionTarget=
function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"isHaloItem",get:function(){return!0}},{key:"isMorphSelection",get:function(){return!0}},{key:"selectsMorph",value:function(P){return this.selectedMorphs.includes(P)}},{key:"alignWithSelection",value:function(){var P=this.selectedMorphs.map(function(wa){return wa.globalBounds()}).reduce(function(wa,Xa){return wa.union(Xa)});this.setBounds(P)}},{key:"onGrab",
value:function(P){this.grabbingHand=P.hand;this.selectionGrabbed=!0;P.hand.grab(this.selectedMorphs);kb.once(P.hand,"dropMorphsOn",this,"onGrabEnd");kb.connect(P.hand,"position",this,"alignWithSelection")}},{key:"onGrabEnd",value:function(){this.selectionGrabbed=!1;kb.disconnectAll(this.grabbingHand)}},{key:"updateExtent",value:function(P){var wa=P.value.subPt(P.prevValue);this.selectedMorphs.forEach(function(Xa){return Xa.resizeBy(wa)})}},{key:"updatePosition",value:function(P){if(!this.selectionGrabbed){var wa=
P.value.subPt(P.prevValue);this.selectedMorphs.forEach(function(Xa){return Xa.moveBy(wa)})}}},{key:"updateRotation",value:function(P){var wa=this,Xa=P.value-P.prevValue;this.selectedMorphs.forEach(function(Db){var mc=Db.origin;Db.adjustOrigin(Db.localize(wa.worldPoint(kb.pt(0,0))));Db.rotation+=Xa;Db.adjustOrigin(mc)})}},{key:"updateScale",value:function(P){var wa=this,Xa=P.value-P.prevValue;this.selectedMorphs.forEach(function(Db){var mc=Db.origin;Db.adjustOrigin(Db.localize(wa.worldPoint(kb.pt(0,
0))));Db.scale+=Xa;Db.adjustOrigin(mc)})}},{key:"onChange",value:function(P){ec._get(Object.getPrototypeOf(xb.prototype),"onChange",this).call(this,P);if(this.modifiesSelectedMorphs){switch(P.prop){case "extent":this.updateExtent(P);break;case "scale":this.updateScale(P);break;case "position":this.updatePosition(P);break;case "rotation":this.updateRotation(P)}return P}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MultiSelectionTarget"}},{key:"properties",get:function(){return{visible:{defaultValue:!1},
modifiesSelectedMorphs:{defaultValue:!1},selectedMorphs:{defaultValue:[]},halosEnabled:{defaultValue:!1}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:18934,end:21205})})(kb.Morph);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("HaloItem")&&
"function"===typeof Aa.HaloItem?Aa.HaloItem:Aa.HaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"menuItems",value:function(){return[]}},{key:"init",value:function(){}},{key:"update",value:function(){}},{key:"stop",value:function(){}},{key:"valueForPropertyDisplay",value:function(){}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"HaloItem"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:15},nativeCursor:{defaultValue:"pointer"},fill:{defaultValue:kb.Color.gray.withA(.7)},grabbable:{defaultValue:!1},extent:{defaultValue:kb.pt(24,24)},halo:{}}}},{key:"for",value:function(P){return P.getSubmorphNamed(this.morphName)||P.addMorph(new this({halo:P,name:this.morphName}))}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21369,end:22042})})(kb.Morph);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("NameHolder")&&"function"===typeof Aa.NameHolder?Aa.NameHolder:Aa.NameHolder=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"onHoverIn",
value:function(P){this.highlightOnHover&&this.nameHolder.active&&(this.halo.toggleMorphHighlighter(!0,this.target),this.nameHolder.fontColor=kb.Color.orange)}},{key:"onHoverOut",value:function(P){this.highlightOnHover&&(this.halo.toggleMorphHighlighter(!1,this.target),this.nameHolder.fontColor=kb.Color.darkgray)}},{key:"accept",value:function(){this.target.name!==this.nameHolder.textString&&this.updateName(this.nameHolder.textString)}},{key:"onKeyDown",value:function(P){"Enter"==P.keyCombo?(this.accept(),
this.halo.focus(),P.stop()):ec._get(Object.getPrototypeOf(xb.prototype),"onKeyDown",this).call(this,P)}},{key:"onMouseUp",value:function(){kb.signal(this,"active",[!0,this])}},{key:"onMouseDown",value:function(P){this.nameHolder.fontColor=kb.Color.white;this.halo.toggleMorphHighlighter(!1,this.target)}},{key:"onKeyUp",value:function(P){P=this.nameHolder.textString;var wa=this.target.owner;this.validName=!wa||!wa.getSubmorphNamed(P)||this.target.name==P;kb.signal(this,"valid",[this.validName,P])}},
{key:"update",value:function(){var P=this;this.nameHolder.textString!==this.target.name&&(this.nameHolder.textString=this.target.name,this.whenRendered().then(function(){return P.nameHolder.fit()}))}},{key:"activate",value:function(){this.nameHolder.readOnly=!1;this.nameHolder.active=!0;this.nameHolder.animate({opacity:1})}},{key:"deactivate",value:function(){this.nameHolder.readOnly=!0;this.nameHolder.active=!1;this.nameHolder.animate({opacity:.3})}},{key:"updateName",value:function(P){if(!this.forceUniqueName||
this.validName)this.target.name=P,kb.signal(this,"active",[!1,this])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHolder"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Click to edit the morph's name"},draggable:{defaultValue:!1},fill:{defaultValue:kb.Color.transparent},forceUniqueName:{defaultValue:!1},halo:{},layout:{after:["nameHolder"],initialize:function(){this.layout=new kb.HorizontalLayout({resizeContainer:!0,spacing:7})}},nameHolder:{after:["submorphs"],
initialize:function(){this.nameHolder=this.addMorph(new kb.Text({fill:kb.Color.transparent,fontColor:kb.Color.white,fontWeight:"bold",active:!0}));kb.connect(this.nameHolder,"onBlur",this,"accept")}}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:22077,end:24659})})(kb.Morph);(function(ma){var Aa=
lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("NameHaloItem")&&"function"===typeof Aa.NameHaloItem?Aa.NameHaloItem:Aa.NameHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:Symbol.for("lively-instance-initialize"),value:function(P){ec._get(Object.getPrototypeOf(xb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,P);this.initComponentLink();
this.initNameHolders();this.validityIndicator=kb.Icon.makeLabel("check",{fontColor:kb.Color.green,fontSize:15,padding:kb.rect(4,6,4,0)});this.fill=this.halo.target.isComponent?kb.componentAccent:kb.haloBlue;this.alignInHalo()}},{key:"initComponentLink",value:function(){var P=this,wa=this.halo.target;if(wa&&!wa.isMorphSelection&&wa.master){var Xa=wa.master.determineMaster(wa),Db=Xa&&!!Xa.world(),mc=Xa?wa.master.getWorldUrlFor(Xa):"this project";wa=this.addMorph(kb.Icon.makeLabel(mc?"external-link-alt":
"exclamation-triangle",{nativeCursor:"pointer",fontColor:kb.Color.white,padding:kb.rect(8,0,-8,0),name:"master link",tooltip:"Located in "+mc}));mc&&kb.connect(wa,"onMouseDown",function(){Db?P.showLocalMaster(Xa):window.open(mc)})}}},{key:"showLocalMaster",value:function(P){var wa;if(wa=P.getWindow())wa.activate(),wa.minimized&&(wa.minimized=!1);P.show()}},{key:"targets",value:function(){return this.halo.target?this.halo.target.isMorphSelection?this.halo.target.selectedMorphs.map(function(P){return{target:P,
highlightOnHover:!0}}):[{target:this.halo.target,highlightOnHover:!1}]:[]}},{key:"initNameHolders",value:function(){var P=this;this.nameHolders=this.targets().map(function(wa){wa=new kb.NameHolder({halo:P.halo,highlightOnHover:wa.highlightOnHover,target:wa.target});kb.connect(wa,"active",P,"toggleActive");kb.connect(wa,"valid",P,"toggleNameValid");return wa});this.submorphs=[].concat($jscomp.arrayFromIterable(this.submorphs),$jscomp.arrayFromIterable(kb.arr.interpose(this.nameHolders,{extent:kb.pt(1,
28),fill:kb.Color.black.withA(.4)})))}},{key:"toggleActive",value:function(P){var wa=$jscomp.makeIterator(P);P=wa.next().value;var Xa=wa.next().value;if(this.halo.changingName!==P){this.halo.changingName=P;if(wa=this.get("master link"))wa.visible=wa.isLayoutable=!P;P?(this.nameHolders.forEach(function(Db){return Db!=Xa&&Db.deactivate()}),this.borderWidth=3,this.addMorph(this.validityIndicator),this.fill=kb.Color.darkGray,setTimeout(function(){return Xa.nameHolder.selectAll()})):(this.fill=kb.haloBlue,
this.nameHolders.forEach(function(Db){return Db!=Xa&&Db.activate()}),this.borderWidth=0,this.validityIndicator.remove());this.alignInHalo()}}},{key:"toggleNameValid",value:function(P){var wa=$jscomp.makeIterator(P);P=wa.next().value;wa=wa.next().value;(this.validName=P)?(this.conflictingMorph=null,this.borderColor=kb.Color.green,this.validityIndicator.nativeCursor="auto",this.validityIndicator.fontColor=kb.Color.green,kb.Icon.setIcon(this.validityIndicator,"check")):(this.conflictingMorph=this.get(wa),
this.borderColor=kb.Color.red,this.validityIndicator.fontColor=kb.Color.red,this.validityIndicator.nativeCursor="pointer",kb.Icon.setIcon(this.validityIndicator,"exclamation-circle"))}},{key:"alignInHalo",value:function(){kb.arr.zip(this.targets(),this.nameHolders).map(function(wa){var Xa=$jscomp.makeIterator(wa);wa=Xa.next().value.target;Xa=Xa.next().value;Xa.target=wa;Xa.update()});var P=this.halo.innerBounds().bottomCenter().addPt(kb.pt(0,2));this.topCenter=kb.pt(Math.max(P.x,30),Math.max(P.y,
80))}},{key:"onMouseDown",value:function(P){var wa=this,Xa=this.conflictingMorph;Xa&&(this.halo.toggleMorphHighlighter(!0,Xa),setTimeout(function(){return wa.halo.toggleMorphHighlighter(!1,Xa)},1E3))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHaloItem"}},{key:"morphName",get:function(){return"name"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:4},fill:{defaultValue:kb.haloBlue},borderColor:{defaultValue:kb.Color.green},layout:{initialize:function(){this.layout=
new kb.HorizontalLayout({resizeContainer:!0,spacing:0,align:"center",orderByIndex:!0})}}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:24661,end:29132})})(kb.HaloItem);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("CloseHaloItem")&&
"function"===typeof Aa.CloseHaloItem?Aa.CloseHaloItem:Aa.CloseHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"update",value:function(){var P=this.halo,wa=P.target.owner;wa.undoStart("close-halo");P.target.selectedMorphs?P.target.selectedMorphs.forEach(function(Xa){return Xa.remove()}):P.target.remove();wa.undoStop("close-halo");P.remove()}},{key:"onMouseDown",value:function(P){this.update()}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CloseHaloItem"}},{key:"morphName",get:function(){return"close"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["fas","fa-trash"]},draggable:{defaultValue:!1},tooltip:{defaultValue:"Remove this morph from the world"}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:29134,end:29759})})(kb.HaloItem);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("GrabHaloItem")&&"function"===typeof Aa.GrabHaloItem?Aa.GrabHaloItem:Aa.GrabHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"adjustTarget",value:function(P,wa){kb.PropertyPath("owner.layout.autoResize").get(P)&&!P.globalBounds().insetBy(10).containsPoint(wa)&&
(P=P.owner);return P}},{key:"valueForPropertyDisplay",value:function(){var P=this.hand,wa=this.halo,Xa=this.prevDropTarget,Db=P.world(),mc=P.findDropTarget(P.globalPosition,[wa.target],function(Sb){return!Sb.isHaloItem&&!Sb.ownerChain().some(function(Tc){return Tc.isHaloItem||!Tc.visible||0==Tc.opacity})});if(mc)return mc=this.adjustTarget(mc,P.globalPosition),wa.toggleMorphHighlighter(mc&&mc!=Db,mc,!0),Xa&&Xa!=mc&&wa.toggleMorphHighlighter(!1,Xa),(this.prevDropTarget=mc)&&mc.name}},{key:"init",value:function(P){var wa=
this.halo,Xa=wa.target.undoStart("grab-halo");Xa&&Xa.addTarget(wa.target.owner);this.hand=P;wa.target.onGrab({halo:wa,hand:P,isShiftDown:function(){return!1}});wa.state.activeButton=this;this.opacity=.3;var Db=kb.connect(P,"update",this,"update");kb.once(wa.target,"remove",function(){return Db.disconnect()})}},{key:"stop",value:function(P){var wa=this.halo,Xa=this.prevDropTarget,Db=wa.target.undoInProgress,mc=P.hand.findDropTarget(P.hand.globalPosition,[wa.target],function(Sb){return!Sb.isHaloItem&&
!Sb.ownerChain().some(function(Tc){return Tc.isHaloItem})});mc=this.adjustTarget(mc,P.hand.globalPosition);kb.disconnect(P.hand,"update",this,"update");kb.MorphHighlighter.interceptDrop(wa,mc,wa.target);Db.addTarget(mc);mc.onDrop(P);wa.state.activeButton=null;wa.alignWithTarget();wa.toggleMorphHighlighter(!1,Xa);kb.MorphHighlighter.removeHighlighters(wa);wa.target.undoStop("grab-halo");this.opacity=1}},{key:"update",value:function(){this.halo.alignWithTarget()}},{key:"onDragStart",value:function(P){this.init(P.hand)}},
{key:"onDragEnd",value:function(P){this.stop(P)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrabHaloItem"}},{key:"morphName",get:function(){return"grab"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["far","fa-hand-rock"]},tooltip:{defaultValue:"Grab the morph"},draggable:{defaultValue:!0}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:29761,end:32289})})(kb.HaloItem);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("DragHaloItem")&&"function"===typeof Aa.DragHaloItem?Aa.DragHaloItem:Aa.DragHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"valueForPropertyDisplay",value:function(){return this.halo.target.position}},
{key:"updateAlignmentGuide",value:function(P){var wa=this.halo.getSubmorphNamed("mesh");if(P)return wa=this.halo.getMesh(this.halo.target.worldPoint(kb.pt(0,0))),this.focus(),wa;wa&&wa.remove()}},{key:"init",value:function(){var P=this.halo.target;P.undoStart("drag-halo");this.halo.state.activeButton=this;this.actualPos=P.position;this.targetTransform=P.owner.getGlobalTransform().inverse()}},{key:"stop",value:function(){this.halo.target.undoStop("drag-halo");this.halo.state.activeButton=null;this.halo.alignWithTarget();
this.updateAlignmentGuide(!1);kb.removeSnapToGuidesOf(this.halo.target)}},{key:"update",value:function(P,wa,Xa){wa=void 0===wa?!1:wa;Xa=void 0===Xa?!1:Xa;this.actualPos=P=this.actualPos.addPt(this.targetTransform.transformDirection(P));wa&&(P=P.griddedBy(kb.pt(10,10)));this.halo.target.position=P;this.updateAlignmentGuide(wa);this.world().withTopBarDo(function(Db){if(Db.activeSideBars.includes("Styling Palette"))Db.stylingPalette.onHierarchyChange()});wa||kb.showAndSnapToGuides(this.halo.target,!0,
Xa,5,500)}},{key:"onDragStart",value:function(P){this.init()}},{key:"onDrag",value:function(P){this.update(P.state.dragDelta,P.isAltDown(),P.isCtrlDown())}},{key:"onDragEnd",value:function(P){this.stop()}},{key:"onKeyUp",value:function(P){this.updateAlignmentGuide(!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DragHaloItem"}},{key:"morphName",get:function(){return"drag"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},styleClasses:{defaultValue:["fas","fa-arrows-alt"]},
tooltip:{defaultValue:"Change the morph's position. Press (alt) while dragging to align the morph's position along a grid."}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:32291,end:34289})})(kb.HaloItem);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
xb=Aa.hasOwnProperty("InspectHaloItem")&&"function"===typeof Aa.InspectHaloItem?Aa.InspectHaloItem:Aa.InspectHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"onMouseDown",value:function(P){var wa=this;(function(){var Xa,Db,mc,Sb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tc){if(1==Tc.nextAddress)return Tc.yield(System.import("lively.ide/js/inspector.js"),2);Xa=Tc.yieldResult;
Db=Xa.default;(mc=wa.world().getSubmorphsByStyleClassName("Inspector").find(function(gd){return gd.targetObject==wa.halo.target}))&&(Sb=mc.getWindow())?(Sb.minimized=!1,Sb.activate(),Sb.animate({center:wa.world().visibleBounds().center(),duration:200})):Db.openInWindow({targetObject:wa.halo.target});wa.halo.remove();Tc.jumpToEnd()})})()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectHaloItem"}},{key:"morphName",get:function(){return"inspect"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Inspect the morph's local state"},
draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-cogs"]}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:34291,end:35208})})(kb.HaloItem);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("EditHaloItem")&&"function"===
typeof Aa.EditHaloItem?Aa.EditHaloItem:Aa.EditHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"onMouseDown",value:function(P){var wa=this;(P=this.world().getSubmorphsByStyleClassName("ObjectEditor").find(function(Xa){return Xa.target==wa.halo.target}))?(P=P.getWindow(),P.bringToFront(),P.minimized=!1,P.animate({center:this.world().visibleBounds().center(),duration:200})):$world.execCommand("open object editor",
{target:this.halo.target});this.halo.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditHaloItem"}},{key:"morphName",get:function(){return"edit"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Edit the morph's definition"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-wrench"]}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:35210,end:35990})})(kb.HaloItem);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("RotateHaloItem")&&"function"===typeof Aa.RotateHaloItem?Aa.RotateHaloItem:Aa.RotateHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:Symbol.for("lively-instance-initialize"),value:function(P){ec._get(Object.getPrototypeOf(xb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this,P);this.adaptAppearance(!1)}},{key:"angle",get:function(){return this.getProperty("angle")||0}},{key:"angle",set:function(P){this.setProperty("angle",P)}},{key:"scaleGauge",get:function(){return this.getProperty("scaleGauge")||null}},{key:"scaleGauge",set:function(P){this.setProperty("scaleGauge",P)}},{key:"initRotation",get:function(){return this.getProperty("initRotation")||0}},{key:"initRotation",set:function(P){this.setProperty("initRotation",
P)}},{key:"valueForPropertyDisplay",value:function(){var P=this.halo.target;return this.scaleGauge?P.scale.toFixed(4).toString():kb.num.toDegrees(P.rotation).toFixed(1)+"\u00b0"}},{key:"init",value:function(P){this.detachFromLayout();this.halo.target.undoStart("rotate-halo");this.halo.state.activeButton=this;this.angle=P;this.initRotation=this.halo.target.rotation;this.halo.toggleRotationIndicator(!0,this)}},{key:"initScale",value:function(P){this.detachFromLayout();this.halo.state.activeButton=this;
this.scaleGauge=P.scaleBy(1/this.halo.target.scale);this.halo.toggleRotationIndicator(!0,this)}},{key:"update",value:function(P){this.scaleGauge=null;P=this.initRotation+(P-this.angle);P=kb.num.toRadians(kb.num.detent(kb.num.toDegrees(P),10,45));this.halo.target.rotation=P;this.halo.toggleRotationIndicator(!0,this)}},{key:"updateScale",value:function(P){var wa=this.scaleGauge,Xa=this.halo;wa||(wa=this.scaleGauge=P.scaleBy(1/Xa.target.scale));this.angle=P.theta();this.initRotation=Xa.target.rotation;
Xa.target.scale=kb.num.detent(P.dist(kb.pt(0,0))/wa.dist(kb.pt(0,0)),.1,.5);Xa.toggleRotationIndicator(!0,this)}},{key:"stop",value:function(){this.attachToLayout();this.scaleGauge=null;this.halo.state.activeButton=null;this.halo.alignWithTarget();this.halo.toggleRotationIndicator(!1,this);this.halo.target.undoStop("rotate-halo");this.halo.ensureResizeHandles()}},{key:"adaptAppearance",value:function(P){this.styleClasses=["fas",P?"fa-search-plus":"fa-redo"];this.tooltip=P?"Scale morph":"Rotate morph"}},
{key:"detachFromLayout",value:function(){this.savedLayout=this.halo.layout;this.halo.layout=null}},{key:"attachToLayout",value:function(){this.halo.layout=this.savedLayout}},{key:"onDragStart",value:function(P){this.adaptAppearance(P.isShiftDown());P.isShiftDown()?this.initScale(P.position.subPt(this.halo.target.globalPosition)):this.init(P.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDrag",value:function(P){this.globalPosition=P.position.addPt(kb.pt(-10,-10));this.adaptAppearance(P.isShiftDown());
P.isShiftDown()?this.updateScale(P.position.subPt(this.halo.target.globalPosition)):this.update(P.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDragEnd",value:function(P){this.adaptAppearance(P.isShiftDown());this.stop()}},{key:"onKeyDown",value:function(P){this.adaptAppearance(P.isShiftDown())}},{key:"onKeyUp",value:function(P){this.adaptAppearance(P.isShiftDown())}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RotateHaloItem"}},{key:"morphName",get:function(){return"rotate"}},
{key:"properties",get:function(){return{draggable:{defaultValue:!0}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:35992,end:39469})})(kb.HaloItem);kb.nameNumberRe=/(.+)([0-9]+)$/;(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("ComponentHaloItem")&&
"function"===typeof Aa.ComponentHaloItem?Aa.ComponentHaloItem:Aa.ComponentHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"updateComponentIndicator",value:function(){var P=this.world(),wa=this.halo.target;this.halo.remove();P.showHaloFor(wa)}},{key:"checkForDuplicateNamesInHierarchy",value:function(){var P=this,wa,Xa,Db,mc,Sb,Tc,gd,se,Cf,me,Se,Ze;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yf){switch(yf.nextAddress){case 1:wa=
P.halo.target;Xa=P.world();Db=[];wa.withAllSubmorphsDoExcluding(function(vd){vd!=wa&&Db.push(vd)},function(vd){return vd.master});mc=kb.arr.groupBy(Db,function(vd){return vd.name});Sb={fontWeight:"normal",fontSize:16};if(!Object.values(mc).find(function(vd){return 1<vd.length})){yf.jumpTo(2);break}Tc=kb.arr.sum(Object.values(mc).filter(function(vd){return 1<vd.length}).map(function(vd){return vd.length}));return yf.yield(Xa.confirm(["Ambigous Names in Submorph Hierarchy  ",{}].concat($jscomp.arrayFromIterable(kb.Icon.textAttribute("exclamation-triangle",
{fontColor:kb.Color.rgb(230,126,34),fontSize:30,lineHeight:"40px"})),["\nThe morph you are about to turn into a component has "+Tc+" morphs within its submorph hierarchy, that have ambigous names. This can lead to incorrect applications of style properties when you create derived instances from this component.\n\n",Object.assign({},Sb,{textAlign:"left"}),"Usually ambigous names are caused if your component is in some kind of intermittent state, where it already displays an example state or code has run that automatically created interface elements. This can be fixed by resetting the submorphs of this morph, usually by implementing a ",
Object.assign({},Sb,{textAlign:"left",fontStyle:"italic"}),"reset()",Object.assign({},Sb,{fontStyle:"italic",fontFamily:"IBM Plex Mono"}),' routine you can invoke to put the morph into some kind of "neutral" state. Alternatively you can go ahead and rename the duplicate morphs to have proper unique names. If you have a hard time giving the conflicting morphs appropriate names, this can be an indication that the component you are declaring is too large, and you need to decompose your component into subcomponents further.',
Object.assign({},Sb,{textAlign:"left",fontStyle:"italic"})]),{width:600,confirmLabel:"PROCEED TO RENAME",rejectLabel:"CANCEL",align:"left"}),3);case 3:if(gd=yf.yieldResult,!gd)return yf.return();case 2:Cf=yf.forIn(mc);case 4:if(null==(se=Cf.getNext())){yf.jumpTo(6);break}if(2>mc[se].length){yf.jumpTo(4);break}me=mc[se];case 7:if(!(1<me.length)){yf.jumpTo(4);break}Se=me[0];kb.show(Se,!0);return yf.yield(Xa.prompt(["Name Collision\n",{},"The name of\n",Sb,Se.toString(),Object.assign({},Sb,{fontStyle:"italic",
fontWeight:"bold"}),"\nis not unique within the submorph hierachy of\n",Object.assign({},Sb),wa.name,Object.assign({},Sb,{fontStyle:"italic",fontWeight:"bold"}),"\nThere "+(2<me.length?"are "+(me.length-1)+" other morphs":"is one other morph")+" with the exact same name located in this component.",Sb," Duplicate names can cause errors when applying styles to derived morphs of this master component, so it is essential that there is no name ambiguity. Please enter a new name for this or the other conflicting morphs:",
Sb],{input:Se.name,lineWrapping:!0,width:500,fontSize:12,rejectLabel:"IGNORE",confirmLabel:"RENAME",errorMessage:"Provided name is not unique",validate:function(vd){return!Object.keys(mc).includes(vd)}}),9);case 9:Ze=yf.yieldResult;kb.signal(Xa,"hideMarkers");Ze&&(Se.name=Ze);if(Ze in mc){yf.jumpTo(7);break}else if(!Ze){me=kb.arr.rotate(me);yf.jumpTo(7);break}kb.arr.remove(me,Se);yf.jumpTo(7);break;case 6:return yf.return(!0)}})}},{key:"onMouseDown",value:function(){var P=this,wa,Xa,Db,mc,Sb,Tc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gd){switch(gd.nextAddress){case 1:wa=
P.halo.target;Xa=!wa.isComponent;Db=$world.getAllNamed(wa.name).length;if(!(Xa&&1<Db)){gd.jumpTo(2);break}return gd.yield($world.prompt(["Name Conflict\n",{},"The morph's name you are about to turn into a component is already used by "+(Db-1)+" other morph"+(2<Db?"s":"")+". Please enter a ",{fontWeight:"normal"},"unique identifier",{fontStyle:"italic"}," for this component within this project.",{fontWeight:"normal",fontSize:16}],{input:wa.name,lineWrapping:!0,width:400,errorMessage:"Identifier not unique",
validate:function(se){return 0==$world.getAllNamed(se).length}}),3);case 3:mc=gd.yieldResult;if(!mc)return gd.return();wa.name=mc;case 2:Sb=wa;if(!(Tc=Xa)){gd.jumpTo(4);break}return gd.yield(P.checkForDuplicateNamesInHierarchy(),5);case 5:Tc=gd.yieldResult;case 4:Sb.isComponent=Tc,Xa?kb.arr.pushIfNotIncluded(wa.world().localComponents,wa):kb.arr.remove(wa.world().localComponents,wa),P.world()?P.updateComponentIndicator():wa.world().showHaloFor(wa),gd.jumpToEnd()}})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"ComponentHaloItem"}},{key:"morphName",get:function(){return"component"}},{key:"properties",get:function(){return{tooltip:{get:function(){return this.halo.target.isComponent?"Retract Component":"Turn into Component"}},styleClasses:{initialize:function(){this.styleClasses=this.halo.target.isComponent?["fas","fa-eraser"]:["fas","fa-cube"]}}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:39510,end:45564})})(kb.HaloItem);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("CopyHaloItem")&&"function"===typeof Aa.CopyHaloItem?Aa.CopyHaloItem:Aa.CopyHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"init",value:function(P){function wa(se,Cf){return Cf.match(kb.nameNumberRe)?
Cf.replace(kb.nameNumberRe,function(me,Se,Ze){Ze||(Ze="0");for(me=Number(Ze);se.get(Se+ ++me););return Se+me}):Cf+"1"}var Xa=this.halo,Db=Xa.target,mc=Xa.world(),Sb=Db instanceof kb.MultiSelectionTarget;Xa.remove();kb.connect(P,"update",this,"update");if(Sb){var Tc=Db.selectedMorphs.map(function(se){return mc.addMorph(se.copy())});Sb=Tc.map(function(se){se.name=wa(Db,se.name);return se.position});Tc[0].undoStart("copy-halo");mc.addMorph(Xa);Xa.refocus(Tc);P.grab(Xa.target);Xa.target.onGrab({halo:Xa,
hand:P,isShiftDown:function(){return!1}});Sb.forEach(function(se,Cf){return Tc[Cf].globalPosition=se});Xa.alignWithTarget()}else{Sb=Db.globalPosition;var gd=Db.copy();Db.isComponent&&(gd.isComponent=!1,gd.withAllSubmorphsDoExcluding(function(se){se!=gd&&se.master||delete se._parametrizedProps},function(se){return se.master&&se!=gd}),gd.master=Db);gd.name=wa(Db,Db.name);mc.addMorph(gd);gd.globalPosition=Sb;gd.undoStart("copy-halo");P.grab(gd);mc.addMorph(Xa);Xa.visible=!1}}},{key:"stop",value:function(P){var wa=
this.halo,Xa=$jscomp.makeIterator(P.grabbedMorphs).next().value,Db=P.findDropTarget(P.globalPosition,[wa.target],function(Sb){return!Sb.isHaloItem&&!Sb.ownerChain().some(function(Tc){return Tc.isHaloItem})}),mc=wa.target.undoInProgress;kb.disconnect(P,"update",this,"update");mc.addTarget(Db);P.dropMorphsOn(Db);wa.target.undoStop("copy-halo");wa.remove();P.world().showHaloFor(Xa)}},{key:"onDragStart",value:function(P){this.init(P.hand)}},{key:"onDragEnd",value:function(P){this.stop(P.hand)}},{key:"update",
value:function(){this.halo.alignWithTarget()}},{key:"copyToClipBoard",value:function(){var P=this,wa,Xa,Db,mc,Sb,Tc,gd,se,Cf,me,Se,Ze,yf,vd,Ve;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ye){switch(Ye.nextAddress){case 1:wa=P;Xa=wa.halo;if(Xa.nameHalo().nameHolders.find(function(cg){return cg.nameHolder===$world.focusedMorph}))return Ye.return();Db=Xa.target;mc=Xa.world();Sb=Db instanceof kb.MultiSelectionTarget;Tc=Db.globalBounds().topLeft();gd=Sb?Db.selectedMorphs:[Db];se=[];Cf=
'<!DOCTYPE html>\n          <html lang="en">\n          <head>\n            <meta charset="utf-8">\n            '+document.querySelector("#lively-morphic-css").outerHTML+"\n          </head>\n          <body>";Xa.remove();Ye.setCatchFinallyBlocks(2);me=$jscomp.makeIterator(gd);Se=me.next();case 4:if(Se.done)return Cf+="</body></html>",vd=JSON.stringify(se),Ye.yield(P.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/html",data:Cf},{type:"application/morphic",data:vd}]),8);Ze=Se.value;return Ye.yield(kb.createMorphSnapshot(Ze,
{addPreview:!1,testLoad:!1}),7);case 7:yf=Ye.yieldResult;yf.copyMeta={offset:Ze.worldPoint(kb.pt(0,0)).subPt(Tc)};se.push(yf);Cf+=Ze.renderPreview();Se=me.next();Ye.jumpTo(4);break;case 8:Ye.leaveTryBlock(3);break;case 2:return Ve=Ye.enterCatchBlock(),mc.logError(Ve),Ye.return();case 3:mc.addMorph(Xa),Xa.refocus(gd),Xa.setStatusMessage("copied"),Ye.jumpToEnd()}})}},{key:"onMouseUp",value:function(P){var wa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){P.stop();return Xa.yield(wa.copyToClipBoard(),
0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CopyHaloItem"}},{key:"morphName",get:function(){return"copy"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},tooltip:{defaultValue:"Copy morph"},styleClasses:{defaultValue:["far","fa-clone"]}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:45566,end:49600})})(kb.HaloItem);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("OriginHaloItem")&&"function"===typeof Aa.OriginHaloItem?Aa.OriginHaloItem:Aa.OriginHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"fill",get:function(){return kb.Color.white.interpolate(.2,this.borderColorTop)}},{key:"extent",get:function(){return kb.pt(15,
15)}},{key:"tooltip",get:function(){return"Change the morph's origin"}},{key:"computePositionAtTarget",value:function(){return this.halo.localize(this.halo.target.globalPosition)}},{key:"alignInHalo",value:function(){this.visible=!this.halo.hasTinyTarget;this.center=this.computePositionAtTarget()}},{key:"valueForPropertyDisplay",value:function(){return this.halo.target.origin}},{key:"init",value:function(){this.halo.target.undoStart("origin-halo");this.halo.state.activeButton=this}},{key:"stop",value:function(){this.halo.target.undoStop("origin-halo");
this.halo.state.activeButton=null;this.halo.alignWithTarget()}},{key:"update",value:function(P){var wa=this.halo,Xa=wa.target.origin,Db=wa.target.worldPoint(Xa);P=wa.target.localize(Db.addPt(P)).subPt(wa.target.scroll).subPt(Xa);wa.target.adjustOrigin(wa.target.origin.addPt(P))}},{key:"onDragStart",value:function(P){this.init()}},{key:"onDragEnd",value:function(P){this.stop()}},{key:"onDrag",value:function(P){this.update(P.state.dragDelta)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"OriginHaloItem"}},
{key:"morphName",get:function(){return"origin"}},{key:"properties",get:function(){return{borderWidth:{defaultValue:3},nativeCursor:{defaultValue:"-webkit-grab"},draggable:{defaultValue:!0},borderColor:{after:["halo"],initialize:function(){this.borderColor=this.halo.target.isComponent?kb.componentAccent:kb.haloBlue}}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:49602,end:51263})})(kb.HaloItem);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("ResizeHandle")&&"function"===typeof Aa.ResizeHandle?Aa.ResizeHandle:Aa.ResizeHandle=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"valueForPropertyDisplay",value:function(){var P=this.halo.target.extent,
wa=P.y;return P.x.toFixed(1)+"x"+wa.toFixed(1)}},{key:"positionInHalo",value:function(){var P=this.halo.borderBox.bounds();this.halo.hasTinyTarget&&(kb.Rectangle.prototype.sides.includes(this.location)&&(this.visible=!1),P=P.insetBy(-4));return P.partNamed(this.location)}},{key:"alignInHalo",value:function(){this.center=this.positionInHalo();return this}},{key:"onKeyUp",value:function(P){this.halo.state.activeButton==this&&this.halo.toggleDiagonal(P.isShiftDown(),this.corner)}},{key:"onKeyDown",value:function(P){this.halo.state.activeButton==
this&&this.halo.toggleDiagonal(P.isShiftDown(),this.corner)}},{key:"onDragStart",value:function(P){this.init(P.position,P.isShiftDown())}},{key:"onDragEnd",value:function(P){this.stop(P.isShiftDown())}},{key:"onDrag",value:function(P){this.update(P.position,P.isShiftDown(),P.isAltDown(),P.isCtrlDown());this.focus()}},{key:"init",value:function(P,wa){wa=void 0===wa?!1:wa;var Xa=this.halo.target,Db=Xa.origin,mc=Xa.position;Xa=Xa.extent;this.startPos=P;this.startBounds=mc.subPt(Db).extent(Xa);this.startOrigin=
this.halo.target.origin;this.savedLayout=this.halo.layout;this.halo.layout=null;this.halo.state.activeButton=this;this.tfm=this.halo.target.getGlobalTransform().inverse();P=this.halo.target.getGlobalTransform().getRotation();this.offsetRotation=kb.num.toRadians(P%45);this.halo.toggleDiagonal(wa,this.corner)}},{key:"update",value:function(P,wa,Xa,Db){wa=void 0===wa?!1:wa;Xa=void 0===Xa?!1:Xa;Db=void 0===Db?!1:Db;var mc=this.corner,Sb=this.tfm;P=this.startPos.subPt(P);Sb=Sb.transformDirection(kb.pt(P.x,
P.y));Xa&&(Sb=Sb.griddedBy(kb.pt(10,10)));this.halo.updateBoundsFor(mc,wa,Sb,this.startBounds,this.startOrigin);this.halo.toggleDiagonal(wa,mc);this.updateAlignmentGuide(Xa);wa=[];mc=mc.toLowerCase();mc.includes("left")&&wa.push("left");mc.includes("top")&&wa.push("top");mc.includes("bottom")&&wa.push("bottom");mc.includes("right")&&wa.push("right");kb.showAndSnapToResizeGuides(this.halo.target,wa,!0,Db,5,200)}},{key:"stop",value:function(P){P=this.halo;P.layout=this.savedLayout;P.state.activeButton=
null;P.alignWithTarget();P.toggleDiagonal(!1);this.updateAlignmentGuide(!1);kb.removeSnapToGuidesOf(P.target)}},{key:"updateAlignmentGuide",value:function(P){var wa=this.halo.getSubmorphNamed("mesh");if(P)return P=this.halo.target.extent,P=kb.pt(P.x%10,P.y%10),wa=this.halo.getMesh(this.globalPosition.addPt(this.extent.scaleBy(.5)),P),this.focus(),wa;wa&&wa.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ResizeHandle"}},{key:"properties",get:function(){return{corner:{},location:{},
draggable:{defaultValue:!0},isResizeHandle:{readOnly:!0,get:function(){return!0}}}}},{key:"getResizeParts",value:function(P){0<P&&(P-=360);P=-8-(P/45).toFixed();0==P&&(P=8);return kb.arr.zip(kb.arr.rotate([["topLeft",function(wa){return wa.negated()}],["topCenter",function(wa){return wa.withX(0).negated()}],["topRight",function(wa){return wa.withX(0).negated()}],["rightCenter",function(wa){return kb.pt(0,0)}],["bottomRight",function(wa){return kb.pt(0,0)}],["bottomCenter",function(wa){return kb.pt(0,
0)}],["bottomLeft",function(wa){return wa.withY(0).negated()}],["leftCenter",function(wa){return wa.withY(0).negated()}]],P),[["nwse-resize","topLeft"],["ns-resize","topCenter"],["nesw-resize","topRight"],["ew-resize","rightCenter"],["nwse-resize","bottomRight"],["ns-resize","bottomCenter"],["nesw-resize","bottomLeft"],["ew-resize","leftCenter"]])}},{key:"resizersFor",value:function(P){var wa=this;if(!P.target)return[];var Xa=P.target.getGlobalTransform().getRotation();return kb.arr.compact(this.getResizeParts(Xa).map(function(Db){var mc=
$jscomp.makeIterator(Db),Sb=$jscomp.makeIterator(mc.next().value);Db=Sb.next().value;Sb.next();Sb.next();Sb=$jscomp.makeIterator(mc.next().value);mc=Sb.next().value;Sb=Sb.next().value;return wa.for(P,Db,Sb,mc)})).map(function(Db){return Db.alignInHalo()})}},{key:"for",value:function(P,wa,Xa,Db){var mc="Resize "+wa;P=P.getSubmorphNamed(mc)||new this({name:mc,halo:P,corner:wa,tooltip:"Resize "+wa,extent:kb.pt(10,10),borderWidth:1,borderRadius:0,borderColor:P.target.isComponent?kb.componentAccent:kb.haloBlue,
fill:kb.Color.white});return Object.assign(P,{nativeCursor:Db,location:Xa})}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:51322,end:56620})})(kb.HaloItem);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("MenuHaloItem")&&"function"===
typeof Aa.MenuHaloItem?Aa.MenuHaloItem:Aa.MenuHaloItem=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"onMouseDown",value:function(P){var wa=this,Xa,Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mc){if(1==mc.nextAddress)return Xa=wa.halo.target,wa.halo.remove(),mc.yield(Xa.menuItems(),2);Db=mc.yieldResult;Xa.world().openMenu(Db).hasFixedPosition=wa.halo.hasFixedPosition;mc.jumpToEnd()})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MenuHaloItem"}},{key:"morphName",get:function(){return"menu"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},tooltip:{defaultValue:"Opens the morph menu"},styleClasses:{defaultValue:["fas","fa-bars"]}}}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:56622,end:57144})})(kb.HaloItem);var ub=Ca("M",function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),xb=Aa.hasOwnProperty("MorphHighlighter")&&"function"===typeof Aa.MorphHighlighter?Aa.MorphHighlighter:Aa.MorphHighlighter=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"alignWithHalo",value:function(){this.target&&(this.position=this.halo.localize(this.target.globalBounds().topLeft()),
this.halo.isWorld&&(this.position=this.position.subPt(this.halo.scroll)),this.extent=this.target.globalBounds().extent(),this.get("name tag").value=this.target.name,this.get("name tag").topCenter=this.innerBounds().insetBy(-10).bottomCenter())}},{key:"show",value:function(){if(this.target&&this.target.layout&&this.showLayout&&(this.layoutHalo=this.layoutHalo||this.world().showLayoutHaloFor(this.target,this.pointerId))&&this.layoutHalo.previewDrop){this.visible=!1;this.alignWithHalo();this.halo.get("grab").hand.grabbedMorphs&&
this.layoutHalo.previewDrop(this.halo.get("grab").hand.grabbedMorphs);return}this.visible=!0;this.alignWithHalo()}},{key:"handleDrop",value:function(P){this.layoutHalo&&this.layoutHalo.handleDrop(P)}},{key:"deactivate",value:function(){this.layoutHalo&&(this.layoutHalo.remove(),this.layoutHalo=null);this.visible=!1;this.alignWithHalo();this.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphHighlighter"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},
name:{defaultValue:"morphHighlighter"},styleClasses:{defaultValue:["inactive"]},reactsToPointer:{defaultValue:!1},hasFixedPosition:{defaultValue:!0},fill:{defaultValue:kb.Color.orange.withA(.3)},borderWidth:{defaultValue:2},borderColor:{defaultValue:kb.Color.orange},halo:{},epiMorph:{defaultValue:!0},isHighlighter:{readOnly:!0,defaultValue:!0},highlightedSides:{defaultValue:[],set:function(P){var wa=this;this.setProperty("highlightedSides",P);this.submorphs=P.map(function(Xa){return{type:"ellipse",
isHaloItem:!0,fill:kb.Color.orange,center:wa.innerBounds()[Xa]()}});this.addMorph({type:"label",name:"name tag",padding:kb.Rectangle.inset(5,5,5,5),fontColor:kb.Color.white,fill:kb.Color.orange,borderRadius:3});this.alignWithHalo()}},showLayout:{defaultValue:!1},targetId:{},target:{readOnly:!0,derived:!0,get:function(){return(this.world()||this.env.world).getMorphWithId(this.targetId)}}}}},{key:"removeHighlighters",value:function(P){P=void 0===P?$world:P;var wa=P._morphHighlighters,Xa;for(Xa in wa)wa[Xa].remove();
delete P._morphHighlighters}},{key:"for",value:function(P,wa,Xa,Db){Xa=void 0===Xa?!1:Xa;Db=void 0===Db?[]:Db;var mc=P._morphHighlighters=P._morphHighlighters||{};kb.properties.forEachOwn(mc,function(Sb,Tc){return Tc.alignWithHalo()});if(!wa||wa.ownerChain().find(function(Sb){return Sb.isHaloItem}))return null;mc[wa.id]=mc[wa.id]||new this({targetId:wa.id,halo:P,showLayout:Xa});P.addMorph(mc[wa.id]);mc[wa.id].highlightedSides=Db;return mc[wa.id]}},{key:"interceptDrop",value:function(P,wa,Xa){(P=P._morphHighlighters=
P._morphHighlighters||{},P[wa.id])&&P[wa.id].handleDrop(Xa)}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:57333,end:60944})}(kb.Morph));kb.MorphHighlighter=ub;kb.MorphHighlighter=ub;kb.MorphHighlighter=ub;var cd=Ca("I",function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
xb=Aa.hasOwnProperty("InteractiveMorphSelector")&&"function"===typeof Aa.InteractiveMorphSelector?Aa.InteractiveMorphSelector:Aa.InteractiveMorphSelector=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:Symbol.for("lively-instance-initialize"),value:function(P,wa,Xa){P=void 0===P?$world:P;this.controllingMorph=void 0===wa?null:wa;this.possibleTarget=this.morphHighlighter=this.selectorMorph=null;this.world=
P;this.filterFn=Xa;this.whenDone=null}},{key:"selectNewTarget",value:function(){this.targetObject=null;var P=kb.promise.deferred();P.promise.resolve=P.resolve;this.whenDone=P.promise;this.selectorMorph=kb.Icon.makeLabel("crosshairs",{fontSize:20,hasFixedPosition:!0,epiMorph:!0}).openInWorld();kb.connect(this.world.firstHand,"position",this,"scanForTargetAt");kb.once(this.selectorMorph,"onMouseDown",this,"selectTarget");kb.once(this.selectorMorph,"onKeyDown",this,"stopSelect");this.selectorMorph.focus();
this.scanForTargetAt(this.world.firstHand.position)}},{key:"scanForTargetAt",value:function(){var P=this.world.firstHand.globalPosition;this.selectorMorph.center=P;this.selectorMorph.focus();var wa=this.selectorMorph.morphBeneath(P),Xa,Db=this.possibleTarget,mc=this.controllingMorph,Sb=this.filterFn,Tc=this.world,gd=this.morphHighlighter;for(gd==wa?wa=gd.morphBeneath(P):wa&&wa.isEpiMorph&&(wa=wa.morphBeneath(P));wa&&(Xa=[wa].concat($jscomp.arrayFromIterable(wa.ownerChain())).find(function(se){return!se.visible}));)wa=
Xa=Xa.morphBeneath(P);if(wa&&Sb&&!Sb(wa))for(;wa&&![wa].concat($jscomp.arrayFromIterable(wa.ownerChain())).find(Sb);)wa=wa.morphBeneath(P);!wa||wa==Db||mc&&wa.ownerChain().includes(mc.getWindow())||(gd&&gd.deactivate(),(this.possibleTarget=Db=wa)&&!Db.isWorld&&(P=this.morphHighlighter=kb.MorphHighlighter.for(Tc,wa))&&P.show())}},{key:"selectTarget",value:function(){this.targetObject=this.possibleTarget;this.stopSelect()}},{key:"stopSelect",value:function(){kb.MorphHighlighter.removeHighlighters(this.world);
kb.disconnect(this.world.firstHand,"position",this,"scanForTargetAt");this.selectorMorph.remove();this.whenDone&&this.whenDone.resolve(this.targetObject)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveMorphSelector"}},{key:"selectMorph",value:function(P,wa,Xa){P=new this(P,wa,Xa);P.selectNewTarget();return P.whenDone}}],Aa,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:60953,end:63708})}(void 0));kb.InteractiveMorphSelector=cd;kb.InteractiveMorphSelector=cd;kb.InteractiveMorphSelector=cd;kb.default=Eb;var Vc=lively.FreezerRuntime.recorderFor("lively.ide/index.js");Vc.info="import via sub modules";Vc.info="import via sub modules";Vc.info="import via sub modules";Eb=Ca("v",{});Vc.valueWidgets=Eb;Vc.valueWidgets=Eb;Vc.valueWidgets=Eb;var ib=Ca("p",{});Vc.popovers=ib;Vc.popovers=ib;Vc.popovers=
ib;var Ra=lively.FreezerRuntime.recorderFor("lively.components/popup.js");Ra.Morph=kf;Ra.VerticalLayout=Qa;Ra.StyleSheet=le;Ra.Icon=Qe;Ra.CustomLayout=Ja;Ra.Color=lc;Ra.rect=Pc;Ra.pt=Kb;Ra.connect=cc;Ra.Path=Hd;Ra.duration=300;Vc=Ca("P",function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.components/popup.js"),xb=Aa.hasOwnProperty("Popover")&&"function"===typeof Aa.Popover?Aa.Popover:Aa.Popover=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return ec(xb,ma,[{key:"relayout",value:function(P){var wa=this.get("body"),Xa=this.get("arrow"),Db=this.get("close button");Xa=Xa.height;P?(wa.animate({topCenter:Ra.pt(0,Xa),duration:200}),Db.animate({topRight:wa.topRight.addXY(8,-8),duration:200})):(wa.topCenter=Ra.pt(0,Xa),Db.topRight=wa.topRight.addXY(8,-8))}},{key:"close",value:function(){this.fadeOut(300)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Popover"}},{key:"properties",get:function(){return{epiMorph:{defaultValue:!0},
hasFixedPosition:{defaultValue:!0},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/popover/light"}}},targetMorph:{derived:!0,after:["submorphs"],defaultValue:{extent:Ra.pt(200,200),fill:Ra.Color.transparent,submorphs:[{name:"placeholder",type:"label",value:"No Target Specified"}]},get:function(){return this.get("body").submorphs[0]},set:function(P){var wa=this;this.get("body").addMorph(P);this.whenRendered().then(function(){return wa.relayout()})}},submorphs:{initialize:function(){var P=
this;this.submorphs=[{type:"polygon",name:"arrow",topCenter:Ra.pt(0,0),borderColor:Ra.Color.transparent,vertices:[Ra.pt(-10,0),Ra.pt(0,-15),Ra.pt(10,0)]},{name:"body"},{name:"close button",type:"button",label:Object.assign(Ra.Icon.makeLabel("times-circle"),{fontSize:18}),tooltip:"close",fill:null,extent:Ra.pt(16,16),borderColor:Ra.Color.transparent}];var wa=$jscomp.makeIterator(this.submorphs);wa.next();var Xa=wa.next().value;wa=wa.next().value;Ra.connect(wa,"fire",this,"close");Ra.connect(Xa,"extent",
this,"relayout",{converter:"() => target.animated"});setTimeout(function(){return P.animated=!0},1E3)}}}}}],Aa,{pathInPackage:function(){return"popup.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.components",version:"0.1.0"}}},{start:247,end:2617})}(Ra.Morph));Ra.Popover=Vc;Ra.Popover=Vc;Ra.Popover=Vc;var pb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js");
pb.Morph=kf;pb.TilingLayout=eb;pb.morph=bc;pb.Label=$d;pb.HorizontalLayout=Dc;pb.Icon=Qe;pb.InputLine=Rb;pb.config=zc;pb.connect=cc;pb.signal=Gb;pb.Color=lc;pb.LinearGradient=dd;pb.pt=Kb;pb.rect=Pc;pb.num=wc;pb.obj=Td;pb.popovers=ib;pb.ValueScrubber=sb;pb.Popover=Vc;(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),xb=Aa.hasOwnProperty("ContextSensitiveWidget")&&"function"===typeof Aa.ContextSensitiveWidget?Aa.ContextSensitiveWidget:Aa.ContextSensitiveWidget=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ContextSensitiveWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:pb.Color.transparent},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?pb.Color.white:pb.Color.black}},layout:{initialize:function(){this.layout=new pb.HorizontalLayout}},
context:{serialize:!1}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1872,end:2441})})(pb.Morph);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),xb=Aa.hasOwnProperty("ShortcutWidget")&&"function"===typeof Aa.ShortcutWidget?Aa.ShortcutWidget:
Aa.ShortcutWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(P){P.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShortcutWidget"}},{key:"properties",get:function(){return{title:{defaultValue:"No Title",after:["submorphs"],
set:function(P){this.setProperty("title",P);this.getSubmorphNamed("valueString").value=P}},nativeCursor:{defaultValue:"pointer"},fontColor:{derived:!0,set:function(P){this.submorphs.forEach(function(wa){return wa.fontColor=P})}},submorphs:{initialize:function(){this.submorphs=[pb.Icon.makeLabel("arrow-right",{styleClasses:["TreeLabel"],fontSize:15,padding:pb.rect(1,1,4,1)}),{type:"label",value:this.title,styleClasses:["TreeLabel"],fontWeight:"bold",name:"valueString",opacity:.8,borderRadius:5,padding:pb.rect(0,
0,0,2),nativeCursor:"pointer",fontSize:12,borderWidth:0}]}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:2443,end:3793})})(pb.ContextSensitiveWidget);ib=function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),xb=Aa.hasOwnProperty("LayoutWidget")&&
"function"===typeof Aa.LayoutWidget?Aa.LayoutWidget:Aa.LayoutWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"layoutChanged",value:function(){this.title=this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}},{key:"openPopover",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==Xa.nextAddress)return wa=new pb.popovers.LayoutPopover({hasFixedPosition:!!P.ownerChain().find(function(Db){return Db.hasFixedPosition}),
container:P.context}),Xa.yield(wa.fadeIntoWorld(P.globalBounds().center()),2);pb.connect(wa,"layoutChanged",P,"layoutChanged");pb.signal(P,"openWidget",wa);Xa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutWidget"}},{key:"properties",get:function(){return{title:{after:["submorphs"],initialize:function(){this.title=this.context&&this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3802,end:4623})}(pb.ShortcutWidget);pb.LayoutWidget=ib;pb.LayoutWidget=ib;pb.LayoutWidget=ib;ib=function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),xb=Aa.hasOwnProperty("ColorWidget")&&"function"===typeof Aa.ColorWidget?Aa.ColorWidget:Aa.ColorWidget=function(P){P&&
P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"relayout",value:function(P){P?this.submorphs=this.color?this.color.isGradient?this.renderGradientValue():this.renderColorValue():this.renderNoColor():this.color&&(this.color.isGradient?this.updateGradientValue():this.updateColorValue())}},{key:"updateGradientValue",value:function(){var P=this.color;if(2*P.stops.length==this.submorphs.length-3){var wa;for(wa in this.color.stops){var Xa=
P.stops[wa];var Db=Xa.color,mc=Xa.offset,Sb=$jscomp.makeIterator(this.submorphs[2+2*wa].submorphs).next().value;Xa=this.submorphs[3+2*wa];Sb.fill=Db;Xa.value=(100*mc).toFixed()+"%"+(wa<P.stops.length-1?",":"")}}else this.submorphs=this.renderGradientValue()}},{key:"renderGradientValue",value:function(){return[{type:"label",styleClasses:["TreeLabel"],value:this.color.type+"(",name:"valueString"}].concat($jscomp.arrayFromIterable(this.renderStops()),[{type:"label",styleClasses:["TreeLabel"],value:")"}])}},
{key:"updateColorValue",value:function(){this.getSubmorphNamed("color box").fill=this.color;this.getSubmorphNamed("valueString").value=pb.obj.safeToString(this.color)}},{key:"renderNoColor",value:function(){return[{extent:pb.pt(15,15),fill:pb.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:pb.pt(5,7.5),fill:pb.Color.white,borderColor:pb.Color.gray.darker(),borderWidth:1,submorphs:[{type:"path",name:"no fill",vertices:[pb.pt(0,0),pb.pt(10,10)],borderColor:pb.Color.red}]}]},
{type:"label",value:"No Color",fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderColorValue",value:function(){return[{extent:pb.pt(15,15),fill:pb.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:pb.pt(5,7.5),fill:this.color,borderColor:pb.Color.gray.darker(),nativeCursor:"pointer",borderWidth:1}]},{type:"label",value:pb.obj.safeToString(this.color),fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderStops",value:function(){var P=
this.color,wa=[{type:"label",padding:pb.rect(0,0,5,0),value:"linearGradient"==P.type?pb.num.toDegrees(P.vectorAsAngle()).toFixed()+"\u00b0,":""}],Xa;for(Xa in P.stops){var Db=P.stops[Xa],mc=Db.color;Db=Db.offset;wa.push({extent:pb.pt(this.fontSize,this.fontSize),fill:pb.Color.transparent,layout:new pb.HorizontalLayout({spacing:3}),submorphs:[{styleClasses:["colorValue"],fill:mc}]});wa.push({type:"label",padding:pb.rect(0,0,5,0),value:(100*Db).toFixed()+"%"+(Xa<P.stops.length-1?",":"")})}return wa}},
{key:"onMouseDown",value:function(P){this.openFillEditor()}},{key:"update",value:function(P){this.color=P}},{key:"openFillEditor",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==Xa.nextAddress)return wa=new pb.popovers.FillPopover({hasFixedPosition:!!P.ownerChain().find(function(Db){return Db.hasFixedPosition}),handleMorph:P.context,fillValue:P.color,title:"Fill Control",gradientEnabled:P.gradientEnabled}),Xa.yield(wa.fadeIntoWorld(P.globalBounds().center()),
2);pb.connect(wa,"fillValue",P,"update");pb.signal(P,"openWidget",wa);Xa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColorWidget"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new pb.HorizontalLayout({direction:"centered"})}},selectionFontColor:{defaultValue:pb.Color.white},nonSelectionFontColor:{defaultValue:pb.Color.black},color:{defaultValue:pb.Color.blue},gradientEnabled:{defaultValue:!1},fontSize:{defaultValue:14},isSelected:{after:["submorphs"],
set:function(P){this.getProperty("isSelected")!=P&&(this.getSubmorphNamed("valueString").fontColor=P?this.selectionFontColor:this.nonSelectionFontColor,this.setProperty("isSelected",P))}},submorphs:{after:["nonSelectionFontColor","selectionFontColor"],initialize:function(){pb.connect(this,"color",this,"relayout",{converter:function(P,wa){return(wa&&wa.isColor)!=(P&&P.isColor)}});this.relayout(!0)}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:4687,end:10140})}(pb.ContextSensitiveWidget);pb.ColorWidget=ib;pb.ColorWidget=ib;pb.ColorWidget=ib;ib=function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),xb=Aa.hasOwnProperty("BooleanWidget")&&"function"===typeof Aa.BooleanWidget?Aa.BooleanWidget:Aa.BooleanWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return ec(xb,ma,[{key:"onMouseDown",value:function(P){this.boolean=!this.boolean}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BooleanWidget"}},{key:"properties",get:function(){return{fontFamily:{defaultValue:pb.config.codeEditor.defaultStyle.fontFamily},nativeCursor:{defaultValue:"pointer"},boolean:{set:function(P){this.setProperty("boolean",P);this.value=pb.obj.safeToString(P);this.fontColor=this.boolean?pb.Color.green:pb.Color.red}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10149,end:10634})}(pb.Label);pb.BooleanWidget=ib;pb.BooleanWidget=ib;pb.BooleanWidget=ib;ib=Ca("N",function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),xb=Aa.hasOwnProperty("NumberWidget")&&"function"===typeof Aa.NumberWidget?Aa.NumberWidget:Aa.NumberWidget=
function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"onMouseDown",value:function(P){ec._get(Object.getPrototypeOf(xb.prototype),"onMouseDown",this).call(this,P);"up"==P.targetMorph.name&&this.increment();"down"==P.targetMorph.name&&this.decrement()}},{key:"spec",value:function(){return pb.obj.dissoc(ec._get(Object.getPrototypeOf(xb.prototype),"spec",this).call(this),["submorphs"])}},{key:"update",value:function(P,
wa){wa=void 0===wa?!0:wa;this.setProperty("number",wa?P/this.scaleFactor:P);pb.signal(this,"number",this.number);this.relayout(wa)}},{key:"relayoutButtons",value:function(){var P=this.getSubmorphNamed("up"),wa=this.getSubmorphNamed("down");this.getSubmorphNamed("value");P.height=wa.height=(this.height-2)/2;P.width=wa.width=20}},{key:"onChange",value:function(P){ec._get(Object.getPrototypeOf(xb.prototype),"onChange",this).call(this,P);"extent"!=P.prop||this.autofit||this.relayout()}},{key:"relayout",
value:function(P){var wa=this.getSubmorphNamed("value");wa&&(this.autofit?(P||(wa.value=this.number*this.scaleFactor),wa.fit(),this.height=wa.height,this.width=wa.width+20):P||(wa.width=this.width-20),this.relayoutButtons(),P||(wa.value=pb.num.roundTo(this.number*this.scaleFactor,1),wa.min=-Infinity!=this.min?this.min*this.scaleFactor:this.min,wa.max=Infinity!=this.max?this.max*this.scaleFactor:this.max,wa.unit=this.unit))}},{key:"increment",value:function(){void 0!=this.max&&this.number>=this.max||
this.update(this.number+1/this.scaleFactor,!1)}},{key:"decrement",value:function(){void 0!=this.min&&this.number<=this.min||this.update(this.number-1/this.scaleFactor,!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberWidget"}},{key:"properties",get:function(){return{unit:{type:"Enum",isStyleProp:!0,values:["px","%","pt",""]},autofit:{defaultValue:!0,after:["submorphs","extent"],set:function(P){this.setProperty("autofit",P);this.getSubmorphNamed("value").scaleToBounds=!P}},
number:{defaultValue:0,after:["unit","autofit"],set:function(P){this.setProperty("number",P);this.relayout(!1)}},min:{defaultValue:-Infinity},max:{defaultValue:Infinity},floatingPoint:{after:["number","submorphs"],set:function(P){this.setProperty("floatingPoint",P);this.get("value").floatingPoint=P},get:function(){var P=/[+-]?([0-9]*[.])?[0-9]+/.exec(this.number);return this.getProperty("floatingPoint")||1==this.scaleFactor&&P&&!!P[1]}},padding:{isStyleProp:!0,defaultValue:pb.rect(5,3,0,0),after:["submorphs"],
set:function(P){this.setProperty("padding",P);this.getSubmorphNamed("value").padding=P}},extent:{defaultValue:pb.pt(70,25)},scaleFactor:{defaultValue:1,get:function(){return this.getProperty("scaleFactor")||1}},baseFactor:{after:["submorphs"],derived:!0,get:function(){return this.get("value").baseFactor},set:function(P){this.get("value").baseFactor=P}},styleClasses:{defaultValue:["unfocused"]},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/number field/light"}}},fontColor:{isStyleProp:!0,
defaultValue:pb.Color.rgbHex("#0086b3"),set:function(P){this.setProperty("fontColor",P)}},isSelected:{set:function(P){this.getProperty("isSelected")!=P&&(P?(this.addStyleClass("selected"),this.removeStyleClass("unselected")):(this.removeStyleClass("selected"),this.addStyleClass("unselected")),this.setProperty("isSelected",P))}},fontFamily:{defaultValue:"Sans-Serif",isStyleProp:!0,set:function(P){this.setProperty("fontFamily",P)}},fontSize:{defaultValue:15,isStyleProp:!0,set:function(P){this.setProperty("fontSize",
P)}},layout:{initialize:function(){this.layout=new pb.TilingLayout({axis:"column",orderByIndex:!0,align:"center"})}},submorphs:{after:["min","max"],initialize:function(){var P=this;this.submorphs=[new pb.ValueScrubber({name:"value",unit:this.unit,floatingPoint:this.floatingPoint,scaleToBounds:!1,min:this.min,max:this.max}),pb.Icon.makeLabel("sort-up",{name:"up"}),pb.Icon.makeLabel("sort-up",{name:"down",rotation:Math.PI})];pb.connect(this.get("value"),"scrub",this,"update");this.whenRendered().then(function(){return P.relayout()})}}}}}],
Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10643,end:16590})}(pb.Morph));pb.NumberWidget=ib;pb.NumberWidget=ib;pb.NumberWidget=ib;Vc=function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),xb=Aa.hasOwnProperty("ShadowWidget")&&"function"===typeof Aa.ShadowWidget?
Aa.ShadowWidget:Aa.ShadowWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==Xa.nextAddress)return wa=new pb.popovers.ShadowPopover({hasFixedPosition:!!P.ownerChain().find(function(Db){return Db.hasFixedPosition}),shadowValue:P.shadowValue}),
Xa.yield(wa.fadeIntoWorld(P.globalBounds().center()),2);pb.connect(wa,"shadowValue",P,"shadowValue");pb.connect(P,"shadowValue",P,"update");pb.signal(P,"openWidget",wa);Xa.jumpToEnd()})}},{key:"update",value:function(){this.renderShadowDisplay()}},{key:"renderShadowDisplay",value:function(){this.shadowValue?1<this.submorphs.length?this.updateShadowDisplay():this.initShadowDisplay():this.submorphs=[{opacity:.8,reactsToPointer:!1,styleClasses:["TreeLabel"],name:"valueString",type:"label",value:"No Shadow"}]}},
{key:"updateShadowDisplay",value:function(){var P=this.shadowValue,wa=P.blur,Xa=P.spread,Db=P.distance;P=P.color;var mc=$jscomp.makeIterator(this.submorphs),Sb=mc.next().value,Tc=mc.next().value;Tc=$jscomp.makeIterator(Tc.submorphs).next().value;mc=mc.next().value;Sb.value=(this.shadowValue.inset?"inset":"drop")+"-shadow(";Tc.fill=P;mc.value=", "+wa+"px, "+Db+"px, "+Xa+"px)"}},{key:"initShadowDisplay",value:function(){var P=this.shadowValue,wa=P.blur,Xa=P.spread,Db=P.distance;P=P.color;this.submorphs=
[{name:"valueString",opacity:.7,reactsToPointer:!1,type:"label",value:(this.shadowValue.inset?"inset":"drop")+"-shadow("},pb.morph({fill:pb.Color.transparent,extent:pb.pt(this.fontSize+6,this.fontSize+4),submorphs:[{extent:pb.pt(this.fontSize,this.fontSize),position:pb.pt(2,2),fill:P,borderColor:pb.Color.black,borderWidth:1}]}),{name:"valueString",type:"label",opacity:.7,reactsToPointer:!1,value:", "+wa+"px, "+Db+"px, "+Xa+"px)"}]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShadowWidget"}},
{key:"properties",get:function(){return{shadowValue:{after:["submorphs"],defaultValue:null,set:function(P){this.setProperty("shadowValue",P);this.renderShadowDisplay()}},fill:{defaultValue:pb.Color.transparent},nativeCursor:{defaultValue:"pointer"},fontSize:{defaultValue:12},fontColor:{derived:!0,set:function(P){this.submorphs.forEach(function(wa){return wa.fontColor=P})}},isSelected:{defaultValue:!1,set:function(P){this.setProperty("isSelected",P);this.fontColor=P?pb.Color.white:pb.Color.black}},
layout:{initialize:function(){this.layout=new pb.HorizontalLayout}},submorphs:{initialize:function(){this.update()}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:16599,end:19722})}(pb.Morph);pb.ShadowWidget=Vc;pb.ShadowWidget=Vc;pb.ShadowWidget=Vc;Vc=function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),
xb=Aa.hasOwnProperty("PointWidget")&&"function"===typeof Aa.PointWidget?Aa.PointWidget:Aa.PointWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==Xa.nextAddress)return wa=new pb.popovers.PointPopover({pointValue:P.pointValue,
hasFixedPosition:!!P.ownerChain().find(function(Db){return Db.hasFixedPosition})}),Xa.yield(wa.fadeIntoWorld(P.globalBounds().center()),2);pb.connect(wa,"pointValue",P,"pointValue");pb.signal(P,"openWidget",wa);Xa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PointWidget"}},{key:"properties",get:function(){return{isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?this.selectionFontColor:this.nonSelectionFontColor}},selectionFontColor:{isStyleProp:!0,
defaultValue:pb.Color.white},nonSelectionFontColor:{isStyleProp:!0,defaultValue:pb.Color.black},fontFamily:{defaultValue:pb.config.codeEditor.defaultStyle.fontFamily},nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},pointValue:{after:["textAndAttributes"],set:function(P){var wa=pb.Color.rgbHex("#0086b3");this.setProperty("pointValue",P);this.textAndAttributes=["pt(",null,P.x.toFixed(),{fontColor:wa},",",{},P.y.toFixed(),{fontColor:wa},")",null];this.fixedHeight=this.fixedWidth=
!0;this.height=20;this.width=this.textString.length*this.fontSize}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:19731,end:21375})}(pb.Label);pb.PointWidget=Vc;pb.PointWidget=Vc;pb.PointWidget=Vc;Vc=function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),
xb=Aa.hasOwnProperty("PaddingWidget")&&"function"===typeof Aa.PaddingWidget?Aa.PaddingWidget:Aa.PaddingWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==Xa.nextAddress)return wa=new pb.popovers.RectanglePopover({hasFixedPosition:!!P.ownerChain().find(function(Db){return Db.hasFixedPosition}),
rectangle:P.rectangle}),wa.relayout(),Xa.yield(wa.fadeIntoWorld(P.globalBounds().center()),2);pb.connect(wa,"rectangle",P,"rectangle");pb.signal(P,"openWidget",wa);Xa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PaddingWidget"}},{key:"properties",get:function(){return{nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},fontFamily:{defaultValue:pb.config.codeEditor.defaultStyle.fontFamily},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",
P);this.fontColor=P?pb.Color.white:pb.Color.black}},rectangle:{defaultValue:pb.rect(0),set:function(P){this.setProperty("rectangle",P);this.value=pb.obj.safeToString(P)}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:21384,end:22445})}(pb.Label);pb.PaddingWidget=Vc;pb.PaddingWidget=
Vc;pb.PaddingWidget=Vc;Vc=function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),xb=Aa.hasOwnProperty("IconWidget")&&"function"===typeof Aa.IconWidget?Aa.IconWidget:Aa.IconWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"onMouseDown",value:function(P){this.openPopover()}},{key:"openPopover",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==
Xa.nextAddress)return wa=new pb.popovers.IconPopover({hasFixedPosition:!!P.ownerChain().find(function(Db){return Db.hasFixedPosition})}),Xa.yield(wa.fadeIntoWorld(P.globalBounds().center()),2);pb.connect(wa,"select",P,"iconValue",{converter:function(Db){return Db&&pb.Icon.makeLabel(Db).value},varMapping:{Icon:pb.Icon}});pb.signal(P,"openWidget",wa);Xa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"IconWidget"}},{key:"properties",get:function(){return{fontColor:{defaultValue:pb.Color.gray.darker()},
fontFamily:{defaultValue:"FontAwesome"},nativeCursor:{defaultValue:"pointer"},iconValue:{derived:!0,get:function(){return this.value},set:function(P){this.value=P||"No Icon"}}}}}],Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22454,end:23385})}(pb.Label);pb.IconWidget=Vc;pb.IconWidget=
Vc;pb.IconWidget=Vc;Vc=function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),xb=Aa.hasOwnProperty("StringWidget")&&"function"===typeof Aa.StringWidget?Aa.StringWidget:Aa.StringWidget=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"truncate",value:function(P){return 200<P.length?P.slice(0,20)+"...":P}},{key:"onFocus",value:function(P){var wa=this,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){if(1==
Db.nextAddress)return ec._get(Object.getPrototypeOf(xb.prototype),"onFocus",wa).call(wa,P),wa.readOnly?Db.return():wa.stringTooLong?Db.yield(wa.world().editPrompt("edit string",{requester:wa,input:wa.stringValue}),2):(wa.borderColor=pb.Color.white.withA(.9),wa.textString=wa.stringValue,Db.return());Xa=Db.yieldResult;if("string"===typeof Xa)wa.onInput(Xa);Db.jumpToEnd()})}},{key:"onBlur",value:function(P){ec._get(Object.getPrototypeOf(xb.prototype),"onBlur",this).call(this,P);this.readOnly||(this.borderColor=
pb.Color.transparent,this.onInput(this.textString))}},{key:"onInput",value:function(P){this.owner.focus();pb.signal(this,"inputAccepted",P);this.stringValue=P}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:pb.Color.transparent},fontColor:{defaultValue:pb.Color.blue},nativeCursor:{defaultValue:"auto"},borderColor:{defaultValue:pb.Color.transparent},borderStyle:{defaultValue:"dashed"},borderRadius:{defaultValue:4},
borderWidth:{defaultValue:1},padding:{defaultValue:pb.rect(0,0,0,0)},fixedWidth:{defaultValue:!1},fixedHeight:{defaultValue:!1},stringValue:{after:["textString"],set:function(P){this.setProperty("stringValue",P);this.textString=this.truncate(P);this.nativeCursor=this.stringTooLong?"pointer":"auto"}},stringTooLong:{readOnly:!0,get:function(){return this.stringValue.includes("\n")}},isSelected:{defaultValue:"false",set:function(P){this.setProperty("isSelected",P);this.fontColor=P?pb.Color.white:pb.Color.blue}}}}}],
Aa,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23394,end:25345})}(pb.InputLine);pb.StringWidget=Vc;pb.StringWidget=Vc;pb.StringWidget=Vc;pb.valueWidgets=Eb;Object.assign(pb.valueWidgets,{NumberWidget:pb.NumberWidget,StringWidget:pb.StringWidget,IconWidget:pb.IconWidget,PaddingWidget:pb.PaddingWidget,
ShadowWidget:pb.ShadowWidget,PointWidget:pb.PointWidget,BooleanWidget:pb.BooleanWidget,LayoutWidget:pb.LayoutWidget,ColorWidget:pb.ColorWidget});var bb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js");bb.Ellipse=Ab;bb.Icon=Qe;bb.Morph=kf;bb.Path=ge;bb.Text=Ic;bb.HorizontalLayout=Dc;bb.VerticalLayout=Qa;bb.morph=bc;bb.Color=lc;bb.pt=Kb;bb.rect=Pc;bb.Rectangle=$c;bb.arr=rb;bb.connect=cc;bb.disconnect=Nd;bb.LabeledCheckBox=vb;bb.DropDownSelector=ha;bb.Button=Ha;bb.Menu=W;bb.NumberWidget=ib;
bb.InteractiveMorphSelector=cd;bb.easings=md;(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),xb=Aa.hasOwnProperty("AxisHalo")&&"function"===typeof Aa.AxisHalo?Aa.AxisHalo:Aa.AxisHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var wa=P.halo;P=P.targetAxis;ec._get(Object.getPrototypeOf(xb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,{fill:bb.Color.transparent,halo:wa,targetAxis:P,container:wa.container});this.initialize()}},{key:"initialize",value:function(){this.setBounds(this.fetchBounds());this.minSlider=this.minSlider();this.axisMenu=this.axisMenu();this.proportionSlider=this.proportionSlider();this.proportionSlider.addMorph(this.minSlider);this.submorphs=[this.proportionSlider,this.axisMenu];this.halo.addGuide(this)}},{key:"forceMenuHidden",set:function(P){this._forceMenuHidden=P;this.axisMenu.visible=!P}},
{key:"forceMenuHidden",get:function(){return this._forceMenuHidden}},{key:"lastAxis",get:function(){return!this.targetAxis.after}},{key:"fetchBounds",value:function(){return this.fetchPosition().extent(this.fetchExtent())}},{key:"alignWithTarget",value:function(){this.extent=this.fetchExtent();this.position=this.fetchPosition();this.proportionSlider.alignWithTarget();this.axisMenu.alignWithTarget()}},{key:"onHoverIn",value:function(){this.minSlider.requestToShow();this.axisMenu.visible=!this.forceMenuHidden&&
!0}},{key:"onHoverOut",value:function(P){this.minSlider.requestToHide();this.axisMenu.visible=this.forceMenuVisible||!1}},{key:"proportionSlider",value:function(){var P=this,wa=this,Xa=this.proportionViewer();return this.halo.addGuide(new bb.Morph({nativeCursor:this.getResizeCursor(),fill:bb.Color.transparent,submorphs:[this.devider(),Xa],alignWithTarget:function(){this.setBounds(wa.getProportionSliderBounds(this))},onDragStart:function(){Xa.visible=!0},onDrag:function(Db){P.adjustStretch(P.getDelta(Db));
P.halo.alignWithTarget()},onDragEnd:function(){Xa.visible=!1}}))}},{key:"devider",value:function(){return new bb.Morph({visible:!this.lastAxis,fill:bb.Color.black.withA(.5),bounds:this.getDeviderBounds(),draggable:!1,reactsToPointer:!1})}},{key:"minSlider",value:function(){var P=this,wa=this,Xa=this.minSpaceVisualizer(),Db=this.minViewer();return this.halo.addGuide(new bb.Ellipse({nativeCursor:this.getResizeCursor(),fill:bb.Color.green,extent:bb.pt(10,10),visible:!1,submorphs:[Xa,Db],becomesActiveOnHover:!0,
alignWithTarget:function(){this.position=wa.getMinSliderPosition()},requestToShow:function(){this.visible=!wa.targetAxis.fixed},requestToHide:function(){this.active?this.shouldHide=!0:this.visible=!1},onDragStart:function(){wa.forceMenuHidden=!0;Db.visible=!0;this.active=Xa.visible=!0},onDrag:function(mc){P.targetAxis.min+=-P.getDelta(mc);P.halo.alignWithTarget()},onDragEnd:function(){wa.forceMenuHidden=!1;Db.visible=!1;this.active=Xa.visible=!1;this.shouldHide&&(this.shouldHide=this.visible=!1)}}))}},
{key:"minViewer",value:function(){var P=this;return this.viewer({position:this.getMinViewerPosition(),alignWithTarget:function(){this.textString="min: "+P.targetAxis.min.toFixed()+"px !"}})}},{key:"minSpaceBorder",value:function(){return new bb.Path(Object.assign({position:bb.pt(-1,-1),borderStyle:"dashed",borderColor:bb.Color.green,borderWidth:2},this.getMinSpaceBorder()))}},{key:"minSpaceVisualizer",value:function(){var P=this,wa=this.minSpaceBorder();return this.halo.addGuide(new bb.Morph({fill:bb.Color.green.withA(.1),
visible:!1,isHaloItem:!0,submorphs:[wa],alignWithTarget:function(){this.extent=P.getMinSpaceExtent();this.topLeft=bb.pt(5,5)}}))}},{key:"axisMenu",value:function(){var P=this.lockButton(),wa=this.menuButton(),Xa=this;return new bb.Morph({layout:this.getMenuLayout(),submorphs:[P,wa],fill:bb.Color.transparent,visible:!1,becomesActiveOnHover:!0,alignWithTarget:function(){this.bottomRight=this.owner.extent.subPt(Xa.getMenuOffset(this))}})}},{key:"lockButton",value:function(){var P=this;return this.halo.addGuide(new bb.Morph({fill:bb.Color.transparent,
extent:bb.pt(25,25),submorphs:[{center:bb.pt(12.5,12.5),fill:bb.Color.transparent,styleClasses:["fa","fa-unlock"]}],alignWithTarget:function(){P.targetAxis.fixed?(this.fontColor=bb.Color.red,this.submorphs[0].styleClasses=["fa","fa-lock"]):(this.fontColor=bb.Color.green,this.submorphs[0].styleClasses=["fa","fa-unlock"])},onMouseDown:function(){this.toggleLock()},toggleLock:function(){P.targetAxis.fixed=!P.targetAxis.fixed;P.halo.alignWithTarget()}}))}},{key:"menuButton",value:function(){var P=this,
wa=this;return new bb.Morph({fill:bb.Color.transparent,extent:bb.pt(25,25),submorphs:[{fill:bb.Color.transparent,styleClasses:["fa","fa-cog"],center:bb.pt(12.5,12.5)}],onMouseDown:function(Xa){wa.forceMenuVisible=!0;this.addMorph(Xa.state.menu=new bb.Menu({position:bb.pt(15,15),items:[["Remove "+wa.subject,function(){P.targetAxis.remove();P.halo.initGuides();P.halo.alignWithTarget()}],["Insert "+wa.subject+" before",function(){P.targetAxis.addBefore();P.halo.initGuides();P.halo.alignWithTarget()}],
["Insert "+wa.subject+" after",function(){P.targetAxis.addAfter();P.halo.initGuides();P.halo.alignWithTarget()}]]}))}})}},{key:"viewer",value:function(P){var wa=P.position;P=P.alignWithTarget;return this.halo.addGuide(new bb.Text({styleClasses:["Halo"],padding:bb.Rectangle.inset(6),visible:!1,borderRadius:10,fontColor:bb.Color.white,fill:bb.Color.black.withA(.5),position:wa,alignWithTarget:P,readOnly:!0}))}},{key:"proportionViewer",value:function(){var P=this;return this.viewer({position:this.getProportionViewerPosition(),
alignWithTarget:function(){this.textString=P.targetAxis.length.toFixed(1)+"px"}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"AxisHalo"}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:660,end:7979})})(bb.Morph);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
xb=Aa.hasOwnProperty("RowHalo")&&"function"===typeof Aa.RowHalo?Aa.RowHalo:Aa.RowHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var wa=P.row;P=P.halo;ec._get(Object.getPrototypeOf(xb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:P.target.row(wa),halo:P})}},{key:"subject",get:function(){return"row"}},
{key:"adjustStretch",value:function(P){this.targetAxis.height+=P}},{key:"getDelta",value:function(P){return P.state.dragDelta.y}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.y}},{key:"fetchPosition",value:function(){return bb.pt(-45,this.axisOffset()+10)}},{key:"fetchExtent",value:function(){return bb.pt(40,this.targetAxis.length-10)}},{key:"getMenuOffset",value:function(P){return this.targetAxis.length>P.height?bb.pt(2,5):bb.pt(26,10)}},{key:"getMenuLayout",value:function(){return new bb.VerticalLayout}},
{key:"getResizeCursor",value:function(){return"row-resize"}},{key:"getMinViewerPosition",value:function(){return bb.pt(50,20)}},{key:"getMinSliderPosition",value:function(){return bb.pt(0,-this.targetAxis.min)}},{key:"getMinSpaceExtent",value:function(){return bb.pt(this.container.width+45,this.targetAxis.min)}},{key:"getMinSpaceBorder",value:function(){return{extent:bb.pt(this.container.width+50,2),vertices:[bb.pt(0,1),bb.pt(this.container.width+50,1)]}}},{key:"getProportionViewerPosition",value:function(){return bb.pt(40,
20)}},{key:"getProportionSliderBounds",value:function(P){return bb.pt(0,P.owner.height-5).extent(bb.pt(40,10))}},{key:"getDeviderBounds",value:function(){return bb.pt(15,4).extent(bb.pt(25,2))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RowHalo"}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:7981,end:9208})})(bb.AxisHalo);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),xb=Aa.hasOwnProperty("ColumnHalo")&&"function"===typeof Aa.ColumnHalo?Aa.ColumnHalo:Aa.ColumnHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:Symbol.for("lively-instance-initialize"),value:function(P){var wa=P.col;P=P.halo;ec._get(Object.getPrototypeOf(xb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:P.target.col(wa),halo:P})}},{key:"subject",get:function(){return"column"}},{key:"adjustStretch",value:function(P){this.targetAxis.width+=P}},{key:"getDelta",value:function(P){return P.state.dragDelta.x}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.x}},{key:"fetchPosition",value:function(){return bb.pt(this.axisOffset()+10,-45)}},{key:"fetchExtent",value:function(){return bb.pt(this.targetAxis.length-
10,40)}},{key:"getMenuOffset",value:function(P){return this.targetAxis.length>P.width?bb.pt(5,3):bb.pt(8,26)}},{key:"getMenuLayout",value:function(){return new bb.HorizontalLayout}},{key:"getResizeCursor",value:function(){return"col-resize"}},{key:"getMinViewerPosition",value:function(){return bb.pt(20,50)}},{key:"getMinSliderPosition",value:function(){return bb.pt(-this.targetAxis.min,0)}},{key:"getMinSpaceExtent",value:function(){return bb.pt(this.targetAxis.min,this.container.height+45)}},{key:"getMinSpaceBorder",
value:function(){return{extent:bb.pt(2,this.container.height+50),vertices:[bb.pt(1,0),bb.pt(1,this.container.height+50)]}}},{key:"getProportionViewerPosition",value:function(){return bb.pt(20,40)}},{key:"getProportionSliderBounds",value:function(P){return bb.pt(P.owner.width-5,0).extent(bb.pt(10,40))}},{key:"getDeviderBounds",value:function(){return bb.pt(4,15).extent(bb.pt(2,25))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColumnHalo"}}],Aa,{pathInPackage:function(){return"layout.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:9210,end:10442})})(bb.AxisHalo);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),xb=Aa.hasOwnProperty("CellGuide")&&"function"===typeof Aa.CellGuide?Aa.CellGuide:Aa.CellGuide=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return ec(xb,ma,[{key:"menuItems",value:function(){var P=this,wa=bb.Icon.textAttribute("check-square-o"),Xa=bb.Icon.textAttribute("square-o");wa[1].textStyleClasses.push("annotation");Xa[1].textStyleClasses.push("annotation");Xa[1].paddingRight="2px";return[["Resize Policy",[[["Rigid  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?Xa:wa)),function(){P.cellGroup.resize=!1}],[["Space Filling  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?wa:Xa)),function(){P.cellGroup.resize=
!0}]]],["Align at...",["center"].concat($jscomp.arrayFromIterable((new bb.Rectangle).sides),$jscomp.arrayFromIterable((new bb.Rectangle).corners)).map(function(Db){return[[Db,{paddingRight:"2px"}].concat($jscomp.arrayFromIterable(P.cellGroup.align==Db?wa:Xa),["  ",null]),function(){return P.cellGroup.align=Db}]})]].concat(this.cellGroup.morph?[["Release Morph from Cell",function(){var Db=P.cellGroup.morph;Db&&(P.world().firstHand.grab(Db),P.world().firstHand.longClickGrab=!0,Db.position=bb.pt(0))}]]:
[])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CellGuide"}},{key:"properties",get:function(){return{cellGroup:{}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10444,end:11722})})(bb.Morph);(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
xb=Aa.hasOwnProperty("LayoutHalo")&&"function"===typeof Aa.LayoutHalo?Aa.LayoutHalo:Aa.LayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutHalo"}},{key:"properties",get:function(){return{container:{},target:{},pointerId:{},halosEnabled:{defaultValue:!1},isEpiMorph:{defaultValue:!0},isHaloItem:{defaultValue:!0},borderColor:{defaultValue:bb.Color.orange},
borderWidth:{defaultValue:2},styleClasses:{defaultValue:["Halo"]}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:11724,end:12137})})(bb.Morph);Eb=Ca("G",function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),xb=Aa.hasOwnProperty("GridLayoutHalo")&&"function"===
typeof Aa.GridLayoutHalo?Aa.GridLayoutHalo:Aa.GridLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"previewDrop",value:function(P){1>P.length||(P=this.cellGuides.find(function(wa){return wa.fullContainsWorldPoint($world.firstHand.position)}),P!=this.currentCell&&this.currentCell&&this.currentCell.stopPreview(),(this.currentCell=P)&&this.currentCell.startPreview())}},{key:"handleDrop",value:function(P){var wa=
this;this.currentCell&&P.whenRendered().then(function(){return wa.currentCell.cellGroup.morph=P})}},{key:"initialize",value:function(){this.initGuides();this.alignWithTarget();this.focus()}},{key:"optionControls",value:function(){var P=this.target,wa=new bb.LabeledCheckBox({name:"compensateOrigin",label:"Compensate Origin",fill:bb.Color.transparent,checked:P.compensateOrigin}),Xa=new bb.LabeledCheckBox({label:"Resize Submorphs",fill:bb.Color.transparent,name:"fitToCell",checked:P.fitToCell});bb.connect(wa,
"checked",P,"compensateOrigin");bb.connect(Xa,"checked",P,"fitToCell");bb.connect(wa,"checked",this,"alignWithTarget");return[wa,Xa]}},{key:"isLayoutHalo",get:function(){return!1}},{key:"alignWithTarget",value:function(){this.target.apply();this.position=this.container.globalPosition;this.target.compensateOrigin&&this.moveBy(this.container.origin.negated());this.extent=this.container.extent;this.addMissingGuides();bb.arr.reverse(this.guides).forEach(function(P){return P.alignWithTarget()})}},{key:"addMissingGuides",
value:function(){var P=this;bb.arr.withoutAll(this.target.cellGroups,this.guides.map(function(wa){return wa.cellGroup})).forEach(function(wa){return P.addMorph(P.cellGuide(wa))})}},{key:"initGuides",value:function(){this.submorphs=[];this.guides=[];this.initCellGuides();this.initColumnGuides();this.initRowGuides()}},{key:"initCellGuides",value:function(){var P=this,wa=this.addMorph({fill:bb.Color.transparent,borderRadius:this.borderRadius,extent:this.extent});this.target.cellGroups.forEach(function(Xa){wa.addMorph(P.cellGuide(Xa))});
this.cellGuides=wa.submorphs;this.addMorph(this.resizer())}},{key:"addGuide",value:function(P){P.isHaloItem=!0;this.guides.push(P);return P}},{key:"initRowGuides",value:function(){var P=this,wa=this;this.addGuide(this.addMorph(new bb.Morph({width:25,fill:bb.Color.gray.withA(.7),borderRadius:15,height:this.container.height,topRight:bb.pt(-5,0),alignWithTarget:function(){this.height=wa.container.height}})));bb.arr.range(0,this.target.rowCount-1).forEach(function(Xa){P.addMorph(new bb.RowHalo({row:Xa,
halo:P}))})}},{key:"initColumnGuides",value:function(){var P=this,wa=this;this.addGuide(this.addMorph(new bb.Morph({height:25,fill:bb.Color.gray.withA(.7),borderRadius:15,width:this.container.width,bottomLeft:bb.pt(0,-5),alignWithTarget:function(){this.width=wa.container.width}})));bb.arr.range(0,this.target.columnCount-1).forEach(function(Xa){P.addMorph(new bb.ColumnHalo({col:Xa,halo:P}))})}},{key:"resizer",value:function(){var P=this;return this.addGuide(new bb.Morph({fill:bb.Color.transparent,
extent:bb.pt(25,25),nativeCursor:"nwse-resize",onDrag:function(wa){P.container.resizeBy(wa.state.dragDelta);P.alignWithTarget()},alignWithTarget:function(){this.bottomRight=P.extent}}))}},{key:"cellResizer",value:function(P,wa){var Xa=this,Db="topLeft"==wa?"bottomRight":"topLeft";return new bb.Ellipse({borderWidth:1,visible:!1,borderColor:bb.Color.black,nativeCursor:"nwse-resize",removeCell:function(mc){P.disconnect(mc);Xa.alignWithTarget()},addCell:function(mc){P.connect(mc);Xa.alignWithTarget()},
start:function(){this.fixpointCell=P[Db];this.draggedDelta=P.bounds().partNamed(wa);this.debugMorph=Xa.addMorph(new bb.Morph({fill:bb.Color.orange.withA(.5)}))},update:function(mc){var Sb=this;this.draggedDelta=this.draggedDelta.addPt(mc);var Tc=bb.Rectangle.unionPts([this.draggedDelta]).union(this.fixpointCell.bounds());this.debugMorph.setBounds(Tc);Xa.cells.forEach(function(gd){var se=Tc.intersection(gd.bounds()).area()/gd.bounds().area();P.includes(gd)&&.1>se&&Sb.removeCell(gd);!P.includes(gd)&&
se>1/3&&Sb.addCell(gd)})},onDragEnd:function(mc){this.debugMorph.remove()},onDragStart:function(mc){this.start(mc.position)},onDrag:function(mc){this.update(mc.state.dragDelta)}})}},{key:"cellGuide",value:function(P){var wa=this,Xa=this.cellResizer(P,"topLeft"),Db=this.cellResizer(P,"bottomRight");return this.addGuide(new bb.CellGuide({cellGroup:P,bounds:P.bounds(),fill:bb.Color.transparent,borderColor:bb.Color.orange,borderWidth:1,isHaloItem:!0,isCell:!0,draggable:!1,submorphs:[Xa,Db],onMouseDown:function(mc){this.becomeActive()},
deactivate:function(){this.borderColor=bb.Color.orange;this.fill=bb.Color.transparent;this.submorphs.forEach(function(mc){mc.visible=!1})},becomeActive:function(){wa.guides.forEach(function(mc){mc.isCell&&mc.deactivate()});this.borderColor=bb.Color.rgbHex("#1565C0");this.fill=bb.Color.rgbHex("#1565C0").withA(.3);wa.addMorph(this.remove());this.submorphs.forEach(function(mc){mc.visible=!0})},startPreview:function(mc){this.fill=bb.Color.orange.withA(.7)},stopPreview:function(mc){this.fill=bb.Color.transparent},
onDrop:function(mc){var Sb=$jscomp.makeIterator(mc.hand.grabbedMorphs).next().value;mc.hand.dropMorphsOn(wa.container);P.morph=Sb},alignWithTarget:function(){P.bounds().isNonEmpty()?(this.setBounds(P.bounds()),Xa.center=this.innerBounds().topLeft(),Db.center=this.innerBounds().bottomRight()):(bb.arr.remove(wa.guides,this),this.remove())}}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GridLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:bb.Color.transparent},
cells:{derived:!0,get:function(){return bb.arr.flatten(this.target.col(0).items.map(function(P){return P.row(0).items}))}},submorphs:{initialize:function(){this.initialize()}}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:12146,end:19501})}(bb.LayoutHalo));bb.GridLayoutHalo=Eb;bb.GridLayoutHalo=
Eb;bb.GridLayoutHalo=Eb;ib=function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),xb=Aa.hasOwnProperty("TilingLayoutHalo")&&"function"===typeof Aa.TilingLayoutHalo?Aa.TilingLayoutHalo:Aa.TilingLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"remove",value:function(){ec._get(Object.getPrototypeOf(xb.prototype),"remove",this).call(this);this.removePreviews();return this}},
{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"handleDrop",value:function(P){}},{key:"removePreviews",value:function(){this.previews.forEach(function(P){return P.clear()})}},{key:"previewDrop",value:function(P){var wa=this;0<this.previews.length||(this.previews=P.map(function(Xa){return wa.container.addMorph({type:bb.DropPreview,bounds:Xa.bounds()})}),this.previews.forEach(function(Xa){Xa.step()}))}},{key:"updateSpacing",value:function(P){this.target.spacing=
P}},{key:"updateAxis",value:function(P){this.target.axis=P}},{key:"updateAlign",value:function(P){this.target.align=P}},{key:"optionControls",value:function(){var P=this.target,wa=new bb.DropDownSelector({borderRadius:2,padding:3,selectedValue:P.axis,values:["row","column"]}),Xa=new bb.DropDownSelector({borderRadius:2,padding:3,selectedValue:P.align,values:["left","center"]});P=new bb.NumberWidget({min:0,number:P.spacing,padding:bb.rect(5,3,0,0),borderRadius:3,borderWidth:1,borderColor:bb.Color.gray,
unit:"px"});bb.connect(P,"update",this,"updateSpacing");bb.connect(Xa,"update",this,"updateAlign");bb.connect(wa,"update",this,"updateAxis");var Db={type:"label",padding:bb.rect(0,5,5,5),fill:bb.Color.transparent,fontColor:bb.Color.gray.darker(),readOnly:!0};return[[Object.assign({},Db,{textString:"Submorph Spacing"}),P],[Object.assign({},Db,{textString:"Tiling Align"}),Xa],[Object.assign({},Db,{textString:"Tiling Axis"}),wa]].map(function(mc){return{submorphs:mc,fill:null,layout:new bb.HorizontalLayout({spacing:3})}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TilingLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:bb.Color.transparent},previews:{defaultValue:[]}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:19510,end:21708})}(bb.LayoutHalo);bb.TilingLayoutHalo=
ib;bb.TilingLayoutHalo=ib;bb.TilingLayoutHalo=ib;(function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),xb=Aa.hasOwnProperty("DropPreview")&&"function"===typeof Aa.DropPreview?Aa.DropPreview:Aa.DropPreview=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"clear",value:function(){this.stopped=!0;this.remove()}},{key:"step",value:function(){var P=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==
Xa.nextAddress)return wa=bb.easings.inOutQuad,Xa.yield(P.animate({opacity:.5,duration:(P.pulseDuration-10)/2,easing:wa}),2);if(3!=Xa.nextAddress)return Xa.yield(P.animate({opacity:1,duration:(P.pulseDuration-10)/2,easing:wa}),3);P.stopped||P.step();Xa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DropPreview"}},{key:"properties",get:function(){return{isHaloItem:{readOnly:!0,get:function(){return!0}},epiMorph:{readOnly:!0,get:function(){return!0}},fill:{defaultValue:bb.Color.orange.withA(.3)},
hasFixedPosition:{defaultValue:!0},borderColor:{defaultValue:bb.Color.orange},borderWidth:{defaultValue:2},borderStyle:{defaultValue:"dashed"},pulseDuration:{defaultValue:2E3}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21710,end:22534})})(bb.Morph);ib=Ca("F",function(ma){var Aa=
lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),xb=Aa.hasOwnProperty("FlexLayoutHalo")&&"function"===typeof Aa.FlexLayoutHalo?Aa.FlexLayoutHalo:Aa.FlexLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"handleDrop",value:function(P){}},{key:"previewDrop",value:function(P){var wa=this;0<this.previews.length||(this.previews=P.map(function(Xa){return wa.container.addMorph({type:bb.DropPreview,
position:wa.container.localize(wa.world().firstHand.position),extent:Xa.bounds().extent()})}),this.previews.forEach(function(Xa){Xa.step()}))}},{key:"remove",value:function(){ec._get(Object.getPrototypeOf(xb.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"removePreviews",value:function(){this.previews.forEach(function(P){return P.clear()})}},{key:"onDrop",value:function(P){this.removePreviews();P.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},
{key:"updateAutoResizePolicy",value:function(P){P&&(this.originalExtent=this.container.extent);this.target.autoResize=P;P||(this.container.extent=this.originalExtent||this.container.extent);this.alignWithTarget()}},{key:"updateResizeSubmorphsPolicy",value:function(P){this.target.resizeSubmorphs=P;this.alignWithTarget()}},{key:"updateAlignmentPolicy",value:function(P){this.target.align=P}},{key:"updateDirectionPolicy",value:function(P){this.target.direction=P}},{key:"updateSpacing",value:function(P){this.target.spacing=
P}},{key:"optionControls",value:function(){var P=this.target,wa=P.possibleAlignValues?{fill:bb.Color.transparent,layout:new bb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"align: "},new bb.DropDownSelector({name:"alignment",borderRadius:2,padding:3,selectedValue:P.align,values:P.possibleAlignValues})]}:null,Xa=P.possibleDirectionValues?{fill:bb.Color.transparent,layout:new bb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",
value:"direction: "},new bb.DropDownSelector({name:"direction",borderRadius:2,padding:3,selectedValue:P.direction,values:P.possibleDirectionValues})]}:null,Db=new bb.NumberWidget({fill:bb.Color.white,borderWidth:1,borderRadius:4,padding:bb.rect(5,4,0,0),borderColor:bb.Color.gray,min:0,number:P.spacing,unit:"px"}),mc=new bb.LabeledCheckBox({name:"autoResize",label:"Resize Container",alignCheckBox:"right",fill:bb.Color.transparent,checked:P.autoResize});P=new bb.LabeledCheckBox({label:"Resize Submorphs",
name:"resizeSubmorphs",alignCheckBox:"right",fill:bb.Color.transparent,checked:P.resizeSubmorphs});bb.connect(Db,"update",this,"updateSpacing");bb.connect(mc,"checked",this,"updateAutoResizePolicy");bb.connect(P,"checked",this,"updateResizeSubmorphsPolicy");wa&&bb.connect(wa.submorphs[1],"selectedValue",this,"updateAlignmentPolicy");Xa&&bb.connect(Xa.submorphs[1],"selectedValue",this,"updateDirectionPolicy");return[mc,P].concat($jscomp.arrayFromIterable([wa,Xa].filter(Boolean)),[{fill:bb.Color.transparent,
layout:new bb.HorizontalLayout,submorphs:[{type:"label",value:"Submorph Spacing",fontColor:bb.Color.gray.darker(),padding:bb.rect(0,5,5,5)},Db]}])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FlexLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},fill:{defaultValue:bb.Color.transparent},halosEnabled:{defaultValue:!1},previews:{defaultValue:[]}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:22543,end:26761})}(bb.LayoutHalo));bb.FlexLayoutHalo=ib;bb.FlexLayoutHalo=ib;bb.FlexLayoutHalo=ib;Vc=Ca("c",function(ma){var Aa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),xb=Aa.hasOwnProperty("ProportionalLayoutHalo")&&"function"===typeof Aa.ProportionalLayoutHalo?Aa.ProportionalLayoutHalo:Aa.ProportionalLayoutHalo=function(P){P&&P[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ec(xb,ma,[{key:"handleDrop",value:function(P){}},{key:"onDrop",value:function(P){P.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateSubmorphProportionalLayoutSettings",value:function(P){var wa={};this.target.changeSettingsFor(P.submorph,(wa[P.axis]=P.policy,wa),!0)}},{key:"onSubmorphSettingsDragStart",value:function(P,wa){var Xa=this;P.stop();
var Db=this.target.settingsFor(wa);wa="";for(var mc in Db)wa+=mc+":"+Db[mc]+" ";var Sb=bb.morph({type:"label",value:wa,isLayoutable:!1});Sb.wantsToBeDroppedOn=function(Tc){return Xa.target.layoutableSubmorphs.includes(Tc)};Sb.onBeingDroppedOn=function(Tc,gd){Sb.remove();if(Tc=Xa.target.layoutableSubmorphs.includes(gd)?gd:P.world.morphsContainingPoint(P.hand.position).find(function(se){return Xa.target.layoutableSubmorphs.includes(se)}))Xa.updateSubmorphProportionalLayoutSettings({policy:Db.x,axis:"x",
submorph:Tc}),Xa.updateSubmorphProportionalLayoutSettings({policy:Db.y,axis:"y",submorph:Tc}),Tc.show(),$world.setStatusMessage("layout settings applied")};P.hand.grab(Sb)}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var P=this,wa,Xa,Db,mc,Sb,Tc,gd,se,Cf,me,Se,Ze;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yf){switch(yf.nextAddress){case 1:return wa=P.target.layoutableSubmorphs,P.env.eventDispatcher.isKeyPressed("Shift")?(Db=wa.map(function(vd){return{isListItem:!0,
string:String(vd),value:vd}}),yf.yield($world.listPrompt("Select morph",Db,{requester:P,onSelection:function(vd){return vd.show()}}),5)):yf.yield(bb.InteractiveMorphSelector.selectMorph(P.world(),P,function(vd){return wa.includes(vd)}),4);case 4:Xa=yf.yieldResult;yf.jumpTo(3);break;case 5:mc=yf.yieldResult,Sb=$jscomp.makeIterator(mc.selected),Xa=Sb.next().value;case 3:if(!Xa)return yf.return();Tc=P.state.popover.get("controlContainer");gd=Tc.getAllNamed(/submorph config/);se=["move","resize","scale",
"fixed"];Cf=P.target.settingsFor(Xa);gd.length||(Tc.submorphs=[].concat($jscomp.arrayFromIterable(Tc.submorphs),[{name:"submorph config X-Axis policy",position:bb.pt(0,P.height),fill:bb.Color.transparent,layout:new bb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph X-Axis policy: "},new bb.DropDownSelector({name:"x-axis policy selector",borderRadius:2,padding:3,selectedValue:Cf.x,values:se})]},{name:"submorph config Y-Axis policy",position:bb.pt(0,
P.height),fill:bb.Color.transparent,layout:new bb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph Y-Axis policy: "},new bb.DropDownSelector({name:"y-axis policy selector",borderRadius:2,padding:3,selectedValue:Cf.y,values:se})]},bb.morph({position:bb.pt(0,P.height+20),draggable:!0,name:"dragme",type:"label",value:"drag me to copy"})]));me=Tc.getSubmorphNamed("x-axis policy selector");Se=Tc.getSubmorphNamed("y-axis policy selector");Ze=Tc.getSubmorphNamed("dragme");
bb.disconnect(me,"selectedValue",P,"updateSubmorphProportionalLayoutSettings");bb.disconnect(Se,"selectedValue",P,"updateSubmorphProportionalLayoutSettings");me.selectedValue=Cf.x;Se.selectedValue=Cf.y;bb.connect(Ze,"onDragStart",P,"onSubmorphSettingsDragStart",{updater:function(vd,Ve){return vd(Ve,Xa)},varMapping:{submorph:Xa}});bb.connect(me,"selectedValue",P,"updateSubmorphProportionalLayoutSettings",{converter:function(vd){return{policy:vd,axis:"x",submorph:Xa}},varMapping:{submorph:Xa}});bb.connect(Se,
"selectedValue",P,"updateSubmorphProportionalLayoutSettings",{converter:function(vd){return{policy:vd,axis:"y",submorph:Xa}},varMapping:{submorph:Xa}});yf.jumpToEnd()}})}},{key:"optionControls",value:function(P){this.state.popover=P;var wa=this.target;P=new bb.LabeledCheckBox({name:"x-axis",label:"X-Axis",alignCheckBox:"right",fill:bb.Color.transparent,checked:wa.xAxisEnabled});wa=new bb.LabeledCheckBox({name:"y-axis",label:"Y-Axis",alignCheckBox:"right",fill:bb.Color.transparent,checked:wa.yAxisEnabled});
var Xa=new bb.Button({name:"modify submorph settings button",label:[].concat($jscomp.arrayFromIterable(bb.Icon.textAttribute("crosshairs")),["\u00a0Change submorph settings"])});bb.connect(P,"checked",this,"updateXAxisEnabled");bb.connect(wa,"checked",this,"updateYAxisEnabled");bb.connect(Xa,"fire",this,"chooseSubmorphToChangeLayoutSettings");return[Xa]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProportionalLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},
fill:{defaultValue:bb.Color.transparent}}}}],Aa,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:26771,end:32465})}(bb.LayoutHalo));bb.ProportionalLayoutHalo=Vc;bb.ProportionalLayoutHalo=Vc;bb.ProportionalLayoutHalo=Vc;var Oc=lively.FreezerRuntime.recorderFor("lively.halos/index.js");Oc.Halo=
ad;Oc.MorphHighlighter=ub;Oc.InteractiveMorphSelector=cd;Oc.StatusMessage=Zd;Oc.StatusMessageForMorph=Id;Oc.show=sc;Oc.showConnector=wd;Oc.ProportionalLayoutHalo=Vc;Oc.GridLayoutHalo=Eb;Oc.FlexLayoutHalo=ib;Oc.showAndSnapToGuides=Za;Oc.removeSnapToGuidesOf=ra;Oc.StatusMessage=Zd;Oc.StatusMessage=Zd;Oc.StatusMessageForMorph=Id;Oc.StatusMessageForMorph=Id;Oc.show=sc;Oc.show=sc;Oc.showConnector=wd;Oc.showConnector=wd;Oc.Halo=ad;Oc.Halo=ad;Oc.MorphHighlighter=ub;Oc.MorphHighlighter=ub;Oc.InteractiveMorphSelector=
cd;Oc.InteractiveMorphSelector=cd;Oc.ProportionalLayoutHalo=Vc;Oc.ProportionalLayoutHalo=Vc;Oc.GridLayoutHalo=Eb;Oc.GridLayoutHalo=Eb;Oc.FlexLayoutHalo=ib;Oc.FlexLayoutHalo=ib;Oc.showAndSnapToGuides=Za;Oc.showAndSnapToGuides=Za;Oc.removeSnapToGuidesOf=ra;Oc.removeSnapToGuidesOf=ra;Zd=Object.freeze({__proto__:null,StatusMessage:Zd,StatusMessageForMorph:Id,show:sc,showConnector:wd,Halo:ad,MorphHighlighter:ub,InteractiveMorphSelector:cd,ProportionalLayoutHalo:Vc,GridLayoutHalo:Eb,FlexLayoutHalo:ib,showAndSnapToGuides:Za,
removeSnapToGuidesOf:ra,SvgStyleHalo:void 0});Ca("i",Zd);Ca("_",void 0)}}});
System.register(["./__root_module__-db735625.js","./index-2260babb.js","./index-7ce4e91c.js"],function(db){var Zb,lc,Uc,Bc,Vd,Od,je,Bd,jd,zd,ge,We,kf,bf,Hd,Ae,uc,wd,ce,Gd,pe,Te,rc,bd,he,cd,ie,ac,Db,Tc,Nc,wc,Vc,hb,zc,Ub,Jc,Wc,Ad,Xd,xc,Pc,sc;return{setters:[function(Za){Zb=Za.C;lc=Za.i;Uc=Za.b;Bc=Za.R;Vd=Za.p;Od=Za.m;je=Za.bq;Bd=Za.br;jd=Za.d;zd=Za.c;ge=Za.at;We=Za.bz;kf=Za.bA;bf=Za._;Hd=Za.o;Ae=Za.n;uc=Za.g;wd=Za.bB;ce=Za.bC;Gd=Za.a2;pe=Za.P;Te=Za.a;rc=Za.a1;bd=Za.M;he=Za.T;cd=Za.ad;ie=Za.ah;
ac=Za.S;Db=Za.I;Tc=Za.h;Nc=Za.bD;wc=Za.v;Vc=Za.bE;hb=Za.aE;zc=Za.bs;Ub=Za.aD;Jc=Za.bF;Wc=Za.f},function(Za){Ad=Za.M;Xd=Za.I;xc=Za.v;Pc=Za.p},function(Za){sc=Za.localInterface}],execute:function(){function Za(lb,cb){if(!0===cb)return cb;if(lb.copyState)return lb.copyState(cb);lb={};for(var Cc in cb){var La=cb[Cc];La instanceof Array&&(La=La.concat([]));lb[Cc]=La}return lb}function Pa(lb,cb,Cc){return lb.startState?lb.startState(cb,Cc):!0}function ua(lb,cb){return gd.modes[lb]=cb}function Na(lb){if("string"===
typeof lb&&gd.mimeModes.hasOwnProperty(lb))lb=gd.mimeModes[lb];else if(lb&&"string"===typeof lb.name&&gd.mimeModes.hasOwnProperty(lb.name)){var cb=gd.mimeModes[lb.name];"string"===typeof cb&&(cb={name:cb});lb=Object.assign({},cb,lb);lb.name=cb.name}else{if("string"===typeof lb&&/^[\w\-]+\/[\w\-]+\+xml$/.test(lb))return Na("application/xml");if("string"===typeof lb&&/^[\w\-]+\/[\w\-]+\+json$/.test(lb))return Na("application/json")}return"string"===typeof lb?{name:lb}:lb||{name:"null"}}function Wa(lb,
cb){cb=gd.resolveMode(cb);"string"===typeof cb&&(cb={name:cb});if(!cb.name)throw Error("parserConfig does not have a name of the mode to get");var Cc=gd.modes[cb.name];if(!Cc)return Wa(lb,"text/plain");lb=Object.assign({indentUnit:2},lb);return Object.assign(Cc(lb,cb),{name:cb.name})}function Vb(lb,cb){for(var Cc;lb.innerMode;){Cc=lb.innerMode(cb);if(!Cc||Cc.mode==lb)break;cb=Cc.state;lb=Cc.mode}return Cc||{mode:lb,state:cb}}function Fa(lb,cb){gd.mimeModes[lb]=cb}function Xa(lb,cb,Cc){}function gc(lb,
cb,Cc,La,Sa,Ya,oa){var Tb=lb.editorPlugin._tokenizerValidBefore;Tb&&Tb.row>=Cc&&(Tb.row=Cc-1);var Ha=gd.linesToTokenize(lb.document,Cc,La,Tb);Tb=Ha.lines;Ha=Ha.state;if(!Tb.length)return!1;Ha=Ha?gd.copyState(cb,Ha):gd.startState(cb);for(var ab=0;ab<Tb.length;ab++){var vb=Tb[ab],oc=vb.row;oc>=Cc&&oc<=La&&gd.indentLine(lb,cb,vb,Ha,Sa,Ya,oa);Ha=gd.tokenizeLine(cb,Tb[ab],Ha,function(){})}return!0}function ub(lb,cb,Cc,La,Sa,Ya,oa){cb=gd.linesToTokenize(cb,Cc,La,Sa);Cc=cb.lines;gd.tokenizeLines(lb,Cc,cb.state,
Ya,oa);return Cc}function qd(lb,cb,Cc,La,Sa){var Ya=[],oa,Tb=function(vb){return Ya.push(oa=[])},Ha=function(vb,oc,Sc,md,xd,nd,$d){return oa.push(Sc,md,vb,xd.current(),oc.localMode||$d)};try{var ab=gd.visitDocumentTokens(lb,cb,Cc,La,Sa,Tb,Ha)}catch(vb){Ya.length=0,ab=gd.visitDocumentTokens(lb,cb,Cc,La,null,Tb,Ha)}return{tokens:Ya,lines:ab}}function fc(lb,cb,Cc,La,Sa){null==cb&&(cb=lb.search(/[^\s\u00a0]/),-1==cb&&(cb=lb.length));La=La||0;for(Sa=Sa||0;;){var Ya=lb.indexOf("\t",La);if(0>Ya||Ya>=cb)return Sa+
(cb-La);Sa+=Ya-La;Sa+=Cc-Sa%Cc;La=Ya+1}}function Ud(lb){lb=lb.toLowerCase();for(var cb=0;cb<gd.modeInfo.length;cb++){var Cc=gd.modeInfo[cb];if(Cc.mime==lb)return Cc;if(Cc.mimes)for(var La=0;La<Cc.mimes.length;La++)if(Cc.mimes[La]==lb)return Cc}if(/\+xml$/.test(lb))return Ud("application/xml");if(/\+json$/.test(lb))return Ud("application/json")}function td(lb){for(var cb=0;cb<gd.modeInfo.length;cb++){var Cc=gd.modeInfo[cb];if(Cc.ext)for(var La=0;La<Cc.ext.length;La++)if(Cc.ext[La]==lb)return Cc}}function fd(lb){for(var cb=
0;cb<gd.modeInfo.length;cb++){var Cc=gd.modeInfo[cb];if(Cc.file&&Cc.file.test(lb))return Cc}cb=lb.lastIndexOf(".");if(lb=-1<cb&&lb.substring(cb+1,lb.length))return gd.findModeByExtension(lb)}function Xb(lb){lb=lb.toLowerCase();for(var cb=0;cb<gd.modeInfo.length;cb++){var Cc=gd.modeInfo[cb];if(Cc.name.toLowerCase()==lb)return Cc;if(Cc.alias)for(var La=0;La<Cc.alias.length;La++)if(Cc.alias[La].toLowerCase()==lb)return Cc}}function Me(lb){if(!lb)return String(lb);if(Array.isArray(lb))return"["+lb.map(Me).join(",")+
"]";if("symbol"===typeof lb)return Pe.printSymbol(lb);try{return String(lb)}catch(cb){return"Cannot print object: "+cb}}function ic(lb,cb){return!Pe.arr.every(cb.map(function(Cc){return lb[Cc]}),function(Cc){return Pe.obj.equals(Cc,lb&&lb.valueOf())})}function Wb(lb){if(Pe.obj.isPrimitive(lb))var cb=Pe.string.print(lb);else Array.isArray(lb)?((cb=3<lb.length)&&(lb=lb.slice(0,3)),lb=Pe.string.print(lb),cb&&(lb=lb.slice(0,-1)+", ...]"),cb=lb):cb=Pe.string.print(lb);cb=cb.replace(/\n/g,"");500<cb.length&&
(cb=cb.slice(0,20)+("...["+(cb.length-20)+' CHARS]"'));return cb}function $a(lb){return rd.Inspector.openInWindow({targetObject:lb})}function ma(lb,cb){return rd.Inspector.openInWindow({remoteTarget:{code:lb,evalEnvironment:cb}})}function Ta(lb,cb){function Cc(Tb){var Ha=Tb.name,ab=Tb.ownerChain(),vb=Tb.owner,oc=Tb.world(),Sc;Tb===Ya&&(Sc=[oa]);oc===Tb&&(Sc=["$world"]);if(!Sc&&Ha&&vb){vb===oc&&1===rd.arr.count(rd.arr.pluck(oc.submorphs,"name"),Ha)&&(Sc=['$world.get("'+Ha+'")']);if(!Sc&&vb!=oc)for(oc=
ab.length-1;oc--;)if(1===ab[oc].getAllNamed(Ha).length){Sc=[].concat($jscomp.arrayFromIterable(Cc(ab[oc])),['get("'+Ha+'")']);break}Sc||(Ha=[].concat($jscomp.arrayFromIterable(Cc(vb)),['get("'+Ha+'")']),rd.syncEval(Ha.join("."),{context:Ya}).value===Tb&&(Sc=Ha))}Sc||(Sc=[oa+'.getMorphById("'+Tb.id+'")']);return Sc}cb=void 0===cb?{}:cb;var La=lb.world(),Sa=cb;cb=void 0===Sa.maxLength?10:Sa.maxLength;var Ya=void 0===Sa.fromMorph?La:Sa.fromMorph;if(Ya===lb)return"this";var oa=La===Ya?"$world":"this";
if(!(La||lb.name&&Ya.get(lb.name)===lb))return"morph";La=Cc(lb);return La.length>cb?'$world.getMorphWithId("'+lb.id+'")':La.join(".")}function qb(lb,cb,Cc){var La=(cb=void 0===cb?"":cb)&&Kd.arr.last(cb.split(".")).toLowerCase(),Sa="",Ya=0,oa=Math.pow(2,19);if("string"===typeof lb){if(lb.length>oa)return null}else if(lb.document.stringSize>oa)return null;if("string"===typeof lb)Sa=lb.slice(0,1E3);else for(lb=$jscomp.makeIterator(lb.document.lines),oa=lb.next();!oa.done;oa=lb.next()){var Tb=oa.value;
oa=Tb.stringSize;Tb=Tb.text;var Ha=!0;1E3<Ya+oa&&(Ha=!1,oa=1E3-Ya);Sa+=Tb.slice(0,oa)+(Ha?"\n":"");Ya+=oa;if(1E3<=Ya)break}Ya=$jscomp.makeIterator(Kd.modeInfo);for(lb=Ya.next();!lb.done;lb=Ya.next()){Ha=lb.value;oa=Ha.contentTest;lb=Ha.mode;Tb=Ha.ext;Ha=Ha.file;if("function"===typeof oa)try{if(oa(Sa))return lb}catch(ab){}if(Ha&&Ha instanceof RegExp&&Ha.test(cb))return lb;if(Tb)for(oa=$jscomp.makeIterator(Tb),Tb=oa.next();!Tb.done;Tb=oa.next())if(Tb.value===La)return lb}return Cc}db({a:Fa,d:ua,r:Xa});
var ec=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");ec.Color=Zb;var Ic=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Cc=cb.hasOwnProperty("DefaultTheme")&&"function"===typeof cb.DefaultTheme?cb.DefaultTheme:cb.DefaultTheme=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:"background",get:function(){return ec.Color.white}},{key:"default",
get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:ec.Color.white,fontWeight:"bold",backgroundColor:ec.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:ec.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:ec.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],cb,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),ud=Ic=ec.DefaultTheme;ec.default=Ic;var gd=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");gd.copyState=Za;gd.startState=Pa;gd.defineMode=ua;gd.resolveMode=Na;gd.getMode=Wa;gd.innerMode=Vb;gd.defineMIME=Fa;gd.registerHelper=Xa;gd.indentLines=gc;gd.indentLine=function(lb,cb,Cc,La,Sa,Ya,oa){oa=Object.assign({indentWithTabs:!lb.useSoftTabs,indentUnit:lb.tabWidth,tabSize:4,ignoreFollowingText:!1},
oa);null==Sa&&(Sa="add");"smart"==Sa&&(cb.indent||(Sa="prev"));var Tb=oa.tabSize,Ha=Cc.text,ab=gd.countColumn(Ha,null,Tb);Cc.modeState&&(Cc.modeState=null);var vb=Ha.match(/^\s*/)[0];if(!Ya&&!/\S/.test(Ha)){var oc=0;Sa="not"}else if("smart"==Sa&&(oc=cb.indent(La,oa.ignoreFollowingText?"":Ha.slice(vb.length),Ha),oc==gd.passIndent||150<oc)){if(!Ya)return;Sa="prev"}"prev"==Sa?oc=0<Cc.row?gd.countColumn(Cc.prevLine().text,null,Tb):0:"add"==Sa?oc=ab+oa.indentUnit:"subtract"==Sa?oc=ab-oa.indentUnit:"number"===
typeof Sa&&(oc=ab+Sa);oc=Math.max(0,oc);cb="";La=0;if(oa.indentWithTabs)for(oa=Math.floor(oc/Tb);oa;--oa)La+=Tb,cb+="\t";La<oc&&(cb+=" ".repeat(oc-La));if(cb!=vb)return lb.replace({start:{row:Cc.row,column:0},end:{row:Cc.row,column:vb.length}},cb),!0};gd.tokenizeLines=function(lb,cb,Cc,La,Sa){if(cb.length){Cc=Cc?gd.copyState(lb,Cc):gd.startState(lb);for(var Ya=0;Ya<cb.length;Ya++){var oa=cb[Ya];La(oa);Cc=gd.tokenizeLine(lb,oa,Cc,Sa)}}};gd.tokenizeLine=function(lb,cb,Cc,La){var Sa=cb.text;if(!Sa)return Cc;
var Ya=new gd.StringStream(Sa,2);Cc=cb.modeState="function"===typeof lb.copyState?lb.copyState(Cc):gd.copyState(lb,Cc);cb.prevLine();for(Cc._string=Sa;!Ya.eol();)Sa=lb.token(Ya,Cc),La(Sa,Cc,Ya.start,Ya.pos,Ya,cb,lb),Ya.start=Ya.pos;return Cc};gd.printTokens=function(lb){for(var cb="",Cc=0;Cc<lb.length;Cc+=5)cb+=lb[Cc+0]+" => "+lb[Cc+1]+" "+lb[Cc+2]+" "+lb[Cc+3]+" "+lb[Cc+4].name+"\n";return cb};gd.visitDocumentTokens=ub;gd.tokenizeDocument=qd;gd.linesToTokenize=function(lb,cb,Cc,La){if(La&&La.row>=
Cc)return{lines:[],state:null};cb=La?Math.max(0,La.row-1):cb;var Sa=lb.getLine(cb),Ya=Sa.text;lb=[Sa];La=null;for(var oa=0,Tb;(Tb=Sa.prevLine())&&50>oa++;){Sa=Tb;if(Sa.modeState){La=Sa.modeState;break}lb.unshift(Sa)}if(!La){for(var Ha=Sa,ab=Infinity;(Tb=Sa.prevLine())&&100>oa++;){Sa=Tb;if(Sa.modeState){La=Sa.modeState;break}lb.unshift(Sa);Tb=Ya.match(/^\s*/)[0].length;if(0===Tb)break;Tb<ab&&(ab=Tb,Ha=Sa)}!La&&0<ab&&(lb=lb.slice(lb.indexOf(Ha)))}if(Cc>cb)for(Sa=gd.arr.last(lb);cb<=Cc;cb++){Sa=Sa.nextLine();
if(!Sa)break;lb.push(Sa)}return{lines:lb,state:La}};gd.countColumn=fc;gd.findModeByMIME=Ud;gd.findModeByExtension=td;gd.findModeByFileName=fd;gd.findModeByName=Xb;gd.arr=Uc;Ic=gd.modes||{};gd.modes=Ic;gd.modes=Ic;gd.modes=Ic;Ic=db("p",{});gd.passIndent=Ic;gd.passIndent=Ic;gd.passIndent=Ic;gd.copyState=Za;gd.copyState=Za;gd.startState=Pa;gd.startState=Pa;gd.defineMode=ua;gd.defineMode=ua;gd.resolveMode=Na;gd.resolveMode=Na;gd.getMode=Wa;gd.getMode=Wa;gd.innerMode=Vb;gd.innerMode=Vb;Ic={};gd.mimeModes=
Ic;gd.mimeModes=Ic;gd.mimeModes=Ic;gd.defineMIME=Fa;gd.defineMIME=Fa;gd.registerHelper=Xa;gd.registerHelper=Xa;gd.indentLines=gc;gd.indentLines=gc;gd.visitDocumentTokens=ub;gd.visitDocumentTokens=ub;gd.tokenizeDocument=qd;gd.tokenizeDocument=qd;gd.countColumn=fc;gd.countColumn=fc;(function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Cc=cb.hasOwnProperty("StringStream")&&"function"===typeof cb.StringStream?cb.StringStream:cb.StringStream=function(La){La&&La[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:Symbol.for("lively-instance-initialize"),value:function(La,Sa){this.reset(La,Sa)}},{key:"reset",value:function(La,Sa){this.pos=this.start=0;this.string=void 0===La?"":La;this.tabSize=void 0===Sa?2:Sa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||
void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(La){var Sa=this.string.charAt(this.pos);if("string"===typeof La?Sa==La:Sa&&(La.test?La.test(Sa):La(Sa)))return++this.pos,Sa}},{key:"eatWhile",value:function(La){for(var Sa=this.pos;this.eat(La););return this.pos>Sa}},{key:"eatSpace",value:function(){for(var La=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>La}},{key:"skipToEnd",
value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(La){La=this.string.indexOf(La,this.pos);if(-1<La)return this.pos=La,!0}},{key:"backUp",value:function(La){this.pos-=La}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=gd.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?gd.countColumn(this.string,this.lineStart,this.tabSize):
0)}},{key:"indentation",value:function(){return gd.countColumn(this.string,null,this.tabSize)-(this.lineStart?gd.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(La,Sa,Ya){if("string"===typeof La){var oa=function(Ha){return Ya?Ha.toLowerCase():Ha},Tb=this.string.substr(this.pos,La.length);if(oa(Tb)==oa(La))return!1!==Sa&&(this.pos+=La.length),!0}else{if((La=this.string.slice(this.pos).match(La))&&0<La.index)return null;La&&!1!==Sa&&(this.pos+=La[0].length);return La}}},
{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(La,Sa){this.lineStart+=La;try{return Sa()}finally{this.lineStart-=La}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],cb,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:10526,end:13053})})(void 0);Ic=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",
ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",
mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",
mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(lb){return lb.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",
mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",
mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",
ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",
ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},
{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",
ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",
mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",
ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},
{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},
{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",
ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",
mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(lb){return lb.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",
mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",
mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",
mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn",
"ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",
mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",
ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];gd.modeInfo=Ic;gd.modeInfo=Ic;gd.modeInfo=Ic;for(var me=0;me<gd.modeInfo.length;me++)gd.info=
gd.modeInfo[me],gd.info.mimes&&(gd.info.mime=gd.info.mimes[0]);gd.defineMode("null",function(){return{token:function(lb){return lb.skipToEnd()}}});gd.defineMIME("text/plain","null");gd.findModeByMIME=Ud;gd.findModeByMIME=Ud;gd.findModeByExtension=td;gd.findModeByExtension=td;gd.findModeByFileName=fd;gd.findModeByFileName=fd;gd.findModeByName=Xb;gd.findModeByName=Xb;var ue=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");ue.Color=Zb;ue.Rectangle=Bc;ue.pt=Vd;ue.morph=Od;ue.ShadowObject=
je;ue.StyleSheet=Bd;ue.connect=jd;ue.arr=Uc;ue.string=zd;ue.FilterableList=ge;ue.Range=We;me=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Cc=cb.hasOwnProperty("Completer")&&"function"===typeof cb.Completer?cb.Completer:cb.Completer=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"Completer"}}],cb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);ue.Completer=me;ue.Completer=me;ue.Completer=me;me=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Cc=cb.hasOwnProperty("WordCompleter")&&
"function"===typeof cb.WordCompleter?cb.WordCompleter:cb.WordCompleter=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:"compute",value:function(La,Sa){var Ya=[],oa=[],Tb=La.document.lineStrings;La=La.cursorPosition.row;for(var Ha=La-1;0<=Ha;Ha--)for(var ab=$jscomp.makeIterator(Tb[Ha].split(/[^0-9a-z@_]+/i)),vb=ab.next();!vb.done;vb=ab.next())(vb=vb.value)&&!Ya.includes(vb)&&vb!==Sa&&(Ya.push(vb),
oa.push({priority:1E3-(La-Ha),completion:vb}));for(Ha=La+1;Ha<Tb.length;Ha++)for(ab=$jscomp.makeIterator(Tb[Ha].split(/[^0-9a-z_@]+/i)),vb=ab.next();!vb.done;vb=ab.next())(vb=vb.value)&&!Ya.includes(vb)&&vb!==Sa&&(Ya.push(vb),oa.push({priority:1E3-(Ha-La),completion:vb}));return oa}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],cb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);ue.WordCompleter=me;ue.WordCompleter=me;ue.WordCompleter=me;me=[new ue.WordCompleter];ue.defaultCompleters=me;ue.defaultCompleters=me;ue.defaultCompleters=me;me=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Cc=cb.hasOwnProperty("CompletionController")&&"function"===typeof cb.CompletionController?cb.CompletionController:cb.CompletionController=function(La){La&&La[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:Symbol.for("lively-instance-initialize"),value:function(La,Sa){Sa=void 0===Sa?[]:Sa;this.textMorph=La;this.completers=Sa=La.pluginCollect("getCompleters",Sa)}},{key:"computeCompletions",value:function(La){var Sa=this,Ya,oa,Tb,Ha,ab,vb,oc,Sc,md,xd,nd,$d,Ie,lf,te,yf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(df){switch(df.nextAddress){case 1:Ya=[],oa=$jscomp.makeIterator(Sa.completers),Tb=oa.next();
case 2:if(Tb.done){df.jumpTo(4);break}Ha=Tb.value;df.setCatchFinallyBlocks(5);ab=Ya;vb=ab.concat;return df.yield(Ha.compute(Sa.textMorph,La),7);case 7:Ya=vb.call(ab,df.yieldResult);df.leaveTryBlock(3);break;case 5:oc=df.enterCatchBlock(),console.warn("Error in completer "+Ha+": "+(oc.stack||oc));case 3:Tb=oa.next();df.jumpTo(2);break;case 4:Sc=new Map;Ya.forEach(function(Xe){var gg=Sc.get(Xe.completion);gg||(gg=[],Sc.set(Xe.completion,gg));gg.push(Xe)});md=[];xd=$jscomp.makeIterator(Sc.values());
for(nd=xd.next();!nd.done;nd=xd.next())$d=nd.value,md.push(ue.arr.last(ue.arr.sortByKey($d,"priority")));Ie=0;lf=ue.arr.sortByKey(md,"priority").reverse();te=lf.length&&lf[0].priority||0;yf=lf.map(function(Xe){Xe.highestPriority=te;var gg=Xe.completion.replace(/\n/g,""),Ug=String((Xe.info||"").replace(/\n/g,""));Ie=Math.max(Ie,gg.length+Ug.length);return{isListItem:!0,string:gg,annotation:Ug,value:Xe}});return df.return({items:yf,maxCol:Ie})}})}},{key:"computeSortedCompletions",value:function(La,
Sa){Sa=void 0===Sa?!1:Sa;var Ya=this,oa,Tb,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){if(1==ab.nextAddress)return oa={tokens:[La],lowercasedTokens:[La],input:La},ab.yield(Ya.computeCompletions(La),2);Tb=ab.yieldResult;Ha=ue.arr.sortBy(Tb.items.filter(function(vb){return Ya.filterFunction(oa,vb,Sa)}),function(vb){return Ya.sortFunction(oa,vb)});return ab.return(Ha)})}},{key:"_printCompletions",value:function(La){var Sa=this,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){if(1==
oa.nextAddress)return oa.yield(Sa.computeSortedCompletions(La),2);Ya=oa.yieldResult.map(function(Tb){return{completion:Tb.value.completion,priority:Tb.value.priority,maxP:Tb.value.highestPriority,sortVal:Tb._cache[La].sortVal,lev:JSON.stringify(Tb._cache[La].levenshtein)}});return oa.return(ue.string.printTable(lively.lang.grid.tableFromObjects(Ya)))})}},{key:"prefix",value:function(){var La=this.textMorph,Sa=La.selection;return(Sa.isEmpty()?La.getLine(Sa.lead.row).slice(0,Sa.lead.column):Sa.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(La,Sa,Ya){Ya=void 0===Ya?!1:Ya;Sa._cache||(Sa._cache={});var oa=La.tokens,Tb=La.lowercasedTokens,Ha=La.input;Ha=Sa._cache[Ha]||(Sa._cache[Ha]={});if(Ha.hasOwnProperty("filtered"))return Ha.filtered;Sa=Sa.value.completion.replace(/\([^\)]*\)$/,"");var ab=Sa.toLowerCase();if(Ya&&oa[0]&&!Sa.startsWith(oa[0]))return Ha.filtered=!1;if(Tb.every(function(oc){return ab.includes(oc)}))return!0;var vb=Ha.levenshtein||(Ha.levenshtein={});La=Ya||3>=ue.arr.sum(La.lowercasedTokens.map(function(oc){return vb[oc]||
(vb[oc]=ue.string.levenshtein(ab,oc))}));return Ha.filtered=La}},{key:"sortFunction",value:function(La,Sa){Sa._cache||(Sa._cache={});var Ya=Sa._cache[La.input]||(Sa._cache[La.input]={});if(Ya.hasOwnProperty("sortVal"))return Ya.sortVal;Ya=Sa._cache[La.input]={};var oa=Sa.value;Sa=oa.highestPriority;var Tb=oa.completion;oa=oa.priority;Tb=Tb.replace(/\([^\)]*\)$/,"").toLowerCase();var Ha=0;La.lowercasedTokens.forEach(function(vb){Tb.startsWith(vb)?Ha+=12:3<=vb.length&&Tb.includes(vb)&&(Ha+=5)});Sa=
-((oa||(Ha?Sa:0))/Math.pow(10,String(Sa).length-2))-Ha;var ab=Ya.levenshtein||(Ya.levenshtein={});La=ue.arr.sum(La.lowercasedTokens.map(function(vb){return ab[vb]||(ab[vb]=ue.string.levenshtein(Tb,vb))}));Ha&&(La/=2);return Ya.sortVal=La+Sa}},{key:"positionForMenu",value:function(){var La=this.textMorph,Sa=La.charBoundsFromTextPosition(La.cursorPosition);return La.getGlobalTransform().transformRectToRect(Sa).topLeft().addXY(-La.scroll.x,-La.scroll.y).addPt(ue.pt(La.borderWidth+4,La.borderWidth+4))}},
{key:"completionListSpec",value:function(){var La=this,Sa,Ya,oa,Tb,Ha,ab,vb,oc,Sc,md,xd,nd,$d,Ie,lf,te,yf,df,Xe,gg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ug){if(1==Ug.nextAddress)return Ya=Sa=La.textMorph,oa=Ya.fontSize,Tb=Ya.fontFamily,Ha=La.positionForMenu(),ab=La.prefix(),Ug.yield(La.computeCompletions(ab),2);vb=Ug.yieldResult;oc=vb.items;Sc=vb.maxCol;md=Sa.env.fontMetric.sizeFor(Tb,oa,"M");xd=md.width*Sc;nd=Sa.document.getLine(0).height;$d=Math.max(120,xd<Sa.width?xd:Sa.width);
Ie=nd*oc.length+nd+10;lf=Math.max(70,Math.min(700,Ie));te=Ha.extent(ue.pt($d,lf));if(yf=Sa.world())df=yf.visibleBounds().insetBy(5),te.bottom()>df.bottom()&&(Xe=te.bottom()-df.bottom(),Xe>te.height-50&&(Xe=te.height-50),te.height-=Xe),te.right()>df.right()&&(gg=te.right()-df.right(),te.width=120>te.width-gg?120:te.width-gg),df.containsRect(te)||(te=te.withTopLeft(df.translateForInclusion(te).topLeft())),te=te.translatedBy(df.insetBy(0).topLeft().negated());return Ug.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:oa,position:te.topLeft(),extent:te.extent(),items:oc,input:ab,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:La.filterFunction,sortFunction:La.sortFunction})})}},{key:"removeMenuOnBlur",value:function(La){var Sa=La.menu;setTimeout(function(){Sa.withAllSubmorphsDetect(function(Ya){return Ya.isFocused()})?Sa.inputMorph.focus():Sa.remove()})}},{key:"openCompletionList",value:function(){var La=this,Sa,Ya,oa,Tb,Ha,ab,vb,oc,
Sc,md;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xd){if(1==xd.nextAddress)return Sa=La.textMorph.selection.start,xd.yield(La.completionListSpec(),2);if(3!=xd.nextAddress)return Ya=xd.yieldResult,La.textMorph.pluginFind(function(nd){return nd.theme}),oa=new ue.FilterableList(Ya),Tb=new ue.Range({start:Sa,end:La.textMorph.selection.start}),Ha=La.textMorph.textInRange(Tb),ab=oa.inputMorph,vb=oa.listMorph,oc=Ya.input,Sc=oa.addMorph({name:"prefix mask",fill:ue.Color.transparent,bounds:ab.textBounds()},
ab),vb.master=null,Tb.isEmpty()||(La.textMorph.deleteText(Tb),ab.input=Ha,ab.gotoDocumentEnd()),ab.fontColor=La.textMorph.fontColor,ue.connect(ab,"textString",Sc,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:ab}}),ue.connect(oa,"accepted",La,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:oc}}),ue.connect(oa,"accepted",oa,"remove"),ue.connect(oa,"canceled",oa,"remove"),ue.connect(oa,"remove",La.textMorph,"focus"),ue.connect(oa.inputMorph,"onBlur",La,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:oa}}),md=La.textMorph.world(),vb.addStyleClass("hiddenScrollbar"),oa.paddingMorph.height=2,ab.height=vb.itemHeight,ab.clipMode="visible",ab.fill=La.textMorph.fill,ab.fixedHeight=!0,ab.fixedWidth=!1,ab.fontSize=vb.fontSize,oa.relayout(),oa.selectedIndex=
0,oa.master.applyIfNeeded(!0),ab.focus(),xd.yield(oa.master.whenApplied(),3);oc.length&&(ab.gotoDocumentEnd(),oa.moveBy(ue.pt(-ab.textBounds().width,0)));md.addMorph(oa);oa.inputPadding=ue.Rectangle.inset(0,0,0,0);return xd.return(oa)})}},{key:"autoInsertBestMatchingCompletion",value:function(La,Sa,Ya){Sa=void 0===Sa?!0:Sa;var oa=this,Tb,Ha,ab,vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oc){if(1==oc.nextAddress)return Tb=$jscomp,Ha=Tb.makeIterator,oc.yield(oa.computeSortedCompletions(La,
Sa),2);ab=Ha.call(Tb,oc.yieldResult);(vb=ab.next().value)&&oa.insertCompletion(vb.value.completion,La,Ya);oc.jumpToEnd()})}},{key:"insertCompletion",value:function(La,Sa,Ya){var oa=this.textMorph,Tb=oa.document,Ha=oa.selection.isMultiSelection?oa.selection.selections:[oa.selection];oa.undoManager.group();Ha.forEach(function(ab){ab.collapseToEnd();var vb=ab.lead,oc=Sa?Tb.indexToPosition(Tb.positionToIndex(vb)-Sa.length):vb;"function"===typeof Ya?Ya(La,Sa,oa,{start:oc,end:vb},ab):oa.replace({start:oc,
end:vb},La)});oa.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],cb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13044})}(void 0);ue.CompletionController=me;ue.CompletionController=me;ue.CompletionController=me;
me=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(lb,cb,Cc){var La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){return 1==Sa.nextAddress?(La=new ue.CompletionController(lb,ue.defaultCompleters),Sa.yield(La.openCompletionList(),2)):Sa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(lb,cb,Cc){var La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){return 1==Sa.nextAddress?
(La=new ue.CompletionController(lb,ue.defaultCompleters),Sa.yield(La.autoInsertBestMatchingCompletion(La.prefix()),2)):Sa.return(!0)})}}];ue.completionCommands=me;ue.completionCommands=me;ue.completionCommands=me;var Uf=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Uf.chain=kf;Uf.arr=Uc;Uf.obj=bf;Uf.string=zd;var zf=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(lb){var cb=lb.selection.start;0<cb.row&&(cb=lb.getPositionAboveOrBelow(1,
cb,!0,0,lb.charBoundsFromTextPosition(cb).x),lb.selection.addRange({start:cb,end:cb}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(lb){var cb=lb.selection.start;cb.row<lb.documentEndPosition.row&&(cb=lb.getPositionAboveOrBelow(-1,cb,!0,0,lb.charBoundsFromTextPosition(cb).x),lb.selection.addRange({start:cb,end:cb}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(lb){var cb=lb.selection.selections[lb.selection.selections.length-
1];if(cb.isEmpty())return!0;lb.searchForAll(cb.text,{start:{column:0,row:0}}).forEach(function(Cc){return lb.selection.addRange(Cc.range,!1)});lb.selection.mergeSelections();Uf.arr.remove(lb.selection.selections,cb);lb.selection.selections.push(cb);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(lb){var cb=lb.selection.selections.length-1,Cc=lb.selection.selections[cb];if(Cc.isEmpty())return!0;var La=lb.search(Cc.text,{start:Cc.end,backwards:!1});
La&&(Cc=lb.selection.selections.findIndex(function(Sa){return Sa.range.equals(La.range)}),-1<Cc?Uf.arr.swap(lb.selection.selections,Cc,cb):lb.selection.addRange(La.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(lb){var cb=lb.selection.selections.length-1,Cc=lb.selection.selections[cb];if(Cc.isEmpty())return!0;var La=Cc.start,Sa=lb.search(Cc.text,{start:{row:La.row,column:La.column-(Cc.text.length-1)},backwards:!0});Sa&&(Cc=lb.selection.selections.findIndex(function(Ya){return Ya.range.equals(Sa.range)}),
-1<Cc?Uf.arr.swap(lb.selection.selections,Cc,cb):lb.selection.addRange(Sa.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(lb){var cb=lb.selection.selections.length;1<cb&&lb.selection.removeSelections(cb-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(lb){lb.selection.selections=lively.lang.arr.rotate(lb.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(lb){lb.selection.selections=lively.lang.arr.rotate(lb.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(lb){var cb=lb.selection.selections;if(1>=cb.length)return!0;var Cc=Uf.arr.groupBy(cb,function(Sa){return Sa.range.start.row});cb=Cc.keys().map(function(Sa){Sa=Cc[Sa];var Ya=Uf.arr.max(Sa,function(oa){return oa.range.start.column});Uf.arr.without(Sa,Ya).forEach(function(oa){return oa.range=Ya.range});
return Ya});var La=Uf.arr.max(cb,function(Sa){return Sa.range.start.column}).range.start.column;cb.forEach(function(Sa){var Ya=Sa.range.start;Sa=Ya.row;Ya=Ya.column;lb.insertText(" ".repeat(La-Ya),{row:Sa,column:Ya})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(lb){lb.selection.disableMultiSelect();if(lb.selection.isEmpty())var cb=lb.lastSavedMark&&lb.lastSavedMark.position||(void 0).lineRange().start,Cc=lb.cursorPosition;else cb=lb.selection,
Cc=cb.lead,cb=cb.anchor;lb.selection.collapse();var La=cb.column,Sa=Cc.column;Uf.arr.range(cb.row,Cc.row).forEach(function(Ya){return lb.getLine(Ya).length>Math.min(Sa,La)&&lb.selection.addRange({end:{row:Ya,column:Sa},start:{row:Ya,column:La}},!1)});lb.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(lb,cb,Cc){Cc=void 0===Cc?1:Cc;lb.undoManager.group();lb.selection.selections.forEach(function(La,Sa){return La.text=String(Sa+
Cc)});lb.undoManager.group();return!0}}];Uf.multiSelectCommands=zf;Uf.multiSelectCommands=zf;Uf.multiSelectCommands=zf;var qf=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");qf.pToI=function(lb,cb){return lb.positionToIndex(cb)};qf.iToP=function(lb,cb){return lb.indexToPosition(cb)};qf.execCodeNavigator=function(lb){return function(cb,Cc,La){var Sa=cb.pluginInvokeFirst("getNavigator");if(!Sa)return!0;cb.saveMark();La=La||1;for(var Ya=0;Ya<La;Ya++)Sa[lb](cb,Cc);return!0}};
qf.once=Hd;var C=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:qf.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:qf.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:qf.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:qf.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:qf.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(lb,cb){function Cc(){var Ya=lb.$expandRegionState,oa=qf.pToI(lb,lb.cursorPosition);if(Ya&&(Ya.range[0]===oa||Ya.range[1]===oa))return Ya;Ya=lb.selection.range;return lb.$expandRegionState={range:[qf.pToI(lb,Ya.start),
qf.pToI(lb,Ya.end)]}}cb=cb||{};var La=lb.pluginInvokeFirst("getNavigator");if(!La)return!0;var Sa=cb.start;cb=cb.end;if("number"===typeof Sa&&"number"===typeof cb)Cc(),La={range:[Sa,cb],prev:Cc()};else{Sa=La.ensureAST(lb);if(!Sa)return;La=La.expandRegion(lb,lb.textString,Sa,Cc())}La&&La.range&&(lb.selection={start:qf.iToP(lb,La.range[0]),end:qf.iToP(lb,La.range[1])},lb.$expandRegionState=La);qf.once(lb,"selectionChange",function(){return lb.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(lb){if(lb.selection.isEmpty())return!0;var cb=lb.pluginInvokeFirst("getNavigator");if(!cb)return!0;var Cc=cb.ensureAST(lb);if(!Cc)return!0;var La=lb.$expandRegionState;if(!La)return!0;(cb=cb.contractRegion(lb,lb.textString,Cc,La))&&cb.range&&(lb.selection={start:qf.iToP(lb,cb.range[0]),end:qf.iToP(lb,cb.range[1])},lb.$expandRegionState=cb);qf.once(lb,"selectionChange",
function(){return lb.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];qf.commands=C;qf.commands=C;qf.commands=C;var Df=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");Df.arr=Uc;Df.chain=kf;Df.string=zd;var Bf=[{name:"toggle comment",exec:function(lb){var cb=lb.pluginInvokeFirst("getComment");if(!cb)return!0;if(!cb.lineCommentStart)return cb.blockCommentStart?lb.execCommand("toggle block comment"):!0;var Cc=cb.lineCommentStart,La=new RegExp("^(\\s*)("+
Cc+"\\s?)(.*)");cb=lb.document;var Sa=lb.selection;Sa.isEmpty()||0!==Sa.end.column||Sa.growRight(-1);var Ya=Sa.start.row;cb=cb.lineStrings.slice(Sa.start.row,Sa.end.row+1);cb=cb.some(function(Ha){return!!Ha.trim()})?Df.arr.dropWhile(cb,function(Ha){return Ha.trim()?!1:++Ya&&!0}):cb;var oa=cb.every(function(Ha){return Ha.trim()&&Ha.match(La)});lb.undoManager.group();if(oa)cb.forEach(function(Ha,ab){if(Ha=Ha.match(La)){Ha=$jscomp.makeIterator(Ha);Ha.next();var vb=Ha.next().value,oc=Ha.next().value;
Ha.next();lb.deleteText({start:{row:Ya+ab,column:vb.length},end:{row:Ya+ab,column:vb.length+oc.length}})}});else{var Tb=cb.reduce(function(Ha,ab,vb){return ab.trim()||Sa.isEmpty()&&Sa.start.row===Sa.end.row?Math.min(Ha,ab.match(/^\s*/)[0].length):Ha},Infinity);Tb=Infinity===Tb?0:Tb;cb.forEach(function(Ha,ab){Ha=$jscomp.makeIterator(Ha.match(/^(\s*)(.*)/));Ha.next();Ha.next();Ha.next();lb.insertText(Cc+" ",{row:Ya+ab,column:Tb})})}lb.undoManager.group();return!0}},{name:"toggle block comment",exec:function(lb){var cb=
lb.pluginInvokeFirst("getComment");if(!cb)return!0;if(!cb.blockCommentStart)return cb.lineCommentStart?lb.execCommand("toggle comment"):!0;if(!cb||!cb.blockCommentStart)return!0;var Cc=cb.blockCommentStart;cb=cb.blockCommentEnd;var La=new RegExp("^"+Cc.replace(/\*/g,"\\*")),Sa=new RegExp(cb.replace(/\*/g,"\\*")+"$"),Ya=lb.tokenAt(lb.cursorPosition);if(Ya&&"comment"===Ya.token){var oa=lb.textInRange(Ya);if(oa.match(La)&&oa.match(Sa))return lb.undoManager.group(),lb.replace(Ya,oa.slice(Cc.length,-cb.length)),
lb.undoManager.group(),!0}lb.undoManager.group();lb.insertText(Cc,lb.selection.start);lb.insertText(cb,lb.selection.end);lb.undoManager.group();Cc=!lb.selection.isEmpty();lb.selection.growLeft(cb.length);Cc||lb.selection.collapse();return!0}},{name:"comment box",exec:function(lb,cb,Cc){cb=lb.undoManager.ensureNewGroup(lb,"comment box");if(lb.selection.isEmpty())return lb.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),lb.execCommand("toggle comment"),lb.undoManager.group(cb),
!0;var La=lb.selection.range,Sa=lb.withSelectedLinesDo(function(oa){return oa}),Ya=Df.arr.min([La.start.column].concat(Df.chain(Sa).map(function(oa){return oa.match(/^\s*/)}).flatten().compact().pluck("length").value()));Sa=Df.arr.max(Sa.map(function(oa){return oa.length}))-Ya;Sa=Array(Math.ceil(Sa/2)+1).join("-=")+"-";lb.execCommand("toggle comment");lb.collapseSelection();lb.cursorPosition={row:La.start.row,column:0};Cc?lb.insertText(Df.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",Ya)):lb.insertText(Df.string.indent(Sa+"\n"," ",Ya));lb.selection.goUp();lb.execCommand("toggle comment");lb.cursorPosition={row:La.end.row+2,column:0};lb.insertText(Df.string.indent(Sa+"\n"," ",Ya));lb.selection.goUp();lb.execCommand("toggle comment");lb.selection.range={start:{row:La.start.row,column:0},end:lb.cursorPosition};lb.undoManager.group(cb);return!0},multiSelectAction:"forEach",handlesCount:!0}];Df.commands=Bf;Df.commands=Bf;Df.commands=Bf;var Pe=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
Pe.printSymbol=function(lb){if(Symbol.keyFor(lb))return'Symbol.for("'+Symbol.keyFor(lb)+'")';if(Pe.knownSymbols.get(lb))return Pe.knownSymbols.get(lb);String(lb).match(Pe.symMatcher);return String(lb)};Pe.defaultSort=function(lb,cb){if(lb.hasOwnProperty("priority")||cb.hasOwnProperty("priority")){var Cc=lb.priority||0,La=cb.priority||0;if(Cc<La)return-1;if(Cc>La)return 1}lb=(lb.keyString||lb.key).toLowerCase();cb=(cb.keyString||cb.key).toLowerCase();return lb<cb?-1:lb===cb?0:1};Pe.safeToString=Me;
Pe.propertyNamesOf=function(lb,cb){if(!lb)return[];if(Array.isArray(lb)){var Cc=cb?cb.offset:0;return Pe.arr.range(Cc,Cc+(cb?cb.partitionSize:lb.length-1))}return Pe.arr.sortBy(Object.keys(lb),function(La){return La.toLowerCase()})};Pe.isMultiValue=ic;Pe.printValue=Wb;Pe.partitionedChildren=function(lb,cb){var Cc=void 0===cb?{}:cb;cb=void 0===Cc.originalValue?lb:Cc.originalValue;var La=void 0===Cc.offset?0:Cc.offset;Cc=void 0===Cc.partitionSize?lb.length||Object.values(lb).length:Cc.partitionSize;
if(Pe.obj.isArray(lb)){lb=Pe.num.roundTo(Math.max(Pe.MIN_PARTITION_SIZE,Cc/50),.1);Cc/=lb;for(var Sa=[],Ya=0;Ya<Cc;Ya++){var oa="["+(La+Ya*lb)+"-"+(La+(Ya+1)*lb)+"]";Sa.push({partition:{originalValue:cb,offset:La+Ya*lb,partitionSize:lb},value:[],key:oa,keyString:oa,valueString:"...",isCollapsed:!0})}return Sa}lb=Pe.num.roundTo(Math.max(Pe.MIN_PARTITION_SIZE,Cc/50),.1);Cc/=lb;Sa=[];Ya=Pe.obj.keys(cb).sort();for(oa=0;oa<Cc;oa++){var Tb=La+oa*lb,Ha=La+(oa+1)*lb,ab=Pe.obj.select(cb,Ya.slice(Tb,Ha));Tb=
"["+Ya[Tb].slice(0,4)+"-"+(Ya[Ha]||Pe.arr.last(Ya)).slice(0,4)+"]";Sa.push({partition:{originalValue:ab,offset:La+oa*lb,partitionSize:lb},value:[],key:Tb,keyString:Tb,valueString:"...",isCollapsed:!0})}return Sa};Pe.propertiesOf=function(lb){var cb=lb.partition?lb.target:lb.value;if(!cb)return[];var Cc={_rev:!0},La=[],Sa="function"===typeof cb.livelyCustomInspect?cb.livelyCustomInspect():{},Ya=Object.assign({},Pe.defaultPropertyOptions,{},Sa);if(Sa.properties){Sa=$jscomp.makeIterator(Sa.properties);
for(var oa=Sa.next();!oa.done;oa=Sa.next()){var Tb=oa.value;oa=Tb.key;var Ha=Tb.hidden,ab=Tb.priority,vb=Tb.keyString,oc=Tb.value;Tb=Tb.valueString;Cc[oa]=!0;Ha||La.push(lb.getSubNode({priority:ab,key:oa,keyString:vb||Pe.safeToString(oa),value:oc,valueString:Tb,isCollapsed:!0}))}}if(Ya.includeDefault){Sa=Pe.propertyNamesOf(cb,lb.partition);if(Sa.length>Pe.MAX_NODE_THRESHOLD)for(Cc=$jscomp.makeIterator(Pe.partitionedChildren(cb,lb.partition)),Sa=Cc.next();!Sa.done;Sa=Cc.next())La.push(lb.getSubNode(Sa.value));
else for(Ha=$jscomp.makeIterator(Sa),Sa=Ha.next();!Sa.done;Sa=Ha.next())ab=Sa.value,ab in Cc||(Sa=cb[ab],oa=Pe.printValue(Sa),Sa={keyString:ab,key:ab,value:Sa,valueString:oa,isCollapsed:!0},La.push(lb.getSubNode(Sa)));if(Ya.includeSymbols)for(Cc=$jscomp.makeIterator(Object.getOwnPropertySymbols(cb)),Sa=Cc.next();!Sa.done;Sa=Cc.next())Ha=Sa.value,ab=Pe.safeToString(Ha),Sa=cb[Ha],oa=Pe.printValue(Sa),Sa={key:Ha,keyString:ab,value:Sa,valueString:oa,isCollapsed:!0},La.push(lb.getSubNode(Sa))}Ya.sort&&
(La=Ya.sortFunction(cb,La));return La};Pe.obj=bf;Pe.num=Ae;Pe.arr=Uc;Pe.string=zd;Pe.connect=jd;Pe.signal=uc;Pe.TreeData=wd;Pe.newUUID=ce;Pe.localInterface=sc;Pe.MAX_NODE_THRESHOLD=1E3;Pe.MIN_PARTITION_SIZE=250;Pe.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(lb,cb){return Array.isArray(lb)?cb:cb.sort(Pe.defaultSort)}};Pe.symMatcher=/^Symbol\((.*)\)$/;Pe.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(lb){return"symbol"===
typeof Symbol[lb]}).reduce(function(lb,cb){return lb.set(Symbol[cb],"Symbol."+cb)},new Map)}();Pe.isMultiValue=ic;Pe.isMultiValue=ic;Pe.printValue=Wb;Pe.printValue=Wb;var Tf=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cc=cb.hasOwnProperty("InspectionTree")&&"function"===typeof cb.InspectionTree?cb.InspectionTree:cb.InspectionTree=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return lc(Cc,lb,[{key:Symbol.for("lively-instance-initialize"),value:function(La){lc._get(Object.getPrototypeOf(Cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,La);this.inspector=La.inspector;this.root.isInspectionNode||(this.root=Pe.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(La){La=void 0===La?!0:La;return lc._get(Object.getPrototypeOf(Cc.prototype),"asListWithIndexAndDepth",
this).call(this,function(Sa){Sa=Sa.node;return La?Sa.visible:!0})}},{key:"getContextFor",value:function(La){return La==this.root?this.root.value.inspectee:La.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(La){var Sa=void 0===La.maxDepth?1:La.maxDepth,Ya=La.iterator,oa=La.showUnknown,Tb=La.showInternal,Ha=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){if(1==ab.nextAddress)return ab.yield(Ha.uncollapseAll(function(vb,oc){return Sa>oc&&(vb==Ha.root||vb.value.submorphs)}),
2);Ha.asListWithIndexAndDepth(!1).forEach(function(vb){var oc=vb.node;return 0==vb.depth?oc.visible=!0:!oa&&oc.keyString&&oc.keyString.includes("UNKNOWN PROPERTY")||!Tb&&oc.keyString&&oc.keyString.includes("internal")?oc.visible=!1:oc.value&&oc.value.submorphs?oc.visible=!0:oc.visible=Ya(oc)});ab.jumpToEnd()})}},{key:"getChildren",value:function(La){return La.children}},{key:"display",value:function(La){return La.display(this.inspector)}},{key:"isCollapsed",value:function(La){return La.isCollapsed}},
{key:"isLeaf",value:function(La){return Pe.obj.isPrimitive(La.value)}},{key:"collapse",value:function(La,Sa){var Ya=this;La.isCollapsed=Sa;Sa||this.isLeaf(La)||La.children.length||(La.children=Pe.propertiesOf(La).map(function(oa){Ya.parentMap.set(oa,La);return oa}))}},{key:"retrieveForRemoteProxy",value:function(La){La.uuid||(La.uuid=Pe.newUUID(),this.idToNodeMap[La.uuid]=La);return{uuid:La.uuid,value:this.isLeaf(La)?La.value:{},keyString:La.keyString,key:La.keyString,valueString:Pe.safeToString(La.value),
isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Pe.localInterface}},{key:"getNodeViaId",value:function(La){return this.idToNodeMap[La]}},{key:"asRemoteDelegate",value:function(La){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[La]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(La,Sa){return new this({key:"inspectee",value:{inspectee:La},isCollapsed:!0,inspector:Sa})}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(Pe.TreeData);Pe.InspectionTree=Tf;Pe.InspectionTree=
Tf;Pe.InspectionTree=Tf;var fg=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cc=cb.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof cb.RemoteInspectionTree?cb.RemoteInspectionTree:cb.RemoteInspectionTree=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(La){this.parentMap=new WeakMap;this.root=La.proxy;this.evalEnvironment=La.evalEnvironment;this.inspector=La.inspector;this.delegateId=La.delegateId}},{key:"getContextFor",value:function(La){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+La.uuid+'").value'}},{key:"dispose",value:function(){var La=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){return Sa.yield(La.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
La.delegateId+"']\n    ",La.evalEnvironment),0)})}},{key:"display",value:function(La){return La.keyString+": "+La.valueString}},{key:"collapse",value:function(La,Sa){var Ya=this,oa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tb){if(1==Tb.nextAddress)return(La.isCollapsed=Sa)||Ya.isLeaf(La)?Tb.return():La.children.length?Tb.jumpTo(0):Tb.yield(Ya.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+La.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Ya.delegateId+'"]'}),3);oa=Tb.yieldResult;La.children=oa.isError?[]:oa.value;Tb.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(La,Sa){var Ya=this,oa,Tb,Ha,ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vb){if(1==vb.nextAddress)return vb.yield(Ya.createRemoteContext(La,Sa),2);oa=vb.yieldResult;
Tb=oa.proxy;Ha=oa.delegateId;ab=oa.evalEnvironment;return vb.return(new Ya({key:"inspectee",proxy:Tb,delegateId:Ha,evalEnvironment:ab,inspector:Sa}))})}},{key:"createRemoteContext",value:function(La,Sa){var Ya=La.code,oa=La.evalEnvironment,Tb=La.delegateId,Ha,ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vb){if(1==vb.nextAddress)return Tb="lively://inspector-"+Sa.id,vb.yield(oa.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Ya+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Tb+'");\n    ',oa),2);Ha=vb.yieldResult;ab=Ha.value;return vb.return({delegateId:Tb,evalEnvironment:oa,proxy:ab})})}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(Pe.InspectionTree);
Pe.RemoteInspectionTree=fg;Pe.RemoteInspectionTree=fg;Pe.RemoteInspectionTree=fg;(function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cc=cb.hasOwnProperty("InspectionNode")&&"function"===typeof cb.InspectionNode?cb.InspectionNode:cb.InspectionNode=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:Symbol.for("lively-instance-initialize"),value:function(La){var Sa=
La.root,Ya=La.priority,oa=La.key,Tb=La.keyString,Ha=La.value,ab=La.valueString,vb=La.isCollapsed,oc=void 0===La.children?[]:La.children,Sc=void 0===La.isSelected?!1:La.isSelected,md=void 0===La.visible?!0:La.visible;this.partition=La.partition;this.priority=Ya;this.key=oa;this.keyString=String(Tb||oa);this.value=Ha;this.valueString=ab||Pe.printValue(Ha);this.isCollapsed=vb;this.children=oc;this.isSelected=Sc;this.visible=md;this.root=Sa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(La){if(La.value&&La.value.isMorph)return new Pe.MorphNode(Object.assign({root:this.root},La));var Sa=La.key,Ya=La.keyString,oa=this.value,Tb=La.partition;Tb&&(oa=Tb.originalValue,Ya=Sa);return new Pe.PropertyNode(Object.assign({},La,{keyString:Ya,key:Sa,target:oa,partition:Tb,root:this.root,spec:{}}))}},{key:"display",value:function(La){var Sa=this.keyString,Ya=this.valueString;if(!this.interactive)return Sa+": "+Ya;this._propertyWidget||
(this._propertyWidget=La.renderDraggableTreeLabel({value:Sa+": "+Ya}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(La,Sa){Sa=void 0===Sa?null:Sa;return La.value&&La.value.isMorph?new Pe.MorphNode(Object.assign({root:Sa},La)):new Pe.InspectionNode(Object.assign({root:Sa},La))}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cc=cb.hasOwnProperty("MorphNode")&&"function"===typeof cb.MorphNode?cb.MorphNode:cb.MorphNode=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,
[{key:Symbol.for("lively-instance-initialize"),value:function(La){lc._get(Object.getPrototypeOf(Cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,La);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(La){var Sa=this.propertyInfo[La.key]||{};return La.value&&La.value.isMorph?new Pe.MorphNode(Object.assign({},La,{root:this.root})):new Pe.PropertyNode(Object.assign({},La,{root:this.root,target:this.target,
spec:Sa}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(Pe.InspectionNode);(function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cc=cb.hasOwnProperty("PropertyNode")&&
"function"===typeof cb.PropertyNode?cb.PropertyNode:cb.PropertyNode=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:Symbol.for("lively-instance-initialize"),value:function(La){lc._get(Object.getPrototypeOf(Cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,La);var Sa=La.spec,Ya=La.target;this.partition=La.partition;this.target=Ya;this.spec=Sa;this.foldedNodes={}}},{key:"__deserialize__",
value:function(La,Sa){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(La){this._interactive=La}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(La){return this.isFoldable?this.getFoldedContext(La):lc._get(Object.getPrototypeOf(Cc.prototype),"getSubNode",this).call(this,La)}},{key:"getFoldedContext",
value:function(La){return this.foldedNodes[La.key]=new Pe.FoldedNode(Object.assign({},La,{root:this.root,target:this.target,foldableNode:this,spec:Pe.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(La,Sa){(Sa=void 0===Sa?!1:Sa)&&(this.target[this.key]=La);this.value=this.target[this.key];this.valueString=Pe.printValue(this.value);this.interactive&&(Sa||this._propertyWidget.highlight());if(this.isFoldable)for(var Ya in this.foldedNodes)this.foldedNodes[Ya].value=
this.value[Ya],this.foldedNodes[Ya].valueString=Pe.printValue(this.value[Ya]),this.foldedNodes[Ya]._propertyWidget&&Pe.signal(this.foldedNodes[Ya]._propertyWidget,"update",this.value[Ya])}},{key:"display",value:function(La){var Sa=this,Ya=this._propertyWidget,oa=this.keyString,Tb=this.valueString,Ha=this.target,ab=this.value,vb=this.spec;if(!(this.interactive||vb.foldable&&Pe.isMultiValue(ab,vb.foldable)))return La.renderPropertyControl({target:Ha,keyString:oa,valueString:Tb,tree:La.ui.propertyTree,
value:ab,spec:vb,node:this,fastRender:!0});if(Ya)return Ya.keyString=oa,Ya.valueString=Tb,Ya.isSelected=this.isSelected,Ya.control&&(Ya.control.isSelected=this.isSelected),Ya;Ya=this._propertyWidget=La.renderPropertyControl({target:Ha,keyString:oa,valueString:Tb,value:ab,spec:vb,node:this,isSelected:this.isSelected,fontColor:La.ui.propertyTree.fontColor});this.isInternalProperty||vb.readOnly||(Pe.connect(Ya,"propertyValue",this,"refreshProperty",{updater:function(oc,Sc){return oc(Sc,!0)}}),Pe.connect(Ya,
"openWidget",this.root,"onWidgetOpened",{converter:function(oc){return{widget:oc,node:Sa.sourceObj}}}));return Ya}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(Pe.InspectionNode);
(function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Cc=cb.hasOwnProperty("FoldedNode")&&"function"===typeof cb.FoldedNode?cb.FoldedNode:cb.FoldedNode=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:Symbol.for("lively-instance-initialize"),value:function(La){lc._get(Object.getPrototypeOf(Cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
La);this.foldableNode=La=La.foldableNode;this.foldedProp=La.key+Pe.string.capitalize(this.key)}},{key:"refreshProperty",value:function(La,Sa){Sa=void 0===Sa?!1:Sa;var Ya={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Ya[this.key]=La,Ya)),Sa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],cb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(Pe.PropertyNode);var kg=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");kg.Color=Zb;var wg=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Cc=cb.hasOwnProperty("DarkTheme")&&"function"===typeof cb.DarkTheme?cb.DarkTheme:cb.DarkTheme=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return lc(Cc,lb,[{key:"background",get:function(){return kg.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return kg.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:kg.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:kg.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:kg.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:kg.Color.white,fontWeight:"bold",backgroundColor:kg.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:kg.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:kg.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],cb,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),kh=wg=kg.DarkTheme;kg.default=wg;var rd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");rd.inspect=$a;rd.remoteInspect=ma;rd.generateReferenceExpression=Ta;rd.onNumberDragStart=
function(lb,cb){cb.initPos=lb.position;cb.factorLabel=(new rd.Tooltip({description:"1x"})).openInWorld(lb.hand.position.addXY(10,10))};rd.onNumberDrag=function(lb,cb){var Cc=rd.getScaleAndOffset(lb,cb),La=Cc.scale;Cc=Cc.offset;cb.factorLabel.position=lb.hand.position.addXY(10,10);cb.factorLabel.description=La+"x";return rd.getCurrentValue(Cc,La,cb)};rd.onNumberDragEnd=function(lb,cb){var Cc=rd.getScaleAndOffset(lb,cb);lb=Cc.offset;Cc=Cc.scale;cb.factorLabel.softRemove();return rd.getCurrentValue(lb,
Cc,cb)};rd.getScaleAndOffset=function(lb,cb){var Cc=lb.position.subPt(cb.initPos);lb=Cc.x;cb=rd.num.roundTo(Math.exp(-Cc.y/$world.height*6),.01)*cb.baseFactor;return{offset:lb,scale:cb}};rd.getCurrentValue=function(lb,cb,Cc){return Math.max(Cc.min,Math.min(Cc.max,Cc.scrubbedValue+(Cc.floatingPoint?lb*cb:Math.round(lb*cb))))};rd.Color=Zb;rd.rect=Gd;rd.pt=Vd;rd.obj=bf;rd.num=Ae;rd.Path=pe;rd.arr=Uc;rd.promise=Te;rd.connect=jd;rd.disconnect=rc;rd.once=Hd;rd.Morph=bd;rd.Tooltip=he;rd.VerticalLayout=cd;
rd.HorizontalLayout=ie;rd.morph=Od;rd.Label=ac;rd.Icon=Db;rd.config=Tc;rd.Tree=Nc;rd.LoadingIndicator=wc;rd.DropDownList=Vc;rd.DropDownSelector=hb;rd.SearchField=zc;rd.LabeledCheckBox=Ub;rd.MorphHighlighter=Ad;rd.InteractiveMorphSelector=Xd;rd.printValue=Wb;rd.RemoteInspectionTree=fg;rd.InspectionTree=Tf;rd.isMultiValue=ic;rd.valueWidgets=xc;rd.popovers=Pc;rd.DarkTheme=kh;rd.DefaultTheme=ud;rd.syncEval=Jc;rd.inspectorCommands=[{name:"focus codeEditor",exec:function(lb){lb.get("codeEditor").show();
lb.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(lb){lb.get("propertyTree").show();lb.get("propertyTree").focus();return!0}}];(function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cc=cb.hasOwnProperty("DraggedProp")&&"function"===typeof cb.DraggedProp?cb.DraggedProp:cb.DraggedProp=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:"applyToTarget",
value:function(La){var Sa=this.currentTarget,Ya=this.control;this.remove();rd.MorphHighlighter.removeHighlighters(La.world);if(Sa)if(Sa.isText&&"js"===Sa.editorModeName){var oa=Sa.evalEnvironment.context;La=Sa.textPositionFromPoint(Sa.localize(La.position));oa=rd.generateReferenceExpression(this.sourceObject,{fromMorph:oa});Ya.keyString&&(oa+="."+Ya.keyString);Sa.insertTextAndSelect(oa,La);Sa.focus()}else"propertyValue"in Ya&&(Sa[Ya.keyString]=Ya.propertyValue)}},{key:"update",value:function(La){La=
La.hand.globalPosition;var Sa=this.morphBeneath(La);if(Sa){for(Sa==this.morphHighlighter&&(Sa=Sa.morphBeneath(La));[Sa].concat($jscomp.arrayFromIterable(Sa.ownerChain())).find(function(Ya){return!Ya.visible});)Sa=Sa.morphBeneath(La);if(Sa!=this.currentTarget){this.currentTarget=Sa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Sa.isWorld)return;this.morphHighlighter=rd.MorphHighlighter.for($world,Sa);this.morphHighlighter.show()}this.position=La}}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:rd.Color.rgb(169,204,227)},fill:{defaultValue:rd.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var La=this.control;if(!La)return this.submorphs=[];this.height=22;this.submorphs=[La];La.top=0;La.fontSize=14;"function"===typeof La.relayout&&La.relayout();this.width=La.width+
20;this.adjustOrigin(rd.pt(10,10))}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1223,end:3665})})(rd.Morph);(function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cc=cb.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof cb.DraggableTreeLabel?
cb.DraggableTreeLabel:cb.DraggableTreeLabel=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(La){this.draggedProp=new rd.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();rd.connect(La.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(La){}},
{key:"onDragEnd",value:function(La){rd.disconnect(La.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(La)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:rd.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:rd.Color.transparent},
padding:{defaultValue:rd.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(La){this.setProperty("isSelected",La);La?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=La)}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3667,end:5006})})(rd.Label);Tf=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cc=cb.hasOwnProperty("PropertyControl")&&"function"===typeof cb.PropertyControl?cb.PropertyControl:cb.PropertyControl=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(La,Sa,Ya){La.control=new rd.DropDownSelector({opacity:.8,fill:rd.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Sa,padding:0,values:Ya});rd.connect(La.control,"update",La,"propertyValue",{updater:function(oa,Tb){this.targetObj.propertyValue!=Tb&&oa(Tb)}});rd.connect(La,"update",La.control,"selectedValue",{updater:function(oa,Tb){Tb=Tb&&Tb.valueOf?Tb.valueOf():Tb;this.targetObj.propertyValue!=Tb&&oa(Tb)}});return La}},
{key:"toggleMultiValuePlaceholder",value:function(La){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:rd.Color.transparent,layout:new rd.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:rd.arr.range(0,2).map(function(Sa){return{type:"ellipse",fill:rd.Color.gray.withA(.5),reactsToPointer:!1,extent:rd.pt(7,7)}})});La?(rd.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),
this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(rd.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(La){this.foldableProperties&&this.toggleMultiValuePlaceholder(rd.isMultiValue(La,this.foldableProperties))}},{key:"asFoldable",value:function(La){this.foldableProperties=La;rd.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();
this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var La=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});
La.isLayoutable=!1;La.fontWeight="bold";La.fontColor=rd.Color.orange;La.reactsToPointer=!1;La.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(La){this.submorphs=[La]}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[];rd.connect(this,
"extent",this,"relayout")}}}}},{key:"inferType",value:function(La){return(La=La.value)&&(La.isColor||La.isGradient)?"Color":La&&La.isPoint?"Point":rd.obj.isBoolean(La)?"Boolean":rd.obj.isNumber(La)?"Number":rd.obj.isString(La)?"String":La&&La.isRectangle?"Rectangle":!1}},{key:"render",value:function(La){La.spec.type||(La.spec=Object.assign({},La.spec,{isFloat:!Number.isInteger(La.value),type:this.inferType(La)}));switch(La.spec.type){case "Color":var Sa=this.renderColorControl(La);break;case "ColorGradient":Sa=
this.renderColorControl(Object.assign({},La,{gradientEnabled:!0}));break;case "Number":Sa=this.renderNumberControl(La);break;case "String":Sa=this.renderStringControl(La);break;case "RichText":Sa=this.renderStringControl(La);break;case "Layout":Sa=this.renderLayoutControl(La);break;case "Enum":Sa=this.renderEnumControl(La);break;case "Shadow":Sa=this.renderShadowControl(La);break;case "Point":Sa=this.renderPointControl(La);break;case "Rectangle":Sa=this.renderRectangleControl(La);break;case "Boolean":Sa=
this.renderBooleanControl(La);break;default:Sa=this.renderItSomehow(La)}Sa.control&&(rd.connect(Sa.control,"openWidget",Sa,"openWidget"),Sa.toggleFoldableValue(La.value));return Sa}},{key:"baseControl",value:function(La){var Sa=La.spec;La=new this({keyString:La.keyString,valueString:La.valueString,isSelected:!1,propertyValue:La.value});Sa.foldable&&La.asFoldable(Sa.foldable);return La}},{key:"renderGrabbableKey",value:function(La){var Sa=this,Ya=La.target;return[La.keyString+":",{nativeCursor:"-webkit-grab",
onDragStart:function(oa){oa.state.draggedProp=new rd.DraggedProp({sourceObject:Ya,control:Sa.baseControl(La)});oa.state.draggedProp.openInWorld();rd.connect(oa.hand,"update",oa.state.draggedProp,"update")},onDrag:function(oa){},onDragEnd:function(oa){rd.disconnect(oa.hand,"update",oa.state.draggedProp,"update");oa.state.draggedProp.applyToTarget(oa)}}]}},{key:"renderEnumControl",value:function(La){var Sa=La.value,Ya=La.spec.values,oa=La.keyString,Tb=La.target,Ha=La.node,ab=function(vb,oc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){Tb.world().openWorldMenu(vb,
Ya.map(function(md){return{string:md.toString(),action:function(){Tb[oa]=md;Ha.rerender()}}}));Sc.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(La)),[" "+(Sa?Sa.valueOf?Sa.valueOf():Sa:"Not set"),{nativeCursor:"pointer",onMouseDown:ab}],$jscomp.arrayFromIterable(rd.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:ab})))}},{key:"renderStringControl",value:function(La){var Sa=La.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(La)),
[" "+(200<Sa.length?Sa.slice(0,20)+"...":Sa),{fontColor:rd.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(La){var Sa=La.value,Ya=La.keyString,oa=La.valueString,Tb=La.target,Ha=La.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(La)),[" "+oa,{fontColor:rd.Color.black,nativeCursor:"pointer",onMouseDown:function(ab){var vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oc){if(1==oc.nextAddress)return vb=new rd.popovers.RectanglePopover({hasFixedPosition:!0,
rectangle:Sa}),vb.relayout(),oc.yield(vb.fadeIntoWorld(ab.positionIn(Tb.world())),2);rd.connect(vb,"rectangle",function(Sc){Tb[Ya]=Sc;Ha.rerender()});oc.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(La){var Sa=La.value,Ya=La.keyString,oa=La.valueString,Tb=La.target,Ha=La.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(La)),[" "+oa,{nativeCursor:"pointer",fontColor:Sa?rd.Color.green:rd.Color.red,onMouseDown:function(ab){Tb[Ya]=!Tb[Ya];Ha.rerender()}}])}},{key:"renderNumberControl",
value:function(La){var Sa=La.value,Ya=La.spec,oa=La.keyString,Tb=La.valueString,Ha=La.node,ab=La.target,vb=La.tree,oc=void 0===Ha._numberControls?new cf:Ha._numberControls,Sc=$jscomp.makeIterator(oc.submorphs),md=Sc.next().value,xd=Sc.next().value;oc.fontColor=vb.fontColor;var nd=Ha._numberControls=oc;"max"in Ya&&"min"in Ya&&-Infinity!=Ya.min&&Infinity!=Ya.max?(nd.baseFactor=(Ya.max-Ya.min)/100,nd.floatingPoint=Ya.isFloat,nd.max=Ya.max,nd.min=Ya.min):(nd.floatingPoint=Ya.isFloat,nd.baseFactor=.5,
nd.min=void 0!=Ya.min?Ya.min:-Infinity,nd.max=void 0!=Ya.max?Ya.max:Infinity);var $d=rd.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(La)),$jscomp.arrayFromIterable(Ha._inputMorph?[Ha._inputMorph,{}]:[" "+(void 0!=Sa&&(Sa.valueOf?Sa.valueOf():Sa).toFixed(Ya.isFloat?Math.max(4,rd.num.precision(Sa)):0))+" ",{fontColor:$d,onMouseUp:function(Ie){Ha._inputMorph=rd.morph({type:"input",fill:null,fontColor:$d,fontFamily:"IBM Plex Mono",
fontSize:14,padding:rd.rect(8,2,-6,2),height:23,cursorColor:rd.Color.white,value:Sa.valueOf?Sa.valueOf():Tb});ab[oa]=Sa;Ha._inputMorph.focus();rd.once(Ha._inputMorph,"inputAccepted",function(lf){delete Ha._inputMorph;ab[oa]=Ya.isFloat?Number.parseFloat(lf):Number.parseInt(lf);Ha.rerender()});rd.once(Ha._inputMorph,"onBlur",function(lf){Ha._inputMorph&&(delete Ha._inputMorph,ab[oa]=Sa,Ha.rerender())});Ha.rerender()},onDragStart:function(Ie){nd.scrubbedValue=Sa;rd.onNumberDragStart(Ie,nd)},onDrag:function(Ie){ab[oa]=
rd.onNumberDrag(Ie,nd);Ha.rerender()},onDragEnd:function(Ie){return rd.onNumberDragEnd(Ie,nd)}},oc,{onMouseUp:function(){md.fill=xd.fill=null},onMouseDown:function(Ie){if(Ie.targetMorph===md){md.fill=rd.Color.white.withA(.2);if("max"in Ya&&ab[oa]>=Ya.max)return;ab[oa]+=1}if(Ie.targetMorph===xd){xd.fill=rd.Color.white.withA(.2);if("min"in Ya&&ab[oa]<=Ya.min)return;--ab[oa]}Ha.rerender()}}]))}},{key:"renderShadowControl",value:function(La){var Sa=La.keyString,Ya=La.value,oa=La.target,Tb=La.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(La)),
[""+(Ya?Ya.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(Ha){var ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vb){if(1==vb.nextAddress)return ab=new rd.popovers.ShadowPopover({shadowValue:oa[Sa],hasFixedPosition:!0}),vb.yield(ab.fadeIntoWorld(Ha.positionIn(oa.world())),2);rd.connect(ab,"shadowValue",function(oc){oa[Sa]=oc;Tb.rerender()});vb.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(La){var Sa=La.keyString,Ya=La.value,oa=La.target,Tb=La.node,
Ha=rd.valueWidgets.NumberWidget.properties.fontColor.defaultValue,ab={nativeCursor:"pointer",onMouseDown:function(vb){var oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return oc=new rd.popovers.PointPopover({pointValue:oa[Sa],hasFixedPosition:!0}),Sc.yield(oc.fadeIntoWorld(vb.positionIn(oa.world())),2);rd.connect(oc,"pointValue",function(md){oa[Sa]=md;Tb.rerender()});Sc.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(La)),
[" pt(",Object.assign({},ab),""+Ya.x.toFixed(),Object.assign({fontColor:Ha},ab),",",Object.assign({},ab),""+Ya.y.toFixed(),Object.assign({fontColor:Ha},ab),")",Object.assign({},ab)])}},{key:"renderLayoutControl",value:function(La){var Sa=La.valueString,Ya=La.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(La)),[" "+(Ya?Sa:"No Layout"),{onMouseDown:function(oa){}}])}},{key:"renderColorControl",value:function(La){var Sa=La.node,Ya=La.gradientEnabled,oa=La.valueString,Tb=La.keyString,
Ha=La.value,ab=La.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(La)),[rd.morph({fill:Ha.valueOf?Ha.valueOf():Ha,extent:rd.pt(15,15),borderColor:rd.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(Ha?Ha.valueOf?Ha.valueOf():oa:"No Color"),{nativeCursor:"pointer",onMouseDown:function(vb){var oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return oc=new rd.popovers.FillPopover({hasFixedPosition:!0,
handleMorph:ab,fillValue:Ha,title:"Fill Control",gradientEnabled:Ya}),Sc.yield(oc.fadeIntoWorld(vb.positionIn(ab.world())),2);rd.connect(oc,"fillValue",function(md){ab[Tb]=md;Sa.rerender()});Sc.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(La){var Sa=La.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(La)),[" "+Sa,{}])}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5015,end:20308})}(rd.DraggableTreeLabel);rd.PropertyControl=Tf;rd.PropertyControl=Tf;rd.PropertyControl=Tf;rd.inspect=$a;rd.inspect=$a;rd.remoteInspect=ma;rd.remoteInspect=ma;rd.generateReferenceExpression=Ta;rd.generateReferenceExpression=Ta;var cf=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cc=cb.hasOwnProperty("NumberControls")&&"function"===typeof cb.NumberControls?cb.NumberControls:cb.NumberControls=
function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new rd.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:rd.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(La){this.submorphs.map(function(Sa){return Sa.fontColor=
La})}},submorphs:{initialize:function(){this.submorphs=[rd.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:rd.rect(5,2,0,-6),fontSize:12}),rd.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:rd.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22981,end:24026})}(rd.Morph);(function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cc=cb.hasOwnProperty("PropertyTree")&&"function"===typeof cb.PropertyTree?cb.PropertyTree:cb.PropertyTree=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:"onDrag",value:function(La){this._onDragHandler&&this._onDragHandler(La)}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25191,end:25302})})(rd.Tree);Tf=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Cc=cb.hasOwnProperty("Inspector")&&"function"===
typeof cb.Inspector?cb.Inspector:cb.Inspector=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(La){}},{key:"__after_deserialize__",value:function(La,Sa,Ya){var oa=this,Tb=new rd.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,
{treeData:rd.InspectionTree.forObject(null,this)}));this.addMorph(Tb,this.getSubmorphNamed("terminal toggler"));lc._get(Object.getPrototypeOf(Cc.prototype),"__after_deserialize__",this).call(this,La,Sa,Ya);!this.isComponent&&this.master.whenApplied().then(function(){oa.layout.col(0).row(1).group.morph=Tb;oa.targetObject&&(oa.targetObject=oa.targetObject)})}},{key:"__additionally_serialize__",value:function(La,Sa,Ya,oa){La=La.props.submorphs.value;for(Sa=La.length;Sa--;)Ya.refForId(La[Sa].id).realObj==
this.ui.propertyTree&&rd.arr.removeAt(La,Sa)}},{key:"renderDraggableTreeLabel",value:function(La){return new rd.DraggableTreeLabel(La)}},{key:"renderPropertyControl",value:function(La){return rd.PropertyControl.render(La)}},{key:"onLoad",value:function(){var La=this.ui,Sa=La.codeEditor,Ya=La.thisBindingSelector,oa=La.propertyTree;Sa.changeEditorMode("js").then(function(){return Sa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Ya.selection?Sa.owner.selectedContext:
Sa.owner.targetObject},get systemInterface(){return rd.Path("treeData.systemInterface").get(oa)},format:"esm"}}).catch(function(Tb){return $world.logError(Tb)})}},{key:Symbol.for("lively-instance-initialize"),value:function(La){lc._get(Object.getPrototypeOf(Cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,La);La=this.ui;var Sa=La.targetPicker,Ya=La.propertyTree,oa=La.resizer,Tb=La.terminalToggler,Ha=La.unknowns,ab=La.internals,vb=La.searchField,oc=La.codeEditor,Sc=La.fixImportButton,
md=La.thisBindingSelector;oc.changeEditorMode("js").then(function(){return oc.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==md.selection?oc.owner.selectedContext:oc.owner.targetObject},get systemInterface(){return Ya.treeData.systemInterface},format:"esm"}}).catch(function(xd){return $world.logError(xd)});rd.connect(Sa,"onMouseUp",this,"selectTarget");rd.connect(Ya,"onScroll",this,"repositionOpenWidget");rd.connect(oa,"onDrag",this,"adjustProportions");
rd.connect(Tb,"onMouseDown",this,"toggleCodeEditor");rd.connect(Ha,"trigger",this,"filterProperties");rd.connect(ab,"trigger",this,"filterProperties");rd.connect(vb,"searchInput",this,"filterProperties");rd.connect(Ya,"nodeCollapseChanged",this,"filterProperties");rd.connect(this,"extent",this,"relayout");rd.connect(md,"selection",this,"bindCodeEditorThis");rd.connect(Sc,"fire",oc,"execCommand",{updater:function(xd){return xd("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},
{key:"refreshSelectedLine",value:function(){var La=this.ui.propertyTree.selectedIndex-1,Sa=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Sa=this.ui.propertyTree.document.getLine(La).textAndAttributes.slice(0,4).concat(Sa.display(this));La=this.ui.propertyTree.lineRange(La,!1);this.ui.propertyTree.replace(La,Sa,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();
if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var La=rd.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(La!=this.lastChange||this.lastSubmorphs!=rd.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==La.prop&&this.repositionOpenWidget(),this.lastChange=La,this.lastSubmorphs=
rd.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var La;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Sa){Sa=Sa.node;Sa.target&&(La=Sa.foldableNode?Sa.target[Sa.foldableNode.key][Sa.key]:Sa.target[Sa.key],!rd.obj.equals(La,Sa.value)&&Sa.refreshProperty&&Sa.refreshProperty(La))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},
{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(La,Sa){Sa=void 0===Sa?!1:Sa;var Ya=this,oa,Tb,Ha,ab,vb,oc,Sc,md,xd,nd,$d,Ie,lf,te,yf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(df){switch(df.nextAddress){case 1:if(!Ya.isUpdating()){df.jumpTo(2);break}return df.yield(Ya.whenUpdated(),2);case 2:oa=rd.promise.deferred();Tb=oa.promise;Ha=!!Ya.target;Ya.updateInProgress=Tb;df.setCatchFinallyBlocks(4);Sa&&(ab=rd.LoadingIndicator.open("connecting to remote..."));
if(!Sa){vb=rd.InspectionTree.forObject(La,Ya);df.jumpTo(6);break}return df.yield(rd.RemoteInspectionTree.forObject(La,Ya),7);case 7:vb=df.yieldResult;case 6:return oc=vb,Sc=Ya.ui.propertyTree,df.yield(oc.collapse(oc.root,!1),8);case 8:if(!oc.root.children){df.jumpTo(9);break}return df.yield(oc.collapse(oc.root.children[0],!1),9);case 9:if(md=Ya.originalTreeData&&Ya.originalTreeData.diff(oc)){xd=$jscomp.makeIterator(md);for(nd=xd.next();!nd.done;nd=xd.next())$d=nd.value,Ie=$jscomp.makeIterator($d),
lf=Ie.next().value,te=Ie.next().value,lf.refreshProperty(te.value);df.jumpTo(11);break}Sc.treeData=oc;return df.yield(Ya.filterProperties(),12);case 12:if(!Sc.treeData.root.isCollapsed){df.jumpTo(13);break}return df.yield(Sc.onNodeCollapseChanged({node:oc.root,isCollapsed:!1}),14);case 14:Sc.selectedIndex=1;case 13:return df.yield(Sc.execCommand("uncollapse selected node"),11);case 11:Ya.toggleWindowStyle(Ha);ab&&ab.remove();df.leaveTryBlock(5);break;case 4:yf=df.enterCatchBlock(),Ya.showError(yf);
case 5:Ya.startStepping(1E3,"refreshAllProperties"),Ya.updateInProgress=null,df.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(La){La=void 0===La?!0:La;var Sa=this,Ya,oa,Tb,Ha,ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vb){if(1==vb.nextAddress)return Ya=300,Ha=Sa.ui.codeEditor.pluginFind(function(oc){return oc.runEval}),ab=Sa.getWindow(),vb.yield(Ha.runEval("System.get('@system-env').node"),2);vb.yieldResult.value?(Tb=[].concat($jscomp.arrayFromIterable(rd.arr.without(ab.styleClasses,
"local")),["node"]),oa=rd.DarkTheme.instance):(Tb=["local"].concat($jscomp.arrayFromIterable(ab?rd.arr.without(ab.styleClasses,"node"):[])),oa=rd.DefaultTheme.instance);Ha.theme=oa;La?(ab&&ab.animate({duration:Ya,styleClasses:Tb}),Sa.ui.codeEditor.animate({fill:oa.background,duration:Ya})):ab&&(ab.styleClasses=Tb);Sa.ui.codeEditor.textString=Sa.ui.codeEditor.textString;Ha.highlight();vb.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||
Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var La=this,Sa=Object.assign({type:"text",borderWidth:1,borderColor:rd.Color.gray,lineWrapping:"by-chars"},rd.config.codeEditor.defaultStyle,{textString:""}),Ya=rd.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});rd.rect(0,0,this.width,30);var oa=new rd.SearchField({styleClasses:["idle"],name:"searchField"});Ya[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[oa,
{type:"button",name:"targetPicker",padding:rd.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:rd.Icon.textAttribute("crosshairs")},new rd.LabeledCheckBox({label:"Internals",name:"internals"}),new rd.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new rd.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:rd.InspectionTree.forObject(null,this)})),rd.Icon.makeLabel("keyboard",{name:"terminal toggler"}),
{name:"resizer"},Object.assign({name:"codeEditor"},Sa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:rd.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Ya),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Ya),[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=
3;this.ui.thisBindingSelector.whenRendered().then(function(){La.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var La=this,Sa,Ya,oa,Tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){switch(Ha.nextAddress){case 1:if(La.env.eventDispatcher.isKeyPressed("Shift"))return Ya=$jscomp,oa=Ya.makeIterator,Ha.yield($world.execCommand("select morph",{justReturn:!0}),5);La.toggleSelectionInstructions(!0);return Ha.yield(rd.InteractiveMorphSelector.selectMorph(),
4);case 4:Sa=Ha.yieldResult;La.toggleSelectionInstructions(!1);Ha.jumpTo(3);break;case 5:Tb=oa.call(Ya,Ha.yieldResult),Sa=Tb.next().value;case 3:Sa&&(La.targetObject=Sa),Ha.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(La){if(La&&!this.instructionWidget){var Sa=rd.morph({type:"label",name:"escapeKey",value:"esc"});Sa.whenRendered().then(function(){return Sa.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,
lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},Sa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(La){La=La.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;
La.epiMorph=!0;this.openWidget=La;rd.once(La,"close",this,"closeOpenWidget");rd.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var La=this.ui.propertyTree,Sa=La.textLayout.boundsFor(La,{column:0,row:La.selectedIndex-1});Sa=La.worldPoint(rd.pt(Sa.x,Sa.y+Sa.height/2)).addPt(La.scroll.negated());La=La.globalBounds();Sa.x=this.globalBounds().center().x;Sa.y<La.top()?Sa=La.topCenter():La.bottom()-20<Sa.y&&(Sa=La.bottomCenter().addXY(0,-20));
return Sa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(La){this.layout.row(1).height+=La.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(La){if(La!==this.isEditorVisible()){var Sa=this.extent,Ya=this.layout,oa=this.ui,Tb=oa.terminalToggler,Ha=oa.codeEditor,ab=oa.thisBindingSelector;
oa=oa.fixImportButton;Ya.disable();La?(Tb.fontColor=rd.Color.rgbHex("00e0ff"),Ya.row(3).height=this.codeEditorHeight||180,Ya.row(2).height=5,oa.animate({visible:!0,duration:200}),ab.animate({visible:!0,duration:200})):(this.codeEditorHeight=Ya.row(3).height,Tb.fontColor=rd.Color.white,Ya.row(3).height=Ya.row(2).height=0,oa.animate({visible:!1,duration:200}),ab.animate({visible:!1,duration:200}));this.extent=Sa;Ya.enable({duration:200});this.relayout({duration:200});Ha.focus();Ha.animate({opacity:La?
1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var La=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){La.makeEditorVisible(!La.isEditorVisible());Sa.jumpToEnd()})}},{key:"filterProperties",value:function(){var La=this,Sa,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){if(1==oa.nextAddress)return Sa=La.ui.searchField,Ya=La.ui.propertyTree,La.originalTreeData||(La.originalTreeData=Ya.treeData),rd.disconnect(Ya.treeData,"onWidgetOpened",La,"onWidgetOpened"),
oa.yield(Ya.treeData.filter({maxDepth:2,showUnknown:La.ui.unknowns.checked,showInternal:La.ui.internals.checked,iterator:function(Tb){return Sa.matches(Tb.key)}}),2);Ya.update();rd.connect(Ya.treeData,"onWidgetOpened",La,"onWidgetOpened");oa.jumpToEnd()})}},{key:"relayout",value:function(La){La=void 0===La?{}:La;var Sa=this,Ya,oa,Tb,Ha,ab,vb,oc,Sc,md;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xd){Sa.layout&&Sa.layout.forceLayout();Ya=Sa;oa=Ya.ui;Tb=oa.fixImportButton;Ha=oa.terminalToggler;
ab=oa.propertyTree;vb=oa.thisBindingSelector;oc=ab.bounds().insetBy(5).bottomLeft();Sc=ab.bounds().insetBy(5).bottomRight();md=Sc.subXY(Tb.width+10,0);vb.width=115;vb.listMorph.itemHeight=20;La.duration?(Ha.animate(Object.assign({bottomLeft:oc},La)),Tb.animate(Object.assign({bottomRight:Sc},La)),vb.animate(Object.assign({bottomRight:md},La))):(Ha.bottomLeft=oc,Tb.bottomRight=Sc,vb.bottomRight=md);xd.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},
{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(lc._get(Object.getPrototypeOf(Cc.prototype),"keybindings",this))}},{key:"commands",get:function(){return rd.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(La){if(System._testsRunning)return console.log(La.targetObject);La=new this(La);La.openInWindow().doNotAcceptDropsForThisAndSubmorphs();
return La}},{key:"properties",get:function(){return{extent:{defaultValue:rd.pt(400,500)},fill:{defaultValue:rd.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(La){this.setProperty("remoteTarget",La);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(La,!0))}},targetObject:{after:["submorphs"],set:function(La){this._serializableTarget=La&&La.isMorph?La.id:La;this.setProperty("targetObject",
La);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(La))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var La=this.ui.propertyTree,Sa=La.treeData;return Sa.getContextFor(La.selectedNode||Sa.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),
thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:rd.Color.gray,
fontSize:14,fontFamily:rd.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],cb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25319,end:45910})}(rd.Morph);Tf=rd.Inspector;fg=db("I",Tf);rd.default=
Tf;var Bg=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");Bg.Inspector=fg;Bg.string=zd;Bg.Morph=bd;Bg.pt=Vd;Bg.Color=Zb;Tf=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(lb,cb,Cc){Cc=void 0===Cc?1:Cc;var La,Sa,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){switch(oa.nextAddress){case 1:return lb.maybeSelectCommentOrLine(),oa.setCatchFinallyBlocks(2),cb=Object.assign({},cb,{logDoit:!0,inspect:!0,
inspectDepth:Cc}),oa.yield(lb.doEval(void 0,cb),4);case 4:La=oa.yieldResult;Sa=La.error?La.error:La.isError?La.value:null;oa.leaveTryBlock(3);break;case 2:Sa=Ya=oa.enterCatchBlock();case 3:return Sa?lb.showError(Sa):lb.setStatusMessage(Bg.string.truncate(La.value,1E3)),oa.return(La)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(lb,cb){var Cc,La,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ya){switch(Ya.nextAddress){case 1:return Ya.setCatchFinallyBlocks(2),
Ya.yield(lb.doEval({start:{row:0,column:0},end:lb.documentEndPosition},Object.assign({},cb,{logDoit:!0})),4);case 4:Cc=Ya.yieldResult;La=Cc.error?Cc.error:Cc.isError?Cc.value:null;Ya.leaveTryBlock(3);break;case 2:La=Sa=Ya.enterCatchBlock();case 3:return La?lb.showError(La):lb.setStatusMessage(String(Cc.value)),Ya.return(Cc)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(lb,cb){var Cc,La,Sa,Ya,oa,Tb,Ha,ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vb){switch(vb.nextAddress){case 1:return lb.maybeSelectCommentOrLine(),
vb.setCatchFinallyBlocks(2),cb=Object.assign({},cb,{asString:!1,logDoit:!0}),vb.yield(lb.doEval(void 0,cb),4);case 4:Cc=vb.yieldResult;La=Cc.error?Cc.error:Cc.isError?Cc.value:null;vb.leaveTryBlock(3);break;case 2:La=Sa=vb.enterCatchBlock();case 3:lb.selection.collapseToEnd();if(Ya=Cc.value&&Cc.value.isColor)return lb.selection.text=String(Cc.value),oa=new Bg.Morph({fill:Bg.Color.transparent,extent:Bg.pt(lb.fontSize+2,lb.fontSize+2),submorphs:[{fill:Cc.value,center:Bg.pt(lb.fontSize+2,lb.fontSize+
2).scaleBy(.5)}]}),Tb=lb.selection.start,Ha=Tb.column,ab=Tb.row,lb.insertText([oa,{}],lb.selection.start),lb.selection.start={column:Ha,row:ab},lb.focus(),vb.return(Cc);lb.insertTextAndSelect(La?String(La)+(La.stack?"\n"+La.stack:""):String(Cc.value));lb.focus();return vb.return(Cc)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(lb,cb){var Cc,La,Sa,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){switch(oa.nextAddress){case 1:lb.maybeSelectCommentOrLine();
La=lb.textInRange(lb.selection);Sa=lb.evalEnvironment||{};Ya=lb.pluginFind(function(Tb){return Tb.isEditorPlugin&&"function"===typeof Tb.runEval});Sa.systemInterface||(Sa.systemInterface=Ya.systemInterface(cb));if("local"!==Sa.systemInterface.name){oa.jumpTo(2);break}oa.setCatchFinallyBlocks(3);return oa.yield(lb.doEval(void 0,cb),5);case 5:Cc=oa.yieldResult;La=Cc.value;oa.leaveTryBlock(2);break;case 3:oa.enterCatchBlock();case 2:return lb.world().execCommand("open object editor",{target:La,evalEnvironment:Sa}),
oa.return(Cc)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(lb,cb){var Cc,La,Sa,Ya,oa,Tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){switch(Ha.nextAddress){case 1:lb.maybeSelectCommentOrLine();Sa=lb.textInRange(lb.selection);Ya=lb.evalEnvironment||{};oa=lb.pluginFind(function(ab){return ab.isEditorPlugin&&"function"===typeof ab.runEval});Ya.systemInterface||(Ya.systemInterface=oa.systemInterface(cb));
if("local"!==Ya.systemInterface.name){Bg.Inspector.openInWindow({remoteTarget:{code:Sa,evalEnvironment:Ya}});Ha.jumpTo(2);break}Ha.setCatchFinallyBlocks(3);return Ha.yield(lb.doEval(void 0,cb),5);case 5:Cc=Ha.yieldResult;La=Cc.error?Cc.error:Cc.isError?Cc.value:null;Sa=Cc.value;Ha.leaveTryBlock(4);break;case 3:La=Tb=Ha.enterCatchBlock();case 4:Bg.Inspector.openInWindow({targetObject:La||Sa});case 2:return Ha.return(Cc)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(lb,cb,Cc){Cc=void 0===Cc?1:Cc;var La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){switch(Sa.nextAddress){case 1:return lb.maybeSelectCommentOrLine(),Sa.setCatchFinallyBlocks(2),cb=Object.assign({},cb,{inspect:!0,inspectDepth:Cc,logDoit:!0}),Sa.yield(lb.doEval(void 0,cb),4);case 4:La=Sa.yieldResult;Sa.leaveTryBlock(3);break;case 2:Sa.enterCatchBlock();case 3:return lb.selection.collapseToEnd(),lb.insertTextAndSelect(La.value),Sa.return(La)}})}}];Bg.codeEvaluationCommands=
Tf;Bg.codeEvaluationCommands=Tf;Bg.codeEvaluationCommands=Tf;var Eh=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Eh.changeAttributeInSelectionOrMorph=function(lb,cb,Cc){var La=lb.selection;lb.keepPosAtSameScrollOffsetWhile(function(){La.isEmpty()?lb[cb]="function"===typeof Cc?Cc(lb[cb]):Cc:lb.undoManager&&(lb.undoManager.group(),lb.changeStyleProperty(cb,function(Sa){return"function"===typeof Cc?Cc(Sa):Cc}),lb.undoManager.group())})};fg=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(lb){var cb=lb.fontSize;Eh.changeAttributeInSelectionOrMorph(lb,"fontSize",function(Cc){Cc=Cc||cb;return Cc+(18<=Cc?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(lb){var cb=lb.fontSize;Eh.changeAttributeInSelectionOrMorph(lb,"fontSize",function(Cc){Cc=Cc||cb;return Cc-(18>=Cc?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(lb){var cb,Cc,La,Sa,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){if(1==oa.nextAddress){cb=
["serif","sans-serif","monospace"];if(Cc=localStorage["lively.morpic/text-change-font-additional-fonts"])Cc=JSON.parse(Cc),cb.push.apply(cb,$jscomp.arrayFromIterable(Cc));cb.map(function(Tb){return Tb.toLowerCase()}).includes(lb.fontFamily.toLowerCase())||(cb.push(lb.fontFamily),Cc=[].concat($jscomp.arrayFromIterable(Cc||[]),[lb.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Cc));return oa.yield($world.editListPrompt("choose font",cb,{requester:lb,preselect:cb.indexOf(lb.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}La=oa.yieldResult;Sa=$jscomp.makeIterator(La.selections);if(Ya=Sa.next().value)lb.fontFamily=Ya;return oa.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(lb,cb){cb=void 0===cb?{}:cb;var Cc,La,Sa,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){if(1==oa.nextAddress){if(cb.hasOwnProperty("link"))return oa.jumpTo(2);La=lb.selection;Sa=lb.getStyleInRange(La);Ya=Sa.link;return oa.yield(lb.world().prompt("Set link",
{input:Ya||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=oa.nextAddress&&(Cc=oa.yieldResult,!Cc))return oa.return();lb.undoManager.group();lb.setStyleInRange({link:Cc||void 0},La);lb.undoManager.group();oa.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(lb,cb){var Cc,La,Sa,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){if(1==oa.nextAddress)return Cc=lb.selection,La=lb.getStyleInRange(Cc),Sa=La.doit,oa.yield(lb.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:lb,input:Sa?Sa.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:lb.evalEnvForDoit(Sa||{})}),2);Ya=oa.yieldResult;lb.undoManager.group();Ya?lb.addTextAttribute({doit:{code:Ya},nativeCursor:"pointer",textDecoration:"underline"},Cc):lb.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Cc);lb.undoManager.group();oa.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(lb,cb){cb=void 0===cb?{}:cb;lb.undoManager.group();
cb=!cb.onlySelection&&lb.selection.isEmpty()?lb.documentRange:lb.selection.range;lb.setStyleInRange(null,cb);lb.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(lb){var cb,Cc,La,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ya){if(1==Ya.nextAddress)return Ya.yield(System.import("lively.modules"),2);if(3!=Ya.nextAddress)return cb=Ya.yieldResult,Cc=cb.module,Ya.yield(Cc("lively.ide/text/ui.js").load(),3);La=Ya.yieldResult;Sa=La.RichTextControl;return Ya.return(Sa.openFor(lb))})}}];
Eh.commands=fg;Eh.commands=fg;Eh.commands=fg;var Kd=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");Kd.guessTextModeName=qb;Kd.rangedToken=function(lb,cb,Cc,La,Sa){return{start:{row:lb,column:cb},end:{row:lb,column:Cc},token:La,mode:Sa}};Kd.fun=Wc;Kd.arr=Uc;Kd.connect=jd;Kd.disconnect=rc;Kd.DefaultTheme=ud;Kd.tokenizeDocument=qd;Kd.modeInfo=Ic;Kd.visitDocumentTokens=ub;Kd.getMode=Wa;Kd.completionCommands=me;Kd.multiSelectCommands=zf;Kd.navCommands=C;Kd.codeCommands=Bf;Kd.codeEvaluationCommands=
Tf;Kd.richTextCommands=fg;Kd.Color=Zb;Kd.Range=We;Kd.guessTextModeName=qb;Kd.guessTextModeName=qb;ud=function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Cc=cb.hasOwnProperty("EditorPlugin")&&"function"===typeof cb.EditorPlugin?cb.EditorPlugin:cb.EditorPlugin=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return lc(Cc,lb,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
Kd.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(La){var Sa=this;this.textMorph=La;Kd.connect(La,"textChange",this,"onTextChange");Kd.connect(La,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Sa.highlight()})}},
{key:"detach",value:function(La){Kd.disconnect(La,"textChange",this,"onTextChange");Kd.disconnect(La,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(La){this._ast=null;if(La){var Sa=this._tokenizerValidBefore;if("replace"===La.selector){var Ya=La.args[0].start;La=Ya.row;Ya=Ya.column}else Ya=La=0;if(!Sa||La<Sa.row||La===Sa.row&&Ya<Sa.column)La=Math.max(0,La),this._tokenizerValidBefore={row:La,
column:Ya}}this.requestHighlight()}},{key:"requestHighlight",value:function(La){var Sa=this;(void 0===La?0:La)?this.highlight():Kd.fun.debounceNamed(this.textMorph.id+"-requestHighlight",300,function(){Sa.highlight()})()}},{key:"highlight",value:function(){var La=this.textMorph,Sa=this.theme,Ya=this.mode,oa=this._tokenizerValidBefore;if(Sa&&La&&La.document&&Ya){La.fill=Sa.background;La.cursorColor=Sa.cursorColor||La.fontColor;var Tb=La.viewState,Ha={};oa=Kd.tokenizeDocument(Ya,La.document,Tb.firstVisibleRow,
Tb.lastVisibleRow,oa);Ya=oa.lines;oa=oa.tokens;if(Ya.length){Tb=Ya[0].row;for(var ab=[],vb=0;vb<oa.length;Tb++,vb++)for(var oc=oa[vb],Sc=0;Sc<oc.length;Sc+=5){var md=oc[Sc],xd=oc[Sc+1],nd=Sa[oc[Sc+2]]||Sa.default;nd&&ab.push({start:{row:Tb,column:md},end:{row:Tb,column:xd}},nd)}La.embeddedMorphs.forEach(function($d){var Ie=La.embeddedMorphMap.get($d).anchor;Ha[$d.id]=La.textAttributeAt(Ie.position)});La.setTextAttributesWithSortedRanges(ab);La.embeddedMorphs.forEach(function($d){var Ie=La.embeddedMorphMap.get($d).anchor;
Ie=Kd.Range.at(Ie.position);Ie.end.column+=1;La.replace(Ie,[$d,Ha[$d.id]],!1)});this._tokenizerValidBefore={row:Kd.arr.last(Ya).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},La,this)}}},{key:"visitTokensInRange",value:function(La,Sa){var Ya=La.start,oa=La.end,Tb=Ya.row-1;Kd.visitDocumentTokens(this.mode,this.textMorph.document,Ya.row,oa.row,null,function(Ha){return Tb++},function(Ha,ab,vb,oc,Sc,md,xd){if(Tb===Ya.row&&0<Ya.column){if(Ya.column>=oc)return;vb<Ya.column&&Ya.column<
oc&&(vb=Ya.column)}if(Tb===oa.row){if(oa.column<=vb)return;vb<oa.column&&oa.column<oc&&(oc=oa.column)}Sa(Ha,ab,Tb,vb,oc,Sc,md,xd)})}},{key:"tokensInRange",value:function(La){var Sa=[];this.visitTokensInRange(La,function(Ya,oa,Tb,Ha,ab,vb,oc,Sc){return Sa.push(Kd.rangedToken(Tb,Ha,ab,Ya,Sc))});return Sa}},{key:"tokensOfRow",value:function(La){var Sa=this.textMorph.getLine(La).length;return this.tokensInRange({start:{row:La,column:0},end:{row:La,column:Sa}})}},{key:"tokenAt",value:function(La){for(var Sa=
this.tokensOfRow(La.row),Ya=Sa.length;Ya--;){var oa=Sa[Ya];if(oa.token&&oa.start.column<=La.column&&La.column<=oa.end.column)return oa}return null}},{key:"getCommands",value:function(La){return[].concat($jscomp.arrayFromIterable(La),$jscomp.arrayFromIterable(Kd.completionCommands),$jscomp.arrayFromIterable(Kd.multiSelectCommands),$jscomp.arrayFromIterable(Kd.navCommands),$jscomp.arrayFromIterable(Kd.codeCommands),$jscomp.arrayFromIterable(Kd.codeEvaluationCommands),$jscomp.arrayFromIterable(Kd.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var La=this.mode,Sa=La.lineComment,Ya=La.blockCommentStart;La=La.blockCommentEnd;var oa={};Sa&&(oa.lineCommentStart=Sa);Ya&&(oa.blockCommentStart=Ya);La&&(oa.blockCommentEnd=La);return oa}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(La,Sa,Ya){var oa=this.textMorph,Tb=La.row,Ha=La.column;La=Sa[Ha-1];Sa=Sa[Ha];oa.selection.text="\n";oa.selection.collapseToEnd();
"{"===La&&"}"===Sa&&(oa.selection.text="\n"+" ".repeat(Ya),oa.selection.collapse());oa.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Tb+1,lastRow:Tb+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var La=this.textMorph,Sa=this.openPairs,Ya=La.selection,oa=La.getLine(Ya.end.row),
Tb=oa[Ya.end.column-1];oa=oa[Ya.end.column];La.autoInsertPairs&&Ya.isEmpty()&&Tb in Sa&&oa===Sa[Tb]&&(Ya.growRight(1),Ya.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(La){var Sa=this.openPairs,Ya=this.closePairs,oa=this.textMorph,Tb=oa.selection,Ha=oa.autoInsertPairs&&La in Sa,ab=oa.autoInsertPairs&&La in Ya;if(!Ha&&!ab)return!1;var vb=oa.getLine(Tb.end.row)[Tb.end.column];if(!Tb.isEmpty()){if(!Ha)return!1;Ya=oa.undoManager.ensureNewGroup(oa);oa.insertText(Sa[La],Tb.end);oa.insertText(La,
Tb.start);oa.undoManager.group(Ya);Tb.growRight(-1);return!0}if(vb in Ya&&La===vb)return Tb.goRight(1),!0;if(ab&&!Ha)return!1;Ya=oa.undoManager.ensureNewGroup(oa);oa.insertText(La+Sa[La]);oa.undoManager.group(Ya);Tb.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],cb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3148,end:12030})}(void 0);Ic=ud=Kd.EditorPlugin;me=db("C",function(lb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Cc=cb.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof cb.CodeMirrorEnabledEditorPlugin?cb.CodeMirrorEnabledEditorPlugin:cb.CodeMirrorEnabledEditorPlugin=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return lc(Cc,lb,[{key:Symbol.for("lively-instance-initialize"),value:function(){lc._get(Object.getPrototypeOf(Cc.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(La){this.mode=this.codeMirrorMode(La);return lc._get(Object.getPrototypeOf(Cc.prototype),"attach",this).call(this,La)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",
value:function(La){return{indentWithTabs:!La.useSoftTabs,indentUnit:La.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(La){La=this.defaultCodeMirrorModeConfig(La);return Kd.getMode(La,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],cb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:12041,end:12735})}(Kd.EditorPlugin));Kd.CodeMirrorEnabledEditorPlugin=me;Kd.CodeMirrorEnabledEditorPlugin=me;Kd.CodeMirrorEnabledEditorPlugin=me;Kd.default=ud;ud=Object.freeze({__proto__:null,guessTextModeName:qb,"default":Ic,CodeMirrorEnabledEditorPlugin:me});db("e",ud)}}});
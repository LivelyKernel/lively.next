System.register(["./__root_module__-7efb35ac.js","kld-intersections","./user-ui-a91f8c15.js","./index-be7ef9ed.js","./index-43084285.js"],function(Ba,Cb){var Sb,jc,lc,Xd,ed,Yd,id,Wc,Ad,Cd,fe,Sd,jd,bb,Fb,vc,pc,sd,pd;return{setters:[function(tc){Sb=tc.ag;jc=tc.az;lc=tc.ai;Xd=tc.al;ed=tc.Y;Yd=tc.a4;id=tc.ar;Wc=tc.s;Ad=tc.C;Cd=tc.a1;fe=tc.r;Sd=tc.aq;jd=tc.ay;bb=tc.aZ;Fb=tc.a_;vc=tc.ao;pc=tc.aW;sd=tc.aV},function(){},function(tc){pd=tc.UserUI},function(){},function(){}],execute:function(){var tc=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");tc.Morph=Sb;tc.HorizontalLayout=jc;tc.VerticalLayout=lc;tc.morph=Xd;tc.MorphicDB=ed;tc.arr=Yd;tc.fun=id;tc.string=Wc;tc.Color=Ad;tc.pt=Cd;tc.UserUI=pd;tc.resource=fe;var bd=function(Oc){var td=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),Pb=td.hasOwnProperty("WorldDashboard")&&"function"===typeof td.WorldDashboard?td.WorldDashboard:td.WorldDashboard=function(tb){tb&&tb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Sd(Pb,Oc,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[]}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(tb){tb=void 0===tb?$world:tb;this.owner!=tb&&tb.addMorph(this);this.center=tb.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(tb){var hb=
tc.UserUI.getCurrentUser();tb=this.ui.searchField.fuzzyFilter(tb,function(qb){return qb._commit.name+qb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return tc.arr.sortBy(tb,function(qb){return-qb._commit.timestamp});case "TEMPLATES":return tb;case "MY PROJECTS":return tc.arr.filter(tb,function(qb){return qb._commit.author.name===hb.name});case "PUBLISHED":return tb}}},{key:"updateList",value:function(){var tb=this;this.previews&&tc.fun.debounceNamed("update world list",
150,function(){tb.ui.worldList.items=tb.sortAndFilterPreviews(tb.previews)})()}},{key:"displayWorlds",value:function(){var tb=this,hb,qb,za,cb,wb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hb){switch(Hb.nextAddress){case 1:return tb.reset(),hb=tb.ui,qb=hb.loadingLabel,qb.visible=!0,qb.animate({opacity:1,duration:300}),Hb.yield(tb.db.latestCommits("world"),2);case 2:return za=Hb.yieldResult,Hb.yield(Cb.import("./world preview-7b0e30ea.js"),4);case 4:if(!(cb=Hb.yieldResult)){Hb.jumpTo(5);
break}return Hb.yield(tc.resource("part://partial freezing/world preview"),6);case 6:cb=Hb.yieldResult;case 5:return Hb.yield(cb.read(),3);case 3:return wb=Hb.yieldResult,tb.previews=za.map(function(Ub){var lb=tc.morph({reactsToPointer:!1,fill:tc.Color.transparent,extent:wb.extent});lb._commit=Ub;lb.displayPreview=function(){var mb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qb){if(1==Qb.nextAddress)return mb=wb.copy(),mb._commit=Ub,mb.opacity=0,lb.addMorph(mb),mb.displayPreview(),
mb.position=tc.pt(0,0),Qb.yield(lb.whenRendered(),2);lb.layout=new tc.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});Qb.jumpToEnd()})};return lb}),Hb.yield(qb.animate({opacity:0,duration:300}),7);case 7:qb.visible=!1,tb.updateList(),Hb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:"className",get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},
set:function(tb){this.ui.closeButton.visible=tb}},db:{serialize:!1,get:function(){return tc.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label")}}}}}}],td,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-120"}}},{start:330,end:3708})}(tc.Morph);bd=tc.WorldDashboard;tc.default=bd;var Xb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");Xb.Morph=Sb;Xb.touchInputDevice=jd;Xb.TilingLayout=bb;Xb.arr=Yd;Xb.pt=Cd;bd=function(Oc){var td=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),Pb=td.hasOwnProperty("GrowingWorldList")&&"function"===typeof td.GrowingWorldList?
td.GrowingWorldList:td.GrowingWorldList=function(tb){tb&&tb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sd(Pb,Oc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(tb){Sd._get(Object.getPrototypeOf(Pb.prototype),"onScroll",this).call(this,tb);this.update()}},{key:"onChange",value:function(tb){Sd._get(Object.getPrototypeOf(Pb.prototype),"onChange",this).call(this,tb);"extent"==tb.prop&&this.update(!0)}},
{key:"onHoverIn",value:function(tb){this.clipMode="auto"}},{key:"onHoverOut",value:function(tb){Xb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(tb){var hb=this.items;if(hb&&0!=hb.length){var qb=this.scrollContainer,za=qb.layout.spacing;qb.extent=this.extent;var cb=this.ui,wb=cb.bufferTop;cb=cb.bufferBottom;wb=wb||qb.addMorph({fill:null,name:"buffer top",height:10});cb=cb||qb.addMorph({fill:null,name:"buffer bottom",height:10});wb.width=cb.width=this.width-100;qb.layout.disable();
var Hb=hb[0];za=hb.slice(0,Math.floor(this.width/(Hb.width+za))*(Math.ceil((this.scroll.y+this.height)/(Hb.height+za))+1)).filter(function(Qb){return Qb.owner!=qb});Hb=this.scroll.y+2*this.height;for(var Ub={},lb=$jscomp.makeIterator(za),mb=lb.next();!mb.done;Ub={$jscomp$loop$prop$item$2285:Ub.$jscomp$loop$prop$item$2285},mb=lb.next())Ub.$jscomp$loop$prop$item$2285=mb.value,Hb++,Ub.$jscomp$loop$prop$item$2285.top=Hb,qb.addMorph(Ub.$jscomp$loop$prop$item$2285),Ub.$jscomp$loop$prop$item$2285._initialized||
Ub.$jscomp$loop$prop$item$2285.whenRendered().then(function(Qb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gc){Qb.$jscomp$loop$prop$item$2285._initialized=!0;return Gc.yield(Qb.$jscomp$loop$prop$item$2285.displayPreview(),0)})}}(Ub));tb&&(wb.position=Xb.pt(0,0),hb.forEach(function(Qb,Gc){return Qb.position=Xb.pt(Gc+1,Gc+1)}),cb.position=Xb.pt(hb.length+2,hb.length+2));qb.layout.enable();if(tb||0<za.length)cb.top=this.submorphBounds().height,qb.layout.apply()}}}],
[{key:"className",get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Xb.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],
set:function(tb){this.setProperty("items",tb);var hb=this.scrollContainer;hb.layout&&hb.layout.disable();var qb=this.ui,za=qb.bufferTop;qb=qb.bufferBottom;Xb.arr.withoutAll(hb.submorphs,[].concat($jscomp.arrayFromIterable(tb),[za,qb])).forEach(function(cb){return cb.remove()});this.update(!0)}}}}}],td,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",
version:"0.1.1-32"}}},{start:179,end:3777})}(Xb.Morph);bd=Xb.GrowingWorldList;Xb.default=bd;var Tb=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");Tb.InputLine=Fb;Tb.Color=Ad;Tb.connect=vc;Tb.disconnectAll=pc;Tb.disconnect=sd;Tb.arr=Yd;Tb.string=Wc;bd=function(Oc){var td=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),Pb=td.hasOwnProperty("SearchInputLine")&&"function"===typeof td.SearchInputLine?td.SearchInputLine:td.SearchInputLine=function(tb){tb&&tb[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sd(Pb,Oc,[{key:"fuzzyMatch",value:function(tb,hb){hb=void 0===hb?this.parseInput():hb;if(hb.lowercasedTokens.every(function(za){return tb.toLowerCase().includes(za)}))return!0;var qb=tb.toLowerCase();return 3>=Tb.arr.sum(hb.lowercasedTokens.map(function(za){return Tb.string.levenshtein(qb,za)}))}},{key:"fuzzyFilter",value:function(tb,hb){var qb=this;hb=void 0===hb?function(cb){return cb}:hb;var za=this.parseInput();return Tb.arr.filter(tb,
function(cb){return qb.fuzzyMatch(hb(cb),za)})}},{key:"parseInput",value:function(){var tb=Array.from(this.textString).reduce(function(qb,za){if("\\"===za&&!qb.escaped)return qb.escaped=!0,qb;" "!==za||qb.escaped?(qb.spaceSeen=!1,qb.current+=za):(!qb.spaceSeen&&qb.current&&(qb.tokens.push(qb.current),qb.current=""),qb.spaceSeen=!0);qb.escaped=!1;return qb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});tb.current&&tb.tokens.push(tb.current);var hb=tb.tokens.map(function(qb){return qb.toLowerCase()});
return{tokens:tb.tokens,lowercasedTokens:hb}}}],[{key:"className",get:function(){return"SearchInputLine"}}],td,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(Tb.InputLine);bd=Tb.SearchInputLine;Tb.default=bd}}});
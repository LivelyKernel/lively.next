System.register(["./__root_module__-64e296ea.js","kld-intersections"],function(Ba){var Ab,Qb,dc,Xb,Xd,ad,Nd,dd;return{setters:[function(Lc){Ab=Lc.s;Qb=Lc.$;dc=Lc.bm;Xb=Lc.bn;Xd=Lc.au;ad=Lc.a7;Nd=Lc.bo;dd=Lc.aq},function(){}],execute:function(){function Lc(R,ia){var Fa={};ia.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(ub,bc,Sc){bc&&(Fa[bc]=Sc)});return Fa}function rd(R){R=String(R);if(!(100<R.length)&&(R=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(R))){var ia=
parseFloat(R[1]);switch((R[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return ia*Oc;case "days":case "day":case "d":return ia*Fe;case "hours":case "hour":case "hrs":case "hr":case "h":return 36E5*ia;case "minutes":case "minute":case "mins":case "min":case "m":return 6E4*ia;case "seconds":case "second":case "secs":case "sec":case "s":return 1E3*ia;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return ia}}}function Gd(R,ia,Fa){if(!(R<ia))return R<
1.5*ia?Math.floor(R/ia)+" "+Fa:Math.ceil(R/ia)+" "+Fa+"s"}function ke(R){var ia=0,Fa;for(Fa in R)ia=(ia<<5)-ia+R.charCodeAt(Fa),ia|=0;return Eb.colors[Math.abs(ia)%Eb.colors.length]}function Kd(R){function ia(){if(ia.enabled){var ub=+new Date;ia.diff=ub-(Fa||ub);ia.prev=Fa;Fa=ia.curr=ub;var bc=Array(arguments.length);for(ub=0;ub<bc.length;ub++)bc[ub]=arguments[ub];bc[0]=Eb.coerce(bc[0]);"string"!==typeof bc[0]&&bc.unshift("%O");var Sc=0;bc[0]=bc[0].replace(/%([a-zA-Z%])/g,function(be,xe){if("%%"===
be)return be;Sc++;xe=Eb.formatters[xe];"function"===typeof xe&&(be=xe.call(ia,bc[Sc]),bc.splice(Sc,1),Sc--);return be});Eb.formatArgs.call(ia,bc);(ia.log||Eb.log||console.log.bind(console)).apply(ia,bc)}}var Fa;ia.namespace=R;ia.enabled=Eb.enabled(R);ia.useColors=Eb.useColors();ia.color=ke(R);ia.destroy=Hc;"function"===typeof Eb.init&&Eb.init(ia);Eb.instances.push(ia);return ia}function Hc(){var R=Eb.instances.indexOf(this||md);return-1!==R?(Eb.instances.splice(R,1),!0):!1}function fb(){try{var R=
Ca.storage.debug}catch(ia){}!R&&"undefined"!==typeof Mb&&"env"in Mb&&(R=Mb.env.DEBUG);return R}function Db(R){if(R){for(var ia in Db.prototype)R[ia]=Db.prototype[ia];return R}}function mc(R,ia){if(!R)return R;if(pg(R)){var Fa={_placeholder:!0,num:ia.length};ia.push(R);return Fa}if(of(R)){Fa=Array(R.length);for(var ub=0;ub<R.length;ub++)Fa[ub]=mc(R[ub],ia);return Fa}if("object"===typeof R&&!(R instanceof Date)){Fa={};for(ub in R)Fa[ub]=mc(R[ub],ia);return Fa}return R}function hc(R,ia){if(!R)return R;
if(R&&R._placeholder)return ia[R.num];if(of(R))for(var Fa=0;Fa<R.length;Fa++)R[Fa]=hc(R[Fa],ia);else if("object"===typeof R)for(Fa in R)R[Fa]=hc(R[Fa],ia);return R}function Tc(){}function Ld(R){var ia=""+R.type;if(Bb.BINARY_EVENT===R.type||Bb.BINARY_ACK===R.type)ia+=R.attachments+"-";R.nsp&&"/"!==R.nsp&&(ia+=R.nsp+",");null!=R.id&&(ia+=R.id);if(null!=R.data){try{var Fa=JSON.stringify(R.data)}catch(ub){Fa=!1}if(!1!==Fa)ia+=Fa;else return nb}ba("encoded %j as %s",R,ia);return ia}function oc(R,ia){Ia.removeBlobs(R,
function(Fa){var ub=Ia.deconstructPacket(Fa);Fa=Ld(ub.packet);ub=ub.buffers;ub.unshift(Fa);ia(ub)})}function pc(){(this||$a).reconstructor=null}function Nb(R){(this||$a).reconPack=R;(this||$a).buffers=[]}function Dc(R){if(!R||"object"!==typeof R)return!1;if(fg(R)){for(var ia=0,Fa=R.length;ia<Fa;ia++)if(Dc(R[ia]))return!0;return!1}if("function"===typeof yg&&yg.isBuffer&&yg.isBuffer(R)||"function"===typeof ArrayBuffer&&R instanceof ArrayBuffer||ri&&R instanceof Blob||Lh&&R instanceof File)return!0;
if(R.toJSON&&"function"===typeof R.toJSON&&1===arguments.length)return Dc(R.toJSON(),!0);for(ia in R)if(Object.prototype.hasOwnProperty.call(R,ia)&&Dc(R[ia]))return!0;return!1}function Vc(){}function Hd(R){return R.map(function(ia){if(ia.buffer instanceof ArrayBuffer){var Fa=ia.buffer;if(ia.byteLength!==Fa.byteLength){var ub=new Uint8Array(ia.byteLength);ub.set(new Uint8Array(Fa,ia.byteOffset,ia.byteLength));Fa=ub.buffer}return Fa}return ia})}function Id(R,ia){ia=ia||{};var Fa=new rj;Hd(R).forEach(function(ub){Fa.append(ub)});
return ia.type?Fa.getBlob(ia.type):Fa.getBlob()}function rb(R,ia){return new Blob(Hd(R),ia||{})}function Hb(R){for(var ia=[],Fa=0,ub=R.length,bc,Sc;Fa<ub;)bc=R.charCodeAt(Fa++),55296<=bc&&56319>=bc&&Fa<ub?(Sc=R.charCodeAt(Fa++),56320==(Sc&64512)?ia.push(((bc&1023)<<10)+(Sc&1023)+65536):(ia.push(bc),Fa--)):ia.push(bc);return ia}function Mc(R,ia){if(55296<=R&&57343>=R){if(ia)throw Error("Lone surrogate U+"+R.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function qb(){if(ue>=
td)throw Error("Invalid byte index");var R=Ub[ue]&255;ue++;if(128==(R&192))return R&63;throw Error("Invalid continuation byte");}function tb(R){if(ue>td)throw Error("Invalid byte index");if(ue==td)return!1;var ia=Ub[ue]&255;ue++;if(0==(ia&128))return ia;if(192==(ia&224)){var Fa=qb();ia=(ia&31)<<6|Fa;if(128<=ia)return ia;throw Error("Invalid continuation byte");}if(224==(ia&240)){Fa=qb();var ub=qb();ia=(ia&15)<<12|Fa<<6|ub;if(2048<=ia)return Mc(ia,R)?ia:65533;throw Error("Invalid continuation byte");
}if(240==(ia&248)&&(Fa=qb(),ub=qb(),R=qb(),ia=(ia&7)<<18|Fa<<12|ub<<6|R,65536<=ia&&1114111>=ia))return ia;throw Error("Invalid UTF-8 detected");}function eb(R,ia,Fa){if(!ia)return Ud.encodeBase64Packet(R,Fa);var ub=new FileReader;ub.onload=function(){Ud.encodePacket({type:R.type,data:ub.result},ia,!0,Fa)};return ub.readAsArrayBuffer(R.data)}function ob(R,ia,Fa){var ub=Array(R.length);Fa=pd(R.length,Fa);for(var bc=function(be,xe,Yd){ia(xe,function(Bf,dg){ub[be]=dg;Yd(Bf,ub)})},Sc=0;Sc<R.length;Sc++)bc(Sc,
R[Sc],Fa)}function wb(R){var ia="";do ia=oo[R%64]+ia,R=Math.floor(R/64);while(0<R);return ia}function cb(){var R=wb(+new Date);return R!==Hn?(Cm=0,Hn=R):R+"."+wb(Cm++)}function Oa(R){(this||ug).path=R.path;(this||ug).hostname=R.hostname;(this||ug).port=R.port;(this||ug).secure=R.secure;(this||ug).query=R.query;(this||ug).timestampParam=R.timestampParam;(this||ug).timestampRequests=R.timestampRequests;(this||ug).readyState="";(this||ug).agent=R.agent||!1;(this||ug).socket=R.socket;(this||ug).enablesXDR=
R.enablesXDR;(this||ug).withCredentials=R.withCredentials;(this||ug).pfx=R.pfx;(this||ug).key=R.key;(this||ug).passphrase=R.passphrase;(this||ug).cert=R.cert;(this||ug).ca=R.ca;(this||ug).ciphers=R.ciphers;(this||ug).rejectUnauthorized=R.rejectUnauthorized;(this||ug).forceNode=R.forceNode;(this||ug).isReactNative=R.isReactNative;(this||ug).extraHeaders=R.extraHeaders;(this||ug).localAddress=R.localAddress}function Gb(R){var ia=R&&R.forceBase64;if(!Bl||ia)(this||ih).supportsBinary=!1;ji.call(this||
ih,R)}function sc(){}function vc(R){Qo.call(this||Qe,R);(this||Qe).requestTimeout=R.requestTimeout;(this||Qe).extraHeaders=R.extraHeaders;if("undefined"!==typeof location){var ia="https:"===location.protocol,Fa=location.port;Fa||(Fa=ia?443:80);(this||Qe).xd="undefined"!==typeof location&&R.hostname!==location.hostname||Fa!==R.port;(this||Qe).xs=R.secure!==ia}}function fc(R){(this||Qe).method=R.method||"GET";(this||Qe).uri=R.uri;(this||Qe).xd=!!R.xd;(this||Qe).xs=!!R.xs;(this||Qe).async=!1!==R.async;
(this||Qe).data=void 0!==R.data?R.data:null;(this||Qe).agent=R.agent;(this||Qe).isBinary=R.isBinary;(this||Qe).supportsBinary=R.supportsBinary;(this||Qe).enablesXDR=R.enablesXDR;(this||Qe).withCredentials=R.withCredentials;(this||Qe).requestTimeout=R.requestTimeout;(this||Qe).pfx=R.pfx;(this||Qe).key=R.key;(this||Qe).passphrase=R.passphrase;(this||Qe).cert=R.cert;(this||Qe).ca=R.ca;(this||Qe).ciphers=R.ciphers;(this||Qe).rejectUnauthorized=R.rejectUnauthorized;(this||Qe).extraHeaders=R.extraHeaders;
this.create()}function rc(){for(var R in fc.requests)fc.requests.hasOwnProperty(R)&&fc.requests[R].abort()}function Q(){}function ha(R){In.call(this||yh,R);(this||yh).query=(this||yh).query||{};Ol||(Ol=Ro.___eio=Ro.___eio||[]);(this||yh).index=Ol.length;var ia=this||yh;Ol.push(function(Fa){ia.onData(Fa)});(this||yh).query.j=(this||yh).index;"function"===typeof addEventListener&&addEventListener("beforeunload",function(){ia.script&&(ia.script.onerror=Q)},!1)}function Ga(R){R&&R.forceBase64&&((this||
ra).supportsBinary=!1);(this||ra).perMessageDeflate=R.perMessageDeflate;(this||ra).usingBrowserWebSocket=xc&&!R.forceNode;(this||ra).protocols=R.protocols;(this||ra).usingBrowserWebSocket||(Sd=Ic);Za.call(this||ra,R)}function La(R,ia){if(!((this||id)instanceof La))return new La(R,ia);ia=ia||{};R&&"object"===typeof R&&(ia=R,R=null);R?(R=Vk(R),ia.hostname=R.host,ia.secure="https"===R.protocol||"wss"===R.protocol,ia.port=R.port,R.query&&(ia.query=R.query)):ia.host&&(ia.hostname=Vk(ia.host).host);(this||
id).secure=null!=ia.secure?ia.secure:"undefined"!==typeof location&&"https:"===location.protocol;ia.hostname&&!ia.port&&(ia.port=(this||id).secure?"443":"80");(this||id).agent=ia.agent||!1;(this||id).hostname=ia.hostname||("undefined"!==typeof location?location.hostname:"localhost");(this||id).port=ia.port||("undefined"!==typeof location&&location.port?location.port:(this||id).secure?443:80);(this||id).query=ia.query||{};"string"===typeof(this||id).query&&((this||id).query=Po.decode((this||id).query));
(this||id).upgrade=!1!==ia.upgrade;(this||id).path=(ia.path||"/engine.io").replace(/\/$/,"")+"/";(this||id).forceJSONP=!!ia.forceJSONP;(this||id).jsonp=!1!==ia.jsonp;(this||id).forceBase64=!!ia.forceBase64;(this||id).enablesXDR=!!ia.enablesXDR;(this||id).withCredentials=!1!==ia.withCredentials;(this||id).timestampParam=ia.timestampParam||"t";(this||id).timestampRequests=ia.timestampRequests;(this||id).transports=ia.transports||["polling","websocket"];(this||id).transportOptions=ia.transportOptions||
{};(this||id).readyState="";(this||id).writeBuffer=[];(this||id).prevBufferLen=0;(this||id).policyPort=ia.policyPort||843;(this||id).rememberUpgrade=ia.rememberUpgrade||!1;(this||id).binaryType=null;(this||id).onlyBinaryUpgrades=ia.onlyBinaryUpgrades;(this||id).perMessageDeflate=!1!==ia.perMessageDeflate?ia.perMessageDeflate||{}:!1;!0===(this||id).perMessageDeflate&&((this||id).perMessageDeflate={});(this||id).perMessageDeflate&&null==(this||id).perMessageDeflate.threshold&&((this||id).perMessageDeflate.threshold=
1024);(this||id).pfx=ia.pfx||null;(this||id).key=ia.key||null;(this||id).passphrase=ia.passphrase||null;(this||id).cert=ia.cert||null;(this||id).ca=ia.ca||null;(this||id).ciphers=ia.ciphers||null;(this||id).rejectUnauthorized=void 0===ia.rejectUnauthorized?!0:ia.rejectUnauthorized;(this||id).forceNode=!!ia.forceNode;(this||id).isReactNative="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();if("undefined"===typeof self||(this||id).isReactNative)ia.extraHeaders&&
0<Object.keys(ia.extraHeaders).length&&((this||id).extraHeaders=ia.extraHeaders),ia.localAddress&&((this||id).localAddress=ia.localAddress);(this||id).id=null;(this||id).upgrades=null;(this||id).pingInterval=null;(this||id).pingTimeout=null;(this||id).pingIntervalTimer=null;(this||id).pingTimeoutTimer=null;this.open()}function Yb(R,ia,Fa){(this||qf).io=R;(this||qf).nsp=ia;(this||qf).json=this||qf;(this||qf).ids=0;(this||qf).acks={};(this||qf).receiveBuffer=[];(this||qf).sendBuffer=[];(this||qf).connected=
!1;(this||qf).disconnected=!0;(this||qf).flags={};Fa&&Fa.query&&((this||qf).query=Fa.query);(this||qf).io.autoConnect&&this.open()}function kc(R){R=R||{};(this||gl).ms=R.min||100;(this||gl).max=R.max||1E4;(this||gl).factor=R.factor||2;(this||gl).jitter=0<R.jitter&&1>=R.jitter?R.jitter:0;(this||gl).attempts=0}function Ua(R,ia){if(!((this||oe)instanceof Ua))return new Ua(R,ia);R&&"object"===typeof R&&(ia=R,R=void 0);ia=ia||{};ia.path=ia.path||"/socket.io";(this||oe).nsps={};(this||oe).subs=[];(this||
oe).opts=ia;this.reconnection(!1!==ia.reconnection);this.reconnectionAttempts(ia.reconnectionAttempts||Infinity);this.reconnectionDelay(ia.reconnectionDelay||1E3);this.reconnectionDelayMax(ia.reconnectionDelayMax||5E3);this.randomizationFactor(ia.randomizationFactor||.5);(this||oe).backoff=new Qq({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==ia.timeout?2E4:ia.timeout);(this||oe).readyState="closed";(this||oe).uri=R;(this||oe).connecting=
[];(this||oe).lastPing=null;(this||oe).encoding=!1;(this||oe).packetBuffer=[];R=ia.parser||Pl;(this||oe).encoder=new R.Encoder;(this||oe).decoder=new R.Decoder;(this||oe).autoConnect=!1!==ia.autoConnect;(this||oe).autoConnect&&this.open()}function ec(R,ia){"object"===typeof R&&(ia=R,R=void 0);ia=ia||{};R=mu(R);var Fa=R.source,ub=R.id,bc=R.path;bc=$p[ub]&&bc in $p[ub].nsps;ia.forceNew||ia["force new connection"]||!1===ia.multiplex||bc?(Tq("ignoring socket cache for %s",Fa),Fa=Sq(Fa,ia)):($p[ub]||(Tq("new io instance for %s",
Fa),$p[ub]=Sq(Fa,ia)),Fa=$p[ub]);R.query&&!ia.query&&(ia.query=R.query);return Fa.socket(R.path,ia)}var ge=lively.FreezerRuntime.recorderFor("lively.2lively/interface.js");ge.nyi=function(R){throw Error("Not yet implemented: "+R);};ge.string=Ab;ge.promise=Qb;ge.debugMessageOrder=!1;var ee=function(R){this.id=ge.string.newUUID();this.actions={};this.options={ackTimeout:3500,debug:!1};this._incomingOrderNumberingBySenders=new Map;this._outgoingOrderNumberingByTargets=new Map;this._outOfOrderCacheBySenders=
new Map};ee.prototype.isOnline=function(){ge.nyi("isOnline")};ee.prototype.open=function(){ge.nyi("open")};ee.prototype.close=function(){ge.nyi("close")};ee.prototype.remove=function(){ge.nyi("remove")};ee.prototype.whenOnline=function(R){var ia=this;return ge.promise.waitFor(R,function(){return ia.isOnline()}).then(function(){return ia}).catch(function(Fa){return Promise.reject(/timeout/i.test(String(Fa))?Error("Timeout in "+ia+".whenOnline"):Fa)})};ee.prototype.onError=function(R){this.debug&&console.log("["+
this+"] error: "+R)};ee.prototype.removeService=function(R){delete this.actions[R]};ee.prototype.removeServices=function(R){var ia=this;R.forEach(function(Fa){return ia.removeService(Fa)})};ee.prototype.addService=function(R,ia){this.actions[R]=ia};ee.prototype.addServices=function(R){var ia=this;Object.keys(R).forEach(function(Fa){return ia.addService(Fa,R[Fa])})};ee.prototype.ping=function(R){var ia=this,Fa,ub,bc,Sc,be;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xe){if(1==xe.nextAddress)return Fa=
Date.now(),xe.yield(ia.sendToAndWait(R,"l2l-ping",{timestamp:Fa}),2);ub=xe.yieldResult;bc=ub.data;Sc=bc.timestamp;be=Date.now();return xe.return({to:Sc-Fa,from:be-Sc,roundtrip:be-Fa})})};ee.prototype.send=function(R,ia){ge.nyi("send")};ee.prototype.sendAndWait=function(R){var ia=this,Fa,ub,bc,Sc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(be){switch(be.nextAddress){case 1:return Fa=new Promise(function(xe,Yd){return ia.send(R,xe)}),ub={},bc=ia.options.ackTimeout+400,"ackTimeout"in
R&&(bc=!R.ackTimeout||0>R.ackTimeout?null:R.ackTimeout+400),bc?be.yield(Promise.race([ge.promise.delay(bc,ub),Fa]),5):be.yield(Fa,4);case 4:Sc=be.yieldResult;be.jumpTo(3);break;case 5:Sc=be.yieldResult;case 3:if(Sc===ub)throw Error("Timeout sending "+R.action);return be.return(Sc)}})};ee.prototype.sendTo=function(R,ia,Fa,ub){return this.send({target:R,action:ia,data:Fa},ub)};ee.prototype.sendToAndWait=function(R,ia,Fa,ub){return this.sendAndWait(Object.assign({target:R,action:ia,data:Fa},ub))};ee.prototype.prepareSend=
function(R,ia){var Fa=R.target,ub=R.action,bc=R.messageId,Sc=R.sender;if(!ub)throw Error("Trying to send a message without specifying action!");if(!Fa)throw Error("Trying to send message "+ub+" without specifying target!");bc||(R.messageId=ge.string.newUUID());Sc||(R.sender=this.id);ub=R.n=this._outgoingOrderNumberingByTargets.get(Fa)||0;this._outgoingOrderNumberingByTargets.set(Fa,ub+1);if("function"===typeof ia){Sc=this;var be=ia;ia=function(xe){var Yd=Sc._incomingOrderNumberingBySenders.get(xe.sender)||
0;Sc.debug&&ge.debugMessageOrder&&console.log("[MSG ORDER] "+Sc+" received ack for "+xe.action+" as msg "+Yd);try{be.apply(null,arguments)}catch(Bf){console.error("Error in ack fn of "+Sc+": "+Bf.stack)}Sc._incomingOrderNumberingBySenders.set(xe.sender,Yd+1);setTimeout(function(){return Sc.invokeOutOfOrderMessages(xe.sender)},0)}}this.debug&&ge.debugMessageOrder&&console.log("[MSG ORDER] "+this+" sending "+ub+" ("+R.action+") to "+Fa);return[R,ia]};ee.prototype.prepareAnswerMessage=function(R,ia){return{action:R.action+
"-response",inResponseTo:R.messageId,target:R.sender,data:ia,sender:this.id}};ee.prototype.installEventToMessageTranslator=function(R){var ia=this,Fa=R.onevent;R.onevent=function(ub){var bc=ub.data||[];Fa.call(this,ub);ub.data=["*"].concat(bc);Fa.call(this,ub)};R.on("*",function(ub,bc){ub&&"object"===typeof ub&&ub.action&&(bc=ub,ub=bc.action);var Sc=arguments[arguments.length-1];Sc="function"===typeof Sc?Sc:null;(bc=bc===Sc?null:bc)&&bc.data&&("number"===typeof bc.n||bc.broadcast)&&bc.sender?ia.receive(bc,
R,Sc):(console.warn(ia+" received non-conformant message "+ub+":",arguments),"function"===typeof Sc&&Sc({data:{error:"invalid l2l message"}}))})};ee.prototype.receive=function(R,ia,Fa){this.dispatchL2LMessageToSelf(R,ia,Fa)};ee.prototype.dispatchL2LMessageToSelf=function(R,ia,Fa){var ub=this,bc=R.action;if(R.broadcast)this.safeInvokeServiceHandler(bc,R,Fa,ia);else try{var Sc=this._incomingOrderNumberingBySenders.get(R.sender)||0,be="register"===bc||"unregister";if(!be&&R.n<Sc)console.error("[MSG ORDER] ["+
this+"] received message no. "+R.n+" but expected >= "+Sc+", dropping "+bc);else if(!be&&R.n>Sc){this.debug&&ge.debugMessageOrder&&console.log("[MSG ORDER] ["+this+"] storing out of order message "+bc+" ("+R.n+") for later invocation");var xe=this._outOfOrderCacheBySenders.get(R.sender);xe||(xe=[],this._outOfOrderCacheBySenders.set(R.sender,xe));xe.push([bc,R,Fa,ia])}else this.safeInvokeServiceHandler(bc,R,Fa,ia),setTimeout(function(){return ub.invokeOutOfOrderMessages(R.sender)},0)}catch(Yd){console.error("Error message ordering when handling "+
bc+": "+(Yd.stack||Yd)),"function"===typeof Fa&&Fa(this.prepareAnswerMessage(R,{isError:!0,error:String(Yd.stack||Yd)}))}};ee.prototype.invokeOutOfOrderMessages=function(R){var ia=this._outOfOrderCacheBySenders.get(R);if(ia&&ia.length){var Fa=this._incomingOrderNumberingBySenders.get(R)||0;R=ia.findIndex(function(ub){ub=$jscomp.makeIterator(ub);ub.next();return ub.next().value.n===Fa});-1!==R&&(ia.splice(R,1),this.invokeServiceHandler.apply(this,ia[R]))}};ee.prototype.renameTarget=function(R,ia){if(R!==
ia){var Fa=this._outgoingOrderNumberingByTargets.get(R);this._outgoingOrderNumberingByTargets.delete(R);this._outgoingOrderNumberingByTargets.set(ia,Fa)}};ee.prototype.safeInvokeServiceHandler=function(R,ia,Fa,ub){try{"function"===typeof this.actions[R]?this.invokeServiceHandler(R,ia,Fa,ub):ub._events&&Object.keys(ub._events).includes(R)||(console.warn("WARNING ["+this+"] Unhandled message: "+R),"function"===typeof Fa&&Fa(this.prepareAnswerMessage(ia,{isError:!0,error:"message not understood: "+R})))}catch(bc){console.error("Error when handling "+
R+": "+(bc.stack||bc)),"function"===typeof Fa&&Fa(this.prepareAnswerMessage(ia,{isError:!0,error:String(bc.stack||bc)}))}};ee.prototype.invokeServiceHandler=function(R,ia,Fa,ub){var bc=this;this.debug&&ge.debugMessageOrder&&console.log("[MSG ORDER] "+this+" received "+ia.n+" ("+ia.action+") from "+ia.sender);this._incomingOrderNumberingBySenders.set(ia.sender,ia.n+1);if("function"===typeof Fa){var Sc=!1,be=!1,xe="ackTimeout"in ia?ia.ackTimeout:this.options.ackTimeout,Yd=this._outgoingOrderNumberingByTargets.get(ia.sender)||
0;this._outgoingOrderNumberingByTargets.set(ia.sender,Yd+1);var Bf=function(dg){be?console.warn("["+bc+"] ackFn for "+ia.action+" called after it timed out, dropping answer!"):Sc?console.warn("["+bc+"] ack function called repeatedly when handling "+ia.action):(Sc=!0,Fa(bc.prepareAnswerMessage(ia,dg)),bc.debug&&ge.debugMessageOrder&&console.log("[MSG ORDER] "+bc+" sending "+Yd+" (ack for "+ia.action+")"))};xe&&setTimeout(function(){Sc||(Bf({isError:!0,error:"Timeout error: "+bc+" did not send answer for "+
ia.action+" after "+xe+"ms"}),be=!0)},xe)}try{this.actions[R].call(this,this,ia,Bf,ub)}catch(dg){console.error("["+this+"] Error handling "+R+": "+(dg.stack||dg)),Bf&&Bf({error:dg.stack})}};$jscomp.global.Object.defineProperties(ee.prototype,{debug:{configurable:!0,enumerable:!0,get:function(){return this.options.debug},set:function(R){this.options.debug=R}}});ge.L2LConnection=ee;ge.default=ee;var ed=lively.FreezerRuntime.recorderFor("lively.2lively/default-actions.js"),ab={"l2l-ping":function(R,
ia,Fa,ub){ub=ia.sender;ia=ia.data.timestamp;var bc=Date.now();"function"===typeof Fa&&Fa({timestamp:bc});R.debug&&console.log("[undefined] got ping from "+ub+", time: "+(bc-ia)+"ms")},"remote-eval":function(R,ia,Fa,ub){var bc=ia.data.source;Promise.resolve().then(function(){return eval(bc)}).then(function(Sc){return Fa({value:Sc})}).catch(function(Sc){Sc.originalErr&&(Sc=Sc.originalErr);console.error("eval error: "+Sc);"function"===typeof Fa&&Fa({isError:!0,value:String(Sc.stack||Sc)})})},"remote-eval-2":function(R,
ia,Fa,ub){var bc=ia.data.source;Promise.resolve().then(function(){var Sc=eval(bc);if(!(Sc instanceof Promise))throw console.error("unexpected eval result:"+Sc),Error("unexpected eval result:"+Sc);return Sc}).then(function(Sc){return Fa(Sc)}).catch(function(Sc){console.error("eval error: "+Sc);Sc.originalErr&&(Sc=Sc.originalErr);"function"===typeof Fa&&Fa({isError:!0,value:String(Sc.stack||Sc)})})}};ed.defaultActions=ab;ed.defaultActions=ab;ed.defaultActions=ab;var Rc={},pb=(Rc["[broadcast] send"]=
function(R,ia,Fa,ub){var bc=ia.sender,Sc=ia.data,be,xe,Yd,Bf,dg,ki,ij,gk,tp,Wo,vo,up;return $jscomp.asyncExecutePromiseGeneratorProgram(function(aq){be=Sc;xe=be.action;Yd=be.broadcast;Bf=be.room;dg=be.namespace;ki=be.isSystemBroadcast;ij=be.isMultiServerBroadcast;gk=[];ij?(console.log(".......isMultiServerBroadcast"),tp=R,Wo=tp.id,vo=R.getTrackerList(),console.log(vo),gk=vo.map(function(wo){return wo.id!=Wo?wo.io.nsps["/"+wo.namespace]:ub.broadcast})):(ki&&(dg=R.namespace),gk.push(dg?R.io.nsps["/"+
dg]:ub.broadcast));gk.forEach(function(wo){return wo.to(Bf).emit({action:xe,sender:bc,broadcast:!0,data:Yd})});Fa&&"function"===typeof Fa&&(up="message broadcasted to "+Bf,dg&&(up+=" in namespace "+dg),1<gk.length&&(up+=" "+gk.length+" trackers"),console.log(up),Fa({status:up}));aq.jumpToEnd()})},Rc["[broadcast] join room"]=function(R,ia,Fa,ub){var bc=ia.sender,Sc=ia.data.room,be,xe,Yd,Bf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(dg){if(1==dg.nextAddress)return xe=!1,Yd=R.io.nsps["/"+
R.namespace].adapter.rooms,(Bf=Yd[Sc]&&Yd[Sc].sockets&&Yd[Sc].sockets[ub.id])?(be=bc+" already in "+Sc,dg.jumpTo(2)):dg.yield(new Promise(function(ki,ij){return ub.join(Sc,function(gk){return gk?ij(gk):ki()})}),3);2!=dg.nextAddress&&(be=bc+" joined "+Sc,xe=!0);Fa&&"function"===typeof Fa&&Fa({status:be,joined:xe});dg.jumpToEnd()})},Rc["[broadcast] leave room"]=function(R,ia,Fa,ub){var bc=ia.sender,Sc=ia.data.room,be,xe,Yd,Bf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(dg){if(1==dg.nextAddress)return xe=
!1,Yd=R.io.nsps["/"+R.namespace].adapter.rooms,Bf=Yd[Sc]&&Yd[Sc].sockets&&Yd[Sc].sockets[ub.id],Bf?dg.yield(new Promise(function(ki,ij){return ub.leave(Sc,function(gk){return gk?ij(gk):ki()})}),3):(be=bc+" not in "+Sc,dg.jumpTo(2));2!=dg.nextAddress&&(be=bc+" left room "+Sc,xe=!0);console.log(be);Fa&&"function"===typeof Fa&&Fa({left:xe,status:be});dg.jumpToEnd()})},Rc["[broadcast] my rooms"]=function(R,ia,Fa,ub){Fa(ub.rooms)},Rc["[broadcast] all rooms"]=function(R,ia,Fa,ub){Fa(R.io.nsps["/"+R.namespace].adapter.rooms)},
Rc["[broadcast] list room members"]=function(R,ia,Fa,ub){ia=ia.data.room;ub=R.io;ia?(R=ub.nsps["/"+R.namespace].adapter.rooms[ia],Fa({room:ia,sockets:R?R.sockets:{},length:R?R.length:0})):Fa({isError:!0,error:"`room` paramerter missing!"})},Rc.getClients=function(R,ia,Fa){R.removeDisconnectedClients();Fa(Array.from(R.clients))},Rc);ed.defaultTrackerActions=pb;ed.defaultTrackerActions=pb;ed.defaultTrackerActions=pb;var bd={},od=(bd.getRoomList=function(R){var ia=R.client,Fa=R.ackFn,ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bc){ub=
ia._socketioClient.rooms;Fa(ub);bc.jumpToEnd()})},bd["ask for"]=function(R,ia,Fa,ub){var bc=ia.sender,Sc=ia.data.query,be=this,xe,Yd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bf){if(1==Bf.nextAddress)return xe=Sc.match(/password|sudo/i)?"passwordPrompt":"prompt",Bf.yield($world[xe](Sc),2);Yd=Bf.yieldResult;"function"===typeof Fa&&Fa({answer:Yd});R.debug&&console.log("["+be+"] message 'ask for' from "+bc+", query: "+Sc);Bf.jumpToEnd()})},bd["open editor"]=function(R,ia,Fa,ub){var bc=
ia.data.args,Sc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(be){if(1==be.nextAddress)return bc.length?be.yield($world.execCommand("open file for EDITOR",{url:bc[0]}),2):(Fa({error:"no file specified"}),be.return());Sc=be.yieldResult;"function"===typeof Fa&&Fa("aborted"===Sc?{error:String(Sc)}:{status:Sc});be.jumpToEnd()})},bd.changeWorkingDirectory=function(R,ia,Fa,ub){var bc=ia.data.args,Sc,be,xe,Yd,Bf,dg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ki){Sc=$jscomp.makeIterator(bc||
[]);be=Sc.next().value;xe=Sc.next().value;Yd="OK";try{if(be)if(xe){if(Bf=$world.getMorphWithId(xe))if(Bf.__lookupSetter__("cwd"))Bf.cwd=be;else if("function"===typeof Bf.changeWorkingDirectory)Bf.changeWorkingDirectory(be);else if("function"===typeof Bf.pluginFind){if(dg=Bf.pluginFind(function(ij){return ij.isShellEditorPlugin}))dg.cwd=be}else Yd="[changeWorkingDirectory] cannot figure pout how to set dir"}else Yd="[changeWorkingDirectory] No command morph";else Yd="[changeWorkingDirectory] No directory received"}catch(ij){Yd=
String(ij)}"OK"!==Yd&&console.warn(Yd);"function"===typeof Fa&&Fa(Yd);ki.jumpToEnd()})},bd);ed.defaultClientActions=od;ed.defaultClientActions=od;ed.defaultClientActions=od;var lb={},Sa=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,qc="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),
le=lb=function(R){var ia=R,Fa=R.indexOf("["),ub=R.indexOf("]");-1!=Fa&&-1!=ub&&(R=R.substring(0,Fa)+R.substring(Fa,ub).replace(/:/g,";")+R.substring(ub,R.length));var bc=Sa.exec(R||"");R={};for(var Sc=14;Sc--;)R[qc[Sc]]=bc[Sc]||"";-1!=Fa&&-1!=ub&&(R.source=ia,R.host=R.host.substring(1,R.host.length-1).replace(/;/g,":"),R.authority=R.authority.replace("[","").replace("]","").replace(/;/g,":"),R.ipv6uri=!0);ia=R.path;Fa=ia.replace(/\/{2,9}/g,"/").split("/");"/"!=ia.substr(0,1)&&0!==ia.length||Fa.splice(0,
1);"/"==ia.substr(ia.length-1,1)&&Fa.splice(Fa.length-1,1);R.pathNames=Fa;R.queryKey=Lc(R,R.query);return R},Zd={},Fe=864E5,Oc=365.25*Fe,te=Zd=function(R,ia){ia=ia||{};var Fa=typeof R;if("string"===Fa&&0<R.length)return rd(R);if("number"===Fa&&!1===isNaN(R))return ia.long?Gd(R,Fe,"day")||Gd(R,36E5,"hour")||Gd(R,6E4,"minute")||Gd(R,1E3,"second")||R+" ms":R>=Fe?Math.round(R/Fe)+"d":36E5<=R?Math.round(R/36E5)+"h":6E4<=R?Math.round(R/6E4)+"m":1E3<=R?Math.round(R/1E3)+"s":R+"ms";throw Error("val is not a non-empty string or a valid number. val="+
JSON.stringify(R));},md="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Eb={};Eb=Eb=Kd.debug=Kd["default"]=Kd;Eb.coerce=function(R){return R instanceof Error?R.stack||R.message:R};Eb.disable=function(){Eb.enable("")};Eb.enable=function(R){Eb.save(R);Eb.names=[];Eb.skips=[];var ia,Fa=("string"===typeof R?R:"").split(/[\s,]+/),ub=Fa.length;for(ia=0;ia<ub;ia++)Fa[ia]&&(R=Fa[ia].replace(/\*/g,".*?"),"-"===R[0]?Eb.skips.push(new RegExp("^"+R.substr(1)+"$")):Eb.names.push(new RegExp("^"+
R+"$")));for(ia=0;ia<Eb.instances.length;ia++)R=Eb.instances[ia],R.enabled=Eb.enabled(R.namespace)};Eb.enabled=function(R){if("*"===R[R.length-1])return!0;var ia;var Fa=0;for(ia=Eb.skips.length;Fa<ia;Fa++)if(Eb.skips[Fa].test(R))return!1;Fa=0;for(ia=Eb.names.length;Fa<ia;Fa++)if(Eb.names[Fa].test(R))return!0;return!1};Eb.humanize=te;Eb.instances=[];Eb.names=[];Eb.skips=[];Eb.formatters={};var xa="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Ca={},Mb=dc;Ca=Ca=Eb;
Ca.log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};Ca.formatArgs=function(R){var ia=(this||xa).useColors;R[0]=(ia?"%c":"")+(this||xa).namespace+(ia?" %c":" ")+R[0]+(ia?"%c ":" ")+"+"+Ca.humanize((this||xa).diff);if(ia){ia="color: "+(this||xa).color;R.splice(1,0,ia,"color: inherit");var Fa=0,ub=0;R[0].replace(/%[a-zA-Z%]/g,function(bc){"%%"!==bc&&(Fa++,"%c"===bc&&(ub=Fa))});R.splice(ub,0,ia)}};Ca.save=function(R){try{null==
R?Ca.storage.removeItem("debug"):Ca.storage.debug=R}catch(ia){}};Ca.load=fb;Ca.useColors=function(){return"undefined"!==typeof window&&window.process&&"renderer"===window.process.type?!0:"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||
window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var P=Ca;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)var za=chrome.storage.local;else a:{try{za=window.localStorage;break a}catch(R){}za=void 0}P.storage=za;Ca.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
Ca.formatters.j=function(R){try{return JSON.stringify(R)}catch(ia){return"[UnexpectedJSONParseError]: "+ia.message}};Ca.enable(fb());var Ta=Ca,Fb="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Cc={};Cc=Db;Db.prototype.on=Db.prototype.addEventListener=function(R,ia){(this||Fb)._callbacks=(this||Fb)._callbacks||{};((this||Fb)._callbacks["$"+R]=(this||Fb)._callbacks["$"+R]||[]).push(ia);return this||Fb};Db.prototype.once=function(R,ia){function Fa(){this.off(R,Fa);ia.apply(this||
Fb,arguments)}Fa.fn=ia;this.on(R,Fa);return this||Fb};Db.prototype.off=Db.prototype.removeListener=Db.prototype.removeAllListeners=Db.prototype.removeEventListener=function(R,ia){(this||Fb)._callbacks=(this||Fb)._callbacks||{};if(0==arguments.length)return(this||Fb)._callbacks={},this||Fb;var Fa=(this||Fb)._callbacks["$"+R];if(!Fa)return this||Fb;if(1==arguments.length)return delete (this||Fb)._callbacks["$"+R],this||Fb;for(var ub,bc=0;bc<Fa.length;bc++)if(ub=Fa[bc],ub===ia||ub.fn===ia){Fa.splice(bc,
1);break}0===Fa.length&&delete (this||Fb)._callbacks["$"+R];return this||Fb};Db.prototype.emit=function(R){(this||Fb)._callbacks=(this||Fb)._callbacks||{};for(var ia=Array(arguments.length-1),Fa=(this||Fb)._callbacks["$"+R],ub=1;ub<arguments.length;ub++)ia[ub-1]=arguments[ub];if(Fa){Fa=Fa.slice(0);ub=0;for(var bc=Fa.length;ub<bc;++ub)Fa[ub].apply(this||Fb,ia)}return this||Fb};Db.prototype.listeners=function(R){(this||Fb)._callbacks=(this||Fb)._callbacks||{};return(this||Fb)._callbacks["$"+R]||[]};
Db.prototype.hasListeners=function(R){return!!this.listeners(R).length};var Uc=Cc,he={},we={}.toString,nf=he=Array.isArray||function(R){return"[object Array]"==we.call(R)},yd={},Ce=Xb.Buffer;yd=function(R){var ia;!(ia=wf&&Ce.isBuffer(R))&&(ia=Ie)&&((ia=R instanceof ArrayBuffer)||(ia="function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(R):R.buffer instanceof ArrayBuffer));return ia};var wf="function"===typeof Ce&&"function"===typeof Ce.isBuffer,Ie="function"===typeof ArrayBuffer,Fg=yd,Rf="undefined"!==
typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Jc={},of=nf,pg=Fg,qg=Object.prototype.toString,ff="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===qg.call(Blob),Ja="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===qg.call(File);Jc.deconstructPacket=function(R){var ia=[];R.data=mc(R.data,ia);R.attachments=ia.length;return{packet:R,buffers:ia}};Jc.reconstructPacket=function(R,ia){R.data=hc(R.data,ia);R.attachments=void 0;
return R};Jc.removeBlobs=function(R,ia){function Fa(Sc,be,xe){if(!Sc)return Sc;if(ff&&Sc instanceof Blob||Ja&&Sc instanceof File){ub++;var Yd=new FileReader;Yd.onload=function(){xe?xe[be]=(this||Rf).result:bc=(this||Rf).result;--ub||ia(bc)};Yd.readAsArrayBuffer(Sc)}else if(of(Sc))for(Yd=0;Yd<Sc.length;Yd++)Fa(Sc[Yd],Yd,Sc);else if("object"===typeof Sc&&!pg(Sc))for(Yd in Sc)Fa(Sc[Yd],Yd,Sc)}var ub=0,bc=R;Fa(bc);ub||ia(bc)};var $a="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?
self:global,Bb={},ba=Ta("socket.io-parser"),Ia=Jc;Bb.protocol=4;Bb.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" ");Bb.CONNECT=0;Bb.DISCONNECT=1;Bb.EVENT=2;Bb.ACK=3;Bb.ERROR=4;Bb.BINARY_EVENT=5;Bb.BINARY_ACK=6;Bb.Encoder=Tc;Bb.Decoder=pc;var nb=Bb.ERROR+'"encode error"';Tc.prototype.encode=function(R,ia){ba("encoding packet %j",R);Bb.BINARY_EVENT===R.type||Bb.BINARY_ACK===R.type?oc(R,ia):(R=Ld(R),ia([R]))};Uc(pc.prototype);pc.prototype.add=function(R){if("string"===typeof R){a:{var ia=
0,Fa={type:Number(R.charAt(0))};if(null==Bb.types[Fa.type])R={type:Bb.ERROR,data:"parser error: unknown packet type "+Fa.type};else{if(Bb.BINARY_EVENT===Fa.type||Bb.BINARY_ACK===Fa.type){for(var ub="";"-"!==R.charAt(++ia)&&(ub+=R.charAt(ia),ia!=R.length););if(ub!=Number(ub)||"-"!==R.charAt(ia))throw Error("Illegal attachments");Fa.attachments=Number(ub)}if("/"===R.charAt(ia+1))for(Fa.nsp="";++ia;){ub=R.charAt(ia);if(","===ub)break;Fa.nsp+=ub;if(ia===R.length)break}else Fa.nsp="/";ub=R.charAt(ia+1);
if(""!==ub&&Number(ub)==ub){for(Fa.id="";++ia;){ub=R.charAt(ia);if(null==ub||Number(ub)!=ub){--ia;break}Fa.id+=R.charAt(ia);if(ia===R.length)break}Fa.id=Number(Fa.id)}if(R.charAt(++ia)){ia=R.substr(ia);try{var bc=JSON.parse(ia)}catch(Sc){bc=!1}if(!1===bc||Fa.type!==Bb.ERROR&&!nf(bc)){R={type:Bb.ERROR,data:"parser error: invalid payload"};break a}else Fa.data=bc}ba("decoded %s as %j",R,Fa);R=Fa}}Bb.BINARY_EVENT===R.type||Bb.BINARY_ACK===R.type?((this||$a).reconstructor=new Nb(R),0===(this||$a).reconstructor.reconPack.attachments&&
this.emit("decoded",R)):this.emit("decoded",R)}else if(Fg(R)||R.base64)if((this||$a).reconstructor){if(R=(this||$a).reconstructor.takeBinaryData(R))(this||$a).reconstructor=null,this.emit("decoded",R)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+R);};pc.prototype.destroy=function(){(this||$a).reconstructor&&(this||$a).reconstructor.finishedReconstruction()};Nb.prototype.takeBinaryData=function(R){(this||$a).buffers.push(R);return(this||$a).buffers.length===
(this||$a).reconPack.attachments?(R=Ia.reconstructPacket((this||$a).reconPack,(this||$a).buffers),this.finishedReconstruction(),R):null};Nb.prototype.finishedReconstruction=function(){(this||$a).reconPack=null;(this||$a).buffers=[]};var zb={};try{zb="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(R){zb=!1}var Ec=zb,Gc={},qd=Gc="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")(),sd={},vd=sd=function(R){var ia=R.xdomain,Fa=R.xscheme;
R=R.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!ia||Ec))return new XMLHttpRequest}catch(ub){}try{if("undefined"!==typeof XDomainRequest&&!Fa&&R)return new XDomainRequest}catch(ub){}if(!ia)try{return new (qd[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(ub){}},Cf={},yg=Xb.Buffer,fg=nf,xf=Object.prototype.toString,ri="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===xf.call(Blob),Lh="function"===typeof File||"undefined"!==typeof File&&
"[object FileConstructor]"===xf.call(File),Aj=Cf=Dc,Zh={},qk=Zh=function(R,ia,Fa){var ub=R.byteLength;ia=ia||0;Fa=Fa||ub;if(R.slice)return R.slice(ia,Fa);0>ia&&(ia+=ub);0>Fa&&(Fa+=ub);Fa>ub&&(Fa=ub);if(ia>=ub||ia>=Fa||0===ub)return new ArrayBuffer(0);R=new Uint8Array(R);ub=new Uint8Array(Fa-ia);for(var bc=0;ia<Fa;ia++,bc++)ub[bc]=R[ia];return ub.buffer},Gg={},fk=Gg=function(R,ia,Fa){function ub(Sc,be){if(0>=ub.count)throw Error("after called too many times");--ub.count;Sc?(bc=!0,ia(Sc),ia=Fa):0!==
ub.count||bc||ia(null,be)}var bc=!1;Fa=Fa||Vc;ub.count=R;return 0===R?ia():ub},Hi={};(function(R){Hi.encode=function(ia){ia=new Uint8Array(ia);var Fa,ub=ia.length,bc="";for(Fa=0;Fa<ub;Fa+=3)bc+=R[ia[Fa]>>2],bc+=R[(ia[Fa]&3)<<4|ia[Fa+1]>>4],bc+=R[(ia[Fa+1]&15)<<2|ia[Fa+2]>>6],bc+=R[ia[Fa+2]&63];2===ub%3?bc=bc.substring(0,bc.length-1)+"=":1===ub%3&&(bc=bc.substring(0,bc.length-2)+"==");return bc};Hi.decode=function(ia){var Fa=.75*ia.length,ub=ia.length,bc=0;"="===ia[ia.length-1]&&(Fa--,"="===ia[ia.length-
2]&&Fa--);var Sc=new ArrayBuffer(Fa),be=new Uint8Array(Sc);for(Fa=0;Fa<ub;Fa+=4){var xe=R.indexOf(ia[Fa]);var Yd=R.indexOf(ia[Fa+1]);var Bf=R.indexOf(ia[Fa+2]);var dg=R.indexOf(ia[Fa+3]);be[bc++]=xe<<2|Yd>>4;be[bc++]=(Yd&15)<<4|Bf>>2;be[bc++]=(Bf&3)<<6|dg&63}return Sc}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");var dk={},rj="undefined"!==typeof rj?rj:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?
MozBlobBuilder:!1;try{var rl=2===(new Blob(["hi"])).size}catch(R){rl=!1}var Al;if(Al=rl)try{Al=2===(new Blob([new Uint8Array([1,2])])).size}catch(R){Al=!1}var mm=Al,Uk=rj&&rj.prototype.append&&rj.prototype.getBlob;"undefined"!==typeof Blob&&(Id.prototype=Blob.prototype,rb.prototype=Blob.prototype);dk=rl?mm?Blob:rb:Uk?Id:void 0;var qi=dk,ek={},gn=ek=Object.keys||function(R){var ia=[],Fa=Object.prototype.hasOwnProperty,ub;for(ub in R)Fa.call(R,ub)&&ia.push(ub);return ia},Nf={},Wk=String.fromCharCode,
Ub,td,ue;Nf={version:"2.1.2",encode:function(R,ia){ia=ia||{};ia=!1!==ia.strict;R=Hb(R);for(var Fa=R.length,ub=-1,bc,Sc="";++ub<Fa;){bc=R[ub];var be=ia;if(0==(bc&4294967168))bc=Wk(bc);else{var xe="";0==(bc&4294965248)?xe=Wk(bc>>6&31|192):0==(bc&4294901760)?(Mc(bc,be)||(bc=65533),xe=Wk(bc>>12&15|224),xe+=Wk(bc>>6&63|128)):0==(bc&4292870144)&&(xe=Wk(bc>>18&7|240),xe+=Wk(bc>>12&63|128),xe+=Wk(bc>>6&63|128));bc=xe+=Wk(bc&63|128)}Sc+=bc}return Sc},decode:function(R,ia){ia=ia||{};ia=!1!==ia.strict;Ub=Hb(R);
td=Ub.length;ue=0;R=[];for(var Fa;!1!==(Fa=tb(ia));)R.push(Fa);ia=R.length;Fa=-1;for(var ub,bc="";++Fa<ia;)ub=R[Fa],65535<ub&&(ub-=65536,bc+=Wk(ub>>>10&1023|55296),ub=56320|ub&1023),bc+=Wk(ub);return bc}};var Ud={},pd=fk,Ig=Nf,Ij;"undefined"!==typeof ArrayBuffer&&(Ij=Hi);var $l="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),Lq="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),Yp=$l||Lq;Ud.protocol=3;var nm=Ud.packets={open:0,close:1,ping:2,pong:3,message:4,
upgrade:5,noop:6},Gn=gn(nm),Ok={type:"error",data:"parser error"};Ud.encodePacket=function(R,ia,Fa,ub){"function"===typeof ia&&(ub=ia,ia=!1);"function"===typeof Fa&&(ub=Fa,Fa=null);var bc=void 0===R.data?void 0:R.data.buffer||R.data;if("undefined"!==typeof ArrayBuffer&&bc instanceof ArrayBuffer){if(ia){Fa=R.data;ia=new Uint8Array(Fa);Fa=new Uint8Array(1+Fa.byteLength);Fa[0]=nm[R.type];for(R=0;R<ia.length;R++)Fa[R+1]=ia[R];R=ub(Fa.buffer)}else R=Ud.encodeBase64Packet(R,ub);return R}if("undefined"!==
typeof qi&&bc instanceof qi)return ia?Yp?R=eb(R,ia,ub):(ia=new Uint8Array(1),ia[0]=nm[R.type],R=new qi([ia.buffer,R.data]),R=ub(R)):R=Ud.encodeBase64Packet(R,ub),R;if(bc&&bc.base64)return ub("b"+Ud.packets[R.type]+R.data.data);ia=nm[R.type];void 0!==R.data&&(ia+=Fa?Ig.encode(String(R.data),{strict:!1}):String(R.data));return ub(""+ia)};Ud.encodeBase64Packet=function(R,ia){var Fa="b"+Ud.packets[R.type];if("undefined"!==typeof qi&&R.data instanceof qi){var ub=new FileReader;ub.onload=function(){var be=
ub.result.split(",")[1];ia(Fa+be)};return ub.readAsDataURL(R.data)}try{var bc=String.fromCharCode.apply(null,new Uint8Array(R.data))}catch(be){R=new Uint8Array(R.data);bc=Array(R.length);for(var Sc=0;Sc<R.length;Sc++)bc[Sc]=R[Sc];bc=String.fromCharCode.apply(null,bc)}Fa+=btoa(bc);return ia(Fa)};Ud.decodePacket=function(R,ia,Fa){if(void 0===R)return Ok;if("string"===typeof R){if("b"===R.charAt(0))return Ud.decodeBase64Packet(R.substr(1),ia);if(Fa){a:{ia=R;try{ia=Ig.decode(ia,{strict:!1})}catch(ub){R=
!1;break a}R=ia}if(!1===R)return Ok}Fa=R.charAt(0);return Number(Fa)==Fa&&Gn[Fa]?1<R.length?{type:Gn[Fa],data:R.substring(1)}:{type:Gn[Fa]}:Ok}Fa=(new Uint8Array(R))[0];R=qk(R,1);qi&&"blob"===ia&&(R=new qi([R]));return{type:Gn[Fa],data:R}};Ud.decodeBase64Packet=function(R,ia){var Fa=Gn[R.charAt(0)];if(!Ij)return{type:Fa,data:{base64:!0,data:R.substr(1)}};R=Ij.decode(R.substr(1));"blob"===ia&&qi&&(R=new qi([R]));return{type:Fa,data:R}};Ud.encodePayload=function(R,ia,Fa){"function"===typeof ia&&(Fa=
ia,ia=null);var ub=Aj(R);if(ia&&ub)return qi&&!Yp?Ud.encodePayloadAsBlob(R,Fa):Ud.encodePayloadAsArrayBuffer(R,Fa);if(!R.length)return Fa("0:");ob(R,function(bc,Sc){Ud.encodePacket(bc,ub?ia:!1,!1,function(be){Sc(null,be.length+":"+be)})},function(bc,Sc){return Fa(Sc.join(""))})};Ud.decodePayload=function(R,ia,Fa){if("string"!==typeof R)return Ud.decodePayloadAsBinary(R,ia,Fa);"function"===typeof ia&&(Fa=ia,ia=null);if(""===R)return Fa(Ok,0,1);var ub="";for(var bc,Sc,be=0,xe=R.length;be<xe;be++)if(Sc=
R.charAt(be),":"!==Sc)ub+=Sc;else{if(""===ub||ub!=(bc=Number(ub)))return Fa(Ok,0,1);Sc=R.substr(be+1,bc);if(ub!=Sc.length)return Fa(Ok,0,1);if(Sc.length){ub=Ud.decodePacket(Sc,ia,!1);if(Ok.type===ub.type&&Ok.data===ub.data)return Fa(Ok,0,1);if(!1===Fa(ub,be+bc,xe))return}be+=bc;ub=""}if(""!==ub)return Fa(Ok,0,1)};Ud.encodePayloadAsArrayBuffer=function(R,ia){if(!R.length)return ia(new ArrayBuffer(0));ob(R,function(Fa,ub){Ud.encodePacket(Fa,!0,!0,function(bc){return ub(null,bc)})},function(Fa,ub){Fa=
ub.reduce(function(be,xe){xe="string"===typeof xe?xe.length:xe.byteLength;return be+xe.toString().length+xe+2},0);var bc=new Uint8Array(Fa),Sc=0;ub.forEach(function(be){var xe="string"===typeof be,Yd=be;if(xe){Yd=new Uint8Array(be.length);for(var Bf=0;Bf<be.length;Bf++)Yd[Bf]=be.charCodeAt(Bf);Yd=Yd.buffer}xe?bc[Sc++]=0:bc[Sc++]=1;be=Yd.byteLength.toString();for(Bf=0;Bf<be.length;Bf++)bc[Sc++]=parseInt(be[Bf]);bc[Sc++]=255;Yd=new Uint8Array(Yd);for(Bf=0;Bf<Yd.length;Bf++)bc[Sc++]=Yd[Bf]});return ia(bc.buffer)})};
Ud.encodePayloadAsBlob=function(R,ia){ob(R,function(Fa,ub){Ud.encodePacket(Fa,!0,!0,function(bc){var Sc=new Uint8Array(1);Sc[0]=1;if("string"===typeof bc){for(var be=new Uint8Array(bc.length),xe=0;xe<bc.length;xe++)be[xe]=bc.charCodeAt(xe);bc=be.buffer;Sc[0]=0}be=(bc instanceof ArrayBuffer?bc.byteLength:bc.size).toString();var Yd=new Uint8Array(be.length+1);for(xe=0;xe<be.length;xe++)Yd[xe]=parseInt(be[xe]);Yd[be.length]=255;qi&&(bc=new qi([Sc.buffer,Yd.buffer,bc]),ub(null,bc))})},function(Fa,ub){return ia(new qi(ub))})};
Ud.decodePayloadAsBinary=function(R,ia,Fa){"function"===typeof ia&&(Fa=ia,ia=null);for(var ub=[];0<R.byteLength;){for(var bc=new Uint8Array(R),Sc=0===bc[0],be="",xe=1;255!==bc[xe];xe++){if(310<be.length)return Fa(Ok,0,1);be+=bc[xe]}R=qk(R,2+be.length);be=parseInt(be);bc=qk(R,0,be);if(Sc)try{bc=String.fromCharCode.apply(null,new Uint8Array(bc))}catch(Bf){for(Sc=new Uint8Array(bc),bc="",xe=0;xe<Sc.length;xe++)bc+=String.fromCharCode(Sc[xe])}ub.push(bc);R=qk(R,be)}var Yd=ub.length;ub.forEach(function(Bf,
dg){Fa(Ud.decodePacket(Bf,ia,!0),dg,Yd)})};for(var om={encode:function(R){var ia="",Fa;for(Fa in R)R.hasOwnProperty(Fa)&&(ia.length&&(ia+="&"),ia+=encodeURIComponent(Fa)+"="+encodeURIComponent(R[Fa]));return ia},decode:function(R){var ia={};R=R.split("&");for(var Fa=0,ub=R.length;Fa<ub;Fa++){var bc=R[Fa].split("=");ia[decodeURIComponent(bc[0])]=decodeURIComponent(bc[1])}return ia}},pk={},dn=pk=function(R,ia){var Fa=function(){};Fa.prototype=ia.prototype;R.prototype=new Fa;R.prototype.constructor=
R},po={},oo="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),cn={},Cm=0,Pk=0,Hn;64>Pk;Pk++)cn[oo[Pk]]=Pk;cb.encode=wb;cb.decode=function(R){var ia=0;for(Pk=0;Pk<R.length;Pk++)ia=64*ia+cn[R.charAt(Pk)];return ia};var Dm=po=cb,ug="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,sl={},pm=Ud;sl=Oa;Uc(Oa.prototype);Oa.prototype.onError=function(R,ia){R=Error(R);R.type="TransportError";R.description=ia;this.emit("error",R);return this||ug};Oa.prototype.open=
function(){if("closed"===(this||ug).readyState||""===(this||ug).readyState)(this||ug).readyState="opening",this.doOpen();return this||ug};Oa.prototype.close=function(){if("opening"===(this||ug).readyState||"open"===(this||ug).readyState)this.doClose(),this.onClose();return this||ug};Oa.prototype.send=function(R){if("open"===(this||ug).readyState)this.write(R);else throw Error("Transport not open");};Oa.prototype.onOpen=function(){(this||ug).readyState="open";(this||ug).writable=!0;this.emit("open")};
Oa.prototype.onData=function(R){R=pm.decodePacket(R,(this||ug).socket.binaryType);this.onPacket(R)};Oa.prototype.onPacket=function(R){this.emit("packet",R)};Oa.prototype.onClose=function(){(this||ug).readyState="closed";this.emit("close")};var Em=sl,ih="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,qo={},ji=Em,Zj=Ud,Bi=Ta("engine.io-client:polling");qo=Gb;var Bl=null!=(new vd({xdomain:!1})).responseType;dn(Gb,ji);Gb.prototype.name="polling";Gb.prototype.doOpen=function(){this.poll()};
Gb.prototype.pause=function(R){function ia(){Bi("paused");Fa.readyState="paused";R()}var Fa=this||ih;(this||ih).readyState="pausing";if((this||ih).polling||!(this||ih).writable){var ub=0;(this||ih).polling&&(Bi("we are currently polling - waiting to pause"),ub++,this.once("pollComplete",function(){Bi("pre-pause polling complete");--ub||ia()}));(this||ih).writable||(Bi("we are currently writing - waiting to pause"),ub++,this.once("drain",function(){Bi("pre-pause writing complete");--ub||ia()}))}else ia()};
Gb.prototype.poll=function(){Bi("polling");(this||ih).polling=!0;this.doPoll();this.emit("poll")};Gb.prototype.onData=function(R){var ia=this||ih;Bi("polling got data %s",R);Zj.decodePayload(R,(this||ih).socket.binaryType,function(Fa,ub,bc){if("opening"===ia.readyState)ia.onOpen();if("close"===Fa.type)return ia.onClose(),!1;ia.onPacket(Fa)});"closed"!==(this||ih).readyState&&((this||ih).polling=!1,this.emit("pollComplete"),"open"===(this||ih).readyState?this.poll():Bi('ignoring poll - transport state "%s"',
(this||ih).readyState))};Gb.prototype.doClose=function(){function R(){Bi("writing close packet");ia.write([{type:"close"}])}var ia=this||ih;"open"===(this||ih).readyState?(Bi("transport open - closing"),R()):(Bi("transport not open - deferring close"),this.once("open",R))};Gb.prototype.write=function(R){var ia=this||ih;(this||ih).writable=!1;var Fa=function(){ia.writable=!0;ia.emit("drain")};Zj.encodePayload(R,(this||ih).supportsBinary,function(ub){ia.doWrite(ub,Fa)})};Gb.prototype.uri=function(){var R=
(this||ih).query||{},ia=(this||ih).secure?"https":"http",Fa="";!1!==(this||ih).timestampRequests&&(R[(this||ih).timestampParam]=Dm());(this||ih).supportsBinary||R.sid||(R.b64=1);R=om.encode(R);(this||ih).port&&("https"===ia&&443!==Number((this||ih).port)||"http"===ia&&80!==Number((this||ih).port))&&(Fa=":"+(this||ih).port);R.length&&(R="?"+R);var ub=-1!==(this||ih).hostname.indexOf(":");return ia+"://"+(ub?"["+(this||ih).hostname+"]":(this||ih).hostname)+Fa+(this||ih).path+R};var Fm=qo,Qe="undefined"!==
typeof globalThis?globalThis:"undefined"!==typeof self?self:global,fn={},Qo=Fm,qm=Ta("engine.io-client:polling-xhr");fn=vc;fn.Request=fc;dn(vc,Qo);vc.prototype.supportsBinary=!0;vc.prototype.request=function(R){R=R||{};R.uri=this.uri();R.xd=(this||Qe).xd;R.xs=(this||Qe).xs;R.agent=(this||Qe).agent||!1;R.supportsBinary=(this||Qe).supportsBinary;R.enablesXDR=(this||Qe).enablesXDR;R.withCredentials=(this||Qe).withCredentials;R.pfx=(this||Qe).pfx;R.key=(this||Qe).key;R.passphrase=(this||Qe).passphrase;
R.cert=(this||Qe).cert;R.ca=(this||Qe).ca;R.ciphers=(this||Qe).ciphers;R.rejectUnauthorized=(this||Qe).rejectUnauthorized;R.requestTimeout=(this||Qe).requestTimeout;R.extraHeaders=(this||Qe).extraHeaders;return new fc(R)};vc.prototype.doWrite=function(R,ia){R=this.request({method:"POST",data:R,isBinary:"string"!==typeof R&&void 0!==R});var Fa=this||Qe;R.on("success",ia);R.on("error",function(ub){Fa.onError("xhr post error",ub)});(this||Qe).sendXhr=R};vc.prototype.doPoll=function(){qm("xhr poll");
var R=this.request(),ia=this||Qe;R.on("data",function(Fa){ia.onData(Fa)});R.on("error",function(Fa){ia.onError("xhr poll error",Fa)});(this||Qe).pollXhr=R};Uc(fc.prototype);fc.prototype.create=function(){var R={agent:(this||Qe).agent,xdomain:(this||Qe).xd,xscheme:(this||Qe).xs,enablesXDR:(this||Qe).enablesXDR};R.pfx=(this||Qe).pfx;R.key=(this||Qe).key;R.passphrase=(this||Qe).passphrase;R.cert=(this||Qe).cert;R.ca=(this||Qe).ca;R.ciphers=(this||Qe).ciphers;R.rejectUnauthorized=(this||Qe).rejectUnauthorized;
var ia=(this||Qe).xhr=new vd(R),Fa=this||Qe;try{qm("xhr open %s: %s",(this||Qe).method,(this||Qe).uri);ia.open((this||Qe).method,(this||Qe).uri,(this||Qe).async);try{if((this||Qe).extraHeaders){ia.setDisableHeaderCheck&&ia.setDisableHeaderCheck(!0);for(var ub in(this||Qe).extraHeaders)(this||Qe).extraHeaders.hasOwnProperty(ub)&&ia.setRequestHeader(ub,(this||Qe).extraHeaders[ub])}}catch(bc){}if("POST"===(this||Qe).method)try{(this||Qe).isBinary?ia.setRequestHeader("Content-type","application/octet-stream"):
ia.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(bc){}try{ia.setRequestHeader("Accept","*/*")}catch(bc){}"withCredentials"in ia&&(ia.withCredentials=(this||Qe).withCredentials);(this||Qe).requestTimeout&&(ia.timeout=(this||Qe).requestTimeout);this.hasXDR()?(ia.onload=function(){Fa.onLoad()},ia.onerror=function(){Fa.onError(ia.responseText)}):ia.onreadystatechange=function(){if(2===ia.readyState)try{var bc=ia.getResponseHeader("Content-Type");if(Fa.supportsBinary&&"application/octet-stream"===
bc||"application/octet-stream; charset=UTF-8"===bc)ia.responseType="arraybuffer"}catch(Sc){}if(4===ia.readyState)if(200===ia.status||1223===ia.status)Fa.onLoad();else setTimeout(function(){Fa.onError("number"===typeof ia.status?ia.status:0)},0)};qm("xhr data %s",(this||Qe).data);ia.send((this||Qe).data)}catch(bc){setTimeout(function(){Fa.onError(bc)},0);return}"undefined"!==typeof document&&((this||Qe).index=fc.requestsCount++,fc.requests[(this||Qe).index]=this||Qe)};fc.prototype.onSuccess=function(){this.emit("success");
this.cleanup()};fc.prototype.onData=function(R){this.emit("data",R);this.onSuccess()};fc.prototype.onError=function(R){this.emit("error",R);this.cleanup(!0)};fc.prototype.cleanup=function(R){if("undefined"!==typeof(this||Qe).xhr&&null!==(this||Qe).xhr){this.hasXDR()?(this||Qe).xhr.onload=(this||Qe).xhr.onerror=sc:(this||Qe).xhr.onreadystatechange=sc;if(R)try{(this||Qe).xhr.abort()}catch(ia){}"undefined"!==typeof document&&delete fc.requests[(this||Qe).index];(this||Qe).xhr=null}};fc.prototype.onLoad=
function(){try{try{var R=(this||Qe).xhr.getResponseHeader("Content-Type")}catch(Fa){}var ia="application/octet-stream"===R||"application/octet-stream; charset=UTF-8"===R?(this||Qe).xhr.response||(this||Qe).xhr.responseText:(this||Qe).xhr.responseText}catch(Fa){this.onError(Fa)}if(null!=ia)this.onData(ia)};fc.prototype.hasXDR=function(){return"undefined"!==typeof XDomainRequest&&!(this||Qe).xs&&(this||Qe).enablesXDR};fc.prototype.abort=function(){this.cleanup()};fc.requestsCount=0;fc.requests={};"undefined"!==
typeof document&&("function"===typeof attachEvent?attachEvent("onunload",rc):"function"===typeof addEventListener&&addEventListener("onpagehide"in qd?"pagehide":"unload",rc,!1));var qp=fn,ro={},Nl=[].indexOf,so=ro=function(R,ia){if(Nl)return R.indexOf(ia);for(var Fa=0;Fa<R.length;++Fa)if(R[Fa]===ia)return Fa;return-1},yh="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,rp={},In=Fm,Ro=qd;rp=ha;var bn=/\n/g,am=/\\n/g,Ol;dn(ha,In);ha.prototype.supportsBinary=!1;ha.prototype.doClose=
function(){(this||yh).script&&((this||yh).script.parentNode.removeChild((this||yh).script),(this||yh).script=null);(this||yh).form&&((this||yh).form.parentNode.removeChild((this||yh).form),(this||yh).form=null,(this||yh).iframe=null);In.prototype.doClose.call(this||yh)};ha.prototype.doPoll=function(){var R=this||yh,ia=document.createElement("script");(this||yh).script&&((this||yh).script.parentNode.removeChild((this||yh).script),(this||yh).script=null);ia.async=!0;ia.src=this.uri();ia.onerror=function(ub){R.onError("jsonp poll error",
ub)};var Fa=document.getElementsByTagName("script")[0];Fa?Fa.parentNode.insertBefore(ia,Fa):(document.head||document.body).appendChild(ia);(this||yh).script=ia;"undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var ub=document.createElement("iframe");document.body.appendChild(ub);document.body.removeChild(ub)},100)};ha.prototype.doWrite=function(R,ia){function Fa(){ub();ia()}function ub(){if(bc.iframe)try{bc.form.removeChild(bc.iframe)}catch(Bf){bc.onError("jsonp polling iframe removal error",
Bf)}try{Yd=document.createElement('<iframe src="javascript:0" name="'+bc.iframeId+'">')}catch(Bf){Yd=document.createElement("iframe"),Yd.name=bc.iframeId,Yd.src="javascript:0"}Yd.id=bc.iframeId;bc.form.appendChild(Yd);bc.iframe=Yd}var bc=this||yh;if(!(this||yh).form){var Sc=document.createElement("form"),be=document.createElement("textarea"),xe=(this||yh).iframeId="eio_iframe_"+(this||yh).index,Yd;Sc.className="socketio";Sc.style.position="absolute";Sc.style.top="-1000px";Sc.style.left="-1000px";
Sc.target=xe;Sc.method="POST";Sc.setAttribute("accept-charset","utf-8");be.name="d";Sc.appendChild(be);document.body.appendChild(Sc);(this||yh).form=Sc;(this||yh).area=be}(this||yh).form.action=this.uri();ub();R=R.replace(am,"\\\n");(this||yh).area.value=R.replace(bn,"\\n");try{(this||yh).form.submit()}catch(Bf){}(this||yh).iframe.attachEvent?(this||yh).iframe.onreadystatechange=function(){"complete"===bc.iframe.readyState&&Fa()}:(this||yh).iframe.onload=Fa};var rm=rp,bm=Object.freeze({}),ra="undefined"!==
typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Ra={},ib=Xb.Buffer,Za=Em,Pb=Ud,gc=Ta("engine.io-client:websocket"),xc;"undefined"!==typeof WebSocket?xc=WebSocket:"undefined"!==typeof self&&(xc=self.WebSocket||self.MozWebSocket);if("undefined"===typeof window)try{var Ic=bm}catch(R){}var Sd=xc||Ic;Ra=Ga;dn(Ga,Za);Ga.prototype.name="websocket";Ga.prototype.supportsBinary=!0;Ga.prototype.doOpen=function(){if(this.check()){var R=this.uri(),ia=(this||ra).protocols,Fa={};(this||ra).isReactNative||
(Fa.agent=(this||ra).agent,Fa.perMessageDeflate=(this||ra).perMessageDeflate,Fa.pfx=(this||ra).pfx,Fa.key=(this||ra).key,Fa.passphrase=(this||ra).passphrase,Fa.cert=(this||ra).cert,Fa.ca=(this||ra).ca,Fa.ciphers=(this||ra).ciphers,Fa.rejectUnauthorized=(this||ra).rejectUnauthorized);(this||ra).extraHeaders&&(Fa.headers=(this||ra).extraHeaders);(this||ra).localAddress&&(Fa.localAddress=(this||ra).localAddress);try{(this||ra).ws=(this||ra).usingBrowserWebSocket&&!(this||ra).isReactNative?ia?new Sd(R,
ia):new Sd(R):new Sd(R,ia,Fa)}catch(ub){return this.emit("error",ub)}void 0===(this||ra).ws.binaryType&&((this||ra).supportsBinary=!1);(this||ra).ws.supports&&(this||ra).ws.supports.binary?((this||ra).supportsBinary=!0,(this||ra).ws.binaryType="nodebuffer"):(this||ra).ws.binaryType="arraybuffer";this.addEventListeners()}};Ga.prototype.addEventListeners=function(){var R=this||ra;(this||ra).ws.onopen=function(){R.onOpen()};(this||ra).ws.onclose=function(){R.onClose()};(this||ra).ws.onmessage=function(ia){R.onData(ia.data)};
(this||ra).ws.onerror=function(ia){R.onError("websocket error",ia)}};Ga.prototype.write=function(R){function ia(){Fa.emit("flush");setTimeout(function(){Fa.writable=!0;Fa.emit("drain")},0)}var Fa=this||ra;(this||ra).writable=!1;for(var ub=R.length,bc=0,Sc=ub;bc<Sc;bc++)(function(be){Pb.encodePacket(be,Fa.supportsBinary,function(xe){if(!Fa.usingBrowserWebSocket){var Yd={};be.options&&(Yd.compress=be.options.compress);Fa.perMessageDeflate&&("string"===typeof xe?ib.byteLength(xe):xe.length)<Fa.perMessageDeflate.threshold&&
(Yd.compress=!1)}try{Fa.usingBrowserWebSocket?Fa.ws.send(xe):Fa.ws.send(xe,Yd)}catch(Bf){gc("websocket closed before onclose event")}--ub||ia()})})(R[bc])};Ga.prototype.onClose=function(){Za.prototype.onClose.call(this||ra)};Ga.prototype.doClose=function(){"undefined"!==typeof(this||ra).ws&&(this||ra).ws.close()};Ga.prototype.uri=function(){var R=(this||ra).query||{},ia=(this||ra).secure?"wss":"ws",Fa="";(this||ra).port&&("wss"===ia&&443!==Number((this||ra).port)||"ws"===ia&&80!==Number((this||ra).port))&&
(Fa=":"+(this||ra).port);(this||ra).timestampRequests&&(R[(this||ra).timestampParam]=Dm());(this||ra).supportsBinary||(R.b64=1);R=om.encode(R);R.length&&(R="?"+R);var ub=-1!==(this||ra).hostname.indexOf(":");return ia+"://"+(ub?"["+(this||ra).hostname+"]":(this||ra).hostname)+Fa+(this||ra).path+R};Ga.prototype.check=function(){return!!Sd&&!("__initialize"in Sd&&(this||ra).name===Ga.prototype.name)};var Vf={},Mf=Ra;Vf.polling=function(R){var ia=!1,Fa=!1,ub=!1!==R.jsonp;"undefined"!==typeof location&&
(Fa="https:"===location.protocol,(ia=location.port)||(ia=Fa?443:80),ia=R.hostname!==location.hostname||ia!==R.port,Fa=R.secure!==Fa);R.xdomain=ia;R.xscheme=Fa;if("open"in new vd(R)&&!R.forceJSONP)return new qp(R);if(!ub)throw Error("JSONP disabled");return new rm(R)};Vf.websocket=Mf;var id="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,tg={},og=Ta("engine.io-client:socket"),Jj=Ud,Vk=le,Po=om;tg=La;La.priorWebsocketSuccess=!1;Uc(La.prototype);La.protocol=Jj.protocol;
La.Socket=La;La.Transport=Em;La.transports=Vf;La.parser=Ud;La.prototype.createTransport=function(R){og('creating transport "%s"',R);var ia=(this||id).query,Fa={},ub;for(ub in ia)ia.hasOwnProperty(ub)&&(Fa[ub]=ia[ub]);Fa.EIO=Jj.protocol;Fa.transport=R;ia=(this||id).transportOptions[R]||{};(this||id).id&&(Fa.sid=(this||id).id);return new Vf[R]({query:Fa,socket:this||id,agent:ia.agent||(this||id).agent,hostname:ia.hostname||(this||id).hostname,port:ia.port||(this||id).port,secure:ia.secure||(this||id).secure,
path:ia.path||(this||id).path,forceJSONP:ia.forceJSONP||(this||id).forceJSONP,jsonp:ia.jsonp||(this||id).jsonp,forceBase64:ia.forceBase64||(this||id).forceBase64,enablesXDR:ia.enablesXDR||(this||id).enablesXDR,withCredentials:ia.withCredentials||(this||id).withCredentials,timestampRequests:ia.timestampRequests||(this||id).timestampRequests,timestampParam:ia.timestampParam||(this||id).timestampParam,policyPort:ia.policyPort||(this||id).policyPort,pfx:ia.pfx||(this||id).pfx,key:ia.key||(this||id).key,
passphrase:ia.passphrase||(this||id).passphrase,cert:ia.cert||(this||id).cert,ca:ia.ca||(this||id).ca,ciphers:ia.ciphers||(this||id).ciphers,rejectUnauthorized:ia.rejectUnauthorized||(this||id).rejectUnauthorized,perMessageDeflate:ia.perMessageDeflate||(this||id).perMessageDeflate,extraHeaders:ia.extraHeaders||(this||id).extraHeaders,forceNode:ia.forceNode||(this||id).forceNode,localAddress:ia.localAddress||(this||id).localAddress,requestTimeout:ia.requestTimeout||(this||id).requestTimeout,protocols:ia.protocols||
void 0,isReactNative:(this||id).isReactNative})};La.prototype.open=function(){if((this||id).rememberUpgrade&&La.priorWebsocketSuccess&&-1!==(this||id).transports.indexOf("websocket"))var R="websocket";else{if(0===(this||id).transports.length){var ia=this||id;setTimeout(function(){ia.emit("error","No transports available")},0);return}R=(this||id).transports[0]}(this||id).readyState="opening";try{R=this.createTransport(R)}catch(Fa){(this||id).transports.shift();this.open();return}R.open();this.setTransport(R)};
La.prototype.setTransport=function(R){og("setting transport %s",R.name);var ia=this||id;(this||id).transport&&(og("clearing existing transport %s",(this||id).transport.name),(this||id).transport.removeAllListeners());(this||id).transport=R;R.on("drain",function(){ia.onDrain()}).on("packet",function(Fa){ia.onPacket(Fa)}).on("error",function(Fa){ia.onError(Fa)}).on("close",function(){ia.onClose("transport close")})};La.prototype.probe=function(R){function ia(){if(dg.onlyBinaryUpgrades){var ki=!(this||
id).supportsBinary&&dg.transport.supportsBinary;Bf=Bf||ki}Bf||(og('probe transport "%s" opened',R),Yd.send([{type:"ping",data:"probe"}]),Yd.once("packet",function(ij){Bf||("pong"===ij.type&&"probe"===ij.data?(og('probe transport "%s" pong',R),dg.upgrading=!0,dg.emit("upgrading",Yd),Yd&&(La.priorWebsocketSuccess="websocket"===Yd.name,og('pausing current transport "%s"',dg.transport.name),dg.transport.pause(function(){Bf||"closed"===dg.readyState||(og("changing transport and sending upgrade packet"),
xe(),dg.setTransport(Yd),Yd.send([{type:"upgrade"}]),dg.emit("upgrade",Yd),Yd=null,dg.upgrading=!1,dg.flush())}))):(og('probe transport "%s" failed',R),ij=Error("probe error"),ij.transport=Yd.name,dg.emit("upgradeError",ij)))}))}function Fa(){Bf||(Bf=!0,xe(),Yd.close(),Yd=null)}function ub(ki){var ij=Error("probe error: "+ki);ij.transport=Yd.name;Fa();og('probe transport "%s" failed because of error: %s',R,ki);dg.emit("upgradeError",ij)}function bc(){ub("transport closed")}function Sc(){ub("socket closed")}
function be(ki){Yd&&ki.name!==Yd.name&&(og('"%s" works - aborting "%s"',ki.name,Yd.name),Fa())}function xe(){Yd.removeListener("open",ia);Yd.removeListener("error",ub);Yd.removeListener("close",bc);dg.removeListener("close",Sc);dg.removeListener("upgrading",be)}og('probing transport "%s"',R);var Yd=this.createTransport(R,{probe:1}),Bf=!1,dg=this||id;La.priorWebsocketSuccess=!1;Yd.once("open",ia);Yd.once("error",ub);Yd.once("close",bc);this.once("close",Sc);this.once("upgrading",be);Yd.open()};La.prototype.onOpen=
function(){og("socket open");(this||id).readyState="open";La.priorWebsocketSuccess="websocket"===(this||id).transport.name;this.emit("open");this.flush();if("open"===(this||id).readyState&&(this||id).upgrade&&(this||id).transport.pause){og("starting upgrade probes");for(var R=0,ia=(this||id).upgrades.length;R<ia;R++)this.probe((this||id).upgrades[R])}};La.prototype.onPacket=function(R){if("opening"===(this||id).readyState||"open"===(this||id).readyState||"closing"===(this||id).readyState)switch(og('socket receive: type "%s", data "%s"',
R.type,R.data),this.emit("packet",R),this.emit("heartbeat"),R.type){case "open":this.onHandshake(JSON.parse(R.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var ia=Error("server error");ia.code=R.data;this.onError(ia);break;case "message":this.emit("data",R.data),this.emit("message",R.data)}else og('packet received with socket readyState "%s"',(this||id).readyState)};La.prototype.onHandshake=function(R){this.emit("handshake",R);(this||id).id=R.sid;(this||id).transport.query.sid=
R.sid;(this||id).upgrades=this.filterUpgrades(R.upgrades);(this||id).pingInterval=R.pingInterval;(this||id).pingTimeout=R.pingTimeout;this.onOpen();"closed"!==(this||id).readyState&&(this.setPing(),this.removeListener("heartbeat",(this||id).onHeartbeat),this.on("heartbeat",(this||id).onHeartbeat))};La.prototype.onHeartbeat=function(R){clearTimeout((this||id).pingTimeoutTimer);var ia=this||id;ia.pingTimeoutTimer=setTimeout(function(){if("closed"!==ia.readyState)ia.onClose("ping timeout")},R||ia.pingInterval+
ia.pingTimeout)};La.prototype.setPing=function(){var R=this||id;clearTimeout(R.pingIntervalTimer);R.pingIntervalTimer=setTimeout(function(){og("writing ping packet - expecting pong within %sms",R.pingTimeout);R.ping();R.onHeartbeat(R.pingTimeout)},R.pingInterval)};La.prototype.ping=function(){var R=this||id;this.sendPacket("ping",function(){R.emit("ping")})};La.prototype.onDrain=function(){(this||id).writeBuffer.splice(0,(this||id).prevBufferLen);(this||id).prevBufferLen=0;0===(this||id).writeBuffer.length?
this.emit("drain"):this.flush()};La.prototype.flush=function(){"closed"!==(this||id).readyState&&(this||id).transport.writable&&!(this||id).upgrading&&(this||id).writeBuffer.length&&(og("flushing %d packets in socket",(this||id).writeBuffer.length),(this||id).transport.send((this||id).writeBuffer),(this||id).prevBufferLen=(this||id).writeBuffer.length,this.emit("flush"))};La.prototype.write=La.prototype.send=function(R,ia,Fa){this.sendPacket("message",R,ia,Fa);return this||id};La.prototype.sendPacket=
function(R,ia,Fa,ub){"function"===typeof ia&&(ub=ia,ia=void 0);"function"===typeof Fa&&(ub=Fa,Fa=null);if("closing"!==(this||id).readyState&&"closed"!==(this||id).readyState){Fa=Fa||{};Fa.compress=!1!==Fa.compress;R={type:R,data:ia,options:Fa};this.emit("packetCreate",R);(this||id).writeBuffer.push(R);if(ub)this.once("flush",ub);this.flush()}};La.prototype.close=function(){function R(){ub.onClose("forced close");og("socket closing - telling transport to close");ub.transport.close()}function ia(){ub.removeListener("upgrade",
ia);ub.removeListener("upgradeError",ia);R()}function Fa(){ub.once("upgrade",ia);ub.once("upgradeError",ia)}if("opening"===(this||id).readyState||"open"===(this||id).readyState){(this||id).readyState="closing";var ub=this||id;if((this||id).writeBuffer.length)this.once("drain",function(){(this||id).upgrading?Fa():R()});else(this||id).upgrading?Fa():R()}return this||id};La.prototype.onError=function(R){og("socket error %j",R);La.priorWebsocketSuccess=!1;this.emit("error",R);this.onClose("transport error",
R)};La.prototype.onClose=function(R,ia){if("opening"===(this||id).readyState||"open"===(this||id).readyState||"closing"===(this||id).readyState){og('socket close with reason: "%s"',R);var Fa=this||id;clearTimeout((this||id).pingIntervalTimer);clearTimeout((this||id).pingTimeoutTimer);(this||id).transport.removeAllListeners("close");(this||id).transport.close();(this||id).transport.removeAllListeners();(this||id).readyState="closed";(this||id).id=null;this.emit("close",R,ia);Fa.writeBuffer=[];Fa.prevBufferLen=
0}};La.prototype.filterUpgrades=function(R){for(var ia=[],Fa=0,ub=R.length;Fa<ub;Fa++)~so((this||id).transports,R[Fa])&&ia.push(R[Fa]);return ia};var en={};en=tg;en.parser=Ud;var Kr=en,Lr={},Mq=Lr=function(R,ia){for(var Fa=[],ub=(ia=ia||0)||0;ub<R.length;ub++)Fa[ub-ia]=R[ub];return Fa},at={},So=[].slice,Gm=at=function(R,ia){"string"==typeof ia&&(ia=R[ia]);if("function"!=typeof ia)throw Error("bind() requires a function");var Fa=So.call(arguments,2);return function(){return ia.apply(R,Fa.concat(So.call(arguments)))}},
To={},sm=To=function(R,ia,Fa){R.on(ia,Fa);return{destroy:function(){R.removeListener(ia,Fa)}}},qf="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Nq={},tl=Bb,Hm=Ta("socket.io-client:socket");Nq=Nq=Yb;var lu={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},Uo=Uc.prototype.emit;Uc(Yb.prototype);Yb.prototype.subEvents=function(){if(!(this||
qf).subs){var R=(this||qf).io;(this||qf).subs=[sm(R,"open",Gm(this||qf,"onopen")),sm(R,"packet",Gm(this||qf,"onpacket")),sm(R,"close",Gm(this||qf,"onclose"))]}};Yb.prototype.open=Yb.prototype.connect=function(){if((this||qf).connected)return this||qf;this.subEvents();(this||qf).io.reconnecting||(this||qf).io.open();if("open"===(this||qf).io.readyState)this.onopen();this.emit("connecting");return this||qf};Yb.prototype.send=function(){var R=Mq(arguments);R.unshift("message");(this||qf).emit.apply(this||
qf,R);return this||qf};Yb.prototype.emit=function(R){if(lu.hasOwnProperty(R))return Uo.apply(this||qf,arguments),this||qf;var ia=Mq(arguments),Fa={type:(void 0!==(this||qf).flags.binary?(this||qf).flags.binary:Aj(ia))?tl.BINARY_EVENT:tl.EVENT,data:ia,options:{}};Fa.options.compress=!(this||qf).flags||!1!==(this||qf).flags.compress;"function"===typeof ia[ia.length-1]&&(Hm("emitting packet with ack id %d",(this||qf).ids),(this||qf).acks[(this||qf).ids]=ia.pop(),Fa.id=(this||qf).ids++);(this||qf).connected?
this.packet(Fa):(this||qf).sendBuffer.push(Fa);(this||qf).flags={};return this||qf};Yb.prototype.packet=function(R){R.nsp=(this||qf).nsp;(this||qf).io.packet(R)};Yb.prototype.onopen=function(){Hm("transport is open - connecting");if("/"!==(this||qf).nsp)if((this||qf).query){var R="object"===typeof(this||qf).query?om.encode((this||qf).query):(this||qf).query;Hm("sending connect packet with query %s",R);this.packet({type:tl.CONNECT,query:R})}else this.packet({type:tl.CONNECT})};Yb.prototype.onclose=
function(R){Hm("close (%s)",R);(this||qf).connected=!1;(this||qf).disconnected=!0;delete (this||qf).id;this.emit("disconnect",R)};Yb.prototype.onpacket=function(R){var ia=R.type===tl.ERROR&&"/"===R.nsp;if(R.nsp===(this||qf).nsp||ia)switch(R.type){case tl.CONNECT:this.onconnect();break;case tl.EVENT:this.onevent(R);break;case tl.BINARY_EVENT:this.onevent(R);break;case tl.ACK:this.onack(R);break;case tl.BINARY_ACK:this.onack(R);break;case tl.DISCONNECT:this.ondisconnect();break;case tl.ERROR:this.emit("error",
R.data)}};Yb.prototype.onevent=function(R){var ia=R.data||[];Hm("emitting event %j",ia);null!=R.id&&(Hm("attaching ack callback to event"),ia.push(this.ack(R.id)));(this||qf).connected?Uo.apply(this||qf,ia):(this||qf).receiveBuffer.push(ia)};Yb.prototype.ack=function(R){var ia=this||qf,Fa=!1;return function(){if(!Fa){Fa=!0;var ub=Mq(arguments);Hm("sending ack %j",ub);ia.packet({type:Aj(ub)?tl.BINARY_ACK:tl.ACK,id:R,data:ub})}}};Yb.prototype.onack=function(R){var ia=(this||qf).acks[R.id];"function"===
typeof ia?(Hm("calling ack %s with %j",R.id,R.data),ia.apply(this||qf,R.data),delete (this||qf).acks[R.id]):Hm("bad ack %s",R.id)};Yb.prototype.onconnect=function(){(this||qf).connected=!0;(this||qf).disconnected=!1;this.emit("connect");this.emitBuffered()};Yb.prototype.emitBuffered=function(){var R;for(R=0;R<(this||qf).receiveBuffer.length;R++)Uo.apply(this||qf,(this||qf).receiveBuffer[R]);(this||qf).receiveBuffer=[];for(R=0;R<(this||qf).sendBuffer.length;R++)this.packet((this||qf).sendBuffer[R]);
(this||qf).sendBuffer=[]};Yb.prototype.ondisconnect=function(){Hm("server disconnect (%s)",(this||qf).nsp);this.destroy();this.onclose("io server disconnect")};Yb.prototype.destroy=function(){if((this||qf).subs){for(var R=0;R<(this||qf).subs.length;R++)(this||qf).subs[R].destroy();(this||qf).subs=null}(this||qf).io.destroy(this||qf)};Yb.prototype.close=Yb.prototype.disconnect=function(){(this||qf).connected&&(Hm("performing disconnect (%s)",(this||qf).nsp),this.packet({type:tl.DISCONNECT}));this.destroy();
if((this||qf).connected)this.onclose("io client disconnect");return this||qf};Yb.prototype.compress=function(R){(this||qf).flags.compress=R;return this||qf};Yb.prototype.binary=function(R){(this||qf).flags.binary=R;return this||qf};var sp=Nq,gl="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Zp={};Zp=kc;kc.prototype.duration=function(){var R=(this||gl).ms*Math.pow((this||gl).factor,(this||gl).attempts++);if((this||gl).jitter){var ia=Math.random(),Fa=Math.floor(ia*
(this||gl).jitter*R);R=0==(Math.floor(10*ia)&1)?R-Fa:R+Fa}return Math.min(R,(this||gl).max)|0};kc.prototype.reset=function(){(this||gl).attempts=0};kc.prototype.setMin=function(R){(this||gl).ms=R};kc.prototype.setMax=function(R){(this||gl).max=R};kc.prototype.setJitter=function(R){(this||gl).jitter=R};var Mr=Zp,Vo={},Oq=Ta("socket.io-client:url"),Pq=Vo=function(R,ia){var Fa=R;ia=ia||"undefined"!==typeof location&&location;null==R&&(R=ia.protocol+"//"+ia.host);"string"===typeof R&&("/"===R.charAt(0)&&
(R="/"===R.charAt(1)?ia.protocol+R:ia.host+R),/^(https?|wss?):\/\//.test(R)||(Oq("protocol-less url %s",R),R="undefined"!==typeof ia?ia.protocol+"//"+R:"https://"+R),Oq("parse %s",R),Fa=le(R));Fa.port||(/^(http|ws)$/.test(Fa.protocol)?Fa.port="80":/^(http|ws)s$/.test(Fa.protocol)&&(Fa.port="443"));Fa.path=Fa.path||"/";R=-1!==Fa.host.indexOf(":")?"["+Fa.host+"]":Fa.host;Fa.id=Fa.protocol+"://"+R+":"+Fa.port;Fa.href=Fa.protocol+"://"+R+(ia&&ia.port===Fa.port?"":":"+Fa.port);return Fa},oe="undefined"!==
typeof globalThis?globalThis:"undefined"!==typeof self?self:global,to={},Pl=Bb,Xk=Ta("socket.io-client:manager"),Qq=Mr,Nr=Object.prototype.hasOwnProperty;to=Ua;Ua.prototype.emitAll=function(){(this||oe).emit.apply(this||oe,arguments);for(var R in(this||oe).nsps)Nr.call((this||oe).nsps,R)&&(this||oe).nsps[R].emit.apply((this||oe).nsps[R],arguments)};Ua.prototype.updateSocketIds=function(){for(var R in(this||oe).nsps)Nr.call((this||oe).nsps,R)&&((this||oe).nsps[R].id=this.generateId(R))};Ua.prototype.generateId=
function(R){return("/"===R?"":R+"#")+(this||oe).engine.id};Uc(Ua.prototype);Ua.prototype.reconnection=function(R){if(!arguments.length)return(this||oe)._reconnection;(this||oe)._reconnection=!!R;return this||oe};Ua.prototype.reconnectionAttempts=function(R){if(!arguments.length)return(this||oe)._reconnectionAttempts;(this||oe)._reconnectionAttempts=R;return this||oe};Ua.prototype.reconnectionDelay=function(R){if(!arguments.length)return(this||oe)._reconnectionDelay;(this||oe)._reconnectionDelay=R;
(this||oe).backoff&&(this||oe).backoff.setMin(R);return this||oe};Ua.prototype.randomizationFactor=function(R){if(!arguments.length)return(this||oe)._randomizationFactor;(this||oe)._randomizationFactor=R;(this||oe).backoff&&(this||oe).backoff.setJitter(R);return this||oe};Ua.prototype.reconnectionDelayMax=function(R){if(!arguments.length)return(this||oe)._reconnectionDelayMax;(this||oe)._reconnectionDelayMax=R;(this||oe).backoff&&(this||oe).backoff.setMax(R);return this||oe};Ua.prototype.timeout=
function(R){if(!arguments.length)return(this||oe)._timeout;(this||oe)._timeout=R;return this||oe};Ua.prototype.maybeReconnectOnOpen=function(){!(this||oe).reconnecting&&(this||oe)._reconnection&&0===(this||oe).backoff.attempts&&this.reconnect()};Ua.prototype.open=Ua.prototype.connect=function(R,ia){Xk("readyState %s",(this||oe).readyState);if(~(this||oe).readyState.indexOf("open"))return this||oe;Xk("opening %s",(this||oe).uri);(this||oe).engine=Kr((this||oe).uri,(this||oe).opts);var Fa=(this||oe).engine,
ub=this||oe;(this||oe).readyState="opening";(this||oe).skipReconnect=!1;var bc=sm(Fa,"open",function(){ub.onopen();R&&R()});ia=sm(Fa,"error",function(xe){Xk("connect_error");ub.cleanup();ub.readyState="closed";ub.emitAll("connect_error",xe);if(R){var Yd=Error("Connection error");Yd.data=xe;R(Yd)}else ub.maybeReconnectOnOpen()});if(!1!==(this||oe)._timeout){var Sc=(this||oe)._timeout;Xk("connect attempt will timeout after %d",Sc);0===Sc&&bc.destroy();var be=setTimeout(function(){Xk("connect attempt timed out after %d",
Sc);bc.destroy();Fa.close();Fa.emit("error","timeout");ub.emitAll("connect_timeout",Sc)},Sc);(this||oe).subs.push({destroy:function(){clearTimeout(be)}})}(this||oe).subs.push(bc);(this||oe).subs.push(ia);return this||oe};Ua.prototype.onopen=function(){Xk("open");this.cleanup();(this||oe).readyState="open";this.emit("open");var R=(this||oe).engine;(this||oe).subs.push(sm(R,"data",Gm(this||oe,"ondata")));(this||oe).subs.push(sm(R,"ping",Gm(this||oe,"onping")));(this||oe).subs.push(sm(R,"pong",Gm(this||
oe,"onpong")));(this||oe).subs.push(sm(R,"error",Gm(this||oe,"onerror")));(this||oe).subs.push(sm(R,"close",Gm(this||oe,"onclose")));(this||oe).subs.push(sm((this||oe).decoder,"decoded",Gm(this||oe,"ondecoded")))};Ua.prototype.onping=function(){(this||oe).lastPing=new Date;this.emitAll("ping")};Ua.prototype.onpong=function(){this.emitAll("pong",new Date-(this||oe).lastPing)};Ua.prototype.ondata=function(R){(this||oe).decoder.add(R)};Ua.prototype.ondecoded=function(R){this.emit("packet",R)};Ua.prototype.onerror=
function(R){Xk("error",R);this.emitAll("error",R)};Ua.prototype.socket=function(R,ia){function Fa(){~so(bc.connecting,ub)||bc.connecting.push(ub)}var ub=(this||oe).nsps[R];if(!ub){ub=new sp(this||oe,R,ia);(this||oe).nsps[R]=ub;var bc=this||oe;ub.on("connecting",Fa);ub.on("connect",function(){ub.id=bc.generateId(R)});(this||oe).autoConnect&&Fa()}return ub};Ua.prototype.destroy=function(R){R=so((this||oe).connecting,R);~R&&(this||oe).connecting.splice(R,1);(this||oe).connecting.length||this.close()};
Ua.prototype.packet=function(R){Xk("writing packet %j",R);var ia=this||oe;R.query&&0===R.type&&(R.nsp+="?"+R.query);ia.encoding?ia.packetBuffer.push(R):(ia.encoding=!0,(this||oe).encoder.encode(R,function(Fa){for(var ub=0;ub<Fa.length;ub++)ia.engine.write(Fa[ub],R.options);ia.encoding=!1;ia.processPacketQueue()}))};Ua.prototype.processPacketQueue=function(){if(0<(this||oe).packetBuffer.length&&!(this||oe).encoding){var R=(this||oe).packetBuffer.shift();this.packet(R)}};Ua.prototype.cleanup=function(){Xk("cleanup");
for(var R=(this||oe).subs.length,ia=0;ia<R;ia++)(this||oe).subs.shift().destroy();(this||oe).packetBuffer=[];(this||oe).encoding=!1;(this||oe).lastPing=null;(this||oe).decoder.destroy()};Ua.prototype.close=Ua.prototype.disconnect=function(){Xk("disconnect");(this||oe).skipReconnect=!0;(this||oe).reconnecting=!1;"opening"===(this||oe).readyState&&this.cleanup();(this||oe).backoff.reset();(this||oe).readyState="closed";(this||oe).engine&&(this||oe).engine.close()};Ua.prototype.onclose=function(R){Xk("onclose");
this.cleanup();(this||oe).backoff.reset();(this||oe).readyState="closed";this.emit("close",R);(this||oe)._reconnection&&!(this||oe).skipReconnect&&this.reconnect()};Ua.prototype.reconnect=function(){if((this||oe).reconnecting||(this||oe).skipReconnect)return this||oe;var R=this||oe;if((this||oe).backoff.attempts>=(this||oe)._reconnectionAttempts)Xk("reconnect failed"),(this||oe).backoff.reset(),this.emitAll("reconnect_failed"),(this||oe).reconnecting=!1;else{var ia=(this||oe).backoff.duration();Xk("will wait %dms before reconnect attempt",
ia);(this||oe).reconnecting=!0;var Fa=setTimeout(function(){R.skipReconnect||(Xk("attempting reconnect"),R.emitAll("reconnect_attempt",R.backoff.attempts),R.emitAll("reconnecting",R.backoff.attempts),R.skipReconnect||R.open(function(ub){ub?(Xk("reconnect attempt error"),R.reconnecting=!1,R.reconnect(),R.emitAll("reconnect_error",ub.data)):(Xk("reconnect success"),R.onreconnect())}))},ia);(this||oe).subs.push({destroy:function(){clearTimeout(Fa)}})}};Ua.prototype.onreconnect=function(){var R=(this||
oe).backoff.attempts;(this||oe).reconnecting=!1;(this||oe).backoff.reset();this.updateSocketIds();this.emitAll("reconnect",R)};var Rq=to,uo={},mu=Pq,Or=Bb,Sq=Rq,Tq=Ta("socket.io-client");uo=uo=ec;var $p=uo.managers={};uo.protocol=Or.protocol;uo.connect=ec;uo.Manager=Rq;uo.Socket=sp;var nu=uo,Mg=lively.FreezerRuntime.recorderFor("lively.2lively/client.js");Mg.determineLocation=function(){return"undefined"!==typeof document&&document.location?document.location.origin:Mg.isNode?System._nodeRequire("os").hostname():
System.baseURL};Mg.promise=Qb;Mg.fun=Xd;Mg.obj=ad;Mg.events=Nd;Mg.num=dd;Mg.L2LConnection=ee;Mg.defaultActions=ab;Mg.defaultClientActions=od;Mg.isNode="undefined"!==typeof System?System.get("@system-env").node:"undefined"!==typeof process&&process.env;Mg._ioClient=nu;Mg.ioClient=Mg.ioClient||void 0;Mg.isNode?(Mg.require=System._nodeRequire("module")._load,Mg.ioClient=Mg.require("socket.io-client")):Mg.ioClient=Mg._ioClient;Mg.urlHelper={isRoot:function(R){return"/"===Mg.urlHelper.path(R)},root:function(R){return Mg.urlHelper.isRoot(R)?
R:R.slice(0,-Mg.urlHelper.path(R).length)+"/"},path:function(){var R=/^[a-z0-9-_\.]+:/,ia=/^\/\/[^\/]+/;return function(Fa){Fa=Fa.replace(R,"").replace(ia,"");return""===Fa?"/":Fa}}(),join:function(R,ia){R.endsWith("/")&&(R=R.slice(0,-1));ia.startsWith("/")&&(ia=ia.slice(1));return R+"/"+ia}};var Zi=function(R,ia,Fa,ub){var bc=Mg.L2LConnection.call(this)||this;Mg.events.makeEmitter(bc);bc.info=ub;bc.origin=R;bc.path=ia;bc.namespace=Fa.replace(/^\/?/,"/");bc.trackerId=null;bc._socketioClient=null;
bc._reconnectState={closed:!1,autoReconnect:!0,isReconnecting:!1,isReconnectingViaSocketio:!1,registerAttempt:0,registerProcess:null,isOpening:!1};Object.keys(Mg.defaultActions).forEach(function(Sc){return bc.addService(Sc,Mg.defaultActions[Sc])});Object.keys(Mg.defaultClientActions).forEach(function(Sc){return bc.addService(Sc,Mg.defaultClientActions[Sc])});return bc};$jscomp.inherits(Zi,Mg.L2LConnection);Zi.clientKey=function(R,ia,Fa){R=R.replace(/\/$/,"");ia=ia.replace(/^\//,"");Fa=Fa.replace(/^\//,
"");return R+"-"+ia+"-"+Fa};Zi.forLivelyInBrowser=function(R){var ia=!!R;R=Object.assign({type:"lively.morphic browser"},R);var Fa=this.default();if(!Fa)return Mg.L2LClient.ensure({url:document.location.origin+"/lively-socket.io",namespace:"l2l",info:R});ia&&!Mg.obj.equals(Fa.info,R)&&Fa.isRegistered()&&(Fa.info=R,Fa.unregister().then(function(){return Fa.register()}).catch(function(ub){return console.error("l2l re-register on info change errored: "+ub)}));return Fa};Zi.default=function(){var R=Mg.L2LClient.clients.keys().next().value;
return Mg.L2LClient.clients.get(R)};Zi.create=function(R){var ia=R=void 0===R?{}:R;R=void 0===ia.debug?!1:ia.debug;var Fa=ia.url,ub=ia.namespace,bc=void 0===ia.autoOpen?!0:ia.autoOpen;ia=void 0===ia.info?{}:ia.info;if(!Fa)throw Error("L2LClient needs server url!");var Sc=Mg.urlHelper.root(Fa).replace(/\/+$/,"");Fa=Mg.urlHelper.path(Fa);ub=new this(Sc,Fa,ub||"",ia);bc&&ub.register();ub.debug=R;return ub};Zi.ensure=function(R){var ia=R=void 0===R?{}:R,Fa=ia.url;ia=ia.namespace;if(!Fa)throw Error("L2LClient needs server url!");
var ub=Mg.urlHelper.root(Fa).replace(/\/+$/,""),bc=Mg.urlHelper.path(Fa);ub=this.clientKey(ub,bc,ia||"");(bc=this.clients.get(ub))||this.clients.set(ub,bc=this.create(Object.assign({},R,{url:Fa,namespace:ia})));return bc};Zi.prototype.isOnline=function(){return this.socket&&this.socket.connected};Zi.prototype.isRegistered=function(){return this.isOnline()&&!!this.trackerId};Zi.prototype.open=function(){var R=this,ia,Fa,ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bc){if(1==bc.nextAddress)return R.isOnline()||
R._reconnectState.isOpening?bc.return(R):bc.yield(R.close(),2);R._reconnectState.closed=!1;ia=Mg.urlHelper.join(R.origin,R.namespace);Fa={path:R.path,transports:["websocket","polling"]};ub=R._socketioClient=Mg.ioClient(ia,Fa);R.debug&&console.log("["+R+"] connecting");ub.on("error",function(Sc){R._reconnectState.isOpening=!1;R.debug&&console.log("["+R+"] errored: "+Sc)});ub.on("close",function(Sc){return R.debug&&console.log("["+R+"] closed: "+Sc)});ub.on("reconnect_failed",function(){return R.debug&&
console.log("["+R+"] could not reconnect")});ub.on("reconnect_error",function(Sc){return R.debug&&console.log("["+R+"] reconnect error "+Sc)});ub.on("connect",function(){R.debug&&console.log("["+R+"] connected");R.emit("connected",R);R._reconnectState.isOpening=!1;R._reconnectState.isReconnecting=!1;R._reconnectState.isReconnectingViaSocketio=!1});ub.on("disconnect",function(){R._reconnectState.isOpening=!1;R.debug&&console.log("["+R+"] disconnected");R.emit("disconnected",R);R.trackerId?("tracker"!==
R.trackerId&&(R.renameTarget(R.trackerId,"tracker"),R.trackerId=null),R._reconnectState.closed?R.debug&&console.log("["+R+"] won't reconnect b/c client is marked as closed"):R._reconnectState.autoReconnect?(R._reconnectState.isReconnecting=!0,setTimeout(function(){R._reconnectState.closed?R.debug&&console.log("["+R+"] won't reconnect b/c client is marked as closed 2"):R._reconnectState.isReconnectingViaSocketio?R.debug&&console.log("["+R+"] won't reconnect again, client already reconnecting"):(R.debug&&
console.log("["+R+"] initiating reconnection to tracker"),R.register())},20)):R.debug&&console.log("["+R+"] won't reconnect b/c client has reconnection disabled")):(R.debug&&console.log("["+R+"] disconnect: don't have a tracker id, won't try reconnect"),R.trackerId="tracker")});ub.on("reconnecting",function(){R.debug&&console.log("["+R+"] reconnecting",R._reconnectState);R.emit("reconnecting",R);R._reconnectState.closed?(R._reconnectState.isReconnecting=!1,R._reconnectState.isReconnectingViaSocketio=
!1,ub.close(),R.close()):(R._reconnectState.isReconnecting=!0,R._reconnectState.isReconnectingViaSocketio=!0)});ub.on("reconnect",function(){R.debug&&console.log("["+R+"] reconnected");R._reconnectState.isReconnecting=!1;R._reconnectState.isReconnectingViaSocketio=!1;R.register()});R.installEventToMessageTranslator(ub);R._reconnectState.isOpening=!0;return bc.return((new Promise(function(Sc,be){ub.once("error",be);ub.once("connect",Sc)})).then(function(){return R}))})};Zi.prototype.close=function(){var R=
this,ia,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ub){if(1==ub.nextAddress){R._reconnectState.closed=!0;if(ia=R.socket)ia.removeAllListeners("reconnect"),ia.removeAllListeners("reconnecting"),ia.removeAllListeners("disconnect"),ia.removeAllListeners("connect"),ia.removeAllListeners("reconnect_error"),ia.removeAllListeners("reconnect_failed"),ia.removeAllListeners("close"),ia.removeAllListeners("error"),ia.close();R.debug&&console.log("["+R+"] closing...");return R.isRegistered()?
ub.yield(R.unregister(),2):ub.jumpTo(2)}return R.isOnline()||R.socket?ia&&!ia.connected?(R.debug&&console.log("["+R+"] socket not connected, considering client closed"),ub.return(R)):ub.return(Promise.race([Mg.promise.delay(2E3).then(function(){return ia.removeAllListeners("disconnect")}),new Promise(function(bc){return ia.once("disconnect",bc)})]).then(function(){R.debug&&console.log("["+R+"] closed");return R})):(R.debug&&(Fa=R.isOnline()?"no socket":"not online",R.debug&&console.log("["+R+"] cannot close: "+
Fa)),ub.return(R))})};Zi.prototype.remove=function(){var R=this.constructor.clientKey(this.origin,this.path,this.namespace);this.constructor.clients.delete(R);return this.close()};Zi.prototype.register=function(){var R=this,ia,Fa,ub,bc,Sc,be,xe,Yd,Bf,dg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ki){switch(ki.nextAddress){case 1:if(R.isRegistered())return ki.return();if(R._reconnectState.closed)return R.debug&&console.log("["+R+"] not registering this b/c closed"),R._reconnectState.registerAttempt=
0,ki.return();if(R._reconnectState.registerProcess)return R.debug&&console.log("["+R+"] not registering this b/c register process exists"),ki.return();ki.setCatchFinallyBlocks(2);if(R.isOnline()){ki.jumpTo(4);break}return ki.yield(R.open(),4);case 4:return R.debug&&console.log("["+R+"] register"),ki.yield(R.sendToAndWait("tracker","register",Object.assign({userName:"unknown",type:"l2l "+(Mg.isNode?"node":"browser"),location:Mg.determineLocation()},R.info)),6);case 6:ia=ki.yieldResult;if(!ia.data)throw Fa=
Error("Register answer is empty!"),R.emit("error",Fa),Fa;if(ia.data.isError)throw ub=Error(ia.data.error),R.emit("error",ub),ub;R._reconnectState.registerAttempt=0;bc=ia;Sc=bc.data;be=Sc.trackerId;xe=Sc.messageNumber;R.trackerId=be;R._incomingOrderNumberingBySenders.set(be,xe||0);R.emit("registered",{trackerId:be});ki.leaveTryBlock(0);break;case 2:Yd=ki.enterCatchBlock(),console.error("Error in register request of "+R+": "+Yd),Bf=R._reconnectState.registerAttempt++,dg=Mg.num.backoff(Bf,4,3E5),R._reconnectState.registerProcess=
setTimeout(function(){R._reconnectState.registerProcess=null;R.register()},dg),ki.jumpToEnd()}})};Zi.prototype.unregister=function(){var R=this,ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:if(!R.isRegistered())return Fa.return();R.debug&&console.log("["+R+"] unregister");ia=R.trackerId;Fa.setCatchFinallyBlocks(2);return Fa.yield(R.sendToAndWait(R.trackerId,"unregister",{}),4);case 4:Fa.leaveTryBlock(3);break;case 2:Fa.enterCatchBlock();case 3:R.renameTarget(ia,
"tracker"),R.trackerId=null,R.emit("unregistered",R),Fa.jumpToEnd()}})};Zi.prototype.whenRegistered=function(R){var ia=this;return Mg.promise.waitFor(R,function(){return ia.isRegistered()}).catch(function(Fa){return Promise.reject(/timeout/i.test(String(Fa))?Error("Timeout in "+ia+".whenRegistered"):Fa)})};Zi.prototype.send=function(R,ia){var Fa=this,ub=$jscomp.makeIterator(this.prepareSend(R,ia));R=ub.next().value;ia=ub.next().value;this.whenOnline().then(function(){var bc=Fa.socket,Sc=R,be=Sc.action;
Sc=Sc.target;if(!bc)throw Error("Trying to send message "+be+" to "+Sc+" but cannot find a connection to it!");"function"===typeof ia?bc.emit(be,R,ia):bc.emit(be,R)})};Zi.prototype.joinRoom=function(R){var ia=this;return this.whenOnline().then(function(){return ia.sendToAndWait(ia.trackerId,"[broadcast] join room",{room:R})})};Zi.prototype.leaveRoom=function(R){var ia=this;return this.whenOnline().then(function(){return ia.sendToAndWait(ia.trackerId,"[broadcast] leave room",{room:R})})};Zi.prototype.broadcast=
function(R,ia,Fa,ub,bc){var Sc=this,be={action:ia,room:R,broadcast:Fa};if(void 0===ub?0:ub)be.isSystemBroadcast=!0;if(void 0===bc?0:bc)be.isMultiServerBroadcast=!0;return this.whenOnline().then(function(){return Sc.sendToAndWait(Sc.trackerId,"[broadcast] send",be)})};Zi.prototype.listRoomMembers=function(R){var ia=this,Fa,ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bc){if(1==bc.nextAddress)return bc.yield(ia.sendToAndWait(ia.trackerId,"[broadcast] list room members",{room:R}),2);
Fa=bc.yieldResult;ub=Fa.data;return bc.return(ub)})};Zi.prototype.joinedRooms=function(){var R=this,ia,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ub){if(1==ub.nextAddress)return ub.yield(R.sendToAndWait(R.trackerId,"[broadcast] my rooms",{}),2);ia=ub.yieldResult;Fa=ia.data;return ub.return(Fa)})};Zi.prototype.listRooms=function(){var R=this,ia,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ub){if(1==ub.nextAddress)return ub.yield(R.sendToAndWait(R.trackerId,"[broadcast] all rooms",
{}),2);ia=ub.yieldResult;Fa=ia.data;return ub.return(Fa)})};Zi.prototype.listPeers=function(R){R=void 0===R?!1:R;var ia=this,Fa,ub,bc,Sc,be,xe;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){if(1==Yd.nextAddress)return Fa=ia,ub=Fa._peersCached,bc=Date.now(),!R&&ub&&1E3>bc-ub.timestamp?Yd.return(ia._peersCached.sessions):ia.isOnline()?Yd.yield(ia.sendToAndWait(ia.trackerId,"getClients",{}),2):Yd.return([]);Sc=Yd.yieldResult;be=Sc.data;xe=be.map(function(Bf){var dg=$jscomp.makeIterator(Bf);
Bf=dg.next().value;var ki=dg.next().value,ij=ki.info||{};dg=ij.userRealm;var gk=ij.userToken,tp=ij.l2lUserToken,Wo=ij.location,vo=ij.type;ij=ij.world;Bf=Object.assign({},Mg.obj.dissoc(ki,["info"]),{id:Bf,world:ij,location:Wo,type:vo});(gk=gk||tp)&&"null"!==gk&&(lively.user?Bf.user=lively.user.ClientUser.fromToken(gk,dg):(Bf.userToken=gk,Bf.userRealm=dg));return Bf});ia._peersCached={timestamp:bc,sessions:xe};return Yd.return(xe)})};Zi.prototype.toString=function(){var R=this.origin,ia=this.path,Fa=
this.namespace,ub=this.id,bc=this.isOnline()?this.isRegistered()?"registered":"unregistered":"disconnected";return"L2LClient("+(ub||"").slice(0,5)+" "+R+ia+" - "+Fa+" "+bc+")"};$jscomp.global.Object.defineProperties(Zi.prototype,{socket:{configurable:!0,enumerable:!0,get:function(){return this._socketioClient}},socketId:{configurable:!0,enumerable:!0,get:function(){return this.socket?this.socket.id:null}}});$jscomp.global.Object.defineProperties(Zi,{clients:{configurable:!0,enumerable:!0,get:function(){return this._clients||
(this._clients=new Map)}}});Ba("default",Zi);Mg.L2LClient=Zi;Mg.default=Zi}}});
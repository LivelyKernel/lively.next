System.register("./__root_module__-f418f9fd.js lively.collab kld-intersections ./index-96ee3fea.js ./index-6e65d49f.js ./editor-plugin-c26fc353.js".split(" "),function(Ha){var tb,Ab,kc,ac,Ld,Tc,$d,Uc,Pc,Jd,pe,Ze,Ff,te,Bc,sd,le,jc,je,Ae,Dc,Mc,bc,Gc;return{setters:[function(Zc){tb=Zc.aJ;Ab=Zc.bC;kc=Zc.bD;ac=Zc.bE;Ld=Zc.E;Tc=Zc.aF;$d=Zc.bi;Uc=Zc.a7;Pc=Zc.ae;Jd=Zc.bv;pe=Zc.a6;Ze=Zc.$;Ff=Zc.bF;te=Zc.bp},function(){},function(){},function(Zc){Bc=Zc.s},function(Zc){sd=Zc.localInterface;le=Zc.systemInterfaceNamed;
jc=Zc.serverInterfaceFor;je=Zc.l2lInterfaceFor},function(Zc){Ae=Zc.p;Dc=Zc.d;Mc=Zc.a;bc=Zc.r;Gc=Zc.C}],execute:function(){var Zc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");Zc.warnStyle={"border-bottom":"2px dotted orange"};Zc.errorStyle={"background-color":"red"};var Rd=function(kb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),Pa=ha.hasOwnProperty("JavaScriptChecker")&&"function"===typeof ha.JavaScriptChecker?ha.JavaScriptChecker:ha.JavaScriptChecker=function(T){T&&
T[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return tb(Pa,kb,[{key:"uninstall",value:function(T){var ia=T.text||T;(ia.markers||[]).forEach(function(Fa){return Fa.id.startsWith("js-checker-")&&ia.removeMarker(Fa)});ia.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(T,ia){return[].concat($jscomp.arrayFromIterable(T.embeddedMorphMap.values())).find(function(Fa){return ia.containsPosition(Fa.anchor.position)})}},
{key:"onDocumentChange",value:function(T,ia,Fa){var $a=ia.document;try{var zb=Fa.parse()}catch(Cc){zb=Cc}zb&&(T=(ia.markers||[]).filter(function(Cc){return Cc.id.startsWith("js-checker-")}),Fa=Fa.undeclaredVariables().map(function(Cc,Ba){var Ca=Cc.start;Cc=Cc.end;Ca=$a.indexToPosition(Ca);Cc=$a.indexToPosition(Cc);return ia.addMarker({id:"js-checker-"+Ba,style:Zc.warnStyle,range:{start:Ca,end:Cc},type:"js-undeclared-var"})}),T.slice(Fa.length).forEach(function(Cc){return ia.removeMarker(Cc)}),zb.parseError?
(T=zb.parseError.loc,Fa=T.column,T=T.line-1,zb=$a.indexToPosition(zb.parseError.pos),Fa=zb.column,T=zb.row,zb={start:{column:Fa-1,row:T},end:{column:Fa+1,row:T}},this.hasEmbeddedMorphInRange(ia,zb)||ia.addMarker({id:"js-syntax-error",range:zb,style:Zc.errorStyle,type:"js-syntax-error"})):ia.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],ha,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),Kd=Rd=Zc.JavaScriptChecker;Zc.default=Rd;var rb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");rb.query=Ab;rb.fuzzyParse=kc;rb.acorn=ac;rb.custom=Ld;var ob=function(kb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),Pa=ha.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof ha.JavaScriptNavigator?
ha.JavaScriptNavigator:ha.JavaScriptNavigator=function(T){T&&T[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return tb(Pa,kb,[{key:"ensureAST",value:function(T){return this.parse(T.textString)}},{key:"parse",value:function(T){return rb.fuzzyParse(T)}},{key:"move",value:function(T,ia){var Fa=!!ia.activeMark||!ia.selection.isEmpty(),$a=ia.selection,zb=ia.positionToIndex($a.lead);T=this[T](ia.textString,zb);T=ia.indexToPosition(T);$a.lead=
T;Fa||($a.anchor=T);ia.scrollCursorIntoView()}},{key:"forwardSexp",value:function(T){this.move("_forwardSexp",T)}},{key:"backwardSexp",value:function(T){this.move("_backwardSexp",T)}},{key:"backwardUpSexp",value:function(T){this.move("_backwardUpSexp",T)}},{key:"forwardDownSexp",value:function(T){this.move("_forwardDownSexp",T)}},{key:"_forwardSexp",value:function(T,ia){T=this.parse(T);T=rb.custom.findNodesIncluding(T,ia).reverse().find(function($a){return $a.end!==ia});if(!T)return ia;if("BlockStatement"===
T.type){var Fa=T.body.find(function($a){return $a.start>ia});if(Fa)return Fa.start}return T.end}},{key:"_backwardSexp",value:function(T,ia){T=this.parse(T);T=rb.custom.findNodesIncluding(T,ia).reverse().find(function($a){return $a.start!==ia});if(!T)return ia;if("BlockStatement"===T.type){var Fa=T.body.slice().reverse().find(function($a){return $a.end<ia});if(Fa)return Fa.end}return T?T.start:ia}},{key:"_backwardUpSexp",value:function(T,ia){T=this.parse(T);return(T=rb.custom.findNodesIncluding(T,
ia).reverse().find(function(Fa){return Fa.start!==ia}))?T.start:ia}},{key:"_forwardDownSexp",value:function(T,ia){T=this.parse(T);return(T=rb.custom.findNodeAfter(T,ia,function(Fa,$a){return $a.start>ia}))?T.node.start:ia}},{key:"markDefun",value:function(T){var ia=this.rangeForFunctionOrDefinition(T.textString,[T.positionToIndex(T.selection.range.start),T.positionToIndex(T.selection.range.end)]);ia&&T.execCommand("expandRegion",{start:ia[0],end:ia[1]})}},{key:"rangeForNodesMatching",value:function(T,
ia,Fa){T=this.parse(T);return(ia=rb.custom.findNodesIncluding(T,ia).reverse().find(Fa))?[ia.start,ia.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(T,ia){var Fa=ia[0]===ia[1];return this.rangeForNodesMatching(T,ia[1],function($a){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes($a.type)&&(Fa&&$a.end!==ia[1]||!Fa&&$a.start<ia[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(T,ia){"number"!==typeof ia&&(ia=T.positionToIndex(ia));
T=this.ensureAST(T);var Fa=rb.query.nodesAt(ia,T).reverse(),$a=Fa.find(function(Cc){return"Identifier"===Cc.type});if(!$a&&((Fa=Fa[0])&&Fa.type.includes("Specifier")&&Fa.local&&"Identifier"===Fa.local.type&&($a=Fa.local),!$a))return;ia=(Fa=rb.query.findDeclarationClosestToIndex(T,$a.name,ia))?rb.query.scopeAtIndex(T,Fa.start):rb.query.scopeAtIndex(T,ia);var zb=rb.query.findReferencesAndDeclsInScope(ia,$a.name).refs;return{parsed:T,scope:ia,id:$a,name:$a.name,decl:Fa,refs:zb}}},{key:"expandRegion",
value:function(T,ia,Fa,$a){function zb(Nb){Nb=T.positionToIndex({column:0,row:Ba.row});return{range:[Nb+Ca.start,Nb+Ca.start+Ca.value.length],prev:$a}}var Cc=$a.range[0]!==$a.range[1],Ba=T.indexToPosition($a.range[0]),Ca=T.tokenAt(Ba);if(!Cc&&Ca&&["keyword","identifier"].includes(Ca.type))return zb();Fa=Fa||this.parse(ia);ia=rb.query.nodesAtIndex(Fa,$a.range[0]).reverse().find(function(Nb){return Nb.start<$a.range[0]||Nb.end>$a.range[1]});if(!ia)return $a;Fa=ia.start;Cc=ia.end;return"Literal"===ia.type&&
(ia.raw||"").match(/^['"`]/)&&$a.range[0]!==ia.start&&$a.range[1]!==ia.end&&(ia.start+1<$a.range[0]||ia.end-1>$a.range[1])?{range:[Fa+1,Cc-1],prev:$a}:{range:[Fa,Cc],prev:$a}}},{key:"contractRegion",value:function(T,ia,Fa,$a){return $a.prev||$a}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],ha,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6780})}(void 0);Rd=ob=rb.JavaScriptNavigator;rb.default=ob;var Bb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");Bb.addIndexToTextPos=function(kb,ha,Pa){return kb.indexToPosition(kb.positionToIndex(ha)+Pa)};Bb.connect=Tc;Bb.disconnect=$d;Bb.string=Uc;Bb.KeyHandler=Pc;Bb.Range=Jd;ob=function(kb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),Pa=ha.hasOwnProperty("Snippet")&&"function"===
typeof ha.Snippet?ha.Snippet:ha.Snippet=function(T){T&&T[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return tb(Pa,kb,[{key:Symbol.for("lively-instance-initialize"),value:function(T){T=void 0===T?{trigger:null,expansion:""}:T;var ia=T.expansion;this.trigger=T.trigger;this.expansion=ia;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(T){this.isExpanding&&(this.textMorph=T,Bb.connect(this.textMorph,
"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(T){this.isExpanding&&(Bb.disconnect(T,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var T=this.expansionState,ia=T.startAnchor,Fa=T.endAnchor;T.isExpanding?Bb.Range.fromPositions(ia.position,Fa.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var T=this.textMorph;if(T){var ia=
this.expansionState||{},Fa=ia.marker,$a=ia.startAnchor,zb=ia.endAnchor;ia=ia.steps;$a&&T.removeAnchor($a);zb&&T.removeAnchor(zb);Fa&&T.removeMarker(Fa);ia.forEach(function(Cc){return T.removeAnchor(Cc.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};T&&T.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(T){var ia=[],Fa=0;Bb.string.reMatches(T,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function($a){var zb=
$a.start,Cc=$a.end;$a=$a.match;var Ba="";$a.startsWith("${")?(Ba=$jscomp.makeIterator($a.match(/^\$\{([0-9]+):([^\}]*)\}/)),Ba.next(),$a=Ba.next().value,Ba=Ba.next().value,$a=Number($a)):$a=Number($a.replace(/^\$/,""));T=T.slice(0,zb-Fa)+Ba+T.slice(Cc-Fa);ia[$a]={index:zb-Fa,prefill:Ba,anchor:null};Fa+=Cc-zb-Ba.length});return{steps:ia,expansion:T}}},{key:"expandAtCursor",value:function(T){var ia=T.selection,Fa=T.cursorPosition.column,$a=this.expansion;this.trigger&&(Fa-=this.trigger.length);if(Fa=
Math.max(0,Fa))$a=Bb.string.lines($a),$a=[$a[0]].concat($jscomp.arrayFromIterable($a.slice(1).map(function(Ec){return Bb.string.indent(Ec," ",Fa)}))),$a=$a.join("\n");var zb=this.createExpansionSteps($a);$a=zb.expansion;zb=zb.steps;this.trigger&&ia.growLeft(this.trigger.length);ia.text=$a;var Cc=ia.start;$a=ia.end;ia.collapseToEnd();if(zb.length){var Ba=Bb.string.newUUID();zb.forEach(function(Ec,fb){return Ec.anchor=T.addAnchor(Object.assign({id:"snippet-step-"+fb+"-"+Ba},Bb.addIndexToTextPos(T,Cc,
Ec.index)))});var Ca=T.addAnchor(Object.assign({id:"snippet-start-"+Ba},Cc,{insertBehavior:"stay"})),Nb=T.addAnchor(Object.assign({id:"snippet-end-"+Ba},$a));this.expansionState={marker:T.addMarker({id:"snippet-marker-"+Ba,get range(){return{start:Ca.position,end:Nb.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:Ca,endAnchor:Nb,stepIndex:0,steps:zb,isExpanding:!0};
T.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var T=this.expansionState,ia=T.steps,Fa=this.textMorph;if(T.isExpanding&&Fa){Fa=Fa.selection;T=ia[T.stepIndex];var $a=T.prefill;Fa.lead=Fa.anchor=T.anchor.position;Fa.growRight($a.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=ia.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(T,ia){ia=T.positionToIndex(T.cursorPosition);
return T.textString.slice(ia-this.trigger.length,ia)===this.trigger}},{key:"tryTrigger",value:function(T,ia){if(!this.canExpand(T,T.cursorPosition))return!1;this.expandAtCursor(T);return!0}},{key:"getCommands",value:function(T){var ia=this;return T.concat([{name:"[snippet] next expansion step",exec:function(Fa){ia.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(Fa){ia.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(T){return T.concat(Bb.KeyHandler.withBindings([{keys:"Tab",
command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],ha,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:357,end:6029})}(void 0);Bb.Snippet=ob;Bb.Snippet=ob;Bb.Snippet=
ob;var Va=[{name:"get snippets",exec:function(kb){return kb.pluginCollect("getSnippets",[])}}];Bb.snippetCommands=Va;Bb.snippetCommands=Va;Bb.snippetCommands=Va;var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");Ta.buildEvalOpts=function(kb,ha){return kb.plugins.find(function(Pa){return Pa.isJSEditorPlugin}).sanatizedJsEnv(ha)};Ta.Snippet=ob;Va=function(kb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Pa=ha.hasOwnProperty("ModuleTopLevelVarCompleter")&&
"function"===typeof ha.ModuleTopLevelVarCompleter?ha.ModuleTopLevelVarCompleter:ha.ModuleTopLevelVarCompleter=function(T){T&&T[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return tb(Pa,kb,[{key:"compute",value:function(T,ia){var Fa,$a,zb,Cc,Ba,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress){$a=(Fa=T.pluginFind(function(Ec){return Ec.isJSEditorPlugin}))&&Fa.systemInterface();if(!$a)return Nb.return([]);
zb=Ta.buildEvalOpts(T);Cc=zb.targetModule;return"local"===$a.name?(Ba=Object.getOwnPropertyNames($a.getModule(Cc).recorder),Nb.jumpTo(2)):Nb.yield($a.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+Cc+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',
{targetModule:"lively://module-recorder-completer"}),3)}if(2!=Nb.nextAddress){Ca=Nb.yieldResult;if(Ca.isError)return Nb.return([]);Ba=JSON.parse(Ca.value)}Ba=Ba.filter(function(Ec){return!Ec.startsWith("defVar_")&&!["System","__currentLivelyModule","initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(Ec)});return Nb.return(Ba.map(function(Ec){return{priority:1100,completion:Ec}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],
ha,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:227,end:1700})}(void 0);Ta.ModuleTopLevelVarCompleter=Va;Ta.ModuleTopLevelVarCompleter=Va;Ta.ModuleTopLevelVarCompleter=Va;Va=function(kb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Pa=ha.hasOwnProperty("DynamicJavaScriptCompleter")&&
"function"===typeof ha.DynamicJavaScriptCompleter?ha.DynamicJavaScriptCompleter:ha.DynamicJavaScriptCompleter=function(T){T&&T[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return tb(Pa,kb,[{key:"isValidPrefix",value:function(T){return/\.[a-z0-9_]*$/i.test(T)}},{key:"isMethodCallCompletion",value:function(T){return T.endsWith(")")&&0<T.indexOf("(")}},{key:"isValidIdentifier",value:function(T){if("string"!==typeof T)return!1;this.isMethodCallCompletion(T)&&
(T=T.slice(0,T.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(T)?!0:!1}},{key:"wrapInBrackets",value:function(T){if(!isNaN(Number(T))||T.startsWith("Symbol."))return"["+T+"]";var ia="";this.isMethodCallCompletion(T)&&(ia=T.slice(T.indexOf("(")),T=T.slice(0,T.indexOf("(")));return'["'+T.replace(/"/g,'\\"')+'"]'+ia}},{key:"compute",value:function(T){var ia=this,Fa,$a,zb,Cc,Ba,Ca,Nb,Ec,fb,td,Xd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ae){if(1==ae.nextAddress){Fa=T.selection;
Fa.isEmpty()?($a=T.getLine(Fa.lead.row),$a=$a.slice($a.lastIndexOf(":")+1,Fa.lead.column)):$a=Fa.text.slice(Math.max(0,Fa.text.indexOf(":")),0);if(!ia.isValidPrefix($a))return ae.return([]);Cc=(zb=T.pluginFind(function(Bf){return Bf.isJSEditorPlugin}))&&zb.systemInterface();if(!Cc)return ae.return([]);Ba=Ta.buildEvalOpts(T);return ae.yield(Cc.dynamicCompletionsForPrefix(Ba.targetModule,$a,Ba),2)}Ca=ae.yieldResult;Nb=Ca.isError;Ec=Ca.value;fb=Ca.completions;td=Ca.prefix;if(Nb)return console.warn("javascript completer encountered error: "+
(Ec.stack||Ec)),ae.return([]);fb.reduce(function(Bf,ie){ie=$jscomp.makeIterator(ie);ie.next();ie=ie.next().value;return Bf+ie.length},0);Xd=fb.reduce(function(Bf,ie,Zf){ie=$jscomp.makeIterator(ie);var Hg=ie.next().value;ie=ie.next().value;return Bf.concat(ie.map(function(Wc){var vc=ia.isValidIdentifier(Wc);return{info:Hg,completion:Wc,prefix:vc?td:"."+td,customInsertionFn:vc?ia.isMethodCallCompletion(Wc)?function(yf,tc,wb,uc){tc=uc.start;uc=uc.end;yf=yf.replace(/\((.*)\)/,function(Q){return"("+Q.slice(1,
-1).split(", ").map(function(Da,ib){return"${"+ib+":"+Da+"}"}).join(", ")+")"});yf=new Ta.Snippet({expansion:yf});wb.replace({start:tc,end:uc},"");yf.expandAtCursor(wb)}:null:function(yf,tc,wb,uc){yf=uc.start;uc=uc.end;tc={row:yf.row,column:yf.column-1};uc="."===wb.textInRange({start:tc,end:yf})?{start:tc,end:uc}:{start:yf,end:uc};wb.replace(uc,ia.wrapInBrackets(Wc))}}}))},[]);Xd.forEach(function(Bf,ie){return Object.assign(Bf,{priority:2E3+Xd.length-ie})});return ae.return(Xd)})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DynamicJavaScriptCompleter"}}],ha,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5085})}(void 0);Ta.DynamicJavaScriptCompleter=Va;Ta.DynamicJavaScriptCompleter=Va;Ta.DynamicJavaScriptCompleter=Va;Ta.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
Va=function(kb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Pa=ha.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof ha.JavaScriptKeywordCompleter?ha.JavaScriptKeywordCompleter:ha.JavaScriptKeywordCompleter=function(T){T&&T[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return tb(Pa,kb,[{key:"compute",value:function(T,ia){return Ta.keywords.map(function(Fa){return{completion:Fa,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],ha,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6087,end:6225})}(void 0);Ta.JavaScriptKeywordCompleter=Va;Ta.JavaScriptKeywordCompleter=Va;Ta.JavaScriptKeywordCompleter=Va;Va=[new Ta.DynamicJavaScriptCompleter,
new Ta.JavaScriptKeywordCompleter,new Ta.ModuleTopLevelVarCompleter];Ta.completers=Va;Ta.completers=Va;Ta.completers=Va;var xa=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");xa.Snippet=ob;var wa=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];xa.snippets=wa;xa.snippets=wa;xa.snippets=wa;var Qa=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");Qa.getEvalEnv=function(kb){return(kb=kb.pluginFind(function(ha){return ha.isJSEditorPlugin}))?kb.evalEnvironment:null};Qa.setEvalEnv=function(kb,ha){(kb=kb.pluginFind(function(Pa){return Pa.isJSEditorPlugin}))&&Object.assign(kb.evalEnvironment,ha);return kb.evalEnvironment};
Qa.pToI=function(kb,ha){return kb.positionToIndex(ha)};Qa.iToP=function(kb,ha){return kb.indexToPosition(ha)};Qa.arr=pe;Qa.promise=Ze;Qa.string=Uc;Qa.show=Bc;Qa.Range=Jd;Qa.query=Ab;Qa.BaseVisitor=Ff;xa=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(kb,ha){ha=void 0===ha?{varName:null,position:null}:ha;var Pa,T,ia,Fa,$a,zb,Cc,Ba,Ca,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){switch(Ec.nextAddress){case 1:Pa=
ha;T=Pa.varName;ia=Pa.position;if(!T){ia||(ia=kb.cursorPosition);Fa=kb.pluginInvokeFirst("getNavigator");$a=Fa.ensureAST(kb);zb=Qa.query.nodesAt(kb.positionToIndex(ia),$a).reverse().find(function(fb){return"Identifier"===fb.type});if(!zb)return kb.showError(Error("no identifier found!")),Ec.return(!0);T=zb.name}ha=kb.pluginFind(function(fb){return fb.isJSEditorPlugin}).sanatizedJsEnv();Cc='lively.modules.module("'+ha.targetModule+'").undefine("'+T+'")';Ec.setCatchFinallyBlocks(2);return Ec.yield(kb.doEval(null,
ha,Cc),4);case 4:Ba=Ec.yieldResult;Ca=Ba.error?Ba.error:Ba.isError?Ba.value:null;Ec.leaveTryBlock(3);break;case 2:Ca=Nb=Ec.enterCatchBlock();case 3:return Ca?kb.showError(Ca):kb.setStatusMessage(T+" undefined"),Ec.return(!0)}})}},{name:"change doitContext",exec:function(kb){var ha,Pa,T,ia,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){if(1==$a.nextAddress)return ha=$jscomp,Pa=ha.makeIterator,$a.yield(kb.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(zb){return!zb.isUsedAsEpiMorph()}}),2);T=Pa.call(ha,$a.yieldResult);if(ia=T.next().value)Fa="reset"===ia,kb.doitContext=Fa?null:ia,kb.setStatusMessage(Fa?"doitContext is now\n"+ia:"doitContext reset");return $a.return(!0)})}},{name:"change eval backend",exec:function(kb,ha){ha=void 0===ha?{backend:void 0}:ha;var Pa,T;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ia){if(1==ia.nextAddress)return Pa=ha,T=Pa.backend,void 0!==T?ia.jumpTo(2):
ia.yield(kb.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=ia.nextAddress&&(T=ia.yieldResult,!T))return kb.setStatusMessage("Canceled"),ia.return(!0);"local"===T&&(T=null);kb.setStatusMessage("Eval backend is now "+(T||"local"));return ia.return(Qa.setEvalEnv(kb,{remote:T}))})}},{name:"copy current module name to clipboard",exec:function(kb){var ha=kb.evalEnvironment.targetModule;kb.setStatusMessage(ha||"Cannot find module name");kb.env.eventDispatcher.killRing.add(kb);
kb.env.eventDispatcher.doCopy(ha);return!0}}];Qa.jsEditorCommands=xa;Qa.jsEditorCommands=xa;Qa.jsEditorCommands=xa;var Eb=[{name:"[javascript] list errors and warnings",exec:function(kb){var ha,Pa,T,ia,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){if(1==$a.nextAddress){ha=(kb.markers||[]).filter(function(zb){zb=zb.type;return"js-undeclared-var"===zb||"js-syntax-error"===zb});if(!ha.length)return Qa.show("no warnings or errors"),$a.return(!0);Pa=ha.map(function(zb){var Cc=zb.range;
return{isListItem:!0,string:"["+zb.type.split("-").slice(1).join(" ")+"] "+kb.textInRange(Cc),value:Cc}});return $a.yield(kb.world().filterableListPrompt("jump to warning or error",Pa),2)}T=$a.yieldResult;ia=$jscomp.makeIterator(T.selected);if(Fa=ia.next().value)kb.saveMark(),kb.selection=Fa,kb.centerRow(Fa.start.row);return $a.return(!0)})}},{name:"[javascript] inject import",exec:function(kb,ha){ha=void 0===ha?{gotoImport:!1,insertImportAtCursor:!0}:ha;var Pa,T,ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return Fa.yield(Qa.promise.delay(0),
2);case 2:return Fa.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return Pa=Fa.yieldResult,T=Pa.interactivelyInjectImportIntoText,Fa.yield(T(kb,ha),4);case 4:return(ia=Fa.yieldResult)||kb.setStatusMessage("canceled"),Fa.return(ia)}})}},{name:"[javascript] fix undeclared variables",exec:function(kb,ha){ha=void 0===ha?{ignore:[],autoApplyIfSingleChoice:!1,requester:kb}:ha;var Pa,T,ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){if(1==Fa.nextAddress)return Fa.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=Fa.nextAddress)return Pa=Fa.yieldResult,T=Pa.interactivlyFixUndeclaredVariables,Fa.yield(T(kb,ha),3);ia=Fa.yieldResult;kb.focus();return Fa.return(ia)})}},{name:"[javascript] remove unused imports",exec:function(kb,ha){ha=void 0===ha?{query:!0}:ha;var Pa,T,ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){if(1==Fa.nextAddress)return Fa.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=Fa.nextAddress)return Pa=Fa.yieldResult,T=Pa.cleanupUnusedImports,Fa.yield(T(kb,
ha),3);ia=Fa.yieldResult;kb.setStatusMessage(ia);return Fa.return(!0)})}},{name:"[javascript] eslint report",exec:function(kb){var ha,Pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){if(1==T.nextAddress)return T.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);ha=T.yieldResult;Pa=ha.default;try{return T.return(Pa.reportOnMorph(kb))}catch(ia){kb.showError(ia)}T.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(kb){var ha,Pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){if(1==
T.nextAddress)return T.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);ha=T.yieldResult;Pa=ha.default;try{return T.return(Pa.previewFixesOnMorph(kb))}catch(ia){kb.showError(ia)}T.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(kb,ha,Pa){function T(ae,Bf){Bf||(Bf=Ba(ae,{allowReturnOutsideFunction:!0}));var ie=Qa.string.lineRanges(ae),Zf=ae.split("\n"),Hg=[],Wc=new Qa.BaseVisitor,vc=Wc.visitVariableDeclaration;Wc.visitVariableDeclaration=function(uc,
Q,Da){if(1<uc.declarations.length)for(var ib=Qa.string.findLineWithIndexInLineRanges(ie,uc.start),Kb=uc.declarations[0].start-ie[ib][0],pc={},Wb=1;Wb<uc.declarations.length;pc={$jscomp$loop$prop$actionType$2707:pc.$jscomp$loop$prop$actionType$2707,$jscomp$loop$prop$arg$2708:pc.$jscomp$loop$prop$arg$2708},Wb++){var rd=uc.declarations[Wb],id=Qa.string.findLineWithIndexInLineRanges(ie,rd.start);if(ib!==id){var oe=Zf[id].match(/\s*/)[0].length;oe=Kb-oe;0!==oe&&(rd=Qa.string.findLineWithIndexInLineRanges(ie,
rd.end),pc.$jscomp$loop$prop$actionType$2707=0<oe?"insert":"delete",pc.$jscomp$loop$prop$arg$2708=0<oe?" ".repeat(oe):-oe,Hg.push.apply(Hg,$jscomp.arrayFromIterable(Qa.arr.range(id,rd).map(function(Tf){return function(Ce){return[Tf.$jscomp$loop$prop$actionType$2707,ie[Ce][0],Tf.$jscomp$loop$prop$arg$2708]}}(pc)))))}}return vc.call(Wc,uc,Q,Da)};Wc.accept(Bf,{},[]);for(Bf=Hg.length;Bf--;){var yf=$jscomp.makeIterator(Hg[Bf]),tc=yf.next().value,wb=yf.next().value;yf=yf.next().value;"insert"===tc?ae=ae.slice(0,
wb)+yf+ae.slice(wb):"delete"===tc&&(ae=ae.slice(0,wb)+ae.slice(wb+yf))}return ae}var ia,Fa,$a,zb,Cc,Ba,Ca,Nb,Ec,fb,td,Xd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ae){switch(ae.nextAddress){case 1:return ia=Pa||Math.floor(kb.width/kb.defaultCharExtent().width),ha=Object.assign({printWidth:ia,tabWidth:2,useTabs:!1,bracketSpacing:!1},ha),Fa=lively.modules.module,$a=System.normalizeSync("prettier/standalone.js"),ae.yield(Fa($a).load({format:"global",instrument:!1}),2);case 2:return zb=
ae.yieldResult,ae.yield(Fa("lively.ast/lib/acorn-extension.js").load(),3);case 3:return ae.yield(Fa("lively.ast").load(),4);case 4:return Cc=ae.yieldResult,Ba=Cc.parse,ae.yield(Fa("lively.ast/lib/query.js").load(),5);case 5:return ae.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return Ca=ae.yieldResult,Nb=kb.selection.isEmpty()?kb.documentRange:kb.selection.range,Ec=kb.positionToIndex(Nb.start),fb=kb.positionToIndex(Nb.end),td=zb.format(kb.textString,Object.assign({},
ha,{rangeStart:Ec,rangeEnd:fb,parser:function(Bf,ie,Zf){return Ba(Bf,{allowReturnOutsideFunction:!0})}})),kb.undoManager.group(),Xd=Ca.diffChars(kb.textString,td),kb.applyJsDiffPatch(Xd),kb.selection.text=T(kb.selection.text),kb.undoManager.group(),ae.return(!0)}})}}];Qa.jsIdeCommands=Eb;Qa.jsIdeCommands=Eb;Qa.jsIdeCommands=Eb;var rc=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(kb,ha){ha=kb.pluginInvokeFirst("getNavigator");if(!ha)return!0;ha=ha.resolveIdentifierAt(kb,kb.cursorPosition);
if(!ha||!ha.id)return Qa.show("No symbol identifier selected"),!0;if(!ha.decl)return Qa.show("Cannot find declaration of "+ha.name),!0;kb.saveMark();kb.selection={start:kb.indexToPosition(ha.decl.start),end:kb.indexToPosition(ha.decl.end)};kb.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(kb){kb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(kb){kb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(kb,ha){ha=void 0===ha?{direction:null}:ha;var Pa=kb.pluginInvokeFirst("getNavigator");if(!Pa)return!0;Pa=Pa.resolveIdentifierAt(kb,
kb.cursorPosition);if(!Pa||!Pa.refs)return Qa.show("No symbol identifier selected"),!0;var T=kb.selection;Pa=Pa.refs.map(function(Fa){var $a=Fa.end;return Qa.Range.fromPositions(Qa.iToP(kb,Fa.start),Qa.iToP(kb,$a))}).concat(Pa.decl?Qa.Range.fromPositions(Qa.iToP(kb,Pa.decl.start),Qa.iToP(kb,Pa.decl.end)):[]).sort(Qa.Range.compare);if(!Pa.length)return!0;var ia=Pa.map(String).indexOf(String(T.range));if("next"===ha.direction||"prev"===ha.direction)-1===ia&&Pa.length?Pa=[Pa[0]]:(ha=ia+("next"===ha.direction?
1:-1),0>ha?ha=Pa.length-1:ha>=Pa.length&&(ha=0),Pa=[Pa[ha]]);Pa.forEach(function(Fa){var $a=T.selections.findIndex(function(Cc){return Cc.range.equals(Fa)}),zb=T.selections.length-1;-1<$a?Qa.arr.swap(T.selections,$a,zb):T.addRange(Fa,!1)});T.mergeSelections();return!0}}];Qa.astEditorCommands=rc;Qa.astEditorCommands=rc;Qa.astEditorCommands=rc;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var qb=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
qb.expressionAllowed=function(kb,ha,Pa){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(ha.lastType)||"quasi"==ha.lastType&&/\{\s*$/.test(kb.string.slice(0,kb.pos-(Pa||0)))};qb.passIndent=Ae;qb.defineMode=Dc;qb.defineMIME=Mc;qb.registerHelper=bc;qb.defaultConfig={indentUnit:2};qb.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};qb.defineMode("javascript",
function(kb,ha){function Pa(Lb,bd,re){um=Lb;rk=re;return bd}function T(Lb,bd){var re=Lb.next();if('"'==re||"'"==re)return bd.tokenize=ia(re),bd.tokenize(Lb,bd);if("."==re&&Lb.match(/^\d+(?:[eE][+\-]?\d+)?/))return Pa("number","number");if("."==re&&Lb.match(".."))return Pa("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(re))return Pa(re);if("="==re&&Lb.eat(">"))return Pa("=>","operator");if("0"==re&&Lb.eat(/x/i))return Lb.eatWhile(/[\da-f]/i),Pa("number","number");if("0"==re&&Lb.eat(/o/i))return Lb.eatWhile(/[0-7]/i),
Pa("number","number");if("0"==re&&Lb.eat(/b/i))return Lb.eatWhile(/[01]/i),Pa("number","number");if(/\d/.test(re))return Lb.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),Pa("number","number");if("/"==re){if(Lb.eat("*"))return bd.tokenize=Fa,Fa(Lb,bd);if(Lb.eat("/"))return Lb.skipToEnd(),Pa("comment","comment");if(qb.expressionAllowed(Lb,bd,1)){a:for(var he=bd=!1;null!=(re=Lb.next());){if(!bd){if("/"==re&&!he)break a;"["==re?he=!0:he&&"]"==re&&(he=!1)}bd=!bd&&"\\"==re}Lb.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return Pa("regexp","string-2")}Lb.eatWhile(En);return Pa("operator","operator",Lb.current())}if("`"==re)return bd.tokenize=$a,$a(Lb,bd);if("#"==re)return Lb.skipToEnd(),Pa("error","error");if(En.test(re))return">"==re&&bd.lexical&&">"==bd.lexical.type||Lb.eatWhile(En),Pa("operator","operator",Lb.current());if(Dn.test(re))return Lb.eatWhile(Dn),Lb=Lb.current(),(re=Oo.propertyIsEnumerable(Lb)&&Oo[Lb])&&"."!=bd.lastType?Pa(re.type,re.style,Lb):Pa("variable","variable",Lb)}function ia(Lb){return function(bd,
re){var he=!1,bg;if(Qf&&"@"==bd.peek()&&bd.match(lm))return re.tokenize=T,Pa("jsonld-keyword","meta");for(;null!=(bg=bd.next())&&(bg!=Lb||he);)he=!he&&"\\"==bg;he||(re.tokenize=T);return Pa("string","string")}}function Fa(Lb,bd){for(var re=!1,he;he=Lb.next();){if("/"==he&&re){bd.tokenize=T;break}re="*"==he}return Pa("comment","comment")}function $a(Lb,bd){for(var re=!1,he;null!=(he=Lb.next());){if(!re&&("`"==he||"$"==he&&Lb.eat("{"))){bd.tokenize=T;break}re=!re&&"\\"==he}return Pa("quasi","string-2",
Lb.current())}function zb(Lb,bd){bd.fatArrowAt&&(bd.fatArrowAt=null);var re=Lb.string.indexOf("=>",Lb.start);if(!(0>re)){if(Al){var he=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Lb.string.slice(Lb.start,re));he&&(re=he.index)}he=0;var bg=!1;for(--re;0<=re;--re){var eh=Lb.string.charAt(re),Ek="([{}])".indexOf(eh);if(0<=Ek&&3>Ek){if(!he){++re;break}if(0==--he){"("==eh&&(bg=!0);break}}else if(3<=Ek&&6>Ek)++he;else if(Dn.test(eh))bg=!0;else{if(/["'\/]/.test(eh))return;if(bg&&!he){++re;break}}}bg&&
!he&&(bd.fatArrowAt=re)}}function Cc(Lb,bd,re,he,bg,eh){this.indented=Lb;this.column=bd;this.type=re;this.prev=bg;this.info=eh;null!=he&&(this.align=he)}function Ba(){for(var Lb=arguments.length-1;0<=Lb;Lb--)hf.cc.push(arguments[Lb])}function Ca(){Ba.apply(null,arguments);return!0}function Nb(Lb){function bd(he){for(;he;he=he.next)if(he.name==Lb)return!0;return!1}var re=hf.state;hf.marked="def";re.context?bd(re.localVars)||(re.localVars={name:Lb,next:re.localVars}):!bd(re.globalVars)&&ha.globalVars&&
(re.globalVars={name:Lb,next:re.globalVars})}function Ec(){hf.state.context={prev:hf.state.context,vars:hf.state.localVars};hf.state.localVars=vm}function fb(){hf.state.localVars=hf.state.context.vars;hf.state.context=hf.state.context.prev}function td(Lb,bd){var re=function(){var he=hf.state,bg=he.indented;if("stat"==he.lexical.type)bg=he.lexical.indented;else for(var eh=he.lexical;eh&&")"==eh.type&&eh.align;eh=eh.prev)bg=eh.indented;he.lexical=new Cc(bg,hf.stream.column(),Lb,null,he.lexical,bd)};
re.lex=!0;return re}function Xd(){var Lb=hf.state;Lb.lexical.prev&&(")"==Lb.lexical.type&&(Lb.indented=Lb.lexical.indented),Lb.lexical=Lb.lexical.prev)}function ae(Lb){function bd(re){return re==Lb?Ca():";"==Lb?Ba():Ca(bd)}return bd}function Bf(Lb,bd){return"var"==Lb?Ca(td("vardef",bd.length),xc,ae(";"),Xd):"keyword a"==Lb?Ca(td("form"),Hg,Bf,Xd):"keyword b"==Lb?Ca(td("form"),Bf,Xd):"{"==Lb?Ca(td("}"),of,Xd):";"==Lb?Ca():"if"==Lb?("else"==hf.state.lexical.info&&hf.state.cc[hf.state.cc.length-1]==
Xd&&hf.state.cc.pop()(),Ca(td("form"),Hg,Bf,Xd,Oa)):"function"==Lb?Ca(xb):"for"==Lb?Ca(td("form"),db,Bf,Xd):"variable"==Lb?Al&&"type"==bd?(hf.marked="keyword",Ca(gg,ae("operator"),gg,ae(";"))):Ca(td("stat"),rd):"switch"==Lb?Ca(td("form"),Hg,ae("{"),td("}","switch"),of,Xd,Xd):"case"==Lb?Ca(ie,ae(":")):"default"==Lb?Ca(ae(":")):"catch"==Lb?Ca(td("form"),Ec,ae("("),yc,ae(")"),Bf,Xd,fb):"class"==Lb?Ca(td("form"),ad,Xd):"export"==Lb?Ca(td("stat"),qg,Xd):"import"==Lb?Ca(td("stat"),Mh,Xd):"module"==Lb?Ca(td("form"),
Wh,ae("{"),td("}"),of,Xd,Xd):"async"==Lb?Ca(Bf):"@"==bd?Ca(ie,Bf):Ba(td("stat"),ie,ae(";"),Xd)}function ie(Lb){return Wc(Lb,!1)}function Zf(Lb){return Wc(Lb,!0)}function Hg(Lb){return"("!=Lb?Ba():Ca(td(")"),ie,ae(")"),Xd)}function Wc(Lb,bd){if(hf.state.fatArrowAt==hf.stream.start){var re=bd?ib:Da;if("("==Lb)return Ca(Ec,td(")"),$e(Wh,")"),Xd,ae("=>"),re,fb);if("variable"==Lb)return Ba(Ec,Wh,ae("=>"),re,fb)}re=bd?wb:tc;return Rh.hasOwnProperty(Lb)?Ca(re):"function"==Lb?Ca(xb,re):"class"==Lb?Ca(td("form"),
Yb,Xd):"keyword c"==Lb||"async"==Lb?Ca(bd?yf:vc):"("==Lb?Ca(td(")"),vc,ae(")"),Xd,re):"operator"==Lb||"spread"==Lb?Ca(bd?Zf:ie):"["==Lb?Ca(td("]"),cl,Xd,re):"{"==Lb?af(oe,"}",null,re):"quasi"==Lb?Ba(uc,re):"new"==Lb?Ca(Kb(bd)):Ca()}function vc(Lb){return Lb.match(/[;\}\)\],]/)?Ba():Ba(ie)}function yf(Lb){return Lb.match(/[;\}\)\],]/)?Ba():Ba(Zf)}function tc(Lb,bd){return","==Lb?Ca(ie):wb(Lb,bd,!1)}function wb(Lb,bd,re){var he=0==re?tc:wb,bg=0==re?ie:Zf;if("=>"==Lb)return Ca(Ec,re?ib:Da,fb);if("operator"==
Lb)return/\+\+|--/.test(bd)?Ca(he):"?"==bd?Ca(ie,ae(":"),bg):Ca(bg);if("quasi"==Lb)return Ba(uc,he);if(";"!=Lb){if("("==Lb)return af(Zf,")","call",he);if("."==Lb)return Ca(id,he);if("["==Lb)return Ca(td("]"),vc,ae("]"),Xd,he)}}function uc(Lb,bd){return"quasi"!=Lb?Ba():"${"!=bd.slice(bd.length-2)?Ca(uc):Ca(ie,Q)}function Q(Lb){if("}"==Lb)return hf.marked="string-2",hf.state.tokenize=$a,Ca(uc)}function Da(Lb){zb(hf.stream,hf.state);return Ba("{"==Lb?Bf:ie)}function ib(Lb){zb(hf.stream,hf.state);return Ba("{"==
Lb?Bf:Zf)}function Kb(Lb){return function(bd){return"."==bd?Ca(Lb?Wb:pc):Ba(Lb?Zf:ie)}}function pc(Lb,bd){if("target"==bd)return hf.marked="keyword",Ca(tc)}function Wb(Lb,bd){if("target"==bd)return hf.marked="keyword",Ca(wb)}function rd(Lb){return":"==Lb?Ca(Xd,Bf):Ba(tc,ae(";"),Xd)}function id(Lb){if("variable"==Lb)return hf.marked="property",Ca()}function oe(Lb,bd){if("async"==Lb)return hf.marked="property",Ca(oe);if("variable"==Lb||"keyword"==hf.style)return hf.marked="property","get"==bd||"set"==
bd?Ca(Tf):Ca(Ce);if("number"==Lb||"string"==Lb)return hf.marked=Qf?"property":hf.style+" property",Ca(Ce);if("jsonld-keyword"==Lb)return Ca(Ce);if("modifier"==Lb)return Ca(oe);if("["==Lb)return Ca(ie,ae("]"),Ce);if("spread"==Lb)return Ca(ie);if(":"==Lb)return Ba(Ce)}function Tf(Lb){if("variable"!=Lb)return Ba(Ce);hf.marked="property";return Ca(xb)}function Ce(Lb){if(":"==Lb)return Ca(Zf);if("("==Lb)return Ba(xb)}function $e(Lb,bd,re){function he(bg,eh){return(re?-1<re.indexOf(bg):","==bg)?(bg=hf.state.lexical,
"call"==bg.info&&(bg.pos=(bg.pos||0)+1),Ca(function(Ek,po){return Ek==bd||po==bd?Ba():Ba(Lb)},he)):bg==bd||eh==bd?Ca():Ca(ae(bd))}return function(bg,eh){return bg==bd||eh==bd?Ca():Ba(Lb,he)}}function af(Lb,bd,re){for(var he=3;he<arguments.length;he++)hf.cc.push(arguments[he]);return Ca(td(bd,re),$e(Lb,bd),Xd)}function of(Lb){return"}"==Lb?Ca():Ba(Bf,of)}function pd(Lb,bd){if(Al){if(":"==Lb)return Ca(gg);if("?"==bd)return Ca(pd)}}function gg(Lb){if("variable"==Lb)return hf.marked="variable-3",Ca(Ig);
if("string"==Lb||"number"==Lb||"atom"==Lb)return Ca(Ig);if("{"==Lb)return Ca(td("}"),$e(Nf,"}",",;"),Xd);if("("==Lb)return Ca($e(Ag,")"),Sf)}function Sf(Lb){if("=>"==Lb)return Ca(gg)}function Nf(Lb,bd){if("variable"==Lb||"keyword"==hf.style)return hf.marked="property",Ca(Nf);if("?"==bd)return Ca(Nf);if(":"==Lb)return Ca(gg)}function Ag(Lb){if("variable"==Lb)return Ca(Ag);if(":"==Lb)return Ca(gg)}function Ig(Lb,bd){if("<"==bd)return Ca(td(">"),$e(gg,">"),Xd,Ig);if("|"==bd||"."==Lb)return Ca(gg);if("["==
Lb)return Ca(ae("]"),Ig);if("extends"==bd)return Ca(gg)}function xc(){return Ba(Wh,pd,Bh,If)}function Wh(Lb,bd){if("modifier"==Lb)return Ca(Wh);if("variable"==Lb)return Nb(bd),Ca();if("spread"==Lb)return Ca(Wh);if("["==Lb)return af(Wh,"]");if("{"==Lb)return af(Di,"}")}function Di(Lb,bd){if("variable"==Lb&&!hf.stream.match(/^\s*:/,!1))return Nb(bd),Ca(Bh);"variable"==Lb&&(hf.marked="property");return"spread"==Lb?Ca(Wh):"}"==Lb?Ba():Ca(ae(":"),Wh,Bh)}function Bh(Lb,bd){if("="==bd)return Ca(Zf)}function If(Lb){if(","==
Lb)return Ca(xc)}function Oa(Lb,bd){if("keyword b"==Lb&&"else"==bd)return Ca(td("form","else"),Bf,Xd)}function db(Lb){if("("==Lb)return Ca(td(")"),Fb,ae(")"),Xd)}function Fb(Lb){return"var"==Lb?Ca(xc,ae(";"),Ma):";"==Lb?Ca(Ma):"variable"==Lb?Ca(ea):Ba(ie,ae(";"),Ma)}function ea(Lb,bd){return"in"==bd||"of"==bd?(hf.marked="keyword",Ca(ie)):Ca(tc,Ma)}function Ma(Lb,bd){return";"==Lb?Ca(lb):"in"==bd||"of"==bd?(hf.marked="keyword",Ca(ie)):Ba(ie,ae(";"),lb)}function lb(Lb){")"!=Lb&&Ca(ie)}function xb(Lb,
bd){if("*"==bd)return hf.marked="keyword",Ca(xb);if("variable"==Lb)return Nb(bd),Ca(xb);if("("==Lb)return Ca(Ec,td(")"),$e(yc,")"),Xd,pd,Bf,fb);if(Al&&"<"==bd)return Ca(td(">"),$e(gg,">"),Xd,xb)}function yc(Lb){return"spread"==Lb?Ca(yc):Ba(Wh,pd,Bh)}function Yb(Lb,bd){return"variable"==Lb?ad(Lb,bd):od(Lb,bd)}function ad(Lb,bd){if("variable"==Lb)return Nb(bd),Ca(od)}function od(Lb,bd){if("<"==bd)return Ca(td(">"),$e(gg,">"),Xd,od);if("extends"==bd||"implements"==bd||Al&&","==Lb)return Ca(Al?gg:ie,
od);if("{"==Lb)return Ca(td("}"),ed,Xd)}function ed(Lb,bd){if("variable"==Lb||"keyword"==hf.style){if(("async"==bd||"static"==bd||"get"==bd||"set"==bd||Al&&("public"==bd||"private"==bd||"protected"==bd||"readonly"==bd||"abstract"==bd))&&hf.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return hf.marked="keyword",Ca(ed);hf.marked="property";return Ca(Al?mf:xb,ed)}if("["==Lb)return Ca(ie,ae("]"),Al?mf:xb,ed);if("*"==bd)return hf.marked="keyword",Ca(ed);if(";"==Lb)return Ca(ed);if("}"==Lb)return Ca();if("@"==
bd)return Ca(ie,ed)}function mf(Lb,bd){return"?"==bd?Ca(mf):":"==Lb?Ca(gg,Bh):"="==bd?Ca(Zf):Ba(xb)}function qg(Lb,bd){return"*"==bd?(hf.marked="keyword",Ca(Bg,ae(";"))):"default"==bd?(hf.marked="keyword",Ca(ie,ae(";"))):"{"==Lb?Ca($e(Yf,"}"),Bg,ae(";")):Ba(Bf)}function Yf(Lb,bd){if("as"==bd)return hf.marked="keyword",Ca(ae("variable"));if("variable"==Lb)return Ba(Zf,Yf)}function Mh(Lb){return"string"==Lb?Ca():Ba(Ui,Fg,Bg)}function Ui(Lb,bd){if("{"==Lb)return af(Ui,"}");"variable"==Lb&&Nb(bd);"*"==
bd&&(hf.marked="keyword");return Ca(ph)}function Fg(Lb){if(","==Lb)return Ca(Ui,Fg)}function ph(Lb,bd){if("as"==bd)return hf.marked="keyword",Ca(Ui)}function Bg(Lb,bd){if("from"==bd)return hf.marked="keyword",Ca(ie)}function cl(Lb){return"]"==Lb?Ca():Ba($e(Zf,"]"))}kb=Object.assign({},qb.defaultConfig,{},kb);ha=Object.assign({},qb.defaultParserConfig,{},ha);var Rg=kb.indentUnit,sk=ha.statementIndent,Qf=ha.jsonld,Dk=ha.json||Qf,Al=ha.typescript,Dn=ha.wordCharacters||/[\w$\xa1-\uffff]/,Oo=function(){function Lb(po){return{type:po,
style:"keyword"}}var bd=Lb("keyword a"),re=Lb("keyword b"),he=Lb("keyword c"),bg=Lb("operator"),eh={type:"atom",style:"atom"};bd={if:Lb("if"),while:bd,with:bd,else:re,do:re,try:re,finally:re,return:he,break:he,continue:he,new:Lb("new"),delete:he,throw:he,debugger:he,var:Lb("var"),const:Lb("var"),let:Lb("var"),function:Lb("function"),catch:Lb("catch"),for:Lb("for"),switch:Lb("switch"),case:Lb("case"),default:Lb("default"),in:bg,typeof:bg,instanceof:bg,true:eh,false:eh,null:eh,undefined:eh,NaN:eh,Infinity:eh,
this:Lb("this"),class:Lb("class"),super:Lb("atom"),yield:he,export:Lb("export"),import:Lb("import"),extends:he,await:he,async:Lb("async")};if(Al){re={type:"variable",style:"variable-3"};he={interface:Lb("class"),implements:he,namespace:he,module:Lb("module"),enum:Lb("module"),public:Lb("modifier"),private:Lb("modifier"),protected:Lb("modifier"),abstract:Lb("modifier"),as:bg,string:re,number:re,boolean:re,any:re};for(var Ek in he)bd[Ek]=he[Ek]}return bd}(),En=/[+\-*&%=<>!?|~^@]/,lm=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
um,rk,Rh={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},hf={state:null,column:null,marked:null,cc:null},vm={name:"this",next:{name:"arguments"}};Xd.lex=!0;return{startState:function(Lb){Lb={tokenize:T,lastType:"sof",cc:[],lexical:new Cc((Lb||0)-Rg,0,"block",!1),localVars:ha.localVars,context:ha.localVars&&{vars:ha.localVars},indented:Lb||0};ha.globalVars&&"object"===typeof ha.globalVars&&(Lb.globalVars=ha.globalVars);return Lb},token:function(Lb,bd){Lb.sol()&&(bd.lexical.hasOwnProperty("align")||
(bd.lexical.align=!1),bd.indented=Lb.indentation(),zb(Lb,bd));if(bd.tokenize!=Fa&&Lb.eatSpace())return null;var re=bd.tokenize(Lb,bd);if("comment"==um)return re;bd.lastType="operator"!=um||"++"!=rk&&"--"!=rk?um:"incdec";a:{var he=um,bg=rk,eh=bd.cc;hf.state=bd;hf.stream=Lb;hf.marked=null;hf.cc=eh;hf.style=re;bd.lexical.hasOwnProperty("align")||(bd.lexical.align=!0);for(Lb=0;;){if(1E5<Lb++)throw Error("endless");if((eh.length?eh.pop():Dk?ie:Bf)(he,bg)){for(;eh.length&&eh[eh.length-1].lex;)eh.pop()();
if(hf.marked){re=hf.marked;break a}if(he="variable"==he)b:{for(he=bd.localVars;he;he=he.next)if(he.name==bg){he=!0;break b}for(bd=bd.context;bd;bd=bd.prev)for(he=bd.vars;he;he=he.next)if(he.name==bg){he=!0;break b}he=void 0}if(he){re="variable-2";break a}break a}}}return re},indent:function(Lb,bd){if(Lb.tokenize==Fa)return qb.passIndent;if(Lb.tokenize!=T)return 0;var re=bd&&bd.charAt(0),he=Lb.lexical,bg;if(!/^\s*else\b/.test(bd))for(var eh=Lb.cc.length-1;0<=eh;--eh){var Ek=Lb.cc[eh];if(Ek==Xd)he=
he.prev;else if(Ek!=Oa)break}for(;!("stat"!=he.type&&"form"!=he.type||"}"!=re&&(!(bg=Lb.cc[Lb.cc.length-1])||bg!=tc&&bg!=wb||/^[,\.=+\-*:?[\(]/.test(bd)));)he=he.prev;sk&&")"==he.type&&"stat"==he.prev.type&&(he=he.prev);bg=he.type;eh=re==bg;return(Ek=Lb._string)&&Ek.trimLeft().startsWith("?")&&":"===re?Ek.indexOf("?"):Ek&&":"===Lb.lastType&&"}"!==he.type?Ek.match(/^\s*/)[0].length:"vardef"==bg?(bd=he.indented+he.info+2+Lb.localVars.name.length,"?"===re||":"===re||"|"===re||"&"===re?bd:","==Lb.lastType?
he.indented+he.info+1:"operator"==Lb.lastType?bd+3:he.indented):"form"==bg&&"{"==re?he.indented:"form"==bg?he.indented+Rg:"stat"==bg?(re=he.indented,Lb="operator"==Lb.lastType||","==Lb.lastType||En.test(bd.charAt(0))||/[,.]/.test(bd.charAt(0)),re+(Lb?sk||Rg:0)):"switch"!=he.info||eh||0==ha.doubleIndentSwitch?he.align?he.column+(eh?0:1):he.indented+(eh?0:Rg):he.indented+(/^(?:case|default)\b/.test(bd)?Rg:2*Rg)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:Dk?null:"/*",blockCommentEnd:Dk?
null:"*/",lineComment:Dk?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:Dk?"json":"javascript",jsonldMode:Qf,jsonMode:Dk,expressionAllowed:qb.expressionAllowed,skipExpression:function(Lb){var bd=Lb.cc[Lb.cc.length-1];bd!=ie&&bd!=Zf||Lb.cc.pop()}}});qb.registerHelper("wordChars","javascript",/[\w$]/);qb.defineMIME("text/javascript","javascript");qb.defineMIME("text/ecmascript","javascript");qb.defineMIME("application/javascript","javascript");qb.defineMIME("application/x-javascript",
"javascript");qb.defineMIME("application/ecmascript","javascript");qb.defineMIME("application/json",{name:"javascript",json:!0});qb.defineMIME("application/x-json",{name:"javascript",json:!0});qb.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});qb.defineMIME("text/typescript",{name:"javascript",typescript:!0});qb.defineMIME("application/typescript",{name:"javascript",typescript:!0});var sb=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");sb.string=Uc;sb.JavaScriptChecker=
Kd;sb.JavaScriptNavigator=Rd;sb.completers=Va;sb.jsSnippets=wa;sb.jsIdeCommands=Eb;sb.jsEditorCommands=xa;sb.astEditorCommands=rc;sb.CodeMirrorEnabledEditorPlugin=Gc;sb.Snippet=ob;sb.parser=te;sb.localInterface=sd;sb.systemInterfaceNamed=le;sb.serverInterfaceFor=jc;sb.l2lInterfaceFor=je;Kd=function(kb){var ha=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),Pa=ha.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof ha.JavaScriptEditorPlugin?ha.JavaScriptEditorPlugin:ha.JavaScriptEditorPlugin=
function(T){T&&T[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return tb(Pa,kb,[{key:Symbol.for("lively-instance-initialize"),value:function(){tb._get(Object.getPrototypeOf(Pa.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new sb.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(T){tb._get(Object.getPrototypeOf(Pa.prototype),"attach",this).call(this,T);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:T})}},{key:"detach",value:function(T){this.checker.uninstall(this.textMorph);tb._get(Object.getPrototypeOf(Pa.prototype),"detach",this).call(this,T)}},{key:"getNavigator",value:function(){return new sb.JavaScriptNavigator}},{key:"getCompleters",value:function(T){return sb.completers.concat(T)}},
{key:"getCommands",value:function(T){return[].concat($jscomp.arrayFromIterable(tb._get(Object.getPrototypeOf(Pa.prototype),"getCommands",this).call(this,T)),$jscomp.arrayFromIterable(sb.jsIdeCommands),$jscomp.arrayFromIterable(sb.jsEditorCommands),$jscomp.arrayFromIterable(sb.astEditorCommands))}},{key:"getKeyBindings",value:function(T){return[].concat($jscomp.arrayFromIterable(T),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(T){var ia=this,Fa,$a,zb,Cc,Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ca){Fa=ia.textMorph;$a=[{command:"doit",target:Fa,showKeyShortcuts:!0},{command:"inspectit",target:Fa,showKeyShortcuts:!0},{command:"editit",target:Fa,showKeyShortcuts:!0},{command:"printit",target:Fa,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:Fa,showKeyShortcuts:!0},{command:"eval all",target:Fa,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:Fa,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:Fa,showKeyShortcuts:!0},{isDivider:!0}];ia.evalEnvironment.targetModule&&$a.push({command:"[javascript] inject import",alias:"add import",target:Fa},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:Fa},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:Fa});zb=ia.getNavigator();(Cc=zb.resolveIdentifierAt(Fa,
Fa.cursorPosition))&&$a.push({command:"selectDefinition",alias:'jump to definition of "'+Cc.name+'"',target:Fa},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+Cc.name+'"',target:Fa});(Ba=Fa.selection.text.trim())&&$a.push({command:"open code search",alias:'code search for "'+sb.string.truncate(Ba,30)+'"',target:Fa.world(),args:{input:Ba,backend:ia.backend()}});$a.push({isDivider:!0});return Ca.return($a.concat(T))})}},{key:"getSnippets",value:function(){return sb.jsSnippets.map(function(T){var ia=
$jscomp.makeIterator(T);T=ia.next().value;ia=ia.next().value;return new sb.Snippet({trigger:T,expansion:ia})})}},{key:"sanatizedJsEnv",value:function(T){T=Object.assign({},this.evalEnvironment,{},T);T.format||(T.formatd="esm");T.context||(T.context=this.textMorph);T.sourceURL||(T.sourceURL=T.targetModule+"_doit_"+Date.now());T.systemInterface||(T.systemInterface=sb.localInterface);return T}},{key:"backend",value:function(T){T=this.sanatizedJsEnv(T);return T.remote?T.remote:"local"}},{key:"systemInterface",
value:function(T){return this.sanatizedJsEnv(T).systemInterface||sb.localInterface}},{key:"setSystemInterface",value:function(T){return this.evalEnvironment.systemInterface=T}},{key:"setSystemInterfaceNamed",value:function(T){return this.setSystemInterface(sb.systemInterfaceNamed(T))}},{key:"runEval",value:function(T,ia){ia=this.sanatizedJsEnv(ia);return this.systemInterface(ia).runEval(T,ia)}},{key:"parser",get:function(){return sb.parser}},{key:"parse",value:function(T){T=void 0===T?null:T;if(this._ast&&
this._ast._astType===T)return this._ast;var ia=this.parser,Fa=this.textMorph.textString;if(!ia)return null;var $a={withComments:!0,allowReturnOutsideFunction:!0};T&&($a.type=T);if(Fa.startsWith("#!")){var zb=Fa.indexOf("\n");Fa=" ".repeat(zb)+Fa.slice(zb)}ia=ia.fuzzyParse(Fa,$a);ia._astType=T;return this._ast=ia}},{key:"undeclaredVariables",value:function(T){var ia=this.parser,Fa=this.evalEnvironment.knownGlobals||[];T=this.parse(void 0===T?null:T);return ia&&T?ia.query.findGlobalVarRefs(T,{jslintGlobalComment:!0}).filter(function($a){return!Fa.includes($a.name)}):
[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],ha,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(sb.CodeMirrorEnabledEditorPlugin);Kd=sb.JavaScriptEditorPlugin;Ha("default",Kd);sb.default=Kd}}});
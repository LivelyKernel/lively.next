System.register(["./__root_module__-64e296ea.js","kld-intersections"],function(Ba){var Ab,Qb,dc,Xb,Xd,ad,Nd,dd,Lc,rd,Gd,ke,Kd;return{setters:[function(Hc){Ab=Hc.bw;Qb=Hc.a6;dc=Hc.r;Xb=Hc.a7;Xd=Hc.bq;ad=Hc.bx;Nd=Hc.by;dd=Hc.U;Lc=Hc.s;rd=Hc.bz;Gd=Hc.bA;ke=Hc.n;Kd=Hc.bB},function(){}],execute:function(){function Hc(Q){try{var ha=eval("("+qb.ast.transform.wrapInFunction("var _; _ = ("+Q+")")+")()")}catch(Ga){return JSON.parse(Q)}return"object"!==typeof ha?null:ha}function fb(Q,ha){var Ga,La,Yb,kc,
Ua,ec,ge,ee,ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){switch(ab.nextAddress){case 1:return Ga=ha.world(),ab.yield(Ga.prompt("Enter package name",{requester:ha,input:"",historyId:"lively.vm-editor-add-package-name",useLastInput:!0}),2);case 2:La=ab.yieldResult;if(!La)throw"Canceled";ab.setCatchFinallyBlocks(3);kc=tb.resource(La);La=kc.name();Yb=kc.url;ab.leaveTryBlock(4);break;case 3:return ab.enterCatchBlock(),ab.yield(Q.getConfig(),5);case 5:return Ua=ab.yieldResult.baseURL,
ec=tb.resource(Ua).join(La).asDirectory().url,ab.yield(Q.normalize(ec),6);case 6:Yb=ab.yieldResult.replace(/\/\.js$/,"/");case 4:return ab.yield(Ga.prompt("Confirm or change package location",{requester:ha,input:Yb,historyId:"lively.vm-editor-add-package-address"}),7);case 7:ge=ab.yieldResult;if(!ge)throw"Canceled";ee=tb.resource(ge).asDirectory();ed=ee.asFile().url;return ab.yield(Q.removePackage(ed),8);case 8:return ab.yield(Q.resourceCreateFiles(ed,{"index.js":"'format esm';\n","package.json":'{\n  "name": "'+
La+'",\n  "version": "0.1.0"\n}',".gitignore":"node_modules/","README.md":"# "+La+"\n\nNo description for package "+La+" yet.\n",tests:{"test.js":'import { expect } from "mocha-es6";\ndescribe("'+La+'", () => {\n  it("works", () => {\n    expect(1 + 2).equals(3);\n  });\n});'}}),9);case 9:return ab.return(tb.loadPackage(Q,{name:La,address:ed,configFile:ee.join("package.json").url,main:ee.join("index.js").url,test:ee.join("tests/test.js").url,type:"package"}))}})}function Db(Q,ha,Ga){Ga=void 0===Ga?
null:Ga;var La,Yb,kc,Ua,ec,ge,ee;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ed){switch(ed.nextAddress){case 1:return La={name:"",address:"",type:"package"},ed.yield(Q.getConfig(),2);case 2:Yb=ed.yieldResult;if(!Ga){ed.jumpTo(3);break}return ed.yield(Q.getPackage(Ga),4);case 4:if(kc=ed.yieldResult){ed.jumpTo(5);break}return ed.yield(Q.getPackageForModule(Ga),6);case 6:kc=ed.yieldResult;case 5:Ua=kc;case 3:return ed.yield(ha.world().prompt("What is the package directory?",{requester:ha,
input:Ua?Ua.address:Yb.baseURL,historyId:"lively.vm-editor-package-load-history",useLastInput:!1}),7);case 7:ec=ed.yieldResult;if(!ec)throw"Canceled";La.address=ec.replace(/\/$/,"");La.url=new URL(La.address+"/");La.configFile=tb.resource(La.url).join("package.json").url;ed.setCatchFinallyBlocks(8);ge=JSON;ee=ge.parse;return ed.yield(Q.moduleRead(La.configFile),10);case 10:ee.call(ge,ed.yieldResult).name;ed.leaveTryBlock(9);break;case 8:ed.enterCatchBlock(),La.name=String(La.url).replace(/\/$/,""),
Q.resourceEnsureExistance(La.configFile,'{\n  "name": "'+La.name+'",\n  "version": "0.1.0"\n}');case 9:return ed.return(tb.loadPackage(Q,La))}})}function mc(Q,ha,Ga){var La,Yb,kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){switch(Ua.nextAddress){case 1:return La=tb.resource(Ga).asFile().url,Ua.yield(Q.getPackage(La),2);case 2:if(Yb=Ua.yieldResult){Ua.jumpTo(3);break}return Ua.yield(Q.getPackageForModule(La),4);case 4:Yb=Ua.yieldResult;case 3:kc=Yb;if(!kc)throw Error("Cannot find package for "+
La);return Ua.yield(Q.reloadPackage(La),5);case 5:if(!ha){Ua.jumpTo(0);break}return Ua.yield(ha.updateModuleList(),7);case 7:return Ua.yield(ha.uiSelect(La,!1),8);case 8:return Ua.return(Ua.yieldResult)}})}function hc(Q,ha,Ga,La){var Yb,kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){switch(Ua.nextAddress){case 1:return Ua.yield(Q.getPackage(Ga),2);case 2:return Yb=Ua.yieldResult,Ua.yield((La||$world).confirm("Unload package "+Yb.name+"?",{requester:ha}),3);case 3:kc=Ua.yieldResult;
if(!kc)throw"Canceled";return Ua.yield(Q.removePackage(Ga),4);case 4:if(!ha){Ua.jumpTo(0);break}return Ua.yield(ha.updateModuleList(),6);case 6:return Ua.yield(ha.uiSelect(null),0)}})}function Tc(Q,ha,Ga){var La,Yb,kc,Ua,ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ge){switch(ge.nextAddress){case 1:return La=ha.world(),ge.yield(Q.getPackage(Ga),2);case 2:return Yb=ge.yieldResult,Yb?ge.yield(La.confirm("Really remove package "+Yb.name+"?",{requester:ha}),3):($world.inform('No package "'+
Ga+'" found!',{requester:ha}),ge.return());case 3:kc=ge.yieldResult;if(!kc)throw"Canceled";Q.removePackage(Ga);return ge.yield(La.confirm("Also remove directory "+Yb.name+" including "+Yb.modules.length+" modules?"),4);case 4:Ua=ge.yieldResult;if(!Ua){ge.jumpTo(0);break}return ge.yield(La.confirm("REALLY *remove* directory "+Yb.name+"? No undo possible..."),6);case 6:if(ec=ge.yieldResult)return ge.yield(Q.resourceRemove(Yb.address),0);ge.jumpTo(0)}})}function Ld(Q,ha,Ga){Ga=void 0===Ga?$world:Ga;
var La,Yb,kc,Ua,ec,ge,ee,ed,ab,Rc,pb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bd){switch(bd.nextAddress){case 1:return bd.yield(Q.getPackage(ha),2);case 2:La=bd.yieldResult;if(!La)throw Error("Cannot find package "+ha);Yb=[];kc=$jscomp.makeIterator(La.modules);Ua=kc.next();case 3:if(Ua.done)return bd.yield(Ga.execCommand("open text window",{title:"imports and exports of "+ha,content:Yb.join("\n\n")}),0);ec=Ua.value;if(!ec.name.match(/\.js$/)){bd.jumpTo(4);break}bd.setCatchFinallyBlocks(6);
ge=Q;ee=ge.importsAndExportsOf;ed=ec.name;return bd.yield(Q.moduleRead(ec.name),9);case 9:return bd.yield(ee.call(ge,ed,bd.yieldResult),8);case 8:ab=bd.yieldResult;bd.leaveTryBlock(7);break;case 6:Rc=bd.enterCatchBlock();Ga.logError(Error("Error when getting imports/exports from module "+ec.name+":\n"+Rc.stack));bd.jumpTo(4);break;case 7:pb=""+ec.name;if(!ab.imports.length&&!ab.exports.length){pb+="\n  does not import / export anything";bd.jumpTo(4);break}ab.imports.length&&(pb+="\n  imports:\n",
pb+=tb.arr.groupByKey(ab.imports,"fromModule").mapGroups(function(od,lb){return"from "+od+": "+lb.map(function(Sa){return Sa.local||Sa.imported?Sa.imported&&Sa.imported!==Sa.local?Sa.imported+" as "+Sa.local:Sa.local:"nothing imported"}).join(", ")}).toArray().join("\n").split("\n").map(function(od){return"    "+od}).join("\n"));ab.exports.length&&(pb+="\n  exports:\n",pb+=ab.exports.map(function(od){return od.local?od.local&&od.local!==od.exported?od.local+" as "+od.exported:od.exported:od.exported+
" from "+od.fromModule}).join(", ").split("\n").map(function(od){return"    "+od}).join("\n"));Yb.push(pb);case 4:Ua=kc.next(),bd.jumpTo(3)}})}function oc(Q,ha,Ga){Ga=Ga&&Ga.address;if(Ga&&0===ha.indexOf(Ga))var La=ha.slice(Ga.length).replace(/^\//,"");else a:{Ga=Q.getConfig();if(!Ga||Ga.constructor!==Promise)try{La=String((new URL(ha)).relativePathFrom(new URL(Q.getConfig().baseURL)));break a}catch(Yb){}La=ha}return La}function pc(Q,ha,Ga,La){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yb){return 1==
Yb.nextAddress?(La=Object.assign({targetModule:ha},La),Yb.yield(Q.normalize(ha),2)):3!=Yb.nextAddress?(ha=Yb.yieldResult,Yb.yield(Q.moduleSourceChange(ha,Ga,La),3)):Yb.return(ha)})}function Nb(Q,ha,Ga,La,Yb){La=void 0===La?!1:La;Yb=void 0===Yb?!1:Yb;var kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){switch(Ua.nextAddress){case 1:return ha&&ha.setStatusMessage("Reloading "+Ga),Ua.setCatchFinallyBlocks(2),Ua.yield(Q.reloadModule(Ga,{reloadDeps:La,resetEnv:Yb}),4);case 4:if(!ha){Ua.jumpTo(5);
break}return Ua.yield(ha.updateModuleList(),6);case 6:case 5:ha&&ha.setStatusMessage("Reloded "+Ga);Ua.leaveTryBlock(0);break;case 2:kc=Ua.enterCatchBlock();Ua.setCatchFinallyBlocks(7);if(!ha){Ua.jumpTo(9);break}return Ua.yield(ha.updateEditorWithSourceOf(Ga),10);case 10:case 9:Ua.leaveTryBlock(8);break;case 7:Ua.enterCatchBlock();case 8:throw ha&&ha.showError(kc),kc;}})}function Dc(Q,ha,Ga){return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){switch(La.nextAddress){case 1:return La.yield(Q.forgetModule(Ga,
{forgetEnv:!0,forgetDeps:!0}),2);case 2:if(!ha){La.jumpTo(3);break}return La.yield(ha.updateModuleList(),4);case 4:case 3:La.jumpToEnd()}})}function Vc(Q,ha,Ga){var La,Yb,kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){switch(Ua.nextAddress){case 1:return Ua.yield(Q.normalize(Ga),2);case 2:return La=Ua.yieldResult,Ua.yield(ha.world().confirm("Remove file "+La+"?",{requester:ha}),3);case 3:Yb=Ua.yieldResult;if(!Yb)throw"Canceled";return Ua.yield(Q.forgetModule(La),4);case 4:return Ua.yield(Q.resourceRemove(La),
5);case 5:return Ua.yield(Q.getPackageForModule(La),6);case 6:return kc=Ua.yieldResult,Ua.return(kc)}})}function Hd(Q,ha,Ga){var La,Yb,kc,Ua,ec,ge,ee,ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){switch(ab.nextAddress){case 1:return La=URL,ab.yield(Q.getConfig(),2);case 2:Yb=new La(ab.yieldResult.baseURL);kc=ha.world();if(!Ga){ab.jumpTo(3);break}return ab.yield(Q.getPackage(Ga),4);case 4:if(Ua=ab.yieldResult){ab.jumpTo(5);break}return ab.yield(Q.getPackageForModule(Ga),6);case 6:Ua=
ab.yieldResult;case 5:(ec=Ua)&&(Yb=new URL(ec.address));case 3:return ab.yield(eb._searchForExistingFiles(ha,String(Yb),ec),7);case 7:ge=ab.yieldResult;if(!ge.includes("[create new module]")){ab.jumpTo(8);break}return ab.yield(eb._askForModuleName(Q,Ga||String(Yb),kc),9);case 9:ee=ab.yieldResult,ge=[ee];case 8:return ab.yield(eb._createAndLoadModules(Q,ge),10);case 10:return ed=ab.yieldResult,eb.arr.compact(ed.map(function(Rc){return Rc.error})),ab.return(ed)}})}function Id(Q,ha){var Ga,La,Yb,kc,
Ua,ec,ge,ee,ed,ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rc){if(1==Rc.nextAddress)return Rc.yield(Q.getPackage(ha),2);if(3!=Rc.nextAddress){Ga=Rc.yieldResult;if(!Ga||!Ga.address.match(/^http/))throw Error("Cannot load package "+ha);La=eb.resource(Ga.address);Yb=[];kc=$jscomp;Ua=kc.makeIterator;return Rc.yield(La.dirList(5,{exclude:eb.modulesInPackage_defaultExclude}),3)}ec=Ua.call(kc,Rc.yieldResult);for(ge=ec.next();!ge.done;ge=ec.next())ed=ee=ge.value,ab=ed.url,ab.match(/\.js$/)&&
Q.isModuleLoaded(ab,!0)&&Yb.push(Q.getModule(ab));return Rc.return(Yb)})}function rb(Q,ha){ha=void 0===ha?[]:ha;var Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){if(1==La.nextAddress)return La.yield(System.import("mocha-es6/index.js"),2);Ga=La.yieldResult;return La.return(Ga.loadTestModuleAndExtractTestState(Q,ha))})}function Hb(Q,ha,Ga,La){function Yb(Rc){return new Promise(function(pb,bd){var od=ob.arr.compact(Rc.suite.suites).map(function(Sa){return Sa.file}),lb=ob.chain(ha).filter(function(Sa){return od.includes(Sa.file)}).pluck("tests").flatten().value();
if(!lb||!lb.length)return bd(Error("Trying to run tests of "+od.join(", ")+" but cannot find them in loaded tests!"));Rc.reporter(function(Sa){Sa.on("test",function(qc){try{var le=lb.find(function(Zd){return Zd.fullTitle===qc.fullTitle()});le.state="running";"function"===typeof Ga&&Ga(le,"test")}catch(Zd){"function"===typeof La&&La(Zd,"test")}});Sa.on("pass",function(qc){try{var le=lb.find(function(Zd){return Zd.fullTitle===qc.fullTitle()});le.state="succeeded";le.duration=qc.duration;"function"===
typeof Ga&&Ga(le,"pass")}catch(Zd){"function"===typeof La&&La(Zd,"pass")}});Sa.on("fail",function(qc,le){try{var Zd=function(te,md,Eb){te.state="failed";te.duration=te.duration;te.error=md},Fe=lb.find(function(te){return te.fullTitle===qc.fullTitle()});if(Fe)Zd(Fe,le,qc.duration);else{var Oc=ob.arr.invoke(qc.parent.tests,"fullTitle");lb.filter(function(te){return Oc.includes(te.fullTitle)}).forEach(function(te){return Zd(te,le,qc.duration)})}"function"===typeof Ga&&Ga(Fe,"fail")}catch(te){"function"===
typeof La&&La(te,"fail")}})});Rc.run(function(Sa){return pb({testsByFile:ha,mocha:Rc})})})}var kc,Ua,ec,ge,ee,ed,ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rc){switch(Rc.nextAddress){case 1:kc=$jscomp.makeIterator(ha),Ua=kc.next();case 2:if(Ua.done){Rc.jumpTo(4);break}ge=ec=Ua.value;ee=ge.file;return Rc.yield(ob.loadMochaTestFile(ee,ha),5);case 5:return ed=Rc.yieldResult,ab=ed.mocha,Q&&(ab=ab.grep(Q)),Rc.yield(Yb(ab),3);case 3:Ua=kc.next();Rc.jumpTo(2);break;case 4:return Rc.return({mocha:ab,
testsByFile:ha})}})}function Mc(Q){Q||(Q="local");if(Q.isSystemInterface)var ha=Q;else"string"===typeof Q&&Q.startsWith("l2l ")&&(Q={type:"l2l",id:Q.split(" ")[1]}),"string"!==typeof Q&&"l2l"===Q.type&&(ha=rc.l2lInterfaceFor(Q.id,Q.info)),"string"!==typeof Q&&($world.setStatusMessage("Unknown system interface "+Q),Q="local"),ha||(ha=Q&&"local"!==Q?rc.serverInterfaceFor(Q):rc.localInterface);return ha}Ba("systemInterfaceNamed",Mc);var qb=lively.FreezerRuntime.recorderFor("lively-system-interface/helpers.js");
qb.parseJsonLikeObj=Hc;qb.ast=Ab;qb.parseJsonLikeObj=Hc;qb.parseJsonLikeObj=Hc;var tb=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/packages.js");tb.loadPackage=function(Q,ha){var Ga,La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yb){switch(Yb.nextAddress){case 1:return Yb.yield(Q.importPackage(ha.address+"/"),2);case 2:if(!ha.main){Yb.jumpTo(3);break}return Yb.yield(Q.importModule(ha.main.toString()),3);case 3:if(!ha.test){Yb.jumpTo(5);break}Yb.setCatchFinallyBlocks(6);
return Yb.yield(Q.importPackage("mocha-es6"),8);case 8:return Ga=Yb.yieldResult,Yb.yield(Ga.installSystemInstantiateHook(),9);case 9:return Yb.yield(Q.importModule(ha.test.toString()),10);case 10:Yb.leaveTryBlock(5);break;case 6:La=Yb.enterCatchBlock(),console.warn("Cannot load test of new package: "+La);case 5:return Yb.return(Q.getPackage(ha.address))}})};tb.interactivelyCreatePackage=fb;tb.interactivelyLoadPackage=Db;tb.interactivelyReloadPackage=mc;tb.interactivelyUnloadPackage=hc;tb.interactivelyRemovePackage=
Tc;tb.showExportsAndImportsOf=Ld;tb.parseJsonLikeObj=Hc;tb.arr=Qb;tb.resource=dc;tb.interactivelyCreatePackage=fb;tb.interactivelyCreatePackage=fb;tb.interactivelyLoadPackage=Db;tb.interactivelyLoadPackage=Db;tb.interactivelyReloadPackage=mc;tb.interactivelyReloadPackage=mc;tb.interactivelyUnloadPackage=hc;tb.interactivelyUnloadPackage=hc;tb.interactivelyRemovePackage=Tc;tb.interactivelyRemovePackage=Tc;tb.showExportsAndImportsOf=Ld;tb.showExportsAndImportsOf=Ld;var eb=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/modules.js");
eb.shortModuleName=oc;eb.interactivelyChangeModule=pc;eb.interactivelyReloadModule=Nb;eb.interactivelyUnloadModule=Dc;eb.interactivelyRemoveModule=Vc;eb.interactivelyAddModule=Hd;eb._askForModuleName=function(Q,ha,Ga){var La,Yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){switch(kc.nextAddress){case 1:return kc.yield(Ga.prompt("Enter module name",{input:ha,historyId:"lively.vm-editor-add-module-name"}),2);case 2:ha=kc.yieldResult;if(!ha)throw"Canceled";return kc.yield(Q.normalize(ha),
3);case 3:return La=kc.yieldResult,kc.yield(Ga.confirm(["Create module \n",{},La,{fontStyle:"italic"}," ?",{}],{lineWrapping:!1}),4);case 4:Yb=kc.yieldResult;if(!Yb)throw"Canceled";return kc.return(La)}})};eb._searchForExistingFiles=function(Q,ha,Ga){return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){return String(ha).match(/^http/)?La.return(eb._searchForExistingFilesWeb(Q,ha,Ga)):La.return(eb._searchForExistingFilesManually(Q,ha,Ga))})};eb._searchForExistingFilesManually=function(Q,
ha,Ga){var La,Yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){switch(kc.nextAddress){case 1:return kc.yield(Q.world().multipleChoicePrompt("Add Module",{requester:Q,choices:["Create New Module","Load Existing Module"]}),2);case 2:La=kc.yieldResult;if("Create New Module"===La)return kc.return("[create new module]");if("Load Existing Module"!==La){kc.jumpTo(3);break}return kc.yield(Q.world().prompt("URL of module?",{input:ha,requester:Q,historyId:"lively.vm._searchForExistingFilesManually.url-of-module"}),
4);case 4:if(Yb=kc.yieldResult)return kc.return([Yb]);case 3:throw"Canceled";}})};eb._searchForExistingFilesWeb=function(Q,ha,Ga){function La(ed){ed.name();return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes(ed.name())||Ga&&eb.arr.pluck(Ga.modules,"name").includes(ed.url)?!0:!1}var Yb,kc,Ua,ec,ge,ee;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ed){switch(ed.nextAddress){case 1:return(Yb=Q.world())&&(kc=Yb.showLoadingIndicatorFor(Q,"Loading existing modules...")),
ed.yield(eb.resource(ha).dirList(5,{exclude:La}),3);case 3:return ed.yield(ed.yieldResult.map(function(ab){return ab.url}),2);case 2:return Ua=ed.yieldResult,ec=[{isListItem:!0,string:"[create new module]",value:"[create new module]"}].concat(Ua.filter(function(ab){return ab.endsWith(".js")}).map(function(ab){return{isListItem:!0,string:Ga&&0==ab.indexOf(Ga.address)?Ga.name+ab.slice(Ga.address.length):ab,value:ab}})),ed.yield(Promise.resolve(kc&&kc.remove()).then(function(){return Q.world().filterableListPrompt("What module to load?",
ec,Object.assign({filterLabel:"filter: ",multiselect:!0,requester:Q},Q?{extent:Q.bounds().extent().withY(400).subXY(50,0)}:{}))}),4);case 4:ge=ed.yieldResult;if(!ge||"canceled"===ge.status||!ge.selected.length)throw"Canceled";ee=ge.selected||ge;Array.isArray(ee)||(ee=[ee]);return ed.return(ee)}})};eb._createAndLoadModules=function(Q,ha){var Ga,La,Yb,kc,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ec){switch(ec.nextAddress){case 1:Array.isArray(ha)||(ha=[ha]),Ga=[],La=$jscomp.makeIterator(ha),
Yb=La.next();case 2:if(Yb.done){ec.jumpTo(4);break}kc=Yb.value;return ec.yield(Q.forgetModule(kc,{forgetDeps:!1,forgetEnv:!1}),5);case 5:return ec.yield(Q.resourceEnsureExistance(kc,'"format esm";\n'),6);case 6:return ec.setCatchFinallyBlocks(7),ec.yield(Q.importModule(kc),9);case 9:Ga.push({name:kc});ec.leaveTryBlock(3);break;case 7:Ua=ec.enterCatchBlock(),Ga.push({name:kc,error:Ua});case 3:Yb=La.next();ec.jumpTo(2);break;case 4:return ec.return(Ga)}})};eb.modulesInPackage_defaultExclude=function(Q){return[".git",
"node_modules",".optimized-loading-cache",".module_cache"].includes(Q.name())?!0:!1};eb.modulesInPackage=Id;eb.obj=Xb;eb.arr=Qb;eb.resource=dc;eb.shortModuleName=oc;eb.shortModuleName=oc;eb.interactivelyChangeModule=pc;eb.interactivelyChangeModule=pc;eb.interactivelyReloadModule=Nb;eb.interactivelyReloadModule=Nb;eb.interactivelyUnloadModule=Dc;eb.interactivelyUnloadModule=Dc;eb.interactivelyRemoveModule=Vc;eb.interactivelyRemoveModule=Vc;eb.interactivelyAddModule=Hd;eb.interactivelyAddModule=Hd;
eb.modulesInPackage=Id;eb.modulesInPackage=Id;var ob=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/mocha-tests.js");ob.loadMochaTestFile=rb;ob.runMochaTests=Hb;ob.arr=Qb;ob.chain=Xd;ob.loadMochaTestFile=rb;ob.loadMochaTestFile=rb;ob.runMochaTests=Hb;ob.runMochaTests=Hb;var wb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/interface.js");wb.todo=function(Q){throw Error(Q+" is not yet implemented!");};wb.parseJsonLikeObj=Hc;wb.arr=Qb;wb.Closure=ad;wb.obj=
Xb;wb.resource=dc;wb.transform=Nd;wb.modules=dd;var cb=function(){};cb.prototype.dynamicCompletionsForPrefix=function(Q,ha,Ga){return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){wb.todo("dynamicCompletionsForPrefix");La.jumpToEnd()})};cb.prototype.runEval=function(Q,ha){wb.todo("runEval")};cb.prototype.resourceExists=function(Q){wb.todo("resourceExists")};cb.prototype.resourceEnsureExistance=function(Q,ha){wb.todo("resourceEnsureExistance")};cb.prototype.resourceMkdir=function(Q){wb.todo("resourceMkdir")};
cb.prototype.resourceRead=function(Q){wb.todo("resourceRead")};cb.prototype.resourceRemove=function(Q){wb.todo("resourceRemove")};cb.prototype.resourceWrite=function(Q,ha){wb.todo("resourceWrite")};cb.prototype.resourceCreateFiles=function(Q,ha){wb.todo("resourceCreateFiles")};cb.prototype.resourceDirList=function(Q,ha,Ga){wb.todo("resourceDirList")};cb.prototype.normalizeSync=function(Q,ha,Ga){wb.todo("normalizeSync")};cb.prototype.normalize=function(Q,ha,Ga){wb.todo("normalize")};cb.prototype.printSystemConfig=
function(){wb.todo("printSystemConfig")};cb.prototype.getConfig=function(){wb.todo("getConfig")};cb.prototype.setConfig=function(Q){wb.todo("setConfig")};cb.prototype.getPackages=function(Q){wb.todo("getPackages")};cb.prototype.isModuleLoaded=function(Q,ha){wb.todo("isModuleLoaded")};cb.prototype.doesModuleExist=function(Q,ha){wb.todo("doesModuleExist")};cb.prototype.getModules=function(){var Q=this,ha,Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){return 1==La.nextAddress?(ha=
wb.arr,Ga=ha.flatmap,La.yield(Q.getPackages(),2)):La.return(Ga.call(ha,La.yieldResult,function(Yb){return Yb.modules}))})};cb.prototype.getModule=function(Q){var ha=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){return 1==Ga.nextAddress?Ga.yield(ha.getModules(),2):Ga.return(Ga.yieldResult.find(function(La){return La.name===Q}))})};cb.prototype.getPackage=function(Q){var ha=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){return 1==Ga.nextAddress?(Q=Q.replace(/\/+$/,
""),Ga.yield(ha.getPackages(),2)):Ga.return(Ga.yieldResult.find(function(La){return La.address===Q||La.name===Q}))})};cb.prototype.getPackageForModule=function(Q){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){wb.todo("getPackageForModule");ha.jumpToEnd()})};cb.prototype.systemConfChange=function(Q){var ha=wb.parseJsonLikeObj(Q);["baseURL"].forEach(function(Ga){return delete ha[Ga]});return this.setConfig(ha)};cb.prototype.resourcesOfPackage=function(Q,ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){wb.todo("resourcesOfPackage");
Ga.jumpToEnd()})};cb.prototype.registerPackage=function(Q){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){wb.todo("registerPackage");ha.jumpToEnd()})};cb.prototype.importPackage=function(Q){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){wb.todo("importPackage");ha.jumpToEnd()})};cb.prototype.removePackage=function(Q){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){wb.todo("removePackage");ha.jumpToEnd()})};cb.prototype.reloadPackage=function(Q){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){wb.todo("reloadPackage");
ha.jumpToEnd()})};cb.prototype.packageConfChange=function(Q,ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){wb.todo("packageConfChange");Ga.jumpToEnd()})};cb.prototype.importModule=function(Q){wb.todo("importModule")};cb.prototype.forgetModule=function(Q,ha){wb.todo("forgetModule")};cb.prototype.reloadModule=function(Q,ha){wb.todo("reloadModule")};cb.prototype.moduleFormat=function(Q){wb.todo("moduleFormat")};cb.prototype.moduleRead=function(Q){wb.todo("moduleRead")};cb.prototype.moduleSourceChange=
function(Q,ha,Ga){wb.todo("moduleSourceChange")};cb.prototype.importsAndExportsOf=function(Q,ha){wb.todo("importsAndExportsOf")};cb.prototype.keyValueListOfVariablesInModule=function(Q,ha){wb.todo("keyValueListOfVariablesInModule")};cb.prototype.moduleWrite=function(Q,ha){return this.moduleSourceChange(Q,ha)};wb.AbstractCoreInterface=cb;var Oa=function(){var Q=wb.AbstractCoreInterface.call(this)||this;Q.currentEval=null;return Q};$jscomp.inherits(Oa,wb.AbstractCoreInterface);Oa.prototype.runEval=
function(Q,ha){throw Error("Not yet implemented");};Oa.prototype.runEvalAndStringify=function(Q,ha){var Ga=this;return this.currentEval?this.currentEval.then(function(){return Ga.runEvalAndStringify(Q,ha)}):this.currentEval=Promise.resolve().then(function(){var La,Yb,kc,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ec){switch(ec.nextAddress){case 1:return ec.yield(Ga.runEval("\n        Promise.resolve((async "+wb.transform.wrapInFunction(Q)+')())\n          .then(function(result) { return JSON.stringify(result); })\n          .catch(function(err) { return {isError: true, value: err}; })\n          .then(function(result) {\n            if (!result || typeof result === "string") return result;\n            return JSON.stringify(result.isError ?\n              {isError: true, value: (result.value + "\\n" + result.value.stack) || String(result.value)} :\n              result)\n          });',
Object.assign({targetModule:"lively://remote-lively-system/runEvalAndStringify",promiseTimeout:3E4,waitForPromise:!0},ha)),2);case 2:if((La=ec.yieldResult)&&La.isError)throw Error(String(La.value||La.error));if(!La||!La.value)return ec.return(null);if(Yb=La.promisedValue){ec.jumpTo(3);break}return ec.yield(La.value,4);case 4:Yb=ec.yieldResult;case 3:kc=Yb;if(!kc)return ec.return();if("undefined"===kc)return ec.return(void 0);if("null"===kc)return ec.return(null);if("true"===kc)return ec.return(!0);
if("false"===kc)return ec.return(!1);try{Ua=JSON.parse(kc)}catch(ge){return ec.return(kc)}if(Ua&&Ua.isError)throw Error(String(Ua.value));return ec.return(Ua)}})}).then(function(La){delete Ga.currentEval;return La},function(La){delete Ga.currentEval;return Promise.reject(La)})};Oa.prototype.dynamicCompletionsForPrefix=function(Q,ha,Ga){var La=this,Yb,kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){Yb=wb.obj.isString(Ga.context)?Ga.context:!1;Ga=wb.obj.dissoc(Ga,["systemInterface",
"System","context"]);kc="\n      var prefix = "+JSON.stringify(ha)+",\n          opts = "+JSON.stringify(Ga)+";\n      opts.context = "+Yb+';\n      opts.classTransform = (await System.import("lively.classes")).classToFunctionTransform;\n      var evalFn = code => lively.vm.runEval(code, opts);\n      if (typeof System === "undefined") delete opts.targetModule;\n      lively.vm.completions.getCompletions(evalFn, prefix).then(function(result) {\n        if (result.isError) throw result.value;\n        return {\n          completions: result.completions,\n          prefix: result.startLetters\n        }\n      });';
return Ua.return(La.runEvalAndStringify(kc))})};Oa.prototype.evalWithResource=function(Q,ha,Ga){return this.runEvalAndStringify('\n      var {resource} = (typeof lively !== "undefined" && lively.resources)\n                    || await System.import("lively.resources");\n      await resource("'+Q+'").'+ha+"("+(Ga?JSON.stringify(Ga):"")+");\n    ")};Oa.prototype.resourceExists=function(Q){return this.evalWithResource(Q,"exists")};Oa.prototype.resourceEnsureExistance=function(Q,ha){return this.evalWithResource(Q,
"ensureExistance",ha)};Oa.prototype.resourceMkdir=function(Q){return this.evalWithResource(Q,"mkdir")};Oa.prototype.resourceRead=function(Q){return this.evalWithResource(Q,"read")};Oa.prototype.resourceRemove=function(Q){return this.evalWithResource(Q,"remove")};Oa.prototype.resourceWrite=function(Q,ha){return this.evalWithResource(Q,"write",ha)};Oa.prototype.resourceCreateFiles=function(Q,ha){return this.runEvalAndStringify('var {createFiles} = await System.import("lively.resources"); await createFiles("'+
Q+'", '+JSON.stringify(ha)+")")};Oa.prototype.resourceDirList=function(Q,ha,Ga){return this.runEvalAndStringify('\n      var {resource} = await System.import("lively.resources");\n      (await resource("'+Q+'").dirList('+JSON.stringify(ha)+", "+JSON.stringify(Ga)+"))\n        .map(({url}) => ({url}))")};Oa.prototype.livelySystemAccessor=function(Q){Q=void 0===Q?"livelySystem":Q;return"var "+Q+' = (typeof lively !== "undefined" && lively.systemInterface)\n      || System.get(System.decanonicalize("lively-system-interface"))\n      || (typeof lively !== "undefined" && lively.modules && await lively.modules.importPackage("lively-system-interface"));\n    if (!'+
Q+') throw new Error("lively-system-interface not available!");'};Oa.prototype.normalizeSync=function(Q,ha,Ga){return this.runEvalAndStringify("lively.modules.System.decanonicalize("+JSON.stringify(Q)+", "+JSON.stringify(ha)+", "+Ga+")")};Oa.prototype.normalize=function(Q,ha,Ga){return this.runEvalAndStringify("lively.modules.System.normalize("+JSON.stringify(Q)+", "+JSON.stringify(ha)+", "+JSON.stringify(Ga)+")")};Oa.prototype.printSystemConfig=function(){return this.runEvalAndStringify("lively.modules.printSystemConfig()")};
Oa.prototype.getConfig=function(){return this.runEvalAndStringify('var c = Object.assign({}, lively.modules.System.getConfig()); for (var name in c) if (name.indexOf("__lively.modules__") === 0 || name.indexOf("loads") === 0) delete c[name]; c')};Oa.prototype.setConfig=function(Q){return this.runEvalAndStringify("lively.modules.System.config("+JSON.stringify(Q)+")")};Oa.prototype.getPackages=function(Q){Q=Object.assign({excluded:[]},Q);Q.excluded=Q.excluded.map(String);return this.runEvalAndStringify("\n      "+
this.livelySystemAccessor()+";\n      var options = "+JSON.stringify(Q)+';\n      options.excluded = options.excluded.map(ea => {\n        let evaled = lively.vm.syncEval(ea).value;\n        return typeof evaled === "function" ? evaled : ea;\n      });\n      await livelySystem.localInterface.getPackages(options)\n        .map(ea => Object.assign({}, ea, {System: null}));')};Oa.prototype.getPackageForModule=function(Q){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.getPackageForModule("+
JSON.stringify(Q)+")")};Oa.prototype.isModuleLoaded=function(Q,ha){return this.runEvalAndStringify('lively.modules.isModuleLoaded("'+Q+'", '+ha+")")};Oa.prototype.doesModuleExist=function(Q,ha){return this.runEvalAndStringify('lively.modules.doesModuleExist("'+Q+'", '+ha+")")};Oa.prototype.registerPackage=function(Q){var ha=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){return Ga.return(ha.runEvalAndStringify("lively.modules.registerPackage("+JSON.stringify(Q)+")"))})};Oa.prototype.importPackage=
function(Q){var ha=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){return Ga.return(ha.runEvalAndStringify("lively.modules.importPackage("+JSON.stringify(Q)+")"))})};Oa.prototype.removePackage=function(Q){var ha=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){return Ga.return(ha.runEvalAndStringify("lively.modules.removePackage("+JSON.stringify(Q)+")"))})};Oa.prototype.reloadPackage=function(Q,ha){var Ga=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){return La.return(Ga.runEvalAndStringify("lively.modules.reloadPackage("+
JSON.stringify(Q)+", "+JSON.stringify(ha)+")"))})};Oa.prototype.packageConfChange=function(Q,ha){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.packageConfChange("+JSON.stringify(Q)+", "+JSON.stringify(ha)+")")};Oa.prototype.resourcesOfPackage=function(Q,ha){ha=void 0===ha?[".git","node_modules",".module_cache","lively.next-node_modules"]:ha;var Ga=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){Q.address&&(Q=
Q.address);return La.return(Ga.runEvalAndStringify("\n      "+Ga.livelySystemAccessor()+";\n      await livelySystem.localInterface.resourcesOfPackage("+JSON.stringify(Q)+", "+JSON.stringify(ha)+");"))})};Oa.prototype.getModule=function(Q){var ha=this,Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){if(1==La.nextAddress)return La.yield(ha.getModules(),2);Ga=La.yieldResult.find(function(Yb){return Yb.name===Q});return La.return(Ga?wb.modules.module(Ga.name):null)})};Oa.prototype.importModule=
function(Q){return this.runEvalAndStringify("lively.modules.System.import("+JSON.stringify(Q)+")")};Oa.prototype.forgetModule=function(Q,ha){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(Q)+").unload("+JSON.stringify(ha)+")")};Oa.prototype.reloadModule=function(Q,ha){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(Q)+").reload("+JSON.stringify(ha)+")")};Oa.prototype.moduleFormat=function(Q){return this.runEvalAndStringify("lively.modules.module("+
JSON.stringify(Q)+").format();")};Oa.prototype.moduleRead=function(Q){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(Q)+").source()")};Oa.prototype.moduleSourceChange=function(Q,ha,Ga){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(Q)+").changeSource("+JSON.stringify(ha)+", "+JSON.stringify(Ga)+")")};Oa.prototype.keyValueListOfVariablesInModule=function(Q,ha){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.keyValueListOfVariablesInModule("+
JSON.stringify(Q)+", "+JSON.stringify(ha)+")")};Oa.prototype.importsAndExportsOf=function(Q,ha){return this.runEvalAndStringify("({\n      imports: await lively.modules.module("+JSON.stringify(Q)+").imports(),\n      exports: await lively.modules.module("+JSON.stringify(Q)+").exports()})")};Oa.prototype.exportsOfModules=function(Q){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+"\n      const options = "+JSON.stringify(Q)+";\n      options.excludedPackages = ["+Q.excludedPackages.map(function(ha){return"function"===
typeof ha?ha.toString():JSON.stringify(ha)}).join(",")+"]\n      await livelySystem.localInterface.exportsOfModules(options)")};Oa.prototype.searchInPackage=function(Q,ha,Ga){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.searchInPackage("+JSON.stringify(Q)+", "+JSON.stringify(ha)+", "+JSON.stringify(Ga)+")")};Oa.prototype.loadMochaTestFile=function(Q,ha){ha=void 0===ha?[]:ha;var Ga=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){return La.return(Ga.runEvalAndStringify("\n      "+
Ga.livelySystemAccessor()+";\n      var {testsByFile} = await livelySystem.localInterface.loadMochaTestFile("+JSON.stringify(Q)+", "+JSON.stringify(ha)+"), result;\n      result = {testsByFile}"))})};Oa.prototype.runMochaTests=function(Q,ha,Ga,La){var Yb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){Q&&Q instanceof RegExp&&(Q={isRegExp:!0,value:String(Q).replace(/^\/|\/$/g,"")});return kc.return(Yb.runEvalAndStringify("\n      var grep = "+JSON.stringify(Q)+";\n      if (grep && grep.isRegExp) grep = new RegExp(grep.value);\n      "+
Yb.livelySystemAccessor()+";\n      var {testsByFile, isError, value: error} = await livelySystem.localInterface.runMochaTests(grep, "+JSON.stringify(ha||[])+"), result;\n      error = error ? String(error.stack || error) : null;\n      if (testsByFile) {\n        testsByFile.forEach(ea =>\n          ea.tests.forEach(ea => {\n            if (!ea.error) return;\n            var {message, stack, actual, expected} = ea.error;\n            ea.error = {\n              message: message || String(ea.error),\n              stack: stack,\n              actual, exected\n            }\n          }));\n      }\n      result = {testsByFile, isError, error}"))})};
wb.RemoteCoreInterface=Oa;var Gb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/local-system.js");Gb.obj=Xb;Gb.string=Lc;Gb.arr=Qb;Gb.resource=dc;Gb.createFiles=rd;Gb.ast=Ab;Gb.modules=dd;Gb.vm=Gd;Gb.loadMochaTestFile=rb;Gb.runMochaTests=Hb;Gb.parseJsonLikeObj=Hc;Gb.AbstractCoreInterface=cb;Gb.classToFunctionTransform=ke;cb=function(){return Gb.AbstractCoreInterface.apply(this,arguments)||this};$jscomp.inherits(cb,Gb.AbstractCoreInterface);cb.prototype.dynamicCompletionsForPrefix=
function(Q,ha,Ga){var La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yb){if(1==Yb.nextAddress)return Yb.yield(Gb.vm.completions.getCompletions(function(kc){return Gb.vm.runEval(kc.replace("return ",""),Object.assign({targetModule:Q,classTransform:Gb.classToFunctionTransform},Ga))},ha),2);La=Yb.yieldResult;if(La.isError)throw La.value;return Yb.return({completions:La.completions,prefix:La.startLetters})})};cb.prototype.runEval=function(Q,ha){return Gb.vm.runEval(Q,Object.assign({classTransform:Gb.classToFunctionTransform},
ha))};cb.prototype.resourceExists=function(Q){return Gb.resource(Q).exists()};cb.prototype.resourceEnsureExistance=function(Q,ha){return Gb.resource(Q).ensureExistance(ha)};cb.prototype.resourceMkdir=function(Q){return Gb.resource(Q).mkdir()};cb.prototype.resourceRead=function(Q){return Gb.resource(Q).read()};cb.prototype.resourceRemove=function(Q){return Gb.resource(Q).remove()};cb.prototype.resourceWrite=function(Q,ha){return Gb.resource(Q).write(ha)};cb.prototype.resourceCreateFiles=function(Q,
ha){return Gb.createFiles(Q,ha)};cb.prototype.resourceDirList=function(Q,ha,Ga){return Gb.resource(Q).dirList(ha,Ga)};cb.prototype.normalizeSync=function(Q,ha,Ga){return System.decanonicalize(Q,ha,Ga)};cb.prototype.normalize=function(Q,ha,Ga){return System.normalize(Q,ha,Ga)};cb.prototype.printSystemConfig=function(){return Gb.modules.printSystemConfig()};cb.prototype.getConfig=function(){return System.getConfig()};cb.prototype.setConfig=function(Q){Gb.modules.System.config(Q)};cb.prototype.getPackages=
function(Q){Q=Object.assign({},Q);Q=void 0===Q.excluded?[]:Q.excluded;var ha=Q.filter(function(La){return"string"===typeof La}),Ga=Q.filter(function(La){return"function"===typeof La});ha=ha.concat(ha.map(function(La){return System.decanonicalize(La.replace(/\/?$/,"/")).replace(/\/$/,"")}));return Gb.modules.getPackages().filter(function(La){return!ha.includes(La.url)&&!Ga.some(function(Yb){return Yb(La.url)})})};cb.prototype.registerPackage=function(Q){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){return ha.return(Gb.modules.registerPackage(Q))})};
cb.prototype.importPackage=function(Q){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){return ha.return(Gb.modules.importPackage(Q))})};cb.prototype.removePackage=function(Q){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){return ha.return(Gb.modules.removePackage(Q))})};cb.prototype.reloadPackage=function(Q,ha){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){return Ga.return(Gb.modules.reloadPackage(Q,ha))})};cb.prototype.packageConfChange=function(Q,
ha){var Ga=this,La,Yb,kc,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ec){if(1==ec.nextAddress)return La=Gb.modules.System,Yb=Gb.parseJsonLikeObj(Q),kc=JSON.stringify(Yb,null,2),ec.yield(Gb.modules.module(ha).changeSource(kc,{doEval:!1}),2);if(3!=ec.nextAddress)return La.set(ha,La.newModule(Yb)),ec.yield(Ga.getPackageForModule(ha),3);(Ua=ec.yieldResult)&&Gb.modules.applyPackageConfig(Yb,Ua.address);ec.jumpToEnd()})};cb.prototype.resourcesOfPackage=function(Q,ha){ha=void 0===ha?[".git",
"node_modules",".module_cache"]:ha;var Ga,La,Yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){if(1==kc.nextAddress)return kc.setCatchFinallyBlocks(2),Ga=Q.address?Q.address:Q,La=Gb.modules.getPackage(Ga),kc.yield(La.resources(void 0,ha),4);if(2!=kc.nextAddress)return kc.return(kc.yieldResult.map(function(Ua){return Object.assign(Ua,{package:Ua.package.url})}));Yb=kc.enterCatchBlock();console.warn("resourcesOfPackage error for "+Q+": "+Yb);return kc.return([])})};cb.prototype.getPackageForModule=
function(Q){return(Q=Gb.modules.getPackageOfModule(Q))?Q.asSpec():Q};cb.prototype.isModuleLoaded=function(Q,ha){return Gb.modules.isModuleLoaded(Q,ha)};cb.prototype.doesModuleExist=function(Q,ha){return Gb.modules.isModuleLoaded(Q,ha)};cb.prototype.getModule=function(Q){return Gb.modules.module(Q)};cb.prototype.importModule=function(Q){return Gb.modules.System.import(Q)};cb.prototype.forgetModule=function(Q,ha){return Gb.modules.module(Q).unload(ha)};cb.prototype.reloadModule=function(Q,ha){return Gb.modules.module(Q).reload(ha)};
cb.prototype.moduleFormat=function(Q){return Gb.modules.module(Q).format()};cb.prototype.moduleRead=function(Q){return Gb.modules.module(Q).source()};cb.prototype.moduleSourceChange=function(Q,ha,Ga){return Gb.modules.module(Q).changeSource(ha,Ga)};cb.prototype.keyValueListOfVariablesInModule=function(Q,ha){var Ga=this,La,Yb,kc,Ua,ec,ge,ee,ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){switch(ab.nextAddress){case 1:if(ha){ab.jumpTo(2);break}return ab.yield(Ga.resourceRead(Q),3);
case 3:ha=ab.yieldResult;case 2:return La="string"===typeof ha?Gb.ast.parse(ha):ha,Yb=Ga.normalizeSync(Q),Ga.moduleFormat(Yb),kc=Gb.modules.module(Yb).env().recorder,ab.yield(Ga.importsAndExportsOf(Yb,La),4);case 4:return Ua=ab.yieldResult,ec=Gb.ast.query.topLevelDeclsAndRefs(La),ge=Gb.arr.sortByKey(Gb.ast.query.declarationsOfScope(ec.scope,!0),"start"),ee=Gb.arr.pluck(ec.scope.importSpecifiers,"name"),ed=0,ab.return(ge.map(function(Rc){var pb=Rc.name.length,bd=Ua.exports.find(function(lb){return lb.local===
Rc.name}),od=Gb.arr.include(ee,Rc.name);bd&&(pb+=9);od&&(pb+=9);ed=Math.max(ed,pb);return{isExport:bd,isImport:od,name:Rc.name,value:kc[Rc.name],node:Rc,printedName:Rc.name+(bd?" [export]":"")+(od?" [import]":""),printedValue:Gb.obj.inspect(kc[Rc.name],{maxDepth:1}).replace(/\n/g,"")}}).map(function(Rc){return{isListItem:!0,value:Rc,string:Rc.printedName+Gb.string.indent(" = "+Rc.printedValue," ",ed-Rc.printedName.length)}}))}})};cb.prototype.importsAndExportsOf=function(Q,ha){var Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){return 1==
La.nextAddress?La.yield(Gb.modules.module(Q).imports(ha),2):3!=La.nextAddress?(Ga=La.yieldResult,La.yield(Gb.modules.module(Q).exports(ha),3)):La.return({imports:Ga,exports:La.yieldResult})})};cb.prototype.exportsOfModules=function(Q){return Gb.modules.ExportLookup.run(System,Q)};cb.prototype.searchInPackage=function(Q,ha,Ga){return Gb.modules.getPackage(Q).search(ha,Ga)};cb.prototype.runMochaTests=function(Q,ha,Ga,La){return Gb.runMochaTests(Q,ha,Ga,La)};cb.prototype.loadMochaTestFile=function(Q,
ha){return Gb.loadMochaTestFile(Q,ha)};$jscomp.global.Object.defineProperties(cb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"local"}}});Gb.LocalCoreInterface=cb;var sc=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/http-interface.js");sc.evalStrategies=Kd;sc.RemoteCoreInterface=Oa;var vc=function(Q){var ha=sc.RemoteCoreInterface.call(this)||this;ha.currentEval=null;ha.url=Q;ha.server=new sc.evalStrategies.HttpEvalStrategy(Q);return ha};$jscomp.inherits(vc,
sc.RemoteCoreInterface);vc.prototype.runEval=function(Q,ha){return this.server.runEval(Q,ha)};$jscomp.global.Object.defineProperties(vc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this.url}},description:{configurable:!0,enumerable:!0,get:function(){return this.url.replace(/^https?:\/\//,"")}}});sc.HTTPCoreInterface=vc;var fc=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/l2l-interface.js");fc.evalStrategies=Kd;fc.RemoteCoreInterface=Oa;Oa=function(Q,
ha){var Ga=fc.RemoteCoreInterface.call(this)||this;Ga.targetId=Q;Ga.peer=ha;return Ga};$jscomp.inherits(Oa,fc.RemoteCoreInterface);Oa.prototype.isConnected=function(){var Q=this,ha,Ga,La,Yb,kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return ha=Q,Ga=ha.client,La=ha.targetId,Ua.yield(Ga.sendToAndWait(Ga.trackerId,"getClients",{}),2);Yb=Ua.yieldResult;kc=Yb.data;return Ua.return(kc.some(function(ec){ec=$jscomp.makeIterator(ec).next().value;return La===ec}))})};
Oa.prototype.runEval=function(Q,ha){var Ga=this,La,Yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){La=Ga.client;if(!La)throw Error("No lively.2lively default client available!");Yb=new fc.evalStrategies.L2LEvalStrategy(La,Ga.targetId);return kc.return(Yb.runEval(Q,ha))})};$jscomp.global.Object.defineProperties(Oa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"l2l "+this.targetId}},description:{configurable:!0,enumerable:!0,get:function(){var Q=this.peer,ha=
"l2l "+this.targetId.slice(0,5);if(Q){var Ga=Q.location,La=Q.type,Yb=Q.user;Q=Q.world;La&&(ha+=", "+La);Ga&&(ha+=", "+Ga.replace(/^https?:\/\//,"")+(Q?"/"+Q:""));Yb&&(ha+=", "+Yb.name)}return ha}},client:{configurable:!0,enumerable:!0,get:function(){return(lively.modules.module("lively.2lively/client.js").get()||{default:lively.l2l.L2LClient}).default.default()}}});fc.L2LCoreInterface=Oa;var rc=lively.FreezerRuntime.recorderFor("lively-system-interface/index.js");rc.systemInterfaceNamed=Mc;rc.interactivelyCreatePackage=
fb;rc.interactivelyLoadPackage=Db;rc.interactivelyReloadPackage=mc;rc.interactivelyUnloadPackage=hc;rc.interactivelyRemovePackage=Tc;rc.showExportsAndImportsOf=Ld;rc.shortModuleName=oc;rc.interactivelyChangeModule=pc;rc.interactivelyReloadModule=Nb;rc.interactivelyUnloadModule=Dc;rc.interactivelyRemoveModule=Vc;rc.interactivelyAddModule=Hd;rc.modulesInPackage=Id;rc.LocalCoreInterface=cb;rc.HTTPCoreInterface=vc;rc.L2LCoreInterface=Oa;Oa=function(Q){this.coreInterface=Q};Oa.prototype.dynamicCompletionsForPrefix=
function(Q,ha,Ga){return this.coreInterface.dynamicCompletionsForPrefix(Q,ha,Ga)};Oa.prototype.runEval=function(Q,ha){return this.coreInterface.runEval(Q,ha)};Oa.prototype.printSystemConfig=function(Q,ha,Ga){return this.coreInterface.printSystemConfig(Q,ha,Ga)};Oa.prototype.getConfig=function(Q,ha,Ga){return this.coreInterface.getConfig(Q,ha,Ga)};Oa.prototype.getPackages=function(Q){return this.coreInterface.getPackages(Q)};Oa.prototype.getModules=function(Q,ha,Ga){return this.coreInterface.getModules(Q,
ha,Ga)};Oa.prototype.getModule=function(Q,ha,Ga){return this.coreInterface.getModule(Q,ha,Ga)};Oa.prototype.getPackage=function(Q,ha,Ga){return this.coreInterface.getPackage(Q,ha,Ga)};Oa.prototype.getPackageForModule=function(Q,ha,Ga){return this.coreInterface.getPackageForModule(Q,ha,Ga)};Oa.prototype.resourcesOfPackage=function(Q,ha){return this.coreInterface.resourcesOfPackage(Q,ha)};Oa.prototype.systemConfChange=function(Q,ha,Ga){return this.coreInterface.systemConfChange(Q,ha,Ga)};Oa.prototype.registerPackage=
function(Q){return this.coreInterface.registerPackage(Q)};Oa.prototype.importPackage=function(Q){return this.coreInterface.importPackage(Q)};Oa.prototype.removePackage=function(Q){return this.coreInterface.removePackage(Q)};Oa.prototype.reloadPackage=function(Q){return this.coreInterface.reloadPackage(Q)};Oa.prototype.packageConfChange=function(Q,ha){return this.coreInterface.packageConfChange(Q,ha)};Oa.prototype.keyValueListOfVariablesInModule=function(Q,ha){return this.coreInterface.keyValueListOfVariablesInModule(Q,
ha)};Oa.prototype.interactivelyCreatePackage=function(Q){return rc.interactivelyCreatePackage(this.coreInterface,Q)};Oa.prototype.interactivelyLoadPackage=function(Q,ha){return rc.interactivelyLoadPackage(this.coreInterface,Q,ha)};Oa.prototype.interactivelyReloadPackage=function(Q,ha){return rc.interactivelyReloadPackage(this.coreInterface,Q,ha)};Oa.prototype.interactivelyUnloadPackage=function(Q,ha,Ga){return rc.interactivelyUnloadPackage(this.coreInterface,Q,ha,Ga)};Oa.prototype.interactivelyRemovePackage=
function(Q,ha){return rc.interactivelyRemovePackage(this.coreInterface,Q,ha)};Oa.prototype.isModuleLoaded=function(Q,ha){return this.coreInterface.isModuleLoaded(Q,ha)};Oa.prototype.doesModuleExist=function(Q,ha){return this.coreInterface.doesModuleExist(Q,ha)};Oa.prototype.importModule=function(Q){return this.coreInterface.importModule(Q)};Oa.prototype.forgetModule=function(Q,ha){return this.coreInterface.forgetModule(Q,ha)};Oa.prototype.reloadModule=function(Q,ha){return this.coreInterface.reloadModule(Q,
ha)};Oa.prototype.moduleFormat=function(Q){return this.coreInterface.moduleFormat(Q)};Oa.prototype.moduleRead=function(Q){return this.coreInterface.moduleRead(Q)};Oa.prototype.moduleWrite=function(Q,ha){return this.coreInterface.moduleWrite(Q,ha)};Oa.prototype.getModulesInPackage=function(Q){return rc.modulesInPackage(this.coreInterface,Q)};Oa.prototype.shortModuleName=function(Q,ha){return rc.shortModuleName(this.coreInterface,Q,ha)};Oa.prototype.interactivelyChangeModule=function(Q,ha,Ga){return rc.interactivelyChangeModule(this.coreInterface,
Q,ha,Ga)};Oa.prototype.interactivelyReloadModule=function(Q,ha){return rc.interactivelyReloadModule(this.coreInterface,Q,ha)};Oa.prototype.interactivelyUnloadModule=function(Q,ha){return rc.interactivelyUnloadModule(this.coreInterface,Q,ha)};Oa.prototype.interactivelyRemoveModule=function(Q,ha){return rc.interactivelyRemoveModule(this.coreInterface,Q,ha)};Oa.prototype.interactivelyAddModule=function(Q,ha){return rc.interactivelyAddModule(this.coreInterface,Q,ha)};Oa.prototype.showExportsAndImportsOf=
function(Q,ha){return rc.showExportsAndImportsOf(this.coreInterface,Q,ha)};Oa.prototype.exportsOfModules=function(Q){return this.coreInterface.exportsOfModules(Q)};Oa.prototype.searchInPackage=function(Q,ha,Ga){return this.coreInterface.searchInPackage(Q,ha,Ga)};Oa.prototype.searchInAllPackages=function(Q,ha){ha=void 0===ha?{}:ha;var Ga=this,La,Yb,kc,Ua,ec,ge,ee,ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){switch(ab.nextAddress){case 1:return(La=ha.progress)&&La.step("Fetching Packages...",
0),ab.yield(Ga.coreInterface.getPackages({excluded:ha.excludedPackages}),2);case 2:Yb=ab.yieldResult,kc=[],La&&La.step("Fetching Packages...",.1),Ua=0;case 3:if(!(Ua<Yb.length)){ab.jumpTo(5);break}ec=Yb[Ua];ge=ec.url;if(!ge||"no group"===ge){ab.jumpTo(4);break}La&&La.step(ge.replace(System.baseURL,"").slice(0,20),.1+Ua/Yb.length*.9);ab.setCatchFinallyBlocks(6);return ab.yield(Ga.coreInterface.searchInPackage(ge,Q,ha),8);case 8:ee=ab.yieldResult;kc=kc.concat(ee);ab.leaveTryBlock(4);break;case 6:ed=
ab.enterCatchBlock(),console.error("Error searching in package "+ge+":\n"+ed.stack);case 4:Ua++;ab.jumpTo(3);break;case 5:return ab.return(kc)}})};Oa.prototype.loadMochaTestFile=function(Q,ha){return this.coreInterface.loadMochaTestFile(Q,ha)};Oa.prototype.runMochaTests=function(Q,ha,Ga,La){return this.coreInterface.runMochaTests(Q,ha,Ga,La)};$jscomp.global.Object.defineProperties(Oa.prototype,{isSystemInterface:{configurable:!0,enumerable:!0,get:function(){return!0}},name:{configurable:!0,enumerable:!0,
get:function(){return this.coreInterface.name}}});Ba("Interface",Oa);rc.Interface=Oa;rc.systemInterfaceNamed=Mc;rc.systemInterfaceNamed=Mc;Oa=Ba("localInterface",new rc.Interface(new rc.LocalCoreInterface));rc.localInterface=Oa;rc.localInterface=Oa;rc.localInterface=Oa;rc.httpInterfaces={};Oa=Ba("serverInterfaceFor",function(Q){return rc.httpInterfaces[Q]||(rc.httpInterfaces[Q]=new rc.Interface(new rc.HTTPCoreInterface(Q)))});rc.serverInterfaceFor=Oa;rc.serverInterfaceFor=Oa;rc.serverInterfaceFor=
Oa;rc.l2lInterfaces={};Oa=Ba("l2lInterfaceFor",function(Q,ha){return rc.l2lInterfaces[Q]||(rc.l2lInterfaces[Q]=new rc.Interface(new rc.L2LCoreInterface(Q,ha)))});rc.l2lInterfaceFor=Oa;rc.l2lInterfaceFor=Oa;rc.l2lInterfaceFor=Oa}}});
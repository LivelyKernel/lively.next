System.register(["./__root_module__-aefa9179.js","kld-intersections"],function(Da){var Bb,Qb,hc,ac,be,bd,Sd,ed;return{setters:[function(Mc){Bb=Mc.s;Qb=Mc.$;hc=Mc.bl;ac=Mc.bm;be=Mc.at;bd=Mc.a7;Sd=Mc.bn;ed=Mc.ap},function(){}],execute:function(){function Mc(R,ia){var Ea={};ia.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(sb,Zb,Vc){Zb&&(Ea[Zb]=Vc)});return Ea}function pd(R){R=String(R);if(!(100<R.length)&&(R=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(R))){var ia=
parseFloat(R[1]);switch((R[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return ia*Tc;case "days":case "day":case "d":return ia*Pe;case "hours":case "hour":case "hrs":case "hr":case "h":return 36E5*ia;case "minutes":case "minute":case "mins":case "min":case "m":return 6E4*ia;case "seconds":case "second":case "secs":case "sec":case "s":return 1E3*ia;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return ia}}}function Dd(R,ia,Ea){if(!(R<ia))return R<
1.5*ia?Math.floor(R/ia)+" "+Ea:Math.ceil(R/ia)+" "+Ea+"s"}function ke(R){var ia=0,Ea;for(Ea in R)ia=(ia<<5)-ia+R.charCodeAt(Ea),ia|=0;return Nb.colors[Math.abs(ia)%Nb.colors.length]}function Kd(R){function ia(){if(ia.enabled){var sb=+new Date;ia.diff=sb-(Ea||sb);ia.prev=Ea;Ea=ia.curr=sb;var Zb=Array(arguments.length);for(sb=0;sb<Zb.length;sb++)Zb[sb]=arguments[sb];Zb[0]=Nb.coerce(Zb[0]);"string"!==typeof Zb[0]&&Zb.unshift("%O");var Vc=0;Zb[0]=Zb[0].replace(/%([a-zA-Z%])/g,function(Yd,ce){if("%%"===
Yd)return Yd;Vc++;ce=Nb.formatters[ce];"function"===typeof ce&&(Yd=ce.call(ia,Zb[Vc]),Zb.splice(Vc,1),Vc--);return Yd});Nb.formatArgs.call(ia,Zb);(ia.log||Nb.log||console.log.bind(console)).apply(ia,Zb)}}var Ea;ia.namespace=R;ia.enabled=Nb.enabled(R);ia.useColors=Nb.useColors();ia.color=ke(R);ia.destroy=jd;"function"===typeof Nb.init&&Nb.init(ia);Nb.instances.push(ia);return ia}function jd(){var R=Nb.instances.indexOf(this||Ed);return-1!==R?(Nb.instances.splice(R,1),!0):!1}function cb(){try{var R=
Ba.storage.debug}catch(ia){}!R&&"undefined"!==typeof Mb&&"env"in Mb&&(R=Mb.env.DEBUG);return R}function Ab(R){if(R){for(var ia in Ab.prototype)R[ia]=Ab.prototype[ia];return R}}function Yb(R,ia){if(!R)return R;if(qg(R)){var Ea={_placeholder:!0,num:ia.length};ia.push(R);return Ea}if(Af(R)){Ea=Array(R.length);for(var sb=0;sb<R.length;sb++)Ea[sb]=Yb(R[sb],ia);return Ea}if("object"===typeof R&&!(R instanceof Date)){Ea={};for(sb in R)Ea[sb]=Yb(R[sb],ia);return Ea}return R}function gc(R,ia){if(!R)return R;
if(R&&R._placeholder)return ia[R.num];if(Af(R))for(var Ea=0;Ea<R.length;Ea++)R[Ea]=gc(R[Ea],ia);else if("object"===typeof R)for(Ea in R)R[Ea]=gc(R[Ea],ia);return R}function dd(){}function Zd(R){var ia=""+R.type;if(Cb.BINARY_EVENT===R.type||Cb.BINARY_ACK===R.type)ia+=R.attachments+"-";R.nsp&&"/"!==R.nsp&&(ia+=R.nsp+",");null!=R.id&&(ia+=R.id);if(null!=R.data){try{var Ea=JSON.stringify(R.data)}catch(sb){Ea=!1}if(!1!==Ea)ia+=Ea;else return nb}ba("encoded %j as %s",R,ia);return ia}function Wb(R,ia){Ka.removeBlobs(R,
function(Ea){var sb=Ka.deconstructPacket(Ea);Ea=Zd(sb.packet);sb=sb.buffers;sb.unshift(Ea);ia(sb)})}function oc(){(this||ab).reconstructor=null}function Lb(R){(this||ab).reconPack=R;(this||ab).buffers=[]}function Bc(R){if(!R||"object"!==typeof R)return!1;if(Zf(R)){for(var ia=0,Ea=R.length;ia<Ea;ia++)if(Bc(R[ia]))return!0;return!1}if("function"===typeof Ye&&Ye.isBuffer&&Ye.isBuffer(R)||"function"===typeof ArrayBuffer&&R instanceof ArrayBuffer||Hi&&R instanceof Blob||Nh&&R instanceof File)return!0;
if(R.toJSON&&"function"===typeof R.toJSON&&1===arguments.length)return Bc(R.toJSON(),!0);for(ia in R)if(Object.prototype.hasOwnProperty.call(R,ia)&&Bc(R[ia]))return!0;return!1}function Sc(){}function Yc(R){return R.map(function(ia){if(ia.buffer instanceof ArrayBuffer){var Ea=ia.buffer;if(ia.byteLength!==Ea.byteLength){var sb=new Uint8Array(ia.byteLength);sb.set(new Uint8Array(Ea,ia.byteOffset,ia.byteLength));Ea=sb.buffer}return Ea}return ia})}function Xb(R,ia){ia=ia||{};var Ea=new Zj;Yc(R).forEach(function(sb){Ea.append(sb)});
return ia.type?Ea.getBlob(ia.type):Ea.getBlob()}function qb(R,ia){return new Blob(Yc(R),ia||{})}function uc(R){for(var ia=[],Ea=0,sb=R.length,Zb,Vc;Ea<sb;)Zb=R.charCodeAt(Ea++),55296<=Zb&&56319>=Zb&&Ea<sb?(Vc=R.charCodeAt(Ea++),56320==(Vc&64512)?ia.push(((Zb&1023)<<10)+(Vc&1023)+65536):(ia.push(Zb),Ea--)):ia.push(Zb);return ia}function Hc(R,ia){if(55296<=R&&57343>=R){if(ia)throw Error("Lone surrogate U+"+R.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function Ia(){if(te>=
qd)throw Error("Invalid byte index");var R=Tb[te]&255;te++;if(128==(R&192))return R&63;throw Error("Invalid continuation byte");}function Va(R){if(te>qd)throw Error("Invalid byte index");if(te==qd)return!1;var ia=Tb[te]&255;te++;if(0==(ia&128))return ia;if(192==(ia&224)){var Ea=Ia();ia=(ia&31)<<6|Ea;if(128<=ia)return ia;throw Error("Invalid continuation byte");}if(224==(ia&240)){Ea=Ia();var sb=Ia();ia=(ia&15)<<12|Ea<<6|sb;if(2048<=ia)return Hc(ia,R)?ia:65533;throw Error("Invalid continuation byte");
}if(240==(ia&248)&&(Ea=Ia(),sb=Ia(),R=Ia(),ia=(ia&7)<<18|Ea<<12|sb<<6|R,65536<=ia&&1114111>=ia))return ia;throw Error("Invalid UTF-8 detected");}function tb(R,ia,Ea){if(!ia)return lc.encodeBase64Packet(R,Ea);var sb=new FileReader;sb.onload=function(){lc.encodePacket({type:R.type,data:sb.result},ia,!0,Ea)};return sb.readAsArrayBuffer(R.data)}function Jb(R,ia,Ea){var sb=Array(R.length);Ea=zg(R.length,Ea);for(var Zb=function(Yd,ce,ve){ia(ce,function(wf,lg){sb[Yd]=lg;ve(wf,sb)})},Vc=0;Vc<R.length;Vc++)Zb(Vc,
R[Vc],Ea)}function Ib(R){var ia="";do ia=No[R%64]+ia,R=Math.floor(R/64);while(0<R);return ia}function ib(){var R=Ib(+new Date);return R!==Lm?(em=0,Lm=R):R+"."+Ib(em++)}function jb(R){(this||wg).path=R.path;(this||wg).hostname=R.hostname;(this||wg).port=R.port;(this||wg).secure=R.secure;(this||wg).query=R.query;(this||wg).timestampParam=R.timestampParam;(this||wg).timestampRequests=R.timestampRequests;(this||wg).readyState="";(this||wg).agent=R.agent||!1;(this||wg).socket=R.socket;(this||wg).enablesXDR=
R.enablesXDR;(this||wg).withCredentials=R.withCredentials;(this||wg).pfx=R.pfx;(this||wg).key=R.key;(this||wg).passphrase=R.passphrase;(this||wg).cert=R.cert;(this||wg).ca=R.ca;(this||wg).ciphers=R.ciphers;(this||wg).rejectUnauthorized=R.rejectUnauthorized;(this||wg).forceNode=R.forceNode;(this||wg).isReactNative=R.isReactNative;(this||wg).extraHeaders=R.extraHeaders;(this||wg).localAddress=R.localAddress}function Fb(R){var ia=R&&R.forceBase64;if(!wm||ia)(this||ig).supportsBinary=!1;nl.call(this||
ig,R)}function rc(){}function Ic(R){Oo.call(this||$e,R);(this||$e).requestTimeout=R.requestTimeout;(this||$e).extraHeaders=R.extraHeaders;if("undefined"!==typeof location){var ia="https:"===location.protocol,Ea=location.port;Ea||(Ea=ia?443:80);(this||$e).xd="undefined"!==typeof location&&R.hostname!==location.hostname||Ea!==R.port;(this||$e).xs=R.secure!==ia}}function ec(R){(this||$e).method=R.method||"GET";(this||$e).uri=R.uri;(this||$e).xd=!!R.xd;(this||$e).xs=!!R.xs;(this||$e).async=!1!==R.async;
(this||$e).data=void 0!==R.data?R.data:null;(this||$e).agent=R.agent;(this||$e).isBinary=R.isBinary;(this||$e).supportsBinary=R.supportsBinary;(this||$e).enablesXDR=R.enablesXDR;(this||$e).withCredentials=R.withCredentials;(this||$e).requestTimeout=R.requestTimeout;(this||$e).pfx=R.pfx;(this||$e).key=R.key;(this||$e).passphrase=R.passphrase;(this||$e).cert=R.cert;(this||$e).ca=R.ca;(this||$e).ciphers=R.ciphers;(this||$e).rejectUnauthorized=R.rejectUnauthorized;(this||$e).extraHeaders=R.extraHeaders;
this.create()}function Pc(){for(var R in ec.requests)ec.requests.hasOwnProperty(R)&&ec.requests[R].abort()}function Q(){}function ha(R){jn.call(this||Fh,R);(this||Fh).query=(this||Fh).query||{};yl||(yl=xm.___eio=xm.___eio||[]);(this||Fh).index=yl.length;var ia=this||Fh;yl.push(function(Ea){ia.onData(Ea)});(this||Fh).query.j=(this||Fh).index;"function"===typeof addEventListener&&addEventListener("beforeunload",function(){ia.script&&(ia.script.onerror=Q)},!1)}function Ha(R){R&&R.forceBase64&&((this||
ra).supportsBinary=!1);(this||ra).perMessageDeflate=R.perMessageDeflate;(this||ra).usingBrowserWebSocket=zc&&!R.forceNode;(this||ra).protocols=R.protocols;(this||ra).usingBrowserWebSocket||(Nd=Kc);Oa.call(this||ra,R)}function Pa(R,ia){if(!((this||ld)instanceof Pa))return new Pa(R,ia);ia=ia||{};R&&"object"===typeof R&&(ia=R,R=null);R?(R=bl(R),ia.hostname=R.host,ia.secure="https"===R.protocol||"wss"===R.protocol,ia.port=R.port,R.query&&(ia.query=R.query)):ia.host&&(ia.hostname=bl(ia.host).host);(this||
ld).secure=null!=ia.secure?ia.secure:"undefined"!==typeof location&&"https:"===location.protocol;ia.hostname&&!ia.port&&(ia.port=(this||ld).secure?"443":"80");(this||ld).agent=ia.agent||!1;(this||ld).hostname=ia.hostname||("undefined"!==typeof location?location.hostname:"localhost");(this||ld).port=ia.port||("undefined"!==typeof location&&location.port?location.port:(this||ld).secure?443:80);(this||ld).query=ia.query||{};"string"===typeof(this||ld).query&&((this||ld).query=lp.decode((this||ld).query));
(this||ld).upgrade=!1!==ia.upgrade;(this||ld).path=(ia.path||"/engine.io").replace(/\/$/,"")+"/";(this||ld).forceJSONP=!!ia.forceJSONP;(this||ld).jsonp=!1!==ia.jsonp;(this||ld).forceBase64=!!ia.forceBase64;(this||ld).enablesXDR=!!ia.enablesXDR;(this||ld).withCredentials=!1!==ia.withCredentials;(this||ld).timestampParam=ia.timestampParam||"t";(this||ld).timestampRequests=ia.timestampRequests;(this||ld).transports=ia.transports||["polling","websocket"];(this||ld).transportOptions=ia.transportOptions||
{};(this||ld).readyState="";(this||ld).writeBuffer=[];(this||ld).prevBufferLen=0;(this||ld).policyPort=ia.policyPort||843;(this||ld).rememberUpgrade=ia.rememberUpgrade||!1;(this||ld).binaryType=null;(this||ld).onlyBinaryUpgrades=ia.onlyBinaryUpgrades;(this||ld).perMessageDeflate=!1!==ia.perMessageDeflate?ia.perMessageDeflate||{}:!1;!0===(this||ld).perMessageDeflate&&((this||ld).perMessageDeflate={});(this||ld).perMessageDeflate&&null==(this||ld).perMessageDeflate.threshold&&((this||ld).perMessageDeflate.threshold=
1024);(this||ld).pfx=ia.pfx||null;(this||ld).key=ia.key||null;(this||ld).passphrase=ia.passphrase||null;(this||ld).cert=ia.cert||null;(this||ld).ca=ia.ca||null;(this||ld).ciphers=ia.ciphers||null;(this||ld).rejectUnauthorized=void 0===ia.rejectUnauthorized?!0:ia.rejectUnauthorized;(this||ld).forceNode=!!ia.forceNode;(this||ld).isReactNative="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();if("undefined"===typeof self||(this||ld).isReactNative)ia.extraHeaders&&
0<Object.keys(ia.extraHeaders).length&&((this||ld).extraHeaders=ia.extraHeaders),ia.localAddress&&((this||ld).localAddress=ia.localAddress);(this||ld).id=null;(this||ld).upgrades=null;(this||ld).pingInterval=null;(this||ld).pingTimeout=null;(this||ld).pingIntervalTimer=null;(this||ld).pingTimeoutTimer=null;this.open()}function bc(R,ia,Ea){(this||sf).io=R;(this||sf).nsp=ia;(this||sf).json=this||sf;(this||sf).ids=0;(this||sf).acks={};(this||sf).receiveBuffer=[];(this||sf).sendBuffer=[];(this||sf).connected=
!1;(this||sf).disconnected=!0;(this||sf).flags={};Ea&&Ea.query&&((this||sf).query=Ea.query);(this||sf).io.autoConnect&&this.open()}function ic(R){R=R||{};(this||dl).ms=R.min||100;(this||dl).max=R.max||1E4;(this||dl).factor=R.factor||2;(this||dl).jitter=0<R.jitter&&1>=R.jitter?R.jitter:0;(this||dl).attempts=0}function Ra(R,ia){if(!((this||ne)instanceof Ra))return new Ra(R,ia);R&&"object"===typeof R&&(ia=R,R=void 0);ia=ia||{};ia.path=ia.path||"/socket.io";(this||ne).nsps={};(this||ne).subs=[];(this||
ne).opts=ia;this.reconnection(!1!==ia.reconnection);this.reconnectionAttempts(ia.reconnectionAttempts||Infinity);this.reconnectionDelay(ia.reconnectionDelay||1E3);this.reconnectionDelayMax(ia.reconnectionDelayMax||5E3);this.randomizationFactor(ia.randomizationFactor||.5);(this||ne).backoff=new Oq({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==ia.timeout?2E4:ia.timeout);(this||ne).readyState="closed";(this||ne).uri=R;(this||ne).connecting=
[];(this||ne).lastPing=null;(this||ne).encoding=!1;(this||ne).packetBuffer=[];R=ia.parser||Ns;(this||ne).encoder=new R.Encoder;(this||ne).decoder=new R.Decoder;(this||ne).autoConnect=!1!==ia.autoConnect;(this||ne).autoConnect&&this.open()}function tc(R,ia){"object"===typeof R&&(ia=R,R=void 0);ia=ia||{};R=Hr(R);var Ea=R.source,sb=R.id,Zb=R.path;Zb=Po[sb]&&Zb in Po[sb].nsps;ia.forceNew||ia["force new connection"]||!1===ia.multiplex||Zb?(Qs("ignoring socket cache for %s",Ea),Ea=Pq(Ea,ia)):(Po[sb]||(Qs("new io instance for %s",
Ea),Po[sb]=Pq(Ea,ia)),Ea=Po[sb]);R.query&&!ia.query&&(ia.query=R.query);return Ea.socket(R.path,ia)}var Qd=lively.FreezerRuntime.recorderFor("lively.2lively/interface.js");Qd.nyi=function(R){throw Error("Not yet implemented: "+R);};Qd.string=Bb;Qd.promise=Qb;Qd.debugMessageOrder=!1;var md=function(R){this.id=Qd.string.newUUID();this.actions={};this.options={ackTimeout:3500,debug:!1};this._incomingOrderNumberingBySenders=new Map;this._outgoingOrderNumberingByTargets=new Map;this._outOfOrderCacheBySenders=
new Map};md.prototype.isOnline=function(){Qd.nyi("isOnline")};md.prototype.open=function(){Qd.nyi("isOnline")};md.prototype.close=function(){Qd.nyi("close")};md.prototype.remove=function(){Qd.nyi("remove")};md.prototype.whenOnline=function(R){var ia=this;return Qd.promise.waitFor(R,function(){return ia.isOnline()}).then(function(){return ia}).catch(function(Ea){return Promise.reject(/timeout/i.test(String(Ea))?Error("Timeout in "+ia+".whenOnline"):Ea)})};md.prototype.onError=function(R){this.debug&&
console.log("["+this+"] error: "+R)};md.prototype.removeService=function(R){delete this.actions[R]};md.prototype.removeServices=function(R){var ia=this;R.forEach(function(Ea){return ia.removeService(Ea)})};md.prototype.addService=function(R,ia){this.actions[R]=ia};md.prototype.addServices=function(R){var ia=this;Object.keys(R).forEach(function(Ea){return ia.addService(Ea,R[Ea])})};md.prototype.ping=function(R){var ia=this,Ea,sb,Zb,Vc,Yd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ce){if(1==
ce.nextAddress)return Ea=Date.now(),ce.yield(ia.sendToAndWait(R,"l2l-ping",{timestamp:Ea}),2);sb=ce.yieldResult;Zb=sb.data;Vc=Zb.timestamp;Yd=Date.now();return ce.return({to:Vc-Ea,from:Yd-Vc,roundtrip:Yd-Ea})})};md.prototype.send=function(R,ia){Qd.nyi("send")};md.prototype.sendAndWait=function(R){var ia=this,Ea,sb,Zb,Vc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){switch(Yd.nextAddress){case 1:return Ea=new Promise(function(ce,ve){return ia.send(R,ce)}),sb={},Zb=ia.options.ackTimeout+
400,"ackTimeout"in R&&(Zb=!R.ackTimeout||0>R.ackTimeout?null:R.ackTimeout+400),Zb?Yd.yield(Promise.race([Qd.promise.delay(Zb,sb),Ea]),5):Yd.yield(Ea,4);case 4:Vc=Yd.yieldResult;Yd.jumpTo(3);break;case 5:Vc=Yd.yieldResult;case 3:if(Vc===sb)throw Error("Timeout sending "+R.action);return Yd.return(Vc)}})};md.prototype.sendTo=function(R,ia,Ea,sb){return this.send({target:R,action:ia,data:Ea},sb)};md.prototype.sendToAndWait=function(R,ia,Ea,sb){return this.sendAndWait(Object.assign({target:R,action:ia,
data:Ea},sb))};md.prototype.prepareSend=function(R,ia){var Ea=R.target,sb=R.action,Zb=R.messageId,Vc=R.sender;if(!sb)throw Error("Trying to send a message without specifying action!");if(!Ea)throw Error("Trying to send message "+sb+" without specifying target!");Zb||(R.messageId=Qd.string.newUUID());Vc||(R.sender=this.id);sb=R.n=this._outgoingOrderNumberingByTargets.get(Ea)||0;this._outgoingOrderNumberingByTargets.set(Ea,sb+1);if("function"===typeof ia){Vc=this;var Yd=ia;ia=function(ce){var ve=Vc._incomingOrderNumberingBySenders.get(ce.sender)||
0;Vc.debug&&Qd.debugMessageOrder&&console.log("[MSG ORDER] "+Vc+" received ack for "+ce.action+" as msg "+ve);try{Yd.apply(null,arguments)}catch(wf){console.error("Error in ack fn of "+Vc+": "+wf.stack)}Vc._incomingOrderNumberingBySenders.set(ce.sender,ve+1);setTimeout(function(){return Vc.invokeOutOfOrderMessages(ce.sender)},0)}}this.debug&&Qd.debugMessageOrder&&console.log("[MSG ORDER] "+this+" sending "+sb+" ("+R.action+") to "+Ea);return[R,ia]};md.prototype.prepareAnswerMessage=function(R,ia){return{action:R.action+
"-response",inResponseTo:R.messageId,target:R.sender,data:ia,sender:this.id}};md.prototype.installEventToMessageTranslator=function(R){var ia=this,Ea=R.onevent;R.onevent=function(sb){var Zb=sb.data||[];Ea.call(this,sb);sb.data=["*"].concat(Zb);Ea.call(this,sb)};R.on("*",function(sb,Zb){sb&&"object"===typeof sb&&sb.action&&(Zb=sb,sb=Zb.action);var Vc=arguments[arguments.length-1];Vc="function"===typeof Vc?Vc:null;(Zb=Zb===Vc?null:Zb)&&Zb.data&&("number"===typeof Zb.n||Zb.broadcast)&&Zb.sender?ia.receive(Zb,
R,Vc):(console.warn(ia+" received non-conformant message "+sb+":",arguments),"function"===typeof Vc&&Vc({data:{error:"invalid l2l message"}}))})};md.prototype.receive=function(R,ia,Ea){this.dispatchL2LMessageToSelf(R,ia,Ea)};md.prototype.dispatchL2LMessageToSelf=function(R,ia,Ea){var sb=this,Zb=R.action;if(R.broadcast)this.safeInvokeServiceHandler(Zb,R,Ea,ia);else try{var Vc=this._incomingOrderNumberingBySenders.get(R.sender)||0,Yd="register"===Zb||"unregister";if(!Yd&&R.n<Vc)console.error("[MSG ORDER] ["+
this+"] received message no. "+R.n+" but expected >= "+Vc+", dropping "+Zb);else if(!Yd&&R.n>Vc){this.debug&&Qd.debugMessageOrder&&console.log("[MSG ORDER] ["+this+"] storing out of order message "+Zb+" ("+R.n+") for later invocation");var ce=this._outOfOrderCacheBySenders.get(R.sender);ce||(ce=[],this._outOfOrderCacheBySenders.set(R.sender,ce));ce.push([Zb,R,Ea,ia])}else this.safeInvokeServiceHandler(Zb,R,Ea,ia),setTimeout(function(){return sb.invokeOutOfOrderMessages(R.sender)},0)}catch(ve){console.error("Error message ordering when handling "+
Zb+": "+(ve.stack||ve)),"function"===typeof Ea&&Ea(this.prepareAnswerMessage(R,{isError:!0,error:String(ve.stack||ve)}))}};md.prototype.invokeOutOfOrderMessages=function(R){var ia=this._outOfOrderCacheBySenders.get(R);if(ia&&ia.length){var Ea=this._incomingOrderNumberingBySenders.get(R)||0;R=ia.findIndex(function(sb){sb=$jscomp.makeIterator(sb);sb.next();return sb.next().value.n===Ea});-1!==R&&(ia.splice(R,1),this.invokeServiceHandler.apply(this,ia[R]))}};md.prototype.renameTarget=function(R,ia){if(R!==
ia){var Ea=this._outgoingOrderNumberingByTargets.get(R);this._outgoingOrderNumberingByTargets.delete(R);this._outgoingOrderNumberingByTargets.set(ia,Ea)}};md.prototype.safeInvokeServiceHandler=function(R,ia,Ea,sb){try{"function"===typeof this.actions[R]?this.invokeServiceHandler(R,ia,Ea,sb):sb._events&&Object.keys(sb._events).includes(R)||(console.warn("WARNING ["+this+"] Unhandled message: "+R),"function"===typeof Ea&&Ea(this.prepareAnswerMessage(ia,{isError:!0,error:"message not understood: "+R})))}catch(Zb){console.error("Error when handling "+
R+": "+(Zb.stack||Zb)),"function"===typeof Ea&&Ea(this.prepareAnswerMessage(ia,{isError:!0,error:String(Zb.stack||Zb)}))}};md.prototype.invokeServiceHandler=function(R,ia,Ea,sb){var Zb=this;this.debug&&Qd.debugMessageOrder&&console.log("[MSG ORDER] "+this+" received "+ia.n+" ("+ia.action+") from "+ia.sender);this._incomingOrderNumberingBySenders.set(ia.sender,ia.n+1);if("function"===typeof Ea){var Vc=!1,Yd=!1,ce="ackTimeout"in ia?ia.ackTimeout:this.options.ackTimeout,ve=this._outgoingOrderNumberingByTargets.get(ia.sender)||
0;this._outgoingOrderNumberingByTargets.set(ia.sender,ve+1);var wf=function(lg){Yd?console.warn("["+Zb+"] ackFn for "+ia.action+" called after it timed out, dropping answer!"):Vc?console.warn("["+Zb+"] ack function called repeatedly when handling "+ia.action):(Vc=!0,Ea(Zb.prepareAnswerMessage(ia,lg)),Zb.debug&&Qd.debugMessageOrder&&console.log("[MSG ORDER] "+Zb+" sending "+ve+" (ack for "+ia.action+")"))};ce&&setTimeout(function(){Vc||(wf({isError:!0,error:"Timeout error: "+Zb+" did not send answer for "+
ia.action+" after "+ce+"ms"}),Yd=!0)},ce)}try{this.actions[R].call(this,this,ia,wf,sb)}catch(lg){console.error("["+this+"] Error handling "+R+": "+(lg.stack||lg)),wf&&wf({error:lg.stack})}};$jscomp.global.Object.defineProperties(md.prototype,{debug:{configurable:!0,enumerable:!0,get:function(){return this.options.debug},set:function(R){this.options.debug=R}}});Qd.L2LConnection=md;Qd.default=md;var $c=lively.FreezerRuntime.recorderFor("lively.2lively/default-actions.js"),Wa={"l2l-ping":function(R,
ia,Ea,sb){sb=ia.sender;ia=ia.data.timestamp;var Zb=Date.now();"function"===typeof Ea&&Ea({timestamp:Zb});R.debug&&console.log("[undefined] got ping from "+sb+", time: "+(Zb-ia)+"ms")},"remote-eval":function(R,ia,Ea,sb){var Zb=ia.data.source;Promise.resolve().then(function(){return eval(Zb)}).then(function(Vc){return Ea({value:Vc})}).catch(function(Vc){Vc.originalErr&&(Vc=Vc.originalErr);console.error("eval error: "+Vc);"function"===typeof Ea&&Ea({isError:!0,value:String(Vc.stack||Vc)})})},"remote-eval-2":function(R,
ia,Ea,sb){var Zb=ia.data.source;Promise.resolve().then(function(){var Vc=eval(Zb);if(!(Vc instanceof Promise))throw console.error("unexpected eval result:"+Vc),Error("unexpected eval result:"+Vc);return Vc}).then(function(Vc){return Ea(Vc)}).catch(function(Vc){console.error("eval error: "+Vc);Vc.originalErr&&(Vc=Vc.originalErr);"function"===typeof Ea&&Ea({isError:!0,value:String(Vc.stack||Vc)})})}};$c.defaultActions=Wa;$c.defaultActions=Wa;$c.defaultActions=Wa;var fd={},lb=(fd["[broadcast] send"]=
function(R,ia,Ea,sb){var Zb=ia.sender,Vc=ia.data,Yd,ce,ve,wf,lg,vi,Ii,Ok,Qo,Ro,Mn,Nn;return $jscomp.asyncExecutePromiseGeneratorProgram(function($p){Yd=Vc;ce=Yd.action;ve=Yd.broadcast;wf=Yd.room;lg=Yd.namespace;vi=Yd.isSystemBroadcast;Ii=Yd.isMultiServerBroadcast;Ok=[];Ii?(console.log(".......isMultiServerBroadcast"),Qo=R,Ro=Qo.id,Mn=R.getTrackerList(),console.log(Mn),Ok=Mn.map(function(ln){return ln.id!=Ro?ln.io.nsps["/"+ln.namespace]:sb.broadcast})):(vi&&(lg=R.namespace),Ok.push(lg?R.io.nsps["/"+
lg]:sb.broadcast));Ok.forEach(function(ln){return ln.to(wf).emit({action:ce,sender:Zb,broadcast:!0,data:ve})});Ea&&"function"===typeof Ea&&(Nn="message broadcasted to "+wf,lg&&(Nn+=" in namespace "+lg),1<Ok.length&&(Nn+=" "+Ok.length+" trackers"),console.log(Nn),Ea({status:Nn}));$p.jumpToEnd()})},fd["[broadcast] join room"]=function(R,ia,Ea,sb){var Zb=ia.sender,Vc=ia.data.room,Yd,ce,ve,wf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lg){if(1==lg.nextAddress)return ce=!1,ve=R.io.nsps["/"+
R.namespace].adapter.rooms,(wf=ve[Vc]&&ve[Vc].sockets&&ve[Vc].sockets[sb.id])?(Yd=Zb+" already in "+Vc,lg.jumpTo(2)):lg.yield(new Promise(function(vi,Ii){return sb.join(Vc,function(Ok){return Ok?Ii(Ok):vi()})}),3);2!=lg.nextAddress&&(Yd=Zb+" joined "+Vc,ce=!0);Ea&&"function"===typeof Ea&&Ea({status:Yd,joined:ce});lg.jumpToEnd()})},fd["[broadcast] leave room"]=function(R,ia,Ea,sb){var Zb=ia.sender,Vc=ia.data.room,Yd,ce,ve,wf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lg){if(1==lg.nextAddress)return ce=
!1,ve=R.io.nsps["/"+R.namespace].adapter.rooms,wf=ve[Vc]&&ve[Vc].sockets&&ve[Vc].sockets[sb.id],wf?lg.yield(new Promise(function(vi,Ii){return sb.leave(Vc,function(Ok){return Ok?Ii(Ok):vi()})}),3):(Yd=Zb+" not in "+Vc,lg.jumpTo(2));2!=lg.nextAddress&&(Yd=Zb+" left room "+Vc,ce=!0);console.log(Yd);Ea&&"function"===typeof Ea&&Ea({left:ce,status:Yd});lg.jumpToEnd()})},fd["[broadcast] my rooms"]=function(R,ia,Ea,sb){Ea(sb.rooms)},fd["[broadcast] all rooms"]=function(R,ia,Ea,sb){Ea(R.io.nsps["/"+R.namespace].adapter.rooms)},
fd["[broadcast] list room members"]=function(R,ia,Ea,sb){ia=ia.data.room;sb=R.io;ia?(R=sb.nsps["/"+R.namespace].adapter.rooms[ia],Ea({room:ia,sockets:R?R.sockets:{},length:R?R.length:0})):Ea({isError:!0,error:"`room` paramerter missing!"})},fd.getClients=function(R,ia,Ea){R.removeDisconnectedClients();Ea(Array.from(R.clients))},fd);$c.defaultTrackerActions=lb;$c.defaultTrackerActions=lb;$c.defaultTrackerActions=lb;var Hd={},db=(Hd.getRoomList=function(R){var ia=R.client,Ea=R.ackFn,sb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zb){sb=
ia._socketioClient.rooms;Ea(sb);Zb.jumpToEnd()})},Hd["ask for"]=function(R,ia,Ea,sb){var Zb=ia.sender,Vc=ia.data.query,Yd=this,ce,ve;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wf){if(1==wf.nextAddress)return ce=Vc.match(/password|sudo/i)?"passwordPrompt":"prompt",wf.yield($world[ce](Vc),2);ve=wf.yieldResult;"function"===typeof Ea&&Ea({answer:ve});R.debug&&console.log("["+Yd+"] message 'ask for' from "+Zb+", query: "+Vc);wf.jumpToEnd()})},Hd["open editor"]=function(R,ia,Ea,sb){var Zb=
ia.data.args,Vc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){if(1==Yd.nextAddress)return Zb.length?Yd.yield($world.execCommand("open file for EDITOR",{url:Zb[0]}),2):(Ea({error:"no file specified"}),Yd.return());Vc=Yd.yieldResult;"function"===typeof Ea&&Ea("aborted"===Vc?{error:String(Vc)}:{status:Vc});Yd.jumpToEnd()})},Hd.changeWorkingDirectory=function(R,ia,Ea,sb){var Zb=ia.data.args,Vc,Yd,ce,ve,wf,lg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vi){Vc=$jscomp.makeIterator(Zb||
[]);Yd=Vc.next().value;ce=Vc.next().value;ve="OK";try{if(Yd)if(ce){if(wf=$world.getMorphWithId(ce))if(wf.__lookupSetter__("cwd"))wf.cwd=Yd;else if("function"===typeof wf.changeWorkingDirectory)wf.changeWorkingDirectory(Yd);else if("function"===typeof wf.pluginFind){if(lg=wf.pluginFind(function(Ii){return Ii.isShellEditorPlugin}))lg.cwd=Yd}else ve="[changeWorkingDirectory] cannot figure pout how to set dir"}else ve="[changeWorkingDirectory] No command morph";else ve="[changeWorkingDirectory] No directory received"}catch(Ii){ve=
String(Ii)}"OK"!==ve&&console.warn(ve);"function"===typeof Ea&&Ea(ve);vi.jumpToEnd()})},Hd);$c.defaultClientActions=db;$c.defaultClientActions=db;$c.defaultClientActions=db;var rb={},vb=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,vd="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),
me=rb=function(R){var ia=R,Ea=R.indexOf("["),sb=R.indexOf("]");-1!=Ea&&-1!=sb&&(R=R.substring(0,Ea)+R.substring(Ea,sb).replace(/:/g,";")+R.substring(sb,R.length));var Zb=vb.exec(R||"");R={};for(var Vc=14;Vc--;)R[vd[Vc]]=Zb[Vc]||"";-1!=Ea&&-1!=sb&&(R.source=ia,R.host=R.host.substring(1,R.host.length-1).replace(/;/g,":"),R.authority=R.authority.replace("[","").replace("]","").replace(/;/g,":"),R.ipv6uri=!0);ia=R.path;Ea=ia.replace(/\/{2,9}/g,"/").split("/");"/"!=ia.substr(0,1)&&0!==ia.length||Ea.splice(0,
1);"/"==ia.substr(ia.length-1,1)&&Ea.splice(Ea.length-1,1);R.pathNames=Ea;R.queryKey=Mc(R,R.query);return R},ye={},Pe=864E5,Tc=365.25*Pe,re=ye=function(R,ia){ia=ia||{};var Ea=typeof R;if("string"===Ea&&0<R.length)return pd(R);if("number"===Ea&&!1===isNaN(R))return ia.long?Dd(R,Pe,"day")||Dd(R,36E5,"hour")||Dd(R,6E4,"minute")||Dd(R,1E3,"second")||R+" ms":R>=Pe?Math.round(R/Pe)+"d":36E5<=R?Math.round(R/36E5)+"h":6E4<=R?Math.round(R/6E4)+"m":1E3<=R?Math.round(R/1E3)+"s":R+"ms";throw Error("val is not a non-empty string or a valid number. val="+
JSON.stringify(R));},Ed="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Nb={};Nb=Nb=Kd.debug=Kd["default"]=Kd;Nb.coerce=function(R){return R instanceof Error?R.stack||R.message:R};Nb.disable=function(){Nb.enable("")};Nb.enable=function(R){Nb.save(R);Nb.names=[];Nb.skips=[];var ia,Ea=("string"===typeof R?R:"").split(/[\s,]+/),sb=Ea.length;for(ia=0;ia<sb;ia++)Ea[ia]&&(R=Ea[ia].replace(/\*/g,".*?"),"-"===R[0]?Nb.skips.push(new RegExp("^"+R.substr(1)+"$")):Nb.names.push(new RegExp("^"+
R+"$")));for(ia=0;ia<Nb.instances.length;ia++)R=Nb.instances[ia],R.enabled=Nb.enabled(R.namespace)};Nb.enabled=function(R){if("*"===R[R.length-1])return!0;var ia;var Ea=0;for(ia=Nb.skips.length;Ea<ia;Ea++)if(Nb.skips[Ea].test(R))return!1;Ea=0;for(ia=Nb.names.length;Ea<ia;Ea++)if(Nb.names[Ea].test(R))return!0;return!1};Nb.humanize=re;Nb.instances=[];Nb.names=[];Nb.skips=[];Nb.formatters={};var wa="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Ba={},Mb=hc;Ba=Ba=Nb;
Ba.log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};Ba.formatArgs=function(R){var ia=(this||wa).useColors;R[0]=(ia?"%c":"")+(this||wa).namespace+(ia?" %c":" ")+R[0]+(ia?"%c ":" ")+"+"+Ba.humanize((this||wa).diff);if(ia){ia="color: "+(this||wa).color;R.splice(1,0,ia,"color: inherit");var Ea=0,sb=0;R[0].replace(/%[a-zA-Z%]/g,function(Zb){"%%"!==Zb&&(Ea++,"%c"===Zb&&(sb=Ea))});R.splice(sb,0,ia)}};Ba.save=function(R){try{null==
R?Ba.storage.removeItem("debug"):Ba.storage.debug=R}catch(ia){}};Ba.load=cb;Ba.useColors=function(){return"undefined"!==typeof window&&window.process&&"renderer"===window.process.type?!0:"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||
window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var P=Ba;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)var ya=chrome.storage.local;else a:{try{ya=window.localStorage;break a}catch(R){}ya=void 0}P.storage=ya;Ba.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
Ba.formatters.j=function(R){try{return JSON.stringify(R)}catch(ia){return"[UnexpectedJSONParseError]: "+ia.message}};Ba.enable(cb());var Ua=Ba,Eb="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Cc={};Cc=Ab;Ab.prototype.on=Ab.prototype.addEventListener=function(R,ia){(this||Eb)._callbacks=(this||Eb)._callbacks||{};((this||Eb)._callbacks["$"+R]=(this||Eb)._callbacks["$"+R]||[]).push(ia);return this||Eb};Ab.prototype.once=function(R,ia){function Ea(){this.off(R,Ea);ia.apply(this||
Eb,arguments)}Ea.fn=ia;this.on(R,Ea);return this||Eb};Ab.prototype.off=Ab.prototype.removeListener=Ab.prototype.removeAllListeners=Ab.prototype.removeEventListener=function(R,ia){(this||Eb)._callbacks=(this||Eb)._callbacks||{};if(0==arguments.length)return(this||Eb)._callbacks={},this||Eb;var Ea=(this||Eb)._callbacks["$"+R];if(!Ea)return this||Eb;if(1==arguments.length)return delete (this||Eb)._callbacks["$"+R],this||Eb;for(var sb,Zb=0;Zb<Ea.length;Zb++)if(sb=Ea[Zb],sb===ia||sb.fn===ia){Ea.splice(Zb,
1);break}0===Ea.length&&delete (this||Eb)._callbacks["$"+R];return this||Eb};Ab.prototype.emit=function(R){(this||Eb)._callbacks=(this||Eb)._callbacks||{};for(var ia=Array(arguments.length-1),Ea=(this||Eb)._callbacks["$"+R],sb=1;sb<arguments.length;sb++)ia[sb-1]=arguments[sb];if(Ea){Ea=Ea.slice(0);sb=0;for(var Zb=Ea.length;sb<Zb;++sb)Ea[sb].apply(this||Eb,ia)}return this||Eb};Ab.prototype.listeners=function(R){(this||Eb)._callbacks=(this||Eb)._callbacks||{};return(this||Eb)._callbacks["$"+R]||[]};
Ab.prototype.hasListeners=function(R){return!!this.listeners(R).length};var cd=Cc,ee={},Vd={}.toString,Ze=ee=Array.isArray||function(R){return"[object Array]"==Vd.call(R)},Wd={},Be=ac.Buffer;Wd=function(R){var ia;!(ia=Qe&&Be.isBuffer(R))&&(ia=rf)&&((ia=R instanceof ArrayBuffer)||(ia="function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(R):R.buffer instanceof ArrayBuffer));return ia};var Qe="function"===typeof Be&&"function"===typeof Be.isBuffer,rf="function"===typeof ArrayBuffer,cg=Wd,Ef="undefined"!==
typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Oc={},Af=Ze,qg=cg,sg=Object.prototype.toString,ff="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===sg.call(Blob),Ja="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===sg.call(File);Oc.deconstructPacket=function(R){var ia=[];R.data=Yb(R.data,ia);R.attachments=ia.length;return{packet:R,buffers:ia}};Oc.reconstructPacket=function(R,ia){R.data=gc(R.data,ia);R.attachments=void 0;
return R};Oc.removeBlobs=function(R,ia){function Ea(Vc,Yd,ce){if(!Vc)return Vc;if(ff&&Vc instanceof Blob||Ja&&Vc instanceof File){sb++;var ve=new FileReader;ve.onload=function(){ce?ce[Yd]=(this||Ef).result:Zb=(this||Ef).result;--sb||ia(Zb)};ve.readAsArrayBuffer(Vc)}else if(Af(Vc))for(ve=0;ve<Vc.length;ve++)Ea(Vc[ve],ve,Vc);else if("object"===typeof Vc&&!qg(Vc))for(ve in Vc)Ea(Vc[ve],ve,Vc)}var sb=0,Zb=R;Ea(Zb);sb||ia(Zb)};var ab="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?
self:global,Cb={},ba=Ua("socket.io-parser"),Ka=Oc;Cb.protocol=4;Cb.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" ");Cb.CONNECT=0;Cb.DISCONNECT=1;Cb.EVENT=2;Cb.ACK=3;Cb.ERROR=4;Cb.BINARY_EVENT=5;Cb.BINARY_ACK=6;Cb.Encoder=dd;Cb.Decoder=oc;var nb=Cb.ERROR+'"encode error"';dd.prototype.encode=function(R,ia){ba("encoding packet %j",R);Cb.BINARY_EVENT===R.type||Cb.BINARY_ACK===R.type?Wb(R,ia):(R=Zd(R),ia([R]))};cd(oc.prototype);oc.prototype.add=function(R){if("string"===typeof R){a:{var ia=
0,Ea={type:Number(R.charAt(0))};if(null==Cb.types[Ea.type])R={type:Cb.ERROR,data:"parser error: unknown packet type "+Ea.type};else{if(Cb.BINARY_EVENT===Ea.type||Cb.BINARY_ACK===Ea.type){for(var sb="";"-"!==R.charAt(++ia)&&(sb+=R.charAt(ia),ia!=R.length););if(sb!=Number(sb)||"-"!==R.charAt(ia))throw Error("Illegal attachments");Ea.attachments=Number(sb)}if("/"===R.charAt(ia+1))for(Ea.nsp="";++ia;){sb=R.charAt(ia);if(","===sb)break;Ea.nsp+=sb;if(ia===R.length)break}else Ea.nsp="/";sb=R.charAt(ia+1);
if(""!==sb&&Number(sb)==sb){for(Ea.id="";++ia;){sb=R.charAt(ia);if(null==sb||Number(sb)!=sb){--ia;break}Ea.id+=R.charAt(ia);if(ia===R.length)break}Ea.id=Number(Ea.id)}if(R.charAt(++ia)){ia=R.substr(ia);try{var Zb=JSON.parse(ia)}catch(Vc){Zb=!1}if(!1===Zb||Ea.type!==Cb.ERROR&&!Ze(Zb)){R={type:Cb.ERROR,data:"parser error: invalid payload"};break a}else Ea.data=Zb}ba("decoded %s as %j",R,Ea);R=Ea}}Cb.BINARY_EVENT===R.type||Cb.BINARY_ACK===R.type?((this||ab).reconstructor=new Lb(R),0===(this||ab).reconstructor.reconPack.attachments&&
this.emit("decoded",R)):this.emit("decoded",R)}else if(cg(R)||R.base64)if((this||ab).reconstructor){if(R=(this||ab).reconstructor.takeBinaryData(R))(this||ab).reconstructor=null,this.emit("decoded",R)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+R);};oc.prototype.destroy=function(){(this||ab).reconstructor&&(this||ab).reconstructor.finishedReconstruction()};Lb.prototype.takeBinaryData=function(R){(this||ab).buffers.push(R);return(this||ab).buffers.length===
(this||ab).reconPack.attachments?(R=Ka.reconstructPacket((this||ab).reconPack,(this||ab).buffers),this.finishedReconstruction(),R):null};Lb.prototype.finishedReconstruction=function(){(this||ab).reconPack=null;(this||ab).buffers=[]};var xb={};try{xb="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(R){xb=!1}var Dc=xb,Fc={},ud=Fc="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")(),td={},rd=td=function(R){var ia=R.xdomain,Ea=R.xscheme;
R=R.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!ia||Dc))return new XMLHttpRequest}catch(sb){}try{if("undefined"!==typeof XDomainRequest&&!Ea&&R)return new XDomainRequest}catch(sb){}if(!ia)try{return new (ud[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(sb){}},zf={},Ye=ac.Buffer,Zf=Ze,vh=Object.prototype.toString,Hi="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===vh.call(Blob),Nh="function"===typeof File||"undefined"!==typeof File&&
"[object FileConstructor]"===vh.call(File),pj=zf=Bc,Gh={},xk=Gh=function(R,ia,Ea){var sb=R.byteLength;ia=ia||0;Ea=Ea||sb;if(R.slice)return R.slice(ia,Ea);0>ia&&(ia+=sb);0>Ea&&(Ea+=sb);Ea>sb&&(Ea=sb);if(ia>=sb||ia>=Ea||0===sb)return new ArrayBuffer(0);R=new Uint8Array(R);sb=new Uint8Array(Ea-ia);for(var Zb=0;ia<Ea;ia++,Zb++)sb[Zb]=R[ia];return sb.buffer},Ng={},fk=Ng=function(R,ia,Ea){function sb(Vc,Yd){if(0>=sb.count)throw Error("after called too many times");--sb.count;Vc?(Zb=!0,ia(Vc),ia=Ea):0!==
sb.count||Zb||ia(null,Yd)}var Zb=!1;Ea=Ea||Sc;sb.count=R;return 0===R?ia():sb},Sh={};(function(R){Sh.encode=function(ia){ia=new Uint8Array(ia);var Ea,sb=ia.length,Zb="";for(Ea=0;Ea<sb;Ea+=3)Zb+=R[ia[Ea]>>2],Zb+=R[(ia[Ea]&3)<<4|ia[Ea+1]>>4],Zb+=R[(ia[Ea+1]&15)<<2|ia[Ea+2]>>6],Zb+=R[ia[Ea+2]&63];2===sb%3?Zb=Zb.substring(0,Zb.length-1)+"=":1===sb%3&&(Zb=Zb.substring(0,Zb.length-2)+"==");return Zb};Sh.decode=function(ia){var Ea=.75*ia.length,sb=ia.length,Zb=0;"="===ia[ia.length-1]&&(Ea--,"="===ia[ia.length-
2]&&Ea--);var Vc=new ArrayBuffer(Ea),Yd=new Uint8Array(Vc);for(Ea=0;Ea<sb;Ea+=4){var ce=R.indexOf(ia[Ea]);var ve=R.indexOf(ia[Ea+1]);var wf=R.indexOf(ia[Ea+2]);var lg=R.indexOf(ia[Ea+3]);Yd[Zb++]=ce<<2|ve>>4;Yd[Zb++]=(ve&15)<<4|wf>>2;Yd[Zb++]=(wf&3)<<6|lg&63}return Vc}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");var Oj={},Zj="undefined"!==typeof Zj?Zj:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?
MozBlobBuilder:!1;try{var Ql=2===(new Blob(["hi"])).size}catch(R){Ql=!1}var Tk;if(Tk=Ql)try{Tk=2===(new Blob([new Uint8Array([1,2])])).size}catch(R){Tk=!1}var ok=Tk,Rl=Zj&&Zj.prototype.append&&Zj.prototype.getBlob;"undefined"!==typeof Blob&&(Xb.prototype=Blob.prototype,qb.prototype=Blob.prototype);Oj=Ql?ok?Blob:qb:Rl?Xb:void 0;var Gj=Oj,dk={},Ln=dk=Object.keys||function(R){var ia=[],Ea=Object.prototype.hasOwnProperty,sb;for(sb in R)Ea.call(R,sb)&&ia.push(sb);return ia},Of={},Vk=String.fromCharCode,
Tb,qd,te;Of={version:"2.1.2",encode:function(R,ia){ia=ia||{};ia=!1!==ia.strict;R=uc(R);for(var Ea=R.length,sb=-1,Zb,Vc="";++sb<Ea;){Zb=R[sb];var Yd=ia;if(0==(Zb&4294967168))Zb=Vk(Zb);else{var ce="";0==(Zb&4294965248)?ce=Vk(Zb>>6&31|192):0==(Zb&4294901760)?(Hc(Zb,Yd)||(Zb=65533),ce=Vk(Zb>>12&15|224),ce+=Vk(Zb>>6&63|128)):0==(Zb&4292870144)&&(ce=Vk(Zb>>18&7|240),ce+=Vk(Zb>>12&63|128),ce+=Vk(Zb>>6&63|128));Zb=ce+=Vk(Zb&63|128)}Vc+=Zb}return Vc},decode:function(R,ia){ia=ia||{};ia=!1!==ia.strict;Tb=uc(R);
qd=Tb.length;te=0;R=[];for(var Ea;!1!==(Ea=Va(ia));)R.push(Ea);ia=R.length;Ea=-1;for(var sb,Zb="";++Ea<ia;)sb=R[Ea],65535<sb&&(sb-=65536,Zb+=Vk(sb>>>10&1023|55296),sb=56320|sb&1023),Zb+=Vk(sb);return Zb}};var lc={},zg=fk,Vg=Of,qj;"undefined"!==typeof ArrayBuffer&&(qj=Sh);var Jn="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),qo="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),Mo=Jn||qo;lc.protocol=3;var Hn=lc.packets={open:0,close:1,ping:2,pong:3,message:4,
upgrade:5,noop:6},en=Ln(Hn),Uk={type:"error",data:"parser error"};lc.encodePacket=function(R,ia,Ea,sb){"function"===typeof ia&&(sb=ia,ia=!1);"function"===typeof Ea&&(sb=Ea,Ea=null);var Zb=void 0===R.data?void 0:R.data.buffer||R.data;if("undefined"!==typeof ArrayBuffer&&Zb instanceof ArrayBuffer){if(ia){Ea=R.data;ia=new Uint8Array(Ea);Ea=new Uint8Array(1+Ea.byteLength);Ea[0]=Hn[R.type];for(R=0;R<ia.length;R++)Ea[R+1]=ia[R];R=sb(Ea.buffer)}else R=lc.encodeBase64Packet(R,sb);return R}if("undefined"!==
typeof Gj&&Zb instanceof Gj)return ia?Mo?R=tb(R,ia,sb):(ia=new Uint8Array(1),ia[0]=Hn[R.type],R=new Gj([ia.buffer,R.data]),R=sb(R)):R=lc.encodeBase64Packet(R,sb),R;if(Zb&&Zb.base64)return sb("b"+lc.packets[R.type]+R.data.data);ia=Hn[R.type];void 0!==R.data&&(ia+=Ea?Vg.encode(String(R.data),{strict:!1}):String(R.data));return sb(""+ia)};lc.encodeBase64Packet=function(R,ia){var Ea="b"+lc.packets[R.type];if("undefined"!==typeof Gj&&R.data instanceof Gj){var sb=new FileReader;sb.onload=function(){var Yd=
sb.result.split(",")[1];ia(Ea+Yd)};return sb.readAsDataURL(R.data)}try{var Zb=String.fromCharCode.apply(null,new Uint8Array(R.data))}catch(Yd){R=new Uint8Array(R.data);Zb=Array(R.length);for(var Vc=0;Vc<R.length;Vc++)Zb[Vc]=R[Vc];Zb=String.fromCharCode.apply(null,Zb)}Ea+=btoa(Zb);return ia(Ea)};lc.decodePacket=function(R,ia,Ea){if(void 0===R)return Uk;if("string"===typeof R){if("b"===R.charAt(0))return lc.decodeBase64Packet(R.substr(1),ia);if(Ea){a:{ia=R;try{ia=Vg.decode(ia,{strict:!1})}catch(sb){R=
!1;break a}R=ia}if(!1===R)return Uk}Ea=R.charAt(0);return Number(Ea)==Ea&&en[Ea]?1<R.length?{type:en[Ea],data:R.substring(1)}:{type:en[Ea]}:Uk}Ea=(new Uint8Array(R))[0];R=xk(R,1);Gj&&"blob"===ia&&(R=new Gj([R]));return{type:en[Ea],data:R}};lc.decodeBase64Packet=function(R,ia){var Ea=en[R.charAt(0)];if(!qj)return{type:Ea,data:{base64:!0,data:R.substr(1)}};R=qj.decode(R.substr(1));"blob"===ia&&Gj&&(R=new Gj([R]));return{type:Ea,data:R}};lc.encodePayload=function(R,ia,Ea){"function"===typeof ia&&(Ea=
ia,ia=null);var sb=pj(R);if(ia&&sb)return Gj&&!Mo?lc.encodePayloadAsBlob(R,Ea):lc.encodePayloadAsArrayBuffer(R,Ea);if(!R.length)return Ea("0:");Jb(R,function(Zb,Vc){lc.encodePacket(Zb,sb?ia:!1,!1,function(Yd){Vc(null,Yd.length+":"+Yd)})},function(Zb,Vc){return Ea(Vc.join(""))})};lc.decodePayload=function(R,ia,Ea){if("string"!==typeof R)return lc.decodePayloadAsBinary(R,ia,Ea);"function"===typeof ia&&(Ea=ia,ia=null);if(""===R)return Ea(Uk,0,1);var sb="";for(var Zb,Vc,Yd=0,ce=R.length;Yd<ce;Yd++)if(Vc=
R.charAt(Yd),":"!==Vc)sb+=Vc;else{if(""===sb||sb!=(Zb=Number(sb)))return Ea(Uk,0,1);Vc=R.substr(Yd+1,Zb);if(sb!=Vc.length)return Ea(Uk,0,1);if(Vc.length){sb=lc.decodePacket(Vc,ia,!1);if(Uk.type===sb.type&&Uk.data===sb.data)return Ea(Uk,0,1);if(!1===Ea(sb,Yd+Zb,ce))return}Yd+=Zb;sb=""}if(""!==sb)return Ea(Uk,0,1)};lc.encodePayloadAsArrayBuffer=function(R,ia){if(!R.length)return ia(new ArrayBuffer(0));Jb(R,function(Ea,sb){lc.encodePacket(Ea,!0,!0,function(Zb){return sb(null,Zb)})},function(Ea,sb){Ea=
sb.reduce(function(Yd,ce){ce="string"===typeof ce?ce.length:ce.byteLength;return Yd+ce.toString().length+ce+2},0);var Zb=new Uint8Array(Ea),Vc=0;sb.forEach(function(Yd){var ce="string"===typeof Yd,ve=Yd;if(ce){ve=new Uint8Array(Yd.length);for(var wf=0;wf<Yd.length;wf++)ve[wf]=Yd.charCodeAt(wf);ve=ve.buffer}ce?Zb[Vc++]=0:Zb[Vc++]=1;Yd=ve.byteLength.toString();for(wf=0;wf<Yd.length;wf++)Zb[Vc++]=parseInt(Yd[wf]);Zb[Vc++]=255;ve=new Uint8Array(ve);for(wf=0;wf<ve.length;wf++)Zb[Vc++]=ve[wf]});return ia(Zb.buffer)})};
lc.encodePayloadAsBlob=function(R,ia){Jb(R,function(Ea,sb){lc.encodePacket(Ea,!0,!0,function(Zb){var Vc=new Uint8Array(1);Vc[0]=1;if("string"===typeof Zb){for(var Yd=new Uint8Array(Zb.length),ce=0;ce<Zb.length;ce++)Yd[ce]=Zb.charCodeAt(ce);Zb=Yd.buffer;Vc[0]=0}Yd=(Zb instanceof ArrayBuffer?Zb.byteLength:Zb.size).toString();var ve=new Uint8Array(Yd.length+1);for(ce=0;ce<Yd.length;ce++)ve[ce]=parseInt(Yd[ce]);ve[Yd.length]=255;Gj&&(Zb=new Gj([Vc.buffer,ve.buffer,Zb]),sb(null,Zb))})},function(Ea,sb){return ia(new Gj(sb))})};
lc.decodePayloadAsBinary=function(R,ia,Ea){"function"===typeof ia&&(Ea=ia,ia=null);for(var sb=[];0<R.byteLength;){for(var Zb=new Uint8Array(R),Vc=0===Zb[0],Yd="",ce=1;255!==Zb[ce];ce++){if(310<Yd.length)return Ea(Uk,0,1);Yd+=Zb[ce]}R=xk(R,2+Yd.length);Yd=parseInt(Yd);Zb=xk(R,0,Yd);if(Vc)try{Zb=String.fromCharCode.apply(null,new Uint8Array(Zb))}catch(wf){for(Vc=new Uint8Array(Zb),Zb="",ce=0;ce<Vc.length;ce++)Zb+=String.fromCharCode(Vc[ce])}sb.push(Zb);R=xk(R,Yd)}var ve=sb.length;sb.forEach(function(wf,
lg){Ea(lc.decodePacket(wf,ia,!0),lg,ve)})};for(var Fj={encode:function(R){var ia="",Ea;for(Ea in R)R.hasOwnProperty(Ea)&&(ia.length&&(ia+="&"),ia+=encodeURIComponent(Ea)+"="+encodeURIComponent(R[Ea]));return ia},decode:function(R){var ia={};R=R.split("&");for(var Ea=0,sb=R.length;Ea<sb;Ea++){var Zb=R[Ea].split("=");ia[decodeURIComponent(Zb[0])]=decodeURIComponent(Zb[1])}return ia}},ro={},gn=ro=function(R,ia){var Ea=function(){};Ea.prototype=ia.prototype;R.prototype=new Ea;R.prototype.constructor=
R},vm={},No="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),fn={},em=0,Lk=0,Lm;64>Lk;Lk++)fn[No[Lk]]=Lk;ib.encode=Ib;ib.decode=function(R){var ia=0;for(Lk=0;Lk<R.length;Lk++)ia=64*ia+fn[R.charAt(Lk)];return ia};var ol=vm=ib,wg="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,hn={},In=lc;hn=jb;cd(jb.prototype);jb.prototype.onError=function(R,ia){R=Error(R);R.type="TransportError";R.description=ia;this.emit("error",R);return this||wg};jb.prototype.open=
function(){if("closed"===(this||wg).readyState||""===(this||wg).readyState)(this||wg).readyState="opening",this.doOpen();return this||wg};jb.prototype.close=function(){if("opening"===(this||wg).readyState||"open"===(this||wg).readyState)this.doClose(),this.onClose();return this||wg};jb.prototype.send=function(R){if("open"===(this||wg).readyState)this.write(R);else throw Error("Transport not open");};jb.prototype.onOpen=function(){(this||wg).readyState="open";(this||wg).writable=!0;this.emit("open")};
jb.prototype.onData=function(R){R=In.decodePacket(R,(this||wg).socket.binaryType);this.onPacket(R)};jb.prototype.onPacket=function(R){this.emit("packet",R)};jb.prototype.onClose=function(){(this||wg).readyState="closed";this.emit("close")};var Sl=hn,ig="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Mm={},nl=Sl,ek=lc,Gi=Ua("engine.io-client:polling");Mm=Fb;var wm=null!=(new rd({xdomain:!1})).responseType;gn(Fb,nl);Fb.prototype.name="polling";Fb.prototype.doOpen=function(){this.poll()};
Fb.prototype.pause=function(R){function ia(){Gi("paused");Ea.readyState="paused";R()}var Ea=this||ig;(this||ig).readyState="pausing";if((this||ig).polling||!(this||ig).writable){var sb=0;(this||ig).polling&&(Gi("we are currently polling - waiting to pause"),sb++,this.once("pollComplete",function(){Gi("pre-pause polling complete");--sb||ia()}));(this||ig).writable||(Gi("we are currently writing - waiting to pause"),sb++,this.once("drain",function(){Gi("pre-pause writing complete");--sb||ia()}))}else ia()};
Fb.prototype.poll=function(){Gi("polling");(this||ig).polling=!0;this.doPoll();this.emit("poll")};Fb.prototype.onData=function(R){var ia=this||ig;Gi("polling got data %s",R);ek.decodePayload(R,(this||ig).socket.binaryType,function(Ea,sb,Zb){if("opening"===ia.readyState)ia.onOpen();if("close"===Ea.type)return ia.onClose(),!1;ia.onPacket(Ea)});"closed"!==(this||ig).readyState&&((this||ig).polling=!1,this.emit("pollComplete"),"open"===(this||ig).readyState?this.poll():Gi('ignoring poll - transport state "%s"',
(this||ig).readyState))};Fb.prototype.doClose=function(){function R(){Gi("writing close packet");ia.write([{type:"close"}])}var ia=this||ig;"open"===(this||ig).readyState?(Gi("transport open - closing"),R()):(Gi("transport not open - deferring close"),this.once("open",R))};Fb.prototype.write=function(R){var ia=this||ig;(this||ig).writable=!1;var Ea=function(){ia.writable=!0;ia.emit("drain")};ek.encodePayload(R,(this||ig).supportsBinary,function(sb){ia.doWrite(sb,Ea)})};Fb.prototype.uri=function(){var R=
(this||ig).query||{},ia=(this||ig).secure?"https":"http",Ea="";!1!==(this||ig).timestampRequests&&(R[(this||ig).timestampParam]=ol());(this||ig).supportsBinary||R.sid||(R.b64=1);R=Fj.encode(R);(this||ig).port&&("https"===ia&&443!==Number((this||ig).port)||"http"===ia&&80!==Number((this||ig).port))&&(Ea=":"+(this||ig).port);R.length&&(R="?"+R);var sb=-1!==(this||ig).hostname.indexOf(":");return ia+"://"+(sb?"["+(this||ig).hostname+"]":(this||ig).hostname)+Ea+(this||ig).path+R};var Mk=Mm,$e="undefined"!==
typeof globalThis?globalThis:"undefined"!==typeof self?self:global,fm={},Oo=Mk,Kn=Ua("engine.io-client:polling-xhr");fm=Ic;fm.Request=ec;gn(Ic,Oo);Ic.prototype.supportsBinary=!0;Ic.prototype.request=function(R){R=R||{};R.uri=this.uri();R.xd=(this||$e).xd;R.xs=(this||$e).xs;R.agent=(this||$e).agent||!1;R.supportsBinary=(this||$e).supportsBinary;R.enablesXDR=(this||$e).enablesXDR;R.withCredentials=(this||$e).withCredentials;R.pfx=(this||$e).pfx;R.key=(this||$e).key;R.passphrase=(this||$e).passphrase;
R.cert=(this||$e).cert;R.ca=(this||$e).ca;R.ciphers=(this||$e).ciphers;R.rejectUnauthorized=(this||$e).rejectUnauthorized;R.requestTimeout=(this||$e).requestTimeout;R.extraHeaders=(this||$e).extraHeaders;return new ec(R)};Ic.prototype.doWrite=function(R,ia){R=this.request({method:"POST",data:R,isBinary:"string"!==typeof R&&void 0!==R});var Ea=this||$e;R.on("success",ia);R.on("error",function(sb){Ea.onError("xhr post error",sb)});(this||$e).sendXhr=R};Ic.prototype.doPoll=function(){Kn("xhr poll");
var R=this.request(),ia=this||$e;R.on("data",function(Ea){ia.onData(Ea)});R.on("error",function(Ea){ia.onError("xhr poll error",Ea)});(this||$e).pollXhr=R};cd(ec.prototype);ec.prototype.create=function(){var R={agent:(this||$e).agent,xdomain:(this||$e).xd,xscheme:(this||$e).xs,enablesXDR:(this||$e).enablesXDR};R.pfx=(this||$e).pfx;R.key=(this||$e).key;R.passphrase=(this||$e).passphrase;R.cert=(this||$e).cert;R.ca=(this||$e).ca;R.ciphers=(this||$e).ciphers;R.rejectUnauthorized=(this||$e).rejectUnauthorized;
var ia=(this||$e).xhr=new rd(R),Ea=this||$e;try{Kn("xhr open %s: %s",(this||$e).method,(this||$e).uri);ia.open((this||$e).method,(this||$e).uri,(this||$e).async);try{if((this||$e).extraHeaders){ia.setDisableHeaderCheck&&ia.setDisableHeaderCheck(!0);for(var sb in(this||$e).extraHeaders)(this||$e).extraHeaders.hasOwnProperty(sb)&&ia.setRequestHeader(sb,(this||$e).extraHeaders[sb])}}catch(Zb){}if("POST"===(this||$e).method)try{(this||$e).isBinary?ia.setRequestHeader("Content-type","application/octet-stream"):
ia.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(Zb){}try{ia.setRequestHeader("Accept","*/*")}catch(Zb){}"withCredentials"in ia&&(ia.withCredentials=(this||$e).withCredentials);(this||$e).requestTimeout&&(ia.timeout=(this||$e).requestTimeout);this.hasXDR()?(ia.onload=function(){Ea.onLoad()},ia.onerror=function(){Ea.onError(ia.responseText)}):ia.onreadystatechange=function(){if(2===ia.readyState)try{var Zb=ia.getResponseHeader("Content-Type");if(Ea.supportsBinary&&"application/octet-stream"===
Zb||"application/octet-stream; charset=UTF-8"===Zb)ia.responseType="arraybuffer"}catch(Vc){}if(4===ia.readyState)if(200===ia.status||1223===ia.status)Ea.onLoad();else setTimeout(function(){Ea.onError("number"===typeof ia.status?ia.status:0)},0)};Kn("xhr data %s",(this||$e).data);ia.send((this||$e).data)}catch(Zb){setTimeout(function(){Ea.onError(Zb)},0);return}"undefined"!==typeof document&&((this||$e).index=ec.requestsCount++,ec.requests[(this||$e).index]=this||$e)};ec.prototype.onSuccess=function(){this.emit("success");
this.cleanup()};ec.prototype.onData=function(R){this.emit("data",R);this.onSuccess()};ec.prototype.onError=function(R){this.emit("error",R);this.cleanup(!0)};ec.prototype.cleanup=function(R){if("undefined"!==typeof(this||$e).xhr&&null!==(this||$e).xhr){this.hasXDR()?(this||$e).xhr.onload=(this||$e).xhr.onerror=rc:(this||$e).xhr.onreadystatechange=rc;if(R)try{(this||$e).xhr.abort()}catch(ia){}"undefined"!==typeof document&&delete ec.requests[(this||$e).index];(this||$e).xhr=null}};ec.prototype.onLoad=
function(){try{try{var R=(this||$e).xhr.getResponseHeader("Content-Type")}catch(Ea){}var ia="application/octet-stream"===R||"application/octet-stream; charset=UTF-8"===R?(this||$e).xhr.response||(this||$e).xhr.responseText:(this||$e).xhr.responseText}catch(Ea){this.onError(Ea)}if(null!=ia)this.onData(ia)};ec.prototype.hasXDR=function(){return"undefined"!==typeof XDomainRequest&&!(this||$e).xs&&(this||$e).enablesXDR};ec.prototype.abort=function(){this.cleanup()};ec.requestsCount=0;ec.requests={};"undefined"!==
typeof document&&("function"===typeof attachEvent?attachEvent("onunload",Pc):"function"===typeof addEventListener&&addEventListener("onpagehide"in ud?"pagehide":"unload",Pc,!1));var Tl=fm,mp={},so=[].indexOf,np=mp=function(R,ia){if(so)return R.indexOf(ia);for(var Ea=0;Ea<R.length;++Ea)if(R[Ea]===ia)return Ea;return-1},Fh="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,op={},jn=Mk,xm=ud;op=ha;var um=/\n/g,cl=/\\n/g,yl;gn(ha,jn);ha.prototype.supportsBinary=!1;ha.prototype.doClose=
function(){(this||Fh).script&&((this||Fh).script.parentNode.removeChild((this||Fh).script),(this||Fh).script=null);(this||Fh).form&&((this||Fh).form.parentNode.removeChild((this||Fh).form),(this||Fh).form=null,(this||Fh).iframe=null);jn.prototype.doClose.call(this||Fh)};ha.prototype.doPoll=function(){var R=this||Fh,ia=document.createElement("script");(this||Fh).script&&((this||Fh).script.parentNode.removeChild((this||Fh).script),(this||Fh).script=null);ia.async=!0;ia.src=this.uri();ia.onerror=function(sb){R.onError("jsonp poll error",
sb)};var Ea=document.getElementsByTagName("script")[0];Ea?Ea.parentNode.insertBefore(ia,Ea):(document.head||document.body).appendChild(ia);(this||Fh).script=ia;"undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var sb=document.createElement("iframe");document.body.appendChild(sb);document.body.removeChild(sb)},100)};ha.prototype.doWrite=function(R,ia){function Ea(){sb();ia()}function sb(){if(Zb.iframe)try{Zb.form.removeChild(Zb.iframe)}catch(wf){Zb.onError("jsonp polling iframe removal error",
wf)}try{ve=document.createElement('<iframe src="javascript:0" name="'+Zb.iframeId+'">')}catch(wf){ve=document.createElement("iframe"),ve.name=Zb.iframeId,ve.src="javascript:0"}ve.id=Zb.iframeId;Zb.form.appendChild(ve);Zb.iframe=ve}var Zb=this||Fh;if(!(this||Fh).form){var Vc=document.createElement("form"),Yd=document.createElement("textarea"),ce=(this||Fh).iframeId="eio_iframe_"+(this||Fh).index,ve;Vc.className="socketio";Vc.style.position="absolute";Vc.style.top="-1000px";Vc.style.left="-1000px";
Vc.target=ce;Vc.method="POST";Vc.setAttribute("accept-charset","utf-8");Yd.name="d";Vc.appendChild(Yd);document.body.appendChild(Vc);(this||Fh).form=Vc;(this||Fh).area=Yd}(this||Fh).form.action=this.uri();sb();R=R.replace(cl,"\\\n");(this||Fh).area.value=R.replace(um,"\\n");try{(this||Fh).form.submit()}catch(wf){}(this||Fh).iframe.attachEvent?(this||Fh).iframe.onreadystatechange=function(){"complete"===Zb.iframe.readyState&&Ea()}:(this||Fh).iframe.onload=Ea};var zl=op,kn=Object.freeze({}),ra="undefined"!==
typeof globalThis?globalThis:"undefined"!==typeof self?self:global,La={},ob=ac.Buffer,Oa=Sl,mc=lc,fc=Ua("engine.io-client:websocket"),zc;"undefined"!==typeof WebSocket?zc=WebSocket:"undefined"!==typeof self&&(zc=self.WebSocket||self.MozWebSocket);if("undefined"===typeof window)try{var Kc=kn}catch(R){}var Nd=zc||Kc;La=Ha;gn(Ha,Oa);Ha.prototype.name="websocket";Ha.prototype.supportsBinary=!0;Ha.prototype.doOpen=function(){if(this.check()){var R=this.uri(),ia=(this||ra).protocols,Ea={};(this||ra).isReactNative||
(Ea.agent=(this||ra).agent,Ea.perMessageDeflate=(this||ra).perMessageDeflate,Ea.pfx=(this||ra).pfx,Ea.key=(this||ra).key,Ea.passphrase=(this||ra).passphrase,Ea.cert=(this||ra).cert,Ea.ca=(this||ra).ca,Ea.ciphers=(this||ra).ciphers,Ea.rejectUnauthorized=(this||ra).rejectUnauthorized);(this||ra).extraHeaders&&(Ea.headers=(this||ra).extraHeaders);(this||ra).localAddress&&(Ea.localAddress=(this||ra).localAddress);try{(this||ra).ws=(this||ra).usingBrowserWebSocket&&!(this||ra).isReactNative?ia?new Nd(R,
ia):new Nd(R):new Nd(R,ia,Ea)}catch(sb){return this.emit("error",sb)}void 0===(this||ra).ws.binaryType&&((this||ra).supportsBinary=!1);(this||ra).ws.supports&&(this||ra).ws.supports.binary?((this||ra).supportsBinary=!0,(this||ra).ws.binaryType="nodebuffer"):(this||ra).ws.binaryType="arraybuffer";this.addEventListeners()}};Ha.prototype.addEventListeners=function(){var R=this||ra;(this||ra).ws.onopen=function(){R.onOpen()};(this||ra).ws.onclose=function(){R.onClose()};(this||ra).ws.onmessage=function(ia){R.onData(ia.data)};
(this||ra).ws.onerror=function(ia){R.onError("websocket error",ia)}};Ha.prototype.write=function(R){function ia(){Ea.emit("flush");setTimeout(function(){Ea.writable=!0;Ea.emit("drain")},0)}var Ea=this||ra;(this||ra).writable=!1;for(var sb=R.length,Zb=0,Vc=sb;Zb<Vc;Zb++)(function(Yd){mc.encodePacket(Yd,Ea.supportsBinary,function(ce){if(!Ea.usingBrowserWebSocket){var ve={};Yd.options&&(ve.compress=Yd.options.compress);Ea.perMessageDeflate&&("string"===typeof ce?ob.byteLength(ce):ce.length)<Ea.perMessageDeflate.threshold&&
(ve.compress=!1)}try{Ea.usingBrowserWebSocket?Ea.ws.send(ce):Ea.ws.send(ce,ve)}catch(wf){fc("websocket closed before onclose event")}--sb||ia()})})(R[Zb])};Ha.prototype.onClose=function(){Oa.prototype.onClose.call(this||ra)};Ha.prototype.doClose=function(){"undefined"!==typeof(this||ra).ws&&(this||ra).ws.close()};Ha.prototype.uri=function(){var R=(this||ra).query||{},ia=(this||ra).secure?"wss":"ws",Ea="";(this||ra).port&&("wss"===ia&&443!==Number((this||ra).port)||"ws"===ia&&80!==Number((this||ra).port))&&
(Ea=":"+(this||ra).port);(this||ra).timestampRequests&&(R[(this||ra).timestampParam]=ol());(this||ra).supportsBinary||(R.b64=1);R=Fj.encode(R);R.length&&(R="?"+R);var sb=-1!==(this||ra).hostname.indexOf(":");return ia+"://"+(sb?"["+(this||ra).hostname+"]":(this||ra).hostname)+Ea+(this||ra).path+R};Ha.prototype.check=function(){return!!Nd&&!("__initialize"in Nd&&(this||ra).name===Ha.prototype.name)};var Df={},Nf=La;Df.polling=function(R){var ia=!1,Ea=!1,sb=!1!==R.jsonp;"undefined"!==typeof location&&
(Ea="https:"===location.protocol,(ia=location.port)||(ia=Ea?443:80),ia=R.hostname!==location.hostname||ia!==R.port,Ea=R.secure!==Ea);R.xdomain=ia;R.xscheme=Ea;if("open"in new rd(R)&&!R.forceJSONP)return new Tl(R);if(!sb)throw Error("JSONP disabled");return new zl(R)};Df.websocket=Nf;var ld="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,vg={},rg=Ua("engine.io-client:socket"),Pj=lc,bl=me,lp=Fj;vg=Pa;Pa.priorWebsocketSuccess=!1;cd(Pa.prototype);Pa.protocol=Pj.protocol;
Pa.Socket=Pa;Pa.Transport=Sl;Pa.transports=Df;Pa.parser=lc;Pa.prototype.createTransport=function(R){rg('creating transport "%s"',R);var ia=(this||ld).query,Ea={},sb;for(sb in ia)ia.hasOwnProperty(sb)&&(Ea[sb]=ia[sb]);Ea.EIO=Pj.protocol;Ea.transport=R;ia=(this||ld).transportOptions[R]||{};(this||ld).id&&(Ea.sid=(this||ld).id);return new Df[R]({query:Ea,socket:this||ld,agent:ia.agent||(this||ld).agent,hostname:ia.hostname||(this||ld).hostname,port:ia.port||(this||ld).port,secure:ia.secure||(this||ld).secure,
path:ia.path||(this||ld).path,forceJSONP:ia.forceJSONP||(this||ld).forceJSONP,jsonp:ia.jsonp||(this||ld).jsonp,forceBase64:ia.forceBase64||(this||ld).forceBase64,enablesXDR:ia.enablesXDR||(this||ld).enablesXDR,withCredentials:ia.withCredentials||(this||ld).withCredentials,timestampRequests:ia.timestampRequests||(this||ld).timestampRequests,timestampParam:ia.timestampParam||(this||ld).timestampParam,policyPort:ia.policyPort||(this||ld).policyPort,pfx:ia.pfx||(this||ld).pfx,key:ia.key||(this||ld).key,
passphrase:ia.passphrase||(this||ld).passphrase,cert:ia.cert||(this||ld).cert,ca:ia.ca||(this||ld).ca,ciphers:ia.ciphers||(this||ld).ciphers,rejectUnauthorized:ia.rejectUnauthorized||(this||ld).rejectUnauthorized,perMessageDeflate:ia.perMessageDeflate||(this||ld).perMessageDeflate,extraHeaders:ia.extraHeaders||(this||ld).extraHeaders,forceNode:ia.forceNode||(this||ld).forceNode,localAddress:ia.localAddress||(this||ld).localAddress,requestTimeout:ia.requestTimeout||(this||ld).requestTimeout,protocols:ia.protocols||
void 0,isReactNative:(this||ld).isReactNative})};Pa.prototype.open=function(){if((this||ld).rememberUpgrade&&Pa.priorWebsocketSuccess&&-1!==(this||ld).transports.indexOf("websocket"))var R="websocket";else{if(0===(this||ld).transports.length){var ia=this||ld;setTimeout(function(){ia.emit("error","No transports available")},0);return}R=(this||ld).transports[0]}(this||ld).readyState="opening";try{R=this.createTransport(R)}catch(Ea){(this||ld).transports.shift();this.open();return}R.open();this.setTransport(R)};
Pa.prototype.setTransport=function(R){rg("setting transport %s",R.name);var ia=this||ld;(this||ld).transport&&(rg("clearing existing transport %s",(this||ld).transport.name),(this||ld).transport.removeAllListeners());(this||ld).transport=R;R.on("drain",function(){ia.onDrain()}).on("packet",function(Ea){ia.onPacket(Ea)}).on("error",function(Ea){ia.onError(Ea)}).on("close",function(){ia.onClose("transport close")})};Pa.prototype.probe=function(R){function ia(){if(lg.onlyBinaryUpgrades){var vi=!(this||
ld).supportsBinary&&lg.transport.supportsBinary;wf=wf||vi}wf||(rg('probe transport "%s" opened',R),ve.send([{type:"ping",data:"probe"}]),ve.once("packet",function(Ii){wf||("pong"===Ii.type&&"probe"===Ii.data?(rg('probe transport "%s" pong',R),lg.upgrading=!0,lg.emit("upgrading",ve),ve&&(Pa.priorWebsocketSuccess="websocket"===ve.name,rg('pausing current transport "%s"',lg.transport.name),lg.transport.pause(function(){wf||"closed"===lg.readyState||(rg("changing transport and sending upgrade packet"),
ce(),lg.setTransport(ve),ve.send([{type:"upgrade"}]),lg.emit("upgrade",ve),ve=null,lg.upgrading=!1,lg.flush())}))):(rg('probe transport "%s" failed',R),Ii=Error("probe error"),Ii.transport=ve.name,lg.emit("upgradeError",Ii)))}))}function Ea(){wf||(wf=!0,ce(),ve.close(),ve=null)}function sb(vi){var Ii=Error("probe error: "+vi);Ii.transport=ve.name;Ea();rg('probe transport "%s" failed because of error: %s',R,vi);lg.emit("upgradeError",Ii)}function Zb(){sb("transport closed")}function Vc(){sb("socket closed")}
function Yd(vi){ve&&vi.name!==ve.name&&(rg('"%s" works - aborting "%s"',vi.name,ve.name),Ea())}function ce(){ve.removeListener("open",ia);ve.removeListener("error",sb);ve.removeListener("close",Zb);lg.removeListener("close",Vc);lg.removeListener("upgrading",Yd)}rg('probing transport "%s"',R);var ve=this.createTransport(R,{probe:1}),wf=!1,lg=this||ld;Pa.priorWebsocketSuccess=!1;ve.once("open",ia);ve.once("error",sb);ve.once("close",Zb);this.once("close",Vc);this.once("upgrading",Yd);ve.open()};Pa.prototype.onOpen=
function(){rg("socket open");(this||ld).readyState="open";Pa.priorWebsocketSuccess="websocket"===(this||ld).transport.name;this.emit("open");this.flush();if("open"===(this||ld).readyState&&(this||ld).upgrade&&(this||ld).transport.pause){rg("starting upgrade probes");for(var R=0,ia=(this||ld).upgrades.length;R<ia;R++)this.probe((this||ld).upgrades[R])}};Pa.prototype.onPacket=function(R){if("opening"===(this||ld).readyState||"open"===(this||ld).readyState||"closing"===(this||ld).readyState)switch(rg('socket receive: type "%s", data "%s"',
R.type,R.data),this.emit("packet",R),this.emit("heartbeat"),R.type){case "open":this.onHandshake(JSON.parse(R.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var ia=Error("server error");ia.code=R.data;this.onError(ia);break;case "message":this.emit("data",R.data),this.emit("message",R.data)}else rg('packet received with socket readyState "%s"',(this||ld).readyState)};Pa.prototype.onHandshake=function(R){this.emit("handshake",R);(this||ld).id=R.sid;(this||ld).transport.query.sid=
R.sid;(this||ld).upgrades=this.filterUpgrades(R.upgrades);(this||ld).pingInterval=R.pingInterval;(this||ld).pingTimeout=R.pingTimeout;this.onOpen();"closed"!==(this||ld).readyState&&(this.setPing(),this.removeListener("heartbeat",(this||ld).onHeartbeat),this.on("heartbeat",(this||ld).onHeartbeat))};Pa.prototype.onHeartbeat=function(R){clearTimeout((this||ld).pingTimeoutTimer);var ia=this||ld;ia.pingTimeoutTimer=setTimeout(function(){if("closed"!==ia.readyState)ia.onClose("ping timeout")},R||ia.pingInterval+
ia.pingTimeout)};Pa.prototype.setPing=function(){var R=this||ld;clearTimeout(R.pingIntervalTimer);R.pingIntervalTimer=setTimeout(function(){rg("writing ping packet - expecting pong within %sms",R.pingTimeout);R.ping();R.onHeartbeat(R.pingTimeout)},R.pingInterval)};Pa.prototype.ping=function(){var R=this||ld;this.sendPacket("ping",function(){R.emit("ping")})};Pa.prototype.onDrain=function(){(this||ld).writeBuffer.splice(0,(this||ld).prevBufferLen);(this||ld).prevBufferLen=0;0===(this||ld).writeBuffer.length?
this.emit("drain"):this.flush()};Pa.prototype.flush=function(){"closed"!==(this||ld).readyState&&(this||ld).transport.writable&&!(this||ld).upgrading&&(this||ld).writeBuffer.length&&(rg("flushing %d packets in socket",(this||ld).writeBuffer.length),(this||ld).transport.send((this||ld).writeBuffer),(this||ld).prevBufferLen=(this||ld).writeBuffer.length,this.emit("flush"))};Pa.prototype.write=Pa.prototype.send=function(R,ia,Ea){this.sendPacket("message",R,ia,Ea);return this||ld};Pa.prototype.sendPacket=
function(R,ia,Ea,sb){"function"===typeof ia&&(sb=ia,ia=void 0);"function"===typeof Ea&&(sb=Ea,Ea=null);if("closing"!==(this||ld).readyState&&"closed"!==(this||ld).readyState){Ea=Ea||{};Ea.compress=!1!==Ea.compress;R={type:R,data:ia,options:Ea};this.emit("packetCreate",R);(this||ld).writeBuffer.push(R);if(sb)this.once("flush",sb);this.flush()}};Pa.prototype.close=function(){function R(){sb.onClose("forced close");rg("socket closing - telling transport to close");sb.transport.close()}function ia(){sb.removeListener("upgrade",
ia);sb.removeListener("upgradeError",ia);R()}function Ea(){sb.once("upgrade",ia);sb.once("upgradeError",ia)}if("opening"===(this||ld).readyState||"open"===(this||ld).readyState){(this||ld).readyState="closing";var sb=this||ld;if((this||ld).writeBuffer.length)this.once("drain",function(){(this||ld).upgrading?Ea():R()});else(this||ld).upgrading?Ea():R()}return this||ld};Pa.prototype.onError=function(R){rg("socket error %j",R);Pa.priorWebsocketSuccess=!1;this.emit("error",R);this.onClose("transport error",
R)};Pa.prototype.onClose=function(R,ia){if("opening"===(this||ld).readyState||"open"===(this||ld).readyState||"closing"===(this||ld).readyState){rg('socket close with reason: "%s"',R);var Ea=this||ld;clearTimeout((this||ld).pingIntervalTimer);clearTimeout((this||ld).pingTimeoutTimer);(this||ld).transport.removeAllListeners("close");(this||ld).transport.close();(this||ld).transport.removeAllListeners();(this||ld).readyState="closed";(this||ld).id=null;this.emit("close",R,ia);Ea.writeBuffer=[];Ea.prevBufferLen=
0}};Pa.prototype.filterUpgrades=function(R){for(var ia=[],Ea=0,sb=R.length;Ea<sb;Ea++)~np((this||ld).transports,R[Ea])&&ia.push(R[Ea]);return ia};var Km={};Km=vg;Km.parser=lc;var Er=Km,Ms={},Jq=Ms=function(R,ia){for(var Ea=[],sb=(ia=ia||0)||0;sb<R.length;sb++)Ea[sb-ia]=R[sb];return Ea},pp={},Kq=[].slice,Al=pp=function(R,ia){"string"==typeof ia&&(ia=R[ia]);if("function"!=typeof ia)throw Error("bind() requires a function");var Ea=Kq.call(arguments,2);return function(){return ia.apply(R,Ea.concat(Kq.call(arguments)))}},
Fr={},gm=Fr=function(R,ia,Ea){R.on(ia,Ea);return{destroy:function(){R.removeListener(ia,Ea)}}},sf="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Gr={},Bl=Cb,Cl=Ua("socket.io-client:socket");Gr=Gr=bc;var Lq={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},Xp=cd.prototype.emit;cd(bc.prototype);bc.prototype.subEvents=function(){if(!(this||
sf).subs){var R=(this||sf).io;(this||sf).subs=[gm(R,"open",Al(this||sf,"onopen")),gm(R,"packet",Al(this||sf,"onpacket")),gm(R,"close",Al(this||sf,"onclose"))]}};bc.prototype.open=bc.prototype.connect=function(){if((this||sf).connected)return this||sf;this.subEvents();(this||sf).io.reconnecting||(this||sf).io.open();if("open"===(this||sf).io.readyState)this.onopen();this.emit("connecting");return this||sf};bc.prototype.send=function(){var R=Jq(arguments);R.unshift("message");(this||sf).emit.apply(this||
sf,R);return this||sf};bc.prototype.emit=function(R){if(Lq.hasOwnProperty(R))return Xp.apply(this||sf,arguments),this||sf;var ia=Jq(arguments),Ea={type:(void 0!==(this||sf).flags.binary?(this||sf).flags.binary:pj(ia))?Bl.BINARY_EVENT:Bl.EVENT,data:ia,options:{}};Ea.options.compress=!(this||sf).flags||!1!==(this||sf).flags.compress;"function"===typeof ia[ia.length-1]&&(Cl("emitting packet with ack id %d",(this||sf).ids),(this||sf).acks[(this||sf).ids]=ia.pop(),Ea.id=(this||sf).ids++);(this||sf).connected?
this.packet(Ea):(this||sf).sendBuffer.push(Ea);(this||sf).flags={};return this||sf};bc.prototype.packet=function(R){R.nsp=(this||sf).nsp;(this||sf).io.packet(R)};bc.prototype.onopen=function(){Cl("transport is open - connecting");if("/"!==(this||sf).nsp)if((this||sf).query){var R="object"===typeof(this||sf).query?Fj.encode((this||sf).query):(this||sf).query;Cl("sending connect packet with query %s",R);this.packet({type:Bl.CONNECT,query:R})}else this.packet({type:Bl.CONNECT})};bc.prototype.onclose=
function(R){Cl("close (%s)",R);(this||sf).connected=!1;(this||sf).disconnected=!0;delete (this||sf).id;this.emit("disconnect",R)};bc.prototype.onpacket=function(R){var ia=R.type===Bl.ERROR&&"/"===R.nsp;if(R.nsp===(this||sf).nsp||ia)switch(R.type){case Bl.CONNECT:this.onconnect();break;case Bl.EVENT:this.onevent(R);break;case Bl.BINARY_EVENT:this.onevent(R);break;case Bl.ACK:this.onack(R);break;case Bl.BINARY_ACK:this.onack(R);break;case Bl.DISCONNECT:this.ondisconnect();break;case Bl.ERROR:this.emit("error",
R.data)}};bc.prototype.onevent=function(R){var ia=R.data||[];Cl("emitting event %j",ia);null!=R.id&&(Cl("attaching ack callback to event"),ia.push(this.ack(R.id)));(this||sf).connected?Xp.apply(this||sf,ia):(this||sf).receiveBuffer.push(ia)};bc.prototype.ack=function(R){var ia=this||sf,Ea=!1;return function(){if(!Ea){Ea=!0;var sb=Jq(arguments);Cl("sending ack %j",sb);ia.packet({type:pj(sb)?Bl.BINARY_ACK:Bl.ACK,id:R,data:sb})}}};bc.prototype.onack=function(R){var ia=(this||sf).acks[R.id];"function"===
typeof ia?(Cl("calling ack %s with %j",R.id,R.data),ia.apply(this||sf,R.data),delete (this||sf).acks[R.id]):Cl("bad ack %s",R.id)};bc.prototype.onconnect=function(){(this||sf).connected=!0;(this||sf).disconnected=!1;this.emit("connect");this.emitBuffered()};bc.prototype.emitBuffered=function(){var R;for(R=0;R<(this||sf).receiveBuffer.length;R++)Xp.apply(this||sf,(this||sf).receiveBuffer[R]);(this||sf).receiveBuffer=[];for(R=0;R<(this||sf).sendBuffer.length;R++)this.packet((this||sf).sendBuffer[R]);
(this||sf).sendBuffer=[]};bc.prototype.ondisconnect=function(){Cl("server disconnect (%s)",(this||sf).nsp);this.destroy();this.onclose("io server disconnect")};bc.prototype.destroy=function(){if((this||sf).subs){for(var R=0;R<(this||sf).subs.length;R++)(this||sf).subs[R].destroy();(this||sf).subs=null}(this||sf).io.destroy(this||sf)};bc.prototype.close=bc.prototype.disconnect=function(){(this||sf).connected&&(Cl("performing disconnect (%s)",(this||sf).nsp),this.packet({type:Bl.DISCONNECT}));this.destroy();
if((this||sf).connected)this.onclose("io client disconnect");return this||sf};bc.prototype.compress=function(R){(this||sf).flags.compress=R;return this||sf};bc.prototype.binary=function(R){(this||sf).flags.binary=R;return this||sf};var Yp=Gr,dl="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,qp={};qp=ic;ic.prototype.duration=function(){var R=(this||dl).ms*Math.pow((this||dl).factor,(this||dl).attempts++);if((this||dl).jitter){var ia=Math.random(),Ea=Math.floor(ia*
(this||dl).jitter*R);R=0==(Math.floor(10*ia)&1)?R-Ea:R+Ea}return Math.min(R,(this||dl).max)|0};ic.prototype.reset=function(){(this||dl).attempts=0};ic.prototype.setMin=function(R){(this||dl).ms=R};ic.prototype.setMax=function(R){(this||dl).max=R};ic.prototype.setJitter=function(R){(this||dl).jitter=R};var Mq=qp,Nq={},rp=Ua("socket.io-client:url"),Zp=Nq=function(R,ia){var Ea=R;ia=ia||"undefined"!==typeof location&&location;null==R&&(R=ia.protocol+"//"+ia.host);"string"===typeof R&&("/"===R.charAt(0)&&
(R="/"===R.charAt(1)?ia.protocol+R:ia.host+R),/^(https?|wss?):\/\//.test(R)||(rp("protocol-less url %s",R),R="undefined"!==typeof ia?ia.protocol+"//"+R:"https://"+R),rp("parse %s",R),Ea=me(R));Ea.port||(/^(http|ws)$/.test(Ea.protocol)?Ea.port="80":/^(http|ws)s$/.test(Ea.protocol)&&(Ea.port="443"));Ea.path=Ea.path||"/";R=-1!==Ea.host.indexOf(":")?"["+Ea.host+"]":Ea.host;Ea.id=Ea.protocol+"://"+R+":"+Ea.port;Ea.href=Ea.protocol+"://"+R+(ia&&ia.port===Ea.port?"":":"+Ea.port);return Ea},ne="undefined"!==
typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Dl={},Ns=Cb,Nk=Ua("socket.io-client:manager"),Oq=Mq,Os=Object.prototype.hasOwnProperty;Dl=Ra;Ra.prototype.emitAll=function(){(this||ne).emit.apply(this||ne,arguments);for(var R in(this||ne).nsps)Os.call((this||ne).nsps,R)&&(this||ne).nsps[R].emit.apply((this||ne).nsps[R],arguments)};Ra.prototype.updateSocketIds=function(){for(var R in(this||ne).nsps)Os.call((this||ne).nsps,R)&&((this||ne).nsps[R].id=this.generateId(R))};Ra.prototype.generateId=
function(R){return("/"===R?"":R+"#")+(this||ne).engine.id};cd(Ra.prototype);Ra.prototype.reconnection=function(R){if(!arguments.length)return(this||ne)._reconnection;(this||ne)._reconnection=!!R;return this||ne};Ra.prototype.reconnectionAttempts=function(R){if(!arguments.length)return(this||ne)._reconnectionAttempts;(this||ne)._reconnectionAttempts=R;return this||ne};Ra.prototype.reconnectionDelay=function(R){if(!arguments.length)return(this||ne)._reconnectionDelay;(this||ne)._reconnectionDelay=R;
(this||ne).backoff&&(this||ne).backoff.setMin(R);return this||ne};Ra.prototype.randomizationFactor=function(R){if(!arguments.length)return(this||ne)._randomizationFactor;(this||ne)._randomizationFactor=R;(this||ne).backoff&&(this||ne).backoff.setJitter(R);return this||ne};Ra.prototype.reconnectionDelayMax=function(R){if(!arguments.length)return(this||ne)._reconnectionDelayMax;(this||ne)._reconnectionDelayMax=R;(this||ne).backoff&&(this||ne).backoff.setMax(R);return this||ne};Ra.prototype.timeout=
function(R){if(!arguments.length)return(this||ne)._timeout;(this||ne)._timeout=R;return this||ne};Ra.prototype.maybeReconnectOnOpen=function(){!(this||ne).reconnecting&&(this||ne)._reconnection&&0===(this||ne).backoff.attempts&&this.reconnect()};Ra.prototype.open=Ra.prototype.connect=function(R,ia){Nk("readyState %s",(this||ne).readyState);if(~(this||ne).readyState.indexOf("open"))return this||ne;Nk("opening %s",(this||ne).uri);(this||ne).engine=Er((this||ne).uri,(this||ne).opts);var Ea=(this||ne).engine,
sb=this||ne;(this||ne).readyState="opening";(this||ne).skipReconnect=!1;var Zb=gm(Ea,"open",function(){sb.onopen();R&&R()});ia=gm(Ea,"error",function(ce){Nk("connect_error");sb.cleanup();sb.readyState="closed";sb.emitAll("connect_error",ce);if(R){var ve=Error("Connection error");ve.data=ce;R(ve)}else sb.maybeReconnectOnOpen()});if(!1!==(this||ne)._timeout){var Vc=(this||ne)._timeout;Nk("connect attempt will timeout after %d",Vc);0===Vc&&Zb.destroy();var Yd=setTimeout(function(){Nk("connect attempt timed out after %d",
Vc);Zb.destroy();Ea.close();Ea.emit("error","timeout");sb.emitAll("connect_timeout",Vc)},Vc);(this||ne).subs.push({destroy:function(){clearTimeout(Yd)}})}(this||ne).subs.push(Zb);(this||ne).subs.push(ia);return this||ne};Ra.prototype.onopen=function(){Nk("open");this.cleanup();(this||ne).readyState="open";this.emit("open");var R=(this||ne).engine;(this||ne).subs.push(gm(R,"data",Al(this||ne,"ondata")));(this||ne).subs.push(gm(R,"ping",Al(this||ne,"onping")));(this||ne).subs.push(gm(R,"pong",Al(this||
ne,"onpong")));(this||ne).subs.push(gm(R,"error",Al(this||ne,"onerror")));(this||ne).subs.push(gm(R,"close",Al(this||ne,"onclose")));(this||ne).subs.push(gm((this||ne).decoder,"decoded",Al(this||ne,"ondecoded")))};Ra.prototype.onping=function(){(this||ne).lastPing=new Date;this.emitAll("ping")};Ra.prototype.onpong=function(){this.emitAll("pong",new Date-(this||ne).lastPing)};Ra.prototype.ondata=function(R){(this||ne).decoder.add(R)};Ra.prototype.ondecoded=function(R){this.emit("packet",R)};Ra.prototype.onerror=
function(R){Nk("error",R);this.emitAll("error",R)};Ra.prototype.socket=function(R,ia){function Ea(){~np(Zb.connecting,sb)||Zb.connecting.push(sb)}var sb=(this||ne).nsps[R];if(!sb){sb=new Yp(this||ne,R,ia);(this||ne).nsps[R]=sb;var Zb=this||ne;sb.on("connecting",Ea);sb.on("connect",function(){sb.id=Zb.generateId(R)});(this||ne).autoConnect&&Ea()}return sb};Ra.prototype.destroy=function(R){R=np((this||ne).connecting,R);~R&&(this||ne).connecting.splice(R,1);(this||ne).connecting.length||this.close()};
Ra.prototype.packet=function(R){Nk("writing packet %j",R);var ia=this||ne;R.query&&0===R.type&&(R.nsp+="?"+R.query);ia.encoding?ia.packetBuffer.push(R):(ia.encoding=!0,(this||ne).encoder.encode(R,function(Ea){for(var sb=0;sb<Ea.length;sb++)ia.engine.write(Ea[sb],R.options);ia.encoding=!1;ia.processPacketQueue()}))};Ra.prototype.processPacketQueue=function(){if(0<(this||ne).packetBuffer.length&&!(this||ne).encoding){var R=(this||ne).packetBuffer.shift();this.packet(R)}};Ra.prototype.cleanup=function(){Nk("cleanup");
for(var R=(this||ne).subs.length,ia=0;ia<R;ia++)(this||ne).subs.shift().destroy();(this||ne).packetBuffer=[];(this||ne).encoding=!1;(this||ne).lastPing=null;(this||ne).decoder.destroy()};Ra.prototype.close=Ra.prototype.disconnect=function(){Nk("disconnect");(this||ne).skipReconnect=!0;(this||ne).reconnecting=!1;"opening"===(this||ne).readyState&&this.cleanup();(this||ne).backoff.reset();(this||ne).readyState="closed";(this||ne).engine&&(this||ne).engine.close()};Ra.prototype.onclose=function(R){Nk("onclose");
this.cleanup();(this||ne).backoff.reset();(this||ne).readyState="closed";this.emit("close",R);(this||ne)._reconnection&&!(this||ne).skipReconnect&&this.reconnect()};Ra.prototype.reconnect=function(){if((this||ne).reconnecting||(this||ne).skipReconnect)return this||ne;var R=this||ne;if((this||ne).backoff.attempts>=(this||ne)._reconnectionAttempts)Nk("reconnect failed"),(this||ne).backoff.reset(),this.emitAll("reconnect_failed"),(this||ne).reconnecting=!1;else{var ia=(this||ne).backoff.duration();Nk("will wait %dms before reconnect attempt",
ia);(this||ne).reconnecting=!0;var Ea=setTimeout(function(){R.skipReconnect||(Nk("attempting reconnect"),R.emitAll("reconnect_attempt",R.backoff.attempts),R.emitAll("reconnecting",R.backoff.attempts),R.skipReconnect||R.open(function(sb){sb?(Nk("reconnect attempt error"),R.reconnecting=!1,R.reconnect(),R.emitAll("reconnect_error",sb.data)):(Nk("reconnect success"),R.onreconnect())}))},ia);(this||ne).subs.push({destroy:function(){clearTimeout(Ea)}})}};Ra.prototype.onreconnect=function(){var R=(this||
ne).backoff.attempts;(this||ne).reconnecting=!1;(this||ne).backoff.reset();this.updateSocketIds();this.emitAll("reconnect",R)};var Ps=Dl,to={},Hr=Zp,Ir=Cb,Pq=Ps,Qs=Ua("socket.io-client");to=to=tc;var Po=to.managers={};to.protocol=Ir.protocol;to.connect=tc;to.Manager=Ps;to.Socket=Yp;var hu=to,Jg=lively.FreezerRuntime.recorderFor("lively.2lively/client.js");Jg.determineLocation=function(){return"undefined"!==typeof document&&document.location?document.location.origin:Jg.isNode?System._nodeRequire("os").hostname():
System.baseURL};Jg.promise=Qb;Jg.fun=be;Jg.obj=bd;Jg.events=Sd;Jg.num=ed;Jg.L2LConnection=md;Jg.defaultActions=Wa;Jg.defaultClientActions=db;Jg.isNode="undefined"!==typeof System?System.get("@system-env").node:"undefined"!==typeof process&&process.env;Jg._ioClient=hu;Jg.ioClient=Jg.ioClient||void 0;Jg.isNode?(Jg.require=System._nodeRequire("module")._load,Jg.ioClient=Jg.require("socket.io-client")):Jg.ioClient=Jg._ioClient;Jg.urlHelper={isRoot:function(R){return"/"===Jg.urlHelper.path(R)},root:function(R){return Jg.urlHelper.isRoot(R)?
R:R.slice(0,-Jg.urlHelper.path(R).length)+"/"},path:function(){var R=/^[a-z0-9-_\.]+:/,ia=/^\/\/[^\/]+/;return function(Ea){Ea=Ea.replace(R,"").replace(ia,"");return""===Ea?"/":Ea}}(),join:function(R,ia){R.endsWith("/")&&(R=R.slice(0,-1));ia.startsWith("/")&&(ia=ia.slice(1));return R+"/"+ia}};var Pi=function(R,ia,Ea,sb){var Zb=Jg.L2LConnection.call(this)||this;Jg.events.makeEmitter(Zb);Zb.info=sb;Zb.origin=R;Zb.path=ia;Zb.namespace=Ea.replace(/^\/?/,"/");Zb.trackerId=null;Zb._socketioClient=null;
Zb._reconnectState={closed:!1,autoReconnect:!0,isReconnecting:!1,isReconnectingViaSocketio:!1,registerAttempt:0,registerProcess:null,isOpening:!1};Object.keys(Jg.defaultActions).forEach(function(Vc){return Zb.addService(Vc,Jg.defaultActions[Vc])});Object.keys(Jg.defaultClientActions).forEach(function(Vc){return Zb.addService(Vc,Jg.defaultClientActions[Vc])});return Zb};$jscomp.inherits(Pi,Jg.L2LConnection);Pi.clientKey=function(R,ia,Ea){R=R.replace(/\/$/,"");ia=ia.replace(/^\//,"");Ea=Ea.replace(/^\//,
"");return R+"-"+ia+"-"+Ea};Pi.forLivelyInBrowser=function(R){var ia=!!R;R=Object.assign({type:"lively.morphic browser"},R);var Ea=this.default();if(!Ea)return Jg.L2LClient.ensure({url:document.location.origin+"/lively-socket.io",namespace:"l2l",info:R});ia&&!Jg.obj.equals(Ea.info,R)&&Ea.isRegistered()&&(Ea.info=R,Ea.unregister().then(function(){return Ea.register()}).catch(function(sb){return console.error("l2l re-register on info change errored: "+sb)}));return Ea};Pi.default=function(){var R=Jg.L2LClient.clients.keys().next().value;
return Jg.L2LClient.clients.get(R)};Pi.create=function(R){var ia=R=void 0===R?{}:R;R=void 0===ia.debug?!1:ia.debug;var Ea=ia.url,sb=ia.namespace,Zb=void 0===ia.autoOpen?!0:ia.autoOpen;ia=void 0===ia.info?{}:ia.info;if(!Ea)throw Error("L2LClient needs server url!");var Vc=Jg.urlHelper.root(Ea).replace(/\/+$/,"");Ea=Jg.urlHelper.path(Ea);sb=new this(Vc,Ea,sb||"",ia);Zb&&sb.register();sb.debug=R;return sb};Pi.ensure=function(R){var ia=R=void 0===R?{}:R,Ea=ia.url;ia=ia.namespace;if(!Ea)throw Error("L2LClient needs server url!");
var sb=Jg.urlHelper.root(Ea).replace(/\/+$/,""),Zb=Jg.urlHelper.path(Ea);sb=this.clientKey(sb,Zb,ia||"");(Zb=this.clients.get(sb))||this.clients.set(sb,Zb=this.create(Object.assign({},R,{url:Ea,namespace:ia})));return Zb};Pi.prototype.isOnline=function(){return this.socket&&this.socket.connected};Pi.prototype.isRegistered=function(){return this.isOnline()&&!!this.trackerId};Pi.prototype.open=function(){var R=this,ia,Ea,sb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zb){if(1==Zb.nextAddress)return R.isOnline()||
R._reconnectState.isOpening?Zb.return(R):Zb.yield(R.close(),2);R._reconnectState.closed=!1;ia=Jg.urlHelper.join(R.origin,R.namespace);Ea={path:R.path,transports:["websocket","polling"]};sb=R._socketioClient=Jg.ioClient(ia,Ea);R.debug&&console.log("["+R+"] connecting");sb.on("error",function(Vc){R._reconnectState.isOpening=!1;R.debug&&console.log("["+R+"] errored: "+Vc)});sb.on("close",function(Vc){return R.debug&&console.log("["+R+"] closed: "+Vc)});sb.on("reconnect_failed",function(){return R.debug&&
console.log("["+R+"] could not reconnect")});sb.on("reconnect_error",function(Vc){return R.debug&&console.log("["+R+"] reconnect error "+Vc)});sb.on("connect",function(){R.debug&&console.log("["+R+"] connected");R.emit("connected",R);R._reconnectState.isOpening=!1;R._reconnectState.isReconnecting=!1;R._reconnectState.isReconnectingViaSocketio=!1});sb.on("disconnect",function(){R._reconnectState.isOpening=!1;R.debug&&console.log("["+R+"] disconnected");R.emit("disconnected",R);R.trackerId?("tracker"!==
R.trackerId&&(R.renameTarget(R.trackerId,"tracker"),R.trackerId=null),R._reconnectState.closed?R.debug&&console.log("["+R+"] won't reconnect b/c client is marked as closed"):R._reconnectState.autoReconnect?(R._reconnectState.isReconnecting=!0,setTimeout(function(){R._reconnectState.closed?R.debug&&console.log("["+R+"] won't reconnect b/c client is marked as closed 2"):R._reconnectState.isReconnectingViaSocketio?R.debug&&console.log("["+R+"] won't reconnect again, client already reconnecting"):(R.debug&&
console.log("["+R+"] initiating reconnection to tracker"),R.register())},20)):R.debug&&console.log("["+R+"] won't reconnect b/c client has reconnection disabled")):(R.debug&&console.log("["+R+"] disconnect: don't have a tracker id, won't try reconnect"),R.trackerId="tracker")});sb.on("reconnecting",function(){R.debug&&console.log("["+R+"] reconnecting",R._reconnectState);R.emit("reconnecting",R);R._reconnectState.closed?(R._reconnectState.isReconnecting=!1,R._reconnectState.isReconnectingViaSocketio=
!1,sb.close(),R.close()):(R._reconnectState.isReconnecting=!0,R._reconnectState.isReconnectingViaSocketio=!0)});sb.on("reconnect",function(){R.debug&&console.log("["+R+"] reconnected");R._reconnectState.isReconnecting=!1;R._reconnectState.isReconnectingViaSocketio=!1;R.register()});R.installEventToMessageTranslator(sb);R._reconnectState.isOpening=!0;return Zb.return((new Promise(function(Vc,Yd){sb.once("error",Yd);sb.once("connect",Vc)})).then(function(){return R}))})};Pi.prototype.close=function(){var R=
this,ia,Ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){if(1==sb.nextAddress){R._reconnectState.closed=!0;if(ia=R.socket)ia.removeAllListeners("reconnect"),ia.removeAllListeners("reconnecting"),ia.removeAllListeners("disconnect"),ia.removeAllListeners("connect"),ia.removeAllListeners("reconnect_error"),ia.removeAllListeners("reconnect_failed"),ia.removeAllListeners("close"),ia.removeAllListeners("error"),ia.close();R.debug&&console.log("["+R+"] closing...");return R.isRegistered()?
sb.yield(R.unregister(),2):sb.jumpTo(2)}return R.isOnline()||R.socket?ia&&!ia.connected?(R.debug&&console.log("["+R+"] socket not connected, considering client closed"),sb.return(R)):sb.return(Promise.race([Jg.promise.delay(2E3).then(function(){return ia.removeAllListeners("disconnect")}),new Promise(function(Zb){return ia.once("disconnect",Zb)})]).then(function(){R.debug&&console.log("["+R+"] closed");return R})):(R.debug&&(Ea=R.isOnline()?"no socket":"not online",R.debug&&console.log("["+R+"] cannot close: "+
Ea)),sb.return(R))})};Pi.prototype.remove=function(){var R=this.constructor.clientKey(this.origin,this.path,this.namespace);this.constructor.clients.delete(R);return this.close()};Pi.prototype.register=function(){var R=this,ia,Ea,sb,Zb,Vc,Yd,ce,ve,wf,lg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vi){switch(vi.nextAddress){case 1:if(R.isRegistered())return vi.return();if(R._reconnectState.closed)return R.debug&&console.log("["+R+"] not registering this b/c closed"),R._reconnectState.registerAttempt=
0,vi.return();if(R._reconnectState.registerProcess)return R.debug&&console.log("["+R+"] not registering this b/c register process exists"),vi.return();vi.setCatchFinallyBlocks(2);if(R.isOnline()){vi.jumpTo(4);break}return vi.yield(R.open(),4);case 4:return R.debug&&console.log("["+R+"] register"),vi.yield(R.sendToAndWait("tracker","register",Object.assign({userName:"unknown",type:"l2l "+(Jg.isNode?"node":"browser"),location:Jg.determineLocation()},R.info)),6);case 6:ia=vi.yieldResult;if(!ia.data)throw Ea=
Error("Register answer is empty!"),R.emit("error",Ea),Ea;if(ia.data.isError)throw sb=Error(ia.data.error),R.emit("error",sb),sb;R._reconnectState.registerAttempt=0;Zb=ia;Vc=Zb.data;Yd=Vc.trackerId;ce=Vc.messageNumber;R.trackerId=Yd;R._incomingOrderNumberingBySenders.set(Yd,ce||0);R.emit("registered",{trackerId:Yd});vi.leaveTryBlock(0);break;case 2:ve=vi.enterCatchBlock(),console.error("Error in register request of "+R+": "+ve),wf=R._reconnectState.registerAttempt++,lg=Jg.num.backoff(wf,4,3E5),R._reconnectState.registerProcess=
setTimeout(function(){R._reconnectState.registerProcess=null;R.register()},lg),vi.jumpToEnd()}})};Pi.prototype.unregister=function(){var R=this,ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ea){switch(Ea.nextAddress){case 1:if(!R.isRegistered())return Ea.return();R.debug&&console.log("["+R+"] unregister");ia=R.trackerId;Ea.setCatchFinallyBlocks(2);return Ea.yield(R.sendToAndWait(R.trackerId,"unregister",{}),4);case 4:Ea.leaveTryBlock(3);break;case 2:Ea.enterCatchBlock();case 3:R.renameTarget(ia,
"tracker"),R.trackerId=null,R.emit("unregistered",R),Ea.jumpToEnd()}})};Pi.prototype.whenRegistered=function(R){var ia=this;return Jg.promise.waitFor(R,function(){return ia.isRegistered()}).catch(function(Ea){return Promise.reject(/timeout/i.test(String(Ea))?Error("Timeout in "+ia+".whenRegistered"):Ea)})};Pi.prototype.send=function(R,ia){var Ea=this,sb=$jscomp.makeIterator(this.prepareSend(R,ia));R=sb.next().value;ia=sb.next().value;this.whenOnline().then(function(){var Zb=Ea.socket,Vc=R,Yd=Vc.action;
Vc=Vc.target;if(!Zb)throw Error("Trying to send message "+Yd+" to "+Vc+" but cannot find a connection to it!");"function"===typeof ia?Zb.emit(Yd,R,ia):Zb.emit(Yd,R)})};Pi.prototype.joinRoom=function(R){var ia=this;return this.whenOnline().then(function(){return ia.sendToAndWait(ia.trackerId,"[broadcast] join room",{room:R})})};Pi.prototype.leaveRoom=function(R){var ia=this;return this.whenOnline().then(function(){return ia.sendToAndWait(ia.trackerId,"[broadcast] leave room",{room:R})})};Pi.prototype.broadcast=
function(R,ia,Ea,sb,Zb){var Vc=this,Yd={action:ia,room:R,broadcast:Ea};if(void 0===sb?0:sb)Yd.isSystemBroadcast=!0;if(void 0===Zb?0:Zb)Yd.isMultiServerBroadcast=!0;return this.whenOnline().then(function(){return Vc.sendToAndWait(Vc.trackerId,"[broadcast] send",Yd)})};Pi.prototype.listRoomMembers=function(R){var ia=this,Ea,sb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zb){if(1==Zb.nextAddress)return Zb.yield(ia.sendToAndWait(ia.trackerId,"[broadcast] list room members",{room:R}),2);
Ea=Zb.yieldResult;sb=Ea.data;return Zb.return(sb)})};Pi.prototype.joinedRooms=function(){var R=this,ia,Ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){if(1==sb.nextAddress)return sb.yield(R.sendToAndWait(R.trackerId,"[broadcast] my rooms",{}),2);ia=sb.yieldResult;Ea=ia.data;return sb.return(Ea)})};Pi.prototype.listRooms=function(){var R=this,ia,Ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){if(1==sb.nextAddress)return sb.yield(R.sendToAndWait(R.trackerId,"[broadcast] all rooms",
{}),2);ia=sb.yieldResult;Ea=ia.data;return sb.return(Ea)})};Pi.prototype.listPeers=function(R){R=void 0===R?!1:R;var ia=this,Ea,sb,Zb,Vc,Yd,ce;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ve){if(1==ve.nextAddress)return Ea=ia,sb=Ea._peersCached,Zb=Date.now(),!R&&sb&&1E3>Zb-sb.timestamp?ve.return(ia._peersCached.sessions):ia.isOnline()?ve.yield(ia.sendToAndWait(ia.trackerId,"getClients",{}),2):ve.return([]);Vc=ve.yieldResult;Yd=Vc.data;ce=Yd.map(function(wf){var lg=$jscomp.makeIterator(wf);
wf=lg.next().value;var vi=lg.next().value,Ii=vi.info||{};lg=Ii.userRealm;var Ok=Ii.userToken,Qo=Ii.l2lUserToken,Ro=Ii.location,Mn=Ii.type;Ii=Ii.world;wf=Object.assign({},Jg.obj.dissoc(vi,["info"]),{id:wf,world:Ii,location:Ro,type:Mn});(Ok=Ok||Qo)&&"null"!==Ok&&(lively.user?wf.user=lively.user.ClientUser.fromToken(Ok,lg):(wf.userToken=Ok,wf.userRealm=lg));return wf});ia._peersCached={timestamp:Zb,sessions:ce};return ve.return(ce)})};Pi.prototype.toString=function(){var R=this.origin,ia=this.path,Ea=
this.namespace,sb=this.id,Zb=this.isOnline()?this.isRegistered()?"registered":"unregistered":"disconnected";return"L2LClient("+(sb||"").slice(0,5)+" "+R+ia+" - "+Ea+" "+Zb+")"};$jscomp.global.Object.defineProperties(Pi.prototype,{socket:{configurable:!0,enumerable:!0,get:function(){return this._socketioClient}},socketId:{configurable:!0,enumerable:!0,get:function(){return this.socket?this.socket.id:null}}});$jscomp.global.Object.defineProperties(Pi,{clients:{configurable:!0,enumerable:!0,get:function(){return this._clients||
(this._clients=new Map)}}});Da("default",Pi);Jg.L2LClient=Pi;Jg.default=Pi}}});
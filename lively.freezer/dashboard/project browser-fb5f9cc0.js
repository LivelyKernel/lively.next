System.register(["./__root_module__-cd530690.js","kld-intersections","./user-ui-956488c9.js","./index-e341c34b.js","./index-459b301d.js"],function(Da,zb){var Rb,kc,dc,ke,hd,$d,md,Qc,xd,Od,ge,Ud,nd,Za,Cb,bc,ic,id,fe;return{setters:[function(Zb){Rb=Zb.ah;kc=Zb.aA;dc=Zb.aj;ke=Zb.am;hd=Zb.Y;$d=Zb.a5;md=Zb.as;Qc=Zb.s;xd=Zb.C;Od=Zb.a2;ge=Zb.r;Ud=Zb.ar;nd=Zb.az;Za=Zb.a_;Cb=Zb.a$;bc=Zb.ap;ic=Zb.aX;id=Zb.aW},function(){},function(Zb){fe=Zb.UserUI},function(){},function(){}],execute:function(){var Zb=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");Zb.Morph=Rb;Zb.HorizontalLayout=kc;Zb.VerticalLayout=dc;Zb.morph=ke;Zb.MorphicDB=hd;Zb.arr=$d;Zb.fun=md;Zb.string=Qc;Zb.Color=xd;Zb.pt=Od;Zb.UserUI=fe;Zb.resource=ge;var rc=function($c){var ed=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),$b=ed.hasOwnProperty("WorldDashboard")&&"function"===typeof ed.WorldDashboard?ed.WorldDashboard:ed.WorldDashboard=function(ob){ob&&ob[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ud($b,$c,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(ob){ob=void 0===ob?$world:ob;this.owner!=ob&&ob.addMorph(this);this.center=ob.visibleBounds().center()}},{key:"sortAndFilterPreviews",
value:function(ob){var zc=Zb.UserUI.getCurrentUser();ob=this.ui.searchField.fuzzyFilter(ob,function(Mc){return Mc._commit.name+Mc._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return Zb.arr.sortBy(ob,function(Mc){return-Mc._commit.timestamp});case "TEMPLATES":return ob;case "MY PROJECTS":return Zb.arr.filter(ob,function(Mc){return Mc._commit.author.name===zc.name});case "PUBLISHED":return ob}}},{key:"updateList",value:function(){var ob=this;this.previews&&Zb.fun.debounceNamed("update world list",
150,function(){ob.ui.worldList.items=ob.sortAndFilterPreviews(ob.previews)})()}},{key:"displayWorlds",value:function(){var ob=this,zc,Mc,Ja,Ra,ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mb){switch(Mb.nextAddress){case 1:return ob.reset(),zc=ob.ui,Mc=zc.loadingLabel,Mc.visible=!0,Mc.animate({opacity:1,duration:300}),Mb.yield(ob.db.latestCommits("world"),2);case 2:return Ja=Mb.yieldResult,Mb.yield(zb.import("./world preview-1ea4987a.js"),4);case 4:if(!(Ra=Mb.yieldResult)){Mb.jumpTo(5);
break}return Mb.yield(Zb.resource("part://partial freezing/world preview"),6);case 6:Ra=Mb.yieldResult;case 5:return Mb.yield(Ra.read(),3);case 3:return ub=Mb.yieldResult,ob.previews=Ja.map(function(Ob){var kb=Zb.morph({reactsToPointer:!1,fill:Zb.Color.transparent,extent:ub.extent});kb._commit=Ob;kb.displayPreview=function(){var ib;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jb){if(1==Jb.nextAddress)return ib=ub.copy(),ib._commit=Ob,ib.opacity=0,kb.addMorph(ib),ib.displayPreview(),
ib.position=Zb.pt(0,0),Jb.yield(kb.whenRendered(),2);kb.layout=new Zb.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});Jb.jumpToEnd()})};return kb}),Mb.yield(Mc.animate({opacity:0,duration:300}),7);case 7:Mc.visible=!1,ob.updateList(),0==Ja.length&&(ob.ui.noWorldWarning.center=ob.innerBounds().center(),ob.ui.noWorldWarning.animate({visible:!0,duration:300})),Mb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:"className",
get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(ob){this.ui.closeButton.visible=ob}},db:{serialize:!1,get:function(){return Zb.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),
loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],ed,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-124"}}},{start:330,end:4020})}(Zb.Morph);rc=Zb.WorldDashboard;Zb.default=rc;var Lb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");
Lb.Morph=Rb;Lb.touchInputDevice=nd;Lb.TilingLayout=Za;Lb.arr=$d;Lb.pt=Od;rc=function($c){var ed=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),$b=ed.hasOwnProperty("GrowingWorldList")&&"function"===typeof ed.GrowingWorldList?ed.GrowingWorldList:ed.GrowingWorldList=function(ob){ob&&ob[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ud($b,$c,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(ob){Ud._get(Object.getPrototypeOf($b.prototype),
"onScroll",this).call(this,ob);this.update()}},{key:"onChange",value:function(ob){Ud._get(Object.getPrototypeOf($b.prototype),"onChange",this).call(this,ob);"extent"==ob.prop&&this.update(!0)}},{key:"onHoverIn",value:function(ob){this.clipMode="auto"}},{key:"onHoverOut",value:function(ob){Lb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(ob){var zc=this.items;if(zc&&0!=zc.length){var Mc=this.scrollContainer,Ja=Mc.layout.spacing;Mc.extent=this.extent;var Ra=this.ui,ub=Ra.bufferTop;
Ra=Ra.bufferBottom;ub=ub||Mc.addMorph({fill:null,name:"buffer top",height:10});Ra=Ra||Mc.addMorph({fill:null,name:"buffer bottom",height:10});ub.width=Ra.width=this.width-100;Mc.layout.disable();var Mb=zc[0];Ja=zc.slice(0,Math.floor(this.width/(Mb.width+Ja))*(Math.ceil((this.scroll.y+this.height)/(Mb.height+Ja))+1)).filter(function(Jb){return Jb.owner!=Mc});Mb=this.scroll.y+2*this.height;for(var Ob={},kb=$jscomp.makeIterator(Ja),ib=kb.next();!ib.done;Ob={$jscomp$loop$prop$item$2289:Ob.$jscomp$loop$prop$item$2289},
ib=kb.next())Ob.$jscomp$loop$prop$item$2289=ib.value,Mb++,Ob.$jscomp$loop$prop$item$2289.top=Mb,Mc.addMorph(Ob.$jscomp$loop$prop$item$2289),Ob.$jscomp$loop$prop$item$2289._initialized||Ob.$jscomp$loop$prop$item$2289.whenRendered().then(function(Jb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(vc){Jb.$jscomp$loop$prop$item$2289._initialized=!0;return vc.yield(Jb.$jscomp$loop$prop$item$2289.displayPreview(),0)})}}(Ob));ob&&(ub.position=Lb.pt(0,0),zc.forEach(function(Jb,
vc){return Jb.position=Lb.pt(vc+1,vc+1)}),Ra.position=Lb.pt(zc.length+2,zc.length+2));Mc.layout.enable();if(ob||0<Ja.length)Ra.top=this.submorphBounds().height,Mc.layout.apply()}}}],[{key:"className",get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Lb.TilingLayout({spacing:25,align:"center",
autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(ob){this.setProperty("items",ob);var zc=this.scrollContainer;zc.layout&&zc.layout.disable();var Mc=this.ui,Ja=Mc.bufferTop;Mc=Mc.bufferBottom;Lb.arr.withoutAll(zc.submorphs,[].concat($jscomp.arrayFromIterable(ob),[Ja,Mc])).forEach(function(Ra){return Ra.remove()});this.update(!0)}}}}}],ed,{pathInPackage:function(){return"index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Lb.Morph);rc=Lb.GrowingWorldList;Lb.default=rc;var Gc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");Gc.InputLine=Cb;Gc.Color=xd;Gc.connect=bc;Gc.disconnectAll=ic;Gc.disconnect=id;Gc.arr=$d;Gc.string=Qc;rc=function($c){var ed=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),
$b=ed.hasOwnProperty("SearchInputLine")&&"function"===typeof ed.SearchInputLine?ed.SearchInputLine:ed.SearchInputLine=function(ob){ob&&ob[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ud($b,$c,[{key:"fuzzyMatch",value:function(ob,zc){zc=void 0===zc?this.parseInput():zc;if(zc.lowercasedTokens.every(function(Ja){return ob.toLowerCase().includes(Ja)}))return!0;var Mc=ob.toLowerCase();return 3>=Gc.arr.sum(zc.lowercasedTokens.map(function(Ja){return Gc.string.levenshtein(Mc,
Ja)}))}},{key:"fuzzyFilter",value:function(ob,zc){var Mc=this;zc=void 0===zc?function(Ra){return Ra}:zc;var Ja=this.parseInput();return Gc.arr.filter(ob,function(Ra){return Mc.fuzzyMatch(zc(Ra),Ja)})}},{key:"parseInput",value:function(){var ob=Array.from(this.textString).reduce(function(Mc,Ja){if("\\"===Ja&&!Mc.escaped)return Mc.escaped=!0,Mc;" "!==Ja||Mc.escaped?(Mc.spaceSeen=!1,Mc.current+=Ja):(!Mc.spaceSeen&&Mc.current&&(Mc.tokens.push(Mc.current),Mc.current=""),Mc.spaceSeen=!0);Mc.escaped=!1;
return Mc},{tokens:[],current:"",escaped:!1,spaceSeen:!1});ob.current&&ob.tokens.push(ob.current);var zc=ob.tokens.map(function(Mc){return Mc.toLowerCase()});return{tokens:ob.tokens,lowercasedTokens:zc}}}],[{key:"className",get:function(){return"SearchInputLine"}}],ed,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",
version:"0.1.1-4"}}},{start:239,end:1834})}(Gc.InputLine);rc=Gc.SearchInputLine;Gc.default=rc}}});
System.register(["./__root_module__-fd8ea0c8.js","./index-f52d5423.js","./index-385d8bf3.js"],function(Ca){var Bb,Kb,lc,bc,Td,Xc,Wd,$c,Pc,md,ge,Qe,kf,ke,cc,Hc,Nd,ec,$d,le,Dc,Ic,Vb,Lc,dd,Hd,Ld,wc,rb,Gb,Oa,ab,Qa,Ja,eb,Rb,zc,sb,Ab,vb,ha,Ha,W,ra,Za;return{setters:[function(qb){Bb=qb.C;Kb=qb.aw;lc=qb.a6;bc=qb.a1;Td=qb.a3;Xc=qb.ab;Wd=qb.bk;$c=qb.a_;Pc=qb.au;md=qb.a7;ge=qb.aR;Qe=qb.bo;kf=qb.bp;ke=qb.a8;cc=qb.aj;Hc=qb.at;Nd=qb.av;ec=qb.bq;$d=qb.br;le=qb.a2;Dc=qb.P;Ic=qb.$;Vb=qb.aZ;Lc=qb.an;dd=qb.ao;Hd=
qb.ap;Ld=qb.aq;wc=qb.aD;rb=qb.b1;Gb=qb.az;Oa=qb.as;ab=qb.ad;Qa=qb.bs;Ja=qb.L;eb=qb.bt;Rb=qb.b6;zc=qb.bl;sb=qb.b5;Ab=qb.bu;vb=qb.ax},function(qb){ha=qb.M;Ha=qb.I;W=qb.v;ra=qb.p},function(qb){Za=qb.localInterface}],execute:function(){function qb(Na,fb){if(!0===fb)return fb;if(Na.copyState)return Na.copyState(fb);Na={};for(var Jb in fb){var da=fb[Jb];da instanceof Array&&(da=da.concat([]));Na[Jb]=da}return Na}function sc(Na,fb,Jb){return Na.startState?Na.startState(fb,Jb):!0}function wd(Na,fb){return Sb.modes[Na]=
fb}function nc(Na){if("string"==typeof Na&&Sb.mimeModes.hasOwnProperty(Na))Na=Sb.mimeModes[Na];else if(Na&&"string"==typeof Na.name&&Sb.mimeModes.hasOwnProperty(Na.name)){var fb=Sb.mimeModes[Na.name];"string"==typeof fb&&(fb={name:fb});Na=Object.assign({},fb,Na);Na.name=fb.name}else{if("string"==typeof Na&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Na))return nc("application/xml");if("string"==typeof Na&&/^[\w\-]+\/[\w\-]+\+json$/.test(Na))return nc("application/json")}return"string"==typeof Na?{name:Na}:Na||
{name:"null"}}function Ob(Na,fb){fb=Sb.resolveMode(fb);"string"===typeof fb&&(fb={name:fb});if(!fb.name)throw Error("parserConfig does not have a name of the mode to get");var Jb=Sb.modes[fb.name];if(!Jb)return Ob(Na,"text/plain");Na=Object.assign({indentUnit:2},Na);return Object.assign(Jb(Na,fb),{name:fb.name})}function Zd(Na,fb){for(var Jb;Na.innerMode;){Jb=Na.innerMode(fb);if(!Jb||Jb.mode==Na)break;fb=Jb.state;Na=Jb.mode}return Jb||{mode:Na,state:fb}}function Id(Na,fb){Sb.mimeModes[Na]=fb}function kb(Na,
fb,Jb){}function Eb(Na,fb,Jb,da,Ia,nb,yb){var Bc=Na.editorPlugin._tokenizerValidBefore;Bc&&Bc.row>=Jb&&(Bc.row=Jb-1);var xc=Sb.linesToTokenize(Na.document,Jb,da,Bc);Bc=xc.lines;xc=xc.state;if(!Bc.length)return!1;xc=xc?Sb.copyState(fb,xc):Sb.startState(fb);for(var jd=0;jd<Bc.length;jd++){var ud=Bc[jd],nd=ud.row;nd>=Jb&&nd<=da&&Sb.indentLine(Na,fb,ud,xc,Ia,nb,yb);xc=Sb.tokenizeLine(fb,Bc[jd],xc,function(){})}return!0}function ad(Na,fb,Jb,da,Ia,nb,yb){fb=Sb.linesToTokenize(fb,Jb,da,Ia);Jb=fb.lines;Sb.tokenizeLines(Na,
Jb,fb.state,nb,yb);return Jb}function ub(Na,fb,Jb,da,Ia){var nb=[],yb,Bc=function(ud){return nb.push(yb=[])},xc=function(ud,nd,pf,kg,Wf,Fh,Df){return yb.push(pf,kg,ud,Wf.current(),nd.localMode||Df)};try{var jd=Sb.visitDocumentTokens(Na,fb,Jb,da,Ia,Bc,xc)}catch(ud){nb.length=0,jd=Sb.visitDocumentTokens(Na,fb,Jb,da,null,Bc,xc)}return{tokens:nb,lines:jd}}function cd(Na,fb,Jb,da,Ia){null==fb&&(fb=Na.search(/[^\s\u00a0]/),-1==fb&&(fb=Na.length));da=da||0;for(Ia=Ia||0;;){var nb=Na.indexOf("\t",da);if(0>
nb||nb>=fb)return Ia+(fb-da);Ia+=nb-da;Ia+=Jb-Ia%Jb;da=nb+1}}function Vc(Na){Na=Na.toLowerCase();for(var fb=0;fb<Sb.modeInfo.length;fb++){var Jb=Sb.modeInfo[fb];if(Jb.mime==Na)return Jb;if(Jb.mimes)for(var da=0;da<Jb.mimes.length;da++)if(Jb.mimes[da]==Na)return Jb}if(/\+xml$/.test(Na))return Vc("application/xml");if(/\+json$/.test(Na))return Vc("application/json")}function ib(Na){for(var fb=0;fb<Sb.modeInfo.length;fb++){var Jb=Sb.modeInfo[fb];if(Jb.ext)for(var da=0;da<Jb.ext.length;da++)if(Jb.ext[da]==
Na)return Jb}}function Ra(Na){for(var fb=0;fb<Sb.modeInfo.length;fb++){var Jb=Sb.modeInfo[fb];if(Jb.file&&Jb.file.test(Na))return Jb}fb=Na.lastIndexOf(".");if(Na=-1<fb&&Na.substring(fb+1,Na.length))return Sb.findModeByExtension(Na)}function pb(Na){Na=Na.toLowerCase();for(var fb=0;fb<Sb.modeInfo.length;fb++){var Jb=Sb.modeInfo[fb];if(Jb.name.toLowerCase()==Na)return Jb;if(Jb.alias)for(var da=0;da<Jb.alias.length;da++)if(Jb.alias[da].toLowerCase()==Na)return Jb}}function bb(Na){if(!Na)return String(Na);
if(Array.isArray(Na))return"["+Na.map(bb).join(",")+"]";if("symbol"===typeof Na)return vd.printSymbol(Na);try{return String(Na)}catch(fb){return"Cannot print object: "+fb}}function Oc(Na,fb){return!vd.arr.every(fb.map(function(Jb){return Na[Jb]}),function(Jb){return vd.obj.equals(Jb,Na&&Na.valueOf())})}function ma(Na){if(vd.obj.isPrimitive(Na))var fb=vd.string.print(Na);else Array.isArray(Na)?((fb=3<Na.length)&&(Na=Na.slice(0,3)),Na=vd.string.print(Na),fb&&(Na=Na.slice(0,-1)+", ...]"),fb=Na):fb=vd.string.print(Na);
fb=fb.replace(/\n/g,"");500<fb.length&&(fb=fb.slice(0,20)+("...["+(fb.length-20)+' CHARS]"'));return fb}function Aa(Na){return pc.Inspector.openInWindow({targetObject:Na})}function xb(Na,fb){return pc.Inspector.openInWindow({remoteTarget:{code:Na,evalEnvironment:fb}})}function P(Na,fb){function Jb(Bc){var xc=Bc.name,jd=Bc.ownerChain(),ud=Bc.owner,nd=Bc.world(),pf;Bc===nb&&(pf=[yb]);nd===Bc&&(pf=["$world"]);if(!pf&&xc&&ud){ud===nd&&1===pc.arr.count(pc.arr.pluck(nd.submorphs,"name"),xc)&&(pf=['$world.get("'+
xc+'")']);if(!pf&&ud!=nd)for(nd=jd.length-1;nd--;)if(1===jd[nd].getAllNamed(xc).length){pf=[].concat($jscomp.arrayFromIterable(Jb(jd[nd])),['get("'+xc+'")']);break}pf||(xc=[].concat($jscomp.arrayFromIterable(Jb(ud)),['get("'+xc+'")']),pc.syncEval(xc.join("."),{context:nb}).value===Bc&&(pf=xc))}pf||(pf=[yb+'.getMorphById("'+Bc.id+'")']);return pf}fb=void 0===fb?{}:fb;var da=Na.world(),Ia=fb;fb=void 0===Ia.maxLength?10:Ia.maxLength;var nb=void 0===Ia.fromMorph?da:Ia.fromMorph;if(nb===Na)return"this";
var yb=da===nb?"$world":"this";if(!(da||Na.name&&nb.get(Na.name)===Na))return"morph";da=Jb(Na);return da.length>fb?'$world.getMorphWithId("'+Na.id+'")':da.join(".")}function wa(Na,fb,Jb){var da=(fb=void 0===fb?"":fb)&&Jf.arr.last(fb.split(".")).toLowerCase(),Ia="",nb=0,yb=Math.pow(2,19);if("string"===typeof Na){if(Na.length>yb)return null}else if(Na.document.stringSize>yb)return null;if("string"===typeof Na)Ia=Na.slice(0,1E3);else for(Na=$jscomp.makeIterator(Na.document.lines),yb=Na.next();!yb.done;yb=
Na.next()){var Bc=yb.value;yb=Bc.stringSize;Bc=Bc.text;var xc=!0;1E3<nb+yb&&(xc=!1,yb=1E3-nb);Ia+=Bc.slice(0,yb)+(xc?"\n":"");nb+=yb;if(1E3<=nb)break}nb=$jscomp.makeIterator(Jf.modeInfo);for(Na=nb.next();!Na.done;Na=nb.next()){xc=Na.value;yb=xc.contentTest;Na=xc.mode;Bc=xc.ext;xc=xc.file;if("function"===typeof yb)try{if(yb(Ia))return Na}catch(jd){}if(xc&&xc instanceof RegExp&&xc.test(fb))return Na;if(Bc)for(yb=$jscomp.makeIterator(Bc),Bc=yb.next();!Bc.done;Bc=yb.next())if(Bc.value===da)return Na}return Jb}
Ca({a:Id,d:wd,r:kb});var Xa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");Xa.Color=Bb;var Db=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Jb=fb.hasOwnProperty("DefaultTheme")&&"function"===typeof fb.DefaultTheme?fb.DefaultTheme:fb.DefaultTheme=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:"background",get:function(){return Xa.Color.white}},
{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Xa.Color.white,fontWeight:"bold",backgroundColor:Xa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Xa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Xa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],fb,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),mc=Db=Xa.DefaultTheme;Xa.default=Db;var Sb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");Sb.copyState=qb;Sb.startState=sc;Sb.defineMode=wd;Sb.resolveMode=nc;Sb.getMode=Ob;Sb.innerMode=Zd;Sb.defineMIME=Id;Sb.registerHelper=kb;Sb.indentLines=Eb;Sb.indentLine=function(Na,fb,Jb,da,Ia,nb,yb){yb=Object.assign({indentWithTabs:!Na.useSoftTabs,indentUnit:Na.tabWidth,tabSize:4,ignoreFollowingText:!1},
yb);null==Ia&&(Ia="add");"smart"==Ia&&(fb.indent||(Ia="prev"));var Bc=yb.tabSize,xc=Jb.text,jd=Sb.countColumn(xc,null,Bc);Jb.modeState&&(Jb.modeState=null);var ud=xc.match(/^\s*/)[0];if(!nb&&!/\S/.test(xc)){var nd=0;Ia="not"}else if("smart"==Ia&&(nd=fb.indent(da,yb.ignoreFollowingText?"":xc.slice(ud.length),xc),nd==Sb.passIndent||150<nd)){if(!nb)return;Ia="prev"}"prev"==Ia?nd=0<Jb.row?Sb.countColumn(Jb.prevLine().text,null,Bc):0:"add"==Ia?nd=jd+yb.indentUnit:"subtract"==Ia?nd=jd-yb.indentUnit:"number"==
typeof Ia&&(nd=jd+Ia);nd=Math.max(0,nd);fb="";da=0;if(yb.indentWithTabs)for(yb=Math.floor(nd/Bc);yb;--yb)da+=Bc,fb+="\t";da<nd&&(fb+=" ".repeat(nd-da));if(fb!=ud)return Na.replace({start:{row:Jb.row,column:0},end:{row:Jb.row,column:ud.length}},fb),!0};Sb.tokenizeLines=function(Na,fb,Jb,da,Ia){if(fb.length){Jb=Jb?Sb.copyState(Na,Jb):Sb.startState(Na);for(var nb=0;nb<fb.length;nb++){var yb=fb[nb];da(yb);Jb=Sb.tokenizeLine(Na,yb,Jb,Ia)}}};Sb.tokenizeLine=function(Na,fb,Jb,da){var Ia=fb.text;if(!Ia)return Jb;
var nb=new Sb.StringStream(Ia,2);Jb=fb.modeState="function"===typeof Na.copyState?Na.copyState(Jb):Sb.copyState(Na,Jb);fb.prevLine();for(Jb._string=Ia;!nb.eol();)Ia=Na.token(nb,Jb),da(Ia,Jb,nb.start,nb.pos,nb,fb,Na),nb.start=nb.pos;return Jb};Sb.printTokens=function(Na){for(var fb="",Jb=0;Jb<Na.length;Jb+=5)fb+=Na[Jb+0]+" => "+Na[Jb+1]+" "+Na[Jb+2]+" "+Na[Jb+3]+" "+Na[Jb+4].name+"\n";return fb};Sb.visitDocumentTokens=ad;Sb.tokenizeDocument=ub;Sb.linesToTokenize=function(Na,fb,Jb,da){if(da&&da.row>=
Jb)return{lines:[],state:null};fb=da?Math.max(0,da.row-1):fb;var Ia=Na.getLine(fb),nb=Ia.text;Na=[Ia];da=null;for(var yb=0,Bc;(Bc=Ia.prevLine())&&50>yb++;){Ia=Bc;if(Ia.modeState){da=Ia.modeState;break}Na.unshift(Ia)}if(!da){for(var xc=Ia,jd=Infinity;(Bc=Ia.prevLine())&&100>yb++;){Ia=Bc;if(Ia.modeState){da=Ia.modeState;break}Na.unshift(Ia);Bc=nb.match(/^\s*/)[0].length;if(0===Bc)break;Bc<jd&&(jd=Bc,xc=Ia)}!da&&0<jd&&(Na=Na.slice(Na.indexOf(xc)))}if(Jb>fb)for(Ia=Sb.arr.last(Na);fb<=Jb;fb++){Ia=Ia.nextLine();
if(!Ia)break;Na.push(Ia)}return{lines:Na,state:da}};Sb.countColumn=cd;Sb.findModeByMIME=Vc;Sb.findModeByExtension=ib;Sb.findModeByFileName=Ra;Sb.findModeByName=pb;Sb.arr=lc;Db=Sb.modes||{};Sb.modes=Db;Sb.modes=Db;Sb.modes=Db;Db=Ca("p",{});Sb.passIndent=Db;Sb.passIndent=Db;Sb.passIndent=Db;Sb.copyState=qb;Sb.copyState=qb;Sb.startState=sc;Sb.startState=sc;Sb.defineMode=wd;Sb.defineMode=wd;Sb.resolveMode=nc;Sb.resolveMode=nc;Sb.getMode=Ob;Sb.getMode=Ob;Sb.innerMode=Zd;Sb.innerMode=Zd;Db={};Sb.mimeModes=
Db;Sb.mimeModes=Db;Sb.mimeModes=Db;Sb.defineMIME=Id;Sb.defineMIME=Id;Sb.registerHelper=kb;Sb.registerHelper=kb;Sb.indentLines=Eb;Sb.indentLines=Eb;Sb.visitDocumentTokens=ad;Sb.visitDocumentTokens=ad;Sb.tokenizeDocument=ub;Sb.tokenizeDocument=ub;Sb.countColumn=cd;Sb.countColumn=cd;(function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Jb=fb.hasOwnProperty("StringStream")&&"function"===typeof fb.StringStream?fb.StringStream:fb.StringStream=function(da){da&&da[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:Symbol.for("lively-instance-initialize"),value:function(da,Ia){this.reset(da,Ia)}},{key:"reset",value:function(da,Ia){this.pos=this.start=0;this.string=void 0===da?"":da;this.tabSize=void 0===Ia?2:Ia;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||
void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(da){var Ia=this.string.charAt(this.pos);if("string"==typeof da?Ia==da:Ia&&(da.test?da.test(Ia):da(Ia)))return++this.pos,Ia}},{key:"eatWhile",value:function(da){for(var Ia=this.pos;this.eat(da););return this.pos>Ia}},{key:"eatSpace",value:function(){for(var da=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>da}},{key:"skipToEnd",
value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(da){da=this.string.indexOf(da,this.pos);if(-1<da)return this.pos=da,!0}},{key:"backUp",value:function(da){this.pos-=da}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=Sb.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?Sb.countColumn(this.string,this.lineStart,this.tabSize):
0)}},{key:"indentation",value:function(){return Sb.countColumn(this.string,null,this.tabSize)-(this.lineStart?Sb.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(da,Ia,nb){if("string"==typeof da){var yb=function(xc){return nb?xc.toLowerCase():xc},Bc=this.string.substr(this.pos,da.length);if(yb(Bc)==yb(da))return!1!==Ia&&(this.pos+=da.length),!0}else{if((da=this.string.slice(this.pos).match(da))&&0<da.index)return null;da&&!1!==Ia&&(this.pos+=da[0].length);return da}}},
{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(da,Ia){this.lineStart+=da;try{return Ia()}finally{this.lineStart-=da}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],fb,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:10431,end:12920})})(void 0);Db=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",
ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",
mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",
mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Na){return Na.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",
file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",
ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",
mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",
mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",
ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},
{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},
{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},
{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",
mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},
{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",
ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",
mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Na){return Na.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",
mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",
mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",
mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn",
"ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",
mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",
ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];Sb.modeInfo=Db;Sb.modeInfo=Db;Sb.modeInfo=Db;for(var Tc=0;Tc<Sb.modeInfo.length;Tc++)Sb.info=
Sb.modeInfo[Tc],Sb.info.mimes&&(Sb.info.mime=Sb.info.mimes[0]);Sb.defineMode("null",function(){return{token:function(Na){return Na.skipToEnd()}}});Sb.defineMIME("text/plain","null");Sb.findModeByMIME=Vc;Sb.findModeByMIME=Vc;Sb.findModeByExtension=ib;Sb.findModeByExtension=ib;Sb.findModeByFileName=Ra;Sb.findModeByFileName=Ra;Sb.findModeByName=pb;Sb.findModeByName=pb;var gd=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");gd.Color=Bb;gd.Rectangle=bc;gd.pt=Td;gd.morph=Xc;gd.ShadowObject=
Wd;gd.StyleSheet=$c;gd.connect=Pc;gd.arr=lc;gd.string=md;gd.FilterableList=ge;gd.Range=Qe;Tc=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Jb=fb.hasOwnProperty("Completer")&&"function"===typeof fb.Completer?fb.Completer:fb.Completer=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"Completer"}}],fb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);gd.Completer=Tc;gd.Completer=Tc;gd.Completer=Tc;Tc=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Jb=fb.hasOwnProperty("WordCompleter")&&
"function"===typeof fb.WordCompleter?fb.WordCompleter:fb.WordCompleter=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:"compute",value:function(da,Ia){var nb=[],yb=[],Bc=da.document.lineStrings;da=da.cursorPosition.row;for(var xc=da-1;0<=xc;xc--)for(var jd=$jscomp.makeIterator(Bc[xc].split(/[^0-9a-z@_]+/i)),ud=jd.next();!ud.done;ud=jd.next())(ud=ud.value)&&!nb.includes(ud)&&ud!==Ia&&(nb.push(ud),
yb.push({priority:1E3-(da-xc),completion:ud}));for(xc=da+1;xc<Bc.length;xc++)for(jd=$jscomp.makeIterator(Bc[xc].split(/[^0-9a-z_@]+/i)),ud=jd.next();!ud.done;ud=jd.next())(ud=ud.value)&&!nb.includes(ud)&&ud!==Ia&&(nb.push(ud),yb.push({priority:1E3-(xc-da),completion:ud}));return yb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],fb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);gd.WordCompleter=Tc;gd.WordCompleter=Tc;gd.WordCompleter=Tc;Tc=[new gd.WordCompleter];gd.defaultCompleters=Tc;gd.defaultCompleters=Tc;gd.defaultCompleters=Tc;Tc=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Jb=fb.hasOwnProperty("CompletionController")&&"function"===typeof fb.CompletionController?fb.CompletionController:fb.CompletionController=function(da){da&&da[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:Symbol.for("lively-instance-initialize"),value:function(da,Ia){Ia=void 0===Ia?[]:Ia;this.textMorph=da;this.completers=Ia=da.pluginCollect("getCompleters",Ia)}},{key:"computeCompletions",value:function(da){var Ia=this,nb,yb,Bc,xc,jd,ud,nd,pf,kg,Wf,Fh,Df,wh,ck,bi,Al;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yg){switch(yg.nextAddress){case 1:nb=[],yb=$jscomp.makeIterator(Ia.completers),Bc=yb.next();
case 2:if(Bc.done){yg.jumpTo(4);break}xc=Bc.value;yg.setCatchFinallyBlocks(5);jd=nb;ud=jd.concat;return yg.yield(xc.compute(Ia.textMorph,da),7);case 7:nb=ud.call(jd,yg.yieldResult);yg.leaveTryBlock(3);break;case 5:nd=yg.enterCatchBlock(),console.warn("Error in completer "+xc+": "+(nd.stack||nd));case 3:Bc=yb.next();yg.jumpTo(2);break;case 4:pf=new Map;nb.forEach(function(Vj){var Ri=pf.get(Vj.completion);Ri||(Ri=[],pf.set(Vj.completion,Ri));Ri.push(Vj)});kg=[];Wf=$jscomp.makeIterator(pf.values());
for(Fh=Wf.next();!Fh.done;Fh=Wf.next())Df=Fh.value,kg.push(gd.arr.last(gd.arr.sortByKey(Df,"priority")));wh=0;ck=gd.arr.sortByKey(kg,"priority").reverse();bi=ck.length&&ck[0].priority||0;Al=ck.map(function(Vj){Vj.highestPriority=bi;var Ri=Vj.completion.replace(/\n/g,""),Jk=String((Vj.info||"").replace(/\n/g,""));wh=Math.max(wh,Ri.length+Jk.length);return{isListItem:!0,string:Ri,annotation:Jk,value:Vj}});return yg.return({items:Al,maxCol:wh})}})}},{key:"computeSortedCompletions",value:function(da,
Ia){Ia=void 0===Ia?!1:Ia;var nb=this,yb,Bc,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(jd){if(1==jd.nextAddress)return yb={tokens:[da],lowercasedTokens:[da],input:da},jd.yield(nb.computeCompletions(da),2);Bc=jd.yieldResult;xc=gd.arr.sortBy(Bc.items.filter(function(ud){return nb.filterFunction(yb,ud,Ia)}),function(ud){return nb.sortFunction(yb,ud)});return jd.return(xc)})}},{key:"_printCompletions",value:function(da){var Ia=this,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==
yb.nextAddress)return yb.yield(Ia.computeSortedCompletions(da),2);nb=yb.yieldResult.map(function(Bc){return{completion:Bc.value.completion,priority:Bc.value.priority,maxP:Bc.value.highestPriority,sortVal:Bc._cache[da].sortVal,lev:JSON.stringify(Bc._cache[da].levenshtein)}});return yb.return(gd.string.printTable(lively.lang.grid.tableFromObjects(nb)))})}},{key:"prefix",value:function(){var da=this.textMorph,Ia=da.selection;return(Ia.isEmpty()?da.getLine(Ia.lead.row).slice(0,Ia.lead.column):Ia.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(da,Ia,nb){nb=void 0===nb?!1:nb;Ia._cache||(Ia._cache={});var yb=da.tokens,Bc=da.lowercasedTokens,xc=da.input;xc=Ia._cache[xc]||(Ia._cache[xc]={});if(xc.hasOwnProperty("filtered"))return xc.filtered;Ia=Ia.value.completion.replace(/\([^\)]*\)$/,"");var jd=Ia.toLowerCase();if(nb&&yb[0]&&!Ia.startsWith(yb[0]))return xc.filtered=!1;if(Bc.every(function(nd){return jd.includes(nd)}))return!0;var ud=xc.levenshtein||(xc.levenshtein={});da=nb||3>=gd.arr.sum(da.lowercasedTokens.map(function(nd){return ud[nd]||
(ud[nd]=gd.string.levenshtein(jd,nd))}));return xc.filtered=da}},{key:"sortFunction",value:function(da,Ia){Ia._cache||(Ia._cache={});var nb=Ia._cache[da.input]||(Ia._cache[da.input]={});if(nb.hasOwnProperty("sortVal"))return nb.sortVal;nb=Ia._cache[da.input]={};var yb=Ia.value;Ia=yb.highestPriority;var Bc=yb.completion;yb=yb.priority;Bc=Bc.replace(/\([^\)]*\)$/,"").toLowerCase();var xc=0;da.lowercasedTokens.forEach(function(ud){Bc.startsWith(ud)?xc+=12:3<=ud.length&&Bc.includes(ud)&&(xc+=5)});Ia=
-((yb||(xc?Ia:0))/Math.pow(10,String(Ia).length-2))-xc;var jd=nb.levenshtein||(nb.levenshtein={});da=gd.arr.sum(da.lowercasedTokens.map(function(ud){return jd[ud]||(jd[ud]=gd.string.levenshtein(Bc,ud))}));xc&&(da/=2);return nb.sortVal=da+Ia}},{key:"positionForMenu",value:function(){var da=this.textMorph,Ia=da.charBoundsFromTextPosition(da.cursorPosition);return da.getGlobalTransform().transformRectToRect(Ia).topLeft().addXY(-da.scroll.x,-da.scroll.y).addPt(gd.pt(da.borderWidth+4,da.borderWidth+4))}},
{key:"completionListSpec",value:function(){var da=this,Ia,nb,yb,Bc,xc,jd,ud,nd,pf,kg,Wf,Fh,Df,wh,ck,bi,Al,yg,Vj,Ri;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jk){if(1==Jk.nextAddress)return nb=Ia=da.textMorph,yb=nb.fontSize,Bc=nb.fontFamily,xc=da.positionForMenu(),jd=da.prefix(),Jk.yield(da.computeCompletions(jd),2);ud=Jk.yieldResult;nd=ud.items;pf=ud.maxCol;kg=Ia.env.fontMetric.sizeFor(Bc,yb,"M");Wf=kg.width*pf;Fh=Ia.document.getLine(0).height;Df=Math.max(120,Wf<Ia.width?Wf:Ia.width);
wh=Fh*nd.length+Fh+10;ck=Math.max(70,Math.min(700,wh));bi=xc.extent(gd.pt(Df,ck));if(Al=Ia.world())yg=Al.visibleBounds().insetBy(5),bi.bottom()>yg.bottom()&&(Vj=bi.bottom()-yg.bottom(),Vj>bi.height-50&&(Vj=bi.height-50),bi.height-=Vj),bi.right()>yg.right()&&(Ri=bi.right()-yg.right(),bi.width=120>bi.width-Ri?120:bi.width-Ri),yg.containsRect(bi)||(bi=bi.withTopLeft(yg.translateForInclusion(bi).topLeft())),bi=bi.translatedBy(yg.insetBy(0).topLeft().negated());return Jk.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:yb,position:bi.topLeft(),extent:bi.extent(),items:nd,input:jd,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:da.filterFunction,sortFunction:da.sortFunction})})}},{key:"removeMenuOnBlur",value:function(da){var Ia=da.menu;setTimeout(function(){Ia.withAllSubmorphsDetect(function(nb){return nb.isFocused()})?Ia.inputMorph.focus():Ia.remove()})}},{key:"openCompletionList",value:function(){var da=this,Ia,nb,yb,Bc,xc,jd,ud,nd,
pf,kg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wf){if(1==Wf.nextAddress)return Ia=da.textMorph.selection.start,Wf.yield(da.completionListSpec(),2);if(3!=Wf.nextAddress)return nb=Wf.yieldResult,da.textMorph.pluginFind(function(Fh){return Fh.theme}),yb=new gd.FilterableList(nb),Bc=new gd.Range({start:Ia,end:da.textMorph.selection.start}),xc=da.textMorph.textInRange(Bc),jd=yb.inputMorph,ud=yb.listMorph,nd=nb.input,pf=yb.addMorph({name:"prefix mask",fill:gd.Color.transparent,bounds:jd.textBounds()},
jd),ud.master=null,Bc.isEmpty()||(da.textMorph.deleteText(Bc),jd.input=xc,jd.gotoDocumentEnd()),jd.fontColor=da.textMorph.fontColor,gd.connect(jd,"textString",pf,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:jd}}),gd.connect(yb,"accepted",da,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:nd}}),gd.connect(yb,"accepted",yb,"remove"),gd.connect(yb,"canceled",yb,"remove"),gd.connect(yb,"remove",da.textMorph,"focus"),gd.connect(yb.inputMorph,"onBlur",da,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:yb}}),kg=da.textMorph.world(),ud.addStyleClass("hiddenScrollbar"),yb.paddingMorph.height=2,jd.height=ud.itemHeight,jd.clipMode="visible",jd.fill=da.textMorph.fill,jd.fixedHeight=!0,jd.fixedWidth=!1,jd.fontSize=ud.fontSize,yb.relayout(),yb.selectedIndex=
0,yb.master.applyIfNeeded(!0),jd.focus(),Wf.yield(yb.master.whenApplied(),3);nd.length&&(jd.gotoDocumentEnd(),yb.moveBy(gd.pt(-jd.textBounds().width,0)));kg.addMorph(yb);yb.inputPadding=gd.Rectangle.inset(0,0,0,0);return Wf.return(yb)})}},{key:"autoInsertBestMatchingCompletion",value:function(da,Ia,nb){Ia=void 0===Ia?!0:Ia;var yb=this,Bc,xc,jd,ud;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nd){if(1==nd.nextAddress)return Bc=$jscomp,xc=Bc.makeIterator,nd.yield(yb.computeSortedCompletions(da,
Ia),2);jd=xc.call(Bc,nd.yieldResult);(ud=jd.next().value)&&yb.insertCompletion(ud.value.completion,da,nb);nd.jumpToEnd()})}},{key:"insertCompletion",value:function(da,Ia,nb){var yb=this.textMorph,Bc=yb.document,xc=yb.selection.isMultiSelection?yb.selection.selections:[yb.selection];yb.undoManager.group();xc.forEach(function(jd){jd.collapseToEnd();var ud=jd.lead,nd=Ia?Bc.indexToPosition(Bc.positionToIndex(ud)-Ia.length):ud;"function"===typeof nb?nb(da,Ia,yb,{start:nd,end:ud},jd):yb.replace({start:nd,
end:ud},da)});yb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],fb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);gd.CompletionController=Tc;gd.CompletionController=Tc;gd.CompletionController=Tc;
Tc=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Na,fb,Jb){var da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){return 1==Ia.nextAddress?(da=new gd.CompletionController(Na,gd.defaultCompleters),Ia.yield(da.openCompletionList(),2)):Ia.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Na,fb,Jb){var da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){return 1==Ia.nextAddress?
(da=new gd.CompletionController(Na,gd.defaultCompleters),Ia.yield(da.autoInsertBestMatchingCompletion(da.prefix()),2)):Ia.return(!0)})}}];gd.completionCommands=Tc;gd.completionCommands=Tc;gd.completionCommands=Tc;var se=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");se.chain=kf;se.arr=lc;se.obj=ke;se.string=md;var Cf=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Na){var fb=Na.selection.start;0<fb.row&&(fb=Na.getPositionAboveOrBelow(1,
fb,!0,0,Na.charBoundsFromTextPosition(fb).x),Na.selection.addRange({start:fb,end:fb}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Na){var fb=Na.selection.start;fb.row<Na.documentEndPosition.row&&(fb=Na.getPositionAboveOrBelow(-1,fb,!0,0,Na.charBoundsFromTextPosition(fb).x),Na.selection.addRange({start:fb,end:fb}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Na){var fb=Na.selection.selections[Na.selection.selections.length-
1];if(fb.isEmpty())return!0;Na.searchForAll(fb.text,{start:{column:0,row:0}}).forEach(function(Jb){return Na.selection.addRange(Jb.range,!1)});Na.selection.mergeSelections();se.arr.remove(Na.selection.selections,fb);Na.selection.selections.push(fb);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Na){var fb=Na.selection.selections.length-1,Jb=Na.selection.selections[fb];if(Jb.isEmpty())return!0;var da=Na.search(Jb.text,{start:Jb.end,backwards:!1});
da&&(Jb=Na.selection.selections.findIndex(function(Ia){return Ia.range.equals(da.range)}),-1<Jb?se.arr.swap(Na.selection.selections,Jb,fb):Na.selection.addRange(da.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Na){var fb=Na.selection.selections.length-1,Jb=Na.selection.selections[fb];if(Jb.isEmpty())return!0;var da=Jb.start,Ia=Na.search(Jb.text,{start:{row:da.row,column:da.column-(Jb.text.length-1)},backwards:!0});Ia&&(Jb=Na.selection.selections.findIndex(function(nb){return nb.range.equals(Ia.range)}),
-1<Jb?se.arr.swap(Na.selection.selections,Jb,fb):Na.selection.addRange(Ia.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Na){var fb=Na.selection.selections.length;1<fb&&Na.selection.removeSelections(fb-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Na){Na.selection.selections=lively.lang.arr.rotate(Na.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(Na){Na.selection.selections=lively.lang.arr.rotate(Na.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Na){var fb=Na.selection.selections;if(1>=fb.length)return!0;var Jb=se.arr.groupBy(fb,function(Ia){return Ia.range.start.row});fb=Jb.keys().map(function(Ia){Ia=Jb[Ia];var nb=se.arr.max(Ia,function(yb){return yb.range.start.column});se.arr.without(Ia,nb).forEach(function(yb){return yb.range=nb.range});
return nb});var da=se.arr.max(fb,function(Ia){return Ia.range.start.column}).range.start.column;fb.forEach(function(Ia){var nb=Ia.range.start;Ia=nb.row;nb=nb.column;Na.insertText(" ".repeat(da-nb),{row:Ia,column:nb})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Na){Na.selection.disableMultiSelect();if(Na.selection.isEmpty())var fb=Na.lastSavedMark&&Na.lastSavedMark.position||(void 0).lineRange().start,Jb=Na.cursorPosition;else fb=Na.selection,
Jb=fb.lead,fb=fb.anchor;Na.selection.collapse();var da=fb.column,Ia=Jb.column;se.arr.range(fb.row,Jb.row).forEach(function(nb){return Na.getLine(nb).length>Math.min(Ia,da)&&Na.selection.addRange({end:{row:nb,column:Ia},start:{row:nb,column:da}},!1)});Na.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Na,fb,Jb){Jb=void 0===Jb?1:Jb;Na.undoManager.group();Na.selection.selections.forEach(function(da,Ia){return da.text=String(Ia+
Jb)});Na.undoManager.group();return!0}}];se.multiSelectCommands=Cf;se.multiSelectCommands=Cf;se.multiSelectCommands=Cf;var me=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");me.pToI=function(Na,fb){return Na.positionToIndex(fb)};me.iToP=function(Na,fb){return Na.indexToPosition(fb)};me.execCodeNavigator=function(Na){return function(fb,Jb,da){var Ia=fb.pluginInvokeFirst("getNavigator");if(!Ia)return!0;fb.saveMark();da=da||1;for(var nb=0;nb<da;nb++)Ia[Na](fb,Jb);return!0}};
me.once=cc;var Se=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:me.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:me.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:me.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:me.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:me.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Na,fb){function Jb(){var nb=Na.$expandRegionState,yb=me.pToI(Na,Na.cursorPosition);if(nb&&(nb.range[0]===yb||nb.range[1]===yb))return nb;nb=Na.selection.range;return Na.$expandRegionState={range:[me.pToI(Na,nb.start),
me.pToI(Na,nb.end)]}}fb=fb||{};var da=Na.pluginInvokeFirst("getNavigator");if(!da)return!0;var Ia=fb.start;fb=fb.end;if("number"===typeof Ia&&"number"===typeof fb)Jb(),da={range:[Ia,fb],prev:Jb()};else{Ia=da.ensureAST(Na);if(!Ia)return;da=da.expandRegion(Na,Na.textString,Ia,Jb())}da&&da.range&&(Na.selection={start:me.iToP(Na,da.range[0]),end:me.iToP(Na,da.range[1])},Na.$expandRegionState=da);me.once(Na,"selectionChange",function(){return Na.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Na){if(Na.selection.isEmpty())return!0;var fb=Na.pluginInvokeFirst("getNavigator");if(!fb)return!0;var Jb=fb.ensureAST(Na);if(!Jb)return!0;var da=Na.$expandRegionState;if(!da)return!0;(fb=fb.contractRegion(Na,Na.textString,Jb,da))&&fb.range&&(Na.selection={start:me.iToP(Na,fb.range[0]),end:me.iToP(Na,fb.range[1])},Na.$expandRegionState=fb);me.once(Na,"selectionChange",
function(){return Na.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];me.commands=Se;me.commands=Se;me.commands=Se;var Ze=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");Ze.arr=lc;Ze.chain=kf;Ze.string=md;var yf=[{name:"toggle comment",exec:function(Na){var fb=Na.pluginInvokeFirst("getComment");if(!fb)return!0;if(!fb.lineCommentStart)return fb.blockCommentStart?Na.execCommand("toggle block comment"):!0;var Jb=fb.lineCommentStart,da=
new RegExp("^(\\s*)("+Jb+"\\s?)(.*)");fb=Na.document;var Ia=Na.selection;Ia.isEmpty()||0!==Ia.end.column||Ia.growRight(-1);var nb=Ia.start.row;fb=fb.lineStrings.slice(Ia.start.row,Ia.end.row+1);fb=fb.some(function(xc){return!!xc.trim()})?Ze.arr.dropWhile(fb,function(xc){return xc.trim()?!1:++nb&&!0}):fb;var yb=fb.every(function(xc){return xc.trim()&&xc.match(da)});Na.undoManager.group();if(yb)fb.forEach(function(xc,jd){if(xc=xc.match(da)){xc=$jscomp.makeIterator(xc);xc.next();var ud=xc.next().value,
nd=xc.next().value;xc.next();Na.deleteText({start:{row:nb+jd,column:ud.length},end:{row:nb+jd,column:ud.length+nd.length}})}});else{var Bc=fb.reduce(function(xc,jd,ud){return jd.trim()||Ia.isEmpty()&&Ia.start.row===Ia.end.row?Math.min(xc,jd.match(/^\s*/)[0].length):xc},Infinity);Bc=Infinity===Bc?0:Bc;fb.forEach(function(xc,jd){xc=$jscomp.makeIterator(xc.match(/^(\s*)(.*)/));xc.next();xc.next();xc.next();Na.insertText(Jb+" ",{row:nb+jd,column:Bc})})}Na.undoManager.group();return!0}},{name:"toggle block comment",
exec:function(Na){var fb=Na.pluginInvokeFirst("getComment");if(!fb)return!0;if(!fb.blockCommentStart)return fb.lineCommentStart?Na.execCommand("toggle comment"):!0;if(!fb||!fb.blockCommentStart)return!0;var Jb=fb.blockCommentStart;fb=fb.blockCommentEnd;var da=new RegExp("^"+Jb.replace(/\*/g,"\\*")),Ia=new RegExp(fb.replace(/\*/g,"\\*")+"$"),nb=Na.tokenAt(Na.cursorPosition);if(nb&&"comment"===nb.token){var yb=Na.textInRange(nb);if(yb.match(da)&&yb.match(Ia))return Na.undoManager.group(),Na.replace(nb,
yb.slice(Jb.length,-fb.length)),Na.undoManager.group(),!0}Na.undoManager.group();Na.insertText(Jb,Na.selection.start);Na.insertText(fb,Na.selection.end);Na.undoManager.group();Jb=!Na.selection.isEmpty();Na.selection.growLeft(fb.length);Jb||Na.selection.collapse();return!0}},{name:"comment box",exec:function(Na,fb,Jb){fb=Na.undoManager.ensureNewGroup(Na,"comment box");if(Na.selection.isEmpty())return Na.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Na.execCommand("toggle comment"),
Na.undoManager.group(fb),!0;var da=Na.selection.range,Ia=Na.withSelectedLinesDo(function(yb){return yb}),nb=Ze.arr.min([da.start.column].concat(Ze.chain(Ia).map(function(yb){return yb.match(/^\s*/)}).flatten().compact().pluck("length").value()));Ia=Ze.arr.max(Ia.map(function(yb){return yb.length}))-nb;Ia=Array(Math.ceil(Ia/2)+1).join("-=")+"-";Na.execCommand("toggle comment");Na.collapseSelection();Na.cursorPosition={row:da.start.row,column:0};Jb?Na.insertText(Ze.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",nb)):Na.insertText(Ze.string.indent(Ia+"\n"," ",nb));Na.selection.goUp();Na.execCommand("toggle comment");Na.cursorPosition={row:da.end.row+2,column:0};Na.insertText(Ze.string.indent(Ia+"\n"," ",nb));Na.selection.goUp();Na.execCommand("toggle comment");Na.selection.range={start:{row:da.start.row,column:0},end:Na.cursorPosition};Na.undoManager.group(fb);return!0},multiSelectAction:"forEach",handlesCount:!0}];Ze.commands=yf;Ze.commands=yf;Ze.commands=yf;var vd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
vd.printSymbol=function(Na){if(Symbol.keyFor(Na))return'Symbol.for("'+Symbol.keyFor(Na)+'")';if(vd.knownSymbols.get(Na))return vd.knownSymbols.get(Na);String(Na).match(vd.symMatcher);return String(Na)};vd.defaultSort=function(Na,fb){if(Na.hasOwnProperty("priority")||fb.hasOwnProperty("priority")){var Jb=Na.priority||0,da=fb.priority||0;if(Jb<da)return-1;if(Jb>da)return 1}Na=(Na.keyString||Na.key).toLowerCase();fb=(fb.keyString||fb.key).toLowerCase();return Na<fb?-1:Na===fb?0:1};vd.safeToString=bb;
vd.propertyNamesOf=function(Na,fb){if(!Na)return[];if(Array.isArray(Na)){var Jb=fb?fb.offset:0;return vd.arr.range(Jb,Jb+(fb?fb.partitionSize:Na.length-1))}return vd.arr.sortBy(Object.keys(Na),function(da){return da.toLowerCase()})};vd.isMultiValue=Oc;vd.printValue=ma;vd.partitionedChildren=function(Na,fb){var Jb=void 0===fb?{}:fb;fb=void 0===Jb.originalValue?Na:Jb.originalValue;var da=void 0===Jb.offset?0:Jb.offset;Jb=void 0===Jb.partitionSize?Na.length||Object.values(Na).length:Jb.partitionSize;
if(vd.obj.isArray(Na)){Na=vd.num.roundTo(Math.max(vd.MIN_PARTITION_SIZE,Jb/50),.1);Jb/=Na;for(var Ia=[],nb=0;nb<Jb;nb++){var yb="["+(da+nb*Na)+"-"+(da+(nb+1)*Na)+"]";Ia.push({partition:{originalValue:fb,offset:da+nb*Na,partitionSize:Na},value:[],key:yb,keyString:yb,valueString:"...",isCollapsed:!0})}return Ia}Na=vd.num.roundTo(Math.max(vd.MIN_PARTITION_SIZE,Jb/50),.1);Jb/=Na;Ia=[];nb=vd.obj.keys(fb).sort();for(yb=0;yb<Jb;yb++){var Bc=da+yb*Na,xc=da+(yb+1)*Na,jd=vd.obj.select(fb,nb.slice(Bc,xc));Bc=
"["+nb[Bc].slice(0,4)+"-"+(nb[xc]||vd.arr.last(nb)).slice(0,4)+"]";Ia.push({partition:{originalValue:jd,offset:da+yb*Na,partitionSize:Na},value:[],key:Bc,keyString:Bc,valueString:"...",isCollapsed:!0})}return Ia};vd.propertiesOf=function(Na){var fb=Na.partition?Na.target:Na.value;if(!fb)return[];var Jb={_rev:!0},da=[],Ia="function"===typeof fb.livelyCustomInspect?fb.livelyCustomInspect():{},nb=Object.assign({},vd.defaultPropertyOptions,{},Ia);if(Ia.properties){Ia=$jscomp.makeIterator(Ia.properties);
for(var yb=Ia.next();!yb.done;yb=Ia.next()){var Bc=yb.value;yb=Bc.key;var xc=Bc.hidden,jd=Bc.priority,ud=Bc.keyString,nd=Bc.value;Bc=Bc.valueString;Jb[yb]=!0;xc||da.push(Na.getSubNode({priority:jd,key:yb,keyString:ud||vd.safeToString(yb),value:nd,valueString:Bc,isCollapsed:!0}))}}if(nb.includeDefault){Ia=vd.propertyNamesOf(fb,Na.partition);if(Ia.length>vd.MAX_NODE_THRESHOLD)for(Jb=$jscomp.makeIterator(vd.partitionedChildren(fb,Na.partition)),Ia=Jb.next();!Ia.done;Ia=Jb.next())da.push(Na.getSubNode(Ia.value));
else for(xc=$jscomp.makeIterator(Ia),Ia=xc.next();!Ia.done;Ia=xc.next())jd=Ia.value,jd in Jb||(Ia=fb[jd],yb=vd.printValue(Ia),Ia={keyString:jd,key:jd,value:Ia,valueString:yb,isCollapsed:!0},da.push(Na.getSubNode(Ia)));if(nb.includeSymbols)for(Jb=$jscomp.makeIterator(Object.getOwnPropertySymbols(fb)),Ia=Jb.next();!Ia.done;Ia=Jb.next())xc=Ia.value,jd=vd.safeToString(xc),Ia=fb[xc],yb=vd.printValue(Ia),Ia={key:xc,keyString:jd,value:Ia,valueString:yb,isCollapsed:!0},da.push(Na.getSubNode(Ia))}nb.sort&&
(da=nb.sortFunction(fb,da));return da};vd.obj=ke;vd.num=Hc;vd.arr=lc;vd.string=md;vd.connect=Pc;vd.signal=Nd;vd.TreeData=ec;vd.newUUID=$d;vd.localInterface=Za;vd.MAX_NODE_THRESHOLD=1E3;vd.MIN_PARTITION_SIZE=250;vd.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Na,fb){return Array.isArray(Na)?fb:fb.sort(vd.defaultSort)}};vd.symMatcher=/^Symbol\((.*)\)$/;vd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Na){return"symbol"===
typeof Symbol[Na]}).reduce(function(Na,fb){return Na.set(Symbol[fb],"Symbol."+fb)},new Map)}();vd.isMultiValue=Oc;vd.isMultiValue=Oc;vd.printValue=ma;vd.printValue=ma;var Ve=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Jb=fb.hasOwnProperty("InspectionTree")&&"function"===typeof fb.InspectionTree?fb.InspectionTree:fb.InspectionTree=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Kb(Jb,Na,[{key:Symbol.for("lively-instance-initialize"),value:function(da){Kb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,da);this.inspector=da.inspector;this.root.isInspectionNode||(this.root=vd.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(da){da=void 0===da?!0:da;return Kb._get(Object.getPrototypeOf(Jb.prototype),"asListWithIndexAndDepth",
this).call(this,function(Ia){Ia=Ia.node;return da?Ia.visible:!0})}},{key:"getContextFor",value:function(da){return da==this.root?this.root.value.inspectee:da.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(da){var Ia=void 0===da.maxDepth?1:da.maxDepth,nb=da.iterator,yb=da.showUnknown,Bc=da.showInternal,xc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(jd){if(1==jd.nextAddress)return jd.yield(xc.uncollapseAll(function(ud,nd){return Ia>nd&&(ud==xc.root||ud.value.submorphs)}),
2);xc.asListWithIndexAndDepth(!1).forEach(function(ud){var nd=ud.node;return 0==ud.depth?nd.visible=!0:!yb&&nd.keyString&&nd.keyString.includes("UNKNOWN PROPERTY")||!Bc&&nd.keyString&&nd.keyString.includes("internal")?nd.visible=!1:nd.value&&nd.value.submorphs?nd.visible=!0:nd.visible=nb(nd)});jd.jumpToEnd()})}},{key:"getChildren",value:function(da){return da.children}},{key:"display",value:function(da){return da.display(this.inspector)}},{key:"isCollapsed",value:function(da){return da.isCollapsed}},
{key:"isLeaf",value:function(da){return vd.obj.isPrimitive(da.value)}},{key:"collapse",value:function(da,Ia){var nb=this;da.isCollapsed=Ia;Ia||this.isLeaf(da)||da.children.length||(da.children=vd.propertiesOf(da).map(function(yb){nb.parentMap.set(yb,da);return yb}))}},{key:"retrieveForRemoteProxy",value:function(da){da.uuid||(da.uuid=vd.newUUID(),this.idToNodeMap[da.uuid]=da);return{uuid:da.uuid,value:this.isLeaf(da)?da.value:{},keyString:da.keyString,key:da.keyString,valueString:vd.safeToString(da.value),
isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return vd.localInterface}},{key:"getNodeViaId",value:function(da){return this.idToNodeMap[da]}},{key:"asRemoteDelegate",value:function(da){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[da]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(da,Ia){return new this({key:"inspectee",value:{inspectee:da},isCollapsed:!0,inspector:Ia})}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(vd.TreeData);vd.InspectionTree=Ve;vd.InspectionTree=
Ve;vd.InspectionTree=Ve;var Ye=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Jb=fb.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof fb.RemoteInspectionTree?fb.RemoteInspectionTree:fb.RemoteInspectionTree=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(da){this.parentMap=new WeakMap;this.root=da.proxy;this.evalEnvironment=da.evalEnvironment;this.inspector=da.inspector;this.delegateId=da.delegateId}},{key:"getContextFor",value:function(da){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+da.uuid+'").value'}},{key:"dispose",value:function(){var da=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){return Ia.yield(da.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
da.delegateId+"']\n    ",da.evalEnvironment),0)})}},{key:"display",value:function(da){return da.keyString+": "+da.valueString}},{key:"collapse",value:function(da,Ia){var nb=this,yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bc){if(1==Bc.nextAddress)return(da.isCollapsed=Ia)||nb.isLeaf(da)?Bc.return():da.children.length?Bc.jumpTo(0):Bc.yield(nb.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+da.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+nb.delegateId+'"]'}),3);yb=Bc.yieldResult;da.children=yb.isError?[]:yb.value;Bc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(da,Ia){var nb=this,yb,Bc,xc,jd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){if(1==ud.nextAddress)return ud.yield(nb.createRemoteContext(da,Ia),2);yb=ud.yieldResult;
Bc=yb.proxy;xc=yb.delegateId;jd=yb.evalEnvironment;return ud.return(new nb({key:"inspectee",proxy:Bc,delegateId:xc,evalEnvironment:jd,inspector:Ia}))})}},{key:"createRemoteContext",value:function(da,Ia){var nb=da.code,yb=da.evalEnvironment,Bc=da.delegateId,xc,jd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){if(1==ud.nextAddress)return Bc="lively://inspector-"+Ia.id,ud.yield(yb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
nb+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Bc+'");\n    ',yb),2);xc=ud.yieldResult;jd=xc.value;return ud.return({delegateId:Bc,evalEnvironment:yb,proxy:jd})})}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(vd.InspectionTree);
vd.RemoteInspectionTree=Ye;vd.RemoteInspectionTree=Ye;vd.RemoteInspectionTree=Ye;(function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Jb=fb.hasOwnProperty("InspectionNode")&&"function"===typeof fb.InspectionNode?fb.InspectionNode:fb.InspectionNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:Symbol.for("lively-instance-initialize"),value:function(da){var Ia=
da.root,nb=da.priority,yb=da.key,Bc=da.keyString,xc=da.value,jd=da.valueString,ud=da.isCollapsed,nd=void 0===da.children?[]:da.children,pf=void 0===da.isSelected?!1:da.isSelected,kg=void 0===da.visible?!0:da.visible;this.partition=da.partition;this.priority=nb;this.key=yb;this.keyString=String(Bc||yb);this.value=xc;this.valueString=jd||vd.printValue(xc);this.isCollapsed=ud;this.children=nd;this.isSelected=pf;this.visible=kg;this.root=Ia}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(da){if(da.value&&da.value.isMorph)return new vd.MorphNode(Object.assign({root:this.root},da));var Ia=da.key,nb=da.keyString,yb=this.value,Bc=da.partition;Bc&&(yb=Bc.originalValue,nb=Ia);return new vd.PropertyNode(Object.assign({},da,{keyString:nb,key:Ia,target:yb,partition:Bc,root:this.root,spec:{}}))}},{key:"display",value:function(da){var Ia=this.keyString,nb=this.valueString;if(!this.interactive)return Ia+": "+nb;this._propertyWidget||
(this._propertyWidget=da.renderDraggableTreeLabel({value:Ia+": "+nb}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(da,Ia){Ia=void 0===Ia?null:Ia;return da.value&&da.value.isMorph?new vd.MorphNode(Object.assign({root:Ia},da)):new vd.InspectionNode(Object.assign({root:Ia},da))}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Jb=fb.hasOwnProperty("MorphNode")&&"function"===typeof fb.MorphNode?fb.MorphNode:fb.MorphNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,
[{key:Symbol.for("lively-instance-initialize"),value:function(da){Kb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,da);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(da){var Ia=this.propertyInfo[da.key]||{};return da.value&&da.value.isMorph?new vd.MorphNode(Object.assign({},da,{root:this.root})):new vd.PropertyNode(Object.assign({},da,{root:this.root,target:this.target,
spec:Ia}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(vd.InspectionNode);(function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Jb=fb.hasOwnProperty("PropertyNode")&&
"function"===typeof fb.PropertyNode?fb.PropertyNode:fb.PropertyNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:Symbol.for("lively-instance-initialize"),value:function(da){Kb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,da);var Ia=da.spec,nb=da.target;this.partition=da.partition;this.target=nb;this.spec=Ia;this.foldedNodes={}}},{key:"__deserialize__",
value:function(da,Ia){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(da){this._interactive=da}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(da){return this.isFoldable?this.getFoldedContext(da):Kb._get(Object.getPrototypeOf(Jb.prototype),"getSubNode",this).call(this,da)}},{key:"getFoldedContext",
value:function(da){return this.foldedNodes[da.key]=new vd.FoldedNode(Object.assign({},da,{root:this.root,target:this.target,foldableNode:this,spec:vd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(da,Ia){(Ia=void 0===Ia?!1:Ia)&&(this.target[this.key]=da);this.value=this.target[this.key];this.valueString=vd.printValue(this.value);this.interactive&&(Ia||this._propertyWidget.highlight());if(this.isFoldable)for(var nb in this.foldedNodes)this.foldedNodes[nb].value=
this.value[nb],this.foldedNodes[nb].valueString=vd.printValue(this.value[nb]),this.foldedNodes[nb]._propertyWidget&&vd.signal(this.foldedNodes[nb]._propertyWidget,"update",this.value[nb])}},{key:"display",value:function(da){var Ia=this,nb=this._propertyWidget,yb=this.keyString,Bc=this.valueString,xc=this.target,jd=this.value,ud=this.spec;if(!(this.interactive||ud.foldable&&vd.isMultiValue(jd,ud.foldable)))return da.renderPropertyControl({target:xc,keyString:yb,valueString:Bc,tree:da.ui.propertyTree,
value:jd,spec:ud,node:this,fastRender:!0});if(nb)return nb.keyString=yb,nb.valueString=Bc,nb.isSelected=this.isSelected,nb.control&&(nb.control.isSelected=this.isSelected),nb;nb=this._propertyWidget=da.renderPropertyControl({target:xc,keyString:yb,valueString:Bc,value:jd,spec:ud,node:this,isSelected:this.isSelected,fontColor:da.ui.propertyTree.fontColor});this.isInternalProperty||ud.readOnly||(vd.connect(nb,"propertyValue",this,"refreshProperty",{updater:function(nd,pf){return nd(pf,!0)}}),vd.connect(nb,
"openWidget",this.root,"onWidgetOpened",{converter:function(nd){return{widget:nd,node:Ia.sourceObj}}}));return nb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(vd.InspectionNode);
(function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Jb=fb.hasOwnProperty("FoldedNode")&&"function"===typeof fb.FoldedNode?fb.FoldedNode:fb.FoldedNode=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:Symbol.for("lively-instance-initialize"),value:function(da){Kb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
da);this.foldableNode=da=da.foldableNode;this.foldedProp=da.key+vd.string.capitalize(this.key)}},{key:"refreshProperty",value:function(da,Ia){Ia=void 0===Ia?!1:Ia;var nb={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(nb[this.key]=da,nb)),Ia)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(vd.PropertyNode);var cg=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");cg.Color=Bb;var eg=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Jb=fb.hasOwnProperty("DarkTheme")&&"function"===typeof fb.DarkTheme?fb.DarkTheme:fb.DarkTheme=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Kb(Jb,Na,[{key:"background",get:function(){return cg.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return cg.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:cg.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:cg.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:cg.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:cg.Color.white,fontWeight:"bold",backgroundColor:cg.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:cg.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:cg.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],fb,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),Vg=eg=cg.DarkTheme;cg.default=eg;var pc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");pc.inspect=Aa;pc.remoteInspect=xb;pc.generateReferenceExpression=P;pc.onNumberDragStart=
function(Na,fb){fb.initPos=Na.position;fb.factorLabel=(new pc.Tooltip({description:"1x"})).openInWorld(Na.hand.position.addXY(10,10))};pc.onNumberDrag=function(Na,fb){var Jb=pc.getScaleAndOffset(Na,fb),da=Jb.scale;Jb=Jb.offset;fb.factorLabel.position=Na.hand.position.addXY(10,10);fb.factorLabel.description=da+"x";return pc.getCurrentValue(Jb,da,fb)};pc.onNumberDragEnd=function(Na,fb){var Jb=pc.getScaleAndOffset(Na,fb);Na=Jb.offset;Jb=Jb.scale;fb.factorLabel.softRemove();return pc.getCurrentValue(Na,
Jb,fb)};pc.getScaleAndOffset=function(Na,fb){var Jb=Na.position.subPt(fb.initPos);Na=Jb.x;fb=pc.num.roundTo(Math.exp(-Jb.y/$world.height*6),.01)*fb.baseFactor;return{offset:Na,scale:fb}};pc.getCurrentValue=function(Na,fb,Jb){return Math.max(Jb.min,Math.min(Jb.max,Jb.scrubbedValue+(Jb.floatingPoint?Na*fb:Math.round(Na*fb))))};pc.Color=Bb;pc.Rectangle=bc;pc.rect=le;pc.pt=Td;pc.obj=ke;pc.num=Hc;pc.Path=Dc;pc.arr=lc;pc.promise=Ic;pc.connect=Pc;pc.disconnect=Vb;pc.once=cc;pc.Morph=Lc;pc.Tooltip=dd;pc.VerticalLayout=
Hd;pc.GridLayout=Ld;pc.HorizontalLayout=wc;pc.morph=Xc;pc.CustomLayout=rb;pc.Label=Gb;pc.Icon=Oa;pc.StyleSheet=$c;pc.config=ab;pc.Tree=Qa;pc.LoadingIndicator=Ja;pc.DropDownList=eb;pc.DropDownSelector=Rb;pc.SearchField=zc;pc.LabeledCheckBox=sb;pc.MorphHighlighter=ha;pc.InteractiveMorphSelector=Ha;pc.printValue=ma;pc.RemoteInspectionTree=Ye;pc.InspectionTree=Ve;pc.isMultiValue=Oc;pc.valueWidgets=W;pc.popovers=ra;pc.DarkTheme=Vg;pc.DefaultTheme=mc;pc.syncEval=Ab;pc.inspectorCommands=[{name:"focus codeEditor",
exec:function(Na){Na.get("codeEditor").show();Na.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Na){Na.get("propertyTree").show();Na.get("propertyTree").focus();return!0}}];(function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=fb.hasOwnProperty("DraggedProp")&&"function"===typeof fb.DraggedProp?fb.DraggedProp:fb.DraggedProp=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Kb(Jb,Na,[{key:"applyToTarget",value:function(da){var Ia=this.currentTarget,nb=this.control;this.remove();pc.MorphHighlighter.removeHighlighters(da.world);if(Ia)if(Ia.isText&&"js"===Ia.editorModeName){var yb=Ia.evalEnvironment.context;da=Ia.textPositionFromPoint(Ia.localize(da.position));yb=pc.generateReferenceExpression(this.sourceObject,{fromMorph:yb});nb.keyString&&(yb+="."+nb.keyString);Ia.insertTextAndSelect(yb,da);Ia.focus()}else"propertyValue"in nb&&(Ia[nb.keyString]=nb.propertyValue)}},
{key:"update",value:function(da){da=da.hand.globalPosition;var Ia=this.morphBeneath(da);if(Ia){for(Ia==this.morphHighlighter&&(Ia=Ia.morphBeneath(da));[Ia].concat($jscomp.arrayFromIterable(Ia.ownerChain())).find(function(nb){return!nb.visible});)Ia=Ia.morphBeneath(da);if(Ia!=this.currentTarget){this.currentTarget=Ia;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Ia.isWorld)return;this.morphHighlighter=pc.MorphHighlighter.for($world,Ia);this.morphHighlighter.show()}this.position=da}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:pc.Color.rgb(169,204,227)},fill:{defaultValue:pc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var da=this.control;if(!da)return this.submorphs=[];this.height=22;this.submorphs=[da];da.top=0;da.fontSize=14;"function"===typeof da.relayout&&
da.relayout();this.width=da.width+20;this.adjustOrigin(pc.pt(10,10))}}}}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3714})})(pc.Morph);(function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=fb.hasOwnProperty("DraggableTreeLabel")&&"function"===
typeof fb.DraggableTreeLabel?fb.DraggableTreeLabel:fb.DraggableTreeLabel=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(da){this.draggedProp=new pc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();pc.connect(da.hand,"update",this.draggedProp,"update")}},
{key:"onDrag",value:function(da){}},{key:"onDragEnd",value:function(da){pc.disconnect(da.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(da)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:pc.config.codeEditor.defaultStyle.fontFamily},
fill:{defaultValue:pc.Color.transparent},padding:{defaultValue:pc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(da){this.setProperty("isSelected",da);da?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=da)}}}}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3716,end:5055})})(pc.Label);Ve=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=fb.hasOwnProperty("PropertyControl")&&"function"===typeof fb.PropertyControl?fb.PropertyControl:fb.PropertyControl=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(da,Ia,nb){da.control=new pc.DropDownSelector({opacity:.8,fill:pc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Ia,padding:0,values:nb});pc.connect(da.control,"update",da,"propertyValue",{updater:function(yb,Bc){this.targetObj.propertyValue!=Bc&&yb(Bc)}});pc.connect(da,"update",da.control,"selectedValue",{updater:function(yb,Bc){Bc=Bc&&Bc.valueOf?Bc.valueOf():Bc;this.targetObj.propertyValue!=Bc&&yb(Bc)}});return da}},
{key:"toggleMultiValuePlaceholder",value:function(da){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:pc.Color.transparent,layout:new pc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:pc.arr.range(0,2).map(function(Ia){return{type:"ellipse",fill:pc.Color.gray.withA(.5),reactsToPointer:!1,extent:pc.pt(7,7)}})});da?(pc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),
this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(pc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(da){this.foldableProperties&&this.toggleMultiValuePlaceholder(pc.isMultiValue(da,this.foldableProperties))}},{key:"asFoldable",value:function(da){this.foldableProperties=da;pc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();
this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var da=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});
da.isLayoutable=!1;da.fontWeight="bold";da.fontColor=pc.Color.orange;da.reactsToPointer=!1;da.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(da){this.submorphs=[da]}},layout:{initialize:function(){this.layout=new pc.CustomLayout({relayout:function(da){da.relayout()}})}},
submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(da){return(da=da.value)&&(da.isColor||da.isGradient)?"Color":da&&da.isPoint?"Point":pc.obj.isBoolean(da)?"Boolean":pc.obj.isNumber(da)?"Number":pc.obj.isString(da)?"String":da&&da.isRectangle?"Rectangle":!1}},{key:"render",value:function(da){da.spec.type||(da.spec=Object.assign({},da.spec,{isFloat:!Number.isInteger(da.value),type:this.inferType(da)}));switch(da.spec.type){case "Color":var Ia=
this.renderColorControl(da);break;case "ColorGradient":Ia=this.renderColorControl(Object.assign({},da,{gradientEnabled:!0}));break;case "Number":Ia=this.renderNumberControl(da);break;case "String":Ia=this.renderStringControl(da);break;case "RichText":Ia=this.renderStringControl(da);break;case "Layout":Ia=this.renderLayoutControl(da);break;case "Enum":Ia=this.renderEnumControl(da);break;case "Shadow":Ia=this.renderShadowControl(da);break;case "Point":Ia=this.renderPointControl(da);break;case "Rectangle":Ia=
this.renderRectangleControl(da);break;case "Boolean":Ia=this.renderBooleanControl(da);break;default:Ia=this.renderItSomehow(da)}Ia.control&&(pc.connect(Ia.control,"openWidget",Ia,"openWidget"),Ia.toggleFoldableValue(da.value));return Ia}},{key:"baseControl",value:function(da){var Ia=da.spec;da=new this({keyString:da.keyString,valueString:da.valueString,isSelected:!1,propertyValue:da.value});Ia.foldable&&da.asFoldable(Ia.foldable);return da}},{key:"renderGrabbableKey",value:function(da){var Ia=this,
nb=da.target;return[da.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(yb){yb.state.draggedProp=new pc.DraggedProp({sourceObject:nb,control:Ia.baseControl(da)});yb.state.draggedProp.openInWorld();pc.connect(yb.hand,"update",yb.state.draggedProp,"update")},onDrag:function(yb){},onDragEnd:function(yb){pc.disconnect(yb.hand,"update",yb.state.draggedProp,"update");yb.state.draggedProp.applyToTarget(yb)}}]}},{key:"renderEnumControl",value:function(da){var Ia=da.value,nb=da.spec.values,
yb=da.keyString,Bc=da.target,xc=da.node,jd=function(ud,nd){return $jscomp.asyncExecutePromiseGeneratorProgram(function(pf){Bc.world().openWorldMenu(ud,nb.map(function(kg){return{string:kg.toString(),action:function(){Bc[yb]=kg;xc.rerender()}}}));pf.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+(Ia?Ia.valueOf?Ia.valueOf():Ia:"Not set"),{nativeCursor:"pointer",onMouseDown:jd}],$jscomp.arrayFromIterable(pc.Icon.textAttribute("angle-down",{paddingTop:"4px",
paddingLeft:"4px",opacity:.7,onMouseDown:jd})))}},{key:"renderStringControl",value:function(da){var Ia=da.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+(200<Ia.length?Ia.slice(0,20)+"...":Ia),{fontColor:pc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(da){var Ia=da.value,nb=da.keyString,yb=da.valueString,Bc=da.target,xc=da.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+yb,{fontColor:pc.Color.black,
nativeCursor:"pointer",onMouseDown:function(jd){var ud;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nd){if(1==nd.nextAddress)return ud=new pc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:Ia}),ud.relayout(),nd.yield(ud.fadeIntoWorld(jd.positionIn(Bc.world())),2);pc.connect(ud,"rectangle",function(pf){Bc[nb]=pf;xc.rerender()});nd.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(da){var Ia=da.value,nb=da.keyString,yb=da.valueString,Bc=da.target,xc=da.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),
[" "+yb,{nativeCursor:"pointer",fontColor:Ia?pc.Color.green:pc.Color.red,onMouseDown:function(jd){Bc[nb]=!Bc[nb];xc.rerender()}}])}},{key:"renderNumberControl",value:function(da){var Ia=da.value,nb=da.spec,yb=da.keyString,Bc=da.valueString,xc=da.node,jd=da.target,ud=da.tree,nd=void 0===xc._numberControls?new qh:xc._numberControls,pf=$jscomp.makeIterator(nd.submorphs),kg=pf.next().value,Wf=pf.next().value;nd.fontColor=ud.fontColor;var Fh=xc._numberControls=nd;"max"in nb&&"min"in nb&&-Infinity!=nb.min&&
Infinity!=nb.max?(Fh.baseFactor=(nb.max-nb.min)/100,Fh.floatingPoint=nb.isFloat,Fh.max=nb.max,Fh.min=nb.min):(Fh.floatingPoint=nb.isFloat,Fh.baseFactor=.5,Fh.min=void 0!=nb.min?nb.min:-Infinity,Fh.max=void 0!=nb.max?nb.max:Infinity);var Df=pc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),$jscomp.arrayFromIterable(xc._inputMorph?[xc._inputMorph,{}]:[" "+(void 0!=Ia&&(Ia.valueOf?Ia.valueOf():Ia).toFixed(nb.isFloat?
Math.max(4,pc.num.precision(Ia)):0))+" ",{fontColor:Df,onMouseUp:function(wh){xc._inputMorph=pc.morph({type:"input",fill:null,fontColor:Df,fontFamily:"IBM Plex Mono",fontSize:14,padding:pc.rect(8,2,-6,2),height:23,cursorColor:pc.Color.white,value:Ia.valueOf?Ia.valueOf():Bc});jd[yb]=Ia;xc._inputMorph.focus();pc.once(xc._inputMorph,"inputAccepted",function(ck){delete xc._inputMorph;jd[yb]=nb.isFloat?Number.parseFloat(ck):Number.parseInt(ck);xc.rerender()});pc.once(xc._inputMorph,"onBlur",function(ck){xc._inputMorph&&
(delete xc._inputMorph,jd[yb]=Ia,xc.rerender())});xc.rerender()},onDragStart:function(wh){Fh.scrubbedValue=Ia;pc.onNumberDragStart(wh,Fh)},onDrag:function(wh){jd[yb]=pc.onNumberDrag(wh,Fh);xc.rerender()},onDragEnd:function(wh){return pc.onNumberDragEnd(wh,Fh)}},nd,{onMouseUp:function(){kg.fill=Wf.fill=null},onMouseDown:function(wh){if(wh.targetMorph===kg){kg.fill=pc.Color.white.withA(.2);if("max"in nb&&jd[yb]>=nb.max)return;jd[yb]+=1}if(wh.targetMorph===Wf){Wf.fill=pc.Color.white.withA(.2);if("min"in
nb&&jd[yb]<=nb.min)return;--jd[yb]}xc.rerender()}}]))}},{key:"renderShadowControl",value:function(da){var Ia=da.keyString,nb=da.value,yb=da.target,Bc=da.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[""+(nb?nb.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(xc){var jd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){if(1==ud.nextAddress)return jd=new pc.popovers.ShadowPopover({shadowValue:yb[Ia],hasFixedPosition:!0}),ud.yield(jd.fadeIntoWorld(xc.positionIn(yb.world())),
2);pc.connect(jd,"shadowValue",function(nd){yb[Ia]=nd;Bc.rerender()});ud.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(da){var Ia=da.keyString,nb=da.value,yb=da.target,Bc=da.node,xc=pc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,jd={nativeCursor:"pointer",onMouseDown:function(ud){var nd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pf){if(1==pf.nextAddress)return nd=new pc.popovers.PointPopover({pointValue:yb[Ia],hasFixedPosition:!0}),pf.yield(nd.fadeIntoWorld(ud.positionIn(yb.world())),
2);pc.connect(nd,"pointValue",function(kg){yb[Ia]=kg;Bc.rerender()});pf.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" pt(",Object.assign({},jd),""+nb.x.toFixed(),Object.assign({fontColor:xc},jd),",",Object.assign({},jd),""+nb.y.toFixed(),Object.assign({fontColor:xc},jd),")",Object.assign({},jd)])}},{key:"renderLayoutControl",value:function(da){var Ia=da.valueString,nb=da.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+(nb?
Ia:"No Layout"),{onMouseDown:function(yb){}}])}},{key:"renderColorControl",value:function(da){var Ia=da.node,nb=da.gradientEnabled,yb=da.valueString,Bc=da.keyString,xc=da.value,jd=da.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[pc.morph({fill:xc.valueOf?xc.valueOf():xc,extent:pc.pt(15,15),borderColor:pc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(xc?xc.valueOf?xc.valueOf():yb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(ud){var nd;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(pf){if(1==pf.nextAddress)return nd=new pc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:jd,fillValue:xc,title:"Fill Control",gradientEnabled:nb}),pf.yield(nd.fadeIntoWorld(ud.positionIn(jd.world())),2);pc.connect(nd,"fillValue",function(kg){jd[Bc]=kg;Ia.rerender()});pf.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(da){var Ia=da.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(da)),[" "+Ia,
{}])}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5064,end:20451})}(pc.DraggableTreeLabel);pc.PropertyControl=Ve;pc.PropertyControl=Ve;pc.PropertyControl=Ve;pc.inspect=Aa;pc.inspect=Aa;pc.remoteInspect=xb;pc.remoteInspect=xb;pc.generateReferenceExpression=P;pc.generateReferenceExpression=
P;var qh=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=fb.hasOwnProperty("NumberControls")&&"function"===typeof fb.NumberControls?fb.NumberControls:fb.NumberControls=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=
new pc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:pc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(da){this.submorphs.map(function(Ia){return Ia.fontColor=da})}},submorphs:{initialize:function(){this.submorphs=[pc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:pc.rect(5,2,0,-6),fontSize:12}),pc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:pc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",
fontSize:12})]}}}}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23124,end:24169})}(pc.Morph);(function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=fb.hasOwnProperty("PropertyTree")&&"function"===typeof fb.PropertyTree?fb.PropertyTree:fb.PropertyTree=
function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:"onDrag",value:function(da){this._onDragHandler&&this._onDragHandler(da)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25334,end:25445})})(pc.Tree);Ve=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Jb=fb.hasOwnProperty("Inspector")&&"function"===typeof fb.Inspector?fb.Inspector:fb.Inspector=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();
this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(da){}},{key:"__after_deserialize__",value:function(da,Ia,nb){var yb=this,Bc=new pc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:pc.InspectionTree.forObject(null,this)}));this.addMorph(Bc,this.getSubmorphNamed("terminal toggler"));Kb._get(Object.getPrototypeOf(Jb.prototype),"__after_deserialize__",this).call(this,da,Ia,nb);!this.isComponent&&this.master.whenApplied().then(function(){yb.layout.col(0).row(1).group.morph=
Bc;yb.targetObject&&(yb.targetObject=yb.targetObject)})}},{key:"__additionally_serialize__",value:function(da,Ia,nb,yb){da=da.props.submorphs.value;for(Ia=da.length;Ia--;)nb.refForId(da[Ia].id).realObj==this.ui.propertyTree&&pc.arr.removeAt(da,Ia)}},{key:"renderDraggableTreeLabel",value:function(da){return new pc.DraggableTreeLabel(da)}},{key:"renderPropertyControl",value:function(da){return pc.PropertyControl.render(da)}},{key:"onLoad",value:function(){var da=this.ui,Ia=da.codeEditor,nb=da.thisBindingSelector,
yb=da.propertyTree;Ia.changeEditorMode("js").then(function(){return Ia.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==nb.selection?Ia.owner.selectedContext:Ia.owner.targetObject},get systemInterface(){return pc.Path("treeData.systemInterface").get(yb)},format:"esm"}}).catch(function(Bc){return $world.logError(Bc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(da){Kb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,da);da=this.ui;var Ia=da.targetPicker,nb=da.propertyTree,yb=da.resizer,Bc=da.terminalToggler,xc=da.unknowns,jd=da.internals,ud=da.searchField,nd=da.codeEditor,pf=da.fixImportButton,kg=da.thisBindingSelector;nd.changeEditorMode("js").then(function(){return nd.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==kg.selection?nd.owner.selectedContext:nd.owner.targetObject},get systemInterface(){return nb.treeData.systemInterface},format:"esm"}}).catch(function(Wf){return $world.logError(Wf)});
pc.connect(Ia,"onMouseDown",this,"selectTarget");pc.connect(nb,"onScroll",this,"repositionOpenWidget");pc.connect(yb,"onDrag",this,"adjustProportions");pc.connect(Bc,"onMouseDown",this,"toggleCodeEditor");pc.connect(xc,"trigger",this,"filterProperties");pc.connect(jd,"trigger",this,"filterProperties");pc.connect(ud,"searchInput",this,"filterProperties");pc.connect(nb,"nodeCollapseChanged",this,"filterProperties");pc.connect(this,"extent",this,"relayout");pc.connect(kg,"selection",this,"bindCodeEditorThis");
pc.connect(pf,"fire",nd,"execCommand",{updater:function(Wf){return Wf("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var da=this.ui.propertyTree.selectedIndex-1,Ia=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Ia=this.ui.propertyTree.document.getLine(da).textAndAttributes.slice(0,4).concat(Ia.display(this));da=this.ui.propertyTree.lineRange(da,!1);this.ui.propertyTree.replace(da,Ia,!1,!1,
!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var da=pc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(da!=this.lastChange||this.lastSubmorphs!=pc.printValue(this.targetObject&&
this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==da.prop&&this.repositionOpenWidget(),this.lastChange=da,this.lastSubmorphs=pc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var da;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Ia){Ia=Ia.node;Ia.target&&(da=Ia.foldableNode?Ia.target[Ia.foldableNode.key][Ia.key]:Ia.target[Ia.key],
!pc.obj.equals(da,Ia.value)&&Ia.refreshProperty&&Ia.refreshProperty(da))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(da,Ia){Ia=void 0===Ia?!1:Ia;var nb=this,yb,Bc,xc,jd,ud,nd,pf,kg,Wf,Fh,Df,wh,ck,bi,Al;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yg){switch(yg.nextAddress){case 1:if(!nb.isUpdating()){yg.jumpTo(2);break}return yg.yield(nb.whenUpdated(),
2);case 2:yb=pc.promise.deferred();Bc=yb.promise;xc=!!nb.target;nb.updateInProgress=Bc;yg.setCatchFinallyBlocks(4);Ia&&(jd=pc.LoadingIndicator.open("connecting to remote..."));if(!Ia){ud=pc.InspectionTree.forObject(da,nb);yg.jumpTo(6);break}return yg.yield(pc.RemoteInspectionTree.forObject(da,nb),7);case 7:ud=yg.yieldResult;case 6:return nd=ud,pf=nb.ui.propertyTree,yg.yield(nd.collapse(nd.root,!1),8);case 8:if(!nd.root.children){yg.jumpTo(9);break}return yg.yield(nd.collapse(nd.root.children[0],!1),
9);case 9:if(kg=nb.originalTreeData&&nb.originalTreeData.diff(nd)){Wf=$jscomp.makeIterator(kg);for(Fh=Wf.next();!Fh.done;Fh=Wf.next())Df=Fh.value,wh=$jscomp.makeIterator(Df),ck=wh.next().value,bi=wh.next().value,ck.refreshProperty(bi.value);yg.jumpTo(11);break}pf.treeData=nd;return yg.yield(nb.filterProperties(),12);case 12:if(!pf.treeData.root.isCollapsed){yg.jumpTo(13);break}return yg.yield(pf.onNodeCollapseChanged({node:nd.root,isCollapsed:!1}),14);case 14:pf.selectedIndex=1;case 13:return yg.yield(pf.execCommand("uncollapse selected node"),
11);case 11:nb.toggleWindowStyle(xc);jd&&jd.remove();yg.leaveTryBlock(5);break;case 4:Al=yg.enterCatchBlock(),nb.showError(Al);case 5:nb.startStepping(1E3,"refreshAllProperties"),nb.updateInProgress=null,yg.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(da){da=void 0===da?!0:da;var Ia=this,nb,yb,Bc,xc,jd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){if(1==ud.nextAddress)return nb=300,xc=Ia.ui.codeEditor.pluginFind(function(nd){return nd.runEval}),jd=Ia.getWindow(),ud.yield(xc.runEval("System.get('@system-env').node"),
2);ud.yieldResult.value?(Bc=[].concat($jscomp.arrayFromIterable(pc.arr.without(jd.styleClasses,"local")),["node"]),yb=pc.DarkTheme.instance):(Bc=["local"].concat($jscomp.arrayFromIterable(jd?pc.arr.without(jd.styleClasses,"node"):[])),yb=pc.DefaultTheme.instance);xc.theme=yb;da?(jd&&jd.animate({duration:nb,styleClasses:Bc}),Ia.ui.codeEditor.animate({fill:yb.background,duration:nb})):jd&&(jd.styleClasses=Bc);Ia.ui.codeEditor.textString=Ia.ui.codeEditor.textString;xc.highlight();ud.jumpToEnd()})}},
{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var da=this,Ia=Object.assign({type:"text",borderWidth:1,borderColor:pc.Color.gray,lineWrapping:"by-chars"},pc.config.codeEditor.defaultStyle,{textString:""}),nb=pc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});pc.rect(0,0,this.width,30);
var yb=new pc.SearchField({styleClasses:["idle"],name:"searchField"});nb[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[yb,{type:"button",name:"targetPicker",padding:pc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:pc.Icon.textAttribute("crosshairs")},new pc.LabeledCheckBox({label:"Internals",name:"internals"}),new pc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new pc.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:pc.InspectionTree.forObject(null,this)})),pc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},Ia),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:pc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(nb),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(nb),
[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){da.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var da=this,Ia,nb,yb,Bc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){switch(xc.nextAddress){case 1:if(da.env.eventDispatcher.isKeyPressed("Shift"))return nb=$jscomp,yb=nb.makeIterator,xc.yield($world.execCommand("select morph",
{justReturn:!0}),5);da.toggleSelectionInstructions(!0);return xc.yield(pc.InteractiveMorphSelector.selectMorph(),4);case 4:Ia=xc.yieldResult;da.toggleSelectionInstructions(!1);xc.jumpTo(3);break;case 5:Bc=yb.call(nb,xc.yieldResult),Ia=Bc.next().value;case 3:Ia&&(da.targetObject=Ia),xc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(da){if(da&&!this.instructionWidget){var Ia=pc.morph({type:"label",name:"escapeKey",value:"esc"});Ia.whenRendered().then(function(){return Ia.fit()});
this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},Ia,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",
value:function(da){da=da.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;da.epiMorph=!0;this.openWidget=da;pc.once(da,"close",this,"closeOpenWidget");pc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var da=this.ui.propertyTree,Ia=da.textLayout.boundsFor(da,{column:0,row:da.selectedIndex-1});Ia=da.worldPoint(pc.pt(Ia.x,Ia.y+Ia.height/2)).addPt(da.scroll.negated());da=da.globalBounds();
Ia.x=this.globalBounds().center().x;Ia.y<da.top()?Ia=da.topCenter():da.bottom()-20<Ia.y&&(Ia=da.bottomCenter().addXY(0,-20));return Ia}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(da){this.layout.row(1).height+=da.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(da){if(da!==
this.isEditorVisible()){var Ia=this.extent,nb=this.layout,yb=this.ui,Bc=yb.terminalToggler,xc=yb.codeEditor,jd=yb.thisBindingSelector;yb=yb.fixImportButton;nb.disable();da?(Bc.fontColor=pc.Color.rgbHex("00e0ff"),nb.row(3).height=this.codeEditorHeight||180,nb.row(2).height=5,yb.animate({visible:!0,duration:200}),jd.animate({visible:!0,duration:200})):(this.codeEditorHeight=nb.row(3).height,Bc.fontColor=pc.Color.white,nb.row(3).height=nb.row(2).height=0,yb.animate({visible:!1,duration:200}),jd.animate({visible:!1,
duration:200}));this.extent=Ia;nb.enable({duration:200});this.relayout({duration:200});xc.focus();xc.animate({opacity:da?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var da=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){da.makeEditorVisible(!da.isEditorVisible());Ia.jumpToEnd()})}},{key:"filterProperties",value:function(){var da=this,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress)return Ia=da.ui.searchField,nb=da.ui.propertyTree,
da.originalTreeData||(da.originalTreeData=nb.treeData),pc.disconnect(nb.treeData,"onWidgetOpened",da,"onWidgetOpened"),yb.yield(nb.treeData.filter({maxDepth:2,showUnknown:da.ui.unknowns.checked,showInternal:da.ui.internals.checked,iterator:function(Bc){return Ia.matches(Bc.key)}}),2);nb.update();pc.connect(nb.treeData,"onWidgetOpened",da,"onWidgetOpened");yb.jumpToEnd()})}},{key:"relayout",value:function(da){da=void 0===da?{}:da;var Ia=this,nb,yb,Bc,xc,jd,ud,nd,pf,kg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wf){Ia.layout&&
Ia.layout.forceLayout();nb=Ia;yb=nb.ui;Bc=yb.fixImportButton;xc=yb.terminalToggler;jd=yb.propertyTree;ud=yb.thisBindingSelector;nd=jd.bounds().insetBy(5).bottomLeft();pf=jd.bounds().insetBy(5).bottomRight();kg=pf.subXY(Bc.width+10,0);ud.width=115;ud.listMorph.itemHeight=20;da.duration?(xc.animate(Object.assign({bottomLeft:nd},da)),Bc.animate(Object.assign({bottomRight:pf},da)),ud.animate(Object.assign({bottomRight:kg},da))):(xc.bottomLeft=nd,Bc.bottomRight=pf,ud.bottomRight=kg);Wf.jumpToEnd()})}},
{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Kb._get(Object.getPrototypeOf(Jb.prototype),"keybindings",this))}},{key:"commands",get:function(){return pc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(da){if(System._testsRunning)return console.log(da.targetObject);
da=new this(da);da.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return da}},{key:"properties",get:function(){return{extent:{defaultValue:pc.pt(400,500)},fill:{defaultValue:pc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(da){this.setProperty("remoteTarget",da);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(da,!0))}},targetObject:{after:["submorphs"],set:function(da){this._serializableTarget=
da&&da.isMorph?da.id:da;this.setProperty("targetObject",da);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(da))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var da=this.ui.propertyTree,Ia=da.treeData;return Ia.getContextFor(da.selectedNode||Ia.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),
fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},
treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:pc.Color.gray,fontSize:14,fontFamily:pc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:25462,end:45996})}(pc.Morph);Ve=pc.Inspector;Ye=Ca("I",Ve);pc.default=Ve;var rh=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");rh.Inspector=Ye;rh.string=md;rh.Morph=Lc;rh.pt=Td;rh.Color=Bb;Ve=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Na,fb,Jb){Jb=void 0===Jb?1:Jb;var da,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){switch(yb.nextAddress){case 1:return Na.maybeSelectCommentOrLine(),
yb.setCatchFinallyBlocks(2),fb=Object.assign({},fb,{logDoit:!0,inspect:!0,inspectDepth:Jb}),yb.yield(Na.doEval(void 0,fb),4);case 4:da=yb.yieldResult;Ia=da.error?da.error:da.isError?da.value:null;yb.leaveTryBlock(3);break;case 2:Ia=nb=yb.enterCatchBlock();case 3:return Ia?Na.showError(Ia):Na.setStatusMessage(rh.string.truncate(da.value,1E3)),yb.return(da)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Na,fb){var Jb,da,Ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nb){switch(nb.nextAddress){case 1:return nb.setCatchFinallyBlocks(2),
nb.yield(Na.doEval({start:{row:0,column:0},end:Na.documentEndPosition},Object.assign({},fb,{logDoit:!0})),4);case 4:Jb=nb.yieldResult;da=Jb.error?Jb.error:Jb.isError?Jb.value:null;nb.leaveTryBlock(3);break;case 2:da=Ia=nb.enterCatchBlock();case 3:return da?Na.showError(da):Na.setStatusMessage(String(Jb.value)),nb.return(Jb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Na,fb){var Jb,da,Ia,nb,yb,Bc,xc,jd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){switch(ud.nextAddress){case 1:return Na.maybeSelectCommentOrLine(),
ud.setCatchFinallyBlocks(2),fb=Object.assign({},fb,{asString:!1,logDoit:!0}),ud.yield(Na.doEval(void 0,fb),4);case 4:Jb=ud.yieldResult;da=Jb.error?Jb.error:Jb.isError?Jb.value:null;ud.leaveTryBlock(3);break;case 2:da=Ia=ud.enterCatchBlock();case 3:Na.selection.collapseToEnd();if(nb=Jb.value&&Jb.value.isColor)return Na.selection.text=String(Jb.value),yb=new rh.Morph({fill:rh.Color.transparent,extent:rh.pt(Na.fontSize+2,Na.fontSize+2),submorphs:[{fill:Jb.value,center:rh.pt(Na.fontSize+2,Na.fontSize+
2).scaleBy(.5)}]}),Bc=Na.selection.start,xc=Bc.column,jd=Bc.row,Na.insertText([yb,{}],Na.selection.start),Na.selection.start={column:xc,row:jd},Na.focus(),ud.return(Jb);Na.insertTextAndSelect(da?String(da)+(da.stack?"\n"+da.stack:""):String(Jb.value));Na.focus();return ud.return(Jb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Na,fb){var Jb,da,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){switch(yb.nextAddress){case 1:Na.maybeSelectCommentOrLine();
da=Na.textInRange(Na.selection);Ia=Na.evalEnvironment||{};nb=Na.pluginFind(function(Bc){return Bc.isEditorPlugin&&"function"===typeof Bc.runEval});Ia.systemInterface||(Ia.systemInterface=nb.systemInterface(fb));if("local"!==Ia.systemInterface.name){yb.jumpTo(2);break}yb.setCatchFinallyBlocks(3);return yb.yield(Na.doEval(void 0,fb),5);case 5:Jb=yb.yieldResult;da=Jb.value;yb.leaveTryBlock(2);break;case 3:yb.enterCatchBlock();case 2:return Na.world().execCommand("open object editor",{target:da,evalEnvironment:Ia}),
yb.return(Jb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Na,fb){var Jb,da,Ia,nb,yb,Bc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){switch(xc.nextAddress){case 1:Na.maybeSelectCommentOrLine();Ia=Na.textInRange(Na.selection);nb=Na.evalEnvironment||{};yb=Na.pluginFind(function(jd){return jd.isEditorPlugin&&"function"===typeof jd.runEval});nb.systemInterface||(nb.systemInterface=yb.systemInterface(fb));
if("local"!==nb.systemInterface.name){rh.Inspector.openInWindow({remoteTarget:{code:Ia,evalEnvironment:nb}});xc.jumpTo(2);break}xc.setCatchFinallyBlocks(3);return xc.yield(Na.doEval(void 0,fb),5);case 5:Jb=xc.yieldResult;da=Jb.error?Jb.error:Jb.isError?Jb.value:null;Ia=Jb.value;xc.leaveTryBlock(4);break;case 3:da=Bc=xc.enterCatchBlock();case 4:rh.Inspector.openInWindow({targetObject:da||Ia});case 2:return xc.return(Jb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(Na,fb,Jb){Jb=void 0===Jb?1:Jb;var da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){switch(Ia.nextAddress){case 1:return Na.maybeSelectCommentOrLine(),Ia.setCatchFinallyBlocks(2),fb=Object.assign({},fb,{inspect:!0,inspectDepth:Jb,logDoit:!0}),Ia.yield(Na.doEval(void 0,fb),4);case 4:da=Ia.yieldResult;Ia.leaveTryBlock(3);break;case 2:Ia.enterCatchBlock();case 3:return Na.selection.collapseToEnd(),Na.insertTextAndSelect(da.value),Ia.return(da)}})}}];rh.codeEvaluationCommands=
Ve;rh.codeEvaluationCommands=Ve;rh.codeEvaluationCommands=Ve;var nh=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");nh.changeAttributeInSelectionOrMorph=function(Na,fb,Jb){var da=Na.selection;Na.keepPosAtSameScrollOffsetWhile(function(){da.isEmpty()?Na[fb]="function"===typeof Jb?Jb(Na[fb]):Jb:(Na.undoManager.group(),Na.changeStyleProperty(fb,function(Ia){return"function"===typeof Jb?Jb(Ia):Jb}),Na.undoManager.group())})};Ye=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(Na){var fb=Na.fontSize;nh.changeAttributeInSelectionOrMorph(Na,"fontSize",function(Jb){Jb=Jb||fb;return Jb+(18<=Jb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Na){var fb=Na.fontSize;nh.changeAttributeInSelectionOrMorph(Na,"fontSize",function(Jb){Jb=Jb||fb;return Jb-(18>=Jb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Na){var fb,Jb,da,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress){fb=
["serif","sans-serif","monospace"];if(Jb=localStorage["lively.morpic/text-change-font-additional-fonts"])Jb=JSON.parse(Jb),fb.push.apply(fb,$jscomp.arrayFromIterable(Jb));fb.map(function(Bc){return Bc.toLowerCase()}).includes(Na.fontFamily.toLowerCase())||(fb.push(Na.fontFamily),Jb=[].concat($jscomp.arrayFromIterable(Jb||[]),[Na.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Jb));return yb.yield($world.editListPrompt("choose font",fb,{requester:Na,preselect:fb.indexOf(Na.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}da=yb.yieldResult;Ia=$jscomp.makeIterator(da.selections);if(nb=Ia.next().value)Na.fontFamily=nb;return yb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Na,fb){fb=void 0===fb?{}:fb;var Jb,da,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress){if(fb.hasOwnProperty("link"))return yb.jumpTo(2);da=Na.selection;Ia=Na.getStyleInRange(da);nb=Ia.link;return yb.yield(Na.world().prompt("Set link",
{input:nb||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=yb.nextAddress&&(Jb=yb.yieldResult,!Jb))return yb.return();Na.undoManager.group();Na.setStyleInRange({link:Jb||void 0},da);Na.undoManager.group();yb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Na,fb){var Jb,da,Ia,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){if(1==yb.nextAddress)return Jb=Na.selection,da=Na.getStyleInRange(Jb),Ia=da.doit,yb.yield(Na.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:Na,input:Ia?Ia.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Na.evalEnvForDoit(Ia||{})}),2);nb=yb.yieldResult;Na.undoManager.group();nb?Na.addTextAttribute({doit:{code:nb},nativeCursor:"pointer",textDecoration:"underline"},Jb):Na.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Jb);Na.undoManager.group();yb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Na,fb){fb=void 0===fb?{}:fb;Na.undoManager.group();
fb=!fb.onlySelection&&Na.selection.isEmpty()?Na.documentRange:Na.selection.range;Na.setStyleInRange(null,fb);Na.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Na){var fb,Jb,da,Ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nb){if(1==nb.nextAddress)return nb.yield(System.import("lively.modules"),2);if(3!=nb.nextAddress)return fb=nb.yieldResult,Jb=fb.module,nb.yield(Jb("lively.ide/text/ui.js").load(),3);da=nb.yieldResult;Ia=da.RichTextControl;return nb.return(Ia.openFor(Na))})}}];
nh.commands=Ye;nh.commands=Ye;nh.commands=Ye;var Jf=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");Jf.guessTextModeName=wa;Jf.rangedToken=function(Na,fb,Jb,da,Ia){return{start:{row:Na,column:fb},end:{row:Na,column:Jb},token:da,mode:Ia}};Jf.fun=vb;Jf.arr=lc;Jf.connect=Pc;Jf.disconnect=Vb;Jf.DefaultTheme=mc;Jf.tokenizeDocument=ub;Jf.modeInfo=Db;Jf.visitDocumentTokens=ad;Jf.getMode=Ob;Jf.completionCommands=Tc;Jf.multiSelectCommands=Cf;Jf.navCommands=Se;Jf.codeCommands=yf;Jf.codeEvaluationCommands=
Ve;Jf.richTextCommands=Ye;Jf.Color=Bb;Jf.Range=Qe;Jf.guessTextModeName=wa;Jf.guessTextModeName=wa;mc=function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Jb=fb.hasOwnProperty("EditorPlugin")&&"function"===typeof fb.EditorPlugin?fb.EditorPlugin:fb.EditorPlugin=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Kb(Jb,Na,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
Jf.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(da){var Ia=this;this.textMorph=da;Jf.connect(da,"textChange",this,"onTextChange");Jf.connect(da,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Ia.highlight()})}},
{key:"detach",value:function(da){Jf.disconnect(da,"textChange",this,"onTextChange");Jf.disconnect(da,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(da){this._ast=null;if(da){var Ia=this._tokenizerValidBefore;if("replace"===da.selector){var nb=da.args[0].start;da=nb.row;nb=nb.column}else nb=da=0;if(!Ia||da<Ia.row||da===Ia.row&&nb<Ia.column)da=Math.max(0,da),this._tokenizerValidBefore={row:da,
column:nb}}this.requestHighlight()}},{key:"requestHighlight",value:function(da){var Ia=this;(void 0===da?0:da)?this.highlight():Jf.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return Ia.highlight()})()}},{key:"highlight",value:function(){var da=this.textMorph,Ia=this.theme,nb=this.mode,yb=this._tokenizerValidBefore;if(Ia&&da&&da.document&&nb){da.fill=Ia.background;da.cursorColor=Ia.cursorColor||Jf.Color.black;var Bc=da.viewState,xc={};yb=Jf.tokenizeDocument(nb,da.document,Bc.firstVisibleRow,
Bc.lastVisibleRow,yb);nb=yb.lines;yb=yb.tokens;if(nb.length){Bc=nb[0].row;for(var jd=[],ud=0;ud<yb.length;Bc++,ud++)for(var nd=yb[ud],pf=0;pf<nd.length;pf+=5){var kg=nd[pf],Wf=nd[pf+1],Fh=Ia[nd[pf+2]]||Ia.default;Fh&&jd.push({start:{row:Bc,column:kg},end:{row:Bc,column:Wf}},Fh)}da.embeddedMorphs.forEach(function(Df){var wh=da.embeddedMorphMap.get(Df).anchor;xc[Df.id]=da.textAttributeAt(wh.position)});da.setTextAttributesWithSortedRanges(jd);da.embeddedMorphs.forEach(function(Df){var wh=da.embeddedMorphMap.get(Df).anchor;
wh=Jf.Range.at(wh.position);wh.end.column+=1;da.replace(wh,[Df,xc[Df.id]],!1)});this._tokenizerValidBefore={row:Jf.arr.last(nb).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},da,this)}}},{key:"visitTokensInRange",value:function(da,Ia){var nb=da.start,yb=da.end,Bc=nb.row-1;Jf.visitDocumentTokens(this.mode,this.textMorph.document,nb.row,yb.row,null,function(xc){return Bc++},function(xc,jd,ud,nd,pf,kg,Wf){if(Bc===nb.row&&0<nb.column){if(nb.column>=nd)return;ud<nb.column&&nb.column<
nd&&(ud=nb.column)}if(Bc===yb.row){if(yb.column<=ud)return;ud<yb.column&&yb.column<nd&&(nd=yb.column)}Ia(xc,jd,Bc,ud,nd,pf,kg,Wf)})}},{key:"tokensInRange",value:function(da){var Ia=[];this.visitTokensInRange(da,function(nb,yb,Bc,xc,jd,ud,nd,pf){return Ia.push(Jf.rangedToken(Bc,xc,jd,nb,pf))});return Ia}},{key:"tokensOfRow",value:function(da){var Ia=this.textMorph.getLine(da).length;return this.tokensInRange({start:{row:da,column:0},end:{row:da,column:Ia}})}},{key:"tokenAt",value:function(da){for(var Ia=
this.tokensOfRow(da.row),nb=Ia.length;nb--;){var yb=Ia[nb];if(yb.token&&yb.start.column<=da.column&&da.column<=yb.end.column)return yb}return null}},{key:"getCommands",value:function(da){return[].concat($jscomp.arrayFromIterable(da),$jscomp.arrayFromIterable(Jf.completionCommands),$jscomp.arrayFromIterable(Jf.multiSelectCommands),$jscomp.arrayFromIterable(Jf.navCommands),$jscomp.arrayFromIterable(Jf.codeCommands),$jscomp.arrayFromIterable(Jf.codeEvaluationCommands),$jscomp.arrayFromIterable(Jf.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var da=this.mode,Ia=da.lineComment,nb=da.blockCommentStart;da=da.blockCommentEnd;var yb={};Ia&&(yb.lineCommentStart=Ia);nb&&(yb.blockCommentStart=nb);da&&(yb.blockCommentEnd=da);return yb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(da,Ia,nb){var yb=this.textMorph,Bc=da.row,xc=da.column;da=Ia[xc-1];Ia=Ia[xc];yb.selection.text="\n";yb.selection.collapseToEnd();
"{"===da&&"}"===Ia&&(yb.selection.text="\n"+" ".repeat(nb),yb.selection.collapse());yb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Bc+1,lastRow:Bc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var da=this.textMorph,Ia=this.openPairs,nb=da.selection,yb=da.getLine(nb.end.row),
Bc=yb[nb.end.column-1];yb=yb[nb.end.column];da.autoInsertPairs&&nb.isEmpty()&&Bc in Ia&&yb===Ia[Bc]&&(nb.growRight(1),nb.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(da){var Ia=this.openPairs,nb=this.closePairs,yb=this.textMorph,Bc=yb.selection,xc=yb.autoInsertPairs&&da in Ia,jd=yb.autoInsertPairs&&da in nb;if(!xc&&!jd)return!1;var ud=yb.getLine(Bc.end.row)[Bc.end.column];if(!Bc.isEmpty()){if(!xc)return!1;nb=yb.undoManager.ensureNewGroup(yb);yb.insertText(Ia[da],Bc.end);yb.insertText(da,
Bc.start);yb.undoManager.group(nb);Bc.growRight(-1);return!0}if(ud in nb&&da===ud)return Bc.goRight(1),!0;if(jd&&!xc)return!1;nb=yb.undoManager.ensureNewGroup(yb);yb.insertText(da+Ia[da]);yb.undoManager.group(nb);Bc.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],fb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);Db=mc=Jf.EditorPlugin;Tc=Ca("C",function(Na){var fb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Jb=fb.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof fb.CodeMirrorEnabledEditorPlugin?fb.CodeMirrorEnabledEditorPlugin:fb.CodeMirrorEnabledEditorPlugin=function(da){da&&da[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Kb(Jb,Na,[{key:Symbol.for("lively-instance-initialize"),value:function(){Kb._get(Object.getPrototypeOf(Jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(da){this.mode=this.codeMirrorMode(da);return Kb._get(Object.getPrototypeOf(Jb.prototype),"attach",this).call(this,da)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",
value:function(da){return{indentWithTabs:!da.useSoftTabs,indentUnit:da.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(da){da=this.defaultCodeMirrorModeConfig(da);return Jf.getMode(da,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],fb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(Jf.EditorPlugin));Jf.CodeMirrorEnabledEditorPlugin=Tc;Jf.CodeMirrorEnabledEditorPlugin=Tc;Jf.CodeMirrorEnabledEditorPlugin=Tc;Jf.default=mc;mc=Object.freeze({__proto__:null,guessTextModeName:wa,"default":Db,CodeMirrorEnabledEditorPlugin:Tc});Ca("e",mc)}}});
System.register(["./__root_module__-7cbd94df.js","kld-intersections","./index-6dd3a7ed.js","./index-2043039c.js"],function(){var Da,Ab,Rb,jc,cc,je,fd,Yd,jd,Pc,vd,Ld,ge,Td,md;return{setters:[function(Za){Da=Za.aw;Ab=Za.as;Rb=Za.ai;jc=Za.aD;cc=Za.aB;je=Za.an;fd=Za.Z;Yd=Za.bQ;jd=Za.$;Pc=Za.a5;vd=Za.s;Ld=Za.a6;ge=Za.C;Td=Za.a3;md=Za.L},function(){},function(){},function(){}],execute:function(){var Za=lively.FreezerRuntime.recorderFor("StaticText/index.js");Za.HTMLMorph=Da;var Db=function(ic){var gd=
lively.FreezerRuntime.recorderFor("StaticText/index.js"),fe=gd.hasOwnProperty("StaticText")&&"function"===typeof gd.StaticText?gd.StaticText:gd.StaticText=function(Yb){Yb&&Yb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(fe,ic,[{key:"refresh",value:function(){this.html='<span style="line-height: 1.3; font-size: '+this.fontSize+"px; color: "+this.fontColor+"; font-family: "+this.fontFamily+'">'+this.value+"</span>"}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"StaticText"}},{key:"properties",get:function(){return{html:{isStyleProp:!1},fontSize:{type:"Number",set:function(Yb){this.setProperty("fontSize",Yb);this.refresh()}},fontColor:{type:"Color",set:function(Yb){this.setProperty("fontColor",Yb);this.refresh()}},fontFamily:{type:"Enum",set:function(Yb){this.setProperty("fontFamily",Yb);this.refresh()}},value:{set:function(Yb){this.setProperty("value",Yb);this.refresh()}}}}}],gd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"StaticText",version:"0.1.1-10"}}},{start:74,end:953})}(Za.HTMLMorph);Db=Za.StaticText;Za.default=Db;var ac=lively.FreezerRuntime.recorderFor("WorldVersionViewer/index.js");ac.Morph=Rb;ac.World=jc;ac.HorizontalLayout=cc;ac.morph=je;ac.MorphicDB=fd;ac.graph=Yd;ac.promise=jd;ac.date=Pc;ac.string=vd;ac.arr=Ld;ac.Color=ge;ac.pt=Td;ac.LoadingIndicator=md;(function(ic){var gd=lively.FreezerRuntime.recorderFor("WorldVersionViewer/index.js"),
fe=gd.hasOwnProperty("WorldVersion")&&"function"===typeof gd.WorldVersion?gd.WorldVersion:gd.WorldVersion=function(Yb){Yb&&Yb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(fe,ic,[{key:"update",value:function(){var Yb=$jscomp.makeIterator(this.submorphs),qc=Yb.next().value;Yb=Yb.next().value;qc.imageUrl=this.commit.preview;Yb.textAndAttributes=this.info;Yb.fontColor=this.selected?ac.Color.white:ac.Color.darkGray}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"WorldVersion"}},{key:"properties",get:function(){return{commit:{},fill:{defaultValue:ac.Color.transparent},info:{derived:!0,get:function(){var Yb=this.commit,qc=Yb.message,Ob=Yb.name,Hc=Yb.timestamp;return[Yb._id.slice(0,6)+" ",{fontWeight:"bold"},ac.string.truncate(qc.split("\n")[0],40)+" ",{}," ("+Ob+" ",{},""+ac.date.format(new Date(Hc),"yyyy-mm-dd HH:MM Z"),{}]}},selected:{set:function(Yb){this.setProperty("selected",Yb);this.update()}},layout:{initialize:function(){this.layout=
new ac.HorizontalLayout({align:"center",spacing:5})}},submorphs:{initialize:function(){this.submorphs=[{type:"image",extent:ac.pt(30,30),name:"preview",reactsToPointer:!1},{reactsToPointer:!1,type:"label",fill:null,name:"commit info",fontFamily:"Nunito",fontColor:ac.Color.gray}]}}}}}],gd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldVersionViewer",
version:"0.1.1-33"}}},{start:274,end:1824})})(ac.Morph);Za=function(ic){var gd=lively.FreezerRuntime.recorderFor("WorldVersionViewer/index.js"),fe=gd.hasOwnProperty("WorldVersionViewer")&&"function"===typeof gd.WorldVersionViewer?gd.WorldVersionViewer:gd.WorldVersionViewer=function(Yb){Yb&&Yb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(fe,ic,[{key:"reset",value:function(){this.getSubmorphNamed("version list").items=[]}},
{key:"onMouseDown",value:function(Yb){switch(Yb.targetMorph.name){case "visit button":this.visitSelectedCommit();break;case "revert button":this.revertToSelectedCommit()}}},{key:"visitSelectedCommit",value:function(){var Yb=this,qc,Ob,Hc,Yc,cd,$b,pb,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lc){switch(Lc.nextAddress){case 1:return qc=Yb.get("version list").selection,Ob=ac.LoadingIndicator.open("Loading "+qc.name+"..."),Hc=$world,Yc=Yb.db||ac.MorphicDB.default,cd=qc._id,Lc.setCatchFinallyBlocks(2,
3),cd?Lc.yield(ac.World.loadFromCommit(cd,void 0,{morphicDB:Yc}),8):Lc.yield(ac.World.loadFromDB(qc.name,qc.ref,void 0,{morphicDB:Yc}),7);case 7:$b=Lc.yieldResult;Lc.jumpTo(6);break;case 8:$b=Lc.yieldResult;case 6:return pb=$b,Lc.return(pb);case 3:Lc.enterFinallyBlock();Ob.remove();Lc.leaveFinallyBlock(0);break;case 2:xc=Lc.enterCatchBlock(),console.error(xc),Hc.showError("Error loading world:"+xc),Lc.jumpTo(3)}})}},{key:"revertToSelectedCommit",value:function(){var Yb=this,qc,Ob,Hc,Yc,cd,$b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pb){if(1==
pb.nextAddress){qc=Yb.get("version list").selection;if(!qc)return pb.return();Ob=Yb.db||ac.MorphicDB.default;Hc=qc;Yc=Hc._id;cd=Hc.name;$b=Hc.type;return pb.yield(Ob.revert($b,cd,Yc,"HEAD"),2)}return pb.return(Yb.initializeFromStartCommit(qc,Ob,{showRevertButton:!0}))})}},{key:"initializeFromStartCommit",value:function(Yb,qc,Ob){qc=void 0===qc?ac.MorphicDB.default:qc;Ob=void 0===Ob?{}:Ob;var Hc=this,Yc,cd,$b,pb,xc,Lc,Ga,Ra,rb,Kb,Ib,gb,ib,Lb,tc,Qc,sc,Vc,Q,fa,Ia,Sa,ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Vb){switch(Vb.nextAddress){case 1:return Yc=
Ob,cd=void 0===Yc.showRefs?!0:Yc.showRefs,$b=Hc.startCommit=Yb,pb=$b._id,xc=$b.type,Lc=$b.name,Ga=Hc.getSubmorphNamed("version list spinner"),Ga.visible=!0,Ga.center=Hc.get("version list").center,Hc.db=qc,Vb.yield(qc.history(xc,Lc),2);case 2:Ra=Vb.yieldResult,rb=Ra.refs,Kb=Ra.history,Ib=pb,gb=ac.graph.invert(Kb),ib=ac.graph.hull(gb,pb),Lb={_id:!0},tc=[Yb],Qc=$jscomp.makeIterator(ib),sc=Qc.next();case 3:if(sc.done)return fa=ac.arr.max(tc,function(Ua){return Ua.timestamp}),Ib=fa._id,Vb.yield(qc.log(Ib,
void 0,!0),7);Vc=sc.value;return Vb.yield(qc.log(Vc,void 0,!0,Lb),6);case 6:Q=Vb.yieldResult;tc.push.apply(tc,$jscomp.arrayFromIterable(Q));Q.forEach(function(Ua){return Lb[Ua._id]=!0});sc=Qc.next();Vb.jumpTo(3);break;case 7:Ia=Vb.yieldResult;if(cd)for(Sa in rb);ec=Ia.map(function(Ua){var wc=new ac.WorldVersion({reactsToPointer:!1,commit:Ua});wc.update();return{isListItem:!0,morph:wc,value:Ua}});Hc.get("version list").items=ec;Ga.visible=!1;Vb.jumpToEnd()}})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"WorldVersionViewer"}}],gd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldVersionViewer",version:"0.1.1-33"}}},{start:1841,end:5600})}(ac.Morph);Za=ac.WorldVersionViewer;ac.default=Za}}});
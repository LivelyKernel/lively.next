System.register("./__root_module__-255c8c26.js kld-intersections ./user-ui-5be04eba.js ./editor-plugin-f4c5553b.js ./index-e74b4e71.js ./index-4d90b762.js ./index-095d446b.js".split(" "),function(Da,Ab){var Tb,kc,ec,he,gd,Zd,kd,Sc;return{setters:[function(yd){Tb=yd.ah;kc=yd.an;ec=yd.a2;he=yd.C;gd=yd.a5;Zd=yd.L;kd=yd.r;Sc=yd.ar},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var yd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");yd.Morph=
Tb;yd.Icon=kc;yd.pt=ec;yd.Color=he;yd.arr=gd;yd.LoadingIndicator=Zd;yd.resource=kd;var Od=function(fe){var Ud=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),md=Ud.hasOwnProperty("LivelyTopBar")&&"function"===typeof Ud.LivelyTopBar?Ud.LivelyTopBar:Ud.LivelyTopBar=function(db){db&&db[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sc(md,fe,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode=
"Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var db=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fb){if(1==Fb.nextAddress)return db.isComponent?Fb.return():Fb.yield(db.whenRendered(),2);document.body.style.background="black";db.setEditMode("Halo");db.getSubmorphNamed("fast load toggler").refresh();Fb.jumpToEnd()})}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=yd.pt(0,0));var db=
this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;db.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var db=this;return Object.entries(this.shapeToIcon).map(function(Fb){Fb=$jscomp.makeIterator(Fb);var tc=Fb.next().value,nc=Fb.next().value;Fb=nc.shortcut;nc=nc.args;return[[].concat($jscomp.arrayFromIterable(db.currentShapeMode===tc?[].concat($jscomp.arrayFromIterable(yd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),
$jscomp.arrayFromIterable(yd.Icon.textAttribute.apply(yd.Icon,$jscomp.arrayFromIterable(nc))),["   "+tc+" ",{float:"none"},"      "+Fb,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){db.currentShapeMode=tc;db.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var db=this;return Object.entries(this.sideBarToIcon).map(function(Fb){Fb=$jscomp.makeIterator(Fb);var tc=Fb.next().value;Fb=Fb.next().value.args;return[[].concat($jscomp.arrayFromIterable(db.activeSideBars.includes(tc)?
[].concat($jscomp.arrayFromIterable(yd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(yd.Icon.textAttribute.apply(yd.Icon,$jscomp.arrayFromIterable(Fb))),["   "+tc+" ",{float:"none"}]),function(){return db.openSideBar(tc)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",
value:function(db){"Hand"==this._currentEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(db){Sc._get(Object.getPrototypeOf(md.prototype),"onKeyDown",this).call(this,db);if(db.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!db.isAltDown()){var Fb={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(db.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=
Fb[db.key];this.setEditMode("Shape");break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(db){var Fb=this,tc,nc,td,ke,zc,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pb){switch(Pb.nextAddress){case 1:Fb.activeSideBars.includes(db)?yd.arr.remove(Fb.activeSideBars,db):Fb.activeSideBars.push(db);if("Scene Graph"!=db){Pb.jumpTo(2);break}if(Fb.sideBar){Pb.jumpTo(3);break}tc=yd.LoadingIndicator.open("loading side bar");nc=Fb;return Pb.yield(Ab.import("./scene graph side bar master-b83941e2.js"),
5);case 5:if(!(td=Pb.yieldResult)){Pb.jumpTo(6);break}return Pb.yield(yd.resource("part://SystemIDE/scene graph side bar master"),7);case 7:td=Pb.yieldResult;case 6:return Pb.yield(td.read(),4);case 4:return nc.sideBar=Pb.yieldResult,Fb.sideBar.hasFixedPosition=!0,Fb.sideBar.openInWorld(),Fb.sideBar.right=0,Pb.yield(Fb.sideBar.whenRendered(),8);case 8:tc.remove();case 3:Fb.sideBar.toggle(Fb.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=db){Pb.jumpTo(0);break}if(Fb.stylingPalette){Pb.jumpTo(10);
break}ke=yd.LoadingIndicator.open("loading side bar");zc=Fb;return Pb.yield(Ab.import("./styling side bar master-dd371667.js"),12);case 12:if(!(Ec=Pb.yieldResult)){Pb.jumpTo(13);break}return Pb.yield(yd.resource("part://SystemIDE/styling side bar master"),14);case 14:Ec=Pb.yieldResult;case 13:return Pb.yield(Ec.read(),11);case 11:return zc.stylingPalette=Pb.yieldResult,Fb.stylingPalette.hasFixedPosition=!0,Fb.stylingPalette.openInWorld(),Fb.stylingPalette.left=Fb.world().right,Pb.yield(Fb.stylingPalette.whenRendered(),
15);case 15:ke.remove();case 10:Fb.stylingPalette.toggle(Fb.activeSideBars.includes("Styling Palette")),Pb.jumpToEnd()}})}},{key:"onMouseDown",value:function(db){var Fb=this.get("select shape type"),tc=this.get("shape mode button"),nc=this.get("side bar selector");db.targetMorph==Fb&&(this.world().openWorldMenu(db,this.getShapeMenuItems()).position=tc.globalBounds().bottomLeft().subPt(this.world().scroll));db.targetMorph==tc&&this.setEditMode("Shape");"text mode button"==db.targetMorph.name&&this.setEditMode("Text");
"hand mode button"==db.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==db.targetMorph.name&&this.setEditMode("Halo");"open component browser"==db.targetMorph.name&&this.interactivelyLoadComponent();db.targetMorph==nc&&(this.world().openWorldMenu(db,this.getSideBarMenuItems()).position=nc.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var db=this,Fb,tc,nc,td,ke;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zc){if(1==
zc.nextAddress)return Fb=db.get("open component browser"),tc=db.get("user flap"),nc=tc.haloShadow,td=tc.haloColor,ke=yd.Color.rgb(102,102,102),Fb.fontColor=td,Fb.dropShadow=nc,zc.yield(db.world().execCommand("browse and load component"),2);Fb.dropShadow=!1;Fb.fontColor=ke;zc.jumpToEnd()})}},{key:"setEditMode",value:function(db,Fb){var tc=this;Fb=void 0===Fb?!1:Fb;var nc=this.get("user flap"),td=nc.haloShadow,ke=nc.haloColor,zc=yd.Color.rgb(102,102,102);Fb||(this._currentEditMode=db);Fb=this.get("shape mode button");
nc=this.get("text mode button");var Ec=this.get("hand mode button"),Pb=this.get("halo mode button");[["Shape",Fb.submorphs],["Text",[nc]],["Hand",[Ec]],["Halo",[Pb]]].forEach(function(Qb){var Tc=$jscomp.makeIterator(Qb);Qb=Tc.next().value;Tc=Tc.next().value;"Shape"==db?tc.world().toggleShapeMode(!0,tc.currentShapeMode):"Text"==db?tc.world().toggleShapeMode(!0,"Text"):tc.world().toggleShapeMode(!1);tc.world().showHaloPreviews("Halo"==db);Qb==db?Tc.forEach(function(ld){ld.dropShadow=td;ld.fontColor=
ke}):Tc.forEach(function(ld){ld.dropShadow=null;ld.fontColor=zc})})}}],[{key:"className",get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],set:function(db){this.setProperty("currentShapeMode",db);this.get("shape status icon").textAndAttributes=yd.Icon.textAttribute(this.shapeToIcon[db].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",
{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",
{paddingTop:"1px"}]},HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],Ud,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-151"}}},{start:328,end:9061})}(yd.Morph);Od=yd.LivelyTopBar;yd.default=Od}}});
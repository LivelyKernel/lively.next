System.register(["./__root_module__-89b08ab2.js","./index-1502344e.js","./index-b806b9af.js"],function(ta){var nb,xb,Ob,Hb,qd,Dc,hd,Hc,Fc,Sc,ad,Jd,ed,sc,Sa,ob,$b,Sb,Bc,id,Xb,Ub,ub,hc,wc,bd,cd,bb,pb,pc,ab,cb,Pa,Za,eb,Na,Da,mb,Zb,dc,Mb,Yb,I,W,sa;return{setters:[function(xa){nb=xa.C;xb=xa.at;Ob=xa.a6;Hb=xa.a1;qd=xa.a3;Dc=xa.ao;hd=xa.bh;Hc=xa.aV;Fc=xa.ar;Sc=xa.s;ad=xa.aQ;Jd=xa.bo;ed=xa.bp;sc=xa.a7;Sa=xa.av;ob=xa.aq;$b=xa.as;Sb=xa.bq;Bc=xa.br;id=xa.a2;Xb=xa.P;Ub=xa.$;ub=xa.aX;hc=xa.aj;wc=xa.ak;bd=
xa.al;cd=xa.am;bb=xa.aC;pb=xa.a_;pc=xa.ay;ab=xa.ap;cb=xa.aa;Pa=xa.bs;Za=xa.L;eb=xa.bt;Na=xa.b3;Da=xa.bi;mb=xa.b2;Zb=xa.bu;dc=xa.au},function(xa){Mb=xa.M;Yb=xa.I;I=xa.v;W=xa.p},function(xa){sa=xa.localInterface}],execute:function(){function xa(va,La){if(!0===La)return La;if(va.copyState)return va.copyState(La);va={};for(var ib in La){var S=La[ib];S instanceof Array&&(S=S.concat([]));va[ib]=S}return va}function Eb(va,La,ib){return va.startState?va.startState(La,ib):!0}function Pb(va,La){return G.modes[va]=
La}function Ha(va){if("string"==typeof va&&G.mimeModes.hasOwnProperty(va))va=G.mimeModes[va];else if(va&&"string"==typeof va.name&&G.mimeModes.hasOwnProperty(va.name)){var La=G.mimeModes[va.name];"string"==typeof La&&(La={name:La});va=Object.assign({},La,va);va.name=La.name}else{if("string"==typeof va&&/^[\w\-]+\/[\w\-]+\+xml$/.test(va))return Ha("application/xml");if("string"==typeof va&&/^[\w\-]+\/[\w\-]+\+json$/.test(va))return Ha("application/json")}return"string"==typeof va?{name:va}:va||{name:"null"}}
function Lb(va,La){La=G.resolveMode(La);"string"===typeof La&&(La={name:La});if(!La.name)throw Error("parserConfig does not have a name of the mode to get");var ib=G.modes[La.name];if(!ib)return Lb(va,"text/plain");va=Object.assign({indentUnit:2},va);return Object.assign(ib(va,La),{name:La.name})}function xd(va,La){for(var ib;va.innerMode;){ib=va.innerMode(La);if(!ib||ib.mode==va)break;La=ib.state;va=ib.mode}return ib||{mode:va,state:La}}function vd(va,La){G.mimeModes[va]=La}function Gc(va,La,ib){}
function Ma(va,La,ib,S,ua,Ya,gb){var ic=va.editorPlugin._tokenizerValidBefore;ic&&ic.row>=ib&&(ic.row=ib-1);var kc=G.linesToTokenize(va.document,ib,S,ic);ic=kc.lines;kc=kc.state;if(!ic.length)return!1;kc=kc?G.copyState(La,kc):G.startState(La);for(var Oc=0;Oc<ic.length;Oc++){var Pc=ic[Oc],Rc=Pc.row;Rc>=ib&&Rc<=S&&G.indentLine(va,La,Pc,kc,ua,Ya,gb);kc=G.tokenizeLine(La,ic[Oc],kc,function(){})}return!0}function tc(va,La,ib,S,ua,Ya,gb){La=G.linesToTokenize(La,ib,S,ua);ib=La.lines;G.tokenizeLines(va,ib,
La.state,Ya,gb);return ib}function $a(va,La,ib,S,ua){var Ya=[],gb,ic=function(Pc){return Ya.push(gb=[])},kc=function(Pc,Rc,Ie,zf,ef,Ee,dh){return gb.push(Ie,zf,Pc,ef.current(),Rc.localMode||dh)};try{var Oc=G.visitDocumentTokens(va,La,ib,S,ua,ic,kc)}catch(Pc){Ya.length=0,Oc=G.visitDocumentTokens(va,La,ib,S,null,ic,kc)}return{tokens:Ya,lines:Oc}}function Cc(va,La,ib,S,ua){null==La&&(La=va.search(/[^\s\u00a0]/),-1==La&&(La=va.length));S=S||0;for(ua=ua||0;;){var Ya=va.indexOf("\t",S);if(0>Ya||Ya>=La)return ua+
(La-S);ua+=Ya-S;ua+=ib-ua%ib;S=Ya+1}}function Mc(va){va=va.toLowerCase();for(var La=0;La<G.modeInfo.length;La++){var ib=G.modeInfo[La];if(ib.mime==va)return ib;if(ib.mimes)for(var S=0;S<ib.mimes.length;S++)if(ib.mimes[S]==va)return ib}if(/\+xml$/.test(va))return Mc("application/xml");if(/\+json$/.test(va))return Mc("application/json")}function Ua(va){for(var La=0;La<G.modeInfo.length;La++){var ib=G.modeInfo[La];if(ib.ext)for(var S=0;S<ib.ext.length;S++)if(ib.ext[S]==va)return ib}}function Fa(va){for(var La=
0;La<G.modeInfo.length;La++){var ib=G.modeInfo[La];if(ib.file&&ib.file.test(va))return ib}La=va.lastIndexOf(".");if(va=-1<La&&va.substring(La+1,va.length))return G.findModeByExtension(va)}function Wb(va){va=va.toLowerCase();for(var La=0;La<G.modeInfo.length;La++){var ib=G.modeInfo[La];if(ib.name.toLowerCase()==va)return ib;if(ib.alias)for(var S=0;S<ib.alias.length;S++)if(ib.alias[S].toLowerCase()==va)return ib}}function Bd(va){if(!va)return String(va);if(Array.isArray(va))return"["+va.map(Bd).join(",")+
"]";if("symbol"===typeof va)return Uc.printSymbol(va);try{return String(va)}catch(La){return"Cannot print object: "+La}}function pd(va,La){return!Uc.arr.every(La.map(function(ib){return va[ib]}),function(ib){return Uc.obj.equals(ib,va&&va.valueOf())})}function Vd(va){if(Uc.obj.isPrimitive(va))var La=Uc.string.print(va);else Array.isArray(va)?((La=3<va.length)&&(va=va.slice(0,3)),va=Uc.string.print(va),La&&(va=va.slice(0,-1)+", ...]"),La=va):La=Uc.string.print(va);La=La.replace(/\n/g,"");500<La.length&&
(La=La.slice(0,20)+("...["+(La.length-20)+' CHARS]"'));return La}function qc(va){return mc.Inspector.openInWindow({targetObject:va})}function Ld(va,La){return mc.Inspector.openInWindow({remoteTarget:{code:va,evalEnvironment:La}})}function Lc(va,La){function ib(ic){var kc=ic.name,Oc=ic.ownerChain(),Pc=ic.owner,Rc=ic.world(),Ie;ic===Ya&&(Ie=[gb]);Rc===ic&&(Ie=["$world"]);if(!Ie&&kc&&Pc){Pc===Rc&&1===mc.arr.count(mc.arr.pluck(Rc.submorphs,"name"),kc)&&(Ie=['$world.get("'+kc+'")']);if(!Ie&&Pc!=Rc)for(Rc=
Oc.length-1;Rc--;)if(1===Oc[Rc].getAllNamed(kc).length){Ie=[].concat($jscomp.arrayFromIterable(ib(Oc[Rc])),['get("'+kc+'")']);break}Ie||(kc=[].concat($jscomp.arrayFromIterable(ib(Pc)),['get("'+kc+'")']),mc.syncEval(kc.join("."),{context:Ya}).value===ic&&(Ie=kc))}Ie||(Ie=[gb+'.getMorphById("'+ic.id+'")']);return Ie}La=void 0===La?{}:La;var S=va.world(),ua=La;La=void 0===ua.maxLength?10:ua.maxLength;var Ya=void 0===ua.fromMorph?S:ua.fromMorph;if(Ya===va)return"this";var gb=S===Ya?"$world":"this";if(!(S||
va.name&&Ya.get(va.name)===va))return"morph";S=ib(va);return S.length>La?'$world.getMorphWithId("'+va.id+'")':S.join(".")}function kb(va,La,ib){var S=(La=void 0===La?"":La)&&pe.arr.last(La.split(".")).toLowerCase(),ua="",Ya=0,gb=Math.pow(2,19);if("string"===typeof va){if(va.length>gb)return null}else if(va.document.stringSize>gb)return null;if("string"===typeof va)ua=va.slice(0,1E3);else for(va=$jscomp.makeIterator(va.document.lines),gb=va.next();!gb.done;gb=va.next()){var ic=gb.value;gb=ic.stringSize;
ic=ic.text;var kc=!0;1E3<Ya+gb&&(kc=!1,gb=1E3-Ya);ua+=ic.slice(0,gb)+(kc?"\n":"");Ya+=gb;if(1E3<=Ya)break}Ya=$jscomp.makeIterator(pe.modeInfo);for(va=Ya.next();!va.done;va=Ya.next()){kc=va.value;gb=kc.contentTest;va=kc.mode;ic=kc.ext;kc=kc.file;if("function"===typeof gb)try{if(gb(ua))return va}catch(Oc){}if(kc&&kc instanceof RegExp&&kc.test(La))return va;if(ic)for(gb=$jscomp.makeIterator(ic),ic=gb.next();!ic.done;ic=gb.next())if(ic.value===S)return va}return ib}ta({a:vd,d:Pb,r:Gc});var ja=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");
ja.Color=nb;var oa=function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),ib=La.hasOwnProperty("DefaultTheme")&&"function"===typeof La.DefaultTheme?La.DefaultTheme:La.DefaultTheme=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:"background",get:function(){return ja.Color.white}},{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",
fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},
{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},
{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},
{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},
{key:"diff-file-header",get:function(){return{fontColor:ja.Color.white,fontWeight:"bold",backgroundColor:ja.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:ja.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:ja.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],La,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),tb=oa=ja.DefaultTheme;ja.default=oa;var G=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");
G.copyState=xa;G.startState=Eb;G.defineMode=Pb;G.resolveMode=Ha;G.getMode=Lb;G.innerMode=xd;G.defineMIME=vd;G.registerHelper=Gc;G.indentLines=Ma;G.indentLine=function(va,La,ib,S,ua,Ya,gb){gb=Object.assign({indentWithTabs:!va.useSoftTabs,indentUnit:va.tabWidth,tabSize:4,ignoreFollowingText:!1},gb);null==ua&&(ua="add");"smart"==ua&&(La.indent||(ua="prev"));var ic=gb.tabSize,kc=ib.text,Oc=G.countColumn(kc,null,ic);ib.modeState&&(ib.modeState=null);var Pc=kc.match(/^\s*/)[0];if(!Ya&&!/\S/.test(kc)){var Rc=
0;ua="not"}else if("smart"==ua&&(Rc=La.indent(S,gb.ignoreFollowingText?"":kc.slice(Pc.length),kc),Rc==G.passIndent||150<Rc)){if(!Ya)return;ua="prev"}"prev"==ua?Rc=0<ib.row?G.countColumn(ib.prevLine().text,null,ic):0:"add"==ua?Rc=Oc+gb.indentUnit:"subtract"==ua?Rc=Oc-gb.indentUnit:"number"==typeof ua&&(Rc=Oc+ua);Rc=Math.max(0,Rc);La="";S=0;if(gb.indentWithTabs)for(gb=Math.floor(Rc/ic);gb;--gb)S+=ic,La+="\t";S<Rc&&(La+=" ".repeat(Rc-S));if(La!=Pc)return va.replace({start:{row:ib.row,column:0},end:{row:ib.row,
column:Pc.length}},La),!0};G.tokenizeLines=function(va,La,ib,S,ua){if(La.length){ib=ib?G.copyState(va,ib):G.startState(va);for(var Ya=0;Ya<La.length;Ya++){var gb=La[Ya];S(gb);ib=G.tokenizeLine(va,gb,ib,ua)}}};G.tokenizeLine=function(va,La,ib,S){var ua=La.text;if(!ua)return ib;var Ya=new G.StringStream(ua,2);ib=La.modeState="function"===typeof va.copyState?va.copyState(ib):G.copyState(va,ib);La.prevLine();for(ib._string=ua;!Ya.eol();)ua=va.token(Ya,ib),S(ua,ib,Ya.start,Ya.pos,Ya,La,va),Ya.start=Ya.pos;
return ib};G.printTokens=function(va){for(var La="",ib=0;ib<va.length;ib+=5)La+=va[ib+0]+" => "+va[ib+1]+" "+va[ib+2]+" "+va[ib+3]+" "+va[ib+4].name+"\n";return La};G.visitDocumentTokens=tc;G.tokenizeDocument=$a;G.linesToTokenize=function(va,La,ib,S){if(S&&S.row>=ib)return{lines:[],state:null};La=S?Math.max(0,S.row-1):La;var ua=va.getLine(La),Ya=ua.text;va=[ua];S=null;for(var gb=0,ic;(ic=ua.prevLine())&&50>gb++;){ua=ic;if(ua.modeState){S=ua.modeState;break}va.unshift(ua)}if(!S){for(var kc=ua,Oc=Infinity;(ic=
ua.prevLine())&&100>gb++;){ua=ic;if(ua.modeState){S=ua.modeState;break}va.unshift(ua);ic=Ya.match(/^\s*/)[0].length;if(0===ic)break;ic<Oc&&(Oc=ic,kc=ua)}!S&&0<Oc&&(va=va.slice(va.indexOf(kc)))}if(ib>La)for(ua=G.arr.last(va);La<=ib;La++){ua=ua.nextLine();if(!ua)break;va.push(ua)}return{lines:va,state:S}};G.countColumn=Cc;G.findModeByMIME=Mc;G.findModeByExtension=Ua;G.findModeByFileName=Fa;G.findModeByName=Wb;G.arr=Ob;oa=G.modes||{};G.modes=oa;G.modes=oa;G.modes=oa;oa=ta("p",{});G.passIndent=oa;G.passIndent=
oa;G.passIndent=oa;G.copyState=xa;G.copyState=xa;G.startState=Eb;G.startState=Eb;G.defineMode=Pb;G.defineMode=Pb;G.resolveMode=Ha;G.resolveMode=Ha;G.getMode=Lb;G.getMode=Lb;G.innerMode=xd;G.innerMode=xd;oa={};G.mimeModes=oa;G.mimeModes=oa;G.mimeModes=oa;G.defineMIME=vd;G.defineMIME=vd;G.registerHelper=Gc;G.registerHelper=Gc;G.indentLines=Ma;G.indentLines=Ma;G.visitDocumentTokens=tc;G.visitDocumentTokens=tc;G.tokenizeDocument=$a;G.tokenizeDocument=$a;G.countColumn=Cc;G.countColumn=Cc;(function(va){var La=
lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),ib=La.hasOwnProperty("StringStream")&&"function"===typeof La.StringStream?La.StringStream:La.StringStream=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:Symbol.for("lively-instance-initialize"),value:function(S,ua){this.reset(S,ua)}},{key:"reset",value:function(S,ua){this.pos=this.start=0;this.string=void 0===S?"":S;this.tabSize=void 0===
ua?2:ua;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(S){var ua=this.string.charAt(this.pos);if("string"==typeof S?ua==S:ua&&(S.test?S.test(ua):S(ua)))return++this.pos,
ua}},{key:"eatWhile",value:function(S){for(var ua=this.pos;this.eat(S););return this.pos>ua}},{key:"eatSpace",value:function(){for(var S=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>S}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(S){S=this.string.indexOf(S,this.pos);if(-1<S)return this.pos=S,!0}},{key:"backUp",value:function(S){this.pos-=S}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=
G.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?G.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return G.countColumn(this.string,null,this.tabSize)-(this.lineStart?G.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(S,ua,Ya){if("string"==typeof S){var gb=function(kc){return Ya?kc.toLowerCase():kc},
ic=this.string.substr(this.pos,S.length);if(gb(ic)==gb(S))return!1!==ua&&(this.pos+=S.length),!0}else{if((S=this.string.slice(this.pos).match(S))&&0<S.index)return null;S&&!1!==ua&&(this.pos+=S[0].length);return S}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(S,ua){this.lineStart+=S;try{return ua()}finally{this.lineStart-=S}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],La,{pathInPackage:function(){return"editor-modes.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);oa=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",
mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj",
"cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",
mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff",
"patch"],contentTest:function(va){return va.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},
{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth",
"fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy",
"gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",
ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],
mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",
mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",
mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",
mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},
{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",
mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",
mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash",
"sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(va){return va.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},
{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",
mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",
mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",
mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml",
"text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",
mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];G.modeInfo=oa;G.modeInfo=oa;G.modeInfo=oa;for(var ma=0;ma<G.modeInfo.length;ma++)G.info=G.modeInfo[ma],G.info.mimes&&(G.info.mime=G.info.mimes[0]);G.defineMode("null",function(){return{token:function(va){return va.skipToEnd()}}});G.defineMIME("text/plain","null");G.findModeByMIME=Mc;G.findModeByMIME=Mc;G.findModeByExtension=Ua;G.findModeByExtension=Ua;G.findModeByFileName=Fa;G.findModeByFileName=Fa;G.findModeByName=Wb;G.findModeByName=Wb;var Ga=
lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Ga.Color=nb;Ga.Rectangle=Hb;Ga.pt=qd;Ga.morph=Dc;Ga.ShadowObject=hd;Ga.StyleSheet=Hc;Ga.connect=Fc;Ga.arr=Ob;Ga.string=Sc;Ga.FilterableList=ad;Ga.Range=Jd;ma=function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ib=La.hasOwnProperty("Completer")&&"function"===typeof La.Completer?La.Completer:La.Completer=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return xb(ib,va,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],La,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);Ga.Completer=ma;Ga.Completer=ma;Ga.Completer=ma;ma=function(va){var La=
lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ib=La.hasOwnProperty("WordCompleter")&&"function"===typeof La.WordCompleter?La.WordCompleter:La.WordCompleter=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:"compute",value:function(S,ua){var Ya=[],gb=[],ic=S.document.lineStrings;S=S.cursorPosition.row;for(var kc=S-1;0<=kc;kc--)for(var Oc=$jscomp.makeIterator(ic[kc].split(/[^0-9a-z@_]+/i)),
Pc=Oc.next();!Pc.done;Pc=Oc.next())(Pc=Pc.value)&&!Ya.includes(Pc)&&Pc!==ua&&(Ya.push(Pc),gb.push({priority:1E3-(S-kc),completion:Pc}));for(kc=S+1;kc<ic.length;kc++)for(Oc=$jscomp.makeIterator(ic[kc].split(/[^0-9a-z_@]+/i)),Pc=Oc.next();!Pc.done;Pc=Oc.next())(Pc=Pc.value)&&!Ya.includes(Pc)&&Pc!==ua&&(Ya.push(Pc),gb.push({priority:1E3-(kc-S),completion:Pc}));return gb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],La,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);Ga.WordCompleter=ma;Ga.WordCompleter=ma;Ga.WordCompleter=ma;ma=[new Ga.WordCompleter];Ga.defaultCompleters=ma;Ga.defaultCompleters=ma;Ga.defaultCompleters=ma;ma=function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ib=La.hasOwnProperty("CompletionController")&&
"function"===typeof La.CompletionController?La.CompletionController:La.CompletionController=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:Symbol.for("lively-instance-initialize"),value:function(S,ua){ua=void 0===ua?[]:ua;this.textMorph=S;this.completers=ua=S.pluginCollect("getCompleters",ua)}},{key:"computeCompletions",value:function(S){var ua=this,Ya,gb,ic,kc,Oc,Pc,Rc,Ie,zf,ef,Ee,dh,Cg,ci,Og,Mi;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hf){switch(Hf.nextAddress){case 1:Ya=[],gb=$jscomp.makeIterator(ua.completers),ic=gb.next();case 2:if(ic.done){Hf.jumpTo(4);break}kc=ic.value;Hf.setCatchFinallyBlocks(5);Oc=Ya;Pc=Oc.concat;return Hf.yield(kc.compute(ua.textMorph,S),7);case 7:Ya=Pc.call(Oc,Hf.yieldResult);Hf.leaveTryBlock(3);break;case 5:Rc=Hf.enterCatchBlock(),console.warn("Error in completer "+kc+": "+(Rc.stack||Rc));case 3:ic=gb.next();Hf.jumpTo(2);break;case 4:Ie=new Map;
Ya.forEach(function(Bi){var sh=Ie.get(Bi.completion);sh||(sh=[],Ie.set(Bi.completion,sh));sh.push(Bi)});zf=[];ef=$jscomp.makeIterator(Ie.values());for(Ee=ef.next();!Ee.done;Ee=ef.next())dh=Ee.value,zf.push(Ga.arr.last(Ga.arr.sortByKey(dh,"priority")));Cg=0;ci=Ga.arr.sortByKey(zf,"priority").reverse();Og=ci.length&&ci[0].priority||0;Mi=ci.map(function(Bi){Bi.highestPriority=Og;var sh=Bi.completion.replace(/\n/g,""),yi=String((Bi.info||"").replace(/\n/g,""));Cg=Math.max(Cg,sh.length+yi.length);return{isListItem:!0,
string:sh,annotation:yi,value:Bi}});return Hf.return({items:Mi,maxCol:Cg})}})}},{key:"computeSortedCompletions",value:function(S,ua){ua=void 0===ua?!1:ua;var Ya=this,gb,ic,kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oc){if(1==Oc.nextAddress)return gb={tokens:[S],lowercasedTokens:[S],input:S},Oc.yield(Ya.computeCompletions(S),2);ic=Oc.yieldResult;kc=Ga.arr.sortBy(ic.items.filter(function(Pc){return Ya.filterFunction(gb,Pc,ua)}),function(Pc){return Ya.sortFunction(gb,Pc)});return Oc.return(kc)})}},
{key:"_printCompletions",value:function(S){var ua=this,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return gb.yield(ua.computeSortedCompletions(S),2);Ya=gb.yieldResult.map(function(ic){return{completion:ic.value.completion,priority:ic.value.priority,maxP:ic.value.highestPriority,sortVal:ic._cache[S].sortVal,lev:JSON.stringify(ic._cache[S].levenshtein)}});return gb.return(Ga.string.printTable(lively.lang.grid.tableFromObjects(Ya)))})}},{key:"prefix",value:function(){var S=
this.textMorph,ua=S.selection;return(ua.isEmpty()?S.getLine(ua.lead.row).slice(0,ua.lead.column):ua.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(S,ua,Ya){Ya=void 0===Ya?!1:Ya;ua._cache||(ua._cache={});var gb=S.tokens,ic=S.lowercasedTokens,kc=S.input;kc=ua._cache[kc]||(ua._cache[kc]={});if(kc.hasOwnProperty("filtered"))return kc.filtered;ua=ua.value.completion.replace(/\([^\)]*\)$/,"");var Oc=ua.toLowerCase();if(Ya&&gb[0]&&!ua.startsWith(gb[0]))return kc.filtered=!1;if(ic.every(function(Rc){return Oc.includes(Rc)}))return!0;
var Pc=kc.levenshtein||(kc.levenshtein={});S=Ya||3>=Ga.arr.sum(S.lowercasedTokens.map(function(Rc){return Pc[Rc]||(Pc[Rc]=Ga.string.levenshtein(Oc,Rc))}));return kc.filtered=S}},{key:"sortFunction",value:function(S,ua){ua._cache||(ua._cache={});var Ya=ua._cache[S.input]||(ua._cache[S.input]={});if(Ya.hasOwnProperty("sortVal"))return Ya.sortVal;Ya=ua._cache[S.input]={};var gb=ua.value;ua=gb.highestPriority;var ic=gb.completion;gb=gb.priority;ic=ic.replace(/\([^\)]*\)$/,"").toLowerCase();var kc=0;S.lowercasedTokens.forEach(function(Pc){ic.startsWith(Pc)?
kc+=12:3<=Pc.length&&ic.includes(Pc)&&(kc+=5)});ua=-((gb||(kc?ua:0))/Math.pow(10,String(ua).length-2))-kc;var Oc=Ya.levenshtein||(Ya.levenshtein={});S=Ga.arr.sum(S.lowercasedTokens.map(function(Pc){return Oc[Pc]||(Oc[Pc]=Ga.string.levenshtein(ic,Pc))}));kc&&(S/=2);return Ya.sortVal=S+ua}},{key:"positionForMenu",value:function(){var S=this.textMorph,ua=S.charBoundsFromTextPosition(S.cursorPosition);return S.getGlobalTransform().transformRectToRect(ua).topLeft().addXY(-S.scroll.x,-S.scroll.y).addPt(Ga.pt(S.borderWidth+
4,S.borderWidth+4))}},{key:"completionListSpec",value:function(){var S=this,ua,Ya,gb,ic,kc,Oc,Pc,Rc,Ie,zf,ef,Ee,dh,Cg,ci,Og,Mi,Hf,Bi,sh;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yi){if(1==yi.nextAddress)return Ya=ua=S.textMorph,gb=Ya.fontSize,ic=Ya.fontFamily,kc=S.positionForMenu(),Oc=S.prefix(),yi.yield(S.computeCompletions(Oc),2);Pc=yi.yieldResult;Rc=Pc.items;Ie=Pc.maxCol;zf=ua.env.fontMetric.sizeFor(ic,gb,"M");ef=zf.width*Ie;Ee=ua.document.getLine(0).height;dh=Math.max(120,ef<
ua.width?ef:ua.width);Cg=Ee*Rc.length+Ee+10;ci=Math.max(70,Math.min(700,Cg));Og=kc.extent(Ga.pt(dh,ci));if(Mi=ua.world())Hf=Mi.visibleBounds().insetBy(5),Og.bottom()>Hf.bottom()&&(Bi=Og.bottom()-Hf.bottom(),Bi>Og.height-50&&(Bi=Og.height-50),Og.height-=Bi),Og.right()>Hf.right()&&(sh=Og.right()-Hf.right(),Og.width=120>Og.width-sh?120:Og.width-sh),Hf.containsRect(Og)||(Og=Og.withTopLeft(Hf.translateForInclusion(Og).topLeft())),Og=Og.translatedBy(Hf.insetBy(0).topLeft().negated());return yi.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:gb,position:Og.topLeft(),extent:Og.extent(),items:Rc,input:Oc,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:S.filterFunction,sortFunction:S.sortFunction})})}},{key:"removeMenuOnBlur",value:function(S){var ua=S.menu;setTimeout(function(){ua.withAllSubmorphsDetect(function(Ya){return Ya.isFocused()})?ua.inputMorph.focus():ua.remove()})}},{key:"openCompletionList",value:function(){var S=this,ua,Ya,gb,ic,kc,Oc,Pc,Rc,Ie,zf;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(ef){if(1==ef.nextAddress)return ua=S.textMorph.selection.start,ef.yield(S.completionListSpec(),2);if(3!=ef.nextAddress)return Ya=ef.yieldResult,S.textMorph.pluginFind(function(Ee){return Ee.theme}),gb=new Ga.FilterableList(Ya),ic=new Ga.Range({start:ua,end:S.textMorph.selection.start}),kc=S.textMorph.textInRange(ic),Oc=gb.inputMorph,Pc=gb.listMorph,Rc=Ya.input,Ie=gb.addMorph({name:"prefix mask",fill:Ga.Color.transparent,bounds:Oc.textBounds()},
Oc),Pc.master=null,ic.isEmpty()||(S.textMorph.deleteText(ic),Oc.input=kc,Oc.gotoDocumentEnd()),Oc.fontColor=S.textMorph.fontColor,Ga.connect(Oc,"textString",Ie,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Oc}}),Ga.connect(gb,"accepted",S,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Rc}}),Ga.connect(gb,"accepted",gb,"remove"),Ga.connect(gb,"canceled",gb,"remove"),Ga.connect(gb,"remove",S.textMorph,"focus"),Ga.connect(gb.inputMorph,"onBlur",S,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:gb}}),zf=S.textMorph.world(),Pc.addStyleClass("hiddenScrollbar"),gb.paddingMorph.height=2,Oc.height=Pc.itemHeight,Oc.clipMode="visible",Oc.fill=S.textMorph.fill,Oc.fixedHeight=!0,Oc.fixedWidth=!1,Oc.fontSize=Pc.fontSize,gb.relayout(),gb.selectedIndex=
0,gb.master.applyIfNeeded(!0),Oc.focus(),ef.yield(gb.master.whenApplied(),3);Rc.length&&(Oc.gotoDocumentEnd(),gb.moveBy(Ga.pt(-Oc.textBounds().width,0)));zf.addMorph(gb);gb.inputPadding=Ga.Rectangle.inset(0,0,0,0);return ef.return(gb)})}},{key:"autoInsertBestMatchingCompletion",value:function(S,ua,Ya){ua=void 0===ua?!0:ua;var gb=this,ic,kc,Oc,Pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rc){if(1==Rc.nextAddress)return ic=$jscomp,kc=ic.makeIterator,Rc.yield(gb.computeSortedCompletions(S,
ua),2);Oc=kc.call(ic,Rc.yieldResult);(Pc=Oc.next().value)&&gb.insertCompletion(Pc.value.completion,S,Ya);Rc.jumpToEnd()})}},{key:"insertCompletion",value:function(S,ua,Ya){var gb=this.textMorph,ic=gb.document,kc=gb.selection.isMultiSelection?gb.selection.selections:[gb.selection];gb.undoManager.group();kc.forEach(function(Oc){Oc.collapseToEnd();var Pc=Oc.lead,Rc=ua?ic.indexToPosition(ic.positionToIndex(Pc)-ua.length):Pc;"function"===typeof Ya?Ya(S,ua,gb,{start:Rc,end:Pc},Oc):gb.replace({start:Rc,
end:Pc},S)});gb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],La,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);Ga.CompletionController=ma;Ga.CompletionController=ma;Ga.CompletionController=ma;
ma=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(va,La,ib){var S;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return 1==ua.nextAddress?(S=new Ga.CompletionController(va,Ga.defaultCompleters),ua.yield(S.openCompletionList(),2)):ua.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(va,La,ib){var S;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return 1==ua.nextAddress?(S=
new Ga.CompletionController(va,Ga.defaultCompleters),ua.yield(S.autoInsertBestMatchingCompletion(S.prefix()),2)):ua.return(!0)})}}];Ga.completionCommands=ma;Ga.completionCommands=ma;Ga.completionCommands=ma;var lb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");lb.chain=ed;lb.arr=Ob;lb.obj=sc;lb.string=Sc;var gc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(va){var La=va.selection.start;0<La.row&&(La=va.getPositionAboveOrBelow(1,La,
!0,0,va.charBoundsFromTextPosition(La).x),va.selection.addRange({start:La,end:La}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(va){var La=va.selection.start;La.row<va.documentEndPosition.row&&(La=va.getPositionAboveOrBelow(-1,La,!0,0,va.charBoundsFromTextPosition(La).x),va.selection.addRange({start:La,end:La}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(va){var La=va.selection.selections[va.selection.selections.length-
1];if(La.isEmpty())return!0;va.searchForAll(La.text,{start:{column:0,row:0}}).forEach(function(ib){return va.selection.addRange(ib.range,!1)});va.selection.mergeSelections();lb.arr.remove(va.selection.selections,La);va.selection.selections.push(La);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(va){var La=va.selection.selections.length-1,ib=va.selection.selections[La];if(ib.isEmpty())return!0;var S=va.search(ib.text,{start:ib.end,backwards:!1});S&&
(ib=va.selection.selections.findIndex(function(ua){return ua.range.equals(S.range)}),-1<ib?lb.arr.swap(va.selection.selections,ib,La):va.selection.addRange(S.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(va){var La=va.selection.selections.length-1,ib=va.selection.selections[La];if(ib.isEmpty())return!0;var S=ib.start,ua=va.search(ib.text,{start:{row:S.row,column:S.column-(ib.text.length-1)},backwards:!0});ua&&(ib=va.selection.selections.findIndex(function(Ya){return Ya.range.equals(ua.range)}),
-1<ib?lb.arr.swap(va.selection.selections,ib,La):va.selection.addRange(ua.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(va){var La=va.selection.selections.length;1<La&&va.selection.removeSelections(La-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(va){va.selection.selections=lively.lang.arr.rotate(va.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(va){va.selection.selections=lively.lang.arr.rotate(va.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(va){var La=va.selection.selections;if(1>=La.length)return!0;var ib=lb.arr.groupBy(La,function(ua){return ua.range.start.row});La=ib.keys().map(function(ua){ua=ib[ua];var Ya=lb.arr.max(ua,function(gb){return gb.range.start.column});lb.arr.without(ua,Ya).forEach(function(gb){return gb.range=Ya.range});
return Ya});var S=lb.arr.max(La,function(ua){return ua.range.start.column}).range.start.column;La.forEach(function(ua){var Ya=ua.range.start;ua=Ya.row;Ya=Ya.column;va.insertText(" ".repeat(S-Ya),{row:ua,column:Ya})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(va){va.selection.disableMultiSelect();if(va.selection.isEmpty())var La=va.lastSavedMark&&va.lastSavedMark.position||(void 0).lineRange().start,ib=va.cursorPosition;else La=va.selection,
ib=La.lead,La=La.anchor;va.selection.collapse();var S=La.column,ua=ib.column;lb.arr.range(La.row,ib.row).forEach(function(Ya){return va.getLine(Ya).length>Math.min(ua,S)&&va.selection.addRange({end:{row:Ya,column:ua},start:{row:Ya,column:S}},!1)});va.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(va,La,ib){ib=void 0===ib?1:ib;va.undoManager.group();va.selection.selections.forEach(function(S,ua){return S.text=String(ua+ib)});
va.undoManager.group();return!0}}];lb.multiSelectCommands=gc;lb.multiSelectCommands=gc;lb.multiSelectCommands=gc;var uc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");uc.pToI=function(va,La){return va.positionToIndex(La)};uc.iToP=function(va,La){return va.indexToPosition(La)};uc.execCodeNavigator=function(va){return function(La,ib,S){var ua=La.pluginInvokeFirst("getNavigator");if(!ua)return!0;La.saveMark();S=S||1;for(var Ya=0;Ya<S;Ya++)ua[va](La,ib);return!0}};uc.once=
Sa;var yd=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:uc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:uc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:uc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:uc.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:uc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(va,La){function ib(){var Ya=va.$expandRegionState,gb=uc.pToI(va,va.cursorPosition);if(Ya&&(Ya.range[0]===gb||Ya.range[1]===gb))return Ya;Ya=va.selection.range;return va.$expandRegionState={range:[uc.pToI(va,Ya.start),
uc.pToI(va,Ya.end)]}}La=La||{};var S=va.pluginInvokeFirst("getNavigator");if(!S)return!0;var ua=La.start;La=La.end;if("number"===typeof ua&&"number"===typeof La)ib(),S={range:[ua,La],prev:ib()};else{ua=S.ensureAST(va);if(!ua)return;S=S.expandRegion(va,va.textString,ua,ib())}S&&S.range&&(va.selection={start:uc.iToP(va,S.range[0]),end:uc.iToP(va,S.range[1])},va.$expandRegionState=S);uc.once(va,"selectionChange",function(){return va.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(va){if(va.selection.isEmpty())return!0;var La=va.pluginInvokeFirst("getNavigator");if(!La)return!0;var ib=La.ensureAST(va);if(!ib)return!0;var S=va.$expandRegionState;if(!S)return!0;(La=La.contractRegion(va,va.textString,ib,S))&&La.range&&(va.selection={start:uc.iToP(va,La.range[0]),end:uc.iToP(va,La.range[1])},va.$expandRegionState=La);uc.once(va,"selectionChange",
function(){return va.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];uc.commands=yd;uc.commands=yd;uc.commands=yd;var Pd=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");Pd.arr=Ob;Pd.chain=ed;Pd.string=Sc;var ve=[{name:"toggle comment",exec:function(va){var La=va.pluginInvokeFirst("getComment");if(!La)return!0;if(!La.lineCommentStart)return La.blockCommentStart?va.execCommand("toggle block comment"):!0;var ib=La.lineCommentStart,S=
new RegExp("^(\\s*)("+ib+"\\s?)(.*)");La=va.document;var ua=va.selection;ua.isEmpty()||0!==ua.end.column||ua.growRight(-1);var Ya=ua.start.row;La=La.lineStrings.slice(ua.start.row,ua.end.row+1);La=La.some(function(kc){return!!kc.trim()})?Pd.arr.dropWhile(La,function(kc){return kc.trim()?!1:++Ya&&!0}):La;var gb=La.every(function(kc){return kc.trim()&&kc.match(S)});va.undoManager.group();if(gb)La.forEach(function(kc,Oc){if(kc=kc.match(S)){kc=$jscomp.makeIterator(kc);kc.next();var Pc=kc.next().value,
Rc=kc.next().value;kc.next();va.deleteText({start:{row:Ya+Oc,column:Pc.length},end:{row:Ya+Oc,column:Pc.length+Rc.length}})}});else{var ic=La.reduce(function(kc,Oc,Pc){return Oc.trim()||ua.isEmpty()&&ua.start.row===ua.end.row?Math.min(kc,Oc.match(/^\s*/)[0].length):kc},Infinity);ic=Infinity===ic?0:ic;La.forEach(function(kc,Oc){kc=$jscomp.makeIterator(kc.match(/^(\s*)(.*)/));kc.next();kc.next();kc.next();va.insertText(ib+" ",{row:Ya+Oc,column:ic})})}va.undoManager.group();return!0}},{name:"toggle block comment",
exec:function(va){var La=va.pluginInvokeFirst("getComment");if(!La)return!0;if(!La.blockCommentStart)return La.lineCommentStart?va.execCommand("toggle comment"):!0;if(!La||!La.blockCommentStart)return!0;var ib=La.blockCommentStart;La=La.blockCommentEnd;var S=new RegExp("^"+ib.replace(/\*/g,"\\*")),ua=new RegExp(La.replace(/\*/g,"\\*")+"$"),Ya=va.tokenAt(va.cursorPosition);if(Ya&&"comment"===Ya.token){var gb=va.textInRange(Ya);if(gb.match(S)&&gb.match(ua))return va.undoManager.group(),va.replace(Ya,
gb.slice(ib.length,-La.length)),va.undoManager.group(),!0}va.undoManager.group();va.insertText(ib,va.selection.start);va.insertText(La,va.selection.end);va.undoManager.group();ib=!va.selection.isEmpty();va.selection.growLeft(La.length);ib||va.selection.collapse();return!0}},{name:"comment box",exec:function(va,La,ib){La=va.undoManager.ensureNewGroup(va,"comment box");if(va.selection.isEmpty())return va.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),va.execCommand("toggle comment"),
va.undoManager.group(La),!0;var S=va.selection.range,ua=va.withSelectedLinesDo(function(gb){return gb}),Ya=Pd.arr.min([S.start.column].concat(Pd.chain(ua).map(function(gb){return gb.match(/^\s*/)}).flatten().compact().pluck("length").value()));ua=Pd.arr.max(ua.map(function(gb){return gb.length}))-Ya;ua=Array(Math.ceil(ua/2)+1).join("-=")+"-";va.execCommand("toggle comment");va.collapseSelection();va.cursorPosition={row:S.start.row,column:0};ib?va.insertText(Pd.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",Ya)):va.insertText(Pd.string.indent(ua+"\n"," ",Ya));va.selection.goUp();va.execCommand("toggle comment");va.cursorPosition={row:S.end.row+2,column:0};va.insertText(Pd.string.indent(ua+"\n"," ",Ya));va.selection.goUp();va.execCommand("toggle comment");va.selection.range={start:{row:S.start.row,column:0},end:va.cursorPosition};va.undoManager.group(La);return!0},multiSelectAction:"forEach",handlesCount:!0}];Pd.commands=ve;Pd.commands=ve;Pd.commands=ve;var Uc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
Uc.printSymbol=function(va){if(Symbol.keyFor(va))return'Symbol.for("'+Symbol.keyFor(va)+'")';if(Uc.knownSymbols.get(va))return Uc.knownSymbols.get(va);String(va).match(Uc.symMatcher);return String(va)};Uc.defaultSort=function(va,La){if(va.hasOwnProperty("priority")||La.hasOwnProperty("priority")){var ib=va.priority||0,S=La.priority||0;if(ib<S)return-1;if(ib>S)return 1}va=(va.keyString||va.key).toLowerCase();La=(La.keyString||La.key).toLowerCase();return va<La?-1:va===La?0:1};Uc.safeToString=Bd;Uc.propertyNamesOf=
function(va,La){if(!va)return[];if(Array.isArray(va)){var ib=La?La.offset:0;return Uc.arr.range(ib,ib+(La?La.partitionSize:va.length-1))}return Uc.arr.sortBy(Object.keys(va),function(S){return S.toLowerCase()})};Uc.isMultiValue=pd;Uc.printValue=Vd;Uc.partitionedChildren=function(va,La){var ib=void 0===La?{}:La;La=void 0===ib.originalValue?va:ib.originalValue;var S=void 0===ib.offset?0:ib.offset;ib=void 0===ib.partitionSize?va.length||Object.values(va).length:ib.partitionSize;if(Uc.obj.isArray(va)){va=
Uc.num.roundTo(Math.max(Uc.MIN_PARTITION_SIZE,ib/50),.1);ib/=va;for(var ua=[],Ya=0;Ya<ib;Ya++){var gb="["+(S+Ya*va)+"-"+(S+(Ya+1)*va)+"]";ua.push({partition:{originalValue:La,offset:S+Ya*va,partitionSize:va},value:[],key:gb,keyString:gb,valueString:"...",isCollapsed:!0})}return ua}va=Uc.num.roundTo(Math.max(Uc.MIN_PARTITION_SIZE,ib/50),.1);ib/=va;ua=[];Ya=Uc.obj.keys(La).sort();for(gb=0;gb<ib;gb++){var ic=S+gb*va,kc=S+(gb+1)*va,Oc=Uc.obj.select(La,Ya.slice(ic,kc));ic="["+Ya[ic].slice(0,4)+"-"+(Ya[kc]||
Uc.arr.last(Ya)).slice(0,4)+"]";ua.push({partition:{originalValue:Oc,offset:S+gb*va,partitionSize:va},value:[],key:ic,keyString:ic,valueString:"...",isCollapsed:!0})}return ua};Uc.propertiesOf=function(va){var La=va.partition?va.target:va.value;if(!La)return[];var ib={_rev:!0},S=[],ua="function"===typeof La.livelyCustomInspect?La.livelyCustomInspect():{},Ya=Object.assign({},Uc.defaultPropertyOptions,{},ua);if(ua.properties){ua=$jscomp.makeIterator(ua.properties);for(var gb=ua.next();!gb.done;gb=ua.next()){var ic=
gb.value;gb=ic.key;var kc=ic.hidden,Oc=ic.priority,Pc=ic.keyString,Rc=ic.value;ic=ic.valueString;ib[gb]=!0;kc||S.push(va.getSubNode({priority:Oc,key:gb,keyString:Pc||Uc.safeToString(gb),value:Rc,valueString:ic,isCollapsed:!0}))}}if(Ya.includeDefault){ua=Uc.propertyNamesOf(La,va.partition);if(ua.length>Uc.MAX_NODE_THRESHOLD)for(ib=$jscomp.makeIterator(Uc.partitionedChildren(La,va.partition)),ua=ib.next();!ua.done;ua=ib.next())S.push(va.getSubNode(ua.value));else for(kc=$jscomp.makeIterator(ua),ua=
kc.next();!ua.done;ua=kc.next())Oc=ua.value,Oc in ib||(ua=La[Oc],gb=Uc.printValue(ua),ua={keyString:Oc,key:Oc,value:ua,valueString:gb,isCollapsed:!0},S.push(va.getSubNode(ua)));if(Ya.includeSymbols)for(ib=$jscomp.makeIterator(Object.getOwnPropertySymbols(La)),ua=ib.next();!ua.done;ua=ib.next())kc=ua.value,Oc=Uc.safeToString(kc),ua=La[kc],gb=Uc.printValue(ua),ua={key:kc,keyString:Oc,value:ua,valueString:gb,isCollapsed:!0},S.push(va.getSubNode(ua))}Ya.sort&&(S=Ya.sortFunction(La,S));return S};Uc.obj=
sc;Uc.num=ob;Uc.arr=Ob;Uc.string=Sc;Uc.connect=Fc;Uc.signal=$b;Uc.TreeData=Sb;Uc.newUUID=Bc;Uc.localInterface=sa;Uc.MAX_NODE_THRESHOLD=1E3;Uc.MIN_PARTITION_SIZE=250;Uc.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(va,La){return Array.isArray(va)?La:La.sort(Uc.defaultSort)}};Uc.symMatcher=/^Symbol\((.*)\)$/;Uc.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(va){return"symbol"===typeof Symbol[va]}).reduce(function(va,La){return va.set(Symbol[La],
"Symbol."+La)},new Map)}();Uc.isMultiValue=pd;Uc.isMultiValue=pd;Uc.printValue=Vd;Uc.printValue=Vd;var Sd=function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ib=La.hasOwnProperty("InspectionTree")&&"function"===typeof La.InspectionTree?La.InspectionTree:La.InspectionTree=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:Symbol.for("lively-instance-initialize"),
value:function(S){xb._get(Object.getPrototypeOf(ib.prototype),Symbol.for("lively-instance-initialize"),this).call(this,S);this.inspector=S.inspector;this.root.isInspectionNode||(this.root=Uc.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(S){S=void 0===S?!0:S;return xb._get(Object.getPrototypeOf(ib.prototype),"asListWithIndexAndDepth",this).call(this,function(ua){ua=ua.node;return S?ua.visible:!0})}},{key:"getContextFor",
value:function(S){return S==this.root?this.root.value.inspectee:S.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(S){var ua=void 0===S.maxDepth?1:S.maxDepth,Ya=S.iterator,gb=S.showUnknown,ic=S.showInternal,kc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oc){if(1==Oc.nextAddress)return Oc.yield(kc.uncollapseAll(function(Pc,Rc){return ua>Rc&&(Pc==kc.root||Pc.value.submorphs)}),2);kc.asListWithIndexAndDepth(!1).forEach(function(Pc){var Rc=Pc.node;return 0==
Pc.depth?Rc.visible=!0:!gb&&Rc.keyString&&Rc.keyString.includes("UNKNOWN PROPERTY")||!ic&&Rc.keyString&&Rc.keyString.includes("internal")?Rc.visible=!1:Rc.value&&Rc.value.submorphs?Rc.visible=!0:Rc.visible=Ya(Rc)});Oc.jumpToEnd()})}},{key:"getChildren",value:function(S){return S.children}},{key:"display",value:function(S){return S.display(this.inspector)}},{key:"isCollapsed",value:function(S){return S.isCollapsed}},{key:"isLeaf",value:function(S){return Uc.obj.isPrimitive(S.value)}},{key:"collapse",
value:function(S,ua){var Ya=this;S.isCollapsed=ua;ua||this.isLeaf(S)||S.children.length||(S.children=Uc.propertiesOf(S).map(function(gb){Ya.parentMap.set(gb,S);return gb}))}},{key:"retrieveForRemoteProxy",value:function(S){S.uuid||(S.uuid=Uc.newUUID(),this.idToNodeMap[S.uuid]=S);return{uuid:S.uuid,value:this.isLeaf(S)?S.value:{},keyString:S.keyString,key:S.keyString,valueString:Uc.safeToString(S.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Uc.localInterface}},
{key:"getNodeViaId",value:function(S){return this.idToNodeMap[S]}},{key:"asRemoteDelegate",value:function(S){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[S]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionTree"}},{key:"forObject",value:function(S,ua){return new this({key:"inspectee",
value:{inspectee:S},isCollapsed:!0,inspector:ua})}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(Uc.TreeData);Uc.InspectionTree=Sd;Uc.InspectionTree=Sd;Uc.InspectionTree=Sd;var De=function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
ib=La.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof La.RemoteInspectionTree?La.RemoteInspectionTree:La.RemoteInspectionTree=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(S){this.parentMap=new WeakMap;this.root=S.proxy;this.evalEnvironment=S.evalEnvironment;
this.inspector=S.inspector;this.delegateId=S.delegateId}},{key:"getContextFor",value:function(S){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+S.uuid+'").value'}},{key:"dispose",value:function(){var S=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return ua.yield(S.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+S.delegateId+"']\n    ",S.evalEnvironment),0)})}},{key:"display",
value:function(S){return S.keyString+": "+S.valueString}},{key:"collapse",value:function(S,ua){var Ya=this,gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ic){if(1==ic.nextAddress)return(S.isCollapsed=ua)||Ya.isLeaf(S)?ic.return():S.children.length?ic.jumpTo(0):ic.yield(Ya.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+S.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Ya.delegateId+'"]'}),3);gb=ic.yieldResult;S.children=gb.isError?[]:gb.value;ic.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(S,ua){var Ya=this,gb,ic,kc,Oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){if(1==Pc.nextAddress)return Pc.yield(Ya.createRemoteContext(S,ua),2);gb=Pc.yieldResult;
ic=gb.proxy;kc=gb.delegateId;Oc=gb.evalEnvironment;return Pc.return(new Ya({key:"inspectee",proxy:ic,delegateId:kc,evalEnvironment:Oc,inspector:ua}))})}},{key:"createRemoteContext",value:function(S,ua){var Ya=S.code,gb=S.evalEnvironment,ic=S.delegateId,kc,Oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){if(1==Pc.nextAddress)return ic="lively://inspector-"+ua.id,Pc.yield(gb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Ya+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+ic+'");\n    ',gb),2);kc=Pc.yieldResult;Oc=kc.value;return Pc.return({delegateId:ic,evalEnvironment:gb,proxy:Oc})})}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(Uc.InspectionTree);
Uc.RemoteInspectionTree=De;Uc.RemoteInspectionTree=De;Uc.RemoteInspectionTree=De;(function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ib=La.hasOwnProperty("InspectionNode")&&"function"===typeof La.InspectionNode?La.InspectionNode:La.InspectionNode=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:Symbol.for("lively-instance-initialize"),value:function(S){var ua=
S.root,Ya=S.priority,gb=S.key,ic=S.keyString,kc=S.value,Oc=S.valueString,Pc=S.isCollapsed,Rc=void 0===S.children?[]:S.children,Ie=void 0===S.isSelected?!1:S.isSelected,zf=void 0===S.visible?!0:S.visible;this.partition=S.partition;this.priority=Ya;this.key=gb;this.keyString=String(ic||gb);this.value=kc;this.valueString=Oc||Uc.printValue(kc);this.isCollapsed=Pc;this.children=Rc;this.isSelected=Ie;this.visible=zf;this.root=ua}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(S){if(S.value&&S.value.isMorph)return new Uc.MorphNode(Object.assign({root:this.root},S));var ua=S.key,Ya=S.keyString,gb=this.value,ic=S.partition;ic&&(gb=ic.originalValue,Ya=ua);return new Uc.PropertyNode(Object.assign({},S,{keyString:Ya,key:ua,target:gb,partition:ic,root:this.root,spec:{}}))}},{key:"display",value:function(S){var ua=this.keyString,Ya=this.valueString;if(!this.interactive)return ua+": "+Ya;this._propertyWidget||(this._propertyWidget=
S.renderDraggableTreeLabel({value:ua+": "+Ya}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(S,ua){ua=void 0===ua?null:ua;return S.value&&S.value.isMorph?new Uc.MorphNode(Object.assign({root:ua},S)):new Uc.InspectionNode(Object.assign({root:ua},S))}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ib=La.hasOwnProperty("MorphNode")&&"function"===typeof La.MorphNode?La.MorphNode:La.MorphNode=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:Symbol.for("lively-instance-initialize"),
value:function(S){xb._get(Object.getPrototypeOf(ib.prototype),Symbol.for("lively-instance-initialize"),this).call(this,S);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(S){var ua=this.propertyInfo[S.key]||{};return S.value&&S.value.isMorph?new Uc.MorphNode(Object.assign({},S,{root:this.root})):new Uc.PropertyNode(Object.assign({},S,{root:this.root,target:this.target,spec:ua}))}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"MorphNode"}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(Uc.InspectionNode);(function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ib=La.hasOwnProperty("PropertyNode")&&"function"===typeof La.PropertyNode?
La.PropertyNode:La.PropertyNode=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:Symbol.for("lively-instance-initialize"),value:function(S){xb._get(Object.getPrototypeOf(ib.prototype),Symbol.for("lively-instance-initialize"),this).call(this,S);var ua=S.spec,Ya=S.target;this.partition=S.partition;this.target=Ya;this.spec=ua;this.foldedNodes={}}},{key:"__deserialize__",value:function(S,ua){this.spec=
{}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(S){this._interactive=S}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(S){return this.isFoldable?this.getFoldedContext(S):xb._get(Object.getPrototypeOf(ib.prototype),"getSubNode",this).call(this,S)}},{key:"getFoldedContext",value:function(S){return this.foldedNodes[S.key]=
new Uc.FoldedNode(Object.assign({},S,{root:this.root,target:this.target,foldableNode:this,spec:Uc.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(S,ua){(ua=void 0===ua?!1:ua)&&(this.target[this.key]=S);this.value=this.target[this.key];this.valueString=Uc.printValue(this.value);this.interactive&&(ua||this._propertyWidget.highlight());if(this.isFoldable)for(var Ya in this.foldedNodes)this.foldedNodes[Ya].value=
this.value[Ya],this.foldedNodes[Ya].valueString=Uc.printValue(this.value[Ya]),this.foldedNodes[Ya]._propertyWidget&&Uc.signal(this.foldedNodes[Ya]._propertyWidget,"update",this.value[Ya])}},{key:"display",value:function(S){var ua=this,Ya=this._propertyWidget,gb=this.keyString,ic=this.valueString,kc=this.target,Oc=this.value,Pc=this.spec;if(!(this.interactive||Pc.foldable&&Uc.isMultiValue(Oc,Pc.foldable)))return S.renderPropertyControl({target:kc,keyString:gb,valueString:ic,tree:S.ui.propertyTree,
value:Oc,spec:Pc,node:this,fastRender:!0});if(Ya)return Ya.keyString=gb,Ya.valueString=ic,Ya.isSelected=this.isSelected,Ya.control&&(Ya.control.isSelected=this.isSelected),Ya;Ya=this._propertyWidget=S.renderPropertyControl({target:kc,keyString:gb,valueString:ic,value:Oc,spec:Pc,node:this,isSelected:this.isSelected,fontColor:S.ui.propertyTree.fontColor});this.isInternalProperty||Pc.readOnly||(Uc.connect(Ya,"propertyValue",this,"refreshProperty",{updater:function(Rc,Ie){return Rc(Ie,!0)}}),Uc.connect(Ya,
"openWidget",this.root,"onWidgetOpened",{converter:function(Rc){return{widget:Rc,node:ua.sourceObj}}}));return Ya}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(Uc.InspectionNode);
(function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ib=La.hasOwnProperty("FoldedNode")&&"function"===typeof La.FoldedNode?La.FoldedNode:La.FoldedNode=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:Symbol.for("lively-instance-initialize"),value:function(S){xb._get(Object.getPrototypeOf(ib.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
S);this.foldableNode=S=S.foldableNode;this.foldedProp=S.key+Uc.string.capitalize(this.key)}},{key:"refreshProperty",value:function(S,ua){ua=void 0===ua?!1:ua;var Ya={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Ya[this.key]=S,Ya)),ua)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(Uc.PropertyNode);var Td=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Td.Color=nb;var Gf=function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),ib=La.hasOwnProperty("DarkTheme")&&"function"===typeof La.DarkTheme?La.DarkTheme:La.DarkTheme=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return xb(ib,va,[{key:"background",get:function(){return Td.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Td.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Td.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Td.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Td.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Td.Color.white,fontWeight:"bold",backgroundColor:Td.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Td.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Td.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],La,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),Te=Gf=Td.DarkTheme;Td.default=Gf;var mc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");mc.inspect=qc;mc.remoteInspect=Ld;mc.generateReferenceExpression=Lc;mc.onNumberDragStart=
function(va,La){La.initPos=va.position;La.factorLabel=(new mc.Tooltip({description:"1x"})).openInWorld(va.hand.position.addXY(10,10))};mc.onNumberDrag=function(va,La){var ib=mc.getScaleAndOffset(va,La),S=ib.scale;ib=ib.offset;La.factorLabel.position=va.hand.position.addXY(10,10);La.factorLabel.description=S+"x";return mc.getCurrentValue(ib,S,La)};mc.onNumberDragEnd=function(va,La){var ib=mc.getScaleAndOffset(va,La);va=ib.offset;ib=ib.scale;La.factorLabel.softRemove();return mc.getCurrentValue(va,
ib,La)};mc.getScaleAndOffset=function(va,La){var ib=va.position.subPt(La.initPos);va=ib.x;La=mc.num.roundTo(Math.exp(-ib.y/$world.height*6),.01)*La.baseFactor;return{offset:va,scale:La}};mc.getCurrentValue=function(va,La,ib){return Math.max(ib.min,Math.min(ib.max,ib.scrubbedValue+(ib.floatingPoint?va*La:Math.round(va*La))))};mc.Color=nb;mc.Rectangle=Hb;mc.rect=id;mc.pt=qd;mc.obj=sc;mc.num=ob;mc.Path=Xb;mc.arr=Ob;mc.promise=Ub;mc.connect=Fc;mc.disconnect=ub;mc.once=Sa;mc.Morph=hc;mc.Tooltip=wc;mc.VerticalLayout=
bd;mc.GridLayout=cd;mc.HorizontalLayout=bb;mc.morph=Dc;mc.CustomLayout=pb;mc.Label=pc;mc.Icon=ab;mc.StyleSheet=Hc;mc.config=cb;mc.Tree=Pa;mc.LoadingIndicator=Za;mc.DropDownList=eb;mc.DropDownSelector=Na;mc.SearchField=Da;mc.LabeledCheckBox=mb;mc.MorphHighlighter=Mb;mc.InteractiveMorphSelector=Yb;mc.printValue=Vd;mc.RemoteInspectionTree=De;mc.InspectionTree=Sd;mc.isMultiValue=pd;mc.valueWidgets=I;mc.popovers=W;mc.DarkTheme=Te;mc.DefaultTheme=tb;mc.syncEval=Zb;mc.inspectorCommands=[{name:"focus codeEditor",
exec:function(va){va.get("codeEditor").show();va.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(va){va.get("propertyTree").show();va.get("propertyTree").focus();return!0}}];(function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ib=La.hasOwnProperty("DraggedProp")&&"function"===typeof La.DraggedProp?La.DraggedProp:La.DraggedProp=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return xb(ib,va,[{key:"applyToTarget",value:function(S){var ua=this.currentTarget,Ya=this.control;this.remove();mc.MorphHighlighter.removeHighlighters(S.world);if(ua)if(ua.isText&&"js"===ua.editorModeName){var gb=ua.evalEnvironment.context;S=ua.textPositionFromPoint(ua.localize(S.position));gb=mc.generateReferenceExpression(this.sourceObject,{fromMorph:gb});Ya.keyString&&(gb+="."+Ya.keyString);ua.insertTextAndSelect(gb,S);ua.focus()}else"propertyValue"in Ya&&(ua[Ya.keyString]=Ya.propertyValue)}},
{key:"update",value:function(S){S=S.hand.globalPosition;var ua=this.morphBeneath(S),Ya;if(ua){for(ua==this.morphHighlighter&&(ua=ua.morphBeneath(S));Ya=[ua].concat($jscomp.arrayFromIterable(ua.ownerChain())).find(function(gb){return!gb.visible});)ua=Ya=Ya.morphBeneath(S);if(ua!=this.currentTarget){this.currentTarget=ua;this.morphHighlighter&&this.morphHighlighter.deactivate();if(ua.isWorld)return;this.morphHighlighter=mc.MorphHighlighter.for($world,ua);this.morphHighlighter.show()}this.position=S}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:mc.Color.rgb(169,204,227)},fill:{defaultValue:mc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var S=this.control;if(!S)return this.submorphs=[];this.height=22;this.submorphs=[S];S.top=0;S.fontSize=14;"function"===typeof S.relayout&&
S.relayout();this.width=S.width+20;this.adjustOrigin(mc.pt(10,10))}}}}}],La,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3719})})(mc.Morph);(function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ib=La.hasOwnProperty("DraggableTreeLabel")&&"function"===
typeof La.DraggableTreeLabel?La.DraggableTreeLabel:La.DraggableTreeLabel=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(S){this.draggedProp=new mc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();mc.connect(S.hand,"update",this.draggedProp,"update")}},{key:"onDrag",
value:function(S){}},{key:"onDragEnd",value:function(S){mc.disconnect(S.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(S)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:mc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:mc.Color.transparent},
padding:{defaultValue:mc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(S){this.setProperty("isSelected",S);S?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=S)}}}}}],La,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3721,end:5060})})(mc.Label);Sd=function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ib=La.hasOwnProperty("PropertyControl")&&"function"===typeof La.PropertyControl?La.PropertyControl:La.PropertyControl=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(S,ua,Ya){S.control=new mc.DropDownSelector({opacity:.8,fill:mc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:ua,padding:0,values:Ya});mc.connect(S.control,"update",S,"propertyValue",{updater:function(gb,ic){this.targetObj.propertyValue!=ic&&gb(ic)}});mc.connect(S,"update",S.control,"selectedValue",{updater:function(gb,ic){ic=ic&&ic.valueOf?ic.valueOf():ic;this.targetObj.propertyValue!=ic&&gb(ic)}});return S}},{key:"toggleMultiValuePlaceholder",
value:function(S){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:mc.Color.transparent,layout:new mc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:mc.arr.range(0,2).map(function(ua){return{type:"ellipse",fill:mc.Color.gray.withA(.5),reactsToPointer:!1,extent:mc.pt(7,7)}})});S?(mc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=
0,this.multiValuePlaceholder.visible=!0):(mc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(S){this.foldableProperties&&this.toggleMultiValuePlaceholder(mc.isMultiValue(S,this.foldableProperties))}},{key:"asFoldable",value:function(S){this.foldableProperties=S;mc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&
(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var S=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});S.isLayoutable=
!1;S.fontWeight="bold";S.fontColor=mc.Color.orange;S.reactsToPointer=!1;S.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(S){this.submorphs=[S]}},layout:{initialize:function(){this.layout=new mc.CustomLayout({relayout:function(S){S.relayout()}})}},submorphs:{initialize:function(){this.value=
this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(S){return(S=S.value)&&(S.isColor||S.isGradient)?"Color":S&&S.isPoint?"Point":mc.obj.isBoolean(S)?"Boolean":mc.obj.isNumber(S)?"Number":mc.obj.isString(S)?"String":S&&S.isRectangle?"Rectangle":!1}},{key:"render",value:function(S){S.spec.type||(S.spec=Object.assign({},S.spec,{type:this.inferType(S)}));switch(S.spec.type){case "Color":var ua=this.renderColorControl(S);break;case "ColorGradient":ua=this.renderColorControl(Object.assign({},
S,{gradientEnabled:!0}));break;case "Number":ua=this.renderNumberControl(S);break;case "String":ua=this.renderStringControl(S);break;case "RichText":ua=this.renderStringControl(S);break;case "Layout":ua=this.renderLayoutControl(S);break;case "Enum":ua=this.renderEnumControl(S);break;case "Shadow":ua=this.renderShadowControl(S);break;case "Point":ua=this.renderPointControl(S);break;case "Rectangle":ua=this.renderRectangleControl(S);break;case "Boolean":ua=this.renderBooleanControl(S);break;default:ua=
this.renderItSomehow(S)}ua.control&&(mc.connect(ua.control,"openWidget",ua,"openWidget"),ua.toggleFoldableValue(S.value));return ua}},{key:"baseControl",value:function(S){var ua=S.spec;S=new this({keyString:S.keyString,valueString:S.valueString,isSelected:!1,propertyValue:S.value});ua.foldable&&S.asFoldable(ua.foldable);return S}},{key:"renderGrabbableKey",value:function(S){var ua=this,Ya=S.target;return[S.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(gb){gb.state.draggedProp=new mc.DraggedProp({sourceObject:Ya,
control:ua.baseControl(S)});gb.state.draggedProp.openInWorld();mc.connect(gb.hand,"update",gb.state.draggedProp,"update")},onDrag:function(gb){},onDragEnd:function(gb){mc.disconnect(gb.hand,"update",gb.state.draggedProp,"update");gb.state.draggedProp.applyToTarget(gb)}}]}},{key:"renderEnumControl",value:function(S){var ua=S.value,Ya=S.spec.values,gb=S.keyString,ic=S.target,kc=S.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" "+(ua?ua.valueOf?ua.valueOf():ua:"Not set"),
{nativeCursor:"pointer",onMouseDown:function(Oc,Pc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rc){ic.world().openWorldMenu(Oc,Ya.map(function(Ie){return{string:Ie.toString(),action:function(){ic[gb]=Ie;kc.rerender()}}}));Rc.jumpToEnd()})}}],$jscomp.arrayFromIterable(mc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7})))}},{key:"renderStringControl",value:function(S){var ua=S.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),
[" "+(200<ua.length?ua.slice(0,20)+"...":ua),{fontColor:mc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(S){var ua=S.value,Ya=S.keyString,gb=S.valueString,ic=S.target,kc=S.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" "+gb,{fontColor:mc.Color.black,nativeCursor:"pointer",onMouseDown:function(Oc){var Pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rc){if(1==Rc.nextAddress)return Pc=new mc.popovers.RectanglePopover({hasFixedPosition:!0,
rectangle:ua}),Pc.relayout(),Rc.yield(Pc.fadeIntoWorld(Oc.positionIn(ic.world())),2);mc.connect(Pc,"rectangle",function(Ie){ic[Ya]=Ie;kc.rerender()});Rc.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(S){var ua=S.value,Ya=S.keyString,gb=S.valueString,ic=S.target,kc=S.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" "+gb,{nativeCursor:"pointer",fontColor:ua?mc.Color.green:mc.Color.red,onMouseDown:function(Oc){ic[Ya]=!ic[Ya];kc.rerender()}}])}},{key:"renderNumberControl",
value:function(S){var ua=S.value,Ya=S.spec,gb=S.keyString,ic=S.valueString,kc=S.node,Oc=S.target,Pc=S.tree,Rc=void 0===kc._numberControls?new we:kc._numberControls,Ie=$jscomp.makeIterator(Rc.submorphs),zf=Ie.next().value,ef=Ie.next().value;Rc.fontColor=Pc.fontColor;var Ee=kc._numberControls=Rc;"max"in Ya&&"min"in Ya&&-Infinity!=Ya.min&&Infinity!=Ya.max?(Ee.baseFactor=(Ya.max-Ya.min)/100,Ee.floatingPoint=Ya.isFloat,Ee.max=Ya.max,Ee.min=Ya.min):(Ee.floatingPoint=Ya.isFloat,Ee.baseFactor=.5,Ee.min=void 0!=
Ya.min?Ya.min:-Infinity,Ee.max=void 0!=Ya.max?Ya.max:Infinity);var dh=mc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),$jscomp.arrayFromIterable(kc._inputMorph?[kc._inputMorph,{}]:[" "+(void 0!=ua&&(ua.valueOf?ua.valueOf():ua).toFixed(Ya.isFloat?3:0))+" ",{fontColor:dh,onMouseUp:function(Cg){kc._inputMorph=mc.morph({type:"input",fill:null,fontColor:dh,fontFamily:"IBM Plex Mono",fontSize:14,padding:mc.rect(8,2,-6,2),
height:23,cursorColor:mc.Color.white,value:ua.valueOf?ua.valueOf():ic});Oc[gb]=ua;kc._inputMorph.focus();mc.once(kc._inputMorph,"inputAccepted",function(ci){delete kc._inputMorph;Oc[gb]=Ya.isFloat?Number.parseFloat(ci):Number.parseInt(ci);kc.rerender()});mc.once(kc._inputMorph,"onBlur",function(ci){kc._inputMorph&&(delete kc._inputMorph,Oc[gb]=ua,kc.rerender())});kc.rerender()},onDragStart:function(Cg){Ee.scrubbedValue=ua;mc.onNumberDragStart(Cg,Ee)},onDrag:function(Cg){Oc[gb]=mc.onNumberDrag(Cg,
Ee);kc.rerender()},onDragEnd:function(Cg){return mc.onNumberDragEnd(Cg,Ee)}},Rc,{onMouseUp:function(){zf.fill=ef.fill=null},onMouseDown:function(Cg){if(Cg.targetMorph===zf){zf.fill=mc.Color.white.withA(.2);if("max"in Ya&&Oc[gb]>=Ya.max)return;Oc[gb]+=1}if(Cg.targetMorph===ef){ef.fill=mc.Color.white.withA(.2);if("min"in Ya&&Oc[gb]<=Ya.min)return;--Oc[gb]}kc.rerender()}}]))}},{key:"renderShadowControl",value:function(S){var ua=S.keyString,Ya=S.value,gb=S.target,ic=S.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),
[""+(Ya?Ya.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(kc){var Oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){if(1==Pc.nextAddress)return Oc=new mc.popovers.ShadowPopover({shadowValue:gb[ua],hasFixedPosition:!0}),Pc.yield(Oc.fadeIntoWorld(kc.positionIn(gb.world())),2);mc.connect(Oc,"shadowValue",function(Rc){gb[ua]=Rc;ic.rerender()});Pc.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(S){var ua=S.keyString,Ya=S.value,gb=S.target,ic=S.node,
kc=mc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Oc={nativeCursor:"pointer",onMouseDown:function(Pc){var Rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ie){if(1==Ie.nextAddress)return Rc=new mc.popovers.PointPopover({pointValue:gb[ua],hasFixedPosition:!0}),Ie.yield(Rc.fadeIntoWorld(Pc.positionIn(gb.world())),2);mc.connect(Rc,"pointValue",function(zf){gb[ua]=zf;ic.rerender()});Ie.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),
[" pt(",Object.assign({},Oc),""+Ya.x.toFixed(),Object.assign({fontColor:kc},Oc),",",Object.assign({},Oc),""+Ya.y.toFixed(),Object.assign({fontColor:kc},Oc),")",Object.assign({},Oc)])}},{key:"renderLayoutControl",value:function(S){var ua=S.valueString,Ya=S.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" "+(Ya?ua:"No Layout"),{onMouseDown:function(gb){}}])}},{key:"renderColorControl",value:function(S){var ua=S.node,Ya=S.gradientEnabled,gb=S.valueString,ic=S.keyString,
kc=S.value,Oc=S.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[mc.morph({fill:kc.valueOf?kc.valueOf():kc,extent:mc.pt(15,15),borderColor:mc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(kc?kc.valueOf?kc.valueOf():gb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Pc){var Rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ie){if(1==Ie.nextAddress)return Rc=new mc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Oc,
fillValue:kc,title:"Fill Control",gradientEnabled:Ya}),Ie.yield(Rc.fadeIntoWorld(Pc.positionIn(Oc.world())),2);mc.connect(Rc,"fillValue",function(zf){Oc[ic]=zf;ua.rerender()});Ie.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(S){var ua=S.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" "+ua,{}])}}],La,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5069,end:20353})}(mc.DraggableTreeLabel);mc.PropertyControl=Sd;mc.PropertyControl=Sd;mc.PropertyControl=Sd;mc.inspect=qc;mc.inspect=qc;mc.remoteInspect=Ld;mc.remoteInspect=Ld;mc.generateReferenceExpression=Lc;mc.generateReferenceExpression=Lc;var we=function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ib=La.hasOwnProperty("NumberControls")&&"function"===typeof La.NumberControls?La.NumberControls:La.NumberControls=
function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new mc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:mc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(S){this.submorphs.map(function(ua){return ua.fontColor=
S})}},submorphs:{initialize:function(){this.submorphs=[mc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:mc.rect(5,2,0,-6),fontSize:12}),mc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:mc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],La,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23026,end:24071})}(mc.Morph);(function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ib=La.hasOwnProperty("PropertyTree")&&"function"===typeof La.PropertyTree?La.PropertyTree:La.PropertyTree=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:"onDrag",value:function(S){this._onDragHandler&&this._onDragHandler(S)}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],La,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25236,end:25347})})(mc.Tree);Sd=function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ib=La.hasOwnProperty("Inspector")&&"function"===
typeof La.Inspector?La.Inspector:La.Inspector=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(S){}},{key:"__after_deserialize__",value:function(S,ua,Ya){var gb=this,ic=new mc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,
{treeData:mc.InspectionTree.forObject(null,this)}));this.addMorph(ic,this.getSubmorphNamed("terminal toggler"));xb._get(Object.getPrototypeOf(ib.prototype),"__after_deserialize__",this).call(this,S,ua,Ya);!this.isComponent&&this.master.whenApplied().then(function(){gb.layout.col(0).row(1).group.morph=ic;gb.targetObject&&(gb.targetObject=gb.targetObject)})}},{key:"__additionally_serialize__",value:function(S,ua,Ya,gb){S=S.props.submorphs.value;for(ua=S.length;ua--;)Ya.refForId(S[ua].id).realObj==this.ui.propertyTree&&
mc.arr.removeAt(S,ua)}},{key:"renderDraggableTreeLabel",value:function(S){return new mc.DraggableTreeLabel(S)}},{key:"renderPropertyControl",value:function(S){return mc.PropertyControl.render(S)}},{key:"onLoad",value:function(){var S=this.ui,ua=S.codeEditor,Ya=S.thisBindingSelector,gb=S.propertyTree;ua.changeEditorMode("js").then(function(){return ua.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Ya.selection?ua.owner.selectedContext:ua.owner.targetObject},
get systemInterface(){return mc.Path("treeData.systemInterface").get(gb)},format:"esm"}}).catch(function(ic){return $world.logError(ic)})}},{key:Symbol.for("lively-instance-initialize"),value:function(S){xb._get(Object.getPrototypeOf(ib.prototype),Symbol.for("lively-instance-initialize"),this).call(this,S);S=this.ui;var ua=S.targetPicker,Ya=S.propertyTree,gb=S.resizer,ic=S.terminalToggler,kc=S.unknowns,Oc=S.internals,Pc=S.searchField,Rc=S.codeEditor,Ie=S.fixImportButton,zf=S.thisBindingSelector;Rc.changeEditorMode("js").then(function(){return Rc.evalEnvironment=
{targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==zf.selection?Rc.owner.selectedContext:Rc.owner.targetObject},get systemInterface(){return Ya.treeData.systemInterface},format:"esm"}}).catch(function(ef){return $world.logError(ef)});mc.connect(ua,"onMouseDown",this,"selectTarget");mc.connect(Ya,"onScroll",this,"repositionOpenWidget");mc.connect(gb,"onDrag",this,"adjustProportions");mc.connect(ic,"onMouseDown",this,"toggleCodeEditor");mc.connect(kc,"trigger",this,"filterProperties");
mc.connect(Oc,"trigger",this,"filterProperties");mc.connect(Pc,"searchInput",this,"filterProperties");mc.connect(Ya,"nodeCollapseChanged",this,"filterProperties");mc.connect(this,"extent",this,"relayout");mc.connect(zf,"selection",this,"bindCodeEditorThis");mc.connect(Ie,"fire",Rc,"execCommand",{updater:function(ef){return ef("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var S=this.ui.propertyTree.selectedIndex-1,ua=this.ui.propertyTree.selectedNode;
this.ui.propertyTree.selectedNode.refreshProperty();ua=this.ui.propertyTree.document.getLine(S).textAndAttributes.slice(0,4).concat(ua.display(this));S=this.ui.propertyTree.lineRange(S,!1);this.ui.propertyTree.replace(S,ua,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),
this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var S=mc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(S!=this.lastChange||this.lastSubmorphs!=mc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==S.prop&&this.repositionOpenWidget(),this.lastChange=S,this.lastSubmorphs=mc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",
value:function(){var S;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(ua){ua=ua.node;ua.target&&(S=ua.foldableNode?ua.target[ua.foldableNode.key][ua.key]:ua.target[ua.key],!mc.obj.equals(S,ua.value)&&ua.refreshProperty&&ua.refreshProperty(S))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(S,ua){ua=void 0===ua?!1:ua;var Ya=this,gb,ic,kc,Oc,Pc,Rc,Ie,zf,ef,Ee,dh,Cg,ci,Og,Mi;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hf){switch(Hf.nextAddress){case 1:if(!Ya.isUpdating()){Hf.jumpTo(2);
break}return Hf.yield(Ya.whenUpdated(),2);case 2:gb=mc.promise.deferred();ic=gb.promise;kc=!!Ya.target;Ya.updateInProgress=ic;Hf.setCatchFinallyBlocks(4);ua&&(Oc=mc.LoadingIndicator.open("connecting to remote..."));if(!ua){Pc=mc.InspectionTree.forObject(S,Ya);Hf.jumpTo(6);break}return Hf.yield(mc.RemoteInspectionTree.forObject(S,Ya),7);case 7:Pc=Hf.yieldResult;case 6:return Rc=Pc,Ie=Ya.ui.propertyTree,Hf.yield(Rc.collapse(Rc.root,!1),8);case 8:if(!Rc.root.children){Hf.jumpTo(9);break}return Hf.yield(Rc.collapse(Rc.root.children[0],
!1),9);case 9:if(zf=Ya.originalTreeData&&Ya.originalTreeData.diff(Rc)){ef=$jscomp.makeIterator(zf);for(Ee=ef.next();!Ee.done;Ee=ef.next())dh=Ee.value,Cg=$jscomp.makeIterator(dh),ci=Cg.next().value,Og=Cg.next().value,ci.refreshProperty(Og.value);Hf.jumpTo(11);break}Ie.treeData=Rc;return Hf.yield(Ya.filterProperties(),12);case 12:if(!Ie.treeData.root.isCollapsed){Hf.jumpTo(13);break}return Hf.yield(Ie.onNodeCollapseChanged({node:Rc.root,isCollapsed:!1}),14);case 14:Ie.selectedIndex=1;case 13:return Hf.yield(Ie.execCommand("uncollapse selected node"),
11);case 11:Ya.toggleWindowStyle(kc);Oc&&Oc.remove();Hf.leaveTryBlock(5);break;case 4:Mi=Hf.enterCatchBlock(),Ya.showError(Mi);case 5:Ya.startStepping(1E3,"refreshAllProperties"),Ya.updateInProgress=null,Hf.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(S){S=void 0===S?!0:S;var ua=this,Ya,gb,ic,kc,Oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){if(1==Pc.nextAddress)return Ya=300,kc=ua.ui.codeEditor.pluginFind(function(Rc){return Rc.runEval}),Oc=ua.getWindow(),Pc.yield(kc.runEval("System.get('@system-env').node"),
2);Pc.yieldResult.value?(ic=[].concat($jscomp.arrayFromIterable(mc.arr.without(Oc.styleClasses,"local")),["node"]),gb=mc.DarkTheme.instance):(ic=["local"].concat($jscomp.arrayFromIterable(Oc?mc.arr.without(Oc.styleClasses,"node"):[])),gb=mc.DefaultTheme.instance);kc.theme=gb;S?(Oc&&Oc.animate({duration:Ya,styleClasses:ic}),ua.ui.codeEditor.animate({fill:gb.background,duration:Ya})):Oc&&(Oc.styleClasses=ic);ua.ui.codeEditor.textString=ua.ui.codeEditor.textString;kc.highlight();Pc.jumpToEnd()})}},{key:"isUpdating",
value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var S=this,ua=Object.assign({type:"text",borderWidth:1,borderColor:mc.Color.gray,lineWrapping:"by-chars"},mc.config.codeEditor.defaultStyle,{textString:""}),Ya=mc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});mc.rect(0,0,this.width,30);var gb=new mc.SearchField({styleClasses:["idle"],
name:"searchField"});Ya[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[gb,{type:"button",name:"targetPicker",padding:mc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:mc.Icon.textAttribute("crosshairs")},new mc.LabeledCheckBox({label:"Internals",name:"internals"}),new mc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new mc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:mc.InspectionTree.forObject(null,
this)})),mc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},ua),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:mc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Ya),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Ya),[" selection",null])}]}];
this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){S.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var S=this,ua,Ya,gb,ic;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){switch(kc.nextAddress){case 1:if(S.env.eventDispatcher.isKeyPressed("Shift"))return Ya=$jscomp,gb=Ya.makeIterator,kc.yield($world.execCommand("select morph",{justReturn:!0}),
5);S.toggleSelectionInstructions(!0);return kc.yield(mc.InteractiveMorphSelector.selectMorph(),4);case 4:ua=kc.yieldResult;S.toggleSelectionInstructions(!1);kc.jumpTo(3);break;case 5:ic=gb.call(Ya,kc.yieldResult),ua=ic.next().value;case 3:ua&&(S.targetObject=ua),kc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(S){if(S&&!this.instructionWidget){var ua=mc.morph({type:"label",name:"escapeKey",value:"esc"});ua.whenRendered().then(function(){return ua.fit()});this.instructionWidget=
this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},ua,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(S){S=
S.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;S.epiMorph=!0;this.openWidget=S;mc.once(S,"close",this,"closeOpenWidget");mc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var S=this.ui.propertyTree,ua=S.textLayout.boundsFor(S,{column:0,row:S.selectedIndex-1});ua=S.worldPoint(mc.pt(ua.x,ua.y+ua.height/2)).addPt(S.scroll.negated());S=S.globalBounds();ua.x=this.globalBounds().center().x;
ua.y<S.top()?ua=S.topCenter():S.bottom()-20<ua.y&&(ua=S.bottomCenter().addXY(0,-20));return ua}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(S){this.layout.row(1).height+=S.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(S){if(S!==this.isEditorVisible()){var ua=this.extent,
Ya=this.layout,gb=this.ui,ic=gb.terminalToggler,kc=gb.codeEditor,Oc=gb.thisBindingSelector;gb=gb.fixImportButton;Ya.disable();S?(ic.fontColor=mc.Color.rgbHex("00e0ff"),Ya.row(3).height=this.codeEditorHeight||180,Ya.row(2).height=5,gb.animate({visible:!0,duration:200}),Oc.animate({visible:!0,duration:200})):(this.codeEditorHeight=Ya.row(3).height,ic.fontColor=mc.Color.white,Ya.row(3).height=Ya.row(2).height=0,gb.animate({visible:!1,duration:200}),Oc.animate({visible:!1,duration:200}));this.extent=
ua;Ya.enable({duration:200});this.relayout({duration:200});kc.focus();kc.animate({opacity:S?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var S=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){S.makeEditorVisible(!S.isEditorVisible());ua.jumpToEnd()})}},{key:"filterProperties",value:function(){var S=this,ua,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return ua=S.ui.searchField,Ya=S.ui.propertyTree,S.originalTreeData||
(S.originalTreeData=Ya.treeData),mc.disconnect(Ya.treeData,"onWidgetOpened",S,"onWidgetOpened"),gb.yield(Ya.treeData.filter({maxDepth:2,showUnknown:S.ui.unknowns.checked,showInternal:S.ui.internals.checked,iterator:function(ic){return ua.matches(ic.key)}}),2);Ya.update();mc.connect(Ya.treeData,"onWidgetOpened",S,"onWidgetOpened");gb.jumpToEnd()})}},{key:"relayout",value:function(S){S=void 0===S?{}:S;var ua=this,Ya,gb,ic,kc,Oc,Pc,Rc,Ie,zf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ef){ua.layout&&
ua.layout.forceLayout();Ya=ua;gb=Ya.ui;ic=gb.fixImportButton;kc=gb.terminalToggler;Oc=gb.propertyTree;Pc=gb.thisBindingSelector;Rc=Oc.bounds().insetBy(5).bottomLeft();Ie=Oc.bounds().insetBy(5).bottomRight();zf=Ie.subXY(ic.width+10,0);Pc.width=115;Pc.listMorph.itemHeight=20;S.duration?(kc.animate(Object.assign({bottomLeft:Rc},S)),ic.animate(Object.assign({bottomRight:Ie},S)),Pc.animate(Object.assign({bottomRight:zf},S))):(kc.bottomLeft=Rc,ic.bottomRight=Ie,Pc.bottomRight=zf);ef.jumpToEnd()})}},{key:"keybindings",
get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(xb._get(Object.getPrototypeOf(ib.prototype),"keybindings",this))}},{key:"commands",get:function(){return mc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(S){if(System._testsRunning)return console.log(S.targetObject);
S=new this(S);S.openInWindow();return S}},{key:"properties",get:function(){return{extent:{defaultValue:mc.pt(400,500)},fill:{defaultValue:mc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(S){this.setProperty("remoteTarget",S);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(S,!0))}},targetObject:{after:["submorphs"],set:function(S){this._serializableTarget=S&&S.isMorph?S.id:S;
this.setProperty("targetObject",S);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(S))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var S=this.ui.propertyTree,ua=S.treeData;return ua.getContextFor(S.selectedNode||ua.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),
fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},
treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:mc.Color.gray,fontSize:14,fontFamily:mc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],La,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:25364,end:45723})}(mc.Morph);Sd=mc.Inspector;De=ta("I",Sd);mc.default=Sd;var qf=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");qf.Inspector=De;qf.string=Sc;qf.Morph=hc;qf.pt=qd;qf.Color=nb;Sd=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(va,La,ib){ib=void 0===ib?1:ib;var S,ua,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){switch(gb.nextAddress){case 1:return va.maybeSelectCommentOrLine(),
gb.setCatchFinallyBlocks(2),La=Object.assign({},La,{logDoit:!0,inspect:!0,inspectDepth:ib}),gb.yield(va.doEval(void 0,La),4);case 4:S=gb.yieldResult;ua=S.error?S.error:S.isError?S.value:null;gb.leaveTryBlock(3);break;case 2:ua=Ya=gb.enterCatchBlock();case 3:return ua?va.showError(ua):va.setStatusMessage(qf.string.truncate(S.value,1E3)),gb.return(S)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(va,La){var ib,S,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ya){switch(Ya.nextAddress){case 1:return Ya.setCatchFinallyBlocks(2),
Ya.yield(va.doEval({start:{row:0,column:0},end:va.documentEndPosition},Object.assign({},La,{logDoit:!0})),4);case 4:ib=Ya.yieldResult;S=ib.error?ib.error:ib.isError?ib.value:null;Ya.leaveTryBlock(3);break;case 2:S=ua=Ya.enterCatchBlock();case 3:return S?va.showError(S):va.setStatusMessage(String(ib.value)),Ya.return(ib)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(va,La){var ib,S,ua,Ya,gb,ic,kc,Oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){switch(Pc.nextAddress){case 1:return va.maybeSelectCommentOrLine(),
Pc.setCatchFinallyBlocks(2),La=Object.assign({},La,{asString:!1,logDoit:!0}),Pc.yield(va.doEval(void 0,La),4);case 4:ib=Pc.yieldResult;S=ib.error?ib.error:ib.isError?ib.value:null;Pc.leaveTryBlock(3);break;case 2:S=ua=Pc.enterCatchBlock();case 3:va.selection.collapseToEnd();if(Ya=ib.value&&ib.value.isColor)return va.selection.text=String(ib.value),gb=new qf.Morph({fill:qf.Color.transparent,extent:qf.pt(va.fontSize+2,va.fontSize+2),submorphs:[{fill:ib.value,center:qf.pt(va.fontSize+2,va.fontSize+2).scaleBy(.5)}]}),
ic=va.selection.start,kc=ic.column,Oc=ic.row,va.insertText([gb,{}],va.selection.start),va.selection.start={column:kc,row:Oc},va.focus(),Pc.return(ib);va.insertTextAndSelect(S?String(S)+(S.stack?"\n"+S.stack:""):String(ib.value));va.focus();return Pc.return(ib)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(va,La){var ib,S,ua,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){switch(gb.nextAddress){case 1:debugger;
va.maybeSelectCommentOrLine();S=va.textInRange(va.selection);ua=va.evalEnvironment||{};Ya=va.pluginFind(function(ic){return ic.isEditorPlugin&&"function"===typeof ic.runEval});ua.systemInterface||(ua.systemInterface=Ya.systemInterface(La));if("local"!==ua.systemInterface.name){gb.jumpTo(2);break}gb.setCatchFinallyBlocks(3);return gb.yield(va.doEval(void 0,La),5);case 5:ib=gb.yieldResult;S=ib.value;gb.leaveTryBlock(2);break;case 3:gb.enterCatchBlock();case 2:return va.world().execCommand("open object editor",
{target:S,evalEnvironment:ua}),gb.return(ib)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(va,La){var ib,S,ua,Ya,gb,ic;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){switch(kc.nextAddress){case 1:va.maybeSelectCommentOrLine();ua=va.textInRange(va.selection);Ya=va.evalEnvironment||{};gb=va.pluginFind(function(Oc){return Oc.isEditorPlugin&&"function"===typeof Oc.runEval});Ya.systemInterface||(Ya.systemInterface=
gb.systemInterface(La));if("local"!==Ya.systemInterface.name){qf.Inspector.openInWindow({remoteTarget:{code:ua,evalEnvironment:Ya}});kc.jumpTo(2);break}kc.setCatchFinallyBlocks(3);return kc.yield(va.doEval(void 0,La),5);case 5:ib=kc.yieldResult;S=ib.error?ib.error:ib.isError?ib.value:null;ua=ib.value;kc.leaveTryBlock(4);break;case 3:S=ic=kc.enterCatchBlock();case 4:qf.Inspector.openInWindow({targetObject:S||ua});case 2:return kc.return(ib)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(va,La,ib){ib=void 0===ib?1:ib;var S;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){switch(ua.nextAddress){case 1:return va.maybeSelectCommentOrLine(),ua.setCatchFinallyBlocks(2),La=Object.assign({},La,{inspect:!0,inspectDepth:ib,logDoit:!0}),ua.yield(va.doEval(void 0,La),4);case 4:S=ua.yieldResult;ua.leaveTryBlock(3);break;case 2:ua.enterCatchBlock();case 3:return va.selection.collapseToEnd(),va.insertTextAndSelect(S.value),ua.return(S)}})}}];qf.codeEvaluationCommands=
Sd;qf.codeEvaluationCommands=Sd;qf.codeEvaluationCommands=Sd;var sf=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");sf.changeAttributeInSelectionOrMorph=function(va,La,ib){var S=va.selection;va.keepPosAtSameScrollOffsetWhile(function(){S.isEmpty()?va[La]="function"===typeof ib?ib(va[La]):ib:(va.undoManager.group(),va.changeStyleProperty(La,function(ua){return"function"===typeof ib?ib(ua):ib}),va.undoManager.group())})};De=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(va){var La=va.fontSize;sf.changeAttributeInSelectionOrMorph(va,"fontSize",function(ib){ib=ib||La;return ib+(18<=ib?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(va){var La=va.fontSize;sf.changeAttributeInSelectionOrMorph(va,"fontSize",function(ib){ib=ib||La;return ib-(18>=ib?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(va){var La,ib,S,ua,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress){La=
["serif","sans-serif","monospace"];if(ib=localStorage["lively.morpic/text-change-font-additional-fonts"])ib=JSON.parse(ib),La.push.apply(La,$jscomp.arrayFromIterable(ib));La.map(function(ic){return ic.toLowerCase()}).includes(va.fontFamily.toLowerCase())||(La.push(va.fontFamily),ib=[].concat($jscomp.arrayFromIterable(ib||[]),[va.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(ib));return gb.yield($world.editListPrompt("choose font",La,{requester:va,preselect:La.indexOf(va.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}S=gb.yieldResult;ua=$jscomp.makeIterator(S.selections);if(Ya=ua.next().value)va.fontFamily=Ya;return gb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(va,La){La=void 0===La?{}:La;var ib,S,ua,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress){if(La.hasOwnProperty("link"))return gb.jumpTo(2);S=va.selection;ua=va.getStyleInRange(S);Ya=ua.link;return gb.yield(va.world().prompt("Set link",
{input:Ya||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=gb.nextAddress&&(ib=gb.yieldResult,!ib))return gb.return();va.undoManager.group();va.setStyleInRange({link:ib||void 0},S);va.undoManager.group();gb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(va,La){var ib,S,ua,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return ib=va.selection,S=va.getStyleInRange(ib),ua=S.doit,gb.yield(va.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:va,input:ua?ua.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:va.evalEnvForDoit(ua||{})}),2);Ya=gb.yieldResult;va.undoManager.group();Ya?va.addTextAttribute({doit:{code:Ya},nativeCursor:"pointer",textDecoration:"underline"},ib):va.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},ib);va.undoManager.group();gb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(va,La){La=void 0===La?{}:La;va.undoManager.group();
La=!La.onlySelection&&va.selection.isEmpty()?va.documentRange:va.selection.range;va.setStyleInRange(null,La);va.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(va){var La,ib,S,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ya){if(1==Ya.nextAddress)return Ya.yield(System.import("lively.modules"),2);if(3!=Ya.nextAddress)return La=Ya.yieldResult,ib=La.module,Ya.yield(ib("lively.ide/text/ui.js").load(),3);S=Ya.yieldResult;ua=S.RichTextControl;return Ya.return(ua.openFor(va))})}}];
sf.commands=De;sf.commands=De;sf.commands=De;var pe=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");pe.guessTextModeName=kb;pe.rangedToken=function(va,La,ib,S,ua){return{start:{row:va,column:La},end:{row:va,column:ib},token:S,mode:ua}};pe.fun=dc;pe.arr=Ob;pe.connect=Fc;pe.disconnect=ub;pe.DefaultTheme=tb;pe.tokenizeDocument=$a;pe.modeInfo=oa;pe.visitDocumentTokens=tc;pe.getMode=Lb;pe.completionCommands=ma;pe.multiSelectCommands=gc;pe.navCommands=yd;pe.codeCommands=ve;pe.codeEvaluationCommands=
Sd;pe.richTextCommands=De;pe.Color=nb;pe.Range=Jd;pe.guessTextModeName=kb;pe.guessTextModeName=kb;tb=function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),ib=La.hasOwnProperty("EditorPlugin")&&"function"===typeof La.EditorPlugin?La.EditorPlugin:La.EditorPlugin=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
pe.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(S){var ua=this;this.textMorph=S;pe.connect(S,"textChange",this,"onTextChange");pe.connect(S,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return ua.highlight()})}},
{key:"detach",value:function(S){pe.disconnect(S,"textChange",this,"onTextChange");pe.disconnect(S,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(S){this._ast=null;if(S){var ua=this._tokenizerValidBefore;if("replace"===S.selector){var Ya=S.args[0].start;S=Ya.row;Ya=Ya.column}else Ya=S=0;if(!ua||S<ua.row||S===ua.row&&Ya<ua.column)S=Math.max(0,S),this._tokenizerValidBefore={row:S,column:Ya}}this.requestHighlight()}},
{key:"requestHighlight",value:function(S){var ua=this;(void 0===S?0:S)?this.highlight():pe.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return ua.highlight()})()}},{key:"highlight",value:function(){var S=this.textMorph,ua=this.theme,Ya=this.mode,gb=this._tokenizerValidBefore;if(ua&&S&&S.document&&Ya){S.fill=ua.background;S.cursorColor=ua.cursorColor||pe.Color.black;var ic=S.viewState,kc={};gb=pe.tokenizeDocument(Ya,S.document,ic.firstVisibleRow,ic.lastVisibleRow,gb);Ya=gb.lines;gb=
gb.tokens;if(Ya.length){ic=Ya[0].row;for(var Oc=[],Pc=0;Pc<gb.length;ic++,Pc++)for(var Rc=gb[Pc],Ie=0;Ie<Rc.length;Ie+=5){var zf=Rc[Ie],ef=Rc[Ie+1],Ee=ua[Rc[Ie+2]]||ua.default;Ee&&Oc.push({start:{row:ic,column:zf},end:{row:ic,column:ef}},Ee)}S.embeddedMorphs.forEach(function(dh){var Cg=S.embeddedMorphMap.get(dh).anchor;kc[dh.id]=S.textAttributeAt(Cg.position)});S.setTextAttributesWithSortedRanges(Oc);S.embeddedMorphs.forEach(function(dh){var Cg=S.embeddedMorphMap.get(dh).anchor;Cg=pe.Range.at(Cg.position);
Cg.end.column+=1;S.replace(Cg,[dh,kc[dh.id]],!1)});this._tokenizerValidBefore={row:pe.arr.last(Ya).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},S,this)}}},{key:"visitTokensInRange",value:function(S,ua){var Ya=S.start,gb=S.end,ic=Ya.row-1;pe.visitDocumentTokens(this.mode,this.textMorph.document,Ya.row,gb.row,null,function(kc){return ic++},function(kc,Oc,Pc,Rc,Ie,zf,ef){if(ic===Ya.row&&0<Ya.column){if(Ya.column>=Rc)return;Pc<Ya.column&&Ya.column<Rc&&(Pc=Ya.column)}if(ic===gb.row){if(gb.column<=
Pc)return;Pc<gb.column&&gb.column<Rc&&(Rc=gb.column)}ua(kc,Oc,ic,Pc,Rc,Ie,zf,ef)})}},{key:"tokensInRange",value:function(S){var ua=[];this.visitTokensInRange(S,function(Ya,gb,ic,kc,Oc,Pc,Rc,Ie){return ua.push(pe.rangedToken(ic,kc,Oc,Ya,Ie))});return ua}},{key:"tokensOfRow",value:function(S){var ua=this.textMorph.getLine(S).length;return this.tokensInRange({start:{row:S,column:0},end:{row:S,column:ua}})}},{key:"tokenAt",value:function(S){for(var ua=this.tokensOfRow(S.row),Ya=ua.length;Ya--;){var gb=
ua[Ya];if(gb.token&&gb.start.column<=S.column&&S.column<=gb.end.column)return gb}return null}},{key:"getCommands",value:function(S){return[].concat($jscomp.arrayFromIterable(S),$jscomp.arrayFromIterable(pe.completionCommands),$jscomp.arrayFromIterable(pe.multiSelectCommands),$jscomp.arrayFromIterable(pe.navCommands),$jscomp.arrayFromIterable(pe.codeCommands),$jscomp.arrayFromIterable(pe.codeEvaluationCommands),$jscomp.arrayFromIterable(pe.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var S=this.mode,ua=S.lineComment,Ya=S.blockCommentStart;S=S.blockCommentEnd;var gb={};ua&&(gb.lineCommentStart=ua);Ya&&(gb.blockCommentStart=Ya);S&&(gb.blockCommentEnd=S);return gb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(S,ua,Ya){var gb=this.textMorph,ic=S.row,kc=S.column;S=ua[kc-1];ua=ua[kc];gb.selection.text="\n";gb.selection.collapseToEnd();"{"===S&&"}"===ua&&(gb.selection.text="\n"+" ".repeat(Ya),gb.selection.collapse());
gb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:ic+1,lastRow:ic+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var S=this.textMorph,ua=this.openPairs,Ya=S.selection,gb=S.getLine(Ya.end.row),ic=gb[Ya.end.column-1];gb=gb[Ya.end.column];S.autoInsertPairs&&Ya.isEmpty()&&ic in
ua&&gb===ua[ic]&&(Ya.growRight(1),Ya.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(S){var ua=this.openPairs,Ya=this.closePairs,gb=this.textMorph,ic=gb.selection,kc=gb.autoInsertPairs&&S in ua,Oc=gb.autoInsertPairs&&S in Ya;if(!kc&&!Oc)return!1;var Pc=gb.getLine(ic.end.row)[ic.end.column];if(!ic.isEmpty()){if(!kc)return!1;Ya=gb.undoManager.ensureNewGroup(gb);gb.insertText(ua[S],ic.end);gb.insertText(S,ic.start);gb.undoManager.group(Ya);ic.growRight(-1);return!0}if(Pc in Ya&&S===Pc)return ic.goRight(1),
!0;if(Oc&&!kc)return!1;Ya=gb.undoManager.ensureNewGroup(gb);gb.insertText(S+ua[S]);gb.undoManager.group(Ya);ic.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],La,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);
oa=tb=pe.EditorPlugin;ma=ta("C",function(va){var La=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),ib=La.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof La.CodeMirrorEnabledEditorPlugin?La.CodeMirrorEnabledEditorPlugin:La.CodeMirrorEnabledEditorPlugin=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return xb(ib,va,[{key:Symbol.for("lively-instance-initialize"),value:function(){xb._get(Object.getPrototypeOf(ib.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(S){this.mode=this.codeMirrorMode(S);return xb._get(Object.getPrototypeOf(ib.prototype),"attach",this).call(this,S)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(S){return{indentWithTabs:!S.useSoftTabs,indentUnit:S.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(S){S=this.defaultCodeMirrorModeConfig(S);
return pe.getMode(S,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],La,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(pe.EditorPlugin));pe.CodeMirrorEnabledEditorPlugin=ma;pe.CodeMirrorEnabledEditorPlugin=
ma;pe.CodeMirrorEnabledEditorPlugin=ma;pe.default=tb;tb=Object.freeze({__proto__:null,guessTextModeName:kb,"default":oa,CodeMirrorEnabledEditorPlugin:ma});ta("e",tb)}}});
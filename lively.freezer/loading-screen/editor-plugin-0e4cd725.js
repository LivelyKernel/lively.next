System.register(["./__root_module__-2cc1f5a8.js","./index-c23d9181.js","./index-43553434.js"],function(ya){var wb,Ab,ac,Ob,kd,Cc,qd,Dc,Ic,Qc,Bd,ne,ve,Wd,Tb,wc,od,Ub,xd,Gd,lc,rc,Kb,qc,Hc,ad,dd,fc,jb,yb,Ja,Ta,Ka,Fa,Xa,Hb,ic,lb,tb,nb,Y,Ba,P,na,Sa;return{setters:[function(hb){wb=hb.C;Ab=hb.aw;ac=hb.a6;Ob=hb.a1;kd=hb.a3;Cc=hb.ab;qd=hb.bj;Dc=hb.aZ;Ic=hb.au;Qc=hb.a7;Bd=hb.aR;ne=hb.bn;ve=hb.bo;Wd=hb.a8;Tb=hb.aj;wc=hb.at;od=hb.av;Ub=hb.bp;xd=hb.bq;Gd=hb.a2;lc=hb.P;rc=hb.$;Kb=hb.aY;qc=hb.an;Hc=hb.ao;ad=
hb.ap;dd=hb.aq;fc=hb.aD;jb=hb.b0;yb=hb.az;Ja=hb.as;Ta=hb.ad;Ka=hb.br;Fa=hb.L;Xa=hb.bs;Hb=hb.b5;ic=hb.bk;lb=hb.b4;tb=hb.bt;nb=hb.ax},function(hb){Y=hb.M;Ba=hb.I;P=hb.v;na=hb.p},function(hb){Sa=hb.localInterface}],execute:function(){function hb(Ha,Ya){if(!0===Ya)return Ya;if(Ha.copyState)return Ha.copyState(Ya);Ha={};for(var Bb in Ya){var V=Ya[Bb];V instanceof Array&&(V=V.concat([]));Ha[Bb]=V}return Ha}function cc(Ha,Ya,Bb){return Ha.startState?Ha.startState(Ya,Bb):!0}function Uc(Ha,Ya){return Ib.modes[Ha]=
Ya}function Xb(Ha){if("string"==typeof Ha&&Ib.mimeModes.hasOwnProperty(Ha))Ha=Ib.mimeModes[Ha];else if(Ha&&"string"==typeof Ha.name&&Ib.mimeModes.hasOwnProperty(Ha.name)){var Ya=Ib.mimeModes[Ha.name];"string"==typeof Ya&&(Ya={name:Ya});Ha=Object.assign({},Ya,Ha);Ha.name=Ya.name}else{if("string"==typeof Ha&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ha))return Xb("application/xml");if("string"==typeof Ha&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ha))return Xb("application/json")}return"string"==typeof Ha?{name:Ha}:Ha||
{name:"null"}}function Db(Ha,Ya){Ya=Ib.resolveMode(Ya);"string"===typeof Ya&&(Ya={name:Ya});if(!Ya.name)throw Error("parserConfig does not have a name of the mode to get");var Bb=Ib.modes[Ya.name];if(!Bb)return Db(Ha,"text/plain");Ha=Object.assign({indentUnit:2},Ha);return Object.assign(Bb(Ha,Ya),{name:Ya.name})}function vd(Ha,Ya){for(var Bb;Ha.innerMode;){Bb=Ha.innerMode(Ya);if(!Bb||Bb.mode==Ha)break;Ya=Bb.state;Ha=Bb.mode}return Bb||{mode:Ha,state:Ya}}function bd(Ha,Ya){Ib.mimeModes[Ha]=Ya}function cb(Ha,
Ya,Bb){}function xb(Ha,Ya,Bb,V,Da,fb,rb){var kc=Ha.editorPlugin._tokenizerValidBefore;kc&&kc.row>=Bb&&(kc.row=Bb-1);var gc=Ib.linesToTokenize(Ha.document,Bb,V,kc);kc=gc.lines;gc=gc.state;if(!kc.length)return!1;gc=gc?Ib.copyState(Ya,gc):Ib.startState(Ya);for(var Lc=0;Lc<kc.length;Lc++){var Sc=kc[Lc],Mc=Sc.row;Mc>=Bb&&Mc<=V&&Ib.indentLine(Ha,Ya,Sc,gc,Da,fb,rb);gc=Ib.tokenizeLine(Ya,kc[Lc],gc,function(){})}return!0}function Bc(Ha,Ya,Bb,V,Da,fb,rb){Ya=Ib.linesToTokenize(Ya,Bb,V,Da);Bb=Ya.lines;Ib.tokenizeLines(Ha,
Bb,Ya.state,fb,rb);return Bb}function mb(Ha,Ya,Bb,V,Da){var fb=[],rb,kc=function(Sc){return fb.push(rb=[])},gc=function(Sc,Mc,Ae,rf,Ze,Eg,He){return rb.push(Ae,rf,Sc,Ze.current(),Mc.localMode||He)};try{var Lc=Ib.visitDocumentTokens(Ha,Ya,Bb,V,Da,kc,gc)}catch(Sc){fb.length=0,Lc=Ib.visitDocumentTokens(Ha,Ya,Bb,V,null,kc,gc)}return{tokens:fb,lines:Lc}}function Ec(Ha,Ya,Bb,V,Da){null==Ya&&(Ya=Ha.search(/[^\s\u00a0]/),-1==Ya&&(Ya=Ha.length));V=V||0;for(Da=Da||0;;){var fb=Ha.indexOf("\t",V);if(0>fb||fb>=
Ya)return Da+(Ya-V);Da+=fb-V;Da+=Bb-Da%Bb;V=fb+1}}function Ac(Ha){Ha=Ha.toLowerCase();for(var Ya=0;Ya<Ib.modeInfo.length;Ya++){var Bb=Ib.modeInfo[Ya];if(Bb.mime==Ha)return Bb;if(Bb.mimes)for(var V=0;V<Bb.mimes.length;V++)if(Bb.mimes[V]==Ha)return Bb}if(/\+xml$/.test(Ha))return Ac("application/xml");if(/\+json$/.test(Ha))return Ac("application/json")}function ab(Ha){for(var Ya=0;Ya<Ib.modeInfo.length;Ya++){var Bb=Ib.modeInfo[Ya];if(Bb.ext)for(var V=0;V<Bb.ext.length;V++)if(Bb.ext[V]==Ha)return Bb}}
function La(Ha){for(var Ya=0;Ya<Ib.modeInfo.length;Ya++){var Bb=Ib.modeInfo[Ya];if(Bb.file&&Bb.file.test(Ha))return Bb}Ya=Ha.lastIndexOf(".");if(Ha=-1<Ya&&Ha.substring(Ya+1,Ha.length))return Ib.findModeByExtension(Ha)}function gb(Ha){Ha=Ha.toLowerCase();for(var Ya=0;Ya<Ib.modeInfo.length;Ya++){var Bb=Ib.modeInfo[Ya];if(Bb.name.toLowerCase()==Ha)return Bb;if(Bb.alias)for(var V=0;V<Bb.alias.length;V++)if(Bb.alias[V].toLowerCase()==Ha)return Bb}}function Va(Ha){if(!Ha)return String(Ha);if(Array.isArray(Ha))return"["+
Ha.map(Va).join(",")+"]";if("symbol"===typeof Ha)return Tc.printSymbol(Ha);try{return String(Ha)}catch(Ya){return"Cannot print object: "+Ya}}function tc(Ha,Ya){return!Tc.arr.every(Ya.map(function(Bb){return Ha[Bb]}),function(Bb){return Tc.obj.equals(Bb,Ha&&Ha.valueOf())})}function ia(Ha){if(Tc.obj.isPrimitive(Ha))var Ya=Tc.string.print(Ha);else Array.isArray(Ha)?((Ya=3<Ha.length)&&(Ha=Ha.slice(0,3)),Ha=Tc.string.print(Ha),Ya&&(Ha=Ha.slice(0,-1)+", ...]"),Ya=Ha):Ya=Tc.string.print(Ha);Ya=Ya.replace(/\n/g,
"");500<Ya.length&&(Ya=Ya.slice(0,20)+("...["+(Ya.length-20)+' CHARS]"'));return Ya}function va(Ha){return Zb.Inspector.openInWindow({targetObject:Ha})}function qb(Ha,Ya){return Zb.Inspector.openInWindow({remoteTarget:{code:Ha,evalEnvironment:Ya}})}function I(Ha,Ya){function Bb(kc){var gc=kc.name,Lc=kc.ownerChain(),Sc=kc.owner,Mc=kc.world(),Ae;kc===fb&&(Ae=[rb]);Mc===kc&&(Ae=["$world"]);if(!Ae&&gc&&Sc){Sc===Mc&&1===Zb.arr.count(Zb.arr.pluck(Mc.submorphs,"name"),gc)&&(Ae=['$world.get("'+gc+'")']);
if(!Ae&&Sc!=Mc)for(Mc=Lc.length-1;Mc--;)if(1===Lc[Mc].getAllNamed(gc).length){Ae=[].concat($jscomp.arrayFromIterable(Bb(Lc[Mc])),['get("'+gc+'")']);break}Ae||(gc=[].concat($jscomp.arrayFromIterable(Bb(Sc)),['get("'+gc+'")']),Zb.syncEval(gc.join("."),{context:fb}).value===kc&&(Ae=gc))}Ae||(Ae=[rb+'.getMorphById("'+kc.id+'")']);return Ae}Ya=void 0===Ya?{}:Ya;var V=Ha.world(),Da=Ya;Ya=void 0===Da.maxLength?10:Da.maxLength;var fb=void 0===Da.fromMorph?V:Da.fromMorph;if(fb===Ha)return"this";var rb=V===
fb?"$world":"this";if(!(V||Ha.name&&fb.get(Ha.name)===Ha))return"morph";V=Bb(Ha);return V.length>Ya?'$world.getMorphWithId("'+Ha.id+'")':V.join(".")}function pa(Ha,Ya,Bb){var V=(Ya=void 0===Ya?"":Ya)&&Re.arr.last(Ya.split(".")).toLowerCase(),Da="",fb=0,rb=Math.pow(2,19);if("string"===typeof Ha){if(Ha.length>rb)return null}else if(Ha.document.stringSize>rb)return null;if("string"===typeof Ha)Da=Ha.slice(0,1E3);else for(Ha=$jscomp.makeIterator(Ha.document.lines),rb=Ha.next();!rb.done;rb=Ha.next()){var kc=
rb.value;rb=kc.stringSize;kc=kc.text;var gc=!0;1E3<fb+rb&&(gc=!1,rb=1E3-fb);Da+=kc.slice(0,rb)+(gc?"\n":"");fb+=rb;if(1E3<=fb)break}fb=$jscomp.makeIterator(Re.modeInfo);for(Ha=fb.next();!Ha.done;Ha=fb.next()){gc=Ha.value;rb=gc.contentTest;Ha=gc.mode;kc=gc.ext;gc=gc.file;if("function"===typeof rb)try{if(rb(Da))return Ha}catch(Lc){}if(gc&&gc instanceof RegExp&&gc.test(Ya))return Ha;if(kc)for(rb=$jscomp.makeIterator(kc),kc=rb.next();!kc.done;kc=rb.next())if(kc.value===V)return Ha}return Bb}ya({a:bd,
d:Uc,r:cb});var Qa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");Qa.Color=wb;var ub=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Bb=Ya.hasOwnProperty("DefaultTheme")&&"function"===typeof Ya.DefaultTheme?Ya.DefaultTheme:Ya.DefaultTheme=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:"background",get:function(){return Qa.Color.white}},{key:"default",
get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Qa.Color.white,fontWeight:"bold",backgroundColor:Qa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Qa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Qa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ya,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Wb=ub=Qa.DefaultTheme;Qa.default=ub;var Ib=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");Ib.copyState=hb;Ib.startState=cc;Ib.defineMode=Uc;Ib.resolveMode=Xb;Ib.getMode=Db;Ib.innerMode=vd;Ib.defineMIME=bd;Ib.registerHelper=cb;Ib.indentLines=xb;Ib.indentLine=function(Ha,Ya,Bb,V,Da,fb,rb){rb=Object.assign({indentWithTabs:!Ha.useSoftTabs,indentUnit:Ha.tabWidth,tabSize:4,ignoreFollowingText:!1},
rb);null==Da&&(Da="add");"smart"==Da&&(Ya.indent||(Da="prev"));var kc=rb.tabSize,gc=Bb.text,Lc=Ib.countColumn(gc,null,kc);Bb.modeState&&(Bb.modeState=null);var Sc=gc.match(/^\s*/)[0];if(!fb&&!/\S/.test(gc)){var Mc=0;Da="not"}else if("smart"==Da&&(Mc=Ya.indent(V,rb.ignoreFollowingText?"":gc.slice(Sc.length),gc),Mc==Ib.passIndent||150<Mc)){if(!fb)return;Da="prev"}"prev"==Da?Mc=0<Bb.row?Ib.countColumn(Bb.prevLine().text,null,kc):0:"add"==Da?Mc=Lc+rb.indentUnit:"subtract"==Da?Mc=Lc-rb.indentUnit:"number"==
typeof Da&&(Mc=Lc+Da);Mc=Math.max(0,Mc);Ya="";V=0;if(rb.indentWithTabs)for(rb=Math.floor(Mc/kc);rb;--rb)V+=kc,Ya+="\t";V<Mc&&(Ya+=" ".repeat(Mc-V));if(Ya!=Sc)return Ha.replace({start:{row:Bb.row,column:0},end:{row:Bb.row,column:Sc.length}},Ya),!0};Ib.tokenizeLines=function(Ha,Ya,Bb,V,Da){if(Ya.length){Bb=Bb?Ib.copyState(Ha,Bb):Ib.startState(Ha);for(var fb=0;fb<Ya.length;fb++){var rb=Ya[fb];V(rb);Bb=Ib.tokenizeLine(Ha,rb,Bb,Da)}}};Ib.tokenizeLine=function(Ha,Ya,Bb,V){var Da=Ya.text;if(!Da)return Bb;
var fb=new Ib.StringStream(Da,2);Bb=Ya.modeState="function"===typeof Ha.copyState?Ha.copyState(Bb):Ib.copyState(Ha,Bb);Ya.prevLine();for(Bb._string=Da;!fb.eol();)Da=Ha.token(fb,Bb),V(Da,Bb,fb.start,fb.pos,fb,Ya,Ha),fb.start=fb.pos;return Bb};Ib.printTokens=function(Ha){for(var Ya="",Bb=0;Bb<Ha.length;Bb+=5)Ya+=Ha[Bb+0]+" => "+Ha[Bb+1]+" "+Ha[Bb+2]+" "+Ha[Bb+3]+" "+Ha[Bb+4].name+"\n";return Ya};Ib.visitDocumentTokens=Bc;Ib.tokenizeDocument=mb;Ib.linesToTokenize=function(Ha,Ya,Bb,V){if(V&&V.row>=Bb)return{lines:[],
state:null};Ya=V?Math.max(0,V.row-1):Ya;var Da=Ha.getLine(Ya),fb=Da.text;Ha=[Da];V=null;for(var rb=0,kc;(kc=Da.prevLine())&&50>rb++;){Da=kc;if(Da.modeState){V=Da.modeState;break}Ha.unshift(Da)}if(!V){for(var gc=Da,Lc=Infinity;(kc=Da.prevLine())&&100>rb++;){Da=kc;if(Da.modeState){V=Da.modeState;break}Ha.unshift(Da);kc=fb.match(/^\s*/)[0].length;if(0===kc)break;kc<Lc&&(Lc=kc,gc=Da)}!V&&0<Lc&&(Ha=Ha.slice(Ha.indexOf(gc)))}if(Bb>Ya)for(Da=Ib.arr.last(Ha);Ya<=Bb;Ya++){Da=Da.nextLine();if(!Da)break;Ha.push(Da)}return{lines:Ha,
state:V}};Ib.countColumn=Ec;Ib.findModeByMIME=Ac;Ib.findModeByExtension=ab;Ib.findModeByFileName=La;Ib.findModeByName=gb;Ib.arr=ac;ub=Ib.modes||{};Ib.modes=ub;Ib.modes=ub;Ib.modes=ub;ub=ya("p",{});Ib.passIndent=ub;Ib.passIndent=ub;Ib.passIndent=ub;Ib.copyState=hb;Ib.copyState=hb;Ib.startState=cc;Ib.startState=cc;Ib.defineMode=Uc;Ib.defineMode=Uc;Ib.resolveMode=Xb;Ib.resolveMode=Xb;Ib.getMode=Db;Ib.getMode=Db;Ib.innerMode=vd;Ib.innerMode=vd;ub={};Ib.mimeModes=ub;Ib.mimeModes=ub;Ib.mimeModes=ub;Ib.defineMIME=
bd;Ib.defineMIME=bd;Ib.registerHelper=cb;Ib.registerHelper=cb;Ib.indentLines=xb;Ib.indentLines=xb;Ib.visitDocumentTokens=Bc;Ib.visitDocumentTokens=Bc;Ib.tokenizeDocument=mb;Ib.tokenizeDocument=mb;Ib.countColumn=Ec;Ib.countColumn=Ec;(function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Bb=Ya.hasOwnProperty("StringStream")&&"function"===typeof Ya.StringStream?Ya.StringStream:Ya.StringStream=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ab(Bb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(V,Da){this.reset(V,Da)}},{key:"reset",value:function(V,Da){this.pos=this.start=0;this.string=void 0===V?"":V;this.tabSize=void 0===Da?2:Da;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",
value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(V){var Da=this.string.charAt(this.pos);if("string"==typeof V?Da==V:Da&&(V.test?V.test(Da):V(Da)))return++this.pos,Da}},{key:"eatWhile",value:function(V){for(var Da=this.pos;this.eat(V););return this.pos>Da}},{key:"eatSpace",value:function(){for(var V=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>V}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},
{key:"skipTo",value:function(V){V=this.string.indexOf(V,this.pos);if(-1<V)return this.pos=V,!0}},{key:"backUp",value:function(V){this.pos-=V}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=Ib.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?Ib.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return Ib.countColumn(this.string,
null,this.tabSize)-(this.lineStart?Ib.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(V,Da,fb){if("string"==typeof V){var rb=function(gc){return fb?gc.toLowerCase():gc},kc=this.string.substr(this.pos,V.length);if(rb(kc)==rb(V))return!1!==Da&&(this.pos+=V.length),!0}else{if((V=this.string.slice(this.pos).match(V))&&0<V.index)return null;V&&!1!==Da&&(this.pos+=V[0].length);return V}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},
{key:"hideFirstChars",value:function(V,Da){this.lineStart+=V;try{return Da()}finally{this.lineStart-=V}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],Ya,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);ub=[{name:"APL",mime:"text/apl",
mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),
alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",
mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",
mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ha){return Ha.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",
mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",
mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",
mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",
mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",
mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},
{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",
mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",
mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p",
"pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",
ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},
{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",
mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Ha){return Ha.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},
{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},
{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",
mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",
mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",
ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml",
"text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];Ib.modeInfo=ub;Ib.modeInfo=ub;Ib.modeInfo=ub;for(var yc=0;yc<Ib.modeInfo.length;yc++)Ib.info=Ib.modeInfo[yc],Ib.info.mimes&&(Ib.info.mime=Ib.info.mimes[0]);Ib.defineMode("null",function(){return{token:function(Ha){return Ha.skipToEnd()}}});
Ib.defineMIME("text/plain","null");Ib.findModeByMIME=Ac;Ib.findModeByMIME=Ac;Ib.findModeByExtension=ab;Ib.findModeByExtension=ab;Ib.findModeByFileName=La;Ib.findModeByFileName=La;Ib.findModeByName=gb;Ib.findModeByName=gb;var Jc=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Jc.Color=wb;Jc.Rectangle=Ob;Jc.pt=kd;Jc.morph=Cc;Jc.ShadowObject=qd;Jc.StyleSheet=Dc;Jc.connect=Ic;Jc.arr=ac;Jc.string=Qc;Jc.FilterableList=Bd;Jc.Range=ne;yc=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
Bb=Ya.hasOwnProperty("Completer")&&"function"===typeof Ya.Completer?Ya.Completer:Ya.Completer=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],Ya,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);Jc.Completer=yc;Jc.Completer=yc;Jc.Completer=yc;yc=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Bb=Ya.hasOwnProperty("WordCompleter")&&"function"===typeof Ya.WordCompleter?Ya.WordCompleter:Ya.WordCompleter=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:"compute",
value:function(V,Da){var fb=[],rb=[],kc=V.document.lineStrings;V=V.cursorPosition.row;for(var gc=V-1;0<=gc;gc--)for(var Lc=$jscomp.makeIterator(kc[gc].split(/[^0-9a-z@_]+/i)),Sc=Lc.next();!Sc.done;Sc=Lc.next())(Sc=Sc.value)&&!fb.includes(Sc)&&Sc!==Da&&(fb.push(Sc),rb.push({priority:1E3-(V-gc),completion:Sc}));for(gc=V+1;gc<kc.length;gc++)for(Lc=$jscomp.makeIterator(kc[gc].split(/[^0-9a-z_@]+/i)),Sc=Lc.next();!Sc.done;Sc=Lc.next())(Sc=Sc.value)&&!fb.includes(Sc)&&Sc!==Da&&(fb.push(Sc),rb.push({priority:1E3-
(gc-V),completion:Sc}));return rb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Ya,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);Jc.WordCompleter=yc;Jc.WordCompleter=yc;Jc.WordCompleter=yc;yc=[new Jc.WordCompleter];Jc.defaultCompleters=
yc;Jc.defaultCompleters=yc;Jc.defaultCompleters=yc;yc=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Bb=Ya.hasOwnProperty("CompletionController")&&"function"===typeof Ya.CompletionController?Ya.CompletionController:Ya.CompletionController=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(V,Da){Da=void 0===
Da?[]:Da;this.textMorph=V;this.completers=Da=V.pluginCollect("getCompleters",Da)}},{key:"computeCompletions",value:function(V){var Da=this,fb,rb,kc,gc,Lc,Sc,Mc,Ae,rf,Ze,Eg,He,Cg,Ji,Pg,ek;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cf){switch(Cf.nextAddress){case 1:fb=[],rb=$jscomp.makeIterator(Da.completers),kc=rb.next();case 2:if(kc.done){Cf.jumpTo(4);break}gc=kc.value;Cf.setCatchFinallyBlocks(5);Lc=fb;Sc=Lc.concat;return Cf.yield(gc.compute(Da.textMorph,V),7);case 7:fb=Sc.call(Lc,
Cf.yieldResult);Cf.leaveTryBlock(3);break;case 5:Mc=Cf.enterCatchBlock(),console.warn("Error in completer "+gc+": "+(Mc.stack||Mc));case 3:kc=rb.next();Cf.jumpTo(2);break;case 4:Ae=new Map;fb.forEach(function(Ai){var Eh=Ae.get(Ai.completion);Eh||(Eh=[],Ae.set(Ai.completion,Eh));Eh.push(Ai)});rf=[];Ze=$jscomp.makeIterator(Ae.values());for(Eg=Ze.next();!Eg.done;Eg=Ze.next())He=Eg.value,rf.push(Jc.arr.last(Jc.arr.sortByKey(He,"priority")));Cg=0;Ji=Jc.arr.sortByKey(rf,"priority").reverse();Pg=Ji.length&&
Ji[0].priority||0;ek=Ji.map(function(Ai){Ai.highestPriority=Pg;var Eh=Ai.completion.replace(/\n/g,""),hj=String((Ai.info||"").replace(/\n/g,""));Cg=Math.max(Cg,Eh.length+hj.length);return{isListItem:!0,string:Eh,annotation:hj,value:Ai}});return Cf.return({items:ek,maxCol:Cg})}})}},{key:"computeSortedCompletions",value:function(V,Da){Da=void 0===Da?!1:Da;var fb=this,rb,kc,gc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lc){if(1==Lc.nextAddress)return rb={tokens:[V],lowercasedTokens:[V],
input:V},Lc.yield(fb.computeCompletions(V),2);kc=Lc.yieldResult;gc=Jc.arr.sortBy(kc.items.filter(function(Sc){return fb.filterFunction(rb,Sc,Da)}),function(Sc){return fb.sortFunction(rb,Sc)});return Lc.return(gc)})}},{key:"_printCompletions",value:function(V){var Da=this,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){if(1==rb.nextAddress)return rb.yield(Da.computeSortedCompletions(V),2);fb=rb.yieldResult.map(function(kc){return{completion:kc.value.completion,priority:kc.value.priority,
maxP:kc.value.highestPriority,sortVal:kc._cache[V].sortVal,lev:JSON.stringify(kc._cache[V].levenshtein)}});return rb.return(Jc.string.printTable(lively.lang.grid.tableFromObjects(fb)))})}},{key:"prefix",value:function(){var V=this.textMorph,Da=V.selection;return(Da.isEmpty()?V.getLine(Da.lead.row).slice(0,Da.lead.column):Da.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(V,Da,fb){fb=void 0===fb?!1:fb;Da._cache||(Da._cache={});var rb=V.tokens,kc=V.lowercasedTokens,gc=V.input;
gc=Da._cache[gc]||(Da._cache[gc]={});if(gc.hasOwnProperty("filtered"))return gc.filtered;Da=Da.value.completion.replace(/\([^\)]*\)$/,"");var Lc=Da.toLowerCase();if(fb&&rb[0]&&!Da.startsWith(rb[0]))return gc.filtered=!1;if(kc.every(function(Mc){return Lc.includes(Mc)}))return!0;var Sc=gc.levenshtein||(gc.levenshtein={});V=fb||3>=Jc.arr.sum(V.lowercasedTokens.map(function(Mc){return Sc[Mc]||(Sc[Mc]=Jc.string.levenshtein(Lc,Mc))}));return gc.filtered=V}},{key:"sortFunction",value:function(V,Da){Da._cache||
(Da._cache={});var fb=Da._cache[V.input]||(Da._cache[V.input]={});if(fb.hasOwnProperty("sortVal"))return fb.sortVal;fb=Da._cache[V.input]={};var rb=Da.value;Da=rb.highestPriority;var kc=rb.completion;rb=rb.priority;kc=kc.replace(/\([^\)]*\)$/,"").toLowerCase();var gc=0;V.lowercasedTokens.forEach(function(Sc){kc.startsWith(Sc)?gc+=12:3<=Sc.length&&kc.includes(Sc)&&(gc+=5)});Da=-((rb||(gc?Da:0))/Math.pow(10,String(Da).length-2))-gc;var Lc=fb.levenshtein||(fb.levenshtein={});V=Jc.arr.sum(V.lowercasedTokens.map(function(Sc){return Lc[Sc]||
(Lc[Sc]=Jc.string.levenshtein(kc,Sc))}));gc&&(V/=2);return fb.sortVal=V+Da}},{key:"positionForMenu",value:function(){var V=this.textMorph,Da=V.charBoundsFromTextPosition(V.cursorPosition);return V.getGlobalTransform().transformRectToRect(Da).topLeft().addXY(-V.scroll.x,-V.scroll.y).addPt(Jc.pt(V.borderWidth+4,V.borderWidth+4))}},{key:"completionListSpec",value:function(){var V=this,Da,fb,rb,kc,gc,Lc,Sc,Mc,Ae,rf,Ze,Eg,He,Cg,Ji,Pg,ek,Cf,Ai,Eh;return $jscomp.asyncExecutePromiseGeneratorProgram(function(hj){if(1==
hj.nextAddress)return fb=Da=V.textMorph,rb=fb.fontSize,kc=fb.fontFamily,gc=V.positionForMenu(),Lc=V.prefix(),hj.yield(V.computeCompletions(Lc),2);Sc=hj.yieldResult;Mc=Sc.items;Ae=Sc.maxCol;rf=Da.env.fontMetric.sizeFor(kc,rb,"M");Ze=rf.width*Ae;Eg=Da.document.getLine(0).height;He=Math.max(120,Ze<Da.width?Ze:Da.width);Cg=Eg*Mc.length+Eg+10;Ji=Math.max(70,Math.min(700,Cg));Pg=gc.extent(Jc.pt(He,Ji));if(ek=Da.world())Cf=ek.visibleBounds().insetBy(5),Pg.bottom()>Cf.bottom()&&(Ai=Pg.bottom()-Cf.bottom(),
Ai>Pg.height-50&&(Ai=Pg.height-50),Pg.height-=Ai),Pg.right()>Cf.right()&&(Eh=Pg.right()-Cf.right(),Pg.width=120>Pg.width-Eh?120:Pg.width-Eh),Cf.containsRect(Pg)||(Pg=Pg.withTopLeft(Cf.translateForInclusion(Pg).topLeft())),Pg=Pg.translatedBy(Cf.insetBy(0).topLeft().negated());return hj.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},hasFixedPosition:!0,epiMorph:!0,fontSize:rb,position:Pg.topLeft(),extent:Pg.extent(),items:Mc,input:Lc,name:"text completion menu",historyId:"lively.morphic-text completion",
filterFunction:V.filterFunction,sortFunction:V.sortFunction})})}},{key:"removeMenuOnBlur",value:function(V){var Da=V.menu;setTimeout(function(){Da.withAllSubmorphsDetect(function(fb){return fb.isFocused()})?Da.inputMorph.focus():Da.remove()})}},{key:"openCompletionList",value:function(){var V=this,Da,fb,rb,kc,gc,Lc,Sc,Mc,Ae,rf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ze){if(1==Ze.nextAddress)return Da=V.textMorph.selection.start,Ze.yield(V.completionListSpec(),2);if(3!=Ze.nextAddress)return fb=
Ze.yieldResult,V.textMorph.pluginFind(function(Eg){return Eg.theme}),rb=new Jc.FilterableList(fb),kc=new Jc.Range({start:Da,end:V.textMorph.selection.start}),gc=V.textMorph.textInRange(kc),Lc=rb.inputMorph,Sc=rb.listMorph,Mc=fb.input,Ae=rb.addMorph({name:"prefix mask",fill:Jc.Color.transparent,bounds:Lc.textBounds()},Lc),Sc.master=null,kc.isEmpty()||(V.textMorph.deleteText(kc),Lc.input=gc,Lc.gotoDocumentEnd()),Lc.fontColor=V.textMorph.fontColor,Jc.connect(Lc,"textString",Ae,"setBounds",{converter:"() => input.textBounds()",
varMapping:{input:Lc}}),Jc.connect(rb,"accepted",V,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Mc}}),Jc.connect(rb,"accepted",rb,"remove"),Jc.connect(rb,"canceled",rb,"remove"),Jc.connect(rb,"remove",V.textMorph,"focus"),Jc.connect(rb.inputMorph,"onBlur",V,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:rb}}),rf=V.textMorph.world(),Sc.addStyleClass("hiddenScrollbar"),rb.paddingMorph.height=2,Lc.height=Sc.itemHeight,Lc.clipMode="visible",Lc.fill=V.textMorph.fill,Lc.fixedHeight=!0,Lc.fixedWidth=!1,Lc.fontSize=Sc.fontSize,rb.relayout(),rb.selectedIndex=
0,rb.master.applyIfNeeded(!0),Lc.focus(),Ze.yield(rb.master.whenApplied(),3);Mc.length&&(Lc.gotoDocumentEnd(),rb.moveBy(Jc.pt(-Lc.textBounds().width,0)));rf.addMorph(rb);rb.inputPadding=Jc.Rectangle.inset(0,0,0,0);return Ze.return(rb)})}},{key:"autoInsertBestMatchingCompletion",value:function(V,Da,fb){Da=void 0===Da?!0:Da;var rb=this,kc,gc,Lc,Sc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){if(1==Mc.nextAddress)return kc=$jscomp,gc=kc.makeIterator,Mc.yield(rb.computeSortedCompletions(V,
Da),2);Lc=gc.call(kc,Mc.yieldResult);(Sc=Lc.next().value)&&rb.insertCompletion(Sc.value.completion,V,fb);Mc.jumpToEnd()})}},{key:"insertCompletion",value:function(V,Da,fb){var rb=this.textMorph,kc=rb.document,gc=rb.selection.isMultiSelection?rb.selection.selections:[rb.selection];rb.undoManager.group();gc.forEach(function(Lc){Lc.collapseToEnd();var Sc=Lc.lead,Mc=Da?kc.indexToPosition(kc.positionToIndex(Sc)-Da.length):Sc;"function"===typeof fb?fb(V,Da,rb,{start:Mc,end:Sc},Lc):rb.replace({start:Mc,
end:Sc},V)});rb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],Ya,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);Jc.CompletionController=yc;Jc.CompletionController=yc;Jc.CompletionController=yc;
yc=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ha,Ya,Bb){var V;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){return 1==Da.nextAddress?(V=new Jc.CompletionController(Ha,Jc.defaultCompleters),Da.yield(V.openCompletionList(),2)):Da.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ha,Ya,Bb){var V;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){return 1==Da.nextAddress?(V=
new Jc.CompletionController(Ha,Jc.defaultCompleters),Da.yield(V.autoInsertBestMatchingCompletion(V.prefix()),2)):Da.return(!0)})}}];Jc.completionCommands=yc;Jc.completionCommands=yc;Jc.completionCommands=yc;var Hd=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Hd.chain=ve;Hd.arr=ac;Hd.obj=Wd;Hd.string=Qc;var Ge=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ha){var Ya=Ha.selection.start;0<Ya.row&&(Ya=Ha.getPositionAboveOrBelow(1,Ya,
!0,0,Ha.charBoundsFromTextPosition(Ya).x),Ha.selection.addRange({start:Ya,end:Ya}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Ha){var Ya=Ha.selection.start;Ya.row<Ha.documentEndPosition.row&&(Ya=Ha.getPositionAboveOrBelow(-1,Ya,!0,0,Ha.charBoundsFromTextPosition(Ya).x),Ha.selection.addRange({start:Ya,end:Ya}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ha){var Ya=Ha.selection.selections[Ha.selection.selections.length-
1];if(Ya.isEmpty())return!0;Ha.searchForAll(Ya.text,{start:{column:0,row:0}}).forEach(function(Bb){return Ha.selection.addRange(Bb.range,!1)});Ha.selection.mergeSelections();Hd.arr.remove(Ha.selection.selections,Ya);Ha.selection.selections.push(Ya);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ha){var Ya=Ha.selection.selections.length-1,Bb=Ha.selection.selections[Ya];if(Bb.isEmpty())return!0;var V=Ha.search(Bb.text,{start:Bb.end,backwards:!1});V&&
(Bb=Ha.selection.selections.findIndex(function(Da){return Da.range.equals(V.range)}),-1<Bb?Hd.arr.swap(Ha.selection.selections,Bb,Ya):Ha.selection.addRange(V.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Ha){var Ya=Ha.selection.selections.length-1,Bb=Ha.selection.selections[Ya];if(Bb.isEmpty())return!0;var V=Bb.start,Da=Ha.search(Bb.text,{start:{row:V.row,column:V.column-(Bb.text.length-1)},backwards:!0});Da&&(Bb=Ha.selection.selections.findIndex(function(fb){return fb.range.equals(Da.range)}),
-1<Bb?Hd.arr.swap(Ha.selection.selections,Bb,Ya):Ha.selection.addRange(Da.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Ha){var Ya=Ha.selection.selections.length;1<Ya&&Ha.selection.removeSelections(Ya-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ha){Ha.selection.selections=lively.lang.arr.rotate(Ha.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(Ha){Ha.selection.selections=lively.lang.arr.rotate(Ha.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Ha){var Ya=Ha.selection.selections;if(1>=Ya.length)return!0;var Bb=Hd.arr.groupBy(Ya,function(Da){return Da.range.start.row});Ya=Bb.keys().map(function(Da){Da=Bb[Da];var fb=Hd.arr.max(Da,function(rb){return rb.range.start.column});Hd.arr.without(Da,fb).forEach(function(rb){return rb.range=fb.range});
return fb});var V=Hd.arr.max(Ya,function(Da){return Da.range.start.column}).range.start.column;Ya.forEach(function(Da){var fb=Da.range.start;Da=fb.row;fb=fb.column;Ha.insertText(" ".repeat(V-fb),{row:Da,column:fb})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ha){Ha.selection.disableMultiSelect();if(Ha.selection.isEmpty())var Ya=Ha.lastSavedMark&&Ha.lastSavedMark.position||(void 0).lineRange().start,Bb=Ha.cursorPosition;else Ya=Ha.selection,
Bb=Ya.lead,Ya=Ya.anchor;Ha.selection.collapse();var V=Ya.column,Da=Bb.column;Hd.arr.range(Ya.row,Bb.row).forEach(function(fb){return Ha.getLine(fb).length>Math.min(Da,V)&&Ha.selection.addRange({end:{row:fb,column:Da},start:{row:fb,column:V}},!1)});Ha.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ha,Ya,Bb){Bb=void 0===Bb?1:Bb;Ha.undoManager.group();Ha.selection.selections.forEach(function(V,Da){return V.text=String(Da+Bb)});
Ha.undoManager.group();return!0}}];Hd.multiSelectCommands=Ge;Hd.multiSelectCommands=Ge;Hd.multiSelectCommands=Ge;var Dd=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");Dd.pToI=function(Ha,Ya){return Ha.positionToIndex(Ya)};Dd.iToP=function(Ha,Ya){return Ha.indexToPosition(Ya)};Dd.execCodeNavigator=function(Ha){return function(Ya,Bb,V){var Da=Ya.pluginInvokeFirst("getNavigator");if(!Da)return!0;Ya.saveMark();V=V||1;for(var fb=0;fb<V;fb++)Da[Ha](Ya,Bb);return!0}};Dd.once=
Tb;var ae=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Dd.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:Dd.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Dd.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Dd.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Dd.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ha,Ya){function Bb(){var fb=Ha.$expandRegionState,rb=Dd.pToI(Ha,Ha.cursorPosition);if(fb&&(fb.range[0]===rb||fb.range[1]===rb))return fb;fb=Ha.selection.range;return Ha.$expandRegionState={range:[Dd.pToI(Ha,fb.start),
Dd.pToI(Ha,fb.end)]}}Ya=Ya||{};var V=Ha.pluginInvokeFirst("getNavigator");if(!V)return!0;var Da=Ya.start;Ya=Ya.end;if("number"===typeof Da&&"number"===typeof Ya)Bb(),V={range:[Da,Ya],prev:Bb()};else{Da=V.ensureAST(Ha);if(!Da)return;V=V.expandRegion(Ha,Ha.textString,Da,Bb())}V&&V.range&&(Ha.selection={start:Dd.iToP(Ha,V.range[0]),end:Dd.iToP(Ha,V.range[1])},Ha.$expandRegionState=V);Dd.once(Ha,"selectionChange",function(){return Ha.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ha){if(Ha.selection.isEmpty())return!0;var Ya=Ha.pluginInvokeFirst("getNavigator");if(!Ya)return!0;var Bb=Ya.ensureAST(Ha);if(!Bb)return!0;var V=Ha.$expandRegionState;if(!V)return!0;(Ya=Ya.contractRegion(Ha,Ha.textString,Bb,V))&&Ya.range&&(Ha.selection={start:Dd.iToP(Ha,Ya.range[0]),end:Dd.iToP(Ha,Ya.range[1])},Ha.$expandRegionState=Ya);Dd.once(Ha,"selectionChange",
function(){return Ha.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Dd.commands=ae;Dd.commands=ae;Dd.commands=ae;var ie=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");ie.arr=ac;ie.chain=ve;ie.string=Qc;var Fe=[{name:"toggle comment",exec:function(Ha){var Ya=Ha.pluginInvokeFirst("getComment");if(!Ya)return!0;if(!Ya.lineCommentStart)return Ya.blockCommentStart?Ha.execCommand("toggle block comment"):!0;var Bb=Ya.lineCommentStart,V=
new RegExp("^(\\s*)("+Bb+"\\s?)(.*)");Ya=Ha.document;var Da=Ha.selection;Da.isEmpty()||0!==Da.end.column||Da.growRight(-1);var fb=Da.start.row;Ya=Ya.lineStrings.slice(Da.start.row,Da.end.row+1);Ya=Ya.some(function(gc){return!!gc.trim()})?ie.arr.dropWhile(Ya,function(gc){return gc.trim()?!1:++fb&&!0}):Ya;var rb=Ya.every(function(gc){return gc.trim()&&gc.match(V)});Ha.undoManager.group();if(rb)Ya.forEach(function(gc,Lc){if(gc=gc.match(V)){gc=$jscomp.makeIterator(gc);gc.next();var Sc=gc.next().value,
Mc=gc.next().value;gc.next();Ha.deleteText({start:{row:fb+Lc,column:Sc.length},end:{row:fb+Lc,column:Sc.length+Mc.length}})}});else{var kc=Ya.reduce(function(gc,Lc,Sc){return Lc.trim()||Da.isEmpty()&&Da.start.row===Da.end.row?Math.min(gc,Lc.match(/^\s*/)[0].length):gc},Infinity);kc=Infinity===kc?0:kc;Ya.forEach(function(gc,Lc){gc=$jscomp.makeIterator(gc.match(/^(\s*)(.*)/));gc.next();gc.next();gc.next();Ha.insertText(Bb+" ",{row:fb+Lc,column:kc})})}Ha.undoManager.group();return!0}},{name:"toggle block comment",
exec:function(Ha){var Ya=Ha.pluginInvokeFirst("getComment");if(!Ya)return!0;if(!Ya.blockCommentStart)return Ya.lineCommentStart?Ha.execCommand("toggle comment"):!0;if(!Ya||!Ya.blockCommentStart)return!0;var Bb=Ya.blockCommentStart;Ya=Ya.blockCommentEnd;var V=new RegExp("^"+Bb.replace(/\*/g,"\\*")),Da=new RegExp(Ya.replace(/\*/g,"\\*")+"$"),fb=Ha.tokenAt(Ha.cursorPosition);if(fb&&"comment"===fb.token){var rb=Ha.textInRange(fb);if(rb.match(V)&&rb.match(Da))return Ha.undoManager.group(),Ha.replace(fb,
rb.slice(Bb.length,-Ya.length)),Ha.undoManager.group(),!0}Ha.undoManager.group();Ha.insertText(Bb,Ha.selection.start);Ha.insertText(Ya,Ha.selection.end);Ha.undoManager.group();Bb=!Ha.selection.isEmpty();Ha.selection.growLeft(Ya.length);Bb||Ha.selection.collapse();return!0}},{name:"comment box",exec:function(Ha,Ya,Bb){Ya=Ha.undoManager.ensureNewGroup(Ha,"comment box");if(Ha.selection.isEmpty())return Ha.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ha.execCommand("toggle comment"),
Ha.undoManager.group(Ya),!0;var V=Ha.selection.range,Da=Ha.withSelectedLinesDo(function(rb){return rb}),fb=ie.arr.min([V.start.column].concat(ie.chain(Da).map(function(rb){return rb.match(/^\s*/)}).flatten().compact().pluck("length").value()));Da=ie.arr.max(Da.map(function(rb){return rb.length}))-fb;Da=Array(Math.ceil(Da/2)+1).join("-=")+"-";Ha.execCommand("toggle comment");Ha.collapseSelection();Ha.cursorPosition={row:V.start.row,column:0};Bb?Ha.insertText(ie.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",fb)):Ha.insertText(ie.string.indent(Da+"\n"," ",fb));Ha.selection.goUp();Ha.execCommand("toggle comment");Ha.cursorPosition={row:V.end.row+2,column:0};Ha.insertText(ie.string.indent(Da+"\n"," ",fb));Ha.selection.goUp();Ha.execCommand("toggle comment");Ha.selection.range={start:{row:V.start.row,column:0},end:Ha.cursorPosition};Ha.undoManager.group(Ya);return!0},multiSelectAction:"forEach",handlesCount:!0}];ie.commands=Fe;ie.commands=Fe;ie.commands=Fe;var Tc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
Tc.printSymbol=function(Ha){if(Symbol.keyFor(Ha))return'Symbol.for("'+Symbol.keyFor(Ha)+'")';if(Tc.knownSymbols.get(Ha))return Tc.knownSymbols.get(Ha);String(Ha).match(Tc.symMatcher);return String(Ha)};Tc.defaultSort=function(Ha,Ya){if(Ha.hasOwnProperty("priority")||Ya.hasOwnProperty("priority")){var Bb=Ha.priority||0,V=Ya.priority||0;if(Bb<V)return-1;if(Bb>V)return 1}Ha=(Ha.keyString||Ha.key).toLowerCase();Ya=(Ya.keyString||Ya.key).toLowerCase();return Ha<Ya?-1:Ha===Ya?0:1};Tc.safeToString=Va;Tc.propertyNamesOf=
function(Ha,Ya){if(!Ha)return[];if(Array.isArray(Ha)){var Bb=Ya?Ya.offset:0;return Tc.arr.range(Bb,Bb+(Ya?Ya.partitionSize:Ha.length-1))}return Tc.arr.sortBy(Object.keys(Ha),function(V){return V.toLowerCase()})};Tc.isMultiValue=tc;Tc.printValue=ia;Tc.partitionedChildren=function(Ha,Ya){var Bb=void 0===Ya?{}:Ya;Ya=void 0===Bb.originalValue?Ha:Bb.originalValue;var V=void 0===Bb.offset?0:Bb.offset;Bb=void 0===Bb.partitionSize?Ha.length||Object.values(Ha).length:Bb.partitionSize;if(Tc.obj.isArray(Ha)){Ha=
Tc.num.roundTo(Math.max(Tc.MIN_PARTITION_SIZE,Bb/50),.1);Bb/=Ha;for(var Da=[],fb=0;fb<Bb;fb++){var rb="["+(V+fb*Ha)+"-"+(V+(fb+1)*Ha)+"]";Da.push({partition:{originalValue:Ya,offset:V+fb*Ha,partitionSize:Ha},value:[],key:rb,keyString:rb,valueString:"...",isCollapsed:!0})}return Da}Ha=Tc.num.roundTo(Math.max(Tc.MIN_PARTITION_SIZE,Bb/50),.1);Bb/=Ha;Da=[];fb=Tc.obj.keys(Ya).sort();for(rb=0;rb<Bb;rb++){var kc=V+rb*Ha,gc=V+(rb+1)*Ha,Lc=Tc.obj.select(Ya,fb.slice(kc,gc));kc="["+fb[kc].slice(0,4)+"-"+(fb[gc]||
Tc.arr.last(fb)).slice(0,4)+"]";Da.push({partition:{originalValue:Lc,offset:V+rb*Ha,partitionSize:Ha},value:[],key:kc,keyString:kc,valueString:"...",isCollapsed:!0})}return Da};Tc.propertiesOf=function(Ha){var Ya=Ha.partition?Ha.target:Ha.value;if(!Ya)return[];var Bb={_rev:!0},V=[],Da="function"===typeof Ya.livelyCustomInspect?Ya.livelyCustomInspect():{},fb=Object.assign({},Tc.defaultPropertyOptions,{},Da);if(Da.properties){Da=$jscomp.makeIterator(Da.properties);for(var rb=Da.next();!rb.done;rb=Da.next()){var kc=
rb.value;rb=kc.key;var gc=kc.hidden,Lc=kc.priority,Sc=kc.keyString,Mc=kc.value;kc=kc.valueString;Bb[rb]=!0;gc||V.push(Ha.getSubNode({priority:Lc,key:rb,keyString:Sc||Tc.safeToString(rb),value:Mc,valueString:kc,isCollapsed:!0}))}}if(fb.includeDefault){Da=Tc.propertyNamesOf(Ya,Ha.partition);if(Da.length>Tc.MAX_NODE_THRESHOLD)for(Bb=$jscomp.makeIterator(Tc.partitionedChildren(Ya,Ha.partition)),Da=Bb.next();!Da.done;Da=Bb.next())V.push(Ha.getSubNode(Da.value));else for(gc=$jscomp.makeIterator(Da),Da=
gc.next();!Da.done;Da=gc.next())Lc=Da.value,Lc in Bb||(Da=Ya[Lc],rb=Tc.printValue(Da),Da={keyString:Lc,key:Lc,value:Da,valueString:rb,isCollapsed:!0},V.push(Ha.getSubNode(Da)));if(fb.includeSymbols)for(Bb=$jscomp.makeIterator(Object.getOwnPropertySymbols(Ya)),Da=Bb.next();!Da.done;Da=Bb.next())gc=Da.value,Lc=Tc.safeToString(gc),Da=Ya[gc],rb=Tc.printValue(Da),Da={key:gc,keyString:Lc,value:Da,valueString:rb,isCollapsed:!0},V.push(Ha.getSubNode(Da))}fb.sort&&(V=fb.sortFunction(Ya,V));return V};Tc.obj=
Wd;Tc.num=wc;Tc.arr=ac;Tc.string=Qc;Tc.connect=Ic;Tc.signal=od;Tc.TreeData=Ub;Tc.newUUID=xd;Tc.localInterface=Sa;Tc.MAX_NODE_THRESHOLD=1E3;Tc.MIN_PARTITION_SIZE=250;Tc.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Ha,Ya){return Array.isArray(Ha)?Ya:Ya.sort(Tc.defaultSort)}};Tc.symMatcher=/^Symbol\((.*)\)$/;Tc.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ha){return"symbol"===typeof Symbol[Ha]}).reduce(function(Ha,Ya){return Ha.set(Symbol[Ya],
"Symbol."+Ya)},new Map)}();Tc.isMultiValue=tc;Tc.isMultiValue=tc;Tc.printValue=ia;Tc.printValue=ia;var ee=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=Ya.hasOwnProperty("InspectionTree")&&"function"===typeof Ya.InspectionTree?Ya.InspectionTree:Ya.InspectionTree=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:Symbol.for("lively-instance-initialize"),
value:function(V){Ab._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,V);this.inspector=V.inspector;this.root.isInspectionNode||(this.root=Tc.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(V){V=void 0===V?!0:V;return Ab._get(Object.getPrototypeOf(Bb.prototype),"asListWithIndexAndDepth",this).call(this,function(Da){Da=Da.node;return V?Da.visible:!0})}},{key:"getContextFor",
value:function(V){return V==this.root?this.root.value.inspectee:V.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(V){var Da=void 0===V.maxDepth?1:V.maxDepth,fb=V.iterator,rb=V.showUnknown,kc=V.showInternal,gc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lc){if(1==Lc.nextAddress)return Lc.yield(gc.uncollapseAll(function(Sc,Mc){return Da>Mc&&(Sc==gc.root||Sc.value.submorphs)}),2);gc.asListWithIndexAndDepth(!1).forEach(function(Sc){var Mc=Sc.node;return 0==
Sc.depth?Mc.visible=!0:!rb&&Mc.keyString&&Mc.keyString.includes("UNKNOWN PROPERTY")||!kc&&Mc.keyString&&Mc.keyString.includes("internal")?Mc.visible=!1:Mc.value&&Mc.value.submorphs?Mc.visible=!0:Mc.visible=fb(Mc)});Lc.jumpToEnd()})}},{key:"getChildren",value:function(V){return V.children}},{key:"display",value:function(V){return V.display(this.inspector)}},{key:"isCollapsed",value:function(V){return V.isCollapsed}},{key:"isLeaf",value:function(V){return Tc.obj.isPrimitive(V.value)}},{key:"collapse",
value:function(V,Da){var fb=this;V.isCollapsed=Da;Da||this.isLeaf(V)||V.children.length||(V.children=Tc.propertiesOf(V).map(function(rb){fb.parentMap.set(rb,V);return rb}))}},{key:"retrieveForRemoteProxy",value:function(V){V.uuid||(V.uuid=Tc.newUUID(),this.idToNodeMap[V.uuid]=V);return{uuid:V.uuid,value:this.isLeaf(V)?V.value:{},keyString:V.keyString,key:V.keyString,valueString:Tc.safeToString(V.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Tc.localInterface}},
{key:"getNodeViaId",value:function(V){return this.idToNodeMap[V]}},{key:"asRemoteDelegate",value:function(V){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[V]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionTree"}},{key:"forObject",value:function(V,Da){return new this({key:"inspectee",
value:{inspectee:V},isCollapsed:!0,inspector:Da})}}],Ya,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(Tc.TreeData);Tc.InspectionTree=ee;Tc.InspectionTree=ee;Tc.InspectionTree=ee;var he=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Bb=Ya.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Ya.RemoteInspectionTree?Ya.RemoteInspectionTree:Ya.RemoteInspectionTree=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(V){this.parentMap=new WeakMap;this.root=V.proxy;this.evalEnvironment=V.evalEnvironment;
this.inspector=V.inspector;this.delegateId=V.delegateId}},{key:"getContextFor",value:function(V){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+V.uuid+'").value'}},{key:"dispose",value:function(){var V=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){return Da.yield(V.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+V.delegateId+"']\n    ",V.evalEnvironment),0)})}},{key:"display",
value:function(V){return V.keyString+": "+V.valueString}},{key:"collapse",value:function(V,Da){var fb=this,rb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){if(1==kc.nextAddress)return(V.isCollapsed=Da)||fb.isLeaf(V)?kc.return():V.children.length?kc.jumpTo(0):kc.yield(fb.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+V.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+fb.delegateId+'"]'}),3);rb=kc.yieldResult;V.children=rb.isError?[]:rb.value;kc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(V,Da){var fb=this,rb,kc,gc,Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return Sc.yield(fb.createRemoteContext(V,Da),2);rb=Sc.yieldResult;
kc=rb.proxy;gc=rb.delegateId;Lc=rb.evalEnvironment;return Sc.return(new fb({key:"inspectee",proxy:kc,delegateId:gc,evalEnvironment:Lc,inspector:Da}))})}},{key:"createRemoteContext",value:function(V,Da){var fb=V.code,rb=V.evalEnvironment,kc=V.delegateId,gc,Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return kc="lively://inspector-"+Da.id,Sc.yield(rb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
fb+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+kc+'");\n    ',rb),2);gc=Sc.yieldResult;Lc=gc.value;return Sc.return({delegateId:kc,evalEnvironment:rb,proxy:Lc})})}}],Ya,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(Tc.InspectionTree);
Tc.RemoteInspectionTree=he;Tc.RemoteInspectionTree=he;Tc.RemoteInspectionTree=he;(function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=Ya.hasOwnProperty("InspectionNode")&&"function"===typeof Ya.InspectionNode?Ya.InspectionNode:Ya.InspectionNode=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(V){var Da=
V.root,fb=V.priority,rb=V.key,kc=V.keyString,gc=V.value,Lc=V.valueString,Sc=V.isCollapsed,Mc=void 0===V.children?[]:V.children,Ae=void 0===V.isSelected?!1:V.isSelected,rf=void 0===V.visible?!0:V.visible;this.partition=V.partition;this.priority=fb;this.key=rb;this.keyString=String(kc||rb);this.value=gc;this.valueString=Lc||Tc.printValue(gc);this.isCollapsed=Sc;this.children=Mc;this.isSelected=Ae;this.visible=rf;this.root=Da}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(V){if(V.value&&V.value.isMorph)return new Tc.MorphNode(Object.assign({root:this.root},V));var Da=V.key,fb=V.keyString,rb=this.value,kc=V.partition;kc&&(rb=kc.originalValue,fb=Da);return new Tc.PropertyNode(Object.assign({},V,{keyString:fb,key:Da,target:rb,partition:kc,root:this.root,spec:{}}))}},{key:"display",value:function(V){var Da=this.keyString,fb=this.valueString;if(!this.interactive)return Da+": "+fb;this._propertyWidget||(this._propertyWidget=
V.renderDraggableTreeLabel({value:Da+": "+fb}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(V,Da){Da=void 0===Da?null:Da;return V.value&&V.value.isMorph?new Tc.MorphNode(Object.assign({root:Da},V)):new Tc.InspectionNode(Object.assign({root:Da},V))}}],Ya,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=Ya.hasOwnProperty("MorphNode")&&"function"===typeof Ya.MorphNode?Ya.MorphNode:Ya.MorphNode=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:Symbol.for("lively-instance-initialize"),
value:function(V){Ab._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,V);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(V){var Da=this.propertyInfo[V.key]||{};return V.value&&V.value.isMorph?new Tc.MorphNode(Object.assign({},V,{root:this.root})):new Tc.PropertyNode(Object.assign({},V,{root:this.root,target:this.target,spec:Da}))}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"MorphNode"}}],Ya,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(Tc.InspectionNode);(function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=Ya.hasOwnProperty("PropertyNode")&&"function"===typeof Ya.PropertyNode?
Ya.PropertyNode:Ya.PropertyNode=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(V){Ab._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,V);var Da=V.spec,fb=V.target;this.partition=V.partition;this.target=fb;this.spec=Da;this.foldedNodes={}}},{key:"__deserialize__",value:function(V,Da){this.spec=
{}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(V){this._interactive=V}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(V){return this.isFoldable?this.getFoldedContext(V):Ab._get(Object.getPrototypeOf(Bb.prototype),"getSubNode",this).call(this,V)}},{key:"getFoldedContext",value:function(V){return this.foldedNodes[V.key]=
new Tc.FoldedNode(Object.assign({},V,{root:this.root,target:this.target,foldableNode:this,spec:Tc.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(V,Da){(Da=void 0===Da?!1:Da)&&(this.target[this.key]=V);this.value=this.target[this.key];this.valueString=Tc.printValue(this.value);this.interactive&&(Da||this._propertyWidget.highlight());if(this.isFoldable)for(var fb in this.foldedNodes)this.foldedNodes[fb].value=
this.value[fb],this.foldedNodes[fb].valueString=Tc.printValue(this.value[fb]),this.foldedNodes[fb]._propertyWidget&&Tc.signal(this.foldedNodes[fb]._propertyWidget,"update",this.value[fb])}},{key:"display",value:function(V){var Da=this,fb=this._propertyWidget,rb=this.keyString,kc=this.valueString,gc=this.target,Lc=this.value,Sc=this.spec;if(!(this.interactive||Sc.foldable&&Tc.isMultiValue(Lc,Sc.foldable)))return V.renderPropertyControl({target:gc,keyString:rb,valueString:kc,tree:V.ui.propertyTree,
value:Lc,spec:Sc,node:this,fastRender:!0});if(fb)return fb.keyString=rb,fb.valueString=kc,fb.isSelected=this.isSelected,fb.control&&(fb.control.isSelected=this.isSelected),fb;fb=this._propertyWidget=V.renderPropertyControl({target:gc,keyString:rb,valueString:kc,value:Lc,spec:Sc,node:this,isSelected:this.isSelected,fontColor:V.ui.propertyTree.fontColor});this.isInternalProperty||Sc.readOnly||(Tc.connect(fb,"propertyValue",this,"refreshProperty",{updater:function(Mc,Ae){return Mc(Ae,!0)}}),Tc.connect(fb,
"openWidget",this.root,"onWidgetOpened",{converter:function(Mc){return{widget:Mc,node:Da.sourceObj}}}));return fb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Ya,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(Tc.InspectionNode);
(function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Bb=Ya.hasOwnProperty("FoldedNode")&&"function"===typeof Ya.FoldedNode?Ya.FoldedNode:Ya.FoldedNode=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(V){Ab._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
V);this.foldableNode=V=V.foldableNode;this.foldedProp=V.key+Tc.string.capitalize(this.key)}},{key:"refreshProperty",value:function(V,Da){Da=void 0===Da?!1:Da;var fb={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(fb[this.key]=V,fb)),Da)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Ya,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(Tc.PropertyNode);var gf=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");gf.Color=wb;var jf=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Bb=Ya.hasOwnProperty("DarkTheme")&&"function"===typeof Ya.DarkTheme?Ya.DarkTheme:Ya.DarkTheme=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Ab(Bb,Ha,[{key:"background",get:function(){return gf.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return gf.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:gf.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:gf.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:gf.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:gf.Color.white,fontWeight:"bold",backgroundColor:gf.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:gf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:gf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],Ya,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),Rf=jf=gf.DarkTheme;gf.default=jf;var Zb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Zb.inspect=va;Zb.remoteInspect=qb;Zb.generateReferenceExpression=I;Zb.onNumberDragStart=
function(Ha,Ya){Ya.initPos=Ha.position;Ya.factorLabel=(new Zb.Tooltip({description:"1x"})).openInWorld(Ha.hand.position.addXY(10,10))};Zb.onNumberDrag=function(Ha,Ya){var Bb=Zb.getScaleAndOffset(Ha,Ya),V=Bb.scale;Bb=Bb.offset;Ya.factorLabel.position=Ha.hand.position.addXY(10,10);Ya.factorLabel.description=V+"x";return Zb.getCurrentValue(Bb,V,Ya)};Zb.onNumberDragEnd=function(Ha,Ya){var Bb=Zb.getScaleAndOffset(Ha,Ya);Ha=Bb.offset;Bb=Bb.scale;Ya.factorLabel.softRemove();return Zb.getCurrentValue(Ha,
Bb,Ya)};Zb.getScaleAndOffset=function(Ha,Ya){var Bb=Ha.position.subPt(Ya.initPos);Ha=Bb.x;Ya=Zb.num.roundTo(Math.exp(-Bb.y/$world.height*6),.01)*Ya.baseFactor;return{offset:Ha,scale:Ya}};Zb.getCurrentValue=function(Ha,Ya,Bb){return Math.max(Bb.min,Math.min(Bb.max,Bb.scrubbedValue+(Bb.floatingPoint?Ha*Ya:Math.round(Ha*Ya))))};Zb.Color=wb;Zb.Rectangle=Ob;Zb.rect=Gd;Zb.pt=kd;Zb.obj=Wd;Zb.num=wc;Zb.Path=lc;Zb.arr=ac;Zb.promise=rc;Zb.connect=Ic;Zb.disconnect=Kb;Zb.once=Tb;Zb.Morph=qc;Zb.Tooltip=Hc;Zb.VerticalLayout=
ad;Zb.GridLayout=dd;Zb.HorizontalLayout=fc;Zb.morph=Cc;Zb.CustomLayout=jb;Zb.Label=yb;Zb.Icon=Ja;Zb.StyleSheet=Dc;Zb.config=Ta;Zb.Tree=Ka;Zb.LoadingIndicator=Fa;Zb.DropDownList=Xa;Zb.DropDownSelector=Hb;Zb.SearchField=ic;Zb.LabeledCheckBox=lb;Zb.MorphHighlighter=Y;Zb.InteractiveMorphSelector=Ba;Zb.printValue=ia;Zb.RemoteInspectionTree=he;Zb.InspectionTree=ee;Zb.isMultiValue=tc;Zb.valueWidgets=P;Zb.popovers=na;Zb.DarkTheme=Rf;Zb.DefaultTheme=Wb;Zb.syncEval=tb;Zb.inspectorCommands=[{name:"focus codeEditor",
exec:function(Ha){Ha.get("codeEditor").show();Ha.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ha){Ha.get("propertyTree").show();Ha.get("propertyTree").focus();return!0}}];(function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=Ya.hasOwnProperty("DraggedProp")&&"function"===typeof Ya.DraggedProp?Ya.DraggedProp:Ya.DraggedProp=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ab(Bb,Ha,[{key:"applyToTarget",value:function(V){var Da=this.currentTarget,fb=this.control;this.remove();Zb.MorphHighlighter.removeHighlighters(V.world);if(Da)if(Da.isText&&"js"===Da.editorModeName){var rb=Da.evalEnvironment.context;V=Da.textPositionFromPoint(Da.localize(V.position));rb=Zb.generateReferenceExpression(this.sourceObject,{fromMorph:rb});fb.keyString&&(rb+="."+fb.keyString);Da.insertTextAndSelect(rb,V);Da.focus()}else"propertyValue"in fb&&(Da[fb.keyString]=fb.propertyValue)}},
{key:"update",value:function(V){V=V.hand.globalPosition;var Da=this.morphBeneath(V);if(Da){for(Da==this.morphHighlighter&&(Da=Da.morphBeneath(V));[Da].concat($jscomp.arrayFromIterable(Da.ownerChain())).find(function(fb){return!fb.visible});)Da=Da.morphBeneath(V);if(Da!=this.currentTarget){this.currentTarget=Da;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Da.isWorld)return;this.morphHighlighter=Zb.MorphHighlighter.for($world,Da);this.morphHighlighter.show()}this.position=V}}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Zb.Color.rgb(169,204,227)},fill:{defaultValue:Zb.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var V=this.control;if(!V)return this.submorphs=[];this.height=22;this.submorphs=[V];V.top=0;V.fontSize=14;"function"===typeof V.relayout&&V.relayout();this.width=V.width+20;this.adjustOrigin(Zb.pt(10,
10))}}}}}],Ya,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3714})})(Zb.Morph);(function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=Ya.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Ya.DraggableTreeLabel?Ya.DraggableTreeLabel:Ya.DraggableTreeLabel=
function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(V){this.draggedProp=new Zb.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Zb.connect(V.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(V){}},{key:"onDragEnd",value:function(V){Zb.disconnect(V.hand,
"update",this.draggedProp,"update");this.draggedProp.applyToTarget(V)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Zb.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:Zb.Color.transparent},padding:{defaultValue:Zb.rect(0,1,10,-1)},isSelected:{after:["submorphs"],
set:function(V){this.setProperty("isSelected",V);V?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=V)}}}}}],Ya,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3716,
end:5055})})(Zb.Label);ee=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=Ya.hasOwnProperty("PropertyControl")&&"function"===typeof Ya.PropertyControl?Ya.PropertyControl:Ya.PropertyControl=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(V,Da,fb){V.control=
new Zb.DropDownSelector({opacity:.8,fill:Zb.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Da,padding:0,values:fb});Zb.connect(V.control,"update",V,"propertyValue",{updater:function(rb,kc){this.targetObj.propertyValue!=kc&&rb(kc)}});Zb.connect(V,"update",V.control,"selectedValue",{updater:function(rb,kc){kc=kc&&kc.valueOf?kc.valueOf():kc;this.targetObj.propertyValue!=kc&&rb(kc)}});return V}},{key:"toggleMultiValuePlaceholder",value:function(V){this.multiValuePlaceholder=
this.multiValuePlaceholder||this.addMorph({fill:Zb.Color.transparent,layout:new Zb.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:Zb.arr.range(0,2).map(function(Da){return{type:"ellipse",fill:Zb.Color.gray.withA(.5),reactsToPointer:!1,extent:Zb.pt(7,7)}})});V?(Zb.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=
!0):(Zb.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(V){this.foldableProperties&&this.toggleMultiValuePlaceholder(Zb.isMultiValue(V,this.foldableProperties))}},{key:"asFoldable",value:function(V){this.foldableProperties=V;Zb.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,
1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var V=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});V.isLayoutable=!1;V.fontWeight="bold";V.fontColor=Zb.Color.orange;V.reactsToPointer=
!1;V.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(V){this.submorphs=[V]}},layout:{initialize:function(){this.layout=new Zb.CustomLayout({relayout:function(V){V.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},
{key:"inferType",value:function(V){return(V=V.value)&&(V.isColor||V.isGradient)?"Color":V&&V.isPoint?"Point":Zb.obj.isBoolean(V)?"Boolean":Zb.obj.isNumber(V)?"Number":Zb.obj.isString(V)?"String":V&&V.isRectangle?"Rectangle":!1}},{key:"render",value:function(V){V.spec.type||(V.spec=Object.assign({},V.spec,{isFloat:!Number.isInteger(V.value),type:this.inferType(V)}));switch(V.spec.type){case "Color":var Da=this.renderColorControl(V);break;case "ColorGradient":Da=this.renderColorControl(Object.assign({},
V,{gradientEnabled:!0}));break;case "Number":Da=this.renderNumberControl(V);break;case "String":Da=this.renderStringControl(V);break;case "RichText":Da=this.renderStringControl(V);break;case "Layout":Da=this.renderLayoutControl(V);break;case "Enum":Da=this.renderEnumControl(V);break;case "Shadow":Da=this.renderShadowControl(V);break;case "Point":Da=this.renderPointControl(V);break;case "Rectangle":Da=this.renderRectangleControl(V);break;case "Boolean":Da=this.renderBooleanControl(V);break;default:Da=
this.renderItSomehow(V)}Da.control&&(Zb.connect(Da.control,"openWidget",Da,"openWidget"),Da.toggleFoldableValue(V.value));return Da}},{key:"baseControl",value:function(V){var Da=V.spec;V=new this({keyString:V.keyString,valueString:V.valueString,isSelected:!1,propertyValue:V.value});Da.foldable&&V.asFoldable(Da.foldable);return V}},{key:"renderGrabbableKey",value:function(V){var Da=this,fb=V.target;return[V.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(rb){rb.state.draggedProp=new Zb.DraggedProp({sourceObject:fb,
control:Da.baseControl(V)});rb.state.draggedProp.openInWorld();Zb.connect(rb.hand,"update",rb.state.draggedProp,"update")},onDrag:function(rb){},onDragEnd:function(rb){Zb.disconnect(rb.hand,"update",rb.state.draggedProp,"update");rb.state.draggedProp.applyToTarget(rb)}}]}},{key:"renderEnumControl",value:function(V){var Da=V.value,fb=V.spec.values,rb=V.keyString,kc=V.target,gc=V.node,Lc=function(Sc,Mc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ae){kc.world().openWorldMenu(Sc,fb.map(function(rf){return{string:rf.toString(),
action:function(){kc[rb]=rf;gc.rerender()}}}));Ae.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+(Da?Da.valueOf?Da.valueOf():Da:"Not set"),{nativeCursor:"pointer",onMouseDown:Lc}],$jscomp.arrayFromIterable(Zb.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:Lc})))}},{key:"renderStringControl",value:function(V){var Da=V.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+(200<Da.length?
Da.slice(0,20)+"...":Da),{fontColor:Zb.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(V){var Da=V.value,fb=V.keyString,rb=V.valueString,kc=V.target,gc=V.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+rb,{fontColor:Zb.Color.black,nativeCursor:"pointer",onMouseDown:function(Lc){var Sc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){if(1==Mc.nextAddress)return Sc=new Zb.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:Da}),
Sc.relayout(),Mc.yield(Sc.fadeIntoWorld(Lc.positionIn(kc.world())),2);Zb.connect(Sc,"rectangle",function(Ae){kc[fb]=Ae;gc.rerender()});Mc.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(V){var Da=V.value,fb=V.keyString,rb=V.valueString,kc=V.target,gc=V.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+rb,{nativeCursor:"pointer",fontColor:Da?Zb.Color.green:Zb.Color.red,onMouseDown:function(Lc){kc[fb]=!kc[fb];gc.rerender()}}])}},{key:"renderNumberControl",
value:function(V){var Da=V.value,fb=V.spec,rb=V.keyString,kc=V.valueString,gc=V.node,Lc=V.target,Sc=V.tree,Mc=void 0===gc._numberControls?new pg:gc._numberControls,Ae=$jscomp.makeIterator(Mc.submorphs),rf=Ae.next().value,Ze=Ae.next().value;Mc.fontColor=Sc.fontColor;var Eg=gc._numberControls=Mc;"max"in fb&&"min"in fb&&-Infinity!=fb.min&&Infinity!=fb.max?(Eg.baseFactor=(fb.max-fb.min)/100,Eg.floatingPoint=fb.isFloat,Eg.max=fb.max,Eg.min=fb.min):(Eg.floatingPoint=fb.isFloat,Eg.baseFactor=.5,Eg.min=void 0!=
fb.min?fb.min:-Infinity,Eg.max=void 0!=fb.max?fb.max:Infinity);var He=Zb.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),$jscomp.arrayFromIterable(gc._inputMorph?[gc._inputMorph,{}]:[" "+(void 0!=Da&&(Da.valueOf?Da.valueOf():Da).toFixed(fb.isFloat?Math.max(4,Zb.num.precision(Da)):0))+" ",{fontColor:He,onMouseUp:function(Cg){gc._inputMorph=Zb.morph({type:"input",fill:null,fontColor:He,fontFamily:"IBM Plex Mono",fontSize:14,
padding:Zb.rect(8,2,-6,2),height:23,cursorColor:Zb.Color.white,value:Da.valueOf?Da.valueOf():kc});Lc[rb]=Da;gc._inputMorph.focus();Zb.once(gc._inputMorph,"inputAccepted",function(Ji){delete gc._inputMorph;Lc[rb]=fb.isFloat?Number.parseFloat(Ji):Number.parseInt(Ji);gc.rerender()});Zb.once(gc._inputMorph,"onBlur",function(Ji){gc._inputMorph&&(delete gc._inputMorph,Lc[rb]=Da,gc.rerender())});gc.rerender()},onDragStart:function(Cg){Eg.scrubbedValue=Da;Zb.onNumberDragStart(Cg,Eg)},onDrag:function(Cg){Lc[rb]=
Zb.onNumberDrag(Cg,Eg);gc.rerender()},onDragEnd:function(Cg){return Zb.onNumberDragEnd(Cg,Eg)}},Mc,{onMouseUp:function(){rf.fill=Ze.fill=null},onMouseDown:function(Cg){if(Cg.targetMorph===rf){rf.fill=Zb.Color.white.withA(.2);if("max"in fb&&Lc[rb]>=fb.max)return;Lc[rb]+=1}if(Cg.targetMorph===Ze){Ze.fill=Zb.Color.white.withA(.2);if("min"in fb&&Lc[rb]<=fb.min)return;--Lc[rb]}gc.rerender()}}]))}},{key:"renderShadowControl",value:function(V){var Da=V.keyString,fb=V.value,rb=V.target,kc=V.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),
[""+(fb?fb.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(gc){var Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return Lc=new Zb.popovers.ShadowPopover({shadowValue:rb[Da],hasFixedPosition:!0}),Sc.yield(Lc.fadeIntoWorld(gc.positionIn(rb.world())),2);Zb.connect(Lc,"shadowValue",function(Mc){rb[Da]=Mc;kc.rerender()});Sc.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(V){var Da=V.keyString,fb=V.value,rb=V.target,kc=V.node,
gc=Zb.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Lc={nativeCursor:"pointer",onMouseDown:function(Sc){var Mc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ae){if(1==Ae.nextAddress)return Mc=new Zb.popovers.PointPopover({pointValue:rb[Da],hasFixedPosition:!0}),Ae.yield(Mc.fadeIntoWorld(Sc.positionIn(rb.world())),2);Zb.connect(Mc,"pointValue",function(rf){rb[Da]=rf;kc.rerender()});Ae.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),
[" pt(",Object.assign({},Lc),""+fb.x.toFixed(),Object.assign({fontColor:gc},Lc),",",Object.assign({},Lc),""+fb.y.toFixed(),Object.assign({fontColor:gc},Lc),")",Object.assign({},Lc)])}},{key:"renderLayoutControl",value:function(V){var Da=V.valueString,fb=V.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+(fb?Da:"No Layout"),{onMouseDown:function(rb){}}])}},{key:"renderColorControl",value:function(V){var Da=V.node,fb=V.gradientEnabled,rb=V.valueString,kc=V.keyString,
gc=V.value,Lc=V.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[Zb.morph({fill:gc.valueOf?gc.valueOf():gc,extent:Zb.pt(15,15),borderColor:Zb.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(gc?gc.valueOf?gc.valueOf():rb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Sc){var Mc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ae){if(1==Ae.nextAddress)return Mc=new Zb.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Lc,
fillValue:gc,title:"Fill Control",gradientEnabled:fb}),Ae.yield(Mc.fadeIntoWorld(Sc.positionIn(Lc.world())),2);Zb.connect(Mc,"fillValue",function(rf){Lc[kc]=rf;Da.rerender()});Ae.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(V){var Da=V.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(V)),[" "+Da,{}])}}],Ya,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5064,end:20451})}(Zb.DraggableTreeLabel);Zb.PropertyControl=ee;Zb.PropertyControl=ee;Zb.PropertyControl=ee;Zb.inspect=va;Zb.inspect=va;Zb.remoteInspect=qb;Zb.remoteInspect=qb;Zb.generateReferenceExpression=I;Zb.generateReferenceExpression=I;var pg=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=Ya.hasOwnProperty("NumberControls")&&"function"===typeof Ya.NumberControls?Ya.NumberControls:Ya.NumberControls=
function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Zb.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Zb.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(V){this.submorphs.map(function(Da){return Da.fontColor=
V})}},submorphs:{initialize:function(){this.submorphs=[Zb.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Zb.rect(5,2,0,-6),fontSize:12}),Zb.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Zb.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],Ya,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23124,end:24169})}(Zb.Morph);(function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=Ya.hasOwnProperty("PropertyTree")&&"function"===typeof Ya.PropertyTree?Ya.PropertyTree:Ya.PropertyTree=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:"onDrag",value:function(V){this._onDragHandler&&this._onDragHandler(V)}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Ya,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25334,end:25445})})(Zb.Tree);ee=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Bb=Ya.hasOwnProperty("Inspector")&&"function"===
typeof Ya.Inspector?Ya.Inspector:Ya.Inspector=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(V){}},{key:"__after_deserialize__",value:function(V,Da,fb){var rb=this,kc=new Zb.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,
{treeData:Zb.InspectionTree.forObject(null,this)}));this.addMorph(kc,this.getSubmorphNamed("terminal toggler"));Ab._get(Object.getPrototypeOf(Bb.prototype),"__after_deserialize__",this).call(this,V,Da,fb);!this.isComponent&&this.master.whenApplied().then(function(){rb.layout.col(0).row(1).group.morph=kc;rb.targetObject&&(rb.targetObject=rb.targetObject)})}},{key:"__additionally_serialize__",value:function(V,Da,fb,rb){V=V.props.submorphs.value;for(Da=V.length;Da--;)fb.refForId(V[Da].id).realObj==this.ui.propertyTree&&
Zb.arr.removeAt(V,Da)}},{key:"renderDraggableTreeLabel",value:function(V){return new Zb.DraggableTreeLabel(V)}},{key:"renderPropertyControl",value:function(V){return Zb.PropertyControl.render(V)}},{key:"onLoad",value:function(){var V=this.ui,Da=V.codeEditor,fb=V.thisBindingSelector,rb=V.propertyTree;Da.changeEditorMode("js").then(function(){return Da.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==fb.selection?Da.owner.selectedContext:Da.owner.targetObject},
get systemInterface(){return Zb.Path("treeData.systemInterface").get(rb)},format:"esm"}}).catch(function(kc){return $world.logError(kc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(V){Ab._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,V);V=this.ui;var Da=V.targetPicker,fb=V.propertyTree,rb=V.resizer,kc=V.terminalToggler,gc=V.unknowns,Lc=V.internals,Sc=V.searchField,Mc=V.codeEditor,Ae=V.fixImportButton,rf=V.thisBindingSelector;Mc.changeEditorMode("js").then(function(){return Mc.evalEnvironment=
{targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==rf.selection?Mc.owner.selectedContext:Mc.owner.targetObject},get systemInterface(){return fb.treeData.systemInterface},format:"esm"}}).catch(function(Ze){return $world.logError(Ze)});Zb.connect(Da,"onMouseDown",this,"selectTarget");Zb.connect(fb,"onScroll",this,"repositionOpenWidget");Zb.connect(rb,"onDrag",this,"adjustProportions");Zb.connect(kc,"onMouseDown",this,"toggleCodeEditor");Zb.connect(gc,"trigger",this,"filterProperties");
Zb.connect(Lc,"trigger",this,"filterProperties");Zb.connect(Sc,"searchInput",this,"filterProperties");Zb.connect(fb,"nodeCollapseChanged",this,"filterProperties");Zb.connect(this,"extent",this,"relayout");Zb.connect(rf,"selection",this,"bindCodeEditorThis");Zb.connect(Ae,"fire",Mc,"execCommand",{updater:function(Ze){return Ze("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var V=this.ui.propertyTree.selectedIndex-1,Da=this.ui.propertyTree.selectedNode;
this.ui.propertyTree.selectedNode.refreshProperty();Da=this.ui.propertyTree.document.getLine(V).textAndAttributes.slice(0,4).concat(Da.display(this));V=this.ui.propertyTree.lineRange(V,!1);this.ui.propertyTree.replace(V,Da,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),
this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var V=Zb.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(V!=this.lastChange||this.lastSubmorphs!=Zb.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==V.prop&&this.repositionOpenWidget(),this.lastChange=V,this.lastSubmorphs=Zb.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",
value:function(){var V;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Da){Da=Da.node;Da.target&&(V=Da.foldableNode?Da.target[Da.foldableNode.key][Da.key]:Da.target[Da.key],!Zb.obj.equals(V,Da.value)&&Da.refreshProperty&&Da.refreshProperty(V))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(V,Da){Da=void 0===Da?!1:Da;
var fb=this,rb,kc,gc,Lc,Sc,Mc,Ae,rf,Ze,Eg,He,Cg,Ji,Pg,ek;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cf){switch(Cf.nextAddress){case 1:if(!fb.isUpdating()){Cf.jumpTo(2);break}return Cf.yield(fb.whenUpdated(),2);case 2:rb=Zb.promise.deferred();kc=rb.promise;gc=!!fb.target;fb.updateInProgress=kc;Cf.setCatchFinallyBlocks(4);Da&&(Lc=Zb.LoadingIndicator.open("connecting to remote..."));if(!Da){Sc=Zb.InspectionTree.forObject(V,fb);Cf.jumpTo(6);break}return Cf.yield(Zb.RemoteInspectionTree.forObject(V,
fb),7);case 7:Sc=Cf.yieldResult;case 6:return Mc=Sc,Ae=fb.ui.propertyTree,Cf.yield(Mc.collapse(Mc.root,!1),8);case 8:if(!Mc.root.children){Cf.jumpTo(9);break}return Cf.yield(Mc.collapse(Mc.root.children[0],!1),9);case 9:if(rf=fb.originalTreeData&&fb.originalTreeData.diff(Mc)){Ze=$jscomp.makeIterator(rf);for(Eg=Ze.next();!Eg.done;Eg=Ze.next())He=Eg.value,Cg=$jscomp.makeIterator(He),Ji=Cg.next().value,Pg=Cg.next().value,Ji.refreshProperty(Pg.value);Cf.jumpTo(11);break}Ae.treeData=Mc;return Cf.yield(fb.filterProperties(),
12);case 12:if(!Ae.treeData.root.isCollapsed){Cf.jumpTo(13);break}return Cf.yield(Ae.onNodeCollapseChanged({node:Mc.root,isCollapsed:!1}),14);case 14:Ae.selectedIndex=1;case 13:return Cf.yield(Ae.execCommand("uncollapse selected node"),11);case 11:fb.toggleWindowStyle(gc);Lc&&Lc.remove();Cf.leaveTryBlock(5);break;case 4:ek=Cf.enterCatchBlock(),fb.showError(ek);case 5:fb.startStepping(1E3,"refreshAllProperties"),fb.updateInProgress=null,Cf.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(V){V=
void 0===V?!0:V;var Da=this,fb,rb,kc,gc,Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return fb=300,gc=Da.ui.codeEditor.pluginFind(function(Mc){return Mc.runEval}),Lc=Da.getWindow(),Sc.yield(gc.runEval("System.get('@system-env').node"),2);Sc.yieldResult.value?(kc=[].concat($jscomp.arrayFromIterable(Zb.arr.without(Lc.styleClasses,"local")),["node"]),rb=Zb.DarkTheme.instance):(kc=["local"].concat($jscomp.arrayFromIterable(Lc?Zb.arr.without(Lc.styleClasses,"node"):
[])),rb=Zb.DefaultTheme.instance);gc.theme=rb;V?(Lc&&Lc.animate({duration:fb,styleClasses:kc}),Da.ui.codeEditor.animate({fill:rb.background,duration:fb})):Lc&&(Lc.styleClasses=kc);Da.ui.codeEditor.textString=Da.ui.codeEditor.textString;gc.highlight();Sc.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var V=
this,Da=Object.assign({type:"text",borderWidth:1,borderColor:Zb.Color.gray,lineWrapping:"by-chars"},Zb.config.codeEditor.defaultStyle,{textString:""}),fb=Zb.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Zb.rect(0,0,this.width,30);var rb=new Zb.SearchField({styleClasses:["idle"],name:"searchField"});fb[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[rb,{type:"button",name:"targetPicker",padding:Zb.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},
tooltip:"Change Inspection Target",label:Zb.Icon.textAttribute("crosshairs")},new Zb.LabeledCheckBox({label:"Internals",name:"internals"}),new Zb.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Zb.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Zb.InspectionTree.forObject(null,this)})),Zb.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},Da),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},
{name:"this binding selector",type:Zb.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(fb),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(fb),[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){V.ui.thisBindingSelector.selection=
"target"})}},{key:"selectTarget",value:function(){var V=this,Da,fb,rb,kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gc){switch(gc.nextAddress){case 1:if(V.env.eventDispatcher.isKeyPressed("Shift"))return fb=$jscomp,rb=fb.makeIterator,gc.yield($world.execCommand("select morph",{justReturn:!0}),5);V.toggleSelectionInstructions(!0);return gc.yield(Zb.InteractiveMorphSelector.selectMorph(),4);case 4:Da=gc.yieldResult;V.toggleSelectionInstructions(!1);gc.jumpTo(3);break;case 5:kc=rb.call(fb,
gc.yieldResult),Da=kc.next().value;case 3:Da&&(V.targetObject=Da),gc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(V){if(V&&!this.instructionWidget){var Da=Zb.morph({type:"label",name:"escapeKey",value:"esc"});Da.whenRendered().then(function(){return Da.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",
{},Da,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(V){V=V.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;V.epiMorph=!0;this.openWidget=V;Zb.once(V,"close",this,"closeOpenWidget");Zb.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",
value:function(){var V=this.ui.propertyTree,Da=V.textLayout.boundsFor(V,{column:0,row:V.selectedIndex-1});Da=V.worldPoint(Zb.pt(Da.x,Da.y+Da.height/2)).addPt(V.scroll.negated());V=V.globalBounds();Da.x=this.globalBounds().center().x;Da.y<V.top()?Da=V.topCenter():V.bottom()-20<Da.y&&(Da=V.bottomCenter().addXY(0,-20));return Da}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(V){this.layout.row(1).height+=
V.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(V){if(V!==this.isEditorVisible()){var Da=this.extent,fb=this.layout,rb=this.ui,kc=rb.terminalToggler,gc=rb.codeEditor,Lc=rb.thisBindingSelector;rb=rb.fixImportButton;fb.disable();V?(kc.fontColor=Zb.Color.rgbHex("00e0ff"),fb.row(3).height=this.codeEditorHeight||180,fb.row(2).height=5,rb.animate({visible:!0,duration:200}),Lc.animate({visible:!0,
duration:200})):(this.codeEditorHeight=fb.row(3).height,kc.fontColor=Zb.Color.white,fb.row(3).height=fb.row(2).height=0,rb.animate({visible:!1,duration:200}),Lc.animate({visible:!1,duration:200}));this.extent=Da;fb.enable({duration:200});this.relayout({duration:200});gc.focus();gc.animate({opacity:V?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var V=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){V.makeEditorVisible(!V.isEditorVisible());Da.jumpToEnd()})}},{key:"filterProperties",
value:function(){var V=this,Da,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){if(1==rb.nextAddress)return Da=V.ui.searchField,fb=V.ui.propertyTree,V.originalTreeData||(V.originalTreeData=fb.treeData),Zb.disconnect(fb.treeData,"onWidgetOpened",V,"onWidgetOpened"),rb.yield(fb.treeData.filter({maxDepth:2,showUnknown:V.ui.unknowns.checked,showInternal:V.ui.internals.checked,iterator:function(kc){return Da.matches(kc.key)}}),2);fb.update();Zb.connect(fb.treeData,"onWidgetOpened",V,
"onWidgetOpened");rb.jumpToEnd()})}},{key:"relayout",value:function(V){V=void 0===V?{}:V;var Da=this,fb,rb,kc,gc,Lc,Sc,Mc,Ae,rf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ze){Da.layout&&Da.layout.forceLayout();fb=Da;rb=fb.ui;kc=rb.fixImportButton;gc=rb.terminalToggler;Lc=rb.propertyTree;Sc=rb.thisBindingSelector;Mc=Lc.bounds().insetBy(5).bottomLeft();Ae=Lc.bounds().insetBy(5).bottomRight();rf=Ae.subXY(kc.width+10,0);Sc.width=115;Sc.listMorph.itemHeight=20;V.duration?(gc.animate(Object.assign({bottomLeft:Mc},
V)),kc.animate(Object.assign({bottomRight:Ae},V)),Sc.animate(Object.assign({bottomRight:rf},V))):(gc.bottomLeft=Mc,kc.bottomRight=Ae,Sc.bottomRight=rf);Ze.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Ab._get(Object.getPrototypeOf(Bb.prototype),"keybindings",this))}},{key:"commands",get:function(){return Zb.inspectorCommands}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(V){if(System._testsRunning)return console.log(V.targetObject);V=new this(V);V.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return V}},{key:"properties",get:function(){return{extent:{defaultValue:Zb.pt(400,500)},fill:{defaultValue:Zb.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(V){this.setProperty("remoteTarget",
V);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(V,!0))}},targetObject:{after:["submorphs"],set:function(V){this._serializableTarget=V&&V.isMorph?V.id:V;this.setProperty("targetObject",V);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(V))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var V=this.ui.propertyTree,Da=V.treeData;return Da.getContextFor(V.selectedNode||Da.root)}},submorphs:{initialize:function(){this.build()}},
ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),
searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Zb.Color.gray,fontSize:14,fontFamily:Zb.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Ya,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25462,end:45996})}(Zb.Morph);ee=Zb.Inspector;he=ya("I",ee);Zb.default=ee;var lg=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");lg.Inspector=he;lg.string=Qc;lg.Morph=qc;lg.pt=kd;lg.Color=wb;ee=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ha,Ya,Bb){Bb=void 0===Bb?1:Bb;var V,
Da,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){switch(rb.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),rb.setCatchFinallyBlocks(2),Ya=Object.assign({},Ya,{logDoit:!0,inspect:!0,inspectDepth:Bb}),rb.yield(Ha.doEval(void 0,Ya),4);case 4:V=rb.yieldResult;Da=V.error?V.error:V.isError?V.value:null;rb.leaveTryBlock(3);break;case 2:Da=fb=rb.enterCatchBlock();case 3:return Da?Ha.showError(Da):Ha.setStatusMessage(lg.string.truncate(V.value,1E3)),rb.return(V)}})}},{name:"eval all",
doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ha,Ya){var Bb,V,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fb){switch(fb.nextAddress){case 1:return fb.setCatchFinallyBlocks(2),fb.yield(Ha.doEval({start:{row:0,column:0},end:Ha.documentEndPosition},Object.assign({},Ya,{logDoit:!0})),4);case 4:Bb=fb.yieldResult;V=Bb.error?Bb.error:Bb.isError?Bb.value:null;fb.leaveTryBlock(3);break;case 2:V=Da=fb.enterCatchBlock();case 3:return V?Ha.showError(V):Ha.setStatusMessage(String(Bb.value)),
fb.return(Bb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ha,Ya){var Bb,V,Da,fb,rb,kc,gc,Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){switch(Sc.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),Sc.setCatchFinallyBlocks(2),Ya=Object.assign({},Ya,{asString:!1,logDoit:!0}),Sc.yield(Ha.doEval(void 0,Ya),4);case 4:Bb=Sc.yieldResult;V=Bb.error?Bb.error:Bb.isError?Bb.value:null;Sc.leaveTryBlock(3);
break;case 2:V=Da=Sc.enterCatchBlock();case 3:Ha.selection.collapseToEnd();if(fb=Bb.value&&Bb.value.isColor)return Ha.selection.text=String(Bb.value),rb=new lg.Morph({fill:lg.Color.transparent,extent:lg.pt(Ha.fontSize+2,Ha.fontSize+2),submorphs:[{fill:Bb.value,center:lg.pt(Ha.fontSize+2,Ha.fontSize+2).scaleBy(.5)}]}),kc=Ha.selection.start,gc=kc.column,Lc=kc.row,Ha.insertText([rb,{}],Ha.selection.start),Ha.selection.start={column:gc,row:Lc},Ha.focus(),Sc.return(Bb);Ha.insertTextAndSelect(V?String(V)+
(V.stack?"\n"+V.stack:""):String(Bb.value));Ha.focus();return Sc.return(Bb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ha,Ya){var Bb,V,Da,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){switch(rb.nextAddress){case 1:Ha.maybeSelectCommentOrLine();V=Ha.textInRange(Ha.selection);Da=Ha.evalEnvironment||{};fb=Ha.pluginFind(function(kc){return kc.isEditorPlugin&&"function"===typeof kc.runEval});Da.systemInterface||
(Da.systemInterface=fb.systemInterface(Ya));if("local"!==Da.systemInterface.name){rb.jumpTo(2);break}rb.setCatchFinallyBlocks(3);return rb.yield(Ha.doEval(void 0,Ya),5);case 5:Bb=rb.yieldResult;V=Bb.value;rb.leaveTryBlock(2);break;case 3:rb.enterCatchBlock();case 2:return Ha.world().execCommand("open object editor",{target:V,evalEnvironment:Da}),rb.return(Bb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Ha,Ya){var Bb,V,
Da,fb,rb,kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gc){switch(gc.nextAddress){case 1:Ha.maybeSelectCommentOrLine();Da=Ha.textInRange(Ha.selection);fb=Ha.evalEnvironment||{};rb=Ha.pluginFind(function(Lc){return Lc.isEditorPlugin&&"function"===typeof Lc.runEval});fb.systemInterface||(fb.systemInterface=rb.systemInterface(Ya));if("local"!==fb.systemInterface.name){lg.Inspector.openInWindow({remoteTarget:{code:Da,evalEnvironment:fb}});gc.jumpTo(2);break}gc.setCatchFinallyBlocks(3);
return gc.yield(Ha.doEval(void 0,Ya),5);case 5:Bb=gc.yieldResult;V=Bb.error?Bb.error:Bb.isError?Bb.value:null;Da=Bb.value;gc.leaveTryBlock(4);break;case 3:V=kc=gc.enterCatchBlock();case 4:lg.Inspector.openInWindow({targetObject:V||Da});case 2:return gc.return(Bb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",handlesCount:!0,exec:function(Ha,Ya,Bb){Bb=void 0===Bb?1:Bb;var V;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){switch(Da.nextAddress){case 1:return Ha.maybeSelectCommentOrLine(),Da.setCatchFinallyBlocks(2),Ya=Object.assign({},Ya,{inspect:!0,inspectDepth:Bb,logDoit:!0}),Da.yield(Ha.doEval(void 0,Ya),4);case 4:V=Da.yieldResult;Da.leaveTryBlock(3);break;case 2:Da.enterCatchBlock();case 3:return Ha.selection.collapseToEnd(),Ha.insertTextAndSelect(V.value),Da.return(V)}})}}];lg.codeEvaluationCommands=ee;lg.codeEvaluationCommands=ee;lg.codeEvaluationCommands=
ee;var qg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");qg.changeAttributeInSelectionOrMorph=function(Ha,Ya,Bb){var V=Ha.selection;Ha.keepPosAtSameScrollOffsetWhile(function(){V.isEmpty()?Ha[Ya]="function"===typeof Bb?Bb(Ha[Ya]):Bb:(Ha.undoManager.group(),Ha.changeStyleProperty(Ya,function(Da){return"function"===typeof Bb?Bb(Da):Bb}),Ha.undoManager.group())})};he=[{name:"increase font size",scrollCursorIntoView:!1,exec:function(Ha){var Ya=Ha.fontSize;qg.changeAttributeInSelectionOrMorph(Ha,
"fontSize",function(Bb){Bb=Bb||Ya;return Bb+(18<=Bb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ha){var Ya=Ha.fontSize;qg.changeAttributeInSelectionOrMorph(Ha,"fontSize",function(Bb){Bb=Bb||Ya;return Bb-(18>=Bb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ha){var Ya,Bb,V,Da,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){if(1==rb.nextAddress){Ya=["serif","sans-serif","monospace"];if(Bb=localStorage["lively.morpic/text-change-font-additional-fonts"])Bb=
JSON.parse(Bb),Ya.push.apply(Ya,$jscomp.arrayFromIterable(Bb));Ya.map(function(kc){return kc.toLowerCase()}).includes(Ha.fontFamily.toLowerCase())||(Ya.push(Ha.fontFamily),Bb=[].concat($jscomp.arrayFromIterable(Bb||[]),[Ha.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Bb));return rb.yield($world.editListPrompt("choose font",Ya,{requester:Ha,preselect:Ya.indexOf(Ha.fontFamily),historyId:"lively.morpic/text-change-font-hist"}),2)}V=rb.yieldResult;Da=$jscomp.makeIterator(V.selections);
if(fb=Da.next().value)Ha.fontFamily=fb;return rb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ha,Ya){Ya=void 0===Ya?{}:Ya;var Bb,V,Da,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){if(1==rb.nextAddress){if(Ya.hasOwnProperty("link"))return rb.jumpTo(2);V=Ha.selection;Da=Ha.getStyleInRange(V);fb=Da.link;return rb.yield(Ha.world().prompt("Set link",{input:fb||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=rb.nextAddress&&
(Bb=rb.yieldResult,!Bb))return rb.return();Ha.undoManager.group();Ha.setStyleInRange({link:Bb||void 0},V);Ha.undoManager.group();rb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ha,Ya){var Bb,V,Da,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){if(1==rb.nextAddress)return Bb=Ha.selection,V=Ha.getStyleInRange(Bb),Da=V.doit,rb.yield(Ha.world().editPrompt("Enter doit code (runs on clicking the text)",{requester:Ha,input:Da?Da.code:"// empty doit",
historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ha.evalEnvForDoit(Da||{})}),2);fb=rb.yieldResult;Ha.undoManager.group();fb?Ha.addTextAttribute({doit:{code:fb},nativeCursor:"pointer",textDecoration:"underline"},Bb):Ha.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Bb);Ha.undoManager.group();rb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ha,Ya){Ya=void 0===Ya?{}:Ya;Ha.undoManager.group();Ya=!Ya.onlySelection&&Ha.selection.isEmpty()?
Ha.documentRange:Ha.selection.range;Ha.setStyleInRange(null,Ya);Ha.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ha){var Ya,Bb,V,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fb){if(1==fb.nextAddress)return fb.yield(System.import("lively.modules"),2);if(3!=fb.nextAddress)return Ya=fb.yieldResult,Bb=Ya.module,fb.yield(Bb("lively.ide/text/ui.js").load(),3);V=fb.yieldResult;Da=V.RichTextControl;return fb.return(Da.openFor(Ha))})}}];qg.commands=he;
qg.commands=he;qg.commands=he;var Re=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");Re.guessTextModeName=pa;Re.rangedToken=function(Ha,Ya,Bb,V,Da){return{start:{row:Ha,column:Ya},end:{row:Ha,column:Bb},token:V,mode:Da}};Re.fun=nb;Re.arr=ac;Re.connect=Ic;Re.disconnect=Kb;Re.DefaultTheme=Wb;Re.tokenizeDocument=mb;Re.modeInfo=ub;Re.visitDocumentTokens=Bc;Re.getMode=Db;Re.completionCommands=yc;Re.multiSelectCommands=Ge;Re.navCommands=ae;Re.codeCommands=Fe;Re.codeEvaluationCommands=ee;
Re.richTextCommands=he;Re.Color=wb;Re.Range=ne;Re.guessTextModeName=pa;Re.guessTextModeName=pa;Wb=function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Bb=Ya.hasOwnProperty("EditorPlugin")&&"function"===typeof Ya.EditorPlugin?Ya.EditorPlugin:Ya.EditorPlugin=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
Re.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(V){var Da=this;this.textMorph=V;Re.connect(V,"textChange",this,"onTextChange");Re.connect(V,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Da.highlight()})}},
{key:"detach",value:function(V){Re.disconnect(V,"textChange",this,"onTextChange");Re.disconnect(V,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(V){this._ast=null;if(V){var Da=this._tokenizerValidBefore;if("replace"===V.selector){var fb=V.args[0].start;V=fb.row;fb=fb.column}else fb=V=0;if(!Da||V<Da.row||V===Da.row&&fb<Da.column)V=Math.max(0,V),this._tokenizerValidBefore={row:V,column:fb}}this.requestHighlight()}},
{key:"requestHighlight",value:function(V){var Da=this;(void 0===V?0:V)?this.highlight():Re.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return Da.highlight()})()}},{key:"highlight",value:function(){var V=this.textMorph,Da=this.theme,fb=this.mode,rb=this._tokenizerValidBefore;if(Da&&V&&V.document&&fb){V.fill=Da.background;V.cursorColor=Da.cursorColor||Re.Color.black;var kc=V.viewState,gc={};rb=Re.tokenizeDocument(fb,V.document,kc.firstVisibleRow,kc.lastVisibleRow,rb);fb=rb.lines;rb=
rb.tokens;if(fb.length){kc=fb[0].row;for(var Lc=[],Sc=0;Sc<rb.length;kc++,Sc++)for(var Mc=rb[Sc],Ae=0;Ae<Mc.length;Ae+=5){var rf=Mc[Ae],Ze=Mc[Ae+1],Eg=Da[Mc[Ae+2]]||Da.default;Eg&&Lc.push({start:{row:kc,column:rf},end:{row:kc,column:Ze}},Eg)}V.embeddedMorphs.forEach(function(He){var Cg=V.embeddedMorphMap.get(He).anchor;gc[He.id]=V.textAttributeAt(Cg.position)});V.setTextAttributesWithSortedRanges(Lc);V.embeddedMorphs.forEach(function(He){var Cg=V.embeddedMorphMap.get(He).anchor;Cg=Re.Range.at(Cg.position);
Cg.end.column+=1;V.replace(Cg,[He,gc[He.id]],!1)});this._tokenizerValidBefore={row:Re.arr.last(fb).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},V,this)}}},{key:"visitTokensInRange",value:function(V,Da){var fb=V.start,rb=V.end,kc=fb.row-1;Re.visitDocumentTokens(this.mode,this.textMorph.document,fb.row,rb.row,null,function(gc){return kc++},function(gc,Lc,Sc,Mc,Ae,rf,Ze){if(kc===fb.row&&0<fb.column){if(fb.column>=Mc)return;Sc<fb.column&&fb.column<Mc&&(Sc=fb.column)}if(kc===rb.row){if(rb.column<=
Sc)return;Sc<rb.column&&rb.column<Mc&&(Mc=rb.column)}Da(gc,Lc,kc,Sc,Mc,Ae,rf,Ze)})}},{key:"tokensInRange",value:function(V){var Da=[];this.visitTokensInRange(V,function(fb,rb,kc,gc,Lc,Sc,Mc,Ae){return Da.push(Re.rangedToken(kc,gc,Lc,fb,Ae))});return Da}},{key:"tokensOfRow",value:function(V){var Da=this.textMorph.getLine(V).length;return this.tokensInRange({start:{row:V,column:0},end:{row:V,column:Da}})}},{key:"tokenAt",value:function(V){for(var Da=this.tokensOfRow(V.row),fb=Da.length;fb--;){var rb=
Da[fb];if(rb.token&&rb.start.column<=V.column&&V.column<=rb.end.column)return rb}return null}},{key:"getCommands",value:function(V){return[].concat($jscomp.arrayFromIterable(V),$jscomp.arrayFromIterable(Re.completionCommands),$jscomp.arrayFromIterable(Re.multiSelectCommands),$jscomp.arrayFromIterable(Re.navCommands),$jscomp.arrayFromIterable(Re.codeCommands),$jscomp.arrayFromIterable(Re.codeEvaluationCommands),$jscomp.arrayFromIterable(Re.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var V=this.mode,Da=V.lineComment,fb=V.blockCommentStart;V=V.blockCommentEnd;var rb={};Da&&(rb.lineCommentStart=Da);fb&&(rb.blockCommentStart=fb);V&&(rb.blockCommentEnd=V);return rb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(V,Da,fb){var rb=this.textMorph,kc=V.row,gc=V.column;V=Da[gc-1];Da=Da[gc];rb.selection.text="\n";rb.selection.collapseToEnd();"{"===V&&"}"===Da&&(rb.selection.text="\n"+" ".repeat(fb),rb.selection.collapse());
rb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:kc+1,lastRow:kc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var V=this.textMorph,Da=this.openPairs,fb=V.selection,rb=V.getLine(fb.end.row),kc=rb[fb.end.column-1];rb=rb[fb.end.column];V.autoInsertPairs&&fb.isEmpty()&&kc in
Da&&rb===Da[kc]&&(fb.growRight(1),fb.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(V){var Da=this.openPairs,fb=this.closePairs,rb=this.textMorph,kc=rb.selection,gc=rb.autoInsertPairs&&V in Da,Lc=rb.autoInsertPairs&&V in fb;if(!gc&&!Lc)return!1;var Sc=rb.getLine(kc.end.row)[kc.end.column];if(!kc.isEmpty()){if(!gc)return!1;fb=rb.undoManager.ensureNewGroup(rb);rb.insertText(Da[V],kc.end);rb.insertText(V,kc.start);rb.undoManager.group(fb);kc.growRight(-1);return!0}if(Sc in fb&&V===Sc)return kc.goRight(1),
!0;if(Lc&&!gc)return!1;fb=rb.undoManager.ensureNewGroup(rb);rb.insertText(V+Da[V]);rb.undoManager.group(fb);kc.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Ya,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);
ub=Wb=Re.EditorPlugin;yc=ya("C",function(Ha){var Ya=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Bb=Ya.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Ya.CodeMirrorEnabledEditorPlugin?Ya.CodeMirrorEnabledEditorPlugin:Ya.CodeMirrorEnabledEditorPlugin=function(V){V&&V[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Bb,Ha,[{key:Symbol.for("lively-instance-initialize"),value:function(){Ab._get(Object.getPrototypeOf(Bb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(V){this.mode=this.codeMirrorMode(V);return Ab._get(Object.getPrototypeOf(Bb.prototype),"attach",this).call(this,V)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(V){return{indentWithTabs:!V.useSoftTabs,indentUnit:V.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(V){V=this.defaultCodeMirrorModeConfig(V);
return Re.getMode(V,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Ya,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(Re.EditorPlugin));Re.CodeMirrorEnabledEditorPlugin=yc;Re.CodeMirrorEnabledEditorPlugin=
yc;Re.CodeMirrorEnabledEditorPlugin=yc;Re.default=Wb;Wb=Object.freeze({__proto__:null,guessTextModeName:pa,"default":ub,CodeMirrorEnabledEditorPlugin:yc});ya("e",Wb)}}});
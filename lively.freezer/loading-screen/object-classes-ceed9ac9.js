System.register(["./__root_module__-2cc1f5a8.js"],function(ya){var wb,Ab,ac,Ob,kd,Cc,qd,Dc,Ic,Qc,Bd,ne,ve,Wd,Tb;return{setters:[function(wc){wb=wc.a7;Ab=wc.P;ac=wc.a6;Ob=wc.p;kd=wc.bE;Cc=wc.B;qd=wc.bF;Dc=wc.r;Ic=wc.aU;Qc=wc.bG;Bd=wc.bH;ne=wc.bI;ve=wc.bJ;Wd=wc.bK;Tb=wc.l}],execute:function(){function wc(lc,rc,Kb,qc){qc=void 0===qc?{}:qc;qc=qc.package||Ub.ObjectPackage.lookupPackageForObject(lc,qc);if(!qc)throw Error("Object is not part of an object package: "+lc);return qc.addScript(lc,rc,Kb)}
function od(lc,rc){rc=Ub.normalizeOptions(rc).System;lc=(lc=lc[Symbol.for("lively-module-meta")])?lc.package.name:null;return(rc=(lc?Ub.lookupPackage(rc,lc):{}).pkg)?!!Ub.ObjectPackage.forSystemPackage(rc):!1}ya({addScript:wc,isObjectClass:od});var Ub=lively.FreezerRuntime.recorderFor("lively.classes/object-classes.js");Ub.normalizeOptions=function(lc){lc=Object.assign({baseURL:Ub.defaultBaseURL,System:System},lc);lc.baseURL=lc.baseURL.replace(/\/$/,"");return lc};Ub.addScript=wc;Ub.isObjectClass=
od;Ub.string=wb;Ub.Path=Ab;Ub.arr=ac;Ub.parse=Ob;Ub.isValidIdentifier=kd;Ub.stringify=Cc;Ub.parseFunction=qd;Ub.resource=Dc;Ub.runEval=Ic;Ub.scripting=Qc;Ub.ExportLookup=Bd;var xd=Ub.scripting;Ub.ensurePackage=xd.ensurePackage;Ub.registerPackage=xd.registerPackage;Ub.importPackage=xd.importPackage;Ub.lookupPackage=xd.lookupPackage;Ub.module=xd.module;Ub.ImportInjector=xd.ImportInjector;Ub.RuntimeSourceDescriptor=ne;Ub.toJsIdentifier=ve;Ub.adoptObject=Wd;Ub.classToFunctionTransform=Tb;Ub.objectPackageSym=
Symbol.for("lively-object-package-data");Ub.defaultBaseURL="local://lively-object-modules";Ub.globalClasses=Object.keys(System.global).map(function(lc){lc=System.global[lc];return"function"===typeof lc&&lc.name&&lc}).filter(Boolean);Ub.addScript=wc;Ub.addScript=wc;Ub.isObjectClass=od;Ub.isObjectClass=od;Ub._packageStore=Ub._packageStore||{};xd=function(lc,rc){this._id=lc;this.options=Ub.normalizeOptions(rc)};xd.lookupPackageForObject=function(lc,rc){return this.lookupPackageForClass(lc.constructor,
rc)};xd.lookupPackageForClass=function(lc,rc){rc=Ub.normalizeOptions(rc).System;lc=(lc=lc[Symbol.for("lively-module-meta")])?lc.package.name:null;return(rc=(lc?Ub.lookupPackage(rc,lc):{}).pkg)?Ub.ObjectPackage.forSystemPackage(rc):null};xd.forSystemPackage=function(lc){return this.packageStore[lc.name]};xd.withId=function(lc,rc){return this.packageStore[lc]||(this.packageStore[lc]=new this(lc,rc))};xd.prototype.resource=function(lc){lc=void 0===lc?"":lc;return Ub.resource(this.packageURL).join(lc)};
xd.prototype.load=function(){return Ub.importPackage(this.System,this.packageURL)};xd.prototype.ensureExistance=function(){var lc=this,rc,Kb,qc,Hc,ad,dd,fc,jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yb){switch(yb.nextAddress){case 1:return rc=lc.resource("/"),yb.yield(rc.exists(),2);case 2:if(yb.yieldResult)return yb.return();Kb=[{resource:rc}];qc=[{resource:lc.resource("package.json"),content:JSON.stringify(lc.config,null,2)}];return yb.yield(Promise.all(Kb.map(function(Ja){return Ja.resource.mkdir()})),
3);case 3:return yb.yield(Promise.all(qc.map(function(Ja){var Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){switch(Ka.nextAddress){case 1:return Ka.yield(Ja.resource.exists(),2);case 2:if(!(Ta=!Ka.yieldResult)){Ka.jumpTo(3);break}return Ka.yield(Ja.resource.write(Ja.content),4);case 4:Ta=Ka.yieldResult;case 3:return Ka.return(Ta)}})})),4);case 4:return yb.yield(lc.objectModule.ensureExistance(),5);case 5:return Hc=lc,ad=Hc.System,dd=Hc.packageURL,fc=Hc.config,yb.yield(Ub.ensurePackage(ad,
dd),6);case 6:return jb=yb.yieldResult,jb.registerWithConfig(fc),console.log(lc.packageURL+" REGISTERED"),yb.return(lc)}})};xd.prototype.ensureObjectClass=function(lc){var rc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Kb){return 1==Kb.nextAddress?Kb.yield(rc.ensureExistance(),2):Kb.return(rc.objectModule.ensureObjectClass(lc))})};xd.prototype.adoptObject=function(lc){var rc=this,Kb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qc){if(1==qc.nextAddress)return rc.objectClass===
lc.constructor?qc.return():qc.yield(rc.ensureObjectClass(lc.constructor),2);Kb=qc.yieldResult;Ub.adoptObject(lc,Kb);qc.jumpToEnd()})};xd.prototype.addScript=function(lc,rc,Kb){return this.objectModule.addScript(lc,rc,Kb)};xd.prototype.remove=function(){this.systemPackage.remove();delete Ub.ObjectPackage.packageStore[this.id];return this.resource().remove()};xd.prototype.renameObjectClass=function(lc,rc){rc=void 0===rc?[]:rc;var Kb=this,qc,Hc,ad,dd,fc,jb,yb,Ja,Ta,Ka,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==
Xa.nextAddress){qc=Kb;Hc=qc.objectClass;ad=qc.System;if(!Hc||Hc[Symbol.for("__LivelyClassName__")]===lc)return Xa.return(Hc);if(!Ub.isValidIdentifier(lc))throw Error(lc+" is not a valid name for a class");fc=dd=Ub.RuntimeSourceDescriptor.for(Hc,ad);jb=fc.source;yb=fc.ast;Ja=yb.id;Ta=Ja.start;Ka=Ja.end;return Xa.yield(dd.changeSource(jb.slice(0,Ta)+lc+jb.slice(Ka)),2)}Fa=Kb.objectClass;rc.forEach(function(Hb){Hb.constructor=Fa;Hb.__proto__=Fa.prototype});return Xa.return(Fa)})};xd.prototype.fork=function(lc,
rc){var Kb=this,qc,Hc,ad,dd,fc,jb,yb,Ja,Ta,Ka,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){switch(Xa.nextAddress){case 1:return qc=Kb,Hc=qc.System,ad=qc.baseURL,dd=qc.objectClass,rc=Object.assign({System:Hc,baseURL:ad},rc),fc=Ub.RuntimeSourceDescriptor.for(dd),jb=fc._renamedSource(lc),yb=jb.moduleSource,Ja=Ub.ObjectPackage.withId(lc,rc),Xa.yield(Ja.ensureExistance(),2);case 2:return Ta=Ja,Ka=Ta.objectModule,Fa=Ka.systemModule,Xa.yield(Fa.load({format:"esm"}),3);case 3:return Xa.yield(Fa.changeSource(yb),
4);case 4:return Xa.return(Ja)}})};$jscomp.global.Object.defineProperties(xd.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},name:{configurable:!0,enumerable:!0,get:function(){return this.id}},System:{configurable:!0,enumerable:!0,get:function(){return this.options.System}},baseURL:{configurable:!0,enumerable:!0,get:function(){return this.options.baseURL}},packageURL:{configurable:!0,enumerable:!0,get:function(){return this.baseURL+("/"+this.id)}},config:{configurable:!0,
enumerable:!0,get:function(){return{name:this.name,version:"0.1.0",lively:{isObjectPackage:!0}}}},systemPackage:{configurable:!0,enumerable:!0,get:function(){return Ub.lookupPackage(this.System,this.packageURL,!0).pkg}},objectModule:{configurable:!0,enumerable:!0,get:function(){return this._objectModule||(this._objectModule=new Ub.ObjectModule("index.js",this))}},objectClass:{configurable:!0,enumerable:!0,get:function(){return this.objectModule.objectClass}}});$jscomp.global.Object.defineProperties(xd,
{packageStore:{configurable:!0,enumerable:!0,get:function(){return this._packageStore||(this._packageStore=Ub._packageStore)}}});ya("default",xd);Ub.ObjectPackage=xd;var Gd=function(lc,rc){if(!lc)throw Error("ObjectModule needs package!");if(!rc)throw Error("ObjectModule needs package!");this._moduleName=lc;this._objectPackage=rc};Gd.prototype.read=function(){return this.resource.read()};Gd.prototype.write=function(lc){return this.resource.write(lc)};Gd.prototype.ensureExistance=function(){var lc=
this,rc,Kb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qc){switch(qc.nextAddress){case 1:return rc=lc.resource,qc.yield(rc.exists(),2);case 2:if(qc.yieldResult){qc.jumpTo(3);break}return qc.yield(rc.write("'format esm';\n"),4);case 4:Kb={},lc.System.config({meta:(Kb[lc.url]={format:"esm"},Kb)});case 3:return qc.return(lc)}})};Gd.prototype.ensureObjectClass=function(lc){var rc=this,Kb=this.objectClass;return Kb&&Kb.prototype.__proto__===lc.prototype?Kb:Promise.resolve(this.ensureObjectClassSource(lc)).then(function(qc){var Hc=
qc.source,ad=qc.moduleId,dd=qc.className,fc=qc.bindings,jb=rc.System;qc=Ub.module(jb,ad);if(fc)for(var yb in fc)qc.define(yb,fc[yb]);Hc=Ub.runEval(Hc,{classTransform:Ub.classToFunctionTransform,sync:!0,targetModule:ad,System:jb});if(Hc.isError)throw Hc.value;Hc=qc.recorder[dd];if(!Hc)throw Error("Failed to define class "+dd+" in "+ad);return Hc})};Gd.prototype.ensureObjectClassSource=function(lc){return this.createDefaultClassDeclaration(lc)};Gd.prototype.createDefaultClassDeclaration=function(lc){lc=
void 0===lc?Object:lc;var rc=this,Kb,qc,Hc,ad,dd,fc,jb,yb,Ja,Ta,Ka,Fa,Xa,Hb,ic,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){switch(tb.nextAddress){case 1:Kb=rc;qc=Kb.System;Hc=Kb.systemModule;ad=Kb.objectPackage;dd=Ub.string.capitalize(Ub.toJsIdentifier(ad.id));fc=lc[Symbol.for("__LivelyClassName__")];jb=!fc;yb=Ub.globalClasses.includes(lc);Ja="";Ta=null;if(jb){fc="__anonymous_superclass__";Ka={};Ta=(Ka[fc]=lc,Ka);tb.jumpTo(2);break}if(yb){tb.jumpTo(2);break}return tb.yield(Ub.ExportLookup.findExportOfValue(lc,
qc),4);case 4:(Fa=tb.yieldResult)?(Xa=Ub.ImportInjector.run(qc,Hc.id,Hc.package(),"",Fa),Hb=Xa.standaloneImport,Ja+=Hb+"\n\n"):(ic={},Ta=(ic[fc]=lc,ic));case 2:return dd===fc&&(dd="Object"+dd),lb="Object"===fc?"class "+dd+" {}\n":"class "+dd+" extends "+fc+" {}\n",Ja+="export default "+lb+"\n",tb.yield(Hc.changeSource(Ja),5);case 5:return tb.yield(Hc.load(),6);case 6:return tb.return({source:Ja,className:dd,moduleId:rc.url,bindings:Ta})}})};Gd.prototype.addScript=function(lc,rc,Kb){var qc=this,Hc,
ad,dd,fc,jb,yb,Ja,Ta,Ka,Fa,Xa,Hb,ic,lb,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(nb){switch(nb.nextAddress){case 1:if(lc.constructor===qc.objectClass){Hc=lc.constructor;nb.jumpTo(2);break}return nb.yield(qc.ensureObjectClass(lc.constructor),3);case 3:Hc=nb.yieldResult;case 2:ad=Hc;dd="function"===typeof rc?String(rc):rc;fc=Ub.parseFunction(dd);jb=Ub.RuntimeSourceDescriptor.for(ad,qc.System);Kb||(Kb=Ub.Path("id.name").get(fc));if(!Kb)throw Error("No name, cannot add "+Ub.string.truncate(dd,
30).replace(/\n/g,"")+"!");yb=Ub.toJsIdentifier(Kb);console.assert("FunctionExpression"===fc.type||"ArrowFunctionExpression"===fc.type,"not a function expression but: "+fc.type);Ja=fc.params.map(function(Y){return dd.slice(Y.start,Y.end)});Ta="BlockStatement"===fc.body.type?dd.slice(fc.body.start,fc.body.end):"{ return "+dd.slice(fc.body.start,fc.body.end)+" }";Ka=yb+"("+Ja.join(",")+") "+Ta;"ArrowFunctionExpression"===fc.type&&(fc.type="FunctionExpression");Fa=jb.source;Xa=jb.ast;if(!Xa)throw Error("cannot find class decl of "+
jb.module.id);(Hb=Xa.body.body.find(function(Y){return Y.key.name===yb&&!Y.static}))?Fa=Fa.slice(0,Hb.start)+Ka+Fa.slice(Hb.end):(ic=Fa.lastIndexOf("}"),lb=Fa.slice(0,ic),tb=Fa.slice(ic),/\n\s*$/m.test(lb)||(lb+="\n"),Ka=Ub.string.changeIndent(Ka,"  ",1),/^[ ]*\n/m.test(tb)||(tb="\n"+tb),Fa=lb+Ka+tb);return nb.yield(jb.changeSource(Fa),4);case 4:return nb.return({script:ad.prototype[yb],klass:ad,module:jb.module.id,methodName:yb})}})};$jscomp.global.Object.defineProperties(Gd.prototype,{objectPackage:{configurable:!0,
enumerable:!0,get:function(){return this._objectPackage}},objectClass:{configurable:!0,enumerable:!0,get:function(){var lc=this.systemModule;return lc.isLoaded()?lc.System.get(lc.id).default:null}},moduleName:{configurable:!0,enumerable:!0,get:function(){return this._moduleName}},systemModule:{configurable:!0,enumerable:!0,get:function(){return Ub.module(this.System,this.url)}},System:{configurable:!0,enumerable:!0,get:function(){return this.objectPackage.System}},resource:{configurable:!0,enumerable:!0,
get:function(){return this.objectPackage.resource(this.moduleName)}},url:{configurable:!0,enumerable:!0,get:function(){return this.resource.url}}});Ub.ObjectModule=Gd;Ub.default=xd}}});
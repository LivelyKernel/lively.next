System.register("./__rootModule___commonjs-entry-71573ff5.js ./index-d18accbd.js ./list.cp-8569fe93.js ./popups.cp-68dc8a4a.js ./index-1c08552a.js ./service-worker-8e670339.js ./index-c79abca0.js ./loading-indicator.cp-b18e3b89.js".split(" "),function(Lc,pd){var Nd,Tc,Jc,$d,Bb,rd,Id,Ac,Pc,gd,nd,Fd,ic,vd,sb,Xb,Nb,bc,hb,cb,Hb,ec,ub,yb,ba,wb,Xa,Za,Sb,Cb,Da,zb,db,ib;return{setters:[function(Ea){Nd=Ea.f;Tc=Ea.j;Jc=Ea.B;$d=Ea.k;Bb=Ea.b;rd=Ea.C;Id=Ea.R;Ac=Ea.A;Pc=Ea.w;gd=Ea.u;nd=Ea.a;Fd=Ea.bu;ic=Ea.i;vd=
Ea._;sb=Ea.x;Xb=Ea.aZ;Nb=Ea.I;bc=Ea.T;hb=Ea.c;cb=Ea.Q;Hb=Ea.p;ec=Ea.r},function(Ea){ub=Ea.W;yb=Ea.F;ba=Ea.I},function(Ea){wb=Ea.c;Xa=Ea.a},function(Ea){Za=Ea.c},function(Ea){Sb=Ea.localInterface},function(Ea){Cb=Ea.c;Da=Ea.P},function(Ea){zb=Ea.s},function(Ea){db=Ea.L;ib=Ea.b}],execute:function(){function Ea(Wb,R){return W.apply(this,arguments)}function W(){W=vd(regeneratorRuntime.mark(function Ja(R,xb){var Ga,sa,Ub,vc,Oc,aa,Ma,qb,Vb,Lb,Kb,Db=arguments;return regeneratorRuntime.wrap(function(Ra){for(;;)switch(Ra.prev=
Ra.next){case 0:Ga=2<Db.length&&void 0!==Db[2]?Db[2]:[/systemjs-plugin-babel|.*\.min\.js|.*browserified[^/]+js|dashboard|loading-screen/];sa=3<Db.length&&void 0!==Db[3]?Db[3]:[];Ub=4<Db.length&&void 0!==Db[4]?Db[4]:!0;vc=5<Db.length&&void 0!==Db[5]?Db[5]:!1;Oc=6<Db.length&&void 0!==Db[6]?Db[6]:!1;aa=7<Db.length?Db[7]:void 0;if(!(2>=xb.length)){Ra.next=8;break}return Ra.abrupt("return",[]);case 8:if(System.get("@system-env").worker||!T.config.ide.workerEnabled){Ra.next=12;break}Ra.next=11;return T.callService("doSearch",
{livelySystem:R,searchTerm:xb,excludedModules:Ga,excludedPackages:sa,includeUnloaded:Ub,caseSensitive:vc,regexMode:Oc,progress:aa});case 11:return Ra.abrupt("return",Ra.sent);case 12:return Ra.next=14,R.searchInAllPackages(xb,{caseSensitive:vc,regexMode:Oc,excludedModules:Ga,excludedPackages:sa,includeUnloaded:Ub,progress:aa});case 14:return Ma=Ra.sent,qb=T.arr.partition(Ma,function(N){return N.isError}),Vb=sb(qb,2),Lb=Vb[0],Kb=Vb[1],Lb.length&&T.show("Errors in search results:\n".concat(T.arr.pluck(Lb,
"value").join("\n"))),Ra.abrupt("return",Kb.reduce(function(N,va){var Wa="".concat(va.packageName,"/").concat(va.pathInPackage,":").concat(va.line);N.maxModuleNameLength=Math.max(N.maxModuleNameLength,Wa.length);N.items.push({isListItem:!0,value:va,get string(){return Wa+va.lineString}});return N},{items:[],maxModuleNameLength:0}).items);case 18:case "end":return Ra.stop()}},Ja)}));return W.apply(this,arguments)}var T=window.lively.FreezerRuntime.recorderFor("lively.ide/code-search.js");T.doSearch=
Ea;T.fun=Nd;T.arr=Tc;T.obj=Jc;T.string=$d;T.pt=Bb;T.Color=rd;T.Rectangle=Id;T.config=Ac;T.connect=Pc;T.noUpdate=gd;T.localInterface=Sb;T.LoadingIndicator=db;T.Window=ub;T.FilterableList=yb;T.MorphicDB=nd;T.SnapshotEditor=Fd;T.callService=Cb;T.ProgressMonitor=Da;T.show=zb;T.ModeButtonActive=K;T.ModeButtonDisabled=E;T.ModeButtonInactiveClick=La;T.ModeButtonInactiveHover=jb;T.ModeButtonInactive=ya;T.ModeButtonActiveClick=pb;T.ModeButtonActiveHover=eb;T.doSearch=Ea;var ia=function(Wb){var R=window.lively.FreezerRuntime.recorderFor("lively.ide/code-search.js"),
xb=R.hasOwnProperty("CodeSearcher")&&"function"===typeof R.CodeSearcher?R.CodeSearcher:R.CodeSearcher=function(Ja){if(!Ja||!Ja[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return ic(xb,Wb,[{key:Symbol["for"]("lively-instance-initialize"),value:function(){var Ja=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Ja.targetBrowser&&(Ja.browser=Ja.targetBrowser);ic._get(Object.getPrototypeOf(xb.prototype),Symbol["for"]("lively-instance-initialize"),
this).call(this,Ja);this.reset()}},{key:"onLoad",value:function(){this.reset()}},{key:"reset",value:function(){var Ja=this;this.regexModeActive=this.caseModeActive=!1;this.currentSearchTerm="";T.connect(this,"accepted",this,"openSelection");this.get("list").items=[];this.get("input").input="";this.get("search chooser").items=["in loaded modules","in loaded and unloaded modules","in parts","in worlds"];T.noUpdate(function(){Ja.get("search chooser").selection="in loaded modules"});this.getWindow()&&
(this.getWindow().title="code search");T.connect(this.get("caseMode").viewModel,"fire",this,"caseModeToggled",{converter:'() => target.searchModeToggled("case")'});T.connect(this.get("regexMode").viewModel,"fire",this,"regexModeToggled",{converter:'() => target.searchModeToggled("regex")'});T.connect(this.get("search chooser").viewModel,"selection",this,"handleSpecialSearchModes");T.connect(this.get("search chooser").viewModel,"selection",this,"searchAgain");T.connect(this.get("input"),"inputChanged",
this,"updateFilter");T.connect(this.get("list"),"selection",this,"selectionChanged");T.connect(this.get("list"),"onItemMorphDoubleClicked",this,"acceptInput")}},{key:"handleSpecialSearchModes",value:function(){this.regexModeActive=this.caseModeActive=!1;var Ja=this.get("search chooser").selection;"in worlds"===Ja||"in parts"===Ja?(this.get("caseMode").master={auto:T.ModeButtonDisabled},this.get("regexMode").master={auto:T.ModeButtonDisabled}):[this.get("caseMode"),this.get("regexMode")].forEach(function(Ga){return Ga.master=
{auto:T.ModeButtonInactive,hover:T.ModeButtonInactiveHover,click:T.ModeButtonInactiveClick}})}},{key:"searchModeToggled",value:function(Ja){var Ga="case"===Ja?this.get("caseMode"):this.get("regexMode");if("case"===Ja)var sa=this.caseModeActive=!this.caseModeActive;"regex"===Ja&&(sa=this.regexModeActive=!this.regexModeActive);Ga.master=sa?{auto:T.ModeButtonActive,hover:T.ModeButtonActiveHover,click:T.ModeButtonActiveClick}:{auto:T.ModeButtonInactive,hover:T.ModeButtonInactiveHover,click:T.ModeButtonInactiveClick};
this.searchAgain()}},{key:"ensureIndicator",value:function(Ja,Ga){if(!this.progressIndicator){var sa=this.getWindow();this.progressIndicator=this.addMorph(T.LoadingIndicator.open());sa&&(this.progressIndicator.center=sa.innerBounds().center())}this.progressIndicator.label="Searching Files";this.progressIndicator.status=Ja;Ga&&(this.progressIndicator.progress=Ga)}},{key:"removeIndicator",value:function(){this.progressIndicator&&this.progressIndicator.remove();this.progressIndicator=null}},{key:"updateFilter",
value:function(){var Ja=this,Ga=this.get("input").textString;2>=Ga.length||(this.ensureIndicator("receiving input..."),T.fun.debounceNamed(this.id+"updateFilterDebounced",1200,function(){var sa=vd(regeneratorRuntime.mark(function Oc(vc){return regeneratorRuntime.wrap(function(aa){for(;;)switch(aa.prev=aa.next){case 0:return Ja.removeIndicator(),aa.prev=1,aa.next=4,Ja.searchAndUpdate(vc);case 4:aa.next=9;break;case 6:aa.prev=6,aa.t0=aa["catch"](1),Ja.world().logError(aa.t0);case 9:case "end":return aa.stop()}},
Oc,null,[[1,6]])}));return function(vc){return sa.apply(this,arguments)}}())(Ga))}},{key:"searchAgain",value:function(){var Ja=this.currentSearchTerm;2>=Ja||(this.getSubmorphNamed("list").items=[],this.currentSearchTerm="",this.searchAndUpdate(Ja))}},{key:"searchAndUpdate",value:function(){var Ja=vd(regeneratorRuntime.mark(function Ub(sa){var vc=this,Oc,aa,Ma,qb,Vb,Lb,Kb,Db,Ra,N,va,Wa,pa,tb;return regeneratorRuntime.wrap(function(ab){for(;;)switch(ab.prev=ab.next){case 0:this.get("search chooser").right=
this.width-5;this.get("input").acceptInput();Oc=sa.split(/\s+/).filter(function(Ob){return!!Ob});(aa=this.getWindow())&&aa.targetMorph===this&&(aa.title="".concat(aa.title.split("-")[0].trim()," - ").concat(Oc.join(" + ")));Ma=Oc.shift();qb=Ma!==this.currentSearchTerm;if(!qb){ab.next=34;break}this.currentSearchTerm=Ma;Vb=this.get("search chooser").selection;Lb="in loaded modules"===Vb;Kb="in loaded and unloaded modules"===Vb;Db="in parts"===Vb;Ra="in worlds"===Vb;this.ensureIndicator("searching...");
N=new T.ProgressMonitor({handlers:{loadingIndicatorUpdater:function(Ob,yc){vc.ensureIndicator(Ob,yc)}}});if(!Lb&&!Kb){ab.next=22;break}ab.next=19;return T.doSearch(this.systemInterface,Ma,void 0,T.config.ide.js.ignoredPackages,!!Kb,this.caseModeActive,this.regexModeActive,N);case 19:this.items=ab.sent;ab.next=32;break;case 22:if(!Db&&!Ra){ab.next=32;break}ab.next=25;return $world.addProgressBar({label:"morphicdb search"});case 25:return va=ab.sent,Wa=Ra?"world":"part",ab.next=29,T.MorphicDB["default"].codeSearchInPackages(Ma,
Wa,function(Ob,yc,Ta){return Object.assign(va,{label:Ob,progress:yc/Ta})});case 29:pa=ab.sent,va.remove(),this.items=pa.map(function(Ob){var yc=Ob.file.path.slice(1).reduce(function(Ta,Bd){return T.string.joinPath(Ta,Bd)});300<=Ob.lineString&&(Ob.lineString=T.string.truncate(Ob.lineString,300));Ob.isMorphicDBFind=!0;return{isListItem:!0,string:"[".concat(Ob.commit.type,"/").concat(Ob.commit.name,"] ").concat(yc,":").concat(Ob.line," ").concat(Ob.lineString),value:Ob}});case 32:this.removeIndicator(),
this.progressIndicator=null;case 34:if(Oc=Oc.map(function(Ob){return Ob.toLowerCase()}),qb||this.currentFilters!==Oc.join("+"))this.currentFilters=Oc.join("+"),tb=this.items.filter(function(Ob){return Oc.every(function(yc){return Ob.string.toLowerCase().includes(yc)})}),this.get("list").items=tb;case 36:case "end":return ab.stop()}},Ub,this)}));return function(sa){return Ja.apply(this,arguments)}}()},{key:"openSelection",value:function(){var Ja=vd(regeneratorRuntime.mark(function sa(){var Ub;return regeneratorRuntime.wrap(function(vc){for(;;)switch(vc.prev=
vc.next){case 0:if(Ub=this.selection){vc.next=3;break}return vc.abrupt("return");case 3:if(!Ub.isMorphicDBFind){vc.next=5;break}return vc.abrupt("return",(new T.SnapshotEditor(Ub.commit)).interactivelyEditFileInSnapshotPackage(Ub.file,function(){},{row:Ub.line,column:0}));case 5:return vc.abrupt("return",this.openBrowserForSelection());case 6:case "end":return vc.stop()}},sa,this)}));return function(){return Ja.apply(this,arguments)}}()},{key:"openBrowserForSelection",value:function(){var Ja=vd(regeneratorRuntime.mark(function sa(){var Ub,
vc,Oc,aa,Ma,qb,Vb,Lb,Kb;return regeneratorRuntime.wrap(function(Db){for(;;)switch(Db.prev=Db.next){case 0:if(this.selection){Db.next=2;break}return Db.abrupt("return");case 2:return Ub=this.browser,vc=this.selection,Oc=vc.column,aa=vc.line,Ma=vc.packageName,qb=vc.pathInPackage,Vb=Ub,Lb={packageName:Ma,moduleName:qb,textPosition:{column:Oc,row:aa-1}},Db.next=7,pd.import("./ui.cp-04e9d052.js");case 7:return Kb=Db.sent,Db.next=10,Kb.browse(Lb,Vb||{},Ub?Ub.systemInterface:this.systemInterface);case 10:return Ub=
Db.sent,Ub.associatedSearchPanel=this,Db.abrupt("return",Ub.getWindow().activate());case 13:case "end":return Db.stop()}},sa,this)}));return function(){return Ja.apply(this,arguments)}}()},{key:"onWindowActivated",value:function(){this.get("input").selectAll()}},{key:"commands",get:function(){var Ja=this.get("search chooser");return ic._get(Object.getPrototypeOf(xb.prototype),"commands",this).concat([{name:"toggle search in unloaded modules",exec:function(){Ja.selection="in loaded modules"===Ja.selection?
"in loaded and unloaded modules":"in loaded modules";return!0}},{name:"toggle search in parts",exec:function(){Ja.selection="in parts";return!0}},{name:"toggle search in worlds",exec:function(){Ja.selection="in worlds";return!0}}])}},{key:"keybindings",get:function(){return[{keys:"F1",command:"toggle search in unloaded modules"},{keys:"F2",command:"toggle search in parts"},{keys:"F3",command:"toggle search in worlds"}].concat(ic._get(Object.getPrototypeOf(xb.prototype),"keybindings",this))}}],[{key:Symbol["for"]("__LivelyClassName__"),
get:function(){return"CodeSearcher"}},{key:"inWindow",value:function(){var Ja=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{title:"code search",targetBrowser:null,systemInterface:null},Ga=new this(Ja);Ja=new T.Window(Object.assign({},T.obj.dissoc(Ja,["targetBrowser","systemInterface"]),{extent:Ga.extent.addXY(0,25),targetMorph:Ga}));T.connect(Ja,"windowActivated",Ga,"onWindowActivated");return Ja}},{key:"properties",get:function(){return{fill:{defaultValue:T.Color.transparent},extent:{defaultValue:T.pt(800,
500)},fontFamily:{defaultValue:"Monaco, monospace"},fontSize:{defaultValue:12},inputPadding:{defaultValue:T.Rectangle.inset(5)},itemPadding:{defaultValue:T.Rectangle.inset(4,2)},borderWidth:{defaultValue:0},historyId:{defaultValue:"lively.morphic-code searcher"},submorphs:{initialize:function(){this.submorphs=[{type:"input",name:"input",placeholder:"Search Source Files",fontColor:T.Color.gray.darker(),defaultTextStyle:{fontSize:14},autofit:!0,fill:T.Color.white.withA(.5)},{name:"list",type:"list",
items:[],clipMode:"auto",borderTop:{width:1,color:T.Color.gray}}]}},input:{after:["submorphs"],derived:!0,get:function(){return this.getSubmorphNamed("input").input},set:function(Ja){this.getSubmorphNamed("input").input=Ja}},browser:{set:function(Ja){this.setProperty("browser",Ja?Ja.id:null)},get:function(){var Ja=this.world(),Ga=this.getProperty("browser");return Ja&&Ga?Ja.getMorphWithId(Ga):null}},systemInterface:{after:["browser"],derived:!0,get:function(){var Ja=this.browser;return Ja?Ja.systemInterface:
this.getProperty("systemInterface")||T.localInterface},set:function(Ja){var Ga=this.browser;Ga?Ga.systemInterface=Ja:this.setProperty("systemInterface",Ja)}},currentSearchTerm:{defaultValue:""},currentFilters:{defaultValue:""}}}}],R,{pathInPackage:function(){return"./code-search.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:2293,
end:13959})}(T.FilterableList);T.CodeSearcher=ia;T.CodeSearcher=ia;K=Object.freeze({__proto__:null,doSearch:Ea,CodeSearcher:ia});Lc("c",K);var ka=window.lively.FreezerRuntime.recorderFor("lively.ide/code-search.cp.js");ka.ProportionalLayout=Xb;ka.Icon=Nb;ka.TilingLayout=bc;ka.component=hb;ka.add=cb;ka.part=Hb;ka.pt=Bb;ka.Color=rd;ka.rect=ec;ka.InputLineDefault=ba;ka.DropDownList=wb;ka.DefaultList=Xa;ka.SystemList=Za;ka.CodeSearcher=ia;ka.ButtonDefault=ib;ka.ModeButtonInactive=ka.component["for"](function(){return ka.component(ka.ButtonDefault,
{extent:ka.pt(27,27),borderStyle:"none",fill:ka.Color.transparent})},{module:"lively.ide/code-search.cp.js","export":"ModeButtonInactive",range:{start:460,end:581}},ka.ModeButtonInactive);ka.ModeButtonInactiveHover=ka.component["for"](function(){return ka.component(ka.ModeButtonInactive,{fill:ka.Color.gray})},{module:"lively.ide/code-search.cp.js","export":"ModeButtonInactiveHover",range:{start:589,end:668}},ka.ModeButtonInactiveHover);ka.ModeButtonActiveClick=ka.ModeButtonInactiveHover;ka.ModeButtonInactiveClick=
ka.component["for"](function(){return ka.component(ka.ModeButtonInactive,{fill:ka.Color.darkGray})},{module:"lively.ide/code-search.cp.js","export":"ModeButtonInactiveClick",range:{start:731,end:814}},ka.ModeButtonInactiveClick);ka.ModeButtonActiveHover=ka.ModeButtonInactiveClick;ka.ModeButtonActive=ka.component["for"](function(){return ka.component(ka.ModeButtonInactive,{fill:ka.Color.darkGray,submorphs:[{name:"label",fontColor:ka.Color.white}]})},{module:"lively.ide/code-search.cp.js","export":"ModeButtonActive",
range:{start:877,end:1021}},ka.ModeButtonActive);ka.ModeButtonDisabled=ka.component["for"](function(){return ka.component(ka.ModeButtonInactive,{visible:!1,reactsToPointer:!1})},{module:"lively.ide/code-search.cp.js","export":"ModeButtonDisabled",range:{start:1029,end:1127}},ka.ModeButtonDisabled);ka.CodeSearch=ka.component["for"](function(){return ka.component({type:ka.CodeSearcher,name:"code search",acceptsDrops:!1,extent:ka.pt(538,306),layout:new ka.ProportionalLayout({lastExtent:{x:538,y:306},
reactToSubmorphAnimations:!1,submorphSettings:[["input",{x:"resize",y:"fixed"}],["list",{x:"resize",y:"resize"}],["searchInUnloadedModulesCheckbox",{x:"move",y:"move"}],["search in parts checkbox",{x:"move",y:"move"}],["search in worlds checkbox",{x:"move",y:"move"}],["search chooser",{x:"move",y:"fixed"}]]}),selectedAction:"default",submorphs:[ka.part(ka.DefaultList,{name:"list",extent:ka.pt(538.7,279.6),fontFamily:"Monaco, monospace",itemPadding:ka.rect(4,2,0,0),padding:ka.rect(2,0,0,0),position:ka.pt(0,
27)}),ka.part(ka.InputLineDefault,{name:"input",layout:new ka.TilingLayout({align:"center",axisAlign:"center",justifySubmorphs:"spaced",orderByIndex:!0,padding:ka.rect(5,0,0,0),wrapSubmorphs:!1}),borderWidth:1,dropShadow:null,fontSize:14,borderRadius:0,extent:ka.pt(538.7,27),historyId:"lively.morphic-code searcher",placeholder:"Search Source Files",submorphs:[{name:"placeholder",extent:ka.pt(133,27),fontSize:14,padding:ka.rect(5,5,0,0),textAndAttributes:["Search Source Files",null]},ka.add({name:"buffer",
opacity:0,reactsToPointer:!1}),ka.add({name:"holder",layout:new ka.TilingLayout({axisAlign:"center",spacing:2,align:"center",axis:"column"}),submorphs:[ka.part(ka.ModeButtonInactive,{name:"caseMode",height:22,submorphs:[{name:"label",textAndAttributes:ka.Icon.textAttribute("circle-h")}],master:{auto:ka.ModeButtonInactive,hover:ka.ModeButtonInactiveHover,click:ka.ModeButtonInactiveClick},tooltip:"Search Case Sensitive"}),ka.part(ka.ModeButtonInactive,{name:"regexMode",height:22,submorphs:[{name:"label",
textAndAttributes:ka.Icon.textAttribute("circle-question")}],master:{auto:ka.ModeButtonInactive,hover:ka.ModeButtonInactiveHover,click:ka.ModeButtonInactiveClick},tooltip:"Search based on regular expressions.\nRegular expression should be given without quotes or literal mode slashes."}),ka.part(ka.DropDownList,{name:"search chooser",master:{auto:ka.ModeButtonActive,click:ka.ModeButtonInactiveClick},layout:new ka.TilingLayout({align:"center",axisAlign:"center",orderByIndex:!0,padding:ka.rect(10,0,
0,0),wrapSubmorphs:!1,hugContentsHorizontally:!0}),extent:ka.pt(125.7,22),borderColor:ka.Color.gray,viewModel:{openListInWorld:!0,listMaster:ka.SystemList,items:["in loaded modules","in loaded and unloaded modules","in parts","in worlds"]},submorphs:[{name:"label",fontSize:12}]})]})]})]})},{module:"lively.ide/code-search.cp.js","export":"CodeSearch",range:{start:1170,end:4639}},ka.CodeSearch);ia=Lc("C",ka.CodeSearch);var K=ka.ModeButtonActive,ya=ka.ModeButtonInactive,pb=ka.ModeButtonActiveClick,La=
ka.ModeButtonInactiveClick,eb=ka.ModeButtonActiveHover,jb=ka.ModeButtonInactiveHover,E=ka.ModeButtonDisabled;ka.CodeSearch=ia;ka.ModeButtonActive=K;ka.ModeButtonInactive=ya;ka.ModeButtonActiveClick=pb;ka.ModeButtonInactiveClick=La;ka.ModeButtonActiveHover=eb;ka.ModeButtonInactiveHover=jb;ka.ModeButtonDisabled=E}}});
System.register(["./__root_module__-3d4e820f.js","kld-intersections"],function(ra){var kb,zb,Sb,Mb,Fd,Jc,wd,Kc,Fc,Wc,hd,Id,nd;return{setters:[function(Xc){kb=Xc.bu;zb=Xc.a6;Sb=Xc.r;Mb=Xc.a7;Fd=Xc.bo;Jc=Xc.bv;wd=Xc.bw;Kc=Xc.U;Fc=Xc.s;Wc=Xc.bx;hd=Xc.by;Id=Xc.n;nd=Xc.bz},function(){}],execute:function(){function Xc(I){try{var T=eval("("+sa.ast.transform.wrapInFunction("var _; _ = ("+I+")")+")()")}catch(ua){return JSON.parse(I)}return"object"!==typeof T?null:T}function Na(I,T){var ua,Da,Kb,Db,Fa,
ac,Gd,fd,Gc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ea){switch(Ea.nextAddress){case 1:return ua=T.world(),Ea.yield(ua.prompt("Enter package name",{requester:T,input:"",historyId:"lively.vm-editor-add-package-name",useLastInput:!0}),2);case 2:Da=Ea.yieldResult;if(!Da)throw"Canceled";Ea.setCatchFinallyBlocks(3);Db=Ca.resource(Da);Da=Db.name();Kb=Db.url;Ea.leaveTryBlock(4);break;case 3:return Ea.enterCatchBlock(),Ea.yield(I.getConfig(),5);case 5:return Fa=Ea.yieldResult.baseURL,ac=
Ca.resource(Fa).join(Da).asDirectory().url,Ea.yield(I.normalize(ac),6);case 6:Kb=Ea.yieldResult.replace(/\/\.js$/,"/");case 4:return Ea.yield(ua.prompt("Confirm or change package location",{requester:T,input:Kb,historyId:"lively.vm-editor-add-package-address"}),7);case 7:Gd=Ea.yieldResult;if(!Gd)throw"Canceled";fd=Ca.resource(Gd).asDirectory();Gc=fd.asFile().url;return Ea.yield(I.removePackage(Gc),8);case 8:return Ea.yield(I.resourceCreateFiles(Gc,{"index.js":"'format esm';\n","package.json":'{\n  "name": "'+
Da+'",\n  "version": "0.1.0"\n}',".gitignore":"node_modules/","README.md":"# "+Da+"\n\nNo description for package "+Da+" yet.\n",tests:{"test.js":'import { expect } from "mocha-es6";\ndescribe("'+Da+'", () => {\n  it("works", () => {\n    expect(1 + 2).equals(3);\n  });\n});'}}),9);case 9:return Ea.return(Ca.loadPackage(I,{name:Da,address:Gc,configFile:fd.join("package.json").url,main:fd.join("index.js").url,test:fd.join("tests/test.js").url,type:"package"}))}})}function nb(I,T,ua){ua=void 0===ua?
null:ua;var Da,Kb,Db,Fa,ac,Gd,fd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gc){switch(Gc.nextAddress){case 1:return Da={name:"",address:"",type:"package"},Gc.yield(I.getConfig(),2);case 2:Kb=Gc.yieldResult;if(!ua){Gc.jumpTo(3);break}return Gc.yield(I.getPackage(ua),4);case 4:if(Db=Gc.yieldResult){Gc.jumpTo(5);break}return Gc.yield(I.getPackageForModule(ua),6);case 6:Db=Gc.yieldResult;case 5:Fa=Db;case 3:return Gc.yield(T.world().prompt("What is the package directory?",{requester:T,
input:Fa?Fa.address:Kb.baseURL,historyId:"lively.vm-editor-package-load-history",useLastInput:!1}),7);case 7:ac=Gc.yieldResult;if(!ac)throw"Canceled";Da.address=ac.replace(/\/$/,"");Da.url=new URL(Da.address+"/");Da.configFile=Ca.resource(Da.url).join("package.json").url;Gc.setCatchFinallyBlocks(8);Gd=JSON;fd=Gd.parse;return Gc.yield(I.moduleRead(Da.configFile),10);case 10:fd.call(Gd,Gc.yieldResult).name;Gc.leaveTryBlock(9);break;case 8:Gc.enterCatchBlock(),Da.name=String(Da.url).replace(/\/$/,""),
I.resourceEnsureExistance(Da.configFile,'{\n  "name": "'+Da.name+'",\n  "version": "0.1.0"\n}');case 9:return Gc.return(Ca.loadPackage(I,Da))}})}function Pb(I,T,ua){var Da,Kb,Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return Da=Ca.resource(ua).asFile().url,Fa.yield(I.getPackage(Da),2);case 2:if(Kb=Fa.yieldResult){Fa.jumpTo(3);break}return Fa.yield(I.getPackageForModule(Da),4);case 4:Kb=Fa.yieldResult;case 3:Db=Kb;if(!Db)throw Error("Cannot find package for "+
Da);return Fa.yield(I.reloadPackage(Da),5);case 5:if(!T){Fa.jumpTo(0);break}return Fa.yield(T.updateModuleList(),7);case 7:return Fa.yield(T.uiSelect(Da,!1),8);case 8:return Fa.return(Fa.yieldResult)}})}function Wb(I,T,ua,Da){var Kb,Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return Fa.yield(I.getPackage(ua),2);case 2:return Kb=Fa.yieldResult,Fa.yield((Da||$world).confirm("Unload package "+Kb.name+"?",{requester:T}),3);case 3:Db=Fa.yieldResult;
if(!Db)throw"Canceled";return Fa.yield(I.removePackage(ua),4);case 4:if(!T){Fa.jumpTo(0);break}return Fa.yield(T.updateModuleList(),6);case 6:return Fa.yield(T.uiSelect(null),0)}})}function Pc(I,T,ua){var Da,Kb,Db,Fa,ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gd){switch(Gd.nextAddress){case 1:return Da=T.world(),Gd.yield(I.getPackage(ua),2);case 2:return Kb=Gd.yieldResult,Kb?Gd.yield(Da.confirm("Really remove package "+Kb.name+"?",{requester:T}),3):($world.inform('No package "'+
ua+'" found!',{requester:T}),Gd.return());case 3:Db=Gd.yieldResult;if(!Db)throw"Canceled";I.removePackage(ua);return Gd.yield(Da.confirm("Also remove directory "+Kb.name+" including "+Kb.modules.length+" modules?"),4);case 4:Fa=Gd.yieldResult;if(!Fa){Gd.jumpTo(0);break}return Gd.yield(Da.confirm("REALLY *remove* directory "+Kb.name+"? No undo possible..."),6);case 6:if(ac=Gd.yieldResult)return Gd.yield(I.resourceRemove(Kb.address),0);Gd.jumpTo(0)}})}function Bd(I,T,ua){ua=void 0===ua?$world:ua;var Da,
Kb,Db,Fa,ac,Gd,fd,Gc,Ea,Oc,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kd){switch(kd.nextAddress){case 1:return kd.yield(I.getPackage(T),2);case 2:Da=kd.yieldResult;if(!Da)throw Error("Cannot find package "+T);Kb=[];Db=$jscomp.makeIterator(Da.modules);Fa=Db.next();case 3:if(Fa.done)return kd.yield(ua.execCommand("open text window",{title:"imports and exports of "+T,content:Kb.join("\n\n")}),0);ac=Fa.value;if(!ac.name.match(/\.js$/)){kd.jumpTo(4);break}kd.setCatchFinallyBlocks(6);
Gd=I;fd=Gd.importsAndExportsOf;Gc=ac.name;return kd.yield(I.moduleRead(ac.name),9);case 9:return kd.yield(fd.call(Gd,Gc,kd.yieldResult),8);case 8:Ea=kd.yieldResult;kd.leaveTryBlock(7);break;case 6:Oc=kd.enterCatchBlock();ua.logError(Error("Error when getting imports/exports from module "+ac.name+":\n"+Oc.stack));kd.jumpTo(4);break;case 7:Va=""+ac.name;if(!Ea.imports.length&&!Ea.exports.length){Va+="\n  does not import / export anything";kd.jumpTo(4);break}Ea.imports.length&&(Va+="\n  imports:\n",
Va+=Ca.arr.groupByKey(Ea.imports,"fromModule").mapGroups(function(Ka,Wa){return"from "+Ka+": "+Wa.map(function(db){return db.local||db.imported?db.imported&&db.imported!==db.local?db.imported+" as "+db.local:db.local:"nothing imported"}).join(", ")}).toArray().join("\n").split("\n").map(function(Ka){return"    "+Ka}).join("\n"));Ea.exports.length&&(Va+="\n  exports:\n",Va+=Ea.exports.map(function(Ka){return Ka.local?Ka.local&&Ka.local!==Ka.exported?Ka.local+" as "+Ka.exported:Ka.exported:Ka.exported+
" from "+Ka.fromModule}).join(", ").split("\n").map(function(Ka){return"    "+Ka}).join("\n"));Kb.push(Va);case 4:Fa=Db.next(),kd.jumpTo(3)}})}function Hb(I,T,ua){ua=ua&&ua.address;if(ua&&0===T.indexOf(ua))var Da=T.slice(ua.length).replace(/^\//,"");else a:{ua=I.getConfig();if(!ua||ua.constructor!==Promise)try{Da=String((new URL(T)).relativePathFrom(new URL(I.getConfig().baseURL)));break a}catch(Kb){}Da=T}return Da}function Ub(I,T,ua,Da){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Kb){return 1==
Kb.nextAddress?(Da=Object.assign({targetModule:T},Da),Kb.yield(I.normalize(T),2)):3!=Kb.nextAddress?(T=Kb.yieldResult,Kb.yield(I.moduleSourceChange(T,ua,Da),3)):Kb.return(T)})}function vb(I,T,ua,Da,Kb){Da=void 0===Da?!1:Da;Kb=void 0===Kb?!1:Kb;var Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return T&&T.setStatusMessage("Reloading "+ua),Fa.setCatchFinallyBlocks(2),Fa.yield(I.reloadModule(ua,{reloadDeps:Da,resetEnv:Kb}),4);case 4:if(!T){Fa.jumpTo(5);
break}return Fa.yield(T.updateModuleList(),6);case 6:case 5:T&&T.setStatusMessage("Reloded "+ua);Fa.leaveTryBlock(0);break;case 2:Db=Fa.enterCatchBlock();Fa.setCatchFinallyBlocks(7);if(!T){Fa.jumpTo(9);break}return Fa.yield(T.updateEditorWithSourceOf(ua),10);case 10:case 9:Fa.leaveTryBlock(8);break;case 7:Fa.enterCatchBlock();case 8:throw T&&T.showError(Db),Db;}})}function kc(I,T,ua){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){switch(Da.nextAddress){case 1:return Da.yield(I.forgetModule(ua,
{forgetEnv:!0,forgetDeps:!0}),2);case 2:if(!T){Da.jumpTo(3);break}return Da.yield(T.updateModuleList(),4);case 4:case 3:Da.jumpToEnd()}})}function xc(I,T,ua){var Da,Kb,Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return Fa.yield(I.normalize(ua),2);case 2:return Da=Fa.yieldResult,Fa.yield(T.world().confirm("Remove file "+Da+"?",{requester:T}),3);case 3:Kb=Fa.yieldResult;if(!Kb)throw"Canceled";return Fa.yield(I.forgetModule(Da),4);case 4:return Fa.yield(I.resourceRemove(Da),
5);case 5:return Fa.yield(I.getPackageForModule(Da),6);case 6:return Db=Fa.yieldResult,Fa.return(Db)}})}function Dc(I,T,ua){var Da,Kb,Db,Fa,ac,Gd,fd,Gc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ea){switch(Ea.nextAddress){case 1:return Da=URL,Ea.yield(I.getConfig(),2);case 2:Kb=new Da(Ea.yieldResult.baseURL);Db=T.world();if(!ua){Ea.jumpTo(3);break}return Ea.yield(I.getPackage(ua),4);case 4:if(Fa=Ea.yieldResult){Ea.jumpTo(5);break}return Ea.yield(I.getPackageForModule(ua),6);case 6:Fa=
Ea.yieldResult;case 5:(ac=Fa)&&(Kb=new URL(ac.address));case 3:return Ea.yield(bb._searchForExistingFiles(T,String(Kb),ac),7);case 7:Gd=Ea.yieldResult;if(!Gd.includes("[create new module]")){Ea.jumpTo(8);break}return Ea.yield(bb._askForModuleName(I,ua||String(Kb),Db),9);case 9:fd=Ea.yieldResult,Gd=[fd];case 8:return Ea.yield(bb._createAndLoadModules(I,Gd),10);case 10:return Gc=Ea.yieldResult,bb.arr.compact(Gc.map(function(Oc){return Oc.error})),Ea.return(Gc)}})}function Gb(I,T){var ua,Da,Kb,Db,Fa,
ac,Gd,fd,Gc,Ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oc){if(1==Oc.nextAddress)return Oc.yield(I.getPackage(T),2);if(3!=Oc.nextAddress){ua=Oc.yieldResult;if(!ua||!ua.address.match(/^http/))throw Error("Cannot load package "+T);Da=bb.resource(ua.address);Kb=[];Db=$jscomp;Fa=Db.makeIterator;return Oc.yield(Da.dirList(5,{exclude:bb.modulesInPackage_defaultExclude}),3)}ac=Fa.call(Db,Oc.yieldResult);for(Gd=ac.next();!Gd.done;Gd=ac.next())Gc=fd=Gd.value,Ea=Gc.url,Ea.match(/\.js$/)&&
I.isModuleLoaded(Ea,!0)&&Kb.push(I.getModule(Ea));return Oc.return(Kb)})}function $a(I,T){T=void 0===T?[]:T;var ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){if(1==Da.nextAddress)return Da.yield(System.import("mocha-es6/index.js"),2);ua=Da.yieldResult;return Da.return(ua.loadTestModuleAndExtractTestState(I,T))})}function dc(I,T,ua,Da){function Kb(Oc){return new Promise(function(Va,kd){var Ka=rb.arr.compact(Oc.suite.suites).map(function(db){return db.file}),Wa=rb.chain(T).filter(function(db){return Ka.includes(db.file)}).pluck("tests").flatten().value();
if(!Wa||!Wa.length)return kd(Error("Trying to run tests of "+Ka.join(", ")+" but cannot find them in loaded tests!"));Oc.reporter(function(db){db.on("test",function(Zc){try{var xd=Wa.find(function(Wd){return Wd.fullTitle===Zc.fullTitle()});xd.state="running";"function"===typeof ua&&ua(xd,"test")}catch(Wd){"function"===typeof Da&&Da(Wd,"test")}});db.on("pass",function(Zc){try{var xd=Wa.find(function(Wd){return Wd.fullTitle===Zc.fullTitle()});xd.state="succeeded";xd.duration=Zc.duration;"function"===
typeof ua&&ua(xd,"pass")}catch(Wd){"function"===typeof Da&&Da(Wd,"pass")}});db.on("fail",function(Zc,xd){try{var Wd=function(Rd,bd,Fb){Rd.state="failed";Rd.duration=Rd.duration;Rd.error=bd},le=Wa.find(function(Rd){return Rd.fullTitle===Zc.fullTitle()});if(le)Wd(le,xd,Zc.duration);else{var yc=rb.arr.invoke(Zc.parent.tests,"fullTitle");Wa.filter(function(Rd){return yc.includes(Rd.fullTitle)}).forEach(function(Rd){return Wd(Rd,xd,Zc.duration)})}"function"===typeof ua&&ua(le,"fail")}catch(Rd){"function"===
typeof Da&&Da(Rd,"fail")}})});Oc.run(function(db){return Va({testsByFile:T,mocha:Oc})})})}var Db,Fa,ac,Gd,fd,Gc,Ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oc){switch(Oc.nextAddress){case 1:Db=$jscomp.makeIterator(T),Fa=Db.next();case 2:if(Fa.done){Oc.jumpTo(4);break}Gd=ac=Fa.value;fd=Gd.file;return Oc.yield(rb.loadMochaTestFile(fd,T),5);case 5:return Gc=Oc.yieldResult,Ea=Gc.mocha,I&&(Ea=Ea.grep(I)),Oc.yield(Kb(Ea),3);case 3:Fa=Db.next();Oc.jumpTo(2);break;case 4:return Oc.return({mocha:Ea,
testsByFile:T})}})}function oc(I){I||(I="local");if(I.isSystemInterface)var T=I;else"string"===typeof I&&I.startsWith("l2l ")&&(I={type:"l2l",id:I.split(" ")[1]}),"string"!==typeof I&&"l2l"===I.type&&(T=wc.l2lInterfaceFor(I.id,I.info)),"string"!==typeof I&&($world.setStatusMessage("Unknown system interface "+I),I="local"),T||(T=I&&"local"!==I?wc.serverInterfaceFor(I):wc.localInterface);return T}ra("systemInterfaceNamed",oc);var sa=lively.FreezerRuntime.recorderFor("lively-system-interface/helpers.js");
sa.parseJsonLikeObj=Xc;sa.ast=kb;sa.parseJsonLikeObj=Xc;sa.parseJsonLikeObj=Xc;var Ca=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/packages.js");Ca.loadPackage=function(I,T){var ua,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Kb){switch(Kb.nextAddress){case 1:return Kb.yield(I.importPackage(T.address+"/"),2);case 2:if(!T.main){Kb.jumpTo(3);break}return Kb.yield(I.importModule(T.main.toString()),3);case 3:if(!T.test){Kb.jumpTo(5);break}Kb.setCatchFinallyBlocks(6);
return Kb.yield(I.importPackage("mocha-es6"),8);case 8:return ua=Kb.yieldResult,Kb.yield(ua.installSystemInstantiateHook(),9);case 9:return Kb.yield(I.importModule(T.test.toString()),10);case 10:Kb.leaveTryBlock(5);break;case 6:Da=Kb.enterCatchBlock(),console.warn("Cannot load test of new package: "+Da);case 5:return Kb.return(I.getPackage(T.address))}})};Ca.interactivelyCreatePackage=Na;Ca.interactivelyLoadPackage=nb;Ca.interactivelyReloadPackage=Pb;Ca.interactivelyUnloadPackage=Wb;Ca.interactivelyRemovePackage=
Pc;Ca.showExportsAndImportsOf=Bd;Ca.parseJsonLikeObj=Xc;Ca.arr=zb;Ca.resource=Sb;Ca.interactivelyCreatePackage=Na;Ca.interactivelyCreatePackage=Na;Ca.interactivelyLoadPackage=nb;Ca.interactivelyLoadPackage=nb;Ca.interactivelyReloadPackage=Pb;Ca.interactivelyReloadPackage=Pb;Ca.interactivelyUnloadPackage=Wb;Ca.interactivelyUnloadPackage=Wb;Ca.interactivelyRemovePackage=Pc;Ca.interactivelyRemovePackage=Pc;Ca.showExportsAndImportsOf=Bd;Ca.showExportsAndImportsOf=Bd;var bb=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/modules.js");
bb.shortModuleName=Hb;bb.interactivelyChangeModule=Ub;bb.interactivelyReloadModule=vb;bb.interactivelyUnloadModule=kc;bb.interactivelyRemoveModule=xc;bb.interactivelyAddModule=Dc;bb._askForModuleName=function(I,T,ua){var Da,Kb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){switch(Db.nextAddress){case 1:return Db.yield(ua.prompt("Enter module name",{input:T,historyId:"lively.vm-editor-add-module-name"}),2);case 2:T=Db.yieldResult;if(!T)throw"Canceled";return Db.yield(I.normalize(T),
3);case 3:return Da=Db.yieldResult,Db.yield(ua.confirm(["Create module \n",{},Da,{fontStyle:"italic"}," ?",{}],{lineWrapping:!1}),4);case 4:Kb=Db.yieldResult;if(!Kb)throw"Canceled";return Db.return(Da)}})};bb._searchForExistingFiles=function(I,T,ua){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){return String(T).match(/^http/)?Da.return(bb._searchForExistingFilesWeb(I,T,ua)):Da.return(bb._searchForExistingFilesManually(I,T,ua))})};bb._searchForExistingFilesManually=function(I,T,ua){var Da,
Kb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){switch(Db.nextAddress){case 1:return Db.yield(I.world().multipleChoicePrompt("Add Module",{requester:I,choices:["Create New Module","Load Existing Module"]}),2);case 2:Da=Db.yieldResult;if("Create New Module"===Da)return Db.return("[create new module]");if("Load Existing Module"!==Da){Db.jumpTo(3);break}return Db.yield(I.world().prompt("URL of module?",{input:T,requester:I,historyId:"lively.vm._searchForExistingFilesManually.url-of-module"}),
4);case 4:if(Kb=Db.yieldResult)return Db.return([Kb]);case 3:throw"Canceled";}})};bb._searchForExistingFilesWeb=function(I,T,ua){function Da(Gc){Gc.name();return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes(Gc.name())||ua&&bb.arr.pluck(ua.modules,"name").includes(Gc.url)?!0:!1}var Kb,Db,Fa,ac,Gd,fd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gc){switch(Gc.nextAddress){case 1:return(Kb=I.world())&&(Db=Kb.showLoadingIndicatorFor(I,"Loading existing modules...")),
Gc.yield(bb.resource(T).dirList(5,{exclude:Da}),3);case 3:return Gc.yield(Gc.yieldResult.map(function(Ea){return Ea.url}),2);case 2:return Fa=Gc.yieldResult,ac=[{isListItem:!0,string:"[create new module]",value:"[create new module]"}].concat(Fa.filter(function(Ea){return Ea.endsWith(".js")}).map(function(Ea){return{isListItem:!0,string:ua&&0==Ea.indexOf(ua.address)?ua.name+Ea.slice(ua.address.length):Ea,value:Ea}})),Gc.yield(Promise.resolve(Db&&Db.remove()).then(function(){return I.world().filterableListPrompt("What module to load?",
ac,Object.assign({filterLabel:"filter: ",multiselect:!0,requester:I},I?{extent:I.bounds().extent().withY(400).subXY(50,0)}:{}))}),4);case 4:Gd=Gc.yieldResult;if(!Gd||"canceled"===Gd.status||!Gd.selected.length)throw"Canceled";fd=Gd.selected||Gd;Array.isArray(fd)||(fd=[fd]);return Gc.return(fd)}})};bb._createAndLoadModules=function(I,T){var ua,Da,Kb,Db,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ac){switch(ac.nextAddress){case 1:Array.isArray(T)||(T=[T]),ua=[],Da=$jscomp.makeIterator(T),
Kb=Da.next();case 2:if(Kb.done){ac.jumpTo(4);break}Db=Kb.value;return ac.yield(I.forgetModule(Db,{forgetDeps:!1,forgetEnv:!1}),5);case 5:return ac.yield(I.resourceEnsureExistance(Db,'"format esm";\n'),6);case 6:return ac.setCatchFinallyBlocks(7),ac.yield(I.importModule(Db),9);case 9:ua.push({name:Db});ac.leaveTryBlock(3);break;case 7:Fa=ac.enterCatchBlock(),ua.push({name:Db,error:Fa});case 3:Kb=Da.next();ac.jumpTo(2);break;case 4:return ac.return(ua)}})};bb.modulesInPackage_defaultExclude=function(I){return[".git",
"node_modules",".optimized-loading-cache",".module_cache"].includes(I.name())?!0:!1};bb.modulesInPackage=Gb;bb.obj=Mb;bb.arr=zb;bb.resource=Sb;bb.shortModuleName=Hb;bb.shortModuleName=Hb;bb.interactivelyChangeModule=Ub;bb.interactivelyChangeModule=Ub;bb.interactivelyReloadModule=vb;bb.interactivelyReloadModule=vb;bb.interactivelyUnloadModule=kc;bb.interactivelyUnloadModule=kc;bb.interactivelyRemoveModule=xc;bb.interactivelyRemoveModule=xc;bb.interactivelyAddModule=Dc;bb.interactivelyAddModule=Dc;
bb.modulesInPackage=Gb;bb.modulesInPackage=Gb;var rb=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/mocha-tests.js");rb.loadMochaTestFile=$a;rb.runMochaTests=dc;rb.arr=zb;rb.chain=Fd;rb.loadMochaTestFile=$a;rb.loadMochaTestFile=$a;rb.runMochaTests=dc;rb.runMochaTests=dc;var qb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/interface.js");qb.todo=function(I){throw Error(I+" is not yet implemented!");};qb.parseJsonLikeObj=Xc;qb.arr=zb;qb.Closure=Jc;qb.obj=
Mb;qb.resource=Sb;qb.transform=wd;qb.modules=Kc;var Sa=function(){};Sa.prototype.dynamicCompletionsForPrefix=function(I,T,ua){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){qb.todo("dynamicCompletionsForPrefix");Da.jumpToEnd()})};Sa.prototype.runEval=function(I,T){qb.todo("runEval")};Sa.prototype.resourceExists=function(I){qb.todo("resourceExists")};Sa.prototype.resourceEnsureExistance=function(I,T){qb.todo("resourceEnsureExistance")};Sa.prototype.resourceMkdir=function(I){qb.todo("resourceMkdir")};
Sa.prototype.resourceRead=function(I){qb.todo("resourceRead")};Sa.prototype.resourceRemove=function(I){qb.todo("resourceRemove")};Sa.prototype.resourceWrite=function(I,T){qb.todo("resourceWrite")};Sa.prototype.resourceCreateFiles=function(I,T){qb.todo("resourceCreateFiles")};Sa.prototype.resourceDirList=function(I,T,ua){qb.todo("resourceDirList")};Sa.prototype.normalizeSync=function(I,T,ua){qb.todo("normalizeSync")};Sa.prototype.normalize=function(I,T,ua){qb.todo("normalize")};Sa.prototype.printSystemConfig=
function(){qb.todo("printSystemConfig")};Sa.prototype.getConfig=function(){qb.todo("getConfig")};Sa.prototype.setConfig=function(I){qb.todo("setConfig")};Sa.prototype.getPackages=function(I){qb.todo("getPackages")};Sa.prototype.isModuleLoaded=function(I,T){qb.todo("isModuleLoaded")};Sa.prototype.doesModuleExist=function(I,T){qb.todo("doesModuleExist")};Sa.prototype.getModules=function(){var I=this,T,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){return 1==Da.nextAddress?(T=qb.arr,
ua=T.flatmap,Da.yield(I.getPackages(),2)):Da.return(ua.call(T,Da.yieldResult,function(Kb){return Kb.modules}))})};Sa.prototype.getModule=function(I){var T=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return 1==ua.nextAddress?ua.yield(T.getModules(),2):ua.return(ua.yieldResult.find(function(Da){return Da.name===I}))})};Sa.prototype.getPackage=function(I){var T=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return 1==ua.nextAddress?(I=I.replace(/\/+$/,""),
ua.yield(T.getPackages(),2)):ua.return(ua.yieldResult.find(function(Da){return Da.address===I||Da.name===I}))})};Sa.prototype.getPackageForModule=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){qb.todo("getPackageForModule");T.jumpToEnd()})};Sa.prototype.systemConfChange=function(I){var T=qb.parseJsonLikeObj(I);["baseURL"].forEach(function(ua){return delete T[ua]});return this.setConfig(T)};Sa.prototype.resourcesOfPackage=function(I,T){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){qb.todo("resourcesOfPackage");
ua.jumpToEnd()})};Sa.prototype.registerPackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){qb.todo("registerPackage");T.jumpToEnd()})};Sa.prototype.importPackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){qb.todo("importPackage");T.jumpToEnd()})};Sa.prototype.removePackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){qb.todo("removePackage");T.jumpToEnd()})};Sa.prototype.reloadPackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){qb.todo("reloadPackage");
T.jumpToEnd()})};Sa.prototype.packageConfChange=function(I,T){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){qb.todo("packageConfChange");ua.jumpToEnd()})};Sa.prototype.importModule=function(I){qb.todo("importModule")};Sa.prototype.forgetModule=function(I,T){qb.todo("forgetModule")};Sa.prototype.reloadModule=function(I,T){qb.todo("reloadModule")};Sa.prototype.moduleFormat=function(I){qb.todo("moduleFormat")};Sa.prototype.moduleRead=function(I){qb.todo("moduleRead")};Sa.prototype.moduleSourceChange=
function(I,T,ua){qb.todo("moduleSourceChange")};Sa.prototype.importsAndExportsOf=function(I,T){qb.todo("importsAndExportsOf")};Sa.prototype.keyValueListOfVariablesInModule=function(I,T){qb.todo("keyValueListOfVariablesInModule")};Sa.prototype.moduleWrite=function(I,T){return this.moduleSourceChange(I,T)};qb.AbstractCoreInterface=Sa;var Ta=function(){var I=qb.AbstractCoreInterface.call(this)||this;I.currentEval=null;return I};$jscomp.inherits(Ta,qb.AbstractCoreInterface);Ta.prototype.runEval=function(I,
T){throw Error("Not yet implemented");};Ta.prototype.runEvalAndStringify=function(I,T){var ua=this;return this.currentEval?this.currentEval.then(function(){return ua.runEvalAndStringify(I,T)}):this.currentEval=Promise.resolve().then(function(){var Da,Kb,Db,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ac){switch(ac.nextAddress){case 1:return ac.yield(ua.runEval("\n        Promise.resolve((async "+qb.transform.wrapInFunction(I)+')())\n          .then(function(result) { return JSON.stringify(result); })\n          .catch(function(err) { return {isError: true, value: err}; })\n          .then(function(result) {\n            if (!result || typeof result === "string") return result;\n            return JSON.stringify(result.isError ?\n              {isError: true, value: (result.value + "\\n" + result.value.stack) || String(result.value)} :\n              result)\n          });',
Object.assign({targetModule:"lively://remote-lively-system/runEvalAndStringify",promiseTimeout:3E4,waitForPromise:!0},T)),2);case 2:if((Da=ac.yieldResult)&&Da.isError)throw Error(String(Da.value||Da.error));if(!Da||!Da.value)return ac.return(null);if(Kb=Da.promisedValue){ac.jumpTo(3);break}return ac.yield(Da.value,4);case 4:Kb=ac.yieldResult;case 3:Db=Kb;if(!Db)return ac.return();if("undefined"===Db)return ac.return(void 0);if("null"===Db)return ac.return(null);if("true"===Db)return ac.return(!0);
if("false"===Db)return ac.return(!1);try{Fa=JSON.parse(Db)}catch(Gd){return ac.return(Db)}if(Fa&&Fa.isError)throw Error(String(Fa.value));return ac.return(Fa)}})}).then(function(Da){delete ua.currentEval;return Da},function(Da){delete ua.currentEval;return Promise.reject(Da)})};Ta.prototype.dynamicCompletionsForPrefix=function(I,T,ua){var Da=this,Kb,Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){Kb=qb.obj.isString(ua.context)?ua.context:!1;ua=qb.obj.dissoc(ua,["systemInterface",
"System","context"]);Db="\n      var prefix = "+JSON.stringify(T)+",\n          opts = "+JSON.stringify(ua)+";\n      opts.context = "+Kb+';\n      opts.classTransform = (await System.import("lively.classes")).classToFunctionTransform;\n      var evalFn = code => lively.vm.runEval(code, opts);\n      if (typeof System === "undefined") delete opts.targetModule;\n      lively.vm.completions.getCompletions(evalFn, prefix).then(function(result) {\n        if (result.isError) throw result.value;\n        return {\n          completions: result.completions,\n          prefix: result.startLetters\n        }\n      });';
return Fa.return(Da.runEvalAndStringify(Db))})};Ta.prototype.evalWithResource=function(I,T,ua){return this.runEvalAndStringify('\n      var {resource} = (typeof lively !== "undefined" && lively.resources)\n                    || await System.import("lively.resources");\n      await resource("'+I+'").'+T+"("+(ua?JSON.stringify(ua):"")+");\n    ")};Ta.prototype.resourceExists=function(I){return this.evalWithResource(I,"exists")};Ta.prototype.resourceEnsureExistance=function(I,T){return this.evalWithResource(I,
"ensureExistance",T)};Ta.prototype.resourceMkdir=function(I){return this.evalWithResource(I,"mkdir")};Ta.prototype.resourceRead=function(I){return this.evalWithResource(I,"read")};Ta.prototype.resourceRemove=function(I){return this.evalWithResource(I,"remove")};Ta.prototype.resourceWrite=function(I,T){return this.evalWithResource(I,"write",T)};Ta.prototype.resourceCreateFiles=function(I,T){return this.runEvalAndStringify('var {createFiles} = await System.import("lively.resources"); await createFiles("'+
I+'", '+JSON.stringify(T)+")")};Ta.prototype.resourceDirList=function(I,T,ua){return this.runEvalAndStringify('\n      var {resource} = await System.import("lively.resources");\n      (await resource("'+I+'").dirList('+JSON.stringify(T)+", "+JSON.stringify(ua)+"))\n        .map(({url}) => ({url}))")};Ta.prototype.livelySystemAccessor=function(I){I=void 0===I?"livelySystem":I;return"var "+I+' = (typeof lively !== "undefined" && lively.systemInterface)\n      || System.get(System.decanonicalize("lively-system-interface"))\n      || (typeof lively !== "undefined" && lively.modules && await lively.modules.importPackage("lively-system-interface"));\n    if (!'+
I+') throw new Error("lively-system-interface not available!");'};Ta.prototype.normalizeSync=function(I,T,ua){return this.runEvalAndStringify("lively.modules.System.decanonicalize("+JSON.stringify(I)+", "+JSON.stringify(T)+", "+ua+")")};Ta.prototype.normalize=function(I,T,ua){return this.runEvalAndStringify("lively.modules.System.normalize("+JSON.stringify(I)+", "+JSON.stringify(T)+", "+JSON.stringify(ua)+")")};Ta.prototype.printSystemConfig=function(){return this.runEvalAndStringify("lively.modules.printSystemConfig()")};
Ta.prototype.getConfig=function(){return this.runEvalAndStringify('var c = Object.assign({}, lively.modules.System.getConfig()); for (var name in c) if (name.indexOf("__lively.modules__") === 0 || name.indexOf("loads") === 0) delete c[name]; c')};Ta.prototype.setConfig=function(I){return this.runEvalAndStringify("lively.modules.System.config("+JSON.stringify(I)+")")};Ta.prototype.getPackages=function(I){I=Object.assign({excluded:[]},I);I.excluded=I.excluded.map(String);return this.runEvalAndStringify("\n      "+
this.livelySystemAccessor()+";\n      var options = "+JSON.stringify(I)+';\n      options.excluded = options.excluded.map(ea => {\n        let evaled = lively.vm.syncEval(ea).value;\n        return typeof evaled === "function" ? evaled : ea;\n      });\n      await livelySystem.localInterface.getPackages(options)\n        .map(ea => Object.assign({}, ea, {System: null}));')};Ta.prototype.getPackageForModule=function(I){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.getPackageForModule("+
JSON.stringify(I)+")")};Ta.prototype.isModuleLoaded=function(I,T){return this.runEvalAndStringify('lively.modules.isModuleLoaded("'+I+'", '+T+")")};Ta.prototype.doesModuleExist=function(I,T){return this.runEvalAndStringify('lively.modules.doesModuleExist("'+I+'", '+T+")")};Ta.prototype.registerPackage=function(I){var T=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return ua.return(T.runEvalAndStringify("lively.modules.registerPackage("+JSON.stringify(I)+")"))})};Ta.prototype.importPackage=
function(I){var T=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return ua.return(T.runEvalAndStringify("lively.modules.importPackage("+JSON.stringify(I)+")"))})};Ta.prototype.removePackage=function(I){var T=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return ua.return(T.runEvalAndStringify("lively.modules.removePackage("+JSON.stringify(I)+")"))})};Ta.prototype.reloadPackage=function(I,T){var ua=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){return Da.return(ua.runEvalAndStringify("lively.modules.reloadPackage("+
JSON.stringify(I)+", "+JSON.stringify(T)+")"))})};Ta.prototype.packageConfChange=function(I,T){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.packageConfChange("+JSON.stringify(I)+", "+JSON.stringify(T)+")")};Ta.prototype.resourcesOfPackage=function(I,T){T=void 0===T?[".git","node_modules",".module_cache","lively.next-node_modules"]:T;var ua=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){I.address&&(I=I.address);
return Da.return(ua.runEvalAndStringify("\n      "+ua.livelySystemAccessor()+";\n      await livelySystem.localInterface.resourcesOfPackage("+JSON.stringify(I)+", "+JSON.stringify(T)+");"))})};Ta.prototype.getModule=function(I){var T=this,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){if(1==Da.nextAddress)return Da.yield(T.getModules(),2);ua=Da.yieldResult.find(function(Kb){return Kb.name===I});return Da.return(ua?qb.modules.module(ua.name):null)})};Ta.prototype.importModule=function(I){return this.runEvalAndStringify("lively.modules.System.import("+
JSON.stringify(I)+")")};Ta.prototype.forgetModule=function(I,T){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(I)+").unload("+JSON.stringify(T)+")")};Ta.prototype.reloadModule=function(I,T){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(I)+").reload("+JSON.stringify(T)+")")};Ta.prototype.moduleFormat=function(I){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(I)+").format();")};Ta.prototype.moduleRead=function(I){return this.runEvalAndStringify("lively.modules.module("+
JSON.stringify(I)+").source()")};Ta.prototype.moduleSourceChange=function(I,T,ua){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(I)+").changeSource("+JSON.stringify(T)+", "+JSON.stringify(ua)+")")};Ta.prototype.keyValueListOfVariablesInModule=function(I,T){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.keyValueListOfVariablesInModule("+JSON.stringify(I)+", "+JSON.stringify(T)+")")};Ta.prototype.importsAndExportsOf=
function(I,T){return this.runEvalAndStringify("({\n      imports: await lively.modules.module("+JSON.stringify(I)+").imports(),\n      exports: await lively.modules.module("+JSON.stringify(I)+").exports()})")};Ta.prototype.exportsOfModules=function(I){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+"\n      const options = "+JSON.stringify(I)+";\n      options.excludedPackages = ["+I.excludedPackages.map(function(T){return"function"===typeof T?T.toString():JSON.stringify(T)}).join(",")+
"]\n      await livelySystem.localInterface.exportsOfModules(options)")};Ta.prototype.searchInPackage=function(I,T,ua){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.searchInPackage("+JSON.stringify(I)+", "+JSON.stringify(T)+", "+JSON.stringify(ua)+")")};Ta.prototype.loadMochaTestFile=function(I,T){T=void 0===T?[]:T;var ua=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){return Da.return(ua.runEvalAndStringify("\n      "+
ua.livelySystemAccessor()+";\n      var {testsByFile} = await livelySystem.localInterface.loadMochaTestFile("+JSON.stringify(I)+", "+JSON.stringify(T)+"), result;\n      result = {testsByFile}"))})};Ta.prototype.runMochaTests=function(I,T,ua,Da){var Kb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){I&&I instanceof RegExp&&(I={isRegExp:!0,value:String(I).replace(/^\/|\/$/g,"")});return Db.return(Kb.runEvalAndStringify("\n      var grep = "+JSON.stringify(I)+";\n      if (grep && grep.isRegExp) grep = new RegExp(grep.value);\n      "+
Kb.livelySystemAccessor()+";\n      var {testsByFile, isError, value: error} = await livelySystem.localInterface.runMochaTests(grep, "+JSON.stringify(T||[])+"), result;\n      error = error ? String(error.stack || error) : null;\n      if (testsByFile) {\n        testsByFile.forEach(ea =>\n          ea.tests.forEach(ea => {\n            if (!ea.error) return;\n            var {message, stack, actual, expected} = ea.error;\n            ea.error = {\n              message: message || String(ea.error),\n              stack: stack,\n              actual, exected\n            }\n          }));\n      }\n      result = {testsByFile, isError, error}"))})};
qb.RemoteCoreInterface=Ta;var sb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/local-system.js");sb.obj=Mb;sb.string=Fc;sb.arr=zb;sb.resource=Sb;sb.createFiles=Wc;sb.ast=kb;sb.modules=Kc;sb.vm=hd;sb.loadMochaTestFile=$a;sb.runMochaTests=dc;sb.parseJsonLikeObj=Xc;sb.AbstractCoreInterface=Sa;sb.classToFunctionTransform=Id;Sa=function(){return sb.AbstractCoreInterface.apply(this,arguments)||this};$jscomp.inherits(Sa,sb.AbstractCoreInterface);Sa.prototype.dynamicCompletionsForPrefix=
function(I,T,ua){var Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Kb){if(1==Kb.nextAddress)return Kb.yield(sb.vm.completions.getCompletions(function(Db){return sb.vm.runEval(Db.replace("return ",""),Object.assign({targetModule:I,classTransform:sb.classToFunctionTransform},ua))},T),2);Da=Kb.yieldResult;if(Da.isError)throw Da.value;return Kb.return({completions:Da.completions,prefix:Da.startLetters})})};Sa.prototype.runEval=function(I,T){return sb.vm.runEval(I,Object.assign({classTransform:sb.classToFunctionTransform},
T))};Sa.prototype.resourceExists=function(I){return sb.resource(I).exists()};Sa.prototype.resourceEnsureExistance=function(I,T){return sb.resource(I).ensureExistance(T)};Sa.prototype.resourceMkdir=function(I){return sb.resource(I).mkdir()};Sa.prototype.resourceRead=function(I){return sb.resource(I).read()};Sa.prototype.resourceRemove=function(I){return sb.resource(I).remove()};Sa.prototype.resourceWrite=function(I,T){return sb.resource(I).write(T)};Sa.prototype.resourceCreateFiles=function(I,T){return sb.createFiles(I,
T)};Sa.prototype.resourceDirList=function(I,T,ua){return sb.resource(I).dirList(T,ua)};Sa.prototype.normalizeSync=function(I,T,ua){return System.decanonicalize(I,T,ua)};Sa.prototype.normalize=function(I,T,ua){return System.normalize(I,T,ua)};Sa.prototype.printSystemConfig=function(){return sb.modules.printSystemConfig()};Sa.prototype.getConfig=function(){return System.getConfig()};Sa.prototype.setConfig=function(I){sb.modules.System.config(I)};Sa.prototype.getPackages=function(I){I=Object.assign({},
I);I=void 0===I.excluded?[]:I.excluded;var T=I.filter(function(Da){return"string"===typeof Da}),ua=I.filter(function(Da){return"function"===typeof Da});T=T.concat(T.map(function(Da){return System.decanonicalize(Da.replace(/\/?$/,"/")).replace(/\/$/,"")}));return sb.modules.getPackages().filter(function(Da){return!T.includes(Da.url)&&!ua.some(function(Kb){return Kb(Da.url)})})};Sa.prototype.registerPackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){return T.return(sb.modules.registerPackage(I))})};
Sa.prototype.importPackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){return T.return(sb.modules.importPackage(I))})};Sa.prototype.removePackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){return T.return(sb.modules.removePackage(I))})};Sa.prototype.reloadPackage=function(I,T){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return ua.return(sb.modules.reloadPackage(I,T))})};Sa.prototype.packageConfChange=function(I,T){var ua=
this,Da,Kb,Db,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ac){if(1==ac.nextAddress)return Da=sb.modules.System,Kb=sb.parseJsonLikeObj(I),Db=JSON.stringify(Kb,null,2),ac.yield(sb.modules.module(T).changeSource(Db,{doEval:!1}),2);if(3!=ac.nextAddress)return Da.set(T,Da.newModule(Kb)),ac.yield(ua.getPackageForModule(T),3);(Fa=ac.yieldResult)&&sb.modules.applyPackageConfig(Kb,Fa.address);ac.jumpToEnd()})};Sa.prototype.resourcesOfPackage=function(I,T){T=void 0===T?[".git","node_modules",
".module_cache"]:T;var ua,Da,Kb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){if(1==Db.nextAddress)return Db.setCatchFinallyBlocks(2),ua=I.address?I.address:I,Da=sb.modules.getPackage(ua),Db.yield(Da.resources(void 0,T),4);if(2!=Db.nextAddress)return Db.return(Db.yieldResult.map(function(Fa){return Object.assign(Fa,{package:Fa.package.url})}));Kb=Db.enterCatchBlock();console.warn("resourcesOfPackage error for "+I+": "+Kb);return Db.return([])})};Sa.prototype.getPackageForModule=
function(I){return(I=sb.modules.getPackageOfModule(I))?I.asSpec():I};Sa.prototype.isModuleLoaded=function(I,T){return sb.modules.isModuleLoaded(I,T)};Sa.prototype.doesModuleExist=function(I,T){return sb.modules.isModuleLoaded(I,T)};Sa.prototype.getModule=function(I){return sb.modules.module(I)};Sa.prototype.importModule=function(I){return sb.modules.System.import(I)};Sa.prototype.forgetModule=function(I,T){return sb.modules.module(I).unload(T)};Sa.prototype.reloadModule=function(I,T){return sb.modules.module(I).reload(T)};
Sa.prototype.moduleFormat=function(I){return sb.modules.module(I).format()};Sa.prototype.moduleRead=function(I){return sb.modules.module(I).source()};Sa.prototype.moduleSourceChange=function(I,T,ua){return sb.modules.module(I).changeSource(T,ua)};Sa.prototype.keyValueListOfVariablesInModule=function(I,T){var ua=this,Da,Kb,Db,Fa,ac,Gd,fd,Gc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ea){switch(Ea.nextAddress){case 1:if(T){Ea.jumpTo(2);break}return Ea.yield(ua.resourceRead(I),3);case 3:T=
Ea.yieldResult;case 2:return Da="string"===typeof T?sb.ast.parse(T):T,Kb=ua.normalizeSync(I),ua.moduleFormat(Kb),Db=sb.modules.module(Kb).env().recorder,Ea.yield(ua.importsAndExportsOf(Kb,Da),4);case 4:return Fa=Ea.yieldResult,ac=sb.ast.query.topLevelDeclsAndRefs(Da),Gd=sb.arr.sortByKey(sb.ast.query.declarationsOfScope(ac.scope,!0),"start"),fd=sb.arr.pluck(ac.scope.importSpecifiers,"name"),Gc=0,Ea.return(Gd.map(function(Oc){var Va=Oc.name.length,kd=Fa.exports.find(function(Wa){return Wa.local===Oc.name}),
Ka=sb.arr.include(fd,Oc.name);kd&&(Va+=9);Ka&&(Va+=9);Gc=Math.max(Gc,Va);return{isExport:kd,isImport:Ka,name:Oc.name,value:Db[Oc.name],node:Oc,printedName:Oc.name+(kd?" [export]":"")+(Ka?" [import]":""),printedValue:sb.obj.inspect(Db[Oc.name],{maxDepth:1}).replace(/\n/g,"")}}).map(function(Oc){return{isListItem:!0,value:Oc,string:Oc.printedName+sb.string.indent(" = "+Oc.printedValue," ",Gc-Oc.printedName.length)}}))}})};Sa.prototype.importsAndExportsOf=function(I,T){var ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){return 1==
Da.nextAddress?Da.yield(sb.modules.module(I).imports(T),2):3!=Da.nextAddress?(ua=Da.yieldResult,Da.yield(sb.modules.module(I).exports(T),3)):Da.return({imports:ua,exports:Da.yieldResult})})};Sa.prototype.exportsOfModules=function(I){return sb.modules.ExportLookup.run(System,I)};Sa.prototype.searchInPackage=function(I,T,ua){return sb.modules.getPackage(I).search(T,ua)};Sa.prototype.runMochaTests=function(I,T,ua,Da){return sb.runMochaTests(I,T,ua,Da)};Sa.prototype.loadMochaTestFile=function(I,T){return sb.loadMochaTestFile(I,
T)};$jscomp.global.Object.defineProperties(Sa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"local"}}});sb.LocalCoreInterface=Sa;var Zb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/http-interface.js");Zb.evalStrategies=nd;Zb.RemoteCoreInterface=Ta;var rc=function(I){var T=Zb.RemoteCoreInterface.call(this)||this;T.currentEval=null;T.url=I;T.server=new Zb.evalStrategies.HttpEvalStrategy(I);return T};$jscomp.inherits(rc,Zb.RemoteCoreInterface);rc.prototype.runEval=
function(I,T){return this.server.runEval(I,T)};$jscomp.global.Object.defineProperties(rc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this.url}},description:{configurable:!0,enumerable:!0,get:function(){return this.url.replace(/^https?:\/\//,"")}}});Zb.HTTPCoreInterface=rc;var Xb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/l2l-interface.js");Xb.evalStrategies=nd;Xb.RemoteCoreInterface=Ta;Ta=function(I,T){var ua=Xb.RemoteCoreInterface.call(this)||this;
ua.targetId=I;ua.peer=T;return ua};$jscomp.inherits(Ta,Xb.RemoteCoreInterface);Ta.prototype.isConnected=function(){var I=this,T,ua,Da,Kb,Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){if(1==Fa.nextAddress)return T=I,ua=T.client,Da=T.targetId,Fa.yield(ua.sendToAndWait(ua.trackerId,"getClients",{}),2);Kb=Fa.yieldResult;Db=Kb.data;return Fa.return(Db.some(function(ac){ac=$jscomp.makeIterator(ac).next().value;return Da===ac}))})};Ta.prototype.runEval=function(I,T){var ua=this,Da,Kb;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){Da=ua.client;if(!Da)throw Error("No lively.2lively default client available!");Kb=new Xb.evalStrategies.L2LEvalStrategy(Da,ua.targetId);return Db.return(Kb.runEval(I,T))})};$jscomp.global.Object.defineProperties(Ta.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"l2l "+this.targetId}},description:{configurable:!0,enumerable:!0,get:function(){var I=this.peer,T="l2l "+this.targetId.slice(0,5);if(I){var ua=I.location,
Da=I.type,Kb=I.user;I=I.world;Da&&(T+=", "+Da);ua&&(T+=", "+ua.replace(/^https?:\/\//,"")+(I?"/"+I:""));Kb&&(T+=", "+Kb.name)}return T}},client:{configurable:!0,enumerable:!0,get:function(){return(lively.modules.module("lively.2lively/client.js").get()||{default:lively.l2l.L2LClient}).default.default()}}});Xb.L2LCoreInterface=Ta;var wc=lively.FreezerRuntime.recorderFor("lively-system-interface/index.js");wc.systemInterfaceNamed=oc;wc.interactivelyCreatePackage=Na;wc.interactivelyLoadPackage=nb;wc.interactivelyReloadPackage=
Pb;wc.interactivelyUnloadPackage=Wb;wc.interactivelyRemovePackage=Pc;wc.showExportsAndImportsOf=Bd;wc.shortModuleName=Hb;wc.interactivelyChangeModule=Ub;wc.interactivelyReloadModule=vb;wc.interactivelyUnloadModule=kc;wc.interactivelyRemoveModule=xc;wc.interactivelyAddModule=Dc;wc.modulesInPackage=Gb;wc.LocalCoreInterface=Sa;wc.HTTPCoreInterface=rc;wc.L2LCoreInterface=Ta;Ta=function(I){this.coreInterface=I};Ta.prototype.dynamicCompletionsForPrefix=function(I,T,ua){return this.coreInterface.dynamicCompletionsForPrefix(I,
T,ua)};Ta.prototype.runEval=function(I,T){return this.coreInterface.runEval(I,T)};Ta.prototype.printSystemConfig=function(I,T,ua){return this.coreInterface.printSystemConfig(I,T,ua)};Ta.prototype.getConfig=function(I,T,ua){return this.coreInterface.getConfig(I,T,ua)};Ta.prototype.getPackages=function(I){return this.coreInterface.getPackages(I)};Ta.prototype.getModules=function(I,T,ua){return this.coreInterface.getModules(I,T,ua)};Ta.prototype.getModule=function(I,T,ua){return this.coreInterface.getModule(I,
T,ua)};Ta.prototype.getPackage=function(I,T,ua){return this.coreInterface.getPackage(I,T,ua)};Ta.prototype.getPackageForModule=function(I,T,ua){return this.coreInterface.getPackageForModule(I,T,ua)};Ta.prototype.resourcesOfPackage=function(I,T){return this.coreInterface.resourcesOfPackage(I,T)};Ta.prototype.systemConfChange=function(I,T,ua){return this.coreInterface.systemConfChange(I,T,ua)};Ta.prototype.registerPackage=function(I){return this.coreInterface.registerPackage(I)};Ta.prototype.importPackage=
function(I){return this.coreInterface.importPackage(I)};Ta.prototype.removePackage=function(I){return this.coreInterface.removePackage(I)};Ta.prototype.reloadPackage=function(I){return this.coreInterface.reloadPackage(I)};Ta.prototype.packageConfChange=function(I,T){return this.coreInterface.packageConfChange(I,T)};Ta.prototype.keyValueListOfVariablesInModule=function(I,T){return this.coreInterface.keyValueListOfVariablesInModule(I,T)};Ta.prototype.interactivelyCreatePackage=function(I){return wc.interactivelyCreatePackage(this.coreInterface,
I)};Ta.prototype.interactivelyLoadPackage=function(I,T){return wc.interactivelyLoadPackage(this.coreInterface,I,T)};Ta.prototype.interactivelyReloadPackage=function(I,T){return wc.interactivelyReloadPackage(this.coreInterface,I,T)};Ta.prototype.interactivelyUnloadPackage=function(I,T,ua){return wc.interactivelyUnloadPackage(this.coreInterface,I,T,ua)};Ta.prototype.interactivelyRemovePackage=function(I,T){return wc.interactivelyRemovePackage(this.coreInterface,I,T)};Ta.prototype.isModuleLoaded=function(I,
T){return this.coreInterface.isModuleLoaded(I,T)};Ta.prototype.doesModuleExist=function(I,T){return this.coreInterface.doesModuleExist(I,T)};Ta.prototype.importModule=function(I){return this.coreInterface.importModule(I)};Ta.prototype.forgetModule=function(I,T){return this.coreInterface.forgetModule(I,T)};Ta.prototype.reloadModule=function(I,T){return this.coreInterface.reloadModule(I,T)};Ta.prototype.moduleFormat=function(I){return this.coreInterface.moduleFormat(I)};Ta.prototype.moduleRead=function(I){return this.coreInterface.moduleRead(I)};
Ta.prototype.moduleWrite=function(I,T){return this.coreInterface.moduleWrite(I,T)};Ta.prototype.getModulesInPackage=function(I){return wc.modulesInPackage(this.coreInterface,I)};Ta.prototype.shortModuleName=function(I,T){return wc.shortModuleName(this.coreInterface,I,T)};Ta.prototype.interactivelyChangeModule=function(I,T,ua){return wc.interactivelyChangeModule(this.coreInterface,I,T,ua)};Ta.prototype.interactivelyReloadModule=function(I,T){return wc.interactivelyReloadModule(this.coreInterface,I,
T)};Ta.prototype.interactivelyUnloadModule=function(I,T){return wc.interactivelyUnloadModule(this.coreInterface,I,T)};Ta.prototype.interactivelyRemoveModule=function(I,T){return wc.interactivelyRemoveModule(this.coreInterface,I,T)};Ta.prototype.interactivelyAddModule=function(I,T){return wc.interactivelyAddModule(this.coreInterface,I,T)};Ta.prototype.showExportsAndImportsOf=function(I,T){return wc.showExportsAndImportsOf(this.coreInterface,I,T)};Ta.prototype.exportsOfModules=function(I){return this.coreInterface.exportsOfModules(I)};
Ta.prototype.searchInPackage=function(I,T,ua){return this.coreInterface.searchInPackage(I,T,ua)};Ta.prototype.searchInAllPackages=function(I,T){T=void 0===T?{}:T;var ua=this,Da,Kb,Db,Fa,ac,Gd,fd,Gc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ea){switch(Ea.nextAddress){case 1:return(Da=T.progress)&&Da.step("Fetching Packages...",0),Ea.yield(ua.coreInterface.getPackages({excluded:T.excludedPackages}),2);case 2:Kb=Ea.yieldResult,Db=[],Da&&Da.step("Fetching Packages...",.1),Fa=0;case 3:if(!(Fa<
Kb.length)){Ea.jumpTo(5);break}ac=Kb[Fa];Gd=ac.url;if(!Gd||"no group"===Gd){Ea.jumpTo(4);break}Da&&Da.step(Gd.replace(System.baseURL,"").slice(0,20),.1+Fa/Kb.length*.9);Ea.setCatchFinallyBlocks(6);return Ea.yield(ua.coreInterface.searchInPackage(Gd,I,T),8);case 8:fd=Ea.yieldResult;Db=Db.concat(fd);Ea.leaveTryBlock(4);break;case 6:Gc=Ea.enterCatchBlock(),console.error("Error searching in package "+Gd+":\n"+Gc.stack);case 4:Fa++;Ea.jumpTo(3);break;case 5:return Ea.return(Db)}})};Ta.prototype.loadMochaTestFile=
function(I,T){return this.coreInterface.loadMochaTestFile(I,T)};Ta.prototype.runMochaTests=function(I,T,ua,Da){return this.coreInterface.runMochaTests(I,T,ua,Da)};$jscomp.global.Object.defineProperties(Ta.prototype,{isSystemInterface:{configurable:!0,enumerable:!0,get:function(){return!0}},name:{configurable:!0,enumerable:!0,get:function(){return this.coreInterface.name}}});ra("Interface",Ta);wc.Interface=Ta;wc.systemInterfaceNamed=oc;wc.systemInterfaceNamed=oc;Ta=ra("localInterface",new wc.Interface(new wc.LocalCoreInterface));
wc.localInterface=Ta;wc.localInterface=Ta;wc.localInterface=Ta;wc.httpInterfaces={};Ta=ra("serverInterfaceFor",function(I){return wc.httpInterfaces[I]||(wc.httpInterfaces[I]=new wc.Interface(new wc.HTTPCoreInterface(I)))});wc.serverInterfaceFor=Ta;wc.serverInterfaceFor=Ta;wc.serverInterfaceFor=Ta;wc.l2lInterfaces={};Ta=ra("l2lInterfaceFor",function(I,T){return wc.l2lInterfaces[I]||(wc.l2lInterfaces[I]=new wc.Interface(new wc.L2LCoreInterface(I,T)))});wc.l2lInterfaceFor=Ta;wc.l2lInterfaceFor=Ta;wc.l2lInterfaceFor=
Ta}}});
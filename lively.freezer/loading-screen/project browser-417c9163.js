System.register(["./__root_module__-c4f77fb9.js","kld-intersections","./index-f69ab412.js","./index-cb8cbefd.js","./user-ui-0e8459b1.js"],function(ra,jb){var pb,Ub,Jb,jd,uc,nd,wc,Cc,Mc,Bd,re,Ce,be,Sb,qc,od,Tb,wd,Fd;return{setters:[function(fc){pb=fc.an;Ub=fc.aD;Jb=fc.ap;jd=fc.ab;uc=fc.Y;nd=fc.a6;wc=fc.ax;Cc=fc.a7;Mc=fc.C;Bd=fc.a3;re=fc.r;Ce=fc.aw;be=fc.aC;Sb=fc.b1;qc=fc.b2;od=fc.au;Tb=fc.a$;wd=fc.aY},function(){},function(){},function(){},function(fc){Fd=fc.UserUI}],execute:function(){var fc=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");fc.Morph=pb;fc.HorizontalLayout=Ub;fc.VerticalLayout=Jb;fc.morph=jd;fc.MorphicDB=uc;fc.arr=nd;fc.fun=wc;fc.string=Cc;fc.Color=Mc;fc.pt=Bd;fc.UserUI=Fd;fc.resource=re;var ic=function(Bc){var ad=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),bd=ad.hasOwnProperty("WorldDashboard")&&"function"===typeof ad.WorldDashboard?ad.WorldDashboard:ad.WorldDashboard=function(ob){ob&&ob[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ce(bd,Bc,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(ob){ob=void 0===ob?$world:ob;this.owner!=ob&&ob.addMorph(this);this.center=ob.visibleBounds().center()}},{key:"sortAndFilterPreviews",
value:function(ob){var kb=fc.UserUI.getCurrentUser();ob=this.ui.searchField.fuzzyFilter(ob,function(tb){return tb._commit.name+tb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return fc.arr.sortBy(ob,function(tb){return-tb._commit.timestamp});case "TEMPLATES":return ob;case "MY PROJECTS":return fc.arr.filter(ob,function(tb){return tb._commit.author.name===kb.name});case "PUBLISHED":return ob}}},{key:"updateList",value:function(){var ob=this;this.previews&&fc.fun.debounceNamed("update world list",
150,function(){ob.ui.worldList.items=ob.sortAndFilterPreviews(ob.previews)})()}},{key:"displayWorlds",value:function(){var ob=this,kb,tb,Aa,Fa,Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){switch(wa.nextAddress){case 1:return ob.reset(),kb=ob.ui,tb=kb.loadingLabel,tb.animate({opacity:1,duration:300}),wa.yield(ob.db.latestCommits("world"),2);case 2:return Aa=wa.yieldResult,wa.yield(jb.import("./world preview-271e85b6.js"),4);case 4:if(!(Fa=wa.yieldResult)){wa.jumpTo(5);break}return wa.yield(fc.resource("part://partial freezing/world preview"),
6);case 6:Fa=wa.yieldResult;case 5:return wa.yield(Fa.read(),3);case 3:return Ba=wa.yieldResult,ob.previews=Aa.map(function(Na){var La=fc.morph({reactsToPointer:!1,fill:fc.Color.transparent,extent:Ba.extent});La._commit=Na;La.displayPreview=function(){var Wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gb){if(1==Gb.nextAddress)return Wa=Ba.copy(),Wa._commit=Na,Wa.opacity=0,La.addMorph(Wa),Wa.displayPreview(),Wa.position=fc.pt(0,0),Gb.yield(La.whenRendered(),2);La.layout=new fc.HorizontalLayout({autoResize:!0,
reactToSubmorphAnimations:!0});Gb.jumpToEnd()})};return La}),wa.yield(tb.animate({opacity:0,duration:300}),7);case 7:ob.updateList(),0==Aa.length&&(ob.ui.noWorldWarning.center=ob.innerBounds().center(),ob.ui.noWorldWarning.animate({visible:!0,duration:300})),wa.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,
get:function(){return this.ui.closeButton.visible},set:function(ob){this.ui.closeButton.visible=ob}},db:{serialize:!1,get:function(){return fc.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],
ad,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-127"}}},{start:330,end:3954})}(fc.Morph);ic=fc.WorldDashboard;fc.default=ic;var Ab=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");Ab.Morph=pb;Ab.touchInputDevice=be;Ab.TilingLayout=Sb;Ab.arr=nd;Ab.pt=Bd;ic=function(Bc){var ad=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),
bd=ad.hasOwnProperty("GrowingWorldList")&&"function"===typeof ad.GrowingWorldList?ad.GrowingWorldList:ad.GrowingWorldList=function(ob){ob&&ob[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ce(bd,Bc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(ob){Ce._get(Object.getPrototypeOf(bd.prototype),"onScroll",this).call(this,ob);this.update()}},{key:"onChange",value:function(ob){Ce._get(Object.getPrototypeOf(bd.prototype),
"onChange",this).call(this,ob);"extent"==ob.prop&&this.update(!0)}},{key:"onHoverIn",value:function(ob){this.clipMode="auto"}},{key:"onHoverOut",value:function(ob){Ab.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(ob){var kb=this.items;if(kb&&0!=kb.length){var tb=this.scrollContainer,Aa=tb.layout.spacing;tb.extent=this.extent;var Fa=this.ui,Ba=Fa.bufferTop;Fa=Fa.bufferBottom;Ba=Ba||tb.addMorph({fill:null,name:"buffer top",height:10});Fa=Fa||tb.addMorph({fill:null,name:"buffer bottom",
height:10});Ba.width=Fa.width=this.width-100;tb.layout.disable();var wa=kb[0];Aa=kb.slice(0,Math.floor(this.width/(wa.width+Aa))*(Math.ceil((this.scroll.y+this.height)/(wa.height+Aa))+1)).filter(function(Gb){return Gb.owner!=tb});wa=this.scroll.y+2*this.height;for(var Na={},La=$jscomp.makeIterator(Aa),Wa=La.next();!Wa.done;Na={$jscomp$loop$prop$item$2559:Na.$jscomp$loop$prop$item$2559},Wa=La.next())Na.$jscomp$loop$prop$item$2559=Wa.value,wa++,Na.$jscomp$loop$prop$item$2559.top=wa,tb.addMorph(Na.$jscomp$loop$prop$item$2559),
Na.$jscomp$loop$prop$item$2559._initialized||Na.$jscomp$loop$prop$item$2559.whenRendered().then(function(Gb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rb){Gb.$jscomp$loop$prop$item$2559._initialized=!0;return Rb.yield(Gb.$jscomp$loop$prop$item$2559.displayPreview(),0)})}}(Na));ob&&(Ba.position=Ab.pt(0,0),kb.forEach(function(Gb,Rb){return Gb.position=Ab.pt(Rb+1,Rb+1)}),Fa.position=Ab.pt(kb.length+2,kb.length+2));tb.layout.enable();if(ob||0<Aa.length)Fa.top=this.submorphBounds().height,
tb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Ab.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},
items:{after:["layout","scrollContainer"],set:function(ob){this.setProperty("items",ob);var kb=this.scrollContainer;kb.layout&&kb.layout.disable();var tb=this.ui,Aa=tb.bufferTop;tb=tb.bufferBottom;Ab.arr.withoutAll(kb.submorphs,[].concat($jscomp.arrayFromIterable(ob),[Aa,tb])).forEach(function(Fa){return Fa.remove()});this.update(!0)}}}}}],ad,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Ab.Morph);ic=Ab.GrowingWorldList;Ab.default=ic;var jc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");jc.InputLine=qc;jc.Color=Mc;jc.connect=od;jc.disconnectAll=Tb;jc.disconnect=wd;jc.arr=nd;jc.string=Cc;ic=function(Bc){var ad=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),bd=ad.hasOwnProperty("SearchInputLine")&&"function"===typeof ad.SearchInputLine?ad.SearchInputLine:ad.SearchInputLine=
function(ob){ob&&ob[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ce(bd,Bc,[{key:"fuzzyMatch",value:function(ob,kb){kb=void 0===kb?this.parseInput():kb;if(kb.lowercasedTokens.every(function(Aa){return ob.toLowerCase().includes(Aa)}))return!0;var tb=ob.toLowerCase();return 3>=jc.arr.sum(kb.lowercasedTokens.map(function(Aa){return jc.string.levenshtein(tb,Aa)}))}},{key:"fuzzyFilter",value:function(ob,kb){var tb=this;kb=void 0===
kb?function(Fa){return Fa}:kb;var Aa=this.parseInput();return jc.arr.filter(ob,function(Fa){return tb.fuzzyMatch(kb(Fa),Aa)})}},{key:"parseInput",value:function(){var ob=Array.from(this.textString).reduce(function(tb,Aa){if("\\"===Aa&&!tb.escaped)return tb.escaped=!0,tb;" "!==Aa||tb.escaped?(tb.spaceSeen=!1,tb.current+=Aa):(!tb.spaceSeen&&tb.current&&(tb.tokens.push(tb.current),tb.current=""),tb.spaceSeen=!0);tb.escaped=!1;return tb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});ob.current&&ob.tokens.push(ob.current);
var kb=ob.tokens.map(function(tb){return tb.toLowerCase()});return{tokens:ob.tokens,lowercasedTokens:kb}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],ad,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(jc.InputLine);ic=jc.SearchInputLine;
jc.default=ic}}});
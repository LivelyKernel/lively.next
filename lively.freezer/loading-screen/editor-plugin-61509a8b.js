System.register(["./__root_module__-f9290433.js","kld-intersections","./editor-plugin-70198a84.js","./index-9e4ab300.js","./index-5ea42d9a.js"],function(sa){var db,Eb,Vb,Wb,wd,Ic,Ad,Jc,Mc,bd,ed,Od,qd,Xc,Ra,wb,mc,dc,Rc,Tc,zc,Fc,Jb,Ac;return{setters:[function(Bc){db=Bc.aq;Eb=Bc.by;Vb=Bc.bz;Wb=Bc.bA;wd=Bc.E;Ic=Bc.ao;Ad=Bc.aU;Jc=Bc.s;Mc=Bc.a9;bd=Bc.bl;ed=Bc.a4;Od=Bc._;qd=Bc.bB;Xc=Bc.bs},function(){},function(Bc){Ra=Bc.p;wb=Bc.d;mc=Bc.a;dc=Bc.r;Rc=Bc.C},function(Bc){Tc=Bc.s},function(Bc){zc=Bc.localInterface;
Fc=Bc.systemInterfaceNamed;Jb=Bc.serverInterfaceFor;Ac=Bc.l2lInterfaceFor}],execute:function(){var Bc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");Bc.warnStyle={"border-bottom":"2px dotted orange"};Bc.errorStyle={"background-color":"red"};var fd=function(fc){var bc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),Tb=bc.hasOwnProperty("JavaScriptChecker")&&"function"===typeof bc.JavaScriptChecker?bc.JavaScriptChecker:bc.JavaScriptChecker=function(I){I&&I[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return db(Tb,fc,[{key:"uninstall",value:function(I){var T=I.text||I;(T.markers||[]).forEach(function(qa){return qa.id.startsWith("js-checker-")&&T.removeMarker(qa)});T.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(I,T){return[].concat($jscomp.arrayFromIterable(I.embeddedMorphMap.values())).find(function(qa){return T.containsPosition(qa.anchor.position)})}},{key:"onDocumentChange",value:function(I,
T,qa){var Ga=T.document;try{var Mb=qa.parse()}catch(nb){Mb=nb}Mb&&(I=(T.markers||[]).filter(function(nb){return nb.id.startsWith("js-checker-")}),qa=qa.undeclaredVariables().map(function(nb,Ha){var kb=nb.start;nb=nb.end;kb=Ga.indexToPosition(kb);nb=Ga.indexToPosition(nb);return T.addMarker({id:"js-checker-"+Ha,style:Bc.warnStyle,range:{start:kb,end:nb},type:"js-undeclared-var"})}),I.slice(qa.length).forEach(function(nb){return T.removeMarker(nb)}),Mb.parseError?(I=Mb.parseError.loc,qa=I.column,I=
I.line-1,Mb=Ga.indexToPosition(Mb.parseError.pos),qa=Mb.column,I=Mb.row,Mb={start:{column:qa-1,row:I},end:{column:qa+1,row:I}},this.hasEmbeddedMorphInRange(T,Mb)||T.addMarker({id:"js-syntax-error",range:Mb,style:Bc.errorStyle,type:"js-syntax-error"})):T.removeMarker("js-syntax-error"))}}],[{key:"className",get:function(){return"JavaScriptChecker"}}],bc,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:118,end:1882})}(void 0),Qb=fd=Bc.JavaScriptChecker;Bc.default=fd;var xb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");xb.query=Eb;xb.fuzzyParse=Vb;xb.acorn=Wb;xb.custom=wd;var eb=function(fc){var bc=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),Tb=bc.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof bc.JavaScriptNavigator?bc.JavaScriptNavigator:bc.JavaScriptNavigator=function(I){I&&I[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return db(Tb,fc,[{key:"ensureAST",value:function(I){return this.parse(I.textString)}},{key:"parse",value:function(I){return xb.fuzzyParse(I)}},{key:"move",value:function(I,T){var qa=!!T.activeMark||!T.selection.isEmpty(),Ga=T.selection,Mb=T.positionToIndex(Ga.lead);I=this[I](T.textString,Mb);I=T.indexToPosition(I);Ga.lead=I;qa||(Ga.anchor=I);T.scrollCursorIntoView()}},{key:"forwardSexp",value:function(I){this.move("_forwardSexp",
I)}},{key:"backwardSexp",value:function(I){this.move("_backwardSexp",I)}},{key:"backwardUpSexp",value:function(I){this.move("_backwardUpSexp",I)}},{key:"forwardDownSexp",value:function(I){this.move("_forwardDownSexp",I)}},{key:"_forwardSexp",value:function(I,T){I=this.parse(I);I=xb.custom.findNodesIncluding(I,T).reverse().find(function(Ga){return Ga.end!==T});if(!I)return T;if("BlockStatement"===I.type){var qa=I.body.find(function(Ga){return Ga.start>T});if(qa)return qa.start}return I.end}},{key:"_backwardSexp",
value:function(I,T){I=this.parse(I);I=xb.custom.findNodesIncluding(I,T).reverse().find(function(Ga){return Ga.start!==T});if(!I)return T;if("BlockStatement"===I.type){var qa=I.body.slice().reverse().find(function(Ga){return Ga.end<T});if(qa)return qa.end}return I?I.start:T}},{key:"_backwardUpSexp",value:function(I,T){I=this.parse(I);return(I=xb.custom.findNodesIncluding(I,T).reverse().find(function(qa){return qa.start!==T}))?I.start:T}},{key:"_forwardDownSexp",value:function(I,T){I=this.parse(I);
return(I=xb.custom.findNodeAfter(I,T,function(qa,Ga){return Ga.start>T}))?I.node.start:T}},{key:"markDefun",value:function(I){var T=this.rangeForFunctionOrDefinition(I.textString,[I.positionToIndex(I.selection.range.start),I.positionToIndex(I.selection.range.end)]);T&&I.execCommand("expandRegion",{start:T[0],end:T[1]})}},{key:"rangeForNodesMatching",value:function(I,T,qa){I=this.parse(I);return(T=xb.custom.findNodesIncluding(I,T).reverse().find(qa))?[T.start,T.end]:null}},{key:"rangeForFunctionOrDefinition",
value:function(I,T){var qa=T[0]===T[1];return this.rangeForNodesMatching(I,T[1],function(Ga){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(Ga.type)&&(qa&&Ga.end!==T[1]||!qa&&Ga.start<T[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(I,T){"number"!==typeof T&&(T=I.positionToIndex(T));I=this.ensureAST(I);var qa=xb.query.nodesAt(T,I).reverse(),Ga=qa.find(function(nb){return"Identifier"===nb.type});if(!Ga&&((qa=qa[0])&&qa.type.includes("Specifier")&&
qa.local&&"Identifier"===qa.local.type&&(Ga=qa.local),!Ga))return;T=(qa=xb.query.findDeclarationClosestToIndex(I,Ga.name,T))?xb.query.scopeAtIndex(I,qa.start):xb.query.scopeAtIndex(I,T);var Mb=xb.query.findReferencesAndDeclsInScope(T,Ga.name).refs;return{parsed:I,scope:T,id:Ga,name:Ga.name,decl:qa,refs:Mb}}},{key:"expandRegion",value:function(I,T,qa,Ga){function Mb(Qc){Qc=I.positionToIndex({column:0,row:Ha.row});return{range:[Qc+kb.start,Qc+kb.start+kb.value.length],prev:Ga}}var nb=Ga.range[0]!==
Ga.range[1],Ha=I.indexToPosition(Ga.range[0]),kb=I.tokenAt(Ha);if(!nb&&kb&&["keyword","identifier"].includes(kb.type))return Mb();qa=qa||this.parse(T);T=xb.query.nodesAtIndex(qa,Ga.range[0]).reverse().find(function(Qc){return Qc.start<Ga.range[0]||Qc.end>Ga.range[1]});if(!T)return Ga;qa=T.start;nb=T.end;return"Literal"===T.type&&(T.raw||"").match(/^['"`]/)&&Ga.range[0]!==T.start&&Ga.range[1]!==T.end&&(T.start+1<Ga.range[0]||T.end-1>Ga.range[1])?{range:[qa+1,nb-1],prev:Ga}:{range:[qa,nb],prev:Ga}}},
{key:"contractRegion",value:function(I,T,qa,Ga){return Ga.prev||Ga}}],[{key:"className",get:function(){return"JavaScriptNavigator"}}],bc,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6658})}(void 0);fd=eb=xb.JavaScriptNavigator;xb.default=eb;var vb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");
vb.addIndexToTextPos=function(fc,bc,Tb){return fc.indexToPosition(fc.positionToIndex(bc)+Tb)};vb.connect=Ic;vb.disconnect=Ad;vb.string=Jc;vb.KeyHandler=Mc;vb.Range=bd;eb=function(fc){var bc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),Tb=bc.hasOwnProperty("Snippet")&&"function"===typeof bc.Snippet?bc.Snippet:bc.Snippet=function(I){I&&I[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return db(Tb,fc,[{key:Symbol.for("lively-instance-initialize"),
value:function(I){I=void 0===I?{trigger:null,expansion:""}:I;var T=I.expansion;this.trigger=I.trigger;this.expansion=T;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(I){this.isExpanding&&(this.textMorph=I,vb.connect(this.textMorph,"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(I){this.isExpanding&&(vb.disconnect(I,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var I=
this.expansionState,T=I.startAnchor,qa=I.endAnchor;I.isExpanding?vb.Range.fromPositions(T.position,qa.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var I=this.textMorph;if(I){var T=this.expansionState||{},qa=T.marker,Ga=T.startAnchor,Mb=T.endAnchor;T=T.steps;Ga&&I.removeAnchor(Ga);Mb&&I.removeAnchor(Mb);qa&&I.removeMarker(qa);T.forEach(function(nb){return I.removeAnchor(nb.anchor)})}this.expansionState=
{stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};I&&I.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(I){var T=[],qa=0;vb.string.reMatches(I,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(Ga){var Mb=Ga.start,nb=Ga.end;Ga=Ga.match;var Ha="";Ga.startsWith("${")?(Ha=$jscomp.makeIterator(Ga.match(/^\$\{([0-9]+):([^\}]*)\}/)),Ha.next(),Ga=Ha.next().value,Ha=Ha.next().value,Ga=Number(Ga)):
Ga=Number(Ga.replace(/^\$/,""));I=I.slice(0,Mb-qa)+Ha+I.slice(nb-qa);T[Ga]={index:Mb-qa,prefill:Ha,anchor:null};qa+=nb-Mb-Ha.length});return{steps:T,expansion:I}}},{key:"expandAtCursor",value:function(I){var T=I.selection,qa=I.cursorPosition.column,Ga=this.expansion;this.trigger&&(qa-=this.trigger.length);if(qa=Math.max(0,qa))Ga=vb.string.lines(Ga),Ga=[Ga[0]].concat($jscomp.arrayFromIterable(Ga.slice(1).map(function(qc){return vb.string.indent(qc," ",qa)}))),Ga=Ga.join("\n");var Mb=this.createExpansionSteps(Ga);
Ga=Mb.expansion;Mb=Mb.steps;this.trigger&&T.growLeft(this.trigger.length);T.text=Ga;var nb=T.start;Ga=T.end;T.collapseToEnd();if(Mb.length){var Ha=vb.string.newUUID();Mb.forEach(function(qc,Cb){return qc.anchor=I.addAnchor(Object.assign({id:"snippet-step-"+Cb+"-"+Ha},vb.addIndexToTextPos(I,nb,qc.index)))});var kb=I.addAnchor(Object.assign({id:"snippet-start-"+Ha},nb,{insertBehavior:"stay"})),Qc=I.addAnchor(Object.assign({id:"snippet-end-"+Ha},Ga));this.expansionState={marker:I.addMarker({id:"snippet-marker-"+
Ha,get range(){return{start:kb.position,end:Qc.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:kb,endAnchor:Qc,stepIndex:0,steps:Mb,isExpanding:!0};I.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var I=this.expansionState,T=I.steps,qa=this.textMorph;if(I.isExpanding&&qa){qa=qa.selection;I=T[I.stepIndex];var Ga=I.prefill;qa.lead=qa.anchor=
I.anchor.position;qa.growRight(Ga.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=T.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(I,T){T=I.positionToIndex(I.cursorPosition);return I.textString.slice(T-this.trigger.length,T)===this.trigger}},{key:"tryTrigger",value:function(I,T){if(!this.canExpand(I,I.cursorPosition))return!1;this.expandAtCursor(I);return!0}},{key:"getCommands",value:function(I){var T=
this;return I.concat([{name:"[snippet] next expansion step",exec:function(qa){T.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(qa){T.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(I){return I.concat(vb.KeyHandler.withBindings([{keys:"Tab",command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:"className",get:function(){return"Snippet"}}],bc,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:356,end:5934})}(void 0);vb.Snippet=eb;vb.Snippet=eb;vb.Snippet=eb;var Va=[{name:"get snippets",exec:function(fc){return fc.pluginCollect("getSnippets",[])}}];vb.snippetCommands=Va;vb.snippetCommands=Va;vb.snippetCommands=Va;var lb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");lb.buildEvalOpts=function(fc,bc){return fc.plugins.find(function(Tb){return Tb.isJSEditorPlugin}).sanatizedJsEnv(bc)};
lb.Snippet=eb;Va=function(fc){var bc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Tb=bc.hasOwnProperty("ModuleTopLevelVarCompleter")&&"function"===typeof bc.ModuleTopLevelVarCompleter?bc.ModuleTopLevelVarCompleter:bc.ModuleTopLevelVarCompleter=function(I){I&&I[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return db(Tb,fc,[{key:"compute",value:function(I,T){var qa,Ga,Mb,nb,Ha,kb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qc){if(1==
Qc.nextAddress){Ga=(qa=I.pluginFind(function(qc){return qc.isJSEditorPlugin}))&&qa.systemInterface();if(!Ga)return Qc.return([]);Mb=lb.buildEvalOpts(I);nb=Mb.targetModule;return"local"===Ga.name?(Ha=Object.getOwnPropertyNames(Ga.getModule(nb).recorder),Qc.jumpTo(2)):Qc.yield(Ga.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+
nb+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',{targetModule:"lively://module-recorder-completer"}),3)}if(2!=Qc.nextAddress){kb=Qc.yieldResult;if(kb.isError)return Qc.return([]);Ha=JSON.parse(kb.value)}Ha=Ha.filter(function(qc){return!qc.startsWith("defVar_")&&!["System","__currentLivelyModule",
"initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(qc)});return Qc.return(Ha.map(function(qc){return{priority:1100,completion:qc}}))})}}],[{key:"className",get:function(){return"ModuleTopLevelVarCompleter"}}],bc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:222,
end:1678})}(void 0);lb.ModuleTopLevelVarCompleter=Va;lb.ModuleTopLevelVarCompleter=Va;lb.ModuleTopLevelVarCompleter=Va;Va=function(fc){var bc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Tb=bc.hasOwnProperty("DynamicJavaScriptCompleter")&&"function"===typeof bc.DynamicJavaScriptCompleter?bc.DynamicJavaScriptCompleter:bc.DynamicJavaScriptCompleter=function(I){I&&I[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return db(Tb,
fc,[{key:"isValidPrefix",value:function(I){return/\.[a-z0-9_]*$/i.test(I)}},{key:"isMethodCallCompletion",value:function(I){return I.endsWith(")")&&0<I.indexOf("(")}},{key:"isValidIdentifier",value:function(I){if("string"!==typeof I)return!1;this.isMethodCallCompletion(I)&&(I=I.slice(0,I.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(I)?!0:!1}},{key:"wrapInBrackets",value:function(I){if(!isNaN(Number(I))||I.startsWith("Symbol."))return"["+I+"]";var T="";this.isMethodCallCompletion(I)&&(T=I.slice(I.indexOf("(")),
I=I.slice(0,I.indexOf("(")));return'["'+I.replace(/"/g,'\\"')+'"]'+T}},{key:"compute",value:function(I){var T=this,qa,Ga,Mb,nb,Ha,kb,Qc,qc,Cb,za,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ma){if(1==ma.nextAddress){qa=I.selection;qa.isEmpty()?(Ga=I.getLine(qa.lead.row),Ga=Ga.slice(Ga.lastIndexOf(":")+1,qa.lead.column)):Ga=qa.text.slice(Math.max(0,qa.text.indexOf(":")),0);if(!T.isValidPrefix(Ga))return ma.return([]);nb=(Mb=I.pluginFind(function(la){return la.isJSEditorPlugin}))&&
Mb.systemInterface();if(!nb)return ma.return([]);Ha=lb.buildEvalOpts(I);return ma.yield(nb.dynamicCompletionsForPrefix(Ha.targetModule,Ga,Ha),2)}kb=ma.yieldResult;Qc=kb.isError;qc=kb.value;Cb=kb.completions;za=kb.prefix;if(Qc)return console.warn("javascript completer encountered error: "+(qc.stack||qc)),ma.return([]);Cb.reduce(function(la,va){va=$jscomp.makeIterator(va);va.next();va=va.next().value;return la+va.length},0);Ca=Cb.reduce(function(la,va,cb){va=$jscomp.makeIterator(va);var fb=va.next().value;
va=va.next().value;return la.concat(va.map(function(ec){var Nc=T.isValidIdentifier(ec);return{info:fb,completion:ec,prefix:Nc?za:"."+za,customInsertionFn:Nc?T.isMethodCallCompletion(ec)?function(pd,Yd,uc,Qd){Yd=Qd.start;Qd=Qd.end;pd=pd.replace(/\((.*)\)/,function(cd){return"("+cd.slice(1,-1).split(", ").map(function(zb,da){return"${"+da+":"+zb+"}"}).join(", ")+")"});pd=new lb.Snippet({expansion:pd});uc.replace({start:Yd,end:Qd},"");pd.expandAtCursor(uc)}:null:function(pd,Yd,uc,Qd){pd=Qd.start;Qd=
Qd.end;Yd={row:pd.row,column:pd.column-1};Qd="."===uc.textInRange({start:Yd,end:pd})?{start:Yd,end:Qd}:{start:pd,end:Qd};uc.replace(Qd,T.wrapInBrackets(ec))}}}))},[]);Ca.forEach(function(la,va){return Object.assign(la,{priority:2E3+Ca.length-va})});return ma.return(Ca)})}}],[{key:"className",get:function(){return"DynamicJavaScriptCompleter"}}],bc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1687,end:5122})}(void 0);lb.DynamicJavaScriptCompleter=Va;lb.DynamicJavaScriptCompleter=Va;lb.DynamicJavaScriptCompleter=Va;lb.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
Va=function(fc){var bc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Tb=bc.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof bc.JavaScriptKeywordCompleter?bc.JavaScriptKeywordCompleter:bc.JavaScriptKeywordCompleter=function(I){I&&I[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return db(Tb,fc,[{key:"compute",value:function(I,T){return lb.keywords.map(function(qa){return{completion:qa,priority:0}})}}],
[{key:"className",get:function(){return"JavaScriptKeywordCompleter"}}],bc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6125,end:6262})}(void 0);lb.JavaScriptKeywordCompleter=Va;lb.JavaScriptKeywordCompleter=Va;lb.JavaScriptKeywordCompleter=Va;Va=[new lb.DynamicJavaScriptCompleter,new lb.JavaScriptKeywordCompleter,
new lb.ModuleTopLevelVarCompleter];lb.completers=Va;lb.completers=Va;lb.completers=Va;var yb=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");yb.Snippet=eb;var Zb=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],["importd",'import ${0:name} from "${1:module}";'],
["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],["do","do {${1:/* code */}} while (${0:/* condition */});"],
["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],
["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],["ll","lively.lang."],["lls","lively.lang.string."],
["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],["fun","function ${0:functionName}($1) {$2}"],
["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];yb.snippets=Zb;yb.snippets=Zb;yb.snippets=Zb;var Sb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");Sb.getEvalEnv=function(fc){return(fc=fc.pluginFind(function(bc){return bc.isJSEditorPlugin}))?fc.evalEnvironment:null};Sb.setEvalEnv=function(fc,bc){(fc=fc.pluginFind(function(Tb){return Tb.isJSEditorPlugin}))&&Object.assign(fc.evalEnvironment,bc);return fc.evalEnvironment};Sb.pToI=function(fc,bc){return fc.positionToIndex(bc)};
Sb.iToP=function(fc,bc){return fc.indexToPosition(bc)};Sb.arr=ed;Sb.promise=Od;Sb.string=Jc;Sb.show=Tc;Sb.Range=bd;Sb.query=Eb;Sb.BaseVisitor=qd;yb=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(fc,bc){bc=void 0===bc?{varName:null,position:null}:bc;var Tb,I,T,qa,Ga,Mb,nb,Ha,kb,Qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qc){switch(qc.nextAddress){case 1:Tb=bc;I=Tb.varName;T=
Tb.position;if(!I){T||(T=fc.cursorPosition);qa=fc.pluginInvokeFirst("getNavigator");Ga=qa.ensureAST(fc);Mb=Sb.query.nodesAt(fc.positionToIndex(T),Ga).reverse().find(function(Cb){return"Identifier"===Cb.type});if(!Mb)return fc.showError(Error("no identifier found!")),qc.return(!0);I=Mb.name}bc=fc.pluginFind(function(Cb){return Cb.isJSEditorPlugin}).sanatizedJsEnv();nb='lively.modules.module("'+bc.targetModule+'").undefine("'+I+'")';qc.setCatchFinallyBlocks(2);return qc.yield(fc.doEval(null,bc,nb),
4);case 4:Ha=qc.yieldResult;kb=Ha.error?Ha.error:Ha.isError?Ha.value:null;qc.leaveTryBlock(3);break;case 2:kb=Qc=qc.enterCatchBlock();case 3:return kb?fc.showError(kb):fc.setStatusMessage(I+" undefined"),qc.return(!0)}})}},{name:"change doitContext",exec:function(fc){var bc,Tb,I,T,qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){if(1==Ga.nextAddress)return bc=$jscomp,Tb=bc.makeIterator,Ga.yield(fc.world().execCommand("select morph",{prompt:"select morph for doitContext",justReturn:!0,
prependItems:["reset"],filterFn:function(Mb){return!Mb.isUsedAsEpiMorph()}}),2);I=Tb.call(bc,Ga.yieldResult);if(T=I.next().value)qa="reset"===T,fc.doitContext=qa?null:T,fc.setStatusMessage(qa?"doitContext is now\n"+T:"doitContext reset");return Ga.return(!0)})}},{name:"change eval backend",exec:function(fc,bc){bc=void 0===bc?{backend:void 0}:bc;var Tb,I;return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){if(1==T.nextAddress)return Tb=bc,I=Tb.backend,void 0!==I?T.jumpTo(2):T.yield(fc.world().prompt("choose eval backend",
{historyId:"js-eval-backend-history"}),3);if(2!=T.nextAddress&&(I=T.yieldResult,!I))return fc.setStatusMessage("Canceled"),T.return(!0);"local"===I&&(I=null);fc.setStatusMessage("Eval backend is now "+(I||"local"));return T.return(Sb.setEvalEnv(fc,{remote:I}))})}},{name:"copy current module name to clipboard",exec:function(fc){var bc=fc.evalEnvironment.targetModule;fc.setStatusMessage(bc?bc:"Cannot find module name");fc.env.eventDispatcher.killRing.add(fc);fc.env.eventDispatcher.doCopy(bc);return!0}}];
Sb.jsEditorCommands=yb;Sb.jsEditorCommands=yb;Sb.jsEditorCommands=yb;var $a=[{name:"[javascript] list errors and warnings",exec:function(fc){var bc,Tb,I,T,qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){if(1==Ga.nextAddress){bc=(fc.markers||[]).filter(function(Mb){Mb=Mb.type;return"js-undeclared-var"===Mb||"js-syntax-error"===Mb});if(!bc.length)return Sb.show("no warnings or errors"),Ga.return(!0);Tb=bc.map(function(Mb){var nb=Mb.range;return{isListItem:!0,string:"["+Mb.type.split("-").slice(1).join(" ")+
"] "+fc.textInRange(nb),value:nb}});return Ga.yield(fc.world().filterableListPrompt("jump to warning or error",Tb),2)}I=Ga.yieldResult;T=$jscomp.makeIterator(I.selected);if(qa=T.next().value)fc.saveMark(),fc.selection=qa,fc.centerRow(qa.start.row);return Ga.return(!0)})}},{name:"[javascript] inject import",exec:function(fc,bc){bc=void 0===bc?{gotoImport:!1,insertImportAtCursor:!0}:bc;var Tb,I,T;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qa){switch(qa.nextAddress){case 1:return qa.yield(Sb.promise.delay(0),
2);case 2:return qa.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return Tb=qa.yieldResult,I=Tb.interactivelyInjectImportIntoText,qa.yield(I(fc,bc),4);case 4:return(T=qa.yieldResult)||fc.setStatusMessage("canceled"),qa.return(T)}})}},{name:"[javascript] fix undeclared variables",exec:function(fc,bc){bc=void 0===bc?{ignore:[],autoApplyIfSingleChoice:!1,requester:fc}:bc;var Tb,I,T;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qa){if(1==qa.nextAddress)return qa.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=qa.nextAddress)return Tb=qa.yieldResult,I=Tb.interactivlyFixUndeclaredVariables,qa.yield(I(fc,bc),3);T=qa.yieldResult;fc.focus();return qa.return(T)})}},{name:"[javascript] remove unused imports",exec:function(fc,bc){bc=void 0===bc?{query:!0}:bc;var Tb,I,T;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qa){if(1==qa.nextAddress)return qa.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=qa.nextAddress)return Tb=qa.yieldResult,I=Tb.cleanupUnusedImports,qa.yield(I(fc,
bc),3);T=qa.yieldResult;fc.setStatusMessage(T);return qa.return(!0)})}},{name:"[javascript] eslint report",exec:function(fc){var bc,Tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(I){if(1==I.nextAddress)return I.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);bc=I.yieldResult;Tb=bc.default;try{return I.return(Tb.reportOnMorph(fc))}catch(T){fc.showError(T)}I.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(fc){var bc,Tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(I){if(1==
I.nextAddress)return I.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);bc=I.yieldResult;Tb=bc.default;try{return I.return(Tb.previewFixesOnMorph(fc))}catch(T){fc.showError(T)}I.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(fc,bc,Tb){function I(ma,la){la||(la=Ha(ma,{allowReturnOutsideFunction:!0}));var va=Sb.string.lineRanges(ma),cb=ma.split("\n"),fb=[],ec=new Sb.BaseVisitor,Nc=ec.visitVariableDeclaration;ec.visitVariableDeclaration=function(Qd,
cd,zb){if(1<Qd.declarations.length)for(var da=Sb.string.findLineWithIndexInLineRanges(va,Qd.start),ra=Qd.declarations[0].start-va[da][0],sb={},H=1;H<Qd.declarations.length;sb={$jscomp$loop$prop$actionType$2277:sb.$jscomp$loop$prop$actionType$2277,$jscomp$loop$prop$arg$2278:sb.$jscomp$loop$prop$arg$2278},H++){var fa=Qd.declarations[H],Fa=Sb.string.findLineWithIndexInLineRanges(va,fa.start);if(da!==Fa){var qb=cb[Fa].match(/\s*/)[0].length;qb=ra-qb;0!==qb&&(fa=Sb.string.findLineWithIndexInLineRanges(va,
fa.end),sb.$jscomp$loop$prop$actionType$2277=0<qb?"insert":"delete",sb.$jscomp$loop$prop$arg$2278=0<qb?" ".repeat(qb):-qb,fb.push.apply(fb,$jscomp.arrayFromIterable(Sb.arr.range(Fa,fa).map(function(nc){return function(xc){return[nc.$jscomp$loop$prop$actionType$2277,va[xc][0],nc.$jscomp$loop$prop$arg$2278]}}(sb)))))}}return Nc.call(ec,Qd,cd,zb)};ec.accept(la,{},[]);for(la=fb.length;la--;){var pd=$jscomp.makeIterator(fb[la]),Yd=pd.next().value,uc=pd.next().value;pd=pd.next().value;"insert"===Yd?ma=
ma.slice(0,uc)+pd+ma.slice(uc):"delete"===Yd&&(ma=ma.slice(0,uc)+ma.slice(uc+pd))}return ma}var T,qa,Ga,Mb,nb,Ha,kb,Qc,qc,Cb,za,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ma){switch(ma.nextAddress){case 1:return T=Tb?Tb:Math.floor(fc.width/fc.defaultCharExtent().width),bc=Object.assign({printWidth:T,tabWidth:2,useTabs:!1,bracketSpacing:!1},bc),qa=lively.modules.module,Ga=System.normalizeSync("prettier/standalone.js"),ma.yield(qa(Ga).load({format:"global",instrument:!1}),2);case 2:return Mb=
ma.yieldResult,ma.yield(qa("lively.ast/lib/acorn-extension.js").load(),3);case 3:return ma.yield(qa("lively.ast").load(),4);case 4:return nb=ma.yieldResult,Ha=nb.parse,ma.yield(qa("lively.ast/lib/query.js").load(),5);case 5:return ma.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return kb=ma.yieldResult,Qc=fc.selection.isEmpty()?fc.documentRange:fc.selection.range,qc=fc.positionToIndex(Qc.start),Cb=fc.positionToIndex(Qc.end),za=Mb.format(fc.textString,Object.assign({},
bc,{rangeStart:qc,rangeEnd:Cb,parser:function(la,va,cb){return Ha(la,{allowReturnOutsideFunction:!0})}})),fc.undoManager.group(),Ca=kb.diffChars(fc.textString,za),fc.applyJsDiffPatch(Ca),fc.selection.text=I(fc.selection.text),fc.undoManager.group(),ma.return(!0)}})}}];Sb.jsIdeCommands=$a;Sb.jsIdeCommands=$a;Sb.jsIdeCommands=$a;var bb=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(fc,bc){bc=fc.pluginInvokeFirst("getNavigator");if(!bc)return!0;bc=bc.resolveIdentifierAt(fc,fc.cursorPosition);
if(!bc||!bc.id)return Sb.show("No symbol identifier selected"),!0;if(!bc.decl)return Sb.show("Cannot find declaration of "+bc.name),!0;fc.saveMark();fc.selection={start:fc.indexToPosition(bc.decl.start),end:fc.indexToPosition(bc.decl.end)};fc.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(fc){fc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(fc){fc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(fc,bc){bc=void 0===bc?{direction:null}:bc;var Tb=fc.pluginInvokeFirst("getNavigator");if(!Tb)return!0;Tb=Tb.resolveIdentifierAt(fc,
fc.cursorPosition);if(!Tb||!Tb.refs)return Sb.show("No symbol identifier selected"),!0;var I=fc.selection;Tb=Tb.refs.map(function(qa){var Ga=qa.end;return Sb.Range.fromPositions(Sb.iToP(fc,qa.start),Sb.iToP(fc,Ga))}).concat(Tb.decl?Sb.Range.fromPositions(Sb.iToP(fc,Tb.decl.start),Sb.iToP(fc,Tb.decl.end)):[]).sort(Sb.Range.compare);if(!Tb.length)return!0;var T=Tb.map(String).indexOf(String(I.range));if("next"===bc.direction||"prev"===bc.direction)-1===T&&Tb.length?Tb=[Tb[0]]:(bc=T+("next"===bc.direction?
1:-1),0>bc?bc=Tb.length-1:bc>=Tb.length&&(bc=0),Tb=[Tb[bc]]);Tb.forEach(function(qa){var Ga=I.selections.findIndex(function(nb){return nb.range.equals(qa)}),Mb=I.selections.length-1;-1<Ga?Sb.arr.swap(I.selections,Ga,Mb):I.addRange(qa,!1)});I.mergeSelections();return!0}}];Sb.astEditorCommands=bb;Sb.astEditorCommands=bb;Sb.astEditorCommands=bb;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var Kb=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
Kb.expressionAllowed=function(fc,bc,Tb){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(bc.lastType)||"quasi"==bc.lastType&&/\{\s*$/.test(fc.string.slice(0,fc.pos-(Tb||0)))};Kb.passIndent=Ra;Kb.defineMode=wb;Kb.defineMIME=mc;Kb.registerHelper=dc;Kb.defaultConfig={indentUnit:2};Kb.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};Kb.defineMode("javascript",
function(fc,bc){function Tb(Sa,Zc,Zd){Bj=Sa;Bh=Zd;return Zc}function I(Sa,Zc){var Zd=Sa.next();if('"'==Zd||"'"==Zd)return Zc.tokenize=T(Zd),Zc.tokenize(Sa,Zc);if("."==Zd&&Sa.match(/^\d+(?:[eE][+\-]?\d+)?/))return Tb("number","number");if("."==Zd&&Sa.match(".."))return Tb("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(Zd))return Tb(Zd);if("="==Zd&&Sa.eat(">"))return Tb("=>","operator");if("0"==Zd&&Sa.eat(/x/i))return Sa.eatWhile(/[\da-f]/i),Tb("number","number");if("0"==Zd&&Sa.eat(/o/i))return Sa.eatWhile(/[0-7]/i),
Tb("number","number");if("0"==Zd&&Sa.eat(/b/i))return Sa.eatWhile(/[01]/i),Tb("number","number");if(/\d/.test(Zd))return Sa.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),Tb("number","number");if("/"==Zd){if(Sa.eat("*"))return Zc.tokenize=qa,qa(Sa,Zc);if(Sa.eat("/"))return Sa.skipToEnd(),Tb("comment","comment");if(Kb.expressionAllowed(Sa,Zc,1)){a:for(var Vd=Zc=!1;null!=(Zd=Sa.next());){if(!Zc){if("/"==Zd&&!Vd)break a;"["==Zd?Vd=!0:Vd&&"]"==Zd&&(Vd=!1)}Zc=!Zc&&"\\"==Zd}Sa.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return Tb("regexp","string-2")}Sa.eatWhile(yk);return Tb("operator","operator",Sa.current())}if("`"==Zd)return Zc.tokenize=Ga,Ga(Sa,Zc);if("#"==Zd)return Sa.skipToEnd(),Tb("error","error");if(yk.test(Zd))return">"==Zd&&Zc.lexical&&">"==Zc.lexical.type||Sa.eatWhile(yk),Tb("operator","operator",Sa.current());if(Mj.test(Zd))return Sa.eatWhile(Mj),Sa=Sa.current(),(Zd=lg.propertyIsEnumerable(Sa)&&lg[Sa])&&"."!=Zc.lastType?Tb(Zd.type,Zd.style,Sa):Tb("variable","variable",Sa)}function T(Sa){return function(Zc,
Zd){var Vd=!1,Lc;if(Kh&&"@"==Zc.peek()&&Zc.match(Tj))return Zd.tokenize=I,Tb("jsonld-keyword","meta");for(;null!=(Lc=Zc.next())&&(Lc!=Sa||Vd);)Vd=!Vd&&"\\"==Lc;Vd||(Zd.tokenize=I);return Tb("string","string")}}function qa(Sa,Zc){for(var Zd=!1,Vd;Vd=Sa.next();){if("/"==Vd&&Zd){Zc.tokenize=I;break}Zd="*"==Vd}return Tb("comment","comment")}function Ga(Sa,Zc){for(var Zd=!1,Vd;null!=(Vd=Sa.next());){if(!Zd&&("`"==Vd||"$"==Vd&&Sa.eat("{"))){Zc.tokenize=I;break}Zd=!Zd&&"\\"==Vd}return Tb("quasi","string-2",
Sa.current())}function Mb(Sa,Zc){Zc.fatArrowAt&&(Zc.fatArrowAt=null);var Zd=Sa.string.indexOf("=>",Sa.start);if(!(0>Zd)){if(gj){var Vd=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Sa.string.slice(Sa.start,Zd));Vd&&(Zd=Vd.index)}Vd=0;var Lc=!1;for(--Zd;0<=Zd;--Zd){var dg=Sa.string.charAt(Zd),ji="([{}])".indexOf(dg);if(0<=ji&&3>ji){if(!Vd){++Zd;break}if(0==--Vd){"("==dg&&(Lc=!0);break}}else if(3<=ji&&6>ji)++Vd;else if(Mj.test(dg))Lc=!0;else{if(/["'\/]/.test(dg))return;if(Lc&&!Vd){++Zd;break}}}Lc&&
!Vd&&(Zc.fatArrowAt=Zd)}}function nb(Sa,Zc,Zd,Vd,Lc,dg){this.indented=Sa;this.column=Zc;this.type=Zd;this.prev=Lc;this.info=dg;null!=Vd&&(this.align=Vd)}function Ha(){for(var Sa=arguments.length-1;0<=Sa;Sa--)Ze.cc.push(arguments[Sa])}function kb(){Ha.apply(null,arguments);return!0}function Qc(Sa){function Zc(Vd){for(;Vd;Vd=Vd.next)if(Vd.name==Sa)return!0;return!1}var Zd=Ze.state;Ze.marked="def";Zd.context?Zc(Zd.localVars)||(Zd.localVars={name:Sa,next:Zd.localVars}):!Zc(Zd.globalVars)&&bc.globalVars&&
(Zd.globalVars={name:Sa,next:Zd.globalVars})}function qc(){Ze.state.context={prev:Ze.state.context,vars:Ze.state.localVars};Ze.state.localVars=ll}function Cb(){Ze.state.localVars=Ze.state.context.vars;Ze.state.context=Ze.state.context.prev}function za(Sa,Zc){var Zd=function(){var Vd=Ze.state,Lc=Vd.indented;if("stat"==Vd.lexical.type)Lc=Vd.lexical.indented;else for(var dg=Vd.lexical;dg&&")"==dg.type&&dg.align;dg=dg.prev)Lc=dg.indented;Vd.lexical=new nb(Lc,Ze.stream.column(),Sa,null,Vd.lexical,Zc)};
Zd.lex=!0;return Zd}function Ca(){var Sa=Ze.state;Sa.lexical.prev&&(")"==Sa.lexical.type&&(Sa.indented=Sa.lexical.indented),Sa.lexical=Sa.lexical.prev)}function ma(Sa){function Zc(Zd){return Zd==Sa?kb():";"==Sa?Ha():kb(Zc)}return Zc}function la(Sa,Zc){return"var"==Sa?kb(za("vardef",Zc.length),yc,ma(";"),Ca):"keyword a"==Sa?kb(za("form"),fb,la,Ca):"keyword b"==Sa?kb(za("form"),la,Ca):"{"==Sa?kb(za("}"),ue,Ca):";"==Sa?kb():"if"==Sa?("else"==Ze.state.lexical.info&&Ze.state.cc[Ze.state.cc.length-1]==
Ca&&Ze.state.cc.pop()(),kb(za("form"),fb,la,Ca,xa)):"function"==Sa?kb(ib):"for"==Sa?kb(za("form"),Na,la,Ca):"variable"==Sa?gj&&"type"==Zc?(Ze.marked="keyword",kb(Gd,ma("operator"),Gd,ma(";"))):kb(za("stat"),fa):"switch"==Sa?kb(za("form"),fb,ma("{"),za("}","switch"),ue,Ca,Ca):"case"==Sa?kb(va,ma(":")):"default"==Sa?kb(ma(":")):"catch"==Sa?kb(za("form"),qc,ma("("),rc,ma(")"),la,Ca,Cb):"class"==Sa?kb(za("form"),ad,Ca):"export"==Sa?kb(za("stat"),Mf,Ca):"import"==Sa?kb(za("stat"),Hg,Ca):"module"==Sa?kb(za("form"),
Ie,ma("{"),za("}"),ue,Ca,Ca):"async"==Sa?kb(la):"@"==Zc?kb(va,la):Ha(za("stat"),va,ma(";"),Ca)}function va(Sa){return ec(Sa,!1)}function cb(Sa){return ec(Sa,!0)}function fb(Sa){return"("!=Sa?Ha():kb(za(")"),va,ma(")"),Ca)}function ec(Sa,Zc){if(Ze.state.fatArrowAt==Ze.stream.start){var Zd=Zc?da:zb;if("("==Sa)return kb(qc,za(")"),Bd(Ie,")"),Ca,ma("=>"),Zd,Cb);if("variable"==Sa)return Ha(qc,Ie,ma("=>"),Zd,Cb)}Zd=Zc?uc:Yd;return zf.hasOwnProperty(Sa)?kb(Zd):"function"==Sa?kb(ib,Zd):"class"==Sa?kb(za("form"),
cc,Ca):"keyword c"==Sa||"async"==Sa?kb(Zc?pd:Nc):"("==Sa?kb(za(")"),Nc,ma(")"),Ca,Zd):"operator"==Sa||"spread"==Sa?kb(Zc?cb:va):"["==Sa?kb(za("]"),Nj,Ca,Zd):"{"==Sa?Cd(qb,"}",null,Zd):"quasi"==Sa?Ha(Qd,Zd):"new"==Sa?kb(ra(Zc)):kb()}function Nc(Sa){return Sa.match(/[;\}\)\],]/)?Ha():Ha(va)}function pd(Sa){return Sa.match(/[;\}\)\],]/)?Ha():Ha(cb)}function Yd(Sa,Zc){return","==Sa?kb(va):uc(Sa,Zc,!1)}function uc(Sa,Zc,Zd){var Vd=0==Zd?Yd:uc,Lc=0==Zd?va:cb;if("=>"==Sa)return kb(qc,Zd?da:zb,Cb);if("operator"==
Sa)return/\+\+|--/.test(Zc)?kb(Vd):"?"==Zc?kb(va,ma(":"),Lc):kb(Lc);if("quasi"==Sa)return Ha(Qd,Vd);if(";"!=Sa){if("("==Sa)return Cd(cb,")","call",Vd);if("."==Sa)return kb(Fa,Vd);if("["==Sa)return kb(za("]"),Nc,ma("]"),Ca,Vd)}}function Qd(Sa,Zc){return"quasi"!=Sa?Ha():"${"!=Zc.slice(Zc.length-2)?kb(Qd):kb(va,cd)}function cd(Sa){if("}"==Sa)return Ze.marked="string-2",Ze.state.tokenize=Ga,kb(Qd)}function zb(Sa){Mb(Ze.stream,Ze.state);return Ha("{"==Sa?la:va)}function da(Sa){Mb(Ze.stream,Ze.state);return Ha("{"==
Sa?la:cb)}function ra(Sa){return function(Zc){return"."==Zc?kb(Sa?H:sb):Ha(Sa?cb:va)}}function sb(Sa,Zc){if("target"==Zc)return Ze.marked="keyword",kb(Yd)}function H(Sa,Zc){if("target"==Zc)return Ze.marked="keyword",kb(uc)}function fa(Sa){return":"==Sa?kb(Ca,la):Ha(Yd,ma(";"),Ca)}function Fa(Sa){if("variable"==Sa)return Ze.marked="property",kb()}function qb(Sa,Zc){if("async"==Sa)return Ze.marked="property",kb(qb);if("variable"==Sa||"keyword"==Ze.style)return Ze.marked="property","get"==Zc||"set"==
Zc?kb(nc):kb(xc);if("number"==Sa||"string"==Sa)return Ze.marked=Kh?"property":Ze.style+" property",kb(xc);if("jsonld-keyword"==Sa)return kb(xc);if("modifier"==Sa)return kb(qb);if("["==Sa)return kb(va,ma("]"),xc);if("spread"==Sa)return kb(va);if(":"==Sa)return Ha(xc)}function nc(Sa){if("variable"!=Sa)return Ha(xc);Ze.marked="property";return kb(ib)}function xc(Sa){if(":"==Sa)return kb(cb);if("("==Sa)return Ha(ib)}function Bd(Sa,Zc,Zd){function Vd(Lc,dg){return(Zd?-1<Zd.indexOf(Lc):","==Lc)?(Lc=Ze.state.lexical,
"call"==Lc.info&&(Lc.pos=(Lc.pos||0)+1),kb(function(ji,Rk){return ji==Zc||Rk==Zc?Ha():Ha(Sa)},Vd)):Lc==Zc||dg==Zc?kb():kb(ma(Zc))}return function(Lc,dg){return Lc==Zc||dg==Zc?kb():Ha(Sa,Vd)}}function Cd(Sa,Zc,Zd){for(var Vd=3;Vd<arguments.length;Vd++)Ze.cc.push(arguments[Vd]);return kb(za(Zc,Zd),Bd(Sa,Zc),Ca)}function ue(Sa){return"}"==Sa?kb():Ha(la,ue)}function jd(Sa,Zc){if(gj){if(":"==Sa)return kb(Gd);if("?"==Zc)return kb(jd)}}function Gd(Sa){if("variable"==Sa)return Ze.marked="variable-3",kb(tf);
if("string"==Sa||"number"==Sa||"atom"==Sa)return kb(tf);if("{"==Sa)return kb(za("}"),Bd(He,"}",",;"),Ca);if("("==Sa)return kb(Bd(yf,")"),re)}function re(Sa){if("=>"==Sa)return kb(Gd)}function He(Sa,Zc){if("variable"==Sa||"keyword"==Ze.style)return Ze.marked="property",kb(He);if("?"==Zc)return kb(He);if(":"==Sa)return kb(Gd)}function yf(Sa){if("variable"==Sa)return kb(yf);if(":"==Sa)return kb(Gd)}function tf(Sa,Zc){if("<"==Zc)return kb(za(">"),Bd(Gd,">"),Ca,tf);if("|"==Zc||"."==Sa)return kb(Gd);if("["==
Sa)return kb(ma("]"),tf);if("extends"==Zc)return kb(Gd)}function yc(){return Ha(Ie,jd,Jf,Be)}function Ie(Sa,Zc){if("modifier"==Sa)return kb(Ie);if("variable"==Sa)return Qc(Zc),kb();if("spread"==Sa)return kb(Ie);if("["==Sa)return Cd(Ie,"]");if("{"==Sa)return Cd(mf,"}")}function mf(Sa,Zc){if("variable"==Sa&&!Ze.stream.match(/^\s*:/,!1))return Qc(Zc),kb(Jf);"variable"==Sa&&(Ze.marked="property");return"spread"==Sa?kb(Ie):"}"==Sa?Ha():kb(ma(":"),Ie,Jf)}function Jf(Sa,Zc){if("="==Zc)return kb(cb)}function Be(Sa){if(","==
Sa)return kb(yc)}function xa(Sa,Zc){if("keyword b"==Sa&&"else"==Zc)return kb(za("form","else"),la,Ca)}function Na(Sa){if("("==Sa)return kb(za(")"),ub,ma(")"),Ca)}function ub(Sa){return"var"==Sa?kb(yc,ma(";"),wa):";"==Sa?kb(wa):"variable"==Sa?kb(Q):Ha(va,ma(";"),wa)}function Q(Sa,Zc){return"in"==Zc||"of"==Zc?(Ze.marked="keyword",kb(va)):kb(Yd,wa)}function wa(Sa,Zc){return";"==Sa?kb(Xa):"in"==Zc||"of"==Zc?(Ze.marked="keyword",kb(va)):Ha(va,ma(";"),Xa)}function Xa(Sa){")"!=Sa&&kb(va)}function ib(Sa,
Zc){if("*"==Zc)return Ze.marked="keyword",kb(ib);if("variable"==Sa)return Qc(Zc),kb(ib);if("("==Sa)return kb(qc,za(")"),Bd(rc,")"),Ca,jd,la,Cb);if(gj&&"<"==Zc)return kb(za(">"),Bd(Gd,">"),Ca,ib)}function rc(Sa){return"spread"==Sa?kb(rc):Ha(Ie,jd,Jf)}function cc(Sa,Zc){return"variable"==Sa?ad(Sa,Zc):Vc(Sa,Zc)}function ad(Sa,Zc){if("variable"==Sa)return Qc(Zc),kb(Vc)}function Vc(Sa,Zc){if("<"==Zc)return kb(za(">"),Bd(Gd,">"),Ca,Vc);if("extends"==Zc||"implements"==Zc||gj&&","==Sa)return kb(gj?Gd:va,
Vc);if("{"==Sa)return kb(za("}"),Yc,Ca)}function Yc(Sa,Zc){if("variable"==Sa||"keyword"==Ze.style){if(("async"==Zc||"static"==Zc||"get"==Zc||"set"==Zc||gj&&("public"==Zc||"private"==Zc||"protected"==Zc||"readonly"==Zc||"abstract"==Zc))&&Ze.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Ze.marked="keyword",kb(Yc);Ze.marked="property";return kb(gj?$d:ib,Yc)}if("["==Sa)return kb(va,ma("]"),gj?$d:ib,Yc);if("*"==Zc)return Ze.marked="keyword",kb(Yc);if(";"==Sa)return kb(Yc);if("}"==Sa)return kb();if("@"==
Zc)return kb(va,Yc)}function $d(Sa,Zc){return"?"==Zc?kb($d):":"==Sa?kb(Gd,Jf):"="==Zc?kb(cb):Ha(ib)}function Mf(Sa,Zc){return"*"==Zc?(Ze.marked="keyword",kb(Pg,ma(";"))):"default"==Zc?(Ze.marked="keyword",kb(va,ma(";"))):"{"==Sa?kb(Bd(Bf,"}"),Pg,ma(";")):Ha(la)}function Bf(Sa,Zc){if("as"==Zc)return Ze.marked="keyword",kb(ma("variable"));if("variable"==Sa)return Ha(cb,Bf)}function Hg(Sa){return"string"==Sa?kb():Ha(cf,Bg,Pg)}function cf(Sa,Zc){if("{"==Sa)return Cd(cf,"}");"variable"==Sa&&Qc(Zc);"*"==
Zc&&(Ze.marked="keyword");return kb(Di)}function Bg(Sa){if(","==Sa)return kb(cf,Bg)}function Di(Sa,Zc){if("as"==Zc)return Ze.marked="keyword",kb(cf)}function Pg(Sa,Zc){if("from"==Zc)return Ze.marked="keyword",kb(va)}function Nj(Sa){return"]"==Sa?kb():Ha(Bd(cb,"]"))}fc=Object.assign({},Kb.defaultConfig,{},fc);bc=Object.assign({},Kb.defaultParserConfig,{},bc);var Pe=fc.indentUnit,ki=bc.statementIndent,Kh=bc.jsonld,ce=bc.json||Kh,gj=bc.typescript,Mj=bc.wordCharacters||/[\w$\xa1-\uffff]/,lg=function(){function Sa(Rk){return{type:Rk,
style:"keyword"}}var Zc=Sa("keyword a"),Zd=Sa("keyword b"),Vd=Sa("keyword c"),Lc=Sa("operator"),dg={type:"atom",style:"atom"};Zc={"if":Sa("if"),"while":Zc,"with":Zc,"else":Zd,"do":Zd,"try":Zd,"finally":Zd,"return":Vd,"break":Vd,"continue":Vd,"new":Sa("new"),"delete":Vd,"throw":Vd,"debugger":Vd,"var":Sa("var"),"const":Sa("var"),let:Sa("var"),"function":Sa("function"),"catch":Sa("catch"),"for":Sa("for"),"switch":Sa("switch"),"case":Sa("case"),"default":Sa("default"),"in":Lc,"typeof":Lc,"instanceof":Lc,
"true":dg,"false":dg,"null":dg,undefined:dg,NaN:dg,Infinity:dg,"this":Sa("this"),"class":Sa("class"),"super":Sa("atom"),yield:Vd,"export":Sa("export"),"import":Sa("import"),"extends":Vd,await:Vd,async:Sa("async")};if(gj){Zd={type:"variable",style:"variable-3"};Vd={"interface":Sa("class"),"implements":Vd,namespace:Vd,module:Sa("module"),"enum":Sa("module"),"public":Sa("modifier"),"private":Sa("modifier"),"protected":Sa("modifier"),"abstract":Sa("modifier"),as:Lc,string:Zd,number:Zd,"boolean":Zd,any:Zd};
for(var ji in Vd)Zc[ji]=Vd[ji]}return Zc}(),yk=/[+\-*&%=<>!?|~^@]/,Tj=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,Bj,Bh,zf={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0,"jsonld-keyword":!0},Ze={state:null,column:null,marked:null,cc:null},ll={name:"this",next:{name:"arguments"}};Ca.lex=!0;return{startState:function(Sa){Sa={tokenize:I,lastType:"sof",cc:[],lexical:new nb((Sa||0)-Pe,0,"block",!1),localVars:bc.localVars,context:bc.localVars&&{vars:bc.localVars},
indented:Sa||0};bc.globalVars&&"object"==typeof bc.globalVars&&(Sa.globalVars=bc.globalVars);return Sa},token:function(Sa,Zc){Sa.sol()&&(Zc.lexical.hasOwnProperty("align")||(Zc.lexical.align=!1),Zc.indented=Sa.indentation(),Mb(Sa,Zc));if(Zc.tokenize!=qa&&Sa.eatSpace())return null;var Zd=Zc.tokenize(Sa,Zc);if("comment"==Bj)return Zd;Zc.lastType="operator"!=Bj||"++"!=Bh&&"--"!=Bh?Bj:"incdec";a:{var Vd=Bj,Lc=Bh,dg=Zc.cc;Ze.state=Zc;Ze.stream=Sa;Ze.marked=null;Ze.cc=dg;Ze.style=Zd;Zc.lexical.hasOwnProperty("align")||
(Zc.lexical.align=!0);for(Sa=0;;){if(1E5<Sa++)throw Error("endless");if((dg.length?dg.pop():ce?va:la)(Vd,Lc)){for(;dg.length&&dg[dg.length-1].lex;)dg.pop()();if(Ze.marked){Zd=Ze.marked;break a}if(Vd="variable"==Vd)b:{for(Vd=Zc.localVars;Vd;Vd=Vd.next)if(Vd.name==Lc){Vd=!0;break b}for(Zc=Zc.context;Zc;Zc=Zc.prev)for(Vd=Zc.vars;Vd;Vd=Vd.next)if(Vd.name==Lc){Vd=!0;break b}Vd=void 0}if(Vd){Zd="variable-2";break a}break a}}}return Zd},indent:function(Sa,Zc){if(Sa.tokenize==qa)return Kb.passIndent;if(Sa.tokenize!=
I)return 0;var Zd=Zc&&Zc.charAt(0),Vd=Sa.lexical,Lc;if(!/^\s*else\b/.test(Zc))for(var dg=Sa.cc.length-1;0<=dg;--dg){var ji=Sa.cc[dg];if(ji==Ca)Vd=Vd.prev;else if(ji!=xa)break}for(;!("stat"!=Vd.type&&"form"!=Vd.type||"}"!=Zd&&(!(Lc=Sa.cc[Sa.cc.length-1])||Lc!=Yd&&Lc!=uc||/^[,\.=+\-*:?[\(]/.test(Zc)));)Vd=Vd.prev;ki&&")"==Vd.type&&"stat"==Vd.prev.type&&(Vd=Vd.prev);Lc=Vd.type;dg=Zd==Lc;return(ji=Sa._string)&&ji.trimLeft().startsWith("?")&&":"===Zd?ji.indexOf("?"):ji&&":"===Sa.lastType&&"}"!==Vd.type?
ji.match(/^\s*/)[0].length:"vardef"==Lc?(Zc=Vd.indented+Vd.info+2+Sa.localVars.name.length,"?"===Zd||":"===Zd||"|"===Zd||"&"===Zd?Zc:","==Sa.lastType?Vd.indented+Vd.info+1:"operator"==Sa.lastType?Zc+3:Vd.indented):"form"==Lc&&"{"==Zd?Vd.indented:"form"==Lc?Vd.indented+Pe:"stat"==Lc?(Zd=Vd.indented,Sa="operator"==Sa.lastType||","==Sa.lastType||yk.test(Zc.charAt(0))||/[,.]/.test(Zc.charAt(0)),Zd+(Sa?ki||Pe:0)):"switch"!=Vd.info||dg||0==bc.doubleIndentSwitch?Vd.align?Vd.column+(dg?0:1):Vd.indented+(dg?
0:Pe):Vd.indented+(/^(?:case|default)\b/.test(Zc)?Pe:2*Pe)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:ce?null:"/*",blockCommentEnd:ce?null:"*/",lineComment:ce?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:ce?"json":"javascript",jsonldMode:Kh,jsonMode:ce,expressionAllowed:Kb.expressionAllowed,skipExpression:function(Sa){var Zc=Sa.cc[Sa.cc.length-1];Zc!=va&&Zc!=cb||Sa.cc.pop()}}});Kb.registerHelper("wordChars","javascript",/[\w$]/);Kb.defineMIME("text/javascript",
"javascript");Kb.defineMIME("text/ecmascript","javascript");Kb.defineMIME("application/javascript","javascript");Kb.defineMIME("application/x-javascript","javascript");Kb.defineMIME("application/ecmascript","javascript");Kb.defineMIME("application/json",{name:"javascript",json:!0});Kb.defineMIME("application/x-json",{name:"javascript",json:!0});Kb.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});Kb.defineMIME("text/typescript",{name:"javascript",typescript:!0});Kb.defineMIME("application/typescript",
{name:"javascript",typescript:!0});var wc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");wc.string=Jc;wc.JavaScriptChecker=Qb;wc.JavaScriptNavigator=fd;wc.completers=Va;wc.jsSnippets=Zb;wc.jsIdeCommands=$a;wc.jsEditorCommands=yb;wc.astEditorCommands=bb;wc.CodeMirrorEnabledEditorPlugin=Rc;wc.Snippet=eb;wc.parser=Xc;wc.localInterface=zc;wc.systemInterfaceNamed=Fc;wc.serverInterfaceFor=Jb;wc.l2lInterfaceFor=Ac;Qb=function(fc){var bc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),
Tb=bc.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof bc.JavaScriptEditorPlugin?bc.JavaScriptEditorPlugin:bc.JavaScriptEditorPlugin=function(I){I&&I[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return db(Tb,fc,[{key:Symbol.for("lively-instance-initialize"),value:function(){db._get(Object.getPrototypeOf(Tb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new wc.JavaScriptChecker;this.evalEnvironment=
{format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(I){db._get(Object.getPrototypeOf(Tb.prototype),"attach",this).call(this,I);this.evalEnvironment.context=I}},{key:"detach",value:function(I){this.checker.uninstall(this.textMorph);db._get(Object.getPrototypeOf(Tb.prototype),"detach",this).call(this,I)}},{key:"getNavigator",value:function(){return new wc.JavaScriptNavigator}},
{key:"getCompleters",value:function(I){return wc.completers.concat(I)}},{key:"getCommands",value:function(I){return[].concat($jscomp.arrayFromIterable(db._get(Object.getPrototypeOf(Tb.prototype),"getCommands",this).call(this,I)),$jscomp.arrayFromIterable(wc.jsIdeCommands),$jscomp.arrayFromIterable(wc.jsEditorCommands),$jscomp.arrayFromIterable(wc.astEditorCommands))}},{key:"getKeyBindings",value:function(I){return[].concat($jscomp.arrayFromIterable(I),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},
{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},
{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},{key:"getMenuItems",value:function(I){var T=this,qa,Ga,Mb,nb,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kb){qa=T.textMorph;Ga=[{command:"doit",target:qa,showKeyShortcuts:!0},{command:"inspectit",target:qa,showKeyShortcuts:!0},{command:"printit",target:qa,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:qa,showKeyShortcuts:!0},{command:"eval all",target:qa,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:qa,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:qa,showKeyShortcuts:!0},{isDivider:!0}];T.evalEnvironment.targetModule&&Ga.push({command:"[javascript] inject import",alias:"add import",target:qa},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:qa},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:qa});Mb=T.getNavigator();(nb=Mb.resolveIdentifierAt(qa,
qa.cursorPosition))&&Ga.push({command:"selectDefinition",alias:'jump to definition of "'+nb.name+'"',target:qa},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+nb.name+'"',target:qa});(Ha=qa.selection.text.trim())&&Ga.push({command:"open code search",alias:'code search for "'+wc.string.truncate(Ha,30)+'"',target:qa.world(),args:{input:Ha,backend:T.backend()}});Ga.push({isDivider:!0});return kb.return(Ga.concat(I))})}},{key:"getSnippets",value:function(){return wc.jsSnippets.map(function(I){var T=
$jscomp.makeIterator(I);I=T.next().value;T=T.next().value;return new wc.Snippet({trigger:I,expansion:T})})}},{key:"sanatizedJsEnv",value:function(I){I=Object.assign({},this.evalEnvironment,{},I);I.format||(I.formatd="esm");I.context||(I.context=this.textMorph);I.sourceURL||(I.sourceURL=I.targetModule+"_doit_"+Date.now());I.systemInterface||(I.systemInterface=wc.localInterface);return I}},{key:"backend",value:function(I){I=this.sanatizedJsEnv(I);return I.remote?I.remote:"local"}},{key:"systemInterface",
value:function(I){return this.sanatizedJsEnv(I).systemInterface||wc.localInterface}},{key:"setSystemInterface",value:function(I){return this.evalEnvironment.systemInterface=I}},{key:"setSystemInterfaceNamed",value:function(I){return this.setSystemInterface(wc.systemInterfaceNamed(I))}},{key:"runEval",value:function(I,T){T=this.sanatizedJsEnv(T);return this.systemInterface(T).runEval(I,T)}},{key:"parser",get:function(){return wc.parser}},{key:"parse",value:function(I){I=void 0===I?null:I;if(this._ast&&
this._ast._astType===I)return this._ast;var T=this.parser,qa=this.textMorph.textString;if(!T)return null;var Ga={withComments:!0,allowReturnOutsideFunction:!0};I&&(Ga.type=I);if(qa.startsWith("#!")){var Mb=qa.indexOf("\n");qa=" ".repeat(Mb)+qa.slice(Mb)}T=T.fuzzyParse(qa,Ga);T._astType=I;return this._ast=T}},{key:"undeclaredVariables",value:function(I){var T=this.parser,qa=this.evalEnvironment.knownGlobals||[];I=this.parse(void 0===I?null:I);return T&&I?T.query.findGlobalVarRefs(I,{jslintGlobalComment:!0}).filter(function(Ga){return!qa.includes(Ga.name)}):
[]}}],[{key:"className",get:function(){return"JavaScriptEditorPlugin"}}],bc,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:662,end:6664})}(wc.CodeMirrorEnabledEditorPlugin);Qb=wc.JavaScriptEditorPlugin;sa("default",Qb);wc.default=Qb}}});System.register("10",[],function(){return{execute:function(){lively.FreezerRuntime.recorderFor("lively.shell/index.js")}}});
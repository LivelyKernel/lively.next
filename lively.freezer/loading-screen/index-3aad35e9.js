System.register(["./__root_module__-b4667baa.js","kld-intersections"],function(ta){var lb,yb,Qb,Kb,yd,Cc,rd,Fc,Dc,Rc,$c,Hd,gd;return{setters:[function(Uc){lb=Uc.bu;yb=Uc.a6;Qb=Uc.r;Kb=Uc.a7;yd=Uc.bo;Cc=Uc.bv;rd=Uc.bw;Fc=Uc.U;Dc=Uc.s;Rc=Uc.bx;$c=Uc.by;Hd=Uc.n;gd=Uc.bz},function(){}],execute:function(){function Uc(I){try{var V=eval("("+ua.ast.transform.wrapInFunction("var _; _ = ("+I+")")+")()")}catch(ra){return JSON.parse(I)}return"object"!==typeof V?null:V}function Pa(I,V){var ra,ya,Gb,Pb,Ca,
Yb,jd,Kc,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){switch(Ha.nextAddress){case 1:return ra=V.world(),Ha.yield(ra.prompt("Enter package name",{requester:V,input:"",historyId:"lively.vm-editor-add-package-name",useLastInput:!0}),2);case 2:ya=Ha.yieldResult;if(!ya)throw"Canceled";Ha.setCatchFinallyBlocks(3);Pb=Ga.resource(ya);ya=Pb.name();Gb=Pb.url;Ha.leaveTryBlock(4);break;case 3:return Ha.enterCatchBlock(),Ha.yield(I.getConfig(),5);case 5:return Ca=Ha.yieldResult.baseURL,Yb=
Ga.resource(Ca).join(ya).asDirectory().url,Ha.yield(I.normalize(Yb),6);case 6:Gb=Ha.yieldResult.replace(/\/\.js$/,"/");case 4:return Ha.yield(ra.prompt("Confirm or change package location",{requester:V,input:Gb,historyId:"lively.vm-editor-add-package-address"}),7);case 7:jd=Ha.yieldResult;if(!jd)throw"Canceled";Kc=Ga.resource(jd).asDirectory();zc=Kc.asFile().url;return Ha.yield(I.removePackage(zc),8);case 8:return Ha.yield(I.resourceCreateFiles(zc,{"index.js":"'format esm';\n","package.json":'{\n  "name": "'+
ya+'",\n  "version": "0.1.0"\n}',".gitignore":"node_modules/","README.md":"# "+ya+"\n\nNo description for package "+ya+" yet.\n",tests:{"test.js":'import { expect } from "mocha-es6";\ndescribe("'+ya+'", () => {\n  it("works", () => {\n    expect(1 + 2).equals(3);\n  });\n});'}}),9);case 9:return Ha.return(Ga.loadPackage(I,{name:ya,address:zc,configFile:Kc.join("package.json").url,main:Kc.join("index.js").url,test:Kc.join("tests/test.js").url,type:"package"}))}})}function mb(I,V,ra){ra=void 0===ra?
null:ra;var ya,Gb,Pb,Ca,Yb,jd,Kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zc){switch(zc.nextAddress){case 1:return ya={name:"",address:"",type:"package"},zc.yield(I.getConfig(),2);case 2:Gb=zc.yieldResult;if(!ra){zc.jumpTo(3);break}return zc.yield(I.getPackage(ra),4);case 4:if(Pb=zc.yieldResult){zc.jumpTo(5);break}return zc.yield(I.getPackageForModule(ra),6);case 6:Pb=zc.yieldResult;case 5:Ca=Pb;case 3:return zc.yield(V.world().prompt("What is the package directory?",{requester:V,
input:Ca?Ca.address:Gb.baseURL,historyId:"lively.vm-editor-package-load-history",useLastInput:!1}),7);case 7:Yb=zc.yieldResult;if(!Yb)throw"Canceled";ya.address=Yb.replace(/\/$/,"");ya.url=new URL(ya.address+"/");ya.configFile=Ga.resource(ya.url).join("package.json").url;zc.setCatchFinallyBlocks(8);jd=JSON;Kc=jd.parse;return zc.yield(I.moduleRead(ya.configFile),10);case 10:Kc.call(jd,zc.yieldResult).name;zc.leaveTryBlock(9);break;case 8:zc.enterCatchBlock(),ya.name=String(ya.url).replace(/\/$/,""),
I.resourceEnsureExistance(ya.configFile,'{\n  "name": "'+ya.name+'",\n  "version": "0.1.0"\n}');case 9:return zc.return(Ga.loadPackage(I,ya))}})}function Nb(I,V,ra){var ya,Gb,Pb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ca){switch(Ca.nextAddress){case 1:return ya=Ga.resource(ra).asFile().url,Ca.yield(I.getPackage(ya),2);case 2:if(Gb=Ca.yieldResult){Ca.jumpTo(3);break}return Ca.yield(I.getPackageForModule(ya),4);case 4:Gb=Ca.yieldResult;case 3:Pb=Gb;if(!Pb)throw Error("Cannot find package for "+
ya);return Ca.yield(I.reloadPackage(ya),5);case 5:if(!V){Ca.jumpTo(0);break}return Ca.yield(V.updateModuleList(),7);case 7:return Ca.yield(V.uiSelect(ya,!1),8);case 8:return Ca.return(Ca.yieldResult)}})}function Ub(I,V,ra,ya){var Gb,Pb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ca){switch(Ca.nextAddress){case 1:return Ca.yield(I.getPackage(ra),2);case 2:return Gb=Ca.yieldResult,Ca.yield((ya||$world).confirm("Unload package "+Gb.name+"?",{requester:V}),3);case 3:Pb=Ca.yieldResult;
if(!Pb)throw"Canceled";return Ca.yield(I.removePackage(ra),4);case 4:if(!V){Ca.jumpTo(0);break}return Ca.yield(V.updateModuleList(),6);case 6:return Ca.yield(V.uiSelect(null),0)}})}function Ic(I,V,ra){var ya,Gb,Pb,Ca,Yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(jd){switch(jd.nextAddress){case 1:return ya=V.world(),jd.yield(I.getPackage(ra),2);case 2:return Gb=jd.yieldResult,Gb?jd.yield(ya.confirm("Really remove package "+Gb.name+"?",{requester:V}),3):($world.inform('No package "'+
ra+'" found!',{requester:V}),jd.return());case 3:Pb=jd.yieldResult;if(!Pb)throw"Canceled";I.removePackage(ra);return jd.yield(ya.confirm("Also remove directory "+Gb.name+" including "+Gb.modules.length+" modules?"),4);case 4:Ca=jd.yieldResult;if(!Ca){jd.jumpTo(0);break}return jd.yield(ya.confirm("REALLY *remove* directory "+Gb.name+"? No undo possible..."),6);case 6:if(Yb=jd.yieldResult)return jd.yield(I.resourceRemove(Gb.address),0);jd.jumpTo(0)}})}function wd(I,V,ra){ra=void 0===ra?$world:ra;var ya,
Gb,Pb,Ca,Yb,jd,Kc,zc,Ha,Ec,Wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cd){switch(cd.nextAddress){case 1:return cd.yield(I.getPackage(V),2);case 2:ya=cd.yieldResult;if(!ya)throw Error("Cannot find package "+V);Gb=[];Pb=$jscomp.makeIterator(ya.modules);Ca=Pb.next();case 3:if(Ca.done)return cd.yield(ra.execCommand("open text window",{title:"imports and exports of "+V,content:Gb.join("\n\n")}),0);Yb=Ca.value;if(!Yb.name.match(/\.js$/)){cd.jumpTo(4);break}cd.setCatchFinallyBlocks(6);
jd=I;Kc=jd.importsAndExportsOf;zc=Yb.name;return cd.yield(I.moduleRead(Yb.name),9);case 9:return cd.yield(Kc.call(jd,zc,cd.yieldResult),8);case 8:Ha=cd.yieldResult;cd.leaveTryBlock(7);break;case 6:Ec=cd.enterCatchBlock();ra.logError(Error("Error when getting imports/exports from module "+Yb.name+":\n"+Ec.stack));cd.jumpTo(4);break;case 7:Wa=""+Yb.name;if(!Ha.imports.length&&!Ha.exports.length){Wa+="\n  does not import / export anything";cd.jumpTo(4);break}Ha.imports.length&&(Wa+="\n  imports:\n",
Wa+=Ga.arr.groupByKey(Ha.imports,"fromModule").mapGroups(function(Na,bb){return"from "+Na+": "+bb.map(function(db){return db.local||db.imported?db.imported&&db.imported!==db.local?db.imported+" as "+db.local:db.local:"nothing imported"}).join(", ")}).toArray().join("\n").split("\n").map(function(Na){return"    "+Na}).join("\n"));Ha.exports.length&&(Wa+="\n  exports:\n",Wa+=Ha.exports.map(function(Na){return Na.local?Na.local&&Na.local!==Na.exported?Na.local+" as "+Na.exported:Na.exported:Na.exported+
" from "+Na.fromModule}).join(", ").split("\n").map(function(Na){return"    "+Na}).join("\n"));Gb.push(Wa);case 4:Ca=Pb.next(),cd.jumpTo(3)}})}function Eb(I,V,ra){ra=ra&&ra.address;if(ra&&0===V.indexOf(ra))var ya=V.slice(ra.length).replace(/^\//,"");else a:{ra=I.getConfig();if(!ra||ra.constructor!==Promise)try{ya=String((new URL(V)).relativePathFrom(new URL(I.getConfig().baseURL)));break a}catch(Gb){}ya=V}return ya}function Sb(I,V,ra,ya){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gb){return 1==
Gb.nextAddress?(ya=Object.assign({targetModule:V},ya),Gb.yield(I.normalize(V),2)):3!=Gb.nextAddress?(V=Gb.yieldResult,Gb.yield(I.moduleSourceChange(V,ra,ya),3)):Gb.return(V)})}function sb(I,V,ra,ya,Gb){ya=void 0===ya?!1:ya;Gb=void 0===Gb?!1:Gb;var Pb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ca){switch(Ca.nextAddress){case 1:return V&&V.setStatusMessage("Reloading "+ra),Ca.setCatchFinallyBlocks(2),Ca.yield(I.reloadModule(ra,{reloadDeps:ya,resetEnv:Gb}),4);case 4:if(!V){Ca.jumpTo(5);
break}return Ca.yield(V.updateModuleList(),6);case 6:case 5:V&&V.setStatusMessage("Reloded "+ra);Ca.leaveTryBlock(0);break;case 2:Pb=Ca.enterCatchBlock();Ca.setCatchFinallyBlocks(7);if(!V){Ca.jumpTo(9);break}return Ca.yield(V.updateEditorWithSourceOf(ra),10);case 10:case 9:Ca.leaveTryBlock(8);break;case 7:Ca.enterCatchBlock();case 8:throw V&&V.showError(Pb),Pb;}})}function ec(I,V,ra){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){switch(ya.nextAddress){case 1:return ya.yield(I.forgetModule(ra,
{forgetEnv:!0,forgetDeps:!0}),2);case 2:if(!V){ya.jumpTo(3);break}return ya.yield(V.updateModuleList(),4);case 4:case 3:ya.jumpToEnd()}})}function rc(I,V,ra){var ya,Gb,Pb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ca){switch(Ca.nextAddress){case 1:return Ca.yield(I.normalize(ra),2);case 2:return ya=Ca.yieldResult,Ca.yield(V.world().confirm("Remove file "+ya+"?",{requester:V}),3);case 3:Gb=Ca.yieldResult;if(!Gb)throw"Canceled";return Ca.yield(I.forgetModule(ya),4);case 4:return Ca.yield(I.resourceRemove(ya),
5);case 5:return Ca.yield(I.getPackageForModule(ya),6);case 6:return Pb=Ca.yieldResult,Ca.return(Pb)}})}function yc(I,V,ra){var ya,Gb,Pb,Ca,Yb,jd,Kc,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){switch(Ha.nextAddress){case 1:return ya=URL,Ha.yield(I.getConfig(),2);case 2:Gb=new ya(Ha.yieldResult.baseURL);Pb=V.world();if(!ra){Ha.jumpTo(3);break}return Ha.yield(I.getPackage(ra),4);case 4:if(Ca=Ha.yieldResult){Ha.jumpTo(5);break}return Ha.yield(I.getPackageForModule(ra),6);case 6:Ca=
Ha.yieldResult;case 5:(Yb=Ca)&&(Gb=new URL(Yb.address));case 3:return Ha.yield(cb._searchForExistingFiles(V,String(Gb),Yb),7);case 7:jd=Ha.yieldResult;if(!jd.includes("[create new module]")){Ha.jumpTo(8);break}return Ha.yield(cb._askForModuleName(I,ra||String(Gb),Pb),9);case 9:Kc=Ha.yieldResult,jd=[Kc];case 8:return Ha.yield(cb._createAndLoadModules(I,jd),10);case 10:return zc=Ha.yieldResult,cb.arr.compact(zc.map(function(Ec){return Ec.error})),Ha.return(zc)}})}function Db(I,V){var ra,ya,Gb,Pb,Ca,
Yb,jd,Kc,zc,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress)return Ec.yield(I.getPackage(V),2);if(3!=Ec.nextAddress){ra=Ec.yieldResult;if(!ra||!ra.address.match(/^http/))throw Error("Cannot load package "+V);ya=cb.resource(ra.address);Gb=[];Pb=$jscomp;Ca=Pb.makeIterator;return Ec.yield(ya.dirList(5,{exclude:cb.modulesInPackage_defaultExclude}),3)}Yb=Ca.call(Pb,Ec.yieldResult);for(jd=Yb.next();!jd.done;jd=Yb.next())zc=Kc=jd.value,Ha=zc.url,Ha.match(/\.js$/)&&
I.isModuleLoaded(Ha,!0)&&Gb.push(I.getModule(Ha));return Ec.return(Gb)})}function ab(I,V){V=void 0===V?[]:V;var ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){if(1==ya.nextAddress)return ya.yield(System.import("mocha-es6/index.js"),2);ra=ya.yieldResult;return ya.return(ra.loadTestModuleAndExtractTestState(I,V))})}function Zb(I,V,ra,ya){function Gb(Ec){return new Promise(function(Wa,cd){var Na=rb.arr.compact(Ec.suite.suites).map(function(db){return db.file}),bb=rb.chain(V).filter(function(db){return Na.includes(db.file)}).pluck("tests").flatten().value();
if(!bb||!bb.length)return cd(Error("Trying to run tests of "+Na.join(", ")+" but cannot find them in loaded tests!"));Ec.reporter(function(db){db.on("test",function(Sc){try{var Fd=bb.find(function(Pd){return Pd.fullTitle===Sc.fullTitle()});Fd.state="running";"function"===typeof ra&&ra(Fd,"test")}catch(Pd){"function"===typeof ya&&ya(Pd,"test")}});db.on("pass",function(Sc){try{var Fd=bb.find(function(Pd){return Pd.fullTitle===Sc.fullTitle()});Fd.state="succeeded";Fd.duration=Sc.duration;"function"===
typeof ra&&ra(Fd,"pass")}catch(Pd){"function"===typeof ya&&ya(Pd,"pass")}});db.on("fail",function(Sc,Fd){try{var Pd=function(Kd,Yc,ub){Kd.state="failed";Kd.duration=Kd.duration;Kd.error=Yc},ae=bb.find(function(Kd){return Kd.fullTitle===Sc.fullTitle()});if(ae)Pd(ae,Fd,Sc.duration);else{var tc=rb.arr.invoke(Sc.parent.tests,"fullTitle");bb.filter(function(Kd){return tc.includes(Kd.fullTitle)}).forEach(function(Kd){return Pd(Kd,Fd,Sc.duration)})}"function"===typeof ra&&ra(ae,"fail")}catch(Kd){"function"===
typeof ya&&ya(Kd,"fail")}})});Ec.run(function(db){return Wa({testsByFile:V,mocha:Ec})})})}var Pb,Ca,Yb,jd,Kc,zc,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){switch(Ec.nextAddress){case 1:Pb=$jscomp.makeIterator(V),Ca=Pb.next();case 2:if(Ca.done){Ec.jumpTo(4);break}jd=Yb=Ca.value;Kc=jd.file;return Ec.yield(rb.loadMochaTestFile(Kc,V),5);case 5:return zc=Ec.yieldResult,Ha=zc.mocha,I&&(Ha=Ha.grep(I)),Ec.yield(Gb(Ha),3);case 3:Ca=Pb.next();Ec.jumpTo(2);break;case 4:return Ec.return({mocha:Ha,
testsByFile:V})}})}function kc(I){I||(I="local");if(I.isSystemInterface)var V=I;else"string"===typeof I&&I.startsWith("l2l ")&&(I={type:"l2l",id:I.split(" ")[1]}),"string"!==typeof I&&"l2l"===I.type&&(V=qc.l2lInterfaceFor(I.id,I.info)),"string"!==typeof I&&($world.setStatusMessage("Unknown system interface "+I),I="local"),V||(V=I&&"local"!==I?qc.serverInterfaceFor(I):qc.localInterface);return V}ta("systemInterfaceNamed",kc);var ua=lively.FreezerRuntime.recorderFor("lively-system-interface/helpers.js");
ua.parseJsonLikeObj=Uc;ua.ast=lb;ua.parseJsonLikeObj=Uc;ua.parseJsonLikeObj=Uc;var Ga=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/packages.js");Ga.loadPackage=function(I,V){var ra,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gb){switch(Gb.nextAddress){case 1:return Gb.yield(I.importPackage(V.address+"/"),2);case 2:if(!V.main){Gb.jumpTo(3);break}return Gb.yield(I.importModule(V.main.toString()),3);case 3:if(!V.test){Gb.jumpTo(5);break}Gb.setCatchFinallyBlocks(6);
return Gb.yield(I.importPackage("mocha-es6"),8);case 8:return ra=Gb.yieldResult,Gb.yield(ra.installSystemInstantiateHook(),9);case 9:return Gb.yield(I.importModule(V.test.toString()),10);case 10:Gb.leaveTryBlock(5);break;case 6:ya=Gb.enterCatchBlock(),console.warn("Cannot load test of new package: "+ya);case 5:return Gb.return(I.getPackage(V.address))}})};Ga.interactivelyCreatePackage=Pa;Ga.interactivelyLoadPackage=mb;Ga.interactivelyReloadPackage=Nb;Ga.interactivelyUnloadPackage=Ub;Ga.interactivelyRemovePackage=
Ic;Ga.showExportsAndImportsOf=wd;Ga.parseJsonLikeObj=Uc;Ga.arr=yb;Ga.resource=Qb;Ga.interactivelyCreatePackage=Pa;Ga.interactivelyCreatePackage=Pa;Ga.interactivelyLoadPackage=mb;Ga.interactivelyLoadPackage=mb;Ga.interactivelyReloadPackage=Nb;Ga.interactivelyReloadPackage=Nb;Ga.interactivelyUnloadPackage=Ub;Ga.interactivelyUnloadPackage=Ub;Ga.interactivelyRemovePackage=Ic;Ga.interactivelyRemovePackage=Ic;Ga.showExportsAndImportsOf=wd;Ga.showExportsAndImportsOf=wd;var cb=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/modules.js");
cb.shortModuleName=Eb;cb.interactivelyChangeModule=Sb;cb.interactivelyReloadModule=sb;cb.interactivelyUnloadModule=ec;cb.interactivelyRemoveModule=rc;cb.interactivelyAddModule=yc;cb._askForModuleName=function(I,V,ra){var ya,Gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pb){switch(Pb.nextAddress){case 1:return Pb.yield(ra.prompt("Enter module name",{input:V,historyId:"lively.vm-editor-add-module-name"}),2);case 2:V=Pb.yieldResult;if(!V)throw"Canceled";return Pb.yield(I.normalize(V),
3);case 3:return ya=Pb.yieldResult,Pb.yield(ra.confirm(["Create module \n",{},ya,{fontStyle:"italic"}," ?",{}],{lineWrapping:!1}),4);case 4:Gb=Pb.yieldResult;if(!Gb)throw"Canceled";return Pb.return(ya)}})};cb._searchForExistingFiles=function(I,V,ra){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return String(V).match(/^http/)?ya.return(cb._searchForExistingFilesWeb(I,V,ra)):ya.return(cb._searchForExistingFilesManually(I,V,ra))})};cb._searchForExistingFilesManually=function(I,V,ra){var ya,
Gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pb){switch(Pb.nextAddress){case 1:return Pb.yield(I.world().multipleChoicePrompt("Add Module",{requester:I,choices:["Create New Module","Load Existing Module"]}),2);case 2:ya=Pb.yieldResult;if("Create New Module"===ya)return Pb.return("[create new module]");if("Load Existing Module"!==ya){Pb.jumpTo(3);break}return Pb.yield(I.world().prompt("URL of module?",{input:V,requester:I,historyId:"lively.vm._searchForExistingFilesManually.url-of-module"}),
4);case 4:if(Gb=Pb.yieldResult)return Pb.return([Gb]);case 3:throw"Canceled";}})};cb._searchForExistingFilesWeb=function(I,V,ra){function ya(zc){zc.name();return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes(zc.name())||ra&&cb.arr.pluck(ra.modules,"name").includes(zc.url)?!0:!1}var Gb,Pb,Ca,Yb,jd,Kc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zc){switch(zc.nextAddress){case 1:return(Gb=I.world())&&(Pb=Gb.showLoadingIndicatorFor(I,"Loading existing modules...")),
zc.yield(cb.resource(V).dirList(5,{exclude:ya}),3);case 3:return zc.yield(zc.yieldResult.map(function(Ha){return Ha.url}),2);case 2:return Ca=zc.yieldResult,Yb=[{isListItem:!0,string:"[create new module]",value:"[create new module]"}].concat(Ca.filter(function(Ha){return Ha.endsWith(".js")}).map(function(Ha){return{isListItem:!0,string:ra&&0==Ha.indexOf(ra.address)?ra.name+Ha.slice(ra.address.length):Ha,value:Ha}})),zc.yield(Promise.resolve(Pb&&Pb.remove()).then(function(){return I.world().filterableListPrompt("What module to load?",
Yb,Object.assign({filterLabel:"filter: ",multiselect:!0,requester:I},I?{extent:I.bounds().extent().withY(400).subXY(50,0)}:{}))}),4);case 4:jd=zc.yieldResult;if(!jd||"canceled"===jd.status||!jd.selected.length)throw"Canceled";Kc=jd.selected||jd;Array.isArray(Kc)||(Kc=[Kc]);return zc.return(Kc)}})};cb._createAndLoadModules=function(I,V){var ra,ya,Gb,Pb,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yb){switch(Yb.nextAddress){case 1:Array.isArray(V)||(V=[V]),ra=[],ya=$jscomp.makeIterator(V),
Gb=ya.next();case 2:if(Gb.done){Yb.jumpTo(4);break}Pb=Gb.value;return Yb.yield(I.forgetModule(Pb,{forgetDeps:!1,forgetEnv:!1}),5);case 5:return Yb.yield(I.resourceEnsureExistance(Pb,'"format esm";\n'),6);case 6:return Yb.setCatchFinallyBlocks(7),Yb.yield(I.importModule(Pb),9);case 9:ra.push({name:Pb});Yb.leaveTryBlock(3);break;case 7:Ca=Yb.enterCatchBlock(),ra.push({name:Pb,error:Ca});case 3:Gb=ya.next();Yb.jumpTo(2);break;case 4:return Yb.return(ra)}})};cb.modulesInPackage_defaultExclude=function(I){return[".git",
"node_modules",".optimized-loading-cache",".module_cache"].includes(I.name())?!0:!1};cb.modulesInPackage=Db;cb.obj=Kb;cb.arr=yb;cb.resource=Qb;cb.shortModuleName=Eb;cb.shortModuleName=Eb;cb.interactivelyChangeModule=Sb;cb.interactivelyChangeModule=Sb;cb.interactivelyReloadModule=sb;cb.interactivelyReloadModule=sb;cb.interactivelyUnloadModule=ec;cb.interactivelyUnloadModule=ec;cb.interactivelyRemoveModule=rc;cb.interactivelyRemoveModule=rc;cb.interactivelyAddModule=yc;cb.interactivelyAddModule=yc;
cb.modulesInPackage=Db;cb.modulesInPackage=Db;var rb=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/mocha-tests.js");rb.loadMochaTestFile=ab;rb.runMochaTests=Zb;rb.arr=yb;rb.chain=yd;rb.loadMochaTestFile=ab;rb.loadMochaTestFile=ab;rb.runMochaTests=Zb;rb.runMochaTests=Zb;var pb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/interface.js");pb.todo=function(I){throw Error(I+" is not yet implemented!");};pb.parseJsonLikeObj=Uc;pb.arr=yb;pb.Closure=Cc;pb.obj=
Kb;pb.resource=Qb;pb.transform=rd;pb.modules=Fc;var Ta=function(){};Ta.prototype.dynamicCompletionsForPrefix=function(I,V,ra){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){pb.todo("dynamicCompletionsForPrefix");ya.jumpToEnd()})};Ta.prototype.runEval=function(I,V){pb.todo("runEval")};Ta.prototype.resourceExists=function(I){pb.todo("resourceExists")};Ta.prototype.resourceEnsureExistance=function(I,V){pb.todo("resourceEnsureExistance")};Ta.prototype.resourceMkdir=function(I){pb.todo("resourceMkdir")};
Ta.prototype.resourceRead=function(I){pb.todo("resourceRead")};Ta.prototype.resourceRemove=function(I){pb.todo("resourceRemove")};Ta.prototype.resourceWrite=function(I,V){pb.todo("resourceWrite")};Ta.prototype.resourceCreateFiles=function(I,V){pb.todo("resourceCreateFiles")};Ta.prototype.resourceDirList=function(I,V,ra){pb.todo("resourceDirList")};Ta.prototype.normalizeSync=function(I,V,ra){pb.todo("normalizeSync")};Ta.prototype.normalize=function(I,V,ra){pb.todo("normalize")};Ta.prototype.printSystemConfig=
function(){pb.todo("printSystemConfig")};Ta.prototype.getConfig=function(){pb.todo("getConfig")};Ta.prototype.setConfig=function(I){pb.todo("setConfig")};Ta.prototype.getPackages=function(I){pb.todo("getPackages")};Ta.prototype.isModuleLoaded=function(I,V){pb.todo("isModuleLoaded")};Ta.prototype.doesModuleExist=function(I,V){pb.todo("doesModuleExist")};Ta.prototype.getModules=function(){var I=this,V,ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return 1==ya.nextAddress?(V=pb.arr,
ra=V.flatmap,ya.yield(I.getPackages(),2)):ya.return(ra.call(V,ya.yieldResult,function(Gb){return Gb.modules}))})};Ta.prototype.getModule=function(I){var V=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return 1==ra.nextAddress?ra.yield(V.getModules(),2):ra.return(ra.yieldResult.find(function(ya){return ya.name===I}))})};Ta.prototype.getPackage=function(I){var V=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return 1==ra.nextAddress?(I=I.replace(/\/+$/,""),
ra.yield(V.getPackages(),2)):ra.return(ra.yieldResult.find(function(ya){return ya.address===I||ya.name===I}))})};Ta.prototype.getPackageForModule=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){pb.todo("getPackageForModule");V.jumpToEnd()})};Ta.prototype.systemConfChange=function(I){var V=pb.parseJsonLikeObj(I);["baseURL"].forEach(function(ra){return delete V[ra]});return this.setConfig(V)};Ta.prototype.resourcesOfPackage=function(I,V){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){pb.todo("resourcesOfPackage");
ra.jumpToEnd()})};Ta.prototype.registerPackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){pb.todo("registerPackage");V.jumpToEnd()})};Ta.prototype.importPackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){pb.todo("importPackage");V.jumpToEnd()})};Ta.prototype.removePackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){pb.todo("removePackage");V.jumpToEnd()})};Ta.prototype.reloadPackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){pb.todo("reloadPackage");
V.jumpToEnd()})};Ta.prototype.packageConfChange=function(I,V){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){pb.todo("packageConfChange");ra.jumpToEnd()})};Ta.prototype.importModule=function(I){pb.todo("importModule")};Ta.prototype.forgetModule=function(I,V){pb.todo("forgetModule")};Ta.prototype.reloadModule=function(I,V){pb.todo("reloadModule")};Ta.prototype.moduleFormat=function(I){pb.todo("moduleFormat")};Ta.prototype.moduleRead=function(I){pb.todo("moduleRead")};Ta.prototype.moduleSourceChange=
function(I,V,ra){pb.todo("moduleSourceChange")};Ta.prototype.importsAndExportsOf=function(I,V){pb.todo("importsAndExportsOf")};Ta.prototype.keyValueListOfVariablesInModule=function(I,V){pb.todo("keyValueListOfVariablesInModule")};Ta.prototype.moduleWrite=function(I,V){return this.moduleSourceChange(I,V)};pb.AbstractCoreInterface=Ta;var Ua=function(){var I=pb.AbstractCoreInterface.call(this)||this;I.currentEval=null;return I};$jscomp.inherits(Ua,pb.AbstractCoreInterface);Ua.prototype.runEval=function(I,
V){throw Error("Not yet implemented");};Ua.prototype.runEvalAndStringify=function(I,V){var ra=this;return this.currentEval?this.currentEval.then(function(){return ra.runEvalAndStringify(I,V)}):this.currentEval=Promise.resolve().then(function(){var ya,Gb,Pb,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yb){switch(Yb.nextAddress){case 1:return Yb.yield(ra.runEval("\n        Promise.resolve((async "+pb.transform.wrapInFunction(I)+')())\n          .then(function(result) { return JSON.stringify(result); })\n          .catch(function(err) { return {isError: true, value: err}; })\n          .then(function(result) {\n            if (!result || typeof result === "string") return result;\n            return JSON.stringify(result.isError ?\n              {isError: true, value: (result.value + "\\n" + result.value.stack) || String(result.value)} :\n              result)\n          });',
Object.assign({targetModule:"lively://remote-lively-system/runEvalAndStringify",promiseTimeout:3E4,waitForPromise:!0},V)),2);case 2:if((ya=Yb.yieldResult)&&ya.isError)throw Error(String(ya.value||ya.error));if(!ya||!ya.value)return Yb.return(null);if(Gb=ya.promisedValue){Yb.jumpTo(3);break}return Yb.yield(ya.value,4);case 4:Gb=Yb.yieldResult;case 3:Pb=Gb;if(!Pb)return Yb.return();if("undefined"===Pb)return Yb.return(void 0);if("null"===Pb)return Yb.return(null);if("true"===Pb)return Yb.return(!0);
if("false"===Pb)return Yb.return(!1);try{Ca=JSON.parse(Pb)}catch(jd){return Yb.return(Pb)}if(Ca&&Ca.isError)throw Error(String(Ca.value));return Yb.return(Ca)}})}).then(function(ya){delete ra.currentEval;return ya},function(ya){delete ra.currentEval;return Promise.reject(ya)})};Ua.prototype.dynamicCompletionsForPrefix=function(I,V,ra){var ya=this,Gb,Pb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ca){Gb=pb.obj.isString(ra.context)?ra.context:!1;ra=pb.obj.dissoc(ra,["systemInterface",
"System","context"]);Pb="\n      var prefix = "+JSON.stringify(V)+",\n          opts = "+JSON.stringify(ra)+";\n      opts.context = "+Gb+';\n      opts.classTransform = (await System.import("lively.classes")).classToFunctionTransform;\n      var evalFn = code => lively.vm.runEval(code, opts);\n      if (typeof System === "undefined") delete opts.targetModule;\n      lively.vm.completions.getCompletions(evalFn, prefix).then(function(result) {\n        if (result.isError) throw result.value;\n        return {\n          completions: result.completions,\n          prefix: result.startLetters\n        }\n      });';
return Ca.return(ya.runEvalAndStringify(Pb))})};Ua.prototype.evalWithResource=function(I,V,ra){return this.runEvalAndStringify('\n      var {resource} = (typeof lively !== "undefined" && lively.resources)\n                    || await System.import("lively.resources");\n      await resource("'+I+'").'+V+"("+(ra?JSON.stringify(ra):"")+");\n    ")};Ua.prototype.resourceExists=function(I){return this.evalWithResource(I,"exists")};Ua.prototype.resourceEnsureExistance=function(I,V){return this.evalWithResource(I,
"ensureExistance",V)};Ua.prototype.resourceMkdir=function(I){return this.evalWithResource(I,"mkdir")};Ua.prototype.resourceRead=function(I){return this.evalWithResource(I,"read")};Ua.prototype.resourceRemove=function(I){return this.evalWithResource(I,"remove")};Ua.prototype.resourceWrite=function(I,V){return this.evalWithResource(I,"write",V)};Ua.prototype.resourceCreateFiles=function(I,V){return this.runEvalAndStringify('var {createFiles} = await System.import("lively.resources"); await createFiles("'+
I+'", '+JSON.stringify(V)+")")};Ua.prototype.resourceDirList=function(I,V,ra){return this.runEvalAndStringify('\n      var {resource} = await System.import("lively.resources");\n      (await resource("'+I+'").dirList('+JSON.stringify(V)+", "+JSON.stringify(ra)+"))\n        .map(({url}) => ({url}))")};Ua.prototype.livelySystemAccessor=function(I){I=void 0===I?"livelySystem":I;return"var "+I+' = (typeof lively !== "undefined" && lively.systemInterface)\n      || System.get(System.decanonicalize("lively-system-interface"))\n      || (typeof lively !== "undefined" && lively.modules && await lively.modules.importPackage("lively-system-interface"));\n    if (!'+
I+') throw new Error("lively-system-interface not available!");'};Ua.prototype.normalizeSync=function(I,V,ra){return this.runEvalAndStringify("lively.modules.System.decanonicalize("+JSON.stringify(I)+", "+JSON.stringify(V)+", "+ra+")")};Ua.prototype.normalize=function(I,V,ra){return this.runEvalAndStringify("lively.modules.System.normalize("+JSON.stringify(I)+", "+JSON.stringify(V)+", "+JSON.stringify(ra)+")")};Ua.prototype.printSystemConfig=function(){return this.runEvalAndStringify("lively.modules.printSystemConfig()")};
Ua.prototype.getConfig=function(){return this.runEvalAndStringify('var c = Object.assign({}, lively.modules.System.getConfig()); for (var name in c) if (name.indexOf("__lively.modules__") === 0 || name.indexOf("loads") === 0) delete c[name]; c')};Ua.prototype.setConfig=function(I){return this.runEvalAndStringify("lively.modules.System.config("+JSON.stringify(I)+")")};Ua.prototype.getPackages=function(I){I=Object.assign({excluded:[]},I);I.excluded=I.excluded.map(String);return this.runEvalAndStringify("\n      "+
this.livelySystemAccessor()+";\n      var options = "+JSON.stringify(I)+';\n      options.excluded = options.excluded.map(ea => {\n        let evaled = lively.vm.syncEval(ea).value;\n        return typeof evaled === "function" ? evaled : ea;\n      });\n      await livelySystem.localInterface.getPackages(options)\n        .map(ea => Object.assign({}, ea, {System: null}));')};Ua.prototype.getPackageForModule=function(I){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.getPackageForModule("+
JSON.stringify(I)+")")};Ua.prototype.isModuleLoaded=function(I,V){return this.runEvalAndStringify('lively.modules.isModuleLoaded("'+I+'", '+V+")")};Ua.prototype.doesModuleExist=function(I,V){return this.runEvalAndStringify('lively.modules.doesModuleExist("'+I+'", '+V+")")};Ua.prototype.registerPackage=function(I){var V=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return ra.return(V.runEvalAndStringify("lively.modules.registerPackage("+JSON.stringify(I)+")"))})};Ua.prototype.importPackage=
function(I){var V=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return ra.return(V.runEvalAndStringify("lively.modules.importPackage("+JSON.stringify(I)+")"))})};Ua.prototype.removePackage=function(I){var V=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return ra.return(V.runEvalAndStringify("lively.modules.removePackage("+JSON.stringify(I)+")"))})};Ua.prototype.reloadPackage=function(I,V){var ra=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return ya.return(ra.runEvalAndStringify("lively.modules.reloadPackage("+
JSON.stringify(I)+", "+JSON.stringify(V)+")"))})};Ua.prototype.packageConfChange=function(I,V){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.packageConfChange("+JSON.stringify(I)+", "+JSON.stringify(V)+")")};Ua.prototype.resourcesOfPackage=function(I,V){V=void 0===V?[".git","node_modules",".module_cache","lively.next-node_modules"]:V;var ra=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){I.address&&(I=I.address);
return ya.return(ra.runEvalAndStringify("\n      "+ra.livelySystemAccessor()+";\n      await livelySystem.localInterface.resourcesOfPackage("+JSON.stringify(I)+", "+JSON.stringify(V)+");"))})};Ua.prototype.getModule=function(I){var V=this,ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){if(1==ya.nextAddress)return ya.yield(V.getModules(),2);ra=ya.yieldResult.find(function(Gb){return Gb.name===I});return ya.return(ra?pb.modules.module(ra.name):null)})};Ua.prototype.importModule=function(I){return this.runEvalAndStringify("lively.modules.System.import("+
JSON.stringify(I)+")")};Ua.prototype.forgetModule=function(I,V){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(I)+").unload("+JSON.stringify(V)+")")};Ua.prototype.reloadModule=function(I,V){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(I)+").reload("+JSON.stringify(V)+")")};Ua.prototype.moduleFormat=function(I){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(I)+").format();")};Ua.prototype.moduleRead=function(I){return this.runEvalAndStringify("lively.modules.module("+
JSON.stringify(I)+").source()")};Ua.prototype.moduleSourceChange=function(I,V,ra){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(I)+").changeSource("+JSON.stringify(V)+", "+JSON.stringify(ra)+")")};Ua.prototype.keyValueListOfVariablesInModule=function(I,V){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.keyValueListOfVariablesInModule("+JSON.stringify(I)+", "+JSON.stringify(V)+")")};Ua.prototype.importsAndExportsOf=
function(I,V){return this.runEvalAndStringify("({\n      imports: await lively.modules.module("+JSON.stringify(I)+").imports(),\n      exports: await lively.modules.module("+JSON.stringify(I)+").exports()})")};Ua.prototype.exportsOfModules=function(I){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+"\n      const options = "+JSON.stringify(I)+";\n      options.excludedPackages = ["+I.excludedPackages.map(function(V){return"function"===typeof V?V.toString():JSON.stringify(V)}).join(",")+
"]\n      await livelySystem.localInterface.exportsOfModules(options)")};Ua.prototype.searchInPackage=function(I,V,ra){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.searchInPackage("+JSON.stringify(I)+", "+JSON.stringify(V)+", "+JSON.stringify(ra)+")")};Ua.prototype.loadMochaTestFile=function(I,V){V=void 0===V?[]:V;var ra=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return ya.return(ra.runEvalAndStringify("\n      "+
ra.livelySystemAccessor()+";\n      var {testsByFile} = await livelySystem.localInterface.loadMochaTestFile("+JSON.stringify(I)+", "+JSON.stringify(V)+"), result;\n      result = {testsByFile}"))})};Ua.prototype.runMochaTests=function(I,V,ra,ya){var Gb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pb){I&&I instanceof RegExp&&(I={isRegExp:!0,value:String(I).replace(/^\/|\/$/g,"")});return Pb.return(Gb.runEvalAndStringify("\n      var grep = "+JSON.stringify(I)+";\n      if (grep && grep.isRegExp) grep = new RegExp(grep.value);\n      "+
Gb.livelySystemAccessor()+";\n      var {testsByFile, isError, value: error} = await livelySystem.localInterface.runMochaTests(grep, "+JSON.stringify(V||[])+"), result;\n      error = error ? String(error.stack || error) : null;\n      if (testsByFile) {\n        testsByFile.forEach(ea =>\n          ea.tests.forEach(ea => {\n            if (!ea.error) return;\n            var {message, stack, actual, expected} = ea.error;\n            ea.error = {\n              message: message || String(ea.error),\n              stack: stack,\n              actual, exected\n            }\n          }));\n      }\n      result = {testsByFile, isError, error}"))})};
pb.RemoteCoreInterface=Ua;var ob=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/local-system.js");ob.obj=Kb;ob.string=Dc;ob.arr=yb;ob.resource=Qb;ob.createFiles=Rc;ob.ast=lb;ob.modules=Fc;ob.vm=$c;ob.loadMochaTestFile=ab;ob.runMochaTests=Zb;ob.parseJsonLikeObj=Uc;ob.AbstractCoreInterface=Ta;ob.classToFunctionTransform=Hd;Ta=function(){return ob.AbstractCoreInterface.apply(this,arguments)||this};$jscomp.inherits(Ta,ob.AbstractCoreInterface);Ta.prototype.dynamicCompletionsForPrefix=
function(I,V,ra){var ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gb){if(1==Gb.nextAddress)return Gb.yield(ob.vm.completions.getCompletions(function(Pb){return ob.vm.runEval(Pb.replace("return ",""),Object.assign({targetModule:I,classTransform:ob.classToFunctionTransform},ra))},V),2);ya=Gb.yieldResult;if(ya.isError)throw ya.value;return Gb.return({completions:ya.completions,prefix:ya.startLetters})})};Ta.prototype.runEval=function(I,V){return ob.vm.runEval(I,Object.assign({classTransform:ob.classToFunctionTransform},
V))};Ta.prototype.resourceExists=function(I){return ob.resource(I).exists()};Ta.prototype.resourceEnsureExistance=function(I,V){return ob.resource(I).ensureExistance(V)};Ta.prototype.resourceMkdir=function(I){return ob.resource(I).mkdir()};Ta.prototype.resourceRead=function(I){return ob.resource(I).read()};Ta.prototype.resourceRemove=function(I){return ob.resource(I).remove()};Ta.prototype.resourceWrite=function(I,V){return ob.resource(I).write(V)};Ta.prototype.resourceCreateFiles=function(I,V){return ob.createFiles(I,
V)};Ta.prototype.resourceDirList=function(I,V,ra){return ob.resource(I).dirList(V,ra)};Ta.prototype.normalizeSync=function(I,V,ra){return System.decanonicalize(I,V,ra)};Ta.prototype.normalize=function(I,V,ra){return System.normalize(I,V,ra)};Ta.prototype.printSystemConfig=function(){return ob.modules.printSystemConfig()};Ta.prototype.getConfig=function(){return System.getConfig()};Ta.prototype.setConfig=function(I){ob.modules.System.config(I)};Ta.prototype.getPackages=function(I){I=Object.assign({},
I);I=void 0===I.excluded?[]:I.excluded;var V=I.filter(function(ya){return"string"===typeof ya}),ra=I.filter(function(ya){return"function"===typeof ya});V=V.concat(V.map(function(ya){return System.decanonicalize(ya.replace(/\/?$/,"/")).replace(/\/$/,"")}));return ob.modules.getPackages().filter(function(ya){return!V.includes(ya.url)&&!ra.some(function(Gb){return Gb(ya.url)})})};Ta.prototype.registerPackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){return V.return(ob.modules.registerPackage(I))})};
Ta.prototype.importPackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){return V.return(ob.modules.importPackage(I))})};Ta.prototype.removePackage=function(I){return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){return V.return(ob.modules.removePackage(I))})};Ta.prototype.reloadPackage=function(I,V){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){return ra.return(ob.modules.reloadPackage(I,V))})};Ta.prototype.packageConfChange=function(I,V){var ra=
this,ya,Gb,Pb,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yb){if(1==Yb.nextAddress)return ya=ob.modules.System,Gb=ob.parseJsonLikeObj(I),Pb=JSON.stringify(Gb,null,2),Yb.yield(ob.modules.module(V).changeSource(Pb,{doEval:!1}),2);if(3!=Yb.nextAddress)return ya.set(V,ya.newModule(Gb)),Yb.yield(ra.getPackageForModule(V),3);(Ca=Yb.yieldResult)&&ob.modules.applyPackageConfig(Gb,Ca.address);Yb.jumpToEnd()})};Ta.prototype.resourcesOfPackage=function(I,V){V=void 0===V?[".git","node_modules",
".module_cache"]:V;var ra,ya,Gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pb){if(1==Pb.nextAddress)return Pb.setCatchFinallyBlocks(2),ra=I.address?I.address:I,ya=ob.modules.getPackage(ra),Pb.yield(ya.resources(void 0,V),4);if(2!=Pb.nextAddress)return Pb.return(Pb.yieldResult.map(function(Ca){return Object.assign(Ca,{package:Ca.package.url})}));Gb=Pb.enterCatchBlock();console.warn("resourcesOfPackage error for "+I+": "+Gb);return Pb.return([])})};Ta.prototype.getPackageForModule=
function(I){return(I=ob.modules.getPackageOfModule(I))?I.asSpec():I};Ta.prototype.isModuleLoaded=function(I,V){return ob.modules.isModuleLoaded(I,V)};Ta.prototype.doesModuleExist=function(I,V){return ob.modules.isModuleLoaded(I,V)};Ta.prototype.getModule=function(I){return ob.modules.module(I)};Ta.prototype.importModule=function(I){return ob.modules.System.import(I)};Ta.prototype.forgetModule=function(I,V){return ob.modules.module(I).unload(V)};Ta.prototype.reloadModule=function(I,V){return ob.modules.module(I).reload(V)};
Ta.prototype.moduleFormat=function(I){return ob.modules.module(I).format()};Ta.prototype.moduleRead=function(I){return ob.modules.module(I).source()};Ta.prototype.moduleSourceChange=function(I,V,ra){return ob.modules.module(I).changeSource(V,ra)};Ta.prototype.keyValueListOfVariablesInModule=function(I,V){var ra=this,ya,Gb,Pb,Ca,Yb,jd,Kc,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){switch(Ha.nextAddress){case 1:if(V){Ha.jumpTo(2);break}return Ha.yield(ra.resourceRead(I),3);case 3:V=
Ha.yieldResult;case 2:return ya="string"===typeof V?ob.ast.parse(V):V,Gb=ra.normalizeSync(I),ra.moduleFormat(Gb),Pb=ob.modules.module(Gb).env().recorder,Ha.yield(ra.importsAndExportsOf(Gb,ya),4);case 4:return Ca=Ha.yieldResult,Yb=ob.ast.query.topLevelDeclsAndRefs(ya),jd=ob.arr.sortByKey(ob.ast.query.declarationsOfScope(Yb.scope,!0),"start"),Kc=ob.arr.pluck(Yb.scope.importSpecifiers,"name"),zc=0,Ha.return(jd.map(function(Ec){var Wa=Ec.name.length,cd=Ca.exports.find(function(bb){return bb.local===Ec.name}),
Na=ob.arr.include(Kc,Ec.name);cd&&(Wa+=9);Na&&(Wa+=9);zc=Math.max(zc,Wa);return{isExport:cd,isImport:Na,name:Ec.name,value:Pb[Ec.name],node:Ec,printedName:Ec.name+(cd?" [export]":"")+(Na?" [import]":""),printedValue:ob.obj.inspect(Pb[Ec.name],{maxDepth:1}).replace(/\n/g,"")}}).map(function(Ec){return{isListItem:!0,value:Ec,string:Ec.printedName+ob.string.indent(" = "+Ec.printedValue," ",zc-Ec.printedName.length)}}))}})};Ta.prototype.importsAndExportsOf=function(I,V){var ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return 1==
ya.nextAddress?ya.yield(ob.modules.module(I).imports(V),2):3!=ya.nextAddress?(ra=ya.yieldResult,ya.yield(ob.modules.module(I).exports(V),3)):ya.return({imports:ra,exports:ya.yieldResult})})};Ta.prototype.exportsOfModules=function(I){return ob.modules.ExportLookup.run(System,I)};Ta.prototype.searchInPackage=function(I,V,ra){return ob.modules.getPackage(I).search(V,ra)};Ta.prototype.runMochaTests=function(I,V,ra,ya){return ob.runMochaTests(I,V,ra,ya)};Ta.prototype.loadMochaTestFile=function(I,V){return ob.loadMochaTestFile(I,
V)};$jscomp.global.Object.defineProperties(Ta.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"local"}}});ob.LocalCoreInterface=Ta;var Wb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/http-interface.js");Wb.evalStrategies=gd;Wb.RemoteCoreInterface=Ua;var lc=function(I){var V=Wb.RemoteCoreInterface.call(this)||this;V.currentEval=null;V.url=I;V.server=new Wb.evalStrategies.HttpEvalStrategy(I);return V};$jscomp.inherits(lc,Wb.RemoteCoreInterface);lc.prototype.runEval=
function(I,V){return this.server.runEval(I,V)};$jscomp.global.Object.defineProperties(lc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this.url}},description:{configurable:!0,enumerable:!0,get:function(){return this.url.replace(/^https?:\/\//,"")}}});Wb.HTTPCoreInterface=lc;var Lb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/l2l-interface.js");Lb.evalStrategies=gd;Lb.RemoteCoreInterface=Ua;Ua=function(I,V){var ra=Lb.RemoteCoreInterface.call(this)||this;
ra.targetId=I;ra.peer=V;return ra};$jscomp.inherits(Ua,Lb.RemoteCoreInterface);Ua.prototype.isConnected=function(){var I=this,V,ra,ya,Gb,Pb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ca){if(1==Ca.nextAddress)return V=I,ra=V.client,ya=V.targetId,Ca.yield(ra.sendToAndWait(ra.trackerId,"getClients",{}),2);Gb=Ca.yieldResult;Pb=Gb.data;return Ca.return(Pb.some(function(Yb){Yb=$jscomp.makeIterator(Yb).next().value;return ya===Yb}))})};Ua.prototype.runEval=function(I,V){var ra=this,ya,Gb;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pb){ya=ra.client;if(!ya)throw Error("No lively.2lively default client available!");Gb=new Lb.evalStrategies.L2LEvalStrategy(ya,ra.targetId);return Pb.return(Gb.runEval(I,V))})};$jscomp.global.Object.defineProperties(Ua.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"l2l "+this.targetId}},description:{configurable:!0,enumerable:!0,get:function(){var I=this.peer,V="l2l "+this.targetId.slice(0,5);if(I){var ra=I.location,
ya=I.type,Gb=I.user;I=I.world;ya&&(V+=", "+ya);ra&&(V+=", "+ra.replace(/^https?:\/\//,"")+(I?"/"+I:""));Gb&&(V+=", "+Gb.name)}return V}},client:{configurable:!0,enumerable:!0,get:function(){return(lively.modules.module("lively.2lively/client.js").get()||{default:lively.l2l.L2LClient}).default.default()}}});Lb.L2LCoreInterface=Ua;var qc=lively.FreezerRuntime.recorderFor("lively-system-interface/index.js");qc.systemInterfaceNamed=kc;qc.interactivelyCreatePackage=Pa;qc.interactivelyLoadPackage=mb;qc.interactivelyReloadPackage=
Nb;qc.interactivelyUnloadPackage=Ub;qc.interactivelyRemovePackage=Ic;qc.showExportsAndImportsOf=wd;qc.shortModuleName=Eb;qc.interactivelyChangeModule=Sb;qc.interactivelyReloadModule=sb;qc.interactivelyUnloadModule=ec;qc.interactivelyRemoveModule=rc;qc.interactivelyAddModule=yc;qc.modulesInPackage=Db;qc.LocalCoreInterface=Ta;qc.HTTPCoreInterface=lc;qc.L2LCoreInterface=Ua;Ua=function(I){this.coreInterface=I};Ua.prototype.dynamicCompletionsForPrefix=function(I,V,ra){return this.coreInterface.dynamicCompletionsForPrefix(I,
V,ra)};Ua.prototype.runEval=function(I,V){return this.coreInterface.runEval(I,V)};Ua.prototype.printSystemConfig=function(I,V,ra){return this.coreInterface.printSystemConfig(I,V,ra)};Ua.prototype.getConfig=function(I,V,ra){return this.coreInterface.getConfig(I,V,ra)};Ua.prototype.getPackages=function(I){return this.coreInterface.getPackages(I)};Ua.prototype.getModules=function(I,V,ra){return this.coreInterface.getModules(I,V,ra)};Ua.prototype.getModule=function(I,V,ra){return this.coreInterface.getModule(I,
V,ra)};Ua.prototype.getPackage=function(I,V,ra){return this.coreInterface.getPackage(I,V,ra)};Ua.prototype.getPackageForModule=function(I,V,ra){return this.coreInterface.getPackageForModule(I,V,ra)};Ua.prototype.resourcesOfPackage=function(I,V){return this.coreInterface.resourcesOfPackage(I,V)};Ua.prototype.systemConfChange=function(I,V,ra){return this.coreInterface.systemConfChange(I,V,ra)};Ua.prototype.registerPackage=function(I){return this.coreInterface.registerPackage(I)};Ua.prototype.importPackage=
function(I){return this.coreInterface.importPackage(I)};Ua.prototype.removePackage=function(I){return this.coreInterface.removePackage(I)};Ua.prototype.reloadPackage=function(I){return this.coreInterface.reloadPackage(I)};Ua.prototype.packageConfChange=function(I,V){return this.coreInterface.packageConfChange(I,V)};Ua.prototype.keyValueListOfVariablesInModule=function(I,V){return this.coreInterface.keyValueListOfVariablesInModule(I,V)};Ua.prototype.interactivelyCreatePackage=function(I){return qc.interactivelyCreatePackage(this.coreInterface,
I)};Ua.prototype.interactivelyLoadPackage=function(I,V){return qc.interactivelyLoadPackage(this.coreInterface,I,V)};Ua.prototype.interactivelyReloadPackage=function(I,V){return qc.interactivelyReloadPackage(this.coreInterface,I,V)};Ua.prototype.interactivelyUnloadPackage=function(I,V,ra){return qc.interactivelyUnloadPackage(this.coreInterface,I,V,ra)};Ua.prototype.interactivelyRemovePackage=function(I,V){return qc.interactivelyRemovePackage(this.coreInterface,I,V)};Ua.prototype.isModuleLoaded=function(I,
V){return this.coreInterface.isModuleLoaded(I,V)};Ua.prototype.doesModuleExist=function(I,V){return this.coreInterface.doesModuleExist(I,V)};Ua.prototype.importModule=function(I){return this.coreInterface.importModule(I)};Ua.prototype.forgetModule=function(I,V){return this.coreInterface.forgetModule(I,V)};Ua.prototype.reloadModule=function(I,V){return this.coreInterface.reloadModule(I,V)};Ua.prototype.moduleFormat=function(I){return this.coreInterface.moduleFormat(I)};Ua.prototype.moduleRead=function(I){return this.coreInterface.moduleRead(I)};
Ua.prototype.moduleWrite=function(I,V){return this.coreInterface.moduleWrite(I,V)};Ua.prototype.getModulesInPackage=function(I){return qc.modulesInPackage(this.coreInterface,I)};Ua.prototype.shortModuleName=function(I,V){return qc.shortModuleName(this.coreInterface,I,V)};Ua.prototype.interactivelyChangeModule=function(I,V,ra){return qc.interactivelyChangeModule(this.coreInterface,I,V,ra)};Ua.prototype.interactivelyReloadModule=function(I,V){return qc.interactivelyReloadModule(this.coreInterface,I,
V)};Ua.prototype.interactivelyUnloadModule=function(I,V){return qc.interactivelyUnloadModule(this.coreInterface,I,V)};Ua.prototype.interactivelyRemoveModule=function(I,V){return qc.interactivelyRemoveModule(this.coreInterface,I,V)};Ua.prototype.interactivelyAddModule=function(I,V){return qc.interactivelyAddModule(this.coreInterface,I,V)};Ua.prototype.showExportsAndImportsOf=function(I,V){return qc.showExportsAndImportsOf(this.coreInterface,I,V)};Ua.prototype.exportsOfModules=function(I){return this.coreInterface.exportsOfModules(I)};
Ua.prototype.searchInPackage=function(I,V,ra){return this.coreInterface.searchInPackage(I,V,ra)};Ua.prototype.searchInAllPackages=function(I,V){V=void 0===V?{}:V;var ra=this,ya,Gb,Pb,Ca,Yb,jd,Kc,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){switch(Ha.nextAddress){case 1:return(ya=V.progress)&&ya.step("Fetching Packages...",0),Ha.yield(ra.coreInterface.getPackages({excluded:V.excludedPackages}),2);case 2:Gb=Ha.yieldResult,Pb=[],ya&&ya.step("Fetching Packages...",.1),Ca=0;case 3:if(!(Ca<
Gb.length)){Ha.jumpTo(5);break}Yb=Gb[Ca];jd=Yb.url;if(!jd||"no group"===jd){Ha.jumpTo(4);break}ya&&ya.step(jd.replace(System.baseURL,"").slice(0,20),.1+Ca/Gb.length*.9);Ha.setCatchFinallyBlocks(6);return Ha.yield(ra.coreInterface.searchInPackage(jd,I,V),8);case 8:Kc=Ha.yieldResult;Pb=Pb.concat(Kc);Ha.leaveTryBlock(4);break;case 6:zc=Ha.enterCatchBlock(),console.error("Error searching in package "+jd+":\n"+zc.stack);case 4:Ca++;Ha.jumpTo(3);break;case 5:return Ha.return(Pb)}})};Ua.prototype.loadMochaTestFile=
function(I,V){return this.coreInterface.loadMochaTestFile(I,V)};Ua.prototype.runMochaTests=function(I,V,ra,ya){return this.coreInterface.runMochaTests(I,V,ra,ya)};$jscomp.global.Object.defineProperties(Ua.prototype,{isSystemInterface:{configurable:!0,enumerable:!0,get:function(){return!0}},name:{configurable:!0,enumerable:!0,get:function(){return this.coreInterface.name}}});ta("Interface",Ua);qc.Interface=Ua;qc.systemInterfaceNamed=kc;qc.systemInterfaceNamed=kc;Ua=ta("localInterface",new qc.Interface(new qc.LocalCoreInterface));
qc.localInterface=Ua;qc.localInterface=Ua;qc.localInterface=Ua;qc.httpInterfaces={};Ua=ta("serverInterfaceFor",function(I){return qc.httpInterfaces[I]||(qc.httpInterfaces[I]=new qc.Interface(new qc.HTTPCoreInterface(I)))});qc.serverInterfaceFor=Ua;qc.serverInterfaceFor=Ua;qc.serverInterfaceFor=Ua;qc.l2lInterfaces={};Ua=ta("l2lInterfaceFor",function(I,V){return qc.l2lInterfaces[I]||(qc.l2lInterfaces[I]=new qc.Interface(new qc.L2LCoreInterface(I,V)))});qc.l2lInterfaceFor=Ua;qc.l2lInterfaceFor=Ua;qc.l2lInterfaceFor=
Ua}}});
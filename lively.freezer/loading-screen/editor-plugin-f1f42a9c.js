System.register(["./__root_module__-c4f77fb9.js","./index-2a389db9.js","./index-d5709707.js"],function(ra){var jb,pb,Ub,Jb,jd,uc,nd,wc,Cc,Mc,Bd,re,Ce,be,Sb,qc,od,Tb,wd,Fd,fc,ic,Ab,jc,Bc,ad,bd,ob,kb,tb,Aa,Fa,Ba,wa,Na,La,Wa,Gb,Rb,Bb,ba,xa,M,ha,Ka;return{setters:[function($a){jb=$a.C;pb=$a.aw;Ub=$a.a6;Jb=$a.a1;jd=$a.a3;uc=$a.ab;nd=$a.bj;wc=$a.aZ;Cc=$a.au;Mc=$a.a7;Bd=$a.aR;re=$a.bn;Ce=$a.bo;be=$a.a8;Sb=$a.aj;qc=$a.at;od=$a.av;Tb=$a.bp;wd=$a.bq;Fd=$a.a2;fc=$a.P;ic=$a.$;Ab=$a.aY;jc=$a.an;Bc=$a.ao;ad=
$a.ap;bd=$a.aq;ob=$a.aD;kb=$a.b0;tb=$a.az;Aa=$a.as;Fa=$a.ad;Ba=$a.br;wa=$a.L;Na=$a.bs;La=$a.b5;Wa=$a.bk;Gb=$a.b4;Rb=$a.bt;Bb=$a.ax},function($a){ba=$a.M;xa=$a.I;M=$a.v;ha=$a.p},function($a){Ka=$a.localInterface}],execute:function(){function $a(ua,Ga){if(!0===Ga)return Ga;if(ua.copyState)return ua.copyState(Ga);ua={};for(var mb in Ga){var R=Ga[mb];R instanceof Array&&(R=R.concat([]));ua[mb]=R}return ua}function $b(ua,Ga,mb){return ua.startState?ua.startState(Ga,mb):!0}function Tc(ua,Ga){return Ya.modes[ua]=
Ga}function Yb(ua){if("string"==typeof ua&&Ya.mimeModes.hasOwnProperty(ua))ua=Ya.mimeModes[ua];else if(ua&&"string"==typeof ua.name&&Ya.mimeModes.hasOwnProperty(ua.name)){var Ga=Ya.mimeModes[ua.name];"string"==typeof Ga&&(Ga={name:Ga});ua=Object.assign({},Ga,ua);ua.name=Ga.name}else{if("string"==typeof ua&&/^[\w\-]+\/[\w\-]+\+xml$/.test(ua))return Yb("application/xml");if("string"==typeof ua&&/^[\w\-]+\/[\w\-]+\+json$/.test(ua))return Yb("application/json")}return"string"==typeof ua?{name:ua}:ua||
{name:"null"}}function ub(ua,Ga){Ga=Ya.resolveMode(Ga);"string"===typeof Ga&&(Ga={name:Ga});if(!Ga.name)throw Error("parserConfig does not have a name of the mode to get");var mb=Ya.modes[Ga.name];if(!mb)return ub(ua,"text/plain");ua=Object.assign({indentUnit:2},ua);return Object.assign(mb(ua,Ga),{name:Ga.name})}function qd(ua,Ga){for(var mb;ua.innerMode;){mb=ua.innerMode(Ga);if(!mb||mb.mode==ua)break;Ga=mb.state;ua=mb.mode}return mb||{mode:ua,state:Ga}}function Uc(ua,Ga){Ya.mimeModes[ua]=Ga}function Ua(ua,
Ga,mb){}function lb(ua,Ga,mb,R,qa,Va,eb){var dc=ua.editorPlugin._tokenizerValidBefore;dc&&dc.row>=mb&&(dc.row=mb-1);var bc=Ya.linesToTokenize(ua.document,mb,R,dc);dc=bc.lines;bc=bc.state;if(!dc.length)return!1;bc=bc?Ya.copyState(Ga,bc):Ya.startState(Ga);for(var Ec=0;Ec<dc.length;Ec++){var Nc=dc[Ec],yc=Nc.row;yc>=mb&&yc<=R&&Ya.indentLine(ua,Ga,Nc,bc,qa,Va,eb);bc=Ya.tokenizeLine(Ga,dc[Ec],bc,function(){})}return!0}function xc(ua,Ga,mb,R,qa,Va,eb){Ga=Ya.linesToTokenize(Ga,mb,R,qa);mb=Ga.lines;Ya.tokenizeLines(ua,
mb,Ga.state,Va,eb);return mb}function ab(ua,Ga,mb,R,qa){var Va=[],eb,dc=function(Nc){return Va.push(eb=[])},bc=function(Nc,yc,ve,of,af,we,eh){return eb.push(ve,of,Nc,af.current(),yc.localMode||eh)};try{var Ec=Ya.visitDocumentTokens(ua,Ga,mb,R,qa,dc,bc)}catch(Nc){Va.length=0,Ec=Ya.visitDocumentTokens(ua,Ga,mb,R,null,dc,bc)}return{tokens:Va,lines:Ec}}function Dc(ua,Ga,mb,R,qa){null==Ga&&(Ga=ua.search(/[^\s\u00a0]/),-1==Ga&&(Ga=ua.length));R=R||0;for(qa=qa||0;;){var Va=ua.indexOf("\t",R);if(0>Va||Va>=
Ga)return qa+(Ga-R);qa+=Va-R;qa+=mb-qa%mb;R=Va+1}}function Hc(ua){ua=ua.toLowerCase();for(var Ga=0;Ga<Ya.modeInfo.length;Ga++){var mb=Ya.modeInfo[Ga];if(mb.mime==ua)return mb;if(mb.mimes)for(var R=0;R<mb.mimes.length;R++)if(mb.mimes[R]==ua)return mb}if(/\+xml$/.test(ua))return Hc("application/xml");if(/\+json$/.test(ua))return Hc("application/json")}function Xa(ua){for(var Ga=0;Ga<Ya.modeInfo.length;Ga++){var mb=Ya.modeInfo[Ga];if(mb.ext)for(var R=0;R<mb.ext.length;R++)if(mb.ext[R]==ua)return mb}}
function bb(ua){for(var Ga=0;Ga<Ya.modeInfo.length;Ga++){var mb=Ya.modeInfo[Ga];if(mb.file&&mb.file.test(ua))return mb}Ga=ua.lastIndexOf(".");if(ua=-1<Ga&&ua.substring(Ga+1,ua.length))return Ya.findModeByExtension(ua)}function cb(ua){ua=ua.toLowerCase();for(var Ga=0;Ga<Ya.modeInfo.length;Ga++){var mb=Ya.modeInfo[Ga];if(mb.name.toLowerCase()==ua)return mb;if(mb.alias)for(var R=0;R<mb.alias.length;R++)if(mb.alias[R].toLowerCase()==ua)return mb}}function Sc(ua){if(!ua)return String(ua);if(Array.isArray(ua))return"["+
ua.map(Sc).join(",")+"]";if("symbol"===typeof ua)return sc.printSymbol(ua);try{return String(ua)}catch(Ga){return"Cannot print object: "+Ga}}function sd(ua,Ga){return!sc.arr.every(Ga.map(function(mb){return ua[mb]}),function(mb){return sc.obj.equals(mb,ua&&ua.valueOf())})}function Ud(ua){if(sc.obj.isPrimitive(ua))var Ga=sc.string.print(ua);else Array.isArray(ua)?((Ga=3<ua.length)&&(ua=ua.slice(0,3)),ua=sc.string.print(ua),Ga&&(ua=ua.slice(0,-1)+", ...]"),Ga=ua):Ga=sc.string.print(ua);Ga=Ga.replace(/\n/g,
"");500<Ga.length&&(Ga=Ga.slice(0,20)+("...["+(Ga.length-20)+' CHARS]"'));return Ga}function hc(ua){return Db.Inspector.openInWindow({targetObject:ua})}function Ed(ua,Ga){return Db.Inspector.openInWindow({remoteTarget:{code:ua,evalEnvironment:Ga}})}function Ac(ua,Ga){function mb(dc){var bc=dc.name,Ec=dc.ownerChain(),Nc=dc.owner,yc=dc.world(),ve;dc===Va&&(ve=[eb]);yc===dc&&(ve=["$world"]);if(!ve&&bc&&Nc){Nc===yc&&1===Db.arr.count(Db.arr.pluck(yc.submorphs,"name"),bc)&&(ve=['$world.get("'+bc+'")']);
if(!ve&&Nc!=yc)for(yc=Ec.length-1;yc--;)if(1===Ec[yc].getAllNamed(bc).length){ve=[].concat($jscomp.arrayFromIterable(mb(Ec[yc])),['get("'+bc+'")']);break}ve||(bc=[].concat($jscomp.arrayFromIterable(mb(Nc)),['get("'+bc+'")']),Db.syncEval(bc.join("."),{context:Va}).value===dc&&(ve=bc))}ve||(ve=[eb+'.getMorphById("'+dc.id+'")']);return ve}Ga=void 0===Ga?{}:Ga;var R=ua.world(),qa=Ga;Ga=void 0===qa.maxLength?10:qa.maxLength;var Va=void 0===qa.fromMorph?R:qa.fromMorph;if(Va===ua)return"this";var eb=R===
Va?"$world":"this";if(!(R||ua.name&&Va.get(ua.name)===ua))return"morph";R=mb(ua);return R.length>Ga?'$world.getMorphWithId("'+ua.id+'")':R.join(".")}function Jd(ua,Ga,mb){var R=(Ga=void 0===Ga?"":Ga)&&ie.arr.last(Ga.split(".")).toLowerCase(),qa="",Va=0,eb=Math.pow(2,19);if("string"===typeof ua){if(ua.length>eb)return null}else if(ua.document.stringSize>eb)return null;if("string"===typeof ua)qa=ua.slice(0,1E3);else for(ua=$jscomp.makeIterator(ua.document.lines),eb=ua.next();!eb.done;eb=ua.next()){var dc=
eb.value;eb=dc.stringSize;dc=dc.text;var bc=!0;1E3<Va+eb&&(bc=!1,eb=1E3-Va);qa+=dc.slice(0,eb)+(bc?"\n":"");Va+=eb;if(1E3<=Va)break}Va=$jscomp.makeIterator(ie.modeInfo);for(ua=Va.next();!ua.done;ua=Va.next()){bc=ua.value;eb=bc.contentTest;ua=bc.mode;dc=bc.ext;bc=bc.file;if("function"===typeof eb)try{if(eb(qa))return ua}catch(Ec){}if(bc&&bc instanceof RegExp&&bc.test(Ga))return ua;if(dc)for(eb=$jscomp.makeIterator(dc),dc=eb.next();!dc.done;dc=eb.next())if(dc.value===R)return ua}return mb}ra({a:Uc,
d:Tc,r:Ua});var ka=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");ka.Color=jb;var Ra=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),mb=Ga.hasOwnProperty("DefaultTheme")&&"function"===typeof Ga.DefaultTheme?Ga.DefaultTheme:Ga.DefaultTheme=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:"background",get:function(){return ka.Color.white}},{key:"default",
get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:ka.Color.white,fontWeight:"bold",backgroundColor:ka.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:ka.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:ka.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ga,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Ha=Ra=ka.DefaultTheme;ka.default=Ra;var Ya=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");Ya.copyState=$a;Ya.startState=$b;Ya.defineMode=Tc;Ya.resolveMode=Yb;Ya.getMode=ub;Ya.innerMode=qd;Ya.defineMIME=Uc;Ya.registerHelper=Ua;Ya.indentLines=lb;Ya.indentLine=function(ua,Ga,mb,R,qa,Va,eb){eb=Object.assign({indentWithTabs:!ua.useSoftTabs,indentUnit:ua.tabWidth,tabSize:4,ignoreFollowingText:!1},
eb);null==qa&&(qa="add");"smart"==qa&&(Ga.indent||(qa="prev"));var dc=eb.tabSize,bc=mb.text,Ec=Ya.countColumn(bc,null,dc);mb.modeState&&(mb.modeState=null);var Nc=bc.match(/^\s*/)[0];if(!Va&&!/\S/.test(bc)){var yc=0;qa="not"}else if("smart"==qa&&(yc=Ga.indent(R,eb.ignoreFollowingText?"":bc.slice(Nc.length),bc),yc==Ya.passIndent||150<yc)){if(!Va)return;qa="prev"}"prev"==qa?yc=0<mb.row?Ya.countColumn(mb.prevLine().text,null,dc):0:"add"==qa?yc=Ec+eb.indentUnit:"subtract"==qa?yc=Ec-eb.indentUnit:"number"==
typeof qa&&(yc=Ec+qa);yc=Math.max(0,yc);Ga="";R=0;if(eb.indentWithTabs)for(eb=Math.floor(yc/dc);eb;--eb)R+=dc,Ga+="\t";R<yc&&(Ga+=" ".repeat(yc-R));if(Ga!=Nc)return ua.replace({start:{row:mb.row,column:0},end:{row:mb.row,column:Nc.length}},Ga),!0};Ya.tokenizeLines=function(ua,Ga,mb,R,qa){if(Ga.length){mb=mb?Ya.copyState(ua,mb):Ya.startState(ua);for(var Va=0;Va<Ga.length;Va++){var eb=Ga[Va];R(eb);mb=Ya.tokenizeLine(ua,eb,mb,qa)}}};Ya.tokenizeLine=function(ua,Ga,mb,R){var qa=Ga.text;if(!qa)return mb;
var Va=new Ya.StringStream(qa,2);mb=Ga.modeState="function"===typeof ua.copyState?ua.copyState(mb):Ya.copyState(ua,mb);Ga.prevLine();for(mb._string=qa;!Va.eol();)qa=ua.token(Va,mb),R(qa,mb,Va.start,Va.pos,Va,Ga,ua),Va.start=Va.pos;return mb};Ya.printTokens=function(ua){for(var Ga="",mb=0;mb<ua.length;mb+=5)Ga+=ua[mb+0]+" => "+ua[mb+1]+" "+ua[mb+2]+" "+ua[mb+3]+" "+ua[mb+4].name+"\n";return Ga};Ya.visitDocumentTokens=xc;Ya.tokenizeDocument=ab;Ya.linesToTokenize=function(ua,Ga,mb,R){if(R&&R.row>=mb)return{lines:[],
state:null};Ga=R?Math.max(0,R.row-1):Ga;var qa=ua.getLine(Ga),Va=qa.text;ua=[qa];R=null;for(var eb=0,dc;(dc=qa.prevLine())&&50>eb++;){qa=dc;if(qa.modeState){R=qa.modeState;break}ua.unshift(qa)}if(!R){for(var bc=qa,Ec=Infinity;(dc=qa.prevLine())&&100>eb++;){qa=dc;if(qa.modeState){R=qa.modeState;break}ua.unshift(qa);dc=Va.match(/^\s*/)[0].length;if(0===dc)break;dc<Ec&&(Ec=dc,bc=qa)}!R&&0<Ec&&(ua=ua.slice(ua.indexOf(bc)))}if(mb>Ga)for(qa=Ya.arr.last(ua);Ga<=mb;Ga++){qa=qa.nextLine();if(!qa)break;ua.push(qa)}return{lines:ua,
state:R}};Ya.countColumn=Dc;Ya.findModeByMIME=Hc;Ya.findModeByExtension=Xa;Ya.findModeByFileName=bb;Ya.findModeByName=cb;Ya.arr=Ub;Ra=Ya.modes||{};Ya.modes=Ra;Ya.modes=Ra;Ya.modes=Ra;Ra=ra("p",{});Ya.passIndent=Ra;Ya.passIndent=Ra;Ya.passIndent=Ra;Ya.copyState=$a;Ya.copyState=$a;Ya.startState=$b;Ya.startState=$b;Ya.defineMode=Tc;Ya.defineMode=Tc;Ya.resolveMode=Yb;Ya.resolveMode=Yb;Ya.getMode=ub;Ya.getMode=ub;Ya.innerMode=qd;Ya.innerMode=qd;Ra={};Ya.mimeModes=Ra;Ya.mimeModes=Ra;Ya.mimeModes=Ra;Ya.defineMIME=
Uc;Ya.defineMIME=Uc;Ya.registerHelper=Ua;Ya.registerHelper=Ua;Ya.indentLines=lb;Ya.indentLines=lb;Ya.visitDocumentTokens=xc;Ya.visitDocumentTokens=xc;Ya.tokenizeDocument=ab;Ya.tokenizeDocument=ab;Ya.countColumn=Dc;Ya.countColumn=Dc;(function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),mb=Ga.hasOwnProperty("StringStream")&&"function"===typeof Ga.StringStream?Ga.StringStream:Ga.StringStream=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return pb(mb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R,qa){this.reset(R,qa)}},{key:"reset",value:function(R,qa){this.pos=this.start=0;this.string=void 0===R?"":R;this.tabSize=void 0===qa?2:qa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",
value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(R){var qa=this.string.charAt(this.pos);if("string"==typeof R?qa==R:qa&&(R.test?R.test(qa):R(qa)))return++this.pos,qa}},{key:"eatWhile",value:function(R){for(var qa=this.pos;this.eat(R););return this.pos>qa}},{key:"eatSpace",value:function(){for(var R=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>R}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},
{key:"skipTo",value:function(R){R=this.string.indexOf(R,this.pos);if(-1<R)return this.pos=R,!0}},{key:"backUp",value:function(R){this.pos-=R}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=Ya.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?Ya.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return Ya.countColumn(this.string,
null,this.tabSize)-(this.lineStart?Ya.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(R,qa,Va){if("string"==typeof R){var eb=function(bc){return Va?bc.toLowerCase():bc},dc=this.string.substr(this.pos,R.length);if(eb(dc)==eb(R))return!1!==qa&&(this.pos+=R.length),!0}else{if((R=this.string.slice(this.pos).match(R))&&0<R.index)return null;R&&!1!==qa&&(this.pos+=R[0].length);return R}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},
{key:"hideFirstChars",value:function(R,qa){this.lineStart+=R;try{return qa()}finally{this.lineStart-=R}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],Ga,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);Ra=[{name:"APL",mime:"text/apl",
mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),
alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",
mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",
mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(ua){return ua.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",
mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",
mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",
mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",
mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",
mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},
{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",
mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",
mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p",
"pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",
ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},
{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",
mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(ua){return ua.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},
{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},
{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",
mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",
mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",
ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml",
"text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];Ya.modeInfo=Ra;Ya.modeInfo=Ra;Ya.modeInfo=Ra;for(var H=0;H<Ya.modeInfo.length;H++)Ya.info=Ya.modeInfo[H],Ya.info.mimes&&(Ya.info.mime=Ya.info.mimes[0]);Ya.defineMode("null",function(){return{token:function(ua){return ua.skipToEnd()}}});
Ya.defineMIME("text/plain","null");Ya.findModeByMIME=Hc;Ya.findModeByMIME=Hc;Ya.findModeByExtension=Xa;Ya.findModeByExtension=Xa;Ya.findModeByFileName=bb;Ya.findModeByFileName=bb;Ya.findModeByName=cb;Ya.findModeByName=cb;var ea=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");ea.Color=jb;ea.Rectangle=Jb;ea.pt=jd;ea.morph=uc;ea.ShadowObject=nd;ea.StyleSheet=wc;ea.connect=Cc;ea.arr=Ub;ea.string=Mc;ea.FilterableList=Bd;ea.Range=re;H=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
mb=Ga.hasOwnProperty("Completer")&&"function"===typeof Ga.Completer?Ga.Completer:Ga.Completer=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],Ga,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);ea.Completer=H;ea.Completer=H;ea.Completer=H;H=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),mb=Ga.hasOwnProperty("WordCompleter")&&"function"===typeof Ga.WordCompleter?Ga.WordCompleter:Ga.WordCompleter=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:"compute",value:function(R,
qa){var Va=[],eb=[],dc=R.document.lineStrings;R=R.cursorPosition.row;for(var bc=R-1;0<=bc;bc--)for(var Ec=$jscomp.makeIterator(dc[bc].split(/[^0-9a-z@_]+/i)),Nc=Ec.next();!Nc.done;Nc=Ec.next())(Nc=Nc.value)&&!Va.includes(Nc)&&Nc!==qa&&(Va.push(Nc),eb.push({priority:1E3-(R-bc),completion:Nc}));for(bc=R+1;bc<dc.length;bc++)for(Ec=$jscomp.makeIterator(dc[bc].split(/[^0-9a-z_@]+/i)),Nc=Ec.next();!Nc.done;Nc=Ec.next())(Nc=Nc.value)&&!Va.includes(Nc)&&Nc!==qa&&(Va.push(Nc),eb.push({priority:1E3-(bc-R),
completion:Nc}));return eb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Ga,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);ea.WordCompleter=H;ea.WordCompleter=H;ea.WordCompleter=H;H=[new ea.WordCompleter];ea.defaultCompleters=
H;ea.defaultCompleters=H;ea.defaultCompleters=H;H=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),mb=Ga.hasOwnProperty("CompletionController")&&"function"===typeof Ga.CompletionController?Ga.CompletionController:Ga.CompletionController=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R,qa){qa=void 0===qa?
[]:qa;this.textMorph=R;this.completers=qa=R.pluginCollect("getCompleters",qa)}},{key:"computeCompletions",value:function(R){var qa=this,Va,eb,dc,bc,Ec,Nc,yc,ve,of,af,we,eh,Dg,pi,Tg,zj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wf){switch(wf.nextAddress){case 1:Va=[],eb=$jscomp.makeIterator(qa.completers),dc=eb.next();case 2:if(dc.done){wf.jumpTo(4);break}bc=dc.value;wf.setCatchFinallyBlocks(5);Ec=Va;Nc=Ec.concat;return wf.yield(bc.compute(qa.textMorph,R),7);case 7:Va=Nc.call(Ec,wf.yieldResult);
wf.leaveTryBlock(3);break;case 5:yc=wf.enterCatchBlock(),console.warn("Error in completer "+bc+": "+(yc.stack||yc));case 3:dc=eb.next();wf.jumpTo(2);break;case 4:ve=new Map;Va.forEach(function(Ni){var zh=ve.get(Ni.completion);zh||(zh=[],ve.set(Ni.completion,zh));zh.push(Ni)});of=[];af=$jscomp.makeIterator(ve.values());for(we=af.next();!we.done;we=af.next())eh=we.value,of.push(ea.arr.last(ea.arr.sortByKey(eh,"priority")));Dg=0;pi=ea.arr.sortByKey(of,"priority").reverse();Tg=pi.length&&pi[0].priority||
0;zj=pi.map(function(Ni){Ni.highestPriority=Tg;var zh=Ni.completion.replace(/\n/g,""),$i=String((Ni.info||"").replace(/\n/g,""));Dg=Math.max(Dg,zh.length+$i.length);return{isListItem:!0,string:zh,annotation:$i,value:Ni}});return wf.return({items:zj,maxCol:Dg})}})}},{key:"computeSortedCompletions",value:function(R,qa){qa=void 0===qa?!1:qa;var Va=this,eb,dc,bc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress)return eb={tokens:[R],lowercasedTokens:[R],input:R},Ec.yield(Va.computeCompletions(R),
2);dc=Ec.yieldResult;bc=ea.arr.sortBy(dc.items.filter(function(Nc){return Va.filterFunction(eb,Nc,qa)}),function(Nc){return Va.sortFunction(eb,Nc)});return Ec.return(bc)})}},{key:"_printCompletions",value:function(R){var qa=this,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return eb.yield(qa.computeSortedCompletions(R),2);Va=eb.yieldResult.map(function(dc){return{completion:dc.value.completion,priority:dc.value.priority,maxP:dc.value.highestPriority,sortVal:dc._cache[R].sortVal,
lev:JSON.stringify(dc._cache[R].levenshtein)}});return eb.return(ea.string.printTable(lively.lang.grid.tableFromObjects(Va)))})}},{key:"prefix",value:function(){var R=this.textMorph,qa=R.selection;return(qa.isEmpty()?R.getLine(qa.lead.row).slice(0,qa.lead.column):qa.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(R,qa,Va){Va=void 0===Va?!1:Va;qa._cache||(qa._cache={});var eb=R.tokens,dc=R.lowercasedTokens,bc=R.input;bc=qa._cache[bc]||(qa._cache[bc]={});if(bc.hasOwnProperty("filtered"))return bc.filtered;
qa=qa.value.completion.replace(/\([^\)]*\)$/,"");var Ec=qa.toLowerCase();if(Va&&eb[0]&&!qa.startsWith(eb[0]))return bc.filtered=!1;if(dc.every(function(yc){return Ec.includes(yc)}))return!0;var Nc=bc.levenshtein||(bc.levenshtein={});R=Va||3>=ea.arr.sum(R.lowercasedTokens.map(function(yc){return Nc[yc]||(Nc[yc]=ea.string.levenshtein(Ec,yc))}));return bc.filtered=R}},{key:"sortFunction",value:function(R,qa){qa._cache||(qa._cache={});var Va=qa._cache[R.input]||(qa._cache[R.input]={});if(Va.hasOwnProperty("sortVal"))return Va.sortVal;
Va=qa._cache[R.input]={};var eb=qa.value;qa=eb.highestPriority;var dc=eb.completion;eb=eb.priority;dc=dc.replace(/\([^\)]*\)$/,"").toLowerCase();var bc=0;R.lowercasedTokens.forEach(function(Nc){dc.startsWith(Nc)?bc+=12:3<=Nc.length&&dc.includes(Nc)&&(bc+=5)});qa=-((eb||(bc?qa:0))/Math.pow(10,String(qa).length-2))-bc;var Ec=Va.levenshtein||(Va.levenshtein={});R=ea.arr.sum(R.lowercasedTokens.map(function(Nc){return Ec[Nc]||(Ec[Nc]=ea.string.levenshtein(dc,Nc))}));bc&&(R/=2);return Va.sortVal=R+qa}},
{key:"positionForMenu",value:function(){var R=this.textMorph,qa=R.charBoundsFromTextPosition(R.cursorPosition);return R.getGlobalTransform().transformRectToRect(qa).topLeft().addXY(-R.scroll.x,-R.scroll.y).addPt(ea.pt(R.borderWidth+4,R.borderWidth+4))}},{key:"completionListSpec",value:function(){var R=this,qa,Va,eb,dc,bc,Ec,Nc,yc,ve,of,af,we,eh,Dg,pi,Tg,zj,wf,Ni,zh;return $jscomp.asyncExecutePromiseGeneratorProgram(function($i){if(1==$i.nextAddress)return Va=qa=R.textMorph,eb=Va.fontSize,dc=Va.fontFamily,
bc=R.positionForMenu(),Ec=R.prefix(),$i.yield(R.computeCompletions(Ec),2);Nc=$i.yieldResult;yc=Nc.items;ve=Nc.maxCol;of=qa.env.fontMetric.sizeFor(dc,eb,"M");af=of.width*ve;we=qa.document.getLine(0).height;eh=Math.max(120,af<qa.width?af:qa.width);Dg=we*yc.length+we+10;pi=Math.max(70,Math.min(700,Dg));Tg=bc.extent(ea.pt(eh,pi));if(zj=qa.world())wf=zj.visibleBounds().insetBy(5),Tg.bottom()>wf.bottom()&&(Ni=Tg.bottom()-wf.bottom(),Ni>Tg.height-50&&(Ni=Tg.height-50),Tg.height-=Ni),Tg.right()>wf.right()&&
(zh=Tg.right()-wf.right(),Tg.width=120>Tg.width-zh?120:Tg.width-zh),wf.containsRect(Tg)||(Tg=Tg.withTopLeft(wf.translateForInclusion(Tg).topLeft())),Tg=Tg.translatedBy(wf.insetBy(0).topLeft().negated());return $i.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},hasFixedPosition:!0,epiMorph:!0,fontSize:eb,position:Tg.topLeft(),extent:Tg.extent(),items:yc,input:Ec,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:R.filterFunction,sortFunction:R.sortFunction})})}},
{key:"removeMenuOnBlur",value:function(R){var qa=R.menu;setTimeout(function(){qa.withAllSubmorphsDetect(function(Va){return Va.isFocused()})?qa.inputMorph.focus():qa.remove()})}},{key:"openCompletionList",value:function(){var R=this,qa,Va,eb,dc,bc,Ec,Nc,yc,ve,of;return $jscomp.asyncExecutePromiseGeneratorProgram(function(af){if(1==af.nextAddress)return qa=R.textMorph.selection.start,af.yield(R.completionListSpec(),2);if(3!=af.nextAddress)return Va=af.yieldResult,R.textMorph.pluginFind(function(we){return we.theme}),
eb=new ea.FilterableList(Va),dc=new ea.Range({start:qa,end:R.textMorph.selection.start}),bc=R.textMorph.textInRange(dc),Ec=eb.inputMorph,Nc=eb.listMorph,yc=Va.input,ve=eb.addMorph({name:"prefix mask",fill:ea.Color.transparent,bounds:Ec.textBounds()},Ec),Nc.master=null,dc.isEmpty()||(R.textMorph.deleteText(dc),Ec.input=bc,Ec.gotoDocumentEnd()),Ec.fontColor=R.textMorph.fontColor,ea.connect(Ec,"textString",ve,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Ec}}),ea.connect(eb,"accepted",
R,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",varMapping:{prefix:yc}}),
ea.connect(eb,"accepted",eb,"remove"),ea.connect(eb,"canceled",eb,"remove"),ea.connect(eb,"remove",R.textMorph,"focus"),ea.connect(eb.inputMorph,"onBlur",R,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:eb}}),of=R.textMorph.world(),Nc.addStyleClass("hiddenScrollbar"),eb.paddingMorph.height=2,Ec.height=Nc.itemHeight,Ec.clipMode="visible",Ec.fill=R.textMorph.fill,Ec.fixedHeight=!0,Ec.fixedWidth=!1,Ec.fontSize=Nc.fontSize,eb.relayout(),eb.selectedIndex=0,eb.master.applyIfNeeded(!0),
Ec.focus(),af.yield(eb.master.whenApplied(),3);yc.length&&(Ec.gotoDocumentEnd(),eb.moveBy(ea.pt(-Ec.textBounds().width,0)));of.addMorph(eb);eb.inputPadding=ea.Rectangle.inset(0,0,0,0);return af.return(eb)})}},{key:"autoInsertBestMatchingCompletion",value:function(R,qa,Va){qa=void 0===qa?!0:qa;var eb=this,dc,bc,Ec,Nc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){if(1==yc.nextAddress)return dc=$jscomp,bc=dc.makeIterator,yc.yield(eb.computeSortedCompletions(R,qa),2);Ec=bc.call(dc,yc.yieldResult);
(Nc=Ec.next().value)&&eb.insertCompletion(Nc.value.completion,R,Va);yc.jumpToEnd()})}},{key:"insertCompletion",value:function(R,qa,Va){var eb=this.textMorph,dc=eb.document,bc=eb.selection.isMultiSelection?eb.selection.selections:[eb.selection];eb.undoManager.group();bc.forEach(function(Ec){Ec.collapseToEnd();var Nc=Ec.lead,yc=qa?dc.indexToPosition(dc.positionToIndex(Nc)-qa.length):Nc;"function"===typeof Va?Va(R,qa,eb,{start:yc,end:Nc},Ec):eb.replace({start:yc,end:Nc},R)});eb.undoManager.group()}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],Ga,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);ea.CompletionController=H;ea.CompletionController=H;ea.CompletionController=H;H=[{name:"text completion",handlesCount:!0,
multiSelectAction:"single",exec:function(ua,Ga,mb){var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qa){return 1==qa.nextAddress?(R=new ea.CompletionController(ua,ea.defaultCompleters),qa.yield(R.openCompletionList(),2)):qa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(ua,Ga,mb){var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qa){return 1==qa.nextAddress?(R=new ea.CompletionController(ua,ea.defaultCompleters),
qa.yield(R.autoInsertBestMatchingCompletion(R.prefix()),2)):qa.return(!0)})}}];ea.completionCommands=H;ea.completionCommands=H;ea.completionCommands=H;var Oa=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Oa.chain=Ce;Oa.arr=Ub;Oa.obj=be;Oa.string=Mc;var sb=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(ua){var Ga=ua.selection.start;0<Ga.row&&(Ga=ua.getPositionAboveOrBelow(1,Ga,!0,0,ua.charBoundsFromTextPosition(Ga).x),ua.selection.addRange({start:Ga,
end:Ga}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(ua){var Ga=ua.selection.start;Ga.row<ua.documentEndPosition.row&&(Ga=ua.getPositionAboveOrBelow(-1,Ga,!0,0,ua.charBoundsFromTextPosition(Ga).x),ua.selection.addRange({start:Ga,end:Ga}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(ua){var Ga=ua.selection.selections[ua.selection.selections.length-1];if(Ga.isEmpty())return!0;ua.searchForAll(Ga.text,{start:{column:0,
row:0}}).forEach(function(mb){return ua.selection.addRange(mb.range,!1)});ua.selection.mergeSelections();Oa.arr.remove(ua.selection.selections,Ga);ua.selection.selections.push(Ga);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(ua){var Ga=ua.selection.selections.length-1,mb=ua.selection.selections[Ga];if(mb.isEmpty())return!0;var R=ua.search(mb.text,{start:mb.end,backwards:!1});R&&(mb=ua.selection.selections.findIndex(function(qa){return qa.range.equals(R.range)}),
-1<mb?Oa.arr.swap(ua.selection.selections,mb,Ga):ua.selection.addRange(R.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(ua){var Ga=ua.selection.selections.length-1,mb=ua.selection.selections[Ga];if(mb.isEmpty())return!0;var R=mb.start,qa=ua.search(mb.text,{start:{row:R.row,column:R.column-(mb.text.length-1)},backwards:!0});qa&&(mb=ua.selection.selections.findIndex(function(Va){return Va.range.equals(qa.range)}),-1<mb?Oa.arr.swap(ua.selection.selections,
mb,Ga):ua.selection.addRange(qa.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(ua){var Ga=ua.selection.selections.length;1<Ga&&ua.selection.removeSelections(Ga-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(ua){ua.selection.selections=lively.lang.arr.rotate(ua.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(ua){ua.selection.selections=
lively.lang.arr.rotate(ua.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(ua){var Ga=ua.selection.selections;if(1>=Ga.length)return!0;var mb=Oa.arr.groupBy(Ga,function(qa){return qa.range.start.row});Ga=mb.keys().map(function(qa){qa=mb[qa];var Va=Oa.arr.max(qa,function(eb){return eb.range.start.column});Oa.arr.without(qa,Va).forEach(function(eb){return eb.range=Va.range});return Va});var R=Oa.arr.max(Ga,function(qa){return qa.range.start.column}).range.start.column;
Ga.forEach(function(qa){var Va=qa.range.start;qa=Va.row;Va=Va.column;ua.insertText(" ".repeat(R-Va),{row:qa,column:Va})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(ua){ua.selection.disableMultiSelect();if(ua.selection.isEmpty())var Ga=ua.lastSavedMark&&ua.lastSavedMark.position||(void 0).lineRange().start,mb=ua.cursorPosition;else Ga=ua.selection,mb=Ga.lead,Ga=Ga.anchor;ua.selection.collapse();var R=Ga.column,qa=mb.column;Oa.arr.range(Ga.row,
mb.row).forEach(function(Va){return ua.getLine(Va).length>Math.min(qa,R)&&ua.selection.addRange({end:{row:Va,column:qa},start:{row:Va,column:R}},!1)});ua.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(ua,Ga,mb){mb=void 0===mb?1:mb;ua.undoManager.group();ua.selection.selections.forEach(function(R,qa){return R.text=String(qa+mb)});ua.undoManager.group();return!0}}];Oa.multiSelectCommands=sb;Oa.multiSelectCommands=sb;Oa.multiSelectCommands=
sb;var Lb=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");Lb.pToI=function(ua,Ga){return ua.positionToIndex(Ga)};Lb.iToP=function(ua,Ga){return ua.indexToPosition(Ga)};Lb.execCodeNavigator=function(ua){return function(Ga,mb,R){var qa=Ga.pluginInvokeFirst("getNavigator");if(!qa)return!0;Ga.saveMark();R=R||1;for(var Va=0;Va<R;Va++)qa[ua](Ga,mb);return!0}};Lb.once=Sb;var vc=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Lb.execCodeNavigator("forwardSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:Lb.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Lb.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Lb.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",
exec:Lb.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(ua,Ga){function mb(){var Va=ua.$expandRegionState,eb=Lb.pToI(ua,ua.cursorPosition);if(Va&&(Va.range[0]===eb||Va.range[1]===eb))return Va;Va=ua.selection.range;return ua.$expandRegionState={range:[Lb.pToI(ua,Va.start),Lb.pToI(ua,Va.end)]}}Ga=Ga||{};var R=ua.pluginInvokeFirst("getNavigator");if(!R)return!0;
var qa=Ga.start;Ga=Ga.end;if("number"===typeof qa&&"number"===typeof Ga)mb(),R={range:[qa,Ga],prev:mb()};else{qa=R.ensureAST(ua);if(!qa)return;R=R.expandRegion(ua,ua.textString,qa,mb())}R&&R.range&&(ua.selection={start:Lb.iToP(ua,R.range[0]),end:Lb.iToP(ua,R.range[1])},ua.$expandRegionState=R);Lb.once(ua,"selectionChange",function(){return ua.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},
exec:function(ua){if(ua.selection.isEmpty())return!0;var Ga=ua.pluginInvokeFirst("getNavigator");if(!Ga)return!0;var mb=Ga.ensureAST(ua);if(!mb)return!0;var R=ua.$expandRegionState;if(!R)return!0;(Ga=Ga.contractRegion(ua,ua.textString,mb,R))&&Ga.range&&(ua.selection={start:Lb.iToP(ua,Ga.range[0]),end:Lb.iToP(ua,Ga.range[1])},ua.$expandRegionState=Ga);Lb.once(ua,"selectionChange",function(){return ua.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Lb.commands=vc;
Lb.commands=vc;Lb.commands=vc;var gd=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");gd.arr=Ub;gd.chain=Ce;gd.string=Mc;var xd=[{name:"toggle comment",exec:function(ua){var Ga=ua.pluginInvokeFirst("getComment");if(!Ga)return!0;if(!Ga.lineCommentStart)return Ga.blockCommentStart?ua.execCommand("toggle block comment"):!0;var mb=Ga.lineCommentStart,R=new RegExp("^(\\s*)("+mb+"\\s?)(.*)");Ga=ua.document;var qa=ua.selection;qa.isEmpty()||0!==qa.end.column||qa.growRight(-1);
var Va=qa.start.row;Ga=Ga.lineStrings.slice(qa.start.row,qa.end.row+1);Ga=Ga.some(function(bc){return!!bc.trim()})?gd.arr.dropWhile(Ga,function(bc){return bc.trim()?!1:++Va&&!0}):Ga;var eb=Ga.every(function(bc){return bc.trim()&&bc.match(R)});ua.undoManager.group();if(eb)Ga.forEach(function(bc,Ec){if(bc=bc.match(R)){bc=$jscomp.makeIterator(bc);bc.next();var Nc=bc.next().value,yc=bc.next().value;bc.next();ua.deleteText({start:{row:Va+Ec,column:Nc.length},end:{row:Va+Ec,column:Nc.length+yc.length}})}});
else{var dc=Ga.reduce(function(bc,Ec,Nc){return Ec.trim()||qa.isEmpty()&&qa.start.row===qa.end.row?Math.min(bc,Ec.match(/^\s*/)[0].length):bc},Infinity);dc=Infinity===dc?0:dc;Ga.forEach(function(bc,Ec){bc=$jscomp.makeIterator(bc.match(/^(\s*)(.*)/));bc.next();bc.next();bc.next();ua.insertText(mb+" ",{row:Va+Ec,column:dc})})}ua.undoManager.group();return!0}},{name:"toggle block comment",exec:function(ua){var Ga=ua.pluginInvokeFirst("getComment");if(!Ga)return!0;if(!Ga.blockCommentStart)return Ga.lineCommentStart?
ua.execCommand("toggle comment"):!0;if(!Ga||!Ga.blockCommentStart)return!0;var mb=Ga.blockCommentStart;Ga=Ga.blockCommentEnd;var R=new RegExp("^"+mb.replace(/\*/g,"\\*")),qa=new RegExp(Ga.replace(/\*/g,"\\*")+"$"),Va=ua.tokenAt(ua.cursorPosition);if(Va&&"comment"===Va.token){var eb=ua.textInRange(Va);if(eb.match(R)&&eb.match(qa))return ua.undoManager.group(),ua.replace(Va,eb.slice(mb.length,-Ga.length)),ua.undoManager.group(),!0}ua.undoManager.group();ua.insertText(mb,ua.selection.start);ua.insertText(Ga,
ua.selection.end);ua.undoManager.group();mb=!ua.selection.isEmpty();ua.selection.growLeft(Ga.length);mb||ua.selection.collapse();return!0}},{name:"comment box",exec:function(ua,Ga,mb){Ga=ua.undoManager.ensureNewGroup(ua,"comment box");if(ua.selection.isEmpty())return ua.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),ua.execCommand("toggle comment"),ua.undoManager.group(Ga),!0;var R=ua.selection.range,qa=ua.withSelectedLinesDo(function(eb){return eb}),Va=gd.arr.min([R.start.column].concat(gd.chain(qa).map(function(eb){return eb.match(/^\s*/)}).flatten().compact().pluck("length").value()));
qa=gd.arr.max(qa.map(function(eb){return eb.length}))-Va;qa=Array(Math.ceil(qa/2)+1).join("-=")+"-";ua.execCommand("toggle comment");ua.collapseSelection();ua.cursorPosition={row:R.start.row,column:0};mb?ua.insertText(gd.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",Va)):ua.insertText(gd.string.indent(qa+"\n"," ",Va));ua.selection.goUp();ua.execCommand("toggle comment");ua.cursorPosition={row:R.end.row+2,column:0};ua.insertText(gd.string.indent(qa+"\n"," ",Va));ua.selection.goUp();
ua.execCommand("toggle comment");ua.selection.range={start:{row:R.start.row,column:0},end:ua.cursorPosition};ua.undoManager.group(Ga);return!0},multiSelectAction:"forEach",handlesCount:!0}];gd.commands=xd;gd.commands=xd;gd.commands=xd;var sc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");sc.printSymbol=function(ua){if(Symbol.keyFor(ua))return'Symbol.for("'+Symbol.keyFor(ua)+'")';if(sc.knownSymbols.get(ua))return sc.knownSymbols.get(ua);String(ua).match(sc.symMatcher);return String(ua)};
sc.defaultSort=function(ua,Ga){if(ua.hasOwnProperty("priority")||Ga.hasOwnProperty("priority")){var mb=ua.priority||0,R=Ga.priority||0;if(mb<R)return-1;if(mb>R)return 1}ua=(ua.keyString||ua.key).toLowerCase();Ga=(Ga.keyString||Ga.key).toLowerCase();return ua<Ga?-1:ua===Ga?0:1};sc.safeToString=Sc;sc.propertyNamesOf=function(ua,Ga){if(!ua)return[];if(Array.isArray(ua)){var mb=Ga?Ga.offset:0;return sc.arr.range(mb,mb+(Ga?Ga.partitionSize:ua.length-1))}return sc.arr.sortBy(Object.keys(ua),function(R){return R.toLowerCase()})};
sc.isMultiValue=sd;sc.printValue=Ud;sc.partitionedChildren=function(ua,Ga){var mb=void 0===Ga?{}:Ga;Ga=void 0===mb.originalValue?ua:mb.originalValue;var R=void 0===mb.offset?0:mb.offset;mb=void 0===mb.partitionSize?ua.length||Object.values(ua).length:mb.partitionSize;if(sc.obj.isArray(ua)){ua=sc.num.roundTo(Math.max(sc.MIN_PARTITION_SIZE,mb/50),.1);mb/=ua;for(var qa=[],Va=0;Va<mb;Va++){var eb="["+(R+Va*ua)+"-"+(R+(Va+1)*ua)+"]";qa.push({partition:{originalValue:Ga,offset:R+Va*ua,partitionSize:ua},
value:[],key:eb,keyString:eb,valueString:"...",isCollapsed:!0})}return qa}ua=sc.num.roundTo(Math.max(sc.MIN_PARTITION_SIZE,mb/50),.1);mb/=ua;qa=[];Va=sc.obj.keys(Ga).sort();for(eb=0;eb<mb;eb++){var dc=R+eb*ua,bc=R+(eb+1)*ua,Ec=sc.obj.select(Ga,Va.slice(dc,bc));dc="["+Va[dc].slice(0,4)+"-"+(Va[bc]||sc.arr.last(Va)).slice(0,4)+"]";qa.push({partition:{originalValue:Ec,offset:R+eb*ua,partitionSize:ua},value:[],key:dc,keyString:dc,valueString:"...",isCollapsed:!0})}return qa};sc.propertiesOf=function(ua){var Ga=
ua.partition?ua.target:ua.value;if(!Ga)return[];var mb={_rev:!0},R=[],qa="function"===typeof Ga.livelyCustomInspect?Ga.livelyCustomInspect():{},Va=Object.assign({},sc.defaultPropertyOptions,{},qa);if(qa.properties){qa=$jscomp.makeIterator(qa.properties);for(var eb=qa.next();!eb.done;eb=qa.next()){var dc=eb.value;eb=dc.key;var bc=dc.hidden,Ec=dc.priority,Nc=dc.keyString,yc=dc.value;dc=dc.valueString;mb[eb]=!0;bc||R.push(ua.getSubNode({priority:Ec,key:eb,keyString:Nc||sc.safeToString(eb),value:yc,valueString:dc,
isCollapsed:!0}))}}if(Va.includeDefault){qa=sc.propertyNamesOf(Ga,ua.partition);if(qa.length>sc.MAX_NODE_THRESHOLD)for(mb=$jscomp.makeIterator(sc.partitionedChildren(Ga,ua.partition)),qa=mb.next();!qa.done;qa=mb.next())R.push(ua.getSubNode(qa.value));else for(bc=$jscomp.makeIterator(qa),qa=bc.next();!qa.done;qa=bc.next())Ec=qa.value,Ec in mb||(qa=Ga[Ec],eb=sc.printValue(qa),qa={keyString:Ec,key:Ec,value:qa,valueString:eb,isCollapsed:!0},R.push(ua.getSubNode(qa)));if(Va.includeSymbols)for(mb=$jscomp.makeIterator(Object.getOwnPropertySymbols(Ga)),
qa=mb.next();!qa.done;qa=mb.next())bc=qa.value,Ec=sc.safeToString(bc),qa=Ga[bc],eb=sc.printValue(qa),qa={key:bc,keyString:Ec,value:qa,valueString:eb,isCollapsed:!0},R.push(ua.getSubNode(qa))}Va.sort&&(R=Va.sortFunction(Ga,R));return R};sc.obj=be;sc.num=qc;sc.arr=Ub;sc.string=Mc;sc.connect=Cc;sc.signal=od;sc.TreeData=Tb;sc.newUUID=wd;sc.localInterface=Ka;sc.MAX_NODE_THRESHOLD=1E3;sc.MIN_PARTITION_SIZE=250;sc.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(ua,
Ga){return Array.isArray(ua)?Ga:Ga.sort(sc.defaultSort)}};sc.symMatcher=/^Symbol\((.*)\)$/;sc.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(ua){return"symbol"===typeof Symbol[ua]}).reduce(function(ua,Ga){return ua.set(Symbol[Ga],"Symbol."+Ga)},new Map)}();sc.isMultiValue=sd;sc.isMultiValue=sd;sc.printValue=Ud;sc.printValue=Ud;var Zd=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),mb=Ga.hasOwnProperty("InspectionTree")&&
"function"===typeof Ga.InspectionTree?Ga.InspectionTree:Ga.InspectionTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R){pb._get(Object.getPrototypeOf(mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);this.inspector=R.inspector;this.root.isInspectionNode||(this.root=sc.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",
get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(R){R=void 0===R?!0:R;return pb._get(Object.getPrototypeOf(mb.prototype),"asListWithIndexAndDepth",this).call(this,function(qa){qa=qa.node;return R?qa.visible:!0})}},{key:"getContextFor",value:function(R){return R==this.root?this.root.value.inspectee:R.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(R){var qa=void 0===R.maxDepth?1:R.maxDepth,Va=R.iterator,eb=R.showUnknown,dc=R.showInternal,bc=this;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress)return Ec.yield(bc.uncollapseAll(function(Nc,yc){return qa>yc&&(Nc==bc.root||Nc.value.submorphs)}),2);bc.asListWithIndexAndDepth(!1).forEach(function(Nc){var yc=Nc.node;return 0==Nc.depth?yc.visible=!0:!eb&&yc.keyString&&yc.keyString.includes("UNKNOWN PROPERTY")||!dc&&yc.keyString&&yc.keyString.includes("internal")?yc.visible=!1:yc.value&&yc.value.submorphs?yc.visible=!0:yc.visible=Va(yc)});Ec.jumpToEnd()})}},{key:"getChildren",
value:function(R){return R.children}},{key:"display",value:function(R){return R.display(this.inspector)}},{key:"isCollapsed",value:function(R){return R.isCollapsed}},{key:"isLeaf",value:function(R){return sc.obj.isPrimitive(R.value)}},{key:"collapse",value:function(R,qa){var Va=this;R.isCollapsed=qa;qa||this.isLeaf(R)||R.children.length||(R.children=sc.propertiesOf(R).map(function(eb){Va.parentMap.set(eb,R);return eb}))}},{key:"retrieveForRemoteProxy",value:function(R){R.uuid||(R.uuid=sc.newUUID(),
this.idToNodeMap[R.uuid]=R);return{uuid:R.uuid,value:this.isLeaf(R)?R.value:{},keyString:R.keyString,key:R.keyString,valueString:sc.safeToString(R.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return sc.localInterface}},{key:"getNodeViaId",value:function(R){return this.idToNodeMap[R]}},{key:"asRemoteDelegate",value:function(R){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext=
{});System.get("@lively-env").remoteInspectionContext[R]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionTree"}},{key:"forObject",value:function(R,qa){return new this({key:"inspectee",value:{inspectee:R},isCollapsed:!0,inspector:qa})}}],Ga,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(sc.TreeData);sc.InspectionTree=Zd;sc.InspectionTree=Zd;sc.InspectionTree=Zd;var he=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),mb=Ga.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Ga.RemoteInspectionTree?Ga.RemoteInspectionTree:Ga.RemoteInspectionTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return pb(mb,ua,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(R){this.parentMap=new WeakMap;this.root=R.proxy;this.evalEnvironment=R.evalEnvironment;this.inspector=R.inspector;this.delegateId=R.delegateId}},{key:"getContextFor",value:function(R){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+R.uuid+'").value'}},{key:"dispose",value:function(){var R=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qa){return qa.yield(R.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+R.delegateId+"']\n    ",R.evalEnvironment),0)})}},{key:"display",value:function(R){return R.keyString+": "+R.valueString}},{key:"collapse",value:function(R,qa){var Va=this,eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(dc){if(1==dc.nextAddress)return(R.isCollapsed=qa)||Va.isLeaf(R)?dc.return():
R.children.length?dc.jumpTo(0):dc.yield(Va.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+R.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Va.delegateId+'"]'}),3);eb=dc.yieldResult;R.children=eb.isError?[]:eb.value;
dc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(R,qa){var Va=this,eb,dc,bc,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){if(1==Nc.nextAddress)return Nc.yield(Va.createRemoteContext(R,qa),2);eb=Nc.yieldResult;dc=eb.proxy;bc=eb.delegateId;Ec=eb.evalEnvironment;return Nc.return(new Va({key:"inspectee",proxy:dc,delegateId:bc,evalEnvironment:Ec,inspector:qa}))})}},{key:"createRemoteContext",value:function(R,
qa){var Va=R.code,eb=R.evalEnvironment,dc=R.delegateId,bc,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){if(1==Nc.nextAddress)return dc="lively://inspector-"+qa.id,Nc.yield(eb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+Va+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+dc+'");\n    ',eb),2);bc=Nc.yieldResult;Ec=bc.value;return Nc.return({delegateId:dc,
evalEnvironment:eb,proxy:Ec})})}}],Ga,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(sc.InspectionTree);sc.RemoteInspectionTree=he;sc.RemoteInspectionTree=he;sc.RemoteInspectionTree=he;(function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
mb=Ga.hasOwnProperty("InspectionNode")&&"function"===typeof Ga.InspectionNode?Ga.InspectionNode:Ga.InspectionNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R){var qa=R.root,Va=R.priority,eb=R.key,dc=R.keyString,bc=R.value,Ec=R.valueString,Nc=R.isCollapsed,yc=void 0===R.children?[]:R.children,ve=void 0===R.isSelected?!1:R.isSelected,of=
void 0===R.visible?!0:R.visible;this.partition=R.partition;this.priority=Va;this.key=eb;this.keyString=String(dc||eb);this.value=bc;this.valueString=Ec||sc.printValue(bc);this.isCollapsed=Nc;this.children=yc;this.isSelected=ve;this.visible=of;this.root=qa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",get:function(){return!0}},{key:"getSubNode",value:function(R){if(R.value&&R.value.isMorph)return new sc.MorphNode(Object.assign({root:this.root},R));var qa=R.key,Va=R.keyString,
eb=this.value,dc=R.partition;dc&&(eb=dc.originalValue,Va=qa);return new sc.PropertyNode(Object.assign({},R,{keyString:Va,key:qa,target:eb,partition:dc,root:this.root,spec:{}}))}},{key:"display",value:function(R){var qa=this.keyString,Va=this.valueString;if(!this.interactive)return qa+": "+Va;this._propertyWidget||(this._propertyWidget=R.renderDraggableTreeLabel({value:qa+": "+Va}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionNode"}},{key:"for",value:function(R,qa){qa=void 0===qa?null:qa;return R.value&&R.value.isMorph?new sc.MorphNode(Object.assign({root:qa},R)):new sc.InspectionNode(Object.assign({root:qa},R))}}],Ga,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,
end:13612})})(void 0);(function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),mb=Ga.hasOwnProperty("MorphNode")&&"function"===typeof Ga.MorphNode?Ga.MorphNode:Ga.MorphNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R){pb._get(Object.getPrototypeOf(mb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,R);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(R){var qa=this.propertyInfo[R.key]||{};return R.value&&R.value.isMorph?new sc.MorphNode(Object.assign({},R,{root:this.root})):new sc.PropertyNode(Object.assign({},R,{root:this.root,target:this.target,spec:qa}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],Ga,{pathInPackage:function(){return"js/inspector/context.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(sc.InspectionNode);(function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),mb=Ga.hasOwnProperty("PropertyNode")&&"function"===typeof Ga.PropertyNode?Ga.PropertyNode:Ga.PropertyNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R){pb._get(Object.getPrototypeOf(mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);var qa=R.spec,Va=R.target;this.partition=R.partition;this.target=Va;this.spec=qa;this.foldedNodes={}}},{key:"__deserialize__",value:function(R,qa){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(R){this._interactive=
R}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(R){return this.isFoldable?this.getFoldedContext(R):pb._get(Object.getPrototypeOf(mb.prototype),"getSubNode",this).call(this,R)}},{key:"getFoldedContext",value:function(R){return this.foldedNodes[R.key]=new sc.FoldedNode(Object.assign({},R,{root:this.root,target:this.target,foldableNode:this,spec:sc.obj.dissoc(this.spec,
["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(R,qa){(qa=void 0===qa?!1:qa)&&(this.target[this.key]=R);this.value=this.target[this.key];this.valueString=sc.printValue(this.value);this.interactive&&(qa||this._propertyWidget.highlight());if(this.isFoldable)for(var Va in this.foldedNodes)this.foldedNodes[Va].value=this.value[Va],this.foldedNodes[Va].valueString=sc.printValue(this.value[Va]),this.foldedNodes[Va]._propertyWidget&&
sc.signal(this.foldedNodes[Va]._propertyWidget,"update",this.value[Va])}},{key:"display",value:function(R){var qa=this,Va=this._propertyWidget,eb=this.keyString,dc=this.valueString,bc=this.target,Ec=this.value,Nc=this.spec;if(!(this.interactive||Nc.foldable&&sc.isMultiValue(Ec,Nc.foldable)))return R.renderPropertyControl({target:bc,keyString:eb,valueString:dc,tree:R.ui.propertyTree,value:Ec,spec:Nc,node:this,fastRender:!0});if(Va)return Va.keyString=eb,Va.valueString=dc,Va.isSelected=this.isSelected,
Va.control&&(Va.control.isSelected=this.isSelected),Va;Va=this._propertyWidget=R.renderPropertyControl({target:bc,keyString:eb,valueString:dc,value:Ec,spec:Nc,node:this,isSelected:this.isSelected,fontColor:R.ui.propertyTree.fontColor});this.isInternalProperty||Nc.readOnly||(sc.connect(Va,"propertyValue",this,"refreshProperty",{updater:function(yc,ve){return yc(ve,!0)}}),sc.connect(Va,"openWidget",this.root,"onWidgetOpened",{converter:function(yc){return{widget:yc,node:qa.sourceObj}}}));return Va}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Ga,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(sc.InspectionNode);(function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),mb=Ga.hasOwnProperty("FoldedNode")&&
"function"===typeof Ga.FoldedNode?Ga.FoldedNode:Ga.FoldedNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R){pb._get(Object.getPrototypeOf(mb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);this.foldableNode=R=R.foldableNode;this.foldedProp=R.key+sc.string.capitalize(this.key)}},{key:"refreshProperty",value:function(R,
qa){qa=void 0===qa?!1:qa;var Va={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Va[this.key]=R,Va)),qa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Ga,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,
end:18928})})(sc.PropertyNode);var Wd=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Wd.Color=jb;var Ie=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),mb=Ga.hasOwnProperty("DarkTheme")&&"function"===typeof Ga.DarkTheme?Ga.DarkTheme:Ga.DarkTheme=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:"background",get:function(){return Wd.Color.rgb(44,62,
80)}},{key:"cursorColor",get:function(){return Wd.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},
{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Wd.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Wd.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Wd.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},
{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},
{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Wd.Color.white,fontWeight:"bold",backgroundColor:Wd.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Wd.Color.rgba(204,
204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Wd.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ga,{pathInPackage:function(){return"themes/dark.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),Ke=Ie=Wd.DarkTheme;Wd.default=Ie;var Db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Db.inspect=hc;Db.remoteInspect=Ed;Db.generateReferenceExpression=Ac;Db.onNumberDragStart=function(ua,Ga){Ga.initPos=ua.position;Ga.factorLabel=(new Db.Tooltip({description:"1x"})).openInWorld(ua.hand.position.addXY(10,
10))};Db.onNumberDrag=function(ua,Ga){var mb=Db.getScaleAndOffset(ua,Ga),R=mb.scale;mb=mb.offset;Ga.factorLabel.position=ua.hand.position.addXY(10,10);Ga.factorLabel.description=R+"x";return Db.getCurrentValue(mb,R,Ga)};Db.onNumberDragEnd=function(ua,Ga){var mb=Db.getScaleAndOffset(ua,Ga);ua=mb.offset;mb=mb.scale;Ga.factorLabel.softRemove();return Db.getCurrentValue(ua,mb,Ga)};Db.getScaleAndOffset=function(ua,Ga){var mb=ua.position.subPt(Ga.initPos);ua=mb.x;Ga=Db.num.roundTo(Math.exp(-mb.y/$world.height*
6),.01)*Ga.baseFactor;return{offset:ua,scale:Ga}};Db.getCurrentValue=function(ua,Ga,mb){return Math.max(mb.min,Math.min(mb.max,mb.scrubbedValue+(mb.floatingPoint?ua*Ga:Math.round(ua*Ga))))};Db.Color=jb;Db.Rectangle=Jb;Db.rect=Fd;Db.pt=jd;Db.obj=be;Db.num=qc;Db.Path=fc;Db.arr=Ub;Db.promise=ic;Db.connect=Cc;Db.disconnect=Ab;Db.once=Sb;Db.Morph=jc;Db.Tooltip=Bc;Db.VerticalLayout=ad;Db.GridLayout=bd;Db.HorizontalLayout=ob;Db.morph=uc;Db.CustomLayout=kb;Db.Label=tb;Db.Icon=Aa;Db.StyleSheet=wc;Db.config=
Fa;Db.Tree=Ba;Db.LoadingIndicator=wa;Db.DropDownList=Na;Db.DropDownSelector=La;Db.SearchField=Wa;Db.LabeledCheckBox=Gb;Db.MorphHighlighter=ba;Db.InteractiveMorphSelector=xa;Db.printValue=Ud;Db.RemoteInspectionTree=he;Db.InspectionTree=Zd;Db.isMultiValue=sd;Db.valueWidgets=M;Db.popovers=ha;Db.DarkTheme=Ke;Db.DefaultTheme=Ha;Db.syncEval=Rb;Db.inspectorCommands=[{name:"focus codeEditor",exec:function(ua){ua.get("codeEditor").show();ua.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(ua){ua.get("propertyTree").show();
ua.get("propertyTree").focus();return!0}}];(function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),mb=Ga.hasOwnProperty("DraggedProp")&&"function"===typeof Ga.DraggedProp?Ga.DraggedProp:Ga.DraggedProp=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:"applyToTarget",value:function(R){var qa=this.currentTarget,Va=this.control;this.remove();Db.MorphHighlighter.removeHighlighters(R.world);
if(qa)if(qa.isText&&"js"===qa.editorModeName){var eb=qa.evalEnvironment.context;R=qa.textPositionFromPoint(qa.localize(R.position));eb=Db.generateReferenceExpression(this.sourceObject,{fromMorph:eb});Va.keyString&&(eb+="."+Va.keyString);qa.insertTextAndSelect(eb,R);qa.focus()}else"propertyValue"in Va&&(qa[Va.keyString]=Va.propertyValue)}},{key:"update",value:function(R){R=R.hand.globalPosition;var qa=this.morphBeneath(R);if(qa){for(qa==this.morphHighlighter&&(qa=qa.morphBeneath(R));[qa].concat($jscomp.arrayFromIterable(qa.ownerChain())).find(function(Va){return!Va.visible});)qa=
qa.morphBeneath(R);if(qa!=this.currentTarget){this.currentTarget=qa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(qa.isWorld)return;this.morphHighlighter=Db.MorphHighlighter.for($world,qa);this.morphHighlighter.show()}this.position=R}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Db.Color.rgb(169,204,227)},fill:{defaultValue:Db.Color.rgb(235,245,251).withA(.8)},
borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var R=this.control;if(!R)return this.submorphs=[];this.height=22;this.submorphs=[R];R.top=0;R.fontSize=14;"function"===typeof R.relayout&&R.relayout();this.width=R.width+20;this.adjustOrigin(Db.pt(10,10))}}}}}],Ga,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3714})})(Db.Morph);(function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),mb=Ga.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Ga.DraggableTreeLabel?Ga.DraggableTreeLabel:Ga.DraggableTreeLabel=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:"inspector",get:function(){return this.owner.owner}},
{key:"onDragStart",value:function(R){this.draggedProp=new Db.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Db.connect(R.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(R){}},{key:"onDragEnd",value:function(R){Db.disconnect(R.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(R)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},
draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Db.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:Db.Color.transparent},padding:{defaultValue:Db.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(R){this.setProperty("isSelected",R);R?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=
R)}}}}}],Ga,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3716,end:5055})})(Db.Label);Zd=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),mb=Ga.hasOwnProperty("PropertyControl")&&"function"===typeof Ga.PropertyControl?Ga.PropertyControl:Ga.PropertyControl=
function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(R,qa,Va){R.control=new Db.DropDownSelector({opacity:.8,fill:Db.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:qa,padding:0,values:Va});Db.connect(R.control,"update",R,"propertyValue",{updater:function(eb,dc){this.targetObj.propertyValue!=
dc&&eb(dc)}});Db.connect(R,"update",R.control,"selectedValue",{updater:function(eb,dc){dc=dc&&dc.valueOf?dc.valueOf():dc;this.targetObj.propertyValue!=dc&&eb(dc)}});return R}},{key:"toggleMultiValuePlaceholder",value:function(R){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:Db.Color.transparent,layout:new Db.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:Db.arr.range(0,2).map(function(qa){return{type:"ellipse",fill:Db.Color.gray.withA(.5),
reactsToPointer:!1,extent:Db.pt(7,7)}})});R?(Db.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(Db.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(R){this.foldableProperties&&this.toggleMultiValuePlaceholder(Db.isMultiValue(R,
this.foldableProperties))}},{key:"asFoldable",value:function(R){this.foldableProperties=R;Db.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+
": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var R=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});R.isLayoutable=!1;R.fontWeight="bold";R.fontColor=Db.Color.orange;R.reactsToPointer=!1;R.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],
derived:!0,get:function(){return this.submorphs[0]||!1},set:function(R){this.submorphs=[R]}},layout:{initialize:function(){this.layout=new Db.CustomLayout({relayout:function(R){R.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(R){return(R=R.value)&&(R.isColor||R.isGradient)?"Color":R&&R.isPoint?"Point":Db.obj.isBoolean(R)?"Boolean":Db.obj.isNumber(R)?"Number":Db.obj.isString(R)?"String":R&&R.isRectangle?"Rectangle":
!1}},{key:"render",value:function(R){R.spec.type||(R.spec=Object.assign({},R.spec,{type:this.inferType(R)}));switch(R.spec.type){case "Color":var qa=this.renderColorControl(R);break;case "ColorGradient":qa=this.renderColorControl(Object.assign({},R,{gradientEnabled:!0}));break;case "Number":qa=this.renderNumberControl(R);break;case "String":qa=this.renderStringControl(R);break;case "RichText":qa=this.renderStringControl(R);break;case "Layout":qa=this.renderLayoutControl(R);break;case "Enum":qa=this.renderEnumControl(R);
break;case "Shadow":qa=this.renderShadowControl(R);break;case "Point":qa=this.renderPointControl(R);break;case "Rectangle":qa=this.renderRectangleControl(R);break;case "Boolean":qa=this.renderBooleanControl(R);break;default:qa=this.renderItSomehow(R)}qa.control&&(Db.connect(qa.control,"openWidget",qa,"openWidget"),qa.toggleFoldableValue(R.value));return qa}},{key:"baseControl",value:function(R){var qa=R.spec;R=new this({keyString:R.keyString,valueString:R.valueString,isSelected:!1,propertyValue:R.value});
qa.foldable&&R.asFoldable(qa.foldable);return R}},{key:"renderGrabbableKey",value:function(R){var qa=this,Va=R.target;return[R.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(eb){eb.state.draggedProp=new Db.DraggedProp({sourceObject:Va,control:qa.baseControl(R)});eb.state.draggedProp.openInWorld();Db.connect(eb.hand,"update",eb.state.draggedProp,"update")},onDrag:function(eb){},onDragEnd:function(eb){Db.disconnect(eb.hand,"update",eb.state.draggedProp,"update");eb.state.draggedProp.applyToTarget(eb)}}]}},
{key:"renderEnumControl",value:function(R){var qa=R.value,Va=R.spec.values,eb=R.keyString,dc=R.target,bc=R.node,Ec=function(Nc,yc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ve){dc.world().openWorldMenu(Nc,Va.map(function(of){return{string:of.toString(),action:function(){dc[eb]=of;bc.rerender()}}}));ve.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(qa?qa.valueOf?qa.valueOf():qa:"Not set"),{nativeCursor:"pointer",onMouseDown:Ec}],$jscomp.arrayFromIterable(Db.Icon.textAttribute("angle-down",
{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:Ec})))}},{key:"renderStringControl",value:function(R){var qa=R.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(200<qa.length?qa.slice(0,20)+"...":qa),{fontColor:Db.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(R){var qa=R.value,Va=R.keyString,eb=R.valueString,dc=R.target,bc=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+eb,{fontColor:Db.Color.black,
nativeCursor:"pointer",onMouseDown:function(Ec){var Nc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){if(1==yc.nextAddress)return Nc=new Db.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:qa}),Nc.relayout(),yc.yield(Nc.fadeIntoWorld(Ec.positionIn(dc.world())),2);Db.connect(Nc,"rectangle",function(ve){dc[Va]=ve;bc.rerender()});yc.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(R){var qa=R.value,Va=R.keyString,eb=R.valueString,dc=R.target,bc=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),
[" "+eb,{nativeCursor:"pointer",fontColor:qa?Db.Color.green:Db.Color.red,onMouseDown:function(Ec){dc[Va]=!dc[Va];bc.rerender()}}])}},{key:"renderNumberControl",value:function(R){var qa=R.value,Va=R.spec,eb=R.keyString,dc=R.valueString,bc=R.node,Ec=R.target,Nc=R.tree,yc=void 0===bc._numberControls?new Lf:bc._numberControls,ve=$jscomp.makeIterator(yc.submorphs),of=ve.next().value,af=ve.next().value;yc.fontColor=Nc.fontColor;var we=bc._numberControls=yc;"max"in Va&&"min"in Va&&-Infinity!=Va.min&&Infinity!=
Va.max?(we.baseFactor=(Va.max-Va.min)/100,we.floatingPoint=Va.isFloat,we.max=Va.max,we.min=Va.min):(we.floatingPoint=Va.isFloat,we.baseFactor=.5,we.min=void 0!=Va.min?Va.min:-Infinity,we.max=void 0!=Va.max?Va.max:Infinity);var eh=Db.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),$jscomp.arrayFromIterable(bc._inputMorph?[bc._inputMorph,{}]:[" "+(void 0!=qa&&(qa.valueOf?qa.valueOf():qa).toFixed(Va.isFloat?3:0))+" ",{fontColor:eh,
onMouseUp:function(Dg){bc._inputMorph=Db.morph({type:"input",fill:null,fontColor:eh,fontFamily:"IBM Plex Mono",fontSize:14,padding:Db.rect(8,2,-6,2),height:23,cursorColor:Db.Color.white,value:qa.valueOf?qa.valueOf():dc});Ec[eb]=qa;bc._inputMorph.focus();Db.once(bc._inputMorph,"inputAccepted",function(pi){delete bc._inputMorph;Ec[eb]=Va.isFloat?Number.parseFloat(pi):Number.parseInt(pi);bc.rerender()});Db.once(bc._inputMorph,"onBlur",function(pi){bc._inputMorph&&(delete bc._inputMorph,Ec[eb]=qa,bc.rerender())});
bc.rerender()},onDragStart:function(Dg){we.scrubbedValue=qa;Db.onNumberDragStart(Dg,we)},onDrag:function(Dg){Ec[eb]=Db.onNumberDrag(Dg,we);bc.rerender()},onDragEnd:function(Dg){return Db.onNumberDragEnd(Dg,we)}},yc,{onMouseUp:function(){of.fill=af.fill=null},onMouseDown:function(Dg){if(Dg.targetMorph===of){of.fill=Db.Color.white.withA(.2);if("max"in Va&&Ec[eb]>=Va.max)return;Ec[eb]+=1}if(Dg.targetMorph===af){af.fill=Db.Color.white.withA(.2);if("min"in Va&&Ec[eb]<=Va.min)return;--Ec[eb]}bc.rerender()}}]))}},
{key:"renderShadowControl",value:function(R){var qa=R.keyString,Va=R.value,eb=R.target,dc=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[""+(Va?Va.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(bc){var Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){if(1==Nc.nextAddress)return Ec=new Db.popovers.ShadowPopover({shadowValue:eb[qa],hasFixedPosition:!0}),Nc.yield(Ec.fadeIntoWorld(bc.positionIn(eb.world())),2);Db.connect(Ec,"shadowValue",
function(yc){eb[qa]=yc;dc.rerender()});Nc.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(R){var qa=R.keyString,Va=R.value,eb=R.target,dc=R.node,bc=Db.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Ec={nativeCursor:"pointer",onMouseDown:function(Nc){var yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ve){if(1==ve.nextAddress)return yc=new Db.popovers.PointPopover({pointValue:eb[qa],hasFixedPosition:!0}),ve.yield(yc.fadeIntoWorld(Nc.positionIn(eb.world())),
2);Db.connect(yc,"pointValue",function(of){eb[qa]=of;dc.rerender()});ve.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" pt(",Object.assign({},Ec),""+Va.x.toFixed(),Object.assign({fontColor:bc},Ec),",",Object.assign({},Ec),""+Va.y.toFixed(),Object.assign({fontColor:bc},Ec),")",Object.assign({},Ec)])}},{key:"renderLayoutControl",value:function(R){var qa=R.valueString,Va=R.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(Va?qa:
"No Layout"),{onMouseDown:function(eb){}}])}},{key:"renderColorControl",value:function(R){var qa=R.node,Va=R.gradientEnabled,eb=R.valueString,dc=R.keyString,bc=R.value,Ec=R.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[Db.morph({fill:bc.valueOf?bc.valueOf():bc,extent:Db.pt(15,15),borderColor:Db.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(bc?bc.valueOf?bc.valueOf():eb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Nc){var yc;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(ve){if(1==ve.nextAddress)return yc=new Db.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Ec,fillValue:bc,title:"Fill Control",gradientEnabled:Va}),ve.yield(yc.fadeIntoWorld(Nc.positionIn(Ec.world())),2);Db.connect(yc,"fillValue",function(of){Ec[dc]=of;qa.rerender()});ve.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(R){var qa=R.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+qa,{}])}}],
Ga,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5064,end:20370})}(Db.DraggableTreeLabel);Db.PropertyControl=Zd;Db.PropertyControl=Zd;Db.PropertyControl=Zd;Db.inspect=hc;Db.inspect=hc;Db.remoteInspect=Ed;Db.remoteInspect=Ed;Db.generateReferenceExpression=Ac;Db.generateReferenceExpression=
Ac;var Lf=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),mb=Ga.hasOwnProperty("NumberControls")&&"function"===typeof Ga.NumberControls?Ga.NumberControls:Ga.NumberControls=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=
new Db.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Db.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(R){this.submorphs.map(function(qa){return qa.fontColor=R})}},submorphs:{initialize:function(){this.submorphs=[Db.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Db.rect(5,2,0,-6),fontSize:12}),Db.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Db.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",
fontSize:12})]}}}}}],Ga,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23043,end:24088})}(Db.Morph);(function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),mb=Ga.hasOwnProperty("PropertyTree")&&"function"===typeof Ga.PropertyTree?Ga.PropertyTree:Ga.PropertyTree=
function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:"onDrag",value:function(R){this._onDragHandler&&this._onDragHandler(R)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Ga,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:25253,end:25364})})(Db.Tree);Zd=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),mb=Ga.hasOwnProperty("Inspector")&&"function"===typeof Ga.Inspector?Ga.Inspector:Ga.Inspector=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},
{key:"onMouseMove",value:function(R){}},{key:"__after_deserialize__",value:function(R,qa,Va){var eb=this,dc=new Db.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Db.InspectionTree.forObject(null,this)}));this.addMorph(dc,this.getSubmorphNamed("terminal toggler"));pb._get(Object.getPrototypeOf(mb.prototype),"__after_deserialize__",this).call(this,R,qa,Va);!this.isComponent&&this.master.whenApplied().then(function(){eb.layout.col(0).row(1).group.morph=dc;eb.targetObject&&
(eb.targetObject=eb.targetObject)})}},{key:"__additionally_serialize__",value:function(R,qa,Va,eb){R=R.props.submorphs.value;for(qa=R.length;qa--;)Va.refForId(R[qa].id).realObj==this.ui.propertyTree&&Db.arr.removeAt(R,qa)}},{key:"renderDraggableTreeLabel",value:function(R){return new Db.DraggableTreeLabel(R)}},{key:"renderPropertyControl",value:function(R){return Db.PropertyControl.render(R)}},{key:"onLoad",value:function(){var R=this.ui,qa=R.codeEditor,Va=R.thisBindingSelector,eb=R.propertyTree;
qa.changeEditorMode("js").then(function(){return qa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Va.selection?qa.owner.selectedContext:qa.owner.targetObject},get systemInterface(){return Db.Path("treeData.systemInterface").get(eb)},format:"esm"}}).catch(function(dc){return $world.logError(dc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(R){pb._get(Object.getPrototypeOf(mb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,R);R=this.ui;var qa=R.targetPicker,Va=R.propertyTree,eb=R.resizer,dc=R.terminalToggler,bc=R.unknowns,Ec=R.internals,Nc=R.searchField,yc=R.codeEditor,ve=R.fixImportButton,of=R.thisBindingSelector;yc.changeEditorMode("js").then(function(){return yc.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==of.selection?yc.owner.selectedContext:yc.owner.targetObject},get systemInterface(){return Va.treeData.systemInterface},format:"esm"}}).catch(function(af){return $world.logError(af)});
Db.connect(qa,"onMouseDown",this,"selectTarget");Db.connect(Va,"onScroll",this,"repositionOpenWidget");Db.connect(eb,"onDrag",this,"adjustProportions");Db.connect(dc,"onMouseDown",this,"toggleCodeEditor");Db.connect(bc,"trigger",this,"filterProperties");Db.connect(Ec,"trigger",this,"filterProperties");Db.connect(Nc,"searchInput",this,"filterProperties");Db.connect(Va,"nodeCollapseChanged",this,"filterProperties");Db.connect(this,"extent",this,"relayout");Db.connect(of,"selection",this,"bindCodeEditorThis");
Db.connect(ve,"fire",yc,"execCommand",{updater:function(af){return af("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var R=this.ui.propertyTree.selectedIndex-1,qa=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();qa=this.ui.propertyTree.document.getLine(R).textAndAttributes.slice(0,4).concat(qa.display(this));R=this.ui.propertyTree.lineRange(R,!1);this.ui.propertyTree.replace(R,qa,!1,!1,!1);
this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var R=Db.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(R!=this.lastChange||this.lastSubmorphs!=Db.printValue(this.targetObject&&
this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==R.prop&&this.repositionOpenWidget(),this.lastChange=R,this.lastSubmorphs=Db.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var R;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(qa){qa=qa.node;qa.target&&(R=qa.foldableNode?qa.target[qa.foldableNode.key][qa.key]:qa.target[qa.key],!Db.obj.equals(R,
qa.value)&&qa.refreshProperty&&qa.refreshProperty(R))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(R,qa){qa=void 0===qa?!1:qa;var Va=this,eb,dc,bc,Ec,Nc,yc,ve,of,af,we,eh,Dg,pi,Tg,zj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wf){switch(wf.nextAddress){case 1:if(!Va.isUpdating()){wf.jumpTo(2);break}return wf.yield(Va.whenUpdated(),2);case 2:eb=
Db.promise.deferred();dc=eb.promise;bc=!!Va.target;Va.updateInProgress=dc;wf.setCatchFinallyBlocks(4);qa&&(Ec=Db.LoadingIndicator.open("connecting to remote..."));if(!qa){Nc=Db.InspectionTree.forObject(R,Va);wf.jumpTo(6);break}return wf.yield(Db.RemoteInspectionTree.forObject(R,Va),7);case 7:Nc=wf.yieldResult;case 6:return yc=Nc,ve=Va.ui.propertyTree,wf.yield(yc.collapse(yc.root,!1),8);case 8:if(!yc.root.children){wf.jumpTo(9);break}return wf.yield(yc.collapse(yc.root.children[0],!1),9);case 9:if(of=
Va.originalTreeData&&Va.originalTreeData.diff(yc)){af=$jscomp.makeIterator(of);for(we=af.next();!we.done;we=af.next())eh=we.value,Dg=$jscomp.makeIterator(eh),pi=Dg.next().value,Tg=Dg.next().value,pi.refreshProperty(Tg.value);wf.jumpTo(11);break}ve.treeData=yc;return wf.yield(Va.filterProperties(),12);case 12:if(!ve.treeData.root.isCollapsed){wf.jumpTo(13);break}return wf.yield(ve.onNodeCollapseChanged({node:yc.root,isCollapsed:!1}),14);case 14:ve.selectedIndex=1;case 13:return wf.yield(ve.execCommand("uncollapse selected node"),
11);case 11:Va.toggleWindowStyle(bc);Ec&&Ec.remove();wf.leaveTryBlock(5);break;case 4:zj=wf.enterCatchBlock(),Va.showError(zj);case 5:Va.startStepping(1E3,"refreshAllProperties"),Va.updateInProgress=null,wf.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(R){R=void 0===R?!0:R;var qa=this,Va,eb,dc,bc,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){if(1==Nc.nextAddress)return Va=300,bc=qa.ui.codeEditor.pluginFind(function(yc){return yc.runEval}),Ec=qa.getWindow(),Nc.yield(bc.runEval("System.get('@system-env').node"),
2);Nc.yieldResult.value?(dc=[].concat($jscomp.arrayFromIterable(Db.arr.without(Ec.styleClasses,"local")),["node"]),eb=Db.DarkTheme.instance):(dc=["local"].concat($jscomp.arrayFromIterable(Ec?Db.arr.without(Ec.styleClasses,"node"):[])),eb=Db.DefaultTheme.instance);bc.theme=eb;R?(Ec&&Ec.animate({duration:Va,styleClasses:dc}),qa.ui.codeEditor.animate({fill:eb.background,duration:Va})):Ec&&(Ec.styleClasses=dc);qa.ui.codeEditor.textString=qa.ui.codeEditor.textString;bc.highlight();Nc.jumpToEnd()})}},{key:"isUpdating",
value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var R=this,qa=Object.assign({type:"text",borderWidth:1,borderColor:Db.Color.gray,lineWrapping:"by-chars"},Db.config.codeEditor.defaultStyle,{textString:""}),Va=Db.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Db.rect(0,0,this.width,30);var eb=new Db.SearchField({styleClasses:["idle"],
name:"searchField"});Va[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[eb,{type:"button",name:"targetPicker",padding:Db.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Db.Icon.textAttribute("crosshairs")},new Db.LabeledCheckBox({label:"Internals",name:"internals"}),new Db.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Db.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Db.InspectionTree.forObject(null,
this)})),Db.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},qa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Db.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Va),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Va),[" selection",null])}]}];
this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){R.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var R=this,qa,Va,eb,dc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bc){switch(bc.nextAddress){case 1:if(R.env.eventDispatcher.isKeyPressed("Shift"))return Va=$jscomp,eb=Va.makeIterator,bc.yield($world.execCommand("select morph",{justReturn:!0}),
5);R.toggleSelectionInstructions(!0);return bc.yield(Db.InteractiveMorphSelector.selectMorph(),4);case 4:qa=bc.yieldResult;R.toggleSelectionInstructions(!1);bc.jumpTo(3);break;case 5:dc=eb.call(Va,bc.yieldResult),qa=dc.next().value;case 3:qa&&(R.targetObject=qa),bc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(R){if(R&&!this.instructionWidget){var qa=Db.morph({type:"label",name:"escapeKey",value:"esc"});qa.whenRendered().then(function(){return qa.fit()});this.instructionWidget=
this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},qa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(R){R=
R.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;R.epiMorph=!0;this.openWidget=R;Db.once(R,"close",this,"closeOpenWidget");Db.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var R=this.ui.propertyTree,qa=R.textLayout.boundsFor(R,{column:0,row:R.selectedIndex-1});qa=R.worldPoint(Db.pt(qa.x,qa.y+qa.height/2)).addPt(R.scroll.negated());R=R.globalBounds();qa.x=this.globalBounds().center().x;
qa.y<R.top()?qa=R.topCenter():R.bottom()-20<qa.y&&(qa=R.bottomCenter().addXY(0,-20));return qa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(R){this.layout.row(1).height+=R.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(R){if(R!==this.isEditorVisible()){var qa=this.extent,
Va=this.layout,eb=this.ui,dc=eb.terminalToggler,bc=eb.codeEditor,Ec=eb.thisBindingSelector;eb=eb.fixImportButton;Va.disable();R?(dc.fontColor=Db.Color.rgbHex("00e0ff"),Va.row(3).height=this.codeEditorHeight||180,Va.row(2).height=5,eb.animate({visible:!0,duration:200}),Ec.animate({visible:!0,duration:200})):(this.codeEditorHeight=Va.row(3).height,dc.fontColor=Db.Color.white,Va.row(3).height=Va.row(2).height=0,eb.animate({visible:!1,duration:200}),Ec.animate({visible:!1,duration:200}));this.extent=
qa;Va.enable({duration:200});this.relayout({duration:200});bc.focus();bc.animate({opacity:R?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var R=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qa){R.makeEditorVisible(!R.isEditorVisible());qa.jumpToEnd()})}},{key:"filterProperties",value:function(){var R=this,qa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return qa=R.ui.searchField,Va=R.ui.propertyTree,R.originalTreeData||
(R.originalTreeData=Va.treeData),Db.disconnect(Va.treeData,"onWidgetOpened",R,"onWidgetOpened"),eb.yield(Va.treeData.filter({maxDepth:2,showUnknown:R.ui.unknowns.checked,showInternal:R.ui.internals.checked,iterator:function(dc){return qa.matches(dc.key)}}),2);Va.update();Db.connect(Va.treeData,"onWidgetOpened",R,"onWidgetOpened");eb.jumpToEnd()})}},{key:"relayout",value:function(R){R=void 0===R?{}:R;var qa=this,Va,eb,dc,bc,Ec,Nc,yc,ve,of;return $jscomp.asyncExecutePromiseGeneratorProgram(function(af){qa.layout&&
qa.layout.forceLayout();Va=qa;eb=Va.ui;dc=eb.fixImportButton;bc=eb.terminalToggler;Ec=eb.propertyTree;Nc=eb.thisBindingSelector;yc=Ec.bounds().insetBy(5).bottomLeft();ve=Ec.bounds().insetBy(5).bottomRight();of=ve.subXY(dc.width+10,0);Nc.width=115;Nc.listMorph.itemHeight=20;R.duration?(bc.animate(Object.assign({bottomLeft:yc},R)),dc.animate(Object.assign({bottomRight:ve},R)),Nc.animate(Object.assign({bottomRight:of},R))):(bc.bottomLeft=yc,dc.bottomRight=ve,Nc.bottomRight=of);af.jumpToEnd()})}},{key:"keybindings",
get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(pb._get(Object.getPrototypeOf(mb.prototype),"keybindings",this))}},{key:"commands",get:function(){return Db.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(R){if(System._testsRunning)return console.log(R.targetObject);
R=new this(R);R.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return R}},{key:"properties",get:function(){return{extent:{defaultValue:Db.pt(400,500)},fill:{defaultValue:Db.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(R){this.setProperty("remoteTarget",R);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(R,!0))}},targetObject:{after:["submorphs"],set:function(R){this._serializableTarget=
R&&R.isMorph?R.id:R;this.setProperty("targetObject",R);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(R))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var R=this.ui.propertyTree,qa=R.treeData;return qa.getContextFor(R.selectedNode||qa.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),
fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},
treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Db.Color.gray,fontSize:14,fontFamily:Db.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Ga,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:25381,end:45915})}(Db.Morph);Zd=Db.Inspector;he=ra("I",Zd);Db.default=Zd;var xe=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");xe.Inspector=he;xe.string=Mc;xe.Morph=jc;xe.pt=jd;xe.Color=jb;Zd=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(ua,Ga,mb){mb=void 0===mb?1:mb;var R,qa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){switch(eb.nextAddress){case 1:return ua.maybeSelectCommentOrLine(),
eb.setCatchFinallyBlocks(2),Ga=Object.assign({},Ga,{logDoit:!0,inspect:!0,inspectDepth:mb}),eb.yield(ua.doEval(void 0,Ga),4);case 4:R=eb.yieldResult;qa=R.error?R.error:R.isError?R.value:null;eb.leaveTryBlock(3);break;case 2:qa=Va=eb.enterCatchBlock();case 3:return qa?ua.showError(qa):ua.setStatusMessage(xe.string.truncate(R.value,1E3)),eb.return(R)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(ua,Ga){var mb,R,qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Va){switch(Va.nextAddress){case 1:return Va.setCatchFinallyBlocks(2),
Va.yield(ua.doEval({start:{row:0,column:0},end:ua.documentEndPosition},Object.assign({},Ga,{logDoit:!0})),4);case 4:mb=Va.yieldResult;R=mb.error?mb.error:mb.isError?mb.value:null;Va.leaveTryBlock(3);break;case 2:R=qa=Va.enterCatchBlock();case 3:return R?ua.showError(R):ua.setStatusMessage(String(mb.value)),Va.return(mb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(ua,Ga){var mb,R,qa,Va,eb,dc,bc,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){switch(Nc.nextAddress){case 1:return ua.maybeSelectCommentOrLine(),
Nc.setCatchFinallyBlocks(2),Ga=Object.assign({},Ga,{asString:!1,logDoit:!0}),Nc.yield(ua.doEval(void 0,Ga),4);case 4:mb=Nc.yieldResult;R=mb.error?mb.error:mb.isError?mb.value:null;Nc.leaveTryBlock(3);break;case 2:R=qa=Nc.enterCatchBlock();case 3:ua.selection.collapseToEnd();if(Va=mb.value&&mb.value.isColor)return ua.selection.text=String(mb.value),eb=new xe.Morph({fill:xe.Color.transparent,extent:xe.pt(ua.fontSize+2,ua.fontSize+2),submorphs:[{fill:mb.value,center:xe.pt(ua.fontSize+2,ua.fontSize+2).scaleBy(.5)}]}),
dc=ua.selection.start,bc=dc.column,Ec=dc.row,ua.insertText([eb,{}],ua.selection.start),ua.selection.start={column:bc,row:Ec},ua.focus(),Nc.return(mb);ua.insertTextAndSelect(R?String(R)+(R.stack?"\n"+R.stack:""):String(mb.value));ua.focus();return Nc.return(mb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(ua,Ga){var mb,R,qa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){switch(eb.nextAddress){case 1:ua.maybeSelectCommentOrLine();
R=ua.textInRange(ua.selection);qa=ua.evalEnvironment||{};Va=ua.pluginFind(function(dc){return dc.isEditorPlugin&&"function"===typeof dc.runEval});qa.systemInterface||(qa.systemInterface=Va.systemInterface(Ga));if("local"!==qa.systemInterface.name){eb.jumpTo(2);break}eb.setCatchFinallyBlocks(3);return eb.yield(ua.doEval(void 0,Ga),5);case 5:mb=eb.yieldResult;R=mb.value;eb.leaveTryBlock(2);break;case 3:eb.enterCatchBlock();case 2:return ua.world().execCommand("open object editor",{target:R,evalEnvironment:qa}),
eb.return(mb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(ua,Ga){var mb,R,qa,Va,eb,dc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bc){switch(bc.nextAddress){case 1:ua.maybeSelectCommentOrLine();qa=ua.textInRange(ua.selection);Va=ua.evalEnvironment||{};eb=ua.pluginFind(function(Ec){return Ec.isEditorPlugin&&"function"===typeof Ec.runEval});Va.systemInterface||(Va.systemInterface=eb.systemInterface(Ga));if("local"!==
Va.systemInterface.name){xe.Inspector.openInWindow({remoteTarget:{code:qa,evalEnvironment:Va}});bc.jumpTo(2);break}bc.setCatchFinallyBlocks(3);return bc.yield(ua.doEval(void 0,Ga),5);case 5:mb=bc.yieldResult;R=mb.error?mb.error:mb.isError?mb.value:null;qa=mb.value;bc.leaveTryBlock(4);break;case 3:R=dc=bc.enterCatchBlock();case 4:xe.Inspector.openInWindow({targetObject:R||qa});case 2:return bc.return(mb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(ua,Ga,mb){mb=void 0===mb?1:mb;var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qa){switch(qa.nextAddress){case 1:return ua.maybeSelectCommentOrLine(),qa.setCatchFinallyBlocks(2),Ga=Object.assign({},Ga,{inspect:!0,inspectDepth:mb,logDoit:!0}),qa.yield(ua.doEval(void 0,Ga),4);case 4:R=qa.yieldResult;qa.leaveTryBlock(3);break;case 2:qa.enterCatchBlock();case 3:return ua.selection.collapseToEnd(),ua.insertTextAndSelect(R.value),qa.return(R)}})}}];xe.codeEvaluationCommands=
Zd;xe.codeEvaluationCommands=Zd;xe.codeEvaluationCommands=Zd;var tf=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");tf.changeAttributeInSelectionOrMorph=function(ua,Ga,mb){var R=ua.selection;ua.keepPosAtSameScrollOffsetWhile(function(){R.isEmpty()?ua[Ga]="function"===typeof mb?mb(ua[Ga]):mb:(ua.undoManager.group(),ua.changeStyleProperty(Ga,function(qa){return"function"===typeof mb?mb(qa):mb}),ua.undoManager.group())})};he=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(ua){var Ga=ua.fontSize;tf.changeAttributeInSelectionOrMorph(ua,"fontSize",function(mb){mb=mb||Ga;return mb+(18<=mb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(ua){var Ga=ua.fontSize;tf.changeAttributeInSelectionOrMorph(ua,"fontSize",function(mb){mb=mb||Ga;return mb-(18>=mb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(ua){var Ga,mb,R,qa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress){Ga=
["serif","sans-serif","monospace"];if(mb=localStorage["lively.morpic/text-change-font-additional-fonts"])mb=JSON.parse(mb),Ga.push.apply(Ga,$jscomp.arrayFromIterable(mb));Ga.map(function(dc){return dc.toLowerCase()}).includes(ua.fontFamily.toLowerCase())||(Ga.push(ua.fontFamily),mb=[].concat($jscomp.arrayFromIterable(mb||[]),[ua.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(mb));return eb.yield($world.editListPrompt("choose font",Ga,{requester:ua,preselect:Ga.indexOf(ua.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}R=eb.yieldResult;qa=$jscomp.makeIterator(R.selections);if(Va=qa.next().value)ua.fontFamily=Va;return eb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(ua,Ga){Ga=void 0===Ga?{}:Ga;var mb,R,qa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress){if(Ga.hasOwnProperty("link"))return eb.jumpTo(2);R=ua.selection;qa=ua.getStyleInRange(R);Va=qa.link;return eb.yield(ua.world().prompt("Set link",
{input:Va||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=eb.nextAddress&&(mb=eb.yieldResult,!mb))return eb.return();ua.undoManager.group();ua.setStyleInRange({link:mb||void 0},R);ua.undoManager.group();eb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(ua,Ga){var mb,R,qa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return mb=ua.selection,R=ua.getStyleInRange(mb),qa=R.doit,eb.yield(ua.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:ua,input:qa?qa.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:ua.evalEnvForDoit(qa||{})}),2);Va=eb.yieldResult;ua.undoManager.group();Va?ua.addTextAttribute({doit:{code:Va},nativeCursor:"pointer",textDecoration:"underline"},mb):ua.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},mb);ua.undoManager.group();eb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(ua,Ga){Ga=void 0===Ga?{}:Ga;ua.undoManager.group();
Ga=!Ga.onlySelection&&ua.selection.isEmpty()?ua.documentRange:ua.selection.range;ua.setStyleInRange(null,Ga);ua.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(ua){var Ga,mb,R,qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Va){if(1==Va.nextAddress)return Va.yield(System.import("lively.modules"),2);if(3!=Va.nextAddress)return Ga=Va.yieldResult,mb=Ga.module,Va.yield(mb("lively.ide/text/ui.js").load(),3);R=Va.yieldResult;qa=R.RichTextControl;return Va.return(qa.openFor(ua))})}}];
tf.commands=he;tf.commands=he;tf.commands=he;var ie=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");ie.guessTextModeName=Jd;ie.rangedToken=function(ua,Ga,mb,R,qa){return{start:{row:ua,column:Ga},end:{row:ua,column:mb},token:R,mode:qa}};ie.fun=Bb;ie.arr=Ub;ie.connect=Cc;ie.disconnect=Ab;ie.DefaultTheme=Ha;ie.tokenizeDocument=ab;ie.modeInfo=Ra;ie.visitDocumentTokens=xc;ie.getMode=ub;ie.completionCommands=H;ie.multiSelectCommands=sb;ie.navCommands=vc;ie.codeCommands=xd;ie.codeEvaluationCommands=
Zd;ie.richTextCommands=he;ie.Color=jb;ie.Range=re;ie.guessTextModeName=Jd;ie.guessTextModeName=Jd;Ha=function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),mb=Ga.hasOwnProperty("EditorPlugin")&&"function"===typeof Ga.EditorPlugin?Ga.EditorPlugin:Ga.EditorPlugin=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
ie.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(R){var qa=this;this.textMorph=R;ie.connect(R,"textChange",this,"onTextChange");ie.connect(R,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return qa.highlight()})}},
{key:"detach",value:function(R){ie.disconnect(R,"textChange",this,"onTextChange");ie.disconnect(R,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(R){this._ast=null;if(R){var qa=this._tokenizerValidBefore;if("replace"===R.selector){var Va=R.args[0].start;R=Va.row;Va=Va.column}else Va=R=0;if(!qa||R<qa.row||R===qa.row&&Va<qa.column)R=Math.max(0,R),this._tokenizerValidBefore={row:R,column:Va}}this.requestHighlight()}},
{key:"requestHighlight",value:function(R){var qa=this;(void 0===R?0:R)?this.highlight():ie.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return qa.highlight()})()}},{key:"highlight",value:function(){var R=this.textMorph,qa=this.theme,Va=this.mode,eb=this._tokenizerValidBefore;if(qa&&R&&R.document&&Va){R.fill=qa.background;R.cursorColor=qa.cursorColor||ie.Color.black;var dc=R.viewState,bc={};eb=ie.tokenizeDocument(Va,R.document,dc.firstVisibleRow,dc.lastVisibleRow,eb);Va=eb.lines;eb=
eb.tokens;if(Va.length){dc=Va[0].row;for(var Ec=[],Nc=0;Nc<eb.length;dc++,Nc++)for(var yc=eb[Nc],ve=0;ve<yc.length;ve+=5){var of=yc[ve],af=yc[ve+1],we=qa[yc[ve+2]]||qa.default;we&&Ec.push({start:{row:dc,column:of},end:{row:dc,column:af}},we)}R.embeddedMorphs.forEach(function(eh){var Dg=R.embeddedMorphMap.get(eh).anchor;bc[eh.id]=R.textAttributeAt(Dg.position)});R.setTextAttributesWithSortedRanges(Ec);R.embeddedMorphs.forEach(function(eh){var Dg=R.embeddedMorphMap.get(eh).anchor;Dg=ie.Range.at(Dg.position);
Dg.end.column+=1;R.replace(Dg,[eh,bc[eh.id]],!1)});this._tokenizerValidBefore={row:ie.arr.last(Va).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},R,this)}}},{key:"visitTokensInRange",value:function(R,qa){var Va=R.start,eb=R.end,dc=Va.row-1;ie.visitDocumentTokens(this.mode,this.textMorph.document,Va.row,eb.row,null,function(bc){return dc++},function(bc,Ec,Nc,yc,ve,of,af){if(dc===Va.row&&0<Va.column){if(Va.column>=yc)return;Nc<Va.column&&Va.column<yc&&(Nc=Va.column)}if(dc===eb.row){if(eb.column<=
Nc)return;Nc<eb.column&&eb.column<yc&&(yc=eb.column)}qa(bc,Ec,dc,Nc,yc,ve,of,af)})}},{key:"tokensInRange",value:function(R){var qa=[];this.visitTokensInRange(R,function(Va,eb,dc,bc,Ec,Nc,yc,ve){return qa.push(ie.rangedToken(dc,bc,Ec,Va,ve))});return qa}},{key:"tokensOfRow",value:function(R){var qa=this.textMorph.getLine(R).length;return this.tokensInRange({start:{row:R,column:0},end:{row:R,column:qa}})}},{key:"tokenAt",value:function(R){for(var qa=this.tokensOfRow(R.row),Va=qa.length;Va--;){var eb=
qa[Va];if(eb.token&&eb.start.column<=R.column&&R.column<=eb.end.column)return eb}return null}},{key:"getCommands",value:function(R){return[].concat($jscomp.arrayFromIterable(R),$jscomp.arrayFromIterable(ie.completionCommands),$jscomp.arrayFromIterable(ie.multiSelectCommands),$jscomp.arrayFromIterable(ie.navCommands),$jscomp.arrayFromIterable(ie.codeCommands),$jscomp.arrayFromIterable(ie.codeEvaluationCommands),$jscomp.arrayFromIterable(ie.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var R=this.mode,qa=R.lineComment,Va=R.blockCommentStart;R=R.blockCommentEnd;var eb={};qa&&(eb.lineCommentStart=qa);Va&&(eb.blockCommentStart=Va);R&&(eb.blockCommentEnd=R);return eb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(R,qa,Va){var eb=this.textMorph,dc=R.row,bc=R.column;R=qa[bc-1];qa=qa[bc];eb.selection.text="\n";eb.selection.collapseToEnd();"{"===R&&"}"===qa&&(eb.selection.text="\n"+" ".repeat(Va),eb.selection.collapse());
eb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:dc+1,lastRow:dc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var R=this.textMorph,qa=this.openPairs,Va=R.selection,eb=R.getLine(Va.end.row),dc=eb[Va.end.column-1];eb=eb[Va.end.column];R.autoInsertPairs&&Va.isEmpty()&&dc in
qa&&eb===qa[dc]&&(Va.growRight(1),Va.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(R){var qa=this.openPairs,Va=this.closePairs,eb=this.textMorph,dc=eb.selection,bc=eb.autoInsertPairs&&R in qa,Ec=eb.autoInsertPairs&&R in Va;if(!bc&&!Ec)return!1;var Nc=eb.getLine(dc.end.row)[dc.end.column];if(!dc.isEmpty()){if(!bc)return!1;Va=eb.undoManager.ensureNewGroup(eb);eb.insertText(qa[R],dc.end);eb.insertText(R,dc.start);eb.undoManager.group(Va);dc.growRight(-1);return!0}if(Nc in Va&&R===Nc)return dc.goRight(1),
!0;if(Ec&&!bc)return!1;Va=eb.undoManager.ensureNewGroup(eb);eb.insertText(R+qa[R]);eb.undoManager.group(Va);dc.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Ga,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);
Ra=Ha=ie.EditorPlugin;H=ra("C",function(ua){var Ga=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),mb=Ga.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Ga.CodeMirrorEnabledEditorPlugin?Ga.CodeMirrorEnabledEditorPlugin:Ga.CodeMirrorEnabledEditorPlugin=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return pb(mb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(){pb._get(Object.getPrototypeOf(mb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(R){this.mode=this.codeMirrorMode(R);return pb._get(Object.getPrototypeOf(mb.prototype),"attach",this).call(this,R)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(R){return{indentWithTabs:!R.useSoftTabs,indentUnit:R.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(R){R=this.defaultCodeMirrorModeConfig(R);
return ie.getMode(R,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Ga,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(ie.EditorPlugin));ie.CodeMirrorEnabledEditorPlugin=H;ie.CodeMirrorEnabledEditorPlugin=
H;ie.CodeMirrorEnabledEditorPlugin=H;ie.default=Ha;Ha=Object.freeze({__proto__:null,guessTextModeName:Jd,"default":Ra,CodeMirrorEnabledEditorPlugin:H});ra("e",Ha)}}});
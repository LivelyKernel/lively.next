System.register(["./__root_module__-884b54f8.js","./index-9ec474a0.js","./index-27557bc7.js"],function(za){var cb,mb,Pb,tb,Fc,vc,Qc,mc,ic,zc,Dc,Gd,Hd,Zd,xc,od,qb,kc,Uc,tc,cd,td,nb,cc,wc,dc,Nc,$a,Xa,Gb,ub,db,Xb,Fa,sb,Ya,pb,$b,lc,Jb,Cb,Bb,sa,Ta,O;return{setters:[function(U){cb=U.C;mb=U.i;Pb=U.a;tb=U.R;Fc=U.b;vc=U.m;Qc=U.br;mc=U.ay;ic=U.c;zc=U.s;Dc=U.ar;Gd=U.bz;Hd=U.bA;Zd=U.Y;xc=U.o;od=U.ac;qb=U.d;kc=U.bB;Uc=U.bC;tc=U.$;cd=U.P;td=U.p;nb=U._;cc=U.M;wc=U.T;dc=U.aa;Nc=U.ab;$a=U.af;Xa=U.az;Gb=U.O;ub=
U.I;db=U.g;Xb=U.bD;Fa=U.q;sb=U.bE;Ya=U.aE;pb=U.bs;$b=U.aD;lc=U.bF;Jb=U.f},function(U){Cb=U.M;Bb=U.I;sa=U.v;Ta=U.p},function(U){O=U.localInterface}],execute:function(){function U(Ga,Oa){if(!0===Oa)return Oa;if(Ga.copyState)return Ga.copyState(Oa);Ga={};for(var Ka in Oa){var N=Oa[Ka];N instanceof Array&&(N=N.concat([]));Ga[Ka]=N}return Ga}function ra(Ga,Oa,Ka){return Ga.startState?Ga.startState(Oa,Ka):!0}function xa(Ga,Oa){return Vb.modes[Ga]=Oa}function pa(Ga){if("string"===typeof Ga&&Vb.mimeModes.hasOwnProperty(Ga))Ga=
Vb.mimeModes[Ga];else if(Ga&&"string"===typeof Ga.name&&Vb.mimeModes.hasOwnProperty(Ga.name)){var Oa=Vb.mimeModes[Ga.name];"string"===typeof Oa&&(Oa={name:Oa});Ga=Object.assign({},Oa,Ga);Ga.name=Oa.name}else{if("string"===typeof Ga&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ga))return pa("application/xml");if("string"===typeof Ga&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ga))return pa("application/json")}return"string"===typeof Ga?{name:Ga}:Ga||{name:"null"}}function ea(Ga,Oa){Oa=Vb.resolveMode(Oa);"string"===typeof Oa&&
(Oa={name:Oa});if(!Oa.name)throw Error("parserConfig does not have a name of the mode to get");var Ka=Vb.modes[Oa.name];if(!Ka)return ea(Ga,"text/plain");Ga=Object.assign({indentUnit:2},Ga);return Object.assign(Ka(Ga,Oa),{name:Oa.name})}function bb(Ga,Oa){for(var Ka;Ga.innerMode;){Ka=Ga.innerMode(Oa);if(!Ka||Ka.mode==Ga)break;Oa=Ka.state;Ga=Ka.mode}return Ka||{mode:Ga,state:Oa}}function Aa(Ga,Oa){Vb.mimeModes[Ga]=Oa}function Rb(Ga,Oa,Ka){}function Gc(Ga,Oa,Ka,N,G,wa,M){var ha=Ga.editorPlugin._tokenizerValidBefore;
ha&&ha.row>=Ka&&(ha.row=Ka-1);var va=Vb.linesToTokenize(Ga.document,Ka,N,ha);ha=va.lines;va=va.state;if(!ha.length)return!1;va=va?Vb.copyState(Oa,va):Vb.startState(Oa);for(var Ua=0;Ua<ha.length;Ua++){var eb=ha[Ua],ob=eb.row;ob>=Ka&&ob<=N&&Vb.indentLine(Ga,Oa,eb,va,G,wa,M);va=Vb.tokenizeLine(Oa,ha[Ua],va,function(){})}return!0}function Ab(Ga,Oa,Ka,N,G,wa,M){Oa=Vb.linesToTokenize(Oa,Ka,N,G);Ka=Oa.lines;Vb.tokenizeLines(Ga,Ka,Oa.state,wa,M);return Ka}function Hc(Ga,Oa,Ka,N,G){var wa=[],M,ha=function(eb){return wa.push(M=
[])},va=function(eb,ob,Tb,Yb,yc,md,Bd){return M.push(Tb,Yb,eb,yc.current(),ob.localMode||Bd)};try{var Ua=Vb.visitDocumentTokens(Ga,Oa,Ka,N,G,ha,va)}catch(eb){wa.length=0,Ua=Vb.visitDocumentTokens(Ga,Oa,Ka,N,null,ha,va)}return{tokens:wa,lines:Ua}}function fb(Ga,Oa,Ka,N,G){null==Oa&&(Oa=Ga.search(/[^\s\u00a0]/),-1==Oa&&(Oa=Ga.length));N=N||0;for(G=G||0;;){var wa=Ga.indexOf("\t",N);if(0>wa||wa>=Oa)return G+(Oa-N);G+=wa-N;G+=Ka-G%Ka;N=wa+1}}function ud(Ga){Ga=Ga.toLowerCase();for(var Oa=0;Oa<Vb.modeInfo.length;Oa++){var Ka=
Vb.modeInfo[Oa];if(Ka.mime==Ga)return Ka;if(Ka.mimes)for(var N=0;N<Ka.mimes.length;N++)if(Ka.mimes[N]==Ga)return Ka}if(/\+xml$/.test(Ga))return ud("application/xml");if(/\+json$/.test(Ga))return ud("application/json")}function je(Ga){for(var Oa=0;Oa<Vb.modeInfo.length;Oa++){var Ka=Vb.modeInfo[Oa];if(Ka.ext)for(var N=0;N<Ka.ext.length;N++)if(Ka.ext[N]==Ga)return Ka}}function rc(Ga){for(var Oa=0;Oa<Vb.modeInfo.length;Oa++){var Ka=Vb.modeInfo[Oa];if(Ka.file&&Ka.file.test(Ga))return Ka}Oa=Ga.lastIndexOf(".");
if(Ga=-1<Oa&&Ga.substring(Oa+1,Ga.length))return Vb.findModeByExtension(Ga)}function gb(Ga){Ga=Ga.toLowerCase();for(var Oa=0;Oa<Vb.modeInfo.length;Oa++){var Ka=Vb.modeInfo[Oa];if(Ka.name.toLowerCase()==Ga)return Ka;if(Ka.alias)for(var N=0;N<Ka.alias.length;N++)if(Ka.alias[N].toLowerCase()==Ga)return Ka}}function Id(Ga){if(!Ga)return String(Ga);if(Array.isArray(Ga))return"["+Ga.map(Id).join(",")+"]";if("symbol"===typeof Ga)return vd.printSymbol(Ga);try{return String(Ga)}catch(Oa){return"Cannot print object: "+
Oa}}function hb(Ga,Oa){return!vd.arr.every(Oa.map(function(Ka){return Ga[Ka]}),function(Ka){return vd.obj.equals(Ka,Ga&&Ga.valueOf())})}function Za(Ga){if(vd.obj.isPrimitive(Ga))var Oa=vd.string.print(Ga);else Array.isArray(Ga)?((Oa=3<Ga.length)&&(Ga=Ga.slice(0,3)),Ga=vd.string.print(Ga),Oa&&(Ga=Ga.slice(0,-1)+", ...]"),Oa=Ga):Oa=vd.string.print(Ga);Oa=Oa.replace(/\n/g,"");500<Oa.length&&(Oa=Oa.slice(0,20)+("...["+(Oa.length-20)+' CHARS]"'));return Oa}function ua(Ga){return gc.Inspector.openInWindow({targetObject:Ga})}
function J(Ga,Oa){return gc.Inspector.openInWindow({remoteTarget:{code:Ga,evalEnvironment:Oa}})}function la(Ga,Oa){function Ka(ha){var va=ha.name,Ua=ha.ownerChain(),eb=ha.owner,ob=ha.world(),Tb;ha===wa&&(Tb=[M]);ob===ha&&(Tb=["$world"]);if(!Tb&&va&&eb){eb===ob&&1===gc.arr.count(gc.arr.pluck(ob.submorphs,"name"),va)&&(Tb=['$world.get("'+va+'")']);if(!Tb&&eb!=ob)for(ob=Ua.length-1;ob--;)if(1===Ua[ob].getAllNamed(va).length){Tb=[].concat($jscomp.arrayFromIterable(Ka(Ua[ob])),['get("'+va+'")']);break}Tb||
(va=[].concat($jscomp.arrayFromIterable(Ka(eb)),['get("'+va+'")']),gc.syncEval(va.join("."),{context:wa}).value===ha&&(Tb=va))}Tb||(Tb=[M+'.getMorphById("'+ha.id+'")']);return Tb}Oa=void 0===Oa?{}:Oa;var N=Ga.world(),G=Oa;Oa=void 0===G.maxLength?10:G.maxLength;var wa=void 0===G.fromMorph?N:G.fromMorph;if(wa===Ga)return"this";var M=N===wa?"$world":"this";if(!(N||Ga.name&&wa.get(Ga.name)===Ga))return"morph";N=Ka(Ga);return N.length>Oa?'$world.getMorphWithId("'+Ga.id+'")':N.join(".")}function La(Ga,
Oa,Ka){var N=(Oa=void 0===Oa?"":Oa)&&pe.arr.last(Oa.split(".")).toLowerCase(),G="",wa=0,M=Math.pow(2,19);if("string"===typeof Ga){if(Ga.length>M)return null}else if(Ga.document.stringSize>M)return null;if("string"===typeof Ga)G=Ga.slice(0,1E3);else for(Ga=$jscomp.makeIterator(Ga.document.lines),M=Ga.next();!M.done;M=Ga.next()){var ha=M.value;M=ha.stringSize;ha=ha.text;var va=!0;1E3<wa+M&&(va=!1,M=1E3-wa);G+=ha.slice(0,M)+(va?"\n":"");wa+=M;if(1E3<=wa)break}wa=$jscomp.makeIterator(pe.modeInfo);for(Ga=
wa.next();!Ga.done;Ga=wa.next()){va=Ga.value;M=va.contentTest;Ga=va.mode;ha=va.ext;va=va.file;if("function"===typeof M)try{if(M(G))return Ga}catch(Ua){}if(va&&va instanceof RegExp&&va.test(Oa))return Ga;if(ha)for(M=$jscomp.makeIterator(ha),ha=M.next();!ha.done;ha=M.next())if(ha.value===N)return Ga}return Ka}za({a:Aa,d:xa,r:Rb});var ib=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");ib.Color=cb;var Ib=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),
Ka=Oa.hasOwnProperty("DefaultTheme")&&"function"===typeof Oa.DefaultTheme?Oa.DefaultTheme:Oa.DefaultTheme=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:"background",get:function(){return ib.Color.white}},{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},
{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",
get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",
get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},
{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:ib.Color.white,
fontWeight:"bold",backgroundColor:ib.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:ib.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:ib.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},
{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Oa,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),hc=Ib=ib.DefaultTheme;ib.default=Ib;var Vb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");Vb.copyState=U;Vb.startState=
ra;Vb.defineMode=xa;Vb.resolveMode=pa;Vb.getMode=ea;Vb.innerMode=bb;Vb.defineMIME=Aa;Vb.registerHelper=Rb;Vb.indentLines=Gc;Vb.indentLine=function(Ga,Oa,Ka,N,G,wa,M){M=Object.assign({indentWithTabs:!Ga.useSoftTabs,indentUnit:Ga.tabWidth,tabSize:4,ignoreFollowingText:!1},M);null==G&&(G="add");"smart"==G&&(Oa.indent||(G="prev"));var ha=M.tabSize,va=Ka.text,Ua=Vb.countColumn(va,null,ha);Ka.modeState&&(Ka.modeState=null);var eb=va.match(/^\s*/)[0];if(!wa&&!/\S/.test(va)){var ob=0;G="not"}else if("smart"==
G&&(ob=Oa.indent(N,M.ignoreFollowingText?"":va.slice(eb.length),va),ob==Vb.passIndent||150<ob)){if(!wa)return;G="prev"}"prev"==G?ob=0<Ka.row?Vb.countColumn(Ka.prevLine().text,null,ha):0:"add"==G?ob=Ua+M.indentUnit:"subtract"==G?ob=Ua-M.indentUnit:"number"===typeof G&&(ob=Ua+G);ob=Math.max(0,ob);Oa="";N=0;if(M.indentWithTabs)for(M=Math.floor(ob/ha);M;--M)N+=ha,Oa+="\t";N<ob&&(Oa+=" ".repeat(ob-N));if(Oa!=eb)return Ga.replace({start:{row:Ka.row,column:0},end:{row:Ka.row,column:eb.length}},Oa),!0};Vb.tokenizeLines=
function(Ga,Oa,Ka,N,G){if(Oa.length){Ka=Ka?Vb.copyState(Ga,Ka):Vb.startState(Ga);for(var wa=0;wa<Oa.length;wa++){var M=Oa[wa];N(M);Ka=Vb.tokenizeLine(Ga,M,Ka,G)}}};Vb.tokenizeLine=function(Ga,Oa,Ka,N){var G=Oa.text;if(!G)return Ka;var wa=new Vb.StringStream(G,2);Ka=Oa.modeState="function"===typeof Ga.copyState?Ga.copyState(Ka):Vb.copyState(Ga,Ka);Oa.prevLine();for(Ka._string=G;!wa.eol();)G=Ga.token(wa,Ka),N(G,Ka,wa.start,wa.pos,wa,Oa,Ga),wa.start=wa.pos;return Ka};Vb.printTokens=function(Ga){for(var Oa=
"",Ka=0;Ka<Ga.length;Ka+=5)Oa+=Ga[Ka+0]+" => "+Ga[Ka+1]+" "+Ga[Ka+2]+" "+Ga[Ka+3]+" "+Ga[Ka+4].name+"\n";return Oa};Vb.visitDocumentTokens=Ab;Vb.tokenizeDocument=Hc;Vb.linesToTokenize=function(Ga,Oa,Ka,N){if(N&&N.row>=Ka)return{lines:[],state:null};Oa=N?Math.max(0,N.row-1):Oa;var G=Ga.getLine(Oa),wa=G.text;Ga=[G];N=null;for(var M=0,ha;(ha=G.prevLine())&&50>M++;){G=ha;if(G.modeState){N=G.modeState;break}Ga.unshift(G)}if(!N){for(var va=G,Ua=Infinity;(ha=G.prevLine())&&100>M++;){G=ha;if(G.modeState){N=
G.modeState;break}Ga.unshift(G);ha=wa.match(/^\s*/)[0].length;if(0===ha)break;ha<Ua&&(Ua=ha,va=G)}!N&&0<Ua&&(Ga=Ga.slice(Ga.indexOf(va)))}if(Ka>Oa)for(G=Vb.arr.last(Ga);Oa<=Ka;Oa++){G=G.nextLine();if(!G)break;Ga.push(G)}return{lines:Ga,state:N}};Vb.countColumn=fb;Vb.findModeByMIME=ud;Vb.findModeByExtension=je;Vb.findModeByFileName=rc;Vb.findModeByName=gb;Vb.arr=Pb;Ib=Vb.modes||{};Vb.modes=Ib;Vb.modes=Ib;Vb.modes=Ib;Ib=za("p",{});Vb.passIndent=Ib;Vb.passIndent=Ib;Vb.passIndent=Ib;Vb.copyState=U;Vb.copyState=
U;Vb.startState=ra;Vb.startState=ra;Vb.defineMode=xa;Vb.defineMode=xa;Vb.resolveMode=pa;Vb.resolveMode=pa;Vb.getMode=ea;Vb.getMode=ea;Vb.innerMode=bb;Vb.innerMode=bb;Ib={};Vb.mimeModes=Ib;Vb.mimeModes=Ib;Vb.mimeModes=Ib;Vb.defineMIME=Aa;Vb.defineMIME=Aa;Vb.registerHelper=Rb;Vb.registerHelper=Rb;Vb.indentLines=Gc;Vb.indentLines=Gc;Vb.visitDocumentTokens=Ab;Vb.visitDocumentTokens=Ab;Vb.tokenizeDocument=Hc;Vb.tokenizeDocument=Hc;Vb.countColumn=fb;Vb.countColumn=fb;(function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),
Ka=Oa.hasOwnProperty("StringStream")&&"function"===typeof Oa.StringStream?Oa.StringStream:Oa.StringStream=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:Symbol.for("lively-instance-initialize"),value:function(N,G){this.reset(N,G)}},{key:"reset",value:function(N,G){this.pos=this.start=0;this.string=void 0===N?"":N;this.tabSize=void 0===G?2:G;this.lineStart=this.lastColumnPos=this.lastColumnValue=
0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(N){var G=this.string.charAt(this.pos);if("string"===typeof N?G==N:G&&(N.test?N.test(G):N(G)))return++this.pos,G}},{key:"eatWhile",value:function(N){for(var G=this.pos;this.eat(N););
return this.pos>G}},{key:"eatSpace",value:function(){for(var N=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>N}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(N){N=this.string.indexOf(N,this.pos);if(-1<N)return this.pos=N,!0}},{key:"backUp",value:function(N){this.pos-=N}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=Vb.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,
this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?Vb.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return Vb.countColumn(this.string,null,this.tabSize)-(this.lineStart?Vb.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(N,G,wa){if("string"===typeof N){var M=function(va){return wa?va.toLowerCase():va},ha=this.string.substr(this.pos,N.length);if(M(ha)==M(N))return!1!==
G&&(this.pos+=N.length),!0}else{if((N=this.string.slice(this.pos).match(N))&&0<N.index)return null;N&&!1!==G&&(this.pos+=N[0].length);return N}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(N,G){this.lineStart+=N;try{return G()}finally{this.lineStart-=N}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],Oa,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10526,end:13053})})(void 0);Ib=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},
{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",
mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},
{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ga){return Ga.match(/^diff --.* a\//m)}},
{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",
mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",
ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",
mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",
mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},
{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",
mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",
mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},
{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",
mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",
mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],
alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,
contentTest:function(Ga){return Ga.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",
mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",
mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",
mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",
mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml",
"xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",
mode:"mscgen",ext:["msgenny"]}];Vb.modeInfo=Ib;Vb.modeInfo=Ib;Vb.modeInfo=Ib;for(var Oc=0;Oc<Vb.modeInfo.length;Oc++)Vb.info=Vb.modeInfo[Oc],Vb.info.mimes&&(Vb.info.mime=Vb.info.mimes[0]);Vb.defineMode("null",function(){return{token:function(Ga){return Ga.skipToEnd()}}});Vb.defineMIME("text/plain","null");Vb.findModeByMIME=ud;Vb.findModeByMIME=ud;Vb.findModeByExtension=je;Vb.findModeByExtension=je;Vb.findModeByFileName=rc;Vb.findModeByFileName=rc;Vb.findModeByName=gb;Vb.findModeByName=gb;var Pc=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");
Pc.Color=cb;Pc.Rectangle=tb;Pc.pt=Fc;Pc.morph=vc;Pc.ShadowObject=Qc;Pc.StyleSheet=mc;Pc.connect=ic;Pc.arr=Pb;Pc.string=zc;Pc.FilterableList=Dc;Pc.Range=Gd;Oc=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Ka=Oa.hasOwnProperty("Completer")&&"function"===typeof Oa.Completer?Oa.Completer:Oa.Completer=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:"compute",value:function(){return[]}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],Oa,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);Pc.Completer=Oc;Pc.Completer=Oc;Pc.Completer=Oc;Oc=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
Ka=Oa.hasOwnProperty("WordCompleter")&&"function"===typeof Oa.WordCompleter?Oa.WordCompleter:Oa.WordCompleter=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:"compute",value:function(N,G){var wa=[],M=[],ha=N.document.lineStrings;N=N.cursorPosition.row;for(var va=N-1;0<=va;va--)for(var Ua=$jscomp.makeIterator(ha[va].split(/[^0-9a-z@_]+/i)),eb=Ua.next();!eb.done;eb=Ua.next())(eb=eb.value)&&!wa.includes(eb)&&
eb!==G&&(wa.push(eb),M.push({priority:1E3-(N-va),completion:eb}));for(va=N+1;va<ha.length;va++)for(Ua=$jscomp.makeIterator(ha[va].split(/[^0-9a-z_@]+/i)),eb=Ua.next();!eb.done;eb=Ua.next())(eb=eb.value)&&!wa.includes(eb)&&eb!==G&&(wa.push(eb),M.push({priority:1E3-(va-N),completion:eb}));return M}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Oa,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);Pc.WordCompleter=Oc;Pc.WordCompleter=Oc;Pc.WordCompleter=Oc;Oc=[new Pc.WordCompleter];Pc.defaultCompleters=Oc;Pc.defaultCompleters=Oc;Pc.defaultCompleters=Oc;Oc=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Ka=Oa.hasOwnProperty("CompletionController")&&"function"===typeof Oa.CompletionController?
Oa.CompletionController:Oa.CompletionController=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:Symbol.for("lively-instance-initialize"),value:function(N,G){G=void 0===G?[]:G;this.textMorph=N;this.completers=G=N.pluginCollect("getCompleters",G)}},{key:"computeCompletions",value:function(N){var G=this,wa,M,ha,va,Ua,eb,ob,Tb,Yb,yc,md,Bd,Wc,Sd,Qd,Ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yd){switch(yd.nextAddress){case 1:wa=
[],M=$jscomp.makeIterator(G.completers),ha=M.next();case 2:if(ha.done){yd.jumpTo(4);break}va=ha.value;yd.setCatchFinallyBlocks(5);Ua=wa;eb=Ua.concat;return yd.yield(va.compute(G.textMorph,N),7);case 7:wa=eb.call(Ua,yd.yieldResult);yd.leaveTryBlock(3);break;case 5:ob=yd.enterCatchBlock(),console.warn("Error in completer "+va+": "+(ob.stack||ob));case 3:ha=M.next();yd.jumpTo(2);break;case 4:Tb=new Map;wa.forEach(function(ue){var De=Tb.get(ue.completion);De||(De=[],Tb.set(ue.completion,De));De.push(ue)});
Yb=[];yc=$jscomp.makeIterator(Tb.values());for(md=yc.next();!md.done;md=yc.next())Bd=md.value,Yb.push(Pc.arr.last(Pc.arr.sortByKey(Bd,"priority")));Wc=0;Sd=Pc.arr.sortByKey(Yb,"priority").reverse();Qd=Sd.length&&Sd[0].priority||0;Ed=Sd.map(function(ue){ue.highestPriority=Qd;var De=ue.completion.replace(/\n/g,""),gg=String((ue.info||"").replace(/\n/g,""));Wc=Math.max(Wc,De.length+gg.length);return{isListItem:!0,string:De,annotation:gg,value:ue}});return yd.return({items:Ed,maxCol:Wc})}})}},{key:"computeSortedCompletions",
value:function(N,G){G=void 0===G?!1:G;var wa=this,M,ha,va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return M={tokens:[N],lowercasedTokens:[N],input:N},Ua.yield(wa.computeCompletions(N),2);ha=Ua.yieldResult;va=Pc.arr.sortBy(ha.items.filter(function(eb){return wa.filterFunction(M,eb,G)}),function(eb){return wa.sortFunction(M,eb)});return Ua.return(va)})}},{key:"_printCompletions",value:function(N){var G=this,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){if(1==
M.nextAddress)return M.yield(G.computeSortedCompletions(N),2);wa=M.yieldResult.map(function(ha){return{completion:ha.value.completion,priority:ha.value.priority,maxP:ha.value.highestPriority,sortVal:ha._cache[N].sortVal,lev:JSON.stringify(ha._cache[N].levenshtein)}});return M.return(Pc.string.printTable(lively.lang.grid.tableFromObjects(wa)))})}},{key:"prefix",value:function(){var N=this.textMorph,G=N.selection;return(G.isEmpty()?N.getLine(G.lead.row).slice(0,G.lead.column):G.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(N,G,wa){wa=void 0===wa?!1:wa;G._cache||(G._cache={});var M=N.tokens,ha=N.lowercasedTokens,va=N.input;va=G._cache[va]||(G._cache[va]={});if(va.hasOwnProperty("filtered"))return va.filtered;G=G.value.completion.replace(/\([^\)]*\)$/,"");var Ua=G.toLowerCase();if(wa&&M[0]&&!G.startsWith(M[0]))return va.filtered=!1;if(ha.every(function(ob){return Ua.includes(ob)}))return!0;var eb=va.levenshtein||(va.levenshtein={});N=wa||3>=Pc.arr.sum(N.lowercasedTokens.map(function(ob){return eb[ob]||
(eb[ob]=Pc.string.levenshtein(Ua,ob))}));return va.filtered=N}},{key:"sortFunction",value:function(N,G){G._cache||(G._cache={});var wa=G._cache[N.input]||(G._cache[N.input]={});if(wa.hasOwnProperty("sortVal"))return wa.sortVal;wa=G._cache[N.input]={};var M=G.value;G=M.highestPriority;var ha=M.completion;M=M.priority;ha=ha.replace(/\([^\)]*\)$/,"").toLowerCase();var va=0;N.lowercasedTokens.forEach(function(eb){ha.startsWith(eb)?va+=12:3<=eb.length&&ha.includes(eb)&&(va+=5)});G=-((M||(va?G:0))/Math.pow(10,
String(G).length-2))-va;var Ua=wa.levenshtein||(wa.levenshtein={});N=Pc.arr.sum(N.lowercasedTokens.map(function(eb){return Ua[eb]||(Ua[eb]=Pc.string.levenshtein(ha,eb))}));va&&(N/=2);return wa.sortVal=N+G}},{key:"positionForMenu",value:function(){var N=this.textMorph,G=N.charBoundsFromTextPosition(N.cursorPosition);return N.getGlobalTransform().transformRectToRect(G).topLeft().addXY(-N.scroll.x,-N.scroll.y).addPt(Pc.pt(N.borderWidth+4,N.borderWidth+4))}},{key:"completionListSpec",value:function(){var N=
this,G,wa,M,ha,va,Ua,eb,ob,Tb,Yb,yc,md,Bd,Wc,Sd,Qd,Ed,yd,ue,De;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gg){if(1==gg.nextAddress)return wa=G=N.textMorph,M=wa.fontSize,ha=wa.fontFamily,va=N.positionForMenu(),Ua=N.prefix(),gg.yield(N.computeCompletions(Ua),2);eb=gg.yieldResult;ob=eb.items;Tb=eb.maxCol;Yb=G.env.fontMetric.sizeFor(ha,M,"M");yc=Yb.width*Tb;md=G.document.getLine(0).height;Bd=Math.max(120,yc<G.width?yc:G.width);Wc=md*ob.length+md+10;Sd=Math.max(70,Math.min(700,Wc));Qd=
va.extent(Pc.pt(Bd,Sd));if(Ed=G.world())yd=Ed.visibleBounds().insetBy(5),Qd.bottom()>yd.bottom()&&(ue=Qd.bottom()-yd.bottom(),ue>Qd.height-50&&(ue=Qd.height-50),Qd.height-=ue),Qd.right()>yd.right()&&(De=Qd.right()-yd.right(),Qd.width=120>Qd.width-De?120:Qd.width-De),yd.containsRect(Qd)||(Qd=Qd.withTopLeft(yd.translateForInclusion(Qd).topLeft())),Qd=Qd.translatedBy(yd.insetBy(0).topLeft().negated());return gg.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},hasFixedPosition:!0,
epiMorph:!0,fontSize:M,position:Qd.topLeft(),extent:Qd.extent(),items:ob,input:Ua,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:N.filterFunction,sortFunction:N.sortFunction})})}},{key:"removeMenuOnBlur",value:function(N){var G=N.menu;setTimeout(function(){G.withAllSubmorphsDetect(function(wa){return wa.isFocused()})?G.inputMorph.focus():G.remove()})}},{key:"openCompletionList",value:function(){var N=this,G,wa,M,ha,va,Ua,eb,ob,Tb,Yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){if(1==
yc.nextAddress)return G=N.textMorph.selection.start,yc.yield(N.completionListSpec(),2);if(3!=yc.nextAddress)return wa=yc.yieldResult,N.textMorph.pluginFind(function(md){return md.theme}),M=new Pc.FilterableList(wa),ha=new Pc.Range({start:G,end:N.textMorph.selection.start}),va=N.textMorph.textInRange(ha),Ua=M.inputMorph,eb=M.listMorph,ob=wa.input,Tb=M.addMorph({name:"prefix mask",fill:Pc.Color.transparent,bounds:Ua.textBounds()},Ua),eb.master=null,ha.isEmpty()||(N.textMorph.deleteText(ha),Ua.input=
va,Ua.gotoDocumentEnd()),Ua.fontColor=N.textMorph.fontColor,Pc.connect(Ua,"textString",Tb,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Ua}}),Pc.connect(M,"accepted",N,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:ob}}),Pc.connect(M,"accepted",M,"remove"),Pc.connect(M,"canceled",M,"remove"),Pc.connect(M,"remove",N.textMorph,"focus"),Pc.connect(M.inputMorph,"onBlur",N,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:M}}),Yb=N.textMorph.world(),eb.addStyleClass("hiddenScrollbar"),M.paddingMorph.height=2,Ua.height=eb.itemHeight,Ua.clipMode="visible",Ua.fill=N.textMorph.fill,Ua.fixedHeight=!0,Ua.fixedWidth=!1,Ua.fontSize=eb.fontSize,M.relayout(),M.selectedIndex=0,M.master.applyIfNeeded(!0),
Ua.focus(),yc.yield(M.master.whenApplied(),3);ob.length&&(Ua.gotoDocumentEnd(),M.moveBy(Pc.pt(-Ua.textBounds().width,0)));Yb.addMorph(M);M.inputPadding=Pc.Rectangle.inset(0,0,0,0);return yc.return(M)})}},{key:"autoInsertBestMatchingCompletion",value:function(N,G,wa){G=void 0===G?!0:G;var M=this,ha,va,Ua,eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){if(1==ob.nextAddress)return ha=$jscomp,va=ha.makeIterator,ob.yield(M.computeSortedCompletions(N,G),2);Ua=va.call(ha,ob.yieldResult);
(eb=Ua.next().value)&&M.insertCompletion(eb.value.completion,N,wa);ob.jumpToEnd()})}},{key:"insertCompletion",value:function(N,G,wa){var M=this.textMorph,ha=M.document,va=M.selection.isMultiSelection?M.selection.selections:[M.selection];M.undoManager.group();va.forEach(function(Ua){Ua.collapseToEnd();var eb=Ua.lead,ob=G?ha.indexToPosition(ha.positionToIndex(eb)-G.length):eb;"function"===typeof wa?wa(N,G,M,{start:ob,end:eb},Ua):M.replace({start:ob,end:eb},N)});M.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"CompletionController"}}],Oa,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);Pc.CompletionController=Oc;Pc.CompletionController=Oc;Pc.CompletionController=Oc;Oc=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ga,
Oa,Ka){var N;return $jscomp.asyncExecutePromiseGeneratorProgram(function(G){return 1==G.nextAddress?(N=new Pc.CompletionController(Ga,Pc.defaultCompleters),G.yield(N.openCompletionList(),2)):G.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ga,Oa,Ka){var N;return $jscomp.asyncExecutePromiseGeneratorProgram(function(G){return 1==G.nextAddress?(N=new Pc.CompletionController(Ga,Pc.defaultCompleters),G.yield(N.autoInsertBestMatchingCompletion(N.prefix()),
2)):G.return(!0)})}}];Pc.completionCommands=Oc;Pc.completionCommands=Oc;Pc.completionCommands=Oc;var Yd=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Yd.chain=Hd;Yd.arr=Pb;Yd.obj=Zd;Yd.string=zc;var r=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ga){var Oa=Ga.selection.start;0<Oa.row&&(Oa=Ga.getPositionAboveOrBelow(1,Oa,!0,0,Ga.charBoundsFromTextPosition(Oa).x),Ga.selection.addRange({start:Oa,end:Oa}));return!0}},{name:"[multi select] add cursor below",
multiSelectAction:"single",exec:function(Ga){var Oa=Ga.selection.start;Oa.row<Ga.documentEndPosition.row&&(Oa=Ga.getPositionAboveOrBelow(-1,Oa,!0,0,Ga.charBoundsFromTextPosition(Oa).x),Ga.selection.addRange({start:Oa,end:Oa}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ga){var Oa=Ga.selection.selections[Ga.selection.selections.length-1];if(Oa.isEmpty())return!0;Ga.searchForAll(Oa.text,{start:{column:0,row:0}}).forEach(function(Ka){return Ga.selection.addRange(Ka.range,
!1)});Ga.selection.mergeSelections();Yd.arr.remove(Ga.selection.selections,Oa);Ga.selection.selections.push(Oa);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ga){var Oa=Ga.selection.selections.length-1,Ka=Ga.selection.selections[Oa];if(Ka.isEmpty())return!0;var N=Ga.search(Ka.text,{start:Ka.end,backwards:!1});N&&(Ka=Ga.selection.selections.findIndex(function(G){return G.range.equals(N.range)}),-1<Ka?Yd.arr.swap(Ga.selection.selections,Ka,Oa):Ga.selection.addRange(N.range));
return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Ga){var Oa=Ga.selection.selections.length-1,Ka=Ga.selection.selections[Oa];if(Ka.isEmpty())return!0;var N=Ka.start,G=Ga.search(Ka.text,{start:{row:N.row,column:N.column-(Ka.text.length-1)},backwards:!0});G&&(Ka=Ga.selection.selections.findIndex(function(wa){return wa.range.equals(G.range)}),-1<Ka?Yd.arr.swap(Ga.selection.selections,Ka,Oa):Ga.selection.addRange(G.range));return!0}},{name:"[multi select] remove focused cursor",
multiSelectAction:"single",exec:function(Ga){var Oa=Ga.selection.selections.length;1<Oa&&Ga.selection.removeSelections(Oa-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ga){Ga.selection.selections=lively.lang.arr.rotate(Ga.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(Ga){Ga.selection.selections=lively.lang.arr.rotate(Ga.selection.selections,1);return!0}},{name:"[multi select] align cursors",
multiSelectAction:"single",exec:function(Ga){var Oa=Ga.selection.selections;if(1>=Oa.length)return!0;var Ka=Yd.arr.groupBy(Oa,function(G){return G.range.start.row});Oa=Ka.keys().map(function(G){G=Ka[G];var wa=Yd.arr.max(G,function(M){return M.range.start.column});Yd.arr.without(G,wa).forEach(function(M){return M.range=wa.range});return wa});var N=Yd.arr.max(Oa,function(G){return G.range.start.column}).range.start.column;Oa.forEach(function(G){var wa=G.range.start;G=wa.row;wa=wa.column;Ga.insertText(" ".repeat(N-
wa),{row:G,column:wa})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ga){Ga.selection.disableMultiSelect();if(Ga.selection.isEmpty())var Oa=Ga.lastSavedMark&&Ga.lastSavedMark.position||(void 0).lineRange().start,Ka=Ga.cursorPosition;else Oa=Ga.selection,Ka=Oa.lead,Oa=Oa.anchor;Ga.selection.collapse();var N=Oa.column,G=Ka.column;Yd.arr.range(Oa.row,Ka.row).forEach(function(wa){return Ga.getLine(wa).length>Math.min(G,N)&&Ga.selection.addRange({end:{row:wa,
column:G},start:{row:wa,column:N}},!1)});Ga.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ga,Oa,Ka){Ka=void 0===Ka?1:Ka;Ga.undoManager.group();Ga.selection.selections.forEach(function(N,G){return N.text=String(G+Ka)});Ga.undoManager.group();return!0}}];Yd.multiSelectCommands=r;Yd.multiSelectCommands=r;Yd.multiSelectCommands=r;var Rd=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");Rd.pToI=
function(Ga,Oa){return Ga.positionToIndex(Oa)};Rd.iToP=function(Ga,Oa){return Ga.indexToPosition(Oa)};Rd.execCodeNavigator=function(Ga){return function(Oa,Ka,N){var G=Oa.pluginInvokeFirst("getNavigator");if(!G)return!0;Oa.saveMark();N=N||1;for(var wa=0;wa<N;wa++)G[Ga](Oa,Ka);return!0}};Rd.once=xc;var ke=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Rd.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:Rd.execCodeNavigator("backwardSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Rd.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Rd.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Rd.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",
mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ga,Oa){function Ka(){var wa=Ga.$expandRegionState,M=Rd.pToI(Ga,Ga.cursorPosition);if(wa&&(wa.range[0]===M||wa.range[1]===M))return wa;wa=Ga.selection.range;return Ga.$expandRegionState={range:[Rd.pToI(Ga,wa.start),Rd.pToI(Ga,wa.end)]}}Oa=Oa||{};var N=Ga.pluginInvokeFirst("getNavigator");if(!N)return!0;var G=Oa.start;Oa=Oa.end;if("number"===typeof G&&"number"===typeof Oa)Ka(),N={range:[G,Oa],prev:Ka()};else{G=N.ensureAST(Ga);if(!G)return;N=
N.expandRegion(Ga,Ga.textString,G,Ka())}N&&N.range&&(Ga.selection={start:Rd.iToP(Ga,N.range[0]),end:Rd.iToP(Ga,N.range[1])},Ga.$expandRegionState=N);Rd.once(Ga,"selectionChange",function(){return Ga.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ga){if(Ga.selection.isEmpty())return!0;var Oa=Ga.pluginInvokeFirst("getNavigator");if(!Oa)return!0;
var Ka=Oa.ensureAST(Ga);if(!Ka)return!0;var N=Ga.$expandRegionState;if(!N)return!0;(Oa=Oa.contractRegion(Ga,Ga.textString,Ka,N))&&Oa.range&&(Ga.selection={start:Rd.iToP(Ga,Oa.range[0]),end:Rd.iToP(Ga,Oa.range[1])},Ga.$expandRegionState=Oa);Rd.once(Ga,"selectionChange",function(){return Ga.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Rd.commands=ke;Rd.commands=ke;Rd.commands=ke;var le=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");
le.arr=Pb;le.chain=Hd;le.string=zc;var ge=[{name:"toggle comment",exec:function(Ga){var Oa=Ga.pluginInvokeFirst("getComment");if(!Oa)return!0;if(!Oa.lineCommentStart)return Oa.blockCommentStart?Ga.execCommand("toggle block comment"):!0;var Ka=Oa.lineCommentStart,N=new RegExp("^(\\s*)("+Ka+"\\s?)(.*)");Oa=Ga.document;var G=Ga.selection;G.isEmpty()||0!==G.end.column||G.growRight(-1);var wa=G.start.row;Oa=Oa.lineStrings.slice(G.start.row,G.end.row+1);Oa=Oa.some(function(va){return!!va.trim()})?le.arr.dropWhile(Oa,
function(va){return va.trim()?!1:++wa&&!0}):Oa;var M=Oa.every(function(va){return va.trim()&&va.match(N)});Ga.undoManager.group();if(M)Oa.forEach(function(va,Ua){if(va=va.match(N)){va=$jscomp.makeIterator(va);va.next();var eb=va.next().value,ob=va.next().value;va.next();Ga.deleteText({start:{row:wa+Ua,column:eb.length},end:{row:wa+Ua,column:eb.length+ob.length}})}});else{var ha=Oa.reduce(function(va,Ua,eb){return Ua.trim()||G.isEmpty()&&G.start.row===G.end.row?Math.min(va,Ua.match(/^\s*/)[0].length):
va},Infinity);ha=Infinity===ha?0:ha;Oa.forEach(function(va,Ua){va=$jscomp.makeIterator(va.match(/^(\s*)(.*)/));va.next();va.next();va.next();Ga.insertText(Ka+" ",{row:wa+Ua,column:ha})})}Ga.undoManager.group();return!0}},{name:"toggle block comment",exec:function(Ga){var Oa=Ga.pluginInvokeFirst("getComment");if(!Oa)return!0;if(!Oa.blockCommentStart)return Oa.lineCommentStart?Ga.execCommand("toggle comment"):!0;if(!Oa||!Oa.blockCommentStart)return!0;var Ka=Oa.blockCommentStart;Oa=Oa.blockCommentEnd;
var N=new RegExp("^"+Ka.replace(/\*/g,"\\*")),G=new RegExp(Oa.replace(/\*/g,"\\*")+"$"),wa=Ga.tokenAt(Ga.cursorPosition);if(wa&&"comment"===wa.token){var M=Ga.textInRange(wa);if(M.match(N)&&M.match(G))return Ga.undoManager.group(),Ga.replace(wa,M.slice(Ka.length,-Oa.length)),Ga.undoManager.group(),!0}Ga.undoManager.group();Ga.insertText(Ka,Ga.selection.start);Ga.insertText(Oa,Ga.selection.end);Ga.undoManager.group();Ka=!Ga.selection.isEmpty();Ga.selection.growLeft(Oa.length);Ka||Ga.selection.collapse();
return!0}},{name:"comment box",exec:function(Ga,Oa,Ka){Oa=Ga.undoManager.ensureNewGroup(Ga,"comment box");if(Ga.selection.isEmpty())return Ga.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ga.execCommand("toggle comment"),Ga.undoManager.group(Oa),!0;var N=Ga.selection.range,G=Ga.withSelectedLinesDo(function(M){return M}),wa=le.arr.min([N.start.column].concat(le.chain(G).map(function(M){return M.match(/^\s*/)}).flatten().compact().pluck("length").value()));G=le.arr.max(G.map(function(M){return M.length}))-
wa;G=Array(Math.ceil(G/2)+1).join("-=")+"-";Ga.execCommand("toggle comment");Ga.collapseSelection();Ga.cursorPosition={row:N.start.row,column:0};Ka?Ga.insertText(le.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",wa)):Ga.insertText(le.string.indent(G+"\n"," ",wa));Ga.selection.goUp();Ga.execCommand("toggle comment");Ga.cursorPosition={row:N.end.row+2,column:0};Ga.insertText(le.string.indent(G+"\n"," ",wa));Ga.selection.goUp();Ga.execCommand("toggle comment");Ga.selection.range=
{start:{row:N.start.row,column:0},end:Ga.cursorPosition};Ga.undoManager.group(Oa);return!0},multiSelectAction:"forEach",handlesCount:!0}];le.commands=ge;le.commands=ge;le.commands=ge;var vd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");vd.printSymbol=function(Ga){if(Symbol.keyFor(Ga))return'Symbol.for("'+Symbol.keyFor(Ga)+'")';if(vd.knownSymbols.get(Ga))return vd.knownSymbols.get(Ga);String(Ga).match(vd.symMatcher);return String(Ga)};vd.defaultSort=function(Ga,Oa){if(Ga.hasOwnProperty("priority")||
Oa.hasOwnProperty("priority")){var Ka=Ga.priority||0,N=Oa.priority||0;if(Ka<N)return-1;if(Ka>N)return 1}Ga=(Ga.keyString||Ga.key).toLowerCase();Oa=(Oa.keyString||Oa.key).toLowerCase();return Ga<Oa?-1:Ga===Oa?0:1};vd.safeToString=Id;vd.propertyNamesOf=function(Ga,Oa){if(!Ga)return[];if(Array.isArray(Ga)){var Ka=Oa?Oa.offset:0;return vd.arr.range(Ka,Ka+(Oa?Oa.partitionSize:Ga.length-1))}return vd.arr.sortBy(Object.keys(Ga),function(N){return N.toLowerCase()})};vd.isMultiValue=hb;vd.printValue=Za;vd.partitionedChildren=
function(Ga,Oa){var Ka=void 0===Oa?{}:Oa;Oa=void 0===Ka.originalValue?Ga:Ka.originalValue;var N=void 0===Ka.offset?0:Ka.offset;Ka=void 0===Ka.partitionSize?Ga.length||Object.values(Ga).length:Ka.partitionSize;if(vd.obj.isArray(Ga)){Ga=vd.num.roundTo(Math.max(vd.MIN_PARTITION_SIZE,Ka/50),.1);Ka/=Ga;for(var G=[],wa=0;wa<Ka;wa++){var M="["+(N+wa*Ga)+"-"+(N+(wa+1)*Ga)+"]";G.push({partition:{originalValue:Oa,offset:N+wa*Ga,partitionSize:Ga},value:[],key:M,keyString:M,valueString:"...",isCollapsed:!0})}return G}Ga=
vd.num.roundTo(Math.max(vd.MIN_PARTITION_SIZE,Ka/50),.1);Ka/=Ga;G=[];wa=vd.obj.keys(Oa).sort();for(M=0;M<Ka;M++){var ha=N+M*Ga,va=N+(M+1)*Ga,Ua=vd.obj.select(Oa,wa.slice(ha,va));ha="["+wa[ha].slice(0,4)+"-"+(wa[va]||vd.arr.last(wa)).slice(0,4)+"]";G.push({partition:{originalValue:Ua,offset:N+M*Ga,partitionSize:Ga},value:[],key:ha,keyString:ha,valueString:"...",isCollapsed:!0})}return G};vd.propertiesOf=function(Ga){var Oa=Ga.partition?Ga.target:Ga.value;if(!Oa)return[];var Ka={_rev:!0},N=[],G="function"===
typeof Oa.livelyCustomInspect?Oa.livelyCustomInspect():{},wa=Object.assign({},vd.defaultPropertyOptions,{},G);if(G.properties){G=$jscomp.makeIterator(G.properties);for(var M=G.next();!M.done;M=G.next()){var ha=M.value;M=ha.key;var va=ha.hidden,Ua=ha.priority,eb=ha.keyString,ob=ha.value;ha=ha.valueString;Ka[M]=!0;va||N.push(Ga.getSubNode({priority:Ua,key:M,keyString:eb||vd.safeToString(M),value:ob,valueString:ha,isCollapsed:!0}))}}if(wa.includeDefault){G=vd.propertyNamesOf(Oa,Ga.partition);if(G.length>
vd.MAX_NODE_THRESHOLD)for(Ka=$jscomp.makeIterator(vd.partitionedChildren(Oa,Ga.partition)),G=Ka.next();!G.done;G=Ka.next())N.push(Ga.getSubNode(G.value));else for(va=$jscomp.makeIterator(G),G=va.next();!G.done;G=va.next())Ua=G.value,Ua in Ka||(G=Oa[Ua],M=vd.printValue(G),G={keyString:Ua,key:Ua,value:G,valueString:M,isCollapsed:!0},N.push(Ga.getSubNode(G)));if(wa.includeSymbols)for(Ka=$jscomp.makeIterator(Object.getOwnPropertySymbols(Oa)),G=Ka.next();!G.done;G=Ka.next())va=G.value,Ua=vd.safeToString(va),
G=Oa[va],M=vd.printValue(G),G={key:va,keyString:Ua,value:G,valueString:M,isCollapsed:!0},N.push(Ga.getSubNode(G))}wa.sort&&(N=wa.sortFunction(Oa,N));return N};vd.obj=Zd;vd.num=od;vd.arr=Pb;vd.string=zc;vd.connect=ic;vd.signal=qb;vd.TreeData=kc;vd.newUUID=Uc;vd.localInterface=O;vd.MAX_NODE_THRESHOLD=1E3;vd.MIN_PARTITION_SIZE=250;vd.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Ga,Oa){return Array.isArray(Ga)?Oa:Oa.sort(vd.defaultSort)}};vd.symMatcher=/^Symbol\((.*)\)$/;
vd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ga){return"symbol"===typeof Symbol[Ga]}).reduce(function(Ga,Oa){return Ga.set(Symbol[Oa],"Symbol."+Oa)},new Map)}();vd.isMultiValue=hb;vd.isMultiValue=hb;vd.printValue=Za;vd.printValue=Za;var Td=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Ka=Oa.hasOwnProperty("InspectionTree")&&"function"===typeof Oa.InspectionTree?Oa.InspectionTree:Oa.InspectionTree=function(N){N&&
N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:Symbol.for("lively-instance-initialize"),value:function(N){mb._get(Object.getPrototypeOf(Ka.prototype),Symbol.for("lively-instance-initialize"),this).call(this,N);this.inspector=N.inspector;this.root.isInspectionNode||(this.root=vd.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(N){N=
void 0===N?!0:N;return mb._get(Object.getPrototypeOf(Ka.prototype),"asListWithIndexAndDepth",this).call(this,function(G){G=G.node;return N?G.visible:!0})}},{key:"getContextFor",value:function(N){return N==this.root?this.root.value.inspectee:N.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(N){var G=void 0===N.maxDepth?1:N.maxDepth,wa=N.iterator,M=N.showUnknown,ha=N.showInternal,va=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ua){if(1==Ua.nextAddress)return Ua.yield(va.uncollapseAll(function(eb,
ob){return G>ob&&(eb==va.root||eb.value.submorphs)}),2);va.asListWithIndexAndDepth(!1).forEach(function(eb){var ob=eb.node;return 0==eb.depth?ob.visible=!0:!M&&ob.keyString&&ob.keyString.includes("UNKNOWN PROPERTY")||!ha&&ob.keyString&&ob.keyString.includes("internal")?ob.visible=!1:ob.value&&ob.value.submorphs?ob.visible=!0:ob.visible=wa(ob)});Ua.jumpToEnd()})}},{key:"getChildren",value:function(N){return N.children}},{key:"display",value:function(N){return N.display(this.inspector)}},{key:"isCollapsed",
value:function(N){return N.isCollapsed}},{key:"isLeaf",value:function(N){return vd.obj.isPrimitive(N.value)}},{key:"collapse",value:function(N,G){var wa=this;N.isCollapsed=G;G||this.isLeaf(N)||N.children.length||(N.children=vd.propertiesOf(N).map(function(M){wa.parentMap.set(M,N);return M}))}},{key:"retrieveForRemoteProxy",value:function(N){N.uuid||(N.uuid=vd.newUUID(),this.idToNodeMap[N.uuid]=N);return{uuid:N.uuid,value:this.isLeaf(N)?N.value:{},keyString:N.keyString,key:N.keyString,valueString:vd.safeToString(N.value),
isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return vd.localInterface}},{key:"getNodeViaId",value:function(N){return this.idToNodeMap[N]}},{key:"asRemoteDelegate",value:function(N){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[N]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(N,G){return new this({key:"inspectee",value:{inspectee:N},isCollapsed:!0,inspector:G})}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(vd.TreeData);vd.InspectionTree=Td;vd.InspectionTree=
Td;vd.InspectionTree=Td;var Ce=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Ka=Oa.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Oa.RemoteInspectionTree?Oa.RemoteInspectionTree:Oa.RemoteInspectionTree=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(N){this.parentMap=new WeakMap;this.root=N.proxy;this.evalEnvironment=N.evalEnvironment;this.inspector=N.inspector;this.delegateId=N.delegateId}},{key:"getContextFor",value:function(N){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+N.uuid+'").value'}},{key:"dispose",value:function(){var N=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(G){return G.yield(N.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
N.delegateId+"']\n    ",N.evalEnvironment),0)})}},{key:"display",value:function(N){return N.keyString+": "+N.valueString}},{key:"collapse",value:function(N,G){var wa=this,M;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){if(1==ha.nextAddress)return(N.isCollapsed=G)||wa.isLeaf(N)?ha.return():N.children.length?ha.jumpTo(0):ha.yield(wa.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+N.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+wa.delegateId+'"]'}),3);M=ha.yieldResult;N.children=M.isError?[]:M.value;ha.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(N,G){var wa=this,M,ha,va,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return eb.yield(wa.createRemoteContext(N,G),2);M=eb.yieldResult;
ha=M.proxy;va=M.delegateId;Ua=M.evalEnvironment;return eb.return(new wa({key:"inspectee",proxy:ha,delegateId:va,evalEnvironment:Ua,inspector:G}))})}},{key:"createRemoteContext",value:function(N,G){var wa=N.code,M=N.evalEnvironment,ha=N.delegateId,va,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return ha="lively://inspector-"+G.id,eb.yield(M.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
wa+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+ha+'");\n    ',M),2);va=eb.yieldResult;Ua=va.value;return eb.return({delegateId:ha,evalEnvironment:M,proxy:Ua})})}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(vd.InspectionTree);
vd.RemoteInspectionTree=Ce;vd.RemoteInspectionTree=Ce;vd.RemoteInspectionTree=Ce;(function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Ka=Oa.hasOwnProperty("InspectionNode")&&"function"===typeof Oa.InspectionNode?Oa.InspectionNode:Oa.InspectionNode=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:Symbol.for("lively-instance-initialize"),value:function(N){var G=
N.root,wa=N.priority,M=N.key,ha=N.keyString,va=N.value,Ua=N.valueString,eb=N.isCollapsed,ob=void 0===N.children?[]:N.children,Tb=void 0===N.isSelected?!1:N.isSelected,Yb=void 0===N.visible?!0:N.visible;this.partition=N.partition;this.priority=wa;this.key=M;this.keyString=String(ha||M);this.value=va;this.valueString=Ua||vd.printValue(va);this.isCollapsed=eb;this.children=ob;this.isSelected=Tb;this.visible=Yb;this.root=G}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(N){if(N.value&&N.value.isMorph)return new vd.MorphNode(Object.assign({root:this.root},N));var G=N.key,wa=N.keyString,M=this.value,ha=N.partition;ha&&(M=ha.originalValue,wa=G);return new vd.PropertyNode(Object.assign({},N,{keyString:wa,key:G,target:M,partition:ha,root:this.root,spec:{}}))}},{key:"display",value:function(N){var G=this.keyString,wa=this.valueString;if(!this.interactive)return G+": "+wa;this._propertyWidget||(this._propertyWidget=
N.renderDraggableTreeLabel({value:G+": "+wa}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(N,G){G=void 0===G?null:G;return N.value&&N.value.isMorph?new vd.MorphNode(Object.assign({root:G},N)):new vd.InspectionNode(Object.assign({root:G},N))}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Ka=Oa.hasOwnProperty("MorphNode")&&"function"===typeof Oa.MorphNode?Oa.MorphNode:Oa.MorphNode=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:Symbol.for("lively-instance-initialize"),
value:function(N){mb._get(Object.getPrototypeOf(Ka.prototype),Symbol.for("lively-instance-initialize"),this).call(this,N);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(N){var G=this.propertyInfo[N.key]||{};return N.value&&N.value.isMorph?new vd.MorphNode(Object.assign({},N,{root:this.root})):new vd.PropertyNode(Object.assign({},N,{root:this.root,target:this.target,spec:G}))}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"MorphNode"}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(vd.InspectionNode);(function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Ka=Oa.hasOwnProperty("PropertyNode")&&"function"===typeof Oa.PropertyNode?
Oa.PropertyNode:Oa.PropertyNode=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:Symbol.for("lively-instance-initialize"),value:function(N){mb._get(Object.getPrototypeOf(Ka.prototype),Symbol.for("lively-instance-initialize"),this).call(this,N);var G=N.spec,wa=N.target;this.partition=N.partition;this.target=wa;this.spec=G;this.foldedNodes={}}},{key:"__deserialize__",value:function(N,G){this.spec={}}},
{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(N){this._interactive=N}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(N){return this.isFoldable?this.getFoldedContext(N):mb._get(Object.getPrototypeOf(Ka.prototype),"getSubNode",this).call(this,N)}},{key:"getFoldedContext",value:function(N){return this.foldedNodes[N.key]=
new vd.FoldedNode(Object.assign({},N,{root:this.root,target:this.target,foldableNode:this,spec:vd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(N,G){(G=void 0===G?!1:G)&&(this.target[this.key]=N);this.value=this.target[this.key];this.valueString=vd.printValue(this.value);this.interactive&&(G||this._propertyWidget.highlight());if(this.isFoldable)for(var wa in this.foldedNodes)this.foldedNodes[wa].value=
this.value[wa],this.foldedNodes[wa].valueString=vd.printValue(this.value[wa]),this.foldedNodes[wa]._propertyWidget&&vd.signal(this.foldedNodes[wa]._propertyWidget,"update",this.value[wa])}},{key:"display",value:function(N){var G=this,wa=this._propertyWidget,M=this.keyString,ha=this.valueString,va=this.target,Ua=this.value,eb=this.spec;if(!(this.interactive||eb.foldable&&vd.isMultiValue(Ua,eb.foldable)))return N.renderPropertyControl({target:va,keyString:M,valueString:ha,tree:N.ui.propertyTree,value:Ua,
spec:eb,node:this,fastRender:!0});if(wa)return wa.keyString=M,wa.valueString=ha,wa.isSelected=this.isSelected,wa.control&&(wa.control.isSelected=this.isSelected),wa;wa=this._propertyWidget=N.renderPropertyControl({target:va,keyString:M,valueString:ha,value:Ua,spec:eb,node:this,isSelected:this.isSelected,fontColor:N.ui.propertyTree.fontColor});this.isInternalProperty||eb.readOnly||(vd.connect(wa,"propertyValue",this,"refreshProperty",{updater:function(ob,Tb){return ob(Tb,!0)}}),vd.connect(wa,"openWidget",
this.root,"onWidgetOpened",{converter:function(ob){return{widget:ob,node:G.sourceObj}}}));return wa}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(vd.InspectionNode);(function(Ga){var Oa=
lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Ka=Oa.hasOwnProperty("FoldedNode")&&"function"===typeof Oa.FoldedNode?Oa.FoldedNode:Oa.FoldedNode=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:Symbol.for("lively-instance-initialize"),value:function(N){mb._get(Object.getPrototypeOf(Ka.prototype),Symbol.for("lively-instance-initialize"),this).call(this,N);this.foldableNode=
N=N.foldableNode;this.foldedProp=N.key+vd.string.capitalize(this.key)}},{key:"refreshProperty",value:function(N,G){G=void 0===G?!1:G;var wa={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(wa[this.key]=N,wa)),G)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(vd.PropertyNode);var Ae=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Ae.Color=cb;var ld=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Ka=Oa.hasOwnProperty("DarkTheme")&&"function"===typeof Oa.DarkTheme?Oa.DarkTheme:Oa.DarkTheme=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return mb(Ka,Ga,[{key:"background",get:function(){return Ae.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Ae.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Ae.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Ae.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Ae.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Ae.Color.white,fontWeight:"bold",backgroundColor:Ae.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Ae.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Ae.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],Oa,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),nf=ld=Ae.DarkTheme;Ae.default=ld;var gc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");gc.inspect=ua;gc.remoteInspect=J;gc.generateReferenceExpression=la;gc.onNumberDragStart=
function(Ga,Oa){Oa.initPos=Ga.position;Oa.factorLabel=(new gc.Tooltip({description:"1x"})).openInWorld(Ga.hand.position.addXY(10,10))};gc.onNumberDrag=function(Ga,Oa){var Ka=gc.getScaleAndOffset(Ga,Oa),N=Ka.scale;Ka=Ka.offset;Oa.factorLabel.position=Ga.hand.position.addXY(10,10);Oa.factorLabel.description=N+"x";return gc.getCurrentValue(Ka,N,Oa)};gc.onNumberDragEnd=function(Ga,Oa){var Ka=gc.getScaleAndOffset(Ga,Oa);Ga=Ka.offset;Ka=Ka.scale;Oa.factorLabel.softRemove();return gc.getCurrentValue(Ga,
Ka,Oa)};gc.getScaleAndOffset=function(Ga,Oa){var Ka=Ga.position.subPt(Oa.initPos);Ga=Ka.x;Oa=gc.num.roundTo(Math.exp(-Ka.y/$world.height*6),.01)*Oa.baseFactor;return{offset:Ga,scale:Oa}};gc.getCurrentValue=function(Ga,Oa,Ka){return Math.max(Ka.min,Math.min(Ka.max,Ka.scrubbedValue+(Ka.floatingPoint?Ga*Oa:Math.round(Ga*Oa))))};gc.Color=cb;gc.Rectangle=tb;gc.rect=tc;gc.pt=Fc;gc.obj=Zd;gc.num=od;gc.Path=cd;gc.arr=Pb;gc.promise=td;gc.connect=ic;gc.disconnect=nb;gc.once=xc;gc.Morph=cc;gc.Tooltip=wc;gc.VerticalLayout=
dc;gc.GridLayout=Nc;gc.HorizontalLayout=$a;gc.morph=vc;gc.CustomLayout=Xa;gc.Label=Gb;gc.Icon=ub;gc.StyleSheet=mc;gc.config=db;gc.Tree=Xb;gc.LoadingIndicator=Fa;gc.DropDownList=sb;gc.DropDownSelector=Ya;gc.SearchField=pb;gc.LabeledCheckBox=$b;gc.MorphHighlighter=Cb;gc.InteractiveMorphSelector=Bb;gc.printValue=Za;gc.RemoteInspectionTree=Ce;gc.InspectionTree=Td;gc.isMultiValue=hb;gc.valueWidgets=sa;gc.popovers=Ta;gc.DarkTheme=nf;gc.DefaultTheme=hc;gc.syncEval=lc;gc.inspectorCommands=[{name:"focus codeEditor",
exec:function(Ga){Ga.get("codeEditor").show();Ga.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ga){Ga.get("propertyTree").show();Ga.get("propertyTree").focus();return!0}}];(function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Ka=Oa.hasOwnProperty("DraggedProp")&&"function"===typeof Oa.DraggedProp?Oa.DraggedProp:Oa.DraggedProp=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return mb(Ka,Ga,[{key:"applyToTarget",value:function(N){var G=this.currentTarget,wa=this.control;this.remove();gc.MorphHighlighter.removeHighlighters(N.world);if(G)if(G.isText&&"js"===G.editorModeName){var M=G.evalEnvironment.context;N=G.textPositionFromPoint(G.localize(N.position));M=gc.generateReferenceExpression(this.sourceObject,{fromMorph:M});wa.keyString&&(M+="."+wa.keyString);G.insertTextAndSelect(M,N);G.focus()}else"propertyValue"in wa&&(G[wa.keyString]=wa.propertyValue)}},{key:"update",
value:function(N){N=N.hand.globalPosition;var G=this.morphBeneath(N);if(G){for(G==this.morphHighlighter&&(G=G.morphBeneath(N));[G].concat($jscomp.arrayFromIterable(G.ownerChain())).find(function(wa){return!wa.visible});)G=G.morphBeneath(N);if(G!=this.currentTarget){this.currentTarget=G;this.morphHighlighter&&this.morphHighlighter.deactivate();if(G.isWorld)return;this.morphHighlighter=gc.MorphHighlighter.for($world,G);this.morphHighlighter.show()}this.position=N}}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:gc.Color.rgb(169,204,227)},fill:{defaultValue:gc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var N=this.control;if(!N)return this.submorphs=[];this.height=22;this.submorphs=[N];N.top=0;N.fontSize=14;"function"===typeof N.relayout&&N.relayout();this.width=N.width+20;this.adjustOrigin(gc.pt(10,
10))}}}}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3714})})(gc.Morph);(function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Ka=Oa.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Oa.DraggableTreeLabel?Oa.DraggableTreeLabel:Oa.DraggableTreeLabel=
function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(N){this.draggedProp=new gc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();gc.connect(N.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(N){}},{key:"onDragEnd",value:function(N){gc.disconnect(N.hand,
"update",this.draggedProp,"update");this.draggedProp.applyToTarget(N)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:gc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:gc.Color.transparent},padding:{defaultValue:gc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],
set:function(N){this.setProperty("isSelected",N);N?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=N)}}}}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3716,
end:5055})})(gc.Label);Td=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Ka=Oa.hasOwnProperty("PropertyControl")&&"function"===typeof Oa.PropertyControl?Oa.PropertyControl:Oa.PropertyControl=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(N,G,wa){N.control=
new gc.DropDownSelector({opacity:.8,fill:gc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:G,padding:0,values:wa});gc.connect(N.control,"update",N,"propertyValue",{updater:function(M,ha){this.targetObj.propertyValue!=ha&&M(ha)}});gc.connect(N,"update",N.control,"selectedValue",{updater:function(M,ha){ha=ha&&ha.valueOf?ha.valueOf():ha;this.targetObj.propertyValue!=ha&&M(ha)}});return N}},{key:"toggleMultiValuePlaceholder",value:function(N){this.multiValuePlaceholder=
this.multiValuePlaceholder||this.addMorph({fill:gc.Color.transparent,layout:new gc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:gc.arr.range(0,2).map(function(G){return{type:"ellipse",fill:gc.Color.gray.withA(.5),reactsToPointer:!1,extent:gc.pt(7,7)}})});N?(gc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=
!0):(gc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(N){this.foldableProperties&&this.toggleMultiValuePlaceholder(gc.isMultiValue(N,this.foldableProperties))}},{key:"asFoldable",value:function(N){this.foldableProperties=N;gc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,
1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var N=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});N.isLayoutable=!1;N.fontWeight="bold";N.fontColor=gc.Color.orange;N.reactsToPointer=
!1;N.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(N){this.submorphs=[N]}},layout:{initialize:function(){this.layout=new gc.CustomLayout({relayout:function(N){N.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},
{key:"inferType",value:function(N){return(N=N.value)&&(N.isColor||N.isGradient)?"Color":N&&N.isPoint?"Point":gc.obj.isBoolean(N)?"Boolean":gc.obj.isNumber(N)?"Number":gc.obj.isString(N)?"String":N&&N.isRectangle?"Rectangle":!1}},{key:"render",value:function(N){N.spec.type||(N.spec=Object.assign({},N.spec,{isFloat:!Number.isInteger(N.value),type:this.inferType(N)}));switch(N.spec.type){case "Color":var G=this.renderColorControl(N);break;case "ColorGradient":G=this.renderColorControl(Object.assign({},
N,{gradientEnabled:!0}));break;case "Number":G=this.renderNumberControl(N);break;case "String":G=this.renderStringControl(N);break;case "RichText":G=this.renderStringControl(N);break;case "Layout":G=this.renderLayoutControl(N);break;case "Enum":G=this.renderEnumControl(N);break;case "Shadow":G=this.renderShadowControl(N);break;case "Point":G=this.renderPointControl(N);break;case "Rectangle":G=this.renderRectangleControl(N);break;case "Boolean":G=this.renderBooleanControl(N);break;default:G=this.renderItSomehow(N)}G.control&&
(gc.connect(G.control,"openWidget",G,"openWidget"),G.toggleFoldableValue(N.value));return G}},{key:"baseControl",value:function(N){var G=N.spec;N=new this({keyString:N.keyString,valueString:N.valueString,isSelected:!1,propertyValue:N.value});G.foldable&&N.asFoldable(G.foldable);return N}},{key:"renderGrabbableKey",value:function(N){var G=this,wa=N.target;return[N.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(M){M.state.draggedProp=new gc.DraggedProp({sourceObject:wa,control:G.baseControl(N)});
M.state.draggedProp.openInWorld();gc.connect(M.hand,"update",M.state.draggedProp,"update")},onDrag:function(M){},onDragEnd:function(M){gc.disconnect(M.hand,"update",M.state.draggedProp,"update");M.state.draggedProp.applyToTarget(M)}}]}},{key:"renderEnumControl",value:function(N){var G=N.value,wa=N.spec.values,M=N.keyString,ha=N.target,va=N.node,Ua=function(eb,ob){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tb){ha.world().openWorldMenu(eb,wa.map(function(Yb){return{string:Yb.toString(),
action:function(){ha[M]=Yb;va.rerender()}}}));Tb.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(N)),[" "+(G?G.valueOf?G.valueOf():G:"Not set"),{nativeCursor:"pointer",onMouseDown:Ua}],$jscomp.arrayFromIterable(gc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:Ua})))}},{key:"renderStringControl",value:function(N){var G=N.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(N)),[" "+(200<G.length?G.slice(0,
20)+"...":G),{fontColor:gc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(N){var G=N.value,wa=N.keyString,M=N.valueString,ha=N.target,va=N.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(N)),[" "+M,{fontColor:gc.Color.black,nativeCursor:"pointer",onMouseDown:function(Ua){var eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){if(1==ob.nextAddress)return eb=new gc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:G}),eb.relayout(),
ob.yield(eb.fadeIntoWorld(Ua.positionIn(ha.world())),2);gc.connect(eb,"rectangle",function(Tb){ha[wa]=Tb;va.rerender()});ob.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(N){var G=N.value,wa=N.keyString,M=N.valueString,ha=N.target,va=N.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(N)),[" "+M,{nativeCursor:"pointer",fontColor:G?gc.Color.green:gc.Color.red,onMouseDown:function(Ua){ha[wa]=!ha[wa];va.rerender()}}])}},{key:"renderNumberControl",value:function(N){var G=
N.value,wa=N.spec,M=N.keyString,ha=N.valueString,va=N.node,Ua=N.target,eb=N.tree,ob=void 0===va._numberControls?new id:va._numberControls,Tb=$jscomp.makeIterator(ob.submorphs),Yb=Tb.next().value,yc=Tb.next().value;ob.fontColor=eb.fontColor;var md=va._numberControls=ob;"max"in wa&&"min"in wa&&-Infinity!=wa.min&&Infinity!=wa.max?(md.baseFactor=(wa.max-wa.min)/100,md.floatingPoint=wa.isFloat,md.max=wa.max,md.min=wa.min):(md.floatingPoint=wa.isFloat,md.baseFactor=.5,md.min=void 0!=wa.min?wa.min:-Infinity,
md.max=void 0!=wa.max?wa.max:Infinity);var Bd=gc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(N)),$jscomp.arrayFromIterable(va._inputMorph?[va._inputMorph,{}]:[" "+(void 0!=G&&(G.valueOf?G.valueOf():G).toFixed(wa.isFloat?Math.max(4,gc.num.precision(G)):0))+" ",{fontColor:Bd,onMouseUp:function(Wc){va._inputMorph=gc.morph({type:"input",fill:null,fontColor:Bd,fontFamily:"IBM Plex Mono",fontSize:14,padding:gc.rect(8,2,-6,
2),height:23,cursorColor:gc.Color.white,value:G.valueOf?G.valueOf():ha});Ua[M]=G;va._inputMorph.focus();gc.once(va._inputMorph,"inputAccepted",function(Sd){delete va._inputMorph;Ua[M]=wa.isFloat?Number.parseFloat(Sd):Number.parseInt(Sd);va.rerender()});gc.once(va._inputMorph,"onBlur",function(Sd){va._inputMorph&&(delete va._inputMorph,Ua[M]=G,va.rerender())});va.rerender()},onDragStart:function(Wc){md.scrubbedValue=G;gc.onNumberDragStart(Wc,md)},onDrag:function(Wc){Ua[M]=gc.onNumberDrag(Wc,md);va.rerender()},
onDragEnd:function(Wc){return gc.onNumberDragEnd(Wc,md)}},ob,{onMouseUp:function(){Yb.fill=yc.fill=null},onMouseDown:function(Wc){if(Wc.targetMorph===Yb){Yb.fill=gc.Color.white.withA(.2);if("max"in wa&&Ua[M]>=wa.max)return;Ua[M]+=1}if(Wc.targetMorph===yc){yc.fill=gc.Color.white.withA(.2);if("min"in wa&&Ua[M]<=wa.min)return;--Ua[M]}va.rerender()}}]))}},{key:"renderShadowControl",value:function(N){var G=N.keyString,wa=N.value,M=N.target,ha=N.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(N)),
[""+(wa?wa.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(va){var Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return Ua=new gc.popovers.ShadowPopover({shadowValue:M[G],hasFixedPosition:!0}),eb.yield(Ua.fadeIntoWorld(va.positionIn(M.world())),2);gc.connect(Ua,"shadowValue",function(ob){M[G]=ob;ha.rerender()});eb.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(N){var G=N.keyString,wa=N.value,M=N.target,ha=N.node,va=gc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,
Ua={nativeCursor:"pointer",onMouseDown:function(eb){var ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tb){if(1==Tb.nextAddress)return ob=new gc.popovers.PointPopover({pointValue:M[G],hasFixedPosition:!0}),Tb.yield(ob.fadeIntoWorld(eb.positionIn(M.world())),2);gc.connect(ob,"pointValue",function(Yb){M[G]=Yb;ha.rerender()});Tb.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(N)),[" pt(",Object.assign({},Ua),""+wa.x.toFixed(),Object.assign({fontColor:va},
Ua),",",Object.assign({},Ua),""+wa.y.toFixed(),Object.assign({fontColor:va},Ua),")",Object.assign({},Ua)])}},{key:"renderLayoutControl",value:function(N){var G=N.valueString,wa=N.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(N)),[" "+(wa?G:"No Layout"),{onMouseDown:function(M){}}])}},{key:"renderColorControl",value:function(N){var G=N.node,wa=N.gradientEnabled,M=N.valueString,ha=N.keyString,va=N.value,Ua=N.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(N)),
[gc.morph({fill:va.valueOf?va.valueOf():va,extent:gc.pt(15,15),borderColor:gc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(va?va.valueOf?va.valueOf():M:"No Color"),{nativeCursor:"pointer",onMouseDown:function(eb){var ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tb){if(1==Tb.nextAddress)return ob=new gc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Ua,fillValue:va,title:"Fill Control",gradientEnabled:wa}),Tb.yield(ob.fadeIntoWorld(eb.positionIn(Ua.world())),
2);gc.connect(ob,"fillValue",function(Yb){Ua[ha]=Yb;G.rerender()});Tb.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(N){var G=N.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(N)),[" "+G,{}])}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5064,
end:20451})}(gc.DraggableTreeLabel);gc.PropertyControl=Td;gc.PropertyControl=Td;gc.PropertyControl=Td;gc.inspect=ua;gc.inspect=ua;gc.remoteInspect=J;gc.remoteInspect=J;gc.generateReferenceExpression=la;gc.generateReferenceExpression=la;var id=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Ka=Oa.hasOwnProperty("NumberControls")&&"function"===typeof Oa.NumberControls?Oa.NumberControls:Oa.NumberControls=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return mb(Ka,Ga,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new gc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:gc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(N){this.submorphs.map(function(G){return G.fontColor=N})}},submorphs:{initialize:function(){this.submorphs=[gc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,
nativeCursor:"pointer",padding:gc.rect(5,2,0,-6),fontSize:12}),gc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:gc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23124,end:24169})}(gc.Morph);
(function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Ka=Oa.hasOwnProperty("PropertyTree")&&"function"===typeof Oa.PropertyTree?Oa.PropertyTree:Oa.PropertyTree=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:"onDrag",value:function(N){this._onDragHandler&&this._onDragHandler(N)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Oa,{pathInPackage:function(){return"js/inspector.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25334,end:25445})})(gc.Tree);Td=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Ka=Oa.hasOwnProperty("Inspector")&&"function"===typeof Oa.Inspector?Oa.Inspector:Oa.Inspector=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return mb(Ka,Ga,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(N){}},{key:"__after_deserialize__",value:function(N,G,wa){var M=this,ha=new gc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:gc.InspectionTree.forObject(null,this)}));this.addMorph(ha,this.getSubmorphNamed("terminal toggler"));mb._get(Object.getPrototypeOf(Ka.prototype),
"__after_deserialize__",this).call(this,N,G,wa);!this.isComponent&&this.master.whenApplied().then(function(){M.layout.col(0).row(1).group.morph=ha;M.targetObject&&(M.targetObject=M.targetObject)})}},{key:"__additionally_serialize__",value:function(N,G,wa,M){N=N.props.submorphs.value;for(G=N.length;G--;)wa.refForId(N[G].id).realObj==this.ui.propertyTree&&gc.arr.removeAt(N,G)}},{key:"renderDraggableTreeLabel",value:function(N){return new gc.DraggableTreeLabel(N)}},{key:"renderPropertyControl",value:function(N){return gc.PropertyControl.render(N)}},
{key:"onLoad",value:function(){var N=this.ui,G=N.codeEditor,wa=N.thisBindingSelector,M=N.propertyTree;G.changeEditorMode("js").then(function(){return G.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==wa.selection?G.owner.selectedContext:G.owner.targetObject},get systemInterface(){return gc.Path("treeData.systemInterface").get(M)},format:"esm"}}).catch(function(ha){return $world.logError(ha)})}},{key:Symbol.for("lively-instance-initialize"),value:function(N){mb._get(Object.getPrototypeOf(Ka.prototype),
Symbol.for("lively-instance-initialize"),this).call(this,N);N=this.ui;var G=N.targetPicker,wa=N.propertyTree,M=N.resizer,ha=N.terminalToggler,va=N.unknowns,Ua=N.internals,eb=N.searchField,ob=N.codeEditor,Tb=N.fixImportButton,Yb=N.thisBindingSelector;ob.changeEditorMode("js").then(function(){return ob.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Yb.selection?ob.owner.selectedContext:ob.owner.targetObject},get systemInterface(){return wa.treeData.systemInterface},
format:"esm"}}).catch(function(yc){return $world.logError(yc)});gc.connect(G,"onMouseUp",this,"selectTarget");gc.connect(wa,"onScroll",this,"repositionOpenWidget");gc.connect(M,"onDrag",this,"adjustProportions");gc.connect(ha,"onMouseDown",this,"toggleCodeEditor");gc.connect(va,"trigger",this,"filterProperties");gc.connect(Ua,"trigger",this,"filterProperties");gc.connect(eb,"searchInput",this,"filterProperties");gc.connect(wa,"nodeCollapseChanged",this,"filterProperties");gc.connect(this,"extent",
this,"relayout");gc.connect(Yb,"selection",this,"bindCodeEditorThis");gc.connect(Tb,"fire",ob,"execCommand",{updater:function(yc){return yc("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var N=this.ui.propertyTree.selectedIndex-1,G=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();G=this.ui.propertyTree.document.getLine(N).textAndAttributes.slice(0,4).concat(G.display(this));N=this.ui.propertyTree.lineRange(N,
!1);this.ui.propertyTree.replace(N,G,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var N=gc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(N!=this.lastChange||
this.lastSubmorphs!=gc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==N.prop&&this.repositionOpenWidget(),this.lastChange=N,this.lastSubmorphs=gc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var N;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(G){G=G.node;G.target&&(N=G.foldableNode?G.target[G.foldableNode.key][G.key]:
G.target[G.key],!gc.obj.equals(N,G.value)&&G.refreshProperty&&G.refreshProperty(N))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(N,G){G=void 0===G?!1:G;var wa=this,M,ha,va,Ua,eb,ob,Tb,Yb,yc,md,Bd,Wc,Sd,Qd,Ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yd){switch(yd.nextAddress){case 1:if(!wa.isUpdating()){yd.jumpTo(2);break}return yd.yield(wa.whenUpdated(),
2);case 2:M=gc.promise.deferred();ha=M.promise;va=!!wa.target;wa.updateInProgress=ha;yd.setCatchFinallyBlocks(4);G&&(Ua=gc.LoadingIndicator.open("connecting to remote..."));if(!G){eb=gc.InspectionTree.forObject(N,wa);yd.jumpTo(6);break}return yd.yield(gc.RemoteInspectionTree.forObject(N,wa),7);case 7:eb=yd.yieldResult;case 6:return ob=eb,Tb=wa.ui.propertyTree,yd.yield(ob.collapse(ob.root,!1),8);case 8:if(!ob.root.children){yd.jumpTo(9);break}return yd.yield(ob.collapse(ob.root.children[0],!1),9);
case 9:if(Yb=wa.originalTreeData&&wa.originalTreeData.diff(ob)){yc=$jscomp.makeIterator(Yb);for(md=yc.next();!md.done;md=yc.next())Bd=md.value,Wc=$jscomp.makeIterator(Bd),Sd=Wc.next().value,Qd=Wc.next().value,Sd.refreshProperty(Qd.value);yd.jumpTo(11);break}Tb.treeData=ob;return yd.yield(wa.filterProperties(),12);case 12:if(!Tb.treeData.root.isCollapsed){yd.jumpTo(13);break}return yd.yield(Tb.onNodeCollapseChanged({node:ob.root,isCollapsed:!1}),14);case 14:Tb.selectedIndex=1;case 13:return yd.yield(Tb.execCommand("uncollapse selected node"),
11);case 11:wa.toggleWindowStyle(va);Ua&&Ua.remove();yd.leaveTryBlock(5);break;case 4:Ed=yd.enterCatchBlock(),wa.showError(Ed);case 5:wa.startStepping(1E3,"refreshAllProperties"),wa.updateInProgress=null,yd.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(N){N=void 0===N?!0:N;var G=this,wa,M,ha,va,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return wa=300,va=G.ui.codeEditor.pluginFind(function(ob){return ob.runEval}),Ua=G.getWindow(),eb.yield(va.runEval("System.get('@system-env').node"),
2);eb.yieldResult.value?(ha=[].concat($jscomp.arrayFromIterable(gc.arr.without(Ua.styleClasses,"local")),["node"]),M=gc.DarkTheme.instance):(ha=["local"].concat($jscomp.arrayFromIterable(Ua?gc.arr.without(Ua.styleClasses,"node"):[])),M=gc.DefaultTheme.instance);va.theme=M;N?(Ua&&Ua.animate({duration:wa,styleClasses:ha}),G.ui.codeEditor.animate({fill:M.background,duration:wa})):Ua&&(Ua.styleClasses=ha);G.ui.codeEditor.textString=G.ui.codeEditor.textString;va.highlight();eb.jumpToEnd()})}},{key:"isUpdating",
value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var N=this,G=Object.assign({type:"text",borderWidth:1,borderColor:gc.Color.gray,lineWrapping:"by-chars"},gc.config.codeEditor.defaultStyle,{textString:""}),wa=gc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});gc.rect(0,0,this.width,30);var M=new gc.SearchField({styleClasses:["idle"],
name:"searchField"});wa[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[M,{type:"button",name:"targetPicker",padding:gc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:gc.Icon.textAttribute("crosshairs")},new gc.LabeledCheckBox({label:"Internals",name:"internals"}),new gc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new gc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:gc.InspectionTree.forObject(null,
this)})),gc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},G),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:gc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(wa),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(wa),[" selection",null])}]}];
this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){N.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var N=this,G,wa,M,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(va){switch(va.nextAddress){case 1:if(N.env.eventDispatcher.isKeyPressed("Shift"))return wa=$jscomp,M=wa.makeIterator,va.yield($world.execCommand("select morph",{justReturn:!0}),
5);N.toggleSelectionInstructions(!0);return va.yield(gc.InteractiveMorphSelector.selectMorph(),4);case 4:G=va.yieldResult;N.toggleSelectionInstructions(!1);va.jumpTo(3);break;case 5:ha=M.call(wa,va.yieldResult),G=ha.next().value;case 3:G&&(N.targetObject=G),va.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(N){if(N&&!this.instructionWidget){var G=gc.morph({type:"label",name:"escapeKey",value:"esc"});G.whenRendered().then(function(){return G.fit()});this.instructionWidget=this.addMorph({type:"text",
opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},G,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(N){N=N.widget;this.openWidget&&
this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;N.epiMorph=!0;this.openWidget=N;gc.once(N,"close",this,"closeOpenWidget");gc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var N=this.ui.propertyTree,G=N.textLayout.boundsFor(N,{column:0,row:N.selectedIndex-1});G=N.worldPoint(gc.pt(G.x,G.y+G.height/2)).addPt(N.scroll.negated());N=N.globalBounds();G.x=this.globalBounds().center().x;G.y<N.top()?G=N.topCenter():N.bottom()-
20<G.y&&(G=N.bottomCenter().addXY(0,-20));return G}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(N){this.layout.row(1).height+=N.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(N){if(N!==this.isEditorVisible()){var G=this.extent,wa=this.layout,M=this.ui,ha=M.terminalToggler,
va=M.codeEditor,Ua=M.thisBindingSelector;M=M.fixImportButton;wa.disable();N?(ha.fontColor=gc.Color.rgbHex("00e0ff"),wa.row(3).height=this.codeEditorHeight||180,wa.row(2).height=5,M.animate({visible:!0,duration:200}),Ua.animate({visible:!0,duration:200})):(this.codeEditorHeight=wa.row(3).height,ha.fontColor=gc.Color.white,wa.row(3).height=wa.row(2).height=0,M.animate({visible:!1,duration:200}),Ua.animate({visible:!1,duration:200}));this.extent=G;wa.enable({duration:200});this.relayout({duration:200});
va.focus();va.animate({opacity:N?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var N=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(G){N.makeEditorVisible(!N.isEditorVisible());G.jumpToEnd()})}},{key:"filterProperties",value:function(){var N=this,G,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){if(1==M.nextAddress)return G=N.ui.searchField,wa=N.ui.propertyTree,N.originalTreeData||(N.originalTreeData=wa.treeData),gc.disconnect(wa.treeData,"onWidgetOpened",
N,"onWidgetOpened"),M.yield(wa.treeData.filter({maxDepth:2,showUnknown:N.ui.unknowns.checked,showInternal:N.ui.internals.checked,iterator:function(ha){return G.matches(ha.key)}}),2);wa.update();gc.connect(wa.treeData,"onWidgetOpened",N,"onWidgetOpened");M.jumpToEnd()})}},{key:"relayout",value:function(N){N=void 0===N?{}:N;var G=this,wa,M,ha,va,Ua,eb,ob,Tb,Yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yc){G.layout&&G.layout.forceLayout();wa=G;M=wa.ui;ha=M.fixImportButton;va=M.terminalToggler;
Ua=M.propertyTree;eb=M.thisBindingSelector;ob=Ua.bounds().insetBy(5).bottomLeft();Tb=Ua.bounds().insetBy(5).bottomRight();Yb=Tb.subXY(ha.width+10,0);eb.width=115;eb.listMorph.itemHeight=20;N.duration?(va.animate(Object.assign({bottomLeft:ob},N)),ha.animate(Object.assign({bottomRight:Tb},N)),eb.animate(Object.assign({bottomRight:Yb},N))):(va.bottomLeft=ob,ha.bottomRight=Tb,eb.bottomRight=Yb);yc.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",
command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(mb._get(Object.getPrototypeOf(Ka.prototype),"keybindings",this))}},{key:"commands",get:function(){return gc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(N){if(System._testsRunning)return console.log(N.targetObject);N=new this(N);N.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return N}},{key:"properties",
get:function(){return{extent:{defaultValue:gc.pt(400,500)},fill:{defaultValue:gc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(N){this.setProperty("remoteTarget",N);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(N,!0))}},targetObject:{after:["submorphs"],set:function(N){this._serializableTarget=N&&N.isMorph?N.id:N;this.setProperty("targetObject",N);this.ui.propertyTree&&(this.originalTreeData=
null,this.prepareForNewTargetObject(N))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var N=this.ui.propertyTree,G=N.treeData;return G.getContextFor(N.selectedNode||G.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),
propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:gc.Color.gray,fontSize:14,fontFamily:gc.config.codeEditor.defaultStyle.fontFamily}},
master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25462,end:46018})}(gc.Morph);Td=gc.Inspector;Ce=za("I",Td);gc.default=Td;var fe=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");
fe.Inspector=Ce;fe.string=zc;fe.Morph=cc;fe.pt=Fc;fe.Color=cb;Td=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ga,Oa,Ka){Ka=void 0===Ka?1:Ka;var N,G,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){switch(M.nextAddress){case 1:return Ga.maybeSelectCommentOrLine(),M.setCatchFinallyBlocks(2),Oa=Object.assign({},Oa,{logDoit:!0,inspect:!0,inspectDepth:Ka}),M.yield(Ga.doEval(void 0,Oa),4);case 4:N=M.yieldResult;G=N.error?N.error:
N.isError?N.value:null;M.leaveTryBlock(3);break;case 2:G=wa=M.enterCatchBlock();case 3:return G?Ga.showError(G):Ga.setStatusMessage(fe.string.truncate(N.value,1E3)),M.return(N)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ga,Oa){var Ka,N,G;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){switch(wa.nextAddress){case 1:return wa.setCatchFinallyBlocks(2),wa.yield(Ga.doEval({start:{row:0,column:0},end:Ga.documentEndPosition},Object.assign({},
Oa,{logDoit:!0})),4);case 4:Ka=wa.yieldResult;N=Ka.error?Ka.error:Ka.isError?Ka.value:null;wa.leaveTryBlock(3);break;case 2:N=G=wa.enterCatchBlock();case 3:return N?Ga.showError(N):Ga.setStatusMessage(String(Ka.value)),wa.return(Ka)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ga,Oa){var Ka,N,G,wa,M,ha,va,Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){switch(eb.nextAddress){case 1:return Ga.maybeSelectCommentOrLine(),
eb.setCatchFinallyBlocks(2),Oa=Object.assign({},Oa,{asString:!1,logDoit:!0}),eb.yield(Ga.doEval(void 0,Oa),4);case 4:Ka=eb.yieldResult;N=Ka.error?Ka.error:Ka.isError?Ka.value:null;eb.leaveTryBlock(3);break;case 2:N=G=eb.enterCatchBlock();case 3:Ga.selection.collapseToEnd();if(wa=Ka.value&&Ka.value.isColor)return Ga.selection.text=String(Ka.value),M=new fe.Morph({fill:fe.Color.transparent,extent:fe.pt(Ga.fontSize+2,Ga.fontSize+2),submorphs:[{fill:Ka.value,center:fe.pt(Ga.fontSize+2,Ga.fontSize+2).scaleBy(.5)}]}),
ha=Ga.selection.start,va=ha.column,Ua=ha.row,Ga.insertText([M,{}],Ga.selection.start),Ga.selection.start={column:va,row:Ua},Ga.focus(),eb.return(Ka);Ga.insertTextAndSelect(N?String(N)+(N.stack?"\n"+N.stack:""):String(Ka.value));Ga.focus();return eb.return(Ka)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ga,Oa){var Ka,N,G,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){switch(M.nextAddress){case 1:Ga.maybeSelectCommentOrLine();
N=Ga.textInRange(Ga.selection);G=Ga.evalEnvironment||{};wa=Ga.pluginFind(function(ha){return ha.isEditorPlugin&&"function"===typeof ha.runEval});G.systemInterface||(G.systemInterface=wa.systemInterface(Oa));if("local"!==G.systemInterface.name){M.jumpTo(2);break}M.setCatchFinallyBlocks(3);return M.yield(Ga.doEval(void 0,Oa),5);case 5:Ka=M.yieldResult;N=Ka.value;M.leaveTryBlock(2);break;case 3:M.enterCatchBlock();case 2:return Ga.world().execCommand("open object editor",{target:N,evalEnvironment:G}),
M.return(Ka)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Ga,Oa){var Ka,N,G,wa,M,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(va){switch(va.nextAddress){case 1:Ga.maybeSelectCommentOrLine();G=Ga.textInRange(Ga.selection);wa=Ga.evalEnvironment||{};M=Ga.pluginFind(function(Ua){return Ua.isEditorPlugin&&"function"===typeof Ua.runEval});wa.systemInterface||(wa.systemInterface=M.systemInterface(Oa));if("local"!==
wa.systemInterface.name){fe.Inspector.openInWindow({remoteTarget:{code:G,evalEnvironment:wa}});va.jumpTo(2);break}va.setCatchFinallyBlocks(3);return va.yield(Ga.doEval(void 0,Oa),5);case 5:Ka=va.yieldResult;N=Ka.error?Ka.error:Ka.isError?Ka.value:null;G=Ka.value;va.leaveTryBlock(4);break;case 3:N=ha=va.enterCatchBlock();case 4:fe.Inspector.openInWindow({targetObject:N||G});case 2:return va.return(Ka)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(Ga,Oa,Ka){Ka=void 0===Ka?1:Ka;var N;return $jscomp.asyncExecutePromiseGeneratorProgram(function(G){switch(G.nextAddress){case 1:return Ga.maybeSelectCommentOrLine(),G.setCatchFinallyBlocks(2),Oa=Object.assign({},Oa,{inspect:!0,inspectDepth:Ka,logDoit:!0}),G.yield(Ga.doEval(void 0,Oa),4);case 4:N=G.yieldResult;G.leaveTryBlock(3);break;case 2:G.enterCatchBlock();case 3:return Ga.selection.collapseToEnd(),Ga.insertTextAndSelect(N.value),G.return(N)}})}}];fe.codeEvaluationCommands=
Td;fe.codeEvaluationCommands=Td;fe.codeEvaluationCommands=Td;var Ec=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Ec.changeAttributeInSelectionOrMorph=function(Ga,Oa,Ka){var N=Ga.selection;Ga.keepPosAtSameScrollOffsetWhile(function(){N.isEmpty()?Ga[Oa]="function"===typeof Ka?Ka(Ga[Oa]):Ka:(Ga.undoManager.group(),Ga.changeStyleProperty(Oa,function(G){return"function"===typeof Ka?Ka(G):Ka}),Ga.undoManager.group())})};Ce=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(Ga){var Oa=Ga.fontSize;Ec.changeAttributeInSelectionOrMorph(Ga,"fontSize",function(Ka){Ka=Ka||Oa;return Ka+(18<=Ka?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ga){var Oa=Ga.fontSize;Ec.changeAttributeInSelectionOrMorph(Ga,"fontSize",function(Ka){Ka=Ka||Oa;return Ka-(18>=Ka?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ga){var Oa,Ka,N,G,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){if(1==M.nextAddress){Oa=
["serif","sans-serif","monospace"];if(Ka=localStorage["lively.morpic/text-change-font-additional-fonts"])Ka=JSON.parse(Ka),Oa.push.apply(Oa,$jscomp.arrayFromIterable(Ka));Oa.map(function(ha){return ha.toLowerCase()}).includes(Ga.fontFamily.toLowerCase())||(Oa.push(Ga.fontFamily),Ka=[].concat($jscomp.arrayFromIterable(Ka||[]),[Ga.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Ka));return M.yield($world.editListPrompt("choose font",Oa,{requester:Ga,preselect:Oa.indexOf(Ga.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}N=M.yieldResult;G=$jscomp.makeIterator(N.selections);if(wa=G.next().value)Ga.fontFamily=wa;return M.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ga,Oa){Oa=void 0===Oa?{}:Oa;var Ka,N,G,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){if(1==M.nextAddress){if(Oa.hasOwnProperty("link"))return M.jumpTo(2);N=Ga.selection;G=Ga.getStyleInRange(N);wa=G.link;return M.yield(Ga.world().prompt("Set link",
{input:wa||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=M.nextAddress&&(Ka=M.yieldResult,!Ka))return M.return();Ga.undoManager.group();Ga.setStyleInRange({link:Ka||void 0},N);Ga.undoManager.group();M.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ga,Oa){var Ka,N,G,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){if(1==M.nextAddress)return Ka=Ga.selection,N=Ga.getStyleInRange(Ka),G=N.doit,M.yield(Ga.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:Ga,input:G?G.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ga.evalEnvForDoit(G||{})}),2);wa=M.yieldResult;Ga.undoManager.group();wa?Ga.addTextAttribute({doit:{code:wa},nativeCursor:"pointer",textDecoration:"underline"},Ka):Ga.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Ka);Ga.undoManager.group();M.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ga,Oa){Oa=void 0===Oa?{}:Oa;Ga.undoManager.group();
Oa=!Oa.onlySelection&&Ga.selection.isEmpty()?Ga.documentRange:Ga.selection.range;Ga.setStyleInRange(null,Oa);Ga.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ga){var Oa,Ka,N,G;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){if(1==wa.nextAddress)return wa.yield(System.import("lively.modules"),2);if(3!=wa.nextAddress)return Oa=wa.yieldResult,Ka=Oa.module,wa.yield(Ka("lively.ide/text/ui.js").load(),3);N=wa.yieldResult;G=N.RichTextControl;return wa.return(G.openFor(Ga))})}}];
Ec.commands=Ce;Ec.commands=Ce;Ec.commands=Ce;var pe=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");pe.guessTextModeName=La;pe.rangedToken=function(Ga,Oa,Ka,N,G){return{start:{row:Ga,column:Oa},end:{row:Ga,column:Ka},token:N,mode:G}};pe.fun=Jb;pe.arr=Pb;pe.connect=ic;pe.disconnect=nb;pe.DefaultTheme=hc;pe.tokenizeDocument=Hc;pe.modeInfo=Ib;pe.visitDocumentTokens=Ab;pe.getMode=ea;pe.completionCommands=Oc;pe.multiSelectCommands=r;pe.navCommands=ke;pe.codeCommands=ge;pe.codeEvaluationCommands=
Td;pe.richTextCommands=Ce;pe.Color=cb;pe.Range=Gd;pe.guessTextModeName=La;pe.guessTextModeName=La;hc=function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Ka=Oa.hasOwnProperty("EditorPlugin")&&"function"===typeof Oa.EditorPlugin?Oa.EditorPlugin:Oa.EditorPlugin=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
pe.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(N){var G=this;this.textMorph=N;pe.connect(N,"textChange",this,"onTextChange");pe.connect(N,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return G.highlight()})}},
{key:"detach",value:function(N){pe.disconnect(N,"textChange",this,"onTextChange");pe.disconnect(N,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(N){this._ast=null;if(N){var G=this._tokenizerValidBefore;if("replace"===N.selector){var wa=N.args[0].start;N=wa.row;wa=wa.column}else wa=N=0;if(!G||N<G.row||N===G.row&&wa<G.column)N=Math.max(0,N),this._tokenizerValidBefore={row:N,column:wa}}this.requestHighlight()}},
{key:"requestHighlight",value:function(N){var G=this;(void 0===N?0:N)?this.highlight():pe.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return G.highlight()})()}},{key:"highlight",value:function(){var N=this.textMorph,G=this.theme,wa=this.mode,M=this._tokenizerValidBefore;if(G&&N&&N.document&&wa){N.fill=G.background;N.cursorColor=G.cursorColor||pe.Color.black;var ha=N.viewState,va={};M=pe.tokenizeDocument(wa,N.document,ha.firstVisibleRow,ha.lastVisibleRow,M);wa=M.lines;M=M.tokens;if(wa.length){ha=
wa[0].row;for(var Ua=[],eb=0;eb<M.length;ha++,eb++)for(var ob=M[eb],Tb=0;Tb<ob.length;Tb+=5){var Yb=ob[Tb],yc=ob[Tb+1],md=G[ob[Tb+2]]||G.default;md&&Ua.push({start:{row:ha,column:Yb},end:{row:ha,column:yc}},md)}N.embeddedMorphs.forEach(function(Bd){var Wc=N.embeddedMorphMap.get(Bd).anchor;va[Bd.id]=N.textAttributeAt(Wc.position)});N.setTextAttributesWithSortedRanges(Ua);N.embeddedMorphs.forEach(function(Bd){var Wc=N.embeddedMorphMap.get(Bd).anchor;Wc=pe.Range.at(Wc.position);Wc.end.column+=1;N.replace(Wc,
[Bd,va[Bd.id]],!1)});this._tokenizerValidBefore={row:pe.arr.last(wa).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},N,this)}}},{key:"visitTokensInRange",value:function(N,G){var wa=N.start,M=N.end,ha=wa.row-1;pe.visitDocumentTokens(this.mode,this.textMorph.document,wa.row,M.row,null,function(va){return ha++},function(va,Ua,eb,ob,Tb,Yb,yc){if(ha===wa.row&&0<wa.column){if(wa.column>=ob)return;eb<wa.column&&wa.column<ob&&(eb=wa.column)}if(ha===M.row){if(M.column<=eb)return;eb<M.column&&
M.column<ob&&(ob=M.column)}G(va,Ua,ha,eb,ob,Tb,Yb,yc)})}},{key:"tokensInRange",value:function(N){var G=[];this.visitTokensInRange(N,function(wa,M,ha,va,Ua,eb,ob,Tb){return G.push(pe.rangedToken(ha,va,Ua,wa,Tb))});return G}},{key:"tokensOfRow",value:function(N){var G=this.textMorph.getLine(N).length;return this.tokensInRange({start:{row:N,column:0},end:{row:N,column:G}})}},{key:"tokenAt",value:function(N){for(var G=this.tokensOfRow(N.row),wa=G.length;wa--;){var M=G[wa];if(M.token&&M.start.column<=
N.column&&N.column<=M.end.column)return M}return null}},{key:"getCommands",value:function(N){return[].concat($jscomp.arrayFromIterable(N),$jscomp.arrayFromIterable(pe.completionCommands),$jscomp.arrayFromIterable(pe.multiSelectCommands),$jscomp.arrayFromIterable(pe.navCommands),$jscomp.arrayFromIterable(pe.codeCommands),$jscomp.arrayFromIterable(pe.codeEvaluationCommands),$jscomp.arrayFromIterable(pe.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;var N=this.mode,
G=N.lineComment,wa=N.blockCommentStart;N=N.blockCommentEnd;var M={};G&&(M.lineCommentStart=G);wa&&(M.blockCommentStart=wa);N&&(M.blockCommentEnd=N);return M}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(N,G,wa){var M=this.textMorph,ha=N.row,va=N.column;N=G[va-1];G=G[va];M.selection.text="\n";M.selection.collapseToEnd();"{"===N&&"}"===G&&(M.selection.text="\n"+" ".repeat(wa),M.selection.collapse());M.execCommand("indent according to mode",
{undo:!1,ignoreFollowingText:!1,firstRow:ha+1,lastRow:ha+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var N=this.textMorph,G=this.openPairs,wa=N.selection,M=N.getLine(wa.end.row),ha=M[wa.end.column-1];M=M[wa.end.column];N.autoInsertPairs&&wa.isEmpty()&&ha in G&&M===G[ha]&&(wa.growRight(1),wa.growLeft(1));
return!1}},{key:"cmd_insertstring",value:function(N){var G=this.openPairs,wa=this.closePairs,M=this.textMorph,ha=M.selection,va=M.autoInsertPairs&&N in G,Ua=M.autoInsertPairs&&N in wa;if(!va&&!Ua)return!1;var eb=M.getLine(ha.end.row)[ha.end.column];if(!ha.isEmpty()){if(!va)return!1;wa=M.undoManager.ensureNewGroup(M);M.insertText(G[N],ha.end);M.insertText(N,ha.start);M.undoManager.group(wa);ha.growRight(-1);return!0}if(eb in wa&&N===eb)return ha.goRight(1),!0;if(Ua&&!va)return!1;wa=M.undoManager.ensureNewGroup(M);
M.insertText(N+G[N]);M.undoManager.group(wa);ha.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Oa,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3148,end:11979})}(void 0);Ib=hc=pe.EditorPlugin;Oc=za("C",function(Ga){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),
Ka=Oa.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Oa.CodeMirrorEnabledEditorPlugin?Oa.CodeMirrorEnabledEditorPlugin:Oa.CodeMirrorEnabledEditorPlugin=function(N){N&&N[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(Ka,Ga,[{key:Symbol.for("lively-instance-initialize"),value:function(){mb._get(Object.getPrototypeOf(Ka.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},
{key:"attach",value:function(N){this.mode=this.codeMirrorMode(N);return mb._get(Object.getPrototypeOf(Ka.prototype),"attach",this).call(this,N)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(N){return{indentWithTabs:!N.useSoftTabs,indentUnit:N.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(N){N=this.defaultCodeMirrorModeConfig(N);return pe.getMode(N,{name:this.longName})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Oa,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11988,end:12682})}(pe.EditorPlugin));pe.CodeMirrorEnabledEditorPlugin=Oc;pe.CodeMirrorEnabledEditorPlugin=Oc;pe.CodeMirrorEnabledEditorPlugin=
Oc;pe.default=hc;hc=Object.freeze({__proto__:null,guessTextModeName:La,"default":Ib,CodeMirrorEnabledEditorPlugin:Oc});za("e",hc)}}});
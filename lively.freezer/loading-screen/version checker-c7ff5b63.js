System.register(["./__root_module__-884b54f8.js","./index-b01a734e.js","kld-intersections","./index-27557bc7.js"],function(){var za,cb,mb,Pb,tb;return{setters:[function(Fc){za=Fc.M;cb=Fc.bc;mb=Fc.r;Pb=Fc.i},function(Fc){tb=Fc.e},function(){},function(){}],execute:function(){var Fc=lively.FreezerRuntime.recorderFor("VersionChecker/index.js");Fc.Morph=za;Fc.runCommand=cb;Fc.evalOnServer=tb;Fc.resource=mb;var vc=function(Qc){var mc=lively.FreezerRuntime.recorderFor("VersionChecker/index.js"),ic=
mc.hasOwnProperty("VersionChecker")&&"function"===typeof mc.VersionChecker?mc.VersionChecker:mc.VersionChecker=function(zc){zc&&zc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Pb(ic,Qc,[{key:"onLoad",value:function(){this.isComponent||this.withAllSubmorphsDo(function(zc){return zc.halosEnabled=!1})}},{key:"checkVersion",value:function(){this.reset();this.checkIfUpToDate()}},{key:"onMouseDown",value:function(zc){Pb._get(Object.getPrototypeOf(ic.prototype),
"onMouseDown",this).call(this,zc);this.isComponent||this.checkVersion()}},{key:"relayout",value:function(){this.bottomLeft=this.world().visibleBounds().insetBy(10).bottomLeft()}},{key:"checkIfUpToDate",value:function(){var zc=this,Dc,Gd,Hd,Zd,xc,od,qb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){switch(kc.nextAddress){case 1:return Dc="git rev-parse master",kc.yield(Fc.evalOnServer("System.baseURL").then(function(Uc){return Uc.replace("file://","")}),2);case 2:return Gd=kc.yieldResult,
kc.yield(Fc.runCommand("git fetch",{cwd:Gd}).whenDone(),3);case 3:return kc.yield(Fc.runCommand(Dc,{cwd:Gd}).whenDone(),4);case 4:return Hd=kc.yieldResult,Zd=Hd.stdout,xc=Zd.split("\n")[0],kc.yield(Fc.resource("https://api.github.com/repos/LivelyKernel/lively.next/commits/master").readJson(),5);case 5:return od=kc.yieldResult,qb=od.sha,xc!=qb?kc.return(zc.showOutdated(xc.slice(0,6))):kc.return(zc.showUpToDate(xc.slice(0,6)))}})}},{key:"showOutdated",value:function(zc){var Dc=this.ui,Gd=Dc.checking,
Hd=Dc.outdated;Dc.status.value=["Version: ",{},"["+zc+"]",{fontWeight:"bold"}," (Please update!)"];Gd.visible=Gd.isLayoutable=!1;Hd.visible=Hd.isLayoutable=!0}},{key:"showUpToDate",value:function(zc){var Dc=this.ui,Gd=Dc.checking,Hd=Dc.latest;Dc.status.value=["Version: ",{},"["+zc+"]",{fontWeight:"bold"}];Gd.visible=Gd.isLayoutable=!1;Hd.visible=Hd.isLayoutable=!0}},{key:"reset",value:function(){var zc=this.ui,Dc=zc.checking,Gd=zc.outdated,Hd=zc.latest;zc.status.value="Checking version...";Dc.visible=
Dc.isLayoutable=!0;Gd.visible=Hd.visible=Gd.isLayoutable=Hd.isLayoutable=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"VersionChecker"}},{key:"properties",get:function(){return{isEpiMorph:{derived:!0,get:function(){return!this.isComponent}},respondsToVisibleWindow:{derived:!0,get:function(){return!this.isComponent}},ui:{derived:!0,get:function(){return{status:this.get("version status label"),checking:this.get("loading indicator"),outdated:this.get("icon outdated"),latest:this.get("icon latest")}}}}}}],
mc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"VersionChecker",version:"0.1.1-20"}}},{start:232,end:2729})}(Fc.Morph);vc=Fc.VersionChecker;Fc.default=vc}}});
System.register("./__rootModule___commonjs-entry-71573ff5.js rollup @rollup/plugin-json ./index-d18accbd.js ./list.cp-8569fe93.js ./index-ca98f65e.js ./editor-plugin-0a8dd45b.js ./popups.cp-68dc8a4a.js ./loading-indicator.cp-b18e3b89.js ./helpers-ae531c72.js @rollup/plugin-commonjs rollup-plugin-polyfill-node".split(" "),function(Lc){var pd,Nd,Tc,Jc,$d,Bb,rd,Id,Ac,Pc,gd,nd,Fd,ic,vd,sb,Xb,Nb,bc,hb,cb,Hb,ec,ub,yb,ba,wb,Xa,Za,Sb,Cb,Da,zb,db,ib,Ea,W,T,ia,ka,K,ya,pb,La,eb,jb,E,Wb,R,xb,Ja,Ga,sa,Ub,vc,Oc,
aa,Ma,qb,Vb,Lb,Kb,Db,Ra,N,va,Wa,pa,tb,ab,Ob,yc,Ta,Bd,Eb,fe,Od,Hd;return{setters:[function(Qc){pd=Qc.b;Nd=Qc.C;Tc=Qc.r;Jc=Qc.T;$d=Qc.e;Bb=Qc.S;rd=Qc.H;Id=Qc.I;Ac=Qc.aZ;Pc=Qc.L;gd=Qc.m;nd=Qc.c;Fd=Qc.Q;ic=Qc.p;vd=Qc.g;sb=Qc.f;Xb=Qc.i;Nb=Qc.y;bc=Qc._;hb=Qc.a0;cb=Qc.aC;Hb=Qc.aV;ec=Qc.j;ub=Qc.k;yb=Qc.l;ba=Qc.B;wb=Qc.bf;Xa=Qc.bg;Za=Qc.bh;Sb=Qc.bi;Cb=Qc.bj;Da=Qc.bk;zb=Qc.bl;db=Qc.bm;ib=Qc.A;Ea=Qc.aR;W=Qc.bn;T=Qc.x;ia=Qc.G;ka=Qc.bo;K=Qc.bp;ya=Qc.a3;pb=Qc.bq;La=Qc.br;eb=Qc.bs;jb=Qc.aB;E=Qc.bt;Wb=Qc.ae;R=Qc.af},
function(Qc){xb=Qc.rollup},function(Qc){Ja=Qc["default"]},function(Qc){Ga=Qc.h;sa=Qc.A;Ub=Qc.R;vc=Qc.G;Oc=Qc.I},function(Qc){aa=Qc.c;Ma=Qc.a},function(Qc){qb=Qc.P;Vb=Qc.a;Lb=Qc.d;Kb=Qc.b;Db=Qc.G},function(Qc){Ra=Qc["default"]},function(Qc){N=Qc.c},function(Qc){va=Qc.D;Wa=Qc.L},function(Qc){pa=Qc.f;tb=Qc.g;ab=Qc.b;Ob=Qc.R;yc=Qc.a;Ta=Qc.i;Bd=Qc.c;Eb=Qc.t;fe=Qc.w},function(Qc){Od=Qc["default"]},function(Qc){Hd=Qc["default"]}],execute:function(){function Qc(){Qc=bc(regeneratorRuntime.mark(function ma(ca){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=
u.next){case 0:return u.next=2,System.normalize(ca);case 2:return u.abrupt("return",u.sent);case 3:case "end":return u.stop()}},ma)}));return Qc.apply(this,arguments)}function Xd(wa){return Ka.module(wa)["package"]()}function oc(){oc=bc(regeneratorRuntime.mark(function ma(ca){var u;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if("@empty"!==ca){O.next=2;break}return O.abrupt("return","");case 2:return O.prev=2,O.next=5,Ka.resource(ca).read();case 5:u=O.sent;O.next=
13;break;case 8:return O.prev=8,O.t0=O["catch"](2),O.next=12,Ka.resource(ca).makeProxied().read();case 12:u=O.sent;case 13:return O.abrupt("return",u);case 14:case "end":return O.stop()}},ma,null,[[2,8]])}));return oc.apply(this,arguments)}function rf(wa,ca){switch(wa.code){case "THIS_IS_UNDEFINED":case "EVAL":case "MODULE_LEVEL_DIRECTIVE":return}ca(wa)}function Dd(wa){var ca,ma,u,O=new Pb.LivelyRollup(wa);wa=wa.map;var P=void 0===wa?{}:wa;return{name:"rollup-plugin-lively",buildStart:function(){return O.buildStart(this)},
resolveId:function(){var fa=bc(regeneratorRuntime.mark(function ta(Ua,Gb){var mc;return regeneratorRuntime.wrap(function(pc){for(;;)switch(pc.prev=pc.next){case 0:if(!Ua.startsWith("\x00")){pc.next=2;break}return pc.abrupt("return",null);case 2:if(!Pb.isBuiltin(Ua,O.resolver)&&!Ua.includes("rollupPluginBabelHelpers.js")){pc.next=4;break}return pc.abrupt("return",null);case 4:return pc.next=6,O.resolveId(P[Ua]||Ua,Gb);case 6:return mc=pc.sent,pc.abrupt("return",mc);case 8:case "end":return pc.stop()}},
ta)}));return function(Ua,Gb){return fa.apply(this,arguments)}}(),resolveDynamicImport:function(){var fa=bc(regeneratorRuntime.mark(function ta(Ua,Gb){var mc;return regeneratorRuntime.wrap(function(pc){for(;;)switch(pc.prev=pc.next){case 0:if("string"!==typeof Ua||!Pb.isBuiltin(Ua,O.resolver)){pc.next=2;break}return pc.abrupt("return",Ua.replace("node:",""));case 2:return pc.next=4,O.resolveDynamicImport(Ua,Gb);case 4:return mc=pc.sent,pc.abrupt("return",mc);case 6:case "end":return pc.stop()}},ta)}));
return function(Ua,Gb){return fa.apply(this,arguments)}}(),load:function(fa){if(fa.startsWith("\x00")||Pb.isBuiltin(fa,O.resolver)||Pb.isCommonJsModule(fa))return null;try{return O.load(fa)}catch(Qa){return null}},transform:function(){var fa=bc(regeneratorRuntime.mark(function ta(Ua,Gb){return regeneratorRuntime.wrap(function(mc){for(;;)switch(mc.prev=mc.next){case 0:if(!Gb.startsWith("\x00")){mc.next=2;break}return mc.abrupt("return",null);case 2:return mc.prev=2,mc.next=5,O.transform(Ua,Gb);case 5:return mc.abrupt("return",
mc.sent);case 8:return mc.prev=8,mc.t0=mc["catch"](2),mc.abrupt("return",null);case 11:case "end":return mc.stop()}},ta,null,[[2,8]])}));return function(Ua,Gb){return fa.apply(this,arguments)}}(),buildEnd:function(){return bc(regeneratorRuntime.mark(function Qa(){return regeneratorRuntime.wrap(function(Ua){for(;;)switch(Ua.prev=Ua.next){case 0:return Ua.next=2,O.generateGlobals();case 2:Pb.__inter0__=Ua.sent,u=Pb.__inter0__.code,ca=Pb.__inter0__.globals,ma=Pb.__inter0__.importMap;case 6:case "end":return Ua.stop()}},
Qa)}))()},options:function(fa){if(O.snapshot||O.autoRun)O.rootModuleId=fa.input,delete fa.input;0<O.excludedModules.length&&(fa.shimMissingExports=!0);fa.onwarn||(fa.onwarn=function(ta,mc){return Pb.customWarn(ta,mc)});fa.plugins=[].concat(Nb(O.resolver.supportingPlugins(O.asBrowserModule?"browser":"node")),Nb(fa.plugins));var Qa=ia(fa.plugins),Ua;try{for(Qa.s();!(Ua=Qa.n()).done;){var Gb=Ua.value;"rollup-plugin-lively"!==Gb.name&&Gb.options&&(fa=Gb.options.bind(this)(fa)||fa)}}catch(ta){Qa.e(ta)}finally{Qa.f()}return fa},
outputOptions:function(fa){if(fa.globals)if(Pb.obj.isFunction(fa.globals)){var Qa=fa.globals;fa.globals=function(Ua){return ca[Ua]||Qa(Ua)}}else fa.globals=Object.assign({},fa.globals,{},ca);return fa},renderDynamicImport:function(){O.hasDynamicImports=!0;return null},generateBundle:function(fa,Qa,Ua){var Gb=this;return bc(regeneratorRuntime.mark(function mc(){return regeneratorRuntime.wrap(function(pc){for(;;)switch(pc.prev=pc.next){case 0:return pc.next=2,O.generateBundle(Gb,Qa,u,ma,fa);case 2:case "end":return pc.stop()}},
mc)}))()}}}function ld(){ld=bc(regeneratorRuntime.mark(function u(ca,ma){var O,P,fa,Qa,Ua,Gb,ta,mc=arguments;return regeneratorRuntime.wrap(function(pc){for(;;)switch(pc.prev=pc.next){case 0:return O=2<mc.length&&void 0!==mc[2]?mc[2]:"Freeze Part",P=3<mc.length&&void 0!==mc[3]?mc[3]:!1,fa=da.part(da.FreezerPrompt,{submorphs:[{name:"prompt title",textAndAttributes:[O,null]}]}),Qa=$world.getCurrentUser().name,Ua=P||da.Path("metadata.excludedPackages").get(ca)||da.DEFAULT_EXCLUDED_MODULES,Gb=da.Path("metadata.publishedLocation").get(ca)||
da.resource(System.baseURL).join("users").join(Qa).join("published").join(ca.name||da.BrowserResolver.resolvePackage(ca).name).url,pc.next=8,$world.withRequesterDo(ma,function(){var zd=bc(regeneratorRuntime.mark(function Yd(bd){return regeneratorRuntime.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return fa.isModuleBundle="string"===typeof ca,fa.isModuleBundle&&ma.isBrowser&&(fa.mainCandidates=ma.renderedCodeEntities().filter(function(Be){return"function-decl"===Be.type}).map(function(Be){return Be.name})),
fa.excludedPackages=Ua,fa.directory=Gb,fa.openInWorld(),le.next=7,fa.whenRendered();case 7:return fa.center=bd,le.next=10,fa.activate();case 10:ta=le.sent;case 11:case "end":return le.stop()}},Yd)}));return function(bd){return zd.apply(this,arguments)}}());case 8:return pc.abrupt("return",ta);case 9:case "end":return pc.stop()}},u)}));return ld.apply(this,arguments)}function Td(wa,ca){return gb.apply(this,arguments)}function gb(){gb=bc(regeneratorRuntime.mark(function u(ca,ma){var O,P,fa,Qa,Ua,Gb;
return regeneratorRuntime.wrap(function(ta){for(;;)switch(ta.prev=ta.next){case 0:O=ma.exclude;P=void 0===O?[]:O;fa=ma.useTerser;if(!ca.isMorph){ta.next=7;break}ta.next=4;return da.createMorphSnapshot(ca,{frozenSnapshot:!0});case 4:ta.t0=ta.sent;ta.next=8;break;case 7:ta.t0=ca;case 8:return Qa=ta.t0,da.transpileAttributeConnections(Qa),Ua=Dd({excludedModules:P,snapshot:Qa,useTerser:fa,resolver:da.BrowserResolver}),ta.next=13,da.rollup({plugins:[Ua,da.jsonPlugin()]});case 13:return Gb=ta.sent,ta.next=
16,Gb.generate({globalName:"frozenPart",format:"system",plugins:[Ua]});case 16:return ta.abrupt("return",ta.sent);case 17:case "end":return ta.stop()}},u)}));return gb.apply(this,arguments)}function Vc(wa,ca){return vb.apply(this,arguments)}function vb(){vb=bc(regeneratorRuntime.mark(function u(ca,ma){var O,P,fa,Qa,Ua,Gb;return regeneratorRuntime.wrap(function(ta){for(;;)switch(ta.prev=ta.next){case 0:return O=ma.exclude,P=void 0===O?[]:O,fa=ma.mainFunction,Qa=ma.htmlConfig,Ua=ma.useTerser,ta.next=
3,da.rollup({input:ca,plugins:[Dd({excludedModules:P,mainFunction:fa,useTerser:Ua,resolver:da.BrowserResolver,autoRun:Qa}),da.jsonPlugin()]});case 3:return Gb=ta.sent,ta.next=6,Gb.generate({format:"system"});case 6:return ta.abrupt("return",ta.sent);case 7:case "end":return ta.stop()}},u)}));return vb.apply(this,arguments)}function cc(wa,ca,ma){return ob.apply(this,arguments)}function ob(){ob=bc(regeneratorRuntime.mark(function O(ca,ma,u){var P,fa,Qa,Ua=arguments;return regeneratorRuntime.wrap(function(Gb){for(;;)switch(Gb.prev=
Gb.next){case 0:return P=3<Ua.length&&void 0!==Ua[3]?Ua[3]:{},fa=Dd({includePolyfills:!1,redirect:P,resolver:da.BrowserResolver,excludedModules:["babel-plugin-transform-jsx"]}),Gb.next=4,da.rollup({input:ca,plugins:[fa,da.jsonPlugin()]});case 4:return Qa=Gb.sent,Gb.next=7,Qa.generate({globalName:u,format:"system",plugins:[fa]});case 7:case "end":return Gb.stop()}},O)}));return ob.apply(this,arguments)}function ac(wa,ca){return ae.apply(this,arguments)}function ae(){ae=bc(regeneratorRuntime.mark(function u(ca,
ma){var O,P,fa,Qa=arguments;return regeneratorRuntime.wrap(function(Ua){for(;;)switch(Ua.prev=Ua.next){case 0:return O=2<Qa.length&&void 0!==Qa[2]?Qa[2]:!0,P=3<Qa.length?Qa[3]:void 0,Ua.next=4,da.rollup({input:ca,plugins:[Dd({asBrowserModule:O,resolver:da.BrowserResolver,excludedModules:["babel-plugin-transform-jsx"]}),da.jsonPlugin()]});case 4:return fa=Ua.sent,Ua.next=7,fa.generate({format:"system",globalName:P});case 7:case "end":return Ua.stop()}},u)}));return ae.apply(this,arguments)}function qe(wa){return lc.apply(this,
arguments)}function lc(){lc=bc(regeneratorRuntime.mark(function ma(ca){var u,O,P,fa,Qa,Ua,Gb,ta,mc;return regeneratorRuntime.wrap(function(pc){for(;;)switch(pc.prev=pc.next){case 0:return u=ca.getCurrentUser().name,O=ca.metadata.commit.name,pc.next=4,da.resource(System.baseURL).join("users").join(u).join("published/").ensureExistance();case 4:return P=pc.sent,pc.t0=da,pc.next=8,da.defaultDirectory();case 8:pc.t1=pc.sent,pc.t2=u,fa=pc.t0.resource.call(pc.t0,pc.t1).join("..").join("users").join(pc.t2).join("published/").withRelativePartsResolved().asDirectory(),
Qa=P.join(O+"/");case 12:return pc.next=14,Qa.exists();case 14:if(!pc.sent){pc.next=28;break}pc.next=17;return $world.confirm('A world published as "'.concat(O,'" already exists.\nDo you want to overwrite this publication?'),{rejectLabel:"CHANGE NAME"});case 17:Ua=pc.sent;if(!Ua){pc.next=20;break}return pc.abrupt("break",28);case 20:return pc.next=22,$world.prompt("Please enter a different name for this published world:");case 22:if(O=pc.sent){pc.next=25;break}return pc.abrupt("return");case 25:Qa=
P.join(O+"/");pc.next=12;break;case 28:return pc.next=30,Qa.ensureExistance();case 30:return Gb=da.clearWorldSnapshot(da.serializeMorph(ca)),pc.prev=31,pc.next=34,da.bundlePart(Gb,{compress:!0,exclude:da.DEFAULT_EXCLUDED_MODULES_WORLD});case 34:ta=pc.sent;ta.part=ca;pc.next=41;break;case 38:throw pc.prev=38,pc.t3=pc["catch"](31),pc.t3;case 41:return mc=da.LoadingIndicator.open("Freezing World",{status:"Writing files..."}),pc.next=44,da.writeFiles(ta,mc,{dir:Qa,shell:fa,resolver:da.BrowserResolver});
case 44:case "end":return pc.stop()}},ma,null,[[31,38]])}));return lc.apply(this,arguments)}function nc(wa){return Yc.apply(this,arguments)}function Yc(){Yc=bc(regeneratorRuntime.mark(function ma(ca){var u,O,P,fa,Qa,Ua,Gb,ta=arguments;return regeneratorRuntime.wrap(function(mc){for(;;)switch(mc.prev=mc.next){case 0:return u=1<ta.length&&void 0!==ta[1]?ta[1]:!1,mc.next=3,da.promptForFreezing(ca,u,"Freeze Part");case 3:if(O=mc.sent){mc.next=6;break}return mc.abrupt("return");case 6:return mc.next=8,
da.resource(System.baseURL).join(O.location).asDirectory().ensureExistance();case 8:return P=mc.sent,mc.t0=da,mc.next=12,da.defaultDirectory();case 12:return mc.t1=mc.sent,mc.t2=O.location,fa=mc.t0.resource.call(mc.t0,mc.t1).join("..").join(mc.t2).withRelativePartsResolved().asDirectory(),ca.changeMetaData("excludedPackages",O.excludedPackages,!0,!1),ca.changeMetaData("publishedLocation",O.location,!0,!1),ca.isWorld&&(Qa=da.clearWorldSnapshot(da.serializeMorph(ca))),mc.prev=18,mc.next=21,da.bundlePart(Qa||
ca,{compress:!0,useTerser:O.useTerser,exclude:O.excludedPackages,requester:!1});case 21:Ua=mc.sent;Ua.part=ca;mc.next=28;break;case 25:throw mc.prev=25,mc.t3=mc["catch"](18),mc.t3;case 28:return Gb=da.LoadingIndicator.open("Freezing Part",{status:"Writing files..."}),mc.next=31,da.writeFiles(Ua,Gb,{dir:P,shell:fa,resolver:da.BrowserResolver});case 31:case "end":return mc.stop()}},ma,null,[[18,25]])}));return Yc.apply(this,arguments)}function fd(wa,ca){return ua.apply(this,arguments)}function ua(){ua=
bc(regeneratorRuntime.mark(function u(ca,ma){var O,P,fa,Qa,Ua,Gb,ta,mc,pc,zd,Pd,bd;return regeneratorRuntime.wrap(function(Yd){for(;;)switch(Yd.prev=Yd.next){case 0:return Yd.next=2,da.resource(ca).read();case 2:O=Yd.sent;P=da.topLevelDeclsAndRefs(da.parse(O));fa=P.varDecls;Qa=fa.find(function(le){return"EXCLUDED_MODULES"===da.Path("declarations.0.id.name").get(le)});Ua=fa.find(function(le){return"TITLE"===da.Path("declarations.0.id.name").get(le)});Gb=da.DEFAULT_EXCLUDED_MODULES;ta=ca;try{Gb=eval(da.stringify(Qa.declarations[0].init)),
ta=eval(da.stringify(Ua.declarations[0].init))}catch(le){}Yd.next=11;return da.promptForFreezing(ca,ma,"Freeze Module",Gb);case 11:if(mc=Yd.sent){Yd.next=14;break}return Yd.abrupt("return");case 14:return Yd.next=16,da.resource(System.baseURL).join(mc.location).asDirectory().ensureExistance();case 16:return pc=Yd.sent,Yd.t0=da,Yd.next=20,da.defaultDirectory();case 20:return Yd.t1=Yd.sent,Yd.t2=mc.location,zd=Yd.t0.resource.call(Yd.t0,Yd.t1).join("..").join(Yd.t2).withRelativePartsResolved().asDirectory(),
Yd.prev=23,Yd.next=26,da.bundleModule(ca,{compress:!0,useTerser:mc.useTerser,exclude:mc.excludedPackages,htmlConfig:{title:ta},requester:ma});case 26:Pd=Yd.sent;Yd.next=32;break;case 29:throw Yd.prev=29,Yd.t3=Yd["catch"](23),Yd.t3;case 32:return bd=da.LoadingIndicator.open("Freezing Module",{status:"Writing files..."}),Yd.next=35,da.writeFiles(Pd,bd,{dir:pc,shell:zd,resolver:da.BrowserResolver});case 35:case "end":return Yd.stop()}},u,null,[[23,29]])}));return ua.apply(this,arguments)}Lc({a:fd,b:nc,
i:qe});var Ab=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js");Ab.LightPrompt=Ga;Ab.AbstractPromptModel=sa;Ab.RedButton=Ub;Ab.GreenButton=vc;Ab.InputLineDefault=Oc;Ab.DropDownList=aa;Ab.DefaultList=Ma;Ab.pt=pd;Ab.Color=Nd;Ab.rect=Tc;Ab.TilingLayout=Jc;Ab.easings=$d;Ab.ShadowObject=Bb;Ab.HorizontalLayout=rd;Ab.Icon=Id;Ab.ProportionalLayout=Ac;Ab.Label=Pc;Ab.Text=gd;Ab.component=nd;Ab.add=Fd;Ab.part=ic;Ab.PackageRegistry=qb;Ab.EditorPlugin=Ra;Ab.resource=vd;Ab.fun=sb;Ab.SystemList=
N;Ab.DarkButton=va;(function(wa){var ca=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js"),ma=ca.hasOwnProperty("PackageTextCompleter")&&"function"===typeof ca.PackageTextCompleter?ca.PackageTextCompleter:ca.PackageTextCompleter=function(u){if(!u||!u[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(ma,wa,[{key:"isValidPrefix",value:function(u){return!!u}},{key:"compute",value:function(){var u=
bc(regeneratorRuntime.mark(function Qa(P,fa){var Ua;return regeneratorRuntime.wrap(function(Gb){for(;;)switch(Gb.prev=Gb.next){case 0:return Ua=Ab.PackageRegistry.ofSystem(System).allPackages(),Gb.abrupt("return",Ua.map(function(ta){var mc=ta.name;return{info:"@".concat(ta.version),completion:mc,customInsertionFn:function(pc,zd,Pd,bd){bd.start;bd.end;Pd.replace(Pd.lineRange(),mc)}}}));case 2:case "end":return Gb.stop()}},Qa)}));return function(P,fa){return u.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),
get:function(){return"PackageTextCompleter"}}],ca,{pathInPackage:function(){return"./src/ui.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:778,end:1319})})(void 0);(function(wa){var ca=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js"),ma=ca.hasOwnProperty("DirectoryTextCompleter")&&"function"===typeof ca.DirectoryTextCompleter?
ca.DirectoryTextCompleter:ca.DirectoryTextCompleter=function(u){if(!u||!u[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(ma,wa,[{key:"isValidPrefix",value:function(u){return!!u}},{key:"compute",value:function(){var u=bc(regeneratorRuntime.mark(function Qa(P,fa){var Ua,Gb,ta;return regeneratorRuntime.wrap(function(mc){for(;;)switch(mc.prev=mc.next){case 0:return Ua=P.input,Ua=fa?Ua.slice(0,-fa.length):Ua,Gb=Ab.resource(System.baseURL+
Ua),ta=[],mc.next=6,Gb.exists();case 6:if(!mc.sent){mc.next=10;break}mc.next=9;return Gb.dirList();case 9:ta=mc.sent;case 10:return mc.abrupt("return",ta.map(function(pc){var zd=pc.url;return{completion:zd.replace(Gb.url,""),customInsertionFn:function(Pd,bd,Yd,le){le.start;le.end;Yd.replace(Yd.lineRange(),zd.replace(System.baseURL,"/"))}}}));case 11:case "end":return mc.stop()}},Qa)}));return function(P,fa){return u.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"DirectoryTextCompleter"}}],
ca,{pathInPackage:function(){return"./src/ui.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:1321,end:2073})})(void 0);(function(wa){var ca=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js"),ma=ca.hasOwnProperty("DirectoryInputPlugin")&&"function"===typeof ca.DirectoryInputPlugin?ca.DirectoryInputPlugin:
ca.DirectoryInputPlugin=function(u){if(!u||!u[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(ma,wa,[{key:"getCompleters",value:function(){return[new Ab.DirectoryTextCompleter]}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"DirectoryInputPlugin"}}],ca,{pathInPackage:function(){return"./src/ui.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:2075,end:2194})})(Ab.EditorPlugin);(function(wa){var ca=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js"),ma=ca.hasOwnProperty("PackageInputPlugin")&&"function"===typeof ca.PackageInputPlugin?ca.PackageInputPlugin:ca.PackageInputPlugin=function(u){if(!u||!u[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(ma,wa,[{key:"getCompleters",
value:function(){return[new Ab.PackageTextCompleter]}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"PackageInputPlugin"}}],ca,{pathInPackage:function(){return"./src/ui.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:2196,end:2311})})(Ab.EditorPlugin);var Fa=function(wa){var ca=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/ui.cp.js"),
ma=ca.hasOwnProperty("FreezerPromptModel")&&"function"===typeof ca.FreezerPromptModel?ca.FreezerPromptModel:ca.FreezerPromptModel=function(u){if(!u||!u[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(ma,wa,[{key:"viewDidLoad",value:function(){var u=bc(regeneratorRuntime.mark(function P(){var fa;return regeneratorRuntime.wrap(function(Qa){for(;;)switch(Qa.prev=Qa.next){case 0:return Xb._get(Object.getPrototypeOf(ma.prototype),
"viewDidLoad",this).call(this),fa=this.ui.layoutWrapper,this.view.opacity=0,Qa.next=5,this.view.whenRendered();case 5:fa.layout.apply(),this.view.opacity=1;case 7:case "end":return Qa.stop()}},P,this)}));return function(){return u.apply(this,arguments)}}()},{key:"cancel",value:function(){this.view.remove();this.reject()}},{key:"focus",value:function(){this.ui.compilerSelector.selection="Google Closure";this.ui.dirInput.focus()}},{key:"resolve",value:function(){var u=this.ui;u.dirInput;u.packageList;
u=u.compilerSelector;return Xb._get(Object.getPrototypeOf(ma.prototype),"resolve",this).call(this,{location:this.directory,useTerser:"Terser + Babel"==u.selection,excludedPackages:this.excludedPackages})}},{key:"checkDirStatus",value:function(){var u=bc(regeneratorRuntime.mark(function P(){var fa=this;return regeneratorRuntime.wrap(function(Qa){for(;;)switch(Qa.prev=Qa.next){case 0:Ab.fun.debounceNamed("checkDirStatus",500,bc(regeneratorRuntime.mark(function Gb(){var ta,mc,pc;return regeneratorRuntime.wrap(function(zd){for(;;)switch(zd.prev=
zd.next){case 0:ta=fa.ui;mc=ta.dirWarning;pc=ta.dirInput;zd.t0=!!fa.directory;if(!zd.t0){zd.next=6;break}zd.next=5;return Ab.resource(System.baseURL).join(fa.directory).exists();case 5:zd.t0=zd.sent;case 6:if(!zd.t0){zd.next=12;break}mc.textAndAttributes=[].concat(Nb(Ab.Icon.textAttribute("exclamation-circle")),["  Directory will be overwritten.",{fontFamily:"IBM Plex Sans",fontWeight:"600"}]);mc.fontColor=Ab.Color.rgb(231,76,60);!mc.visible&&mc.animate({visible:!0,isLayoutable:!0,top:pc.bottom,duration:200,
easing:Ab.easings.inOutExpo});zd.next=13;break;case 12:mc.animate({isLayoutable:!1,visible:!1,duration:200,easing:Ab.easings.inOutExpo});case 13:case "end":return zd.stop()}},Gb)})))();case 1:case "end":return Qa.stop()}},P)}));return function(){return u.apply(this,arguments)}}()},{key:"addExcludedPackage",value:function(){this.displayPackageInput(!0)}},{key:"removeExcludedPackage",value:function(){var u=this.ui.packageList;u.removeItem(u.selectedItems[0])}},{key:"confirmExcludedPackage",value:function(){var u=
bc(regeneratorRuntime.mark(function P(){return regeneratorRuntime.wrap(function(fa){for(;;)switch(fa.prev=fa.next){case 0:return this.ui.packageList.addItem(this.ui.packageInput.input),fa.next=3,this.displayPackageInput(!1);case 3:this.ui.packageInput.input="";case 4:case "end":return fa.stop()}},P,this)}));return function(){return u.apply(this,arguments)}}()},{key:"verifyPackageName",value:function(u){return Ab.PackageRegistry.ofSystem(System).allPackages().find(function(O){return O.name==u})}},
{key:"onMouseUp",value:function(u){u=this.ui;u.packageInput;u.addPackageButton;u.removePackageButton;u.confirmPackageButton;u.packageList;this.ui.removePackageButton.deactivated=!this.ui.packageList.selections.length}},{key:"displayPackageInput",value:function(){var u=bc(regeneratorRuntime.mark(function fa(P){var Qa,Ua,Gb,ta,mc;return regeneratorRuntime.wrap(function(pc){for(;;)switch(pc.prev=pc.next){case 0:Qa=this.ui;Ua=Qa.packageInput;Gb=Qa.packageList;ta=Qa.confirmPackageButton;mc=200;if(!P){pc.next=
8;break}Ua.animate({visible:!0,top:Gb.bottom+10,duration:mc});pc.next=6;return ta.animate({visible:!0,top:Gb.bottom+15,duration:mc});case 6:pc.next=11;break;case 8:return ta.animate({visible:!1,bottom:Gb.bottom-5,duration:mc}),pc.next=11,Ua.animate({visible:!1,bottom:Gb.bottom,duration:mc});case 11:case "end":return pc.stop()}},fa,this)}));return function(P){return u.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"FreezerPromptModel"}},{key:"properties",
get:function(){return{directory:{derived:!0,set:function(u){this.ui.dirInput.input=u.replace(System.baseURL,"/")},get:function(){return this.ui.dirInput.input}},epiMorph:{defaultValue:!0},isModuleBundle:{defaultValue:!0},excludedPackages:{derived:!0,set:function(u){this.ui.packageList.items=u},get:function(){return this.ui.packageList.items.map(function(u){return u.value})}},expose:{get:function(){return[].concat(Nb(Xb._get(Object.getPrototypeOf(ma),"prototype",this).expose),["excludedPackages","directory",
"isModuleBundle"])}},bindings:{get:function(){return[{signal:"onMouseDown",handler:"onMouseDown"},{model:"add package button",signal:"fire",handler:"addExcludedPackage"},{model:"remove package button",signal:"fire",handler:"removeExcludedPackage"},{model:"confirm excluded package",signal:"fire",handler:"confirmExcludedPackage"},{model:"cancel button",signal:"fire",handler:"cancel"},{model:"ok button",signal:"fire",handler:"resolve"}]}}}}}],ca,{pathInPackage:function(){return"./src/ui.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:2328,end:7085})}(Ab.AbstractPromptModel);Ab.FreezerPrompt=Ab.component["for"](function(){return Ab.component(Ab.LightPrompt,{defaultViewModel:Ab.FreezerPromptModel,name:"freezer prompt",extent:Ab.pt(481,440.8),clipMode:"hidden",layout:new Ab.TilingLayout({axis:"column",hugContentsVertically:!0,orderByIndex:!0,padding:Ab.rect(16,16,0,0),resizePolicies:[["prompt title",
{height:"fixed",width:"fill"}],["dir input",{height:"fixed",width:"fill"}],["compiler explaination",{height:"fixed",width:"fill"}],["exclusion expaination",{height:"fixed",width:"fill"}],["layout wrapper",{height:"fixed",width:"fill"}],["button wrapper",{height:"fixed",width:"fill"}]],spacing:16,wrapSubmorphs:!1}),position:Ab.pt(960.8,161.4),submorphs:[{name:"prompt title",textAndAttributes:["Freeze Part",null]},Ab.add({type:Ab.Label,name:"dir label",fill:Ab.Color.rgba(255,255,255,0),fontColor:Ab.Color.rgb(45,
45,45),fontSize:16,fontWeight:"Medium",nativeCursor:"pointer",textAndAttributes:["Directory to write files to:",null]}),Ab.add(Ab.part(Ab.InputLineDefault,{name:"dir input",placeholder:"Directory",submorphs:[{name:"placeholder",extent:Ab.pt(103,34.3),textAndAttributes:["Directory",null]}]})),Ab.add({type:Ab.Text,name:"dir warning",borderColor:Ab.Color.rgb(204,204,204),borderRadius:3,extent:Ab.pt(451.3,17.2),fill:Ab.Color.rgba(255,255,255,0),fixedWidth:!0,fontColor:Ab.Color.rgb(231,76,60),fontFamily:"IBM Plex Sans",
isLayoutable:!1,lineWrapping:!0,nativeCursor:"default",readOnly:!0,textAlign:"left",visible:!1}),Ab.add({type:Ab.Text,name:"compiler explaination",borderColor:Ab.Color.rgb(204,204,204),borderRadius:3,extent:Ab.pt(449,109),fill:Ab.Color.rgba(255,255,255,0),fixedWidth:!0,fontColor:Ab.Color.rgb(102,102,102),fontFamily:"IBM Plex Sans",lineWrapping:!0,nativeCursor:"default",readOnly:!0,textAlign:"left",textAndAttributes:["Compression:",{textAlign:"left",fontSize:16,fontColor:Ab.Color.rgb(45,45,45)}," ",
{textAlign:"left",fontSize:16}," ",{textAlign:"left"},Ab.part(Ab.DropDownList,{name:"compiler selector",extent:Ab.pt(127.3,25.9),position:Ab.pt(104.4,0),viewModel:{selection:"Google Closure",items:["Google Closure","Terser + Babel"],listAlign:"selection",listMaster:Ab.SystemList,openListInWorld:!0}}),{textAlign:"left"},"   \n",{fontSize:5},"\nSelect the compiler to be used to compress the resulting bundle. Generally speaking Google Closure will yield smaller bundles but may break some parts of your bundle due to aggressive optimization. Terser + Babel is less aggressive but may fail with very large bundles > 10MB.",
null]}),Ab.add({type:Ab.Label,name:"excluded package label",fill:Ab.Color.rgba(255,255,255,0),fontColor:Ab.Color.rgb(45,45,45),fontSize:16,fontWeight:"Medium",nativeCursor:"pointer",textAndAttributes:["Packages to exclude from bundle:",null]}),Ab.add({type:Ab.Text,name:"exclusion expaination",borderColor:Ab.Color.rgb(204,204,204),borderRadius:3,extent:Ab.pt(449,67),fill:Ab.Color.rgba(255,255,255,0),fixedWidth:!0,fontColor:Ab.Color.rgb(102,102,102),fontFamily:'"IBM Plex Sans",Sans-Serif',lineWrapping:!0,
textAndAttributes:["Excluding packages from the bundle of the frozen part can reduce the total payload and its loading time ",null,"dramatically",{fontWeight:"bold"},". This however needs to be done with care. Make sure that none of your functionality depends of these excluded packages. If you do not know what you are doing it is best to leave this list as is.",{textAlign:"left"}],nativeCursor:"default",textAlign:"center"}),Ab.add({name:"layout wrapper",extent:Ab.pt(450,155),fill:Ab.Color.rgba(46,
75,223,0),layout:new Ab.ProportionalLayout({lastExtent:Ab.pt(450,155),submorphSettings:[["package list",{x:"resize",y:"resize"}],["add package button",{x:"move",y:"move"}],["remove package button",{x:"move",y:"move"}],["package input",{x:"resize",y:"fixed"}]]}),submorphs:[Ab.part(Ab.InputLineDefault,{name:"package input",borderColor:Ab.Color.rgb(204,204,204),borderRadius:4,extent:Ab.pt(445,32),highlightWhenFocused:!0,padding:Ab.rect(10,3,0,0),placeholder:"Excluded package name",position:Ab.pt(0,120),
visible:!1,submorphs:[{name:"placeholder",extent:Ab.pt(237,32),textAndAttributes:["Excluded package name",null]}]}),Ab.part(Ab.DarkButton,{name:"confirm excluded package",extent:Ab.pt(25,21.9),viewModel:{label:Ab.Icon.textAttribute("check")},position:Ab.pt(0,126.1),tooltip:"add a new method",visible:!1}),Ab.part(Ab.DefaultList,{name:"package list",borderRadius:4,dropShadow:new Ab.ShadowObject({distance:3,rotation:75,color:Ab.Color.rgba(0,0,0,.2)}),extent:Ab.pt(442.4,148.6),fontFamily:"IBM Plex Sans",
fontSize:20,itemHeight:29,manualItemHeight:!0,position:Ab.pt(2.8,4.5)}),Ab.part(Ab.DarkButton,{name:"add package button",extent:Ab.pt(25,25),position:Ab.pt(383.1,125.2),tooltip:"add a new method",submorphs:[{name:"label",value:Ab.Icon.textAttribute("plus")}]}),Ab.part(Ab.DarkButton,{name:"remove package button",extent:Ab.pt(25,25),position:Ab.pt(414,125),tooltip:"remove a method or class",submorphs:[{name:"label",value:Ab.Icon.textAttribute("minus")}]})]}),Ab.add({name:"button wrapper",extent:Ab.pt(449,
48.9),fill:Ab.Color.rgba(0,0,0,0),layout:new Ab.HorizontalLayout({align:"center",autoResize:!1,direction:"centered",orderByIndex:!0,padding:{height:0,width:0,x:20,y:20},reactToSubmorphAnimations:!1,renderViaCSS:!0,resizeSubmorphs:!1,spacing:20}),submorphs:[Ab.part(Ab.GreenButton,{name:"ok button",extent:Ab.pt(90,39),label:"OK"}),Ab.part(Ab.RedButton,{name:"cancel button",extent:Ab.pt(94,39),label:"CANCEL"})]})]})},{module:"lively.freezer/src/ui.cp.js","export":"FreezerPrompt",range:{start:7124,end:14117}},
Ab.FreezerPrompt);var za=Ab.FreezerPrompt;Ab.FreezerPrompt=za;Ab["default"]=Fa;var Ka=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/resolvers/browser.js");Ka.resolveModuleId=function(wa,ca){return Ka.module(wa).id};Ka.ensureFileFormat=function(wa){return wa};Ka.normalizeFileName=function(wa){return Qc.apply(this,arguments)};Ka.decanonicalizeFileName=function(wa){return System.decanonicalize(wa)};Ka.resolvePackage=Xd;Ka.dontTransform=function(wa){return Ka.module(wa).dontTransform};
Ka.pathInPackageFor=function(wa){return Ka.module(wa).pathInPackage()};Ka.detectFormatFromSource=function(wa){return Ka.detectModuleFormat(wa)};Ka.detectFormat=function(wa){return Ka.module(wa).format()};Ka.setStatus=function(wa){var ca=wa.status,ma=wa.progress;wa=wa.label;Ka.li||(Ka.li=Ka.LoadingIndicator.open());Ka.li.world()||Ka.li.openInWorld();ca&&(Ka.li.status=ca);wa&&(Ka.li.label=wa);"undefined"!==typeof ma&&(Ka.li.progress=ma)};Ka.finish=function(){Ka.li.remove();Ka.li=null};Ka.whenReady=
function(){return Ka.li.whenRendered()};Ka.spawn=function(wa){return Ka.runCommand(wa.command,{cwd:wa.cwd})};Ka.load=function(wa){return oc.apply(this,arguments)};Ka.supportingPlugins=function(){return[Ka.commonjs({sourceMap:!1,defaultIsModuleExports:!0,transformMixedEsModules:!0,dynamicRequireRoot:System.baseURL}),Ka.nodePolyfills()]};Ka.commonjsHelpers=hb;Ka.module=Vb;Ka.LoadingIndicator=Wa;Ka.detectModuleFormat=Lb;Ka.runCommand=cb;Ka.resource=vd;Ka.commonjs=Od;Ka.nodePolyfills=Hd;Ka.resolvePackage=
Xd;Ka.li=Ka.li||void 0;Ka.builtinModules=[];Ka.BrowserResolver={resolveModuleId:Ka.resolveModuleId,normalizeFileName:Ka.normalizeFileName,decanonicalizeFileName:Ka.decanonicalizeFileName,resolvePackage:Ka.resolvePackage,dontTransform:Ka.dontTransform,pathInPackageFor:Ka.pathInPackageFor,detectFormat:Ka.detectFormat,detectFormatFromSource:Ka.detectFormatFromSource,setStatus:Ka.setStatus,finish:Ka.finish,whenReady:Ka.whenReady,spawn:Ka.spawn,load:Ka.load,builtinModules:Ka.builtinModules,ensureFileFormat:Ka.ensureFileFormat,
supportingPlugins:Ka.supportingPlugins};Fa=Ka.BrowserResolver;Ka["default"]=Fa;var Ib=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/bundler.js");Ib.customWarn=rf;Ib.resolutionId=function(wa,ca){return ca?ca+" -> "+wa:wa};Ib.isCdnImport=function(wa,ca,ma){if(Ib.ESM_CDNS.find(function(O){return wa.includes(O)||ca.includes(O)})&&ca&&ca!==Ib.ROOT_ID){var u=Ib.resource(ma.ensureFileFormat(ca)).root().url;return Ib.ESM_CDNS.find(function(O){return u.includes(O)})}return!1};Ib.resource=vd;
Ib.ast=Hb;Ib.classes=Kb;Ib.arr=ec;Ib.string=ub;Ib.Path=yb;Ib.fun=sb;Ib.obj=ba;Ib.es5Transpilation=wb;Ib.ensureComponentDescriptors=Xa;Ib.rewriteToCaptureTopLevelVariables=Za;Ib.insertCapturesForExportedImports=Sb;Ib.locateClass=Cb;Ib.requiredModulesOfSnapshot=Da;Ib.classNameOfId=zb;Ib.moduleOfId=db;Ib.config=ib;Ib.fixSourceForBugsInGoogleClosure=pa;Ib.gzip=tb;Ib.brotli=ab;Ib.ROOT_ID=Ob;Ib.generateLoadHtml=yc;Ib.instrumentStaticSystemJS=Ta;Ib.compileOnServer=Bd;Ib.joinPath=Ea;Ib.ensureFolder=W;Ib.GlobalInjector=
Db;Ib.separator="__".concat("Separator","__");Ib.SYSTEMJS_STUB='\nvar G = typeof window !== "undefined" ? window :\n      typeof global!=="undefined" ? global :\n        typeof self!=="undefined" ? self : this;\nif (!G.System) G.System = G.lively.FreezerRuntime;';Ib.CLASS_INSTRUMENTATION_MODULES="lively.morphic lively.components lively.ide lively.halos lively.user lively.bindings lively-system-interface typeshift.components lively.collab https://jspm.dev/npm:rollup@2.28.2".split(" ");Ib.ESM_CDNS=
["jspm.dev","jspm.io","skypack.dev","esm://cache"];Ib.CLASS_INSTRUMENTATION_MODULES_EXCLUSION=["lively.lang"];Ib.ADVANCED_EXCLUDED_MODULES="lively.ast lively.vm lively.ide lively.modules babel-plugin-transform-jsx lively-system-interface lively.storage lively.collab localconfig.js".split(" ");Ib.baseURL="undefined"!==typeof System?System.baseURL:Ib.ensureFolder(process.env.lv_next_dir||process.cwd());Ib.customWarn=rf;var C=function(wa){var ca=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/bundler.js"),
ma=ca.hasOwnProperty("LivelyRollup")&&"function"===typeof ca.LivelyRollup?ca.LivelyRollup:ca.LivelyRollup=function(u){if(!u||!u[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(ma,wa,[{key:Symbol["for"]("lively-instance-initialize"),value:function(){this.setup(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}},{key:"setup",value:function(u){var O=u.snapshot,P=u.rootModule,fa=u.resolver,Qa=u.excludedModules;
Qa=void 0===Qa?[]:Qa;var Ua=u.autoRun;Ua=void 0===Ua?!1:Ua;var Gb=u.asBrowserModule;Gb=void 0===Gb?!0:Gb;var ta=u.useTerser,mc=u.isResurrectionBuild;mc=void 0===mc?!1:mc;var pc=u.includePolyfills,zd=u.includeLivelyAssets;zd=void 0===zd?!0:zd;var Pd=u.compress;Pd=void 0===Pd?!0:Pd;var bd=u.minify;bd=void 0===bd?!0:bd;u=u.captureModuleScope;u=void 0===u?!0:u;this.resolver=fa;this.useTerser=void 0===ta?!1:ta;this.includePolyfills=void 0===pc?!0:pc;this.snapshot=O;P&&(this.rootModuleId=fa.resolveModuleId(P));
this.autoRun=Ua;this.asBrowserModule=Gb;this.excludedModules=Qa;this.captureModuleScope=u;this.isResurrectionBuild=mc;this.includeLivelyAssets=zd;this.compress=Pd;this.minify=bd;this.globalMap={};this.dynamicParts={};this.modulesWithDynamicLoads=new Set;this.hasDynamicImports=!1;this.globalModules={};this.importedModules=[];this.resolved={};this.assetsToCopy=[]}},{key:"needsOldSystem",get:function(){return this.isResurrectionBuild||!this.excludedModules.includes("lively.modules")}},{key:"getResolutionContext",
value:function(){return this.asBrowserModule?"systemjs-browser":"node"}},{key:"getRequiredModulesFromSnapshot",value:function(){var u=bc(regeneratorRuntime.mark(function fa(P){return regeneratorRuntime.wrap(function(Qa){for(;;)switch(Qa.prev=Qa.next){case 0:return Qa.abrupt("return",Ib.requiredModulesOfSnapshot(P));case 1:case "end":return Qa.stop()}},fa)}));return function(P){return u.apply(this,arguments)}}()},{key:"resolveRelativeImport",value:function(){var u=bc(regeneratorRuntime.mark(function Qa(P,
fa){return regeneratorRuntime.wrap(function(Ua){for(;;)switch(Ua.prev=Ua.next){case 0:if(fa.startsWith(".")){Ua.next=2;break}return Ua.abrupt("return",this.resolver.normalizeFileName(fa));case 2:return Ua.t0=this.resolver,Ua.t1=Ib.string,Ua.next=6,this.resolver.normalizeFileName(P);case 6:return Ua.t2=Ua.sent,Ua.t3=fa,Ua.t4=Ua.t1.joinPath.call(Ua.t1,Ua.t2,"..",Ua.t3),Ua.next=11,Ua.t0.normalizeFileName.call(Ua.t0,Ua.t4);case 11:return Ua.abrupt("return",Ua.sent);case 12:case "end":return Ua.stop()}},
Qa,this)}));return function(P,fa){return u.apply(this,arguments)}}()},{key:"normalizedId",value:function(u){return u.replace(Ib.baseURL,"").replace("local://lively-object-modules/","")}},{key:"getTransformOptions",value:function(u,O){if("@empty"===u)return{};var P;if(P=this.resolver.resolvePackage(u)){var fa=P.name;P=P.version}else P=u.split("@")[1],fa=u.split("npm:")[1].split("@")[0];fa={classHolder:Ib.ast.parse('(window.lively.FreezerRuntime.recorderFor("'.concat(this.normalizedId(u),'"))')),functionNode:{type:"Identifier",
name:"initializeES6ClassForLively"},transform:Ib.classes.classToFunctionTransform,currentModuleAccessor:Ib.ast.parse('({\n        pathInPackage: () => {\n           return "'.concat(this.resolver.pathInPackageFor(u),'"\n        },\n        unsubscribeFromToplevelDefinitionChanges: () => () => {},\n        subscribeToToplevelDefinitionChanges: () => () => {},\n        package: () => { \n          return {\n            name: "').concat(fa,'",\n            version: "').concat(P,'"\n          } \n        } \n      })')).body[0].expression};
return{exclude:["System"].concat(Nb(this.resolver.dontTransform(u,[].concat(Nb(Ib.ast.query.knownGlobals),Nb(Ib.GlobalInjector.getGlobals(null,O))))),Nb(Ib.arr.range(0,50).map(function(Qa){return"__captured".concat(Qa,"__")}))),classToFunction:fa}}},{key:"checkIfImportedPackageExcluded",value:function(u){var O=this,P=Ib.arr.compact(this.excludedModules.map(function(fa){return O.resolver.resolvePackage(fa)}));u=u.map(function(fa){return O.resolver.resolvePackage(fa)});P=Ib.arr.intersect(P,u);if(0<
P.length)throw u=1<P.length,u=Error("Package".concat(u?"s":""," ").concat(P.map(function(fa){return'"'.concat(fa.name,'"')}),"\n").concat(u?"are":"is"," directly required by part, yet set to be excluded.")),u.name="Exclusion Conflict",u.reducedExclusionSet=Ib.arr.withoutAll(this.excludedModules,P.map(function(fa){return fa.name})),u;}},{key:"getRootModule",value:function(){var u=bc(regeneratorRuntime.mark(function P(){return regeneratorRuntime.wrap(function(fa){for(;;)switch(fa.prev=fa.next){case 0:if(!this.rootModuleId){fa.next=
6;break}if(this.autoRun){fa.next=3;break}return fa.abrupt("return",'export * from "'.concat(this.rootModuleId,'";'));case 3:return fa.next=5,this.synthesizeMainModule();case 5:return fa.abrupt("return",fa.sent);case 6:return fa.next=8,this.synthesizeSnapshotModule();case 8:return fa.abrupt("return",fa.sent);case 9:case "end":return fa.stop()}},P,this)}));return function(){return u.apply(this,arguments)}}()},{key:"synthesizeMainModule",value:function(){var u=bc(regeneratorRuntime.mark(function P(){var fa;
return regeneratorRuntime.wrap(function(Qa){for(;;)switch(Qa.prev=Qa.next){case 0:return Qa.t0=Ib,Qa.t1=this.resolver,Qa.next=4,this.resolver.normalizeFileName("lively.freezer/src/util/main-module.js");case 4:return Qa.t2=Qa.sent,Qa.t3=Qa.t1.ensureFileFormat.call(Qa.t1,Qa.t2),Qa.next=8,Qa.t0.resource.call(Qa.t0,Qa.t3).read();case 8:return fa=Qa.sent,Qa.abrupt("return",fa.replace("prepare()","const { main, WORLD_CLASS = World, TITLE } = await System.import('".concat(this.rootModuleId,"')")));case 10:case "end":return Qa.stop()}},
P,this)}));return function(){return u.apply(this,arguments)}}()},{key:"synthesizeSnapshotModule",value:function(){var u=bc(regeneratorRuntime.mark(function P(){var fa,Qa,Ua;return regeneratorRuntime.wrap(function(Gb){for(;;)switch(Gb.prev=Gb.next){case 0:return Gb.t0=Ib,Gb.t1=this.resolver,Gb.next=4,this.resolver.normalizeFileName("lively.freezer/src/util/snapshot-module.js");case 4:return Gb.t2=Gb.sent,Gb.t3=Gb.t1.ensureFileFormat.call(Gb.t1,Gb.t2),Gb.next=8,Gb.t0.resource.call(Gb.t0,Gb.t3).read();
case 8:return fa=Gb.sent,Gb.next=11,this.getRequiredModulesFromSnapshot(this.snapshot);case 11:Qa=Gb.sent;Ua=Qa.requiredModules;this.checkIfImportedPackageExcluded(Ua);Gb.t4=Ib.arr.uniq(Ua.map(function(ta){return'import "'.concat(ta,'"')})).join("\n");if(!this.excludedModules.includes("localconfig.js")){Gb.next=19;break}Gb.t5="";Gb.next=22;break;case 19:return Gb.next=21,this.resolver.load(Ib.string.joinPath(Ib.baseURL,"localconfig.js"));case 21:Gb.t5=Gb.sent;case 22:return Gb.t6=Gb.t5,Gb.t7=Gb.t4+
Gb.t6,Gb.t8=fa.replace('{"SNAPSHOT": "PLACEHOLDER"}',JSON.stringify(JSON.stringify(Ib.obj.dissoc(this.snapshot,["preview","packages"])))),Gb.abrupt("return",Gb.t7+Gb.t8);case 26:case "end":return Gb.stop()}},P,this)}));return function(){return u.apply(this,arguments)}}()},{key:"needsScopeToBeCaptured",value:function(u,O){var P=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1;if(P&&"global"===this.resolver.detectFormatFromSource(P)||O&&Ib.resource(u).host()!==Ib.resource(O).host())return!1;
if(!this.wasFetchedFromEsmCdn(u))return!0}},{key:"wasFetchedFromEsmCdn",value:function(u){return!!Ib.ESM_CDNS.find(function(O){return u.includes(O)})}},{key:"needsClassInstrumentation",value:function(u,O){return Ib.CLASS_INSTRUMENTATION_MODULES_EXCLUSION.some(function(P){return u.includes(P)})?!1:Ib.CLASS_INSTRUMENTATION_MODULES.some(function(P){return u.includes(P)||P===u})?!0:this.wasFetchedFromEsmCdn(u)?!1:this.isComponentModule(u)||O&&O.match(/extends (Morph|Image|Ellipse|HTMLMorph|Path|Polygon|Text|InteractiveMorph|ViewModel)/)?
!0:!1}},{key:"isComponentModule",value:function(u){return u.endsWith(".cp.js")}},{key:"isLivelyCoreModule",value:function(u){return u.includes("lively.")}},{key:"needsDynamicLoadTransform",value:function(u){return u.includes("System.import")}},{key:"instrumentDynamicLoads",value:function(){var u=bc(regeneratorRuntime.mark(function Qa(P,fa){var Ua,Gb,ta;return regeneratorRuntime.wrap(function(mc){for(;;)switch(mc.prev=mc.next){case 0:return Ua=Ib.ast.parse(P),Gb=[],ta=[],Ib.ast.AllNodesVisitor.run(Ua,
function(pc,zd){if("CallExpression"===pc.type&&"MemberExpression"===pc.callee.type&&"import"===pc.callee.property.name&&"System"===pc.callee.object.name&&1===pc.arguments.length)try{var Pd=ta.push(eval(Ib.ast.stringify(pc.arguments[0])));Gb.push({target:pc.arguments[0],replacementFunc:function(bd,Yd){return ta[Pd-1]?'"'.concat(ta[Pd-1],'"'):Yd}});Gb.push({target:pc.callee,replacementFunc:function(){return"import"}})}catch(bd){}}),mc.next=6,Promise.all(ta);case 6:return mc.t0=function(pc){return pc.isError?
void 0:pc.value},ta=mc.sent.map(mc.t0),this.hasDynamicImports||(this.hasDynamicImports=0<ta.length),mc.abrupt("return",Ib.ast.transform.replaceNodes(Gb,P).source);case 10:case "end":return mc.stop()}},Qa,this)}));return function(P,fa){return u.apply(this,arguments)}}()},{key:"transform",value:function(){var u=bc(regeneratorRuntime.mark(function Qa(P,fa){return regeneratorRuntime.wrap(function(Ua){for(;;)switch(Ua.prev=Ua.next){case 0:if(!fa.startsWith("\x00")&&!fa.endsWith(".json")){Ua.next=2;break}return Ua.abrupt("return",
P);case 2:if(!this.needsDynamicLoadTransform(P)){Ua.next=6;break}Ua.next=5;return this.instrumentDynamicLoads(P,fa);case 5:P=Ua.sent;case 6:if(fa!==Ib.ROOT_ID){Ua.next=8;break}return Ua.abrupt("return",P);case 8:if(this.needsScopeToBeCaptured(fa,null,P)||this.needsClassInstrumentation(fa,P))P=this.captureScope(P,fa);return Ua.abrupt("return",P);case 10:case "end":return Ua.stop()}},Qa,this)}));return function(P,fa){return u.apply(this,arguments)}}()},{key:"resolveId",value:function(){var u=bc(regeneratorRuntime.mark(function Qa(P,
fa){var Ua,Gb;return regeneratorRuntime.wrap(function(ta){for(;;)switch(ta.prev=ta.next){case 0:if(!this.resolved[Ib.resolutionId(P,fa)]){ta.next=2;break}return ta.abrupt("return",this.resolved[Ib.resolutionId(P,fa)]);case 2:if(P!==Ib.ROOT_ID){ta.next=4;break}return ta.abrupt("return",P);case 4:if(fa){ta.next=6;break}return ta.abrupt("return",this.resolver.resolveModuleId(P));case 6:Ib.isCdnImport(P,fa,this.resolver)&&(P=P.startsWith(".")?Ib.resource(fa).parent().join(P).withRelativePartsResolved().url:
Ib.resource(fa).root().join(P).withRelativePartsResolved().url);(Ua=this.resolver.resolvePackage(fa))&&Ua.map&&(this.globalMap=Object.assign({},this.globalMap,{},Ua.map),Ua.map[P]||this.globalMap[P])&&(!Ua.map[P]&&this.globalMap[P]&&console.warn('[freezer] No mapping for "'.concat(P,'" provided by package "').concat(Ua.name,'". Guessing "').concat(this.globalMap[P],'" based on past resolutions. Please consider adding a map entry to this package config in oder to make the package definition sound and work independently of the current setup!')),
P=Ua.map[P]||this.globalMap[P],P["~node"]&&(P=P["~node"]),fa=Ua.url);if(!P.startsWith(".")){ta.next=22;break}ta.prev=10;ta.next=13;return this.resolveRelativeImport(fa,P);case 13:Gb=ta.sent;if(!this.belongsToExcludedPackage(Gb)){ta.next=16;break}return ta.abrupt("return",null);case 16:return ta.abrupt("return",this.resolved[Ib.resolutionId(P,fa)]=Gb);case 19:return ta.prev=19,ta.t0=ta["catch"](10),ta.abrupt("return",null);case 22:if(P.endsWith(".js")||Ib.isCdnImport){ta.next=29;break}ta.next=25;return this.resolver.normalizeFileName(P);
case 25:Gb=ta.sent;if(!this.belongsToExcludedPackage(Gb)){ta.next=28;break}return ta.abrupt("return",null);case 28:return ta.abrupt("return",this.resolved[Ib.resolutionId(P,fa)]=Gb);case 29:Gb=this.resolver.resolveModuleId(P,fa,this.getResolutionContext());if(!this.belongsToExcludedPackage(Gb)){ta.next=32;break}return ta.abrupt("return",null);case 32:return ta.abrupt("return",this.resolved[Ib.resolutionId(P,fa)]=Gb);case 33:case "end":return ta.stop()}},Qa,this,[[10,19]])}));return function(P,fa){return u.apply(this,
arguments)}}()},{key:"belongsToExcludedPackage",value:function(u){var O=this.resolver.resolvePackage(u);return O&&this.excludedModules.includes(O.name)?(console.log("excluding",u),!0):!1}},{key:"resolveDynamicImport",value:function(u,O){return u.type&&this.isLivelyCoreModule(O)?null:(u=this.resolveId(u,O))&&Ib.obj.isString(u)?{external:!1,id:u}:u}},{key:"load",value:function(){var u=bc(regeneratorRuntime.mark(function fa(P){var Qa,Ua,Gb;return regeneratorRuntime.wrap(function(ta){for(;;)switch(ta.prev=
ta.next){case 0:if(!this.excludedModules.includes(P)){ta.next=5;break}if("lively.ast"!==P){ta.next=3;break}return ta.abrupt("return","\n        let nodes = {}, query = {}, transform = {}, BaseVisitor = Object;\n        export { nodes, query, transform, BaseVisitor };");case 3:if("lively.modules"!==P){ta.next=5;break}return ta.abrupt("return","\n        let scripting = {};\n        export { scripting };");case 5:if(P!==Ib.ROOT_ID){ta.next=10;break}ta.next=8;return this.getRootModule();case 8:return Qa=
ta.sent,ta.abrupt("return",Qa);case 10:Ua=this.resolver.resolvePackage(P);if(!Ua||!this.excludedModules.includes(Ua.name)||P.endsWith(".json")){ta.next=14;break}console.log("empty load",P);return ta.abrupt("return","");case 14:return ta.next=16,this.resolver.load(P);case 16:Gb=ta.sent;if(!P.endsWith(".json")){ta.next=19;break}return ta.abrupt("return",Gb);case 19:return Gb=Ib.fixSourceForBugsInGoogleClosure(P,Gb),ta.abrupt("return",Gb);case 21:case "end":return ta.stop()}},fa,this)}));return function(P){return u.apply(this,
arguments)}}()},{key:"buildStart",value:function(){var u=bc(regeneratorRuntime.mark(function fa(P){return regeneratorRuntime.wrap(function(Qa){for(;;)switch(Qa.prev=Qa.next){case 0:return this.resolver.setStatus({status:"Bundling..."}),this.snapshot&&this.getAssetsFromSnapshot(this.snapshot),Qa.next=4,this.resolver.whenReady();case 4:this.autoRun&&P.emitFile({type:"chunk",id:Ib.ROOT_ID});case 5:case "end":return Qa.stop()}},fa,this)}));return function(P){return u.apply(this,arguments)}}()},{key:"captureScope",
value:function(u,O){var P="",fa=this.captureModuleScope?"const ".concat("__varRecorder__",' = window.lively.FreezerRuntime.recorderFor("').concat(this.normalizedId(O),'");\n'):"",Qa={name:"__varRecorder__",type:"Identifier"},Ua=Ib.ast.parse(u),Gb=Ib.fun.compose(Ib.rewriteToCaptureTopLevelVariables,Ib.ast.transform.objectSpreadTransform),ta=this.getTransformOptions(this.resolver.resolveModuleId(O),Ua);this.needsClassInstrumentation(O,u)?P='import { initializeClass as initializeES6ClassForLively } from "lively.classes/runtime.js";\n':
ta.classToFunction=!1;u=Ua;this.isComponentModule(O)&&(u=Ib.ensureComponentDescriptors(Ua,this.normalizedId(O)));var mc="";if(this.captureModuleScope){u=Ib.insertCapturesForExportedImports(Gb(Ua,Qa,ta),{captureObj:Qa});var pc=[];O=[];Ib.ast.custom.forEachNode(u,function(Pd){"ImportDeclaration"===Pd.type&&Ib.arr.pushIfNotIncluded(pc,Pd);if("ExportDefaultDeclaration"===Pd.type){switch(Pd.declaration.type){case "Literal":var bd=Ib.Path("declaration.raw").get(Pd);break;case "Identifier":bd=Ib.Path("declaration.name").get(Pd);
break;case "ClassDeclaration":case "FunctionDeclaration":bd=Ib.Path("declaration.id.name").get(Pd)}bd&&(mc="".concat(Qa.name,".default = ").concat(bd,";\n"))}});Ua=0;for(Gb=Object.values(Ib.arr.groupBy(pc,function(Pd){return Pd.source.value}));Ua<Gb.length;Ua++)if(ta=Gb[Ua].filter(function(Pd){return Pd.specifiers.every(function(bd){return"ImportSpecifier"===bd.type})}),1<ta.length){var zd=Ib.arr.uniqBy(ta.map(function(Pd){return Pd.specifiers}).flat(),function(Pd,bd){return"ImportSpecifier"===Pd.type&&
"ImportSpecifier"===bd.type&&Pd.imported.name===bd.imported.name&&Pd.local.name===bd.local.name});ta[0].specifiers=zd;O.push.apply(O,Nb(ta.slice(1).map(function(Pd){Pd.body=[];Pd.type="Program";return Pd})))}}return fa+P+Ib.ast.stringify(u)+mc}},{key:"deriveVarName",value:function(u){return Ib.string.camelize(Ib.arr.last(u.split("/")).replace(/\.js|\.min/g,"").split(".").join(""))}},{key:"wrapStandalone",value:function(){var u=bc(regeneratorRuntime.mark(function fa(P){var Qa,Ua,Gb;return regeneratorRuntime.wrap(function(ta){for(;;)switch(ta.prev=
ta.next){case 0:return P=this.resolver.resolveModuleId(P,void 0,this.getResolutionContext()),ta.next=3,Ib.resource(P).read();case 3:return Qa=ta.sent,Ua=this.deriveVarName(P),Gb="global"===this.resolver.detectFormat(P)?"var ".concat(Ua,' = (function() {\n         var fetchGlobals = prepareGlobal("').concat(P,'");\n         ').concat(Qa,";\n         return fetchGlobals();\n      })();\n"):"\n      var ".concat(Ua,";\n        (function(module /* exports, require */) {\n         // optional parameters\n         var exports = arguments.length > 0 && arguments[1] !== undefined ? arguments[1] : {};\n         var require = arguments.length > 1 && arguments[2] !== undefined ? arguments[2] : function () {};\n  \n         // try to simulate node.js context\n         var exec = function(exports, require) {\n            ").concat(Qa,
" \n         };\n         exec(exports, require);\n         if (typeof module.exports !== 'function' && Object.keys(module.exports).length === 0) Object.assign(module.exports, exports);\n         if (typeof module.exports !== 'function' && Object.keys(module.exports).length === 0) {\n            exec(); // try to run as global\n         }\n         ").concat(Ua," = module.exports;\n       })({exports: {}});\n"),ta.abrupt("return",{code:Gb,global:Ua});case 7:case "end":return ta.stop()}},fa,this)}));
return function(P){return u.apply(this,arguments)}}()},{key:"generateGlobals",value:function(){var u=bc(regeneratorRuntime.mark(function P(){var fa,Qa,Ua,Gb,ta,mc,pc,zd,Pd,bd,Yd,le,Be,Ne,Re,nf=arguments;return regeneratorRuntime.wrap(function(af){for(;;)switch(af.prev=af.next){case 0:return fa=0<nf.length&&void 0!==nf[0]?nf[0]:this.hasDynamicImports,af.next=3,this.getRuntimeCode();case 3:Qa=af.sent,Ua=!1,Gb={},fa||(Qa+="".concat(this.asBrowserModule?"var fs = {};":'var fs = require("fs");'," var _missingExportShim = () => {}, show, System, require, timing, lively, Namespace, localStorage;")),
af.t0=regeneratorRuntime.keys(this.globalModules);case 8:if((af.t1=af.t0()).done){af.next=19;break}ta=af.t1.value;af.next=12;return this.wrapStandalone(ta);case 12:mc=af.sent;pc=mc.code;zd=mc.global;Qa+=pc;Gb[ta]=zd;af.next=8;break;case 19:if(!fa){af.next=35;break}if(!this.needsOldSystem){af.next=27;break}af.t2=Qa;af.next=24;return Ib.resource("https://raw.githubusercontent.com/systemjs/systemjs/0.21/dist/system.src.js").read();case 24:Qa=af.t2+=af.sent;af.next=31;break;case 27:return af.t3=Qa,af.next=
30,Ib.resource("https://raw.githubusercontent.com/systemjs/systemjs/6.12.1/dist/system.js").read();case 30:Qa=af.t3+=af.sent;case 31:Qa+="(".concat(Ib.instrumentStaticSystemJS.toString(),")(System);\n");if(this.needsOldSystem){Pd=ia(this.excludedModules.concat(this.asBrowserModule?["fs","events"]:[]));try{for(Pd.s();!(bd=Pd.n()).done;)Yd=bd.value,Qa+='System.set("'.concat(Yd,'", System.newModule({ default: {} }));\n')}catch(yf){Pd.e(yf)}finally{Pd.f()}}else Ua='<script type="systemjs-importmap">\n{\n"imports": {\n',
Ua+=this.excludedModules.concat(this.asBrowserModule?["fs","events"]:[]).map(function(yf){return'"'.concat(yf,'": "./@empty"')}).join(",\n"),Ua+="\n  }\n}\n\x3c/script>";af.next=37;break;case 35:le=ia(this.excludedModules);try{for(le.s();!(Be=le.n()).done;)Ne=Be.value,Re=Gb[Ne]=this.deriveVarName(Ne),Qa+="var ".concat(Re," = {};\n")}catch(yf){le.e(yf)}finally{le.f()}case 37:return af.abrupt("return",{code:Qa,globals:Gb,importMap:Ua});case 38:case "end":return af.stop()}},P,this)}));return function(){return u.apply(this,
arguments)}}()},{key:"getRuntimeCode",value:function(){var u=bc(regeneratorRuntime.mark(function P(){var fa,Qa,Ua,Gb;return regeneratorRuntime.wrap(function(ta){for(;;)switch(ta.prev=ta.next){case 0:return fa=this.includePolyfills&&this.asBrowserModule,ta.t0=Ib,ta.t1=this.resolver,ta.next=5,this.resolver.normalizeFileName("lively.freezer/src/util/runtime.js");case 5:return ta.t2=ta.sent,ta.t3=ta.t1.ensureFileFormat.call(ta.t1,ta.t2),ta.next=9,ta.t0.resource.call(ta.t0,ta.t3).read();case 9:return Qa=
ta.sent,ta.next=12,Ib.resource("https://unpkg.com/regenerator-runtime@0.13.7/runtime.js").read();case 12:Ua=ta.sent;if(!fa){ta.next=25;break}ta.t5=Ib;ta.t6=this.resolver;ta.next=18;return this.resolver.normalizeFileName("lively.freezer/deps/fetch.umd.js");case 18:return ta.t7=ta.sent,ta.t8=ta.t6.ensureFileFormat.call(ta.t6,ta.t7),ta.next=22,ta.t5.resource.call(ta.t5,ta.t8).read();case 22:ta.t4=ta.sent;ta.next=26;break;case 25:ta.t4="";case 26:return Gb=ta.t4,Qa="(".concat(Qa.slice(0,-1).replace("export ",
""),")();\n"),this.hasDynamicImports||(Qa+=Ib.SYSTEMJS_STUB),Qa+=Ua,Qa+=Gb,ta.abrupt("return",Ib.es5Transpilation(Qa));case 32:case "end":return ta.stop()}},P,this)}));return function(){return u.apply(this,arguments)}}()},{key:"getAssetsFromSnapshot",value:function(u){var O=this,P=u.snapshot;Object.entries(P).map(function(fa){fa=T(fa,2);var Qa=fa[0],Ua=fa[1];if(Ib.classNameOfId(P,Qa)&&Ib.moduleOfId(P,Qa)["package"]){fa=Ib.locateClass({className:Ib.classNameOfId(P,Qa),module:Ib.moduleOfId(P,Qa)});
fa=Object.entries(fa[Symbol["for"]("lively.classes-properties-and-settings")].properties).map(function(mc){mc=T(mc,2);var pc=mc[0];return mc[1].copyAssetOnFreeze&&pc}).filter(Boolean);fa=ia(fa);var Gb;try{var ta=function(){var mc=Gb.value;if(!Ua.props[mc]||Ua.props[mc].value.startsWith("assets"))return"continue";var pc=Ua.props[mc].value;if(""===pc||pc.startsWith("data:"))return"continue";var zd=Ib.resource(pc);if(zd.host()!==Ib.resource(Ib.baseURL).host())return"continue";zd._from=Qa;O.assetsToCopy.find(function(Pd){return Pd.url===
zd.url})||O.assetsToCopy.push(zd);Ua.props[mc].value="assets/"+zd.name()};for(fa.s();!(Gb=fa.n()).done;)ta()}catch(mc){fa.e(mc)}finally{fa.f()}}})}},{key:"generateIndexHtml",value:function(){var u=bc(regeneratorRuntime.mark(function Qa(P,fa){return regeneratorRuntime.wrap(function(Ua){for(;;)switch(Ua.prev=Ua.next){case 0:return Ua.next=2,Ib.generateLoadHtml(this.autoRun,P,this.resolver,fa);case 2:return Ua.abrupt("return",Ua.sent);case 3:case "end":return Ua.stop()}},Qa,this)}));return function(P,
fa){return u.apply(this,arguments)}}()},{key:"generateBundle",value:function(){var u=bc(regeneratorRuntime.mark(function ta(P,fa,Qa,Ua,Gb){var mc,pc,zd,Pd,bd,Yd,le,Be,Ne,Re,nf,af,yf,Ig,re,Ld,fc,wd,Ie,ff,Pe,Gf,Vf,cd,Y,Ba,mb,Ca,Cc,Fc,ud,ke,ze,xe;return regeneratorRuntime.wrap(function(qd){for(;;)switch(qd.prev=qd.next){case 0:mc=Object.values(fa);if(!this.minify||"esm"===Gb.format){qd.next=15;break}mc.forEach(function(We,of){We.instrumentedCode='"'.concat(Ib.separator,'",').concat(of,";\n")+We.code});
pc=mc.map(function(We){return We.instrumentedCode}).join("\n");qd.next=6;return Ib.compileOnServer(pc,this.resolver,this.useTerser);case 6:zd=qd.sent;Pd=zd.min;bd=Pd.split(new RegExp('"'.concat(Ib.separator,'";\n?')));Yd=new Map;mc.forEach(function(We,of){Yd.set(of,We.code)});bd.forEach(function(We){var of=We.match(/^[0-9]+;\n?/);of&&(of=Number(of[0].replace(/;\n?/,"")),Yd.set(of,We.replace(/^[0-9]+;\n?/,"")))});bd=Nb(Yd.values());le=ia(Ib.arr.zip(mc,bd));try{for(le.s();!(Be=le.n()).done;)Ne=T(Be.value,
2),Re=Ne[0],nf=Ne[1],Re.code=nf}catch(We){le.e(We)}finally{le.f()}case 15:if(!this.compress){qd.next=45;break}af=ia(mc);qd.prev=17;af.s();case 19:if((yf=af.n()).done){qd.next=37;break}Ig=yf.value;qd.t0=P;qd.t1=Ig.fileName+".gz";qd.next=25;return Ib.gzip(Ig.code);case 25:return qd.t2=qd.sent,qd.t3={type:"asset",fileName:qd.t1,source:qd.t2},qd.t0.emitFile.call(qd.t0,qd.t3),qd.t4=P,qd.t5=Ig.fileName+".br",qd.next=32,Ib.brotli(Ig.code);case 32:qd.t6=qd.sent,qd.t7={type:"asset",fileName:qd.t5,source:qd.t6},
qd.t4.emitFile.call(qd.t4,qd.t7);case 35:qd.next=19;break;case 37:qd.next=42;break;case 39:qd.prev=39,qd.t8=qd["catch"](17),af.e(qd.t8);case 42:return qd.prev=42,af.f(),qd.finish(42);case 45:if(!this.includeLivelyAssets){qd.next=142;break}re=this.resolver.ensureFileFormat(this.resolver.decanonicalizeFileName("lively.morphic").replace("index.js",""));Ld=Ib.resource(Ib.config.css.fontAwesome).parent().parent();qd.next=50;return Ld.join("css").dirList();case 50:return fc=qd.sent,qd.next=53,Ld.join("webfonts").dirList();
case 53:return wd=qd.sent,qd.next=56,Ib.resource(Ib.config.css.inconsolata).parent().dirList();case 56:Ie=qd.sent,ff=ia(fc),qd.prev=58,ff.s();case 60:if((Pe=ff.n()).done){qd.next=71;break}Gf=Pe.value;qd.t9=P;qd.t10=Ib.joinPath(Ld.url.replace(re,""),"css",Gf.name());qd.next=66;return Gf.read();case 66:qd.t11=qd.sent,qd.t12={type:"asset",fileName:qd.t10,source:qd.t11},qd.t9.emitFile.call(qd.t9,qd.t12);case 69:qd.next=60;break;case 71:qd.next=76;break;case 73:qd.prev=73,qd.t13=qd["catch"](58),ff.e(qd.t13);
case 76:return qd.prev=76,ff.f(),qd.finish(76);case 79:Vf=ia(wd),qd.prev=80,Vf.s();case 82:if((cd=Vf.n()).done){qd.next=92;break}Y=cd.value;Y.beBinary();qd.next=87;return Y.read();case 87:Ba=qd.sent,Ba instanceof ArrayBuffer&&(Ba=new Uint8Array(Ba)),P.emitFile({type:"asset",fileName:Ib.joinPath(Ld.url.replace(re,""),"webfonts",Y.name()),source:Ba});case 90:qd.next=82;break;case 92:qd.next=97;break;case 94:qd.prev=94,qd.t14=qd["catch"](80),Vf.e(qd.t14);case 97:return qd.prev=97,Vf.f(),qd.finish(97);
case 100:mb=ia(Ie),qd.prev=101,mb.s();case 103:if((Ca=mb.n()).done){qd.next=113;break}Cc=Ca.value;Cc.beBinary();qd.next=108;return Cc.read();case 108:Fc=qd.sent,Fc instanceof ArrayBuffer&&(Fc=new Uint8Array(Fc)),P.emitFile({type:"asset",fileName:Ib.joinPath("assets/inconsolata/",Cc.name()),source:Fc});case 111:qd.next=103;break;case 113:qd.next=118;break;case 115:qd.prev=115,qd.t15=qd["catch"](101),mb.e(qd.t15);case 118:return qd.prev=118,mb.f(),qd.finish(118);case 121:ud=ia(this.assetsToCopy),qd.prev=
122,ud.s();case 124:if((ke=ud.n()).done){qd.next=134;break}ze=ke.value;ze.beBinary();qd.next=129;return ze.read();case 129:xe=qd.sent,xe instanceof ArrayBuffer&&(xe=new Uint8Array(xe)),P.emitFile({type:"asset",fileName:Ib.joinPath("assets",ze.name()),source:xe});case 132:qd.next=124;break;case 134:qd.next=139;break;case 136:qd.prev=136,qd.t16=qd["catch"](122),ud.e(qd.t16);case 139:return qd.prev=139,ud.f(),qd.finish(139);case 142:P.emitFile({type:"asset",fileName:"@empty",source:""});if(!this.autoRun){qd.next=
151;break}P.emitFile({type:"asset",fileName:"deps.js",source:Qa});qd.t17=P;qd.next=148;return this.generateIndexHtml(Ua,mc);case 148:qd.t18=qd.sent,qd.t19={type:"asset",fileName:"index.html",source:qd.t18},qd.t17.emitFile.call(qd.t17,qd.t19);case 151:this.resolver.finish();case 152:case "end":return qd.stop()}},ta,this,[[17,39,42,45],[58,73,76,79],[80,94,97,100],[101,115,118,121],[122,136,139,142]])}));return function(P,fa,Qa,Ua,Gb){return u.apply(this,arguments)}}()},{key:"finishBundle",value:function(){var u=
bc(regeneratorRuntime.mark(function fa(P){var Qa,Ua,Gb,ta,mc;return regeneratorRuntime.wrap(function(pc){for(;;)switch(pc.prev=pc.next){case 0:return pc.next=2,this.generateGlobals();case 2:Ib.__inter0__=pc.sent;Qa=Ib.__inter0__.code;Gb=Ib.__inter0__.globals;Ua=Ib.__inter0__.importMap;if(!this.hasDynamicImports){pc.next=16;break}pc.next=9;return P.generate({format:"system",globals:Gb});case 9:return ta=pc.sent,pc.next=12,this.handleSplittedBuild(ta.output,Qa);case 12:mc=pc.sent;mc.format="systemjs";
pc.next=23;break;case 16:return pc.next=18,P.generate({format:this.asBrowserModule?"iife":"cjs",globals:Gb});case 18:return ta=pc.sent,pc.next=21,this.transpileAndCompressOnServer({bundledCode:ta.output[0].code,depsCode:Qa});case 21:mc=pc.sent,mc.format="global";case 23:return mc.assets=this.assetsToCopy,mc.rollup=this,mc.importMap=Ua,this.resolver.finish(),pc.abrupt("return",mc);case 28:case "end":return pc.stop()}},fa,this)}));return function(P){return u.apply(this,arguments)}}()},{key:"handleSplittedBuild",
value:function(){var u=bc(regeneratorRuntime.mark(function Qa(P,fa){var Ua,Gb,ta,mc,pc,zd,Pd,bd,Yd,le,Be,Ne,Re;return regeneratorRuntime.wrap(function(nf){for(;;)switch(nf.prev=nf.next){case 0:return Ua="\n        window.frozenPart = {\n          renderFrozenPart: (domNode, baseURL) => {\n            if (baseURL) System.config( { baseURL });\n            if (!baseURL) baseURL = './';\n            System.config({\n              meta: {\n               ".concat(P.map(function(af){return"[baseURL + '".concat(af.fileName,
'\']: {format: "system"}')}).join(",\n"),'\n              }\n            });\n            System.import("./').concat(Ib.ROOT_ID,'").then(m => { System.trace = false; m.renderFrozenPart(domNode); });\n          }\n        }\n      '),P.forEach(function(af,yf){af.instrumentedCode=af.code.replace("System.register(",'System.register("'.concat(yf,'",'))}),nf.next=4,this.transpileAndCompressOnServer({depsCode:fa,bundledCode:[Ua].concat(Nb(P.map(function(af){return af.instrumentedCode}))).join('"'.concat(Ib.separator,
'";'))});case 4:Gb=nf.sent;ta=Gb.min;mc=ta.split(this.useTerser?/,System.register\(/:new RegExp('"'.concat(Ib.separator,'";\n?System.register(')));pc=ka(mc);zd=pc[0];Pd=pc.slice(1);bd=new Map;P.forEach(function(af,yf){bd.set(yf,af.code)});Pd.forEach(function(af){var yf=Number(af.match(/"[0-9]+"/)[0].slice(1,-1));bd.set(yf,af.replace(/"[0-9]+",/,"System.register("))});Pd=Nb(bd.values());P.load={min:zd};Yd=ia(Ib.arr.zip(P,Pd));try{for(Yd.s();!(le=Yd.n()).done;)Be=T(le.value,2),Ne=Be[0],Re=Be[1],Ne.min=
Re}catch(af){Yd.e(af)}finally{Yd.f()}return nf.abrupt("return",P);case 15:case "end":return nf.stop()}},Qa,this)}));return function(P,fa){return u.apply(this,arguments)}}()},{key:"transpileAndCompressOnServer",value:function(){var u=bc(regeneratorRuntime.mark(function fa(P){var Qa,Ua,Gb,ta,mc,pc,zd,Pd,bd;return regeneratorRuntime.wrap(function(Yd){for(;;)switch(Yd.prev=Yd.next){case 0:Qa=P.depsCode;Ua=void 0===Qa?"":Qa;Gb=P.bundledCode;ta=P.fileName;mc=void 0===ta?"":ta;pc=P.optimize;zd=void 0===
pc?!0:pc;this.resolver.setStatus({title:"Freezing Part",status:"Optimizing..."});Pd=Ua+Gb;if(zd){Yd.next=5;break}return Yd.abrupt("return",{code:Pd,min:Pd});case 5:return Yd.next=7,Ib.compileOnServer(Pd,this.resolver,mc,this.useTerser);case 7:return bd=Yd.sent,Yd.abrupt("return",bd);case 9:case "end":return Yd.stop()}},fa,this)}));return function(P){return u.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"LivelyRollup"}}],ca,{pathInPackage:function(){return"./src/bundler.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:3786,end:43864})}(void 0);Ib["default"]=C;var Pb=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/plugins/rollup.js");Pb.isBuiltin=function(wa,ca){return wa.startsWith("node:")||ca.builtinModules.includes(wa)};Pb.isCommonJsModule=function(wa){return wa.includes("?commonjs-external")||
wa.includes("?commonjs-exports")||wa.includes("?commonjs-entry")||wa.includes("commonjsHelpers.js")};Pb.LivelyRollup=C;Pb.customWarn=rf;Pb.ROOT_ID=Ob;Pb.obj=ba;var da=window.lively.FreezerRuntime.recorderFor("lively.freezer/index.js");da.clearWorldSnapshot=function(wa){var ca=[],ma=[];da.obj.values(wa.snapshot).forEach(function(Ua){return delete Ua.props.metadata});da.transpileAttributeConnections(wa);for(var u in wa.snapshot){delete wa.snapshot[u].props.localComponents;delete wa.snapshot[u].props.metadata;
delete wa.snapshot[u]._cachedLineCharBounds;u===wa.id&&(wa.snapshot[u].props.showsUserFlap={value:!1});var O=da.moduleOfId(wa.snapshot,u);O["package"]&&("lively.ide"===O["package"].name&&ma.push(u),da.DEFAULT_EXCLUDED_MODULES_WORLD.includes(O["package"].name)&&(delete wa.snapshot[u],ca.push(u)))}for(var P in wa.snapshot)if(u=da.classNameOfId(wa.snapshot,P),0<da.arr.intersect(da.referencesOfId(wa.snapshot,P),[].concat(ca,ma)).length)if("Window"===u)delete wa.snapshot[P];else for(u=0,O=Object.entries(wa.snapshot[P].props);u<
O.length;u++){var fa=T(O[u],2),Qa=fa[0];fa=fa[1].value;da.isReference(fa)&&ca.includes(fa.id)&&delete wa.snapshot[P].props[Qa];Array.isArray(fa)&&(wa.snapshot[P].props[Qa].value=fa.filter(function(Ua){return!(da.isReference(Ua)&&ca.includes(Ua.id))}))}da.removeUnreachableObjects([wa.id],wa.snapshot);return wa};da.promptForFreezing=function(wa,ca){return ld.apply(this,arguments)};da.bundlePart=Td;da.bundleModule=Vc;da.jspmCompile=cc;da.bootstrapLibrary=ac;da.interactivelyFreezeWorld=qe;da.interactivelyFreezePart=
nc;da.interactivelyFreezeModule=fd;da.rollup=xb;da.jsonPlugin=Ja;da.part=ic;da.resource=vd;da.Path=yb;da.obj=ba;da.arr=ec;da.LoadingIndicator=Wa;da.removeUnreachableObjects=K;da.createMorphSnapshot=ya;da.serializeMorph=pb;da.moduleOfId=db;da.isReference=La;da.referencesOfId=eb;da.classNameOfId=zb;da.defaultDirectory=jb;da.FreezerPrompt=za;da.transpileAttributeConnections=Eb;da.writeFiles=fe;da.topLevelDeclsAndRefs=E;da.parse=Wb;da.stringify=R;da.BrowserResolver=Fa;da.lively=Dd;da.DEFAULT_EXCLUDED_MODULES_PART=
["kld-intersections"];da.DEFAULT_EXCLUDED_MODULES_WORLD="lively.ast lively.vm lively-system-interface pouchdb pouchdb-adapter-mem rollup lively.halos".split(" ");da.DEFAULT_EXCLUDED_MODULES="lively.ast lively.vm lively-system-interface pouchdb pouchdb-adapter-mem rollup lively.halos lively.ide lively.freezer lively.modules lively.storage lively.user".split(" ");da.bundlePart=Td;da.bundleModule=Vc;da.jspmCompile=cc;da.bootstrapLibrary=ac;da.interactivelyFreezeWorld=qe;da.interactivelyFreezePart=nc;
da.interactivelyFreezeModule=fd}}});
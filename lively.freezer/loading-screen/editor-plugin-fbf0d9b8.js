System.register(["./__root_module__-a4bfb546.js","kld-intersections","./index-164fc5db.js","./editor-plugin-2a7f8211.js","./index-fa81bc5d.js"],function(ta){var cb,mb,Sb,Jb,sd,vc,wd,wc,Cc,Gc,Cd,pe,Je,ce,Qb,pc,ld,Rb,xd,Hd,Dc,bc,Ib,gc;return{setters:[function(sc){cb=sc.aw;mb=sc.bA;Sb=sc.bB;Jb=sc.bC;sd=sc.E;vc=sc.au;wd=sc.aY;wc=sc.a7;Cc=sc.ae;Gc=sc.bn;Cd=sc.a6;pe=sc.$;Je=sc.bD;ce=sc.bu},function(){},function(sc){Qb=sc.s},function(sc){pc=sc.p;ld=sc.d;Rb=sc.a;xd=sc.r;Hd=sc.C},function(sc){Dc=sc.localInterface;
bc=sc.systemInterfaceNamed;Ib=sc.serverInterfaceFor;gc=sc.l2lInterfaceFor}],execute:function(){var sc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");sc.warnStyle={"border-bottom":"2px dotted orange"};sc.errorStyle={"background-color":"red"};var dd=function(Za){var U=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),va=U.hasOwnProperty("JavaScriptChecker")&&"function"===typeof U.JavaScriptChecker?U.JavaScriptChecker:U.JavaScriptChecker=function(M){M&&M[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(va,Za,[{key:"uninstall",value:function(M){var da=M.text||M;(da.markers||[]).forEach(function(Ia){return Ia.id.startsWith("js-checker-")&&da.removeMarker(Ia)});da.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(M,da){return[].concat($jscomp.arrayFromIterable(M.embeddedMorphMap.values())).find(function(Ia){return da.containsPosition(Ia.anchor.position)})}},{key:"onDocumentChange",value:function(M,
da,Ia){var Wa=da.document;try{var Zb=Ia.parse()}catch(Oc){Zb=Oc}Zb&&(M=(da.markers||[]).filter(function(Oc){return Oc.id.startsWith("js-checker-")}),Ia=Ia.undeclaredVariables().map(function(Oc,Ub){var vb=Oc.start;Oc=Oc.end;vb=Wa.indexToPosition(vb);Oc=Wa.indexToPosition(Oc);return da.addMarker({id:"js-checker-"+Ub,style:sc.warnStyle,range:{start:vb,end:Oc},type:"js-undeclared-var"})}),M.slice(Ia.length).forEach(function(Oc){return da.removeMarker(Oc)}),Zb.parseError?(M=Zb.parseError.loc,Ia=M.column,
M=M.line-1,Zb=Wa.indexToPosition(Zb.parseError.pos),Ia=Zb.column,M=Zb.row,Zb={start:{column:Ia-1,row:M},end:{column:Ia+1,row:M}},this.hasEmbeddedMorphInRange(da,Zb)||da.addMarker({id:"js-syntax-error",range:Zb,style:sc.errorStyle,type:"js-syntax-error"})):da.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],U,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),bd=dd=sc.JavaScriptChecker;sc.default=dd;var oc=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");oc.query=mb;oc.fuzzyParse=Sb;oc.acorn=Jb;oc.custom=sd;var $a=function(Za){var U=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),va=U.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof U.JavaScriptNavigator?
U.JavaScriptNavigator:U.JavaScriptNavigator=function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(va,Za,[{key:"ensureAST",value:function(M){return this.parse(M.textString)}},{key:"parse",value:function(M){return oc.fuzzyParse(M)}},{key:"move",value:function(M,da){var Ia=!!da.activeMark||!da.selection.isEmpty(),Wa=da.selection,Zb=da.positionToIndex(Wa.lead);M=this[M](da.textString,Zb);M=da.indexToPosition(M);Wa.lead=
M;Ia||(Wa.anchor=M);da.scrollCursorIntoView()}},{key:"forwardSexp",value:function(M){this.move("_forwardSexp",M)}},{key:"backwardSexp",value:function(M){this.move("_backwardSexp",M)}},{key:"backwardUpSexp",value:function(M){this.move("_backwardUpSexp",M)}},{key:"forwardDownSexp",value:function(M){this.move("_forwardDownSexp",M)}},{key:"_forwardSexp",value:function(M,da){M=this.parse(M);M=oc.custom.findNodesIncluding(M,da).reverse().find(function(Wa){return Wa.end!==da});if(!M)return da;if("BlockStatement"===
M.type){var Ia=M.body.find(function(Wa){return Wa.start>da});if(Ia)return Ia.start}return M.end}},{key:"_backwardSexp",value:function(M,da){M=this.parse(M);M=oc.custom.findNodesIncluding(M,da).reverse().find(function(Wa){return Wa.start!==da});if(!M)return da;if("BlockStatement"===M.type){var Ia=M.body.slice().reverse().find(function(Wa){return Wa.end<da});if(Ia)return Ia.end}return M?M.start:da}},{key:"_backwardUpSexp",value:function(M,da){M=this.parse(M);return(M=oc.custom.findNodesIncluding(M,
da).reverse().find(function(Ia){return Ia.start!==da}))?M.start:da}},{key:"_forwardDownSexp",value:function(M,da){M=this.parse(M);return(M=oc.custom.findNodeAfter(M,da,function(Ia,Wa){return Wa.start>da}))?M.node.start:da}},{key:"markDefun",value:function(M){var da=this.rangeForFunctionOrDefinition(M.textString,[M.positionToIndex(M.selection.range.start),M.positionToIndex(M.selection.range.end)]);da&&M.execCommand("expandRegion",{start:da[0],end:da[1]})}},{key:"rangeForNodesMatching",value:function(M,
da,Ia){M=this.parse(M);return(da=oc.custom.findNodesIncluding(M,da).reverse().find(Ia))?[da.start,da.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(M,da){var Ia=da[0]===da[1];return this.rangeForNodesMatching(M,da[1],function(Wa){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(Wa.type)&&(Ia&&Wa.end!==da[1]||!Ia&&Wa.start<da[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(M,da){"number"!==typeof da&&(da=M.positionToIndex(da));
M=this.ensureAST(M);var Ia=oc.query.nodesAt(da,M).reverse(),Wa=Ia.find(function(Oc){return"Identifier"===Oc.type});if(!Wa&&((Ia=Ia[0])&&Ia.type.includes("Specifier")&&Ia.local&&"Identifier"===Ia.local.type&&(Wa=Ia.local),!Wa))return;da=(Ia=oc.query.findDeclarationClosestToIndex(M,Wa.name,da))?oc.query.scopeAtIndex(M,Ia.start):oc.query.scopeAtIndex(M,da);var Zb=oc.query.findReferencesAndDeclsInScope(da,Wa.name).refs;return{parsed:M,scope:da,id:Wa,name:Wa.name,decl:Ia,refs:Zb}}},{key:"expandRegion",
value:function(M,da,Ia,Wa){function Zb(pd){pd=M.positionToIndex({column:0,row:Ub.row});return{range:[pd+vb.start,pd+vb.start+vb.value.length],prev:Wa}}var Oc=Wa.range[0]!==Wa.range[1],Ub=M.indexToPosition(Wa.range[0]),vb=M.tokenAt(Ub);if(!Oc&&vb&&["keyword","identifier"].includes(vb.type))return Zb();Ia=Ia||this.parse(da);da=oc.query.nodesAtIndex(Ia,Wa.range[0]).reverse().find(function(pd){return pd.start<Wa.range[0]||pd.end>Wa.range[1]});if(!da)return Wa;Ia=da.start;Oc=da.end;return"Literal"===da.type&&
(da.raw||"").match(/^['"`]/)&&Wa.range[0]!==da.start&&Wa.range[1]!==da.end&&(da.start+1<Wa.range[0]||da.end-1>Wa.range[1])?{range:[Ia+1,Oc-1],prev:Wa}:{range:[Ia,Oc],prev:Wa}}},{key:"contractRegion",value:function(M,da,Ia,Wa){return Wa.prev||Wa}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],U,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6780})}(void 0);dd=$a=oc.JavaScriptNavigator;oc.default=$a;var fb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");fb.addIndexToTextPos=function(Za,U,va){return Za.indexToPosition(Za.positionToIndex(U)+va)};fb.connect=vc;fb.disconnect=wd;fb.string=wc;fb.KeyHandler=Cc;fb.Range=Gc;$a=function(Za){var U=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),va=U.hasOwnProperty("Snippet")&&"function"===
typeof U.Snippet?U.Snippet:U.Snippet=function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(va,Za,[{key:Symbol.for("lively-instance-initialize"),value:function(M){M=void 0===M?{trigger:null,expansion:""}:M;var da=M.expansion;this.trigger=M.trigger;this.expansion=da;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(M){this.isExpanding&&(this.textMorph=M,fb.connect(this.textMorph,
"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(M){this.isExpanding&&(fb.disconnect(M,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var M=this.expansionState,da=M.startAnchor,Ia=M.endAnchor;M.isExpanding?fb.Range.fromPositions(da.position,Ia.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var M=this.textMorph;if(M){var da=
this.expansionState||{},Ia=da.marker,Wa=da.startAnchor,Zb=da.endAnchor;da=da.steps;Wa&&M.removeAnchor(Wa);Zb&&M.removeAnchor(Zb);Ia&&M.removeMarker(Ia);da.forEach(function(Oc){return M.removeAnchor(Oc.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};M&&M.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(M){var da=[],Ia=0;fb.string.reMatches(M,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(Wa){var Zb=
Wa.start,Oc=Wa.end;Wa=Wa.match;var Ub="";Wa.startsWith("${")?(Ub=$jscomp.makeIterator(Wa.match(/^\$\{([0-9]+):([^\}]*)\}/)),Ub.next(),Wa=Ub.next().value,Ub=Ub.next().value,Wa=Number(Wa)):Wa=Number(Wa.replace(/^\$/,""));M=M.slice(0,Zb-Ia)+Ub+M.slice(Oc-Ia);da[Wa]={index:Zb-Ia,prefill:Ub,anchor:null};Ia+=Oc-Zb-Ub.length});return{steps:da,expansion:M}}},{key:"expandAtCursor",value:function(M){var da=M.selection,Ia=M.cursorPosition.column,Wa=this.expansion;this.trigger&&(Ia-=this.trigger.length);if(Ia=
Math.max(0,Ia))Wa=fb.string.lines(Wa),Wa=[Wa[0]].concat($jscomp.arrayFromIterable(Wa.slice(1).map(function($c){return fb.string.indent($c," ",Ia)}))),Wa=Wa.join("\n");var Zb=this.createExpansionSteps(Wa);Wa=Zb.expansion;Zb=Zb.steps;this.trigger&&da.growLeft(this.trigger.length);da.text=Wa;var Oc=da.start;Wa=da.end;da.collapseToEnd();if(Zb.length){var Ub=fb.string.newUUID();Zb.forEach(function($c,Sa){return $c.anchor=M.addAnchor(Object.assign({id:"snippet-step-"+Sa+"-"+Ub},fb.addIndexToTextPos(M,Oc,
$c.index)))});var vb=M.addAnchor(Object.assign({id:"snippet-start-"+Ub},Oc,{insertBehavior:"stay"})),pd=M.addAnchor(Object.assign({id:"snippet-end-"+Ub},Wa));this.expansionState={marker:M.addMarker({id:"snippet-marker-"+Ub,get range(){return{start:vb.position,end:pd.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:vb,endAnchor:pd,stepIndex:0,steps:Zb,isExpanding:!0};
M.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var M=this.expansionState,da=M.steps,Ia=this.textMorph;if(M.isExpanding&&Ia){Ia=Ia.selection;M=da[M.stepIndex];var Wa=M.prefill;Ia.lead=Ia.anchor=M.anchor.position;Ia.growRight(Wa.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=da.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(M,da){da=M.positionToIndex(M.cursorPosition);
return M.textString.slice(da-this.trigger.length,da)===this.trigger}},{key:"tryTrigger",value:function(M,da){if(!this.canExpand(M,M.cursorPosition))return!1;this.expandAtCursor(M);return!0}},{key:"getCommands",value:function(M){var da=this;return M.concat([{name:"[snippet] next expansion step",exec:function(Ia){da.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(Ia){da.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(M){return M.concat(fb.KeyHandler.withBindings([{keys:"Tab",
command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],U,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:357,end:6029})}(void 0);fb.Snippet=$a;fb.Snippet=$a;fb.Snippet=
$a;var ya=[{name:"get snippets",exec:function(Za){return Za.pluginCollect("getSnippets",[])}}];fb.snippetCommands=ya;fb.snippetCommands=ya;fb.snippetCommands=ya;var Ca=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");Ca.buildEvalOpts=function(Za,U){return Za.plugins.find(function(va){return va.isJSEditorPlugin}).sanatizedJsEnv(U)};Ca.Snippet=$a;ya=function(Za){var U=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),va=U.hasOwnProperty("ModuleTopLevelVarCompleter")&&
"function"===typeof U.ModuleTopLevelVarCompleter?U.ModuleTopLevelVarCompleter:U.ModuleTopLevelVarCompleter=function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(va,Za,[{key:"compute",value:function(M,da){var Ia,Wa,Zb,Oc,Ub,vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pd){if(1==pd.nextAddress){Wa=(Ia=M.pluginFind(function($c){return $c.isJSEditorPlugin}))&&Ia.systemInterface();if(!Wa)return pd.return([]);
Zb=Ca.buildEvalOpts(M);Oc=Zb.targetModule;return"local"===Wa.name?(Ub=Object.getOwnPropertyNames(Wa.getModule(Oc).recorder),pd.jumpTo(2)):pd.yield(Wa.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+Oc+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',
{targetModule:"lively://module-recorder-completer"}),3)}if(2!=pd.nextAddress){vb=pd.yieldResult;if(vb.isError)return pd.return([]);Ub=JSON.parse(vb.value)}Ub=Ub.filter(function($c){return!$c.startsWith("defVar_")&&!["System","__currentLivelyModule","initializeES6ClassForLively","_moduleExport","_moduleImport"].includes($c)});return pd.return(Ub.map(function($c){return{priority:1100,completion:$c}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],
U,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:227,end:1700})}(void 0);Ca.ModuleTopLevelVarCompleter=ya;Ca.ModuleTopLevelVarCompleter=ya;Ca.ModuleTopLevelVarCompleter=ya;ya=function(Za){var U=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),va=U.hasOwnProperty("DynamicJavaScriptCompleter")&&
"function"===typeof U.DynamicJavaScriptCompleter?U.DynamicJavaScriptCompleter:U.DynamicJavaScriptCompleter=function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(va,Za,[{key:"isValidPrefix",value:function(M){return/\.[a-z0-9_]*$/i.test(M)}},{key:"isMethodCallCompletion",value:function(M){return M.endsWith(")")&&0<M.indexOf("(")}},{key:"isValidIdentifier",value:function(M){if("string"!==typeof M)return!1;this.isMethodCallCompletion(M)&&
(M=M.slice(0,M.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(M)?!0:!1}},{key:"wrapInBrackets",value:function(M){if(!isNaN(Number(M))||M.startsWith("Symbol."))return"["+M+"]";var da="";this.isMethodCallCompletion(M)&&(da=M.slice(M.indexOf("(")),M=M.slice(0,M.indexOf("(")));return'["'+M.replace(/"/g,'\\"')+'"]'+da}},{key:"compute",value:function(M){var da=this,Ia,Wa,Zb,Oc,Ub,vb,pd,$c,Sa,nb,tc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){if(1==ab.nextAddress){Ia=M.selection;
Ia.isEmpty()?(Wa=M.getLine(Ia.lead.row),Wa=Wa.slice(Wa.lastIndexOf(":")+1,Ia.lead.column)):Wa=Ia.text.slice(Math.max(0,Ia.text.indexOf(":")),0);if(!da.isValidPrefix(Wa))return ab.return([]);Oc=(Zb=M.pluginFind(function(zc){return zc.isJSEditorPlugin}))&&Zb.systemInterface();if(!Oc)return ab.return([]);Ub=Ca.buildEvalOpts(M);return ab.yield(Oc.dynamicCompletionsForPrefix(Ub.targetModule,Wa,Ub),2)}vb=ab.yieldResult;pd=vb.isError;$c=vb.value;Sa=vb.completions;nb=vb.prefix;if(pd)return console.warn("javascript completer encountered error: "+
($c.stack||$c)),ab.return([]);Sa.reduce(function(zc,Fc){Fc=$jscomp.makeIterator(Fc);Fc.next();Fc=Fc.next().value;return zc+Fc.length},0);tc=Sa.reduce(function(zc,Fc,Xa){Fc=$jscomp.makeIterator(Fc);var db=Fc.next().value;Fc=Fc.next().value;return zc.concat(Fc.map(function(hb){var Rc=da.isValidIdentifier(hb);return{info:db,completion:hb,prefix:Rc?nb:"."+nb,customInsertionFn:Rc?da.isMethodCallCompletion(hb)?function(qd,Xd,hc,Id){Xd=Id.start;Id=Id.end;qd=qd.replace(/\((.*)\)/,function(Pc){return"("+Pc.slice(1,
-1).split(", ").map(function(Jd,fa){return"${"+fa+":"+Jd+"}"}).join(", ")+")"});qd=new Ca.Snippet({expansion:qd});hc.replace({start:Xd,end:Id},"");qd.expandAtCursor(hc)}:null:function(qd,Xd,hc,Id){qd=Id.start;Id=Id.end;Xd={row:qd.row,column:qd.column-1};Id="."===hc.textInRange({start:Xd,end:qd})?{start:Xd,end:Id}:{start:qd,end:Id};hc.replace(Id,da.wrapInBrackets(hb))}}}))},[]);tc.forEach(function(zc,Fc){return Object.assign(zc,{priority:2E3+tc.length-Fc})});return ab.return(tc)})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DynamicJavaScriptCompleter"}}],U,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5085})}(void 0);Ca.DynamicJavaScriptCompleter=ya;Ca.DynamicJavaScriptCompleter=ya;Ca.DynamicJavaScriptCompleter=ya;Ca.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
ya=function(Za){var U=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),va=U.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof U.JavaScriptKeywordCompleter?U.JavaScriptKeywordCompleter:U.JavaScriptKeywordCompleter=function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(va,Za,[{key:"compute",value:function(M,da){return Ca.keywords.map(function(Ia){return{completion:Ia,priority:0}})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"JavaScriptKeywordCompleter"}}],U,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6087,end:6225})}(void 0);Ca.JavaScriptKeywordCompleter=ya;Ca.JavaScriptKeywordCompleter=ya;Ca.JavaScriptKeywordCompleter=ya;ya=[new Ca.DynamicJavaScriptCompleter,new Ca.JavaScriptKeywordCompleter,
new Ca.ModuleTopLevelVarCompleter];Ca.completers=ya;Ca.completers=ya;Ca.completers=ya;var Aa=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");Aa.Snippet=$a;var xa=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],["importd",'import ${0:name} from "${1:module}";'],
["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],["do","do {${1:/* code */}} while (${0:/* condition */});"],
["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],
["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],["ll","lively.lang."],["lls","lively.lang.string."],
["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],["fun","function ${0:functionName}($1) {$2}"],
["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];Aa.snippets=xa;Aa.snippets=xa;Aa.snippets=xa;var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");Oa.getEvalEnv=function(Za){return(Za=Za.pluginFind(function(U){return U.isJSEditorPlugin}))?Za.evalEnvironment:null};Oa.setEvalEnv=function(Za,U){(Za=Za.pluginFind(function(va){return va.isJSEditorPlugin}))&&Object.assign(Za.evalEnvironment,U);return Za.evalEnvironment};Oa.pToI=function(Za,U){return Za.positionToIndex(U)};
Oa.iToP=function(Za,U){return Za.indexToPosition(U)};Oa.arr=Cd;Oa.promise=pe;Oa.string=wc;Oa.show=Qb;Oa.Range=Gc;Oa.query=mb;Oa.BaseVisitor=Je;Aa=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(Za,U){U=void 0===U?{varName:null,position:null}:U;var va,M,da,Ia,Wa,Zb,Oc,Ub,vb,pd;return $jscomp.asyncExecutePromiseGeneratorProgram(function($c){switch($c.nextAddress){case 1:va=U;M=va.varName;da=va.position;
if(!M){da||(da=Za.cursorPosition);Ia=Za.pluginInvokeFirst("getNavigator");Wa=Ia.ensureAST(Za);Zb=Oa.query.nodesAt(Za.positionToIndex(da),Wa).reverse().find(function(Sa){return"Identifier"===Sa.type});if(!Zb)return Za.showError(Error("no identifier found!")),$c.return(!0);M=Zb.name}U=Za.pluginFind(function(Sa){return Sa.isJSEditorPlugin}).sanatizedJsEnv();Oc='lively.modules.module("'+U.targetModule+'").undefine("'+M+'")';$c.setCatchFinallyBlocks(2);return $c.yield(Za.doEval(null,U,Oc),4);case 4:Ub=
$c.yieldResult;vb=Ub.error?Ub.error:Ub.isError?Ub.value:null;$c.leaveTryBlock(3);break;case 2:vb=pd=$c.enterCatchBlock();case 3:return vb?Za.showError(vb):Za.setStatusMessage(M+" undefined"),$c.return(!0)}})}},{name:"change doitContext",exec:function(Za){var U,va,M,da,Ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wa){if(1==Wa.nextAddress)return U=$jscomp,va=U.makeIterator,Wa.yield(Za.world().execCommand("select morph",{prompt:"select morph for doitContext",justReturn:!0,prependItems:["reset"],
filterFn:function(Zb){return!Zb.isUsedAsEpiMorph()}}),2);M=va.call(U,Wa.yieldResult);if(da=M.next().value)Ia="reset"===da,Za.doitContext=Ia?null:da,Za.setStatusMessage(Ia?"doitContext is now\n"+da:"doitContext reset");return Wa.return(!0)})}},{name:"change eval backend",exec:function(Za,U){U=void 0===U?{backend:void 0}:U;var va,M;return $jscomp.asyncExecutePromiseGeneratorProgram(function(da){if(1==da.nextAddress)return va=U,M=va.backend,void 0!==M?da.jumpTo(2):da.yield(Za.world().prompt("choose eval backend",
{historyId:"js-eval-backend-history"}),3);if(2!=da.nextAddress&&(M=da.yieldResult,!M))return Za.setStatusMessage("Canceled"),da.return(!0);"local"===M&&(M=null);Za.setStatusMessage("Eval backend is now "+(M||"local"));return da.return(Oa.setEvalEnv(Za,{remote:M}))})}},{name:"copy current module name to clipboard",exec:function(Za){var U=Za.evalEnvironment.targetModule;Za.setStatusMessage(U||"Cannot find module name");Za.env.eventDispatcher.killRing.add(Za);Za.env.eventDispatcher.doCopy(U);return!0}}];
Oa.jsEditorCommands=Aa;Oa.jsEditorCommands=Aa;Oa.jsEditorCommands=Aa;var wb=[{name:"[javascript] list errors and warnings",exec:function(Za){var U,va,M,da,Ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wa){if(1==Wa.nextAddress){U=(Za.markers||[]).filter(function(Zb){Zb=Zb.type;return"js-undeclared-var"===Zb||"js-syntax-error"===Zb});if(!U.length)return Oa.show("no warnings or errors"),Wa.return(!0);va=U.map(function(Zb){var Oc=Zb.range;return{isListItem:!0,string:"["+Zb.type.split("-").slice(1).join(" ")+
"] "+Za.textInRange(Oc),value:Oc}});return Wa.yield(Za.world().filterableListPrompt("jump to warning or error",va),2)}M=Wa.yieldResult;da=$jscomp.makeIterator(M.selected);if(Ia=da.next().value)Za.saveMark(),Za.selection=Ia,Za.centerRow(Ia.start.row);return Wa.return(!0)})}},{name:"[javascript] inject import",exec:function(Za,U){U=void 0===U?{gotoImport:!1,insertImportAtCursor:!0}:U;var va,M,da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){switch(Ia.nextAddress){case 1:return Ia.yield(Oa.promise.delay(0),
2);case 2:return Ia.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return va=Ia.yieldResult,M=va.interactivelyInjectImportIntoText,Ia.yield(M(Za,U),4);case 4:return(da=Ia.yieldResult)||Za.setStatusMessage("canceled"),Ia.return(da)}})}},{name:"[javascript] fix undeclared variables",exec:function(Za,U){U=void 0===U?{ignore:[],autoApplyIfSingleChoice:!1,requester:Za}:U;var va,M,da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){if(1==Ia.nextAddress)return Ia.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=Ia.nextAddress)return va=Ia.yieldResult,M=va.interactivlyFixUndeclaredVariables,Ia.yield(M(Za,U),3);da=Ia.yieldResult;Za.focus();return Ia.return(da)})}},{name:"[javascript] remove unused imports",exec:function(Za,U){U=void 0===U?{query:!0}:U;var va,M,da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){if(1==Ia.nextAddress)return Ia.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=Ia.nextAddress)return va=Ia.yieldResult,M=va.cleanupUnusedImports,Ia.yield(M(Za,
U),3);da=Ia.yieldResult;Za.setStatusMessage(da);return Ia.return(!0)})}},{name:"[javascript] eslint report",exec:function(Za){var U,va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){if(1==M.nextAddress)return M.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);U=M.yieldResult;va=U.default;try{return M.return(va.reportOnMorph(Za))}catch(da){Za.showError(da)}M.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(Za){var U,va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){if(1==
M.nextAddress)return M.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);U=M.yieldResult;va=U.default;try{return M.return(va.previewFixesOnMorph(Za))}catch(da){Za.showError(da)}M.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(Za,U,va){function M(ab,zc){zc||(zc=Ub(ab,{allowReturnOutsideFunction:!0}));var Fc=Oa.string.lineRanges(ab),Xa=ab.split("\n"),db=[],hb=new Oa.BaseVisitor,Rc=hb.visitVariableDeclaration;hb.visitVariableDeclaration=function(Id,
Pc,Jd){if(1<Id.declarations.length)for(var fa=Oa.string.findLineWithIndexInLineRanges(Fc,Id.start),Qa=Id.declarations[0].start-Fc[fa][0],Ja={},bb=1;bb<Id.declarations.length;Ja={$jscomp$loop$prop$actionType$2609:Ja.$jscomp$loop$prop$actionType$2609,$jscomp$loop$prop$arg$2610:Ja.$jscomp$loop$prop$arg$2610},bb++){var H=Id.declarations[bb],aa=Oa.string.findLineWithIndexInLineRanges(Fc,H.start);if(fa!==aa){var Ma=Xa[aa].match(/\s*/)[0].length;Ma=Qa-Ma;0!==Ma&&(H=Oa.string.findLineWithIndexInLineRanges(Fc,
H.end),Ja.$jscomp$loop$prop$actionType$2609=0<Ma?"insert":"delete",Ja.$jscomp$loop$prop$arg$2610=0<Ma?" ".repeat(Ma):-Ma,db.push.apply(db,$jscomp.arrayFromIterable(Oa.arr.range(aa,H).map(function(tb){return function(Lb){return[tb.$jscomp$loop$prop$actionType$2609,Fc[Lb][0],tb.$jscomp$loop$prop$arg$2610]}}(Ja)))))}}return Rc.call(hb,Id,Pc,Jd)};hb.accept(zc,{},[]);for(zc=db.length;zc--;){var qd=$jscomp.makeIterator(db[zc]),Xd=qd.next().value,hc=qd.next().value;qd=qd.next().value;"insert"===Xd?ab=ab.slice(0,
hc)+qd+ab.slice(hc):"delete"===Xd&&(ab=ab.slice(0,hc)+ab.slice(hc+qd))}return ab}var da,Ia,Wa,Zb,Oc,Ub,vb,pd,$c,Sa,nb,tc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){switch(ab.nextAddress){case 1:return da=va||Math.floor(Za.width/Za.defaultCharExtent().width),U=Object.assign({printWidth:da,tabWidth:2,useTabs:!1,bracketSpacing:!1},U),Ia=lively.modules.module,Wa=System.normalizeSync("prettier/standalone.js"),ab.yield(Ia(Wa).load({format:"global",instrument:!1}),2);case 2:return Zb=
ab.yieldResult,ab.yield(Ia("lively.ast/lib/acorn-extension.js").load(),3);case 3:return ab.yield(Ia("lively.ast").load(),4);case 4:return Oc=ab.yieldResult,Ub=Oc.parse,ab.yield(Ia("lively.ast/lib/query.js").load(),5);case 5:return ab.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return vb=ab.yieldResult,pd=Za.selection.isEmpty()?Za.documentRange:Za.selection.range,$c=Za.positionToIndex(pd.start),Sa=Za.positionToIndex(pd.end),nb=Zb.format(Za.textString,Object.assign({},
U,{rangeStart:$c,rangeEnd:Sa,parser:function(zc,Fc,Xa){return Ub(zc,{allowReturnOutsideFunction:!0})}})),Za.undoManager.group(),tc=vb.diffChars(Za.textString,nb),Za.applyJsDiffPatch(tc),Za.selection.text=M(Za.selection.text),Za.undoManager.group(),ab.return(!0)}})}}];Oa.jsIdeCommands=wb;Oa.jsIdeCommands=wb;Oa.jsIdeCommands=wb;var dc=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(Za,U){U=Za.pluginInvokeFirst("getNavigator");if(!U)return!0;U=U.resolveIdentifierAt(Za,Za.cursorPosition);
if(!U||!U.id)return Oa.show("No symbol identifier selected"),!0;if(!U.decl)return Oa.show("Cannot find declaration of "+U.name),!0;Za.saveMark();Za.selection={start:Za.indexToPosition(U.decl.start),end:Za.indexToPosition(U.decl.end)};Za.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(Za){Za.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",readOnly:!0,
multiSelectAction:"single",exec:function(Za){Za.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(Za,U){U=void 0===U?{direction:null}:U;var va=Za.pluginInvokeFirst("getNavigator");if(!va)return!0;va=va.resolveIdentifierAt(Za,
Za.cursorPosition);if(!va||!va.refs)return Oa.show("No symbol identifier selected"),!0;var M=Za.selection;va=va.refs.map(function(Ia){var Wa=Ia.end;return Oa.Range.fromPositions(Oa.iToP(Za,Ia.start),Oa.iToP(Za,Wa))}).concat(va.decl?Oa.Range.fromPositions(Oa.iToP(Za,va.decl.start),Oa.iToP(Za,va.decl.end)):[]).sort(Oa.Range.compare);if(!va.length)return!0;var da=va.map(String).indexOf(String(M.range));if("next"===U.direction||"prev"===U.direction)-1===da&&va.length?va=[va[0]]:(U=da+("next"===U.direction?
1:-1),0>U?U=va.length-1:U>=va.length&&(U=0),va=[va[U]]);va.forEach(function(Ia){var Wa=M.selections.findIndex(function(Oc){return Oc.range.equals(Ia)}),Zb=M.selections.length-1;-1<Wa?Oa.arr.swap(M.selections,Wa,Zb):M.addRange(Ia,!1)});M.mergeSelections();return!0}}];Oa.astEditorCommands=dc;Oa.astEditorCommands=dc;Oa.astEditorCommands=dc;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var Ya=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
Ya.expressionAllowed=function(Za,U,va){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(U.lastType)||"quasi"==U.lastType&&/\{\s*$/.test(Za.string.slice(0,Za.pos-(va||0)))};Ya.passIndent=pc;Ya.defineMode=ld;Ya.defineMIME=Rb;Ya.registerHelper=xd;Ya.defaultConfig={indentUnit:2};Ya.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};Ya.defineMode("javascript",
function(Za,U){function va(zb,Bb,Gd){Yj=zb;th=Gd;return Bb}function M(zb,Bb){var Gd=zb.next();if('"'==Gd||"'"==Gd)return Bb.tokenize=da(Gd),Bb.tokenize(zb,Bb);if("."==Gd&&zb.match(/^\d+(?:[eE][+\-]?\d+)?/))return va("number","number");if("."==Gd&&zb.match(".."))return va("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(Gd))return va(Gd);if("="==Gd&&zb.eat(">"))return va("=>","operator");if("0"==Gd&&zb.eat(/x/i))return zb.eatWhile(/[\da-f]/i),va("number","number");if("0"==Gd&&zb.eat(/o/i))return zb.eatWhile(/[0-7]/i),
va("number","number");if("0"==Gd&&zb.eat(/b/i))return zb.eatWhile(/[01]/i),va("number","number");if(/\d/.test(Gd))return zb.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),va("number","number");if("/"==Gd){if(zb.eat("*"))return Bb.tokenize=Ia,Ia(zb,Bb);if(zb.eat("/"))return zb.skipToEnd(),va("comment","comment");if(Ya.expressionAllowed(zb,Bb,1)){a:for(var Bd=Bb=!1;null!=(Gd=zb.next());){if(!Bb){if("/"==Gd&&!Bd)break a;"["==Gd?Bd=!0:Bd&&"]"==Gd&&(Bd=!1)}Bb=!Bb&&"\\"==Gd}zb.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return va("regexp","string-2")}zb.eatWhile(il);return va("operator","operator",zb.current())}if("`"==Gd)return Bb.tokenize=Wa,Wa(zb,Bb);if("#"==Gd)return zb.skipToEnd(),va("error","error");if(il.test(Gd))return">"==Gd&&Bb.lexical&&">"==Bb.lexical.type||zb.eatWhile(il),va("operator","operator",zb.current());if(Wj.test(Gd))return zb.eatWhile(Wj),zb=zb.current(),(Gd=Bk.propertyIsEnumerable(zb)&&Bk[zb])&&"."!=Bb.lastType?va(Gd.type,Gd.style,zb):va("variable","variable",zb)}function da(zb){return function(Bb,
Gd){var Bd=!1,of;if(zh&&"@"==Bb.peek()&&Bb.match(kk))return Gd.tokenize=M,va("jsonld-keyword","meta");for(;null!=(of=Bb.next())&&(of!=zb||Bd);)Bd=!Bd&&"\\"==of;Bd||(Gd.tokenize=M);return va("string","string")}}function Ia(zb,Bb){for(var Gd=!1,Bd;Bd=zb.next();){if("/"==Bd&&Gd){Bb.tokenize=M;break}Gd="*"==Bd}return va("comment","comment")}function Wa(zb,Bb){for(var Gd=!1,Bd;null!=(Bd=zb.next());){if(!Gd&&("`"==Bd||"$"==Bd&&zb.eat("{"))){Bb.tokenize=M;break}Gd=!Gd&&"\\"==Bd}return va("quasi","string-2",
zb.current())}function Zb(zb,Bb){Bb.fatArrowAt&&(Bb.fatArrowAt=null);var Gd=zb.string.indexOf("=>",zb.start);if(!(0>Gd)){if(Cj){var Bd=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(zb.string.slice(zb.start,Gd));Bd&&(Gd=Bd.index)}Bd=0;var of=!1;for(--Gd;0<=Gd;--Gd){var Uf=zb.string.charAt(Gd),si="([{}])".indexOf(Uf);if(0<=si&&3>si){if(!Bd){++Gd;break}if(0==--Bd){"("==Uf&&(of=!0);break}}else if(3<=si&&6>si)++Bd;else if(Wj.test(Uf))of=!0;else{if(/["'\/]/.test(Uf))return;if(of&&!Bd){++Gd;break}}}of&&
!Bd&&(Bb.fatArrowAt=Gd)}}function Oc(zb,Bb,Gd,Bd,of,Uf){this.indented=zb;this.column=Bb;this.type=Gd;this.prev=of;this.info=Uf;null!=Bd&&(this.align=Bd)}function Ub(){for(var zb=arguments.length-1;0<=zb;zb--)Le.cc.push(arguments[zb])}function vb(){Ub.apply(null,arguments);return!0}function pd(zb){function Bb(Bd){for(;Bd;Bd=Bd.next)if(Bd.name==zb)return!0;return!1}var Gd=Le.state;Le.marked="def";Gd.context?Bb(Gd.localVars)||(Gd.localVars={name:zb,next:Gd.localVars}):!Bb(Gd.globalVars)&&U.globalVars&&
(Gd.globalVars={name:zb,next:Gd.globalVars})}function $c(){Le.state.context={prev:Le.state.context,vars:Le.state.localVars};Le.state.localVars=Om}function Sa(){Le.state.localVars=Le.state.context.vars;Le.state.context=Le.state.context.prev}function nb(zb,Bb){var Gd=function(){var Bd=Le.state,of=Bd.indented;if("stat"==Bd.lexical.type)of=Bd.lexical.indented;else for(var Uf=Bd.lexical;Uf&&")"==Uf.type&&Uf.align;Uf=Uf.prev)of=Uf.indented;Bd.lexical=new Oc(of,Le.stream.column(),zb,null,Bd.lexical,Bb)};
Gd.lex=!0;return Gd}function tc(){var zb=Le.state;zb.lexical.prev&&(")"==zb.lexical.type&&(zb.indented=zb.lexical.indented),zb.lexical=zb.lexical.prev)}function ab(zb){function Bb(Gd){return Gd==zb?vb():";"==zb?Ub():vb(Bb)}return Bb}function zc(zb,Bb){return"var"==zb?vb(nb("vardef",Bb.length),Db,ab(";"),tc):"keyword a"==zb?vb(nb("form"),db,zc,tc):"keyword b"==zb?vb(nb("form"),zc,tc):"{"==zb?vb(nb("}"),yd,tc):";"==zb?vb():"if"==zb?("else"==Le.state.lexical.info&&Le.state.cc[Le.state.cc.length-1]==
tc&&Le.state.cc.pop()(),vb(nb("form"),db,zc,tc,ua)):"function"==zb?vb(gb):"for"==zb?vb(nb("form"),Ha,zc,tc):"variable"==zb?Cj&&"type"==Bb?(Le.marked="keyword",vb(Fd,ab("operator"),Fd,ab(";"))):vb(nb("stat"),H):"switch"==zb?vb(nb("form"),db,ab("{"),nb("}","switch"),yd,tc,tc):"case"==zb?vb(Fc,ab(":")):"default"==zb?vb(ab(":")):"catch"==zb?vb(nb("form"),$c,ab("("),ec,ab(")"),zc,tc,Sa):"class"==zb?vb(nb("form"),Ec,tc):"export"==zb?vb(nb("stat"),nf,tc):"import"==zb?vb(nb("stat"),Bg,tc):"module"==zb?vb(nb("form"),
Lf,ab("{"),nb("}"),yd,tc,tc):"async"==zb?vb(zc):"@"==Bb?vb(Fc,zc):Ub(nb("stat"),Fc,ab(";"),tc)}function Fc(zb){return hb(zb,!1)}function Xa(zb){return hb(zb,!0)}function db(zb){return"("!=zb?Ub():vb(nb(")"),Fc,ab(")"),tc)}function hb(zb,Bb){if(Le.state.fatArrowAt==Le.stream.start){var Gd=Bb?fa:Jd;if("("==zb)return vb($c,nb(")"),uc(Lf,")"),tc,ab("=>"),Gd,Sa);if("variable"==zb)return Ub($c,Lf,ab("=>"),Gd,Sa)}Gd=Bb?hc:Xd;return Nm.hasOwnProperty(zb)?vb(Gd):"function"==zb?vb(gb,Gd):"class"==zb?vb(nb("form"),
ac,tc):"keyword c"==zb||"async"==zb?vb(Bb?qd:Rc):"("==zb?vb(nb(")"),Rc,ab(")"),tc,Gd):"operator"==zb||"spread"==zb?vb(Bb?Xa:Fc):"["==zb?vb(nb("]"),Zj,tc,Gd):"{"==zb?hd(Ma,"}",null,Gd):"quasi"==zb?Ub(Id,Gd):"new"==zb?vb(Qa(Bb)):vb()}function Rc(zb){return zb.match(/[;\}\)\],]/)?Ub():Ub(Fc)}function qd(zb){return zb.match(/[;\}\)\],]/)?Ub():Ub(Xa)}function Xd(zb,Bb){return","==zb?vb(Fc):hc(zb,Bb,!1)}function hc(zb,Bb,Gd){var Bd=0==Gd?Xd:hc,of=0==Gd?Fc:Xa;if("=>"==zb)return vb($c,Gd?fa:Jd,Sa);if("operator"==
zb)return/\+\+|--/.test(Bb)?vb(Bd):"?"==Bb?vb(Fc,ab(":"),of):vb(of);if("quasi"==zb)return Ub(Id,Bd);if(";"!=zb){if("("==zb)return hd(Xa,")","call",Bd);if("."==zb)return vb(aa,Bd);if("["==zb)return vb(nb("]"),Rc,ab("]"),tc,Bd)}}function Id(zb,Bb){return"quasi"!=zb?Ub():"${"!=Bb.slice(Bb.length-2)?vb(Id):vb(Fc,Pc)}function Pc(zb){if("}"==zb)return Le.marked="string-2",Le.state.tokenize=Wa,vb(Id)}function Jd(zb){Zb(Le.stream,Le.state);return Ub("{"==zb?zc:Fc)}function fa(zb){Zb(Le.stream,Le.state);return Ub("{"==
zb?zc:Xa)}function Qa(zb){return function(Bb){return"."==Bb?vb(zb?bb:Ja):Ub(zb?Xa:Fc)}}function Ja(zb,Bb){if("target"==Bb)return Le.marked="keyword",vb(Xd)}function bb(zb,Bb){if("target"==Bb)return Le.marked="keyword",vb(hc)}function H(zb){return":"==zb?vb(tc,zc):Ub(Xd,ab(";"),tc)}function aa(zb){if("variable"==zb)return Le.marked="property",vb()}function Ma(zb,Bb){if("async"==zb)return Le.marked="property",vb(Ma);if("variable"==zb||"keyword"==Le.style)return Le.marked="property","get"==Bb||"set"==
Bb?vb(tb):vb(Lb);if("number"==zb||"string"==zb)return Le.marked=zh?"property":Le.style+" property",vb(Lb);if("jsonld-keyword"==zb)return vb(Lb);if("modifier"==zb)return vb(Ma);if("["==zb)return vb(Fc,ab("]"),Lb);if("spread"==zb)return vb(Fc);if(":"==zb)return Ub(Lb)}function tb(zb){if("variable"!=zb)return Ub(Lb);Le.marked="property";return vb(gb)}function Lb(zb){if(":"==zb)return vb(Xa);if("("==zb)return Ub(gb)}function uc(zb,Bb,Gd){function Bd(of,Uf){return(Gd?-1<Gd.indexOf(of):","==of)?(of=Le.state.lexical,
"call"==of.info&&(of.pos=(of.pos||0)+1),vb(function(si,Ql){return si==Bb||Ql==Bb?Ub():Ub(zb)},Bd)):of==Bb||Uf==Bb?vb():vb(ab(Bb))}return function(of,Uf){return of==Bb||Uf==Bb?vb():Ub(zb,Bd)}}function hd(zb,Bb,Gd){for(var Bd=3;Bd<arguments.length;Bd++)Le.cc.push(arguments[Bd]);return vb(nb(Bb,Gd),uc(zb,Bb),tc)}function yd(zb){return"}"==zb?vb():Ub(zc,yd)}function Jc(zb,Bb){if(Cj){if(":"==zb)return vb(Fd);if("?"==Bb)return vb(Jc)}}function Fd(zb){if("variable"==zb)return Le.marked="variable-3",vb(Ye);
if("string"==zb||"number"==zb||"atom"==zb)return vb(Ye);if("{"==zb)return vb(nb("}"),uc(ie,"}",",;"),tc);if("("==zb)return vb(uc(ue,")"),Yd)}function Yd(zb){if("=>"==zb)return vb(Fd)}function ie(zb,Bb){if("variable"==zb||"keyword"==Le.style)return Le.marked="property",vb(ie);if("?"==Bb)return vb(ie);if(":"==zb)return vb(Fd)}function ue(zb){if("variable"==zb)return vb(ue);if(":"==zb)return vb(Fd)}function Ye(zb,Bb){if("<"==Bb)return vb(nb(">"),uc(Fd,">"),tc,Ye);if("|"==Bb||"."==zb)return vb(Fd);if("["==
zb)return vb(ab("]"),Ye);if("extends"==Bb)return vb(Fd)}function Db(){return Ub(Lf,Jc,tf,he)}function Lf(zb,Bb){if("modifier"==zb)return vb(Lf);if("variable"==zb)return pd(Bb),vb();if("spread"==zb)return vb(Lf);if("["==zb)return hd(Lf,"]");if("{"==zb)return hd(me,"}")}function me(zb,Bb){if("variable"==zb&&!Le.stream.match(/^\s*:/,!1))return pd(Bb),vb(tf);"variable"==zb&&(Le.marked="property");return"spread"==zb?vb(Lf):"}"==zb?Ub():vb(ab(":"),Lf,tf)}function tf(zb,Bb){if("="==Bb)return vb(Xa)}function he(zb){if(","==
zb)return vb(Db)}function ua(zb,Bb){if("keyword b"==zb&&"else"==Bb)return vb(nb("form","else"),zc,tc)}function Ha(zb){if("("==zb)return vb(nb(")"),pb,ab(")"),tc)}function pb(zb){return"var"==zb?vb(Db,ab(";"),pa):";"==zb?vb(pa):"variable"==zb?vb(R):Ub(Fc,ab(";"),pa)}function R(zb,Bb){return"in"==Bb||"of"==Bb?(Le.marked="keyword",vb(Fc)):vb(Xd,pa)}function pa(zb,Bb){return";"==zb?vb(Va):"in"==Bb||"of"==Bb?(Le.marked="keyword",vb(Fc)):Ub(Fc,ab(";"),Va)}function Va(zb){")"!=zb&&vb(Fc)}function gb(zb,
Bb){if("*"==Bb)return Le.marked="keyword",vb(gb);if("variable"==zb)return pd(Bb),vb(gb);if("("==zb)return vb($c,nb(")"),uc(ec,")"),tc,Jc,zc,Sa);if(Cj&&"<"==Bb)return vb(nb(">"),uc(Fd,">"),tc,gb)}function ec(zb){return"spread"==zb?vb(ec):Ub(Lf,Jc,tf)}function ac(zb,Bb){return"variable"==zb?Ec(zb,Bb):Mc(zb,Bb)}function Ec(zb,Bb){if("variable"==zb)return pd(Bb),vb(Mc)}function Mc(zb,Bb){if("<"==Bb)return vb(nb(">"),uc(Fd,">"),tc,Mc);if("extends"==Bb||"implements"==Bb||Cj&&","==zb)return vb(Cj?Fd:Fc,
Mc);if("{"==zb)return vb(nb("}"),xc,tc)}function xc(zb,Bb){if("variable"==zb||"keyword"==Le.style){if(("async"==Bb||"static"==Bb||"get"==Bb||"set"==Bb||Cj&&("public"==Bb||"private"==Bb||"protected"==Bb||"readonly"==Bb||"abstract"==Bb))&&Le.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Le.marked="keyword",vb(xc);Le.marked="property";return vb(Cj?ze:gb,xc)}if("["==zb)return vb(Fc,ab("]"),Cj?ze:gb,xc);if("*"==Bb)return Le.marked="keyword",vb(xc);if(";"==zb)return vb(xc);if("}"==zb)return vb();if("@"==
Bb)return vb(Fc,xc)}function ze(zb,Bb){return"?"==Bb?vb(ze):":"==zb?vb(Fd,tf):"="==Bb?vb(Xa):Ub(gb)}function nf(zb,Bb){return"*"==Bb?(Le.marked="keyword",vb(Tg,ab(";"))):"default"==Bb?(Le.marked="keyword",vb(Fc,ab(";"))):"{"==zb?vb(uc(bf,"}"),Tg,ab(";")):Ub(zc)}function bf(zb,Bb){if("as"==Bb)return Le.marked="keyword",vb(ab("variable"));if("variable"==zb)return Ub(Xa,bf)}function Bg(zb){return"string"==zb?vb():Ub(Me,sg,Tg)}function Me(zb,Bb){if("{"==zb)return hd(Me,"}");"variable"==zb&&pd(Bb);"*"==
Bb&&(Le.marked="keyword");return vb(Gi)}function sg(zb){if(","==zb)return vb(Me,sg)}function Gi(zb,Bb){if("as"==Bb)return Le.marked="keyword",vb(Me)}function Tg(zb,Bb){if("from"==Bb)return Le.marked="keyword",vb(Fc)}function Zj(zb){return"]"==zb?vb():Ub(uc(Xa,"]"))}Za=Object.assign({},Ya.defaultConfig,{},Za);U=Object.assign({},Ya.defaultParserConfig,{},U);var zf=Za.indentUnit,yi=U.statementIndent,zh=U.jsonld,lj=U.json||zh,Cj=U.typescript,Wj=U.wordCharacters||/[\w$\xa1-\uffff]/,Bk=function(){function zb(Ql){return{type:Ql,
style:"keyword"}}var Bb=zb("keyword a"),Gd=zb("keyword b"),Bd=zb("keyword c"),of=zb("operator"),Uf={type:"atom",style:"atom"};Bb={if:zb("if"),while:Bb,with:Bb,else:Gd,do:Gd,try:Gd,finally:Gd,return:Bd,break:Bd,continue:Bd,new:zb("new"),delete:Bd,throw:Bd,debugger:Bd,var:zb("var"),const:zb("var"),let:zb("var"),function:zb("function"),catch:zb("catch"),for:zb("for"),switch:zb("switch"),case:zb("case"),default:zb("default"),in:of,typeof:of,instanceof:of,true:Uf,false:Uf,null:Uf,undefined:Uf,NaN:Uf,Infinity:Uf,
this:zb("this"),class:zb("class"),super:zb("atom"),yield:Bd,export:zb("export"),import:zb("import"),extends:Bd,await:Bd,async:zb("async")};if(Cj){Gd={type:"variable",style:"variable-3"};Bd={interface:zb("class"),implements:Bd,namespace:Bd,module:zb("module"),enum:zb("module"),public:zb("modifier"),private:zb("modifier"),protected:zb("modifier"),abstract:zb("modifier"),as:of,string:Gd,number:Gd,boolean:Gd,any:Gd};for(var si in Bd)Bb[si]=Bd[si]}return Bb}(),il=/[+\-*&%=<>!?|~^@]/,kk=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
Yj,th,Nm={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Le={state:null,column:null,marked:null,cc:null},Om={name:"this",next:{name:"arguments"}};tc.lex=!0;return{startState:function(zb){zb={tokenize:M,lastType:"sof",cc:[],lexical:new Oc((zb||0)-zf,0,"block",!1),localVars:U.localVars,context:U.localVars&&{vars:U.localVars},indented:zb||0};U.globalVars&&"object"===typeof U.globalVars&&(zb.globalVars=U.globalVars);return zb},token:function(zb,Bb){zb.sol()&&(Bb.lexical.hasOwnProperty("align")||
(Bb.lexical.align=!1),Bb.indented=zb.indentation(),Zb(zb,Bb));if(Bb.tokenize!=Ia&&zb.eatSpace())return null;var Gd=Bb.tokenize(zb,Bb);if("comment"==Yj)return Gd;Bb.lastType="operator"!=Yj||"++"!=th&&"--"!=th?Yj:"incdec";a:{var Bd=Yj,of=th,Uf=Bb.cc;Le.state=Bb;Le.stream=zb;Le.marked=null;Le.cc=Uf;Le.style=Gd;Bb.lexical.hasOwnProperty("align")||(Bb.lexical.align=!0);for(zb=0;;){if(1E5<zb++)throw Error("endless");if((Uf.length?Uf.pop():lj?Fc:zc)(Bd,of)){for(;Uf.length&&Uf[Uf.length-1].lex;)Uf.pop()();
if(Le.marked){Gd=Le.marked;break a}if(Bd="variable"==Bd)b:{for(Bd=Bb.localVars;Bd;Bd=Bd.next)if(Bd.name==of){Bd=!0;break b}for(Bb=Bb.context;Bb;Bb=Bb.prev)for(Bd=Bb.vars;Bd;Bd=Bd.next)if(Bd.name==of){Bd=!0;break b}Bd=void 0}if(Bd){Gd="variable-2";break a}break a}}}return Gd},indent:function(zb,Bb){if(zb.tokenize==Ia)return Ya.passIndent;if(zb.tokenize!=M)return 0;var Gd=Bb&&Bb.charAt(0),Bd=zb.lexical,of;if(!/^\s*else\b/.test(Bb))for(var Uf=zb.cc.length-1;0<=Uf;--Uf){var si=zb.cc[Uf];if(si==tc)Bd=
Bd.prev;else if(si!=ua)break}for(;!("stat"!=Bd.type&&"form"!=Bd.type||"}"!=Gd&&(!(of=zb.cc[zb.cc.length-1])||of!=Xd&&of!=hc||/^[,\.=+\-*:?[\(]/.test(Bb)));)Bd=Bd.prev;yi&&")"==Bd.type&&"stat"==Bd.prev.type&&(Bd=Bd.prev);of=Bd.type;Uf=Gd==of;return(si=zb._string)&&si.trimLeft().startsWith("?")&&":"===Gd?si.indexOf("?"):si&&":"===zb.lastType&&"}"!==Bd.type?si.match(/^\s*/)[0].length:"vardef"==of?(Bb=Bd.indented+Bd.info+2+zb.localVars.name.length,"?"===Gd||":"===Gd||"|"===Gd||"&"===Gd?Bb:","==zb.lastType?
Bd.indented+Bd.info+1:"operator"==zb.lastType?Bb+3:Bd.indented):"form"==of&&"{"==Gd?Bd.indented:"form"==of?Bd.indented+zf:"stat"==of?(Gd=Bd.indented,zb="operator"==zb.lastType||","==zb.lastType||il.test(Bb.charAt(0))||/[,.]/.test(Bb.charAt(0)),Gd+(zb?yi||zf:0)):"switch"!=Bd.info||Uf||0==U.doubleIndentSwitch?Bd.align?Bd.column+(Uf?0:1):Bd.indented+(Uf?0:zf):Bd.indented+(/^(?:case|default)\b/.test(Bb)?zf:2*zf)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:lj?null:"/*",blockCommentEnd:lj?
null:"*/",lineComment:lj?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:lj?"json":"javascript",jsonldMode:zh,jsonMode:lj,expressionAllowed:Ya.expressionAllowed,skipExpression:function(zb){var Bb=zb.cc[zb.cc.length-1];Bb!=Fc&&Bb!=Xa||zb.cc.pop()}}});Ya.registerHelper("wordChars","javascript",/[\w$]/);Ya.defineMIME("text/javascript","javascript");Ya.defineMIME("text/ecmascript","javascript");Ya.defineMIME("application/javascript","javascript");Ya.defineMIME("application/x-javascript",
"javascript");Ya.defineMIME("application/ecmascript","javascript");Ya.defineMIME("application/json",{name:"javascript",json:!0});Ya.defineMIME("application/x-json",{name:"javascript",json:!0});Ya.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});Ya.defineMIME("text/typescript",{name:"javascript",typescript:!0});Ya.defineMIME("application/typescript",{name:"javascript",typescript:!0});var jb=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");jb.string=wc;jb.JavaScriptChecker=
bd;jb.JavaScriptNavigator=dd;jb.completers=ya;jb.jsSnippets=xa;jb.jsIdeCommands=wb;jb.jsEditorCommands=Aa;jb.astEditorCommands=dc;jb.CodeMirrorEnabledEditorPlugin=Hd;jb.Snippet=$a;jb.parser=ce;jb.localInterface=Dc;jb.systemInterfaceNamed=bc;jb.serverInterfaceFor=Ib;jb.l2lInterfaceFor=gc;bd=function(Za){var U=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),va=U.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof U.JavaScriptEditorPlugin?U.JavaScriptEditorPlugin:U.JavaScriptEditorPlugin=
function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(va,Za,[{key:Symbol.for("lively-instance-initialize"),value:function(){cb._get(Object.getPrototypeOf(va.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new jb.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(M){cb._get(Object.getPrototypeOf(va.prototype),"attach",this).call(this,M);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:M})}},{key:"detach",value:function(M){this.checker.uninstall(this.textMorph);cb._get(Object.getPrototypeOf(va.prototype),"detach",this).call(this,M)}},{key:"getNavigator",value:function(){return new jb.JavaScriptNavigator}},{key:"getCompleters",value:function(M){return jb.completers.concat(M)}},
{key:"getCommands",value:function(M){return[].concat($jscomp.arrayFromIterable(cb._get(Object.getPrototypeOf(va.prototype),"getCommands",this).call(this,M)),$jscomp.arrayFromIterable(jb.jsIdeCommands),$jscomp.arrayFromIterable(jb.jsEditorCommands),$jscomp.arrayFromIterable(jb.astEditorCommands))}},{key:"getKeyBindings",value:function(M){return[].concat($jscomp.arrayFromIterable(M),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(M){var da=this,Ia,Wa,Zb,Oc,Ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vb){Ia=da.textMorph;Wa=[{command:"doit",target:Ia,showKeyShortcuts:!0},{command:"inspectit",target:Ia,showKeyShortcuts:!0},{command:"editit",target:Ia,showKeyShortcuts:!0},{command:"printit",target:Ia,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:Ia,showKeyShortcuts:!0},{command:"eval all",target:Ia,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:Ia,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:Ia,showKeyShortcuts:!0},{isDivider:!0}];da.evalEnvironment.targetModule&&Wa.push({command:"[javascript] inject import",alias:"add import",target:Ia},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:Ia},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:Ia});Zb=da.getNavigator();(Oc=Zb.resolveIdentifierAt(Ia,
Ia.cursorPosition))&&Wa.push({command:"selectDefinition",alias:'jump to definition of "'+Oc.name+'"',target:Ia},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+Oc.name+'"',target:Ia});(Ub=Ia.selection.text.trim())&&Wa.push({command:"open code search",alias:'code search for "'+jb.string.truncate(Ub,30)+'"',target:Ia.world(),args:{input:Ub,backend:da.backend()}});Wa.push({isDivider:!0});return vb.return(Wa.concat(M))})}},{key:"getSnippets",value:function(){return jb.jsSnippets.map(function(M){var da=
$jscomp.makeIterator(M);M=da.next().value;da=da.next().value;return new jb.Snippet({trigger:M,expansion:da})})}},{key:"sanatizedJsEnv",value:function(M){M=Object.assign({},this.evalEnvironment,{},M);M.format||(M.formatd="esm");M.context||(M.context=this.textMorph);M.sourceURL||(M.sourceURL=M.targetModule+"_doit_"+Date.now());M.systemInterface||(M.systemInterface=jb.localInterface);return M}},{key:"backend",value:function(M){M=this.sanatizedJsEnv(M);return M.remote?M.remote:"local"}},{key:"systemInterface",
value:function(M){return this.sanatizedJsEnv(M).systemInterface||jb.localInterface}},{key:"setSystemInterface",value:function(M){return this.evalEnvironment.systemInterface=M}},{key:"setSystemInterfaceNamed",value:function(M){return this.setSystemInterface(jb.systemInterfaceNamed(M))}},{key:"runEval",value:function(M,da){da=this.sanatizedJsEnv(da);return this.systemInterface(da).runEval(M,da)}},{key:"parser",get:function(){return jb.parser}},{key:"parse",value:function(M){M=void 0===M?null:M;if(this._ast&&
this._ast._astType===M)return this._ast;var da=this.parser,Ia=this.textMorph.textString;if(!da)return null;var Wa={withComments:!0,allowReturnOutsideFunction:!0};M&&(Wa.type=M);if(Ia.startsWith("#!")){var Zb=Ia.indexOf("\n");Ia=" ".repeat(Zb)+Ia.slice(Zb)}da=da.fuzzyParse(Ia,Wa);da._astType=M;return this._ast=da}},{key:"undeclaredVariables",value:function(M){var da=this.parser,Ia=this.evalEnvironment.knownGlobals||[];M=this.parse(void 0===M?null:M);return da&&M?da.query.findGlobalVarRefs(M,{jslintGlobalComment:!0}).filter(function(Wa){return!Ia.includes(Wa.name)}):
[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],U,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(jb.CodeMirrorEnabledEditorPlugin);bd=jb.JavaScriptEditorPlugin;ta("default",bd);jb.default=bd}}});
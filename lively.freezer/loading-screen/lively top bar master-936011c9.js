System.register(["./__root_module__-19078926.js","./user-ui-3de50906.js","./index-879c50c1.js"],function(ya,wb){var Ab,ac,Ob,kd,Cc,qd,Dc,Ic;return{setters:[function(Qc){Ab=Qc.an;ac=Qc.as;Ob=Qc.a3;kd=Qc.C;Cc=Qc.a6;qd=Qc.L;Dc=Qc.r;Ic=Qc.aw},function(){},function(){}],execute:function(){var Qc=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");Qc.Morph=Ab;Qc.Icon=ac;Qc.pt=Ob;Qc.Color=kd;Qc.arr=Cc;Qc.LoadingIndicator=qd;Qc.resource=Dc;var Bd=function(ne){var ve=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),
Wd=ve.hasOwnProperty("LivelyTopBar")&&"function"===typeof ve.LivelyTopBar?ve.LivelyTopBar:ve.LivelyTopBar=function(Ub){Ub&&Ub[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ic(Wd,ne,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode="Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var Ub=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){if(1==wc.nextAddress)return Ub.isComponent?
wc.return():wc.yield(Ub.whenRendered(),2);document.body.style.background="black";Ub.setEditMode("Halo");Ub.getSubmorphNamed("fast load toggler").refresh();wc.jumpToEnd()})}},{key:"onUserChanged",value:function(Ub){this.getSubmorphNamed("user flap").onUserChanged(Ub)}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=Qc.pt(0,0));var Ub=this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;Ub.right=
this.width-10}},{key:"getShapeMenuItems",value:function(){var Ub=this;return Object.entries(this.shapeToIcon).map(function(wc){wc=$jscomp.makeIterator(wc);var od=wc.next().value,Tb=wc.next().value;wc=Tb.shortcut;Tb=Tb.args;return[[].concat($jscomp.arrayFromIterable(Ub.currentShapeMode===od?[].concat($jscomp.arrayFromIterable(Qc.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(Qc.Icon.textAttribute.apply(Qc.Icon,$jscomp.arrayFromIterable(Tb))),
["   "+od+" ",{float:"none"},"      "+wc,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){Ub.currentShapeMode=od;Ub.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var Ub=this;return Object.entries(this.sideBarToIcon).map(function(wc){wc=$jscomp.makeIterator(wc);var od=wc.next().value;wc=wc.next().value.args;return[[].concat($jscomp.arrayFromIterable(Ub.activeSideBars.includes(od)?[].concat($jscomp.arrayFromIterable(Qc.Icon.textAttribute("check",
{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(Qc.Icon.textAttribute.apply(Qc.Icon,$jscomp.arrayFromIterable(wc))),["   "+od+" ",{float:"none"}]),function(){return Ub.openSideBar(od)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",value:function(Ub){"Hand"==this._currentEditMode&&this.setEditMode("Hand",
!0)}},{key:"onKeyDown",value:function(Ub){Ic._get(Object.getPrototypeOf(Wd.prototype),"onKeyDown",this).call(this,Ub);if(Ub.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!Ub.isAltDown()){var wc={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(Ub.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=wc[Ub.key];this.setEditMode("Shape");
break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(Ub){var wc=this,od,Tb,xd,Fd,ic,rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gb){switch(Gb.nextAddress){case 1:wc.activeSideBars.includes(Ub)?Qc.arr.remove(wc.activeSideBars,Ub):wc.activeSideBars.push(Ub);if("Scene Graph"!=Ub){Gb.jumpTo(2);break}if(wc.sideBar){Gb.jumpTo(3);break}od=Qc.LoadingIndicator.open("loading side bar");return Gb.yield(od.whenRendered(),4);case 4:return Tb=wc,Gb.yield(wb.import("./scene graph side bar master-939a8e46.js"),
6);case 6:if(!(xd=Gb.yieldResult)){Gb.jumpTo(7);break}return Gb.yield(Qc.resource("part://SystemIDE/scene graph side bar master"),8);case 8:xd=Gb.yieldResult;case 7:return Gb.yield(xd.read(),5);case 5:return Tb.sideBar=Gb.yieldResult,wc.sideBar.hasFixedPosition=!0,wc.sideBar.respondsToVisibleWindow=!0,wc.sideBar.openInWorld(),wc.sideBar.right=0,Gb.yield(wc.sideBar.whenRendered(),9);case 9:od.remove();case 3:wc.sideBar.toggle(wc.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=
Ub){Gb.jumpTo(0);break}if(wc.stylingPalette){Gb.jumpTo(11);break}Fd=Qc.LoadingIndicator.open("loading side bar");return Gb.yield(Fd.whenRendered(),12);case 12:return ic=wc,Gb.yield(wb.import("./styling side bar master-ea3a6b31.js"),14);case 14:if(!(rc=Gb.yieldResult)){Gb.jumpTo(15);break}return Gb.yield(Qc.resource("part://SystemIDE/styling side bar master"),16);case 16:rc=Gb.yieldResult;case 15:return Gb.yield(rc.read(),13);case 13:return ic.stylingPalette=Gb.yieldResult,wc.stylingPalette.collapseAll(),
wc.stylingPalette.hasFixedPosition=!0,wc.stylingPalette.respondsToVisibleWindow=!0,wc.stylingPalette.openInWorld(),wc.stylingPalette.left=wc.world().width,Gb.yield(wc.stylingPalette.whenRendered(),17);case 17:Fd.remove();case 11:wc.stylingPalette.toggle(wc.activeSideBars.includes("Styling Palette")),Gb.jumpToEnd()}})}},{key:"onMouseDown",value:function(Ub){var wc=this.get("select shape type"),od=this.get("shape mode button"),Tb=this.get("side bar selector");Ub.targetMorph==wc&&(this.world().openWorldMenu(Ub,
this.getShapeMenuItems()).position=od.globalBounds().bottomLeft().subPt(this.world().scroll));Ub.targetMorph==od&&this.setEditMode("Shape");"text mode button"==Ub.targetMorph.name&&this.setEditMode("Text");"hand mode button"==Ub.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==Ub.targetMorph.name&&this.setEditMode("Halo");"open component browser"==Ub.targetMorph.name&&this.interactivelyLoadComponent();"load world button"==Ub.targetMorph.name&&this.world().execCommand("load world");Ub.targetMorph==
Tb&&(this.world().openWorldMenu(Ub,this.getSideBarMenuItems()).position=Tb.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var Ub=this,wc,od,Tb,xd,Fd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ic){if(1==ic.nextAddress)return wc=Ub.get("open component browser"),od=Ub.get("user flap"),Tb=od.haloShadow,xd=od.haloColor,Fd=Qc.Color.rgb(102,102,102),wc.fontColor=xd,wc.dropShadow=Tb,ic.yield(Ub.world().execCommand("browse and load component"),
2);wc.dropShadow=!1;wc.fontColor=Fd;ic.jumpToEnd()})}},{key:"setEditMode",value:function(Ub,wc){var od=this;wc=void 0===wc?!1:wc;var Tb=this.get("user flap"),xd=Tb.haloShadow,Fd=Tb.haloColor,ic=Qc.Color.rgb(102,102,102);wc||(this._currentEditMode=Ub);wc=this.get("shape mode button");Tb=this.get("text mode button");var rc=this.get("hand mode button"),Gb=this.get("halo mode button");[["Shape",wc.submorphs],["Text",[Tb]],["Hand",[rc]],["Halo",[Gb]]].forEach(function(oc){var Hc=$jscomp.makeIterator(oc);
oc=Hc.next().value;Hc=Hc.next().value;"Shape"==Ub?od.world().toggleShapeMode(!0,od.currentShapeMode):"Text"==Ub?od.world().toggleShapeMode(!0,"Text"):od.world().toggleShapeMode(!1);od.world().showHaloPreviews("Halo"==Ub);oc==Ub?Hc.forEach(function(ad){ad.dropShadow=xd;ad.fontColor=Fd}):Hc.forEach(function(ad){ad.dropShadow=null;ad.fontColor=ic})})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],
set:function(Ub){this.setProperty("currentShapeMode",Ub);this.get("shape status icon").textAndAttributes=Qc.Icon.textAttribute(this.shapeToIcon[Ub].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},
Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],ve,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-157"}}},{start:328,end:9460})}(Qc.Morph);Bd=Qc.LivelyTopBar;Qc.default=Bd}}});System.register("21",["./__root_module__-19078926.js","./index-20301cd6.js","./user-ui-3de50906.js"],function(){return{setters:[function(){},function(){},function(){}],execute:function(){}}});
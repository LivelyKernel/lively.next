System.register(["./__root_module__-b4667baa.js","./index-82fc4eeb.js","./color-picker-fa10ea31.js"],function(){var ta,lb,yb,Qb,Kb,yd,Cc,rd,Fc,Dc,Rc,$c,Hd,gd,Uc,Pa,mb,Nb,Ub,Ic,wd,Eb,Sb,sb,ec,rc,yc,Db;return{setters:[function(ab){ta=ab.at;lb=ab.s;yb=ab.a7;Qb=ab.aV;Kb=ab.a6;yd=ab.a9;Cc=ab.aa;rd=ab.aB;Fc=ab.ak;Dc=ab.an;Rc=ab.ai;$c=ab.ao;Hd=ab.a3;gd=ab.a1;Uc=ab.C;Pa=ab.aq;mb=ab.au;Nb=ab.bQ;Ub=ab.bs;Ic=ab.ac;wd=ab.as;Eb=ab.bh;Sb=ab.br;sb=ab.bp;ec=ab.bS},function(ab){rc=ab.N;yc=ab.I},function(ab){Db=
ab.a}],execute:function(){var ab=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js");ab.fun=ta;ab.string=lb;ab.obj=yb;ab.properties=Qb;ab.arr=Kb;ab.Text=yd;ab.config=Cc;ab.HorizontalLayout=rd;ab.VerticalLayout=Fc;ab.morph=Dc;ab.Morph=Rc;ab.Icon=$c;ab.pt=Hd;ab.Rectangle=gd;ab.Color=Uc;ab.connect=Pa;ab.once=mb;ab.noUpdate=Nb;ab.ColorPicker=Db;ab.DropDownList=Ub;ab.loadObjectFromPartsbinFolder=Ic;ab.cachedControls=new WeakMap;var Zb=function(cb){var rb=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js"),
pb=rb.hasOwnProperty("RichTextControl")&&"function"===typeof rb.RichTextControl?rb.RichTextControl:rb.RichTextControl=function(Ta){Ta&&Ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wd(pb,cb,[{key:"toggleButton",value:function(Ta,Ua){Ta.master=Ua?{auto:"styleguide://SystemIDE/selected button"}:{auto:"styleguide://System/dark button"}}},{key:"reset",value:function(){var Ta=this.ui.fontSelection;Ta.items=ab.RichTextControl.basicFontItems();
Ta.selection=Ta.items[0].value;ab.connect(this.target,"selectionChange",this,"update")}},{key:"alignAtTarget",value:function(Ta){Ta=void 0===Ta?!!this.world():Ta;var Ua=this.target,ob=Ua.world()||$world,Wb=this.globalBounds();Ua=(Ua.selection.isEmpty()?Ua.globalBounds():Ua.getGlobalTransform().transformRectToRect(Ua.selectionBounds().translatedBy(Ua.scroll.negated()))).bottomCenter().subPt(Wb.topCenter());ob=ob.visibleBounds().translateForInclusion(Wb.translatedBy(Ua)).topLeft().subPt(Wb.topLeft());
ob=this.position.addPt(ob);Ta?this.animate({duration:300,position:ob}):this.position=ob}},{key:"removeFocus",value:function(){this.autoRemove&&this.target&&(this.remove(),this.target=null)}},{key:"focusOn",value:function(Ta,Ua){Ua=void 0===Ua?!0:Ua;var ob=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wb){if(1==Wb.nextAddress)return ob.target=Ta,ob.update(),Wb.yield(ob.whenRendered(),2);ob.ui.fontSizeField.relayout();Ua&&ob.alignAtTarget();Wb.jumpToEnd()})}},{key:"setupConnections",
value:function(){ab.connect(this.ui.paddingField,"number",this,"setPadding");ab.connect(this.ui.paddingFieldTop,"number",this,"setPaddingTop");ab.connect(this.ui.paddingFieldBottom,"number",this,"setPaddingBottom");ab.connect(this.ui.paddingFieldLeft,"number",this,"setPaddingLeft");ab.connect(this.ui.paddingFieldRight,"number",this,"setPaddingRight")}},{key:"update",value:function(){var Ta=this,Ua=this.target,ob=this.updateSpec,Wb=Ua.selection;Wb=Wb?Wb.isEmpty()?Ua.textAttributeAt(Wb.start):Ua.getStyleInRange(Wb):
{};var lc=this.managedProps,Lb=ab.obj.select(Ua,lc);Ua=$jscomp.makeIterator(Object.entries(ab.obj.select(Wb||{},lc)));for(Wb=Ua.next();!Wb.done;Wb=Ua.next())lc=$jscomp.makeIterator(Wb.value),Wb=lc.next().value,lc=lc.next().value,"undefined"!==typeof lc&&(Lb[Wb]=lc);ab.noUpdate(function(){for(var qc=$jscomp.makeIterator(Object.entries(Ta.ui)),I=qc.next();!I.done;I=qc.next()){var V=$jscomp.makeIterator(I.value);I=V.next().value;V=V.next().value;if(ob[I])ob[I](Lb,V)}})}},{key:"relayout",value:function(){}},
{key:"changeAttributeInSelectionOrMorph",value:function(Ta,Ua){var ob=this.target,Wb=ob.selection;ob.isLabel||Wb.isEmpty()?ob[Ta]="function"===typeof Ua?Ua(ob[Ta]):Ua:(ob.undoManager.group(),ob.changeStyleProperty(Ta,function(lc){return"function"===typeof Ua?Ua(lc):Ua}),ob.undoManager.group())}},{key:"changeFont",value:function(Ta){var Ua=this,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wb){if(1==Wb.nextAddress)return Ua._last=Ta,(ob="custom..."===Ta)?Wb.yield($world.prompt("Enter font family name",
{requester:Ua.target,historyId:"lively.morphic-rich-text-font-names",useLastInput:!0}),3):Wb.jumpTo(2);if(2!=Wb.nextAddress&&(Ta=Wb.yieldResult,!Ta))return Wb.return();Ua.changeAttributeInSelectionOrMorph("fontFamily",Ta);Wb.jumpToEnd()})}},{key:"setPadding",value:function(Ta){this.target.padding=ab.Rectangle.inset(Ta)}},{key:"setPaddingTop",value:function(Ta){var Ua=this.target.padding;this.target.padding=ab.Rectangle.inset(Ua.left(),Ta,Ua.right(),Ua.bottom())}},{key:"setPaddingLeft",value:function(Ta){var Ua=
this.target.padding;this.target.padding=ab.Rectangle.inset(Ta,Ua.top(),Ua.right(),Ua.bottom())}},{key:"setPaddingRight",value:function(Ta){var Ua=this.target.padding;this.target.padding=ab.Rectangle.inset(Ua.left(),Ua.top(),Ta,Ua.bottom())}},{key:"setPaddingBottom",value:function(Ta){var Ua=this.target.padding;this.target.padding=ab.Rectangle.inset(Ua.left(),Ua.top(),Ua.right(),Ta)}},{key:"setLineWrapping",value:function(Ta){this.target.lineWrapping=Ta}},{key:"changeFontWeight",value:function(Ta){this.changeAttributeInSelectionOrMorph("fontWeight",
Ta)}},{key:"changeTextAlign",value:function(Ta){this.changeAttributeInSelectionOrMorph("textAlign",Ta)}},{key:"changeFontColor",value:function(Ta){this.changeAttributeInSelectionOrMorph("fontColor",Ta)}},{key:"changeFontSize",value:function(Ta){this.changeAttributeInSelectionOrMorph("fontSize",Ta)}},{key:"changeFixedWidth",value:function(Ta){this.target.fixedWidth=Ta}},{key:"changeFixedHeight",value:function(Ta){this.target.fixedHeight=Ta}},{key:"changeLink",value:function(){var Ta=this,Ua,ob,Wb,
lc,Lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qc){if(1==qc.nextAddress)return Ua=Ta.target,ob=Ua.selection,Wb=Ua.getStyleInRange(ob),lc=Wb.link,qc.yield(Ta.world().prompt("Set link",{input:lc||"https://"}),2);Lb=qc.yieldResult;Ua.undoManager.group();Ua.setStyleInRange({link:Lb||void 0},ob);Ua.undoManager.group();Ta.autoRemove&&Ta.remove();qc.jumpToEnd()})}},{key:"toggleUnderline",value:function(){this.changeAttributeInSelectionOrMorph("textDecoration",function(Ta){return"underline"===
Ta?"none":"underline"})}},{key:"toggleItalic",value:function(){this.changeAttributeInSelectionOrMorph("fontStyle",function(Ta){return"italic"===Ta?"normal":"italic"})}},{key:"toggleBold",value:function(){this.changeAttributeInSelectionOrMorph("fontWeight",function(Ta){return"bold"===Ta||"700"===Ta?"normal":"bold"})}},{key:"copyStyle",value:function(){var Ta=this,Ua=this.target,ob=this.ui.applyStyleButton;Ua=Ua.selection.isEmpty()?Ua.defaultTextStyle:Ua.getStyleInRange(Ua.selection);var Wb=JSON.stringify(Ua,
null,2);this.constructor.copiedStyle=Ua;ob.tooltip="paste style\n"+Wb;this.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/plain",data:Wb},{type:"application/morphic-text-style",styleString:Wb}]).then(function(){return Ta.setStatusMessage("Copied style\n"+Wb)}).catch(function(lc){return Ta.showError(lc)})}},{key:"pasteStyle",value:function(){var Ta=this,Ua=this.target,ob=this.constructor.copiedStyle;Ua.selection.isEmpty()?Object.assign(Ua,ob):Ua.selections.forEach(function(Wb){return Ua.addTextAttribute(Ta.constructor.copiedStyle,
Wb)});this.update()}},{key:"clearStyle",value:function(){var Ta=this.target;Ta.selections.forEach(function(Ua){return Ta.resetStyleInRange(Ua)});this.update()}},{key:"configureRichTextOptions",value:function(){this.getSubmorphNamed("config panel")&&this.getSubmorphNamed("config panel").remove();var Ta=this.defaultSpec,Ua=this.uiSpec;Ta=this.addMorph({name:"config panel",layout:new ab.VerticalLayout({spacing:5}),epiMorph:!0,submorphs:[].concat($jscomp.arrayFromIterable(Object.keys(Ta).map(function(ob){var Wb=
Ua.rows.some(function(lc){return lc.some(function(Lb){return Lb===ob})});return{type:"labeledcheckbox",label:ob,name:ob,checked:Wb}})),[{layout:new ab.HorizontalLayout({spacing:3}),submorphs:[{type:"button",name:"OK button",label:"OK"},{type:"button",name:"cancel button",label:"Cancel"}]}])});Ta.center=this.innerBounds().center();ab.connect(Ta.getSubmorphNamed("OK button"),"fire",this,"configureAccepted");ab.connect(Ta.getSubmorphNamed("cancel button"),"fire",this,"configureCanceled")}},{key:"configureAccepted",
value:function(){var Ta=this.getSubmorphNamed("config panel");Ta&&(Ta.remove(),Ta.submorphs.filter(function(Ua){return"LabeledCheckBox"===Ua.constructor.name}))}},{key:"configureCanceled",value:function(){var Ta=this.getSubmorphNamed("config panel");Ta&&Ta.remove()}},{key:"close",value:function(){var Ta=this;this.target&&this.target.attributeConnections&&this.target.attributeConnections.forEach(function(Ua){return Ua.targetObj===Ta&&Ua.disconnect()});this.remove()}},{key:"alwaysTargetFocusedMorph",
value:function(){this.startStepping(1500,"updateTarget")}},{key:"updateTarget",value:function(){var Ta=this.world();Ta&&(Ta=Ta.focusedMorph)&&(Ta.isLabel||Ta.isText)&&!this.isAncestorOf(Ta)&&this.target!==Ta&&this.focusOn(Ta,!1)}},{key:"onMouseUp",value:function(Ta){var Ua=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){if(1==ob.nextAddress)return ob.yield(Ua.whenRendered(),2);Ua.update();ob.jumpToEnd()})}},{key:"attachToWorld",value:function(){ab.connect($world,"onMouseDown",
this,"updateTarget",{garbageCollect:!0})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RichTextControl"}},{key:"properties",get:function(){return{autoRemove:{defaultValue:!1},target:{},toggleColor:{},managedProps:{readOnly:!0,get:function(){return"fontFamily fontWeight fontSize fontStyle isText fontColor textAlign link textDecoration fixedWidth fixedHeight lineWrapping padding".split(" ")}},updateSpec:{get:function(){var Ta=this;return Object.assign({fontSelection:function(Ua,ob){var Wb=
Ua.fontFamily;(Ua=Wb&&ob.items.find(function(lc){return lc.value.toLowerCase()===Wb.toLowerCase()}))?ob.selection=Ua.value:Wb&&(ob.items=ob.items.concat({isListItem:!0,label:[Wb,{fontFamily:Wb}],value:Wb}),ob.selection=ab.arr.last(ob.items));ob.fit();ob.width=Math.max(ob.width,170)},fontWeightSelection:function(Ua,ob){ob.selection="normal"==Ua.fontWeight?"Medium":Ua.fontWeight?ab.string.capitalize(Ua.fontWeight):"Medium"},boldButton:function(Ua,ob){Ta.toggleButton(ob,"bold"===Ua.fontWeight)},italicButton:function(Ua,
ob){Ta.toggleButton(ob,"italic"===Ua.fontStyle)},underlineButton:function(Ua,ob){Ta.toggleButton(ob,"underline"===Ua.textDecoration)},linkButton:function(Ua,ob){Ta.toggleButton(ob,!!Ua.link)},colorPicker:function(Ua,ob){ob.colorValue=Ua.fontColor},fontSizeField:function(Ua,ob){ob.number=Ua.fontSize},fixedWidthControl:function(Ua,ob){Ua.isText?ob.enable():ob.disable();ob.checked=Ua.fixedWidth},fixedHeightControl:function(Ua,ob){Ua.isText?ob.enable():ob.disable();ob.checked=Ua.fixedHeight},lineWrappingControl:function(Ua,
ob){var Wb=$jscomp.makeIterator(ob.submorphs);ob=Wb.next().value;Wb=Wb.next().value;ob.checked=!!Ua.lineWrapping;Wb.deactivated=!Ua.lineWrapping;Wb.deactivated?Wb.opacity=.5:(Wb.opacity=1,Wb.selection=Ua.lineWrapping)},paddingControl:function(Ua,ob){var Wb=Ua.padding,lc=Wb.left();Ua=Wb.top();var Lb=Wb.right();Wb=Wb.bottom();var qc=!ab.arr.every([lc,Ua,Lb,Wb],function(I){return I==lc});ob.get("multi value indicator").visible=qc;ab.connect(ob.get("multi value indicator"),"onMouseDown",ob.get("padding field"),
"number",{converter:"() => left",varMapping:{left:lc}});ob.get("padding field").number=lc;ob.get("padding field").visible=!qc;ob.get("padding field top").number=Ua;ob.get("padding field left").number=lc;ob.get("padding field right").number=Lb;ob.get("padding field bottom").number=Wb}},["left","center","right","block"].reduce(function(Ua,ob){Ua[ob+"Align"]=function(Wb,lc){Ta.toggleButton(lc,Wb.textAlign==ob)};return Ua},{}))}},ui:{get:function(){var Ta=this,Ua={fontSelection:"font selection",fontWeightSelection:"font weight selection",
boldButton:"bold button",italicButton:"italic button",underlineButton:"underline button",linkButton:"link button",leftAlign:"left align",centerAlign:"center align",rightAlign:"right align",blockAlign:"block align",fontSizeField:"font size field",colorPicker:"color picker",copyStyleButton:"copy style",applyStyleButton:"apply style",removeStyleButton:"remove style",fixedHeightControl:"fixed height control",fixedWidthControl:"fixed width control",lineWrappingControl:"line wrapping control",paddingControl:"padding control",
paddingField:"padding field",paddingFieldTop:"padding field top",paddingFieldLeft:"padding field left",paddingFieldRight:"padding field right",paddingFieldBottom:"padding field bottom"};return ab.obj.extract(Ua,ab.obj.keys(Ua),function(ob,Wb){return Ta.getSubmorphNamed(Wb)})}}}}},{key:"openDebouncedFor",value:function(Ta){var Ua=Ta.selection;if(Ua.isEmpty()){var ob=ab.cachedControls.get(Ta);ob&&(ob.update(),ob.alignAtTarget(),ob.world()||Ta.world().addMorph(ob))}else ab.fun.debounceNamed(Ta.id+"openRichTextControl",
600,function(){var Wb=ab.cachedControls.get(Ta);Ua.isEmpty()?Wb&&Wb.removeFocus():(Wb&&Wb.world()||(Wb=new ab.RichTextControl,ab.cachedControls.set(Ta,Wb)),Ta.world().addMorph(Wb),Wb.focusOn(Ta,!0),Wb.alwaysTargetFocusedMorph())})()}},{key:"openFor",value:function(Ta){var Ua=ab.cachedControls.get(Ta);Ua?Ua.update():(Ua=new ab.RichTextControl,ab.cachedControls.set(Ta,Ua),Ua.focusOn(Ta,!0),Ua.alwaysTargetFocusedMorph());Ua.alignAtTarget();Ua.world()||Ta.world().addMorph(Ua);return Ua}}],rb,{pathInPackage:function(){return"text/ui.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:624,end:16984})}(ab.Morph);ab.RichTextControl=Zb;ab.RichTextControl=Zb;ab.RichTextControl=Zb;Zb=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js");Zb.SearchField=Eb;var kc=function(cb){var rb=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js"),pb=rb.hasOwnProperty("ProtoSearchField")&&
"function"===typeof rb.ProtoSearchField?rb.ProtoSearchField:rb.ProtoSearchField=function(Ta){Ta&&Ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wd(pb,cb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoSearchField"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoSearchField",version:"0.1.1-0"}}},{start:76,end:221})}(Zb.SearchField);kc=Zb.ProtoSearchField;Zb.default=kc;var ua=lively.FreezerRuntime.recorderFor("ProtoTree/index.js");ua.Tree=Sb;ua.TreeData=sb;Zb=function(cb){var rb=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),pb=rb.hasOwnProperty("TestTreeData")&&"function"===typeof rb.TestTreeData?rb.TestTreeData:rb.TestTreeData=function(Ta){Ta&&
Ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wd(pb,cb,[{key:"display",value:function(Ta){return Ta.name}},{key:"isCollapsed",value:function(Ta){return Ta.isCollapsed}},{key:"collapse",value:function(Ta,Ua){Ta.isCollapsed=Ua}},{key:"getChildren",value:function(Ta){return Ta.isLeaf?null:Ta.isCollapsed?[]:Ta.children}},{key:"isLeaf",value:function(Ta){return Ta.isLeaf}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TestTreeData"}}],
rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:113,end:417})}(ua.TreeData);ua.TestTreeData=Zb;ua.TestTreeData=Zb;ua.TestTreeData=Zb;Zb=function(cb){var rb=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),pb=rb.hasOwnProperty("ProtoTree")&&"function"===typeof rb.ProtoTree?rb.ProtoTree:
rb.ProtoTree=function(Ta){Ta&&Ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wd(pb,cb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoTree"}},{key:"properties",get:function(){return{treeData:{initialize:function(){this.treeData=new ua.TestTreeData({name:"root",isCollapsed:!1,isLeaf:!1,children:[{name:"child 1",isLeaf:!0},{name:"child 2",isLeaf:!1,isCollapsed:!0,children:[{name:"child 2 - 1",isLeaf:!0}]},
{name:"child 3",isLeaf:!1,isCollapsed:!1,children:[{name:"child 3 - 1",isLeaf:!0},{name:"child 3 - 2",isLeaf:!0}]},{name:"child 4",isLeaf:!0}]})}},master:{initialize:function(){}}}}}],rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:434,end:1297})}(ua.Tree);Zb=ua.ProtoTree;ua.default=Zb;Zb=
lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js");Zb.NumberWidget=rc;kc=function(cb){var rb=lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js"),pb=rb.hasOwnProperty("ProtoNumberWidget")&&"function"===typeof rb.ProtoNumberWidget?rb.ProtoNumberWidget:rb.ProtoNumberWidget=function(Ta){Ta&&Ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wd(pb,cb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoNumberWidget"}},
{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoNumberWidget",version:"0.1.1-0"}}},{start:76,end:224})}(Zb.NumberWidget);kc=Zb.ProtoNumberWidget;Zb.default=kc;Zb=lively.FreezerRuntime.recorderFor("FrameResizer/index.js");Zb.Morph=Rc;kc=function(cb){var rb=
lively.FreezerRuntime.recorderFor("FrameResizer/index.js"),pb=rb.hasOwnProperty("FrameResizer")&&"function"===typeof rb.FrameResizer?rb.FrameResizer:rb.FrameResizer=function(Ta){Ta&&Ta[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wd(pb,cb,[{key:"onDrag",value:function(Ta){var Ua=this.owner.left;Ta=Ta.positionIn(this).x;Ta*="left"==this.direction?-1:1;this.owner.width+=Ta;350>this.owner.width&&(Ta+=350-this.owner.width,this.owner.width=
350);this.owner.left="left"==this.direction?Ua-Ta:Ua}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FrameResizer"}},{key:"properties",get:function(){return{direction:{type:"Enum",values:["left","right"]}}}}],rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"FrameResizer",version:"0.1.1-24"}}},{start:56,end:840})}(Zb.Morph);
kc=Zb.FrameResizer;Zb.default=kc;var Ga=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js");Ga.Morph=Rc;Ga.morph=Dc;Ga.layouts=ec;Ga.string=lb;Ga.connect=Pa;Ga.noUpdate=Nb;Ga.InteractiveMorphSelector=yc;Ga.Color=Uc;Ga.pt=Hd;Zb=function(cb){var rb=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js"),pb=rb.hasOwnProperty("ShapeLayoutControl")&&"function"===typeof rb.ShapeLayoutControl?rb.ShapeLayoutControl:rb.ShapeLayoutControl=function(Ta){Ta&&Ta[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wd(pb,cb,[{key:"focusOn",value:function(Ta){this.target=Ta;this.update(!1)}},{key:"setupConnections",value:function(){var Ta=this.ui;Ga.connect(Ta.submorphSettingsControl,"fire",this,"chooseSubmorphToChangeLayoutSettings");Ga.connect(Ta.dragmeControl,"onDragStart",this,"onSubmorphSettingsDragStart");Ga.connect(Ta.xAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "x",\n        submorph: self.selectedSubmorph,\n      })',
varMapping:{self:this}});Ga.connect(Ta.yAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "y",\n        submorph: self.selectedSubmorph,\n      })',varMapping:{self:this}});for(var Ua={},ob=$jscomp.makeIterator(this.managedProps),Wb=ob.next();!Wb.done;Ua={$jscomp$loop$prop$prop$2261:Ua.$jscomp$loop$prop$prop$2261},Wb=ob.next()){var lc=$jscomp.makeIterator(Wb.value),Lb=lc.next().value;Wb=lc.next().value;lc.next().value||
(Ua.$jscomp$loop$prop$prop$2261=this.join(Lb),lc=Ta[this.join(Lb,"control")],Ga.connect(lc,Wb,this,"updateLayout",{updater:function(qc){return function(I,V){I(qc.$jscomp$loop$prop$prop$2261,V)}}(Ua),varMapping:{prop:Ua.$jscomp$loop$prop$prop$2261}}))}}},{key:"lower",value:function(Ta){return Ta.charAt(0).toLowerCase()+Ta.slice(1)}},{key:"join",value:function(Ta,Ua){return this.lower(Ga.string.camelCaseString(Ta+(Ua?" "+Ua:"")))}},{key:"updateLayoutOfTarget",value:function(Ta){Ta=Ga.layouts[Ga.string.camelCaseString(Ta)];
this.target.layout=Ta?new Ta({autoResize:!1}):null;this.update()}},{key:"updateLayout",value:function(Ta,Ua){this.target.layout[Ta]=Ua}},{key:"update",value:function(Ta){var Ua=this;this.target&&Ga.noUpdate(function(){for(var ob=Ua.ui,Wb=Ua.target.layout||{name:function(){return"No"}},lc=$jscomp.makeIterator(Ua.managedProps),Lb=lc.next();!Lb.done;Lb=lc.next()){var qc=$jscomp.makeIterator(Lb.value);Lb=qc.next().value;var I=qc.next().value;qc.next();qc=ob[Ua.join(Lb,"control")];var V=ob[Ua.join(Lb,
"label")];if(I)if("type"===Lb)qc.selection=Wb.name()+" Layout";else{var ra=Wb[Ua.join(Lb)],ya="undefined"!==typeof ra;if(ya){switch(Lb){case "align":qc.items=Wb.possibleAlignValues;break;case "direction":qc.items=Wb.possibleDirectionValues;break;case "axis":qc.items=Wb.possibleAxisValues}qc[I]=ra}V.isLayoutable=V.visible=ya}}Ua.showGridLayoutControl("Grid"===Wb.name());Ua.showProportionalControl("Proportional"===Wb.name())})}},{key:"updateSubmorphProportionalLayoutSettings",value:function(Ta){var Ua=
{};this.target.layout.changeSettingsFor(Ta.submorph,(Ua[Ta.axis]=Ta.policy,Ua),!0)}},{key:"onSubmorphSettingsDragStart",value:function(Ta){var Ua=this;Ta.stop();var ob=this.target.layout,Wb=ob.settingsFor(this.selectedSubmorph),lc=[],Lb;for(Lb in Wb)lc=[].concat($jscomp.arrayFromIterable(lc),[Lb+": ",{fontWeight:"bold"},Wb[Lb]+" ",{}]);var qc=Ga.morph({type:"label",fontColor:Ga.Color.white,value:lc,fill:Ga.Color.black.withA(.7),padding:5,borderRadius:10,isLayoutable:!1});qc.wantsToBeDroppedOn=function(I){return ob.layoutableSubmorphs.includes(I)};
qc.onBeingDroppedOn=function(I,V){qc.remove();if(I=ob.layoutableSubmorphs.includes(V)?V:Ta.world.morphsContainingPoint(Ta.hand.position).find(function(ra){return ob.layoutableSubmorphs.includes(ra)}))Ua.updateSubmorphProportionalLayoutSettings({policy:Wb.x,axis:"x",submorph:I}),Ua.updateSubmorphProportionalLayoutSettings({policy:Wb.y,axis:"y",submorph:I}),I.show(),$world.setStatusMessage("layout settings applied")};Ta.hand.grab(qc);qc.moveBy(Ga.pt(10,10))}},{key:"chooseSubmorphToChangeLayoutSettings",
value:function(){var Ta=this,Ua,ob,Wb,lc,Lb,qc,I,V,ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){switch(ya.nextAddress){case 1:return Ua=Ta.target.layout.layoutableSubmorphs,Ta.manageFocus=!0,Ta.env.eventDispatcher.isKeyPressed("Shift")?(Wb=Ua.map(function(Gb){return{isListItem:!0,string:String(Gb),value:Gb}}),ya.yield($world.listPrompt("Select morph",Wb,{onSelection:function(Gb){return Gb.show()}}),5)):ya.yield(Ga.InteractiveMorphSelector.selectMorph(Ta.world(),Ta,function(Gb){return Ua.includes(Gb)}),
4);case 4:ob=ya.yieldResult;ya.jumpTo(3);break;case 5:lc=ya.yieldResult,Lb=$jscomp.makeIterator(lc.selected),ob=Lb.next().value;case 3:Ta.manageFocus=!1;Ta.selectedSubmorph=ob;if(!ob)return ya.return();qc=Ta.ui;I=qc.xAxisPolicyControl;V=qc.yAxisPolicyControl;ra=Ta.target.layout.settingsFor(ob);Ga.noUpdate(function(){I.selection=ra.x;V.selection=ra.y});ya.jumpToEnd()}})}},{key:"showProportionalControl",value:function(Ta){var Ua=this.ui;[Ua.submorphSettingsControl,Ua.dragmeControl,Ua.xAxisPolicyControl,
Ua.xAxisPolicyLabel,Ua.yAxisPolicyControl,Ua.yAxisPolicyLabel].forEach(function(ob){ob.isLayoutable=Ta;ob.visible=Ta})}},{key:"showGridLayoutHalo",value:function(){$world.showLayoutHaloFor(this.target)}},{key:"showGridLayoutControl",value:function(Ta){var Ua=this.ui.configureGridLayoutControl;Ua.visible=Ua.isLayoutable=Ta}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShapeLayoutControl"}},{key:"properties",get:function(){return{managedProps:{get:function(){return[["type","selection",
!0],["align","selection"],["direction","selection"],["axis","selection"],["spacing","number"],["auto resize","checked"],["resize submorphs","checked"],["x axis policy","selection",!0],["y axis policy","selection",!0],["react to submorph animations","checked"],["submorph settings",!1,!0],["order by index","checked"],["dragme",!1,!0],["configure grid layout",!1,!0]]}},ui:{readOnly:!0,get:function(){for(var Ta={labelContainer:this.getSubmorphNamed("label container"),controlContainer:this.getSubmorphNamed("control container")},
Ua=$jscomp.makeIterator(this.managedProps),ob=Ua.next();!ob.done;ob=Ua.next()){var Wb=$jscomp.makeIterator(ob.value).next().value;ob=Wb+" label";Wb+=" control";Ta[this.join(ob)]=this.getSubmorphNamed(ob);Ta[this.join(Wb)]=this.getSubmorphNamed(Wb)}return Ta}}}}}],rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ShapeLayoutControl",
version:"0.1.1-166"}}},{start:345,end:7771})}(Ga.Morph);Zb=Ga.ShapeLayoutControl;Ga.default=Zb}}});
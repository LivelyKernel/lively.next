System.register(["./__root_module__-c4d7431e.js","kld-intersections","./user-ui-1bab221a.js","./index-6f8f5c35.js","./index-f069e892.js"],function(ta,nb){var Bb,Vb,Qb,Dd,Ic,ud,Nc,Jc,Xc,id,Fd,nd,Yc,Ta,sb,dc,ac,Vc,Hd;return{setters:[function(hc){Bb=hc.ah;Vb=hc.aA;Qb=hc.aj;Dd=hc.am;Ic=hc.Y;ud=hc.a5;Nc=hc.as;Jc=hc.s;Xc=hc.C;id=hc.a2;Fd=hc.r;nd=hc.ar;Yc=hc.az;Ta=hc.aZ;sb=hc.a_;dc=hc.ap;ac=hc.aW;Vc=hc.aV},function(){},function(hc){Hd=hc.UserUI},function(){},function(){}],execute:function(){var hc=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");hc.Morph=Bb;hc.HorizontalLayout=Vb;hc.VerticalLayout=Qb;hc.morph=Dd;hc.MorphicDB=Ic;hc.arr=ud;hc.fun=Nc;hc.string=Jc;hc.Color=Xc;hc.pt=id;hc.UserUI=Hd;hc.resource=Fd;var kc=function(wc){var Kc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),zb=Kc.hasOwnProperty("WorldDashboard")&&"function"===typeof Kc.WorldDashboard?Kc.WorldDashboard:Kc.WorldDashboard=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return nd(zb,wc,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(ab){ab=void 0===ab?$world:ab;this.owner!=ab&&ab.addMorph(this);this.center=ab.visibleBounds().center()}},{key:"sortAndFilterPreviews",
value:function(ab){var Kb=hc.UserUI.getCurrentUser();ab=this.ui.searchField.fuzzyFilter(ab,function(nc){return nc._commit.name+nc._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return hc.arr.sortBy(ab,function(nc){return-nc._commit.timestamp});case "TEMPLATES":return ab;case "MY PROJECTS":return hc.arr.filter(ab,function(nc){return nc._commit.author.name===Kb.name});case "PUBLISHED":return ab}}},{key:"updateList",value:function(){var ab=this;this.previews&&hc.fun.debounceNamed("update world list",
150,function(){ab.ui.worldList.items=ab.sortAndFilterPreviews(ab.previews)})()}},{key:"displayWorlds",value:function(){var ab=this,Kb,nc,da,qa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cb){switch(cb.nextAddress){case 1:return ab.reset(),Kb=ab.ui,nc=Kb.loadingLabel,nc.visible=!0,nc.animate({opacity:1,duration:300}),cb.yield(ab.db.latestCommits("world"),2);case 2:return da=cb.yieldResult,cb.yield(nb.import("./world preview-f4f48fb9.js"),4);case 4:if(!(qa=cb.yieldResult)){cb.jumpTo(5);
break}return cb.yield(hc.resource("part://partial freezing/world preview"),6);case 6:qa=cb.yieldResult;case 5:return cb.yield(qa.read(),3);case 3:return Va=cb.yieldResult,ab.previews=da.map(function(kb){var Ma=hc.morph({reactsToPointer:!1,fill:hc.Color.transparent,extent:Va.extent});Ma._commit=kb;Ma.displayPreview=function(){var Oa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){if(1==lb.nextAddress)return Oa=Va.copy(),Oa._commit=kb,Oa.opacity=0,Ma.addMorph(Oa),Oa.displayPreview(),
Oa.position=hc.pt(0,0),lb.yield(Ma.whenRendered(),2);Ma.layout=new hc.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});lb.jumpToEnd()})};return Ma}),cb.yield(nc.animate({opacity:0,duration:300}),7);case 7:nc.visible=!1,ab.updateList(),0==da.length&&(ab.ui.noWorldWarning.center=ab.innerBounds().center(),ab.ui.noWorldWarning.animate({visible:!0,duration:300})),cb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:"className",
get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(ab){this.ui.closeButton.visible=ab}},db:{serialize:!1,get:function(){return hc.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),
loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],Kc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-124"}}},{start:330,end:4020})}(hc.Morph);kc=hc.WorldDashboard;hc.default=kc;var xb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");
xb.Morph=Bb;xb.touchInputDevice=Yc;xb.TilingLayout=Ta;xb.arr=ud;xb.pt=id;kc=function(wc){var Kc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),zb=Kc.hasOwnProperty("GrowingWorldList")&&"function"===typeof Kc.GrowingWorldList?Kc.GrowingWorldList:Kc.GrowingWorldList=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return nd(zb,wc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(ab){nd._get(Object.getPrototypeOf(zb.prototype),
"onScroll",this).call(this,ab);this.update()}},{key:"onChange",value:function(ab){nd._get(Object.getPrototypeOf(zb.prototype),"onChange",this).call(this,ab);"extent"==ab.prop&&this.update(!0)}},{key:"onHoverIn",value:function(ab){this.clipMode="auto"}},{key:"onHoverOut",value:function(ab){xb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(ab){var Kb=this.items;if(Kb&&0!=Kb.length){var nc=this.scrollContainer,da=nc.layout.spacing;nc.extent=this.extent;var qa=this.ui,Va=qa.bufferTop;
qa=qa.bufferBottom;Va=Va||nc.addMorph({fill:null,name:"buffer top",height:10});qa=qa||nc.addMorph({fill:null,name:"buffer bottom",height:10});Va.width=qa.width=this.width-100;nc.layout.disable();var cb=Kb[0];da=Kb.slice(0,Math.floor(this.width/(cb.width+da))*(Math.ceil((this.scroll.y+this.height)/(cb.height+da))+1)).filter(function(lb){return lb.owner!=nc});cb=this.scroll.y+2*this.height;for(var kb={},Ma=$jscomp.makeIterator(da),Oa=Ma.next();!Oa.done;kb={$jscomp$loop$prop$item$2283:kb.$jscomp$loop$prop$item$2283},
Oa=Ma.next())kb.$jscomp$loop$prop$item$2283=Oa.value,cb++,kb.$jscomp$loop$prop$item$2283.top=cb,nc.addMorph(kb.$jscomp$loop$prop$item$2283),kb.$jscomp$loop$prop$item$2283._initialized||kb.$jscomp$loop$prop$item$2283.whenRendered().then(function(lb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wb){lb.$jscomp$loop$prop$item$2283._initialized=!0;return Wb.yield(lb.$jscomp$loop$prop$item$2283.displayPreview(),0)})}}(kb));ab&&(Va.position=xb.pt(0,0),Kb.forEach(function(lb,
Wb){return lb.position=xb.pt(Wb+1,Wb+1)}),qa.position=xb.pt(Kb.length+2,Kb.length+2));nc.layout.enable();if(ab||0<da.length)qa.top=this.submorphBounds().height,nc.layout.apply()}}}],[{key:"className",get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new xb.TilingLayout({spacing:25,align:"center",
autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(ab){this.setProperty("items",ab);var Kb=this.scrollContainer;Kb.layout&&Kb.layout.disable();var nc=this.ui,da=nc.bufferTop;nc=nc.bufferBottom;xb.arr.withoutAll(Kb.submorphs,[].concat($jscomp.arrayFromIterable(ab),[da,nc])).forEach(function(qa){return qa.remove()});this.update(!0)}}}}}],Kc,{pathInPackage:function(){return"index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(xb.Morph);kc=xb.GrowingWorldList;xb.default=kc;var yb=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");yb.InputLine=sb;yb.Color=Xc;yb.connect=dc;yb.disconnectAll=ac;yb.disconnect=Vc;yb.arr=ud;yb.string=Jc;kc=function(wc){var Kc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),
zb=Kc.hasOwnProperty("SearchInputLine")&&"function"===typeof Kc.SearchInputLine?Kc.SearchInputLine:Kc.SearchInputLine=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return nd(zb,wc,[{key:"fuzzyMatch",value:function(ab,Kb){Kb=void 0===Kb?this.parseInput():Kb;if(Kb.lowercasedTokens.every(function(da){return ab.toLowerCase().includes(da)}))return!0;var nc=ab.toLowerCase();return 3>=yb.arr.sum(Kb.lowercasedTokens.map(function(da){return yb.string.levenshtein(nc,
da)}))}},{key:"fuzzyFilter",value:function(ab,Kb){var nc=this;Kb=void 0===Kb?function(qa){return qa}:Kb;var da=this.parseInput();return yb.arr.filter(ab,function(qa){return nc.fuzzyMatch(Kb(qa),da)})}},{key:"parseInput",value:function(){var ab=Array.from(this.textString).reduce(function(nc,da){if("\\"===da&&!nc.escaped)return nc.escaped=!0,nc;" "!==da||nc.escaped?(nc.spaceSeen=!1,nc.current+=da):(!nc.spaceSeen&&nc.current&&(nc.tokens.push(nc.current),nc.current=""),nc.spaceSeen=!0);nc.escaped=!1;
return nc},{tokens:[],current:"",escaped:!1,spaceSeen:!1});ab.current&&ab.tokens.push(ab.current);var Kb=ab.tokens.map(function(nc){return nc.toLowerCase()});return{tokens:ab.tokens,lowercasedTokens:Kb}}}],[{key:"className",get:function(){return"SearchInputLine"}}],Kc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",
version:"0.1.1-4"}}},{start:239,end:1834})}(yb.InputLine);kc=yb.SearchInputLine;yb.default=kc}}});
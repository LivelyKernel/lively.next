System.register("./__rootModule___commonjs-entry-71573ff5.js ./terminal-dc164e8b.js @babel/plugin-syntax-import-meta ./editor-plugin-0a8dd45b.js ./ui.cp-6289a670.js ./loading-indicator.cp-b18e3b89.js ./index-d18accbd.js ./tooltips.cp-6a2406c0.js ./index-1c08552a.js ./interface-dc23a2c8.js ./index-ca98f65e.js ./index-c79abca0.js ./value-widgets-6cb12552.js ./list.cp-8569fe93.js ./popups.cp-68dc8a4a.js ./editor-modes-5e094c88.js ./mode-9e103dc6.js ./editor-plugin-8acb3af6.js ./ui.cp-04e9d052.js ./index-02a2847a.js ./editor-plugin-330ed4ee.js ./editor-plugin-00779331.js ./eval-backend-ui-e952986b.js ./index-5053c530.js rollup @rollup/plugin-json ./helpers-ae531c72.js @rollup/plugin-commonjs rollup-plugin-polyfill-node ./test-runner-849f8d86.js ./linter-9c18bc15.js".split(" "),function(Lc){var pd,
Nd,Tc,Jc,$d,Bb;return{setters:[function(rd){pd=rd._;Nd=rd.aB;Tc=rd.aC;Jc=rd.g;$d=rd.W},function(rd){Bb=rd["default"]},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){function rd(){return Id.apply(this,
arguments)}function Id(){Id=pd(regeneratorRuntime.mark(function Nb(){var bc,hb,cb,Hb,ec,ub;return regeneratorRuntime.wrap(function(yb){for(;;)switch(yb.prev=yb.next){case 0:return bc=lively.modules.semver,yb.next=3,sb.$$world.prompt("Enter the package directory",{input:sb.defaultDirectory(),historyId:"pusblish-new-package-dir-history",useLastInput:!0});case 3:if(hb=yb.sent){yb.next=6;break}throw Error("canceled");case 6:return yb.next=8,sb.readConfig(hb);case 8:return cb=yb.sent,Hb=cb.config,ec=cb.configText,
yb.next=13,sb.confirmPublish(Hb);case 13:if(yb.sent){yb.next=15;break}throw Error("canceled");case 15:return yb.next=17,sb.$$world.prompt("The current version is ".concat(Hb.version,". Please enter the new version number:"),{input:bc.inc(Hb.version,"patch")});case 17:if(ub=yb.sent){yb.next=20;break}throw Error("canceled");case 20:return yb.next=22,sb.addNewVersionToConfig(hb,ec,Hb.version,ub);case 22:return yb.next=24,sb.publishToNPM(hb);case 24:return yb.next=26,sb.commitChanges(hb);case 26:if(!yb.sent){yb.next=
31;break}yb.next=29;return sb.gitTag(hb,ub);case 29:return yb.next=31,sb.gitPush(hb);case 31:return yb.abrupt("return",ub);case 32:case "end":return yb.stop()}},Nb)}));return Id.apply(this,arguments)}function Ac(){Ac=pd(regeneratorRuntime.mark(function bc(Nb){var hb;return regeneratorRuntime.wrap(function(cb){for(;;)switch(cb.prev=cb.next){case 0:return cb.next=2,sb.$$world.confirm("Do you want to publish a new version of ".concat(Nb.name,"?"));case 2:return hb=cb.sent,cb.abrupt("return",!0===hb||
0===hb);case 4:case "end":return cb.stop()}},bc)}));return Ac.apply(this,arguments)}function Pc(){Pc=pd(regeneratorRuntime.mark(function bc(Nb){var hb;return regeneratorRuntime.wrap(function(cb){for(;;)switch(cb.prev=cb.next){case 0:return cb.next=2,sb.resource(Nb).join("package.json").read();case 2:return hb=cb.sent,cb.abrupt("return",{config:JSON.parse(hb),configText:hb});case 4:case "end":return cb.stop()}},bc)}));return Pc.apply(this,arguments)}function gd(){gd=pd(regeneratorRuntime.mark(function Hb(Nb,
bc,hb,cb){var ec;return regeneratorRuntime.wrap(function(ub){for(;;)switch(ub.prev=ub.next){case 0:return ec=bc.replace('"version": "'.concat(hb,'"'),'"version": "'.concat(cb,'"')),ub.next=3,sb.resource(Nb).join("package.json").write(ec);case 3:case "end":return ub.stop()}},Hb)}));return gd.apply(this,arguments)}function nd(){nd=pd(regeneratorRuntime.mark(function bc(Nb){var hb,cb,Hb,ec,ub,yb,ba;return regeneratorRuntime.wrap(function(wb){for(;;)switch(wb.prev=wb.next){case 0:return wb.next=2,sb.runCommand("git s",
{cwd:Nb}).whenDone();case 2:hb=wb.sent;cb=hb.exitCode;Hb=hb.output;if(ec=Hb.match(/not a git repo/i)?null:Hb.trim()){wb.next=8;break}return wb.abrupt("return",!1);case 8:return ub=lively.lang.string.lines(ec),10<ub.length&&(ub=ub.slice(0,10).concat(["..."])),wb.next=12,sb.$$world.confirm("Local changes exist. Commit them all?\n"+ub.join("\n"));case 12:yb=wb.sent;if(!yb){wb.next=23;break}wb.next=16;return sb.runCommand("git ci -a",{cwd:Nb}).whenDone();case 16:ba=wb.sent;cb=ba.exitCode;Hb=ba.output;
if(!cb){wb.next=21;break}throw Error("Commit canceled");case 21:wb.next=24;break;case 23:throw Error("Local changes exist");case 24:return wb.abrupt("return",!0);case 25:case "end":return wb.stop()}},bc)}));return nd.apply(this,arguments)}function Fd(){Fd=pd(regeneratorRuntime.mark(function hb(Nb,bc){var cb,Hb,ec;return regeneratorRuntime.wrap(function(ub){for(;;)switch(ub.prev=ub.next){case 0:return ub.next=2,sb.runCommand('git tag "'.concat(bc,'"'),{cwd:Nb}).whenDone();case 2:cb=ub.sent;Hb=cb.exitCode;
ec=cb.output;if(!Hb){ub.next=7;break}throw Error("git tag failed ".concat(ec));case 7:case "end":return ub.stop()}},hb)}));return Fd.apply(this,arguments)}function ic(){ic=pd(regeneratorRuntime.mark(function bc(Nb){var hb,cb,Hb,ec,ub,yb,ba,wb,Xa;return regeneratorRuntime.wrap(function(Za){for(;;)switch(Za.prev=Za.next){case 0:return Za.next=2,sb.runCommand("git remote -v | grep origin | head -n 1",{cwd:Nb}).whenDone();case 2:hb=Za.sent;cb=hb.exitCode;Hb=hb.output;if(!cb){Za.next=7;break}throw Error("git remote -v failed ".concat(Hb));
case 7:return ec=Hb.split(/[\t\s]/)[1],Za.next=10,sb.runCommand("git branch | grep '*'",{cwd:Nb}).whenDone();case 10:ub=Za.sent;cb=ub.exitCode;Hb=ub.output;if(!cb){Za.next=15;break}throw Error("git branch failed ".concat(Hb));case 15:return yb=Hb.trim().replace(/^\*\s*/,""),Za.next=18,sb.$$world.confirm("Push branch ".concat(yb," to ").concat(ec,"?\n"));case 18:ba=Za.sent;if(!ba){Za.next=31;break}Za.next=22;return sb.Terminal.runCommand("git push origin ".concat(yb," && git push --tags"),{cwd:Nb});
case 22:return wb=Za.sent,Za.next=25,wb.targetMorph.command.whenDone();case 25:Xa=Za.sent;Hb=Xa.output;cb=Xa.exitCode;if(!cb){Za.next=30;break}throw Error("git push failed");case 30:wb.close();case 31:case "end":return Za.stop()}},bc)}));return ic.apply(this,arguments)}function vd(){vd=pd(regeneratorRuntime.mark(function bc(Nb){var hb,cb,Hb,ec;return regeneratorRuntime.wrap(function(ub){for(;;)switch(ub.prev=ub.next){case 0:return ub.next=2,sb.$$world.confirm("Publish to npm?",["yes","no"]);case 2:hb=
ub.sent;if(hb=!0===hb||0===hb){ub.next=6;break}return ub.abrupt("return");case 6:return ub.next=8,sb.Terminal.runCommand("npm publish",{cwd:Nb});case 8:return cb=ub.sent,ub.next=11,cb.targetMorph.command.whenDone();case 11:Hb=ub.sent;ec=Hb.exitCode;if(!ec){ub.next=16;break}throw Error("npm publish failed");case 16:return ub.next=18,lively.lang.promise.delay(1E3);case 18:cb.close();case 19:case "end":return ub.stop()}},bc)}));return vd.apply(this,arguments)}Lc("default",rd);var sb=window.lively.FreezerRuntime.recorderFor("lively.installer/packages/publish-new-package-version.js");
sb.interactivelyPublishNewPackageVersion=rd;sb.confirmPublish=function(Xb){return Ac.apply(this,arguments)};sb.readConfig=function(Xb){return Pc.apply(this,arguments)};sb.addNewVersionToConfig=function(Xb,Nb,bc,hb){return gd.apply(this,arguments)};sb.commitChanges=function(Xb){return nd.apply(this,arguments)};sb.gitTag=function(Xb,Nb){return Fd.apply(this,arguments)};sb.gitPush=function(Xb){return ic.apply(this,arguments)};sb.publishToNPM=function(Xb){return vd.apply(this,arguments)};sb.defaultDirectory=
Nd;sb.runCommand=Tc;sb.Terminal=Bb;sb.resource=Jc;sb.World=$d;sb.$$world=sb.World.defaultWorld();sb["default"]=rd}}});
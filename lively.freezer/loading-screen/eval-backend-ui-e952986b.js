System.register("./__rootModule___commonjs-entry-71573ff5.js ./index-1c08552a.js ./index-d18accbd.js ./loading-indicator.cp-b18e3b89.js @babel/plugin-syntax-import-meta ./interface-dc23a2c8.js ./index-ca98f65e.js ./tooltips.cp-6a2406c0.js".split(" "),function(Lc){var pd,Nd,Tc,Jc,$d,Bb,rd,Id,Ac,Pc,gd,nd,Fd,ic,vd,sb,Xb,Nb,bc;return{setters:[function(hb){pd=hb.b;Nd=hb.K;Tc=hb.C;Jc=hb.j;$d=hb.k;Bb=hb.w;rd=hb.A;Id=hb.b$;Ac=hb.c0;Pc=hb.i;gd=hb._;nd=hb.x;Fd=hb.y},function(hb){ic=hb.serverInterfaceFor;vd=
hb.localInterface;sb=hb.l2lInterfaceFor},function(hb){Xb=hb.j},function(hb){Nb=hb.B;bc=hb.b},function(){},function(){},function(){},function(){}],execute:function(){var hb=window.lively.FreezerRuntime.recorderFor("lively.ide/js/eval-backend-ui.js");hb.pt=pd;hb.LinearGradient=Nd;hb.Color=Tc;hb.arr=Jc;hb.string=$d;hb.connect=Bb;hb.config=rd;hb.StyleSheet=Id;hb.L2LClient=Ac;hb.serverInterfaceFor=ic;hb.localInterface=vd;hb.l2lInterfaceFor=sb;hb.Button=Nb;hb.DropDownList=Xb;hb.ButtonDefault=bc;var cb=
Lc("EvalBackendButton",function(Hb){var ec=window.lively.FreezerRuntime.recorderFor("lively.ide/js/eval-backend-ui.js"),ub=ec.hasOwnProperty("EvalBackendButton")&&"function"===typeof ec.EvalBackendButton?ec.EvalBackendButton:ec.EvalBackendButton=function(yb){if(!yb||!yb[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Pc(ub,Hb,[{key:"trigger",value:function(){var yb=gd(regeneratorRuntime.mark(function wb(){var Xa,Za,
Sb,Cb,Da,zb,db,ib,Ea,W,T,ia;return regeneratorRuntime.wrap(function(ka){for(;;)switch(ka.prev=ka.next){case 0:return ka.next=2,this.evalbackendChooser.allEvalBackends();case 2:return Xa=ka.sent,Za=this.currentBackend,Sb=1,Cb=["edit..."].concat(Fd(Xa.map(function(K,ya){Za===K&&(Sb=ya+1);return{isListItem:!0,label:[K.coreInterface.description||K.name,{fontSize:"90%"}],value:K}}))),ka.next=8,this.world().filterableListPrompt("choose eval backend",Cb,{requester:this.target,preselect:Sb});case 8:Da=ka.sent;
zb=nd(Da.selected,1);db=zb[0];if("edit..."!==db){ka.next=25;break}ka.next=14;return this.world().editListPrompt("choose and edit eval backends",this.evalbackendChooser.customBackends.map(function(K){return{isListItem:!0,label:[K.coreInterface.description||K.name,{fontSize:"90%"}],value:K}}),{historyId:"js-eval-backend-history"});case 14:ib=ka.sent;Ea=ib.status;W=ib.list;T=nd(ib.selections,1);ia=T[0];if("canceled"!==Ea){ka.next=21;break}return ka.abrupt("return");case 21:this.evalbackendChooser.customBackends=
W;if(ia){ka.next=24;break}return ka.abrupt("return");case 24:db="string"===typeof ia?this.evalbackendChooser.backendWithName(ia):ia;case 25:this.currentBackend=db,this.fit(),120>this.width&&(this.width=120);case 28:case "end":return ka.stop()}},wb,this)}));return function(){return yb.apply(this,arguments)}}()},{key:"ensureSimilarBackend",value:function(){var yb=gd(regeneratorRuntime.mark(function wb(){var Xa,Za,Sb,Cb,Da,zb;return regeneratorRuntime.wrap(function(db){for(;;)switch(db.prev=db.next){case 0:if(this.currentBackendName&&
this.currentBackendName.startsWith("l2l")){db.next=2;break}return db.abrupt("return");case 2:return Xa=this.currentBackend.coreInterface,Za=Xa.targetId,Sb=Xa.peer,db.next=5,this.evalbackendChooser.l2lEvalBackends();case 5:Cb=db.sent;if(!Cb.some(function(ib){return ib.coreInterface.targetId===Za})){db.next=8;break}return db.abrupt("return");case 8:Sb&&Sb.type&&(Da=Cb.find(function(ib){return ib.coreInterface.peer&&ib.coreInterface.peer.type===Sb.type?Sb.user&&Sb.user.name&&ib.coreInterface.peer.user?
ib.coreInterface.peer.user.name===Sb.user.name:!0:!1})),Da&&(zb=$world.focusedMorph,this.currentBackend=Da,zb&&setTimeout(function(){return zb.focus()},0));case 10:case "end":return db.stop()}},wb,this)}));return function(){return yb.apply(this,arguments)}}()},{key:"updateFromTarget",value:function(){this.currentBackend=this.target.systemInterface}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"EvalBackendButton"}},{key:"properties",get:function(){return{currentBackendName:{after:["label"],
defaultValue:"local",set:function(yb){this.setProperty("currentBackendName",yb);var ba=this.currentBackend;this.label=hb.string.truncate(ba&&ba.coreInterface&&ba.coreInterface.description||yb||"local",25)}},currentBackend:{derived:!0,get:function(){return this.evalbackendChooser.backendWithName(this.currentBackendName)},set:function(yb){this.currentBackendName=yb?yb.name:"local"}},evalbackendChooser:{readOnly:!0,derived:!0,get:function(){return hb.EvalBackendChooser["default"]}},extent:{defaultValue:hb.pt(120,
20)},target:{}}}}],ec,{pathInPackage:function(){return"./js/eval-backend-ui.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:501,end:4047})}(hb.Button));hb.EvalBackendButton=cb;hb.EvalBackendButton=cb;cb=Lc("default",function(Hb){var ec=window.lively.FreezerRuntime.recorderFor("lively.ide/js/eval-backend-ui.js"),ub=ec.hasOwnProperty("EvalBackendChooser")&&
"function"===typeof ec.EvalBackendChooser?ec.EvalBackendChooser:ec.EvalBackendChooser=function(yb){if(!yb||!yb[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Pc(ub,Hb,[{key:"customBackends",get:function(){try{var yb=localStorage["lively.morphic-ide/js/EvalBackendChooser-history"];return(yb?JSON.parse(yb):[]).map(function(ba){return ba.startsWith("http")?hb.serverInterfaceFor(ba):null}).filter(Boolean)}catch(ba){}return[]}},
{key:"customBackends",set:function(yb){yb=yb.filter(function(ba){return!!ba&&"local"!==ba&&"edit..."!==ba});try{localStorage["lively.morphic-ide/js/EvalBackendChooser-history"]=JSON.stringify(yb)}catch(ba){}}},{key:"backendWithName",value:function(yb){return yb&&"local"!==yb?yb.startsWith("http")?hb.serverInterfaceFor(yb):yb.startsWith("l2l")?hb.l2lInterfaceFor(yb.split(" ")[1]):hb.localInterface:hb.localInterface}},{key:"httpEvalBackends",get:function(){return[hb.serverInterfaceFor(hb.config.remotes.server)]}},
{key:"l2lEvalBackends",value:function(){var yb=gd(regeneratorRuntime.mark(function wb(){var Xa,Za;return regeneratorRuntime.wrap(function(Sb){for(;;)switch(Sb.prev=Sb.next){case 0:return Xa=hb.L2LClient.forLivelyInBrowser(),Sb.next=3,Xa.listPeers();case 3:return Za=Sb.sent,Za=Za.filter(function(Cb){return Cb.id!==Xa.id}),Sb.next=7,Promise.all(Za.map(function(){var Cb=gd(regeneratorRuntime.mark(function db(zb){return regeneratorRuntime.wrap(function(ib){for(;;)switch(ib.prev=ib.next){case 0:return ib.abrupt("return",
hb.l2lInterfaceFor(zb.id,zb));case 1:case "end":return ib.stop()}},db)}));return function(zb){return Cb.apply(this,arguments)}}()));case 7:return Sb.abrupt("return",Sb.sent);case 8:case "end":return Sb.stop()}},wb)}));return function(){return yb.apply(this,arguments)}}()},{key:"allEvalBackends",value:function(){var yb=gd(regeneratorRuntime.mark(function wb(){return regeneratorRuntime.wrap(function(Xa){for(;;)switch(Xa.prev=Xa.next){case 0:return Xa.t0=hb.arr,Xa.t1=[hb.localInterface],Xa.t2=Fd(this.customBackends),
Xa.t3=Fd(this.httpEvalBackends),Xa.t4=Fd,Xa.next=7,this.l2lEvalBackends();case 7:return Xa.t5=Xa.sent,Xa.t6=(0,Xa.t4)(Xa.t5),Xa.t7=Xa.t1.concat.call(Xa.t1,Xa.t2,Xa.t3,Xa.t6),Xa.abrupt("return",Xa.t0.uniq.call(Xa.t0,Xa.t7));case 11:case "end":return Xa.stop()}},wb,this)}));return function(){return yb.apply(this,arguments)}}()},{key:"buildEvalBackendDropdownFor",value:function(yb,ba){ba=ba||new hb.EvalBackendButton({name:"eval backend button",master:hb.ButtonDefault,fontSize:11,height:20,target:yb});
setTimeout(function(){return ba.updateFromTarget()},0);hb.connect(ba,"currentBackend",this,"changeEvalBackend",{updater:function(wb,Xa){wb(Xa,this.sourceObj.target)}});ba.startStepping(5E3,"ensureSimilarBackend");return ba}},{key:"ensureEvalBackendDropdown",value:function(yb,ba){(ba=yb.getSubmorphNamed("eval backend button"))||(ba=this.buildEvalBackendDropdownFor(yb));return ba}},{key:"changeEvalBackend",value:function(){var yb=gd(regeneratorRuntime.mark(function Za(wb,Xa){return regeneratorRuntime.wrap(function(Sb){for(;;)switch(Sb.prev=
Sb.next){case 0:if(Xa){Sb.next=3;break}console.warn("Called EvalBackendChooser.changeEvalBackend without requester!");return Sb.abrupt("return");case 3:try{wb||(wb=hb.localInterface),Xa.systemInterface!==wb&&(Xa.setStatusMessage("Eval backend is now ".concat(wb.name)),Xa.setEvalBackend(wb)),Xa.focus()}catch(Cb){console.warn("changeEvalBackend error: ".concat(Cb))}case 4:case "end":return Sb.stop()}},Za)}));return function(wb,Xa){return yb.apply(this,arguments)}}()},{key:"activateEvalBackendCommand",
value:function(yb){return{name:"activate eval backend dropdown list",exec:function(){var ba=yb.getSubmorphNamed("eval backend button");ba&&ba.trigger();return!0}}}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"EvalBackendChooser"}},{key:"default",get:function(){return this._default||(this._default=new this)}}],ec,{pathInPackage:function(){return"./js/eval-backend-ui.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:4063,end:8073})}(void 0));hb["default"]=cb}}});
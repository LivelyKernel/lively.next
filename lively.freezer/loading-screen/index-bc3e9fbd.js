System.register(["./__root_module__-39b2be6e.js"],function(wa){var bb,ib,Qb,Ib,ed,qc,pd,uc,Ac,dd,Ad,le,Le,ae,lc,Wc,Ed,Tb,Bd,Sd,hc,mc,Hb,ec,vc,gd,Zc,Za,Xa,jb,Fa,Ea,ka,ja,Ca,mb,Ub,Ya,$a,Ua,U,Ba,K;return{setters:[function(V){bb=V.aO;ib=V.a3;Qb=V.C;Ib=V.ab;ed=V.a8;qc=V.$;pd=V.a7;uc=V.a1;Ac=V.a2;dd=V.aa;Ad=V.aY;le=V.aK;Le=V.av;ae=V.bg;lc=V.aF;Wc=V.ak;Ed=V.bh;Tb=V.aJ;Bd=V.aX;Sd=V.ay;hc=V.ac;mc=V.aN;Hb=V.g;ec=V.aS;vc=V.P;gd=V.bi;Zc=V.aH;Za=V.a6;Xa=V.aG;jb=V.bj;Fa=V.aj;Ea=V.ax;ka=V.aB;ja=V.aw;Ca=V.az;
mb=V.bk;Ub=V.ad;Ya=V.bl;$a=V.aA;Ua=V.bm;U=V.aC;Ba=V.bn;K=V.bb}],execute:function(){function V(Wb){(Wb=na.cachedGuideLines.get(Wb))&&Wb.forEach(function(cb){return cb.remove()})}function ra(Wb,cb,Xb,H,pa){cb=void 0===cb?!0:cb;Xb=void 0===Xb?!0:Xb;H=void 0===H?10:H;pa=void 0===pa?100:pa;if(cb||Xb){var Sa=Wb.owner,rb=Sa.world();Sa=Sa.getGlobalTransform();var Sb=Wb.owner.submorphs.filter(function(Va){return Va!==Wb&&!Va.isEpiMorph&&Va.visible&&Va.reactsToPointer}),Eb=na.findAlignedMorphs(Wb,Sb,H,pa,"left top right bottom hCenter vCenter".split(" "),
"left top right bottom hCenter vCenter".split(" "));pa=[];var Mc=0,Fc=0,xd=0,Ve=0;Sa.e-=rb.scroll.x;Sa.f-=rb.scroll.y;if(Eb){Eb=$jscomp.makeIterator(Eb);for(var Kd=Eb.next();!Kd.done;Kd=Eb.next()){Kd=$jscomp.makeIterator(Kd.value);Kd.next();var fe=Kd.next().value;Kd=fe.vertical;fe=$jscomp.makeIterator(fe.horizontal);for(var ge=fe.next();!ge.done;ge=fe.next()){ge=ge.value;var te=ge.edgeAVal,Kc=ge.refPointsA,ef=ge.refPointsB,Ue=ge.edgeBVal,Se=Math.ceil(H-ge.delta),vf=Math.min(Kc.top,ef.top);Kc=Math.max(Kc.bottom,
ef.bottom);ge.maxDist>H&&(Se-=H/2);Mc<Se&&(Mc=Se,xd=Ue-te);pa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:na.guideWidth,start:Sa.transformPoint(na.pt(Ue,vf)),end:Sa.transformPoint(na.pt(Ue,Kc)),fill:na.guideColor,guideType:"h",priority:Se})}Kd=$jscomp.makeIterator(Kd);for(fe=Kd.next();!fe.done;fe=Kd.next())fe=fe.value,ge=fe.edgeAVal,vf=fe.refPointsA,Kc=fe.refPointsB,te=fe.edgeBVal,Ue=Math.ceil(H-fe.delta),Se=Math.min(vf.left,Kc.left),vf=Math.max(vf.right,Kc.right),fe.maxDist>H&&(Ue-=
H/2),Fc<Ue&&Math.abs(te-ge)<=H&&(Fc=Ue,Ve=te-ge),pa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:na.guideWidth,start:Sa.transformPoint(na.pt(Se,te)),end:Sa.transformPoint(na.pt(vf,te)),fill:na.guideColor,guideType:"v",priority:Ue})}}if(!Mc||!Fc){Sb=[Wb].concat($jscomp.arrayFromIterable(Sb));ge=na.computeClosestMorphs(Sb);fe=ge[0];Sb=fe.l;Eb=fe.r;Kd=fe.t;fe=fe.b;var Df;if(Sb||Eb||Kd||fe){var $b=(Sb||Eb||Kd||fe).refPointsA;for(te=1;te<ge.length&&(Kc=ge[te],Ue=Kc.l,Se=Kc.r,vf=Kc.t,Kc=Kc.b,
Mc||(Sb&&Ue&&Sb.index!==Ue.index&&Math.abs(Ue.dist-Sb.dist)<=H?Df=Object.assign({neighbor:te,direction:"left"},Ue):Eb&&Se&&Eb!==Se.index&&Math.abs(Se.dist-Eb.dist)<=H&&(Df=Object.assign({neighbor:te,direction:"right"},Se))),Fc||(Kd&&vf&&Kd.index!==vf.index&&Math.abs(vf.dist-Kd.dist)<=H?Df=Object.assign({neighbor:te,direction:"top"},vf):fe&&Kc&&fe.index!==Kc.index&&Math.abs(Kc.dist-fe.dist)<=H&&(Df=Object.assign({neighbor:te,direction:"bottom"},Kc))),!Df);te++);}if(Df){var Og=Df;H=Og.direction;vf=
Og.dist;var ph=$b.left;ef=$b.top;var pg=$b.bottom,Je=$b.right,ya=$b.width,Oa=$b.height;Kc=Og.refPointsA;$b=Kc.left;ge=Kc.top;te=Kc.bottom;Ue=Kc.right;Se=Kc.width;Kc=Kc.height;var nb=Og.refPointsB,R=nb.left;Og=nb.top;var xa=nb.bottom;nb=nb.right;Je="left"===H?ph:"right"===H?Je:ph+ya/2;pg="bottom"===H?pg:"top"===H?ef:ef+Oa/2;ph="left"===H?Je-vf:"right"===H?Je+vf:ph+ya/2;vf="bottom"===H?pg+vf:"top"===H?pg-vf:ef+Oa/2;ef="left"===H?nb:"right"===H?R:$b+Se/2;ya="bottom"===H?Og:"top"===H?xa:ge+Kc/2;!Xb||
Mc||"right"!==H&&"left"!==H||(Mc=10,xd=(Df.dist-(Eb||Sb).dist)*("right"===H?-1:1),Je+=xd,ph+=xd);!Xb||Fc||"top"!==H&&"bottom"!==H||(Fc=10,Ve=((Kd||fe).dist-Df.dist)*("top"===H?-1:1),pg+=Ve,vf+=Ve);pa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,start:Sa.transformPoint(na.pt("left"===H?$b:"right"===H?Ue:$b+Se/2,"bottom"===H?te:"top"===H?ge:ge+Kc/2)),end:Sa.transformPoint(na.pt(ef,ya)),fill:na.Color.orange,height:na.guideWidth,guideType:H,priority:10},{type:"line",epiMorph:!0,hasFixedPosition:!0,
start:Sa.transformPoint(na.pt(Je,pg)),end:Sa.transformPoint(na.pt(ph,vf)),fill:na.Color.orange,height:na.guideWidth,guideType:H,priority:10})}}Xb&&(xd||Ve)&&Wb.moveBy(na.pt(xd,Ve));if(cb){pa=pa.filter(function(Va){var eb=Va.guideType;Va=Va.priority;return"h"===eb?Va===Mc:"v"===eb?Va===Fc:!0});(cb=na.cachedGuideLines.get(Wb))||na.cachedGuideLines.set(Wb,cb=[]);for(Xb=0;Xb<pa.length;Xb++)Df=void 0,cb[Xb]?Df=Object.assign(cb[Xb],pa[Xb]):(Df=na.morph(pa[Xb]),cb.push(Df)),Df.owner||rb.addMorph(Df);cb.slice(Xb).forEach(function(Va){return Va.remove()});
na.fun.debounceNamed(Wb.id+"-drag-guides-cleanup",1300,function(){var Va=na.cachedGuideLines.get(Wb);Va&&Va.forEach(function(eb){return eb.remove()})})()}}}function Ja(Wb,cb,Xb,H,pa,Sa){Xb=void 0===Xb?!0:Xb;H=void 0===H?!0:H;pa=void 0===pa?5:pa;Sa=void 0===Sa?100:Sa;if(Xb||H){var rb=Wb.owner,Sb=rb.world(),Eb=rb.getGlobalTransform(),Mc=Wb.owner.submorphs.filter(function(pg){return pg!==Wb&&!pg.isEpiMorph&&pg.visible&&pg.reactsToPointer});rb=(cb.includes("left")||cb.includes("right")?"x":"")+(cb.includes("top")||
cb.includes("bottom")?"y":"");var Fc=na.findMorphsWithSimilarWidthOrHeight(Wb,rb,Mc,pa,Sa),xd=-Infinity,Ve=-Infinity,Kd=0,fe=0,ge=0,te=0,Kc=0,ef=0;rb=[];Eb.e-=Sb.scroll.x;Eb.f-=Sb.scroll.y;if(Fc){Fc=$jscomp.makeIterator(Fc);for(var Ue=Fc.next();!Ue.done;Ue=Fc.next()){Ue=$jscomp.makeIterator(Ue.value);Ue.next();var Se=Ue.next().value;Ue=Se.similarIn;var vf=Se.delta,Df=Se.refPointsA,$b=Se.refPointsB;Se=pa-vf+(Sa-Se.minDist);"width"===Ue?xd<Se&&(xd=Se,cb.includes("left")&&(fe=-vf),cb.includes("right")&&
(Kd=vf)):Ve<Se&&(Ve=Se,cb.includes("top")&&(ge=-vf),cb.includes("bottom")&&(te=vf));vf={type:"line",epiMorph:!0,hasFixedPosition:!0,height:na.guideWidth,fill:na.guideColor,guideType:Ue,priority:Se,start:Eb.transformPoint("width"===Ue?na.pt(Df.left,Df.top+Df.height/2):na.pt(Df.left+Df.width/2,Df.top)),end:Eb.transformPoint("width"===Ue?na.pt(Df.right,Df.top+Df.height/2):na.pt(Df.left+Df.width/2,Df.bottom))};Ue=Object.assign({},vf,{start:Eb.transformPoint("width"===Ue?na.pt($b.left,$b.top+$b.height/
2):na.pt($b.left+$b.width/2,$b.top)),end:Eb.transformPoint("width"===Ue?na.pt($b.right,$b.top+$b.height/2):na.pt($b.left+$b.width/2,$b.bottom))});rb.push(vf,Ue)}}if(Sa=na.findAlignedMorphs(Wb,Mc,pa,Sa,cb,void 0))for(Sa=$jscomp.makeIterator(Sa),Mc=Sa.next();!Mc.done;Mc=Sa.next()){Mc=$jscomp.makeIterator(Mc.value);Mc.next();Fc=Mc.next().value;Mc=Fc.vertical;Fc=$jscomp.makeIterator(Fc.horizontal);for(Ue=Fc.next();!Ue.done;Ue=Fc.next()){Ue=Ue.value;$b=Ue.edgeAVal;var Og=Ue.refPointsA,ph=Ue.refPointsB;
vf=Ue.edgeBVal;Df=Math.ceil(pa-Ue.delta);Se=Math.min(Og.top,ph.top);Og=Math.max(Og.bottom,ph.bottom);Ue.maxDist>pa&&(Df-=pa/2);Kc<Df&&(Kc=Df,cb.includes("left")&&(fe=-(vf-$b)),cb.includes("right")&&(Kd=+(vf-$b)));rb.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:na.guideWidth,start:Eb.transformPoint(na.pt(vf,Se)),end:Eb.transformPoint(na.pt(vf,Og)),fill:na.guideColor,guideType:"h",priority:Df})}Mc=$jscomp.makeIterator(Mc);for(Fc=Mc.next();!Fc.done;Fc=Mc.next())Fc=Fc.value,Ue=Fc.edgeAVal,
Se=Fc.refPointsA,Og=Fc.refPointsB,$b=Fc.edgeBVal,vf=Math.ceil(pa-Fc.delta),Df=Math.min(Se.left,Og.left),Se=Math.max(Se.right,Og.right),Fc.maxDist>pa&&(vf-=pa/2),ef<vf&&Math.abs($b-Ue)<=pa&&(ef=vf,cb.includes("top")&&(ge=$b-Ue),cb.includes("bottom")&&(te=$b-Ue)),rb.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:na.guideWidth,start:Eb.transformPoint(na.pt(Df,$b)),end:Eb.transformPoint(na.pt(Se,$b)),fill:na.guideColor,guideType:"v",priority:vf})}H&&(fe&&(Wb.left+=fe,Wb.right-=fe),ge&&(Wb.top+=
ge,Wb.bottom-=ge),Kd&&(Wb.width+=Kd),te&&(Wb.height+=te));if(Xb){rb=rb.filter(function(pg){var Je=pg.guideType;pg=pg.priority;return"width"===Je?pg===xd:"height"===Je?pg===Ve:"v"===Je?pg===ef:"h"===Je?pg===Kc:!1});(cb=na.cachedGuideLines.get(Wb))||na.cachedGuideLines.set(Wb,cb=[]);for(Xb=0;Xb<rb.length;Xb++)H=void 0,cb[Xb]?H=Object.assign(cb[Xb],rb[Xb]):(H=na.morph(rb[Xb]),cb.push(H)),H.owner||Sb.addMorph(H);cb.slice(Xb).forEach(function(pg){return pg.remove()});na.fun.debounceNamed(Wb.id+"-drag-guides-cleanup",
1300,function(){var pg=na.cachedGuideLines.get(Wb);pg&&pg.forEach(function(Je){return Je.remove()})})()}}}function hb(Wb,cb){cb=void 0===cb?!1:cb;var Xb=oa.MorphicEnv.default().world;if(null===Wb||void 0===Wb)Wb=String(Wb);if(Wb.isMorph)return oa.showRect(Wb.world(),Wb.globalBounds().translatedBy(Xb.scroll.negated()),cb);if(Wb.isPoint)return oa.showRect(Xb,new oa.Rectangle(Wb.x-5,Wb.y-5,10,10));if(Wb.isLine)return oa.showLine(Xb,Wb);if(Wb.isRectangle)return oa.showRect(Xb,Wb);if("undefined"!==typeof oa.Element&&
Wb instanceof oa.Element)return oa.showRect(Xb,oa.Rectangle.fromElement(Wb));if("number"===typeof Wb||"symbol"===typeof Wb||"boolean"===typeof Wb||"undefined"!==typeof oa.Node&&Wb instanceof oa.Node||Wb instanceof RegExp)Wb=String(Wb);"object"===typeof Wb&&(Wb=oa.obj.inspect(Wb,{maxDepth:1}));return"string"===typeof Wb&&1===arguments.length?Xb.setStatusMessage(Wb):Xb.setStatusMessage(oa.string.formatFromArray(Array.from(arguments)))}function dc(Wb,cb,Xb){Xb=void 0===Xb?3E3:Xb;var H,pa,Sa,rb,Sb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Eb){if(1==
Eb.nextAddress){if(!(Wb&&Wb.world()&&cb&&cb.world()))return Eb.return(null);H=Wb.owner.worldPoint(Wb.center);pa=cb.owner.worldPoint(cb.center);Sa=H.lineTo(pa).sampleN(2)[1];rb={tagName:"marker",markerHeight:5,markerWidth:5,orient:"auto",refX:1,refY:5,viewBox:"0 0 10 10",children:[{tagName:"circle",stroke:oa.Color.red,fill:oa.Color.red,cx:5,cy:5,r:4}]};Sb=$world.addMorph(new oa.Path({position:Sa,renderOnGPU:!0,vertices:[oa.pt(0),oa.pt(0)],borderWidth:2,startMarker:rb,endMarker:rb,borderColor:oa.Color.red}));
return Eb.yield(Sb.whenRendered(),2)}if(3!=Eb.nextAddress)return Eb.yield(Sb.animate({opacity:1,customTween:function(Mc){var Fc=Sb.center;Sb.vertices=[oa.pt(0).interpolate(Mc,H.subPt(Sa)),oa.pt(0).interpolate(Mc,pa.subPt(Sa))];Sb.center=Fc},duration:400}),3);Xb&&setTimeout(function(){return Sb.fadeOut()},Xb);return Eb.return(Sb)})}wa({a:ra,d:dc,r:V,s:hb});var na=lively.FreezerRuntime.recorderFor("lively.halos/drag-guides.js");na.removeSnapToGuidesOf=V;na.showAndSnapToGuides=ra;na.showAndSnapToResizeGuides=
Ja;na.computeRefPoints=function(Wb){var cb=Wb.x,Xb=Wb.y,H=Wb.width;Wb=Wb.height;return{left:cb,top:Xb,hCenter:cb+H/2,vCenter:Xb+Wb/2,right:cb+H,bottom:Xb+Wb,width:H,height:Wb}};na.findEdgesInAlignment=function(Wb,cb,Xb,H,pa,Sa,rb,Sb,Eb,Mc){Xb=void 0===Xb?15:Xb;Sa=void 0===Sa?0:Sa;rb=void 0===rb?0:rb;Sb=void 0===Sb?0:Sb;Eb=void 0===Eb?0:Eb;Mc=void 0===Mc?0:Mc;for(var Fc=[],xd=[],Ve=0;Ve<na.edges.length;Ve++){var Kd=$jscomp.makeIterator(na.edges[Ve]),fe=Kd.next().value,ge=Kd.next().value;Kd=Kd.next().value;
var te=Wb[ge],Kc=cb[Kd],ef=Math.max(te,Kc)-Math.min(te,Kc);ef>Xb||!(H&&!H.includes(ge)||pa&&!pa.includes(Kd))&&("vertical"===fe?Fc:xd).push({delta:ef,edgeA:ge,edgeB:Kd,edgeAVal:te,edgeBVal:Kc,refPointsA:Wb,refPointsB:cb,distLeft:Sa,distTop:rb,distRight:Sb,distBottom:Eb,maxDist:Mc})}return Fc.length||xd.length?{vertical:Fc,horizontal:xd}:null};na.findAlignedMorphs=function(Wb,cb,Xb,H,pa,Sa){Xb=void 0===Xb?15:Xb;H=void 0===H?Infinity:H;for(var rb,Sb=na.computeRefPoints(Wb.bounds()),Eb=0;Eb<cb.length;Eb++){var Mc=
cb[Eb];if(Mc!==Wb){var Fc=na.computeRefPoints(Mc.bounds()),xd=Math.max(0,Sb.left-Fc.right),Ve=Math.max(0,Fc.left-Sb.right),Kd=Math.max(0,Sb.top-Fc.bottom),fe=Math.max(0,Fc.top-Sb.bottom);Math.max(fe,Kd,Ve,xd)>H||!(Fc=na.findEdgesInAlignment(Sb,Fc,Xb,pa,Sa,xd,Kd,Ve,fe,Math.max(fe,Kd,Ve,xd)))||(rb||(rb=new Map),rb.set(Mc,Fc))}}Wb=Wb.owner;cb=na.computeRefPoints(Wb.innerBounds());if(Xb=na.findEdgesInAlignment(Sb,cb,Xb))rb||(rb=new Map),rb.set(Wb,Xb);return rb};na.findMorphsWithSimilarWidthOrHeight=function(Wb,
cb,Xb,H,pa){H=void 0===H?15:H;pa=void 0===pa?Infinity:pa;for(var Sa,rb=na.computeRefPoints(Wb.bounds()),Sb=0;Sb<Xb.length;Sb++){var Eb=Xb[Sb];if(Eb!==Wb){var Mc=na.computeRefPoints(Eb.bounds()),Fc=Math.max(0,rb.left-Mc.right),xd=Math.max(0,Mc.left-rb.right),Ve=Math.max(0,rb.top-Mc.bottom),Kd=Math.max(0,Mc.top-rb.bottom),fe=Math.min(Kd,Ve,xd,Fc),ge=Math.max(Kd,Ve,xd,Fc);if(!(Math.max(Kd,Ve,xd,Fc)>pa)){xd=rb;Fc=xd.width;xd=xd.height;Kd=Mc;Ve=Kd.width;Kd=Kd.height;var te=Ve-Fc,Kc=Kd-xd;("x"===cb||"xy"===
cb)&&Math.abs(te)<=H&&(Sa||(Sa=new Map),Sa.set(Eb,{similarIn:"width",minDist:fe,maxDist:ge,refPointsA:rb,refPointsB:Mc,valA:Fc,valB:Ve,delta:te}));("y"===cb||"xy"===cb)&&Math.abs(Kc)<=H&&(Sa||(Sa=new Map),Sa.set(Eb,{similarIn:"height",minDist:fe,maxDist:ge,refPointsA:rb,refPointsB:Mc,valA:xd,valB:Kd,delta:Kc}))}}}return Sa};na.closest=function(Wb,cb,Xb,H,pa,Sa,rb,Sb){Sb=void 0===Sb?!0:Sb;var Eb=H[Wb],Mc=pa[Wb],Fc=Sa[Wb];cb=rb[Wb];for(var xd,Ve,Kd,fe,ge=0;ge<pa.length;ge++)Wb===ge||Eb<pa[ge]||xd&&
pa[xd.index]>=pa[ge]||Sb&&rb[Wb]<Sa[ge]||Sa[Wb]>rb[ge]||(xd={index:ge,dist:Eb-pa[ge],refPointsA:Xb[Wb],refPointsB:Xb[ge]});for(Eb=0;Eb<H.length;Eb++)Wb===Eb||Mc>H[Eb]||Ve&&H[Ve.index]<=H[Eb]||Sb&&rb[Wb]<Sa[Eb]||Sa[Wb]>rb[Eb]||(Ve={index:Eb,dist:H[Eb]-Mc,refPointsA:Xb[Wb],refPointsB:Xb[Eb]});for(Mc=0;Mc<rb.length;Mc++)Wb===Mc||Fc<rb[Mc]||Kd&&rb[Kd.index]>=rb[Mc]||Sb&&H[Wb]>pa[Mc]||pa[Wb]<H[Mc]||(Kd={index:Mc,dist:Fc-rb[Mc],refPointsA:Xb[Wb],refPointsB:Xb[Mc]});for(rb=0;rb<Sa.length;rb++)Wb===rb||cb>
Sa[rb]||fe&&Sa[fe.index]<=Sa[rb]||Sb&&H[Wb]>pa[rb]||pa[Wb]<H[rb]||(fe={index:rb,dist:Sa[rb]-cb,refPointsA:Xb[Wb],refPointsB:Xb[rb]});return{l:xd,r:Ve,t:Kd,b:fe}};na.computeClosestMorphs=function(Wb){for(var cb=[],Xb=[],H=[],pa=[],Sa=[],rb=[],Sb=0;Sb<Wb.length;Sb++){var Eb=na.computeRefPoints(Wb[Sb].bounds());Sa.push(Eb);var Mc=Eb.right,Fc=Eb.top,xd=Eb.bottom;cb.push(Eb.left);Xb.push(Mc);H.push(Fc);pa.push(xd)}for(Sb=0;Sb<Wb.length;Sb++)rb.push(na.closest(Sb,Wb,Sa,cb,Xb,H,pa));return rb};na.fun=bb;
na.pt=ib;na.Color=Qb;na.morph=Ib;na.cachedGuideLines=new WeakMap;na.guideWidth=1;na.guideColor=na.Color.orange.lighter();na.removeSnapToGuidesOf=V;na.removeSnapToGuidesOf=V;na.showAndSnapToGuides=ra;na.showAndSnapToGuides=ra;na.showAndSnapToResizeGuides=Ja;na.showAndSnapToResizeGuides=Ja;na.edges=[["vertical","top","top"],["vertical","vCenter","top"],["vertical","bottom","top"],["vertical","top","vCenter"],["vertical","vCenter","vCenter"],["vertical","bottom","vCenter"],["vertical","top","bottom"],
["vertical","vCenter","bottom"],["vertical","bottom","bottom"],["horizontal","left","left"],["horizontal","hCenter","left"],["horizontal","right","left"],["horizontal","left","hCenter"],["horizontal","hCenter","hCenter"],["horizontal","right","hCenter"],["horizontal","left","right"],["horizontal","hCenter","right"],["horizontal","right","right"]];var oa=lively.FreezerRuntime.recorderFor("lively.halos/markers.js");oa.show=hb;oa.showRect=function(Wb,cb,Xb){var H=oa.BoundsMarker.highlightBounds(cb);
return Xb?oa.showInLoop(Wb,H,cb):oa.showThenHide(Wb,H)};oa.showInLoop=function(Wb,cb,Xb){var H;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pa){switch(pa.nextAddress){case 1:return oa.showThenHide(Wb,cb,!1),pa.yield(oa.promise.delay(300),2);case 2:H=!1,oa.once(Wb,"onMouseDown",function(){return H=!0}),oa.once(Wb,"hideMarkers",function(){return H=!0});case 3:if(H){pa.jumpTo(4);break}return pa.yield(cb.retract(Xb),3);case 4:cb.fadeOut(2E3),pa.jumpToEnd()}})};oa.showThenHide=function(Wb,
cb,Xb){Xb=void 0===Xb?3:Xb;if(Wb){var H=Array.isArray(cb)?cb:[cb];H.forEach(function(pa){return Wb.addMorph(pa)});Xb&&setTimeout(function(){return H.forEach(function(pa){return pa.fadeOut(2E3)})},1E3*Xb);return cb}};oa.showLine=function(Wb,cb,Xb){Xb=void 0===Xb?3E3:Xb;var H=cb.start;cb=cb.end.subPt(H);var pa=Wb.addMorph({position:H,rotation:cb.theta(),border:{width:1,color:oa.Color.red},width:cb.fastR(),height:0});Xb&&setTimeout(function(){return pa.fadeOut()},Xb);return pa};oa.showConnector=dc;oa.obj=
ed;oa.promise=qc;oa.string=pd;oa.pt=ib;oa.Color=Qb;oa.Rectangle=uc;oa.rect=Ac;oa.morph=Ib;oa.easings=dd;oa.Path=Ad;oa.Icon=le;oa.Morph=Le;oa.MorphicEnv=ae;oa.connect=lc;oa.once=Wc;oa.disconnect=Ed;oa.show=hb;oa.show=hb;(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Xb=cb.hasOwnProperty("BoundsMarker")&&"function"===typeof cb.BoundsMarker?cb.BoundsMarker:cb.BoundsMarker=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Xb,Wb,[{key:Symbol.for("lively-instance-initialize"),value:function(){Tb._get(Object.getPrototypeOf(Xb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{borderWidth:0,fill:oa.Color.transparent,reactsToPointer:!1,hasFixedPosition:!0})}},{key:"isEpiMorph",get:function(){return!0}},{key:"markerLength",value:function(H){H=H.insetBy(-2);H=Math.min(H.width,H.height);return Math.max(4,Math.floor(10>H/10?H/2-5:H/10))}},{key:"createMarkerEdge",value:function(){return oa.morph({fill:oa.Color.red,
reactsToPointer:!1,borderRadius:10})}},{key:"ensureMarkerCorners",value:function(){var H=this.topLeftH||(this.topLeftH=this.addMorph(this.createMarkerEdge())),pa=this.topLeftV||(this.topLeftV=this.addMorph(this.createMarkerEdge())),Sa=this.topRightH||(this.topRightH=this.addMorph(this.createMarkerEdge())),rb=this.topRightV||(this.topRightV=this.addMorph(this.createMarkerEdge())),Sb=this.bottomRightH||(this.bottomRightH=this.addMorph(this.createMarkerEdge())),Eb=this.bottomRightV||(this.bottomRightV=
this.addMorph(this.createMarkerEdge())),Mc=this.bottomLeftH||(this.bottomLeftH=this.addMorph(this.createMarkerEdge())),Fc=this.bottomLeftV||(this.bottomLeftV=this.addMorph(this.createMarkerEdge()));return[H,pa,Sa,rb,Sb,Eb,Mc,Fc]}},{key:"alignWithMorph",value:function(H){return this.alignWithBounds(H.globalBounds().translatedBy($world.scroll.negated()))}},{key:"alignWithBounds",value:function(H){this.alignWithRect(H.insetBy(-20));return this.alignWithRect(H,!0)}},{key:"alignWithRect",value:function(H,
pa){var Sa=this.ensureMarkerCorners(),rb=this.markerLength(H),Sb=[H.topLeft().addXY(0,0).extent(oa.pt(rb,5)),H.topLeft().addXY(0,0).extent(oa.pt(5,rb)),H.topRight().addXY(-rb,0).extent(oa.pt(rb,5)),H.topRight().addXY(-5,0).extent(oa.pt(5,rb)),H.bottomRight().addXY(-5,-rb).extent(oa.pt(5,rb)),H.bottomRight().addXY(-rb,-5).extent(oa.pt(rb,5)),H.bottomLeft().addXY(0,-5).extent(oa.pt(rb,5)),H.bottomLeft().addXY(0,-rb).extent(oa.pt(5,rb))];Sa.forEach(function(Eb,Mc){return Eb.setBounds(Sb[Mc])});pa&&(this.adjustOrigin(H.center()),
this.opacity=0,this.scale=1.5,this.animate({opacity:1,scale:1,duration:300}));return this}},{key:"retract",value:function(H){var pa=this,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){if(1==rb.nextAddress)return rb.yield(pa.animate({scale:Math.max(30/H.width,1.05)}),2);Sa=pa.center;return rb.yield(pa.animate({center:Sa,scale:1,duration:300,easing:oa.easings.inOutExpo}),0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BoundsMarker"}},{key:"highlightMorph",value:function(H){return(new this).alignWithMorph(H)}},
{key:"highlightBounds",value:function(H){return(new this).alignWithBounds(H)}}],cb,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:2323,end:6E3})})(oa.Morph);var wb=wa("S",function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Xb=cb.hasOwnProperty("StatusMessage")&&
"function"===typeof cb.StatusMessage?cb.StatusMessage:cb.StatusMessage=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"relayout",value:function(){this.title=oa.string.truncate(this.message,(this.width/15).toFixed(),"...")}},{key:"isEpiMorph",value:function(){return!0}},{key:"isStatusMessage",value:function(){return!0}},{key:"setMessage",value:function(H,pa){this.message=H;this.color=pa}},{key:"slideTo",
value:function(H){var pa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){if(1==Sa.nextAddress)return pa.sliding=pa.animate({position:H,duration:500}),Sa.yield(pa.sliding,2);pa.sliding=!1;Sa.jumpToEnd()})}},{key:"expand",value:function(){var H=this,pa,Sa,rb,Sb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Eb){if(1==Eb.nextAddress)return H.expandable?H.sliding?Eb.yield(H.sliding,2):Eb.jumpTo(2):Eb.return();pa=H.world();if(!pa||H.isMaximized)return Eb.return();H.isMaximized=
!0;H.stayOpen=!0;Sa=H.getSubmorphNamed("message text");Sa.lineWrapping=!1;Object.assign(Sa,{clipMode:"auto",fixedWidth:!0,selectable:!0});H.expandedContent&&(Sa.value=H.expandedContent);Sa.fit();rb=Sa.textBounds().extent();Sb=pa.visibleBounds();rb.y>Sb.extent().y&&(rb.y=Sb.extent().y-20);rb.x>Sb.extent().x&&(rb.x=Sb.extent().x-20);rb=H.extent.maxPt(rb);H.animate({extent:rb,center:Sb.center(),duration:200});H.relayout();H.focus();Eb.jumpToEnd()})}},{key:"fit",value:function(){var H=this.getSubmorphNamed("message text");
H&&(this.extent=oa.pt(100,35).maxPt(H.textBounds().extent()),this.relayout())}},{key:"focus",value:function(){var H=this.getSubmorphNamed("message text");H&&H.focus()}},{key:"onMouseUp",value:function(H){this.expand()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessage"}},{key:"properties",get:function(){return{extent:{defaultValue:oa.pt(200,100)},stayOpen:{defaultValue:!1},slidable:{defaultValue:!0},isMaximized:{defaultValue:!1},expandable:{initialize:function(){this.expandable=
!0}},maxLines:{defaultValue:Infinity},name:{defaultValue:"messageMorph"},master:{initialize:function(){this.master={auto:"styleguide://System/message"}}},message:{after:["submorphs","extent"],set:function(H){this.setProperty("message",H);var pa=this.getSubmorphNamed("message text");if(pa){pa.value=H;var Sa=pa.documentEndPosition;Sa.row>this.maxLines&&(pa.replace({start:{row:this.maxLines,column:0},end:Sa},"...\n"),this.expandedContent||(this.expandedContent=H));Sa=pa.documentEndPosition;0!==Sa.column&&
pa.insertText("\n",Sa)}}},title:{isStyleProp:!0,derived:!0,set:function(H){this.getSubmorphNamed("message title").value=H},get:function(){return this.getSubmorphNamed("message title").value}},color:{after:["submorphs"],derived:!0,get:function(){return this.get("message icon").fontColor},set:function(H){this.get("message icon").fontColor=H;this.get("message icon")._parametrizedProps&&(this.get("message icon")._parametrizedProps.fontColor=H)}},submorphs:{after:["extent"],initialize:function(){this.submorphs=
[{name:"message icon",type:"label",value:oa.Icon.textAttribute("check-circle")},{name:"message text",type:"text"},{name:"message title",type:"label"},{name:"close button",type:"button"}];oa.connect(this.getSubmorphNamed("close button"),"fire",this,"remove");oa.connect(this,"extent",this,"relayout")}}}}}],cb,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:6044,end:10373})}(oa.Morph));oa.StatusMessage=wb;oa.StatusMessage=wb;oa.StatusMessage=wb;var fc=wa("b",function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Xb=cb.hasOwnProperty("StatusMessageForMorph")&&"function"===typeof cb.StatusMessageForMorph?cb.StatusMessageForMorph:cb.StatusMessageForMorph=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"alignAtBottomOf",
value:function(H){var pa=this.world();pa&&(this.bringToFront(),this.fit(),this.width=H.bounds().width,this.relayout(),H.world()&&(this.position=H.owner.worldPoint(H.bounds().bottomLeft())),H=pa.visibleBounds(),H=this.bounds().top()+this.height-H.bottom(),0<H&&this.moveBy(oa.pt(0,-H)))}},{key:"onMouseUp",value:function(H){}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessageForMorph"}},{key:"properties",get:function(){return{slidable:{defaultValue:!1},renderOnGPU:{defaultValue:!0},
removeOnTargetMorphChange:{defaultValue:!0},targetMorph:{defaultValue:null,get:function(){var H=this.getProperty("targetMorph");return H&&$world.getMorphWithId(H)},set:function(H){this.setProperty("targetMorph",H?H.id:null);this.alignAtBottomOf(H)}},expandable:{after:["submorphs"],set:function(H){this.setProperty("expandable",H);if(H){var pa=this.getSubmorphNamed("expand button")||this.addMorph({name:"expand button",type:"button"});oa.connect(pa,"fire",this,"expand")}else this.getSubmorphNamed("expand button")&&
(this.getSubmorphNamed("expand button").remove(),oa.disconnect(pa,"fire",this,"expand"))}}}}}],cb,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10598,end:12466})}(oa.StatusMessage));oa.StatusMessageForMorph=fc;oa.StatusMessageForMorph=fc;oa.StatusMessageForMorph=fc;oa.showConnector=dc;oa.showConnector=
dc;var Qa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js");Qa.Morph=Le;Qa.Label=Bd;Qa.HorizontalLayout=Sd;Qa.Path=Ad;Qa.Text=hc;Qa.GridLayout=mc;Qa.morph=Ib;Qa.Icon=le;Qa.createMorphSnapshot=Hb;Qa.Color=Qb;Qa.pt=ib;Qa.rect=Ac;Qa.Rectangle=uc;Qa.LinearGradient=ec;Qa.obj=ed;Qa.PropertyPath=vc;Qa.promise=qc;Qa.properties=gd;Qa.num=Zc;Qa.arr=Za;Qa.connect=lc;Qa.signal=Xa;Qa.disconnect=Ed;Qa.disconnectAll=jb;Qa.once=Wc;Qa.showAndSnapToGuides=ra;Qa.showAndSnapToResizeGuides=Ja;Qa.removeSnapToGuidesOf=
V;Qa.CommentBrowser=Fa;Qa.show=hb;Qa.haloBlue=Qa.Color.rgb(23,160,251);Qa.componentAccent=Qa.Color.magenta;Qa.derivedAccent=Qa.Color.purple;var Lc=function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("Halo")&&"function"===typeof cb.Halo?cb.Halo:cb.Halo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"relayout",value:function(){this.alignWithTarget()}},
{key:"keybindings",get:function(){return[{keys:{mac:"Meta-C",win:"Ctrl-C"},command:{command:"clipboard copy",passEvent:!0}}]}},{key:"commands",get:function(){return[{name:"clipboard copy",doc:"copy selected morph(s) to clipboard",scrollCursorIntoView:!1,exec:function(H){H.copyHalo().copyToClipBoard()}}]}},{key:"removeIfDetached",value:function(){var H=this;setTimeout(function(){H.target.owner||H.remove()})}},{key:"initLayout",value:function(){var H=this.layout=new Qa.GridLayout({autoAssign:!1,fitToCell:!1,
columns:[0,{fixed:36,paddingRight:10},2,{fixed:26},4,{fixed:26},6,{fixed:36,paddingLeft:10}],rows:[0,{fixed:36,paddingBottom:10},2,{fixed:26},4,{fixed:26},6,{fixed:26},7,{fixed:36,paddingTop:10}],grid:[["menu",null,"grab",null,"drag",null,"close"],[null,null,null,null,null,null,null],["copy",null,null,null,null,null,"edit"],[null,null,null,null,null,null,null],["component",null,null,null,null,null,"inspect"],[null,null,null,null,null,null,null],["rotate",null,null,null,null,null,"resize"],[null,"name",
"name","name","name","name",null]]});H.col(1).row(7).group.align="center";H.col(1).row(7).group.resize=!1}},{key:"initButtons",value:function(){this.submorphs=[].concat($jscomp.arrayFromIterable(this.ensureResizeHandles()),$jscomp.arrayFromIterable(this.resizeOnly?[]:[this.closeHalo(),this.dragHalo(),this.grabHalo(),this.menuHalo(),this.inspectHalo(),this.editHalo(),this.copyHalo(),this.componentHalo(),this.rotateHalo(),this.nameHalo(),this.originHalo()]))}},{key:"isEpiMorph",get:function(){return!0}},
{key:"isHaloItem",get:function(){return!0}},{key:"isHalo",get:function(){return!0}},{key:"borderBox",get:function(){return this.getSubmorphNamed("border-box")||this.addMorphBack(Qa.morph({name:"border-box",fill:Qa.Color.transparent,borderColor:this.target.isComponent?Qa.componentAccent:Qa.haloBlue,borderWidth:1}))}},{key:"pointerId",get:function(){return this.state?this.state.pointerId:null}},{key:"pointerId",set:function(H){this.state||(this.state={});this.state.pointerId=H}},{key:"prepareTarget",
value:function(H){if(!Qa.obj.isArray(H))return H;if(1>=H.length)return H[0];H=H[0].world().addMorph(new Qa.MultiSelectionTarget({selectedMorphs:H}));H.alignWithSelection();H.modifiesSelectedMorphs=!0;return H}},{key:"refocus",value:function(H){this.target=H;this.alignWithTarget()}},{key:"alignWithTarget",value:function(H){if((!H||["extent","position","scale","rotation"].includes(H.prop))&&!this.active&&this.target){H=this.target.world()||$world;var pa=H.visibleBounds(),Sa=this.target.globalBounds(),
rb=Sa.insetBy(-36).intersection(pa);pa=Sa.intersection(pa);this.layout&&this.layout.disable();this.setBounds(rb.translatedBy(H.scroll.negated()));this.borderBox.setBounds($world.transformRectToMorph(this,pa));this.state.activeButton?(this.buttonControls.forEach(function(Sb){return Sb.visible=!1}),this.ensureResizeHandles().forEach(function(Sb){return Sb.visible=!1}),this.state.activeButton.visible=!0,this.updatePropertyDisplay(this.state.activeButton)):(this.changingName&&this.nameHalo().toggleActive([!1]),
this.ensureResizeHandles().forEach(function(Sb){return Sb.visible=!0}),this.buttonControls.forEach(function(Sb){Sb.visible=!0}),this.propertyDisplay.disable());this.nameHalo().alignInHalo();this.ensureResizeHandles().forEach(function(Sb){return Sb.alignInHalo()});this.resizeOnly||this.originHalo().alignInHalo();this.layout&&this.layout.enable();return this}}},{key:"detachFromTarget",value:function(){var H=this.target;H&&(Qa.disconnect(H,"onChange",this,"alignWithTarget"),Qa.disconnect(H,"onOwnerChanged",
this,"removeIfDetached"),H instanceof Qa.MultiSelectionTarget?(H.modifiesSelectedMorphs=!1,H.remove()):"function"===typeof H.detachedHalo&&H.detachedHalo(this))}},{key:"remove",value:function(){this.detachFromTarget();Tb._get(Object.getPrototypeOf(Xb.prototype),"remove",this).call(this)}},{key:"morphsContainingPoint",value:function(H){return H}},{key:"propertyDisplay",get:function(){return Qa.HaloPropertyDisplay.for(this)}},{key:"nameHalo",value:function(){return Qa.NameHaloItem.for(this)}},{key:"closeHalo",
value:function(){return Qa.CloseHaloItem.for(this)}},{key:"grabHalo",value:function(){return Qa.GrabHaloItem.for(this)}},{key:"dragHalo",value:function(){return Qa.DragHaloItem.for(this)}},{key:"menuHalo",value:function(){return Qa.MenuHaloItem.for(this)}},{key:"inspectHalo",value:function(){return Qa.InspectHaloItem.for(this)}},{key:"editHalo",value:function(){return Qa.EditHaloItem.for(this)}},{key:"rotateHalo",value:function(){return Qa.RotateHaloItem.for(this)}},{key:"copyHalo",value:function(){return Qa.CopyHaloItem.for(this)}},
{key:"originHalo",value:function(){return Qa.OriginHaloItem.for(this)}},{key:"componentHalo",value:function(){return Qa.ComponentHaloItem.for(this)}},{key:"buttonControls",get:function(){return this.submorphs.filter(function(H){return H.isHaloItem&&!H.isResizeHandle})}},{key:"addMorphToSelection",value:function(H){var pa=this,Sa,rb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sb){if(1==Sb.nextAddress){Sa=pa.world();rb=pa.target.isMorphSelection?pa.target.selectedMorphs:[pa.target];
if(rb.includes(H))return Sb.return();pa.remove();return Sb.yield(Sa.showHaloForSelection([].concat($jscomp.arrayFromIterable(rb),[H]),pa.state.pointerId),2)}return Sb.return(Sb.yieldResult)})}},{key:"removeMorphFromSelection",value:function(H){var pa=this,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){if(1==rb.nextAddress){Sa=pa.world();pa.remove();if(!pa.target.isMorphSelection)return rb.jumpTo(0);Qa.arr.remove(pa.target.selectedMorphs,H);return rb.yield(Sa.showHaloForSelection(pa.target.selectedMorphs,
pa.state.pointerId),3)}return rb.return(rb.yieldResult)})}},{key:"isAlreadySelected",value:function(H){return this.target==H||this.target.isMorphSelection&&this.target.selectsMorph(H)}},{key:"updateBoundsFor",value:function(H,pa,Sa,rb,Sb){var Eb={topLeft:Qa.rect(-1,-1,1,1),topCenter:pa?Qa.rect(1,-1,0,1):Qa.rect(0,-1,0,1),topRight:Qa.rect(0,-1,1,1),rightCenter:pa?Qa.rect(0,1,1,1):Qa.rect(0,0,1,0),bottomRight:Qa.rect(0,0,1,1),bottomCenter:pa?Qa.rect(1,0,0,1):Qa.rect(0,0,0,1),bottomLeft:Qa.rect(-1,0,
1,1),leftCenter:pa?Qa.rect(-1,1,1,0):Qa.rect(-1,0,1,0)}[H];Sb=Eb.x;var Mc=Eb.y,Fc=Eb.width;Eb=Eb.height;Sa=pa?this.proportionalDelta(H,Sa,rb):Sa;H=Qa.rect(Sa.x*Sb,Sa.y*Mc,Sa.x*Fc,Sa.y*Eb);this.active=!0;this.target.setBounds(rb.insetByRect(H));(this.target.isPolygon||this.target.isPath)&&this.target.moveBy(this.target.origin.negated());this.active=!1;this.alignWithTarget();this.world().withTopBarDo(function(xd){if(xd.activeSideBars.includes("Styling Palette"))xd.stylingPalette.onHierarchyChange()})}},
{key:"proportionalDelta",value:function(H,pa,Sa){var rb=Sa.width,Sb=Sa.height;Sa={topLeft:Qa.pt(-1,-1),topCenter:Qa.pt(0,-1),topRight:Qa.pt(1,-1),leftCenter:Qa.pt(-1,0),rightCenter:Qa.pt(1,0),bottomLeft:Qa.pt(-1,1),bottomCenter:Qa.pt(0,1),bottomRight:Qa.pt(1,1)};var Eb=rb/Math.max(rb,Sb),Mc=Sb/Math.max(Sb,rb);rb={topLeft:Qa.pt(-Eb,-Mc),topCenter:Qa.pt(1/(2*Sb/rb),-1),topRight:Qa.pt(Eb,-Mc),leftCenter:Qa.pt(-1,Sb/(2*rb)),rightCenter:Qa.pt(1,Sb/(3*rb)),bottomLeft:Qa.pt(-Eb,Mc),bottomCenter:Qa.pt(1/
(2*Sb/rb),1),bottomRight:Qa.pt(Eb,Mc)};Sa=Sa[H];return rb[H].scaleBy(Sa.dotProduct(pa)/Sa.dotProduct(Sa))}},{key:"ensureResizeHandles",value:function(){return Qa.ResizeHandle.resizersFor(this)}},{key:"updatePropertyDisplay",value:function(H){H=H.valueForPropertyDisplay();"undefined"!==typeof H?this.propertyDisplay.displayProperty(H):this.propertyDisplay.disable()}},{key:"toggleDiagonal",value:function(H,pa){if(!Qa.rect(0).sides.includes(pa)){var Sa=this.getSubmorphNamed("diagonal");if(H){H=this.target.globalBounds();
var rb=H.width,Sb=H.height;H=this.localize(Qa.pt(H.x,H.y)).extent(Qa.pt(rb,Sb)).scaleRectTo(this.innerBounds());rb={topLeft:[Qa.pt(rb,Sb),Qa.pt(0,0)],topRight:[Qa.pt(0,Sb),Qa.pt(rb,0)],bottomRight:[Qa.pt(0,0),Qa.pt(rb,Sb)],bottomLeft:[Qa.pt(rb,0),Qa.pt(0,Sb)]};Sa?Sa.setBounds(H):(Sa=$jscomp.makeIterator(rb[pa]),pa=Sa.next().value,Sa=Sa.next().value,rb=new Qa.LinearGradient({stops:[{offset:0,color:Qa.Color.orange.withA(0)},{offset:.2,color:Qa.Color.orange},{offset:.8,color:Qa.Color.orange},{offset:1,
color:Qa.Color.orange.withA(0)}]}),Sa=this.addMorphBack(new Qa.Path({opacity:0,name:"diagonal",borderStyle:"dotted",borderWidth:5,bounds:H,borderColor:rb,vertices:[pa,Sa]})),Sa.setBounds(H),Sa.animate({opacity:1,duration:500}))}else Sa&&Sa.fadeOut(500)}}},{key:"toggleRotationIndicator",value:function(H,pa){var Sa=this.getSubmorphNamed("rotationIndicator");H&&pa?(H=this.getSubmorphNamed("origin").center,Sa=Sa||this.addMorphBack(new Qa.Path({name:"rotationIndicator",borderColor:Qa.haloBlue,borderWidth:1,
vertices:[]})),Sa.setBounds(pa.bounds().union(this.innerBounds())),Sa.vertices=[Sa.localizePointFrom(H,this),Sa.localizePointFrom(pa.center,this)]):Sa&&Sa.remove()}},{key:"toggleMorphHighlighter",value:function(H,pa,Sa){Sa=void 0===Sa?!1:Sa;if(pa)if(pa.onHaloGrabover)pa.onHaloGrabover(H);else Sa=Qa.MorphHighlighter.for(this,pa,Sa),H&&pa&&pa!=this.world()?Sa&&Sa.show(pa):Sa&&Sa.deactivate()}},{key:"onMouseDown",value:function(H){var pa=H.state.clickedOnMorph;if(!H.isCommandKey()&&pa==this.borderBox)return this.remove();
if(H.isShiftDown()&&H.isCommandKey())H=this.target.isMorphSelection?this.target.morphBeneath(H.position):this.morphBeneath(H.position),this.isAlreadySelected(H)?this.removeMorphFromSelection(H):this.addMorphToSelection(H);else{if(pa==this.borderBox&&H.isCommandKey()){var Sa=H.world.morphsContainingPoint(H.position).filter(function(rb){return rb.halosEnabled});(Sa=Sa.slice(Sa.indexOf(this.target)+1)[0]||Sa[0]||H.world)&&H.world.showHaloFor(Sa,H.domEvt.pointerId);this.remove()}pa==this&&H.isCommandKey()&&
(Sa=this.morphBeneath(H.position),H.world.showHaloFor(Sa,H.domEvt.pointerId));pa==this&&this.remove()}}},{key:"onContextMenu",value:function(H){var pa=this;Promise.resolve($world.defaultMenuItems(this.target)).then(function(Sa){return pa.target.openMenu(Sa,H)}).catch(function(Sa){return $world.logError(Sa)})}},{key:"onKeyUp",value:function(H){this.changingName||this.buttonControls.map(function(pa){return pa.onKeyUp(H)})}},{key:"getMesh",value:function(H,pa){var Sa=H.x;H=H.y;pa=void 0===pa?Qa.pt(0,
0):pa;var rb=this.world().visibleBounds(),Sb=rb.height;rb=rb.width;var Eb={borderStyle:"dotted",borderWidth:2,borderColor:Qa.Color.orange};Eb=this.get("mesh")||this.addMorph(new Qa.Morph({name:"mesh",styleClasses:["halo-mesh"],extent:Qa.pt(rb,Sb),fill:null,submorphs:[new Qa.Path(Object.assign({name:"vertical"},Eb)),new Qa.Path(Object.assign({name:"horizontal"},Eb))]}));Eb.globalPosition=pa;Eb.getSubmorphNamed("vertical").vertices=[Qa.pt(Sa,0).subPt(pa),Qa.pt(Sa,Sb).subPt(pa)];Eb.getSubmorphNamed("horizontal").vertices=
[Qa.pt(0,H).subPt(pa),Qa.pt(rb,H).subPt(pa)];return Eb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Halo"}},{key:"properties",get:function(){return{fill:{defaultValue:Qa.Color.transparent},resizeOnly:{defaultValue:!1},pointerId:{},hasFixedPosition:{defaultValue:!0},respondsToVisibleWindow:{defaultValue:!0},submorphs:{after:["target"],initialize:function(){this.initButtons();this.alignWithTarget()}},layout:{after:["submorphs"],initialize:function(){this.initLayout()}},hasTinyTarget:{derived:!0,
get:function(){return 40>this.target.bounds().extent().dist(Qa.pt(0))}},target:{get:function(){return this.state?this.state.target:null},set:function(H){this.state||(this.state={});var pa=!!this.state.target;this.detachFromTarget();H=this.prepareTarget(H);this.state.target=H;pa&&this.alignWithTarget();Qa.connect(H,"onChange",this,"alignWithTarget");Qa.connect(H,"onOwnerChanged",this,"removeIfDetached")}}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:975,end:17519})}(Qa.Morph);Lc=Qa.Halo;var ld=wa("H",Lc);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("HaloPropertyDisplay")&&"function"===typeof cb.HaloPropertyDisplay?cb.HaloPropertyDisplay:cb.HaloPropertyDisplay=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Xb,Wb,[{key:"isHaloItem",get:function(){return!1}},{key:"halo",get:function(){return this.owner}},{key:"displayedValue",value:function(){return this.textString}},{key:"displayProperty",value:function(H){var pa=this.halo.state.activeButton;H=String(H);this.visible=!0;this.textString=H;this.position=this.constructor.defaultPosition;this.bounds().insetBy(10).intersects(pa.bounds())&&(this.position=Qa.pt(pa.topRight.x+10,this.position.y))}},{key:"disable",value:function(){this.position=
this.constructor.defaultPosition;this.visible=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"HaloPropertyDisplay"}},{key:"morphName",get:function(){return"propertyDisplay"}},{key:"defaultPosition",get:function(){return Qa.pt(25,0)}},{key:"for",value:function(H){return H.getSubmorphNamed(this.morphName)||H.addMorph(new this({name:this.morphName}))}},{key:"properties",get:function(){return{name:{defaultValue:this.name},fill:{defaultValue:Qa.Color.black.withA(.7)},borderRadius:{defaultValue:7},
padding:{defaultValue:Qa.Rectangle.inset(5)},visible:{defaultValue:!1},readOnly:{defaultValue:!0},fontSize:{defaultValue:12},fontColor:{defaultValue:Qa.Color.white},position:{defaultValue:this.defaultPosition}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:17709,end:19047})})(Qa.Label);
(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("MultiSelectionTarget")&&"function"===typeof cb.MultiSelectionTarget?cb.MultiSelectionTarget:cb.MultiSelectionTarget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"isHaloItem",get:function(){return!0}},{key:"isMorphSelection",get:function(){return!0}},{key:"selectsMorph",value:function(H){return this.selectedMorphs.includes(H)}},
{key:"alignWithSelection",value:function(){var H=this.selectedMorphs.map(function(pa){return pa.globalBounds()}).reduce(function(pa,Sa){return pa.union(Sa)});this.setBounds(H)}},{key:"onGrab",value:function(H){this.grabbingHand=H.hand;this.selectionGrabbed=!0;H.hand.grab(this.selectedMorphs);Qa.once(H.hand,"dropMorphsOn",this,"onGrabEnd");Qa.connect(H.hand,"position",this,"alignWithSelection")}},{key:"onGrabEnd",value:function(){this.selectionGrabbed=!1;Qa.disconnectAll(this.grabbingHand)}},{key:"updateExtent",
value:function(H){var pa=H.value.subPt(H.prevValue);this.selectedMorphs.forEach(function(Sa){return Sa.resizeBy(pa)})}},{key:"updatePosition",value:function(H){if(!this.selectionGrabbed){var pa=H.value.subPt(H.prevValue);this.selectedMorphs.forEach(function(Sa){return Sa.moveBy(pa)})}}},{key:"updateRotation",value:function(H){var pa=this,Sa=H.value-H.prevValue;this.selectedMorphs.forEach(function(rb){var Sb=rb.origin;rb.adjustOrigin(rb.localize(pa.worldPoint(Qa.pt(0,0))));rb.rotation+=Sa;rb.adjustOrigin(Sb)})}},
{key:"updateScale",value:function(H){var pa=this,Sa=H.value-H.prevValue;this.selectedMorphs.forEach(function(rb){var Sb=rb.origin;rb.adjustOrigin(rb.localize(pa.worldPoint(Qa.pt(0,0))));rb.scale+=Sa;rb.adjustOrigin(Sb)})}},{key:"onChange",value:function(H){Tb._get(Object.getPrototypeOf(Xb.prototype),"onChange",this).call(this,H);if(this.modifiesSelectedMorphs){switch(H.prop){case "extent":this.updateExtent(H);break;case "scale":this.updateScale(H);break;case "position":this.updatePosition(H);break;
case "rotation":this.updateRotation(H)}return H}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MultiSelectionTarget"}},{key:"properties",get:function(){return{visible:{defaultValue:!1},modifiesSelectedMorphs:{defaultValue:!1},selectedMorphs:{defaultValue:[]},halosEnabled:{defaultValue:!1}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:19115,end:21386})})(Qa.Morph);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("HaloItem")&&"function"===typeof cb.HaloItem?cb.HaloItem:cb.HaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},
{key:"menuItems",value:function(){return[]}},{key:"init",value:function(){}},{key:"update",value:function(){}},{key:"stop",value:function(){}},{key:"valueForPropertyDisplay",value:function(){}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"HaloItem"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:15},nativeCursor:{defaultValue:"pointer"},fill:{defaultValue:Qa.Color.gray.withA(.7)},grabbable:{defaultValue:!1},extent:{defaultValue:Qa.pt(24,24)},halo:{}}}},{key:"for",
value:function(H){return H.getSubmorphNamed(this.morphName)||H.addMorph(new this({halo:H,name:this.morphName}))}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21550,end:22223})})(Qa.Morph);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("NameHolder")&&
"function"===typeof cb.NameHolder?cb.NameHolder:cb.NameHolder=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"onHoverIn",value:function(H){this.highlightOnHover&&this.nameHolder.active&&(this.halo.toggleMorphHighlighter(!0,this.target),this.nameHolder.fontColor=Qa.Color.orange)}},{key:"onHoverOut",value:function(H){this.highlightOnHover&&(this.halo.toggleMorphHighlighter(!1,this.target),this.nameHolder.fontColor=
Qa.Color.darkgray)}},{key:"accept",value:function(){this.target.name!==this.nameHolder.textString&&this.updateName(this.nameHolder.textString)}},{key:"onKeyDown",value:function(H){"Enter"==H.keyCombo?(this.accept(),this.halo.focus(),H.stop()):Tb._get(Object.getPrototypeOf(Xb.prototype),"onKeyDown",this).call(this,H)}},{key:"onMouseUp",value:function(){Qa.signal(this,"active",[!0,this])}},{key:"onMouseDown",value:function(H){this.nameHolder.fontColor=Qa.Color.white;this.halo.toggleMorphHighlighter(!1,
this.target)}},{key:"onKeyUp",value:function(H){H=this.nameHolder.textString;var pa=this.target.owner;this.validName=!pa||!pa.getSubmorphNamed(H)||this.target.name==H;Qa.signal(this,"valid",[this.validName,H])}},{key:"update",value:function(){var H=this;this.nameHolder.textString!==this.target.name&&(this.nameHolder.textString=this.target.name,this.whenRendered().then(function(){return H.nameHolder.fit()}))}},{key:"activate",value:function(){this.nameHolder.readOnly=!1;this.nameHolder.active=!0;this.nameHolder.animate({opacity:1})}},
{key:"deactivate",value:function(){this.nameHolder.readOnly=!0;this.nameHolder.active=!1;this.nameHolder.animate({opacity:.3})}},{key:"updateName",value:function(H){if(!this.forceUniqueName||this.validName)this.target.name=H,Qa.signal(this,"active",[!1,this]),Qa.CommentBrowser.updateName(this.target)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHolder"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Click to edit the morph's name"},draggable:{defaultValue:!1},
fill:{defaultValue:Qa.Color.transparent},forceUniqueName:{defaultValue:!1},halo:{},layout:{after:["nameHolder"],initialize:function(){this.layout=new Qa.HorizontalLayout({resizeContainer:!0,spacing:7})}},nameHolder:{after:["submorphs"],initialize:function(){this.nameHolder=this.addMorph(new Qa.Text({fill:Qa.Color.transparent,fontColor:Qa.Color.white,fontWeight:"bold",active:!0}));Qa.connect(this.nameHolder,"onBlur",this,"accept")}}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:22258,end:24896})})(Qa.Morph);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("NameHaloItem")&&"function"===typeof cb.NameHaloItem?cb.NameHaloItem:cb.NameHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,
[{key:Symbol.for("lively-instance-initialize"),value:function(H){Tb._get(Object.getPrototypeOf(Xb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,H);this.initComponentLink();this.initNameHolders();this.validityIndicator=Qa.Icon.makeLabel("check",{fontColor:Qa.Color.green,fontSize:15,padding:Qa.rect(4,6,4,0)});this.fill=this.halo.target.isComponent?Qa.componentAccent:Qa.haloBlue;this.alignInHalo()}},{key:"initComponentLink",value:function(){var H=this,pa=this.halo.target;if(pa&&
!pa.isMorphSelection&&pa.master){var Sa=pa.master.determineMaster(pa),rb=Sa&&!!Sa.world(),Sb=Sa?pa.master.getWorldUrlFor(Sa):"this project";pa=this.addMorph(Qa.Icon.makeLabel(Sb?"external-link-alt":"exclamation-triangle",{nativeCursor:"pointer",fontColor:Qa.Color.white,padding:Qa.rect(8,0,-8,0),name:"master link",tooltip:"Located in "+Sb}));Sb&&Qa.connect(pa,"onMouseDown",function(){rb?H.showLocalMaster(Sa):window.open(Sb)})}}},{key:"showLocalMaster",value:function(H){var pa;if(pa=H.getWindow())pa.activate(),
pa.minimized&&(pa.minimized=!1);H.show()}},{key:"targets",value:function(){return this.halo.target?this.halo.target.isMorphSelection?this.halo.target.selectedMorphs.map(function(H){return{target:H,highlightOnHover:!0}}):[{target:this.halo.target,highlightOnHover:!1}]:[]}},{key:"initNameHolders",value:function(){var H=this;this.nameHolders=this.targets().map(function(pa){pa=new Qa.NameHolder({halo:H.halo,highlightOnHover:pa.highlightOnHover,target:pa.target});Qa.connect(pa,"active",H,"toggleActive");
Qa.connect(pa,"valid",H,"toggleNameValid");return pa});this.submorphs=[].concat($jscomp.arrayFromIterable(this.submorphs),$jscomp.arrayFromIterable(Qa.arr.interpose(this.nameHolders,{extent:Qa.pt(1,28),fill:Qa.Color.black.withA(.4)})))}},{key:"toggleActive",value:function(H){var pa=$jscomp.makeIterator(H);H=pa.next().value;var Sa=pa.next().value;if(this.halo.changingName!==H){this.halo.changingName=H;if(pa=this.get("master link"))pa.visible=pa.isLayoutable=!H;H?(this.nameHolders.forEach(function(rb){return rb!=
Sa&&rb.deactivate()}),this.borderWidth=3,this.addMorph(this.validityIndicator),this.fill=Qa.Color.darkGray,setTimeout(function(){return Sa.nameHolder.selectAll()})):(this.fill=Qa.haloBlue,this.nameHolders.forEach(function(rb){return rb!=Sa&&rb.activate()}),this.borderWidth=0,this.validityIndicator.remove());this.alignInHalo()}}},{key:"toggleNameValid",value:function(H){var pa=$jscomp.makeIterator(H);H=pa.next().value;pa=pa.next().value;(this.validName=H)?(this.conflictingMorph=null,this.borderColor=
Qa.Color.green,this.validityIndicator.nativeCursor="auto",this.validityIndicator.fontColor=Qa.Color.green,Qa.Icon.setIcon(this.validityIndicator,"check")):(this.conflictingMorph=this.get(pa),this.borderColor=Qa.Color.red,this.validityIndicator.fontColor=Qa.Color.red,this.validityIndicator.nativeCursor="pointer",Qa.Icon.setIcon(this.validityIndicator,"exclamation-circle"))}},{key:"alignInHalo",value:function(){Qa.arr.zip(this.targets(),this.nameHolders).map(function(pa){var Sa=$jscomp.makeIterator(pa);
pa=Sa.next().value.target;Sa=Sa.next().value;Sa.target=pa;Sa.update()});var H=this.halo.innerBounds().bottomCenter().addPt(Qa.pt(0,2));this.topCenter=Qa.pt(Math.max(H.x,30),Math.max(H.y,80))}},{key:"onMouseDown",value:function(H){var pa=this,Sa=this.conflictingMorph;Sa&&(this.halo.toggleMorphHighlighter(!0,Sa),setTimeout(function(){return pa.halo.toggleMorphHighlighter(!1,Sa)},1E3))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHaloItem"}},{key:"morphName",get:function(){return"name"}},
{key:"properties",get:function(){return{borderRadius:{defaultValue:4},fill:{defaultValue:Qa.haloBlue},borderColor:{defaultValue:Qa.Color.green},layout:{initialize:function(){this.layout=new Qa.HorizontalLayout({resizeContainer:!0,spacing:0,align:"center",orderByIndex:!0})}}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:24898,end:29365})})(Qa.HaloItem);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("CloseHaloItem")&&"function"===typeof cb.CloseHaloItem?cb.CloseHaloItem:cb.CloseHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"update",value:function(){var H=this.halo,pa=H.target.owner;pa.undoStart("close-halo");H.target.selectedMorphs?
H.target.selectedMorphs.forEach(function(Sa){return Sa.abandon()}):H.target.abandon();pa.undoStop("close-halo");H.remove()}},{key:"onMouseDown",value:function(H){this.update()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CloseHaloItem"}},{key:"morphName",get:function(){return"close"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["fas","fa-trash"]},draggable:{defaultValue:!1},tooltip:{defaultValue:"Remove this morph from the world"}}}}],cb,{pathInPackage:function(){return"morph.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:29367,end:29994})})(Qa.HaloItem);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("GrabHaloItem")&&"function"===typeof cb.GrabHaloItem?cb.GrabHaloItem:cb.GrabHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Xb,Wb,[{key:"adjustTarget",value:function(H,pa){Qa.PropertyPath("owner.layout.autoResize").get(H)&&!H.globalBounds().insetBy(10).containsPoint(pa)&&(H=H.owner);return H}},{key:"valueForPropertyDisplay",value:function(){var H=this.hand,pa=this.halo,Sa=this.prevDropTarget,rb=H.world(),Sb=H.findDropTarget(H.globalPosition,[pa.target],function(Eb){return!Eb.isHaloItem&&!Eb.ownerChain().some(function(Mc){return Mc.isHaloItem||!Mc.visible||0==Mc.opacity})});if(Sb)return Sb=this.adjustTarget(Sb,
H.globalPosition),pa.toggleMorphHighlighter(Sb&&Sb!=rb,Sb,!0),Sa&&Sa!=Sb&&pa.toggleMorphHighlighter(!1,Sa),(this.prevDropTarget=Sb)&&Sb.name}},{key:"init",value:function(H){var pa=this.halo,Sa=pa.target.undoStart("grab-halo");Sa&&Sa.addTarget(pa.target.owner);this.hand=H;pa.target.onGrab({halo:pa,hand:H,isShiftDown:function(){return!1}});pa.state.activeButton=this;this.opacity=.3;var rb=Qa.connect(H,"update",this,"update");Qa.once(pa.target,"remove",function(){return rb.disconnect()})}},{key:"stop",
value:function(H){var pa=this.halo,Sa=this.prevDropTarget,rb=pa.target.undoInProgress,Sb=H.hand.findDropTarget(H.hand.globalPosition,[pa.target],function(Eb){return!Eb.isHaloItem&&!Eb.ownerChain().some(function(Mc){return Mc.isHaloItem})});Sb=this.adjustTarget(Sb,H.hand.globalPosition);Qa.disconnect(H.hand,"update",this,"update");Qa.MorphHighlighter.interceptDrop(pa,Sb,pa.target);rb.addTarget(Sb);Sb.onDrop(H);pa.state.activeButton=null;pa.alignWithTarget();pa.toggleMorphHighlighter(!1,Sa);Qa.MorphHighlighter.removeHighlighters(pa);
pa.target.undoStop("grab-halo");this.opacity=1}},{key:"update",value:function(){this.halo.alignWithTarget()}},{key:"onDragStart",value:function(H){this.init(H.hand)}},{key:"onDragEnd",value:function(H){this.stop(H)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrabHaloItem"}},{key:"morphName",get:function(){return"grab"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["far","fa-hand-rock"]},tooltip:{defaultValue:"Grab the morph"},draggable:{defaultValue:!0}}}}],
cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:29996,end:32524})})(Qa.HaloItem);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("DragHaloItem")&&"function"===typeof cb.DragHaloItem?cb.DragHaloItem:cb.DragHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"valueForPropertyDisplay",value:function(){return this.halo.target.position}},{key:"updateAlignmentGuide",value:function(H){var pa=this.halo.getSubmorphNamed("mesh");if(H)return pa=this.halo.getMesh(this.halo.target.worldPoint(Qa.pt(0,0))),this.focus(),pa;pa&&pa.remove()}},{key:"init",value:function(){var H=this.halo.target;H.undoStart("drag-halo");this.halo.state.activeButton=this;this.actualPos=H.position;
this.targetTransform=H.owner.getGlobalTransform().inverse()}},{key:"stop",value:function(){this.halo.target.undoStop("drag-halo");this.halo.state.activeButton=null;this.halo.alignWithTarget();this.updateAlignmentGuide(!1);Qa.removeSnapToGuidesOf(this.halo.target)}},{key:"update",value:function(H,pa,Sa){pa=void 0===pa?!1:pa;Sa=void 0===Sa?!1:Sa;this.actualPos=H=this.actualPos.addPt(this.targetTransform.transformDirection(H));pa&&(H=H.griddedBy(Qa.pt(10,10)));this.halo.target.position=H;this.updateAlignmentGuide(pa);
this.world().withTopBarDo(function(rb){if(rb.activeSideBars.includes("Styling Palette"))rb.stylingPalette.onHierarchyChange()});pa||Qa.showAndSnapToGuides(this.halo.target,!0,Sa,5,500)}},{key:"onDragStart",value:function(H){this.init()}},{key:"onDrag",value:function(H){this.update(H.state.dragDelta,H.isAltDown(),H.isCtrlDown())}},{key:"onDragEnd",value:function(H){this.stop()}},{key:"onKeyUp",value:function(H){this.updateAlignmentGuide(!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DragHaloItem"}},
{key:"morphName",get:function(){return"drag"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},styleClasses:{defaultValue:["fas","fa-arrows-alt"]},tooltip:{defaultValue:"Change the morph's position. Press (alt) while dragging to align the morph's position along a grid."}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:32526,end:34524})})(Qa.HaloItem);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("InspectHaloItem")&&"function"===typeof cb.InspectHaloItem?cb.InspectHaloItem:cb.InspectHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"onMouseDown",value:function(H){var pa=this;(function(){var Sa,rb,Sb,Eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){if(1==
Mc.nextAddress)return Mc.yield(System.import("lively.ide/js/inspector.js"),2);Sa=Mc.yieldResult;rb=Sa.default;(Sb=pa.world().getSubmorphsByStyleClassName("Inspector").find(function(Fc){return Fc.targetObject==pa.halo.target}))&&(Eb=Sb.getWindow())?(Eb.minimized=!1,Eb.activate(),Eb.animate({center:pa.world().visibleBounds().center(),duration:200})):rb.openInWindow({targetObject:pa.halo.target});pa.halo.remove();Mc.jumpToEnd()})})()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectHaloItem"}},
{key:"morphName",get:function(){return"inspect"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Inspect the morph's local state"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-cogs"]}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:34526,end:35443})})(Qa.HaloItem);
(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("EditHaloItem")&&"function"===typeof cb.EditHaloItem?cb.EditHaloItem:cb.EditHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"onMouseDown",value:function(H){var pa=this;(H=this.world().getSubmorphsByStyleClassName("ObjectEditor").find(function(Sa){return Sa.target==pa.halo.target}))?(H=H.getWindow(),
H.bringToFront(),H.minimized=!1,H.animate({center:this.world().visibleBounds().center(),duration:200})):$world.execCommand("open object editor",{target:this.halo.target});this.halo.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditHaloItem"}},{key:"morphName",get:function(){return"edit"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Edit the morph's definition"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-wrench"]}}}}],cb,{pathInPackage:function(){return"morph.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:35445,end:36225})})(Qa.HaloItem);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("RotateHaloItem")&&"function"===typeof cb.RotateHaloItem?cb.RotateHaloItem:cb.RotateHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Xb,Wb,[{key:Symbol.for("lively-instance-initialize"),value:function(H){Tb._get(Object.getPrototypeOf(Xb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,H);this.adaptAppearance(!1)}},{key:"angle",get:function(){return this.getProperty("angle")||0}},{key:"angle",set:function(H){this.setProperty("angle",H)}},{key:"scaleGauge",get:function(){return this.getProperty("scaleGauge")||null}},{key:"scaleGauge",set:function(H){this.setProperty("scaleGauge",H)}},{key:"initRotation",
get:function(){return this.getProperty("initRotation")||0}},{key:"initRotation",set:function(H){this.setProperty("initRotation",H)}},{key:"valueForPropertyDisplay",value:function(){var H=this.halo.target;return this.scaleGauge?H.scale.toFixed(4).toString():Qa.num.toDegrees(H.rotation).toFixed(1)+"\u00b0"}},{key:"init",value:function(H){this.detachFromLayout();this.halo.target.undoStart("rotate-halo");this.halo.state.activeButton=this;this.angle=H;this.initRotation=this.halo.target.rotation;this.halo.toggleRotationIndicator(!0,
this)}},{key:"initScale",value:function(H){this.detachFromLayout();this.halo.state.activeButton=this;this.scaleGauge=H.scaleBy(1/this.halo.target.scale);this.halo.toggleRotationIndicator(!0,this)}},{key:"update",value:function(H){this.scaleGauge=null;H=this.initRotation+(H-this.angle);H=Qa.num.toRadians(Qa.num.detent(Qa.num.toDegrees(H),10,45));this.halo.target.rotation=H;this.halo.toggleRotationIndicator(!0,this)}},{key:"updateScale",value:function(H){var pa=this.scaleGauge,Sa=this.halo;pa||(pa=
this.scaleGauge=H.scaleBy(1/Sa.target.scale));this.angle=H.theta();this.initRotation=Sa.target.rotation;Sa.target.scale=Qa.num.detent(H.dist(Qa.pt(0,0))/pa.dist(Qa.pt(0,0)),.1,.5);Sa.toggleRotationIndicator(!0,this)}},{key:"stop",value:function(){this.attachToLayout();this.scaleGauge=null;this.halo.state.activeButton=null;this.halo.alignWithTarget();this.halo.toggleRotationIndicator(!1,this);this.halo.target.undoStop("rotate-halo");this.halo.ensureResizeHandles()}},{key:"adaptAppearance",value:function(H){this.styleClasses=
["fas",H?"fa-search-plus":"fa-redo"];this.tooltip=H?"Scale morph":"Rotate morph"}},{key:"detachFromLayout",value:function(){this.savedLayout=this.halo.layout;this.halo.layout=null}},{key:"attachToLayout",value:function(){this.halo.layout=this.savedLayout}},{key:"onDragStart",value:function(H){this.adaptAppearance(H.isShiftDown());H.isShiftDown()?this.initScale(H.position.subPt(this.halo.target.globalPosition)):this.init(H.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDrag",value:function(H){this.globalPosition=
H.position.addPt(Qa.pt(-10,-10));this.adaptAppearance(H.isShiftDown());H.isShiftDown()?this.updateScale(H.position.subPt(this.halo.target.globalPosition)):this.update(H.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDragEnd",value:function(H){this.adaptAppearance(H.isShiftDown());this.stop()}},{key:"onKeyDown",value:function(H){this.adaptAppearance(H.isShiftDown())}},{key:"onKeyUp",value:function(H){this.adaptAppearance(H.isShiftDown())}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"RotateHaloItem"}},{key:"morphName",get:function(){return"rotate"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:36227,end:39704})})(Qa.HaloItem);Qa.nameNumberRe=/(.+)([0-9]+)$/;(function(Wb){var cb=
lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("ComponentHaloItem")&&"function"===typeof cb.ComponentHaloItem?cb.ComponentHaloItem:cb.ComponentHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"updateComponentIndicator",value:function(){var H=this.world(),pa=this.halo.target;this.halo.remove();H.showHaloFor(pa)}},{key:"checkForDuplicateNamesInHierarchy",value:function(){var H=
this,pa,Sa,rb,Sb,Eb,Mc,Fc,xd,Ve,Kd,fe,ge;return $jscomp.asyncExecutePromiseGeneratorProgram(function(te){switch(te.nextAddress){case 1:pa=H.halo.target;Sa=H.world();rb=[];pa.withAllSubmorphsDoExcluding(function(Kc){Kc!=pa&&rb.push(Kc)},function(Kc){return Kc.master&&Kc!=pa});Sb=Qa.arr.groupBy(rb,function(Kc){return Kc.name});Eb={fontWeight:"normal",fontSize:16};if(!Object.values(Sb).find(function(Kc){return 1<Kc.length})){te.jumpTo(2);break}Mc=Qa.arr.sum(Object.values(Sb).filter(function(Kc){return 1<
Kc.length}).map(function(Kc){return Kc.length}));return te.yield(Sa.confirm(["Ambigous Names in Submorph Hierarchy  ",{}].concat($jscomp.arrayFromIterable(Qa.Icon.textAttribute("exclamation-triangle",{fontColor:Qa.Color.rgb(230,126,34),fontSize:30,lineHeight:"40px"})),["\nThe morph you are about to turn into a component has "+Mc+" morphs within its submorph hierarchy, that have ambigous names. This can lead to incorrect applications of style properties when you create derived instances from this component.\n\n",
Object.assign({},Eb,{textAlign:"left"}),"Usually ambigous names are caused if your component is in some kind of intermittent state, where it already displays an example state or code has run that automatically created interface elements. This can be fixed by resetting the submorphs of this morph, usually by implementing a ",Object.assign({},Eb,{textAlign:"left",fontStyle:"italic"}),"reset()",Object.assign({},Eb,{fontStyle:"italic",fontFamily:"IBM Plex Mono"}),' routine you can invoke to put the morph into some kind of "neutral" state. Alternatively you can go ahead and rename the duplicate morphs to have proper unique names. If you have a hard time giving the conflicting morphs appropriate names, this can be an indication that the component you are declaring is too large, and you need to decompose your component into subcomponents further.',
Object.assign({},Eb,{textAlign:"left",fontStyle:"italic"})]),{width:600,confirmLabel:"PROCEED TO RENAME",rejectLabel:"CANCEL",align:"left"}),3);case 3:if(Fc=te.yieldResult,!Fc)return te.return();case 2:Ve=te.forIn(Sb);case 4:if(null==(xd=Ve.getNext())){te.jumpTo(6);break}if(2>Sb[xd].length){te.jumpTo(4);break}Kd=Sb[xd];case 7:if(!(1<Kd.length)){te.jumpTo(4);break}fe=Kd[0];Qa.show(fe,!0);return te.yield(Sa.prompt(["Name Collision\n",{},"The name of\n",Eb,fe.toString(),Object.assign({},Eb,{fontStyle:"italic",
fontWeight:"bold"}),"\nis not unique within the submorph hierachy of\n",Object.assign({},Eb),pa.name,Object.assign({},Eb,{fontStyle:"italic",fontWeight:"bold"}),"\nThere "+(2<Kd.length?"are "+(Kd.length-1)+" other morphs":"is one other morph")+" with the exact same name located in this component.",Eb," Duplicate names can cause errors when applying styles to derived morphs of this master component, so it is essential that there is no name ambiguity. Please enter a new name for this or the other conflicting morphs:",
Eb],{input:fe.name,lineWrapping:!0,width:500,fontSize:12,rejectLabel:"IGNORE",confirmLabel:"RENAME",errorMessage:"Provided name is not unique",validate:function(Kc){return!Object.keys(Sb).includes(Kc)}}),9);case 9:ge=te.yieldResult;Qa.signal(Sa,"hideMarkers");ge&&(fe.name=ge);if(ge in Sb){te.jumpTo(7);break}else if(!ge){Kd=Qa.arr.rotate(Kd);te.jumpTo(7);break}Qa.arr.remove(Kd,fe);te.jumpTo(7);break;case 6:return te.return(!0)}})}},{key:"onMouseDown",value:function(){var H=this,pa,Sa,rb,Sb,Eb,Mc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fc){switch(Fc.nextAddress){case 1:pa=
H.halo.target;Sa=!pa.isComponent;rb=$world.getAllNamed(pa.name).length;if(!(Sa&&1<rb)){Fc.jumpTo(2);break}return Fc.yield($world.prompt(["Name Conflict\n",{},"The morph's name you are about to turn into a component is already used by "+(rb-1)+" other morph"+(2<rb?"s":"")+". Please enter a ",{fontWeight:"normal"},"unique identifier",{fontStyle:"italic"}," for this component within this project.",{fontWeight:"normal",fontSize:16}],{input:pa.name,lineWrapping:!0,width:400,errorMessage:"Identifier not unique",
validate:function(xd){return 0==$world.getAllNamed(xd).length}}),3);case 3:Sb=Fc.yieldResult;if(!Sb)return Fc.return();pa.name=Sb;case 2:Eb=pa;if(!(Mc=Sa)){Fc.jumpTo(4);break}return Fc.yield(H.checkForDuplicateNamesInHierarchy(),5);case 5:Mc=Fc.yieldResult;case 4:Eb.isComponent=Mc,Sa?Qa.arr.pushIfNotIncluded(pa.world().localComponents,pa):Qa.arr.remove(pa.world().localComponents,pa),H.world()?H.updateComponentIndicator():pa.world().showHaloFor(pa),Fc.jumpToEnd()}})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"ComponentHaloItem"}},{key:"morphName",get:function(){return"component"}},{key:"properties",get:function(){return{tooltip:{get:function(){return this.halo.target.isComponent?"Retract Component":"Turn into Component"}},styleClasses:{initialize:function(){this.styleClasses=this.halo.target.isComponent?["fas","fa-eraser"]:["fas","fa-cube"]}}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:39745,end:45814})})(Qa.HaloItem);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("CopyHaloItem")&&"function"===typeof cb.CopyHaloItem?cb.CopyHaloItem:cb.CopyHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"init",value:function(H){function pa(xd,Ve){return Ve.match(Qa.nameNumberRe)?
Ve.replace(Qa.nameNumberRe,function(Kd,fe,ge){ge||(ge="0");for(Kd=Number(ge);xd.get(fe+ ++Kd););return fe+Kd}):Ve+"1"}var Sa=this.halo,rb=Sa.target,Sb=Sa.world(),Eb=rb instanceof Qa.MultiSelectionTarget;Sa.remove();Qa.connect(H,"update",this,"update");if(Eb){var Mc=Qa.arr.compact(rb.selectedMorphs.map(function(xd){if(xd.canBeCopied())return xd=xd.copy(!0),Sb.addMorph(xd),xd}));Eb=Mc.map(function(xd){xd.name=pa(rb,xd.name);return xd.position});Mc[0].undoStart("copy-halo");Sb.addMorph(Sa);Sa.refocus(Mc);
H.grab(Sa.target);Sa.target.onGrab({halo:Sa,hand:H,isShiftDown:function(){return!1}});Eb.forEach(function(xd,Ve){return Mc[Ve].globalPosition=xd});Sa.alignWithTarget()}else{Eb=rb.globalPosition;var Fc=rb.copy(!0);rb.isComponent&&(Fc.isComponent=!1,Fc.withAllSubmorphsDoExcluding(function(xd){xd!=Fc&&xd.master||delete xd._parametrizedProps},function(xd){return xd.master&&xd!=Fc}),Fc.master=rb);Fc.name=pa(rb,rb.name);Sb.addMorph(Fc);Fc.globalPosition=Eb;Fc.undoStart("copy-halo");H.grab(Fc);Sb.addMorph(Sa);
Sa.visible=!1}}},{key:"stop",value:function(H){var pa=this.halo,Sa=$jscomp.makeIterator(H.grabbedMorphs).next().value,rb=H.findDropTarget(H.globalPosition,[pa.target],function(Eb){return!Eb.isHaloItem&&!Eb.ownerChain().some(function(Mc){return Mc.isHaloItem})}),Sb=pa.target.undoInProgress;Qa.disconnect(H,"update",this,"update");Sb.addTarget(rb);H.dropMorphsOn(rb);pa.target.undoStop("copy-halo");pa.remove();H.world().showHaloFor(Sa)}},{key:"onDragStart",value:function(H){this.init(H.hand)}},{key:"onDragEnd",
value:function(H){this.stop(H.hand)}},{key:"update",value:function(){this.halo.alignWithTarget()}},{key:"copyToClipBoard",value:function(){var H=this,pa,Sa,rb,Sb,Eb,Mc,Fc,xd,Ve,Kd,fe,ge,te,Kc,ef,Ue;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Se){switch(Se.nextAddress){case 1:pa=H;Sa=pa.halo;if(Sa.nameHalo().nameHolders.find(function(vf){return vf.nameHolder===$world.focusedMorph}))return Se.return();rb=Sa.target;Sb=Sa.world();Eb=rb instanceof Qa.MultiSelectionTarget;Mc=rb.globalBounds().topLeft();
Fc=Eb?rb.selectedMorphs:[rb];xd=Fc.filter(function(vf){return!vf.isCommentIndicator}).map(function(vf){return vf.copy(!0)});Ve=[];Kd='<!DOCTYPE html>\n          <html lang="en">\n          <head>\n            <meta charset="utf-8">\n            '+document.querySelector("#lively-morphic-css").outerHTML+"\n          </head>\n          <body>";Sa.remove();Se.setCatchFinallyBlocks(2);fe=$jscomp.makeIterator(xd);ge=fe.next();case 4:if(ge.done)return Kd+="</body></html>",ef=JSON.stringify(Ve),Se.yield(H.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/html",
data:Kd},{type:"application/morphic",data:ef}]),8);te=ge.value;return Se.yield(Qa.createMorphSnapshot(te,{addPreview:!1,testLoad:!1}),7);case 7:Kc=Se.yieldResult;Kc.copyMeta={offset:te.worldPoint(Qa.pt(0,0)).subPt(Mc)};Ve.push(Kc);Kd+=te.renderPreview();ge=fe.next();Se.jumpTo(4);break;case 8:Se.leaveTryBlock(3);break;case 2:return Ue=Se.enterCatchBlock(),Sb.logError(Ue),Se.return();case 3:Sb.addMorph(Sa),Sa.refocus(Fc),Sa.setStatusMessage("copied"),Se.jumpToEnd()}})}},{key:"onMouseUp",value:function(H){var pa=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){H.stop();return Sa.yield(pa.copyToClipBoard(),0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CopyHaloItem"}},{key:"morphName",get:function(){return"copy"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},tooltip:{defaultValue:"Copy morph"},styleClasses:{defaultValue:["far","fa-clone"]}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:45816,end:50201})})(Qa.HaloItem);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("OriginHaloItem")&&"function"===typeof cb.OriginHaloItem?cb.OriginHaloItem:cb.OriginHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,
Wb,[{key:"fill",get:function(){return Qa.Color.white.interpolate(.2,this.borderColorTop)}},{key:"extent",get:function(){return Qa.pt(15,15)}},{key:"tooltip",get:function(){return"Change the morph's origin"}},{key:"computePositionAtTarget",value:function(){return this.halo.localize(this.halo.target.globalPosition)}},{key:"alignInHalo",value:function(){this.visible=!this.halo.hasTinyTarget;this.center=this.computePositionAtTarget()}},{key:"valueForPropertyDisplay",value:function(){return this.halo.target.origin}},
{key:"init",value:function(){this.halo.target.undoStart("origin-halo");this.halo.state.activeButton=this}},{key:"stop",value:function(){this.halo.target.undoStop("origin-halo");this.halo.state.activeButton=null;this.halo.alignWithTarget()}},{key:"update",value:function(H){var pa=this.halo,Sa=pa.target.origin,rb=pa.target.worldPoint(Sa);H=pa.target.localize(rb.addPt(H)).subPt(pa.target.scroll).subPt(Sa);pa.target.adjustOrigin(pa.target.origin.addPt(H))}},{key:"onDragStart",value:function(H){this.init()}},
{key:"onDragEnd",value:function(H){this.stop()}},{key:"onDrag",value:function(H){this.update(H.state.dragDelta)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"OriginHaloItem"}},{key:"morphName",get:function(){return"origin"}},{key:"properties",get:function(){return{borderWidth:{defaultValue:3},nativeCursor:{defaultValue:"-webkit-grab"},draggable:{defaultValue:!0},borderColor:{after:["halo"],initialize:function(){this.borderColor=this.halo.target.isComponent?Qa.componentAccent:Qa.haloBlue}}}}}],
cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:50203,end:51864})})(Qa.HaloItem);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("ResizeHandle")&&"function"===typeof cb.ResizeHandle?cb.ResizeHandle:cb.ResizeHandle=function(H){H&&H[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"valueForPropertyDisplay",value:function(){var H=this.halo.target.extent,pa=H.y;return H.x.toFixed(1)+"x"+pa.toFixed(1)}},{key:"positionInHalo",value:function(){var H=this.halo.borderBox.bounds();this.halo.hasTinyTarget&&(Qa.Rectangle.prototype.sides.includes(this.location)&&(this.visible=!1),H=H.insetBy(-4));return H.partNamed(this.location)}},{key:"alignInHalo",value:function(){this.center=this.positionInHalo();
return this}},{key:"onKeyUp",value:function(H){this.halo.state.activeButton==this&&this.halo.toggleDiagonal(H.isShiftDown(),this.corner)}},{key:"onKeyDown",value:function(H){this.halo.state.activeButton==this&&this.halo.toggleDiagonal(H.isShiftDown(),this.corner)}},{key:"onDragStart",value:function(H){this.init(H.position,H.isShiftDown())}},{key:"onDragEnd",value:function(H){this.stop(H.isShiftDown())}},{key:"onDrag",value:function(H){this.update(H.position,H.isShiftDown(),H.isAltDown(),H.isCtrlDown());
this.focus()}},{key:"init",value:function(H,pa){pa=void 0===pa?!1:pa;var Sa=this.halo.target,rb=Sa.origin,Sb=Sa.position;Sa=Sa.extent;this.startPos=H;this.startBounds=Sb.subPt(rb).extent(Sa);this.startOrigin=this.halo.target.origin;this.savedLayout=this.halo.layout;this.halo.layout=null;this.halo.state.activeButton=this;this.tfm=this.halo.target.getGlobalTransform().inverse();H=this.halo.target.getGlobalTransform().getRotation();this.offsetRotation=Qa.num.toRadians(H%45);this.halo.toggleDiagonal(pa,
this.corner)}},{key:"update",value:function(H,pa,Sa,rb){pa=void 0===pa?!1:pa;Sa=void 0===Sa?!1:Sa;rb=void 0===rb?!1:rb;var Sb=this.corner,Eb=this.tfm;H=this.startPos.subPt(H);Eb=Eb.transformDirection(Qa.pt(H.x,H.y));Sa&&(Eb=Eb.griddedBy(Qa.pt(10,10)));this.halo.updateBoundsFor(Sb,pa,Eb,this.startBounds,this.startOrigin);this.halo.toggleDiagonal(pa,Sb);this.updateAlignmentGuide(Sa);pa=[];Sb=Sb.toLowerCase();Sb.includes("left")&&pa.push("left");Sb.includes("top")&&pa.push("top");Sb.includes("bottom")&&
pa.push("bottom");Sb.includes("right")&&pa.push("right");Qa.showAndSnapToResizeGuides(this.halo.target,pa,!0,rb,5,200)}},{key:"stop",value:function(H){H=this.halo;H.layout=this.savedLayout;H.state.activeButton=null;H.alignWithTarget();H.toggleDiagonal(!1);this.updateAlignmentGuide(!1);Qa.removeSnapToGuidesOf(H.target)}},{key:"updateAlignmentGuide",value:function(H){var pa=this.halo.getSubmorphNamed("mesh");if(H)return H=this.halo.target.extent,H=Qa.pt(H.x%10,H.y%10),pa=this.halo.getMesh(this.globalPosition.addPt(this.extent.scaleBy(.5)),
H),this.focus(),pa;pa&&pa.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ResizeHandle"}},{key:"properties",get:function(){return{corner:{},location:{},draggable:{defaultValue:!0},isResizeHandle:{readOnly:!0,get:function(){return!0}}}}},{key:"getResizeParts",value:function(H){0<H&&(H-=360);H=-8-(H/45).toFixed();0==H&&(H=8);return Qa.arr.zip(Qa.arr.rotate([["topLeft",function(pa){return pa.negated()}],["topCenter",function(pa){return pa.withX(0).negated()}],["topRight",function(pa){return pa.withX(0).negated()}],
["rightCenter",function(pa){return Qa.pt(0,0)}],["bottomRight",function(pa){return Qa.pt(0,0)}],["bottomCenter",function(pa){return Qa.pt(0,0)}],["bottomLeft",function(pa){return pa.withY(0).negated()}],["leftCenter",function(pa){return pa.withY(0).negated()}]],H),[["nwse-resize","topLeft"],["ns-resize","topCenter"],["nesw-resize","topRight"],["ew-resize","rightCenter"],["nwse-resize","bottomRight"],["ns-resize","bottomCenter"],["nesw-resize","bottomLeft"],["ew-resize","leftCenter"]])}},{key:"resizersFor",
value:function(H){var pa=this;if(!H.target)return[];var Sa=H.target.getGlobalTransform().getRotation();return Qa.arr.compact(this.getResizeParts(Sa).map(function(rb){var Sb=$jscomp.makeIterator(rb),Eb=$jscomp.makeIterator(Sb.next().value);rb=Eb.next().value;Eb.next();Eb.next();Eb=$jscomp.makeIterator(Sb.next().value);Sb=Eb.next().value;Eb=Eb.next().value;return pa.for(H,rb,Eb,Sb)})).map(function(rb){return rb.alignInHalo()})}},{key:"for",value:function(H,pa,Sa,rb){var Sb="Resize "+pa;H=H.getSubmorphNamed(Sb)||
new this({name:Sb,halo:H,corner:pa,tooltip:"Resize "+pa,extent:Qa.pt(10,10),borderWidth:1,borderRadius:0,borderColor:H.target.isComponent?Qa.componentAccent:Qa.haloBlue,fill:Qa.Color.white});return Object.assign(H,{nativeCursor:rb,location:Sa})}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:51923,end:57221})})(Qa.HaloItem);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("MenuHaloItem")&&"function"===typeof cb.MenuHaloItem?cb.MenuHaloItem:cb.MenuHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"onMouseDown",value:function(H){var pa=this,Sa,rb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sb){if(1==Sb.nextAddress)return Sa=
pa.halo.target,pa.halo.remove(),Sb.yield(Sa.menuItems(),2);rb=Sb.yieldResult;Sa.world().openMenu(rb).hasFixedPosition=pa.halo.hasFixedPosition;Sb.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MenuHaloItem"}},{key:"morphName",get:function(){return"menu"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},tooltip:{defaultValue:"Opens the morph menu"},styleClasses:{defaultValue:["fas","fa-bars"]}}}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:57223,end:57745})})(Qa.HaloItem);var od=wa("M",function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("MorphHighlighter")&&"function"===typeof cb.MorphHighlighter?cb.MorphHighlighter:cb.MorphHighlighter=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Xb,Wb,[{key:"alignWithHalo",value:function(){this.target&&(this.position=this.halo.localize(this.target.globalBounds().topLeft()),this.halo.isWorld&&(this.position=this.position.subPt(this.halo.scroll)),this.extent=this.target.globalBounds().extent(),this.get("name tag").value=this.target.name,this.get("name tag").topCenter=this.innerBounds().insetBy(-10).bottomCenter())}},{key:"show",value:function(){if(this.target&&this.target.layout&&this.showLayout&&(this.layoutHalo=this.layoutHalo||
this.world().showLayoutHaloFor(this.target,this.pointerId))&&this.layoutHalo.previewDrop){this.visible=!1;this.alignWithHalo();this.halo.get("grab").hand.grabbedMorphs&&this.layoutHalo.previewDrop(this.halo.get("grab").hand.grabbedMorphs);return}this.visible=!0;this.alignWithHalo()}},{key:"handleDrop",value:function(H){this.layoutHalo&&this.layoutHalo.handleDrop(H)}},{key:"deactivate",value:function(){this.layoutHalo&&(this.layoutHalo.remove(),this.layoutHalo=null);this.visible=!1;this.alignWithHalo();
this.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphHighlighter"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},name:{defaultValue:"morphHighlighter"},styleClasses:{defaultValue:["inactive"]},reactsToPointer:{defaultValue:!1},hasFixedPosition:{defaultValue:!0},fill:{defaultValue:Qa.Color.orange.withA(.3)},borderWidth:{defaultValue:2},borderColor:{defaultValue:Qa.Color.orange},halo:{},epiMorph:{defaultValue:!0},isHighlighter:{readOnly:!0,defaultValue:!0},
highlightedSides:{defaultValue:[],set:function(H){var pa=this;this.setProperty("highlightedSides",H);this.submorphs=H.map(function(Sa){return{type:"ellipse",isHaloItem:!0,fill:Qa.Color.orange,center:pa.innerBounds()[Sa]()}});this.addMorph({type:"label",name:"name tag",padding:Qa.Rectangle.inset(5,5,5,5),fontColor:Qa.Color.white,fill:Qa.Color.orange,borderRadius:3});this.alignWithHalo()}},showLayout:{defaultValue:!1},targetId:{},target:{readOnly:!0,derived:!0,get:function(){return(this.world()||this.env.world).getMorphWithId(this.targetId)}}}}},
{key:"removeHighlighters",value:function(H){H=void 0===H?$world:H;var pa=H._morphHighlighters,Sa;for(Sa in pa)pa[Sa].remove();delete H._morphHighlighters}},{key:"for",value:function(H,pa,Sa,rb){Sa=void 0===Sa?!1:Sa;rb=void 0===rb?[]:rb;var Sb=H._morphHighlighters=H._morphHighlighters||{};Qa.properties.forEachOwn(Sb,function(Eb,Mc){return Mc.alignWithHalo()});if(!pa||pa.ownerChain().find(function(Eb){return Eb.isHaloItem}))return null;Sb[pa.id]=Sb[pa.id]||new this({targetId:pa.id,halo:H,showLayout:Sa});
H.addMorph(Sb[pa.id]);Sb[pa.id].highlightedSides=rb;return Sb[pa.id]}},{key:"interceptDrop",value:function(H,pa,Sa){(H=H._morphHighlighters=H._morphHighlighters||{},H[pa.id])&&H[pa.id].handleDrop(Sa)}}],cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:57934,end:61635})}(Qa.Morph));Qa.MorphHighlighter=
od;Qa.MorphHighlighter=od;Qa.MorphHighlighter=od;var Be=wa("I",function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Xb=cb.hasOwnProperty("InteractiveMorphSelector")&&"function"===typeof cb.InteractiveMorphSelector?cb.InteractiveMorphSelector:cb.InteractiveMorphSelector=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:Symbol.for("lively-instance-initialize"),value:function(H,
pa,Sa){H=void 0===H?$world:H;this.controllingMorph=void 0===pa?null:pa;this.possibleTarget=this.morphHighlighter=this.selectorMorph=null;this.world=H;this.filterFn=Sa;this.whenDone=null}},{key:"selectNewTarget",value:function(){this.targetObject=null;var H=Qa.promise.deferred();H.promise.resolve=H.resolve;this.whenDone=H.promise;this.selectorMorph=Qa.Icon.makeLabel("crosshairs",{fontSize:20,hasFixedPosition:!0,epiMorph:!0}).openInWorld();Qa.connect(this.world.firstHand,"position",this,"scanForTargetAt");
Qa.once(this.selectorMorph,"onMouseDown",this,"selectTarget");Qa.once(this.selectorMorph,"onKeyDown",this,"stopSelect");this.selectorMorph.focus();this.scanForTargetAt(this.world.firstHand.position)}},{key:"scanForTargetAt",value:function(){var H=this.world.firstHand.globalPosition;this.selectorMorph.center=H;this.selectorMorph.focus();var pa=this.selectorMorph.morphBeneath(H),Sa,rb=this.possibleTarget,Sb=this.controllingMorph,Eb=this.filterFn,Mc=this.world,Fc=this.morphHighlighter;for(Fc==pa?pa=
Fc.morphBeneath(H):pa&&pa.isEpiMorph&&(pa=pa.morphBeneath(H));pa&&(Sa=[pa].concat($jscomp.arrayFromIterable(pa.ownerChain())).find(function(xd){return!xd.visible}));)pa=Sa=Sa.morphBeneath(H);if(pa&&Eb&&!Eb(pa))for(;pa&&![pa].concat($jscomp.arrayFromIterable(pa.ownerChain())).find(Eb);)pa=pa.morphBeneath(H);!pa||pa==rb||Sb&&pa.ownerChain().includes(Sb.getWindow())||(Fc&&Fc.deactivate(),(this.possibleTarget=rb=pa)&&!rb.isWorld&&(H=this.morphHighlighter=Qa.MorphHighlighter.for(Mc,pa))&&H.show())}},{key:"selectTarget",
value:function(){this.targetObject=this.possibleTarget;this.stopSelect()}},{key:"stopSelect",value:function(){Qa.MorphHighlighter.removeHighlighters(this.world);Qa.disconnect(this.world.firstHand,"position",this,"scanForTargetAt");this.selectorMorph.remove();this.whenDone&&this.whenDone.resolve(this.targetObject)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveMorphSelector"}},{key:"selectMorph",value:function(H,pa,Sa){H=new this(H,pa,Sa);H.selectNewTarget();return H.whenDone}}],
cb,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:61644,end:64399})}(void 0));Qa.InteractiveMorphSelector=Be;Qa.InteractiveMorphSelector=Be;Qa.InteractiveMorphSelector=Be;Qa.default=Lc;var sd=lively.FreezerRuntime.recorderFor("lively.ide/index.js");sd.info="import via sub modules";sd.info=
"import via sub modules";sd.info="import via sub modules";Lc=wa("v",{});sd.valueWidgets=Lc;sd.valueWidgets=Lc;sd.valueWidgets=Lc;var Ze=wa("p",{});sd.popovers=Ze;sd.popovers=Ze;sd.popovers=Ze;var Hf=lively.FreezerRuntime.recorderFor("lively.components/popup.js");Hf.Morph=Le;Hf.VerticalLayout=Ea;Hf.StyleSheet=ka;Hf.Icon=le;Hf.CustomLayout=ja;Hf.Color=Qb;Hf.rect=Ac;Hf.pt=ib;Hf.connect=lc;Hf.Path=vc;Hf.duration=300;sd=wa("P",function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.components/popup.js"),
Xb=cb.hasOwnProperty("Popover")&&"function"===typeof cb.Popover?cb.Popover:cb.Popover=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"relayout",value:function(H){var pa=this.get("body"),Sa=this.get("arrow"),rb=this.get("close button");Sa=Sa.height;H?(pa.animate({topCenter:Hf.pt(0,Sa),duration:200}),rb.animate({topRight:pa.topRight.addXY(8,-8),duration:200})):(pa.topCenter=Hf.pt(0,Sa),rb.topRight=
pa.topRight.addXY(8,-8))}},{key:"close",value:function(){this.fadeOut(300)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Popover"}},{key:"properties",get:function(){return{epiMorph:{defaultValue:!0},hasFixedPosition:{defaultValue:!0},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/popover/light"}}},targetMorph:{derived:!0,after:["submorphs"],defaultValue:{extent:Hf.pt(200,200),fill:Hf.Color.transparent,submorphs:[{name:"placeholder",type:"label",value:"No Target Specified"}]},
get:function(){return this.get("body").submorphs[0]},set:function(H){var pa=this;this.get("body").addMorph(H);this.whenRendered().then(function(){return pa.relayout()})}},submorphs:{initialize:function(){var H=this;this.submorphs=[{type:"polygon",name:"arrow",topCenter:Hf.pt(0,0),borderColor:Hf.Color.transparent,vertices:[Hf.pt(-10,0),Hf.pt(0,-15),Hf.pt(10,0)]},{name:"body"},{name:"close button",type:"button",label:Object.assign(Hf.Icon.makeLabel("times-circle"),{fontSize:18}),tooltip:"close",fill:null,
extent:Hf.pt(16,16),borderColor:Hf.Color.transparent}];var pa=$jscomp.makeIterator(this.submorphs);pa.next();var Sa=pa.next().value;pa=pa.next().value;Hf.connect(pa,"fire",this,"close");Hf.connect(Sa,"extent",this,"relayout",{converter:"() => target.animated"});setTimeout(function(){return H.animated=!0},1E3)}}}}}],cb,{pathInPackage:function(){return"popup.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.components",version:"0.1.0"}}},{start:247,end:2617})}(Hf.Morph));Hf.Popover=sd;Hf.Popover=sd;Hf.Popover=sd;var sc=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js");sc.Morph=Le;sc.TilingLayout=Ca;sc.morph=Ib;sc.Label=Bd;sc.HorizontalLayout=Sd;sc.Icon=le;sc.InputLine=mb;sc.config=Ub;sc.connect=lc;sc.signal=Xa;sc.Color=Qb;sc.LinearGradient=ec;sc.pt=ib;sc.rect=Ac;sc.num=Zc;sc.obj=ed;sc.popovers=Ze;sc.ValueScrubber=Ya;sc.Popover=sd;(function(Wb){var cb=
lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("ContextSensitiveWidget")&&"function"===typeof cb.ContextSensitiveWidget?cb.ContextSensitiveWidget:cb.ContextSensitiveWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ContextSensitiveWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:sc.Color.transparent},
isSelected:{defaultValue:"false",set:function(H){this.setProperty("isSelected",H);this.fontColor=H?sc.Color.white:sc.Color.black}},layout:{initialize:function(){this.layout=new sc.HorizontalLayout}},context:{serialize:!1}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1872,end:2441})})(sc.Morph);
(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("ShortcutWidget")&&"function"===typeof cb.ShortcutWidget?cb.ShortcutWidget:cb.ShortcutWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"onMouseDown",value:function(H){this.openPopover()}},{key:"openPopover",value:function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(H){H.jumpToEnd()})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShortcutWidget"}},{key:"properties",get:function(){return{title:{defaultValue:"No Title",after:["submorphs"],set:function(H){this.setProperty("title",H);this.getSubmorphNamed("valueString").value=H}},nativeCursor:{defaultValue:"pointer"},fontColor:{derived:!0,set:function(H){this.submorphs.forEach(function(pa){return pa.fontColor=H})}},submorphs:{initialize:function(){this.submorphs=[sc.Icon.makeLabel("arrow-right",{styleClasses:["TreeLabel"],
fontSize:15,padding:sc.rect(1,1,4,1)}),{type:"label",value:this.title,styleClasses:["TreeLabel"],fontWeight:"bold",name:"valueString",opacity:.8,borderRadius:5,padding:sc.rect(0,0,0,2),nativeCursor:"pointer",fontSize:12,borderWidth:0}]}}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:2443,end:3793})})(sc.ContextSensitiveWidget);Ze=function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("LayoutWidget")&&"function"===typeof cb.LayoutWidget?cb.LayoutWidget:cb.LayoutWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"layoutChanged",value:function(){this.title=this.context.layout?"Configure "+this.context.layout.name()+" Layout":
"No Layout"}},{key:"openPopover",value:function(){var H=this,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){if(1==Sa.nextAddress)return pa=new sc.popovers.LayoutPopover({hasFixedPosition:!!H.ownerChain().find(function(rb){return rb.hasFixedPosition}),container:H.context}),Sa.yield(pa.fadeIntoWorld(H.globalBounds().center()),2);sc.connect(pa,"layoutChanged",H,"layoutChanged");sc.signal(H,"openWidget",pa);Sa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutWidget"}},
{key:"properties",get:function(){return{title:{after:["submorphs"],initialize:function(){this.title=this.context&&this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3802,end:4623})}(sc.ShortcutWidget);
sc.LayoutWidget=Ze;sc.LayoutWidget=Ze;sc.LayoutWidget=Ze;Ze=function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("ColorWidget")&&"function"===typeof cb.ColorWidget?cb.ColorWidget:cb.ColorWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"relayout",value:function(H){H?this.submorphs=this.color?this.color.isGradient?this.renderGradientValue():
this.renderColorValue():this.renderNoColor():this.color&&(this.color.isGradient?this.updateGradientValue():this.updateColorValue())}},{key:"updateGradientValue",value:function(){var H=this.color;if(2*H.stops.length==this.submorphs.length-3){var pa;for(pa in this.color.stops){var Sa=H.stops[pa];var rb=Sa.color,Sb=Sa.offset,Eb=$jscomp.makeIterator(this.submorphs[2+2*pa].submorphs).next().value;Sa=this.submorphs[3+2*pa];Eb.fill=rb;Sa.value=(100*Sb).toFixed()+"%"+(pa<H.stops.length-1?",":"")}}else this.submorphs=
this.renderGradientValue()}},{key:"renderGradientValue",value:function(){return[{type:"label",styleClasses:["TreeLabel"],value:this.color.type+"(",name:"valueString"}].concat($jscomp.arrayFromIterable(this.renderStops()),[{type:"label",styleClasses:["TreeLabel"],value:")"}])}},{key:"updateColorValue",value:function(){this.getSubmorphNamed("color box").fill=this.color;this.getSubmorphNamed("valueString").value=sc.obj.safeToString(this.color)}},{key:"renderNoColor",value:function(){return[{extent:sc.pt(15,
15),fill:sc.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:sc.pt(5,7.5),fill:sc.Color.white,borderColor:sc.Color.gray.darker(),borderWidth:1,submorphs:[{type:"path",name:"no fill",vertices:[sc.pt(0,0),sc.pt(10,10)],borderColor:sc.Color.red}]}]},{type:"label",value:"No Color",fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderColorValue",value:function(){return[{extent:sc.pt(15,15),fill:sc.Color.transparent,submorphs:[{styleClasses:["colorValue"],
name:"color box",center:sc.pt(5,7.5),fill:this.color,borderColor:sc.Color.gray.darker(),nativeCursor:"pointer",borderWidth:1}]},{type:"label",value:sc.obj.safeToString(this.color),fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderStops",value:function(){var H=this.color,pa=[{type:"label",padding:sc.rect(0,0,5,0),value:"linearGradient"==H.type?sc.num.toDegrees(H.vectorAsAngle()).toFixed()+"\u00b0,":""}],Sa;for(Sa in H.stops){var rb=H.stops[Sa],Sb=rb.color;rb=rb.offset;pa.push({extent:sc.pt(this.fontSize,
this.fontSize),fill:sc.Color.transparent,layout:new sc.HorizontalLayout({spacing:3}),submorphs:[{styleClasses:["colorValue"],fill:Sb}]});pa.push({type:"label",padding:sc.rect(0,0,5,0),value:(100*rb).toFixed()+"%"+(Sa<H.stops.length-1?",":"")})}return pa}},{key:"onMouseDown",value:function(H){this.openFillEditor()}},{key:"update",value:function(H){this.color=H}},{key:"openFillEditor",value:function(){var H=this,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){if(1==Sa.nextAddress)return pa=
new sc.popovers.FillPopover({hasFixedPosition:!!H.ownerChain().find(function(rb){return rb.hasFixedPosition}),handleMorph:H.context,fillValue:H.color,title:"Fill Control",gradientEnabled:H.gradientEnabled}),Sa.yield(pa.fadeIntoWorld(H.globalBounds().center()),2);sc.connect(pa,"fillValue",H,"update");sc.signal(H,"openWidget",pa);Sa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColorWidget"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=
new sc.HorizontalLayout({direction:"centered"})}},selectionFontColor:{defaultValue:sc.Color.white},nonSelectionFontColor:{defaultValue:sc.Color.black},color:{defaultValue:sc.Color.blue},gradientEnabled:{defaultValue:!1},fontSize:{defaultValue:14},isSelected:{after:["submorphs"],set:function(H){this.getProperty("isSelected")!=H&&(this.getSubmorphNamed("valueString").fontColor=H?this.selectionFontColor:this.nonSelectionFontColor,this.setProperty("isSelected",H))}},submorphs:{after:["nonSelectionFontColor",
"selectionFontColor"],initialize:function(){sc.connect(this,"color",this,"relayout",{converter:function(H,pa){return(pa&&pa.isColor)!=(H&&H.isColor)}});this.relayout(!0)}}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:4687,end:10140})}(sc.ContextSensitiveWidget);sc.ColorWidget=
Ze;sc.ColorWidget=Ze;sc.ColorWidget=Ze;Ze=function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("BooleanWidget")&&"function"===typeof cb.BooleanWidget?cb.BooleanWidget:cb.BooleanWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"onMouseDown",value:function(H){this.boolean=!this.boolean}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BooleanWidget"}},
{key:"properties",get:function(){return{fontFamily:{defaultValue:sc.config.codeEditor.defaultStyle.fontFamily},nativeCursor:{defaultValue:"pointer"},boolean:{set:function(H){this.setProperty("boolean",H);this.value=sc.obj.safeToString(H);this.fontColor=this.boolean?sc.Color.green:sc.Color.red}}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:10149,end:10634})}(sc.Label);sc.BooleanWidget=Ze;sc.BooleanWidget=Ze;sc.BooleanWidget=Ze;Ze=wa("N",function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("NumberWidget")&&"function"===typeof cb.NumberWidget?cb.NumberWidget:cb.NumberWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"onMouseDown",value:function(H){Tb._get(Object.getPrototypeOf(Xb.prototype),
"onMouseDown",this).call(this,H);"up"==H.targetMorph.name&&this.increment();"down"==H.targetMorph.name&&this.decrement()}},{key:"spec",value:function(){return sc.obj.dissoc(Tb._get(Object.getPrototypeOf(Xb.prototype),"spec",this).call(this),["submorphs"])}},{key:"update",value:function(H,pa){pa=void 0===pa?!0:pa;this.setProperty("number",pa?H/this.scaleFactor:H);sc.signal(this,"number",this.number);this.relayout(pa)}},{key:"relayoutButtons",value:function(){var H=this.getSubmorphNamed("up"),pa=this.getSubmorphNamed("down");
this.getSubmorphNamed("value");H.height=pa.height=(this.height-2)/2;H.width=pa.width=20}},{key:"onChange",value:function(H){Tb._get(Object.getPrototypeOf(Xb.prototype),"onChange",this).call(this,H);"extent"!=H.prop||this.autofit||this.relayout()}},{key:"relayout",value:function(H){var pa=this.getSubmorphNamed("value");pa&&(this.autofit?(H||(pa.value=this.number*this.scaleFactor),pa.fit(),this.height=pa.height,this.width=pa.width+20):H||(pa.width=this.width-20),this.relayoutButtons(),H||(pa.value=
sc.num.roundTo(this.number*this.scaleFactor,1),pa.min=-Infinity!=this.min?this.min*this.scaleFactor:this.min,pa.max=Infinity!=this.max?this.max*this.scaleFactor:this.max,pa.unit=this.unit))}},{key:"increment",value:function(){void 0!=this.max&&this.number>=this.max||this.update(this.number+1/this.scaleFactor,!1)}},{key:"decrement",value:function(){void 0!=this.min&&this.number<=this.min||this.update(this.number-1/this.scaleFactor,!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberWidget"}},
{key:"properties",get:function(){return{unit:{type:"Enum",isStyleProp:!0,values:["px","%","pt",""]},autofit:{defaultValue:!0,after:["submorphs","extent"],set:function(H){this.setProperty("autofit",H);this.getSubmorphNamed("value").scaleToBounds=!H}},number:{defaultValue:0,after:["unit","autofit"],set:function(H){this.setProperty("number",H);this.relayout(!1)}},min:{defaultValue:-Infinity},max:{defaultValue:Infinity},floatingPoint:{after:["number","submorphs"],set:function(H){this.setProperty("floatingPoint",
H);this.get("value").floatingPoint=H},get:function(){var H=/[+-]?([0-9]*[.])?[0-9]+/.exec(this.number);return this.getProperty("floatingPoint")||1==this.scaleFactor&&H&&!!H[1]}},padding:{isStyleProp:!0,defaultValue:sc.rect(5,3,0,0),after:["submorphs"],set:function(H){this.setProperty("padding",H);this.getSubmorphNamed("value").padding=H}},extent:{defaultValue:sc.pt(70,25)},scaleFactor:{defaultValue:1,get:function(){return this.getProperty("scaleFactor")||1}},baseFactor:{after:["submorphs"],derived:!0,
get:function(){return this.get("value").baseFactor},set:function(H){this.get("value").baseFactor=H}},styleClasses:{defaultValue:["unfocused"]},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/number field/light"}}},fontColor:{isStyleProp:!0,defaultValue:sc.Color.rgbHex("#0086b3"),set:function(H){this.setProperty("fontColor",H)}},isSelected:{set:function(H){this.getProperty("isSelected")!=H&&(H?(this.addStyleClass("selected"),this.removeStyleClass("unselected")):(this.removeStyleClass("selected"),
this.addStyleClass("unselected")),this.setProperty("isSelected",H))}},fontFamily:{defaultValue:"Sans-Serif",isStyleProp:!0,set:function(H){this.setProperty("fontFamily",H)}},fontSize:{defaultValue:15,isStyleProp:!0,set:function(H){this.setProperty("fontSize",H)}},layout:{initialize:function(){this.layout=new sc.TilingLayout({axis:"column",orderByIndex:!0,align:"center"})}},submorphs:{after:["min","max"],initialize:function(){var H=this;this.submorphs=[new sc.ValueScrubber({name:"value",unit:this.unit,
floatingPoint:this.floatingPoint,scaleToBounds:!1,min:this.min,max:this.max}),sc.Icon.makeLabel("sort-up",{name:"up"}),sc.Icon.makeLabel("sort-up",{name:"down",rotation:Math.PI})];sc.connect(this.get("value"),"scrub",this,"update");this.whenRendered().then(function(){return H.relayout()})}}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:10643,end:16590})}(sc.Morph));sc.NumberWidget=Ze;sc.NumberWidget=Ze;sc.NumberWidget=Ze;sd=function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("ShadowWidget")&&"function"===typeof cb.ShadowWidget?cb.ShadowWidget:cb.ShadowWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"onMouseDown",value:function(H){this.openPopover()}},
{key:"openPopover",value:function(){var H=this,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){if(1==Sa.nextAddress)return pa=new sc.popovers.ShadowPopover({hasFixedPosition:!!H.ownerChain().find(function(rb){return rb.hasFixedPosition}),shadowValue:H.shadowValue}),Sa.yield(pa.fadeIntoWorld(H.globalBounds().center()),2);sc.connect(pa,"shadowValue",H,"shadowValue");sc.connect(H,"shadowValue",H,"update");sc.signal(H,"openWidget",pa);Sa.jumpToEnd()})}},{key:"update",value:function(){this.renderShadowDisplay()}},
{key:"renderShadowDisplay",value:function(){this.shadowValue?1<this.submorphs.length?this.updateShadowDisplay():this.initShadowDisplay():this.submorphs=[{opacity:.8,reactsToPointer:!1,styleClasses:["TreeLabel"],name:"valueString",type:"label",value:"No Shadow"}]}},{key:"updateShadowDisplay",value:function(){var H=this.shadowValue,pa=H.blur,Sa=H.spread,rb=H.distance;H=H.color;var Sb=$jscomp.makeIterator(this.submorphs),Eb=Sb.next().value,Mc=Sb.next().value;Mc=$jscomp.makeIterator(Mc.submorphs).next().value;
Sb=Sb.next().value;Eb.value=(this.shadowValue.inset?"inset":"drop")+"-shadow(";Mc.fill=H;Sb.value=", "+pa+"px, "+rb+"px, "+Sa+"px)"}},{key:"initShadowDisplay",value:function(){var H=this.shadowValue,pa=H.blur,Sa=H.spread,rb=H.distance;H=H.color;this.submorphs=[{name:"valueString",opacity:.7,reactsToPointer:!1,type:"label",value:(this.shadowValue.inset?"inset":"drop")+"-shadow("},sc.morph({fill:sc.Color.transparent,extent:sc.pt(this.fontSize+6,this.fontSize+4),submorphs:[{extent:sc.pt(this.fontSize,
this.fontSize),position:sc.pt(2,2),fill:H,borderColor:sc.Color.black,borderWidth:1}]}),{name:"valueString",type:"label",opacity:.7,reactsToPointer:!1,value:", "+pa+"px, "+rb+"px, "+Sa+"px)"}]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShadowWidget"}},{key:"properties",get:function(){return{shadowValue:{after:["submorphs"],defaultValue:null,set:function(H){this.setProperty("shadowValue",H);this.renderShadowDisplay()}},fill:{defaultValue:sc.Color.transparent},nativeCursor:{defaultValue:"pointer"},
fontSize:{defaultValue:12},fontColor:{derived:!0,set:function(H){this.submorphs.forEach(function(pa){return pa.fontColor=H})}},isSelected:{defaultValue:!1,set:function(H){this.setProperty("isSelected",H);this.fontColor=H?sc.Color.white:sc.Color.black}},layout:{initialize:function(){this.layout=new sc.HorizontalLayout}},submorphs:{initialize:function(){this.update()}}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:16599,end:19722})}(sc.Morph);sc.ShadowWidget=sd;sc.ShadowWidget=sd;sc.ShadowWidget=sd;sd=function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("PointWidget")&&"function"===typeof cb.PointWidget?cb.PointWidget:cb.PointWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Xb,Wb,[{key:"onMouseDown",value:function(H){this.openPopover()}},{key:"openPopover",value:function(){var H=this,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){if(1==Sa.nextAddress)return pa=new sc.popovers.PointPopover({pointValue:H.pointValue,hasFixedPosition:!!H.ownerChain().find(function(rb){return rb.hasFixedPosition})}),Sa.yield(pa.fadeIntoWorld(H.globalBounds().center()),2);sc.connect(pa,"pointValue",H,"pointValue");sc.signal(H,"openWidget",pa);Sa.jumpToEnd()})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PointWidget"}},{key:"properties",get:function(){return{isSelected:{defaultValue:"false",set:function(H){this.setProperty("isSelected",H);this.fontColor=H?this.selectionFontColor:this.nonSelectionFontColor}},selectionFontColor:{isStyleProp:!0,defaultValue:sc.Color.white},nonSelectionFontColor:{isStyleProp:!0,defaultValue:sc.Color.black},fontFamily:{defaultValue:sc.config.codeEditor.defaultStyle.fontFamily},nativeCursor:{defaultValue:"pointer"},
styleClasses:{defaultValue:["TreeLabel"]},pointValue:{after:["textAndAttributes"],set:function(H){var pa=sc.Color.rgbHex("#0086b3");this.setProperty("pointValue",H);this.textAndAttributes=["pt(",null,H.x.toFixed(),{fontColor:pa},",",{},H.y.toFixed(),{fontColor:pa},")",null];this.fixedHeight=this.fixedWidth=!0;this.height=20;this.width=this.textString.length*this.fontSize}}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:19731,end:21375})}(sc.Label);sc.PointWidget=sd;sc.PointWidget=sd;sc.PointWidget=sd;sd=function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("PaddingWidget")&&"function"===typeof cb.PaddingWidget?cb.PaddingWidget:cb.PaddingWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Xb,Wb,[{key:"onMouseDown",value:function(H){this.openPopover()}},{key:"openPopover",value:function(){var H=this,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){if(1==Sa.nextAddress)return pa=new sc.popovers.RectanglePopover({hasFixedPosition:!!H.ownerChain().find(function(rb){return rb.hasFixedPosition}),rectangle:H.rectangle}),pa.relayout(),Sa.yield(pa.fadeIntoWorld(H.globalBounds().center()),2);sc.connect(pa,"rectangle",H,"rectangle");sc.signal(H,"openWidget",
pa);Sa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PaddingWidget"}},{key:"properties",get:function(){return{nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},fontFamily:{defaultValue:sc.config.codeEditor.defaultStyle.fontFamily},isSelected:{defaultValue:"false",set:function(H){this.setProperty("isSelected",H);this.fontColor=H?sc.Color.white:sc.Color.black}},rectangle:{defaultValue:sc.rect(0),set:function(H){this.setProperty("rectangle",
H);this.value=sc.obj.safeToString(H)}}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:21384,end:22445})}(sc.Label);sc.PaddingWidget=sd;sc.PaddingWidget=sd;sc.PaddingWidget=sd;sd=function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("IconWidget")&&
"function"===typeof cb.IconWidget?cb.IconWidget:cb.IconWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"onMouseDown",value:function(H){this.openPopover()}},{key:"openPopover",value:function(){var H=this,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){if(1==Sa.nextAddress)return pa=new sc.popovers.IconPopover({hasFixedPosition:!!H.ownerChain().find(function(rb){return rb.hasFixedPosition})}),
Sa.yield(pa.fadeIntoWorld(H.globalBounds().center()),2);sc.connect(pa,"select",H,"iconValue",{converter:function(rb){return rb&&sc.Icon.makeLabel(rb).value},varMapping:{Icon:sc.Icon}});sc.signal(H,"openWidget",pa);Sa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"IconWidget"}},{key:"properties",get:function(){return{fontColor:{defaultValue:sc.Color.gray.darker()},fontFamily:{defaultValue:"FontAwesome"},nativeCursor:{defaultValue:"pointer"},iconValue:{derived:!0,get:function(){return this.value},
set:function(H){this.value=H||"No Icon"}}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22454,end:23385})}(sc.Label);sc.IconWidget=sd;sc.IconWidget=sd;sc.IconWidget=sd;sd=function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),Xb=cb.hasOwnProperty("StringWidget")&&
"function"===typeof cb.StringWidget?cb.StringWidget:cb.StringWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"truncate",value:function(H){return 200<H.length?H.slice(0,20)+"...":H}},{key:"onFocus",value:function(H){var pa=this,Sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){if(1==rb.nextAddress)return Tb._get(Object.getPrototypeOf(Xb.prototype),"onFocus",pa).call(pa,H),pa.readOnly?
rb.return():pa.stringTooLong?rb.yield(pa.world().editPrompt("edit string",{requester:pa,input:pa.stringValue}),2):(pa.borderColor=sc.Color.white.withA(.9),pa.textString=pa.stringValue,rb.return());Sa=rb.yieldResult;if("string"===typeof Sa)pa.onInput(Sa);rb.jumpToEnd()})}},{key:"onBlur",value:function(H){Tb._get(Object.getPrototypeOf(Xb.prototype),"onBlur",this).call(this,H);this.readOnly||(this.borderColor=sc.Color.transparent,this.onInput(this.textString))}},{key:"onInput",value:function(H){this.owner.focus();
sc.signal(this,"inputAccepted",H);this.stringValue=H}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:sc.Color.transparent},fontColor:{defaultValue:sc.Color.blue},nativeCursor:{defaultValue:"auto"},borderColor:{defaultValue:sc.Color.transparent},borderStyle:{defaultValue:"dashed"},borderRadius:{defaultValue:4},borderWidth:{defaultValue:1},padding:{defaultValue:sc.rect(0,0,0,0)},fixedWidth:{defaultValue:!1},
fixedHeight:{defaultValue:!1},stringValue:{after:["textString"],set:function(H){this.setProperty("stringValue",H);this.textString=this.truncate(H);this.nativeCursor=this.stringTooLong?"pointer":"auto"}},stringTooLong:{readOnly:!0,get:function(){return this.stringValue.includes("\n")}},isSelected:{defaultValue:"false",set:function(H){this.setProperty("isSelected",H);this.fontColor=H?sc.Color.white:sc.Color.blue}}}}}],cb,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23394,end:25345})}(sc.InputLine);sc.StringWidget=sd;sc.StringWidget=sd;sc.StringWidget=sd;sc.valueWidgets=Lc;Object.assign(sc.valueWidgets,{NumberWidget:sc.NumberWidget,StringWidget:sc.StringWidget,IconWidget:sc.IconWidget,PaddingWidget:sc.PaddingWidget,ShadowWidget:sc.ShadowWidget,PointWidget:sc.PointWidget,BooleanWidget:sc.BooleanWidget,LayoutWidget:sc.LayoutWidget,
ColorWidget:sc.ColorWidget});var Yb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js");Yb.Ellipse=$a;Yb.Icon=le;Yb.Morph=Le;Yb.Path=Ad;Yb.Text=hc;Yb.HorizontalLayout=Sd;Yb.VerticalLayout=Ea;Yb.morph=Ib;Yb.Color=Qb;Yb.pt=ib;Yb.rect=Ac;Yb.Rectangle=uc;Yb.arr=Za;Yb.connect=lc;Yb.disconnect=Ed;Yb.LabeledCheckBox=Ua;Yb.DropDownSelector=U;Yb.Button=Ba;Yb.Menu=K;Yb.NumberWidget=Ze;Yb.InteractiveMorphSelector=Be;Yb.easings=dd;(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
Xb=cb.hasOwnProperty("AxisHalo")&&"function"===typeof cb.AxisHalo?cb.AxisHalo:cb.AxisHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:Symbol.for("lively-instance-initialize"),value:function(H){var pa=H.halo;H=H.targetAxis;Tb._get(Object.getPrototypeOf(Xb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{fill:Yb.Color.transparent,halo:pa,targetAxis:H,container:pa.container});
this.initialize()}},{key:"initialize",value:function(){this.setBounds(this.fetchBounds());this.minSlider=this.minSlider();this.axisMenu=this.axisMenu();this.proportionSlider=this.proportionSlider();this.proportionSlider.addMorph(this.minSlider);this.submorphs=[this.proportionSlider,this.axisMenu];this.halo.addGuide(this)}},{key:"forceMenuHidden",set:function(H){this._forceMenuHidden=H;this.axisMenu.visible=!H}},{key:"forceMenuHidden",get:function(){return this._forceMenuHidden}},{key:"lastAxis",get:function(){return!this.targetAxis.after}},
{key:"fetchBounds",value:function(){return this.fetchPosition().extent(this.fetchExtent())}},{key:"alignWithTarget",value:function(){this.extent=this.fetchExtent();this.position=this.fetchPosition();this.proportionSlider.alignWithTarget();this.axisMenu.alignWithTarget()}},{key:"onHoverIn",value:function(){this.minSlider.requestToShow();this.axisMenu.visible=!this.forceMenuHidden&&!0}},{key:"onHoverOut",value:function(H){this.minSlider.requestToHide();this.axisMenu.visible=this.forceMenuVisible||!1}},
{key:"proportionSlider",value:function(){var H=this,pa=this,Sa=this.proportionViewer();return this.halo.addGuide(new Yb.Morph({nativeCursor:this.getResizeCursor(),fill:Yb.Color.transparent,submorphs:[this.devider(),Sa],alignWithTarget:function(){this.setBounds(pa.getProportionSliderBounds(this))},onDragStart:function(){Sa.visible=!0},onDrag:function(rb){H.adjustStretch(H.getDelta(rb));H.halo.alignWithTarget()},onDragEnd:function(){Sa.visible=!1}}))}},{key:"devider",value:function(){return new Yb.Morph({visible:!this.lastAxis,
fill:Yb.Color.black.withA(.5),bounds:this.getDeviderBounds(),draggable:!1,reactsToPointer:!1})}},{key:"minSlider",value:function(){var H=this,pa=this,Sa=this.minSpaceVisualizer(),rb=this.minViewer();return this.halo.addGuide(new Yb.Ellipse({nativeCursor:this.getResizeCursor(),fill:Yb.Color.green,extent:Yb.pt(10,10),visible:!1,submorphs:[Sa,rb],becomesActiveOnHover:!0,alignWithTarget:function(){this.position=pa.getMinSliderPosition()},requestToShow:function(){this.visible=!pa.targetAxis.fixed},requestToHide:function(){this.active?
this.shouldHide=!0:this.visible=!1},onDragStart:function(){pa.forceMenuHidden=!0;rb.visible=!0;this.active=Sa.visible=!0},onDrag:function(Sb){H.targetAxis.min+=-H.getDelta(Sb);H.halo.alignWithTarget()},onDragEnd:function(){pa.forceMenuHidden=!1;rb.visible=!1;this.active=Sa.visible=!1;this.shouldHide&&(this.shouldHide=this.visible=!1)}}))}},{key:"minViewer",value:function(){var H=this;return this.viewer({position:this.getMinViewerPosition(),alignWithTarget:function(){this.textString="min: "+H.targetAxis.min.toFixed()+
"px !"}})}},{key:"minSpaceBorder",value:function(){return new Yb.Path(Object.assign({position:Yb.pt(-1,-1),borderStyle:"dashed",borderColor:Yb.Color.green,borderWidth:2},this.getMinSpaceBorder()))}},{key:"minSpaceVisualizer",value:function(){var H=this,pa=this.minSpaceBorder();return this.halo.addGuide(new Yb.Morph({fill:Yb.Color.green.withA(.1),visible:!1,isHaloItem:!0,submorphs:[pa],alignWithTarget:function(){this.extent=H.getMinSpaceExtent();this.topLeft=Yb.pt(5,5)}}))}},{key:"axisMenu",value:function(){var H=
this.lockButton(),pa=this.menuButton(),Sa=this;return new Yb.Morph({layout:this.getMenuLayout(),submorphs:[H,pa],fill:Yb.Color.transparent,visible:!1,becomesActiveOnHover:!0,alignWithTarget:function(){this.bottomRight=this.owner.extent.subPt(Sa.getMenuOffset(this))}})}},{key:"lockButton",value:function(){var H=this;return this.halo.addGuide(new Yb.Morph({fill:Yb.Color.transparent,extent:Yb.pt(25,25),submorphs:[{center:Yb.pt(12.5,12.5),fill:Yb.Color.transparent,styleClasses:["fa","fa-unlock"]}],alignWithTarget:function(){H.targetAxis.fixed?
(this.fontColor=Yb.Color.red,this.submorphs[0].styleClasses=["fa","fa-lock"]):(this.fontColor=Yb.Color.green,this.submorphs[0].styleClasses=["fa","fa-unlock"])},onMouseDown:function(){this.toggleLock()},toggleLock:function(){H.targetAxis.fixed=!H.targetAxis.fixed;H.halo.alignWithTarget()}}))}},{key:"menuButton",value:function(){var H=this,pa=this;return new Yb.Morph({fill:Yb.Color.transparent,extent:Yb.pt(25,25),submorphs:[{fill:Yb.Color.transparent,styleClasses:["fa","fa-cog"],center:Yb.pt(12.5,
12.5)}],onMouseDown:function(Sa){pa.forceMenuVisible=!0;this.addMorph(Sa.state.menu=new Yb.Menu({position:Yb.pt(15,15),items:[["Remove "+pa.subject,function(){H.targetAxis.remove();H.halo.initGuides();H.halo.alignWithTarget()}],["Insert "+pa.subject+" before",function(){H.targetAxis.addBefore();H.halo.initGuides();H.halo.alignWithTarget()}],["Insert "+pa.subject+" after",function(){H.targetAxis.addAfter();H.halo.initGuides();H.halo.alignWithTarget()}]]}))}})}},{key:"viewer",value:function(H){var pa=
H.position;H=H.alignWithTarget;return this.halo.addGuide(new Yb.Text({styleClasses:["Halo"],padding:Yb.Rectangle.inset(6),visible:!1,borderRadius:10,fontColor:Yb.Color.white,fill:Yb.Color.black.withA(.5),position:pa,alignWithTarget:H,readOnly:!0}))}},{key:"proportionViewer",value:function(){var H=this;return this.viewer({position:this.getProportionViewerPosition(),alignWithTarget:function(){this.textString=H.targetAxis.length.toFixed(1)+"px"}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"AxisHalo"}}],
cb,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:660,end:7979})})(Yb.Morph);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Xb=cb.hasOwnProperty("RowHalo")&&"function"===typeof cb.RowHalo?cb.RowHalo:cb.RowHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:Symbol.for("lively-instance-initialize"),value:function(H){var pa=H.row;H=H.halo;Tb._get(Object.getPrototypeOf(Xb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:H.target.row(pa),halo:H})}},{key:"subject",get:function(){return"row"}},{key:"adjustStretch",value:function(H){this.targetAxis.height+=H}},{key:"getDelta",value:function(H){return H.state.dragDelta.y}},{key:"axisOffset",
value:function(){return this.targetAxis.origin.position.y}},{key:"fetchPosition",value:function(){return Yb.pt(-45,this.axisOffset()+10)}},{key:"fetchExtent",value:function(){return Yb.pt(40,this.targetAxis.length-10)}},{key:"getMenuOffset",value:function(H){return this.targetAxis.length>H.height?Yb.pt(2,5):Yb.pt(26,10)}},{key:"getMenuLayout",value:function(){return new Yb.VerticalLayout}},{key:"getResizeCursor",value:function(){return"row-resize"}},{key:"getMinViewerPosition",value:function(){return Yb.pt(50,
20)}},{key:"getMinSliderPosition",value:function(){return Yb.pt(0,-this.targetAxis.min)}},{key:"getMinSpaceExtent",value:function(){return Yb.pt(this.container.width+45,this.targetAxis.min)}},{key:"getMinSpaceBorder",value:function(){return{extent:Yb.pt(this.container.width+50,2),vertices:[Yb.pt(0,1),Yb.pt(this.container.width+50,1)]}}},{key:"getProportionViewerPosition",value:function(){return Yb.pt(40,20)}},{key:"getProportionSliderBounds",value:function(H){return Yb.pt(0,H.owner.height-5).extent(Yb.pt(40,
10))}},{key:"getDeviderBounds",value:function(){return Yb.pt(15,4).extent(Yb.pt(25,2))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RowHalo"}}],cb,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:7981,end:9208})})(Yb.AxisHalo);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
Xb=cb.hasOwnProperty("ColumnHalo")&&"function"===typeof cb.ColumnHalo?cb.ColumnHalo:cb.ColumnHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:Symbol.for("lively-instance-initialize"),value:function(H){var pa=H.col;H=H.halo;Tb._get(Object.getPrototypeOf(Xb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:H.target.col(pa),halo:H})}},{key:"subject",get:function(){return"column"}},
{key:"adjustStretch",value:function(H){this.targetAxis.width+=H}},{key:"getDelta",value:function(H){return H.state.dragDelta.x}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.x}},{key:"fetchPosition",value:function(){return Yb.pt(this.axisOffset()+10,-45)}},{key:"fetchExtent",value:function(){return Yb.pt(this.targetAxis.length-10,40)}},{key:"getMenuOffset",value:function(H){return this.targetAxis.length>H.width?Yb.pt(5,3):Yb.pt(8,26)}},{key:"getMenuLayout",value:function(){return new Yb.HorizontalLayout}},
{key:"getResizeCursor",value:function(){return"col-resize"}},{key:"getMinViewerPosition",value:function(){return Yb.pt(20,50)}},{key:"getMinSliderPosition",value:function(){return Yb.pt(-this.targetAxis.min,0)}},{key:"getMinSpaceExtent",value:function(){return Yb.pt(this.targetAxis.min,this.container.height+45)}},{key:"getMinSpaceBorder",value:function(){return{extent:Yb.pt(2,this.container.height+50),vertices:[Yb.pt(1,0),Yb.pt(1,this.container.height+50)]}}},{key:"getProportionViewerPosition",value:function(){return Yb.pt(20,
40)}},{key:"getProportionSliderBounds",value:function(H){return Yb.pt(H.owner.width-5,0).extent(Yb.pt(10,40))}},{key:"getDeviderBounds",value:function(){return Yb.pt(4,15).extent(Yb.pt(2,25))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColumnHalo"}}],cb,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:9210,end:10442})})(Yb.AxisHalo);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Xb=cb.hasOwnProperty("CellGuide")&&"function"===typeof cb.CellGuide?cb.CellGuide:cb.CellGuide=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"menuItems",value:function(){var H=this,pa=Yb.Icon.textAttribute("check-square-o"),Sa=Yb.Icon.textAttribute("square-o");
pa[1].textStyleClasses.push("annotation");Sa[1].textStyleClasses.push("annotation");Sa[1].paddingRight="2px";return[["Resize Policy",[[["Rigid  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?Sa:pa)),function(){H.cellGroup.resize=!1}],[["Space Filling  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?pa:Sa)),function(){H.cellGroup.resize=!0}]]],["Align at...",["center"].concat($jscomp.arrayFromIterable((new Yb.Rectangle).sides),$jscomp.arrayFromIterable((new Yb.Rectangle).corners)).map(function(rb){return[[rb,
{paddingRight:"2px"}].concat($jscomp.arrayFromIterable(H.cellGroup.align==rb?pa:Sa),["  ",null]),function(){return H.cellGroup.align=rb}]})]].concat(this.cellGroup.morph?[["Release Morph from Cell",function(){var rb=H.cellGroup.morph;rb&&(H.world().firstHand.grab(rb),H.world().firstHand.longClickGrab=!0,rb.position=Yb.pt(0))}]]:[])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CellGuide"}},{key:"properties",get:function(){return{cellGroup:{}}}}],cb,{pathInPackage:function(){return"layout.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10444,end:11722})})(Yb.Morph);(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Xb=cb.hasOwnProperty("LayoutHalo")&&"function"===typeof cb.LayoutHalo?cb.LayoutHalo:cb.LayoutHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Tb(Xb,Wb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutHalo"}},{key:"properties",get:function(){return{container:{},target:{},pointerId:{},halosEnabled:{defaultValue:!1},isEpiMorph:{defaultValue:!0},isHaloItem:{defaultValue:!0},borderColor:{defaultValue:Yb.Color.orange},borderWidth:{defaultValue:2},styleClasses:{defaultValue:["Halo"]}}}}],cb,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:11724,end:12137})})(Yb.Morph);Lc=wa("G",function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Xb=cb.hasOwnProperty("GridLayoutHalo")&&"function"===typeof cb.GridLayoutHalo?cb.GridLayoutHalo:cb.GridLayoutHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Tb(Xb,Wb,[{key:"previewDrop",value:function(H){1>H.length||(H=this.cellGuides.find(function(pa){return pa.fullContainsWorldPoint($world.firstHand.position)}),H!=this.currentCell&&this.currentCell&&this.currentCell.stopPreview(),(this.currentCell=H)&&this.currentCell.startPreview())}},{key:"handleDrop",value:function(H){var pa=this;this.currentCell&&H.whenRendered().then(function(){return pa.currentCell.cellGroup.morph=H})}},{key:"initialize",value:function(){this.initGuides();this.alignWithTarget();
this.focus()}},{key:"optionControls",value:function(){var H=this.target,pa=new Yb.LabeledCheckBox({name:"compensateOrigin",label:"Compensate Origin",fill:Yb.Color.transparent,checked:H.compensateOrigin}),Sa=new Yb.LabeledCheckBox({label:"Resize Submorphs",fill:Yb.Color.transparent,name:"fitToCell",checked:H.fitToCell});Yb.connect(pa,"checked",H,"compensateOrigin");Yb.connect(Sa,"checked",H,"fitToCell");Yb.connect(pa,"checked",this,"alignWithTarget");return[pa,Sa]}},{key:"isLayoutHalo",get:function(){return!1}},
{key:"alignWithTarget",value:function(){this.target.apply();this.position=this.container.globalPosition;this.target.compensateOrigin&&this.moveBy(this.container.origin.negated());this.extent=this.container.extent;this.addMissingGuides();Yb.arr.reverse(this.guides).forEach(function(H){return H.alignWithTarget()})}},{key:"addMissingGuides",value:function(){var H=this;Yb.arr.withoutAll(this.target.cellGroups,this.guides.map(function(pa){return pa.cellGroup})).forEach(function(pa){return H.addMorph(H.cellGuide(pa))})}},
{key:"initGuides",value:function(){this.submorphs=[];this.guides=[];this.initCellGuides();this.initColumnGuides();this.initRowGuides()}},{key:"initCellGuides",value:function(){var H=this,pa=this.addMorph({fill:Yb.Color.transparent,borderRadius:this.borderRadius,extent:this.extent});this.target.cellGroups.forEach(function(Sa){pa.addMorph(H.cellGuide(Sa))});this.cellGuides=pa.submorphs;this.addMorph(this.resizer())}},{key:"addGuide",value:function(H){H.isHaloItem=!0;this.guides.push(H);return H}},{key:"initRowGuides",
value:function(){var H=this,pa=this;this.addGuide(this.addMorph(new Yb.Morph({width:25,fill:Yb.Color.gray.withA(.7),borderRadius:15,height:this.container.height,topRight:Yb.pt(-5,0),alignWithTarget:function(){this.height=pa.container.height}})));Yb.arr.range(0,this.target.rowCount-1).forEach(function(Sa){H.addMorph(new Yb.RowHalo({row:Sa,halo:H}))})}},{key:"initColumnGuides",value:function(){var H=this,pa=this;this.addGuide(this.addMorph(new Yb.Morph({height:25,fill:Yb.Color.gray.withA(.7),borderRadius:15,
width:this.container.width,bottomLeft:Yb.pt(0,-5),alignWithTarget:function(){this.width=pa.container.width}})));Yb.arr.range(0,this.target.columnCount-1).forEach(function(Sa){H.addMorph(new Yb.ColumnHalo({col:Sa,halo:H}))})}},{key:"resizer",value:function(){var H=this;return this.addGuide(new Yb.Morph({fill:Yb.Color.transparent,extent:Yb.pt(25,25),nativeCursor:"nwse-resize",onDrag:function(pa){H.container.resizeBy(pa.state.dragDelta);H.alignWithTarget()},alignWithTarget:function(){this.bottomRight=
H.extent}}))}},{key:"cellResizer",value:function(H,pa){var Sa=this,rb="topLeft"==pa?"bottomRight":"topLeft";return new Yb.Ellipse({borderWidth:1,visible:!1,borderColor:Yb.Color.black,nativeCursor:"nwse-resize",removeCell:function(Sb){H.disconnect(Sb);Sa.alignWithTarget()},addCell:function(Sb){H.connect(Sb);Sa.alignWithTarget()},start:function(){this.fixpointCell=H[rb];this.draggedDelta=H.bounds().partNamed(pa);this.debugMorph=Sa.addMorph(new Yb.Morph({fill:Yb.Color.orange.withA(.5)}))},update:function(Sb){var Eb=
this;this.draggedDelta=this.draggedDelta.addPt(Sb);var Mc=Yb.Rectangle.unionPts([this.draggedDelta]).union(this.fixpointCell.bounds());this.debugMorph.setBounds(Mc);Sa.cells.forEach(function(Fc){var xd=Mc.intersection(Fc.bounds()).area()/Fc.bounds().area();H.includes(Fc)&&.1>xd&&Eb.removeCell(Fc);!H.includes(Fc)&&xd>1/3&&Eb.addCell(Fc)})},onDragEnd:function(Sb){this.debugMorph.remove()},onDragStart:function(Sb){this.start(Sb.position)},onDrag:function(Sb){this.update(Sb.state.dragDelta)}})}},{key:"cellGuide",
value:function(H){var pa=this,Sa=this.cellResizer(H,"topLeft"),rb=this.cellResizer(H,"bottomRight");return this.addGuide(new Yb.CellGuide({cellGroup:H,bounds:H.bounds(),fill:Yb.Color.transparent,borderColor:Yb.Color.orange,borderWidth:1,isHaloItem:!0,isCell:!0,draggable:!1,submorphs:[Sa,rb],onMouseDown:function(Sb){this.becomeActive()},deactivate:function(){this.borderColor=Yb.Color.orange;this.fill=Yb.Color.transparent;this.submorphs.forEach(function(Sb){Sb.visible=!1})},becomeActive:function(){pa.guides.forEach(function(Sb){Sb.isCell&&
Sb.deactivate()});this.borderColor=Yb.Color.rgbHex("#1565C0");this.fill=Yb.Color.rgbHex("#1565C0").withA(.3);pa.addMorph(this.remove());this.submorphs.forEach(function(Sb){Sb.visible=!0})},startPreview:function(Sb){this.fill=Yb.Color.orange.withA(.7)},stopPreview:function(Sb){this.fill=Yb.Color.transparent},onDrop:function(Sb){var Eb=$jscomp.makeIterator(Sb.hand.grabbedMorphs).next().value;Sb.hand.dropMorphsOn(pa.container);H.morph=Eb},alignWithTarget:function(){H.bounds().isNonEmpty()?(this.setBounds(H.bounds()),
Sa.center=this.innerBounds().topLeft(),rb.center=this.innerBounds().bottomRight()):(Yb.arr.remove(pa.guides,this),this.remove())}}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GridLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:Yb.Color.transparent},cells:{derived:!0,get:function(){return Yb.arr.flatten(this.target.col(0).items.map(function(H){return H.row(0).items}))}},submorphs:{initialize:function(){this.initialize()}}}}}],cb,{pathInPackage:function(){return"layout.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:12146,end:19501})}(Yb.LayoutHalo));Yb.GridLayoutHalo=Lc;Yb.GridLayoutHalo=Lc;Yb.GridLayoutHalo=Lc;Ze=function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Xb=cb.hasOwnProperty("TilingLayoutHalo")&&"function"===typeof cb.TilingLayoutHalo?cb.TilingLayoutHalo:cb.TilingLayoutHalo=
function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"remove",value:function(){Tb._get(Object.getPrototypeOf(Xb.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"handleDrop",value:function(H){}},{key:"removePreviews",value:function(){this.previews.forEach(function(H){return H.clear()})}},
{key:"previewDrop",value:function(H){var pa=this;0<this.previews.length||(this.previews=H.map(function(Sa){return pa.container.addMorph({type:Yb.DropPreview,bounds:Sa.bounds()})}),this.previews.forEach(function(Sa){Sa.step()}))}},{key:"updateSpacing",value:function(H){this.target.spacing=H}},{key:"updateAxis",value:function(H){this.target.axis=H}},{key:"updateAlign",value:function(H){this.target.align=H}},{key:"optionControls",value:function(){var H=this.target,pa=new Yb.DropDownSelector({borderRadius:2,
padding:3,selectedValue:H.axis,values:["row","column"]}),Sa=new Yb.DropDownSelector({borderRadius:2,padding:3,selectedValue:H.align,values:["left","center"]});H=new Yb.NumberWidget({min:0,number:H.spacing,padding:Yb.rect(5,3,0,0),borderRadius:3,borderWidth:1,borderColor:Yb.Color.gray,unit:"px"});Yb.connect(H,"update",this,"updateSpacing");Yb.connect(Sa,"update",this,"updateAlign");Yb.connect(pa,"update",this,"updateAxis");var rb={type:"label",padding:Yb.rect(0,5,5,5),fill:Yb.Color.transparent,fontColor:Yb.Color.gray.darker(),
readOnly:!0};return[[Object.assign({},rb,{textString:"Submorph Spacing"}),H],[Object.assign({},rb,{textString:"Tiling Align"}),Sa],[Object.assign({},rb,{textString:"Tiling Axis"}),pa]].map(function(Sb){return{submorphs:Sb,fill:null,layout:new Yb.HorizontalLayout({spacing:3})}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TilingLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:Yb.Color.transparent},previews:{defaultValue:[]}}}}],cb,{pathInPackage:function(){return"layout.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:19510,end:21708})}(Yb.LayoutHalo);Yb.TilingLayoutHalo=Ze;Yb.TilingLayoutHalo=Ze;Yb.TilingLayoutHalo=Ze;(function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Xb=cb.hasOwnProperty("DropPreview")&&"function"===typeof cb.DropPreview?cb.DropPreview:cb.DropPreview=function(H){H&&
H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"clear",value:function(){this.stopped=!0;this.remove()}},{key:"step",value:function(){var H=this,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sa){if(1==Sa.nextAddress)return pa=Yb.easings.inOutQuad,Sa.yield(H.animate({opacity:.5,duration:(H.pulseDuration-10)/2,easing:pa}),2);if(3!=Sa.nextAddress)return Sa.yield(H.animate({opacity:1,duration:(H.pulseDuration-
10)/2,easing:pa}),3);H.stopped||H.step();Sa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DropPreview"}},{key:"properties",get:function(){return{isHaloItem:{readOnly:!0,get:function(){return!0}},epiMorph:{readOnly:!0,get:function(){return!0}},fill:{defaultValue:Yb.Color.orange.withA(.3)},hasFixedPosition:{defaultValue:!0},borderColor:{defaultValue:Yb.Color.orange},borderWidth:{defaultValue:2},borderStyle:{defaultValue:"dashed"},pulseDuration:{defaultValue:2E3}}}}],
cb,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21710,end:22534})})(Yb.Morph);Ze=wa("F",function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Xb=cb.hasOwnProperty("FlexLayoutHalo")&&"function"===typeof cb.FlexLayoutHalo?cb.FlexLayoutHalo:cb.FlexLayoutHalo=function(H){H&&
H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"handleDrop",value:function(H){}},{key:"previewDrop",value:function(H){var pa=this;0<this.previews.length||(this.previews=H.map(function(Sa){return pa.container.addMorph({type:Yb.DropPreview,position:pa.container.localize(pa.world().firstHand.position),extent:Sa.bounds().extent()})}),this.previews.forEach(function(Sa){Sa.step()}))}},{key:"remove",value:function(){Tb._get(Object.getPrototypeOf(Xb.prototype),
"remove",this).call(this);this.removePreviews();return this}},{key:"removePreviews",value:function(){this.previews.forEach(function(H){return H.clear()})}},{key:"onDrop",value:function(H){this.removePreviews();H.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateAutoResizePolicy",value:function(H){H&&(this.originalExtent=this.container.extent);this.target.autoResize=H;H||(this.container.extent=this.originalExtent||
this.container.extent);this.alignWithTarget()}},{key:"updateResizeSubmorphsPolicy",value:function(H){this.target.resizeSubmorphs=H;this.alignWithTarget()}},{key:"updateAlignmentPolicy",value:function(H){this.target.align=H}},{key:"updateDirectionPolicy",value:function(H){this.target.direction=H}},{key:"updateSpacing",value:function(H){this.target.spacing=H}},{key:"optionControls",value:function(){var H=this.target,pa=H.possibleAlignValues?{fill:Yb.Color.transparent,layout:new Yb.HorizontalLayout({spacing:3,
direction:"centered",align:"center"}),submorphs:[{type:"label",value:"align: "},new Yb.DropDownSelector({name:"alignment",borderRadius:2,padding:3,selectedValue:H.align,values:H.possibleAlignValues})]}:null,Sa=H.possibleDirectionValues?{fill:Yb.Color.transparent,layout:new Yb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"direction: "},new Yb.DropDownSelector({name:"direction",borderRadius:2,padding:3,selectedValue:H.direction,values:H.possibleDirectionValues})]}:
null,rb=new Yb.NumberWidget({fill:Yb.Color.white,borderWidth:1,borderRadius:4,padding:Yb.rect(5,4,0,0),borderColor:Yb.Color.gray,min:0,number:H.spacing,unit:"px"}),Sb=new Yb.LabeledCheckBox({name:"autoResize",label:"Resize Container",alignCheckBox:"right",fill:Yb.Color.transparent,checked:H.autoResize});H=new Yb.LabeledCheckBox({label:"Resize Submorphs",name:"resizeSubmorphs",alignCheckBox:"right",fill:Yb.Color.transparent,checked:H.resizeSubmorphs});Yb.connect(rb,"update",this,"updateSpacing");Yb.connect(Sb,
"checked",this,"updateAutoResizePolicy");Yb.connect(H,"checked",this,"updateResizeSubmorphsPolicy");pa&&Yb.connect(pa.submorphs[1],"selectedValue",this,"updateAlignmentPolicy");Sa&&Yb.connect(Sa.submorphs[1],"selectedValue",this,"updateDirectionPolicy");return[Sb,H].concat($jscomp.arrayFromIterable([pa,Sa].filter(Boolean)),[{fill:Yb.Color.transparent,layout:new Yb.HorizontalLayout,submorphs:[{type:"label",value:"Submorph Spacing",fontColor:Yb.Color.gray.darker(),padding:Yb.rect(0,5,5,5)},rb]}])}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FlexLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},fill:{defaultValue:Yb.Color.transparent},halosEnabled:{defaultValue:!1},previews:{defaultValue:[]}}}}],cb,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:22543,end:26761})}(Yb.LayoutHalo));Yb.FlexLayoutHalo=Ze;Yb.FlexLayoutHalo=Ze;Yb.FlexLayoutHalo=Ze;sd=wa("c",function(Wb){var cb=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Xb=cb.hasOwnProperty("ProportionalLayoutHalo")&&"function"===typeof cb.ProportionalLayoutHalo?cb.ProportionalLayoutHalo:cb.ProportionalLayoutHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(Xb,Wb,[{key:"handleDrop",
value:function(H){}},{key:"onDrop",value:function(H){H.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateSubmorphProportionalLayoutSettings",value:function(H){var pa={};this.target.changeSettingsFor(H.submorph,(pa[H.axis]=H.policy,pa),!0)}},{key:"onSubmorphSettingsDragStart",value:function(H,pa){var Sa=this;H.stop();var rb=this.target.settingsFor(pa);pa="";for(var Sb in rb)pa+=Sb+":"+rb[Sb]+" ";var Eb=Yb.morph({type:"label",
value:pa,isLayoutable:!1});Eb.wantsToBeDroppedOn=function(Mc){return Sa.target.layoutableSubmorphs.includes(Mc)};Eb.onBeingDroppedOn=function(Mc,Fc){Eb.remove();if(Mc=Sa.target.layoutableSubmorphs.includes(Fc)?Fc:H.world.morphsContainingPoint(H.hand.position).find(function(xd){return Sa.target.layoutableSubmorphs.includes(xd)}))Sa.updateSubmorphProportionalLayoutSettings({policy:rb.x,axis:"x",submorph:Mc}),Sa.updateSubmorphProportionalLayoutSettings({policy:rb.y,axis:"y",submorph:Mc}),Mc.show(),$world.setStatusMessage("layout settings applied")};
H.hand.grab(Eb)}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var H=this,pa,Sa,rb,Sb,Eb,Mc,Fc,xd,Ve,Kd,fe,ge;return $jscomp.asyncExecutePromiseGeneratorProgram(function(te){switch(te.nextAddress){case 1:return pa=H.target.layoutableSubmorphs,H.env.eventDispatcher.isKeyPressed("Shift")?(rb=pa.map(function(Kc){return{isListItem:!0,string:String(Kc),value:Kc}}),te.yield($world.listPrompt("Select morph",rb,{requester:H,onSelection:function(Kc){return Kc.show()}}),5)):te.yield(Yb.InteractiveMorphSelector.selectMorph(H.world(),
H,function(Kc){return pa.includes(Kc)}),4);case 4:Sa=te.yieldResult;te.jumpTo(3);break;case 5:Sb=te.yieldResult,Eb=$jscomp.makeIterator(Sb.selected),Sa=Eb.next().value;case 3:if(!Sa)return te.return();Mc=H.state.popover.get("controlContainer");Fc=Mc.getAllNamed(/submorph config/);xd=["move","resize","scale","fixed"];Ve=H.target.settingsFor(Sa);Fc.length||(Mc.submorphs=[].concat($jscomp.arrayFromIterable(Mc.submorphs),[{name:"submorph config X-Axis policy",position:Yb.pt(0,H.height),fill:Yb.Color.transparent,
layout:new Yb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph X-Axis policy: "},new Yb.DropDownSelector({name:"x-axis policy selector",borderRadius:2,padding:3,selectedValue:Ve.x,values:xd})]},{name:"submorph config Y-Axis policy",position:Yb.pt(0,H.height),fill:Yb.Color.transparent,layout:new Yb.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph Y-Axis policy: "},new Yb.DropDownSelector({name:"y-axis policy selector",
borderRadius:2,padding:3,selectedValue:Ve.y,values:xd})]},Yb.morph({position:Yb.pt(0,H.height+20),draggable:!0,name:"dragme",type:"label",value:"drag me to copy"})]));Kd=Mc.getSubmorphNamed("x-axis policy selector");fe=Mc.getSubmorphNamed("y-axis policy selector");ge=Mc.getSubmorphNamed("dragme");Yb.disconnect(Kd,"selectedValue",H,"updateSubmorphProportionalLayoutSettings");Yb.disconnect(fe,"selectedValue",H,"updateSubmorphProportionalLayoutSettings");Kd.selectedValue=Ve.x;fe.selectedValue=Ve.y;Yb.connect(ge,
"onDragStart",H,"onSubmorphSettingsDragStart",{updater:function(Kc,ef){return Kc(ef,Sa)},varMapping:{submorph:Sa}});Yb.connect(Kd,"selectedValue",H,"updateSubmorphProportionalLayoutSettings",{converter:function(Kc){return{policy:Kc,axis:"x",submorph:Sa}},varMapping:{submorph:Sa}});Yb.connect(fe,"selectedValue",H,"updateSubmorphProportionalLayoutSettings",{converter:function(Kc){return{policy:Kc,axis:"y",submorph:Sa}},varMapping:{submorph:Sa}});te.jumpToEnd()}})}},{key:"optionControls",value:function(H){this.state.popover=
H;var pa=this.target;H=new Yb.LabeledCheckBox({name:"x-axis",label:"X-Axis",alignCheckBox:"right",fill:Yb.Color.transparent,checked:pa.xAxisEnabled});pa=new Yb.LabeledCheckBox({name:"y-axis",label:"Y-Axis",alignCheckBox:"right",fill:Yb.Color.transparent,checked:pa.yAxisEnabled});var Sa=new Yb.Button({name:"modify submorph settings button",label:[].concat($jscomp.arrayFromIterable(Yb.Icon.textAttribute("crosshairs")),["\u00a0Change submorph settings"])});Yb.connect(H,"checked",this,"updateXAxisEnabled");
Yb.connect(pa,"checked",this,"updateYAxisEnabled");Yb.connect(Sa,"fire",this,"chooseSubmorphToChangeLayoutSettings");return[Sa]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProportionalLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},fill:{defaultValue:Yb.Color.transparent}}}}],cb,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:26771,end:32465})}(Yb.LayoutHalo));Yb.ProportionalLayoutHalo=sd;Yb.ProportionalLayoutHalo=sd;Yb.ProportionalLayoutHalo=sd;var Ce=lively.FreezerRuntime.recorderFor("lively.halos/index.js");Ce.Halo=ld;Ce.MorphHighlighter=od;Ce.InteractiveMorphSelector=Be;Ce.StatusMessage=wb;Ce.StatusMessageForMorph=fc;Ce.show=hb;Ce.showConnector=dc;Ce.ProportionalLayoutHalo=sd;Ce.GridLayoutHalo=Lc;Ce.FlexLayoutHalo=Ze;Ce.showAndSnapToGuides=ra;
Ce.removeSnapToGuidesOf=V;Ce.StatusMessage=wb;Ce.StatusMessage=wb;Ce.StatusMessageForMorph=fc;Ce.StatusMessageForMorph=fc;Ce.show=hb;Ce.show=hb;Ce.showConnector=dc;Ce.showConnector=dc;Ce.Halo=ld;Ce.Halo=ld;Ce.MorphHighlighter=od;Ce.MorphHighlighter=od;Ce.InteractiveMorphSelector=Be;Ce.InteractiveMorphSelector=Be;Ce.ProportionalLayoutHalo=sd;Ce.ProportionalLayoutHalo=sd;Ce.GridLayoutHalo=Lc;Ce.GridLayoutHalo=Lc;Ce.FlexLayoutHalo=Ze;Ce.FlexLayoutHalo=Ze;Ce.showAndSnapToGuides=ra;Ce.showAndSnapToGuides=
ra;Ce.removeSnapToGuidesOf=V;Ce.removeSnapToGuidesOf=V;wb=Object.freeze({__proto__:null,StatusMessage:wb,StatusMessageForMorph:fc,show:hb,showConnector:dc,Halo:ld,MorphHighlighter:od,InteractiveMorphSelector:Be,ProportionalLayoutHalo:sd,GridLayoutHalo:Lc,FlexLayoutHalo:Ze,showAndSnapToGuides:ra,removeSnapToGuidesOf:V,SvgStyleHalo:void 0});wa("i",wb);wa("_",void 0)}}});
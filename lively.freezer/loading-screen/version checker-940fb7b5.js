System.register(["./__root_module__-7d3cbdeb.js","./index-2d023b08.js","kld-intersections","./index-00525174.js"],function(){var Ka,wb,Ab,gc,Kb;return{setters:[function(Zc){Ka=Zc.M;wb=Zc.ba;Ab=Zc.r;gc=Zc.i},function(Zc){Kb=Zc.e},function(){},function(){}],execute:function(){var Zc=lively.FreezerRuntime.recorderFor("VersionChecker/index.js");Zc.Morph=Ka;Zc.runCommand=wb;Zc.evalOnServer=Kb;Zc.resource=Ab;var Kc=function(md){var Fc=lively.FreezerRuntime.recorderFor("VersionChecker/index.js"),Bc=
Fc.hasOwnProperty("VersionChecker")&&"function"===typeof Fc.VersionChecker?Fc.VersionChecker:Fc.VersionChecker=function(Nc){Nc&&Nc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return gc(Bc,md,[{key:"onLoad",value:function(){this.isComponent||this.withAllSubmorphsDo(function(Nc){return Nc.halosEnabled=!1})}},{key:"checkVersion",value:function(){this.reset();this.checkIfUpToDate()}},{key:"onMouseDown",value:function(Nc){gc._get(Object.getPrototypeOf(Bc.prototype),
"onMouseDown",this).call(this,Nc);this.isComponent||this.checkVersion()}},{key:"relayout",value:function(){var Nc=this;this.world().withTopBarDo(function(Uc){Nc.bottomLeft=Uc.sideBar&&Uc.sideBar.visible?Uc.sideBar.bottomRight.addXY(10,-10):Nc.world().visibleBounds().insetBy(10).bottomLeft()})}},{key:"checkIfUpToDate",value:function(){var Nc=this,Uc,ce,Zd,pe,Mc,Kd,Jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Dc){switch(Dc.nextAddress){case 1:return Uc="git rev-parse master",Dc.yield(Zc.evalOnServer("System.baseURL").then(function(nd){return nd.replace("file://",
"")}),2);case 2:return ce=Dc.yieldResult,Dc.yield(Zc.runCommand("git fetch",{cwd:ce}).whenDone(),3);case 3:return Dc.yield(Zc.runCommand(Uc,{cwd:ce}).whenDone(),4);case 4:return Zd=Dc.yieldResult,pe=Zd.stdout,Mc=pe.split("\n")[0],Dc.yield(Zc.resource("https://api.github.com/repos/LivelyKernel/lively.next/commits/master").readJson(),5);case 5:return Kd=Dc.yieldResult,Jb=Kd.sha,Mc!=Jb?Dc.return(Nc.showOutdated(Mc.slice(0,6))):Dc.return(Nc.showUpToDate(Mc.slice(0,6)))}})}},{key:"showOutdated",value:function(Nc){var Uc=
this.ui,ce=Uc.checking,Zd=Uc.outdated;Uc.status.value=["Version: ",{},"["+Nc+"]",{fontWeight:"bold"}," (Please update!)"];ce.visible=ce.isLayoutable=!1;Zd.visible=Zd.isLayoutable=!0}},{key:"showUpToDate",value:function(Nc){var Uc=this.ui,ce=Uc.checking,Zd=Uc.latest;Uc.status.value=["Version: ",{},"["+Nc+"]",{fontWeight:"bold"}];ce.visible=ce.isLayoutable=!1;Zd.visible=Zd.isLayoutable=!0}},{key:"reset",value:function(){var Nc=this.ui,Uc=Nc.checking,ce=Nc.outdated,Zd=Nc.latest;Nc.status.value="Checking version...";
Uc.visible=Uc.isLayoutable=!0;ce.visible=Zd.visible=ce.isLayoutable=Zd.isLayoutable=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"VersionChecker"}},{key:"properties",get:function(){return{isEpiMorph:{derived:!0,get:function(){return!this.isComponent}},respondsToVisibleWindow:{derived:!0,get:function(){return!this.isComponent}},ui:{derived:!0,get:function(){return{status:this.get("version status label"),checking:this.get("loading indicator"),outdated:this.get("icon outdated"),
latest:this.get("icon latest")}}}}}}],Fc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"VersionChecker",version:"0.1.1-27"}}},{start:232,end:2913})}(Zc.Morph);Kc=Zc.VersionChecker;Zc.default=Kc}}});
System.register(["./__rootModule___commonjs-entry-71573ff5.js","./index-ca98f65e.js","./index-d18accbd.js","./loading-indicator.cp-b18e3b89.js","./value-widgets-6cb12552.js"],function(Lc,pd){var Nd,Tc,Jc,$d,Bb,rd,Id,Ac,Pc,gd,nd,Fd,ic,vd,sb,Xb,Nb,bc,hb,cb,Hb,ec,ub,yb,ba,wb,Xa,Za,Sb,Cb,Da,zb,db,ib,Ea,W,T,ia,ka,K,ya,pb,La,eb;return{setters:[function(jb){Nd=jb.f;Tc=jb.b;Jc=jb.C;$d=jb.q;Bb=jb.x;rd=jb.G;Id=jb.y;Ac=jb.B;Pc=jb.d;gd=jb.k;nd=jb.R;Fd=jb.e;ic=jb.M;vd=jb.aF;sb=jb.v;Xb=jb.i;Nb=jb._;bc=jb.D;hb=
jb.L;cb=jb.H;Hb=jb.P;ec=jb.m;ub=jb.aG;yb=jb.I;ba=jb.a3;wb=jb.r;Xa=jb.K;Za=jb.l;Sb=jb.U;Cb=jb.n;Da=jb.j;zb=jb.w;db=jb.h;ib=jb.X;Ea=jb.aH;W=jb.E;T=jb.O;ia=jb.z},function(jb){ka=jb.m},function(jb){K=jb.a;ya=jb.D;pb=jb.M},function(jb){La=jb.B},function(jb){eb=jb.N}],execute:function(){function jb(Kb){(Kb=Ja.cachedGuideLines.get(Kb))&&Kb.forEach(function(Db){return Db.remove()})}function E(Kb){var Db=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,Ra=2<arguments.length&&void 0!==arguments[2]?
arguments[2]:!0,N=3<arguments.length&&void 0!==arguments[3]?arguments[3]:10,va=4<arguments.length&&void 0!==arguments[4]?arguments[4]:100;if(Db||Ra){var Wa=Kb.owner,pa=Wa.world();Wa=Wa.getGlobalTransform();var tb=Kb.owner.submorphs.filter(function(Fa){return Fa!==Kb&&!Fa.isEpiMorph&&Fa.visible&&Fa.reactsToPointer}),ab=Ja.findAlignedMorphs(Kb,tb,N,va,"left top right bottom hCenter vCenter".split(" "),"left top right bottom hCenter vCenter".split(" "));va=[];var Ob=0,yc=0,Ta=0,Bd=0;Wa.e-=pa.scroll.x;
Wa.f-=pa.scroll.y;if(ab){ab=rd(ab);var Eb;try{for(ab.s();!(Eb=ab.n()).done;){var fe=Bb(Eb.value,2)[1],Od=fe.vertical,Hd=rd(fe.horizontal),Qc;try{for(Hd.s();!(Qc=Hd.n()).done;){var Xd=Qc.value,oc=Xd.edgeAVal,rf=Xd.refPointsA,Dd=Xd.refPointsB,ld=Xd.edgeBVal,Td=Math.ceil(N-Xd.delta),gb=Math.min(rf.top,Dd.top),Vc=Math.max(rf.bottom,Dd.bottom);Xd.maxDist>N&&(Td-=N/2);Ob<Td&&(Ob=Td,Ta=ld-oc);va.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Ja.guideWidth,start:Wa.transformPoint(Ja.pt(ld,gb)),
end:Wa.transformPoint(Ja.pt(ld,Vc)),fill:Ja.guideColor,guideType:"h",priority:Td})}}catch(Fa){Hd.e(Fa)}finally{Hd.f()}var vb=rd(Od),cc;try{for(vb.s();!(cc=vb.n()).done;){var ob=cc.value,ac=ob.edgeAVal,ae=ob.refPointsA,qe=ob.refPointsB,lc=ob.edgeBVal,nc=Math.ceil(N-ob.delta),Yc=Math.min(ae.left,qe.left),fd=Math.max(ae.right,qe.right);ob.maxDist>N&&(nc-=N/2);yc<nc&&Math.abs(lc-ac)<=N&&(yc=nc,Bd=lc-ac);va.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Ja.guideWidth,start:Wa.transformPoint(Ja.pt(Yc,
lc)),end:Wa.transformPoint(Ja.pt(fd,lc)),fill:Ja.guideColor,guideType:"v",priority:nc})}}catch(Fa){vb.e(Fa)}finally{vb.f()}}}catch(Fa){ab.e(Fa)}finally{ab.f()}}if(!Ob||!yc){Eb=[Kb].concat(Id(tb));Qc=Ja.computeClosestMorphs(Eb);Hd=Qc[0];Eb=Hd.l;fe=Hd.r;Od=Hd.t;Hd=Hd.b;var ua;if(Eb||fe||Od||Hd){var Ab=(Eb||fe||Od||Hd).refPointsA;for(Xd=1;Xd<Qc.length&&(ld=Qc[Xd],oc=ld.l,rf=ld.r,Dd=ld.t,ld=ld.b,Ob||(Eb&&oc&&Eb.index!==oc.index&&Math.abs(oc.dist-Eb.dist)<=N?ua=Object.assign({neighbor:Xd,direction:"left"},
oc):fe&&rf&&fe!==rf.index&&Math.abs(rf.dist-fe.dist)<=N&&(ua=Object.assign({neighbor:Xd,direction:"right"},rf))),yc||(Od&&Dd&&Od.index!==Dd.index&&Math.abs(Dd.dist-Od.dist)<=N?ua=Object.assign({neighbor:Xd,direction:"top"},Dd):Hd&&ld&&Hd.index!==ld.index&&Math.abs(ld.dist-Hd.dist)<=N&&(ua=Object.assign({neighbor:Xd,direction:"bottom"},ld))),!ua);Xd++);}ua&&(Qc=ua,N=Qc.direction,ld=Qc.refPointsA,ae=Qc.refPointsB,Dd=Qc.dist,vb=Ab.left,Td=Ab.top,qe=Ab.bottom,nc=Ab.right,cc=Ab.width,ob=Ab.height,Ab=ld.left,
Qc=ld.top,Xd=ld.bottom,oc=ld.right,rf=ld.width,ld=ld.height,ac=ae.left,gb=ae.top,Vc=ae.bottom,lc=ae.right,ae="left"===N?vb:"right"===N?nc:vb+cc/2,qe="bottom"===N?qe:"top"===N?Td:Td+ob/2,vb="left"===N?ae-Dd:"right"===N?ae+Dd:vb+cc/2,Dd="bottom"===N?qe+Dd:"top"===N?qe-Dd:Td+ob/2,Td="left"===N?lc:"right"===N?ac:Ab+rf/2,gb="bottom"===N?gb:"top"===N?Vc:Qc+ld/2,!Ra||Ob||"right"!==N&&"left"!==N||(Ob=10,Ta=(ua.dist-(fe||Eb).dist)*("right"===N?-1:1),ae+=Ta,vb+=Ta),!Ra||yc||"top"!==N&&"bottom"!==N||(yc=10,
Bd=((Od||Hd).dist-ua.dist)*("top"===N?-1:1),qe+=Bd,Dd+=Bd),va.push({type:"line",epiMorph:!0,hasFixedPosition:!0,start:Wa.transformPoint(Ja.pt("left"===N?Ab:"right"===N?oc:Ab+rf/2,"bottom"===N?Xd:"top"===N?Qc:Qc+ld/2)),end:Wa.transformPoint(Ja.pt(Td,gb)),fill:Ja.Color.orange,height:Ja.guideWidth,guideType:N,priority:10},{type:"line",epiMorph:!0,hasFixedPosition:!0,start:Wa.transformPoint(Ja.pt(ae,qe)),end:Wa.transformPoint(Ja.pt(vb,Dd)),fill:Ja.Color.orange,height:Ja.guideWidth,guideType:N,priority:10}))}Ra&&
(Ta||Bd)&&Kb.moveBy(Ja.pt(Ta,Bd));if(Db){va=va.filter(function(Fa){var za=Fa.guideType;Fa=Fa.priority;return"h"===za?Fa===Ob:"v"===za?Fa===yc:!0});(Db=Ja.cachedGuideLines.get(Kb))||Ja.cachedGuideLines.set(Kb,Db=[]);for(Ra=0;Ra<va.length;Ra++)ua=void 0,Db[Ra]?ua=Object.assign(Db[Ra],va[Ra]):(ua=Ja.morph(va[Ra]),Db.push(ua)),ua.owner||pa.addMorph(ua);Db.slice(Ra).forEach(function(Fa){return Fa.remove()});Ja.fun.debounceNamed(Kb.id+"-drag-guides-cleanup",1300,function(){var Fa=Ja.cachedGuideLines.get(Kb);
Fa&&Fa.forEach(function(za){return za.remove()})})()}}}function Wb(Kb,Db){var Ra=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0,N=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!0,va=4<arguments.length&&void 0!==arguments[4]?arguments[4]:5,Wa=5<arguments.length&&void 0!==arguments[5]?arguments[5]:100;if(Ra||N){var pa=Kb.owner,tb=pa.world(),ab=pa.getGlobalTransform(),Ob=Kb.owner.submorphs.filter(function(fa){return fa!==Kb&&!fa.isEpiMorph&&fa.visible&&fa.reactsToPointer});pa=(Db.includes("left")||
Db.includes("right")?"x":"")+(Db.includes("top")||Db.includes("bottom")?"y":"");var yc=Ja.findMorphsWithSimilarWidthOrHeight(Kb,pa,Ob,va,Wa),Ta=-Infinity,Bd=-Infinity,Eb=0,fe=0,Od=0,Hd=0,Qc=0,Xd=0;pa=[];ab.e-=tb.scroll.x;ab.f-=tb.scroll.y;if(yc){yc=rd(yc);var oc;try{for(yc.s();!(oc=yc.n()).done;){var rf=Bb(oc.value,2)[1],Dd=rf.similarIn,ld=rf.delta,Td=rf.refPointsA,gb=rf.refPointsB,Vc=va-ld+(Wa-rf.minDist);"width"===Dd?Ta<Vc&&(Ta=Vc,Db.includes("left")&&(fe=-ld),Db.includes("right")&&(Eb=ld)):Bd<
Vc&&(Bd=Vc,Db.includes("top")&&(Od=-ld),Db.includes("bottom")&&(Hd=ld));var vb={type:"line",epiMorph:!0,hasFixedPosition:!0,height:Ja.guideWidth,fill:Ja.guideColor,guideType:Dd,priority:Vc,start:ab.transformPoint("width"===Dd?Ja.pt(Td.left,Td.top+Td.height/2):Ja.pt(Td.left+Td.width/2,Td.top)),end:ab.transformPoint("width"===Dd?Ja.pt(Td.right,Td.top+Td.height/2):Ja.pt(Td.left+Td.width/2,Td.bottom))},cc=Object.assign({},vb,{start:ab.transformPoint("width"===Dd?Ja.pt(gb.left,gb.top+gb.height/2):Ja.pt(gb.left+
gb.width/2,gb.top)),end:ab.transformPoint("width"===Dd?Ja.pt(gb.right,gb.top+gb.height/2):Ja.pt(gb.left+gb.width/2,gb.bottom))});pa.push(vb,cc)}}catch(fa){yc.e(fa)}finally{yc.f()}}if(Wa=Ja.findAlignedMorphs(Kb,Ob,va,Wa,Db,void 0)){Wa=rd(Wa);var ob;try{for(Wa.s();!(ob=Wa.n()).done;){var ac=Bb(ob.value,2)[1],ae=ac.vertical,qe=rd(ac.horizontal),lc;try{for(qe.s();!(lc=qe.n()).done;){var nc=lc.value,Yc=nc.edgeAVal,fd=nc.refPointsA,ua=nc.refPointsB,Ab=nc.edgeBVal,Fa=Math.ceil(va-nc.delta),za=Math.min(fd.top,
ua.top),Ka=Math.max(fd.bottom,ua.bottom);nc.maxDist>va&&(Fa-=va/2);Qc<Fa&&(Qc=Fa,Db.includes("left")&&(fe=-(Ab-Yc)),Db.includes("right")&&(Eb=+(Ab-Yc)));pa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Ja.guideWidth,start:ab.transformPoint(Ja.pt(Ab,za)),end:ab.transformPoint(Ja.pt(Ab,Ka)),fill:Ja.guideColor,guideType:"h",priority:Fa})}}catch(fa){qe.e(fa)}finally{qe.f()}var Ib=rd(ae),C;try{for(Ib.s();!(C=Ib.n()).done;){var Pb=C.value,da=Pb.edgeAVal,wa=Pb.refPointsA,ca=Pb.refPointsB,ma=Pb.edgeBVal,
u=Math.ceil(va-Pb.delta),O=Math.min(wa.left,ca.left),P=Math.max(wa.right,ca.right);Pb.maxDist>va&&(u-=va/2);Xd<u&&Math.abs(ma-da)<=va&&(Xd=u,Db.includes("top")&&(Od=ma-da),Db.includes("bottom")&&(Hd=ma-da));pa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Ja.guideWidth,start:ab.transformPoint(Ja.pt(O,ma)),end:ab.transformPoint(Ja.pt(P,ma)),fill:Ja.guideColor,guideType:"v",priority:u})}}catch(fa){Ib.e(fa)}finally{Ib.f()}}}catch(fa){Wa.e(fa)}finally{Wa.f()}}N&&(fe&&(Kb.left+=fe,Kb.right-=
fe),Od&&(Kb.top+=Od,Kb.bottom-=Od),Eb&&(Kb.width+=Eb),Hd&&(Kb.height+=Hd));if(Ra){pa=pa.filter(function(fa){var Qa=fa.guideType;fa=fa.priority;return"width"===Qa?fa===Ta:"height"===Qa?fa===Bd:"v"===Qa?fa===Xd:"h"===Qa?fa===Qc:!1});(Ra=Ja.cachedGuideLines.get(Kb))||Ja.cachedGuideLines.set(Kb,Ra=[]);for(N=0;N<pa.length;N++)va=void 0,Ra[N]?va=Object.assign(Ra[N],pa[N]):(va=Ja.morph(pa[N]),Ra.push(va)),va.owner||tb.addMorph(va);Ra.slice(N).forEach(function(fa){return fa.remove()});Ja.fun.debounceNamed(Kb.id+
"-drag-guides-cleanup",1300,function(){var fa=Ja.cachedGuideLines.get(Kb);fa&&fa.forEach(function(Qa){return Qa.remove()})})()}}}function R(){R=Nb(regeneratorRuntime.mark(function va(Db,Ra,N){var Wa;return regeneratorRuntime.wrap(function(pa){for(;;)switch(pa.prev=pa.next){case 0:return Ga.showThenHide(Db,Ra,!1),pa.next=3,Ga.promise.delay(300);case 3:Wa=!1,Ga.once(Db,"onMouseDown",function(){return Wa=!0}),Ga.once(Db,"hideMarkers",function(){return Wa=!0});case 6:if(Wa){pa.next=11;break}pa.next=9;
return Ra.retract(N);case 9:pa.next=6;break;case 11:Ra.fadeOut(2E3);case 12:case "end":return pa.stop()}},va)}));return R.apply(this,arguments)}function xb(Kb){var Db=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,Ra=Ga.MorphicEnv["default"]().world;if(null===Kb||void 0===Kb)Kb=String(Kb);if(Kb.isMorph)return Ga.showRect(Kb.world(),Kb.globalBounds().translatedBy(Ra.scroll.negated()),Db);if(Kb.isPoint)return Ga.showRect(Ra,new Ga.Rectangle(Kb.x-5,Kb.y-5,10,10));if(Kb.isLine)return Ga.showLine(Ra,
Kb);if(Kb.isRectangle)return Ga.showRect(Ra,Kb);if("undefined"!==typeof Element&&Kb instanceof Element)return Ga.showRect(Ra,Ga.Rectangle.fromElement(Kb));if("number"===typeof Kb||"symbol"===bc(Kb)||"boolean"===typeof Kb||"undefined"!==typeof Node&&Kb instanceof Node||Kb instanceof RegExp)Kb=String(Kb);"object"===bc(Kb)&&(Kb=Ga.obj.inspect(Kb,{maxDepth:1}));return"string"===typeof Kb&&1===arguments.length?Ra.setStatusMessage(Kb):Ra.setStatusMessage(Ga.string.formatFromArray(Array.from(arguments)))}
Lc({a:E,r:jb,s:xb});var Ja=window.lively.FreezerRuntime.recorderFor("lively.halos/drag-guides.js");Ja.removeSnapToGuidesOf=jb;Ja.computeRefPoints=function(Kb){var Db=Kb.x,Ra=Kb.y,N=Kb.width;Kb=Kb.height;return{left:Db,top:Ra,hCenter:Db+N/2,vCenter:Ra+Kb/2,right:Db+N,bottom:Ra+Kb,width:N,height:Kb}};Ja.closest=function(Kb,Db,Ra,N,va,Wa,pa){for(var tb=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!0,ab=N[Kb],Ob=va[Kb],yc=Wa[Kb],Ta=pa[Kb],Bd,Eb,fe,Od,Hd=0;Hd<va.length;Hd++)Kb===Hd||ab<va[Hd]||
Bd&&va[Bd.index]>=va[Hd]||tb&&pa[Kb]<Wa[Hd]||Wa[Kb]>pa[Hd]||(Bd={index:Hd,dist:ab-va[Hd],refPointsA:Ra[Kb],refPointsB:Ra[Hd]});for(ab=0;ab<N.length;ab++)Kb===ab||Ob>N[ab]||Eb&&N[Eb.index]<=N[ab]||tb&&pa[Kb]<Wa[ab]||Wa[Kb]>pa[ab]||(Eb={index:ab,dist:N[ab]-Ob,refPointsA:Ra[Kb],refPointsB:Ra[ab]});for(Ob=0;Ob<pa.length;Ob++)Kb===Ob||yc<pa[Ob]||fe&&pa[fe.index]>=pa[Ob]||tb&&N[Kb]>va[Ob]||va[Kb]<N[Ob]||(fe={index:Ob,dist:yc-pa[Ob],refPointsA:Ra[Kb],refPointsB:Ra[Ob]});for(yc=0;yc<Wa.length;yc++)Kb===yc||
Ta>Wa[yc]||Od&&Wa[Od.index]<=Wa[yc]||tb&&N[Kb]>va[yc]||va[Kb]<N[yc]||(Od={index:yc,dist:Wa[yc]-Ta,refPointsA:Ra[Kb],refPointsB:Ra[yc]});return{l:Bd,r:Eb,t:fe,b:Od}};Ja.computeClosestMorphs=function(Kb){for(var Db=[],Ra=[],N=[],va=[],Wa=[],pa=[],tb=0;tb<Kb.length;tb++){var ab=Ja.computeRefPoints(Kb[tb].bounds());Wa.push(ab);var Ob=ab.right,yc=ab.top,Ta=ab.bottom;Db.push(ab.left);Ra.push(Ob);N.push(yc);va.push(Ta)}for(tb=0;tb<Kb.length;tb++)pa.push(Ja.closest(tb,Kb,Wa,Db,Ra,N,va));return pa};Ja.findEdgesInAlignment=
function(Kb,Db){for(var Ra=2<arguments.length&&void 0!==arguments[2]?arguments[2]:15,N=3<arguments.length?arguments[3]:void 0,va=4<arguments.length?arguments[4]:void 0,Wa=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,pa=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,tb=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,ab=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,Ob=9<arguments.length&&void 0!==arguments[9]?arguments[9]:0,yc=[],Ta=[],Bd=0;Bd<Ja.edges.length;Bd++){var Eb=
Bb(Ja.edges[Bd],3),fe=Eb[0],Od=Eb[1];Eb=Eb[2];var Hd=Kb[Od],Qc=Db[Eb],Xd=Math.max(Hd,Qc)-Math.min(Hd,Qc);Xd>Ra||!(N&&!N.includes(Od)||va&&!va.includes(Eb))&&("vertical"===fe?yc:Ta).push({delta:Xd,edgeA:Od,edgeB:Eb,edgeAVal:Hd,edgeBVal:Qc,refPointsA:Kb,refPointsB:Db,distLeft:Wa,distTop:pa,distRight:tb,distBottom:ab,maxDist:Ob})}return yc.length||Ta.length?{vertical:yc,horizontal:Ta}:null};Ja.findAlignedMorphs=function(Kb,Db){for(var Ra=2<arguments.length&&void 0!==arguments[2]?arguments[2]:15,N=3<
arguments.length&&void 0!==arguments[3]?arguments[3]:Infinity,va=4<arguments.length?arguments[4]:void 0,Wa=5<arguments.length?arguments[5]:void 0,pa,tb=Ja.computeRefPoints(Kb.bounds()),ab=0;ab<Db.length;ab++){var Ob=Db[ab];if(Ob!==Kb){var yc=Ja.computeRefPoints(Ob.bounds()),Ta=Math.max(0,tb.left-yc.right),Bd=Math.max(0,yc.left-tb.right),Eb=Math.max(0,tb.top-yc.bottom),fe=Math.max(0,yc.top-tb.bottom);Math.max(fe,Eb,Bd,Ta)>N||!(yc=Ja.findEdgesInAlignment(tb,yc,Ra,va,Wa,Ta,Eb,Bd,fe,Math.max(fe,Eb,Bd,
Ta)))||(pa||(pa=new Map),pa.set(Ob,yc))}}N=Kb.owner;va=Ja.computeRefPoints(N.innerBounds());if(Ra=Ja.findEdgesInAlignment(tb,va,Ra))pa||(pa=new Map),pa.set(N,Ra);return pa};Ja.showAndSnapToGuides=E;Ja.findMorphsWithSimilarWidthOrHeight=function(Kb,Db,Ra){for(var N=3<arguments.length&&void 0!==arguments[3]?arguments[3]:15,va=4<arguments.length&&void 0!==arguments[4]?arguments[4]:Infinity,Wa,pa=Ja.computeRefPoints(Kb.bounds()),tb=0;tb<Ra.length;tb++){var ab=Ra[tb];if(ab!==Kb){var Ob=Ja.computeRefPoints(ab.bounds()),
yc=Math.max(0,pa.left-Ob.right),Ta=Math.max(0,Ob.left-pa.right),Bd=Math.max(0,pa.top-Ob.bottom),Eb=Math.max(0,Ob.top-pa.bottom),fe=Math.min(Eb,Bd,Ta,yc),Od=Math.max(Eb,Bd,Ta,yc);if(!(Math.max(Eb,Bd,Ta,yc)>va)){yc=pa.width;Ta=pa.height;Bd=Ob.width;Eb=Ob.height;var Hd=Bd-yc,Qc=Eb-Ta;("x"===Db||"xy"===Db)&&Math.abs(Hd)<=N&&(Wa||(Wa=new Map),Wa.set(ab,{similarIn:"width",minDist:fe,maxDist:Od,refPointsA:pa,refPointsB:Ob,valA:yc,valB:Bd,delta:Hd}));("y"===Db||"xy"===Db)&&Math.abs(Qc)<=N&&(Wa||(Wa=new Map),
Wa.set(ab,{similarIn:"height",minDist:fe,maxDist:Od,refPointsA:pa,refPointsB:Ob,valA:Ta,valB:Eb,delta:Qc}))}}}return Wa};Ja.showAndSnapToResizeGuides=Wb;Ja.fun=Nd;Ja.pt=Tc;Ja.Color=Jc;Ja.morph=$d;Ja.cachedGuideLines=new WeakMap;Ja.guideWidth=1;Ja.guideColor=Ja.Color.orange.lighter();Ja.edges=[["vertical","top","top"],["vertical","vCenter","top"],["vertical","bottom","top"],["vertical","top","vCenter"],["vertical","vCenter","vCenter"],["vertical","bottom","vCenter"],["vertical","top","bottom"],["vertical",
"vCenter","bottom"],["vertical","bottom","bottom"],["horizontal","left","left"],["horizontal","hCenter","left"],["horizontal","right","left"],["horizontal","left","hCenter"],["horizontal","hCenter","hCenter"],["horizontal","right","hCenter"],["horizontal","left","right"],["horizontal","hCenter","right"],["horizontal","right","right"]];Ja.removeSnapToGuidesOf=jb;Ja.showAndSnapToGuides=E;Ja.showAndSnapToResizeGuides=Wb;var Ga=window.lively.FreezerRuntime.recorderFor("lively.halos/markers.js");Ga.showThenHide=
function(Kb,Db){var Ra=2<arguments.length&&void 0!==arguments[2]?arguments[2]:3;if(Kb){var N=Array.isArray(Db)?Db:[Db];N.forEach(function(va){return Kb.addMorph(va)});Ra&&setTimeout(function(){return N.forEach(function(va){return va.fadeOut(2E3)})},1E3*Ra);return Db}};Ga.showInLoop=function(Kb,Db,Ra){return R.apply(this,arguments)};Ga.showRect=function(Kb,Db,Ra){var N=Ga.BoundsMarker.highlightBounds(Db);return Ra?Ga.showInLoop(Kb,N,Db):Ga.showThenHide(Kb,N)};Ga.showLine=function(Kb,Db){var Ra=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:3E3,N=Db.start,va=Db.end.subPt(N),Wa=Kb.addMorph({position:N,rotation:va.theta(),border:{width:1,color:Ga.Color.red},width:va.fastR(),height:0});Ra&&setTimeout(function(){return Wa.fadeOut()},Ra);return Wa};Ga.show=xb;Ga.obj=Ac;Ga.promise=Pc;Ga.string=gd;Ga.pt=Tc;Ga.Color=Jc;Ga.Rectangle=nd;Ga.morph=$d;Ga.easings=Fd;Ga.Morph=ic;Ga.MorphicEnv=vd;Ga.once=sb;(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),Ra=Db.hasOwnProperty("BoundsMarker")&&
"function"===typeof Db.BoundsMarker?Db.BoundsMarker:Db.BoundsMarker=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:Symbol["for"]("lively-instance-initialize"),value:function(){Xb._get(Object.getPrototypeOf(Ra.prototype),Symbol["for"]("lively-instance-initialize"),this).call(this,{borderWidth:0,fill:Ga.Color.transparent,reactsToPointer:!1,hasFixedPosition:!0})}},{key:"isEpiMorph",
get:function(){return!0}},{key:"markerLength",value:function(N){N=N.insetBy(-2);N=Math.min(N.width,N.height);return Math.max(4,Math.floor(10>N/10?N/2-5:N/10))}},{key:"createMarkerEdge",value:function(){return Ga.morph({fill:Ga.Color.red,reactsToPointer:!1,borderRadius:10})}},{key:"ensureMarkerCorners",value:function(){var N=this.topLeftH||(this.topLeftH=this.addMorph(this.createMarkerEdge())),va=this.topLeftV||(this.topLeftV=this.addMorph(this.createMarkerEdge())),Wa=this.topRightH||(this.topRightH=
this.addMorph(this.createMarkerEdge())),pa=this.topRightV||(this.topRightV=this.addMorph(this.createMarkerEdge())),tb=this.bottomRightH||(this.bottomRightH=this.addMorph(this.createMarkerEdge())),ab=this.bottomRightV||(this.bottomRightV=this.addMorph(this.createMarkerEdge())),Ob=this.bottomLeftH||(this.bottomLeftH=this.addMorph(this.createMarkerEdge())),yc=this.bottomLeftV||(this.bottomLeftV=this.addMorph(this.createMarkerEdge()));return[N,va,Wa,pa,tb,ab,Ob,yc]}},{key:"alignWithMorph",value:function(N){return this.alignWithBounds(N.globalBounds().translatedBy($world.scroll.negated()))}},
{key:"alignWithBounds",value:function(N){this.alignWithRect(N.insetBy(-20));return this.alignWithRect(N,!0)}},{key:"alignWithRect",value:function(N,va){var Wa=this.ensureMarkerCorners(),pa=this.markerLength(N),tb=[N.topLeft().addXY(0,0).extent(Ga.pt(pa,5)),N.topLeft().addXY(0,0).extent(Ga.pt(5,pa)),N.topRight().addXY(-pa,0).extent(Ga.pt(pa,5)),N.topRight().addXY(-5,0).extent(Ga.pt(5,pa)),N.bottomRight().addXY(-5,-pa).extent(Ga.pt(5,pa)),N.bottomRight().addXY(-pa,-5).extent(Ga.pt(pa,5)),N.bottomLeft().addXY(0,
-5).extent(Ga.pt(pa,5)),N.bottomLeft().addXY(0,-pa).extent(Ga.pt(5,pa))];Wa.forEach(function(ab,Ob){return ab.setBounds(tb[Ob])});va&&(this.adjustOrigin(N.center()),this.opacity=0,this.scale=1.5,this.animate({opacity:1,scale:1,duration:300}));return this}},{key:"retract",value:function(){var N=Nb(regeneratorRuntime.mark(function pa(Wa){var tb;return regeneratorRuntime.wrap(function(ab){for(;;)switch(ab.prev=ab.next){case 0:return ab.next=2,this.animate({scale:Math.max(30/Wa.width,1.05)});case 2:return tb=
this.center,ab.next=5,this.animate({center:tb,scale:1,duration:300,easing:Ga.easings.inOutExpo});case 5:case "end":return ab.stop()}},pa,this)}));return function(Wa){return N.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"BoundsMarker"}},{key:"highlightMorph",value:function(N){return(new this).alignWithMorph(N)}},{key:"highlightBounds",value:function(N){return(new this).alignWithBounds(N)}}],Db,{pathInPackage:function(){return"./markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:244,end:3764})})(Ga.Morph);Ga.show=xb;var sa=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js");sa.Morph=ic;sa.Label=hb;sa.HorizontalLayout=cb;sa.Path=Hb;sa.Text=ec;sa.GridLayout=ub;sa.morph=$d;sa.Icon=yb;sa.createMorphSnapshot=ba;sa.Color=Jc;sa.pt=Tc;sa.rect=wb;sa.Rectangle=nd;sa.LinearGradient=Xa;sa.obj=Ac;sa.string=gd;sa.PropertyPath=Za;sa.promise=
Pc;sa.properties=Sb;sa.num=Cb;sa.arr=Da;sa.connect=zb;sa.signal=db;sa.disconnect=ib;sa.disconnectAll=Ea;sa.once=sb;sa.moduleManager=ka;sa.showAndSnapToGuides=E;sa.showAndSnapToResizeGuides=Wb;sa.removeSnapToGuidesOf=jb;sa.show=xb;sa.haloBlue=sa.Color.rgb(23,160,251);sa.componentAccent=sa.Color.magenta;var Ub=Lc("M",function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("MorphHighlighter")&&"function"===typeof Db.MorphHighlighter?Db.MorphHighlighter:
Db.MorphHighlighter=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"alignWithHalo",value:function(){this.target&&(this.position=this.halo.localize(this.target.globalBounds().topLeft()),this.halo.isWorld&&(this.position=this.position.subPt(this.halo.scroll)),this.extent=this.target.globalBounds().extent(),this.get("name tag").value=this.target.name,this.get("name tag").topCenter=
this.innerBounds().insetBy(-10).bottomCenter())}},{key:"show",value:function(){if(this.target&&this.target.layout&&this.showLayout&&(this.layoutHalo=this.layoutHalo||this.world().showLayoutHaloFor(this.target,this.pointerId))&&this.layoutHalo.previewDrop){this.visible=!1;this.alignWithHalo();this.halo.get("grab").hand.grabbedMorphs&&this.layoutHalo.previewDrop(this.halo.get("grab").hand.grabbedMorphs);return}this.visible=!0;this.alignWithHalo()}},{key:"handleDrop",value:function(N){this.layoutHalo&&
this.layoutHalo.handleDrop(N)}},{key:"deactivate",value:function(){this.layoutHalo&&(this.layoutHalo.remove(),this.layoutHalo=null);this.visible=!1;this.alignWithHalo();this.remove()}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"MorphHighlighter"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},name:{defaultValue:"morphHighlighter"},styleClasses:{defaultValue:["inactive"]},reactsToPointer:{defaultValue:!1},hasFixedPosition:{defaultValue:!0},fill:{defaultValue:sa.Color.orange.withA(.3)},
borderWidth:{defaultValue:2},borderColor:{defaultValue:sa.Color.orange},halo:{},epiMorph:{defaultValue:!0},isHighlighter:{readOnly:!0,defaultValue:!0},acceptsDrops:{get:function(){return!!this.layoutHalo}},highlightedSides:{defaultValue:[],set:function(N){var va=this;this.setProperty("highlightedSides",N);this.submorphs=N.map(function(Wa){return{type:"ellipse",isHaloItem:!0,fill:sa.Color.orange,center:va.innerBounds()[Wa]()}});this.addMorph({type:"label",name:"name tag",padding:sa.Rectangle.inset(5,
5,5,5),fontColor:sa.Color.white,fill:sa.Color.orange,borderRadius:3});this.alignWithHalo()}},showLayout:{defaultValue:!1},targetId:{},target:{readOnly:!0,derived:!0,get:function(){return(this.world()||this.env.world).getMorphWithId(this.targetId)}}}}},{key:"removeHighlighters",value:function(){var N=0<arguments.length&&void 0!==arguments[0]?arguments[0]:$world,va=N._morphHighlighters,Wa;for(Wa in va)va[Wa].remove();delete N._morphHighlighters}},{key:"for",value:function(N,va){var Wa=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:!1,pa=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],tb=N._morphHighlighters=N._morphHighlighters||{};sa.properties.forEachOwn(tb,function(ab,Ob){return Ob.alignWithHalo()});if(!va||va.ownerChain().find(function(ab){return ab.isHaloItem}))return null;tb[va.id]=tb[va.id]||new this({targetId:va.id,halo:N,showLayout:Wa});N.addMorph(tb[va.id]);tb[va.id].highlightedSides=pa;return tb[va.id]}},{key:"interceptDrop",value:function(N,va,Wa){(N=N._morphHighlighters=
N._morphHighlighters||{},N[va.id])&&N[va.id].handleDrop(Wa)}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:910,end:4909})}(sa.Morph));sa.MorphHighlighter=Ub;sa.MorphHighlighter=Ub;(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("MultiSelectionTarget")&&
"function"===typeof Db.MultiSelectionTarget?Db.MultiSelectionTarget:Db.MultiSelectionTarget=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"isHaloItem",get:function(){return!0}},{key:"isMorphSelection",get:function(){return!0}},{key:"selectsMorph",value:function(N){return this.selectedMorphs.includes(N)}},{key:"alignWithSelection",value:function(){var N=this.selectedMorphs.map(function(va){return va.globalBounds()}).reduce(function(va,
Wa){return va.union(Wa)});this.setBounds(N)}},{key:"onGrab",value:function(N){this.grabbingHand=N.hand;this.selectionGrabbed=!0;N.hand.grab(this.selectedMorphs);sa.once(N.hand,"dropMorphsOn",this,"onGrabEnd");sa.connect(N.hand,"position",this,"alignWithSelection")}},{key:"onGrabEnd",value:function(){this.selectionGrabbed=!1;sa.disconnectAll(this.grabbingHand)}},{key:"updateExtent",value:function(N){var va=N.value.subPt(N.prevValue);this.selectedMorphs.forEach(function(Wa){return Wa.resizeBy(va)})}},
{key:"updatePosition",value:function(N){if(!this.selectionGrabbed){var va=N.value.subPt(N.prevValue);this.selectedMorphs.forEach(function(Wa){return Wa.moveBy(va)})}}},{key:"updateRotation",value:function(N){var va=this,Wa=N.value-N.prevValue;this.selectedMorphs.forEach(function(pa){var tb=pa.origin;pa.adjustOrigin(pa.localize(va.worldPoint(sa.pt(0,0))));pa.rotation+=Wa;pa.adjustOrigin(tb)})}},{key:"updateScale",value:function(N){var va=this,Wa=N.value-N.prevValue;this.selectedMorphs.forEach(function(pa){var tb=
pa.origin;pa.adjustOrigin(pa.localize(va.worldPoint(sa.pt(0,0))));pa.scale+=Wa;pa.adjustOrigin(tb)})}},{key:"onChange",value:function(N){Xb._get(Object.getPrototypeOf(Ra.prototype),"onChange",this).call(this,N);if(this.modifiesSelectedMorphs){switch(N.prop){case "extent":this.updateExtent(N);break;case "scale":this.updateScale(N);break;case "position":this.updatePosition(N);break;case "rotation":this.updateRotation(N)}return N}}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"MultiSelectionTarget"}},
{key:"properties",get:function(){return{visible:{defaultValue:!1},modifiesSelectedMorphs:{defaultValue:!1},selectedMorphs:{defaultValue:[]},halosEnabled:{defaultValue:!1}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:4977,end:7407})})(sa.Morph);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Ra=Db.hasOwnProperty("HaloPropertyDisplay")&&"function"===typeof Db.HaloPropertyDisplay?Db.HaloPropertyDisplay:Db.HaloPropertyDisplay=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"isHaloItem",get:function(){return!1}},{key:"halo",get:function(){return this.owner}},{key:"displayedValue",value:function(){return this.textString}},{key:"displayProperty",value:function(N){var va=this.halo.state.activeButton;
N=String(N);this.visible=!0;this.textString=N;this.position=this.constructor.defaultPosition;this.bounds().insetBy(10).intersects(va.bounds())&&(this.position=sa.pt(va.topRight.x+10,this.position.y))}},{key:"disable",value:function(){this.position=this.constructor.defaultPosition;this.visible=!1}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"HaloPropertyDisplay"}},{key:"morphName",get:function(){return"propertyDisplay"}},{key:"defaultPosition",get:function(){return sa.pt(25,0)}},
{key:"for",value:function(N){return N.getSubmorphNamed(this.morphName)||N.addMorph(new this({name:this.morphName}))}},{key:"properties",get:function(){return{name:{defaultValue:this.name},fill:{defaultValue:sa.Color.black.withA(.7)},borderRadius:{defaultValue:7},padding:{defaultValue:sa.Rectangle.inset(5)},visible:{defaultValue:!1},readOnly:{defaultValue:!0},fontSize:{defaultValue:12},fontColor:{defaultValue:sa.Color.white},position:{defaultValue:this.defaultPosition}}}}],Db,{pathInPackage:function(){return"./morph.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:7598,end:9096})})(sa.Label);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("HaloItem")&&"function"===typeof Db.HaloItem?Db.HaloItem:Db.HaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return Xb(Ra,Kb,[{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"menuItems",value:function(){return[]}},{key:"init",value:function(){}},{key:"update",value:function(){}},{key:"stop",value:function(){}},{key:"valueForPropertyDisplay",value:function(){}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"HaloItem"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:15},nativeCursor:{defaultValue:"pointer"},fill:{defaultValue:sa.Color.gray.withA(.7)},
grabbable:{defaultValue:!1},extent:{defaultValue:sa.pt(24,24)},halo:{},acceptsDrops:{defaultValue:!1}}}},{key:"for",value:function(N){return N.getSubmorphNamed(this.morphName)||N.addMorph(new this({halo:N,name:this.morphName}))}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:9260,
end:10090})})(sa.Morph);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("NameHolder")&&"function"===typeof Db.NameHolder?Db.NameHolder:Db.NameHolder=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"onHoverIn",value:function(N){this.highlightOnHover&&this.nameHolder.active&&(this.halo.toggleMorphHighlighter(!0,this.target),
this.nameHolder.fontColor=sa.Color.orange)}},{key:"onHoverOut",value:function(N){this.highlightOnHover&&(this.halo.toggleMorphHighlighter(!1,this.target),this.nameHolder.fontColor=sa.Color.darkgray)}},{key:"accept",value:function(){this.target.name!==this.nameHolder.textString&&this.updateName(this.nameHolder.textString)}},{key:"onKeyDown",value:function(N){"Enter"===N.keyCombo?(this.accept(),this.halo.focus(),N.stop()):Xb._get(Object.getPrototypeOf(Ra.prototype),"onKeyDown",this).call(this,N)}},
{key:"onMouseUp",value:function(){sa.signal(this,"active",[!0,this])}},{key:"onMouseDown",value:function(N){this.nameHolder.fontColor=sa.Color.white;this.halo.toggleMorphHighlighter(!1,this.target)}},{key:"onKeyUp",value:function(N){N=this.nameHolder.textString;var va=this.target.owner;this.validName=!va||!va.getSubmorphNamed(N)||this.target.name===N;sa.signal(this,"valid",[this.validName,N])}},{key:"update",value:function(){var N=this;this.nameHolder.textString!==this.target.name&&(this.nameHolder.textString=
this.target.name,this.whenRendered().then(function(){return N.nameHolder.fit()}))}},{key:"activate",value:function(){this.nameHolder.readOnly=!1;this.nameHolder.active=!0;this.nameHolder.animate({opacity:1})}},{key:"deactivate",value:function(){this.nameHolder.readOnly=!0;this.nameHolder.active=!1;this.nameHolder.animate({opacity:.3})}},{key:"updateName",value:function(N){if(!this.forceUniqueName||this.validName)this.target.name=N,sa.signal(this,"active",[!1,this]),(N=$world.getSubmorphNamed("Comment Browser"))&&
N.viewModel.updateName(this.target)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"NameHolder"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Click to edit the morph's name"},draggable:{defaultValue:!1},fill:{defaultValue:sa.Color.transparent},forceUniqueName:{defaultValue:!1},halo:{},layout:{after:["nameHolder"],initialize:function(){this.layout=new sa.HorizontalLayout({renderViaCSS:!0,resizeContainer:!0,spacing:7})}},nameHolder:{after:["submorphs"],initialize:function(){this.nameHolder=
this.addMorph(new sa.Text({fill:sa.Color.transparent,fontColor:sa.Color.white,fontWeight:"bold",active:!0}));sa.connect(this.nameHolder,"onBlur",this,"accept")}}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10126,end:13018})})(sa.Morph);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Ra=Db.hasOwnProperty("NameHaloItem")&&"function"===typeof Db.NameHaloItem?Db.NameHaloItem:Db.NameHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:Symbol["for"]("lively-instance-initialize"),value:function(N){Xb._get(Object.getPrototypeOf(Ra.prototype),Symbol["for"]("lively-instance-initialize"),this).call(this,N);this.initComponentLink();this.initNameHolders();this.validityIndicator=
sa.Icon.makeLabel("check",{fontColor:sa.Color.green,fontSize:15,padding:sa.rect(4,6,4,0)});this.fill=this.halo.target.isComponent?sa.componentAccent:sa.haloBlue;this.alignInHalo()}},{key:"initComponentLink",value:function(){var N=this.halo.target;if(N&&!N.isMorphSelection&&N.master){var va=(N=N.master.determineMaster(N))?N[Symbol["for"]("lively-module-meta")]:!1;N=this.addMorph(sa.Icon.makeLabel(va?"external-link-alt":"exclamation-triangle",{nativeCursor:"pointer",fontColor:sa.Color.white,padding:sa.rect(8,
0,-8,0),name:"master link",tooltip:va?"Located in "+va.module:!1}));va&&sa.connect(N,"onMouseDown",function(){$world.execCommand("open browser",{moduleName:va.module,codeEntity:va["export"]})})}}},{key:"showLocalMaster",value:function(N){var va;if(va=N.getWindow())va.activate(),va.minimized&&(va.minimized=!1);N.show()}},{key:"targets",value:function(){return this.halo.target?this.halo.target.isMorphSelection?this.halo.target.selectedMorphs.map(function(N){return{target:N,highlightOnHover:!0}}):[{target:this.halo.target,
highlightOnHover:!1}]:[]}},{key:"initNameHolders",value:function(){var N=this;this.nameHolders=this.targets().map(function(va){va=new sa.NameHolder({halo:N.halo,highlightOnHover:va.highlightOnHover,target:va.target});sa.connect(va,"active",N,"toggleActive");sa.connect(va,"valid",N,"toggleNameValid");return va});this.submorphs=[].concat(Id(this.submorphs),Id(sa.arr.interpose(this.nameHolders,{extent:sa.pt(1,28),fill:sa.Color.black.withA(.4)})))}},{key:"toggleActive",value:function(N){var va=Bb(N,2);
N=va[0];var Wa=va[1];if(this.halo.changingName!==N){this.halo.changingName=N;if(va=this.get("master link"))va.visible=va.isLayoutable=!N;N?(this.nameHolders.forEach(function(pa){return pa!==Wa&&pa.deactivate()}),this.borderWidth=3,this.addMorph(this.validityIndicator),this.fill=sa.Color.darkGray,setTimeout(function(){return Wa.nameHolder.selectAll()})):(this.fill=sa.haloBlue,this.nameHolders.forEach(function(pa){return pa!==Wa&&pa.activate()}),this.borderWidth=0,this.validityIndicator.remove());this.alignInHalo()}}},
{key:"toggleNameValid",value:function(N){var va=Bb(N,2);N=va[0];va=va[1];(this.validName=N)?(this.conflictingMorph=null,this.borderColor=sa.Color.green,this.validityIndicator.nativeCursor="auto",this.validityIndicator.fontColor=sa.Color.green,sa.Icon.setIcon(this.validityIndicator,"check")):(this.conflictingMorph=this.get(va),this.borderColor=sa.Color.red,this.validityIndicator.fontColor=sa.Color.red,this.validityIndicator.nativeCursor="pointer",sa.Icon.setIcon(this.validityIndicator,"exclamation-circle"))}},
{key:"alignInHalo",value:function(){sa.arr.zip(this.targets(),this.nameHolders).map(function(va){va=Bb(va,2);var Wa=va[1];Wa.target=va[0].target;Wa.update()});var N=this.halo.innerBounds().bottomCenter().addPt(sa.pt(0,2));this.topCenter=sa.pt(Math.max(N.x,30),Math.max(N.y,80))}},{key:"onMouseDown",value:function(N){var va=this,Wa=this.conflictingMorph;Wa&&(this.halo.toggleMorphHighlighter(!0,Wa),setTimeout(function(){return va.halo.toggleMorphHighlighter(!1,Wa)},1E3))}}],[{key:Symbol["for"]("__LivelyClassName__"),
get:function(){return"NameHaloItem"}},{key:"morphName",get:function(){return"name"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:4},fill:{defaultValue:sa.haloBlue},borderColor:{defaultValue:sa.Color.green},layout:{initialize:function(){this.layout=new sa.HorizontalLayout({resizeContainer:!0,spacing:0,align:"center",orderByIndex:!0})}}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:13020,end:17645})})(sa.HaloItem);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("CloseHaloItem")&&"function"===typeof Db.CloseHaloItem?Db.CloseHaloItem:Db.CloseHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"update",value:function(){var N=
this.halo,va=N.target.owner;va.undoStart("close-halo");N.target.selectedMorphs?N.target.selectedMorphs.forEach(function(Wa){return Wa.abandon()}):N.target.abandon();va.undoStop("close-halo");N.world().withTopBarDo(function(Wa){Wa.stylingPalette&&Wa.stylingPalette.clearFocus();Wa.sideBar&&Wa.sideBar.clearFocus()});N.remove()}},{key:"onMouseDown",value:function(N){this.update()}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"CloseHaloItem"}},{key:"morphName",get:function(){return"close"}},
{key:"properties",get:function(){return{targetIsComponent:{derived:!0,get:function(){return this.halo.target.isComponent}},styleClasses:{after:["halo"],initialize:function(){this.styleClasses=["fas",this.targetIsComponent?"fa-eye-slash":"fa-trash"]}},draggable:{defaultValue:!1},tooltip:{after:["halo"],initialize:function(){this.tooltip=this.targetIsComponent?"Hide this component":"Remove this morph from the world"}}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:17647,end:18876})})(sa.HaloItem);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("GrabHaloItem")&&"function"===typeof Db.GrabHaloItem?Db.GrabHaloItem:Db.GrabHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return Xb(Ra,Kb,[{key:"adjustTarget",value:function(N,va){sa.PropertyPath("owner.layout.autoResize").get(N)&&!N.globalBounds().insetBy(10).containsPoint(va)&&(N=N.owner);return N}},{key:"valueForPropertyDisplay",value:function(){var N=this.hand,va=this.halo,Wa=this.prevDropTarget,pa=N.world(),tb=N.findDropTarget(N.globalPosition,[va.target],function(ab){return!ab.isHaloItem&&!ab.ownerChain().some(function(Ob){return Ob.isHaloItem||!Ob.visible||0===Ob.opacity})});if(tb)return tb=this.adjustTarget(tb,
N.globalPosition),va.toggleMorphHighlighter(tb&&tb!==pa,tb,!0),Wa&&Wa!==tb&&va.toggleMorphHighlighter(!1,Wa),(this.prevDropTarget=tb)&&tb.name}},{key:"init",value:function(N){var va=this.halo,Wa=va.target.undoStart("grab-halo");Wa&&Wa.addTarget(va.target.owner);this.hand=N;va.target.onGrab({halo:va,hand:N,isShiftDown:function(){return!1}});va.state.activeButton=this;this.opacity=.3;var pa=sa.connect(N,"update",this,"update");sa.once(va.target,"remove",function(){return pa.disconnect()})}},{key:"stop",
value:function(N){var va=this.halo,Wa=this.prevDropTarget,pa=va.target.undoInProgress,tb=N.hand.findDropTarget(N.hand.globalPosition,[va.target],function(ab){return!ab.isHaloItem&&!ab.ownerChain().some(function(Ob){return Ob.isHaloItem})});tb=this.adjustTarget(tb,N.hand.globalPosition);sa.disconnect(N.hand,"update",this,"update");sa.MorphHighlighter.interceptDrop(va,tb,va.target);pa.addTarget(tb);tb.onDrop(N);va.state.activeButton=null;va.toggleMorphHighlighter(!1,Wa);sa.MorphHighlighter.removeHighlighters(va);
va.target.undoStop("grab-halo");this.opacity=1;va.target.owner.layout?(va.opacity=0,va.target.whenRendered().then(function(){va.alignWithTarget();va.opacity=1})):va.alignWithTarget()}},{key:"update",value:function(){this.halo.alignWithTarget()}},{key:"onDragStart",value:function(N){this.init(N.hand)}},{key:"onDragEnd",value:function(N){this.stop(N)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"GrabHaloItem"}},{key:"morphName",get:function(){return"grab"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["fa-solid",
"fa-hand-back-fist"]},tooltip:{defaultValue:"Grab the morph"},draggable:{defaultValue:!0}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:18940,end:21788})})(sa.HaloItem);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("DragHaloItem")&&
"function"===typeof Db.DragHaloItem?Db.DragHaloItem:Db.DragHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"valueForPropertyDisplay",value:function(){return this._dontShowPosition?void 0:this.halo.target.position}},{key:"updateAlignmentGuide",value:function(N){var va=this.halo.getSubmorphNamed("mesh");if(N)return va=this.halo.getMesh(this.halo.target.worldPoint(sa.pt(0,0))),
this.focus(),va;va&&va.remove()}},{key:"init",value:function(){var N=this.halo.target;if(N.owner){var va=N.owner.layout;N.undoStart("drag-halo");va&&"Tiling"===va.name()&&va.layoutableSubmorphs.includes(N)&&(this._dontShowPosition=!0,this.halo.indicateLooseMovement(!0));this.halo.state.activeButton=this;this.actualPos=N.position;this.targetTransform=N.owner.getGlobalTransform().inverse()}}},{key:"stop",value:function(){this.halo.target.undoStop("drag-halo");this.halo.state.activeButton=null;this.halo.alignWithTarget();
this.halo.originHalo().alignInHalo();this.halo.indicateLooseMovement(!1);this._dontShowPosition=!1;this.updateAlignmentGuide(!1);sa.removeSnapToGuidesOf(this.halo.target)}},{key:"update",value:function(N){var va=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,Wa=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,pa=this.actualPos.addPt(this.targetTransform.transformDirection(N));this.actualPos=pa;va&&(pa=pa.griddedBy(sa.pt(10,10)));this.halo.target.position=pa;this.updateAlignmentGuide(va);
this.world().withTopBarDo(function(tb){if(tb.activeSideBars.includes("Styling Palette"))tb.stylingPalette.onHierarchyChange()});va||sa.showAndSnapToGuides(this.halo.target,!0,Wa,5,500)}},{key:"onDragStart",value:function(N){this.init()}},{key:"onDrag",value:function(N){this.update(N.state.dragDelta,N.isAltDown(),N.isCtrlDown())}},{key:"onDragEnd",value:function(N){this.stop()}},{key:"onKeyUp",value:function(N){this.updateAlignmentGuide(!1)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"DragHaloItem"}},
{key:"morphName",get:function(){return"drag"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},styleClasses:{defaultValue:["fas","fa-arrows-alt"]},tooltip:{defaultValue:"Change the morph's position. Press (alt) while dragging to align the morph's position along a grid."}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:21790,end:24361})})(sa.HaloItem);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("InspectHaloItem")&&"function"===typeof Db.InspectHaloItem?Db.InspectHaloItem:Db.InspectHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"onMouseDown",value:function(N){var va=this;Nb(regeneratorRuntime.mark(function pa(){var tb,
ab,Ob;return regeneratorRuntime.wrap(function(yc){for(;;)switch(yc.prev=yc.next){case 0:return yc.next=2,pd.import("./ui.cp-6289a670.js").then(function(Ta){return Ta.I});case 2:tb=yc.sent,(ab=va.world().getSubmorphsByStyleClassName("Inspector").find(function(Ta){return Ta.targetObject===va.halo.target}))&&(Ob=ab.getWindow())?(Ob.minimized=!1,Ob.activate(),Ob.animate({center:va.world().visibleBounds().center(),duration:200})):tb.openInWindow({targetObject:va.halo.target}),va.halo.remove();case 6:case "end":return yc.stop()}},
pa)}))()}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"InspectHaloItem"}},{key:"morphName",get:function(){return"inspect"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Inspect the morph's local state"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-magnifying-glass-chart"]}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:24363,end:25370})})(sa.HaloItem);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("EditHaloItem")&&"function"===typeof Db.EditHaloItem?Db.EditHaloItem:Db.EditHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"onMouseDown",value:function(){var N=
Nb(regeneratorRuntime.mark(function pa(Wa){var tb,ab,Ob,yc;return regeneratorRuntime.wrap(function(Ta){for(;;)switch(Ta.prev=Ta.next){case 0:tb=this.halo.target;ab=this.world();if(!tb.viewModel){Ta.next=7;break}this.halo.remove();Ta.next=6;return ab.multipleChoicePrompt(["Edit View or Morph?",null,"\nThe selected morph is attached to a view model. Please select which one you would like to edit.",{fontWeight:"normal",fontSize:16}],{choices:new Map([[[].concat(Id(sa.Icon.textAttribute("database",{paddingTop:"3px"})),
["   Model",null]),tb.viewModel],[[].concat(Id(sa.Icon.textAttribute("eye",{paddingTop:"3px"})),["   View",null]),tb]])});case 6:tb=Ta.sent;case 7:(Ob=ab.getSubmorphsByStyleClassName("ObjectEditor").find(function(Bd){return Bd.target===tb}))?(yc=Ob.getWindow(),yc.bringToFront(),yc.minimized=!1,yc.animate({center:ab.visibleBounds().center(),duration:200})):ab.execCommand("open object editor",{target:tb}),this.halo.remove();case 10:case "end":return Ta.stop()}},pa,this)}));return function(Wa){return N.apply(this,
arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"EditHaloItem"}},{key:"morphName",get:function(){return"edit"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Edit the morph's definition"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-wrench"]}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:25372,end:26912})})(sa.HaloItem);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("RotateHaloItem")&&"function"===typeof Db.RotateHaloItem?Db.RotateHaloItem:Db.RotateHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:Symbol["for"]("lively-instance-initialize"),
value:function(N){Xb._get(Object.getPrototypeOf(Ra.prototype),Symbol["for"]("lively-instance-initialize"),this).call(this,N);this.adaptAppearance(!1)}},{key:"angle",get:function(){return this.getProperty("angle")||0}},{key:"angle",set:function(N){this.setProperty("angle",N)}},{key:"scaleGauge",get:function(){return this.getProperty("scaleGauge")||null}},{key:"scaleGauge",set:function(N){this.setProperty("scaleGauge",N)}},{key:"initRotation",get:function(){return this.getProperty("initRotation")||
0}},{key:"initRotation",set:function(N){this.setProperty("initRotation",N)}},{key:"valueForPropertyDisplay",value:function(){var N=this.halo.target;return this.scaleGauge?N.scale.toFixed(4).toString():sa.num.toDegrees(N.rotation).toFixed(1)+"\u00b0"}},{key:"init",value:function(N){this.detachFromLayout();this.halo.target.undoStart("rotate-halo");this.halo.state.activeButton=this;this.angle=N;this.initRotation=this.halo.target.rotation;this.halo.toggleRotationIndicator(!0,this)}},{key:"initScale",
value:function(N){this.detachFromLayout();this.halo.state.activeButton=this;this.scaleGauge=N.scaleBy(1/this.halo.target.scale);this.halo.toggleRotationIndicator(!0,this)}},{key:"update",value:function(N){this.scaleGauge=null;N=this.initRotation+(N-this.angle);N=sa.num.toRadians(sa.num.detent(sa.num.toDegrees(N),10,45));this.halo.target.rotation=N;this.halo.toggleRotationIndicator(!0,this)}},{key:"updateScale",value:function(N){var va=this.scaleGauge,Wa=this.halo;va||(va=this.scaleGauge=N.scaleBy(1/
Wa.target.scale));this.angle=N.theta();this.initRotation=Wa.target.rotation;Wa.target.scale=sa.num.detent(N.dist(sa.pt(0,0))/va.dist(sa.pt(0,0)),.1,.5);Wa.toggleRotationIndicator(!0,this)}},{key:"stop",value:function(){this.attachToLayout();this.scaleGauge=null;this.halo.state.activeButton=null;this.halo.alignWithTarget();this.halo.toggleRotationIndicator(!1,this);this.halo.target.undoStop("rotate-halo");this.halo.ensureResizeHandles()}},{key:"adaptAppearance",value:function(N){this.styleClasses=
["fas",N?"fa-search-plus":"fa-redo"];this.tooltip=N?"Scale morph":"Rotate morph"}},{key:"detachFromLayout",value:function(){}},{key:"attachToLayout",value:function(){}},{key:"onDragStart",value:function(N){this.adaptAppearance(N.isShiftDown());N.isShiftDown()?this.initScale(N.position.subPt(this.halo.target.globalPosition)):this.init(N.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDrag",value:function(N){this.globalPosition=N.position.addPt(sa.pt(-10,-10));this.adaptAppearance(N.isShiftDown());
N.isShiftDown()?this.updateScale(N.position.subPt(this.halo.target.globalPosition)):this.update(N.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDragEnd",value:function(N){this.adaptAppearance(N.isShiftDown());this.stop()}},{key:"onKeyDown",value:function(N){this.adaptAppearance(N.isShiftDown())}},{key:"onKeyUp",value:function(N){this.adaptAppearance(N.isShiftDown())}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"RotateHaloItem"}},{key:"morphName",get:function(){return"rotate"}},
{key:"properties",get:function(){return{draggable:{defaultValue:!0}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:26914,end:30357})})(sa.HaloItem);sa.nameNumberRe=/(.+)([0-9]+)$/;(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("ComponentHaloItem")&&
"function"===typeof Db.ComponentHaloItem?Db.ComponentHaloItem:Db.ComponentHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"updateComponentIndicator",value:function(){var N=this.world(),va=this.halo.target;this.halo.remove();N.showHaloFor(va)}},{key:"checkForDuplicateNamesInHierarchy",value:function(){var N=Nb(regeneratorRuntime.mark(function Wa(){var pa,tb,ab,Ob,yc,Ta,Bd,
Eb,fe,Od,Hd;return regeneratorRuntime.wrap(function(Qc){for(;;)switch(Qc.prev=Qc.next){case 0:pa=this.halo.target;tb=this.world();ab=[];pa.withAllSubmorphsDoExcluding(function(Xd){Xd!==pa&&ab.push(Xd)},function(Xd){return Xd.master&&Xd!==pa});Ob=sa.arr.groupBy(ab,function(Xd){return Xd.name});yc={fontWeight:"normal",fontSize:16};if(!Object.values(Ob).find(function(Xd){return 1<Xd.length})){Qc.next=13;break}Ta=sa.arr.sum(Object.values(Ob).filter(function(Xd){return 1<Xd.length}).map(function(Xd){return Xd.length}));
Qc.next=10;return tb.confirm(["Ambigous Names in Submorph Hierarchy  ",{}].concat(Id(sa.Icon.textAttribute("exclamation-triangle",{fontColor:sa.Color.rgb(230,126,34),fontSize:30,lineHeight:"40px"})),["\nThe morph you are about to turn into a component has ".concat(Ta," morphs within its submorph hierarchy, that have ambigous names. This can lead to incorrect applications of style properties when you create derived instances from this component.\n\n"),Object.assign({},yc,{textAlign:"left"}),"Usually ambigous names are caused if your component is in some kind of intermittent state, where it already displays an example state or code has run that automatically created interface elements. This can be fixed by resetting the submorphs of this morph, usually by implementing a ",
Object.assign({},yc,{textAlign:"left",fontStyle:"italic"}),"reset()",Object.assign({},yc,{fontStyle:"italic",fontFamily:"IBM Plex Mono"}),' routine you can invoke to put the morph into some kind of "neutral" state. Alternatively you can go ahead and rename the duplicate morphs to have proper unique names. If you have a hard time giving the conflicting morphs appropriate names, this can be an indication that the component you are declaring is too large, and you need to decompose your component into subcomponents further.',
Object.assign({},yc,{textAlign:"left",fontStyle:"italic"})]),{width:600,confirmLabel:"PROCEED TO RENAME",rejectLabel:"CANCEL",align:"left"});case 10:if(Bd=Qc.sent){Qc.next=13;break}return Qc.abrupt("return");case 13:Qc.t0=regeneratorRuntime.keys(Ob);case 14:if((Qc.t1=Qc.t0()).done){Qc.next=39;break}Eb=Qc.t1.value;if(!(2>Ob[Eb].length)){Qc.next=18;break}return Qc.abrupt("continue",14);case 18:fe=Ob[Eb];case 19:if(!(1<fe.length)){Qc.next=37;break}Od=fe[0];sa.show(Od,!0);Qc.next=24;return tb.prompt(["Name Collision\n",
{},"The name of\n",yc,Od.toString(),Object.assign({},yc,{fontStyle:"italic",fontWeight:"bold"}),"\nis not unique within the submorph hierachy of\n",Object.assign({},yc),pa.name,Object.assign({},yc,{fontStyle:"italic",fontWeight:"bold"}),"\nThere ".concat(2<fe.length?"are "+(fe.length-1)+" other morphs":"is one other morph"," with the exact same name located in this component."),yc," Duplicate names can cause errors when applying styles to derived morphs of this master component, so it is essential that there is no name ambiguity. Please enter a new name for this or the other conflicting morphs:",
yc],{input:Od.name,lineWrapping:!0,width:500,fontSize:12,rejectLabel:"IGNORE",confirmLabel:"RENAME",errorMessage:"Provided name is not unique",validate:function(Xd){return!Object.keys(Ob).includes(Xd)}});case 24:Hd=Qc.sent;sa.signal(tb,"hideMarkers");Hd&&(Od.name=Hd);if(!(Hd in Ob)){Qc.next=31;break}return Qc.abrupt("continue",19);case 31:if(Hd){Qc.next=34;break}fe=sa.arr.rotate(fe);return Qc.abrupt("continue",19);case 34:sa.arr.remove(fe,Od);Qc.next=19;break;case 37:Qc.next=14;break;case 39:return Qc.abrupt("return",
!0);case 40:case "end":return Qc.stop()}},Wa,this)}));return function(){return N.apply(this,arguments)}}()},{key:"onMouseDown",value:function(){var N=Nb(regeneratorRuntime.mark(function Wa(){var pa,tb,ab,Ob;return regeneratorRuntime.wrap(function(yc){for(;;)switch(yc.prev=yc.next){case 0:pa=this.halo.target;tb=!pa.isComponent;ab=$world.getAllNamed(pa.name).length;if(!(tb&&1<ab)){yc.next=10;break}yc.next=6;return $world.prompt(["Name Conflict\n",{},"The morph's name you are about to turn into a component is already used by ".concat(ab-
1," other morph").concat(2<ab?"s":"",". Please enter a "),{fontWeight:"normal"},"unique identifier",{fontStyle:"italic"}," for this component within this project.",{fontWeight:"normal",fontSize:16}],{input:pa.name,lineWrapping:!0,width:400,errorMessage:"Identifier not unique",validate:function(Ta){return 0===$world.getAllNamed(Ta).length}});case 6:if(Ob=yc.sent){yc.next=9;break}return yc.abrupt("return");case 9:pa.name=Ob;case 10:yc.t0=tb;if(!yc.t0){yc.next=15;break}yc.next=14;return this.checkForDuplicateNamesInHierarchy();
case 14:yc.t0=yc.sent;case 15:pa.isComponent=yc.t0,tb?(sa.arr.pushIfNotIncluded(pa.world().localComponents,pa),sa.arr.pushIfNotIncluded(pa.world().hiddenComponents,pa.name)):sa.arr.remove(pa.world().localComponents,pa),this.world()?this.updateComponentIndicator():pa.world().showHaloFor(pa);case 18:case "end":return yc.stop()}},Wa,this)}));return function(){return N.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ComponentHaloItem"}},{key:"morphName",get:function(){return"component"}},
{key:"properties",get:function(){return{tooltip:{get:function(){return this.halo.target.isComponent?"Retract Component":"Turn into Component"}},styleClasses:{initialize:function(){this.styleClasses=this.halo.target.isComponent?["fas","fa-eraser"]:["fas","fa-cube"]}}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:30398,end:36580})})(sa.HaloItem);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("CopyHaloItem")&&"function"===typeof Db.CopyHaloItem?Db.CopyHaloItem:Db.CopyHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"init",value:function(N){function va(Ta,Bd){return Bd.match(sa.nameNumberRe)?Bd.replace(sa.nameNumberRe,
function(Eb,fe,Od){Od||(Od="0");for(Eb=Number(Od);Ta.get(fe+ ++Eb););return fe+Eb}):Bd+"1"}var Wa=this.halo,pa=Wa.target,tb=Wa.world(),ab=pa instanceof sa.MultiSelectionTarget;Wa.remove();sa.connect(N,"update",this,"update");if(ab){var Ob=sa.arr.compact(pa.selectedMorphs.map(function(Ta){if(Ta.canBeCopied())return Ta=Ta.copy(!0),tb.addMorph(Ta),Ta}));ab=Ob.map(function(Ta){Ta.name=va(pa,Ta.name);return Ta.position});Ob[0].undoStart("copy-halo");tb.addMorph(Wa);Wa.refocus(Ob);N.grab(Wa.target);Wa.target.onGrab({halo:Wa,
hand:N,isShiftDown:function(){return!1}});ab.forEach(function(Ta,Bd){return Ob[Bd].globalPosition=Ta});Wa.alignWithTarget()}else{ab=pa.globalPosition;var yc=pa.copy(!0);pa.isComponent&&(yc.isComponent=!1,yc.withAllSubmorphsDoExcluding(function(Ta){Ta!==yc&&Ta.master||delete Ta._parametrizedProps},function(Ta){return Ta.master&&Ta!==yc}),yc.master=pa);yc.name=va(pa,pa.name);tb.addMorph(yc);yc.globalPosition=ab;yc.undoStart("copy-halo");N.grab(yc);tb.addMorph(Wa);Wa.visible=!1}}},{key:"stop",value:function(N){var va=
this.halo,Wa=Bb(N.grabbedMorphs,1)[0],pa=N.findDropTarget(N.globalPosition,[va.target],function(ab){return!ab.isHaloItem&&!ab.ownerChain().some(function(Ob){return Ob.isHaloItem})}),tb=va.target.undoInProgress;sa.disconnect(N,"update",this,"update");tb.addTarget(pa);N.dropMorphsOn(pa);va.target.undoStop("copy-halo");va.remove();N.world().showHaloFor(Wa)}},{key:"onDragStart",value:function(N){this.init(N.hand)}},{key:"onDragEnd",value:function(N){this.stop(N.hand)}},{key:"update",value:function(){this.halo.alignWithTarget()}},
{key:"copyToClipBoard",value:function(){var N=Nb(regeneratorRuntime.mark(function Wa(){var pa,tb,ab,Ob,yc,Ta,Bd,Eb,fe,Od,Hd,Qc,Xd,oc;return regeneratorRuntime.wrap(function(rf){for(;;)switch(rf.prev=rf.next){case 0:pa=this.halo;if(!pa.nameHalo().nameHolders.find(function(Dd){return Dd.nameHolder===$world.focusedMorph})){rf.next=3;break}return rf.abrupt("return");case 3:return tb=pa.target,ab=pa.world(),Ob=tb instanceof sa.MultiSelectionTarget,yc=tb.globalBounds().topLeft(),Ta=Ob?tb.selectedMorphs:
[tb],rf.next=10,Promise.all(Ta.filter(function(Dd){return!Dd.isCommentIndicator}).map(function(){var Dd=Nb(regeneratorRuntime.mark(function gb(Td){var Vc;return regeneratorRuntime.wrap(function(vb){for(;;)switch(vb.prev=vb.next){case 0:return Vc=Td.copy(!0),vb.next=3,Promise.all(Vc.withAllSubmorphsDo(function(cc){if(cc.master)return cc.master.applyIfNeeded(),cc.master.whenApplied()}));case 3:return vb.abrupt("return",Vc);case 4:case "end":return vb.stop()}},gb)}));return function(Td){return Dd.apply(this,
arguments)}}()));case 10:Bd=rf.sent,Eb=[],fe='<!DOCTYPE html>\n          <html lang="en">\n          <head>\n            <meta charset="utf-8">\n            '.concat(document.querySelector("#lively-morphic-css").outerHTML,"\n          </head>\n          <body>"),pa.remove(),rf.prev=14,Od=rd(Bd),rf.prev=16,Od.s();case 18:if((Hd=Od.n()).done){rf.next=28;break}Qc=Hd.value;rf.next=22;return sa.createMorphSnapshot(Qc,{addPreview:!1,testLoad:!1,moduleManager:sa.moduleManager});case 22:Xd=rf.sent,Xd.copyMeta=
{offset:Qc.worldPoint(sa.pt(0,0)).subPt(yc)},Eb.push(Xd),fe+=Qc.renderPreview();case 26:rf.next=18;break;case 28:rf.next=33;break;case 30:rf.prev=30,rf.t0=rf["catch"](16),Od.e(rf.t0);case 33:return rf.prev=33,Od.f(),rf.finish(33);case 36:return fe+="</body></html>",oc=JSON.stringify(Eb),rf.next=40,this.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/html",data:fe},{type:"application/morphic",data:oc}]);case 40:rf.next=46;break;case 42:return rf.prev=42,rf.t1=rf["catch"](14),ab.logError(rf.t1),
rf.abrupt("return");case 46:ab.addMorph(pa),pa.refocus(Ta),pa.setStatusMessage("copied");case 49:case "end":return rf.stop()}},Wa,this,[[14,42],[16,30,33,36]])}));return function(){return N.apply(this,arguments)}}()},{key:"onMouseUp",value:function(){var N=Nb(regeneratorRuntime.mark(function pa(Wa){return regeneratorRuntime.wrap(function(tb){for(;;)switch(tb.prev=tb.next){case 0:return Wa.stop(),tb.next=3,this.copyToClipBoard();case 3:case "end":return tb.stop()}},pa,this)}));return function(Wa){return N.apply(this,
arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"CopyHaloItem"}},{key:"morphName",get:function(){return"copy"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},tooltip:{defaultValue:"Copy morph"},styleClasses:{defaultValue:["far","fa-clone"]}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:36582,end:41478})})(sa.HaloItem);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("OriginHaloItem")&&"function"===typeof Db.OriginHaloItem?Db.OriginHaloItem:Db.OriginHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"fill",get:function(){return sa.Color.white.interpolate(.2,this.borderColorTop)}},
{key:"extent",get:function(){return sa.pt(15,15)}},{key:"tooltip",get:function(){return"Change the morph's origin"}},{key:"computePositionAtTarget",value:function(){return this.halo.localize(this.halo.target.globalPosition)}},{key:"alignInHalo",value:function(){this.visible=!this.halo.hasTinyTarget;this.center=this.computePositionAtTarget()}},{key:"valueForPropertyDisplay",value:function(){return this.halo.target.origin}},{key:"init",value:function(){this.halo.target.undoStart("origin-halo");this.halo.state.activeButton=
this}},{key:"stop",value:function(){this.halo.target.undoStop("origin-halo");this.halo.state.activeButton=null;this.halo.alignWithTarget()}},{key:"update",value:function(N){var va=this.halo,Wa=va.target.origin,pa=va.target.worldPoint(Wa);N=va.target.localize(pa.addPt(N)).subPt(va.target.scroll).subPt(Wa);va.target.adjustOrigin(va.target.origin.addPt(N))}},{key:"onDragStart",value:function(N){this.init()}},{key:"onDragEnd",value:function(N){this.stop()}},{key:"onDrag",value:function(N){this.update(N.state.dragDelta)}}],
[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"OriginHaloItem"}},{key:"morphName",get:function(){return"origin"}},{key:"properties",get:function(){return{borderWidth:{defaultValue:3},nativeCursor:{defaultValue:"-webkit-grab"},draggable:{defaultValue:!0},borderColor:{after:["halo"],initialize:function(){this.borderColor=this.halo.target.isComponent?sa.componentAccent:sa.haloBlue}}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:41480,end:43233})})(sa.HaloItem);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("ResizeHandle")&&"function"===typeof Db.ResizeHandle?Db.ResizeHandle:Db.ResizeHandle=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return Xb(Ra,Kb,[{key:"valueForPropertyDisplay",value:function(){var N=this.halo.target.extent,va=N.y;return"".concat(N.x.toFixed(1),"x").concat(va.toFixed(1))}},{key:"positionInHalo",value:function(){var N=this.halo.borderBox.bounds();this.halo.hasTinyTarget&&(sa.Rectangle.prototype.sides.includes(this.location)&&(this.visible=!1),N=N.insetBy(-4));return N.partNamed(this.location)}},{key:"alignInHalo",value:function(){this.center=this.positionInHalo();return this}},{key:"onKeyUp",value:function(N){this.halo.state.activeButton===
this&&this.halo.toggleDiagonal(N.isShiftDown(),this.corner)}},{key:"onKeyDown",value:function(N){this.halo.state.activeButton===this&&this.halo.toggleDiagonal(N.isShiftDown(),this.corner)}},{key:"onDragStart",value:function(N){this.init(N.position,N.isShiftDown())}},{key:"onDragEnd",value:function(N){this.stop(N.isShiftDown())}},{key:"onDrag",value:function(N){this.update(N.position,N.isShiftDown(),N.isAltDown(),N.isCtrlDown());this.focus()}},{key:"init",value:function(N){var va=1<arguments.length&&
void 0!==arguments[1]?arguments[1]:!1,Wa=this.halo.target,pa=Wa.origin,tb=Wa.position;Wa=Wa.extent;this.startPos=N;this.startBounds=tb.subPt(pa).extent(Wa);this.startOrigin=this.halo.target.origin;this.halo.state.activeButton=this;this.tfm=this.halo.target.getGlobalTransform().inverse();pa=this.halo.target.getGlobalTransform().getRotation();this.offsetRotation=sa.num.toRadians(pa%45);this.halo.toggleDiagonal(va,this.corner)}},{key:"update",value:function(N){var va=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:!1,Wa=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,pa=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1,tb=this.corner,ab=this.tfm,Ob=this.startPos.subPt(N);ab=ab.transformDirection(sa.pt(Ob.x,Ob.y));Wa&&(ab=ab.griddedBy(sa.pt(10,10)));this.halo.updateBoundsFor(tb,va,ab,this.startBounds,this.startOrigin);this.halo.toggleDiagonal(va,tb);this.updateAlignmentGuide(Wa);va=[];tb=tb.toLowerCase();tb.includes("left")&&va.push("left");tb.includes("top")&&va.push("top");tb.includes("bottom")&&
va.push("bottom");tb.includes("right")&&va.push("right");sa.showAndSnapToResizeGuides(this.halo.target,va,!0,pa,5,200)}},{key:"stop",value:function(N){N=this.halo;N.state.activeButton=null;N.alignWithTarget();N.toggleDiagonal(!1);this.updateAlignmentGuide(!1);sa.removeSnapToGuidesOf(N.target)}},{key:"updateAlignmentGuide",value:function(N){var va=this.halo.getSubmorphNamed("mesh");if(N)return N=this.halo.target.extent,N=sa.pt(N.x%10,N.y%10),va=this.halo.getMesh(this.globalPosition.addPt(this.extent.scaleBy(.5)),
N),this.focus(),va;va&&va.remove()}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ResizeHandle"}},{key:"properties",get:function(){return{corner:{},location:{},draggable:{defaultValue:!0},isResizeHandle:{readOnly:!0,get:function(){return!0}}}}},{key:"getResizeParts",value:function(N){0<N&&(N-=360);N=-8-(N/45).toFixed();0===N&&(N=8);return sa.arr.zip(sa.arr.rotate([["topLeft",function(va){return va.negated()}],["topCenter",function(va){return va.withX(0).negated()}],["topRight",
function(va){return va.withX(0).negated()}],["rightCenter",function(va){return sa.pt(0,0)}],["bottomRight",function(va){return sa.pt(0,0)}],["bottomCenter",function(va){return sa.pt(0,0)}],["bottomLeft",function(va){return va.withY(0).negated()}],["leftCenter",function(va){return va.withY(0).negated()}]],N),[["nwse-resize","topLeft"],["ns-resize","topCenter"],["nesw-resize","topRight"],["ew-resize","rightCenter"],["nwse-resize","bottomRight"],["ns-resize","bottomCenter"],["nesw-resize","bottomLeft"],
["ew-resize","leftCenter"]])}},{key:"resizersFor",value:function(N){var va=this;if(!N.target)return[];var Wa=N.target.getGlobalTransform().getRotation();return sa.arr.compact(this.getResizeParts(Wa).map(function(pa){var tb=Bb(pa,2),ab=Bb(tb[0],3);pa=ab[0];ab[1];ab[2];tb=Bb(tb[1],2);return va["for"](N,pa,tb[1],tb[0])})).map(function(pa){return pa.alignInHalo()})}},{key:"for",value:function(N,va,Wa,pa){var tb="Resize "+va;tb=N.getSubmorphNamed(tb)||new this({name:tb,halo:N,corner:va,tooltip:"Resize "+
sa.string.decamelize(va.replace("Center","")),extent:sa.pt(10,10),borderWidth:1,borderRadius:0,borderColor:N.target.isComponent?sa.componentAccent:sa.haloBlue,fill:sa.Color.white});if("topCenter"===va||"bottomCenter"===va)tb.width=N.borderBox.width-10,tb.opacity=0;if("rightCenter"===va||"leftCenter"===va)tb.height=N.borderBox.height-10,tb.opacity=0;return Object.assign(tb,{nativeCursor:pa,location:Wa})}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:43293,end:48912})})(sa.HaloItem);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("MenuHaloItem")&&"function"===typeof Db.MenuHaloItem?Db.MenuHaloItem:Db.MenuHaloItem=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return Xb(Ra,Kb,[{key:"onMouseDown",value:function(){var N=Nb(regeneratorRuntime.mark(function pa(Wa){var tb,ab;return regeneratorRuntime.wrap(function(Ob){for(;;)switch(Ob.prev=Ob.next){case 0:return tb=this.halo.target,this.halo.remove(),Ob.next=4,tb.menuItems(Wa);case 4:ab=Ob.sent,tb.world().openMenu(ab).hasFixedPosition=this.halo.hasFixedPosition;case 6:case "end":return Ob.stop()}},pa,this)}));return function(Wa){return N.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),
get:function(){return"MenuHaloItem"}},{key:"morphName",get:function(){return"menu"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},tooltip:{defaultValue:"Opens the morph menu"},styleClasses:{defaultValue:["fas","fa-bars"]}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:48914,end:49485})})(sa.HaloItem);var vc=Lc("I",function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),Ra=Db.hasOwnProperty("InteractiveMorphSelector")&&"function"===typeof Db.InteractiveMorphSelector?Db.InteractiveMorphSelector:Db.InteractiveMorphSelector=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:Symbol["for"]("lively-instance-initialize"),
value:function(){var N=0<arguments.length&&void 0!==arguments[0]?arguments[0]:$world,va=2<arguments.length?arguments[2]:void 0;this.controllingMorph=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.possibleTarget=this.morphHighlighter=this.selectorMorph=null;this.world=N;this.filterFn=va;this.whenDone=null}},{key:"selectNewTarget",value:function(){this.targetObject=null;var N=sa.promise.deferred();N.promise.resolve=N.resolve;this.whenDone=N.promise;this.selectorMorph=sa.Icon.makeLabel("crosshairs",
{fontSize:20,hasFixedPosition:!0,epiMorph:!0}).openInWorld();sa.connect(this.world.firstHand,"position",this,"scanForTargetAt");sa.once(this.selectorMorph,"onMouseUp",this,"selectTarget");sa.once(this.selectorMorph,"onKeyDown",this,"stopSelect");this.selectorMorph.focus();this.scanForTargetAt(this.world.firstHand.position)}},{key:"scanForTargetAt",value:function(){var N=this.world.firstHand.globalPosition;this.selectorMorph.center=N;this.selectorMorph.focus();var va=this.selectorMorph.morphBeneath(N),
Wa,pa=this.possibleTarget,tb=this.controllingMorph,ab=this.filterFn,Ob=this.world,yc=this.morphHighlighter;for(yc===va?va=yc.morphBeneath(N):va&&va.isEpiMorph&&(va=va.morphBeneath(N));va&&(Wa=[va].concat(Id(va.ownerChain())).find(function(Ta){return!Ta.visible}));)va=Wa=Wa.morphBeneath(N);if(va&&ab&&!ab(va))for(;va&&![va].concat(Id(va.ownerChain())).find(ab);)va=va.morphBeneath(N);!va||va===pa||tb&&va.ownerChain().includes(tb.getWindow())||(yc&&yc.deactivate(),(this.possibleTarget=pa=va)&&!pa.isWorld&&
(N=this.morphHighlighter=sa.MorphHighlighter["for"](Ob,va))&&N.show())}},{key:"selectTarget",value:function(){this.targetObject=this.possibleTarget;this.stopSelect()}},{key:"stopSelect",value:function(){sa.MorphHighlighter.removeHighlighters(this.world);sa.disconnect(this.world.firstHand,"position",this,"scanForTargetAt");this.selectorMorph.remove();this.whenDone&&this.whenDone.resolve(this.targetObject)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"InteractiveMorphSelector"}},
{key:"selectMorph",value:function(N,va,Wa){N=new this(N,va,Wa);N.selectNewTarget();return N.whenDone}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:49494,end:52293})}(void 0));sa.InteractiveMorphSelector=vc;sa.InteractiveMorphSelector=vc;var Oc=Lc("H",function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
Ra=Db.hasOwnProperty("Halo")&&"function"===typeof Db.Halo?Db.Halo:Db.Halo=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"relayout",value:function(){this.alignWithTarget()}},{key:"keybindings",get:function(){return[{keys:{mac:"Meta-C",win:"Ctrl-C"},command:{command:"clipboard copy",passEvent:!0}}]}},{key:"commands",get:function(){return[{name:"clipboard copy",doc:"copy selected morph(s) to clipboard",
scrollCursorIntoView:!1,exec:function(N){N.copyHalo().copyToClipBoard()}}]}},{key:"removeIfDetached",value:function(){var N=this;setTimeout(function(){N.target.owner||N.remove()})}},{key:"initLayout",value:function(){var N=this.layout=new sa.GridLayout({autoAssign:!1,fitToCell:!1,renderViaCSS:!0,columns:[0,{fixed:36,paddingRight:10},2,{fixed:26},4,{fixed:26},6,{fixed:36,paddingLeft:10}],rows:[0,{fixed:36,paddingBottom:10},2,{fixed:26},4,{fixed:26},6,{fixed:26},7,{fixed:36,paddingTop:10}],grid:[["menu",
null,"grab",null,"drag",null,"close"],[null,null,null,null,null,null,null],["copy",null,null,null,null,null,"edit"],[null,null,null,null,null,null,null],["component",null,null,null,null,null,"inspect"],[null,null,null,null,null,null,null],["rotate",null,null,null,null,null,"resize"],[null,"name","name","name","name","name",null]]});N.col(1).row(7).group.align="topCenter";N.col(1).row(7).group.resize=!1}},{key:"initButtons",value:function(){this.submorphs=[].concat(Id(this.ensureResizeHandles()),Id(this.resizeOnly?
[]:[this.closeHalo(),this.dragHalo(),this.grabHalo(),this.menuHalo(),this.inspectHalo(),this.editHalo(),this.copyHalo(),this.componentHalo(),this.rotateHalo(),this.nameHalo(),this.originHalo()]))}},{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},{key:"isHalo",get:function(){return!0}},{key:"borderBox",get:function(){return this.getSubmorphNamed("border-box")||this.addMorphBack(sa.morph({name:"border-box",halosEnabled:!1,reactsToPointer:!1,fill:sa.Color.transparent,
borderColor:this.target.isComponent?sa.componentAccent:sa.haloBlue,borderWidth:1}))}},{key:"pointerId",get:function(){return this.state?this.state.pointerId:null}},{key:"pointerId",set:function(N){this.state||(this.state={});this.state.pointerId=N}},{key:"prepareTarget",value:function(N){if(!sa.obj.isArray(N))return N;if(1>=N.length)return N[0];N=N[0].world().addMorph(new sa.MultiSelectionTarget({selectedMorphs:N}));N.alignWithSelection();N.modifiesSelectedMorphs=!0;return N}},{key:"refocus",value:function(N){this.target=
N;this.alignWithTarget()}},{key:"alignWithTarget",value:function(N){var va=this;if((!N||["extent","position","scale","rotation"].includes(N.prop))&&!this.active&&this.target){N=this.target.world()||$world;var Wa=this.maskBounds,pa=this.target.globalBounds(),tb=pa.insetBy(-36).intersection(Wa);Wa=pa.intersection(Wa);this.setBounds(tb.translatedBy(N.scroll.negated()));this.borderBox.setBounds($world.transformRectToMorph(this,Wa));this.resizeOnly||this.originHalo().alignInHalo();this.nameHalo().alignInHalo();
this.state.activeButton?(this.buttonControls.forEach(function(ab){return ab.visible=!1}),this.ensureResizeHandles().forEach(function(ab){return ab.visible=!1}),this.state.activeButton.visible=!0,this.updatePropertyDisplay(this.state.activeButton)):(this.changingName&&this.nameHalo().toggleActive([!1]),this.ensureResizeHandles().forEach(function(ab){return ab.visible=!0}),this.buttonControls.filter(function(ab){return va.activeItems.includes("*")?!0:va.activeItems.includes(ab.name)}).forEach(function(ab){ab.visible=
!0}),this.propertyDisplay.disable());this.ensureResizeHandles().forEach(function(ab){return ab.alignInHalo()});return this}}},{key:"detachFromTarget",value:function(){var N=this.target;N&&(sa.disconnect(N,"onChange",this,"alignWithTarget"),sa.disconnect(N,"onOwnerChanged",this,"removeIfDetached"),N instanceof sa.MultiSelectionTarget?(N.modifiesSelectedMorphs=!1,N.remove()):"function"===typeof N.detachedHalo&&N.detachedHalo(this))}},{key:"remove",value:function(){this.detachFromTarget();Xb._get(Object.getPrototypeOf(Ra.prototype),
"remove",this).call(this)}},{key:"propertyDisplay",get:function(){return sa.HaloPropertyDisplay["for"](this)}},{key:"nameHalo",value:function(){return sa.NameHaloItem["for"](this)}},{key:"closeHalo",value:function(){return sa.CloseHaloItem["for"](this)}},{key:"grabHalo",value:function(){return sa.GrabHaloItem["for"](this)}},{key:"dragHalo",value:function(){return sa.DragHaloItem["for"](this)}},{key:"menuHalo",value:function(){return sa.MenuHaloItem["for"](this)}},{key:"inspectHalo",value:function(){return sa.InspectHaloItem["for"](this)}},
{key:"editHalo",value:function(){return sa.EditHaloItem["for"](this)}},{key:"rotateHalo",value:function(){return sa.RotateHaloItem["for"](this)}},{key:"copyHalo",value:function(){return sa.CopyHaloItem["for"](this)}},{key:"originHalo",value:function(){return sa.OriginHaloItem["for"](this)}},{key:"componentHalo",value:function(){return sa.ComponentHaloItem["for"](this)}},{key:"buttonControls",get:function(){return this.submorphs.filter(function(N){return N.isHaloItem&&!N.isResizeHandle})}},{key:"addMorphToSelection",
value:function(){var N=Nb(regeneratorRuntime.mark(function pa(Wa){var tb,ab;return regeneratorRuntime.wrap(function(Ob){for(;;)switch(Ob.prev=Ob.next){case 0:tb=this.world();ab=this.target.isMorphSelection?this.target.selectedMorphs:[this.target];if(!ab.includes(Wa)){Ob.next=4;break}return Ob.abrupt("return");case 4:return this.remove(),Ob.next=7,tb.showHaloForSelection([].concat(Id(ab),[Wa]),this.state.pointerId);case 7:return Ob.abrupt("return",Ob.sent);case 8:case "end":return Ob.stop()}},pa,this)}));
return function(Wa){return N.apply(this,arguments)}}()},{key:"removeMorphFromSelection",value:function(){var N=Nb(regeneratorRuntime.mark(function pa(Wa){var tb;return regeneratorRuntime.wrap(function(ab){for(;;)switch(ab.prev=ab.next){case 0:tb=this.world();this.remove();if(!this.target.isMorphSelection){ab.next=7;break}sa.arr.remove(this.target.selectedMorphs,Wa);ab.next=6;return tb.showHaloForSelection(this.target.selectedMorphs,this.state.pointerId);case 6:return ab.abrupt("return",ab.sent);case 7:case "end":return ab.stop()}},
pa,this)}));return function(Wa){return N.apply(this,arguments)}}()},{key:"isAlreadySelected",value:function(N){return this.target===N||this.target.isMorphSelection&&this.target.selectsMorph(N)}},{key:"updateBoundsFor",value:function(N,va,Wa,pa,tb){var ab={topLeft:sa.rect(-1,-1,1,1),topCenter:va?sa.rect(1,-1,0,1):sa.rect(0,-1,0,1),topRight:sa.rect(0,-1,1,1),rightCenter:va?sa.rect(0,1,1,1):sa.rect(0,0,1,0),bottomRight:sa.rect(0,0,1,1),bottomCenter:va?sa.rect(1,0,0,1):sa.rect(0,0,0,1),bottomLeft:sa.rect(-1,
0,1,1),leftCenter:va?sa.rect(-1,1,1,0):sa.rect(-1,0,1,0)}[N];tb=ab.x;var Ob=ab.y,yc=ab.width;ab=ab.height;Wa=va?this.proportionalDelta(N,Wa,pa):Wa;N=sa.rect(Wa.x*tb,Wa.y*Ob,Wa.x*yc,Wa.y*ab);this.active=!0;this.targetIsPositionedByLayout?this.target.extent=pa.insetByRect(N).extent():(this.target.setBounds(pa.insetByRect(N)),(this.target.isPolygon||this.target.isPath)&&this.target.moveBy(this.target.origin.negated()));this.active=!1;this.alignWithTarget();this.world().withTopBarDo(function(Ta){if(Ta.activeSideBars.includes("Styling Palette"))Ta.stylingPalette.onHierarchyChange()})}},
{key:"proportionalDelta",value:function(N,va,Wa){var pa=Wa.width,tb=Wa.height;Wa={topLeft:sa.pt(-1,-1),topCenter:sa.pt(0,-1),topRight:sa.pt(1,-1),leftCenter:sa.pt(-1,0),rightCenter:sa.pt(1,0),bottomLeft:sa.pt(-1,1),bottomCenter:sa.pt(0,1),bottomRight:sa.pt(1,1)};var ab=pa/Math.max(pa,tb),Ob=tb/Math.max(tb,pa);pa={topLeft:sa.pt(-ab,-Ob),topCenter:sa.pt(1/(2*tb/pa),-1),topRight:sa.pt(ab,-Ob),leftCenter:sa.pt(-1,tb/(2*pa)),rightCenter:sa.pt(1,tb/(3*pa)),bottomLeft:sa.pt(-ab,Ob),bottomCenter:sa.pt(1/
(2*tb/pa),1),bottomRight:sa.pt(ab,Ob)};Wa=Wa[N];return pa[N].scaleBy(Wa.dotProduct(va)/Wa.dotProduct(Wa))}},{key:"ensureResizeHandles",value:function(){return sa.ResizeHandle.resizersFor(this)}},{key:"updatePropertyDisplay",value:function(N){N=N.valueForPropertyDisplay();"undefined"!==typeof N?this.propertyDisplay.displayProperty(N):this.propertyDisplay.disable()}},{key:"toggleDiagonal",value:function(N,va){if(!sa.rect(0).sides.includes(va)){var Wa=this.getSubmorphNamed("diagonal");if(N){N=this.target.globalBounds();
var pa=N.width,tb=N.height;N=this.localize(sa.pt(N.x,N.y)).extent(sa.pt(pa,tb)).scaleRectTo(this.innerBounds());pa={topLeft:[sa.pt(pa,tb),sa.pt(0,0)],topRight:[sa.pt(0,tb),sa.pt(pa,0)],bottomRight:[sa.pt(0,0),sa.pt(pa,tb)],bottomLeft:[sa.pt(pa,0),sa.pt(0,tb)]};Wa?Wa.setBounds(N):(Wa=Bb(pa[va],2),va=Wa[0],Wa=Wa[1],pa=new sa.LinearGradient({stops:[{offset:0,color:sa.Color.orange.withA(0)},{offset:.2,color:sa.Color.orange},{offset:.8,color:sa.Color.orange},{offset:1,color:sa.Color.orange.withA(0)}]}),
Wa=this.addMorphBack(new sa.Path({opacity:0,name:"diagonal",borderStyle:"dotted",borderWidth:5,bounds:N,borderColor:pa,vertices:[va,Wa]})),Wa.setBounds(N),Wa.animate({opacity:1,duration:500}))}else Wa&&Wa.fadeOut(500)}}},{key:"toggleRotationIndicator",value:function(N,va){var Wa=this.getSubmorphNamed("rotationIndicator");N&&va?(N=this.getSubmorphNamed("origin").center,Wa=Wa||this.addMorphBack(new sa.Path({name:"rotationIndicator",borderColor:sa.haloBlue,borderWidth:1,vertices:[]})),Wa.setBounds(va.bounds().union(this.innerBounds())),
Wa.vertices=[Wa.localizePointFrom(N,this),Wa.localizePointFrom(va.center,this)]):Wa&&Wa.remove()}},{key:"toggleMorphHighlighter",value:function(N,va){var Wa=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1;if(va)if(va.onHaloGrabover)va.onHaloGrabover(N);else Wa=sa.MorphHighlighter["for"](this,va,Wa),N&&va&&va!==this.world()?Wa&&Wa.show(va):Wa&&Wa.deactivate()}},{key:"temporaryEditTextMorph",value:function(N){if(this.target.isText){var va=this.target.readOnly;this.target.readOnly=!1;this.target.focus();
this.target.cursorPosition=this.target.textPositionFromPoint(N.positionIn(this.target));var Wa=this.world(),pa=this.target,tb=this.topBar,ab=function Ta(yc){tb.stylingPalette&&tb.stylingPalette.fullContainsWorldPoint(Wa.firstHand.position)?(pa.whenRendered().then(function(){sa.once(pa,"onBlur",Ta)}),sa.once(pa,"onBlur",Ta)):(tb.setEditMode("Halo",!0),pa.readOnly=va,pa.collapseSelection(),tb.showHaloFor(pa))};this.target.whenRendered().then(function(){sa.once(pa,"onBlur",ab)});tb.setEditMode("Hand",
!0);this.remove()}}},{key:"onDragStart",value:function(N){this.dragHalo().init();this._lastDragPos=N.startPosition}},{key:"onDrag",value:function(N){this.world()&&(this.dragHalo().update(N.state.dragDelta),this.dragHalo().visible=!1)}},{key:"onDragEnd",value:function(N){this.dragHalo().stop();this.dragHalo().visible=!0}},{key:"customDrag",value:function(N){this.world()&&(this.dragHalo().update(N.position.subPt(this._lastDragPos)),this.dragHalo().visible=!1,this._lastDragPos=N.position)}},{key:"onMouseDown",
value:function(N){var va=N.state.clickedOnMorph;if(!N.isCommandKey()&&va===this.borderBox&&2===N.state.clickCount&&this.target.isText)this.temporaryEditTextMorph(N);else if(N.isShiftDown()&&N.isCommandKey())N=this.target.isMorphSelection?this.target.morphBeneath(N.position):this.morphBeneath(N.position),this.isAlreadySelected(N)?this.removeMorphFromSelection(N):this.addMorphToSelection(N);else{if(va===this&&N.isCommandKey()){var Wa=N.world.morphsContainingPoint(N.position).filter(function(pa){return pa.halosEnabled});
(Wa=Wa.slice(Wa.indexOf(this.target)+1)[0]||Wa[0]||N.world)&&N.world.showHaloFor(Wa,N.domEvt.pointerId);this.remove()}if(va===this&&this.target.isWorld||(va===this||va&&!va.isHaloItem&&!this.nameHalo().nameHolders.includes(va.owner))&&![this.target].concat(Id(this.target.ownerChain())).includes(this.morphBeneath(N.position)))return this.remove();this.target.onHaloMouseDown(N)}}},{key:"onContextMenu",value:function(N){var va=this;N.stop();Promise.resolve($world.defaultMenuItems(this.target)).then(function(Wa){return va.target.openMenu(Wa,
N)})["catch"](function(Wa){return $world.logError(Wa)})}},{key:"onKeyUp",value:function(N){this.changingName||this.buttonControls.map(function(va){return va.onKeyUp(N)})}},{key:"indicateLooseMovement",value:function(N){this.borderBox.borderStyle=N?"dotted":"solid"}},{key:"getMesh",value:function(N){var va=N.x,Wa=N.y,pa=1<arguments.length&&void 0!==arguments[1]?arguments[1]:sa.pt(0,0),tb=this.world().visibleBounds(),ab=tb.height;tb=tb.width;var Ob={borderStyle:"dotted",borderWidth:2,borderColor:sa.Color.orange};
Ob=this.get("mesh")||this.addMorph(new sa.Morph({name:"mesh",styleClasses:["halo-mesh"],extent:sa.pt(tb,ab),fill:null,submorphs:[new sa.Path(Object.assign({name:"vertical"},Ob)),new sa.Path(Object.assign({name:"horizontal"},Ob))]}));Ob.globalPosition=pa;Ob.getSubmorphNamed("vertical").vertices=[sa.pt(va,0).subPt(pa),sa.pt(va,ab).subPt(pa)];Ob.getSubmorphNamed("horizontal").vertices=[sa.pt(0,Wa).subPt(pa),sa.pt(tb,Wa).subPt(pa)];return Ob}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"Halo"}},
{key:"properties",get:function(){return{fill:{defaultValue:sa.Color.transparent},resizeOnly:{defaultValue:!1},pointerId:{},hasFixedPosition:{defaultValue:!0},respondsToVisibleWindow:{defaultValue:!0},acceptsDrops:{defaultValue:!1},draggable:{defaultValue:!0},maskBounds:{initialize:function(){this.maskBounds=$world.visibleBounds()},set:function(N){this.setProperty("maskBounds",N);this.relayout()}},activeItems:{derived:!0,defaultValue:["*"],set:function(N){this.setProperty("activeItems",N);this.buttonControls.forEach(function(va){return va.visible=
N.includes(va.name)})}},submorphs:{after:["target"],initialize:function(){this.initButtons();this.alignWithTarget()}},layout:{after:["submorphs"],initialize:function(){this.initLayout()}},hasTinyTarget:{derived:!0,get:function(){return 40>this.target.bounds().extent().dist(sa.pt(0))}},topBar:{serialize:!1,get:function(){return this.getProperty("topBar")||this.get("lively top bar")}},targetIsPositionedByLayout:{derived:!0,get:function(){return this.target.isLayoutable&&sa.PropertyPath("target.owner.layout.renderViaCSS").get(this)}},
target:{get:function(){return this.state?this.state.target:null},set:function(N){this.state||(this.state={});var va=!!this.state.target;this.detachFromTarget();N=this.prepareTarget(N);this.state.target=N;va&&this.alignWithTarget();sa.connect(N,"onChange",this,"alignWithTarget");sa.connect(N,"onOwnerChanged",this,"removeIfDetached")}}}}}],Db,{pathInPackage:function(){return"./morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:52500,end:71987})}(sa.Morph));sa["default"]=Oc;var aa=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js");aa.Ellipse=W;aa.Icon=yb;aa.Morph=ic;aa.Path=Hb;aa.Text=ec;aa.HorizontalLayout=cb;aa.VerticalLayout=T;aa.morph=$d;aa.Color=Jc;aa.pt=Tc;aa.rect=wb;aa.Rectangle=nd;aa.arr=Da;aa.connect=zb;aa.disconnect=ib;aa.LabeledCheckBox=K;aa.DropDownSelector=ya;aa.Button=La;aa.Menu=pb;aa.NumberWidget=eb;aa.InteractiveMorphSelector=
vc;aa.easings=Fd;(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("ProportionSlider")&&"function"===typeof Db.ProportionSlider?Db.ProportionSlider:Db.ProportionSlider=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"alignWithTarget",value:function(){this.setBounds(this.axis.getProportionSliderBounds(this))}},{key:"onDragStart",
value:function(){this.view.visible=!0}},{key:"onDrag",value:function(N){this.axis.adjustStretch(this.axis.getDelta(N));this.axis.halo.alignWithTarget()}},{key:"onDragEnd",value:function(){this.view.visible=!1}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ProportionSlider"}},{key:"properties",get:function(){return{axis:{},view:{},fill:{defaultValue:aa.Color.transparent}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:630,end:1125})})(aa.Morph);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("MinViewer")&&"function"===typeof Db.MinViewer?Db.MinViewer:Db.MinViewer=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,
Kb,[{key:"alignWithTarget",value:function(){this.textString="min: ".concat(this.axis.targetAxis.min.toFixed(),"px !")}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"MinViewer"}},{key:"properties",get:function(){return{axis:{}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:1127,end:1358})})(aa.Morph);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("MinSlider")&&"function"===typeof Db.MinSlider?Db.MinSlider:Db.MinSlider=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"alignWithTarget",value:function(){this.position=this.axis.getMinSliderPosition()}},{key:"requestToShow",value:function(){this.visible=
!this.axis.targetAxis.fixed}},{key:"requestToHide",value:function(){this.active?this.shouldHide=!0:this.visible=!1}},{key:"onDragStart",value:function(){var N=Bb(this.submorphs,2),va=N[0];N=N[1];this.axis.forceMenuHidden=!0;va.visible=!0;this.active=N.visible=!0}},{key:"onDrag",value:function(N){this.axis.targetAxis.min+=-this.getDelta(N);this.axis.halo.alignWithTarget()}},{key:"onDragEnd",value:function(){var N=Bb(this.submorphs,2),va=N[0];N=N[1];this.axis.forceMenuHidden=!1;va.visible=!1;this.active=
N.visible=!1;this.shouldHide&&(this.shouldHide=this.visible=!1)}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"MinSlider"}},{key:"properties",get:function(){return{axis:{},fill:{defaultValue:aa.Color.green},visible:{defaultValue:!1},becomesActiveOnHover:{defaultValue:!0}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:1360,end:2554})})(aa.Ellipse);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("AxisHalo")&&"function"===typeof Db.AxisHalo?Db.AxisHalo:Db.AxisHalo=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"initialize",value:function(){this.setBounds(this.fetchBounds());var N=this.minSlider(),va=this.axisMenu(),
Wa=this.proportionSlider();Wa.addMorph(N);this.submorphs=[Wa,va];this.halo.addGuide(this)}},{key:"forceMenuHidden",set:function(N){this._forceMenuHidden=N;this.axisMenu.visible=!N}},{key:"forceMenuHidden",get:function(){return this._forceMenuHidden}},{key:"lastAxis",get:function(){return!this.targetAxis.after}},{key:"fetchBounds",value:function(){return this.fetchPosition().extent(this.fetchExtent())}},{key:"alignWithTarget",value:function(){this.extent=this.fetchExtent();this.position=this.fetchPosition();
this.proportionSlider.alignWithTarget();this.axisMenu.alignWithTarget()}},{key:"onHoverIn",value:function(){this.minSlider.requestToShow();this.axisMenu.visible=!this.forceMenuHidden&&!0}},{key:"onHoverOut",value:function(N){this.minSlider.requestToHide();this.axisMenu.visible=this.forceMenuVisible||!1}},{key:"proportionSlider",value:function(){var N=this.proportionViewer();return this.halo.addGuide(new aa.ProportionSlider({nativeCursor:this.getResizeCursor(),axis:this,view:N,submorphs:[this.devider(),
N]}))}},{key:"devider",value:function(){return new aa.Morph({visible:!this.lastAxis,fill:aa.Color.black.withA(.5),bounds:this.getDeviderBounds(),draggable:!1,reactsToPointer:!1})}},{key:"minSlider",value:function(){var N=this.minSpaceVisualizer(),va=this.minViewer();return this.halo.addGuide(new aa.MinSlider({nativeCursor:this.getResizeCursor(),axis:this,submorphs:[N,va]}))}},{key:"minViewer",value:function(){return this.viewer(new aa.MinViewer({axis:this,position:this.getMinViewerPosition()}))}},
{key:"minSpaceBorder",value:function(){return new aa.Path(Object.assign({position:aa.pt(-1,-1),borderStyle:"dashed",borderColor:aa.Color.green,borderWidth:2},this.getMinSpaceBorder()))}},{key:"minSpaceVisualizer",value:function(){var N=this,va=this.minSpaceBorder();return this.halo.addGuide(new aa.Morph({fill:aa.Color.green.withA(.1),visible:!1,isHaloItem:!0,submorphs:[va],alignWithTarget:function(){this.extent=N.getMinSpaceExtent();this.topLeft=aa.pt(5,5)}}))}},{key:"axisMenu",value:function(){var N=
this.lockButton(),va=this.menuButton(),Wa=this;return new aa.Morph({layout:this.getMenuLayout(),submorphs:[N,va],fill:aa.Color.transparent,visible:!1,becomesActiveOnHover:!0,alignWithTarget:function(){this.bottomRight=this.owner.extent.subPt(Wa.getMenuOffset(this))}})}},{key:"lockButton",value:function(){var N=this;return this.halo.addGuide(new aa.Morph({fill:aa.Color.transparent,extent:aa.pt(25,25),submorphs:[{center:aa.pt(12.5,12.5),fill:aa.Color.transparent,styleClasses:["fa","fa-unlock"]}],alignWithTarget:function(){N.targetAxis.fixed?
(this.fontColor=aa.Color.red,this.submorphs[0].styleClasses=["fa","fa-lock"]):(this.fontColor=aa.Color.green,this.submorphs[0].styleClasses=["fa","fa-unlock"])},onMouseDown:function(){this.toggleLock()},toggleLock:function(){N.targetAxis.fixed=!N.targetAxis.fixed;N.halo.alignWithTarget()}}))}},{key:"menuButton",value:function(){var N=this,va=this;return new aa.Morph({fill:aa.Color.transparent,extent:aa.pt(25,25),submorphs:[{fill:aa.Color.transparent,styleClasses:["fa","fa-cog"],center:aa.pt(12.5,
12.5)}],onMouseDown:function(Wa){va.forceMenuVisible=!0;this.addMorph(Wa.state.menu=new aa.Menu({position:aa.pt(15,15),items:[["Remove ".concat(va.subject),function(){N.targetAxis.remove();N.halo.initGuides();N.halo.alignWithTarget()}],["Insert ".concat(va.subject," before"),function(){N.targetAxis.addBefore();N.halo.initGuides();N.halo.alignWithTarget()}],["Insert ".concat(va.subject," after"),function(){N.targetAxis.addAfter();N.halo.initGuides();N.halo.alignWithTarget()}]]}))}})}},{key:"viewer",
value:function(N){var va=N.position;N=N.alignWithTarget;return this.halo.addGuide(new aa.Text({styleClasses:["Halo"],padding:aa.Rectangle.inset(6),visible:!1,borderRadius:10,fontColor:aa.Color.white,fill:aa.Color.black.withA(.5),position:va,alignWithTarget:N,readOnly:!0}))}},{key:"proportionViewer",value:function(){var N=this;return this.viewer({position:this.getProportionViewerPosition(),alignWithTarget:function(){this.textString="".concat(N.targetAxis.length.toFixed(1),"px")}})}}],[{key:Symbol["for"]("__LivelyClassName__"),
get:function(){return"AxisHalo"}},{key:"properties",get:function(){return{halo:{},targetAxis:{},container:{},fill:{defaultValue:aa.Color.transparent},submorphs:{initialize:function(){this.initialize()}}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:2556,end:8490})})(aa.Morph);
(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("RowHalo")&&"function"===typeof Db.RowHalo?Db.RowHalo:Db.RowHalo=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"subject",get:function(){return"row"}},{key:"adjustStretch",value:function(N){this.targetAxis.height+=N}},{key:"getDelta",value:function(N){return N.state.dragDelta.y}},
{key:"axisOffset",value:function(){return this.targetAxis.origin.position.y}},{key:"fetchPosition",value:function(){return aa.pt(-45,this.axisOffset()+10)}},{key:"fetchExtent",value:function(){return aa.pt(40,this.targetAxis.length-10)}},{key:"getMenuOffset",value:function(N){return this.targetAxis.length>N.height?aa.pt(2,5):aa.pt(26,10)}},{key:"getMenuLayout",value:function(){return new aa.VerticalLayout}},{key:"getResizeCursor",value:function(){return"row-resize"}},{key:"getMinViewerPosition",value:function(){return aa.pt(50,
20)}},{key:"getMinSliderPosition",value:function(){return aa.pt(0,-this.targetAxis.min)}},{key:"getMinSpaceExtent",value:function(){return aa.pt(this.container.width+45,this.targetAxis.min)}},{key:"getMinSpaceBorder",value:function(){return{extent:aa.pt(this.container.width+50,2),vertices:[aa.pt(0,1),aa.pt(this.container.width+50,1)]}}},{key:"getProportionViewerPosition",value:function(){return aa.pt(40,20)}},{key:"getProportionSliderBounds",value:function(N){return aa.pt(0,N.owner.height-5).extent(aa.pt(40,
10))}},{key:"getDeviderBounds",value:function(){return aa.pt(15,4).extent(aa.pt(25,2))}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"RowHalo"}},{key:"properties",get:function(){return{row:{},targetAxis:{derived:!0,get:function(){return this.halo.target.row(this.row)}}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:8492,end:9919})})(aa.AxisHalo);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("ColumnHalo")&&"function"===typeof Db.ColumnHalo?Db.ColumnHalo:Db.ColumnHalo=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:Symbol["for"]("lively-instance-initialize"),value:function(N){var va=N.col;N=N.halo;Xb._get(Object.getPrototypeOf(Ra.prototype),
Symbol["for"]("lively-instance-initialize"),this).call(this,{targetAxis:N.target.col(va),halo:N})}},{key:"subject",get:function(){return"column"}},{key:"adjustStretch",value:function(N){this.targetAxis.width+=N}},{key:"getDelta",value:function(N){return N.state.dragDelta.x}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.x}},{key:"fetchPosition",value:function(){return aa.pt(this.axisOffset()+10,-45)}},{key:"fetchExtent",value:function(){return aa.pt(this.targetAxis.length-
10,40)}},{key:"getMenuOffset",value:function(N){return this.targetAxis.length>N.width?aa.pt(5,3):aa.pt(8,26)}},{key:"getMenuLayout",value:function(){return new aa.HorizontalLayout}},{key:"getResizeCursor",value:function(){return"col-resize"}},{key:"getMinViewerPosition",value:function(){return aa.pt(20,50)}},{key:"getMinSliderPosition",value:function(){return aa.pt(-this.targetAxis.min,0)}},{key:"getMinSpaceExtent",value:function(){return aa.pt(this.targetAxis.min,this.container.height+45)}},{key:"getMinSpaceBorder",
value:function(){return{extent:aa.pt(2,this.container.height+50),vertices:[aa.pt(1,0),aa.pt(1,this.container.height+50)]}}},{key:"getProportionViewerPosition",value:function(){return aa.pt(20,40)}},{key:"getProportionSliderBounds",value:function(N){return aa.pt(N.owner.width-5,0).extent(aa.pt(10,40))}},{key:"getDeviderBounds",value:function(){return aa.pt(4,15).extent(aa.pt(2,25))}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ColumnHalo"}}],Db,{pathInPackage:function(){return"./layout.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:9921,end:11276})})(aa.AxisHalo);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("CellGuide")&&"function"===typeof Db.CellGuide?Db.CellGuide:Db.CellGuide=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,
arguments)};return Xb(Ra,Kb,[{key:"menuItems",value:function(){var N=this,va=aa.Icon.textAttribute("check-square-o"),Wa=aa.Icon.textAttribute("square-o");va[1].textStyleClasses.push("annotation");Wa[1].textStyleClasses.push("annotation");Wa[1].paddingRight="2px";return[["Resize Policy",[[["Rigid  ",null].concat(Id(this.cellGroup.resize?Wa:va)),function(){N.cellGroup.resize=!1}],[["Space Filling  ",null].concat(Id(this.cellGroup.resize?va:Wa)),function(){N.cellGroup.resize=!0}]]],["Align at...",["center"].concat(Id((new aa.Rectangle).sides),
Id((new aa.Rectangle).corners)).map(function(pa){return[[pa,{paddingRight:"2px"}].concat(Id(N.cellGroup.align===pa?va:Wa),["  ",null]),function(){return N.cellGroup.align=pa}]})]].concat(this.cellGroup.morph?[["Release Morph from Cell",function(){var pa=N.cellGroup.morph;pa&&(N.world().firstHand.grab(pa),N.world().firstHand.longClickGrab=!0,pa.position=aa.pt(0))}]]:[])}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"CellGuide"}},{key:"properties",get:function(){return{cellGroup:{}}}}],
Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:11278,end:12478})})(aa.Morph);(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("LayoutHalo")&&"function"===typeof Db.LayoutHalo?Db.LayoutHalo:Db.LayoutHalo=function(N){if(!N||
!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,void 0,[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"LayoutHalo"}},{key:"properties",get:function(){return{container:{},target:{get:function(){return this.container.layout}},pointerId:{},halosEnabled:{defaultValue:!1},isEpiMorph:{defaultValue:!0},isHaloItem:{defaultValue:!0},borderColor:{defaultValue:aa.Color.orange},borderWidth:{defaultValue:2},
styleClasses:{defaultValue:["Halo"]}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:12480,end:13052})})(aa.Morph);var Ma=Lc("G",function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("GridLayoutHalo")&&"function"===typeof Db.GridLayoutHalo?
Db.GridLayoutHalo:Db.GridLayoutHalo=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"previewDrop",value:function(N){1>N.length||(N=this.cellGuides.find(function(va){return va.fullContainsWorldPoint($world.firstHand.position)}),N!==this.currentCell&&this.currentCell&&this.currentCell.stopPreview(),(this.currentCell=N)&&this.currentCell.startPreview())}},{key:"handleDrop",value:function(N){var va=
this;this.currentCell&&N.whenRendered().then(function(){return va.currentCell.cellGroup.morph=N})}},{key:"initialize",value:function(){this.initGuides();this.alignWithTarget();this.focus()}},{key:"optionControls",value:function(){var N=this.target,va=new aa.LabeledCheckBox({name:"compensateOrigin",label:"Compensate Origin",fill:aa.Color.transparent,checked:N.compensateOrigin}),Wa=new aa.LabeledCheckBox({label:"Resize Submorphs",fill:aa.Color.transparent,name:"fitToCell",checked:N.fitToCell});aa.connect(va,
"checked",N,"compensateOrigin");aa.connect(Wa,"checked",N,"fitToCell");aa.connect(va,"checked",this,"alignWithTarget");return[va,Wa]}},{key:"isLayoutHalo",get:function(){return!1}},{key:"alignWithTarget",value:function(){this.target.apply();this.position=this.container.globalPosition;this.target.compensateOrigin&&this.moveBy(this.container.origin.negated());this.extent=this.container.extent;this.addMissingGuides();this.guides.reverse().forEach(function(N){return N.alignWithTarget()})}},{key:"addMissingGuides",
value:function(){var N=this;aa.arr.withoutAll(this.target.cellGroups,this.guides.map(function(va){return va.cellGroup})).forEach(function(va){return N.addMorph(N.cellGuide(va))})}},{key:"initGuides",value:function(){this.submorphs=[];this.guides=[];this.initCellGuides();this.initColumnGuides();this.initRowGuides()}},{key:"initCellGuides",value:function(){var N=this,va=this.addMorph({fill:aa.Color.transparent,borderRadius:this.borderRadius,extent:this.extent});this.target.cellGroups.forEach(function(Wa){va.addMorph(N.cellGuide(Wa))});
this.cellGuides=va.submorphs;this.addMorph(this.resizer())}},{key:"addGuide",value:function(N){N.isHaloItem=!0;this.guides.push(N);return N}},{key:"initRowGuides",value:function(){var N=this,va=this;this.addGuide(this.addMorph(new aa.Morph({width:25,fill:aa.Color.gray.withA(.7),borderRadius:15,height:this.container.height,topRight:aa.pt(-5,0),alignWithTarget:function(){this.height=va.container.height}})));aa.arr.range(0,this.target.rowCount-1).forEach(function(Wa){N.addMorph(new aa.RowHalo({row:Wa,
halo:N}))})}},{key:"initColumnGuides",value:function(){var N=this,va=this;this.addGuide(this.addMorph(new aa.Morph({height:25,fill:aa.Color.gray.withA(.7),borderRadius:15,width:this.container.width,bottomLeft:aa.pt(0,-5),alignWithTarget:function(){this.width=va.container.width}})));aa.arr.range(0,this.target.columnCount-1).forEach(function(Wa){N.addMorph(new aa.ColumnHalo({col:Wa,halo:N}))})}},{key:"resizer",value:function(){var N=this;return this.addGuide(new aa.Morph({fill:aa.Color.transparent,
extent:aa.pt(25,25),nativeCursor:"nwse-resize",onDrag:function(va){N.container.resizeBy(va.state.dragDelta);N.alignWithTarget()},alignWithTarget:function(){this.bottomRight=N.extent}}))}},{key:"cellResizer",value:function(N,va){var Wa=this,pa="topLeft"===va?"bottomRight":"topLeft";return new aa.Ellipse({borderWidth:1,visible:!1,borderColor:aa.Color.black,nativeCursor:"nwse-resize",removeCell:function(tb){N.disconnect(tb);Wa.alignWithTarget()},addCell:function(tb){N.connect(tb);Wa.alignWithTarget()},
start:function(){this.fixpointCell=N[pa];this.draggedDelta=N.bounds().partNamed(va);this.debugMorph=Wa.addMorph(new aa.Morph({fill:aa.Color.orange.withA(.5)}))},update:function(tb){var ab=this;this.draggedDelta=this.draggedDelta.addPt(tb);var Ob=aa.Rectangle.unionPts([this.draggedDelta]).union(this.fixpointCell.bounds());this.debugMorph.setBounds(Ob);Wa.cells.forEach(function(yc){var Ta=Ob.intersection(yc.bounds()).area()/yc.bounds().area();N.includes(yc)&&.1>Ta&&ab.removeCell(yc);!N.includes(yc)&&
Ta>1/3&&ab.addCell(yc)})},onDragEnd:function(tb){this.debugMorph.remove()},onDragStart:function(tb){this.start(tb.position)},onDrag:function(tb){this.update(tb.state.dragDelta)}})}},{key:"cellGuide",value:function(N){var va=this,Wa=this.cellResizer(N,"topLeft"),pa=this.cellResizer(N,"bottomRight");return this.addGuide(new aa.CellGuide({cellGroup:N,bounds:N.bounds(),fill:aa.Color.transparent,borderColor:aa.Color.orange,borderWidth:1,isHaloItem:!0,isCell:!0,draggable:!1,submorphs:[Wa,pa],onMouseDown:function(tb){this.becomeActive()},
deactivate:function(){this.borderColor=aa.Color.orange;this.fill=aa.Color.transparent;this.submorphs.forEach(function(tb){tb.visible=!1})},becomeActive:function(){va.guides.forEach(function(tb){tb.isCell&&tb.deactivate()});this.borderColor=aa.Color.rgbHex("#1565C0");this.fill=aa.Color.rgbHex("#1565C0").withA(.3);va.addMorph(this.remove());this.submorphs.forEach(function(tb){tb.visible=!0})},startPreview:function(tb){this.fill=aa.Color.orange.withA(.7)},stopPreview:function(tb){this.fill=aa.Color.transparent},
onDrop:function(tb){var ab=Bb(tb.hand.grabbedMorphs,1)[0];tb.hand.dropMorphsOn(va.container);N.morph=ab},alignWithTarget:function(){N.bounds().isNonEmpty()?(this.setBounds(N.bounds()),Wa.center=this.innerBounds().topLeft(),pa.center=this.innerBounds().bottomRight()):(aa.arr.remove(va.guides,this),this.remove())}}))}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"GridLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:aa.Color.transparent},cells:{derived:!0,
get:function(){return this.target.col(0).items.map(function(N){return N.row(0).items}).flat()}},submorphs:{after:["target"],initialize:function(){this.initialize()}}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:13061,end:20618})}(aa.LayoutHalo));aa.GridLayoutHalo=Ma;aa.GridLayoutHalo=
Ma;(function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("DropPreview")&&"function"===typeof Db.DropPreview?Db.DropPreview:Db.DropPreview=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"clear",value:function(){this.stopped=!0;this.remove()}},{key:"step",value:function(){var N=Nb(regeneratorRuntime.mark(function Wa(){var pa;return regeneratorRuntime.wrap(function(tb){for(;;)switch(tb.prev=
tb.next){case 0:return pa=aa.easings.inOutQuad,tb.next=3,this.animate({opacity:.5,duration:(this.pulseDuration-10)/2,easing:pa});case 3:return tb.next=5,this.animate({opacity:1,duration:(this.pulseDuration-10)/2,easing:pa});case 5:this.stopped||this.step();case 6:case "end":return tb.stop()}},Wa,this)}));return function(){return N.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"DropPreview"}},{key:"properties",get:function(){return{isHaloItem:{readOnly:!0,
get:function(){return!0}},epiMorph:{readOnly:!0,get:function(){return!0}},fill:{defaultValue:aa.Color.orange.withA(.3)},hasFixedPosition:{defaultValue:!0},borderColor:{defaultValue:aa.Color.orange},borderWidth:{defaultValue:2},borderStyle:{defaultValue:"dashed"},pulseDuration:{defaultValue:2E3}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:20620,end:21664})})(aa.Morph);var qb=function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("TilingLayoutHalo")&&"function"===typeof Db.TilingLayoutHalo?Db.TilingLayoutHalo:Db.TilingLayoutHalo=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"remove",value:function(){Xb._get(Object.getPrototypeOf(Ra.prototype),
"remove",this).call(this);this.removePreviews();return this}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"handleDrop",value:function(N){}},{key:"removePreviews",value:function(){this.previews.forEach(function(N){return N.clear()})}},{key:"previewDrop",value:function(N){var va=this;0<this.previews.length||(this.previews=N.map(function(Wa){return va.container.addMorph({type:aa.DropPreview,bounds:Wa.bounds()})}),this.previews.forEach(function(Wa){Wa.step()}))}},
{key:"updateSpacing",value:function(N){this.target.spacing=N}},{key:"updateAxis",value:function(N){this.target.axis=N}},{key:"updateAlign",value:function(N){this.target.align=N}},{key:"optionControls",value:function(){var N=this.target,va=new aa.DropDownSelector({borderRadius:2,padding:3,selectedValue:N.axis,values:["row","column"]}),Wa=new aa.DropDownSelector({borderRadius:2,padding:3,selectedValue:N.align,values:["left","center"]});N=new aa.NumberWidget({min:0,number:N.spacing,padding:aa.rect(5,
3,0,0),borderRadius:3,borderWidth:1,borderColor:aa.Color.gray,unit:"px"});aa.connect(N,"update",this,"updateSpacing");aa.connect(Wa,"update",this,"updateAlign");aa.connect(va,"update",this,"updateAxis");var pa={type:"label",padding:aa.rect(0,5,5,5),fill:aa.Color.transparent,fontColor:aa.Color.gray.darker(),readOnly:!0};return[[Object.assign({},pa,{textString:"Submorph Spacing"}),N],[Object.assign({},pa,{textString:"Tiling Align"}),Wa],[Object.assign({},pa,{textString:"Tiling Axis"}),va]].map(function(tb){return{submorphs:tb,
fill:null,layout:new aa.HorizontalLayout({spacing:3})}})}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"TilingLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:aa.Color.transparent},previews:{defaultValue:[]}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:21673,end:23839})}(aa.LayoutHalo);aa.TilingLayoutHalo=qb;aa.TilingLayoutHalo=qb;qb=Lc("F",function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),Ra=Db.hasOwnProperty("FlexLayoutHalo")&&"function"===typeof Db.FlexLayoutHalo?Db.FlexLayoutHalo:Db.FlexLayoutHalo=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"handleDrop",value:function(N){}},{key:"previewDrop",
value:function(N){var va=this;0<this.previews.length||(this.previews=N.map(function(Wa){return va.container.addMorph({type:aa.DropPreview,position:va.container.localize(va.world().firstHand.position),extent:Wa.bounds().extent()})}),this.previews.forEach(function(Wa){Wa.step()}))}},{key:"remove",value:function(){Xb._get(Object.getPrototypeOf(Ra.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"removePreviews",value:function(){this.previews.forEach(function(N){return N.clear()})}},
{key:"onDrop",value:function(N){this.removePreviews();N.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateAutoResizePolicy",value:function(N){N&&(this.originalExtent=this.container.extent);this.target.autoResize=N;N||(this.container.extent=this.originalExtent||this.container.extent);this.alignWithTarget()}},{key:"updateResizeSubmorphsPolicy",value:function(N){this.target.resizeSubmorphs=N;this.alignWithTarget()}},
{key:"updateAlignmentPolicy",value:function(N){this.target.align=N}},{key:"updateDirectionPolicy",value:function(N){this.target.direction=N}},{key:"updateSpacing",value:function(N){this.target.spacing=N}},{key:"optionControls",value:function(){var N=this.target,va=N.possibleAlignValues?{fill:aa.Color.transparent,layout:new aa.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"align: "},new aa.DropDownSelector({name:"alignment",borderRadius:2,padding:3,
selectedValue:N.align,values:N.possibleAlignValues})]}:null,Wa=N.possibleDirectionValues?{fill:aa.Color.transparent,layout:new aa.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"direction: "},new aa.DropDownSelector({name:"direction",borderRadius:2,padding:3,selectedValue:N.direction,values:N.possibleDirectionValues})]}:null,pa=new aa.NumberWidget({fill:aa.Color.white,borderWidth:1,borderRadius:4,padding:aa.rect(5,4,0,0),borderColor:aa.Color.gray,
min:0,number:N.spacing,unit:"px"}),tb=new aa.LabeledCheckBox({name:"autoResize",label:"Resize Container",alignCheckBox:"right",fill:aa.Color.transparent,checked:N.autoResize});N=new aa.LabeledCheckBox({label:"Resize Submorphs",name:"resizeSubmorphs",alignCheckBox:"right",fill:aa.Color.transparent,checked:N.resizeSubmorphs});aa.connect(pa,"update",this,"updateSpacing");aa.connect(tb,"checked",this,"updateAutoResizePolicy");aa.connect(N,"checked",this,"updateResizeSubmorphsPolicy");va&&aa.connect(va.submorphs[1],
"selectedValue",this,"updateAlignmentPolicy");Wa&&aa.connect(Wa.submorphs[1],"selectedValue",this,"updateDirectionPolicy");return[tb,N].concat(Id([va,Wa].filter(Boolean)),[{fill:aa.Color.transparent,layout:new aa.HorizontalLayout,submorphs:[{type:"label",value:"Submorph Spacing",fontColor:aa.Color.gray.darker(),padding:aa.rect(0,5,5,5)},pa]}])}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"FlexLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},
fill:{defaultValue:aa.Color.transparent},halosEnabled:{defaultValue:!1},previews:{defaultValue:[]}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:23847,end:27920})}(aa.LayoutHalo));aa.FlexLayoutHalo=qb;aa.FlexLayoutHalo=qb;var Vb=Lc("P",function(Kb){var Db=window.lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),
Ra=Db.hasOwnProperty("ProportionalLayoutHalo")&&"function"===typeof Db.ProportionalLayoutHalo?Db.ProportionalLayoutHalo:Db.ProportionalLayoutHalo=function(N){if(!N||!N[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Ra,Kb,[{key:"handleDrop",value:function(N){}},{key:"onDrop",value:function(N){N.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},
{key:"updateSubmorphProportionalLayoutSettings",value:function(N){this.target.changeSettingsFor(N.submorph,ia({},N.axis,N.policy),!0)}},{key:"onSubmorphSettingsDragStart",value:function(N,va){var Wa=this;N.stop();var pa=this.target.settingsFor(va);va="";for(var tb in pa)va+="".concat(tb,":").concat(pa[tb]," ");var ab=aa.morph({type:"label",value:va,isLayoutable:!1});ab.wantsToBeDroppedOn=function(Ob){return Wa.target.layoutableSubmorphs.includes(Ob)};ab.onBeingDroppedOn=function(Ob,yc){ab.remove();
if(Ob=Wa.target.layoutableSubmorphs.includes(yc)?yc:N.world.morphsContainingPoint(N.hand.position).find(function(Ta){return Wa.target.layoutableSubmorphs.includes(Ta)}))Wa.updateSubmorphProportionalLayoutSettings({policy:pa.x,axis:"x",submorph:Ob}),Wa.updateSubmorphProportionalLayoutSettings({policy:pa.y,axis:"y",submorph:Ob}),Ob.show(),$world.setStatusMessage("layout settings applied")};N.hand.grab(ab)}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var N=Nb(regeneratorRuntime.mark(function Wa(){var pa,
tb,ab,Ob,yc,Ta,Bd,Eb,fe,Od,Hd,Qc;return regeneratorRuntime.wrap(function(Xd){for(;;)switch(Xd.prev=Xd.next){case 0:pa=this.target.layoutableSubmorphs;if(!this.env.eventDispatcher.isKeyPressed("Shift")){Xd.next=9;break}yc=pa.map(function(oc){return{isListItem:!0,string:String(oc),value:oc}});Xd.next=5;return $world.listPrompt("Select morph",yc,{requester:this,onSelection:function(oc){return oc.show()}});case 5:aa.__inter0__=Xd.sent;ab=aa.__inter0__.selected;Ob=Bb(ab,1);tb=Ob[0];Xd.next=12;break;case 9:return Xd.next=
11,aa.InteractiveMorphSelector.selectMorph(this.world(),this,function(oc){return pa.includes(oc)});case 11:tb=Xd.sent;case 12:if(tb){Xd.next=14;break}return Xd.abrupt("return");case 14:Ta=this.state.popover.get("controlContainer"),Bd=Ta.getAllNamed(/submorph config/),Eb=["move","resize","scale","fixed"],fe=this.target.settingsFor(tb),Bd.length||(Ta.submorphs=[].concat(Id(Ta.submorphs),[{name:"submorph config X-Axis policy",position:aa.pt(0,this.height),fill:aa.Color.transparent,layout:new aa.HorizontalLayout({spacing:3,
direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph X-Axis policy: "},new aa.DropDownSelector({name:"x-axis policy selector",borderRadius:2,padding:3,selectedValue:fe.x,values:Eb})]},{name:"submorph config Y-Axis policy",position:aa.pt(0,this.height),fill:aa.Color.transparent,layout:new aa.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph Y-Axis policy: "},new aa.DropDownSelector({name:"y-axis policy selector",borderRadius:2,
padding:3,selectedValue:fe.y,values:Eb})]},aa.morph({position:aa.pt(0,this.height+20),draggable:!0,name:"dragme",type:"label",value:"drag me to copy"})])),Od=Ta.getSubmorphNamed("x-axis policy selector"),Hd=Ta.getSubmorphNamed("y-axis policy selector"),Qc=Ta.getSubmorphNamed("dragme"),aa.disconnect(Od,"selectedValue",this,"updateSubmorphProportionalLayoutSettings"),aa.disconnect(Hd,"selectedValue",this,"updateSubmorphProportionalLayoutSettings"),Od.selectedValue=fe.x,Hd.selectedValue=fe.y,aa.connect(Qc,
"onDragStart",this,"onSubmorphSettingsDragStart",{updater:function(oc,rf){return oc(rf,tb)},varMapping:{submorph:tb}}),aa.connect(Od,"selectedValue",this,"updateSubmorphProportionalLayoutSettings",{converter:function(oc){return{policy:oc,axis:"x",submorph:tb}},varMapping:{submorph:tb}}),aa.connect(Hd,"selectedValue",this,"updateSubmorphProportionalLayoutSettings",{converter:function(oc){return{policy:oc,axis:"y",submorph:tb}},varMapping:{submorph:tb}});case 29:case "end":return Xd.stop()}},Wa,this)}));
return function(){return N.apply(this,arguments)}}()},{key:"optionControls",value:function(N){this.state.popover=N;var va=this.target;N=new aa.LabeledCheckBox({name:"x-axis",label:"X-Axis",alignCheckBox:"right",fill:aa.Color.transparent,checked:va.xAxisEnabled});va=new aa.LabeledCheckBox({name:"y-axis",label:"Y-Axis",alignCheckBox:"right",fill:aa.Color.transparent,checked:va.yAxisEnabled});var Wa=new aa.Button({name:"modify submorph settings button",label:[].concat(Id(aa.Icon.textAttribute("crosshairs")),
["\u00a0Change submorph settings"])});aa.connect(N,"checked",this,"updateXAxisEnabled");aa.connect(va,"checked",this,"updateYAxisEnabled");aa.connect(Wa,"fire",this,"chooseSubmorphToChangeLayoutSettings");return[Wa]}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ProportionalLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},fill:{defaultValue:aa.Color.transparent}}}}],Db,{pathInPackage:function(){return"./layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.halos",version:"0.1.0"}}},{start:27928,end:33939})}(aa.LayoutHalo));aa.ProportionalLayoutHalo=Vb;aa.ProportionalLayoutHalo=Vb;var Lb=window.lively.FreezerRuntime.recorderFor("lively.halos/index.js");Lb.Halo=Oc;Lb.MorphHighlighter=Ub;Lb.InteractiveMorphSelector=vc;Lb.show=xb;Lb.ProportionalLayoutHalo=Vb;Lb.GridLayoutHalo=Ma;Lb.FlexLayoutHalo=qb;Lb.showAndSnapToGuides=E;Lb.removeSnapToGuidesOf=
jb;Lb.show=xb;Lb.Halo=Oc;Lb.MorphHighlighter=Ub;Lb.InteractiveMorphSelector=vc;Lb.ProportionalLayoutHalo=Vb;Lb.GridLayoutHalo=Ma;Lb.FlexLayoutHalo=qb;Lb.showAndSnapToGuides=E;Lb.removeSnapToGuidesOf=jb;Ub=Object.freeze({__proto__:null,show:xb,Halo:Oc,MorphHighlighter:Ub,InteractiveMorphSelector:vc,ProportionalLayoutHalo:Vb,GridLayoutHalo:Ma,FlexLayoutHalo:qb,showAndSnapToGuides:E,removeSnapToGuidesOf:jb});Lc("i",Ub);Lc("_",void 0)}}});
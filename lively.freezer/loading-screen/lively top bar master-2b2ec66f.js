System.register("./__root_module__-f9290433.js kld-intersections ./user-ui-f9ff2404.js ./editor-plugin-70198a84.js ./index-9e4ab300.js ./index-5ea42d9a.js ./index-6fbfb2e6.js".split(" "),function(sa,db){var Eb,Vb,Wb,wd,Ic,Ad,Jc,Mc;return{setters:[function(bd){Eb=bd.ag;Vb=bd.am;Wb=bd.a1;wd=bd.C;Ic=bd.a4;Ad=bd.L;Jc=bd.r;Mc=bd.aq},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var bd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");bd.Morph=
Eb;bd.Icon=Vb;bd.pt=Wb;bd.Color=wd;bd.arr=Ic;bd.LoadingIndicator=Ad;bd.resource=Jc;var ed=function(Od){var qd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),Xc=qd.hasOwnProperty("LivelyTopBar")&&"function"===typeof qd.LivelyTopBar?qd.LivelyTopBar:qd.LivelyTopBar=function(Ra){Ra&&Ra[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Mc(Xc,Od,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode=
"Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var Ra=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){if(1==wb.nextAddress)return Ra.isComponent?wb.return():wb.yield(Ra.whenRendered(),2);document.body.style.background="black";Ra.setEditMode("Halo");Ra.getSubmorphNamed("fast load toggler").refresh();wb.jumpToEnd()})}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=bd.pt(0,0));var Ra=
this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;Ra.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var Ra=this;return Object.entries(this.shapeToIcon).map(function(wb){wb=$jscomp.makeIterator(wb);var mc=wb.next().value,dc=wb.next().value;wb=dc.shortcut;dc=dc.args;return[[].concat($jscomp.arrayFromIterable(Ra.currentShapeMode===mc?[].concat($jscomp.arrayFromIterable(bd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),
$jscomp.arrayFromIterable(bd.Icon.textAttribute.apply(bd.Icon,$jscomp.arrayFromIterable(dc))),["   "+mc+" ",{float:"none"},"      "+wb,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){Ra.currentShapeMode=mc;Ra.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var Ra=this;return Object.entries(this.sideBarToIcon).map(function(wb){wb=$jscomp.makeIterator(wb);var mc=wb.next().value;wb=wb.next().value.args;return[[].concat($jscomp.arrayFromIterable(Ra.activeSideBars.includes(mc)?
[].concat($jscomp.arrayFromIterable(bd.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(bd.Icon.textAttribute.apply(bd.Icon,$jscomp.arrayFromIterable(wb))),["   "+mc+" ",{float:"none"}]),function(){return Ra.openSideBar(mc)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",
value:function(Ra){"Hand"==this._currentEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(Ra){Mc._get(Object.getPrototypeOf(Xc.prototype),"onKeyDown",this).call(this,Ra);if(Ra.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!Ra.isAltDown()){var wb={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(Ra.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=
wb[Ra.key];this.setEditMode("Shape");break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(Ra){var wb=this,mc,dc,Rc,Tc,zc,Fc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jb){switch(Jb.nextAddress){case 1:wb.activeSideBars.includes(Ra)?bd.arr.remove(wb.activeSideBars,Ra):wb.activeSideBars.push(Ra);if("Scene Graph"!=Ra){Jb.jumpTo(2);break}if(wb.sideBar){Jb.jumpTo(3);break}mc=bd.LoadingIndicator.open("loading side bar");dc=wb;return Jb.yield(db.import("./scene graph side bar master-f921a42d.js"),
5);case 5:if(!(Rc=Jb.yieldResult)){Jb.jumpTo(6);break}return Jb.yield(bd.resource("part://SystemIDE/scene graph side bar master"),7);case 7:Rc=Jb.yieldResult;case 6:return Jb.yield(Rc.read(),4);case 4:return dc.sideBar=Jb.yieldResult,wb.sideBar.openInWorld(),wb.sideBar.right=0,Jb.yield(wb.sideBar.whenRendered(),8);case 8:mc.remove();case 3:wb.sideBar.toggle(wb.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=Ra){Jb.jumpTo(0);break}if(wb.stylingPalette){Jb.jumpTo(10);break}Tc=bd.LoadingIndicator.open("loading side bar");
zc=wb;return Jb.yield(db.import("./styling side bar master-bf3a2479.js"),12);case 12:if(!(Fc=Jb.yieldResult)){Jb.jumpTo(13);break}return Jb.yield(bd.resource("part://SystemIDE/styling side bar master"),14);case 14:Fc=Jb.yieldResult;case 13:return Jb.yield(Fc.read(),11);case 11:return zc.stylingPalette=Jb.yieldResult,wb.stylingPalette.openInWorld(),wb.stylingPalette.left=wb.world().right,Jb.yield(wb.stylingPalette.whenRendered(),15);case 15:Tc.remove();case 10:wb.stylingPalette.toggle(wb.activeSideBars.includes("Styling Palette")),
Jb.jumpToEnd()}})}},{key:"onMouseDown",value:function(Ra){var wb=this.get("select shape type"),mc=this.get("shape mode button"),dc=this.get("side bar selector");Ra.targetMorph==wb&&(this.world().openWorldMenu(Ra,this.getShapeMenuItems()).position=mc.globalBounds().bottomLeft().subPt(this.world().scroll));Ra.targetMorph==mc&&this.setEditMode("Shape");"text mode button"==Ra.targetMorph.name&&this.setEditMode("Text");"hand mode button"==Ra.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==
Ra.targetMorph.name&&this.setEditMode("Halo");"open component browser"==Ra.targetMorph.name&&this.interactivelyLoadComponent();Ra.targetMorph==dc&&(this.world().openWorldMenu(Ra,this.getSideBarMenuItems()).position=dc.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var Ra=this,wb,mc,dc,Rc,Tc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zc){if(1==zc.nextAddress)return wb=Ra.get("open component browser"),mc=Ra.get("user flap"),
dc=mc.haloShadow,Rc=mc.haloColor,Tc=bd.Color.rgb(102,102,102),wb.fontColor=Rc,wb.dropShadow=dc,zc.yield(Ra.world().execCommand("browse and load component"),2);wb.dropShadow=!1;wb.fontColor=Tc;zc.jumpToEnd()})}},{key:"setEditMode",value:function(Ra,wb){var mc=this;wb=void 0===wb?!1:wb;var dc=this.get("user flap"),Rc=dc.haloShadow,Tc=dc.haloColor,zc=bd.Color.rgb(102,102,102);wb||(this._currentEditMode=Ra);wb=this.get("shape mode button");dc=this.get("text mode button");var Fc=this.get("hand mode button"),
Jb=this.get("halo mode button");[["Shape",wb.submorphs],["Text",[dc]],["Hand",[Fc]],["Halo",[Jb]]].forEach(function(Ac){var Bc=$jscomp.makeIterator(Ac);Ac=Bc.next().value;Bc=Bc.next().value;"Shape"==Ra?mc.world().toggleShapeMode(!0,mc.currentShapeMode):"Text"==Ra?mc.world().toggleShapeMode(!0,"Text"):mc.world().toggleShapeMode(!1);mc.world().showHaloPreviews("Halo"==Ra);Ac==Ra?Bc.forEach(function(fd){fd.dropShadow=Rc;fd.fontColor=Tc}):Bc.forEach(function(fd){fd.dropShadow=null;fd.fontColor=zc})})}}],
[{key:"className",get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],set:function(Ra){this.setProperty("currentShapeMode",Ra);this.get("shape status icon").textAndAttributes=bd.Icon.textAttribute(this.shapeToIcon[Ra].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,
get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},HTML:{shortcut:"H",
args:["code",{paddingTop:"1px"}]}}}}}}}],qd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-150"}}},{start:328,end:8962})}(bd.Morph);ed=bd.LivelyTopBar;bd.default=ed}}});
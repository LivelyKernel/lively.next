System.register("./__root_module__-884b54f8.js kld-intersections ./object-classes-27c453f9.js ./user-ui-2bb4d74a.js ./index-4d2f3cd3.js ./index-46ea5601.js".split(" "),function(){var za,cb,mb,Pb,tb,Fc,vc,Qc,mc,ic,zc,Dc,Gd,Hd,Zd,xc,od,qb,kc;return{setters:[function(Uc){za=Uc.M;cb=Uc.af;mb=Uc.aa;Pb=Uc.m;tb=Uc.ae;Fc=Uc.a;vc=Uc.f;Qc=Uc.s;mc=Uc.C;ic=Uc.b;zc=Uc.r;Dc=Uc.i;Gd=Uc.t;Hd=Uc.aA;Zd=Uc.aB;xc=Uc.c;od=Uc.ax;qb=Uc._},function(){},function(){},function(Uc){kc=Uc.UserUI},function(){},function(){}],
execute:function(){var Uc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");Uc.Morph=za;Uc.HorizontalLayout=cb;Uc.VerticalLayout=mb;Uc.morph=Pb;Uc.MorphicDB=tb;Uc.arr=Fc;Uc.fun=vc;Uc.string=Qc;Uc.Color=mc;Uc.pt=ic;Uc.UserUI=kc;Uc.resource=zc;var tc=function(nb){var cc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),wc=cc.hasOwnProperty("WorldDashboard")&&"function"===typeof cc.WorldDashboard?cc.WorldDashboard:cc.WorldDashboard=function(dc){dc&&dc[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Dc(wc,nb,[{key:"onLoad",value:function(){if(!this.isComponent&&"undefined"!==typeof localStorage){var dc=localStorage.getItem("lively.morphic-projects-filter");dc&&this.ui.sortSelector.selection!=dc&&(this.ui.sortSelector.selection=dc)}}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",
this.ui.sortSelector.selection)}catch(dc){console.error(dc)}}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(dc){dc=void 0===dc?$world:dc;this.owner!=dc&&dc.addMorph(this);this.center=dc.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(dc){var Nc=Uc.UserUI.getCurrentUser();dc=this.ui.searchField.fuzzyFilter(dc,
function($a){return $a._commit.name+$a._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return Uc.arr.sortBy(dc,function($a){return-$a._commit.timestamp});case "TEMPLATES":return dc;case "MY PROJECTS":return Uc.arr.filter(dc,function($a){return $a._commit.author.name===Nc.name});case "PUBLISHED":return dc}}},{key:"updateList",value:function(){var dc=this;this.previews&&Uc.fun.debounceNamed("update world list",150,function(){dc.ui.worldList.items=dc.sortAndFilterPreviews(dc.previews)})()}},
{key:"displayWorlds",value:function(){var dc=this,Nc,$a,Xa,Gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ub){switch(ub.nextAddress){case 1:return dc.reset(),Nc=dc.ui,$a=Nc.loadingLabel,$a.fit(),$a.animate({opacity:1,duration:300}),ub.yield(dc.db.latestCommits("world"),2);case 2:return Xa=ub.yieldResult,ub.yield(Uc.resource("part://partial freezing/world preview").read(),3);case 3:return Gb=ub.yieldResult,dc.previews=Xa.map(function(db){var Xb=Uc.morph({reactsToPointer:!1,fill:Uc.Color.transparent,
extent:Gb.extent});Xb._commit=db;Xb.displayPreview=function(){var Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){if(1==sb.nextAddress)return Fa=Gb.copy(),Fa._commit=db,Fa.opacity=0,Xb.addMorph(Fa),Fa.displayPreview(),Fa.position=Uc.pt(0,0),sb.yield(Xb.whenRendered(),2);Xb.layout=new Uc.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});sb.jumpToEnd()})};return Xb}),ub.yield($a.animate({opacity:0,duration:300}),4);case 4:dc.updateList(),0==Xa.length&&(dc.ui.noWorldWarning.center=
dc.innerBounds().center(),dc.ui.noWorldWarning.animate({visible:!0,duration:300})),ub.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(dc){this.ui.closeButton.visible=dc}},db:{serialize:!1,get:function(){return Uc.MorphicDB.default}},
ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],cc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"WorldDashboard",version:"0.1.1-135"}}},{start:330,end:4417})}(Uc.Morph);tc=Uc.WorldDashboard;Uc.default=tc;var cd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");cd.Morph=za;cd.touchInputDevice=Gd;cd.TilingLayout=Hd;cd.arr=Fc;cd.pt=ic;tc=function(nb){var cc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),wc=cc.hasOwnProperty("GrowingWorldList")&&"function"===typeof cc.GrowingWorldList?cc.GrowingWorldList:cc.GrowingWorldList=function(dc){dc&&
dc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Dc(wc,nb,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(dc){Dc._get(Object.getPrototypeOf(wc.prototype),"onScroll",this).call(this,dc);this.update()}},{key:"onChange",value:function(dc){Dc._get(Object.getPrototypeOf(wc.prototype),"onChange",this).call(this,dc);"extent"==dc.prop&&this.update(!0)}},{key:"onHoverIn",value:function(dc){this.clipMode=
"auto"}},{key:"onHoverOut",value:function(dc){cd.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(dc){var Nc=this.items;if(Nc&&0!=Nc.length){var $a=this.scrollContainer,Xa=$a.layout.spacing;$a.extent=this.extent;var Gb=this.ui,ub=Gb.bufferTop;Gb=Gb.bufferBottom;ub=ub||$a.addMorph({fill:null,name:"buffer top",height:10});Gb=Gb||$a.addMorph({fill:null,name:"buffer bottom",height:10});ub.width=Gb.width=this.width-100;$a.layout.disable();var db=Nc[0];Xa=Nc.slice(0,Math.floor(this.width/
(db.width+Xa))*(Math.ceil((this.scroll.y+this.height)/(db.height+Xa))+1)).filter(function(Ya){return Ya.owner!=$a});db=this.scroll.y+2*this.height;for(var Xb={},Fa=$jscomp.makeIterator(Xa),sb=Fa.next();!sb.done;Xb={$jscomp$loop$prop$item$2753:Xb.$jscomp$loop$prop$item$2753},sb=Fa.next())Xb.$jscomp$loop$prop$item$2753=sb.value,db++,Xb.$jscomp$loop$prop$item$2753.top=db,$a.addMorph(Xb.$jscomp$loop$prop$item$2753),Xb.$jscomp$loop$prop$item$2753._initialized||Xb.$jscomp$loop$prop$item$2753.whenRendered().then(function(Ya){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(pb){Ya.$jscomp$loop$prop$item$2753._initialized=
!0;return pb.yield(Ya.$jscomp$loop$prop$item$2753.displayPreview(),0)})}}(Xb));dc&&(ub.position=cd.pt(0,0),Nc.forEach(function(Ya,pb){return Ya.position=cd.pt(pb+1,pb+1)}),Gb.position=cd.pt(Nc.length+2,Nc.length+2));$a.layout.enable();if(dc||0<Xa.length)Gb.top=this.submorphBounds().height,$a.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new cd.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(dc){this.setProperty("items",dc);var Nc=this.scrollContainer;Nc.layout&&Nc.layout.disable();var $a=this.ui,Xa=$a.bufferTop;$a=$a.bufferBottom;cd.arr.withoutAll(Nc.submorphs,
[].concat($jscomp.arrayFromIterable(dc),[Xa,$a])).forEach(function(Gb){return Gb.remove()});this.update(!0)}}}}}],cc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(cd.Morph);tc=cd.GrowingWorldList;cd.default=tc;var td=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
td.InputLine=Zd;td.Color=mc;td.connect=xc;td.disconnectAll=od;td.disconnect=qb;td.arr=Fc;td.string=Qc;tc=function(nb){var cc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),wc=cc.hasOwnProperty("SearchInputLine")&&"function"===typeof cc.SearchInputLine?cc.SearchInputLine:cc.SearchInputLine=function(dc){dc&&dc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Dc(wc,nb,[{key:"fuzzyMatch",value:function(dc,Nc){Nc=void 0===
Nc?this.parseInput():Nc;if(Nc.lowercasedTokens.every(function(Xa){return dc.toLowerCase().includes(Xa)}))return!0;var $a=dc.toLowerCase();return 3>=td.arr.sum(Nc.lowercasedTokens.map(function(Xa){return td.string.levenshtein($a,Xa)}))}},{key:"fuzzyFilter",value:function(dc,Nc){var $a=this;Nc=void 0===Nc?function(Gb){return Gb}:Nc;var Xa=this.parseInput();return td.arr.filter(dc,function(Gb){return $a.fuzzyMatch(Nc(Gb),Xa)})}},{key:"parseInput",value:function(){var dc=Array.from(this.textString).reduce(function($a,
Xa){if("\\"===Xa&&!$a.escaped)return $a.escaped=!0,$a;" "!==Xa||$a.escaped?($a.spaceSeen=!1,$a.current+=Xa):(!$a.spaceSeen&&$a.current&&($a.tokens.push($a.current),$a.current=""),$a.spaceSeen=!0);$a.escaped=!1;return $a},{tokens:[],current:"",escaped:!1,spaceSeen:!1});dc.current&&dc.tokens.push(dc.current);var Nc=dc.tokens.map(function($a){return $a.toLowerCase()});return{tokens:dc.tokens,lowercasedTokens:Nc}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],cc,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(td.InputLine);tc=td.SearchInputLine;td.default=tc}}});
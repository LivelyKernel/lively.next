System.register(["./__root_module__-b4667baa.js","./index-82fc4eeb.js","./index-3aad35e9.js"],function(ta){var lb,yb,Qb,Kb,yd,Cc,rd,Fc,Dc,Rc,$c,Hd,gd,Uc,Pa,mb,Nb,Ub,Ic,wd,Eb,Sb,sb,ec,rc,yc,Db,ab,Zb,kc,ua,Ga,cb,rb,pb,Ta,Ua,ob,Wb,lc,Lb,qc,I,V,ra;return{setters:[function(ya){lb=ya.C;yb=ya.as;Qb=ya.a6;Kb=ya.a1;yd=ya.a3;Cc=ya.an;rd=ya.bg;Fc=ya.aU;Dc=ya.aq;Rc=ya.s;$c=ya.aP;Hd=ya.bn;gd=ya.bo;Uc=ya.a7;Pa=ya.au;mb=ya.ap;Nb=ya.ar;Ub=ya.bp;Ic=ya.bq;wd=ya.a2;Eb=ya.P;Sb=ya.$;sb=ya.aW;ec=ya.ai;rc=ya.aj;yc=
ya.ak;Db=ya.al;ab=ya.aB;Zb=ya.aZ;kc=ya.ax;ua=ya.ao;Ga=ya.aa;cb=ya.br;rb=ya.L;pb=ya.bs;Ta=ya.b2;Ua=ya.bh;ob=ya.b1;Wb=ya.bt;lc=ya.at},function(ya){Lb=ya.M;qc=ya.I;I=ya.v;V=ya.p},function(ya){ra=ya.localInterface}],execute:function(){function ya(va,Ma){if(!0===Ma)return Ma;if(va.copyState)return va.copyState(Ma);va={};for(var jb in Ma){var R=Ma[jb];R instanceof Array&&(R=R.concat([]));va[jb]=R}return va}function Gb(va,Ma,jb){return va.startState?va.startState(Ma,jb):!0}function Pb(va,Ma){return H.modes[va]=
Ma}function Ca(va){if("string"==typeof va&&H.mimeModes.hasOwnProperty(va))va=H.mimeModes[va];else if(va&&"string"==typeof va.name&&H.mimeModes.hasOwnProperty(va.name)){var Ma=H.mimeModes[va.name];"string"==typeof Ma&&(Ma={name:Ma});va=Object.assign({},Ma,va);va.name=Ma.name}else{if("string"==typeof va&&/^[\w\-]+\/[\w\-]+\+xml$/.test(va))return Ca("application/xml");if("string"==typeof va&&/^[\w\-]+\/[\w\-]+\+json$/.test(va))return Ca("application/json")}return"string"==typeof va?{name:va}:va||{name:"null"}}
function Yb(va,Ma){Ma=H.resolveMode(Ma);"string"===typeof Ma&&(Ma={name:Ma});if(!Ma.name)throw Error("parserConfig does not have a name of the mode to get");var jb=H.modes[Ma.name];if(!jb)return Yb(va,"text/plain");va=Object.assign({indentUnit:2},va);return Object.assign(jb(va,Ma),{name:Ma.name})}function jd(va,Ma){for(var jb;va.innerMode;){jb=va.innerMode(Ma);if(!jb||jb.mode==va)break;Ma=jb.state;va=jb.mode}return jb||{mode:va,state:Ma}}function Kc(va,Ma){H.mimeModes[va]=Ma}function zc(va,Ma,jb){}
function Ha(va,Ma,jb,R,wa,Za,eb){var hc=va.editorPlugin._tokenizerValidBefore;hc&&hc.row>=jb&&(hc.row=jb-1);var ic=H.linesToTokenize(va.document,jb,R,hc);hc=ic.lines;ic=ic.state;if(!hc.length)return!1;ic=ic?H.copyState(Ma,ic):H.startState(Ma);for(var Qc=0;Qc<hc.length;Qc++){var Pc=hc[Qc],Nc=Pc.row;Nc>=jb&&Nc<=R&&H.indentLine(va,Ma,Pc,ic,wa,Za,eb);ic=H.tokenizeLine(Ma,hc[Qc],ic,function(){})}return!0}function Ec(va,Ma,jb,R,wa,Za,eb){Ma=H.linesToTokenize(Ma,jb,R,wa);jb=Ma.lines;H.tokenizeLines(va,jb,
Ma.state,Za,eb);return jb}function Wa(va,Ma,jb,R,wa){var Za=[],eb,hc=function(Pc){return Za.push(eb=[])},ic=function(Pc,Nc,He,ie,df,lg,rh){return eb.push(He,ie,Pc,df.current(),Nc.localMode||rh)};try{var Qc=H.visitDocumentTokens(va,Ma,jb,R,wa,hc,ic)}catch(Pc){Za.length=0,Qc=H.visitDocumentTokens(va,Ma,jb,R,null,hc,ic)}return{tokens:Za,lines:Qc}}function cd(va,Ma,jb,R,wa){null==Ma&&(Ma=va.search(/[^\s\u00a0]/),-1==Ma&&(Ma=va.length));R=R||0;for(wa=wa||0;;){var Za=va.indexOf("\t",R);if(0>Za||Za>=Ma)return wa+
(Ma-R);wa+=Za-R;wa+=jb-wa%jb;R=Za+1}}function Na(va){va=va.toLowerCase();for(var Ma=0;Ma<H.modeInfo.length;Ma++){var jb=H.modeInfo[Ma];if(jb.mime==va)return jb;if(jb.mimes)for(var R=0;R<jb.mimes.length;R++)if(jb.mimes[R]==va)return jb}if(/\+xml$/.test(va))return Na("application/xml");if(/\+json$/.test(va))return Na("application/json")}function bb(va){for(var Ma=0;Ma<H.modeInfo.length;Ma++){var jb=H.modeInfo[Ma];if(jb.ext)for(var R=0;R<jb.ext.length;R++)if(jb.ext[R]==va)return jb}}function db(va){for(var Ma=
0;Ma<H.modeInfo.length;Ma++){var jb=H.modeInfo[Ma];if(jb.file&&jb.file.test(va))return jb}Ma=va.lastIndexOf(".");if(va=-1<Ma&&va.substring(Ma+1,va.length))return H.findModeByExtension(va)}function Sc(va){va=va.toLowerCase();for(var Ma=0;Ma<H.modeInfo.length;Ma++){var jb=H.modeInfo[Ma];if(jb.name.toLowerCase()==va)return jb;if(jb.alias)for(var R=0;R<jb.alias.length;R++)if(jb.alias[R].toLowerCase()==va)return jb}}function Fd(va){if(!va)return String(va);if(Array.isArray(va))return"["+va.map(Fd).join(",")+
"]";if("symbol"===typeof va)return nd.printSymbol(va);try{return String(va)}catch(Ma){return"Cannot print object: "+Ma}}function Pd(va,Ma){return!nd.arr.every(Ma.map(function(jb){return va[jb]}),function(jb){return nd.obj.equals(jb,va&&va.valueOf())})}function ae(va){if(nd.obj.isPrimitive(va))var Ma=nd.string.print(va);else Array.isArray(va)?((Ma=3<va.length)&&(va=va.slice(0,3)),va=nd.string.print(va),Ma&&(va=va.slice(0,-1)+", ...]"),Ma=va):Ma=nd.string.print(va);Ma=Ma.replace(/\n/g,"");500<Ma.length&&
(Ma=Ma.slice(0,20)+("...["+(Ma.length-20)+' CHARS]"'));return Ma}function tc(va){return pc.Inspector.openInWindow({targetObject:va})}function Kd(va,Ma){return pc.Inspector.openInWindow({remoteTarget:{code:va,evalEnvironment:Ma}})}function Yc(va,Ma){function jb(hc){var ic=hc.name,Qc=hc.ownerChain(),Pc=hc.owner,Nc=hc.world(),He;hc===Za&&(He=[eb]);Nc===hc&&(He=["$world"]);if(!He&&ic&&Pc){Pc===Nc&&1===pc.arr.count(pc.arr.pluck(Nc.submorphs,"name"),ic)&&(He=['$world.get("'+ic+'")']);if(!He&&Pc!=Nc)for(Nc=
Qc.length-1;Nc--;)if(1===Qc[Nc].getAllNamed(ic).length){He=[].concat($jscomp.arrayFromIterable(jb(Qc[Nc])),['get("'+ic+'")']);break}He||(ic=[].concat($jscomp.arrayFromIterable(jb(Pc)),['get("'+ic+'")']),pc.syncEval(ic.join("."),{context:Za}).value===hc&&(He=ic))}He||(He=[eb+'.getMorphById("'+hc.id+'")']);return He}Ma=void 0===Ma?{}:Ma;var R=va.world(),wa=Ma;Ma=void 0===wa.maxLength?10:wa.maxLength;var Za=void 0===wa.fromMorph?R:wa.fromMorph;if(Za===va)return"this";var eb=R===Za?"$world":"this";if(!(R||
va.name&&Za.get(va.name)===va))return"morph";R=jb(va);return R.length>Ma?'$world.getMorphWithId("'+va.id+'")':R.join(".")}function ub(va,Ma,jb){var R=(Ma=void 0===Ma?"":Ma)&&re.arr.last(Ma.split(".")).toLowerCase(),wa="",Za=0,eb=Math.pow(2,19);if("string"===typeof va){if(va.length>eb)return null}else if(va.document.stringSize>eb)return null;if("string"===typeof va)wa=va.slice(0,1E3);else for(va=$jscomp.makeIterator(va.document.lines),eb=va.next();!eb.done;eb=va.next()){var hc=eb.value;eb=hc.stringSize;
hc=hc.text;var ic=!0;1E3<Za+eb&&(ic=!1,eb=1E3-Za);wa+=hc.slice(0,eb)+(ic?"\n":"");Za+=eb;if(1E3<=Za)break}Za=$jscomp.makeIterator(re.modeInfo);for(va=Za.next();!va.done;va=Za.next()){ic=va.value;eb=ic.contentTest;va=ic.mode;hc=ic.ext;ic=ic.file;if("function"===typeof eb)try{if(eb(wa))return va}catch(Qc){}if(ic&&ic instanceof RegExp&&ic.test(Ma))return va;if(hc)for(eb=$jscomp.makeIterator(hc),hc=eb.next();!hc.done;hc=eb.next())if(hc.value===R)return va}return jb}ta({a:Kc,d:Pb,r:zc});var ja=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");
ja.Color=lb;var oa=function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),jb=Ma.hasOwnProperty("DefaultTheme")&&"function"===typeof Ma.DefaultTheme?Ma.DefaultTheme:Ma.DefaultTheme=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:"background",get:function(){return ja.Color.white}},{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",
fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},
{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},
{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},
{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},
{key:"diff-file-header",get:function(){return{fontColor:ja.Color.white,fontWeight:"bold",backgroundColor:ja.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:ja.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:ja.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ma,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2867})}(void 0),tb=oa=ja.DefaultTheme;ja.default=oa;var H=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");
H.copyState=ya;H.startState=Gb;H.defineMode=Pb;H.resolveMode=Ca;H.getMode=Yb;H.innerMode=jd;H.defineMIME=Kc;H.registerHelper=zc;H.indentLines=Ha;H.indentLine=function(va,Ma,jb,R,wa,Za,eb){eb=Object.assign({indentWithTabs:!va.useSoftTabs,indentUnit:va.tabWidth,tabSize:4,ignoreFollowingText:!1},eb);null==wa&&(wa="add");"smart"==wa&&(Ma.indent||(wa="prev"));var hc=eb.tabSize,ic=jb.text,Qc=H.countColumn(ic,null,hc);jb.modeState&&(jb.modeState=null);var Pc=ic.match(/^\s*/)[0];if(!Za&&!/\S/.test(ic)){var Nc=
0;wa="not"}else if("smart"==wa&&(Nc=Ma.indent(R,eb.ignoreFollowingText?"":ic.slice(Pc.length),ic),Nc==H.passIndent||150<Nc)){if(!Za)return;wa="prev"}"prev"==wa?Nc=0<jb.row?H.countColumn(jb.prevLine().text,null,hc):0:"add"==wa?Nc=Qc+eb.indentUnit:"subtract"==wa?Nc=Qc-eb.indentUnit:"number"==typeof wa&&(Nc=Qc+wa);Nc=Math.max(0,Nc);Ma="";R=0;if(eb.indentWithTabs)for(eb=Math.floor(Nc/hc);eb;--eb)R+=hc,Ma+="\t";R<Nc&&(Ma+=" ".repeat(Nc-R));if(Ma!=Pc)return va.replace({start:{row:jb.row,column:0},end:{row:jb.row,
column:Pc.length}},Ma),!0};H.tokenizeLines=function(va,Ma,jb,R,wa){if(Ma.length){jb=jb?H.copyState(va,jb):H.startState(va);for(var Za=0;Za<Ma.length;Za++){var eb=Ma[Za];R(eb);jb=H.tokenizeLine(va,eb,jb,wa)}}};H.tokenizeLine=function(va,Ma,jb,R){var wa=Ma.text;if(!wa)return jb;var Za=new H.StringStream(wa,2);jb=Ma.modeState="function"===typeof va.copyState?va.copyState(jb):H.copyState(va,jb);Ma.prevLine();for(jb._string=wa;!Za.eol();)wa=va.token(Za,jb),R(wa,jb,Za.start,Za.pos,Za,Ma,va),Za.start=Za.pos;
return jb};H.printTokens=function(va){for(var Ma="",jb=0;jb<va.length;jb+=5)Ma+=va[jb+0]+" => "+va[jb+1]+" "+va[jb+2]+" "+va[jb+3]+" "+va[jb+4].name+"\n";return Ma};H.visitDocumentTokens=Ec;H.tokenizeDocument=Wa;H.linesToTokenize=function(va,Ma,jb,R){if(R&&R.row>=jb)return{lines:[],state:null};Ma=R?Math.max(0,R.row-1):Ma;var wa=va.getLine(Ma),Za=wa.text;va=[wa];R=null;for(var eb=0,hc;(hc=wa.prevLine())&&50>eb++;){wa=hc;if(wa.modeState){R=wa.modeState;break}va.unshift(wa)}if(!R){for(var ic=wa,Qc=Infinity;(hc=
wa.prevLine())&&100>eb++;){wa=hc;if(wa.modeState){R=wa.modeState;break}va.unshift(wa);hc=Za.match(/^\s*/)[0].length;if(0===hc)break;hc<Qc&&(Qc=hc,ic=wa)}!R&&0<Qc&&(va=va.slice(va.indexOf(ic)))}if(jb>Ma)for(wa=H.arr.last(va);Ma<=jb;Ma++){wa=wa.nextLine();if(!wa)break;va.push(wa)}return{lines:va,state:R}};H.countColumn=cd;H.findModeByMIME=Na;H.findModeByExtension=bb;H.findModeByFileName=db;H.findModeByName=Sc;H.arr=Qb;oa=H.modes||{};H.modes=oa;H.modes=oa;H.modes=oa;oa=ta("p",{});H.passIndent=oa;H.passIndent=
oa;H.passIndent=oa;H.copyState=ya;H.copyState=ya;H.startState=Gb;H.startState=Gb;H.defineMode=Pb;H.defineMode=Pb;H.resolveMode=Ca;H.resolveMode=Ca;H.getMode=Yb;H.getMode=Yb;H.innerMode=jd;H.innerMode=jd;oa={};H.mimeModes=oa;H.mimeModes=oa;H.mimeModes=oa;H.defineMIME=Kc;H.defineMIME=Kc;H.registerHelper=zc;H.registerHelper=zc;H.indentLines=Ha;H.indentLines=Ha;H.visitDocumentTokens=Ec;H.visitDocumentTokens=Ec;H.tokenizeDocument=Wa;H.tokenizeDocument=Wa;H.countColumn=cd;H.countColumn=cd;(function(va){var Ma=
lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),jb=Ma.hasOwnProperty("StringStream")&&"function"===typeof Ma.StringStream?Ma.StringStream:Ma.StringStream=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(R,wa){this.reset(R,wa)}},{key:"reset",value:function(R,wa){this.pos=this.start=0;this.string=void 0===R?"":R;this.tabSize=void 0===
wa?2:wa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(R){var wa=this.string.charAt(this.pos);if("string"==typeof R?wa==R:wa&&(R.test?R.test(wa):R(wa)))return++this.pos,
wa}},{key:"eatWhile",value:function(R){for(var wa=this.pos;this.eat(R););return this.pos>wa}},{key:"eatSpace",value:function(){for(var R=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>R}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(R){R=this.string.indexOf(R,this.pos);if(-1<R)return this.pos=R,!0}},{key:"backUp",value:function(R){this.pos-=R}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=
H.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?H.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return H.countColumn(this.string,null,this.tabSize)-(this.lineStart?H.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(R,wa,Za){if("string"==typeof R){var eb=function(ic){return Za?ic.toLowerCase():ic},
hc=this.string.substr(this.pos,R.length);if(eb(hc)==eb(R))return!1!==wa&&(this.pos+=R.length),!0}else{if((R=this.string.slice(this.pos).match(R))&&0<R.index)return null;R&&!1!==wa&&(this.pos+=R[0].length);return R}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(R,wa){this.lineStart+=R;try{return wa()}finally{this.lineStart-=R}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],Ma,{pathInPackage:function(){return"editor-modes.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);oa=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",
mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj",
"cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",
mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff",
"patch"],contentTest:function(va){return va.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},
{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth",
"fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy",
"gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",
ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],
mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",
mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",
mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",
mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},
{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",
mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",
mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash",
"sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(va){return va.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},
{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",
mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",
mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",
mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml",
"text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",
mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];H.modeInfo=oa;H.modeInfo=oa;H.modeInfo=oa;for(var la=0;la<H.modeInfo.length;la++)H.info=H.modeInfo[la],H.info.mimes&&(H.info.mime=H.info.mimes[0]);H.defineMode("null",function(){return{token:function(va){return va.skipToEnd()}}});H.defineMIME("text/plain","null");H.findModeByMIME=Na;H.findModeByMIME=Na;H.findModeByExtension=bb;H.findModeByExtension=bb;H.findModeByFileName=db;H.findModeByFileName=db;H.findModeByName=Sc;H.findModeByName=Sc;var Fa=
lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Fa.Color=lb;Fa.Rectangle=Kb;Fa.pt=yd;Fa.morph=Cc;Fa.ShadowObject=rd;Fa.StyleSheet=Fc;Fa.connect=Dc;Fa.arr=Qb;Fa.string=Rc;Fa.FilterableList=$c;Fa.Range=Hd;la=function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),jb=Ma.hasOwnProperty("Completer")&&"function"===typeof Ma.Completer?Ma.Completer:Ma.Completer=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return yb(jb,va,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],Ma,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:345,end:391})}(void 0);Fa.Completer=la;Fa.Completer=la;Fa.Completer=la;la=function(va){var Ma=
lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),jb=Ma.hasOwnProperty("WordCompleter")&&"function"===typeof Ma.WordCompleter?Ma.WordCompleter:Ma.WordCompleter=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:"compute",value:function(R,wa){var Za=[],eb=[],hc=R.document.lineStrings;R=R.cursorPosition.row;for(var ic=R-1;0<=ic;ic--)for(var Qc=$jscomp.makeIterator(hc[ic].split(/[^0-9a-z@_]+/i)),
Pc=Qc.next();!Pc.done;Pc=Qc.next())(Pc=Pc.value)&&!Za.includes(Pc)&&Pc!==wa&&(Za.push(Pc),eb.push({priority:1E3-(R-ic),completion:Pc}));for(ic=R+1;ic<hc.length;ic++)for(Qc=$jscomp.makeIterator(hc[ic].split(/[^0-9a-z_@]+/i)),Pc=Qc.next();!Pc.done;Pc=Qc.next())(Pc=Pc.value)&&!Za.includes(Pc)&&Pc!==wa&&(Za.push(Pc),eb.push({priority:1E3-(ic-R),completion:Pc}));return eb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Ma,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:400,end:1228})}(void 0);Fa.WordCompleter=la;Fa.WordCompleter=la;Fa.WordCompleter=la;la=[new Fa.WordCompleter];Fa.defaultCompleters=la;Fa.defaultCompleters=la;Fa.defaultCompleters=la;la=function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),jb=Ma.hasOwnProperty("CompletionController")&&
"function"===typeof Ma.CompletionController?Ma.CompletionController:Ma.CompletionController=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(R,wa){wa=void 0===wa?[]:wa;this.textMorph=R;this.completers=wa=R.pluginCollect("getCompleters",wa)}},{key:"computeCompletions",value:function(R){var wa=this,Za,eb,hc,ic,Qc,Pc,Nc,He,ie,df,lg,rh,Cg,Wh,wg,Zi;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mf){switch(Mf.nextAddress){case 1:Za=[],eb=$jscomp.makeIterator(wa.completers),hc=eb.next();case 2:if(hc.done){Mf.jumpTo(4);break}ic=hc.value;Mf.setCatchFinallyBlocks(5);Qc=Za;Pc=Qc.concat;return Mf.yield(ic.compute(wa.textMorph,R),7);case 7:Za=Pc.call(Qc,Mf.yieldResult);Mf.leaveTryBlock(3);break;case 5:Nc=Mf.enterCatchBlock(),console.warn("Error in completer "+ic+": "+(Nc.stack||Nc));case 3:hc=eb.next();Mf.jumpTo(2);break;case 4:He=new Map;
Za.forEach(function(Ei){var Gg=He.get(Ei.completion);Gg||(Gg=[],He.set(Ei.completion,Gg));Gg.push(Ei)});ie=[];df=$jscomp.makeIterator(He.values());for(lg=df.next();!lg.done;lg=df.next())rh=lg.value,ie.push(Fa.arr.last(Fa.arr.sortByKey(rh,"priority")));Cg=0;Wh=Fa.arr.sortByKey(ie,"priority").reverse();wg=Wh.length&&Wh[0].priority||0;Zi=Wh.map(function(Ei){Ei.highestPriority=wg;var Gg=Ei.completion.replace(/\n/g,""),ri=String((Ei.info||"").replace(/\n/g,""));Cg=Math.max(Cg,Gg.length+ri.length);return{isListItem:!0,
string:Gg,annotation:ri,value:Ei}});return Mf.return({items:Zi,maxCol:Cg})}})}},{key:"computeSortedCompletions",value:function(R,wa){wa=void 0===wa?!1:wa;var Za=this,eb,hc,ic;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qc){if(1==Qc.nextAddress)return eb={tokens:[R],lowercasedTokens:[R],input:R},Qc.yield(Za.computeCompletions(R),2);hc=Qc.yieldResult;ic=Fa.arr.sortBy(hc.items.filter(function(Pc){return Za.filterFunction(eb,Pc,wa)}),function(Pc){return Za.sortFunction(eb,Pc)});return Qc.return(ic)})}},
{key:"_printCompletions",value:function(R){var wa=this,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return eb.yield(wa.computeSortedCompletions(R),2);Za=eb.yieldResult.map(function(hc){return{completion:hc.value.completion,priority:hc.value.priority,maxP:hc.value.highestPriority,sortVal:hc._cache[R].sortVal,lev:JSON.stringify(hc._cache[R].levenshtein)}});return eb.return(Fa.string.printTable(lively.lang.grid.tableFromObjects(Za)))})}},{key:"prefix",value:function(){var R=
this.textMorph,wa=R.selection;return(wa.isEmpty()?R.getLine(wa.lead.row).slice(0,wa.lead.column):wa.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(R,wa,Za){Za=void 0===Za?!1:Za;wa._cache||(wa._cache={});var eb=R.tokens,hc=R.lowercasedTokens,ic=R.input;ic=wa._cache[ic]||(wa._cache[ic]={});if(ic.hasOwnProperty("filtered"))return ic.filtered;wa=wa.value.completion.replace(/\([^\)]*\)$/,"");var Qc=wa.toLowerCase();if(Za&&eb[0]&&!wa.startsWith(eb[0]))return ic.filtered=!1;if(hc.every(function(Nc){return Qc.includes(Nc)}))return!0;
var Pc=ic.levenshtein||(ic.levenshtein={});R=Za||3>=Fa.arr.sum(R.lowercasedTokens.map(function(Nc){return Pc[Nc]||(Pc[Nc]=Fa.string.levenshtein(Qc,Nc))}));return ic.filtered=R}},{key:"sortFunction",value:function(R,wa){wa._cache||(wa._cache={});var Za=wa._cache[R.input]||(wa._cache[R.input]={});if(Za.hasOwnProperty("sortVal"))return Za.sortVal;Za=wa._cache[R.input]={};var eb=wa.value;wa=eb.highestPriority;var hc=eb.completion;eb=eb.priority;hc=hc.replace(/\([^\)]*\)$/,"").toLowerCase();var ic=0;R.lowercasedTokens.forEach(function(Pc){hc.startsWith(Pc)?
ic+=12:3<=Pc.length&&hc.includes(Pc)&&(ic+=5)});wa=-((eb||(ic?wa:0))/Math.pow(10,String(wa).length-2))-ic;var Qc=Za.levenshtein||(Za.levenshtein={});R=Fa.arr.sum(R.lowercasedTokens.map(function(Pc){return Qc[Pc]||(Qc[Pc]=Fa.string.levenshtein(hc,Pc))}));ic&&(R/=2);return Za.sortVal=R+wa}},{key:"positionForMenu",value:function(){var R=this.textMorph,wa=R.charBoundsFromTextPosition(R.cursorPosition);return R.getGlobalTransform().transformRectToRect(wa).topLeft().addXY(-R.scroll.x,-R.scroll.y).addPt(Fa.pt(R.borderWidth+
4,R.borderWidth+4))}},{key:"completionListSpec",value:function(){var R=this,wa,Za,eb,hc,ic,Qc,Pc,Nc,He,ie,df,lg,rh,Cg,Wh,wg,Zi,Mf,Ei,Gg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ri){if(1==ri.nextAddress)return Za=wa=R.textMorph,eb=Za.fontSize,hc=Za.fontFamily,ic=R.positionForMenu(),Qc=R.prefix(),ri.yield(R.computeCompletions(Qc),2);Pc=ri.yieldResult;Nc=Pc.items;He=Pc.maxCol;ie=wa.env.fontMetric.sizeFor(hc,eb,"M");df=ie.width*He;lg=wa.document.getLine(0).height;rh=Math.max(120,df<
wa.width?df:wa.width);Cg=lg*Nc.length+lg+10;Wh=Math.max(70,Math.min(700,Cg));wg=ic.extent(Fa.pt(rh,Wh));if(Zi=wa.world())Mf=Zi.visibleBounds().insetBy(5),wg.bottom()>Mf.bottom()&&(Ei=wg.bottom()-Mf.bottom(),Ei>wg.height-50&&(Ei=wg.height-50),wg.height-=Ei),wg.right()>Mf.right()&&(Gg=wg.right()-Mf.right(),wg.width=120>wg.width-Gg?120:wg.width-Gg),Mf.containsRect(wg)||(wg=wg.withTopLeft(Mf.translateForInclusion(wg).topLeft())),wg=wg.translatedBy(Mf.insetBy(0).topLeft().negated());return ri.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:eb,position:wg.topLeft(),extent:wg.extent(),items:Nc,input:Qc,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:R.filterFunction,sortFunction:R.sortFunction})})}},{key:"removeMenuOnBlur",value:function(R){var wa=R.menu;setTimeout(function(){wa.withAllSubmorphsDetect(function(Za){return Za.isFocused()})?wa.inputMorph.focus():wa.remove()})}},{key:"openCompletionList",value:function(){var R=this,wa,Za,eb,hc,ic,Qc,Pc,Nc,He,ie;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(df){if(1==df.nextAddress)return wa=R.textMorph.selection.start,df.yield(R.completionListSpec(),2);if(3!=df.nextAddress)return Za=df.yieldResult,R.textMorph.pluginFind(function(lg){return lg.theme}),eb=new Fa.FilterableList(Za),hc=new Fa.Range({start:wa,end:R.textMorph.selection.start}),ic=R.textMorph.textInRange(hc),Qc=eb.inputMorph,Pc=eb.listMorph,Nc=Za.input,He=eb.addMorph({name:"prefix mask",fill:Fa.Color.transparent,bounds:Qc.textBounds()},
Qc),Pc.master=null,hc.isEmpty()||(R.textMorph.deleteText(hc),Qc.input=ic,Qc.gotoDocumentEnd()),Qc.fontColor=R.textMorph.fontColor,Fa.connect(Qc,"textString",He,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Qc}}),Fa.connect(eb,"accepted",R,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Nc}}),Fa.connect(eb,"accepted",eb,"remove"),Fa.connect(eb,"canceled",eb,"remove"),Fa.connect(eb,"remove",R.textMorph,"focus"),Fa.connect(eb.inputMorph,"onBlur",R,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:eb}}),ie=R.textMorph.world(),Pc.addStyleClass("hiddenScrollbar"),eb.paddingMorph.height=2,Qc.height=Pc.itemHeight,Qc.clipMode="visible",Qc.fill=R.textMorph.fill,Qc.fixedHeight=!0,Qc.fixedWidth=!1,Qc.fontSize=Pc.fontSize,eb.relayout(),eb.selectedIndex=
0,eb.master.applyIfNeeded(!0),df.yield(eb.master.whenApplied(),3);Nc.length&&(Qc.gotoDocumentEnd(),eb.moveBy(Fa.pt(-Qc.textBounds().width,0)));ie.addMorph(eb);Qc.focus();eb.inputPadding=Fa.Rectangle.inset(0,0,0,0);return df.return(eb)})}},{key:"autoInsertBestMatchingCompletion",value:function(R,wa,Za){wa=void 0===wa?!0:wa;var eb=this,hc,ic,Qc,Pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){if(1==Nc.nextAddress)return hc=$jscomp,ic=hc.makeIterator,Nc.yield(eb.computeSortedCompletions(R,
wa),2);Qc=ic.call(hc,Nc.yieldResult);(Pc=Qc.next().value)&&eb.insertCompletion(Pc.value.completion,R,Za);Nc.jumpToEnd()})}},{key:"insertCompletion",value:function(R,wa,Za){var eb=this.textMorph,hc=eb.document,ic=eb.selection.isMultiSelection?eb.selection.selections:[eb.selection];eb.undoManager.group();ic.forEach(function(Qc){Qc.collapseToEnd();var Pc=Qc.lead,Nc=wa?hc.indexToPosition(hc.positionToIndex(Pc)-wa.length):Pc;"function"===typeof Za?Za(R,wa,eb,{start:Nc,end:Pc},Qc):eb.replace({start:Nc,
end:Pc},R)});eb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],Ma,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1355,end:12762})}(void 0);Fa.CompletionController=la;Fa.CompletionController=la;Fa.CompletionController=la;
la=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(va,Ma,jb){var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){return 1==wa.nextAddress?(R=new Fa.CompletionController(va,Fa.defaultCompleters),wa.yield(R.openCompletionList(),2)):wa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(va,Ma,jb){var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){return 1==wa.nextAddress?(R=
new Fa.CompletionController(va,Fa.defaultCompleters),wa.yield(R.autoInsertBestMatchingCompletion(R.prefix()),2)):wa.return(!0)})}}];Fa.completionCommands=la;Fa.completionCommands=la;Fa.completionCommands=la;var kb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");kb.chain=gd;kb.arr=Qb;kb.obj=Uc;kb.string=Rc;var fc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(va){var Ma=va.selection.start;0<Ma.row&&(Ma=va.getPositionAboveOrBelow(1,Ma,
!0,0,va.charBoundsFromTextPosition(Ma).x),va.selection.addRange({start:Ma,end:Ma}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(va){var Ma=va.selection.start;Ma.row<va.documentEndPosition.row&&(Ma=va.getPositionAboveOrBelow(-1,Ma,!0,0,va.charBoundsFromTextPosition(Ma).x),va.selection.addRange({start:Ma,end:Ma}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(va){var Ma=va.selection.selections[va.selection.selections.length-
1];if(Ma.isEmpty())return!0;va.searchForAll(Ma.text,{start:{column:0,row:0}}).forEach(function(jb){return va.selection.addRange(jb.range,!1)});va.selection.mergeSelections();kb.arr.remove(va.selection.selections,Ma);va.selection.selections.push(Ma);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(va){var Ma=va.selection.selections.length-1,jb=va.selection.selections[Ma];if(jb.isEmpty())return!0;var R=va.search(jb.text,{start:jb.end,backwards:!1});R&&
(jb=va.selection.selections.findIndex(function(wa){return wa.range.equals(R.range)}),-1<jb?kb.arr.swap(va.selection.selections,jb,Ma):va.selection.addRange(R.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(va){var Ma=va.selection.selections.length-1,jb=va.selection.selections[Ma];if(jb.isEmpty())return!0;var R=jb.start,wa=va.search(jb.text,{start:{row:R.row,column:R.column-(jb.text.length-1)},backwards:!0});wa&&(jb=va.selection.selections.findIndex(function(Za){return Za.range.equals(wa.range)}),
-1<jb?kb.arr.swap(va.selection.selections,jb,Ma):va.selection.addRange(wa.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(va){var Ma=va.selection.selections.length;1<Ma&&va.selection.removeSelections(Ma-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(va){va.selection.selections=lively.lang.arr.rotate(va.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(va){va.selection.selections=lively.lang.arr.rotate(va.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(va){var Ma=va.selection.selections;if(1>=Ma.length)return!0;var jb=kb.arr.groupBy(Ma,function(wa){return wa.range.start.row});Ma=jb.keys().map(function(wa){wa=jb[wa];var Za=kb.arr.max(wa,function(eb){return eb.range.start.column});kb.arr.without(wa,Za).forEach(function(eb){return eb.range=Za.range});
return Za});var R=kb.arr.max(Ma,function(wa){return wa.range.start.column}).range.start.column;Ma.forEach(function(wa){var Za=wa.range.start;wa=Za.row;Za=Za.column;va.insertText(" ".repeat(R-Za),{row:wa,column:Za})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(va){va.selection.disableMultiSelect();if(va.selection.isEmpty())var Ma=va.lastSavedMark&&va.lastSavedMark.position||(void 0).lineRange().start,jb=va.cursorPosition;else Ma=va.selection,
jb=Ma.lead,Ma=Ma.anchor;va.selection.collapse();var R=Ma.column,wa=jb.column;kb.arr.range(Ma.row,jb.row).forEach(function(Za){return va.getLine(Za).length>Math.min(wa,R)&&va.selection.addRange({end:{row:Za,column:wa},start:{row:Za,column:R}},!1)});va.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(va,Ma,jb){jb=void 0===jb?1:jb;va.undoManager.group();va.selection.selections.forEach(function(R,wa){return R.text=String(wa+jb)});
va.undoManager.group();return!0}}];kb.multiSelectCommands=fc;kb.multiSelectCommands=fc;kb.multiSelectCommands=fc;var Bc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");Bc.pToI=function(va,Ma){return va.positionToIndex(Ma)};Bc.iToP=function(va,Ma){return va.indexToPosition(Ma)};Bc.execCodeNavigator=function(va){return function(Ma,jb,R){var wa=Ma.pluginInvokeFirst("getNavigator");if(!wa)return!0;Ma.saveMark();R=R||1;for(var Za=0;Za<R;Za++)wa[va](Ma,jb);return!0}};Bc.once=
Pa;var xd=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Bc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:Bc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Bc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Bc.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Bc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(va,Ma){function jb(){var Za=va.$expandRegionState,eb=Bc.pToI(va,va.cursorPosition);if(Za&&(Za.range[0]===eb||Za.range[1]===eb))return Za;Za=va.selection.range;return va.$expandRegionState={range:[Bc.pToI(va,Za.start),
Bc.pToI(va,Za.end)]}}Ma=Ma||{};var R=va.pluginInvokeFirst("getNavigator");if(!R)return!0;var wa=Ma.start;Ma=Ma.end;if("number"===typeof wa&&"number"===typeof Ma)jb(),R={range:[wa,Ma],prev:jb()};else{wa=R.ensureAST(va);if(!wa)return;R=R.expandRegion(va,va.textString,wa,jb())}R&&R.range&&(va.selection={start:Bc.iToP(va,R.range[0]),end:Bc.iToP(va,R.range[1])},va.$expandRegionState=R);Bc.once(va,"selectionChange",function(){return va.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(va){if(va.selection.isEmpty())return!0;var Ma=va.pluginInvokeFirst("getNavigator");if(!Ma)return!0;var jb=Ma.ensureAST(va);if(!jb)return!0;var R=va.$expandRegionState;if(!R)return!0;(Ma=Ma.contractRegion(va,va.textString,jb,R))&&Ma.range&&(va.selection={start:Bc.iToP(va,Ma.range[0]),end:Bc.iToP(va,Ma.range[1])},va.$expandRegionState=Ma);Bc.once(va,"selectionChange",
function(){return va.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Bc.commands=xd;Bc.commands=xd;Bc.commands=xd;var pd=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");pd.arr=Qb;pd.chain=gd;pd.string=Rc;var le=[{name:"toggle comment",exec:function(va){var Ma=va.pluginInvokeFirst("getComment");if(!Ma)return!0;if(!Ma.lineCommentStart)return Ma.blockCommentStart?va.execCommand("toggle block comment"):!0;var jb=Ma.lineCommentStart,R=
new RegExp("^(\\s*)("+jb+"\\s?)(.*)");Ma=va.document;var wa=va.selection;wa.isEmpty()||0!==wa.end.column||wa.growRight(-1);var Za=wa.start.row;Ma=Ma.lineStrings.slice(wa.start.row,wa.end.row+1);Ma=Ma.some(function(ic){return!!ic.trim()})?pd.arr.dropWhile(Ma,function(ic){return ic.trim()?!1:++Za&&!0}):Ma;var eb=Ma.every(function(ic){return ic.trim()&&ic.match(R)});va.undoManager.group();if(eb)Ma.forEach(function(ic,Qc){if(ic=ic.match(R)){ic=$jscomp.makeIterator(ic);ic.next();var Pc=ic.next().value,
Nc=ic.next().value;ic.next();va.deleteText({start:{row:Za+Qc,column:Pc.length},end:{row:Za+Qc,column:Pc.length+Nc.length}})}});else{var hc=Ma.reduce(function(ic,Qc,Pc){return Qc.trim()||wa.isEmpty()&&wa.start.row===wa.end.row?Math.min(ic,Qc.match(/^\s*/)[0].length):ic},Infinity);hc=Infinity===hc?0:hc;Ma.forEach(function(ic,Qc){ic=$jscomp.makeIterator(ic.match(/^(\s*)(.*)/));ic.next();ic.next();ic.next();va.insertText(jb+" ",{row:Za+Qc,column:hc})})}va.undoManager.group();return!0}},{name:"toggle block comment",
exec:function(va){var Ma=va.pluginInvokeFirst("getComment");if(!Ma)return!0;if(!Ma.blockCommentStart)return Ma.lineCommentStart?va.execCommand("toggle comment"):!0;if(!Ma||!Ma.blockCommentStart)return!0;var jb=Ma.blockCommentStart;Ma=Ma.blockCommentEnd;var R=new RegExp("^"+jb.replace(/\*/g,"\\*")),wa=new RegExp(Ma.replace(/\*/g,"\\*")+"$"),Za=va.tokenAt(va.cursorPosition);if(Za&&"comment"===Za.token){var eb=va.textInRange(Za);if(eb.match(R)&&eb.match(wa))return va.undoManager.group(),va.replace(Za,
eb.slice(jb.length,-Ma.length)),va.undoManager.group(),!0}va.undoManager.group();va.insertText(jb,va.selection.start);va.insertText(Ma,va.selection.end);va.undoManager.group();jb=!va.selection.isEmpty();va.selection.growLeft(Ma.length);jb||va.selection.collapse();return!0}},{name:"comment box",exec:function(va,Ma,jb){Ma=va.undoManager.ensureNewGroup(va,"comment box");if(va.selection.isEmpty())return va.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),va.execCommand("toggle comment"),
va.undoManager.group(Ma),!0;var R=va.selection.range,wa=va.withSelectedLinesDo(function(eb){return eb}),Za=pd.arr.min([R.start.column].concat(pd.chain(wa).map(function(eb){return eb.match(/^\s*/)}).flatten().compact().pluck("length").value()));wa=pd.arr.max(wa.map(function(eb){return eb.length}))-Za;wa=Array(Math.ceil(wa/2)+1).join("-=")+"-";va.execCommand("toggle comment");va.collapseSelection();va.cursorPosition={row:R.start.row,column:0};jb?va.insertText(pd.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",Za)):va.insertText(pd.string.indent(wa+"\n"," ",Za));va.selection.goUp();va.execCommand("toggle comment");va.cursorPosition={row:R.end.row+2,column:0};va.insertText(pd.string.indent(wa+"\n"," ",Za));va.selection.goUp();va.execCommand("toggle comment");va.selection.range={start:{row:R.start.row,column:0},end:va.cursorPosition};va.undoManager.group(Ma);return!0},multiSelectAction:"forEach",handlesCount:!0}];pd.commands=le;pd.commands=le;pd.commands=le;var nd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
nd.printSymbol=function(va){if(Symbol.keyFor(va))return'Symbol.for("'+Symbol.keyFor(va)+'")';if(nd.knownSymbols.get(va))return nd.knownSymbols.get(va);String(va).match(nd.symMatcher);return String(va)};nd.defaultSort=function(va,Ma){if(va.hasOwnProperty("priority")||Ma.hasOwnProperty("priority")){var jb=va.priority||0,R=Ma.priority||0;if(jb<R)return-1;if(jb>R)return 1}va=(va.keyString||va.key).toLowerCase();Ma=(Ma.keyString||Ma.key).toLowerCase();return va<Ma?-1:va===Ma?0:1};nd.safeToString=Fd;nd.propertyNamesOf=
function(va,Ma){if(!va)return[];if(Array.isArray(va)){var jb=Ma?Ma.offset:0;return nd.arr.range(jb,jb+(Ma?Ma.partitionSize:va.length-1))}return nd.arr.sortBy(Object.keys(va),function(R){return R.toLowerCase()})};nd.isMultiValue=Pd;nd.printValue=ae;nd.partitionedChildren=function(va,Ma){var jb=void 0===Ma?{}:Ma;Ma=void 0===jb.originalValue?va:jb.originalValue;var R=void 0===jb.offset?0:jb.offset;jb=void 0===jb.partitionSize?va.length||Object.values(va).length:jb.partitionSize;if(nd.obj.isArray(va)){va=
nd.num.roundTo(Math.max(nd.MIN_PARTITION_SIZE,jb/50),.1);jb/=va;for(var wa=[],Za=0;Za<jb;Za++){var eb="["+(R+Za*va)+"-"+(R+(Za+1)*va)+"]";wa.push({partition:{originalValue:Ma,offset:R+Za*va,partitionSize:va},value:[],key:eb,keyString:eb,valueString:"...",isCollapsed:!0})}return wa}va=nd.num.roundTo(Math.max(nd.MIN_PARTITION_SIZE,jb/50),.1);jb/=va;wa=[];Za=nd.obj.keys(Ma).sort();for(eb=0;eb<jb;eb++){var hc=R+eb*va,ic=R+(eb+1)*va,Qc=nd.obj.select(Ma,Za.slice(hc,ic));hc="["+Za[hc].slice(0,4)+"-"+(Za[ic]||
nd.arr.last(Za)).slice(0,4)+"]";wa.push({partition:{originalValue:Qc,offset:R+eb*va,partitionSize:va},value:[],key:hc,keyString:hc,valueString:"...",isCollapsed:!0})}return wa};nd.propertiesOf=function(va){var Ma=va.partition?va.target:va.value;if(!Ma)return[];var jb={_rev:!0},R=[],wa="function"===typeof Ma.livelyCustomInspect?Ma.livelyCustomInspect():{},Za=Object.assign({},nd.defaultPropertyOptions,{},wa);if(wa.properties){wa=$jscomp.makeIterator(wa.properties);for(var eb=wa.next();!eb.done;eb=wa.next()){var hc=
eb.value;eb=hc.key;var ic=hc.hidden,Qc=hc.priority,Pc=hc.keyString,Nc=hc.value;hc=hc.valueString;jb[eb]=!0;ic||R.push(va.getSubNode({priority:Qc,key:eb,keyString:Pc||nd.safeToString(eb),value:Nc,valueString:hc,isCollapsed:!0}))}}if(Za.includeDefault){wa=nd.propertyNamesOf(Ma,va.partition);if(wa.length>nd.MAX_NODE_THRESHOLD)for(jb=$jscomp.makeIterator(nd.partitionedChildren(Ma,va.partition)),wa=jb.next();!wa.done;wa=jb.next())R.push(va.getSubNode(wa.value));else for(ic=$jscomp.makeIterator(wa),wa=
ic.next();!wa.done;wa=ic.next())Qc=wa.value,Qc in jb||(wa=Ma[Qc],eb=nd.printValue(wa),wa={keyString:Qc,key:Qc,value:wa,valueString:eb,isCollapsed:!0},R.push(va.getSubNode(wa)));if(Za.includeSymbols)for(jb=$jscomp.makeIterator(Object.getOwnPropertySymbols(Ma)),wa=jb.next();!wa.done;wa=jb.next())ic=wa.value,Qc=nd.safeToString(ic),wa=Ma[ic],eb=nd.printValue(wa),wa={key:ic,keyString:Qc,value:wa,valueString:eb,isCollapsed:!0},R.push(va.getSubNode(wa))}Za.sort&&(R=Za.sortFunction(Ma,R));return R};nd.obj=
Uc;nd.num=mb;nd.arr=Qb;nd.string=Rc;nd.connect=Dc;nd.signal=Nb;nd.TreeData=Ub;nd.newUUID=Ic;nd.localInterface=ra;nd.MAX_NODE_THRESHOLD=1E3;nd.MIN_PARTITION_SIZE=250;nd.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(va,Ma){return Array.isArray(va)?Ma:Ma.sort(nd.defaultSort)}};nd.symMatcher=/^Symbol\((.*)\)$/;nd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(va){return"symbol"===typeof Symbol[va]}).reduce(function(va,Ma){return va.set(Symbol[Ma],
"Symbol."+Ma)},new Map)}();nd.isMultiValue=Pd;nd.isMultiValue=Pd;nd.printValue=ae;nd.printValue=ae;var Rd=function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),jb=Ma.hasOwnProperty("InspectionTree")&&"function"===typeof Ma.InspectionTree?Ma.InspectionTree:Ma.InspectionTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:Symbol.for("lively-instance-initialize"),
value:function(R){yb._get(Object.getPrototypeOf(jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);this.inspector=R.inspector;this.root.isInspectionNode||(this.root=nd.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(R){R=void 0===R?!0:R;return yb._get(Object.getPrototypeOf(jb.prototype),"asListWithIndexAndDepth",this).call(this,function(wa){wa=wa.node;return R?wa.visible:!0})}},{key:"getContextFor",
value:function(R){return R==this.root?this.root.value.inspectee:R.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(R){var wa=void 0===R.maxDepth?1:R.maxDepth,Za=R.iterator,eb=R.showUnknown,hc=R.showInternal,ic=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qc){if(1==Qc.nextAddress)return Qc.yield(ic.uncollapseAll(function(Pc,Nc){return wa>Nc&&(Pc==ic.root||Pc.value.submorphs)}),2);ic.asListWithIndexAndDepth(!1).forEach(function(Pc){var Nc=Pc.node;return 0==
Pc.depth?Nc.visible=!0:!eb&&Nc.keyString&&Nc.keyString.includes("UNKNOWN PROPERTY")||!hc&&Nc.keyString&&Nc.keyString.includes("internal")?Nc.visible=!1:Nc.value&&Nc.value.submorphs?Nc.visible=!0:Nc.visible=Za(Nc)});Qc.jumpToEnd()})}},{key:"getChildren",value:function(R){return R.children}},{key:"display",value:function(R){return R.display(this.inspector)}},{key:"isCollapsed",value:function(R){return R.isCollapsed}},{key:"isLeaf",value:function(R){return nd.obj.isPrimitive(R.value)}},{key:"collapse",
value:function(R,wa){var Za=this;R.isCollapsed=wa;wa||this.isLeaf(R)||R.children.length||(R.children=nd.propertiesOf(R).map(function(eb){Za.parentMap.set(eb,R);return eb}))}},{key:"retrieveForRemoteProxy",value:function(R){R.uuid||(R.uuid=nd.newUUID(),this.idToNodeMap[R.uuid]=R);return{uuid:R.uuid,value:this.isLeaf(R)?R.value:{},keyString:R.keyString,key:R.keyString,valueString:nd.safeToString(R.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return nd.localInterface}},
{key:"getNodeViaId",value:function(R){return this.idToNodeMap[R]}},{key:"asRemoteDelegate",value:function(R){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[R]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionTree"}},{key:"forObject",value:function(R,wa){return new this({key:"inspectee",
value:{inspectee:R},isCollapsed:!0,inspector:wa})}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5932,end:8631})}(nd.TreeData);nd.InspectionTree=Rd;nd.InspectionTree=Rd;nd.InspectionTree=Rd;var be=function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
jb=Ma.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Ma.RemoteInspectionTree?Ma.RemoteInspectionTree:Ma.RemoteInspectionTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(R){this.parentMap=new WeakMap;this.root=R.proxy;this.evalEnvironment=R.evalEnvironment;
this.inspector=R.inspector;this.delegateId=R.delegateId}},{key:"getContextFor",value:function(R){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+R.uuid+'").value'}},{key:"dispose",value:function(){var R=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){return wa.yield(R.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+R.delegateId+"']\n    ",R.evalEnvironment),0)})}},{key:"display",
value:function(R){return R.keyString+": "+R.valueString}},{key:"collapse",value:function(R,wa){var Za=this,eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(hc){if(1==hc.nextAddress)return(R.isCollapsed=wa)||Za.isLeaf(R)?hc.return():R.children.length?hc.jumpTo(0):hc.yield(Za.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+R.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Za.delegateId+'"]'}),3);eb=hc.yieldResult;R.children=eb.isError?[]:eb.value;hc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(R,wa){var Za=this,eb,hc,ic,Qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){if(1==Pc.nextAddress)return Pc.yield(Za.createRemoteContext(R,wa),2);eb=Pc.yieldResult;
hc=eb.proxy;ic=eb.delegateId;Qc=eb.evalEnvironment;return Pc.return(new Za({key:"inspectee",proxy:hc,delegateId:ic,evalEnvironment:Qc,inspector:wa}))})}},{key:"createRemoteContext",value:function(R,wa){var Za=R.code,eb=R.evalEnvironment,hc=R.delegateId,ic,Qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){if(1==Pc.nextAddress)return hc="lively://inspector-"+wa.id,Pc.yield(eb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Za+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+hc+'");\n    ',eb),2);ic=Pc.yieldResult;Qc=ic.value;return Pc.return({delegateId:hc,evalEnvironment:eb,proxy:Qc})})}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8640,end:10983})}(nd.InspectionTree);
nd.RemoteInspectionTree=be;nd.RemoteInspectionTree=be;nd.RemoteInspectionTree=be;(function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),jb=Ma.hasOwnProperty("InspectionNode")&&"function"===typeof Ma.InspectionNode?Ma.InspectionNode:Ma.InspectionNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(R){var wa=
R.root,Za=R.priority,eb=R.key,hc=R.keyString,ic=R.value,Qc=R.valueString,Pc=R.isCollapsed,Nc=void 0===R.children?[]:R.children,He=void 0===R.isSelected?!1:R.isSelected,ie=void 0===R.visible?!0:R.visible;this.partition=R.partition;this.priority=Za;this.key=eb;this.keyString=String(hc||eb);this.value=ic;this.valueString=Qc||nd.printValue(ic);this.isCollapsed=Pc;this.children=Nc;this.isSelected=He;this.visible=ie;this.root=wa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(R){if(R.value&&R.value.isMorph)return new nd.MorphNode(Object.assign({root:this.root},R));var wa=R.key,Za=R.keyString,eb=this.value,hc=R.partition;hc&&(eb=hc.originalValue,Za=wa);return new nd.PropertyNode(Object.assign({},R,{keyString:Za,key:wa,target:eb,partition:hc,root:this.root,spec:{}}))}},{key:"display",value:function(R){var wa=this.keyString,Za=this.valueString;if(!this.interactive)return wa+": "+Za;this._propertyWidget||(this._propertyWidget=
R.renderDraggableTreeLabel({value:wa+": "+Za}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(R,wa){wa=void 0===wa?null:wa;return R.value&&R.value.isMorph?new nd.MorphNode(Object.assign({root:wa},R)):new nd.InspectionNode(Object.assign({root:wa},R))}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10985,end:13522})})(void 0);(function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),jb=Ma.hasOwnProperty("MorphNode")&&"function"===typeof Ma.MorphNode?Ma.MorphNode:Ma.MorphNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:Symbol.for("lively-instance-initialize"),
value:function(R){yb._get(Object.getPrototypeOf(jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(R){var wa=this.propertyInfo[R.key]||{};return R.value&&R.value.isMorph?new nd.MorphNode(Object.assign({},R,{root:this.root})):new nd.PropertyNode(Object.assign({},R,{root:this.root,target:this.target,spec:wa}))}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"MorphNode"}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13524,end:14670})})(nd.InspectionNode);(function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),jb=Ma.hasOwnProperty("PropertyNode")&&"function"===typeof Ma.PropertyNode?
Ma.PropertyNode:Ma.PropertyNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(R){yb._get(Object.getPrototypeOf(jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);var wa=R.spec,Za=R.target;this.partition=R.partition;this.target=Za;this.spec=wa;this.foldedNodes={}}},{key:"__deserialize__",value:function(R,wa){this.spec=
{}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(R){this._interactive=R}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(R){return this.isFoldable?this.getFoldedContext(R):yb._get(Object.getPrototypeOf(jb.prototype),"getSubNode",this).call(this,R)}},{key:"getFoldedContext",value:function(R){return this.foldedNodes[R.key]=
new nd.FoldedNode(Object.assign({},R,{root:this.root,target:this.target,foldableNode:this,spec:nd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(R,wa){(wa=void 0===wa?!1:wa)&&(this.target[this.key]=R);this.value=this.target[this.key];this.valueString=nd.printValue(this.value);this.interactive&&(wa||this._propertyWidget.highlight());if(this.isFoldable)for(var Za in this.foldedNodes)this.foldedNodes[Za].value=
this.value[Za],this.foldedNodes[Za].valueString=nd.printValue(this.value[Za]),this.foldedNodes[Za]._propertyWidget&&nd.signal(this.foldedNodes[Za]._propertyWidget,"update",this.value[Za])}},{key:"display",value:function(R){var wa=this,Za=this._propertyWidget,eb=this.keyString,hc=this.valueString,ic=this.target,Qc=this.value,Pc=this.spec;if(!(this.interactive||Pc.foldable&&nd.isMultiValue(Qc,Pc.foldable)))return R.renderPropertyControl({target:ic,keyString:eb,valueString:hc,tree:R.ui.propertyTree,
value:Qc,spec:Pc,node:this,fastRender:!0});if(Za)return Za.keyString=eb,Za.valueString=hc,Za.isSelected=this.isSelected,Za.control&&(Za.control.isSelected=this.isSelected),Za;Za=this._propertyWidget=R.renderPropertyControl({target:ic,keyString:eb,valueString:hc,value:Qc,spec:Pc,node:this,isSelected:this.isSelected,fontColor:R.ui.propertyTree.fontColor});this.isInternalProperty||Pc.readOnly||(nd.connect(Za,"propertyValue",this,"refreshProperty",{updater:function(Nc,He){return Nc(He,!0)}}),nd.connect(Za,
"openWidget",this.root,"onWidgetOpened",{converter:function(Nc){return{widget:Nc,node:wa.sourceObj}}}));return Za}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14672,end:18071})})(nd.InspectionNode);
(function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),jb=Ma.hasOwnProperty("FoldedNode")&&"function"===typeof Ma.FoldedNode?Ma.FoldedNode:Ma.FoldedNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(R){yb._get(Object.getPrototypeOf(jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
R);this.foldableNode=R=R.foldableNode;this.foldedProp=R.key+nd.string.capitalize(this.key)}},{key:"refreshProperty",value:function(R,wa){wa=void 0===wa?!1:wa;var Za={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Za[this.key]=R,Za)),wa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18073,end:18749})})(nd.PropertyNode);var Ce=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Ce.Color=lb;var hf=function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),jb=Ma.hasOwnProperty("DarkTheme")&&"function"===typeof Ma.DarkTheme?Ma.DarkTheme:Ma.DarkTheme=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return yb(jb,va,[{key:"background",get:function(){return Ce.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Ce.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Ce.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Ce.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Ce.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Ce.Color.white,fontWeight:"bold",backgroundColor:Ce.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Ce.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Ce.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],Ma,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3048})}(void 0),Le=hf=Ce.DarkTheme;Ce.default=hf;var pc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");pc.inspect=tc;pc.remoteInspect=Kd;pc.generateReferenceExpression=Yc;pc.onNumberDragStart=
function(va,Ma){Ma.initPos=va.position;Ma.factorLabel=(new pc.Tooltip({description:"1x"})).openInWorld(va.hand.position.addXY(10,10))};pc.onNumberDrag=function(va,Ma){var jb=pc.getScaleAndOffset(va,Ma),R=jb.scale;jb=jb.offset;Ma.factorLabel.position=va.hand.position.addXY(10,10);Ma.factorLabel.description=R+"x";return pc.getCurrentValue(jb,R,Ma)};pc.onNumberDragEnd=function(va,Ma){var jb=pc.getScaleAndOffset(va,Ma);va=jb.offset;jb=jb.scale;Ma.factorLabel.softRemove();return pc.getCurrentValue(va,
jb,Ma)};pc.getScaleAndOffset=function(va,Ma){var jb=va.position.subPt(Ma.initPos);va=jb.x;Ma=pc.num.roundTo(Math.exp(-jb.y/$world.height*6),.01)*Ma.baseFactor;return{offset:va,scale:Ma}};pc.getCurrentValue=function(va,Ma,jb){return Math.max(jb.min,Math.min(jb.max,jb.scrubbedValue+(jb.floatingPoint?va*Ma:Math.round(va*Ma))))};pc.Color=lb;pc.Rectangle=Kb;pc.rect=wd;pc.pt=yd;pc.obj=Uc;pc.num=mb;pc.Path=Eb;pc.arr=Qb;pc.promise=Sb;pc.connect=Dc;pc.disconnect=sb;pc.once=Pa;pc.Morph=ec;pc.Tooltip=rc;pc.VerticalLayout=
yc;pc.GridLayout=Db;pc.HorizontalLayout=ab;pc.morph=Cc;pc.CustomLayout=Zb;pc.Label=kc;pc.Icon=ua;pc.StyleSheet=Fc;pc.config=Ga;pc.Tree=cb;pc.LoadingIndicator=rb;pc.DropDownList=pb;pc.DropDownSelector=Ta;pc.SearchField=Ua;pc.LabeledCheckBox=ob;pc.MorphHighlighter=Lb;pc.InteractiveMorphSelector=qc;pc.printValue=ae;pc.RemoteInspectionTree=be;pc.InspectionTree=Rd;pc.isMultiValue=Pd;pc.valueWidgets=I;pc.popovers=V;pc.DarkTheme=Le;pc.DefaultTheme=tb;pc.syncEval=Wb;pc.inspectorCommands=[{name:"focus codeEditor",
exec:function(va){va.get("codeEditor").show();va.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(va){va.get("propertyTree").show();va.get("propertyTree").focus();return!0}}];(function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),jb=Ma.hasOwnProperty("DraggedProp")&&"function"===typeof Ma.DraggedProp?Ma.DraggedProp:Ma.DraggedProp=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return yb(jb,va,[{key:"applyToTarget",value:function(R){var wa=this.currentTarget,Za=this.control;this.remove();pc.MorphHighlighter.removeHighlighters(R.world);if(wa)if(wa.isText&&"js"===wa.editorModeName){var eb=wa.evalEnvironment.context;R=wa.textPositionFromPoint(wa.localize(R.position));eb=pc.generateReferenceExpression(this.sourceObject,{fromMorph:eb});Za.keyString&&(eb+="."+Za.keyString);wa.insertTextAndSelect(eb,R);wa.focus()}else"propertyValue"in Za&&(wa[Za.keyString]=Za.propertyValue)}},
{key:"update",value:function(R){R=R.hand.globalPosition;var wa=this.morphBeneath(R),Za;if(wa){for(wa==this.morphHighlighter&&(wa=wa.morphBeneath(R));Za=[wa].concat($jscomp.arrayFromIterable(wa.ownerChain())).find(function(eb){return!eb.visible});)wa=Za=Za.morphBeneath(R);if(wa!=this.currentTarget){this.currentTarget=wa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(wa.isWorld)return;this.morphHighlighter=pc.MorphHighlighter.for($world,wa);this.morphHighlighter.show()}this.position=R}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:pc.Color.rgb(169,204,227)},fill:{defaultValue:pc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var R=this.control;if(!R)return this.submorphs=[];this.height=22;this.submorphs=[R];R.top=0;R.fontSize=14;"function"===typeof R.relayout&&
R.relayout();this.width=R.width+20;this.adjustOrigin(pc.pt(10,10))}}}}}],Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1268,end:3690})})(pc.Morph);(function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),jb=Ma.hasOwnProperty("DraggableTreeLabel")&&"function"===
typeof Ma.DraggableTreeLabel?Ma.DraggableTreeLabel:Ma.DraggableTreeLabel=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(R){this.draggedProp=new pc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();pc.connect(R.hand,"update",this.draggedProp,"update")}},{key:"onDrag",
value:function(R){}},{key:"onDragEnd",value:function(R){pc.disconnect(R.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(R)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:pc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:pc.Color.transparent},
padding:{defaultValue:pc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(R){this.setProperty("isSelected",R);R?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=R)}}}}}],Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3692,end:5015})})(pc.Label);Rd=function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),jb=Ma.hasOwnProperty("PropertyControl")&&"function"===typeof Ma.PropertyControl?Ma.PropertyControl:Ma.PropertyControl=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(R,wa,Za){R.control=new pc.DropDownSelector({opacity:.8,fill:pc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:wa,padding:0,values:Za});pc.connect(R.control,"update",R,"propertyValue",{updater:function(eb,hc){this.targetObj.propertyValue!=hc&&eb(hc)}});pc.connect(R,"update",R.control,"selectedValue",{updater:function(eb,hc){hc=hc&&hc.valueOf?hc.valueOf():hc;this.targetObj.propertyValue!=hc&&eb(hc)}});return R}},{key:"toggleMultiValuePlaceholder",
value:function(R){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:pc.Color.transparent,layout:new pc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:pc.arr.range(0,2).map(function(wa){return{type:"ellipse",fill:pc.Color.gray.withA(.5),reactsToPointer:!1,extent:pc.pt(7,7)}})});R?(pc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=
0,this.multiValuePlaceholder.visible=!0):(pc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(R){this.foldableProperties&&this.toggleMultiValuePlaceholder(pc.isMultiValue(R,this.foldableProperties))}},{key:"asFoldable",value:function(R){this.foldableProperties=R;pc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&
(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var R=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});R.isLayoutable=
!1;R.fontWeight="bold";R.fontColor=pc.Color.orange;R.reactsToPointer=!1;R.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(R){this.submorphs=[R]}},layout:{initialize:function(){this.layout=new pc.CustomLayout({relayout:function(R){R.relayout()}})}},submorphs:{initialize:function(){this.value=
this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(R){return(R=R.value)&&(R.isColor||R.isGradient)?"Color":R&&R.isPoint?"Point":pc.obj.isBoolean(R)?"Boolean":pc.obj.isNumber(R)?"Number":pc.obj.isString(R)?"String":R&&R.isRectangle?"Rectangle":!1}},{key:"render",value:function(R){R.spec.type||(R.spec=Object.assign({},R.spec,{type:this.inferType(R)}));switch(R.spec.type){case "Color":var wa=this.renderColorControl(R);break;case "ColorGradient":wa=this.renderColorControl(Object.assign({},
R,{gradientEnabled:!0}));break;case "Number":wa=this.renderNumberControl(R);break;case "String":wa=this.renderStringControl(R);break;case "RichText":wa=this.renderStringControl(R);break;case "Layout":wa=this.renderLayoutControl(R);break;case "Enum":wa=this.renderEnumControl(R);break;case "Shadow":wa=this.renderShadowControl(R);break;case "Point":wa=this.renderPointControl(R);break;case "Rectangle":wa=this.renderRectangleControl(R);break;case "Boolean":wa=this.renderBooleanControl(R);break;default:wa=
this.renderItSomehow(R)}wa.control&&(pc.connect(wa.control,"openWidget",wa,"openWidget"),wa.toggleFoldableValue(R.value));return wa}},{key:"baseControl",value:function(R){var wa=R.spec;R=new this({keyString:R.keyString,valueString:R.valueString,isSelected:!1,propertyValue:R.value});wa.foldable&&R.asFoldable(wa.foldable);return R}},{key:"renderGrabbableKey",value:function(R){var wa=this,Za=R.target;return[R.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(eb){eb.state.draggedProp=new pc.DraggedProp({sourceObject:Za,
control:wa.baseControl(R)});eb.state.draggedProp.openInWorld();pc.connect(eb.hand,"update",eb.state.draggedProp,"update")},onDrag:function(eb){},onDragEnd:function(eb){pc.disconnect(eb.hand,"update",eb.state.draggedProp,"update");eb.state.draggedProp.applyToTarget(eb)}}]}},{key:"renderEnumControl",value:function(R){var wa=R.value,Za=R.spec.values,eb=R.keyString,hc=R.target,ic=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(wa?wa.valueOf?wa.valueOf():wa:"Not set"),
{nativeCursor:"pointer",onMouseDown:function(Qc,Pc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){hc.world().openWorldMenu(Qc,Za.map(function(He){return{string:He.toString(),action:function(){hc[eb]=He;ic.rerender()}}}));Nc.jumpToEnd()})}}],$jscomp.arrayFromIterable(pc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7})))}},{key:"renderStringControl",value:function(R){var wa=R.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),
[" "+(200<wa.length?wa.slice(0,20)+"...":wa),{fontColor:pc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(R){var wa=R.value,Za=R.keyString,eb=R.valueString,hc=R.target,ic=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+eb,{fontColor:pc.Color.black,nativeCursor:"pointer",onMouseDown:function(Qc){var Pc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){if(1==Nc.nextAddress)return Pc=new pc.popovers.RectanglePopover({hasFixedPosition:!0,
rectangle:wa}),Pc.relayout(),Nc.yield(Pc.fadeIntoWorld(Qc.positionIn(hc.world())),2);pc.connect(Pc,"rectangle",function(He){hc[Za]=He;ic.rerender()});Nc.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(R){var wa=R.value,Za=R.keyString,eb=R.valueString,hc=R.target,ic=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+eb,{nativeCursor:"pointer",fontColor:wa?pc.Color.green:pc.Color.red,onMouseDown:function(Qc){hc[Za]=!hc[Za];ic.rerender()}}])}},{key:"renderNumberControl",
value:function(R){var wa=R.value,Za=R.spec,eb=R.keyString,hc=R.valueString,ic=R.node,Qc=R.target,Pc=R.tree,Nc=void 0===ic._numberControls?new Ie:ic._numberControls,He=$jscomp.makeIterator(Nc.submorphs),ie=He.next().value,df=He.next().value;Nc.fontColor=Pc.fontColor;var lg=ic._numberControls=Nc;"max"in Za&&"min"in Za&&-Infinity!=Za.min&&Infinity!=Za.max?(lg.baseFactor=(Za.max-Za.min)/100,lg.floatingPoint=Za.isFloat,lg.max=Za.max,lg.min=Za.min):(lg.floatingPoint=Za.isFloat,lg.baseFactor=.5,lg.min=void 0!=
Za.min?Za.min:-Infinity,lg.max=void 0!=Za.max?Za.max:Infinity);var rh=pc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),$jscomp.arrayFromIterable(ic._inputMorph?[ic._inputMorph,{}]:[" "+(void 0!=wa&&(wa.valueOf?wa.valueOf():wa).toFixed(Za.isFloat?3:0))+" ",{fontColor:rh,onMouseUp:function(Cg){ic._inputMorph=pc.morph({type:"input",fill:null,fontColor:rh,fontFamily:"IBM Plex Mono",fontSize:14,padding:pc.rect(8,2,-6,2),
height:23,cursorColor:pc.Color.white,value:wa.valueOf?wa.valueOf():hc});Qc[eb]=wa;ic._inputMorph.focus();pc.once(ic._inputMorph,"inputAccepted",function(Wh){delete ic._inputMorph;Qc[eb]=Za.isFloat?Number.parseFloat(Wh):Number.parseInt(Wh);ic.rerender()});pc.once(ic._inputMorph,"onBlur",function(Wh){ic._inputMorph&&(delete ic._inputMorph,Qc[eb]=wa,ic.rerender())});ic.rerender()},onDragStart:function(Cg){lg.scrubbedValue=wa;pc.onNumberDragStart(Cg,lg)},onDrag:function(Cg){Qc[eb]=pc.onNumberDrag(Cg,
lg);ic.rerender()},onDragEnd:function(Cg){return pc.onNumberDragEnd(Cg,lg)}},Nc,{onMouseUp:function(){ie.fill=df.fill=null},onMouseDown:function(Cg){if(Cg.targetMorph===ie){ie.fill=pc.Color.white.withA(.2);if("max"in Za&&Qc[eb]>=Za.max)return;Qc[eb]+=1}if(Cg.targetMorph===df){df.fill=pc.Color.white.withA(.2);if("min"in Za&&Qc[eb]<=Za.min)return;--Qc[eb]}ic.rerender()}}]))}},{key:"renderShadowControl",value:function(R){var wa=R.keyString,Za=R.value,eb=R.target,hc=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),
[""+(Za?Za.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(ic){var Qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){if(1==Pc.nextAddress)return Qc=new pc.popovers.ShadowPopover({shadowValue:eb[wa],hasFixedPosition:!0}),Pc.yield(Qc.fadeIntoWorld(ic.positionIn(eb.world())),2);pc.connect(Qc,"shadowValue",function(Nc){eb[wa]=Nc;hc.rerender()});Pc.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(R){var wa=R.keyString,Za=R.value,eb=R.target,hc=R.node,
ic=pc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Qc={nativeCursor:"pointer",onMouseDown:function(Pc){var Nc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(He){if(1==He.nextAddress)return Nc=new pc.popovers.PointPopover({pointValue:eb[wa],hasFixedPosition:!0}),He.yield(Nc.fadeIntoWorld(Pc.positionIn(eb.world())),2);pc.connect(Nc,"pointValue",function(ie){eb[wa]=ie;hc.rerender()});He.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),
[" pt(",Object.assign({},Qc),""+Za.x.toFixed(),Object.assign({fontColor:ic},Qc),",",Object.assign({},Qc),""+Za.y.toFixed(),Object.assign({fontColor:ic},Qc),")",Object.assign({},Qc)])}},{key:"renderLayoutControl",value:function(R){var wa=R.valueString,Za=R.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(Za?wa:"No Layout"),{onMouseDown:function(eb){}}])}},{key:"renderColorControl",value:function(R){var wa=R.node,Za=R.gradientEnabled,eb=R.valueString,hc=R.keyString,
ic=R.value,Qc=R.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[pc.morph({fill:ic.valueOf?ic.valueOf():ic,extent:pc.pt(15,15),borderColor:pc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(ic?ic.valueOf?ic.valueOf():eb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Pc){var Nc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(He){if(1==He.nextAddress)return Nc=new pc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Qc,
fillValue:ic,title:"Fill Control",gradientEnabled:Za}),He.yield(Nc.fadeIntoWorld(Pc.positionIn(Qc.world())),2);pc.connect(Nc,"fillValue",function(ie){Qc[hc]=ie;wa.rerender()});He.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(R){var wa=R.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+wa,{}])}}],Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5024,end:20444})}(pc.DraggableTreeLabel);pc.PropertyControl=Rd;pc.PropertyControl=Rd;pc.PropertyControl=Rd;pc.inspect=tc;pc.inspect=tc;pc.remoteInspect=Kd;pc.remoteInspect=Kd;pc.generateReferenceExpression=Yc;pc.generateReferenceExpression=Yc;var Ie=function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),jb=Ma.hasOwnProperty("NumberControls")&&"function"===typeof Ma.NumberControls?Ma.NumberControls:Ma.NumberControls=
function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new pc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:pc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(R){this.submorphs.map(function(wa){return wa.fontColor=
R})}},submorphs:{initialize:function(){this.submorphs=[pc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:pc.rect(5,2,0,-6),fontSize:12}),pc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:pc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23095,end:24127})}(pc.Morph);(function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),jb=Ma.hasOwnProperty("PropertyTree")&&"function"===typeof Ma.PropertyTree?Ma.PropertyTree:Ma.PropertyTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:"onDrag",value:function(R){this._onDragHandler&&this._onDragHandler(R)}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25279,end:25389})})(pc.Tree);Rd=function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),jb=Ma.hasOwnProperty("Inspector")&&"function"===
typeof Ma.Inspector?Ma.Inspector:Ma.Inspector=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(R){}},{key:"__after_deserialize__",value:function(R,wa,Za){var eb=this,hc=new pc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,
{treeData:pc.InspectionTree.forObject(null,this)}));this.addMorph(hc,this.getSubmorphNamed("terminal toggler"));this.layout.col(0).row(1).group.morph=hc;this.whenRendered().then(function(){eb.targetObject&&(eb.targetObject=eb.targetObject)});yb._get(Object.getPrototypeOf(jb.prototype),"__after_deserialize__",this).call(this,R,wa,Za)}},{key:"__additionally_serialize__",value:function(R,wa,Za,eb){R=R.props.submorphs.value;for(wa=R.length;wa--;)Za.refForId(R[wa].id).realObj==this.ui.propertyTree&&pc.arr.removeAt(R,
wa)}},{key:"renderDraggableTreeLabel",value:function(R){return new pc.DraggableTreeLabel(R)}},{key:"renderPropertyControl",value:function(R){return pc.PropertyControl.render(R)}},{key:"onLoad",value:function(){var R=this.ui,wa=R.codeEditor,Za=R.thisBindingSelector,eb=R.propertyTree;wa.changeEditorMode("js").then(function(){return wa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Za.selection?wa.owner.selectedContext:wa.owner.targetObject},get systemInterface(){return pc.Path("treeData.systemInterface").get(eb)},
format:"esm"}}).catch(function(hc){return $world.logError(hc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(R){yb._get(Object.getPrototypeOf(jb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);R=this.ui;var wa=R.targetPicker,Za=R.propertyTree,eb=R.resizer,hc=R.terminalToggler,ic=R.unknowns,Qc=R.internals,Pc=R.searchField,Nc=R.codeEditor,He=R.fixImportButton,ie=R.thisBindingSelector;Nc.changeEditorMode("js").then(function(){return Nc.evalEnvironment={targetModule:"lively://lively.morphic/inspector",
get context(){return"selection"==ie.selection?Nc.owner.selectedContext:Nc.owner.targetObject},get systemInterface(){return Za.treeData.systemInterface},format:"esm"}}).catch(function(df){return $world.logError(df)});pc.connect(wa,"onMouseDown",this,"selectTarget");pc.connect(Za,"onScroll",this,"repositionOpenWidget");pc.connect(eb,"onDrag",this,"adjustProportions");pc.connect(hc,"onMouseDown",this,"toggleCodeEditor");pc.connect(ic,"trigger",this,"filterProperties");pc.connect(Qc,"trigger",this,"filterProperties");
pc.connect(Pc,"searchInput",this,"filterProperties");pc.connect(Za,"nodeCollapseChanged",this,"filterProperties");pc.connect(this,"extent",this,"relayout");pc.connect(ie,"selection",this,"bindCodeEditorThis");pc.connect(He,"fire",Nc,"execCommand",{updater:function(df){return df("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var R=this.ui.propertyTree.selectedIndex-1,wa=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();
wa=this.ui.propertyTree.document.getLine(R).textAndAttributes.slice(0,4).concat(wa.display(this));R=this.ui.propertyTree.lineRange(R,!1);this.ui.propertyTree.replace(R,wa,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;
else{var R=pc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(R!=this.lastChange||this.lastSubmorphs!=pc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==R.prop&&this.repositionOpenWidget(),this.lastChange=R,this.lastSubmorphs=pc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var R;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(wa){wa=
wa.node;wa.target&&(R=wa.foldableNode?wa.target[wa.foldableNode.key][wa.key]:wa.target[wa.key],!pc.obj.equals(R,wa.value)&&wa.refreshProperty&&wa.refreshProperty(R))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(R,wa){wa=void 0===wa?!1:wa;var Za=this,eb,hc,ic,Qc,Pc,Nc,He,ie,df,lg,rh,Cg,Wh,wg,Zi;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mf){switch(Mf.nextAddress){case 1:if(!Za.isUpdating()){Mf.jumpTo(2);
break}return Mf.yield(Za.whenUpdated(),2);case 2:eb=pc.promise.deferred();hc=eb.promise;ic=!!Za.target;Za.updateInProgress=hc;Mf.setCatchFinallyBlocks(4);wa&&(Qc=pc.LoadingIndicator.open("connecting to remote..."));if(!wa){Pc=pc.InspectionTree.forObject(R,Za);Mf.jumpTo(6);break}return Mf.yield(pc.RemoteInspectionTree.forObject(R,Za),7);case 7:Pc=Mf.yieldResult;case 6:return Nc=Pc,He=Za.ui.propertyTree,Mf.yield(Nc.collapse(Nc.root,!1),8);case 8:if(!Nc.root.children){Mf.jumpTo(9);break}return Mf.yield(Nc.collapse(Nc.root.children[0],
!1),9);case 9:if(ie=Za.originalTreeData&&Za.originalTreeData.diff(Nc)){df=$jscomp.makeIterator(ie);for(lg=df.next();!lg.done;lg=df.next())rh=lg.value,Cg=$jscomp.makeIterator(rh),Wh=Cg.next().value,wg=Cg.next().value,Wh.refreshProperty(wg.value);Mf.jumpTo(11);break}He.treeData=Nc;return Mf.yield(Za.filterProperties(),12);case 12:if(!He.treeData.root.isCollapsed){Mf.jumpTo(13);break}return Mf.yield(He.onNodeCollapseChanged({node:Nc.root,isCollapsed:!1}),14);case 14:He.selectedIndex=1;case 13:return Mf.yield(He.execCommand("uncollapse selected node"),
11);case 11:Za.toggleWindowStyle(ic);Qc&&Qc.remove();Mf.leaveTryBlock(5);break;case 4:Zi=Mf.enterCatchBlock(),Za.showError(Zi);case 5:Za.startStepping(1E3,"refreshAllProperties"),Za.updateInProgress=null,Mf.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(R){R=void 0===R?!0:R;var wa=this,Za,eb,hc,ic,Qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){if(1==Pc.nextAddress)return Za=300,ic=wa.ui.codeEditor.pluginFind(function(Nc){return Nc.runEval}),Qc=wa.getWindow(),Pc.yield(ic.runEval("System.get('@system-env').node"),
2);Pc.yieldResult.value?(hc=[].concat($jscomp.arrayFromIterable(pc.arr.without(Qc.styleClasses,"local")),["node"]),eb=pc.DarkTheme.instance):(hc=["local"].concat($jscomp.arrayFromIterable(Qc?pc.arr.without(Qc.styleClasses,"node"):[])),eb=pc.DefaultTheme.instance);ic.theme=eb;R?(Qc&&Qc.animate({duration:Za,styleClasses:hc}),wa.ui.codeEditor.animate({fill:eb.background,duration:Za})):Qc&&(Qc.styleClasses=hc);wa.ui.codeEditor.textString=wa.ui.codeEditor.textString;ic.highlight();Pc.jumpToEnd()})}},{key:"isUpdating",
value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var R=this,wa=Object.assign({type:"text",borderWidth:1,borderColor:pc.Color.gray,lineWrapping:"by-chars"},pc.config.codeEditor.defaultStyle,{textString:""}),Za=pc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});pc.rect(0,0,this.width,30);var eb=new pc.SearchField({styleClasses:["idle"],
name:"searchField"});Za[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[eb,{type:"button",name:"targetPicker",padding:pc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:pc.Icon.textAttribute("crosshairs")},new pc.LabeledCheckBox({label:"Internals",name:"internals"}),new pc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new pc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:pc.InspectionTree.forObject(null,
this)})),pc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},wa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:pc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Za),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Za),[" selection",null])}]}];
this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){R.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var R=this,wa,Za,eb,hc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ic){switch(ic.nextAddress){case 1:if(R.env.eventDispatcher.isKeyPressed("Shift"))return Za=$jscomp,eb=Za.makeIterator,ic.yield($world.execCommand("select morph",{justReturn:!0}),
5);R.toggleSelectionInstructions(!0);return ic.yield(pc.InteractiveMorphSelector.selectMorph(),4);case 4:wa=ic.yieldResult;R.toggleSelectionInstructions(!1);ic.jumpTo(3);break;case 5:hc=eb.call(Za,ic.yieldResult),wa=hc.next().value;case 3:wa&&(R.targetObject=wa),ic.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(R){if(R&&!this.instructionWidget){var wa=pc.morph({type:"label",name:"escapeKey",value:"esc"});wa.whenRendered().then(function(){return wa.fit()});this.instructionWidget=
this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},wa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(R){R=
R.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;R.epiMorph=!0;this.openWidget=R;pc.once(R,"close",this,"closeOpenWidget");pc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var R=this.ui.propertyTree,wa=R.textLayout.boundsFor(R,{column:0,row:R.selectedIndex-1});wa=R.worldPoint(pc.pt(wa.x,wa.y+wa.height/2)).addPt(R.scroll.negated());R=R.globalBounds();wa.x=this.globalBounds().center().x;
wa.y<R.top()?wa=R.topCenter():R.bottom()-20<wa.y&&(wa=R.bottomCenter().addXY(0,-20));return wa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(R){this.layout.row(1).height+=R.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(R){if(R!==this.isEditorVisible()){var wa=this.extent,
Za=this.layout,eb=this.ui,hc=eb.terminalToggler,ic=eb.codeEditor,Qc=eb.thisBindingSelector;eb=eb.fixImportButton;Za.disable();R?(hc.fontColor=pc.Color.rgbHex("00e0ff"),Za.row(3).height=this.codeEditorHeight||180,Za.row(2).height=5,eb.animate({visible:!0,duration:200}),Qc.animate({visible:!0,duration:200})):(this.codeEditorHeight=Za.row(3).height,hc.fontColor=pc.Color.white,Za.row(3).height=Za.row(2).height=0,eb.animate({visible:!1,duration:200}),Qc.animate({visible:!1,duration:200}));this.extent=
wa;Za.enable({duration:200});this.relayout({duration:200});ic.focus();ic.animate({opacity:R?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var R=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){R.makeEditorVisible(!R.isEditorVisible());wa.jumpToEnd()})}},{key:"filterProperties",value:function(){var R=this,wa,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return wa=R.ui.searchField,Za=R.ui.propertyTree,R.originalTreeData||
(R.originalTreeData=Za.treeData),pc.disconnect(Za.treeData,"onWidgetOpened",R,"onWidgetOpened"),eb.yield(Za.treeData.filter({maxDepth:2,showUnknown:R.ui.unknowns.checked,showInternal:R.ui.internals.checked,iterator:function(hc){return wa.matches(hc.key)}}),2);Za.update();pc.connect(Za.treeData,"onWidgetOpened",R,"onWidgetOpened");eb.jumpToEnd()})}},{key:"relayout",value:function(R){R=void 0===R?{}:R;var wa=this,Za,eb,hc,ic,Qc,Pc,Nc,He,ie;return $jscomp.asyncExecutePromiseGeneratorProgram(function(df){wa.layout&&
wa.layout.forceLayout();Za=wa;eb=Za.ui;hc=eb.fixImportButton;ic=eb.terminalToggler;Qc=eb.propertyTree;Pc=eb.thisBindingSelector;Nc=Qc.bounds().insetBy(5).bottomLeft();He=Qc.bounds().insetBy(5).bottomRight();ie=He.subXY(hc.width+10,0);Pc.width=115;Pc.listMorph.itemHeight=20;R.duration?(ic.animate(Object.assign({bottomLeft:Nc},R)),hc.animate(Object.assign({bottomRight:He},R)),Pc.animate(Object.assign({bottomRight:ie},R))):(ic.bottomLeft=Nc,hc.bottomRight=He,Pc.bottomRight=ie);df.jumpToEnd()})}},{key:"keybindings",
get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(yb._get(Object.getPrototypeOf(jb.prototype),"keybindings",this))}},{key:"commands",get:function(){return pc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(R){R=new this(R);R.openInWindow();return R}},{key:"properties",
get:function(){return{extent:{defaultValue:pc.pt(400,500)},fill:{defaultValue:pc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(R){this.setProperty("remoteTarget",R);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(R,!0))}},targetObject:{after:["submorphs"],set:function(R){this._serializableTarget=R&&R.isMorph?R.id:R;this.setProperty("targetObject",R);this.ui.propertyTree&&(this.originalTreeData=
null,this.prepareForNewTargetObject(R))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var R=this.ui.propertyTree,wa=R.selectedNode;R=R.treeData;return R.getContextFor(wa?wa:R.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),
thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:pc.Color.gray,
fontSize:14,fontFamily:pc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25406,end:45571})}(pc.Morph);Rd=pc.Inspector;be=ta("I",Rd);pc.default=
Rd;var rf=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");rf.Inspector=be;rf.string=Rc;rf.Morph=ec;rf.pt=yd;rf.Color=lb;Rd=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(va,Ma,jb){jb=void 0===jb?1:jb;var R,wa,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){switch(eb.nextAddress){case 1:return va.maybeSelectCommentOrLine(),eb.setCatchFinallyBlocks(2),Ma=Object.assign({},Ma,{logDoit:!0,inspect:!0,
inspectDepth:jb}),eb.yield(va.doEval(void 0,Ma),4);case 4:R=eb.yieldResult;wa=R.error?R.error:R.isError?R.value:null;eb.leaveTryBlock(3);break;case 2:wa=Za=eb.enterCatchBlock();case 3:return wa?va.showError(wa):va.setStatusMessage(rf.string.truncate(R.value,1E3)),eb.return(R)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(va,Ma){var jb,R,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){switch(Za.nextAddress){case 1:return Za.setCatchFinallyBlocks(2),
Za.yield(va.doEval({start:{row:0,column:0},end:va.documentEndPosition},Object.assign({},Ma,{logDoit:!0})),4);case 4:jb=Za.yieldResult;R=jb.error?jb.error:jb.isError?jb.value:null;Za.leaveTryBlock(3);break;case 2:R=wa=Za.enterCatchBlock();case 3:return R?va.showError(R):va.setStatusMessage(String(jb.value)),Za.return(jb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(va,Ma){var jb,R,wa,Za,eb,hc,ic,Qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pc){switch(Pc.nextAddress){case 1:return va.maybeSelectCommentOrLine(),
Pc.setCatchFinallyBlocks(2),Ma=Object.assign({},Ma,{asString:!1,logDoit:!0}),Pc.yield(va.doEval(void 0,Ma),4);case 4:jb=Pc.yieldResult;R=jb.error?jb.error:jb.isError?jb.value:null;Pc.leaveTryBlock(3);break;case 2:R=wa=Pc.enterCatchBlock();case 3:va.selection.collapseToEnd();if(Za=jb.value&&jb.value.isColor)return va.selection.text=String(jb.value),eb=new rf.Morph({fill:rf.Color.transparent,extent:rf.pt(va.fontSize+2,va.fontSize+2),submorphs:[{fill:jb.value,center:rf.pt(va.fontSize+2,va.fontSize+2).scaleBy(.5)}]}),
hc=va.selection.start,ic=hc.column,Qc=hc.row,va.insertText([eb,{}],va.selection.start),va.selection.start={column:ic,row:Qc},va.focus(),Pc.return(jb);va.insertTextAndSelect(R?String(R)+(R.stack?"\n"+R.stack:""):String(jb.value));va.focus();return Pc.return(jb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(va,Ma){var jb,R,wa,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){switch(eb.nextAddress){case 1:debugger;
va.maybeSelectCommentOrLine();R=va.textInRange(va.selection);wa=va.evalEnvironment||{};Za=va.pluginFind(function(hc){return hc.isEditorPlugin&&"function"===typeof hc.runEval});wa.systemInterface||(wa.systemInterface=Za.systemInterface(Ma));if("local"!==wa.systemInterface.name){eb.jumpTo(2);break}eb.setCatchFinallyBlocks(3);return eb.yield(va.doEval(void 0,Ma),5);case 5:jb=eb.yieldResult;R=jb.value;eb.leaveTryBlock(2);break;case 3:eb.enterCatchBlock();case 2:return va.world().execCommand("open object editor",
{target:R,evalEnvironment:wa}),eb.return(jb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(va,Ma){var jb,R,wa,Za,eb,hc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ic){switch(ic.nextAddress){case 1:va.maybeSelectCommentOrLine();wa=va.textInRange(va.selection);Za=va.evalEnvironment||{};eb=va.pluginFind(function(Qc){return Qc.isEditorPlugin&&"function"===typeof Qc.runEval});Za.systemInterface||(Za.systemInterface=
eb.systemInterface(Ma));if("local"!==Za.systemInterface.name){rf.Inspector.openInWindow({remoteTarget:{code:wa,evalEnvironment:Za}});ic.jumpTo(2);break}ic.setCatchFinallyBlocks(3);return ic.yield(va.doEval(void 0,Ma),5);case 5:jb=ic.yieldResult;R=jb.error?jb.error:jb.isError?jb.value:null;wa=jb.value;ic.leaveTryBlock(4);break;case 3:R=hc=ic.enterCatchBlock();case 4:rf.Inspector.openInWindow({targetObject:R?R:wa});case 2:return ic.return(jb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(va,Ma,jb){jb=void 0===jb?1:jb;var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){switch(wa.nextAddress){case 1:return va.maybeSelectCommentOrLine(),wa.setCatchFinallyBlocks(2),Ma=Object.assign({},Ma,{inspect:!0,inspectDepth:jb,logDoit:!0}),wa.yield(va.doEval(void 0,Ma),4);case 4:R=wa.yieldResult;wa.leaveTryBlock(3);break;case 2:wa.enterCatchBlock();case 3:return va.selection.collapseToEnd(),va.insertTextAndSelect(R.value),wa.return(R)}})}}];rf.codeEvaluationCommands=
Rd;rf.codeEvaluationCommands=Rd;rf.codeEvaluationCommands=Rd;var sf=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");sf.changeAttributeInSelectionOrMorph=function(va,Ma,jb){var R=va.selection;va.keepPosAtSameScrollOffsetWhile(function(){R.isEmpty()?va[Ma]="function"===typeof jb?jb(va[Ma]):jb:(va.undoManager.group(),va.changeStyleProperty(Ma,function(wa){return"function"===typeof jb?jb(wa):jb}),va.undoManager.group())})};be=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(va){var Ma=va.fontSize;sf.changeAttributeInSelectionOrMorph(va,"fontSize",function(jb){jb=jb||Ma;return jb+(18<=jb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(va){var Ma=va.fontSize;sf.changeAttributeInSelectionOrMorph(va,"fontSize",function(jb){jb=jb||Ma;return jb-(18>=jb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(va){var Ma,jb,R,wa,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress){Ma=
["serif","sans-serif","monospace"];if(jb=localStorage["lively.morpic/text-change-font-additional-fonts"])jb=JSON.parse(jb),Ma.push.apply(Ma,$jscomp.arrayFromIterable(jb));Ma.map(function(hc){return hc.toLowerCase()}).includes(va.fontFamily.toLowerCase())||(Ma.push(va.fontFamily),jb=[].concat($jscomp.arrayFromIterable(jb||[]),[va.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(jb));return eb.yield($world.editListPrompt("choose font",Ma,{requester:va,preselect:Ma.indexOf(va.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}R=eb.yieldResult;wa=$jscomp.makeIterator(R.selections);if(Za=wa.next().value)va.fontFamily=Za;return eb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(va,Ma){Ma=void 0===Ma?{}:Ma;var jb,R,wa,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress){if(Ma.hasOwnProperty("link"))return eb.jumpTo(2);R=va.selection;wa=va.getStyleInRange(R);Za=wa.link;return eb.yield(va.world().prompt("Set link",
{input:Za||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=eb.nextAddress&&(jb=eb.yieldResult,!jb))return eb.return();va.undoManager.group();va.setStyleInRange({link:jb||void 0},R);va.undoManager.group();eb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(va,Ma){var jb,R,wa,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return jb=va.selection,R=va.getStyleInRange(jb),wa=R.doit,eb.yield(va.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:va,input:wa?wa.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:va.evalEnvForDoit(wa||{})}),2);Za=eb.yieldResult;va.undoManager.group();Za?va.addTextAttribute({doit:{code:Za},nativeCursor:"pointer",textDecoration:"underline"},jb):va.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},jb);va.undoManager.group();eb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(va,Ma){Ma=void 0===Ma?{}:Ma;va.undoManager.group();
Ma=!Ma.onlySelection&&va.selection.isEmpty()?va.documentRange:va.selection.range;va.setStyleInRange(null,Ma);va.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(va){var Ma,jb,R,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==Za.nextAddress)return Za.yield(System.import("lively.modules"),2);if(3!=Za.nextAddress)return Ma=Za.yieldResult,jb=Ma.module,Za.yield(jb("lively.ide/text/ui.js").load(),3);R=Za.yieldResult;wa=R.RichTextControl;return Za.return(wa.openFor(va))})}}];
sf.commands=be;sf.commands=be;sf.commands=be;var re=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");re.guessTextModeName=ub;re.rangedToken=function(va,Ma,jb,R,wa){return{start:{row:va,column:Ma},end:{row:va,column:jb},token:R,mode:wa}};re.fun=lc;re.arr=Qb;re.connect=Dc;re.disconnect=sb;re.DefaultTheme=tb;re.tokenizeDocument=Wa;re.modeInfo=oa;re.visitDocumentTokens=Ec;re.getMode=Yb;re.completionCommands=la;re.multiSelectCommands=fc;re.navCommands=xd;re.codeCommands=le;re.codeEvaluationCommands=
Rd;re.richTextCommands=be;re.Color=lb;re.Range=Hd;re.guessTextModeName=ub;re.guessTextModeName=ub;tb=function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),jb=Ma.hasOwnProperty("EditorPlugin")&&"function"===typeof Ma.EditorPlugin?Ma.EditorPlugin:Ma.EditorPlugin=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
re.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(R){var wa=this;this.textMorph=R;re.connect(R,"textChange",this,"onTextChange");re.connect(R,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return wa.highlight()})}},
{key:"detach",value:function(R){re.disconnect(R,"textChange",this,"onTextChange");re.disconnect(R,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(R){this._ast=null;if(R){var wa=this._tokenizerValidBefore;if("replace"===R.selector){var Za=R.args[0].start;R=Za.row;Za=Za.column}else Za=R=0;if(!wa||R<wa.row||R===wa.row&&Za<wa.column)R=Math.max(0,R),this._tokenizerValidBefore={row:R,column:Za}}this.requestHighlight()}},
{key:"requestHighlight",value:function(R){var wa=this;(void 0===R?0:R)?this.highlight():re.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return wa.highlight()})()}},{key:"highlight",value:function(){var R=this.textMorph,wa=this.theme,Za=this.mode,eb=this._tokenizerValidBefore;if(wa&&R&&R.document&&Za){R.fill=wa.background;R.cursorColor=wa.cursorColor||re.Color.black;var hc=R.viewState,ic={};eb=re.tokenizeDocument(Za,R.document,hc.firstVisibleRow,hc.lastVisibleRow,eb);Za=eb.lines;eb=
eb.tokens;if(Za.length){hc=Za[0].row;for(var Qc=[],Pc=0;Pc<eb.length;hc++,Pc++)for(var Nc=eb[Pc],He=0;He<Nc.length;He+=5){var ie=Nc[He],df=Nc[He+1],lg=wa[Nc[He+2]]||wa.default;lg&&Qc.push({start:{row:hc,column:ie},end:{row:hc,column:df}},lg)}R.embeddedMorphs.forEach(function(rh){var Cg=R.embeddedMorphMap.get(rh).anchor;ic[rh.id]=R.textAttributeAt(Cg.position)});R.setTextAttributesWithSortedRanges(Qc);R.embeddedMorphs.forEach(function(rh){var Cg=R.embeddedMorphMap.get(rh).anchor;Cg=re.Range.at(Cg.position);
Cg.end.column+=1;R.replace(Cg,[rh,ic[rh.id]],!1)});this._tokenizerValidBefore={row:re.arr.last(Za).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},R,this)}}},{key:"visitTokensInRange",value:function(R,wa){var Za=R.start,eb=R.end,hc=Za.row-1;re.visitDocumentTokens(this.mode,this.textMorph.document,Za.row,eb.row,null,function(ic){return hc++},function(ic,Qc,Pc,Nc,He,ie,df){if(hc===Za.row&&0<Za.column){if(Za.column>=Nc)return;Pc<Za.column&&Za.column<Nc&&(Pc=Za.column)}if(hc===eb.row){if(eb.column<=
Pc)return;Pc<eb.column&&eb.column<Nc&&(Nc=eb.column)}wa(ic,Qc,hc,Pc,Nc,He,ie,df)})}},{key:"tokensInRange",value:function(R){var wa=[];this.visitTokensInRange(R,function(Za,eb,hc,ic,Qc,Pc,Nc,He){return wa.push(re.rangedToken(hc,ic,Qc,Za,He))});return wa}},{key:"tokensOfRow",value:function(R){var wa=this.textMorph.getLine(R).length;return this.tokensInRange({start:{row:R,column:0},end:{row:R,column:wa}})}},{key:"tokenAt",value:function(R){for(var wa=this.tokensOfRow(R.row),Za=wa.length;Za--;){var eb=
wa[Za];if(eb.token&&eb.start.column<=R.column&&R.column<=eb.end.column)return eb}return null}},{key:"getCommands",value:function(R){return[].concat($jscomp.arrayFromIterable(R),$jscomp.arrayFromIterable(re.completionCommands),$jscomp.arrayFromIterable(re.multiSelectCommands),$jscomp.arrayFromIterable(re.navCommands),$jscomp.arrayFromIterable(re.codeCommands),$jscomp.arrayFromIterable(re.codeEvaluationCommands),$jscomp.arrayFromIterable(re.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var R=this.mode,wa=R.lineComment,Za=R.blockCommentStart;R=R.blockCommentEnd;var eb={};wa&&(eb.lineCommentStart=wa);Za&&(eb.blockCommentStart=Za);R&&(eb.blockCommentEnd=R);return eb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(R,wa,Za){var eb=this.textMorph,hc=R.row,ic=R.column;R=wa[ic-1];wa=wa[ic];eb.selection.text="\n";eb.selection.collapseToEnd();"{"===R&&"}"===wa&&(eb.selection.text="\n"+" ".repeat(Za),eb.selection.collapse());
eb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:hc+1,lastRow:hc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var R=this.textMorph,wa=this.openPairs,Za=R.selection,eb=R.getLine(Za.end.row),hc=eb[Za.end.column-1];eb=eb[Za.end.column];R.autoInsertPairs&&Za.isEmpty()&&hc in
wa&&eb===wa[hc]&&(Za.growRight(1),Za.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(R){var wa=this.openPairs,Za=this.closePairs,eb=this.textMorph,hc=eb.selection,ic=eb.autoInsertPairs&&R in wa,Qc=eb.autoInsertPairs&&R in Za;if(!ic&&!Qc)return!1;var Pc=eb.getLine(hc.end.row)[hc.end.column];if(!hc.isEmpty()){if(!ic)return!1;Za=eb.undoManager.ensureNewGroup(eb);eb.insertText(wa[R],hc.end);eb.insertText(R,hc.start);eb.undoManager.group(Za);hc.growRight(-1);return!0}if(Pc in Za&&R===Pc)return hc.goRight(1),
!0;if(Qc&&!ic)return!1;Za=eb.undoManager.ensureNewGroup(eb);eb.insertText(R+wa[R]);eb.undoManager.group(Za);hc.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Ma,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);
oa=tb=re.EditorPlugin;la=ta("C",function(va){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),jb=Ma.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Ma.CodeMirrorEnabledEditorPlugin?Ma.CodeMirrorEnabledEditorPlugin:Ma.CodeMirrorEnabledEditorPlugin=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yb(jb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(){yb._get(Object.getPrototypeOf(jb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(R){this.mode=this.codeMirrorMode(R);return yb._get(Object.getPrototypeOf(jb.prototype),"attach",this).call(this,R)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(R){return{indentWithTabs:!R.useSoftTabs,indentUnit:R.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(R){R=this.defaultCodeMirrorModeConfig(R);
return re.getMode(R,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Ma,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(re.EditorPlugin));re.CodeMirrorEnabledEditorPlugin=la;re.CodeMirrorEnabledEditorPlugin=
la;re.CodeMirrorEnabledEditorPlugin=la;re.default=tb;tb=Object.freeze({__proto__:null,guessTextModeName:ub,"default":oa,CodeMirrorEnabledEditorPlugin:la});ta("e",tb)}}});
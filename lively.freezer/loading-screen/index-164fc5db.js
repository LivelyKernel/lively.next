System.register(["./__root_module__-a4bfb546.js"],function(ta){var cb,mb,Sb,Jb,sd,vc,wd,wc,Cc,Gc,Cd,pe,Je,ce,Qb,pc,ld,Rb,xd,Hd,Dc,bc,Ib,gc,sc,dd,bd,oc,$a,fb,ya,Ca,Aa,xa,Oa,wb,dc,Ya,jb,Za,U,va,M;return{setters:[function(da){cb=da.ax;mb=da.a3;Sb=da.C;Jb=da.ab;sd=da.a8;vc=da.$;wd=da.a7;wc=da.a1;Cc=da.a2;Gc=da.aa;Cd=da.aA;pe=da.as;Je=da.an;ce=da.aX;Qb=da.au;pc=da.aj;ld=da.aY;Rb=da.aw;xd=da.az;Hd=da.aZ;Dc=da.aD;bc=da.ac;Ib=da.aq;gc=da.g;sc=da.am;dd=da.P;bd=da.a_;oc=da.at;$a=da.a6;fb=da.av;ya=da.a$;
Ca=da.r;Aa=da.ap;xa=da.b0;Oa=da.b1;wb=da.b2;dc=da.ad;Ya=da.b3;jb=da.ar;Za=da.b4;U=da.b5;va=da.b6;M=da.aS}],execute:function(){function da(Qa){(Qa=Ub.cachedGuideLines.get(Qa))&&Qa.forEach(function(Ja){return Ja.remove()})}function Ia(Qa,Ja,bb,H,aa){Ja=void 0===Ja?!0:Ja;bb=void 0===bb?!0:bb;H=void 0===H?10:H;aa=void 0===aa?100:aa;if(Ja||bb){var Ma=Qa.owner,tb=Ma.world();Ma=Ma.getGlobalTransform();var Lb=Qa.owner.submorphs.filter(function(xc){return xc!==Qa&&!xc.isEpiMorph&&xc.visible&&xc.reactsToPointer}),
uc=Ub.findAlignedMorphs(Qa,Lb,H,aa,"left top right bottom hCenter vCenter".split(" "),"left top right bottom hCenter vCenter".split(" "));aa=[];var hd=0,yd=0,Jc=0,Fd=0;Ma.e-=tb.scroll.x;Ma.f-=tb.scroll.y;if(uc){uc=$jscomp.makeIterator(uc);for(var Yd=uc.next();!Yd.done;Yd=uc.next()){Yd=$jscomp.makeIterator(Yd.value);Yd.next();var ie=Yd.next().value;Yd=ie.vertical;ie=$jscomp.makeIterator(ie.horizontal);for(var ue=ie.next();!ue.done;ue=ie.next()){ue=ue.value;var Ye=ue.edgeAVal,Db=ue.refPointsA,Lf=ue.refPointsB,
me=ue.edgeBVal,tf=Math.ceil(H-ue.delta),he=Math.min(Db.top,Lf.top);Db=Math.max(Db.bottom,Lf.bottom);ue.maxDist>H&&(tf-=H/2);hd<tf&&(hd=tf,Jc=me-Ye);aa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Ub.guideWidth,start:Ma.transformPoint(Ub.pt(me,he)),end:Ma.transformPoint(Ub.pt(me,Db)),fill:Ub.guideColor,guideType:"h",priority:tf})}Yd=$jscomp.makeIterator(Yd);for(ie=Yd.next();!ie.done;ie=Yd.next())ie=ie.value,ue=ie.edgeAVal,he=ie.refPointsA,Db=ie.refPointsB,Ye=ie.edgeBVal,me=Math.ceil(H-
ie.delta),tf=Math.min(he.left,Db.left),he=Math.max(he.right,Db.right),ie.maxDist>H&&(me-=H/2),yd<me&&Math.abs(Ye-ue)<=H&&(yd=me,Fd=Ye-ue),aa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Ub.guideWidth,start:Ma.transformPoint(Ub.pt(tf,Ye)),end:Ma.transformPoint(Ub.pt(he,Ye)),fill:Ub.guideColor,guideType:"v",priority:me})}}if(!hd||!yd){Lb=[Qa].concat($jscomp.arrayFromIterable(Lb));ue=Ub.computeClosestMorphs(Lb);ie=ue[0];Lb=ie.l;uc=ie.r;Yd=ie.t;ie=ie.b;var ua;if(Lb||uc||Yd||ie){var Ha=(Lb||
uc||Yd||ie).refPointsA;for(Ye=1;Ye<ue.length&&(Db=ue[Ye],me=Db.l,tf=Db.r,he=Db.t,Db=Db.b,hd||(Lb&&me&&Lb.index!==me.index&&Math.abs(me.dist-Lb.dist)<=H?ua=Object.assign({neighbor:Ye,direction:"left"},me):uc&&tf&&uc!==tf.index&&Math.abs(tf.dist-uc.dist)<=H&&(ua=Object.assign({neighbor:Ye,direction:"right"},tf))),yd||(Yd&&he&&Yd.index!==he.index&&Math.abs(he.dist-Yd.dist)<=H?ua=Object.assign({neighbor:Ye,direction:"top"},he):ie&&Db&&ie.index!==Db.index&&Math.abs(Db.dist-ie.dist)<=H&&(ua=Object.assign({neighbor:Ye,
direction:"bottom"},Db))),!ua);Ye++);}if(ua){var pb=ua;H=pb.direction;he=pb.dist;var R=Ha.left;Lf=Ha.top;var pa=Ha.bottom,Va=Ha.right,gb=Ha.width,ec=Ha.height;Db=pb.refPointsA;Ha=Db.left;ue=Db.top;Ye=Db.bottom;me=Db.right;tf=Db.width;Db=Db.height;var ac=pb.refPointsB,Ec=ac.left;pb=ac.top;var Mc=ac.bottom;ac=ac.right;Va="left"===H?R:"right"===H?Va:R+gb/2;pa="bottom"===H?pa:"top"===H?Lf:Lf+ec/2;R="left"===H?Va-he:"right"===H?Va+he:R+gb/2;he="bottom"===H?pa+he:"top"===H?pa-he:Lf+ec/2;Lf="left"===H?ac:
"right"===H?Ec:Ha+tf/2;gb="bottom"===H?pb:"top"===H?Mc:ue+Db/2;!bb||hd||"right"!==H&&"left"!==H||(hd=10,Jc=(ua.dist-(uc||Lb).dist)*("right"===H?-1:1),Va+=Jc,R+=Jc);!bb||yd||"top"!==H&&"bottom"!==H||(yd=10,Fd=((Yd||ie).dist-ua.dist)*("top"===H?-1:1),pa+=Fd,he+=Fd);aa.push({type:"line",epiMorph:!0,hasFixedPosition:!0,start:Ma.transformPoint(Ub.pt("left"===H?Ha:"right"===H?me:Ha+tf/2,"bottom"===H?Ye:"top"===H?ue:ue+Db/2)),end:Ma.transformPoint(Ub.pt(Lf,gb)),fill:Ub.Color.orange,height:Ub.guideWidth,
guideType:H,priority:10},{type:"line",epiMorph:!0,hasFixedPosition:!0,start:Ma.transformPoint(Ub.pt(Va,pa)),end:Ma.transformPoint(Ub.pt(R,he)),fill:Ub.Color.orange,height:Ub.guideWidth,guideType:H,priority:10})}}bb&&(Jc||Fd)&&Qa.moveBy(Ub.pt(Jc,Fd));if(Ja){aa=aa.filter(function(xc){var ze=xc.guideType;xc=xc.priority;return"h"===ze?xc===hd:"v"===ze?xc===yd:!0});(Ja=Ub.cachedGuideLines.get(Qa))||Ub.cachedGuideLines.set(Qa,Ja=[]);for(bb=0;bb<aa.length;bb++)ua=void 0,Ja[bb]?ua=Object.assign(Ja[bb],aa[bb]):
(ua=Ub.morph(aa[bb]),Ja.push(ua)),ua.owner||tb.addMorph(ua);Ja.slice(bb).forEach(function(xc){return xc.remove()});Ub.fun.debounceNamed(Qa.id+"-drag-guides-cleanup",1300,function(){var xc=Ub.cachedGuideLines.get(Qa);xc&&xc.forEach(function(ze){return ze.remove()})})()}}}function Wa(Qa,Ja,bb,H,aa,Ma){bb=void 0===bb?!0:bb;H=void 0===H?!0:H;aa=void 0===aa?5:aa;Ma=void 0===Ma?100:Ma;if(bb||H){var tb=Qa.owner,Lb=tb.world(),uc=tb.getGlobalTransform(),hd=Qa.owner.submorphs.filter(function(pa){return pa!==
Qa&&!pa.isEpiMorph&&pa.visible&&pa.reactsToPointer});tb=(Ja.includes("left")||Ja.includes("right")?"x":"")+(Ja.includes("top")||Ja.includes("bottom")?"y":"");var yd=Ub.findMorphsWithSimilarWidthOrHeight(Qa,tb,hd,aa,Ma),Jc=-Infinity,Fd=-Infinity,Yd=0,ie=0,ue=0,Ye=0,Db=0,Lf=0;tb=[];uc.e-=Lb.scroll.x;uc.f-=Lb.scroll.y;if(yd){yd=$jscomp.makeIterator(yd);for(var me=yd.next();!me.done;me=yd.next()){me=$jscomp.makeIterator(me.value);me.next();var tf=me.next().value;me=tf.similarIn;var he=tf.delta,ua=tf.refPointsA,
Ha=tf.refPointsB;tf=aa-he+(Ma-tf.minDist);"width"===me?Jc<tf&&(Jc=tf,Ja.includes("left")&&(ie=-he),Ja.includes("right")&&(Yd=he)):Fd<tf&&(Fd=tf,Ja.includes("top")&&(ue=-he),Ja.includes("bottom")&&(Ye=he));he={type:"line",epiMorph:!0,hasFixedPosition:!0,height:Ub.guideWidth,fill:Ub.guideColor,guideType:me,priority:tf,start:uc.transformPoint("width"===me?Ub.pt(ua.left,ua.top+ua.height/2):Ub.pt(ua.left+ua.width/2,ua.top)),end:uc.transformPoint("width"===me?Ub.pt(ua.right,ua.top+ua.height/2):Ub.pt(ua.left+
ua.width/2,ua.bottom))};me=Object.assign({},he,{start:uc.transformPoint("width"===me?Ub.pt(Ha.left,Ha.top+Ha.height/2):Ub.pt(Ha.left+Ha.width/2,Ha.top)),end:uc.transformPoint("width"===me?Ub.pt(Ha.right,Ha.top+Ha.height/2):Ub.pt(Ha.left+Ha.width/2,Ha.bottom))});tb.push(he,me)}}if(Ma=Ub.findAlignedMorphs(Qa,hd,aa,Ma,Ja,void 0))for(Ma=$jscomp.makeIterator(Ma),hd=Ma.next();!hd.done;hd=Ma.next()){hd=$jscomp.makeIterator(hd.value);hd.next();yd=hd.next().value;hd=yd.vertical;yd=$jscomp.makeIterator(yd.horizontal);
for(me=yd.next();!me.done;me=yd.next()){me=me.value;Ha=me.edgeAVal;var pb=me.refPointsA,R=me.refPointsB;he=me.edgeBVal;ua=Math.ceil(aa-me.delta);tf=Math.min(pb.top,R.top);pb=Math.max(pb.bottom,R.bottom);me.maxDist>aa&&(ua-=aa/2);Db<ua&&(Db=ua,Ja.includes("left")&&(ie=-(he-Ha)),Ja.includes("right")&&(Yd=+(he-Ha)));tb.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Ub.guideWidth,start:uc.transformPoint(Ub.pt(he,tf)),end:uc.transformPoint(Ub.pt(he,pb)),fill:Ub.guideColor,guideType:"h",priority:ua})}hd=
$jscomp.makeIterator(hd);for(yd=hd.next();!yd.done;yd=hd.next())yd=yd.value,me=yd.edgeAVal,tf=yd.refPointsA,pb=yd.refPointsB,Ha=yd.edgeBVal,he=Math.ceil(aa-yd.delta),ua=Math.min(tf.left,pb.left),tf=Math.max(tf.right,pb.right),yd.maxDist>aa&&(he-=aa/2),Lf<he&&Math.abs(Ha-me)<=aa&&(Lf=he,Ja.includes("top")&&(ue=Ha-me),Ja.includes("bottom")&&(Ye=Ha-me)),tb.push({type:"line",epiMorph:!0,hasFixedPosition:!0,height:Ub.guideWidth,start:uc.transformPoint(Ub.pt(ua,Ha)),end:uc.transformPoint(Ub.pt(tf,Ha)),
fill:Ub.guideColor,guideType:"v",priority:he})}H&&(ie&&(Qa.left+=ie,Qa.right-=ie),ue&&(Qa.top+=ue,Qa.bottom-=ue),Yd&&(Qa.width+=Yd),Ye&&(Qa.height+=Ye));if(bb){tb=tb.filter(function(pa){var Va=pa.guideType;pa=pa.priority;return"width"===Va?pa===Jc:"height"===Va?pa===Fd:"v"===Va?pa===Lf:"h"===Va?pa===Db:!1});(Ja=Ub.cachedGuideLines.get(Qa))||Ub.cachedGuideLines.set(Qa,Ja=[]);for(bb=0;bb<tb.length;bb++)H=void 0,Ja[bb]?H=Object.assign(Ja[bb],tb[bb]):(H=Ub.morph(tb[bb]),Ja.push(H)),H.owner||Lb.addMorph(H);
Ja.slice(bb).forEach(function(pa){return pa.remove()});Ub.fun.debounceNamed(Qa.id+"-drag-guides-cleanup",1300,function(){var pa=Ub.cachedGuideLines.get(Qa);pa&&pa.forEach(function(Va){return Va.remove()})})()}}}function Zb(Qa,Ja){Ja=void 0===Ja?!1:Ja;var bb=vb.MorphicEnv.default().world;if(null===Qa||void 0===Qa)Qa=String(Qa);if(Qa.isMorph)return vb.showRect(Qa.world(),Qa.globalBounds().translatedBy(Qa.world().scroll.negated()),Ja);if(Qa.isPoint)return vb.showRect(bb,new vb.Rectangle(Qa.x-5,Qa.y-
5,10,10));if(Qa.isLine)return vb.showLine(bb,Qa);if(Qa.isRectangle)return vb.showRect(bb,Qa);if("undefined"!==typeof vb.Element&&Qa instanceof vb.Element)return vb.showRect(bb,vb.Rectangle.fromElement(Qa));if("number"===typeof Qa||"symbol"===typeof Qa||"boolean"===typeof Qa||"undefined"!==typeof vb.Node&&Qa instanceof vb.Node||Qa instanceof RegExp)Qa=String(Qa);"object"===typeof Qa&&(Qa=vb.obj.inspect(Qa,{maxDepth:1}));return"string"===typeof Qa&&1===arguments.length?bb.setStatusMessage(Qa):bb.setStatusMessage(vb.string.formatFromArray(Array.from(arguments)))}
function Oc(Qa,Ja,bb){bb=void 0===bb?3E3:bb;var H,aa,Ma,tb,Lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(uc){if(1==uc.nextAddress){if(!(Qa&&Qa.world()&&Ja&&Ja.world()))return uc.return(null);H=Qa.owner.worldPoint(Qa.center);aa=Ja.owner.worldPoint(Ja.center);Ma=H.lineTo(aa).sampleN(2)[1];tb={tagName:"marker",markerHeight:5,markerWidth:5,orient:"auto",refX:1,refY:5,viewBox:"0 0 10 10",children:[{tagName:"circle",stroke:vb.Color.red,fill:vb.Color.red,cx:5,cy:5,r:4}]};Lb=$world.addMorph(new vb.Path({position:Ma,
renderOnGPU:!0,vertices:[vb.pt(0),vb.pt(0)],borderWidth:2,startMarker:tb,endMarker:tb,borderColor:vb.Color.red}));return uc.yield(Lb.whenRendered(),2)}if(3!=uc.nextAddress)return uc.yield(Lb.animate({opacity:1,customTween:function(hd){var yd=Lb.center;Lb.vertices=[vb.pt(0).interpolate(hd,H.subPt(Ma)),vb.pt(0).interpolate(hd,aa.subPt(Ma))];Lb.center=yd},duration:400}),3);bb&&setTimeout(function(){return Lb.fadeOut()},bb);return uc.return(Lb)})}ta({a:Ia,d:Oc,r:da,s:Zb});var Ub=lively.FreezerRuntime.recorderFor("lively.halos/drag-guides.js");
Ub.removeSnapToGuidesOf=da;Ub.showAndSnapToGuides=Ia;Ub.showAndSnapToResizeGuides=Wa;Ub.computeRefPoints=function(Qa){var Ja=Qa.x,bb=Qa.y,H=Qa.width;Qa=Qa.height;return{left:Ja,top:bb,hCenter:Ja+H/2,vCenter:bb+Qa/2,right:Ja+H,bottom:bb+Qa,width:H,height:Qa}};Ub.findEdgesInAlignment=function(Qa,Ja,bb,H,aa,Ma,tb,Lb,uc,hd){bb=void 0===bb?15:bb;Ma=void 0===Ma?0:Ma;tb=void 0===tb?0:tb;Lb=void 0===Lb?0:Lb;uc=void 0===uc?0:uc;hd=void 0===hd?0:hd;for(var yd=[],Jc=[],Fd=0;Fd<Ub.edges.length;Fd++){var Yd=$jscomp.makeIterator(Ub.edges[Fd]),
ie=Yd.next().value,ue=Yd.next().value;Yd=Yd.next().value;var Ye=Qa[ue],Db=Ja[Yd],Lf=Math.max(Ye,Db)-Math.min(Ye,Db);Lf>bb||!(H&&!H.includes(ue)||aa&&!aa.includes(Yd))&&("vertical"===ie?yd:Jc).push({delta:Lf,edgeA:ue,edgeB:Yd,edgeAVal:Ye,edgeBVal:Db,refPointsA:Qa,refPointsB:Ja,distLeft:Ma,distTop:tb,distRight:Lb,distBottom:uc,maxDist:hd})}return yd.length||Jc.length?{vertical:yd,horizontal:Jc}:null};Ub.findAlignedMorphs=function(Qa,Ja,bb,H,aa,Ma){bb=void 0===bb?15:bb;H=void 0===H?Infinity:H;for(var tb,
Lb=Ub.computeRefPoints(Qa.bounds()),uc=0;uc<Ja.length;uc++){var hd=Ja[uc];if(hd!==Qa){var yd=Ub.computeRefPoints(hd.bounds()),Jc=Math.max(0,Lb.left-yd.right),Fd=Math.max(0,yd.left-Lb.right),Yd=Math.max(0,Lb.top-yd.bottom),ie=Math.max(0,yd.top-Lb.bottom);Math.max(ie,Yd,Fd,Jc)>H||!(yd=Ub.findEdgesInAlignment(Lb,yd,bb,aa,Ma,Jc,Yd,Fd,ie,Math.max(ie,Yd,Fd,Jc)))||(tb||(tb=new Map),tb.set(hd,yd))}}Qa=Qa.owner;Ja=Ub.computeRefPoints(Qa.innerBounds());if(bb=Ub.findEdgesInAlignment(Lb,Ja,bb))tb||(tb=new Map),
tb.set(Qa,bb);return tb};Ub.findMorphsWithSimilarWidthOrHeight=function(Qa,Ja,bb,H,aa){H=void 0===H?15:H;aa=void 0===aa?Infinity:aa;for(var Ma,tb=Ub.computeRefPoints(Qa.bounds()),Lb=0;Lb<bb.length;Lb++){var uc=bb[Lb];if(uc!==Qa){var hd=Ub.computeRefPoints(uc.bounds()),yd=Math.max(0,tb.left-hd.right),Jc=Math.max(0,hd.left-tb.right),Fd=Math.max(0,tb.top-hd.bottom),Yd=Math.max(0,hd.top-tb.bottom),ie=Math.min(Yd,Fd,Jc,yd),ue=Math.max(Yd,Fd,Jc,yd);if(!(Math.max(Yd,Fd,Jc,yd)>aa)){Jc=tb;yd=Jc.width;Jc=Jc.height;
Yd=hd;Fd=Yd.width;Yd=Yd.height;var Ye=Fd-yd,Db=Yd-Jc;("x"===Ja||"xy"===Ja)&&Math.abs(Ye)<=H&&(Ma||(Ma=new Map),Ma.set(uc,{similarIn:"width",minDist:ie,maxDist:ue,refPointsA:tb,refPointsB:hd,valA:yd,valB:Fd,delta:Ye}));("y"===Ja||"xy"===Ja)&&Math.abs(Db)<=H&&(Ma||(Ma=new Map),Ma.set(uc,{similarIn:"height",minDist:ie,maxDist:ue,refPointsA:tb,refPointsB:hd,valA:Jc,valB:Yd,delta:Db}))}}}return Ma};Ub.closest=function(Qa,Ja,bb,H,aa,Ma,tb,Lb){Lb=void 0===Lb?!0:Lb;var uc=H[Qa],hd=aa[Qa],yd=Ma[Qa];Ja=tb[Qa];
for(var Jc,Fd,Yd,ie,ue=0;ue<aa.length;ue++)Qa===ue||uc<aa[ue]||Jc&&aa[Jc.index]>=aa[ue]||Lb&&tb[Qa]<Ma[ue]||Ma[Qa]>tb[ue]||(Jc={index:ue,dist:uc-aa[ue],refPointsA:bb[Qa],refPointsB:bb[ue]});for(uc=0;uc<H.length;uc++)Qa===uc||hd>H[uc]||Fd&&H[Fd.index]<=H[uc]||Lb&&tb[Qa]<Ma[uc]||Ma[Qa]>tb[uc]||(Fd={index:uc,dist:H[uc]-hd,refPointsA:bb[Qa],refPointsB:bb[uc]});for(hd=0;hd<tb.length;hd++)Qa===hd||yd<tb[hd]||Yd&&tb[Yd.index]>=tb[hd]||Lb&&H[Qa]>aa[hd]||aa[Qa]<H[hd]||(Yd={index:hd,dist:yd-tb[hd],refPointsA:bb[Qa],
refPointsB:bb[hd]});for(tb=0;tb<Ma.length;tb++)Qa===tb||Ja>Ma[tb]||ie&&Ma[ie.index]<=Ma[tb]||Lb&&H[Qa]>aa[tb]||aa[Qa]<H[tb]||(ie={index:tb,dist:Ma[tb]-Ja,refPointsA:bb[Qa],refPointsB:bb[tb]});return{l:Jc,r:Fd,t:Yd,b:ie}};Ub.computeClosestMorphs=function(Qa){for(var Ja=[],bb=[],H=[],aa=[],Ma=[],tb=[],Lb=0;Lb<Qa.length;Lb++){var uc=Ub.computeRefPoints(Qa[Lb].bounds());Ma.push(uc);var hd=uc.right,yd=uc.top,Jc=uc.bottom;Ja.push(uc.left);bb.push(hd);H.push(yd);aa.push(Jc)}for(Lb=0;Lb<Qa.length;Lb++)tb.push(Ub.closest(Lb,
Qa,Ma,Ja,bb,H,aa));return tb};Ub.fun=cb;Ub.pt=mb;Ub.Color=Sb;Ub.morph=Jb;Ub.cachedGuideLines=new WeakMap;Ub.guideWidth=1;Ub.guideColor=Ub.Color.orange.lighter();Ub.removeSnapToGuidesOf=da;Ub.removeSnapToGuidesOf=da;Ub.showAndSnapToGuides=Ia;Ub.showAndSnapToGuides=Ia;Ub.showAndSnapToResizeGuides=Wa;Ub.showAndSnapToResizeGuides=Wa;Ub.edges=[["vertical","top","top"],["vertical","vCenter","top"],["vertical","bottom","top"],["vertical","top","vCenter"],["vertical","vCenter","vCenter"],["vertical","bottom",
"vCenter"],["vertical","top","bottom"],["vertical","vCenter","bottom"],["vertical","bottom","bottom"],["horizontal","left","left"],["horizontal","hCenter","left"],["horizontal","right","left"],["horizontal","left","hCenter"],["horizontal","hCenter","hCenter"],["horizontal","right","hCenter"],["horizontal","left","right"],["horizontal","hCenter","right"],["horizontal","right","right"]];var vb=lively.FreezerRuntime.recorderFor("lively.halos/markers.js");vb.show=Zb;vb.showRect=function(Qa,Ja,bb){var H=
vb.BoundsMarker.highlightBounds(Ja);return bb?vb.showInLoop(Qa,H,Ja):vb.showThenHide(Qa,H)};vb.showInLoop=function(Qa,Ja,bb){var H;return $jscomp.asyncExecutePromiseGeneratorProgram(function(aa){switch(aa.nextAddress){case 1:return vb.showThenHide(Qa,Ja,!1),aa.yield(vb.promise.delay(300),2);case 2:H=!1,vb.once(Qa,"onMouseDown",function(){return H=!0}),vb.once(Qa,"hideMarkers",function(){return H=!0});case 3:if(H){aa.jumpTo(4);break}return aa.yield(Ja.retract(bb),3);case 4:Ja.fadeOut(2E3),aa.jumpToEnd()}})};
vb.showThenHide=function(Qa,Ja,bb){bb=void 0===bb?3:bb;if(Qa){var H=Array.isArray(Ja)?Ja:[Ja];H.forEach(function(aa){return Qa.addMorph(aa)});bb&&setTimeout(function(){return H.forEach(function(aa){return aa.fadeOut(2E3)})},1E3*bb);return Ja}};vb.showLine=function(Qa,Ja,bb){bb=void 0===bb?3E3:bb;var H=Ja.start;Ja=Ja.end.subPt(H);var aa=Qa.addMorph({position:H,rotation:Ja.theta(),border:{width:1,color:vb.Color.red},width:Ja.fastR(),height:0});bb&&setTimeout(function(){return aa.fadeOut()},bb);return aa};
vb.showConnector=Oc;vb.obj=sd;vb.promise=vc;vb.string=wd;vb.pt=mb;vb.Color=Sb;vb.Rectangle=wc;vb.rect=Cc;vb.morph=Jb;vb.easings=Gc;vb.Path=Cd;vb.Icon=pe;vb.Morph=Je;vb.MorphicEnv=ce;vb.connect=Qb;vb.once=pc;vb.disconnect=ld;vb.show=Zb;vb.show=Zb;(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),bb=Ja.hasOwnProperty("BoundsMarker")&&"function"===typeof Ja.BoundsMarker?Ja.BoundsMarker:Ja.BoundsMarker=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Rb(bb,Qa,[{key:Symbol.for("lively-instance-initialize"),value:function(){Rb._get(Object.getPrototypeOf(bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{borderWidth:0,fill:vb.Color.transparent,reactsToPointer:!1,hasFixedPosition:!0})}},{key:"isEpiMorph",get:function(){return!0}},{key:"markerLength",value:function(H){H=H.insetBy(-2);H=Math.min(H.width,H.height);return Math.max(4,Math.floor(10>H/10?H/2-5:H/10))}},{key:"createMarkerEdge",value:function(){return vb.morph({fill:vb.Color.red,
reactsToPointer:!1,borderRadius:10})}},{key:"ensureMarkerCorners",value:function(){var H=this.topLeftH||(this.topLeftH=this.addMorph(this.createMarkerEdge())),aa=this.topLeftV||(this.topLeftV=this.addMorph(this.createMarkerEdge())),Ma=this.topRightH||(this.topRightH=this.addMorph(this.createMarkerEdge())),tb=this.topRightV||(this.topRightV=this.addMorph(this.createMarkerEdge())),Lb=this.bottomRightH||(this.bottomRightH=this.addMorph(this.createMarkerEdge())),uc=this.bottomRightV||(this.bottomRightV=
this.addMorph(this.createMarkerEdge())),hd=this.bottomLeftH||(this.bottomLeftH=this.addMorph(this.createMarkerEdge())),yd=this.bottomLeftV||(this.bottomLeftV=this.addMorph(this.createMarkerEdge()));return[H,aa,Ma,tb,Lb,uc,hd,yd]}},{key:"alignWithMorph",value:function(H){return this.alignWithBounds(H.globalBounds().translatedBy($world.scroll.negated()))}},{key:"alignWithBounds",value:function(H){this.alignWithRect(H.insetBy(-20));return this.alignWithRect(H,!0)}},{key:"alignWithRect",value:function(H,
aa){var Ma=this.ensureMarkerCorners(),tb=this.markerLength(H),Lb=[H.topLeft().addXY(0,0).extent(vb.pt(tb,5)),H.topLeft().addXY(0,0).extent(vb.pt(5,tb)),H.topRight().addXY(-tb,0).extent(vb.pt(tb,5)),H.topRight().addXY(-5,0).extent(vb.pt(5,tb)),H.bottomRight().addXY(-5,-tb).extent(vb.pt(5,tb)),H.bottomRight().addXY(-tb,-5).extent(vb.pt(tb,5)),H.bottomLeft().addXY(0,-5).extent(vb.pt(tb,5)),H.bottomLeft().addXY(0,-tb).extent(vb.pt(5,tb))];Ma.forEach(function(uc,hd){return uc.setBounds(Lb[hd])});aa&&(this.adjustOrigin(H.center()),
this.opacity=0,this.scale=1.5,this.animate({opacity:1,scale:1,duration:300}));return this}},{key:"retract",value:function(H){var aa=this,Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress)return tb.yield(aa.animate({scale:Math.max(30/H.width,1.05)}),2);Ma=aa.center;return tb.yield(aa.animate({center:Ma,scale:1,duration:300,easing:vb.easings.inOutExpo}),0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BoundsMarker"}},{key:"highlightMorph",value:function(H){return(new this).alignWithMorph(H)}},
{key:"highlightBounds",value:function(H){return(new this).alignWithBounds(H)}}],Ja,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:2332,end:6009})})(vb.Morph);var pd=ta("S",function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),bb=Ja.hasOwnProperty("StatusMessage")&&
"function"===typeof Ja.StatusMessage?Ja.StatusMessage:Ja.StatusMessage=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"relayout",value:function(){this.title=vb.string.truncate(this.message,(this.width/15).toFixed(),"...")}},{key:"isEpiMorph",value:function(){return!0}},{key:"isStatusMessage",value:function(){return!0}},{key:"setMessage",value:function(H,aa){this.message=H;this.color=aa}},{key:"slideTo",
value:function(H){var aa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){if(1==Ma.nextAddress)return aa.sliding=aa.animate({position:H,duration:500}),Ma.yield(aa.sliding,2);aa.sliding=!1;Ma.jumpToEnd()})}},{key:"expand",value:function(){var H=this,aa,Ma,tb,Lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(uc){if(1==uc.nextAddress)return H.expandable?H.sliding?uc.yield(H.sliding,2):uc.jumpTo(2):uc.return();aa=H.world();if(!aa||H.isMaximized)return uc.return();H.isMaximized=
!0;H.stayOpen=!0;Ma=H.getSubmorphNamed("message text");Ma.lineWrapping=!1;Object.assign(Ma,{clipMode:"auto",fixedWidth:!0,selectable:!0});H.expandedContent&&(Ma.value=H.expandedContent);Ma.fit();tb=Ma.textBounds().extent();Lb=aa.visibleBounds();tb.y>Lb.extent().y&&(tb.y=Lb.extent().y-20);tb.x>Lb.extent().x&&(tb.x=Lb.extent().x-20);tb=H.extent.maxPt(tb);H.animate({extent:tb,center:Lb.center(),duration:200});H.relayout();H.focus();uc.jumpToEnd()})}},{key:"fit",value:function(){var H=this.getSubmorphNamed("message text");
H&&(this.extent=vb.pt(100,35).maxPt(H.textBounds().extent()),this.relayout())}},{key:"focus",value:function(){var H=this.getSubmorphNamed("message text");H&&H.focus()}},{key:"onMouseUp",value:function(H){this.expand()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessage"}},{key:"properties",get:function(){return{extent:{defaultValue:vb.pt(200,100)},stayOpen:{defaultValue:!1},slidable:{defaultValue:!0},isMaximized:{defaultValue:!1},expandable:{initialize:function(){this.expandable=
!0}},maxLines:{defaultValue:Infinity},name:{defaultValue:"messageMorph"},master:{initialize:function(){this.master={auto:"styleguide://System/message"}}},message:{after:["submorphs","extent"],set:function(H){this.setProperty("message",H);var aa=this.getSubmorphNamed("message text");if(aa){aa.value=H;var Ma=aa.documentEndPosition;Ma.row>this.maxLines&&(aa.replace({start:{row:this.maxLines,column:0},end:Ma},"...\n"),this.expandedContent||(this.expandedContent=H));Ma=aa.documentEndPosition;0!==Ma.column&&
aa.insertText("\n",Ma)}}},title:{isStyleProp:!0,derived:!0,set:function(H){this.getSubmorphNamed("message title").value=H},get:function(){return this.getSubmorphNamed("message title").value}},color:{after:["submorphs"],derived:!0,get:function(){return this.get("message icon").fontColor},set:function(H){this.get("message icon").fontColor=H;this.get("message icon")._parametrizedProps&&(this.get("message icon")._parametrizedProps.fontColor=H)}},submorphs:{after:["extent"],initialize:function(){this.submorphs=
[{name:"message icon",type:"label",value:vb.Icon.textAttribute("check-circle")},{name:"message text",type:"text"},{name:"message title",type:"label"},{name:"close button",type:"button"}];vb.connect(this.getSubmorphNamed("close button"),"fire",this,"remove");vb.connect(this,"extent",this,"relayout")}}}}}],Ja,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:6053,end:10382})}(vb.Morph));vb.StatusMessage=pd;vb.StatusMessage=pd;vb.StatusMessage=pd;var $c=ta("b",function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/markers.js"),bb=Ja.hasOwnProperty("StatusMessageForMorph")&&"function"===typeof Ja.StatusMessageForMorph?Ja.StatusMessageForMorph:Ja.StatusMessageForMorph=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"alignAtBottomOf",
value:function(H){var aa=this.world();aa&&(this.bringToFront(),this.fit(),this.width=H.bounds().width,this.relayout(),H.world()&&(this.position=H.owner.worldPoint(H.bounds().bottomLeft())),H=aa.visibleBounds(),H=this.bounds().top()+this.height-H.bottom(),0<H&&this.moveBy(vb.pt(0,-H)))}},{key:"onMouseUp",value:function(H){}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StatusMessageForMorph"}},{key:"properties",get:function(){return{slidable:{defaultValue:!1},renderOnGPU:{defaultValue:!0},
removeOnTargetMorphChange:{defaultValue:!0},targetMorph:{defaultValue:null,get:function(){var H=this.getProperty("targetMorph");return H&&$world.getMorphWithId(H)},set:function(H){this.setProperty("targetMorph",H?H.id:null);this.alignAtBottomOf(H)}},expandable:{after:["submorphs"],set:function(H){this.setProperty("expandable",H);if(H){var aa=this.getSubmorphNamed("expand button")||this.addMorph({name:"expand button",type:"button"});vb.connect(aa,"fire",this,"expand")}else this.getSubmorphNamed("expand button")&&
(this.getSubmorphNamed("expand button").remove(),vb.disconnect(aa,"fire",this,"expand"))}}}}}],Ja,{pathInPackage:function(){return"markers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:10607,end:12475})}(vb.StatusMessage));vb.StatusMessageForMorph=$c;vb.StatusMessageForMorph=$c;vb.StatusMessageForMorph=$c;vb.showConnector=Oc;vb.showConnector=
Oc;var Sa=lively.FreezerRuntime.recorderFor("lively.halos/morph.js");Sa.Morph=Je;Sa.Label=xd;Sa.StyleSheet=Hd;Sa.HorizontalLayout=Dc;Sa.Path=Cd;Sa.Text=bc;Sa.GridLayout=Ib;Sa.morph=Jb;Sa.Icon=pe;Sa.createMorphSnapshot=gc;Sa.Color=Sb;Sa.pt=mb;Sa.rect=Cc;Sa.Rectangle=wc;Sa.LinearGradient=sc;Sa.obj=sd;Sa.PropertyPath=dd;Sa.promise=vc;Sa.properties=bd;Sa.num=oc;Sa.arr=$a;Sa.connect=Qb;Sa.signal=fb;Sa.disconnect=ld;Sa.disconnectAll=ya;Sa.once=pc;Sa.showAndSnapToGuides=Ia;Sa.showAndSnapToResizeGuides=Wa;
Sa.removeSnapToGuidesOf=da;Sa.resource=Ca;Sa.show=Zb;Sa.haloBlue=Sa.Color.rgb(23,160,251);Sa.componentAccent=Sa.Color.magenta;Sa.derivedAccent=Sa.Color.purple;var nb=function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("Halo")&&"function"===typeof Ja.Halo?Ja.Halo:Ja.Halo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"relayout",value:function(){this.alignWithTarget()}},
{key:"keybindings",get:function(){return[{keys:{mac:"Meta-C",win:"Ctrl-C"},command:{command:"clipboard copy",passEvent:!0}}]}},{key:"commands",get:function(){return[{name:"clipboard copy",doc:"copy selected morph(s) to clipboard",scrollCursorIntoView:!1,exec:function(H){H.copyHalo().copyToClipBoard()}}]}},{key:"removeIfDetached",value:function(){var H=this;setTimeout(function(){H.target.owner||H.remove()})}},{key:"initLayout",value:function(){var H=this.layout=new Sa.GridLayout({autoAssign:!1,fitToCell:!1,
columns:[0,{fixed:36,paddingRight:10},2,{fixed:26},4,{fixed:26},6,{fixed:36,paddingLeft:10}],rows:[0,{fixed:36,paddingBottom:10},2,{fixed:26},4,{fixed:26},6,{fixed:26},7,{fixed:36,paddingTop:10}],grid:[["menu",null,"grab",null,"drag",null,"close"],[null,null,null,null,null,null,null],["copy",null,null,null,null,null,"edit"],[null,null,null,null,null,null,null],["component",null,null,null,null,null,"inspect"],[null,null,null,null,null,null,null],["rotate",null,null,null,null,null,"resize"],[null,"name",
"name","name","name","name",null]]});H.col(1).row(7).group.align="center";H.col(1).row(7).group.resize=!1}},{key:"initButtons",value:function(){this.submorphs=[].concat($jscomp.arrayFromIterable(this.ensureResizeHandles()),$jscomp.arrayFromIterable(this.resizeOnly?[]:[this.closeHalo(),this.dragHalo(),this.grabHalo(),this.menuHalo(),this.inspectHalo(),this.editHalo(),this.copyHalo(),this.componentHalo(),this.rotateHalo(),this.nameHalo(),this.originHalo()]))}},{key:"isEpiMorph",get:function(){return!0}},
{key:"isHaloItem",get:function(){return!0}},{key:"isHalo",get:function(){return!0}},{key:"borderBox",get:function(){return this.getSubmorphNamed("border-box")||this.addMorphBack(Sa.morph({name:"border-box",fill:Sa.Color.transparent,borderColor:this.target.isComponent?Sa.componentAccent:Sa.haloBlue,borderWidth:1}))}},{key:"pointerId",get:function(){return this.state?this.state.pointerId:null}},{key:"pointerId",set:function(H){this.state||(this.state={});this.state.pointerId=H}},{key:"prepareTarget",
value:function(H){if(!Sa.obj.isArray(H))return H;if(1>=H.length)return H[0];H=H[0].world().addMorph(new Sa.MultiSelectionTarget({selectedMorphs:H}));H.alignWithSelection();H.modifiesSelectedMorphs=!0;return H}},{key:"refocus",value:function(H){this.target=H;this.alignWithTarget()}},{key:"alignWithTarget",value:function(H){if((!H||["extent","position","scale","rotation"].includes(H.prop))&&!this.active&&this.target){H=this.target.world()||$world;var aa=H.visibleBounds(),Ma=this.target.globalBounds(),
tb=Ma.insetBy(-36).intersection(aa);aa=Ma.intersection(aa);this.layout&&this.layout.disable();this.setBounds(tb.translatedBy(H.scroll.negated()));this.borderBox.setBounds($world.transformRectToMorph(this,aa));this.state.activeButton?(this.buttonControls.forEach(function(Lb){return Lb.visible=!1}),this.ensureResizeHandles().forEach(function(Lb){return Lb.visible=!1}),this.state.activeButton.visible=!0,this.updatePropertyDisplay(this.state.activeButton)):(this.changingName&&this.nameHalo().toggleActive([!1]),
this.ensureResizeHandles().forEach(function(Lb){return Lb.visible=!0}),this.buttonControls.forEach(function(Lb){Lb.visible=!0}),this.propertyDisplay.disable());this.nameHalo().alignInHalo();this.ensureResizeHandles().forEach(function(Lb){return Lb.alignInHalo()});this.resizeOnly||this.originHalo().alignInHalo();this.layout&&this.layout.enable();return this}}},{key:"detachFromTarget",value:function(){var H=this.target;H&&(Sa.disconnect(H,"onChange",this,"alignWithTarget"),Sa.disconnect(H,"onOwnerChanged",
this,"removeIfDetached"),H instanceof Sa.MultiSelectionTarget?(H.modifiesSelectedMorphs=!1,H.remove()):"function"===typeof H.detachedHalo&&H.detachedHalo(this))}},{key:"remove",value:function(){this.detachFromTarget();Rb._get(Object.getPrototypeOf(bb.prototype),"remove",this).call(this)}},{key:"morphsContainingPoint",value:function(H){return H}},{key:"propertyDisplay",get:function(){return Sa.HaloPropertyDisplay.for(this)}},{key:"nameHalo",value:function(){return Sa.NameHaloItem.for(this)}},{key:"closeHalo",
value:function(){return Sa.CloseHaloItem.for(this)}},{key:"grabHalo",value:function(){return Sa.GrabHaloItem.for(this)}},{key:"dragHalo",value:function(){return Sa.DragHaloItem.for(this)}},{key:"menuHalo",value:function(){return Sa.MenuHaloItem.for(this)}},{key:"inspectHalo",value:function(){return Sa.InspectHaloItem.for(this)}},{key:"editHalo",value:function(){return Sa.EditHaloItem.for(this)}},{key:"rotateHalo",value:function(){return Sa.RotateHaloItem.for(this)}},{key:"copyHalo",value:function(){return Sa.CopyHaloItem.for(this)}},
{key:"originHalo",value:function(){return Sa.OriginHaloItem.for(this)}},{key:"componentHalo",value:function(){return Sa.ComponentHaloItem.for(this)}},{key:"buttonControls",get:function(){return this.submorphs.filter(function(H){return H.isHaloItem&&!H.isResizeHandle})}},{key:"addMorphToSelection",value:function(H){var aa=this,Ma,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lb){if(1==Lb.nextAddress){Ma=aa.world();tb=aa.target.isMorphSelection?aa.target.selectedMorphs:[aa.target];
if(tb.includes(H))return Lb.return();aa.remove();return Lb.yield(Ma.showHaloForSelection([].concat($jscomp.arrayFromIterable(tb),[H]),aa.state.pointerId),2)}return Lb.return(Lb.yieldResult)})}},{key:"removeMorphFromSelection",value:function(H){var aa=this,Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress){Ma=aa.world();aa.remove();if(!aa.target.isMorphSelection)return tb.jumpTo(0);Sa.arr.remove(aa.target.selectedMorphs,H);return tb.yield(Ma.showHaloForSelection(aa.target.selectedMorphs,
aa.state.pointerId),3)}return tb.return(tb.yieldResult)})}},{key:"isAlreadySelected",value:function(H){return this.target==H||this.target.isMorphSelection&&this.target.selectsMorph(H)}},{key:"updateBoundsFor",value:function(H,aa,Ma,tb,Lb){var uc={topLeft:Sa.rect(-1,-1,1,1),topCenter:aa?Sa.rect(1,-1,0,1):Sa.rect(0,-1,0,1),topRight:Sa.rect(0,-1,1,1),rightCenter:aa?Sa.rect(0,1,1,1):Sa.rect(0,0,1,0),bottomRight:Sa.rect(0,0,1,1),bottomCenter:aa?Sa.rect(1,0,0,1):Sa.rect(0,0,0,1),bottomLeft:Sa.rect(-1,0,
1,1),leftCenter:aa?Sa.rect(-1,1,1,0):Sa.rect(-1,0,1,0)}[H];Lb=uc.x;var hd=uc.y,yd=uc.width;uc=uc.height;Ma=aa?this.proportionalDelta(H,Ma,tb):Ma;H=Sa.rect(Ma.x*Lb,Ma.y*hd,Ma.x*yd,Ma.y*uc);this.active=!0;this.target.setBounds(tb.insetByRect(H));(this.target.isPolygon||this.target.isPath)&&this.target.moveBy(this.target.origin.negated());this.active=!1;this.alignWithTarget();this.world().withTopBarDo(function(Jc){if(Jc.activeSideBars.includes("Styling Palette"))Jc.stylingPalette.onHierarchyChange()})}},
{key:"proportionalDelta",value:function(H,aa,Ma){var tb=Ma.width,Lb=Ma.height;Ma={topLeft:Sa.pt(-1,-1),topCenter:Sa.pt(0,-1),topRight:Sa.pt(1,-1),leftCenter:Sa.pt(-1,0),rightCenter:Sa.pt(1,0),bottomLeft:Sa.pt(-1,1),bottomCenter:Sa.pt(0,1),bottomRight:Sa.pt(1,1)};var uc=tb/Math.max(tb,Lb),hd=Lb/Math.max(Lb,tb);tb={topLeft:Sa.pt(-uc,-hd),topCenter:Sa.pt(1/(2*Lb/tb),-1),topRight:Sa.pt(uc,-hd),leftCenter:Sa.pt(-1,Lb/(2*tb)),rightCenter:Sa.pt(1,Lb/(3*tb)),bottomLeft:Sa.pt(-uc,hd),bottomCenter:Sa.pt(1/
(2*Lb/tb),1),bottomRight:Sa.pt(uc,hd)};Ma=Ma[H];return tb[H].scaleBy(Ma.dotProduct(aa)/Ma.dotProduct(Ma))}},{key:"ensureResizeHandles",value:function(){return Sa.ResizeHandle.resizersFor(this)}},{key:"updatePropertyDisplay",value:function(H){H=H.valueForPropertyDisplay();"undefined"!==typeof H?this.propertyDisplay.displayProperty(H):this.propertyDisplay.disable()}},{key:"toggleDiagonal",value:function(H,aa){if(!Sa.rect(0).sides.includes(aa)){var Ma=this.getSubmorphNamed("diagonal");if(H){H=this.target.globalBounds();
var tb=H.width,Lb=H.height;H=this.localize(Sa.pt(H.x,H.y)).extent(Sa.pt(tb,Lb)).scaleRectTo(this.innerBounds());tb={topLeft:[Sa.pt(tb,Lb),Sa.pt(0,0)],topRight:[Sa.pt(0,Lb),Sa.pt(tb,0)],bottomRight:[Sa.pt(0,0),Sa.pt(tb,Lb)],bottomLeft:[Sa.pt(tb,0),Sa.pt(0,Lb)]};Ma?Ma.setBounds(H):(Ma=$jscomp.makeIterator(tb[aa]),aa=Ma.next().value,Ma=Ma.next().value,tb=new Sa.LinearGradient({stops:[{offset:0,color:Sa.Color.orange.withA(0)},{offset:.2,color:Sa.Color.orange},{offset:.8,color:Sa.Color.orange},{offset:1,
color:Sa.Color.orange.withA(0)}]}),Ma=this.addMorphBack(new Sa.Path({opacity:0,name:"diagonal",borderStyle:"dotted",borderWidth:5,bounds:H,borderColor:tb,vertices:[aa,Ma]})),Ma.setBounds(H),Ma.animate({opacity:1,duration:500}))}else Ma&&Ma.fadeOut(500)}}},{key:"toggleRotationIndicator",value:function(H,aa){var Ma=this.getSubmorphNamed("rotationIndicator");H&&aa?(H=this.getSubmorphNamed("origin").center,Ma=Ma||this.addMorphBack(new Sa.Path({name:"rotationIndicator",borderColor:Sa.haloBlue,borderWidth:1,
vertices:[]})),Ma.setBounds(aa.bounds().union(this.innerBounds())),Ma.vertices=[Ma.localizePointFrom(H,this),Ma.localizePointFrom(aa.center,this)]):Ma&&Ma.remove()}},{key:"toggleMorphHighlighter",value:function(H,aa,Ma){Ma=void 0===Ma?!1:Ma;if(aa)if(aa.onHaloGrabover)aa.onHaloGrabover(H);else Ma=Sa.MorphHighlighter.for(this,aa,Ma),H&&aa&&aa!=this.world()?Ma&&Ma.show(aa):Ma&&Ma.deactivate()}},{key:"onMouseDown",value:function(H){var aa=H.state.clickedOnMorph;if(!H.isCommandKey()&&aa==this.borderBox)return this.remove();
if(H.isShiftDown()&&H.isCommandKey())H=this.target.isMorphSelection?this.target.morphBeneath(H.position):this.morphBeneath(H.position),this.isAlreadySelected(H)?this.removeMorphFromSelection(H):this.addMorphToSelection(H);else{if(aa==this.borderBox&&H.isCommandKey()){var Ma=H.world.morphsContainingPoint(H.position).filter(function(tb){return tb.halosEnabled});(Ma=Ma.slice(Ma.indexOf(this.target)+1)[0]||Ma[0]||H.world)&&H.world.showHaloFor(Ma,H.domEvt.pointerId);this.remove()}aa==this&&H.isCommandKey()&&
(Ma=this.morphBeneath(H.position),H.world.showHaloFor(Ma,H.domEvt.pointerId));aa==this&&this.remove()}}},{key:"onContextMenu",value:function(H){var aa=this;Promise.resolve($world.defaultMenuItems(this.target)).then(function(Ma){return aa.target.openMenu(Ma,H)}).catch(function(Ma){return $world.logError(Ma)})}},{key:"onKeyUp",value:function(H){this.changingName||this.buttonControls.map(function(aa){return aa.onKeyUp(H)})}},{key:"getMesh",value:function(H,aa){var Ma=H.x;H=H.y;aa=void 0===aa?Sa.pt(0,
0):aa;var tb=this.world().visibleBounds(),Lb=tb.height;tb=tb.width;var uc={borderStyle:"dotted",borderWidth:2,borderColor:Sa.Color.orange};uc=this.get("mesh")||this.addMorph(new Sa.Morph({name:"mesh",styleClasses:["halo-mesh"],extent:Sa.pt(tb,Lb),fill:null,submorphs:[new Sa.Path(Object.assign({name:"vertical"},uc)),new Sa.Path(Object.assign({name:"horizontal"},uc))]}));uc.globalPosition=aa;uc.getSubmorphNamed("vertical").vertices=[Sa.pt(Ma,0).subPt(aa),Sa.pt(Ma,Lb).subPt(aa)];uc.getSubmorphNamed("horizontal").vertices=
[Sa.pt(0,H).subPt(aa),Sa.pt(tb,H).subPt(aa)];return uc}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Halo"}},{key:"properties",get:function(){return{fill:{defaultValue:Sa.Color.transparent},resizeOnly:{defaultValue:!1},pointerId:{},hasFixedPosition:{defaultValue:!0},respondsToVisibleWindow:{defaultValue:!0},submorphs:{after:["target"],initialize:function(){this.initButtons();this.alignWithTarget()}},layout:{after:["submorphs"],initialize:function(){this.initLayout()}},hasTinyTarget:{derived:!0,
get:function(){return 40>this.target.bounds().extent().dist(Sa.pt(0))}},target:{get:function(){return this.state?this.state.target:null},set:function(H){this.state||(this.state={});var aa=!!this.state.target;this.detachFromTarget();H=this.prepareTarget(H);this.state.target=H;aa&&this.alignWithTarget();Sa.connect(H,"onChange",this,"alignWithTarget");Sa.connect(H,"onOwnerChanged",this,"removeIfDetached")}}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:979,end:17523})}(Sa.Morph);nb=Sa.Halo;var tc=ta("H",nb);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("HaloPropertyDisplay")&&"function"===typeof Ja.HaloPropertyDisplay?Ja.HaloPropertyDisplay:Ja.HaloPropertyDisplay=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Rb(bb,Qa,[{key:"isHaloItem",get:function(){return!1}},{key:"halo",get:function(){return this.owner}},{key:"displayedValue",value:function(){return this.textString}},{key:"displayProperty",value:function(H){var aa=this.halo.state.activeButton;H=String(H);this.visible=!0;this.textString=H;this.position=this.constructor.defaultPosition;this.bounds().insetBy(10).intersects(aa.bounds())&&(this.position=Sa.pt(aa.topRight.x+10,this.position.y))}},{key:"disable",value:function(){this.position=
this.constructor.defaultPosition;this.visible=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"HaloPropertyDisplay"}},{key:"morphName",get:function(){return"propertyDisplay"}},{key:"defaultPosition",get:function(){return Sa.pt(25,0)}},{key:"for",value:function(H){return H.getSubmorphNamed(this.morphName)||H.addMorph(new this({name:this.morphName}))}},{key:"properties",get:function(){return{name:{defaultValue:this.name},fill:{defaultValue:Sa.Color.black.withA(.7)},borderRadius:{defaultValue:7},
padding:{defaultValue:Sa.Rectangle.inset(5)},visible:{defaultValue:!1},readOnly:{defaultValue:!0},fontSize:{defaultValue:12},fontColor:{defaultValue:Sa.Color.white},position:{defaultValue:this.defaultPosition}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:17713,end:19051})})(Sa.Label);
(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("MultiSelectionTarget")&&"function"===typeof Ja.MultiSelectionTarget?Ja.MultiSelectionTarget:Ja.MultiSelectionTarget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"isHaloItem",get:function(){return!0}},{key:"isMorphSelection",get:function(){return!0}},{key:"selectsMorph",value:function(H){return this.selectedMorphs.includes(H)}},
{key:"alignWithSelection",value:function(){var H=this.selectedMorphs.map(function(aa){return aa.globalBounds()}).reduce(function(aa,Ma){return aa.union(Ma)});this.setBounds(H)}},{key:"onGrab",value:function(H){this.grabbingHand=H.hand;this.selectionGrabbed=!0;H.hand.grab(this.selectedMorphs);Sa.once(H.hand,"dropMorphsOn",this,"onGrabEnd");Sa.connect(H.hand,"position",this,"alignWithSelection")}},{key:"onGrabEnd",value:function(){this.selectionGrabbed=!1;Sa.disconnectAll(this.grabbingHand)}},{key:"updateExtent",
value:function(H){var aa=H.value.subPt(H.prevValue);this.selectedMorphs.forEach(function(Ma){return Ma.resizeBy(aa)})}},{key:"updatePosition",value:function(H){if(!this.selectionGrabbed){var aa=H.value.subPt(H.prevValue);this.selectedMorphs.forEach(function(Ma){return Ma.moveBy(aa)})}}},{key:"updateRotation",value:function(H){var aa=this,Ma=H.value-H.prevValue;this.selectedMorphs.forEach(function(tb){var Lb=tb.origin;tb.adjustOrigin(tb.localize(aa.worldPoint(Sa.pt(0,0))));tb.rotation+=Ma;tb.adjustOrigin(Lb)})}},
{key:"updateScale",value:function(H){var aa=this,Ma=H.value-H.prevValue;this.selectedMorphs.forEach(function(tb){var Lb=tb.origin;tb.adjustOrigin(tb.localize(aa.worldPoint(Sa.pt(0,0))));tb.scale+=Ma;tb.adjustOrigin(Lb)})}},{key:"onChange",value:function(H){Rb._get(Object.getPrototypeOf(bb.prototype),"onChange",this).call(this,H);if(this.modifiesSelectedMorphs){switch(H.prop){case "extent":this.updateExtent(H);break;case "scale":this.updateScale(H);break;case "position":this.updatePosition(H);break;
case "rotation":this.updateRotation(H)}return H}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MultiSelectionTarget"}},{key:"properties",get:function(){return{visible:{defaultValue:!1},modifiesSelectedMorphs:{defaultValue:!1},selectedMorphs:{defaultValue:[]},halosEnabled:{defaultValue:!1}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:19119,end:21390})})(Sa.Morph);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("HaloItem")&&"function"===typeof Ja.HaloItem?Ja.HaloItem:Ja.HaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"isEpiMorph",get:function(){return!0}},{key:"isHaloItem",get:function(){return!0}},
{key:"menuItems",value:function(){return[]}},{key:"init",value:function(){}},{key:"update",value:function(){}},{key:"stop",value:function(){}},{key:"valueForPropertyDisplay",value:function(){}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"HaloItem"}},{key:"properties",get:function(){return{borderRadius:{defaultValue:15},nativeCursor:{defaultValue:"pointer"},fill:{defaultValue:Sa.Color.gray.withA(.7)},grabbable:{defaultValue:!1},extent:{defaultValue:Sa.pt(24,24)},halo:{}}}},{key:"for",
value:function(H){return H.getSubmorphNamed(this.morphName)||H.addMorph(new this({halo:H,name:this.morphName}))}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:21554,end:22227})})(Sa.Morph);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("NameHolder")&&
"function"===typeof Ja.NameHolder?Ja.NameHolder:Ja.NameHolder=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"onHoverIn",value:function(H){this.highlightOnHover&&this.nameHolder.active&&(this.halo.toggleMorphHighlighter(!0,this.target),this.nameHolder.fontColor=Sa.Color.orange)}},{key:"onHoverOut",value:function(H){this.highlightOnHover&&(this.halo.toggleMorphHighlighter(!1,this.target),this.nameHolder.fontColor=
Sa.Color.darkgray)}},{key:"accept",value:function(){this.target.name!==this.nameHolder.textString&&this.updateName(this.nameHolder.textString)}},{key:"onKeyDown",value:function(H){"Enter"==H.keyCombo?(this.accept(),this.halo.focus(),H.stop()):Rb._get(Object.getPrototypeOf(bb.prototype),"onKeyDown",this).call(this,H)}},{key:"onMouseUp",value:function(){Sa.signal(this,"active",[!0,this])}},{key:"onMouseDown",value:function(H){this.nameHolder.fontColor=Sa.Color.white;this.halo.toggleMorphHighlighter(!1,
this.target)}},{key:"onKeyUp",value:function(H){H=this.nameHolder.textString;var aa=this.target.owner;this.validName=!aa||!aa.getSubmorphNamed(H)||this.target.name==H;Sa.signal(this,"valid",[this.validName,H])}},{key:"update",value:function(){var H=this;this.nameHolder.textString!==this.target.name&&(this.nameHolder.textString=this.target.name,this.whenRendered().then(function(){return H.nameHolder.fit()}))}},{key:"activate",value:function(){this.nameHolder.readOnly=!1;this.nameHolder.active=!0;this.nameHolder.animate({opacity:1})}},
{key:"deactivate",value:function(){this.nameHolder.readOnly=!0;this.nameHolder.active=!1;this.nameHolder.animate({opacity:.3})}},{key:"updateName",value:function(H){if(!this.forceUniqueName||this.validName)this.target.name=H,Sa.signal(this,"active",[!1,this])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHolder"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Click to edit the morph's name"},draggable:{defaultValue:!1},fill:{defaultValue:Sa.Color.transparent},
forceUniqueName:{defaultValue:!1},halo:{},layout:{after:["nameHolder"],initialize:function(){this.layout=new Sa.HorizontalLayout({resizeContainer:!0,spacing:7})}},nameHolder:{after:["submorphs"],initialize:function(){this.nameHolder=this.addMorph(new Sa.Text({fill:Sa.Color.transparent,fontColor:Sa.Color.white,fontWeight:"bold",active:!0}));Sa.connect(this.nameHolder,"onBlur",this,"accept")}}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:22262,end:24844})})(Sa.Morph);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("NameHaloItem")&&"function"===typeof Ja.NameHaloItem?Ja.NameHaloItem:Ja.NameHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,
[{key:Symbol.for("lively-instance-initialize"),value:function(H){Rb._get(Object.getPrototypeOf(bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,H);this.initComponentLink();this.initNameHolders();this.validityIndicator=Sa.Icon.makeLabel("check",{fontColor:Sa.Color.green,fontSize:15,padding:Sa.rect(4,6,4,0)});this.fill=this.halo.target.isComponent?Sa.componentAccent:Sa.haloBlue;this.alignInHalo()}},{key:"initComponentLink",value:function(){var H=this,aa=this.halo.target;if(aa&&
!aa.isMorphSelection&&aa.master){var Ma=aa.master.determineMaster(aa),tb=Ma&&!!Ma.world(),Lb=Ma?aa.master.getWorldUrlFor(Ma):"this project";aa=this.addMorph(Sa.Icon.makeLabel(Lb?"external-link-alt":"exclamation-triangle",{nativeCursor:"pointer",fontColor:Sa.Color.white,padding:Sa.rect(8,0,-8,0),name:"master link",tooltip:"Located in "+Lb}));Lb&&Sa.connect(aa,"onMouseDown",function(){tb?H.showLocalMaster(Ma):window.open(Lb)})}}},{key:"showLocalMaster",value:function(H){var aa;if(aa=H.getWindow())aa.activate(),
aa.minimized&&(aa.minimized=!1);H.show()}},{key:"targets",value:function(){return this.halo.target?this.halo.target.isMorphSelection?this.halo.target.selectedMorphs.map(function(H){return{target:H,highlightOnHover:!0}}):[{target:this.halo.target,highlightOnHover:!1}]:[]}},{key:"initNameHolders",value:function(){var H=this;this.nameHolders=this.targets().map(function(aa){aa=new Sa.NameHolder({halo:H.halo,highlightOnHover:aa.highlightOnHover,target:aa.target});Sa.connect(aa,"active",H,"toggleActive");
Sa.connect(aa,"valid",H,"toggleNameValid");return aa});this.submorphs=[].concat($jscomp.arrayFromIterable(this.submorphs),$jscomp.arrayFromIterable(Sa.arr.interpose(this.nameHolders,{extent:Sa.pt(1,28),fill:Sa.Color.black.withA(.4)})))}},{key:"toggleActive",value:function(H){var aa=$jscomp.makeIterator(H);H=aa.next().value;var Ma=aa.next().value;if(this.halo.changingName!==H){this.halo.changingName=H;if(aa=this.get("master link"))aa.visible=aa.isLayoutable=!H;H?(this.nameHolders.forEach(function(tb){return tb!=
Ma&&tb.deactivate()}),this.borderWidth=3,this.addMorph(this.validityIndicator),this.fill=Sa.Color.darkGray,setTimeout(function(){return Ma.nameHolder.selectAll()})):(this.fill=Sa.haloBlue,this.nameHolders.forEach(function(tb){return tb!=Ma&&tb.activate()}),this.borderWidth=0,this.validityIndicator.remove());this.alignInHalo()}}},{key:"toggleNameValid",value:function(H){var aa=$jscomp.makeIterator(H);H=aa.next().value;aa=aa.next().value;(this.validName=H)?(this.conflictingMorph=null,this.borderColor=
Sa.Color.green,this.validityIndicator.nativeCursor="auto",this.validityIndicator.fontColor=Sa.Color.green,Sa.Icon.setIcon(this.validityIndicator,"check")):(this.conflictingMorph=this.get(aa),this.borderColor=Sa.Color.red,this.validityIndicator.fontColor=Sa.Color.red,this.validityIndicator.nativeCursor="pointer",Sa.Icon.setIcon(this.validityIndicator,"exclamation-circle"))}},{key:"alignInHalo",value:function(){Sa.arr.zip(this.targets(),this.nameHolders).map(function(aa){var Ma=$jscomp.makeIterator(aa);
aa=Ma.next().value.target;Ma=Ma.next().value;Ma.target=aa;Ma.update()});var H=this.halo.innerBounds().bottomCenter().addPt(Sa.pt(0,2));this.topCenter=Sa.pt(Math.max(H.x,30),Math.max(H.y,80))}},{key:"onMouseDown",value:function(H){var aa=this,Ma=this.conflictingMorph;Ma&&(this.halo.toggleMorphHighlighter(!0,Ma),setTimeout(function(){return aa.halo.toggleMorphHighlighter(!1,Ma)},1E3))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NameHaloItem"}},{key:"morphName",get:function(){return"name"}},
{key:"properties",get:function(){return{borderRadius:{defaultValue:4},fill:{defaultValue:Sa.haloBlue},borderColor:{defaultValue:Sa.Color.green},layout:{initialize:function(){this.layout=new Sa.HorizontalLayout({resizeContainer:!0,spacing:0,align:"center",orderByIndex:!0})}}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:24846,end:29313})})(Sa.HaloItem);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("CloseHaloItem")&&"function"===typeof Ja.CloseHaloItem?Ja.CloseHaloItem:Ja.CloseHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"update",value:function(){var H=this.halo,aa=H.target.owner;aa.undoStart("close-halo");H.target.selectedMorphs?
H.target.selectedMorphs.forEach(function(Ma){return Ma.remove()}):H.target.remove();aa.undoStop("close-halo");H.remove()}},{key:"onMouseDown",value:function(H){this.update()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CloseHaloItem"}},{key:"morphName",get:function(){return"close"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["fas","fa-trash"]},draggable:{defaultValue:!1},tooltip:{defaultValue:"Remove this morph from the world"}}}}],Ja,{pathInPackage:function(){return"morph.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:29315,end:29940})})(Sa.HaloItem);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("GrabHaloItem")&&"function"===typeof Ja.GrabHaloItem?Ja.GrabHaloItem:Ja.GrabHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Rb(bb,Qa,[{key:"adjustTarget",value:function(H,aa){Sa.PropertyPath("owner.layout.autoResize").get(H)&&!H.globalBounds().insetBy(10).containsPoint(aa)&&(H=H.owner);return H}},{key:"valueForPropertyDisplay",value:function(){var H=this.hand,aa=this.halo,Ma=this.prevDropTarget,tb=H.world(),Lb=H.findDropTarget(H.globalPosition,[aa.target],function(uc){return!uc.isHaloItem&&!uc.ownerChain().some(function(hd){return hd.isHaloItem||!hd.visible||0==hd.opacity})});if(Lb)return Lb=this.adjustTarget(Lb,
H.globalPosition),aa.toggleMorphHighlighter(Lb&&Lb!=tb,Lb,!0),Ma&&Ma!=Lb&&aa.toggleMorphHighlighter(!1,Ma),(this.prevDropTarget=Lb)&&Lb.name}},{key:"init",value:function(H){var aa=this.halo,Ma=aa.target.undoStart("grab-halo");Ma&&Ma.addTarget(aa.target.owner);this.hand=H;aa.target.onGrab({halo:aa,hand:H,isShiftDown:function(){return!1}});aa.state.activeButton=this;this.opacity=.3;var tb=Sa.connect(H,"update",this,"update");Sa.once(aa.target,"remove",function(){return tb.disconnect()})}},{key:"stop",
value:function(H){var aa=this.halo,Ma=this.prevDropTarget,tb=aa.target.undoInProgress,Lb=H.hand.findDropTarget(H.hand.globalPosition,[aa.target],function(uc){return!uc.isHaloItem&&!uc.ownerChain().some(function(hd){return hd.isHaloItem})});Lb=this.adjustTarget(Lb,H.hand.globalPosition);Sa.disconnect(H.hand,"update",this,"update");Sa.MorphHighlighter.interceptDrop(aa,Lb,aa.target);tb.addTarget(Lb);Lb.onDrop(H);aa.state.activeButton=null;aa.alignWithTarget();aa.toggleMorphHighlighter(!1,Ma);Sa.MorphHighlighter.removeHighlighters(aa);
aa.target.undoStop("grab-halo");this.opacity=1}},{key:"update",value:function(){this.halo.alignWithTarget()}},{key:"onDragStart",value:function(H){this.init(H.hand)}},{key:"onDragEnd",value:function(H){this.stop(H)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrabHaloItem"}},{key:"morphName",get:function(){return"grab"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["far","fa-hand-rock"]},tooltip:{defaultValue:"Grab the morph"},draggable:{defaultValue:!0}}}}],
Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:29942,end:32470})})(Sa.HaloItem);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("DragHaloItem")&&"function"===typeof Ja.DragHaloItem?Ja.DragHaloItem:Ja.DragHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"valueForPropertyDisplay",value:function(){return this.halo.target.position}},{key:"updateAlignmentGuide",value:function(H){var aa=this.halo.getSubmorphNamed("mesh");if(H)return aa=this.halo.getMesh(this.halo.target.worldPoint(Sa.pt(0,0))),this.focus(),aa;aa&&aa.remove()}},{key:"init",value:function(){var H=this.halo.target;H.undoStart("drag-halo");this.halo.state.activeButton=this;this.actualPos=H.position;
this.targetTransform=H.owner.getGlobalTransform().inverse()}},{key:"stop",value:function(){this.halo.target.undoStop("drag-halo");this.halo.state.activeButton=null;this.halo.alignWithTarget();this.updateAlignmentGuide(!1);Sa.removeSnapToGuidesOf(this.halo.target)}},{key:"update",value:function(H,aa,Ma){aa=void 0===aa?!1:aa;Ma=void 0===Ma?!1:Ma;this.actualPos=H=this.actualPos.addPt(this.targetTransform.transformDirection(H));aa&&(H=H.griddedBy(Sa.pt(10,10)));this.halo.target.position=H;this.updateAlignmentGuide(aa);
this.world().withTopBarDo(function(tb){if(tb.activeSideBars.includes("Styling Palette"))tb.stylingPalette.onHierarchyChange()});aa||Sa.showAndSnapToGuides(this.halo.target,!0,Ma,5,500)}},{key:"onDragStart",value:function(H){this.init()}},{key:"onDrag",value:function(H){this.update(H.state.dragDelta,H.isAltDown(),H.isCtrlDown())}},{key:"onDragEnd",value:function(H){this.stop()}},{key:"onKeyUp",value:function(H){this.updateAlignmentGuide(!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DragHaloItem"}},
{key:"morphName",get:function(){return"drag"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},styleClasses:{defaultValue:["fas","fa-arrows-alt"]},tooltip:{defaultValue:"Change the morph's position. Press (alt) while dragging to align the morph's position along a grid."}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:32472,end:34470})})(Sa.HaloItem);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("InspectHaloItem")&&"function"===typeof Ja.InspectHaloItem?Ja.InspectHaloItem:Ja.InspectHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"onMouseDown",value:function(H){var aa=this;(function(){var Ma,tb,Lb,uc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(hd){if(1==
hd.nextAddress)return hd.yield(System.import("lively.ide/js/inspector.js"),2);Ma=hd.yieldResult;tb=Ma.default;(Lb=aa.world().getSubmorphsByStyleClassName("Inspector").find(function(yd){return yd.targetObject==aa.halo.target}))&&(uc=Lb.getWindow())?(uc.minimized=!1,uc.activate(),uc.animate({center:aa.world().visibleBounds().center(),duration:200})):tb.openInWindow({targetObject:aa.halo.target});aa.halo.remove();hd.jumpToEnd()})})()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectHaloItem"}},
{key:"morphName",get:function(){return"inspect"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Inspect the morph's local state"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-cogs"]}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:34472,end:35389})})(Sa.HaloItem);
(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("EditHaloItem")&&"function"===typeof Ja.EditHaloItem?Ja.EditHaloItem:Ja.EditHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"onMouseDown",value:function(H){var aa=this;(H=this.world().getSubmorphsByStyleClassName("ObjectEditor").find(function(Ma){return Ma.target==aa.halo.target}))?(H=H.getWindow(),
H.bringToFront(),H.minimized=!1,H.animate({center:this.world().visibleBounds().center(),duration:200})):$world.execCommand("open object editor",{target:this.halo.target});this.halo.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditHaloItem"}},{key:"morphName",get:function(){return"edit"}},{key:"properties",get:function(){return{tooltip:{defaultValue:"Edit the morph's definition"},draggable:{defaultValue:!1},styleClasses:{defaultValue:["fas","fa-wrench"]}}}}],Ja,{pathInPackage:function(){return"morph.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:35391,end:36171})})(Sa.HaloItem);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("RotateHaloItem")&&"function"===typeof Ja.RotateHaloItem?Ja.RotateHaloItem:Ja.RotateHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Rb(bb,Qa,[{key:Symbol.for("lively-instance-initialize"),value:function(H){Rb._get(Object.getPrototypeOf(bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,H);this.adaptAppearance(!1)}},{key:"angle",get:function(){return this.getProperty("angle")||0}},{key:"angle",set:function(H){this.setProperty("angle",H)}},{key:"scaleGauge",get:function(){return this.getProperty("scaleGauge")||null}},{key:"scaleGauge",set:function(H){this.setProperty("scaleGauge",H)}},{key:"initRotation",
get:function(){return this.getProperty("initRotation")||0}},{key:"initRotation",set:function(H){this.setProperty("initRotation",H)}},{key:"valueForPropertyDisplay",value:function(){var H=this.halo.target;return this.scaleGauge?H.scale.toFixed(4).toString():Sa.num.toDegrees(H.rotation).toFixed(1)+"\u00b0"}},{key:"init",value:function(H){this.detachFromLayout();this.halo.target.undoStart("rotate-halo");this.halo.state.activeButton=this;this.angle=H;this.initRotation=this.halo.target.rotation;this.halo.toggleRotationIndicator(!0,
this)}},{key:"initScale",value:function(H){this.detachFromLayout();this.halo.state.activeButton=this;this.scaleGauge=H.scaleBy(1/this.halo.target.scale);this.halo.toggleRotationIndicator(!0,this)}},{key:"update",value:function(H){this.scaleGauge=null;H=this.initRotation+(H-this.angle);H=Sa.num.toRadians(Sa.num.detent(Sa.num.toDegrees(H),10,45));this.halo.target.rotation=H;this.halo.toggleRotationIndicator(!0,this)}},{key:"updateScale",value:function(H){var aa=this.scaleGauge,Ma=this.halo;aa||(aa=
this.scaleGauge=H.scaleBy(1/Ma.target.scale));this.angle=H.theta();this.initRotation=Ma.target.rotation;Ma.target.scale=Sa.num.detent(H.dist(Sa.pt(0,0))/aa.dist(Sa.pt(0,0)),.1,.5);Ma.toggleRotationIndicator(!0,this)}},{key:"stop",value:function(){this.attachToLayout();this.scaleGauge=null;this.halo.state.activeButton=null;this.halo.alignWithTarget();this.halo.toggleRotationIndicator(!1,this);this.halo.target.undoStop("rotate-halo");this.halo.ensureResizeHandles()}},{key:"adaptAppearance",value:function(H){this.styleClasses=
["fas",H?"fa-search-plus":"fa-redo"];this.tooltip=H?"Scale morph":"Rotate morph"}},{key:"detachFromLayout",value:function(){this.savedLayout=this.halo.layout;this.halo.layout=null}},{key:"attachToLayout",value:function(){this.halo.layout=this.savedLayout}},{key:"onDragStart",value:function(H){this.adaptAppearance(H.isShiftDown());H.isShiftDown()?this.initScale(H.position.subPt(this.halo.target.globalPosition)):this.init(H.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDrag",value:function(H){this.globalPosition=
H.position.addPt(Sa.pt(-10,-10));this.adaptAppearance(H.isShiftDown());H.isShiftDown()?this.updateScale(H.position.subPt(this.halo.target.globalPosition)):this.update(H.position.subPt(this.halo.target.globalPosition).theta())}},{key:"onDragEnd",value:function(H){this.adaptAppearance(H.isShiftDown());this.stop()}},{key:"onKeyDown",value:function(H){this.adaptAppearance(H.isShiftDown())}},{key:"onKeyUp",value:function(H){this.adaptAppearance(H.isShiftDown())}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"RotateHaloItem"}},{key:"morphName",get:function(){return"rotate"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:36173,end:39650})})(Sa.HaloItem);Sa.nameNumberRe=/(.+)([0-9]+)$/;(function(Qa){var Ja=
lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("ComponentHaloItem")&&"function"===typeof Ja.ComponentHaloItem?Ja.ComponentHaloItem:Ja.ComponentHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"updateComponentIndicator",value:function(){var H=this.world(),aa=this.halo.target;this.halo.remove();H.showHaloFor(aa)}},{key:"checkForDuplicateNamesInHierarchy",value:function(){var H=
this,aa,Ma,tb,Lb,uc,hd,yd,Jc,Fd,Yd,ie,ue;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ye){switch(Ye.nextAddress){case 1:aa=H.halo.target;Ma=H.world();tb=[];aa.withAllSubmorphsDoExcluding(function(Db){Db!=aa&&tb.push(Db)},function(Db){return Db.master&&Db!=aa});Lb=Sa.arr.groupBy(tb,function(Db){return Db.name});uc={fontWeight:"normal",fontSize:16};if(!Object.values(Lb).find(function(Db){return 1<Db.length})){Ye.jumpTo(2);break}hd=Sa.arr.sum(Object.values(Lb).filter(function(Db){return 1<
Db.length}).map(function(Db){return Db.length}));return Ye.yield(Ma.confirm(["Ambigous Names in Submorph Hierarchy  ",{}].concat($jscomp.arrayFromIterable(Sa.Icon.textAttribute("exclamation-triangle",{fontColor:Sa.Color.rgb(230,126,34),fontSize:30,lineHeight:"40px"})),["\nThe morph you are about to turn into a component has "+hd+" morphs within its submorph hierarchy, that have ambigous names. This can lead to incorrect applications of style properties when you create derived instances from this component.\n\n",
Object.assign({},uc,{textAlign:"left"}),"Usually ambigous names are caused if your component is in some kind of intermittent state, where it already displays an example state or code has run that automatically created interface elements. This can be fixed by resetting the submorphs of this morph, usually by implementing a ",Object.assign({},uc,{textAlign:"left",fontStyle:"italic"}),"reset()",Object.assign({},uc,{fontStyle:"italic",fontFamily:"IBM Plex Mono"}),' routine you can invoke to put the morph into some kind of "neutral" state. Alternatively you can go ahead and rename the duplicate morphs to have proper unique names. If you have a hard time giving the conflicting morphs appropriate names, this can be an indication that the component you are declaring is too large, and you need to decompose your component into subcomponents further.',
Object.assign({},uc,{textAlign:"left",fontStyle:"italic"})]),{width:600,confirmLabel:"PROCEED TO RENAME",rejectLabel:"CANCEL",align:"left"}),3);case 3:if(yd=Ye.yieldResult,!yd)return Ye.return();case 2:Fd=Ye.forIn(Lb);case 4:if(null==(Jc=Fd.getNext())){Ye.jumpTo(6);break}if(2>Lb[Jc].length){Ye.jumpTo(4);break}Yd=Lb[Jc];case 7:if(!(1<Yd.length)){Ye.jumpTo(4);break}ie=Yd[0];Sa.show(ie,!0);return Ye.yield(Ma.prompt(["Name Collision\n",{},"The name of\n",uc,ie.toString(),Object.assign({},uc,{fontStyle:"italic",
fontWeight:"bold"}),"\nis not unique within the submorph hierachy of\n",Object.assign({},uc),aa.name,Object.assign({},uc,{fontStyle:"italic",fontWeight:"bold"}),"\nThere "+(2<Yd.length?"are "+(Yd.length-1)+" other morphs":"is one other morph")+" with the exact same name located in this component.",uc," Duplicate names can cause errors when applying styles to derived morphs of this master component, so it is essential that there is no name ambiguity. Please enter a new name for this or the other conflicting morphs:",
uc],{input:ie.name,lineWrapping:!0,width:500,fontSize:12,rejectLabel:"IGNORE",confirmLabel:"RENAME",errorMessage:"Provided name is not unique",validate:function(Db){return!Object.keys(Lb).includes(Db)}}),9);case 9:ue=Ye.yieldResult;Sa.signal(Ma,"hideMarkers");ue&&(ie.name=ue);if(ue in Lb){Ye.jumpTo(7);break}else if(!ue){Yd=Sa.arr.rotate(Yd);Ye.jumpTo(7);break}Sa.arr.remove(Yd,ie);Ye.jumpTo(7);break;case 6:return Ye.return(!0)}})}},{key:"onMouseDown",value:function(){var H=this,aa,Ma,tb,Lb,uc,hd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(yd){switch(yd.nextAddress){case 1:aa=
H.halo.target;Ma=!aa.isComponent;tb=$world.getAllNamed(aa.name).length;if(!(Ma&&1<tb)){yd.jumpTo(2);break}return yd.yield($world.prompt(["Name Conflict\n",{},"The morph's name you are about to turn into a component is already used by "+(tb-1)+" other morph"+(2<tb?"s":"")+". Please enter a ",{fontWeight:"normal"},"unique identifier",{fontStyle:"italic"}," for this component within this project.",{fontWeight:"normal",fontSize:16}],{input:aa.name,lineWrapping:!0,width:400,errorMessage:"Identifier not unique",
validate:function(Jc){return 0==$world.getAllNamed(Jc).length}}),3);case 3:Lb=yd.yieldResult;if(!Lb)return yd.return();aa.name=Lb;case 2:uc=aa;if(!(hd=Ma)){yd.jumpTo(4);break}return yd.yield(H.checkForDuplicateNamesInHierarchy(),5);case 5:hd=yd.yieldResult;case 4:uc.isComponent=hd,Ma?Sa.arr.pushIfNotIncluded(aa.world().localComponents,aa):Sa.arr.remove(aa.world().localComponents,aa),H.world()?H.updateComponentIndicator():aa.world().showHaloFor(aa),yd.jumpToEnd()}})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"ComponentHaloItem"}},{key:"morphName",get:function(){return"component"}},{key:"properties",get:function(){return{tooltip:{get:function(){return this.halo.target.isComponent?"Retract Component":"Turn into Component"}},styleClasses:{initialize:function(){this.styleClasses=this.halo.target.isComponent?["fas","fa-eraser"]:["fas","fa-cube"]}}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:39691,end:45760})})(Sa.HaloItem);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("CopyHaloItem")&&"function"===typeof Ja.CopyHaloItem?Ja.CopyHaloItem:Ja.CopyHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"init",value:function(H){function aa(Jc,Fd){return Fd.match(Sa.nameNumberRe)?
Fd.replace(Sa.nameNumberRe,function(Yd,ie,ue){ue||(ue="0");for(Yd=Number(ue);Jc.get(ie+ ++Yd););return ie+Yd}):Fd+"1"}var Ma=this.halo,tb=Ma.target,Lb=Ma.world(),uc=tb instanceof Sa.MultiSelectionTarget;Ma.remove();Sa.connect(H,"update",this,"update");if(uc){var hd=tb.selectedMorphs.map(function(Jc){return Lb.addMorph(Jc.copy())});uc=hd.map(function(Jc){Jc.name=aa(tb,Jc.name);return Jc.position});hd[0].undoStart("copy-halo");Lb.addMorph(Ma);Ma.refocus(hd);H.grab(Ma.target);Ma.target.onGrab({halo:Ma,
hand:H,isShiftDown:function(){return!1}});uc.forEach(function(Jc,Fd){return hd[Fd].globalPosition=Jc});Ma.alignWithTarget()}else{uc=tb.globalPosition;var yd=tb.copy();tb.isComponent&&(yd.isComponent=!1,yd.withAllSubmorphsDoExcluding(function(Jc){Jc!=yd&&Jc.master||delete Jc._parametrizedProps},function(Jc){return Jc.master&&Jc!=yd}),yd.master=tb);yd.name=aa(tb,tb.name);Lb.addMorph(yd);yd.globalPosition=uc;yd.undoStart("copy-halo");H.grab(yd);Lb.addMorph(Ma);Ma.visible=!1}}},{key:"stop",value:function(H){var aa=
this.halo,Ma=$jscomp.makeIterator(H.grabbedMorphs).next().value,tb=H.findDropTarget(H.globalPosition,[aa.target],function(uc){return!uc.isHaloItem&&!uc.ownerChain().some(function(hd){return hd.isHaloItem})}),Lb=aa.target.undoInProgress;Sa.disconnect(H,"update",this,"update");Lb.addTarget(tb);H.dropMorphsOn(tb);aa.target.undoStop("copy-halo");aa.remove();H.world().showHaloFor(Ma)}},{key:"onDragStart",value:function(H){this.init(H.hand)}},{key:"onDragEnd",value:function(H){this.stop(H.hand)}},{key:"update",
value:function(){this.halo.alignWithTarget()}},{key:"copyToClipBoard",value:function(){var H=this,aa,Ma,tb,Lb,uc,hd,yd,Jc,Fd,Yd,ie,ue,Ye,Db,Lf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(me){switch(me.nextAddress){case 1:aa=H;Ma=aa.halo;if(Ma.nameHalo().nameHolders.find(function(tf){return tf.nameHolder===$world.focusedMorph}))return me.return();tb=Ma.target;Lb=Ma.world();uc=tb instanceof Sa.MultiSelectionTarget;hd=tb.globalBounds().topLeft();yd=uc?tb.selectedMorphs:[tb];Jc=[];Fd=
'<!DOCTYPE html>\n          <html lang="en">\n          <head>\n            <meta charset="utf-8">\n            '+document.querySelector("#lively-morphic-css").outerHTML+"\n          </head>\n          <body>";Ma.remove();me.setCatchFinallyBlocks(2);Yd=$jscomp.makeIterator(yd);ie=Yd.next();case 4:if(ie.done)return Fd+="</body></html>",Db=JSON.stringify(Jc),me.yield(H.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/html",data:Fd},{type:"application/morphic",data:Db}]),8);ue=ie.value;return me.yield(Sa.createMorphSnapshot(ue,
{addPreview:!1,testLoad:!1}),7);case 7:Ye=me.yieldResult;Ye.copyMeta={offset:ue.worldPoint(Sa.pt(0,0)).subPt(hd)};Jc.push(Ye);Fd+=ue.renderPreview();ie=Yd.next();me.jumpTo(4);break;case 8:me.leaveTryBlock(3);break;case 2:return Lf=me.enterCatchBlock(),Lb.logError(Lf),me.return();case 3:Lb.addMorph(Ma),Ma.refocus(yd),Ma.setStatusMessage("copied"),me.jumpToEnd()}})}},{key:"onMouseUp",value:function(H){var aa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){H.stop();return Ma.yield(aa.copyToClipBoard(),
0)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CopyHaloItem"}},{key:"morphName",get:function(){return"copy"}},{key:"properties",get:function(){return{draggable:{defaultValue:!0},tooltip:{defaultValue:"Copy morph"},styleClasses:{defaultValue:["far","fa-clone"]}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:45762,end:49796})})(Sa.HaloItem);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("OriginHaloItem")&&"function"===typeof Ja.OriginHaloItem?Ja.OriginHaloItem:Ja.OriginHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"fill",get:function(){return Sa.Color.white.interpolate(.2,this.borderColorTop)}},{key:"extent",get:function(){return Sa.pt(15,
15)}},{key:"tooltip",get:function(){return"Change the morph's origin"}},{key:"computePositionAtTarget",value:function(){return this.halo.localize(this.halo.target.globalPosition)}},{key:"alignInHalo",value:function(){this.visible=!this.halo.hasTinyTarget;this.center=this.computePositionAtTarget()}},{key:"valueForPropertyDisplay",value:function(){return this.halo.target.origin}},{key:"init",value:function(){this.halo.target.undoStart("origin-halo");this.halo.state.activeButton=this}},{key:"stop",value:function(){this.halo.target.undoStop("origin-halo");
this.halo.state.activeButton=null;this.halo.alignWithTarget()}},{key:"update",value:function(H){var aa=this.halo,Ma=aa.target.origin,tb=aa.target.worldPoint(Ma);H=aa.target.localize(tb.addPt(H)).subPt(aa.target.scroll).subPt(Ma);aa.target.adjustOrigin(aa.target.origin.addPt(H))}},{key:"onDragStart",value:function(H){this.init()}},{key:"onDragEnd",value:function(H){this.stop()}},{key:"onDrag",value:function(H){this.update(H.state.dragDelta)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"OriginHaloItem"}},
{key:"morphName",get:function(){return"origin"}},{key:"properties",get:function(){return{borderWidth:{defaultValue:3},nativeCursor:{defaultValue:"-webkit-grab"},draggable:{defaultValue:!0},borderColor:{after:["halo"],initialize:function(){this.borderColor=this.halo.target.isComponent?Sa.componentAccent:Sa.haloBlue}}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:49798,end:51459})})(Sa.HaloItem);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("ResizeHandle")&&"function"===typeof Ja.ResizeHandle?Ja.ResizeHandle:Ja.ResizeHandle=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"valueForPropertyDisplay",value:function(){var H=this.halo.target.extent,
aa=H.y;return H.x.toFixed(1)+"x"+aa.toFixed(1)}},{key:"positionInHalo",value:function(){var H=this.halo.borderBox.bounds();this.halo.hasTinyTarget&&(Sa.Rectangle.prototype.sides.includes(this.location)&&(this.visible=!1),H=H.insetBy(-4));return H.partNamed(this.location)}},{key:"alignInHalo",value:function(){this.center=this.positionInHalo();return this}},{key:"onKeyUp",value:function(H){this.halo.state.activeButton==this&&this.halo.toggleDiagonal(H.isShiftDown(),this.corner)}},{key:"onKeyDown",value:function(H){this.halo.state.activeButton==
this&&this.halo.toggleDiagonal(H.isShiftDown(),this.corner)}},{key:"onDragStart",value:function(H){this.init(H.position,H.isShiftDown())}},{key:"onDragEnd",value:function(H){this.stop(H.isShiftDown())}},{key:"onDrag",value:function(H){this.update(H.position,H.isShiftDown(),H.isAltDown(),H.isCtrlDown());this.focus()}},{key:"init",value:function(H,aa){aa=void 0===aa?!1:aa;var Ma=this.halo.target,tb=Ma.origin,Lb=Ma.position;Ma=Ma.extent;this.startPos=H;this.startBounds=Lb.subPt(tb).extent(Ma);this.startOrigin=
this.halo.target.origin;this.savedLayout=this.halo.layout;this.halo.layout=null;this.halo.state.activeButton=this;this.tfm=this.halo.target.getGlobalTransform().inverse();H=this.halo.target.getGlobalTransform().getRotation();this.offsetRotation=Sa.num.toRadians(H%45);this.halo.toggleDiagonal(aa,this.corner)}},{key:"update",value:function(H,aa,Ma,tb){aa=void 0===aa?!1:aa;Ma=void 0===Ma?!1:Ma;tb=void 0===tb?!1:tb;var Lb=this.corner,uc=this.tfm;H=this.startPos.subPt(H);uc=uc.transformDirection(Sa.pt(H.x,
H.y));Ma&&(uc=uc.griddedBy(Sa.pt(10,10)));this.halo.updateBoundsFor(Lb,aa,uc,this.startBounds,this.startOrigin);this.halo.toggleDiagonal(aa,Lb);this.updateAlignmentGuide(Ma);aa=[];Lb=Lb.toLowerCase();Lb.includes("left")&&aa.push("left");Lb.includes("top")&&aa.push("top");Lb.includes("bottom")&&aa.push("bottom");Lb.includes("right")&&aa.push("right");Sa.showAndSnapToResizeGuides(this.halo.target,aa,!0,tb,5,200)}},{key:"stop",value:function(H){H=this.halo;H.layout=this.savedLayout;H.state.activeButton=
null;H.alignWithTarget();H.toggleDiagonal(!1);this.updateAlignmentGuide(!1);Sa.removeSnapToGuidesOf(H.target)}},{key:"updateAlignmentGuide",value:function(H){var aa=this.halo.getSubmorphNamed("mesh");if(H)return H=this.halo.target.extent,H=Sa.pt(H.x%10,H.y%10),aa=this.halo.getMesh(this.globalPosition.addPt(this.extent.scaleBy(.5)),H),this.focus(),aa;aa&&aa.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ResizeHandle"}},{key:"properties",get:function(){return{corner:{},location:{},
draggable:{defaultValue:!0},isResizeHandle:{readOnly:!0,get:function(){return!0}}}}},{key:"getResizeParts",value:function(H){0<H&&(H-=360);H=-8-(H/45).toFixed();0==H&&(H=8);return Sa.arr.zip(Sa.arr.rotate([["topLeft",function(aa){return aa.negated()}],["topCenter",function(aa){return aa.withX(0).negated()}],["topRight",function(aa){return aa.withX(0).negated()}],["rightCenter",function(aa){return Sa.pt(0,0)}],["bottomRight",function(aa){return Sa.pt(0,0)}],["bottomCenter",function(aa){return Sa.pt(0,
0)}],["bottomLeft",function(aa){return aa.withY(0).negated()}],["leftCenter",function(aa){return aa.withY(0).negated()}]],H),[["nwse-resize","topLeft"],["ns-resize","topCenter"],["nesw-resize","topRight"],["ew-resize","rightCenter"],["nwse-resize","bottomRight"],["ns-resize","bottomCenter"],["nesw-resize","bottomLeft"],["ew-resize","leftCenter"]])}},{key:"resizersFor",value:function(H){var aa=this;if(!H.target)return[];var Ma=H.target.getGlobalTransform().getRotation();return Sa.arr.compact(this.getResizeParts(Ma).map(function(tb){var Lb=
$jscomp.makeIterator(tb),uc=$jscomp.makeIterator(Lb.next().value);tb=uc.next().value;uc.next();uc.next();uc=$jscomp.makeIterator(Lb.next().value);Lb=uc.next().value;uc=uc.next().value;return aa.for(H,tb,uc,Lb)})).map(function(tb){return tb.alignInHalo()})}},{key:"for",value:function(H,aa,Ma,tb){var Lb="Resize "+aa;H=H.getSubmorphNamed(Lb)||new this({name:Lb,halo:H,corner:aa,tooltip:"Resize "+aa,extent:Sa.pt(10,10),borderWidth:1,borderRadius:0,borderColor:H.target.isComponent?Sa.componentAccent:Sa.haloBlue,
fill:Sa.Color.white});return Object.assign(H,{nativeCursor:tb,location:Ma})}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:51518,end:56816})})(Sa.HaloItem);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("MenuHaloItem")&&"function"===
typeof Ja.MenuHaloItem?Ja.MenuHaloItem:Ja.MenuHaloItem=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"onMouseDown",value:function(H){var aa=this,Ma,tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lb){if(1==Lb.nextAddress)return Ma=aa.halo.target,aa.halo.remove(),Lb.yield(Ma.menuItems(),2);tb=Lb.yieldResult;Ma.world().openMenu(tb).hasFixedPosition=aa.halo.hasFixedPosition;Lb.jumpToEnd()})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MenuHaloItem"}},{key:"morphName",get:function(){return"menu"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},tooltip:{defaultValue:"Opens the morph menu"},styleClasses:{defaultValue:["fas","fa-bars"]}}}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:56818,end:57340})})(Sa.HaloItem);var ab=ta("M",function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),bb=Ja.hasOwnProperty("MorphHighlighter")&&"function"===typeof Ja.MorphHighlighter?Ja.MorphHighlighter:Ja.MorphHighlighter=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"alignWithHalo",value:function(){this.target&&(this.position=this.halo.localize(this.target.globalBounds().topLeft()),
this.halo.isWorld&&(this.position=this.position.subPt(this.halo.scroll)),this.extent=this.target.globalBounds().extent(),this.get("name tag").value=this.target.name,this.get("name tag").topCenter=this.innerBounds().insetBy(-10).bottomCenter())}},{key:"show",value:function(){if(this.target&&this.target.layout&&this.showLayout&&(this.layoutHalo=this.layoutHalo||this.world().showLayoutHaloFor(this.target,this.pointerId))&&this.layoutHalo.previewDrop){this.visible=!1;this.alignWithHalo();this.halo.get("grab").hand.grabbedMorphs&&
this.layoutHalo.previewDrop(this.halo.get("grab").hand.grabbedMorphs);return}this.visible=!0;this.alignWithHalo()}},{key:"handleDrop",value:function(H){this.layoutHalo&&this.layoutHalo.handleDrop(H)}},{key:"deactivate",value:function(){this.layoutHalo&&(this.layoutHalo.remove(),this.layoutHalo=null);this.visible=!1;this.alignWithHalo();this.remove()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphHighlighter"}},{key:"properties",get:function(){return{draggable:{defaultValue:!1},
name:{defaultValue:"morphHighlighter"},styleClasses:{defaultValue:["inactive"]},reactsToPointer:{defaultValue:!1},hasFixedPosition:{defaultValue:!0},fill:{defaultValue:Sa.Color.orange.withA(.3)},borderWidth:{defaultValue:2},borderColor:{defaultValue:Sa.Color.orange},halo:{},epiMorph:{defaultValue:!0},isHighlighter:{readOnly:!0,defaultValue:!0},highlightedSides:{defaultValue:[],set:function(H){var aa=this;this.setProperty("highlightedSides",H);this.submorphs=H.map(function(Ma){return{type:"ellipse",
isHaloItem:!0,fill:Sa.Color.orange,center:aa.innerBounds()[Ma]()}});this.addMorph({type:"label",name:"name tag",padding:Sa.Rectangle.inset(5,5,5,5),fontColor:Sa.Color.white,fill:Sa.Color.orange,borderRadius:3});this.alignWithHalo()}},showLayout:{defaultValue:!1},targetId:{},target:{readOnly:!0,derived:!0,get:function(){return(this.world()||this.env.world).getMorphWithId(this.targetId)}}}}},{key:"removeHighlighters",value:function(H){H=void 0===H?$world:H;var aa=H._morphHighlighters,Ma;for(Ma in aa)aa[Ma].remove();
delete H._morphHighlighters}},{key:"for",value:function(H,aa,Ma,tb){Ma=void 0===Ma?!1:Ma;tb=void 0===tb?[]:tb;var Lb=H._morphHighlighters=H._morphHighlighters||{};Sa.properties.forEachOwn(Lb,function(uc,hd){return hd.alignWithHalo()});if(!aa||aa.ownerChain().find(function(uc){return uc.isHaloItem}))return null;Lb[aa.id]=Lb[aa.id]||new this({targetId:aa.id,halo:H,showLayout:Ma});H.addMorph(Lb[aa.id]);Lb[aa.id].highlightedSides=tb;return Lb[aa.id]}},{key:"interceptDrop",value:function(H,aa,Ma){(H=H._morphHighlighters=
H._morphHighlighters||{},H[aa.id])&&H[aa.id].handleDrop(Ma)}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:57529,end:61140})}(Sa.Morph));Sa.MorphHighlighter=ab;Sa.MorphHighlighter=ab;Sa.MorphHighlighter=ab;var zc=ta("I",function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/morph.js"),
bb=Ja.hasOwnProperty("InteractiveMorphSelector")&&"function"===typeof Ja.InteractiveMorphSelector?Ja.InteractiveMorphSelector:Ja.InteractiveMorphSelector=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:Symbol.for("lively-instance-initialize"),value:function(H,aa,Ma){H=void 0===H?$world:H;this.controllingMorph=void 0===aa?null:aa;this.possibleTarget=this.morphHighlighter=this.selectorMorph=null;this.world=
H;this.filterFn=Ma;this.whenDone=null}},{key:"selectNewTarget",value:function(){this.targetObject=null;var H=Sa.promise.deferred();H.promise.resolve=H.resolve;this.whenDone=H.promise;this.selectorMorph=Sa.Icon.makeLabel("crosshairs",{fontSize:20,hasFixedPosition:!0,epiMorph:!0}).openInWorld();Sa.connect(this.world.firstHand,"position",this,"scanForTargetAt");Sa.once(this.selectorMorph,"onMouseDown",this,"selectTarget");Sa.once(this.selectorMorph,"onKeyDown",this,"stopSelect");this.selectorMorph.focus();
this.scanForTargetAt(this.world.firstHand.position)}},{key:"scanForTargetAt",value:function(){var H=this.world.firstHand.globalPosition;this.selectorMorph.center=H;this.selectorMorph.focus();var aa=this.selectorMorph.morphBeneath(H),Ma,tb=this.possibleTarget,Lb=this.controllingMorph,uc=this.filterFn,hd=this.world,yd=this.morphHighlighter;for(yd==aa?aa=yd.morphBeneath(H):aa&&aa.isEpiMorph&&(aa=aa.morphBeneath(H));aa&&(Ma=[aa].concat($jscomp.arrayFromIterable(aa.ownerChain())).find(function(Jc){return!Jc.visible}));)aa=
Ma=Ma.morphBeneath(H);if(aa&&uc&&!uc(aa))for(;aa&&![aa].concat($jscomp.arrayFromIterable(aa.ownerChain())).find(uc);)aa=aa.morphBeneath(H);!aa||aa==tb||Lb&&aa.ownerChain().includes(Lb.getWindow())||(yd&&yd.deactivate(),(this.possibleTarget=tb=aa)&&!tb.isWorld&&(H=this.morphHighlighter=Sa.MorphHighlighter.for(hd,aa))&&H.show())}},{key:"selectTarget",value:function(){this.targetObject=this.possibleTarget;this.stopSelect()}},{key:"stopSelect",value:function(){Sa.MorphHighlighter.removeHighlighters(this.world);
Sa.disconnect(this.world.firstHand,"position",this,"scanForTargetAt");this.selectorMorph.remove();this.whenDone&&this.whenDone.resolve(this.targetObject)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveMorphSelector"}},{key:"selectMorph",value:function(H,aa,Ma){H=new this(H,aa,Ma);H.selectNewTarget();return H.whenDone}}],Ja,{pathInPackage:function(){return"morph.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:61149,end:63904})}(void 0));Sa.InteractiveMorphSelector=zc;Sa.InteractiveMorphSelector=zc;Sa.InteractiveMorphSelector=zc;Sa.default=nb;var Fc=lively.FreezerRuntime.recorderFor("lively.ide/index.js");Fc.info="import via sub modules";Fc.info="import via sub modules";Fc.info="import via sub modules";nb=ta("v",{});Fc.valueWidgets=nb;Fc.valueWidgets=nb;Fc.valueWidgets=nb;var Xa=ta("p",{});Fc.popovers=Xa;Fc.popovers=Xa;Fc.popovers=
Xa;var db=lively.FreezerRuntime.recorderFor("lively.components/popup.js");db.Morph=Je;db.VerticalLayout=Aa;db.StyleSheet=Hd;db.Icon=pe;db.CustomLayout=xa;db.Color=Sb;db.rect=Cc;db.pt=mb;db.connect=Qb;db.Path=dd;db.duration=300;Fc=ta("P",function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.components/popup.js"),bb=Ja.hasOwnProperty("Popover")&&"function"===typeof Ja.Popover?Ja.Popover:Ja.Popover=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Rb(bb,Qa,[{key:"relayout",value:function(H){var aa=this.get("body"),Ma=this.get("arrow"),tb=this.get("close button");Ma=Ma.height;H?(aa.animate({topCenter:db.pt(0,Ma),duration:200}),tb.animate({topRight:aa.topRight.addXY(8,-8),duration:200})):(aa.topCenter=db.pt(0,Ma),tb.topRight=aa.topRight.addXY(8,-8))}},{key:"close",value:function(){this.fadeOut(300)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Popover"}},{key:"properties",get:function(){return{epiMorph:{defaultValue:!0},
hasFixedPosition:{defaultValue:!0},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/popover/light"}}},targetMorph:{derived:!0,after:["submorphs"],defaultValue:{extent:db.pt(200,200),fill:db.Color.transparent,submorphs:[{name:"placeholder",type:"label",value:"No Target Specified"}]},get:function(){return this.get("body").submorphs[0]},set:function(H){var aa=this;this.get("body").addMorph(H);this.whenRendered().then(function(){return aa.relayout()})}},submorphs:{initialize:function(){var H=
this;this.submorphs=[{type:"polygon",name:"arrow",topCenter:db.pt(0,0),borderColor:db.Color.transparent,vertices:[db.pt(-10,0),db.pt(0,-15),db.pt(10,0)]},{name:"body"},{name:"close button",type:"button",label:Object.assign(db.Icon.makeLabel("times-circle"),{fontSize:18}),tooltip:"close",fill:null,extent:db.pt(16,16),borderColor:db.Color.transparent}];var aa=$jscomp.makeIterator(this.submorphs);aa.next();var Ma=aa.next().value;aa=aa.next().value;db.connect(aa,"fire",this,"close");db.connect(Ma,"extent",
this,"relayout",{converter:"() => target.animated"});setTimeout(function(){return H.animated=!0},1E3)}}}}}],Ja,{pathInPackage:function(){return"popup.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.components",version:"0.1.0"}}},{start:247,end:2617})}(db.Morph));db.Popover=Fc;db.Popover=Fc;db.Popover=Fc;var hb=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js");
hb.Morph=Je;hb.TilingLayout=Oa;hb.morph=Jb;hb.Label=xd;hb.HorizontalLayout=Dc;hb.Icon=pe;hb.InputLine=wb;hb.config=dc;hb.connect=Qb;hb.signal=fb;hb.Color=Sb;hb.LinearGradient=sc;hb.pt=mb;hb.rect=Cc;hb.num=oc;hb.obj=sd;hb.popovers=Xa;hb.ValueScrubber=Ya;hb.Popover=Fc;(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("ContextSensitiveWidget")&&"function"===typeof Ja.ContextSensitiveWidget?Ja.ContextSensitiveWidget:Ja.ContextSensitiveWidget=function(H){H&&
H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ContextSensitiveWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:hb.Color.transparent},isSelected:{defaultValue:"false",set:function(H){this.setProperty("isSelected",H);this.fontColor=H?hb.Color.white:hb.Color.black}},layout:{initialize:function(){this.layout=new hb.HorizontalLayout}},
context:{serialize:!1}}}}],Ja,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1872,end:2441})})(hb.Morph);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("ShortcutWidget")&&"function"===typeof Ja.ShortcutWidget?Ja.ShortcutWidget:
Ja.ShortcutWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"onMouseDown",value:function(H){this.openPopover()}},{key:"openPopover",value:function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(H){H.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShortcutWidget"}},{key:"properties",get:function(){return{title:{defaultValue:"No Title",after:["submorphs"],
set:function(H){this.setProperty("title",H);this.getSubmorphNamed("valueString").value=H}},nativeCursor:{defaultValue:"pointer"},fontColor:{derived:!0,set:function(H){this.submorphs.forEach(function(aa){return aa.fontColor=H})}},submorphs:{initialize:function(){this.submorphs=[hb.Icon.makeLabel("arrow-right",{styleClasses:["TreeLabel"],fontSize:15,padding:hb.rect(1,1,4,1)}),{type:"label",value:this.title,styleClasses:["TreeLabel"],fontWeight:"bold",name:"valueString",opacity:.8,borderRadius:5,padding:hb.rect(0,
0,0,2),nativeCursor:"pointer",fontSize:12,borderWidth:0}]}}}}}],Ja,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:2443,end:3793})})(hb.ContextSensitiveWidget);Xa=function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("LayoutWidget")&&
"function"===typeof Ja.LayoutWidget?Ja.LayoutWidget:Ja.LayoutWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"layoutChanged",value:function(){this.title=this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}},{key:"openPopover",value:function(){var H=this,aa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){if(1==Ma.nextAddress)return aa=new hb.popovers.LayoutPopover({hasFixedPosition:!!H.ownerChain().find(function(tb){return tb.hasFixedPosition}),
container:H.context}),Ma.yield(aa.fadeIntoWorld(H.globalBounds().center()),2);hb.connect(aa,"layoutChanged",H,"layoutChanged");hb.signal(H,"openWidget",aa);Ma.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutWidget"}},{key:"properties",get:function(){return{title:{after:["submorphs"],initialize:function(){this.title=this.context&&this.context.layout?"Configure "+this.context.layout.name()+" Layout":"No Layout"}}}}}],Ja,{pathInPackage:function(){return"value-widgets.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3802,end:4623})}(hb.ShortcutWidget);hb.LayoutWidget=Xa;hb.LayoutWidget=Xa;hb.LayoutWidget=Xa;Fc=function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("ColorWidget")&&"function"===typeof Ja.ColorWidget?Ja.ColorWidget:Ja.ColorWidget=function(H){H&&
H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"relayout",value:function(H){H?this.submorphs=this.color?this.color.isGradient?this.renderGradientValue():this.renderColorValue():this.renderNoColor():this.color&&(this.color.isGradient?this.updateGradientValue():this.updateColorValue())}},{key:"updateGradientValue",value:function(){var H=this.color;if(2*H.stops.length==this.submorphs.length-3){var aa;for(aa in this.color.stops){var Ma=
H.stops[aa];var tb=Ma.color,Lb=Ma.offset,uc=$jscomp.makeIterator(this.submorphs[2+2*aa].submorphs).next().value;Ma=this.submorphs[3+2*aa];uc.fill=tb;Ma.value=(100*Lb).toFixed()+"%"+(aa<H.stops.length-1?",":"")}}else this.submorphs=this.renderGradientValue()}},{key:"renderGradientValue",value:function(){return[{type:"label",styleClasses:["TreeLabel"],value:this.color.type+"(",name:"valueString"}].concat($jscomp.arrayFromIterable(this.renderStops()),[{type:"label",styleClasses:["TreeLabel"],value:")"}])}},
{key:"updateColorValue",value:function(){this.getSubmorphNamed("color box").fill=this.color;this.getSubmorphNamed("valueString").value=hb.obj.safeToString(this.color)}},{key:"renderNoColor",value:function(){return[{extent:hb.pt(15,15),fill:hb.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:hb.pt(5,7.5),fill:hb.Color.white,borderColor:hb.Color.gray.darker(),borderWidth:1,submorphs:[{type:"path",name:"no fill",vertices:[hb.pt(0,0),hb.pt(10,10)],borderColor:hb.Color.red}]}]},
{type:"label",value:"No Color",fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderColorValue",value:function(){return[{extent:hb.pt(15,15),fill:hb.Color.transparent,submorphs:[{styleClasses:["colorValue"],name:"color box",center:hb.pt(5,7.5),fill:this.color,borderColor:hb.Color.gray.darker(),nativeCursor:"pointer",borderWidth:1}]},{type:"label",value:hb.obj.safeToString(this.color),fontSize:14,name:"valueString",styleClasses:["TreeLabel"]}]}},{key:"renderStops",value:function(){var H=
this.color,aa=[{type:"label",padding:hb.rect(0,0,5,0),value:"linearGradient"==H.type?hb.num.toDegrees(H.vectorAsAngle()).toFixed()+"\u00b0,":""}],Ma;for(Ma in H.stops){var tb=H.stops[Ma],Lb=tb.color;tb=tb.offset;aa.push({extent:hb.pt(this.fontSize,this.fontSize),fill:hb.Color.transparent,layout:new hb.HorizontalLayout({spacing:3}),submorphs:[{styleClasses:["colorValue"],fill:Lb}]});aa.push({type:"label",padding:hb.rect(0,0,5,0),value:(100*tb).toFixed()+"%"+(Ma<H.stops.length-1?",":"")})}return aa}},
{key:"onMouseDown",value:function(H){this.openFillEditor()}},{key:"update",value:function(H){this.color=H}},{key:"openFillEditor",value:function(){var H=this,aa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){if(1==Ma.nextAddress)return aa=new hb.popovers.FillPopover({hasFixedPosition:!!H.ownerChain().find(function(tb){return tb.hasFixedPosition}),handleMorph:H.context,fillValue:H.color,title:"Fill Control",gradientEnabled:H.gradientEnabled}),Ma.yield(aa.fadeIntoWorld(H.globalBounds().center()),
2);hb.connect(aa,"fillValue",H,"update");hb.signal(H,"openWidget",aa);Ma.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ColorWidget"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new hb.HorizontalLayout({direction:"centered"})}},selectionFontColor:{defaultValue:hb.Color.white},nonSelectionFontColor:{defaultValue:hb.Color.black},color:{defaultValue:hb.Color.blue},gradientEnabled:{defaultValue:!1},fontSize:{defaultValue:14},isSelected:{after:["submorphs"],
set:function(H){this.getProperty("isSelected")!=H&&(this.getSubmorphNamed("valueString").fontColor=H?this.selectionFontColor:this.nonSelectionFontColor,this.setProperty("isSelected",H))}},submorphs:{after:["nonSelectionFontColor","selectionFontColor"],initialize:function(){hb.connect(this,"color",this,"relayout",{converter:function(H,aa){return(aa&&aa.isColor)!=(H&&H.isColor)}});this.relayout(!0)}}}}}],Ja,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:4687,end:10140})}(hb.ContextSensitiveWidget);hb.ColorWidget=Fc;hb.ColorWidget=Fc;hb.ColorWidget=Fc;var Rc=function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("BooleanWidget")&&"function"===typeof Ja.BooleanWidget?Ja.BooleanWidget:Ja.BooleanWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Rb(bb,Qa,[{key:"onMouseDown",value:function(H){this.boolean=!this.boolean}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"BooleanWidget"}},{key:"properties",get:function(){return{fontFamily:{defaultValue:hb.config.codeEditor.defaultStyle.fontFamily},nativeCursor:{defaultValue:"pointer"},boolean:{set:function(H){this.setProperty("boolean",H);this.value=hb.obj.safeToString(H);this.fontColor=this.boolean?hb.Color.green:hb.Color.red}}}}}],Ja,{pathInPackage:function(){return"value-widgets.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10149,end:10634})}(hb.Label);hb.BooleanWidget=Rc;hb.BooleanWidget=Rc;hb.BooleanWidget=Rc;var qd=ta("N",function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("NumberWidget")&&"function"===typeof Ja.NumberWidget?Ja.NumberWidget:Ja.NumberWidget=
function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"onMouseDown",value:function(H){Rb._get(Object.getPrototypeOf(bb.prototype),"onMouseDown",this).call(this,H);"up"==H.targetMorph.name&&this.increment();"down"==H.targetMorph.name&&this.decrement()}},{key:"spec",value:function(){return hb.obj.dissoc(Rb._get(Object.getPrototypeOf(bb.prototype),"spec",this).call(this),["submorphs"])}},{key:"update",value:function(H,
aa){aa=void 0===aa?!0:aa;this.setProperty("number",aa?H/this.scaleFactor:H);hb.signal(this,"number",this.number);this.relayout(aa)}},{key:"relayoutButtons",value:function(){var H=this.getSubmorphNamed("up"),aa=this.getSubmorphNamed("down");this.getSubmorphNamed("value");H.height=aa.height=(this.height-2)/2;H.width=aa.width=20}},{key:"onChange",value:function(H){Rb._get(Object.getPrototypeOf(bb.prototype),"onChange",this).call(this,H);"extent"!=H.prop||this.autofit||this.relayout()}},{key:"relayout",
value:function(H){var aa=this.getSubmorphNamed("value");aa&&(this.autofit?(H||(aa.value=this.number*this.scaleFactor),aa.fit(),this.height=aa.height,this.width=aa.width+20):H||(aa.width=this.width-20),this.relayoutButtons(),H||(aa.value=hb.num.roundTo(this.number*this.scaleFactor,1),aa.min=-Infinity!=this.min?this.min*this.scaleFactor:this.min,aa.max=Infinity!=this.max?this.max*this.scaleFactor:this.max,aa.unit=this.unit))}},{key:"increment",value:function(){void 0!=this.max&&this.number>=this.max||
this.update(this.number+1/this.scaleFactor,!1)}},{key:"decrement",value:function(){void 0!=this.min&&this.number<=this.min||this.update(this.number-1/this.scaleFactor,!1)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberWidget"}},{key:"properties",get:function(){return{unit:{type:"Enum",isStyleProp:!0,values:["px","%","pt",""]},autofit:{defaultValue:!0,after:["submorphs","extent"],set:function(H){this.setProperty("autofit",H);this.getSubmorphNamed("value").scaleToBounds=!H}},
number:{defaultValue:0,after:["unit","autofit"],set:function(H){this.setProperty("number",H);this.relayout(!1)}},min:{defaultValue:-Infinity},max:{defaultValue:Infinity},floatingPoint:{after:["number","submorphs"],set:function(H){this.setProperty("floatingPoint",H);this.get("value").floatingPoint=H},get:function(){var H=/[+-]?([0-9]*[.])?[0-9]+/.exec(this.number);return this.getProperty("floatingPoint")||1==this.scaleFactor&&H&&!!H[1]}},padding:{isStyleProp:!0,defaultValue:hb.rect(5,3,0,0),after:["submorphs"],
set:function(H){this.setProperty("padding",H);this.getSubmorphNamed("value").padding=H}},extent:{defaultValue:hb.pt(70,25)},scaleFactor:{defaultValue:1,get:function(){return this.getProperty("scaleFactor")||1}},baseFactor:{after:["submorphs"],derived:!0,get:function(){return this.get("value").baseFactor},set:function(H){this.get("value").baseFactor=H}},styleClasses:{defaultValue:["unfocused"]},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/number field/light"}}},fontColor:{isStyleProp:!0,
defaultValue:hb.Color.rgbHex("#0086b3"),set:function(H){this.setProperty("fontColor",H)}},isSelected:{set:function(H){this.getProperty("isSelected")!=H&&(H?(this.addStyleClass("selected"),this.removeStyleClass("unselected")):(this.removeStyleClass("selected"),this.addStyleClass("unselected")),this.setProperty("isSelected",H))}},fontFamily:{defaultValue:"Sans-Serif",isStyleProp:!0,set:function(H){this.setProperty("fontFamily",H)}},fontSize:{defaultValue:15,isStyleProp:!0,set:function(H){this.setProperty("fontSize",
H)}},layout:{initialize:function(){this.layout=new hb.TilingLayout({axis:"column",orderByIndex:!0,align:"center"})}},submorphs:{after:["min","max"],initialize:function(){var H=this;this.submorphs=[new hb.ValueScrubber({name:"value",unit:this.unit,floatingPoint:this.floatingPoint,scaleToBounds:!1,min:this.min,max:this.max}),hb.Icon.makeLabel("sort-up",{name:"up"}),hb.Icon.makeLabel("sort-up",{name:"down",rotation:Math.PI})];hb.connect(this.get("value"),"scrub",this,"update");this.whenRendered().then(function(){return H.relayout()})}}}}}],
Ja,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10643,end:16590})}(hb.Morph));hb.NumberWidget=qd;hb.NumberWidget=qd;hb.NumberWidget=qd;var Xd=function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("ShadowWidget")&&"function"===typeof Ja.ShadowWidget?
Ja.ShadowWidget:Ja.ShadowWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"onMouseDown",value:function(H){this.openPopover()}},{key:"openPopover",value:function(){var H=this,aa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){if(1==Ma.nextAddress)return aa=new hb.popovers.ShadowPopover({hasFixedPosition:!!H.ownerChain().find(function(tb){return tb.hasFixedPosition}),shadowValue:H.shadowValue}),
Ma.yield(aa.fadeIntoWorld(H.globalBounds().center()),2);hb.connect(aa,"shadowValue",H,"shadowValue");hb.connect(H,"shadowValue",H,"update");hb.signal(H,"openWidget",aa);Ma.jumpToEnd()})}},{key:"update",value:function(){this.renderShadowDisplay()}},{key:"renderShadowDisplay",value:function(){this.shadowValue?1<this.submorphs.length?this.updateShadowDisplay():this.initShadowDisplay():this.submorphs=[{opacity:.8,reactsToPointer:!1,styleClasses:["TreeLabel"],name:"valueString",type:"label",value:"No Shadow"}]}},
{key:"updateShadowDisplay",value:function(){var H=this.shadowValue,aa=H.blur,Ma=H.spread,tb=H.distance;H=H.color;var Lb=$jscomp.makeIterator(this.submorphs),uc=Lb.next().value,hd=Lb.next().value;hd=$jscomp.makeIterator(hd.submorphs).next().value;Lb=Lb.next().value;uc.value=(this.shadowValue.inset?"inset":"drop")+"-shadow(";hd.fill=H;Lb.value=", "+aa+"px, "+tb+"px, "+Ma+"px)"}},{key:"initShadowDisplay",value:function(){var H=this.shadowValue,aa=H.blur,Ma=H.spread,tb=H.distance;H=H.color;this.submorphs=
[{name:"valueString",opacity:.7,reactsToPointer:!1,type:"label",value:(this.shadowValue.inset?"inset":"drop")+"-shadow("},hb.morph({fill:hb.Color.transparent,extent:hb.pt(this.fontSize+6,this.fontSize+4),submorphs:[{extent:hb.pt(this.fontSize,this.fontSize),position:hb.pt(2,2),fill:H,borderColor:hb.Color.black,borderWidth:1}]}),{name:"valueString",type:"label",opacity:.7,reactsToPointer:!1,value:", "+aa+"px, "+tb+"px, "+Ma+"px)"}]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShadowWidget"}},
{key:"properties",get:function(){return{shadowValue:{after:["submorphs"],defaultValue:null,set:function(H){this.setProperty("shadowValue",H);this.renderShadowDisplay()}},fill:{defaultValue:hb.Color.transparent},nativeCursor:{defaultValue:"pointer"},fontSize:{defaultValue:12},fontColor:{derived:!0,set:function(H){this.submorphs.forEach(function(aa){return aa.fontColor=H})}},isSelected:{defaultValue:!1,set:function(H){this.setProperty("isSelected",H);this.fontColor=H?hb.Color.white:hb.Color.black}},
layout:{initialize:function(){this.layout=new hb.HorizontalLayout}},submorphs:{initialize:function(){this.update()}}}}}],Ja,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:16599,end:19722})}(hb.Morph);hb.ShadowWidget=Xd;hb.ShadowWidget=Xd;hb.ShadowWidget=Xd;var hc=function(Qa){var Ja=
lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("PointWidget")&&"function"===typeof Ja.PointWidget?Ja.PointWidget:Ja.PointWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"onMouseDown",value:function(H){this.openPopover()}},{key:"openPopover",value:function(){var H=this,aa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){if(1==Ma.nextAddress)return aa=
new hb.popovers.PointPopover({pointValue:H.pointValue,hasFixedPosition:!!H.ownerChain().find(function(tb){return tb.hasFixedPosition})}),Ma.yield(aa.fadeIntoWorld(H.globalBounds().center()),2);hb.connect(aa,"pointValue",H,"pointValue");hb.signal(H,"openWidget",aa);Ma.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PointWidget"}},{key:"properties",get:function(){return{isSelected:{defaultValue:"false",set:function(H){this.setProperty("isSelected",H);this.fontColor=H?
this.selectionFontColor:this.nonSelectionFontColor}},selectionFontColor:{isStyleProp:!0,defaultValue:hb.Color.white},nonSelectionFontColor:{isStyleProp:!0,defaultValue:hb.Color.black},fontFamily:{defaultValue:hb.config.codeEditor.defaultStyle.fontFamily},nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},pointValue:{after:["textAndAttributes"],set:function(H){var aa=hb.Color.rgbHex("#0086b3");this.setProperty("pointValue",H);this.textAndAttributes=["pt(",null,H.x.toFixed(),
{fontColor:aa},",",{},H.y.toFixed(),{fontColor:aa},")",null];this.fixedHeight=this.fixedWidth=!0;this.height=20;this.width=this.textString.length*this.fontSize}}}}}],Ja,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:19731,end:21375})}(hb.Label);hb.PointWidget=hc;hb.PointWidget=hc;hb.PointWidget=
hc;var Id=function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("PaddingWidget")&&"function"===typeof Ja.PaddingWidget?Ja.PaddingWidget:Ja.PaddingWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"onMouseDown",value:function(H){this.openPopover()}},{key:"openPopover",value:function(){var H=this,aa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){if(1==
Ma.nextAddress)return aa=new hb.popovers.RectanglePopover({hasFixedPosition:!!H.ownerChain().find(function(tb){return tb.hasFixedPosition}),rectangle:H.rectangle}),aa.relayout(),Ma.yield(aa.fadeIntoWorld(H.globalBounds().center()),2);hb.connect(aa,"rectangle",H,"rectangle");hb.signal(H,"openWidget",aa);Ma.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PaddingWidget"}},{key:"properties",get:function(){return{nativeCursor:{defaultValue:"pointer"},styleClasses:{defaultValue:["TreeLabel"]},
fontFamily:{defaultValue:hb.config.codeEditor.defaultStyle.fontFamily},isSelected:{defaultValue:"false",set:function(H){this.setProperty("isSelected",H);this.fontColor=H?hb.Color.white:hb.Color.black}},rectangle:{defaultValue:hb.rect(0),set:function(H){this.setProperty("rectangle",H);this.value=hb.obj.safeToString(H)}}}}}],Ja,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:21384,end:22445})}(hb.Label);hb.PaddingWidget=Id;hb.PaddingWidget=Id;hb.PaddingWidget=Id;var Pc=function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("IconWidget")&&"function"===typeof Ja.IconWidget?Ja.IconWidget:Ja.IconWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"onMouseDown",
value:function(H){this.openPopover()}},{key:"openPopover",value:function(){var H=this,aa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){if(1==Ma.nextAddress)return aa=new hb.popovers.IconPopover({hasFixedPosition:!!H.ownerChain().find(function(tb){return tb.hasFixedPosition})}),Ma.yield(aa.fadeIntoWorld(H.globalBounds().center()),2);hb.connect(aa,"select",H,"iconValue",{converter:function(tb){return tb&&hb.Icon.makeLabel(tb).value},varMapping:{Icon:pe}});hb.signal(H,"openWidget",
aa);Ma.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"IconWidget"}},{key:"properties",get:function(){return{fontColor:{defaultValue:hb.Color.gray.darker()},fontFamily:{defaultValue:"FontAwesome"},nativeCursor:{defaultValue:"pointer"},iconValue:{derived:!0,get:function(){return this.value},set:function(H){this.value=H||"No Icon"}}}}}],Ja,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22454,end:23385})}(hb.Label);hb.IconWidget=Pc;hb.IconWidget=Pc;hb.IconWidget=Pc;var Jd=function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.ide/value-widgets.js"),bb=Ja.hasOwnProperty("StringWidget")&&"function"===typeof Ja.StringWidget?Ja.StringWidget:Ja.StringWidget=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"truncate",
value:function(H){return 200<H.length?H.slice(0,20)+"...":H}},{key:"onFocus",value:function(H){var aa=this,Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress)return Rb._get(Object.getPrototypeOf(bb.prototype),"onFocus",aa).call(aa,H),aa.readOnly?tb.return():aa.stringTooLong?tb.yield(aa.world().editPrompt("edit string",{requester:aa,input:aa.stringValue}),2):(aa.borderColor=hb.Color.white.withA(.9),aa.textString=aa.stringValue,tb.return());Ma=tb.yieldResult;if("string"===
typeof Ma)aa.onInput(Ma);tb.jumpToEnd()})}},{key:"onBlur",value:function(H){Rb._get(Object.getPrototypeOf(bb.prototype),"onBlur",this).call(this,H);this.readOnly||(this.borderColor=hb.Color.transparent,this.onInput(this.textString))}},{key:"onInput",value:function(H){this.owner.focus();hb.signal(this,"inputAccepted",H);this.stringValue=H}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringWidget"}},{key:"properties",get:function(){return{fill:{defaultValue:hb.Color.transparent},
fontColor:{defaultValue:hb.Color.blue},nativeCursor:{defaultValue:"auto"},borderColor:{defaultValue:hb.Color.transparent},borderStyle:{defaultValue:"dashed"},borderRadius:{defaultValue:4},borderWidth:{defaultValue:1},padding:{defaultValue:hb.rect(0,0,0,0)},fixedWidth:{defaultValue:!1},fixedHeight:{defaultValue:!1},stringValue:{after:["textString"],set:function(H){this.setProperty("stringValue",H);this.textString=this.truncate(H);this.nativeCursor=this.stringTooLong?"pointer":"auto"}},stringTooLong:{readOnly:!0,
get:function(){return this.stringValue.includes("\n")}},isSelected:{defaultValue:"false",set:function(H){this.setProperty("isSelected",H);this.fontColor=H?hb.Color.white:hb.Color.blue}}}}}],Ja,{pathInPackage:function(){return"value-widgets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23394,end:25345})}(hb.InputLine);hb.StringWidget=
Jd;hb.StringWidget=Jd;hb.StringWidget=Jd;hb.valueWidgets=nb;Object.assign(hb.valueWidgets,{NumberWidget:qd,StringWidget:Jd,IconWidget:Pc,PaddingWidget:Id,ShadowWidget:Xd,PointWidget:hc,BooleanWidget:Rc,LayoutWidget:Xa,ColorWidget:Fc});var fa=lively.FreezerRuntime.recorderFor("lively.halos/layout.js");fa.Ellipse=jb;fa.Icon=pe;fa.Morph=Je;fa.Path=Cd;fa.Text=bc;fa.HorizontalLayout=Dc;fa.VerticalLayout=Aa;fa.morph=Jb;fa.Color=Sb;fa.pt=mb;fa.rect=Cc;fa.Rectangle=wc;fa.arr=$a;fa.connect=Qb;fa.disconnect=
ld;fa.LabeledCheckBox=Za;fa.DropDownSelector=U;fa.Button=va;fa.Menu=M;fa.NumberWidget=qd;fa.InteractiveMorphSelector=zc;fa.easings=Gc;(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),bb=Ja.hasOwnProperty("AxisHalo")&&"function"===typeof Ja.AxisHalo?Ja.AxisHalo:Ja.AxisHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:Symbol.for("lively-instance-initialize"),value:function(H){var aa=
H.halo;H=H.targetAxis;Rb._get(Object.getPrototypeOf(bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{fill:fa.Color.transparent,halo:aa,targetAxis:H,container:aa.container});this.initialize()}},{key:"initialize",value:function(){this.setBounds(this.fetchBounds());this.minSlider=this.minSlider();this.axisMenu=this.axisMenu();this.proportionSlider=this.proportionSlider();this.proportionSlider.addMorph(this.minSlider);this.submorphs=[this.proportionSlider,this.axisMenu];this.halo.addGuide(this)}},
{key:"forceMenuHidden",set:function(H){this._forceMenuHidden=H;this.axisMenu.visible=!H}},{key:"forceMenuHidden",get:function(){return this._forceMenuHidden}},{key:"lastAxis",get:function(){return!this.targetAxis.after}},{key:"fetchBounds",value:function(){return this.fetchPosition().extent(this.fetchExtent())}},{key:"alignWithTarget",value:function(){this.extent=this.fetchExtent();this.position=this.fetchPosition();this.proportionSlider.alignWithTarget();this.axisMenu.alignWithTarget()}},{key:"onHoverIn",
value:function(){this.minSlider.requestToShow();this.axisMenu.visible=!this.forceMenuHidden&&!0}},{key:"onHoverOut",value:function(H){this.minSlider.requestToHide();this.axisMenu.visible=this.forceMenuVisible||!1}},{key:"proportionSlider",value:function(){var H=this,aa=this,Ma=this.proportionViewer();return this.halo.addGuide(new fa.Morph({nativeCursor:this.getResizeCursor(),fill:fa.Color.transparent,submorphs:[this.devider(),Ma],alignWithTarget:function(){this.setBounds(aa.getProportionSliderBounds(this))},
onDragStart:function(){Ma.visible=!0},onDrag:function(tb){H.adjustStretch(H.getDelta(tb));H.halo.alignWithTarget()},onDragEnd:function(){Ma.visible=!1}}))}},{key:"devider",value:function(){return new fa.Morph({visible:!this.lastAxis,fill:fa.Color.black.withA(.5),bounds:this.getDeviderBounds(),draggable:!1,reactsToPointer:!1})}},{key:"minSlider",value:function(){var H=this,aa=this,Ma=this.minSpaceVisualizer(),tb=this.minViewer();return this.halo.addGuide(new fa.Ellipse({nativeCursor:this.getResizeCursor(),
fill:fa.Color.green,extent:fa.pt(10,10),visible:!1,submorphs:[Ma,tb],becomesActiveOnHover:!0,alignWithTarget:function(){this.position=aa.getMinSliderPosition()},requestToShow:function(){this.visible=!aa.targetAxis.fixed},requestToHide:function(){this.active?this.shouldHide=!0:this.visible=!1},onDragStart:function(){aa.forceMenuHidden=!0;tb.visible=!0;this.active=Ma.visible=!0},onDrag:function(Lb){H.targetAxis.min+=-H.getDelta(Lb);H.halo.alignWithTarget()},onDragEnd:function(){aa.forceMenuHidden=!1;
tb.visible=!1;this.active=Ma.visible=!1;this.shouldHide&&(this.shouldHide=this.visible=!1)}}))}},{key:"minViewer",value:function(){var H=this;return this.viewer({position:this.getMinViewerPosition(),alignWithTarget:function(){this.textString="min: "+H.targetAxis.min.toFixed()+"px !"}})}},{key:"minSpaceBorder",value:function(){return new fa.Path(Object.assign({position:fa.pt(-1,-1),borderStyle:"dashed",borderColor:fa.Color.green,borderWidth:2},this.getMinSpaceBorder()))}},{key:"minSpaceVisualizer",
value:function(){var H=this,aa=this.minSpaceBorder();return this.halo.addGuide(new fa.Morph({fill:fa.Color.green.withA(.1),visible:!1,isHaloItem:!0,submorphs:[aa],alignWithTarget:function(){this.extent=H.getMinSpaceExtent();this.topLeft=fa.pt(5,5)}}))}},{key:"axisMenu",value:function(){var H=this.lockButton(),aa=this.menuButton(),Ma=this;return new fa.Morph({layout:this.getMenuLayout(),submorphs:[H,aa],fill:fa.Color.transparent,visible:!1,becomesActiveOnHover:!0,alignWithTarget:function(){this.bottomRight=
this.owner.extent.subPt(Ma.getMenuOffset(this))}})}},{key:"lockButton",value:function(){var H=this;return this.halo.addGuide(new fa.Morph({fill:fa.Color.transparent,extent:fa.pt(25,25),submorphs:[{center:fa.pt(12.5,12.5),fill:fa.Color.transparent,styleClasses:["fa","fa-unlock"]}],alignWithTarget:function(){H.targetAxis.fixed?(this.fontColor=fa.Color.red,this.submorphs[0].styleClasses=["fa","fa-lock"]):(this.fontColor=fa.Color.green,this.submorphs[0].styleClasses=["fa","fa-unlock"])},onMouseDown:function(){this.toggleLock()},
toggleLock:function(){H.targetAxis.fixed=!H.targetAxis.fixed;H.halo.alignWithTarget()}}))}},{key:"menuButton",value:function(){var H=this,aa=this;return new fa.Morph({fill:fa.Color.transparent,extent:fa.pt(25,25),submorphs:[{fill:fa.Color.transparent,styleClasses:["fa","fa-cog"],center:fa.pt(12.5,12.5)}],onMouseDown:function(Ma){aa.forceMenuVisible=!0;this.addMorph(Ma.state.menu=new fa.Menu({position:fa.pt(15,15),items:[["Remove "+aa.subject,function(){H.targetAxis.remove();H.halo.initGuides();H.halo.alignWithTarget()}],
["Insert "+aa.subject+" before",function(){H.targetAxis.addBefore();H.halo.initGuides();H.halo.alignWithTarget()}],["Insert "+aa.subject+" after",function(){H.targetAxis.addAfter();H.halo.initGuides();H.halo.alignWithTarget()}]]}))}})}},{key:"viewer",value:function(H){var aa=H.position;H=H.alignWithTarget;return this.halo.addGuide(new fa.Text({styleClasses:["Halo"],padding:fa.Rectangle.inset(6),visible:!1,borderRadius:10,fontColor:fa.Color.white,fill:fa.Color.black.withA(.5),position:aa,alignWithTarget:H,
readOnly:!0}))}},{key:"proportionViewer",value:function(){var H=this;return this.viewer({position:this.getProportionViewerPosition(),alignWithTarget:function(){this.textString=H.targetAxis.length.toFixed(1)+"px"}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"AxisHalo"}}],Ja,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:660,end:7979})})(fa.Morph);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),bb=Ja.hasOwnProperty("RowHalo")&&"function"===typeof Ja.RowHalo?Ja.RowHalo:Ja.RowHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:Symbol.for("lively-instance-initialize"),value:function(H){var aa=H.row;H=H.halo;Rb._get(Object.getPrototypeOf(bb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,{targetAxis:H.target.row(aa),halo:H})}},{key:"subject",get:function(){return"row"}},{key:"adjustStretch",value:function(H){this.targetAxis.height+=H}},{key:"getDelta",value:function(H){return H.state.dragDelta.y}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.y}},{key:"fetchPosition",value:function(){return fa.pt(-45,this.axisOffset()+10)}},{key:"fetchExtent",value:function(){return fa.pt(40,this.targetAxis.length-10)}},{key:"getMenuOffset",value:function(H){return this.targetAxis.length>
H.height?fa.pt(2,5):fa.pt(26,10)}},{key:"getMenuLayout",value:function(){return new fa.VerticalLayout}},{key:"getResizeCursor",value:function(){return"row-resize"}},{key:"getMinViewerPosition",value:function(){return fa.pt(50,20)}},{key:"getMinSliderPosition",value:function(){return fa.pt(0,-this.targetAxis.min)}},{key:"getMinSpaceExtent",value:function(){return fa.pt(this.container.width+45,this.targetAxis.min)}},{key:"getMinSpaceBorder",value:function(){return{extent:fa.pt(this.container.width+
50,2),vertices:[fa.pt(0,1),fa.pt(this.container.width+50,1)]}}},{key:"getProportionViewerPosition",value:function(){return fa.pt(40,20)}},{key:"getProportionSliderBounds",value:function(H){return fa.pt(0,H.owner.height-5).extent(fa.pt(40,10))}},{key:"getDeviderBounds",value:function(){return fa.pt(15,4).extent(fa.pt(25,2))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RowHalo"}}],Ja,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:7981,end:9208})})(fa.AxisHalo);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),bb=Ja.hasOwnProperty("ColumnHalo")&&"function"===typeof Ja.ColumnHalo?Ja.ColumnHalo:Ja.ColumnHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:Symbol.for("lively-instance-initialize"),
value:function(H){var aa=H.col;H=H.halo;Rb._get(Object.getPrototypeOf(bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,{targetAxis:H.target.col(aa),halo:H})}},{key:"subject",get:function(){return"column"}},{key:"adjustStretch",value:function(H){this.targetAxis.width+=H}},{key:"getDelta",value:function(H){return H.state.dragDelta.x}},{key:"axisOffset",value:function(){return this.targetAxis.origin.position.x}},{key:"fetchPosition",value:function(){return fa.pt(this.axisOffset()+
10,-45)}},{key:"fetchExtent",value:function(){return fa.pt(this.targetAxis.length-10,40)}},{key:"getMenuOffset",value:function(H){return this.targetAxis.length>H.width?fa.pt(5,3):fa.pt(8,26)}},{key:"getMenuLayout",value:function(){return new fa.HorizontalLayout}},{key:"getResizeCursor",value:function(){return"col-resize"}},{key:"getMinViewerPosition",value:function(){return fa.pt(20,50)}},{key:"getMinSliderPosition",value:function(){return fa.pt(-this.targetAxis.min,0)}},{key:"getMinSpaceExtent",
value:function(){return fa.pt(this.targetAxis.min,this.container.height+45)}},{key:"getMinSpaceBorder",value:function(){return{extent:fa.pt(2,this.container.height+50),vertices:[fa.pt(1,0),fa.pt(1,this.container.height+50)]}}},{key:"getProportionViewerPosition",value:function(){return fa.pt(20,40)}},{key:"getProportionSliderBounds",value:function(H){return fa.pt(H.owner.width-5,0).extent(fa.pt(10,40))}},{key:"getDeviderBounds",value:function(){return fa.pt(4,15).extent(fa.pt(2,25))}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"ColumnHalo"}}],Ja,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:9210,end:10442})})(fa.AxisHalo);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),bb=Ja.hasOwnProperty("CellGuide")&&"function"===typeof Ja.CellGuide?Ja.CellGuide:Ja.CellGuide=
function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"menuItems",value:function(){var H=this,aa=fa.Icon.textAttribute("check-square-o"),Ma=fa.Icon.textAttribute("square-o");aa[1].textStyleClasses.push("annotation");Ma[1].textStyleClasses.push("annotation");Ma[1].paddingRight="2px";return[["Resize Policy",[[["Rigid  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?Ma:aa)),function(){H.cellGroup.resize=
!1}],[["Space Filling  ",null].concat($jscomp.arrayFromIterable(this.cellGroup.resize?aa:Ma)),function(){H.cellGroup.resize=!0}]]],["Align at...",["center"].concat($jscomp.arrayFromIterable((new fa.Rectangle).sides),$jscomp.arrayFromIterable((new fa.Rectangle).corners)).map(function(tb){return[[tb,{paddingRight:"2px"}].concat($jscomp.arrayFromIterable(H.cellGroup.align==tb?aa:Ma),["  ",null]),function(){return H.cellGroup.align=tb}]})]].concat(this.cellGroup.morph?[["Release Morph from Cell",function(){var tb=
H.cellGroup.morph;tb&&(H.world().firstHand.grab(tb),H.world().firstHand.longClickGrab=!0,tb.position=fa.pt(0))}]]:[])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CellGuide"}},{key:"properties",get:function(){return{cellGroup:{}}}}],Ja,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:10444,end:11722})})(fa.Morph);(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),bb=Ja.hasOwnProperty("LayoutHalo")&&"function"===typeof Ja.LayoutHalo?Ja.LayoutHalo:Ja.LayoutHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LayoutHalo"}},{key:"properties",get:function(){return{container:{},target:{},
pointerId:{},halosEnabled:{defaultValue:!1},isEpiMorph:{defaultValue:!0},isHaloItem:{defaultValue:!0},borderColor:{defaultValue:fa.Color.orange},borderWidth:{defaultValue:2},styleClasses:{defaultValue:["Halo"]}}}}],Ja,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:11724,end:12137})})(fa.Morph);
nb=ta("G",function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),bb=Ja.hasOwnProperty("GridLayoutHalo")&&"function"===typeof Ja.GridLayoutHalo?Ja.GridLayoutHalo:Ja.GridLayoutHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"previewDrop",value:function(H){1>H.length||(H=this.cellGuides.find(function(aa){return aa.fullContainsWorldPoint($world.firstHand.position)}),H!=this.currentCell&&
this.currentCell&&this.currentCell.stopPreview(),(this.currentCell=H)&&this.currentCell.startPreview())}},{key:"handleDrop",value:function(H){var aa=this;this.currentCell&&H.whenRendered().then(function(){return aa.currentCell.cellGroup.morph=H})}},{key:"initialize",value:function(){this.initGuides();this.alignWithTarget();this.focus()}},{key:"optionControls",value:function(){var H=this.target,aa=new fa.LabeledCheckBox({name:"compensateOrigin",label:"Compensate Origin",fill:fa.Color.transparent,checked:H.compensateOrigin}),
Ma=new fa.LabeledCheckBox({label:"Resize Submorphs",fill:fa.Color.transparent,name:"fitToCell",checked:H.fitToCell});fa.connect(aa,"checked",H,"compensateOrigin");fa.connect(Ma,"checked",H,"fitToCell");fa.connect(aa,"checked",this,"alignWithTarget");return[aa,Ma]}},{key:"isLayoutHalo",get:function(){return!1}},{key:"alignWithTarget",value:function(){this.target.apply();this.position=this.container.globalPosition;this.target.compensateOrigin&&this.moveBy(this.container.origin.negated());this.extent=
this.container.extent;this.addMissingGuides();fa.arr.reverse(this.guides).forEach(function(H){return H.alignWithTarget()})}},{key:"addMissingGuides",value:function(){var H=this;fa.arr.withoutAll(this.target.cellGroups,this.guides.map(function(aa){return aa.cellGroup})).forEach(function(aa){return H.addMorph(H.cellGuide(aa))})}},{key:"initGuides",value:function(){this.submorphs=[];this.guides=[];this.initCellGuides();this.initColumnGuides();this.initRowGuides()}},{key:"initCellGuides",value:function(){var H=
this,aa=this.addMorph({fill:fa.Color.transparent,borderRadius:this.borderRadius,extent:this.extent});this.target.cellGroups.forEach(function(Ma){aa.addMorph(H.cellGuide(Ma))});this.cellGuides=aa.submorphs;this.addMorph(this.resizer())}},{key:"addGuide",value:function(H){H.isHaloItem=!0;this.guides.push(H);return H}},{key:"initRowGuides",value:function(){var H=this,aa=this;this.addGuide(this.addMorph(new fa.Morph({width:25,fill:fa.Color.gray.withA(.7),borderRadius:15,height:this.container.height,topRight:fa.pt(-5,
0),alignWithTarget:function(){this.height=aa.container.height}})));fa.arr.range(0,this.target.rowCount-1).forEach(function(Ma){H.addMorph(new fa.RowHalo({row:Ma,halo:H}))})}},{key:"initColumnGuides",value:function(){var H=this,aa=this;this.addGuide(this.addMorph(new fa.Morph({height:25,fill:fa.Color.gray.withA(.7),borderRadius:15,width:this.container.width,bottomLeft:fa.pt(0,-5),alignWithTarget:function(){this.width=aa.container.width}})));fa.arr.range(0,this.target.columnCount-1).forEach(function(Ma){H.addMorph(new fa.ColumnHalo({col:Ma,
halo:H}))})}},{key:"resizer",value:function(){var H=this;return this.addGuide(new fa.Morph({fill:fa.Color.transparent,extent:fa.pt(25,25),nativeCursor:"nwse-resize",onDrag:function(aa){H.container.resizeBy(aa.state.dragDelta);H.alignWithTarget()},alignWithTarget:function(){this.bottomRight=H.extent}}))}},{key:"cellResizer",value:function(H,aa){var Ma=this,tb="topLeft"==aa?"bottomRight":"topLeft";return new fa.Ellipse({borderWidth:1,visible:!1,borderColor:fa.Color.black,nativeCursor:"nwse-resize",
removeCell:function(Lb){H.disconnect(Lb);Ma.alignWithTarget()},addCell:function(Lb){H.connect(Lb);Ma.alignWithTarget()},start:function(){this.fixpointCell=H[tb];this.draggedDelta=H.bounds().partNamed(aa);this.debugMorph=Ma.addMorph(new fa.Morph({fill:fa.Color.orange.withA(.5)}))},update:function(Lb){var uc=this;this.draggedDelta=this.draggedDelta.addPt(Lb);var hd=fa.Rectangle.unionPts([this.draggedDelta]).union(this.fixpointCell.bounds());this.debugMorph.setBounds(hd);Ma.cells.forEach(function(yd){var Jc=
hd.intersection(yd.bounds()).area()/yd.bounds().area();H.includes(yd)&&.1>Jc&&uc.removeCell(yd);!H.includes(yd)&&Jc>1/3&&uc.addCell(yd)})},onDragEnd:function(Lb){this.debugMorph.remove()},onDragStart:function(Lb){this.start(Lb.position)},onDrag:function(Lb){this.update(Lb.state.dragDelta)}})}},{key:"cellGuide",value:function(H){var aa=this,Ma=this.cellResizer(H,"topLeft"),tb=this.cellResizer(H,"bottomRight");return this.addGuide(new fa.CellGuide({cellGroup:H,bounds:H.bounds(),fill:fa.Color.transparent,
borderColor:fa.Color.orange,borderWidth:1,isHaloItem:!0,isCell:!0,draggable:!1,submorphs:[Ma,tb],onMouseDown:function(Lb){this.becomeActive()},deactivate:function(){this.borderColor=fa.Color.orange;this.fill=fa.Color.transparent;this.submorphs.forEach(function(Lb){Lb.visible=!1})},becomeActive:function(){aa.guides.forEach(function(Lb){Lb.isCell&&Lb.deactivate()});this.borderColor=fa.Color.rgbHex("#1565C0");this.fill=fa.Color.rgbHex("#1565C0").withA(.3);aa.addMorph(this.remove());this.submorphs.forEach(function(Lb){Lb.visible=
!0})},startPreview:function(Lb){this.fill=fa.Color.orange.withA(.7)},stopPreview:function(Lb){this.fill=fa.Color.transparent},onDrop:function(Lb){var uc=$jscomp.makeIterator(Lb.hand.grabbedMorphs).next().value;Lb.hand.dropMorphsOn(aa.container);H.morph=uc},alignWithTarget:function(){H.bounds().isNonEmpty()?(this.setBounds(H.bounds()),Ma.center=this.innerBounds().topLeft(),tb.center=this.innerBounds().bottomRight()):(fa.arr.remove(aa.guides,this),this.remove())}}))}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"GridLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:fa.Color.transparent},cells:{derived:!0,get:function(){return fa.arr.flatten(this.target.col(0).items.map(function(H){return H.row(0).items}))}},submorphs:{initialize:function(){this.initialize()}}}}}],Ja,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:12146,end:19501})}(fa.LayoutHalo));fa.GridLayoutHalo=nb;fa.GridLayoutHalo=nb;fa.GridLayoutHalo=nb;Xa=function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),bb=Ja.hasOwnProperty("TilingLayoutHalo")&&"function"===typeof Ja.TilingLayoutHalo?Ja.TilingLayoutHalo:Ja.TilingLayoutHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"remove",value:function(){Rb._get(Object.getPrototypeOf(bb.prototype),
"remove",this).call(this);this.removePreviews();return this}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"handleDrop",value:function(H){}},{key:"removePreviews",value:function(){this.previews.forEach(function(H){return H.clear()})}},{key:"previewDrop",value:function(H){var aa=this;0<this.previews.length||(this.previews=H.map(function(Ma){return aa.container.addMorph({type:fa.DropPreview,bounds:Ma.bounds()})}),this.previews.forEach(function(Ma){Ma.step()}))}},
{key:"updateSpacing",value:function(H){this.target.spacing=H}},{key:"updateAxis",value:function(H){this.target.axis=H}},{key:"updateAlign",value:function(H){this.target.align=H}},{key:"optionControls",value:function(){var H=this.target,aa=new fa.DropDownSelector({borderRadius:2,padding:3,selectedValue:H.axis,values:["row","column"]}),Ma=new fa.DropDownSelector({borderRadius:2,padding:3,selectedValue:H.align,values:["left","center"]});H=new fa.NumberWidget({min:0,number:H.spacing,padding:fa.rect(5,
3,0,0),borderRadius:3,borderWidth:1,borderColor:fa.Color.gray,unit:"px"});fa.connect(H,"update",this,"updateSpacing");fa.connect(Ma,"update",this,"updateAlign");fa.connect(aa,"update",this,"updateAxis");var tb={type:"label",padding:fa.rect(0,5,5,5),fill:fa.Color.transparent,fontColor:fa.Color.gray.darker(),readOnly:!0};return[[Object.assign({},tb,{textString:"Submorph Spacing"}),H],[Object.assign({},tb,{textString:"Tiling Align"}),Ma],[Object.assign({},tb,{textString:"Tiling Axis"}),aa]].map(function(Lb){return{submorphs:Lb,
fill:null,layout:new fa.HorizontalLayout({spacing:3})}})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TilingLayoutHalo"}},{key:"properties",get:function(){return{fill:{defaultValue:fa.Color.transparent},previews:{defaultValue:[]}}}}],Ja,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},
{start:19510,end:21708})}(fa.LayoutHalo);fa.TilingLayoutHalo=Xa;fa.TilingLayoutHalo=Xa;fa.TilingLayoutHalo=Xa;(function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),bb=Ja.hasOwnProperty("DropPreview")&&"function"===typeof Ja.DropPreview?Ja.DropPreview:Ja.DropPreview=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"clear",value:function(){this.stopped=!0;this.remove()}},{key:"step",
value:function(){var H=this,aa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){if(1==Ma.nextAddress)return aa=fa.easings.inOutQuad,Ma.yield(H.animate({opacity:.5,duration:(H.pulseDuration-10)/2,easing:aa}),2);if(3!=Ma.nextAddress)return Ma.yield(H.animate({opacity:1,duration:(H.pulseDuration-10)/2,easing:aa}),3);H.stopped||H.step();Ma.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DropPreview"}},{key:"properties",get:function(){return{isHaloItem:{readOnly:!0,
get:function(){return!0}},epiMorph:{readOnly:!0,get:function(){return!0}},fill:{defaultValue:fa.Color.orange.withA(.3)},hasFixedPosition:{defaultValue:!0},borderColor:{defaultValue:fa.Color.orange},borderWidth:{defaultValue:2},borderStyle:{defaultValue:"dashed"},pulseDuration:{defaultValue:2E3}}}}],Ja,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",
version:"0.1.0"}}},{start:21710,end:22534})})(fa.Morph);Xa=ta("F",function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),bb=Ja.hasOwnProperty("FlexLayoutHalo")&&"function"===typeof Ja.FlexLayoutHalo?Ja.FlexLayoutHalo:Ja.FlexLayoutHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"handleDrop",value:function(H){}},{key:"previewDrop",value:function(H){var aa=this;0<this.previews.length||
(this.previews=H.map(function(Ma){return aa.container.addMorph({type:fa.DropPreview,position:aa.container.localize(aa.world().firstHand.position),extent:Ma.bounds().extent()})}),this.previews.forEach(function(Ma){Ma.step()}))}},{key:"remove",value:function(){Rb._get(Object.getPrototypeOf(bb.prototype),"remove",this).call(this);this.removePreviews();return this}},{key:"removePreviews",value:function(){this.previews.forEach(function(H){return H.clear()})}},{key:"onDrop",value:function(H){this.removePreviews();
H.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateAutoResizePolicy",value:function(H){H&&(this.originalExtent=this.container.extent);this.target.autoResize=H;H||(this.container.extent=this.originalExtent||this.container.extent);this.alignWithTarget()}},{key:"updateResizeSubmorphsPolicy",value:function(H){this.target.resizeSubmorphs=H;this.alignWithTarget()}},{key:"updateAlignmentPolicy",value:function(H){this.target.align=
H}},{key:"updateDirectionPolicy",value:function(H){this.target.direction=H}},{key:"updateSpacing",value:function(H){this.target.spacing=H}},{key:"optionControls",value:function(){var H=this.target,aa=H.possibleAlignValues?{fill:fa.Color.transparent,layout:new fa.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"align: "},new fa.DropDownSelector({name:"alignment",borderRadius:2,padding:3,selectedValue:H.align,values:H.possibleAlignValues})]}:null,Ma=
H.possibleDirectionValues?{fill:fa.Color.transparent,layout:new fa.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"direction: "},new fa.DropDownSelector({name:"direction",borderRadius:2,padding:3,selectedValue:H.direction,values:H.possibleDirectionValues})]}:null,tb=new fa.NumberWidget({fill:fa.Color.white,borderWidth:1,borderRadius:4,padding:fa.rect(5,4,0,0),borderColor:fa.Color.gray,min:0,number:H.spacing,unit:"px"}),Lb=new fa.LabeledCheckBox({name:"autoResize",
label:"Resize Container",alignCheckBox:"right",fill:fa.Color.transparent,checked:H.autoResize});H=new fa.LabeledCheckBox({label:"Resize Submorphs",name:"resizeSubmorphs",alignCheckBox:"right",fill:fa.Color.transparent,checked:H.resizeSubmorphs});fa.connect(tb,"update",this,"updateSpacing");fa.connect(Lb,"checked",this,"updateAutoResizePolicy");fa.connect(H,"checked",this,"updateResizeSubmorphsPolicy");aa&&fa.connect(aa.submorphs[1],"selectedValue",this,"updateAlignmentPolicy");Ma&&fa.connect(Ma.submorphs[1],
"selectedValue",this,"updateDirectionPolicy");return[Lb,H].concat($jscomp.arrayFromIterable([aa,Ma].filter(Boolean)),[{fill:fa.Color.transparent,layout:new fa.HorizontalLayout,submorphs:[{type:"label",value:"Submorph Spacing",fontColor:fa.Color.gray.darker(),padding:fa.rect(0,5,5,5)},tb]}])}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FlexLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},fill:{defaultValue:fa.Color.transparent},halosEnabled:{defaultValue:!1},
previews:{defaultValue:[]}}}}],Ja,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:22543,end:26761})}(fa.LayoutHalo));fa.FlexLayoutHalo=Xa;fa.FlexLayoutHalo=Xa;fa.FlexLayoutHalo=Xa;Fc=ta("c",function(Qa){var Ja=lively.FreezerRuntime.recorderFor("lively.halos/layout.js"),bb=Ja.hasOwnProperty("ProportionalLayoutHalo")&&
"function"===typeof Ja.ProportionalLayoutHalo?Ja.ProportionalLayoutHalo:Ja.ProportionalLayoutHalo=function(H){H&&H[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Rb(bb,Qa,[{key:"handleDrop",value:function(H){}},{key:"onDrop",value:function(H){H.hand.dropMorphsOn(this.container)}},{key:"alignWithTarget",value:function(){this.setBounds(this.container.globalBounds())}},{key:"updateSubmorphProportionalLayoutSettings",value:function(H){var aa=
{};this.target.changeSettingsFor(H.submorph,(aa[H.axis]=H.policy,aa),!0)}},{key:"onSubmorphSettingsDragStart",value:function(H,aa){var Ma=this;H.stop();var tb=this.target.settingsFor(aa);aa="";for(var Lb in tb)aa+=Lb+":"+tb[Lb]+" ";var uc=fa.morph({type:"label",value:aa,isLayoutable:!1});uc.wantsToBeDroppedOn=function(hd){return Ma.target.layoutableSubmorphs.includes(hd)};uc.onBeingDroppedOn=function(hd,yd){uc.remove();if(hd=Ma.target.layoutableSubmorphs.includes(yd)?yd:H.world.morphsContainingPoint(H.hand.position).find(function(Jc){return Ma.target.layoutableSubmorphs.includes(Jc)}))Ma.updateSubmorphProportionalLayoutSettings({policy:tb.x,
axis:"x",submorph:hd}),Ma.updateSubmorphProportionalLayoutSettings({policy:tb.y,axis:"y",submorph:hd}),hd.show(),$world.setStatusMessage("layout settings applied")};H.hand.grab(uc)}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var H=this,aa,Ma,tb,Lb,uc,hd,yd,Jc,Fd,Yd,ie,ue;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ye){switch(Ye.nextAddress){case 1:return aa=H.target.layoutableSubmorphs,H.env.eventDispatcher.isKeyPressed("Shift")?(tb=aa.map(function(Db){return{isListItem:!0,
string:String(Db),value:Db}}),Ye.yield($world.listPrompt("Select morph",tb,{requester:H,onSelection:function(Db){return Db.show()}}),5)):Ye.yield(fa.InteractiveMorphSelector.selectMorph(H.world(),H,function(Db){return aa.includes(Db)}),4);case 4:Ma=Ye.yieldResult;Ye.jumpTo(3);break;case 5:Lb=Ye.yieldResult,uc=$jscomp.makeIterator(Lb.selected),Ma=uc.next().value;case 3:if(!Ma)return Ye.return();hd=H.state.popover.get("controlContainer");yd=hd.getAllNamed(/submorph config/);Jc=["move","resize","scale",
"fixed"];Fd=H.target.settingsFor(Ma);yd.length||(hd.submorphs=[].concat($jscomp.arrayFromIterable(hd.submorphs),[{name:"submorph config X-Axis policy",position:fa.pt(0,H.height),fill:fa.Color.transparent,layout:new fa.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph X-Axis policy: "},new fa.DropDownSelector({name:"x-axis policy selector",borderRadius:2,padding:3,selectedValue:Fd.x,values:Jc})]},{name:"submorph config Y-Axis policy",position:fa.pt(0,
H.height),fill:fa.Color.transparent,layout:new fa.HorizontalLayout({spacing:3,direction:"centered",align:"center"}),submorphs:[{type:"label",value:"submorph Y-Axis policy: "},new fa.DropDownSelector({name:"y-axis policy selector",borderRadius:2,padding:3,selectedValue:Fd.y,values:Jc})]},fa.morph({position:fa.pt(0,H.height+20),draggable:!0,name:"dragme",type:"label",value:"drag me to copy"})]));Yd=hd.getSubmorphNamed("x-axis policy selector");ie=hd.getSubmorphNamed("y-axis policy selector");ue=hd.getSubmorphNamed("dragme");
fa.disconnect(Yd,"selectedValue",H,"updateSubmorphProportionalLayoutSettings");fa.disconnect(ie,"selectedValue",H,"updateSubmorphProportionalLayoutSettings");Yd.selectedValue=Fd.x;ie.selectedValue=Fd.y;fa.connect(ue,"onDragStart",H,"onSubmorphSettingsDragStart",{updater:function(Db,Lf){return Db(Lf,Ma)},varMapping:{submorph:Ma}});fa.connect(Yd,"selectedValue",H,"updateSubmorphProportionalLayoutSettings",{converter:function(Db){return{policy:Db,axis:"x",submorph:Ma}},varMapping:{submorph:Ma}});fa.connect(ie,
"selectedValue",H,"updateSubmorphProportionalLayoutSettings",{converter:function(Db){return{policy:Db,axis:"y",submorph:Ma}},varMapping:{submorph:Ma}});Ye.jumpToEnd()}})}},{key:"optionControls",value:function(H){this.state.popover=H;var aa=this.target;H=new fa.LabeledCheckBox({name:"x-axis",label:"X-Axis",alignCheckBox:"right",fill:fa.Color.transparent,checked:aa.xAxisEnabled});aa=new fa.LabeledCheckBox({name:"y-axis",label:"Y-Axis",alignCheckBox:"right",fill:fa.Color.transparent,checked:aa.yAxisEnabled});
var Ma=new fa.Button({name:"modify submorph settings button",label:[].concat($jscomp.arrayFromIterable(fa.Icon.textAttribute("crosshairs")),["\u00a0Change submorph settings"])});fa.connect(H,"checked",this,"updateXAxisEnabled");fa.connect(aa,"checked",this,"updateYAxisEnabled");fa.connect(Ma,"fire",this,"chooseSubmorphToChangeLayoutSettings");return[Ma]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProportionalLayoutHalo"}},{key:"properties",get:function(){return{reactsToPointer:{defaultValue:!1},
fill:{defaultValue:fa.Color.transparent}}}}],Ja,{pathInPackage:function(){return"layout.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.halos",version:"0.1.0"}}},{start:26771,end:32465})}(fa.LayoutHalo));fa.ProportionalLayoutHalo=Fc;fa.ProportionalLayoutHalo=Fc;fa.ProportionalLayoutHalo=Fc;Rc=lively.FreezerRuntime.recorderFor("lively.halos/index.js");Rc.Halo=tc;
Rc.MorphHighlighter=ab;Rc.InteractiveMorphSelector=zc;Rc.StatusMessage=pd;Rc.StatusMessageForMorph=$c;Rc.show=Zb;Rc.showConnector=Oc;Rc.ProportionalLayoutHalo=Fc;Rc.GridLayoutHalo=nb;Rc.FlexLayoutHalo=Xa;Rc.showAndSnapToGuides=Ia;Rc.removeSnapToGuidesOf=da;Rc.StatusMessage=pd;Rc.StatusMessage=pd;Rc.StatusMessageForMorph=$c;Rc.StatusMessageForMorph=$c;Rc.show=Zb;Rc.show=Zb;Rc.showConnector=Oc;Rc.showConnector=Oc;Rc.Halo=tc;Rc.Halo=tc;Rc.MorphHighlighter=ab;Rc.MorphHighlighter=ab;Rc.InteractiveMorphSelector=
zc;Rc.InteractiveMorphSelector=zc;Rc.ProportionalLayoutHalo=Fc;Rc.ProportionalLayoutHalo=Fc;Rc.GridLayoutHalo=nb;Rc.GridLayoutHalo=nb;Rc.FlexLayoutHalo=Xa;Rc.FlexLayoutHalo=Xa;Rc.showAndSnapToGuides=Ia;Rc.showAndSnapToGuides=Ia;Rc.removeSnapToGuidesOf=da;Rc.removeSnapToGuidesOf=da;pd=Object.freeze({__proto__:null,StatusMessage:pd,StatusMessageForMorph:$c,show:Zb,showConnector:Oc,Halo:tc,MorphHighlighter:ab,InteractiveMorphSelector:zc,ProportionalLayoutHalo:Fc,GridLayoutHalo:nb,FlexLayoutHalo:Xa,showAndSnapToGuides:Ia,
removeSnapToGuidesOf:da,SvgStyleHalo:void 0});ta("i",pd);ta("_",void 0)}}});
System.register(["./__root_module__-884b54f8.js","kld-intersections","./index-9ec474a0.js","./index-27557bc7.js","./editor-plugin-bcd9fa99.js"],function(za){var cb,mb,Pb,tb,Fc,vc,Qc,mc,ic,zc,Dc,Gd,Hd,Zd,xc,od,qb,kc,Uc,tc,cd,td,nb,cc;return{setters:[function(wc){cb=wc.i;mb=wc.bJ;Pb=wc.bK;tb=wc.bL;Fc=wc.bM;vc=wc.c;Qc=wc._;mc=wc.s;ic=wc.a3;zc=wc.bz;Dc=wc.a;Gd=wc.p;Hd=wc.bN;Zd=wc.a_},function(){},function(wc){xc=wc.s},function(wc){od=wc.localInterface;qb=wc.systemInterfaceNamed;kc=wc.serverInterfaceFor;Uc=
wc.l2lInterfaceFor},function(wc){tc=wc.p;cd=wc.d;td=wc.a;nb=wc.r;cc=wc.C}],execute:function(){var wc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");wc.warnStyle={"border-bottom":"2px dotted orange"};wc.errorStyle={"background-color":"red"};var dc=function(Jb){var Cb=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),Bb=Cb.hasOwnProperty("JavaScriptChecker")&&"function"===typeof Cb.JavaScriptChecker?Cb.JavaScriptChecker:Cb.JavaScriptChecker=function(sa){sa&&sa[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(Bb,Jb,[{key:"uninstall",value:function(sa){var Ta=sa.text||sa;(Ta.markers||[]).forEach(function(O){return O.id.startsWith("js-checker-")&&Ta.removeMarker(O)});Ta.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(sa,Ta){return[].concat($jscomp.arrayFromIterable(sa.embeddedMorphMap.values())).find(function(O){return Ta.containsPosition(O.anchor.position)})}},{key:"onDocumentChange",value:function(sa,
Ta,O){var U=Ta.document;try{var ra=O.parse()}catch(xa){ra=xa}ra&&(sa=(Ta.markers||[]).filter(function(xa){return xa.id.startsWith("js-checker-")}),O=O.undeclaredVariables().map(function(xa,pa){var ea=xa.start;xa=xa.end;ea=U.indexToPosition(ea);xa=U.indexToPosition(xa);return Ta.addMarker({id:"js-checker-"+pa,style:wc.warnStyle,range:{start:ea,end:xa},type:"js-undeclared-var"})}),sa.slice(O.length).forEach(function(xa){return Ta.removeMarker(xa)}),ra.parseError?(sa=ra.parseError.loc,O=sa.column,sa=
sa.line-1,ra=U.indexToPosition(ra.parseError.pos),O=ra.column,sa=ra.row,ra={start:{column:O-1,row:sa},end:{column:O+1,row:sa}},this.hasEmbeddedMorphInRange(Ta,ra)||Ta.addMarker({id:"js-syntax-error",range:ra,style:wc.errorStyle,type:"js-syntax-error"})):Ta.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],Cb,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),Nc=dc=wc.JavaScriptChecker;wc.default=dc;var $a=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");$a.query=mb;$a.fuzzyParse=Pb;$a.acorn=tb;$a.custom=Fc;var Xa=function(Jb){var Cb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),Bb=Cb.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof Cb.JavaScriptNavigator?
Cb.JavaScriptNavigator:Cb.JavaScriptNavigator=function(sa){sa&&sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(Bb,Jb,[{key:"ensureAST",value:function(sa){return this.parse(sa.textString)}},{key:"parse",value:function(sa){return $a.fuzzyParse(sa)}},{key:"move",value:function(sa,Ta){var O=!!Ta.activeMark||!Ta.selection.isEmpty(),U=Ta.selection,ra=Ta.positionToIndex(U.lead);sa=this[sa](Ta.textString,ra);sa=Ta.indexToPosition(sa);
U.lead=sa;O||(U.anchor=sa);Ta.scrollCursorIntoView()}},{key:"forwardSexp",value:function(sa){this.move("_forwardSexp",sa)}},{key:"backwardSexp",value:function(sa){this.move("_backwardSexp",sa)}},{key:"backwardUpSexp",value:function(sa){this.move("_backwardUpSexp",sa)}},{key:"forwardDownSexp",value:function(sa){this.move("_forwardDownSexp",sa)}},{key:"_forwardSexp",value:function(sa,Ta){sa=this.parse(sa);sa=$a.custom.findNodesIncluding(sa,Ta).reverse().find(function(U){return U.end!==Ta});if(!sa)return Ta;
if("BlockStatement"===sa.type){var O=sa.body.find(function(U){return U.start>Ta});if(O)return O.start}return sa.end}},{key:"_backwardSexp",value:function(sa,Ta){sa=this.parse(sa);sa=$a.custom.findNodesIncluding(sa,Ta).reverse().find(function(U){return U.start!==Ta});if(!sa)return Ta;if("BlockStatement"===sa.type){var O=sa.body.slice().reverse().find(function(U){return U.end<Ta});if(O)return O.end}return sa?sa.start:Ta}},{key:"_backwardUpSexp",value:function(sa,Ta){sa=this.parse(sa);return(sa=$a.custom.findNodesIncluding(sa,
Ta).reverse().find(function(O){return O.start!==Ta}))?sa.start:Ta}},{key:"_forwardDownSexp",value:function(sa,Ta){sa=this.parse(sa);return(sa=$a.custom.findNodeAfter(sa,Ta,function(O,U){return U.start>Ta}))?sa.node.start:Ta}},{key:"markDefun",value:function(sa){var Ta=this.rangeForFunctionOrDefinition(sa.textString,[sa.positionToIndex(sa.selection.range.start),sa.positionToIndex(sa.selection.range.end)]);Ta&&sa.execCommand("expandRegion",{start:Ta[0],end:Ta[1]})}},{key:"rangeForNodesMatching",value:function(sa,
Ta,O){sa=this.parse(sa);return(Ta=$a.custom.findNodesIncluding(sa,Ta).reverse().find(O))?[Ta.start,Ta.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(sa,Ta){var O=Ta[0]===Ta[1];return this.rangeForNodesMatching(sa,Ta[1],function(U){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(U.type)&&(O&&U.end!==Ta[1]||!O&&U.start<Ta[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(sa,Ta){"number"!==typeof Ta&&(Ta=sa.positionToIndex(Ta));
sa=this.ensureAST(sa);var O=$a.query.nodesAt(Ta,sa).reverse(),U=O.find(function(xa){return"Identifier"===xa.type});if(!U&&((O=O[0])&&O.type.includes("Specifier")&&O.local&&"Identifier"===O.local.type&&(U=O.local),!U))return;Ta=(O=$a.query.findDeclarationClosestToIndex(sa,U.name,Ta))?$a.query.scopeAtIndex(sa,O.start):$a.query.scopeAtIndex(sa,Ta);var ra=$a.query.findReferencesAndDeclsInScope(Ta,U.name).refs;return{parsed:sa,scope:Ta,id:U,name:U.name,decl:O,refs:ra}}},{key:"expandRegion",value:function(sa,
Ta,O,U){function ra(bb){bb=sa.positionToIndex({column:0,row:pa.row});return{range:[bb+ea.start,bb+ea.start+ea.value.length],prev:U}}var xa=U.range[0]!==U.range[1],pa=sa.indexToPosition(U.range[0]),ea=sa.tokenAt(pa);if(!xa&&ea&&["keyword","identifier"].includes(ea.type))return ra();O=O||this.parse(Ta);Ta=$a.query.nodesAtIndex(O,U.range[0]).reverse().find(function(bb){return bb.start<U.range[0]||bb.end>U.range[1]});if(!Ta)return U;O=Ta.start;xa=Ta.end;return"Literal"===Ta.type&&(Ta.raw||"").match(/^['"`]/)&&
U.range[0]!==Ta.start&&U.range[1]!==Ta.end&&(Ta.start+1<U.range[0]||Ta.end-1>U.range[1])?{range:[O+1,xa-1],prev:U}:{range:[O,xa],prev:U}}},{key:"contractRegion",value:function(sa,Ta,O,U){return U.prev||U}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],Cb,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:121,end:6780})}(void 0);dc=Xa=$a.JavaScriptNavigator;$a.default=Xa;var Gb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");Gb.addIndexToTextPos=function(Jb,Cb,Bb){return Jb.indexToPosition(Jb.positionToIndex(Cb)+Bb)};Gb.connect=vc;Gb.disconnect=Qc;Gb.string=mc;Gb.KeyHandler=ic;Gb.Range=zc;Xa=function(Jb){var Cb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),Bb=Cb.hasOwnProperty("Snippet")&&"function"===typeof Cb.Snippet?Cb.Snippet:Cb.Snippet=
function(sa){sa&&sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(Bb,Jb,[{key:Symbol.for("lively-instance-initialize"),value:function(sa){sa=void 0===sa?{trigger:null,expansion:""}:sa;var Ta=sa.expansion;this.trigger=sa.trigger;this.expansion=Ta;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(sa){this.isExpanding&&(this.textMorph=sa,Gb.connect(this.textMorph,"selectionChange",
this,"onCursorMove"))}},{key:"detach",value:function(sa){this.isExpanding&&(Gb.disconnect(sa,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var sa=this.expansionState,Ta=sa.startAnchor,O=sa.endAnchor;sa.isExpanding?Gb.Range.fromPositions(Ta.position,O.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var sa=this.textMorph;if(sa){var Ta=this.expansionState||
{},O=Ta.marker,U=Ta.startAnchor,ra=Ta.endAnchor;Ta=Ta.steps;U&&sa.removeAnchor(U);ra&&sa.removeAnchor(ra);O&&sa.removeMarker(O);Ta.forEach(function(xa){return sa.removeAnchor(xa.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};sa&&sa.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(sa){var Ta=[],O=0;Gb.string.reMatches(sa,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(U){var ra=
U.start,xa=U.end;U=U.match;var pa="";U.startsWith("${")?(pa=$jscomp.makeIterator(U.match(/^\$\{([0-9]+):([^\}]*)\}/)),pa.next(),U=pa.next().value,pa=pa.next().value,U=Number(U)):U=Number(U.replace(/^\$/,""));sa=sa.slice(0,ra-O)+pa+sa.slice(xa-O);Ta[U]={index:ra-O,prefill:pa,anchor:null};O+=xa-ra-pa.length});return{steps:Ta,expansion:sa}}},{key:"expandAtCursor",value:function(sa){var Ta=sa.selection,O=sa.cursorPosition.column,U=this.expansion;this.trigger&&(O-=this.trigger.length);if(O=Math.max(0,
O))U=Gb.string.lines(U),U=[U[0]].concat($jscomp.arrayFromIterable(U.slice(1).map(function(Aa){return Gb.string.indent(Aa," ",O)}))),U=U.join("\n");var ra=this.createExpansionSteps(U);U=ra.expansion;ra=ra.steps;this.trigger&&Ta.growLeft(this.trigger.length);Ta.text=U;var xa=Ta.start;U=Ta.end;Ta.collapseToEnd();if(ra.length){var pa=Gb.string.newUUID();ra.forEach(function(Aa,Rb){return Aa.anchor=sa.addAnchor(Object.assign({id:"snippet-step-"+Rb+"-"+pa},Gb.addIndexToTextPos(sa,xa,Aa.index)))});var ea=
sa.addAnchor(Object.assign({id:"snippet-start-"+pa},xa,{insertBehavior:"stay"})),bb=sa.addAnchor(Object.assign({id:"snippet-end-"+pa},U));this.expansionState={marker:sa.addMarker({id:"snippet-marker-"+pa,get range(){return{start:ea.position,end:bb.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:ea,endAnchor:bb,stepIndex:0,steps:ra,isExpanding:!0};sa.addPlugin(this);
this.nextStep()}}},{key:"nextStep",value:function(){var sa=this.expansionState,Ta=sa.steps,O=this.textMorph;if(sa.isExpanding&&O){O=O.selection;sa=Ta[sa.stepIndex];var U=sa.prefill;O.lead=O.anchor=sa.anchor.position;O.growRight(U.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=Ta.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(sa,Ta){Ta=sa.positionToIndex(sa.cursorPosition);return sa.textString.slice(Ta-
this.trigger.length,Ta)===this.trigger}},{key:"tryTrigger",value:function(sa,Ta){if(!this.canExpand(sa,sa.cursorPosition))return!1;this.expandAtCursor(sa);return!0}},{key:"getCommands",value:function(sa){var Ta=this;return sa.concat([{name:"[snippet] next expansion step",exec:function(O){Ta.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(O){Ta.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(sa){return sa.concat(Gb.KeyHandler.withBindings([{keys:"Tab",
command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],Cb,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:357,end:6029})}(void 0);Gb.Snippet=Xa;Gb.Snippet=Xa;Gb.Snippet=
Xa;var ub=[{name:"get snippets",exec:function(Jb){return Jb.pluginCollect("getSnippets",[])}}];Gb.snippetCommands=ub;Gb.snippetCommands=ub;Gb.snippetCommands=ub;var db=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");db.buildEvalOpts=function(Jb,Cb){return Jb.plugins.find(function(Bb){return Bb.isJSEditorPlugin}).sanatizedJsEnv(Cb)};db.Snippet=Xa;ub=function(Jb){var Cb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Bb=Cb.hasOwnProperty("ModuleTopLevelVarCompleter")&&
"function"===typeof Cb.ModuleTopLevelVarCompleter?Cb.ModuleTopLevelVarCompleter:Cb.ModuleTopLevelVarCompleter=function(sa){sa&&sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(Bb,Jb,[{key:"compute",value:function(sa,Ta){var O,U,ra,xa,pa,ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bb){if(1==bb.nextAddress){U=(O=sa.pluginFind(function(Aa){return Aa.isJSEditorPlugin}))&&O.systemInterface();if(!U)return bb.return([]);
ra=db.buildEvalOpts(sa);xa=ra.targetModule;return"local"===U.name?(pa=Object.getOwnPropertyNames(U.getModule(xa).recorder),bb.jumpTo(2)):bb.yield(U.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+xa+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',
{targetModule:"lively://module-recorder-completer"}),3)}if(2!=bb.nextAddress){ea=bb.yieldResult;if(ea.isError)return bb.return([]);pa=JSON.parse(ea.value)}pa=pa.filter(function(Aa){return!Aa.startsWith("defVar_")&&!["System","__currentLivelyModule","initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(Aa)});return bb.return(pa.map(function(Aa){return{priority:1100,completion:Aa}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],
Cb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:227,end:1700})}(void 0);db.ModuleTopLevelVarCompleter=ub;db.ModuleTopLevelVarCompleter=ub;db.ModuleTopLevelVarCompleter=ub;ub=function(Jb){var Cb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Bb=Cb.hasOwnProperty("DynamicJavaScriptCompleter")&&
"function"===typeof Cb.DynamicJavaScriptCompleter?Cb.DynamicJavaScriptCompleter:Cb.DynamicJavaScriptCompleter=function(sa){sa&&sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(Bb,Jb,[{key:"isValidPrefix",value:function(sa){return/\.[a-z0-9_]*$/i.test(sa)}},{key:"isMethodCallCompletion",value:function(sa){return sa.endsWith(")")&&0<sa.indexOf("(")}},{key:"isValidIdentifier",value:function(sa){if("string"!==typeof sa)return!1;
this.isMethodCallCompletion(sa)&&(sa=sa.slice(0,sa.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(sa)?!0:!1}},{key:"wrapInBrackets",value:function(sa){if(!isNaN(Number(sa))||sa.startsWith("Symbol."))return"["+sa+"]";var Ta="";this.isMethodCallCompletion(sa)&&(Ta=sa.slice(sa.indexOf("(")),sa=sa.slice(0,sa.indexOf("(")));return'["'+sa.replace(/"/g,'\\"')+'"]'+Ta}},{key:"compute",value:function(sa){var Ta=this,O,U,ra,xa,pa,ea,bb,Aa,Rb,Gc,Ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hc){if(1==
Hc.nextAddress){O=sa.selection;O.isEmpty()?(U=sa.getLine(O.lead.row),U=U.slice(U.lastIndexOf(":")+1,O.lead.column)):U=O.text.slice(Math.max(0,O.text.indexOf(":")),0);if(!Ta.isValidPrefix(U))return Hc.return([]);xa=(ra=sa.pluginFind(function(fb){return fb.isJSEditorPlugin}))&&ra.systemInterface();if(!xa)return Hc.return([]);pa=db.buildEvalOpts(sa);return Hc.yield(xa.dynamicCompletionsForPrefix(pa.targetModule,U,pa),2)}ea=Hc.yieldResult;bb=ea.isError;Aa=ea.value;Rb=ea.completions;Gc=ea.prefix;if(bb)return console.warn("javascript completer encountered error: "+
(Aa.stack||Aa)),Hc.return([]);Rb.reduce(function(fb,ud){ud=$jscomp.makeIterator(ud);ud.next();ud=ud.next().value;return fb+ud.length},0);Ab=Rb.reduce(function(fb,ud,je){ud=$jscomp.makeIterator(ud);var rc=ud.next().value;ud=ud.next().value;return fb.concat(ud.map(function(gb){var Id=Ta.isValidIdentifier(gb);return{info:rc,completion:gb,prefix:Id?Gc:"."+Gc,customInsertionFn:Id?Ta.isMethodCallCompletion(gb)?function(hb,Za,ua,J){Za=J.start;J=J.end;hb=hb.replace(/\((.*)\)/,function(la){return"("+la.slice(1,
-1).split(", ").map(function(La,ib){return"${"+ib+":"+La+"}"}).join(", ")+")"});hb=new db.Snippet({expansion:hb});ua.replace({start:Za,end:J},"");hb.expandAtCursor(ua)}:null:function(hb,Za,ua,J){hb=J.start;J=J.end;Za={row:hb.row,column:hb.column-1};J="."===ua.textInRange({start:Za,end:hb})?{start:Za,end:J}:{start:hb,end:J};ua.replace(J,Ta.wrapInBrackets(gb))}}}))},[]);Ab.forEach(function(fb,ud){return Object.assign(fb,{priority:2E3+Ab.length-ud})});return Hc.return(Ab)})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DynamicJavaScriptCompleter"}}],Cb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5155})}(void 0);db.DynamicJavaScriptCompleter=ub;db.DynamicJavaScriptCompleter=ub;db.DynamicJavaScriptCompleter=ub;db.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
ub=function(Jb){var Cb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),Bb=Cb.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof Cb.JavaScriptKeywordCompleter?Cb.JavaScriptKeywordCompleter:Cb.JavaScriptKeywordCompleter=function(sa){sa&&sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(Bb,Jb,[{key:"compute",value:function(sa,Ta){return db.keywords.map(function(O){return{completion:O,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],Cb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6157,end:6295})}(void 0);db.JavaScriptKeywordCompleter=ub;db.JavaScriptKeywordCompleter=ub;db.JavaScriptKeywordCompleter=ub;ub=[new db.DynamicJavaScriptCompleter,
new db.JavaScriptKeywordCompleter,new db.ModuleTopLevelVarCompleter];db.completers=ub;db.completers=ub;db.completers=ub;var Xb=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");Xb.Snippet=Xa;var Fa=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];Xb.snippets=Fa;Xb.snippets=Fa;Xb.snippets=Fa;var sb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");sb.getEvalEnv=function(Jb){return(Jb=Jb.pluginFind(function(Cb){return Cb.isJSEditorPlugin}))?Jb.evalEnvironment:null};sb.setEvalEnv=function(Jb,Cb){(Jb=Jb.pluginFind(function(Bb){return Bb.isJSEditorPlugin}))&&Object.assign(Jb.evalEnvironment,Cb);return Jb.evalEnvironment};
sb.pToI=function(Jb,Cb){return Jb.positionToIndex(Cb)};sb.iToP=function(Jb,Cb){return Jb.indexToPosition(Cb)};sb.arr=Dc;sb.promise=Gd;sb.string=mc;sb.show=xc;sb.Range=zc;sb.query=mb;sb.BaseVisitor=Hd;Xb=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(Jb,Cb){Cb=void 0===Cb?{varName:null,position:null}:Cb;var Bb,sa,Ta,O,U,ra,xa,pa,ea,bb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Aa){switch(Aa.nextAddress){case 1:Bb=
Cb;sa=Bb.varName;Ta=Bb.position;if(!sa){Ta||(Ta=Jb.cursorPosition);O=Jb.pluginInvokeFirst("getNavigator");U=O.ensureAST(Jb);ra=sb.query.nodesAt(Jb.positionToIndex(Ta),U).reverse().find(function(Rb){return"Identifier"===Rb.type});if(!ra)return Jb.showError(Error("no identifier found!")),Aa.return(!0);sa=ra.name}Cb=Jb.pluginFind(function(Rb){return Rb.isJSEditorPlugin}).sanatizedJsEnv();xa='lively.modules.module("'+Cb.targetModule+'").undefine("'+sa+'")';Aa.setCatchFinallyBlocks(2);return Aa.yield(Jb.doEval(null,
Cb,xa),4);case 4:pa=Aa.yieldResult;ea=pa.error?pa.error:pa.isError?pa.value:null;Aa.leaveTryBlock(3);break;case 2:ea=bb=Aa.enterCatchBlock();case 3:return ea?Jb.showError(ea):Jb.setStatusMessage(sa+" undefined"),Aa.return(!0)}})}},{name:"change doitContext",exec:function(Jb){var Cb,Bb,sa,Ta,O;return $jscomp.asyncExecutePromiseGeneratorProgram(function(U){if(1==U.nextAddress)return Cb=$jscomp,Bb=Cb.makeIterator,U.yield(Jb.world().execCommand("select morph",{prompt:"select morph for doitContext",justReturn:!0,
prependItems:["reset"],filterFn:function(ra){return!ra.isUsedAsEpiMorph()}}),2);sa=Bb.call(Cb,U.yieldResult);if(Ta=sa.next().value)O="reset"===Ta,Jb.doitContext=O?null:Ta,Jb.setStatusMessage(O?"doitContext is now\n"+Ta:"doitContext reset");return U.return(!0)})}},{name:"change eval backend",exec:function(Jb,Cb){Cb=void 0===Cb?{backend:void 0}:Cb;var Bb,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return Bb=Cb,sa=Bb.backend,void 0!==sa?Ta.jumpTo(2):Ta.yield(Jb.world().prompt("choose eval backend",
{historyId:"js-eval-backend-history"}),3);if(2!=Ta.nextAddress&&(sa=Ta.yieldResult,!sa))return Jb.setStatusMessage("Canceled"),Ta.return(!0);"local"===sa&&(sa=null);Jb.setStatusMessage("Eval backend is now "+(sa||"local"));return Ta.return(sb.setEvalEnv(Jb,{remote:sa}))})}},{name:"copy current module name to clipboard",exec:function(Jb){var Cb=Jb.evalEnvironment.targetModule;Jb.setStatusMessage(Cb||"Cannot find module name");Jb.env.eventDispatcher.killRing.add(Jb);Jb.env.eventDispatcher.doCopy(Cb);
return!0}}];sb.jsEditorCommands=Xb;sb.jsEditorCommands=Xb;sb.jsEditorCommands=Xb;var Ya=[{name:"[javascript] list errors and warnings",exec:function(Jb){var Cb,Bb,sa,Ta,O;return $jscomp.asyncExecutePromiseGeneratorProgram(function(U){if(1==U.nextAddress){Cb=(Jb.markers||[]).filter(function(ra){ra=ra.type;return"js-undeclared-var"===ra||"js-syntax-error"===ra});if(!Cb.length)return sb.show("no warnings or errors"),U.return(!0);Bb=Cb.map(function(ra){var xa=ra.range;return{isListItem:!0,string:"["+
ra.type.split("-").slice(1).join(" ")+"] "+Jb.textInRange(xa),value:xa}});return U.yield(Jb.world().filterableListPrompt("jump to warning or error",Bb),2)}sa=U.yieldResult;Ta=$jscomp.makeIterator(sa.selected);if(O=Ta.next().value)Jb.saveMark(),Jb.selection=O,Jb.centerRow(O.start.row);return U.return(!0)})}},{name:"[javascript] inject import",exec:function(Jb,Cb){Cb=void 0===Cb?{gotoImport:!1,insertImportAtCursor:!0}:Cb;var Bb,sa,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(O){switch(O.nextAddress){case 1:return O.yield(sb.promise.delay(0),
2);case 2:return O.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return Bb=O.yieldResult,sa=Bb.interactivelyInjectImportIntoText,O.yield(sa(Jb,Cb),4);case 4:return(Ta=O.yieldResult)||Jb.setStatusMessage("canceled"),O.return(Ta)}})}},{name:"[javascript] fix undeclared variables",exec:function(Jb,Cb){Cb=void 0===Cb?{ignore:[],autoApplyIfSingleChoice:!1,requester:Jb}:Cb;var Bb,sa,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(O){if(1==O.nextAddress)return O.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=O.nextAddress)return Bb=O.yieldResult,sa=Bb.interactivlyFixUndeclaredVariables,O.yield(sa(Jb,Cb),3);Ta=O.yieldResult;Jb.focus();return O.return(Ta)})}},{name:"[javascript] remove unused imports",exec:function(Jb,Cb){Cb=void 0===Cb?{query:!0}:Cb;var Bb,sa,Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(O){if(1==O.nextAddress)return O.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=O.nextAddress)return Bb=O.yieldResult,sa=Bb.cleanupUnusedImports,O.yield(sa(Jb,
Cb),3);Ta=O.yieldResult;Jb.setStatusMessage(Ta);return O.return(!0)})}},{name:"[javascript] eslint report",exec:function(Jb){var Cb,Bb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sa){if(1==sa.nextAddress)return sa.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);Cb=sa.yieldResult;Bb=Cb.default;try{return sa.return(Bb.reportOnMorph(Jb))}catch(Ta){Jb.showError(Ta)}sa.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(Jb){var Cb,Bb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sa){if(1==
sa.nextAddress)return sa.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);Cb=sa.yieldResult;Bb=Cb.default;try{return sa.return(Bb.previewFixesOnMorph(Jb))}catch(Ta){Jb.showError(Ta)}sa.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(Jb,Cb,Bb){function sa(Hc,fb){fb||(fb=pa(Hc,{allowReturnOutsideFunction:!0}));var ud=sb.string.lineRanges(Hc),je=Hc.split("\n"),rc=[],gb=new sb.BaseVisitor,Id=gb.visitVariableDeclaration;gb.visitVariableDeclaration=
function(J,la,La){if(1<J.declarations.length)for(var ib=sb.string.findLineWithIndexInLineRanges(ud,J.start),Ib=J.declarations[0].start-ud[ib][0],hc={},Vb=1;Vb<J.declarations.length;hc={$jscomp$loop$prop$actionType$2738:hc.$jscomp$loop$prop$actionType$2738,$jscomp$loop$prop$arg$2739:hc.$jscomp$loop$prop$arg$2739},Vb++){var Oc=J.declarations[Vb],Pc=sb.string.findLineWithIndexInLineRanges(ud,Oc.start);if(ib!==Pc){var Yd=je[Pc].match(/\s*/)[0].length;Yd=Ib-Yd;0!==Yd&&(Oc=sb.string.findLineWithIndexInLineRanges(ud,
Oc.end),hc.$jscomp$loop$prop$actionType$2738=0<Yd?"insert":"delete",hc.$jscomp$loop$prop$arg$2739=0<Yd?" ".repeat(Yd):-Yd,rc.push.apply(rc,$jscomp.arrayFromIterable(sb.arr.range(Pc,Oc).map(function(r){return function(Rd){return[r.$jscomp$loop$prop$actionType$2738,ud[Rd][0],r.$jscomp$loop$prop$arg$2739]}}(hc)))))}}return Id.call(gb,J,la,La)};gb.accept(fb,{},[]);for(fb=rc.length;fb--;){var hb=$jscomp.makeIterator(rc[fb]),Za=hb.next().value,ua=hb.next().value;hb=hb.next().value;"insert"===Za?Hc=Hc.slice(0,
ua)+hb+Hc.slice(ua):"delete"===Za&&(Hc=Hc.slice(0,ua)+Hc.slice(ua+hb))}return Hc}var Ta,O,U,ra,xa,pa,ea,bb,Aa,Rb,Gc,Ab;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hc){switch(Hc.nextAddress){case 1:return Ta=Bb||Math.floor(Jb.width/Jb.defaultCharExtent().width),Cb=Object.assign({printWidth:Ta,tabWidth:2,useTabs:!1,bracketSpacing:!1},Cb),O=lively.modules.module,U=System.normalizeSync("prettier/standalone.js"),Hc.yield(O(U).load({format:"global",instrument:!1}),2);case 2:return ra=Hc.yieldResult,
Hc.yield(O("lively.ast/lib/acorn-extension.js").load(),3);case 3:return Hc.yield(O("lively.ast").load(),4);case 4:return xa=Hc.yieldResult,pa=xa.parse,Hc.yield(O("lively.ast/lib/query.js").load(),5);case 5:return Hc.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return ea=Hc.yieldResult,bb=Jb.selection.isEmpty()?Jb.documentRange:Jb.selection.range,Aa=Jb.positionToIndex(bb.start),Rb=Jb.positionToIndex(bb.end),Gc=ra.format(Jb.textString,Object.assign({},Cb,{rangeStart:Aa,
rangeEnd:Rb,parser:function(fb,ud,je){return pa(fb,{allowReturnOutsideFunction:!0})}})),Jb.undoManager.group(),Ab=ea.diffChars(Jb.textString,Gc),Jb.applyJsDiffPatch(Ab),Jb.selection.text=sa(Jb.selection.text),Jb.undoManager.group(),Hc.return(!0)}})}}];sb.jsIdeCommands=Ya;sb.jsIdeCommands=Ya;sb.jsIdeCommands=Ya;var pb=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(Jb,Cb){Cb=Jb.pluginInvokeFirst("getNavigator");if(!Cb)return!0;Cb=Cb.resolveIdentifierAt(Jb,Jb.cursorPosition);if(!Cb||
!Cb.id)return sb.show("No symbol identifier selected"),!0;if(!Cb.decl)return sb.show("Cannot find declaration of "+Cb.name),!0;Jb.saveMark();Jb.selection={start:Jb.indexToPosition(Cb.decl.start),end:Jb.indexToPosition(Cb.decl.end)};Jb.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(Jb){Jb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",readOnly:!0,
multiSelectAction:"single",exec:function(Jb){Jb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(Jb,Cb){Cb=void 0===Cb?{direction:null}:Cb;var Bb=Jb.pluginInvokeFirst("getNavigator");if(!Bb)return!0;Bb=Bb.resolveIdentifierAt(Jb,
Jb.cursorPosition);if(!Bb||!Bb.refs)return sb.show("No symbol identifier selected"),!0;var sa=Jb.selection;Bb=Bb.refs.map(function(O){var U=O.end;return sb.Range.fromPositions(sb.iToP(Jb,O.start),sb.iToP(Jb,U))}).concat(Bb.decl?sb.Range.fromPositions(sb.iToP(Jb,Bb.decl.start),sb.iToP(Jb,Bb.decl.end)):[]).sort(sb.Range.compare);if(!Bb.length)return!0;var Ta=Bb.map(String).indexOf(String(sa.range));if("next"===Cb.direction||"prev"===Cb.direction)-1===Ta&&Bb.length?Bb=[Bb[0]]:(Cb=Ta+("next"===Cb.direction?
1:-1),0>Cb?Cb=Bb.length-1:Cb>=Bb.length&&(Cb=0),Bb=[Bb[Cb]]);Bb.forEach(function(O){var U=sa.selections.findIndex(function(xa){return xa.range.equals(O)}),ra=sa.selections.length-1;-1<U?sb.arr.swap(sa.selections,U,ra):sa.addRange(O,!1)});sa.mergeSelections();return!0}}];sb.astEditorCommands=pb;sb.astEditorCommands=pb;sb.astEditorCommands=pb;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var $b=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
$b.expressionAllowed=function(Jb,Cb,Bb){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(Cb.lastType)||"quasi"==Cb.lastType&&/\{\s*$/.test(Jb.string.slice(0,Jb.pos-(Bb||0)))};$b.passIndent=tc;$b.defineMode=cd;$b.defineMIME=td;$b.registerHelper=nb;$b.defaultConfig={indentUnit:2};$b.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};$b.defineMode("javascript",
function(Jb,Cb){function Bb(vb,nc,qd){Xg=vb;uf=qd;return nc}function sa(vb,nc){var qd=vb.next();if('"'==qd||"'"==qd)return nc.tokenize=Ta(qd),nc.tokenize(vb,nc);if("."==qd&&vb.match(/^\d+(?:[eE][+\-]?\d+)?/))return Bb("number","number");if("."==qd&&vb.match(".."))return Bb("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(qd))return Bb(qd);if("="==qd&&vb.eat(">"))return Bb("=>","operator");if("0"==qd&&vb.eat(/x/i))return vb.eatWhile(/[\da-f]/i),Bb("number","number");if("0"==qd&&vb.eat(/o/i))return vb.eatWhile(/[0-7]/i),
Bb("number","number");if("0"==qd&&vb.eat(/b/i))return vb.eatWhile(/[01]/i),Bb("number","number");if(/\d/.test(qd))return vb.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),Bb("number","number");if("/"==qd){if(vb.eat("*"))return nc.tokenize=O,O(vb,nc);if(vb.eat("/"))return vb.skipToEnd(),Bb("comment","comment");if($b.expressionAllowed(vb,nc,1)){a:for(var rd=nc=!1;null!=(qd=vb.next());){if(!nc){if("/"==qd&&!rd)break a;"["==qd?rd=!0:rd&&"]"==qd&&(rd=!1)}nc=!nc&&"\\"==qd}vb.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return Bb("regexp","string-2")}vb.eatWhile(Pg);return Bb("operator","operator",vb.current())}if("`"==qd)return nc.tokenize=U,U(vb,nc);if("#"==qd)return vb.skipToEnd(),Bb("error","error");if(Pg.test(qd))return">"==qd&&nc.lexical&&">"==nc.lexical.type||vb.eatWhile(Pg),Bb("operator","operator",vb.current());if(Tf.test(qd))return vb.eatWhile(Tf),vb=vb.current(),(qd=Le.propertyIsEnumerable(vb)&&Le[vb])&&"."!=nc.lastType?Bb(qd.type,qd.style,vb):Bb("variable","variable",vb)}function Ta(vb){return function(nc,
qd){var rd=!1,Pe;if(De&&"@"==nc.peek()&&nc.match(tg))return qd.tokenize=sa,Bb("jsonld-keyword","meta");for(;null!=(Pe=nc.next())&&(Pe!=vb||rd);)rd=!rd&&"\\"==Pe;rd||(qd.tokenize=sa);return Bb("string","string")}}function O(vb,nc){for(var qd=!1,rd;rd=vb.next();){if("/"==rd&&qd){nc.tokenize=sa;break}qd="*"==rd}return Bb("comment","comment")}function U(vb,nc){for(var qd=!1,rd;null!=(rd=vb.next());){if(!qd&&("`"==rd||"$"==rd&&vb.eat("{"))){nc.tokenize=sa;break}qd=!qd&&"\\"==rd}return Bb("quasi","string-2",
vb.current())}function ra(vb,nc){nc.fatArrowAt&&(nc.fatArrowAt=null);var qd=vb.string.indexOf("=>",vb.start);if(!(0>qd)){if(pg){var rd=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(vb.string.slice(vb.start,qd));rd&&(qd=rd.index)}rd=0;var Pe=!1;for(--qd;0<=qd;--qd){var hf=vb.string.charAt(qd),Qg="([{}])".indexOf(hf);if(0<=Qg&&3>Qg){if(!rd){++qd;break}if(0==--rd){"("==hf&&(Pe=!0);break}}else if(3<=Qg&&6>Qg)++rd;else if(Tf.test(hf))Pe=!0;else{if(/["'\/]/.test(hf))return;if(Pe&&!rd){++qd;break}}}Pe&&
!rd&&(nc.fatArrowAt=qd)}}function xa(vb,nc,qd,rd,Pe,hf){this.indented=vb;this.column=nc;this.type=qd;this.prev=Pe;this.info=hf;null!=rd&&(this.align=rd)}function pa(){for(var vb=arguments.length-1;0<=vb;vb--)Wd.cc.push(arguments[vb])}function ea(){pa.apply(null,arguments);return!0}function bb(vb){function nc(rd){for(;rd;rd=rd.next)if(rd.name==vb)return!0;return!1}var qd=Wd.state;Wd.marked="def";qd.context?nc(qd.localVars)||(qd.localVars={name:vb,next:qd.localVars}):!nc(qd.globalVars)&&Cb.globalVars&&
(qd.globalVars={name:vb,next:qd.globalVars})}function Aa(){Wd.state.context={prev:Wd.state.context,vars:Wd.state.localVars};Wd.state.localVars=wh}function Rb(){Wd.state.localVars=Wd.state.context.vars;Wd.state.context=Wd.state.context.prev}function Gc(vb,nc){var qd=function(){var rd=Wd.state,Pe=rd.indented;if("stat"==rd.lexical.type)Pe=rd.lexical.indented;else for(var hf=rd.lexical;hf&&")"==hf.type&&hf.align;hf=hf.prev)Pe=hf.indented;rd.lexical=new xa(Pe,Wd.stream.column(),vb,null,rd.lexical,nc)};
qd.lex=!0;return qd}function Ab(){var vb=Wd.state;vb.lexical.prev&&(")"==vb.lexical.type&&(vb.indented=vb.lexical.indented),vb.lexical=vb.lexical.prev)}function Hc(vb){function nc(qd){return qd==vb?ea():";"==vb?pa():ea(nc)}return nc}function fb(vb,nc){return"var"==vb?ea(Gc("vardef",nc.length),gc,Hc(";"),Ab):"keyword a"==vb?ea(Gc("form"),rc,fb,Ab):"keyword b"==vb?ea(Gc("form"),fb,Ab):"{"==vb?ea(Gc("}"),ge,Ab):";"==vb?ea():"if"==vb?("else"==Wd.state.lexical.info&&Wd.state.cc[Wd.state.cc.length-1]==
Ab&&Wd.state.cc.pop()(),ea(Gc("form"),rc,fb,Ab,Ga)):"function"==vb?ea(M):"for"==vb?ea(Gc("form"),Oa,fb,Ab):"variable"==vb?pg&&"type"==nc?(Wd.marked="keyword",ea(Td,Hc("operator"),Td,Hc(";"))):ea(Gc("stat"),Oc):"switch"==vb?ea(Gc("form"),rc,Hc("{"),Gc("}","switch"),ge,Ab,Ab):"case"==vb?ea(ud,Hc(":")):"default"==vb?ea(Hc(":")):"catch"==vb?ea(Gc("form"),Aa,Hc("("),ha,Hc(")"),fb,Ab,Rb):"class"==vb?ea(Gc("form"),Ua,Ab):"export"==vb?ea(Gc("stat"),Yb,Ab):"import"==vb?ea(Gc("stat"),md,Ab):"module"==vb?ea(Gc("form"),
id,Hc("{"),Gc("}"),ge,Ab,Ab):"async"==vb?ea(fb):"@"==nc?ea(ud,fb):pa(Gc("stat"),ud,Hc(";"),Ab)}function ud(vb){return gb(vb,!1)}function je(vb){return gb(vb,!0)}function rc(vb){return"("!=vb?pa():ea(Gc(")"),ud,Hc(")"),Ab)}function gb(vb,nc){if(Wd.state.fatArrowAt==Wd.stream.start){var qd=nc?ib:La;if("("==vb)return ea(Aa,Gc(")"),ke(id,")"),Ab,Hc("=>"),qd,Rb);if("variable"==vb)return pa(Aa,id,Hc("=>"),qd,Rb)}qd=nc?ua:Za;return Hf.hasOwnProperty(vb)?ea(qd):"function"==vb?ea(M,qd):"class"==vb?ea(Gc("form"),
va,Ab):"keyword c"==vb||"async"==vb?ea(nc?hb:Id):"("==vb?ea(Gc(")"),Id,Hc(")"),Ab,qd):"operator"==vb||"spread"==vb?ea(nc?je:ud):"["==vb?ea(Gc("]"),Ed,Ab,qd):"{"==vb?le(Yd,"}",null,qd):"quasi"==vb?pa(J,qd):"new"==vb?ea(Ib(nc)):ea()}function Id(vb){return vb.match(/[;\}\)\],]/)?pa():pa(ud)}function hb(vb){return vb.match(/[;\}\)\],]/)?pa():pa(je)}function Za(vb,nc){return","==vb?ea(ud):ua(vb,nc,!1)}function ua(vb,nc,qd){var rd=0==qd?Za:ua,Pe=0==qd?ud:je;if("=>"==vb)return ea(Aa,qd?ib:La,Rb);if("operator"==
vb)return/\+\+|--/.test(nc)?ea(rd):"?"==nc?ea(ud,Hc(":"),Pe):ea(Pe);if("quasi"==vb)return pa(J,rd);if(";"!=vb){if("("==vb)return le(je,")","call",rd);if("."==vb)return ea(Pc,rd);if("["==vb)return ea(Gc("]"),Id,Hc("]"),Ab,rd)}}function J(vb,nc){return"quasi"!=vb?pa():"${"!=nc.slice(nc.length-2)?ea(J):ea(ud,la)}function la(vb){if("}"==vb)return Wd.marked="string-2",Wd.state.tokenize=U,ea(J)}function La(vb){ra(Wd.stream,Wd.state);return pa("{"==vb?fb:ud)}function ib(vb){ra(Wd.stream,Wd.state);return pa("{"==
vb?fb:je)}function Ib(vb){return function(nc){return"."==nc?ea(vb?Vb:hc):pa(vb?je:ud)}}function hc(vb,nc){if("target"==nc)return Wd.marked="keyword",ea(Za)}function Vb(vb,nc){if("target"==nc)return Wd.marked="keyword",ea(ua)}function Oc(vb){return":"==vb?ea(Ab,fb):pa(Za,Hc(";"),Ab)}function Pc(vb){if("variable"==vb)return Wd.marked="property",ea()}function Yd(vb,nc){if("async"==vb)return Wd.marked="property",ea(Yd);if("variable"==vb||"keyword"==Wd.style)return Wd.marked="property","get"==nc||"set"==
nc?ea(r):ea(Rd);if("number"==vb||"string"==vb)return Wd.marked=De?"property":Wd.style+" property",ea(Rd);if("jsonld-keyword"==vb)return ea(Rd);if("modifier"==vb)return ea(Yd);if("["==vb)return ea(ud,Hc("]"),Rd);if("spread"==vb)return ea(ud);if(":"==vb)return pa(Rd)}function r(vb){if("variable"!=vb)return pa(Rd);Wd.marked="property";return ea(M)}function Rd(vb){if(":"==vb)return ea(je);if("("==vb)return pa(M)}function ke(vb,nc,qd){function rd(Pe,hf){return(qd?-1<qd.indexOf(Pe):","==Pe)?(Pe=Wd.state.lexical,
"call"==Pe.info&&(Pe.pos=(Pe.pos||0)+1),ea(function(Qg,qg){return Qg==nc||qg==nc?pa():pa(vb)},rd)):Pe==nc||hf==nc?ea():ea(Hc(nc))}return function(Pe,hf){return Pe==nc||hf==nc?ea():pa(vb,rd)}}function le(vb,nc,qd){for(var rd=3;rd<arguments.length;rd++)Wd.cc.push(arguments[rd]);return ea(Gc(nc,qd),ke(vb,nc),Ab)}function ge(vb){return"}"==vb?ea():pa(fb,ge)}function vd(vb,nc){if(pg){if(":"==vb)return ea(Td);if("?"==nc)return ea(vd)}}function Td(vb){if("variable"==vb)return Wd.marked="variable-3",ea(nf);
if("string"==vb||"number"==vb||"atom"==vb)return ea(nf);if("{"==vb)return ea(Gc("}"),ke(Ae,"}",",;"),Ab);if("("==vb)return ea(ke(ld,")"),Ce)}function Ce(vb){if("=>"==vb)return ea(Td)}function Ae(vb,nc){if("variable"==vb||"keyword"==Wd.style)return Wd.marked="property",ea(Ae);if("?"==nc)return ea(Ae);if(":"==vb)return ea(Td)}function ld(vb){if("variable"==vb)return ea(ld);if(":"==vb)return ea(Td)}function nf(vb,nc){if("<"==nc)return ea(Gc(">"),ke(Td,">"),Ab,nf);if("|"==nc||"."==vb)return ea(Td);if("["==
vb)return ea(Hc("]"),nf);if("extends"==nc)return ea(Td)}function gc(){return pa(id,vd,Ec,pe)}function id(vb,nc){if("modifier"==vb)return ea(id);if("variable"==vb)return bb(nc),ea();if("spread"==vb)return ea(id);if("["==vb)return le(id,"]");if("{"==vb)return le(fe,"}")}function fe(vb,nc){if("variable"==vb&&!Wd.stream.match(/^\s*:/,!1))return bb(nc),ea(Ec);"variable"==vb&&(Wd.marked="property");return"spread"==vb?ea(id):"}"==vb?pa():ea(Hc(":"),id,Ec)}function Ec(vb,nc){if("="==nc)return ea(je)}function pe(vb){if(","==
vb)return ea(gc)}function Ga(vb,nc){if("keyword b"==vb&&"else"==nc)return ea(Gc("form","else"),fb,Ab)}function Oa(vb){if("("==vb)return ea(Gc(")"),Ka,Hc(")"),Ab)}function Ka(vb){return"var"==vb?ea(gc,Hc(";"),G):";"==vb?ea(G):"variable"==vb?ea(N):pa(ud,Hc(";"),G)}function N(vb,nc){return"in"==nc||"of"==nc?(Wd.marked="keyword",ea(ud)):ea(Za,G)}function G(vb,nc){return";"==vb?ea(wa):"in"==nc||"of"==nc?(Wd.marked="keyword",ea(ud)):pa(ud,Hc(";"),wa)}function wa(vb){")"!=vb&&ea(ud)}function M(vb,nc){if("*"==
nc)return Wd.marked="keyword",ea(M);if("variable"==vb)return bb(nc),ea(M);if("("==vb)return ea(Aa,Gc(")"),ke(ha,")"),Ab,vd,fb,Rb);if(pg&&"<"==nc)return ea(Gc(">"),ke(Td,">"),Ab,M)}function ha(vb){return"spread"==vb?ea(ha):pa(id,vd,Ec)}function va(vb,nc){return"variable"==vb?Ua(vb,nc):eb(vb,nc)}function Ua(vb,nc){if("variable"==vb)return bb(nc),ea(eb)}function eb(vb,nc){if("<"==nc)return ea(Gc(">"),ke(Td,">"),Ab,eb);if("extends"==nc||"implements"==nc||pg&&","==vb)return ea(pg?Td:ud,eb);if("{"==vb)return ea(Gc("}"),
ob,Ab)}function ob(vb,nc){if("variable"==vb||"keyword"==Wd.style){if(("async"==nc||"static"==nc||"get"==nc||"set"==nc||pg&&("public"==nc||"private"==nc||"protected"==nc||"readonly"==nc||"abstract"==nc))&&Wd.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Wd.marked="keyword",ea(ob);Wd.marked="property";return ea(pg?Tb:M,ob)}if("["==vb)return ea(ud,Hc("]"),pg?Tb:M,ob);if("*"==nc)return Wd.marked="keyword",ea(ob);if(";"==vb)return ea(ob);if("}"==vb)return ea();if("@"==nc)return ea(ud,ob)}function Tb(vb,
nc){return"?"==nc?ea(Tb):":"==vb?ea(Td,Ec):"="==nc?ea(je):pa(M)}function Yb(vb,nc){return"*"==nc?(Wd.marked="keyword",ea(Qd,Hc(";"))):"default"==nc?(Wd.marked="keyword",ea(ud,Hc(";"))):"{"==vb?ea(ke(yc,"}"),Qd,Hc(";")):pa(fb)}function yc(vb,nc){if("as"==nc)return Wd.marked="keyword",ea(Hc("variable"));if("variable"==vb)return pa(je,yc)}function md(vb){return"string"==vb?ea():pa(Bd,Wc,Qd)}function Bd(vb,nc){if("{"==vb)return le(Bd,"}");"variable"==vb&&bb(nc);"*"==nc&&(Wd.marked="keyword");return ea(Sd)}
function Wc(vb){if(","==vb)return ea(Bd,Wc)}function Sd(vb,nc){if("as"==nc)return Wd.marked="keyword",ea(Bd)}function Qd(vb,nc){if("from"==nc)return Wd.marked="keyword",ea(ud)}function Ed(vb){return"]"==vb?ea():pa(ke(je,"]"))}Jb=Object.assign({},$b.defaultConfig,{},Jb);Cb=Object.assign({},$b.defaultParserConfig,{},Cb);var yd=Jb.indentUnit,ue=Cb.statementIndent,De=Cb.jsonld,gg=Cb.json||De,pg=Cb.typescript,Tf=Cb.wordCharacters||/[\w$\xa1-\uffff]/,Le=function(){function vb(qg){return{type:qg,style:"keyword"}}
var nc=vb("keyword a"),qd=vb("keyword b"),rd=vb("keyword c"),Pe=vb("operator"),hf={type:"atom",style:"atom"};nc={if:vb("if"),while:nc,with:nc,else:qd,do:qd,try:qd,finally:qd,return:rd,break:rd,continue:rd,new:vb("new"),delete:rd,throw:rd,debugger:rd,var:vb("var"),const:vb("var"),let:vb("var"),function:vb("function"),catch:vb("catch"),for:vb("for"),switch:vb("switch"),case:vb("case"),default:vb("default"),in:Pe,typeof:Pe,instanceof:Pe,true:hf,false:hf,null:hf,undefined:hf,NaN:hf,Infinity:hf,this:vb("this"),
class:vb("class"),super:vb("atom"),yield:rd,export:vb("export"),import:vb("import"),extends:rd,await:rd,async:vb("async")};if(pg){qd={type:"variable",style:"variable-3"};rd={interface:vb("class"),implements:rd,namespace:rd,module:vb("module"),enum:vb("module"),public:vb("modifier"),private:vb("modifier"),protected:vb("modifier"),abstract:vb("modifier"),as:Pe,string:qd,number:qd,boolean:qd,any:qd};for(var Qg in rd)nc[Qg]=rd[Qg]}return nc}(),Pg=/[+\-*&%=<>!?|~^@]/,tg=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
Xg,uf,Hf={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Wd={state:null,column:null,marked:null,cc:null},wh={name:"this",next:{name:"arguments"}};Ab.lex=!0;return{startState:function(vb){vb={tokenize:sa,lastType:"sof",cc:[],lexical:new xa((vb||0)-yd,0,"block",!1),localVars:Cb.localVars,context:Cb.localVars&&{vars:Cb.localVars},indented:vb||0};Cb.globalVars&&"object"===typeof Cb.globalVars&&(vb.globalVars=Cb.globalVars);return vb},token:function(vb,nc){vb.sol()&&(nc.lexical.hasOwnProperty("align")||
(nc.lexical.align=!1),nc.indented=vb.indentation(),ra(vb,nc));if(nc.tokenize!=O&&vb.eatSpace())return null;var qd=nc.tokenize(vb,nc);if("comment"==Xg)return qd;nc.lastType="operator"!=Xg||"++"!=uf&&"--"!=uf?Xg:"incdec";a:{var rd=Xg,Pe=uf,hf=nc.cc;Wd.state=nc;Wd.stream=vb;Wd.marked=null;Wd.cc=hf;Wd.style=qd;nc.lexical.hasOwnProperty("align")||(nc.lexical.align=!0);for(vb=0;;){if(1E5<vb++)throw Error("endless");if((hf.length?hf.pop():gg?ud:fb)(rd,Pe)){for(;hf.length&&hf[hf.length-1].lex;)hf.pop()();
if(Wd.marked){qd=Wd.marked;break a}if(rd="variable"==rd)b:{for(rd=nc.localVars;rd;rd=rd.next)if(rd.name==Pe){rd=!0;break b}for(nc=nc.context;nc;nc=nc.prev)for(rd=nc.vars;rd;rd=rd.next)if(rd.name==Pe){rd=!0;break b}rd=void 0}if(rd){qd="variable-2";break a}break a}}}return qd},indent:function(vb,nc){if(vb.tokenize==O)return $b.passIndent;if(vb.tokenize!=sa)return 0;var qd=nc&&nc.charAt(0),rd=vb.lexical,Pe;if(!/^\s*else\b/.test(nc))for(var hf=vb.cc.length-1;0<=hf;--hf){var Qg=vb.cc[hf];if(Qg==Ab)rd=
rd.prev;else if(Qg!=Ga)break}for(;!("stat"!=rd.type&&"form"!=rd.type||"}"!=qd&&(!(Pe=vb.cc[vb.cc.length-1])||Pe!=Za&&Pe!=ua||/^[,\.=+\-*:?[\(]/.test(nc)));)rd=rd.prev;ue&&")"==rd.type&&"stat"==rd.prev.type&&(rd=rd.prev);Pe=rd.type;hf=qd==Pe;return(Qg=vb._string)&&Qg.trimLeft().startsWith("?")&&":"===qd?Qg.indexOf("?"):Qg&&":"===vb.lastType&&"}"!==rd.type?Qg.match(/^\s*/)[0].length:"vardef"==Pe?(nc=rd.indented+rd.info+2+vb.localVars.name.length,"?"===qd||":"===qd||"|"===qd||"&"===qd?nc:","==vb.lastType?
rd.indented+rd.info+1:"operator"==vb.lastType?nc+3:rd.indented):"form"==Pe&&"{"==qd?rd.indented:"form"==Pe?rd.indented+yd:"stat"==Pe?(qd=rd.indented,vb="operator"==vb.lastType||","==vb.lastType||Pg.test(nc.charAt(0))||/[,.]/.test(nc.charAt(0)),qd+(vb?ue||yd:0)):"switch"!=rd.info||hf||0==Cb.doubleIndentSwitch?rd.align?rd.column+(hf?0:1):rd.indented+(hf?0:yd):rd.indented+(/^(?:case|default)\b/.test(nc)?yd:2*yd)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:gg?null:"/*",blockCommentEnd:gg?
null:"*/",lineComment:gg?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:gg?"json":"javascript",jsonldMode:De,jsonMode:gg,expressionAllowed:$b.expressionAllowed,skipExpression:function(vb){var nc=vb.cc[vb.cc.length-1];nc!=ud&&nc!=je||vb.cc.pop()}}});$b.registerHelper("wordChars","javascript",/[\w$]/);$b.defineMIME("text/javascript","javascript");$b.defineMIME("text/ecmascript","javascript");$b.defineMIME("application/javascript","javascript");$b.defineMIME("application/x-javascript",
"javascript");$b.defineMIME("application/ecmascript","javascript");$b.defineMIME("application/json",{name:"javascript",json:!0});$b.defineMIME("application/x-json",{name:"javascript",json:!0});$b.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});$b.defineMIME("text/typescript",{name:"javascript",typescript:!0});$b.defineMIME("application/typescript",{name:"javascript",typescript:!0});var lc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");lc.string=mc;lc.JavaScriptChecker=
Nc;lc.JavaScriptNavigator=dc;lc.completers=ub;lc.jsSnippets=Fa;lc.jsIdeCommands=Ya;lc.jsEditorCommands=Xb;lc.astEditorCommands=pb;lc.CodeMirrorEnabledEditorPlugin=cc;lc.Snippet=Xa;lc.parser=Zd;lc.localInterface=od;lc.systemInterfaceNamed=qb;lc.serverInterfaceFor=kc;lc.l2lInterfaceFor=Uc;Nc=function(Jb){var Cb=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),Bb=Cb.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof Cb.JavaScriptEditorPlugin?Cb.JavaScriptEditorPlugin:Cb.JavaScriptEditorPlugin=
function(sa){sa&&sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return cb(Bb,Jb,[{key:Symbol.for("lively-instance-initialize"),value:function(){cb._get(Object.getPrototypeOf(Bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new lc.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(sa){cb._get(Object.getPrototypeOf(Bb.prototype),"attach",this).call(this,sa);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:sa})}},{key:"detach",value:function(sa){this.checker.uninstall(this.textMorph);cb._get(Object.getPrototypeOf(Bb.prototype),"detach",this).call(this,sa)}},{key:"getNavigator",value:function(){return new lc.JavaScriptNavigator}},{key:"getCompleters",value:function(sa){return lc.completers.concat(sa)}},
{key:"getCommands",value:function(sa){return[].concat($jscomp.arrayFromIterable(cb._get(Object.getPrototypeOf(Bb.prototype),"getCommands",this).call(this,sa)),$jscomp.arrayFromIterable(lc.jsIdeCommands),$jscomp.arrayFromIterable(lc.jsEditorCommands),$jscomp.arrayFromIterable(lc.astEditorCommands))}},{key:"getKeyBindings",value:function(sa){return[].concat($jscomp.arrayFromIterable(sa),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(sa){var Ta=this,O,U,ra,xa,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){O=Ta.textMorph;U=[{command:"doit",target:O,showKeyShortcuts:!0},{command:"inspectit",target:O,showKeyShortcuts:!0},{command:"editit",target:O,showKeyShortcuts:!0},{command:"printit",target:O,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:O,showKeyShortcuts:!0},{command:"eval all",target:O,showKeyShortcuts:!0},{command:"text completion",alias:"code completion",
target:O,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:O,showKeyShortcuts:!0},{isDivider:!0}];Ta.evalEnvironment.targetModule&&U.push({command:"[javascript] inject import",alias:"add import",target:O},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:O},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:O});ra=Ta.getNavigator();(xa=ra.resolveIdentifierAt(O,O.cursorPosition))&&
U.push({command:"selectDefinition",alias:'jump to definition of "'+xa.name+'"',target:O},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+xa.name+'"',target:O});(pa=O.selection.text.trim())&&U.push({command:"open code search",alias:'code search for "'+lc.string.truncate(pa,30)+'"',target:O.world(),args:{input:pa,backend:Ta.backend()}});U.push({isDivider:!0});return ea.return(U.concat(sa))})}},{key:"getSnippets",value:function(){return lc.jsSnippets.map(function(sa){var Ta=
$jscomp.makeIterator(sa);sa=Ta.next().value;Ta=Ta.next().value;return new lc.Snippet({trigger:sa,expansion:Ta})})}},{key:"sanatizedJsEnv",value:function(sa){sa=Object.assign({},this.evalEnvironment,{},sa);sa.format||(sa.formatd="esm");sa.context||(sa.context=this.textMorph);sa.sourceURL||(sa.sourceURL=sa.targetModule+"_doit_"+Date.now());sa.systemInterface||(sa.systemInterface=lc.localInterface);return sa}},{key:"backend",value:function(sa){sa=this.sanatizedJsEnv(sa);return sa.remote?sa.remote:"local"}},
{key:"systemInterface",value:function(sa){return this.sanatizedJsEnv(sa).systemInterface||lc.localInterface}},{key:"setSystemInterface",value:function(sa){return this.evalEnvironment.systemInterface=sa}},{key:"setSystemInterfaceNamed",value:function(sa){return this.setSystemInterface(lc.systemInterfaceNamed(sa))}},{key:"runEval",value:function(sa,Ta){Ta=this.sanatizedJsEnv(Ta);return this.systemInterface(Ta).runEval(sa,Ta)}},{key:"parser",get:function(){return lc.parser}},{key:"parse",value:function(sa){sa=
void 0===sa?null:sa;if(this._ast&&this._ast._astType===sa)return this._ast;var Ta=this.parser,O=this.textMorph.textString;if(!Ta)return null;var U={withComments:!0,allowReturnOutsideFunction:!0};sa&&(U.type=sa);if(O.startsWith("#!")){var ra=O.indexOf("\n");O=" ".repeat(ra)+O.slice(ra)}Ta=Ta.fuzzyParse(O,U);Ta._astType=sa;return this._ast=Ta}},{key:"undeclaredVariables",value:function(sa){var Ta=this.parser,O=this.evalEnvironment.knownGlobals||[];sa=this.parse(void 0===sa?null:sa);return Ta&&sa?Ta.query.findGlobalVarRefs(sa,
{jslintGlobalComment:!0}).filter(function(U){return!O.includes(U.name)}):[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],Cb,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(lc.CodeMirrorEnabledEditorPlugin);Nc=lc.JavaScriptEditorPlugin;
za("default",Nc);lc.default=Nc}}});
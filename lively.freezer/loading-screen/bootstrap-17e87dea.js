System.register(["./__rootModule___commonjs-entry-71573ff5.js","./index-ca98f65e.js","@babel/plugin-syntax-import-meta"],function(Lc,pd){var Nd,Tc,Jc,$d,Bb,rd,Id,Ac,Pc,gd,nd;return{setters:[function(Fd){Nd=Fd._;Tc=Fd.g;Jc=Fd.b3;$d=Fd.ax;Bb=Fd.b4;rd=Fd.k;Id=Fd.B;Ac=Fd.e;Pc=Fd.b5;gd=Fd.b6},function(Fd){nd=Fd.m},function(){}],execute:function(){function Fd(){Fd=Nd(regeneratorRuntime.mark(function Nb(){return regeneratorRuntime.wrap(function(bc){for(;;)switch(bc.prev=bc.next){case 0:return bc.next=2,
pd.import("./world-d6b1fdcd.js");case 2:return bc.next=4,pd.import("./editor-plugin-0a8dd45b.js");case 4:return bc.next=6,pd.import("./editor-plugin-330ed4ee.js");case 6:return bc.next=8,pd.import("./index-c595fbe5.js");case 8:return bc.next=10,pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(hb){return hb.ce});case 10:return bc.next=12,pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(hb){return hb.cf});case 12:return bc.next=14,pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(hb){return hb.ca});
case 14:sb.extractModules("lively.bindings"),sb.extractModules("lively.shell"),sb.extractModules("lively.ide"),sb.extractModules("lively.components");case 18:case "end":return bc.stop()}},Nb)}));return Fd.apply(this,arguments)}function ic(Xb){return vd.apply(this,arguments)}function vd(){vd=Nd(regeneratorRuntime.mark(function bc(Nb){var hb,cb,Hb,ec,ub,yb,ba,wb,Xa,Za,Sb,Cb,Da,zb,db,ib,Ea,W,T,ia,ka;return regeneratorRuntime.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return hb=Nb.filePath,
cb=Nb.worldName,Hb=Nb.snapshot,ec=Nb.commit,ub=Nb.loadingIndicator,yb=Nb.progress,ba=Nb.logError,wb=void 0===ba?function(ya){return console.log(ya)}:ba,K.prev=1,Xa=JSON.parse(localStorage.getItem("lively.load-config")||'{"lively.lang":"dynamic","lively.ast":"dynamic","lively.source-transform":"dynamic","lively.classes":"dynamic","lively.vm":"dynamic","lively.modules":"dynamic","lively.user":"dynamic","lively.storage":"dynamic","lively.morphic":"dynamic"}'),ub.center=yb.bottomCenter,K.next=6,sb.polyfills();
case 6:Za=$world.env;if(!sb.doBootstrap){K.next=12;break}K.next=10;return sb.bootstrapLivelySystem(ub,yb,Xa);case 10:K.next=14;break;case 12:return K.next=14,sb.fastPrepLivelySystem(ub);case 14:return ub.label="Loading lively.2lively...",K.next=17,lively.modules.registerPackage("lively.2lively");case 17:sb.askBeforeQuit&&window.addEventListener("beforeunload",function(ya){return ya.returnValue="Really?"},!0);if("dynamic"!==Xa["lively.morphic"]||sb.fastLoad){K.next=26;break}ub.label="Loading lively.morphic...";
K.next=22;return lively.modules.importPackage("lively.morphic");case 22:Sb=K.sent;yb.finishPackage({packageName:"lively.morphic",loaded:!0});K.next=27;break;case 26:Sb=lively.morphic;case 27:ub.label="Loading world...";window.onresize=null;window.loadCompiledFrozenPart=lively.modules.module("lively.morphic/partsbin.js")._recorder.loadPart;sb.unregisterExtension("part");sb.registerExtension(sb.partResourceExtension);sb.unregisterExtension("styleguide");lively.FreezerRuntime=!1;Cb=document.location;
window.worldLoadingIndicator=ub;K.prev=36;Da={root:$world.env.renderer.rootNode,verbose:!0,localconfig:!0,l2l:!0,shell:!0,moduleManager:lively.modules};if(!Hb){K.next=66;break}Hb.startsWith("http")||(Hb=sb.resource(System.baseURL).join(Hb).url);K.next=42;return lively.modules.module("lively.morphic/world.js").recorder;case 42:return sb.__inter0__=K.sent,zb=sb.__inter0__.World,K.next=46,lively.modules.module("lively.morphic/world-loading.js").recorder;case 46:return sb.__inter1__=K.sent,ib=sb.__inter1__.loadWorld,
K.next=50,lively.modules.module("lively.morphic/serialization.js").recorder;case 50:return sb.__inter2__=K.sent,db=sb.__inter2__.loadMorphFromSnapshot,K.t0=db,K.next=55,sb.resource(Hb).readJson();case 55:return K.t1=K.sent,K.next=58,(0,K.t0)(K.t1);case 58:return Ea=K.sent,K.next=61,ib(new zb({showsUserFlap:!1,extent:$world.extent}),void 0,Da);case 61:W=K.sent;W.addMorph(Ea);W.onWindowResize();K.next=103;break;case 66:if(!ec){K.next=71;break}K.next=69;return Sb.World.loadFromCommit(ec,void 0,Object.assign({},
Da,{browserURL:"/worlds/load?name="+ec.name}));case 69:K.next=103;break;case 71:if(!cb){K.next=100;break}if("__newWorld__"!==cb){K.next=96;break}if(!Object.values(Xa).every(function(ya){return"frozen"===ya})&&!sb.fastLoad){K.next=84;break}K.next=76;return lively.modules.module("lively.ide/world.js").recorder;case 76:return sb.__inter3__=K.sent,T=sb.__inter3__.LivelyWorld,K.next=80,lively.modules.module("lively.morphic/world-loading.js").recorder;case 80:sb.__inter4__=K.sent;ia=sb.__inter4__.loadWorld;
K.next=92;break;case 84:return K.next=86,lively.modules.System["import"]("lively.ide/world.js");case 86:return sb.__inter5__=K.sent,T=sb.__inter5__.LivelyWorld,K.next=90,lively.modules.System["import"]("lively.morphic/world-loading.js");case 90:sb.__inter6__=K.sent,ia=sb.__inter6__.loadWorld;case 92:return K.next=94,ia(new T({openNewProjectPrompt:!0}),void 0,Da);case 94:K.next=98;break;case 96:return K.next=98,Sb.World.loadFromDB(cb,void 0,void 0,Object.assign({},Da,{browserURL:"/worlds/load?name="+
cb.replace(/\.json($|\?)/,"")}));case 98:K.next=103;break;case 100:if(!hb){K.next=103;break}K.next=103;return Sb.World.loadFromResource(sb.resource(System.baseURL).join(hb),void 0,Object.assign({},Da,{browserURL:"/worlds/load?file="+hb}));case 103:K.next=108;break;case 105:K.prev=105,K.t2=K["catch"](36),window.__loadError__=K.t2;case 108:return yb.finishPackage({packageName:"world",loaded:!0}),yb.fadeIntoBack(),window.addEventListener("popstate",function(ya){document.location===Cb&&document.location.reload()}),
K.next=113,$world.whenReady();case 113:return ub.remove(),K.next=116,Za.renderer.worldMorph.whenRendered();case 116:"dynamic"!==Xa["lively.morphic"]||sb.fastLoad||(Za.renderer.clear(),Za.fontMetric.uninstall(),Za.eventDispatcher.uninstall());K.next=126;break;case 119:throw K.prev=119,K.t3=K["catch"](1),K.t3.originalErr&&(K.t3=K.t3.originalErr),ka=K.t3.message,K.t3.stack!==K.t3.message&&(ka+=K.t3.stack.includes(K.t3.message)?K.t3.stack.replace(K.t3.message,"\n"):K.t3.stack),wb(ka),K.t3;case 126:case "end":return K.stop()}},
bc,null,[[1,119],[36,105]])}));return vd.apply(this,arguments)}Lc("bootstrap",ic);var sb=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/util/bootstrap.js");sb.polyfills=function(){var Xb=[];"PointerEvent"in window||Xb.push(sb.loadViaScript(sb.resource(System.baseURL).join("/lively.next-node_modules/pepjs/dist/pep.js").url));"fetch"in window||Xb.push(sb.loadViaScript("//cdnjs.cloudflare.com/ajax/libs/fetch/1.0.0/fetch.js"));return Promise.all(Xb)};sb.importPackageAndDo=function(Xb,Nb,
bc){var hb=Xb.split("/").slice(-1)[0];bc.label="loading ".concat(hb);return lively.modules.importPackage(Xb).then(Nb||function(){})};sb.extractModules=function(Xb){Object.keys(lively.FreezerRuntime.registry).filter(function(Nb){return Nb.startsWith(Xb)}).forEach(function(Nb){sb.extractedModules[sb.resource(System.baseURL).join(Nb).url]=Object.assign({},lively.FreezerRuntime.registry[Nb].exports)})};sb.loadComponents=function(){return Fd.apply(this,arguments)};sb.installFetchHook=function(Xb){function Nb(bc,
hb){sb.loads++;Xb.status="loading ".concat(sb.string.truncateLeft(hb.name.replace(window.System.baseURL,""),25,"..."));Xb.progress=sb.loads/(800-4*Object.keys(sb.extractedModules).length);Xb.center=$world.innerBounds().center();return bc(hb)}window.__logFetch=Nb;lively.modules.installHook("fetch",Nb)};sb.bootstrapLivelySystem=function(Xb,Nb,bc){return Promise.resolve().then(function(){Xb.status="starting bootstrap process..."}).then(Nd(regeneratorRuntime.mark(function cb(){var Hb;return regeneratorRuntime.wrap(function(ec){for(;;)switch(ec.prev=
ec.next){case 0:return ec.next=2,Nb.whenRendered();case 2:if("frozen"!==bc["lively.lang"]&&!sb.fastLoad){ec.next=9;break}ec.next=5;return pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.c7});case 5:Hb=ec.sent,sb.extractModules("lively.lang"),Nb.finishPackage({packageName:"lively.lang",frozen:!0}),delete Hb._prevLivelyGlobal;case 9:if("frozen"!==bc["lively.ast"]&&!sb.fastLoad){ec.next=15;break}ec.next=12;return pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.aV});
case 12:lively.ast=ec.sent,sb.extractModules("lively.ast"),Nb.finishPackage({packageName:"lively.ast",frozen:!0});case 15:if("frozen"!==bc["lively.source-transform"]&&!sb.fastLoad){ec.next=21;break}ec.next=18;return pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.c8});case 18:lively.sourceTransform=ec.sent,sb.extractModules("lively.source-transform"),Nb.finishPackage({packageName:"lively.source-transform",frozen:!0});case 21:if("frozen"!==bc["lively.classes"]&&
!sb.fastLoad){ec.next=29;break}ec.next=24;return pd.import("./object-classes-c0823978.js");case 24:return ec.next=26,pd.import("./index-ca98f65e.js").then(function(ub){return ub.b});case 26:lively.classes=ec.sent,sb.extractModules("lively.class"),Nb.finishPackage({packageName:"lively.classes",frozen:!0});case 29:if("frozen"!==bc["lively.vm"]&&!sb.fastLoad){ec.next=35;break}ec.next=32;return pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.aW});case 32:lively.vm=
ec.sent,sb.extractModules("lively.vm"),Nb.finishPackage({packageName:"lively.vm",frozen:!0});case 35:if("frozen"!==bc["lively.modules"]&&!sb.fastLoad){ec.next=40;break}ec.next=38;return pd.import("./index-ca98f65e.js").then(function(ub){return ub.m});case 38:sb.extractModules("lively.modules"),Nb.finishPackage({packageName:"lively.modules",frozen:!0});case 40:if("frozen"!==bc["lively.user"]&&!sb.fastLoad){ec.next=47;break}ec.next=43;return pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.ci});
case 43:return ec.next=45,pd.import("./user-ui-0154f489.js");case 45:sb.extractModules("lively.user"),Nb.finishPackage({packageName:"lively.user",frozen:!0});case 47:if("frozen"!==bc["lively.storage"]&&!sb.fastLoad){ec.next=52;break}ec.next=50;return pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.cg});case 50:sb.extractModules("lively.storage"),Nb.finishPackage({packageName:"lively.storage",frozen:!0});case 52:if("frozen"!==bc["lively.morphic"]&&!sb.fastLoad){ec.next=
80;break}ec.next=55;return pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.cc});case 55:return sb.extractModules("lively.resources"),ec.next=58,pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.cd});case 58:return ec.next=60,pd.import("./index-cd4986dd.js");case 60:return sb.extractModules("lively.2lively"),ec.next=63,pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.cb});case 63:return sb.extractModules("lively.serializer2"),
ec.next=66,sb.loadComponents();case 66:return ec.next=68,pd.import("./index-c79abca0.js").then(function(ub){return ub.i});case 68:return sb.extractModules("lively.halos"),ec.next=71,pd.import("./index-1c08552a.js");case 71:return sb.extractModules("lively-system-interface"),ec.next=74,pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.c9});case 74:return sb.extractModules("lively.graphics"),ec.next=77,pd.import("./__rootModule___commonjs-entry-71573ff5.js").then(function(ub){return ub.cj});
case 77:lively.morphic=ec.sent,sb.extractModules("lively.morphic"),Nb.finishPackage({packageName:"lively.morphic",frozen:!0});case 80:case "end":return ec.stop()}},cb)}))).then(Nd(regeneratorRuntime.mark(function Hb(){var ec,ub,yb,ba,wb,Xa,Za,Sb;return regeneratorRuntime.wrap(function(Cb){for(;;)switch(Cb.prev=Cb.next){case 0:return ec=window.SYSTEM_BASE_URL||document.location.origin,ub=window.System,yb=ub.baseURL,yb.endsWith("/")&&(yb=yb.slice(0,-1)),Cb.next=6,sb.resource(ec).join("package-registry.json").readJson();
case 6:return ba=Cb.sent,Cb.next=9,sb.loadViaScript(sb.resource(ec).join("/lively.next-node_modules/@babel/standalone/babel.js").url);case 9:return Cb.next=11,sb.loadViaScript(sb.resource(ec).join("/lively.next-node_modules/systemjs/dist/system.src.js").url);case 11:return Cb.next=13,sb.loadViaScript(sb.resource(ec).join("/lively.modules/systemjs-init.js").url);case 13:wb=lively.modules.getSystem("bootstrapped",{baseURL:ec});lively.modules.changeSystem(wb,!0);wb["__lively.modules__packageRegistry"]=
lively.modules.PackageRegistry.fromJSON(wb,ba);for(Xa in sb.extractedModules)Za=Xa.replace(yb,ec),wb.set(Za,wb.newModule(sb.extractedModules[Xa])),Sb=lively.modules.module(Za),Sb._recorder=sb.extractedModules[Xa],Sb._frozenModule=!0;ub.config({baseURL:ec});sb.installFetchHook(Xb);case 19:case "end":return Cb.stop()}},Hb)}))).then(Nd(regeneratorRuntime.mark(function ec(){return regeneratorRuntime.wrap(function(ub){for(;;)switch(ub.prev=ub.next){case 0:if("dynamic"!==bc["lively.lang"]||sb.fastLoad){ub.next=
2;break}return ub.abrupt("return",sb.importPackageAndDo("lively.lang",function(yb){Nb.finishPackage({packageName:"lively.lang",loaded:!0});delete yb._prevLivelyGlobal},Xb));case 2:case "end":return ub.stop()}},ec)}))).then(Nd(regeneratorRuntime.mark(function ub(){return regeneratorRuntime.wrap(function(yb){for(;;)switch(yb.prev=yb.next){case 0:Nb.animate({opacity:1,easing:sb.easings.outExpo});if("dynamic"!==bc["lively.ast"]||sb.fastLoad){yb.next=3;break}return yb.abrupt("return",sb.importPackageAndDo("lively.ast",
function(ba){Nb.finishPackage({packageName:"lively.ast",loaded:!0});lively.ast=ba},Xb));case 3:case "end":return yb.stop()}},ub)}))).then(Nd(regeneratorRuntime.mark(function yb(){return regeneratorRuntime.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:if("dynamic"!==bc["lively.source-transform"]||sb.fastLoad){ba.next=2;break}return ba.abrupt("return",sb.importPackageAndDo("lively.source-transform",function(wb){Nb.finishPackage({packageName:"lively.source-transform",loaded:!0});lively.sourceTransform=
wb},Xb));case 2:case "end":return ba.stop()}},yb)}))).then(Nd(regeneratorRuntime.mark(function ba(){return regeneratorRuntime.wrap(function(wb){for(;;)switch(wb.prev=wb.next){case 0:if("dynamic"!==bc["lively.classes"]||sb.fastLoad){wb.next=2;break}return wb.abrupt("return",sb.importPackageAndDo("lively.classes",function(Xa){Nb.finishPackage({packageName:"lively.classes",loaded:!0});lively.classes=Xa},Xb));case 2:case "end":return wb.stop()}},ba)}))).then(Nd(regeneratorRuntime.mark(function wb(){return regeneratorRuntime.wrap(function(Xa){for(;;)switch(Xa.prev=
Xa.next){case 0:if("dynamic"!==bc["lively.vm"]||sb.fastLoad){Xa.next=2;break}return Xa.abrupt("return",sb.importPackageAndDo("lively.vm",function(Za){Nb.finishPackage({packageName:"lively.vm",loaded:!0});lively.vm=Za},Xb));case 2:case "end":return Xa.stop()}},wb)}))).then(Nd(regeneratorRuntime.mark(function Xa(){var Za;return regeneratorRuntime.wrap(function(Sb){for(;;)switch(Sb.prev=Sb.next){case 0:Za=function(Cb){lively.modules=Cb;lively.modules.unwrapModuleLoad();lively.modules.unwrapModuleResolution();
lively.modules.wrapModuleLoad();lively.modules.wrapModuleResolution();sb.installFetchHook(Xb);var Da=System["__lively.modules__packageRegistry"];delete System["__lively.modules__packageRegistry"];Cb=System["__lively.modules__packageRegistry"]=Cb.PackageRegistry.ofSystem(System);Object.assign(Cb,sb.obj.select(Da,["packageMap","individualPackageDirs","devPackageDirs","packageBaseDirs"]));Cb.resetByURL();Da=Cb.allPackages();var zb=lively.modules.module("lively.modules/src/packages/package.js").recorder.Package;
Da.filter(function(ib){return!ib.constructor[Symbol["for"]("lively-module-meta")]}).forEach(function(ib){sb.adoptObject(ib,zb)});Da=Object.values(System["__lively.modules__loadedModules"]);var db=lively.modules.module("lively.modules/src/module.js").recorder.ModuleInterface;Da.filter(function(ib){return!ib.constructor[Symbol["for"]("lively-module-meta")]}).forEach(function(ib){sb.adoptObject(ib,db)})};if("frozen"!==bc["lively.modules"]&&!sb.fastLoad){Sb.next=5;break}System._scripting=lively.modules.scripting;
Sb.next=7;break;case 5:return Sb.next=7,sb.importPackageAndDo("lively.modules",Za,Xb);case 7:Nb.finishPackage({packageName:"lively.modules",loaded:!0});case 8:case "end":return Sb.stop()}},Xa)}))).then(Nd(regeneratorRuntime.mark(function Za(){return regeneratorRuntime.wrap(function(Sb){for(;;)switch(Sb.prev=Sb.next){case 0:if("dynamic"!==bc["lively.user"]||sb.fastLoad){Sb.next=2;break}return Sb.abrupt("return",sb.importPackageAndDo("lively.user",function(Cb){Nb.finishPackage({packageName:"lively.user",
loaded:!0});lively.user=Cb},Xb));case 2:case "end":return Sb.stop()}},Za)}))).then(Nd(regeneratorRuntime.mark(function Sb(){return regeneratorRuntime.wrap(function(Cb){for(;;)switch(Cb.prev=Cb.next){case 0:if("dynamic"!==bc["lively.storage"]||sb.fastLoad){Cb.next=2;break}return Cb.abrupt("return",sb.importPackageAndDo("lively.storage",function(Da){Nb.finishPackage({packageName:"lively.storage",loaded:!0});lively.storage=Da},Xb));case 2:case "end":return Cb.stop()}},Sb)})))};sb.fastPrepLivelySystem=
function(Xb){return Promise.resolve().then(function(){Xb.status="starting fast system preparation..."}).then(function(){return sb.resource(System.baseURL).join("package-registry.json").readJson()}).then(function(Nb){System["__lively.modules__packageRegistry"]=lively.modules.PackageRegistry.fromJSON(System,Nb);return System}).then(function(){return sb.loadViaScript(sb.resource(System.baseURL).join("/lively.user/dist/lively.user-client.js").url)})};sb.bootstrap=ic;sb.resource=Tc;sb.unregisterExtension=
Jc;sb.registerExtension=$d;sb.loadViaScript=Bb;sb.string=rd;sb.obj=Id;sb.modulePackage=nd;sb.easings=Ac;sb.partResourceExtension=Pc;sb.adoptObject=gd;lively.modules=sb.modulePackage;sb.doBootstrap=!0;sb.askBeforeQuit=!0;sb.loc=document.location;sb.query=sb.resource(sb.loc.href).query();sb.fastLoad=!0===sb.query.fastLoad||window.FORCE_FAST_LOAD;sb.extractedModules={};sb.loads=0;sb.bootstrap=ic}}});
System.register(["./__root_module__-c4d7431e.js","./index-ad3a1066.js","./color-picker-f735ea68.js"],function(){var ta,nb,Bb,Vb,Qb,Dd,Ic,ud,Nc,Jc,Xc,id,Fd,nd,Yc,Ta,sb,dc,ac,Vc,Hd,hc,kc,xb,yb,wc,Kc,zb;return{setters:[function(ab){ta=ab.as;nb=ab.s;Bb=ab.a6;Vb=ab.aU;Qb=ab.a5;Dd=ab.a8;Ic=ab.a9;ud=ab.aA;Nc=ab.aj;Jc=ab.am;Xc=ab.ah;id=ab.an;Fd=ab.a2;nd=ab.a0;Yc=ab.C;Ta=ab.ap;sb=ab.at;dc=ab.bT;ac=ab.br;Vc=ab.ab;Hd=ab.ar;hc=ab.bg;kc=ab.bq;xb=ab.bo;yb=ab.bU},function(ab){wc=ab.N;Kc=ab.I},function(ab){zb=
ab.a}],execute:function(){var ab=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js");ab.fun=ta;ab.string=nb;ab.obj=Bb;ab.properties=Vb;ab.arr=Qb;ab.Text=Dd;ab.config=Ic;ab.HorizontalLayout=ud;ab.VerticalLayout=Nc;ab.morph=Jc;ab.Morph=Xc;ab.Icon=id;ab.pt=Fd;ab.Rectangle=nd;ab.Color=Yc;ab.connect=Ta;ab.once=sb;ab.noUpdate=dc;ab.ColorPicker=zb;ab.DropDownList=ac;ab.loadObjectFromPartsbinFolder=Vc;ab.cachedControls=new WeakMap;var Kb=function(Va){var cb=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js"),
kb=cb.hasOwnProperty("RichTextControl")&&"function"===typeof cb.RichTextControl?cb.RichTextControl:cb.RichTextControl=function(Ma){Ma&&Ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Hd(kb,Va,[{key:"toggleButton",value:function(Ma,Oa){Ma.master=Oa?{auto:"styleguide://SystemIDE/selected button"}:{auto:"styleguide://System/dark button"}}},{key:"reset",value:function(){var Ma=this.ui.fontSelection;Ma.items=ab.RichTextControl.basicFontItems();
Ma.selection=Ma.items[0].value;ab.connect(this.target,"selectionChange",this,"update")}},{key:"alignAtTarget",value:function(Ma){Ma=void 0===Ma?!!this.world():Ma;var Oa=this.target,lb=Oa.world()||$world,Wb=this.globalBounds();Oa=(Oa.selection.isEmpty()?Oa.globalBounds():Oa.getGlobalTransform().transformRectToRect(Oa.selectionBounds().translatedBy(Oa.scroll.negated()))).bottomCenter().subPt(Wb.topCenter());lb=lb.visibleBounds().translateForInclusion(Wb.translatedBy(Oa)).topLeft().subPt(Wb.topLeft());
lb=this.position.addPt(lb);Ma?this.animate({duration:300,position:lb}):this.position=lb}},{key:"removeFocus",value:function(){this.autoRemove&&this.target&&(this.remove(),this.target=null)}},{key:"focusOn",value:function(Ma,Oa){Oa=void 0===Oa?!0:Oa;var lb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wb){if(1==Wb.nextAddress)return lb.target=Ma,lb.update(),Wb.yield(lb.whenRendered(),2);lb.ui.fontSizeField.relayout();Oa&&lb.alignAtTarget();Wb.jumpToEnd()})}},{key:"setupConnections",
value:function(){ab.connect(this.ui.paddingField,"number",this,"setPadding");ab.connect(this.ui.paddingFieldTop,"number",this,"setPaddingTop");ab.connect(this.ui.paddingFieldBottom,"number",this,"setPaddingBottom");ab.connect(this.ui.paddingFieldLeft,"number",this,"setPaddingLeft");ab.connect(this.ui.paddingFieldRight,"number",this,"setPaddingRight")}},{key:"update",value:function(){var Ma=this,Oa=this.target,lb=this.updateSpec,Wb=Oa.selection;Wb=Wb?Wb.isEmpty()?Oa.textAttributeAt(Wb.start):Oa.getStyleInRange(Wb):
{};var Nb=this.managedProps,rc=ab.obj.select(Oa,Nb);Oa=$jscomp.makeIterator(Object.entries(ab.obj.select(Wb||{},Nb)));for(Wb=Oa.next();!Wb.done;Wb=Oa.next())Nb=$jscomp.makeIterator(Wb.value),Wb=Nb.next().value,Nb=Nb.next().value,"undefined"!==typeof Nb&&(rc[Wb]=Nb);ab.noUpdate(function(){for(var xc=$jscomp.makeIterator(Object.entries(Ma.ui)),I=xc.next();!I.done;I=xc.next()){var T=$jscomp.makeIterator(I.value);I=T.next().value;T=T.next().value;if(lb[I])lb[I](rc,T)}})}},{key:"relayout",value:function(){}},
{key:"changeAttributeInSelectionOrMorph",value:function(Ma,Oa){var lb=this.target,Wb=lb.selection;lb.isLabel||Wb.isEmpty()?lb[Ma]="function"===typeof Oa?Oa(lb[Ma]):Oa:(lb.undoManager.group(),lb.changeStyleProperty(Ma,function(Nb){return"function"===typeof Oa?Oa(Nb):Oa}),lb.undoManager.group())}},{key:"changeFont",value:function(Ma){var Oa=this,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wb){if(1==Wb.nextAddress)return Oa._last=Ma,(lb="custom..."===Ma)?Wb.yield($world.prompt("Enter font family name",
{requester:Oa.target,historyId:"lively.morphic-rich-text-font-names",useLastInput:!0}),3):Wb.jumpTo(2);if(2!=Wb.nextAddress&&(Ma=Wb.yieldResult,!Ma))return Wb.return();Oa.changeAttributeInSelectionOrMorph("fontFamily",Ma);Wb.jumpToEnd()})}},{key:"setPadding",value:function(Ma){this.target.padding=ab.Rectangle.inset(Ma)}},{key:"setPaddingTop",value:function(Ma){var Oa=this.target.padding;this.target.padding=ab.Rectangle.inset(Oa.left(),Ma,Oa.right(),Oa.bottom())}},{key:"setPaddingLeft",value:function(Ma){var Oa=
this.target.padding;this.target.padding=ab.Rectangle.inset(Ma,Oa.top(),Oa.right(),Oa.bottom())}},{key:"setPaddingRight",value:function(Ma){var Oa=this.target.padding;this.target.padding=ab.Rectangle.inset(Oa.left(),Oa.top(),Ma,Oa.bottom())}},{key:"setPaddingBottom",value:function(Ma){var Oa=this.target.padding;this.target.padding=ab.Rectangle.inset(Oa.left(),Oa.top(),Oa.right(),Ma)}},{key:"setLineWrapping",value:function(Ma){this.target.lineWrapping=Ma}},{key:"changeFontWeight",value:function(Ma){this.changeAttributeInSelectionOrMorph("fontWeight",
Ma)}},{key:"changeTextAlign",value:function(Ma){this.changeAttributeInSelectionOrMorph("textAlign",Ma)}},{key:"changeFontColor",value:function(Ma){this.changeAttributeInSelectionOrMorph("fontColor",Ma)}},{key:"changeFontSize",value:function(Ma){this.changeAttributeInSelectionOrMorph("fontSize",Ma)}},{key:"changeFixedWidth",value:function(Ma){this.target.fixedWidth=Ma}},{key:"changeFixedHeight",value:function(Ma){this.target.fixedHeight=Ma}},{key:"changeLink",value:function(){var Ma=this,Oa,lb,Wb,
Nb,rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){if(1==xc.nextAddress)return Oa=Ma.target,lb=Oa.selection,Wb=Oa.getStyleInRange(lb),Nb=Wb.link,xc.yield(Ma.world().prompt("Set link",{input:Nb||"https://"}),2);rc=xc.yieldResult;Oa.undoManager.group();Oa.setStyleInRange({link:rc||void 0},lb);Oa.undoManager.group();Ma.autoRemove&&Ma.remove();xc.jumpToEnd()})}},{key:"toggleUnderline",value:function(){this.changeAttributeInSelectionOrMorph("textDecoration",function(Ma){return"underline"===
Ma?"none":"underline"})}},{key:"toggleItalic",value:function(){this.changeAttributeInSelectionOrMorph("fontStyle",function(Ma){return"italic"===Ma?"normal":"italic"})}},{key:"toggleBold",value:function(){this.changeAttributeInSelectionOrMorph("fontWeight",function(Ma){return"bold"===Ma||"700"===Ma?"normal":"bold"})}},{key:"copyStyle",value:function(){var Ma=this,Oa=this.target,lb=this.ui.applyStyleButton;Oa=Oa.selection.isEmpty()?Oa.defaultTextStyle:Oa.getStyleInRange(Oa.selection);var Wb=JSON.stringify(Oa,
null,2);this.constructor.copiedStyle=Oa;lb.tooltip="paste style\n"+Wb;this.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/plain",data:Wb},{type:"application/morphic-text-style",styleString:Wb}]).then(function(){return Ma.setStatusMessage("Copied style\n"+Wb)}).catch(function(Nb){return Ma.showError(Nb)})}},{key:"pasteStyle",value:function(){var Ma=this,Oa=this.target,lb=this.constructor.copiedStyle;Oa.selection.isEmpty()?Object.assign(Oa,lb):Oa.selections.forEach(function(Wb){return Oa.addTextAttribute(Ma.constructor.copiedStyle,
Wb)});this.update()}},{key:"clearStyle",value:function(){var Ma=this.target;Ma.selections.forEach(function(Oa){return Ma.resetStyleInRange(Oa)});this.update()}},{key:"configureRichTextOptions",value:function(){this.getSubmorphNamed("config panel")&&this.getSubmorphNamed("config panel").remove();var Ma=this.defaultSpec,Oa=this.uiSpec;Ma=this.addMorph({name:"config panel",layout:new ab.VerticalLayout({spacing:5}),epiMorph:!0,submorphs:[].concat($jscomp.arrayFromIterable(Object.keys(Ma).map(function(lb){var Wb=
Oa.rows.some(function(Nb){return Nb.some(function(rc){return rc===lb})});return{type:"labeledcheckbox",label:lb,name:lb,checked:Wb}})),[{layout:new ab.HorizontalLayout({spacing:3}),submorphs:[{type:"button",name:"OK button",label:"OK"},{type:"button",name:"cancel button",label:"Cancel"}]}])});Ma.center=this.innerBounds().center();ab.connect(Ma.getSubmorphNamed("OK button"),"fire",this,"configureAccepted");ab.connect(Ma.getSubmorphNamed("cancel button"),"fire",this,"configureCanceled")}},{key:"configureAccepted",
value:function(){var Ma=this.getSubmorphNamed("config panel");Ma&&(Ma.remove(),Ma.submorphs.filter(function(Oa){return"LabeledCheckBox"===Oa.constructor.name}))}},{key:"configureCanceled",value:function(){var Ma=this.getSubmorphNamed("config panel");Ma&&Ma.remove()}},{key:"close",value:function(){var Ma=this;this.target&&this.target.attributeConnections&&this.target.attributeConnections.forEach(function(Oa){return Oa.targetObj===Ma&&Oa.disconnect()});this.remove()}},{key:"alwaysTargetFocusedMorph",
value:function(){this.startStepping(1500,"updateTarget")}},{key:"updateTarget",value:function(){var Ma=this.world();Ma&&(Ma=Ma.focusedMorph)&&(Ma.isLabel||Ma.isText)&&!this.isAncestorOf(Ma)&&this.target!==Ma&&this.focusOn(Ma,!1)}},{key:"onMouseUp",value:function(Ma){var Oa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){if(1==lb.nextAddress)return lb.yield(Oa.whenRendered(),2);Oa.update();lb.jumpToEnd()})}},{key:"attachToWorld",value:function(){ab.connect($world,"onMouseDown",
this,"updateTarget",{garbageCollect:!0})}}],[{key:"className",get:function(){return"RichTextControl"}},{key:"properties",get:function(){return{autoRemove:{defaultValue:!1},target:{},toggleColor:{},managedProps:{readOnly:!0,get:function(){return"fontFamily fontWeight fontSize fontStyle isText fontColor textAlign link textDecoration fixedWidth fixedHeight lineWrapping padding".split(" ")}},updateSpec:{get:function(){var Ma=this;return Object.assign({fontSelection:function(Oa,lb){var Wb=Oa.fontFamily;
(Oa=Wb&&lb.items.find(function(Nb){return Nb.value.toLowerCase()===Wb.toLowerCase()}))?lb.selection=Oa.value:Wb&&(lb.items=lb.items.concat({isListItem:!0,label:[Wb,{fontFamily:Wb}],value:Wb}),lb.selection=ab.arr.last(lb.items));lb.fit();lb.width=Math.max(lb.width,170)},fontWeightSelection:function(Oa,lb){lb.selection="normal"==Oa.fontWeight?"Medium":Oa.fontWeight?ab.string.capitalize(Oa.fontWeight):"Medium"},boldButton:function(Oa,lb){Ma.toggleButton(lb,"bold"===Oa.fontWeight)},italicButton:function(Oa,
lb){Ma.toggleButton(lb,"italic"===Oa.fontStyle)},underlineButton:function(Oa,lb){Ma.toggleButton(lb,"underline"===Oa.textDecoration)},linkButton:function(Oa,lb){Ma.toggleButton(lb,!!Oa.link)},colorPicker:function(Oa,lb){lb.colorValue=Oa.fontColor},fontSizeField:function(Oa,lb){lb.number=Oa.fontSize},fixedWidthControl:function(Oa,lb){Oa.isText?lb.enable():lb.disable();lb.checked=Oa.fixedWidth},fixedHeightControl:function(Oa,lb){Oa.isText?lb.enable():lb.disable();lb.checked=Oa.fixedHeight},lineWrappingControl:function(Oa,
lb){var Wb=$jscomp.makeIterator(lb.submorphs);lb=Wb.next().value;Wb=Wb.next().value;lb.checked=!!Oa.lineWrapping;Wb.deactivated=!Oa.lineWrapping;Wb.deactivated?Wb.opacity=.5:(Wb.opacity=1,Wb.selection=Oa.lineWrapping)},paddingControl:function(Oa,lb){var Wb=Oa.padding,Nb=Wb.left();Oa=Wb.top();var rc=Wb.right();Wb=Wb.bottom();var xc=!ab.arr.every([Nb,Oa,rc,Wb],function(I){return I==Nb});lb.get("multi value indicator").visible=xc;ab.connect(lb.get("multi value indicator"),"onMouseDown",lb.get("padding field"),
"number",{converter:"() => left",varMapping:{left:Nb}});lb.get("padding field").number=Nb;lb.get("padding field").visible=!xc;lb.get("padding field top").number=Oa;lb.get("padding field left").number=Nb;lb.get("padding field right").number=rc;lb.get("padding field bottom").number=Wb}},["left","center","right","block"].reduce(function(Oa,lb){Oa[lb+"Align"]=function(Wb,Nb){Ma.toggleButton(Nb,Wb.textAlign==lb)};return Oa},{}))}},ui:{get:function(){var Ma=this,Oa={fontSelection:"font selection",fontWeightSelection:"font weight selection",
boldButton:"bold button",italicButton:"italic button",underlineButton:"underline button",linkButton:"link button",leftAlign:"left align",centerAlign:"center align",rightAlign:"right align",blockAlign:"block align",fontSizeField:"font size field",colorPicker:"color picker",copyStyleButton:"copy style",applyStyleButton:"apply style",removeStyleButton:"remove style",fixedHeightControl:"fixed height control",fixedWidthControl:"fixed width control",lineWrappingControl:"line wrapping control",paddingControl:"padding control",
paddingField:"padding field",paddingFieldTop:"padding field top",paddingFieldLeft:"padding field left",paddingFieldRight:"padding field right",paddingFieldBottom:"padding field bottom"};return ab.obj.extract(Oa,ab.obj.keys(Oa),function(lb,Wb){return Ma.getSubmorphNamed(Wb)})}}}}},{key:"openDebouncedFor",value:function(Ma){var Oa=Ma.selection;if(Oa.isEmpty()){var lb=ab.cachedControls.get(Ma);lb&&(lb.update(),lb.alignAtTarget(),lb.world()||Ma.world().addMorph(lb))}else ab.fun.debounceNamed(Ma.id+"openRichTextControl",
600,function(){var Wb=ab.cachedControls.get(Ma);Oa.isEmpty()?Wb&&Wb.removeFocus():(Wb&&Wb.world()||(Wb=new ab.RichTextControl,ab.cachedControls.set(Ma,Wb)),Ma.world().addMorph(Wb),Wb.focusOn(Ma,!0),Wb.alwaysTargetFocusedMorph())})()}},{key:"openFor",value:function(Ma){var Oa=ab.cachedControls.get(Ma);Oa?Oa.update():(Oa=new ab.RichTextControl,ab.cachedControls.set(Ma,Oa),Oa.focusOn(Ma,!0),Oa.alwaysTargetFocusedMorph());Oa.alignAtTarget();Oa.world()||Ma.world().addMorph(Oa);return Oa}}],cb,{pathInPackage:function(){return"text/ui.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:624,end:16984})}(ab.Morph);ab.RichTextControl=Kb;ab.RichTextControl=Kb;ab.RichTextControl=Kb;Kb=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js");Kb.SearchField=hc;var nc=function(Va){var cb=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js"),kb=cb.hasOwnProperty("ProtoSearchField")&&
"function"===typeof cb.ProtoSearchField?cb.ProtoSearchField:cb.ProtoSearchField=function(Ma){Ma&&Ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Hd(kb,Va,void 0,[{key:"className",get:function(){return"ProtoSearchField"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],cb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"ProtoSearchField",version:"0.1.1-0"}}},{start:76,end:221})}(Kb.SearchField);nc=Kb.ProtoSearchField;Kb.default=nc;var da=lively.FreezerRuntime.recorderFor("ProtoTree/index.js");da.Tree=kc;da.TreeData=xb;Kb=function(Va){var cb=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),kb=cb.hasOwnProperty("TestTreeData")&&"function"===typeof cb.TestTreeData?cb.TestTreeData:cb.TestTreeData=function(Ma){Ma&&Ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Hd(kb,Va,[{key:"display",value:function(Ma){return Ma.name}},{key:"isCollapsed",value:function(Ma){return Ma.isCollapsed}},{key:"collapse",value:function(Ma,Oa){Ma.isCollapsed=Oa}},{key:"getChildren",value:function(Ma){return Ma.isLeaf?null:Ma.isCollapsed?[]:Ma.children}},{key:"isLeaf",value:function(Ma){return Ma.isLeaf}}],[{key:"className",get:function(){return"TestTreeData"}}],cb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:113,end:417})}(da.TreeData);da.TestTreeData=Kb;da.TestTreeData=Kb;da.TestTreeData=Kb;Kb=function(Va){var cb=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),kb=cb.hasOwnProperty("ProtoTree")&&"function"===typeof cb.ProtoTree?cb.ProtoTree:cb.ProtoTree=function(Ma){Ma&&Ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Hd(kb,Va,void 0,[{key:"className",get:function(){return"ProtoTree"}},{key:"properties",get:function(){return{treeData:{initialize:function(){this.treeData=new da.TestTreeData({name:"root",isCollapsed:!1,isLeaf:!1,children:[{name:"child 1",isLeaf:!0},{name:"child 2",isLeaf:!1,isCollapsed:!0,children:[{name:"child 2 - 1",isLeaf:!0}]},{name:"child 3",isLeaf:!1,isCollapsed:!1,children:[{name:"child 3 - 1",isLeaf:!0},{name:"child 3 - 2",isLeaf:!0}]},{name:"child 4",isLeaf:!0}]})}},master:{initialize:function(){}}}}}],
cb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:434,end:1297})}(da.Tree);Kb=da.ProtoTree;da.default=Kb;Kb=lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js");Kb.NumberWidget=wc;nc=function(Va){var cb=lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js"),kb=cb.hasOwnProperty("ProtoNumberWidget")&&
"function"===typeof cb.ProtoNumberWidget?cb.ProtoNumberWidget:cb.ProtoNumberWidget=function(Ma){Ma&&Ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Hd(kb,Va,void 0,[{key:"className",get:function(){return"ProtoNumberWidget"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],cb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"ProtoNumberWidget",version:"0.1.1-0"}}},{start:76,end:224})}(Kb.NumberWidget);nc=Kb.ProtoNumberWidget;Kb.default=nc;Kb=lively.FreezerRuntime.recorderFor("FrameResizer/index.js");Kb.Morph=Xc;nc=function(Va){var cb=lively.FreezerRuntime.recorderFor("FrameResizer/index.js"),kb=cb.hasOwnProperty("FrameResizer")&&"function"===typeof cb.FrameResizer?cb.FrameResizer:cb.FrameResizer=function(Ma){Ma&&Ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Hd(kb,Va,[{key:"onDrag",value:function(Ma){var Oa=this.owner.left;Ma=Ma.positionIn(this).x;Ma*="left"==this.direction?-1:1;this.owner.width+=Ma;350>this.owner.width&&(Ma+=350-this.owner.width,this.owner.width=350);this.owner.left="left"==this.direction?Oa-Ma:Oa}}],[{key:"className",get:function(){return"FrameResizer"}},{key:"properties",get:function(){return{direction:{type:"Enum",values:["left","right"]}}}}],cb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"FrameResizer",version:"0.1.1-24"}}},{start:56,end:840})}(Kb.Morph);nc=Kb.FrameResizer;Kb.default=nc;var qa=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js");qa.Morph=Xc;qa.morph=Jc;qa.layouts=yb;qa.string=nb;qa.connect=Ta;qa.noUpdate=dc;qa.InteractiveMorphSelector=Kc;qa.Color=Yc;qa.pt=Fd;Kb=function(Va){var cb=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js"),kb=cb.hasOwnProperty("ShapeLayoutControl")&&
"function"===typeof cb.ShapeLayoutControl?cb.ShapeLayoutControl:cb.ShapeLayoutControl=function(Ma){Ma&&Ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Hd(kb,Va,[{key:"focusOn",value:function(Ma){this.target=Ma;this.update(!1)}},{key:"setupConnections",value:function(){var Ma=this.ui;qa.connect(Ma.submorphSettingsControl,"fire",this,"chooseSubmorphToChangeLayoutSettings");qa.connect(Ma.dragmeControl,"onDragStart",this,"onSubmorphSettingsDragStart");
qa.connect(Ma.xAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "x",\n        submorph: self.selectedSubmorph,\n      })',varMapping:{self:this}});qa.connect(Ma.yAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "y",\n        submorph: self.selectedSubmorph,\n      })',varMapping:{self:this}});for(var Oa={},lb=$jscomp.makeIterator(this.managedProps),
Wb=lb.next();!Wb.done;Oa={$jscomp$loop$prop$prop$2287:Oa.$jscomp$loop$prop$prop$2287},Wb=lb.next()){var Nb=$jscomp.makeIterator(Wb.value),rc=Nb.next().value;Wb=Nb.next().value;Nb.next().value||(Oa.$jscomp$loop$prop$prop$2287=this.join(rc),Nb=Ma[this.join(rc,"control")],qa.connect(Nb,Wb,this,"updateLayout",{updater:function(xc){return function(I,T){I(xc.$jscomp$loop$prop$prop$2287,T)}}(Oa),varMapping:{prop:Oa.$jscomp$loop$prop$prop$2287}}))}}},{key:"lower",value:function(Ma){return Ma.charAt(0).toLowerCase()+
Ma.slice(1)}},{key:"join",value:function(Ma,Oa){return this.lower(qa.string.camelCaseString(Ma+(Oa?" "+Oa:"")))}},{key:"updateLayoutOfTarget",value:function(Ma){Ma=qa.layouts[qa.string.camelCaseString(Ma)];this.target.layout=Ma?new Ma({autoResize:!1}):null;this.update()}},{key:"updateLayout",value:function(Ma,Oa){this.target.layout[Ma]=Oa}},{key:"update",value:function(Ma){var Oa=this;this.target&&qa.noUpdate(function(){for(var lb=Oa.ui,Wb=Oa.target.layout||{name:function(){return"No"}},Nb=$jscomp.makeIterator(Oa.managedProps),
rc=Nb.next();!rc.done;rc=Nb.next()){var xc=$jscomp.makeIterator(rc.value);rc=xc.next().value;var I=xc.next().value;xc.next();xc=lb[Oa.join(rc,"control")];var T=lb[Oa.join(rc,"label")];if(I)if("type"===rc)xc.selection=Wb.name()+" Layout";else{var ua=Wb[Oa.join(rc)],Da="undefined"!==typeof ua;if(Da){switch(rc){case "align":xc.items=Wb.possibleAlignValues;break;case "direction":xc.items=Wb.possibleDirectionValues;break;case "axis":xc.items=Wb.possibleAxisValues}xc[I]=ua}T.isLayoutable=T.visible=Da}}Oa.showGridLayoutControl("Grid"===
Wb.name());Oa.showProportionalControl("Proportional"===Wb.name())})}},{key:"updateSubmorphProportionalLayoutSettings",value:function(Ma){var Oa={};this.target.layout.changeSettingsFor(Ma.submorph,(Oa[Ma.axis]=Ma.policy,Oa),!0)}},{key:"onSubmorphSettingsDragStart",value:function(Ma){var Oa=this;Ma.stop();var lb=this.target.layout,Wb=lb.settingsFor(this.selectedSubmorph),Nb=[],rc;for(rc in Wb)Nb=[].concat($jscomp.arrayFromIterable(Nb),[rc+": ",{fontWeight:"bold"},Wb[rc]+" ",{}]);var xc=qa.morph({type:"label",
fontColor:qa.Color.white,value:Nb,fill:qa.Color.black.withA(.7),padding:5,borderRadius:10,isLayoutable:!1});xc.wantsToBeDroppedOn=function(I){return lb.layoutableSubmorphs.includes(I)};xc.onBeingDroppedOn=function(I,T){xc.remove();if(I=lb.layoutableSubmorphs.includes(T)?T:Ma.world.morphsContainingPoint(Ma.hand.position).find(function(ua){return lb.layoutableSubmorphs.includes(ua)}))Oa.updateSubmorphProportionalLayoutSettings({policy:Wb.x,axis:"x",submorph:I}),Oa.updateSubmorphProportionalLayoutSettings({policy:Wb.y,
axis:"y",submorph:I}),I.show(),$world.setStatusMessage("layout settings applied")};Ma.hand.grab(xc);xc.moveBy(qa.pt(10,10))}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var Ma=this,Oa,lb,Wb,Nb,rc,xc,I,T,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){switch(Da.nextAddress){case 1:return Oa=Ma.target.layout.layoutableSubmorphs,Ma.manageFocus=!0,Ma.env.eventDispatcher.isKeyPressed("Shift")?(Wb=Oa.map(function(Lb){return{isListItem:!0,string:String(Lb),value:Lb}}),
Da.yield($world.listPrompt("Select morph",Wb,{onSelection:function(Lb){return Lb.show()}}),5)):Da.yield(qa.InteractiveMorphSelector.selectMorph(Ma.world(),Ma,function(Lb){return Oa.includes(Lb)}),4);case 4:lb=Da.yieldResult;Da.jumpTo(3);break;case 5:Nb=Da.yieldResult,rc=$jscomp.makeIterator(Nb.selected),lb=rc.next().value;case 3:Ma.manageFocus=!1;Ma.selectedSubmorph=lb;if(!lb)return Da.return();xc=Ma.ui;I=xc.xAxisPolicyControl;T=xc.yAxisPolicyControl;ua=Ma.target.layout.settingsFor(lb);qa.noUpdate(function(){I.selection=
ua.x;T.selection=ua.y});Da.jumpToEnd()}})}},{key:"showProportionalControl",value:function(Ma){var Oa=this.ui;[Oa.submorphSettingsControl,Oa.dragmeControl,Oa.xAxisPolicyControl,Oa.xAxisPolicyLabel,Oa.yAxisPolicyControl,Oa.yAxisPolicyLabel].forEach(function(lb){lb.isLayoutable=Ma;lb.visible=Ma})}},{key:"showGridLayoutHalo",value:function(){$world.showLayoutHaloFor(this.target)}},{key:"showGridLayoutControl",value:function(Ma){var Oa=this.ui.configureGridLayoutControl;Oa.visible=Oa.isLayoutable=Ma}}],
[{key:"className",get:function(){return"ShapeLayoutControl"}},{key:"properties",get:function(){return{managedProps:{get:function(){return[["type","selection",!0],["align","selection"],["direction","selection"],["axis","selection"],["spacing","number"],["auto resize","checked"],["resize submorphs","checked"],["x axis policy","selection",!0],["y axis policy","selection",!0],["react to submorph animations","checked"],["submorph settings",!1,!0],["order by index","checked"],["dragme",!1,!0],["configure grid layout",
!1,!0]]}},ui:{readOnly:!0,get:function(){for(var Ma={labelContainer:this.getSubmorphNamed("label container"),controlContainer:this.getSubmorphNamed("control container")},Oa=$jscomp.makeIterator(this.managedProps),lb=Oa.next();!lb.done;lb=Oa.next()){var Wb=$jscomp.makeIterator(lb.value).next().value;lb=Wb+" label";Wb+=" control";Ma[this.join(lb)]=this.getSubmorphNamed(lb);Ma[this.join(Wb)]=this.getSubmorphNamed(Wb)}return Ma}}}}}],cb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ShapeLayoutControl",version:"0.1.1-166"}}},{start:345,end:7771})}(qa.Morph);Kb=qa.ShapeLayoutControl;qa.default=Kb}}});
System.register("./__root_module__-b4667baa.js kld-intersections ./user-ui-fa4d36fc.js ./index-0ea37dd4.js ./index-82fc4eeb.js ./editor-plugin-44123d71.js ./index-3aad35e9.js".split(" "),function(ta,lb){var yb,Qb,Kb,yd,Cc,rd,Fc,Dc;return{setters:[function(Rc){yb=Rc.ai;Qb=Rc.ao;Kb=Rc.a3;yd=Rc.C;Cc=Rc.a6;rd=Rc.L;Fc=Rc.r;Dc=Rc.as},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var Rc=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");Rc.Morph=
yb;Rc.Icon=Qb;Rc.pt=Kb;Rc.Color=yd;Rc.arr=Cc;Rc.LoadingIndicator=rd;Rc.resource=Fc;var $c=function(Hd){var gd=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),Uc=gd.hasOwnProperty("LivelyTopBar")&&"function"===typeof gd.LivelyTopBar?gd.LivelyTopBar:gd.LivelyTopBar=function(Pa){Pa&&Pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Dc(Uc,Hd,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode=
"Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var Pa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){if(1==mb.nextAddress)return Pa.isComponent?mb.return():mb.yield(Pa.whenRendered(),2);document.body.style.background="black";Pa.setEditMode("Halo");Pa.getSubmorphNamed("fast load toggler").refresh();mb.jumpToEnd()})}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=Rc.pt(0,0));var Pa=
this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;Pa.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var Pa=this;return Object.entries(this.shapeToIcon).map(function(mb){mb=$jscomp.makeIterator(mb);var Nb=mb.next().value,Ub=mb.next().value;mb=Ub.shortcut;Ub=Ub.args;return[[].concat($jscomp.arrayFromIterable(Pa.currentShapeMode===Nb?[].concat($jscomp.arrayFromIterable(Rc.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),
$jscomp.arrayFromIterable(Rc.Icon.textAttribute.apply(Rc.Icon,$jscomp.arrayFromIterable(Ub))),["   "+Nb+" ",{float:"none"},"      "+mb,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){Pa.currentShapeMode=Nb;Pa.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var Pa=this;return Object.entries(this.sideBarToIcon).map(function(mb){mb=$jscomp.makeIterator(mb);var Nb=mb.next().value;mb=mb.next().value.args;return[[].concat($jscomp.arrayFromIterable(Pa.activeSideBars.includes(Nb)?
[].concat($jscomp.arrayFromIterable(Rc.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(Rc.Icon.textAttribute.apply(Rc.Icon,$jscomp.arrayFromIterable(mb))),["   "+Nb+" ",{float:"none"}]),function(){return Pa.openSideBar(Nb)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",
value:function(Pa){"Hand"==this._currentEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(Pa){Dc._get(Object.getPrototypeOf(Uc.prototype),"onKeyDown",this).call(this,Pa);if(Pa.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!Pa.isAltDown()){var mb={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(Pa.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=
mb[Pa.key];this.setEditMode("Shape");break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(Pa){var mb=this,Nb,Ub,Ic,wd,Eb,Sb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){switch(sb.nextAddress){case 1:mb.activeSideBars.includes(Pa)?Rc.arr.remove(mb.activeSideBars,Pa):mb.activeSideBars.push(Pa);if("Scene Graph"!=Pa){sb.jumpTo(2);break}if(mb.sideBar){sb.jumpTo(3);break}Nb=Rc.LoadingIndicator.open("loading side bar");Ub=mb;return sb.yield(lb.import("./scene graph side bar master-0a574cac.js"),
5);case 5:if(!(Ic=sb.yieldResult)){sb.jumpTo(6);break}return sb.yield(Rc.resource("part://SystemIDE/scene graph side bar master"),7);case 7:Ic=sb.yieldResult;case 6:return sb.yield(Ic.read(),4);case 4:return Ub.sideBar=sb.yieldResult,mb.sideBar.hasFixedPosition=!0,mb.sideBar.respondsToVisibleWindow=!0,mb.sideBar.openInWorld(),mb.sideBar.right=0,sb.yield(mb.sideBar.whenRendered(),8);case 8:Nb.remove();case 3:mb.sideBar.toggle(mb.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=
Pa){sb.jumpTo(0);break}if(mb.stylingPalette){sb.jumpTo(10);break}wd=Rc.LoadingIndicator.open("loading side bar");Eb=mb;return sb.yield(lb.import("./styling side bar master-47191931.js"),12);case 12:if(!(Sb=sb.yieldResult)){sb.jumpTo(13);break}return sb.yield(Rc.resource("part://SystemIDE/styling side bar master"),14);case 14:Sb=sb.yieldResult;case 13:return sb.yield(Sb.read(),11);case 11:return Eb.stylingPalette=sb.yieldResult,mb.stylingPalette.collapseAll(),mb.stylingPalette.hasFixedPosition=!0,
mb.stylingPalette.respondsToVisibleWindow=!0,mb.stylingPalette.openInWorld(),mb.stylingPalette.left=mb.world().right,sb.yield(mb.stylingPalette.whenRendered(),15);case 15:wd.remove();case 10:mb.stylingPalette.toggle(mb.activeSideBars.includes("Styling Palette")),sb.jumpToEnd()}})}},{key:"onMouseDown",value:function(Pa){var mb=this.get("select shape type"),Nb=this.get("shape mode button"),Ub=this.get("side bar selector");Pa.targetMorph==mb&&(this.world().openWorldMenu(Pa,this.getShapeMenuItems()).position=
Nb.globalBounds().bottomLeft().subPt(this.world().scroll));Pa.targetMorph==Nb&&this.setEditMode("Shape");"text mode button"==Pa.targetMorph.name&&this.setEditMode("Text");"hand mode button"==Pa.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==Pa.targetMorph.name&&this.setEditMode("Halo");"open component browser"==Pa.targetMorph.name&&this.interactivelyLoadComponent();"load world button"==Pa.targetMorph.name&&this.world().execCommand("load world");Pa.targetMorph==Ub&&(this.world().openWorldMenu(Pa,
this.getSideBarMenuItems()).position=Ub.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var Pa=this,mb,Nb,Ub,Ic,wd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Eb){if(1==Eb.nextAddress)return mb=Pa.get("open component browser"),Nb=Pa.get("user flap"),Ub=Nb.haloShadow,Ic=Nb.haloColor,wd=Rc.Color.rgb(102,102,102),mb.fontColor=Ic,mb.dropShadow=Ub,Eb.yield(Pa.world().execCommand("browse and load component"),2);mb.dropShadow=!1;
mb.fontColor=wd;Eb.jumpToEnd()})}},{key:"setEditMode",value:function(Pa,mb){var Nb=this;mb=void 0===mb?!1:mb;var Ub=this.get("user flap"),Ic=Ub.haloShadow,wd=Ub.haloColor,Eb=Rc.Color.rgb(102,102,102);mb||(this._currentEditMode=Pa);mb=this.get("shape mode button");Ub=this.get("text mode button");var Sb=this.get("hand mode button"),sb=this.get("halo mode button");[["Shape",mb.submorphs],["Text",[Ub]],["Hand",[Sb]],["Halo",[sb]]].forEach(function(ec){var rc=$jscomp.makeIterator(ec);ec=rc.next().value;
rc=rc.next().value;"Shape"==Pa?Nb.world().toggleShapeMode(!0,Nb.currentShapeMode):"Text"==Pa?Nb.world().toggleShapeMode(!0,"Text"):Nb.world().toggleShapeMode(!1);Nb.world().showHaloPreviews("Halo"==Pa);ec==Pa?rc.forEach(function(yc){yc.dropShadow=Ic;yc.fontColor=wd}):rc.forEach(function(yc){yc.dropShadow=null;yc.fontColor=Eb})})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],
set:function(Pa){this.setProperty("currentShapeMode",Pa);this.get("shape status icon").textAndAttributes=Rc.Icon.textAttribute(this.shapeToIcon[Pa].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},
Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],gd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-154"}}},{start:328,end:9325})}(Rc.Morph);$c=Rc.LivelyTopBar;Rc.default=$c}}});System.register("22",["./__root_module__-b4667baa.js","kld-intersections","./user-ui-fa4d36fc.js","./index-1bf516c3.js"],function(){return{setters:[function(){},function(){},function(){},function(){}],execute:function(){}}});
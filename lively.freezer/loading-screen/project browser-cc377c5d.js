System.register(["./__root_module__-28353364.js","./object-classes-d1bf095f.js","./user-ui-49874e7c.js","./index-d97c8020.js","./index-2112d28c.js"],function(){var Ia,mb,vb,Vb,Eb,Jc,Bc,Uc,tc,oc,sc,Tc,Fd,Rd,ee,Dc,rd,Ab,qc;return{setters:[function(Xc){Ia=Xc.M;mb=Xc.af;vb=Xc.aa;Vb=Xc.m;Eb=Xc.ae;Jc=Xc.a;Bc=Xc.f;Uc=Xc.s;tc=Xc.C;oc=Xc.b;sc=Xc.r;Tc=Xc.i;Fd=Xc.t;Rd=Xc.aA;ee=Xc.aB;Dc=Xc.c;rd=Xc.ax;Ab=Xc._},function(){},function(Xc){qc=Xc.UserUI},function(){},function(){}],execute:function(){var Xc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");
Xc.Morph=Ia;Xc.HorizontalLayout=mb;Xc.VerticalLayout=vb;Xc.morph=Vb;Xc.MorphicDB=Eb;Xc.arr=Jc;Xc.fun=Bc;Xc.string=Uc;Xc.Color=tc;Xc.pt=oc;Xc.UserUI=qc;Xc.resource=sc;var zc=function(xb){var hc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),Cc=hc.hasOwnProperty("WorldDashboard")&&"function"===typeof hc.WorldDashboard?hc.WorldDashboard:hc.WorldDashboard=function(ic){ic&&ic[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tc(Cc,
xb,[{key:"onLoad",value:function(){if(!this.isComponent&&"undefined"!==typeof localStorage){var ic=localStorage.getItem("lively.morphic-projects-filter");ic&&this.ui.sortSelector.selection!=ic&&(this.ui.sortSelector.selection=ic)}}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",this.ui.sortSelector.selection)}catch(ic){console.error(ic)}}},
{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(ic){ic=void 0===ic?$world:ic;this.owner!=ic&&ic.addMorph(this);this.center=ic.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(ic){var Qc=Xc.UserUI.getCurrentUser();ic=this.ui.searchField.fuzzyFilter(ic,function(jb){return jb._commit.name+jb._commit.description});
switch(this.ui.sortSelector.selection){case "RECENT":return Xc.arr.sortBy(ic,function(jb){return-jb._commit.timestamp});case "TEMPLATES":return ic;case "MY PROJECTS":return Xc.arr.filter(ic,function(jb){return jb._commit.author.name===Qc.name});case "PUBLISHED":return ic}}},{key:"updateList",value:function(){var ic=this;this.previews&&Xc.fun.debounceNamed("update world list",150,function(){ic.ui.worldList.items=ic.sortAndFilterPreviews(ic.previews)})()}},{key:"displayWorlds",value:function(){var ic=
this,Qc,jb,fb,Ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cb){switch(Cb.nextAddress){case 1:return ic.reset(),Qc=ic.ui,jb=Qc.loadingLabel,jb.fit(),jb.animate({opacity:1,duration:300}),Cb.yield(ic.db.latestCommits("world"),2);case 2:return fb=Cb.yieldResult,Cb.yield(Xc.resource("part://partial freezing/world preview").read(),3);case 3:return Ob=Cb.yieldResult,ic.previews=fb.map(function(ob){var bc=Xc.morph({reactsToPointer:!1,fill:Xc.Color.transparent,extent:Ob.extent});bc._commit=
ob;bc.displayPreview=function(){var Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){if(1==Db.nextAddress)return Ma=Ob.copy(),Ma._commit=ob,Ma.opacity=0,bc.addMorph(Ma),Ma.displayPreview(),Ma.position=Xc.pt(0,0),Db.yield(bc.whenRendered(),2);bc.layout=new Xc.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});Db.jumpToEnd()})};return bc}),Cb.yield(jb.animate({opacity:0,duration:300}),4);case 4:ic.updateList(),0==fb.length&&(ic.ui.noWorldWarning.center=ic.innerBounds().center(),
ic.ui.noWorldWarning.animate({visible:!0,duration:300})),Cb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(ic){this.ui.closeButton.visible=ic}},db:{serialize:!1,get:function(){return Xc.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),
sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],hc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",
version:"0.1.1-135"}}},{start:330,end:4417})}(Xc.Morph);zc=Xc.WorldDashboard;Xc.default=zc;var ed=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");ed.Morph=Ia;ed.touchInputDevice=Fd;ed.TilingLayout=Rd;ed.arr=Jc;ed.pt=oc;zc=function(xb){var hc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),Cc=hc.hasOwnProperty("GrowingWorldList")&&"function"===typeof hc.GrowingWorldList?hc.GrowingWorldList:hc.GrowingWorldList=function(ic){ic&&ic[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tc(Cc,xb,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(ic){Tc._get(Object.getPrototypeOf(Cc.prototype),"onScroll",this).call(this,ic);this.update()}},{key:"onChange",value:function(ic){Tc._get(Object.getPrototypeOf(Cc.prototype),"onChange",this).call(this,ic);"extent"==ic.prop&&this.update(!0)}},{key:"onHoverIn",value:function(ic){this.clipMode="auto"}},{key:"onHoverOut",value:function(ic){ed.touchInputDevice||
(this.clipMode="hidden")}},{key:"update",value:function(ic){var Qc=this.items;if(Qc&&0!=Qc.length){var jb=this.scrollContainer,fb=jb.layout.spacing;jb.extent=this.extent;var Ob=this.ui,Cb=Ob.bufferTop;Ob=Ob.bufferBottom;Cb=Cb||jb.addMorph({fill:null,name:"buffer top",height:10});Ob=Ob||jb.addMorph({fill:null,name:"buffer bottom",height:10});Cb.width=Ob.width=this.width-100;jb.layout.disable();var ob=Qc[0];fb=Qc.slice(0,Math.floor(this.width/(ob.width+fb))*(Math.ceil((this.scroll.y+this.height)/(ob.height+
fb))+1)).filter(function(gb){return gb.owner!=jb});ob=this.scroll.y+2*this.height;for(var bc={},Ma=$jscomp.makeIterator(fb),Db=Ma.next();!Db.done;bc={$jscomp$loop$prop$item$2769:bc.$jscomp$loop$prop$item$2769},Db=Ma.next())bc.$jscomp$loop$prop$item$2769=Db.value,ob++,bc.$jscomp$loop$prop$item$2769.top=ob,jb.addMorph(bc.$jscomp$loop$prop$item$2769),bc.$jscomp$loop$prop$item$2769._initialized||bc.$jscomp$loop$prop$item$2769.whenRendered().then(function(gb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(zb){gb.$jscomp$loop$prop$item$2769._initialized=
!0;return zb.yield(gb.$jscomp$loop$prop$item$2769.displayPreview(),0)})}}(bc));ic&&(Cb.position=ed.pt(0,0),Qc.forEach(function(gb,zb){return gb.position=ed.pt(zb+1,zb+1)}),Ob.position=ed.pt(Qc.length+2,Qc.length+2));jb.layout.enable();if(ic||0<fb.length)Ob.top=this.submorphBounds().height,jb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new ed.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(ic){this.setProperty("items",ic);var Qc=this.scrollContainer;Qc.layout&&Qc.layout.disable();var jb=this.ui,fb=jb.bufferTop;jb=jb.bufferBottom;ed.arr.withoutAll(Qc.submorphs,
[].concat($jscomp.arrayFromIterable(ic),[fb,jb])).forEach(function(Ob){return Ob.remove()});this.update(!0)}}}}}],hc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(ed.Morph);zc=ed.GrowingWorldList;ed.default=zc;var wd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
wd.InputLine=ee;wd.Color=tc;wd.connect=Dc;wd.disconnectAll=rd;wd.disconnect=Ab;wd.arr=Jc;wd.string=Uc;zc=function(xb){var hc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),Cc=hc.hasOwnProperty("SearchInputLine")&&"function"===typeof hc.SearchInputLine?hc.SearchInputLine:hc.SearchInputLine=function(ic){ic&&ic[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tc(Cc,xb,[{key:"fuzzyMatch",value:function(ic,Qc){Qc=void 0===
Qc?this.parseInput():Qc;if(Qc.lowercasedTokens.every(function(fb){return ic.toLowerCase().includes(fb)}))return!0;var jb=ic.toLowerCase();return 3>=wd.arr.sum(Qc.lowercasedTokens.map(function(fb){return wd.string.levenshtein(jb,fb)}))}},{key:"fuzzyFilter",value:function(ic,Qc){var jb=this;Qc=void 0===Qc?function(Ob){return Ob}:Qc;var fb=this.parseInput();return wd.arr.filter(ic,function(Ob){return jb.fuzzyMatch(Qc(Ob),fb)})}},{key:"parseInput",value:function(){var ic=Array.from(this.textString).reduce(function(jb,
fb){if("\\"===fb&&!jb.escaped)return jb.escaped=!0,jb;" "!==fb||jb.escaped?(jb.spaceSeen=!1,jb.current+=fb):(!jb.spaceSeen&&jb.current&&(jb.tokens.push(jb.current),jb.current=""),jb.spaceSeen=!0);jb.escaped=!1;return jb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});ic.current&&ic.tokens.push(ic.current);var Qc=ic.tokens.map(function(jb){return jb.toLowerCase()});return{tokens:ic.tokens,lowercasedTokens:Qc}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],hc,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(wd.InputLine);zc=wd.SearchInputLine;wd.default=zc}}});
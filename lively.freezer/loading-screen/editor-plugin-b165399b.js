System.register(["./__root_module__-39b2be6e.js","./index-bc3e9fbd.js","./index-8c1367cc.js"],function(wa){var bb,ib,Qb,Ib,ed,qc,pd,uc,Ac,dd,Ad,le,Le,ae,lc,Wc,Ed,Tb,Bd,Sd,hc,mc,Hb,ec,vc,gd,Zc,Za,Xa,jb,Fa,Ea,ka,ja,Ca,mb,Ub,Ya,$a,Ua,U,Ba,K,V,ra;return{setters:[function(Ja){bb=Ja.C;ib=Ja.aJ;Qb=Ja.a6;Ib=Ja.a1;ed=Ja.a3;qc=Ja.ab;pd=Ja.aM;uc=Ja.aB;Ac=Ja.aF;dd=Ja.a7;Ad=Ja.ba;le=Ja.bu;Le=Ja.bv;ae=Ja.a8;lc=Ja.ak;Wc=Ja.aH;Ed=Ja.aG;Tb=Ja.bw;Bd=Ja.bx;Sd=Ja.a2;hc=Ja.P;mc=Ja.$;Hb=Ja.bh;ec=Ja.av;vc=Ja.aV;gd=
Ja.ax;Zc=Ja.aN;Za=Ja.ay;Xa=Ja.aw;jb=Ja.aX;Fa=Ja.aK;Ea=Ja.ad;ka=Ja.by;ja=Ja.L;Ca=Ja.bz;mb=Ja.aC;Ub=Ja.aP;Ya=Ja.bm;$a=Ja.bA;Ua=Ja.aO},function(Ja){U=Ja.M;Ba=Ja.I;K=Ja.v;V=Ja.p},function(Ja){ra=Ja.localInterface}],execute:function(){function Ja(ya,Oa){if(!0===Oa)return Oa;if(ya.copyState)return ya.copyState(Oa);ya={};for(var nb in Oa){var R=Oa[nb];R instanceof Array&&(R=R.concat([]));ya[nb]=R}return ya}function hb(ya,Oa,nb){return ya.startState?ya.startState(Oa,nb):!0}function dc(ya,Oa){return Eb.modes[ya]=
Oa}function na(ya){if("string"==typeof ya&&Eb.mimeModes.hasOwnProperty(ya))ya=Eb.mimeModes[ya];else if(ya&&"string"==typeof ya.name&&Eb.mimeModes.hasOwnProperty(ya.name)){var Oa=Eb.mimeModes[ya.name];"string"==typeof Oa&&(Oa={name:Oa});ya=Object.assign({},Oa,ya);ya.name=Oa.name}else{if("string"==typeof ya&&/^[\w\-]+\/[\w\-]+\+xml$/.test(ya))return na("application/xml");if("string"==typeof ya&&/^[\w\-]+\/[\w\-]+\+json$/.test(ya))return na("application/json")}return"string"==typeof ya?{name:ya}:ya||
{name:"null"}}function oa(ya,Oa){Oa=Eb.resolveMode(Oa);"string"===typeof Oa&&(Oa={name:Oa});if(!Oa.name)throw Error("parserConfig does not have a name of the mode to get");var nb=Eb.modes[Oa.name];if(!nb)return oa(ya,"text/plain");ya=Object.assign({indentUnit:2},ya);return Object.assign(nb(ya,Oa),{name:Oa.name})}function wb(ya,Oa){for(var nb;ya.innerMode;){nb=ya.innerMode(Oa);if(!nb||nb.mode==ya)break;Oa=nb.state;ya=nb.mode}return nb||{mode:ya,state:Oa}}function fc(ya,Oa){Eb.mimeModes[ya]=Oa}function Qa(ya,
Oa,nb){}function Lc(ya,Oa,nb,R,xa,Va,eb){var ac=ya.editorPlugin._tokenizerValidBefore;ac&&ac.row>=nb&&(ac.row=nb-1);var Db=Eb.linesToTokenize(ya.document,nb,R,ac);ac=Db.lines;Db=Db.state;if(!ac.length)return!1;Db=Db?Eb.copyState(Oa,Db):Eb.startState(Oa);for(var xc=0;xc<ac.length;xc++){var Jc=ac[xc],Bc=Jc.row;Bc>=nb&&Bc<=R&&Eb.indentLine(ya,Oa,Jc,Db,xa,Va,eb);Db=Eb.tokenizeLine(Oa,ac[xc],Db,function(){})}return!0}function ld(ya,Oa,nb,R,xa,Va,eb){Oa=Eb.linesToTokenize(Oa,nb,R,xa);nb=Oa.lines;Eb.tokenizeLines(ya,
nb,Oa.state,Va,eb);return nb}function od(ya,Oa,nb,R,xa){var Va=[],eb,ac=function(Jc){return Va.push(eb=[])},Db=function(Jc,Bc,re,of,Ye,Bg,Bh){return eb.push(re,of,Jc,Ye.current(),Bc.localMode||Bh)};try{var xc=Eb.visitDocumentTokens(ya,Oa,nb,R,xa,ac,Db)}catch(Jc){Va.length=0,xc=Eb.visitDocumentTokens(ya,Oa,nb,R,null,ac,Db)}return{tokens:Va,lines:xc}}function Be(ya,Oa,nb,R,xa){null==Oa&&(Oa=ya.search(/[^\s\u00a0]/),-1==Oa&&(Oa=ya.length));R=R||0;for(xa=xa||0;;){var Va=ya.indexOf("\t",R);if(0>Va||Va>=
Oa)return xa+(Oa-R);xa+=Va-R;xa+=nb-xa%nb;R=Va+1}}function sd(ya){ya=ya.toLowerCase();for(var Oa=0;Oa<Eb.modeInfo.length;Oa++){var nb=Eb.modeInfo[Oa];if(nb.mime==ya)return nb;if(nb.mimes)for(var R=0;R<nb.mimes.length;R++)if(nb.mimes[R]==ya)return nb}if(/\+xml$/.test(ya))return sd("application/xml");if(/\+json$/.test(ya))return sd("application/json")}function Ze(ya){for(var Oa=0;Oa<Eb.modeInfo.length;Oa++){var nb=Eb.modeInfo[Oa];if(nb.ext)for(var R=0;R<nb.ext.length;R++)if(nb.ext[R]==ya)return nb}}
function Hf(ya){for(var Oa=0;Oa<Eb.modeInfo.length;Oa++){var nb=Eb.modeInfo[Oa];if(nb.file&&nb.file.test(ya))return nb}Oa=ya.lastIndexOf(".");if(ya=-1<Oa&&ya.substring(Oa+1,ya.length))return Eb.findModeByExtension(ya)}function sc(ya){ya=ya.toLowerCase();for(var Oa=0;Oa<Eb.modeInfo.length;Oa++){var nb=Eb.modeInfo[Oa];if(nb.name.toLowerCase()==ya)return nb;if(nb.alias)for(var R=0;R<nb.alias.length;R++)if(nb.alias[R].toLowerCase()==ya)return nb}}function Yb(ya){if(!ya)return String(ya);if(Array.isArray(ya))return"["+
ya.map(Yb).join(",")+"]";if("symbol"===typeof ya)return Kc.printSymbol(ya);try{return String(ya)}catch(Oa){return"Cannot print object: "+Oa}}function Ce(ya,Oa){return!Kc.arr.every(Oa.map(function(nb){return ya[nb]}),function(nb){return Kc.obj.equals(nb,ya&&ya.valueOf())})}function Wb(ya){if(Kc.obj.isPrimitive(ya))var Oa=Kc.string.print(ya);else Array.isArray(ya)?((Oa=3<ya.length)&&(ya=ya.slice(0,3)),ya=Kc.string.print(ya),Oa&&(ya=ya.slice(0,-1)+", ...]"),Oa=ya):Oa=Kc.string.print(ya);Oa=Oa.replace(/\n/g,
"");500<Oa.length&&(Oa=Oa.slice(0,20)+("...["+(Oa.length-20)+' CHARS]"'));return Oa}function cb(ya){return $b.Inspector.openInWindow({targetObject:ya})}function Xb(ya,Oa){return $b.Inspector.openInWindow({remoteTarget:{code:ya,evalEnvironment:Oa}})}function H(ya,Oa){function nb(ac){var Db=ac.name,xc=ac.ownerChain(),Jc=ac.owner,Bc=ac.world(),re;ac===Va&&(re=[eb]);Bc===ac&&(re=["$world"]);if(!re&&Db&&Jc){Jc===Bc&&1===$b.arr.count($b.arr.pluck(Bc.submorphs,"name"),Db)&&(re=['$world.get("'+Db+'")']);
if(!re&&Jc!=Bc)for(Bc=xc.length-1;Bc--;)if(1===xc[Bc].getAllNamed(Db).length){re=[].concat($jscomp.arrayFromIterable(nb(xc[Bc])),['get("'+Db+'")']);break}re||(Db=[].concat($jscomp.arrayFromIterable(nb(Jc)),['get("'+Db+'")']),$b.syncEval(Db.join("."),{context:Va}).value===ac&&(re=Db))}re||(re=[eb+'.getMorphById("'+ac.id+'")']);return re}Oa=void 0===Oa?{}:Oa;var R=ya.world(),xa=Oa;Oa=void 0===xa.maxLength?10:xa.maxLength;var Va=void 0===xa.fromMorph?R:xa.fromMorph;if(Va===ya)return"this";var eb=R===
Va?"$world":"this";if(!(R||ya.name&&Va.get(ya.name)===ya))return"morph";R=nb(ya);return R.length>Oa?'$world.getMorphWithId("'+ya.id+'")':R.join(".")}function pa(ya,Oa,nb){var R=(Oa=void 0===Oa?"":Oa)&&Je.arr.last(Oa.split(".")).toLowerCase(),xa="",Va=0,eb=Math.pow(2,19);if("string"===typeof ya){if(ya.length>eb)return null}else if(ya.document.stringSize>eb)return null;if("string"===typeof ya)xa=ya.slice(0,1E3);else for(ya=$jscomp.makeIterator(ya.document.lines),eb=ya.next();!eb.done;eb=ya.next()){var ac=
eb.value;eb=ac.stringSize;ac=ac.text;var Db=!0;1E3<Va+eb&&(Db=!1,eb=1E3-Va);xa+=ac.slice(0,eb)+(Db?"\n":"");Va+=eb;if(1E3<=Va)break}Va=$jscomp.makeIterator(Je.modeInfo);for(ya=Va.next();!ya.done;ya=Va.next()){Db=ya.value;eb=Db.contentTest;ya=Db.mode;ac=Db.ext;Db=Db.file;if("function"===typeof eb)try{if(eb(xa))return ya}catch(xc){}if(Db&&Db instanceof RegExp&&Db.test(Oa))return ya;if(ac)for(eb=$jscomp.makeIterator(ac),ac=eb.next();!ac.done;ac=eb.next())if(ac.value===R)return ya}return nb}wa({a:fc,
d:dc,r:Qa});var Sa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");Sa.Color=bb;var rb=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),nb=Oa.hasOwnProperty("DefaultTheme")&&"function"===typeof Oa.DefaultTheme?Oa.DefaultTheme:Oa.DefaultTheme=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:"background",get:function(){return Sa.Color.white}},{key:"default",
get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Sa.Color.white,fontWeight:"bold",backgroundColor:Sa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Sa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Sa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Oa,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Sb=rb=Sa.DefaultTheme;Sa.default=rb;var Eb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");Eb.copyState=Ja;Eb.startState=hb;Eb.defineMode=dc;Eb.resolveMode=na;Eb.getMode=oa;Eb.innerMode=wb;Eb.defineMIME=fc;Eb.registerHelper=Qa;Eb.indentLines=Lc;Eb.indentLine=function(ya,Oa,nb,R,xa,Va,eb){eb=Object.assign({indentWithTabs:!ya.useSoftTabs,indentUnit:ya.tabWidth,tabSize:4,ignoreFollowingText:!1},
eb);null==xa&&(xa="add");"smart"==xa&&(Oa.indent||(xa="prev"));var ac=eb.tabSize,Db=nb.text,xc=Eb.countColumn(Db,null,ac);nb.modeState&&(nb.modeState=null);var Jc=Db.match(/^\s*/)[0];if(!Va&&!/\S/.test(Db)){var Bc=0;xa="not"}else if("smart"==xa&&(Bc=Oa.indent(R,eb.ignoreFollowingText?"":Db.slice(Jc.length),Db),Bc==Eb.passIndent||150<Bc)){if(!Va)return;xa="prev"}"prev"==xa?Bc=0<nb.row?Eb.countColumn(nb.prevLine().text,null,ac):0:"add"==xa?Bc=xc+eb.indentUnit:"subtract"==xa?Bc=xc-eb.indentUnit:"number"==
typeof xa&&(Bc=xc+xa);Bc=Math.max(0,Bc);Oa="";R=0;if(eb.indentWithTabs)for(eb=Math.floor(Bc/ac);eb;--eb)R+=ac,Oa+="\t";R<Bc&&(Oa+=" ".repeat(Bc-R));if(Oa!=Jc)return ya.replace({start:{row:nb.row,column:0},end:{row:nb.row,column:Jc.length}},Oa),!0};Eb.tokenizeLines=function(ya,Oa,nb,R,xa){if(Oa.length){nb=nb?Eb.copyState(ya,nb):Eb.startState(ya);for(var Va=0;Va<Oa.length;Va++){var eb=Oa[Va];R(eb);nb=Eb.tokenizeLine(ya,eb,nb,xa)}}};Eb.tokenizeLine=function(ya,Oa,nb,R){var xa=Oa.text;if(!xa)return nb;
var Va=new Eb.StringStream(xa,2);nb=Oa.modeState="function"===typeof ya.copyState?ya.copyState(nb):Eb.copyState(ya,nb);Oa.prevLine();for(nb._string=xa;!Va.eol();)xa=ya.token(Va,nb),R(xa,nb,Va.start,Va.pos,Va,Oa,ya),Va.start=Va.pos;return nb};Eb.printTokens=function(ya){for(var Oa="",nb=0;nb<ya.length;nb+=5)Oa+=ya[nb+0]+" => "+ya[nb+1]+" "+ya[nb+2]+" "+ya[nb+3]+" "+ya[nb+4].name+"\n";return Oa};Eb.visitDocumentTokens=ld;Eb.tokenizeDocument=od;Eb.linesToTokenize=function(ya,Oa,nb,R){if(R&&R.row>=nb)return{lines:[],
state:null};Oa=R?Math.max(0,R.row-1):Oa;var xa=ya.getLine(Oa),Va=xa.text;ya=[xa];R=null;for(var eb=0,ac;(ac=xa.prevLine())&&50>eb++;){xa=ac;if(xa.modeState){R=xa.modeState;break}ya.unshift(xa)}if(!R){for(var Db=xa,xc=Infinity;(ac=xa.prevLine())&&100>eb++;){xa=ac;if(xa.modeState){R=xa.modeState;break}ya.unshift(xa);ac=Va.match(/^\s*/)[0].length;if(0===ac)break;ac<xc&&(xc=ac,Db=xa)}!R&&0<xc&&(ya=ya.slice(ya.indexOf(Db)))}if(nb>Oa)for(xa=Eb.arr.last(ya);Oa<=nb;Oa++){xa=xa.nextLine();if(!xa)break;ya.push(xa)}return{lines:ya,
state:R}};Eb.countColumn=Be;Eb.findModeByMIME=sd;Eb.findModeByExtension=Ze;Eb.findModeByFileName=Hf;Eb.findModeByName=sc;Eb.arr=Qb;rb=Eb.modes||{};Eb.modes=rb;Eb.modes=rb;Eb.modes=rb;rb=wa("p",{});Eb.passIndent=rb;Eb.passIndent=rb;Eb.passIndent=rb;Eb.copyState=Ja;Eb.copyState=Ja;Eb.startState=hb;Eb.startState=hb;Eb.defineMode=dc;Eb.defineMode=dc;Eb.resolveMode=na;Eb.resolveMode=na;Eb.getMode=oa;Eb.getMode=oa;Eb.innerMode=wb;Eb.innerMode=wb;rb={};Eb.mimeModes=rb;Eb.mimeModes=rb;Eb.mimeModes=rb;Eb.defineMIME=
fc;Eb.defineMIME=fc;Eb.registerHelper=Qa;Eb.registerHelper=Qa;Eb.indentLines=Lc;Eb.indentLines=Lc;Eb.visitDocumentTokens=ld;Eb.visitDocumentTokens=ld;Eb.tokenizeDocument=od;Eb.tokenizeDocument=od;Eb.countColumn=Be;Eb.countColumn=Be;(function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),nb=Oa.hasOwnProperty("StringStream")&&"function"===typeof Oa.StringStream?Oa.StringStream:Oa.StringStream=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return ib(nb,ya,[{key:Symbol.for("lively-instance-initialize"),value:function(R,xa){this.reset(R,xa)}},{key:"reset",value:function(R,xa){this.pos=this.start=0;this.string=void 0===R?"":R;this.tabSize=void 0===xa?2:xa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",
value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(R){var xa=this.string.charAt(this.pos);if("string"==typeof R?xa==R:xa&&(R.test?R.test(xa):R(xa)))return++this.pos,xa}},{key:"eatWhile",value:function(R){for(var xa=this.pos;this.eat(R););return this.pos>xa}},{key:"eatSpace",value:function(){for(var R=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>R}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},
{key:"skipTo",value:function(R){R=this.string.indexOf(R,this.pos);if(-1<R)return this.pos=R,!0}},{key:"backUp",value:function(R){this.pos-=R}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=Eb.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?Eb.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return Eb.countColumn(this.string,
null,this.tabSize)-(this.lineStart?Eb.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(R,xa,Va){if("string"==typeof R){var eb=function(Db){return Va?Db.toLowerCase():Db},ac=this.string.substr(this.pos,R.length);if(eb(ac)==eb(R))return!1!==xa&&(this.pos+=R.length),!0}else{if((R=this.string.slice(this.pos).match(R))&&0<R.index)return null;R&&!1!==xa&&(this.pos+=R[0].length);return R}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},
{key:"hideFirstChars",value:function(R,xa){this.lineStart+=R;try{return xa()}finally{this.lineStart-=R}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],Oa,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);rb=[{name:"APL",mime:"text/apl",
mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),
alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",
mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",
mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(ya){return ya.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",
mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",
mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",
mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",
mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",
mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},
{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",
mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",
mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p",
"pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",
ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},
{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",
mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(ya){return ya.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},
{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},
{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",
mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",
mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",
ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml",
"text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];Eb.modeInfo=rb;Eb.modeInfo=rb;Eb.modeInfo=rb;for(var Mc=0;Mc<Eb.modeInfo.length;Mc++)Eb.info=Eb.modeInfo[Mc],Eb.info.mimes&&(Eb.info.mime=Eb.info.mimes[0]);Eb.defineMode("null",function(){return{token:function(ya){return ya.skipToEnd()}}});
Eb.defineMIME("text/plain","null");Eb.findModeByMIME=sd;Eb.findModeByMIME=sd;Eb.findModeByExtension=Ze;Eb.findModeByExtension=Ze;Eb.findModeByFileName=Hf;Eb.findModeByFileName=Hf;Eb.findModeByName=sc;Eb.findModeByName=sc;var Fc=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Fc.Color=bb;Fc.Rectangle=Ib;Fc.pt=ed;Fc.morph=qc;Fc.ShadowObject=pd;Fc.StyleSheet=uc;Fc.connect=Ac;Fc.arr=Qb;Fc.string=dd;Fc.FilterableList=Ad;Fc.Range=le;Mc=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
nb=Oa.hasOwnProperty("Completer")&&"function"===typeof Oa.Completer?Oa.Completer:Oa.Completer=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],Oa,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);Fc.Completer=Mc;Fc.Completer=Mc;Fc.Completer=Mc;Mc=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),nb=Oa.hasOwnProperty("WordCompleter")&&"function"===typeof Oa.WordCompleter?Oa.WordCompleter:Oa.WordCompleter=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:"compute",
value:function(R,xa){var Va=[],eb=[],ac=R.document.lineStrings;R=R.cursorPosition.row;for(var Db=R-1;0<=Db;Db--)for(var xc=$jscomp.makeIterator(ac[Db].split(/[^0-9a-z@_]+/i)),Jc=xc.next();!Jc.done;Jc=xc.next())(Jc=Jc.value)&&!Va.includes(Jc)&&Jc!==xa&&(Va.push(Jc),eb.push({priority:1E3-(R-Db),completion:Jc}));for(Db=R+1;Db<ac.length;Db++)for(xc=$jscomp.makeIterator(ac[Db].split(/[^0-9a-z_@]+/i)),Jc=xc.next();!Jc.done;Jc=xc.next())(Jc=Jc.value)&&!Va.includes(Jc)&&Jc!==xa&&(Va.push(Jc),eb.push({priority:1E3-
(Db-R),completion:Jc}));return eb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Oa,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);Fc.WordCompleter=Mc;Fc.WordCompleter=Mc;Fc.WordCompleter=Mc;Mc=[new Fc.WordCompleter];Fc.defaultCompleters=
Mc;Fc.defaultCompleters=Mc;Fc.defaultCompleters=Mc;Mc=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),nb=Oa.hasOwnProperty("CompletionController")&&"function"===typeof Oa.CompletionController?Oa.CompletionController:Oa.CompletionController=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:Symbol.for("lively-instance-initialize"),value:function(R,xa){xa=void 0===
xa?[]:xa;this.textMorph=R;this.completers=xa=R.pluginCollect("getCompleters",xa)}},{key:"computeCompletions",value:function(R){var xa=this,Va,eb,ac,Db,xc,Jc,Bc,re,of,Ye,Bg,Bh,Cf,hg,wf,tj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pf){switch(Pf.nextAddress){case 1:Va=[],eb=$jscomp.makeIterator(xa.completers),ac=eb.next();case 2:if(ac.done){Pf.jumpTo(4);break}Db=ac.value;Pf.setCatchFinallyBlocks(5);xc=Va;Jc=xc.concat;return Pf.yield(Db.compute(xa.textMorph,R),7);case 7:Va=Jc.call(xc,
Pf.yieldResult);Pf.leaveTryBlock(3);break;case 5:Bc=Pf.enterCatchBlock(),console.warn("Error in completer "+Db+": "+(Bc.stack||Bc));case 3:ac=eb.next();Pf.jumpTo(2);break;case 4:re=new Map;Va.forEach(function(Qi){var Te=re.get(Qi.completion);Te||(Te=[],re.set(Qi.completion,Te));Te.push(Qi)});of=[];Ye=$jscomp.makeIterator(re.values());for(Bg=Ye.next();!Bg.done;Bg=Ye.next())Bh=Bg.value,of.push(Fc.arr.last(Fc.arr.sortByKey(Bh,"priority")));Cf=0;hg=Fc.arr.sortByKey(of,"priority").reverse();wf=hg.length&&
hg[0].priority||0;tj=hg.map(function(Qi){Qi.highestPriority=wf;var Te=Qi.completion.replace(/\n/g,""),cj=String((Qi.info||"").replace(/\n/g,""));Cf=Math.max(Cf,Te.length+cj.length);return{isListItem:!0,string:Te,annotation:cj,value:Qi}});return Pf.return({items:tj,maxCol:Cf})}})}},{key:"computeSortedCompletions",value:function(R,xa){xa=void 0===xa?!1:xa;var Va=this,eb,ac,Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){if(1==xc.nextAddress)return eb={tokens:[R],lowercasedTokens:[R],
input:R},xc.yield(Va.computeCompletions(R),2);ac=xc.yieldResult;Db=Fc.arr.sortBy(ac.items.filter(function(Jc){return Va.filterFunction(eb,Jc,xa)}),function(Jc){return Va.sortFunction(eb,Jc)});return xc.return(Db)})}},{key:"_printCompletions",value:function(R){var xa=this,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return eb.yield(xa.computeSortedCompletions(R),2);Va=eb.yieldResult.map(function(ac){return{completion:ac.value.completion,priority:ac.value.priority,
maxP:ac.value.highestPriority,sortVal:ac._cache[R].sortVal,lev:JSON.stringify(ac._cache[R].levenshtein)}});return eb.return(Fc.string.printTable(lively.lang.grid.tableFromObjects(Va)))})}},{key:"prefix",value:function(){var R=this.textMorph,xa=R.selection;return(xa.isEmpty()?R.getLine(xa.lead.row).slice(0,xa.lead.column):xa.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(R,xa,Va){Va=void 0===Va?!1:Va;xa._cache||(xa._cache={});var eb=R.tokens,ac=R.lowercasedTokens,Db=R.input;
Db=xa._cache[Db]||(xa._cache[Db]={});if(Db.hasOwnProperty("filtered"))return Db.filtered;xa=xa.value.completion.replace(/\([^\)]*\)$/,"");var xc=xa.toLowerCase();if(Va&&eb[0]&&!xa.startsWith(eb[0]))return Db.filtered=!1;if(ac.every(function(Bc){return xc.includes(Bc)}))return!0;var Jc=Db.levenshtein||(Db.levenshtein={});R=Va||3>=Fc.arr.sum(R.lowercasedTokens.map(function(Bc){return Jc[Bc]||(Jc[Bc]=Fc.string.levenshtein(xc,Bc))}));return Db.filtered=R}},{key:"sortFunction",value:function(R,xa){xa._cache||
(xa._cache={});var Va=xa._cache[R.input]||(xa._cache[R.input]={});if(Va.hasOwnProperty("sortVal"))return Va.sortVal;Va=xa._cache[R.input]={};var eb=xa.value;xa=eb.highestPriority;var ac=eb.completion;eb=eb.priority;ac=ac.replace(/\([^\)]*\)$/,"").toLowerCase();var Db=0;R.lowercasedTokens.forEach(function(Jc){ac.startsWith(Jc)?Db+=12:3<=Jc.length&&ac.includes(Jc)&&(Db+=5)});xa=-((eb||(Db?xa:0))/Math.pow(10,String(xa).length-2))-Db;var xc=Va.levenshtein||(Va.levenshtein={});R=Fc.arr.sum(R.lowercasedTokens.map(function(Jc){return xc[Jc]||
(xc[Jc]=Fc.string.levenshtein(ac,Jc))}));Db&&(R/=2);return Va.sortVal=R+xa}},{key:"positionForMenu",value:function(){var R=this.textMorph,xa=R.charBoundsFromTextPosition(R.cursorPosition);return R.getGlobalTransform().transformRectToRect(xa).topLeft().addXY(-R.scroll.x,-R.scroll.y).addPt(Fc.pt(R.borderWidth+4,R.borderWidth+4))}},{key:"completionListSpec",value:function(){var R=this,xa,Va,eb,ac,Db,xc,Jc,Bc,re,of,Ye,Bg,Bh,Cf,hg,wf,tj,Pf,Qi,Te;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cj){if(1==
cj.nextAddress)return Va=xa=R.textMorph,eb=Va.fontSize,ac=Va.fontFamily,Db=R.positionForMenu(),xc=R.prefix(),cj.yield(R.computeCompletions(xc),2);Jc=cj.yieldResult;Bc=Jc.items;re=Jc.maxCol;of=xa.env.fontMetric.sizeFor(ac,eb,"M");Ye=of.width*re;Bg=xa.document.getLine(0).height;Bh=Math.max(120,Ye<xa.width?Ye:xa.width);Cf=Bg*Bc.length+Bg+10;hg=Math.max(70,Math.min(700,Cf));wf=Db.extent(Fc.pt(Bh,hg));if(tj=xa.world())Pf=tj.visibleBounds().insetBy(5),wf.bottom()>Pf.bottom()&&(Qi=wf.bottom()-Pf.bottom(),
Qi>wf.height-50&&(Qi=wf.height-50),wf.height-=Qi),wf.right()>Pf.right()&&(Te=wf.right()-Pf.right(),wf.width=120>wf.width-Te?120:wf.width-Te),Pf.containsRect(wf)||(wf=wf.withTopLeft(Pf.translateForInclusion(wf).topLeft())),wf=wf.translatedBy(Pf.insetBy(0).topLeft().negated());return cj.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},hasFixedPosition:!0,epiMorph:!0,fontSize:eb,position:wf.topLeft(),extent:wf.extent(),items:Bc,input:xc,name:"text completion menu",historyId:"lively.morphic-text completion",
filterFunction:R.filterFunction,sortFunction:R.sortFunction})})}},{key:"removeMenuOnBlur",value:function(R){var xa=R.menu;setTimeout(function(){xa.withAllSubmorphsDetect(function(Va){return Va.isFocused()})?xa.inputMorph.focus():xa.remove()})}},{key:"openCompletionList",value:function(){var R=this,xa,Va,eb,ac,Db,xc,Jc,Bc,re,of;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ye){if(1==Ye.nextAddress)return xa=R.textMorph.selection.start,Ye.yield(R.completionListSpec(),2);if(3!=Ye.nextAddress)return Va=
Ye.yieldResult,R.textMorph.pluginFind(function(Bg){return Bg.theme}),eb=new Fc.FilterableList(Va),ac=new Fc.Range({start:xa,end:R.textMorph.selection.start}),Db=R.textMorph.textInRange(ac),xc=eb.inputMorph,Jc=eb.listMorph,Bc=Va.input,re=eb.addMorph({name:"prefix mask",fill:Fc.Color.transparent,bounds:xc.textBounds()},xc),Jc.master=null,ac.isEmpty()||(R.textMorph.deleteText(ac),xc.input=Db,xc.gotoDocumentEnd()),xc.fontColor=R.textMorph.fontColor,Fc.connect(xc,"textString",re,"setBounds",{converter:"() => input.textBounds()",
varMapping:{input:xc}}),Fc.connect(eb,"accepted",R,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Bc}}),Fc.connect(eb,"accepted",eb,"remove"),Fc.connect(eb,"canceled",eb,"remove"),Fc.connect(eb,"remove",R.textMorph,"focus"),Fc.connect(eb.inputMorph,"onBlur",R,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:eb}}),of=R.textMorph.world(),Jc.addStyleClass("hiddenScrollbar"),eb.paddingMorph.height=2,xc.height=Jc.itemHeight,xc.clipMode="visible",xc.fill=R.textMorph.fill,xc.fixedHeight=!0,xc.fixedWidth=!1,xc.fontSize=Jc.fontSize,eb.relayout(),eb.selectedIndex=
0,eb.master.applyIfNeeded(!0),xc.focus(),Ye.yield(eb.master.whenApplied(),3);Bc.length&&(xc.gotoDocumentEnd(),eb.moveBy(Fc.pt(-xc.textBounds().width,0)));of.addMorph(eb);eb.inputPadding=Fc.Rectangle.inset(0,0,0,0);return Ye.return(eb)})}},{key:"autoInsertBestMatchingCompletion",value:function(R,xa,Va){xa=void 0===xa?!0:xa;var eb=this,ac,Db,xc,Jc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bc){if(1==Bc.nextAddress)return ac=$jscomp,Db=ac.makeIterator,Bc.yield(eb.computeSortedCompletions(R,
xa),2);xc=Db.call(ac,Bc.yieldResult);(Jc=xc.next().value)&&eb.insertCompletion(Jc.value.completion,R,Va);Bc.jumpToEnd()})}},{key:"insertCompletion",value:function(R,xa,Va){var eb=this.textMorph,ac=eb.document,Db=eb.selection.isMultiSelection?eb.selection.selections:[eb.selection];eb.undoManager.group();Db.forEach(function(xc){xc.collapseToEnd();var Jc=xc.lead,Bc=xa?ac.indexToPosition(ac.positionToIndex(Jc)-xa.length):Jc;"function"===typeof Va?Va(R,xa,eb,{start:Bc,end:Jc},xc):eb.replace({start:Bc,
end:Jc},R)});eb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],Oa,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);Fc.CompletionController=Mc;Fc.CompletionController=Mc;Fc.CompletionController=Mc;
Mc=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(ya,Oa,nb){var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){return 1==xa.nextAddress?(R=new Fc.CompletionController(ya,Fc.defaultCompleters),xa.yield(R.openCompletionList(),2)):xa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(ya,Oa,nb){var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){return 1==xa.nextAddress?(R=
new Fc.CompletionController(ya,Fc.defaultCompleters),xa.yield(R.autoInsertBestMatchingCompletion(R.prefix()),2)):xa.return(!0)})}}];Fc.completionCommands=Mc;Fc.completionCommands=Mc;Fc.completionCommands=Mc;var xd=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");xd.chain=Le;xd.arr=Qb;xd.obj=ae;xd.string=dd;var Ve=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(ya){var Oa=ya.selection.start;0<Oa.row&&(Oa=ya.getPositionAboveOrBelow(1,Oa,
!0,0,ya.charBoundsFromTextPosition(Oa).x),ya.selection.addRange({start:Oa,end:Oa}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(ya){var Oa=ya.selection.start;Oa.row<ya.documentEndPosition.row&&(Oa=ya.getPositionAboveOrBelow(-1,Oa,!0,0,ya.charBoundsFromTextPosition(Oa).x),ya.selection.addRange({start:Oa,end:Oa}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(ya){var Oa=ya.selection.selections[ya.selection.selections.length-
1];if(Oa.isEmpty())return!0;ya.searchForAll(Oa.text,{start:{column:0,row:0}}).forEach(function(nb){return ya.selection.addRange(nb.range,!1)});ya.selection.mergeSelections();xd.arr.remove(ya.selection.selections,Oa);ya.selection.selections.push(Oa);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(ya){var Oa=ya.selection.selections.length-1,nb=ya.selection.selections[Oa];if(nb.isEmpty())return!0;var R=ya.search(nb.text,{start:nb.end,backwards:!1});R&&
(nb=ya.selection.selections.findIndex(function(xa){return xa.range.equals(R.range)}),-1<nb?xd.arr.swap(ya.selection.selections,nb,Oa):ya.selection.addRange(R.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(ya){var Oa=ya.selection.selections.length-1,nb=ya.selection.selections[Oa];if(nb.isEmpty())return!0;var R=nb.start,xa=ya.search(nb.text,{start:{row:R.row,column:R.column-(nb.text.length-1)},backwards:!0});xa&&(nb=ya.selection.selections.findIndex(function(Va){return Va.range.equals(xa.range)}),
-1<nb?xd.arr.swap(ya.selection.selections,nb,Oa):ya.selection.addRange(xa.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(ya){var Oa=ya.selection.selections.length;1<Oa&&ya.selection.removeSelections(Oa-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(ya){ya.selection.selections=lively.lang.arr.rotate(ya.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(ya){ya.selection.selections=lively.lang.arr.rotate(ya.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(ya){var Oa=ya.selection.selections;if(1>=Oa.length)return!0;var nb=xd.arr.groupBy(Oa,function(xa){return xa.range.start.row});Oa=nb.keys().map(function(xa){xa=nb[xa];var Va=xd.arr.max(xa,function(eb){return eb.range.start.column});xd.arr.without(xa,Va).forEach(function(eb){return eb.range=Va.range});
return Va});var R=xd.arr.max(Oa,function(xa){return xa.range.start.column}).range.start.column;Oa.forEach(function(xa){var Va=xa.range.start;xa=Va.row;Va=Va.column;ya.insertText(" ".repeat(R-Va),{row:xa,column:Va})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(ya){ya.selection.disableMultiSelect();if(ya.selection.isEmpty())var Oa=ya.lastSavedMark&&ya.lastSavedMark.position||(void 0).lineRange().start,nb=ya.cursorPosition;else Oa=ya.selection,
nb=Oa.lead,Oa=Oa.anchor;ya.selection.collapse();var R=Oa.column,xa=nb.column;xd.arr.range(Oa.row,nb.row).forEach(function(Va){return ya.getLine(Va).length>Math.min(xa,R)&&ya.selection.addRange({end:{row:Va,column:xa},start:{row:Va,column:R}},!1)});ya.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(ya,Oa,nb){nb=void 0===nb?1:nb;ya.undoManager.group();ya.selection.selections.forEach(function(R,xa){return R.text=String(xa+nb)});
ya.undoManager.group();return!0}}];xd.multiSelectCommands=Ve;xd.multiSelectCommands=Ve;xd.multiSelectCommands=Ve;var Kd=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");Kd.pToI=function(ya,Oa){return ya.positionToIndex(Oa)};Kd.iToP=function(ya,Oa){return ya.indexToPosition(Oa)};Kd.execCodeNavigator=function(ya){return function(Oa,nb,R){var xa=Oa.pluginInvokeFirst("getNavigator");if(!xa)return!0;Oa.saveMark();R=R||1;for(var Va=0;Va<R;Va++)xa[ya](Oa,nb);return!0}};Kd.once=
lc;var fe=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Kd.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:Kd.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Kd.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Kd.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Kd.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(ya,Oa){function nb(){var Va=ya.$expandRegionState,eb=Kd.pToI(ya,ya.cursorPosition);if(Va&&(Va.range[0]===eb||Va.range[1]===eb))return Va;Va=ya.selection.range;return ya.$expandRegionState={range:[Kd.pToI(ya,Va.start),
Kd.pToI(ya,Va.end)]}}Oa=Oa||{};var R=ya.pluginInvokeFirst("getNavigator");if(!R)return!0;var xa=Oa.start;Oa=Oa.end;if("number"===typeof xa&&"number"===typeof Oa)nb(),R={range:[xa,Oa],prev:nb()};else{xa=R.ensureAST(ya);if(!xa)return;R=R.expandRegion(ya,ya.textString,xa,nb())}R&&R.range&&(ya.selection={start:Kd.iToP(ya,R.range[0]),end:Kd.iToP(ya,R.range[1])},ya.$expandRegionState=R);Kd.once(ya,"selectionChange",function(){return ya.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(ya){if(ya.selection.isEmpty())return!0;var Oa=ya.pluginInvokeFirst("getNavigator");if(!Oa)return!0;var nb=Oa.ensureAST(ya);if(!nb)return!0;var R=ya.$expandRegionState;if(!R)return!0;(Oa=Oa.contractRegion(ya,ya.textString,nb,R))&&Oa.range&&(ya.selection={start:Kd.iToP(ya,Oa.range[0]),end:Kd.iToP(ya,Oa.range[1])},ya.$expandRegionState=Oa);Kd.once(ya,"selectionChange",
function(){return ya.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Kd.commands=fe;Kd.commands=fe;Kd.commands=fe;var ge=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");ge.arr=Qb;ge.chain=Le;ge.string=dd;var te=[{name:"toggle comment",exec:function(ya){var Oa=ya.pluginInvokeFirst("getComment");if(!Oa)return!0;if(!Oa.lineCommentStart)return Oa.blockCommentStart?ya.execCommand("toggle block comment"):!0;var nb=Oa.lineCommentStart,R=
new RegExp("^(\\s*)("+nb+"\\s?)(.*)");Oa=ya.document;var xa=ya.selection;xa.isEmpty()||0!==xa.end.column||xa.growRight(-1);var Va=xa.start.row;Oa=Oa.lineStrings.slice(xa.start.row,xa.end.row+1);Oa=Oa.some(function(Db){return!!Db.trim()})?ge.arr.dropWhile(Oa,function(Db){return Db.trim()?!1:++Va&&!0}):Oa;var eb=Oa.every(function(Db){return Db.trim()&&Db.match(R)});ya.undoManager.group();if(eb)Oa.forEach(function(Db,xc){if(Db=Db.match(R)){Db=$jscomp.makeIterator(Db);Db.next();var Jc=Db.next().value,
Bc=Db.next().value;Db.next();ya.deleteText({start:{row:Va+xc,column:Jc.length},end:{row:Va+xc,column:Jc.length+Bc.length}})}});else{var ac=Oa.reduce(function(Db,xc,Jc){return xc.trim()||xa.isEmpty()&&xa.start.row===xa.end.row?Math.min(Db,xc.match(/^\s*/)[0].length):Db},Infinity);ac=Infinity===ac?0:ac;Oa.forEach(function(Db,xc){Db=$jscomp.makeIterator(Db.match(/^(\s*)(.*)/));Db.next();Db.next();Db.next();ya.insertText(nb+" ",{row:Va+xc,column:ac})})}ya.undoManager.group();return!0}},{name:"toggle block comment",
exec:function(ya){var Oa=ya.pluginInvokeFirst("getComment");if(!Oa)return!0;if(!Oa.blockCommentStart)return Oa.lineCommentStart?ya.execCommand("toggle comment"):!0;if(!Oa||!Oa.blockCommentStart)return!0;var nb=Oa.blockCommentStart;Oa=Oa.blockCommentEnd;var R=new RegExp("^"+nb.replace(/\*/g,"\\*")),xa=new RegExp(Oa.replace(/\*/g,"\\*")+"$"),Va=ya.tokenAt(ya.cursorPosition);if(Va&&"comment"===Va.token){var eb=ya.textInRange(Va);if(eb.match(R)&&eb.match(xa))return ya.undoManager.group(),ya.replace(Va,
eb.slice(nb.length,-Oa.length)),ya.undoManager.group(),!0}ya.undoManager.group();ya.insertText(nb,ya.selection.start);ya.insertText(Oa,ya.selection.end);ya.undoManager.group();nb=!ya.selection.isEmpty();ya.selection.growLeft(Oa.length);nb||ya.selection.collapse();return!0}},{name:"comment box",exec:function(ya,Oa,nb){Oa=ya.undoManager.ensureNewGroup(ya,"comment box");if(ya.selection.isEmpty())return ya.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),ya.execCommand("toggle comment"),
ya.undoManager.group(Oa),!0;var R=ya.selection.range,xa=ya.withSelectedLinesDo(function(eb){return eb}),Va=ge.arr.min([R.start.column].concat(ge.chain(xa).map(function(eb){return eb.match(/^\s*/)}).flatten().compact().pluck("length").value()));xa=ge.arr.max(xa.map(function(eb){return eb.length}))-Va;xa=Array(Math.ceil(xa/2)+1).join("-=")+"-";ya.execCommand("toggle comment");ya.collapseSelection();ya.cursorPosition={row:R.start.row,column:0};nb?ya.insertText(ge.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",Va)):ya.insertText(ge.string.indent(xa+"\n"," ",Va));ya.selection.goUp();ya.execCommand("toggle comment");ya.cursorPosition={row:R.end.row+2,column:0};ya.insertText(ge.string.indent(xa+"\n"," ",Va));ya.selection.goUp();ya.execCommand("toggle comment");ya.selection.range={start:{row:R.start.row,column:0},end:ya.cursorPosition};ya.undoManager.group(Oa);return!0},multiSelectAction:"forEach",handlesCount:!0}];ge.commands=te;ge.commands=te;ge.commands=te;var Kc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
Kc.printSymbol=function(ya){if(Symbol.keyFor(ya))return'Symbol.for("'+Symbol.keyFor(ya)+'")';if(Kc.knownSymbols.get(ya))return Kc.knownSymbols.get(ya);String(ya).match(Kc.symMatcher);return String(ya)};Kc.defaultSort=function(ya,Oa){if(ya.hasOwnProperty("priority")||Oa.hasOwnProperty("priority")){var nb=ya.priority||0,R=Oa.priority||0;if(nb<R)return-1;if(nb>R)return 1}ya=(ya.keyString||ya.key).toLowerCase();Oa=(Oa.keyString||Oa.key).toLowerCase();return ya<Oa?-1:ya===Oa?0:1};Kc.safeToString=Yb;Kc.propertyNamesOf=
function(ya,Oa){if(!ya)return[];if(Array.isArray(ya)){var nb=Oa?Oa.offset:0;return Kc.arr.range(nb,nb+(Oa?Oa.partitionSize:ya.length-1))}return Kc.arr.sortBy(Object.keys(ya),function(R){return R.toLowerCase()})};Kc.isMultiValue=Ce;Kc.printValue=Wb;Kc.partitionedChildren=function(ya,Oa){var nb=void 0===Oa?{}:Oa;Oa=void 0===nb.originalValue?ya:nb.originalValue;var R=void 0===nb.offset?0:nb.offset;nb=void 0===nb.partitionSize?ya.length||Object.values(ya).length:nb.partitionSize;if(Kc.obj.isArray(ya)){ya=
Kc.num.roundTo(Math.max(Kc.MIN_PARTITION_SIZE,nb/50),.1);nb/=ya;for(var xa=[],Va=0;Va<nb;Va++){var eb="["+(R+Va*ya)+"-"+(R+(Va+1)*ya)+"]";xa.push({partition:{originalValue:Oa,offset:R+Va*ya,partitionSize:ya},value:[],key:eb,keyString:eb,valueString:"...",isCollapsed:!0})}return xa}ya=Kc.num.roundTo(Math.max(Kc.MIN_PARTITION_SIZE,nb/50),.1);nb/=ya;xa=[];Va=Kc.obj.keys(Oa).sort();for(eb=0;eb<nb;eb++){var ac=R+eb*ya,Db=R+(eb+1)*ya,xc=Kc.obj.select(Oa,Va.slice(ac,Db));ac="["+Va[ac].slice(0,4)+"-"+(Va[Db]||
Kc.arr.last(Va)).slice(0,4)+"]";xa.push({partition:{originalValue:xc,offset:R+eb*ya,partitionSize:ya},value:[],key:ac,keyString:ac,valueString:"...",isCollapsed:!0})}return xa};Kc.propertiesOf=function(ya){var Oa=ya.partition?ya.target:ya.value;if(!Oa)return[];var nb={_rev:!0},R=[],xa="function"===typeof Oa.livelyCustomInspect?Oa.livelyCustomInspect():{},Va=Object.assign({},Kc.defaultPropertyOptions,{},xa);if(xa.properties){xa=$jscomp.makeIterator(xa.properties);for(var eb=xa.next();!eb.done;eb=xa.next()){var ac=
eb.value;eb=ac.key;var Db=ac.hidden,xc=ac.priority,Jc=ac.keyString,Bc=ac.value;ac=ac.valueString;nb[eb]=!0;Db||R.push(ya.getSubNode({priority:xc,key:eb,keyString:Jc||Kc.safeToString(eb),value:Bc,valueString:ac,isCollapsed:!0}))}}if(Va.includeDefault){xa=Kc.propertyNamesOf(Oa,ya.partition);if(xa.length>Kc.MAX_NODE_THRESHOLD)for(nb=$jscomp.makeIterator(Kc.partitionedChildren(Oa,ya.partition)),xa=nb.next();!xa.done;xa=nb.next())R.push(ya.getSubNode(xa.value));else for(Db=$jscomp.makeIterator(xa),xa=
Db.next();!xa.done;xa=Db.next())xc=xa.value,xc in nb||(xa=Oa[xc],eb=Kc.printValue(xa),xa={keyString:xc,key:xc,value:xa,valueString:eb,isCollapsed:!0},R.push(ya.getSubNode(xa)));if(Va.includeSymbols)for(nb=$jscomp.makeIterator(Object.getOwnPropertySymbols(Oa)),xa=nb.next();!xa.done;xa=nb.next())Db=xa.value,xc=Kc.safeToString(Db),xa=Oa[Db],eb=Kc.printValue(xa),xa={key:Db,keyString:xc,value:xa,valueString:eb,isCollapsed:!0},R.push(ya.getSubNode(xa))}Va.sort&&(R=Va.sortFunction(Oa,R));return R};Kc.obj=
ae;Kc.num=Wc;Kc.arr=Qb;Kc.string=dd;Kc.connect=Ac;Kc.signal=Ed;Kc.TreeData=Tb;Kc.newUUID=Bd;Kc.localInterface=ra;Kc.MAX_NODE_THRESHOLD=1E3;Kc.MIN_PARTITION_SIZE=250;Kc.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(ya,Oa){return Array.isArray(ya)?Oa:Oa.sort(Kc.defaultSort)}};Kc.symMatcher=/^Symbol\((.*)\)$/;Kc.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(ya){return"symbol"===typeof Symbol[ya]}).reduce(function(ya,Oa){return ya.set(Symbol[Oa],
"Symbol."+Oa)},new Map)}();Kc.isMultiValue=Ce;Kc.isMultiValue=Ce;Kc.printValue=Wb;Kc.printValue=Wb;var ef=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),nb=Oa.hasOwnProperty("InspectionTree")&&"function"===typeof Oa.InspectionTree?Oa.InspectionTree:Oa.InspectionTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:Symbol.for("lively-instance-initialize"),
value:function(R){ib._get(Object.getPrototypeOf(nb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);this.inspector=R.inspector;this.root.isInspectionNode||(this.root=Kc.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(R){R=void 0===R?!0:R;return ib._get(Object.getPrototypeOf(nb.prototype),"asListWithIndexAndDepth",this).call(this,function(xa){xa=xa.node;return R?xa.visible:!0})}},{key:"getContextFor",
value:function(R){return R==this.root?this.root.value.inspectee:R.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(R){var xa=void 0===R.maxDepth?1:R.maxDepth,Va=R.iterator,eb=R.showUnknown,ac=R.showInternal,Db=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){if(1==xc.nextAddress)return xc.yield(Db.uncollapseAll(function(Jc,Bc){return xa>Bc&&(Jc==Db.root||Jc.value.submorphs)}),2);Db.asListWithIndexAndDepth(!1).forEach(function(Jc){var Bc=Jc.node;return 0==
Jc.depth?Bc.visible=!0:!eb&&Bc.keyString&&Bc.keyString.includes("UNKNOWN PROPERTY")||!ac&&Bc.keyString&&Bc.keyString.includes("internal")?Bc.visible=!1:Bc.value&&Bc.value.submorphs?Bc.visible=!0:Bc.visible=Va(Bc)});xc.jumpToEnd()})}},{key:"getChildren",value:function(R){return R.children}},{key:"display",value:function(R){return R.display(this.inspector)}},{key:"isCollapsed",value:function(R){return R.isCollapsed}},{key:"isLeaf",value:function(R){return Kc.obj.isPrimitive(R.value)}},{key:"collapse",
value:function(R,xa){var Va=this;R.isCollapsed=xa;xa||this.isLeaf(R)||R.children.length||(R.children=Kc.propertiesOf(R).map(function(eb){Va.parentMap.set(eb,R);return eb}))}},{key:"retrieveForRemoteProxy",value:function(R){R.uuid||(R.uuid=Kc.newUUID(),this.idToNodeMap[R.uuid]=R);return{uuid:R.uuid,value:this.isLeaf(R)?R.value:{},keyString:R.keyString,key:R.keyString,valueString:Kc.safeToString(R.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Kc.localInterface}},
{key:"getNodeViaId",value:function(R){return this.idToNodeMap[R]}},{key:"asRemoteDelegate",value:function(R){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[R]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionTree"}},{key:"forObject",value:function(R,xa){return new this({key:"inspectee",
value:{inspectee:R},isCollapsed:!0,inspector:xa})}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(Kc.TreeData);Kc.InspectionTree=ef;Kc.InspectionTree=ef;Kc.InspectionTree=ef;var Ue=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
nb=Oa.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Oa.RemoteInspectionTree?Oa.RemoteInspectionTree:Oa.RemoteInspectionTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(R){this.parentMap=new WeakMap;this.root=R.proxy;this.evalEnvironment=R.evalEnvironment;
this.inspector=R.inspector;this.delegateId=R.delegateId}},{key:"getContextFor",value:function(R){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+R.uuid+'").value'}},{key:"dispose",value:function(){var R=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){return xa.yield(R.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+R.delegateId+"']\n    ",R.evalEnvironment),0)})}},{key:"display",
value:function(R){return R.keyString+": "+R.valueString}},{key:"collapse",value:function(R,xa){var Va=this,eb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ac){if(1==ac.nextAddress)return(R.isCollapsed=xa)||Va.isLeaf(R)?ac.return():R.children.length?ac.jumpTo(0):ac.yield(Va.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+R.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Va.delegateId+'"]'}),3);eb=ac.yieldResult;R.children=eb.isError?[]:eb.value;ac.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(R,xa){var Va=this,eb,ac,Db,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jc){if(1==Jc.nextAddress)return Jc.yield(Va.createRemoteContext(R,xa),2);eb=Jc.yieldResult;
ac=eb.proxy;Db=eb.delegateId;xc=eb.evalEnvironment;return Jc.return(new Va({key:"inspectee",proxy:ac,delegateId:Db,evalEnvironment:xc,inspector:xa}))})}},{key:"createRemoteContext",value:function(R,xa){var Va=R.code,eb=R.evalEnvironment,ac=R.delegateId,Db,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jc){if(1==Jc.nextAddress)return ac="lively://inspector-"+xa.id,Jc.yield(eb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Va+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+ac+'");\n    ',eb),2);Db=Jc.yieldResult;xc=Db.value;return Jc.return({delegateId:ac,evalEnvironment:eb,proxy:xc})})}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(Kc.InspectionTree);
Kc.RemoteInspectionTree=Ue;Kc.RemoteInspectionTree=Ue;Kc.RemoteInspectionTree=Ue;(function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),nb=Oa.hasOwnProperty("InspectionNode")&&"function"===typeof Oa.InspectionNode?Oa.InspectionNode:Oa.InspectionNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:Symbol.for("lively-instance-initialize"),value:function(R){var xa=
R.root,Va=R.priority,eb=R.key,ac=R.keyString,Db=R.value,xc=R.valueString,Jc=R.isCollapsed,Bc=void 0===R.children?[]:R.children,re=void 0===R.isSelected?!1:R.isSelected,of=void 0===R.visible?!0:R.visible;this.partition=R.partition;this.priority=Va;this.key=eb;this.keyString=String(ac||eb);this.value=Db;this.valueString=xc||Kc.printValue(Db);this.isCollapsed=Jc;this.children=Bc;this.isSelected=re;this.visible=of;this.root=xa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(R){if(R.value&&R.value.isMorph)return new Kc.MorphNode(Object.assign({root:this.root},R));var xa=R.key,Va=R.keyString,eb=this.value,ac=R.partition;ac&&(eb=ac.originalValue,Va=xa);return new Kc.PropertyNode(Object.assign({},R,{keyString:Va,key:xa,target:eb,partition:ac,root:this.root,spec:{}}))}},{key:"display",value:function(R){var xa=this.keyString,Va=this.valueString;if(!this.interactive)return xa+": "+Va;this._propertyWidget||(this._propertyWidget=
R.renderDraggableTreeLabel({value:xa+": "+Va}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(R,xa){xa=void 0===xa?null:xa;return R.value&&R.value.isMorph?new Kc.MorphNode(Object.assign({root:xa},R)):new Kc.InspectionNode(Object.assign({root:xa},R))}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),nb=Oa.hasOwnProperty("MorphNode")&&"function"===typeof Oa.MorphNode?Oa.MorphNode:Oa.MorphNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:Symbol.for("lively-instance-initialize"),
value:function(R){ib._get(Object.getPrototypeOf(nb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(R){var xa=this.propertyInfo[R.key]||{};return R.value&&R.value.isMorph?new Kc.MorphNode(Object.assign({},R,{root:this.root})):new Kc.PropertyNode(Object.assign({},R,{root:this.root,target:this.target,spec:xa}))}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"MorphNode"}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(Kc.InspectionNode);(function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),nb=Oa.hasOwnProperty("PropertyNode")&&"function"===typeof Oa.PropertyNode?
Oa.PropertyNode:Oa.PropertyNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:Symbol.for("lively-instance-initialize"),value:function(R){ib._get(Object.getPrototypeOf(nb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);var xa=R.spec,Va=R.target;this.partition=R.partition;this.target=Va;this.spec=xa;this.foldedNodes={}}},{key:"__deserialize__",value:function(R,xa){this.spec=
{}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(R){this._interactive=R}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(R){return this.isFoldable?this.getFoldedContext(R):ib._get(Object.getPrototypeOf(nb.prototype),"getSubNode",this).call(this,R)}},{key:"getFoldedContext",value:function(R){return this.foldedNodes[R.key]=
new Kc.FoldedNode(Object.assign({},R,{root:this.root,target:this.target,foldableNode:this,spec:Kc.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(R,xa){(xa=void 0===xa?!1:xa)&&(this.target[this.key]=R);this.value=this.target[this.key];this.valueString=Kc.printValue(this.value);this.interactive&&(xa||this._propertyWidget.highlight());if(this.isFoldable)for(var Va in this.foldedNodes)this.foldedNodes[Va].value=
this.value[Va],this.foldedNodes[Va].valueString=Kc.printValue(this.value[Va]),this.foldedNodes[Va]._propertyWidget&&Kc.signal(this.foldedNodes[Va]._propertyWidget,"update",this.value[Va])}},{key:"display",value:function(R){var xa=this,Va=this._propertyWidget,eb=this.keyString,ac=this.valueString,Db=this.target,xc=this.value,Jc=this.spec;if(!(this.interactive||Jc.foldable&&Kc.isMultiValue(xc,Jc.foldable)))return R.renderPropertyControl({target:Db,keyString:eb,valueString:ac,tree:R.ui.propertyTree,
value:xc,spec:Jc,node:this,fastRender:!0});if(Va)return Va.keyString=eb,Va.valueString=ac,Va.isSelected=this.isSelected,Va.control&&(Va.control.isSelected=this.isSelected),Va;Va=this._propertyWidget=R.renderPropertyControl({target:Db,keyString:eb,valueString:ac,value:xc,spec:Jc,node:this,isSelected:this.isSelected,fontColor:R.ui.propertyTree.fontColor});this.isInternalProperty||Jc.readOnly||(Kc.connect(Va,"propertyValue",this,"refreshProperty",{updater:function(Bc,re){return Bc(re,!0)}}),Kc.connect(Va,
"openWidget",this.root,"onWidgetOpened",{converter:function(Bc){return{widget:Bc,node:xa.sourceObj}}}));return Va}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(Kc.InspectionNode);
(function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),nb=Oa.hasOwnProperty("FoldedNode")&&"function"===typeof Oa.FoldedNode?Oa.FoldedNode:Oa.FoldedNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:Symbol.for("lively-instance-initialize"),value:function(R){ib._get(Object.getPrototypeOf(nb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
R);this.foldableNode=R=R.foldableNode;this.foldedProp=R.key+Kc.string.capitalize(this.key)}},{key:"refreshProperty",value:function(R,xa){xa=void 0===xa?!1:xa;var Va={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Va[this.key]=R,Va)),xa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Oa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(Kc.PropertyNode);var Se=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Se.Color=bb;var vf=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),nb=Oa.hasOwnProperty("DarkTheme")&&"function"===typeof Oa.DarkTheme?Oa.DarkTheme:Oa.DarkTheme=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return ib(nb,ya,[{key:"background",get:function(){return Se.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Se.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Se.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Se.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Se.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Se.Color.white,fontWeight:"bold",backgroundColor:Se.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Se.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Se.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],Oa,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),Df=vf=Se.DarkTheme;Se.default=vf;var $b=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");$b.inspect=cb;$b.remoteInspect=Xb;$b.generateReferenceExpression=H;$b.onNumberDragStart=
function(ya,Oa){Oa.initPos=ya.position;Oa.factorLabel=(new $b.Tooltip({description:"1x"})).openInWorld(ya.hand.position.addXY(10,10))};$b.onNumberDrag=function(ya,Oa){var nb=$b.getScaleAndOffset(ya,Oa),R=nb.scale;nb=nb.offset;Oa.factorLabel.position=ya.hand.position.addXY(10,10);Oa.factorLabel.description=R+"x";return $b.getCurrentValue(nb,R,Oa)};$b.onNumberDragEnd=function(ya,Oa){var nb=$b.getScaleAndOffset(ya,Oa);ya=nb.offset;nb=nb.scale;Oa.factorLabel.softRemove();return $b.getCurrentValue(ya,
nb,Oa)};$b.getScaleAndOffset=function(ya,Oa){var nb=ya.position.subPt(Oa.initPos);ya=nb.x;Oa=$b.num.roundTo(Math.exp(-nb.y/$world.height*6),.01)*Oa.baseFactor;return{offset:ya,scale:Oa}};$b.getCurrentValue=function(ya,Oa,nb){return Math.max(nb.min,Math.min(nb.max,nb.scrubbedValue+(nb.floatingPoint?ya*Oa:Math.round(ya*Oa))))};$b.Color=bb;$b.Rectangle=Ib;$b.rect=Sd;$b.pt=ed;$b.obj=ae;$b.num=Wc;$b.Path=hc;$b.arr=Qb;$b.promise=mc;$b.connect=Ac;$b.disconnect=Hb;$b.once=lc;$b.Morph=ec;$b.Tooltip=vc;$b.VerticalLayout=
gd;$b.GridLayout=Zc;$b.HorizontalLayout=Za;$b.morph=qc;$b.CustomLayout=Xa;$b.Label=jb;$b.Icon=Fa;$b.StyleSheet=uc;$b.config=Ea;$b.Tree=ka;$b.LoadingIndicator=ja;$b.DropDownList=Ca;$b.DropDownSelector=mb;$b.SearchField=Ub;$b.LabeledCheckBox=Ya;$b.MorphHighlighter=U;$b.InteractiveMorphSelector=Ba;$b.printValue=Wb;$b.RemoteInspectionTree=Ue;$b.InspectionTree=ef;$b.isMultiValue=Ce;$b.valueWidgets=K;$b.popovers=V;$b.DarkTheme=Df;$b.DefaultTheme=Sb;$b.syncEval=$a;$b.inspectorCommands=[{name:"focus codeEditor",
exec:function(ya){ya.get("codeEditor").show();ya.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(ya){ya.get("propertyTree").show();ya.get("propertyTree").focus();return!0}}];(function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),nb=Oa.hasOwnProperty("DraggedProp")&&"function"===typeof Oa.DraggedProp?Oa.DraggedProp:Oa.DraggedProp=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return ib(nb,ya,[{key:"applyToTarget",value:function(R){var xa=this.currentTarget,Va=this.control;this.remove();$b.MorphHighlighter.removeHighlighters(R.world);if(xa)if(xa.isText&&"js"===xa.editorModeName){var eb=xa.evalEnvironment.context;R=xa.textPositionFromPoint(xa.localize(R.position));eb=$b.generateReferenceExpression(this.sourceObject,{fromMorph:eb});Va.keyString&&(eb+="."+Va.keyString);xa.insertTextAndSelect(eb,R);xa.focus()}else"propertyValue"in Va&&(xa[Va.keyString]=Va.propertyValue)}},
{key:"update",value:function(R){R=R.hand.globalPosition;var xa=this.morphBeneath(R);if(xa){for(xa==this.morphHighlighter&&(xa=xa.morphBeneath(R));[xa].concat($jscomp.arrayFromIterable(xa.ownerChain())).find(function(Va){return!Va.visible});)xa=xa.morphBeneath(R);if(xa!=this.currentTarget){this.currentTarget=xa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(xa.isWorld)return;this.morphHighlighter=$b.MorphHighlighter.for($world,xa);this.morphHighlighter.show()}this.position=R}}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:$b.Color.rgb(169,204,227)},fill:{defaultValue:$b.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var R=this.control;if(!R)return this.submorphs=[];this.height=22;this.submorphs=[R];R.top=0;R.fontSize=14;"function"===typeof R.relayout&&R.relayout();this.width=R.width+20;this.adjustOrigin($b.pt(10,
10))}}}}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3714})})($b.Morph);(function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),nb=Oa.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Oa.DraggableTreeLabel?Oa.DraggableTreeLabel:Oa.DraggableTreeLabel=
function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(R){this.draggedProp=new $b.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();$b.connect(R.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(R){}},{key:"onDragEnd",value:function(R){$b.disconnect(R.hand,
"update",this.draggedProp,"update");this.draggedProp.applyToTarget(R)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:$b.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:$b.Color.transparent},padding:{defaultValue:$b.rect(0,1,10,-1)},isSelected:{after:["submorphs"],
set:function(R){this.setProperty("isSelected",R);R?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=R)}}}}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3716,
end:5055})})($b.Label);ef=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),nb=Oa.hasOwnProperty("PropertyControl")&&"function"===typeof Oa.PropertyControl?Oa.PropertyControl:Oa.PropertyControl=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(R,xa,Va){R.control=
new $b.DropDownSelector({opacity:.8,fill:$b.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:xa,padding:0,values:Va});$b.connect(R.control,"update",R,"propertyValue",{updater:function(eb,ac){this.targetObj.propertyValue!=ac&&eb(ac)}});$b.connect(R,"update",R.control,"selectedValue",{updater:function(eb,ac){ac=ac&&ac.valueOf?ac.valueOf():ac;this.targetObj.propertyValue!=ac&&eb(ac)}});return R}},{key:"toggleMultiValuePlaceholder",value:function(R){this.multiValuePlaceholder=
this.multiValuePlaceholder||this.addMorph({fill:$b.Color.transparent,layout:new $b.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:$b.arr.range(0,2).map(function(xa){return{type:"ellipse",fill:$b.Color.gray.withA(.5),reactsToPointer:!1,extent:$b.pt(7,7)}})});R?($b.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=
!0):($b.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(R){this.foldableProperties&&this.toggleMultiValuePlaceholder($b.isMultiValue(R,this.foldableProperties))}},{key:"asFoldable",value:function(R){this.foldableProperties=R;$b.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,
1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var R=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});R.isLayoutable=!1;R.fontWeight="bold";R.fontColor=$b.Color.orange;R.reactsToPointer=
!1;R.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(R){this.submorphs=[R]}},layout:{initialize:function(){this.layout=new $b.CustomLayout({relayout:function(R){R.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},
{key:"inferType",value:function(R){return(R=R.value)&&(R.isColor||R.isGradient)?"Color":R&&R.isPoint?"Point":$b.obj.isBoolean(R)?"Boolean":$b.obj.isNumber(R)?"Number":$b.obj.isString(R)?"String":R&&R.isRectangle?"Rectangle":!1}},{key:"render",value:function(R){R.spec.type||(R.spec=Object.assign({},R.spec,{isFloat:!Number.isInteger(R.value),type:this.inferType(R)}));switch(R.spec.type){case "Color":var xa=this.renderColorControl(R);break;case "ColorGradient":xa=this.renderColorControl(Object.assign({},
R,{gradientEnabled:!0}));break;case "Number":xa=this.renderNumberControl(R);break;case "String":xa=this.renderStringControl(R);break;case "RichText":xa=this.renderStringControl(R);break;case "Layout":xa=this.renderLayoutControl(R);break;case "Enum":xa=this.renderEnumControl(R);break;case "Shadow":xa=this.renderShadowControl(R);break;case "Point":xa=this.renderPointControl(R);break;case "Rectangle":xa=this.renderRectangleControl(R);break;case "Boolean":xa=this.renderBooleanControl(R);break;default:xa=
this.renderItSomehow(R)}xa.control&&($b.connect(xa.control,"openWidget",xa,"openWidget"),xa.toggleFoldableValue(R.value));return xa}},{key:"baseControl",value:function(R){var xa=R.spec;R=new this({keyString:R.keyString,valueString:R.valueString,isSelected:!1,propertyValue:R.value});xa.foldable&&R.asFoldable(xa.foldable);return R}},{key:"renderGrabbableKey",value:function(R){var xa=this,Va=R.target;return[R.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(eb){eb.state.draggedProp=new $b.DraggedProp({sourceObject:Va,
control:xa.baseControl(R)});eb.state.draggedProp.openInWorld();$b.connect(eb.hand,"update",eb.state.draggedProp,"update")},onDrag:function(eb){},onDragEnd:function(eb){$b.disconnect(eb.hand,"update",eb.state.draggedProp,"update");eb.state.draggedProp.applyToTarget(eb)}}]}},{key:"renderEnumControl",value:function(R){var xa=R.value,Va=R.spec.values,eb=R.keyString,ac=R.target,Db=R.node,xc=function(Jc,Bc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(re){ac.world().openWorldMenu(Jc,Va.map(function(of){return{string:of.toString(),
action:function(){ac[eb]=of;Db.rerender()}}}));re.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(xa?xa.valueOf?xa.valueOf():xa:"Not set"),{nativeCursor:"pointer",onMouseDown:xc}],$jscomp.arrayFromIterable($b.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:xc})))}},{key:"renderStringControl",value:function(R){var xa=R.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(200<xa.length?
xa.slice(0,20)+"...":xa),{fontColor:$b.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(R){var xa=R.value,Va=R.keyString,eb=R.valueString,ac=R.target,Db=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+eb,{fontColor:$b.Color.black,nativeCursor:"pointer",onMouseDown:function(xc){var Jc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bc){if(1==Bc.nextAddress)return Jc=new $b.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:xa}),
Jc.relayout(),Bc.yield(Jc.fadeIntoWorld(xc.positionIn(ac.world())),2);$b.connect(Jc,"rectangle",function(re){ac[Va]=re;Db.rerender()});Bc.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(R){var xa=R.value,Va=R.keyString,eb=R.valueString,ac=R.target,Db=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+eb,{nativeCursor:"pointer",fontColor:xa?$b.Color.green:$b.Color.red,onMouseDown:function(xc){ac[Va]=!ac[Va];Db.rerender()}}])}},{key:"renderNumberControl",
value:function(R){var xa=R.value,Va=R.spec,eb=R.keyString,ac=R.valueString,Db=R.node,xc=R.target,Jc=R.tree,Bc=void 0===Db._numberControls?new Og:Db._numberControls,re=$jscomp.makeIterator(Bc.submorphs),of=re.next().value,Ye=re.next().value;Bc.fontColor=Jc.fontColor;var Bg=Db._numberControls=Bc;"max"in Va&&"min"in Va&&-Infinity!=Va.min&&Infinity!=Va.max?(Bg.baseFactor=(Va.max-Va.min)/100,Bg.floatingPoint=Va.isFloat,Bg.max=Va.max,Bg.min=Va.min):(Bg.floatingPoint=Va.isFloat,Bg.baseFactor=.5,Bg.min=void 0!=
Va.min?Va.min:-Infinity,Bg.max=void 0!=Va.max?Va.max:Infinity);var Bh=$b.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),$jscomp.arrayFromIterable(Db._inputMorph?[Db._inputMorph,{}]:[" "+(void 0!=xa&&(xa.valueOf?xa.valueOf():xa).toFixed(Va.isFloat?Math.max(4,$b.num.precision(xa)):0))+" ",{fontColor:Bh,onMouseUp:function(Cf){Db._inputMorph=$b.morph({type:"input",fill:null,fontColor:Bh,fontFamily:"IBM Plex Mono",fontSize:14,
padding:$b.rect(8,2,-6,2),height:23,cursorColor:$b.Color.white,value:xa.valueOf?xa.valueOf():ac});xc[eb]=xa;Db._inputMorph.focus();$b.once(Db._inputMorph,"inputAccepted",function(hg){delete Db._inputMorph;xc[eb]=Va.isFloat?Number.parseFloat(hg):Number.parseInt(hg);Db.rerender()});$b.once(Db._inputMorph,"onBlur",function(hg){Db._inputMorph&&(delete Db._inputMorph,xc[eb]=xa,Db.rerender())});Db.rerender()},onDragStart:function(Cf){Bg.scrubbedValue=xa;$b.onNumberDragStart(Cf,Bg)},onDrag:function(Cf){xc[eb]=
$b.onNumberDrag(Cf,Bg);Db.rerender()},onDragEnd:function(Cf){return $b.onNumberDragEnd(Cf,Bg)}},Bc,{onMouseUp:function(){of.fill=Ye.fill=null},onMouseDown:function(Cf){if(Cf.targetMorph===of){of.fill=$b.Color.white.withA(.2);if("max"in Va&&xc[eb]>=Va.max)return;xc[eb]+=1}if(Cf.targetMorph===Ye){Ye.fill=$b.Color.white.withA(.2);if("min"in Va&&xc[eb]<=Va.min)return;--xc[eb]}Db.rerender()}}]))}},{key:"renderShadowControl",value:function(R){var xa=R.keyString,Va=R.value,eb=R.target,ac=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),
[""+(Va?Va.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(Db){var xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jc){if(1==Jc.nextAddress)return xc=new $b.popovers.ShadowPopover({shadowValue:eb[xa],hasFixedPosition:!0}),Jc.yield(xc.fadeIntoWorld(Db.positionIn(eb.world())),2);$b.connect(xc,"shadowValue",function(Bc){eb[xa]=Bc;ac.rerender()});Jc.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(R){var xa=R.keyString,Va=R.value,eb=R.target,ac=R.node,
Db=$b.valueWidgets.NumberWidget.properties.fontColor.defaultValue,xc={nativeCursor:"pointer",onMouseDown:function(Jc){var Bc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(re){if(1==re.nextAddress)return Bc=new $b.popovers.PointPopover({pointValue:eb[xa],hasFixedPosition:!0}),re.yield(Bc.fadeIntoWorld(Jc.positionIn(eb.world())),2);$b.connect(Bc,"pointValue",function(of){eb[xa]=of;ac.rerender()});re.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),
[" pt(",Object.assign({},xc),""+Va.x.toFixed(),Object.assign({fontColor:Db},xc),",",Object.assign({},xc),""+Va.y.toFixed(),Object.assign({fontColor:Db},xc),")",Object.assign({},xc)])}},{key:"renderLayoutControl",value:function(R){var xa=R.valueString,Va=R.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(Va?xa:"No Layout"),{onMouseDown:function(eb){}}])}},{key:"renderColorControl",value:function(R){var xa=R.node,Va=R.gradientEnabled,eb=R.valueString,ac=R.keyString,
Db=R.value,xc=R.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[$b.morph({fill:Db.valueOf?Db.valueOf():Db,extent:$b.pt(15,15),borderColor:$b.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(Db?Db.valueOf?Db.valueOf():eb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Jc){var Bc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(re){if(1==re.nextAddress)return Bc=new $b.popovers.FillPopover({hasFixedPosition:!0,handleMorph:xc,
fillValue:Db,title:"Fill Control",gradientEnabled:Va}),re.yield(Bc.fadeIntoWorld(Jc.positionIn(xc.world())),2);$b.connect(Bc,"fillValue",function(of){xc[ac]=of;xa.rerender()});re.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(R){var xa=R.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+xa,{}])}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5064,end:20451})}($b.DraggableTreeLabel);$b.PropertyControl=ef;$b.PropertyControl=ef;$b.PropertyControl=ef;$b.inspect=cb;$b.inspect=cb;$b.remoteInspect=Xb;$b.remoteInspect=Xb;$b.generateReferenceExpression=H;$b.generateReferenceExpression=H;var Og=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),nb=Oa.hasOwnProperty("NumberControls")&&"function"===typeof Oa.NumberControls?Oa.NumberControls:Oa.NumberControls=
function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new $b.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:$b.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(R){this.submorphs.map(function(xa){return xa.fontColor=
R})}},submorphs:{initialize:function(){this.submorphs=[$b.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:$b.rect(5,2,0,-6),fontSize:12}),$b.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:$b.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23124,end:24169})}($b.Morph);(function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),nb=Oa.hasOwnProperty("PropertyTree")&&"function"===typeof Oa.PropertyTree?Oa.PropertyTree:Oa.PropertyTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:"onDrag",value:function(R){this._onDragHandler&&this._onDragHandler(R)}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25334,end:25445})})($b.Tree);ef=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),nb=Oa.hasOwnProperty("Inspector")&&"function"===
typeof Oa.Inspector?Oa.Inspector:Oa.Inspector=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(R){}},{key:"__after_deserialize__",value:function(R,xa,Va){var eb=this,ac=new $b.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,
{treeData:$b.InspectionTree.forObject(null,this)}));this.addMorph(ac,this.getSubmorphNamed("terminal toggler"));ib._get(Object.getPrototypeOf(nb.prototype),"__after_deserialize__",this).call(this,R,xa,Va);!this.isComponent&&this.master.whenApplied().then(function(){eb.layout.col(0).row(1).group.morph=ac;eb.targetObject&&(eb.targetObject=eb.targetObject)})}},{key:"__additionally_serialize__",value:function(R,xa,Va,eb){R=R.props.submorphs.value;for(xa=R.length;xa--;)Va.refForId(R[xa].id).realObj==this.ui.propertyTree&&
$b.arr.removeAt(R,xa)}},{key:"renderDraggableTreeLabel",value:function(R){return new $b.DraggableTreeLabel(R)}},{key:"renderPropertyControl",value:function(R){return $b.PropertyControl.render(R)}},{key:"onLoad",value:function(){var R=this.ui,xa=R.codeEditor,Va=R.thisBindingSelector,eb=R.propertyTree;xa.changeEditorMode("js").then(function(){return xa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Va.selection?xa.owner.selectedContext:xa.owner.targetObject},
get systemInterface(){return $b.Path("treeData.systemInterface").get(eb)},format:"esm"}}).catch(function(ac){return $world.logError(ac)})}},{key:Symbol.for("lively-instance-initialize"),value:function(R){ib._get(Object.getPrototypeOf(nb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);R=this.ui;var xa=R.targetPicker,Va=R.propertyTree,eb=R.resizer,ac=R.terminalToggler,Db=R.unknowns,xc=R.internals,Jc=R.searchField,Bc=R.codeEditor,re=R.fixImportButton,of=R.thisBindingSelector;Bc.changeEditorMode("js").then(function(){return Bc.evalEnvironment=
{targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==of.selection?Bc.owner.selectedContext:Bc.owner.targetObject},get systemInterface(){return Va.treeData.systemInterface},format:"esm"}}).catch(function(Ye){return $world.logError(Ye)});$b.connect(xa,"onMouseDown",this,"selectTarget");$b.connect(Va,"onScroll",this,"repositionOpenWidget");$b.connect(eb,"onDrag",this,"adjustProportions");$b.connect(ac,"onMouseDown",this,"toggleCodeEditor");$b.connect(Db,"trigger",this,"filterProperties");
$b.connect(xc,"trigger",this,"filterProperties");$b.connect(Jc,"searchInput",this,"filterProperties");$b.connect(Va,"nodeCollapseChanged",this,"filterProperties");$b.connect(this,"extent",this,"relayout");$b.connect(of,"selection",this,"bindCodeEditorThis");$b.connect(re,"fire",Bc,"execCommand",{updater:function(Ye){return Ye("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var R=this.ui.propertyTree.selectedIndex-1,xa=this.ui.propertyTree.selectedNode;
this.ui.propertyTree.selectedNode.refreshProperty();xa=this.ui.propertyTree.document.getLine(R).textAndAttributes.slice(0,4).concat(xa.display(this));R=this.ui.propertyTree.lineRange(R,!1);this.ui.propertyTree.replace(R,xa,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),
this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var R=$b.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(R!=this.lastChange||this.lastSubmorphs!=$b.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==R.prop&&this.repositionOpenWidget(),this.lastChange=R,this.lastSubmorphs=$b.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",
value:function(){var R;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(xa){xa=xa.node;xa.target&&(R=xa.foldableNode?xa.target[xa.foldableNode.key][xa.key]:xa.target[xa.key],!$b.obj.equals(R,xa.value)&&xa.refreshProperty&&xa.refreshProperty(R))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(R,xa){xa=void 0===xa?!1:xa;
var Va=this,eb,ac,Db,xc,Jc,Bc,re,of,Ye,Bg,Bh,Cf,hg,wf,tj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pf){switch(Pf.nextAddress){case 1:if(!Va.isUpdating()){Pf.jumpTo(2);break}return Pf.yield(Va.whenUpdated(),2);case 2:eb=$b.promise.deferred();ac=eb.promise;Db=!!Va.target;Va.updateInProgress=ac;Pf.setCatchFinallyBlocks(4);xa&&(xc=$b.LoadingIndicator.open("connecting to remote..."));if(!xa){Jc=$b.InspectionTree.forObject(R,Va);Pf.jumpTo(6);break}return Pf.yield($b.RemoteInspectionTree.forObject(R,
Va),7);case 7:Jc=Pf.yieldResult;case 6:return Bc=Jc,re=Va.ui.propertyTree,Pf.yield(Bc.collapse(Bc.root,!1),8);case 8:if(!Bc.root.children){Pf.jumpTo(9);break}return Pf.yield(Bc.collapse(Bc.root.children[0],!1),9);case 9:if(of=Va.originalTreeData&&Va.originalTreeData.diff(Bc)){Ye=$jscomp.makeIterator(of);for(Bg=Ye.next();!Bg.done;Bg=Ye.next())Bh=Bg.value,Cf=$jscomp.makeIterator(Bh),hg=Cf.next().value,wf=Cf.next().value,hg.refreshProperty(wf.value);Pf.jumpTo(11);break}re.treeData=Bc;return Pf.yield(Va.filterProperties(),
12);case 12:if(!re.treeData.root.isCollapsed){Pf.jumpTo(13);break}return Pf.yield(re.onNodeCollapseChanged({node:Bc.root,isCollapsed:!1}),14);case 14:re.selectedIndex=1;case 13:return Pf.yield(re.execCommand("uncollapse selected node"),11);case 11:Va.toggleWindowStyle(Db);xc&&xc.remove();Pf.leaveTryBlock(5);break;case 4:tj=Pf.enterCatchBlock(),Va.showError(tj);case 5:Va.startStepping(1E3,"refreshAllProperties"),Va.updateInProgress=null,Pf.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(R){R=
void 0===R?!0:R;var xa=this,Va,eb,ac,Db,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jc){if(1==Jc.nextAddress)return Va=300,Db=xa.ui.codeEditor.pluginFind(function(Bc){return Bc.runEval}),xc=xa.getWindow(),Jc.yield(Db.runEval("System.get('@system-env').node"),2);Jc.yieldResult.value?(ac=[].concat($jscomp.arrayFromIterable($b.arr.without(xc.styleClasses,"local")),["node"]),eb=$b.DarkTheme.instance):(ac=["local"].concat($jscomp.arrayFromIterable(xc?$b.arr.without(xc.styleClasses,"node"):
[])),eb=$b.DefaultTheme.instance);Db.theme=eb;R?(xc&&xc.animate({duration:Va,styleClasses:ac}),xa.ui.codeEditor.animate({fill:eb.background,duration:Va})):xc&&(xc.styleClasses=ac);xa.ui.codeEditor.textString=xa.ui.codeEditor.textString;Db.highlight();Jc.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var R=
this,xa=Object.assign({type:"text",borderWidth:1,borderColor:$b.Color.gray,lineWrapping:"by-chars"},$b.config.codeEditor.defaultStyle,{textString:""}),Va=$b.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});$b.rect(0,0,this.width,30);var eb=new $b.SearchField({styleClasses:["idle"],name:"searchField"});Va[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[eb,{type:"button",name:"targetPicker",padding:$b.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},
tooltip:"Change Inspection Target",label:$b.Icon.textAttribute("crosshairs")},new $b.LabeledCheckBox({label:"Internals",name:"internals"}),new $b.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new $b.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:$b.InspectionTree.forObject(null,this)})),$b.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},xa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},
{name:"this binding selector",type:$b.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Va),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Va),[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){R.ui.thisBindingSelector.selection=
"target"})}},{key:"selectTarget",value:function(){var R=this,xa,Va,eb,ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){switch(Db.nextAddress){case 1:if(R.env.eventDispatcher.isKeyPressed("Shift"))return Va=$jscomp,eb=Va.makeIterator,Db.yield($world.execCommand("select morph",{justReturn:!0}),5);R.toggleSelectionInstructions(!0);return Db.yield($b.InteractiveMorphSelector.selectMorph(),4);case 4:xa=Db.yieldResult;R.toggleSelectionInstructions(!1);Db.jumpTo(3);break;case 5:ac=eb.call(Va,
Db.yieldResult),xa=ac.next().value;case 3:xa&&(R.targetObject=xa),Db.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(R){if(R&&!this.instructionWidget){var xa=$b.morph({type:"label",name:"escapeKey",value:"esc"});xa.whenRendered().then(function(){return xa.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",
{},xa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(R){R=R.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;R.epiMorph=!0;this.openWidget=R;$b.once(R,"close",this,"closeOpenWidget");$b.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",
value:function(){var R=this.ui.propertyTree,xa=R.textLayout.boundsFor(R,{column:0,row:R.selectedIndex-1});xa=R.worldPoint($b.pt(xa.x,xa.y+xa.height/2)).addPt(R.scroll.negated());R=R.globalBounds();xa.x=this.globalBounds().center().x;xa.y<R.top()?xa=R.topCenter():R.bottom()-20<xa.y&&(xa=R.bottomCenter().addXY(0,-20));return xa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(R){this.layout.row(1).height+=
R.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(R){if(R!==this.isEditorVisible()){var xa=this.extent,Va=this.layout,eb=this.ui,ac=eb.terminalToggler,Db=eb.codeEditor,xc=eb.thisBindingSelector;eb=eb.fixImportButton;Va.disable();R?(ac.fontColor=$b.Color.rgbHex("00e0ff"),Va.row(3).height=this.codeEditorHeight||180,Va.row(2).height=5,eb.animate({visible:!0,duration:200}),xc.animate({visible:!0,
duration:200})):(this.codeEditorHeight=Va.row(3).height,ac.fontColor=$b.Color.white,Va.row(3).height=Va.row(2).height=0,eb.animate({visible:!1,duration:200}),xc.animate({visible:!1,duration:200}));this.extent=xa;Va.enable({duration:200});this.relayout({duration:200});Db.focus();Db.animate({opacity:R?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var R=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){R.makeEditorVisible(!R.isEditorVisible());xa.jumpToEnd()})}},{key:"filterProperties",
value:function(){var R=this,xa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return xa=R.ui.searchField,Va=R.ui.propertyTree,R.originalTreeData||(R.originalTreeData=Va.treeData),$b.disconnect(Va.treeData,"onWidgetOpened",R,"onWidgetOpened"),eb.yield(Va.treeData.filter({maxDepth:2,showUnknown:R.ui.unknowns.checked,showInternal:R.ui.internals.checked,iterator:function(ac){return xa.matches(ac.key)}}),2);Va.update();$b.connect(Va.treeData,"onWidgetOpened",R,
"onWidgetOpened");eb.jumpToEnd()})}},{key:"relayout",value:function(R){R=void 0===R?{}:R;var xa=this,Va,eb,ac,Db,xc,Jc,Bc,re,of;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ye){xa.layout&&xa.layout.forceLayout();Va=xa;eb=Va.ui;ac=eb.fixImportButton;Db=eb.terminalToggler;xc=eb.propertyTree;Jc=eb.thisBindingSelector;Bc=xc.bounds().insetBy(5).bottomLeft();re=xc.bounds().insetBy(5).bottomRight();of=re.subXY(ac.width+10,0);Jc.width=115;Jc.listMorph.itemHeight=20;R.duration?(Db.animate(Object.assign({bottomLeft:Bc},
R)),ac.animate(Object.assign({bottomRight:re},R)),Jc.animate(Object.assign({bottomRight:of},R))):(Db.bottomLeft=Bc,ac.bottomRight=re,Jc.bottomRight=of);Ye.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(ib._get(Object.getPrototypeOf(nb.prototype),"keybindings",this))}},{key:"commands",get:function(){return $b.inspectorCommands}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(R){if(System._testsRunning)return console.log(R.targetObject);R=new this(R);R.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return R}},{key:"properties",get:function(){return{extent:{defaultValue:$b.pt(400,500)},fill:{defaultValue:$b.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(R){this.setProperty("remoteTarget",
R);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(R,!0))}},targetObject:{after:["submorphs"],set:function(R){this._serializableTarget=R&&R.isMorph?R.id:R;this.setProperty("targetObject",R);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(R))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var R=this.ui.propertyTree,xa=R.treeData;return xa.getContextFor(R.selectedNode||xa.root)}},submorphs:{initialize:function(){this.build()}},
ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),
searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:$b.Color.gray,fontSize:14,fontFamily:$b.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Oa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25462,end:45996})}($b.Morph);ef=$b.Inspector;Ue=wa("I",ef);$b.default=ef;var ph=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");ph.Inspector=Ue;ph.string=dd;ph.Morph=ec;ph.pt=ed;ph.Color=bb;ef=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(ya,Oa,nb){nb=void 0===nb?1:nb;var R,
xa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){switch(eb.nextAddress){case 1:return ya.maybeSelectCommentOrLine(),eb.setCatchFinallyBlocks(2),Oa=Object.assign({},Oa,{logDoit:!0,inspect:!0,inspectDepth:nb}),eb.yield(ya.doEval(void 0,Oa),4);case 4:R=eb.yieldResult;xa=R.error?R.error:R.isError?R.value:null;eb.leaveTryBlock(3);break;case 2:xa=Va=eb.enterCatchBlock();case 3:return xa?ya.showError(xa):ya.setStatusMessage(ph.string.truncate(R.value,1E3)),eb.return(R)}})}},{name:"eval all",
doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(ya,Oa){var nb,R,xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Va){switch(Va.nextAddress){case 1:return Va.setCatchFinallyBlocks(2),Va.yield(ya.doEval({start:{row:0,column:0},end:ya.documentEndPosition},Object.assign({},Oa,{logDoit:!0})),4);case 4:nb=Va.yieldResult;R=nb.error?nb.error:nb.isError?nb.value:null;Va.leaveTryBlock(3);break;case 2:R=xa=Va.enterCatchBlock();case 3:return R?ya.showError(R):ya.setStatusMessage(String(nb.value)),
Va.return(nb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(ya,Oa){var nb,R,xa,Va,eb,ac,Db,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jc){switch(Jc.nextAddress){case 1:return ya.maybeSelectCommentOrLine(),Jc.setCatchFinallyBlocks(2),Oa=Object.assign({},Oa,{asString:!1,logDoit:!0}),Jc.yield(ya.doEval(void 0,Oa),4);case 4:nb=Jc.yieldResult;R=nb.error?nb.error:nb.isError?nb.value:null;Jc.leaveTryBlock(3);
break;case 2:R=xa=Jc.enterCatchBlock();case 3:ya.selection.collapseToEnd();if(Va=nb.value&&nb.value.isColor)return ya.selection.text=String(nb.value),eb=new ph.Morph({fill:ph.Color.transparent,extent:ph.pt(ya.fontSize+2,ya.fontSize+2),submorphs:[{fill:nb.value,center:ph.pt(ya.fontSize+2,ya.fontSize+2).scaleBy(.5)}]}),ac=ya.selection.start,Db=ac.column,xc=ac.row,ya.insertText([eb,{}],ya.selection.start),ya.selection.start={column:Db,row:xc},ya.focus(),Jc.return(nb);ya.insertTextAndSelect(R?String(R)+
(R.stack?"\n"+R.stack:""):String(nb.value));ya.focus();return Jc.return(nb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(ya,Oa){var nb,R,xa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){switch(eb.nextAddress){case 1:ya.maybeSelectCommentOrLine();R=ya.textInRange(ya.selection);xa=ya.evalEnvironment||{};Va=ya.pluginFind(function(ac){return ac.isEditorPlugin&&"function"===typeof ac.runEval});xa.systemInterface||
(xa.systemInterface=Va.systemInterface(Oa));if("local"!==xa.systemInterface.name){eb.jumpTo(2);break}eb.setCatchFinallyBlocks(3);return eb.yield(ya.doEval(void 0,Oa),5);case 5:nb=eb.yieldResult;R=nb.value;eb.leaveTryBlock(2);break;case 3:eb.enterCatchBlock();case 2:return ya.world().execCommand("open object editor",{target:R,evalEnvironment:xa}),eb.return(nb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(ya,Oa){var nb,R,
xa,Va,eb,ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){switch(Db.nextAddress){case 1:ya.maybeSelectCommentOrLine();xa=ya.textInRange(ya.selection);Va=ya.evalEnvironment||{};eb=ya.pluginFind(function(xc){return xc.isEditorPlugin&&"function"===typeof xc.runEval});Va.systemInterface||(Va.systemInterface=eb.systemInterface(Oa));if("local"!==Va.systemInterface.name){ph.Inspector.openInWindow({remoteTarget:{code:xa,evalEnvironment:Va}});Db.jumpTo(2);break}Db.setCatchFinallyBlocks(3);
return Db.yield(ya.doEval(void 0,Oa),5);case 5:nb=Db.yieldResult;R=nb.error?nb.error:nb.isError?nb.value:null;xa=nb.value;Db.leaveTryBlock(4);break;case 3:R=ac=Db.enterCatchBlock();case 4:ph.Inspector.openInWindow({targetObject:R||xa});case 2:return Db.return(nb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",handlesCount:!0,exec:function(ya,Oa,nb){nb=void 0===nb?1:nb;var R;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){switch(xa.nextAddress){case 1:return ya.maybeSelectCommentOrLine(),xa.setCatchFinallyBlocks(2),Oa=Object.assign({},Oa,{inspect:!0,inspectDepth:nb,logDoit:!0}),xa.yield(ya.doEval(void 0,Oa),4);case 4:R=xa.yieldResult;xa.leaveTryBlock(3);break;case 2:xa.enterCatchBlock();case 3:return ya.selection.collapseToEnd(),ya.insertTextAndSelect(R.value),xa.return(R)}})}}];ph.codeEvaluationCommands=ef;ph.codeEvaluationCommands=ef;ph.codeEvaluationCommands=
ef;var pg=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");pg.changeAttributeInSelectionOrMorph=function(ya,Oa,nb){var R=ya.selection;ya.keepPosAtSameScrollOffsetWhile(function(){R.isEmpty()?ya[Oa]="function"===typeof nb?nb(ya[Oa]):nb:(ya.undoManager.group(),ya.changeStyleProperty(Oa,function(xa){return"function"===typeof nb?nb(xa):nb}),ya.undoManager.group())})};Ue=[{name:"increase font size",scrollCursorIntoView:!1,exec:function(ya){var Oa=ya.fontSize;pg.changeAttributeInSelectionOrMorph(ya,
"fontSize",function(nb){nb=nb||Oa;return nb+(18<=nb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(ya){var Oa=ya.fontSize;pg.changeAttributeInSelectionOrMorph(ya,"fontSize",function(nb){nb=nb||Oa;return nb-(18>=nb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(ya){var Oa,nb,R,xa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress){Oa=["serif","sans-serif","monospace"];if(nb=localStorage["lively.morpic/text-change-font-additional-fonts"])nb=
JSON.parse(nb),Oa.push.apply(Oa,$jscomp.arrayFromIterable(nb));Oa.map(function(ac){return ac.toLowerCase()}).includes(ya.fontFamily.toLowerCase())||(Oa.push(ya.fontFamily),nb=[].concat($jscomp.arrayFromIterable(nb||[]),[ya.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(nb));return eb.yield($world.editListPrompt("choose font",Oa,{requester:ya,preselect:Oa.indexOf(ya.fontFamily),historyId:"lively.morpic/text-change-font-hist"}),2)}R=eb.yieldResult;xa=$jscomp.makeIterator(R.selections);
if(Va=xa.next().value)ya.fontFamily=Va;return eb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(ya,Oa){Oa=void 0===Oa?{}:Oa;var nb,R,xa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress){if(Oa.hasOwnProperty("link"))return eb.jumpTo(2);R=ya.selection;xa=ya.getStyleInRange(R);Va=xa.link;return eb.yield(ya.world().prompt("Set link",{input:Va||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=eb.nextAddress&&
(nb=eb.yieldResult,!nb))return eb.return();ya.undoManager.group();ya.setStyleInRange({link:nb||void 0},R);ya.undoManager.group();eb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(ya,Oa){var nb,R,xa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){if(1==eb.nextAddress)return nb=ya.selection,R=ya.getStyleInRange(nb),xa=R.doit,eb.yield(ya.world().editPrompt("Enter doit code (runs on clicking the text)",{requester:ya,input:xa?xa.code:"// empty doit",
historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:ya.evalEnvForDoit(xa||{})}),2);Va=eb.yieldResult;ya.undoManager.group();Va?ya.addTextAttribute({doit:{code:Va},nativeCursor:"pointer",textDecoration:"underline"},nb):ya.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},nb);ya.undoManager.group();eb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(ya,Oa){Oa=void 0===Oa?{}:Oa;ya.undoManager.group();Oa=!Oa.onlySelection&&ya.selection.isEmpty()?
ya.documentRange:ya.selection.range;ya.setStyleInRange(null,Oa);ya.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(ya){var Oa,nb,R,xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Va){if(1==Va.nextAddress)return Va.yield(System.import("lively.modules"),2);if(3!=Va.nextAddress)return Oa=Va.yieldResult,nb=Oa.module,Va.yield(nb("lively.ide/text/ui.js").load(),3);R=Va.yieldResult;xa=R.RichTextControl;return Va.return(xa.openFor(ya))})}}];pg.commands=Ue;
pg.commands=Ue;pg.commands=Ue;var Je=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");Je.guessTextModeName=pa;Je.rangedToken=function(ya,Oa,nb,R,xa){return{start:{row:ya,column:Oa},end:{row:ya,column:nb},token:R,mode:xa}};Je.fun=Ua;Je.arr=Qb;Je.connect=Ac;Je.disconnect=Hb;Je.DefaultTheme=Sb;Je.tokenizeDocument=od;Je.modeInfo=rb;Je.visitDocumentTokens=ld;Je.getMode=oa;Je.completionCommands=Mc;Je.multiSelectCommands=Ve;Je.navCommands=fe;Je.codeCommands=te;Je.codeEvaluationCommands=ef;
Je.richTextCommands=Ue;Je.Color=bb;Je.Range=le;Je.guessTextModeName=pa;Je.guessTextModeName=pa;Sb=function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),nb=Oa.hasOwnProperty("EditorPlugin")&&"function"===typeof Oa.EditorPlugin?Oa.EditorPlugin:Oa.EditorPlugin=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
Je.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(R){var xa=this;this.textMorph=R;Je.connect(R,"textChange",this,"onTextChange");Je.connect(R,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return xa.highlight()})}},
{key:"detach",value:function(R){Je.disconnect(R,"textChange",this,"onTextChange");Je.disconnect(R,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(R){this._ast=null;if(R){var xa=this._tokenizerValidBefore;if("replace"===R.selector){var Va=R.args[0].start;R=Va.row;Va=Va.column}else Va=R=0;if(!xa||R<xa.row||R===xa.row&&Va<xa.column)R=Math.max(0,R),this._tokenizerValidBefore={row:R,column:Va}}this.requestHighlight()}},
{key:"requestHighlight",value:function(R){var xa=this;(void 0===R?0:R)?this.highlight():Je.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return xa.highlight()})()}},{key:"highlight",value:function(){var R=this.textMorph,xa=this.theme,Va=this.mode,eb=this._tokenizerValidBefore;if(xa&&R&&R.document&&Va){R.fill=xa.background;R.cursorColor=xa.cursorColor||Je.Color.black;var ac=R.viewState,Db={};eb=Je.tokenizeDocument(Va,R.document,ac.firstVisibleRow,ac.lastVisibleRow,eb);Va=eb.lines;eb=
eb.tokens;if(Va.length){ac=Va[0].row;for(var xc=[],Jc=0;Jc<eb.length;ac++,Jc++)for(var Bc=eb[Jc],re=0;re<Bc.length;re+=5){var of=Bc[re],Ye=Bc[re+1],Bg=xa[Bc[re+2]]||xa.default;Bg&&xc.push({start:{row:ac,column:of},end:{row:ac,column:Ye}},Bg)}R.embeddedMorphs.forEach(function(Bh){var Cf=R.embeddedMorphMap.get(Bh).anchor;Db[Bh.id]=R.textAttributeAt(Cf.position)});R.setTextAttributesWithSortedRanges(xc);R.embeddedMorphs.forEach(function(Bh){var Cf=R.embeddedMorphMap.get(Bh).anchor;Cf=Je.Range.at(Cf.position);
Cf.end.column+=1;R.replace(Cf,[Bh,Db[Bh.id]],!1)});this._tokenizerValidBefore={row:Je.arr.last(Va).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},R,this)}}},{key:"visitTokensInRange",value:function(R,xa){var Va=R.start,eb=R.end,ac=Va.row-1;Je.visitDocumentTokens(this.mode,this.textMorph.document,Va.row,eb.row,null,function(Db){return ac++},function(Db,xc,Jc,Bc,re,of,Ye){if(ac===Va.row&&0<Va.column){if(Va.column>=Bc)return;Jc<Va.column&&Va.column<Bc&&(Jc=Va.column)}if(ac===eb.row){if(eb.column<=
Jc)return;Jc<eb.column&&eb.column<Bc&&(Bc=eb.column)}xa(Db,xc,ac,Jc,Bc,re,of,Ye)})}},{key:"tokensInRange",value:function(R){var xa=[];this.visitTokensInRange(R,function(Va,eb,ac,Db,xc,Jc,Bc,re){return xa.push(Je.rangedToken(ac,Db,xc,Va,re))});return xa}},{key:"tokensOfRow",value:function(R){var xa=this.textMorph.getLine(R).length;return this.tokensInRange({start:{row:R,column:0},end:{row:R,column:xa}})}},{key:"tokenAt",value:function(R){for(var xa=this.tokensOfRow(R.row),Va=xa.length;Va--;){var eb=
xa[Va];if(eb.token&&eb.start.column<=R.column&&R.column<=eb.end.column)return eb}return null}},{key:"getCommands",value:function(R){return[].concat($jscomp.arrayFromIterable(R),$jscomp.arrayFromIterable(Je.completionCommands),$jscomp.arrayFromIterable(Je.multiSelectCommands),$jscomp.arrayFromIterable(Je.navCommands),$jscomp.arrayFromIterable(Je.codeCommands),$jscomp.arrayFromIterable(Je.codeEvaluationCommands),$jscomp.arrayFromIterable(Je.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var R=this.mode,xa=R.lineComment,Va=R.blockCommentStart;R=R.blockCommentEnd;var eb={};xa&&(eb.lineCommentStart=xa);Va&&(eb.blockCommentStart=Va);R&&(eb.blockCommentEnd=R);return eb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(R,xa,Va){var eb=this.textMorph,ac=R.row,Db=R.column;R=xa[Db-1];xa=xa[Db];eb.selection.text="\n";eb.selection.collapseToEnd();"{"===R&&"}"===xa&&(eb.selection.text="\n"+" ".repeat(Va),eb.selection.collapse());
eb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:ac+1,lastRow:ac+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var R=this.textMorph,xa=this.openPairs,Va=R.selection,eb=R.getLine(Va.end.row),ac=eb[Va.end.column-1];eb=eb[Va.end.column];R.autoInsertPairs&&Va.isEmpty()&&ac in
xa&&eb===xa[ac]&&(Va.growRight(1),Va.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(R){var xa=this.openPairs,Va=this.closePairs,eb=this.textMorph,ac=eb.selection,Db=eb.autoInsertPairs&&R in xa,xc=eb.autoInsertPairs&&R in Va;if(!Db&&!xc)return!1;var Jc=eb.getLine(ac.end.row)[ac.end.column];if(!ac.isEmpty()){if(!Db)return!1;Va=eb.undoManager.ensureNewGroup(eb);eb.insertText(xa[R],ac.end);eb.insertText(R,ac.start);eb.undoManager.group(Va);ac.growRight(-1);return!0}if(Jc in Va&&R===Jc)return ac.goRight(1),
!0;if(xc&&!Db)return!1;Va=eb.undoManager.ensureNewGroup(eb);eb.insertText(R+xa[R]);eb.undoManager.group(Va);ac.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Oa,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);
rb=Sb=Je.EditorPlugin;Mc=wa("C",function(ya){var Oa=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),nb=Oa.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Oa.CodeMirrorEnabledEditorPlugin?Oa.CodeMirrorEnabledEditorPlugin:Oa.CodeMirrorEnabledEditorPlugin=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ib(nb,ya,[{key:Symbol.for("lively-instance-initialize"),value:function(){ib._get(Object.getPrototypeOf(nb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(R){this.mode=this.codeMirrorMode(R);return ib._get(Object.getPrototypeOf(nb.prototype),"attach",this).call(this,R)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(R){return{indentWithTabs:!R.useSoftTabs,indentUnit:R.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(R){R=this.defaultCodeMirrorModeConfig(R);
return Je.getMode(R,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Oa,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(Je.EditorPlugin));Je.CodeMirrorEnabledEditorPlugin=Mc;Je.CodeMirrorEnabledEditorPlugin=
Mc;Je.CodeMirrorEnabledEditorPlugin=Mc;Je.default=Sb;Sb=Object.freeze({__proto__:null,guessTextModeName:pa,"default":rb,CodeMirrorEnabledEditorPlugin:Mc});wa("e",Sb)}}});
System.register(["./__root_module__-a4bfb546.js","kld-intersections","./index-8925a56f.js","./index-5e766f8e.js","./user-ui-ad7092aa.js"],function(ta,cb){var mb,Sb,Jb,sd,vc,wd,wc,Cc,Gc,Cd,pe,Je,ce,Qb,pc,ld,Rb,xd,Hd,Dc;return{setters:[function(bc){mb=bc.ay;Sb=bc.aw;Jb=bc.an;sd=bc.aD;vc=bc.ap;wd=bc.ab;wc=bc.Y;Cc=bc.a6;Gc=bc.ax;Cd=bc.a7;pe=bc.C;Je=bc.a3;ce=bc.r;Qb=bc.aC;pc=bc.b1;ld=bc.b2;Rb=bc.au;xd=bc.a$;Hd=bc.aY},function(){},function(){},function(){},function(bc){Dc=bc.UserUI}],execute:function(){var bc=
lively.FreezerRuntime.recorderFor("StaticText/index.js");bc.HTMLMorph=mb;var Ib=function(bd){var oc=lively.FreezerRuntime.recorderFor("StaticText/index.js"),$a=oc.hasOwnProperty("StaticText")&&"function"===typeof oc.StaticText?oc.StaticText:oc.StaticText=function(fb){fb&&fb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb($a,bd,[{key:"refresh",value:function(){this.html='<span style="line-height: 1.3; font-size: '+this.fontSize+
"px; color: "+this.fontColor+"; font-family: "+this.fontFamily+'">'+this.value+"</span>"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StaticText"}},{key:"properties",get:function(){return{html:{isStyleProp:!1},fontSize:{type:"Number",set:function(fb){this.setProperty("fontSize",fb);this.refresh()}},fontColor:{type:"Color",set:function(fb){this.setProperty("fontColor",fb);this.refresh()}},fontFamily:{type:"Enum",set:function(fb){this.setProperty("fontFamily",fb);this.refresh()}},
value:{set:function(fb){this.setProperty("value",fb);this.refresh()}}}}}],oc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"StaticText",version:"0.1.1-10"}}},{start:74,end:953})}(bc.HTMLMorph);Ib=bc.StaticText;bc.default=Ib;var gc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");gc.Morph=Jb;gc.HorizontalLayout=sd;gc.VerticalLayout=
vc;gc.morph=wd;gc.MorphicDB=wc;gc.arr=Cc;gc.fun=Gc;gc.string=Cd;gc.Color=pe;gc.pt=Je;gc.UserUI=Dc;gc.resource=ce;bc=function(bd){var oc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),$a=oc.hasOwnProperty("WorldDashboard")&&"function"===typeof oc.WorldDashboard?oc.WorldDashboard:oc.WorldDashboard=function(fb){fb&&fb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb($a,bd,[{key:"onLoad",value:function(){"undefined"!==
typeof localStorage&&(this.ui.sortSelector.selection=localStorage.getItem("lively.morphic-projects-filter"))}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",this.ui.sortSelector.selection)}catch(fb){console.error(fb)}}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=
!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(fb){fb=void 0===fb?$world:fb;this.owner!=fb&&fb.addMorph(this);this.center=fb.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(fb){var ya=gc.UserUI.getCurrentUser();fb=this.ui.searchField.fuzzyFilter(fb,function(Ca){return Ca._commit.name+Ca._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return gc.arr.sortBy(fb,function(Ca){return-Ca._commit.timestamp});
case "TEMPLATES":return fb;case "MY PROJECTS":return gc.arr.filter(fb,function(Ca){return Ca._commit.author.name===ya.name});case "PUBLISHED":return fb}}},{key:"updateList",value:function(){var fb=this;this.previews&&gc.fun.debounceNamed("update world list",150,function(){fb.ui.worldList.items=fb.sortAndFilterPreviews(fb.previews)})()}},{key:"displayWorlds",value:function(){var fb=this,ya,Ca,Aa,xa,Oa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){switch(wb.nextAddress){case 1:return fb.reset(),
ya=fb.ui,Ca=ya.loadingLabel,Ca.animate({opacity:1,duration:300}),wb.yield(fb.db.latestCommits("world"),2);case 2:return Aa=wb.yieldResult,wb.yield(cb.import("./world preview-ec2e2f00.js"),4);case 4:if(!(xa=wb.yieldResult)){wb.jumpTo(5);break}return wb.yield(gc.resource("part://partial freezing/world preview"),6);case 6:xa=wb.yieldResult;case 5:return wb.yield(xa.read(),3);case 3:return Oa=wb.yieldResult,fb.previews=Aa.map(function(dc){var Ya=gc.morph({reactsToPointer:!1,fill:gc.Color.transparent,
extent:Oa.extent});Ya._commit=dc;Ya.displayPreview=function(){var jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==Za.nextAddress)return jb=Oa.copy(),jb._commit=dc,jb.opacity=0,Ya.addMorph(jb),jb.displayPreview(),jb.position=gc.pt(0,0),Za.yield(Ya.whenRendered(),2);Ya.layout=new gc.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});Za.jumpToEnd()})};return Ya}),wb.yield(Ca.animate({opacity:0,duration:300}),7);case 7:fb.updateList(),0==Aa.length&&(fb.ui.noWorldWarning.center=
fb.innerBounds().center(),fb.ui.noWorldWarning.animate({visible:!0,duration:300})),wb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(fb){this.ui.closeButton.visible=fb}},db:{serialize:!1,get:function(){return gc.MorphicDB.default}},
ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],oc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"WorldDashboard",version:"0.1.1-130"}}},{start:330,end:4316})}(gc.Morph);bc=gc.WorldDashboard;gc.default=bc;var sc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");sc.Morph=Jb;sc.touchInputDevice=Qb;sc.TilingLayout=pc;sc.arr=Cc;sc.pt=Je;bc=function(bd){var oc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),$a=oc.hasOwnProperty("GrowingWorldList")&&"function"===typeof oc.GrowingWorldList?oc.GrowingWorldList:oc.GrowingWorldList=function(fb){fb&&
fb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb($a,bd,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(fb){Sb._get(Object.getPrototypeOf($a.prototype),"onScroll",this).call(this,fb);this.update()}},{key:"onChange",value:function(fb){Sb._get(Object.getPrototypeOf($a.prototype),"onChange",this).call(this,fb);"extent"==fb.prop&&this.update(!0)}},{key:"onHoverIn",value:function(fb){this.clipMode=
"auto"}},{key:"onHoverOut",value:function(fb){sc.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(fb){var ya=this.items;if(ya&&0!=ya.length){var Ca=this.scrollContainer,Aa=Ca.layout.spacing;Ca.extent=this.extent;var xa=this.ui,Oa=xa.bufferTop;xa=xa.bufferBottom;Oa=Oa||Ca.addMorph({fill:null,name:"buffer top",height:10});xa=xa||Ca.addMorph({fill:null,name:"buffer bottom",height:10});Oa.width=xa.width=this.width-100;Ca.layout.disable();var wb=ya[0];Aa=ya.slice(0,Math.floor(this.width/
(wb.width+Aa))*(Math.ceil((this.scroll.y+this.height)/(wb.height+Aa))+1)).filter(function(Za){return Za.owner!=Ca});wb=this.scroll.y+2*this.height;for(var dc={},Ya=$jscomp.makeIterator(Aa),jb=Ya.next();!jb.done;dc={$jscomp$loop$prop$item$2612:dc.$jscomp$loop$prop$item$2612},jb=Ya.next())dc.$jscomp$loop$prop$item$2612=jb.value,wb++,dc.$jscomp$loop$prop$item$2612.top=wb,Ca.addMorph(dc.$jscomp$loop$prop$item$2612),dc.$jscomp$loop$prop$item$2612._initialized||dc.$jscomp$loop$prop$item$2612.whenRendered().then(function(Za){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(U){Za.$jscomp$loop$prop$item$2612._initialized=
!0;return U.yield(Za.$jscomp$loop$prop$item$2612.displayPreview(),0)})}}(dc));fb&&(Oa.position=sc.pt(0,0),ya.forEach(function(Za,U){return Za.position=sc.pt(U+1,U+1)}),xa.position=sc.pt(ya.length+2,ya.length+2));Ca.layout.enable();if(fb||0<Aa.length)xa.top=this.submorphBounds().height,Ca.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new sc.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(fb){this.setProperty("items",fb);var ya=this.scrollContainer;ya.layout&&ya.layout.disable();var Ca=this.ui,Aa=Ca.bufferTop;Ca=Ca.bufferBottom;sc.arr.withoutAll(ya.submorphs,
[].concat($jscomp.arrayFromIterable(fb),[Aa,Ca])).forEach(function(xa){return xa.remove()});this.update(!0)}}}}}],oc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(sc.Morph);bc=sc.GrowingWorldList;sc.default=bc;var dd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
dd.InputLine=ld;dd.Color=pe;dd.connect=Rb;dd.disconnectAll=xd;dd.disconnect=Hd;dd.arr=Cc;dd.string=Cd;bc=function(bd){var oc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),$a=oc.hasOwnProperty("SearchInputLine")&&"function"===typeof oc.SearchInputLine?oc.SearchInputLine:oc.SearchInputLine=function(fb){fb&&fb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Sb($a,bd,[{key:"fuzzyMatch",value:function(fb,ya){ya=void 0===
ya?this.parseInput():ya;if(ya.lowercasedTokens.every(function(Aa){return fb.toLowerCase().includes(Aa)}))return!0;var Ca=fb.toLowerCase();return 3>=dd.arr.sum(ya.lowercasedTokens.map(function(Aa){return dd.string.levenshtein(Ca,Aa)}))}},{key:"fuzzyFilter",value:function(fb,ya){var Ca=this;ya=void 0===ya?function(xa){return xa}:ya;var Aa=this.parseInput();return dd.arr.filter(fb,function(xa){return Ca.fuzzyMatch(ya(xa),Aa)})}},{key:"parseInput",value:function(){var fb=Array.from(this.textString).reduce(function(Ca,
Aa){if("\\"===Aa&&!Ca.escaped)return Ca.escaped=!0,Ca;" "!==Aa||Ca.escaped?(Ca.spaceSeen=!1,Ca.current+=Aa):(!Ca.spaceSeen&&Ca.current&&(Ca.tokens.push(Ca.current),Ca.current=""),Ca.spaceSeen=!0);Ca.escaped=!1;return Ca},{tokens:[],current:"",escaped:!1,spaceSeen:!1});fb.current&&fb.tokens.push(fb.current);var ya=fb.tokens.map(function(Ca){return Ca.toLowerCase()});return{tokens:fb.tokens,lowercasedTokens:ya}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],oc,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(dd.InputLine);bc=dd.SearchInputLine;dd.default=bc}}});
System.register("./__rootModule___commonjs-entry-71573ff5.js ./eval-backend-ui-e952986b.js ./index-d18accbd.js ./editor-plugin-330ed4ee.js ./index-ca98f65e.js ./index-1c08552a.js ./loading-indicator.cp-b18e3b89.js @babel/plugin-syntax-import-meta ./interface-dc23a2c8.js ./tooltips.cp-6a2406c0.js ./mode-9e103dc6.js ./index-c79abca0.js ./value-widgets-6cb12552.js ./editor-modes-5e094c88.js ./editor-plugin-0a8dd45b.js ./ui.cp-6289a670.js ./list.cp-8569fe93.js ./popups.cp-68dc8a4a.js".split(" "),function(Lc,
pd){var Nd,Tc,Jc,$d,Bb,rd,Id,Ac,Pc,gd,nd,Fd,ic,vd,sb,Xb,Nb,bc,hb,cb,Hb,ec,ub;return{setters:[function(yb){Nd=yb.y;Tc=yb._;Jc=yb.j;$d=yb.d;Bb=yb.B;rd=yb.aE;Id=yb.f;Ac=yb.ag;Pc=yb.ae;gd=yb.bK;nd=yb.b;Fd=yb.C;ic=yb.J;vd=yb.w;sb=yb.g;Xb=yb.i;Nb=yb.x;bc=yb.G},function(yb){hb=yb["default"]},function(){},function(yb){cb=yb["default"]},function(yb){Hb=yb.p},function(yb){ec=yb.localInterface},function(yb){ub=yb.L},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},
function(){},function(){},function(){}],execute:function(){function yb(){}function ba(Ma,qb,Vb,Lb,Kb){for(var Db=0,Ra=qb.length,N=0,va=0;Db<Ra;Db++){var Wa=qb[Db];if(Wa.removed)Wa.value=Lb.slice(va,va+Wa.count).join(""),va+=Wa.count,Db&&qb[Db-1].added&&(Wa=qb[Db-1],qb[Db-1]=qb[Db],qb[Db]=Wa);else{if(!Wa.added&&Kb){var pa=Vb.slice(N,N+Wa.count);pa=pa.map(function(tb,ab){ab=Lb[va+ab];return ab.length>tb.length?ab:tb});Wa.value=pa.join("")}else Wa.value=Vb.slice(N,N+Wa.count).join("");N+=Wa.count;Wa.added||
(va+=Wa.count)}}Vb=qb[Ra-1];1<Ra&&(Vb.added||Vb.removed)&&Ma.equals("",Vb.value)&&(qb[Ra-2].value+=Vb.value,qb.pop());return qb}function wb(Ma,qb,Vb){qb=qb||[];Vb=Vb||[];var Lb;for(Lb=0;Lb<qb.length;Lb+=1)if(qb[Lb]===Ma)return Vb[Lb];if("[object Array]"===xb.call(Ma)){qb.push(Ma);var Kb=Array(Ma.length);Vb.push(Kb);for(Lb=0;Lb<Ma.length;Lb+=1)Kb[Lb]=wb(Ma[Lb],qb,Vb);qb.pop();Vb.pop();return Kb}Ma&&Ma.toJSON&&(Ma=Ma.toJSON());if("object"===("undefined"===typeof Ma?"undefined":Wb(Ma))&&null!==Ma){qb.push(Ma);
Kb={};Vb.push(Kb);var Db=[],Ra=void 0;for(Ra in Ma)Ma.hasOwnProperty(Ra)&&Db.push(Ra);Db.sort();for(Lb=0;Lb<Db.length;Lb+=1)Ra=Db[Lb],Kb[Ra]=wb(Ma[Ra],qb,Vb);qb.pop();Vb.pop()}else Kb=Ma;return Kb}function Xa(Ma,qb){function Vb(Eb,fe){for(var Od=0;Od<Eb.lines.length;Od++){var Hd=Eb.lines[Od],Qc=Hd[0];Hd=Hd.substr(1);if(" "===Qc||"-"===Qc){if(!Ra(fe+1,Kb[fe],Qc,Hd)&&(N++,N>va))return!1;fe++}}return!0}var Lb=2>=arguments.length||void 0===arguments[2]?{}:arguments[2];"string"===typeof qb&&(qb=(0,Ub.parsePatch)(qb));
if(Array.isArray(qb)){if(1<qb.length)throw Error("applyPatch only works with a single input.");qb=qb[0]}for(var Kb=Ma.split("\n"),Db=qb.hunks,Ra=Lb.compareLine||function(Eb,fe,Od,Hd){return fe===Hd},N=0,va=Lb.fuzzFactor||0,Wa=0,pa=0,tb=Lb=void 0,ab=0;ab<Db.length;ab++){var Ob=Db[ab],yc=Kb.length-Ob.oldLines,Ta=0,Bd=pa+Ob.oldStart-1;for(Wa=(0,vc.default)(Bd,Wa,yc);void 0!==Ta;Ta=Wa())if(Vb(Ob,Bd+Ta)){Ob.offset=pa+=Ta;break}if(void 0===Ta)return!1;Wa=Ob.offset+Ob.oldStart+Ob.oldLines}for(pa=0;pa<Db.length;pa++)for(ab=
Db[pa],Ob=ab.offset+ab.newStart-1,0==ab.newLines&&Ob++,Ta=0;Ta<ab.lines.length;Ta++)Wa=ab.lines[Ta],Bd=Wa[0],Wa=Wa.substr(1)," "===Bd?Ob++:"-"===Bd?Kb.splice(Ob,1):"+"===Bd?(Kb.splice(Ob,0,Wa),Ob++):"\\"===Bd&&(Bd=ab.lines[Ta-1]?ab.lines[Ta-1][0]:null,"+"===Bd?Lb=!0:"-"===Bd&&(tb=!0));if(Lb)for(;!Kb[Kb.length-1];)Kb.pop();else tb&&Kb.push("");return Kb.join("\n")}function Za(Ma){if(Array.isArray(Ma)){for(var qb=0,Vb=Array(Ma.length);qb<Ma.length;qb++)Vb[qb]=Ma[qb];return Vb}return Array.from(Ma)}
function Sb(Ma,qb,Vb,Lb,Kb,Db,Ra){function N(Eb){return Eb.map(function(fe){return" "+fe})}Ra||(Ra={context:4});var va=(0,Oc.diffLines)(Vb,Lb);va.push({value:"",lines:[]});for(var Wa=[],pa=0,tb=0,ab=[],Ob=1,yc=1,Ta=function(Eb){var fe=va[Eb],Od=fe.lines||fe.value.replace(/\n$/,"").split("\n");fe.lines=Od;if(fe.added||fe.removed){var Hd;pa||(Eb=va[Eb-1],pa=Ob,tb=yc,Eb&&(ab=0<Ra.context?N(Eb.lines.slice(-Ra.context)):[],pa-=ab.length,tb-=ab.length));(Hd=ab).push.apply(Hd,Za(Od.map(function(oc){return(fe.added?
"+":"-")+oc})));fe.added?yc+=Od.length:Ob+=Od.length}else{if(pa)if(Od.length<=2*Ra.context&&Eb<va.length-2){var Qc;(Qc=ab).push.apply(Qc,Za(N(Od)))}else{var Xd;Hd=Math.min(Od.length,Ra.context);(Xd=ab).push.apply(Xd,Za(N(Od.slice(0,Hd))));Hd={oldStart:pa,oldLines:Ob-pa+Hd,newStart:tb,newLines:yc-tb+Hd,lines:ab};Eb>=va.length-2&&Od.length<=Ra.context&&(Eb=/\n$/.test(Vb),Xd=/\n$/.test(Lb),0!=Od.length||Eb?Eb&&Xd||ab.push("\\ No newline at end of file"):ab.splice(Hd.oldLines,0,"\\ No newline at end of file"));
Wa.push(Hd);tb=pa=0;ab=[]}Ob+=Od.length;yc+=Od.length}},Bd=0;Bd<va.length;Bd++)Ta(Bd);return{oldFileName:Ma,newFileName:qb,oldHeader:Kb,newHeader:Db,hunks:Wa}}function Cb(Ma,qb,Vb,Lb,Kb,Db,Ra){Vb=Sb(Ma,qb,Vb,Lb,Kb,Db,Ra);Lb=[];Ma==qb&&Lb.push("Index: "+Ma);Lb.push("===================================================================");Lb.push("--- "+Vb.oldFileName+("undefined"===typeof Vb.oldHeader?"":"\t"+Vb.oldHeader));Lb.push("+++ "+Vb.newFileName+("undefined"===typeof Vb.newHeader?"":"\t"+Vb.newHeader));
for(Ma=0;Ma<Vb.hunks.length;Ma++)qb=Vb.hunks[Ma],Lb.push("@@ -"+qb.oldStart+","+qb.oldLines+" +"+qb.newStart+","+qb.newLines+" @@"),Lb.push.apply(Lb,qb.lines);return Lb.join("\n")+"\n"}function Da(Ma){Ma=Ma.replace(/&/g,"&amp;");Ma=Ma.replace(/</g,"&lt;");Ma=Ma.replace(/>/g,"&gt;");return Ma=Ma.replace(/"/g,"&quot;")}function zb(Ma){var qb=[],Vb=[];try{var Lb="string"===typeof Ma?aa.parse(Ma):Ma}catch(Kb){return Vb}aa.walk.recursive(Lb,{},{CallExpression:function(Kb,Db,Ra){if(Kb.callee.name&&Kb.callee.name.match(/^(describe|it|describeInBrowser|xdescribe|xit)$/)&&
2<=Kb.arguments.length){var N={title:Kb.arguments[0].value,type:Kb.callee.name.match(/describe/)?"suite":"test"};qb.push(N);var va={fullTitle:aa.arr.pluck(qb,"title").join(" "),type:N.type,node:Kb};Vb.push(va)}aa.walk.base.CallExpression(Kb,Db,Ra);N&&qb.pop()}},Object.assign({},aa.walk.base,{SpreadProperty:function(Kb,Db,Ra){}}));return Vb}function db(Ma){function qb(Vb){var Lb,Kb=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",Db=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,
Ra=(Kb+" "+Vb.title).trim();return(Lb=[{parent:Kb,fullTitle:Ra,title:Vb.title,file:Vb.file,depth:Db,type:"suite"}].concat((Vb.tests||[]).map(function(N){var va=N.title,Wa=N.file;N=N.type;return{state:"",duration:-1,parent:Ra,fullTitle:(Ra+" "+va).trim(),title:va,file:Wa,depth:Db,type:N}}))).concat.apply(Lb,Nd((Vb.suites||[]).map(function(N){return qb(N,Ra,Db+1)})))}return qb(Ma.suite).reduce(function(Vb,Lb){if(!Lb.file)return Vb;var Kb=Vb.find(function(Db){return Db.file===Lb.file});Kb?Kb.tests.push(Lb):
Vb.push({file:Lb.file,tests:[Lb]});return Vb},[])}function ib(Ma,qb){return Ea.apply(this,arguments)}function Ea(){Ea=Tc(regeneratorRuntime.mark(function Lb(qb,Vb){var Kb;return regeneratorRuntime.wrap(function(Db){for(;;)switch(Db.prev=Db.next){case 0:return Db.next=2,qb.resourcesOfPackage(Vb);case 2:return Kb=Db.sent,Db.abrupt("return",Promise.all(Kb.map(function(){var Ra=Tc(regeneratorRuntime.mark(function Wa(va){var pa,tb,ab,Ob;return regeneratorRuntime.wrap(function(yc){for(;;)switch(yc.prev=
yc.next){case 0:pa=va.url;if(pa.endsWith(".js")){yc.next=3;break}return yc.abrupt("return",null);case 3:return yc.next=5,qb.moduleRead(pa);case 5:tb=yc.sent;yc.prev=6;ab=aa.parse(tb);yc.next=13;break;case 10:return yc.prev=10,yc.t0=yc["catch"](6),yc.abrupt("return",null);case 13:if(Ob=aa.query.imports(aa.query.scopes(ab)).some(function(Ta){return Ta.fromModule.includes("mocha-es6")})){yc.next=16;break}return yc.abrupt("return",null);case 16:return yc.prev=16,yc.abrupt("return",aa.testsFromSource(tb).length?
pa:null);case 20:return yc.prev=20,yc.t1=yc["catch"](16),yc.abrupt("return",null);case 23:case "end":return yc.stop()}},Wa,null,[[6,10],[16,20]])}));return function(va){return Ra.apply(this,arguments)}}())).then(function(Ra){return Ra.filter(Boolean)}));case 4:case "end":return Db.stop()}},Lb)}));return Ea.apply(this,arguments)}Lc({findTestModulesInPackage:ib,testsFromMocha:db,testsFromSource:zb});var W={__esModule:!0};W["default"]=yb;yb.prototype={diff:function(Ma,qb){function Vb(ab){return Db?(setTimeout(function(){Db(void 0,
ab)},0),!0):ab}function Lb(){for(var ab=-1*Wa;ab<=Wa;ab+=2){var Ob=tb[ab-1];var yc=tb[ab+1],Ta=(yc?yc.newPos:0)-ab;Ob&&(tb[ab-1]=void 0);var Bd=Ob&&Ob.newPos+1<N;Ta=yc&&0<=Ta&&Ta<va;if(Bd||Ta){!Bd||Ta&&Ob.newPos<yc.newPos?(Ob={newPos:yc.newPos,components:yc.components.slice(0)},Ra.pushComponent(Ob.components,void 0,!0)):(Ob.newPos++,Ra.pushComponent(Ob.components,!0,void 0));Ta=Ra.extractCommon(Ob,qb,Ma,ab);if(Ob.newPos+1>=N&&Ta+1>=va)return Vb(ba(Ra,Ob.components,qb,Ma,Ra.useLongestToken));tb[ab]=
Ob}else tb[ab]=void 0}Wa++}var Kb=2>=arguments.length||void 0===arguments[2]?{}:arguments[2],Db=Kb.callback;"function"===typeof Kb&&(Db=Kb,Kb={});this.options=Kb;var Ra=this;Ma=this.castInput(Ma);qb=this.castInput(qb);Ma=this.removeEmpty(this.tokenize(Ma));qb=this.removeEmpty(this.tokenize(qb));var N=qb.length,va=Ma.length,Wa=1,pa=N+va,tb=[{newPos:-1,components:[]}];Kb=this.extractCommon(tb[0],qb,Ma,0);if(tb[0].newPos+1>=N&&Kb+1>=va)return Vb([{value:qb.join(""),count:qb.length}]);if(Db)(function Ob(){setTimeout(function(){if(Wa>
pa)return Db();Lb()||Ob()},0)})();else for(;Wa<=pa;)if(Kb=Lb())return Kb},pushComponent:function(Ma,qb,Vb){var Lb=Ma[Ma.length-1];Lb&&Lb.added===qb&&Lb.removed===Vb?Ma[Ma.length-1]={count:Lb.count+1,added:qb,removed:Vb}:Ma.push({count:1,added:qb,removed:Vb})},extractCommon:function(Ma,qb,Vb,Lb){var Kb=qb.length,Db=Vb.length,Ra=Ma.newPos;Lb=Ra-Lb;for(var N=0;Ra+1<Kb&&Lb+1<Db&&this.equals(qb[Ra+1],Vb[Lb+1]);)Ra++,Lb++,N++;N&&Ma.components.push({count:N});Ma.newPos=Ra;return Lb},equals:function(Ma,qb){return Ma===
qb},removeEmpty:function(Ma){for(var qb=[],Vb=0;Vb<Ma.length;Vb++)Ma[Vb]&&qb.push(Ma[Vb]);return qb},castInput:function(Ma){return Ma},tokenize:function(Ma){return Ma.split("")}};var T=new (W&&W.__esModule?W:{"default":W})["default"],ia={__esModule:!0,generateOptions:function(Ma,qb){if("function"===typeof Ma)qb.callback=Ma;else if(Ma)for(var Vb in Ma)Ma.hasOwnProperty(Vb)&&(qb[Vb]=Ma[Vb]);return qb}},ka=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,K=/\S/,ya=new (W&&W.__esModule?
W:{default:W}).default;ya.equals=function(Ma,qb){return Ma===qb||this.options.ignoreWhitespace&&!K.test(Ma)&&!K.test(qb)};ya.tokenize=function(Ma){Ma=Ma.split(/(\s+|\b)/);for(var qb=0;qb<Ma.length-1;qb++)!Ma[qb+1]&&Ma[qb+2]&&ka.test(Ma[qb])&&ka.test(Ma[qb+2])&&(Ma[qb]+=Ma[qb+2],Ma.splice(qb+1,2),qb--);return Ma};var pb={__esModule:!0,lineDiff:void 0,diffLines:function(Ma,qb,Vb){return eb.diff(Ma,qb,Vb)},diffTrimmedLines:function(Ma,qb,Vb){Vb=(0,La.generateOptions)(Vb,{ignoreWhitespace:!0});return eb.diff(Ma,
qb,Vb)}},La=ia,eb=pb.lineDiff=new (W&&W.__esModule?W:{default:W}).default;eb.tokenize=function(Ma){var qb=[];Ma=Ma.split(/(\n|\r\n)/);Ma[Ma.length-1]||Ma.pop();for(var Vb=0;Vb<Ma.length;Vb++){var Lb=Ma[Vb];Vb%2&&!this.options.newlineIsToken?qb[qb.length-1]+=Lb:(this.options.ignoreWhitespace&&(Lb=Lb.trim()),qb.push(Lb))}return qb};var jb=new (W&&W.__esModule?W:{default:W}).default;jb.tokenize=function(Ma){return Ma.split(/(\S.+?[.!?])(?=\s+|$)/)};var E=new (W&&W.__esModule?W:{default:W}).default;E.tokenize=
function(Ma){return Ma.split(/([{}:;,]|\s+)/)};var Wb="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(Ma){return typeof Ma}:function(Ma){return Ma&&"function"===typeof Symbol&&Ma.constructor===Symbol?"symbol":typeof Ma},R=W&&W.__esModule?W:{default:W},xb=Object.prototype.toString,Ja=new R.default;Ja.useLongestToken=!0;Ja.tokenize=pb.lineDiff.tokenize;Ja.castInput=function(Ma){return"string"===typeof Ma?Ma:JSON.stringify(wb(Ma),void 0,"  ")};Ja.equals=function(Ma,qb){return R.default.prototype.equals(Ma.replace(/,([\r\n])/g,
"$1"),qb.replace(/,([\r\n])/g,"$1"))};var Ga={__esModule:!0,parsePatch:function(Ma){function qb(){var va={};for(Ra.push(va);N<Db.length;){var Wa=Db[N];if(/^(\-\-\-|\+\+\+|@@)\s/.test(Wa))break;if(Wa=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(Wa))va.index=Wa[1];N++}Vb(va);Vb(va);for(va.hunks=[];N<Db.length&&(Wa=Db[N],!/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(Wa));)if(/^@@/.test(Wa))va.hunks.push(Lb());else{if(Wa&&Kb.strict)throw Error("Unknown line "+(N+1)+" "+JSON.stringify(Wa));N++}}function Vb(va){var Wa=
/^(---|\+\+\+)\s+([\S ]*)(?:\t(.*?)\s*)?$/.exec(Db[N]);if(Wa){var pa="---"===Wa[1]?"old":"new";va[pa+"FileName"]=Wa[2];va[pa+"Header"]=Wa[3];N++}}function Lb(){var va=N,Wa=Db[N++].split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/);Wa={oldStart:+Wa[1],oldLines:+Wa[2]||1,newStart:+Wa[3],newLines:+Wa[4]||1,lines:[]};for(var pa=0,tb=0;N<Db.length;N++){var ab=Db[N][0];if("+"===ab||"-"===ab||" "===ab||"\\"===ab)Wa.lines.push(Db[N]),"+"===ab?pa++:"-"===ab?tb++:" "===ab&&(pa++,tb++);else break}pa||1!==Wa.newLines||
(Wa.newLines=0);tb||1!==Wa.oldLines||(Wa.oldLines=0);if(Kb.strict){if(pa!==Wa.newLines)throw Error("Added line count did not match for hunk at line "+(va+1));if(tb!==Wa.oldLines)throw Error("Removed line count did not match for hunk at line "+(va+1));}return Wa}for(var Kb=1>=arguments.length||void 0===arguments[1]?{}:arguments[1],Db=Ma.split("\n"),Ra=[],N=0;N<Db.length;)qb();return Ra}},sa={__esModule:!0,default:function(Ma,qb,Vb){var Lb=!0,Kb=!1,Db=!1,Ra=1;return function va(){if(Lb&&!Db){Kb?Ra++:
Lb=!1;if(Ma+Ra<=Vb)return Ra;Db=!0}if(!Kb){Db||(Lb=!0);if(qb<=Ma-Ra)return-Ra++;Kb=!0;return va()}}}},Ub=Ga,vc=sa&&sa.__esModule?sa:{default:sa},Oc=pb;sa={__esModule:!0};sa.canonicalize=sa.convertChangesToXML=sa.convertChangesToDMP=sa.parsePatch=sa.applyPatches=sa.applyPatch=sa.createPatch=sa.createTwoFilesPatch=sa.structuredPatch=sa.diffJson=sa.diffCss=sa.diffSentences=sa.diffTrimmedLines=sa.diffLines=sa.diffWordsWithSpace=sa.diffWords=sa.diffChars=sa.Diff=void 0;sa.Diff=(W&&W.__esModule?W:{default:W}).default;
sa.diffChars=function(Ma,qb,Vb){return T.diff(Ma,qb,Vb)};sa.diffWords=function(Ma,qb,Vb){Vb=(0,ia.generateOptions)(Vb,{ignoreWhitespace:!0});return ya.diff(Ma,qb,Vb)};sa.diffWordsWithSpace=function(Ma,qb,Vb){return ya.diff(Ma,qb,Vb)};sa.diffLines=pb.diffLines;sa.diffTrimmedLines=pb.diffTrimmedLines;sa.diffSentences=function(Ma,qb,Vb){return jb.diff(Ma,qb,Vb)};sa.diffCss=function(Ma,qb,Vb){return E.diff(Ma,qb,Vb)};sa.diffJson=function(Ma,qb,Vb){return Ja.diff(Ma,qb,Vb)};sa.structuredPatch=Sb;sa.createTwoFilesPatch=
Cb;sa.createPatch=function(Ma,qb,Vb,Lb,Kb,Db){return Cb(Ma,Ma,qb,Vb,Lb,Kb,Db)};sa.applyPatch=Xa;sa.applyPatches=function(Ma,qb){function Vb(){var Kb=Ma[Lb++];if(!Kb)return qb.complete();qb.loadFile(Kb,function(Db,Ra){if(Db)return qb.complete(Db);Db=Xa(Ra,Kb,qb);qb.patched(Kb,Db,function(N){if(N)return qb.complete(N);Vb()})})}"string"===typeof Ma&&(Ma=(0,Ub.parsePatch)(Ma));var Lb=0;Vb()};sa.parsePatch=Ga.parsePatch;sa.convertChangesToDMP=function(Ma){for(var qb=[],Vb,Lb,Kb=0;Kb<Ma.length;Kb++)Vb=
Ma[Kb],Lb=Vb.added?1:Vb.removed?-1:0,qb.push([Lb,Vb.value]);return qb};sa.convertChangesToXML=function(Ma){for(var qb=[],Vb=0;Vb<Ma.length;Vb++){var Lb=Ma[Vb];Lb.added?qb.push("<ins>"):Lb.removed&&qb.push("<del>");qb.push(Da(Lb.value));Lb.added?qb.push("</ins>"):Lb.removed&&qb.push("</del>")}return qb.join("")};sa.canonicalize=wb;sa.__esModule;sa.canonicalize;sa.convertChangesToXML;sa.convertChangesToDMP;sa.parsePatch;sa.applyPatches;sa.applyPatch;sa.createPatch;sa.createTwoFilesPatch;sa.structuredPatch;
sa.diffJson;sa.diffCss;sa.diffSentences;sa.diffTrimmedLines;sa.diffLines;sa.diffWordsWithSpace;sa.diffWords;sa.diffChars;sa.Diff;var aa=window.lively.FreezerRuntime.recorderFor("lively.ide/test-runner.js");aa.testsFromSource=zb;aa.testsFromMocha=db;aa.findTestModulesInPackage=ib;aa.arr=Jc;aa.promise=$d;aa.obj=Bb;aa.chain=rd;aa.fun=Id;aa.query=Ac;aa.parse=Pc;aa.walk=gd;aa.pt=nd;aa.Color=Fd;aa.HTMLMorph=ic;aa.connect=vd;aa.EvalBackendChooser=hb;aa.LoadingIndicator=ub;aa.JavaScriptEditorPlugin=cb;aa.resource=
sb;aa.packagesConfig=Hb;aa.localInterface=ec;aa.jsDiff=sa;aa.testsFromSource=zb;aa.testsFromMocha=db;aa.findTestModulesInPackage=ib;aa.testRunnerCSS='\n\n.mocha-test-runner {\n  font-family: IBM Plex Sans,Arial,sans-serif;\n  font-size: 12px;\n  line-height: 1.5em;\n  height: 100%;\n}\n\n.mocha-test-runner .controls input {\n  display: inline;\n}\n\n.mocha-test-runner .row h2 {\n  display: inline;\n  margin: 2px 4px;\n  font-size: small;\n}\n\n.mocha-test-runner .row.test-file {\n  margin-top: 0px;\n}\n\n.controls {\n  pointer-events: auto;\n  margin: 6px 6px;\n}\n\n.mocha-test-runner .row {\n  white-space: wrap;\n}\n\n.mocha-test-runner .suites {\n  pointer-events: auto;\n  overflow-y: auto;\n  overflow-x: hidden;\n  height: calc(100% - 30px);\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  background: rgba(0,0,0,0.5);\n}\n\n.mocha-test-runner .suite {\n  font-weight: bold;\n}\n\n.mocha-test-runner .collapse-button {\n  font-weight: bold;\n}\n\n.mocha-test-runner .collapse-button.collapsed {\n  font-weight: bold;\n}\n\n.mocha-test-runner .row {\n/*line-height: 2.2;*/\n}\n\n.mocha-test-runner .run-button {\n  color: rgb(30,30,30);\n  border: rgb(150,150,150) 1px solid;\n  font-size: 12px;\n  border-radius: 5px;\n  padding: 2px 8px;\n  cursor: pointer;\n}\n\n.mocha-test-runner .run-button:active {\n  background-color: rgb(200,200,200);\n}\n\n.row .run-button {\n  font-size: 11px;\n}\n\n.mocha-test-runner .heading .run-button, .row .run-button, .row .remove-button {\n  display: none;\n}\n\n.mocha-test-runner .heading:hover .run-button, .row:hover .run-button, .row:hover .remove-button {\n  display: inline;\n}\n\n.mocha-test-runner .test-file, .suite, .test, .collapse-button {\n  cursor: pointer;\n}\n\n.mocha-test-runner .suite, .test {\n  padding: 2px;\n/*outline: 1px red solid;*/\n}\n\n.mocha-test-runner .row.collapsed {\n  display: none;\n}\n\n.mocha-test-runner .hidden {\n  display: none;\n}\n\n.mocha-test-runner .suite .running::before, .test .running::before {\n  content: "\u261b ";\n}\n\n.mocha-test-runner .failed {\n  background-color: red;\n  color: white;\n}\n\n.mocha-test-runner .succeeded {\n  background-color: #60d610;\n  color: white;\n}\n\n.mocha-test-runner .duration {\n  font-size: 80%;\n}\n\n.mocha-test-runner .duration.slow {\n  color: yellow;\n}\n\n.mocha-test-runner .duration.very-slow {\n  color: red;\n}';
W=Lc("default",function(Ma){var qb=window.lively.FreezerRuntime.recorderFor("lively.ide/test-runner.js"),Vb=qb.hasOwnProperty("TestRunner")&&"function"===typeof qb.TestRunner?qb.TestRunner:qb.TestRunner=function(Lb){if(!Lb||!Lb[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Xb(Vb,Ma,[{key:Symbol["for"]("lively-instance-initialize"),value:function(Lb){Xb._get(Object.getPrototypeOf(Vb.prototype),Symbol["for"]("lively-instance-initialize"),
this).call(this,Lb);this.reset();aa.connect(this,"extent",this,"relayout")}},{key:"onLoad",value:function(){var Lb=Tc(regeneratorRuntime.mark(function Db(){return regeneratorRuntime.wrap(function(Ra){for(;;)switch(Ra.prev=Ra.next){case 0:return Ra.next=2,pd.import("mocha-es6");case 2:return Ra.next=4,aa.promise.waitFor(3E4,function(){return!!$world});case 4:return aa.resource(document.URL).query().runAllTests&&this.runAllTests(),Ra.next=7,this.whenRendered();case 7:this.update();case 8:case "end":return Ra.stop()}},
Db,this)}));return function(){return Lb.apply(this,arguments)}}()},{key:"reset",value:function(){var Lb=this.getWindow();Lb&&(Lb.extent=aa.pt(500,600));this.state={grep:null,loadedTests:[],collapsedSuites:{}};this.addMorph(aa.EvalBackendChooser["default"].ensureEvalBackendDropdown(this,null));this.update()}},{key:"relayout",value:function(){this.get("eval backend button").topRight=this.innerBounds().insetBy(5).topRight()}},{key:"setEvalBackend",value:function(Lb){this.editorPlugin.setSystemInterfaceNamed(Lb)}},
{key:"findBrowserForFile",value:function(Lb){var Kb=this.world();return Kb.getWindows().map(function(Db){return Db.targetMorph}).filter(function(Db){return Db.isBrowser}).find(function(Db){return(Db=Db.selectedModule)&&Db.url===Lb})||Kb.execCommand("open browser",null)}},{key:"jumpToTest",value:function(){var Lb=Tc(regeneratorRuntime.mark(function N(Db,Ra){var va,Wa,pa,tb,ab;return regeneratorRuntime.wrap(function(Ob){for(;;)switch(Ob.prev=Ob.next){case 0:return va=aa.LoadingIndicator.open("Scanning source code..."),
Ob.prev=1,Ob.next=4,this.findBrowserForFile(Ra);case 4:return Wa=Ob.sent,Wa.getWindow().activate(),Ob.next=8,Wa.searchForModuleAndSelect(Ra);case 8:pa=Wa.editorPlugin.textMorph;tb=aa.testsFromSource(pa.textString);if(ab=tb.find(function(yc){return yc.fullTitle===Db.fullTitle})){Ob.next=13;break}throw Error("Cannot find test ".concat(Db.title," in file ").concat(Ra));case 13:pa.selection=pa.astNodeRange(ab.node);pa.centerRow(pa.selection.start.row);Ob.next=20;break;case 17:Ob.prev=17,Ob.t0=Ob["catch"](1),
this.showError(Ob.t0);case 20:return Ob.prev=20,va.remove(),Ob.finish(20);case 23:case "end":return Ob.stop()}},N,this,[[1,17,20,23]])}));return function(Db,Ra){return Lb.apply(this,arguments)}}()},{key:"showError",value:function(Lb){this.world()&&this.world().logError(Lb)}},{key:"removeTestFile",value:function(Lb){var Kb=this.state,Db=Kb.loadedTests,Ra=Kb.collapsedSuites;if(Kb=Db.find(function(N){return N.file===Lb}))aa.arr.remove(Db,Kb),[Lb].concat(aa.arr.pluck(Kb.tests,"fullTitle")).forEach(function(N){return delete Ra[N]});
this.update()}},{key:"runAllTests",value:function(){var Lb=Tc(regeneratorRuntime.mark(function Db(){var Ra,N,va,Wa;return regeneratorRuntime.wrap(function(pa){for(;;)switch(pa.prev=pa.next){case 0:Ra=aa.arr.pluck(this.state.loadedTests,"file"),pa.prev=1,N=bc(Ra),pa.prev=3,N.s();case 5:if((va=N.n()).done){pa.next=11;break}Wa=va.value;pa.next=9;return this.runTestFile(Wa);case 9:pa.next=5;break;case 11:pa.next=16;break;case 13:pa.prev=13,pa.t0=pa["catch"](3),N.e(pa.t0);case 16:return pa.prev=16,N.f(),
pa.finish(16);case 19:pa.next=24;break;case 21:pa.prev=21,pa.t1=pa["catch"](1),this.world().logError(pa.t1);case 24:case "end":return pa.stop()}},Db,this,[[1,21],[3,13,16,19]])}));return function(){return Lb.apply(this,arguments)}}()},{key:"runSuite",value:function(){var Lb=Tc(regeneratorRuntime.mark(function Ra(Db){var N,va,Wa;return regeneratorRuntime.wrap(function(pa){for(;;)switch(pa.prev=pa.next){case 0:if(N=this.state.loadedTests.find(function(tb){return tb.tests.some(function(ab){return ab.fullTitle===
Db})})){pa.next=3;break}throw Error("Cannot find test file for test "+Db);case 3:return va=new RegExp("^"+Db.replace(/\*/g,"\\*")+".*"),pa.next=6,this.runTestFile(N.file,va);case 6:if(Wa=this.state.loadedTests.find(function(tb){return tb.file===N.file}))Wa.tests=Wa.tests.map(function(tb){return tb.fullTitle.match(va)?tb:N.tests.find(function(ab){return ab.fullTitle===tb.fullTitle})||tb}),this.update();pa.next=10;return this.scrollIntoView(Db);case 10:case "end":return pa.stop()}},Ra,this)}));return function(Db){return Lb.apply(this,
arguments)}}()},{key:"runTest",value:function(Lb){return this.runSuite(Lb)}},{key:"runTestFile",value:function(){var Lb=Tc(regeneratorRuntime.mark(function va(Db,Ra,N){var Wa,pa;return regeneratorRuntime.wrap(function(tb){for(;;)switch(tb.prev=tb.next){case 0:return System._testsRunning=!0,tb.prev=1,this.state.loadedTests||(this.state.loadedTests=[]),this.state.loadedTests.some(function(ab){return ab.file===Db})||this.state.loadedTests.push({file:Db,tests:[]}),Wa=this.state.loadedTests.findIndex(function(ab){return ab.file===
Db}),tb.next=7,this.runTestFiles([Db],Ra,N);case 7:return pa=tb.sent,this.state.loadedTests[Wa]=pa.find(function(ab){return ab.file===Db}),this.update(),tb.abrupt("return",this.state.loadedTests[Wa]);case 11:return tb.prev=11,System._testsRunning=!1,tb.finish(11);case 14:case "end":return tb.stop()}},va,this,[[1,,11,14]])}));return function(Db,Ra,N){return Lb.apply(this,arguments)}}()},{key:"runTestFiles",value:function(){var Lb=Tc(regeneratorRuntime.mark(function va(Db,Ra,N){var Wa=this,pa,tb;return regeneratorRuntime.wrap(function(ab){for(;;)switch(ab.prev=
ab.next){case 0:return pa=Db.map(function(Ob){return{file:Ob,tests:[]}}),Ra=Ra||this.state.grep||/.*/,ab.prev=2,ab.next=5,this.systemInterface.runMochaTests(Ra,pa,function(){return Wa.update()},function(Ob,yc){return Wa.showError("Error during ".concat(yc,": ").concat(Ob))});case 5:tb=ab.sent;if(!tb||!tb.isError){ab.next=8;break}throw Error(tb.value.stack||tb.value);case 8:if(tb&&tb.testsByFile){ab.next=10;break}throw Error("No test results when runnin tests of ".concat(Db));case 10:return ab.abrupt("return",
tb.testsByFile);case 13:return ab.prev=13,ab.t0=ab["catch"](2),this.showError(ab.t0),ab.next=18,this.update();case 18:throw ab.t0;case 19:case "end":return ab.stop()}},va,this,[[2,13]])}));return function(Db,Ra,N){return Lb.apply(this,arguments)}}()},{key:"updateEvalBackendForPackage",value:function(Lb){this.systemInterface=Lb?aa.EvalBackendChooser["default"].httpEvalBackends[0]:aa.localInterface}},{key:"runTestsInPackage",value:function(){var Lb=Tc(regeneratorRuntime.mark(function Ra(Db){var N,va,
Wa,pa,tb,ab,Ob;return regeneratorRuntime.wrap(function(yc){for(;;)switch(yc.prev=yc.next){case 0:return yc.next=2,aa.packagesConfig();case 2:return N=yc.sent,va=N.find(function(Ta){return Ta.name===Db}).wantsServerInterface,this.updateEvalBackendForPackage(va),yc.next=7,aa.findTestModulesInPackage(this.systemInterface,Db);case 7:Wa=yc.sent,pa=[],tb=bc(Wa),yc.prev=10,tb.s();case 12:if((ab=tb.n()).done){yc.next=21;break}Ob=ab.value;yc.t0=pa;yc.next=17;return this.runTestFile(Ob);case 17:yc.t1=yc.sent,
yc.t0.push.call(yc.t0,yc.t1);case 19:yc.next=12;break;case 21:yc.next=26;break;case 23:yc.prev=23,yc.t2=yc["catch"](10),tb.e(yc.t2);case 26:return yc.prev=26,tb.f(),yc.finish(26);case 29:return yc.abrupt("return",pa);case 30:case "end":return yc.stop()}},Ra,this,[[10,23,26,29]])}));return function(Db){return Lb.apply(this,arguments)}}()},{key:"collapseAll",value:function(){var Lb=this;this.state.collapsedSuites={};aa.chain(this.state.loadedTests).pluck("tests").flat().filter(function(Kb){return"suite"===
Kb.type&&Kb.fullTitle}).forEach(function(Kb){return Lb.state.collapsedSuites[Kb.fullTitle]=!0});aa.arr.pluck(this.state.loadedTests,"file").forEach(function(Kb){return Lb.state.collapsedSuites[Kb]=!0});this.update()}},{key:"collapseToggle",value:function(){this[0===Object.keys(this.state.collapsedSuites).length?"collapseAll":"uncollapseAll"]()}},{key:"uncollapseAll",value:function(){this.state.collapsedSuites={};this.update()}},{key:"onClickCollapseButton",value:function(Lb,Kb,Db){Lb=Lb.shiftKey;
var Ra=this.state.collapsedSuites,N=this.state.loadedTests;Kb in Ra?(delete Ra[Kb],Lb&&(Db===Kb?(Lb=N.find(function(va){return va.file===Db}))&&Lb.tests.forEach(function(va){return delete Ra[va.fullTitle]}):Object.keys(Ra).forEach(function(va){return 0===va.indexOf(Kb)&&delete Ra[va]}))):(Ra[Kb]=!0,Lb&&(Lb=N.find(function(va){return va.file===Db}),Db===Kb?Lb&&Lb.tests.forEach(function(va){return"suite"===va.type&&1<=va.depth&&(Ra[va.fullTitle]=!0)}):Lb&&Lb.tests.forEach(function(va){return"suite"===
va.type&&0===va.fullTitle.indexOf(Kb)&&(Ra[va.fullTitle]=!0)})));this.update()}},{key:"onClickTest",value:function(){var Lb=Tc(regeneratorRuntime.mark(function va(Db,Ra,N){return regeneratorRuntime.wrap(function(Wa){for(;;)switch(Wa.prev=Wa.next){case 0:return Wa.prev=0,Wa.next=3,this.jumpToTest({fullTitle:Ra},N);case 3:Wa.next=8;break;case 5:Wa.prev=5,Wa.t0=Wa["catch"](0),this.showError(Wa.t0);case 8:case "end":return Wa.stop()}},va,this,[[0,5]])}));return function(Db,Ra,N){return Lb.apply(this,
arguments)}}()},{key:"onClickError",value:function(Lb,Kb,Db){Lb=this.state.loadedTests.find(function(N){return N.file===Db}).tests.find(function(N){return N.fullTitle===Kb});if(this.stringifyExpectedAndActualOfError(Lb.error)&&Lb.error.actual&&Lb.error.expected)this.world().execCommand("diff and open in window",{a:Lb.error.actual,b:Lb.error.expected,title:Lb.fullTitle});else{var Ra=this.world().execCommand("open text window",{title:Lb.fullTitle,content:Lb.error+"\n"+Lb.error.stack});setTimeout(function(){return Ra.activate()})}}},
{key:"onClickFile",value:function(){var Lb=Tc(regeneratorRuntime.mark(function N(Db,Ra){var va;return regeneratorRuntime.wrap(function(Wa){for(;;)switch(Wa.prev=Wa.next){case 0:return Wa.prev=0,Wa.next=3,this.findBrowserForFile(Ra);case 3:return va=Wa.sent,va.getWindow().activate(),Wa.next=7,va.searchForModuleAndSelect(Ra);case 7:Wa.next=12;break;case 9:Wa.prev=9,Wa.t0=Wa["catch"](0),this.showError(Wa.t0);case 12:case "end":return Wa.stop()}},N,this,[[0,9]])}));return function(Db,Ra){return Lb.apply(this,
arguments)}}()},{key:"onClickSuite",value:function(Lb,Kb,Db){this.onClickTest(Lb,Kb,Db)}},{key:"update",value:function(){var Lb=this;return new Promise(function(Kb,Db){aa.fun.throttleNamed(Lb.id+"-update",100,function(){return Kb(Lb.renderTests(Lb.state))})()})}},{key:"ensureScrollPosition",value:function(){var Lb=this.domNode.getElementsByClassName("suites");Nb(Lb,1)[0].scrollTop=this._currentScrollY||0}},{key:"htmlRef",get:function(){return"System.get(System.normalizeSync('lively.morphic')).MorphicEnv.default().world.getMorphWithId('".concat(this.id,
"')")}},{key:"afterRenderHook",value:function(){this.ensureScrollPosition()}},{key:"renderTests",value:function(){var Lb=Tc(regeneratorRuntime.mark(function Ra(Db){var N=this,va,Wa,pa,tb,ab,Ob,yc,Ta,Bd,Eb;return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:va=Object.keys(Db.collapsedSuites),Wa=Db.loadedTests||[],pa=Wa.find(function(Od){return"running"===Od.state}),tb=[],ab=bc(Wa),fe.prev=5,yc=regeneratorRuntime.mark(function Hd(){var Qc;return regeneratorRuntime.wrap(function(Xd){for(;;)switch(Xd.prev=
Xd.next){case 0:return Qc=Ob.value,Xd.t0=tb,Xd.next=4,N.renderFile(Qc.file,Qc.tests,va);case 4:Xd.t1=Xd.sent,Xd.t2=Qc.tests.slice(1).map(function(oc){return"test"===oc.type?N.renderTest(oc,Qc.tests,Qc.file,va):N.renderSuite(oc,Qc.tests,Qc.file,va)}).join("\n"),Xd.t3=Xd.t1+Xd.t2,Xd.t0.push.call(Xd.t0,Xd.t3);case 8:case "end":return Xd.stop()}},Hd)}),ab.s();case 8:if((Ob=ab.n()).done){fe.next=12;break}return fe.delegateYield(yc(),"t0",10);case 10:fe.next=8;break;case 12:fe.next=17;break;case 14:fe.prev=
14,fe.t1=fe["catch"](5),ab.e(fe.t1);case 17:return fe.prev=17,ab.f(),fe.finish(17);case 20:return this.html='\n       <div class="mocha-test-runner">\n       <div class="controls" '.concat(this.showControls?"":'style="display: none;"','>\n         <input type="button" class="load-test-button run-button" value="load test" onmousedown="').concat(this.htmlRef,'.interactivelyloadTests()"></input>\n         <input type="button" class="run-button" value="run all" onmouseup="').concat(this.htmlRef,'.runAllTests()"></input>\n         <input type="button" class="collapse-button run-button" value="toggle collapse" onmousedown="').concat(this.htmlRef,
'.collapseToggle()"></input>\n         <span class="').concat(pa?"":"hidden",'">Running: ').concat(pa&&pa.title,'</span>\n       </div>\n       <div class="suites">').concat(tb.join("\n"),"</div>\n       <div>"),fe.next=23,this.whenRendered();case 23:Ta=this.domNode.getElementsByClassName("suites"),Bd=Nb(Ta,1),Eb=Bd[0],Eb.onscroll=function(){N._currentScrollY=Eb.scrollTop},this.ensureScrollPosition();case 26:case "end":return fe.stop()}},Ra,this,[[5,14,17,20]])}));return function(Db){return Lb.apply(this,
arguments)}}()},{key:"renderTest",value:function(Lb,Kb,Db,Ra){var N=Lb.fullTitle;Kb=Ra.includes(Db)||(Ra||[]).some(function(pa){return 0===N.indexOf(pa)});Ra=["test",Lb.state];var va=10*Lb.depth+20,Wa=Lb.title;return'<div class="row '.concat(Kb?"collapsed":""," ").concat(Ra.join(" "),'">\n              <span\n                class="').concat(Ra.join(" "),'"\n                onmousedown="').concat(this.htmlRef,".onClickTest(event, '").concat(N,"', '").concat(Db,'\', this);"\n                id="').concat(N,
'"\n                style="margin-left: ').concat(va,'px;"\n                >').concat(Wa,'</span>\n              <span\n                class="duration\n                ').concat(Lb.duration?"":"hidden","\n                ").concat(500<Lb.duration?"very-slow":100<Lb.duration?"slow":"",'"\n                >').concat(Lb.duration,'ms</span>\n              <input\n                type="button" class="run-button" value="run"\n                onmousedown="').concat(this.htmlRef,".runTest('").concat(N,
'\')"></input>\n              <div\n                onmousedown="').concat(this.htmlRef,".onClickError(event, '").concat(N,"', '").concat(Db,'\', this);"\n                class="error ').concat(Lb.error?"":"hidden",'"\n                style="margin-left: ').concat(va+10,'px;"\n                >').concat(this.renderError(Lb),"\n              </div>\n            </div>")}},{key:"renderSuite",value:function(Lb,Kb,Db,Ra){var N=Lb.fullTitle,va=Kb.filter(function(ab){return"test"===ab.type&&0===ab.fullTitle.indexOf(Lb.fullTitle)});
Kb=aa.arr.sum(aa.arr.compact(va.map(function(ab){return ab.duration})));va=["suite",(va||[]).some(function(ab){return"failed"===ab.state})?"failed":va.every(function(ab){return"succeeded"===ab.state})?"succeeded":""];var Wa=Ra.filter(function(ab){return 0===N.indexOf(ab)});Ra=Ra.includes(Db)||(Wa||[]).some(function(ab){return ab.length<N.length});Wa=!Ra&&!!Wa.length;var pa=10*Lb.depth,tb=Lb.title;return'<div class="row '.concat(Ra?"collapsed":""," ").concat(va.join(" "),'">\n              <span\n                class="collapse-button ').concat(Wa?
"collapsed":"",'"\n                onmousedown="').concat(this.htmlRef,".onClickCollapseButton(event, '").concat(N,"', '").concat(Db,'\', this);"\n                style="margin-left: ').concat(pa,'px;">').concat(Wa?"\u25ba ":"\u25bc ",'</span>\n              <span\n                class="').concat(va.join(" "),'"\n                onmousedown="').concat(this.htmlRef,".onClickSuite(event, '").concat(N,"', '").concat(Db,'\', this);"\n                id="').concat(N,'">').concat(tb,'</span>\n              <span class="duration">').concat(Kb,
'ms</span>\n              <input\n                type="button" class="run-button" value="run"\n                onmousedown="').concat(this.htmlRef,".runSuite('").concat(N,"')\"></input>\n            </div>")}},{key:"renderFile",value:function(){var Lb=Tc(regeneratorRuntime.mark(function va(Db,Ra,N){var Wa,pa,tb,ab,Ob,yc,Ta,Bd,Eb;return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return Wa=Db,pa=Ra.filter(function(Od){return"test"===Od.type}),tb=aa.arr.sum(aa.arr.compact(pa.map(function(Od){return Od.duration}))),
ab=(pa||[]).some(function(Od){return"failed"===Od.state})?"failed":pa.every(function(Od){return"succeeded"===Od.state})?"succeeded":"",Ob=this.systemInterface,fe.next=7,Ob.getPackageForModule(Wa);case 7:return Ta=(yc=fe.sent)?yc.name+"/"+Ob.shortModuleName(Wa,yc):Wa,Bd=["test-file",ab],Eb=N.includes(Wa),fe.abrupt("return",'<div class="row '.concat(Bd.join(" "),'">\n              <span\n                class="collapse-button ').concat(Eb?"collapsed":"",'"\n                onmousedown="').concat(this.htmlRef,
".onClickCollapseButton(event, '").concat(Wa,"', '").concat(Db,"', this);\">\n                ").concat(Eb?"\u25ba ":"\u25bc ",'</span>\n              <h2 class="').concat(Bd.join(" "),'"\n                  onmousedown="').concat(this.htmlRef,".onClickFile(event, '").concat(Wa,"', this);\"\n               >").concat(Ta,'</h2>\n              <span class="duration">').concat(tb,'ms</span>\n              <input\n                type="button" class="run-button" value="run"\n                onmousedown="').concat(this.htmlRef,
".runTestFile('").concat(Wa,'\')"></input>\n              <i class="far fa-window-close remove-button"\n                 onmousedown="').concat(this.htmlRef,".removeTestFile('").concat(Wa,"')\"></i>\n            </div>"));case 12:case "end":return fe.stop()}},va,this)}));return function(Db,Ra,N){return Lb.apply(this,arguments)}}()},{key:"renderError",value:function(Lb){function Kb(N,va){return aa.jsDiff.diffLines(N,va).reduce(function(Wa,pa){return pa.added||pa.removed?pa.added?Wa.concat("+ "+pa.value.replace(/\n?$/,
"\n")):pa.removed?Wa.concat("- "+pa.value.replace(/\n?$/,"\n")):Wa.concat("???\n"):"  ..."===aa.arr.last(Wa)?Wa:Wa.concat("  ...\n")},[]).join("")}if(!Lb.error)return"";var Db=Lb.error.message?"<p>".concat(Lb.error.message,"</p>"):"";if(!Lb.error.actual||!Lb.error.expected)return"".concat(Db,"<pre>").concat(Lb.error.stack||Lb.error,"</pre>");var Ra=this.stringifyExpectedAndActualOfError(Lb.error);return aa.jsDiff&&Ra&&Ra.expected&&Ra.actual?"".concat(Db,"<p>diff + = actual, - = expected:</p><pre>").concat(Kb(Ra.expected,
Ra.actual),"</pre>"):"".concat(Db,"<p>expected:</p><pre>").concat(String(Lb.error.expected),"</pre><p>actual:</p><pre>").concat(String(Lb.error.actual),"</pre>")}},{key:"stringifyExpectedAndActualOfError",value:function(Lb){function Kb(Db){if("function"===typeof Db)return String(Db);if("string"===typeof Db)return Db;try{return JSON.stringify(Db,null,2)}catch(Ra){}try{return aa.obj.inspect(Db,{maxDepth:3})}catch(Ra){}return String(Db)}return Lb.expected&&Lb.actual?{expected:Kb(Lb.expected),actual:Kb(Lb.actual)}:
null}},{key:"scrollIntoView",value:function(Lb){(Lb=document.getElementById(Lb))&&Lb.scrollIntoViewIfNeeded?Lb.scrollIntoViewIfNeeded():Lb&&Lb.scrollIntoView&&Lb.scrollIntoView();return Promise.resolve()}},{key:"interactivelyloadTests",value:function(){var Lb=Tc(regeneratorRuntime.mark(function Db(){var Ra,N,va,Wa,pa,tb,ab,Ob,yc,Ta,Bd,Eb,fe,Od,Hd;return regeneratorRuntime.wrap(function(Qc){for(;;)switch(Qc.prev=Qc.next){case 0:return Ra=this.systemInterface,Qc.next=3,Ra.getPackages();case 3:return Qc.t0=
function(Xd){var oc=Xd.name;return{isListItem:!0,string:oc,value:{name:oc,url:Xd.url}}},N=Qc.sent.map(Qc.t0),Qc.next=7,$world.filterableListPrompt("Choose package",N,{requester:this,multiSelect:!0,historyId:"lively.morphic-test-runner-load-tests-pkg-hist"});case 7:return va=Qc.sent,Wa=Nb(va.selected,1),pa=Wa[0],Qc.next=12,aa.findTestModulesInPackage(Ra,pa.url);case 12:return tb=Qc.sent,ab=tb.map(function(Xd){return{string:Xd.slice(pa.url.length),value:{url:Xd,nameInPackage:Xd.slice(pa.url.length)},
isListItem:!0}}),Qc.next=16,$world.filterableListPrompt("Load tests",ab,{requester:this,multiSelect:!0,historyId:"lively.morphic-test-runner-load-tests-module-hist"});case 16:Ob=Qc.sent,yc=Ob.selected,Ta=aa.LoadingIndicator.open("running tests"),Qc.prev=19,Bd=bc(yc),Qc.prev=21,Bd.s();case 23:if((Eb=Bd.n()).done){Qc.next=30;break}fe=Eb.value;Od=fe.url;Hd=fe.nameInPackage;Ta.label="Running ".concat(Hd);Qc.next=28;return this.runTestFile(Od);case 28:Qc.next=23;break;case 30:Qc.next=35;break;case 32:Qc.prev=
32,Qc.t1=Qc["catch"](21),Bd.e(Qc.t1);case 35:return Qc.prev=35,Bd.f(),Qc.finish(35);case 38:return Qc.prev=38,Ta.remove(),Qc.finish(38);case 41:case "end":return Qc.stop()}},Db,this,[[19,,38,41],[21,32,35,38]])}));return function(){return Lb.apply(this,arguments)}}()}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"TestRunner"}},{key:"open",value:function(){var Lb=Tc(regeneratorRuntime.mark(function Ra(Db){var N;return regeneratorRuntime.wrap(function(va){for(;;)switch(va.prev=va.next){case 0:return N=
(new this(Object.assign({extent:aa.pt(500,600)},Db))).openInWorld(),va.abrupt("return",N.world().openInWindow(N,{title:"test runner",name:"test runner window"}).activate());case 2:case "end":return va.stop()}},Ra,this)}));return function(Db){return Lb.apply(this,arguments)}}()},{key:"properties",get:function(){return{showControls:{defaultValue:!0,after:["html","submorphs"],set:function(Lb){this.setProperty("showControls",Lb);this.get("eval backend button").visible=Lb;this.update()}},reactsToPointer:{defaultValue:!1},
fill:{defaultValue:aa.Color.transparent},state:{},editorPlugin:{get:function(){return this.getProperty("editorPlugin")||(this.editorPlugin=new aa.JavaScriptEditorPlugin)}},name:{defaultValue:"test runner"},systemInterface:{derived:!0,after:["editorPlugin","submorphs"],get:function(){return this.editorPlugin.systemInterface()},set:function(Lb){this.editorPlugin.setSystemInterface(Lb);this.get("eval backend button").updateFromTarget()}},cssDeclaration:{defaultValue:aa.testRunnerCSS}}}}],qb,{pathInPackage:function(){return"./test-runner.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6155,end:26359})}(aa.HTMLMorph));aa["default"]=W}}});
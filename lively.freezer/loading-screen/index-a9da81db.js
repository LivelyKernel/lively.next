System.register(["./__root_module__-c4f77fb9.js","./index-2a389db9.js","./color-picker-362ec312.js"],function(){var ra,jb,pb,Ub,Jb,jd,uc,nd,wc,Cc,Mc,Bd,re,Ce,be,Sb,qc,od,Tb,wd,Fd,fc,ic,Ab,jc,Bc,ad,bd;return{setters:[function(ob){ra=ob.ax;jb=ob.a7;pb=ob.a8;Ub=ob.a_;Jb=ob.a6;jd=ob.ac;uc=ob.ad;nd=ob.aD;wc=ob.ap;Cc=ob.ab;Mc=ob.an;Bd=ob.as;re=ob.a3;Ce=ob.a1;be=ob.C;Sb=ob.au;qc=ob.aj;od=ob.bP;Tb=ob.bs;wd=ob.af;Fd=ob.aw;fc=ob.bk;ic=ob.br;Ab=ob.bp;jc=ob.bR},function(ob){Bc=ob.N;ad=ob.I},function(ob){bd=
ob.a}],execute:function(){var ob=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js");ob.fun=ra;ob.string=jb;ob.obj=pb;ob.properties=Ub;ob.arr=Jb;ob.Text=jd;ob.config=uc;ob.HorizontalLayout=nd;ob.VerticalLayout=wc;ob.morph=Cc;ob.Morph=Mc;ob.Icon=Bd;ob.pt=re;ob.Rectangle=Ce;ob.Color=be;ob.connect=Sb;ob.once=qc;ob.noUpdate=od;ob.ColorPicker=bd;ob.DropDownList=Tb;ob.loadObjectFromPartsbinFolder=wd;ob.cachedControls=new WeakMap;var kb=function(Ba){var wa=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js"),
Na=wa.hasOwnProperty("RichTextControl")&&"function"===typeof wa.RichTextControl?wa.RichTextControl:wa.RichTextControl=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Fd(Na,Ba,[{key:"toggleButton",value:function(La,Wa){La.master=Wa?{auto:"styleguide://SystemIDE/selected button"}:{auto:"styleguide://System/dark button"}}},{key:"reset",value:function(){var La=this.ui.fontSelection;La.items=ob.RichTextControl.basicFontItems();
La.selection=La.items[0].value;ob.connect(this.target,"selectionChange",this,"update")}},{key:"alignAtTarget",value:function(La){La=void 0===La?!!this.world():La;var Wa=this.target,Gb=Wa.world()||$world,Rb=this.globalBounds();Wa=(Wa.selection.isEmpty()?Wa.globalBounds():Wa.getGlobalTransform().transformRectToRect(Wa.selectionBounds().translatedBy(Wa.scroll.negated()))).bottomCenter().subPt(Rb.topCenter());Gb=Gb.visibleBounds().translateForInclusion(Rb.translatedBy(Wa)).topLeft().subPt(Rb.topLeft());
Gb=this.position.addPt(Gb);La?this.animate({duration:300,position:Gb}):this.position=Gb}},{key:"removeFocus",value:function(){this.autoRemove&&this.target&&(this.remove(),this.target=null)}},{key:"focusOn",value:function(La,Wa){Wa=void 0===Wa?!0:Wa;var Gb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rb){if(1==Rb.nextAddress)return Gb.target=La,Gb.update(),Rb.yield(Gb.whenRendered(),2);Gb.ui.fontSizeField.relayout();Wa&&Gb.alignAtTarget();Rb.jumpToEnd()})}},{key:"setupConnections",
value:function(){ob.connect(this.ui.paddingField,"number",this,"setPadding");ob.connect(this.ui.paddingFieldTop,"number",this,"setPaddingTop");ob.connect(this.ui.paddingFieldBottom,"number",this,"setPaddingBottom");ob.connect(this.ui.paddingFieldLeft,"number",this,"setPaddingLeft");ob.connect(this.ui.paddingFieldRight,"number",this,"setPaddingRight")}},{key:"update",value:function(){var La=this,Wa=this.target,Gb=this.updateSpec,Rb=Wa.selection;Rb=Rb?Rb.isEmpty()?Wa.textAttributeAt(Rb.start):Wa.getStyleInRange(Rb):
{};var Bb=this.managedProps,ba=ob.obj.select(Wa,Bb);Wa=$jscomp.makeIterator(Object.entries(ob.obj.select(Rb||{},Bb)));for(Rb=Wa.next();!Rb.done;Rb=Wa.next())Bb=$jscomp.makeIterator(Rb.value),Rb=Bb.next().value,Bb=Bb.next().value,"undefined"!==typeof Bb&&(ba[Rb]=Bb);ob.noUpdate(function(){for(var xa=$jscomp.makeIterator(Object.entries(La.ui)),M=xa.next();!M.done;M=xa.next()){var ha=$jscomp.makeIterator(M.value);M=ha.next().value;ha=ha.next().value;if(Gb[M])Gb[M](ba,ha)}})}},{key:"relayout",value:function(){}},
{key:"changeAttributeInSelectionOrMorph",value:function(La,Wa){var Gb=this.target,Rb=Gb.selection;Gb.isLabel||Rb.isEmpty()?Gb[La]="function"===typeof Wa?Wa(Gb[La]):Wa:(Gb.undoManager.group(),Gb.changeStyleProperty(La,function(Bb){return"function"===typeof Wa?Wa(Bb):Wa}),Gb.undoManager.group())}},{key:"changeFont",value:function(La){var Wa=this,Gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rb){if(1==Rb.nextAddress)return Wa._last=La,(Gb="custom..."===La)?Rb.yield($world.prompt("Enter font family name",
{requester:Wa.target,historyId:"lively.morphic-rich-text-font-names",useLastInput:!0}),3):Rb.jumpTo(2);if(2!=Rb.nextAddress&&(La=Rb.yieldResult,!La))return Rb.return();Wa.changeAttributeInSelectionOrMorph("fontFamily",La);Rb.jumpToEnd()})}},{key:"setPadding",value:function(La){this.target.padding=ob.Rectangle.inset(La)}},{key:"setPaddingTop",value:function(La){var Wa=this.target.padding;this.target.padding=ob.Rectangle.inset(Wa.left(),La,Wa.right(),Wa.bottom())}},{key:"setPaddingLeft",value:function(La){var Wa=
this.target.padding;this.target.padding=ob.Rectangle.inset(La,Wa.top(),Wa.right(),Wa.bottom())}},{key:"setPaddingRight",value:function(La){var Wa=this.target.padding;this.target.padding=ob.Rectangle.inset(Wa.left(),Wa.top(),La,Wa.bottom())}},{key:"setPaddingBottom",value:function(La){var Wa=this.target.padding;this.target.padding=ob.Rectangle.inset(Wa.left(),Wa.top(),Wa.right(),La)}},{key:"setLineWrapping",value:function(La){this.target.lineWrapping=La}},{key:"changeFontWeight",value:function(La){this.changeAttributeInSelectionOrMorph("fontWeight",
La)}},{key:"changeTextAlign",value:function(La){this.changeAttributeInSelectionOrMorph("textAlign",La)}},{key:"changeFontColor",value:function(La){this.changeAttributeInSelectionOrMorph("fontColor",La)}},{key:"changeFontSize",value:function(La){this.changeAttributeInSelectionOrMorph("fontSize",La)}},{key:"changeFixedWidth",value:function(La){this.target.fixedWidth=La}},{key:"changeFixedHeight",value:function(La){this.target.fixedHeight=La}},{key:"changeLink",value:function(){var La=this,Wa,Gb,Rb,
Bb,ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){if(1==xa.nextAddress)return Wa=La.target,Gb=Wa.selection,Rb=Wa.getStyleInRange(Gb),Bb=Rb.link,xa.yield(La.world().prompt("Set link",{input:Bb||"https://"}),2);ba=xa.yieldResult;Wa.undoManager.group();Wa.setStyleInRange({link:ba||void 0},Gb);Wa.undoManager.group();La.autoRemove&&La.remove();xa.jumpToEnd()})}},{key:"toggleUnderline",value:function(){this.changeAttributeInSelectionOrMorph("textDecoration",function(La){return"underline"===
La?"none":"underline"})}},{key:"toggleItalic",value:function(){this.changeAttributeInSelectionOrMorph("fontStyle",function(La){return"italic"===La?"normal":"italic"})}},{key:"toggleBold",value:function(){this.changeAttributeInSelectionOrMorph("fontWeight",function(La){return"bold"===La||"700"===La?"normal":"bold"})}},{key:"copyStyle",value:function(){var La=this,Wa=this.target,Gb=this.ui.applyStyleButton;Wa=Wa.selection.isEmpty()?Wa.defaultTextStyle:Wa.getStyleInRange(Wa.selection);var Rb=JSON.stringify(Wa,
null,2);this.constructor.copiedStyle=Wa;Gb.tooltip="paste style\n"+Rb;this.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/plain",data:Rb},{type:"application/morphic-text-style",styleString:Rb}]).then(function(){return La.setStatusMessage("Copied style\n"+Rb)}).catch(function(Bb){return La.showError(Bb)})}},{key:"pasteStyle",value:function(){var La=this,Wa=this.target,Gb=this.constructor.copiedStyle;Wa.selection.isEmpty()?Object.assign(Wa,Gb):Wa.selections.forEach(function(Rb){return Wa.addTextAttribute(La.constructor.copiedStyle,
Rb)});this.update()}},{key:"clearStyle",value:function(){var La=this.target;La.selections.forEach(function(Wa){return La.resetStyleInRange(Wa)});this.update()}},{key:"configureRichTextOptions",value:function(){this.getSubmorphNamed("config panel")&&this.getSubmorphNamed("config panel").remove();var La=this.defaultSpec,Wa=this.uiSpec;La=this.addMorph({name:"config panel",layout:new ob.VerticalLayout({spacing:5}),epiMorph:!0,submorphs:[].concat($jscomp.arrayFromIterable(Object.keys(La).map(function(Gb){var Rb=
Wa.rows.some(function(Bb){return Bb.some(function(ba){return ba===Gb})});return{type:"labeledcheckbox",label:Gb,name:Gb,checked:Rb}})),[{layout:new ob.HorizontalLayout({spacing:3}),submorphs:[{type:"button",name:"OK button",label:"OK"},{type:"button",name:"cancel button",label:"Cancel"}]}])});La.center=this.innerBounds().center();ob.connect(La.getSubmorphNamed("OK button"),"fire",this,"configureAccepted");ob.connect(La.getSubmorphNamed("cancel button"),"fire",this,"configureCanceled")}},{key:"configureAccepted",
value:function(){var La=this.getSubmorphNamed("config panel");La&&(La.remove(),La.submorphs.filter(function(Wa){return"LabeledCheckBox"===Wa.constructor.name}))}},{key:"configureCanceled",value:function(){var La=this.getSubmorphNamed("config panel");La&&La.remove()}},{key:"close",value:function(){var La=this;this.target&&this.target.attributeConnections&&this.target.attributeConnections.forEach(function(Wa){return Wa.targetObj===La&&Wa.disconnect()});this.remove()}},{key:"alwaysTargetFocusedMorph",
value:function(){this.startStepping(1500,"updateTarget")}},{key:"updateTarget",value:function(){var La=this.world();La&&(La=La.focusedMorph)&&(La.isLabel||La.isText)&&!this.isAncestorOf(La)&&this.target!==La&&this.focusOn(La,!1)}},{key:"onMouseUp",value:function(La){var Wa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Gb){if(1==Gb.nextAddress)return Gb.yield(Wa.whenRendered(),2);Wa.update();Gb.jumpToEnd()})}},{key:"attachToWorld",value:function(){ob.connect($world,"onMouseDown",
this,"updateTarget",{garbageCollect:!0})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RichTextControl"}},{key:"properties",get:function(){return{autoRemove:{defaultValue:!1},target:{},toggleColor:{},managedProps:{readOnly:!0,get:function(){return"fontFamily fontWeight fontSize fontStyle isText fontColor textAlign link textDecoration fixedWidth fixedHeight lineWrapping padding".split(" ")}},updateSpec:{get:function(){var La=this;return Object.assign({fontSelection:function(Wa,Gb){var Rb=
Wa.fontFamily;(Wa=Rb&&Gb.items.find(function(Bb){return Bb.value.toLowerCase()===Rb.toLowerCase()}))?Gb.selection=Wa.value:Rb&&(Gb.items=Gb.items.concat({isListItem:!0,label:[Rb,{fontFamily:Rb}],value:Rb}),Gb.selection=ob.arr.last(Gb.items));Gb.fit();Gb.width=Math.max(Gb.width,170)},fontWeightSelection:function(Wa,Gb){Gb.selection="normal"==Wa.fontWeight?"Medium":Wa.fontWeight?ob.string.capitalize(Wa.fontWeight):"Medium"},boldButton:function(Wa,Gb){La.toggleButton(Gb,"bold"===Wa.fontWeight)},italicButton:function(Wa,
Gb){La.toggleButton(Gb,"italic"===Wa.fontStyle)},underlineButton:function(Wa,Gb){La.toggleButton(Gb,"underline"===Wa.textDecoration)},linkButton:function(Wa,Gb){La.toggleButton(Gb,!!Wa.link)},colorPicker:function(Wa,Gb){Gb.colorValue=Wa.fontColor},fontSizeField:function(Wa,Gb){Gb.number=Wa.fontSize},fixedWidthControl:function(Wa,Gb){Wa.isText?Gb.enable():Gb.disable();Gb.checked=Wa.fixedWidth},fixedHeightControl:function(Wa,Gb){Wa.isText?Gb.enable():Gb.disable();Gb.checked=Wa.fixedHeight},lineWrappingControl:function(Wa,
Gb){var Rb=$jscomp.makeIterator(Gb.submorphs);Gb=Rb.next().value;Rb=Rb.next().value;Gb.checked=!!Wa.lineWrapping;Wa.isText?Gb.enable():Gb.disable();Rb.deactivated=!Wa.lineWrapping;Rb.deactivated?Rb.opacity=.5:(Rb.opacity=1,Rb.selection=Wa.lineWrapping)},paddingControl:function(Wa,Gb){var Rb=Wa.padding,Bb=Rb.left();Wa=Rb.top();var ba=Rb.right();Rb=Rb.bottom();var xa=!ob.arr.every([Bb,Wa,ba,Rb],function(M){return M==Bb});Gb.get("multi value indicator").visible=xa;ob.connect(Gb.get("multi value indicator"),
"onMouseDown",Gb.get("padding field"),"number",{converter:"() => left",varMapping:{left:Bb}});Gb.get("padding field").number=Bb;Gb.get("padding field").visible=!xa;Gb.get("padding field top").number=Wa;Gb.get("padding field left").number=Bb;Gb.get("padding field right").number=ba;Gb.get("padding field bottom").number=Rb}},["left","center","right","block"].reduce(function(Wa,Gb){Wa[Gb+"Align"]=function(Rb,Bb){Bb.deactivated=!Rb.isText;La.toggleButton(Bb,Rb.textAlign==Gb)};return Wa},{}))}},ui:{get:function(){var La=
this,Wa={fontSelection:"font selection",fontWeightSelection:"font weight selection",boldButton:"bold button",italicButton:"italic button",underlineButton:"underline button",linkButton:"link button",leftAlign:"left align",centerAlign:"center align",rightAlign:"right align",blockAlign:"block align",fontSizeField:"font size field",colorPicker:"color picker",copyStyleButton:"copy style",applyStyleButton:"apply style",removeStyleButton:"remove style",fixedHeightControl:"fixed height control",fixedWidthControl:"fixed width control",
lineWrappingControl:"line wrapping control",paddingControl:"padding control",paddingField:"padding field",paddingFieldTop:"padding field top",paddingFieldLeft:"padding field left",paddingFieldRight:"padding field right",paddingFieldBottom:"padding field bottom"};return ob.obj.extract(Wa,ob.obj.keys(Wa),function(Gb,Rb){return La.getSubmorphNamed(Rb)})}}}}},{key:"openDebouncedFor",value:function(La){var Wa=La.selection;if(Wa.isEmpty()){var Gb=ob.cachedControls.get(La);Gb&&(Gb.update(),Gb.alignAtTarget(),
Gb.world()||La.world().addMorph(Gb))}else ob.fun.debounceNamed(La.id+"openRichTextControl",600,function(){var Rb=ob.cachedControls.get(La);Wa.isEmpty()?Rb&&Rb.removeFocus():(Rb&&Rb.world()||(Rb=new ob.RichTextControl,ob.cachedControls.set(La,Rb)),La.world().addMorph(Rb),Rb.focusOn(La,!0),Rb.alwaysTargetFocusedMorph())})()}},{key:"openFor",value:function(La){var Wa=ob.cachedControls.get(La);Wa?Wa.update():(Wa=new ob.RichTextControl,ob.cachedControls.set(La,Wa),Wa.focusOn(La,!0),Wa.alwaysTargetFocusedMorph());
Wa.alignAtTarget();Wa.world()||La.world().addMorph(Wa);return Wa}}],wa,{pathInPackage:function(){return"text/ui.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:624,end:17067})}(ob.Morph);ob.RichTextControl=kb;ob.RichTextControl=kb;ob.RichTextControl=kb;kb=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js");kb.SearchField=
fc;var tb=function(Ba){var wa=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js"),Na=wa.hasOwnProperty("ProtoSearchField")&&"function"===typeof wa.ProtoSearchField?wa.ProtoSearchField:wa.ProtoSearchField=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Fd(Na,Ba,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoSearchField"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],
wa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoSearchField",version:"0.1.1-0"}}},{start:76,end:221})}(kb.SearchField);tb=kb.ProtoSearchField;kb.default=tb;var Aa=lively.FreezerRuntime.recorderFor("ProtoTree/index.js");Aa.Tree=ic;Aa.TreeData=Ab;kb=function(Ba){var wa=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),
Na=wa.hasOwnProperty("TestTreeData")&&"function"===typeof wa.TestTreeData?wa.TestTreeData:wa.TestTreeData=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Fd(Na,Ba,[{key:"display",value:function(La){return La.name}},{key:"isCollapsed",value:function(La){return La.isCollapsed}},{key:"collapse",value:function(La,Wa){La.isCollapsed=Wa}},{key:"getChildren",value:function(La){return La.isLeaf?null:La.isCollapsed?[]:
La.children}},{key:"isLeaf",value:function(La){return La.isLeaf}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TestTreeData"}}],wa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:113,end:417})}(Aa.TreeData);Aa.TestTreeData=kb;Aa.TestTreeData=kb;Aa.TestTreeData=kb;kb=function(Ba){var wa=
lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),Na=wa.hasOwnProperty("ProtoTree")&&"function"===typeof wa.ProtoTree?wa.ProtoTree:wa.ProtoTree=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Fd(Na,Ba,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoTree"}},{key:"properties",get:function(){return{treeData:{initialize:function(){this.treeData=new Aa.TestTreeData({name:"root",isCollapsed:!1,
isLeaf:!1,children:[{name:"child 1",isLeaf:!0},{name:"child 2",isLeaf:!1,isCollapsed:!0,children:[{name:"child 2 - 1",isLeaf:!0}]},{name:"child 3",isLeaf:!1,isCollapsed:!1,children:[{name:"child 3 - 1",isLeaf:!0},{name:"child 3 - 2",isLeaf:!0}]},{name:"child 4",isLeaf:!0}]})}},master:{initialize:function(){}}}}}],wa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:434,end:1297})}(Aa.Tree);kb=Aa.ProtoTree;Aa.default=kb;kb=lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js");kb.NumberWidget=Bc;tb=function(Ba){var wa=lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js"),Na=wa.hasOwnProperty("ProtoNumberWidget")&&"function"===typeof wa.ProtoNumberWidget?wa.ProtoNumberWidget:wa.ProtoNumberWidget=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Fd(Na,Ba,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoNumberWidget"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],wa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoNumberWidget",version:"0.1.1-0"}}},{start:76,end:224})}(kb.NumberWidget);tb=kb.ProtoNumberWidget;
kb.default=tb;kb=lively.FreezerRuntime.recorderFor("FrameResizer/index.js");kb.Morph=Mc;tb=function(Ba){var wa=lively.FreezerRuntime.recorderFor("FrameResizer/index.js"),Na=wa.hasOwnProperty("FrameResizer")&&"function"===typeof wa.FrameResizer?wa.FrameResizer:wa.FrameResizer=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Fd(Na,Ba,[{key:"onDrag",value:function(La){var Wa=this.owner.left;La=La.positionIn(this).x;
La*="left"==this.direction?-1:1;this.owner.width+=La;350>this.owner.width&&(La+=350-this.owner.width,this.owner.width=350);this.owner.left="left"==this.direction?Wa-La:Wa}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FrameResizer"}},{key:"properties",get:function(){return{direction:{type:"Enum",values:["left","right"]}}}}],wa,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"FrameResizer",version:"0.1.1-24"}}},{start:56,end:840})}(kb.Morph);tb=kb.FrameResizer;kb.default=tb;var Fa=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js");Fa.Morph=Mc;Fa.morph=Cc;Fa.layouts=jc;Fa.string=jb;Fa.connect=Sb;Fa.noUpdate=od;Fa.InteractiveMorphSelector=ad;Fa.Color=be;Fa.pt=re;kb=function(Ba){var wa=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js"),Na=wa.hasOwnProperty("ShapeLayoutControl")&&"function"===typeof wa.ShapeLayoutControl?
wa.ShapeLayoutControl:wa.ShapeLayoutControl=function(La){La&&La[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Fd(Na,Ba,[{key:"focusOn",value:function(La){this.target=La;this.update(!1)}},{key:"setupConnections",value:function(){var La=this.ui;Fa.connect(La.submorphSettingsControl,"fire",this,"chooseSubmorphToChangeLayoutSettings");Fa.connect(La.dragmeControl,"onDragStart",this,"onSubmorphSettingsDragStart");Fa.connect(La.xAxisPolicyControl,
"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "x",\n        submorph: self.selectedSubmorph,\n      })',varMapping:{self:this}});Fa.connect(La.yAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "y",\n        submorph: self.selectedSubmorph,\n      })',varMapping:{self:this}});for(var Wa={},Gb=$jscomp.makeIterator(this.managedProps),Rb=Gb.next();!Rb.done;Wa=
{$jscomp$loop$prop$prop$2563:Wa.$jscomp$loop$prop$prop$2563},Rb=Gb.next()){var Bb=$jscomp.makeIterator(Rb.value),ba=Bb.next().value;Rb=Bb.next().value;Bb.next().value||(Wa.$jscomp$loop$prop$prop$2563=this.join(ba),Bb=La[this.join(ba,"control")],Fa.connect(Bb,Rb,this,"updateLayout",{updater:function(xa){return function(M,ha){M(xa.$jscomp$loop$prop$prop$2563,ha)}}(Wa),varMapping:{prop:Wa.$jscomp$loop$prop$prop$2563}}))}}},{key:"lower",value:function(La){return La.charAt(0).toLowerCase()+La.slice(1)}},
{key:"join",value:function(La,Wa){return this.lower(Fa.string.camelCaseString(La+(Wa?" "+Wa:"")))}},{key:"updateLayoutOfTarget",value:function(La){La=Fa.layouts[Fa.string.camelCaseString(La)];this.target.layout=La?new La({autoResize:!1}):null;this.update()}},{key:"updateLayout",value:function(La,Wa){this.target.layout[La]=Wa}},{key:"update",value:function(La){var Wa=this;this.target&&Fa.noUpdate(function(){for(var Gb=Wa.ui,Rb=Wa.target.layout||{name:function(){return"No"}},Bb=$jscomp.makeIterator(Wa.managedProps),
ba=Bb.next();!ba.done;ba=Bb.next()){var xa=$jscomp.makeIterator(ba.value);ba=xa.next().value;var M=xa.next().value;xa.next();xa=Gb[Wa.join(ba,"control")];var ha=Gb[Wa.join(ba,"label")];if(M)if("type"===ba)xa.selection=Rb.name()+" Layout";else{var Ka=Rb[Wa.join(ba)],$a="undefined"!==typeof Ka;if($a){switch(ba){case "align":xa.items=Rb.possibleAlignValues;break;case "direction":xa.items=Rb.possibleDirectionValues;break;case "axis":xa.items=Rb.possibleAxisValues}xa[M]=Ka}ha.isLayoutable=ha.visible=$a}}Wa.showGridLayoutControl("Grid"===
Rb.name());Wa.showProportionalControl("Proportional"===Rb.name())})}},{key:"updateSubmorphProportionalLayoutSettings",value:function(La){var Wa={};this.target.layout.changeSettingsFor(La.submorph,(Wa[La.axis]=La.policy,Wa),!0)}},{key:"onSubmorphSettingsDragStart",value:function(La){var Wa=this;La.stop();var Gb=this.target.layout,Rb=Gb.settingsFor(this.selectedSubmorph),Bb=[],ba;for(ba in Rb)Bb=[].concat($jscomp.arrayFromIterable(Bb),[ba+": ",{fontWeight:"bold"},Rb[ba]+" ",{}]);var xa=Fa.morph({type:"label",
fontColor:Fa.Color.white,value:Bb,fill:Fa.Color.black.withA(.7),padding:5,borderRadius:10,isLayoutable:!1});xa.wantsToBeDroppedOn=function(M){return Gb.layoutableSubmorphs.includes(M)};xa.onBeingDroppedOn=function(M,ha){xa.remove();if(M=Gb.layoutableSubmorphs.includes(ha)?ha:La.world.morphsContainingPoint(La.hand.position).find(function(Ka){return Gb.layoutableSubmorphs.includes(Ka)}))Wa.updateSubmorphProportionalLayoutSettings({policy:Rb.x,axis:"x",submorph:M}),Wa.updateSubmorphProportionalLayoutSettings({policy:Rb.y,
axis:"y",submorph:M}),M.show(),$world.setStatusMessage("layout settings applied")};La.hand.grab(xa);xa.moveBy(Fa.pt(10,10))}},{key:"chooseSubmorphToChangeLayoutSettings",value:function(){var La=this,Wa,Gb,Rb,Bb,ba,xa,M,ha,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){switch($a.nextAddress){case 1:return Wa=La.target.layout.layoutableSubmorphs,La.manageFocus=!0,La.env.eventDispatcher.isKeyPressed("Shift")?(Rb=Wa.map(function($b){return{isListItem:!0,string:String($b),value:$b}}),
$a.yield($world.listPrompt("Select morph",Rb,{onSelection:function($b){return $b.show()}}),5)):$a.yield(Fa.InteractiveMorphSelector.selectMorph(La.world(),La,function($b){return Wa.includes($b)}),4);case 4:Gb=$a.yieldResult;$a.jumpTo(3);break;case 5:Bb=$a.yieldResult,ba=$jscomp.makeIterator(Bb.selected),Gb=ba.next().value;case 3:La.manageFocus=!1;La.selectedSubmorph=Gb;if(!Gb)return $a.return();xa=La.ui;M=xa.xAxisPolicyControl;ha=xa.yAxisPolicyControl;Ka=La.target.layout.settingsFor(Gb);Fa.noUpdate(function(){M.selection=
Ka.x;ha.selection=Ka.y});$a.jumpToEnd()}})}},{key:"showProportionalControl",value:function(La){var Wa=this.ui;[Wa.submorphSettingsControl,Wa.dragmeControl,Wa.xAxisPolicyControl,Wa.xAxisPolicyLabel,Wa.yAxisPolicyControl,Wa.yAxisPolicyLabel].forEach(function(Gb){Gb.isLayoutable=La;Gb.visible=La})}},{key:"showGridLayoutHalo",value:function(){$world.showLayoutHaloFor(this.target)}},{key:"showGridLayoutControl",value:function(La){var Wa=this.ui.configureGridLayoutControl;Wa.visible=Wa.isLayoutable=La}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShapeLayoutControl"}},{key:"properties",get:function(){return{managedProps:{get:function(){return[["type","selection",!0],["align","selection"],["direction","selection"],["axis","selection"],["spacing","number"],["auto resize","checked"],["resize submorphs","checked"],["x axis policy","selection",!0],["y axis policy","selection",!0],["react to submorph animations","checked"],["submorph settings",!1,!0],["order by index","checked"],["dragme",
!1,!0],["configure grid layout",!1,!0]]}},ui:{readOnly:!0,get:function(){for(var La={labelContainer:this.getSubmorphNamed("label container"),controlContainer:this.getSubmorphNamed("control container")},Wa=$jscomp.makeIterator(this.managedProps),Gb=Wa.next();!Gb.done;Gb=Wa.next()){var Rb=$jscomp.makeIterator(Gb.value).next().value;Gb=Rb+" label";Rb+=" control";La[this.join(Gb)]=this.getSubmorphNamed(Gb);La[this.join(Rb)]=this.getSubmorphNamed(Rb)}return La}}}}}],wa,{pathInPackage:function(){return"index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ShapeLayoutControl",version:"0.1.1-166"}}},{start:345,end:7771})}(Fa.Morph);kb=Fa.ShapeLayoutControl;Fa.default=kb}}});
System.register(["./__root_module__-590131e3.js","./index-2bc8c0f4.js","./index-1bb77cad.js"],function(Sa){var Lb,Vb,Fc,jc,sd,kd,Cd,ed,Zc,bd,yd,ke,ue,He,ld,Wd,gc,cd,Bd,hd,Jd,de,Zb,Ic,Ad,Jc,zd,Mb,mb,Bc,xc,ec,Dc,Ta,hc,Eb,tc,Ec,ad,td,fc,zc,ac;return{setters:[function(Oa){Lb=Oa.C;Vb=Oa.i;Fc=Oa.a;jc=Oa.R;sd=Oa.b;kd=Oa.m;Cd=Oa.bo;ed=Oa.bp;Zc=Oa.c;bd=Oa.s;yd=Oa.ar;ke=Oa.bx;ue=Oa.by;He=Oa.Y;ld=Oa.o;Wd=Oa.ac;gc=Oa.d;cd=Oa.bz;Bd=Oa.bA;hd=Oa.$;Jd=Oa.P;de=Oa.p;Zb=Oa._;Ic=Oa.M;Ad=Oa.T;Jc=Oa.aa;zd=Oa.af;Mb=
Oa.O;mb=Oa.I;Bc=Oa.g;xc=Oa.bB;ec=Oa.q;Dc=Oa.bC;Ta=Oa.aC;hc=Oa.bq;Eb=Oa.aB;tc=Oa.bD;Ec=Oa.f},function(Oa){ad=Oa.M;td=Oa.I;fc=Oa.v;zc=Oa.p},function(Oa){ac=Oa.localInterface}],execute:function(){function Oa(Ma,fb){if(!0===fb)return fb;if(Ma.copyState)return Ma.copyState(fb);Ma={};for(var dc in fb){var za=fb[dc];za instanceof Array&&(za=za.concat([]));Ma[dc]=za}return Ma}function Da(Ma,fb,dc){return Ma.startState?Ma.startState(fb,dc):!0}function ka(Ma,fb){return Nc.modes[Ma]=fb}function Ba(Ma){if("string"===
typeof Ma&&Nc.mimeModes.hasOwnProperty(Ma))Ma=Nc.mimeModes[Ma];else if(Ma&&"string"===typeof Ma.name&&Nc.mimeModes.hasOwnProperty(Ma.name)){var fb=Nc.mimeModes[Ma.name];"string"===typeof fb&&(fb={name:fb});Ma=Object.assign({},fb,Ma);Ma.name=fb.name}else{if("string"===typeof Ma&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Ma))return Ba("application/xml");if("string"===typeof Ma&&/^[\w\-]+\/[\w\-]+\+json$/.test(Ma))return Ba("application/json")}return"string"===typeof Ma?{name:Ma}:Ma||{name:"null"}}function Ja(Ma,
fb){fb=Nc.resolveMode(fb);"string"===typeof fb&&(fb={name:fb});if(!fb.name)throw Error("parserConfig does not have a name of the mode to get");var dc=Nc.modes[fb.name];if(!dc)return Ja(Ma,"text/plain");Ma=Object.assign({indentUnit:2},Ma);return Object.assign(dc(Ma,fb),{name:fb.name})}function Fb(Ma,fb){for(var dc;Ma.innerMode;){dc=Ma.innerMode(fb);if(!dc||dc.mode==Ma)break;fb=dc.state;Ma=dc.mode}return dc||{mode:Ma,state:fb}}function va(Ma,fb){Nc.mimeModes[Ma]=fb}function Ka(Ma,fb,dc){}function Rb(Ma,
fb,dc,za,Fa,Na,fa){var Db=Ma.editorPlugin._tokenizerValidBefore;Db&&Db.row>=dc&&(Db.row=dc-1);var sa=Nc.linesToTokenize(Ma.document,dc,za,Db);Db=sa.lines;sa=sa.state;if(!Db.length)return!1;sa=sa?Nc.copyState(fb,sa):Nc.startState(fb);for(var La=0;La<Db.length;La++){var Wa=Db[La],Jb=Wa.row;Jb>=dc&&Jb<=za&&Nc.indentLine(Ma,fb,Wa,sa,Fa,Na,fa);sa=Nc.tokenizeLine(fb,Db[La],sa,function(){})}return!0}function eb(Ma,fb,dc,za,Fa,Na,fa){fb=Nc.linesToTokenize(fb,dc,za,Fa);dc=fb.lines;Nc.tokenizeLines(Ma,dc,fb.state,
Na,fa);return dc}function Vc(Ma,fb,dc,za,Fa){var Na=[],fa,Db=function(Wa){return Na.push(fa=[])},sa=function(Wa,Jb,rc,Lc,Sc,Rc,rd){return fa.push(rc,Lc,Wa,Sc.current(),Jb.localMode||rd)};try{var La=Nc.visitDocumentTokens(Ma,fb,dc,za,Fa,Db,sa)}catch(Wa){Na.length=0,La=Nc.visitDocumentTokens(Ma,fb,dc,za,null,Db,sa)}return{tokens:Na,lines:La}}function Qb(Ma,fb,dc,za,Fa){null==fb&&(fb=Ma.search(/[^\s\u00a0]/),-1==fb&&(fb=Ma.length));za=za||0;for(Fa=Fa||0;;){var Na=Ma.indexOf("\t",za);if(0>Na||Na>=fb)return Fa+
(fb-za);Fa+=Na-za;Fa+=dc-Fa%dc;za=Na+1}}function qd(Ma){Ma=Ma.toLowerCase();for(var fb=0;fb<Nc.modeInfo.length;fb++){var dc=Nc.modeInfo[fb];if(dc.mime==Ma)return dc;if(dc.mimes)for(var za=0;za<dc.mimes.length;za++)if(dc.mimes[za]==Ma)return dc}if(/\+xml$/.test(Ma))return qd("application/xml");if(/\+json$/.test(Ma))return qd("application/json")}function Wc(Ma){for(var fb=0;fb<Nc.modeInfo.length;fb++){var dc=Nc.modeInfo[fb];if(dc.ext)for(var za=0;za<dc.ext.length;za++)if(dc.ext[za]==Ma)return dc}}function Mc(Ma){for(var fb=
0;fb<Nc.modeInfo.length;fb++){var dc=Nc.modeInfo[fb];if(dc.file&&dc.file.test(Ma))return dc}fb=Ma.lastIndexOf(".");if(Ma=-1<fb&&Ma.substring(fb+1,Ma.length))return Nc.findModeByExtension(Ma)}function Hb(Ma){Ma=Ma.toLowerCase();for(var fb=0;fb<Nc.modeInfo.length;fb++){var dc=Nc.modeInfo[fb];if(dc.name.toLowerCase()==Ma)return dc;if(dc.alias)for(var za=0;za<dc.alias.length;za++)if(dc.alias[za].toLowerCase()==Ma)return dc}}function Xd(Ma){if(!Ma)return String(Ma);if(Array.isArray(Ma))return"["+Ma.map(Xd).join(",")+
"]";if("symbol"===typeof Ma)return $d.printSymbol(Ma);try{return String(Ma)}catch(fb){return"Cannot print object: "+fb}}function Tb(Ma,fb){return!$d.arr.every(fb.map(function(dc){return Ma[dc]}),function(dc){return $d.obj.equals(dc,Ma&&Ma.valueOf())})}function Gb(Ma){if($d.obj.isPrimitive(Ma))var fb=$d.string.print(Ma);else Array.isArray(Ma)?((fb=3<Ma.length)&&(Ma=Ma.slice(0,3)),Ma=$d.string.print(Ma),fb&&(Ma=Ma.slice(0,-1)+", ...]"),fb=Ma):fb=$d.string.print(Ma);fb=fb.replace(/\n/g,"");500<fb.length&&
(fb=fb.slice(0,20)+("...["+(fb.length-20)+' CHARS]"'));return fb}function Pa(Ma){return qc.Inspector.openInWindow({targetObject:Ma})}function ca(Ma,fb){return qc.Inspector.openInWindow({remoteTarget:{code:Ma,evalEnvironment:fb}})}function Ha(Ma,fb){function dc(Db){var sa=Db.name,La=Db.ownerChain(),Wa=Db.owner,Jb=Db.world(),rc;Db===Na&&(rc=[fa]);Jb===Db&&(rc=["$world"]);if(!rc&&sa&&Wa){Wa===Jb&&1===qc.arr.count(qc.arr.pluck(Jb.submorphs,"name"),sa)&&(rc=['$world.get("'+sa+'")']);if(!rc&&Wa!=Jb)for(Jb=
La.length-1;Jb--;)if(1===La[Jb].getAllNamed(sa).length){rc=[].concat($jscomp.arrayFromIterable(dc(La[Jb])),['get("'+sa+'")']);break}rc||(sa=[].concat($jscomp.arrayFromIterable(dc(Wa)),['get("'+sa+'")']),qc.syncEval(sa.join("."),{context:Na}).value===Db&&(rc=sa))}rc||(rc=[fa+'.getMorphById("'+Db.id+'")']);return rc}fb=void 0===fb?{}:fb;var za=Ma.world(),Fa=fb;fb=void 0===Fa.maxLength?10:Fa.maxLength;var Na=void 0===Fa.fromMorph?za:Fa.fromMorph;if(Na===Ma)return"this";var fa=za===Na?"$world":"this";
if(!(za||Ma.name&&Na.get(Ma.name)===Ma))return"morph";za=dc(Ma);return za.length>fb?'$world.getMorphWithId("'+Ma.id+'")':za.join(".")}function cb(Ma,fb,dc){var za=(fb=void 0===fb?"":fb)&&oe.arr.last(fb.split(".")).toLowerCase(),Fa="",Na=0,fa=Math.pow(2,19);if("string"===typeof Ma){if(Ma.length>fa)return null}else if(Ma.document.stringSize>fa)return null;if("string"===typeof Ma)Fa=Ma.slice(0,1E3);else for(Ma=$jscomp.makeIterator(Ma.document.lines),fa=Ma.next();!fa.done;fa=Ma.next()){var Db=fa.value;
fa=Db.stringSize;Db=Db.text;var sa=!0;1E3<Na+fa&&(sa=!1,fa=1E3-Na);Fa+=Db.slice(0,fa)+(sa?"\n":"");Na+=fa;if(1E3<=Na)break}Na=$jscomp.makeIterator(oe.modeInfo);for(Ma=Na.next();!Ma.done;Ma=Na.next()){sa=Ma.value;fa=sa.contentTest;Ma=sa.mode;Db=sa.ext;sa=sa.file;if("function"===typeof fa)try{if(fa(Fa))return Ma}catch(La){}if(sa&&sa instanceof RegExp&&sa.test(fb))return Ma;if(Db)for(fa=$jscomp.makeIterator(Db),Db=fa.next();!Db.done;Db=fa.next())if(Db.value===za)return Ma}return dc}Sa({a:va,d:ka,r:Ka});
var Pb=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");Pb.Color=Lb;var sc=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),dc=fb.hasOwnProperty("DefaultTheme")&&"function"===typeof fb.DefaultTheme?fb.DefaultTheme:fb.DefaultTheme=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:"background",get:function(){return Pb.Color.white}},{key:"default",
get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Pb.Color.white,fontWeight:"bold",backgroundColor:Pb.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Pb.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Pb.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],fb,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Xc=sc=Pb.DefaultTheme;Pb.default=sc;var Nc=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");Nc.copyState=Oa;Nc.startState=Da;Nc.defineMode=ka;Nc.resolveMode=Ba;Nc.getMode=Ja;Nc.innerMode=Fb;Nc.defineMIME=va;Nc.registerHelper=Ka;Nc.indentLines=Rb;Nc.indentLine=function(Ma,fb,dc,za,Fa,Na,fa){fa=Object.assign({indentWithTabs:!Ma.useSoftTabs,indentUnit:Ma.tabWidth,tabSize:4,ignoreFollowingText:!1},
fa);null==Fa&&(Fa="add");"smart"==Fa&&(fb.indent||(Fa="prev"));var Db=fa.tabSize,sa=dc.text,La=Nc.countColumn(sa,null,Db);dc.modeState&&(dc.modeState=null);var Wa=sa.match(/^\s*/)[0];if(!Na&&!/\S/.test(sa)){var Jb=0;Fa="not"}else if("smart"==Fa&&(Jb=fb.indent(za,fa.ignoreFollowingText?"":sa.slice(Wa.length),sa),Jb==Nc.passIndent||150<Jb)){if(!Na)return;Fa="prev"}"prev"==Fa?Jb=0<dc.row?Nc.countColumn(dc.prevLine().text,null,Db):0:"add"==Fa?Jb=La+fa.indentUnit:"subtract"==Fa?Jb=La-fa.indentUnit:"number"===
typeof Fa&&(Jb=La+Fa);Jb=Math.max(0,Jb);fb="";za=0;if(fa.indentWithTabs)for(fa=Math.floor(Jb/Db);fa;--fa)za+=Db,fb+="\t";za<Jb&&(fb+=" ".repeat(Jb-za));if(fb!=Wa)return Ma.replace({start:{row:dc.row,column:0},end:{row:dc.row,column:Wa.length}},fb),!0};Nc.tokenizeLines=function(Ma,fb,dc,za,Fa){if(fb.length){dc=dc?Nc.copyState(Ma,dc):Nc.startState(Ma);for(var Na=0;Na<fb.length;Na++){var fa=fb[Na];za(fa);dc=Nc.tokenizeLine(Ma,fa,dc,Fa)}}};Nc.tokenizeLine=function(Ma,fb,dc,za){var Fa=fb.text;if(!Fa)return dc;
var Na=new Nc.StringStream(Fa,2);dc=fb.modeState="function"===typeof Ma.copyState?Ma.copyState(dc):Nc.copyState(Ma,dc);fb.prevLine();for(dc._string=Fa;!Na.eol();)Fa=Ma.token(Na,dc),za(Fa,dc,Na.start,Na.pos,Na,fb,Ma),Na.start=Na.pos;return dc};Nc.printTokens=function(Ma){for(var fb="",dc=0;dc<Ma.length;dc+=5)fb+=Ma[dc+0]+" => "+Ma[dc+1]+" "+Ma[dc+2]+" "+Ma[dc+3]+" "+Ma[dc+4].name+"\n";return fb};Nc.visitDocumentTokens=eb;Nc.tokenizeDocument=Vc;Nc.linesToTokenize=function(Ma,fb,dc,za){if(za&&za.row>=
dc)return{lines:[],state:null};fb=za?Math.max(0,za.row-1):fb;var Fa=Ma.getLine(fb),Na=Fa.text;Ma=[Fa];za=null;for(var fa=0,Db;(Db=Fa.prevLine())&&50>fa++;){Fa=Db;if(Fa.modeState){za=Fa.modeState;break}Ma.unshift(Fa)}if(!za){for(var sa=Fa,La=Infinity;(Db=Fa.prevLine())&&100>fa++;){Fa=Db;if(Fa.modeState){za=Fa.modeState;break}Ma.unshift(Fa);Db=Na.match(/^\s*/)[0].length;if(0===Db)break;Db<La&&(La=Db,sa=Fa)}!za&&0<La&&(Ma=Ma.slice(Ma.indexOf(sa)))}if(dc>fb)for(Fa=Nc.arr.last(Ma);fb<=dc;fb++){Fa=Fa.nextLine();
if(!Fa)break;Ma.push(Fa)}return{lines:Ma,state:za}};Nc.countColumn=Qb;Nc.findModeByMIME=qd;Nc.findModeByExtension=Wc;Nc.findModeByFileName=Mc;Nc.findModeByName=Hb;Nc.arr=Fc;sc=Nc.modes||{};Nc.modes=sc;Nc.modes=sc;Nc.modes=sc;sc=Sa("p",{});Nc.passIndent=sc;Nc.passIndent=sc;Nc.passIndent=sc;Nc.copyState=Oa;Nc.copyState=Oa;Nc.startState=Da;Nc.startState=Da;Nc.defineMode=ka;Nc.defineMode=ka;Nc.resolveMode=Ba;Nc.resolveMode=Ba;Nc.getMode=Ja;Nc.getMode=Ja;Nc.innerMode=Fb;Nc.innerMode=Fb;sc={};Nc.mimeModes=
sc;Nc.mimeModes=sc;Nc.mimeModes=sc;Nc.defineMIME=va;Nc.defineMIME=va;Nc.registerHelper=Ka;Nc.registerHelper=Ka;Nc.indentLines=Rb;Nc.indentLines=Rb;Nc.visitDocumentTokens=eb;Nc.visitDocumentTokens=eb;Nc.tokenizeDocument=Vc;Nc.tokenizeDocument=Vc;Nc.countColumn=Qb;Nc.countColumn=Qb;(function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),dc=fb.hasOwnProperty("StringStream")&&"function"===typeof fb.StringStream?fb.StringStream:fb.StringStream=function(za){za&&za[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(za,Fa){this.reset(za,Fa)}},{key:"reset",value:function(za,Fa){this.pos=this.start=0;this.string=void 0===za?"":za;this.tabSize=void 0===Fa?2:Fa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||
void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(za){var Fa=this.string.charAt(this.pos);if("string"===typeof za?Fa==za:Fa&&(za.test?za.test(Fa):za(Fa)))return++this.pos,Fa}},{key:"eatWhile",value:function(za){for(var Fa=this.pos;this.eat(za););return this.pos>Fa}},{key:"eatSpace",value:function(){for(var za=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>za}},{key:"skipToEnd",
value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(za){za=this.string.indexOf(za,this.pos);if(-1<za)return this.pos=za,!0}},{key:"backUp",value:function(za){this.pos-=za}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=Nc.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?Nc.countColumn(this.string,this.lineStart,this.tabSize):
0)}},{key:"indentation",value:function(){return Nc.countColumn(this.string,null,this.tabSize)-(this.lineStart?Nc.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(za,Fa,Na){if("string"===typeof za){var fa=function(sa){return Na?sa.toLowerCase():sa},Db=this.string.substr(this.pos,za.length);if(fa(Db)==fa(za))return!1!==Fa&&(this.pos+=za.length),!0}else{if((za=this.string.slice(this.pos).match(za))&&0<za.index)return null;za&&!1!==Fa&&(this.pos+=za[0].length);return za}}},
{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(za,Fa){this.lineStart+=za;try{return Fa()}finally{this.lineStart-=za}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],fb,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:10526,end:13053})})(void 0);sc=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",
ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",
mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",
mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Ma){return Ma.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",
mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",
mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",
ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",
ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},
{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",
ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",
mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",
ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},
{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},
{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",
ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",
mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Ma){return Ma.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",
mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",
mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",
mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn",
"ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",
mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",
ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];Nc.modeInfo=sc;Nc.modeInfo=sc;Nc.modeInfo=sc;for(var Ed=0;Ed<Nc.modeInfo.length;Ed++)Nc.info=
Nc.modeInfo[Ed],Nc.info.mimes&&(Nc.info.mime=Nc.info.mimes[0]);Nc.defineMode("null",function(){return{token:function(Ma){return Ma.skipToEnd()}}});Nc.defineMIME("text/plain","null");Nc.findModeByMIME=qd;Nc.findModeByMIME=qd;Nc.findModeByExtension=Wc;Nc.findModeByExtension=Wc;Nc.findModeByFileName=Mc;Nc.findModeByFileName=Mc;Nc.findModeByName=Hb;Nc.findModeByName=Hb;var Ld=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Ld.Color=Lb;Ld.Rectangle=jc;Ld.pt=sd;Ld.morph=kd;Ld.ShadowObject=
Cd;Ld.StyleSheet=ed;Ld.connect=Zc;Ld.arr=Fc;Ld.string=bd;Ld.FilterableList=yd;Ld.Range=ke;Ed=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),dc=fb.hasOwnProperty("Completer")&&"function"===typeof fb.Completer?fb.Completer:fb.Completer=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"Completer"}}],fb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);Ld.Completer=Ed;Ld.Completer=Ed;Ld.Completer=Ed;Ed=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),dc=fb.hasOwnProperty("WordCompleter")&&
"function"===typeof fb.WordCompleter?fb.WordCompleter:fb.WordCompleter=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:"compute",value:function(za,Fa){var Na=[],fa=[],Db=za.document.lineStrings;za=za.cursorPosition.row;for(var sa=za-1;0<=sa;sa--)for(var La=$jscomp.makeIterator(Db[sa].split(/[^0-9a-z@_]+/i)),Wa=La.next();!Wa.done;Wa=La.next())(Wa=Wa.value)&&!Na.includes(Wa)&&Wa!==Fa&&(Na.push(Wa),
fa.push({priority:1E3-(za-sa),completion:Wa}));for(sa=za+1;sa<Db.length;sa++)for(La=$jscomp.makeIterator(Db[sa].split(/[^0-9a-z_@]+/i)),Wa=La.next();!Wa.done;Wa=La.next())(Wa=Wa.value)&&!Na.includes(Wa)&&Wa!==Fa&&(Na.push(Wa),fa.push({priority:1E3-(sa-za),completion:Wa}));return fa}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],fb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);Ld.WordCompleter=Ed;Ld.WordCompleter=Ed;Ld.WordCompleter=Ed;Ed=[new Ld.WordCompleter];Ld.defaultCompleters=Ed;Ld.defaultCompleters=Ed;Ld.defaultCompleters=Ed;Ed=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),dc=fb.hasOwnProperty("CompletionController")&&"function"===typeof fb.CompletionController?fb.CompletionController:fb.CompletionController=function(za){za&&za[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(za,Fa){Fa=void 0===Fa?[]:Fa;this.textMorph=za;this.completers=Fa=za.pluginCollect("getCompleters",Fa)}},{key:"computeCompletions",value:function(za){var Fa=this,Na,fa,Db,sa,La,Wa,Jb,rc,Lc,Sc,Rc,rd,Vd,se,Kd,Ee;return $jscomp.asyncExecutePromiseGeneratorProgram(function(le){switch(le.nextAddress){case 1:Na=[],fa=$jscomp.makeIterator(Fa.completers),Db=fa.next();
case 2:if(Db.done){le.jumpTo(4);break}sa=Db.value;le.setCatchFinallyBlocks(5);La=Na;Wa=La.concat;return le.yield(sa.compute(Fa.textMorph,za),7);case 7:Na=Wa.call(La,le.yieldResult);le.leaveTryBlock(3);break;case 5:Jb=le.enterCatchBlock(),console.warn("Error in completer "+sa+": "+(Jb.stack||Jb));case 3:Db=fa.next();le.jumpTo(2);break;case 4:rc=new Map;Na.forEach(function(ge){var jf=rc.get(ge.completion);jf||(jf=[],rc.set(ge.completion,jf));jf.push(ge)});Lc=[];Sc=$jscomp.makeIterator(rc.values());
for(Rc=Sc.next();!Rc.done;Rc=Sc.next())rd=Rc.value,Lc.push(Ld.arr.last(Ld.arr.sortByKey(rd,"priority")));Vd=0;se=Ld.arr.sortByKey(Lc,"priority").reverse();Kd=se.length&&se[0].priority||0;Ee=se.map(function(ge){ge.highestPriority=Kd;var jf=ge.completion.replace(/\n/g,""),Sf=String((ge.info||"").replace(/\n/g,""));Vd=Math.max(Vd,jf.length+Sf.length);return{isListItem:!0,string:jf,annotation:Sf,value:ge}});return le.return({items:Ee,maxCol:Vd})}})}},{key:"computeSortedCompletions",value:function(za,
Fa){Fa=void 0===Fa?!1:Fa;var Na=this,fa,Db,sa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){if(1==La.nextAddress)return fa={tokens:[za],lowercasedTokens:[za],input:za},La.yield(Na.computeCompletions(za),2);Db=La.yieldResult;sa=Ld.arr.sortBy(Db.items.filter(function(Wa){return Na.filterFunction(fa,Wa,Fa)}),function(Wa){return Na.sortFunction(fa,Wa)});return La.return(sa)})}},{key:"_printCompletions",value:function(za){var Fa=this,Na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fa){if(1==
fa.nextAddress)return fa.yield(Fa.computeSortedCompletions(za),2);Na=fa.yieldResult.map(function(Db){return{completion:Db.value.completion,priority:Db.value.priority,maxP:Db.value.highestPriority,sortVal:Db._cache[za].sortVal,lev:JSON.stringify(Db._cache[za].levenshtein)}});return fa.return(Ld.string.printTable(lively.lang.grid.tableFromObjects(Na)))})}},{key:"prefix",value:function(){var za=this.textMorph,Fa=za.selection;return(Fa.isEmpty()?za.getLine(Fa.lead.row).slice(0,Fa.lead.column):Fa.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(za,Fa,Na){Na=void 0===Na?!1:Na;Fa._cache||(Fa._cache={});var fa=za.tokens,Db=za.lowercasedTokens,sa=za.input;sa=Fa._cache[sa]||(Fa._cache[sa]={});if(sa.hasOwnProperty("filtered"))return sa.filtered;Fa=Fa.value.completion.replace(/\([^\)]*\)$/,"");var La=Fa.toLowerCase();if(Na&&fa[0]&&!Fa.startsWith(fa[0]))return sa.filtered=!1;if(Db.every(function(Jb){return La.includes(Jb)}))return!0;var Wa=sa.levenshtein||(sa.levenshtein={});za=Na||3>=Ld.arr.sum(za.lowercasedTokens.map(function(Jb){return Wa[Jb]||
(Wa[Jb]=Ld.string.levenshtein(La,Jb))}));return sa.filtered=za}},{key:"sortFunction",value:function(za,Fa){Fa._cache||(Fa._cache={});var Na=Fa._cache[za.input]||(Fa._cache[za.input]={});if(Na.hasOwnProperty("sortVal"))return Na.sortVal;Na=Fa._cache[za.input]={};var fa=Fa.value;Fa=fa.highestPriority;var Db=fa.completion;fa=fa.priority;Db=Db.replace(/\([^\)]*\)$/,"").toLowerCase();var sa=0;za.lowercasedTokens.forEach(function(Wa){Db.startsWith(Wa)?sa+=12:3<=Wa.length&&Db.includes(Wa)&&(sa+=5)});Fa=
-((fa||(sa?Fa:0))/Math.pow(10,String(Fa).length-2))-sa;var La=Na.levenshtein||(Na.levenshtein={});za=Ld.arr.sum(za.lowercasedTokens.map(function(Wa){return La[Wa]||(La[Wa]=Ld.string.levenshtein(Db,Wa))}));sa&&(za/=2);return Na.sortVal=za+Fa}},{key:"positionForMenu",value:function(){var za=this.textMorph,Fa=za.charBoundsFromTextPosition(za.cursorPosition);return za.getGlobalTransform().transformRectToRect(Fa).topLeft().addXY(-za.scroll.x,-za.scroll.y).addPt(Ld.pt(za.borderWidth+4,za.borderWidth+4))}},
{key:"completionListSpec",value:function(){var za=this,Fa,Na,fa,Db,sa,La,Wa,Jb,rc,Lc,Sc,Rc,rd,Vd,se,Kd,Ee,le,ge,jf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sf){if(1==Sf.nextAddress)return Na=Fa=za.textMorph,fa=Na.fontSize,Db=Na.fontFamily,sa=za.positionForMenu(),La=za.prefix(),Sf.yield(za.computeCompletions(La),2);Wa=Sf.yieldResult;Jb=Wa.items;rc=Wa.maxCol;Lc=Fa.env.fontMetric.sizeFor(Db,fa,"M");Sc=Lc.width*rc;Rc=Fa.document.getLine(0).height;rd=Math.max(120,Sc<Fa.width?Sc:Fa.width);
Vd=Rc*Jb.length+Rc+10;se=Math.max(70,Math.min(700,Vd));Kd=sa.extent(Ld.pt(rd,se));if(Ee=Fa.world())le=Ee.visibleBounds().insetBy(5),Kd.bottom()>le.bottom()&&(ge=Kd.bottom()-le.bottom(),ge>Kd.height-50&&(ge=Kd.height-50),Kd.height-=ge),Kd.right()>le.right()&&(jf=Kd.right()-le.right(),Kd.width=120>Kd.width-jf?120:Kd.width-jf),le.containsRect(Kd)||(Kd=Kd.withTopLeft(le.translateForInclusion(Kd).topLeft())),Kd=Kd.translatedBy(le.insetBy(0).topLeft().negated());return Sf.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:fa,position:Kd.topLeft(),extent:Kd.extent(),items:Jb,input:La,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:za.filterFunction,sortFunction:za.sortFunction})})}},{key:"removeMenuOnBlur",value:function(za){var Fa=za.menu;setTimeout(function(){Fa.withAllSubmorphsDetect(function(Na){return Na.isFocused()})?Fa.inputMorph.focus():Fa.remove()})}},{key:"openCompletionList",value:function(){var za=this,Fa,Na,fa,Db,sa,La,Wa,Jb,
rc,Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return Fa=za.textMorph.selection.start,Sc.yield(za.completionListSpec(),2);if(3!=Sc.nextAddress)return Na=Sc.yieldResult,za.textMorph.pluginFind(function(Rc){return Rc.theme}),fa=new Ld.FilterableList(Na),Db=new Ld.Range({start:Fa,end:za.textMorph.selection.start}),sa=za.textMorph.textInRange(Db),La=fa.inputMorph,Wa=fa.listMorph,Jb=Na.input,rc=fa.addMorph({name:"prefix mask",fill:Ld.Color.transparent,bounds:La.textBounds()},
La),Wa.master=null,Db.isEmpty()||(za.textMorph.deleteText(Db),La.input=sa,La.gotoDocumentEnd()),La.fontColor=za.textMorph.fontColor,Ld.connect(La,"textString",rc,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:La}}),Ld.connect(fa,"accepted",za,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Jb}}),Ld.connect(fa,"accepted",fa,"remove"),Ld.connect(fa,"canceled",fa,"remove"),Ld.connect(fa,"remove",za.textMorph,"focus"),Ld.connect(fa.inputMorph,"onBlur",za,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:fa}}),Lc=za.textMorph.world(),Wa.addStyleClass("hiddenScrollbar"),fa.paddingMorph.height=2,La.height=Wa.itemHeight,La.clipMode="visible",La.fill=za.textMorph.fill,La.fixedHeight=!0,La.fixedWidth=!1,La.fontSize=Wa.fontSize,fa.relayout(),fa.selectedIndex=
0,fa.master.applyIfNeeded(!0),La.focus(),Sc.yield(fa.master.whenApplied(),3);Jb.length&&(La.gotoDocumentEnd(),fa.moveBy(Ld.pt(-La.textBounds().width,0)));Lc.addMorph(fa);fa.inputPadding=Ld.Rectangle.inset(0,0,0,0);return Sc.return(fa)})}},{key:"autoInsertBestMatchingCompletion",value:function(za,Fa,Na){Fa=void 0===Fa?!0:Fa;var fa=this,Db,sa,La,Wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jb){if(1==Jb.nextAddress)return Db=$jscomp,sa=Db.makeIterator,Jb.yield(fa.computeSortedCompletions(za,
Fa),2);La=sa.call(Db,Jb.yieldResult);(Wa=La.next().value)&&fa.insertCompletion(Wa.value.completion,za,Na);Jb.jumpToEnd()})}},{key:"insertCompletion",value:function(za,Fa,Na){var fa=this.textMorph,Db=fa.document,sa=fa.selection.isMultiSelection?fa.selection.selections:[fa.selection];fa.undoManager.group();sa.forEach(function(La){La.collapseToEnd();var Wa=La.lead,Jb=Fa?Db.indexToPosition(Db.positionToIndex(Wa)-Fa.length):Wa;"function"===typeof Na?Na(za,Fa,fa,{start:Jb,end:Wa},La):fa.replace({start:Jb,
end:Wa},za)});fa.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],fb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13044})}(void 0);Ld.CompletionController=Ed;Ld.CompletionController=Ed;Ld.CompletionController=Ed;
Ed=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Ma,fb,dc){var za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){return 1==Fa.nextAddress?(za=new Ld.CompletionController(Ma,Ld.defaultCompleters),Fa.yield(za.openCompletionList(),2)):Fa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Ma,fb,dc){var za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){return 1==Fa.nextAddress?
(za=new Ld.CompletionController(Ma,Ld.defaultCompleters),Fa.yield(za.autoInsertBestMatchingCompletion(za.prefix()),2)):Fa.return(!0)})}}];Ld.completionCommands=Ed;Ld.completionCommands=Ed;Ld.completionCommands=Ed;var Ye=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Ye.chain=ue;Ye.arr=Fc;Ye.obj=He;Ye.string=bd;var Fe=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Ma){var fb=Ma.selection.start;0<fb.row&&(fb=Ma.getPositionAboveOrBelow(1,
fb,!0,0,Ma.charBoundsFromTextPosition(fb).x),Ma.selection.addRange({start:fb,end:fb}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Ma){var fb=Ma.selection.start;fb.row<Ma.documentEndPosition.row&&(fb=Ma.getPositionAboveOrBelow(-1,fb,!0,0,Ma.charBoundsFromTextPosition(fb).x),Ma.selection.addRange({start:fb,end:fb}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Ma){var fb=Ma.selection.selections[Ma.selection.selections.length-
1];if(fb.isEmpty())return!0;Ma.searchForAll(fb.text,{start:{column:0,row:0}}).forEach(function(dc){return Ma.selection.addRange(dc.range,!1)});Ma.selection.mergeSelections();Ye.arr.remove(Ma.selection.selections,fb);Ma.selection.selections.push(fb);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Ma){var fb=Ma.selection.selections.length-1,dc=Ma.selection.selections[fb];if(dc.isEmpty())return!0;var za=Ma.search(dc.text,{start:dc.end,backwards:!1});
za&&(dc=Ma.selection.selections.findIndex(function(Fa){return Fa.range.equals(za.range)}),-1<dc?Ye.arr.swap(Ma.selection.selections,dc,fb):Ma.selection.addRange(za.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Ma){var fb=Ma.selection.selections.length-1,dc=Ma.selection.selections[fb];if(dc.isEmpty())return!0;var za=dc.start,Fa=Ma.search(dc.text,{start:{row:za.row,column:za.column-(dc.text.length-1)},backwards:!0});Fa&&(dc=Ma.selection.selections.findIndex(function(Na){return Na.range.equals(Fa.range)}),
-1<dc?Ye.arr.swap(Ma.selection.selections,dc,fb):Ma.selection.addRange(Fa.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Ma){var fb=Ma.selection.selections.length;1<fb&&Ma.selection.removeSelections(fb-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Ma){Ma.selection.selections=lively.lang.arr.rotate(Ma.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",
multiSelectAction:"single",exec:function(Ma){Ma.selection.selections=lively.lang.arr.rotate(Ma.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Ma){var fb=Ma.selection.selections;if(1>=fb.length)return!0;var dc=Ye.arr.groupBy(fb,function(Fa){return Fa.range.start.row});fb=dc.keys().map(function(Fa){Fa=dc[Fa];var Na=Ye.arr.max(Fa,function(fa){return fa.range.start.column});Ye.arr.without(Fa,Na).forEach(function(fa){return fa.range=Na.range});
return Na});var za=Ye.arr.max(fb,function(Fa){return Fa.range.start.column}).range.start.column;fb.forEach(function(Fa){var Na=Fa.range.start;Fa=Na.row;Na=Na.column;Ma.insertText(" ".repeat(za-Na),{row:Fa,column:Na})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Ma){Ma.selection.disableMultiSelect();if(Ma.selection.isEmpty())var fb=Ma.lastSavedMark&&Ma.lastSavedMark.position||(void 0).lineRange().start,dc=Ma.cursorPosition;else fb=Ma.selection,
dc=fb.lead,fb=fb.anchor;Ma.selection.collapse();var za=fb.column,Fa=dc.column;Ye.arr.range(fb.row,dc.row).forEach(function(Na){return Ma.getLine(Na).length>Math.min(Fa,za)&&Ma.selection.addRange({end:{row:Na,column:Fa},start:{row:Na,column:za}},!1)});Ma.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Ma,fb,dc){dc=void 0===dc?1:dc;Ma.undoManager.group();Ma.selection.selections.forEach(function(za,Fa){return za.text=String(Fa+
dc)});Ma.undoManager.group();return!0}}];Ye.multiSelectCommands=Fe;Ye.multiSelectCommands=Fe;Ye.multiSelectCommands=Fe;var ye=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");ye.pToI=function(Ma,fb){return Ma.positionToIndex(fb)};ye.iToP=function(Ma,fb){return Ma.indexToPosition(fb)};ye.execCodeNavigator=function(Ma){return function(fb,dc,za){var Fa=fb.pluginInvokeFirst("getNavigator");if(!Fa)return!0;fb.saveMark();za=za||1;for(var Na=0;Na<za;Na++)Fa[Ma](fb,dc);return!0}};
ye.once=ld;var z=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:ye.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:ye.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:ye.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:ye.execCodeNavigator("forwardDownSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:ye.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Ma,fb){function dc(){var Na=Ma.$expandRegionState,fa=ye.pToI(Ma,Ma.cursorPosition);if(Na&&(Na.range[0]===fa||Na.range[1]===fa))return Na;Na=Ma.selection.range;return Ma.$expandRegionState={range:[ye.pToI(Ma,Na.start),
ye.pToI(Ma,Na.end)]}}fb=fb||{};var za=Ma.pluginInvokeFirst("getNavigator");if(!za)return!0;var Fa=fb.start;fb=fb.end;if("number"===typeof Fa&&"number"===typeof fb)dc(),za={range:[Fa,fb],prev:dc()};else{Fa=za.ensureAST(Ma);if(!Fa)return;za=za.expandRegion(Ma,Ma.textString,Fa,dc())}za&&za.range&&(Ma.selection={start:ye.iToP(Ma,za.range[0]),end:ye.iToP(Ma,za.range[1])},Ma.$expandRegionState=za);ye.once(Ma,"selectionChange",function(){return Ma.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",
readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Ma){if(Ma.selection.isEmpty())return!0;var fb=Ma.pluginInvokeFirst("getNavigator");if(!fb)return!0;var dc=fb.ensureAST(Ma);if(!dc)return!0;var za=Ma.$expandRegionState;if(!za)return!0;(fb=fb.contractRegion(Ma,Ma.textString,dc,za))&&fb.range&&(Ma.selection={start:ye.iToP(Ma,fb.range[0]),end:ye.iToP(Ma,fb.range[1])},Ma.$expandRegionState=fb);ye.once(Ma,"selectionChange",
function(){return Ma.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];ye.commands=z;ye.commands=z;ye.commands=z;var Ke=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");Ke.arr=Fc;Ke.chain=ue;Ke.string=bd;var Ie=[{name:"toggle comment",exec:function(Ma){var fb=Ma.pluginInvokeFirst("getComment");if(!fb)return!0;if(!fb.lineCommentStart)return fb.blockCommentStart?Ma.execCommand("toggle block comment"):!0;var dc=fb.lineCommentStart,za=new RegExp("^(\\s*)("+
dc+"\\s?)(.*)");fb=Ma.document;var Fa=Ma.selection;Fa.isEmpty()||0!==Fa.end.column||Fa.growRight(-1);var Na=Fa.start.row;fb=fb.lineStrings.slice(Fa.start.row,Fa.end.row+1);fb=fb.some(function(sa){return!!sa.trim()})?Ke.arr.dropWhile(fb,function(sa){return sa.trim()?!1:++Na&&!0}):fb;var fa=fb.every(function(sa){return sa.trim()&&sa.match(za)});Ma.undoManager.group();if(fa)fb.forEach(function(sa,La){if(sa=sa.match(za)){sa=$jscomp.makeIterator(sa);sa.next();var Wa=sa.next().value,Jb=sa.next().value;
sa.next();Ma.deleteText({start:{row:Na+La,column:Wa.length},end:{row:Na+La,column:Wa.length+Jb.length}})}});else{var Db=fb.reduce(function(sa,La,Wa){return La.trim()||Fa.isEmpty()&&Fa.start.row===Fa.end.row?Math.min(sa,La.match(/^\s*/)[0].length):sa},Infinity);Db=Infinity===Db?0:Db;fb.forEach(function(sa,La){sa=$jscomp.makeIterator(sa.match(/^(\s*)(.*)/));sa.next();sa.next();sa.next();Ma.insertText(dc+" ",{row:Na+La,column:Db})})}Ma.undoManager.group();return!0}},{name:"toggle block comment",exec:function(Ma){var fb=
Ma.pluginInvokeFirst("getComment");if(!fb)return!0;if(!fb.blockCommentStart)return fb.lineCommentStart?Ma.execCommand("toggle comment"):!0;if(!fb||!fb.blockCommentStart)return!0;var dc=fb.blockCommentStart;fb=fb.blockCommentEnd;var za=new RegExp("^"+dc.replace(/\*/g,"\\*")),Fa=new RegExp(fb.replace(/\*/g,"\\*")+"$"),Na=Ma.tokenAt(Ma.cursorPosition);if(Na&&"comment"===Na.token){var fa=Ma.textInRange(Na);if(fa.match(za)&&fa.match(Fa))return Ma.undoManager.group(),Ma.replace(Na,fa.slice(dc.length,-fb.length)),
Ma.undoManager.group(),!0}Ma.undoManager.group();Ma.insertText(dc,Ma.selection.start);Ma.insertText(fb,Ma.selection.end);Ma.undoManager.group();dc=!Ma.selection.isEmpty();Ma.selection.growLeft(fb.length);dc||Ma.selection.collapse();return!0}},{name:"comment box",exec:function(Ma,fb,dc){fb=Ma.undoManager.ensureNewGroup(Ma,"comment box");if(Ma.selection.isEmpty())return Ma.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Ma.execCommand("toggle comment"),Ma.undoManager.group(fb),
!0;var za=Ma.selection.range,Fa=Ma.withSelectedLinesDo(function(fa){return fa}),Na=Ke.arr.min([za.start.column].concat(Ke.chain(Fa).map(function(fa){return fa.match(/^\s*/)}).flatten().compact().pluck("length").value()));Fa=Ke.arr.max(Fa.map(function(fa){return fa.length}))-Na;Fa=Array(Math.ceil(Fa/2)+1).join("-=")+"-";Ma.execCommand("toggle comment");Ma.collapseSelection();Ma.cursorPosition={row:za.start.row,column:0};dc?Ma.insertText(Ke.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n",
" ",Na)):Ma.insertText(Ke.string.indent(Fa+"\n"," ",Na));Ma.selection.goUp();Ma.execCommand("toggle comment");Ma.cursorPosition={row:za.end.row+2,column:0};Ma.insertText(Ke.string.indent(Fa+"\n"," ",Na));Ma.selection.goUp();Ma.execCommand("toggle comment");Ma.selection.range={start:{row:za.start.row,column:0},end:Ma.cursorPosition};Ma.undoManager.group(fb);return!0},multiSelectAction:"forEach",handlesCount:!0}];Ke.commands=Ie;Ke.commands=Ie;Ke.commands=Ie;var $d=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");
$d.printSymbol=function(Ma){if(Symbol.keyFor(Ma))return'Symbol.for("'+Symbol.keyFor(Ma)+'")';if($d.knownSymbols.get(Ma))return $d.knownSymbols.get(Ma);String(Ma).match($d.symMatcher);return String(Ma)};$d.defaultSort=function(Ma,fb){if(Ma.hasOwnProperty("priority")||fb.hasOwnProperty("priority")){var dc=Ma.priority||0,za=fb.priority||0;if(dc<za)return-1;if(dc>za)return 1}Ma=(Ma.keyString||Ma.key).toLowerCase();fb=(fb.keyString||fb.key).toLowerCase();return Ma<fb?-1:Ma===fb?0:1};$d.safeToString=Xd;
$d.propertyNamesOf=function(Ma,fb){if(!Ma)return[];if(Array.isArray(Ma)){var dc=fb?fb.offset:0;return $d.arr.range(dc,dc+(fb?fb.partitionSize:Ma.length-1))}return $d.arr.sortBy(Object.keys(Ma),function(za){return za.toLowerCase()})};$d.isMultiValue=Tb;$d.printValue=Gb;$d.partitionedChildren=function(Ma,fb){var dc=void 0===fb?{}:fb;fb=void 0===dc.originalValue?Ma:dc.originalValue;var za=void 0===dc.offset?0:dc.offset;dc=void 0===dc.partitionSize?Ma.length||Object.values(Ma).length:dc.partitionSize;
if($d.obj.isArray(Ma)){Ma=$d.num.roundTo(Math.max($d.MIN_PARTITION_SIZE,dc/50),.1);dc/=Ma;for(var Fa=[],Na=0;Na<dc;Na++){var fa="["+(za+Na*Ma)+"-"+(za+(Na+1)*Ma)+"]";Fa.push({partition:{originalValue:fb,offset:za+Na*Ma,partitionSize:Ma},value:[],key:fa,keyString:fa,valueString:"...",isCollapsed:!0})}return Fa}Ma=$d.num.roundTo(Math.max($d.MIN_PARTITION_SIZE,dc/50),.1);dc/=Ma;Fa=[];Na=$d.obj.keys(fb).sort();for(fa=0;fa<dc;fa++){var Db=za+fa*Ma,sa=za+(fa+1)*Ma,La=$d.obj.select(fb,Na.slice(Db,sa));Db=
"["+Na[Db].slice(0,4)+"-"+(Na[sa]||$d.arr.last(Na)).slice(0,4)+"]";Fa.push({partition:{originalValue:La,offset:za+fa*Ma,partitionSize:Ma},value:[],key:Db,keyString:Db,valueString:"...",isCollapsed:!0})}return Fa};$d.propertiesOf=function(Ma){var fb=Ma.partition?Ma.target:Ma.value;if(!fb)return[];var dc={_rev:!0},za=[],Fa="function"===typeof fb.livelyCustomInspect?fb.livelyCustomInspect():{},Na=Object.assign({},$d.defaultPropertyOptions,{},Fa);if(Fa.properties){Fa=$jscomp.makeIterator(Fa.properties);
for(var fa=Fa.next();!fa.done;fa=Fa.next()){var Db=fa.value;fa=Db.key;var sa=Db.hidden,La=Db.priority,Wa=Db.keyString,Jb=Db.value;Db=Db.valueString;dc[fa]=!0;sa||za.push(Ma.getSubNode({priority:La,key:fa,keyString:Wa||$d.safeToString(fa),value:Jb,valueString:Db,isCollapsed:!0}))}}if(Na.includeDefault){Fa=$d.propertyNamesOf(fb,Ma.partition);if(Fa.length>$d.MAX_NODE_THRESHOLD)for(dc=$jscomp.makeIterator($d.partitionedChildren(fb,Ma.partition)),Fa=dc.next();!Fa.done;Fa=dc.next())za.push(Ma.getSubNode(Fa.value));
else for(sa=$jscomp.makeIterator(Fa),Fa=sa.next();!Fa.done;Fa=sa.next())La=Fa.value,La in dc||(Fa=fb[La],fa=$d.printValue(Fa),Fa={keyString:La,key:La,value:Fa,valueString:fa,isCollapsed:!0},za.push(Ma.getSubNode(Fa)));if(Na.includeSymbols)for(dc=$jscomp.makeIterator(Object.getOwnPropertySymbols(fb)),Fa=dc.next();!Fa.done;Fa=dc.next())sa=Fa.value,La=$d.safeToString(sa),Fa=fb[sa],fa=$d.printValue(Fa),Fa={key:sa,keyString:La,value:Fa,valueString:fa,isCollapsed:!0},za.push(Ma.getSubNode(Fa))}Na.sort&&
(za=Na.sortFunction(fb,za));return za};$d.obj=He;$d.num=Wd;$d.arr=Fc;$d.string=bd;$d.connect=Zc;$d.signal=gc;$d.TreeData=cd;$d.newUUID=Bd;$d.localInterface=ac;$d.MAX_NODE_THRESHOLD=1E3;$d.MIN_PARTITION_SIZE=250;$d.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Ma,fb){return Array.isArray(Ma)?fb:fb.sort($d.defaultSort)}};$d.symMatcher=/^Symbol\((.*)\)$/;$d.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Ma){return"symbol"===
typeof Symbol[Ma]}).reduce(function(Ma,fb){return Ma.set(Symbol[fb],"Symbol."+fb)},new Map)}();$d.isMultiValue=Tb;$d.isMultiValue=Tb;$d.printValue=Gb;$d.printValue=Gb;var Ze=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),dc=fb.hasOwnProperty("InspectionTree")&&"function"===typeof fb.InspectionTree?fb.InspectionTree:fb.InspectionTree=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Vb(dc,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(za){Vb._get(Object.getPrototypeOf(dc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,za);this.inspector=za.inspector;this.root.isInspectionNode||(this.root=$d.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(za){za=void 0===za?!0:za;return Vb._get(Object.getPrototypeOf(dc.prototype),"asListWithIndexAndDepth",
this).call(this,function(Fa){Fa=Fa.node;return za?Fa.visible:!0})}},{key:"getContextFor",value:function(za){return za==this.root?this.root.value.inspectee:za.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(za){var Fa=void 0===za.maxDepth?1:za.maxDepth,Na=za.iterator,fa=za.showUnknown,Db=za.showInternal,sa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(La){if(1==La.nextAddress)return La.yield(sa.uncollapseAll(function(Wa,Jb){return Fa>Jb&&(Wa==sa.root||Wa.value.submorphs)}),
2);sa.asListWithIndexAndDepth(!1).forEach(function(Wa){var Jb=Wa.node;return 0==Wa.depth?Jb.visible=!0:!fa&&Jb.keyString&&Jb.keyString.includes("UNKNOWN PROPERTY")||!Db&&Jb.keyString&&Jb.keyString.includes("internal")?Jb.visible=!1:Jb.value&&Jb.value.submorphs?Jb.visible=!0:Jb.visible=Na(Jb)});La.jumpToEnd()})}},{key:"getChildren",value:function(za){return za.children}},{key:"display",value:function(za){return za.display(this.inspector)}},{key:"isCollapsed",value:function(za){return za.isCollapsed}},
{key:"isLeaf",value:function(za){return $d.obj.isPrimitive(za.value)}},{key:"collapse",value:function(za,Fa){var Na=this;za.isCollapsed=Fa;Fa||this.isLeaf(za)||za.children.length||(za.children=$d.propertiesOf(za).map(function(fa){Na.parentMap.set(fa,za);return fa}))}},{key:"retrieveForRemoteProxy",value:function(za){za.uuid||(za.uuid=$d.newUUID(),this.idToNodeMap[za.uuid]=za);return{uuid:za.uuid,value:this.isLeaf(za)?za.value:{},keyString:za.keyString,key:za.keyString,valueString:$d.safeToString(za.value),
isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return $d.localInterface}},{key:"getNodeViaId",value:function(za){return this.idToNodeMap[za]}},{key:"asRemoteDelegate",value:function(za){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[za]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionTree"}},{key:"forObject",value:function(za,Fa){return new this({key:"inspectee",value:{inspectee:za},isCollapsed:!0,inspector:Fa})}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}($d.TreeData);$d.InspectionTree=Ze;$d.InspectionTree=
Ze;$d.InspectionTree=Ze;var hf=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),dc=fb.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof fb.RemoteInspectionTree?fb.RemoteInspectionTree:fb.RemoteInspectionTree=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),
value:function(za){this.parentMap=new WeakMap;this.root=za.proxy;this.evalEnvironment=za.evalEnvironment;this.inspector=za.inspector;this.delegateId=za.delegateId}},{key:"getContextFor",value:function(za){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+za.uuid+'").value'}},{key:"dispose",value:function(){var za=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){return Fa.yield(za.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
za.delegateId+"']\n    ",za.evalEnvironment),0)})}},{key:"display",value:function(za){return za.keyString+": "+za.valueString}},{key:"collapse",value:function(za,Fa){var Na=this,fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){if(1==Db.nextAddress)return(za.isCollapsed=Fa)||Na.isLeaf(za)?Db.return():za.children.length?Db.jumpTo(0):Db.yield(Na.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+za.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Na.delegateId+'"]'}),3);fa=Db.yieldResult;za.children=fa.isError?[]:fa.value;Db.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(za,Fa){var Na=this,fa,Db,sa,La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wa){if(1==Wa.nextAddress)return Wa.yield(Na.createRemoteContext(za,Fa),2);fa=Wa.yieldResult;
Db=fa.proxy;sa=fa.delegateId;La=fa.evalEnvironment;return Wa.return(new Na({key:"inspectee",proxy:Db,delegateId:sa,evalEnvironment:La,inspector:Fa}))})}},{key:"createRemoteContext",value:function(za,Fa){var Na=za.code,fa=za.evalEnvironment,Db=za.delegateId,sa,La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wa){if(1==Wa.nextAddress)return Db="lively://inspector-"+Fa.id,Wa.yield(fa.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Na+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Db+'");\n    ',fa),2);sa=Wa.yieldResult;La=sa.value;return Wa.return({delegateId:Db,evalEnvironment:fa,proxy:La})})}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}($d.InspectionTree);
$d.RemoteInspectionTree=hf;$d.RemoteInspectionTree=hf;$d.RemoteInspectionTree=hf;(function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),dc=fb.hasOwnProperty("InspectionNode")&&"function"===typeof fb.InspectionNode?fb.InspectionNode:fb.InspectionNode=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(za){var Fa=
za.root,Na=za.priority,fa=za.key,Db=za.keyString,sa=za.value,La=za.valueString,Wa=za.isCollapsed,Jb=void 0===za.children?[]:za.children,rc=void 0===za.isSelected?!1:za.isSelected,Lc=void 0===za.visible?!0:za.visible;this.partition=za.partition;this.priority=Na;this.key=fa;this.keyString=String(Db||fa);this.value=sa;this.valueString=La||$d.printValue(sa);this.isCollapsed=Wa;this.children=Jb;this.isSelected=rc;this.visible=Lc;this.root=Fa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(za){if(za.value&&za.value.isMorph)return new $d.MorphNode(Object.assign({root:this.root},za));var Fa=za.key,Na=za.keyString,fa=this.value,Db=za.partition;Db&&(fa=Db.originalValue,Na=Fa);return new $d.PropertyNode(Object.assign({},za,{keyString:Na,key:Fa,target:fa,partition:Db,root:this.root,spec:{}}))}},{key:"display",value:function(za){var Fa=this.keyString,Na=this.valueString;if(!this.interactive)return Fa+": "+Na;this._propertyWidget||
(this._propertyWidget=za.renderDraggableTreeLabel({value:Fa+": "+Na}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(za,Fa){Fa=void 0===Fa?null:Fa;return za.value&&za.value.isMorph?new $d.MorphNode(Object.assign({root:Fa},za)):new $d.InspectionNode(Object.assign({root:Fa},za))}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),dc=fb.hasOwnProperty("MorphNode")&&"function"===typeof fb.MorphNode?fb.MorphNode:fb.MorphNode=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,
[{key:Symbol.for("lively-instance-initialize"),value:function(za){Vb._get(Object.getPrototypeOf(dc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,za);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(za){var Fa=this.propertyInfo[za.key]||{};return za.value&&za.value.isMorph?new $d.MorphNode(Object.assign({},za,{root:this.root})):new $d.PropertyNode(Object.assign({},za,{root:this.root,target:this.target,
spec:Fa}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})($d.InspectionNode);(function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),dc=fb.hasOwnProperty("PropertyNode")&&
"function"===typeof fb.PropertyNode?fb.PropertyNode:fb.PropertyNode=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(za){Vb._get(Object.getPrototypeOf(dc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,za);var Fa=za.spec,Na=za.target;this.partition=za.partition;this.target=Na;this.spec=Fa;this.foldedNodes={}}},{key:"__deserialize__",
value:function(za,Fa){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(za){this._interactive=za}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(za){return this.isFoldable?this.getFoldedContext(za):Vb._get(Object.getPrototypeOf(dc.prototype),"getSubNode",this).call(this,za)}},{key:"getFoldedContext",
value:function(za){return this.foldedNodes[za.key]=new $d.FoldedNode(Object.assign({},za,{root:this.root,target:this.target,foldableNode:this,spec:$d.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(za,Fa){(Fa=void 0===Fa?!1:Fa)&&(this.target[this.key]=za);this.value=this.target[this.key];this.valueString=$d.printValue(this.value);this.interactive&&(Fa||this._propertyWidget.highlight());if(this.isFoldable)for(var Na in this.foldedNodes)this.foldedNodes[Na].value=
this.value[Na],this.foldedNodes[Na].valueString=$d.printValue(this.value[Na]),this.foldedNodes[Na]._propertyWidget&&$d.signal(this.foldedNodes[Na]._propertyWidget,"update",this.value[Na])}},{key:"display",value:function(za){var Fa=this,Na=this._propertyWidget,fa=this.keyString,Db=this.valueString,sa=this.target,La=this.value,Wa=this.spec;if(!(this.interactive||Wa.foldable&&$d.isMultiValue(La,Wa.foldable)))return za.renderPropertyControl({target:sa,keyString:fa,valueString:Db,tree:za.ui.propertyTree,
value:La,spec:Wa,node:this,fastRender:!0});if(Na)return Na.keyString=fa,Na.valueString=Db,Na.isSelected=this.isSelected,Na.control&&(Na.control.isSelected=this.isSelected),Na;Na=this._propertyWidget=za.renderPropertyControl({target:sa,keyString:fa,valueString:Db,value:La,spec:Wa,node:this,isSelected:this.isSelected,fontColor:za.ui.propertyTree.fontColor});this.isInternalProperty||Wa.readOnly||($d.connect(Na,"propertyValue",this,"refreshProperty",{updater:function(Jb,rc){return Jb(rc,!0)}}),$d.connect(Na,
"openWidget",this.root,"onWidgetOpened",{converter:function(Jb){return{widget:Jb,node:Fa.sourceObj}}}));return Na}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})($d.InspectionNode);
(function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),dc=fb.hasOwnProperty("FoldedNode")&&"function"===typeof fb.FoldedNode?fb.FoldedNode:fb.FoldedNode=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(za){Vb._get(Object.getPrototypeOf(dc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
za);this.foldableNode=za=za.foldableNode;this.foldedProp=za.key+$d.string.capitalize(this.key)}},{key:"refreshProperty",value:function(za,Fa){Fa=void 0===Fa?!1:Fa;var Na={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Na[this.key]=za,Na)),Fa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],fb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})($d.PropertyNode);var kf=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");kf.Color=Lb;var yf=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),dc=fb.hasOwnProperty("DarkTheme")&&"function"===typeof fb.DarkTheme?fb.DarkTheme:fb.DarkTheme=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Vb(dc,Ma,[{key:"background",get:function(){return kf.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return kf.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:kf.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:kf.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:kf.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:kf.Color.white,fontWeight:"bold",backgroundColor:kf.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:kf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:kf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],fb,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),hg=yf=kf.DarkTheme;kf.default=yf;var qc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");qc.inspect=Pa;qc.remoteInspect=ca;qc.generateReferenceExpression=Ha;qc.onNumberDragStart=
function(Ma,fb){fb.initPos=Ma.position;fb.factorLabel=(new qc.Tooltip({description:"1x"})).openInWorld(Ma.hand.position.addXY(10,10))};qc.onNumberDrag=function(Ma,fb){var dc=qc.getScaleAndOffset(Ma,fb),za=dc.scale;dc=dc.offset;fb.factorLabel.position=Ma.hand.position.addXY(10,10);fb.factorLabel.description=za+"x";return qc.getCurrentValue(dc,za,fb)};qc.onNumberDragEnd=function(Ma,fb){var dc=qc.getScaleAndOffset(Ma,fb);Ma=dc.offset;dc=dc.scale;fb.factorLabel.softRemove();return qc.getCurrentValue(Ma,
dc,fb)};qc.getScaleAndOffset=function(Ma,fb){var dc=Ma.position.subPt(fb.initPos);Ma=dc.x;fb=qc.num.roundTo(Math.exp(-dc.y/$world.height*6),.01)*fb.baseFactor;return{offset:Ma,scale:fb}};qc.getCurrentValue=function(Ma,fb,dc){return Math.max(dc.min,Math.min(dc.max,dc.scrubbedValue+(dc.floatingPoint?Ma*fb:Math.round(Ma*fb))))};qc.Color=Lb;qc.rect=hd;qc.pt=sd;qc.obj=He;qc.num=Wd;qc.Path=Jd;qc.arr=Fc;qc.promise=de;qc.connect=Zc;qc.disconnect=Zb;qc.once=ld;qc.Morph=Ic;qc.Tooltip=Ad;qc.VerticalLayout=Jc;
qc.HorizontalLayout=zd;qc.morph=kd;qc.Label=Mb;qc.Icon=mb;qc.config=Bc;qc.Tree=xc;qc.LoadingIndicator=ec;qc.DropDownList=Dc;qc.DropDownSelector=Ta;qc.SearchField=hc;qc.LabeledCheckBox=Eb;qc.MorphHighlighter=ad;qc.InteractiveMorphSelector=td;qc.printValue=Gb;qc.RemoteInspectionTree=hf;qc.InspectionTree=Ze;qc.isMultiValue=Tb;qc.valueWidgets=fc;qc.popovers=zc;qc.DarkTheme=hg;qc.DefaultTheme=Xc;qc.syncEval=tc;qc.inspectorCommands=[{name:"focus codeEditor",exec:function(Ma){Ma.get("codeEditor").show();
Ma.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Ma){Ma.get("propertyTree").show();Ma.get("propertyTree").focus();return!0}}];(function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),dc=fb.hasOwnProperty("DraggedProp")&&"function"===typeof fb.DraggedProp?fb.DraggedProp:fb.DraggedProp=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:"applyToTarget",
value:function(za){var Fa=this.currentTarget,Na=this.control;this.remove();qc.MorphHighlighter.removeHighlighters(za.world);if(Fa)if(Fa.isText&&"js"===Fa.editorModeName){var fa=Fa.evalEnvironment.context;za=Fa.textPositionFromPoint(Fa.localize(za.position));fa=qc.generateReferenceExpression(this.sourceObject,{fromMorph:fa});Na.keyString&&(fa+="."+Na.keyString);Fa.insertTextAndSelect(fa,za);Fa.focus()}else"propertyValue"in Na&&(Fa[Na.keyString]=Na.propertyValue)}},{key:"update",value:function(za){za=
za.hand.globalPosition;var Fa=this.morphBeneath(za);if(Fa){for(Fa==this.morphHighlighter&&(Fa=Fa.morphBeneath(za));[Fa].concat($jscomp.arrayFromIterable(Fa.ownerChain())).find(function(Na){return!Na.visible});)Fa=Fa.morphBeneath(za);if(Fa!=this.currentTarget){this.currentTarget=Fa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(Fa.isWorld)return;this.morphHighlighter=qc.MorphHighlighter.for($world,Fa);this.morphHighlighter.show()}this.position=za}}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:qc.Color.rgb(169,204,227)},fill:{defaultValue:qc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var za=this.control;if(!za)return this.submorphs=[];this.height=22;this.submorphs=[za];za.top=0;za.fontSize=14;"function"===typeof za.relayout&&za.relayout();this.width=za.width+
20;this.adjustOrigin(qc.pt(10,10))}}}}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1223,end:3665})})(qc.Morph);(function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),dc=fb.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof fb.DraggableTreeLabel?
fb.DraggableTreeLabel:fb.DraggableTreeLabel=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(za){this.draggedProp=new qc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();qc.connect(za.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(za){}},
{key:"onDragEnd",value:function(za){qc.disconnect(za.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(za)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:qc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:qc.Color.transparent},
padding:{defaultValue:qc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(za){this.setProperty("isSelected",za);za?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=za)}}}}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3667,end:5006})})(qc.Label);Ze=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),dc=fb.hasOwnProperty("PropertyControl")&&"function"===typeof fb.PropertyControl?fb.PropertyControl:fb.PropertyControl=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:"menuItems",value:function(){return this._targetMenuItems||
[]}},{key:"renderValueSelector",value:function(za,Fa,Na){za.control=new qc.DropDownSelector({opacity:.8,fill:qc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:Fa,padding:0,values:Na});qc.connect(za.control,"update",za,"propertyValue",{updater:function(fa,Db){this.targetObj.propertyValue!=Db&&fa(Db)}});qc.connect(za,"update",za.control,"selectedValue",{updater:function(fa,Db){Db=Db&&Db.valueOf?Db.valueOf():Db;this.targetObj.propertyValue!=Db&&fa(Db)}});return za}},
{key:"toggleMultiValuePlaceholder",value:function(za){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:qc.Color.transparent,layout:new qc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:qc.arr.range(0,2).map(function(Fa){return{type:"ellipse",fill:qc.Color.gray.withA(.5),reactsToPointer:!1,extent:qc.pt(7,7)}})});za?(qc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),
this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(qc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(za){this.foldableProperties&&this.toggleMultiValuePlaceholder(qc.isMultiValue(za,this.foldableProperties))}},{key:"asFoldable",value:function(za){this.foldableProperties=za;qc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();
this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var za=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});
za.isLayoutable=!1;za.fontWeight="bold";za.fontColor=qc.Color.orange;za.reactsToPointer=!1;za.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(za){this.submorphs=[za]}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[];qc.connect(this,
"extent",this,"relayout")}}}}},{key:"inferType",value:function(za){return(za=za.value)&&(za.isColor||za.isGradient)?"Color":za&&za.isPoint?"Point":qc.obj.isBoolean(za)?"Boolean":qc.obj.isNumber(za)?"Number":qc.obj.isString(za)?"String":za&&za.isRectangle?"Rectangle":!1}},{key:"render",value:function(za){za.spec.type||(za.spec=Object.assign({},za.spec,{isFloat:!Number.isInteger(za.value),type:this.inferType(za)}));switch(za.spec.type){case "Color":var Fa=this.renderColorControl(za);break;case "ColorGradient":Fa=
this.renderColorControl(Object.assign({},za,{gradientEnabled:!0}));break;case "Number":Fa=this.renderNumberControl(za);break;case "String":Fa=this.renderStringControl(za);break;case "RichText":Fa=this.renderStringControl(za);break;case "Layout":Fa=this.renderLayoutControl(za);break;case "Enum":Fa=this.renderEnumControl(za);break;case "Shadow":Fa=this.renderShadowControl(za);break;case "Point":Fa=this.renderPointControl(za);break;case "Rectangle":Fa=this.renderRectangleControl(za);break;case "Boolean":Fa=
this.renderBooleanControl(za);break;default:Fa=this.renderItSomehow(za)}Fa.control&&(qc.connect(Fa.control,"openWidget",Fa,"openWidget"),Fa.toggleFoldableValue(za.value));return Fa}},{key:"baseControl",value:function(za){var Fa=za.spec;za=new this({keyString:za.keyString,valueString:za.valueString,isSelected:!1,propertyValue:za.value});Fa.foldable&&za.asFoldable(Fa.foldable);return za}},{key:"renderGrabbableKey",value:function(za){var Fa=this,Na=za.target;return[za.keyString+":",{nativeCursor:"-webkit-grab",
onDragStart:function(fa){fa.state.draggedProp=new qc.DraggedProp({sourceObject:Na,control:Fa.baseControl(za)});fa.state.draggedProp.openInWorld();qc.connect(fa.hand,"update",fa.state.draggedProp,"update")},onDrag:function(fa){},onDragEnd:function(fa){qc.disconnect(fa.hand,"update",fa.state.draggedProp,"update");fa.state.draggedProp.applyToTarget(fa)}}]}},{key:"renderEnumControl",value:function(za){var Fa=za.value,Na=za.spec.values,fa=za.keyString,Db=za.target,sa=za.node,La=function(Wa,Jb){return $jscomp.asyncExecutePromiseGeneratorProgram(function(rc){Db.world().openWorldMenu(Wa,
Na.map(function(Lc){return{string:Lc.toString(),action:function(){Db[fa]=Lc;sa.rerender()}}}));rc.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(za)),[" "+(Fa?Fa.valueOf?Fa.valueOf():Fa:"Not set"),{nativeCursor:"pointer",onMouseDown:La}],$jscomp.arrayFromIterable(qc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:La})))}},{key:"renderStringControl",value:function(za){var Fa=za.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(za)),
[" "+(200<Fa.length?Fa.slice(0,20)+"...":Fa),{fontColor:qc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(za){var Fa=za.value,Na=za.keyString,fa=za.valueString,Db=za.target,sa=za.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(za)),[" "+fa,{fontColor:qc.Color.black,nativeCursor:"pointer",onMouseDown:function(La){var Wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Jb){if(1==Jb.nextAddress)return Wa=new qc.popovers.RectanglePopover({hasFixedPosition:!0,
rectangle:Fa}),Wa.relayout(),Jb.yield(Wa.fadeIntoWorld(La.positionIn(Db.world())),2);qc.connect(Wa,"rectangle",function(rc){Db[Na]=rc;sa.rerender()});Jb.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(za){var Fa=za.value,Na=za.keyString,fa=za.valueString,Db=za.target,sa=za.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(za)),[" "+fa,{nativeCursor:"pointer",fontColor:Fa?qc.Color.green:qc.Color.red,onMouseDown:function(La){Db[Na]=!Db[Na];sa.rerender()}}])}},{key:"renderNumberControl",
value:function(za){var Fa=za.value,Na=za.spec,fa=za.keyString,Db=za.valueString,sa=za.node,La=za.target,Wa=za.tree,Jb=void 0===sa._numberControls?new ji:sa._numberControls,rc=$jscomp.makeIterator(Jb.submorphs),Lc=rc.next().value,Sc=rc.next().value;Jb.fontColor=Wa.fontColor;var Rc=sa._numberControls=Jb;"max"in Na&&"min"in Na&&-Infinity!=Na.min&&Infinity!=Na.max?(Rc.baseFactor=(Na.max-Na.min)/100,Rc.floatingPoint=Na.isFloat,Rc.max=Na.max,Rc.min=Na.min):(Rc.floatingPoint=Na.isFloat,Rc.baseFactor=.5,
Rc.min=void 0!=Na.min?Na.min:-Infinity,Rc.max=void 0!=Na.max?Na.max:Infinity);var rd=qc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(za)),$jscomp.arrayFromIterable(sa._inputMorph?[sa._inputMorph,{}]:[" "+(void 0!=Fa&&(Fa.valueOf?Fa.valueOf():Fa).toFixed(Na.isFloat?Math.max(4,qc.num.precision(Fa)):0))+" ",{fontColor:rd,onMouseUp:function(Vd){sa._inputMorph=qc.morph({type:"input",fill:null,fontColor:rd,fontFamily:"IBM Plex Mono",
fontSize:14,padding:qc.rect(8,2,-6,2),height:23,cursorColor:qc.Color.white,value:Fa.valueOf?Fa.valueOf():Db});La[fa]=Fa;sa._inputMorph.focus();qc.once(sa._inputMorph,"inputAccepted",function(se){delete sa._inputMorph;La[fa]=Na.isFloat?Number.parseFloat(se):Number.parseInt(se);sa.rerender()});qc.once(sa._inputMorph,"onBlur",function(se){sa._inputMorph&&(delete sa._inputMorph,La[fa]=Fa,sa.rerender())});sa.rerender()},onDragStart:function(Vd){Rc.scrubbedValue=Fa;qc.onNumberDragStart(Vd,Rc)},onDrag:function(Vd){La[fa]=
qc.onNumberDrag(Vd,Rc);sa.rerender()},onDragEnd:function(Vd){return qc.onNumberDragEnd(Vd,Rc)}},Jb,{onMouseUp:function(){Lc.fill=Sc.fill=null},onMouseDown:function(Vd){if(Vd.targetMorph===Lc){Lc.fill=qc.Color.white.withA(.2);if("max"in Na&&La[fa]>=Na.max)return;La[fa]+=1}if(Vd.targetMorph===Sc){Sc.fill=qc.Color.white.withA(.2);if("min"in Na&&La[fa]<=Na.min)return;--La[fa]}sa.rerender()}}]))}},{key:"renderShadowControl",value:function(za){var Fa=za.keyString,Na=za.value,fa=za.target,Db=za.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(za)),
[""+(Na?Na.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(sa){var La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wa){if(1==Wa.nextAddress)return La=new qc.popovers.ShadowPopover({shadowValue:fa[Fa],hasFixedPosition:!0}),Wa.yield(La.fadeIntoWorld(sa.positionIn(fa.world())),2);qc.connect(La,"shadowValue",function(Jb){fa[Fa]=Jb;Db.rerender()});Wa.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(za){var Fa=za.keyString,Na=za.value,fa=za.target,Db=za.node,
sa=qc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,La={nativeCursor:"pointer",onMouseDown:function(Wa){var Jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rc){if(1==rc.nextAddress)return Jb=new qc.popovers.PointPopover({pointValue:fa[Fa],hasFixedPosition:!0}),rc.yield(Jb.fadeIntoWorld(Wa.positionIn(fa.world())),2);qc.connect(Jb,"pointValue",function(Lc){fa[Fa]=Lc;Db.rerender()});rc.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(za)),
[" pt(",Object.assign({},La),""+Na.x.toFixed(),Object.assign({fontColor:sa},La),",",Object.assign({},La),""+Na.y.toFixed(),Object.assign({fontColor:sa},La),")",Object.assign({},La)])}},{key:"renderLayoutControl",value:function(za){var Fa=za.valueString,Na=za.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(za)),[" "+(Na?Fa:"No Layout"),{onMouseDown:function(fa){}}])}},{key:"renderColorControl",value:function(za){var Fa=za.node,Na=za.gradientEnabled,fa=za.valueString,Db=za.keyString,
sa=za.value,La=za.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(za)),[qc.morph({fill:sa.valueOf?sa.valueOf():sa,extent:qc.pt(15,15),borderColor:qc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(sa?sa.valueOf?sa.valueOf():fa:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Wa){var Jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rc){if(1==rc.nextAddress)return Jb=new qc.popovers.FillPopover({hasFixedPosition:!0,
handleMorph:La,fillValue:sa,title:"Fill Control",gradientEnabled:Na}),rc.yield(Jb.fadeIntoWorld(Wa.positionIn(La.world())),2);qc.connect(Jb,"fillValue",function(Lc){La[Db]=Lc;Fa.rerender()});rc.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(za){var Fa=za.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(za)),[" "+Fa,{}])}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5015,end:20308})}(qc.DraggableTreeLabel);qc.PropertyControl=Ze;qc.PropertyControl=Ze;qc.PropertyControl=Ze;qc.inspect=Pa;qc.inspect=Pa;qc.remoteInspect=ca;qc.remoteInspect=ca;qc.generateReferenceExpression=Ha;qc.generateReferenceExpression=Ha;var ji=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),dc=fb.hasOwnProperty("NumberControls")&&"function"===typeof fb.NumberControls?fb.NumberControls:fb.NumberControls=
function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new qc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:qc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(za){this.submorphs.map(function(Fa){return Fa.fontColor=
za})}},submorphs:{initialize:function(){this.submorphs=[qc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:qc.rect(5,2,0,-6),fontSize:12}),qc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:qc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22981,end:24026})}(qc.Morph);(function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),dc=fb.hasOwnProperty("PropertyTree")&&"function"===typeof fb.PropertyTree?fb.PropertyTree:fb.PropertyTree=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:"onDrag",value:function(za){this._onDragHandler&&this._onDragHandler(za)}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25191,end:25302})})(qc.Tree);Ze=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),dc=fb.hasOwnProperty("Inspector")&&"function"===
typeof fb.Inspector?fb.Inspector:fb.Inspector=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(za){}},{key:"__after_deserialize__",value:function(za,Fa,Na){var fa=this,Db=new qc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,
{treeData:qc.InspectionTree.forObject(null,this)}));this.addMorph(Db,this.getSubmorphNamed("terminal toggler"));Vb._get(Object.getPrototypeOf(dc.prototype),"__after_deserialize__",this).call(this,za,Fa,Na);!this.isComponent&&this.master.whenApplied().then(function(){fa.layout.col(0).row(1).group.morph=Db;fa.targetObject&&(fa.targetObject=fa.targetObject)})}},{key:"__additionally_serialize__",value:function(za,Fa,Na,fa){za=za.props.submorphs.value;for(Fa=za.length;Fa--;)Na.refForId(za[Fa].id).realObj==
this.ui.propertyTree&&qc.arr.removeAt(za,Fa)}},{key:"renderDraggableTreeLabel",value:function(za){return new qc.DraggableTreeLabel(za)}},{key:"renderPropertyControl",value:function(za){return qc.PropertyControl.render(za)}},{key:"onLoad",value:function(){var za=this.ui,Fa=za.codeEditor,Na=za.thisBindingSelector,fa=za.propertyTree;Fa.changeEditorMode("js").then(function(){return Fa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Na.selection?Fa.owner.selectedContext:
Fa.owner.targetObject},get systemInterface(){return qc.Path("treeData.systemInterface").get(fa)},format:"esm"}}).catch(function(Db){return $world.logError(Db)})}},{key:Symbol.for("lively-instance-initialize"),value:function(za){Vb._get(Object.getPrototypeOf(dc.prototype),Symbol.for("lively-instance-initialize"),this).call(this,za);za=this.ui;var Fa=za.targetPicker,Na=za.propertyTree,fa=za.resizer,Db=za.terminalToggler,sa=za.unknowns,La=za.internals,Wa=za.searchField,Jb=za.codeEditor,rc=za.fixImportButton,
Lc=za.thisBindingSelector;Jb.changeEditorMode("js").then(function(){return Jb.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Lc.selection?Jb.owner.selectedContext:Jb.owner.targetObject},get systemInterface(){return Na.treeData.systemInterface},format:"esm"}}).catch(function(Sc){return $world.logError(Sc)});qc.connect(Fa,"onMouseUp",this,"selectTarget");qc.connect(Na,"onScroll",this,"repositionOpenWidget");qc.connect(fa,"onDrag",this,"adjustProportions");
qc.connect(Db,"onMouseDown",this,"toggleCodeEditor");qc.connect(sa,"trigger",this,"filterProperties");qc.connect(La,"trigger",this,"filterProperties");qc.connect(Wa,"searchInput",this,"filterProperties");qc.connect(Na,"nodeCollapseChanged",this,"filterProperties");qc.connect(this,"extent",this,"relayout");qc.connect(Lc,"selection",this,"bindCodeEditorThis");qc.connect(rc,"fire",Jb,"execCommand",{updater:function(Sc){return Sc("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},
{key:"refreshSelectedLine",value:function(){var za=this.ui.propertyTree.selectedIndex-1,Fa=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();Fa=this.ui.propertyTree.document.getLine(za).textAndAttributes.slice(0,4).concat(Fa.display(this));za=this.ui.propertyTree.lineRange(za,!1);this.ui.propertyTree.replace(za,Fa,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();
if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var za=qc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(za!=this.lastChange||this.lastSubmorphs!=qc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==za.prop&&this.repositionOpenWidget(),this.lastChange=za,this.lastSubmorphs=
qc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var za;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(Fa){Fa=Fa.node;Fa.target&&(za=Fa.foldableNode?Fa.target[Fa.foldableNode.key][Fa.key]:Fa.target[Fa.key],!qc.obj.equals(za,Fa.value)&&Fa.refreshProperty&&Fa.refreshProperty(za))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},
{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(za,Fa){Fa=void 0===Fa?!1:Fa;var Na=this,fa,Db,sa,La,Wa,Jb,rc,Lc,Sc,Rc,rd,Vd,se,Kd,Ee;return $jscomp.asyncExecutePromiseGeneratorProgram(function(le){switch(le.nextAddress){case 1:if(!Na.isUpdating()){le.jumpTo(2);break}return le.yield(Na.whenUpdated(),2);case 2:fa=qc.promise.deferred();Db=fa.promise;sa=!!Na.target;Na.updateInProgress=Db;le.setCatchFinallyBlocks(4);Fa&&(La=qc.LoadingIndicator.open("connecting to remote..."));
if(!Fa){Wa=qc.InspectionTree.forObject(za,Na);le.jumpTo(6);break}return le.yield(qc.RemoteInspectionTree.forObject(za,Na),7);case 7:Wa=le.yieldResult;case 6:return Jb=Wa,rc=Na.ui.propertyTree,le.yield(Jb.collapse(Jb.root,!1),8);case 8:if(!Jb.root.children){le.jumpTo(9);break}return le.yield(Jb.collapse(Jb.root.children[0],!1),9);case 9:if(Lc=Na.originalTreeData&&Na.originalTreeData.diff(Jb)){Sc=$jscomp.makeIterator(Lc);for(Rc=Sc.next();!Rc.done;Rc=Sc.next())rd=Rc.value,Vd=$jscomp.makeIterator(rd),
se=Vd.next().value,Kd=Vd.next().value,se.refreshProperty(Kd.value);le.jumpTo(11);break}rc.treeData=Jb;return le.yield(Na.filterProperties(),12);case 12:if(!rc.treeData.root.isCollapsed){le.jumpTo(13);break}return le.yield(rc.onNodeCollapseChanged({node:Jb.root,isCollapsed:!1}),14);case 14:rc.selectedIndex=1;case 13:return le.yield(rc.execCommand("uncollapse selected node"),11);case 11:Na.toggleWindowStyle(sa);La&&La.remove();le.leaveTryBlock(5);break;case 4:Ee=le.enterCatchBlock(),Na.showError(Ee);
case 5:Na.startStepping(1E3,"refreshAllProperties"),Na.updateInProgress=null,le.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(za){za=void 0===za?!0:za;var Fa=this,Na,fa,Db,sa,La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wa){if(1==Wa.nextAddress)return Na=300,sa=Fa.ui.codeEditor.pluginFind(function(Jb){return Jb.runEval}),La=Fa.getWindow(),Wa.yield(sa.runEval("System.get('@system-env').node"),2);Wa.yieldResult.value?(Db=[].concat($jscomp.arrayFromIterable(qc.arr.without(La.styleClasses,
"local")),["node"]),fa=qc.DarkTheme.instance):(Db=["local"].concat($jscomp.arrayFromIterable(La?qc.arr.without(La.styleClasses,"node"):[])),fa=qc.DefaultTheme.instance);sa.theme=fa;za?(La&&La.animate({duration:Na,styleClasses:Db}),Fa.ui.codeEditor.animate({fill:fa.background,duration:Na})):La&&(La.styleClasses=Db);Fa.ui.codeEditor.textString=Fa.ui.codeEditor.textString;sa.highlight();Wa.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||
Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var za=this,Fa=Object.assign({type:"text",borderWidth:1,borderColor:qc.Color.gray,lineWrapping:"by-chars"},qc.config.codeEditor.defaultStyle,{textString:""}),Na=qc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});qc.rect(0,0,this.width,30);var fa=new qc.SearchField({styleClasses:["idle"],name:"searchField"});Na[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[fa,
{type:"button",name:"targetPicker",padding:qc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:qc.Icon.textAttribute("crosshairs")},new qc.LabeledCheckBox({label:"Internals",name:"internals"}),new qc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new qc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:qc.InspectionTree.forObject(null,this)})),qc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),
{name:"resizer"},Object.assign({name:"codeEditor"},Fa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:qc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Na),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Na),[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=
3;this.ui.thisBindingSelector.whenRendered().then(function(){za.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var za=this,Fa,Na,fa,Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sa){switch(sa.nextAddress){case 1:if(za.env.eventDispatcher.isKeyPressed("Shift"))return Na=$jscomp,fa=Na.makeIterator,sa.yield($world.execCommand("select morph",{justReturn:!0}),5);za.toggleSelectionInstructions(!0);return sa.yield(qc.InteractiveMorphSelector.selectMorph(),
4);case 4:Fa=sa.yieldResult;za.toggleSelectionInstructions(!1);sa.jumpTo(3);break;case 5:Db=fa.call(Na,sa.yieldResult),Fa=Db.next().value;case 3:Fa&&(za.targetObject=Fa),sa.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(za){if(za&&!this.instructionWidget){var Fa=qc.morph({type:"label",name:"escapeKey",value:"esc"});Fa.whenRendered().then(function(){return Fa.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,
lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},Fa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(za){za=za.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;
za.epiMorph=!0;this.openWidget=za;qc.once(za,"close",this,"closeOpenWidget");qc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var za=this.ui.propertyTree,Fa=za.textLayout.boundsFor(za,{column:0,row:za.selectedIndex-1});Fa=za.worldPoint(qc.pt(Fa.x,Fa.y+Fa.height/2)).addPt(za.scroll.negated());za=za.globalBounds();Fa.x=this.globalBounds().center().x;Fa.y<za.top()?Fa=za.topCenter():za.bottom()-20<Fa.y&&(Fa=za.bottomCenter().addXY(0,-20));
return Fa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(za){this.layout.row(1).height+=za.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(za){if(za!==this.isEditorVisible()){var Fa=this.extent,Na=this.layout,fa=this.ui,Db=fa.terminalToggler,sa=fa.codeEditor,La=fa.thisBindingSelector;
fa=fa.fixImportButton;Na.disable();za?(Db.fontColor=qc.Color.rgbHex("00e0ff"),Na.row(3).height=this.codeEditorHeight||180,Na.row(2).height=5,fa.animate({visible:!0,duration:200}),La.animate({visible:!0,duration:200})):(this.codeEditorHeight=Na.row(3).height,Db.fontColor=qc.Color.white,Na.row(3).height=Na.row(2).height=0,fa.animate({visible:!1,duration:200}),La.animate({visible:!1,duration:200}));this.extent=Fa;Na.enable({duration:200});this.relayout({duration:200});sa.focus();sa.animate({opacity:za?
1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var za=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){za.makeEditorVisible(!za.isEditorVisible());Fa.jumpToEnd()})}},{key:"filterProperties",value:function(){var za=this,Fa,Na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fa){if(1==fa.nextAddress)return Fa=za.ui.searchField,Na=za.ui.propertyTree,za.originalTreeData||(za.originalTreeData=Na.treeData),qc.disconnect(Na.treeData,"onWidgetOpened",za,"onWidgetOpened"),
fa.yield(Na.treeData.filter({maxDepth:2,showUnknown:za.ui.unknowns.checked,showInternal:za.ui.internals.checked,iterator:function(Db){return Fa.matches(Db.key)}}),2);Na.update();qc.connect(Na.treeData,"onWidgetOpened",za,"onWidgetOpened");fa.jumpToEnd()})}},{key:"relayout",value:function(za){za=void 0===za?{}:za;var Fa=this,Na,fa,Db,sa,La,Wa,Jb,rc,Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){Fa.layout&&Fa.layout.forceLayout();Na=Fa;fa=Na.ui;Db=fa.fixImportButton;sa=fa.terminalToggler;
La=fa.propertyTree;Wa=fa.thisBindingSelector;Jb=La.bounds().insetBy(5).bottomLeft();rc=La.bounds().insetBy(5).bottomRight();Lc=rc.subXY(Db.width+10,0);Wa.width=115;Wa.listMorph.itemHeight=20;za.duration?(sa.animate(Object.assign({bottomLeft:Jb},za)),Db.animate(Object.assign({bottomRight:rc},za)),Wa.animate(Object.assign({bottomRight:Lc},za))):(sa.bottomLeft=Jb,Db.bottomRight=rc,Wa.bottomRight=Lc);Sc.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},
{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Vb._get(Object.getPrototypeOf(dc.prototype),"keybindings",this))}},{key:"commands",get:function(){return qc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(za){if(System._testsRunning)return console.log(za.targetObject);za=new this(za);za.openInWindow().doNotAcceptDropsForThisAndSubmorphs();
return za}},{key:"properties",get:function(){return{extent:{defaultValue:qc.pt(400,500)},fill:{defaultValue:qc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(za){this.setProperty("remoteTarget",za);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(za,!0))}},targetObject:{after:["submorphs"],set:function(za){this._serializableTarget=za&&za.isMorph?za.id:za;this.setProperty("targetObject",
za);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(za))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var za=this.ui.propertyTree,Fa=za.treeData;return Fa.getContextFor(za.selectedNode||Fa.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),
thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:qc.Color.gray,
fontSize:14,fontFamily:qc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],fb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25319,end:45910})}(qc.Morph);Ze=qc.Inspector;hf=Sa("I",Ze);qc.default=
Ze;var qf=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");qf.Inspector=hf;qf.string=bd;qf.Morph=Ic;qf.pt=sd;qf.Color=Lb;Ze=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Ma,fb,dc){dc=void 0===dc?1:dc;var za,Fa,Na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fa){switch(fa.nextAddress){case 1:return Ma.maybeSelectCommentOrLine(),fa.setCatchFinallyBlocks(2),fb=Object.assign({},fb,{logDoit:!0,inspect:!0,
inspectDepth:dc}),fa.yield(Ma.doEval(void 0,fb),4);case 4:za=fa.yieldResult;Fa=za.error?za.error:za.isError?za.value:null;fa.leaveTryBlock(3);break;case 2:Fa=Na=fa.enterCatchBlock();case 3:return Fa?Ma.showError(Fa):Ma.setStatusMessage(qf.string.truncate(za.value,1E3)),fa.return(za)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Ma,fb){var dc,za,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Na){switch(Na.nextAddress){case 1:return Na.setCatchFinallyBlocks(2),
Na.yield(Ma.doEval({start:{row:0,column:0},end:Ma.documentEndPosition},Object.assign({},fb,{logDoit:!0})),4);case 4:dc=Na.yieldResult;za=dc.error?dc.error:dc.isError?dc.value:null;Na.leaveTryBlock(3);break;case 2:za=Fa=Na.enterCatchBlock();case 3:return za?Ma.showError(za):Ma.setStatusMessage(String(dc.value)),Na.return(dc)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Ma,fb){var dc,za,Fa,Na,fa,Db,sa,La;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wa){switch(Wa.nextAddress){case 1:return Ma.maybeSelectCommentOrLine(),
Wa.setCatchFinallyBlocks(2),fb=Object.assign({},fb,{asString:!1,logDoit:!0}),Wa.yield(Ma.doEval(void 0,fb),4);case 4:dc=Wa.yieldResult;za=dc.error?dc.error:dc.isError?dc.value:null;Wa.leaveTryBlock(3);break;case 2:za=Fa=Wa.enterCatchBlock();case 3:Ma.selection.collapseToEnd();if(Na=dc.value&&dc.value.isColor)return Ma.selection.text=String(dc.value),fa=new qf.Morph({fill:qf.Color.transparent,extent:qf.pt(Ma.fontSize+2,Ma.fontSize+2),submorphs:[{fill:dc.value,center:qf.pt(Ma.fontSize+2,Ma.fontSize+
2).scaleBy(.5)}]}),Db=Ma.selection.start,sa=Db.column,La=Db.row,Ma.insertText([fa,{}],Ma.selection.start),Ma.selection.start={column:sa,row:La},Ma.focus(),Wa.return(dc);Ma.insertTextAndSelect(za?String(za)+(za.stack?"\n"+za.stack:""):String(dc.value));Ma.focus();return Wa.return(dc)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Ma,fb){var dc,za,Fa,Na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fa){switch(fa.nextAddress){case 1:Ma.maybeSelectCommentOrLine();
za=Ma.textInRange(Ma.selection);Fa=Ma.evalEnvironment||{};Na=Ma.pluginFind(function(Db){return Db.isEditorPlugin&&"function"===typeof Db.runEval});Fa.systemInterface||(Fa.systemInterface=Na.systemInterface(fb));if("local"!==Fa.systemInterface.name){fa.jumpTo(2);break}fa.setCatchFinallyBlocks(3);return fa.yield(Ma.doEval(void 0,fb),5);case 5:dc=fa.yieldResult;za=dc.value;fa.leaveTryBlock(2);break;case 3:fa.enterCatchBlock();case 2:return Ma.world().execCommand("open object editor",{target:za,evalEnvironment:Fa}),
fa.return(dc)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Ma,fb){var dc,za,Fa,Na,fa,Db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sa){switch(sa.nextAddress){case 1:Ma.maybeSelectCommentOrLine();Fa=Ma.textInRange(Ma.selection);Na=Ma.evalEnvironment||{};fa=Ma.pluginFind(function(La){return La.isEditorPlugin&&"function"===typeof La.runEval});Na.systemInterface||(Na.systemInterface=fa.systemInterface(fb));
if("local"!==Na.systemInterface.name){qf.Inspector.openInWindow({remoteTarget:{code:Fa,evalEnvironment:Na}});sa.jumpTo(2);break}sa.setCatchFinallyBlocks(3);return sa.yield(Ma.doEval(void 0,fb),5);case 5:dc=sa.yieldResult;za=dc.error?dc.error:dc.isError?dc.value:null;Fa=dc.value;sa.leaveTryBlock(4);break;case 3:za=Db=sa.enterCatchBlock();case 4:qf.Inspector.openInWindow({targetObject:za||Fa});case 2:return sa.return(dc)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(Ma,fb,dc){dc=void 0===dc?1:dc;var za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return Ma.maybeSelectCommentOrLine(),Fa.setCatchFinallyBlocks(2),fb=Object.assign({},fb,{inspect:!0,inspectDepth:dc,logDoit:!0}),Fa.yield(Ma.doEval(void 0,fb),4);case 4:za=Fa.yieldResult;Fa.leaveTryBlock(3);break;case 2:Fa.enterCatchBlock();case 3:return Ma.selection.collapseToEnd(),Ma.insertTextAndSelect(za.value),Fa.return(za)}})}}];qf.codeEvaluationCommands=
Ze;qf.codeEvaluationCommands=Ze;qf.codeEvaluationCommands=Ze;var Sd=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Sd.changeAttributeInSelectionOrMorph=function(Ma,fb,dc){var za=Ma.selection;Ma.keepPosAtSameScrollOffsetWhile(function(){za.isEmpty()?Ma[fb]="function"===typeof dc?dc(Ma[fb]):dc:Ma.undoManager&&(Ma.undoManager.group(),Ma.changeStyleProperty(fb,function(Fa){return"function"===typeof dc?dc(Fa):dc}),Ma.undoManager.group())})};hf=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(Ma){var fb=Ma.fontSize;Sd.changeAttributeInSelectionOrMorph(Ma,"fontSize",function(dc){dc=dc||fb;return dc+(18<=dc?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Ma){var fb=Ma.fontSize;Sd.changeAttributeInSelectionOrMorph(Ma,"fontSize",function(dc){dc=dc||fb;return dc-(18>=dc?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Ma){var fb,dc,za,Fa,Na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fa){if(1==fa.nextAddress){fb=
["serif","sans-serif","monospace"];if(dc=localStorage["lively.morpic/text-change-font-additional-fonts"])dc=JSON.parse(dc),fb.push.apply(fb,$jscomp.arrayFromIterable(dc));fb.map(function(Db){return Db.toLowerCase()}).includes(Ma.fontFamily.toLowerCase())||(fb.push(Ma.fontFamily),dc=[].concat($jscomp.arrayFromIterable(dc||[]),[Ma.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(dc));return fa.yield($world.editListPrompt("choose font",fb,{requester:Ma,preselect:fb.indexOf(Ma.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}za=fa.yieldResult;Fa=$jscomp.makeIterator(za.selections);if(Na=Fa.next().value)Ma.fontFamily=Na;return fa.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Ma,fb){fb=void 0===fb?{}:fb;var dc,za,Fa,Na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fa){if(1==fa.nextAddress){if(fb.hasOwnProperty("link"))return fa.jumpTo(2);za=Ma.selection;Fa=Ma.getStyleInRange(za);Na=Fa.link;return fa.yield(Ma.world().prompt("Set link",
{input:Na||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=fa.nextAddress&&(dc=fa.yieldResult,!dc))return fa.return();Ma.undoManager.group();Ma.setStyleInRange({link:dc||void 0},za);Ma.undoManager.group();fa.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Ma,fb){var dc,za,Fa,Na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fa){if(1==fa.nextAddress)return dc=Ma.selection,za=Ma.getStyleInRange(dc),Fa=za.doit,fa.yield(Ma.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:Ma,input:Fa?Fa.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Ma.evalEnvForDoit(Fa||{})}),2);Na=fa.yieldResult;Ma.undoManager.group();Na?Ma.addTextAttribute({doit:{code:Na},nativeCursor:"pointer",textDecoration:"underline"},dc):Ma.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},dc);Ma.undoManager.group();fa.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Ma,fb){fb=void 0===fb?{}:fb;Ma.undoManager.group();
fb=!fb.onlySelection&&Ma.selection.isEmpty()?Ma.documentRange:Ma.selection.range;Ma.setStyleInRange(null,fb);Ma.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Ma){var fb,dc,za,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Na){if(1==Na.nextAddress)return Na.yield(System.import("lively.modules"),2);if(3!=Na.nextAddress)return fb=Na.yieldResult,dc=fb.module,Na.yield(dc("lively.ide/text/ui.js").load(),3);za=Na.yieldResult;Fa=za.RichTextControl;return Na.return(Fa.openFor(Ma))})}}];
Sd.commands=hf;Sd.commands=hf;Sd.commands=hf;var oe=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");oe.guessTextModeName=cb;oe.rangedToken=function(Ma,fb,dc,za,Fa){return{start:{row:Ma,column:fb},end:{row:Ma,column:dc},token:za,mode:Fa}};oe.fun=Ec;oe.arr=Fc;oe.connect=Zc;oe.disconnect=Zb;oe.DefaultTheme=Xc;oe.tokenizeDocument=Vc;oe.modeInfo=sc;oe.visitDocumentTokens=eb;oe.getMode=Ja;oe.completionCommands=Ed;oe.multiSelectCommands=Fe;oe.navCommands=z;oe.codeCommands=Ie;oe.codeEvaluationCommands=
Ze;oe.richTextCommands=hf;oe.Color=Lb;oe.Range=ke;oe.guessTextModeName=cb;oe.guessTextModeName=cb;Xc=function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),dc=fb.hasOwnProperty("EditorPlugin")&&"function"===typeof fb.EditorPlugin?fb.EditorPlugin:fb.EditorPlugin=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(dc,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
oe.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(za){var Fa=this;this.textMorph=za;oe.connect(za,"textChange",this,"onTextChange");oe.connect(za,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return Fa.highlight()})}},
{key:"detach",value:function(za){oe.disconnect(za,"textChange",this,"onTextChange");oe.disconnect(za,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(za){this._ast=null;if(za){var Fa=this._tokenizerValidBefore;if("replace"===za.selector){var Na=za.args[0].start;za=Na.row;Na=Na.column}else Na=za=0;if(!Fa||za<Fa.row||za===Fa.row&&Na<Fa.column)za=Math.max(0,za),this._tokenizerValidBefore={row:za,
column:Na}}this.requestHighlight()}},{key:"requestHighlight",value:function(za){var Fa=this;(void 0===za?0:za)?this.highlight():oe.fun.debounceNamed(this.textMorph.id+"-requestHighlight",300,function(){Fa.highlight()})()}},{key:"highlight",value:function(){var za=this.textMorph,Fa=this.theme,Na=this.mode,fa=this._tokenizerValidBefore;if(Fa&&za&&za.document&&Na){za.fill=Fa.background;za.cursorColor=Fa.cursorColor||za.fontColor;var Db=za.viewState,sa={};fa=oe.tokenizeDocument(Na,za.document,Db.firstVisibleRow,
Db.lastVisibleRow,fa);Na=fa.lines;fa=fa.tokens;if(Na.length){Db=Na[0].row;for(var La=[],Wa=0;Wa<fa.length;Db++,Wa++)for(var Jb=fa[Wa],rc=0;rc<Jb.length;rc+=5){var Lc=Jb[rc],Sc=Jb[rc+1],Rc=Fa[Jb[rc+2]]||Fa.default;Rc&&La.push({start:{row:Db,column:Lc},end:{row:Db,column:Sc}},Rc)}za.embeddedMorphs.forEach(function(rd){var Vd=za.embeddedMorphMap.get(rd).anchor;sa[rd.id]=za.textAttributeAt(Vd.position)});za.setTextAttributesWithSortedRanges(La);za.embeddedMorphs.forEach(function(rd){var Vd=za.embeddedMorphMap.get(rd).anchor;
Vd=oe.Range.at(Vd.position);Vd.end.column+=1;za.replace(Vd,[rd,sa[rd.id]],!1)});this._tokenizerValidBefore={row:oe.arr.last(Na).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},za,this)}}},{key:"visitTokensInRange",value:function(za,Fa){var Na=za.start,fa=za.end,Db=Na.row-1;oe.visitDocumentTokens(this.mode,this.textMorph.document,Na.row,fa.row,null,function(sa){return Db++},function(sa,La,Wa,Jb,rc,Lc,Sc){if(Db===Na.row&&0<Na.column){if(Na.column>=Jb)return;Wa<Na.column&&Na.column<
Jb&&(Wa=Na.column)}if(Db===fa.row){if(fa.column<=Wa)return;Wa<fa.column&&fa.column<Jb&&(Jb=fa.column)}Fa(sa,La,Db,Wa,Jb,rc,Lc,Sc)})}},{key:"tokensInRange",value:function(za){var Fa=[];this.visitTokensInRange(za,function(Na,fa,Db,sa,La,Wa,Jb,rc){return Fa.push(oe.rangedToken(Db,sa,La,Na,rc))});return Fa}},{key:"tokensOfRow",value:function(za){var Fa=this.textMorph.getLine(za).length;return this.tokensInRange({start:{row:za,column:0},end:{row:za,column:Fa}})}},{key:"tokenAt",value:function(za){for(var Fa=
this.tokensOfRow(za.row),Na=Fa.length;Na--;){var fa=Fa[Na];if(fa.token&&fa.start.column<=za.column&&za.column<=fa.end.column)return fa}return null}},{key:"getCommands",value:function(za){return[].concat($jscomp.arrayFromIterable(za),$jscomp.arrayFromIterable(oe.completionCommands),$jscomp.arrayFromIterable(oe.multiSelectCommands),$jscomp.arrayFromIterable(oe.navCommands),$jscomp.arrayFromIterable(oe.codeCommands),$jscomp.arrayFromIterable(oe.codeEvaluationCommands),$jscomp.arrayFromIterable(oe.richTextCommands))}},
{key:"getComment",value:function(){if(!this.mode)return null;var za=this.mode,Fa=za.lineComment,Na=za.blockCommentStart;za=za.blockCommentEnd;var fa={};Fa&&(fa.lineCommentStart=Fa);Na&&(fa.blockCommentStart=Na);za&&(fa.blockCommentEnd=za);return fa}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(za,Fa,Na){var fa=this.textMorph,Db=za.row,sa=za.column;za=Fa[sa-1];Fa=Fa[sa];fa.selection.text="\n";fa.selection.collapseToEnd();
"{"===za&&"}"===Fa&&(fa.selection.text="\n"+" ".repeat(Na),fa.selection.collapse());fa.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Db+1,lastRow:Db+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var za=this.textMorph,Fa=this.openPairs,Na=za.selection,fa=za.getLine(Na.end.row),
Db=fa[Na.end.column-1];fa=fa[Na.end.column];za.autoInsertPairs&&Na.isEmpty()&&Db in Fa&&fa===Fa[Db]&&(Na.growRight(1),Na.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(za){var Fa=this.openPairs,Na=this.closePairs,fa=this.textMorph,Db=fa.selection,sa=fa.autoInsertPairs&&za in Fa,La=fa.autoInsertPairs&&za in Na;if(!sa&&!La)return!1;var Wa=fa.getLine(Db.end.row)[Db.end.column];if(!Db.isEmpty()){if(!sa)return!1;Na=fa.undoManager.ensureNewGroup(fa);fa.insertText(Fa[za],Db.end);fa.insertText(za,
Db.start);fa.undoManager.group(Na);Db.growRight(-1);return!0}if(Wa in Na&&za===Wa)return Db.goRight(1),!0;if(La&&!sa)return!1;Na=fa.undoManager.ensureNewGroup(fa);fa.insertText(za+Fa[za]);fa.undoManager.group(Na);Db.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],fb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3148,end:12030})}(void 0);sc=Xc=oe.EditorPlugin;Ed=Sa("C",function(Ma){var fb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),dc=fb.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof fb.CodeMirrorEnabledEditorPlugin?fb.CodeMirrorEnabledEditorPlugin:fb.CodeMirrorEnabledEditorPlugin=function(za){za&&za[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Vb(dc,Ma,[{key:Symbol.for("lively-instance-initialize"),value:function(){Vb._get(Object.getPrototypeOf(dc.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(za){this.mode=this.codeMirrorMode(za);return Vb._get(Object.getPrototypeOf(dc.prototype),"attach",this).call(this,za)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",
value:function(za){return{indentWithTabs:!za.useSoftTabs,indentUnit:za.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(za){za=this.defaultCodeMirrorModeConfig(za);return oe.getMode(za,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],fb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:12041,end:12735})}(oe.EditorPlugin));oe.CodeMirrorEnabledEditorPlugin=Ed;oe.CodeMirrorEnabledEditorPlugin=Ed;oe.CodeMirrorEnabledEditorPlugin=Ed;oe.default=Xc;Xc=Object.freeze({__proto__:null,guessTextModeName:cb,"default":sc,CodeMirrorEnabledEditorPlugin:Ed});Sa("e",Xc)}}});
System.register(["./__rootModule___commonjs-entry-71573ff5.js","./index-d18accbd.js","./loading-indicator.cp-b18e3b89.js","@babel/plugin-syntax-import-meta","./tooltips.cp-6a2406c0.js"],function(Lc,pd){var Nd,Tc,Jc,$d,Bb,rd,Id,Ac,Pc,gd,nd,Fd,ic,vd,sb,Xb,Nb,bc,hb,cb,Hb,ec;return{setters:[function(ub){Nd=ub._;Tc=ub.M;Jc=ub.W;$d=ub.a;Bb=ub.T;rd=ub.P;Id=ub.p;Ac=ub.E;Pc=ub.I;gd=ub.L;nd=ub.c;Fd=ub.s;ic=ub.e;vd=ub.b;sb=ub.r;Xb=ub.C;Nb=ub.n;bc=ub.d;hb=ub.f;cb=ub.g;Hb=ub.i},function(){},function(ub){ec=ub.L},
function(){},function(){}],execute:function(){function ub(){return yb.apply(this,arguments)}function yb(){yb=Nd(regeneratorRuntime.mark(function Sb(){var Cb;return regeneratorRuntime.wrap(function(Da){for(;;)switch(Da.prev=Da.next){case 0:return Cb=ba.part(ba.LoadingScreen),Da.next=3,Cb.get("icon").whenFontLoaded();case 3:Cb.respondsToVisibleWindow=!0,$world.addMorph(Cb),Cb.relayout();case 6:case "end":return Da.stop()}},Sb)}));return yb.apply(this,arguments)}Lc("main",ub);var ba=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/loading-screen.cp.js");
ba.main=ub;ba.Morph=Tc;ba.World=Jc;ba.MorphicDB=$d;ba.TilingLayout=Bb;ba.Path=rd;ba.part=Id;ba.Ellipse=Ac;ba.Icon=Pc;ba.Label=gd;ba.component=nd;ba.stringToEasing=Fd;ba.easings=ic;ba.pt=vd;ba.rect=sb;ba.Color=Xb;ba.num=Nb;ba.promise=bc;ba.fun=hb;ba.resource=cb;ba.LoadingIndicator=ec;var wb=Lc("WorldLoadingScreen",function(Za){var Sb=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/loading-screen.cp.js"),Cb=Sb.hasOwnProperty("WorldLoadingScreen")&&"function"===typeof Sb.WorldLoadingScreen?
Sb.WorldLoadingScreen:Sb.WorldLoadingScreen=function(Da){if(!Da||!Da[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Hb(Cb,Za,[{key:"commands",get:function(){var Da=this;return[{name:"resize on client",exec:function(){Da.relayout()}}]}},{key:"__head_html__",get:function(){return'\n<script> window.AUTH_SERVER_URL; \x3c/script>\n<style type="text/css">@import url("https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i&display=swap");</style>'}},
{key:"onLoad",value:function(){var Da=Nd(regeneratorRuntime.mark(function db(){var ib,Ea,W,T,ia;return regeneratorRuntime.wrap(function(ka){for(;;)switch(ka.prev=ka.next){case 0:if(!lively.FreezerRuntime){ka.next=11;break}ib=this.get("package loading indicator");Ea=this.get("css loading screen");W=this.getWorldName();T=this.getFilePath();(ia=this.getSnapshot())?(ib.isLayoutable=ib.visible=!1,Ea.isLayoutable=Ea.visible=!0):(ib.startStepping("updateProgressBar"),document.body.style.backgroundColor=
"black");T&&this.get("json target indicator").animate({opacity:1,duration:300});ka.next=10;return this.transitionToLivelyWorld({worldName:W,filePath:T,snapshot:ia},ib);case 10:ib.stopStepping();case 11:case "end":return ka.stop()}},db,this)}));return function(){return Da.apply(this,arguments)}}()},{key:"transitionToLivelyWorld",value:function(){var Da=Nd(regeneratorRuntime.mark(function Ea(db,ib){var W,T,ia,ka,K,ya,pb;return regeneratorRuntime.wrap(function(La){for(;;)switch(La.prev=La.next){case 0:return W=
db.worldName,T=db.filePath,ia=db.snapshot,ka=ba.resource(window.SYSTEM_BASE_URL||document.location.origin).join("objectdb/").url,La.next=4,pd.import("./bootstrap-17e87dea.js");case 4:K=La.sent;ya=K.bootstrap;La.t0=W&&"__newWorld__"!==W;if(!La.t0){La.next=11;break}La.next=10;return ba.MorphicDB.named("lively.morphic/objectdb/morphicdb",{serverURL:ka}).exists("world",W);case 10:La.t0=!La.sent.exists;case 11:if(!La.t0){La.next=13;break}return La.abrupt("return",this.indicateMissingWorld(!0));case 13:La.t1=
T;if(!La.t1){La.next=18;break}La.next=17;return ba.resource(document.location.origin).join(T).exists();case 17:La.t1=!La.sent;case 18:if(!La.t1){La.next=20;break}return La.abrupt("return",this.indicateMissingWorld(!0));case 20:return pb=ba.LoadingIndicator.open("...starting bootstrap process...",{animated:!0,delay:1E3}),ia&&(pb.visible=!1),La.next=24,ya({worldName:W,filePath:T,loadingIndicator:pb,progress:ib,snapshot:ia});case 24:case "end":return La.stop()}},Ea,this)}));return function(db,ib){return Da.apply(this,
arguments)}}()},{key:"getWorldName",value:function(){return document.location.href.endsWith("worlds/new")?"__newWorld__":ba.resource(document.location.href).query().name||window.WORLD_NAME||!1}},{key:"getFilePath",value:function(){return ba.resource(document.location.href).query().file||!1}},{key:"getSnapshot",value:function(){return ba.resource(document.location.href).query().snapshot||window.SNAPSHOT_PATH||!1}},{key:"relayout",value:function(){$world._cachedWindowBounds=null;this.setBounds($world.windowBounds());
this.get("json target indicator").topRight=this.innerBounds().insetBy(25).topRight()}},{key:"indicateMissingWorld",value:function(Da){this.get("package loading indicator").visible=!Da;this.get("broken heart").visible=this.get("broken heart").isLayoutable=Da}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"WorldLoadingScreen"}},{key:"properties",get:function(){return{title:{derived:!0,get:function(){return"lively.next (".concat(document.location.hostname,")")}}}}}],Sb,{pathInPackage:function(){return"./src/loading-screen.cp.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:348,end:3886})}(ba.Morph));ba.WorldLoadingScreen=wb;ba.WorldLoadingScreen=wb;wb=Lc("default",function(Za){var Sb=window.lively.FreezerRuntime.recorderFor("lively.freezer/src/loading-screen.cp.js"),Cb=Sb.hasOwnProperty("ModuleProgress")&&"function"===typeof Sb.ModuleProgress?Sb.ModuleProgress:
Sb.ModuleProgress=function(Da){if(!Da||!Da[Symbol["for"]("lively-instance-restorer")])return this[Symbol["for"]("lively-instance-initialize")].apply(this,arguments)};return Hb(Cb,Za,[{key:"fadeIntoBack",value:function(){this.animate({blur:5})}},{key:"relayout",value:function(){var Da;this.isComponent||(null===(Da=this.owner)||void 0===Da?0:Da.isWorld)||(this.bottomCenter=$world.visibleBounds().center().subXY(0,100))}},{key:"reset",value:function(){var Da=this.getAllNamed(/stage/);this.blur=0;this.stages=
new Map(Da.map(function(zb){return[zb,"not loaded"]}));this.updateProgressVisualization();this.getAllNamed(/label/).map(function(zb){zb._cachedTextBounds=null;zb.fit()})}},{key:"updateProgressBar",value:function(){if(this._lastWidth){this.relayout();var Da=this.get("progress path"),zb=this.get("stage lang").get("checkmark"),db=ba.stringToEasing(ba.easings.inOutExpo)(ba.num.clamp(Date.now()-this._timeStamp,0,1E3)/1E3);Da.width=ba.num.interpolate(db,this._lastWidth,this._currentProgress);Da.position=
zb.transformPointToMorph(this,zb.extent.scaleByPt(ba.pt(1,.5)))}}},{key:"fastLoadTest",value:function(){var Da=Nd(regeneratorRuntime.mark(function db(){var ib,Ea,W,T;return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:this.reset(),ib="lively.lang lively.ast lively.source-transform lively.classes lively.vm lively.modules lively.user lively.storage lively.morphic".split(" "),Ea=0,W=ib;case 3:if(!(Ea<W.length)){ia.next=11;break}T=W[Ea];this.finishPackage({packageName:T,
loaded:!0});ia.next=8;return ba.promise.delay(200);case 8:Ea++;ia.next=3;break;case 11:case "end":return ia.stop()}},db,this)}));return function(){return Da.apply(this,arguments)}}()},{key:"finishPackage",value:function(Da){var zb=this,db=Da.frozen,ib=Da.loaded;Da="stage "+Da.packageName.replace("lively.","");Da=this.get(Da);db&&this.stages.set(Da,"frozen");ib&&this.stages.set(Da,"loaded");ba.fun.debounceNamed("update progress",200,function(){zb.updateProgressVisualization()})()}},{key:"updateProgressVisualization",
value:function(){var Da=this,zb=this.getSubmorphNamed("progress path"),db=this.getAllNamed(/stage/),ib=db[0];db.forEach(function(Ea){var W=Ea.get("checkmark"),T=Ea.get("frozen indicator"),ia=Ea.get("icon");Ea=Da.stages.get(Ea);if("not loaded"!==Ea){ib=W;if("loaded"===Ea){if(W.visible)return;W.animate({duration:300,visible:!0})}if("frozen"===Ea){if(T.visible)return;T.animate({duration:300,visible:!0})}ia.opacity=1}else W.visible=!1,T.visible=!1,ia.opacity=.2});db=this.localizePointFrom(ba.pt(-10,0),
ib).x;db=Math.max(20,db-zb.left);zb.visible=20===db?!1:!0;this._lastWidth=zb.width;this._timeStamp=Date.now();this._currentProgress=db}}],[{key:Symbol["for"]("__LivelyClassName__"),get:function(){return"ModuleProgress"}},{key:"properties",get:function(){return{stages:{serialize:!1,after:["submorphs"],initialize:function(){var Da=this;this.whenRendered().then(function(){Da.reset()})}}}}}],Sb,{pathInPackage:function(){return"./src/loading-screen.cp.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},"package":function(){return{name:"lively.freezer",version:"0.1.0"}}},{start:3902,end:7457})}(ba.Morph));ba.Stage=ba.component["for"](function(){return ba.component({name:"stage",extent:ba.pt(58,119),fill:ba.Color.rgba(46,75,223,0),layout:new ba.TilingLayout({direction:"topToBottom",orderByIndex:!0,align:"center",spacing:10}),submorphs:[{type:ba.Label,name:"icon",fontSize:30.108,opacity:.2,textAndAttributes:ba.Icon.textAttribute("language")},
{type:ba.Label,name:"label",fill:ba.Color.rgba(255,255,255,0),fontColor:ba.Color.rgb(64,64,64),fontSize:16,fontWeight:"Medium",nativeCursor:"pointer",textAndAttributes:["lang",null]},{type:ba.Ellipse,name:"stop",borderColor:ba.Color.rgb(127,140,141),borderWidth:4,extent:ba.pt(27,27),fill:ba.Color.rgb(253,254,254),submorphs:[{type:ba.Label,name:"checkmark",fontColor:ba.Color.rgb(100,221,23),fontSize:26,padding:ba.rect(.5,0,0,0),textAndAttributes:ba.Icon.textAttribute("check-circle"),visible:!0},{type:ba.Label,
name:"frozen indicator",borderRadius:30,fill:ba.Color.rgb(0,176,255),fontColor:ba.Color.rgb(255,255,255),fontSize:20,padding:ba.rect(4,3,0,0),textAndAttributes:ba.Icon.textAttribute("snowflake"),visible:!0}]}]})},{module:"lively.freezer/src/loading-screen.cp.js","export":"Stage",range:{start:7494,end:8808}},ba.Stage);ba.ProgressIndicator=ba.component["for"](function(){return ba.component({type:ba.ModuleProgress,borderRadius:6,dropShadow:!1,extent:ba.pt(1003,300),fill:ba.Color.rgba(253,254,254,0),
name:"progress indicator",layout:new ba.TilingLayout({align:"center",spacing:23}),submorphs:[{type:ba.Path,name:"progress path",borderColor:ba.Color.rgb(127,140,141),borderWidth:3,endMarker:{children:[{d:"M0,0 L10,5 L0,10 z",tagName:"path"}],fill:"rgba(127,140,141,1)",id:"end-marker",markerHeight:"5",markerWidth:"5",orient:"auto",refX:"5",refY:"5",tagName:"marker",viewBox:"0 0 10 10"},extent:ba.pt(20,3),fill:ba.Color.transparent,isLayoutable:!1,vertices:[{position:ba.pt(0,0),isSmooth:!1,controlPoints:{next:ba.pt(0,
0),previous:ba.pt(0,0)}},{position:ba.pt(20,0),isSmooth:!1,controlPoints:{next:ba.pt(0,0),previous:ba.pt(0,0)}}],visible:!1},ba.part(ba.Stage,{name:"stage lang",extent:ba.pt(58,119),submorphs:[{name:"icon",textAndAttributes:ba.Icon.textAttribute("language")},{name:"label",textString:"lang"}]}),ba.part(ba.Stage,{name:"stage ast",extent:ba.pt(47,119),submorphs:[{name:"icon",textAndAttributes:ba.Icon.textAttribute("tree")},{name:"label",textAndAttributes:["ast",null]}]}),ba.part(ba.Stage,{name:"stage source-transform",
extent:ba.pt(149,119),submorphs:[{name:"icon",textAndAttributes:ba.Icon.textAttribute("retweet")},{name:"label",textAndAttributes:["source transform",null]}]}),ba.part(ba.Stage,{name:"stage classes",extent:ba.pt(76,119),submorphs:[{name:"icon",textAndAttributes:ba.Icon.textAttribute("sitemap")},{name:"label",textAndAttributes:["classes",null]}]}),ba.part(ba.Stage,{name:"stage vm",extent:ba.pt(58,119),submorphs:[{name:"icon",textAndAttributes:ba.Icon.textAttribute("cogs")},{name:"label",textAndAttributes:["VM",
null]}]}),ba.part(ba.Stage,{name:"stage modules",extent:ba.pt(85,119),submorphs:[{name:"icon",textAndAttributes:ba.Icon.textAttribute("box-open")},{name:"label",textAndAttributes:["modules",null]}]}),ba.part(ba.Stage,{name:"stage user",extent:ba.pt(54,119),submorphs:[{name:"icon",textAndAttributes:ba.Icon.textAttribute("user-circle")},{name:"label",textAndAttributes:["user",null]}]}),ba.part(ba.Stage,{name:"stage storage",extent:ba.pt(77,119),submorphs:[{name:"icon",textAndAttributes:ba.Icon.textAttribute("database")},
{name:"label",textAndAttributes:["storage",null]}]}),ba.part(ba.Stage,{name:"stage morphic",extent:ba.pt(82,119),submorphs:[{name:"icon",textAndAttributes:ba.Icon.textAttribute("cube")},{name:"label",textAndAttributes:["morphic",null]}]}),ba.part(ba.Stage,{name:"stage world",extent:ba.pt(64,119),submorphs:[{name:"icon",textAndAttributes:ba.Icon.textAttribute("globe-europe")},{name:"label",textAndAttributes:["world",null]}]})]})},{module:"lively.freezer/src/loading-screen.cp.js","export":"ProgressIndicator",
range:{start:8858,end:12390}},ba.ProgressIndicator);ba.ErrorIndicator=ba.component["for"](function(){return ba.component({type:ba.Label,fontColor:ba.Color.rgb(231,76,60),fontSize:211,isLayoutable:!1,submorphs:[{type:"text",name:"error text",borderColor:ba.Color.rgb(23,160,251),extent:ba.pt(345.1,104.8),position:ba.pt(-67,206),fill:ba.Color.rgba(0,0,0,0),fixedHeight:!0,fixedWidth:!0,fontSize:22,fontWeight:"bold",lineWrapping:!0,nativeCursor:"default",readOnly:!0,textAlign:"center",textAndAttributes:["Sorry, the world you requested can not be found on the server.",
null]}],textAndAttributes:ba.Icon.textAttribute("heart-broken")})},{module:"lively.freezer/src/loading-screen.cp.js","export":"ErrorIndicator",range:{start:12438,end:13096}},ba.ErrorIndicator);ba.LoadingScreen=ba.component["for"](function(){return ba.component({type:ba.WorldLoadingScreen,name:"loading screen",extent:ba.pt(1E3,600),layout:new ba.TilingLayout({direction:"topToBottom",orderByIndex:!0,axisAlign:"center",align:"center",spacing:10}),submorphs:[{type:ba.Label,name:"json target indicator",
borderColor:ba.Color.rgb(0,0,0),borderRadius:6,borderWidth:2,fontSize:20,fontWeight:"bold",isLayoutable:!1,opacity:0,padding:ba.rect(5,2,5,2),textAndAttributes:["JSON",null]},ba.part(ba.ErrorIndicator,{name:"broken heart",visible:!1}),ba.part(ba.ProgressIndicator,{name:"package loading indicator",opacity:0}),{type:"html",name:"css loading screen",cssDeclaration:"#loading-bar {\n  height: 20px;\n  width: 400px;\n  color: gray;\n  border-style: solid;\n  border-color: gray;\n  border-width: 2px;\n  border-radius: 10px;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  overflow: hidden;\n  margin: 0px 0 0 -202px;\n}\n\n#progress {\n  background-color: gray;\n  height: 100%;\n  animation: load 5s;\n}\n\n@keyframes load {\n  from { width: 0% }\n  to { width: 100% }\n}",
extent:ba.pt(940,274.3),html:'<div style="position: fixed; z-index: 1; height: 100%; width: 100%; background-color: transparent">\n  <div id="loading-bar">\n     <div id="progress" style="width: 100%;">\n  </div>\n</div></div>',isLayoutable:!1,visible:!1}]})},{module:"lively.freezer/src/loading-screen.cp.js","export":"LoadingScreen",range:{start:13143,end:14696}},ba.LoadingScreen);ba.main=ub;var Xa=Lc("TITLE","lively.next");ba.TITLE=Xa;ba.TITLE=Xa;Xa=Lc("WORLD_CLASS",ba.World);ba.WORLD_CLASS=Xa;ba.WORLD_CLASS=
Xa;Xa=Lc("EXCLUDED_MODULES","lively.collab mocha-es6 mocha picomatch path-is-absolute fs.realpath rollup @babel/preset-env @babel/plugin-syntax-import-meta @rollup/plugin-json @rollup/plugin-commonjs rollup-plugin-polyfill-node babel-plugin-transform-es2015-modules-systemjs".split(" "));ba.EXCLUDED_MODULES=Xa;ba.EXCLUDED_MODULES=Xa;Xa=Lc("ProgressIndicator",ba.ProgressIndicator);ba.ProgressIndicator=Xa;ba["default"]=wb}}});
System.register(["./__root_module__-be0d56fe.js","./index-2aae95d3.js","./index-6e2ebca5.js"],function(Pa){var Lb,Vb,Dc,jc,qd,id,Cd,bd,Wc,Zc,zd,me,te,Je,jd,Zd,gc,$c,Bd,fd,Jd,fe,Zb,Gc,xd,Ic,Ad,Mb,mb,Ac,vc,ec,Bc,Ua,hc,Eb,qc,Cc,Yc,rd,fc,xc,bc,Qa,Da;return{setters:[function(ja){Lb=ja.C;Vb=ja.i;Dc=ja.a;jc=ja.R;qd=ja.b;id=ja.m;Cd=ja.bo;bd=ja.bp;Wc=ja.c;Zc=ja.s;zd=ja.ar;me=ja.bx;te=ja.by;Je=ja.Y;jd=ja.o;Zd=ja.ac;gc=ja.d;$c=ja.bz;Bd=ja.bA;fd=ja.$;Jd=ja.P;fe=ja.p;Zb=ja.bB;Gc=ja._;xd=ja.M;Ic=ja.ab;Ad=
ja.T;Mb=ja.aa;mb=ja.af;Ac=ja.O;vc=ja.I;ec=ja.g;Bc=ja.bC;Ua=ja.q;hc=ja.bD;Eb=ja.aC;qc=ja.bq;Cc=ja.aB;Yc=ja.bE;rd=ja.f},function(ja){fc=ja.M;xc=ja.I;bc=ja.v;Qa=ja.p},function(ja){Da=ja.localInterface}],execute:function(){function ja(Xa,hb){if(!0===hb)return hb;if(Xa.copyState)return Xa.copyState(hb);Xa={};for(var ab in hb){var ma=hb[ab];ma instanceof Array&&(ma=ma.concat([]));Xa[ab]=ma}return Xa}function Ba(Xa,hb,ab){return Xa.startState?Xa.startState(hb,ab):!0}function Ja(Xa,hb){return ed.modes[Xa]=
hb}function Fb(Xa){if("string"===typeof Xa&&ed.mimeModes.hasOwnProperty(Xa))Xa=ed.mimeModes[Xa];else if(Xa&&"string"===typeof Xa.name&&ed.mimeModes.hasOwnProperty(Xa.name)){var hb=ed.mimeModes[Xa.name];"string"===typeof hb&&(hb={name:hb});Xa=Object.assign({},hb,Xa);Xa.name=hb.name}else{if("string"===typeof Xa&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Xa))return Fb("application/xml");if("string"===typeof Xa&&/^[\w\-]+\/[\w\-]+\+json$/.test(Xa))return Fb("application/json")}return"string"===typeof Xa?{name:Xa}:
Xa||{name:"null"}}function wa(Xa,hb){hb=ed.resolveMode(hb);"string"===typeof hb&&(hb={name:hb});if(!hb.name)throw Error("parserConfig does not have a name of the mode to get");var ab=ed.modes[hb.name];if(!ab)return wa(Xa,"text/plain");Xa=Object.assign({indentUnit:2},Xa);return Object.assign(ab(Xa,hb),{name:hb.name})}function Ka(Xa,hb){for(var ab;Xa.innerMode;){ab=Xa.innerMode(hb);if(!ab||ab.mode==Xa)break;hb=ab.state;Xa=ab.mode}return ab||{mode:Xa,state:hb}}function Rb(Xa,hb){ed.mimeModes[Xa]=hb}
function eb(Xa,hb,ab){}function Sc(Xa,hb,ab,ma,X,Ra,na){var Fa=Xa.editorPlugin._tokenizerValidBefore;Fa&&Fa.row>=ab&&(Fa.row=ab-1);var Ma=ed.linesToTokenize(Xa.document,ab,ma,Fa);Fa=Ma.lines;Ma=Ma.state;if(!Fa.length)return!1;Ma=Ma?ed.copyState(hb,Ma):ed.startState(hb);for(var lb=0;lb<Fa.length;lb++){var Nb=Fa[lb],ac=Nb.row;ac>=ab&&ac<=ma&&ed.indentLine(Xa,hb,Nb,Ma,X,Ra,na);Ma=ed.tokenizeLine(hb,Fa[lb],Ma,function(){})}return!0}function Ob(Xa,hb,ab,ma,X,Ra,na){hb=ed.linesToTokenize(hb,ab,ma,X);ab=
hb.lines;ed.tokenizeLines(Xa,ab,hb.state,Ra,na);return ab}function pd(Xa,hb,ab,ma,X){var Ra=[],na,Fa=function(Nb){return Ra.push(na=[])},Ma=function(Nb,ac,Hc,Lc,kd,Sd,ke){return na.push(Hc,Lc,Nb,kd.current(),ac.localMode||ke)};try{var lb=ed.visitDocumentTokens(Xa,hb,ab,ma,X,Fa,Ma)}catch(Nb){Ra.length=0,lb=ed.visitDocumentTokens(Xa,hb,ab,ma,null,Fa,Ma)}return{tokens:Ra,lines:lb}}function Uc(Xa,hb,ab,ma,X){null==hb&&(hb=Xa.search(/[^\s\u00a0]/),-1==hb&&(hb=Xa.length));ma=ma||0;for(X=X||0;;){var Ra=
Xa.indexOf("\t",ma);if(0>Ra||Ra>=hb)return X+(hb-ma);X+=Ra-ma;X+=ab-X%ab;ma=Ra+1}}function Kc(Xa){Xa=Xa.toLowerCase();for(var hb=0;hb<ed.modeInfo.length;hb++){var ab=ed.modeInfo[hb];if(ab.mime==Xa)return ab;if(ab.mimes)for(var ma=0;ma<ab.mimes.length;ma++)if(ab.mimes[ma]==Xa)return ab}if(/\+xml$/.test(Xa))return Kc("application/xml");if(/\+json$/.test(Xa))return Kc("application/json")}function Hb(Xa){for(var hb=0;hb<ed.modeInfo.length;hb++){var ab=ed.modeInfo[hb];if(ab.ext)for(var ma=0;ma<ab.ext.length;ma++)if(ab.ext[ma]==
Xa)return ab}}function $d(Xa){for(var hb=0;hb<ed.modeInfo.length;hb++){var ab=ed.modeInfo[hb];if(ab.file&&ab.file.test(Xa))return ab}hb=Xa.lastIndexOf(".");if(Xa=-1<hb&&Xa.substring(hb+1,Xa.length))return ed.findModeByExtension(Xa)}function Tb(Xa){Xa=Xa.toLowerCase();for(var hb=0;hb<ed.modeInfo.length;hb++){var ab=ed.modeInfo[hb];if(ab.name.toLowerCase()==Xa)return ab;if(ab.alias)for(var ma=0;ma<ab.alias.length;ma++)if(ab.alias[ma].toLowerCase()==Xa)return ab}}function Gb(Xa){if(!Xa)return String(Xa);
if(Array.isArray(Xa))return"["+Xa.map(Gb).join(",")+"]";if("symbol"===typeof Xa)return Nd.printSymbol(Xa);try{return String(Xa)}catch(hb){return"Cannot print object: "+hb}}function La(Xa,hb){return!Nd.arr.every(hb.map(function(ab){return Xa[ab]}),function(ab){return Nd.obj.equals(ab,Xa&&Xa.valueOf())})}function da(Xa){if(Nd.obj.isPrimitive(Xa))var hb=Nd.string.print(Xa);else Array.isArray(Xa)?((hb=3<Xa.length)&&(Xa=Xa.slice(0,3)),Xa=Nd.string.print(Xa),hb&&(Xa=Xa.slice(0,-1)+", ...]"),hb=Xa):hb=Nd.string.print(Xa);
hb=hb.replace(/\n/g,"");500<hb.length&&(hb=hb.slice(0,20)+("...["+(hb.length-20)+' CHARS]"'));return hb}function Ha(Xa){return Pc.Inspector.openInWindow({targetObject:Xa})}function bb(Xa,hb){return Pc.Inspector.openInWindow({remoteTarget:{code:Xa,evalEnvironment:hb}})}function Qb(Xa,hb){function ab(Fa){var Ma=Fa.name,lb=Fa.ownerChain(),Nb=Fa.owner,ac=Fa.world(),Hc;Fa===Ra&&(Hc=[na]);ac===Fa&&(Hc=["$world"]);if(!Hc&&Ma&&Nb){Nb===ac&&1===Pc.arr.count(Pc.arr.pluck(ac.submorphs,"name"),Ma)&&(Hc=['$world.get("'+
Ma+'")']);if(!Hc&&Nb!=ac)for(ac=lb.length-1;ac--;)if(1===lb[ac].getAllNamed(Ma).length){Hc=[].concat($jscomp.arrayFromIterable(ab(lb[ac])),['get("'+Ma+'")']);break}Hc||(Ma=[].concat($jscomp.arrayFromIterable(ab(Nb)),['get("'+Ma+'")']),Pc.syncEval(Ma.join("."),{context:Ra}).value===Fa&&(Hc=Ma))}Hc||(Hc=[na+'.getMorphById("'+Fa.id+'")']);return Hc}hb=void 0===hb?{}:hb;var ma=Xa.world(),X=hb;hb=void 0===X.maxLength?10:X.maxLength;var Ra=void 0===X.fromMorph?ma:X.fromMorph;if(Ra===Xa)return"this";var na=
ma===Ra?"$world":"this";if(!(ma||Xa.name&&Ra.get(Xa.name)===Xa))return"morph";ma=ab(Xa);return ma.length>hb?'$world.getMorphWithId("'+Xa.id+'")':ma.join(".")}function uc(Xa,hb,ab){var ma=(hb=void 0===hb?"":hb)&&Pe.arr.last(hb.split(".")).toLowerCase(),X="",Ra=0,na=Math.pow(2,19);if("string"===typeof Xa){if(Xa.length>na)return null}else if(Xa.document.stringSize>na)return null;if("string"===typeof Xa)X=Xa.slice(0,1E3);else for(Xa=$jscomp.makeIterator(Xa.document.lines),na=Xa.next();!na.done;na=Xa.next()){var Fa=
na.value;na=Fa.stringSize;Fa=Fa.text;var Ma=!0;1E3<Ra+na&&(Ma=!1,na=1E3-Ra);X+=Fa.slice(0,na)+(Ma?"\n":"");Ra+=na;if(1E3<=Ra)break}Ra=$jscomp.makeIterator(Pe.modeInfo);for(Xa=Ra.next();!Xa.done;Xa=Ra.next()){Ma=Xa.value;na=Ma.contentTest;Xa=Ma.mode;Fa=Ma.ext;Ma=Ma.file;if("function"===typeof na)try{if(na(X))return Xa}catch(lb){}if(Ma&&Ma instanceof RegExp&&Ma.test(hb))return Xa;if(Fa)for(na=$jscomp.makeIterator(Fa),Fa=na.next();!Fa.done;Fa=na.next())if(Fa.value===ma)return Xa}return ab}Pa({a:Rb,d:Ja,
r:eb});var Tc=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");Tc.Color=Lb;var vd=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),ab=hb.hasOwnProperty("DefaultTheme")&&"function"===typeof hb.DefaultTheme?hb.DefaultTheme:hb.DefaultTheme=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:"background",get:function(){return Tc.Color.white}},{key:"default",
get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Tc.Color.white,fontWeight:"bold",backgroundColor:Tc.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Tc.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Tc.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],hb,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Wd=vd=Tc.DefaultTheme;Tc.default=vd;var ed=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");ed.copyState=ja;ed.startState=Ba;ed.defineMode=Ja;ed.resolveMode=Fb;ed.getMode=wa;ed.innerMode=Ka;ed.defineMIME=Rb;ed.registerHelper=eb;ed.indentLines=Sc;ed.indentLine=function(Xa,hb,ab,ma,X,Ra,na){na=Object.assign({indentWithTabs:!Xa.useSoftTabs,indentUnit:Xa.tabWidth,tabSize:4,ignoreFollowingText:!1},
na);null==X&&(X="add");"smart"==X&&(hb.indent||(X="prev"));var Fa=na.tabSize,Ma=ab.text,lb=ed.countColumn(Ma,null,Fa);ab.modeState&&(ab.modeState=null);var Nb=Ma.match(/^\s*/)[0];if(!Ra&&!/\S/.test(Ma)){var ac=0;X="not"}else if("smart"==X&&(ac=hb.indent(ma,na.ignoreFollowingText?"":Ma.slice(Nb.length),Ma),ac==ed.passIndent||150<ac)){if(!Ra)return;X="prev"}"prev"==X?ac=0<ab.row?ed.countColumn(ab.prevLine().text,null,Fa):0:"add"==X?ac=lb+na.indentUnit:"subtract"==X?ac=lb-na.indentUnit:"number"===typeof X&&
(ac=lb+X);ac=Math.max(0,ac);hb="";ma=0;if(na.indentWithTabs)for(na=Math.floor(ac/Fa);na;--na)ma+=Fa,hb+="\t";ma<ac&&(hb+=" ".repeat(ac-ma));if(hb!=Nb)return Xa.replace({start:{row:ab.row,column:0},end:{row:ab.row,column:Nb.length}},hb),!0};ed.tokenizeLines=function(Xa,hb,ab,ma,X){if(hb.length){ab=ab?ed.copyState(Xa,ab):ed.startState(Xa);for(var Ra=0;Ra<hb.length;Ra++){var na=hb[Ra];ma(na);ab=ed.tokenizeLine(Xa,na,ab,X)}}};ed.tokenizeLine=function(Xa,hb,ab,ma){var X=hb.text;if(!X)return ab;var Ra=
new ed.StringStream(X,2);ab=hb.modeState="function"===typeof Xa.copyState?Xa.copyState(ab):ed.copyState(Xa,ab);hb.prevLine();for(ab._string=X;!Ra.eol();)X=Xa.token(Ra,ab),ma(X,ab,Ra.start,Ra.pos,Ra,hb,Xa),Ra.start=Ra.pos;return ab};ed.printTokens=function(Xa){for(var hb="",ab=0;ab<Xa.length;ab+=5)hb+=Xa[ab+0]+" => "+Xa[ab+1]+" "+Xa[ab+2]+" "+Xa[ab+3]+" "+Xa[ab+4].name+"\n";return hb};ed.visitDocumentTokens=Ob;ed.tokenizeDocument=pd;ed.linesToTokenize=function(Xa,hb,ab,ma){if(ma&&ma.row>=ab)return{lines:[],
state:null};hb=ma?Math.max(0,ma.row-1):hb;var X=Xa.getLine(hb),Ra=X.text;Xa=[X];ma=null;for(var na=0,Fa;(Fa=X.prevLine())&&50>na++;){X=Fa;if(X.modeState){ma=X.modeState;break}Xa.unshift(X)}if(!ma){for(var Ma=X,lb=Infinity;(Fa=X.prevLine())&&100>na++;){X=Fa;if(X.modeState){ma=X.modeState;break}Xa.unshift(X);Fa=Ra.match(/^\s*/)[0].length;if(0===Fa)break;Fa<lb&&(lb=Fa,Ma=X)}!ma&&0<lb&&(Xa=Xa.slice(Xa.indexOf(Ma)))}if(ab>hb)for(X=ed.arr.last(Xa);hb<=ab;hb++){X=X.nextLine();if(!X)break;Xa.push(X)}return{lines:Xa,
state:ma}};ed.countColumn=Uc;ed.findModeByMIME=Kc;ed.findModeByExtension=Hb;ed.findModeByFileName=$d;ed.findModeByName=Tb;ed.arr=Dc;vd=ed.modes||{};ed.modes=vd;ed.modes=vd;ed.modes=vd;vd=Pa("p",{});ed.passIndent=vd;ed.passIndent=vd;ed.passIndent=vd;ed.copyState=ja;ed.copyState=ja;ed.startState=Ba;ed.startState=Ba;ed.defineMode=Ja;ed.defineMode=Ja;ed.resolveMode=Fb;ed.resolveMode=Fb;ed.getMode=wa;ed.getMode=wa;ed.innerMode=Ka;ed.innerMode=Ka;vd={};ed.mimeModes=vd;ed.mimeModes=vd;ed.mimeModes=vd;ed.defineMIME=
Rb;ed.defineMIME=Rb;ed.registerHelper=eb;ed.registerHelper=eb;ed.indentLines=Sc;ed.indentLines=Sc;ed.visitDocumentTokens=Ob;ed.visitDocumentTokens=Ob;ed.tokenizeDocument=pd;ed.tokenizeDocument=pd;ed.countColumn=Uc;ed.countColumn=Uc;(function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),ab=hb.hasOwnProperty("StringStream")&&"function"===typeof hb.StringStream?hb.StringStream:hb.StringStream=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Vb(ab,Xa,[{key:Symbol.for("lively-instance-initialize"),value:function(ma,X){this.reset(ma,X)}},{key:"reset",value:function(ma,X){this.pos=this.start=0;this.string=void 0===ma?"":ma;this.tabSize=void 0===X?2:X;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",
value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(ma){var X=this.string.charAt(this.pos);if("string"===typeof ma?X==ma:X&&(ma.test?ma.test(X):ma(X)))return++this.pos,X}},{key:"eatWhile",value:function(ma){for(var X=this.pos;this.eat(ma););return this.pos>X}},{key:"eatSpace",value:function(){for(var ma=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>ma}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},
{key:"skipTo",value:function(ma){ma=this.string.indexOf(ma,this.pos);if(-1<ma)return this.pos=ma,!0}},{key:"backUp",value:function(ma){this.pos-=ma}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=ed.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?ed.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return ed.countColumn(this.string,
null,this.tabSize)-(this.lineStart?ed.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(ma,X,Ra){if("string"===typeof ma){var na=function(Ma){return Ra?Ma.toLowerCase():Ma},Fa=this.string.substr(this.pos,ma.length);if(na(Fa)==na(ma))return!1!==X&&(this.pos+=ma.length),!0}else{if((ma=this.string.slice(this.pos).match(ma))&&0<ma.index)return null;ma&&!1!==X&&(this.pos+=ma[0].length);return ma}}},{key:"current",value:function(){return this.string.slice(this.start,
this.pos)}},{key:"hideFirstChars",value:function(ma,X){this.lineStart+=ma;try{return X()}finally{this.lineStart-=ma}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],hb,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10526,end:13053})})(void 0);vd=[{name:"APL",
mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",
ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],
file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",
ext:["css"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Xa){return Xa.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},
{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},
{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",
mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",
mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},
{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",
mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",
mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},
{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},
{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",
mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",
mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},
{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Xa){return Xa.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv",
"sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",
alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",
ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},
{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",
mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},
{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];ed.modeInfo=vd;ed.modeInfo=vd;ed.modeInfo=vd;for(var He=0;He<ed.modeInfo.length;He++)ed.info=
ed.modeInfo[He],ed.info.mimes&&(ed.info.mime=ed.info.mimes[0]);ed.defineMode("null",function(){return{token:function(Xa){return Xa.skipToEnd()}}});ed.defineMIME("text/plain","null");ed.findModeByMIME=Kc;ed.findModeByMIME=Kc;ed.findModeByExtension=Hb;ed.findModeByExtension=Hb;ed.findModeByFileName=$d;ed.findModeByFileName=$d;ed.findModeByName=Tb;ed.findModeByName=Tb;var Rd=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Rd.Color=Lb;Rd.Rectangle=jc;Rd.pt=qd;Rd.morph=id;Rd.ShadowObject=
Cd;Rd.StyleSheet=bd;Rd.connect=Wc;Rd.arr=Dc;Rd.string=Zc;Rd.FilterableList=zd;Rd.Range=me;He=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ab=hb.hasOwnProperty("Completer")&&"function"===typeof hb.Completer?hb.Completer:hb.Completer=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"Completer"}}],hb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);Rd.Completer=He;Rd.Completer=He;Rd.Completer=He;He=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ab=hb.hasOwnProperty("WordCompleter")&&
"function"===typeof hb.WordCompleter?hb.WordCompleter:hb.WordCompleter=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:"compute",value:function(ma,X){var Ra=[],na=[],Fa=ma.document.lineStrings;ma=ma.cursorPosition.row;for(var Ma=ma-1;0<=Ma;Ma--)for(var lb=$jscomp.makeIterator(Fa[Ma].split(/[^0-9a-z@_]+/i)),Nb=lb.next();!Nb.done;Nb=lb.next())(Nb=Nb.value)&&!Ra.includes(Nb)&&Nb!==X&&(Ra.push(Nb),
na.push({priority:1E3-(ma-Ma),completion:Nb}));for(Ma=ma+1;Ma<Fa.length;Ma++)for(lb=$jscomp.makeIterator(Fa[Ma].split(/[^0-9a-z_@]+/i)),Nb=lb.next();!Nb.done;Nb=lb.next())(Nb=Nb.value)&&!Ra.includes(Nb)&&Nb!==X&&(Ra.push(Nb),na.push({priority:1E3-(Ma-ma),completion:Nb}));return na}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],hb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);Rd.WordCompleter=He;Rd.WordCompleter=He;Rd.WordCompleter=He;He=[new Rd.WordCompleter];Rd.defaultCompleters=He;Rd.defaultCompleters=He;Rd.defaultCompleters=He;He=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ab=hb.hasOwnProperty("CompletionController")&&"function"===typeof hb.CompletionController?hb.CompletionController:hb.CompletionController=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:Symbol.for("lively-instance-initialize"),value:function(ma,X){X=void 0===X?[]:X;this.textMorph=ma;this.completers=X=ma.pluginCollect("getCompleters",X)}},{key:"computeCompletions",value:function(ma){var X=this,Ra,na,Fa,Ma,lb,Nb,ac,Hc,Lc,kd,Sd,ke,Gd,ye,xe,le;return $jscomp.asyncExecutePromiseGeneratorProgram(function(De){switch(De.nextAddress){case 1:Ra=[],na=$jscomp.makeIterator(X.completers),Fa=na.next();
case 2:if(Fa.done){De.jumpTo(4);break}Ma=Fa.value;De.setCatchFinallyBlocks(5);lb=Ra;Nb=lb.concat;return De.yield(Ma.compute(X.textMorph,ma),7);case 7:Ra=Nb.call(lb,De.yieldResult);De.leaveTryBlock(3);break;case 5:ac=De.enterCatchBlock(),console.warn("Error in completer "+Ma+": "+(ac.stack||ac));case 3:Fa=na.next();De.jumpTo(2);break;case 4:Hc=new Map;Ra.forEach(function(Gf){var cg=Hc.get(Gf.completion);cg||(cg=[],Hc.set(Gf.completion,cg));cg.push(Gf)});Lc=[];kd=$jscomp.makeIterator(Hc.values());for(Sd=
kd.next();!Sd.done;Sd=kd.next())ke=Sd.value,Lc.push(Rd.arr.last(Rd.arr.sortByKey(ke,"priority")));Gd=0;ye=Rd.arr.sortByKey(Lc,"priority").reverse();xe=ye.length&&ye[0].priority||0;le=ye.map(function(Gf){Gf.highestPriority=xe;var cg=Gf.completion.replace(/\n/g,""),ng=String((Gf.info||"").replace(/\n/g,""));Gd=Math.max(Gd,cg.length+ng.length);return{isListItem:!0,string:cg,annotation:ng,value:Gf}});return De.return({items:le,maxCol:Gd})}})}},{key:"computeSortedCompletions",value:function(ma,X){X=void 0===
X?!1:X;var Ra=this,na,Fa,Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){if(1==lb.nextAddress)return na={tokens:[ma],lowercasedTokens:[ma],input:ma},lb.yield(Ra.computeCompletions(ma),2);Fa=lb.yieldResult;Ma=Rd.arr.sortBy(Fa.items.filter(function(Nb){return Ra.filterFunction(na,Nb,X)}),function(Nb){return Ra.sortFunction(na,Nb)});return lb.return(Ma)})}},{key:"_printCompletions",value:function(ma){var X=this,Ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(na){if(1==
na.nextAddress)return na.yield(X.computeSortedCompletions(ma),2);Ra=na.yieldResult.map(function(Fa){return{completion:Fa.value.completion,priority:Fa.value.priority,maxP:Fa.value.highestPriority,sortVal:Fa._cache[ma].sortVal,lev:JSON.stringify(Fa._cache[ma].levenshtein)}});return na.return(Rd.string.printTable(lively.lang.grid.tableFromObjects(Ra)))})}},{key:"prefix",value:function(){var ma=this.textMorph,X=ma.selection;return(X.isEmpty()?ma.getLine(X.lead.row).slice(0,X.lead.column):X.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(ma,X,Ra){Ra=void 0===Ra?!1:Ra;X._cache||(X._cache={});var na=ma.tokens,Fa=ma.lowercasedTokens,Ma=ma.input;Ma=X._cache[Ma]||(X._cache[Ma]={});if(Ma.hasOwnProperty("filtered"))return Ma.filtered;X=X.value.completion.replace(/\([^\)]*\)$/,"");var lb=X.toLowerCase();if(Ra&&na[0]&&!X.startsWith(na[0]))return Ma.filtered=!1;if(Fa.every(function(ac){return lb.includes(ac)}))return!0;var Nb=Ma.levenshtein||(Ma.levenshtein={});ma=Ra||3>=Rd.arr.sum(ma.lowercasedTokens.map(function(ac){return Nb[ac]||
(Nb[ac]=Rd.string.levenshtein(lb,ac))}));return Ma.filtered=ma}},{key:"sortFunction",value:function(ma,X){X._cache||(X._cache={});var Ra=X._cache[ma.input]||(X._cache[ma.input]={});if(Ra.hasOwnProperty("sortVal"))return Ra.sortVal;Ra=X._cache[ma.input]={};var na=X.value;X=na.highestPriority;var Fa=na.completion;na=na.priority;Fa=Fa.replace(/\([^\)]*\)$/,"").toLowerCase();var Ma=0;ma.lowercasedTokens.forEach(function(Nb){Fa.startsWith(Nb)?Ma+=12:3<=Nb.length&&Fa.includes(Nb)&&(Ma+=5)});X=-((na||(Ma?
X:0))/Math.pow(10,String(X).length-2))-Ma;var lb=Ra.levenshtein||(Ra.levenshtein={});ma=Rd.arr.sum(ma.lowercasedTokens.map(function(Nb){return lb[Nb]||(lb[Nb]=Rd.string.levenshtein(Fa,Nb))}));Ma&&(ma/=2);return Ra.sortVal=ma+X}},{key:"positionForMenu",value:function(){var ma=this.textMorph,X=ma.charBoundsFromTextPosition(ma.cursorPosition);return ma.getGlobalTransform().transformRectToRect(X).topLeft().addXY(-ma.scroll.x,-ma.scroll.y).addPt(Rd.pt(ma.borderWidth+4,ma.borderWidth+4))}},{key:"completionListSpec",
value:function(){var ma=this,X,Ra,na,Fa,Ma,lb,Nb,ac,Hc,Lc,kd,Sd,ke,Gd,ye,xe,le,De,Gf,cg;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ng){if(1==ng.nextAddress)return Ra=X=ma.textMorph,na=Ra.fontSize,Fa=Ra.fontFamily,Ma=ma.positionForMenu(),lb=ma.prefix(),ng.yield(ma.computeCompletions(lb),2);Nb=ng.yieldResult;ac=Nb.items;Hc=Nb.maxCol;Lc=X.env.fontMetric.sizeFor(Fa,na,"M");kd=Lc.width*Hc;Sd=X.document.getLine(0).height;ke=Math.max(120,kd<X.width?kd:X.width);Gd=Sd*ac.length+Sd+10;ye=Math.max(70,
Math.min(700,Gd));xe=Ma.extent(Rd.pt(ke,ye));if(le=X.world())De=le.visibleBounds().insetBy(5),xe.bottom()>De.bottom()&&(Gf=xe.bottom()-De.bottom(),Gf>xe.height-50&&(Gf=xe.height-50),xe.height-=Gf),xe.right()>De.right()&&(cg=xe.right()-De.right(),xe.width=120>xe.width-cg?120:xe.width-cg),De.containsRect(xe)||(xe=xe.withTopLeft(De.translateForInclusion(xe).topLeft())),xe=xe.translatedBy(De.insetBy(0).topLeft().negated());return ng.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:na,position:xe.topLeft(),extent:xe.extent(),items:ac,input:lb,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:ma.filterFunction,sortFunction:ma.sortFunction})})}},{key:"removeMenuOnBlur",value:function(ma){var X=ma.menu;setTimeout(function(){X.withAllSubmorphsDetect(function(Ra){return Ra.isFocused()})?X.inputMorph.focus():X.remove()})}},{key:"openCompletionList",value:function(){var ma=this,X,Ra,na,Fa,Ma,lb,Nb,ac,Hc,Lc;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(kd){if(1==kd.nextAddress)return X=ma.textMorph.selection.start,kd.yield(ma.completionListSpec(),2);if(3!=kd.nextAddress)return Ra=kd.yieldResult,ma.textMorph.pluginFind(function(Sd){return Sd.theme}),na=new Rd.FilterableList(Ra),Fa=new Rd.Range({start:X,end:ma.textMorph.selection.start}),Ma=ma.textMorph.textInRange(Fa),lb=na.inputMorph,Nb=na.listMorph,ac=Ra.input,Hc=na.addMorph({name:"prefix mask",fill:Rd.Color.transparent,bounds:lb.textBounds()},
lb),Nb.master=null,Fa.isEmpty()||(ma.textMorph.deleteText(Fa),lb.input=Ma,lb.gotoDocumentEnd()),lb.fontColor=ma.textMorph.fontColor,Rd.connect(lb,"textString",Hc,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:lb}}),Rd.connect(na,"accepted",ma,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:ac}}),Rd.connect(na,"accepted",na,"remove"),Rd.connect(na,"canceled",na,"remove"),Rd.connect(na,"remove",ma.textMorph,"focus"),Rd.connect(na.inputMorph,"onBlur",ma,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:na}}),Lc=ma.textMorph.world(),Nb.addStyleClass("hiddenScrollbar"),na.paddingMorph.height=2,lb.height=Nb.itemHeight,lb.clipMode="visible",lb.fill=ma.textMorph.fill,lb.fixedHeight=!0,lb.fixedWidth=!1,lb.fontSize=Nb.fontSize,na.relayout(),na.selectedIndex=
0,na.master.applyIfNeeded(!0),lb.focus(),kd.yield(na.master.whenApplied(),3);ac.length&&(lb.gotoDocumentEnd(),na.moveBy(Rd.pt(-lb.textBounds().width,0)));Lc.addMorph(na);na.inputPadding=Rd.Rectangle.inset(0,0,0,0);return kd.return(na)})}},{key:"autoInsertBestMatchingCompletion",value:function(ma,X,Ra){X=void 0===X?!0:X;var na=this,Fa,Ma,lb,Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ac){if(1==ac.nextAddress)return Fa=$jscomp,Ma=Fa.makeIterator,ac.yield(na.computeSortedCompletions(ma,
X),2);lb=Ma.call(Fa,ac.yieldResult);(Nb=lb.next().value)&&na.insertCompletion(Nb.value.completion,ma,Ra);ac.jumpToEnd()})}},{key:"insertCompletion",value:function(ma,X,Ra){var na=this.textMorph,Fa=na.document,Ma=na.selection.isMultiSelection?na.selection.selections:[na.selection];na.undoManager.group();Ma.forEach(function(lb){lb.collapseToEnd();var Nb=lb.lead,ac=X?Fa.indexToPosition(Fa.positionToIndex(Nb)-X.length):Nb;"function"===typeof Ra?Ra(ma,X,na,{start:ac,end:Nb},lb):na.replace({start:ac,end:Nb},
ma)});na.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],hb,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13044})}(void 0);Rd.CompletionController=He;Rd.CompletionController=He;Rd.CompletionController=He;He=[{name:"text completion",
handlesCount:!0,multiSelectAction:"single",exec:function(Xa,hb,ab){var ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){return 1==X.nextAddress?(ma=new Rd.CompletionController(Xa,Rd.defaultCompleters),X.yield(ma.openCompletionList(),2)):X.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Xa,hb,ab){var ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){return 1==X.nextAddress?(ma=new Rd.CompletionController(Xa,
Rd.defaultCompleters),X.yield(ma.autoInsertBestMatchingCompletion(ma.prefix()),2)):X.return(!0)})}}];Rd.completionCommands=He;Rd.completionCommands=He;Rd.completionCommands=He;var Fe=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Fe.chain=te;Fe.arr=Dc;Fe.obj=Je;Fe.string=Zc;var z=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Xa){var hb=Xa.selection.start;0<hb.row&&(hb=Xa.getPositionAboveOrBelow(1,hb,!0,0,Xa.charBoundsFromTextPosition(hb).x),
Xa.selection.addRange({start:hb,end:hb}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(Xa){var hb=Xa.selection.start;hb.row<Xa.documentEndPosition.row&&(hb=Xa.getPositionAboveOrBelow(-1,hb,!0,0,Xa.charBoundsFromTextPosition(hb).x),Xa.selection.addRange({start:hb,end:hb}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Xa){var hb=Xa.selection.selections[Xa.selection.selections.length-1];if(hb.isEmpty())return!0;
Xa.searchForAll(hb.text,{start:{column:0,row:0}}).forEach(function(ab){return Xa.selection.addRange(ab.range,!1)});Xa.selection.mergeSelections();Fe.arr.remove(Xa.selection.selections,hb);Xa.selection.selections.push(hb);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Xa){var hb=Xa.selection.selections.length-1,ab=Xa.selection.selections[hb];if(ab.isEmpty())return!0;var ma=Xa.search(ab.text,{start:ab.end,backwards:!1});ma&&(ab=Xa.selection.selections.findIndex(function(X){return X.range.equals(ma.range)}),
-1<ab?Fe.arr.swap(Xa.selection.selections,ab,hb):Xa.selection.addRange(ma.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Xa){var hb=Xa.selection.selections.length-1,ab=Xa.selection.selections[hb];if(ab.isEmpty())return!0;var ma=ab.start,X=Xa.search(ab.text,{start:{row:ma.row,column:ma.column-(ab.text.length-1)},backwards:!0});X&&(ab=Xa.selection.selections.findIndex(function(Ra){return Ra.range.equals(X.range)}),-1<ab?Fe.arr.swap(Xa.selection.selections,
ab,hb):Xa.selection.addRange(X.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Xa){var hb=Xa.selection.selections.length;1<hb&&Xa.selection.removeSelections(hb-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Xa){Xa.selection.selections=lively.lang.arr.rotate(Xa.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(Xa){Xa.selection.selections=
lively.lang.arr.rotate(Xa.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Xa){var hb=Xa.selection.selections;if(1>=hb.length)return!0;var ab=Fe.arr.groupBy(hb,function(X){return X.range.start.row});hb=ab.keys().map(function(X){X=ab[X];var Ra=Fe.arr.max(X,function(na){return na.range.start.column});Fe.arr.without(X,Ra).forEach(function(na){return na.range=Ra.range});return Ra});var ma=Fe.arr.max(hb,function(X){return X.range.start.column}).range.start.column;
hb.forEach(function(X){var Ra=X.range.start;X=Ra.row;Ra=Ra.column;Xa.insertText(" ".repeat(ma-Ra),{row:X,column:Ra})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Xa){Xa.selection.disableMultiSelect();if(Xa.selection.isEmpty())var hb=Xa.lastSavedMark&&Xa.lastSavedMark.position||(void 0).lineRange().start,ab=Xa.cursorPosition;else hb=Xa.selection,ab=hb.lead,hb=hb.anchor;Xa.selection.collapse();var ma=hb.column,X=ab.column;Fe.arr.range(hb.row,
ab.row).forEach(function(Ra){return Xa.getLine(Ra).length>Math.min(X,ma)&&Xa.selection.addRange({end:{row:Ra,column:X},start:{row:Ra,column:ma}},!1)});Xa.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Xa,hb,ab){ab=void 0===ab?1:ab;Xa.undoManager.group();Xa.selection.selections.forEach(function(ma,X){return ma.text=String(X+ab)});Xa.undoManager.group();return!0}}];Fe.multiSelectCommands=z;Fe.multiSelectCommands=z;Fe.multiSelectCommands=
z;var Ce=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");Ce.pToI=function(Xa,hb){return Xa.positionToIndex(hb)};Ce.iToP=function(Xa,hb){return Xa.indexToPosition(hb)};Ce.execCodeNavigator=function(Xa){return function(hb,ab,ma){var X=hb.pluginInvokeFirst("getNavigator");if(!X)return!0;hb.saveMark();ma=ma||1;for(var Ra=0;Ra<ma;Ra++)X[Xa](hb,ab);return!0}};Ce.once=jd;var Ke=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Ce.execCodeNavigator("forwardSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:Ce.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Ce.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Ce.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",
exec:Ce.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Xa,hb){function ab(){var Ra=Xa.$expandRegionState,na=Ce.pToI(Xa,Xa.cursorPosition);if(Ra&&(Ra.range[0]===na||Ra.range[1]===na))return Ra;Ra=Xa.selection.range;return Xa.$expandRegionState={range:[Ce.pToI(Xa,Ra.start),Ce.pToI(Xa,Ra.end)]}}hb=hb||{};var ma=Xa.pluginInvokeFirst("getNavigator");if(!ma)return!0;
var X=hb.start;hb=hb.end;if("number"===typeof X&&"number"===typeof hb)ab(),ma={range:[X,hb],prev:ab()};else{X=ma.ensureAST(Xa);if(!X)return;ma=ma.expandRegion(Xa,Xa.textString,X,ab())}ma&&ma.range&&(Xa.selection={start:Ce.iToP(Xa,ma.range[0]),end:Ce.iToP(Xa,ma.range[1])},Xa.$expandRegionState=ma);Ce.once(Xa,"selectionChange",function(){return Xa.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},
exec:function(Xa){if(Xa.selection.isEmpty())return!0;var hb=Xa.pluginInvokeFirst("getNavigator");if(!hb)return!0;var ab=hb.ensureAST(Xa);if(!ab)return!0;var ma=Xa.$expandRegionState;if(!ma)return!0;(hb=hb.contractRegion(Xa,Xa.textString,ab,ma))&&hb.range&&(Xa.selection={start:Ce.iToP(Xa,hb.range[0]),end:Ce.iToP(Xa,hb.range[1])},Xa.$expandRegionState=hb);Ce.once(Xa,"selectionChange",function(){return Xa.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Ce.commands=
Ke;Ce.commands=Ke;Ce.commands=Ke;var eg=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");eg.arr=Dc;eg.chain=te;eg.string=Zc;var sf=[{name:"toggle comment",exec:function(Xa){var hb=Xa.pluginInvokeFirst("getComment");if(!hb)return!0;if(!hb.lineCommentStart)return hb.blockCommentStart?Xa.execCommand("toggle block comment"):!0;var ab=hb.lineCommentStart,ma=new RegExp("^(\\s*)("+ab+"\\s?)(.*)");hb=Xa.document;var X=Xa.selection;X.isEmpty()||0!==X.end.column||X.growRight(-1);
var Ra=X.start.row;hb=hb.lineStrings.slice(X.start.row,X.end.row+1);hb=hb.some(function(Ma){return!!Ma.trim()})?eg.arr.dropWhile(hb,function(Ma){return Ma.trim()?!1:++Ra&&!0}):hb;var na=hb.every(function(Ma){return Ma.trim()&&Ma.match(ma)});Xa.undoManager.group();if(na)hb.forEach(function(Ma,lb){if(Ma=Ma.match(ma)){Ma=$jscomp.makeIterator(Ma);Ma.next();var Nb=Ma.next().value,ac=Ma.next().value;Ma.next();Xa.deleteText({start:{row:Ra+lb,column:Nb.length},end:{row:Ra+lb,column:Nb.length+ac.length}})}});
else{var Fa=hb.reduce(function(Ma,lb,Nb){return lb.trim()||X.isEmpty()&&X.start.row===X.end.row?Math.min(Ma,lb.match(/^\s*/)[0].length):Ma},Infinity);Fa=Infinity===Fa?0:Fa;hb.forEach(function(Ma,lb){Ma=$jscomp.makeIterator(Ma.match(/^(\s*)(.*)/));Ma.next();Ma.next();Ma.next();Xa.insertText(ab+" ",{row:Ra+lb,column:Fa})})}Xa.undoManager.group();return!0}},{name:"toggle block comment",exec:function(Xa){var hb=Xa.pluginInvokeFirst("getComment");if(!hb)return!0;if(!hb.blockCommentStart)return hb.lineCommentStart?
Xa.execCommand("toggle comment"):!0;if(!hb||!hb.blockCommentStart)return!0;var ab=hb.blockCommentStart;hb=hb.blockCommentEnd;var ma=new RegExp("^"+ab.replace(/\*/g,"\\*")),X=new RegExp(hb.replace(/\*/g,"\\*")+"$"),Ra=Xa.tokenAt(Xa.cursorPosition);if(Ra&&"comment"===Ra.token){var na=Xa.textInRange(Ra);if(na.match(ma)&&na.match(X))return Xa.undoManager.group(),Xa.replace(Ra,na.slice(ab.length,-hb.length)),Xa.undoManager.group(),!0}Xa.undoManager.group();Xa.insertText(ab,Xa.selection.start);Xa.insertText(hb,
Xa.selection.end);Xa.undoManager.group();ab=!Xa.selection.isEmpty();Xa.selection.growLeft(hb.length);ab||Xa.selection.collapse();return!0}},{name:"comment box",exec:function(Xa,hb,ab){hb=Xa.undoManager.ensureNewGroup(Xa,"comment box");if(Xa.selection.isEmpty())return Xa.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Xa.execCommand("toggle comment"),Xa.undoManager.group(hb),!0;var ma=Xa.selection.range,X=Xa.withSelectedLinesDo(function(na){return na}),Ra=eg.arr.min([ma.start.column].concat(eg.chain(X).map(function(na){return na.match(/^\s*/)}).flatten().compact().pluck("length").value()));
X=eg.arr.max(X.map(function(na){return na.length}))-Ra;X=Array(Math.ceil(X/2)+1).join("-=")+"-";Xa.execCommand("toggle comment");Xa.collapseSelection();Xa.cursorPosition={row:ma.start.row,column:0};ab?Xa.insertText(eg.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",Ra)):Xa.insertText(eg.string.indent(X+"\n"," ",Ra));Xa.selection.goUp();Xa.execCommand("toggle comment");Xa.cursorPosition={row:ma.end.row+2,column:0};Xa.insertText(eg.string.indent(X+"\n"," ",Ra));Xa.selection.goUp();
Xa.execCommand("toggle comment");Xa.selection.range={start:{row:ma.start.row,column:0},end:Xa.cursorPosition};Xa.undoManager.group(hb);return!0},multiSelectAction:"forEach",handlesCount:!0}];eg.commands=sf;eg.commands=sf;eg.commands=sf;var Nd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");Nd.printSymbol=function(Xa){if(Symbol.keyFor(Xa))return'Symbol.for("'+Symbol.keyFor(Xa)+'")';if(Nd.knownSymbols.get(Xa))return Nd.knownSymbols.get(Xa);String(Xa).match(Nd.symMatcher);return String(Xa)};
Nd.defaultSort=function(Xa,hb){if(Xa.hasOwnProperty("priority")||hb.hasOwnProperty("priority")){var ab=Xa.priority||0,ma=hb.priority||0;if(ab<ma)return-1;if(ab>ma)return 1}Xa=(Xa.keyString||Xa.key).toLowerCase();hb=(hb.keyString||hb.key).toLowerCase();return Xa<hb?-1:Xa===hb?0:1};Nd.safeToString=Gb;Nd.propertyNamesOf=function(Xa,hb){if(!Xa)return[];if(Array.isArray(Xa)){var ab=hb?hb.offset:0;return Nd.arr.range(ab,ab+(hb?hb.partitionSize:Xa.length-1))}return Nd.arr.sortBy(Object.keys(Xa),function(ma){return ma.toLowerCase()})};
Nd.isMultiValue=La;Nd.printValue=da;Nd.partitionedChildren=function(Xa,hb){var ab=void 0===hb?{}:hb;hb=void 0===ab.originalValue?Xa:ab.originalValue;var ma=void 0===ab.offset?0:ab.offset;ab=void 0===ab.partitionSize?Xa.length||Object.values(Xa).length:ab.partitionSize;if(Nd.obj.isArray(Xa)){Xa=Nd.num.roundTo(Math.max(Nd.MIN_PARTITION_SIZE,ab/50),.1);ab/=Xa;for(var X=[],Ra=0;Ra<ab;Ra++){var na="["+(ma+Ra*Xa)+"-"+(ma+(Ra+1)*Xa)+"]";X.push({partition:{originalValue:hb,offset:ma+Ra*Xa,partitionSize:Xa},
value:[],key:na,keyString:na,valueString:"...",isCollapsed:!0})}return X}Xa=Nd.num.roundTo(Math.max(Nd.MIN_PARTITION_SIZE,ab/50),.1);ab/=Xa;X=[];Ra=Nd.obj.keys(hb).sort();for(na=0;na<ab;na++){var Fa=ma+na*Xa,Ma=ma+(na+1)*Xa,lb=Nd.obj.select(hb,Ra.slice(Fa,Ma));Fa="["+Ra[Fa].slice(0,4)+"-"+(Ra[Ma]||Nd.arr.last(Ra)).slice(0,4)+"]";X.push({partition:{originalValue:lb,offset:ma+na*Xa,partitionSize:Xa},value:[],key:Fa,keyString:Fa,valueString:"...",isCollapsed:!0})}return X};Nd.propertiesOf=function(Xa){var hb=
Xa.partition?Xa.target:Xa.value;if(!hb)return[];var ab={_rev:!0},ma=[],X="function"===typeof hb.livelyCustomInspect?hb.livelyCustomInspect():{},Ra=Object.assign({},Nd.defaultPropertyOptions,{},X);if(X.properties){X=$jscomp.makeIterator(X.properties);for(var na=X.next();!na.done;na=X.next()){var Fa=na.value;na=Fa.key;var Ma=Fa.hidden,lb=Fa.priority,Nb=Fa.keyString,ac=Fa.value;Fa=Fa.valueString;ab[na]=!0;Ma||ma.push(Xa.getSubNode({priority:lb,key:na,keyString:Nb||Nd.safeToString(na),value:ac,valueString:Fa,
isCollapsed:!0}))}}if(Ra.includeDefault){X=Nd.propertyNamesOf(hb,Xa.partition);if(X.length>Nd.MAX_NODE_THRESHOLD)for(ab=$jscomp.makeIterator(Nd.partitionedChildren(hb,Xa.partition)),X=ab.next();!X.done;X=ab.next())ma.push(Xa.getSubNode(X.value));else for(Ma=$jscomp.makeIterator(X),X=Ma.next();!X.done;X=Ma.next())lb=X.value,lb in ab||(X=hb[lb],na=Nd.printValue(X),X={keyString:lb,key:lb,value:X,valueString:na,isCollapsed:!0},ma.push(Xa.getSubNode(X)));if(Ra.includeSymbols)for(ab=$jscomp.makeIterator(Object.getOwnPropertySymbols(hb)),
X=ab.next();!X.done;X=ab.next())Ma=X.value,lb=Nd.safeToString(Ma),X=hb[Ma],na=Nd.printValue(X),X={key:Ma,keyString:lb,value:X,valueString:na,isCollapsed:!0},ma.push(Xa.getSubNode(X))}Ra.sort&&(ma=Ra.sortFunction(hb,ma));return ma};Nd.obj=Je;Nd.num=Zd;Nd.arr=Dc;Nd.string=Zc;Nd.connect=Wc;Nd.signal=gc;Nd.TreeData=$c;Nd.newUUID=Bd;Nd.localInterface=Da;Nd.MAX_NODE_THRESHOLD=1E3;Nd.MIN_PARTITION_SIZE=250;Nd.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Xa,hb){return Array.isArray(Xa)?
hb:hb.sort(Nd.defaultSort)}};Nd.symMatcher=/^Symbol\((.*)\)$/;Nd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Xa){return"symbol"===typeof Symbol[Xa]}).reduce(function(Xa,hb){return Xa.set(Symbol[hb],"Symbol."+hb)},new Map)}();Nd.isMultiValue=La;Nd.isMultiValue=La;Nd.printValue=da;Nd.printValue=da;var hf=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ab=hb.hasOwnProperty("InspectionTree")&&"function"===typeof hb.InspectionTree?
hb.InspectionTree:hb.InspectionTree=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:Symbol.for("lively-instance-initialize"),value:function(ma){Vb._get(Object.getPrototypeOf(ab.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ma);this.inspector=ma.inspector;this.root.isInspectionNode||(this.root=Nd.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",get:function(){return["root"]}},
{key:"asListWithIndexAndDepth",value:function(ma){ma=void 0===ma?!0:ma;return Vb._get(Object.getPrototypeOf(ab.prototype),"asListWithIndexAndDepth",this).call(this,function(X){X=X.node;return ma?X.visible:!0})}},{key:"getContextFor",value:function(ma){return ma==this.root?this.root.value.inspectee:ma.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(ma){var X=void 0===ma.maxDepth?1:ma.maxDepth,Ra=ma.iterator,na=ma.showUnknown,Fa=ma.showInternal,Ma=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){if(1==
lb.nextAddress)return lb.yield(Ma.uncollapseAll(function(Nb,ac){return X>ac&&(Nb==Ma.root||Nb.value.submorphs)}),2);Ma.asListWithIndexAndDepth(!1).forEach(function(Nb){var ac=Nb.node;return 0==Nb.depth?ac.visible=!0:!na&&ac.keyString&&ac.keyString.includes("UNKNOWN PROPERTY")||!Fa&&ac.keyString&&ac.keyString.includes("internal")?ac.visible=!1:ac.value&&ac.value.submorphs?ac.visible=!0:ac.visible=Ra(ac)});lb.jumpToEnd()})}},{key:"getChildren",value:function(ma){return ma.children}},{key:"display",
value:function(ma){return ma.display(this.inspector)}},{key:"isCollapsed",value:function(ma){return ma.isCollapsed}},{key:"isLeaf",value:function(ma){return Nd.obj.isPrimitive(ma.value)}},{key:"collapse",value:function(ma,X){var Ra=this;ma.isCollapsed=X;X||this.isLeaf(ma)||ma.children.length||(ma.children=Nd.propertiesOf(ma).map(function(na){Ra.parentMap.set(na,ma);return na}))}},{key:"retrieveForRemoteProxy",value:function(ma){ma.uuid||(ma.uuid=Nd.newUUID(),this.idToNodeMap[ma.uuid]=ma);return{uuid:ma.uuid,
value:this.isLeaf(ma)?ma.value:{},keyString:ma.keyString,key:ma.keyString,valueString:Nd.safeToString(ma.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Nd.localInterface}},{key:"getNodeViaId",value:function(ma){return this.idToNodeMap[ma]}},{key:"asRemoteDelegate",value:function(ma){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext={});System.get("@lively-env").remoteInspectionContext[ma]=
this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionTree"}},{key:"forObject",value:function(ma,X){return new this({key:"inspectee",value:{inspectee:ma},isCollapsed:!0,inspector:X})}}],hb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:5969,end:8683})}(Nd.TreeData);Nd.InspectionTree=hf;Nd.InspectionTree=hf;Nd.InspectionTree=hf;var jf=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ab=hb.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof hb.RemoteInspectionTree?hb.RemoteInspectionTree:hb.RemoteInspectionTree=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,
[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(ma){this.parentMap=new WeakMap;this.root=ma.proxy;this.evalEnvironment=ma.evalEnvironment;this.inspector=ma.inspector;this.delegateId=ma.delegateId}},{key:"getContextFor",value:function(ma){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+ma.uuid+'").value'}},{key:"dispose",value:function(){var ma=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){return X.yield(ma.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
ma.delegateId+"']\n    ",ma.evalEnvironment),0)})}},{key:"display",value:function(ma){return ma.keyString+": "+ma.valueString}},{key:"collapse",value:function(ma,X){var Ra=this,na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){if(1==Fa.nextAddress)return(ma.isCollapsed=X)||Ra.isLeaf(ma)?Fa.return():ma.children.length?Fa.jumpTo(0):Fa.yield(Ra.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+ma.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Ra.delegateId+'"]'}),3);na=Fa.yieldResult;ma.children=na.isError?[]:na.value;Fa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(ma,X){var Ra=this,na,Fa,Ma,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress)return Nb.yield(Ra.createRemoteContext(ma,X),2);na=Nb.yieldResult;
Fa=na.proxy;Ma=na.delegateId;lb=na.evalEnvironment;return Nb.return(new Ra({key:"inspectee",proxy:Fa,delegateId:Ma,evalEnvironment:lb,inspector:X}))})}},{key:"createRemoteContext",value:function(ma,X){var Ra=ma.code,na=ma.evalEnvironment,Fa=ma.delegateId,Ma,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress)return Fa="lively://inspector-"+X.id,Nb.yield(na.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Ra+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+Fa+'");\n    ',na),2);Ma=Nb.yieldResult;lb=Ma.value;return Nb.return({delegateId:Fa,evalEnvironment:na,proxy:lb})})}}],hb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(Nd.InspectionTree);
Nd.RemoteInspectionTree=jf;Nd.RemoteInspectionTree=jf;Nd.RemoteInspectionTree=jf;(function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ab=hb.hasOwnProperty("InspectionNode")&&"function"===typeof hb.InspectionNode?hb.InspectionNode:hb.InspectionNode=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:Symbol.for("lively-instance-initialize"),value:function(ma){var X=
ma.root,Ra=ma.priority,na=ma.key,Fa=ma.keyString,Ma=ma.value,lb=ma.valueString,Nb=ma.isCollapsed,ac=void 0===ma.children?[]:ma.children,Hc=void 0===ma.isSelected?!1:ma.isSelected,Lc=void 0===ma.visible?!0:ma.visible;this.partition=ma.partition;this.priority=Ra;this.key=na;this.keyString=String(Fa||na);this.value=Ma;this.valueString=lb||Nd.printValue(Ma);this.isCollapsed=Nb;this.children=ac;this.isSelected=Hc;this.visible=Lc;this.root=X}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(ma){if(ma.value&&ma.value.isMorph)return new Nd.MorphNode(Object.assign({root:this.root},ma));var X=ma.key,Ra=ma.keyString,na=this.value,Fa=ma.partition;Fa&&(na=Fa.originalValue,Ra=X);return new Nd.PropertyNode(Object.assign({},ma,{keyString:Ra,key:X,target:na,partition:Fa,root:this.root,spec:{}}))}},{key:"display",value:function(ma){var X=this.keyString,Ra=this.valueString;if(!this.interactive)return X+": "+Ra;this._propertyWidget||(this._propertyWidget=
ma.renderDraggableTreeLabel({value:X+": "+Ra}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionNode"}},{key:"for",value:function(ma,X){X=void 0===X?null:X;return ma.value&&ma.value.isMorph?new Nd.MorphNode(Object.assign({root:X},ma)):new Nd.InspectionNode(Object.assign({root:X},ma))}}],hb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,end:13612})})(void 0);(function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ab=hb.hasOwnProperty("MorphNode")&&"function"===typeof hb.MorphNode?hb.MorphNode:hb.MorphNode=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,
[{key:Symbol.for("lively-instance-initialize"),value:function(ma){Vb._get(Object.getPrototypeOf(ab.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ma);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(ma){var X=this.propertyInfo[ma.key]||{};return ma.value&&ma.value.isMorph?new Nd.MorphNode(Object.assign({},ma,{root:this.root})):new Nd.PropertyNode(Object.assign({},ma,{root:this.root,target:this.target,
spec:X}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],hb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(Nd.InspectionNode);(function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ab=hb.hasOwnProperty("PropertyNode")&&
"function"===typeof hb.PropertyNode?hb.PropertyNode:hb.PropertyNode=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:Symbol.for("lively-instance-initialize"),value:function(ma){Vb._get(Object.getPrototypeOf(ab.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ma);var X=ma.spec,Ra=ma.target;this.partition=ma.partition;this.target=Ra;this.spec=X;this.foldedNodes={}}},{key:"__deserialize__",
value:function(ma,X){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(ma){this._interactive=ma}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(ma){return this.isFoldable?this.getFoldedContext(ma):Vb._get(Object.getPrototypeOf(ab.prototype),"getSubNode",this).call(this,ma)}},{key:"getFoldedContext",
value:function(ma){return this.foldedNodes[ma.key]=new Nd.FoldedNode(Object.assign({},ma,{root:this.root,target:this.target,foldableNode:this,spec:Nd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(ma,X){(X=void 0===X?!1:X)&&(this.target[this.key]=ma);this.value=this.target[this.key];this.valueString=Nd.printValue(this.value);this.interactive&&(X||this._propertyWidget.highlight());if(this.isFoldable)for(var Ra in this.foldedNodes)this.foldedNodes[Ra].value=
this.value[Ra],this.foldedNodes[Ra].valueString=Nd.printValue(this.value[Ra]),this.foldedNodes[Ra]._propertyWidget&&Nd.signal(this.foldedNodes[Ra]._propertyWidget,"update",this.value[Ra])}},{key:"display",value:function(ma){var X=this,Ra=this._propertyWidget,na=this.keyString,Fa=this.valueString,Ma=this.target,lb=this.value,Nb=this.spec;if(!(this.interactive||Nb.foldable&&Nd.isMultiValue(lb,Nb.foldable)))return ma.renderPropertyControl({target:Ma,keyString:na,valueString:Fa,tree:ma.ui.propertyTree,
value:lb,spec:Nb,node:this,fastRender:!0});if(Ra)return Ra.keyString=na,Ra.valueString=Fa,Ra.isSelected=this.isSelected,Ra.control&&(Ra.control.isSelected=this.isSelected),Ra;Ra=this._propertyWidget=ma.renderPropertyControl({target:Ma,keyString:na,valueString:Fa,value:lb,spec:Nb,node:this,isSelected:this.isSelected,fontColor:ma.ui.propertyTree.fontColor});this.isInternalProperty||Nb.readOnly||(Nd.connect(Ra,"propertyValue",this,"refreshProperty",{updater:function(ac,Hc){return ac(Hc,!0)}}),Nd.connect(Ra,
"openWidget",this.root,"onWidgetOpened",{converter:function(ac){return{widget:ac,node:X.sourceObj}}}));return Ra}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],hb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(Nd.InspectionNode);
(function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ab=hb.hasOwnProperty("FoldedNode")&&"function"===typeof hb.FoldedNode?hb.FoldedNode:hb.FoldedNode=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:Symbol.for("lively-instance-initialize"),value:function(ma){Vb._get(Object.getPrototypeOf(ab.prototype),Symbol.for("lively-instance-initialize"),this).call(this,
ma);this.foldableNode=ma=ma.foldableNode;this.foldedProp=ma.key+Nd.string.capitalize(this.key)}},{key:"refreshProperty",value:function(ma,X){X=void 0===X?!1:X;var Ra={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Ra[this.key]=ma,Ra)),X)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],hb,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,end:18928})})(Nd.PropertyNode);var Bf=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Bf.Color=Lb;var Xd=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),ab=hb.hasOwnProperty("DarkTheme")&&"function"===typeof hb.DarkTheme?hb.DarkTheme:hb.DarkTheme=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Vb(ab,Xa,[{key:"background",get:function(){return Bf.Color.rgb(44,62,80)}},{key:"cursorColor",get:function(){return Bf.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},
{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Bf.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Bf.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Bf.Color.rgb(33,
150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",
get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Bf.Color.white,fontWeight:"bold",backgroundColor:Bf.Color.rgba(136,
136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Bf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Bf.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||
(this._instance=new this)}}],hb,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),ii=Xd=Bf.DarkTheme;Bf.default=Xd;var Pc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Pc.inspect=Ha;Pc.remoteInspect=bb;Pc.generateReferenceExpression=Qb;Pc.onNumberDragStart=
function(Xa,hb){hb.initPos=Xa.position;hb.factorLabel=(new Pc.Tooltip({description:"1x"})).openInWorld(Xa.hand.position.addXY(10,10))};Pc.onNumberDrag=function(Xa,hb){var ab=Pc.getScaleAndOffset(Xa,hb),ma=ab.scale;ab=ab.offset;hb.factorLabel.position=Xa.hand.position.addXY(10,10);hb.factorLabel.description=ma+"x";return Pc.getCurrentValue(ab,ma,hb)};Pc.onNumberDragEnd=function(Xa,hb){var ab=Pc.getScaleAndOffset(Xa,hb);Xa=ab.offset;ab=ab.scale;hb.factorLabel.softRemove();return Pc.getCurrentValue(Xa,
ab,hb)};Pc.getScaleAndOffset=function(Xa,hb){var ab=Xa.position.subPt(hb.initPos);Xa=ab.x;hb=Pc.num.roundTo(Math.exp(-ab.y/$world.height*6),.01)*hb.baseFactor;return{offset:Xa,scale:hb}};Pc.getCurrentValue=function(Xa,hb,ab){return Math.max(ab.min,Math.min(ab.max,ab.scrubbedValue+(ab.floatingPoint?Xa*hb:Math.round(Xa*hb))))};Pc.Color=Lb;Pc.rect=fd;Pc.pt=qd;Pc.obj=Je;Pc.num=Zd;Pc.Path=Jd;Pc.arr=Dc;Pc.promise=fe;Pc.connect=Wc;Pc.noUpdate=Zb;Pc.disconnect=Gc;Pc.once=jd;Pc.Morph=xd;Pc.GridLayout=Ic;Pc.Tooltip=
Ad;Pc.VerticalLayout=Mb;Pc.HorizontalLayout=mb;Pc.morph=id;Pc.Label=Ac;Pc.Icon=vc;Pc.config=ec;Pc.Tree=Bc;Pc.LoadingIndicator=Ua;Pc.DropDownList=hc;Pc.DropDownSelector=Eb;Pc.SearchField=qc;Pc.LabeledCheckBox=Cc;Pc.MorphHighlighter=fc;Pc.InteractiveMorphSelector=xc;Pc.printValue=da;Pc.RemoteInspectionTree=jf;Pc.InspectionTree=hf;Pc.isMultiValue=La;Pc.valueWidgets=bc;Pc.popovers=Qa;Pc.DarkTheme=ii;Pc.DefaultTheme=Wd;Pc.syncEval=Yc;Pc.inspectorCommands=[{name:"focus codeEditor",exec:function(Xa){Xa.get("codeEditor").show();
Xa.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Xa){Xa.get("propertyTree").show();Xa.get("propertyTree").focus();return!0}}];(function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ab=hb.hasOwnProperty("DraggedProp")&&"function"===typeof hb.DraggedProp?hb.DraggedProp:hb.DraggedProp=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:"applyToTarget",
value:function(ma){var X=this.currentTarget,Ra=this.control;this.remove();Pc.MorphHighlighter.removeHighlighters(ma.world);if(X)if(X.isText&&"js"===X.editorModeName){var na=X.evalEnvironment.context;ma=X.textPositionFromPoint(X.localize(ma.position));na=Pc.generateReferenceExpression(this.sourceObject,{fromMorph:na});Ra.keyString&&(na+="."+Ra.keyString);X.insertTextAndSelect(na,ma);X.focus()}else"propertyValue"in Ra&&(X[Ra.keyString]=Ra.propertyValue)}},{key:"update",value:function(ma){ma=ma.hand.globalPosition;
var X=this.morphBeneath(ma);if(X){for(X==this.morphHighlighter&&(X=X.morphBeneath(ma));[X].concat($jscomp.arrayFromIterable(X.ownerChain())).find(function(Ra){return!Ra.visible});)X=X.morphBeneath(ma);if(X!=this.currentTarget){this.currentTarget=X;this.morphHighlighter&&this.morphHighlighter.deactivate();if(X.isWorld)return;this.morphHighlighter=Pc.MorphHighlighter.for($world,X);this.morphHighlighter.show()}this.position=ma}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},
{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Pc.Color.rgb(169,204,227)},fill:{defaultValue:Pc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var ma=this.control;if(!ma)return this.submorphs=[];this.height=22;this.submorphs=[ma];ma.top=0;ma.fontSize=14;"function"===typeof ma.relayout&&ma.relayout();this.width=ma.width+20;this.adjustOrigin(Pc.pt(10,10))}}}}}],
hb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1245,end:3687})})(Pc.Morph);(function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ab=hb.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof hb.DraggableTreeLabel?hb.DraggableTreeLabel:hb.DraggableTreeLabel=
function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(ma){this.draggedProp=new Pc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Pc.connect(ma.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(ma){}},{key:"onDragEnd",value:function(ma){Pc.disconnect(ma.hand,
"update",this.draggedProp,"update");this.draggedProp.applyToTarget(ma)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Pc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:Pc.Color.transparent},padding:{defaultValue:Pc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],
set:function(ma){this.setProperty("isSelected",ma);ma?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=ma)}}}}}],hb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3689,
end:5028})})(Pc.Label);hf=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ab=hb.hasOwnProperty("PropertyControl")&&"function"===typeof hb.PropertyControl?hb.PropertyControl:hb.PropertyControl=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(ma,X,Ra){ma.control=
new Pc.DropDownSelector({opacity:.8,fill:Pc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:X,padding:0,values:Ra});Pc.connect(ma.control,"update",ma,"propertyValue",{updater:function(na,Fa){this.targetObj.propertyValue!=Fa&&na(Fa)}});Pc.connect(ma,"update",ma.control,"selectedValue",{updater:function(na,Fa){Fa=Fa&&Fa.valueOf?Fa.valueOf():Fa;this.targetObj.propertyValue!=Fa&&na(Fa)}});return ma}},{key:"toggleMultiValuePlaceholder",value:function(ma){this.multiValuePlaceholder=
this.multiValuePlaceholder||this.addMorph({fill:Pc.Color.transparent,layout:new Pc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:Pc.arr.range(0,2).map(function(X){return{type:"ellipse",fill:Pc.Color.gray.withA(.5),reactsToPointer:!1,extent:Pc.pt(7,7)}})});ma?(Pc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=
!0):(Pc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(ma){this.foldableProperties&&this.toggleMultiValuePlaceholder(Pc.isMultiValue(ma,this.foldableProperties))}},{key:"asFoldable",value:function(ma){this.foldableProperties=ma;Pc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,
1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var ma=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});ma.isLayoutable=!1;ma.fontWeight="bold";ma.fontColor=Pc.Color.orange;
ma.reactsToPointer=!1;ma.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(ma){this.submorphs=[ma]}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[];Pc.connect(this,"extent",this,"relayout")}}}}},{key:"inferType",value:function(ma){return(ma=
ma.value)&&(ma.isColor||ma.isGradient)?"Color":ma&&ma.isPoint?"Point":Pc.obj.isBoolean(ma)?"Boolean":Pc.obj.isNumber(ma)?"Number":Pc.obj.isString(ma)?"String":ma&&ma.isRectangle?"Rectangle":!1}},{key:"render",value:function(ma){ma.spec.type||(ma.spec=Object.assign({},ma.spec,{isFloat:!Number.isInteger(ma.value),type:this.inferType(ma)}));switch(ma.spec.type){case "Color":var X=this.renderColorControl(ma);break;case "ColorGradient":X=this.renderColorControl(Object.assign({},ma,{gradientEnabled:!0}));
break;case "Number":X=this.renderNumberControl(ma);break;case "String":X=this.renderStringControl(ma);break;case "RichText":X=this.renderStringControl(ma);break;case "Layout":X=this.renderLayoutControl(ma);break;case "Enum":X=this.renderEnumControl(ma);break;case "Shadow":X=this.renderShadowControl(ma);break;case "Point":X=this.renderPointControl(ma);break;case "Rectangle":X=this.renderRectangleControl(ma);break;case "Boolean":X=this.renderBooleanControl(ma);break;default:X=this.renderItSomehow(ma)}X.control&&
(Pc.connect(X.control,"openWidget",X,"openWidget"),X.toggleFoldableValue(ma.value));return X}},{key:"baseControl",value:function(ma){var X=ma.spec;ma=new this({keyString:ma.keyString,valueString:ma.valueString,isSelected:!1,propertyValue:ma.value});X.foldable&&ma.asFoldable(X.foldable);return ma}},{key:"renderGrabbableKey",value:function(ma){var X=this,Ra=ma.target;return[ma.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(na){na.state.draggedProp=new Pc.DraggedProp({sourceObject:Ra,
control:X.baseControl(ma)});na.state.draggedProp.openInWorld();Pc.connect(na.hand,"update",na.state.draggedProp,"update")},onDrag:function(na){},onDragEnd:function(na){Pc.disconnect(na.hand,"update",na.state.draggedProp,"update");na.state.draggedProp.applyToTarget(na)}}]}},{key:"renderEnumControl",value:function(ma){var X=ma.value,Ra=ma.spec.values,na=ma.keyString,Fa=ma.target,Ma=ma.node,lb=function(Nb,ac){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hc){Fa.world().openWorldMenu(Nb,
Ra.map(function(Lc){return{string:Lc.toString(),action:function(){Fa[na]=Lc;Ma.rerender()}}}));Hc.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ma)),[" "+(X?X.valueOf?X.valueOf():X:"Not set"),{nativeCursor:"pointer",onMouseDown:lb}],$jscomp.arrayFromIterable(Pc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:lb})))}},{key:"renderStringControl",value:function(ma){var X=ma.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ma)),
[" "+(200<X.length?X.slice(0,20)+"...":X),{fontColor:Pc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(ma){var X=ma.value,Ra=ma.keyString,na=ma.valueString,Fa=ma.target,Ma=ma.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ma)),[" "+na,{fontColor:Pc.Color.black,nativeCursor:"pointer",onMouseDown:function(lb){var Nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ac){if(1==ac.nextAddress)return Nb=new Pc.popovers.RectanglePopover({hasFixedPosition:!0,
rectangle:X}),Nb.relayout(),ac.yield(Nb.fadeIntoWorld(lb.positionIn(Fa.world())),2);Pc.connect(Nb,"rectangle",function(Hc){Fa[Ra]=Hc;Ma.rerender()});ac.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(ma){var X=ma.value,Ra=ma.keyString,na=ma.valueString,Fa=ma.target,Ma=ma.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ma)),[" "+na,{nativeCursor:"pointer",fontColor:X?Pc.Color.green:Pc.Color.red,onMouseDown:function(lb){Fa[Ra]=!Fa[Ra];Ma.rerender()}}])}},{key:"renderNumberControl",
value:function(ma){var X=ma.value,Ra=ma.spec,na=ma.keyString,Fa=ma.valueString,Ma=ma.node,lb=ma.target,Nb=ma.tree,ac=void 0===Ma._numberControls?new Ud:Ma._numberControls,Hc=$jscomp.makeIterator(ac.submorphs),Lc=Hc.next().value,kd=Hc.next().value;ac.fontColor=Nb.fontColor;var Sd=Ma._numberControls=ac;"max"in Ra&&"min"in Ra&&-Infinity!=Ra.min&&Infinity!=Ra.max?(Sd.baseFactor=(Ra.max-Ra.min)/100,Sd.floatingPoint=Ra.isFloat,Sd.max=Ra.max,Sd.min=Ra.min):(Sd.floatingPoint=Ra.isFloat,Sd.baseFactor=.5,Sd.min=
void 0!=Ra.min?Ra.min:-Infinity,Sd.max=void 0!=Ra.max?Ra.max:Infinity);var ke=Pc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ma)),$jscomp.arrayFromIterable(Ma._inputMorph?[Ma._inputMorph,{}]:[" "+(void 0!=X&&(X.valueOf?X.valueOf():X).toFixed(Ra.isFloat?Math.max(4,Pc.num.precision(X)):0))+" ",{fontColor:ke,onMouseUp:function(Gd){Ma._inputMorph=Pc.morph({type:"input",fill:null,fontColor:ke,fontFamily:"IBM Plex Mono",fontSize:14,
padding:Pc.rect(8,2,-6,2),height:23,cursorColor:Pc.Color.white,value:X.valueOf?X.valueOf():Fa});lb[na]=X;Ma._inputMorph.focus();Pc.once(Ma._inputMorph,"inputAccepted",function(ye){delete Ma._inputMorph;lb[na]=Ra.isFloat?Number.parseFloat(ye):Number.parseInt(ye);Ma.rerender()});Pc.once(Ma._inputMorph,"onBlur",function(ye){Ma._inputMorph&&(delete Ma._inputMorph,lb[na]=X,Ma.rerender())});Ma.rerender()},onDragStart:function(Gd){Sd.scrubbedValue=X;Pc.onNumberDragStart(Gd,Sd)},onDrag:function(Gd){lb[na]=
Pc.onNumberDrag(Gd,Sd);Ma.rerender()},onDragEnd:function(Gd){return Pc.onNumberDragEnd(Gd,Sd)}},ac,{onMouseUp:function(){Lc.fill=kd.fill=null},onMouseDown:function(Gd){if(Gd.targetMorph===Lc){Lc.fill=Pc.Color.white.withA(.2);if("max"in Ra&&lb[na]>=Ra.max)return;lb[na]+=1}if(Gd.targetMorph===kd){kd.fill=Pc.Color.white.withA(.2);if("min"in Ra&&lb[na]<=Ra.min)return;--lb[na]}Ma.rerender()}}]))}},{key:"renderShadowControl",value:function(ma){var X=ma.keyString,Ra=ma.value,na=ma.target,Fa=ma.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ma)),
[""+(Ra?Ra.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(Ma){var lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress)return lb=new Pc.popovers.ShadowPopover({shadowValue:na[X],hasFixedPosition:!0}),Nb.yield(lb.fadeIntoWorld(Ma.positionIn(na.world())),2);Pc.connect(lb,"shadowValue",function(ac){na[X]=ac;Fa.rerender()});Nb.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(ma){var X=ma.keyString,Ra=ma.value,na=ma.target,Fa=ma.node,
Ma=Pc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,lb={nativeCursor:"pointer",onMouseDown:function(Nb){var ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hc){if(1==Hc.nextAddress)return ac=new Pc.popovers.PointPopover({pointValue:na[X],hasFixedPosition:!0}),Hc.yield(ac.fadeIntoWorld(Nb.positionIn(na.world())),2);Pc.connect(ac,"pointValue",function(Lc){na[X]=Lc;Fa.rerender()});Hc.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ma)),[" pt(",
Object.assign({},lb),""+Ra.x.toFixed(),Object.assign({fontColor:Ma},lb),",",Object.assign({},lb),""+Ra.y.toFixed(),Object.assign({fontColor:Ma},lb),")",Object.assign({},lb)])}},{key:"renderLayoutControl",value:function(ma){var X=ma.valueString,Ra=ma.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ma)),[" "+(Ra?X:"No Layout"),{onMouseDown:function(na){}}])}},{key:"renderColorControl",value:function(ma){var X=ma.node,Ra=ma.gradientEnabled,na=ma.valueString,Fa=ma.keyString,Ma=
ma.value,lb=ma.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ma)),[Pc.morph({fill:Ma.valueOf?Ma.valueOf():Ma,extent:Pc.pt(15,15),borderColor:Pc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(Ma?Ma.valueOf?Ma.valueOf():na:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Nb){var ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Hc){if(1==Hc.nextAddress)return ac=new Pc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:lb,
fillValue:Ma,title:"Fill Control",gradientEnabled:Ra}),Hc.yield(ac.fadeIntoWorld(Nb.positionIn(lb.world())),2);Pc.connect(ac,"fillValue",function(Lc){lb[Fa]=Lc;X.rerender()});Hc.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(ma){var X=ma.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(ma)),[" "+X,{}])}}],hb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5037,end:20330})}(Pc.DraggableTreeLabel);Pc.PropertyControl=hf;Pc.PropertyControl=hf;Pc.PropertyControl=hf;Pc.inspect=Ha;Pc.inspect=Ha;Pc.remoteInspect=bb;Pc.remoteInspect=bb;Pc.generateReferenceExpression=Qb;Pc.generateReferenceExpression=Qb;var Ud=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ab=hb.hasOwnProperty("NumberControls")&&"function"===typeof hb.NumberControls?hb.NumberControls:hb.NumberControls=
function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Pc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Pc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(ma){this.submorphs.map(function(X){return X.fontColor=
ma})}},submorphs:{initialize:function(){this.submorphs=[Pc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Pc.rect(5,2,0,-6),fontSize:12}),Pc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Pc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],hb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23003,end:24048})}(Pc.Morph);(function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ab=hb.hasOwnProperty("PropertyTree")&&"function"===typeof hb.PropertyTree?hb.PropertyTree:hb.PropertyTree=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:"onDrag",value:function(ma){this._onDragHandler&&this._onDragHandler(ma)}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],hb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25213,end:25324})})(Pc.Tree);hf=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ab=hb.hasOwnProperty("Inspector")&&"function"===
typeof hb.Inspector?hb.Inspector:hb.Inspector=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(ma){}},{key:"__after_deserialize__",value:function(ma,X,Ra){var na=this,Fa=new Pc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,
{treeData:Pc.InspectionTree.forObject(null,this)}));this.addMorph(Fa,this.getSubmorphNamed("terminal toggler"));Vb._get(Object.getPrototypeOf(ab.prototype),"__after_deserialize__",this).call(this,ma,X,Ra);!this.isComponent&&this.master.whenApplied().then(function(){na.layout.col(0).row(1).group.morph=Fa;na.targetObject&&(na.targetObject=na.targetObject)})}},{key:"__additionally_serialize__",value:function(ma,X,Ra,na){ma=ma.props.submorphs.value;for(X=ma.length;X--;)Ra.refForId(ma[X].id).realObj==
this.ui.propertyTree&&Pc.arr.removeAt(ma,X)}},{key:"renderDraggableTreeLabel",value:function(ma){return new Pc.DraggableTreeLabel(ma)}},{key:"renderPropertyControl",value:function(ma){return Pc.PropertyControl.render(ma)}},{key:"onLoad",value:function(){var ma=this.ui,X=ma.codeEditor,Ra=ma.thisBindingSelector,na=ma.propertyTree;X.changeEditorMode("js").then(function(){return X.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Ra.selection?X.owner.selectedContext:
X.owner.targetObject},get systemInterface(){return Pc.Path("treeData.systemInterface").get(na)},format:"esm"}}).catch(function(Fa){return $world.logError(Fa)})}},{key:Symbol.for("lively-instance-initialize"),value:function(ma){Vb._get(Object.getPrototypeOf(ab.prototype),Symbol.for("lively-instance-initialize"),this).call(this,ma);ma=this.ui;var X=ma.targetPicker,Ra=ma.propertyTree,na=ma.resizer,Fa=ma.terminalToggler,Ma=ma.unknowns,lb=ma.internals,Nb=ma.searchField,ac=ma.codeEditor,Hc=ma.fixImportButton,
Lc=ma.thisBindingSelector;ac.changeEditorMode("js").then(function(){return ac.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Lc.selection?ac.owner.selectedContext:ac.owner.targetObject},get systemInterface(){return Ra.treeData.systemInterface},format:"esm"}}).catch(function(kd){return $world.logError(kd)});Pc.connect(X,"onMouseUp",this,"selectTarget");Pc.connect(Ra,"onScroll",this,"repositionOpenWidget");Pc.connect(na,"onDrag",this,"adjustProportions");
Pc.connect(Fa,"onMouseDown",this,"toggleCodeEditor");Pc.connect(Ma,"trigger",this,"filterProperties");Pc.connect(lb,"trigger",this,"filterProperties");Pc.connect(Nb,"searchInput",this,"filterProperties");Pc.connect(Ra,"nodeCollapseChanged",this,"filterProperties");Pc.connect(this,"extent",this,"relayout");Pc.connect(Lc,"selection",this,"bindCodeEditorThis");Pc.connect(Hc,"fire",ac,"execCommand",{updater:function(kd){return kd("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},
{key:"refreshSelectedLine",value:function(){var ma=this.ui.propertyTree.selectedIndex-1,X=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();X=this.ui.propertyTree.document.getLine(ma).textAndAttributes.slice(0,4).concat(X.display(this));ma=this.ui.propertyTree.lineRange(ma,!1);this.ui.propertyTree.replace(ma,X,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();
if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var ma=Pc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(ma!=this.lastChange||this.lastSubmorphs!=Pc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==ma.prop&&this.repositionOpenWidget(),this.lastChange=ma,this.lastSubmorphs=
Pc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var ma;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(X){X=X.node;X.target&&(ma=X.foldableNode?X.target[X.foldableNode.key][X.key]:X.target[X.key],!Pc.obj.equals(ma,X.value)&&X.refreshProperty&&X.refreshProperty(ma))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},
{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(ma,X){X=void 0===X?!1:X;var Ra=this,na,Fa,Ma,lb,Nb,ac,Hc,Lc,kd,Sd,ke,Gd,ye,xe,le;return $jscomp.asyncExecutePromiseGeneratorProgram(function(De){switch(De.nextAddress){case 1:if(!Ra.isUpdating()){De.jumpTo(2);break}return De.yield(Ra.whenUpdated(),2);case 2:na=Pc.promise.deferred();Fa=na.promise;Ma=!!Ra.target;Ra.updateInProgress=Fa;De.setCatchFinallyBlocks(4);X&&(lb=Pc.LoadingIndicator.open("connecting to remote..."));
if(!X){Nb=Pc.InspectionTree.forObject(ma,Ra);De.jumpTo(6);break}return De.yield(Pc.RemoteInspectionTree.forObject(ma,Ra),7);case 7:Nb=De.yieldResult;case 6:return ac=Nb,Hc=Ra.ui.propertyTree,De.yield(ac.collapse(ac.root,!1),8);case 8:if(!ac.root.children){De.jumpTo(9);break}return De.yield(ac.collapse(ac.root.children[0],!1),9);case 9:if(Lc=Ra.originalTreeData&&Ra.originalTreeData.diff(ac)){kd=$jscomp.makeIterator(Lc);for(Sd=kd.next();!Sd.done;Sd=kd.next())ke=Sd.value,Gd=$jscomp.makeIterator(ke),
ye=Gd.next().value,xe=Gd.next().value,ye.refreshProperty(xe.value);De.jumpTo(11);break}Hc.treeData=ac;return De.yield(Ra.filterProperties(),12);case 12:if(!Hc.treeData.root.isCollapsed){De.jumpTo(13);break}return De.yield(Hc.onNodeCollapseChanged({node:ac.root,isCollapsed:!1}),14);case 14:Hc.selectedIndex=1;case 13:return De.yield(Hc.execCommand("uncollapse selected node"),11);case 11:Ra.toggleWindowStyle(Ma);lb&&lb.remove();De.leaveTryBlock(5);break;case 4:le=De.enterCatchBlock(),Ra.showError(le);
case 5:Ra.startStepping(1E3,"refreshAllProperties"),Ra.updateInProgress=null,De.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(ma){ma=void 0===ma?!0:ma;var X=this,Ra,na,Fa,Ma,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){if(1==Nb.nextAddress)return Ra=300,Ma=X.ui.codeEditor.pluginFind(function(ac){return ac.runEval}),lb=X.getWindow(),Nb.yield(Ma.runEval("System.get('@system-env').node"),2);Nb.yieldResult.value?(Fa=[].concat($jscomp.arrayFromIterable(Pc.arr.without(lb.styleClasses,
"local")),["node"]),na=Pc.DarkTheme.instance):(Fa=["local"].concat($jscomp.arrayFromIterable(lb?Pc.arr.without(lb.styleClasses,"node"):[])),na=Pc.DefaultTheme.instance);Ma.theme=na;ma?(lb&&lb.animate({duration:Ra,styleClasses:Fa}),X.ui.codeEditor.animate({fill:na.background,duration:Ra})):lb&&(lb.styleClasses=Fa);X.ui.codeEditor.textString=X.ui.codeEditor.textString;Ma.highlight();Nb.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||
Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var ma=this,X=Object.assign({type:"text",borderWidth:1,borderColor:Pc.Color.gray,lineWrapping:"by-chars"},Pc.config.codeEditor.defaultStyle,{textString:""}),Ra=Pc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Pc.rect(0,0,this.width,30);var na=new Pc.SearchField({styleClasses:["idle"],name:"searchField"});Ra[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[na,
{type:"button",name:"targetPicker",padding:Pc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Pc.Icon.textAttribute("crosshairs")},new Pc.LabeledCheckBox({label:"Internals",name:"internals"}),new Pc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Pc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Pc.InspectionTree.forObject(null,this)})),na=Pc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),
{name:"resizer"},Object.assign({name:"codeEditor"},X),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Pc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Ra),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Ra),[" selection",null])}]}];Pc.connect(na,"position",function(){debugger});this.ui.thisBindingSelector.listMorph.dropShadow=
!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){ma.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var ma=this,X,Ra,na,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){switch(Ma.nextAddress){case 1:if(ma.env.eventDispatcher.isKeyPressed("Shift"))return Ra=$jscomp,na=Ra.makeIterator,Ma.yield($world.execCommand("select morph",{justReturn:!0}),5);ma.toggleSelectionInstructions(!0);
return Ma.yield(Pc.InteractiveMorphSelector.selectMorph(),4);case 4:X=Ma.yieldResult;ma.toggleSelectionInstructions(!1);Ma.jumpTo(3);break;case 5:Fa=na.call(Ra,Ma.yieldResult),X=Fa.next().value;case 3:X&&(ma.targetObject=X),Ma.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(ma){if(ma&&!this.instructionWidget){var X=Pc.morph({type:"label",name:"escapeKey",value:"esc"});X.whenRendered().then(function(){return X.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),
width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},X,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(ma){ma=ma.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=
this.ui.propertyTree.selectedNode;ma.epiMorph=!0;this.openWidget=ma;Pc.once(ma,"close",this,"closeOpenWidget");Pc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var ma=this.ui.propertyTree,X=ma.textLayout.boundsFor(ma,{column:0,row:ma.selectedIndex-1});X=ma.worldPoint(Pc.pt(X.x,X.y+X.height/2)).addPt(ma.scroll.negated());ma=ma.globalBounds();X.x=this.globalBounds().center().x;X.y<ma.top()?X=ma.topCenter():ma.bottom()-20<X.y&&(X=ma.bottomCenter().addXY(0,
-20));return X}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(ma){this.layout.row(1).height+=ma.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(ma){var X=this;if(ma!==this.isEditorVisible()){var Ra=this.extent,na=this.layout,Fa=this.ui,Ma=Fa.terminalToggler,lb=Fa.codeEditor,
Nb=Fa.thisBindingSelector;Fa=Fa.fixImportButton;na.disable();ma?(Ma.fontColor=Pc.Color.rgbHex("00e0ff"),na.row(3).height=this.codeEditorHeight||180,na.row(2).height=5,Fa.animate({visible:!0,duration:200}),Nb.animate({visible:!0,duration:200})):(this.codeEditorHeight=na.row(3).height,Ma.fontColor=Pc.Color.white,na.row(3).height=na.row(2).height=0,Fa.animate({visible:!1,duration:200}),Nb.animate({visible:!1,duration:200}));na.enable({duration:200}).then(function(){X.extent=Ra});this.relayout({duration:200});
lb.focus();lb.animate({opacity:ma?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var ma=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){ma.makeEditorVisible(!ma.isEditorVisible());X.jumpToEnd()})}},{key:"filterProperties",value:function(){var ma=this,X,Ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(na){if(1==na.nextAddress)return X=ma.ui.searchField,Ra=ma.ui.propertyTree,ma.originalTreeData||(ma.originalTreeData=Ra.treeData),Pc.disconnect(Ra.treeData,
"onWidgetOpened",ma,"onWidgetOpened"),na.yield(Ra.treeData.filter({maxDepth:2,showUnknown:ma.ui.unknowns.checked,showInternal:ma.ui.internals.checked,iterator:function(Fa){return X.matches(Fa.key)}}),2);Ra.update();Pc.connect(Ra.treeData,"onWidgetOpened",ma,"onWidgetOpened");na.jumpToEnd()})}},{key:"__handleVdomCSSLayoutIssue__",value:function(ma){!this.world()&&this.layout.renderViaCSS?(this.layout.renderViaCSS=!1,this._revertToCSS=!0):this._revertToCSS&&ma.duration&&(this.layout.renderViaCSS=!0,
delete this._revertToCss)}},{key:"relayout",value:function(ma){ma=void 0===ma?{}:ma;var X=this,Ra,na,Fa,Ma,lb,Nb,ac,Hc,Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(kd){X.__handleVdomCSSLayoutIssue__(ma);X.layout&&X.layout.forceLayout();Ra=X;na=Ra.ui;Fa=na.fixImportButton;Ma=na.terminalToggler;lb=na.propertyTree;Nb=na.thisBindingSelector;ac=lb.bounds().insetBy(5).bottomLeft();Hc=lb.bounds().insetBy(5).bottomRight();Lc=Hc.subXY(Fa.width+10,0);Nb.width=115;Nb.listMorph.itemHeight=20;
ma.duration?(Ma.animate(Object.assign({bottomLeft:ac},ma)),Fa.animate(Object.assign({bottomRight:Hc},ma)),Nb.animate(Object.assign({bottomRight:Lc},ma))):(Ma.bottomLeft=ac,console.log(ac),Fa.bottomRight=Hc,Nb.bottomRight=Lc);kd.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Vb._get(Object.getPrototypeOf(ab.prototype),
"keybindings",this))}},{key:"commands",get:function(){return Pc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(ma){if(System._testsRunning)return console.log(ma.targetObject);ma=new this(ma);ma.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return ma}},{key:"properties",get:function(){return{extent:{defaultValue:Pc.pt(400,500)},fill:{defaultValue:Pc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},
remoteTarget:{after:["submorphs"],set:function(ma){this.setProperty("remoteTarget",ma);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ma,!0))}},targetObject:{after:["submorphs"],set:function(ma){this._serializableTarget=ma&&ma.isMorph?ma.id:ma;this.setProperty("targetObject",ma);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(ma))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var ma=this.ui.propertyTree,
X=ma.treeData;return X.getContextFor(ma.selectedNode||X.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),
internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Pc.Color.gray,fontSize:14,fontFamily:Pc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],
hb,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25341,end:46327})}(Pc.Morph);hf=Pc.Inspector;jf=Pa("I",hf);Pc.default=hf;var df=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");df.Inspector=jf;df.string=Zc;df.Morph=xd;df.pt=qd;df.Color=Lb;hf=[{name:"doit",
doc:"Evaluates the selecte code or the current line and report the result",exec:function(Xa,hb,ab){ab=void 0===ab?1:ab;var ma,X,Ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(na){switch(na.nextAddress){case 1:return Xa.maybeSelectCommentOrLine(),na.setCatchFinallyBlocks(2),hb=Object.assign({},hb,{logDoit:!0,inspect:!0,inspectDepth:ab}),na.yield(Xa.doEval(void 0,hb),4);case 4:ma=na.yieldResult;X=ma.error?ma.error:ma.isError?ma.value:null;na.leaveTryBlock(3);break;case 2:X=Ra=na.enterCatchBlock();
case 3:return X?Xa.showError(X):Xa.setStatusMessage(df.string.truncate(ma.value,1E3)),na.return(ma)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Xa,hb){var ab,ma,X;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ra){switch(Ra.nextAddress){case 1:return Ra.setCatchFinallyBlocks(2),Ra.yield(Xa.doEval({start:{row:0,column:0},end:Xa.documentEndPosition},Object.assign({},hb,{logDoit:!0})),4);case 4:ab=Ra.yieldResult;ma=ab.error?ab.error:
ab.isError?ab.value:null;Ra.leaveTryBlock(3);break;case 2:ma=X=Ra.enterCatchBlock();case 3:return ma?Xa.showError(ma):Xa.setStatusMessage(String(ab.value)),Ra.return(ab)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Xa,hb){var ab,ma,X,Ra,na,Fa,Ma,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nb){switch(Nb.nextAddress){case 1:return Xa.maybeSelectCommentOrLine(),Nb.setCatchFinallyBlocks(2),hb=
Object.assign({},hb,{asString:!1,logDoit:!0}),Nb.yield(Xa.doEval(void 0,hb),4);case 4:ab=Nb.yieldResult;ma=ab.error?ab.error:ab.isError?ab.value:null;Nb.leaveTryBlock(3);break;case 2:ma=X=Nb.enterCatchBlock();case 3:Xa.selection.collapseToEnd();if(Ra=ab.value&&ab.value.isColor)return Xa.selection.text=String(ab.value),na=new df.Morph({fill:df.Color.transparent,extent:df.pt(Xa.fontSize+2,Xa.fontSize+2),submorphs:[{fill:ab.value,center:df.pt(Xa.fontSize+2,Xa.fontSize+2).scaleBy(.5)}]}),Fa=Xa.selection.start,
Ma=Fa.column,lb=Fa.row,Xa.insertText([na,{}],Xa.selection.start),Xa.selection.start={column:Ma,row:lb},Xa.focus(),Nb.return(ab);Xa.insertTextAndSelect(ma?String(ma)+(ma.stack?"\n"+ma.stack:""):String(ab.value));Xa.focus();return Nb.return(ab)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Xa,hb){var ab,ma,X,Ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(na){switch(na.nextAddress){case 1:Xa.maybeSelectCommentOrLine();
ma=Xa.textInRange(Xa.selection);X=Xa.evalEnvironment||{};Ra=Xa.pluginFind(function(Fa){return Fa.isEditorPlugin&&"function"===typeof Fa.runEval});X.systemInterface||(X.systemInterface=Ra.systemInterface(hb));if("local"!==X.systemInterface.name){na.jumpTo(2);break}na.setCatchFinallyBlocks(3);return na.yield(Xa.doEval(void 0,hb),5);case 5:ab=na.yieldResult;ma=ab.value;na.leaveTryBlock(2);break;case 3:na.enterCatchBlock();case 2:return Xa.world().execCommand("open object editor",{target:ma,evalEnvironment:X}),
na.return(ab)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(Xa,hb){var ab,ma,X,Ra,na,Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ma){switch(Ma.nextAddress){case 1:Xa.maybeSelectCommentOrLine();X=Xa.textInRange(Xa.selection);Ra=Xa.evalEnvironment||{};na=Xa.pluginFind(function(lb){return lb.isEditorPlugin&&"function"===typeof lb.runEval});Ra.systemInterface||(Ra.systemInterface=na.systemInterface(hb));if("local"!==
Ra.systemInterface.name){df.Inspector.openInWindow({remoteTarget:{code:X,evalEnvironment:Ra}});Ma.jumpTo(2);break}Ma.setCatchFinallyBlocks(3);return Ma.yield(Xa.doEval(void 0,hb),5);case 5:ab=Ma.yieldResult;ma=ab.error?ab.error:ab.isError?ab.value:null;X=ab.value;Ma.leaveTryBlock(4);break;case 3:ma=Fa=Ma.enterCatchBlock();case 4:df.Inspector.openInWindow({targetObject:ma||X});case 2:return Ma.return(ab)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(Xa,hb,ab){ab=void 0===ab?1:ab;var ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){switch(X.nextAddress){case 1:return Xa.maybeSelectCommentOrLine(),X.setCatchFinallyBlocks(2),hb=Object.assign({},hb,{inspect:!0,inspectDepth:ab,logDoit:!0}),X.yield(Xa.doEval(void 0,hb),4);case 4:ma=X.yieldResult;X.leaveTryBlock(3);break;case 2:X.enterCatchBlock();case 3:return Xa.selection.collapseToEnd(),Xa.insertTextAndSelect(ma.value),X.return(ma)}})}}];df.codeEvaluationCommands=
hf;df.codeEvaluationCommands=hf;df.codeEvaluationCommands=hf;var yd=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");yd.changeAttributeInSelectionOrMorph=function(Xa,hb,ab){var ma=Xa.selection;Xa.keepPosAtSameScrollOffsetWhile(function(){ma.isEmpty()?Xa[hb]="function"===typeof ab?ab(Xa[hb]):ab:Xa.undoManager&&(Xa.undoManager.group(),Xa.changeStyleProperty(hb,function(X){return"function"===typeof ab?ab(X):ab}),Xa.undoManager.group())})};jf=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(Xa){var hb=Xa.fontSize;yd.changeAttributeInSelectionOrMorph(Xa,"fontSize",function(ab){ab=ab||hb;return ab+(18<=ab?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Xa){var hb=Xa.fontSize;yd.changeAttributeInSelectionOrMorph(Xa,"fontSize",function(ab){ab=ab||hb;return ab-(18>=ab?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Xa){var hb,ab,ma,X,Ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(na){if(1==na.nextAddress){hb=
["serif","sans-serif","monospace"];if(ab=localStorage["lively.morpic/text-change-font-additional-fonts"])ab=JSON.parse(ab),hb.push.apply(hb,$jscomp.arrayFromIterable(ab));hb.map(function(Fa){return Fa.toLowerCase()}).includes(Xa.fontFamily.toLowerCase())||(hb.push(Xa.fontFamily),ab=[].concat($jscomp.arrayFromIterable(ab||[]),[Xa.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(ab));return na.yield($world.editListPrompt("choose font",hb,{requester:Xa,preselect:hb.indexOf(Xa.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}ma=na.yieldResult;X=$jscomp.makeIterator(ma.selections);if(Ra=X.next().value)Xa.fontFamily=Ra;return na.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Xa,hb){hb=void 0===hb?{}:hb;var ab,ma,X,Ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(na){if(1==na.nextAddress){if(hb.hasOwnProperty("link"))return na.jumpTo(2);ma=Xa.selection;X=Xa.getStyleInRange(ma);Ra=X.link;return na.yield(Xa.world().prompt("Set link",
{input:Ra||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=na.nextAddress&&(ab=na.yieldResult,!ab))return na.return();Xa.undoManager.group();Xa.setStyleInRange({link:ab||void 0},ma);Xa.undoManager.group();na.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Xa,hb){var ab,ma,X,Ra;return $jscomp.asyncExecutePromiseGeneratorProgram(function(na){if(1==na.nextAddress)return ab=Xa.selection,ma=Xa.getStyleInRange(ab),X=ma.doit,na.yield(Xa.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:Xa,input:X?X.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Xa.evalEnvForDoit(X||{})}),2);Ra=na.yieldResult;Xa.undoManager.group();Ra?Xa.addTextAttribute({doit:{code:Ra},nativeCursor:"pointer",textDecoration:"underline"},ab):Xa.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},ab);Xa.undoManager.group();na.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Xa,hb){hb=void 0===hb?{}:hb;Xa.undoManager.group();
hb=!hb.onlySelection&&Xa.selection.isEmpty()?Xa.documentRange:Xa.selection.range;Xa.setStyleInRange(null,hb);Xa.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Xa){var hb,ab,ma,X;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ra){if(1==Ra.nextAddress)return Ra.yield(System.import("lively.modules"),2);if(3!=Ra.nextAddress)return hb=Ra.yieldResult,ab=hb.module,Ra.yield(ab("lively.ide/text/ui.js").load(),3);ma=Ra.yieldResult;X=ma.RichTextControl;return Ra.return(X.openFor(Xa))})}}];
yd.commands=jf;yd.commands=jf;yd.commands=jf;var Pe=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");Pe.guessTextModeName=uc;Pe.rangedToken=function(Xa,hb,ab,ma,X){return{start:{row:Xa,column:hb},end:{row:Xa,column:ab},token:ma,mode:X}};Pe.fun=rd;Pe.arr=Dc;Pe.connect=Wc;Pe.disconnect=Gc;Pe.DefaultTheme=Wd;Pe.tokenizeDocument=pd;Pe.modeInfo=vd;Pe.visitDocumentTokens=Ob;Pe.getMode=wa;Pe.completionCommands=He;Pe.multiSelectCommands=z;Pe.navCommands=Ke;Pe.codeCommands=sf;Pe.codeEvaluationCommands=
hf;Pe.richTextCommands=jf;Pe.Color=Lb;Pe.Range=me;Pe.guessTextModeName=uc;Pe.guessTextModeName=uc;Wd=function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),ab=hb.hasOwnProperty("EditorPlugin")&&"function"===typeof hb.EditorPlugin?hb.EditorPlugin:hb.EditorPlugin=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
Pe.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(ma){var X=this;this.textMorph=ma;Pe.connect(ma,"textChange",this,"onTextChange");Pe.connect(ma,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return X.highlight()})}},
{key:"detach",value:function(ma){Pe.disconnect(ma,"textChange",this,"onTextChange");Pe.disconnect(ma,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(ma){this._ast=null;if(ma){var X=this._tokenizerValidBefore;if("replace"===ma.selector){var Ra=ma.args[0].start;ma=Ra.row;Ra=Ra.column}else Ra=ma=0;if(!X||ma<X.row||ma===X.row&&Ra<X.column)ma=Math.max(0,ma),this._tokenizerValidBefore={row:ma,column:Ra}}this.requestHighlight()}},
{key:"requestHighlight",value:function(ma){var X=this;(void 0===ma?0:ma)?this.highlight():Pe.fun.debounceNamed(this.textMorph.id+"-requestHighlight",300,function(){X.highlight()})()}},{key:"highlight",value:function(){var ma=this.textMorph,X=this.theme,Ra=this.mode,na=this._tokenizerValidBefore;if(X&&ma&&ma.document&&Ra){ma.fill=X.background;ma.cursorColor=X.cursorColor||ma.fontColor;var Fa=ma.viewState,Ma={};na=Pe.tokenizeDocument(Ra,ma.document,Fa.firstVisibleRow,Fa.lastVisibleRow,na);Ra=na.lines;
na=na.tokens;if(Ra.length){Fa=Ra[0].row;for(var lb=[],Nb=0;Nb<na.length;Fa++,Nb++)for(var ac=na[Nb],Hc=0;Hc<ac.length;Hc+=5){var Lc=ac[Hc],kd=ac[Hc+1],Sd=X[ac[Hc+2]]||X.default;Sd&&lb.push({start:{row:Fa,column:Lc},end:{row:Fa,column:kd}},Sd)}ma.embeddedMorphs.forEach(function(ke){var Gd=ma.embeddedMorphMap.get(ke).anchor;Ma[ke.id]=ma.textAttributeAt(Gd.position)});ma.setTextAttributesWithSortedRanges(lb);ma.embeddedMorphs.forEach(function(ke){var Gd=ma.embeddedMorphMap.get(ke).anchor;Gd=Pe.Range.at(Gd.position);
Gd.end.column+=1;ma.replace(Gd,[ke,Ma[ke.id]],!1)});this._tokenizerValidBefore={row:Pe.arr.last(Ra).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},ma,this)}}},{key:"visitTokensInRange",value:function(ma,X){var Ra=ma.start,na=ma.end,Fa=Ra.row-1;Pe.visitDocumentTokens(this.mode,this.textMorph.document,Ra.row,na.row,null,function(Ma){return Fa++},function(Ma,lb,Nb,ac,Hc,Lc,kd){if(Fa===Ra.row&&0<Ra.column){if(Ra.column>=ac)return;Nb<Ra.column&&Ra.column<ac&&(Nb=Ra.column)}if(Fa===na.row){if(na.column<=
Nb)return;Nb<na.column&&na.column<ac&&(ac=na.column)}X(Ma,lb,Fa,Nb,ac,Hc,Lc,kd)})}},{key:"tokensInRange",value:function(ma){var X=[];this.visitTokensInRange(ma,function(Ra,na,Fa,Ma,lb,Nb,ac,Hc){return X.push(Pe.rangedToken(Fa,Ma,lb,Ra,Hc))});return X}},{key:"tokensOfRow",value:function(ma){var X=this.textMorph.getLine(ma).length;return this.tokensInRange({start:{row:ma,column:0},end:{row:ma,column:X}})}},{key:"tokenAt",value:function(ma){for(var X=this.tokensOfRow(ma.row),Ra=X.length;Ra--;){var na=
X[Ra];if(na.token&&na.start.column<=ma.column&&ma.column<=na.end.column)return na}return null}},{key:"getCommands",value:function(ma){return[].concat($jscomp.arrayFromIterable(ma),$jscomp.arrayFromIterable(Pe.completionCommands),$jscomp.arrayFromIterable(Pe.multiSelectCommands),$jscomp.arrayFromIterable(Pe.navCommands),$jscomp.arrayFromIterable(Pe.codeCommands),$jscomp.arrayFromIterable(Pe.codeEvaluationCommands),$jscomp.arrayFromIterable(Pe.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var ma=this.mode,X=ma.lineComment,Ra=ma.blockCommentStart;ma=ma.blockCommentEnd;var na={};X&&(na.lineCommentStart=X);Ra&&(na.blockCommentStart=Ra);ma&&(na.blockCommentEnd=ma);return na}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(ma,X,Ra){var na=this.textMorph,Fa=ma.row,Ma=ma.column;ma=X[Ma-1];X=X[Ma];na.selection.text="\n";na.selection.collapseToEnd();"{"===ma&&"}"===X&&(na.selection.text="\n"+" ".repeat(Ra),na.selection.collapse());
na.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:Fa+1,lastRow:Fa+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var ma=this.textMorph,X=this.openPairs,Ra=ma.selection,na=ma.getLine(Ra.end.row),Fa=na[Ra.end.column-1];na=na[Ra.end.column];ma.autoInsertPairs&&Ra.isEmpty()&&Fa in
X&&na===X[Fa]&&(Ra.growRight(1),Ra.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(ma){var X=this.openPairs,Ra=this.closePairs,na=this.textMorph,Fa=na.selection,Ma=na.autoInsertPairs&&ma in X,lb=na.autoInsertPairs&&ma in Ra;if(!Ma&&!lb)return!1;var Nb=na.getLine(Fa.end.row)[Fa.end.column];if(!Fa.isEmpty()){if(!Ma)return!1;Ra=na.undoManager.ensureNewGroup(na);na.insertText(X[ma],Fa.end);na.insertText(ma,Fa.start);na.undoManager.group(Ra);Fa.growRight(-1);return!0}if(Nb in Ra&&ma===Nb)return Fa.goRight(1),
!0;if(lb&&!Ma)return!1;Ra=na.undoManager.ensureNewGroup(na);na.insertText(ma+X[ma]);na.undoManager.group(Ra);Fa.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],hb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3148,end:12030})}(void 0);
vd=Wd=Pe.EditorPlugin;He=Pa("C",function(Xa){var hb=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),ab=hb.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof hb.CodeMirrorEnabledEditorPlugin?hb.CodeMirrorEnabledEditorPlugin:hb.CodeMirrorEnabledEditorPlugin=function(ma){ma&&ma[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Vb(ab,Xa,[{key:Symbol.for("lively-instance-initialize"),value:function(){Vb._get(Object.getPrototypeOf(ab.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(ma){this.mode=this.codeMirrorMode(ma);return Vb._get(Object.getPrototypeOf(ab.prototype),"attach",this).call(this,ma)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(ma){return{indentWithTabs:!ma.useSoftTabs,indentUnit:ma.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(ma){ma=
this.defaultCodeMirrorModeConfig(ma);return Pe.getMode(ma,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],hb,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:12041,end:12735})}(Pe.EditorPlugin));Pe.CodeMirrorEnabledEditorPlugin=
He;Pe.CodeMirrorEnabledEditorPlugin=He;Pe.CodeMirrorEnabledEditorPlugin=He;Pe.default=Wd;Wd=Object.freeze({__proto__:null,guessTextModeName:uc,"default":vd,CodeMirrorEnabledEditorPlugin:He});Pa("e",Wd)}}});
System.register(["./__root_module__-19078926.js","./index-079fa77a.js","./index-20301cd6.js","./user-ui-3de50906.js"],function(ya,wb){var Ab,ac,Ob,kd,Cc,qd,Dc,Ic,Qc,Bd,ne,ve,Wd,Ub,wc,od,Tb,xd,Fd;return{setters:[function(ic){Ab=ic.an;ac=ic.aD;Ob=ic.ap;kd=ic.ab;Cc=ic.Y;qd=ic.a6;Dc=ic.ax;Ic=ic.a7;Qc=ic.C;Bd=ic.a3;ne=ic.r;ve=ic.aw;Wd=ic.aC;Ub=ic.b1;wc=ic.b2;od=ic.au;Tb=ic.a$;xd=ic.aY},function(){},function(){},function(ic){Fd=ic.UserUI}],execute:function(){var ic=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");
ic.Morph=Ab;ic.HorizontalLayout=ac;ic.VerticalLayout=Ob;ic.morph=kd;ic.MorphicDB=Cc;ic.arr=qd;ic.fun=Dc;ic.string=Ic;ic.Color=Qc;ic.pt=Bd;ic.UserUI=Fd;ic.resource=ne;var rc=function(Hc){var ad=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),dd=ad.hasOwnProperty("WorldDashboard")&&"function"===typeof ad.WorldDashboard?ad.WorldDashboard:ad.WorldDashboard=function(ec){ec&&ec[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ve(dd,
Hc,[{key:"onLoad",value:function(){"undefined"!==typeof localStorage&&(this.ui.sortSelector.selection=localStorage.getItem("lively.morphic-projects-filter"))}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if(!this.isComponent&&"undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",this.ui.sortSelector.selection)}catch(ec){console.error(ec)}}},{key:"beforePublish",value:function(){this.reset()}},
{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(ec){ec=void 0===ec?$world:ec;this.owner!=ec&&ec.addMorph(this);this.center=ec.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(ec){var jb=ic.UserUI.getCurrentUser();ec=this.ui.searchField.fuzzyFilter(ec,function(yb){return yb._commit.name+yb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return ic.arr.sortBy(ec,
function(yb){return-yb._commit.timestamp});case "TEMPLATES":return ec;case "MY PROJECTS":return ic.arr.filter(ec,function(yb){return yb._commit.author.name===jb.name});case "PUBLISHED":return ec}}},{key:"updateList",value:function(){var ec=this;this.previews&&ic.fun.debounceNamed("update world list",150,function(){ec.ui.worldList.items=ec.sortAndFilterPreviews(ec.previews)})()}},{key:"displayWorlds",value:function(){var ec=this,jb,yb,Ja,Ta,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return ec.reset(),
jb=ec.ui,yb=jb.loadingLabel,yb.animate({opacity:1,duration:300}),Fa.yield(ec.db.latestCommits("world"),2);case 2:return Ja=Fa.yieldResult,Fa.yield(wb.import("./world preview-ce8535e7.js"),4);case 4:if(!(Ta=Fa.yieldResult)){Fa.jumpTo(5);break}return Fa.yield(ic.resource("part://partial freezing/world preview"),6);case 6:Ta=Fa.yieldResult;case 5:return Fa.yield(Ta.read(),3);case 3:return Ka=Fa.yieldResult,ec.previews=Ja.map(function(Xa){var Ib=ic.morph({reactsToPointer:!1,fill:ic.Color.transparent,
extent:Ka.extent});Ib._commit=Xa;Ib.displayPreview=function(){var jc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){if(1==lb.nextAddress)return jc=Ka.copy(),jc._commit=Xa,jc.opacity=0,Ib.addMorph(jc),jc.displayPreview(),jc.position=ic.pt(0,0),lb.yield(Ib.whenRendered(),2);Ib.layout=new ic.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});lb.jumpToEnd()})};return Ib}),Fa.yield(yb.animate({opacity:0,duration:300}),7);case 7:ec.updateList(),0==Ja.length&&(ec.ui.noWorldWarning.center=
ec.innerBounds().center(),ec.ui.noWorldWarning.animate({visible:!0,duration:300})),Fa.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(ec){this.ui.closeButton.visible=ec}},db:{serialize:!1,get:function(){return ic.MorphicDB.default}},
ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],ad,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"WorldDashboard",version:"0.1.1-131"}}},{start:330,end:4350})}(ic.Morph);rc=ic.WorldDashboard;ic.default=rc;var Gb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");Gb.Morph=Ab;Gb.touchInputDevice=Wd;Gb.TilingLayout=Ub;Gb.arr=qd;Gb.pt=Bd;rc=function(Hc){var ad=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),dd=ad.hasOwnProperty("GrowingWorldList")&&"function"===typeof ad.GrowingWorldList?ad.GrowingWorldList:ad.GrowingWorldList=function(ec){ec&&
ec[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ve(dd,Hc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(ec){ve._get(Object.getPrototypeOf(dd.prototype),"onScroll",this).call(this,ec);this.update()}},{key:"onChange",value:function(ec){ve._get(Object.getPrototypeOf(dd.prototype),"onChange",this).call(this,ec);"extent"==ec.prop&&this.update(!0)}},{key:"onHoverIn",value:function(ec){this.clipMode=
"auto"}},{key:"onHoverOut",value:function(ec){Gb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(ec){var jb=this.items;if(jb&&0!=jb.length){var yb=this.scrollContainer,Ja=yb.layout.spacing;yb.extent=this.extent;var Ta=this.ui,Ka=Ta.bufferTop;Ta=Ta.bufferBottom;Ka=Ka||yb.addMorph({fill:null,name:"buffer top",height:10});Ta=Ta||yb.addMorph({fill:null,name:"buffer bottom",height:10});Ka.width=Ta.width=this.width-100;yb.layout.disable();var Fa=jb[0];Ja=jb.slice(0,Math.floor(this.width/
(Fa.width+Ja))*(Math.ceil((this.scroll.y+this.height)/(Fa.height+Ja))+1)).filter(function(lb){return lb.owner!=yb});Fa=this.scroll.y+2*this.height;for(var Xa={},Ib=$jscomp.makeIterator(Ja),jc=Ib.next();!jc.done;Xa={$jscomp$loop$prop$item$2591:Xa.$jscomp$loop$prop$item$2591},jc=Ib.next())Xa.$jscomp$loop$prop$item$2591=jc.value,Fa++,Xa.$jscomp$loop$prop$item$2591.top=Fa,yb.addMorph(Xa.$jscomp$loop$prop$item$2591),Xa.$jscomp$loop$prop$item$2591._initialized||Xa.$jscomp$loop$prop$item$2591.whenRendered().then(function(lb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){lb.$jscomp$loop$prop$item$2591._initialized=
!0;return tb.yield(lb.$jscomp$loop$prop$item$2591.displayPreview(),0)})}}(Xa));ec&&(Ka.position=Gb.pt(0,0),jb.forEach(function(lb,tb){return lb.position=Gb.pt(tb+1,tb+1)}),Ta.position=Gb.pt(jb.length+2,jb.length+2));yb.layout.enable();if(ec||0<Ja.length)Ta.top=this.submorphBounds().height,yb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Gb.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(ec){this.setProperty("items",ec);var jb=this.scrollContainer;jb.layout&&jb.layout.disable();var yb=this.ui,Ja=yb.bufferTop;yb=yb.bufferBottom;Gb.arr.withoutAll(jb.submorphs,
[].concat($jscomp.arrayFromIterable(ec),[Ja,yb])).forEach(function(Ta){return Ta.remove()});this.update(!0)}}}}}],ad,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Gb.Morph);rc=Gb.GrowingWorldList;Gb.default=rc;var oc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
oc.InputLine=wc;oc.Color=Qc;oc.connect=od;oc.disconnectAll=Tb;oc.disconnect=xd;oc.arr=qd;oc.string=Ic;rc=function(Hc){var ad=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),dd=ad.hasOwnProperty("SearchInputLine")&&"function"===typeof ad.SearchInputLine?ad.SearchInputLine:ad.SearchInputLine=function(ec){ec&&ec[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ve(dd,Hc,[{key:"fuzzyMatch",value:function(ec,jb){jb=void 0===
jb?this.parseInput():jb;if(jb.lowercasedTokens.every(function(Ja){return ec.toLowerCase().includes(Ja)}))return!0;var yb=ec.toLowerCase();return 3>=oc.arr.sum(jb.lowercasedTokens.map(function(Ja){return oc.string.levenshtein(yb,Ja)}))}},{key:"fuzzyFilter",value:function(ec,jb){var yb=this;jb=void 0===jb?function(Ta){return Ta}:jb;var Ja=this.parseInput();return oc.arr.filter(ec,function(Ta){return yb.fuzzyMatch(jb(Ta),Ja)})}},{key:"parseInput",value:function(){var ec=Array.from(this.textString).reduce(function(yb,
Ja){if("\\"===Ja&&!yb.escaped)return yb.escaped=!0,yb;" "!==Ja||yb.escaped?(yb.spaceSeen=!1,yb.current+=Ja):(!yb.spaceSeen&&yb.current&&(yb.tokens.push(yb.current),yb.current=""),yb.spaceSeen=!0);yb.escaped=!1;return yb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});ec.current&&ec.tokens.push(ec.current);var jb=ec.tokens.map(function(yb){return yb.toLowerCase()});return{tokens:ec.tokens,lowercasedTokens:jb}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],ad,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(oc.InputLine);rc=oc.SearchInputLine;oc.default=rc}}});
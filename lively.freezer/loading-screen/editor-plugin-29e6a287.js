System.register(["./__root_module__-c4f77fb9.js","kld-intersections","./index-2a389db9.js","./editor-plugin-f1f42a9c.js","./index-d5709707.js"],function(ra){var jb,pb,Ub,Jb,jd,uc,nd,wc,Cc,Mc,Bd,re,Ce,be,Sb,qc,od,Tb,wd,Fd,fc,ic,Ab,jc;return{setters:[function(Bc){jb=Bc.aw;pb=Bc.bA;Ub=Bc.bB;Jb=Bc.bC;jd=Bc.E;uc=Bc.au;nd=Bc.aY;wc=Bc.a7;Cc=Bc.ae;Mc=Bc.bn;Bd=Bc.a6;re=Bc.$;Ce=Bc.bD;be=Bc.bu},function(){},function(Bc){Sb=Bc.s},function(Bc){qc=Bc.p;od=Bc.d;Tb=Bc.a;wd=Bc.r;Fd=Bc.C},function(Bc){fc=Bc.localInterface;
ic=Bc.systemInterfaceNamed;Ab=Bc.serverInterfaceFor;jc=Bc.l2lInterfaceFor}],execute:function(){var Bc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");Bc.warnStyle={"border-bottom":"2px dotted orange"};Bc.errorStyle={"background-color":"red"};var ad=function(Bb){var ba=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),xa=ba.hasOwnProperty("JavaScriptChecker")&&"function"===typeof ba.JavaScriptChecker?ba.JavaScriptChecker:ba.JavaScriptChecker=function(M){M&&M[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return jb(xa,Bb,[{key:"uninstall",value:function(M){var ha=M.text||M;(ha.markers||[]).forEach(function(Ka){return Ka.id.startsWith("js-checker-")&&ha.removeMarker(Ka)});ha.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(M,ha){return[].concat($jscomp.arrayFromIterable(M.embeddedMorphMap.values())).find(function(Ka){return ha.containsPosition(Ka.anchor.position)})}},{key:"onDocumentChange",value:function(M,
ha,Ka){var $a=ha.document;try{var $b=Ka.parse()}catch(Tc){$b=Tc}$b&&(M=(ha.markers||[]).filter(function(Tc){return Tc.id.startsWith("js-checker-")}),Ka=Ka.undeclaredVariables().map(function(Tc,Yb){var ub=Tc.start;Tc=Tc.end;ub=$a.indexToPosition(ub);Tc=$a.indexToPosition(Tc);return ha.addMarker({id:"js-checker-"+Yb,style:Bc.warnStyle,range:{start:ub,end:Tc},type:"js-undeclared-var"})}),M.slice(Ka.length).forEach(function(Tc){return ha.removeMarker(Tc)}),$b.parseError?(M=$b.parseError.loc,Ka=M.column,
M=M.line-1,$b=$a.indexToPosition($b.parseError.pos),Ka=$b.column,M=$b.row,$b={start:{column:Ka-1,row:M},end:{column:Ka+1,row:M}},this.hasEmbeddedMorphInRange(ha,$b)||ha.addMarker({id:"js-syntax-error",range:$b,style:Bc.errorStyle,type:"js-syntax-error"})):ha.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],ba,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),bd=ad=Bc.JavaScriptChecker;Bc.default=ad;var ob=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");ob.query=pb;ob.fuzzyParse=Ub;ob.acorn=Jb;ob.custom=jd;var kb=function(Bb){var ba=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),xa=ba.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof ba.JavaScriptNavigator?
ba.JavaScriptNavigator:ba.JavaScriptNavigator=function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return jb(xa,Bb,[{key:"ensureAST",value:function(M){return this.parse(M.textString)}},{key:"parse",value:function(M){return ob.fuzzyParse(M)}},{key:"move",value:function(M,ha){var Ka=!!ha.activeMark||!ha.selection.isEmpty(),$a=ha.selection,$b=ha.positionToIndex($a.lead);M=this[M](ha.textString,$b);M=ha.indexToPosition(M);$a.lead=
M;Ka||($a.anchor=M);ha.scrollCursorIntoView()}},{key:"forwardSexp",value:function(M){this.move("_forwardSexp",M)}},{key:"backwardSexp",value:function(M){this.move("_backwardSexp",M)}},{key:"backwardUpSexp",value:function(M){this.move("_backwardUpSexp",M)}},{key:"forwardDownSexp",value:function(M){this.move("_forwardDownSexp",M)}},{key:"_forwardSexp",value:function(M,ha){M=this.parse(M);M=ob.custom.findNodesIncluding(M,ha).reverse().find(function($a){return $a.end!==ha});if(!M)return ha;if("BlockStatement"===
M.type){var Ka=M.body.find(function($a){return $a.start>ha});if(Ka)return Ka.start}return M.end}},{key:"_backwardSexp",value:function(M,ha){M=this.parse(M);M=ob.custom.findNodesIncluding(M,ha).reverse().find(function($a){return $a.start!==ha});if(!M)return ha;if("BlockStatement"===M.type){var Ka=M.body.slice().reverse().find(function($a){return $a.end<ha});if(Ka)return Ka.end}return M?M.start:ha}},{key:"_backwardUpSexp",value:function(M,ha){M=this.parse(M);return(M=ob.custom.findNodesIncluding(M,
ha).reverse().find(function(Ka){return Ka.start!==ha}))?M.start:ha}},{key:"_forwardDownSexp",value:function(M,ha){M=this.parse(M);return(M=ob.custom.findNodeAfter(M,ha,function(Ka,$a){return $a.start>ha}))?M.node.start:ha}},{key:"markDefun",value:function(M){var ha=this.rangeForFunctionOrDefinition(M.textString,[M.positionToIndex(M.selection.range.start),M.positionToIndex(M.selection.range.end)]);ha&&M.execCommand("expandRegion",{start:ha[0],end:ha[1]})}},{key:"rangeForNodesMatching",value:function(M,
ha,Ka){M=this.parse(M);return(ha=ob.custom.findNodesIncluding(M,ha).reverse().find(Ka))?[ha.start,ha.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(M,ha){var Ka=ha[0]===ha[1];return this.rangeForNodesMatching(M,ha[1],function($a){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes($a.type)&&(Ka&&$a.end!==ha[1]||!Ka&&$a.start<ha[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(M,ha){"number"!==typeof ha&&(ha=M.positionToIndex(ha));
M=this.ensureAST(M);var Ka=ob.query.nodesAt(ha,M).reverse(),$a=Ka.find(function(Tc){return"Identifier"===Tc.type});if(!$a&&((Ka=Ka[0])&&Ka.type.includes("Specifier")&&Ka.local&&"Identifier"===Ka.local.type&&($a=Ka.local),!$a))return;ha=(Ka=ob.query.findDeclarationClosestToIndex(M,$a.name,ha))?ob.query.scopeAtIndex(M,Ka.start):ob.query.scopeAtIndex(M,ha);var $b=ob.query.findReferencesAndDeclsInScope(ha,$a.name).refs;return{parsed:M,scope:ha,id:$a,name:$a.name,decl:Ka,refs:$b}}},{key:"expandRegion",
value:function(M,ha,Ka,$a){function $b(qd){qd=M.positionToIndex({column:0,row:Yb.row});return{range:[qd+ub.start,qd+ub.start+ub.value.length],prev:$a}}var Tc=$a.range[0]!==$a.range[1],Yb=M.indexToPosition($a.range[0]),ub=M.tokenAt(Yb);if(!Tc&&ub&&["keyword","identifier"].includes(ub.type))return $b();Ka=Ka||this.parse(ha);ha=ob.query.nodesAtIndex(Ka,$a.range[0]).reverse().find(function(qd){return qd.start<$a.range[0]||qd.end>$a.range[1]});if(!ha)return $a;Ka=ha.start;Tc=ha.end;return"Literal"===ha.type&&
(ha.raw||"").match(/^['"`]/)&&$a.range[0]!==ha.start&&$a.range[1]!==ha.end&&(ha.start+1<$a.range[0]||ha.end-1>$a.range[1])?{range:[Ka+1,Tc-1],prev:$a}:{range:[Ka,Tc],prev:$a}}},{key:"contractRegion",value:function(M,ha,Ka,$a){return $a.prev||$a}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],ba,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6780})}(void 0);ad=kb=ob.JavaScriptNavigator;ob.default=kb;var tb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");tb.addIndexToTextPos=function(Bb,ba,xa){return Bb.indexToPosition(Bb.positionToIndex(ba)+xa)};tb.connect=uc;tb.disconnect=nd;tb.string=wc;tb.KeyHandler=Cc;tb.Range=Mc;kb=function(Bb){var ba=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),xa=ba.hasOwnProperty("Snippet")&&"function"===
typeof ba.Snippet?ba.Snippet:ba.Snippet=function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return jb(xa,Bb,[{key:Symbol.for("lively-instance-initialize"),value:function(M){M=void 0===M?{trigger:null,expansion:""}:M;var ha=M.expansion;this.trigger=M.trigger;this.expansion=ha;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(M){this.isExpanding&&(this.textMorph=M,tb.connect(this.textMorph,
"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(M){this.isExpanding&&(tb.disconnect(M,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var M=this.expansionState,ha=M.startAnchor,Ka=M.endAnchor;M.isExpanding?tb.Range.fromPositions(ha.position,Ka.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var M=this.textMorph;if(M){var ha=
this.expansionState||{},Ka=ha.marker,$a=ha.startAnchor,$b=ha.endAnchor;ha=ha.steps;$a&&M.removeAnchor($a);$b&&M.removeAnchor($b);Ka&&M.removeMarker(Ka);ha.forEach(function(Tc){return M.removeAnchor(Tc.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};M&&M.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(M){var ha=[],Ka=0;tb.string.reMatches(M,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function($a){var $b=
$a.start,Tc=$a.end;$a=$a.match;var Yb="";$a.startsWith("${")?(Yb=$jscomp.makeIterator($a.match(/^\$\{([0-9]+):([^\}]*)\}/)),Yb.next(),$a=Yb.next().value,Yb=Yb.next().value,$a=Number($a)):$a=Number($a.replace(/^\$/,""));M=M.slice(0,$b-Ka)+Yb+M.slice(Tc-Ka);ha[$a]={index:$b-Ka,prefill:Yb,anchor:null};Ka+=Tc-$b-Yb.length});return{steps:ha,expansion:M}}},{key:"expandAtCursor",value:function(M){var ha=M.selection,Ka=M.cursorPosition.column,$a=this.expansion;this.trigger&&(Ka-=this.trigger.length);if(Ka=
Math.max(0,Ka))$a=tb.string.lines($a),$a=[$a[0]].concat($jscomp.arrayFromIterable($a.slice(1).map(function(Uc){return tb.string.indent(Uc," ",Ka)}))),$a=$a.join("\n");var $b=this.createExpansionSteps($a);$a=$b.expansion;$b=$b.steps;this.trigger&&ha.growLeft(this.trigger.length);ha.text=$a;var Tc=ha.start;$a=ha.end;ha.collapseToEnd();if($b.length){var Yb=tb.string.newUUID();$b.forEach(function(Uc,Ua){return Uc.anchor=M.addAnchor(Object.assign({id:"snippet-step-"+Ua+"-"+Yb},tb.addIndexToTextPos(M,Tc,
Uc.index)))});var ub=M.addAnchor(Object.assign({id:"snippet-start-"+Yb},Tc,{insertBehavior:"stay"})),qd=M.addAnchor(Object.assign({id:"snippet-end-"+Yb},$a));this.expansionState={marker:M.addMarker({id:"snippet-marker-"+Yb,get range(){return{start:ub.position,end:qd.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:ub,endAnchor:qd,stepIndex:0,steps:$b,isExpanding:!0};
M.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var M=this.expansionState,ha=M.steps,Ka=this.textMorph;if(M.isExpanding&&Ka){Ka=Ka.selection;M=ha[M.stepIndex];var $a=M.prefill;Ka.lead=Ka.anchor=M.anchor.position;Ka.growRight($a.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=ha.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(M,ha){ha=M.positionToIndex(M.cursorPosition);
return M.textString.slice(ha-this.trigger.length,ha)===this.trigger}},{key:"tryTrigger",value:function(M,ha){if(!this.canExpand(M,M.cursorPosition))return!1;this.expandAtCursor(M);return!0}},{key:"getCommands",value:function(M){var ha=this;return M.concat([{name:"[snippet] next expansion step",exec:function(Ka){ha.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(Ka){ha.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(M){return M.concat(tb.KeyHandler.withBindings([{keys:"Tab",
command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],ba,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:357,end:6029})}(void 0);tb.Snippet=kb;tb.Snippet=kb;tb.Snippet=
kb;var Aa=[{name:"get snippets",exec:function(Bb){return Bb.pluginCollect("getSnippets",[])}}];tb.snippetCommands=Aa;tb.snippetCommands=Aa;tb.snippetCommands=Aa;var Fa=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");Fa.buildEvalOpts=function(Bb,ba){return Bb.plugins.find(function(xa){return xa.isJSEditorPlugin}).sanatizedJsEnv(ba)};Fa.Snippet=kb;Aa=function(Bb){var ba=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),xa=ba.hasOwnProperty("ModuleTopLevelVarCompleter")&&
"function"===typeof ba.ModuleTopLevelVarCompleter?ba.ModuleTopLevelVarCompleter:ba.ModuleTopLevelVarCompleter=function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return jb(xa,Bb,[{key:"compute",value:function(M,ha){var Ka,$a,$b,Tc,Yb,ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qd){if(1==qd.nextAddress){$a=(Ka=M.pluginFind(function(Uc){return Uc.isJSEditorPlugin}))&&Ka.systemInterface();if(!$a)return qd.return([]);
$b=Fa.buildEvalOpts(M);Tc=$b.targetModule;return"local"===$a.name?(Yb=Object.getOwnPropertyNames($a.getModule(Tc).recorder),qd.jumpTo(2)):qd.yield($a.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+Tc+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',
{targetModule:"lively://module-recorder-completer"}),3)}if(2!=qd.nextAddress){ub=qd.yieldResult;if(ub.isError)return qd.return([]);Yb=JSON.parse(ub.value)}Yb=Yb.filter(function(Uc){return!Uc.startsWith("defVar_")&&!["System","__currentLivelyModule","initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(Uc)});return qd.return(Yb.map(function(Uc){return{priority:1100,completion:Uc}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],
ba,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:227,end:1700})}(void 0);Fa.ModuleTopLevelVarCompleter=Aa;Fa.ModuleTopLevelVarCompleter=Aa;Fa.ModuleTopLevelVarCompleter=Aa;Aa=function(Bb){var ba=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),xa=ba.hasOwnProperty("DynamicJavaScriptCompleter")&&
"function"===typeof ba.DynamicJavaScriptCompleter?ba.DynamicJavaScriptCompleter:ba.DynamicJavaScriptCompleter=function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return jb(xa,Bb,[{key:"isValidPrefix",value:function(M){return/\.[a-z0-9_]*$/i.test(M)}},{key:"isMethodCallCompletion",value:function(M){return M.endsWith(")")&&0<M.indexOf("(")}},{key:"isValidIdentifier",value:function(M){if("string"!==typeof M)return!1;this.isMethodCallCompletion(M)&&
(M=M.slice(0,M.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(M)?!0:!1}},{key:"wrapInBrackets",value:function(M){if(!isNaN(Number(M))||M.startsWith("Symbol."))return"["+M+"]";var ha="";this.isMethodCallCompletion(M)&&(ha=M.slice(M.indexOf("(")),M=M.slice(0,M.indexOf("(")));return'["'+M.replace(/"/g,'\\"')+'"]'+ha}},{key:"compute",value:function(M){var ha=this,Ka,$a,$b,Tc,Yb,ub,qd,Uc,Ua,lb,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){if(1==ab.nextAddress){Ka=M.selection;
Ka.isEmpty()?($a=M.getLine(Ka.lead.row),$a=$a.slice($a.lastIndexOf(":")+1,Ka.lead.column)):$a=Ka.text.slice(Math.max(0,Ka.text.indexOf(":")),0);if(!ha.isValidPrefix($a))return ab.return([]);Tc=($b=M.pluginFind(function(Dc){return Dc.isJSEditorPlugin}))&&$b.systemInterface();if(!Tc)return ab.return([]);Yb=Fa.buildEvalOpts(M);return ab.yield(Tc.dynamicCompletionsForPrefix(Yb.targetModule,$a,Yb),2)}ub=ab.yieldResult;qd=ub.isError;Uc=ub.value;Ua=ub.completions;lb=ub.prefix;if(qd)return console.warn("javascript completer encountered error: "+
(Uc.stack||Uc)),ab.return([]);Ua.reduce(function(Dc,Hc){Hc=$jscomp.makeIterator(Hc);Hc.next();Hc=Hc.next().value;return Dc+Hc.length},0);xc=Ua.reduce(function(Dc,Hc,Xa){Hc=$jscomp.makeIterator(Hc);var bb=Hc.next().value;Hc=Hc.next().value;return Dc.concat(Hc.map(function(cb){var Sc=ha.isValidIdentifier(cb);return{info:bb,completion:cb,prefix:Sc?lb:"."+lb,customInsertionFn:Sc?ha.isMethodCallCompletion(cb)?function(sd,Ud,hc,Ed){Ud=Ed.start;Ed=Ed.end;sd=sd.replace(/\((.*)\)/,function(Ac){return"("+Ac.slice(1,
-1).split(", ").map(function(Jd,ka){return"${"+ka+":"+Jd+"}"}).join(", ")+")"});sd=new Fa.Snippet({expansion:sd});hc.replace({start:Ud,end:Ed},"");sd.expandAtCursor(hc)}:null:function(sd,Ud,hc,Ed){sd=Ed.start;Ed=Ed.end;Ud={row:sd.row,column:sd.column-1};Ed="."===hc.textInRange({start:Ud,end:sd})?{start:Ud,end:Ed}:{start:sd,end:Ed};hc.replace(Ed,ha.wrapInBrackets(cb))}}}))},[]);xc.forEach(function(Dc,Hc){return Object.assign(Dc,{priority:2E3+xc.length-Hc})});return ab.return(xc)})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"DynamicJavaScriptCompleter"}}],ba,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5085})}(void 0);Fa.DynamicJavaScriptCompleter=Aa;Fa.DynamicJavaScriptCompleter=Aa;Fa.DynamicJavaScriptCompleter=Aa;Fa.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
Aa=function(Bb){var ba=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),xa=ba.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof ba.JavaScriptKeywordCompleter?ba.JavaScriptKeywordCompleter:ba.JavaScriptKeywordCompleter=function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return jb(xa,Bb,[{key:"compute",value:function(M,ha){return Fa.keywords.map(function(Ka){return{completion:Ka,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],ba,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6087,end:6225})}(void 0);Fa.JavaScriptKeywordCompleter=Aa;Fa.JavaScriptKeywordCompleter=Aa;Fa.JavaScriptKeywordCompleter=Aa;Aa=[new Fa.DynamicJavaScriptCompleter,
new Fa.JavaScriptKeywordCompleter,new Fa.ModuleTopLevelVarCompleter];Fa.completers=Aa;Fa.completers=Aa;Fa.completers=Aa;var Ba=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");Ba.Snippet=kb;var wa=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];Ba.snippets=wa;Ba.snippets=wa;Ba.snippets=wa;var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");Na.getEvalEnv=function(Bb){return(Bb=Bb.pluginFind(function(ba){return ba.isJSEditorPlugin}))?Bb.evalEnvironment:null};Na.setEvalEnv=function(Bb,ba){(Bb=Bb.pluginFind(function(xa){return xa.isJSEditorPlugin}))&&Object.assign(Bb.evalEnvironment,ba);return Bb.evalEnvironment};
Na.pToI=function(Bb,ba){return Bb.positionToIndex(ba)};Na.iToP=function(Bb,ba){return Bb.indexToPosition(ba)};Na.arr=Bd;Na.promise=re;Na.string=wc;Na.show=Sb;Na.Range=Mc;Na.query=pb;Na.BaseVisitor=Ce;Ba=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(Bb,ba){ba=void 0===ba?{varName:null,position:null}:ba;var xa,M,ha,Ka,$a,$b,Tc,Yb,ub,qd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){switch(Uc.nextAddress){case 1:xa=
ba;M=xa.varName;ha=xa.position;if(!M){ha||(ha=Bb.cursorPosition);Ka=Bb.pluginInvokeFirst("getNavigator");$a=Ka.ensureAST(Bb);$b=Na.query.nodesAt(Bb.positionToIndex(ha),$a).reverse().find(function(Ua){return"Identifier"===Ua.type});if(!$b)return Bb.showError(Error("no identifier found!")),Uc.return(!0);M=$b.name}ba=Bb.pluginFind(function(Ua){return Ua.isJSEditorPlugin}).sanatizedJsEnv();Tc='lively.modules.module("'+ba.targetModule+'").undefine("'+M+'")';Uc.setCatchFinallyBlocks(2);return Uc.yield(Bb.doEval(null,
ba,Tc),4);case 4:Yb=Uc.yieldResult;ub=Yb.error?Yb.error:Yb.isError?Yb.value:null;Uc.leaveTryBlock(3);break;case 2:ub=qd=Uc.enterCatchBlock();case 3:return ub?Bb.showError(ub):Bb.setStatusMessage(M+" undefined"),Uc.return(!0)}})}},{name:"change doitContext",exec:function(Bb){var ba,xa,M,ha,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){if(1==$a.nextAddress)return ba=$jscomp,xa=ba.makeIterator,$a.yield(Bb.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function($b){return!$b.isUsedAsEpiMorph()}}),2);M=xa.call(ba,$a.yieldResult);if(ha=M.next().value)Ka="reset"===ha,Bb.doitContext=Ka?null:ha,Bb.setStatusMessage(Ka?"doitContext is now\n"+ha:"doitContext reset");return $a.return(!0)})}},{name:"change eval backend",exec:function(Bb,ba){ba=void 0===ba?{backend:void 0}:ba;var xa,M;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ha){if(1==ha.nextAddress)return xa=ba,M=xa.backend,void 0!==M?ha.jumpTo(2):
ha.yield(Bb.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=ha.nextAddress&&(M=ha.yieldResult,!M))return Bb.setStatusMessage("Canceled"),ha.return(!0);"local"===M&&(M=null);Bb.setStatusMessage("Eval backend is now "+(M||"local"));return ha.return(Na.setEvalEnv(Bb,{remote:M}))})}},{name:"copy current module name to clipboard",exec:function(Bb){var ba=Bb.evalEnvironment.targetModule;Bb.setStatusMessage(ba||"Cannot find module name");Bb.env.eventDispatcher.killRing.add(Bb);
Bb.env.eventDispatcher.doCopy(ba);return!0}}];Na.jsEditorCommands=Ba;Na.jsEditorCommands=Ba;Na.jsEditorCommands=Ba;var La=[{name:"[javascript] list errors and warnings",exec:function(Bb){var ba,xa,M,ha,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){if(1==$a.nextAddress){ba=(Bb.markers||[]).filter(function($b){$b=$b.type;return"js-undeclared-var"===$b||"js-syntax-error"===$b});if(!ba.length)return Na.show("no warnings or errors"),$a.return(!0);xa=ba.map(function($b){var Tc=$b.range;
return{isListItem:!0,string:"["+$b.type.split("-").slice(1).join(" ")+"] "+Bb.textInRange(Tc),value:Tc}});return $a.yield(Bb.world().filterableListPrompt("jump to warning or error",xa),2)}M=$a.yieldResult;ha=$jscomp.makeIterator(M.selected);if(Ka=ha.next().value)Bb.saveMark(),Bb.selection=Ka,Bb.centerRow(Ka.start.row);return $a.return(!0)})}},{name:"[javascript] inject import",exec:function(Bb,ba){ba=void 0===ba?{gotoImport:!1,insertImportAtCursor:!0}:ba;var xa,M,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){switch(Ka.nextAddress){case 1:return Ka.yield(Na.promise.delay(0),
2);case 2:return Ka.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return xa=Ka.yieldResult,M=xa.interactivelyInjectImportIntoText,Ka.yield(M(Bb,ba),4);case 4:return(ha=Ka.yieldResult)||Bb.setStatusMessage("canceled"),Ka.return(ha)}})}},{name:"[javascript] fix undeclared variables",exec:function(Bb,ba){ba=void 0===ba?{ignore:[],autoApplyIfSingleChoice:!1,requester:Bb}:ba;var xa,M,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){if(1==Ka.nextAddress)return Ka.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=Ka.nextAddress)return xa=Ka.yieldResult,M=xa.interactivlyFixUndeclaredVariables,Ka.yield(M(Bb,ba),3);ha=Ka.yieldResult;Bb.focus();return Ka.return(ha)})}},{name:"[javascript] remove unused imports",exec:function(Bb,ba){ba=void 0===ba?{query:!0}:ba;var xa,M,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){if(1==Ka.nextAddress)return Ka.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=Ka.nextAddress)return xa=Ka.yieldResult,M=xa.cleanupUnusedImports,Ka.yield(M(Bb,
ba),3);ha=Ka.yieldResult;Bb.setStatusMessage(ha);return Ka.return(!0)})}},{name:"[javascript] eslint report",exec:function(Bb){var ba,xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){if(1==M.nextAddress)return M.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);ba=M.yieldResult;xa=ba.default;try{return M.return(xa.reportOnMorph(Bb))}catch(ha){Bb.showError(ha)}M.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(Bb){var ba,xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){if(1==
M.nextAddress)return M.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);ba=M.yieldResult;xa=ba.default;try{return M.return(xa.previewFixesOnMorph(Bb))}catch(ha){Bb.showError(ha)}M.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(Bb,ba,xa){function M(ab,Dc){Dc||(Dc=Yb(ab,{allowReturnOutsideFunction:!0}));var Hc=Na.string.lineRanges(ab),Xa=ab.split("\n"),bb=[],cb=new Na.BaseVisitor,Sc=cb.visitVariableDeclaration;cb.visitVariableDeclaration=function(Ed,
Ac,Jd){if(1<Ed.declarations.length)for(var ka=Na.string.findLineWithIndexInLineRanges(Hc,Ed.start),Ra=Ed.declarations[0].start-Hc[ka][0],Ha={},Ya=1;Ya<Ed.declarations.length;Ha={$jscomp$loop$prop$actionType$2556:Ha.$jscomp$loop$prop$actionType$2556,$jscomp$loop$prop$arg$2557:Ha.$jscomp$loop$prop$arg$2557},Ya++){var H=Ed.declarations[Ya],ea=Na.string.findLineWithIndexInLineRanges(Hc,H.start);if(ka!==ea){var Oa=Xa[ea].match(/\s*/)[0].length;Oa=Ra-Oa;0!==Oa&&(H=Na.string.findLineWithIndexInLineRanges(Hc,
H.end),Ha.$jscomp$loop$prop$actionType$2556=0<Oa?"insert":"delete",Ha.$jscomp$loop$prop$arg$2557=0<Oa?" ".repeat(Oa):-Oa,bb.push.apply(bb,$jscomp.arrayFromIterable(Na.arr.range(ea,H).map(function(sb){return function(Lb){return[sb.$jscomp$loop$prop$actionType$2556,Hc[Lb][0],sb.$jscomp$loop$prop$arg$2557]}}(Ha)))))}}return Sc.call(cb,Ed,Ac,Jd)};cb.accept(Dc,{},[]);for(Dc=bb.length;Dc--;){var sd=$jscomp.makeIterator(bb[Dc]),Ud=sd.next().value,hc=sd.next().value;sd=sd.next().value;"insert"===Ud?ab=ab.slice(0,
hc)+sd+ab.slice(hc):"delete"===Ud&&(ab=ab.slice(0,hc)+ab.slice(hc+sd))}return ab}var ha,Ka,$a,$b,Tc,Yb,ub,qd,Uc,Ua,lb,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){switch(ab.nextAddress){case 1:return ha=xa||Math.floor(Bb.width/Bb.defaultCharExtent().width),ba=Object.assign({printWidth:ha,tabWidth:2,useTabs:!1,bracketSpacing:!1},ba),Ka=lively.modules.module,$a=System.normalizeSync("prettier/standalone.js"),ab.yield(Ka($a).load({format:"global",instrument:!1}),2);case 2:return $b=
ab.yieldResult,ab.yield(Ka("lively.ast/lib/acorn-extension.js").load(),3);case 3:return ab.yield(Ka("lively.ast").load(),4);case 4:return Tc=ab.yieldResult,Yb=Tc.parse,ab.yield(Ka("lively.ast/lib/query.js").load(),5);case 5:return ab.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return ub=ab.yieldResult,qd=Bb.selection.isEmpty()?Bb.documentRange:Bb.selection.range,Uc=Bb.positionToIndex(qd.start),Ua=Bb.positionToIndex(qd.end),lb=$b.format(Bb.textString,Object.assign({},
ba,{rangeStart:Uc,rangeEnd:Ua,parser:function(Dc,Hc,Xa){return Yb(Dc,{allowReturnOutsideFunction:!0})}})),Bb.undoManager.group(),xc=ub.diffChars(Bb.textString,lb),Bb.applyJsDiffPatch(xc),Bb.selection.text=M(Bb.selection.text),Bb.undoManager.group(),ab.return(!0)}})}}];Na.jsIdeCommands=La;Na.jsIdeCommands=La;Na.jsIdeCommands=La;var Wa=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(Bb,ba){ba=Bb.pluginInvokeFirst("getNavigator");if(!ba)return!0;ba=ba.resolveIdentifierAt(Bb,Bb.cursorPosition);
if(!ba||!ba.id)return Na.show("No symbol identifier selected"),!0;if(!ba.decl)return Na.show("Cannot find declaration of "+ba.name),!0;Bb.saveMark();Bb.selection={start:Bb.indexToPosition(ba.decl.start),end:Bb.indexToPosition(ba.decl.end)};Bb.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(Bb){Bb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(Bb){Bb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(Bb,ba){ba=void 0===ba?{direction:null}:ba;var xa=Bb.pluginInvokeFirst("getNavigator");if(!xa)return!0;xa=xa.resolveIdentifierAt(Bb,
Bb.cursorPosition);if(!xa||!xa.refs)return Na.show("No symbol identifier selected"),!0;var M=Bb.selection;xa=xa.refs.map(function(Ka){var $a=Ka.end;return Na.Range.fromPositions(Na.iToP(Bb,Ka.start),Na.iToP(Bb,$a))}).concat(xa.decl?Na.Range.fromPositions(Na.iToP(Bb,xa.decl.start),Na.iToP(Bb,xa.decl.end)):[]).sort(Na.Range.compare);if(!xa.length)return!0;var ha=xa.map(String).indexOf(String(M.range));if("next"===ba.direction||"prev"===ba.direction)-1===ha&&xa.length?xa=[xa[0]]:(ba=ha+("next"===ba.direction?
1:-1),0>ba?ba=xa.length-1:ba>=xa.length&&(ba=0),xa=[xa[ba]]);xa.forEach(function(Ka){var $a=M.selections.findIndex(function(Tc){return Tc.range.equals(Ka)}),$b=M.selections.length-1;-1<$a?Na.arr.swap(M.selections,$a,$b):M.addRange(Ka,!1)});M.mergeSelections();return!0}}];Na.astEditorCommands=Wa;Na.astEditorCommands=Wa;Na.astEditorCommands=Wa;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var Gb=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
Gb.expressionAllowed=function(Bb,ba,xa){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(ba.lastType)||"quasi"==ba.lastType&&/\{\s*$/.test(Bb.string.slice(0,Bb.pos-(xa||0)))};Gb.passIndent=qc;Gb.defineMode=od;Gb.defineMIME=Tb;Gb.registerHelper=wd;Gb.defaultConfig={indentUnit:2};Gb.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};Gb.defineMode("javascript",
function(Bb,ba){function xa(yb,zb,Dd){Mi=yb;Li=Dd;return zb}function M(yb,zb){var Dd=yb.next();if('"'==Dd||"'"==Dd)return zb.tokenize=ha(Dd),zb.tokenize(yb,zb);if("."==Dd&&yb.match(/^\d+(?:[eE][+\-]?\d+)?/))return xa("number","number");if("."==Dd&&yb.match(".."))return xa("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(Dd))return xa(Dd);if("="==Dd&&yb.eat(">"))return xa("=>","operator");if("0"==Dd&&yb.eat(/x/i))return yb.eatWhile(/[\da-f]/i),xa("number","number");if("0"==Dd&&yb.eat(/o/i))return yb.eatWhile(/[0-7]/i),
xa("number","number");if("0"==Dd&&yb.eat(/b/i))return yb.eatWhile(/[01]/i),xa("number","number");if(/\d/.test(Dd))return yb.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),xa("number","number");if("/"==Dd){if(yb.eat("*"))return zb.tokenize=Ka,Ka(yb,zb);if(yb.eat("/"))return yb.skipToEnd(),xa("comment","comment");if(Gb.expressionAllowed(yb,zb,1)){a:for(var Ad=zb=!1;null!=(Dd=yb.next());){if(!zb){if("/"==Dd&&!Ad)break a;"["==Dd?Ad=!0:Ad&&"]"==Dd&&(Ad=!1)}zb=!zb&&"\\"==Dd}yb.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return xa("regexp","string-2")}yb.eatWhile(al);return xa("operator","operator",yb.current())}if("`"==Dd)return zb.tokenize=$a,$a(yb,zb);if("#"==Dd)return yb.skipToEnd(),xa("error","error");if(al.test(Dd))return">"==Dd&&zb.lexical&&">"==zb.lexical.type||yb.eatWhile(al),xa("operator","operator",yb.current());if(rk.test(Dd))return yb.eatWhile(rk),yb=yb.current(),(Dd=$k.propertyIsEnumerable(yb)&&$k[yb])&&"."!=zb.lastType?xa(Dd.type,Dd.style,yb):xa("variable","variable",yb)}function ha(yb){return function(zb,
Dd){var Ad=!1,mf;if(zh&&"@"==zb.peek()&&zb.match(yj))return Dd.tokenize=M,xa("jsonld-keyword","meta");for(;null!=(mf=zb.next())&&(mf!=yb||Ad);)Ad=!Ad&&"\\"==mf;Ad||(Dd.tokenize=M);return xa("string","string")}}function Ka(yb,zb){for(var Dd=!1,Ad;Ad=yb.next();){if("/"==Ad&&Dd){zb.tokenize=M;break}Dd="*"==Ad}return xa("comment","comment")}function $a(yb,zb){for(var Dd=!1,Ad;null!=(Ad=yb.next());){if(!Dd&&("`"==Ad||"$"==Ad&&yb.eat("{"))){zb.tokenize=M;break}Dd=!Dd&&"\\"==Ad}return xa("quasi","string-2",
yb.current())}function $b(yb,zb){zb.fatArrowAt&&(zb.fatArrowAt=null);var Dd=yb.string.indexOf("=>",yb.start);if(!(0>Dd)){if(Ji){var Ad=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(yb.string.slice(yb.start,Dd));Ad&&(Dd=Ad.index)}Ad=0;var mf=!1;for(--Dd;0<=Dd;--Dd){var Kf=yb.string.charAt(Dd),Ki="([{}])".indexOf(Kf);if(0<=Ki&&3>Ki){if(!Ad){++Dd;break}if(0==--Ad){"("==Kf&&(mf=!0);break}}else if(3<=Ki&&6>Ki)++Ad;else if(rk.test(Kf))mf=!0;else{if(/["'\/]/.test(Kf))return;if(mf&&!Ad){++Dd;break}}}mf&&
!Ad&&(zb.fatArrowAt=Dd)}}function Tc(yb,zb,Dd,Ad,mf,Kf){this.indented=yb;this.column=zb;this.type=Dd;this.prev=mf;this.info=Kf;null!=Ad&&(this.align=Ad)}function Yb(){for(var yb=arguments.length-1;0<=yb;yb--)Pe.cc.push(arguments[yb])}function ub(){Yb.apply(null,arguments);return!0}function qd(yb){function zb(Ad){for(;Ad;Ad=Ad.next)if(Ad.name==yb)return!0;return!1}var Dd=Pe.state;Pe.marked="def";Dd.context?zb(Dd.localVars)||(Dd.localVars={name:yb,next:Dd.localVars}):!zb(Dd.globalVars)&&ba.globalVars&&
(Dd.globalVars={name:yb,next:Dd.globalVars})}function Uc(){Pe.state.context={prev:Pe.state.context,vars:Pe.state.localVars};Pe.state.localVars=Fm}function Ua(){Pe.state.localVars=Pe.state.context.vars;Pe.state.context=Pe.state.context.prev}function lb(yb,zb){var Dd=function(){var Ad=Pe.state,mf=Ad.indented;if("stat"==Ad.lexical.type)mf=Ad.lexical.indented;else for(var Kf=Ad.lexical;Kf&&")"==Kf.type&&Kf.align;Kf=Kf.prev)mf=Kf.indented;Ad.lexical=new Tc(mf,Pe.stream.column(),yb,null,Ad.lexical,zb)};
Dd.lex=!0;return Dd}function xc(){var yb=Pe.state;yb.lexical.prev&&(")"==yb.lexical.type&&(yb.indented=yb.lexical.indented),yb.lexical=yb.lexical.prev)}function ab(yb){function zb(Dd){return Dd==yb?ub():";"==yb?Yb():ub(zb)}return zb}function Dc(yb,zb){return"var"==yb?ub(lb("vardef",zb.length),Db,ab(";"),xc):"keyword a"==yb?ub(lb("form"),bb,Dc,xc):"keyword b"==yb?ub(lb("form"),Dc,xc):"{"==yb?ub(lb("}"),xd,xc):";"==yb?ub():"if"==yb?("else"==Pe.state.lexical.info&&Pe.state.cc[Pe.state.cc.length-1]==
xc&&Pe.state.cc.pop()(),ub(lb("form"),bb,Dc,xc,ua)):"function"==yb?ub(eb):"for"==yb?ub(lb("form"),Ga,Dc,xc):"variable"==yb?Ji&&"type"==zb?(Pe.marked="keyword",ub(Zd,ab("operator"),Zd,ab(";"))):ub(lb("stat"),H):"switch"==yb?ub(lb("form"),bb,ab("{"),lb("}","switch"),xd,xc,xc):"case"==yb?ub(Hc,ab(":")):"default"==yb?ub(ab(":")):"catch"==yb?ub(lb("form"),Uc,ab("("),dc,ab(")"),Dc,xc,Ua):"class"==yb?ub(lb("form"),Ec,xc):"export"==yb?ub(lb("stat"),of,xc):"import"==yb?ub(lb("stat"),we,xc):"module"==yb?ub(lb("form"),
Lf,ab("{"),lb("}"),xd,xc,xc):"async"==yb?ub(Dc):"@"==zb?ub(Hc,Dc):Yb(lb("stat"),Hc,ab(";"),xc)}function Hc(yb){return cb(yb,!1)}function Xa(yb){return cb(yb,!0)}function bb(yb){return"("!=yb?Yb():ub(lb(")"),Hc,ab(")"),xc)}function cb(yb,zb){if(Pe.state.fatArrowAt==Pe.stream.start){var Dd=zb?ka:Jd;if("("==yb)return ub(Uc,lb(")"),vc(Lf,")"),xc,ab("=>"),Dd,Ua);if("variable"==yb)return Yb(Uc,Lf,ab("=>"),Dd,Ua)}Dd=zb?hc:Ud;return hm.hasOwnProperty(yb)?ub(Dd):"function"==yb?ub(eb,Dd):"class"==yb?ub(lb("form"),
bc,xc):"keyword c"==yb||"async"==yb?ub(zb?sd:Sc):"("==yb?ub(lb(")"),Sc,ab(")"),xc,Dd):"operator"==yb||"spread"==yb?ub(zb?Xa:Hc):"["==yb?ub(lb("]"),zj,xc,Dd):"{"==yb?gd(Oa,"}",null,Dd):"quasi"==yb?Yb(Ed,Dd):"new"==yb?ub(Ra(zb)):ub()}function Sc(yb){return yb.match(/[;\}\)\],]/)?Yb():Yb(Hc)}function sd(yb){return yb.match(/[;\}\)\],]/)?Yb():Yb(Xa)}function Ud(yb,zb){return","==yb?ub(Hc):hc(yb,zb,!1)}function hc(yb,zb,Dd){var Ad=0==Dd?Ud:hc,mf=0==Dd?Hc:Xa;if("=>"==yb)return ub(Uc,Dd?ka:Jd,Ua);if("operator"==
yb)return/\+\+|--/.test(zb)?ub(Ad):"?"==zb?ub(Hc,ab(":"),mf):ub(mf);if("quasi"==yb)return Yb(Ed,Ad);if(";"!=yb){if("("==yb)return gd(Xa,")","call",Ad);if("."==yb)return ub(ea,Ad);if("["==yb)return ub(lb("]"),Sc,ab("]"),xc,Ad)}}function Ed(yb,zb){return"quasi"!=yb?Yb():"${"!=zb.slice(zb.length-2)?ub(Ed):ub(Hc,Ac)}function Ac(yb){if("}"==yb)return Pe.marked="string-2",Pe.state.tokenize=$a,ub(Ed)}function Jd(yb){$b(Pe.stream,Pe.state);return Yb("{"==yb?Dc:Hc)}function ka(yb){$b(Pe.stream,Pe.state);return Yb("{"==
yb?Dc:Xa)}function Ra(yb){return function(zb){return"."==zb?ub(yb?Ya:Ha):Yb(yb?Xa:Hc)}}function Ha(yb,zb){if("target"==zb)return Pe.marked="keyword",ub(Ud)}function Ya(yb,zb){if("target"==zb)return Pe.marked="keyword",ub(hc)}function H(yb){return":"==yb?ub(xc,Dc):Yb(Ud,ab(";"),xc)}function ea(yb){if("variable"==yb)return Pe.marked="property",ub()}function Oa(yb,zb){if("async"==yb)return Pe.marked="property",ub(Oa);if("variable"==yb||"keyword"==Pe.style)return Pe.marked="property","get"==zb||"set"==
zb?ub(sb):ub(Lb);if("number"==yb||"string"==yb)return Pe.marked=zh?"property":Pe.style+" property",ub(Lb);if("jsonld-keyword"==yb)return ub(Lb);if("modifier"==yb)return ub(Oa);if("["==yb)return ub(Hc,ab("]"),Lb);if("spread"==yb)return ub(Hc);if(":"==yb)return Yb(Lb)}function sb(yb){if("variable"!=yb)return Yb(Lb);Pe.marked="property";return ub(eb)}function Lb(yb){if(":"==yb)return ub(Xa);if("("==yb)return Yb(eb)}function vc(yb,zb,Dd){function Ad(mf,Kf){return(Dd?-1<Dd.indexOf(mf):","==mf)?(mf=Pe.state.lexical,
"call"==mf.info&&(mf.pos=(mf.pos||0)+1),ub(function(Ki,Bl){return Ki==zb||Bl==zb?Yb():Yb(yb)},Ad)):mf==zb||Kf==zb?ub():ub(ab(zb))}return function(mf,Kf){return mf==zb||Kf==zb?ub():Yb(yb,Ad)}}function gd(yb,zb,Dd){for(var Ad=3;Ad<arguments.length;Ad++)Pe.cc.push(arguments[Ad]);return ub(lb(zb,Dd),vc(yb,zb),xc)}function xd(yb){return"}"==yb?ub():Yb(Dc,xd)}function sc(yb,zb){if(Ji){if(":"==yb)return ub(Zd);if("?"==zb)return ub(sc)}}function Zd(yb){if("variable"==yb)return Pe.marked="variable-3",ub(Ke);
if("string"==yb||"number"==yb||"atom"==yb)return ub(Ke);if("{"==yb)return ub(lb("}"),vc(Wd,"}",",;"),xc);if("("==yb)return ub(vc(Ie,")"),he)}function he(yb){if("=>"==yb)return ub(Zd)}function Wd(yb,zb){if("variable"==yb||"keyword"==Pe.style)return Pe.marked="property",ub(Wd);if("?"==zb)return ub(Wd);if(":"==yb)return ub(Zd)}function Ie(yb){if("variable"==yb)return ub(Ie);if(":"==yb)return ub(Zd)}function Ke(yb,zb){if("<"==zb)return ub(lb(">"),vc(Zd,">"),xc,Ke);if("|"==zb||"."==yb)return ub(Zd);if("["==
yb)return ub(ab("]"),Ke);if("extends"==zb)return ub(Zd)}function Db(){return Yb(Lf,sc,tf,ie)}function Lf(yb,zb){if("modifier"==yb)return ub(Lf);if("variable"==yb)return qd(zb),ub();if("spread"==yb)return ub(Lf);if("["==yb)return gd(Lf,"]");if("{"==yb)return gd(xe,"}")}function xe(yb,zb){if("variable"==yb&&!Pe.stream.match(/^\s*:/,!1))return qd(zb),ub(tf);"variable"==yb&&(Pe.marked="property");return"spread"==yb?ub(Lf):"}"==yb?Yb():ub(ab(":"),Lf,tf)}function tf(yb,zb){if("="==zb)return ub(Xa)}function ie(yb){if(","==
yb)return ub(Db)}function ua(yb,zb){if("keyword b"==yb&&"else"==zb)return ub(lb("form","else"),Dc,xc)}function Ga(yb){if("("==yb)return ub(lb(")"),mb,ab(")"),xc)}function mb(yb){return"var"==yb?ub(Db,ab(";"),qa):";"==yb?ub(qa):"variable"==yb?ub(R):Yb(Hc,ab(";"),qa)}function R(yb,zb){return"in"==zb||"of"==zb?(Pe.marked="keyword",ub(Hc)):ub(Ud,qa)}function qa(yb,zb){return";"==yb?ub(Va):"in"==zb||"of"==zb?(Pe.marked="keyword",ub(Hc)):Yb(Hc,ab(";"),Va)}function Va(yb){")"!=yb&&ub(Hc)}function eb(yb,
zb){if("*"==zb)return Pe.marked="keyword",ub(eb);if("variable"==yb)return qd(zb),ub(eb);if("("==yb)return ub(Uc,lb(")"),vc(dc,")"),xc,sc,Dc,Ua);if(Ji&&"<"==zb)return ub(lb(">"),vc(Zd,">"),xc,eb)}function dc(yb){return"spread"==yb?ub(dc):Yb(Lf,sc,tf)}function bc(yb,zb){return"variable"==yb?Ec(yb,zb):Nc(yb,zb)}function Ec(yb,zb){if("variable"==yb)return qd(zb),ub(Nc)}function Nc(yb,zb){if("<"==zb)return ub(lb(">"),vc(Zd,">"),xc,Nc);if("extends"==zb||"implements"==zb||Ji&&","==yb)return ub(Ji?Zd:Hc,
Nc);if("{"==yb)return ub(lb("}"),yc,xc)}function yc(yb,zb){if("variable"==yb||"keyword"==Pe.style){if(("async"==zb||"static"==zb||"get"==zb||"set"==zb||Ji&&("public"==zb||"private"==zb||"protected"==zb||"readonly"==zb||"abstract"==zb))&&Pe.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Pe.marked="keyword",ub(yc);Pe.marked="property";return ub(Ji?ve:eb,yc)}if("["==yb)return ub(Hc,ab("]"),Ji?ve:eb,yc);if("*"==zb)return Pe.marked="keyword",ub(yc);if(";"==yb)return ub(yc);if("}"==yb)return ub();if("@"==
zb)return ub(Hc,yc)}function ve(yb,zb){return"?"==zb?ub(ve):":"==yb?ub(Zd,tf):"="==zb?ub(Xa):Yb(eb)}function of(yb,zb){return"*"==zb?(Pe.marked="keyword",ub(Tg,ab(";"))):"default"==zb?(Pe.marked="keyword",ub(Hc,ab(";"))):"{"==yb?ub(vc(af,"}"),Tg,ab(";")):Yb(Dc)}function af(yb,zb){if("as"==zb)return Pe.marked="keyword",ub(ab("variable"));if("variable"==yb)return Yb(Xa,af)}function we(yb){return"string"==yb?ub():Yb(eh,Dg,Tg)}function eh(yb,zb){if("{"==yb)return gd(eh,"}");"variable"==yb&&qd(zb);"*"==
zb&&(Pe.marked="keyword");return ub(pi)}function Dg(yb){if(","==yb)return ub(eh,Dg)}function pi(yb,zb){if("as"==zb)return Pe.marked="keyword",ub(eh)}function Tg(yb,zb){if("from"==zb)return Pe.marked="keyword",ub(Hc)}function zj(yb){return"]"==yb?ub():Yb(vc(Xa,"]"))}Bb=Object.assign({},Gb.defaultConfig,{},Bb);ba=Object.assign({},Gb.defaultParserConfig,{},ba);var wf=Bb.indentUnit,Ni=ba.statementIndent,zh=ba.jsonld,$i=ba.json||zh,Ji=ba.typescript,rk=ba.wordCharacters||/[\w$\xa1-\uffff]/,$k=function(){function yb(Bl){return{type:Bl,
style:"keyword"}}var zb=yb("keyword a"),Dd=yb("keyword b"),Ad=yb("keyword c"),mf=yb("operator"),Kf={type:"atom",style:"atom"};zb={if:yb("if"),while:zb,with:zb,else:Dd,do:Dd,try:Dd,finally:Dd,return:Ad,break:Ad,continue:Ad,new:yb("new"),delete:Ad,throw:Ad,debugger:Ad,var:yb("var"),const:yb("var"),let:yb("var"),function:yb("function"),catch:yb("catch"),for:yb("for"),switch:yb("switch"),case:yb("case"),default:yb("default"),in:mf,typeof:mf,instanceof:mf,true:Kf,false:Kf,null:Kf,undefined:Kf,NaN:Kf,Infinity:Kf,
this:yb("this"),class:yb("class"),super:yb("atom"),yield:Ad,export:yb("export"),import:yb("import"),extends:Ad,await:Ad,async:yb("async")};if(Ji){Dd={type:"variable",style:"variable-3"};Ad={interface:yb("class"),implements:Ad,namespace:Ad,module:yb("module"),enum:yb("module"),public:yb("modifier"),private:yb("modifier"),protected:yb("modifier"),abstract:yb("modifier"),as:mf,string:Dd,number:Dd,boolean:Dd,any:Dd};for(var Ki in Ad)zb[Ki]=Ad[Ki]}return zb}(),al=/[+\-*&%=<>!?|~^@]/,yj=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
Mi,Li,hm={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Pe={state:null,column:null,marked:null,cc:null},Fm={name:"this",next:{name:"arguments"}};xc.lex=!0;return{startState:function(yb){yb={tokenize:M,lastType:"sof",cc:[],lexical:new Tc((yb||0)-wf,0,"block",!1),localVars:ba.localVars,context:ba.localVars&&{vars:ba.localVars},indented:yb||0};ba.globalVars&&"object"===typeof ba.globalVars&&(yb.globalVars=ba.globalVars);return yb},token:function(yb,zb){yb.sol()&&(zb.lexical.hasOwnProperty("align")||
(zb.lexical.align=!1),zb.indented=yb.indentation(),$b(yb,zb));if(zb.tokenize!=Ka&&yb.eatSpace())return null;var Dd=zb.tokenize(yb,zb);if("comment"==Mi)return Dd;zb.lastType="operator"!=Mi||"++"!=Li&&"--"!=Li?Mi:"incdec";a:{var Ad=Mi,mf=Li,Kf=zb.cc;Pe.state=zb;Pe.stream=yb;Pe.marked=null;Pe.cc=Kf;Pe.style=Dd;zb.lexical.hasOwnProperty("align")||(zb.lexical.align=!0);for(yb=0;;){if(1E5<yb++)throw Error("endless");if((Kf.length?Kf.pop():$i?Hc:Dc)(Ad,mf)){for(;Kf.length&&Kf[Kf.length-1].lex;)Kf.pop()();
if(Pe.marked){Dd=Pe.marked;break a}if(Ad="variable"==Ad)b:{for(Ad=zb.localVars;Ad;Ad=Ad.next)if(Ad.name==mf){Ad=!0;break b}for(zb=zb.context;zb;zb=zb.prev)for(Ad=zb.vars;Ad;Ad=Ad.next)if(Ad.name==mf){Ad=!0;break b}Ad=void 0}if(Ad){Dd="variable-2";break a}break a}}}return Dd},indent:function(yb,zb){if(yb.tokenize==Ka)return Gb.passIndent;if(yb.tokenize!=M)return 0;var Dd=zb&&zb.charAt(0),Ad=yb.lexical,mf;if(!/^\s*else\b/.test(zb))for(var Kf=yb.cc.length-1;0<=Kf;--Kf){var Ki=yb.cc[Kf];if(Ki==xc)Ad=
Ad.prev;else if(Ki!=ua)break}for(;!("stat"!=Ad.type&&"form"!=Ad.type||"}"!=Dd&&(!(mf=yb.cc[yb.cc.length-1])||mf!=Ud&&mf!=hc||/^[,\.=+\-*:?[\(]/.test(zb)));)Ad=Ad.prev;Ni&&")"==Ad.type&&"stat"==Ad.prev.type&&(Ad=Ad.prev);mf=Ad.type;Kf=Dd==mf;return(Ki=yb._string)&&Ki.trimLeft().startsWith("?")&&":"===Dd?Ki.indexOf("?"):Ki&&":"===yb.lastType&&"}"!==Ad.type?Ki.match(/^\s*/)[0].length:"vardef"==mf?(zb=Ad.indented+Ad.info+2+yb.localVars.name.length,"?"===Dd||":"===Dd||"|"===Dd||"&"===Dd?zb:","==yb.lastType?
Ad.indented+Ad.info+1:"operator"==yb.lastType?zb+3:Ad.indented):"form"==mf&&"{"==Dd?Ad.indented:"form"==mf?Ad.indented+wf:"stat"==mf?(Dd=Ad.indented,yb="operator"==yb.lastType||","==yb.lastType||al.test(zb.charAt(0))||/[,.]/.test(zb.charAt(0)),Dd+(yb?Ni||wf:0)):"switch"!=Ad.info||Kf||0==ba.doubleIndentSwitch?Ad.align?Ad.column+(Kf?0:1):Ad.indented+(Kf?0:wf):Ad.indented+(/^(?:case|default)\b/.test(zb)?wf:2*wf)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:$i?null:"/*",blockCommentEnd:$i?
null:"*/",lineComment:$i?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:$i?"json":"javascript",jsonldMode:zh,jsonMode:$i,expressionAllowed:Gb.expressionAllowed,skipExpression:function(yb){var zb=yb.cc[yb.cc.length-1];zb!=Hc&&zb!=Xa||yb.cc.pop()}}});Gb.registerHelper("wordChars","javascript",/[\w$]/);Gb.defineMIME("text/javascript","javascript");Gb.defineMIME("text/ecmascript","javascript");Gb.defineMIME("application/javascript","javascript");Gb.defineMIME("application/x-javascript",
"javascript");Gb.defineMIME("application/ecmascript","javascript");Gb.defineMIME("application/json",{name:"javascript",json:!0});Gb.defineMIME("application/x-json",{name:"javascript",json:!0});Gb.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});Gb.defineMIME("text/typescript",{name:"javascript",typescript:!0});Gb.defineMIME("application/typescript",{name:"javascript",typescript:!0});var Rb=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");Rb.string=wc;Rb.JavaScriptChecker=
bd;Rb.JavaScriptNavigator=ad;Rb.completers=Aa;Rb.jsSnippets=wa;Rb.jsIdeCommands=La;Rb.jsEditorCommands=Ba;Rb.astEditorCommands=Wa;Rb.CodeMirrorEnabledEditorPlugin=Fd;Rb.Snippet=kb;Rb.parser=be;Rb.localInterface=fc;Rb.systemInterfaceNamed=ic;Rb.serverInterfaceFor=Ab;Rb.l2lInterfaceFor=jc;bd=function(Bb){var ba=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),xa=ba.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof ba.JavaScriptEditorPlugin?ba.JavaScriptEditorPlugin:ba.JavaScriptEditorPlugin=
function(M){M&&M[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return jb(xa,Bb,[{key:Symbol.for("lively-instance-initialize"),value:function(){jb._get(Object.getPrototypeOf(xa.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new Rb.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(M){jb._get(Object.getPrototypeOf(xa.prototype),"attach",this).call(this,M);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:M})}},{key:"detach",value:function(M){this.checker.uninstall(this.textMorph);jb._get(Object.getPrototypeOf(xa.prototype),"detach",this).call(this,M)}},{key:"getNavigator",value:function(){return new Rb.JavaScriptNavigator}},{key:"getCompleters",value:function(M){return Rb.completers.concat(M)}},
{key:"getCommands",value:function(M){return[].concat($jscomp.arrayFromIterable(jb._get(Object.getPrototypeOf(xa.prototype),"getCommands",this).call(this,M)),$jscomp.arrayFromIterable(Rb.jsIdeCommands),$jscomp.arrayFromIterable(Rb.jsEditorCommands),$jscomp.arrayFromIterable(Rb.astEditorCommands))}},{key:"getKeyBindings",value:function(M){return[].concat($jscomp.arrayFromIterable(M),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(M){var ha=this,Ka,$a,$b,Tc,Yb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ub){Ka=ha.textMorph;$a=[{command:"doit",target:Ka,showKeyShortcuts:!0},{command:"inspectit",target:Ka,showKeyShortcuts:!0},{command:"editit",target:Ka,showKeyShortcuts:!0},{command:"printit",target:Ka,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:Ka,showKeyShortcuts:!0},{command:"eval all",target:Ka,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:Ka,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:Ka,showKeyShortcuts:!0},{isDivider:!0}];ha.evalEnvironment.targetModule&&$a.push({command:"[javascript] inject import",alias:"add import",target:Ka},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:Ka},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:Ka});$b=ha.getNavigator();(Tc=$b.resolveIdentifierAt(Ka,
Ka.cursorPosition))&&$a.push({command:"selectDefinition",alias:'jump to definition of "'+Tc.name+'"',target:Ka},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+Tc.name+'"',target:Ka});(Yb=Ka.selection.text.trim())&&$a.push({command:"open code search",alias:'code search for "'+Rb.string.truncate(Yb,30)+'"',target:Ka.world(),args:{input:Yb,backend:ha.backend()}});$a.push({isDivider:!0});return ub.return($a.concat(M))})}},{key:"getSnippets",value:function(){return Rb.jsSnippets.map(function(M){var ha=
$jscomp.makeIterator(M);M=ha.next().value;ha=ha.next().value;return new Rb.Snippet({trigger:M,expansion:ha})})}},{key:"sanatizedJsEnv",value:function(M){M=Object.assign({},this.evalEnvironment,{},M);M.format||(M.formatd="esm");M.context||(M.context=this.textMorph);M.sourceURL||(M.sourceURL=M.targetModule+"_doit_"+Date.now());M.systemInterface||(M.systemInterface=Rb.localInterface);return M}},{key:"backend",value:function(M){M=this.sanatizedJsEnv(M);return M.remote?M.remote:"local"}},{key:"systemInterface",
value:function(M){return this.sanatizedJsEnv(M).systemInterface||Rb.localInterface}},{key:"setSystemInterface",value:function(M){return this.evalEnvironment.systemInterface=M}},{key:"setSystemInterfaceNamed",value:function(M){return this.setSystemInterface(Rb.systemInterfaceNamed(M))}},{key:"runEval",value:function(M,ha){ha=this.sanatizedJsEnv(ha);return this.systemInterface(ha).runEval(M,ha)}},{key:"parser",get:function(){return Rb.parser}},{key:"parse",value:function(M){M=void 0===M?null:M;if(this._ast&&
this._ast._astType===M)return this._ast;var ha=this.parser,Ka=this.textMorph.textString;if(!ha)return null;var $a={withComments:!0,allowReturnOutsideFunction:!0};M&&($a.type=M);if(Ka.startsWith("#!")){var $b=Ka.indexOf("\n");Ka=" ".repeat($b)+Ka.slice($b)}ha=ha.fuzzyParse(Ka,$a);ha._astType=M;return this._ast=ha}},{key:"undeclaredVariables",value:function(M){var ha=this.parser,Ka=this.evalEnvironment.knownGlobals||[];M=this.parse(void 0===M?null:M);return ha&&M?ha.query.findGlobalVarRefs(M,{jslintGlobalComment:!0}).filter(function($a){return!Ka.includes($a.name)}):
[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],ba,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(Rb.CodeMirrorEnabledEditorPlugin);bd=Rb.JavaScriptEditorPlugin;ra("default",bd);Rb.default=bd}}});
System.register(["./__root_module__-3d4e820f.js","kld-intersections","./index-da7fb446.js","./index-a37f4074.js"],function(){var ra,kb,zb,Sb,Mb,Fd,Jc,wd,Kc,Fc,Wc,hd,Id,nd,Xc;return{setters:[function(Na){ra=Na.aw;kb=Na.as;zb=Na.ai;Sb=Na.aD;Mb=Na.aB;Fd=Na.an;Jc=Na.Z;wd=Na.bO;Kc=Na.$;Fc=Na.a5;Wc=Na.s;hd=Na.a6;Id=Na.C;nd=Na.a3;Xc=Na.L},function(){},function(){},function(){}],execute:function(){var Na=lively.FreezerRuntime.recorderFor("StaticText/index.js");Na.HTMLMorph=ra;var nb=function(Wb){var Pc=
lively.FreezerRuntime.recorderFor("StaticText/index.js"),Bd=Pc.hasOwnProperty("StaticText")&&"function"===typeof Pc.StaticText?Pc.StaticText:Pc.StaticText=function(Hb){Hb&&Hb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return kb(Bd,Wb,[{key:"refresh",value:function(){this.html='<span style="line-height: 1.3; font-size: '+this.fontSize+"px; color: "+this.fontColor+"; font-family: "+this.fontFamily+'">'+this.value+"</span>"}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"StaticText"}},{key:"properties",get:function(){return{html:{isStyleProp:!1},fontSize:{type:"Number",set:function(Hb){this.setProperty("fontSize",Hb);this.refresh()}},fontColor:{type:"Color",set:function(Hb){this.setProperty("fontColor",Hb);this.refresh()}},fontFamily:{type:"Enum",set:function(Hb){this.setProperty("fontFamily",Hb);this.refresh()}},value:{set:function(Hb){this.setProperty("value",Hb);this.refresh()}}}}}],Pc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"StaticText",version:"0.1.1-10"}}},{start:74,end:953})}(Na.HTMLMorph);nb=Na.StaticText;Na.default=nb;var Pb=lively.FreezerRuntime.recorderFor("WorldVersionViewer/index.js");Pb.Morph=zb;Pb.World=Sb;Pb.HorizontalLayout=Mb;Pb.morph=Fd;Pb.MorphicDB=Jc;Pb.graph=wd;Pb.promise=Kc;Pb.date=Fc;Pb.string=Wc;Pb.arr=hd;Pb.Color=Id;Pb.pt=nd;Pb.LoadingIndicator=Xc;(function(Wb){var Pc=lively.FreezerRuntime.recorderFor("WorldVersionViewer/index.js"),
Bd=Pc.hasOwnProperty("WorldVersion")&&"function"===typeof Pc.WorldVersion?Pc.WorldVersion:Pc.WorldVersion=function(Hb){Hb&&Hb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return kb(Bd,Wb,[{key:"update",value:function(){var Hb=$jscomp.makeIterator(this.submorphs),Ub=Hb.next().value;Hb=Hb.next().value;Ub.imageUrl=this.commit.preview;Hb.textAndAttributes=this.info;Hb.fontColor=this.selected?Pb.Color.white:Pb.Color.darkGray}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"WorldVersion"}},{key:"properties",get:function(){return{commit:{},fill:{defaultValue:Pb.Color.transparent},info:{derived:!0,get:function(){var Hb=this.commit,Ub=Hb.message,vb=Hb.name,kc=Hb.timestamp;return[Hb._id.slice(0,6)+" ",{fontWeight:"bold"},Pb.string.truncate(Ub.split("\n")[0],40)+" ",{}," ("+vb+" ",{},""+Pb.date.format(new Date(kc),"yyyy-mm-dd HH:MM Z"),{}]}},selected:{set:function(Hb){this.setProperty("selected",Hb);this.update()}},layout:{initialize:function(){this.layout=
new Pb.HorizontalLayout({align:"center",spacing:5})}},submorphs:{initialize:function(){this.submorphs=[{type:"image",extent:Pb.pt(30,30),name:"preview",reactsToPointer:!1},{reactsToPointer:!1,type:"label",fill:null,name:"commit info",fontFamily:"Nunito",fontColor:Pb.Color.gray}]}}}}}],Pc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldVersionViewer",
version:"0.1.1-33"}}},{start:274,end:1824})})(Pb.Morph);Na=function(Wb){var Pc=lively.FreezerRuntime.recorderFor("WorldVersionViewer/index.js"),Bd=Pc.hasOwnProperty("WorldVersionViewer")&&"function"===typeof Pc.WorldVersionViewer?Pc.WorldVersionViewer:Pc.WorldVersionViewer=function(Hb){Hb&&Hb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return kb(Bd,Wb,[{key:"reset",value:function(){this.getSubmorphNamed("version list").items=[]}},
{key:"onMouseDown",value:function(Hb){switch(Hb.targetMorph.name){case "visit button":this.visitSelectedCommit();break;case "revert button":this.revertToSelectedCommit()}}},{key:"visitSelectedCommit",value:function(){var Hb=this,Ub,vb,kc,xc,Dc,Gb,$a,dc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oc){switch(oc.nextAddress){case 1:return Ub=Hb.get("version list").selection,vb=Pb.LoadingIndicator.open("Loading "+Ub.name+"..."),kc=$world,xc=Hb.db||Pb.MorphicDB.default,Dc=Ub._id,oc.setCatchFinallyBlocks(2,
3),Dc?oc.yield(Pb.World.loadFromCommit(Dc,void 0,{morphicDB:xc}),8):oc.yield(Pb.World.loadFromDB(Ub.name,Ub.ref,void 0,{morphicDB:xc}),7);case 7:Gb=oc.yieldResult;oc.jumpTo(6);break;case 8:Gb=oc.yieldResult;case 6:return $a=Gb,oc.return($a);case 3:oc.enterFinallyBlock();vb.remove();oc.leaveFinallyBlock(0);break;case 2:dc=oc.enterCatchBlock(),console.error(dc),kc.showError("Error loading world:"+dc),oc.jumpTo(3)}})}},{key:"revertToSelectedCommit",value:function(){var Hb=this,Ub,vb,kc,xc,Dc,Gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function($a){if(1==
$a.nextAddress){Ub=Hb.get("version list").selection;if(!Ub)return $a.return();vb=Hb.db||Pb.MorphicDB.default;kc=Ub;xc=kc._id;Dc=kc.name;Gb=kc.type;return $a.yield(vb.revert(Gb,Dc,xc,"HEAD"),2)}return $a.return(Hb.initializeFromStartCommit(Ub,vb,{showRevertButton:!0}))})}},{key:"initializeFromStartCommit",value:function(Hb,Ub,vb){Ub=void 0===Ub?Pb.MorphicDB.default:Ub;vb=void 0===vb?{}:vb;var kc=this,xc,Dc,Gb,$a,dc,oc,sa,Ca,bb,rb,qb,Sa,Ta,sb,Zb,rc,Xb,wc,I,T,ua,Da,Kb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){switch(Db.nextAddress){case 1:return xc=
vb,Dc=void 0===xc.showRefs?!0:xc.showRefs,Gb=kc.startCommit=Hb,$a=Gb._id,dc=Gb.type,oc=Gb.name,sa=kc.getSubmorphNamed("version list spinner"),sa.visible=!0,sa.center=kc.get("version list").center,kc.db=Ub,Db.yield(Ub.history(dc,oc),2);case 2:Ca=Db.yieldResult,bb=Ca.refs,rb=Ca.history,qb=$a,Sa=Pb.graph.invert(rb),Ta=Pb.graph.hull(Sa,$a),sb={_id:!0},Zb=[Hb],rc=$jscomp.makeIterator(Ta),Xb=rc.next();case 3:if(Xb.done)return T=Pb.arr.max(Zb,function(Fa){return Fa.timestamp}),qb=T._id,Db.yield(Ub.log(qb,
void 0,!0),7);wc=Xb.value;return Db.yield(Ub.log(wc,void 0,!0,sb),6);case 6:I=Db.yieldResult;Zb.push.apply(Zb,$jscomp.arrayFromIterable(I));I.forEach(function(Fa){return sb[Fa._id]=!0});Xb=rc.next();Db.jumpTo(3);break;case 7:ua=Db.yieldResult;if(Dc)for(Da in bb);Kb=ua.map(function(Fa){var ac=new Pb.WorldVersion({reactsToPointer:!1,commit:Fa});ac.update();return{isListItem:!0,morph:ac,value:Fa}});kc.get("version list").items=Kb;sa.visible=!1;Db.jumpToEnd()}})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"WorldVersionViewer"}}],Pc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldVersionViewer",version:"0.1.1-33"}}},{start:1841,end:5600})}(Pb.Morph);Na=Pb.WorldVersionViewer;Pb.default=Na}}});
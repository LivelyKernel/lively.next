System.register(["./__root_module__-7d3cbdeb.js","./index-f2f18556.js","./index-00525174.js"],function(Ka){var wb,Ab,gc,Kb,Zc,Kc,md,Fc,Bc,Nc,Uc,ce,Zd,pe,Mc,Kd,Jb,Dc,nd,Hc,wd,Qd,Eb,ic,jd,jc,kd,vb,db,ec,Mb,Hb,pc,Ma,Ib,pb,Ub,dc,vc,gd,Nb,Fb,sb;return{setters:[function(Ea){wb=Ea.C;Ab=Ea.i;gc=Ea.a;Kb=Ea.R;Zc=Ea.b;Kc=Ea.m;md=Ea.bo;Fc=Ea.bp;Bc=Ea.c;Nc=Ea.s;Uc=Ea.ar;ce=Ea.bx;Zd=Ea.by;pe=Ea.Y;Mc=Ea.o;Kd=Ea.ac;Jb=Ea.d;Dc=Ea.bz;nd=Ea.bA;Hc=Ea.$;wd=Ea.P;Qd=Ea.p;Eb=Ea._;ic=Ea.M;jd=Ea.T;jc=Ea.aa;kd=Ea.af;vb=
Ea.O;db=Ea.I;ec=Ea.g;Mb=Ea.bB;Hb=Ea.q;pc=Ea.bC;Ma=Ea.aC;Ib=Ea.bq;pb=Ea.aB;Ub=Ea.bD;dc=Ea.f},function(Ea){vc=Ea.M;gd=Ea.I;Nb=Ea.v;Fb=Ea.p},function(Ea){sb=Ea.localInterface}],execute:function(){function Ea(Fa,Wa){if(!0===Wa)return Wa;if(Fa.copyState)return Fa.copyState(Wa);Fa={};for(var Gb in Wa){var pa=Wa[Gb];pa instanceof Array&&(pa=pa.concat([]));Fa[Gb]=pa}return Fa}function ua(Fa,Wa,Gb){return Fa.startState?Fa.startState(Wa,Gb):!0}function V(Fa,Wa){return mc.modes[Fa]=Wa}function ra(Fa){if("string"===
typeof Fa&&mc.mimeModes.hasOwnProperty(Fa))Fa=mc.mimeModes[Fa];else if(Fa&&"string"===typeof Fa.name&&mc.mimeModes.hasOwnProperty(Fa.name)){var Wa=mc.mimeModes[Fa.name];"string"===typeof Wa&&(Wa={name:Wa});Fa=Object.assign({},Wa,Fa);Fa.name=Wa.name}else{if("string"===typeof Fa&&/^[\w\-]+\/[\w\-]+\+xml$/.test(Fa))return ra("application/xml");if("string"===typeof Fa&&/^[\w\-]+\/[\w\-]+\+json$/.test(Fa))return ra("application/json")}return"string"===typeof Fa?{name:Fa}:Fa||{name:"null"}}function ja(Fa,
Wa){Wa=mc.resolveMode(Wa);"string"===typeof Wa&&(Wa={name:Wa});if(!Wa.name)throw Error("parserConfig does not have a name of the mode to get");var Gb=mc.modes[Wa.name];if(!Gb)return ja(Fa,"text/plain");Fa=Object.assign({indentUnit:2},Fa);return Object.assign(Gb(Fa,Wa),{name:Wa.name})}function Ca(Fa,Wa){for(var Gb;Fa.innerMode;){Gb=Fa.innerMode(Wa);if(!Gb||Gb.mode==Fa)break;Wa=Gb.state;Fa=Gb.mode}return Gb||{mode:Fa,state:Wa}}function va(Fa,Wa){mc.mimeModes[Fa]=Wa}function cb(Fa,Wa,Gb){}function hc(Fa,
Wa,Gb,pa,xa,Ha,S){var ob=Fa.editorPlugin._tokenizerValidBefore;ob&&ob.row>=Gb&&(ob.row=Gb-1);var fa=mc.linesToTokenize(Fa.document,Gb,pa,ob);ob=fa.lines;fa=fa.state;if(!ob.length)return!1;fa=fa?mc.copyState(Wa,fa):mc.startState(Wa);for(var Ba=0;Ba<ob.length;Ba++){var Na=ob[Ba],tb=Na.row;tb>=Gb&&tb<=pa&&mc.indentLine(Fa,Wa,Na,fa,xa,Ha,S);fa=mc.tokenizeLine(Wa,ob[Ba],fa,function(){})}return!0}function gb(Fa,Wa,Gb,pa,xa,Ha,S){Wa=mc.linesToTokenize(Wa,Gb,pa,xa);Gb=Wa.lines;mc.tokenizeLines(Fa,Gb,Wa.state,
Ha,S);return Gb}function Oc(Fa,Wa,Gb,pa,xa){var Ha=[],S,ob=function(Na){return Ha.push(S=[])},fa=function(Na,tb,Sb,lc,uc,rc,$c){return S.push(Sb,lc,Na,uc.current(),tb.localMode||$c)};try{var Ba=mc.visitDocumentTokens(Fa,Wa,Gb,pa,xa,ob,fa)}catch(Na){Ha.length=0,Ba=mc.visitDocumentTokens(Fa,Wa,Gb,pa,null,ob,fa)}return{tokens:Ha,lines:Ba}}function Cb(Fa,Wa,Gb,pa,xa){null==Wa&&(Wa=Fa.search(/[^\s\u00a0]/),-1==Wa&&(Wa=Fa.length));pa=pa||0;for(xa=xa||0;;){var Ha=Fa.indexOf("\t",pa);if(0>Ha||Ha>=Wa)return xa+
(Wa-pa);xa+=Ha-pa;xa+=Gb-xa%Gb;pa=Ha+1}}function Gd(Fa){Fa=Fa.toLowerCase();for(var Wa=0;Wa<mc.modeInfo.length;Wa++){var Gb=mc.modeInfo[Wa];if(Gb.mime==Fa)return Gb;if(Gb.mimes)for(var pa=0;pa<Gb.mimes.length;pa++)if(Gb.mimes[pa]==Fa)return Gb}if(/\+xml$/.test(Fa))return Gd("application/xml");if(/\+json$/.test(Fa))return Gd("application/json")}function Ec(Fa){for(var Wa=0;Wa<mc.modeInfo.length;Wa++){var Gb=mc.modeInfo[Wa];if(Gb.ext)for(var pa=0;pa<Gb.ext.length;pa++)if(Gb.ext[pa]==Fa)return Gb}}function oc(Fa){for(var Wa=
0;Wa<mc.modeInfo.length;Wa++){var Gb=mc.modeInfo[Wa];if(Gb.file&&Gb.file.test(Fa))return Gb}Wa=Fa.lastIndexOf(".");if(Fa=-1<Wa&&Fa.substring(Wa+1,Fa.length))return mc.findModeByExtension(Fa)}function rb(Fa){Fa=Fa.toLowerCase();for(var Wa=0;Wa<mc.modeInfo.length;Wa++){var Gb=mc.modeInfo[Wa];if(Gb.name.toLowerCase()==Fa)return Gb;if(Gb.alias)for(var pa=0;pa<Gb.alias.length;pa++)if(Gb.alias[pa].toLowerCase()==Fa)return Gb}}function Md(Fa){if(!Fa)return String(Fa);if(Array.isArray(Fa))return"["+Fa.map(Md).join(",")+
"]";if("symbol"===typeof Fa)return Od.printSymbol(Fa);try{return String(Fa)}catch(Wa){return"Cannot print object: "+Wa}}function yb(Fa,Wa){return!Od.arr.every(Wa.map(function(Gb){return Fa[Gb]}),function(Gb){return Od.obj.equals(Gb,Fa&&Fa.valueOf())})}function qb(Fa){if(Od.obj.isPrimitive(Fa))var Wa=Od.string.print(Fa);else Array.isArray(Fa)?((Wa=3<Fa.length)&&(Fa=Fa.slice(0,3)),Fa=Od.string.print(Fa),Wa&&(Fa=Fa.slice(0,-1)+", ...]"),Wa=Fa):Wa=Od.string.print(Fa);Wa=Wa.replace(/\n/g,"");500<Wa.length&&
(Wa=Wa.slice(0,20)+("...["+(Wa.length-20)+' CHARS]"'));return Wa}function Ia(Fa){return Wb.Inspector.openInWindow({targetObject:Fa})}function Q(Fa,Wa){return Wb.Inspector.openInWindow({remoteTarget:{code:Fa,evalEnvironment:Wa}})}function za(Fa,Wa){function Gb(ob){var fa=ob.name,Ba=ob.ownerChain(),Na=ob.owner,tb=ob.world(),Sb;ob===Ha&&(Sb=[S]);tb===ob&&(Sb=["$world"]);if(!Sb&&fa&&Na){Na===tb&&1===Wb.arr.count(Wb.arr.pluck(tb.submorphs,"name"),fa)&&(Sb=['$world.get("'+fa+'")']);if(!Sb&&Na!=tb)for(tb=
Ba.length-1;tb--;)if(1===Ba[tb].getAllNamed(fa).length){Sb=[].concat($jscomp.arrayFromIterable(Gb(Ba[tb])),['get("'+fa+'")']);break}Sb||(fa=[].concat($jscomp.arrayFromIterable(Gb(Na)),['get("'+fa+'")']),Wb.syncEval(fa.join("."),{context:Ha}).value===ob&&(Sb=fa))}Sb||(Sb=[S+'.getMorphById("'+ob.id+'")']);return Sb}Wa=void 0===Wa?{}:Wa;var pa=Fa.world(),xa=Wa;Wa=void 0===xa.maxLength?10:xa.maxLength;var Ha=void 0===xa.fromMorph?pa:xa.fromMorph;if(Ha===Fa)return"this";var S=pa===Ha?"$world":"this";if(!(pa||
Fa.name&&Ha.get(Fa.name)===Fa))return"morph";pa=Gb(Fa);return pa.length>Wa?'$world.getMorphWithId("'+Fa.id+'")':pa.join(".")}function Ta(Fa,Wa,Gb){var pa=(Wa=void 0===Wa?"":Wa)&&$d.arr.last(Wa.split(".")).toLowerCase(),xa="",Ha=0,S=Math.pow(2,19);if("string"===typeof Fa){if(Fa.length>S)return null}else if(Fa.document.stringSize>S)return null;if("string"===typeof Fa)xa=Fa.slice(0,1E3);else for(Fa=$jscomp.makeIterator(Fa.document.lines),S=Fa.next();!S.done;S=Fa.next()){var ob=S.value;S=ob.stringSize;
ob=ob.text;var fa=!0;1E3<Ha+S&&(fa=!1,S=1E3-Ha);xa+=ob.slice(0,S)+(fa?"\n":"");Ha+=S;if(1E3<=Ha)break}Ha=$jscomp.makeIterator($d.modeInfo);for(Fa=Ha.next();!Fa.done;Fa=Ha.next()){fa=Fa.value;S=fa.contentTest;Fa=fa.mode;ob=fa.ext;fa=fa.file;if("function"===typeof S)try{if(S(xa))return Fa}catch(Ba){}if(fa&&fa instanceof RegExp&&fa.test(Wa))return Fa;if(ob)for(S=$jscomp.makeIterator(ob),ob=S.next();!ob.done;ob=S.next())if(ob.value===pa)return Fa}return Gb}Ka({a:va,d:V,r:cb});var xb=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");
xb.Color=wb;var Yb=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),Gb=Wa.hasOwnProperty("DefaultTheme")&&"function"===typeof Wa.DefaultTheme?Wa.DefaultTheme:Wa.DefaultTheme=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:"background",get:function(){return xb.Color.white}},{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",
fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},
{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},
{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},
{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},
{key:"diff-file-header",get:function(){return{fontColor:xb.Color.white,fontWeight:"bold",backgroundColor:xb.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:xb.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:xb.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Wa,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Ac=Yb=xb.DefaultTheme;xb.default=Yb;var mc=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");
mc.copyState=Ea;mc.startState=ua;mc.defineMode=V;mc.resolveMode=ra;mc.getMode=ja;mc.innerMode=Ca;mc.defineMIME=va;mc.registerHelper=cb;mc.indentLines=hc;mc.indentLine=function(Fa,Wa,Gb,pa,xa,Ha,S){S=Object.assign({indentWithTabs:!Fa.useSoftTabs,indentUnit:Fa.tabWidth,tabSize:4,ignoreFollowingText:!1},S);null==xa&&(xa="add");"smart"==xa&&(Wa.indent||(xa="prev"));var ob=S.tabSize,fa=Gb.text,Ba=mc.countColumn(fa,null,ob);Gb.modeState&&(Gb.modeState=null);var Na=fa.match(/^\s*/)[0];if(!Ha&&!/\S/.test(fa)){var tb=
0;xa="not"}else if("smart"==xa&&(tb=Wa.indent(pa,S.ignoreFollowingText?"":fa.slice(Na.length),fa),tb==mc.passIndent||150<tb)){if(!Ha)return;xa="prev"}"prev"==xa?tb=0<Gb.row?mc.countColumn(Gb.prevLine().text,null,ob):0:"add"==xa?tb=Ba+S.indentUnit:"subtract"==xa?tb=Ba-S.indentUnit:"number"===typeof xa&&(tb=Ba+xa);tb=Math.max(0,tb);Wa="";pa=0;if(S.indentWithTabs)for(S=Math.floor(tb/ob);S;--S)pa+=ob,Wa+="\t";pa<tb&&(Wa+=" ".repeat(tb-pa));if(Wa!=Na)return Fa.replace({start:{row:Gb.row,column:0},end:{row:Gb.row,
column:Na.length}},Wa),!0};mc.tokenizeLines=function(Fa,Wa,Gb,pa,xa){if(Wa.length){Gb=Gb?mc.copyState(Fa,Gb):mc.startState(Fa);for(var Ha=0;Ha<Wa.length;Ha++){var S=Wa[Ha];pa(S);Gb=mc.tokenizeLine(Fa,S,Gb,xa)}}};mc.tokenizeLine=function(Fa,Wa,Gb,pa){var xa=Wa.text;if(!xa)return Gb;var Ha=new mc.StringStream(xa,2);Gb=Wa.modeState="function"===typeof Fa.copyState?Fa.copyState(Gb):mc.copyState(Fa,Gb);Wa.prevLine();for(Gb._string=xa;!Ha.eol();)xa=Fa.token(Ha,Gb),pa(xa,Gb,Ha.start,Ha.pos,Ha,Wa,Fa),Ha.start=
Ha.pos;return Gb};mc.printTokens=function(Fa){for(var Wa="",Gb=0;Gb<Fa.length;Gb+=5)Wa+=Fa[Gb+0]+" => "+Fa[Gb+1]+" "+Fa[Gb+2]+" "+Fa[Gb+3]+" "+Fa[Gb+4].name+"\n";return Wa};mc.visitDocumentTokens=gb;mc.tokenizeDocument=Oc;mc.linesToTokenize=function(Fa,Wa,Gb,pa){if(pa&&pa.row>=Gb)return{lines:[],state:null};Wa=pa?Math.max(0,pa.row-1):Wa;var xa=Fa.getLine(Wa),Ha=xa.text;Fa=[xa];pa=null;for(var S=0,ob;(ob=xa.prevLine())&&50>S++;){xa=ob;if(xa.modeState){pa=xa.modeState;break}Fa.unshift(xa)}if(!pa){for(var fa=
xa,Ba=Infinity;(ob=xa.prevLine())&&100>S++;){xa=ob;if(xa.modeState){pa=xa.modeState;break}Fa.unshift(xa);ob=Ha.match(/^\s*/)[0].length;if(0===ob)break;ob<Ba&&(Ba=ob,fa=xa)}!pa&&0<Ba&&(Fa=Fa.slice(Fa.indexOf(fa)))}if(Gb>Wa)for(xa=mc.arr.last(Fa);Wa<=Gb;Wa++){xa=xa.nextLine();if(!xa)break;Fa.push(xa)}return{lines:Fa,state:pa}};mc.countColumn=Cb;mc.findModeByMIME=Gd;mc.findModeByExtension=Ec;mc.findModeByFileName=oc;mc.findModeByName=rb;mc.arr=gc;Yb=mc.modes||{};mc.modes=Yb;mc.modes=Yb;mc.modes=Yb;Yb=
Ka("p",{});mc.passIndent=Yb;mc.passIndent=Yb;mc.passIndent=Yb;mc.copyState=Ea;mc.copyState=Ea;mc.startState=ua;mc.startState=ua;mc.defineMode=V;mc.defineMode=V;mc.resolveMode=ra;mc.resolveMode=ra;mc.getMode=ja;mc.getMode=ja;mc.innerMode=Ca;mc.innerMode=Ca;Yb={};mc.mimeModes=Yb;mc.mimeModes=Yb;mc.mimeModes=Yb;mc.defineMIME=va;mc.defineMIME=va;mc.registerHelper=cb;mc.registerHelper=cb;mc.indentLines=hc;mc.indentLines=hc;mc.visitDocumentTokens=gb;mc.visitDocumentTokens=gb;mc.tokenizeDocument=Oc;mc.tokenizeDocument=
Oc;mc.countColumn=Cb;mc.countColumn=Cb;(function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),Gb=Wa.hasOwnProperty("StringStream")&&"function"===typeof Wa.StringStream?Wa.StringStream:Wa.StringStream=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:Symbol.for("lively-instance-initialize"),value:function(pa,xa){this.reset(pa,xa)}},{key:"reset",value:function(pa,xa){this.pos=
this.start=0;this.string=void 0===pa?"":pa;this.tabSize=void 0===xa?2:xa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(pa){var xa=this.string.charAt(this.pos);
if("string"===typeof pa?xa==pa:xa&&(pa.test?pa.test(xa):pa(xa)))return++this.pos,xa}},{key:"eatWhile",value:function(pa){for(var xa=this.pos;this.eat(pa););return this.pos>xa}},{key:"eatSpace",value:function(){for(var pa=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>pa}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(pa){pa=this.string.indexOf(pa,this.pos);if(-1<pa)return this.pos=pa,!0}},{key:"backUp",value:function(pa){this.pos-=
pa}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=mc.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?mc.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return mc.countColumn(this.string,null,this.tabSize)-(this.lineStart?mc.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(pa,
xa,Ha){if("string"===typeof pa){var S=function(fa){return Ha?fa.toLowerCase():fa},ob=this.string.substr(this.pos,pa.length);if(S(ob)==S(pa))return!1!==xa&&(this.pos+=pa.length),!0}else{if((pa=this.string.slice(this.pos).match(pa))&&0<pa.index)return null;pa&&!1!==xa&&(this.pos+=pa[0].length);return pa}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(pa,xa){this.lineStart+=pa;try{return xa()}finally{this.lineStart-=pa}}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"StringStream"}}],Wa,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10526,end:13053})})(void 0);Yb=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",
ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",
mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",
mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",
mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(Fa){return Fa.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",
mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",
mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",
file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",
ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],
alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},
{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",
mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",
mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",
ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",
mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",
ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",
mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(Fa){return Fa.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},
{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",
mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",
mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",
mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",
mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",
mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];mc.modeInfo=Yb;mc.modeInfo=Yb;mc.modeInfo=Yb;for(var qd=0;qd<mc.modeInfo.length;qd++)mc.info=mc.modeInfo[qd],mc.info.mimes&&(mc.info.mime=mc.info.mimes[0]);mc.defineMode("null",function(){return{token:function(Fa){return Fa.skipToEnd()}}});mc.defineMIME("text/plain","null");
mc.findModeByMIME=Gd;mc.findModeByMIME=Gd;mc.findModeByExtension=Ec;mc.findModeByExtension=Ec;mc.findModeByFileName=oc;mc.findModeByFileName=oc;mc.findModeByName=rb;mc.findModeByName=rb;var zd=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");zd.Color=wb;zd.Rectangle=Kb;zd.pt=Zc;zd.morph=Kc;zd.ShadowObject=md;zd.StyleSheet=Fc;zd.connect=Bc;zd.arr=gc;zd.string=Nc;zd.FilterableList=Uc;zd.Range=ce;qd=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
Gb=Wa.hasOwnProperty("Completer")&&"function"===typeof Wa.Completer?Wa.Completer:Wa.Completer=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],Wa,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);zd.Completer=qd;zd.Completer=qd;zd.Completer=qd;qd=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Gb=Wa.hasOwnProperty("WordCompleter")&&"function"===typeof Wa.WordCompleter?Wa.WordCompleter:Wa.WordCompleter=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:"compute",
value:function(pa,xa){var Ha=[],S=[],ob=pa.document.lineStrings;pa=pa.cursorPosition.row;for(var fa=pa-1;0<=fa;fa--)for(var Ba=$jscomp.makeIterator(ob[fa].split(/[^0-9a-z@_]+/i)),Na=Ba.next();!Na.done;Na=Ba.next())(Na=Na.value)&&!Ha.includes(Na)&&Na!==xa&&(Ha.push(Na),S.push({priority:1E3-(pa-fa),completion:Na}));for(fa=pa+1;fa<ob.length;fa++)for(Ba=$jscomp.makeIterator(ob[fa].split(/[^0-9a-z_@]+/i)),Na=Ba.next();!Na.done;Na=Ba.next())(Na=Na.value)&&!Ha.includes(Na)&&Na!==xa&&(Ha.push(Na),S.push({priority:1E3-
(fa-pa),completion:Na}));return S}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Wa,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);zd.WordCompleter=qd;zd.WordCompleter=qd;zd.WordCompleter=qd;qd=[new zd.WordCompleter];zd.defaultCompleters=
qd;zd.defaultCompleters=qd;zd.defaultCompleters=qd;qd=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),Gb=Wa.hasOwnProperty("CompletionController")&&"function"===typeof Wa.CompletionController?Wa.CompletionController:Wa.CompletionController=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:Symbol.for("lively-instance-initialize"),value:function(pa,xa){xa=void 0===
xa?[]:xa;this.textMorph=pa;this.completers=xa=pa.pluginCollect("getCompleters",xa)}},{key:"computeCompletions",value:function(pa){var xa=this,Ha,S,ob,fa,Ba,Na,tb,Sb,lc,uc,rc,$c,Jd,je,td,qe;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wd){switch(Wd.nextAddress){case 1:Ha=[],S=$jscomp.makeIterator(xa.completers),ob=S.next();case 2:if(ob.done){Wd.jumpTo(4);break}fa=ob.value;Wd.setCatchFinallyBlocks(5);Ba=Ha;Na=Ba.concat;return Wd.yield(fa.compute(xa.textMorph,pa),7);case 7:Ha=Na.call(Ba,
Wd.yieldResult);Wd.leaveTryBlock(3);break;case 5:tb=Wd.enterCatchBlock(),console.warn("Error in completer "+fa+": "+(tb.stack||tb));case 3:ob=S.next();Wd.jumpTo(2);break;case 4:Sb=new Map;Ha.forEach(function(Ud){var Re=Sb.get(Ud.completion);Re||(Re=[],Sb.set(Ud.completion,Re));Re.push(Ud)});lc=[];uc=$jscomp.makeIterator(Sb.values());for(rc=uc.next();!rc.done;rc=uc.next())$c=rc.value,lc.push(zd.arr.last(zd.arr.sortByKey($c,"priority")));Jd=0;je=zd.arr.sortByKey(lc,"priority").reverse();td=je.length&&
je[0].priority||0;qe=je.map(function(Ud){Ud.highestPriority=td;var Re=Ud.completion.replace(/\n/g,""),wf=String((Ud.info||"").replace(/\n/g,""));Jd=Math.max(Jd,Re.length+wf.length);return{isListItem:!0,string:Re,annotation:wf,value:Ud}});return Wd.return({items:qe,maxCol:Jd})}})}},{key:"computeSortedCompletions",value:function(pa,xa){xa=void 0===xa?!1:xa;var Ha=this,S,ob,fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ba){if(1==Ba.nextAddress)return S={tokens:[pa],lowercasedTokens:[pa],
input:pa},Ba.yield(Ha.computeCompletions(pa),2);ob=Ba.yieldResult;fa=zd.arr.sortBy(ob.items.filter(function(Na){return Ha.filterFunction(S,Na,xa)}),function(Na){return Ha.sortFunction(S,Na)});return Ba.return(fa)})}},{key:"_printCompletions",value:function(pa){var xa=this,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(S){if(1==S.nextAddress)return S.yield(xa.computeSortedCompletions(pa),2);Ha=S.yieldResult.map(function(ob){return{completion:ob.value.completion,priority:ob.value.priority,
maxP:ob.value.highestPriority,sortVal:ob._cache[pa].sortVal,lev:JSON.stringify(ob._cache[pa].levenshtein)}});return S.return(zd.string.printTable(lively.lang.grid.tableFromObjects(Ha)))})}},{key:"prefix",value:function(){var pa=this.textMorph,xa=pa.selection;return(xa.isEmpty()?pa.getLine(xa.lead.row).slice(0,xa.lead.column):xa.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(pa,xa,Ha){Ha=void 0===Ha?!1:Ha;xa._cache||(xa._cache={});var S=pa.tokens,ob=pa.lowercasedTokens,fa=pa.input;
fa=xa._cache[fa]||(xa._cache[fa]={});if(fa.hasOwnProperty("filtered"))return fa.filtered;xa=xa.value.completion.replace(/\([^\)]*\)$/,"");var Ba=xa.toLowerCase();if(Ha&&S[0]&&!xa.startsWith(S[0]))return fa.filtered=!1;if(ob.every(function(tb){return Ba.includes(tb)}))return!0;var Na=fa.levenshtein||(fa.levenshtein={});pa=Ha||3>=zd.arr.sum(pa.lowercasedTokens.map(function(tb){return Na[tb]||(Na[tb]=zd.string.levenshtein(Ba,tb))}));return fa.filtered=pa}},{key:"sortFunction",value:function(pa,xa){xa._cache||
(xa._cache={});var Ha=xa._cache[pa.input]||(xa._cache[pa.input]={});if(Ha.hasOwnProperty("sortVal"))return Ha.sortVal;Ha=xa._cache[pa.input]={};var S=xa.value;xa=S.highestPriority;var ob=S.completion;S=S.priority;ob=ob.replace(/\([^\)]*\)$/,"").toLowerCase();var fa=0;pa.lowercasedTokens.forEach(function(Na){ob.startsWith(Na)?fa+=12:3<=Na.length&&ob.includes(Na)&&(fa+=5)});xa=-((S||(fa?xa:0))/Math.pow(10,String(xa).length-2))-fa;var Ba=Ha.levenshtein||(Ha.levenshtein={});pa=zd.arr.sum(pa.lowercasedTokens.map(function(Na){return Ba[Na]||
(Ba[Na]=zd.string.levenshtein(ob,Na))}));fa&&(pa/=2);return Ha.sortVal=pa+xa}},{key:"positionForMenu",value:function(){var pa=this.textMorph,xa=pa.charBoundsFromTextPosition(pa.cursorPosition);return pa.getGlobalTransform().transformRectToRect(xa).topLeft().addXY(-pa.scroll.x,-pa.scroll.y).addPt(zd.pt(pa.borderWidth+4,pa.borderWidth+4))}},{key:"completionListSpec",value:function(){var pa=this,xa,Ha,S,ob,fa,Ba,Na,tb,Sb,lc,uc,rc,$c,Jd,je,td,qe,Wd,Ud,Re;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wf){if(1==
wf.nextAddress)return Ha=xa=pa.textMorph,S=Ha.fontSize,ob=Ha.fontFamily,fa=pa.positionForMenu(),Ba=pa.prefix(),wf.yield(pa.computeCompletions(Ba),2);Na=wf.yieldResult;tb=Na.items;Sb=Na.maxCol;lc=xa.env.fontMetric.sizeFor(ob,S,"M");uc=lc.width*Sb;rc=xa.document.getLine(0).height;$c=Math.max(120,uc<xa.width?uc:xa.width);Jd=rc*tb.length+rc+10;je=Math.max(70,Math.min(700,Jd));td=fa.extent(zd.pt($c,je));if(qe=xa.world())Wd=qe.visibleBounds().insetBy(5),td.bottom()>Wd.bottom()&&(Ud=td.bottom()-Wd.bottom(),
Ud>td.height-50&&(Ud=td.height-50),td.height-=Ud),td.right()>Wd.right()&&(Re=td.right()-Wd.right(),td.width=120>td.width-Re?120:td.width-Re),Wd.containsRect(td)||(td=td.withTopLeft(Wd.translateForInclusion(td).topLeft())),td=td.translatedBy(Wd.insetBy(0).topLeft().negated());return wf.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},hasFixedPosition:!0,epiMorph:!0,fontSize:S,position:td.topLeft(),extent:td.extent(),items:tb,input:Ba,name:"text completion menu",historyId:"lively.morphic-text completion",
filterFunction:pa.filterFunction,sortFunction:pa.sortFunction})})}},{key:"removeMenuOnBlur",value:function(pa){var xa=pa.menu;setTimeout(function(){xa.withAllSubmorphsDetect(function(Ha){return Ha.isFocused()})?xa.inputMorph.focus():xa.remove()})}},{key:"openCompletionList",value:function(){var pa=this,xa,Ha,S,ob,fa,Ba,Na,tb,Sb,lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(uc){if(1==uc.nextAddress)return xa=pa.textMorph.selection.start,uc.yield(pa.completionListSpec(),2);if(3!=uc.nextAddress)return Ha=
uc.yieldResult,pa.textMorph.pluginFind(function(rc){return rc.theme}),S=new zd.FilterableList(Ha),ob=new zd.Range({start:xa,end:pa.textMorph.selection.start}),fa=pa.textMorph.textInRange(ob),Ba=S.inputMorph,Na=S.listMorph,tb=Ha.input,Sb=S.addMorph({name:"prefix mask",fill:zd.Color.transparent,bounds:Ba.textBounds()},Ba),Na.master=null,ob.isEmpty()||(pa.textMorph.deleteText(ob),Ba.input=fa,Ba.gotoDocumentEnd()),Ba.fontColor=pa.textMorph.fontColor,zd.connect(Ba,"textString",Sb,"setBounds",{converter:"() => input.textBounds()",
varMapping:{input:Ba}}),zd.connect(S,"accepted",pa,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:tb}}),zd.connect(S,"accepted",S,"remove"),zd.connect(S,"canceled",S,"remove"),zd.connect(S,"remove",pa.textMorph,"focus"),zd.connect(S.inputMorph,"onBlur",pa,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:S}}),lc=pa.textMorph.world(),Na.addStyleClass("hiddenScrollbar"),S.paddingMorph.height=2,Ba.height=Na.itemHeight,Ba.clipMode="visible",Ba.fill=pa.textMorph.fill,Ba.fixedHeight=!0,Ba.fixedWidth=!1,Ba.fontSize=Na.fontSize,S.relayout(),S.selectedIndex=0,S.master.applyIfNeeded(!0),
Ba.focus(),uc.yield(S.master.whenApplied(),3);tb.length&&(Ba.gotoDocumentEnd(),S.moveBy(zd.pt(-Ba.textBounds().width,0)));lc.addMorph(S);S.inputPadding=zd.Rectangle.inset(0,0,0,0);return uc.return(S)})}},{key:"autoInsertBestMatchingCompletion",value:function(pa,xa,Ha){xa=void 0===xa?!0:xa;var S=this,ob,fa,Ba,Na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress)return ob=$jscomp,fa=ob.makeIterator,tb.yield(S.computeSortedCompletions(pa,xa),2);Ba=fa.call(ob,tb.yieldResult);
(Na=Ba.next().value)&&S.insertCompletion(Na.value.completion,pa,Ha);tb.jumpToEnd()})}},{key:"insertCompletion",value:function(pa,xa,Ha){var S=this.textMorph,ob=S.document,fa=S.selection.isMultiSelection?S.selection.selections:[S.selection];S.undoManager.group();fa.forEach(function(Ba){Ba.collapseToEnd();var Na=Ba.lead,tb=xa?ob.indexToPosition(ob.positionToIndex(Na)-xa.length):Na;"function"===typeof Ha?Ha(pa,xa,S,{start:tb,end:Na},Ba):S.replace({start:tb,end:Na},pa)});S.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"CompletionController"}}],Wa,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13044})}(void 0);zd.CompletionController=qd;zd.CompletionController=qd;zd.CompletionController=qd;qd=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(Fa,
Wa,Gb){var pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){return 1==xa.nextAddress?(pa=new zd.CompletionController(Fa,zd.defaultCompleters),xa.yield(pa.openCompletionList(),2)):xa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(Fa,Wa,Gb){var pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){return 1==xa.nextAddress?(pa=new zd.CompletionController(Fa,zd.defaultCompleters),xa.yield(pa.autoInsertBestMatchingCompletion(pa.prefix()),
2)):xa.return(!0)})}}];zd.completionCommands=qd;zd.completionCommands=qd;zd.completionCommands=qd;var Ee=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Ee.chain=Zd;Ee.arr=gc;Ee.obj=pe;Ee.string=Nc;var se=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(Fa){var Wa=Fa.selection.start;0<Wa.row&&(Wa=Fa.getPositionAboveOrBelow(1,Wa,!0,0,Fa.charBoundsFromTextPosition(Wa).x),Fa.selection.addRange({start:Wa,end:Wa}));return!0}},{name:"[multi select] add cursor below",
multiSelectAction:"single",exec:function(Fa){var Wa=Fa.selection.start;Wa.row<Fa.documentEndPosition.row&&(Wa=Fa.getPositionAboveOrBelow(-1,Wa,!0,0,Fa.charBoundsFromTextPosition(Wa).x),Fa.selection.addRange({start:Wa,end:Wa}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(Fa){var Wa=Fa.selection.selections[Fa.selection.selections.length-1];if(Wa.isEmpty())return!0;Fa.searchForAll(Wa.text,{start:{column:0,row:0}}).forEach(function(Gb){return Fa.selection.addRange(Gb.range,
!1)});Fa.selection.mergeSelections();Ee.arr.remove(Fa.selection.selections,Wa);Fa.selection.selections.push(Wa);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(Fa){var Wa=Fa.selection.selections.length-1,Gb=Fa.selection.selections[Wa];if(Gb.isEmpty())return!0;var pa=Fa.search(Gb.text,{start:Gb.end,backwards:!1});pa&&(Gb=Fa.selection.selections.findIndex(function(xa){return xa.range.equals(pa.range)}),-1<Gb?Ee.arr.swap(Fa.selection.selections,Gb,Wa):
Fa.selection.addRange(pa.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(Fa){var Wa=Fa.selection.selections.length-1,Gb=Fa.selection.selections[Wa];if(Gb.isEmpty())return!0;var pa=Gb.start,xa=Fa.search(Gb.text,{start:{row:pa.row,column:pa.column-(Gb.text.length-1)},backwards:!0});xa&&(Gb=Fa.selection.selections.findIndex(function(Ha){return Ha.range.equals(xa.range)}),-1<Gb?Ee.arr.swap(Fa.selection.selections,Gb,Wa):Fa.selection.addRange(xa.range));
return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(Fa){var Wa=Fa.selection.selections.length;1<Wa&&Fa.selection.removeSelections(Wa-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(Fa){Fa.selection.selections=lively.lang.arr.rotate(Fa.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(Fa){Fa.selection.selections=lively.lang.arr.rotate(Fa.selection.selections,
1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(Fa){var Wa=Fa.selection.selections;if(1>=Wa.length)return!0;var Gb=Ee.arr.groupBy(Wa,function(xa){return xa.range.start.row});Wa=Gb.keys().map(function(xa){xa=Gb[xa];var Ha=Ee.arr.max(xa,function(S){return S.range.start.column});Ee.arr.without(xa,Ha).forEach(function(S){return S.range=Ha.range});return Ha});var pa=Ee.arr.max(Wa,function(xa){return xa.range.start.column}).range.start.column;Wa.forEach(function(xa){var Ha=
xa.range.start;xa=Ha.row;Ha=Ha.column;Fa.insertText(" ".repeat(pa-Ha),{row:xa,column:Ha})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(Fa){Fa.selection.disableMultiSelect();if(Fa.selection.isEmpty())var Wa=Fa.lastSavedMark&&Fa.lastSavedMark.position||(void 0).lineRange().start,Gb=Fa.cursorPosition;else Wa=Fa.selection,Gb=Wa.lead,Wa=Wa.anchor;Fa.selection.collapse();var pa=Wa.column,xa=Gb.column;Ee.arr.range(Wa.row,Gb.row).forEach(function(Ha){return Fa.getLine(Ha).length>
Math.min(xa,pa)&&Fa.selection.addRange({end:{row:Ha,column:xa},start:{row:Ha,column:pa}},!1)});Fa.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(Fa,Wa,Gb){Gb=void 0===Gb?1:Gb;Fa.undoManager.group();Fa.selection.selections.forEach(function(pa,xa){return pa.text=String(xa+Gb)});Fa.undoManager.group();return!0}}];Ee.multiSelectCommands=se;Ee.multiSelectCommands=se;Ee.multiSelectCommands=se;var ke=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");
ke.pToI=function(Fa,Wa){return Fa.positionToIndex(Wa)};ke.iToP=function(Fa,Wa){return Fa.indexToPosition(Wa)};ke.execCodeNavigator=function(Fa){return function(Wa,Gb,pa){var xa=Wa.pluginInvokeFirst("getNavigator");if(!xa)return!0;Wa.saveMark();pa=pa||1;for(var Ha=0;Ha<pa;Ha++)xa[Fa](Wa,Gb);return!0}};ke.once=Mc;var w=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:ke.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",
exec:ke.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:ke.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:ke.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:ke.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",
bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(Fa,Wa){function Gb(){var Ha=Fa.$expandRegionState,S=ke.pToI(Fa,Fa.cursorPosition);if(Ha&&(Ha.range[0]===S||Ha.range[1]===S))return Ha;Ha=Fa.selection.range;return Fa.$expandRegionState={range:[ke.pToI(Fa,Ha.start),ke.pToI(Fa,Ha.end)]}}Wa=Wa||{};var pa=Fa.pluginInvokeFirst("getNavigator");if(!pa)return!0;var xa=Wa.start;Wa=Wa.end;if("number"===typeof xa&&"number"===typeof Wa)Gb(),pa={range:[xa,Wa],
prev:Gb()};else{xa=pa.ensureAST(Fa);if(!xa)return;pa=pa.expandRegion(Fa,Fa.textString,xa,Gb())}pa&&pa.range&&(Fa.selection={start:ke.iToP(Fa,pa.range[0]),end:ke.iToP(Fa,pa.range[1])},Fa.$expandRegionState=pa);ke.once(Fa,"selectionChange",function(){return Fa.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(Fa){if(Fa.selection.isEmpty())return!0;
var Wa=Fa.pluginInvokeFirst("getNavigator");if(!Wa)return!0;var Gb=Wa.ensureAST(Fa);if(!Gb)return!0;var pa=Fa.$expandRegionState;if(!pa)return!0;(Wa=Wa.contractRegion(Fa,Fa.textString,Gb,pa))&&Wa.range&&(Fa.selection={start:ke.iToP(Fa,Wa.range[0]),end:ke.iToP(Fa,Wa.range[1])},Fa.$expandRegionState=Wa);ke.once(Fa,"selectionChange",function(){return Fa.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];ke.commands=w;ke.commands=w;ke.commands=w;var we=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");
we.arr=gc;we.chain=Zd;we.string=Nc;var ue=[{name:"toggle comment",exec:function(Fa){var Wa=Fa.pluginInvokeFirst("getComment");if(!Wa)return!0;if(!Wa.lineCommentStart)return Wa.blockCommentStart?Fa.execCommand("toggle block comment"):!0;var Gb=Wa.lineCommentStart,pa=new RegExp("^(\\s*)("+Gb+"\\s?)(.*)");Wa=Fa.document;var xa=Fa.selection;xa.isEmpty()||0!==xa.end.column||xa.growRight(-1);var Ha=xa.start.row;Wa=Wa.lineStrings.slice(xa.start.row,xa.end.row+1);Wa=Wa.some(function(fa){return!!fa.trim()})?
we.arr.dropWhile(Wa,function(fa){return fa.trim()?!1:++Ha&&!0}):Wa;var S=Wa.every(function(fa){return fa.trim()&&fa.match(pa)});Fa.undoManager.group();if(S)Wa.forEach(function(fa,Ba){if(fa=fa.match(pa)){fa=$jscomp.makeIterator(fa);fa.next();var Na=fa.next().value,tb=fa.next().value;fa.next();Fa.deleteText({start:{row:Ha+Ba,column:Na.length},end:{row:Ha+Ba,column:Na.length+tb.length}})}});else{var ob=Wa.reduce(function(fa,Ba,Na){return Ba.trim()||xa.isEmpty()&&xa.start.row===xa.end.row?Math.min(fa,
Ba.match(/^\s*/)[0].length):fa},Infinity);ob=Infinity===ob?0:ob;Wa.forEach(function(fa,Ba){fa=$jscomp.makeIterator(fa.match(/^(\s*)(.*)/));fa.next();fa.next();fa.next();Fa.insertText(Gb+" ",{row:Ha+Ba,column:ob})})}Fa.undoManager.group();return!0}},{name:"toggle block comment",exec:function(Fa){var Wa=Fa.pluginInvokeFirst("getComment");if(!Wa)return!0;if(!Wa.blockCommentStart)return Wa.lineCommentStart?Fa.execCommand("toggle comment"):!0;if(!Wa||!Wa.blockCommentStart)return!0;var Gb=Wa.blockCommentStart;
Wa=Wa.blockCommentEnd;var pa=new RegExp("^"+Gb.replace(/\*/g,"\\*")),xa=new RegExp(Wa.replace(/\*/g,"\\*")+"$"),Ha=Fa.tokenAt(Fa.cursorPosition);if(Ha&&"comment"===Ha.token){var S=Fa.textInRange(Ha);if(S.match(pa)&&S.match(xa))return Fa.undoManager.group(),Fa.replace(Ha,S.slice(Gb.length,-Wa.length)),Fa.undoManager.group(),!0}Fa.undoManager.group();Fa.insertText(Gb,Fa.selection.start);Fa.insertText(Wa,Fa.selection.end);Fa.undoManager.group();Gb=!Fa.selection.isEmpty();Fa.selection.growLeft(Wa.length);
Gb||Fa.selection.collapse();return!0}},{name:"comment box",exec:function(Fa,Wa,Gb){Wa=Fa.undoManager.ensureNewGroup(Fa,"comment box");if(Fa.selection.isEmpty())return Fa.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),Fa.execCommand("toggle comment"),Fa.undoManager.group(Wa),!0;var pa=Fa.selection.range,xa=Fa.withSelectedLinesDo(function(S){return S}),Ha=we.arr.min([pa.start.column].concat(we.chain(xa).map(function(S){return S.match(/^\s*/)}).flatten().compact().pluck("length").value()));
xa=we.arr.max(xa.map(function(S){return S.length}))-Ha;xa=Array(Math.ceil(xa/2)+1).join("-=")+"-";Fa.execCommand("toggle comment");Fa.collapseSelection();Fa.cursorPosition={row:pa.start.row,column:0};Gb?Fa.insertText(we.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",Ha)):Fa.insertText(we.string.indent(xa+"\n"," ",Ha));Fa.selection.goUp();Fa.execCommand("toggle comment");Fa.cursorPosition={row:pa.end.row+2,column:0};Fa.insertText(we.string.indent(xa+"\n"," ",Ha));Fa.selection.goUp();
Fa.execCommand("toggle comment");Fa.selection.range={start:{row:pa.start.row,column:0},end:Fa.cursorPosition};Fa.undoManager.group(Wa);return!0},multiSelectAction:"forEach",handlesCount:!0}];we.commands=ue;we.commands=ue;we.commands=ue;var Od=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");Od.printSymbol=function(Fa){if(Symbol.keyFor(Fa))return'Symbol.for("'+Symbol.keyFor(Fa)+'")';if(Od.knownSymbols.get(Fa))return Od.knownSymbols.get(Fa);String(Fa).match(Od.symMatcher);return String(Fa)};
Od.defaultSort=function(Fa,Wa){if(Fa.hasOwnProperty("priority")||Wa.hasOwnProperty("priority")){var Gb=Fa.priority||0,pa=Wa.priority||0;if(Gb<pa)return-1;if(Gb>pa)return 1}Fa=(Fa.keyString||Fa.key).toLowerCase();Wa=(Wa.keyString||Wa.key).toLowerCase();return Fa<Wa?-1:Fa===Wa?0:1};Od.safeToString=Md;Od.propertyNamesOf=function(Fa,Wa){if(!Fa)return[];if(Array.isArray(Fa)){var Gb=Wa?Wa.offset:0;return Od.arr.range(Gb,Gb+(Wa?Wa.partitionSize:Fa.length-1))}return Od.arr.sortBy(Object.keys(Fa),function(pa){return pa.toLowerCase()})};
Od.isMultiValue=yb;Od.printValue=qb;Od.partitionedChildren=function(Fa,Wa){var Gb=void 0===Wa?{}:Wa;Wa=void 0===Gb.originalValue?Fa:Gb.originalValue;var pa=void 0===Gb.offset?0:Gb.offset;Gb=void 0===Gb.partitionSize?Fa.length||Object.values(Fa).length:Gb.partitionSize;if(Od.obj.isArray(Fa)){Fa=Od.num.roundTo(Math.max(Od.MIN_PARTITION_SIZE,Gb/50),.1);Gb/=Fa;for(var xa=[],Ha=0;Ha<Gb;Ha++){var S="["+(pa+Ha*Fa)+"-"+(pa+(Ha+1)*Fa)+"]";xa.push({partition:{originalValue:Wa,offset:pa+Ha*Fa,partitionSize:Fa},
value:[],key:S,keyString:S,valueString:"...",isCollapsed:!0})}return xa}Fa=Od.num.roundTo(Math.max(Od.MIN_PARTITION_SIZE,Gb/50),.1);Gb/=Fa;xa=[];Ha=Od.obj.keys(Wa).sort();for(S=0;S<Gb;S++){var ob=pa+S*Fa,fa=pa+(S+1)*Fa,Ba=Od.obj.select(Wa,Ha.slice(ob,fa));ob="["+Ha[ob].slice(0,4)+"-"+(Ha[fa]||Od.arr.last(Ha)).slice(0,4)+"]";xa.push({partition:{originalValue:Ba,offset:pa+S*Fa,partitionSize:Fa},value:[],key:ob,keyString:ob,valueString:"...",isCollapsed:!0})}return xa};Od.propertiesOf=function(Fa){var Wa=
Fa.partition?Fa.target:Fa.value;if(!Wa)return[];var Gb={_rev:!0},pa=[],xa="function"===typeof Wa.livelyCustomInspect?Wa.livelyCustomInspect():{},Ha=Object.assign({},Od.defaultPropertyOptions,{},xa);if(xa.properties){xa=$jscomp.makeIterator(xa.properties);for(var S=xa.next();!S.done;S=xa.next()){var ob=S.value;S=ob.key;var fa=ob.hidden,Ba=ob.priority,Na=ob.keyString,tb=ob.value;ob=ob.valueString;Gb[S]=!0;fa||pa.push(Fa.getSubNode({priority:Ba,key:S,keyString:Na||Od.safeToString(S),value:tb,valueString:ob,
isCollapsed:!0}))}}if(Ha.includeDefault){xa=Od.propertyNamesOf(Wa,Fa.partition);if(xa.length>Od.MAX_NODE_THRESHOLD)for(Gb=$jscomp.makeIterator(Od.partitionedChildren(Wa,Fa.partition)),xa=Gb.next();!xa.done;xa=Gb.next())pa.push(Fa.getSubNode(xa.value));else for(fa=$jscomp.makeIterator(xa),xa=fa.next();!xa.done;xa=fa.next())Ba=xa.value,Ba in Gb||(xa=Wa[Ba],S=Od.printValue(xa),xa={keyString:Ba,key:Ba,value:xa,valueString:S,isCollapsed:!0},pa.push(Fa.getSubNode(xa)));if(Ha.includeSymbols)for(Gb=$jscomp.makeIterator(Object.getOwnPropertySymbols(Wa)),
xa=Gb.next();!xa.done;xa=Gb.next())fa=xa.value,Ba=Od.safeToString(fa),xa=Wa[fa],S=Od.printValue(xa),xa={key:fa,keyString:Ba,value:xa,valueString:S,isCollapsed:!0},pa.push(Fa.getSubNode(xa))}Ha.sort&&(pa=Ha.sortFunction(Wa,pa));return pa};Od.obj=pe;Od.num=Kd;Od.arr=gc;Od.string=Nc;Od.connect=Bc;Od.signal=Jb;Od.TreeData=Dc;Od.newUUID=nd;Od.localInterface=sb;Od.MAX_NODE_THRESHOLD=1E3;Od.MIN_PARTITION_SIZE=250;Od.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(Fa,
Wa){return Array.isArray(Fa)?Wa:Wa.sort(Od.defaultSort)}};Od.symMatcher=/^Symbol\((.*)\)$/;Od.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(Fa){return"symbol"===typeof Symbol[Fa]}).reduce(function(Fa,Wa){return Fa.set(Symbol[Wa],"Symbol."+Wa)},new Map)}();Od.isMultiValue=yb;Od.isMultiValue=yb;Od.printValue=qb;Od.printValue=qb;var He=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Gb=Wa.hasOwnProperty("InspectionTree")&&
"function"===typeof Wa.InspectionTree?Wa.InspectionTree:Wa.InspectionTree=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:Symbol.for("lively-instance-initialize"),value:function(pa){Ab._get(Object.getPrototypeOf(Gb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,pa);this.inspector=pa.inspector;this.root.isInspectionNode||(this.root=Od.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",
get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(pa){pa=void 0===pa?!0:pa;return Ab._get(Object.getPrototypeOf(Gb.prototype),"asListWithIndexAndDepth",this).call(this,function(xa){xa=xa.node;return pa?xa.visible:!0})}},{key:"getContextFor",value:function(pa){return pa==this.root?this.root.value.inspectee:pa.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(pa){var xa=void 0===pa.maxDepth?1:pa.maxDepth,Ha=pa.iterator,S=pa.showUnknown,ob=pa.showInternal,
fa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ba){if(1==Ba.nextAddress)return Ba.yield(fa.uncollapseAll(function(Na,tb){return xa>tb&&(Na==fa.root||Na.value.submorphs)}),2);fa.asListWithIndexAndDepth(!1).forEach(function(Na){var tb=Na.node;return 0==Na.depth?tb.visible=!0:!S&&tb.keyString&&tb.keyString.includes("UNKNOWN PROPERTY")||!ob&&tb.keyString&&tb.keyString.includes("internal")?tb.visible=!1:tb.value&&tb.value.submorphs?tb.visible=!0:tb.visible=Ha(tb)});Ba.jumpToEnd()})}},
{key:"getChildren",value:function(pa){return pa.children}},{key:"display",value:function(pa){return pa.display(this.inspector)}},{key:"isCollapsed",value:function(pa){return pa.isCollapsed}},{key:"isLeaf",value:function(pa){return Od.obj.isPrimitive(pa.value)}},{key:"collapse",value:function(pa,xa){var Ha=this;pa.isCollapsed=xa;xa||this.isLeaf(pa)||pa.children.length||(pa.children=Od.propertiesOf(pa).map(function(S){Ha.parentMap.set(S,pa);return S}))}},{key:"retrieveForRemoteProxy",value:function(pa){pa.uuid||
(pa.uuid=Od.newUUID(),this.idToNodeMap[pa.uuid]=pa);return{uuid:pa.uuid,value:this.isLeaf(pa)?pa.value:{},keyString:pa.keyString,key:pa.keyString,valueString:Od.safeToString(pa.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Od.localInterface}},{key:"getNodeViaId",value:function(pa){return this.idToNodeMap[pa]}},{key:"asRemoteDelegate",value:function(pa){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext=
{});System.get("@lively-env").remoteInspectionContext[pa]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionTree"}},{key:"forObject",value:function(pa,xa){return new this({key:"inspectee",value:{inspectee:pa},isCollapsed:!0,inspector:xa})}}],Wa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(Od.TreeData);Od.InspectionTree=He;Od.InspectionTree=He;Od.InspectionTree=He;var Te=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Gb=Wa.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Wa.RemoteInspectionTree?Wa.RemoteInspectionTree:Wa.RemoteInspectionTree=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Ab(Gb,Fa,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(pa){this.parentMap=new WeakMap;this.root=pa.proxy;this.evalEnvironment=pa.evalEnvironment;this.inspector=pa.inspector;this.delegateId=pa.delegateId}},{key:"getContextFor",value:function(pa){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+pa.uuid+'").value'}},{key:"dispose",value:function(){var pa=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){return xa.yield(pa.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+pa.delegateId+"']\n    ",pa.evalEnvironment),0)})}},{key:"display",value:function(pa){return pa.keyString+": "+pa.valueString}},{key:"collapse",value:function(pa,xa){var Ha=this,S;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){if(1==ob.nextAddress)return(pa.isCollapsed=xa)||Ha.isLeaf(pa)?
ob.return():pa.children.length?ob.jumpTo(0):ob.yield(Ha.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+pa.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Ha.delegateId+'"]'}),3);S=ob.yieldResult;pa.children=S.isError?
[]:S.value;ob.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(pa,xa){var Ha=this,S,ob,fa,Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Na){if(1==Na.nextAddress)return Na.yield(Ha.createRemoteContext(pa,xa),2);S=Na.yieldResult;ob=S.proxy;fa=S.delegateId;Ba=S.evalEnvironment;return Na.return(new Ha({key:"inspectee",proxy:ob,delegateId:fa,evalEnvironment:Ba,inspector:xa}))})}},{key:"createRemoteContext",
value:function(pa,xa){var Ha=pa.code,S=pa.evalEnvironment,ob=pa.delegateId,fa,Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Na){if(1==Na.nextAddress)return ob="lively://inspector-"+xa.id,Na.yield(S.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+Ha+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+ob+'");\n    ',S),2);fa=Na.yieldResult;Ba=fa.value;
return Na.return({delegateId:ob,evalEnvironment:S,proxy:Ba})})}}],Wa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(Od.InspectionTree);Od.RemoteInspectionTree=Te;Od.RemoteInspectionTree=Te;Od.RemoteInspectionTree=Te;(function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Gb=Wa.hasOwnProperty("InspectionNode")&&"function"===typeof Wa.InspectionNode?Wa.InspectionNode:Wa.InspectionNode=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:Symbol.for("lively-instance-initialize"),value:function(pa){var xa=pa.root,Ha=pa.priority,S=pa.key,ob=pa.keyString,fa=pa.value,Ba=pa.valueString,Na=pa.isCollapsed,tb=void 0===pa.children?[]:pa.children,Sb=void 0===pa.isSelected?!1:pa.isSelected,
lc=void 0===pa.visible?!0:pa.visible;this.partition=pa.partition;this.priority=Ha;this.key=S;this.keyString=String(ob||S);this.value=fa;this.valueString=Ba||Od.printValue(fa);this.isCollapsed=Na;this.children=tb;this.isSelected=Sb;this.visible=lc;this.root=xa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",get:function(){return!0}},{key:"getSubNode",value:function(pa){if(pa.value&&pa.value.isMorph)return new Od.MorphNode(Object.assign({root:this.root},pa));var xa=pa.key,
Ha=pa.keyString,S=this.value,ob=pa.partition;ob&&(S=ob.originalValue,Ha=xa);return new Od.PropertyNode(Object.assign({},pa,{keyString:Ha,key:xa,target:S,partition:ob,root:this.root,spec:{}}))}},{key:"display",value:function(pa){var xa=this.keyString,Ha=this.valueString;if(!this.interactive)return xa+": "+Ha;this._propertyWidget||(this._propertyWidget=pa.renderDraggableTreeLabel({value:xa+": "+Ha}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionNode"}},{key:"for",value:function(pa,xa){xa=void 0===xa?null:xa;return pa.value&&pa.value.isMorph?new Od.MorphNode(Object.assign({root:xa},pa)):new Od.InspectionNode(Object.assign({root:xa},pa))}}],Wa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,
end:13612})})(void 0);(function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Gb=Wa.hasOwnProperty("MorphNode")&&"function"===typeof Wa.MorphNode?Wa.MorphNode:Wa.MorphNode=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:Symbol.for("lively-instance-initialize"),value:function(pa){Ab._get(Object.getPrototypeOf(Gb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,pa);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(pa){var xa=this.propertyInfo[pa.key]||{};return pa.value&&pa.value.isMorph?new Od.MorphNode(Object.assign({},pa,{root:this.root})):new Od.PropertyNode(Object.assign({},pa,{root:this.root,target:this.target,spec:xa}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],Wa,{pathInPackage:function(){return"js/inspector/context.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(Od.InspectionNode);(function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),Gb=Wa.hasOwnProperty("PropertyNode")&&"function"===typeof Wa.PropertyNode?Wa.PropertyNode:Wa.PropertyNode=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:Symbol.for("lively-instance-initialize"),value:function(pa){Ab._get(Object.getPrototypeOf(Gb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,pa);var xa=pa.spec,Ha=pa.target;this.partition=pa.partition;this.target=Ha;this.spec=xa;this.foldedNodes={}}},{key:"__deserialize__",value:function(pa,xa){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",
set:function(pa){this._interactive=pa}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(pa){return this.isFoldable?this.getFoldedContext(pa):Ab._get(Object.getPrototypeOf(Gb.prototype),"getSubNode",this).call(this,pa)}},{key:"getFoldedContext",value:function(pa){return this.foldedNodes[pa.key]=new Od.FoldedNode(Object.assign({},pa,{root:this.root,
target:this.target,foldableNode:this,spec:Od.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(pa,xa){(xa=void 0===xa?!1:xa)&&(this.target[this.key]=pa);this.value=this.target[this.key];this.valueString=Od.printValue(this.value);this.interactive&&(xa||this._propertyWidget.highlight());if(this.isFoldable)for(var Ha in this.foldedNodes)this.foldedNodes[Ha].value=this.value[Ha],this.foldedNodes[Ha].valueString=
Od.printValue(this.value[Ha]),this.foldedNodes[Ha]._propertyWidget&&Od.signal(this.foldedNodes[Ha]._propertyWidget,"update",this.value[Ha])}},{key:"display",value:function(pa){var xa=this,Ha=this._propertyWidget,S=this.keyString,ob=this.valueString,fa=this.target,Ba=this.value,Na=this.spec;if(!(this.interactive||Na.foldable&&Od.isMultiValue(Ba,Na.foldable)))return pa.renderPropertyControl({target:fa,keyString:S,valueString:ob,tree:pa.ui.propertyTree,value:Ba,spec:Na,node:this,fastRender:!0});if(Ha)return Ha.keyString=
S,Ha.valueString=ob,Ha.isSelected=this.isSelected,Ha.control&&(Ha.control.isSelected=this.isSelected),Ha;Ha=this._propertyWidget=pa.renderPropertyControl({target:fa,keyString:S,valueString:ob,value:Ba,spec:Na,node:this,isSelected:this.isSelected,fontColor:pa.ui.propertyTree.fontColor});this.isInternalProperty||Na.readOnly||(Od.connect(Ha,"propertyValue",this,"refreshProperty",{updater:function(tb,Sb){return tb(Sb,!0)}}),Od.connect(Ha,"openWidget",this.root,"onWidgetOpened",{converter:function(tb){return{widget:tb,
node:xa.sourceObj}}}));return Ha}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Wa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(Od.InspectionNode);(function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
Gb=Wa.hasOwnProperty("FoldedNode")&&"function"===typeof Wa.FoldedNode?Wa.FoldedNode:Wa.FoldedNode=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:Symbol.for("lively-instance-initialize"),value:function(pa){Ab._get(Object.getPrototypeOf(Gb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,pa);this.foldableNode=pa=pa.foldableNode;this.foldedProp=pa.key+Od.string.capitalize(this.key)}},
{key:"refreshProperty",value:function(pa,xa){xa=void 0===xa?!1:xa;var Ha={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Ha[this.key]=pa,Ha)),xa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Wa,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:18246,end:18928})})(Od.PropertyNode);var Ue=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Ue.Color=wb;var ff=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),Gb=Wa.hasOwnProperty("DarkTheme")&&"function"===typeof Wa.DarkTheme?Wa.DarkTheme:Wa.DarkTheme=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:"background",get:function(){return Ue.Color.rgb(44,
62,80)}},{key:"cursorColor",get:function(){return Ue.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",
get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Ue.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Ue.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Ue.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},
{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},
{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Ue.Color.white,fontWeight:"bold",backgroundColor:Ue.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Ue.Color.rgba(204,
204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Ue.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Wa,{pathInPackage:function(){return"themes/dark.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),gf=ff=Ue.DarkTheme;Ue.default=ff;var Wb=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Wb.inspect=Ia;Wb.remoteInspect=Q;Wb.generateReferenceExpression=za;Wb.onNumberDragStart=function(Fa,Wa){Wa.initPos=Fa.position;Wa.factorLabel=(new Wb.Tooltip({description:"1x"})).openInWorld(Fa.hand.position.addXY(10,
10))};Wb.onNumberDrag=function(Fa,Wa){var Gb=Wb.getScaleAndOffset(Fa,Wa),pa=Gb.scale;Gb=Gb.offset;Wa.factorLabel.position=Fa.hand.position.addXY(10,10);Wa.factorLabel.description=pa+"x";return Wb.getCurrentValue(Gb,pa,Wa)};Wb.onNumberDragEnd=function(Fa,Wa){var Gb=Wb.getScaleAndOffset(Fa,Wa);Fa=Gb.offset;Gb=Gb.scale;Wa.factorLabel.softRemove();return Wb.getCurrentValue(Fa,Gb,Wa)};Wb.getScaleAndOffset=function(Fa,Wa){var Gb=Fa.position.subPt(Wa.initPos);Fa=Gb.x;Wa=Wb.num.roundTo(Math.exp(-Gb.y/$world.height*
6),.01)*Wa.baseFactor;return{offset:Fa,scale:Wa}};Wb.getCurrentValue=function(Fa,Wa,Gb){return Math.max(Gb.min,Math.min(Gb.max,Gb.scrubbedValue+(Gb.floatingPoint?Fa*Wa:Math.round(Fa*Wa))))};Wb.Color=wb;Wb.rect=Hc;Wb.pt=Zc;Wb.obj=pe;Wb.num=Kd;Wb.Path=wd;Wb.arr=gc;Wb.promise=Qd;Wb.connect=Bc;Wb.disconnect=Eb;Wb.once=Mc;Wb.Morph=ic;Wb.Tooltip=jd;Wb.VerticalLayout=jc;Wb.HorizontalLayout=kd;Wb.morph=Kc;Wb.Label=vb;Wb.Icon=db;Wb.config=ec;Wb.Tree=Mb;Wb.LoadingIndicator=Hb;Wb.DropDownList=pc;Wb.DropDownSelector=
Ma;Wb.SearchField=Ib;Wb.LabeledCheckBox=pb;Wb.MorphHighlighter=vc;Wb.InteractiveMorphSelector=gd;Wb.printValue=qb;Wb.RemoteInspectionTree=Te;Wb.InspectionTree=He;Wb.isMultiValue=yb;Wb.valueWidgets=Nb;Wb.popovers=Fb;Wb.DarkTheme=gf;Wb.DefaultTheme=Ac;Wb.syncEval=Ub;Wb.inspectorCommands=[{name:"focus codeEditor",exec:function(Fa){Fa.get("codeEditor").show();Fa.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(Fa){Fa.get("propertyTree").show();Fa.get("propertyTree").focus();
return!0}}];(function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Gb=Wa.hasOwnProperty("DraggedProp")&&"function"===typeof Wa.DraggedProp?Wa.DraggedProp:Wa.DraggedProp=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:"applyToTarget",value:function(pa){var xa=this.currentTarget,Ha=this.control;this.remove();Wb.MorphHighlighter.removeHighlighters(pa.world);if(xa)if(xa.isText&&
"js"===xa.editorModeName){var S=xa.evalEnvironment.context;pa=xa.textPositionFromPoint(xa.localize(pa.position));S=Wb.generateReferenceExpression(this.sourceObject,{fromMorph:S});Ha.keyString&&(S+="."+Ha.keyString);xa.insertTextAndSelect(S,pa);xa.focus()}else"propertyValue"in Ha&&(xa[Ha.keyString]=Ha.propertyValue)}},{key:"update",value:function(pa){pa=pa.hand.globalPosition;var xa=this.morphBeneath(pa);if(xa){for(xa==this.morphHighlighter&&(xa=xa.morphBeneath(pa));[xa].concat($jscomp.arrayFromIterable(xa.ownerChain())).find(function(Ha){return!Ha.visible});)xa=
xa.morphBeneath(pa);if(xa!=this.currentTarget){this.currentTarget=xa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(xa.isWorld)return;this.morphHighlighter=Wb.MorphHighlighter.for($world,xa);this.morphHighlighter.show()}this.position=pa}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Wb.Color.rgb(169,204,227)},fill:{defaultValue:Wb.Color.rgb(235,245,251).withA(.8)},
borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var pa=this.control;if(!pa)return this.submorphs=[];this.height=22;this.submorphs=[pa];pa.top=0;pa.fontSize=14;"function"===typeof pa.relayout&&pa.relayout();this.width=pa.width+20;this.adjustOrigin(Wb.pt(10,10))}}}}}],Wa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1223,end:3665})})(Wb.Morph);(function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Gb=Wa.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Wa.DraggableTreeLabel?Wa.DraggableTreeLabel:Wa.DraggableTreeLabel=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:"inspector",get:function(){return this.owner.owner}},
{key:"onDragStart",value:function(pa){this.draggedProp=new Wb.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Wb.connect(pa.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(pa){}},{key:"onDragEnd",value:function(pa){Wb.disconnect(pa.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(pa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},
draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Wb.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:Wb.Color.transparent},padding:{defaultValue:Wb.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(pa){this.setProperty("isSelected",pa);pa?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=
pa)}}}}}],Wa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3667,end:5006})})(Wb.Label);He=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Gb=Wa.hasOwnProperty("PropertyControl")&&"function"===typeof Wa.PropertyControl?Wa.PropertyControl:Wa.PropertyControl=
function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(pa,xa,Ha){pa.control=new Wb.DropDownSelector({opacity:.8,fill:Wb.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:xa,padding:0,values:Ha});Wb.connect(pa.control,"update",pa,"propertyValue",{updater:function(S,
ob){this.targetObj.propertyValue!=ob&&S(ob)}});Wb.connect(pa,"update",pa.control,"selectedValue",{updater:function(S,ob){ob=ob&&ob.valueOf?ob.valueOf():ob;this.targetObj.propertyValue!=ob&&S(ob)}});return pa}},{key:"toggleMultiValuePlaceholder",value:function(pa){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:Wb.Color.transparent,layout:new Wb.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:Wb.arr.range(0,2).map(function(xa){return{type:"ellipse",
fill:Wb.Color.gray.withA(.5),reactsToPointer:!1,extent:Wb.pt(7,7)}})});pa?(Wb.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(Wb.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(pa){this.foldableProperties&&this.toggleMultiValuePlaceholder(Wb.isMultiValue(pa,
this.foldableProperties))}},{key:"asFoldable",value:function(pa){this.foldableProperties=pa;Wb.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+
": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var pa=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});pa.isLayoutable=!1;pa.fontWeight="bold";pa.fontColor=Wb.Color.orange;pa.reactsToPointer=!1;pa.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],
derived:!0,get:function(){return this.submorphs[0]||!1},set:function(pa){this.submorphs=[pa]}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[];Wb.connect(this,"extent",this,"relayout")}}}}},{key:"inferType",value:function(pa){return(pa=pa.value)&&(pa.isColor||pa.isGradient)?"Color":pa&&pa.isPoint?"Point":Wb.obj.isBoolean(pa)?"Boolean":Wb.obj.isNumber(pa)?"Number":Wb.obj.isString(pa)?"String":pa&&pa.isRectangle?"Rectangle":!1}},{key:"render",value:function(pa){pa.spec.type||
(pa.spec=Object.assign({},pa.spec,{isFloat:!Number.isInteger(pa.value),type:this.inferType(pa)}));switch(pa.spec.type){case "Color":var xa=this.renderColorControl(pa);break;case "ColorGradient":xa=this.renderColorControl(Object.assign({},pa,{gradientEnabled:!0}));break;case "Number":xa=this.renderNumberControl(pa);break;case "String":xa=this.renderStringControl(pa);break;case "RichText":xa=this.renderStringControl(pa);break;case "Layout":xa=this.renderLayoutControl(pa);break;case "Enum":xa=this.renderEnumControl(pa);
break;case "Shadow":xa=this.renderShadowControl(pa);break;case "Point":xa=this.renderPointControl(pa);break;case "Rectangle":xa=this.renderRectangleControl(pa);break;case "Boolean":xa=this.renderBooleanControl(pa);break;default:xa=this.renderItSomehow(pa)}xa.control&&(Wb.connect(xa.control,"openWidget",xa,"openWidget"),xa.toggleFoldableValue(pa.value));return xa}},{key:"baseControl",value:function(pa){var xa=pa.spec;pa=new this({keyString:pa.keyString,valueString:pa.valueString,isSelected:!1,propertyValue:pa.value});
xa.foldable&&pa.asFoldable(xa.foldable);return pa}},{key:"renderGrabbableKey",value:function(pa){var xa=this,Ha=pa.target;return[pa.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(S){S.state.draggedProp=new Wb.DraggedProp({sourceObject:Ha,control:xa.baseControl(pa)});S.state.draggedProp.openInWorld();Wb.connect(S.hand,"update",S.state.draggedProp,"update")},onDrag:function(S){},onDragEnd:function(S){Wb.disconnect(S.hand,"update",S.state.draggedProp,"update");S.state.draggedProp.applyToTarget(S)}}]}},
{key:"renderEnumControl",value:function(pa){var xa=pa.value,Ha=pa.spec.values,S=pa.keyString,ob=pa.target,fa=pa.node,Ba=function(Na,tb){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sb){ob.world().openWorldMenu(Na,Ha.map(function(lc){return{string:lc.toString(),action:function(){ob[S]=lc;fa.rerender()}}}));Sb.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(pa)),[" "+(xa?xa.valueOf?xa.valueOf():xa:"Not set"),{nativeCursor:"pointer",onMouseDown:Ba}],$jscomp.arrayFromIterable(Wb.Icon.textAttribute("angle-down",
{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:Ba})))}},{key:"renderStringControl",value:function(pa){var xa=pa.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(pa)),[" "+(200<xa.length?xa.slice(0,20)+"...":xa),{fontColor:Wb.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(pa){var xa=pa.value,Ha=pa.keyString,S=pa.valueString,ob=pa.target,fa=pa.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(pa)),[" "+S,{fontColor:Wb.Color.black,
nativeCursor:"pointer",onMouseDown:function(Ba){var Na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress)return Na=new Wb.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:xa}),Na.relayout(),tb.yield(Na.fadeIntoWorld(Ba.positionIn(ob.world())),2);Wb.connect(Na,"rectangle",function(Sb){ob[Ha]=Sb;fa.rerender()});tb.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(pa){var xa=pa.value,Ha=pa.keyString,S=pa.valueString,ob=pa.target,fa=pa.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(pa)),
[" "+S,{nativeCursor:"pointer",fontColor:xa?Wb.Color.green:Wb.Color.red,onMouseDown:function(Ba){ob[Ha]=!ob[Ha];fa.rerender()}}])}},{key:"renderNumberControl",value:function(pa){var xa=pa.value,Ha=pa.spec,S=pa.keyString,ob=pa.valueString,fa=pa.node,Ba=pa.target,Na=pa.tree,tb=void 0===fa._numberControls?new Kh:fa._numberControls,Sb=$jscomp.makeIterator(tb.submorphs),lc=Sb.next().value,uc=Sb.next().value;tb.fontColor=Na.fontColor;var rc=fa._numberControls=tb;"max"in Ha&&"min"in Ha&&-Infinity!=Ha.min&&
Infinity!=Ha.max?(rc.baseFactor=(Ha.max-Ha.min)/100,rc.floatingPoint=Ha.isFloat,rc.max=Ha.max,rc.min=Ha.min):(rc.floatingPoint=Ha.isFloat,rc.baseFactor=.5,rc.min=void 0!=Ha.min?Ha.min:-Infinity,rc.max=void 0!=Ha.max?Ha.max:Infinity);var $c=Wb.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(pa)),$jscomp.arrayFromIterable(fa._inputMorph?[fa._inputMorph,{}]:[" "+(void 0!=xa&&(xa.valueOf?xa.valueOf():xa).toFixed(Ha.isFloat?
Math.max(4,Wb.num.precision(xa)):0))+" ",{fontColor:$c,onMouseUp:function(Jd){fa._inputMorph=Wb.morph({type:"input",fill:null,fontColor:$c,fontFamily:"IBM Plex Mono",fontSize:14,padding:Wb.rect(8,2,-6,2),height:23,cursorColor:Wb.Color.white,value:xa.valueOf?xa.valueOf():ob});Ba[S]=xa;fa._inputMorph.focus();Wb.once(fa._inputMorph,"inputAccepted",function(je){delete fa._inputMorph;Ba[S]=Ha.isFloat?Number.parseFloat(je):Number.parseInt(je);fa.rerender()});Wb.once(fa._inputMorph,"onBlur",function(je){fa._inputMorph&&
(delete fa._inputMorph,Ba[S]=xa,fa.rerender())});fa.rerender()},onDragStart:function(Jd){rc.scrubbedValue=xa;Wb.onNumberDragStart(Jd,rc)},onDrag:function(Jd){Ba[S]=Wb.onNumberDrag(Jd,rc);fa.rerender()},onDragEnd:function(Jd){return Wb.onNumberDragEnd(Jd,rc)}},tb,{onMouseUp:function(){lc.fill=uc.fill=null},onMouseDown:function(Jd){if(Jd.targetMorph===lc){lc.fill=Wb.Color.white.withA(.2);if("max"in Ha&&Ba[S]>=Ha.max)return;Ba[S]+=1}if(Jd.targetMorph===uc){uc.fill=Wb.Color.white.withA(.2);if("min"in
Ha&&Ba[S]<=Ha.min)return;--Ba[S]}fa.rerender()}}]))}},{key:"renderShadowControl",value:function(pa){var xa=pa.keyString,Ha=pa.value,S=pa.target,ob=pa.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(pa)),[""+(Ha?Ha.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(fa){var Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Na){if(1==Na.nextAddress)return Ba=new Wb.popovers.ShadowPopover({shadowValue:S[xa],hasFixedPosition:!0}),Na.yield(Ba.fadeIntoWorld(fa.positionIn(S.world())),
2);Wb.connect(Ba,"shadowValue",function(tb){S[xa]=tb;ob.rerender()});Na.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(pa){var xa=pa.keyString,Ha=pa.value,S=pa.target,ob=pa.node,fa=Wb.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Ba={nativeCursor:"pointer",onMouseDown:function(Na){var tb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sb){if(1==Sb.nextAddress)return tb=new Wb.popovers.PointPopover({pointValue:S[xa],hasFixedPosition:!0}),Sb.yield(tb.fadeIntoWorld(Na.positionIn(S.world())),
2);Wb.connect(tb,"pointValue",function(lc){S[xa]=lc;ob.rerender()});Sb.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(pa)),[" pt(",Object.assign({},Ba),""+Ha.x.toFixed(),Object.assign({fontColor:fa},Ba),",",Object.assign({},Ba),""+Ha.y.toFixed(),Object.assign({fontColor:fa},Ba),")",Object.assign({},Ba)])}},{key:"renderLayoutControl",value:function(pa){var xa=pa.valueString,Ha=pa.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(pa)),[" "+(Ha?
xa:"No Layout"),{onMouseDown:function(S){}}])}},{key:"renderColorControl",value:function(pa){var xa=pa.node,Ha=pa.gradientEnabled,S=pa.valueString,ob=pa.keyString,fa=pa.value,Ba=pa.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(pa)),[Wb.morph({fill:fa.valueOf?fa.valueOf():fa,extent:Wb.pt(15,15),borderColor:Wb.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(fa?fa.valueOf?fa.valueOf():S:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Na){var tb;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sb){if(1==Sb.nextAddress)return tb=new Wb.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Ba,fillValue:fa,title:"Fill Control",gradientEnabled:Ha}),Sb.yield(tb.fadeIntoWorld(Na.positionIn(Ba.world())),2);Wb.connect(tb,"fillValue",function(lc){Ba[ob]=lc;xa.rerender()});Sb.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(pa){var xa=pa.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(pa)),[" "+xa,
{}])}}],Wa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5015,end:20308})}(Wb.DraggableTreeLabel);Wb.PropertyControl=He;Wb.PropertyControl=He;Wb.PropertyControl=He;Wb.inspect=Ia;Wb.inspect=Ia;Wb.remoteInspect=Q;Wb.remoteInspect=Q;Wb.generateReferenceExpression=za;Wb.generateReferenceExpression=
za;var Kh=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Gb=Wa.hasOwnProperty("NumberControls")&&"function"===typeof Wa.NumberControls?Wa.NumberControls:Wa.NumberControls=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=
new Wb.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Wb.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(pa){this.submorphs.map(function(xa){return xa.fontColor=pa})}},submorphs:{initialize:function(){this.submorphs=[Wb.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Wb.rect(5,2,0,-6),fontSize:12}),Wb.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:Wb.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",
fontSize:12})]}}}}}],Wa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:22981,end:24026})}(Wb.Morph);(function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Gb=Wa.hasOwnProperty("PropertyTree")&&"function"===typeof Wa.PropertyTree?Wa.PropertyTree:Wa.PropertyTree=
function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:"onDrag",value:function(pa){this._onDragHandler&&this._onDragHandler(pa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Wa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25191,end:25302})})(Wb.Tree);He=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),Gb=Wa.hasOwnProperty("Inspector")&&"function"===typeof Wa.Inspector?Wa.Inspector:Wa.Inspector=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();
this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(pa){}},{key:"__after_deserialize__",value:function(pa,xa,Ha){var S=this,ob=new Wb.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Wb.InspectionTree.forObject(null,this)}));this.addMorph(ob,this.getSubmorphNamed("terminal toggler"));Ab._get(Object.getPrototypeOf(Gb.prototype),"__after_deserialize__",this).call(this,pa,xa,Ha);!this.isComponent&&this.master.whenApplied().then(function(){S.layout.col(0).row(1).group.morph=
ob;S.targetObject&&(S.targetObject=S.targetObject)})}},{key:"__additionally_serialize__",value:function(pa,xa,Ha,S){pa=pa.props.submorphs.value;for(xa=pa.length;xa--;)Ha.refForId(pa[xa].id).realObj==this.ui.propertyTree&&Wb.arr.removeAt(pa,xa)}},{key:"renderDraggableTreeLabel",value:function(pa){return new Wb.DraggableTreeLabel(pa)}},{key:"renderPropertyControl",value:function(pa){return Wb.PropertyControl.render(pa)}},{key:"onLoad",value:function(){var pa=this.ui,xa=pa.codeEditor,Ha=pa.thisBindingSelector,
S=pa.propertyTree;xa.changeEditorMode("js").then(function(){return xa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Ha.selection?xa.owner.selectedContext:xa.owner.targetObject},get systemInterface(){return Wb.Path("treeData.systemInterface").get(S)},format:"esm"}}).catch(function(ob){return $world.logError(ob)})}},{key:Symbol.for("lively-instance-initialize"),value:function(pa){Ab._get(Object.getPrototypeOf(Gb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,pa);pa=this.ui;var xa=pa.targetPicker,Ha=pa.propertyTree,S=pa.resizer,ob=pa.terminalToggler,fa=pa.unknowns,Ba=pa.internals,Na=pa.searchField,tb=pa.codeEditor,Sb=pa.fixImportButton,lc=pa.thisBindingSelector;tb.changeEditorMode("js").then(function(){return tb.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==lc.selection?tb.owner.selectedContext:tb.owner.targetObject},get systemInterface(){return Ha.treeData.systemInterface},format:"esm"}}).catch(function(uc){return $world.logError(uc)});
Wb.connect(xa,"onMouseUp",this,"selectTarget");Wb.connect(Ha,"onScroll",this,"repositionOpenWidget");Wb.connect(S,"onDrag",this,"adjustProportions");Wb.connect(ob,"onMouseDown",this,"toggleCodeEditor");Wb.connect(fa,"trigger",this,"filterProperties");Wb.connect(Ba,"trigger",this,"filterProperties");Wb.connect(Na,"searchInput",this,"filterProperties");Wb.connect(Ha,"nodeCollapseChanged",this,"filterProperties");Wb.connect(this,"extent",this,"relayout");Wb.connect(lc,"selection",this,"bindCodeEditorThis");
Wb.connect(Sb,"fire",tb,"execCommand",{updater:function(uc){return uc("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var pa=this.ui.propertyTree.selectedIndex-1,xa=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();xa=this.ui.propertyTree.document.getLine(pa).textAndAttributes.slice(0,4).concat(xa.display(this));pa=this.ui.propertyTree.lineRange(pa,!1);this.ui.propertyTree.replace(pa,xa,!1,!1,
!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var pa=Wb.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(pa!=this.lastChange||this.lastSubmorphs!=Wb.printValue(this.targetObject&&
this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==pa.prop&&this.repositionOpenWidget(),this.lastChange=pa,this.lastSubmorphs=Wb.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var pa;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(xa){xa=xa.node;xa.target&&(pa=xa.foldableNode?xa.target[xa.foldableNode.key][xa.key]:xa.target[xa.key],
!Wb.obj.equals(pa,xa.value)&&xa.refreshProperty&&xa.refreshProperty(pa))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(pa,xa){xa=void 0===xa?!1:xa;var Ha=this,S,ob,fa,Ba,Na,tb,Sb,lc,uc,rc,$c,Jd,je,td,qe;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wd){switch(Wd.nextAddress){case 1:if(!Ha.isUpdating()){Wd.jumpTo(2);break}return Wd.yield(Ha.whenUpdated(),
2);case 2:S=Wb.promise.deferred();ob=S.promise;fa=!!Ha.target;Ha.updateInProgress=ob;Wd.setCatchFinallyBlocks(4);xa&&(Ba=Wb.LoadingIndicator.open("connecting to remote..."));if(!xa){Na=Wb.InspectionTree.forObject(pa,Ha);Wd.jumpTo(6);break}return Wd.yield(Wb.RemoteInspectionTree.forObject(pa,Ha),7);case 7:Na=Wd.yieldResult;case 6:return tb=Na,Sb=Ha.ui.propertyTree,Wd.yield(tb.collapse(tb.root,!1),8);case 8:if(!tb.root.children){Wd.jumpTo(9);break}return Wd.yield(tb.collapse(tb.root.children[0],!1),
9);case 9:if(lc=Ha.originalTreeData&&Ha.originalTreeData.diff(tb)){uc=$jscomp.makeIterator(lc);for(rc=uc.next();!rc.done;rc=uc.next())$c=rc.value,Jd=$jscomp.makeIterator($c),je=Jd.next().value,td=Jd.next().value,je.refreshProperty(td.value);Wd.jumpTo(11);break}Sb.treeData=tb;return Wd.yield(Ha.filterProperties(),12);case 12:if(!Sb.treeData.root.isCollapsed){Wd.jumpTo(13);break}return Wd.yield(Sb.onNodeCollapseChanged({node:tb.root,isCollapsed:!1}),14);case 14:Sb.selectedIndex=1;case 13:return Wd.yield(Sb.execCommand("uncollapse selected node"),
11);case 11:Ha.toggleWindowStyle(fa);Ba&&Ba.remove();Wd.leaveTryBlock(5);break;case 4:qe=Wd.enterCatchBlock(),Ha.showError(qe);case 5:Ha.startStepping(1E3,"refreshAllProperties"),Ha.updateInProgress=null,Wd.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(pa){pa=void 0===pa?!0:pa;var xa=this,Ha,S,ob,fa,Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Na){if(1==Na.nextAddress)return Ha=300,fa=xa.ui.codeEditor.pluginFind(function(tb){return tb.runEval}),Ba=xa.getWindow(),Na.yield(fa.runEval("System.get('@system-env').node"),
2);Na.yieldResult.value?(ob=[].concat($jscomp.arrayFromIterable(Wb.arr.without(Ba.styleClasses,"local")),["node"]),S=Wb.DarkTheme.instance):(ob=["local"].concat($jscomp.arrayFromIterable(Ba?Wb.arr.without(Ba.styleClasses,"node"):[])),S=Wb.DefaultTheme.instance);fa.theme=S;pa?(Ba&&Ba.animate({duration:Ha,styleClasses:ob}),xa.ui.codeEditor.animate({fill:S.background,duration:Ha})):Ba&&(Ba.styleClasses=ob);xa.ui.codeEditor.textString=xa.ui.codeEditor.textString;fa.highlight();Na.jumpToEnd()})}},{key:"isUpdating",
value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var pa=this,xa=Object.assign({type:"text",borderWidth:1,borderColor:Wb.Color.gray,lineWrapping:"by-chars"},Wb.config.codeEditor.defaultStyle,{textString:""}),Ha=Wb.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Wb.rect(0,0,this.width,30);var S=new Wb.SearchField({styleClasses:["idle"],
name:"searchField"});Ha[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[S,{type:"button",name:"targetPicker",padding:Wb.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Wb.Icon.textAttribute("crosshairs")},new Wb.LabeledCheckBox({label:"Internals",name:"internals"}),new Wb.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Wb.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Wb.InspectionTree.forObject(null,
this)})),Wb.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},xa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Wb.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Ha),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Ha),[" selection",null])}]}];
this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){pa.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var pa=this,xa,Ha,S,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fa){switch(fa.nextAddress){case 1:if(pa.env.eventDispatcher.isKeyPressed("Shift"))return Ha=$jscomp,S=Ha.makeIterator,fa.yield($world.execCommand("select morph",{justReturn:!0}),
5);pa.toggleSelectionInstructions(!0);return fa.yield(Wb.InteractiveMorphSelector.selectMorph(),4);case 4:xa=fa.yieldResult;pa.toggleSelectionInstructions(!1);fa.jumpTo(3);break;case 5:ob=S.call(Ha,fa.yieldResult),xa=ob.next().value;case 3:xa&&(pa.targetObject=xa),fa.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(pa){if(pa&&!this.instructionWidget){var xa=Wb.morph({type:"label",name:"escapeKey",value:"esc"});xa.whenRendered().then(function(){return xa.fit()});this.instructionWidget=
this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},xa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(pa){pa=
pa.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;pa.epiMorph=!0;this.openWidget=pa;Wb.once(pa,"close",this,"closeOpenWidget");Wb.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var pa=this.ui.propertyTree,xa=pa.textLayout.boundsFor(pa,{column:0,row:pa.selectedIndex-1});xa=pa.worldPoint(Wb.pt(xa.x,xa.y+xa.height/2)).addPt(pa.scroll.negated());pa=pa.globalBounds();xa.x=this.globalBounds().center().x;
xa.y<pa.top()?xa=pa.topCenter():pa.bottom()-20<xa.y&&(xa=pa.bottomCenter().addXY(0,-20));return xa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(pa){var xa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){xa.layout.row(1).height+=pa.state.dragDelta.y;xa.relayout();Ha.jumpToEnd()})}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},
{key:"makeEditorVisible",value:function(pa){if(pa!==this.isEditorVisible()){var xa=this.extent,Ha=this.layout,S=this.ui,ob=S.terminalToggler,fa=S.codeEditor,Ba=S.thisBindingSelector;S=S.fixImportButton;Ha.disable();pa?(ob.fontColor=Wb.Color.rgbHex("00e0ff"),Ha.row(3).height=this.codeEditorHeight||180,Ha.row(2).height=5,S.animate({visible:!0,duration:200}),Ba.animate({visible:!0,duration:200})):(this.codeEditorHeight=Ha.row(3).height,ob.fontColor=Wb.Color.white,Ha.row(3).height=Ha.row(2).height=0,
S.animate({visible:!1,duration:200}),Ba.animate({visible:!1,duration:200}));this.extent=xa;Ha.enable({duration:200});this.relayout({duration:200});fa.focus();fa.animate({opacity:pa?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var pa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){pa.makeEditorVisible(!pa.isEditorVisible());xa.jumpToEnd()})}},{key:"filterProperties",value:function(){var pa=this,xa,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(S){if(1==
S.nextAddress)return xa=pa.ui.searchField,Ha=pa.ui.propertyTree,pa.originalTreeData||(pa.originalTreeData=Ha.treeData),Wb.disconnect(Ha.treeData,"onWidgetOpened",pa,"onWidgetOpened"),S.yield(Ha.treeData.filter({maxDepth:2,showUnknown:pa.ui.unknowns.checked,showInternal:pa.ui.internals.checked,iterator:function(ob){return xa.matches(ob.key)}}),2);Ha.update();Wb.connect(Ha.treeData,"onWidgetOpened",pa,"onWidgetOpened");S.jumpToEnd()})}},{key:"relayout",value:function(pa){pa=void 0===pa?{}:pa;var xa=
this,Ha,S,ob,fa,Ba,Na,tb,Sb,lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(uc){xa.layout&&xa.layout.forceLayout();Ha=xa;S=Ha.ui;ob=S.fixImportButton;fa=S.terminalToggler;Ba=S.propertyTree;Na=S.thisBindingSelector;tb=Ba.bounds().insetBy(5).bottomLeft();Sb=Ba.bounds().insetBy(5).bottomRight();lc=Sb.subXY(ob.width+10,0);Na.width=115;Na.listMorph.itemHeight=20;pa.duration?(fa.animate(Object.assign({bottomLeft:tb},pa)),ob.animate(Object.assign({bottomRight:Sb},pa)),Na.animate(Object.assign({bottomRight:lc},
pa))):(fa.bottomLeft=tb,ob.bottomRight=Sb,Na.bottomRight=lc);uc.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Ab._get(Object.getPrototypeOf(Gb.prototype),"keybindings",this))}},{key:"commands",get:function(){return Wb.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},
{key:"openInWindow",value:function(pa){if(System._testsRunning)return console.log(pa.targetObject);pa=new this(pa);pa.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return pa}},{key:"properties",get:function(){return{extent:{defaultValue:Wb.pt(400,500)},fill:{defaultValue:Wb.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(pa){this.setProperty("remoteTarget",pa);this.ui.propertyTree&&(this.originalTreeData=
null,this.prepareForNewTargetObject(pa,!0))}},targetObject:{after:["submorphs"],set:function(pa){this._serializableTarget=pa&&pa.isMorph?pa.id:pa;this.setProperty("targetObject",pa);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(pa))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var pa=this.ui.propertyTree,xa=pa.treeData;return xa.getContextFor(pa.selectedNode||xa.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,
derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),
searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Wb.Color.gray,fontSize:14,fontFamily:Wb.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Wa,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25319,end:45916})}(Wb.Morph);He=Wb.Inspector;Te=Ka("I",He);Wb.default=He;var ef=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");ef.Inspector=Te;ef.string=Nc;ef.Morph=ic;ef.pt=Zc;ef.Color=wb;He=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(Fa,Wa,Gb){Gb=void 0===Gb?1:Gb;var pa,
xa,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(S){switch(S.nextAddress){case 1:return Fa.maybeSelectCommentOrLine(),S.setCatchFinallyBlocks(2),Wa=Object.assign({},Wa,{logDoit:!0,inspect:!0,inspectDepth:Gb}),S.yield(Fa.doEval(void 0,Wa),4);case 4:pa=S.yieldResult;xa=pa.error?pa.error:pa.isError?pa.value:null;S.leaveTryBlock(3);break;case 2:xa=Ha=S.enterCatchBlock();case 3:return xa?Fa.showError(xa):Fa.setStatusMessage(ef.string.truncate(pa.value,1E3)),S.return(pa)}})}},{name:"eval all",
doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(Fa,Wa){var Gb,pa,xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){switch(Ha.nextAddress){case 1:return Ha.setCatchFinallyBlocks(2),Ha.yield(Fa.doEval({start:{row:0,column:0},end:Fa.documentEndPosition},Object.assign({},Wa,{logDoit:!0})),4);case 4:Gb=Ha.yieldResult;pa=Gb.error?Gb.error:Gb.isError?Gb.value:null;Ha.leaveTryBlock(3);break;case 2:pa=xa=Ha.enterCatchBlock();case 3:return pa?Fa.showError(pa):
Fa.setStatusMessage(String(Gb.value)),Ha.return(Gb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(Fa,Wa){var Gb,pa,xa,Ha,S,ob,fa,Ba;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Na){switch(Na.nextAddress){case 1:return Fa.maybeSelectCommentOrLine(),Na.setCatchFinallyBlocks(2),Wa=Object.assign({},Wa,{asString:!1,logDoit:!0}),Na.yield(Fa.doEval(void 0,Wa),4);case 4:Gb=Na.yieldResult;pa=Gb.error?Gb.error:
Gb.isError?Gb.value:null;Na.leaveTryBlock(3);break;case 2:pa=xa=Na.enterCatchBlock();case 3:Fa.selection.collapseToEnd();if(Ha=Gb.value&&Gb.value.isColor)return Fa.selection.text=String(Gb.value),S=new ef.Morph({fill:ef.Color.transparent,extent:ef.pt(Fa.fontSize+2,Fa.fontSize+2),submorphs:[{fill:Gb.value,center:ef.pt(Fa.fontSize+2,Fa.fontSize+2).scaleBy(.5)}]}),ob=Fa.selection.start,fa=ob.column,Ba=ob.row,Fa.insertText([S,{}],Fa.selection.start),Fa.selection.start={column:fa,row:Ba},Fa.focus(),Na.return(Gb);
Fa.insertTextAndSelect(pa?String(pa)+(pa.stack?"\n"+pa.stack:""):String(Gb.value));Fa.focus();return Na.return(Gb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(Fa,Wa){var Gb,pa,xa,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(S){switch(S.nextAddress){case 1:Fa.maybeSelectCommentOrLine();pa=Fa.textInRange(Fa.selection);xa=Fa.evalEnvironment||{};Ha=Fa.pluginFind(function(ob){return ob.isEditorPlugin&&"function"===
typeof ob.runEval});xa.systemInterface||(xa.systemInterface=Ha.systemInterface(Wa));if("local"!==xa.systemInterface.name){S.jumpTo(2);break}S.setCatchFinallyBlocks(3);return S.yield(Fa.doEval(void 0,Wa),5);case 5:Gb=S.yieldResult;pa=Gb.value;S.leaveTryBlock(2);break;case 3:S.enterCatchBlock();case 2:return Fa.world().execCommand("open object editor",{target:pa,evalEnvironment:xa}),S.return(Gb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",
exec:function(Fa,Wa){var Gb,pa,xa,Ha,S,ob;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fa){switch(fa.nextAddress){case 1:Fa.maybeSelectCommentOrLine();xa=Fa.textInRange(Fa.selection);Ha=Fa.evalEnvironment||{};S=Fa.pluginFind(function(Ba){return Ba.isEditorPlugin&&"function"===typeof Ba.runEval});Ha.systemInterface||(Ha.systemInterface=S.systemInterface(Wa));if("local"!==Ha.systemInterface.name){ef.Inspector.openInWindow({remoteTarget:{code:xa,evalEnvironment:Ha}});fa.jumpTo(2);break}fa.setCatchFinallyBlocks(3);
return fa.yield(Fa.doEval(void 0,Wa),5);case 5:Gb=fa.yieldResult;pa=Gb.error?Gb.error:Gb.isError?Gb.value:null;xa=Gb.value;fa.leaveTryBlock(4);break;case 3:pa=ob=fa.enterCatchBlock();case 4:ef.Inspector.openInWindow({targetObject:pa||xa});case 2:return fa.return(Gb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",handlesCount:!0,exec:function(Fa,Wa,Gb){Gb=void 0===Gb?1:Gb;var pa;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){switch(xa.nextAddress){case 1:return Fa.maybeSelectCommentOrLine(),xa.setCatchFinallyBlocks(2),Wa=Object.assign({},Wa,{inspect:!0,inspectDepth:Gb,logDoit:!0}),xa.yield(Fa.doEval(void 0,Wa),4);case 4:pa=xa.yieldResult;xa.leaveTryBlock(3);break;case 2:xa.enterCatchBlock();case 3:return Fa.selection.collapseToEnd(),Fa.insertTextAndSelect(pa.value),xa.return(pa)}})}}];ef.codeEvaluationCommands=He;ef.codeEvaluationCommands=He;ef.codeEvaluationCommands=
He;var Fd=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Fd.changeAttributeInSelectionOrMorph=function(Fa,Wa,Gb){var pa=Fa.selection;Fa.keepPosAtSameScrollOffsetWhile(function(){pa.isEmpty()?Fa[Wa]="function"===typeof Gb?Gb(Fa[Wa]):Gb:Fa.undoManager&&(Fa.undoManager.group(),Fa.changeStyleProperty(Wa,function(xa){return"function"===typeof Gb?Gb(xa):Gb}),Fa.undoManager.group())})};Te=[{name:"increase font size",scrollCursorIntoView:!1,exec:function(Fa){var Wa=Fa.fontSize;
Fd.changeAttributeInSelectionOrMorph(Fa,"fontSize",function(Gb){Gb=Gb||Wa;return Gb+(18<=Gb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(Fa){var Wa=Fa.fontSize;Fd.changeAttributeInSelectionOrMorph(Fa,"fontSize",function(Gb){Gb=Gb||Wa;return Gb-(18>=Gb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(Fa){var Wa,Gb,pa,xa,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(S){if(1==S.nextAddress){Wa=["serif","sans-serif","monospace"];
if(Gb=localStorage["lively.morpic/text-change-font-additional-fonts"])Gb=JSON.parse(Gb),Wa.push.apply(Wa,$jscomp.arrayFromIterable(Gb));Wa.map(function(ob){return ob.toLowerCase()}).includes(Fa.fontFamily.toLowerCase())||(Wa.push(Fa.fontFamily),Gb=[].concat($jscomp.arrayFromIterable(Gb||[]),[Fa.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(Gb));return S.yield($world.editListPrompt("choose font",Wa,{requester:Fa,preselect:Wa.indexOf(Fa.fontFamily),historyId:"lively.morpic/text-change-font-hist"}),
2)}pa=S.yieldResult;xa=$jscomp.makeIterator(pa.selections);if(Ha=xa.next().value)Fa.fontFamily=Ha;return S.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(Fa,Wa){Wa=void 0===Wa?{}:Wa;var Gb,pa,xa,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(S){if(1==S.nextAddress){if(Wa.hasOwnProperty("link"))return S.jumpTo(2);pa=Fa.selection;xa=Fa.getStyleInRange(pa);Ha=xa.link;return S.yield(Fa.world().prompt("Set link",{input:Ha||"https://",historyId:"lively.morphic-rich-text-link-hist"}),
3)}if(2!=S.nextAddress&&(Gb=S.yieldResult,!Gb))return S.return();Fa.undoManager.group();Fa.setStyleInRange({link:Gb||void 0},pa);Fa.undoManager.group();S.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(Fa,Wa){var Gb,pa,xa,Ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(S){if(1==S.nextAddress)return Gb=Fa.selection,pa=Fa.getStyleInRange(Gb),xa=pa.doit,S.yield(Fa.world().editPrompt("Enter doit code (runs on clicking the text)",{requester:Fa,input:xa?
xa.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:Fa.evalEnvForDoit(xa||{})}),2);Ha=S.yieldResult;Fa.undoManager.group();Ha?Fa.addTextAttribute({doit:{code:Ha},nativeCursor:"pointer",textDecoration:"underline"},Gb):Fa.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},Gb);Fa.undoManager.group();S.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(Fa,Wa){Wa=void 0===Wa?{}:Wa;Fa.undoManager.group();Wa=!Wa.onlySelection&&
Fa.selection.isEmpty()?Fa.documentRange:Fa.selection.range;Fa.setStyleInRange(null,Wa);Fa.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(Fa){var Wa,Gb,pa,xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ha){if(1==Ha.nextAddress)return Ha.yield(System.import("lively.modules"),2);if(3!=Ha.nextAddress)return Wa=Ha.yieldResult,Gb=Wa.module,Ha.yield(Gb("lively.ide/text/ui.js").load(),3);pa=Ha.yieldResult;xa=pa.RichTextControl;return Ha.return(xa.openFor(Fa))})}}];
Fd.commands=Te;Fd.commands=Te;Fd.commands=Te;var $d=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");$d.guessTextModeName=Ta;$d.rangedToken=function(Fa,Wa,Gb,pa,xa){return{start:{row:Fa,column:Wa},end:{row:Fa,column:Gb},token:pa,mode:xa}};$d.fun=dc;$d.arr=gc;$d.connect=Bc;$d.disconnect=Eb;$d.DefaultTheme=Ac;$d.tokenizeDocument=Oc;$d.modeInfo=Yb;$d.visitDocumentTokens=gb;$d.getMode=ja;$d.completionCommands=qd;$d.multiSelectCommands=se;$d.navCommands=w;$d.codeCommands=ue;$d.codeEvaluationCommands=
He;$d.richTextCommands=Te;$d.Color=wb;$d.Range=ce;$d.guessTextModeName=Ta;$d.guessTextModeName=Ta;Ac=function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Gb=Wa.hasOwnProperty("EditorPlugin")&&"function"===typeof Wa.EditorPlugin?Wa.EditorPlugin:Wa.EditorPlugin=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
$d.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(pa){var xa=this;this.textMorph=pa;$d.connect(pa,"textChange",this,"onTextChange");$d.connect(pa,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return xa.highlight()})}},
{key:"detach",value:function(pa){$d.disconnect(pa,"textChange",this,"onTextChange");$d.disconnect(pa,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(pa){this._ast=null;if(pa){var xa=this._tokenizerValidBefore;if("replace"===pa.selector){var Ha=pa.args[0].start;pa=Ha.row;Ha=Ha.column}else Ha=pa=0;if(!xa||pa<xa.row||pa===xa.row&&Ha<xa.column)pa=Math.max(0,pa),this._tokenizerValidBefore={row:pa,
column:Ha}}this.requestHighlight()}},{key:"requestHighlight",value:function(pa){var xa=this;(void 0===pa?0:pa)?this.highlight():$d.fun.debounceNamed(this.textMorph.id+"-requestHighlight",300,function(){xa.highlight()})()}},{key:"highlight",value:function(){var pa=this.textMorph,xa=this.theme,Ha=this.mode,S=this._tokenizerValidBefore;if(xa&&pa&&pa.document&&Ha){pa.fill=xa.background;pa.cursorColor=xa.cursorColor||pa.fontColor;var ob=pa.viewState,fa={};S=$d.tokenizeDocument(Ha,pa.document,ob.firstVisibleRow,
ob.lastVisibleRow,S);Ha=S.lines;S=S.tokens;if(Ha.length){ob=Ha[0].row;for(var Ba=[],Na=0;Na<S.length;ob++,Na++)for(var tb=S[Na],Sb=0;Sb<tb.length;Sb+=5){var lc=tb[Sb],uc=tb[Sb+1],rc=xa[tb[Sb+2]]||xa.default;rc&&Ba.push({start:{row:ob,column:lc},end:{row:ob,column:uc}},rc)}pa.embeddedMorphs.forEach(function($c){var Jd=pa.embeddedMorphMap.get($c).anchor;fa[$c.id]=pa.textAttributeAt(Jd.position)});pa.setTextAttributesWithSortedRanges(Ba);pa.embeddedMorphs.forEach(function($c){var Jd=pa.embeddedMorphMap.get($c).anchor;
Jd=$d.Range.at(Jd.position);Jd.end.column+=1;pa.replace(Jd,[$c,fa[$c.id]],!1)});this._tokenizerValidBefore={row:$d.arr.last(Ha).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},pa,this)}}},{key:"visitTokensInRange",value:function(pa,xa){var Ha=pa.start,S=pa.end,ob=Ha.row-1;$d.visitDocumentTokens(this.mode,this.textMorph.document,Ha.row,S.row,null,function(fa){return ob++},function(fa,Ba,Na,tb,Sb,lc,uc){if(ob===Ha.row&&0<Ha.column){if(Ha.column>=tb)return;Na<Ha.column&&Ha.column<tb&&
(Na=Ha.column)}if(ob===S.row){if(S.column<=Na)return;Na<S.column&&S.column<tb&&(tb=S.column)}xa(fa,Ba,ob,Na,tb,Sb,lc,uc)})}},{key:"tokensInRange",value:function(pa){var xa=[];this.visitTokensInRange(pa,function(Ha,S,ob,fa,Ba,Na,tb,Sb){return xa.push($d.rangedToken(ob,fa,Ba,Ha,Sb))});return xa}},{key:"tokensOfRow",value:function(pa){var xa=this.textMorph.getLine(pa).length;return this.tokensInRange({start:{row:pa,column:0},end:{row:pa,column:xa}})}},{key:"tokenAt",value:function(pa){for(var xa=this.tokensOfRow(pa.row),
Ha=xa.length;Ha--;){var S=xa[Ha];if(S.token&&S.start.column<=pa.column&&pa.column<=S.end.column)return S}return null}},{key:"getCommands",value:function(pa){return[].concat($jscomp.arrayFromIterable(pa),$jscomp.arrayFromIterable($d.completionCommands),$jscomp.arrayFromIterable($d.multiSelectCommands),$jscomp.arrayFromIterable($d.navCommands),$jscomp.arrayFromIterable($d.codeCommands),$jscomp.arrayFromIterable($d.codeEvaluationCommands),$jscomp.arrayFromIterable($d.richTextCommands))}},{key:"getComment",
value:function(){if(!this.mode)return null;var pa=this.mode,xa=pa.lineComment,Ha=pa.blockCommentStart;pa=pa.blockCommentEnd;var S={};xa&&(S.lineCommentStart=xa);Ha&&(S.blockCommentStart=Ha);pa&&(S.blockCommentEnd=pa);return S}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(pa,xa,Ha){var S=this.textMorph,ob=pa.row,fa=pa.column;pa=xa[fa-1];xa=xa[fa];S.selection.text="\n";S.selection.collapseToEnd();"{"===pa&&"}"===xa&&(S.selection.text=
"\n"+" ".repeat(Ha),S.selection.collapse());S.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:ob+1,lastRow:ob+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var pa=this.textMorph,xa=this.openPairs,Ha=pa.selection,S=pa.getLine(Ha.end.row),ob=S[Ha.end.column-1];S=S[Ha.end.column];
pa.autoInsertPairs&&Ha.isEmpty()&&ob in xa&&S===xa[ob]&&(Ha.growRight(1),Ha.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(pa){var xa=this.openPairs,Ha=this.closePairs,S=this.textMorph,ob=S.selection,fa=S.autoInsertPairs&&pa in xa,Ba=S.autoInsertPairs&&pa in Ha;if(!fa&&!Ba)return!1;var Na=S.getLine(ob.end.row)[ob.end.column];if(!ob.isEmpty()){if(!fa)return!1;Ha=S.undoManager.ensureNewGroup(S);S.insertText(xa[pa],ob.end);S.insertText(pa,ob.start);S.undoManager.group(Ha);ob.growRight(-1);
return!0}if(Na in Ha&&pa===Na)return ob.goRight(1),!0;if(Ba&&!fa)return!1;Ha=S.undoManager.ensureNewGroup(S);S.insertText(pa+xa[pa]);S.undoManager.group(Ha);ob.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Wa,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:3148,end:12030})}(void 0);Yb=Ac=$d.EditorPlugin;qd=Ka("C",function(Fa){var Wa=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),Gb=Wa.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Wa.CodeMirrorEnabledEditorPlugin?Wa.CodeMirrorEnabledEditorPlugin:Wa.CodeMirrorEnabledEditorPlugin=function(pa){pa&&pa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ab(Gb,Fa,[{key:Symbol.for("lively-instance-initialize"),
value:function(){Ab._get(Object.getPrototypeOf(Gb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(pa){this.mode=this.codeMirrorMode(pa);return Ab._get(Object.getPrototypeOf(Gb.prototype),"attach",this).call(this,pa)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(pa){return{indentWithTabs:!pa.useSoftTabs,indentUnit:pa.tabWidth,
tabSize:4}}},{key:"codeMirrorMode",value:function(pa){pa=this.defaultCodeMirrorModeConfig(pa);return $d.getMode(pa,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Wa,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:12041,
end:12735})}($d.EditorPlugin));$d.CodeMirrorEnabledEditorPlugin=qd;$d.CodeMirrorEnabledEditorPlugin=qd;$d.CodeMirrorEnabledEditorPlugin=qd;$d.default=Ac;Ac=Object.freeze({__proto__:null,guessTextModeName:Ta,"default":Yb,CodeMirrorEnabledEditorPlugin:qd});Ka("e",Ac)}}});
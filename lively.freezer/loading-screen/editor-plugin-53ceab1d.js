System.register(["./__root_module__-be0d56fe.js","./index-2aae95d3.js","./index-6e2ebca5.js","./editor-plugin-d9aace66.js"],function(Pa){var Lb,Vb,Dc,jc,qd,id,Cd,bd,Wc,Zc,zd,me,te,Je,jd,Zd,gc,$c,Bd,fd,Jd,fe,Zb,Gc,xd;return{setters:[function(Ic){Lb=Ic.i;Vb=Ic.bH;Dc=Ic.bI;jc=Ic.bJ;qd=Ic.bK;id=Ic.bL;Cd=Ic.c;bd=Ic._;Wc=Ic.s;Zc=Ic.a3;zd=Ic.bx;me=Ic.a;te=Ic.p;Je=Ic.bM;jd=Ic.aY},function(Ic){Zd=Ic.s},function(Ic){gc=Ic.localInterface;$c=Ic.systemInterfaceNamed;Bd=Ic.serverInterfaceFor;fd=Ic.l2lInterfaceFor},
function(Ic){Jd=Ic.p;fe=Ic.d;Zb=Ic.a;Gc=Ic.r;xd=Ic.C}],execute:function(){var Ic=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");Ic.warnStyle={"border-bottom":"2px dotted orange"};Ic.errorStyle={"background-color":"red"};var Ad=function(fc){var xc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),bc=xc.hasOwnProperty("JavaScriptChecker")&&"function"===typeof xc.JavaScriptChecker?xc.JavaScriptChecker:xc.JavaScriptChecker=function(Qa){Qa&&Qa[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(bc,fc,[{key:"uninstall",value:function(Qa){var Da=Qa.text||Qa;(Da.markers||[]).forEach(function(ja){return ja.id.startsWith("js-checker-")&&Da.removeMarker(ja)});Da.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(Qa,Da){return[].concat($jscomp.arrayFromIterable(Qa.embeddedMorphMap.values())).find(function(ja){return Da.containsPosition(ja.anchor.position)})}},{key:"onDocumentChange",value:function(Qa,
Da,ja){var Ba=Da.document;try{var Ja=ja.parse()}catch(Fb){Ja=Fb}Ja&&(Qa=(Da.markers||[]).filter(function(Fb){return Fb.id.startsWith("js-checker-")}),ja=ja.undeclaredVariables().map(function(Fb,wa){var Ka=Fb.start;Fb=Fb.end;Ka=Ba.indexToPosition(Ka);Fb=Ba.indexToPosition(Fb);return Da.addMarker({id:"js-checker-"+wa,style:Ic.warnStyle,range:{start:Ka,end:Fb},type:"js-undeclared-var"})}),Qa.slice(ja.length).forEach(function(Fb){return Da.removeMarker(Fb)}),Ja.parseError?(Qa=Ja.parseError.loc,ja=Qa.column,
Qa=Qa.line-1,Ja=Ba.indexToPosition(Ja.parseError.pos),ja=Ja.column,Qa=Ja.row,Ja={start:{column:ja-1,row:Qa},end:{column:ja+1,row:Qa}},this.hasEmbeddedMorphInRange(Da,Ja)||Da.addMarker({id:"js-syntax-error",range:Ja,style:Ic.errorStyle,type:"js-syntax-error"})):Da.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],xc,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),Mb=Ad=Ic.JavaScriptChecker;Ic.default=Ad;var mb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");mb.query=Vb;mb.fuzzyParse=Dc;mb.acorn=jc;mb.custom=qd;mb.walk=id;var Ac=function(fc){var xc=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),bc=xc.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof xc.JavaScriptNavigator?
xc.JavaScriptNavigator:xc.JavaScriptNavigator=function(Qa){Qa&&Qa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(bc,fc,[{key:"ensureAST",value:function(Qa){return this.parse(Qa.textString)}},{key:"parse",value:function(Qa){return mb.fuzzyParse(Qa)}},{key:"move",value:function(Qa,Da){var ja=!!Da.activeMark||!Da.selection.isEmpty(),Ba=Da.selection,Ja=Da.positionToIndex(Ba.lead);Qa=this[Qa](Da.textString,Ja);Qa=Da.indexToPosition(Qa);
Ba.lead=Qa;ja||(Ba.anchor=Qa);Da.scrollCursorIntoView()}},{key:"forwardSexp",value:function(Qa){this.move("_forwardSexp",Qa)}},{key:"backwardSexp",value:function(Qa){this.move("_backwardSexp",Qa)}},{key:"backwardUpSexp",value:function(Qa){this.move("_backwardUpSexp",Qa)}},{key:"forwardDownSexp",value:function(Qa){this.move("_forwardDownSexp",Qa)}},{key:"_forwardSexp",value:function(Qa,Da){Qa=this.parse(Qa);Qa=mb.custom.findNodesIncluding(Qa,Da).reverse().find(function(Ba){return Ba.end!==Da});if(!Qa)return Da;
if("BlockStatement"===Qa.type){var ja=Qa.body.find(function(Ba){return Ba.start>Da});if(ja)return ja.start}return Qa.end}},{key:"_backwardSexp",value:function(Qa,Da){Qa=this.parse(Qa);Qa=mb.custom.findNodesIncluding(Qa,Da).reverse().find(function(Ba){return Ba.start!==Da});if(!Qa)return Da;if("BlockStatement"===Qa.type){var ja=Qa.body.slice().reverse().find(function(Ba){return Ba.end<Da});if(ja)return ja.end}return Qa?Qa.start:Da}},{key:"_backwardUpSexp",value:function(Qa,Da){Qa=this.parse(Qa);return(Qa=
mb.custom.findNodesIncluding(Qa,Da).reverse().find(function(ja){return ja.start!==Da}))?Qa.start:Da}},{key:"_forwardDownSexp",value:function(Qa,Da){Qa=this.parse(Qa);return(Qa=mb.walk.findNodeAfter(Qa,Da,function(ja,Ba){return Ba.start>Da}))?Qa.node.start:Da}},{key:"markDefun",value:function(Qa){var Da=this.rangeForFunctionOrDefinition(Qa.textString,[Qa.positionToIndex(Qa.selection.range.start),Qa.positionToIndex(Qa.selection.range.end)]);Da&&Qa.execCommand("expandRegion",{start:Da[0],end:Da[1]})}},
{key:"rangeForNodesMatching",value:function(Qa,Da,ja){Qa=this.parse(Qa);return(Da=mb.custom.findNodesIncluding(Qa,Da).reverse().find(ja))?[Da.start,Da.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(Qa,Da){var ja=Da[0]===Da[1];return this.rangeForNodesMatching(Qa,Da[1],function(Ba){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(Ba.type)&&(ja&&Ba.end!==Da[1]||!ja&&Ba.start<Da[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(Qa,
Da){"number"!==typeof Da&&(Da=Qa.positionToIndex(Da));Qa=this.ensureAST(Qa);var ja=mb.query.nodesAt(Da,Qa).reverse(),Ba=ja.find(function(Fb){return"Identifier"===Fb.type});if(!Ba&&((ja=ja[0])&&ja.type.includes("Specifier")&&ja.local&&"Identifier"===ja.local.type&&(Ba=ja.local),!Ba))return;Da=(ja=mb.query.findDeclarationClosestToIndex(Qa,Ba.name,Da))?mb.query.scopeAtIndex(Qa,ja.start):mb.query.scopeAtIndex(Qa,Da);var Ja=mb.query.findReferencesAndDeclsInScope(Da,Ba.name).refs;return{parsed:Qa,scope:Da,
id:Ba,name:Ba.name,decl:ja,refs:Ja}}},{key:"expandRegion",value:function(Qa,Da,ja,Ba){function Ja(Rb){Rb=Qa.positionToIndex({column:0,row:wa.row});return{range:[Rb+Ka.start,Rb+Ka.start+Ka.value.length],prev:Ba}}var Fb=Ba.range[0]!==Ba.range[1],wa=Qa.indexToPosition(Ba.range[0]),Ka=Qa.tokenAt(wa);if(!Fb&&Ka&&["keyword","identifier"].includes(Ka.type))return Ja();ja=ja||this.parse(Da);Da=mb.query.nodesAtIndex(ja,Ba.range[0]).reverse().find(function(Rb){return Rb.start<Ba.range[0]||Rb.end>Ba.range[1]});
if(!Da)return Ba;ja=Da.start;Fb=Da.end;return"Literal"===Da.type&&(Da.raw||"").match(/^['"`]/)&&Ba.range[0]!==Da.start&&Ba.range[1]!==Da.end&&(Da.start+1<Ba.range[0]||Da.end-1>Ba.range[1])?{range:[ja+1,Fb-1],prev:Ba}:{range:[ja,Fb],prev:Ba}}},{key:"contractRegion",value:function(Qa,Da,ja,Ba){return Ba.prev||Ba}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],xc,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:127,end:6784})}(void 0);Ad=Ac=mb.JavaScriptNavigator;mb.default=Ac;var vc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");vc.addIndexToTextPos=function(fc,xc,bc){return fc.indexToPosition(fc.positionToIndex(xc)+bc)};vc.connect=Cd;vc.disconnect=bd;vc.string=Wc;vc.KeyHandler=Zc;vc.Range=zd;Ac=function(fc){var xc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),
bc=xc.hasOwnProperty("Snippet")&&"function"===typeof xc.Snippet?xc.Snippet:xc.Snippet=function(Qa){Qa&&Qa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(bc,fc,[{key:Symbol.for("lively-instance-initialize"),value:function(Qa){Qa=void 0===Qa?{trigger:null,expansion:""}:Qa;var Da=Qa.expansion;this.trigger=Qa.trigger;this.expansion=Da;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(Qa){this.isExpanding&&
(this.textMorph=Qa,vc.connect(this.textMorph,"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(Qa){this.isExpanding&&(vc.disconnect(Qa,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var Qa=this.expansionState,Da=Qa.startAnchor,ja=Qa.endAnchor;Qa.isExpanding?vc.Range.fromPositions(Da.position,ja.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",
value:function(){var Qa=this.textMorph;if(Qa){var Da=this.expansionState||{},ja=Da.marker,Ba=Da.startAnchor,Ja=Da.endAnchor;Da=Da.steps;Ba&&Qa.removeAnchor(Ba);Ja&&Qa.removeAnchor(Ja);ja&&Qa.removeMarker(ja);Da.forEach(function(Fb){return Qa.removeAnchor(Fb.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};Qa&&Qa.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(Qa){var Da=
[],ja=0;vc.string.reMatches(Qa,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(Ba){var Ja=Ba.start,Fb=Ba.end;Ba=Ba.match;var wa="";Ba.startsWith("${")?(wa=$jscomp.makeIterator(Ba.match(/^\$\{([0-9]+):([^\}]*)\}/)),wa.next(),Ba=wa.next().value,wa=wa.next().value,Ba=Number(Ba)):Ba=Number(Ba.replace(/^\$/,""));Qa=Qa.slice(0,Ja-ja)+wa+Qa.slice(Fb-ja);Da[Ba]={index:Ja-ja,prefill:wa,anchor:null};ja+=Fb-Ja-wa.length});return{steps:Da,expansion:Qa}}},{key:"expandAtCursor",value:function(Qa){var Da=Qa.selection,
ja=Qa.cursorPosition.column,Ba=this.expansion;this.trigger&&(ja-=this.trigger.length);if(ja=Math.max(0,ja))Ba=vc.string.lines(Ba),Ba=[Ba[0]].concat($jscomp.arrayFromIterable(Ba.slice(1).map(function(eb){return vc.string.indent(eb," ",ja)}))),Ba=Ba.join("\n");var Ja=this.createExpansionSteps(Ba);Ba=Ja.expansion;Ja=Ja.steps;this.trigger&&Da.growLeft(this.trigger.length);Da.text=Ba;var Fb=Da.start;Ba=Da.end;Da.collapseToEnd();if(Ja.length){var wa=vc.string.newUUID();Ja.forEach(function(eb,Sc){return eb.anchor=
Qa.addAnchor(Object.assign({id:"snippet-step-"+Sc+"-"+wa},vc.addIndexToTextPos(Qa,Fb,eb.index)))});var Ka=Qa.addAnchor(Object.assign({id:"snippet-start-"+wa},Fb,{insertBehavior:"stay"})),Rb=Qa.addAnchor(Object.assign({id:"snippet-end-"+wa},Ba));this.expansionState={marker:Qa.addMarker({id:"snippet-marker-"+wa,get range(){return{start:Ka.position,end:Rb.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",
content:"fooooo"}}),startAnchor:Ka,endAnchor:Rb,stepIndex:0,steps:Ja,isExpanding:!0};Qa.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var Qa=this.expansionState,Da=Qa.steps,ja=this.textMorph;if(Qa.isExpanding&&ja){ja=ja.selection;Qa=Da[Qa.stepIndex];var Ba=Qa.prefill;ja.lead=ja.anchor=Qa.anchor.position;ja.growRight(Ba.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=Da.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+
" done"))}}},{key:"canExpand",value:function(Qa,Da){Da=Qa.positionToIndex(Qa.cursorPosition);return Qa.textString.slice(Da-this.trigger.length,Da)===this.trigger}},{key:"tryTrigger",value:function(Qa,Da){if(!this.canExpand(Qa,Qa.cursorPosition))return!1;this.expandAtCursor(Qa);return!0}},{key:"getCommands",value:function(Qa){var Da=this;return Qa.concat([{name:"[snippet] next expansion step",exec:function(ja){Da.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(ja){Da.resetExpansionState();
return!0}}])}},{key:"getKeyHandlers",value:function(Qa){return Qa.concat(vc.KeyHandler.withBindings([{keys:"Tab",command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],xc,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:357,end:6029})}(void 0);vc.Snippet=Ac;vc.Snippet=Ac;vc.Snippet=Ac;var ec=[{name:"get snippets",exec:function(fc){return fc.pluginCollect("getSnippets",[])}}];vc.snippetCommands=ec;vc.snippetCommands=ec;vc.snippetCommands=ec;var Bc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");Bc.buildEvalOpts=function(fc,xc){return fc.plugins.find(function(bc){return bc.isJSEditorPlugin}).sanatizedJsEnv(xc)};Bc.Snippet=Ac;ec=function(fc){var xc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),
bc=xc.hasOwnProperty("ModuleTopLevelVarCompleter")&&"function"===typeof xc.ModuleTopLevelVarCompleter?xc.ModuleTopLevelVarCompleter:xc.ModuleTopLevelVarCompleter=function(Qa){Qa&&Qa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(bc,fc,[{key:"compute",value:function(Qa,Da){var ja,Ba,Ja,Fb,wa,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rb){if(1==Rb.nextAddress){Ba=(ja=Qa.pluginFind(function(eb){return eb.isJSEditorPlugin}))&&
ja.systemInterface();if(!Ba)return Rb.return([]);Ja=Bc.buildEvalOpts(Qa);Fb=Ja.targetModule;return"local"===Ba.name?(wa=Object.getOwnPropertyNames(Ba.getModule(Fb).recorder),Rb.jumpTo(2)):Rb.yield(Ba.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+
Fb+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',{targetModule:"lively://module-recorder-completer"}),3)}if(2!=Rb.nextAddress){Ka=Rb.yieldResult;if(Ka.isError)return Rb.return([]);wa=JSON.parse(Ka.value)}wa=wa.filter(function(eb){return!eb.startsWith("defVar_")&&!["System","__currentLivelyModule",
"initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(eb)});return Rb.return(wa.map(function(eb){return{priority:1100,completion:eb}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],xc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:227,end:1700})}(void 0);Bc.ModuleTopLevelVarCompleter=ec;Bc.ModuleTopLevelVarCompleter=ec;Bc.ModuleTopLevelVarCompleter=ec;ec=function(fc){var xc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),bc=xc.hasOwnProperty("DynamicJavaScriptCompleter")&&"function"===typeof xc.DynamicJavaScriptCompleter?xc.DynamicJavaScriptCompleter:xc.DynamicJavaScriptCompleter=function(Qa){Qa&&Qa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Lb(bc,fc,[{key:"isValidPrefix",value:function(Qa){return/\.[a-z0-9_]*$/i.test(Qa)}},{key:"isMethodCallCompletion",value:function(Qa){return Qa.endsWith(")")&&0<Qa.indexOf("(")}},{key:"isValidIdentifier",value:function(Qa){if("string"!==typeof Qa)return!1;this.isMethodCallCompletion(Qa)&&(Qa=Qa.slice(0,Qa.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(Qa)?!0:!1}},{key:"wrapInBrackets",value:function(Qa){if(!isNaN(Number(Qa))||Qa.startsWith("Symbol."))return"["+Qa+"]";var Da="";this.isMethodCallCompletion(Qa)&&
(Da=Qa.slice(Qa.indexOf("(")),Qa=Qa.slice(0,Qa.indexOf("(")));return'["'+Qa.replace(/"/g,'\\"')+'"]'+Da}},{key:"compute",value:function(Qa){var Da=this,ja,Ba,Ja,Fb,wa,Ka,Rb,eb,Sc,Ob,pd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==Uc.nextAddress){ja=Qa.selection;ja.isEmpty()?(Ba=Qa.getLine(ja.lead.row),Ba=Ba.slice(Ba.lastIndexOf(":")+1,ja.lead.column)):Ba=ja.text.slice(Math.max(0,ja.text.indexOf(":")),0);if(!Da.isValidPrefix(Ba))return Uc.return([]);Fb=(Ja=Qa.pluginFind(function(Kc){return Kc.isJSEditorPlugin}))&&
Ja.systemInterface();if(!Fb)return Uc.return([]);wa=Bc.buildEvalOpts(Qa);return Uc.yield(Fb.dynamicCompletionsForPrefix(wa.targetModule,Ba,wa),2)}Ka=Uc.yieldResult;Rb=Ka.isError;eb=Ka.value;Sc=Ka.completions;Ob=Ka.prefix;if(Rb)return console.warn("javascript completer encountered error: "+(eb.stack||eb)),Uc.return([]);Sc.reduce(function(Kc,Hb){Hb=$jscomp.makeIterator(Hb);Hb.next();Hb=Hb.next().value;return Kc+Hb.length},0);pd=Sc.reduce(function(Kc,Hb,$d){Hb=$jscomp.makeIterator(Hb);var Tb=Hb.next().value;
Hb=Hb.next().value;return Kc.concat(Hb.map(function(Gb){var La=Da.isValidIdentifier(Gb);return{info:Tb,completion:Gb,prefix:La?Ob:"."+Ob,customInsertionFn:La?Da.isMethodCallCompletion(Gb)?function(da,Ha,bb,Qb){Ha=Qb.start;Qb=Qb.end;da=da.replace(/\((.*)\)/,function(uc){return"("+uc.slice(1,-1).split(", ").map(function(Tc,vd){return"${"+vd+":"+Tc+"}"}).join(", ")+")"});da=new Bc.Snippet({expansion:da});bb.replace({start:Ha,end:Qb},"");da.expandAtCursor(bb)}:null:function(da,Ha,bb,Qb){da=Qb.start;Qb=
Qb.end;Ha={row:da.row,column:da.column-1};Qb="."===bb.textInRange({start:Ha,end:da})?{start:Ha,end:Qb}:{start:da,end:Qb};bb.replace(Qb,Da.wrapInBrackets(Gb))}}}))},[]);pd.forEach(function(Kc,Hb){return Object.assign(Kc,{priority:2E3+pd.length-Hb})});return Uc.return(pd)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DynamicJavaScriptCompleter"}}],xc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5155})}(void 0);Bc.DynamicJavaScriptCompleter=ec;Bc.DynamicJavaScriptCompleter=ec;Bc.DynamicJavaScriptCompleter=ec;Bc.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
ec=function(fc){var xc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),bc=xc.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof xc.JavaScriptKeywordCompleter?xc.JavaScriptKeywordCompleter:xc.JavaScriptKeywordCompleter=function(Qa){Qa&&Qa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(bc,fc,[{key:"compute",value:function(Qa,Da){return Bc.keywords.map(function(ja){return{completion:ja,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],xc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6157,end:6295})}(void 0);Bc.JavaScriptKeywordCompleter=ec;Bc.JavaScriptKeywordCompleter=ec;Bc.JavaScriptKeywordCompleter=ec;ec=[new Bc.DynamicJavaScriptCompleter,
new Bc.JavaScriptKeywordCompleter,new Bc.ModuleTopLevelVarCompleter];Bc.completers=ec;Bc.completers=ec;Bc.completers=ec;var Ua=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");Ua.Snippet=Ac;var hc=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];Ua.snippets=hc;Ua.snippets=hc;Ua.snippets=hc;var Eb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");Eb.getEvalEnv=function(fc){return(fc=fc.pluginFind(function(xc){return xc.isJSEditorPlugin}))?fc.evalEnvironment:null};Eb.setEvalEnv=function(fc,xc){(fc=fc.pluginFind(function(bc){return bc.isJSEditorPlugin}))&&Object.assign(fc.evalEnvironment,xc);return fc.evalEnvironment};
Eb.pToI=function(fc,xc){return fc.positionToIndex(xc)};Eb.iToP=function(fc,xc){return fc.indexToPosition(xc)};Eb.arr=me;Eb.promise=te;Eb.string=Wc;Eb.show=Zd;Eb.Range=zd;Eb.query=Vb;Eb.BaseVisitor=Je;Ua=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(fc,xc){xc=void 0===xc?{varName:null,position:null}:xc;var bc,Qa,Da,ja,Ba,Ja,Fb,wa,Ka,Rb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){switch(eb.nextAddress){case 1:bc=
xc;Qa=bc.varName;Da=bc.position;if(!Qa){Da||(Da=fc.cursorPosition);ja=fc.pluginInvokeFirst("getNavigator");Ba=ja.ensureAST(fc);Ja=Eb.query.nodesAt(fc.positionToIndex(Da),Ba).reverse().find(function(Sc){return"Identifier"===Sc.type});if(!Ja)return fc.showError(Error("no identifier found!")),eb.return(!0);Qa=Ja.name}xc=fc.pluginFind(function(Sc){return Sc.isJSEditorPlugin}).sanatizedJsEnv();Fb='lively.modules.module("'+xc.targetModule+'").undefine("'+Qa+'")';eb.setCatchFinallyBlocks(2);return eb.yield(fc.doEval(null,
xc,Fb),4);case 4:wa=eb.yieldResult;Ka=wa.error?wa.error:wa.isError?wa.value:null;eb.leaveTryBlock(3);break;case 2:Ka=Rb=eb.enterCatchBlock();case 3:return Ka?fc.showError(Ka):fc.setStatusMessage(Qa+" undefined"),eb.return(!0)}})}},{name:"change doitContext",exec:function(fc){var xc,bc,Qa,Da,ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ba){if(1==Ba.nextAddress)return xc=$jscomp,bc=xc.makeIterator,Ba.yield(fc.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(Ja){return!Ja.isUsedAsEpiMorph()}}),2);Qa=bc.call(xc,Ba.yieldResult);if(Da=Qa.next().value)ja="reset"===Da,fc.doitContext=ja?null:Da,fc.setStatusMessage(ja?"doitContext is now\n"+Da:"doitContext reset");return Ba.return(!0)})}},{name:"change eval backend",exec:function(fc,xc){xc=void 0===xc?{backend:void 0}:xc;var bc,Qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){if(1==Da.nextAddress)return bc=xc,Qa=bc.backend,void 0!==Qa?
Da.jumpTo(2):Da.yield(fc.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=Da.nextAddress&&(Qa=Da.yieldResult,!Qa))return fc.setStatusMessage("Canceled"),Da.return(!0);"local"===Qa&&(Qa=null);fc.setStatusMessage("Eval backend is now "+(Qa||"local"));return Da.return(Eb.setEvalEnv(fc,{remote:Qa}))})}},{name:"copy current module name to clipboard",exec:function(fc){var xc=fc.evalEnvironment.targetModule;fc.setStatusMessage(xc||"Cannot find module name");fc.env.eventDispatcher.killRing.add(fc);
fc.env.eventDispatcher.doCopy(xc);return!0}}];Eb.jsEditorCommands=Ua;Eb.jsEditorCommands=Ua;Eb.jsEditorCommands=Ua;var qc=[{name:"[javascript] list errors and warnings",exec:function(fc){var xc,bc,Qa,Da,ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ba){if(1==Ba.nextAddress){xc=(fc.markers||[]).filter(function(Ja){Ja=Ja.type;return"js-undeclared-var"===Ja||"js-syntax-error"===Ja});if(!xc.length)return Eb.show("no warnings or errors"),Ba.return(!0);bc=xc.map(function(Ja){var Fb=Ja.range;
return{isListItem:!0,string:"["+Ja.type.split("-").slice(1).join(" ")+"] "+fc.textInRange(Fb),value:Fb}});return Ba.yield(fc.world().filterableListPrompt("jump to warning or error",bc),2)}Qa=Ba.yieldResult;Da=$jscomp.makeIterator(Qa.selected);if(ja=Da.next().value)fc.saveMark(),fc.selection=ja,fc.centerRow(ja.start.row);return Ba.return(!0)})}},{name:"[javascript] inject import",exec:function(fc,xc){xc=void 0===xc?{gotoImport:!1,insertImportAtCursor:!0}:xc;var bc,Qa,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ja){switch(ja.nextAddress){case 1:return ja.yield(Eb.promise.delay(0),
2);case 2:return ja.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return bc=ja.yieldResult,Qa=bc.interactivelyInjectImportIntoText,ja.yield(Qa(fc,xc),4);case 4:return(Da=ja.yieldResult)||fc.setStatusMessage("canceled"),ja.return(Da)}})}},{name:"[javascript] fix undeclared variables",exec:function(fc,xc){xc=void 0===xc?{ignore:[],autoApplyIfSingleChoice:!1,requester:fc}:xc;var bc,Qa,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ja){if(1==ja.nextAddress)return ja.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=ja.nextAddress)return bc=ja.yieldResult,Qa=bc.interactivlyFixUndeclaredVariables,ja.yield(Qa(fc,xc),3);Da=ja.yieldResult;fc.focus();return ja.return(Da)})}},{name:"[javascript] remove unused imports",exec:function(fc,xc){xc=void 0===xc?{query:!0}:xc;var bc,Qa,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ja){if(1==ja.nextAddress)return ja.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=ja.nextAddress)return bc=ja.yieldResult,Qa=bc.cleanupUnusedImports,ja.yield(Qa(fc,
xc),3);Da=ja.yieldResult;fc.setStatusMessage(Da);return ja.return(!0)})}},{name:"[javascript] eslint report",exec:function(fc){var xc,bc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==Qa.nextAddress)return Qa.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);xc=Qa.yieldResult;bc=xc.default;try{return Qa.return(bc.reportOnMorph(fc))}catch(Da){fc.showError(Da)}Qa.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(fc){var xc,bc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==
Qa.nextAddress)return Qa.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);xc=Qa.yieldResult;bc=xc.default;try{return Qa.return(bc.previewFixesOnMorph(fc))}catch(Da){fc.showError(Da)}Qa.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(fc,xc,bc){function Qa(Uc,Kc){Kc||(Kc=wa(Uc,{allowReturnOutsideFunction:!0}));var Hb=Eb.string.lineRanges(Uc),$d=Uc.split("\n"),Tb=[],Gb=new Eb.BaseVisitor,La=Gb.visitVariableDeclaration;Gb.visitVariableDeclaration=
function(Qb,uc,Tc){if(1<Qb.declarations.length)for(var vd=Eb.string.findLineWithIndexInLineRanges(Hb,Qb.start),Wd=Qb.declarations[0].start-Hb[vd][0],ed={},He=1;He<Qb.declarations.length;ed={$jscomp$loop$prop$actionType$2983:ed.$jscomp$loop$prop$actionType$2983,$jscomp$loop$prop$arg$2984:ed.$jscomp$loop$prop$arg$2984},He++){var Rd=Qb.declarations[He],Fe=Eb.string.findLineWithIndexInLineRanges(Hb,Rd.start);if(vd!==Fe){var z=$d[Fe].match(/\s*/)[0].length;z=Wd-z;0!==z&&(Rd=Eb.string.findLineWithIndexInLineRanges(Hb,
Rd.end),ed.$jscomp$loop$prop$actionType$2983=0<z?"insert":"delete",ed.$jscomp$loop$prop$arg$2984=0<z?" ".repeat(z):-z,Tb.push.apply(Tb,$jscomp.arrayFromIterable(Eb.arr.range(Fe,Rd).map(function(Ce){return function(Ke){return[Ce.$jscomp$loop$prop$actionType$2983,Hb[Ke][0],Ce.$jscomp$loop$prop$arg$2984]}}(ed)))))}}return La.call(Gb,Qb,uc,Tc)};Gb.accept(Kc,{},[]);for(Kc=Tb.length;Kc--;){var da=$jscomp.makeIterator(Tb[Kc]),Ha=da.next().value,bb=da.next().value;da=da.next().value;"insert"===Ha?Uc=Uc.slice(0,
bb)+da+Uc.slice(bb):"delete"===Ha&&(Uc=Uc.slice(0,bb)+Uc.slice(bb+da))}return Uc}var Da,ja,Ba,Ja,Fb,wa,Ka,Rb,eb,Sc,Ob,pd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){switch(Uc.nextAddress){case 1:return Da=bc||Math.floor(fc.width/fc.defaultCharExtent().width),xc=Object.assign({printWidth:Da,tabWidth:2,useTabs:!1,bracketSpacing:!1},xc),ja=lively.modules.module,Ba=System.normalizeSync("prettier/standalone.js"),Uc.yield(ja(Ba).load({format:"global",instrument:!1}),2);case 2:return Ja=
Uc.yieldResult,Uc.yield(ja("lively.ast/lib/acorn-extension.js").load(),3);case 3:return Uc.yield(ja("lively.ast").load(),4);case 4:return Fb=Uc.yieldResult,wa=Fb.parse,Uc.yield(ja("lively.ast/lib/query.js").load(),5);case 5:return Uc.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return Ka=Uc.yieldResult,Rb=fc.selection.isEmpty()?fc.documentRange:fc.selection.range,eb=fc.positionToIndex(Rb.start),Sc=fc.positionToIndex(Rb.end),Ob=Ja.format(fc.textString,Object.assign({},
xc,{rangeStart:eb,rangeEnd:Sc,parser:function(Kc,Hb,$d){return wa(Kc,{allowReturnOutsideFunction:!0})}})),fc.undoManager.group(),pd=Ka.diffChars(fc.textString,Ob),fc.applyJsDiffPatch(pd),fc.selection.text=Qa(fc.selection.text),fc.undoManager.group(),Uc.return(!0)}})}}];Eb.jsIdeCommands=qc;Eb.jsIdeCommands=qc;Eb.jsIdeCommands=qc;var Cc=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(fc,xc){xc=fc.pluginInvokeFirst("getNavigator");if(!xc)return!0;xc=xc.resolveIdentifierAt(fc,fc.cursorPosition);
if(!xc||!xc.id)return Eb.show("No symbol identifier selected"),!0;if(!xc.decl)return Eb.show("Cannot find declaration of "+xc.name),!0;fc.saveMark();fc.selection={start:fc.indexToPosition(xc.decl.start),end:fc.indexToPosition(xc.decl.end)};fc.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(fc){fc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(fc){fc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(fc,xc){xc=void 0===xc?{direction:null}:xc;var bc=fc.pluginInvokeFirst("getNavigator");if(!bc)return!0;bc=bc.resolveIdentifierAt(fc,
fc.cursorPosition);if(!bc||!bc.refs)return Eb.show("No symbol identifier selected"),!0;var Qa=fc.selection;bc=bc.refs.map(function(ja){var Ba=ja.end;return Eb.Range.fromPositions(Eb.iToP(fc,ja.start),Eb.iToP(fc,Ba))}).concat(bc.decl?Eb.Range.fromPositions(Eb.iToP(fc,bc.decl.start),Eb.iToP(fc,bc.decl.end)):[]).sort(Eb.Range.compare);if(!bc.length)return!0;var Da=bc.map(String).indexOf(String(Qa.range));if("next"===xc.direction||"prev"===xc.direction)-1===Da&&bc.length?bc=[bc[0]]:(xc=Da+("next"===xc.direction?
1:-1),0>xc?xc=bc.length-1:xc>=bc.length&&(xc=0),bc=[bc[xc]]);bc.forEach(function(ja){var Ba=Qa.selections.findIndex(function(Fb){return Fb.range.equals(ja)}),Ja=Qa.selections.length-1;-1<Ba?Eb.arr.swap(Qa.selections,Ba,Ja):Qa.addRange(ja,!1)});Qa.mergeSelections();return!0}}];Eb.astEditorCommands=Cc;Eb.astEditorCommands=Cc;Eb.astEditorCommands=Cc;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var Yc=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
Yc.expressionAllowed=function(fc,xc,bc){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(xc.lastType)||"quasi"==xc.lastType&&/\{\s*$/.test(fc.string.slice(0,fc.pos-(bc||0)))};Yc.passIndent=Jd;Yc.defineMode=fe;Yc.defineMIME=Zb;Yc.registerHelper=Gc;Yc.defaultConfig={indentUnit:2};Yc.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};Yc.defineMode("javascript",
function(fc,xc){function bc(sc,nd,ee){dg=sc;qg=ee;return nd}function Qa(sc,nd){var ee=sc.next();if('"'==ee||"'"==ee)return nd.tokenize=Da(ee),nd.tokenize(sc,nd);if("."==ee&&sc.match(/^\d+(?:[eE][+\-]?\d+)?/))return bc("number","number");if("."==ee&&sc.match(".."))return bc("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(ee))return bc(ee);if("="==ee&&sc.eat(">"))return bc("=>","operator");if("0"==ee&&sc.eat(/x/i))return sc.eatWhile(/[\da-f]/i),bc("number","number");if("0"==ee&&sc.eat(/o/i))return sc.eatWhile(/[0-7]/i),
bc("number","number");if("0"==ee&&sc.eat(/b/i))return sc.eatWhile(/[01]/i),bc("number","number");if(/\d/.test(ee))return sc.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),bc("number","number");if("/"==ee){if(sc.eat("*"))return nd.tokenize=ja,ja(sc,nd);if(sc.eat("/"))return sc.skipToEnd(),bc("comment","comment");if(Yc.expressionAllowed(sc,nd,1)){a:for(var Hd=nd=!1;null!=(ee=sc.next());){if(!nd){if("/"==ee&&!Hd)break a;"["==ee?Hd=!0:Hd&&"]"==ee&&(Hd=!1)}nd=!nd&&"\\"==ee}sc.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return bc("regexp","string-2")}sc.eatWhile(Og);return bc("operator","operator",sc.current())}if("`"==ee)return nd.tokenize=Ba,Ba(sc,nd);if("#"==ee)return sc.skipToEnd(),bc("error","error");if(Og.test(ee))return">"==ee&&nd.lexical&&">"==nd.lexical.type||sc.eatWhile(Og),bc("operator","operator",sc.current());if(th.test(ee))return sc.eatWhile(th),sc=sc.current(),(ee=fi.propertyIsEnumerable(sc)&&fi[sc])&&"."!=nd.lastType?bc(ee.type,ee.style,sc):bc("variable","variable",sc)}function Da(sc){return function(nd,
ee){var Hd=!1,rf;if(ng&&"@"==nd.peek()&&nd.match(xf))return ee.tokenize=Qa,bc("jsonld-keyword","meta");for(;null!=(rf=nd.next())&&(rf!=sc||Hd);)Hd=!Hd&&"\\"==rf;Hd||(ee.tokenize=Qa);return bc("string","string")}}function ja(sc,nd){for(var ee=!1,Hd;Hd=sc.next();){if("/"==Hd&&ee){nd.tokenize=Qa;break}ee="*"==Hd}return bc("comment","comment")}function Ba(sc,nd){for(var ee=!1,Hd;null!=(Hd=sc.next());){if(!ee&&("`"==Hd||"$"==Hd&&sc.eat("{"))){nd.tokenize=Qa;break}ee=!ee&&"\\"==Hd}return bc("quasi","string-2",
sc.current())}function Ja(sc,nd){nd.fatArrowAt&&(nd.fatArrowAt=null);var ee=sc.string.indexOf("=>",sc.start);if(!(0>ee)){if(wf){var Hd=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(sc.string.slice(sc.start,ee));Hd&&(ee=Hd.index)}Hd=0;var rf=!1;for(--ee;0<=ee;--ee){var $f=sc.string.charAt(ee),fg="([{}])".indexOf($f);if(0<=fg&&3>fg){if(!Hd){++ee;break}if(0==--Hd){"("==$f&&(rf=!0);break}}else if(3<=fg&&6>fg)++Hd;else if(th.test($f))rf=!0;else{if(/["'\/]/.test($f))return;if(rf&&!Hd){++ee;break}}}rf&&
!Hd&&(nd.fatArrowAt=ee)}}function Fb(sc,nd,ee,Hd,rf,$f){this.indented=sc;this.column=nd;this.type=ee;this.prev=rf;this.info=$f;null!=Hd&&(this.align=Hd)}function wa(){for(var sc=arguments.length-1;0<=sc;sc--)Me.cc.push(arguments[sc])}function Ka(){wa.apply(null,arguments);return!0}function Rb(sc){function nd(Hd){for(;Hd;Hd=Hd.next)if(Hd.name==sc)return!0;return!1}var ee=Me.state;Me.marked="def";ee.context?nd(ee.localVars)||(ee.localVars={name:sc,next:ee.localVars}):!nd(ee.globalVars)&&xc.globalVars&&
(ee.globalVars={name:sc,next:ee.globalVars})}function eb(){Me.state.context={prev:Me.state.context,vars:Me.state.localVars};Me.state.localVars=gi}function Sc(){Me.state.localVars=Me.state.context.vars;Me.state.context=Me.state.context.prev}function Ob(sc,nd){var ee=function(){var Hd=Me.state,rf=Hd.indented;if("stat"==Hd.lexical.type)rf=Hd.lexical.indented;else for(var $f=Hd.lexical;$f&&")"==$f.type&&$f.align;$f=$f.prev)rf=$f.indented;Hd.lexical=new Fb(rf,Me.stream.column(),sc,null,Hd.lexical,nd)};
ee.lex=!0;return ee}function pd(){var sc=Me.state;sc.lexical.prev&&(")"==sc.lexical.type&&(sc.indented=sc.lexical.indented),sc.lexical=sc.lexical.prev)}function Uc(sc){function nd(ee){return ee==sc?Ka():";"==sc?wa():Ka(nd)}return nd}function Kc(sc,nd){return"var"==sc?Ka(Ob("vardef",nd.length),Ud,Uc(";"),pd):"keyword a"==sc?Ka(Ob("form"),Tb,Kc,pd):"keyword b"==sc?Ka(Ob("form"),Kc,pd):"{"==sc?Ka(Ob("}"),Nd,pd):";"==sc?Ka():"if"==sc?("else"==Me.state.lexical.info&&Me.state.cc[Me.state.cc.length-1]==
pd&&Me.state.cc.pop()(),Ka(Ob("form"),Tb,Kc,pd,hb)):"function"==sc?Ka(Fa):"for"==sc?Ka(Ob("form"),ab,Kc,pd):"variable"==sc?wf&&"type"==nd?(Me.marked="keyword",Ka(jf,Uc("operator"),jf,Uc(";"))):Ka(Ob("stat"),Rd):"switch"==sc?Ka(Ob("form"),Tb,Uc("{"),Ob("}","switch"),Nd,pd,pd):"case"==sc?Ka(Hb,Uc(":")):"default"==sc?Ka(Uc(":")):"catch"==sc?Ka(Ob("form"),eb,Uc("("),Ma,Uc(")"),Kc,pd,Sc):"class"==sc?Ka(Ob("form"),Nb,pd):"export"==sc?Ka(Ob("stat"),kd,pd):"import"==sc?Ka(Ob("stat"),ke,pd):"module"==sc?Ka(Ob("form"),
df,Uc("{"),Ob("}"),Nd,pd,pd):"async"==sc?Ka(Kc):"@"==nd?Ka(Hb,Kc):wa(Ob("stat"),Hb,Uc(";"),pd)}function Hb(sc){return Gb(sc,!1)}function $d(sc){return Gb(sc,!0)}function Tb(sc){return"("!=sc?wa():Ka(Ob(")"),Hb,Uc(")"),pd)}function Gb(sc,nd){if(Me.state.fatArrowAt==Me.stream.start){var ee=nd?vd:Tc;if("("==sc)return Ka(eb,Ob(")"),eg(df,")"),pd,Uc("=>"),ee,Sc);if("variable"==sc)return wa(eb,df,Uc("=>"),ee,Sc)}ee=nd?bb:Ha;return qh.hasOwnProperty(sc)?Ka(ee):"function"==sc?Ka(Fa,ee):"class"==sc?Ka(Ob("form"),
lb,pd):"keyword c"==sc||"async"==sc?Ka(nd?da:La):"("==sc?Ka(Ob(")"),La,Uc(")"),pd,ee):"operator"==sc||"spread"==sc?Ka(nd?$d:Hb):"["==sc?Ka(Ob("]"),De,pd,ee):"{"==sc?sf(z,"}",null,ee):"quasi"==sc?wa(Qb,ee):"new"==sc?Ka(Wd(nd)):Ka()}function La(sc){return sc.match(/[;\}\)\],]/)?wa():wa(Hb)}function da(sc){return sc.match(/[;\}\)\],]/)?wa():wa($d)}function Ha(sc,nd){return","==sc?Ka(Hb):bb(sc,nd,!1)}function bb(sc,nd,ee){var Hd=0==ee?Ha:bb,rf=0==ee?Hb:$d;if("=>"==sc)return Ka(eb,ee?vd:Tc,Sc);if("operator"==
sc)return/\+\+|--/.test(nd)?Ka(Hd):"?"==nd?Ka(Hb,Uc(":"),rf):Ka(rf);if("quasi"==sc)return wa(Qb,Hd);if(";"!=sc){if("("==sc)return sf($d,")","call",Hd);if("."==sc)return Ka(Fe,Hd);if("["==sc)return Ka(Ob("]"),La,Uc("]"),pd,Hd)}}function Qb(sc,nd){return"quasi"!=sc?wa():"${"!=nd.slice(nd.length-2)?Ka(Qb):Ka(Hb,uc)}function uc(sc){if("}"==sc)return Me.marked="string-2",Me.state.tokenize=Ba,Ka(Qb)}function Tc(sc){Ja(Me.stream,Me.state);return wa("{"==sc?Kc:Hb)}function vd(sc){Ja(Me.stream,Me.state);return wa("{"==
sc?Kc:$d)}function Wd(sc){return function(nd){return"."==nd?Ka(sc?He:ed):wa(sc?$d:Hb)}}function ed(sc,nd){if("target"==nd)return Me.marked="keyword",Ka(Ha)}function He(sc,nd){if("target"==nd)return Me.marked="keyword",Ka(bb)}function Rd(sc){return":"==sc?Ka(pd,Kc):wa(Ha,Uc(";"),pd)}function Fe(sc){if("variable"==sc)return Me.marked="property",Ka()}function z(sc,nd){if("async"==sc)return Me.marked="property",Ka(z);if("variable"==sc||"keyword"==Me.style)return Me.marked="property","get"==nd||"set"==
nd?Ka(Ce):Ka(Ke);if("number"==sc||"string"==sc)return Me.marked=ng?"property":Me.style+" property",Ka(Ke);if("jsonld-keyword"==sc)return Ka(Ke);if("modifier"==sc)return Ka(z);if("["==sc)return Ka(Hb,Uc("]"),Ke);if("spread"==sc)return Ka(Hb);if(":"==sc)return wa(Ke)}function Ce(sc){if("variable"!=sc)return wa(Ke);Me.marked="property";return Ka(Fa)}function Ke(sc){if(":"==sc)return Ka($d);if("("==sc)return wa(Fa)}function eg(sc,nd,ee){function Hd(rf,$f){return(ee?-1<ee.indexOf(rf):","==rf)?(rf=Me.state.lexical,
"call"==rf.info&&(rf.pos=(rf.pos||0)+1),Ka(function(fg,sl){return fg==nd||sl==nd?wa():wa(sc)},Hd)):rf==nd||$f==nd?Ka():Ka(Uc(nd))}return function(rf,$f){return rf==nd||$f==nd?Ka():wa(sc,Hd)}}function sf(sc,nd,ee){for(var Hd=3;Hd<arguments.length;Hd++)Me.cc.push(arguments[Hd]);return Ka(Ob(nd,ee),eg(sc,nd),pd)}function Nd(sc){return"}"==sc?Ka():wa(Kc,Nd)}function hf(sc,nd){if(wf){if(":"==sc)return Ka(jf);if("?"==nd)return Ka(hf)}}function jf(sc){if("variable"==sc)return Me.marked="variable-3",Ka(Pc);
if("string"==sc||"number"==sc||"atom"==sc)return Ka(Pc);if("{"==sc)return Ka(Ob("}"),eg(Xd,"}",",;"),pd);if("("==sc)return Ka(eg(ii,")"),Bf)}function Bf(sc){if("=>"==sc)return Ka(jf)}function Xd(sc,nd){if("variable"==sc||"keyword"==Me.style)return Me.marked="property",Ka(Xd);if("?"==nd)return Ka(Xd);if(":"==sc)return Ka(jf)}function ii(sc){if("variable"==sc)return Ka(ii);if(":"==sc)return Ka(jf)}function Pc(sc,nd){if("<"==nd)return Ka(Ob(">"),eg(jf,">"),pd,Pc);if("|"==nd||"."==sc)return Ka(jf);if("["==
sc)return Ka(Uc("]"),Pc);if("extends"==nd)return Ka(jf)}function Ud(){return wa(df,hf,Pe,Xa)}function df(sc,nd){if("modifier"==sc)return Ka(df);if("variable"==sc)return Rb(nd),Ka();if("spread"==sc)return Ka(df);if("["==sc)return sf(df,"]");if("{"==sc)return sf(yd,"}")}function yd(sc,nd){if("variable"==sc&&!Me.stream.match(/^\s*:/,!1))return Rb(nd),Ka(Pe);"variable"==sc&&(Me.marked="property");return"spread"==sc?Ka(df):"}"==sc?wa():Ka(Uc(":"),df,Pe)}function Pe(sc,nd){if("="==nd)return Ka($d)}function Xa(sc){if(","==
sc)return Ka(Ud)}function hb(sc,nd){if("keyword b"==sc&&"else"==nd)return Ka(Ob("form","else"),Kc,pd)}function ab(sc){if("("==sc)return Ka(Ob(")"),ma,Uc(")"),pd)}function ma(sc){return"var"==sc?Ka(Ud,Uc(";"),Ra):";"==sc?Ka(Ra):"variable"==sc?Ka(X):wa(Hb,Uc(";"),Ra)}function X(sc,nd){return"in"==nd||"of"==nd?(Me.marked="keyword",Ka(Hb)):Ka(Ha,Ra)}function Ra(sc,nd){return";"==sc?Ka(na):"in"==nd||"of"==nd?(Me.marked="keyword",Ka(Hb)):wa(Hb,Uc(";"),na)}function na(sc){")"!=sc&&Ka(Hb)}function Fa(sc,
nd){if("*"==nd)return Me.marked="keyword",Ka(Fa);if("variable"==sc)return Rb(nd),Ka(Fa);if("("==sc)return Ka(eb,Ob(")"),eg(Ma,")"),pd,hf,Kc,Sc);if(wf&&"<"==nd)return Ka(Ob(">"),eg(jf,">"),pd,Fa)}function Ma(sc){return"spread"==sc?Ka(Ma):wa(df,hf,Pe)}function lb(sc,nd){return"variable"==sc?Nb(sc,nd):ac(sc,nd)}function Nb(sc,nd){if("variable"==sc)return Rb(nd),Ka(ac)}function ac(sc,nd){if("<"==nd)return Ka(Ob(">"),eg(jf,">"),pd,ac);if("extends"==nd||"implements"==nd||wf&&","==sc)return Ka(wf?jf:Hb,
ac);if("{"==sc)return Ka(Ob("}"),Hc,pd)}function Hc(sc,nd){if("variable"==sc||"keyword"==Me.style){if(("async"==nd||"static"==nd||"get"==nd||"set"==nd||wf&&("public"==nd||"private"==nd||"protected"==nd||"readonly"==nd||"abstract"==nd))&&Me.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Me.marked="keyword",Ka(Hc);Me.marked="property";return Ka(wf?Lc:Fa,Hc)}if("["==sc)return Ka(Hb,Uc("]"),wf?Lc:Fa,Hc);if("*"==nd)return Me.marked="keyword",Ka(Hc);if(";"==sc)return Ka(Hc);if("}"==sc)return Ka();if("@"==
nd)return Ka(Hb,Hc)}function Lc(sc,nd){return"?"==nd?Ka(Lc):":"==sc?Ka(jf,Pe):"="==nd?Ka($d):wa(Fa)}function kd(sc,nd){return"*"==nd?(Me.marked="keyword",Ka(le,Uc(";"))):"default"==nd?(Me.marked="keyword",Ka(Hb,Uc(";"))):"{"==sc?Ka(eg(Sd,"}"),le,Uc(";")):wa(Kc)}function Sd(sc,nd){if("as"==nd)return Me.marked="keyword",Ka(Uc("variable"));if("variable"==sc)return wa($d,Sd)}function ke(sc){return"string"==sc?Ka():wa(Gd,ye,le)}function Gd(sc,nd){if("{"==sc)return sf(Gd,"}");"variable"==sc&&Rb(nd);"*"==
nd&&(Me.marked="keyword");return Ka(xe)}function ye(sc){if(","==sc)return Ka(Gd,ye)}function xe(sc,nd){if("as"==nd)return Me.marked="keyword",Ka(Gd)}function le(sc,nd){if("from"==nd)return Me.marked="keyword",Ka(Hb)}function De(sc){return"]"==sc?Ka():wa(eg($d,"]"))}fc=Object.assign({},Yc.defaultConfig,{},fc);xc=Object.assign({},Yc.defaultParserConfig,{},xc);var Gf=fc.indentUnit,cg=xc.statementIndent,ng=xc.jsonld,Wf=xc.json||ng,wf=xc.typescript,th=xc.wordCharacters||/[\w$\xa1-\uffff]/,fi=function(){function sc(sl){return{type:sl,
style:"keyword"}}var nd=sc("keyword a"),ee=sc("keyword b"),Hd=sc("keyword c"),rf=sc("operator"),$f={type:"atom",style:"atom"};nd={if:sc("if"),while:nd,with:nd,else:ee,do:ee,try:ee,finally:ee,return:Hd,break:Hd,continue:Hd,new:sc("new"),delete:Hd,throw:Hd,debugger:Hd,var:sc("var"),const:sc("var"),let:sc("var"),function:sc("function"),catch:sc("catch"),for:sc("for"),switch:sc("switch"),case:sc("case"),default:sc("default"),in:rf,typeof:rf,instanceof:rf,true:$f,false:$f,null:$f,undefined:$f,NaN:$f,Infinity:$f,
this:sc("this"),class:sc("class"),super:sc("atom"),yield:Hd,export:sc("export"),import:sc("import"),extends:Hd,await:Hd,async:sc("async")};if(wf){ee={type:"variable",style:"variable-3"};Hd={interface:sc("class"),implements:Hd,namespace:Hd,module:sc("module"),enum:sc("module"),public:sc("modifier"),private:sc("modifier"),protected:sc("modifier"),abstract:sc("modifier"),as:rf,string:ee,number:ee,boolean:ee,any:ee};for(var fg in Hd)nd[fg]=Hd[fg]}return nd}(),Og=/[+\-*&%=<>!?|~^@]/,xf=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
dg,qg,qh={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Me={state:null,column:null,marked:null,cc:null},gi={name:"this",next:{name:"arguments"}};pd.lex=!0;return{startState:function(sc){sc={tokenize:Qa,lastType:"sof",cc:[],lexical:new Fb((sc||0)-Gf,0,"block",!1),localVars:xc.localVars,context:xc.localVars&&{vars:xc.localVars},indented:sc||0};xc.globalVars&&"object"===typeof xc.globalVars&&(sc.globalVars=xc.globalVars);return sc},token:function(sc,nd){sc.sol()&&(nd.lexical.hasOwnProperty("align")||
(nd.lexical.align=!1),nd.indented=sc.indentation(),Ja(sc,nd));if(nd.tokenize!=ja&&sc.eatSpace())return null;var ee=nd.tokenize(sc,nd);if("comment"==dg)return ee;nd.lastType="operator"!=dg||"++"!=qg&&"--"!=qg?dg:"incdec";a:{var Hd=dg,rf=qg,$f=nd.cc;Me.state=nd;Me.stream=sc;Me.marked=null;Me.cc=$f;Me.style=ee;nd.lexical.hasOwnProperty("align")||(nd.lexical.align=!0);for(sc=0;;){if(1E5<sc++)throw Error("endless");if(($f.length?$f.pop():Wf?Hb:Kc)(Hd,rf)){for(;$f.length&&$f[$f.length-1].lex;)$f.pop()();
if(Me.marked){ee=Me.marked;break a}if(Hd="variable"==Hd)b:{for(Hd=nd.localVars;Hd;Hd=Hd.next)if(Hd.name==rf){Hd=!0;break b}for(nd=nd.context;nd;nd=nd.prev)for(Hd=nd.vars;Hd;Hd=Hd.next)if(Hd.name==rf){Hd=!0;break b}Hd=void 0}if(Hd){ee="variable-2";break a}break a}}}return ee},indent:function(sc,nd){if(sc.tokenize==ja)return Yc.passIndent;if(sc.tokenize!=Qa)return 0;var ee=nd&&nd.charAt(0),Hd=sc.lexical,rf;if(!/^\s*else\b/.test(nd))for(var $f=sc.cc.length-1;0<=$f;--$f){var fg=sc.cc[$f];if(fg==pd)Hd=
Hd.prev;else if(fg!=hb)break}for(;!("stat"!=Hd.type&&"form"!=Hd.type||"}"!=ee&&(!(rf=sc.cc[sc.cc.length-1])||rf!=Ha&&rf!=bb||/^[,\.=+\-*:?[\(]/.test(nd)));)Hd=Hd.prev;cg&&")"==Hd.type&&"stat"==Hd.prev.type&&(Hd=Hd.prev);rf=Hd.type;$f=ee==rf;return(fg=sc._string)&&fg.trimLeft().startsWith("?")&&":"===ee?fg.indexOf("?"):fg&&":"===sc.lastType&&"}"!==Hd.type?fg.match(/^\s*/)[0].length:"vardef"==rf?(nd=Hd.indented+Hd.info+2+sc.localVars.name.length,"?"===ee||":"===ee||"|"===ee||"&"===ee?nd:","==sc.lastType?
Hd.indented+Hd.info+1:"operator"==sc.lastType?nd+3:Hd.indented):"form"==rf&&"{"==ee?Hd.indented:"form"==rf?Hd.indented+Gf:"stat"==rf?(ee=Hd.indented,sc="operator"==sc.lastType||","==sc.lastType||Og.test(nd.charAt(0))||/[,.]/.test(nd.charAt(0)),ee+(sc?cg||Gf:0)):"switch"!=Hd.info||$f||0==xc.doubleIndentSwitch?Hd.align?Hd.column+($f?0:1):Hd.indented+($f?0:Gf):Hd.indented+(/^(?:case|default)\b/.test(nd)?Gf:2*Gf)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:Wf?null:"/*",blockCommentEnd:Wf?
null:"*/",lineComment:Wf?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:Wf?"json":"javascript",jsonldMode:ng,jsonMode:Wf,expressionAllowed:Yc.expressionAllowed,skipExpression:function(sc){var nd=sc.cc[sc.cc.length-1];nd!=Hb&&nd!=$d||sc.cc.pop()}}});Yc.registerHelper("wordChars","javascript",/[\w$]/);Yc.defineMIME("text/javascript","javascript");Yc.defineMIME("text/ecmascript","javascript");Yc.defineMIME("application/javascript","javascript");Yc.defineMIME("application/x-javascript",
"javascript");Yc.defineMIME("application/ecmascript","javascript");Yc.defineMIME("application/json",{name:"javascript",json:!0});Yc.defineMIME("application/x-json",{name:"javascript",json:!0});Yc.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});Yc.defineMIME("text/typescript",{name:"javascript",typescript:!0});Yc.defineMIME("application/typescript",{name:"javascript",typescript:!0});var rd=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");rd.string=Wc;rd.JavaScriptChecker=
Mb;rd.JavaScriptNavigator=Ad;rd.completers=ec;rd.jsSnippets=hc;rd.jsIdeCommands=qc;rd.jsEditorCommands=Ua;rd.astEditorCommands=Cc;rd.CodeMirrorEnabledEditorPlugin=xd;rd.Snippet=Ac;rd.parser=jd;rd.localInterface=gc;rd.systemInterfaceNamed=$c;rd.serverInterfaceFor=Bd;rd.l2lInterfaceFor=fd;Mb=function(fc){var xc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),bc=xc.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof xc.JavaScriptEditorPlugin?xc.JavaScriptEditorPlugin:xc.JavaScriptEditorPlugin=
function(Qa){Qa&&Qa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(bc,fc,[{key:Symbol.for("lively-instance-initialize"),value:function(){Lb._get(Object.getPrototypeOf(bc.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new rd.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(Qa){Lb._get(Object.getPrototypeOf(bc.prototype),"attach",this).call(this,Qa);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:Qa})}},{key:"detach",value:function(Qa){this.checker.uninstall(this.textMorph);Lb._get(Object.getPrototypeOf(bc.prototype),"detach",this).call(this,Qa)}},{key:"getNavigator",value:function(){return new rd.JavaScriptNavigator}},{key:"getCompleters",value:function(Qa){return rd.completers.concat(Qa)}},
{key:"getCommands",value:function(Qa){return[].concat($jscomp.arrayFromIterable(Lb._get(Object.getPrototypeOf(bc.prototype),"getCommands",this).call(this,Qa)),$jscomp.arrayFromIterable(rd.jsIdeCommands),$jscomp.arrayFromIterable(rd.jsEditorCommands),$jscomp.arrayFromIterable(rd.astEditorCommands))}},{key:"getKeyBindings",value:function(Qa){return[].concat($jscomp.arrayFromIterable(Qa),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(Qa){var Da=this,ja,Ba,Ja,Fb,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){ja=Da.textMorph;Ba=[{command:"doit",target:ja,showKeyShortcuts:!0},{command:"inspectit",target:ja,showKeyShortcuts:!0},{command:"editit",target:ja,showKeyShortcuts:!0},{command:"printit",target:ja,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:ja,showKeyShortcuts:!0},{command:"eval all",target:ja,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:ja,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:ja,showKeyShortcuts:!0},{isDivider:!0}];Da.evalEnvironment.targetModule&&Ba.push({command:"[javascript] inject import",alias:"add import",target:ja},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:ja},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:ja});Ja=Da.getNavigator();(Fb=Ja.resolveIdentifierAt(ja,
ja.cursorPosition))&&Ba.push({command:"selectDefinition",alias:'jump to definition of "'+Fb.name+'"',target:ja},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+Fb.name+'"',target:ja});(wa=ja.selection.text.trim())&&Ba.push({command:"open code search",alias:'code search for "'+rd.string.truncate(wa,30)+'"',target:ja.world(),args:{input:wa,backend:Da.backend()}});Ba.push({isDivider:!0});return Ka.return(Ba.concat(Qa))})}},{key:"getSnippets",value:function(){return rd.jsSnippets.map(function(Qa){var Da=
$jscomp.makeIterator(Qa);Qa=Da.next().value;Da=Da.next().value;return new rd.Snippet({trigger:Qa,expansion:Da})})}},{key:"sanatizedJsEnv",value:function(Qa){Qa=Object.assign({},this.evalEnvironment,{},Qa);Qa.format||(Qa.formatd="esm");Qa.context||(Qa.context=this.textMorph);Qa.sourceURL||(Qa.sourceURL=Qa.targetModule+"_doit_"+Date.now());Qa.systemInterface||(Qa.systemInterface=rd.localInterface);return Qa}},{key:"backend",value:function(Qa){Qa=this.sanatizedJsEnv(Qa);return Qa.remote?Qa.remote:"local"}},
{key:"systemInterface",value:function(Qa){return this.sanatizedJsEnv(Qa).systemInterface||rd.localInterface}},{key:"setSystemInterface",value:function(Qa){return this.evalEnvironment.systemInterface=Qa}},{key:"setSystemInterfaceNamed",value:function(Qa){return this.setSystemInterface(rd.systemInterfaceNamed(Qa))}},{key:"runEval",value:function(Qa,Da){Da=this.sanatizedJsEnv(Da);return this.systemInterface(Da).runEval(Qa,Da)}},{key:"parser",get:function(){return rd.parser}},{key:"parse",value:function(Qa){Qa=
void 0===Qa?null:Qa;if(this._ast&&this._ast._astType===Qa)return this._ast;var Da=this.parser,ja=this.textMorph.textString;if(!Da)return null;var Ba={withComments:!0,allowReturnOutsideFunction:!0};Qa&&(Ba.type=Qa);if(ja.startsWith("#!")){var Ja=ja.indexOf("\n");ja=" ".repeat(Ja)+ja.slice(Ja)}Da=Da.fuzzyParse(ja,Ba);Da._astType=Qa;return this._ast=Da}},{key:"undeclaredVariables",value:function(Qa){var Da=this.parser,ja=this.evalEnvironment.knownGlobals||[];Qa=this.parse(void 0===Qa?null:Qa);return Da&&
Qa?Da.query.findGlobalVarRefs(Qa,{jslintGlobalComment:!0}).filter(function(Ba){return!ja.includes(Ba.name)}):[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],xc,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(rd.CodeMirrorEnabledEditorPlugin);
Mb=rd.JavaScriptEditorPlugin;Pa("default",Mb);rd.default=Mb}}});
System.register(["./__root_module__-3c9a1ccb.js","./index-f326120b.js","./index-d6506ab5.js"],function(sa){var lb,Eb,Wb,Qb,Bd,Fc,wd,Kc,Gc,Yc,jd,Dd,od,Zc,Ra,tb,dc,bc,Xc,Oc,$b,zc,Fb,Cb,pc,Pc,wb,db,Ta,cb,ma,La,fb,pb,xb,Wa,Xa,Ab,kc,Ub,qc,wc,I,T,ta;return{setters:[function(Ca){lb=Ca.C;Eb=Ca.aq;Wb=Ca.a4;Qb=Ca.$;Bd=Ca.a1;Fc=Ca.al;wd=Ca.be;Kc=Ca.aS;Gc=Ca.ao;Yc=Ca.s;jd=Ca.aN;Dd=Ca.bl;od=Ca.bm;Zc=Ca.a5;Ra=Ca.as;tb=Ca.an;dc=Ca.ap;bc=Ca.bn;Xc=Ca.bo;Oc=Ca.a0;$b=Ca.P;zc=Ca._;Fb=Ca.aU;Cb=Ca.ag;pc=Ca.ah;Pc=Ca.ai;
wb=Ca.aj;db=Ca.az;Ta=Ca.aX;cb=Ca.av;ma=Ca.am;La=Ca.a8;fb=Ca.bp;pb=Ca.L;xb=Ca.bq;Wa=Ca.b0;Xa=Ca.bf;Ab=Ca.a$;kc=Ca.br;Ub=Ca.ar},function(Ca){qc=Ca.M;wc=Ca.I;I=Ca.v;T=Ca.p},function(Ca){ta=Ca.localInterface}],execute:function(){function Ca(va,Ka){if(!0===Ka)return Ka;if(va.copyState)return va.copyState(Ka);va={};for(var sb in Ka){var Q=Ka[sb];Q instanceof Array&&(Q=Q.concat([]));va[sb]=Q}return va}function Mb(va,Ka,sb){return va.startState?va.startState(Ka,sb):!0}function vb(va,Ka){return H.modes[va]=
Ka}function Ia(va){if("string"==typeof va&&H.mimeModes.hasOwnProperty(va))va=H.mimeModes[va];else if(va&&"string"==typeof va.name&&H.mimeModes.hasOwnProperty(va.name)){var Ka=H.mimeModes[va.name];"string"==typeof Ka&&(Ka={name:Ka});va=Object.assign({},Ka,va);va.name=Ka.name}else{if("string"==typeof va&&/^[\w\-]+\/[\w\-]+\+xml$/.test(va))return Ia("application/xml");if("string"==typeof va&&/^[\w\-]+\/[\w\-]+\+json$/.test(va))return Ia("application/json")}return"string"==typeof va?{name:va}:va||{name:"null"}}
function Rb(va,Ka){Ka=H.resolveMode(Ka);"string"===typeof Ka&&(Ka={name:Ka});if(!Ka.name)throw Error("parserConfig does not have a name of the mode to get");var sb=H.modes[Ka.name];if(!sb)return Rb(va,"text/plain");va=Object.assign({indentUnit:2},va);return Object.assign(sb(va,Ka),{name:Ka.name})}function Jc(va,Ka){for(var sb;va.innerMode;){sb=va.innerMode(Ka);if(!sb||sb.mode==va)break;Ka=sb.state;va=sb.mode}return sb||{mode:va,state:Ka}}function Rc(va,Ka){H.mimeModes[va]=Ka}function xc(va,Ka,sb){}
function Fa(va,Ka,sb,Q,ua,Za,ib){var oc=va.editorPlugin._tokenizerValidBefore;oc&&oc.row>=sb&&(oc.row=sb-1);var cc=H.linesToTokenize(va.document,sb,Q,oc);oc=cc.lines;cc=cc.state;if(!oc.length)return!1;cc=cc?H.copyState(Ka,cc):H.startState(Ka);for(var ad=0;ad<oc.length;ad++){var Tc=oc[ad],Vc=Tc.row;Vc>=sb&&Vc<=Q&&H.indentLine(va,Ka,Tc,cc,ua,Za,ib);cc=H.tokenizeLine(Ka,oc[ad],cc,function(){})}return!0}function nc(va,Ka,sb,Q,ua,Za,ib){Ka=H.linesToTokenize(Ka,sb,Q,ua);sb=Ka.lines;H.tokenizeLines(va,sb,
Ka.state,Za,ib);return sb}function $a(va,Ka,sb,Q,ua){var Za=[],ib,oc=function(Tc){return Za.push(ib=[])},cc=function(Tc,Vc,Yd,Mf,Bf,Hg,df){return ib.push(Yd,Mf,Tc,Bf.current(),Vc.localMode||df)};try{var ad=H.visitDocumentTokens(va,Ka,sb,Q,ua,oc,cc)}catch(Tc){Za.length=0,ad=H.visitDocumentTokens(va,Ka,sb,Q,null,oc,cc)}return{tokens:Za,lines:ad}}function Pa(va,Ka,sb,Q,ua){null==Ka&&(Ka=va.search(/[^\s\u00a0]/),-1==Ka&&(Ka=va.length));Q=Q||0;for(ua=ua||0;;){var Za=va.indexOf("\t",Q);if(0>Za||Za>=Ka)return ua+
(Ka-Q);ua+=Za-Q;ua+=sb-ua%sb;Q=Za+1}}function Oa(va){va=va.toLowerCase();for(var Ka=0;Ka<H.modeInfo.length;Ka++){var sb=H.modeInfo[Ka];if(sb.mime==va)return sb;if(sb.mimes)for(var Q=0;Q<sb.mimes.length;Q++)if(sb.mimes[Q]==va)return sb}if(/\+xml$/.test(va))return Oa("application/xml");if(/\+json$/.test(va))return Oa("application/json")}function Kb(va){for(var Ka=0;Ka<H.modeInfo.length;Ka++){var sb=H.modeInfo[Ka];if(sb.ext)for(var Q=0;Q<sb.ext.length;Q++)if(sb.ext[Q]==va)return sb}}function Ib(va){for(var Ka=
0;Ka<H.modeInfo.length;Ka++){var sb=H.modeInfo[Ka];if(sb.file&&sb.file.test(va))return sb}Ka=va.lastIndexOf(".");if(va=-1<Ka&&va.substring(Ka+1,va.length))return H.findModeByExtension(va)}function bd(va){va=va.toLowerCase();for(var Ka=0;Ka<H.modeInfo.length;Ka++){var sb=H.modeInfo[Ka];if(sb.name.toLowerCase()==va)return sb;if(sb.alias)for(var Q=0;Q<sb.alias.length;Q++)if(sb.alias[Q].toLowerCase()==va)return sb}}function Od(va){if(!va)return String(va);if(Array.isArray(va))return"["+va.map(Od).join(",")+
"]";if("symbol"===typeof va)return hd.printSymbol(va);try{return String(va)}catch(Ka){return"Cannot print object: "+Ka}}function Zd(va,Ka){return!hd.arr.every(Ka.map(function(sb){return va[sb]}),function(sb){return hd.obj.equals(sb,va&&va.valueOf())})}function Te(va){if(hd.obj.isPrimitive(va))var Ka=hd.string.print(va);else Array.isArray(va)?((Ka=3<va.length)&&(va=va.slice(0,3)),va=hd.string.print(va),Ka&&(va=va.slice(0,-1)+", ...]"),Ka=va):Ka=hd.string.print(va);Ka=Ka.replace(/\n/g,"");500<Ka.length&&
(Ka=Ka.slice(0,20)+("...["+(Ka.length-20)+' CHARS]"'));return Ka}function Qc(va){return vc.Inspector.openInWindow({targetObject:va})}function Xd(va,Ka){return vc.Inspector.openInWindow({remoteTarget:{code:va,evalEnvironment:Ka}})}function kd(va,Ka){function sb(oc){var cc=oc.name,ad=oc.ownerChain(),Tc=oc.owner,Vc=oc.world(),Yd;oc===Za&&(Yd=[ib]);Vc===oc&&(Yd=["$world"]);if(!Yd&&cc&&Tc){Tc===Vc&&1===vc.arr.count(vc.arr.pluck(Vc.submorphs,"name"),cc)&&(Yd=['$world.get("'+cc+'")']);if(!Yd&&Tc!=Vc)for(Vc=
ad.length-1;Vc--;)if(1===ad[Vc].getAllNamed(cc).length){Yd=[].concat($jscomp.arrayFromIterable(sb(ad[Vc])),['get("'+cc+'")']);break}Yd||(cc=[].concat($jscomp.arrayFromIterable(sb(Tc)),['get("'+cc+'")']),vc.syncEval(cc.join("."),{context:Za}).value===oc&&(Yd=cc))}Yd||(Yd=[ib+'.getMorphById("'+oc.id+'")']);return Yd}Ka=void 0===Ka?{}:Ka;var Q=va.world(),ua=Ka;Ka=void 0===ua.maxLength?10:ua.maxLength;var Za=void 0===ua.fromMorph?Q:ua.fromMorph;if(Za===va)return"this";var ib=Q===Za?"$world":"this";if(!(Q||
va.name&&Za.get(va.name)===va))return"morph";Q=sb(va);return Q.length>Ka?'$world.getMorphWithId("'+va.id+'")':Q.join(".")}function Bb(va,Ka,sb){var Q=(Ka=void 0===Ka?"":Ka)&&ye.arr.last(Ka.split(".")).toLowerCase(),ua="",Za=0,ib=Math.pow(2,19);if("string"===typeof va){if(va.length>ib)return null}else if(va.document.stringSize>ib)return null;if("string"===typeof va)ua=va.slice(0,1E3);else for(va=$jscomp.makeIterator(va.document.lines),ib=va.next();!ib.done;ib=va.next()){var oc=ib.value;ib=oc.stringSize;
oc=oc.text;var cc=!0;1E3<Za+ib&&(cc=!1,ib=1E3-Za);ua+=oc.slice(0,ib)+(cc?"\n":"");Za+=ib;if(1E3<=Za)break}Za=$jscomp.makeIterator(ye.modeInfo);for(va=Za.next();!va.done;va=Za.next()){cc=va.value;ib=cc.contentTest;va=cc.mode;oc=cc.ext;cc=cc.file;if("function"===typeof ib)try{if(ib(ua))return va}catch(ad){}if(cc&&cc instanceof RegExp&&cc.test(Ka))return va;if(oc)for(ib=$jscomp.makeIterator(oc),oc=ib.next();!oc.done;oc=ib.next())if(oc.value===Q)return va}return sb}sa({a:Rc,d:vb,r:xc});var da=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");
da.Color=lb;var ra=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),sb=Ka.hasOwnProperty("DefaultTheme")&&"function"===typeof Ka.DefaultTheme?Ka.DefaultTheme:Ka.DefaultTheme=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:"background",get:function(){return da.Color.white}},{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",
fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},
{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},
{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},
{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},
{key:"diff-file-header",get:function(){return{fontColor:da.Color.white,fontWeight:"bold",backgroundColor:da.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:da.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:da.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],
[{key:"className",get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ka,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2867})}(void 0),ub=ra=da.DefaultTheme;da.default=ra;var H=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");
H.copyState=Ca;H.startState=Mb;H.defineMode=vb;H.resolveMode=Ia;H.getMode=Rb;H.innerMode=Jc;H.defineMIME=Rc;H.registerHelper=xc;H.indentLines=Fa;H.indentLine=function(va,Ka,sb,Q,ua,Za,ib){ib=Object.assign({indentWithTabs:!va.useSoftTabs,indentUnit:va.tabWidth,tabSize:4,ignoreFollowingText:!1},ib);null==ua&&(ua="add");"smart"==ua&&(Ka.indent||(ua="prev"));var oc=ib.tabSize,cc=sb.text,ad=H.countColumn(cc,null,oc);sb.modeState&&(sb.modeState=null);var Tc=cc.match(/^\s*/)[0];if(!Za&&!/\S/.test(cc)){var Vc=
0;ua="not"}else if("smart"==ua&&(Vc=Ka.indent(Q,ib.ignoreFollowingText?"":cc.slice(Tc.length),cc),Vc==H.passIndent||150<Vc)){if(!Za)return;ua="prev"}"prev"==ua?Vc=0<sb.row?H.countColumn(sb.prevLine().text,null,oc):0:"add"==ua?Vc=ad+ib.indentUnit:"subtract"==ua?Vc=ad-ib.indentUnit:"number"==typeof ua&&(Vc=ad+ua);Vc=Math.max(0,Vc);Ka="";Q=0;if(ib.indentWithTabs)for(ib=Math.floor(Vc/oc);ib;--ib)Q+=oc,Ka+="\t";Q<Vc&&(Ka+=" ".repeat(Vc-Q));if(Ka!=Tc)return va.replace({start:{row:sb.row,column:0},end:{row:sb.row,
column:Tc.length}},Ka),!0};H.tokenizeLines=function(va,Ka,sb,Q,ua){if(Ka.length){sb=sb?H.copyState(va,sb):H.startState(va);for(var Za=0;Za<Ka.length;Za++){var ib=Ka[Za];Q(ib);sb=H.tokenizeLine(va,ib,sb,ua)}}};H.tokenizeLine=function(va,Ka,sb,Q){var ua=Ka.text;if(!ua)return sb;var Za=new H.StringStream(ua,2);sb=Ka.modeState="function"===typeof va.copyState?va.copyState(sb):H.copyState(va,sb);Ka.prevLine();for(sb._string=ua;!Za.eol();)ua=va.token(Za,sb),Q(ua,sb,Za.start,Za.pos,Za,Ka,va),Za.start=Za.pos;
return sb};H.printTokens=function(va){for(var Ka="",sb=0;sb<va.length;sb+=5)Ka+=va[sb+0]+" => "+va[sb+1]+" "+va[sb+2]+" "+va[sb+3]+" "+va[sb+4].name+"\n";return Ka};H.visitDocumentTokens=nc;H.tokenizeDocument=$a;H.linesToTokenize=function(va,Ka,sb,Q){if(Q&&Q.row>=sb)return{lines:[],state:null};Ka=Q?Math.max(0,Q.row-1):Ka;var ua=va.getLine(Ka),Za=ua.text;va=[ua];Q=null;for(var ib=0,oc;(oc=ua.prevLine())&&50>ib++;){ua=oc;if(ua.modeState){Q=ua.modeState;break}va.unshift(ua)}if(!Q){for(var cc=ua,ad=Infinity;(oc=
ua.prevLine())&&100>ib++;){ua=oc;if(ua.modeState){Q=ua.modeState;break}va.unshift(ua);oc=Za.match(/^\s*/)[0].length;if(0===oc)break;oc<ad&&(ad=oc,cc=ua)}!Q&&0<ad&&(va=va.slice(va.indexOf(cc)))}if(sb>Ka)for(ua=H.arr.last(va);Ka<=sb;Ka++){ua=ua.nextLine();if(!ua)break;va.push(ua)}return{lines:va,state:Q}};H.countColumn=Pa;H.findModeByMIME=Oa;H.findModeByExtension=Kb;H.findModeByFileName=Ib;H.findModeByName=bd;H.arr=Wb;ra=H.modes||{};H.modes=ra;H.modes=ra;H.modes=ra;ra=sa("p",{});H.passIndent=ra;H.passIndent=
ra;H.passIndent=ra;H.copyState=Ca;H.copyState=Ca;H.startState=Mb;H.startState=Mb;H.defineMode=vb;H.defineMode=vb;H.resolveMode=Ia;H.resolveMode=Ia;H.getMode=Rb;H.getMode=Rb;H.innerMode=Jc;H.innerMode=Jc;ra={};H.mimeModes=ra;H.mimeModes=ra;H.mimeModes=ra;H.defineMIME=Rc;H.defineMIME=Rc;H.registerHelper=xc;H.registerHelper=xc;H.indentLines=Fa;H.indentLines=Fa;H.visitDocumentTokens=nc;H.visitDocumentTokens=nc;H.tokenizeDocument=$a;H.tokenizeDocument=$a;H.countColumn=Pa;H.countColumn=Pa;(function(va){var Ka=
lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),sb=Ka.hasOwnProperty("StringStream")&&"function"===typeof Ka.StringStream?Ka.StringStream:Ka.StringStream=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(Q,ua){this.reset(Q,ua)}},{key:"reset",value:function(Q,ua){this.pos=this.start=0;this.string=void 0===Q?"":Q;this.tabSize=void 0===
ua?2:ua;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(Q){var ua=this.string.charAt(this.pos);if("string"==typeof Q?ua==Q:ua&&(Q.test?Q.test(ua):Q(ua)))return++this.pos,
ua}},{key:"eatWhile",value:function(Q){for(var ua=this.pos;this.eat(Q););return this.pos>ua}},{key:"eatSpace",value:function(){for(var Q=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>Q}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(Q){Q=this.string.indexOf(Q,this.pos);if(-1<Q)return this.pos=Q,!0}},{key:"backUp",value:function(Q){this.pos-=Q}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=
H.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?H.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return H.countColumn(this.string,null,this.tabSize)-(this.lineStart?H.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(Q,ua,Za){if("string"==typeof Q){var ib=function(cc){return Za?cc.toLowerCase():cc},
oc=this.string.substr(this.pos,Q.length);if(ib(oc)==ib(Q))return!1!==ua&&(this.pos+=Q.length),!0}else{if((Q=this.string.slice(this.pos).match(Q))&&0<Q.index)return null;Q&&!1!==ua&&(this.pos+=Q[0].length);return Q}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(Q,ua){this.lineStart+=Q;try{return ua()}finally{this.lineStart-=Q}}}],[{key:"className",get:function(){return"StringStream"}}],Ka,{pathInPackage:function(){return"editor-modes.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);ra=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",
mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj",
"cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",
mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff",
"patch"],contentTest:function(va){return va.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},
{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth",
"fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy",
"gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",
ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],
mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",
mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",
mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",
mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},
{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",
mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",
mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash",
"sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(va){return va.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},
{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",
mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",
mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",
mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml",
"text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",
mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];H.modeInfo=ra;H.modeInfo=ra;H.modeInfo=ra;for(var ia=0;ia<H.modeInfo.length;ia++)H.info=H.modeInfo[ia],H.info.mimes&&(H.info.mime=H.info.mimes[0]);H.defineMode("null",function(){return{token:function(va){return va.skipToEnd()}}});H.defineMIME("text/plain","null");H.findModeByMIME=Oa;H.findModeByMIME=Oa;H.findModeByExtension=Kb;H.findModeByExtension=Kb;H.findModeByFileName=Ib;H.findModeByFileName=Ib;H.findModeByName=bd;H.findModeByName=bd;var Ba=
lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Ba.Color=lb;Ba.Rectangle=Qb;Ba.pt=Bd;Ba.morph=Fc;Ba.ShadowObject=wd;Ba.StyleSheet=Kc;Ba.connect=Gc;Ba.arr=Wb;Ba.string=Yc;Ba.FilterableList=jd;Ba.Range=Dd;ia=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),sb=Ka.hasOwnProperty("Completer")&&"function"===typeof Ka.Completer?Ka.Completer:Ka.Completer=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Eb(sb,va,[{key:"compute",value:function(){return[]}}],[{key:"className",get:function(){return"Completer"}}],Ka,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:345,end:391})}(void 0);Ba.Completer=ia;Ba.Completer=ia;Ba.Completer=ia;ia=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
sb=Ka.hasOwnProperty("WordCompleter")&&"function"===typeof Ka.WordCompleter?Ka.WordCompleter:Ka.WordCompleter=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:"compute",value:function(Q,ua){var Za=[],ib=[],oc=Q.document.lineStrings;Q=Q.cursorPosition.row;for(var cc=Q-1;0<=cc;cc--)for(var ad=$jscomp.makeIterator(oc[cc].split(/[^0-9a-z@_]+/i)),Tc=ad.next();!Tc.done;Tc=ad.next())(Tc=Tc.value)&&!Za.includes(Tc)&&
Tc!==ua&&(Za.push(Tc),ib.push({priority:1E3-(Q-cc),completion:Tc}));for(cc=Q+1;cc<oc.length;cc++)for(ad=$jscomp.makeIterator(oc[cc].split(/[^0-9a-z_@]+/i)),Tc=ad.next();!Tc.done;Tc=ad.next())(Tc=Tc.value)&&!Za.includes(Tc)&&Tc!==ua&&(Za.push(Tc),ib.push({priority:1E3-(cc-Q),completion:Tc}));return ib}}],[{key:"className",get:function(){return"WordCompleter"}}],Ka,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:400,end:1228})}(void 0);Ba.WordCompleter=ia;Ba.WordCompleter=ia;Ba.WordCompleter=ia;ia=[new Ba.WordCompleter];Ba.defaultCompleters=ia;Ba.defaultCompleters=ia;Ba.defaultCompleters=ia;ia=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),sb=Ka.hasOwnProperty("CompletionController")&&"function"===typeof Ka.CompletionController?Ka.CompletionController:Ka.CompletionController=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(Q,ua){ua=void 0===ua?[]:ua;this.textMorph=Q;this.completers=ua=Q.pluginCollect("getCompleters",ua)}},{key:"computeCompletions",value:function(Q){var ua=this,Za,ib,oc,cc,ad,Tc,Vc,Yd,Mf,Bf,Hg,df,Bg,Di,Pg,Nj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oe){switch(Oe.nextAddress){case 1:Za=[],ib=$jscomp.makeIterator(ua.completers),oc=ib.next();
case 2:if(oc.done){Oe.jumpTo(4);break}cc=oc.value;Oe.setCatchFinallyBlocks(5);ad=Za;Tc=ad.concat;return Oe.yield(cc.compute(ua.textMorph,Q),7);case 7:Za=Tc.call(ad,Oe.yieldResult);Oe.leaveTryBlock(3);break;case 5:Vc=Oe.enterCatchBlock(),console.warn("Error in completer "+cc+": "+(Vc.stack||Vc));case 3:oc=ib.next();Oe.jumpTo(2);break;case 4:Yd=new Map;Za.forEach(function(ki){var Kh=Yd.get(ki.completion);Kh||(Kh=[],Yd.set(ki.completion,Kh));Kh.push(ki)});Mf=[];Bf=$jscomp.makeIterator(Yd.values());for(Hg=
Bf.next();!Hg.done;Hg=Bf.next())df=Hg.value,Mf.push(Ba.arr.last(Ba.arr.sortByKey(df,"priority")));Bg=0;Di=Ba.arr.sortByKey(Mf,"priority").reverse();Pg=Di.length&&Di[0].priority||0;Nj=Di.map(function(ki){ki.highestPriority=Pg;var Kh=ki.completion.replace(/\n/g,""),be=String((ki.info||"").replace(/\n/g,""));Bg=Math.max(Bg,Kh.length+be.length);return{isListItem:!0,string:Kh,annotation:be,value:ki}});return Oe.return({items:Nj,maxCol:Bg})}})}},{key:"computeSortedCompletions",value:function(Q,ua){ua=void 0===
ua?!1:ua;var Za=this,ib,oc,cc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){if(1==ad.nextAddress)return ib={tokens:[Q],lowercasedTokens:[Q],input:Q},ad.yield(Za.computeCompletions(Q),2);oc=ad.yieldResult;cc=Ba.arr.sortBy(oc.items.filter(function(Tc){return Za.filterFunction(ib,Tc,ua)}),function(Tc){return Za.sortFunction(ib,Tc)});return ad.return(cc)})}},{key:"_printCompletions",value:function(Q){var ua=this,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){if(1==
ib.nextAddress)return ib.yield(ua.computeSortedCompletions(Q),2);Za=ib.yieldResult.map(function(oc){return{completion:oc.value.completion,priority:oc.value.priority,maxP:oc.value.highestPriority,sortVal:oc._cache[Q].sortVal,lev:JSON.stringify(oc._cache[Q].levenshtein)}});return ib.return(Ba.string.printTable(lively.lang.grid.tableFromObjects(Za)))})}},{key:"prefix",value:function(){var Q=this.textMorph,ua=Q.selection;return(ua.isEmpty()?Q.getLine(ua.lead.row).slice(0,ua.lead.column):ua.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(Q,ua,Za){Za=void 0===Za?!1:Za;ua._cache||(ua._cache={});var ib=Q.tokens,oc=Q.lowercasedTokens,cc=Q.input;cc=ua._cache[cc]||(ua._cache[cc]={});if(cc.hasOwnProperty("filtered"))return cc.filtered;ua=ua.value.completion.replace(/\([^\)]*\)$/,"");var ad=ua.toLowerCase();if(Za&&ib[0]&&!ua.startsWith(ib[0]))return cc.filtered=!1;if(oc.every(function(Vc){return ad.includes(Vc)}))return!0;var Tc=cc.levenshtein||(cc.levenshtein={});Q=Za||3>=Ba.arr.sum(Q.lowercasedTokens.map(function(Vc){return Tc[Vc]||
(Tc[Vc]=Ba.string.levenshtein(ad,Vc))}));return cc.filtered=Q}},{key:"sortFunction",value:function(Q,ua){ua._cache||(ua._cache={});var Za=ua._cache[Q.input]||(ua._cache[Q.input]={});if(Za.hasOwnProperty("sortVal"))return Za.sortVal;Za=ua._cache[Q.input]={};var ib=ua.value;ua=ib.highestPriority;var oc=ib.completion;ib=ib.priority;oc=oc.replace(/\([^\)]*\)$/,"").toLowerCase();var cc=0;Q.lowercasedTokens.forEach(function(Tc){oc.startsWith(Tc)?cc+=12:3<=Tc.length&&oc.includes(Tc)&&(cc+=5)});ua=-((ib||
(cc?ua:0))/Math.pow(10,String(ua).length-2))-cc;var ad=Za.levenshtein||(Za.levenshtein={});Q=Ba.arr.sum(Q.lowercasedTokens.map(function(Tc){return ad[Tc]||(ad[Tc]=Ba.string.levenshtein(oc,Tc))}));cc&&(Q/=2);return Za.sortVal=Q+ua}},{key:"positionForMenu",value:function(){var Q=this.textMorph,ua=Q.charBoundsFromTextPosition(Q.cursorPosition);return Q.getGlobalTransform().transformRectToRect(ua).topLeft().addXY(-Q.scroll.x,-Q.scroll.y).addPt(Ba.pt(Q.borderWidth+3,Q.borderWidth+3))}},{key:"completionListSpec",
value:function(){var Q=this,ua,Za,ib,oc,cc,ad,Tc,Vc,Yd,Mf,Bf,Hg,df,Bg,Di,Pg,Nj,Oe,ki,Kh;return $jscomp.asyncExecutePromiseGeneratorProgram(function(be){if(1==be.nextAddress)return Za=ua=Q.textMorph,ib=Za.fontSize,oc=Za.fontFamily,cc=Q.positionForMenu(),ad=Q.prefix(),be.yield(Q.computeCompletions(ad),2);Tc=be.yieldResult;Vc=Tc.items;Yd=Tc.maxCol;Mf=ua.env.fontMetric.sizeFor(oc,ib,"M");Bf=Mf.width*Yd;Hg=ua.document.getLine(0).height;df=Math.max(120,Bf<ua.width?Bf:ua.width);Bg=Hg*Vc.length+Hg+10;Di=
Math.max(70,Math.min(700,Bg));Pg=cc.extent(Ba.pt(df,Di));if(Nj=ua.world())Oe=Nj.visibleBounds().insetBy(5),Pg.bottom()>Oe.bottom()&&(ki=Pg.bottom()-Oe.bottom(),ki>Pg.height-50&&(ki=Pg.height-50),Pg.height-=ki),Pg.right()>Oe.right()&&(Kh=Pg.right()-Oe.right(),Pg.width=120>Pg.width-Kh?120:Pg.width-Kh),Oe.containsRect(Pg)||(Pg=Pg.withTopLeft(Oe.translateForInclusion(Pg).topLeft())),Pg=Pg.translatedBy(Oe.insetBy(0).topLeft().negated());return be.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:ib,position:Pg.topLeft(),extent:Pg.extent(),items:Vc,input:ad,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:Q.filterFunction,sortFunction:Q.sortFunction})})}},{key:"removeMenuOnBlur",value:function(Q){var ua=Q.menu;setTimeout(function(){ua.withAllSubmorphsDetect(function(Za){return Za.isFocused()})?ua.inputMorph.focus():ua.remove()})}},{key:"openCompletionList",value:function(){var Q=this,ua,Za,ib,oc,cc,ad,Tc,Vc,Yd,Mf;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bf){if(1==Bf.nextAddress)return ua=Q.textMorph.selection.start,Bf.yield(Q.completionListSpec(),2);Za=Bf.yieldResult;Q.textMorph.pluginFind(function(Hg){return Hg.theme});ib=new Ba.FilterableList(Za);oc=new Ba.Range({start:ua,end:Q.textMorph.selection.start});cc=Q.textMorph.textInRange(oc);ad=ib.inputMorph;Tc=ib.listMorph;Vc=Za.input;Yd=ib.addMorph({name:"prefix mask",fill:Ba.Color.transparent,bounds:ad.textBounds()},ad);Tc.master=null;oc.isEmpty()||
(Q.textMorph.deleteText(oc),ad.input=cc,ad.gotoDocumentEnd());ad.fontColor=Q.textMorph.fontColor;Ba.connect(ad,"textString",Yd,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:ad}});Ba.connect(ib,"accepted",Q,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Vc}});Ba.connect(ib,"accepted",ib,"remove");Ba.connect(ib,"canceled",ib,"remove");Ba.connect(ib,"remove",Q.textMorph,"focus");Ba.connect(ib.inputMorph,"onBlur",Q,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:ib}});Mf=Q.textMorph.world();Mf.addMorph(ib);Tc.addStyleClass("hiddenScrollbar");ad.height=Tc.itemHeight;ad.fixedHeight=!0;ad.fontSize=Tc.fontSize;ad.focus();ib.get("padding").height=0;ib.relayout();ib.selectedIndex=0;Vc.length?(ad.gotoDocumentEnd(),
ib.moveBy(Ba.pt(-ad.textBounds().width+2,0))):ib.moveBy(Ba.pt(2,0));return Bf.return(ib)})}},{key:"autoInsertBestMatchingCompletion",value:function(Q,ua,Za){ua=void 0===ua?!0:ua;var ib=this,oc,cc,ad,Tc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Vc){if(1==Vc.nextAddress)return oc=$jscomp,cc=oc.makeIterator,Vc.yield(ib.computeSortedCompletions(Q,ua),2);ad=cc.call(oc,Vc.yieldResult);(Tc=ad.next().value)&&ib.insertCompletion(Tc.value.completion,Q,Za);Vc.jumpToEnd()})}},{key:"insertCompletion",
value:function(Q,ua,Za){var ib=this.textMorph,oc=ib.document,cc=ib.selection.isMultiSelection?ib.selection.selections:[ib.selection];ib.undoManager.group();cc.forEach(function(ad){ad.collapseToEnd();var Tc=ad.lead,Vc=ua?oc.indexToPosition(oc.positionToIndex(Tc)-ua.length):Tc;"function"===typeof Za?Za(Q,ua,ib,{start:Vc,end:Tc},ad):ib.replace({start:Vc,end:Tc},Q)});ib.undoManager.group()}}],[{key:"className",get:function(){return"CompletionController"}}],Ka,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1355,end:12497})}(void 0);Ba.CompletionController=ia;Ba.CompletionController=ia;Ba.CompletionController=ia;ia=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(va,Ka,sb){var Q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return 1==ua.nextAddress?
(Q=new Ba.CompletionController(va,Ba.defaultCompleters),ua.yield(Q.openCompletionList(),2)):ua.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(va,Ka,sb){var Q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return 1==ua.nextAddress?(Q=new Ba.CompletionController(va,Ba.defaultCompleters),ua.yield(Q.autoInsertBestMatchingCompletion(Q.prefix()),2)):ua.return(!0)})}}];Ba.completionCommands=ia;Ba.completionCommands=ia;Ba.completionCommands=
ia;var rb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");rb.chain=od;rb.arr=Wb;rb.obj=Zc;rb.string=Yc;var sc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(va){var Ka=va.selection.start;0<Ka.row&&(Ka=va.getPositionAboveOrBelow(1,Ka,!0,0,va.charBoundsFromTextPosition(Ka).x),va.selection.addRange({start:Ka,end:Ka}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(va){var Ka=va.selection.start;
Ka.row<va.documentEndPosition.row&&(Ka=va.getPositionAboveOrBelow(-1,Ka,!0,0,va.charBoundsFromTextPosition(Ka).x),va.selection.addRange({start:Ka,end:Ka}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(va){var Ka=va.selection.selections[va.selection.selections.length-1];if(Ka.isEmpty())return!0;va.searchForAll(Ka.text,{start:{column:0,row:0}}).forEach(function(sb){return va.selection.addRange(sb.range,!1)});va.selection.mergeSelections();rb.arr.remove(va.selection.selections,
Ka);va.selection.selections.push(Ka);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(va){var Ka=va.selection.selections.length-1,sb=va.selection.selections[Ka];if(sb.isEmpty())return!0;var Q=va.search(sb.text,{start:sb.end,backwards:!1});Q&&(sb=va.selection.selections.findIndex(function(ua){return ua.range.equals(Q.range)}),-1<sb?rb.arr.swap(va.selection.selections,sb,Ka):va.selection.addRange(Q.range));return!0}},{name:"[multi select] more like this backward",
multiSelectAction:"single",exec:function(va){var Ka=va.selection.selections.length-1,sb=va.selection.selections[Ka];if(sb.isEmpty())return!0;var Q=sb.start,ua=va.search(sb.text,{start:{row:Q.row,column:Q.column-(sb.text.length-1)},backwards:!0});ua&&(sb=va.selection.selections.findIndex(function(Za){return Za.range.equals(ua.range)}),-1<sb?rb.arr.swap(va.selection.selections,sb,Ka):va.selection.addRange(ua.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",
exec:function(va){var Ka=va.selection.selections.length;1<Ka&&va.selection.removeSelections(Ka-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(va){va.selection.selections=lively.lang.arr.rotate(va.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(va){va.selection.selections=lively.lang.arr.rotate(va.selection.selections,1);return!0}},{name:"[multi select] align cursors",
multiSelectAction:"single",exec:function(va){var Ka=va.selection.selections;if(1>=Ka.length)return!0;var sb=rb.arr.groupBy(Ka,function(ua){return ua.range.start.row});Ka=sb.keys().map(function(ua){ua=sb[ua];var Za=rb.arr.max(ua,function(ib){return ib.range.start.column});rb.arr.without(ua,Za).forEach(function(ib){return ib.range=Za.range});return Za});var Q=rb.arr.max(Ka,function(ua){return ua.range.start.column}).range.start.column;Ka.forEach(function(ua){var Za=ua.range.start;ua=Za.row;Za=Za.column;
va.insertText(" ".repeat(Q-Za),{row:ua,column:Za})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(va){va.selection.disableMultiSelect();if(va.selection.isEmpty())var Ka=va.lastSavedMark&&va.lastSavedMark.position||(void 0).lineRange().start,sb=va.cursorPosition;else Ka=va.selection,sb=Ka.lead,Ka=Ka.anchor;va.selection.collapse();var Q=Ka.column,ua=sb.column;rb.arr.range(Ka.row,sb.row).forEach(function(Za){return va.getLine(Za).length>Math.min(ua,
Q)&&va.selection.addRange({end:{row:Za,column:ua},start:{row:Za,column:Q}},!1)});va.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(va,Ka,sb){sb=void 0===sb?1:sb;va.undoManager.group();va.selection.selections.forEach(function(Q,ua){return Q.text=String(ua+sb)});va.undoManager.group();return!0}}];rb.multiSelectCommands=sc;rb.multiSelectCommands=sc;rb.multiSelectCommands=sc;var yc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");
yc.pToI=function(va,Ka){return va.positionToIndex(Ka)};yc.iToP=function(va,Ka){return va.indexToPosition(Ka)};yc.execCodeNavigator=function(va){return function(Ka,sb,Q){var ua=Ka.pluginInvokeFirst("getNavigator");if(!ua)return!0;Ka.saveMark();Q=Q||1;for(var Za=0;Za<Q;Za++)ua[va](Ka,sb);return!0}};yc.once=Ra;var Gd=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:yc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",
exec:yc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:yc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:yc.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:yc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",
bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(va,Ka){function sb(){var Za=va.$expandRegionState,ib=yc.pToI(va,va.cursorPosition);if(Za&&(Za.range[0]===ib||Za.range[1]===ib))return Za;Za=va.selection.range;return va.$expandRegionState={range:[yc.pToI(va,Za.start),yc.pToI(va,Za.end)]}}Ka=Ka||{};var Q=va.pluginInvokeFirst("getNavigator");if(!Q)return!0;var ua=Ka.start;Ka=Ka.end;if("number"===typeof ua&&"number"===typeof Ka)sb(),Q={range:[ua,Ka],
prev:sb()};else{ua=Q.ensureAST(va);if(!ua)return;Q=Q.expandRegion(va,va.textString,ua,sb())}Q&&Q.range&&(va.selection={start:yc.iToP(va,Q.range[0]),end:yc.iToP(va,Q.range[1])},va.$expandRegionState=Q);yc.once(va,"selectionChange",function(){return va.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(va){if(va.selection.isEmpty())return!0;var Ka=
va.pluginInvokeFirst("getNavigator");if(!Ka)return!0;var sb=Ka.ensureAST(va);if(!sb)return!0;var Q=va.$expandRegionState;if(!Q)return!0;(Ka=Ka.contractRegion(va,va.textString,sb,Q))&&Ka.range&&(va.selection={start:yc.iToP(va,Ka.range[0]),end:yc.iToP(va,Ka.range[1])},va.$expandRegionState=Ka);yc.once(va,"selectionChange",function(){return va.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];yc.commands=Gd;yc.commands=Gd;yc.commands=Gd;var Ld=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");
Ld.arr=Wb;Ld.chain=od;Ld.string=Yc;var Ke=[{name:"toggle comment",exec:function(va){var Ka=va.pluginInvokeFirst("getComment");if(!Ka)return!0;if(!Ka.lineCommentStart)return Ka.blockCommentStart?va.execCommand("toggle block comment"):!0;var sb=Ka.lineCommentStart,Q=new RegExp("^(\\s*)("+sb+"\\s?)(.*)");Ka=va.document;var ua=va.selection;ua.isEmpty()||0!==ua.end.column||ua.growRight(-1);var Za=ua.start.row;Ka=Ka.lineStrings.slice(ua.start.row,ua.end.row+1);Ka=Ka.some(function(cc){return!!cc.trim()})?
Ld.arr.dropWhile(Ka,function(cc){return cc.trim()?!1:++Za&&!0}):Ka;var ib=Ka.every(function(cc){return cc.trim()&&cc.match(Q)});va.undoManager.group();if(ib)Ka.forEach(function(cc,ad){if(cc=cc.match(Q)){cc=$jscomp.makeIterator(cc);cc.next();var Tc=cc.next().value,Vc=cc.next().value;cc.next();va.deleteText({start:{row:Za+ad,column:Tc.length},end:{row:Za+ad,column:Tc.length+Vc.length}})}});else{var oc=Ka.reduce(function(cc,ad,Tc){return ad.trim()||ua.isEmpty()&&ua.start.row===ua.end.row?Math.min(cc,
ad.match(/^\s*/)[0].length):cc},Infinity);oc=Infinity===oc?0:oc;Ka.forEach(function(cc,ad){cc=$jscomp.makeIterator(cc.match(/^(\s*)(.*)/));cc.next();cc.next();cc.next();va.insertText(sb+" ",{row:Za+ad,column:oc})})}va.undoManager.group();return!0}},{name:"toggle block comment",exec:function(va){var Ka=va.pluginInvokeFirst("getComment");if(!Ka)return!0;if(!Ka.blockCommentStart)return Ka.lineCommentStart?va.execCommand("toggle comment"):!0;if(!Ka||!Ka.blockCommentStart)return!0;var sb=Ka.blockCommentStart;
Ka=Ka.blockCommentEnd;var Q=new RegExp("^"+sb.replace(/\*/g,"\\*")),ua=new RegExp(Ka.replace(/\*/g,"\\*")+"$"),Za=va.tokenAt(va.cursorPosition);if(Za&&"comment"===Za.token){var ib=va.textInRange(Za);if(ib.match(Q)&&ib.match(ua))return va.undoManager.group(),va.replace(Za,ib.slice(sb.length,-Ka.length)),va.undoManager.group(),!0}va.undoManager.group();va.insertText(sb,va.selection.start);va.insertText(Ka,va.selection.end);va.undoManager.group();sb=!va.selection.isEmpty();va.selection.growLeft(Ka.length);
sb||va.selection.collapse();return!0}},{name:"comment box",exec:function(va,Ka,sb){Ka=va.undoManager.ensureNewGroup(va,"comment box");if(va.selection.isEmpty())return va.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),va.execCommand("toggle comment"),va.undoManager.group(Ka),!0;var Q=va.selection.range,ua=va.withSelectedLinesDo(function(ib){return ib}),Za=Ld.arr.min([Q.start.column].concat(Ld.chain(ua).map(function(ib){return ib.match(/^\s*/)}).flatten().compact().pluck("length").value()));
ua=Ld.arr.max(ua.map(function(ib){return ib.length}))-Za;ua=Array(Math.ceil(ua/2)+1).join("-=")+"-";va.execCommand("toggle comment");va.collapseSelection();va.cursorPosition={row:Q.start.row,column:0};sb?va.insertText(Ld.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",Za)):va.insertText(Ld.string.indent(ua+"\n"," ",Za));va.selection.goUp();va.execCommand("toggle comment");va.cursorPosition={row:Q.end.row+2,column:0};va.insertText(Ld.string.indent(ua+"\n"," ",Za));va.selection.goUp();
va.execCommand("toggle comment");va.selection.range={start:{row:Q.start.row,column:0},end:va.cursorPosition};va.undoManager.group(Ka);return!0},multiSelectAction:"forEach",handlesCount:!0}];Ld.commands=Ke;Ld.commands=Ke;Ld.commands=Ke;var hd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");hd.printSymbol=function(va){if(Symbol.keyFor(va))return'Symbol.for("'+Symbol.keyFor(va)+'")';if(hd.knownSymbols.get(va))return hd.knownSymbols.get(va);String(va).match(hd.symMatcher);return String(va)};
hd.defaultSort=function(va,Ka){if(va.hasOwnProperty("priority")||Ka.hasOwnProperty("priority")){var sb=va.priority||0,Q=Ka.priority||0;if(sb<Q)return-1;if(sb>Q)return 1}va=(va.keyString||va.key).toLowerCase();Ka=(Ka.keyString||Ka.key).toLowerCase();return va<Ka?-1:va===Ka?0:1};hd.safeToString=Od;hd.propertyNamesOf=function(va,Ka){if(!va)return[];if(Array.isArray(va)){var sb=Ka?Ka.offset:0;return hd.arr.range(sb,sb+(Ka?Ka.partitionSize:va.length-1))}return hd.arr.sortBy(Object.keys(va),function(Q){return Q.toLowerCase()})};
hd.isMultiValue=Zd;hd.printValue=Te;hd.partitionedChildren=function(va,Ka){var sb=void 0===Ka?{}:Ka;Ka=void 0===sb.originalValue?va:sb.originalValue;var Q=void 0===sb.offset?0:sb.offset;sb=void 0===sb.partitionSize?va.length||Object.values(va).length:sb.partitionSize;if(hd.obj.isArray(va)){va=hd.num.roundTo(Math.max(hd.MIN_PARTITION_SIZE,sb/50),.1);sb/=va;for(var ua=[],Za=0;Za<sb;Za++){var ib="["+(Q+Za*va)+"-"+(Q+(Za+1)*va)+"]";ua.push({partition:{originalValue:Ka,offset:Q+Za*va,partitionSize:va},
value:[],key:ib,keyString:ib,valueString:"...",isCollapsed:!0})}return ua}va=hd.num.roundTo(Math.max(hd.MIN_PARTITION_SIZE,sb/50),.1);sb/=va;ua=[];Za=hd.obj.keys(Ka).sort();for(ib=0;ib<sb;ib++){var oc=Q+ib*va,cc=Q+(ib+1)*va,ad=hd.obj.select(Ka,Za.slice(oc,cc));oc="["+Za[oc].slice(0,4)+"-"+(Za[cc]||hd.arr.last(Za)).slice(0,4)+"]";ua.push({partition:{originalValue:ad,offset:Q+ib*va,partitionSize:va},value:[],key:oc,keyString:oc,valueString:"...",isCollapsed:!0})}return ua};hd.propertiesOf=function(va){var Ka=
va.partition?va.target:va.value;if(!Ka)return[];var sb={_rev:!0},Q=[],ua="function"===typeof Ka.livelyCustomInspect?Ka.livelyCustomInspect():{},Za=Object.assign({},hd.defaultPropertyOptions,{},ua);if(ua.properties){ua=$jscomp.makeIterator(ua.properties);for(var ib=ua.next();!ib.done;ib=ua.next()){var oc=ib.value;ib=oc.key;var cc=oc.hidden,ad=oc.priority,Tc=oc.keyString,Vc=oc.value;oc=oc.valueString;sb[ib]=!0;cc||Q.push(va.getSubNode({priority:ad,key:ib,keyString:Tc||hd.safeToString(ib),value:Vc,valueString:oc,
isCollapsed:!0}))}}if(Za.includeDefault){ua=hd.propertyNamesOf(Ka,va.partition);if(ua.length>hd.MAX_NODE_THRESHOLD)for(sb=$jscomp.makeIterator(hd.partitionedChildren(Ka,va.partition)),ua=sb.next();!ua.done;ua=sb.next())Q.push(va.getSubNode(ua.value));else for(cc=$jscomp.makeIterator(ua),ua=cc.next();!ua.done;ua=cc.next())ad=ua.value,ad in sb||(ua=Ka[ad],ib=hd.printValue(ua),ua={keyString:ad,key:ad,value:ua,valueString:ib,isCollapsed:!0},Q.push(va.getSubNode(ua)));if(Za.includeSymbols)for(sb=$jscomp.makeIterator(Object.getOwnPropertySymbols(Ka)),
ua=sb.next();!ua.done;ua=sb.next())cc=ua.value,ad=hd.safeToString(cc),ua=Ka[cc],ib=hd.printValue(ua),ua={key:cc,keyString:ad,value:ua,valueString:ib,isCollapsed:!0},Q.push(va.getSubNode(ua))}Za.sort&&(Q=Za.sortFunction(Ka,Q));return Q};hd.obj=Zc;hd.num=tb;hd.arr=Wb;hd.string=Yc;hd.connect=Gc;hd.signal=dc;hd.TreeData=bc;hd.newUUID=Xc;hd.localInterface=ta;hd.MAX_NODE_THRESHOLD=1E3;hd.MIN_PARTITION_SIZE=250;hd.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(va,
Ka){return Array.isArray(va)?Ka:Ka.sort(hd.defaultSort)}};hd.symMatcher=/^Symbol\((.*)\)$/;hd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(va){return"symbol"===typeof Symbol[va]}).reduce(function(va,Ka){return va.set(Symbol[Ka],"Symbol."+Ka)},new Map)}();hd.isMultiValue=Zd;hd.isMultiValue=Zd;hd.printValue=Te;hd.printValue=Te;var Md=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),sb=Ka.hasOwnProperty("InspectionTree")&&
"function"===typeof Ka.InspectionTree?Ka.InspectionTree:Ka.InspectionTree=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(Q){Eb._get(Object.getPrototypeOf(sb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Q);this.inspector=Q.inspector;this.root.isInspectionNode||(this.root=hd.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",
get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(Q){Q=void 0===Q?!0:Q;return Eb._get(Object.getPrototypeOf(sb.prototype),"asListWithIndexAndDepth",this).call(this,function(ua){ua=ua.node;return Q?ua.visible:!0})}},{key:"getContextFor",value:function(Q){return Q==this.root?this.root.value.inspectee:Q.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(Q){var ua=void 0===Q.maxDepth?1:Q.maxDepth,Za=Q.iterator,ib=Q.showUnknown,oc=Q.showInternal,cc=this;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){if(1==ad.nextAddress)return ad.yield(cc.uncollapseAll(function(Tc,Vc){return ua>Vc&&(Tc==cc.root||Tc.value.submorphs)}),2);cc.asListWithIndexAndDepth(!1).forEach(function(Tc){var Vc=Tc.node;return 0==Tc.depth?Vc.visible=!0:!ib&&Vc.keyString&&Vc.keyString.includes("UNKNOWN PROPERTY")||!oc&&Vc.keyString&&Vc.keyString.includes("internal")?Vc.visible=!1:Vc.value&&Vc.value.submorphs?Vc.visible=!0:Vc.visible=Za(Vc)});ad.jumpToEnd()})}},{key:"getChildren",
value:function(Q){return Q.children}},{key:"display",value:function(Q){return Q.display(this.inspector)}},{key:"isCollapsed",value:function(Q){return Q.isCollapsed}},{key:"isLeaf",value:function(Q){return hd.obj.isPrimitive(Q.value)}},{key:"collapse",value:function(Q,ua){var Za=this;Q.isCollapsed=ua;ua||this.isLeaf(Q)||Q.children.length||(Q.children=hd.propertiesOf(Q).map(function(ib){Za.parentMap.set(ib,Q);return ib}))}},{key:"retrieveForRemoteProxy",value:function(Q){Q.uuid||(Q.uuid=hd.newUUID(),
this.idToNodeMap[Q.uuid]=Q);return{uuid:Q.uuid,value:this.isLeaf(Q)?Q.value:{},keyString:Q.keyString,key:Q.keyString,valueString:hd.safeToString(Q.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return hd.localInterface}},{key:"getNodeViaId",value:function(Q){return this.idToNodeMap[Q]}},{key:"asRemoteDelegate",value:function(Q){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext=
{});System.get("@lively-env").remoteInspectionContext[Q]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:"className",get:function(){return"InspectionTree"}},{key:"forObject",value:function(Q,ua){return new this({key:"inspectee",value:{inspectee:Q},isCollapsed:!0,inspector:ua})}}],Ka,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:5932,end:8631})}(hd.TreeData);hd.InspectionTree=Md;hd.InspectionTree=Md;hd.InspectionTree=Md;var ze=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),sb=Ka.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Ka.RemoteInspectionTree?Ka.RemoteInspectionTree:Ka.RemoteInspectionTree=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:"systemInterface",
get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(Q){this.parentMap=new WeakMap;this.root=Q.proxy;this.evalEnvironment=Q.evalEnvironment;this.inspector=Q.inspector;this.delegateId=Q.delegateId}},{key:"getContextFor",value:function(Q){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+Q.uuid+'").value'}},{key:"dispose",value:function(){var Q=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return ua.yield(Q.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
Q.delegateId+"']\n    ",Q.evalEnvironment),0)})}},{key:"display",value:function(Q){return Q.keyString+": "+Q.valueString}},{key:"collapse",value:function(Q,ua){var Za=this,ib;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oc){if(1==oc.nextAddress)return(Q.isCollapsed=ua)||Za.isLeaf(Q)?oc.return():Q.children.length?oc.jumpTo(0):oc.yield(Za.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+Q.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Za.delegateId+'"]'}),3);ib=oc.yieldResult;Q.children=ib.isError?[]:ib.value;oc.jumpToEnd()})}}],[{key:"className",get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(Q,ua){var Za=this,ib,oc,cc,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tc){if(1==Tc.nextAddress)return Tc.yield(Za.createRemoteContext(Q,ua),2);ib=Tc.yieldResult;oc=ib.proxy;cc=
ib.delegateId;ad=ib.evalEnvironment;return Tc.return(new Za({key:"inspectee",proxy:oc,delegateId:cc,evalEnvironment:ad,inspector:ua}))})}},{key:"createRemoteContext",value:function(Q,ua){var Za=Q.code,ib=Q.evalEnvironment,oc=Q.delegateId,cc,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tc){if(1==Tc.nextAddress)return oc="lively://inspector-"+ua.id,Tc.yield(ib.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Za+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+oc+'");\n    ',ib),2);cc=Tc.yieldResult;ad=cc.value;return Tc.return({delegateId:oc,evalEnvironment:ib,proxy:ad})})}}],Ka,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8640,end:10983})}(hd.InspectionTree);
hd.RemoteInspectionTree=ze;hd.RemoteInspectionTree=ze;hd.RemoteInspectionTree=ze;(function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),sb=Ka.hasOwnProperty("InspectionNode")&&"function"===typeof Ka.InspectionNode?Ka.InspectionNode:Ka.InspectionNode=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(Q){var ua=
Q.root,Za=Q.priority,ib=Q.key,oc=Q.keyString,cc=Q.value,ad=Q.valueString,Tc=Q.isCollapsed,Vc=void 0===Q.children?[]:Q.children,Yd=void 0===Q.isSelected?!1:Q.isSelected,Mf=void 0===Q.visible?!0:Q.visible;this.partition=Q.partition;this.priority=Za;this.key=ib;this.keyString=String(oc||ib);this.value=cc;this.valueString=ad||hd.printValue(cc);this.isCollapsed=Tc;this.children=Vc;this.isSelected=Yd;this.visible=Mf;this.root=ua}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(Q){if(Q.value&&Q.value.isMorph)return new hd.MorphNode(Object.assign({root:this.root},Q));var ua=Q.key,Za=Q.keyString,ib=this.value,oc=Q.partition;oc&&(ib=oc.originalValue,Za=ua);return new hd.PropertyNode(Object.assign({},Q,{keyString:Za,key:ua,target:ib,partition:oc,root:this.root,spec:{}}))}},{key:"display",value:function(Q){var ua=this.keyString,Za=this.valueString;if(!this.interactive)return ua+": "+Za;this._propertyWidget||(this._propertyWidget=
Q.renderDraggableTreeLabel({value:ua+": "+Za}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:"className",get:function(){return"InspectionNode"}},{key:"for",value:function(Q,ua){ua=void 0===ua?null:ua;return Q.value&&Q.value.isMorph?new hd.MorphNode(Object.assign({root:ua},Q)):new hd.InspectionNode(Object.assign({root:ua},Q))}}],Ka,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10985,end:13522})})(void 0);(function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),sb=Ka.hasOwnProperty("MorphNode")&&"function"===typeof Ka.MorphNode?Ka.MorphNode:Ka.MorphNode=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:Symbol.for("lively-instance-initialize"),
value:function(Q){Eb._get(Object.getPrototypeOf(sb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Q);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(Q){var ua=this.propertyInfo[Q.key]||{};return Q.value&&Q.value.isMorph?new hd.MorphNode(Object.assign({},Q,{root:this.root})):new hd.PropertyNode(Object.assign({},Q,{root:this.root,target:this.target,spec:ua}))}}],[{key:"className",get:function(){return"MorphNode"}}],
Ka,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13524,end:14670})})(hd.InspectionNode);(function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),sb=Ka.hasOwnProperty("PropertyNode")&&"function"===typeof Ka.PropertyNode?Ka.PropertyNode:Ka.PropertyNode=
function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(Q){Eb._get(Object.getPrototypeOf(sb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Q);var ua=Q.spec,Za=Q.target;this.partition=Q.partition;this.target=Za;this.spec=ua;this.foldedNodes={}}},{key:"__deserialize__",value:function(Q,ua){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},
{key:"interactive",set:function(Q){this._interactive=Q}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(Q){return this.isFoldable?this.getFoldedContext(Q):Eb._get(Object.getPrototypeOf(sb.prototype),"getSubNode",this).call(this,Q)}},{key:"getFoldedContext",value:function(Q){return this.foldedNodes[Q.key]=new hd.FoldedNode(Object.assign({},Q,{root:this.root,
target:this.target,foldableNode:this,spec:hd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(Q,ua){(ua=void 0===ua?!1:ua)&&(this.target[this.key]=Q);this.value=this.target[this.key];this.valueString=hd.printValue(this.value);this.interactive&&(ua||this._propertyWidget.highlight());if(this.isFoldable)for(var Za in this.foldedNodes)this.foldedNodes[Za].value=this.value[Za],this.foldedNodes[Za].valueString=
hd.printValue(this.value[Za]),this.foldedNodes[Za]._propertyWidget&&hd.signal(this.foldedNodes[Za]._propertyWidget,"update",this.value[Za])}},{key:"display",value:function(Q){var ua=this,Za=this._propertyWidget,ib=this.keyString,oc=this.valueString,cc=this.target,ad=this.value,Tc=this.spec;if(!(this.interactive||Tc.foldable&&hd.isMultiValue(ad,Tc.foldable)))return Q.renderPropertyControl({target:cc,keyString:ib,valueString:oc,tree:Q.ui.propertyTree,value:ad,spec:Tc,node:this,fastRender:!0});if(Za)return Za.keyString=
ib,Za.valueString=oc,Za.isSelected=this.isSelected,Za.control&&(Za.control.isSelected=this.isSelected),Za;Za=this._propertyWidget=Q.renderPropertyControl({target:cc,keyString:ib,valueString:oc,value:ad,spec:Tc,node:this,isSelected:this.isSelected,fontColor:Q.ui.propertyTree.fontColor});this.isInternalProperty||Tc.readOnly||(hd.connect(Za,"propertyValue",this,"refreshProperty",{updater:function(Vc,Yd){return Vc(Yd,!0)}}),hd.connect(Za,"openWidget",this.root,"onWidgetOpened",{converter:function(Vc){return{widget:Vc,
node:ua.sourceObj}}}));return Za}}],[{key:"className",get:function(){return"PropertyNode"}}],Ka,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14672,end:18071})})(hd.InspectionNode);(function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),sb=
Ka.hasOwnProperty("FoldedNode")&&"function"===typeof Ka.FoldedNode?Ka.FoldedNode:Ka.FoldedNode=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(Q){Eb._get(Object.getPrototypeOf(sb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Q);this.foldableNode=Q=Q.foldableNode;this.foldedProp=Q.key+hd.string.capitalize(this.key)}},{key:"refreshProperty",
value:function(Q,ua){ua=void 0===ua?!1:ua;var Za={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Za[this.key]=Q,Za)),ua)}}],[{key:"className",get:function(){return"FoldedNode"}}],Ka,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18073,
end:18749})})(hd.PropertyNode);var Ne=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Ne.Color=lb;var yf=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),sb=Ka.hasOwnProperty("DarkTheme")&&"function"===typeof Ka.DarkTheme?Ka.DarkTheme:Ka.DarkTheme=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:"background",get:function(){return Ne.Color.rgb(44,62,
80)}},{key:"cursorColor",get:function(){return Ne.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},
{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Ne.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Ne.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Ne.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},
{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},
{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Ne.Color.white,fontWeight:"bold",backgroundColor:Ne.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Ne.Color.rgba(204,
204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Ne.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:"className",get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ka,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3048})}(void 0),tf=yf=Ne.DarkTheme;Ne.default=yf;var vc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");vc.inspect=Qc;vc.remoteInspect=Xd;vc.generateReferenceExpression=kd;vc.onNumberDragStart=function(va,Ka){Ka.initPos=va.position;Ka.factorLabel=(new vc.Tooltip({description:"1x"})).openInWorld(va.hand.position.addXY(10,10))};vc.onNumberDrag=
function(va,Ka){var sb=vc.getScaleAndOffset(va,Ka),Q=sb.scale;sb=sb.offset;Ka.factorLabel.position=va.hand.position.addXY(10,10);Ka.factorLabel.description=Q+"x";return vc.getCurrentValue(sb,Q,Ka)};vc.onNumberDragEnd=function(va,Ka){var sb=vc.getScaleAndOffset(va,Ka);va=sb.offset;sb=sb.scale;Ka.factorLabel.softRemove();return vc.getCurrentValue(va,sb,Ka)};vc.getScaleAndOffset=function(va,Ka){var sb=va.position.subPt(Ka.initPos);va=sb.x;Ka=vc.num.roundTo(Math.exp(-sb.y/$world.height*6),.01)*Ka.baseFactor;
return{offset:va,scale:Ka}};vc.getCurrentValue=function(va,Ka,sb){return Math.max(sb.min,Math.min(sb.max,sb.scrubbedValue+(sb.floatingPoint?va*Ka:Math.round(va*Ka))))};vc.Color=lb;vc.Rectangle=Qb;vc.rect=Oc;vc.pt=Bd;vc.obj=Zc;vc.num=tb;vc.Path=$b;vc.arr=Wb;vc.promise=zc;vc.connect=Gc;vc.disconnect=Fb;vc.once=Ra;vc.Morph=Cb;vc.Tooltip=pc;vc.VerticalLayout=Pc;vc.GridLayout=wb;vc.HorizontalLayout=db;vc.morph=Fc;vc.CustomLayout=Ta;vc.Label=cb;vc.Icon=ma;vc.StyleSheet=Kc;vc.config=La;vc.Tree=fb;vc.LoadingIndicator=
pb;vc.DropDownList=xb;vc.DropDownSelector=Wa;vc.SearchField=Xa;vc.LabeledCheckBox=Ab;vc.MorphHighlighter=qc;vc.InteractiveMorphSelector=wc;vc.printValue=Te;vc.RemoteInspectionTree=ze;vc.InspectionTree=Md;vc.isMultiValue=Zd;vc.valueWidgets=I;vc.popovers=T;vc.DarkTheme=tf;vc.DefaultTheme=ub;vc.syncEval=kc;vc.inspectorCommands=[{name:"focus codeEditor",exec:function(va){va.get("codeEditor").show();va.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(va){va.get("propertyTree").show();
va.get("propertyTree").focus();return!0}}];(function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),sb=Ka.hasOwnProperty("DraggedProp")&&"function"===typeof Ka.DraggedProp?Ka.DraggedProp:Ka.DraggedProp=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:"applyToTarget",value:function(Q){var ua=this.currentTarget,Za=this.control;this.remove();vc.MorphHighlighter.removeHighlighters(Q.world);
if(ua)if(ua.isText&&"js"===ua.editorModeName){var ib=ua.evalEnvironment.context;Q=ua.textPositionFromPoint(ua.localize(Q.position));ib=vc.generateReferenceExpression(this.sourceObject,{fromMorph:ib});Za.keyString&&(ib+="."+Za.keyString);ua.insertTextAndSelect(ib,Q);ua.focus()}else"propertyValue"in Za&&(ua[Za.keyString]=Za.propertyValue)}},{key:"update",value:function(Q){Q=Q.hand.globalPosition;var ua=this.morphBeneath(Q),Za;if(ua){for(ua==this.morphHighlighter&&(ua=ua.morphBeneath(Q));Za=[ua].concat($jscomp.arrayFromIterable(ua.ownerChain())).find(function(ib){return!ib.visible});)ua=
Za=Za.morphBeneath(Q);if(ua!=this.currentTarget){this.currentTarget=ua;this.morphHighlighter&&this.morphHighlighter.deactivate();if(ua.isWorld)return;this.morphHighlighter=vc.MorphHighlighter.for($world,ua);this.morphHighlighter.show()}this.position=Q}}}],[{key:"className",get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:vc.Color.rgb(169,204,227)},fill:{defaultValue:vc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},
borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var Q=this.control;if(!Q)return this.submorphs=[];this.height=22;this.submorphs=[Q];Q.top=0;Q.fontSize=14;"function"===typeof Q.relayout&&Q.relayout();this.width=Q.width+20;this.adjustOrigin(vc.pt(10,10))}}}}}],Ka,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:1268,end:3690})})(vc.Morph);(function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),sb=Ka.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Ka.DraggableTreeLabel?Ka.DraggableTreeLabel:Ka.DraggableTreeLabel=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(Q){this.draggedProp=
new vc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();vc.connect(Q.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(Q){}},{key:"onDragEnd",value:function(Q){vc.disconnect(Q.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(Q)}}],[{key:"className",get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},
nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:vc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:vc.Color.transparent},padding:{defaultValue:vc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(Q){this.setProperty("isSelected",Q);Q?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=Q)}}}}}],Ka,{pathInPackage:function(){return"js/inspector.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3692,end:5015})})(vc.Label);Md=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),sb=Ka.hasOwnProperty("PropertyControl")&&"function"===typeof Ka.PropertyControl?Ka.PropertyControl:Ka.PropertyControl=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(Q,ua,Za){Q.control=new vc.DropDownSelector({opacity:.8,fill:vc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:ua,padding:0,values:Za});vc.connect(Q.control,"update",Q,"propertyValue",{updater:function(ib,oc){this.targetObj.propertyValue!=oc&&ib(oc)}});vc.connect(Q,"update",
Q.control,"selectedValue",{updater:function(ib,oc){oc=oc&&oc.valueOf?oc.valueOf():oc;this.targetObj.propertyValue!=oc&&ib(oc)}});return Q}},{key:"toggleMultiValuePlaceholder",value:function(Q){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:vc.Color.transparent,layout:new vc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:vc.arr.range(0,2).map(function(ua){return{type:"ellipse",fill:vc.Color.gray.withA(.5),reactsToPointer:!1,
extent:vc.pt(7,7)}})});Q?(vc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(vc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(Q){this.foldableProperties&&this.toggleMultiValuePlaceholder(vc.isMultiValue(Q,this.foldableProperties))}},
{key:"asFoldable",value:function(Q){this.foldableProperties=Q;vc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",
value:function(){this.highlighter&&this.highlighter.remove();var Q=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});Q.isLayoutable=!1;Q.fontWeight="bold";Q.fontColor=vc.Color.orange;Q.reactsToPointer=!1;Q.fadeOut(2E3)}}],[{key:"className",get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(Q){this.submorphs=
[Q]}},layout:{initialize:function(){this.layout=new vc.CustomLayout({relayout:function(Q){Q.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(Q){return(Q=Q.value)&&(Q.isColor||Q.isGradient)?"Color":Q&&Q.isPoint?"Point":vc.obj.isBoolean(Q)?"Boolean":vc.obj.isNumber(Q)?"Number":vc.obj.isString(Q)?"String":Q&&Q.isRectangle?"Rectangle":!1}},{key:"render",value:function(Q){Q.spec.type||(Q.spec=Object.assign({},Q.spec,{type:this.inferType(Q)}));
switch(Q.spec.type){case "Color":var ua=this.renderColorControl(Q);break;case "ColorGradient":ua=this.renderColorControl(Object.assign({},Q,{gradientEnabled:!0}));break;case "Number":ua=this.renderNumberControl(Q);break;case "String":ua=this.renderStringControl(Q);break;case "RichText":ua=this.renderStringControl(Q);break;case "Layout":ua=this.renderLayoutControl(Q);break;case "Enum":ua=this.renderEnumControl(Q);break;case "Shadow":ua=this.renderShadowControl(Q);break;case "Point":ua=this.renderPointControl(Q);
break;case "Rectangle":ua=this.renderRectangleControl(Q);break;case "Boolean":ua=this.renderBooleanControl(Q);break;default:ua=this.renderItSomehow(Q)}ua.control&&(vc.connect(ua.control,"openWidget",ua,"openWidget"),ua.toggleFoldableValue(Q.value));return ua}},{key:"baseControl",value:function(Q){var ua=Q.spec;Q=new this({keyString:Q.keyString,valueString:Q.valueString,isSelected:!1,propertyValue:Q.value});ua.foldable&&Q.asFoldable(ua.foldable);return Q}},{key:"renderGrabbableKey",value:function(Q){var ua=
this,Za=Q.target;return[Q.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(ib){ib.state.draggedProp=new vc.DraggedProp({sourceObject:Za,control:ua.baseControl(Q)});ib.state.draggedProp.openInWorld();vc.connect(ib.hand,"update",ib.state.draggedProp,"update")},onDrag:function(ib){},onDragEnd:function(ib){vc.disconnect(ib.hand,"update",ib.state.draggedProp,"update");ib.state.draggedProp.applyToTarget(ib)}}]}},{key:"renderEnumControl",value:function(Q){var ua=Q.value,Za=Q.spec.values,ib=
Q.keyString,oc=Q.target,cc=Q.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" "+(ua?ua.valueOf?ua.valueOf():ua:"Not set"),{nativeCursor:"pointer",onMouseDown:function(ad,Tc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Vc){oc.world().openWorldMenu(ad,Za.map(function(Yd){return{string:Yd.toString(),action:function(){oc[ib]=Yd;cc.rerender()}}}));Vc.jumpToEnd()})}}],$jscomp.arrayFromIterable(vc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",
opacity:.7})))}},{key:"renderStringControl",value:function(Q){var ua=Q.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" "+(200<ua.length?ua.slice(0,20)+"...":ua),{fontColor:vc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(Q){var ua=Q.value,Za=Q.keyString,ib=Q.valueString,oc=Q.target,cc=Q.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" "+ib,{fontColor:vc.Color.black,nativeCursor:"pointer",onMouseDown:function(ad){var Tc;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Vc){if(1==Vc.nextAddress)return Tc=new vc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:ua}),Tc.relayout(),Vc.yield(Tc.fadeIntoWorld(ad.positionIn(oc.world())),2);vc.connect(Tc,"rectangle",function(Yd){oc[Za]=Yd;cc.rerender()});Vc.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(Q){var ua=Q.value,Za=Q.keyString,ib=Q.valueString,oc=Q.target,cc=Q.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),
[" "+ib,{nativeCursor:"pointer",fontColor:ua?vc.Color.green:vc.Color.red,onMouseDown:function(ad){oc[Za]=!oc[Za];cc.rerender()}}])}},{key:"renderNumberControl",value:function(Q){var ua=Q.value,Za=Q.spec,ib=Q.keyString,oc=Q.valueString,cc=Q.node,ad=Q.target,Tc=Q.tree,Vc=void 0===cc._numberControls?new Fe:cc._numberControls,Yd=$jscomp.makeIterator(Vc.submorphs),Mf=Yd.next().value,Bf=Yd.next().value;Vc.fontColor=Tc.fontColor;var Hg=cc._numberControls=Vc;"max"in Za&&"min"in Za&&-Infinity!=Za.min&&Infinity!=
Za.max?(Hg.baseFactor=(Za.max-Za.min)/100,Hg.floatingPoint=Za.isFloat,Hg.max=Za.max,Hg.min=Za.min):(Hg.floatingPoint=Za.isFloat,Hg.baseFactor=.5,Hg.min=void 0!=Za.min?Za.min:-Infinity,Hg.max=void 0!=Za.max?Za.max:Infinity);var df=vc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),$jscomp.arrayFromIterable(cc._inputMorph?[cc._inputMorph,{}]:[" "+(void 0!=ua&&(ua.valueOf?ua.valueOf():ua).toFixed(Za.isFloat?3:0))+" ",{fontColor:df,
onMouseUp:function(Bg){cc._inputMorph=vc.morph({type:"input",fill:null,fontColor:df,fontFamily:"IBM Plex Mono",fontSize:14,padding:vc.rect(8,2,-6,2),height:23,cursorColor:vc.Color.white,value:ua.valueOf?ua.valueOf():oc});ad[ib]=ua;cc._inputMorph.focus();vc.once(cc._inputMorph,"inputAccepted",function(Di){delete cc._inputMorph;ad[ib]=Za.isFloat?Number.parseFloat(Di):Number.parseInt(Di);cc.rerender()});vc.once(cc._inputMorph,"onBlur",function(Di){cc._inputMorph&&(delete cc._inputMorph,ad[ib]=ua,cc.rerender())});
cc.rerender()},onDragStart:function(Bg){Hg.scrubbedValue=ua;vc.onNumberDragStart(Bg,Hg)},onDrag:function(Bg){ad[ib]=vc.onNumberDrag(Bg,Hg);cc.rerender()},onDragEnd:function(Bg){return vc.onNumberDragEnd(Bg,Hg)}},Vc,{onMouseUp:function(){Mf.fill=Bf.fill=null},onMouseDown:function(Bg){if(Bg.targetMorph===Mf){Mf.fill=vc.Color.white.withA(.2);if("max"in Za&&ad[ib]>=Za.max)return;ad[ib]+=1}if(Bg.targetMorph===Bf){Bf.fill=vc.Color.white.withA(.2);if("min"in Za&&ad[ib]<=Za.min)return;--ad[ib]}cc.rerender()}}]))}},
{key:"renderShadowControl",value:function(Q){var ua=Q.keyString,Za=Q.value,ib=Q.target,oc=Q.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[""+(Za?Za.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(cc){var ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tc){if(1==Tc.nextAddress)return ad=new vc.popovers.ShadowPopover({shadowValue:ib[ua],hasFixedPosition:!0}),Tc.yield(ad.fadeIntoWorld(cc.positionIn(ib.world())),2);vc.connect(ad,"shadowValue",
function(Vc){ib[ua]=Vc;oc.rerender()});Tc.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(Q){var ua=Q.keyString,Za=Q.value,ib=Q.target,oc=Q.node,cc=vc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,ad={nativeCursor:"pointer",onMouseDown:function(Tc){var Vc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){if(1==Yd.nextAddress)return Vc=new vc.popovers.PointPopover({pointValue:ib[ua],hasFixedPosition:!0}),Yd.yield(Vc.fadeIntoWorld(Tc.positionIn(ib.world())),
2);vc.connect(Vc,"pointValue",function(Mf){ib[ua]=Mf;oc.rerender()});Yd.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" pt(",Object.assign({},ad),""+Za.x.toFixed(),Object.assign({fontColor:cc},ad),",",Object.assign({},ad),""+Za.y.toFixed(),Object.assign({fontColor:cc},ad),")",Object.assign({},ad)])}},{key:"renderLayoutControl",value:function(Q){var ua=Q.valueString,Za=Q.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" "+(Za?ua:
"No Layout"),{onMouseDown:function(ib){}}])}},{key:"renderColorControl",value:function(Q){var ua=Q.node,Za=Q.gradientEnabled,ib=Q.valueString,oc=Q.keyString,cc=Q.value,ad=Q.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[vc.morph({fill:cc.valueOf?cc.valueOf():cc,extent:vc.pt(15,15),borderColor:vc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(cc?cc.valueOf?cc.valueOf():ib:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Tc){var Vc;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){if(1==Yd.nextAddress)return Vc=new vc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:ad,fillValue:cc,title:"Fill Control",gradientEnabled:Za}),Yd.yield(Vc.fadeIntoWorld(Tc.positionIn(ad.world())),2);vc.connect(Vc,"fillValue",function(Mf){ad[oc]=Mf;ua.rerender()});Yd.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(Q){var ua=Q.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" "+ua,{}])}}],
Ka,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5024,end:20444})}(vc.DraggableTreeLabel);vc.PropertyControl=Md;vc.PropertyControl=Md;vc.PropertyControl=Md;vc.inspect=Qc;vc.inspect=Qc;vc.remoteInspect=Xd;vc.remoteInspect=Xd;vc.generateReferenceExpression=kd;vc.generateReferenceExpression=
kd;var Fe=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),sb=Ka.hasOwnProperty("NumberControls")&&"function"===typeof Ka.NumberControls?Ka.NumberControls:Ka.NumberControls=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,void 0,[{key:"className",get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new vc.VerticalLayout({spacing:0,
orderByIndex:!0})}},fill:{defaultValue:vc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(Q){this.submorphs.map(function(ua){return ua.fontColor=Q})}},submorphs:{initialize:function(){this.submorphs=[vc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:vc.rect(5,2,0,-6),fontSize:12}),vc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:vc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],Ka,{pathInPackage:function(){return"js/inspector.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23095,end:24127})}(vc.Morph);(function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),sb=Ka.hasOwnProperty("PropertyTree")&&"function"===typeof Ka.PropertyTree?Ka.PropertyTree:Ka.PropertyTree=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Eb(sb,va,[{key:"onDrag",value:function(Q){this._onDragHandler&&this._onDragHandler(Q)}}],[{key:"className",get:function(){return"PropertyTree"}}],Ka,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25279,end:25389})})(vc.Tree);Md=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),
sb=Ka.hasOwnProperty("Inspector")&&"function"===typeof Ka.Inspector?Ka.Inspector:Ka.Inspector=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(Q){}},{key:"__after_deserialize__",value:function(){var Q=this,ua=new vc.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:vc.InspectionTree.forObject(null,this)}));this.addMorph(ua,this.getSubmorphNamed("terminal toggler"));this.layout.col(0).row(1).group.morph=ua;this.whenRendered().then(function(){Q.targetObject&&(Q.targetObject=Q.targetObject)});Eb._get(Object.getPrototypeOf(sb.prototype),"__after_deserialize__",this).call(this)}},{key:"__additionally_serialize__",value:function(Q,ua,Za,ib){Q=Q.props.submorphs.value;for(ua=Q.length;ua--;)Za.refForId(Q[ua].id).realObj==this.ui.propertyTree&&
vc.arr.removeAt(Q,ua)}},{key:"renderDraggableTreeLabel",value:function(Q){return new vc.DraggableTreeLabel(Q)}},{key:"renderPropertyControl",value:function(Q){return vc.PropertyControl.render(Q)}},{key:"onLoad",value:function(){var Q=this.ui,ua=Q.codeEditor,Za=Q.thisBindingSelector,ib=Q.propertyTree;ua.changeEditorMode("js").then(function(){return ua.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Za.selection?ua.owner.selectedContext:ua.owner.targetObject},
get systemInterface(){return vc.Path("treeData.systemInterface").get(ib)},format:"esm"}}).catch(function(oc){return $world.logError(oc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(Q){Eb._get(Object.getPrototypeOf(sb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Q);Q=this.ui;var ua=Q.targetPicker,Za=Q.propertyTree,ib=Q.resizer,oc=Q.terminalToggler,cc=Q.unknowns,ad=Q.internals,Tc=Q.searchField,Vc=Q.codeEditor,Yd=Q.fixImportButton,Mf=Q.thisBindingSelector;Vc.changeEditorMode("js").then(function(){return Vc.evalEnvironment=
{targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Mf.selection?Vc.owner.selectedContext:Vc.owner.targetObject},get systemInterface(){return Za.treeData.systemInterface},format:"esm"}}).catch(function(Bf){return $world.logError(Bf)});vc.connect(ua,"onMouseDown",this,"selectTarget");vc.connect(Za,"onScroll",this,"repositionOpenWidget");vc.connect(ib,"onDrag",this,"adjustProportions");vc.connect(oc,"onMouseDown",this,"toggleCodeEditor");vc.connect(cc,"trigger",this,"filterProperties");
vc.connect(ad,"trigger",this,"filterProperties");vc.connect(Tc,"searchInput",this,"filterProperties");vc.connect(Za,"nodeCollapseChanged",this,"filterProperties");vc.connect(this,"extent",this,"relayout");vc.connect(Mf,"selection",this,"bindCodeEditorThis");vc.connect(Yd,"fire",Vc,"execCommand",{updater:function(Bf){return Bf("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var Q=this.ui.propertyTree.selectedIndex-1,ua=this.ui.propertyTree.selectedNode;
this.ui.propertyTree.selectedNode.refreshProperty();ua=this.ui.propertyTree.document.getLine(Q).textAndAttributes.slice(0,4).concat(ua.display(this));Q=this.ui.propertyTree.lineRange(Q,!1);this.ui.propertyTree.replace(Q,ua,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),
this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var Q=vc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(Q!=this.lastChange||this.lastSubmorphs!=vc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==Q.prop&&this.repositionOpenWidget(),this.lastChange=Q,this.lastSubmorphs=vc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}}},{key:"refreshTreeView",value:function(){var Q;
this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(ua){ua=ua.node;ua.target&&(Q=ua.foldableNode?ua.target[ua.foldableNode.key][ua.key]:ua.target[ua.key],!vc.obj.equals(Q,ua.value)&&ua.refreshProperty&&ua.refreshProperty(Q))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(Q,ua){ua=void 0===ua?!1:ua;var Za=this,ib,oc,cc,ad,Tc,Vc,Yd,Mf,Bf,Hg,df,Bg,Di,Pg,Nj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oe){switch(Oe.nextAddress){case 1:if(!Za.isUpdating()){Oe.jumpTo(2);
break}return Oe.yield(Za.whenUpdated(),2);case 2:ib=vc.promise.deferred();oc=ib.promise;cc=!!Za.target;Za.updateInProgress=oc;Oe.setCatchFinallyBlocks(4);ua&&(ad=vc.LoadingIndicator.open("connecting to remote..."));if(!ua){Tc=vc.InspectionTree.forObject(Q,Za);Oe.jumpTo(6);break}return Oe.yield(vc.RemoteInspectionTree.forObject(Q,Za),7);case 7:Tc=Oe.yieldResult;case 6:return Vc=Tc,Yd=Za.ui.propertyTree,Oe.yield(Vc.collapse(Vc.root,!1),8);case 8:if(!Vc.root.children){Oe.jumpTo(9);break}return Oe.yield(Vc.collapse(Vc.root.children[0],
!1),9);case 9:if(Mf=Za.originalTreeData&&Za.originalTreeData.diff(Vc)){Bf=$jscomp.makeIterator(Mf);for(Hg=Bf.next();!Hg.done;Hg=Bf.next())df=Hg.value,Bg=$jscomp.makeIterator(df),Di=Bg.next().value,Pg=Bg.next().value,Di.refreshProperty(Pg.value);Oe.jumpTo(11);break}Yd.treeData=Vc;return Oe.yield(Za.filterProperties(),12);case 12:if(!Yd.treeData.root.isCollapsed){Oe.jumpTo(13);break}return Oe.yield(Yd.onNodeCollapseChanged({node:Vc.root,isCollapsed:!1}),14);case 14:Yd.selectedIndex=1;case 13:return Oe.yield(Yd.execCommand("uncollapse selected node"),
11);case 11:Za.toggleWindowStyle(cc);ad&&ad.remove();Oe.leaveTryBlock(5);break;case 4:Nj=Oe.enterCatchBlock(),Za.showError(Nj);case 5:Za.startStepping(1E3,"refreshAllProperties"),Za.updateInProgress=null,Oe.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(Q){Q=void 0===Q?!0:Q;var ua=this,Za,ib,oc,cc,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tc){if(1==Tc.nextAddress)return Za=300,cc=ua.ui.codeEditor.pluginFind(function(Vc){return Vc.runEval}),ad=ua.getWindow(),Tc.yield(cc.runEval("System.get('@system-env').node"),
2);Tc.yieldResult.value?(oc=[].concat($jscomp.arrayFromIterable(vc.arr.without(ad.styleClasses,"local")),["node"]),ib=vc.DarkTheme.instance):(oc=["local"].concat($jscomp.arrayFromIterable(ad?vc.arr.without(ad.styleClasses,"node"):[])),ib=vc.DefaultTheme.instance);cc.theme=ib;Q?(ad&&ad.animate({duration:Za,styleClasses:oc}),ua.ui.codeEditor.animate({fill:ib.background,duration:Za})):ad&&(ad.styleClasses=oc);ua.ui.codeEditor.textString=ua.ui.codeEditor.textString;cc.highlight();Tc.jumpToEnd()})}},{key:"isUpdating",
value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var Q=this,ua=Object.assign({type:"text",borderWidth:1,borderColor:vc.Color.gray,lineWrapping:"by-chars"},vc.config.codeEditor.defaultStyle,{textString:""}),Za=vc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});vc.rect(0,0,this.width,30);var ib=new vc.SearchField({styleClasses:["idle"],
name:"searchField"});Za[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[ib,{type:"button",name:"targetPicker",padding:vc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:vc.Icon.textAttribute("crosshairs")},new vc.LabeledCheckBox({label:"Internals",name:"internals"}),new vc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new vc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:vc.InspectionTree.forObject(null,
this)})),vc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},ua),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:vc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Za),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Za),[" selection",null])}]}];
this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){Q.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var Q=this,ua,Za,ib,oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cc){switch(cc.nextAddress){case 1:if(Q.env.eventDispatcher.isKeyPressed("Shift"))return Za=$jscomp,ib=Za.makeIterator,cc.yield($world.execCommand("select morph",{justReturn:!0}),
5);Q.toggleSelectionInstructions(!0);return cc.yield(vc.InteractiveMorphSelector.selectMorph(),4);case 4:ua=cc.yieldResult;Q.toggleSelectionInstructions(!1);cc.jumpTo(3);break;case 5:oc=ib.call(Za,cc.yieldResult),ua=oc.next().value;case 3:ua&&(Q.targetObject=ua),cc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(Q){if(Q&&!this.instructionWidget){var ua=vc.morph({type:"label",name:"escapeKey",value:"esc"});ua.whenRendered().then(function(){return ua.fit()});this.instructionWidget=
this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},ua,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(Q){Q=
Q.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;Q.epiMorph=!0;this.openWidget=Q;vc.once(Q,"close",this,"closeOpenWidget");vc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var Q=this.ui.propertyTree,ua=Q.textLayout.boundsFor(Q,{column:0,row:Q.selectedIndex-1});ua=Q.worldPoint(vc.pt(ua.x,ua.y+ua.height/2)).addPt(Q.scroll.negated());Q=Q.globalBounds();ua.x=this.globalBounds().center().x;
ua.y<Q.top()?ua=Q.topCenter():Q.bottom()-20<ua.y&&(ua=Q.bottomCenter().addXY(0,-20));return ua}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(Q){this.layout.row(1).height+=Q.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(Q){if(Q!==this.isEditorVisible()){var ua=this.extent,
Za=this.layout,ib=this.ui,oc=ib.terminalToggler,cc=ib.codeEditor,ad=ib.thisBindingSelector;ib=ib.fixImportButton;Za.disable();Q?(oc.fontColor=vc.Color.rgbHex("00e0ff"),Za.row(3).height=this.codeEditorHeight||180,Za.row(2).height=5,ib.animate({visible:!0,duration:200}),ad.animate({visible:!0,duration:200})):(this.codeEditorHeight=Za.row(3).height,oc.fontColor=vc.Color.white,Za.row(3).height=Za.row(2).height=0,ib.animate({visible:!1,duration:200}),ad.animate({visible:!1,duration:200}));this.extent=
ua;Za.enable({duration:200});this.relayout({duration:200});cc.focus();cc.animate({opacity:Q?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var Q=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){Q.makeEditorVisible(!Q.isEditorVisible());ua.jumpToEnd()})}},{key:"filterProperties",value:function(){var Q=this,ua,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){if(1==ib.nextAddress)return ua=Q.ui.searchField,Za=Q.ui.propertyTree,Q.originalTreeData||
(Q.originalTreeData=Za.treeData),vc.disconnect(Za.treeData,"onWidgetOpened",Q,"onWidgetOpened"),ib.yield(Za.treeData.filter({maxDepth:2,showUnknown:Q.ui.unknowns.checked,showInternal:Q.ui.internals.checked,iterator:function(oc){return ua.matches(oc.key)}}),2);Za.update();vc.connect(Za.treeData,"onWidgetOpened",Q,"onWidgetOpened");ib.jumpToEnd()})}},{key:"relayout",value:function(Q){Q=void 0===Q?{}:Q;var ua=this,Za,ib,oc,cc,ad,Tc,Vc,Yd,Mf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bf){ua.layout&&
ua.layout.forceLayout();Za=ua;ib=Za.ui;oc=ib.fixImportButton;cc=ib.terminalToggler;ad=ib.propertyTree;Tc=ib.thisBindingSelector;Vc=ad.bounds().insetBy(5).bottomLeft();Yd=ad.bounds().insetBy(5).bottomRight();Mf=Yd.subXY(oc.width+10,0);Tc.width=115;Tc.listMorph.itemHeight=20;Q.duration?(cc.animate(Object.assign({bottomLeft:Vc},Q)),oc.animate(Object.assign({bottomRight:Yd},Q)),Tc.animate(Object.assign({bottomRight:Mf},Q))):(cc.bottomLeft=Vc,oc.bottomRight=Yd,Tc.bottomRight=Mf);Bf.jumpToEnd()})}},{key:"keybindings",
get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Eb._get(Object.getPrototypeOf(sb.prototype),"keybindings",this))}},{key:"commands",get:function(){return vc.inspectorCommands}}],[{key:"className",get:function(){return"Inspector"}},{key:"openInWindow",value:function(Q){Q=new this(Q);Q.openInWindow().activate();return Q}},{key:"properties",get:function(){return{extent:{defaultValue:vc.pt(400,
500)},fill:{defaultValue:vc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(Q){this.setProperty("remoteTarget",Q);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(Q,!0))}},targetObject:{after:["submorphs"],set:function(Q){this._serializableTarget=Q&&Q.isMorph?Q.id:Q;this.setProperty("targetObject",Q);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(Q))}},
originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var Q=this.ui.propertyTree,ua=Q.selectedNode;Q=Q.treeData;return Q.getContextFor(ua?ua:Q.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),
propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:vc.Color.gray,fontSize:14,fontFamily:vc.config.codeEditor.defaultStyle.fontFamily}},
master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Ka,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25406,end:45502})}(vc.Morph);Md=vc.Inspector;ze=sa("I",Md);vc.default=Md;var mf=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");
mf.Inspector=ze;mf.string=Yc;mf.Morph=Cb;mf.pt=Bd;mf.Color=lb;Md=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(va,Ka,sb){sb=void 0===sb?1:sb;var Q,ua,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){switch(ib.nextAddress){case 1:return va.maybeSelectCommentOrLine(),ib.setCatchFinallyBlocks(2),Ka=Object.assign({},Ka,{logDoit:!0,inspect:!0,inspectDepth:sb}),ib.yield(va.doEval(void 0,Ka),4);case 4:Q=ib.yieldResult;ua=Q.error?
Q.error:Q.isError?Q.value:null;ib.leaveTryBlock(3);break;case 2:ua=Za=ib.enterCatchBlock();case 3:return ua?va.showError(ua):va.setStatusMessage(mf.string.truncate(Q.value,1E3)),ib.return(Q)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(va,Ka){var sb,Q,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){switch(Za.nextAddress){case 1:return Za.setCatchFinallyBlocks(2),Za.yield(va.doEval({start:{row:0,column:0},end:va.documentEndPosition},
Object.assign({},Ka,{logDoit:!0})),4);case 4:sb=Za.yieldResult;Q=sb.error?sb.error:sb.isError?sb.value:null;Za.leaveTryBlock(3);break;case 2:Q=ua=Za.enterCatchBlock();case 3:return Q?va.showError(Q):va.setStatusMessage(String(sb.value)),Za.return(sb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(va,Ka){var sb,Q,ua,Za,ib,oc,cc,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Tc){switch(Tc.nextAddress){case 1:return va.maybeSelectCommentOrLine(),
Tc.setCatchFinallyBlocks(2),Ka=Object.assign({},Ka,{asString:!1,logDoit:!0}),Tc.yield(va.doEval(void 0,Ka),4);case 4:sb=Tc.yieldResult;Q=sb.error?sb.error:sb.isError?sb.value:null;Tc.leaveTryBlock(3);break;case 2:Q=ua=Tc.enterCatchBlock();case 3:va.selection.collapseToEnd();if(Za=sb.value&&sb.value.isColor)return va.selection.text=String(sb.value),ib=new mf.Morph({fill:mf.Color.transparent,extent:mf.pt(va.fontSize+2,va.fontSize+2),submorphs:[{fill:sb.value,center:mf.pt(va.fontSize+2,va.fontSize+2).scaleBy(.5)}]}),
oc=va.selection.start,cc=oc.column,ad=oc.row,va.insertText([ib,{}],va.selection.start),va.selection.start={column:cc,row:ad},Tc.return(sb);va.insertTextAndSelect(Q?String(Q)+(Q.stack?"\n"+Q.stack:""):String(sb.value));return Tc.return(sb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(va,Ka){var sb,Q,ua,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){switch(ib.nextAddress){case 1:debugger;va.maybeSelectCommentOrLine();
Q=va.textInRange(va.selection);ua=va.evalEnvironment||{};Za=va.pluginFind(function(oc){return oc.isEditorPlugin&&"function"===typeof oc.runEval});ua.systemInterface||(ua.systemInterface=Za.systemInterface(Ka));if("local"!==ua.systemInterface.name){ib.jumpTo(2);break}ib.setCatchFinallyBlocks(3);return ib.yield(va.doEval(void 0,Ka),5);case 5:sb=ib.yieldResult;Q=sb.value;ib.leaveTryBlock(2);break;case 3:ib.enterCatchBlock();case 2:return va.world().execCommand("open object editor",{target:Q,evalEnvironment:ua}),
ib.return(sb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(va,Ka){var sb,Q,ua,Za,ib,oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cc){switch(cc.nextAddress){case 1:va.maybeSelectCommentOrLine();ua=va.textInRange(va.selection);Za=va.evalEnvironment||{};ib=va.pluginFind(function(ad){return ad.isEditorPlugin&&"function"===typeof ad.runEval});Za.systemInterface||(Za.systemInterface=ib.systemInterface(Ka));if("local"!==
Za.systemInterface.name){mf.Inspector.openInWindow({remoteTarget:{code:ua,evalEnvironment:Za}});cc.jumpTo(2);break}cc.setCatchFinallyBlocks(3);return cc.yield(va.doEval(void 0,Ka),5);case 5:sb=cc.yieldResult;Q=sb.error?sb.error:sb.isError?sb.value:null;ua=sb.value;cc.leaveTryBlock(4);break;case 3:Q=oc=cc.enterCatchBlock();case 4:mf.Inspector.openInWindow({targetObject:Q?Q:ua});case 2:return cc.return(sb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(va,Ka,sb){sb=void 0===sb?1:sb;var Q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){switch(ua.nextAddress){case 1:return va.maybeSelectCommentOrLine(),ua.setCatchFinallyBlocks(2),Ka=Object.assign({},Ka,{inspect:!0,inspectDepth:sb,logDoit:!0}),ua.yield(va.doEval(void 0,Ka),4);case 4:Q=ua.yieldResult;ua.leaveTryBlock(3);break;case 2:ua.enterCatchBlock();case 3:return va.selection.collapseToEnd(),va.insertTextAndSelect(Q.value),ua.return(Q)}})}}];mf.codeEvaluationCommands=
Md;mf.codeEvaluationCommands=Md;mf.codeEvaluationCommands=Md;var Jf=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Jf.changeAttributeInSelectionOrMorph=function(va,Ka,sb){var Q=va.selection;va.keepPosAtSameScrollOffsetWhile(function(){Q.isEmpty()?va[Ka]="function"===typeof sb?sb(va[Ka]):sb:(va.undoManager.group(),va.changeStyleProperty(Ka,function(ua){return"function"===typeof sb?sb(ua):sb}),va.undoManager.group())})};ze=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(va){var Ka=va.fontSize;Jf.changeAttributeInSelectionOrMorph(va,"fontSize",function(sb){sb=sb||Ka;return sb+(18<=sb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(va){var Ka=va.fontSize;Jf.changeAttributeInSelectionOrMorph(va,"fontSize",function(sb){sb=sb||Ka;return sb-(18>=sb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(va){var Ka,sb,Q,ua,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){if(1==ib.nextAddress){Ka=
["serif","sans-serif","monospace"];if(sb=localStorage["lively.morpic/text-change-font-additional-fonts"])sb=JSON.parse(sb),Ka.push.apply(Ka,$jscomp.arrayFromIterable(sb));Ka.map(function(oc){return oc.toLowerCase()}).includes(va.fontFamily.toLowerCase())||(Ka.push(va.fontFamily),sb=[].concat($jscomp.arrayFromIterable(sb||[]),[va.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(sb));return ib.yield($world.editListPrompt("choose font",Ka,{requester:va,preselect:Ka.indexOf(va.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}Q=ib.yieldResult;ua=$jscomp.makeIterator(Q.selections);if(Za=ua.next().value)va.fontFamily=Za;return ib.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(va,Ka){Ka=void 0===Ka?{}:Ka;var sb,Q,ua,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){if(1==ib.nextAddress){if(Ka.hasOwnProperty("link"))return ib.jumpTo(2);Q=va.selection;ua=va.getStyleInRange(Q);Za=ua.link;return ib.yield(va.world().prompt("Set link",
{input:Za||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=ib.nextAddress&&(sb=ib.yieldResult,!sb))return ib.return();va.undoManager.group();va.setStyleInRange({link:sb||void 0},Q);va.undoManager.group();ib.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(va,Ka){var sb,Q,ua,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){if(1==ib.nextAddress)return sb=va.selection,Q=va.getStyleInRange(sb),ua=Q.doit,ib.yield(va.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:va,input:ua?ua.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:va.evalEnvForDoit(ua||{})}),2);Za=ib.yieldResult;va.undoManager.group();Za?va.addTextAttribute({doit:{code:Za},nativeCursor:"pointer",textDecoration:"underline"},sb):va.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},sb);va.undoManager.group();ib.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(va,Ka){Ka=void 0===Ka?{}:Ka;va.undoManager.group();
Ka=!Ka.onlySelection&&va.selection.isEmpty()?va.documentRange:va.selection.range;va.setStyleInRange(null,Ka);va.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(va){var Ka,sb,Q,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==Za.nextAddress)return Za.yield(System.import("lively.modules"),2);if(3!=Za.nextAddress)return Ka=Za.yieldResult,sb=Ka.module,Za.yield(sb("lively.ide/text/ui.js").load(),3);Q=Za.yieldResult;ua=Q.RichTextControl;return Za.return(ua.openFor(va))})}}];
Jf.commands=ze;Jf.commands=ze;Jf.commands=ze;var ye=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");ye.guessTextModeName=Bb;ye.rangedToken=function(va,Ka,sb,Q,ua){return{start:{row:va,column:Ka},end:{row:va,column:sb},token:Q,mode:ua}};ye.fun=Ub;ye.arr=Wb;ye.connect=Gc;ye.disconnect=Fb;ye.DefaultTheme=ub;ye.tokenizeDocument=$a;ye.modeInfo=ra;ye.visitDocumentTokens=nc;ye.getMode=Rb;ye.completionCommands=ia;ye.multiSelectCommands=sc;ye.navCommands=Gd;ye.codeCommands=Ke;ye.codeEvaluationCommands=
Md;ye.richTextCommands=ze;ye.Color=lb;ye.Range=Dd;ye.guessTextModeName=Bb;ye.guessTextModeName=Bb;ub=function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),sb=Ka.hasOwnProperty("EditorPlugin")&&"function"===typeof Ka.EditorPlugin?Ka.EditorPlugin:Ka.EditorPlugin=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
ye.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(Q){var ua=this;this.textMorph=Q;ye.connect(Q,"textChange",this,"onTextChange");ye.connect(Q,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return ua.highlight()})}},
{key:"detach",value:function(Q){ye.disconnect(Q,"textChange",this,"onTextChange");ye.disconnect(Q,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(Q){this._ast=null;if(Q){var ua=this._tokenizerValidBefore;if("replace"===Q.selector){var Za=Q.args[0].start;Q=Za.row;Za=Za.column}else Za=Q=0;if(!ua||Q<ua.row||Q===ua.row&&Za<ua.column)Q=Math.max(0,Q),this._tokenizerValidBefore={row:Q,column:Za}}this.requestHighlight()}},
{key:"requestHighlight",value:function(Q){var ua=this;(void 0===Q?0:Q)?this.highlight():ye.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return ua.highlight()})()}},{key:"highlight",value:function(){var Q=this.textMorph,ua=this.theme,Za=this.mode,ib=this._tokenizerValidBefore;if(ua&&Q&&Q.document&&Za){Q.fill=ua.background;Q.cursorColor=ua.cursorColor||ye.Color.black;var oc=Q.viewState,cc={};ib=ye.tokenizeDocument(Za,Q.document,oc.firstVisibleRow,oc.lastVisibleRow,ib);Za=ib.lines;ib=
ib.tokens;if(Za.length){oc=Za[0].row;for(var ad=[],Tc=0;Tc<ib.length;oc++,Tc++)for(var Vc=ib[Tc],Yd=0;Yd<Vc.length;Yd+=5){var Mf=Vc[Yd],Bf=Vc[Yd+1],Hg=ua[Vc[Yd+2]]||ua.default;Hg&&ad.push({start:{row:oc,column:Mf},end:{row:oc,column:Bf}},Hg)}Q.embeddedMorphs.forEach(function(df){var Bg=Q.embeddedMorphMap.get(df).anchor;cc[df.id]=Q.textAttributeAt(Bg.position)});Q.setTextAttributesWithSortedRanges(ad);Q.embeddedMorphs.forEach(function(df){var Bg=Q.embeddedMorphMap.get(df).anchor;Bg=ye.Range.at(Bg.position);
Bg.end.column+=1;Q.replace(Bg,[df,cc[df.id]],!1)});this._tokenizerValidBefore={row:ye.arr.last(Za).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},Q,this)}}},{key:"visitTokensInRange",value:function(Q,ua){var Za=Q.start,ib=Q.end,oc=Za.row-1;ye.visitDocumentTokens(this.mode,this.textMorph.document,Za.row,ib.row,null,function(cc){return oc++},function(cc,ad,Tc,Vc,Yd,Mf,Bf){if(oc===Za.row&&0<Za.column){if(Za.column>=Vc)return;Tc<Za.column&&Za.column<Vc&&(Tc=Za.column)}if(oc===ib.row){if(ib.column<=
Tc)return;Tc<ib.column&&ib.column<Vc&&(Vc=ib.column)}ua(cc,ad,oc,Tc,Vc,Yd,Mf,Bf)})}},{key:"tokensInRange",value:function(Q){var ua=[];this.visitTokensInRange(Q,function(Za,ib,oc,cc,ad,Tc,Vc,Yd){return ua.push(ye.rangedToken(oc,cc,ad,Za,Yd))});return ua}},{key:"tokensOfRow",value:function(Q){var ua=this.textMorph.getLine(Q).length;return this.tokensInRange({start:{row:Q,column:0},end:{row:Q,column:ua}})}},{key:"tokenAt",value:function(Q){for(var ua=this.tokensOfRow(Q.row),Za=ua.length;Za--;){var ib=
ua[Za];if(ib.token&&ib.start.column<=Q.column&&Q.column<=ib.end.column)return ib}return null}},{key:"getCommands",value:function(Q){return[].concat($jscomp.arrayFromIterable(Q),$jscomp.arrayFromIterable(ye.completionCommands),$jscomp.arrayFromIterable(ye.multiSelectCommands),$jscomp.arrayFromIterable(ye.navCommands),$jscomp.arrayFromIterable(ye.codeCommands),$jscomp.arrayFromIterable(ye.codeEvaluationCommands),$jscomp.arrayFromIterable(ye.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var Q=this.mode,ua=Q.lineComment,Za=Q.blockCommentStart;Q=Q.blockCommentEnd;var ib={};ua&&(ib.lineCommentStart=ua);Za&&(ib.blockCommentStart=Za);Q&&(ib.blockCommentEnd=Q);return ib}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(Q,ua,Za){var ib=this.textMorph,oc=Q.row,cc=Q.column;Q=ua[cc-1];ua=ua[cc];ib.selection.text="\n";ib.selection.collapseToEnd();"{"===Q&&"}"===ua&&(ib.selection.text="\n"+" ".repeat(Za),ib.selection.collapse());
ib.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:oc+1,lastRow:oc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var Q=this.textMorph,ua=this.openPairs,Za=Q.selection,ib=Q.getLine(Za.end.row),oc=ib[Za.end.column-1];ib=ib[Za.end.column];Q.autoInsertPairs&&Za.isEmpty()&&oc in
ua&&ib===ua[oc]&&(Za.growRight(1),Za.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(Q){var ua=this.openPairs,Za=this.closePairs,ib=this.textMorph,oc=ib.selection,cc=ib.autoInsertPairs&&Q in ua,ad=ib.autoInsertPairs&&Q in Za;if(!cc&&!ad)return!1;var Tc=ib.getLine(oc.end.row)[oc.end.column];if(!oc.isEmpty()){if(!cc)return!1;Za=ib.undoManager.ensureNewGroup(ib);ib.insertText(ua[Q],oc.end);ib.insertText(Q,oc.start);ib.undoManager.group(Za);oc.growRight(-1);return!0}if(Tc in Za&&Q===Tc)return oc.goRight(1),
!0;if(ad&&!cc)return!1;Za=ib.undoManager.ensureNewGroup(ib);ib.insertText(Q+ua[Q]);ib.undoManager.group(Za);oc.goLeft(1);return!0}}],[{key:"className",get:function(){return"EditorPlugin"}}],Ka,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);ra=ub=ye.EditorPlugin;
ia=sa("C",function(va){var Ka=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),sb=Ka.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Ka.CodeMirrorEnabledEditorPlugin?Ka.CodeMirrorEnabledEditorPlugin:Ka.CodeMirrorEnabledEditorPlugin=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(sb,va,[{key:Symbol.for("lively-instance-initialize"),value:function(){Eb._get(Object.getPrototypeOf(sb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(Q){this.mode=this.codeMirrorMode(Q);return Eb._get(Object.getPrototypeOf(sb.prototype),"attach",this).call(this,Q)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(Q){return{indentWithTabs:!Q.useSoftTabs,indentUnit:Q.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(Q){Q=this.defaultCodeMirrorModeConfig(Q);
return ye.getMode(Q,{name:this.longName})}}],[{key:"className",get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Ka,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(ye.EditorPlugin));ye.CodeMirrorEnabledEditorPlugin=ia;ye.CodeMirrorEnabledEditorPlugin=ia;ye.CodeMirrorEnabledEditorPlugin=
ia;ye.default=ub;ub=Object.freeze({__proto__:null,guessTextModeName:Bb,"default":ra,CodeMirrorEnabledEditorPlugin:ia});sa("e",ub)}}});
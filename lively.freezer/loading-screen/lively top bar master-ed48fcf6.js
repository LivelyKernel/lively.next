System.register("./__root_module__-3c9a1ccb.js kld-intersections ./user-ui-6ad469c6.js ./editor-plugin-d3ce2fd0.js ./index-f326120b.js ./index-d6506ab5.js ./index-9d647415.js".split(" "),function(sa,lb){var Eb,Wb,Qb,Bd,Fc,wd,Kc,Gc;return{setters:[function(Yc){Eb=Yc.ag;Wb=Yc.am;Qb=Yc.a1;Bd=Yc.C;Fc=Yc.a4;wd=Yc.L;Kc=Yc.r;Gc=Yc.aq},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var Yc=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");Yc.Morph=
Eb;Yc.Icon=Wb;Yc.pt=Qb;Yc.Color=Bd;Yc.arr=Fc;Yc.LoadingIndicator=wd;Yc.resource=Kc;var jd=function(Dd){var od=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),Zc=od.hasOwnProperty("LivelyTopBar")&&"function"===typeof od.LivelyTopBar?od.LivelyTopBar:od.LivelyTopBar=function(Ra){Ra&&Ra[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Gc(Zc,Dd,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode=
"Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var Ra=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){if(1==tb.nextAddress)return Ra.isComponent?tb.return():tb.yield(Ra.whenRendered(),2);document.body.style.background="black";Ra.setEditMode("Halo");Ra.getSubmorphNamed("fast load toggler").refresh();tb.jumpToEnd()})}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=Yc.pt(0,0));var Ra=
this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;Ra.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var Ra=this;return Object.entries(this.shapeToIcon).map(function(tb){tb=$jscomp.makeIterator(tb);var dc=tb.next().value,bc=tb.next().value;tb=bc.shortcut;bc=bc.args;return[[].concat($jscomp.arrayFromIterable(Ra.currentShapeMode===dc?[].concat($jscomp.arrayFromIterable(Yc.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),
$jscomp.arrayFromIterable(Yc.Icon.textAttribute.apply(Yc.Icon,$jscomp.arrayFromIterable(bc))),["   "+dc+" ",{float:"none"},"      "+tb,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){Ra.currentShapeMode=dc;Ra.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var Ra=this;return Object.entries(this.sideBarToIcon).map(function(tb){tb=$jscomp.makeIterator(tb);var dc=tb.next().value;tb=tb.next().value.args;return[[].concat($jscomp.arrayFromIterable(Ra.activeSideBars.includes(dc)?
[].concat($jscomp.arrayFromIterable(Yc.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(Yc.Icon.textAttribute.apply(Yc.Icon,$jscomp.arrayFromIterable(tb))),["   "+dc+" ",{float:"none"}]),function(){return Ra.openSideBar(dc)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",
value:function(Ra){"Hand"==this._currentEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(Ra){Gc._get(Object.getPrototypeOf(Zc.prototype),"onKeyDown",this).call(this,Ra);if(Ra.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!Ra.isAltDown()){var tb={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(Ra.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=
tb[Ra.key];this.setEditMode("Shape");break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(Ra){var tb=this,dc,bc,Xc,Oc,$b,zc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fb){switch(Fb.nextAddress){case 1:tb.activeSideBars.includes(Ra)?Yc.arr.remove(tb.activeSideBars,Ra):tb.activeSideBars.push(Ra);if("Scene Graph"!=Ra){Fb.jumpTo(2);break}if(tb.sideBar){Fb.jumpTo(3);break}dc=Yc.LoadingIndicator.open("loading side bar");bc=tb;return Fb.yield(lb.import("./scene graph side bar master-941e6fdb.js"),
5);case 5:if(!(Xc=Fb.yieldResult)){Fb.jumpTo(6);break}return Fb.yield(Yc.resource("part://SystemIDE/scene graph side bar master"),7);case 7:Xc=Fb.yieldResult;case 6:return Fb.yield(Xc.read(),4);case 4:return bc.sideBar=Fb.yieldResult,tb.sideBar.hasFixedPosition=!0,tb.sideBar.openInWorld(),tb.sideBar.right=0,Fb.yield(tb.sideBar.whenRendered(),8);case 8:dc.remove();case 3:tb.sideBar.toggle(tb.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=Ra){Fb.jumpTo(0);break}if(tb.stylingPalette){Fb.jumpTo(10);
break}Oc=Yc.LoadingIndicator.open("loading side bar");$b=tb;return Fb.yield(lb.import("./styling side bar master-52e1dbcb.js"),12);case 12:if(!(zc=Fb.yieldResult)){Fb.jumpTo(13);break}return Fb.yield(Yc.resource("part://SystemIDE/styling side bar master"),14);case 14:zc=Fb.yieldResult;case 13:return Fb.yield(zc.read(),11);case 11:return $b.stylingPalette=Fb.yieldResult,tb.stylingPalette.hasFixedPosition=!0,tb.stylingPalette.openInWorld(),tb.stylingPalette.left=tb.world().right,Fb.yield(tb.stylingPalette.whenRendered(),
15);case 15:Oc.remove();case 10:tb.stylingPalette.toggle(tb.activeSideBars.includes("Styling Palette")),Fb.jumpToEnd()}})}},{key:"onMouseDown",value:function(Ra){var tb=this.get("select shape type"),dc=this.get("shape mode button"),bc=this.get("side bar selector");Ra.targetMorph==tb&&(this.world().openWorldMenu(Ra,this.getShapeMenuItems()).position=dc.globalBounds().bottomLeft().subPt(this.world().scroll));Ra.targetMorph==dc&&this.setEditMode("Shape");"text mode button"==Ra.targetMorph.name&&this.setEditMode("Text");
"hand mode button"==Ra.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==Ra.targetMorph.name&&this.setEditMode("Halo");"open component browser"==Ra.targetMorph.name&&this.interactivelyLoadComponent();Ra.targetMorph==bc&&(this.world().openWorldMenu(Ra,this.getSideBarMenuItems()).position=bc.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var Ra=this,tb,dc,bc,Xc,Oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){if(1==
$b.nextAddress)return tb=Ra.get("open component browser"),dc=Ra.get("user flap"),bc=dc.haloShadow,Xc=dc.haloColor,Oc=Yc.Color.rgb(102,102,102),tb.fontColor=Xc,tb.dropShadow=bc,$b.yield(Ra.world().execCommand("browse and load component"),2);tb.dropShadow=!1;tb.fontColor=Oc;$b.jumpToEnd()})}},{key:"setEditMode",value:function(Ra,tb){var dc=this;tb=void 0===tb?!1:tb;var bc=this.get("user flap"),Xc=bc.haloShadow,Oc=bc.haloColor,$b=Yc.Color.rgb(102,102,102);tb||(this._currentEditMode=Ra);tb=this.get("shape mode button");
bc=this.get("text mode button");var zc=this.get("hand mode button"),Fb=this.get("halo mode button");[["Shape",tb.submorphs],["Text",[bc]],["Hand",[zc]],["Halo",[Fb]]].forEach(function(Cb){var pc=$jscomp.makeIterator(Cb);Cb=pc.next().value;pc=pc.next().value;"Shape"==Ra?dc.world().toggleShapeMode(!0,dc.currentShapeMode):"Text"==Ra?dc.world().toggleShapeMode(!0,"Text"):dc.world().toggleShapeMode(!1);dc.world().showHaloPreviews("Halo"==Ra);Cb==Ra?pc.forEach(function(Pc){Pc.dropShadow=Xc;Pc.fontColor=
Oc}):pc.forEach(function(Pc){Pc.dropShadow=null;Pc.fontColor=$b})})}}],[{key:"className",get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],set:function(Ra){this.setProperty("currentShapeMode",Ra);this.get("shape status icon").textAndAttributes=Yc.Icon.textAttribute(this.shapeToIcon[Ra].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",
{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",
{paddingTop:"1px"}]},HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],od,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-151"}}},{start:328,end:9061})}(Yc.Morph);jd=Yc.LivelyTopBar;Yc.default=jd}}});
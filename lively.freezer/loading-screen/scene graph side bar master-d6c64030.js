System.register("./__root_module__-7d53b604.js lively.collab kld-intersections ./index-42dc99f4.js ./index-6ffa137d.js ./world-e64fbe56.js ./index-d74109c7.js ./index-a1a5f79d.js ./editor-plugin-d1aa29fa.js ./editor-plugin-d2520117.js ./index-556fb5c6.js".split(" "),function(){var wa,bb,ib,Qb,Ib,ed,qc,pd,uc,Ac,dd,Ad,le,Le,ae,lc,Wc,Ed,Tb,Bd,Sd,hc,mc,Hb,ec,vc,gd,Zc,Za,Xa,jb,Fa;return{setters:[function(Ea){wa=Ea.aJ;bb=Ea.av;ib=Ea.a_;Qb=Ea.aa;Ib=Ea.a3;ed=Ea.aO;qc=Ea.aF;pd=Ea.ak;uc=Ea.C;Ac=Ea.a2;
dd=Ea.a6;Ad=Ea.ab;le=Ea.bP;Le=Ea.l;ae=Ea.by;lc=Ea.bw;Wc=Ea.aK;Ed=Ea.ay;Tb=Ea.a1;Bd=Ea.bQ;Sd=Ea.bh;hc=Ea.bj;mc=Ea.aH;Hb=Ea.a4;ec=Ea.$;vc=Ea.be;gd=Ea.aG;Zc=Ea.bR},function(){},function(){},function(){},function(){},function(){},function(Ea){Za=Ea.d;Xa=Ea.s;jb=Ea.I},function(){},function(Ea){Fa=Ea.I},function(){},function(){}],execute:function(){function Ea(Ja){var hb=Ja.sourceObj,dc=Ja.targetObj;hb.isMorph&&dc.isMorph?(hb.show(),dc.show(),K.showConnector&&K.showConnector(hb,dc)):K.show(String(Ja))}
function ka(Ja){var hb=Ja.sourceObj,dc=Ja.sourceAttrName,na=Ja.targetObj,oa=Ja.targetMethodName,wb=Ja.getConverter();Ja=Ja.getUpdater();return K.printConnectionElements(hb,dc,na,oa,wb,Ja)}function ja(Ja,hb,dc,na,oa,wb){Ja="/* global connect, source, target */\nconnect(source, '"+hb+"', target, '"+na+"'";if(oa||wb)Ja+=", {\n";oa&&(Ja+="  converter: "+oa);oa&&wb&&(Ja+=",");oa&&(Ja+="\n");wb&&(Ja+="  updater: "+wb+"\n");if(oa||wb)Ja+="}";return Ja+");"}function Ca(Ja,hb){var dc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(na){if(1==
na.nextAddress)return na.yield(K.InteractiveMorphSelector.selectMorph(),2);dc=na.yieldResult;return na.return(dc?K.interactiveConnectGivenSourceAndTarget(Ja,hb,dc):null)})}function mb(Ja,hb,dc,na){var oa,wb,fc,Qa,Lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ld){switch(ld.nextAddress){case 1:oa=dc&&dc.world().targetDataBindings(dc);wb=Ja.world();if(!oa||!oa.length)return wb.setStatusMessage("connect canceled"),ld.return();if(hb){ld.jumpTo(2);break}fc=[{isListItem:!0,string:"[Enter custom attribute..]",
value:{custom:!0}}].concat($jscomp.arrayFromIterable(K.arr.flatten(Ja.world().targetDataBindings(Ja)).map(function(od){return{isListItem:!0,string:od.signature||od.name,value:od}})));return ld.yield(wb.listPrompt(["Select Source Attribute\n",{},"Choose the attribute of the morph that is supposed to invoke the connection. This can be a method, property or a custom signal that is invoked upon the morph.",{paddingTop:"10px",fontSize:14,textAlign:"left",fontWeight:"normal"}],fc,{filterable:!0}),3);case 3:hb=
ld.yieldResult;if("canceled"==hb.status)return ld.return();hb=hb.selected[0];hb=hb.custom?"sourceAttribute":hb.name;case 2:return Qa=[{isListItem:!0,string:"[Enter custom attribute...]",value:{custom:!0}}].concat($jscomp.arrayFromIterable(K.arr.flatten(oa).map(function(od){return{isListItem:!0,value:od,string:od.signature||od.name}}))),ld.yield(wb.listPrompt(["Select Target Attribute\n",{},"Choose the attribute of the morph that is supposed to invoked once the connection is triggered. This can be either a method or a property of the morph. When selecting a property, keep in mind that the value of the source attribute will be assigned to the property or passed to the method as an argument.",
{fontSize:14,textAlign:"left",fontWeight:"normal",paddingTop:"10px"}],Qa,{filterable:!0}),4);case 4:Lc=ld.yieldResult;if("canceled"==Lc.status)return ld.return();Lc=Lc.selected[0];return ld.yield(K.interactivelyEvaluateConnection({sourceObj:Ja,sourceAttr:hb,targetObj:dc,targetAttr:Lc.custom?"targetAttribute":Lc.name,onConnect:na,prompt:"Edit and confirm connection:"}),0)}})}function Ub(Ja,hb,dc,na){hb=void 0===hb?"confirm connection":hb;var oa,wb,fc,Qa,Lc,ld,od;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Be){oa=
Ja;wb=oa.sourceObj;fc=oa.sourceAttrName;Qa=oa.targetObj;Lc=oa.targetMethodName;ld=Ja.getConverter();od=Ja.getUpdater();return Be.return(K.interactivelyEvaluateConnection({sourceObj:wb,sourceAttr:fc,targetObj:Qa,targetAttr:Lc,converter:ld,updater:od,prompt:hb,highlight:dc,onConnect:na}))})}function Ya(Ja,hb,dc,na,oa){na=void 0===na?{}:na;oa=K.rect(0).sides.concat(K.rect(0).corners);dc=dc||new K.Leash(Object.assign({isSmooth:!0,styleClasses:["Halo"],borderColor:K.Color.orange,epiMorph:!0,endpointStyle:{start:{fill:K.Color.transparent,
nativeCursor:"auto"},end:{fill:K.Color.orange}}},na,{hasFixedPosition:!0}));dc.startPoint.attachTo(Ja,"rightCenter");hb.isMorph?(na=hb.globalBounds().partNameNearest(oa,Ja.globalPosition),Ja.globalPosition.equals(hb.globalBounds().partNamed(na))&&hb.globalBounds().partNameNearest(K.arr.without(oa,na),Ja.globalPosition),dc.endPoint.attachTo(hb,"leftCenter")):(oa=Ja.globalBounds().topRight().addPt(K.pt(100,0)),hb=K.morph({type:"label",value:hb.toString(),styleClasses:["Tooltip"],padding:K.rect(8,4)}).openInWorld(oa),
hb.position=Ja.world().bounds().translateForInclusion(hb.bounds()).topLeft(),K.once(dc,"remove",hb,"remove"),dc.endPoint.attachTo(hb,"leftCenter"));return dc}function $a(Ja){var hb,dc,na,oa,wb,fc,Qa,Lc,ld,od,Be,sd,Ze,Hf,sc,Yb,Ce,Wb,cb,Xb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(H){switch(H.nextAddress){case 1:hb=Ja;dc=hb.sourceObj;na=hb.sourceAttr;oa=hb.targetObj;wb=hb.targetAttr;fc=hb.converter;Qa=hb.updater;Lc=hb.prompt;ld=void 0===hb.highlight?!0:hb.highlight;od=hb.onConnect;
Be="lively://lively.bindings-interactive-connect/x"+dc.id;sd={context:window,format:"esm",targetModule:Be,classTransform:K.classToFunctionTransform};Ze=K.printConnectionElements(dc,na,oa,wb,fc,Qa);oa.isMorph&&dc.isMorph&&(Hf=oa.propertiesAndPropertySettings().properties[wb]||{type:typeof oa[wb]},sc=Hf.type,Yb=dc.propertiesAndPropertySettings().properties[na]||{type:typeof dc[na]},Ce=Yb.type,Ce!==sc&&(Lc=["Edit and confirm connection:\n",{},"Source: ",{fontSize:14,fontWeight:"normal"},dc.toString(),
{fontSize:14,fontWeight:"normal",fontStyle:"italic"},"\nTarget: ",{fontSize:14,fontWeight:"normal"},oa.toString(),{fontSize:14,fontWeight:"normal",fontStyle:"italic"}]));Wb={};Object.assign(lively.modules.module(Be).recorder,(Wb.source=dc,Wb.target=oa,Wb.connect=K.connect,Wb.once=K.once,Wb[na]=dc[na],Wb));if(!Lc){cb=Ze;H.jumpTo(2);break}return H.yield($world.editPrompt(Lc,{input:Ze,historyId:"lively.bindings-interactive-morph-connect",mode:"js",requester:$world,evalEnvironment:sd,animated:!1}),3);
case 3:if(cb=H.yieldResult,!cb)return $world.setStatusMessage("connect canceled"),H.return();case 2:return H.yield(lively.vm.runEval(cb,sd),4);case 4:Xb=H.yieldResult;if(Xb.isError)return $world.logError(Xb.value),H.return($a({sourceObj:dc,sourceAttr:na,targetObj:oa,targetAttr:wb,converter:fc,updater:Qa,prompt:"confirm connection",highlight:ld,onConnect:od}));ld&&($world.setStatusMessage("connected!",K.Color.green),K.interactivelyShowConnection(Xb.value));"function"===typeof od&&od(Xb);H.jumpToEnd()}})}
var Ua=lively.FreezerRuntime.recorderFor("ProtoInspector/index.js");Ua.Inspector=Fa;var U=function(Ja){var hb=lively.FreezerRuntime.recorderFor("ProtoInspector/index.js"),dc=hb.hasOwnProperty("ProtoInspector")&&"function"===typeof hb.ProtoInspector?hb.ProtoInspector:hb.ProtoInspector=function(na){na&&na[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wa(dc,Ja,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoInspector"}},
{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],hb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoInspector",version:"0.1.1-0"}}},{start:68,end:210})}(Ua.Inspector);U=Ua.ProtoInspector;Ua.default=U;var Ba=lively.FreezerRuntime.recorderFor("MorphicSideBar/index.js");Ba.Morph=bb;Ba.touchInputDevice=
ib;Ba.easings=Qb;Ba.pt=Ib;Ba.fun=ed;Ba.connect=qc;Ua=function(Ja){var hb=lively.FreezerRuntime.recorderFor("MorphicSideBar/index.js"),dc=hb.hasOwnProperty("MorphicSideBar")&&"function"===typeof hb.MorphicSideBar?hb.MorphicSideBar:hb.MorphicSideBar=function(na){na&&na[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wa(dc,Ja,[{key:"relayout",value:function(){this.onWorldResize()}},{key:"onWorldResize",value:function(na){na=void 0===
na?!0:na;if(this.respondsToVisibleWindow){var oa=$world.visibleBounds(),wb=navigator.standalone&&Ba.touchInputDevice?25:0;this.height=oa.height-wb;this.top=wb+oa.top();wb=this.get("horizontal resizer");wb.height=this.height;wb.top=0;na&&(this.visible?this.topLeft=oa.topLeft():this.topRight=oa.topLeft())}}},{key:"switchMode",value:function(na){"inspector"==na&&this.showInspector();"connections"==na&&this.showConnections()}},{key:"showInspector",value:function(){this.get("inspector").visible=!0;this.get("connections tree").visible=
!1}},{key:"showConnections",value:function(){this.get("inspector").visible=!1;this.get("connections tree").visible=!0}},{key:"toggle",value:function(na){var oa=this,wb,fc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){switch(Qa.nextAddress){case 1:wb=$world.visibleBounds();fc=navigator.standalone&&Ba.touchInputDevice?25:0;oa.height=wb.height-fc;oa.top=fc+wb.top();if(na)return $world.addMorph(oa,$world.get("lively top bar")),oa.topRight=wb.topLeft(),oa.attachToWorld($world),oa.visible=
!0,Qa.yield(oa.whenRendered(),5);oa.detachFromWorld($world);return Qa.yield(oa.animate({opacity:0,topRight:wb.topLeft(),duration:300}),4);case 4:oa.visible=!1;oa.remove();Qa.jumpTo(0);break;case 5:return oa.onWorldResize(!1),oa.get("scene graph").adjustProportions(),Qa.yield(oa.animate({opacity:1,easing:Ba.easings.outCirc,topLeft:wb.topLeft(),duration:300}),6);case 6:oa.get("scene graph").refresh(),Qa.jumpToEnd()}})}},{key:"attachToWorld",value:function(na){Ba.connect(na,"onChange",this,"onHierarchyChange",
{garbageCollect:!0});Ba.connect(na,"onSubmorphChange",this,"onHierarchyChange",{garbageCollect:!0});Ba.connect(na,"showHaloFor",this,"selectNode",{garbageCollect:!0})}},{key:"detachFromWorld",value:function(na){var oa=this;na.attributeConnections.forEach(function(wb){wb.targetObj===oa&&wb.disconnect()})}},{key:"selectNode",value:function(na){this.getSubmorphNamed("scene graph").selectMorphInTarget(na);this.getSubmorphNamed("connections tree").inspectConnectionsOf(na)}},{key:"onHierarchyChange",value:function(na){var oa=
this,wb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fc){if("addMorphAt"===na.selector||"removeMorph"===na.selector||"name"===na.prop){wb=oa._sceneGraph||(oa._sceneGraph=oa.getSubmorphNamed("scene graph"));if(!wb||!wb.owner.visible||na.target&&na.target.isHand||na.target&&wb.ignoreMorph(na.target)||na.args&&!na.args[0].isHalo&&wb.ignoreMorph(na.args[0])||na.target.ownerChain().find(function(Qa){return wb.ignoreMorph(Qa)}))return fc.return();Ba.fun.debounceNamed("scene-graph-update",
50,function(){return wb.refresh()})()}fc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphicSideBar"}},{key:"properties",get:function(){return{isHaloItem:{get:function(){return!1}}}}}],hb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"MorphicSideBar",version:"0.1.1-76"}}},{start:226,end:3668})}(Ba.Morph);
Ua=Ba.MorphicSideBar;Ba.default=Ua;var K=lively.FreezerRuntime.recorderFor("lively.ide/fabrik.js");K.interactivelyShowConnection=Ea;K.printConnection=ka;K.printConnectionElements=ja;K.interactiveConnectGivenSource=Ca;K.interactiveConnectGivenSourceAndTarget=mb;K.interactivelyReEvaluateConnection=Ub;K.visualizeConnection=Ya;K.interactivelyEvaluateConnection=$a;K.connect=qc;K.once=pd;K.Color=uc;K.rect=Ac;K.pt=Ib;K.arr=dd;K.morph=Ad;K.Leash=le;K.showConnector=Za;K.show=Xa;K.InteractiveMorphSelector=
jb;K.classToFunctionTransform=Le;K.interactivelyShowConnection=Ea;K.interactivelyShowConnection=Ea;K.printConnection=ka;K.printConnection=ka;K.printConnectionElements=ja;K.printConnectionElements=ja;K.interactiveConnectGivenSource=Ca;K.interactiveConnectGivenSource=Ca;K.interactiveConnectGivenSourceAndTarget=mb;K.interactiveConnectGivenSourceAndTarget=mb;K.interactivelyReEvaluateConnection=Ub;K.interactivelyReEvaluateConnection=Ub;K.visualizeConnection=Ya;K.visualizeConnection=Ya;K.interactivelyEvaluateConnection=
$a;K.interactivelyEvaluateConnection=$a;var V=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js");V.Tree=ae;V.TreeData=lc;V.morph=Ad;V.Icon=Wc;V.HorizontalLayout=Ed;V.easings=Qb;V.Morph=bb;V.Color=uc;V.Rectangle=Tb;V.rect=Ac;V.pt=Ib;V.connect=qc;V.noUpdate=Bd;V.disconnect=Sd;V.disconnectAll=hc;V.once=pd;V.arr=dd;V.num=mc;V.fun=ed;V.tree=Hb;V.promise=ec;V.ConnectionHalo=_missingExportShim;V.getClassName=vc;Ua=function(Ja){var hb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),
dc=hb.hasOwnProperty("InteractiveTreeContainer")&&"function"===typeof hb.InteractiveTreeContainer?hb.InteractiveTreeContainer:hb.InteractiveTreeContainer=function(na){na&&na[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wa(dc,Ja,[{key:"onChildRemoved",value:function(na){}},{key:"onChildAdded",value:function(na){}},{key:"toggleSelected",value:function(na){if(this.tree){var oa=this.tree,wb=oa.selectionFontColor,fc=oa.nonSelectionFontColor;
this.submorphs.filter(function(Qa){return!Qa._isControlElement&&Qa.styleClasses.includes("Label")}).forEach(function(Qa){Qa.fontColor=na?wb:fc})}}},{key:"onGrab",value:function(na){var oa=this.tree,wb=this.node;this.fill=V.Color.gray.withA(.5);this.fontColor=oa.selectionFontColor;this.opacity=.8;wa._get(Object.getPrototypeOf(dc.prototype),"onGrab",this).call(this,na);wb&&(this.toggleSelected(!1),oa.collapse(wb),oa.treeData.parentNode(wb).container.onChildRemoved(this),this._data=oa.treeData.remove(wb),
wb.container.target.remove(),oa.update(!0))}},{key:"wantsToBeDroppedOn",value:function(na){this.showPreviewOn(na);return!0}},{key:"showPreviewOn",value:function(na){if(na.isContainer)var oa=na.tree;na.isTree&&(oa=na);oa&&oa.showDropPreviewFor&&oa.showDropPreviewFor(this)}},{key:"insertAsChild",value:function(na){var oa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){if(1==wb.nextAddress)return oa.tree.treeData.add(na._data,oa.node,oa.node.children[0]),oa.tree.uncollapse(oa.node),
oa.tree.treeData.remove(oa.tree._previewNode),wb.yield(oa.tree.whenRendered(),2);oa.tree.update(!0);oa.onChildAdded(na);wb.jumpToEnd()})}},{key:"onBeingDroppedOn",value:function(na,oa){var wb=this;debugger;this.tree._dropInProgress=!0;wa._get(Object.getPrototypeOf(dc.prototype),"onBeingDroppedOn",this).call(this,na,oa);na=function(){wb.fill=V.Color.gray.withA(.5);wb.opacity=1;wb.tree._dropInProgress=!1;wb.tree.refresh()};oa.isTree?oa.insertAtPlaceholder(this).then(na):oa.isContainer?oa.insertAsChild(this).then(na):
na()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveTreeContainer"}},{key:"properties",get:function(){return{fill:{defaultValue:V.Color.transparent},isContainer:{get:function(){return!0}},tree:{},node:{readOnly:!0,get:function(){var na=this,oa=this.tree.treeData;return oa&&oa.asList().find(function(wb){return wb.container===na})}}}}}],hb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"InteractiveTree",version:"0.1.1-1104"}}},{start:498,end:2975})}(V.Morph);V.InteractiveTreeContainer=Ua;V.InteractiveTreeContainer=Ua;V.InteractiveTreeContainer=Ua;Ua=function(Ja){var hb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),dc=hb.hasOwnProperty("InteractiveTreeData")&&"function"===typeof hb.InteractiveTreeData?hb.InteractiveTreeData:hb.InteractiveTreeData=function(na){na&&na[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return wa(dc,Ja,[{key:"display",value:function(na){return[na.container||"<NO CONTAINER>",{}]}},{key:"isCollapsed",value:function(na){return na.isCollapsed}},{key:"collapse",value:function(na,oa){na.isCollapsed=oa}},{key:"getChildren",value:function(na){var oa=this;return na.isLeaf?null:na.children.filter(function(wb){return wb&&(oa.filterActive?wb.visible:!0)})}},{key:"isLeaf",value:function(na){var oa=this;return!na.children||0==na.children.filter(function(wb){return wb&&(oa.filterActive?
wb.visible:!0)}).length}},{key:"add",value:function(na,oa,wb){oa=void 0===oa?this.root:oa;oa.children||(oa.children=[]);wb?V.arr.pushAt(oa.children,na,oa.children.indexOf(wb)):oa.children.push(na);oa.isLeaf=!1}},{key:"replace",value:function(na,oa){var wb=this.parentNode(na);na=wb.children.indexOf(na);wb.children[na]=oa}},{key:"next",value:function(na){var oa=this.parentNode(na);return oa&&oa.children[oa.children.indexOf(na)+1]}},{key:"isBefore",value:function(na,oa){this.next(na)===oa}},{key:"isAfter",
value:function(na,oa){this.next(oa)===na}},{key:"addBefore",value:function(na,oa){this.add(na,this.parentNode(oa),oa)}},{key:"addAfter",value:function(na,oa){var wb=this.parentNode(oa);oa=wb.children.indexOf(oa)+1;this.add(na,wb,wb.children[oa])}},{key:"remove",value:function(na){var oa=this.parentNode(na);if(oa)return V.arr.remove(oa.children,na),oa.children==[]&&(oa.children=null),na}},{key:"filter",value:function(na,oa){oa=void 0===oa?1:oa;var wb=this,fc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qa){if(1==
Qa.nextAddress)return Qa.yield(wb.uncollapseAll(function(Lc,ld){return ld<oa+1}),2);fc=wb.filterActive;wb.filterActive=!1;wb.asListWithIndexAndDepth(!1).reverse().forEach(function(Lc){var ld=Lc.node;if(0==Lc.depth)return ld.visible=!0;ld.visible=na(ld);ld.visible||ld.isCollapsed||!ld.children.find(function(od){return od.visible})?ld.container.opacity=1:(ld.visible=!0,ld.container.opacity=.5);return ld.visible});wb.filterActive=fc;Qa.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveTreeData"}}],
hb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1104"}}},{start:2984,end:5447})}(V.TreeData);V.InteractiveTreeData=Ua;V.InteractiveTreeData=Ua;V.InteractiveTreeData=Ua;Ua=function(Ja){var hb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),dc=hb.hasOwnProperty("InteractiveTree")&&"function"===
typeof hb.InteractiveTree?hb.InteractiveTree:hb.InteractiveTree=function(na){na&&na[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wa(dc,Ja,[{key:"update",value:function(na){var oa=this;wa._get(Object.getPrototypeOf(dc.prototype),"update",this).call(this,na);this.treeData&&this.relayoutContainers();na&&this.embeddedMorphs.forEach(function(wb){wb.isContainer&&(wb.fill=V.Color.transparent,wb.fontFamily=oa.fontFamily,wb.fontSize=
oa.fontSize)})}},{key:"onDrop",value:function(na){wa._get(Object.getPrototypeOf(dc.prototype),"onDrop",this).call(this,na);this.treeData.remove(this._previewNode);this.update(!0)}},{key:"onDropHoverIn",value:function(na){}},{key:"onDropHoverUpdate",value:function(na){}},{key:"onDropHoverOut",value:function(na){}},{key:"onHoverOut",value:function(na){var oa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){wa._get(Object.getPrototypeOf(dc.prototype),"onHoverOut",oa).call(oa,na);
oa._previewNode&&oa._previewNode.container.world()&&oa.treeData.remove(oa._previewNode);oa.resetContainerSelection();oa.update(!0);wb.jumpToEnd()})}},{key:"insertAtPlaceholder",value:function(na){var oa=this,wb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fc){if(1==fc.nextAddress)return wb=oa.treeData.parentNode(oa._previewNode),oa.treeData.replace(oa._previewNode,na._data),oa.treeData.remove(oa._previewNode),fc.yield(oa.whenRendered(),2);oa.update(!0);wb.container.onChildAdded(na);
fc.jumpToEnd()})}},{key:"scrollUpSlowly",value:function(){var na=this;if(!this._scrollingUp){this._scrollingUp=!0;var oa=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){if(1==wb.nextAddress)return na._scrollingUp&&0<na.scroll.y?wb.yield(na.animate({scroll:na.scroll.subXY(0,30),duration:300,easing:V.easings.linear}),3):(na._scrollingUp=!1,wb.jumpTo(0));oa();wb.jumpToEnd()})};oa()}}},{key:"scrollDownSlowly",value:function(){var na=this;if(!this._scrollingDown){this._scrollingDown=
!0;var oa=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){if(1==wb.nextAddress)return na._scrollingDown&&na.scroll.y<na.scrollExtent.y-na.height?wb.yield(na.animate({scroll:na.scroll.addXY(0,30),duration:300,easing:V.easings.linear}),3):(na._scrollingDown=!1,wb.jumpTo(0));oa();wb.jumpToEnd()})};oa()}}},{key:"stopScrollingSlowly",value:function(){this._scrollingUp=this._scrollingDown=!1}},{key:"resetContainerSelection",value:function(){this.embeddedMorphs.forEach(function(na){na.isContainer&&
(na.fill=V.Color.transparent)})}},{key:"showDropPreviewFor",value:function(na){var oa=this;na=this.localize(na.globalBounds().center());var wb=this.textPositionFromPoint(na),fc=this.treeData.asListWithIndexAndDepth(function(sd){sd=sd.node;return sd!=oa._previewNode&&sd.container.world()}),Qa=(fc.find(function(sd){return sd.i-1===wb.row})||{}).node,Lc=Qa&&Qa.container,ld=this.ensurePlaceholder(),od=!!ld.container.world(),Be=na.subPt(this.scroll).subPt(this.scrollbarOffset);10>Be.y?this.scrollUpSlowly():
Be.y>this.height-50?this.scrollDownSlowly():this.stopScrollingSlowly();this.resetContainerSelection();if(!Lc){if(fc.length>wb.row||V.arr.last(this.treeData.root.children)===ld)return;this.treeData.remove(ld);this.treeData.add(ld);this.update(!0)}if(Lc){fc=this.textLayout.boundsFor(this,wb);if(4>Math.abs(fc.top()-na.y)){if(this.treeData.isBefore(ld,Qa))return;this.treeData.remove(ld);this.treeData.addBefore(ld,Qa)}else if(4>Math.abs(fc.bottom()-na.y)&&(Qa.isCollapsed||this.treeData.isLeaf(Qa))){if(this.treeData.isAfter(ld,
Qa))return;this.treeData.remove(ld);this.treeData.addAfter(ld,Qa)}else{Lc.fill=V.Color.gray;if(!od)return;this.treeData.remove(ld)}this.update(!0)}}},{key:"ensurePlaceholder",value:function(){var na=V.pt(this.width-100,this.document.getLine(0).height);this._previewNode||(this._previewNode={container:V.morph({acceptsDrops:!1,reactsToPointer:!1,fill:V.Color.gray,borderRadius:5}),isCollapsed:!0,isLeaf:!0});this._previewNode.container.extent=na;return this._previewNode}},{key:"relayoutContainers",value:function(){var na=
this;this.charBoundsFromTextPosition({row:0,column:6});this.textLayout.charBoundsOfRow(this,0).map(function(oa){return oa.height});this.treeData.asListWithIndexAndDepth().forEach(function(oa){var wb=oa.node;oa=oa.i;wb.container.nativeCursor="grab";wb.container.width=na.width-25-wb.container.left;wb.container.toggleSelected&&wb.container.toggleSelected(oa==na.selectedIndex)});this.anchors.forEach(function(oa){return oa.position=oa.position})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InteractiveTree"}}],
hb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",version:"0.1.1-1104"}}},{start:5456,end:10830})}(V.Tree);V.InteractiveTree=Ua;V.InteractiveTree=Ua;V.InteractiveTree=Ua;Ua=function(Ja){var hb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),dc=hb.hasOwnProperty("SceneGraphTree")&&"function"===typeof hb.SceneGraphTree?
hb.SceneGraphTree:hb.SceneGraphTree=function(na){na&&na[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wa(dc,Ja,[{key:"beforePublish",value:function(){this.submorphs=[];this.reset()}},{key:"selectMorphInTarget",value:function(na){var oa=this.treeData.asList().find(function(wb){return wb.container.target===na});oa&&this.selectedNode!=oa&&this.selectPath(this.treeData.pathOf(oa))}},{key:"onLoad",value:function(){var na=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){if(1==
oa.nextAddress)return oa.yield(na.whenRendered(),2);if(3!=oa.nextAddress){if(na.ownerChain().find(function(wb){return wb.isComponent}))return oa.return();na.submorphs=[];return oa.yield(na.whenRendered(),3)}na.get("inspector").makeEditorVisible(!0);na.get("inspector").makeEditorVisible(!1);na.setTarget($world);oa.jumpToEnd()})}},{key:"adjustProportions",value:function(na){na=(na?na.state.dragDelta:{y:0}).y;var oa=this.get("inspector"),wb=this.get("scene graph resizer"),fc=this.get("mode selector"),
Qa=this.get("connections tree");this.height+=na;oa.height-=na;Qa.height-=na;wb.top=this.bottom;wb.left=0;fc.top=wb.bottom;Qa.top=oa.top=fc.bottom+5}},{key:"reset",value:function(){var na=this;this.treeData=new V.InteractiveTreeData({children:[],container:V.morph()});this.get("inspector").targetObject={};this.selectedNode=null;this.anchors.filter(function(oa){return null==oa.id}).forEach(function(oa){return na.removeAnchor(oa)})}},{key:"setTarget",value:function(na){this.target=na;this.treeData=this.getTreeFromSubmorphHierarchy(na);
this.uncollapse(this.treeData.root)}},{key:"isNodeOutOfSync",value:function(na){var oa=this;if(na===this._previewNode)return!1;if(na.container.nameNeedsUpdate)return!0;var wb=na.container.target.submorphs.filter(function(fc){return!oa.ignoreMorph(fc)});return wb.length!=na.children.length||wb.map(function(fc){return fc.name}).join("")!=na.children.map(function(fc){return fc.target?fc.target.name:""}).join("")?!0:!1}},{key:"getNewChildren",value:function(na){var oa=this,wb=na.container.target.submorphs.map(function(od){return od.__scene_graph_target__?
od.__scene_graph_target__():od}).filter(function(od){return!oa.ignoreMorph(od)}),fc=[],Qa={},Lc;for(Lc in wb){Qa.$jscomp$loop$prop$m$2695=wb[Lc];var ld=V.arr.without(na.children,this._previewNode).find(function(od){return function(Be){return Be.container.target.id==od.$jscomp$loop$prop$m$2695.id}}(Qa));fc[Lc]=ld?ld:this.readMorphHierarchy(Qa.$jscomp$loop$prop$m$2695);Qa={$jscomp$loop$prop$m$2695:Qa.$jscomp$loop$prop$m$2695}}return fc}},{key:"refresh",value:function(){var na=this;if(!this._updating&&
!this._dropInProgress){var oa=!1;V.tree.prewalk(this.treeData.root,function(wb){na.isNodeOutOfSync(wb)&&(oa=!0,wb.name=wb.container.target.name,wb.container.refresh(),wb.children=na.getNewChildren(wb))},function(wb){return wb.children});this.update(oa)}}},{key:"ignoreMorph",value:function(na){return na.isMorph?na.isContainer||na.isWindow||na.getWindow()||na.isEpiMorph||na.isHand||["lively.halos"].includes(na.constructor[Symbol.for("lively-module-meta")].package.name)||["MorphicSideBar","SideBarToggler",
"UserFlap","Menu","CommentIndicator"].includes(na.constructor.name):!1}},{key:"onDropHoverOut",value:function(na){var oa=na.hand.grabbedMorphs[0];na=na.hand.findDropTarget();if(!(na===this||na&&na.ownerChain().includes(this))&&oa&&oa.isContainer)oa.onDragOutside()}},{key:"onDropHoverIn",value:function(na){var oa=na.hand.grabbedMorphs[0];oa&&!oa.isContainer&&($world.halos().forEach(function(wb){return wb.remove()}),oa.remove(),Object.assign(oa,na.hand._grabbedMorphProperties.get(oa).pointerAndShadow),
oa=this.renderContainerFor(oa,!1),na.hand.grab(oa),oa.leftCenter=V.pt(-20,0))}},{key:"getTreeFromSubmorphHierarchy",value:function(na){return new V.InteractiveTreeData(this.readMorphHierarchy(na))}},{key:"readMorphHierarchy",value:function(na){var oa=this;return V.tree.mapTree(na,function(wb,fc){return{name:wb.name,isCollapsed:!0,container:oa.renderContainerFor(wb),visible:!0,children:fc}},function(wb){return wb.submorphs.filter(function(fc){return wb.isWorld?!oa.ignoreMorph(fc):!0})})}},{key:"renderContainerFor",
value:function(na,oa){na=void 0===na?V.morph({name:"root"}):na;oa=new V.MorphContainer({tree:this,fill:void 0===oa||oa?V.Color.transparent:V.Color.gray.withA(.5),fontColor:this.nonSelectionFontColor,fontFamily:this.fontFamily,target:na,opacity:na.visible?1:.5});na._data?(oa._data=na._data,na._data.container=oa):oa._data={name:na.name,isCollapsed:!0,container:oa,children:[]};return oa}},{key:"collapseAll",value:function(){var na=this;this.treeData.asList().forEach(function(oa){return oa!=na.treeData.root?
oa.isCollapsed=!0:oa.isCollapsed=!1})}},{key:"filterMorphs",value:function(na){var oa=this,wb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fc){if(1==fc.nextAddress)return wb=na.tokens[0],oa.treeData.filterActive||(oa._collapseState=new WeakMap(oa.treeData.asList().map(function(Qa){return[Qa,Qa.isCollapsed]}))),oa.treeData.filterActive=!!wb,fc.yield(oa.treeData.filter(function(Qa){var Lc=!wb||Qa.container.target.name.includes(wb);Qa.container.highlightTerm(wb);return Lc},3),2);oa.treeData.filterActive||
oa.treeData.asList().forEach(function(Qa){return Qa.isCollapsed=oa._collapseState.has(Qa)?oa._collapseState.get(Qa):!0});oa.refresh();fc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SceneGraphTree"}},{key:"properties",get:function(){return{target:{serialize:!1}}}}],hb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",
version:"0.1.1-1104"}}},{start:10839,end:17467})}(V.InteractiveTree);V.SceneGraphTree=Ua;V.SceneGraphTree=Ua;V.SceneGraphTree=Ua;Ua=function(Ja){var hb=lively.FreezerRuntime.recorderFor("InteractiveTree/index.js"),dc=hb.hasOwnProperty("MorphContainer")&&"function"===typeof hb.MorphContainer?hb.MorphContainer:hb.MorphContainer=function(na){na&&na[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wa(dc,Ja,[{key:"refresh",value:function(){var na=
this,oa,wb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fc){oa=na.target;if(!oa)return fc.return();na.reactsToPointer=!0;na.dropShadow=!1;na.submorphs=[na.getLabel(),0<oa.comments.length&&na.getCommentControls(),oa.layout&&na.getLayoutControls(),na.getConnectionControls()].filter(Boolean).map(function(Qa,Lc){Qa.fitIfNeeded();Qa.left=wb?wb.right+5:0;Qa.top=2;return wb=Qa});na.height=20;na.opacity=oa.visible?1:.5;fc.jumpToEnd()})}},{key:"getLabel",value:function(){var na=this.getSubmorphNamed("name label")||
V.morph({type:"label",name:"name label",reactsToPointer:!1,padding:V.rect(0,0,0,0),acceptsDrops:!1,fontSize:this.tree.fontSize}),oa=na.textString.slice(2,-1);oa&&oa==this.target.name||(na.value=[].concat($jscomp.arrayFromIterable(this.getIcon(this.target)),[" "+this.target.name+" "]));return na}},{key:"getIcon",value:function(na){return V.Icon.textAttribute({Morph:"square",Ellipse:"circle",Text:"font",Label:"tag",Polygon:"draw-polygon",Path:"bezier-curve",Image:"image",Canvas:"chess-board",HTMLMorph:"code"}[V.getClassName(na)]||
"codepen",{paddingTop:"4px",fontSize:this.tree.fontSize-2,opacity:.6})}},{key:"getLayoutControls",value:function(){var na=this.getSubmorphNamed("layout label")||V.morph({type:"label",name:"layout label",borderRadius:3,acceptsDrops:!1,padding:V.Rectangle.inset(4,2,4,2),fill:V.Color.orange,fontColor:V.Color.white});na._isControlElement=!0;na.textString!=this.target.layout.name()&&(na.value=this.target.layout.name());return na}},{key:"getCommentControls",value:function(){var na=this.getSubmorphNamed("comment label")||
V.morph({type:"label",name:"comment label",tooltip:"Open comment browser to browse all comments",borderRadius:3,acceptsDrops:!1,padding:V.Rectangle.inset(4,2,4,2),fill:V.Color.rgb(241,196,15),fontColor:V.Color.black});na._isControlElement=!0;var oa=this.target.comments.length+" comment"+(1==this.target.comments.length?"":"s");na.textString!=oa&&(na.value=oa);return na}},{key:"getConnectionControls",value:function(){this.connectionCount=this.target.attributeConnections?this.target.attributeConnections.filter(function(wb){return!wb.targetObj.isHalo}).length:
0;var na=this.getSubmorphNamed("connections label")||V.morph({acceptsDrops:!1,borderRadius:3,type:"label",name:"connections label",padding:V.Rectangle.inset(4,2,4,2),nativeCursor:"pointer",fill:V.Color.red,fontColor:V.Color.white});na._isControlElement=!0;na.visible=!this.connectionHalo&&!!this.connectionCount;var oa=this.connectionCount?this.connectionCount+" connection"+(1<this.connectionCount?"s":""):"Manage Connections";na.textString!=oa&&(na.value=oa);return na}},{key:"highlightTerm",value:function(na){var oa=
this.submorphs[0],wb=oa.textAndAttributes.slice(0,2),fc=oa.textString.slice(1).split(na);oa.textAndAttributes=1===fc.length?[].concat($jscomp.arrayFromIterable(wb),[fc[0]]):[].concat($jscomp.arrayFromIterable(wb),$jscomp.arrayFromIterable(V.arr.flatten(V.arr.interpose(fc.map(function(Qa){return[Qa,{}]}),[na,{fontWeight:"900"}]))))}},{key:"getClassControls",value:function(){}},{key:"wantsToBeDroppedOn",value:function(na){var oa=wa._get(Object.getPrototypeOf(dc.prototype),"wantsToBeDroppedOn",this).call(this,
na);if(![na].concat($jscomp.arrayFromIterable(na.ownerChain())).includes(this.tree))this.onDragOutside();return oa}},{key:"onGrab",value:function(na){var oa=this,wb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(fc){if(1==fc.nextAddress)return oa.tree._dropInProgress=!0,wb=oa.target.globalPosition,wa._get(Object.getPrototypeOf(dc.prototype),"onGrab",oa).call(oa,na),oa._data.globalTargetPosition=wb,fc.yield(oa.whenRendered(),2);if(oa.tree.fullContainsWorldPoint(oa.globalPosition))oa.leftCenter=
V.pt(-20,0);else oa.onDragOutside();oa.tree._dropInProgress=!1;fc.jumpToEnd()})}},{key:"onDragOutside",value:function(){this._draggedOutside||(this._draggedOutside=!0,this.queue||(this.queue=V.fun.createQueue("container-hover-queue",function(na,oa){var wb,fc,Qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lc){if(1==Lc.nextAddress)return wb=na.target,fc=wb.opacity,Qa=wb.scale,na.target.opacity=0,na.target.scale=.5,$world.halos().forEach(function(ld){return ld.remove()}),$world.firstHand.grab(na.target),
na.target._data=na._data,na.remove(),na.target.position=V.pt(0,0),Lc.yield(na.target.animate({opacity:fc,scale:Qa,duration:200}),2);oa();Lc.jumpToEnd()})})),this.queue.push(this))}},{key:"onChildAdded",value:function(na){var oa=this.node.children.indexOf(na.node||na._data)+1;oa=this.node.children[oa];na.target.remove();oa?(oa=this.target.submorphs.indexOf(oa.container.target),this.target.addMorphAt(na.target,oa)):this.target.addMorph(na.target);na._data.globalTargetPosition&&(na.target.position=this.target.localize(na._data.globalTargetPosition))}},
{key:"onChildRemoved",value:function(na){}},{key:"toggleConnectionControl",value:function(na){this.getSubmorphNamed("connections label").visible=na}},{key:"toggleSelected",value:function(na){var oa=this,wb,fc,Qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lc){if(1==Lc.nextAddress)return wa._get(Object.getPrototypeOf(dc.prototype),"toggleSelected",oa).call(oa,na),oa._active===na?Lc.return():(oa._active=na)&&oa.target&&oa.target.isMorph&&oa.world()?Lc.yield(oa.target.whenRendered(),
3):Lc.jumpTo(0);oa.get("inspector").targetObject=oa.target;oa.get("connections tree").inspectConnectionsOf(oa.target);if(oa.connectionHalo)return Lc.return();wb=$jscomp.makeIterator(oa.world().halos());for(fc=wb.next();!fc.done;fc=wb.next()){Qa=fc.value;if(Qa.target===oa.target)return Lc.return();Qa.remove()}V.noUpdate({sourceObj:oa.world(),targetObj:oa.sideBar,sourceAttribute:"showHaloFor",targetAttribute:"selectNode"},function(){return oa.world().showHaloFor(oa.target)});Lc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"MorphContainer"}},{key:"properties",get:function(){return{fontFamily:{after:["submorphs"],derived:!0,set:function(na){this.submorphs[0].fontFamily=na}},fontColor:{after:["submorphs"],derived:!0,set:function(na){this.submorphs[0].fontColor=na}},fontSize:{derived:!0,set:function(na){this.submorphs[0].fontSize=na}},target:{serialize:!1},dragTriggerDistance:{defaultValue:15},borderRadius:{defaultValue:4},nameNeedsUpdate:{derived:!0,get:function(){return!this.target||this.submorphs[0].textString.slice(2,
-1)==this.target.name&&this.connectionCount==(this.target.attributeConnections||[]).length?!1:!0}},grabbable:{defaultValue:!0},draggable:{defaultValue:!0},submorphs:{after:["target","tree"],initialize:function(){this.refresh()}},sideBar:{derived:!0,get:function(){return this.owner.owner}}}}}],hb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"InteractiveTree",
version:"0.1.1-1104"}}},{start:17476,end:25894})}(V.InteractiveTreeContainer);V.MorphContainer=Ua;V.MorphContainer=Ua;V.MorphContainer=Ua;var ra=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js");ra.visualizeConnection=function(Ja,hb,dc,na,oa){na=void 0===na?{}:na;oa=ra.rect(0).sides.concat(ra.rect(0).corners);dc=dc||new ra.Leash(Object.assign({isSmooth:!0,styleClasses:["Halo"],borderColor:ra.Color.orange,epiMorph:!0,endpointStyle:{start:{fill:ra.Color.transparent,nativeCursor:"auto"},
end:{fill:ra.Color.orange}}},na,{hasFixedPosition:!0}));dc.startPoint.attachTo(Ja,"rightCenter");hb.isMorph?(na=hb.globalBounds().partNameNearest(oa,Ja.globalPosition),Ja.globalPosition.equals(hb.globalBounds().partNamed(na))&&hb.globalBounds().partNameNearest(ra.arr.without(oa,na),Ja.globalPosition),dc.endPoint.attachTo(hb,"leftCenter")):(oa=Ja.globalBounds().topRight().addPt(ra.pt(100,0)),hb=ra.morph({type:"label",value:hb.toString(),styleClasses:["Tooltip"],padding:ra.rect(8,4)}).openInWorld(oa),
hb.position=Ja.world().bounds().translateForInclusion(hb.bounds()).topLeft(),ra.once(dc,"remove",hb,"remove"),dc.endPoint.attachTo(hb,"leftCenter"));return dc};ra.startConnecting=function(Ja,hb){Ja.animate({opacity:.8,duration:300});Ja.startPoint.attachTo(hb,"center");Ja.vertices[0].position=ra.pt(2,2)};ra.stopConnecting=function(Ja,hb,dc,na){function oa(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lc){if(1==Lc.nextAddress)return Lc.yield(Ja.animate({opacity:0,duration:300}),2);Ja.startPoint.clearConnection();
Ja.endPoint.clearConnection();Ja.remove();Lc.jumpToEnd()})}na=void 0===na?!1:na;var wb,fc,Qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Lc){return 1==Lc.nextAddress?(wb=Ja,fc=wb.endPoint,(Qa=fc.connectedMorph)&&"MorphContainer"==ra.getClassName(Qa)&&(Qa=Qa.target),Qa?Lc.yield(ra.interactiveConnectGivenSourceAndTarget(dc,na,Qa),2):Lc.jumpTo(2)):Lc.yield(oa(),0)})};ra.editConnection=function(Ja){var hb=Ja.connection,dc=Ja.connectionPoint,na;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oa){if(1==
oa.nextAddress)return na=ra.visualizeConnection(dc,hb.targetObj,!1,{borderColor:ra.Color.gray.darker(),endpointStyle:{start:{fill:ra.Color.transparent,nativeCursor:"auto"},end:{fill:ra.Color.gray.darker()}}}),oa.yield(ra.interactivelyReEvaluateConnection(hb,"Edit Connection",!1),2);na.remove();oa.jumpToEnd()})};ra.Tree=ae;ra.TreeData=lc;ra.Icon=Wc;ra.morph=Ad;ra.pt=Ib;ra.Rectangle=Tb;ra.rect=Ac;ra.Color=uc;ra.arr=dd;ra.connect=qc;ra.signal=gd;ra.Leash=le;ra.once=Zc;ra.interactivelyReEvaluateConnection=
Ub;ra.interactiveConnectGivenSource=Ca;ra.interactiveConnectGivenSourceAndTarget=mb;ra.getClassName=vc;(function(Ja){var hb=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js"),dc=hb.hasOwnProperty("ConnectionsTreeData")&&"function"===typeof hb.ConnectionsTreeData?hb.ConnectionsTreeData:hb.ConnectionsTreeData=function(na){na&&na[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wa(dc,Ja,[{key:"parseMorphConnections",value:function(na){for(var oa=
{},wb=$jscomp.makeIterator(void 0===na.attributeConnections?[]:na.attributeConnections),fc=wb.next();!fc.done;fc=wb.next())fc=fc.value,fc.targetObj.isHalo||(oa[fc.sourceAttrName]=oa[fc.sourceAttrName]||[{name:["      New Connection  ",{fontColor:ra.Color.white.withA(.5),fontStyle:"italic"},this.renderPin(na,fc.sourceAttrName),{}]}],ra.arr.pushAt(oa[fc.sourceAttrName],{name:[].concat($jscomp.arrayFromIterable(this.renderExistingConnection(fc)))},0));return{children:Object.entries(oa).map(function(Qa){var Lc=
$jscomp.makeIterator(Qa);Qa=Lc.next().value;Lc=Lc.next().value;return{name:[Qa,{fontWeight:"bold"}," ",{},ra.morph({fill:ra.Color.white,opacity:.7,value:""+(Lc.length-1),borderRadius:15,fontWeight:"bold",padding:ra.Rectangle.inset(5,0,5,0),type:"label"}),{paddingTop:"4px"}],children:Lc}}).concat([{name:["New Connection  ",{fontColor:ra.Color.white.withA(.5),fontStyle:"italic"},this.renderPin(na),{}]}])}}},{key:"renderExistingConnection",value:function(na){var oa=this,wb=ra.morph({type:"label",fontColor:ra.Color.gray,
fontSize:16,nativeCursor:"pointer",value:[].concat($jscomp.arrayFromIterable(ra.Icon.textAttribute("long-arrow-alt-right",{paddingTop:"4px"})),["  ",{},na.targetMethodName,{}])}),fc=this.renderDeadPin(),Qa=fc.submorphs[0];ra.connect(wb,"onHoverIn",function(){wb.fontColor=ra.Color.orange;wb._leash=ra.visualizeConnection(Qa,na.targetObj,wb._leash);Qa.fill=ra.Color.orange;Qa.border={color:ra.Color.orange,width:3}});ra.connect(wb,"onMouseDown",function(Lc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ld){if(1==
ld.nextAddress)return Lc.stop(),ld.yield(ra.interactivelyReEvaluateConnection(na),2);ra.signal(oa,"refresh");ld.jumpToEnd()})});ra.connect(wb,"onHoverOut",function(){wb.fontColor=ra.Color.gray;Qa.fill=ra.Color.gray;Qa.border={color:ra.Color.white,width:1};wb._leash.remove();wb._leash=void 0});return[wb,{},"  ",{}].concat($jscomp.arrayFromIterable(ra.Icon.textAttribute("times",{nativeCursor:"pointer ",onMouseDown:function(){na.disconnect();ra.signal(oa,"refresh")}})),["  ",{},fc,{}])}},{key:"renderDeadPin",
value:function(){var na=ra.morph({type:"ellipse",fill:ra.Color.gray,extent:ra.pt(10,10),center:ra.pt(8,12),borderWidth:1});return ra.morph({extent:ra.pt(20,20),fill:ra.Color.transparent,reactsToPointer:!1,submorphs:[na]})}},{key:"renderPin",value:function(na,oa){var wb=this,fc=ra.morph({type:"ellipse",fill:ra.Color.gray.withA(.5),extent:ra.pt(10,10),center:ra.pt(8,12),draggable:!1,borderWidth:1}),Qa=new ra.Leash({opacity:0,styleClasses:["Halo"],isSmooth:!0,epiMorph:!0,hasFixedPosition:!0,borderColor:ra.Color.gray.darker(),
endpointStyle:{fill:ra.Color.gray.darker()},position:ra.pt(1,1),vertices:[ra.pt(0,0),ra.pt(0,0)],getLabelFor:function(Lc){return"MorphContainer"==ra.getClassName(Lc)?Lc.target.name:Lc.name},canConnectTo:function(Lc){return"MorphContainer"==ra.getClassName(Lc)||2>ra.arr.intersect([Lc].concat($jscomp.arrayFromIterable(Lc.ownerChain())),[fc].concat($jscomp.arrayFromIterable(fc.ownerChain()))).length}});fc.addMorph(Qa);ra.connect(Qa.endPoint,"onDragStart",function(){ra.startConnecting(Qa,fc)});ra.connect(Qa.endPoint,
"onDragEnd",function(Lc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ld){if(1==ld.nextAddress)return fc.center=ra.pt(8,12),ld.yield(ra.stopConnecting(Qa,fc,na,oa),2);ra.signal(wb,"refresh");ld.jumpToEnd()})});return ra.morph({extent:ra.pt(20,20),fill:ra.Color.transparent,reactsToPointer:!1,submorphs:[fc]})}},{key:"display",value:function(na){return na.name}},{key:"collapse",value:function(na,oa){na.isCollapsed=oa}},{key:"isCollapsed",value:function(na){return na.isCollapsed}},{key:"isLeaf",
value:function(na){return!na.children}},{key:"getChildren",value:function(na){return na.children}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ConnectionsTreeData"}},{key:"for",value:function(na){var oa=new this;oa.root=oa.parseMorphConnections(na);return oa}}],hb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ConnectionsTree",
version:"0.1.1-16"}}},{start:3542,end:8259})})(ra.TreeData);Ua=function(Ja){var hb=lively.FreezerRuntime.recorderFor("ConnectionsTree/index.js"),dc=hb.hasOwnProperty("ConnectionsTree")&&"function"===typeof hb.ConnectionsTree?hb.ConnectionsTree:hb.ConnectionsTree=function(na){na&&na[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wa(dc,Ja,[{key:"inspectConnectionsOf",value:function(na){if(this.targetMorph=na)this.treeData=ra.ConnectionsTreeData.for(na),
ra.connect(this.treeData,"refresh",this,"refresh")}},{key:"refresh",value:function(){this.targetMorph&&(this.treeData=ra.ConnectionsTreeData.for(this.targetMorph),ra.connect(this.treeData,"refresh",this,"refresh"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ConnectionsTree"}},{key:"properties",get:function(){return{}}}],hb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"ConnectionsTree",version:"0.1.1-16"}}},{start:8276,end:8829})}(ra.Tree);Ua=ra.ConnectionsTree;ra.default=Ua}}});
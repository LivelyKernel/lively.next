System.register(["./__rootModule___commonjs-entry-71573ff5.js","./index-ca98f65e.js","@babel/plugin-syntax-import-meta"],function(Lc){var pd,Nd,Tc,Jc,$d,Bb,rd,Id,Ac,Pc,gd,nd,Fd,ic,vd,sb,Xb;return{setters:[function(Nb){pd=Nb._;Nd=Nb.k;Tc=Nb.l;Jc=Nb.B;$d=Nb.a6;Bb=Nb.a7;rd=Nb.g;Id=Nb.a8;Ac=Nb.a9;Pc=Nb.aa;gd=Nb.ab;nd=Nb.ac;Fd=Nb.ad;ic=Nb.z},function(Nb){vd=Nb.s;sb=Nb.E;Xb=Nb.c},function(){}],execute:function(){function Nb(yb,ba,wb){var Xa=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};Xa=Xa["package"]||
Hb.ObjectPackage.lookupModuleForClass(yb.constructor,Xa);if(!Xa)throw Error("Object is not part of an object package: ".concat(yb));return Xa.addScript(yb,ba,wb)}function bc(yb,ba){ba=Hb.normalizeOptions(ba).System;yb=(yb=yb[Symbol["for"]("lively-module-meta")])?yb["package"].name:null;return(ba=(yb?Hb.lookupPackage(ba,yb):{}).pkg)?!!Hb.ObjectPackage.forSystemPackage(ba):!1}function hb(yb,ba){return cb.apply(this,arguments)}function cb(){cb=pd(regeneratorRuntime.mark(function Xa(ba,wb){var Za,Sb,
Cb,Da,zb;return regeneratorRuntime.wrap(function(db){for(;;)switch(db.prev=db.next){case 0:return Za=ba.constructor,Hb.withSuperclasses(Za)[1],Za[Symbol["for"]("lively-module-meta")]["package"].name,Sb=Hb.ObjectPackage.lookupPackageForObject(ba),Cb=Sb.baseURL,Da=Sb.System,db.next=7,Sb.fork(wb,{baseURL:Cb,System:Da});case 7:return zb=db.sent,db.next=10,Hb.obj.adoptObject(ba,zb.objectClass);case 10:return db.abrupt("return",zb.objectClass[Symbol["for"]("__LivelyClassName__")]);case 11:case "end":return db.stop()}},
Xa)}));return cb.apply(this,arguments)}Lc({addScript:Nb,interactivelyForkPackage:hb,isObjectClass:bc});var Hb=window.lively.FreezerRuntime.recorderFor("lively.classes/object-classes.js");Hb.globalClasses=function(){return Object.keys(System.global).map(function(yb){yb=System.global[yb];return"function"===typeof yb&&yb.name&&yb}).filter(Boolean)};Hb.normalizeOptions=function(yb){yb=Object.assign({baseURL:Hb.defaultBaseURL,System},yb);yb.baseURL=yb.baseURL.replace(/\/$/,"");return yb};Hb.addScript=
Nb;Hb.isObjectClass=bc;Hb.interactivelyForkPackage=hb;Hb.string=Nd;Hb.Path=Tc;Hb.obj=Jc;Hb.isValidIdentifier=$d;Hb.parseFunction=Bb;Hb.resource=rd;Hb.runEval=Id;Hb.scripting=vd;Hb.ExportLookup=sb;var ec=Hb.scripting;Hb.ensurePackage=ec.ensurePackage;Hb.registerPackage=ec.registerPackage;Hb.importPackage=ec.importPackage;Hb.lookupPackage=ec.lookupPackage;Hb.module=ec.module;Hb.ImportInjector=ec.ImportInjector;Hb.RuntimeSourceDescriptor=Ac;Hb.toJsIdentifier=Pc;Hb.withSuperclasses=gd;Hb.classToFunctionTransform=
Xb;Hb.objectPackageSym=Symbol["for"]("lively-object-package-data");Hb.defaultBaseURL="local://lively-object-modules";Hb.addScript=Nb;Hb.isObjectClass=bc;Hb._packageStore=Hb._packageStore||{};Hb.interactivelyForkPackage=hb;ec=Lc("default",function(){function yb(ba,wb){Fd(this,yb);this._id=ba;this.options=Hb.normalizeOptions(wb)}nd(yb,null,[{key:"lookupPackageForObject",value:function(ba,wb){return this.lookupPackageForClass(ba.constructor,wb)}},{key:"lookupPackageForClass",value:function(ba,wb){wb=
Hb.normalizeOptions(wb).System;ba=(ba=ba[Symbol["for"]("lively-module-meta")])?ba["package"].name:null;return(wb=(ba?Hb.lookupPackage(wb,ba):{}).pkg)?Hb.ObjectPackage.forSystemPackage(wb):null}},{key:"lookupModuleForClass",value:function(ba,wb){var Xa=Hb.normalizeOptions(wb);Xa.System;wb=this.lookupPackageForClass(ba,wb);ba=ba[Symbol["for"]("lively-module-meta")];return new Hb.ObjectModule(ba.pathInPackage,wb)}},{key:"forSystemPackage",value:function(ba){return this.packageStore[ba.name]}},{key:"withId",
value:function(ba,wb){return this.packageStore[ba]||(this.packageStore[ba]=new this(ba,wb))}},{key:"packageStore",get:function(){return this._packageStore||(this._packageStore=Hb._packageStore)}}]);nd(yb,[{key:"ensureSubModule",value:function(){var ba=pd(regeneratorRuntime.mark(function Xa(){var Za,Sb,Cb=arguments;return regeneratorRuntime.wrap(function(Da){for(;;)switch(Da.prev=Da.next){case 0:return Za=0<Cb.length&&void 0!==Cb[0]?Cb[0]:"index",Sb=new Hb.ObjectModule(Za,this),Da.next=4,Sb.ensureExistance();
case 4:return Da.abrupt("return",Sb);case 5:case "end":return Da.stop()}},Xa,this)}));return function(){return ba.apply(this,arguments)}}()},{key:"resource",value:function(){var ba=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return Hb.resource(this.packageURL).join(ba)}},{key:"load",value:function(){return Hb.importPackage(this.System,this.packageURL)}},{key:"ensureExistance",value:function(){var ba=pd(regeneratorRuntime.mark(function Xa(){var Za,Sb,Cb,Da,zb,db,ib;return regeneratorRuntime.wrap(function(Ea){for(;;)switch(Ea.prev=
Ea.next){case 0:return Za=this.resource("/"),Ea.next=3,Za.exists();case 3:if(!Ea.sent){Ea.next=5;break}return Ea.abrupt("return");case 5:return Sb=[{resource:Za}],Cb=[{resource:this.resource("package.json"),content:JSON.stringify(this.config,null,2)}],Ea.next=9,Promise.all(Sb.map(function(W){return W.resource.mkdir()}));case 9:return Ea.next=11,Promise.all(Cb.map(function(){var W=pd(regeneratorRuntime.mark(function ka(ia){return regeneratorRuntime.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=
2,ia.resource.exists();case 2:K.t0=!K.sent;if(!K.t0){K.next=7;break}K.next=6;return ia.resource.write(ia.content);case 6:K.t0=K.sent;case 7:return K.abrupt("return",K.t0);case 8:case "end":return K.stop()}},ka)}));return function(ia){return W.apply(this,arguments)}}()));case 11:return Ea.next=13,this.objectModule.ensureExistance();case 13:return Da=this.System,zb=this.packageURL,db=this.config,Ea.next=16,Hb.ensurePackage(Da,zb);case 16:return ib=Ea.sent,ib.registerWithConfig(db),console.log("".concat(this.packageURL,
" REGISTERED")),Ea.abrupt("return",this);case 20:case "end":return Ea.stop()}},Xa,this)}));return function(){return ba.apply(this,arguments)}}()},{key:"ensureObjectClass",value:function(){var ba=pd(regeneratorRuntime.mark(function Za(Xa){return regeneratorRuntime.wrap(function(Sb){for(;;)switch(Sb.prev=Sb.next){case 0:return Sb.next=2,this.ensureExistance();case 2:return Sb.abrupt("return",this.objectModule.ensureObjectClass(Xa));case 3:case "end":return Sb.stop()}},Za,this)}));return function(Xa){return ba.apply(this,
arguments)}}()},{key:"adoptObject",value:function(){var ba=pd(regeneratorRuntime.mark(function Za(Xa){var Sb;return regeneratorRuntime.wrap(function(Cb){for(;;)switch(Cb.prev=Cb.next){case 0:if(this.objectClass!==Xa.constructor){Cb.next=2;break}return Cb.abrupt("return");case 2:return Cb.next=4,this.ensureObjectClass(Xa.constructor);case 4:Sb=Cb.sent,Hb.obj.adoptObject(Xa,Sb);case 6:case "end":return Cb.stop()}},Za,this)}));return function(Xa){return ba.apply(this,arguments)}}()},{key:"addScript",
value:function(ba,wb,Xa){return this.objectModule.addScript(ba,wb,Xa)}},{key:"remove",value:function(){this.systemPackage.remove();delete Hb.ObjectPackage.packageStore[this.id];return this.resource().remove()}},{key:"renameObjectClass",value:function(){var ba=pd(regeneratorRuntime.mark(function Za(Xa){var Sb,Cb,Da,zb,db,ib,Ea,W,T,ia=arguments;return regeneratorRuntime.wrap(function(ka){for(;;)switch(ka.prev=ka.next){case 0:Sb=1<ia.length&&void 0!==ia[1]?ia[1]:[];Cb=this.objectClass;Da=this.System;
if(Cb&&Cb[Symbol["for"]("__LivelyClassName__")]!==Xa){ka.next=4;break}return ka.abrupt("return",Cb);case 4:if(Hb.isValidIdentifier(Xa)){ka.next=6;break}throw Error("".concat(Xa," is not a valid name for a class"));case 6:return zb=Hb.RuntimeSourceDescriptor["for"](Cb,Da),db=zb.source,ib=zb.ast.id,Ea=ib.start,W=ib.end,ka.next=10,zb.changeSource(db.slice(0,Ea)+Xa+db.slice(W));case 10:return T=this.objectClass,Sb.forEach(function(K){K.constructor=T;K.__proto__=T.prototype}),ka.abrupt("return",T);case 13:case "end":return ka.stop()}},
Za,this)}));return function(Xa){return ba.apply(this,arguments)}}()},{key:"fork",value:function(){var ba=pd(regeneratorRuntime.mark(function Sb(Xa,Za){var Cb,Da,zb,db,ib,Ea,W,T;return regeneratorRuntime.wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return Cb=this.System,Da=this.baseURL,zb=this.objectClass,Za=Object.assign({System:Cb,baseURL:Da},Za),db=Hb.RuntimeSourceDescriptor["for"](zb),ib=db._renamedSource(Xa),Ea=ib.moduleSource,W=Hb.ObjectPackage.withId(Xa,Za),ia.next=7,W.ensureExistance();
case 7:return T=W.objectModule.systemModule,ia.next=10,T.load({format:"esm"});case 10:return ia.next=12,T.changeSource(Ea);case 12:return ia.abrupt("return",W);case 13:case "end":return ia.stop()}},Sb,this)}));return function(Xa,Za){return ba.apply(this,arguments)}}()},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this.id}},{key:"System",get:function(){return this.options.System}},{key:"baseURL",get:function(){return this.options.baseURL}},{key:"packageURL",get:function(){return this.baseURL+
"/".concat(this.id)}},{key:"config",get:function(){return{name:this.name,version:"0.1.0",lively:{isObjectPackage:!0}}}},{key:"systemPackage",get:function(){return Hb.lookupPackage(this.System,this.packageURL,!0).pkg}},{key:"objectModule",get:function(){return this._objectModule||(this._objectModule=new Hb.ObjectModule("index.js",this))}},{key:"objectClass",get:function(){return this.objectModule.objectClass}}]);return yb}());Hb.ObjectPackage=ec;var ub=function(){function yb(ba,wb){Fd(this,yb);if(!ba)throw Error("ObjectModule needs package!");
if(!wb)throw Error("ObjectModule needs package!");this._moduleName=ba;this._objectPackage=wb}nd(yb,[{key:"read",value:function(){return this.resource.read()}},{key:"write",value:function(ba){return this.resource.write(ba)}},{key:"ensureExistance",value:function(){var ba=pd(regeneratorRuntime.mark(function Xa(){var Za;return regeneratorRuntime.wrap(function(Sb){for(;;)switch(Sb.prev=Sb.next){case 0:return Za=this.resource,Sb.next=3,Za.exists();case 3:if(Sb.sent){Sb.next=7;break}Sb.next=6;return Za.write("'format esm';\n");
case 6:this.System.config({meta:ic({},this.url,{format:"esm"})});case 7:return Sb.abrupt("return",this);case 8:case "end":return Sb.stop()}},Xa,this)}));return function(){return ba.apply(this,arguments)}}()},{key:"adoptObject",value:function(){var ba=pd(regeneratorRuntime.mark(function Sb(Xa,Za){var Cb;return regeneratorRuntime.wrap(function(Da){for(;;)switch(Da.prev=Da.next){case 0:if(this.objectClass!==Xa.constructor){Da.next=2;break}return Da.abrupt("return");case 2:return Da.next=4,this.ensureObjectClass(Xa.constructor,
Za);case 4:Cb=Da.sent,Hb.obj.adoptObject(Xa,Cb);case 6:case "end":return Da.stop()}},Sb,this)}));return function(Xa,Za){return ba.apply(this,arguments)}}()},{key:"ensureObjectClass",value:function(ba,wb){var Xa=this,Za=this.objectClass;return Za&&Za.prototype.__proto__===ba.prototype?Za:Promise.resolve(this.ensureObjectClassSource(ba,wb)).then(function(Sb){var Cb=Sb.source,Da=Sb.moduleId,zb=Sb.className,db=Sb.bindings,ib=Xa.System;Sb=Hb.module(ib,Da);if(db)for(var Ea in db)Sb.define(Ea,db[Ea]);Cb=
Hb.runEval(Cb,{classTransform:Hb.classToFunctionTransform,sync:!0,targetModule:Da,System:ib});if(Cb.isError)throw Cb.value;Cb=Sb.recorder[zb];if(!Cb)throw Error("Failed to define class ".concat(zb," in ").concat(Da));return Cb})}},{key:"ensureObjectClassSource",value:function(ba,wb){return this.createDefaultClassDeclaration(ba,wb)}},{key:"createDefaultClassDeclaration",value:function(){var ba=pd(regeneratorRuntime.mark(function Xa(){var Za,Sb,Cb,Da,zb,db,ib,Ea,W,T,ia,ka,K,ya,pb=arguments;return regeneratorRuntime.wrap(function(La){for(;;)switch(La.prev=
La.next){case 0:Za=0<pb.length&&void 0!==pb[0]?pb[0]:Object;Sb=1<pb.length&&void 0!==pb[1]?pb[1]:!1;Cb=this.System;Da=this.systemModule;zb=this.objectPackage;Sb=Sb||Hb.string.capitalize(Hb.toJsIdentifier(zb.id));db=Za[Symbol["for"]("__LivelyClassName__")]||Za.name;ib=!db||"anonymous_class"==db;Ea=Hb.globalClasses().includes(Za);W="";T=null;if(!ib){La.next=15;break}db="__anonymous_superclass__";T=ic({},db,Za);W+="let __anonymous_superclass__ = __anonymous_superclass__;\n";La.next=20;break;case 15:if(Ea){La.next=
20;break}La.next=18;return Hb.ExportLookup.findExportOfValue(Za,Cb);case 18:(ia=La.sent)?(ka=Hb.ImportInjector.run(Cb,Da.id,Da["package"](),"",ia),K=ka.standaloneImport,W+=K+"\n\n"):T=ic({},db,Za);case 20:Sb===db&&(Sb="Object"+Sb);ya="Object"===db?"class ".concat(Sb," {}\n"):"class ".concat(Sb," extends ").concat(db," {}\n");W+="export default ".concat(ya,"\n");if(Da.isLoaded()){La.next=27;break}La.next=26;return Da.setSource('"format esm";');case 26:ib&&(Da.recorder[db]=Za);case 27:return La.next=
29,Da.changeSource(W);case 29:return La.next=31,Da.load();case 31:return La.abrupt("return",{source:W,className:Sb,moduleId:this.url,bindings:T});case 32:case "end":return La.stop()}},Xa,this)}));return function(){return ba.apply(this,arguments)}}()},{key:"addScript",value:function(){var ba=pd(regeneratorRuntime.mark(function Cb(Xa,Za,Sb){var Da,zb,db,ib,Ea,W,T,ia,ka,K,ya,pb,La,eb;return regeneratorRuntime.wrap(function(jb){for(;;)switch(jb.prev=jb.next){case 0:if(Xa.constructor!==this.objectClass){jb.next=
4;break}jb.t0=Xa.constructor;jb.next=7;break;case 4:return jb.next=6,this.ensureObjectClass(Xa.constructor);case 6:jb.t0=jb.sent;case 7:Da=jb.t0;zb="function"===typeof Za?String(Za):Za;db=Hb.parseFunction(zb);ib=Hb.RuntimeSourceDescriptor["for"](Da,this.System);Sb||(Sb=Hb.Path("id.name").get(db));if(Sb){jb.next=14;break}throw Error("No name, cannot add ".concat(Hb.string.truncate(zb,30).replace(/\n/g,""),"!"));case 14:Ea=Hb.toJsIdentifier(Sb);console.assert("FunctionExpression"===db.type||"ArrowFunctionExpression"===
db.type,"not a function expression but: "+db.type);W=db.params.map(function(E){return zb.slice(E.start,E.end)});T="BlockStatement"===db.body.type?zb.slice(db.body.start,db.body.end):"{ return ".concat(zb.slice(db.body.start,db.body.end)," }");ia="".concat(Ea,"(").concat(W.join(","),") ").concat(T);"ArrowFunctionExpression"===db.type&&(db.type="FunctionExpression");ka=ib.source;if(K=ib.ast){jb.next=24;break}throw Error("cannot find class decl of "+ib.module.id);case 24:return(ya=K.body.body.find(function(E){return E.key.name===
Ea&&!E["static"]}))?ka=ka.slice(0,ya.start)+ia+ka.slice(ya.end):(pb=ka.lastIndexOf("}"),La=ka.slice(0,pb),eb=ka.slice(pb),/\n\s*$/m.test(La)||(La+="\n"),ia=Hb.string.changeIndent(ia,"  ",1),/^[ ]*\n/m.test(eb)||(eb="\n"+eb),ka=La+ia+eb),jb.next=28,ib.changeSource(ka);case 28:return jb.abrupt("return",{script:Da.prototype[Ea],klass:Da,module:ib.module.id,methodName:Ea});case 29:case "end":return jb.stop()}},Cb,this)}));return function(Xa,Za,Sb){return ba.apply(this,arguments)}}()},{key:"objectPackage",
get:function(){return this._objectPackage}},{key:"objectClass",get:function(){var ba=this.systemModule;return ba.isLoaded()?ba.System.get(ba.id)["default"]:null}},{key:"moduleName",get:function(){return this._moduleName}},{key:"systemModule",get:function(){return Hb.module(this.System,this.url)}},{key:"System",get:function(){return this.objectPackage.System}},{key:"resource",get:function(){return this.objectPackage.resource(this.moduleName)}},{key:"url",get:function(){return this.resource.url}}]);
return yb}();Hb.ObjectModule=ub;Hb["default"]=ec}}});
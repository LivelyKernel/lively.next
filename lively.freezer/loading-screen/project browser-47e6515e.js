System.register(["./__root_module__-3c9a1ccb.js","kld-intersections","./user-ui-6ad469c6.js","./index-443b373b.js","./index-b3480c85.js"],function(sa,lb){var Eb,Wb,Qb,Bd,Fc,wd,Kc,Gc,Yc,jd,Dd,od,Zc,Ra,tb,dc,bc,Xc,Oc;return{setters:[function($b){Eb=$b.ag;Wb=$b.az;Qb=$b.ai;Bd=$b.al;Fc=$b.Y;wd=$b.a4;Kc=$b.ar;Gc=$b.s;Yc=$b.C;jd=$b.a1;Dd=$b.r;od=$b.aq;Zc=$b.ay;Ra=$b.aY;tb=$b.aZ;dc=$b.ao;bc=$b.aV;Xc=$b.aU},function(){},function($b){Oc=$b.UserUI},function(){},function(){}],execute:function(){var $b=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");$b.Morph=Eb;$b.HorizontalLayout=Wb;$b.VerticalLayout=Qb;$b.morph=Bd;$b.MorphicDB=Fc;$b.arr=wd;$b.fun=Kc;$b.string=Gc;$b.Color=Yc;$b.pt=jd;$b.UserUI=Oc;$b.resource=Dd;var zc=function(pc){var Pc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),wb=Pc.hasOwnProperty("WorldDashboard")&&"function"===typeof Pc.WorldDashboard?Pc.WorldDashboard:Pc.WorldDashboard=function(db){db&&db[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return od(wb,pc,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(db){db=void 0===db?$world:db;this.owner!=db&&db.addMorph(this);this.center=db.visibleBounds().center()}},{key:"sortAndFilterPreviews",
value:function(db){var Ta=$b.UserUI.getCurrentUser();db=this.ui.searchField.fuzzyFilter(db,function(cb){return cb._commit.name+cb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return $b.arr.sortBy(db,function(cb){return-cb._commit.timestamp});case "TEMPLATES":return db;case "MY PROJECTS":return $b.arr.filter(db,function(cb){return cb._commit.author.name===Ta.name});case "PUBLISHED":return db}}},{key:"updateList",value:function(){var db=this;this.previews&&$b.fun.debounceNamed("update world list",
150,function(){db.ui.worldList.items=db.sortAndFilterPreviews(db.previews)})()}},{key:"displayWorlds",value:function(){var db=this,Ta,cb,ma,La,fb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pb){switch(pb.nextAddress){case 1:return db.reset(),Ta=db.ui,cb=Ta.loadingLabel,cb.visible=!0,cb.animate({opacity:1,duration:300}),pb.yield(db.db.latestCommits("world"),2);case 2:return ma=pb.yieldResult,pb.yield(lb.import("./world preview-7bb0ad60.js"),4);case 4:if(!(La=pb.yieldResult)){pb.jumpTo(5);
break}return pb.yield($b.resource("part://partial freezing/world preview"),6);case 6:La=pb.yieldResult;case 5:return pb.yield(La.read(),3);case 3:return fb=pb.yieldResult,db.previews=ma.map(function(xb){var Wa=$b.morph({reactsToPointer:!1,fill:$b.Color.transparent,extent:fb.extent});Wa._commit=xb;Wa.displayPreview=function(){var Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ab){if(1==Ab.nextAddress)return Xa=fb.copy(),Xa._commit=xb,Xa.opacity=0,Wa.addMorph(Xa),Xa.displayPreview(),
Xa.position=$b.pt(0,0),Ab.yield(Wa.whenRendered(),2);Wa.layout=new $b.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});Ab.jumpToEnd()})};return Wa}),pb.yield(cb.animate({opacity:0,duration:300}),7);case 7:cb.visible=!1,db.updateList(),0==ma.length&&(db.ui.noWorldWarning.center=db.innerBounds().center(),db.ui.noWorldWarning.animate({visible:!0,duration:300})),pb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:"className",
get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(db){this.ui.closeButton.visible=db}},db:{serialize:!1,get:function(){return $b.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),
loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],Pc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-124"}}},{start:330,end:4020})}($b.Morph);zc=$b.WorldDashboard;$b.default=zc;var Fb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");
Fb.Morph=Eb;Fb.touchInputDevice=Zc;Fb.TilingLayout=Ra;Fb.arr=wd;Fb.pt=jd;zc=function(pc){var Pc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),wb=Pc.hasOwnProperty("GrowingWorldList")&&"function"===typeof Pc.GrowingWorldList?Pc.GrowingWorldList:Pc.GrowingWorldList=function(db){db&&db[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return od(wb,pc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(db){od._get(Object.getPrototypeOf(wb.prototype),
"onScroll",this).call(this,db);this.update()}},{key:"onChange",value:function(db){od._get(Object.getPrototypeOf(wb.prototype),"onChange",this).call(this,db);"extent"==db.prop&&this.update(!0)}},{key:"onHoverIn",value:function(db){this.clipMode="auto"}},{key:"onHoverOut",value:function(db){Fb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(db){var Ta=this.items;if(Ta&&0!=Ta.length){var cb=this.scrollContainer,ma=cb.layout.spacing;cb.extent=this.extent;var La=this.ui,fb=La.bufferTop;
La=La.bufferBottom;fb=fb||cb.addMorph({fill:null,name:"buffer top",height:10});La=La||cb.addMorph({fill:null,name:"buffer bottom",height:10});fb.width=La.width=this.width-100;cb.layout.disable();var pb=Ta[0];ma=Ta.slice(0,Math.floor(this.width/(pb.width+ma))*(Math.ceil((this.scroll.y+this.height)/(pb.height+ma))+1)).filter(function(Ab){return Ab.owner!=cb});pb=this.scroll.y+2*this.height;for(var xb={},Wa=$jscomp.makeIterator(ma),Xa=Wa.next();!Xa.done;xb={$jscomp$loop$prop$item$2281:xb.$jscomp$loop$prop$item$2281},
Xa=Wa.next())xb.$jscomp$loop$prop$item$2281=Xa.value,pb++,xb.$jscomp$loop$prop$item$2281.top=pb,cb.addMorph(xb.$jscomp$loop$prop$item$2281),xb.$jscomp$loop$prop$item$2281._initialized||xb.$jscomp$loop$prop$item$2281.whenRendered().then(function(Ab){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(kc){Ab.$jscomp$loop$prop$item$2281._initialized=!0;return kc.yield(Ab.$jscomp$loop$prop$item$2281.displayPreview(),0)})}}(xb));db&&(fb.position=Fb.pt(0,0),Ta.forEach(function(Ab,
kc){return Ab.position=Fb.pt(kc+1,kc+1)}),La.position=Fb.pt(Ta.length+2,Ta.length+2));cb.layout.enable();if(db||0<ma.length)La.top=this.submorphBounds().height,cb.layout.apply()}}}],[{key:"className",get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Fb.TilingLayout({spacing:25,align:"center",
autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(db){this.setProperty("items",db);var Ta=this.scrollContainer;Ta.layout&&Ta.layout.disable();var cb=this.ui,ma=cb.bufferTop;cb=cb.bufferBottom;Fb.arr.withoutAll(Ta.submorphs,[].concat($jscomp.arrayFromIterable(db),[ma,cb])).forEach(function(La){return La.remove()});this.update(!0)}}}}}],Pc,{pathInPackage:function(){return"index.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Fb.Morph);zc=Fb.GrowingWorldList;Fb.default=zc;var Cb=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");Cb.InputLine=tb;Cb.Color=Yc;Cb.connect=dc;Cb.disconnectAll=bc;Cb.disconnect=Xc;Cb.arr=wd;Cb.string=Gc;zc=function(pc){var Pc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),
wb=Pc.hasOwnProperty("SearchInputLine")&&"function"===typeof Pc.SearchInputLine?Pc.SearchInputLine:Pc.SearchInputLine=function(db){db&&db[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return od(wb,pc,[{key:"fuzzyMatch",value:function(db,Ta){Ta=void 0===Ta?this.parseInput():Ta;if(Ta.lowercasedTokens.every(function(ma){return db.toLowerCase().includes(ma)}))return!0;var cb=db.toLowerCase();return 3>=Cb.arr.sum(Ta.lowercasedTokens.map(function(ma){return Cb.string.levenshtein(cb,
ma)}))}},{key:"fuzzyFilter",value:function(db,Ta){var cb=this;Ta=void 0===Ta?function(La){return La}:Ta;var ma=this.parseInput();return Cb.arr.filter(db,function(La){return cb.fuzzyMatch(Ta(La),ma)})}},{key:"parseInput",value:function(){var db=Array.from(this.textString).reduce(function(cb,ma){if("\\"===ma&&!cb.escaped)return cb.escaped=!0,cb;" "!==ma||cb.escaped?(cb.spaceSeen=!1,cb.current+=ma):(!cb.spaceSeen&&cb.current&&(cb.tokens.push(cb.current),cb.current=""),cb.spaceSeen=!0);cb.escaped=!1;
return cb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});db.current&&db.tokens.push(db.current);var Ta=db.tokens.map(function(cb){return cb.toLowerCase()});return{tokens:db.tokens,lowercasedTokens:Ta}}}],[{key:"className",get:function(){return"SearchInputLine"}}],Pc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",
version:"0.1.1-4"}}},{start:239,end:1834})}(Cb.InputLine);zc=Cb.SearchInputLine;Cb.default=zc}}});
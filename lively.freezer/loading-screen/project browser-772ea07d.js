System.register(["./__root_module__-b4667baa.js","kld-intersections","./user-ui-fa4d36fc.js","./index-1bf516c3.js","./index-7dbbd7dc.js"],function(ta,lb){var yb,Qb,Kb,yd,Cc,rd,Fc,Dc,Rc,$c,Hd,gd,Uc,Pa,mb,Nb,Ub,Ic,wd;return{setters:[function(Eb){yb=Eb.ai;Qb=Eb.aB;Kb=Eb.ak;yd=Eb.an;Cc=Eb.Z;rd=Eb.a6;Fc=Eb.at;Dc=Eb.s;Rc=Eb.C;$c=Eb.a3;Hd=Eb.r;gd=Eb.as;Uc=Eb.aA;Pa=Eb.a_;mb=Eb.a$;Nb=Eb.aq;Ub=Eb.aX;Ic=Eb.aW},function(){},function(Eb){wd=Eb.UserUI},function(){},function(){}],execute:function(){var Eb=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");Eb.Morph=yb;Eb.HorizontalLayout=Qb;Eb.VerticalLayout=Kb;Eb.morph=yd;Eb.MorphicDB=Cc;Eb.arr=rd;Eb.fun=Fc;Eb.string=Dc;Eb.Color=Rc;Eb.pt=$c;Eb.UserUI=wd;Eb.resource=Hd;var Sb=function(rc){var yc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),Db=yc.hasOwnProperty("WorldDashboard")&&"function"===typeof yc.WorldDashboard?yc.WorldDashboard:yc.WorldDashboard=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return gd(Db,rc,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(ab){ab=void 0===ab?$world:ab;this.owner!=ab&&ab.addMorph(this);this.center=ab.visibleBounds().center()}},{key:"sortAndFilterPreviews",
value:function(ab){var Zb=Eb.UserUI.getCurrentUser();ab=this.ui.searchField.fuzzyFilter(ab,function(kc){return kc._commit.name+kc._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return Eb.arr.sortBy(ab,function(kc){return-kc._commit.timestamp});case "TEMPLATES":return ab;case "MY PROJECTS":return Eb.arr.filter(ab,function(kc){return kc._commit.author.name===Zb.name});case "PUBLISHED":return ab}}},{key:"updateList",value:function(){var ab=this;this.previews&&Eb.fun.debounceNamed("update world list",
150,function(){ab.ui.worldList.items=ab.sortAndFilterPreviews(ab.previews)})()}},{key:"displayWorlds",value:function(){var ab=this,Zb,kc,ua,Ga,cb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rb){switch(rb.nextAddress){case 1:return ab.reset(),Zb=ab.ui,kc=Zb.loadingLabel,kc.animate({opacity:1,duration:300}),rb.yield(ab.db.latestCommits("world"),2);case 2:return ua=rb.yieldResult,rb.yield(lb.import("./world preview-b016407c.js"),4);case 4:if(!(Ga=rb.yieldResult)){rb.jumpTo(5);break}return rb.yield(Eb.resource("part://partial freezing/world preview"),
6);case 6:Ga=rb.yieldResult;case 5:return rb.yield(Ga.read(),3);case 3:return cb=rb.yieldResult,ab.previews=ua.map(function(pb){var Ta=Eb.morph({reactsToPointer:!1,fill:Eb.Color.transparent,extent:cb.extent});Ta._commit=pb;Ta.displayPreview=function(){var Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){if(1==ob.nextAddress)return Ua=cb.copy(),Ua._commit=pb,Ua.opacity=0,Ta.addMorph(Ua),Ua.displayPreview(),Ua.position=Eb.pt(0,0),ob.yield(Ta.whenRendered(),2);Ta.layout=new Eb.HorizontalLayout({autoResize:!0,
reactToSubmorphAnimations:!0});ob.jumpToEnd()})};return Ta}),rb.yield(kc.animate({opacity:0,duration:300}),7);case 7:ab.updateList(),0==ua.length&&(ab.ui.noWorldWarning.center=ab.innerBounds().center(),ab.ui.noWorldWarning.animate({visible:!0,duration:300})),rb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,
get:function(){return this.ui.closeButton.visible},set:function(ab){this.ui.closeButton.visible=ab}},db:{serialize:!1,get:function(){return Eb.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],
yc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-127"}}},{start:330,end:3954})}(Eb.Morph);Sb=Eb.WorldDashboard;Eb.default=Sb;var sb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");sb.Morph=yb;sb.touchInputDevice=Uc;sb.TilingLayout=Pa;sb.arr=rd;sb.pt=$c;Sb=function(rc){var yc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),
Db=yc.hasOwnProperty("GrowingWorldList")&&"function"===typeof yc.GrowingWorldList?yc.GrowingWorldList:yc.GrowingWorldList=function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return gd(Db,rc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(ab){gd._get(Object.getPrototypeOf(Db.prototype),"onScroll",this).call(this,ab);this.update()}},{key:"onChange",value:function(ab){gd._get(Object.getPrototypeOf(Db.prototype),
"onChange",this).call(this,ab);"extent"==ab.prop&&this.update(!0)}},{key:"onHoverIn",value:function(ab){this.clipMode="auto"}},{key:"onHoverOut",value:function(ab){sb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(ab){var Zb=this.items;if(Zb&&0!=Zb.length){var kc=this.scrollContainer,ua=kc.layout.spacing;kc.extent=this.extent;var Ga=this.ui,cb=Ga.bufferTop;Ga=Ga.bufferBottom;cb=cb||kc.addMorph({fill:null,name:"buffer top",height:10});Ga=Ga||kc.addMorph({fill:null,name:"buffer bottom",
height:10});cb.width=Ga.width=this.width-100;kc.layout.disable();var rb=Zb[0];ua=Zb.slice(0,Math.floor(this.width/(rb.width+ua))*(Math.ceil((this.scroll.y+this.height)/(rb.height+ua))+1)).filter(function(ob){return ob.owner!=kc});rb=this.scroll.y+2*this.height;for(var pb={},Ta=$jscomp.makeIterator(ua),Ua=Ta.next();!Ua.done;pb={$jscomp$loop$prop$item$2257:pb.$jscomp$loop$prop$item$2257},Ua=Ta.next())pb.$jscomp$loop$prop$item$2257=Ua.value,rb++,pb.$jscomp$loop$prop$item$2257.top=rb,kc.addMorph(pb.$jscomp$loop$prop$item$2257),
pb.$jscomp$loop$prop$item$2257._initialized||pb.$jscomp$loop$prop$item$2257.whenRendered().then(function(ob){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wb){ob.$jscomp$loop$prop$item$2257._initialized=!0;return Wb.yield(ob.$jscomp$loop$prop$item$2257.displayPreview(),0)})}}(pb));ab&&(cb.position=sb.pt(0,0),Zb.forEach(function(ob,Wb){return ob.position=sb.pt(Wb+1,Wb+1)}),Ga.position=sb.pt(Zb.length+2,Zb.length+2));kc.layout.enable();if(ab||0<ua.length)Ga.top=this.submorphBounds().height,
kc.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new sb.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},
items:{after:["layout","scrollContainer"],set:function(ab){this.setProperty("items",ab);var Zb=this.scrollContainer;Zb.layout&&Zb.layout.disable();var kc=this.ui,ua=kc.bufferTop;kc=kc.bufferBottom;sb.arr.withoutAll(Zb.submorphs,[].concat($jscomp.arrayFromIterable(ab),[ua,kc])).forEach(function(Ga){return Ga.remove()});this.update(!0)}}}}}],yc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(sb.Morph);Sb=sb.GrowingWorldList;sb.default=Sb;var ec=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");ec.InputLine=mb;ec.Color=Rc;ec.connect=Nb;ec.disconnectAll=Ub;ec.disconnect=Ic;ec.arr=rd;ec.string=Dc;Sb=function(rc){var yc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),Db=yc.hasOwnProperty("SearchInputLine")&&"function"===typeof yc.SearchInputLine?yc.SearchInputLine:yc.SearchInputLine=
function(ab){ab&&ab[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return gd(Db,rc,[{key:"fuzzyMatch",value:function(ab,Zb){Zb=void 0===Zb?this.parseInput():Zb;if(Zb.lowercasedTokens.every(function(ua){return ab.toLowerCase().includes(ua)}))return!0;var kc=ab.toLowerCase();return 3>=ec.arr.sum(Zb.lowercasedTokens.map(function(ua){return ec.string.levenshtein(kc,ua)}))}},{key:"fuzzyFilter",value:function(ab,Zb){var kc=this;Zb=void 0===
Zb?function(Ga){return Ga}:Zb;var ua=this.parseInput();return ec.arr.filter(ab,function(Ga){return kc.fuzzyMatch(Zb(Ga),ua)})}},{key:"parseInput",value:function(){var ab=Array.from(this.textString).reduce(function(kc,ua){if("\\"===ua&&!kc.escaped)return kc.escaped=!0,kc;" "!==ua||kc.escaped?(kc.spaceSeen=!1,kc.current+=ua):(!kc.spaceSeen&&kc.current&&(kc.tokens.push(kc.current),kc.current=""),kc.spaceSeen=!0);kc.escaped=!1;return kc},{tokens:[],current:"",escaped:!1,spaceSeen:!1});ab.current&&ab.tokens.push(ab.current);
var Zb=ab.tokens.map(function(kc){return kc.toLowerCase()});return{tokens:ab.tokens,lowercasedTokens:Zb}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],yc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(ec.InputLine);Sb=ec.SearchInputLine;
ec.default=Sb}}});
System.register(["./__root_module__-884b54f8.js","kld-intersections"],function(za){var cb,mb,Pb,tb,Fc,vc,Qc,mc,ic,zc,Dc,Gd,Hd,Zd,xc,od;return{setters:[function(qb){cb=qb.s;mb=qb.P;Pb=qb.a;tb=qb.v;Fc=qb.w;vc=qb.x;Qc=qb.y;mc=qb.r;ic=qb.z;zc=qb.A;Dc=qb.E;Gd=qb.D;Hd=qb.F;Zd=qb.G;xc=qb.H;od=qb.J},function(){}],execute:function(){function qb(nb,cc,wc,dc){dc=void 0===dc?{}:dc;dc=dc.package||tc.ObjectPackage.lookupModuleForClass(nb.constructor,dc);if(!dc)throw Error("Object is not part of an object package: "+
nb);return dc.addScript(nb,cc,wc)}function kc(nb,cc){cc=tc.normalizeOptions(cc).System;nb=(nb=nb[Symbol.for("lively-module-meta")])?nb.package.name:null;return(cc=(nb?tc.lookupPackage(cc,nb):{}).pkg)?!!tc.ObjectPackage.forSystemPackage(cc):!1}function Uc(nb,cc){var wc,dc,Nc,$a,Xa,Gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ub){return 1==ub.nextAddress?(wc=nb.constructor,tc.withSuperclasses(wc),Symbol.for("lively-module-meta"),Nc=dc=tc.ObjectPackage.lookupPackageForObject(nb),$a=
Nc.baseURL,Xa=Nc.System,ub.yield(dc.fork(cc,{baseURL:$a,System:Xa}),2)):3!=ub.nextAddress?(Gb=ub.yieldResult,ub.yield(tc.adoptObject(nb,Gb.objectClass),3)):ub.return(Gb.objectClass[Symbol.for("__LivelyClassName__")])})}za({addScript:qb,interactivelyForkPackage:Uc,isObjectClass:kc});var tc=lively.FreezerRuntime.recorderFor("lively.classes/object-classes.js");tc.normalizeOptions=function(nb){nb=Object.assign({baseURL:tc.defaultBaseURL,System:System},nb);nb.baseURL=nb.baseURL.replace(/\/$/,"");return nb};
tc.addScript=qb;tc.isObjectClass=kc;tc.interactivelyForkPackage=Uc;tc.string=cb;tc.Path=mb;tc.arr=Pb;tc.parse=tb;tc.isValidIdentifier=Fc;tc.stringify=vc;tc.parseFunction=Qc;tc.resource=mc;tc.runEval=ic;tc.scripting=zc;tc.ExportLookup=Dc;var cd=tc.scripting;tc.ensurePackage=cd.ensurePackage;tc.registerPackage=cd.registerPackage;tc.importPackage=cd.importPackage;tc.lookupPackage=cd.lookupPackage;tc.module=cd.module;tc.ImportInjector=cd.ImportInjector;tc.RuntimeSourceDescriptor=Gd;tc.toJsIdentifier=
Hd;tc.withSuperclasses=Zd;tc.adoptObject=xc;tc.classToFunctionTransform=od;tc.objectPackageSym=Symbol.for("lively-object-package-data");tc.defaultBaseURL="local://lively-object-modules";tc.globalClasses=Object.keys(System.global).map(function(nb){nb=System.global[nb];return"function"===typeof nb&&nb.name&&nb}).filter(Boolean);tc.addScript=qb;tc.addScript=qb;tc.isObjectClass=kc;tc.isObjectClass=kc;tc._packageStore=tc._packageStore||{};tc.interactivelyForkPackage=Uc;tc.interactivelyForkPackage=Uc;cd=
function(nb,cc){this._id=nb;this.options=tc.normalizeOptions(cc)};cd.lookupPackageForObject=function(nb,cc){return this.lookupPackageForClass(nb.constructor,cc)};cd.lookupPackageForClass=function(nb,cc){cc=tc.normalizeOptions(cc).System;nb=(nb=nb[Symbol.for("lively-module-meta")])?nb.package.name:null;return(cc=(nb?tc.lookupPackage(cc,nb):{}).pkg)?tc.ObjectPackage.forSystemPackage(cc):null};cd.lookupModuleForClass=function(nb,cc){tc.normalizeOptions(cc);cc=this.lookupPackageForClass(nb,cc);nb=nb[Symbol.for("lively-module-meta")];
return new tc.ObjectModule(nb.pathInPackage,cc)};cd.forSystemPackage=function(nb){return this.packageStore[nb.name]};cd.withId=function(nb,cc){return this.packageStore[nb]||(this.packageStore[nb]=new this(nb,cc))};cd.prototype.ensureSubModule=function(nb){nb=void 0===nb?"index":nb;var cc=this,wc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(dc){return 1==dc.nextAddress?(wc=new tc.ObjectModule(nb,cc),dc.yield(wc.ensureExistance(),2)):dc.return(wc)})};cd.prototype.resource=function(nb){nb=
void 0===nb?"":nb;return tc.resource(this.packageURL).join(nb)};cd.prototype.load=function(){return tc.importPackage(this.System,this.packageURL)};cd.prototype.ensureExistance=function(){var nb=this,cc,wc,dc,Nc,$a,Xa,Gb,ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(db){switch(db.nextAddress){case 1:return cc=nb.resource("/"),db.yield(cc.exists(),2);case 2:if(db.yieldResult)return db.return();wc=[{resource:cc}];dc=[{resource:nb.resource("package.json"),content:JSON.stringify(nb.config,
null,2)}];return db.yield(Promise.all(wc.map(function(Xb){return Xb.resource.mkdir()})),3);case 3:return db.yield(Promise.all(dc.map(function(Xb){var Fa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){switch(sb.nextAddress){case 1:return sb.yield(Xb.resource.exists(),2);case 2:if(!(Fa=!sb.yieldResult)){sb.jumpTo(3);break}return sb.yield(Xb.resource.write(Xb.content),4);case 4:Fa=sb.yieldResult;case 3:return sb.return(Fa)}})})),4);case 4:return db.yield(nb.objectModule.ensureExistance(),
5);case 5:return Nc=nb,$a=Nc.System,Xa=Nc.packageURL,Gb=Nc.config,db.yield(tc.ensurePackage($a,Xa),6);case 6:return ub=db.yieldResult,ub.registerWithConfig(Gb),console.log(nb.packageURL+" REGISTERED"),db.return(nb)}})};cd.prototype.ensureObjectClass=function(nb){var cc=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){return 1==wc.nextAddress?wc.yield(cc.ensureExistance(),2):wc.return(cc.objectModule.ensureObjectClass(nb))})};cd.prototype.adoptObject=function(nb){var cc=this,wc;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(dc){if(1==dc.nextAddress)return cc.objectClass===nb.constructor?dc.return():dc.yield(cc.ensureObjectClass(nb.constructor),2);wc=dc.yieldResult;tc.adoptObject(nb,wc);dc.jumpToEnd()})};cd.prototype.addScript=function(nb,cc,wc){return this.objectModule.addScript(nb,cc,wc)};cd.prototype.remove=function(){this.systemPackage.remove();delete tc.ObjectPackage.packageStore[this.id];return this.resource().remove()};cd.prototype.renameObjectClass=function(nb,
cc){cc=void 0===cc?[]:cc;var wc=this,dc,Nc,$a,Xa,Gb,ub,db,Xb,Fa,sb,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pb){if(1==pb.nextAddress){dc=wc;Nc=dc.objectClass;$a=dc.System;if(!Nc||Nc[Symbol.for("__LivelyClassName__")]===nb)return pb.return(Nc);if(!tc.isValidIdentifier(nb))throw Error(nb+" is not a valid name for a class");Gb=Xa=tc.RuntimeSourceDescriptor.for(Nc,$a);ub=Gb.source;db=Gb.ast;Xb=db.id;Fa=Xb.start;sb=Xb.end;return pb.yield(Xa.changeSource(ub.slice(0,Fa)+nb+ub.slice(sb)),
2)}Ya=wc.objectClass;cc.forEach(function($b){$b.constructor=Ya;$b.__proto__=Ya.prototype});return pb.return(Ya)})};cd.prototype.fork=function(nb,cc){var wc=this,dc,Nc,$a,Xa,Gb,ub,db,Xb,Fa,sb,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pb){switch(pb.nextAddress){case 1:return dc=wc,Nc=dc.System,$a=dc.baseURL,Xa=dc.objectClass,cc=Object.assign({System:Nc,baseURL:$a},cc),Gb=tc.RuntimeSourceDescriptor.for(Xa),ub=Gb._renamedSource(nb),db=ub.moduleSource,Xb=tc.ObjectPackage.withId(nb,
cc),pb.yield(Xb.ensureExistance(),2);case 2:return Fa=Xb,sb=Fa.objectModule,Ya=sb.systemModule,pb.yield(Ya.load({format:"esm"}),3);case 3:return pb.yield(Ya.changeSource(db),4);case 4:return pb.return(Xb)}})};$jscomp.global.Object.defineProperties(cd.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},name:{configurable:!0,enumerable:!0,get:function(){return this.id}},System:{configurable:!0,enumerable:!0,get:function(){return this.options.System}},baseURL:{configurable:!0,
enumerable:!0,get:function(){return this.options.baseURL}},packageURL:{configurable:!0,enumerable:!0,get:function(){return this.baseURL+("/"+this.id)}},config:{configurable:!0,enumerable:!0,get:function(){return{name:this.name,version:"0.1.0",lively:{isObjectPackage:!0}}}},systemPackage:{configurable:!0,enumerable:!0,get:function(){return tc.lookupPackage(this.System,this.packageURL,!0).pkg}},objectModule:{configurable:!0,enumerable:!0,get:function(){return this._objectModule||(this._objectModule=
new tc.ObjectModule("index.js",this))}},objectClass:{configurable:!0,enumerable:!0,get:function(){return this.objectModule.objectClass}}});$jscomp.global.Object.defineProperties(cd,{packageStore:{configurable:!0,enumerable:!0,get:function(){return this._packageStore||(this._packageStore=tc._packageStore)}}});za("default",cd);tc.ObjectPackage=cd;var td=function(nb,cc){if(!nb)throw Error("ObjectModule needs package!");if(!cc)throw Error("ObjectModule needs package!");this._moduleName=nb;this._objectPackage=
cc};td.prototype.read=function(){return this.resource.read()};td.prototype.write=function(nb){return this.resource.write(nb)};td.prototype.ensureExistance=function(){var nb=this,cc,wc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(dc){switch(dc.nextAddress){case 1:return cc=nb.resource,dc.yield(cc.exists(),2);case 2:if(dc.yieldResult){dc.jumpTo(3);break}return dc.yield(cc.write("'format esm';\n"),4);case 4:wc={},nb.System.config({meta:(wc[nb.url]={format:"esm"},wc)});case 3:return dc.return(nb)}})};
td.prototype.adoptObject=function(nb,cc){var wc=this,dc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Nc){if(1==Nc.nextAddress)return wc.objectClass===nb.constructor?Nc.return():Nc.yield(wc.ensureObjectClass(nb.constructor,cc),2);dc=Nc.yieldResult;tc.adoptObject(nb,dc);Nc.jumpToEnd()})};td.prototype.ensureObjectClass=function(nb,cc){var wc=this,dc=this.objectClass;return dc&&dc.prototype.__proto__===nb.prototype?dc:Promise.resolve(this.ensureObjectClassSource(nb,cc)).then(function(Nc){var $a=
Nc.source,Xa=Nc.moduleId,Gb=Nc.className,ub=Nc.bindings,db=wc.System;Nc=tc.module(db,Xa);if(ub)for(var Xb in ub)Nc.define(Xb,ub[Xb]);$a=tc.runEval($a,{classTransform:tc.classToFunctionTransform,sync:!0,targetModule:Xa,System:db});if($a.isError)throw $a.value;$a=Nc.recorder[Gb];if(!$a)throw Error("Failed to define class "+Gb+" in "+Xa);return $a})};td.prototype.ensureObjectClassSource=function(nb,cc){return this.createDefaultClassDeclaration(nb,cc)};td.prototype.createDefaultClassDeclaration=function(nb,
cc){nb=void 0===nb?Object:nb;cc=void 0===cc?!1:cc;var wc=this,dc,Nc,$a,Xa,Gb,ub,db,Xb,Fa,sb,Ya,pb,$b,lc,Jb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Cb){switch(Cb.nextAddress){case 1:dc=wc;Nc=dc.System;$a=dc.systemModule;Xa=dc.objectPackage;cc=cc||tc.string.capitalize(tc.toJsIdentifier(Xa.id));Gb=nb[Symbol.for("__LivelyClassName__")];ub=!Gb;db=tc.globalClasses.includes(nb);Xb="";Fa=null;if(ub){Gb="__anonymous_superclass__";sb={};Fa=(sb[Gb]=nb,sb);Cb.jumpTo(2);break}if(db){Cb.jumpTo(2);
break}return Cb.yield(tc.ExportLookup.findExportOfValue(nb,Nc),4);case 4:(Ya=Cb.yieldResult)?(pb=tc.ImportInjector.run(Nc,$a.id,$a.package(),"",Ya),$b=pb.standaloneImport,Xb+=$b+"\n\n"):(lc={},Fa=(lc[Gb]=nb,lc));case 2:return cc===Gb&&(cc="Object"+cc),Jb="Object"===Gb?"class "+cc+" {}\n":"class "+cc+" extends "+Gb+" {}\n",Xb+="export default "+Jb+"\n",Cb.yield($a.changeSource(Xb),5);case 5:return Cb.yield($a.load(),6);case 6:return Cb.return({source:Xb,className:cc,moduleId:wc.url,bindings:Fa})}})};
td.prototype.addScript=function(nb,cc,wc){var dc=this,Nc,$a,Xa,Gb,ub,db,Xb,Fa,sb,Ya,pb,$b,lc,Jb,Cb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bb){switch(Bb.nextAddress){case 1:if(nb.constructor===dc.objectClass){Nc=nb.constructor;Bb.jumpTo(2);break}return Bb.yield(dc.ensureObjectClass(nb.constructor),3);case 3:Nc=Bb.yieldResult;case 2:$a=Nc;Xa="function"===typeof cc?String(cc):cc;Gb=tc.parseFunction(Xa);ub=tc.RuntimeSourceDescriptor.for($a,dc.System);wc||(wc=tc.Path("id.name").get(Gb));
if(!wc)throw Error("No name, cannot add "+tc.string.truncate(Xa,30).replace(/\n/g,"")+"!");db=tc.toJsIdentifier(wc);console.assert("FunctionExpression"===Gb.type||"ArrowFunctionExpression"===Gb.type,"not a function expression but: "+Gb.type);Xb=Gb.params.map(function(sa){return Xa.slice(sa.start,sa.end)});Fa="BlockStatement"===Gb.body.type?Xa.slice(Gb.body.start,Gb.body.end):"{ return "+Xa.slice(Gb.body.start,Gb.body.end)+" }";sb=db+"("+Xb.join(",")+") "+Fa;"ArrowFunctionExpression"===Gb.type&&(Gb.type=
"FunctionExpression");Ya=ub.source;pb=ub.ast;if(!pb)throw Error("cannot find class decl of "+ub.module.id);($b=pb.body.body.find(function(sa){return sa.key.name===db&&!sa.static}))?Ya=Ya.slice(0,$b.start)+sb+Ya.slice($b.end):(lc=Ya.lastIndexOf("}"),Jb=Ya.slice(0,lc),Cb=Ya.slice(lc),/\n\s*$/m.test(Jb)||(Jb+="\n"),sb=tc.string.changeIndent(sb,"  ",1),/^[ ]*\n/m.test(Cb)||(Cb="\n"+Cb),Ya=Jb+sb+Cb);return Bb.yield(ub.changeSource(Ya),4);case 4:return Bb.return({script:$a.prototype[db],klass:$a,module:ub.module.id,
methodName:db})}})};$jscomp.global.Object.defineProperties(td.prototype,{objectPackage:{configurable:!0,enumerable:!0,get:function(){return this._objectPackage}},objectClass:{configurable:!0,enumerable:!0,get:function(){var nb=this.systemModule;return nb.isLoaded()?nb.System.get(nb.id).default:null}},moduleName:{configurable:!0,enumerable:!0,get:function(){return this._moduleName}},systemModule:{configurable:!0,enumerable:!0,get:function(){return tc.module(this.System,this.url)}},System:{configurable:!0,
enumerable:!0,get:function(){return this.objectPackage.System}},resource:{configurable:!0,enumerable:!0,get:function(){return this.objectPackage.resource(this.moduleName)}},url:{configurable:!0,enumerable:!0,get:function(){return this.resource.url}}});tc.ObjectModule=td;tc.default=cd}}});
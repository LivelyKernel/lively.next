System.register("./__root_module__-89b08ab2.js kld-intersections ./user-ui-281b954b.js ./index-debc65e7.js ./index-1502344e.js ./editor-plugin-a483404a.js ./index-b806b9af.js".split(" "),function(ta,nb){var xb,Ob,Hb,qd,Dc,hd,Hc,Fc;return{setters:[function(Sc){xb=Sc.aj;Ob=Sc.ap;Hb=Sc.a3;qd=Sc.C;Dc=Sc.a6;hd=Sc.L;Hc=Sc.r;Fc=Sc.at},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var Sc=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");Sc.Morph=
xb;Sc.Icon=Ob;Sc.pt=Hb;Sc.Color=qd;Sc.arr=Dc;Sc.LoadingIndicator=hd;Sc.resource=Hc;var ad=function(Jd){var ed=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),sc=ed.hasOwnProperty("LivelyTopBar")&&"function"===typeof ed.LivelyTopBar?ed.LivelyTopBar:ed.LivelyTopBar=function(Sa){Sa&&Sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Fc(sc,Jd,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode=
"Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var Sa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ob){if(1==ob.nextAddress)return Sa.isComponent?ob.return():ob.yield(Sa.whenRendered(),2);document.body.style.background="black";Sa.setEditMode("Halo");Sa.getSubmorphNamed("fast load toggler").refresh();ob.jumpToEnd()})}},{key:"onUserChanged",value:function(Sa){this.getSubmorphNamed("user flap").onUserChanged(Sa)}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&
(this.width=this.world().visibleBounds().width,this.position=Sc.pt(0,0));var Sa=this.getSubmorphNamed("user flap");this.get("ipad status bar").width=this.width;Sa.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var Sa=this;return Object.entries(this.shapeToIcon).map(function(ob){ob=$jscomp.makeIterator(ob);var $b=ob.next().value,Sb=ob.next().value;ob=Sb.shortcut;Sb=Sb.args;return[[].concat($jscomp.arrayFromIterable(Sa.currentShapeMode===$b?[].concat($jscomp.arrayFromIterable(Sc.Icon.textAttribute("check",
{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(Sc.Icon.textAttribute.apply(Sc.Icon,$jscomp.arrayFromIterable(Sb))),["   "+$b+" ",{float:"none"},"      "+ob,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){Sa.currentShapeMode=$b;Sa.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var Sa=this;return Object.entries(this.sideBarToIcon).map(function(ob){ob=$jscomp.makeIterator(ob);var $b=ob.next().value;ob=ob.next().value.args;
return[[].concat($jscomp.arrayFromIterable(Sa.activeSideBars.includes($b)?[].concat($jscomp.arrayFromIterable(Sc.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(Sc.Icon.textAttribute.apply(Sc.Icon,$jscomp.arrayFromIterable(ob))),["   "+$b+" ",{float:"none"}]),function(){return Sa.openSideBar($b)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");
this.openSideBar("Styling Palette")}},{key:"onKeyUp",value:function(Sa){"Hand"==this._currentEditMode&&this.setEditMode("Hand",!0)}},{key:"onKeyDown",value:function(Sa){Fc._get(Object.getPrototypeOf(sc.prototype),"onKeyDown",this).call(this,Sa);if(Sa.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!Sa.isAltDown()){var ob={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(Sa.key){case "Escape":this.setEditMode("Halo");break;
case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=ob[Sa.key];this.setEditMode("Shape");break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(Sa){var ob=this,$b,Sb,Bc,id,Xb,Ub;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ub){switch(ub.nextAddress){case 1:ob.activeSideBars.includes(Sa)?Sc.arr.remove(ob.activeSideBars,Sa):ob.activeSideBars.push(Sa);if("Scene Graph"!=Sa){ub.jumpTo(2);break}if(ob.sideBar){ub.jumpTo(3);break}$b=
Sc.LoadingIndicator.open("loading side bar");return ub.yield($b.whenRendered(),4);case 4:return Sb=ob,ub.yield(nb.import("./scene graph side bar master-36c840f9.js"),6);case 6:if(!(Bc=ub.yieldResult)){ub.jumpTo(7);break}return ub.yield(Sc.resource("part://SystemIDE/scene graph side bar master"),8);case 8:Bc=ub.yieldResult;case 7:return ub.yield(Bc.read(),5);case 5:return Sb.sideBar=ub.yieldResult,ob.sideBar.hasFixedPosition=!0,ob.sideBar.respondsToVisibleWindow=!0,ob.sideBar.openInWorld(),ob.sideBar.right=
0,ub.yield(ob.sideBar.whenRendered(),9);case 9:$b.remove();case 3:ob.sideBar.toggle(ob.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=Sa){ub.jumpTo(0);break}if(ob.stylingPalette){ub.jumpTo(11);break}id=Sc.LoadingIndicator.open("loading side bar");return ub.yield(id.whenRendered(),12);case 12:return Xb=ob,ub.yield(nb.import("./styling side bar master-045b7c7c.js"),14);case 14:if(!(Ub=ub.yieldResult)){ub.jumpTo(15);break}return ub.yield(Sc.resource("part://SystemIDE/styling side bar master"),
16);case 16:Ub=ub.yieldResult;case 15:return ub.yield(Ub.read(),13);case 13:return Xb.stylingPalette=ub.yieldResult,ob.stylingPalette.collapseAll(),ob.stylingPalette.hasFixedPosition=!0,ob.stylingPalette.respondsToVisibleWindow=!0,ob.stylingPalette.openInWorld(),ob.stylingPalette.left=ob.world().right,ub.yield(ob.stylingPalette.whenRendered(),17);case 17:id.remove();case 11:ob.stylingPalette.toggle(ob.activeSideBars.includes("Styling Palette")),ub.jumpToEnd()}})}},{key:"onMouseDown",value:function(Sa){var ob=
this.get("select shape type"),$b=this.get("shape mode button"),Sb=this.get("side bar selector");Sa.targetMorph==ob&&(this.world().openWorldMenu(Sa,this.getShapeMenuItems()).position=$b.globalBounds().bottomLeft().subPt(this.world().scroll));Sa.targetMorph==$b&&this.setEditMode("Shape");"text mode button"==Sa.targetMorph.name&&this.setEditMode("Text");"hand mode button"==Sa.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==Sa.targetMorph.name&&this.setEditMode("Halo");"open component browser"==
Sa.targetMorph.name&&this.interactivelyLoadComponent();"load world button"==Sa.targetMorph.name&&this.world().execCommand("load world");Sa.targetMorph==Sb&&(this.world().openWorldMenu(Sa,this.getSideBarMenuItems()).position=Sb.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var Sa=this,ob,$b,Sb,Bc,id;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xb){if(1==Xb.nextAddress)return ob=Sa.get("open component browser"),$b=Sa.get("user flap"),
Sb=$b.haloShadow,Bc=$b.haloColor,id=Sc.Color.rgb(102,102,102),ob.fontColor=Bc,ob.dropShadow=Sb,Xb.yield(Sa.world().execCommand("browse and load component"),2);ob.dropShadow=!1;ob.fontColor=id;Xb.jumpToEnd()})}},{key:"setEditMode",value:function(Sa,ob){var $b=this;ob=void 0===ob?!1:ob;var Sb=this.get("user flap"),Bc=Sb.haloShadow,id=Sb.haloColor,Xb=Sc.Color.rgb(102,102,102);ob||(this._currentEditMode=Sa);ob=this.get("shape mode button");Sb=this.get("text mode button");var Ub=this.get("hand mode button"),
ub=this.get("halo mode button");[["Shape",ob.submorphs],["Text",[Sb]],["Hand",[Ub]],["Halo",[ub]]].forEach(function(hc){var wc=$jscomp.makeIterator(hc);hc=wc.next().value;wc=wc.next().value;"Shape"==Sa?$b.world().toggleShapeMode(!0,$b.currentShapeMode):"Text"==Sa?$b.world().toggleShapeMode(!0,"Text"):$b.world().toggleShapeMode(!1);$b.world().showHaloPreviews("Halo"==Sa);hc==Sa?wc.forEach(function(bd){bd.dropShadow=Bc;bd.fontColor=id}):wc.forEach(function(bd){bd.dropShadow=null;bd.fontColor=Xb})})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],set:function(Sa){this.setProperty("currentShapeMode",Sa);this.get("shape status icon").textAndAttributes=Sc.Icon.textAttribute(this.shapeToIcon[Sa].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",{textStyleClasses:["fas"]}]}}}},
shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},
HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],ed,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-156"}}},{start:328,end:9508})}(Sc.Morph);ad=Sc.LivelyTopBar;Sc.default=ad}}});
System.register(["./__root_module__-cc486366.js","kld-intersections","./user-ui-58858c09.js","./index-9493f22b.js"],function(ta,mb){var tb,Tb,Jb,rd,yc,vd,zc,Ec;return{setters:[function(Mc){tb=Mc.an;Tb=Mc.as;Jb=Mc.a3;rd=Mc.C;yc=Mc.a6;vd=Mc.L;zc=Mc.r;Ec=Mc.aw},function(){},function(){},function(){}],execute:function(){var Mc=lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js");Mc.Morph=tb;Mc.Icon=Tb;Mc.pt=Jb;Mc.Color=rd;Mc.arr=yc;Mc.LoadingIndicator=vd;Mc.resource=zc;var zd=function(ne){var De=
lively.FreezerRuntime.recorderFor("LivelyTopBar/index.js"),Xd=De.hasOwnProperty("LivelyTopBar")&&"function"===typeof De.LivelyTopBar?De.LivelyTopBar:De.LivelyTopBar=function(Qb){Qb&&Qb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Ec(Xd,ne,[{key:"beforePublish",value:function(){this.activeSideBars=[];this.currentShapeMode="Rectangle";this.setEditMode("Halo")}},{key:"onLoad",value:function(){var Qb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(qc){if(1==
qc.nextAddress)return Qb.isComponent?qc.return():qc.yield(Qb.whenRendered(),2);document.body.style.background="black";Qb.setEditMode("Halo");Qb.getSubmorphNamed("fast load toggler").refresh();qc.jumpToEnd()})}},{key:"onUserChanged",value:function(Qb){this.getSubmorphNamed("user flap").onUserChanged(Qb)}},{key:"relayout",value:function(){this.respondsToVisibleWindow&&(this.width=this.world().visibleBounds().width,this.position=Mc.pt(0,0));var Qb=this.getSubmorphNamed("user flap");this.get("ipad status bar").width=
this.width;Qb.right=this.width-10}},{key:"getShapeMenuItems",value:function(){var Qb=this;return Object.entries(this.shapeToIcon).map(function(qc){qc=$jscomp.makeIterator(qc);var ld=qc.next().value,Pb=qc.next().value;qc=Pb.shortcut;Pb=Pb.args;return[[].concat($jscomp.arrayFromIterable(Qb.currentShapeMode===ld?[].concat($jscomp.arrayFromIterable(Mc.Icon.textAttribute("check",{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(Mc.Icon.textAttribute.apply(Mc.Icon,$jscomp.arrayFromIterable(Pb))),
["   "+ld+" ",{float:"none"},"      "+qc,{float:"right",fontSize:11,opacity:.5,fontFamily:"IBM Plex Mono"}]),function(){Qb.currentShapeMode=ld;Qb.setEditMode("Shape")}]})}},{key:"getSideBarMenuItems",value:function(){var Qb=this;return Object.entries(this.sideBarToIcon).map(function(qc){qc=$jscomp.makeIterator(qc);var ld=qc.next().value;qc=qc.next().value.args;return[[].concat($jscomp.arrayFromIterable(Qb.activeSideBars.includes(ld)?[].concat($jscomp.arrayFromIterable(Mc.Icon.textAttribute("check",
{fontSize:11,paddingTop:"2px"})),["   ",{}]):["     ",{}]),$jscomp.arrayFromIterable(Mc.Icon.textAttribute.apply(Mc.Icon,$jscomp.arrayFromIterable(qc))),["   "+ld+" ",{float:"none"}]),function(){return Qb.openSideBar(ld)}]})}},{key:"reloadSidebar",value:function(){this.sideBar.remove();this.sideBar=null;this.stylingPalette.remove();this.stylingPalette=null;this.openSideBar("Scene Graph");this.openSideBar("Styling Palette")}},{key:"onKeyUp",value:function(Qb){"Hand"==this._currentEditMode&&this.setEditMode("Hand",
!0)}},{key:"onKeyDown",value:function(Qb){Ec._get(Object.getPrototypeOf(Xd.prototype),"onKeyDown",this).call(this,Qb);if(Qb.isCommandKey()&&"Hand"==this._currentEditMode)this.setEditMode("Halo",!0);else if(!Qb.isAltDown()){var qc={R:"Rectangle",E:"Ellipse",I:"Image",P:"Path",Q:"Polygon",L:"Label",C:"Canvas",H:"HTML"};switch(Qb.key){case "Escape":this.setEditMode("Halo");break;case "R":case "E":case "I":case "P":case "Q":case "L":case "C":case "H":this.currentShapeMode=qc[Qb.key];this.setEditMode("Shape");
break;case "T":this.setEditMode("Text")}}}},{key:"openSideBar",value:function(Qb){var qc=this,ld,Pb,ud,Ed,vc,ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Eb){switch(Eb.nextAddress){case 1:qc.activeSideBars.includes(Qb)?Mc.arr.remove(qc.activeSideBars,Qb):qc.activeSideBars.push(Qb);if("Scene Graph"!=Qb){Eb.jumpTo(2);break}if(qc.sideBar){Eb.jumpTo(3);break}ld=Mc.LoadingIndicator.open("loading side bar");return Eb.yield(ld.whenRendered(),4);case 4:return Pb=qc,Eb.yield(mb.import("./scene graph side bar master-eed6eeb4.js"),
6);case 6:if(!(ud=Eb.yieldResult)){Eb.jumpTo(7);break}return Eb.yield(Mc.resource("part://SystemIDE/scene graph side bar master"),8);case 8:ud=Eb.yieldResult;case 7:return Eb.yield(ud.read(),5);case 5:return Pb.sideBar=Eb.yieldResult,qc.sideBar.hasFixedPosition=!0,qc.sideBar.respondsToVisibleWindow=!0,qc.sideBar.openInWorld(),qc.sideBar.right=0,Eb.yield(qc.sideBar.whenRendered(),9);case 9:ld.remove();case 3:qc.sideBar.toggle(qc.activeSideBars.includes("Scene Graph"));case 2:if("Styling Palette"!=
Qb){Eb.jumpTo(0);break}if(qc.stylingPalette){Eb.jumpTo(11);break}Ed=Mc.LoadingIndicator.open("loading side bar");return Eb.yield(Ed.whenRendered(),12);case 12:return vc=qc,Eb.yield(mb.import("./styling side bar master-93b3fb75.js"),14);case 14:if(!(ac=Eb.yieldResult)){Eb.jumpTo(15);break}return Eb.yield(Mc.resource("part://SystemIDE/styling side bar master"),16);case 16:ac=Eb.yieldResult;case 15:return Eb.yield(ac.read(),13);case 13:return vc.stylingPalette=Eb.yieldResult,qc.stylingPalette.collapseAll(),
qc.stylingPalette.hasFixedPosition=!0,qc.stylingPalette.respondsToVisibleWindow=!0,qc.stylingPalette.openInWorld(),qc.stylingPalette.left=qc.world().width,Eb.yield(qc.stylingPalette.whenRendered(),17);case 17:Ed.remove();case 11:qc.stylingPalette.toggle(qc.activeSideBars.includes("Styling Palette")),Eb.jumpToEnd()}})}},{key:"onMouseDown",value:function(Qb){var qc=this.get("select shape type"),ld=this.get("shape mode button"),Pb=this.get("side bar selector");Qb.targetMorph==qc&&(this.world().openWorldMenu(Qb,
this.getShapeMenuItems()).position=ld.globalBounds().bottomLeft().subPt(this.world().scroll));Qb.targetMorph==ld&&this.setEditMode("Shape");"text mode button"==Qb.targetMorph.name&&this.setEditMode("Text");"hand mode button"==Qb.targetMorph.name&&this.setEditMode("Hand");"halo mode button"==Qb.targetMorph.name&&this.setEditMode("Halo");"open component browser"==Qb.targetMorph.name&&this.interactivelyLoadComponent();"load world button"==Qb.targetMorph.name&&this.world().execCommand("load world");Qb.targetMorph==
Pb&&(this.world().openWorldMenu(Qb,this.getSideBarMenuItems()).position=Pb.globalBounds().bottomLeft().subPt(this.world().scroll))}},{key:"interactivelyLoadComponent",value:function(){var Qb=this,qc,ld,Pb,ud,Ed;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vc){if(1==vc.nextAddress)return qc=Qb.get("open component browser"),ld=Qb.get("user flap"),Pb=ld.haloShadow,ud=ld.haloColor,Ed=Mc.Color.rgb(102,102,102),qc.fontColor=ud,qc.dropShadow=Pb,vc.yield(Qb.world().execCommand("browse and load component"),
2);qc.dropShadow=!1;qc.fontColor=Ed;vc.jumpToEnd()})}},{key:"setEditMode",value:function(Qb,qc){var ld=this;qc=void 0===qc?!1:qc;var Pb=this.get("user flap"),ud=Pb.haloShadow,Ed=Pb.haloColor,vc=Mc.Color.rgb(102,102,102);qc||(this._currentEditMode=Qb);qc=this.get("shape mode button");Pb=this.get("text mode button");var ac=this.get("hand mode button"),Eb=this.get("halo mode button");[["Shape",qc.submorphs],["Text",[Pb]],["Hand",[ac]],["Halo",[Eb]]].forEach(function(ec){var wc=$jscomp.makeIterator(ec);
ec=wc.next().value;wc=wc.next().value;"Shape"==Qb?ld.world().toggleShapeMode(!0,ld.currentShapeMode):"Text"==Qb?ld.world().toggleShapeMode(!0,"Text"):ld.world().toggleShapeMode(!1);ld.world().showHaloPreviews("Halo"==Qb);ec==Qb?wc.forEach(function(fd){fd.dropShadow=ud;fd.fontColor=Ed}):wc.forEach(function(fd){fd.dropShadow=null;fd.fontColor=vc})})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LivelyTopBar"}},{key:"properties",get:function(){return{activeSideBars:{},currentShapeMode:{after:["submorphs"],
set:function(Qb){this.setProperty("currentShapeMode",Qb);this.get("shape status icon").textAndAttributes=Mc.Icon.textAttribute(this.shapeToIcon[Qb].args[0])}},sideBarToIcon:{readOnly:!0,get:function(){return{"Scene Graph":{args:["sitemap",{textStyleClasses:["fas"]}]},"Styling Palette":{args:["palette",{textStyleClasses:["fas"]}]}}}},shapeToIcon:{readOnly:!0,get:function(){return{Rectangle:{shortcut:"R",args:["square",{textStyleClasses:["fas"]}]},Ellipse:{shortcut:"E",args:["circle",{textStyleClasses:["fas"]}]},
Image:{shortcut:"I",args:["image",{textStyleClasses:["fas"],paddingTop:"1px"}]},Path:{shortcut:"P",args:["bezier-curve",{fontSize:13,paddingTop:"3px"}]},Polygon:{shortcut:"Q",args:["draw-polygon",{fontSize:17}]},Label:{shortcut:"L",args:["tag",{paddingTop:"1px"}]},Canvas:{shortcut:"C",args:["chess-board",{paddingTop:"1px"}]},HTML:{shortcut:"H",args:["code",{paddingTop:"1px"}]}}}}}}}],De,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"LivelyTopBar",version:"0.1.1-157"}}},{start:328,end:9460})}(Mc.Morph);zd=Mc.LivelyTopBar;Mc.default=zd}}});System.register("21",["./__root_module__-cc486366.js","kld-intersections","./index-8abf3648.js","./user-ui-58858c09.js"],function(){return{setters:[function(){},function(){},function(){},function(){}],execute:function(){}}});
System.register(["./__root_module__-c4d7431e.js","./index-ad3a1066.js","./index-1640eed6.js"],function(ta){var nb,Bb,Vb,Qb,Dd,Ic,ud,Nc,Jc,Xc,id,Fd,nd,Yc,Ta,sb,dc,ac,Vc,Hd,hc,kc,xb,yb,wc,Kc,zb,ab,Kb,nc,da,qa,Va,cb,kb,Ma,Oa,lb,Wb,Nb,rc,xc,I,T,ua;return{setters:[function(Da){nb=Da.C;Bb=Da.ar;Vb=Da.a5;Qb=Da.a0;Dd=Da.a2;Ic=Da.am;ud=Da.bf;Nc=Da.aT;Jc=Da.ap;Xc=Da.s;id=Da.aO;Fd=Da.bm;nd=Da.bn;Yc=Da.a6;Ta=Da.at;sb=Da.ao;dc=Da.aq;ac=Da.bo;Vc=Da.bp;Hd=Da.a1;hc=Da.P;kc=Da._;xb=Da.aV;yb=Da.ah;wc=Da.ai;Kc=
Da.aj;zb=Da.ak;ab=Da.aA;Kb=Da.aY;nc=Da.aw;da=Da.an;qa=Da.a9;Va=Da.bq;cb=Da.L;kb=Da.br;Ma=Da.b1;Oa=Da.bg;lb=Da.b0;Wb=Da.bs;Nb=Da.as},function(Da){rc=Da.M;xc=Da.I;I=Da.v;T=Da.p},function(Da){ua=Da.localInterface}],execute:function(){function Da(wa,La){if(!0===La)return La;if(wa.copyState)return wa.copyState(La);wa={};for(var pb in La){var S=La[pb];S instanceof Array&&(S=S.concat([]));wa[pb]=S}return wa}function Lb(wa,La,pb){return wa.startState?wa.startState(La,pb):!0}function ub(wa,La){return H.modes[wa]=
La}function Ja(wa){if("string"==typeof wa&&H.mimeModes.hasOwnProperty(wa))wa=H.mimeModes[wa];else if(wa&&"string"==typeof wa.name&&H.mimeModes.hasOwnProperty(wa.name)){var La=H.mimeModes[wa.name];"string"==typeof La&&(La={name:La});wa=Object.assign({},La,wa);wa.name=La.name}else{if("string"==typeof wa&&/^[\w\-]+\/[\w\-]+\+xml$/.test(wa))return Ja("application/xml");if("string"==typeof wa&&/^[\w\-]+\/[\w\-]+\+json$/.test(wa))return Ja("application/json")}return"string"==typeof wa?{name:wa}:wa||{name:"null"}}
function Rb(wa,La){La=H.resolveMode(La);"string"===typeof La&&(La={name:La});if(!La.name)throw Error("parserConfig does not have a name of the mode to get");var pb=H.modes[La.name];if(!pb)return Rb(wa,"text/plain");wa=Object.assign({indentUnit:2},wa);return Object.assign(pb(wa,La),{name:La.name})}function Mc(wa,La){for(var pb;wa.innerMode;){pb=wa.innerMode(La);if(!pb||pb.mode==wa)break;La=pb.state;wa=pb.mode}return pb||{mode:wa,state:La}}function Rc(wa,La){H.mimeModes[wa]=La}function yc(wa,La,pb){}
function Ga(wa,La,pb,S,xa,Xa,gb){var oc=wa.editorPlugin._tokenizerValidBefore;oc&&oc.row>=pb&&(oc.row=pb-1);var cc=H.linesToTokenize(wa.document,pb,S,oc);oc=cc.lines;cc=cc.state;if(!oc.length)return!1;cc=cc?H.copyState(La,cc):H.startState(La);for(var $c=0;$c<oc.length;$c++){var Uc=oc[$c],Wc=Uc.row;Wc>=pb&&Wc<=S&&H.indentLine(wa,La,Uc,cc,xa,Xa,gb);cc=H.tokenizeLine(La,oc[$c],cc,function(){})}return!0}function qc(wa,La,pb,S,xa,Xa,gb){La=H.linesToTokenize(La,pb,S,xa);pb=La.lines;H.tokenizeLines(wa,pb,
La.state,Xa,gb);return pb}function Za(wa,La,pb,S,xa){var Xa=[],gb,oc=function(Uc){return Xa.push(gb=[])},cc=function(Uc,Wc,Yd,oe,tf,Dg,Ah){return gb.push(Yd,oe,Uc,tf.current(),Wc.localMode||Ah)};try{var $c=H.visitDocumentTokens(wa,La,pb,S,xa,oc,cc)}catch(Uc){Xa.length=0,$c=H.visitDocumentTokens(wa,La,pb,S,null,oc,cc)}return{tokens:Xa,lines:$c}}function Pa(wa,La,pb,S,xa){null==La&&(La=wa.search(/[^\s\u00a0]/),-1==La&&(La=wa.length));S=S||0;for(xa=xa||0;;){var Xa=wa.indexOf("\t",S);if(0>Xa||Xa>=La)return xa+
(La-S);xa+=Xa-S;xa+=pb-xa%pb;S=Xa+1}}function Qa(wa){wa=wa.toLowerCase();for(var La=0;La<H.modeInfo.length;La++){var pb=H.modeInfo[La];if(pb.mime==wa)return pb;if(pb.mimes)for(var S=0;S<pb.mimes.length;S++)if(pb.mimes[S]==wa)return pb}if(/\+xml$/.test(wa))return Qa("application/xml");if(/\+json$/.test(wa))return Qa("application/json")}function Hb(wa){for(var La=0;La<H.modeInfo.length;La++){var pb=H.modeInfo[La];if(pb.ext)for(var S=0;S<pb.ext.length;S++)if(pb.ext[S]==wa)return pb}}function Gb(wa){for(var La=
0;La<H.modeInfo.length;La++){var pb=H.modeInfo[La];if(pb.file&&pb.file.test(wa))return pb}La=wa.lastIndexOf(".");if(wa=-1<La&&wa.substring(La+1,wa.length))return H.findModeByExtension(wa)}function ad(wa){wa=wa.toLowerCase();for(var La=0;La<H.modeInfo.length;La++){var pb=H.modeInfo[La];if(pb.name.toLowerCase()==wa)return pb;if(pb.alias)for(var S=0;S<pb.alias.length;S++)if(pb.alias[S].toLowerCase()==wa)return pb}}function Td(wa){if(!wa)return String(wa);if(Array.isArray(wa))return"["+wa.map(Td).join(",")+
"]";if("symbol"===typeof wa)return td.printSymbol(wa);try{return String(wa)}catch(La){return"Cannot print object: "+La}}function Zd(wa,La){return!td.arr.every(La.map(function(pb){return wa[pb]}),function(pb){return td.obj.equals(pb,wa&&wa.valueOf())})}function Ue(wa){if(td.obj.isPrimitive(wa))var La=td.string.print(wa);else Array.isArray(wa)?((La=3<wa.length)&&(wa=wa.slice(0,3)),wa=td.string.print(wa),La&&(wa=wa.slice(0,-1)+", ...]"),La=wa):La=td.string.print(wa);La=La.replace(/\n/g,"");500<La.length&&
(La=La.slice(0,20)+("...["+(La.length-20)+' CHARS]"'));return La}function Fc(wa){return zc.Inspector.openInWindow({targetObject:wa})}function Md(wa,La){return zc.Inspector.openInWindow({remoteTarget:{code:wa,evalEnvironment:La}})}function fd(wa,La){function pb(oc){var cc=oc.name,$c=oc.ownerChain(),Uc=oc.owner,Wc=oc.world(),Yd;oc===Xa&&(Yd=[gb]);Wc===oc&&(Yd=["$world"]);if(!Yd&&cc&&Uc){Uc===Wc&&1===zc.arr.count(zc.arr.pluck(Wc.submorphs,"name"),cc)&&(Yd=['$world.get("'+cc+'")']);if(!Yd&&Uc!=Wc)for(Wc=
$c.length-1;Wc--;)if(1===$c[Wc].getAllNamed(cc).length){Yd=[].concat($jscomp.arrayFromIterable(pb($c[Wc])),['get("'+cc+'")']);break}Yd||(cc=[].concat($jscomp.arrayFromIterable(pb(Uc)),['get("'+cc+'")']),zc.syncEval(cc.join("."),{context:Xa}).value===oc&&(Yd=cc))}Yd||(Yd=[gb+'.getMorphById("'+oc.id+'")']);return Yd}La=void 0===La?{}:La;var S=wa.world(),xa=La;La=void 0===xa.maxLength?10:xa.maxLength;var Xa=void 0===xa.fromMorph?S:xa.fromMorph;if(Xa===wa)return"this";var gb=S===Xa?"$world":"this";if(!(S||
wa.name&&Xa.get(wa.name)===wa))return"morph";S=pb(wa);return S.length>La?'$world.getMorphWithId("'+wa.id+'")':S.join(".")}function Ib(wa,La,pb){var S=(La=void 0===La?"":La)&&Ce.arr.last(La.split(".")).toLowerCase(),xa="",Xa=0,gb=Math.pow(2,19);if("string"===typeof wa){if(wa.length>gb)return null}else if(wa.document.stringSize>gb)return null;if("string"===typeof wa)xa=wa.slice(0,1E3);else for(wa=$jscomp.makeIterator(wa.document.lines),gb=wa.next();!gb.done;gb=wa.next()){var oc=gb.value;gb=oc.stringSize;
oc=oc.text;var cc=!0;1E3<Xa+gb&&(cc=!1,gb=1E3-Xa);xa+=oc.slice(0,gb)+(cc?"\n":"");Xa+=gb;if(1E3<=Xa)break}Xa=$jscomp.makeIterator(Ce.modeInfo);for(wa=Xa.next();!wa.done;wa=Xa.next()){cc=wa.value;gb=cc.contentTest;wa=cc.mode;oc=cc.ext;cc=cc.file;if("function"===typeof gb)try{if(gb(xa))return wa}catch($c){}if(cc&&cc instanceof RegExp&&cc.test(La))return wa;if(oc)for(gb=$jscomp.makeIterator(oc),oc=gb.next();!oc.done;oc=gb.next())if(oc.value===S)return wa}return pb}ta({a:Rc,d:ub,r:yc});var fa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");
fa.Color=nb;var ma=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),pb=La.hasOwnProperty("DefaultTheme")&&"function"===typeof La.DefaultTheme?La.DefaultTheme:La.DefaultTheme=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:"background",get:function(){return fa.Color.white}},{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",
fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},
{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},
{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},
{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},
{key:"diff-file-header",get:function(){return{fontColor:fa.Color.white,fontWeight:"bold",backgroundColor:fa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:fa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:fa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],
[{key:"className",get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],La,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2867})}(void 0),tb=ma=fa.DefaultTheme;fa.default=ma;var H=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");
H.copyState=Da;H.startState=Lb;H.defineMode=ub;H.resolveMode=Ja;H.getMode=Rb;H.innerMode=Mc;H.defineMIME=Rc;H.registerHelper=yc;H.indentLines=Ga;H.indentLine=function(wa,La,pb,S,xa,Xa,gb){gb=Object.assign({indentWithTabs:!wa.useSoftTabs,indentUnit:wa.tabWidth,tabSize:4,ignoreFollowingText:!1},gb);null==xa&&(xa="add");"smart"==xa&&(La.indent||(xa="prev"));var oc=gb.tabSize,cc=pb.text,$c=H.countColumn(cc,null,oc);pb.modeState&&(pb.modeState=null);var Uc=cc.match(/^\s*/)[0];if(!Xa&&!/\S/.test(cc)){var Wc=
0;xa="not"}else if("smart"==xa&&(Wc=La.indent(S,gb.ignoreFollowingText?"":cc.slice(Uc.length),cc),Wc==H.passIndent||150<Wc)){if(!Xa)return;xa="prev"}"prev"==xa?Wc=0<pb.row?H.countColumn(pb.prevLine().text,null,oc):0:"add"==xa?Wc=$c+gb.indentUnit:"subtract"==xa?Wc=$c-gb.indentUnit:"number"==typeof xa&&(Wc=$c+xa);Wc=Math.max(0,Wc);La="";S=0;if(gb.indentWithTabs)for(gb=Math.floor(Wc/oc);gb;--gb)S+=oc,La+="\t";S<Wc&&(La+=" ".repeat(Wc-S));if(La!=Uc)return wa.replace({start:{row:pb.row,column:0},end:{row:pb.row,
column:Uc.length}},La),!0};H.tokenizeLines=function(wa,La,pb,S,xa){if(La.length){pb=pb?H.copyState(wa,pb):H.startState(wa);for(var Xa=0;Xa<La.length;Xa++){var gb=La[Xa];S(gb);pb=H.tokenizeLine(wa,gb,pb,xa)}}};H.tokenizeLine=function(wa,La,pb,S){var xa=La.text;if(!xa)return pb;var Xa=new H.StringStream(xa,2);pb=La.modeState="function"===typeof wa.copyState?wa.copyState(pb):H.copyState(wa,pb);La.prevLine();for(pb._string=xa;!Xa.eol();)xa=wa.token(Xa,pb),S(xa,pb,Xa.start,Xa.pos,Xa,La,wa),Xa.start=Xa.pos;
return pb};H.printTokens=function(wa){for(var La="",pb=0;pb<wa.length;pb+=5)La+=wa[pb+0]+" => "+wa[pb+1]+" "+wa[pb+2]+" "+wa[pb+3]+" "+wa[pb+4].name+"\n";return La};H.visitDocumentTokens=qc;H.tokenizeDocument=Za;H.linesToTokenize=function(wa,La,pb,S){if(S&&S.row>=pb)return{lines:[],state:null};La=S?Math.max(0,S.row-1):La;var xa=wa.getLine(La),Xa=xa.text;wa=[xa];S=null;for(var gb=0,oc;(oc=xa.prevLine())&&50>gb++;){xa=oc;if(xa.modeState){S=xa.modeState;break}wa.unshift(xa)}if(!S){for(var cc=xa,$c=Infinity;(oc=
xa.prevLine())&&100>gb++;){xa=oc;if(xa.modeState){S=xa.modeState;break}wa.unshift(xa);oc=Xa.match(/^\s*/)[0].length;if(0===oc)break;oc<$c&&($c=oc,cc=xa)}!S&&0<$c&&(wa=wa.slice(wa.indexOf(cc)))}if(pb>La)for(xa=H.arr.last(wa);La<=pb;La++){xa=xa.nextLine();if(!xa)break;wa.push(xa)}return{lines:wa,state:S}};H.countColumn=Pa;H.findModeByMIME=Qa;H.findModeByExtension=Hb;H.findModeByFileName=Gb;H.findModeByName=ad;H.arr=Vb;ma=H.modes||{};H.modes=ma;H.modes=ma;H.modes=ma;ma=ta("p",{});H.passIndent=ma;H.passIndent=
ma;H.passIndent=ma;H.copyState=Da;H.copyState=Da;H.startState=Lb;H.startState=Lb;H.defineMode=ub;H.defineMode=ub;H.resolveMode=Ja;H.resolveMode=Ja;H.getMode=Rb;H.getMode=Rb;H.innerMode=Mc;H.innerMode=Mc;ma={};H.mimeModes=ma;H.mimeModes=ma;H.mimeModes=ma;H.defineMIME=Rc;H.defineMIME=Rc;H.registerHelper=yc;H.registerHelper=yc;H.indentLines=Ga;H.indentLines=Ga;H.visitDocumentTokens=qc;H.visitDocumentTokens=qc;H.tokenizeDocument=Za;H.tokenizeDocument=Za;H.countColumn=Pa;H.countColumn=Pa;(function(wa){var La=
lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),pb=La.hasOwnProperty("StringStream")&&"function"===typeof La.StringStream?La.StringStream:La.StringStream=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(S,xa){this.reset(S,xa)}},{key:"reset",value:function(S,xa){this.pos=this.start=0;this.string=void 0===S?"":S;this.tabSize=void 0===
xa?2:xa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(S){var xa=this.string.charAt(this.pos);if("string"==typeof S?xa==S:xa&&(S.test?S.test(xa):S(xa)))return++this.pos,
xa}},{key:"eatWhile",value:function(S){for(var xa=this.pos;this.eat(S););return this.pos>xa}},{key:"eatSpace",value:function(){for(var S=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>S}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(S){S=this.string.indexOf(S,this.pos);if(-1<S)return this.pos=S,!0}},{key:"backUp",value:function(S){this.pos-=S}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=
H.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?H.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return H.countColumn(this.string,null,this.tabSize)-(this.lineStart?H.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(S,xa,Xa){if("string"==typeof S){var gb=function(cc){return Xa?cc.toLowerCase():cc},
oc=this.string.substr(this.pos,S.length);if(gb(oc)==gb(S))return!1!==xa&&(this.pos+=S.length),!0}else{if((S=this.string.slice(this.pos).match(S))&&0<S.index)return null;S&&!1!==xa&&(this.pos+=S[0].length);return S}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(S,xa){this.lineStart+=S;try{return xa()}finally{this.lineStart-=S}}}],[{key:"className",get:function(){return"StringStream"}}],La,{pathInPackage:function(){return"editor-modes.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);ma=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",
mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj",
"cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",
mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff",
"patch"],contentTest:function(wa){return wa.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},
{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth",
"fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy",
"gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",
ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],
mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",
mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",
mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",
mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},
{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",
mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",
mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash",
"sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(wa){return wa.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},
{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",
mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",
mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",
mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml",
"text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",
mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];H.modeInfo=ma;H.modeInfo=ma;H.modeInfo=ma;for(var ka=0;ka<H.modeInfo.length;ka++)H.info=H.modeInfo[ka],H.info.mimes&&(H.info.mime=H.info.mimes[0]);H.defineMode("null",function(){return{token:function(wa){return wa.skipToEnd()}}});H.defineMIME("text/plain","null");H.findModeByMIME=Qa;H.findModeByMIME=Qa;H.findModeByExtension=Hb;H.findModeByExtension=Hb;H.findModeByFileName=Gb;H.findModeByFileName=Gb;H.findModeByName=ad;H.findModeByName=ad;var Ca=
lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Ca.Color=nb;Ca.Rectangle=Qb;Ca.pt=Dd;Ca.morph=Ic;Ca.ShadowObject=ud;Ca.StyleSheet=Nc;Ca.connect=Jc;Ca.arr=Vb;Ca.string=Xc;Ca.FilterableList=id;Ca.Range=Fd;ka=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),pb=La.hasOwnProperty("Completer")&&"function"===typeof La.Completer?La.Completer:La.Completer=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Bb(pb,wa,[{key:"compute",value:function(){return[]}}],[{key:"className",get:function(){return"Completer"}}],La,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:345,end:391})}(void 0);Ca.Completer=ka;Ca.Completer=ka;Ca.Completer=ka;ka=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
pb=La.hasOwnProperty("WordCompleter")&&"function"===typeof La.WordCompleter?La.WordCompleter:La.WordCompleter=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:"compute",value:function(S,xa){var Xa=[],gb=[],oc=S.document.lineStrings;S=S.cursorPosition.row;for(var cc=S-1;0<=cc;cc--)for(var $c=$jscomp.makeIterator(oc[cc].split(/[^0-9a-z@_]+/i)),Uc=$c.next();!Uc.done;Uc=$c.next())(Uc=Uc.value)&&!Xa.includes(Uc)&&
Uc!==xa&&(Xa.push(Uc),gb.push({priority:1E3-(S-cc),completion:Uc}));for(cc=S+1;cc<oc.length;cc++)for($c=$jscomp.makeIterator(oc[cc].split(/[^0-9a-z_@]+/i)),Uc=$c.next();!Uc.done;Uc=$c.next())(Uc=Uc.value)&&!Xa.includes(Uc)&&Uc!==xa&&(Xa.push(Uc),gb.push({priority:1E3-(cc-S),completion:Uc}));return gb}}],[{key:"className",get:function(){return"WordCompleter"}}],La,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:400,end:1228})}(void 0);Ca.WordCompleter=ka;Ca.WordCompleter=ka;Ca.WordCompleter=ka;ka=[new Ca.WordCompleter];Ca.defaultCompleters=ka;Ca.defaultCompleters=ka;Ca.defaultCompleters=ka;ka=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),pb=La.hasOwnProperty("CompletionController")&&"function"===typeof La.CompletionController?La.CompletionController:La.CompletionController=function(S){S&&S[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(S,xa){xa=void 0===xa?[]:xa;this.textMorph=S;this.completers=xa=S.pluginCollect("getCompleters",xa)}},{key:"computeCompletions",value:function(S){var xa=this,Xa,gb,oc,cc,$c,Uc,Wc,Yd,oe,tf,Dg,Ah,Mg,ri,Eg,Cj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Te){switch(Te.nextAddress){case 1:Xa=[],gb=$jscomp.makeIterator(xa.completers),oc=gb.next();
case 2:if(oc.done){Te.jumpTo(4);break}cc=oc.value;Te.setCatchFinallyBlocks(5);$c=Xa;Uc=$c.concat;return Te.yield(cc.compute(xa.textMorph,S),7);case 7:Xa=Uc.call($c,Te.yieldResult);Te.leaveTryBlock(3);break;case 5:Wc=Te.enterCatchBlock(),console.warn("Error in completer "+cc+": "+(Wc.stack||Wc));case 3:oc=gb.next();Te.jumpTo(2);break;case 4:Yd=new Map;Xa.forEach(function(xi){var dh=Yd.get(xi.completion);dh||(dh=[],Yd.set(xi.completion,dh));dh.push(xi)});oe=[];tf=$jscomp.makeIterator(Yd.values());for(Dg=
tf.next();!Dg.done;Dg=tf.next())Ah=Dg.value,oe.push(Ca.arr.last(Ca.arr.sortByKey(Ah,"priority")));Mg=0;ri=Ca.arr.sortByKey(oe,"priority").reverse();Eg=ri.length&&ri[0].priority||0;Cj=ri.map(function(xi){xi.highestPriority=Eg;var dh=xi.completion.replace(/\n/g,""),$d=String((xi.info||"").replace(/\n/g,""));Mg=Math.max(Mg,dh.length+$d.length);return{isListItem:!0,string:dh,annotation:$d,value:xi}});return Te.return({items:Cj,maxCol:Mg})}})}},{key:"computeSortedCompletions",value:function(S,xa){xa=void 0===
xa?!1:xa;var Xa=this,gb,oc,cc;return $jscomp.asyncExecutePromiseGeneratorProgram(function($c){if(1==$c.nextAddress)return gb={tokens:[S],lowercasedTokens:[S],input:S},$c.yield(Xa.computeCompletions(S),2);oc=$c.yieldResult;cc=Ca.arr.sortBy(oc.items.filter(function(Uc){return Xa.filterFunction(gb,Uc,xa)}),function(Uc){return Xa.sortFunction(gb,Uc)});return $c.return(cc)})}},{key:"_printCompletions",value:function(S){var xa=this,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==
gb.nextAddress)return gb.yield(xa.computeSortedCompletions(S),2);Xa=gb.yieldResult.map(function(oc){return{completion:oc.value.completion,priority:oc.value.priority,maxP:oc.value.highestPriority,sortVal:oc._cache[S].sortVal,lev:JSON.stringify(oc._cache[S].levenshtein)}});return gb.return(Ca.string.printTable(lively.lang.grid.tableFromObjects(Xa)))})}},{key:"prefix",value:function(){var S=this.textMorph,xa=S.selection;return(xa.isEmpty()?S.getLine(xa.lead.row).slice(0,xa.lead.column):xa.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(S,xa,Xa){Xa=void 0===Xa?!1:Xa;xa._cache||(xa._cache={});var gb=S.tokens,oc=S.lowercasedTokens,cc=S.input;cc=xa._cache[cc]||(xa._cache[cc]={});if(cc.hasOwnProperty("filtered"))return cc.filtered;xa=xa.value.completion.replace(/\([^\)]*\)$/,"");var $c=xa.toLowerCase();if(Xa&&gb[0]&&!xa.startsWith(gb[0]))return cc.filtered=!1;if(oc.every(function(Wc){return $c.includes(Wc)}))return!0;var Uc=cc.levenshtein||(cc.levenshtein={});S=Xa||3>=Ca.arr.sum(S.lowercasedTokens.map(function(Wc){return Uc[Wc]||
(Uc[Wc]=Ca.string.levenshtein($c,Wc))}));return cc.filtered=S}},{key:"sortFunction",value:function(S,xa){xa._cache||(xa._cache={});var Xa=xa._cache[S.input]||(xa._cache[S.input]={});if(Xa.hasOwnProperty("sortVal"))return Xa.sortVal;Xa=xa._cache[S.input]={};var gb=xa.value;xa=gb.highestPriority;var oc=gb.completion;gb=gb.priority;oc=oc.replace(/\([^\)]*\)$/,"").toLowerCase();var cc=0;S.lowercasedTokens.forEach(function(Uc){oc.startsWith(Uc)?cc+=12:3<=Uc.length&&oc.includes(Uc)&&(cc+=5)});xa=-((gb||
(cc?xa:0))/Math.pow(10,String(xa).length-2))-cc;var $c=Xa.levenshtein||(Xa.levenshtein={});S=Ca.arr.sum(S.lowercasedTokens.map(function(Uc){return $c[Uc]||($c[Uc]=Ca.string.levenshtein(oc,Uc))}));cc&&(S/=2);return Xa.sortVal=S+xa}},{key:"positionForMenu",value:function(){var S=this.textMorph,xa=S.charBoundsFromTextPosition(S.cursorPosition);return S.getGlobalTransform().transformRectToRect(xa).topLeft().addXY(-S.scroll.x,-S.scroll.y).addPt(Ca.pt(S.borderWidth+3,S.borderWidth+3))}},{key:"completionListSpec",
value:function(){var S=this,xa,Xa,gb,oc,cc,$c,Uc,Wc,Yd,oe,tf,Dg,Ah,Mg,ri,Eg,Cj,Te,xi,dh;return $jscomp.asyncExecutePromiseGeneratorProgram(function($d){if(1==$d.nextAddress)return Xa=xa=S.textMorph,gb=Xa.fontSize,oc=Xa.fontFamily,cc=S.positionForMenu(),$c=S.prefix(),$d.yield(S.computeCompletions($c),2);Uc=$d.yieldResult;Wc=Uc.items;Yd=Uc.maxCol;oe=xa.env.fontMetric.sizeFor(oc,gb,"M");tf=oe.width*Yd;Dg=xa.document.getLine(0).height;Ah=Math.max(120,tf<xa.width?tf:xa.width);Mg=Dg*Wc.length+Dg+10;ri=
Math.max(70,Math.min(700,Mg));Eg=cc.extent(Ca.pt(Ah,ri));if(Cj=xa.world())Te=Cj.visibleBounds().insetBy(5),Eg.bottom()>Te.bottom()&&(xi=Eg.bottom()-Te.bottom(),xi>Eg.height-50&&(xi=Eg.height-50),Eg.height-=xi),Eg.right()>Te.right()&&(dh=Eg.right()-Te.right(),Eg.width=120>Eg.width-dh?120:Eg.width-dh),Te.containsRect(Eg)||(Eg=Eg.withTopLeft(Te.translateForInclusion(Eg).topLeft())),Eg=Eg.translatedBy(Te.insetBy(0).topLeft().negated());return $d.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:gb,position:Eg.topLeft(),extent:Eg.extent(),items:Wc,input:$c,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:S.filterFunction,sortFunction:S.sortFunction})})}},{key:"removeMenuOnBlur",value:function(S){var xa=S.menu;setTimeout(function(){xa.withAllSubmorphsDetect(function(Xa){return Xa.isFocused()})?xa.inputMorph.focus():xa.remove()})}},{key:"openCompletionList",value:function(){var S=this,xa,Xa,gb,oc,cc,$c,Uc,Wc,Yd,oe;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(tf){if(1==tf.nextAddress)return xa=S.textMorph.selection.start,tf.yield(S.completionListSpec(),2);Xa=tf.yieldResult;S.textMorph.pluginFind(function(Dg){return Dg.theme});gb=new Ca.FilterableList(Xa);oc=new Ca.Range({start:xa,end:S.textMorph.selection.start});cc=S.textMorph.textInRange(oc);$c=gb.inputMorph;Uc=gb.listMorph;Wc=Xa.input;Yd=gb.addMorph({name:"prefix mask",fill:Ca.Color.transparent,bounds:$c.textBounds()},$c);Uc.master=null;oc.isEmpty()||
(S.textMorph.deleteText(oc),$c.input=cc,$c.gotoDocumentEnd());$c.fontColor=S.textMorph.fontColor;Ca.connect($c,"textString",Yd,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:$c}});Ca.connect(gb,"accepted",S,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Wc}});Ca.connect(gb,"accepted",gb,"remove");Ca.connect(gb,"canceled",gb,"remove");Ca.connect(gb,"remove",S.textMorph,"focus");Ca.connect(gb.inputMorph,"onBlur",S,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:gb}});oe=S.textMorph.world();oe.addMorph(gb);Uc.addStyleClass("hiddenScrollbar");$c.height=Uc.itemHeight;$c.fixedHeight=!0;$c.fontSize=Uc.fontSize;$c.focus();gb.get("padding").height=0;gb.relayout();gb.selectedIndex=0;Wc.length?($c.gotoDocumentEnd(),
gb.moveBy(Ca.pt(-$c.textBounds().width+2,0))):gb.moveBy(Ca.pt(2,0));return tf.return(gb)})}},{key:"autoInsertBestMatchingCompletion",value:function(S,xa,Xa){xa=void 0===xa?!0:xa;var gb=this,oc,cc,$c,Uc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wc){if(1==Wc.nextAddress)return oc=$jscomp,cc=oc.makeIterator,Wc.yield(gb.computeSortedCompletions(S,xa),2);$c=cc.call(oc,Wc.yieldResult);(Uc=$c.next().value)&&gb.insertCompletion(Uc.value.completion,S,Xa);Wc.jumpToEnd()})}},{key:"insertCompletion",
value:function(S,xa,Xa){var gb=this.textMorph,oc=gb.document,cc=gb.selection.isMultiSelection?gb.selection.selections:[gb.selection];gb.undoManager.group();cc.forEach(function($c){$c.collapseToEnd();var Uc=$c.lead,Wc=xa?oc.indexToPosition(oc.positionToIndex(Uc)-xa.length):Uc;"function"===typeof Xa?Xa(S,xa,gb,{start:Wc,end:Uc},$c):gb.replace({start:Wc,end:Uc},S)});gb.undoManager.group()}}],[{key:"className",get:function(){return"CompletionController"}}],La,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1355,end:12497})}(void 0);Ca.CompletionController=ka;Ca.CompletionController=ka;Ca.CompletionController=ka;ka=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(wa,La,pb){var S;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){return 1==xa.nextAddress?
(S=new Ca.CompletionController(wa,Ca.defaultCompleters),xa.yield(S.openCompletionList(),2)):xa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(wa,La,pb){var S;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){return 1==xa.nextAddress?(S=new Ca.CompletionController(wa,Ca.defaultCompleters),xa.yield(S.autoInsertBestMatchingCompletion(S.prefix()),2)):xa.return(!0)})}}];Ca.completionCommands=ka;Ca.completionCommands=ka;Ca.completionCommands=
ka;var rb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");rb.chain=nd;rb.arr=Vb;rb.obj=Yc;rb.string=Xc;var sc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(wa){var La=wa.selection.start;0<La.row&&(La=wa.getPositionAboveOrBelow(1,La,!0,0,wa.charBoundsFromTextPosition(La).x),wa.selection.addRange({start:La,end:La}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(wa){var La=wa.selection.start;
La.row<wa.documentEndPosition.row&&(La=wa.getPositionAboveOrBelow(-1,La,!0,0,wa.charBoundsFromTextPosition(La).x),wa.selection.addRange({start:La,end:La}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(wa){var La=wa.selection.selections[wa.selection.selections.length-1];if(La.isEmpty())return!0;wa.searchForAll(La.text,{start:{column:0,row:0}}).forEach(function(pb){return wa.selection.addRange(pb.range,!1)});wa.selection.mergeSelections();rb.arr.remove(wa.selection.selections,
La);wa.selection.selections.push(La);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(wa){var La=wa.selection.selections.length-1,pb=wa.selection.selections[La];if(pb.isEmpty())return!0;var S=wa.search(pb.text,{start:pb.end,backwards:!1});S&&(pb=wa.selection.selections.findIndex(function(xa){return xa.range.equals(S.range)}),-1<pb?rb.arr.swap(wa.selection.selections,pb,La):wa.selection.addRange(S.range));return!0}},{name:"[multi select] more like this backward",
multiSelectAction:"single",exec:function(wa){var La=wa.selection.selections.length-1,pb=wa.selection.selections[La];if(pb.isEmpty())return!0;var S=pb.start,xa=wa.search(pb.text,{start:{row:S.row,column:S.column-(pb.text.length-1)},backwards:!0});xa&&(pb=wa.selection.selections.findIndex(function(Xa){return Xa.range.equals(xa.range)}),-1<pb?rb.arr.swap(wa.selection.selections,pb,La):wa.selection.addRange(xa.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",
exec:function(wa){var La=wa.selection.selections.length;1<La&&wa.selection.removeSelections(La-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(wa){wa.selection.selections=lively.lang.arr.rotate(wa.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(wa){wa.selection.selections=lively.lang.arr.rotate(wa.selection.selections,1);return!0}},{name:"[multi select] align cursors",
multiSelectAction:"single",exec:function(wa){var La=wa.selection.selections;if(1>=La.length)return!0;var pb=rb.arr.groupBy(La,function(xa){return xa.range.start.row});La=pb.keys().map(function(xa){xa=pb[xa];var Xa=rb.arr.max(xa,function(gb){return gb.range.start.column});rb.arr.without(xa,Xa).forEach(function(gb){return gb.range=Xa.range});return Xa});var S=rb.arr.max(La,function(xa){return xa.range.start.column}).range.start.column;La.forEach(function(xa){var Xa=xa.range.start;xa=Xa.row;Xa=Xa.column;
wa.insertText(" ".repeat(S-Xa),{row:xa,column:Xa})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(wa){wa.selection.disableMultiSelect();if(wa.selection.isEmpty())var La=wa.lastSavedMark&&wa.lastSavedMark.position||(void 0).lineRange().start,pb=wa.cursorPosition;else La=wa.selection,pb=La.lead,La=La.anchor;wa.selection.collapse();var S=La.column,xa=pb.column;rb.arr.range(La.row,pb.row).forEach(function(Xa){return wa.getLine(Xa).length>Math.min(xa,
S)&&wa.selection.addRange({end:{row:Xa,column:xa},start:{row:Xa,column:S}},!1)});wa.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(wa,La,pb){pb=void 0===pb?1:pb;wa.undoManager.group();wa.selection.selections.forEach(function(S,xa){return S.text=String(xa+pb)});wa.undoManager.group();return!0}}];rb.multiSelectCommands=sc;rb.multiSelectCommands=sc;rb.multiSelectCommands=sc;var Ac=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");
Ac.pToI=function(wa,La){return wa.positionToIndex(La)};Ac.iToP=function(wa,La){return wa.indexToPosition(La)};Ac.execCodeNavigator=function(wa){return function(La,pb,S){var xa=La.pluginInvokeFirst("getNavigator");if(!xa)return!0;La.saveMark();S=S||1;for(var Xa=0;Xa<S;Xa++)xa[wa](La,pb);return!0}};Ac.once=Ta;var Bd=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Ac.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",
exec:Ac.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Ac.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Ac.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:Ac.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",
bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(wa,La){function pb(){var Xa=wa.$expandRegionState,gb=Ac.pToI(wa,wa.cursorPosition);if(Xa&&(Xa.range[0]===gb||Xa.range[1]===gb))return Xa;Xa=wa.selection.range;return wa.$expandRegionState={range:[Ac.pToI(wa,Xa.start),Ac.pToI(wa,Xa.end)]}}La=La||{};var S=wa.pluginInvokeFirst("getNavigator");if(!S)return!0;var xa=La.start;La=La.end;if("number"===typeof xa&&"number"===typeof La)pb(),S={range:[xa,La],
prev:pb()};else{xa=S.ensureAST(wa);if(!xa)return;S=S.expandRegion(wa,wa.textString,xa,pb())}S&&S.range&&(wa.selection={start:Ac.iToP(wa,S.range[0]),end:Ac.iToP(wa,S.range[1])},wa.$expandRegionState=S);Ac.once(wa,"selectionChange",function(){return wa.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(wa){if(wa.selection.isEmpty())return!0;var La=
wa.pluginInvokeFirst("getNavigator");if(!La)return!0;var pb=La.ensureAST(wa);if(!pb)return!0;var S=wa.$expandRegionState;if(!S)return!0;(La=La.contractRegion(wa,wa.textString,pb,S))&&La.range&&(wa.selection={start:Ac.iToP(wa,La.range[0]),end:Ac.iToP(wa,La.range[1])},wa.$expandRegionState=La);Ac.once(wa,"selectionChange",function(){return wa.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Ac.commands=Bd;Ac.commands=Bd;Ac.commands=Bd;var kd=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");
kd.arr=Vb;kd.chain=nd;kd.string=Xc;var ue=[{name:"toggle comment",exec:function(wa){var La=wa.pluginInvokeFirst("getComment");if(!La)return!0;if(!La.lineCommentStart)return La.blockCommentStart?wa.execCommand("toggle block comment"):!0;var pb=La.lineCommentStart,S=new RegExp("^(\\s*)("+pb+"\\s?)(.*)");La=wa.document;var xa=wa.selection;xa.isEmpty()||0!==xa.end.column||xa.growRight(-1);var Xa=xa.start.row;La=La.lineStrings.slice(xa.start.row,xa.end.row+1);La=La.some(function(cc){return!!cc.trim()})?
kd.arr.dropWhile(La,function(cc){return cc.trim()?!1:++Xa&&!0}):La;var gb=La.every(function(cc){return cc.trim()&&cc.match(S)});wa.undoManager.group();if(gb)La.forEach(function(cc,$c){if(cc=cc.match(S)){cc=$jscomp.makeIterator(cc);cc.next();var Uc=cc.next().value,Wc=cc.next().value;cc.next();wa.deleteText({start:{row:Xa+$c,column:Uc.length},end:{row:Xa+$c,column:Uc.length+Wc.length}})}});else{var oc=La.reduce(function(cc,$c,Uc){return $c.trim()||xa.isEmpty()&&xa.start.row===xa.end.row?Math.min(cc,
$c.match(/^\s*/)[0].length):cc},Infinity);oc=Infinity===oc?0:oc;La.forEach(function(cc,$c){cc=$jscomp.makeIterator(cc.match(/^(\s*)(.*)/));cc.next();cc.next();cc.next();wa.insertText(pb+" ",{row:Xa+$c,column:oc})})}wa.undoManager.group();return!0}},{name:"toggle block comment",exec:function(wa){var La=wa.pluginInvokeFirst("getComment");if(!La)return!0;if(!La.blockCommentStart)return La.lineCommentStart?wa.execCommand("toggle comment"):!0;if(!La||!La.blockCommentStart)return!0;var pb=La.blockCommentStart;
La=La.blockCommentEnd;var S=new RegExp("^"+pb.replace(/\*/g,"\\*")),xa=new RegExp(La.replace(/\*/g,"\\*")+"$"),Xa=wa.tokenAt(wa.cursorPosition);if(Xa&&"comment"===Xa.token){var gb=wa.textInRange(Xa);if(gb.match(S)&&gb.match(xa))return wa.undoManager.group(),wa.replace(Xa,gb.slice(pb.length,-La.length)),wa.undoManager.group(),!0}wa.undoManager.group();wa.insertText(pb,wa.selection.start);wa.insertText(La,wa.selection.end);wa.undoManager.group();pb=!wa.selection.isEmpty();wa.selection.growLeft(La.length);
pb||wa.selection.collapse();return!0}},{name:"comment box",exec:function(wa,La,pb){La=wa.undoManager.ensureNewGroup(wa,"comment box");if(wa.selection.isEmpty())return wa.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),wa.execCommand("toggle comment"),wa.undoManager.group(La),!0;var S=wa.selection.range,xa=wa.withSelectedLinesDo(function(gb){return gb}),Xa=kd.arr.min([S.start.column].concat(kd.chain(xa).map(function(gb){return gb.match(/^\s*/)}).flatten().compact().pluck("length").value()));
xa=kd.arr.max(xa.map(function(gb){return gb.length}))-Xa;xa=Array(Math.ceil(xa/2)+1).join("-=")+"-";wa.execCommand("toggle comment");wa.collapseSelection();wa.cursorPosition={row:S.start.row,column:0};pb?wa.insertText(kd.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",Xa)):wa.insertText(kd.string.indent(xa+"\n"," ",Xa));wa.selection.goUp();wa.execCommand("toggle comment");wa.cursorPosition={row:S.end.row+2,column:0};wa.insertText(kd.string.indent(xa+"\n"," ",Xa));wa.selection.goUp();
wa.execCommand("toggle comment");wa.selection.range={start:{row:S.start.row,column:0},end:wa.cursorPosition};wa.undoManager.group(La);return!0},multiSelectAction:"forEach",handlesCount:!0}];kd.commands=ue;kd.commands=ue;kd.commands=ue;var td=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");td.printSymbol=function(wa){if(Symbol.keyFor(wa))return'Symbol.for("'+Symbol.keyFor(wa)+'")';if(td.knownSymbols.get(wa))return td.knownSymbols.get(wa);String(wa).match(td.symMatcher);return String(wa)};
td.defaultSort=function(wa,La){if(wa.hasOwnProperty("priority")||La.hasOwnProperty("priority")){var pb=wa.priority||0,S=La.priority||0;if(pb<S)return-1;if(pb>S)return 1}wa=(wa.keyString||wa.key).toLowerCase();La=(La.keyString||La.key).toLowerCase();return wa<La?-1:wa===La?0:1};td.safeToString=Td;td.propertyNamesOf=function(wa,La){if(!wa)return[];if(Array.isArray(wa)){var pb=La?La.offset:0;return td.arr.range(pb,pb+(La?La.partitionSize:wa.length-1))}return td.arr.sortBy(Object.keys(wa),function(S){return S.toLowerCase()})};
td.isMultiValue=Zd;td.printValue=Ue;td.partitionedChildren=function(wa,La){var pb=void 0===La?{}:La;La=void 0===pb.originalValue?wa:pb.originalValue;var S=void 0===pb.offset?0:pb.offset;pb=void 0===pb.partitionSize?wa.length||Object.values(wa).length:pb.partitionSize;if(td.obj.isArray(wa)){wa=td.num.roundTo(Math.max(td.MIN_PARTITION_SIZE,pb/50),.1);pb/=wa;for(var xa=[],Xa=0;Xa<pb;Xa++){var gb="["+(S+Xa*wa)+"-"+(S+(Xa+1)*wa)+"]";xa.push({partition:{originalValue:La,offset:S+Xa*wa,partitionSize:wa},
value:[],key:gb,keyString:gb,valueString:"...",isCollapsed:!0})}return xa}wa=td.num.roundTo(Math.max(td.MIN_PARTITION_SIZE,pb/50),.1);pb/=wa;xa=[];Xa=td.obj.keys(La).sort();for(gb=0;gb<pb;gb++){var oc=S+gb*wa,cc=S+(gb+1)*wa,$c=td.obj.select(La,Xa.slice(oc,cc));oc="["+Xa[oc].slice(0,4)+"-"+(Xa[cc]||td.arr.last(Xa)).slice(0,4)+"]";xa.push({partition:{originalValue:$c,offset:S+gb*wa,partitionSize:wa},value:[],key:oc,keyString:oc,valueString:"...",isCollapsed:!0})}return xa};td.propertiesOf=function(wa){var La=
wa.partition?wa.target:wa.value;if(!La)return[];var pb={_rev:!0},S=[],xa="function"===typeof La.livelyCustomInspect?La.livelyCustomInspect():{},Xa=Object.assign({},td.defaultPropertyOptions,{},xa);if(xa.properties){xa=$jscomp.makeIterator(xa.properties);for(var gb=xa.next();!gb.done;gb=xa.next()){var oc=gb.value;gb=oc.key;var cc=oc.hidden,$c=oc.priority,Uc=oc.keyString,Wc=oc.value;oc=oc.valueString;pb[gb]=!0;cc||S.push(wa.getSubNode({priority:$c,key:gb,keyString:Uc||td.safeToString(gb),value:Wc,valueString:oc,
isCollapsed:!0}))}}if(Xa.includeDefault){xa=td.propertyNamesOf(La,wa.partition);if(xa.length>td.MAX_NODE_THRESHOLD)for(pb=$jscomp.makeIterator(td.partitionedChildren(La,wa.partition)),xa=pb.next();!xa.done;xa=pb.next())S.push(wa.getSubNode(xa.value));else for(cc=$jscomp.makeIterator(xa),xa=cc.next();!xa.done;xa=cc.next())$c=xa.value,$c in pb||(xa=La[$c],gb=td.printValue(xa),xa={keyString:$c,key:$c,value:xa,valueString:gb,isCollapsed:!0},S.push(wa.getSubNode(xa)));if(Xa.includeSymbols)for(pb=$jscomp.makeIterator(Object.getOwnPropertySymbols(La)),
xa=pb.next();!xa.done;xa=pb.next())cc=xa.value,$c=td.safeToString(cc),xa=La[cc],gb=td.printValue(xa),xa={key:cc,keyString:$c,value:xa,valueString:gb,isCollapsed:!0},S.push(wa.getSubNode(xa))}Xa.sort&&(S=Xa.sortFunction(La,S));return S};td.obj=Yc;td.num=sb;td.arr=Vb;td.string=Xc;td.connect=Jc;td.signal=dc;td.TreeData=ac;td.newUUID=Vc;td.localInterface=ua;td.MAX_NODE_THRESHOLD=1E3;td.MIN_PARTITION_SIZE=250;td.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(wa,
La){return Array.isArray(wa)?La:La.sort(td.defaultSort)}};td.symMatcher=/^Symbol\((.*)\)$/;td.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(wa){return"symbol"===typeof Symbol[wa]}).reduce(function(wa,La){return wa.set(Symbol[La],"Symbol."+La)},new Map)}();td.isMultiValue=Zd;td.isMultiValue=Zd;td.printValue=Ue;td.printValue=Ue;var Nd=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=La.hasOwnProperty("InspectionTree")&&
"function"===typeof La.InspectionTree?La.InspectionTree:La.InspectionTree=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(S){Bb._get(Object.getPrototypeOf(pb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,S);this.inspector=S.inspector;this.root.isInspectionNode||(this.root=td.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",
get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(S){S=void 0===S?!0:S;return Bb._get(Object.getPrototypeOf(pb.prototype),"asListWithIndexAndDepth",this).call(this,function(xa){xa=xa.node;return S?xa.visible:!0})}},{key:"getContextFor",value:function(S){return S==this.root?this.root.value.inspectee:S.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(S){var xa=void 0===S.maxDepth?1:S.maxDepth,Xa=S.iterator,gb=S.showUnknown,oc=S.showInternal,cc=this;
return $jscomp.asyncExecutePromiseGeneratorProgram(function($c){if(1==$c.nextAddress)return $c.yield(cc.uncollapseAll(function(Uc,Wc){return xa>Wc&&(Uc==cc.root||Uc.value.submorphs)}),2);cc.asListWithIndexAndDepth(!1).forEach(function(Uc){var Wc=Uc.node;return 0==Uc.depth?Wc.visible=!0:!gb&&Wc.keyString&&Wc.keyString.includes("UNKNOWN PROPERTY")||!oc&&Wc.keyString&&Wc.keyString.includes("internal")?Wc.visible=!1:Wc.value&&Wc.value.submorphs?Wc.visible=!0:Wc.visible=Xa(Wc)});$c.jumpToEnd()})}},{key:"getChildren",
value:function(S){return S.children}},{key:"display",value:function(S){return S.display(this.inspector)}},{key:"isCollapsed",value:function(S){return S.isCollapsed}},{key:"isLeaf",value:function(S){return td.obj.isPrimitive(S.value)}},{key:"collapse",value:function(S,xa){var Xa=this;S.isCollapsed=xa;xa||this.isLeaf(S)||S.children.length||(S.children=td.propertiesOf(S).map(function(gb){Xa.parentMap.set(gb,S);return gb}))}},{key:"retrieveForRemoteProxy",value:function(S){S.uuid||(S.uuid=td.newUUID(),
this.idToNodeMap[S.uuid]=S);return{uuid:S.uuid,value:this.isLeaf(S)?S.value:{},keyString:S.keyString,key:S.keyString,valueString:td.safeToString(S.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return td.localInterface}},{key:"getNodeViaId",value:function(S){return this.idToNodeMap[S]}},{key:"asRemoteDelegate",value:function(S){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext=
{});System.get("@lively-env").remoteInspectionContext[S]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:"className",get:function(){return"InspectionTree"}},{key:"forObject",value:function(S,xa){return new this({key:"inspectee",value:{inspectee:S},isCollapsed:!0,inspector:xa})}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:5932,end:8631})}(td.TreeData);td.InspectionTree=Nd;td.InspectionTree=Nd;td.InspectionTree=Nd;var Ve=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=La.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof La.RemoteInspectionTree?La.RemoteInspectionTree:La.RemoteInspectionTree=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:"systemInterface",
get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(S){this.parentMap=new WeakMap;this.root=S.proxy;this.evalEnvironment=S.evalEnvironment;this.inspector=S.inspector;this.delegateId=S.delegateId}},{key:"getContextFor",value:function(S){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+S.uuid+'").value'}},{key:"dispose",value:function(){var S=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){return xa.yield(S.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
S.delegateId+"']\n    ",S.evalEnvironment),0)})}},{key:"display",value:function(S){return S.keyString+": "+S.valueString}},{key:"collapse",value:function(S,xa){var Xa=this,gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(oc){if(1==oc.nextAddress)return(S.isCollapsed=xa)||Xa.isLeaf(S)?oc.return():S.children.length?oc.jumpTo(0):oc.yield(Xa.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+S.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Xa.delegateId+'"]'}),3);gb=oc.yieldResult;S.children=gb.isError?[]:gb.value;oc.jumpToEnd()})}}],[{key:"className",get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(S,xa){var Xa=this,gb,oc,cc,$c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==Uc.nextAddress)return Uc.yield(Xa.createRemoteContext(S,xa),2);gb=Uc.yieldResult;oc=gb.proxy;cc=
gb.delegateId;$c=gb.evalEnvironment;return Uc.return(new Xa({key:"inspectee",proxy:oc,delegateId:cc,evalEnvironment:$c,inspector:xa}))})}},{key:"createRemoteContext",value:function(S,xa){var Xa=S.code,gb=S.evalEnvironment,oc=S.delegateId,cc,$c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==Uc.nextAddress)return oc="lively://inspector-"+xa.id,Uc.yield(gb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Xa+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+oc+'");\n    ',gb),2);cc=Uc.yieldResult;$c=cc.value;return Uc.return({delegateId:oc,evalEnvironment:gb,proxy:$c})})}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8640,end:10983})}(td.InspectionTree);
td.RemoteInspectionTree=Ve;td.RemoteInspectionTree=Ve;td.RemoteInspectionTree=Ve;(function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=La.hasOwnProperty("InspectionNode")&&"function"===typeof La.InspectionNode?La.InspectionNode:La.InspectionNode=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(S){var xa=
S.root,Xa=S.priority,gb=S.key,oc=S.keyString,cc=S.value,$c=S.valueString,Uc=S.isCollapsed,Wc=void 0===S.children?[]:S.children,Yd=void 0===S.isSelected?!1:S.isSelected,oe=void 0===S.visible?!0:S.visible;this.partition=S.partition;this.priority=Xa;this.key=gb;this.keyString=String(oc||gb);this.value=cc;this.valueString=$c||td.printValue(cc);this.isCollapsed=Uc;this.children=Wc;this.isSelected=Yd;this.visible=oe;this.root=xa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(S){if(S.value&&S.value.isMorph)return new td.MorphNode(Object.assign({root:this.root},S));var xa=S.key,Xa=S.keyString,gb=this.value,oc=S.partition;oc&&(gb=oc.originalValue,Xa=xa);return new td.PropertyNode(Object.assign({},S,{keyString:Xa,key:xa,target:gb,partition:oc,root:this.root,spec:{}}))}},{key:"display",value:function(S){var xa=this.keyString,Xa=this.valueString;if(!this.interactive)return xa+": "+Xa;this._propertyWidget||(this._propertyWidget=
S.renderDraggableTreeLabel({value:xa+": "+Xa}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:"className",get:function(){return"InspectionNode"}},{key:"for",value:function(S,xa){xa=void 0===xa?null:xa;return S.value&&S.value.isMorph?new td.MorphNode(Object.assign({root:xa},S)):new td.InspectionNode(Object.assign({root:xa},S))}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10985,end:13522})})(void 0);(function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=La.hasOwnProperty("MorphNode")&&"function"===typeof La.MorphNode?La.MorphNode:La.MorphNode=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:Symbol.for("lively-instance-initialize"),
value:function(S){Bb._get(Object.getPrototypeOf(pb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,S);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(S){var xa=this.propertyInfo[S.key]||{};return S.value&&S.value.isMorph?new td.MorphNode(Object.assign({},S,{root:this.root})):new td.PropertyNode(Object.assign({},S,{root:this.root,target:this.target,spec:xa}))}}],[{key:"className",get:function(){return"MorphNode"}}],
La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13524,end:14670})})(td.InspectionNode);(function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=La.hasOwnProperty("PropertyNode")&&"function"===typeof La.PropertyNode?La.PropertyNode:La.PropertyNode=
function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(S){Bb._get(Object.getPrototypeOf(pb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,S);var xa=S.spec,Xa=S.target;this.partition=S.partition;this.target=Xa;this.spec=xa;this.foldedNodes={}}},{key:"__deserialize__",value:function(S,xa){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},
{key:"interactive",set:function(S){this._interactive=S}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(S){return this.isFoldable?this.getFoldedContext(S):Bb._get(Object.getPrototypeOf(pb.prototype),"getSubNode",this).call(this,S)}},{key:"getFoldedContext",value:function(S){return this.foldedNodes[S.key]=new td.FoldedNode(Object.assign({},S,{root:this.root,
target:this.target,foldableNode:this,spec:td.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(S,xa){(xa=void 0===xa?!1:xa)&&(this.target[this.key]=S);this.value=this.target[this.key];this.valueString=td.printValue(this.value);this.interactive&&(xa||this._propertyWidget.highlight());if(this.isFoldable)for(var Xa in this.foldedNodes)this.foldedNodes[Xa].value=this.value[Xa],this.foldedNodes[Xa].valueString=
td.printValue(this.value[Xa]),this.foldedNodes[Xa]._propertyWidget&&td.signal(this.foldedNodes[Xa]._propertyWidget,"update",this.value[Xa])}},{key:"display",value:function(S){var xa=this,Xa=this._propertyWidget,gb=this.keyString,oc=this.valueString,cc=this.target,$c=this.value,Uc=this.spec;if(!(this.interactive||Uc.foldable&&td.isMultiValue($c,Uc.foldable)))return S.renderPropertyControl({target:cc,keyString:gb,valueString:oc,tree:S.ui.propertyTree,value:$c,spec:Uc,node:this,fastRender:!0});if(Xa)return Xa.keyString=
gb,Xa.valueString=oc,Xa.isSelected=this.isSelected,Xa.control&&(Xa.control.isSelected=this.isSelected),Xa;Xa=this._propertyWidget=S.renderPropertyControl({target:cc,keyString:gb,valueString:oc,value:$c,spec:Uc,node:this,isSelected:this.isSelected,fontColor:S.ui.propertyTree.fontColor});this.isInternalProperty||Uc.readOnly||(td.connect(Xa,"propertyValue",this,"refreshProperty",{updater:function(Wc,Yd){return Wc(Yd,!0)}}),td.connect(Xa,"openWidget",this.root,"onWidgetOpened",{converter:function(Wc){return{widget:Wc,
node:xa.sourceObj}}}));return Xa}}],[{key:"className",get:function(){return"PropertyNode"}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14672,end:18071})})(td.InspectionNode);(function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=
La.hasOwnProperty("FoldedNode")&&"function"===typeof La.FoldedNode?La.FoldedNode:La.FoldedNode=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(S){Bb._get(Object.getPrototypeOf(pb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,S);this.foldableNode=S=S.foldableNode;this.foldedProp=S.key+td.string.capitalize(this.key)}},{key:"refreshProperty",
value:function(S,xa){xa=void 0===xa?!1:xa;var Xa={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Xa[this.key]=S,Xa)),xa)}}],[{key:"className",get:function(){return"FoldedNode"}}],La,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18073,
end:18749})})(td.PropertyNode);var Ke=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Ke.Color=nb;var vf=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),pb=La.hasOwnProperty("DarkTheme")&&"function"===typeof La.DarkTheme?La.DarkTheme:La.DarkTheme=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:"background",get:function(){return Ke.Color.rgb(44,62,
80)}},{key:"cursorColor",get:function(){return Ke.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},
{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Ke.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Ke.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Ke.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},
{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},
{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Ke.Color.white,fontWeight:"bold",backgroundColor:Ke.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Ke.Color.rgba(204,
204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Ke.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:"className",get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],La,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3048})}(void 0),Ye=vf=Ke.DarkTheme;Ke.default=vf;var zc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");zc.inspect=Fc;zc.remoteInspect=Md;zc.generateReferenceExpression=fd;zc.onNumberDragStart=function(wa,La){La.initPos=wa.position;La.factorLabel=(new zc.Tooltip({description:"1x"})).openInWorld(wa.hand.position.addXY(10,10))};zc.onNumberDrag=
function(wa,La){var pb=zc.getScaleAndOffset(wa,La),S=pb.scale;pb=pb.offset;La.factorLabel.position=wa.hand.position.addXY(10,10);La.factorLabel.description=S+"x";return zc.getCurrentValue(pb,S,La)};zc.onNumberDragEnd=function(wa,La){var pb=zc.getScaleAndOffset(wa,La);wa=pb.offset;pb=pb.scale;La.factorLabel.softRemove();return zc.getCurrentValue(wa,pb,La)};zc.getScaleAndOffset=function(wa,La){var pb=wa.position.subPt(La.initPos);wa=pb.x;La=zc.num.roundTo(Math.exp(-pb.y/$world.height*6),.01)*La.baseFactor;
return{offset:wa,scale:La}};zc.getCurrentValue=function(wa,La,pb){return Math.max(pb.min,Math.min(pb.max,pb.scrubbedValue+(pb.floatingPoint?wa*La:Math.round(wa*La))))};zc.Color=nb;zc.Rectangle=Qb;zc.rect=Hd;zc.pt=Dd;zc.obj=Yc;zc.num=sb;zc.Path=hc;zc.arr=Vb;zc.promise=kc;zc.connect=Jc;zc.disconnect=xb;zc.once=Ta;zc.Morph=yb;zc.Tooltip=wc;zc.VerticalLayout=Kc;zc.GridLayout=zb;zc.HorizontalLayout=ab;zc.morph=Ic;zc.CustomLayout=Kb;zc.Label=nc;zc.Icon=da;zc.StyleSheet=Nc;zc.config=qa;zc.Tree=Va;zc.LoadingIndicator=
cb;zc.DropDownList=kb;zc.DropDownSelector=Ma;zc.SearchField=Oa;zc.LabeledCheckBox=lb;zc.MorphHighlighter=rc;zc.InteractiveMorphSelector=xc;zc.printValue=Ue;zc.RemoteInspectionTree=Ve;zc.InspectionTree=Nd;zc.isMultiValue=Zd;zc.valueWidgets=I;zc.popovers=T;zc.DarkTheme=Ye;zc.DefaultTheme=tb;zc.syncEval=Wb;zc.inspectorCommands=[{name:"focus codeEditor",exec:function(wa){wa.get("codeEditor").show();wa.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(wa){wa.get("propertyTree").show();
wa.get("propertyTree").focus();return!0}}];(function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=La.hasOwnProperty("DraggedProp")&&"function"===typeof La.DraggedProp?La.DraggedProp:La.DraggedProp=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:"applyToTarget",value:function(S){var xa=this.currentTarget,Xa=this.control;this.remove();zc.MorphHighlighter.removeHighlighters(S.world);
if(xa)if(xa.isText&&"js"===xa.editorModeName){var gb=xa.evalEnvironment.context;S=xa.textPositionFromPoint(xa.localize(S.position));gb=zc.generateReferenceExpression(this.sourceObject,{fromMorph:gb});Xa.keyString&&(gb+="."+Xa.keyString);xa.insertTextAndSelect(gb,S);xa.focus()}else"propertyValue"in Xa&&(xa[Xa.keyString]=Xa.propertyValue)}},{key:"update",value:function(S){S=S.hand.globalPosition;var xa=this.morphBeneath(S),Xa;if(xa){for(xa==this.morphHighlighter&&(xa=xa.morphBeneath(S));Xa=[xa].concat($jscomp.arrayFromIterable(xa.ownerChain())).find(function(gb){return!gb.visible});)xa=
Xa=Xa.morphBeneath(S);if(xa!=this.currentTarget){this.currentTarget=xa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(xa.isWorld)return;this.morphHighlighter=zc.MorphHighlighter.for($world,xa);this.morphHighlighter.show()}this.position=S}}}],[{key:"className",get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:zc.Color.rgb(169,204,227)},fill:{defaultValue:zc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},
borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var S=this.control;if(!S)return this.submorphs=[];this.height=22;this.submorphs=[S];S.top=0;S.fontSize=14;"function"===typeof S.relayout&&S.relayout();this.width=S.width+20;this.adjustOrigin(zc.pt(10,10))}}}}}],La,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:1268,end:3690})})(zc.Morph);(function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=La.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof La.DraggableTreeLabel?La.DraggableTreeLabel:La.DraggableTreeLabel=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(S){this.draggedProp=
new zc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();zc.connect(S.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(S){}},{key:"onDragEnd",value:function(S){zc.disconnect(S.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(S)}}],[{key:"className",get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},
nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:zc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:zc.Color.transparent},padding:{defaultValue:zc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(S){this.setProperty("isSelected",S);S?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=S)}}}}}],La,{pathInPackage:function(){return"js/inspector.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3692,end:5015})})(zc.Label);Nd=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=La.hasOwnProperty("PropertyControl")&&"function"===typeof La.PropertyControl?La.PropertyControl:La.PropertyControl=function(S){S&&S[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(S,xa,Xa){S.control=new zc.DropDownSelector({opacity:.8,fill:zc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:xa,padding:0,values:Xa});zc.connect(S.control,"update",S,"propertyValue",{updater:function(gb,oc){this.targetObj.propertyValue!=oc&&gb(oc)}});zc.connect(S,"update",
S.control,"selectedValue",{updater:function(gb,oc){oc=oc&&oc.valueOf?oc.valueOf():oc;this.targetObj.propertyValue!=oc&&gb(oc)}});return S}},{key:"toggleMultiValuePlaceholder",value:function(S){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:zc.Color.transparent,layout:new zc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:zc.arr.range(0,2).map(function(xa){return{type:"ellipse",fill:zc.Color.gray.withA(.5),reactsToPointer:!1,
extent:zc.pt(7,7)}})});S?(zc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(zc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(S){this.foldableProperties&&this.toggleMultiValuePlaceholder(zc.isMultiValue(S,this.foldableProperties))}},
{key:"asFoldable",value:function(S){this.foldableProperties=S;zc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",
value:function(){this.highlighter&&this.highlighter.remove();var S=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});S.isLayoutable=!1;S.fontWeight="bold";S.fontColor=zc.Color.orange;S.reactsToPointer=!1;S.fadeOut(2E3)}}],[{key:"className",get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(S){this.submorphs=
[S]}},layout:{initialize:function(){this.layout=new zc.CustomLayout({relayout:function(S){S.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(S){return(S=S.value)&&(S.isColor||S.isGradient)?"Color":S&&S.isPoint?"Point":zc.obj.isBoolean(S)?"Boolean":zc.obj.isNumber(S)?"Number":zc.obj.isString(S)?"String":S&&S.isRectangle?"Rectangle":!1}},{key:"render",value:function(S){S.spec.type||(S.spec=Object.assign({},S.spec,{type:this.inferType(S)}));
switch(S.spec.type){case "Color":var xa=this.renderColorControl(S);break;case "ColorGradient":xa=this.renderColorControl(Object.assign({},S,{gradientEnabled:!0}));break;case "Number":xa=this.renderNumberControl(S);break;case "String":xa=this.renderStringControl(S);break;case "RichText":xa=this.renderStringControl(S);break;case "Layout":xa=this.renderLayoutControl(S);break;case "Enum":xa=this.renderEnumControl(S);break;case "Shadow":xa=this.renderShadowControl(S);break;case "Point":xa=this.renderPointControl(S);
break;case "Rectangle":xa=this.renderRectangleControl(S);break;case "Boolean":xa=this.renderBooleanControl(S);break;default:xa=this.renderItSomehow(S)}xa.control&&(zc.connect(xa.control,"openWidget",xa,"openWidget"),xa.toggleFoldableValue(S.value));return xa}},{key:"baseControl",value:function(S){var xa=S.spec;S=new this({keyString:S.keyString,valueString:S.valueString,isSelected:!1,propertyValue:S.value});xa.foldable&&S.asFoldable(xa.foldable);return S}},{key:"renderGrabbableKey",value:function(S){var xa=
this,Xa=S.target;return[S.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(gb){gb.state.draggedProp=new zc.DraggedProp({sourceObject:Xa,control:xa.baseControl(S)});gb.state.draggedProp.openInWorld();zc.connect(gb.hand,"update",gb.state.draggedProp,"update")},onDrag:function(gb){},onDragEnd:function(gb){zc.disconnect(gb.hand,"update",gb.state.draggedProp,"update");gb.state.draggedProp.applyToTarget(gb)}}]}},{key:"renderEnumControl",value:function(S){var xa=S.value,Xa=S.spec.values,gb=
S.keyString,oc=S.target,cc=S.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" "+(xa?xa.valueOf?xa.valueOf():xa:"Not set"),{nativeCursor:"pointer",onMouseDown:function($c,Uc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wc){oc.world().openWorldMenu($c,Xa.map(function(Yd){return{string:Yd.toString(),action:function(){oc[gb]=Yd;cc.rerender()}}}));Wc.jumpToEnd()})}}],$jscomp.arrayFromIterable(zc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",
opacity:.7})))}},{key:"renderStringControl",value:function(S){var xa=S.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" "+(200<xa.length?xa.slice(0,20)+"...":xa),{fontColor:zc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(S){var xa=S.value,Xa=S.keyString,gb=S.valueString,oc=S.target,cc=S.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" "+gb,{fontColor:zc.Color.black,nativeCursor:"pointer",onMouseDown:function($c){var Uc;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wc){if(1==Wc.nextAddress)return Uc=new zc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:xa}),Uc.relayout(),Wc.yield(Uc.fadeIntoWorld($c.positionIn(oc.world())),2);zc.connect(Uc,"rectangle",function(Yd){oc[Xa]=Yd;cc.rerender()});Wc.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(S){var xa=S.value,Xa=S.keyString,gb=S.valueString,oc=S.target,cc=S.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),
[" "+gb,{nativeCursor:"pointer",fontColor:xa?zc.Color.green:zc.Color.red,onMouseDown:function($c){oc[Xa]=!oc[Xa];cc.rerender()}}])}},{key:"renderNumberControl",value:function(S){var xa=S.value,Xa=S.spec,gb=S.keyString,oc=S.valueString,cc=S.node,$c=S.target,Uc=S.tree,Wc=void 0===cc._numberControls?new Ze:cc._numberControls,Yd=$jscomp.makeIterator(Wc.submorphs),oe=Yd.next().value,tf=Yd.next().value;Wc.fontColor=Uc.fontColor;var Dg=cc._numberControls=Wc;"max"in Xa&&"min"in Xa&&-Infinity!=Xa.min&&Infinity!=
Xa.max?(Dg.baseFactor=(Xa.max-Xa.min)/100,Dg.floatingPoint=Xa.isFloat,Dg.max=Xa.max,Dg.min=Xa.min):(Dg.floatingPoint=Xa.isFloat,Dg.baseFactor=.5,Dg.min=void 0!=Xa.min?Xa.min:-Infinity,Dg.max=void 0!=Xa.max?Xa.max:Infinity);var Ah=zc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),$jscomp.arrayFromIterable(cc._inputMorph?[cc._inputMorph,{}]:[" "+(void 0!=xa&&(xa.valueOf?xa.valueOf():xa).toFixed(Xa.isFloat?3:0))+" ",{fontColor:Ah,
onMouseUp:function(Mg){cc._inputMorph=zc.morph({type:"input",fill:null,fontColor:Ah,fontFamily:"IBM Plex Mono",fontSize:14,padding:zc.rect(8,2,-6,2),height:23,cursorColor:zc.Color.white,value:xa.valueOf?xa.valueOf():oc});$c[gb]=xa;cc._inputMorph.focus();zc.once(cc._inputMorph,"inputAccepted",function(ri){delete cc._inputMorph;$c[gb]=Xa.isFloat?Number.parseFloat(ri):Number.parseInt(ri);cc.rerender()});zc.once(cc._inputMorph,"onBlur",function(ri){cc._inputMorph&&(delete cc._inputMorph,$c[gb]=xa,cc.rerender())});
cc.rerender()},onDragStart:function(Mg){Dg.scrubbedValue=xa;zc.onNumberDragStart(Mg,Dg)},onDrag:function(Mg){$c[gb]=zc.onNumberDrag(Mg,Dg);cc.rerender()},onDragEnd:function(Mg){return zc.onNumberDragEnd(Mg,Dg)}},Wc,{onMouseUp:function(){oe.fill=tf.fill=null},onMouseDown:function(Mg){if(Mg.targetMorph===oe){oe.fill=zc.Color.white.withA(.2);if("max"in Xa&&$c[gb]>=Xa.max)return;$c[gb]+=1}if(Mg.targetMorph===tf){tf.fill=zc.Color.white.withA(.2);if("min"in Xa&&$c[gb]<=Xa.min)return;--$c[gb]}cc.rerender()}}]))}},
{key:"renderShadowControl",value:function(S){var xa=S.keyString,Xa=S.value,gb=S.target,oc=S.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[""+(Xa?Xa.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(cc){var $c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==Uc.nextAddress)return $c=new zc.popovers.ShadowPopover({shadowValue:gb[xa],hasFixedPosition:!0}),Uc.yield($c.fadeIntoWorld(cc.positionIn(gb.world())),2);zc.connect($c,"shadowValue",
function(Wc){gb[xa]=Wc;oc.rerender()});Uc.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(S){var xa=S.keyString,Xa=S.value,gb=S.target,oc=S.node,cc=zc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,$c={nativeCursor:"pointer",onMouseDown:function(Uc){var Wc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){if(1==Yd.nextAddress)return Wc=new zc.popovers.PointPopover({pointValue:gb[xa],hasFixedPosition:!0}),Yd.yield(Wc.fadeIntoWorld(Uc.positionIn(gb.world())),
2);zc.connect(Wc,"pointValue",function(oe){gb[xa]=oe;oc.rerender()});Yd.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" pt(",Object.assign({},$c),""+Xa.x.toFixed(),Object.assign({fontColor:cc},$c),",",Object.assign({},$c),""+Xa.y.toFixed(),Object.assign({fontColor:cc},$c),")",Object.assign({},$c)])}},{key:"renderLayoutControl",value:function(S){var xa=S.valueString,Xa=S.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" "+(Xa?xa:
"No Layout"),{onMouseDown:function(gb){}}])}},{key:"renderColorControl",value:function(S){var xa=S.node,Xa=S.gradientEnabled,gb=S.valueString,oc=S.keyString,cc=S.value,$c=S.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[zc.morph({fill:cc.valueOf?cc.valueOf():cc,extent:zc.pt(15,15),borderColor:zc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(cc?cc.valueOf?cc.valueOf():gb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Uc){var Wc;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){if(1==Yd.nextAddress)return Wc=new zc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:$c,fillValue:cc,title:"Fill Control",gradientEnabled:Xa}),Yd.yield(Wc.fadeIntoWorld(Uc.positionIn($c.world())),2);zc.connect(Wc,"fillValue",function(oe){$c[oc]=oe;xa.rerender()});Yd.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(S){var xa=S.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(S)),[" "+xa,{}])}}],
La,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5024,end:20444})}(zc.DraggableTreeLabel);zc.PropertyControl=Nd;zc.PropertyControl=Nd;zc.PropertyControl=Nd;zc.inspect=Fc;zc.inspect=Fc;zc.remoteInspect=Md;zc.remoteInspect=Md;zc.generateReferenceExpression=fd;zc.generateReferenceExpression=
fd;var Ze=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=La.hasOwnProperty("NumberControls")&&"function"===typeof La.NumberControls?La.NumberControls:La.NumberControls=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,void 0,[{key:"className",get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new zc.VerticalLayout({spacing:0,
orderByIndex:!0})}},fill:{defaultValue:zc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(S){this.submorphs.map(function(xa){return xa.fontColor=S})}},submorphs:{initialize:function(){this.submorphs=[zc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:zc.rect(5,2,0,-6),fontSize:12}),zc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:zc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],La,{pathInPackage:function(){return"js/inspector.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23095,end:24127})}(zc.Morph);(function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=La.hasOwnProperty("PropertyTree")&&"function"===typeof La.PropertyTree?La.PropertyTree:La.PropertyTree=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Bb(pb,wa,[{key:"onDrag",value:function(S){this._onDragHandler&&this._onDragHandler(S)}}],[{key:"className",get:function(){return"PropertyTree"}}],La,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25279,end:25389})})(zc.Tree);Nd=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),
pb=La.hasOwnProperty("Inspector")&&"function"===typeof La.Inspector?La.Inspector:La.Inspector=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(S){}},{key:"__after_deserialize__",value:function(S,xa,Xa){var gb=this,oc=new zc.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:zc.InspectionTree.forObject(null,this)}));this.addMorph(oc,this.getSubmorphNamed("terminal toggler"));this.layout.col(0).row(1).group.morph=oc;this.whenRendered().then(function(){gb.targetObject&&(gb.targetObject=gb.targetObject)});Bb._get(Object.getPrototypeOf(pb.prototype),"__after_deserialize__",this).call(this,S,xa,Xa)}},{key:"__additionally_serialize__",value:function(S,xa,Xa,gb){S=S.props.submorphs.value;for(xa=S.length;xa--;)Xa.refForId(S[xa].id).realObj==this.ui.propertyTree&&
zc.arr.removeAt(S,xa)}},{key:"renderDraggableTreeLabel",value:function(S){return new zc.DraggableTreeLabel(S)}},{key:"renderPropertyControl",value:function(S){return zc.PropertyControl.render(S)}},{key:"onLoad",value:function(){var S=this.ui,xa=S.codeEditor,Xa=S.thisBindingSelector,gb=S.propertyTree;xa.changeEditorMode("js").then(function(){return xa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Xa.selection?xa.owner.selectedContext:xa.owner.targetObject},
get systemInterface(){return zc.Path("treeData.systemInterface").get(gb)},format:"esm"}}).catch(function(oc){return $world.logError(oc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(S){Bb._get(Object.getPrototypeOf(pb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,S);S=this.ui;var xa=S.targetPicker,Xa=S.propertyTree,gb=S.resizer,oc=S.terminalToggler,cc=S.unknowns,$c=S.internals,Uc=S.searchField,Wc=S.codeEditor,Yd=S.fixImportButton,oe=S.thisBindingSelector;Wc.changeEditorMode("js").then(function(){return Wc.evalEnvironment=
{targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==oe.selection?Wc.owner.selectedContext:Wc.owner.targetObject},get systemInterface(){return Xa.treeData.systemInterface},format:"esm"}}).catch(function(tf){return $world.logError(tf)});zc.connect(xa,"onMouseDown",this,"selectTarget");zc.connect(Xa,"onScroll",this,"repositionOpenWidget");zc.connect(gb,"onDrag",this,"adjustProportions");zc.connect(oc,"onMouseDown",this,"toggleCodeEditor");zc.connect(cc,"trigger",this,"filterProperties");
zc.connect($c,"trigger",this,"filterProperties");zc.connect(Uc,"searchInput",this,"filterProperties");zc.connect(Xa,"nodeCollapseChanged",this,"filterProperties");zc.connect(this,"extent",this,"relayout");zc.connect(oe,"selection",this,"bindCodeEditorThis");zc.connect(Yd,"fire",Wc,"execCommand",{updater:function(tf){return tf("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var S=this.ui.propertyTree.selectedIndex-1,xa=this.ui.propertyTree.selectedNode;
this.ui.propertyTree.selectedNode.refreshProperty();xa=this.ui.propertyTree.document.getLine(S).textAndAttributes.slice(0,4).concat(xa.display(this));S=this.ui.propertyTree.lineRange(S,!1);this.ui.propertyTree.replace(S,xa,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),
this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var S=zc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(S!=this.lastChange||this.lastSubmorphs!=zc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==S.prop&&this.repositionOpenWidget(),this.lastChange=S,this.lastSubmorphs=zc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",
value:function(){var S;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(xa){xa=xa.node;xa.target&&(S=xa.foldableNode?xa.target[xa.foldableNode.key][xa.key]:xa.target[xa.key],!zc.obj.equals(S,xa.value)&&xa.refreshProperty&&xa.refreshProperty(S))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(S,xa){xa=void 0===xa?!1:xa;var Xa=this,gb,oc,cc,$c,Uc,Wc,Yd,oe,tf,Dg,Ah,Mg,ri,Eg,Cj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Te){switch(Te.nextAddress){case 1:if(!Xa.isUpdating()){Te.jumpTo(2);
break}return Te.yield(Xa.whenUpdated(),2);case 2:gb=zc.promise.deferred();oc=gb.promise;cc=!!Xa.target;Xa.updateInProgress=oc;Te.setCatchFinallyBlocks(4);xa&&($c=zc.LoadingIndicator.open("connecting to remote..."));if(!xa){Uc=zc.InspectionTree.forObject(S,Xa);Te.jumpTo(6);break}return Te.yield(zc.RemoteInspectionTree.forObject(S,Xa),7);case 7:Uc=Te.yieldResult;case 6:return Wc=Uc,Yd=Xa.ui.propertyTree,Te.yield(Wc.collapse(Wc.root,!1),8);case 8:if(!Wc.root.children){Te.jumpTo(9);break}return Te.yield(Wc.collapse(Wc.root.children[0],
!1),9);case 9:if(oe=Xa.originalTreeData&&Xa.originalTreeData.diff(Wc)){tf=$jscomp.makeIterator(oe);for(Dg=tf.next();!Dg.done;Dg=tf.next())Ah=Dg.value,Mg=$jscomp.makeIterator(Ah),ri=Mg.next().value,Eg=Mg.next().value,ri.refreshProperty(Eg.value);Te.jumpTo(11);break}Yd.treeData=Wc;return Te.yield(Xa.filterProperties(),12);case 12:if(!Yd.treeData.root.isCollapsed){Te.jumpTo(13);break}return Te.yield(Yd.onNodeCollapseChanged({node:Wc.root,isCollapsed:!1}),14);case 14:Yd.selectedIndex=1;case 13:return Te.yield(Yd.execCommand("uncollapse selected node"),
11);case 11:Xa.toggleWindowStyle(cc);$c&&$c.remove();Te.leaveTryBlock(5);break;case 4:Cj=Te.enterCatchBlock(),Xa.showError(Cj);case 5:Xa.startStepping(1E3,"refreshAllProperties"),Xa.updateInProgress=null,Te.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(S){S=void 0===S?!0:S;var xa=this,Xa,gb,oc,cc,$c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==Uc.nextAddress)return Xa=300,cc=xa.ui.codeEditor.pluginFind(function(Wc){return Wc.runEval}),$c=xa.getWindow(),Uc.yield(cc.runEval("System.get('@system-env').node"),
2);Uc.yieldResult.value?(oc=[].concat($jscomp.arrayFromIterable(zc.arr.without($c.styleClasses,"local")),["node"]),gb=zc.DarkTheme.instance):(oc=["local"].concat($jscomp.arrayFromIterable($c?zc.arr.without($c.styleClasses,"node"):[])),gb=zc.DefaultTheme.instance);cc.theme=gb;S?($c&&$c.animate({duration:Xa,styleClasses:oc}),xa.ui.codeEditor.animate({fill:gb.background,duration:Xa})):$c&&($c.styleClasses=oc);xa.ui.codeEditor.textString=xa.ui.codeEditor.textString;cc.highlight();Uc.jumpToEnd()})}},{key:"isUpdating",
value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var S=this,xa=Object.assign({type:"text",borderWidth:1,borderColor:zc.Color.gray,lineWrapping:"by-chars"},zc.config.codeEditor.defaultStyle,{textString:""}),Xa=zc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});zc.rect(0,0,this.width,30);var gb=new zc.SearchField({styleClasses:["idle"],
name:"searchField"});Xa[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[gb,{type:"button",name:"targetPicker",padding:zc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:zc.Icon.textAttribute("crosshairs")},new zc.LabeledCheckBox({label:"Internals",name:"internals"}),new zc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new zc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:zc.InspectionTree.forObject(null,
this)})),zc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},xa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:zc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Xa),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Xa),[" selection",null])}]}];
this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){S.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var S=this,xa,Xa,gb,oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cc){switch(cc.nextAddress){case 1:if(S.env.eventDispatcher.isKeyPressed("Shift"))return Xa=$jscomp,gb=Xa.makeIterator,cc.yield($world.execCommand("select morph",{justReturn:!0}),
5);S.toggleSelectionInstructions(!0);return cc.yield(zc.InteractiveMorphSelector.selectMorph(),4);case 4:xa=cc.yieldResult;S.toggleSelectionInstructions(!1);cc.jumpTo(3);break;case 5:oc=gb.call(Xa,cc.yieldResult),xa=oc.next().value;case 3:xa&&(S.targetObject=xa),cc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(S){if(S&&!this.instructionWidget){var xa=zc.morph({type:"label",name:"escapeKey",value:"esc"});xa.whenRendered().then(function(){return xa.fit()});this.instructionWidget=
this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},xa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(S){S=
S.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;S.epiMorph=!0;this.openWidget=S;zc.once(S,"close",this,"closeOpenWidget");zc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var S=this.ui.propertyTree,xa=S.textLayout.boundsFor(S,{column:0,row:S.selectedIndex-1});xa=S.worldPoint(zc.pt(xa.x,xa.y+xa.height/2)).addPt(S.scroll.negated());S=S.globalBounds();xa.x=this.globalBounds().center().x;
xa.y<S.top()?xa=S.topCenter():S.bottom()-20<xa.y&&(xa=S.bottomCenter().addXY(0,-20));return xa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(S){this.layout.row(1).height+=S.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(S){if(S!==this.isEditorVisible()){var xa=this.extent,
Xa=this.layout,gb=this.ui,oc=gb.terminalToggler,cc=gb.codeEditor,$c=gb.thisBindingSelector;gb=gb.fixImportButton;Xa.disable();S?(oc.fontColor=zc.Color.rgbHex("00e0ff"),Xa.row(3).height=this.codeEditorHeight||180,Xa.row(2).height=5,gb.animate({visible:!0,duration:200}),$c.animate({visible:!0,duration:200})):(this.codeEditorHeight=Xa.row(3).height,oc.fontColor=zc.Color.white,Xa.row(3).height=Xa.row(2).height=0,gb.animate({visible:!1,duration:200}),$c.animate({visible:!1,duration:200}));this.extent=
xa;Xa.enable({duration:200});this.relayout({duration:200});cc.focus();cc.animate({opacity:S?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var S=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){S.makeEditorVisible(!S.isEditorVisible());xa.jumpToEnd()})}},{key:"filterProperties",value:function(){var S=this,xa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return xa=S.ui.searchField,Xa=S.ui.propertyTree,S.originalTreeData||
(S.originalTreeData=Xa.treeData),zc.disconnect(Xa.treeData,"onWidgetOpened",S,"onWidgetOpened"),gb.yield(Xa.treeData.filter({maxDepth:2,showUnknown:S.ui.unknowns.checked,showInternal:S.ui.internals.checked,iterator:function(oc){return xa.matches(oc.key)}}),2);Xa.update();zc.connect(Xa.treeData,"onWidgetOpened",S,"onWidgetOpened");gb.jumpToEnd()})}},{key:"relayout",value:function(S){S=void 0===S?{}:S;var xa=this,Xa,gb,oc,cc,$c,Uc,Wc,Yd,oe;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tf){xa.layout&&
xa.layout.forceLayout();Xa=xa;gb=Xa.ui;oc=gb.fixImportButton;cc=gb.terminalToggler;$c=gb.propertyTree;Uc=gb.thisBindingSelector;Wc=$c.bounds().insetBy(5).bottomLeft();Yd=$c.bounds().insetBy(5).bottomRight();oe=Yd.subXY(oc.width+10,0);Uc.width=115;Uc.listMorph.itemHeight=20;S.duration?(cc.animate(Object.assign({bottomLeft:Wc},S)),oc.animate(Object.assign({bottomRight:Yd},S)),Uc.animate(Object.assign({bottomRight:oe},S))):(cc.bottomLeft=Wc,oc.bottomRight=Yd,Uc.bottomRight=oe);tf.jumpToEnd()})}},{key:"keybindings",
get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Bb._get(Object.getPrototypeOf(pb.prototype),"keybindings",this))}},{key:"commands",get:function(){return zc.inspectorCommands}}],[{key:"className",get:function(){return"Inspector"}},{key:"openInWindow",value:function(S){S=new this(S);S.openInWindow();return S}},{key:"properties",get:function(){return{extent:{defaultValue:zc.pt(400,
500)},fill:{defaultValue:zc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(S){this.setProperty("remoteTarget",S);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(S,!0))}},targetObject:{after:["submorphs"],set:function(S){this._serializableTarget=S&&S.isMorph?S.id:S;this.setProperty("targetObject",S);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(S))}},
originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var S=this.ui.propertyTree,xa=S.selectedNode;S=S.treeData;return S.getContextFor(xa?xa:S.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),
propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:zc.Color.gray,fontSize:14,fontFamily:zc.config.codeEditor.defaultStyle.fontFamily}},
master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],La,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25406,end:45571})}(zc.Morph);Nd=zc.Inspector;Ve=ta("I",Nd);zc.default=Nd;var If=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");
If.Inspector=Ve;If.string=Xc;If.Morph=yb;If.pt=Dd;If.Color=nb;Nd=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(wa,La,pb){pb=void 0===pb?1:pb;var S,xa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){switch(gb.nextAddress){case 1:return wa.maybeSelectCommentOrLine(),gb.setCatchFinallyBlocks(2),La=Object.assign({},La,{logDoit:!0,inspect:!0,inspectDepth:pb}),gb.yield(wa.doEval(void 0,La),4);case 4:S=gb.yieldResult;xa=S.error?
S.error:S.isError?S.value:null;gb.leaveTryBlock(3);break;case 2:xa=Xa=gb.enterCatchBlock();case 3:return xa?wa.showError(xa):wa.setStatusMessage(If.string.truncate(S.value,1E3)),gb.return(S)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(wa,La){var pb,S,xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){switch(Xa.nextAddress){case 1:return Xa.setCatchFinallyBlocks(2),Xa.yield(wa.doEval({start:{row:0,column:0},end:wa.documentEndPosition},
Object.assign({},La,{logDoit:!0})),4);case 4:pb=Xa.yieldResult;S=pb.error?pb.error:pb.isError?pb.value:null;Xa.leaveTryBlock(3);break;case 2:S=xa=Xa.enterCatchBlock();case 3:return S?wa.showError(S):wa.setStatusMessage(String(pb.value)),Xa.return(pb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(wa,La){var pb,S,xa,Xa,gb,oc,cc,$c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){switch(Uc.nextAddress){case 1:return wa.maybeSelectCommentOrLine(),
Uc.setCatchFinallyBlocks(2),La=Object.assign({},La,{asString:!1,logDoit:!0}),Uc.yield(wa.doEval(void 0,La),4);case 4:pb=Uc.yieldResult;S=pb.error?pb.error:pb.isError?pb.value:null;Uc.leaveTryBlock(3);break;case 2:S=xa=Uc.enterCatchBlock();case 3:wa.selection.collapseToEnd();if(Xa=pb.value&&pb.value.isColor)return wa.selection.text=String(pb.value),gb=new If.Morph({fill:If.Color.transparent,extent:If.pt(wa.fontSize+2,wa.fontSize+2),submorphs:[{fill:pb.value,center:If.pt(wa.fontSize+2,wa.fontSize+2).scaleBy(.5)}]}),
oc=wa.selection.start,cc=oc.column,$c=oc.row,wa.insertText([gb,{}],wa.selection.start),wa.selection.start={column:cc,row:$c},Uc.return(pb);wa.insertTextAndSelect(S?String(S)+(S.stack?"\n"+S.stack:""):String(pb.value));return Uc.return(pb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(wa,La){var pb,S,xa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){switch(gb.nextAddress){case 1:debugger;wa.maybeSelectCommentOrLine();
S=wa.textInRange(wa.selection);xa=wa.evalEnvironment||{};Xa=wa.pluginFind(function(oc){return oc.isEditorPlugin&&"function"===typeof oc.runEval});xa.systemInterface||(xa.systemInterface=Xa.systemInterface(La));if("local"!==xa.systemInterface.name){gb.jumpTo(2);break}gb.setCatchFinallyBlocks(3);return gb.yield(wa.doEval(void 0,La),5);case 5:pb=gb.yieldResult;S=pb.value;gb.leaveTryBlock(2);break;case 3:gb.enterCatchBlock();case 2:return wa.world().execCommand("open object editor",{target:S,evalEnvironment:xa}),
gb.return(pb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(wa,La){var pb,S,xa,Xa,gb,oc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cc){switch(cc.nextAddress){case 1:wa.maybeSelectCommentOrLine();xa=wa.textInRange(wa.selection);Xa=wa.evalEnvironment||{};gb=wa.pluginFind(function($c){return $c.isEditorPlugin&&"function"===typeof $c.runEval});Xa.systemInterface||(Xa.systemInterface=gb.systemInterface(La));if("local"!==
Xa.systemInterface.name){If.Inspector.openInWindow({remoteTarget:{code:xa,evalEnvironment:Xa}});cc.jumpTo(2);break}cc.setCatchFinallyBlocks(3);return cc.yield(wa.doEval(void 0,La),5);case 5:pb=cc.yieldResult;S=pb.error?pb.error:pb.isError?pb.value:null;xa=pb.value;cc.leaveTryBlock(4);break;case 3:S=oc=cc.enterCatchBlock();case 4:If.Inspector.openInWindow({targetObject:S?S:xa});case 2:return cc.return(pb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(wa,La,pb){pb=void 0===pb?1:pb;var S;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xa){switch(xa.nextAddress){case 1:return wa.maybeSelectCommentOrLine(),xa.setCatchFinallyBlocks(2),La=Object.assign({},La,{inspect:!0,inspectDepth:pb,logDoit:!0}),xa.yield(wa.doEval(void 0,La),4);case 4:S=xa.yieldResult;xa.leaveTryBlock(3);break;case 2:xa.enterCatchBlock();case 3:return wa.selection.collapseToEnd(),wa.insertTextAndSelect(S.value),xa.return(S)}})}}];If.codeEvaluationCommands=
Nd;If.codeEvaluationCommands=Nd;If.codeEvaluationCommands=Nd;var Kf=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Kf.changeAttributeInSelectionOrMorph=function(wa,La,pb){var S=wa.selection;wa.keepPosAtSameScrollOffsetWhile(function(){S.isEmpty()?wa[La]="function"===typeof pb?pb(wa[La]):pb:(wa.undoManager.group(),wa.changeStyleProperty(La,function(xa){return"function"===typeof pb?pb(xa):pb}),wa.undoManager.group())})};Ve=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(wa){var La=wa.fontSize;Kf.changeAttributeInSelectionOrMorph(wa,"fontSize",function(pb){pb=pb||La;return pb+(18<=pb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(wa){var La=wa.fontSize;Kf.changeAttributeInSelectionOrMorph(wa,"fontSize",function(pb){pb=pb||La;return pb-(18>=pb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(wa){var La,pb,S,xa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress){La=
["serif","sans-serif","monospace"];if(pb=localStorage["lively.morpic/text-change-font-additional-fonts"])pb=JSON.parse(pb),La.push.apply(La,$jscomp.arrayFromIterable(pb));La.map(function(oc){return oc.toLowerCase()}).includes(wa.fontFamily.toLowerCase())||(La.push(wa.fontFamily),pb=[].concat($jscomp.arrayFromIterable(pb||[]),[wa.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(pb));return gb.yield($world.editListPrompt("choose font",La,{requester:wa,preselect:La.indexOf(wa.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}S=gb.yieldResult;xa=$jscomp.makeIterator(S.selections);if(Xa=xa.next().value)wa.fontFamily=Xa;return gb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(wa,La){La=void 0===La?{}:La;var pb,S,xa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress){if(La.hasOwnProperty("link"))return gb.jumpTo(2);S=wa.selection;xa=wa.getStyleInRange(S);Xa=xa.link;return gb.yield(wa.world().prompt("Set link",
{input:Xa||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=gb.nextAddress&&(pb=gb.yieldResult,!pb))return gb.return();wa.undoManager.group();wa.setStyleInRange({link:pb||void 0},S);wa.undoManager.group();gb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(wa,La){var pb,S,xa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return pb=wa.selection,S=wa.getStyleInRange(pb),xa=S.doit,gb.yield(wa.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:wa,input:xa?xa.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:wa.evalEnvForDoit(xa||{})}),2);Xa=gb.yieldResult;wa.undoManager.group();Xa?wa.addTextAttribute({doit:{code:Xa},nativeCursor:"pointer",textDecoration:"underline"},pb):wa.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},pb);wa.undoManager.group();gb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(wa,La){La=void 0===La?{}:La;wa.undoManager.group();
La=!La.onlySelection&&wa.selection.isEmpty()?wa.documentRange:wa.selection.range;wa.setStyleInRange(null,La);wa.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(wa){var La,pb,S,xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==Xa.nextAddress)return Xa.yield(System.import("lively.modules"),2);if(3!=Xa.nextAddress)return La=Xa.yieldResult,pb=La.module,Xa.yield(pb("lively.ide/text/ui.js").load(),3);S=Xa.yieldResult;xa=S.RichTextControl;return Xa.return(xa.openFor(wa))})}}];
Kf.commands=Ve;Kf.commands=Ve;Kf.commands=Ve;var Ce=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");Ce.guessTextModeName=Ib;Ce.rangedToken=function(wa,La,pb,S,xa){return{start:{row:wa,column:La},end:{row:wa,column:pb},token:S,mode:xa}};Ce.fun=Nb;Ce.arr=Vb;Ce.connect=Jc;Ce.disconnect=xb;Ce.DefaultTheme=tb;Ce.tokenizeDocument=Za;Ce.modeInfo=ma;Ce.visitDocumentTokens=qc;Ce.getMode=Rb;Ce.completionCommands=ka;Ce.multiSelectCommands=sc;Ce.navCommands=Bd;Ce.codeCommands=ue;Ce.codeEvaluationCommands=
Nd;Ce.richTextCommands=Ve;Ce.Color=nb;Ce.Range=Fd;Ce.guessTextModeName=Ib;Ce.guessTextModeName=Ib;tb=function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),pb=La.hasOwnProperty("EditorPlugin")&&"function"===typeof La.EditorPlugin?La.EditorPlugin:La.EditorPlugin=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
Ce.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(S){var xa=this;this.textMorph=S;Ce.connect(S,"textChange",this,"onTextChange");Ce.connect(S,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return xa.highlight()})}},
{key:"detach",value:function(S){Ce.disconnect(S,"textChange",this,"onTextChange");Ce.disconnect(S,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(S){this._ast=null;if(S){var xa=this._tokenizerValidBefore;if("replace"===S.selector){var Xa=S.args[0].start;S=Xa.row;Xa=Xa.column}else Xa=S=0;if(!xa||S<xa.row||S===xa.row&&Xa<xa.column)S=Math.max(0,S),this._tokenizerValidBefore={row:S,column:Xa}}this.requestHighlight()}},
{key:"requestHighlight",value:function(S){var xa=this;(void 0===S?0:S)?this.highlight():Ce.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return xa.highlight()})()}},{key:"highlight",value:function(){var S=this.textMorph,xa=this.theme,Xa=this.mode,gb=this._tokenizerValidBefore;if(xa&&S&&S.document&&Xa){S.fill=xa.background;S.cursorColor=xa.cursorColor||Ce.Color.black;var oc=S.viewState,cc={};gb=Ce.tokenizeDocument(Xa,S.document,oc.firstVisibleRow,oc.lastVisibleRow,gb);Xa=gb.lines;gb=
gb.tokens;if(Xa.length){oc=Xa[0].row;for(var $c=[],Uc=0;Uc<gb.length;oc++,Uc++)for(var Wc=gb[Uc],Yd=0;Yd<Wc.length;Yd+=5){var oe=Wc[Yd],tf=Wc[Yd+1],Dg=xa[Wc[Yd+2]]||xa.default;Dg&&$c.push({start:{row:oc,column:oe},end:{row:oc,column:tf}},Dg)}S.embeddedMorphs.forEach(function(Ah){var Mg=S.embeddedMorphMap.get(Ah).anchor;cc[Ah.id]=S.textAttributeAt(Mg.position)});S.setTextAttributesWithSortedRanges($c);S.embeddedMorphs.forEach(function(Ah){var Mg=S.embeddedMorphMap.get(Ah).anchor;Mg=Ce.Range.at(Mg.position);
Mg.end.column+=1;S.replace(Mg,[Ah,cc[Ah.id]],!1)});this._tokenizerValidBefore={row:Ce.arr.last(Xa).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},S,this)}}},{key:"visitTokensInRange",value:function(S,xa){var Xa=S.start,gb=S.end,oc=Xa.row-1;Ce.visitDocumentTokens(this.mode,this.textMorph.document,Xa.row,gb.row,null,function(cc){return oc++},function(cc,$c,Uc,Wc,Yd,oe,tf){if(oc===Xa.row&&0<Xa.column){if(Xa.column>=Wc)return;Uc<Xa.column&&Xa.column<Wc&&(Uc=Xa.column)}if(oc===gb.row){if(gb.column<=
Uc)return;Uc<gb.column&&gb.column<Wc&&(Wc=gb.column)}xa(cc,$c,oc,Uc,Wc,Yd,oe,tf)})}},{key:"tokensInRange",value:function(S){var xa=[];this.visitTokensInRange(S,function(Xa,gb,oc,cc,$c,Uc,Wc,Yd){return xa.push(Ce.rangedToken(oc,cc,$c,Xa,Yd))});return xa}},{key:"tokensOfRow",value:function(S){var xa=this.textMorph.getLine(S).length;return this.tokensInRange({start:{row:S,column:0},end:{row:S,column:xa}})}},{key:"tokenAt",value:function(S){for(var xa=this.tokensOfRow(S.row),Xa=xa.length;Xa--;){var gb=
xa[Xa];if(gb.token&&gb.start.column<=S.column&&S.column<=gb.end.column)return gb}return null}},{key:"getCommands",value:function(S){return[].concat($jscomp.arrayFromIterable(S),$jscomp.arrayFromIterable(Ce.completionCommands),$jscomp.arrayFromIterable(Ce.multiSelectCommands),$jscomp.arrayFromIterable(Ce.navCommands),$jscomp.arrayFromIterable(Ce.codeCommands),$jscomp.arrayFromIterable(Ce.codeEvaluationCommands),$jscomp.arrayFromIterable(Ce.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var S=this.mode,xa=S.lineComment,Xa=S.blockCommentStart;S=S.blockCommentEnd;var gb={};xa&&(gb.lineCommentStart=xa);Xa&&(gb.blockCommentStart=Xa);S&&(gb.blockCommentEnd=S);return gb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(S,xa,Xa){var gb=this.textMorph,oc=S.row,cc=S.column;S=xa[cc-1];xa=xa[cc];gb.selection.text="\n";gb.selection.collapseToEnd();"{"===S&&"}"===xa&&(gb.selection.text="\n"+" ".repeat(Xa),gb.selection.collapse());
gb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:oc+1,lastRow:oc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var S=this.textMorph,xa=this.openPairs,Xa=S.selection,gb=S.getLine(Xa.end.row),oc=gb[Xa.end.column-1];gb=gb[Xa.end.column];S.autoInsertPairs&&Xa.isEmpty()&&oc in
xa&&gb===xa[oc]&&(Xa.growRight(1),Xa.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(S){var xa=this.openPairs,Xa=this.closePairs,gb=this.textMorph,oc=gb.selection,cc=gb.autoInsertPairs&&S in xa,$c=gb.autoInsertPairs&&S in Xa;if(!cc&&!$c)return!1;var Uc=gb.getLine(oc.end.row)[oc.end.column];if(!oc.isEmpty()){if(!cc)return!1;Xa=gb.undoManager.ensureNewGroup(gb);gb.insertText(xa[S],oc.end);gb.insertText(S,oc.start);gb.undoManager.group(Xa);oc.growRight(-1);return!0}if(Uc in Xa&&S===Uc)return oc.goRight(1),
!0;if($c&&!cc)return!1;Xa=gb.undoManager.ensureNewGroup(gb);gb.insertText(S+xa[S]);gb.undoManager.group(Xa);oc.goLeft(1);return!0}}],[{key:"className",get:function(){return"EditorPlugin"}}],La,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);ma=tb=Ce.EditorPlugin;
ka=ta("C",function(wa){var La=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),pb=La.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof La.CodeMirrorEnabledEditorPlugin?La.CodeMirrorEnabledEditorPlugin:La.CodeMirrorEnabledEditorPlugin=function(S){S&&S[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bb(pb,wa,[{key:Symbol.for("lively-instance-initialize"),value:function(){Bb._get(Object.getPrototypeOf(pb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(S){this.mode=this.codeMirrorMode(S);return Bb._get(Object.getPrototypeOf(pb.prototype),"attach",this).call(this,S)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(S){return{indentWithTabs:!S.useSoftTabs,indentUnit:S.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(S){S=this.defaultCodeMirrorModeConfig(S);
return Ce.getMode(S,{name:this.longName})}}],[{key:"className",get:function(){return"CodeMirrorEnabledEditorPlugin"}}],La,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(Ce.EditorPlugin));Ce.CodeMirrorEnabledEditorPlugin=ka;Ce.CodeMirrorEnabledEditorPlugin=ka;Ce.CodeMirrorEnabledEditorPlugin=
ka;Ce.default=tb;tb=Object.freeze({__proto__:null,guessTextModeName:Ib,"default":ma,CodeMirrorEnabledEditorPlugin:ka});ta("e",tb)}}});
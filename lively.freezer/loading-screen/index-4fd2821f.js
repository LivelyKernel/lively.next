System.register(["./__root_module__-28353364.js"],function(Ia){var mb,vb,Vb,Eb,Jc,Bc,Uc,tc,oc,sc,Tc,Fd,Rd,ee;return{setters:[function(Dc){mb=Dc.a_;vb=Dc.a;Vb=Dc.r;Eb=Dc.Y;Jc=Dc.p;Bc=Dc.X;Uc=Dc.bv;tc=Dc.aZ;oc=Dc.i;sc=Dc.s;Tc=Dc.bw;Fd=Dc.bx;Rd=Dc.J;ee=Dc.by}],execute:function(){function Dc(Kb){try{var za=eval("("+Cb.ast.transform.wrapInFunction("var _; _ = ("+Kb+")")+")()")}catch(bb){return JSON.parse(Kb)}return"object"!==typeof za?null:za}function rd(Kb,za){var bb,P,X,ya,Ga,wa,ja,lb,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xb){switch(Xb.nextAddress){case 1:return bb=
za.world(),Xb.yield(bb.prompt("Enter package name",{requester:za,input:"",historyId:"lively.vm-editor-add-package-name",useLastInput:!0}),2);case 2:P=Xb.yieldResult;if(!P)throw"Canceled";Xb.setCatchFinallyBlocks(3);ya=ob.resource(P);P=ya.name();X=ya.url;Xb.leaveTryBlock(4);break;case 3:return Xb.enterCatchBlock(),Xb.yield(Kb.getConfig(),5);case 5:return Ga=Xb.yieldResult.baseURL,wa=ob.resource(Ga).join(P).asDirectory().url,Xb.yield(Kb.normalize(wa),6);case 6:X=Xb.yieldResult.replace(/\/\.js$/,"/");
case 4:return Xb.yield(bb.prompt("Confirm or change package location",{requester:za,input:X,historyId:"lively.vm-editor-add-package-address"}),7);case 7:ja=Xb.yieldResult;if(!ja)throw"Canceled";lb=ob.resource(ja).asDirectory();Ja=lb.asFile().url;return Xb.yield(Kb.removePackage(Ja),8);case 8:return Xb.yield(Kb.resourceCreateFiles(Ja,{"index.js":"'format esm';\n","package.json":'{\n  "name": "'+P+'",\n  "version": "0.1.0"\n}',".gitignore":"node_modules/","README.md":"# "+P+"\n\nNo description for package "+
P+" yet.\n",tests:{"test.js":'import { expect } from "mocha-es6";\ndescribe("'+P+'", () => {\n  it("works", () => {\n    expect(1 + 2).equals(3);\n  });\n});'}}),9);case 9:return Xb.return(ob.loadPackage(Kb,{name:P,address:Ja,configFile:lb.join("package.json").url,main:lb.join("index.js").url,test:lb.join("tests/test.js").url,type:"package"}))}})}function Ab(Kb,za,bb){bb=void 0===bb?null:bb;var P,X,ya,Ga,wa,ja,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){switch(Ja.nextAddress){case 1:return P=
{name:"",address:"",type:"package"},Ja.yield(Kb.getConfig(),2);case 2:X=Ja.yieldResult;if(!bb){Ja.jumpTo(3);break}return Ja.yield(Kb.getPackage(bb),4);case 4:if(ya=Ja.yieldResult){Ja.jumpTo(5);break}return Ja.yield(Kb.getPackageForModule(bb),6);case 6:ya=Ja.yieldResult;case 5:Ga=ya;case 3:return Ja.yield(za.world().prompt("What is the package directory?",{requester:za,input:Ga?Ga.address:X.baseURL,historyId:"lively.vm-editor-package-load-history",useLastInput:!1}),7);case 7:wa=Ja.yieldResult;if(!wa)throw"Canceled";
P.address=wa.replace(/\/$/,"");P.url=new ob.URL(P.address+"/");P.configFile=ob.resource(P.url).join("package.json").url;Ja.setCatchFinallyBlocks(8);ja=JSON;lb=ja.parse;return Ja.yield(Kb.moduleRead(P.configFile),10);case 10:lb.call(ja,Ja.yieldResult).name;Ja.leaveTryBlock(9);break;case 8:Ja.enterCatchBlock(),P.name=String(P.url).replace(/\/$/,""),Kb.resourceEnsureExistance(P.configFile,'{\n  "name": "'+P.name+'",\n  "version": "0.1.0"\n}');case 9:return Ja.return(ob.loadPackage(Kb,P))}})}function qc(Kb,
za,bb){var P,X,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){switch(Ga.nextAddress){case 1:return P=ob.resource(bb).asFile().url,Ga.yield(Kb.getPackage(P),2);case 2:if(X=Ga.yieldResult){Ga.jumpTo(3);break}return Ga.yield(Kb.getPackageForModule(P),4);case 4:X=Ga.yieldResult;case 3:ya=X;if(!ya)throw Error("Cannot find package for "+P);return Ga.yield(Kb.reloadPackage(P),5);case 5:if(!za){Ga.jumpTo(0);break}return Ga.yield(za.updateModuleList(),7);case 7:return Ga.yield(za.uiSelect(P,
!1),8);case 8:return Ga.return(Ga.yieldResult)}})}function Xc(Kb,za,bb,P){var X,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){switch(Ga.nextAddress){case 1:return Ga.yield(Kb.getPackage(bb),2);case 2:return X=Ga.yieldResult,Ga.yield((P||$world).confirm("Unload package "+X.name+"?",{requester:za}),3);case 3:ya=Ga.yieldResult;if(!ya)throw"Canceled";return Ga.yield(Kb.removePackage(bb),4);case 4:if(!za){Ga.jumpTo(0);break}return Ga.yield(za.updateModuleList(),6);case 6:return Ga.yield(za.uiSelect(null),
0)}})}function zc(Kb,za,bb){var P,X,ya,Ga,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ja){switch(ja.nextAddress){case 1:return P=za.world(),ja.yield(Kb.getPackage(bb),2);case 2:return X=ja.yieldResult,X?ja.yield(P.confirm("Really remove package "+X.name+"?",{requester:za}),3):($world.inform('No package "'+bb+'" found!',{requester:za}),ja.return());case 3:ya=ja.yieldResult;if(!ya)throw"Canceled";Kb.removePackage(bb);return ja.yield(P.confirm("Also remove directory "+X.name+" including "+
X.modules.length+" modules?"),4);case 4:Ga=ja.yieldResult;if(!Ga){ja.jumpTo(0);break}return ja.yield(P.confirm("REALLY *remove* directory "+X.name+"? No undo possible..."),6);case 6:if(wa=ja.yieldResult)return ja.yield(Kb.resourceRemove(X.address),0);ja.jumpTo(0)}})}function ed(Kb,za,bb){bb=void 0===bb?$world:bb;var P,X,ya,Ga,wa,ja,lb,Ja,Xb,Kc,Hb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oc){switch(Oc.nextAddress){case 1:return Oc.yield(Kb.getPackage(za),2);case 2:P=Oc.yieldResult;
if(!P)throw Error("Cannot find package "+za);X=[];ya=$jscomp.makeIterator(P.modules);Ga=ya.next();case 3:if(Ga.done)return Oc.yield(bb.execCommand("open text window",{title:"imports and exports of "+za,content:X.join("\n\n")}),0);wa=Ga.value;if(!wa.name.match(/\.js$/)){Oc.jumpTo(4);break}Oc.setCatchFinallyBlocks(6);ja=Kb;lb=ja.importsAndExportsOf;Ja=wa.name;return Oc.yield(Kb.moduleRead(wa.name),9);case 9:return Oc.yield(lb.call(ja,Ja,Oc.yieldResult),8);case 8:Xb=Oc.yieldResult;Oc.leaveTryBlock(7);
break;case 6:Kc=Oc.enterCatchBlock();bb.logError(Error("Error when getting imports/exports from module "+wa.name+":\n"+Kc.stack));Oc.jumpTo(4);break;case 7:Hb=""+wa.name;if(!Xb.imports.length&&!Xb.exports.length){Hb+="\n  does not import / export anything";Oc.jumpTo(4);break}Xb.imports.length&&(Hb+="\n  imports:\n",Hb+=ob.arr.groupByKey(Xb.imports,"fromModule").mapGroups(function(qb,xd){return"from "+qb+": "+xd.map(function(he){return he.local||he.imported?he.imported&&he.imported!==he.local?he.imported+
" as "+he.local:he.local:"nothing imported"}).join(", ")}).toArray().join("\n").split("\n").map(function(qb){return"    "+qb}).join("\n"));Xb.exports.length&&(Hb+="\n  exports:\n",Hb+=Xb.exports.map(function(qb){return qb.local?qb.local&&qb.local!==qb.exported?qb.local+" as "+qb.exported:qb.exported:qb.exported+" from "+qb.fromModule}).join(", ").split("\n").map(function(qb){return"    "+qb}).join("\n"));X.push(Hb);case 4:Ga=ya.next(),Oc.jumpTo(3)}})}function wd(Kb){return Kb.match(/import.*['"]mocha(-es6)?['"]/)&&
Kb.match(/it\(['"]/)}function xb(Kb,za,bb){bb=bb&&bb.address;if(bb&&0===za.indexOf(bb))var P=za.slice(bb.length).replace(/^\//,"");else a:{bb=Kb.getConfig();if(!bb||bb.constructor!==Promise)try{P=String((new bc.URL(za)).relativePathFrom(new bc.URL(Kb.getConfig().baseURL)));break a}catch(X){}P=za}return P}function hc(Kb,za,bb,P){return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){return 1==X.nextAddress?(P=Object.assign({targetModule:za},P),X.yield(Kb.normalize(za),2)):3!=X.nextAddress?
(za=X.yieldResult,X.yield(Kb.moduleSourceChange(za,bb,P),3)):X.return(za)})}function Cc(Kb,za,bb,P,X){P=void 0===P?!1:P;X=void 0===X?!1:X;var ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){switch(Ga.nextAddress){case 1:return za&&za.setStatusMessage("Reloading "+bb),Ga.setCatchFinallyBlocks(2),Ga.yield(Kb.reloadModule(bb,{reloadDeps:P,resetEnv:X}),4);case 4:if(!za){Ga.jumpTo(5);break}return Ga.yield(za.updateModuleList(),6);case 6:case 5:za&&za.setStatusMessage("Reloded "+bb);
Ga.leaveTryBlock(0);break;case 2:ya=Ga.enterCatchBlock();Ga.setCatchFinallyBlocks(7);if(!za){Ga.jumpTo(9);break}return Ga.yield(za.updateEditorWithSourceOf(bb),10);case 10:case 9:Ga.leaveTryBlock(8);break;case 7:Ga.enterCatchBlock();case 8:throw za&&za.showError(ya),ya;}})}function ic(Kb,za,bb){return $jscomp.asyncExecutePromiseGeneratorProgram(function(P){switch(P.nextAddress){case 1:return P.yield(Kb.forgetModule(bb,{forgetEnv:!0,forgetDeps:!0}),2);case 2:if(!za){P.jumpTo(3);break}return P.yield(za.updateModuleList(),
4);case 4:case 3:P.jumpToEnd()}})}function Qc(Kb,za,bb){var P,X,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){switch(Ga.nextAddress){case 1:return Ga.yield(Kb.normalize(bb),2);case 2:return P=Ga.yieldResult,Ga.yield(za.world().confirm("Remove file "+P+"?",{requester:za}),3);case 3:X=Ga.yieldResult;if(!X)throw"Canceled";return Ga.yield(Kb.forgetModule(P),4);case 4:return Ga.yield(Kb.resourceRemove(P),5);case 5:return Ga.yield(Kb.getPackageForModule(P),6);case 6:return ya=Ga.yieldResult,
Ga.return(ya)}})}function jb(Kb,za,bb){var P,X,ya,Ga,wa,ja,lb,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xb){switch(Xb.nextAddress){case 1:return P=bc.URL,Xb.yield(Kb.getConfig(),2);case 2:X=new P(Xb.yieldResult.baseURL);ya=za.world();if(!bb){Xb.jumpTo(3);break}return Xb.yield(Kb.getPackage(bb),4);case 4:if(Ga=Xb.yieldResult){Xb.jumpTo(5);break}return Xb.yield(Kb.getPackageForModule(bb),6);case 6:Ga=Xb.yieldResult;case 5:(wa=Ga)&&(X=new bc.URL(wa.address));case 3:return Xb.yield(bc._searchForExistingFiles(za,
String(X),wa),7);case 7:ja=Xb.yieldResult;if(!ja.includes("[create new module]")){Xb.jumpTo(8);break}return Xb.yield(bc._askForModuleName(Kb,bb||String(X),ya),9);case 9:lb=Xb.yieldResult,ja=[lb];case 8:return Xb.yield(bc._createAndLoadModules(Kb,ja),10);case 10:return Ja=Xb.yieldResult,bc.arr.compact(Ja.map(function(Kc){return Kc.error})),Xb.return(Ja)}})}function fb(Kb,za){var bb,P,X,ya,Ga,wa,ja,lb,Ja,Xb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Kc){if(1==Kc.nextAddress)return Kc.yield(Kb.getPackage(za),
2);if(3!=Kc.nextAddress){bb=Kc.yieldResult;if(!bb||!bb.address.match(/^http/))throw Error("Cannot load package "+za);P=bc.resource(bb.address);X=[];ya=$jscomp;Ga=ya.makeIterator;return Kc.yield(P.dirList(5,{exclude:bc.modulesInPackage_defaultExclude}),3)}wa=Ga.call(ya,Kc.yieldResult);for(ja=wa.next();!ja.done;ja=wa.next())Ja=lb=ja.value,Xb=Ja.url,Xb.match(/\.js$/)&&Kb.isModuleLoaded(Xb,!0)&&X.push(Kb.getModule(Xb));return Kc.return(X)})}function Ob(Kb){Kb||(Kb="local");if(Kb.isSystemInterface)var za=
Kb;else"string"===typeof Kb&&Kb.startsWith("l2l ")&&(Kb={type:"l2l",id:Kb.split(" ")[1]}),"string"!==typeof Kb&&"l2l"===Kb.type&&(za=Lb.l2lInterfaceFor(Kb.id,Kb.info)),"string"!==typeof Kb&&($world.setStatusMessage("Unknown system interface "+Kb),Kb="local"),za||(za=Kb&&"local"!==Kb?Lb.serverInterfaceFor(Kb):Lb.localInterface);return za}Ia("systemInterfaceNamed",Ob);var Cb=lively.FreezerRuntime.recorderFor("lively-system-interface/helpers.js");Cb.parseJsonLikeObj=Dc;Cb.ast=mb;Cb.parseJsonLikeObj=
Dc;Cb.parseJsonLikeObj=Dc;var ob=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/packages.js");ob.loadPackage=function(Kb,za){var bb,P;return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){switch(X.nextAddress){case 1:return X.yield(Kb.importPackage(za.address+"/"),2);case 2:if(!za.main){X.jumpTo(3);break}return X.yield(Kb.importModule(za.main.toString()),3);case 3:if(!za.test){X.jumpTo(5);break}X.setCatchFinallyBlocks(6);return X.yield(Kb.importPackage("mocha-es6"),8);
case 8:return bb=X.yieldResult,X.yield(bb.installSystemInstantiateHook(),9);case 9:return X.yield(Kb.importModule(za.test.toString()),10);case 10:X.leaveTryBlock(5);break;case 6:P=X.enterCatchBlock(),console.warn("Cannot load test of new package: "+P);case 5:return X.return(Kb.getPackage(za.address))}})};ob.interactivelyCreatePackage=rd;ob.interactivelyLoadPackage=Ab;ob.interactivelyReloadPackage=qc;ob.interactivelyUnloadPackage=Xc;ob.interactivelyRemovePackage=zc;ob.showExportsAndImportsOf=ed;ob.parseJsonLikeObj=
Dc;ob.arr=vb;ob.resource=Vb;ob.interactivelyCreatePackage=rd;ob.interactivelyCreatePackage=rd;ob.interactivelyLoadPackage=Ab;ob.interactivelyLoadPackage=Ab;ob.interactivelyReloadPackage=qc;ob.interactivelyReloadPackage=qc;ob.interactivelyUnloadPackage=Xc;ob.interactivelyUnloadPackage=Xc;ob.interactivelyRemovePackage=zc;ob.interactivelyRemovePackage=zc;ob.showExportsAndImportsOf=ed;ob.showExportsAndImportsOf=ed;var bc=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/modules.js");
bc.isTestModule=wd;bc.shortModuleName=xb;bc.interactivelyChangeModule=hc;bc.interactivelyReloadModule=Cc;bc.interactivelyUnloadModule=ic;bc.interactivelyRemoveModule=Qc;bc.interactivelyAddModule=jb;bc._askForModuleName=function(Kb,za,bb){var P,X;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){switch(ya.nextAddress){case 1:return ya.yield(bb.prompt("Enter module name",{input:za,historyId:"lively.vm-editor-add-module-name"}),2);case 2:za=ya.yieldResult;if(!za)throw"Canceled";return ya.yield(Kb.normalize(za),
3);case 3:return P=ya.yieldResult,ya.yield(bb.confirm(["Create module \n",{},P,{fontStyle:"italic"}," ?",{}],{lineWrapping:!1}),4);case 4:X=ya.yieldResult;if(!X)throw"Canceled";return ya.return(P)}})};bc._searchForExistingFiles=function(Kb,za,bb){return $jscomp.asyncExecutePromiseGeneratorProgram(function(P){return String(za).match(/^http/)?P.return(bc._searchForExistingFilesWeb(Kb,za,bb)):P.return(bc._searchForExistingFilesManually(Kb,za,bb))})};bc._searchForExistingFilesManually=function(Kb,za,
bb){var P,X;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){switch(ya.nextAddress){case 1:return ya.yield(Kb.world().multipleChoicePrompt("Add Module",{requester:Kb,choices:["Create New Module","Load Existing Module"]}),2);case 2:P=ya.yieldResult;if("Create New Module"===P)return ya.return("[create new module]");if("Load Existing Module"!==P){ya.jumpTo(3);break}return ya.yield(Kb.world().prompt("URL of module?",{input:za,requester:Kb,historyId:"lively.vm._searchForExistingFilesManually.url-of-module"}),
4);case 4:if(X=ya.yieldResult)return ya.return([X]);case 3:throw"Canceled";}})};bc._searchForExistingFilesWeb=function(Kb,za,bb){function P(Ja){Ja.name();return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes(Ja.name())||bb&&bc.arr.pluck(bb.modules,"name").includes(Ja.url)?!0:!1}var X,ya,Ga,wa,ja,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){switch(Ja.nextAddress){case 1:return(X=Kb.world())&&(ya=X.showLoadingIndicatorFor(Kb,"Loading existing modules...")),
Ja.yield(bc.resource(za).dirList(5,{exclude:P}),3);case 3:return Ja.yield(Ja.yieldResult.map(function(Xb){return Xb.url}),2);case 2:return Ga=Ja.yieldResult,wa=[{isListItem:!0,string:"[create new module]",value:"[create new module]"}].concat(Ga.filter(function(Xb){return Xb.endsWith(".js")}).map(function(Xb){return{isListItem:!0,string:bb&&0==Xb.indexOf(bb.address)?bb.name+Xb.slice(bb.address.length):Xb,value:Xb}})),Ja.yield(Promise.resolve(ya&&ya.remove()).then(function(){return Kb.world().filterableListPrompt("What module to load?",
wa,Object.assign({filterLabel:"filter: ",multiselect:!0,requester:Kb},Kb?{extent:Kb.bounds().extent().withY(400).subXY(50,0)}:{}))}),4);case 4:ja=Ja.yieldResult;if(!ja||"canceled"===ja.status||!ja.selected.length)throw"Canceled";lb=ja.selected||ja;Array.isArray(lb)||(lb=[lb]);return Ja.return(lb)}})};bc._createAndLoadModules=function(Kb,za){var bb,P,X,ya,Ga,wa,ja,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){switch(Ja.nextAddress){case 1:Array.isArray(za)||(za=[za]),bb=[],P=$jscomp.makeIterator(za),
X=P.next();case 2:if(X.done){Ja.jumpTo(4);break}ya=X.value;return Ja.yield(Kb.forgetModule(ya,{forgetDeps:!1,forgetEnv:!1}),5);case 5:return Ja.yield(Kb.resourceEnsureExistance(ya,'"format esm";\n'),6);case 6:return Ga=Ja.yieldResult,wa=bc,ja=wa.isTestModule,Ja.yield(Ga.read(),7);case 7:if(!ja.call(wa,Ja.yieldResult)){Ja.jumpTo(8);break}if(window.Mocha&&window.chai){Ja.jumpTo(8);break}return Ja.yield(System.import("mocha-es6"),10);case 10:return Ja.yield(bc.promise.waitFor(function(){return!!window.Mocha&&
!!window.chai}),8);case 8:return Ja.setCatchFinallyBlocks(12),Ja.yield(Kb.importModule(ya),14);case 14:bb.push({name:ya});Ja.leaveTryBlock(3);break;case 12:lb=Ja.enterCatchBlock(),bb.push({name:ya,error:lb});case 3:X=P.next();Ja.jumpTo(2);break;case 4:return Ja.return(bb)}})};bc.modulesInPackage_defaultExclude=function(Kb){return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes(Kb.name())?!0:!1};bc.modulesInPackage=fb;bc.obj=Eb;bc.promise=Jc;bc.arr=vb;bc.resource=Vb;bc.isTestModule=
wd;bc.isTestModule=wd;bc.shortModuleName=xb;bc.shortModuleName=xb;bc.interactivelyChangeModule=hc;bc.interactivelyChangeModule=hc;bc.interactivelyReloadModule=Cc;bc.interactivelyReloadModule=Cc;bc.interactivelyUnloadModule=ic;bc.interactivelyUnloadModule=ic;bc.interactivelyRemoveModule=Qc;bc.interactivelyRemoveModule=Qc;bc.interactivelyAddModule=jb;bc.interactivelyAddModule=jb;bc.modulesInPackage=fb;bc.modulesInPackage=fb;var Ma=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/interface.js");
Ma.todo=function(Kb){throw Error(Kb+" is not yet implemented!");};Ma.parseJsonLikeObj=Dc;Ma.arr=vb;Ma.Closure=Bc;Ma.obj=Eb;Ma.resource=Vb;Ma.transform=Uc;Ma.modules=tc;var Db=function(Kb){var za=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/interface.js"),bb=za.hasOwnProperty("AbstractCoreInterface")&&"function"===typeof za.AbstractCoreInterface?za.AbstractCoreInterface:za.AbstractCoreInterface=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return oc(bb,Kb,[{key:"dynamicCompletionsForPrefix",value:function(P,X,ya){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){Ma.todo("dynamicCompletionsForPrefix");Ga.jumpToEnd()})}},{key:"runEval",value:function(P,X){Ma.todo("runEval")}},{key:"resourceExists",value:function(P){Ma.todo("resourceExists")}},{key:"resourceEnsureExistance",value:function(P,X){Ma.todo("resourceEnsureExistance")}},{key:"resourceMkdir",value:function(P){Ma.todo("resourceMkdir")}},{key:"resourceRead",
value:function(P){Ma.todo("resourceRead")}},{key:"resourceRemove",value:function(P){Ma.todo("resourceRemove")}},{key:"resourceWrite",value:function(P,X){Ma.todo("resourceWrite")}},{key:"resourceCreateFiles",value:function(P,X){Ma.todo("resourceCreateFiles")}},{key:"resourceDirList",value:function(P,X,ya){Ma.todo("resourceDirList")}},{key:"normalizeSync",value:function(P,X,ya){Ma.todo("normalizeSync")}},{key:"normalize",value:function(P,X,ya){Ma.todo("normalize")}},{key:"printSystemConfig",value:function(){Ma.todo("printSystemConfig")}},
{key:"getConfig",value:function(){Ma.todo("getConfig")}},{key:"setConfig",value:function(P){Ma.todo("setConfig")}},{key:"getPackages",value:function(P){Ma.todo("getPackages")}},{key:"isModuleLoaded",value:function(P,X){Ma.todo("isModuleLoaded")}},{key:"doesModuleExist",value:function(P,X){Ma.todo("doesModuleExist")}},{key:"getModules",value:function(){var P=this,X,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){return 1==Ga.nextAddress?(X=Ma.arr,ya=X.flatmap,Ga.yield(P.getPackages(),
2)):Ga.return(ya.call(X,Ga.yieldResult,function(wa){return wa.modules}))})}},{key:"getModule",value:function(P){var X=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return 1==ya.nextAddress?ya.yield(X.getModules(),2):ya.return(ya.yieldResult.find(function(Ga){return Ga.name===P}))})}},{key:"getPackage",value:function(P){var X=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return 1==ya.nextAddress?(P=P.replace(/\/+$/,""),ya.yield(X.getPackages(),2)):ya.return(ya.yieldResult.find(function(Ga){return Ga.address===
P||Ga.name===P}))})}},{key:"getPackageForModule",value:function(P){return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){Ma.todo("getPackageForModule");X.jumpToEnd()})}},{key:"systemConfChange",value:function(P){var X=Ma.parseJsonLikeObj(P);["baseURL"].forEach(function(ya){return delete X[ya]});return this.setConfig(X)}},{key:"resourcesOfPackage",value:function(P,X){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){Ma.todo("resourcesOfPackage");ya.jumpToEnd()})}},{key:"registerPackage",
value:function(P){return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){Ma.todo("registerPackage");X.jumpToEnd()})}},{key:"importPackage",value:function(P){return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){Ma.todo("importPackage");X.jumpToEnd()})}},{key:"removePackage",value:function(P){return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){Ma.todo("removePackage");X.jumpToEnd()})}},{key:"reloadPackage",value:function(P){return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){Ma.todo("reloadPackage");
X.jumpToEnd()})}},{key:"packageConfChange",value:function(P,X){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){Ma.todo("packageConfChange");ya.jumpToEnd()})}},{key:"importModule",value:function(P){Ma.todo("importModule")}},{key:"forgetModule",value:function(P,X){Ma.todo("forgetModule")}},{key:"reloadModule",value:function(P,X){Ma.todo("reloadModule")}},{key:"moduleFormat",value:function(P){Ma.todo("moduleFormat")}},{key:"moduleRead",value:function(P){Ma.todo("moduleRead")}},{key:"moduleSourceChange",
value:function(P,X,ya){Ma.todo("moduleSourceChange")}},{key:"importsAndExportsOf",value:function(P,X){Ma.todo("importsAndExportsOf")}},{key:"keyValueListOfVariablesInModule",value:function(P,X){Ma.todo("keyValueListOfVariablesInModule")}},{key:"moduleWrite",value:function(P,X){return this.moduleSourceChange(P,X)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"AbstractCoreInterface"}}],za,{pathInPackage:function(){return"interfaces/interface.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively-system-interface",version:"0.2.1"}}},{start:327,end:3944})}(void 0);Ma.AbstractCoreInterface=Db;Ma.AbstractCoreInterface=Db;Ma.AbstractCoreInterface=Db;var gb=function(Kb){var za=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/interface.js"),bb=za.hasOwnProperty("RemoteCoreInterface")&&"function"===typeof za.RemoteCoreInterface?za.RemoteCoreInterface:za.RemoteCoreInterface=
function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return oc(bb,Kb,[{key:Symbol.for("lively-instance-initialize"),value:function(){oc._get(Object.getPrototypeOf(bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.currentEval=null}},{key:"runEval",value:function(P,X){throw Error("Not yet implemented");}},{key:"runEvalAndStringify",value:function(P,X){var ya=this;return this.currentEval?this.currentEval.then(function(){return ya.runEvalAndStringify(P,
X)}):this.currentEval=Promise.resolve().then(function(){var Ga,wa,ja,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){switch(Ja.nextAddress){case 1:return Ja.yield(ya.runEval("\n        Promise.resolve((async "+Ma.transform.wrapInFunction(P)+')())\n          .then(function(result) { return JSON.stringify(result); })\n          .catch(function(err) { return {isError: true, value: err}; })\n          .then(function(result) {\n            if (!result || typeof result === "string") return result;\n            return JSON.stringify(result.isError ?\n              {isError: true, value: (result.value + "\\n" + result.value.stack) || String(result.value)} :\n              result)\n          });',
Object.assign({targetModule:"lively://remote-lively-system/runEvalAndStringify",promiseTimeout:3E4,waitForPromise:!0},X)),2);case 2:if((Ga=Ja.yieldResult)&&Ga.isError)throw Error(String(Ga.value||Ga.error));if(!Ga||!Ga.value)return Ja.return(null);if(wa=Ga.promisedValue){Ja.jumpTo(3);break}return Ja.yield(Ga.value,4);case 4:wa=Ja.yieldResult;case 3:ja=wa;if(!ja)return Ja.return();if("undefined"===ja)return Ja.return(void 0);if("null"===ja)return Ja.return(null);if("true"===ja)return Ja.return(!0);
if("false"===ja)return Ja.return(!1);try{lb=JSON.parse(ja)}catch(Xb){return Ja.return(ja)}if(lb&&lb.isError)throw Error(String(lb.value));return Ja.return(lb)}})}).then(function(Ga){delete ya.currentEval;return Ga},function(Ga){delete ya.currentEval;return Promise.reject(Ga)})}},{key:"dynamicCompletionsForPrefix",value:function(P,X,ya){var Ga=this,wa,ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){wa=Ma.obj.isString(ya.context)?ya.context:!1;ya=Ma.obj.dissoc(ya,["systemInterface",
"System","context"]);ja="\n      var prefix = "+JSON.stringify(X)+",\n          opts = "+JSON.stringify(ya)+";\n      opts.context = "+wa+';\n      opts.classTransform = (await System.import("lively.classes")).classToFunctionTransform;\n      var evalFn = code => lively.vm.runEval(code, opts);\n      if (typeof System === "undefined") delete opts.targetModule;\n      lively.vm.completions.getCompletions(evalFn, prefix).then(function(result) {\n        if (result.isError) throw result.value;\n        return {\n          completions: result.completions,\n          prefix: result.startLetters\n        }\n      });';
return lb.return(Ga.runEvalAndStringify(ja))})}},{key:"evalWithResource",value:function(P,X,ya){return this.runEvalAndStringify('\n      var {resource} = (typeof lively !== "undefined" && lively.resources)\n                    || await System.import("lively.resources");\n      await resource("'+P+'").'+X+"("+(ya?JSON.stringify(ya):"")+");\n    ")}},{key:"resourceExists",value:function(P){return this.evalWithResource(P,"exists")}},{key:"resourceEnsureExistance",value:function(P,X){return this.evalWithResource(P,
"ensureExistance",X)}},{key:"resourceMkdir",value:function(P){return this.evalWithResource(P,"mkdir")}},{key:"resourceRead",value:function(P){return this.evalWithResource(P,"read")}},{key:"resourceRemove",value:function(P){return this.evalWithResource(P,"remove")}},{key:"resourceWrite",value:function(P,X){return this.evalWithResource(P,"write",X)}},{key:"resourceCreateFiles",value:function(P,X){return this.runEvalAndStringify('var {createFiles} = await System.import("lively.resources"); await createFiles("'+
P+'", '+JSON.stringify(X)+")")}},{key:"resourceDirList",value:function(P,X,ya){return this.runEvalAndStringify('\n      var {resource} = await System.import("lively.resources");\n      (await resource("'+P+'").dirList('+JSON.stringify(X)+", "+JSON.stringify(ya)+"))\n        .map(({url}) => ({url}))")}},{key:"livelySystemAccessor",value:function(P){P=void 0===P?"livelySystem":P;return"var "+P+' = (typeof lively !== "undefined" && lively.systemInterface)\n      || System.get(System.decanonicalize("lively-system-interface"))\n      || (typeof lively !== "undefined" && lively.modules && await lively.modules.importPackage("lively-system-interface"));\n    if (!'+
P+') throw new Error("lively-system-interface not available!");'}},{key:"normalizeSync",value:function(P,X,ya){return this.runEvalAndStringify("lively.modules.System.decanonicalize("+JSON.stringify(P)+", "+JSON.stringify(X)+", "+ya+")")}},{key:"normalize",value:function(P,X,ya){return this.runEvalAndStringify("lively.modules.System.normalize("+JSON.stringify(P)+", "+JSON.stringify(X)+", "+JSON.stringify(ya)+")")}},{key:"printSystemConfig",value:function(){return this.runEvalAndStringify("lively.modules.printSystemConfig()")}},
{key:"getConfig",value:function(){return this.runEvalAndStringify('var c = Object.assign({}, lively.modules.System.getConfig()); for (var name in c) if (name.indexOf("__lively.modules__") === 0 || name.indexOf("loads") === 0) delete c[name]; c')}},{key:"setConfig",value:function(P){return this.runEvalAndStringify("lively.modules.System.config("+JSON.stringify(P)+")")}},{key:"getPackages",value:function(P){P=Object.assign({excluded:[]},P);P.excluded=P.excluded.map(String);return this.runEvalAndStringify("\n      "+
this.livelySystemAccessor()+";\n      var options = "+JSON.stringify(P)+';\n      options.excluded = options.excluded.map(ea => {\n        let evaled = lively.vm.syncEval(ea).value;\n        return typeof evaled === "function" ? evaled : ea;\n      });\n      await livelySystem.localInterface.getPackages(options)\n        .map(ea => Object.assign({}, ea, {System: null}));')}},{key:"getPackageForModule",value:function(P){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.getPackageForModule("+
JSON.stringify(P)+")")}},{key:"isModuleLoaded",value:function(P,X){return this.runEvalAndStringify('lively.modules.isModuleLoaded("'+P+'", '+X+")")}},{key:"doesModuleExist",value:function(P,X){return this.runEvalAndStringify('lively.modules.doesModuleExist("'+P+'", '+X+")")}},{key:"registerPackage",value:function(P){var X=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return ya.return(X.runEvalAndStringify("lively.modules.registerPackage("+JSON.stringify(P)+")"))})}},{key:"importPackage",
value:function(P){var X=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return ya.return(X.runEvalAndStringify("lively.modules.importPackage("+JSON.stringify(P)+")"))})}},{key:"removePackage",value:function(P){var X=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return ya.return(X.runEvalAndStringify("lively.modules.removePackage("+JSON.stringify(P)+")"))})}},{key:"reloadPackage",value:function(P,X){var ya=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){return Ga.return(ya.runEvalAndStringify("lively.modules.reloadPackage("+
JSON.stringify(P)+", "+JSON.stringify(X)+")"))})}},{key:"packageConfChange",value:function(P,X){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.packageConfChange("+JSON.stringify(P)+", "+JSON.stringify(X)+")")}},{key:"resourcesOfPackage",value:function(P,X){X=void 0===X?[".git","node_modules",".module_cache","lively.next-node_modules"]:X;var ya=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){P.address&&(P=P.address);
return Ga.return(ya.runEvalAndStringify("\n      "+ya.livelySystemAccessor()+";\n      await livelySystem.localInterface.resourcesOfPackage("+JSON.stringify(P)+", "+JSON.stringify(X)+");"))})}},{key:"getModule",value:function(P){var X=this,ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){if(1==Ga.nextAddress)return Ga.yield(X.getModules(),2);ya=Ga.yieldResult.find(function(wa){return wa.name===P});return Ga.return(ya?Ma.modules.module(ya.name):null)})}},{key:"importModule",value:function(P){return this.runEvalAndStringify("lively.modules.System.import("+
JSON.stringify(P)+")")}},{key:"forgetModule",value:function(P,X){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(P)+").unload("+JSON.stringify(X)+")")}},{key:"reloadModule",value:function(P,X){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(P)+").reload("+JSON.stringify(X)+")")}},{key:"moduleFormat",value:function(P){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(P)+").format();")}},{key:"moduleRead",value:function(P){return this.runEvalAndStringify("lively.modules.module("+
JSON.stringify(P)+").source()")}},{key:"moduleSourceChange",value:function(P,X,ya){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(P)+").changeSource("+JSON.stringify(X)+", "+JSON.stringify(ya)+")")}},{key:"keyValueListOfVariablesInModule",value:function(P,X){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.keyValueListOfVariablesInModule("+JSON.stringify(P)+", "+JSON.stringify(X)+")")}},{key:"importsAndExportsOf",
value:function(P,X){return this.runEvalAndStringify("({\n      imports: await lively.modules.module("+JSON.stringify(P)+").imports(),\n      exports: await lively.modules.module("+JSON.stringify(P)+").exports()})")}},{key:"exportsOfModules",value:function(P){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+"\n      const options = "+JSON.stringify(P)+";\n      options.excludedPackages = ["+P.excludedPackages.map(function(X){return"function"===typeof X?X.toString():JSON.stringify(X)}).join(",")+
"]\n      await livelySystem.localInterface.exportsOfModules(options)")}},{key:"searchInPackage",value:function(P,X,ya){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.searchInPackage("+JSON.stringify(P)+", "+JSON.stringify(X)+", "+JSON.stringify(ya)+")")}},{key:"loadMochaTestFile",value:function(P,X){X=void 0===X?[]:X;var ya=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){return Ga.return(ya.runEvalAndStringify("\n      "+
ya.livelySystemAccessor()+";\n      var {testsByFile} = await livelySystem.localInterface.loadMochaTestFile("+JSON.stringify(P)+", "+JSON.stringify(X)+"), result;\n      result = {testsByFile}"))})}},{key:"runMochaTests",value:function(P,X,ya,Ga){var wa=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ja){P&&P instanceof RegExp&&(P={isRegExp:!0,value:String(P).replace(/^\/|\/$/g,"")});return ja.return(wa.runEvalAndStringify("\n      var grep = "+JSON.stringify(P)+";\n      if (grep && grep.isRegExp) grep = new RegExp(grep.value);\n      "+
wa.livelySystemAccessor()+";\n      var {testsByFile, isError, value: error} = await livelySystem.localInterface.runMochaTests(grep, "+JSON.stringify(X||[])+"), result;\n      error = error ? String(error.stack || error) : null;\n      if (testsByFile) {\n        testsByFile.forEach(ea =>\n          ea.tests.forEach(ea => {\n            if (!ea.error) return;\n            var {message, stack, actual, expected} = ea.error;\n            ea.error = {\n              message: message || String(ea.error),\n              stack: stack,\n              actual, exected\n            }\n          }));\n      }\n      result = {testsByFile, isError, error}"))})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteCoreInterface"}}],za,{pathInPackage:function(){return"interfaces/interface.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively-system-interface",version:"0.2.1"}}},{start:3953,end:16249})}(Ma.AbstractCoreInterface);Ma.RemoteCoreInterface=gb;Ma.RemoteCoreInterface=gb;Ma.RemoteCoreInterface=gb;var zb=
lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/local-system.js");zb.obj=Eb;zb.string=sc;zb.arr=vb;zb.resource=Vb;zb.createFiles=Tc;zb.ast=mb;zb.modules=tc;zb.vm=Fd;zb.parseJsonLikeObj=Dc;zb.AbstractCoreInterface=Db;zb.classToFunctionTransform=Rd;Db=function(Kb){var za=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/local-system.js"),bb=za.hasOwnProperty("LocalCoreInterface")&&"function"===typeof za.LocalCoreInterface?za.LocalCoreInterface:za.LocalCoreInterface=
function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return oc(bb,Kb,[{key:"name",get:function(){return"local"}},{key:"dynamicCompletionsForPrefix",value:function(P,X,ya){var Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){if(1==wa.nextAddress)return wa.yield(zb.vm.completions.getCompletions(function(ja){return zb.vm.runEval(ja.replace("return ",""),Object.assign({targetModule:P,classTransform:zb.classToFunctionTransform},
ya))},X),2);Ga=wa.yieldResult;if(Ga.isError)throw Ga.value;return wa.return({completions:Ga.completions,prefix:Ga.startLetters})})}},{key:"runEval",value:function(P,X){return zb.vm.runEval(P,Object.assign({classTransform:zb.classToFunctionTransform},X))}},{key:"resourceExists",value:function(P){return zb.resource(P).exists()}},{key:"resourceEnsureExistance",value:function(P,X){return zb.resource(P).ensureExistance(X)}},{key:"resourceMkdir",value:function(P){return zb.resource(P).mkdir()}},{key:"resourceRead",
value:function(P){return zb.resource(P).read()}},{key:"resourceRemove",value:function(P){return zb.resource(P).remove()}},{key:"resourceWrite",value:function(P,X){return zb.resource(P).write(X)}},{key:"resourceCreateFiles",value:function(P,X){return zb.createFiles(P,X)}},{key:"resourceDirList",value:function(P,X,ya){return zb.resource(P).dirList(X,ya)}},{key:"normalizeSync",value:function(P,X,ya){return System.decanonicalize(P,X,ya)}},{key:"normalize",value:function(P,X,ya){return System.normalize(P,
X,ya)}},{key:"printSystemConfig",value:function(){return zb.modules.printSystemConfig()}},{key:"getConfig",value:function(){return System.getConfig()}},{key:"setConfig",value:function(P){zb.modules.System.config(P)}},{key:"getPackages",value:function(P){P=Object.assign({},P);P=void 0===P.excluded?[]:P.excluded;var X=P.filter(function(Ga){return"string"===typeof Ga}),ya=P.filter(function(Ga){return"function"===typeof Ga});X=X.concat(X.map(function(Ga){return System.decanonicalize(Ga.replace(/\/?$/,
"/")).replace(/\/$/,"")}));return zb.modules.getPackages().filter(function(Ga){return!X.includes(Ga.url)&&!ya.some(function(wa){return wa(Ga.url)})})}},{key:"registerPackage",value:function(P){return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){return X.return(zb.modules.registerPackage(P))})}},{key:"importPackage",value:function(P){return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){return X.return(zb.modules.importPackage(P))})}},{key:"removePackage",value:function(P){return $jscomp.asyncExecutePromiseGeneratorProgram(function(X){return X.return(zb.modules.removePackage(P))})}},
{key:"reloadPackage",value:function(P,X){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ya){return ya.return(zb.modules.reloadPackage(P,X))})}},{key:"packageConfChange",value:function(P,X){var ya=this,Ga,wa,ja,lb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){if(1==Ja.nextAddress)return Ga=zb.modules.System,wa=zb.parseJsonLikeObj(P),ja=JSON.stringify(wa,null,2),Ja.yield(zb.modules.module(X).changeSource(ja,{doEval:!1}),2);if(3!=Ja.nextAddress)return Ga.set(X,Ga.newModule(wa)),
Ja.yield(ya.getPackageForModule(X),3);(lb=Ja.yieldResult)&&zb.modules.applyPackageConfig(wa,lb.address);Ja.jumpToEnd()})}},{key:"resourcesOfPackage",value:function(P,X){X=void 0===X?[".git","node_modules",".module_cache"]:X;var ya,Ga,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ja){if(1==ja.nextAddress)return ja.setCatchFinallyBlocks(2),ya=P.address?P.address:P,Ga=zb.modules.getPackage(ya),ja.yield(Ga.resources(void 0,X),4);if(2!=ja.nextAddress)return ja.return(ja.yieldResult.map(function(lb){return Object.assign(lb,
{package:lb.package.url})}));wa=ja.enterCatchBlock();console.warn("resourcesOfPackage error for "+P+": "+wa);return ja.return([])})}},{key:"getPackageForModule",value:function(P){return(P=zb.modules.getPackageOfModule(P))?P.asSpec():P}},{key:"isModuleLoaded",value:function(P,X){return zb.modules.isModuleLoaded(P,X)}},{key:"doesModuleExist",value:function(P,X){return zb.modules.isModuleLoaded(P,X)}},{key:"getModule",value:function(P){return zb.modules.module(P)}},{key:"importModule",value:function(P){return zb.modules.System.import(P)}},
{key:"forgetModule",value:function(P,X){return zb.modules.module(P).unload(X)}},{key:"reloadModule",value:function(P,X){return zb.modules.module(P).reload(X)}},{key:"moduleFormat",value:function(P){return zb.modules.module(P).format()}},{key:"moduleRead",value:function(P){return zb.modules.module(P).source()}},{key:"moduleSourceChange",value:function(P,X,ya){return zb.modules.module(P).changeSource(X,ya)}},{key:"keyValueListOfVariablesInModule",value:function(P,X){var ya=this,Ga,wa,ja,lb,Ja,Xb,Kc,
Hb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oc){switch(Oc.nextAddress){case 1:if(X){Oc.jumpTo(2);break}return Oc.yield(ya.resourceRead(P),3);case 3:X=Oc.yieldResult;case 2:return Ga="string"===typeof X?zb.ast.parse(X):X,wa=ya.normalizeSync(P),ya.moduleFormat(wa),ja=zb.modules.module(wa).env().recorder,Oc.yield(ya.importsAndExportsOf(wa,Ga),4);case 4:return lb=Oc.yieldResult,Ja=zb.ast.query.topLevelDeclsAndRefs(Ga),Xb=zb.arr.sortByKey(zb.ast.query.declarationsOfScope(Ja.scope,!0),
"start"),Kc=zb.arr.pluck(Ja.scope.importSpecifiers,"name"),Hb=0,Oc.return(Xb.map(function(qb){var xd=qb.name.length,he=lb.exports.find(function(rb){return rb.local===qb.name}),xc=zb.arr.include(Kc,qb.name);he&&(xd+=9);xc&&(xd+=9);Hb=Math.max(Hb,xd);return{isExport:he,isImport:xc,name:qb.name,value:ja[qb.name],node:qb,printedName:qb.name+(he?" [export]":"")+(xc?" [import]":""),printedValue:zb.obj.inspect(ja[qb.name],{maxDepth:1}).replace(/\n/g,"")}}).map(function(qb){return{isListItem:!0,value:qb,
string:qb.printedName+zb.string.indent(" = "+qb.printedValue," ",Hb-qb.printedName.length)}}))}})}},{key:"importsAndExportsOf",value:function(P,X){var ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ga){return 1==Ga.nextAddress?Ga.yield(zb.modules.module(P).imports(X),2):3!=Ga.nextAddress?(ya=Ga.yieldResult,Ga.yield(zb.modules.module(P).exports(X),3)):Ga.return({imports:ya,exports:Ga.yieldResult})})}},{key:"exportsOfModules",value:function(P){return zb.modules.ExportLookup.run(System,
P)}},{key:"searchInPackage",value:function(P,X,ya){return zb.modules.getPackage(P).search(X,ya)}},{key:"runMochaTests",value:function(P,X,ya,Ga){var wa,ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){if(1==lb.nextAddress)return lb.yield(System.import("lively-system-interface/commands/mocha-tests.js"),2);wa=lb.yieldResult;ja=wa.runMochaTests;return lb.return(ja(P,X,ya,Ga))})}},{key:"loadMochaTestFile",value:function(P,X){var ya,Ga;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){if(1==
wa.nextAddress)return wa.yield(System.import("lively-system-interface/commands/mocha-tests.js"),2);ya=wa.yieldResult;Ga=ya.loadMochaTestFile;return wa.return(Ga(P,X))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"LocalCoreInterface"}}],za,{pathInPackage:function(){return"interfaces/local-system.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively-system-interface",
version:"0.2.1"}}},{start:411,end:8203})}(zb.AbstractCoreInterface);zb.LocalCoreInterface=Db;zb.LocalCoreInterface=Db;zb.LocalCoreInterface=Db;var ec=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/http-interface.js");ec.evalStrategies=ee;ec.RemoteCoreInterface=gb;var rc=function(Kb){var za=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/http-interface.js"),bb=za.hasOwnProperty("HTTPCoreInterface")&&"function"===typeof za.HTTPCoreInterface?za.HTTPCoreInterface:
za.HTTPCoreInterface=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return oc(bb,Kb,[{key:Symbol.for("lively-instance-initialize"),value:function(P){oc._get(Object.getPrototypeOf(bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.currentEval=null;this.url=P;this.server=new ec.evalStrategies.HttpEvalStrategy(P)}},{key:"name",get:function(){return this.url}},{key:"description",get:function(){return this.url.replace(/^https?:\/\//,
"")}},{key:"runEval",value:function(P,X){return this.server.runEval(P,X)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"HTTPCoreInterface"}}],za,{pathInPackage:function(){return"interfaces/http-interface.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively-system-interface",version:"0.2.1"}}},{start:106,end:512})}(ec.RemoteCoreInterface);ec.HTTPCoreInterface=
rc;ec.HTTPCoreInterface=rc;ec.HTTPCoreInterface=rc;var Qb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/l2l-interface.js");Qb.evalStrategies=ee;Qb.RemoteCoreInterface=gb;gb=function(Kb){var za=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/l2l-interface.js"),bb=za.hasOwnProperty("L2LCoreInterface")&&"function"===typeof za.L2LCoreInterface?za.L2LCoreInterface:za.L2LCoreInterface=function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return oc(bb,Kb,[{key:Symbol.for("lively-instance-initialize"),value:function(P,X){oc._get(Object.getPrototypeOf(bb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.targetId=P;this.peer=X}},{key:"name",get:function(){return"l2l "+this.targetId}},{key:"description",get:function(){var P=this.peer,X="l2l "+this.targetId.slice(0,5);if(P){var ya=P.location,Ga=P.type,wa=P.user;P=P.world;Ga&&(X+=", "+Ga);ya&&(X+=", "+ya.replace(/^https?:\/\//,"")+(P?"/"+P:""));wa&&(X+=
", "+wa.name)}return X}},{key:"client",get:function(){return(lively.modules.module("lively.2lively/client.js").get()||{default:lively.l2l.L2LClient}).default.default()}},{key:"isConnected",value:function(){var P=this,X,ya,Ga,wa,ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){if(1==lb.nextAddress)return X=P,ya=X.client,Ga=X.targetId,lb.yield(ya.sendToAndWait(ya.trackerId,"getClients",{}),2);wa=lb.yieldResult;ja=wa.data;return lb.return(ja.some(function(Ja){Ja=$jscomp.makeIterator(Ja).next().value;
return Ga===Ja}))})}},{key:"runEval",value:function(P,X){var ya=this,Ga,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ja){Ga=ya.client;if(!Ga)throw Error("No lively.2lively default client available!");wa=new Qb.evalStrategies.L2LEvalStrategy(Ga,ya.targetId);return ja.return(wa.runEval(P,X))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"L2LCoreInterface"}}],za,{pathInPackage:function(){return"interfaces/l2l-interface.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively-system-interface",version:"0.2.1"}}},{start:106,end:1449})}(Qb.RemoteCoreInterface);Qb.L2LCoreInterface=gb;Qb.L2LCoreInterface=gb;Qb.L2LCoreInterface=gb;var Lb=lively.FreezerRuntime.recorderFor("lively-system-interface/index.js");Lb.systemInterfaceNamed=Ob;Lb.interactivelyCreatePackage=rd;Lb.interactivelyLoadPackage=Ab;Lb.interactivelyReloadPackage=qc;Lb.interactivelyUnloadPackage=Xc;Lb.interactivelyRemovePackage=
zc;Lb.showExportsAndImportsOf=ed;Lb.shortModuleName=xb;Lb.interactivelyChangeModule=hc;Lb.interactivelyReloadModule=Cc;Lb.interactivelyUnloadModule=ic;Lb.interactivelyRemoveModule=Qc;Lb.interactivelyAddModule=jb;Lb.modulesInPackage=fb;Lb.LocalCoreInterface=Db;Lb.HTTPCoreInterface=rc;Lb.L2LCoreInterface=gb;gb=Ia("Interface",function(Kb){var za=lively.FreezerRuntime.recorderFor("lively-system-interface/index.js"),bb=za.hasOwnProperty("Interface")&&"function"===typeof za.Interface?za.Interface:za.Interface=
function(P){P&&P[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return oc(bb,Kb,[{key:Symbol.for("lively-instance-initialize"),value:function(P){this.coreInterface=P}},{key:"isSystemInterface",get:function(){return!0}},{key:"name",get:function(){return this.coreInterface.name}},{key:"dynamicCompletionsForPrefix",value:function(P,X,ya){return this.coreInterface.dynamicCompletionsForPrefix(P,X,ya)}},{key:"runEval",value:function(P,X){return this.coreInterface.runEval(P,
X)}},{key:"printSystemConfig",value:function(P,X,ya){return this.coreInterface.printSystemConfig(P,X,ya)}},{key:"getConfig",value:function(P,X,ya){return this.coreInterface.getConfig(P,X,ya)}},{key:"getPackages",value:function(P){return this.coreInterface.getPackages(P)}},{key:"getModules",value:function(P,X,ya){return this.coreInterface.getModules(P,X,ya)}},{key:"getModule",value:function(P,X,ya){return this.coreInterface.getModule(P,X,ya)}},{key:"getPackage",value:function(P,X,ya){return this.coreInterface.getPackage(P,
X,ya)}},{key:"getPackageForModule",value:function(P,X,ya){return this.coreInterface.getPackageForModule(P,X,ya)}},{key:"resourcesOfPackage",value:function(P,X){return this.coreInterface.resourcesOfPackage(P,X)}},{key:"systemConfChange",value:function(P,X,ya){return this.coreInterface.systemConfChange(P,X,ya)}},{key:"registerPackage",value:function(P){return this.coreInterface.registerPackage(P)}},{key:"importPackage",value:function(P){return this.coreInterface.importPackage(P)}},{key:"removePackage",
value:function(P){return this.coreInterface.removePackage(P)}},{key:"reloadPackage",value:function(P){return this.coreInterface.reloadPackage(P)}},{key:"packageConfChange",value:function(P,X){return this.coreInterface.packageConfChange(P,X)}},{key:"keyValueListOfVariablesInModule",value:function(P,X){return this.coreInterface.keyValueListOfVariablesInModule(P,X)}},{key:"interactivelyCreatePackage",value:function(P){return Lb.interactivelyCreatePackage(this.coreInterface,P)}},{key:"interactivelyLoadPackage",
value:function(P,X){return Lb.interactivelyLoadPackage(this.coreInterface,P,X)}},{key:"interactivelyReloadPackage",value:function(P,X){return Lb.interactivelyReloadPackage(this.coreInterface,P,X)}},{key:"interactivelyUnloadPackage",value:function(P,X,ya){return Lb.interactivelyUnloadPackage(this.coreInterface,P,X,ya)}},{key:"interactivelyRemovePackage",value:function(P,X){return Lb.interactivelyRemovePackage(this.coreInterface,P,X)}},{key:"isModuleLoaded",value:function(P,X){return this.coreInterface.isModuleLoaded(P,
X)}},{key:"doesModuleExist",value:function(P,X){return this.coreInterface.doesModuleExist(P,X)}},{key:"importModule",value:function(P){return this.coreInterface.importModule(P)}},{key:"forgetModule",value:function(P,X){return this.coreInterface.forgetModule(P,X)}},{key:"reloadModule",value:function(P,X){return this.coreInterface.reloadModule(P,X)}},{key:"moduleFormat",value:function(P){return this.coreInterface.moduleFormat(P)}},{key:"moduleRead",value:function(P){return this.coreInterface.moduleRead(P)}},
{key:"moduleWrite",value:function(P,X){return this.coreInterface.moduleWrite(P,X)}},{key:"getModulesInPackage",value:function(P){return Lb.modulesInPackage(this.coreInterface,P)}},{key:"shortModuleName",value:function(P,X){return Lb.shortModuleName(this.coreInterface,P,X)}},{key:"interactivelyChangeModule",value:function(P,X,ya){return Lb.interactivelyChangeModule(this.coreInterface,P,X,ya)}},{key:"interactivelyReloadModule",value:function(P,X){return Lb.interactivelyReloadModule(this.coreInterface,
P,X)}},{key:"interactivelyUnloadModule",value:function(P,X){return Lb.interactivelyUnloadModule(this.coreInterface,P,X)}},{key:"interactivelyRemoveModule",value:function(P,X){return Lb.interactivelyRemoveModule(this.coreInterface,P,X)}},{key:"interactivelyAddModule",value:function(P,X){return Lb.interactivelyAddModule(this.coreInterface,P,X)}},{key:"showExportsAndImportsOf",value:function(P,X){return Lb.showExportsAndImportsOf(this.coreInterface,P,X)}},{key:"exportsOfModules",value:function(P){return this.coreInterface.exportsOfModules(P)}},
{key:"searchInPackage",value:function(P,X,ya){return this.coreInterface.searchInPackage(P,X,ya)}},{key:"searchInAllPackages",value:function(P,X){X=void 0===X?{}:X;var ya=this,Ga,wa,ja,lb,Ja,Xb,Kc,Hb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oc){switch(Oc.nextAddress){case 1:return(Ga=X.progress)&&Ga.step("Fetching Packages...",0),Oc.yield(ya.coreInterface.getPackages({excluded:X.excludedPackages}),2);case 2:wa=Oc.yieldResult,ja=[],Ga&&Ga.step("Fetching Packages...",.1),lb=0;case 3:if(!(lb<
wa.length)){Oc.jumpTo(5);break}Ja=wa[lb];Xb=Ja.url;if(!Xb||"no group"===Xb){Oc.jumpTo(4);break}Ga&&Ga.step(Xb.replace(System.baseURL,"").slice(0,20),.1+lb/wa.length*.9);Oc.setCatchFinallyBlocks(6);return Oc.yield(ya.coreInterface.searchInPackage(Xb,P,X),8);case 8:Kc=Oc.yieldResult;ja=ja.concat(Kc);Oc.leaveTryBlock(4);break;case 6:Hb=Oc.enterCatchBlock(),console.error("Error searching in package "+Xb+":\n"+Hb.stack);case 4:lb++;Oc.jumpTo(3);break;case 5:return Oc.return(ja)}})}},{key:"loadMochaTestFile",
value:function(P,X){return this.coreInterface.loadMochaTestFile(P,X)}},{key:"runMochaTests",value:function(P,X,ya,Ga){return this.coreInterface.runMochaTests(P,X,ya,Ga)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Interface"}}],za,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively-system-interface",version:"0.2.1"}}},
{start:668,end:6107})}(void 0));Lb.Interface=gb;Lb.Interface=gb;Lb.Interface=gb;Lb.systemInterfaceNamed=Ob;Lb.systemInterfaceNamed=Ob;gb=Ia("localInterface",new Lb.Interface(new Lb.LocalCoreInterface));Lb.localInterface=gb;Lb.localInterface=gb;Lb.localInterface=gb;Lb.httpInterfaces={};gb=Ia("serverInterfaceFor",function(Kb){return Lb.httpInterfaces[Kb]||(Lb.httpInterfaces[Kb]=new Lb.Interface(new Lb.HTTPCoreInterface(Kb)))});Lb.serverInterfaceFor=gb;Lb.serverInterfaceFor=gb;Lb.serverInterfaceFor=
gb;Lb.l2lInterfaces={};gb=Ia("l2lInterfaceFor",function(Kb,za){return Lb.l2lInterfaces[Kb]||(Lb.l2lInterfaces[Kb]=new Lb.Interface(new Lb.L2LCoreInterface(Kb,za)))});Lb.l2lInterfaceFor=gb;Lb.l2lInterfaceFor=gb;Lb.l2lInterfaceFor=gb}}});
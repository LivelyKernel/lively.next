System.register("./__root_module__-7d3cbdeb.js kld-intersections ./object-classes-e1436cbe.js ./user-ui-a47e164e.js ./index-c8d23f92.js ./index-fa65a47c.js".split(" "),function(){var Ka,wb,Ab,gc,Kb,Zc,Kc,md,Fc,Bc,Nc,Uc,ce,Zd,pe,Mc,Kd,Jb,Dc;return{setters:[function(nd){Ka=nd.M;wb=nd.af;Ab=nd.aa;gc=nd.m;Kb=nd.ae;Zc=nd.a;Kc=nd.f;md=nd.s;Fc=nd.C;Bc=nd.b;Nc=nd.r;Uc=nd.i;ce=nd.t;Zd=nd.ay;pe=nd.az;Mc=nd.c;Kd=nd.ax;Jb=nd._},function(){},function(){},function(nd){Dc=nd.UserUI},function(){},function(){}],
execute:function(){var nd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");nd.Morph=Ka;nd.HorizontalLayout=wb;nd.VerticalLayout=Ab;nd.morph=gc;nd.MorphicDB=Kb;nd.arr=Zc;nd.fun=Kc;nd.string=md;nd.Color=Fc;nd.pt=Bc;nd.UserUI=Dc;nd.resource=Nc;var Hc=function(Eb){var ic=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),jd=ic.hasOwnProperty("WorldDashboard")&&"function"===typeof ic.WorldDashboard?ic.WorldDashboard:ic.WorldDashboard=function(jc){jc&&jc[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Uc(jd,Eb,[{key:"onLoad",value:function(){if(!this.isComponent&&"undefined"!==typeof localStorage){var jc=localStorage.getItem("lively.morphic-projects-filter");jc&&this.ui.sortSelector.selection!=jc&&(this.ui.sortSelector.selection=jc)}}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",
this.ui.sortSelector.selection)}catch(jc){console.error(jc)}}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(jc){jc=void 0===jc?$world:jc;this.owner!=jc&&jc.addMorph(this);this.center=jc.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(jc){var kd=nd.UserUI.getCurrentUser();jc=this.ui.searchField.fuzzyFilter(jc,
function(vb){return vb._commit.name+vb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return nd.arr.sortBy(jc,function(vb){return-vb._commit.timestamp});case "TEMPLATES":return jc;case "MY PROJECTS":return nd.arr.filter(jc,function(vb){return vb._commit.author.name===kd.name});case "PUBLISHED":return jc}}},{key:"updateList",value:function(){var jc=this;this.previews&&nd.fun.debounceNamed("update world list",150,function(){jc.ui.worldList.items=jc.sortAndFilterPreviews(jc.previews)})()}},
{key:"displayWorlds",value:function(){var jc=this,kd,vb,db,ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mb){switch(Mb.nextAddress){case 1:return jc.reset(),kd=jc.ui,vb=kd.loadingLabel,vb.fit(),vb.animate({opacity:1,duration:300}),Mb.yield(jc.db.latestCommits("world"),2);case 2:return db=Mb.yieldResult,Mb.yield(nd.resource("part://partial freezing/world preview").read(),3);case 3:return ec=Mb.yieldResult,jc.previews=db.map(function(Hb){var pc=nd.morph({reactsToPointer:!1,fill:nd.Color.transparent,
extent:ec.extent});pc._commit=Hb;pc.displayPreview=function(){var Ma;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ib){if(1==Ib.nextAddress)return Ma=ec.copy(),Ma._commit=Hb,Ma.opacity=0,pc.addMorph(Ma),Ma.displayPreview(),Ma.position=nd.pt(0,0),Ib.yield(pc.whenRendered(),2);pc.layout=new nd.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});Ib.jumpToEnd()})};return pc}),Mb.yield(vb.animate({opacity:0,duration:300}),4);case 4:jc.updateList(),0==db.length&&(jc.ui.noWorldWarning.center=
jc.innerBounds().center(),jc.ui.noWorldWarning.animate({visible:!0,duration:300})),Mb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(jc){this.ui.closeButton.visible=jc}},db:{serialize:!1,get:function(){return nd.MorphicDB.default}},
ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],ic,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"WorldDashboard",version:"0.1.1-135"}}},{start:330,end:4417})}(nd.Morph);Hc=nd.WorldDashboard;nd.default=Hc;var wd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");wd.Morph=Ka;wd.touchInputDevice=ce;wd.TilingLayout=Zd;wd.arr=Zc;wd.pt=Bc;Hc=function(Eb){var ic=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),jd=ic.hasOwnProperty("GrowingWorldList")&&"function"===typeof ic.GrowingWorldList?ic.GrowingWorldList:ic.GrowingWorldList=function(jc){jc&&
jc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Uc(jd,Eb,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(jc){Uc._get(Object.getPrototypeOf(jd.prototype),"onScroll",this).call(this,jc);this.update()}},{key:"onChange",value:function(jc){Uc._get(Object.getPrototypeOf(jd.prototype),"onChange",this).call(this,jc);"extent"==jc.prop&&this.update(!0)}},{key:"onHoverIn",value:function(jc){this.clipMode=
"auto"}},{key:"onHoverOut",value:function(jc){wd.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(jc){var kd=this.items;if(kd&&0!=kd.length){var vb=this.scrollContainer,db=vb.layout.spacing;vb.extent=this.extent;var ec=this.ui,Mb=ec.bufferTop;ec=ec.bufferBottom;Mb=Mb||vb.addMorph({fill:null,name:"buffer top",height:10});ec=ec||vb.addMorph({fill:null,name:"buffer bottom",height:10});Mb.width=ec.width=this.width-100;vb.layout.disable();var Hb=kd[0];db=kd.slice(0,Math.floor(this.width/
(Hb.width+db))*(Math.ceil((this.scroll.y+this.height)/(Hb.height+db))+1)).filter(function(pb){return pb.owner!=vb});Hb=this.scroll.y+2*this.height;for(var pc={},Ma=$jscomp.makeIterator(db),Ib=Ma.next();!Ib.done;pc={$jscomp$loop$prop$item$2842:pc.$jscomp$loop$prop$item$2842},Ib=Ma.next())pc.$jscomp$loop$prop$item$2842=Ib.value,Hb++,pc.$jscomp$loop$prop$item$2842.top=Hb,vb.addMorph(pc.$jscomp$loop$prop$item$2842),pc.$jscomp$loop$prop$item$2842._initialized||pc.$jscomp$loop$prop$item$2842.whenRendered().then(function(pb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ub){pb.$jscomp$loop$prop$item$2842._initialized=
!0;return Ub.yield(pb.$jscomp$loop$prop$item$2842.displayPreview(),0)})}}(pc));jc&&(Mb.position=wd.pt(0,0),kd.forEach(function(pb,Ub){return pb.position=wd.pt(Ub+1,Ub+1)}),ec.position=wd.pt(kd.length+2,kd.length+2));vb.layout.enable();if(jc||0<db.length)ec.top=this.submorphBounds().height,vb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new wd.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(jc){this.setProperty("items",jc);var kd=this.scrollContainer;kd.layout&&kd.layout.disable();var vb=this.ui,db=vb.bufferTop;vb=vb.bufferBottom;wd.arr.withoutAll(kd.submorphs,
[].concat($jscomp.arrayFromIterable(jc),[db,vb])).forEach(function(ec){return ec.remove()});this.update(!0)}}}}}],ic,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(wd.Morph);Hc=wd.GrowingWorldList;wd.default=Hc;var Qd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
Qd.InputLine=pe;Qd.Color=Fc;Qd.connect=Mc;Qd.disconnectAll=Kd;Qd.disconnect=Jb;Qd.arr=Zc;Qd.string=md;Hc=function(Eb){var ic=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),jd=ic.hasOwnProperty("SearchInputLine")&&"function"===typeof ic.SearchInputLine?ic.SearchInputLine:ic.SearchInputLine=function(jc){jc&&jc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Uc(jd,Eb,[{key:"fuzzyMatch",value:function(jc,kd){kd=void 0===
kd?this.parseInput():kd;if(kd.lowercasedTokens.every(function(db){return jc.toLowerCase().includes(db)}))return!0;var vb=jc.toLowerCase();return 3>=Qd.arr.sum(kd.lowercasedTokens.map(function(db){return Qd.string.levenshtein(vb,db)}))}},{key:"fuzzyFilter",value:function(jc,kd){var vb=this;kd=void 0===kd?function(ec){return ec}:kd;var db=this.parseInput();return Qd.arr.filter(jc,function(ec){return vb.fuzzyMatch(kd(ec),db)})}},{key:"parseInput",value:function(){var jc=Array.from(this.textString).reduce(function(vb,
db){if("\\"===db&&!vb.escaped)return vb.escaped=!0,vb;" "!==db||vb.escaped?(vb.spaceSeen=!1,vb.current+=db):(!vb.spaceSeen&&vb.current&&(vb.tokens.push(vb.current),vb.current=""),vb.spaceSeen=!0);vb.escaped=!1;return vb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});jc.current&&jc.tokens.push(jc.current);var kd=jc.tokens.map(function(vb){return vb.toLowerCase()});return{tokens:jc.tokens,lowercasedTokens:kd}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],ic,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(Qd.InputLine);Hc=Qd.SearchInputLine;Qd.default=Hc}}});
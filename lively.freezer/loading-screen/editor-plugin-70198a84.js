System.register(["./__root_module__-f9290433.js","./index-9e4ab300.js","./index-5ea42d9a.js"],function(sa){var db,Eb,Vb,Wb,wd,Ic,Ad,Jc,Mc,bd,ed,Od,qd,Xc,Ra,wb,mc,dc,Rc,Tc,zc,Fc,Jb,Ac,Bc,fd,Qb,xb,eb,vb,Va,lb,yb,Zb,Sb,$a,bb,Kb,wc,fc,bc,Tb,I,T,qa;return{setters:[function(Ga){db=Ga.C;Eb=Ga.aq;Vb=Ga.a4;Wb=Ga.$;wd=Ga.a1;Ic=Ga.al;Ad=Ga.be;Jc=Ga.aS;Mc=Ga.ao;bd=Ga.s;ed=Ga.aN;Od=Ga.bl;qd=Ga.bm;Xc=Ga.a5;Ra=Ga.as;wb=Ga.an;mc=Ga.ap;dc=Ga.bn;Rc=Ga.bo;Tc=Ga.a0;zc=Ga.P;Fc=Ga._;Jb=Ga.aU;Ac=Ga.ag;Bc=Ga.ah;fd=Ga.ai;
Qb=Ga.aj;xb=Ga.az;eb=Ga.aX;vb=Ga.av;Va=Ga.am;lb=Ga.a8;yb=Ga.bp;Zb=Ga.L;Sb=Ga.bq;$a=Ga.b0;bb=Ga.bf;Kb=Ga.a$;wc=Ga.br;fc=Ga.ar},function(Ga){bc=Ga.M;Tb=Ga.I;I=Ga.v;T=Ga.p},function(Ga){qa=Ga.localInterface}],execute:function(){function Ga(xa,Na){if(!0===Na)return Na;if(xa.copyState)return xa.copyState(Na);xa={};for(var ub in Na){var Q=Na[ub];Q instanceof Array&&(Q=Q.concat([]));xa[ub]=Q}return xa}function Mb(xa,Na,ub){return xa.startState?xa.startState(Na,ub):!0}function nb(xa,Na){return H.modes[xa]=
Na}function Ha(xa){if("string"==typeof xa&&H.mimeModes.hasOwnProperty(xa))xa=H.mimeModes[xa];else if(xa&&"string"==typeof xa.name&&H.mimeModes.hasOwnProperty(xa.name)){var Na=H.mimeModes[xa.name];"string"==typeof Na&&(Na={name:Na});xa=Object.assign({},Na,xa);xa.name=Na.name}else{if("string"==typeof xa&&/^[\w\-]+\/[\w\-]+\+xml$/.test(xa))return Ha("application/xml");if("string"==typeof xa&&/^[\w\-]+\/[\w\-]+\+json$/.test(xa))return Ha("application/json")}return"string"==typeof xa?{name:xa}:xa||{name:"null"}}
function kb(xa,Na){Na=H.resolveMode(Na);"string"===typeof Na&&(Na={name:Na});if(!Na.name)throw Error("parserConfig does not have a name of the mode to get");var ub=H.modes[Na.name];if(!ub)return kb(xa,"text/plain");xa=Object.assign({indentUnit:2},xa);return Object.assign(ub(xa,Na),{name:Na.name})}function Qc(xa,Na){for(var ub;xa.innerMode;){ub=xa.innerMode(Na);if(!ub||ub.mode==xa)break;Na=ub.state;xa=ub.mode}return ub||{mode:xa,state:Na}}function qc(xa,Na){H.mimeModes[xa]=Na}function Cb(xa,Na,ub){}
function za(xa,Na,ub,Q,wa,Xa,ib){var rc=xa.editorPlugin._tokenizerValidBefore;rc&&rc.row>=ub&&(rc.row=ub-1);var cc=H.linesToTokenize(xa.document,ub,Q,rc);rc=cc.lines;cc=cc.state;if(!rc.length)return!1;cc=cc?H.copyState(Na,cc):H.startState(Na);for(var ad=0;ad<rc.length;ad++){var Vc=rc[ad],Yc=Vc.row;Yc>=ub&&Yc<=Q&&H.indentLine(xa,Na,Vc,cc,wa,Xa,ib);cc=H.tokenizeLine(Na,rc[ad],cc,function(){})}return!0}function Ca(xa,Na,ub,Q,wa,Xa,ib){Na=H.linesToTokenize(Na,ub,Q,wa);ub=Na.lines;H.tokenizeLines(xa,ub,
Na.state,Xa,ib);return ub}function ma(xa,Na,ub,Q,wa){var Xa=[],ib,rc=function(Vc){return Xa.push(ib=[])},cc=function(Vc,Yc,$d,Mf,Bf,Hg,cf){return ib.push($d,Mf,Vc,Bf.current(),Yc.localMode||cf)};try{var ad=H.visitDocumentTokens(xa,Na,ub,Q,wa,rc,cc)}catch(Vc){Xa.length=0,ad=H.visitDocumentTokens(xa,Na,ub,Q,null,rc,cc)}return{tokens:Xa,lines:ad}}function la(xa,Na,ub,Q,wa){null==Na&&(Na=xa.search(/[^\s\u00a0]/),-1==Na&&(Na=xa.length));Q=Q||0;for(wa=wa||0;;){var Xa=xa.indexOf("\t",Q);if(0>Xa||Xa>=Na)return wa+
(Na-Q);wa+=Xa-Q;wa+=ub-wa%ub;Q=Xa+1}}function va(xa){xa=xa.toLowerCase();for(var Na=0;Na<H.modeInfo.length;Na++){var ub=H.modeInfo[Na];if(ub.mime==xa)return ub;if(ub.mimes)for(var Q=0;Q<ub.mimes.length;Q++)if(ub.mimes[Q]==xa)return ub}if(/\+xml$/.test(xa))return va("application/xml");if(/\+json$/.test(xa))return va("application/json")}function cb(xa){for(var Na=0;Na<H.modeInfo.length;Na++){var ub=H.modeInfo[Na];if(ub.ext)for(var Q=0;Q<ub.ext.length;Q++)if(ub.ext[Q]==xa)return ub}}function fb(xa){for(var Na=
0;Na<H.modeInfo.length;Na++){var ub=H.modeInfo[Na];if(ub.file&&ub.file.test(xa))return ub}Na=xa.lastIndexOf(".");if(xa=-1<Na&&xa.substring(Na+1,xa.length))return H.findModeByExtension(xa)}function ec(xa){xa=xa.toLowerCase();for(var Na=0;Na<H.modeInfo.length;Na++){var ub=H.modeInfo[Na];if(ub.name.toLowerCase()==xa)return ub;if(ub.alias)for(var Q=0;Q<ub.alias.length;Q++)if(ub.alias[Q].toLowerCase()==xa)return ub}}function Nc(xa){if(!xa)return String(xa);if(Array.isArray(xa))return"["+xa.map(Nc).join(",")+
"]";if("symbol"===typeof xa)return jd.printSymbol(xa);try{return String(xa)}catch(Na){return"Cannot print object: "+Na}}function pd(xa,Na){return!jd.arr.every(Na.map(function(ub){return xa[ub]}),function(ub){return jd.obj.equals(ub,xa&&xa.valueOf())})}function Yd(xa){if(jd.obj.isPrimitive(xa))var Na=jd.string.print(xa);else Array.isArray(xa)?((Na=3<xa.length)&&(xa=xa.slice(0,3)),xa=jd.string.print(xa),Na&&(xa=xa.slice(0,-1)+", ...]"),Na=xa):Na=jd.string.print(xa);Na=Na.replace(/\n/g,"");500<Na.length&&
(Na=Na.slice(0,20)+("...["+(Na.length-20)+' CHARS]"'));return Na}function uc(xa){return yc.Inspector.openInWindow({targetObject:xa})}function Qd(xa,Na){return yc.Inspector.openInWindow({remoteTarget:{code:xa,evalEnvironment:Na}})}function cd(xa,Na){function ub(rc){var cc=rc.name,ad=rc.ownerChain(),Vc=rc.owner,Yc=rc.world(),$d;rc===Xa&&($d=[ib]);Yc===rc&&($d=["$world"]);if(!$d&&cc&&Vc){Vc===Yc&&1===yc.arr.count(yc.arr.pluck(Yc.submorphs,"name"),cc)&&($d=['$world.get("'+cc+'")']);if(!$d&&Vc!=Yc)for(Yc=
ad.length-1;Yc--;)if(1===ad[Yc].getAllNamed(cc).length){$d=[].concat($jscomp.arrayFromIterable(ub(ad[Yc])),['get("'+cc+'")']);break}$d||(cc=[].concat($jscomp.arrayFromIterable(ub(Vc)),['get("'+cc+'")']),yc.syncEval(cc.join("."),{context:Xa}).value===rc&&($d=cc))}$d||($d=[ib+'.getMorphById("'+rc.id+'")']);return $d}Na=void 0===Na?{}:Na;var Q=xa.world(),wa=Na;Na=void 0===wa.maxLength?10:wa.maxLength;var Xa=void 0===wa.fromMorph?Q:wa.fromMorph;if(Xa===xa)return"this";var ib=Q===Xa?"$world":"this";if(!(Q||
xa.name&&Xa.get(xa.name)===xa))return"morph";Q=ub(xa);return Q.length>Na?'$world.getMorphWithId("'+xa.id+'")':Q.join(".")}function zb(xa,Na,ub){var Q=(Na=void 0===Na?"":Na)&&Be.arr.last(Na.split(".")).toLowerCase(),wa="",Xa=0,ib=Math.pow(2,19);if("string"===typeof xa){if(xa.length>ib)return null}else if(xa.document.stringSize>ib)return null;if("string"===typeof xa)wa=xa.slice(0,1E3);else for(xa=$jscomp.makeIterator(xa.document.lines),ib=xa.next();!ib.done;ib=xa.next()){var rc=ib.value;ib=rc.stringSize;
rc=rc.text;var cc=!0;1E3<Xa+ib&&(cc=!1,ib=1E3-Xa);wa+=rc.slice(0,ib)+(cc?"\n":"");Xa+=ib;if(1E3<=Xa)break}Xa=$jscomp.makeIterator(Be.modeInfo);for(xa=Xa.next();!xa.done;xa=Xa.next()){cc=xa.value;ib=cc.contentTest;xa=cc.mode;rc=cc.ext;cc=cc.file;if("function"===typeof ib)try{if(ib(wa))return xa}catch(ad){}if(cc&&cc instanceof RegExp&&cc.test(Na))return xa;if(rc)for(ib=$jscomp.makeIterator(rc),rc=ib.next();!rc.done;rc=ib.next())if(rc.value===Q)return xa}return ub}sa({a:qc,d:nb,r:Cb});var da=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");
da.Color=db;var ra=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),ub=Na.hasOwnProperty("DefaultTheme")&&"function"===typeof Na.DefaultTheme?Na.DefaultTheme:Na.DefaultTheme=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:"background",get:function(){return da.Color.white}},{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",
fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},
{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},
{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},
{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},
{key:"diff-file-header",get:function(){return{fontColor:da.Color.white,fontWeight:"bold",backgroundColor:da.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:da.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:da.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],
[{key:"className",get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Na,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2867})}(void 0),sb=ra=da.DefaultTheme;da.default=ra;var H=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");
H.copyState=Ga;H.startState=Mb;H.defineMode=nb;H.resolveMode=Ha;H.getMode=kb;H.innerMode=Qc;H.defineMIME=qc;H.registerHelper=Cb;H.indentLines=za;H.indentLine=function(xa,Na,ub,Q,wa,Xa,ib){ib=Object.assign({indentWithTabs:!xa.useSoftTabs,indentUnit:xa.tabWidth,tabSize:4,ignoreFollowingText:!1},ib);null==wa&&(wa="add");"smart"==wa&&(Na.indent||(wa="prev"));var rc=ib.tabSize,cc=ub.text,ad=H.countColumn(cc,null,rc);ub.modeState&&(ub.modeState=null);var Vc=cc.match(/^\s*/)[0];if(!Xa&&!/\S/.test(cc)){var Yc=
0;wa="not"}else if("smart"==wa&&(Yc=Na.indent(Q,ib.ignoreFollowingText?"":cc.slice(Vc.length),cc),Yc==H.passIndent||150<Yc)){if(!Xa)return;wa="prev"}"prev"==wa?Yc=0<ub.row?H.countColumn(ub.prevLine().text,null,rc):0:"add"==wa?Yc=ad+ib.indentUnit:"subtract"==wa?Yc=ad-ib.indentUnit:"number"==typeof wa&&(Yc=ad+wa);Yc=Math.max(0,Yc);Na="";Q=0;if(ib.indentWithTabs)for(ib=Math.floor(Yc/rc);ib;--ib)Q+=rc,Na+="\t";Q<Yc&&(Na+=" ".repeat(Yc-Q));if(Na!=Vc)return xa.replace({start:{row:ub.row,column:0},end:{row:ub.row,
column:Vc.length}},Na),!0};H.tokenizeLines=function(xa,Na,ub,Q,wa){if(Na.length){ub=ub?H.copyState(xa,ub):H.startState(xa);for(var Xa=0;Xa<Na.length;Xa++){var ib=Na[Xa];Q(ib);ub=H.tokenizeLine(xa,ib,ub,wa)}}};H.tokenizeLine=function(xa,Na,ub,Q){var wa=Na.text;if(!wa)return ub;var Xa=new H.StringStream(wa,2);ub=Na.modeState="function"===typeof xa.copyState?xa.copyState(ub):H.copyState(xa,ub);Na.prevLine();for(ub._string=wa;!Xa.eol();)wa=xa.token(Xa,ub),Q(wa,ub,Xa.start,Xa.pos,Xa,Na,xa),Xa.start=Xa.pos;
return ub};H.printTokens=function(xa){for(var Na="",ub=0;ub<xa.length;ub+=5)Na+=xa[ub+0]+" => "+xa[ub+1]+" "+xa[ub+2]+" "+xa[ub+3]+" "+xa[ub+4].name+"\n";return Na};H.visitDocumentTokens=Ca;H.tokenizeDocument=ma;H.linesToTokenize=function(xa,Na,ub,Q){if(Q&&Q.row>=ub)return{lines:[],state:null};Na=Q?Math.max(0,Q.row-1):Na;var wa=xa.getLine(Na),Xa=wa.text;xa=[wa];Q=null;for(var ib=0,rc;(rc=wa.prevLine())&&50>ib++;){wa=rc;if(wa.modeState){Q=wa.modeState;break}xa.unshift(wa)}if(!Q){for(var cc=wa,ad=Infinity;(rc=
wa.prevLine())&&100>ib++;){wa=rc;if(wa.modeState){Q=wa.modeState;break}xa.unshift(wa);rc=Xa.match(/^\s*/)[0].length;if(0===rc)break;rc<ad&&(ad=rc,cc=wa)}!Q&&0<ad&&(xa=xa.slice(xa.indexOf(cc)))}if(ub>Na)for(wa=H.arr.last(xa);Na<=ub;Na++){wa=wa.nextLine();if(!wa)break;xa.push(wa)}return{lines:xa,state:Q}};H.countColumn=la;H.findModeByMIME=va;H.findModeByExtension=cb;H.findModeByFileName=fb;H.findModeByName=ec;H.arr=Vb;ra=H.modes||{};H.modes=ra;H.modes=ra;H.modes=ra;ra=sa("p",{});H.passIndent=ra;H.passIndent=
ra;H.passIndent=ra;H.copyState=Ga;H.copyState=Ga;H.startState=Mb;H.startState=Mb;H.defineMode=nb;H.defineMode=nb;H.resolveMode=Ha;H.resolveMode=Ha;H.getMode=kb;H.getMode=kb;H.innerMode=Qc;H.innerMode=Qc;ra={};H.mimeModes=ra;H.mimeModes=ra;H.mimeModes=ra;H.defineMIME=qc;H.defineMIME=qc;H.registerHelper=Cb;H.registerHelper=Cb;H.indentLines=za;H.indentLines=za;H.visitDocumentTokens=Ca;H.visitDocumentTokens=Ca;H.tokenizeDocument=ma;H.tokenizeDocument=ma;H.countColumn=la;H.countColumn=la;(function(xa){var Na=
lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),ub=Na.hasOwnProperty("StringStream")&&"function"===typeof Na.StringStream?Na.StringStream:Na.StringStream=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(Q,wa){this.reset(Q,wa)}},{key:"reset",value:function(Q,wa){this.pos=this.start=0;this.string=void 0===Q?"":Q;this.tabSize=void 0===
wa?2:wa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(Q){var wa=this.string.charAt(this.pos);if("string"==typeof Q?wa==Q:wa&&(Q.test?Q.test(wa):Q(wa)))return++this.pos,
wa}},{key:"eatWhile",value:function(Q){for(var wa=this.pos;this.eat(Q););return this.pos>wa}},{key:"eatSpace",value:function(){for(var Q=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>Q}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(Q){Q=this.string.indexOf(Q,this.pos);if(-1<Q)return this.pos=Q,!0}},{key:"backUp",value:function(Q){this.pos-=Q}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=
H.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?H.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return H.countColumn(this.string,null,this.tabSize)-(this.lineStart?H.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(Q,wa,Xa){if("string"==typeof Q){var ib=function(cc){return Xa?cc.toLowerCase():cc},
rc=this.string.substr(this.pos,Q.length);if(ib(rc)==ib(Q))return!1!==wa&&(this.pos+=Q.length),!0}else{if((Q=this.string.slice(this.pos).match(Q))&&0<Q.index)return null;Q&&!1!==wa&&(this.pos+=Q[0].length);return Q}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(Q,wa){this.lineStart+=Q;try{return wa()}finally{this.lineStart-=Q}}}],[{key:"className",get:function(){return"StringStream"}}],Na,{pathInPackage:function(){return"editor-modes.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);ra=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",
mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj",
"cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",
mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff",
"patch"],contentTest:function(xa){return xa.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},
{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth",
"fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy",
"gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",
ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],
mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",
mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",
mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",
mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},
{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",
mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",
mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash",
"sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(xa){return xa.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},
{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",
mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",
mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",
mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml",
"text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",
mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];H.modeInfo=ra;H.modeInfo=ra;H.modeInfo=ra;for(var fa=0;fa<H.modeInfo.length;fa++)H.info=H.modeInfo[fa],H.info.mimes&&(H.info.mime=H.info.mimes[0]);H.defineMode("null",function(){return{token:function(xa){return xa.skipToEnd()}}});H.defineMIME("text/plain","null");H.findModeByMIME=va;H.findModeByMIME=va;H.findModeByExtension=cb;H.findModeByExtension=cb;H.findModeByFileName=fb;H.findModeByFileName=fb;H.findModeByName=ec;H.findModeByName=ec;var Fa=
lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Fa.Color=db;Fa.Rectangle=Wb;Fa.pt=wd;Fa.morph=Ic;Fa.ShadowObject=Ad;Fa.StyleSheet=Jc;Fa.connect=Mc;Fa.arr=Vb;Fa.string=bd;Fa.FilterableList=ed;Fa.Range=Od;fa=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ub=Na.hasOwnProperty("Completer")&&"function"===typeof Na.Completer?Na.Completer:Na.Completer=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Eb(ub,xa,[{key:"compute",value:function(){return[]}}],[{key:"className",get:function(){return"Completer"}}],Na,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:345,end:391})}(void 0);Fa.Completer=fa;Fa.Completer=fa;Fa.Completer=fa;fa=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
ub=Na.hasOwnProperty("WordCompleter")&&"function"===typeof Na.WordCompleter?Na.WordCompleter:Na.WordCompleter=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:"compute",value:function(Q,wa){var Xa=[],ib=[],rc=Q.document.lineStrings;Q=Q.cursorPosition.row;for(var cc=Q-1;0<=cc;cc--)for(var ad=$jscomp.makeIterator(rc[cc].split(/[^0-9a-z@_]+/i)),Vc=ad.next();!Vc.done;Vc=ad.next())(Vc=Vc.value)&&!Xa.includes(Vc)&&
Vc!==wa&&(Xa.push(Vc),ib.push({priority:1E3-(Q-cc),completion:Vc}));for(cc=Q+1;cc<rc.length;cc++)for(ad=$jscomp.makeIterator(rc[cc].split(/[^0-9a-z_@]+/i)),Vc=ad.next();!Vc.done;Vc=ad.next())(Vc=Vc.value)&&!Xa.includes(Vc)&&Vc!==wa&&(Xa.push(Vc),ib.push({priority:1E3-(cc-Q),completion:Vc}));return ib}}],[{key:"className",get:function(){return"WordCompleter"}}],Na,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:400,end:1228})}(void 0);Fa.WordCompleter=fa;Fa.WordCompleter=fa;Fa.WordCompleter=fa;fa=[new Fa.WordCompleter];Fa.defaultCompleters=fa;Fa.defaultCompleters=fa;Fa.defaultCompleters=fa;fa=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ub=Na.hasOwnProperty("CompletionController")&&"function"===typeof Na.CompletionController?Na.CompletionController:Na.CompletionController=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(Q,wa){wa=void 0===wa?[]:wa;this.textMorph=Q;this.completers=wa=Q.pluginCollect("getCompleters",wa)}},{key:"computeCompletions",value:function(Q){var wa=this,Xa,ib,rc,cc,ad,Vc,Yc,$d,Mf,Bf,Hg,cf,Bg,Di,Pg,Nj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pe){switch(Pe.nextAddress){case 1:Xa=[],ib=$jscomp.makeIterator(wa.completers),rc=ib.next();
case 2:if(rc.done){Pe.jumpTo(4);break}cc=rc.value;Pe.setCatchFinallyBlocks(5);ad=Xa;Vc=ad.concat;return Pe.yield(cc.compute(wa.textMorph,Q),7);case 7:Xa=Vc.call(ad,Pe.yieldResult);Pe.leaveTryBlock(3);break;case 5:Yc=Pe.enterCatchBlock(),console.warn("Error in completer "+cc+": "+(Yc.stack||Yc));case 3:rc=ib.next();Pe.jumpTo(2);break;case 4:$d=new Map;Xa.forEach(function(ki){var Kh=$d.get(ki.completion);Kh||(Kh=[],$d.set(ki.completion,Kh));Kh.push(ki)});Mf=[];Bf=$jscomp.makeIterator($d.values());for(Hg=
Bf.next();!Hg.done;Hg=Bf.next())cf=Hg.value,Mf.push(Fa.arr.last(Fa.arr.sortByKey(cf,"priority")));Bg=0;Di=Fa.arr.sortByKey(Mf,"priority").reverse();Pg=Di.length&&Di[0].priority||0;Nj=Di.map(function(ki){ki.highestPriority=Pg;var Kh=ki.completion.replace(/\n/g,""),ce=String((ki.info||"").replace(/\n/g,""));Bg=Math.max(Bg,Kh.length+ce.length);return{isListItem:!0,string:Kh,annotation:ce,value:ki}});return Pe.return({items:Nj,maxCol:Bg})}})}},{key:"computeSortedCompletions",value:function(Q,wa){wa=void 0===
wa?!1:wa;var Xa=this,ib,rc,cc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){if(1==ad.nextAddress)return ib={tokens:[Q],lowercasedTokens:[Q],input:Q},ad.yield(Xa.computeCompletions(Q),2);rc=ad.yieldResult;cc=Fa.arr.sortBy(rc.items.filter(function(Vc){return Xa.filterFunction(ib,Vc,wa)}),function(Vc){return Xa.sortFunction(ib,Vc)});return ad.return(cc)})}},{key:"_printCompletions",value:function(Q){var wa=this,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){if(1==
ib.nextAddress)return ib.yield(wa.computeSortedCompletions(Q),2);Xa=ib.yieldResult.map(function(rc){return{completion:rc.value.completion,priority:rc.value.priority,maxP:rc.value.highestPriority,sortVal:rc._cache[Q].sortVal,lev:JSON.stringify(rc._cache[Q].levenshtein)}});return ib.return(Fa.string.printTable(lively.lang.grid.tableFromObjects(Xa)))})}},{key:"prefix",value:function(){var Q=this.textMorph,wa=Q.selection;return(wa.isEmpty()?Q.getLine(wa.lead.row).slice(0,wa.lead.column):wa.text).match(/[a-z0-9@_]*$/i)[0]}},
{key:"filterFunction",value:function(Q,wa,Xa){Xa=void 0===Xa?!1:Xa;wa._cache||(wa._cache={});var ib=Q.tokens,rc=Q.lowercasedTokens,cc=Q.input;cc=wa._cache[cc]||(wa._cache[cc]={});if(cc.hasOwnProperty("filtered"))return cc.filtered;wa=wa.value.completion.replace(/\([^\)]*\)$/,"");var ad=wa.toLowerCase();if(Xa&&ib[0]&&!wa.startsWith(ib[0]))return cc.filtered=!1;if(rc.every(function(Yc){return ad.includes(Yc)}))return!0;var Vc=cc.levenshtein||(cc.levenshtein={});Q=Xa||3>=Fa.arr.sum(Q.lowercasedTokens.map(function(Yc){return Vc[Yc]||
(Vc[Yc]=Fa.string.levenshtein(ad,Yc))}));return cc.filtered=Q}},{key:"sortFunction",value:function(Q,wa){wa._cache||(wa._cache={});var Xa=wa._cache[Q.input]||(wa._cache[Q.input]={});if(Xa.hasOwnProperty("sortVal"))return Xa.sortVal;Xa=wa._cache[Q.input]={};var ib=wa.value;wa=ib.highestPriority;var rc=ib.completion;ib=ib.priority;rc=rc.replace(/\([^\)]*\)$/,"").toLowerCase();var cc=0;Q.lowercasedTokens.forEach(function(Vc){rc.startsWith(Vc)?cc+=12:3<=Vc.length&&rc.includes(Vc)&&(cc+=5)});wa=-((ib||
(cc?wa:0))/Math.pow(10,String(wa).length-2))-cc;var ad=Xa.levenshtein||(Xa.levenshtein={});Q=Fa.arr.sum(Q.lowercasedTokens.map(function(Vc){return ad[Vc]||(ad[Vc]=Fa.string.levenshtein(rc,Vc))}));cc&&(Q/=2);return Xa.sortVal=Q+wa}},{key:"positionForMenu",value:function(){var Q=this.textMorph,wa=Q.charBoundsFromTextPosition(Q.cursorPosition);return Q.getGlobalTransform().transformRectToRect(wa).topLeft().addXY(-Q.scroll.x,-Q.scroll.y).addPt(Fa.pt(Q.borderWidth+3,Q.borderWidth+3))}},{key:"completionListSpec",
value:function(){var Q=this,wa,Xa,ib,rc,cc,ad,Vc,Yc,$d,Mf,Bf,Hg,cf,Bg,Di,Pg,Nj,Pe,ki,Kh;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ce){if(1==ce.nextAddress)return Xa=wa=Q.textMorph,ib=Xa.fontSize,rc=Xa.fontFamily,cc=Q.positionForMenu(),ad=Q.prefix(),ce.yield(Q.computeCompletions(ad),2);Vc=ce.yieldResult;Yc=Vc.items;$d=Vc.maxCol;Mf=wa.env.fontMetric.sizeFor(rc,ib,"M");Bf=Mf.width*$d;Hg=wa.document.getLine(0).height;cf=Math.max(120,Bf<wa.width?Bf:wa.width);Bg=Hg*Yc.length+Hg+10;Di=
Math.max(70,Math.min(700,Bg));Pg=cc.extent(Fa.pt(cf,Di));if(Nj=wa.world())Pe=Nj.visibleBounds().insetBy(5),Pg.bottom()>Pe.bottom()&&(ki=Pg.bottom()-Pe.bottom(),ki>Pg.height-50&&(ki=Pg.height-50),Pg.height-=ki),Pg.right()>Pe.right()&&(Kh=Pg.right()-Pe.right(),Pg.width=120>Pg.width-Kh?120:Pg.width-Kh),Pe.containsRect(Pg)||(Pg=Pg.withTopLeft(Pe.translateForInclusion(Pg).topLeft())),Pg=Pg.translatedBy(Pe.insetBy(0).topLeft().negated());return ce.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:ib,position:Pg.topLeft(),extent:Pg.extent(),items:Yc,input:ad,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:Q.filterFunction,sortFunction:Q.sortFunction})})}},{key:"removeMenuOnBlur",value:function(Q){var wa=Q.menu;setTimeout(function(){wa.withAllSubmorphsDetect(function(Xa){return Xa.isFocused()})?wa.inputMorph.focus():wa.remove()})}},{key:"openCompletionList",value:function(){var Q=this,wa,Xa,ib,rc,cc,ad,Vc,Yc,$d,Mf;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bf){if(1==Bf.nextAddress)return wa=Q.textMorph.selection.start,Bf.yield(Q.completionListSpec(),2);Xa=Bf.yieldResult;Q.textMorph.pluginFind(function(Hg){return Hg.theme});ib=new Fa.FilterableList(Xa);rc=new Fa.Range({start:wa,end:Q.textMorph.selection.start});cc=Q.textMorph.textInRange(rc);ad=ib.inputMorph;Vc=ib.listMorph;Yc=Xa.input;$d=ib.addMorph({name:"prefix mask",fill:Fa.Color.transparent,bounds:ad.textBounds()},ad);Vc.master=null;rc.isEmpty()||
(Q.textMorph.deleteText(rc),ad.input=cc,ad.gotoDocumentEnd());ad.fontColor=Q.textMorph.fontColor;Fa.connect(ad,"textString",$d,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:ad}});Fa.connect(ib,"accepted",Q,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Yc}});Fa.connect(ib,"accepted",ib,"remove");Fa.connect(ib,"canceled",ib,"remove");Fa.connect(ib,"remove",Q.textMorph,"focus");Fa.connect(ib.inputMorph,"onBlur",Q,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:ib}});Mf=Q.textMorph.world();Mf.addMorph(ib);Vc.addStyleClass("hiddenScrollbar");ad.height=Vc.itemHeight;ad.fixedHeight=!0;ad.fontSize=Vc.fontSize;ad.focus();ib.get("padding").height=0;ib.relayout();ib.selectedIndex=0;Yc.length?(ad.gotoDocumentEnd(),
ib.moveBy(Fa.pt(-ad.textBounds().width+2,0))):ib.moveBy(Fa.pt(2,0));return Bf.return(ib)})}},{key:"autoInsertBestMatchingCompletion",value:function(Q,wa,Xa){wa=void 0===wa?!0:wa;var ib=this,rc,cc,ad,Vc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yc){if(1==Yc.nextAddress)return rc=$jscomp,cc=rc.makeIterator,Yc.yield(ib.computeSortedCompletions(Q,wa),2);ad=cc.call(rc,Yc.yieldResult);(Vc=ad.next().value)&&ib.insertCompletion(Vc.value.completion,Q,Xa);Yc.jumpToEnd()})}},{key:"insertCompletion",
value:function(Q,wa,Xa){var ib=this.textMorph,rc=ib.document,cc=ib.selection.isMultiSelection?ib.selection.selections:[ib.selection];ib.undoManager.group();cc.forEach(function(ad){ad.collapseToEnd();var Vc=ad.lead,Yc=wa?rc.indexToPosition(rc.positionToIndex(Vc)-wa.length):Vc;"function"===typeof Xa?Xa(Q,wa,ib,{start:Yc,end:Vc},ad):ib.replace({start:Yc,end:Vc},Q)});ib.undoManager.group()}}],[{key:"className",get:function(){return"CompletionController"}}],Na,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1355,end:12497})}(void 0);Fa.CompletionController=fa;Fa.CompletionController=fa;Fa.CompletionController=fa;fa=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(xa,Na,ub){var Q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){return 1==wa.nextAddress?
(Q=new Fa.CompletionController(xa,Fa.defaultCompleters),wa.yield(Q.openCompletionList(),2)):wa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(xa,Na,ub){var Q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){return 1==wa.nextAddress?(Q=new Fa.CompletionController(xa,Fa.defaultCompleters),wa.yield(Q.autoInsertBestMatchingCompletion(Q.prefix()),2)):wa.return(!0)})}}];Fa.completionCommands=fa;Fa.completionCommands=fa;Fa.completionCommands=
fa;var qb=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");qb.chain=qd;qb.arr=Vb;qb.obj=Xc;qb.string=bd;var nc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(xa){var Na=xa.selection.start;0<Na.row&&(Na=xa.getPositionAboveOrBelow(1,Na,!0,0,xa.charBoundsFromTextPosition(Na).x),xa.selection.addRange({start:Na,end:Na}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(xa){var Na=xa.selection.start;
Na.row<xa.documentEndPosition.row&&(Na=xa.getPositionAboveOrBelow(-1,Na,!0,0,xa.charBoundsFromTextPosition(Na).x),xa.selection.addRange({start:Na,end:Na}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(xa){var Na=xa.selection.selections[xa.selection.selections.length-1];if(Na.isEmpty())return!0;xa.searchForAll(Na.text,{start:{column:0,row:0}}).forEach(function(ub){return xa.selection.addRange(ub.range,!1)});xa.selection.mergeSelections();qb.arr.remove(xa.selection.selections,
Na);xa.selection.selections.push(Na);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(xa){var Na=xa.selection.selections.length-1,ub=xa.selection.selections[Na];if(ub.isEmpty())return!0;var Q=xa.search(ub.text,{start:ub.end,backwards:!1});Q&&(ub=xa.selection.selections.findIndex(function(wa){return wa.range.equals(Q.range)}),-1<ub?qb.arr.swap(xa.selection.selections,ub,Na):xa.selection.addRange(Q.range));return!0}},{name:"[multi select] more like this backward",
multiSelectAction:"single",exec:function(xa){var Na=xa.selection.selections.length-1,ub=xa.selection.selections[Na];if(ub.isEmpty())return!0;var Q=ub.start,wa=xa.search(ub.text,{start:{row:Q.row,column:Q.column-(ub.text.length-1)},backwards:!0});wa&&(ub=xa.selection.selections.findIndex(function(Xa){return Xa.range.equals(wa.range)}),-1<ub?qb.arr.swap(xa.selection.selections,ub,Na):xa.selection.addRange(wa.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",
exec:function(xa){var Na=xa.selection.selections.length;1<Na&&xa.selection.removeSelections(Na-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(xa){xa.selection.selections=lively.lang.arr.rotate(xa.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(xa){xa.selection.selections=lively.lang.arr.rotate(xa.selection.selections,1);return!0}},{name:"[multi select] align cursors",
multiSelectAction:"single",exec:function(xa){var Na=xa.selection.selections;if(1>=Na.length)return!0;var ub=qb.arr.groupBy(Na,function(wa){return wa.range.start.row});Na=ub.keys().map(function(wa){wa=ub[wa];var Xa=qb.arr.max(wa,function(ib){return ib.range.start.column});qb.arr.without(wa,Xa).forEach(function(ib){return ib.range=Xa.range});return Xa});var Q=qb.arr.max(Na,function(wa){return wa.range.start.column}).range.start.column;Na.forEach(function(wa){var Xa=wa.range.start;wa=Xa.row;Xa=Xa.column;
xa.insertText(" ".repeat(Q-Xa),{row:wa,column:Xa})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(xa){xa.selection.disableMultiSelect();if(xa.selection.isEmpty())var Na=xa.lastSavedMark&&xa.lastSavedMark.position||(void 0).lineRange().start,ub=xa.cursorPosition;else Na=xa.selection,ub=Na.lead,Na=Na.anchor;xa.selection.collapse();var Q=Na.column,wa=ub.column;qb.arr.range(Na.row,ub.row).forEach(function(Xa){return xa.getLine(Xa).length>Math.min(wa,
Q)&&xa.selection.addRange({end:{row:Xa,column:wa},start:{row:Xa,column:Q}},!1)});xa.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(xa,Na,ub){ub=void 0===ub?1:ub;xa.undoManager.group();xa.selection.selections.forEach(function(Q,wa){return Q.text=String(wa+ub)});xa.undoManager.group();return!0}}];qb.multiSelectCommands=nc;qb.multiSelectCommands=nc;qb.multiSelectCommands=nc;var xc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");
xc.pToI=function(xa,Na){return xa.positionToIndex(Na)};xc.iToP=function(xa,Na){return xa.indexToPosition(Na)};xc.execCodeNavigator=function(xa){return function(Na,ub,Q){var wa=Na.pluginInvokeFirst("getNavigator");if(!wa)return!0;Na.saveMark();Q=Q||1;for(var Xa=0;Xa<Q;Xa++)wa[xa](Na,ub);return!0}};xc.once=Ra;var Bd=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:xc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",
exec:xc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:xc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:xc.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:xc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",
bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(xa,Na){function ub(){var Xa=xa.$expandRegionState,ib=xc.pToI(xa,xa.cursorPosition);if(Xa&&(Xa.range[0]===ib||Xa.range[1]===ib))return Xa;Xa=xa.selection.range;return xa.$expandRegionState={range:[xc.pToI(xa,Xa.start),xc.pToI(xa,Xa.end)]}}Na=Na||{};var Q=xa.pluginInvokeFirst("getNavigator");if(!Q)return!0;var wa=Na.start;Na=Na.end;if("number"===typeof wa&&"number"===typeof Na)ub(),Q={range:[wa,Na],
prev:ub()};else{wa=Q.ensureAST(xa);if(!wa)return;Q=Q.expandRegion(xa,xa.textString,wa,ub())}Q&&Q.range&&(xa.selection={start:xc.iToP(xa,Q.range[0]),end:xc.iToP(xa,Q.range[1])},xa.$expandRegionState=Q);xc.once(xa,"selectionChange",function(){return xa.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(xa){if(xa.selection.isEmpty())return!0;var Na=
xa.pluginInvokeFirst("getNavigator");if(!Na)return!0;var ub=Na.ensureAST(xa);if(!ub)return!0;var Q=xa.$expandRegionState;if(!Q)return!0;(Na=Na.contractRegion(xa,xa.textString,ub,Q))&&Na.range&&(xa.selection={start:xc.iToP(xa,Na.range[0]),end:xc.iToP(xa,Na.range[1])},xa.$expandRegionState=Na);xc.once(xa,"selectionChange",function(){return xa.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];xc.commands=Bd;xc.commands=Bd;xc.commands=Bd;var Cd=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");
Cd.arr=Vb;Cd.chain=qd;Cd.string=bd;var ue=[{name:"toggle comment",exec:function(xa){var Na=xa.pluginInvokeFirst("getComment");if(!Na)return!0;if(!Na.lineCommentStart)return Na.blockCommentStart?xa.execCommand("toggle block comment"):!0;var ub=Na.lineCommentStart,Q=new RegExp("^(\\s*)("+ub+"\\s?)(.*)");Na=xa.document;var wa=xa.selection;wa.isEmpty()||0!==wa.end.column||wa.growRight(-1);var Xa=wa.start.row;Na=Na.lineStrings.slice(wa.start.row,wa.end.row+1);Na=Na.some(function(cc){return!!cc.trim()})?
Cd.arr.dropWhile(Na,function(cc){return cc.trim()?!1:++Xa&&!0}):Na;var ib=Na.every(function(cc){return cc.trim()&&cc.match(Q)});xa.undoManager.group();if(ib)Na.forEach(function(cc,ad){if(cc=cc.match(Q)){cc=$jscomp.makeIterator(cc);cc.next();var Vc=cc.next().value,Yc=cc.next().value;cc.next();xa.deleteText({start:{row:Xa+ad,column:Vc.length},end:{row:Xa+ad,column:Vc.length+Yc.length}})}});else{var rc=Na.reduce(function(cc,ad,Vc){return ad.trim()||wa.isEmpty()&&wa.start.row===wa.end.row?Math.min(cc,
ad.match(/^\s*/)[0].length):cc},Infinity);rc=Infinity===rc?0:rc;Na.forEach(function(cc,ad){cc=$jscomp.makeIterator(cc.match(/^(\s*)(.*)/));cc.next();cc.next();cc.next();xa.insertText(ub+" ",{row:Xa+ad,column:rc})})}xa.undoManager.group();return!0}},{name:"toggle block comment",exec:function(xa){var Na=xa.pluginInvokeFirst("getComment");if(!Na)return!0;if(!Na.blockCommentStart)return Na.lineCommentStart?xa.execCommand("toggle comment"):!0;if(!Na||!Na.blockCommentStart)return!0;var ub=Na.blockCommentStart;
Na=Na.blockCommentEnd;var Q=new RegExp("^"+ub.replace(/\*/g,"\\*")),wa=new RegExp(Na.replace(/\*/g,"\\*")+"$"),Xa=xa.tokenAt(xa.cursorPosition);if(Xa&&"comment"===Xa.token){var ib=xa.textInRange(Xa);if(ib.match(Q)&&ib.match(wa))return xa.undoManager.group(),xa.replace(Xa,ib.slice(ub.length,-Na.length)),xa.undoManager.group(),!0}xa.undoManager.group();xa.insertText(ub,xa.selection.start);xa.insertText(Na,xa.selection.end);xa.undoManager.group();ub=!xa.selection.isEmpty();xa.selection.growLeft(Na.length);
ub||xa.selection.collapse();return!0}},{name:"comment box",exec:function(xa,Na,ub){Na=xa.undoManager.ensureNewGroup(xa,"comment box");if(xa.selection.isEmpty())return xa.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),xa.execCommand("toggle comment"),xa.undoManager.group(Na),!0;var Q=xa.selection.range,wa=xa.withSelectedLinesDo(function(ib){return ib}),Xa=Cd.arr.min([Q.start.column].concat(Cd.chain(wa).map(function(ib){return ib.match(/^\s*/)}).flatten().compact().pluck("length").value()));
wa=Cd.arr.max(wa.map(function(ib){return ib.length}))-Xa;wa=Array(Math.ceil(wa/2)+1).join("-=")+"-";xa.execCommand("toggle comment");xa.collapseSelection();xa.cursorPosition={row:Q.start.row,column:0};ub?xa.insertText(Cd.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",Xa)):xa.insertText(Cd.string.indent(wa+"\n"," ",Xa));xa.selection.goUp();xa.execCommand("toggle comment");xa.cursorPosition={row:Q.end.row+2,column:0};xa.insertText(Cd.string.indent(wa+"\n"," ",Xa));xa.selection.goUp();
xa.execCommand("toggle comment");xa.selection.range={start:{row:Q.start.row,column:0},end:xa.cursorPosition};xa.undoManager.group(Na);return!0},multiSelectAction:"forEach",handlesCount:!0}];Cd.commands=ue;Cd.commands=ue;Cd.commands=ue;var jd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");jd.printSymbol=function(xa){if(Symbol.keyFor(xa))return'Symbol.for("'+Symbol.keyFor(xa)+'")';if(jd.knownSymbols.get(xa))return jd.knownSymbols.get(xa);String(xa).match(jd.symMatcher);return String(xa)};
jd.defaultSort=function(xa,Na){if(xa.hasOwnProperty("priority")||Na.hasOwnProperty("priority")){var ub=xa.priority||0,Q=Na.priority||0;if(ub<Q)return-1;if(ub>Q)return 1}xa=(xa.keyString||xa.key).toLowerCase();Na=(Na.keyString||Na.key).toLowerCase();return xa<Na?-1:xa===Na?0:1};jd.safeToString=Nc;jd.propertyNamesOf=function(xa,Na){if(!xa)return[];if(Array.isArray(xa)){var ub=Na?Na.offset:0;return jd.arr.range(ub,ub+(Na?Na.partitionSize:xa.length-1))}return jd.arr.sortBy(Object.keys(xa),function(Q){return Q.toLowerCase()})};
jd.isMultiValue=pd;jd.printValue=Yd;jd.partitionedChildren=function(xa,Na){var ub=void 0===Na?{}:Na;Na=void 0===ub.originalValue?xa:ub.originalValue;var Q=void 0===ub.offset?0:ub.offset;ub=void 0===ub.partitionSize?xa.length||Object.values(xa).length:ub.partitionSize;if(jd.obj.isArray(xa)){xa=jd.num.roundTo(Math.max(jd.MIN_PARTITION_SIZE,ub/50),.1);ub/=xa;for(var wa=[],Xa=0;Xa<ub;Xa++){var ib="["+(Q+Xa*xa)+"-"+(Q+(Xa+1)*xa)+"]";wa.push({partition:{originalValue:Na,offset:Q+Xa*xa,partitionSize:xa},
value:[],key:ib,keyString:ib,valueString:"...",isCollapsed:!0})}return wa}xa=jd.num.roundTo(Math.max(jd.MIN_PARTITION_SIZE,ub/50),.1);ub/=xa;wa=[];Xa=jd.obj.keys(Na).sort();for(ib=0;ib<ub;ib++){var rc=Q+ib*xa,cc=Q+(ib+1)*xa,ad=jd.obj.select(Na,Xa.slice(rc,cc));rc="["+Xa[rc].slice(0,4)+"-"+(Xa[cc]||jd.arr.last(Xa)).slice(0,4)+"]";wa.push({partition:{originalValue:ad,offset:Q+ib*xa,partitionSize:xa},value:[],key:rc,keyString:rc,valueString:"...",isCollapsed:!0})}return wa};jd.propertiesOf=function(xa){var Na=
xa.partition?xa.target:xa.value;if(!Na)return[];var ub={_rev:!0},Q=[],wa="function"===typeof Na.livelyCustomInspect?Na.livelyCustomInspect():{},Xa=Object.assign({},jd.defaultPropertyOptions,{},wa);if(wa.properties){wa=$jscomp.makeIterator(wa.properties);for(var ib=wa.next();!ib.done;ib=wa.next()){var rc=ib.value;ib=rc.key;var cc=rc.hidden,ad=rc.priority,Vc=rc.keyString,Yc=rc.value;rc=rc.valueString;ub[ib]=!0;cc||Q.push(xa.getSubNode({priority:ad,key:ib,keyString:Vc||jd.safeToString(ib),value:Yc,valueString:rc,
isCollapsed:!0}))}}if(Xa.includeDefault){wa=jd.propertyNamesOf(Na,xa.partition);if(wa.length>jd.MAX_NODE_THRESHOLD)for(ub=$jscomp.makeIterator(jd.partitionedChildren(Na,xa.partition)),wa=ub.next();!wa.done;wa=ub.next())Q.push(xa.getSubNode(wa.value));else for(cc=$jscomp.makeIterator(wa),wa=cc.next();!wa.done;wa=cc.next())ad=wa.value,ad in ub||(wa=Na[ad],ib=jd.printValue(wa),wa={keyString:ad,key:ad,value:wa,valueString:ib,isCollapsed:!0},Q.push(xa.getSubNode(wa)));if(Xa.includeSymbols)for(ub=$jscomp.makeIterator(Object.getOwnPropertySymbols(Na)),
wa=ub.next();!wa.done;wa=ub.next())cc=wa.value,ad=jd.safeToString(cc),wa=Na[cc],ib=jd.printValue(wa),wa={key:cc,keyString:ad,value:wa,valueString:ib,isCollapsed:!0},Q.push(xa.getSubNode(wa))}Xa.sort&&(Q=Xa.sortFunction(Na,Q));return Q};jd.obj=Xc;jd.num=wb;jd.arr=Vb;jd.string=bd;jd.connect=Mc;jd.signal=mc;jd.TreeData=dc;jd.newUUID=Rc;jd.localInterface=qa;jd.MAX_NODE_THRESHOLD=1E3;jd.MIN_PARTITION_SIZE=250;jd.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(xa,
Na){return Array.isArray(xa)?Na:Na.sort(jd.defaultSort)}};jd.symMatcher=/^Symbol\((.*)\)$/;jd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(xa){return"symbol"===typeof Symbol[xa]}).reduce(function(xa,Na){return xa.set(Symbol[Na],"Symbol."+Na)},new Map)}();jd.isMultiValue=pd;jd.isMultiValue=pd;jd.printValue=Yd;jd.printValue=Yd;var Gd=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ub=Na.hasOwnProperty("InspectionTree")&&
"function"===typeof Na.InspectionTree?Na.InspectionTree:Na.InspectionTree=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(Q){Eb._get(Object.getPrototypeOf(ub.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Q);this.inspector=Q.inspector;this.root.isInspectionNode||(this.root=jd.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",
get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(Q){Q=void 0===Q?!0:Q;return Eb._get(Object.getPrototypeOf(ub.prototype),"asListWithIndexAndDepth",this).call(this,function(wa){wa=wa.node;return Q?wa.visible:!0})}},{key:"getContextFor",value:function(Q){return Q==this.root?this.root.value.inspectee:Q.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(Q){var wa=void 0===Q.maxDepth?1:Q.maxDepth,Xa=Q.iterator,ib=Q.showUnknown,rc=Q.showInternal,cc=this;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(ad){if(1==ad.nextAddress)return ad.yield(cc.uncollapseAll(function(Vc,Yc){return wa>Yc&&(Vc==cc.root||Vc.value.submorphs)}),2);cc.asListWithIndexAndDepth(!1).forEach(function(Vc){var Yc=Vc.node;return 0==Vc.depth?Yc.visible=!0:!ib&&Yc.keyString&&Yc.keyString.includes("UNKNOWN PROPERTY")||!rc&&Yc.keyString&&Yc.keyString.includes("internal")?Yc.visible=!1:Yc.value&&Yc.value.submorphs?Yc.visible=!0:Yc.visible=Xa(Yc)});ad.jumpToEnd()})}},{key:"getChildren",
value:function(Q){return Q.children}},{key:"display",value:function(Q){return Q.display(this.inspector)}},{key:"isCollapsed",value:function(Q){return Q.isCollapsed}},{key:"isLeaf",value:function(Q){return jd.obj.isPrimitive(Q.value)}},{key:"collapse",value:function(Q,wa){var Xa=this;Q.isCollapsed=wa;wa||this.isLeaf(Q)||Q.children.length||(Q.children=jd.propertiesOf(Q).map(function(ib){Xa.parentMap.set(ib,Q);return ib}))}},{key:"retrieveForRemoteProxy",value:function(Q){Q.uuid||(Q.uuid=jd.newUUID(),
this.idToNodeMap[Q.uuid]=Q);return{uuid:Q.uuid,value:this.isLeaf(Q)?Q.value:{},keyString:Q.keyString,key:Q.keyString,valueString:jd.safeToString(Q.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return jd.localInterface}},{key:"getNodeViaId",value:function(Q){return this.idToNodeMap[Q]}},{key:"asRemoteDelegate",value:function(Q){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext=
{});System.get("@lively-env").remoteInspectionContext[Q]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:"className",get:function(){return"InspectionTree"}},{key:"forObject",value:function(Q,wa){return new this({key:"inspectee",value:{inspectee:Q},isCollapsed:!0,inspector:wa})}}],Na,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:5932,end:8631})}(jd.TreeData);jd.InspectionTree=Gd;jd.InspectionTree=Gd;jd.InspectionTree=Gd;var re=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ub=Na.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Na.RemoteInspectionTree?Na.RemoteInspectionTree:Na.RemoteInspectionTree=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:"systemInterface",
get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(Q){this.parentMap=new WeakMap;this.root=Q.proxy;this.evalEnvironment=Q.evalEnvironment;this.inspector=Q.inspector;this.delegateId=Q.delegateId}},{key:"getContextFor",value:function(Q){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+Q.uuid+'").value'}},{key:"dispose",value:function(){var Q=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){return wa.yield(Q.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+
Q.delegateId+"']\n    ",Q.evalEnvironment),0)})}},{key:"display",value:function(Q){return Q.keyString+": "+Q.valueString}},{key:"collapse",value:function(Q,wa){var Xa=this,ib;return $jscomp.asyncExecutePromiseGeneratorProgram(function(rc){if(1==rc.nextAddress)return(Q.isCollapsed=wa)||Xa.isLeaf(Q)?rc.return():Q.children.length?rc.jumpTo(0):rc.yield(Xa.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+Q.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',
{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Xa.delegateId+'"]'}),3);ib=rc.yieldResult;Q.children=ib.isError?[]:ib.value;rc.jumpToEnd()})}}],[{key:"className",get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(Q,wa){var Xa=this,ib,rc,cc,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Vc){if(1==Vc.nextAddress)return Vc.yield(Xa.createRemoteContext(Q,wa),2);ib=Vc.yieldResult;rc=ib.proxy;cc=
ib.delegateId;ad=ib.evalEnvironment;return Vc.return(new Xa({key:"inspectee",proxy:rc,delegateId:cc,evalEnvironment:ad,inspector:wa}))})}},{key:"createRemoteContext",value:function(Q,wa){var Xa=Q.code,ib=Q.evalEnvironment,rc=Q.delegateId,cc,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Vc){if(1==Vc.nextAddress)return rc="lively://inspector-"+wa.id,Vc.yield(ib.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+
Xa+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+rc+'");\n    ',ib),2);cc=Vc.yieldResult;ad=cc.value;return Vc.return({delegateId:rc,evalEnvironment:ib,proxy:ad})})}}],Na,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8640,end:10983})}(jd.InspectionTree);
jd.RemoteInspectionTree=re;jd.RemoteInspectionTree=re;jd.RemoteInspectionTree=re;(function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ub=Na.hasOwnProperty("InspectionNode")&&"function"===typeof Na.InspectionNode?Na.InspectionNode:Na.InspectionNode=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(Q){var wa=
Q.root,Xa=Q.priority,ib=Q.key,rc=Q.keyString,cc=Q.value,ad=Q.valueString,Vc=Q.isCollapsed,Yc=void 0===Q.children?[]:Q.children,$d=void 0===Q.isSelected?!1:Q.isSelected,Mf=void 0===Q.visible?!0:Q.visible;this.partition=Q.partition;this.priority=Xa;this.key=ib;this.keyString=String(rc||ib);this.value=cc;this.valueString=ad||jd.printValue(cc);this.isCollapsed=Vc;this.children=Yc;this.isSelected=$d;this.visible=Mf;this.root=wa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",
get:function(){return!0}},{key:"getSubNode",value:function(Q){if(Q.value&&Q.value.isMorph)return new jd.MorphNode(Object.assign({root:this.root},Q));var wa=Q.key,Xa=Q.keyString,ib=this.value,rc=Q.partition;rc&&(ib=rc.originalValue,Xa=wa);return new jd.PropertyNode(Object.assign({},Q,{keyString:Xa,key:wa,target:ib,partition:rc,root:this.root,spec:{}}))}},{key:"display",value:function(Q){var wa=this.keyString,Xa=this.valueString;if(!this.interactive)return wa+": "+Xa;this._propertyWidget||(this._propertyWidget=
Q.renderDraggableTreeLabel({value:wa+": "+Xa}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:"className",get:function(){return"InspectionNode"}},{key:"for",value:function(Q,wa){wa=void 0===wa?null:wa;return Q.value&&Q.value.isMorph?new jd.MorphNode(Object.assign({root:wa},Q)):new jd.InspectionNode(Object.assign({root:wa},Q))}}],Na,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10985,end:13522})})(void 0);(function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ub=Na.hasOwnProperty("MorphNode")&&"function"===typeof Na.MorphNode?Na.MorphNode:Na.MorphNode=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:Symbol.for("lively-instance-initialize"),
value:function(Q){Eb._get(Object.getPrototypeOf(ub.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Q);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(Q){var wa=this.propertyInfo[Q.key]||{};return Q.value&&Q.value.isMorph?new jd.MorphNode(Object.assign({},Q,{root:this.root})):new jd.PropertyNode(Object.assign({},Q,{root:this.root,target:this.target,spec:wa}))}}],[{key:"className",get:function(){return"MorphNode"}}],
Na,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13524,end:14670})})(jd.InspectionNode);(function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ub=Na.hasOwnProperty("PropertyNode")&&"function"===typeof Na.PropertyNode?Na.PropertyNode:Na.PropertyNode=
function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(Q){Eb._get(Object.getPrototypeOf(ub.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Q);var wa=Q.spec,Xa=Q.target;this.partition=Q.partition;this.target=Xa;this.spec=wa;this.foldedNodes={}}},{key:"__deserialize__",value:function(Q,wa){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},
{key:"interactive",set:function(Q){this._interactive=Q}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(Q){return this.isFoldable?this.getFoldedContext(Q):Eb._get(Object.getPrototypeOf(ub.prototype),"getSubNode",this).call(this,Q)}},{key:"getFoldedContext",value:function(Q){return this.foldedNodes[Q.key]=new jd.FoldedNode(Object.assign({},Q,{root:this.root,
target:this.target,foldableNode:this,spec:jd.obj.dissoc(this.spec,["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(Q,wa){(wa=void 0===wa?!1:wa)&&(this.target[this.key]=Q);this.value=this.target[this.key];this.valueString=jd.printValue(this.value);this.interactive&&(wa||this._propertyWidget.highlight());if(this.isFoldable)for(var Xa in this.foldedNodes)this.foldedNodes[Xa].value=this.value[Xa],this.foldedNodes[Xa].valueString=
jd.printValue(this.value[Xa]),this.foldedNodes[Xa]._propertyWidget&&jd.signal(this.foldedNodes[Xa]._propertyWidget,"update",this.value[Xa])}},{key:"display",value:function(Q){var wa=this,Xa=this._propertyWidget,ib=this.keyString,rc=this.valueString,cc=this.target,ad=this.value,Vc=this.spec;if(!(this.interactive||Vc.foldable&&jd.isMultiValue(ad,Vc.foldable)))return Q.renderPropertyControl({target:cc,keyString:ib,valueString:rc,tree:Q.ui.propertyTree,value:ad,spec:Vc,node:this,fastRender:!0});if(Xa)return Xa.keyString=
ib,Xa.valueString=rc,Xa.isSelected=this.isSelected,Xa.control&&(Xa.control.isSelected=this.isSelected),Xa;Xa=this._propertyWidget=Q.renderPropertyControl({target:cc,keyString:ib,valueString:rc,value:ad,spec:Vc,node:this,isSelected:this.isSelected,fontColor:Q.ui.propertyTree.fontColor});this.isInternalProperty||Vc.readOnly||(jd.connect(Xa,"propertyValue",this,"refreshProperty",{updater:function(Yc,$d){return Yc($d,!0)}}),jd.connect(Xa,"openWidget",this.root,"onWidgetOpened",{converter:function(Yc){return{widget:Yc,
node:wa.sourceObj}}}));return Xa}}],[{key:"className",get:function(){return"PropertyNode"}}],Na,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14672,end:18071})})(jd.InspectionNode);(function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ub=
Na.hasOwnProperty("FoldedNode")&&"function"===typeof Na.FoldedNode?Na.FoldedNode:Na.FoldedNode=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(Q){Eb._get(Object.getPrototypeOf(ub.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Q);this.foldableNode=Q=Q.foldableNode;this.foldedProp=Q.key+jd.string.capitalize(this.key)}},{key:"refreshProperty",
value:function(Q,wa){wa=void 0===wa?!1:wa;var Xa={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Xa[this.key]=Q,Xa)),wa)}}],[{key:"className",get:function(){return"FoldedNode"}}],Na,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18073,
end:18749})})(jd.PropertyNode);var He=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");He.Color=db;var yf=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),ub=Na.hasOwnProperty("DarkTheme")&&"function"===typeof Na.DarkTheme?Na.DarkTheme:Na.DarkTheme=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:"background",get:function(){return He.Color.rgb(44,62,
80)}},{key:"cursorColor",get:function(){return He.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},
{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:He.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:He.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:He.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},
{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},
{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:He.Color.white,fontWeight:"bold",backgroundColor:He.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:He.Color.rgba(204,
204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:He.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:"className",get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Na,{pathInPackage:function(){return"themes/dark.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3048})}(void 0),tf=yf=He.DarkTheme;He.default=yf;var yc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");yc.inspect=uc;yc.remoteInspect=Qd;yc.generateReferenceExpression=cd;yc.onNumberDragStart=function(xa,Na){Na.initPos=xa.position;Na.factorLabel=(new yc.Tooltip({description:"1x"})).openInWorld(xa.hand.position.addXY(10,10))};yc.onNumberDrag=
function(xa,Na){var ub=yc.getScaleAndOffset(xa,Na),Q=ub.scale;ub=ub.offset;Na.factorLabel.position=xa.hand.position.addXY(10,10);Na.factorLabel.description=Q+"x";return yc.getCurrentValue(ub,Q,Na)};yc.onNumberDragEnd=function(xa,Na){var ub=yc.getScaleAndOffset(xa,Na);xa=ub.offset;ub=ub.scale;Na.factorLabel.softRemove();return yc.getCurrentValue(xa,ub,Na)};yc.getScaleAndOffset=function(xa,Na){var ub=xa.position.subPt(Na.initPos);xa=ub.x;Na=yc.num.roundTo(Math.exp(-ub.y/$world.height*6),.01)*Na.baseFactor;
return{offset:xa,scale:Na}};yc.getCurrentValue=function(xa,Na,ub){return Math.max(ub.min,Math.min(ub.max,ub.scrubbedValue+(ub.floatingPoint?xa*Na:Math.round(xa*Na))))};yc.Color=db;yc.Rectangle=Wb;yc.rect=Tc;yc.pt=wd;yc.obj=Xc;yc.num=wb;yc.Path=zc;yc.arr=Vb;yc.promise=Fc;yc.connect=Mc;yc.disconnect=Jb;yc.once=Ra;yc.Morph=Ac;yc.Tooltip=Bc;yc.VerticalLayout=fd;yc.GridLayout=Qb;yc.HorizontalLayout=xb;yc.morph=Ic;yc.CustomLayout=eb;yc.Label=vb;yc.Icon=Va;yc.StyleSheet=Jc;yc.config=lb;yc.Tree=yb;yc.LoadingIndicator=
Zb;yc.DropDownList=Sb;yc.DropDownSelector=$a;yc.SearchField=bb;yc.LabeledCheckBox=Kb;yc.MorphHighlighter=bc;yc.InteractiveMorphSelector=Tb;yc.printValue=Yd;yc.RemoteInspectionTree=re;yc.InspectionTree=Gd;yc.isMultiValue=pd;yc.valueWidgets=I;yc.popovers=T;yc.DarkTheme=tf;yc.DefaultTheme=sb;yc.syncEval=wc;yc.inspectorCommands=[{name:"focus codeEditor",exec:function(xa){xa.get("codeEditor").show();xa.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(xa){xa.get("propertyTree").show();
xa.get("propertyTree").focus();return!0}}];(function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ub=Na.hasOwnProperty("DraggedProp")&&"function"===typeof Na.DraggedProp?Na.DraggedProp:Na.DraggedProp=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:"applyToTarget",value:function(Q){var wa=this.currentTarget,Xa=this.control;this.remove();yc.MorphHighlighter.removeHighlighters(Q.world);
if(wa)if(wa.isText&&"js"===wa.editorModeName){var ib=wa.evalEnvironment.context;Q=wa.textPositionFromPoint(wa.localize(Q.position));ib=yc.generateReferenceExpression(this.sourceObject,{fromMorph:ib});Xa.keyString&&(ib+="."+Xa.keyString);wa.insertTextAndSelect(ib,Q);wa.focus()}else"propertyValue"in Xa&&(wa[Xa.keyString]=Xa.propertyValue)}},{key:"update",value:function(Q){Q=Q.hand.globalPosition;var wa=this.morphBeneath(Q),Xa;if(wa){for(wa==this.morphHighlighter&&(wa=wa.morphBeneath(Q));Xa=[wa].concat($jscomp.arrayFromIterable(wa.ownerChain())).find(function(ib){return!ib.visible});)wa=
Xa=Xa.morphBeneath(Q);if(wa!=this.currentTarget){this.currentTarget=wa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(wa.isWorld)return;this.morphHighlighter=yc.MorphHighlighter.for($world,wa);this.morphHighlighter.show()}this.position=Q}}}],[{key:"className",get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:yc.Color.rgb(169,204,227)},fill:{defaultValue:yc.Color.rgb(235,245,251).withA(.8)},borderWidth:{defaultValue:2},
borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var Q=this.control;if(!Q)return this.submorphs=[];this.height=22;this.submorphs=[Q];Q.top=0;Q.fontSize=14;"function"===typeof Q.relayout&&Q.relayout();this.width=Q.width+20;this.adjustOrigin(yc.pt(10,10))}}}}}],Na,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:1268,end:3690})})(yc.Morph);(function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ub=Na.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Na.DraggableTreeLabel?Na.DraggableTreeLabel:Na.DraggableTreeLabel=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:"inspector",get:function(){return this.owner.owner}},{key:"onDragStart",value:function(Q){this.draggedProp=
new yc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();yc.connect(Q.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(Q){}},{key:"onDragEnd",value:function(Q){yc.disconnect(Q.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(Q)}}],[{key:"className",get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},draggable:{defaultValue:!0},
nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:yc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:yc.Color.transparent},padding:{defaultValue:yc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(Q){this.setProperty("isSelected",Q);Q?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=Q)}}}}}],Na,{pathInPackage:function(){return"js/inspector.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3692,end:5015})})(yc.Label);Gd=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ub=Na.hasOwnProperty("PropertyControl")&&"function"===typeof Na.PropertyControl?Na.PropertyControl:Na.PropertyControl=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(Q,wa,Xa){Q.control=new yc.DropDownSelector({opacity:.8,fill:yc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:wa,padding:0,values:Xa});yc.connect(Q.control,"update",Q,"propertyValue",{updater:function(ib,rc){this.targetObj.propertyValue!=rc&&ib(rc)}});yc.connect(Q,"update",
Q.control,"selectedValue",{updater:function(ib,rc){rc=rc&&rc.valueOf?rc.valueOf():rc;this.targetObj.propertyValue!=rc&&ib(rc)}});return Q}},{key:"toggleMultiValuePlaceholder",value:function(Q){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:yc.Color.transparent,layout:new yc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:yc.arr.range(0,2).map(function(wa){return{type:"ellipse",fill:yc.Color.gray.withA(.5),reactsToPointer:!1,
extent:yc.pt(7,7)}})});Q?(yc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(yc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(Q){this.foldableProperties&&this.toggleMultiValuePlaceholder(yc.isMultiValue(Q,this.foldableProperties))}},
{key:"asFoldable",value:function(Q){this.foldableProperties=Q;yc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+": "+this.valueString}},{key:"highlight",
value:function(){this.highlighter&&this.highlighter.remove();var Q=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});Q.isLayoutable=!1;Q.fontWeight="bold";Q.fontColor=yc.Color.orange;Q.reactsToPointer=!1;Q.fadeOut(2E3)}}],[{key:"className",get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],derived:!0,get:function(){return this.submorphs[0]||!1},set:function(Q){this.submorphs=
[Q]}},layout:{initialize:function(){this.layout=new yc.CustomLayout({relayout:function(Q){Q.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(Q){return(Q=Q.value)&&(Q.isColor||Q.isGradient)?"Color":Q&&Q.isPoint?"Point":yc.obj.isBoolean(Q)?"Boolean":yc.obj.isNumber(Q)?"Number":yc.obj.isString(Q)?"String":Q&&Q.isRectangle?"Rectangle":!1}},{key:"render",value:function(Q){Q.spec.type||(Q.spec=Object.assign({},Q.spec,{type:this.inferType(Q)}));
switch(Q.spec.type){case "Color":var wa=this.renderColorControl(Q);break;case "ColorGradient":wa=this.renderColorControl(Object.assign({},Q,{gradientEnabled:!0}));break;case "Number":wa=this.renderNumberControl(Q);break;case "String":wa=this.renderStringControl(Q);break;case "RichText":wa=this.renderStringControl(Q);break;case "Layout":wa=this.renderLayoutControl(Q);break;case "Enum":wa=this.renderEnumControl(Q);break;case "Shadow":wa=this.renderShadowControl(Q);break;case "Point":wa=this.renderPointControl(Q);
break;case "Rectangle":wa=this.renderRectangleControl(Q);break;case "Boolean":wa=this.renderBooleanControl(Q);break;default:wa=this.renderItSomehow(Q)}wa.control&&(yc.connect(wa.control,"openWidget",wa,"openWidget"),wa.toggleFoldableValue(Q.value));return wa}},{key:"baseControl",value:function(Q){var wa=Q.spec;Q=new this({keyString:Q.keyString,valueString:Q.valueString,isSelected:!1,propertyValue:Q.value});wa.foldable&&Q.asFoldable(wa.foldable);return Q}},{key:"renderGrabbableKey",value:function(Q){var wa=
this,Xa=Q.target;return[Q.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(ib){ib.state.draggedProp=new yc.DraggedProp({sourceObject:Xa,control:wa.baseControl(Q)});ib.state.draggedProp.openInWorld();yc.connect(ib.hand,"update",ib.state.draggedProp,"update")},onDrag:function(ib){},onDragEnd:function(ib){yc.disconnect(ib.hand,"update",ib.state.draggedProp,"update");ib.state.draggedProp.applyToTarget(ib)}}]}},{key:"renderEnumControl",value:function(Q){var wa=Q.value,Xa=Q.spec.values,ib=
Q.keyString,rc=Q.target,cc=Q.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" "+(wa?wa.valueOf?wa.valueOf():wa:"Not set"),{nativeCursor:"pointer",onMouseDown:function(ad,Vc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yc){rc.world().openWorldMenu(ad,Xa.map(function($d){return{string:$d.toString(),action:function(){rc[ib]=$d;cc.rerender()}}}));Yc.jumpToEnd()})}}],$jscomp.arrayFromIterable(yc.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",
opacity:.7})))}},{key:"renderStringControl",value:function(Q){var wa=Q.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" "+(200<wa.length?wa.slice(0,20)+"...":wa),{fontColor:yc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(Q){var wa=Q.value,Xa=Q.keyString,ib=Q.valueString,rc=Q.target,cc=Q.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" "+ib,{fontColor:yc.Color.black,nativeCursor:"pointer",onMouseDown:function(ad){var Vc;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yc){if(1==Yc.nextAddress)return Vc=new yc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:wa}),Vc.relayout(),Yc.yield(Vc.fadeIntoWorld(ad.positionIn(rc.world())),2);yc.connect(Vc,"rectangle",function($d){rc[Xa]=$d;cc.rerender()});Yc.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(Q){var wa=Q.value,Xa=Q.keyString,ib=Q.valueString,rc=Q.target,cc=Q.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),
[" "+ib,{nativeCursor:"pointer",fontColor:wa?yc.Color.green:yc.Color.red,onMouseDown:function(ad){rc[Xa]=!rc[Xa];cc.rerender()}}])}},{key:"renderNumberControl",value:function(Q){var wa=Q.value,Xa=Q.spec,ib=Q.keyString,rc=Q.valueString,cc=Q.node,ad=Q.target,Vc=Q.tree,Yc=void 0===cc._numberControls?new Ie:cc._numberControls,$d=$jscomp.makeIterator(Yc.submorphs),Mf=$d.next().value,Bf=$d.next().value;Yc.fontColor=Vc.fontColor;var Hg=cc._numberControls=Yc;"max"in Xa&&"min"in Xa&&-Infinity!=Xa.min&&Infinity!=
Xa.max?(Hg.baseFactor=(Xa.max-Xa.min)/100,Hg.floatingPoint=Xa.isFloat,Hg.max=Xa.max,Hg.min=Xa.min):(Hg.floatingPoint=Xa.isFloat,Hg.baseFactor=.5,Hg.min=void 0!=Xa.min?Xa.min:-Infinity,Hg.max=void 0!=Xa.max?Xa.max:Infinity);var cf=yc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),$jscomp.arrayFromIterable(cc._inputMorph?[cc._inputMorph,{}]:[" "+(void 0!=wa&&(wa.valueOf?wa.valueOf():wa).toFixed(Xa.isFloat?3:0))+" ",{fontColor:cf,
onMouseUp:function(Bg){cc._inputMorph=yc.morph({type:"input",fill:null,fontColor:cf,fontFamily:"IBM Plex Mono",fontSize:14,padding:yc.rect(8,2,-6,2),height:23,cursorColor:yc.Color.white,value:wa.valueOf?wa.valueOf():rc});ad[ib]=wa;cc._inputMorph.focus();yc.once(cc._inputMorph,"inputAccepted",function(Di){delete cc._inputMorph;ad[ib]=Xa.isFloat?Number.parseFloat(Di):Number.parseInt(Di);cc.rerender()});yc.once(cc._inputMorph,"onBlur",function(Di){cc._inputMorph&&(delete cc._inputMorph,ad[ib]=wa,cc.rerender())});
cc.rerender()},onDragStart:function(Bg){Hg.scrubbedValue=wa;yc.onNumberDragStart(Bg,Hg)},onDrag:function(Bg){ad[ib]=yc.onNumberDrag(Bg,Hg);cc.rerender()},onDragEnd:function(Bg){return yc.onNumberDragEnd(Bg,Hg)}},Yc,{onMouseUp:function(){Mf.fill=Bf.fill=null},onMouseDown:function(Bg){if(Bg.targetMorph===Mf){Mf.fill=yc.Color.white.withA(.2);if("max"in Xa&&ad[ib]>=Xa.max)return;ad[ib]+=1}if(Bg.targetMorph===Bf){Bf.fill=yc.Color.white.withA(.2);if("min"in Xa&&ad[ib]<=Xa.min)return;--ad[ib]}cc.rerender()}}]))}},
{key:"renderShadowControl",value:function(Q){var wa=Q.keyString,Xa=Q.value,ib=Q.target,rc=Q.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[""+(Xa?Xa.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(cc){var ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Vc){if(1==Vc.nextAddress)return ad=new yc.popovers.ShadowPopover({shadowValue:ib[wa],hasFixedPosition:!0}),Vc.yield(ad.fadeIntoWorld(cc.positionIn(ib.world())),2);yc.connect(ad,"shadowValue",
function(Yc){ib[wa]=Yc;rc.rerender()});Vc.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(Q){var wa=Q.keyString,Xa=Q.value,ib=Q.target,rc=Q.node,cc=yc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,ad={nativeCursor:"pointer",onMouseDown:function(Vc){var Yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function($d){if(1==$d.nextAddress)return Yc=new yc.popovers.PointPopover({pointValue:ib[wa],hasFixedPosition:!0}),$d.yield(Yc.fadeIntoWorld(Vc.positionIn(ib.world())),
2);yc.connect(Yc,"pointValue",function(Mf){ib[wa]=Mf;rc.rerender()});$d.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" pt(",Object.assign({},ad),""+Xa.x.toFixed(),Object.assign({fontColor:cc},ad),",",Object.assign({},ad),""+Xa.y.toFixed(),Object.assign({fontColor:cc},ad),")",Object.assign({},ad)])}},{key:"renderLayoutControl",value:function(Q){var wa=Q.valueString,Xa=Q.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" "+(Xa?wa:
"No Layout"),{onMouseDown:function(ib){}}])}},{key:"renderColorControl",value:function(Q){var wa=Q.node,Xa=Q.gradientEnabled,ib=Q.valueString,rc=Q.keyString,cc=Q.value,ad=Q.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[yc.morph({fill:cc.valueOf?cc.valueOf():cc,extent:yc.pt(15,15),borderColor:yc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+(cc?cc.valueOf?cc.valueOf():ib:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Vc){var Yc;
return $jscomp.asyncExecutePromiseGeneratorProgram(function($d){if(1==$d.nextAddress)return Yc=new yc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:ad,fillValue:cc,title:"Fill Control",gradientEnabled:Xa}),$d.yield(Yc.fadeIntoWorld(Vc.positionIn(ad.world())),2);yc.connect(Yc,"fillValue",function(Mf){ad[rc]=Mf;wa.rerender()});$d.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(Q){var wa=Q.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(Q)),[" "+wa,{}])}}],
Na,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5024,end:20444})}(yc.DraggableTreeLabel);yc.PropertyControl=Gd;yc.PropertyControl=Gd;yc.PropertyControl=Gd;yc.inspect=uc;yc.inspect=uc;yc.remoteInspect=Qd;yc.remoteInspect=Qd;yc.generateReferenceExpression=cd;yc.generateReferenceExpression=
cd;var Ie=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ub=Na.hasOwnProperty("NumberControls")&&"function"===typeof Na.NumberControls?Na.NumberControls:Na.NumberControls=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,void 0,[{key:"className",get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new yc.VerticalLayout({spacing:0,
orderByIndex:!0})}},fill:{defaultValue:yc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(Q){this.submorphs.map(function(wa){return wa.fontColor=Q})}},submorphs:{initialize:function(){this.submorphs=[yc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:yc.rect(5,2,0,-6),fontSize:12}),yc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:yc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],Na,{pathInPackage:function(){return"js/inspector.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23095,end:24127})}(yc.Morph);(function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ub=Na.hasOwnProperty("PropertyTree")&&"function"===typeof Na.PropertyTree?Na.PropertyTree:Na.PropertyTree=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return Eb(ub,xa,[{key:"onDrag",value:function(Q){this._onDragHandler&&this._onDragHandler(Q)}}],[{key:"className",get:function(){return"PropertyTree"}}],Na,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25279,end:25389})})(yc.Tree);Gd=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),
ub=Na.hasOwnProperty("Inspector")&&"function"===typeof Na.Inspector?Na.Inspector:Na.Inspector=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(Q){}},{key:"__after_deserialize__",value:function(){var Q=this,wa=new yc.PropertyTree(Object.assign({name:"propertyTree"},
this.treeStyle,{treeData:yc.InspectionTree.forObject(null,this)}));this.addMorph(wa,this.getSubmorphNamed("terminal toggler"));this.layout.col(0).row(1).group.morph=wa;this.whenRendered().then(function(){Q.targetObject&&(Q.targetObject=Q.targetObject)});Eb._get(Object.getPrototypeOf(ub.prototype),"__after_deserialize__",this).call(this)}},{key:"__additionally_serialize__",value:function(Q,wa,Xa,ib){Q=Q.props.submorphs.value;for(wa=Q.length;wa--;)Xa.refForId(Q[wa].id).realObj==this.ui.propertyTree&&
yc.arr.removeAt(Q,wa)}},{key:"renderDraggableTreeLabel",value:function(Q){return new yc.DraggableTreeLabel(Q)}},{key:"renderPropertyControl",value:function(Q){return yc.PropertyControl.render(Q)}},{key:"onLoad",value:function(){var Q=this.ui,wa=Q.codeEditor,Xa=Q.thisBindingSelector,ib=Q.propertyTree;wa.changeEditorMode("js").then(function(){return wa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Xa.selection?wa.owner.selectedContext:wa.owner.targetObject},
get systemInterface(){return yc.Path("treeData.systemInterface").get(ib)},format:"esm"}}).catch(function(rc){return $world.logError(rc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(Q){Eb._get(Object.getPrototypeOf(ub.prototype),Symbol.for("lively-instance-initialize"),this).call(this,Q);Q=this.ui;var wa=Q.targetPicker,Xa=Q.propertyTree,ib=Q.resizer,rc=Q.terminalToggler,cc=Q.unknowns,ad=Q.internals,Vc=Q.searchField,Yc=Q.codeEditor,$d=Q.fixImportButton,Mf=Q.thisBindingSelector;Yc.changeEditorMode("js").then(function(){return Yc.evalEnvironment=
{targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Mf.selection?Yc.owner.selectedContext:Yc.owner.targetObject},get systemInterface(){return Xa.treeData.systemInterface},format:"esm"}}).catch(function(Bf){return $world.logError(Bf)});yc.connect(wa,"onMouseDown",this,"selectTarget");yc.connect(Xa,"onScroll",this,"repositionOpenWidget");yc.connect(ib,"onDrag",this,"adjustProportions");yc.connect(rc,"onMouseDown",this,"toggleCodeEditor");yc.connect(cc,"trigger",this,"filterProperties");
yc.connect(ad,"trigger",this,"filterProperties");yc.connect(Vc,"searchInput",this,"filterProperties");yc.connect(Xa,"nodeCollapseChanged",this,"filterProperties");yc.connect(this,"extent",this,"relayout");yc.connect(Mf,"selection",this,"bindCodeEditorThis");yc.connect($d,"fire",Yc,"execCommand",{updater:function(Bf){return Bf("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var Q=this.ui.propertyTree.selectedIndex-1,wa=this.ui.propertyTree.selectedNode;
this.ui.propertyTree.selectedNode.refreshProperty();wa=this.ui.propertyTree.document.getLine(Q).textAndAttributes.slice(0,4).concat(wa.display(this));Q=this.ui.propertyTree.lineRange(Q,!1);this.ui.propertyTree.replace(Q,wa,!1,!1,!1);this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),
this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var Q=yc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(Q!=this.lastChange||this.lastSubmorphs!=yc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==Q.prop&&this.repositionOpenWidget(),this.lastChange=Q,this.lastSubmorphs=yc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}}},{key:"refreshTreeView",value:function(){var Q;
this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(wa){wa=wa.node;wa.target&&(Q=wa.foldableNode?wa.target[wa.foldableNode.key][wa.key]:wa.target[wa.key],!yc.obj.equals(Q,wa.value)&&wa.refreshProperty&&wa.refreshProperty(Q))});this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(Q,wa){wa=void 0===wa?!1:wa;var Xa=this,ib,rc,cc,ad,Vc,Yc,$d,Mf,Bf,Hg,cf,Bg,Di,Pg,Nj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Pe){switch(Pe.nextAddress){case 1:if(!Xa.isUpdating()){Pe.jumpTo(2);
break}return Pe.yield(Xa.whenUpdated(),2);case 2:ib=yc.promise.deferred();rc=ib.promise;cc=!!Xa.target;Xa.updateInProgress=rc;Pe.setCatchFinallyBlocks(4);wa&&(ad=yc.LoadingIndicator.open("connecting to remote..."));if(!wa){Vc=yc.InspectionTree.forObject(Q,Xa);Pe.jumpTo(6);break}return Pe.yield(yc.RemoteInspectionTree.forObject(Q,Xa),7);case 7:Vc=Pe.yieldResult;case 6:return Yc=Vc,$d=Xa.ui.propertyTree,Pe.yield(Yc.collapse(Yc.root,!1),8);case 8:if(!Yc.root.children){Pe.jumpTo(9);break}return Pe.yield(Yc.collapse(Yc.root.children[0],
!1),9);case 9:if(Mf=Xa.originalTreeData&&Xa.originalTreeData.diff(Yc)){Bf=$jscomp.makeIterator(Mf);for(Hg=Bf.next();!Hg.done;Hg=Bf.next())cf=Hg.value,Bg=$jscomp.makeIterator(cf),Di=Bg.next().value,Pg=Bg.next().value,Di.refreshProperty(Pg.value);Pe.jumpTo(11);break}$d.treeData=Yc;return Pe.yield(Xa.filterProperties(),12);case 12:if(!$d.treeData.root.isCollapsed){Pe.jumpTo(13);break}return Pe.yield($d.onNodeCollapseChanged({node:Yc.root,isCollapsed:!1}),14);case 14:$d.selectedIndex=1;case 13:return Pe.yield($d.execCommand("uncollapse selected node"),
11);case 11:Xa.toggleWindowStyle(cc);ad&&ad.remove();Pe.leaveTryBlock(5);break;case 4:Nj=Pe.enterCatchBlock(),Xa.showError(Nj);case 5:Xa.startStepping(1E3,"refreshAllProperties"),Xa.updateInProgress=null,Pe.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(Q){Q=void 0===Q?!0:Q;var wa=this,Xa,ib,rc,cc,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Vc){if(1==Vc.nextAddress)return Xa=300,cc=wa.ui.codeEditor.pluginFind(function(Yc){return Yc.runEval}),ad=wa.getWindow(),Vc.yield(cc.runEval("System.get('@system-env').node"),
2);Vc.yieldResult.value?(rc=[].concat($jscomp.arrayFromIterable(yc.arr.without(ad.styleClasses,"local")),["node"]),ib=yc.DarkTheme.instance):(rc=["local"].concat($jscomp.arrayFromIterable(ad?yc.arr.without(ad.styleClasses,"node"):[])),ib=yc.DefaultTheme.instance);cc.theme=ib;Q?(ad&&ad.animate({duration:Xa,styleClasses:rc}),wa.ui.codeEditor.animate({fill:ib.background,duration:Xa})):ad&&(ad.styleClasses=rc);wa.ui.codeEditor.textString=wa.ui.codeEditor.textString;cc.highlight();Vc.jumpToEnd()})}},{key:"isUpdating",
value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var Q=this,wa=Object.assign({type:"text",borderWidth:1,borderColor:yc.Color.gray,lineWrapping:"by-chars"},yc.config.codeEditor.defaultStyle,{textString:""}),Xa=yc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});yc.rect(0,0,this.width,30);var ib=new yc.SearchField({styleClasses:["idle"],
name:"searchField"});Xa[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[ib,{type:"button",name:"targetPicker",padding:yc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:yc.Icon.textAttribute("crosshairs")},new yc.LabeledCheckBox({label:"Internals",name:"internals"}),new yc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new yc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:yc.InspectionTree.forObject(null,
this)})),yc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},wa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:yc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Xa),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Xa),[" selection",null])}]}];
this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){Q.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var Q=this,wa,Xa,ib,rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cc){switch(cc.nextAddress){case 1:if(Q.env.eventDispatcher.isKeyPressed("Shift"))return Xa=$jscomp,ib=Xa.makeIterator,cc.yield($world.execCommand("select morph",{justReturn:!0}),
5);Q.toggleSelectionInstructions(!0);return cc.yield(yc.InteractiveMorphSelector.selectMorph(),4);case 4:wa=cc.yieldResult;Q.toggleSelectionInstructions(!1);cc.jumpTo(3);break;case 5:rc=ib.call(Xa,cc.yieldResult),wa=rc.next().value;case 3:wa&&(Q.targetObject=wa),cc.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(Q){if(Q&&!this.instructionWidget){var wa=yc.morph({type:"label",name:"escapeKey",value:"esc"});wa.whenRendered().then(function(){return wa.fit()});this.instructionWidget=
this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},wa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(Q){Q=
Q.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;Q.epiMorph=!0;this.openWidget=Q;yc.once(Q,"close",this,"closeOpenWidget");yc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var Q=this.ui.propertyTree,wa=Q.textLayout.boundsFor(Q,{column:0,row:Q.selectedIndex-1});wa=Q.worldPoint(yc.pt(wa.x,wa.y+wa.height/2)).addPt(Q.scroll.negated());Q=Q.globalBounds();wa.x=this.globalBounds().center().x;
wa.y<Q.top()?wa=Q.topCenter():Q.bottom()-20<wa.y&&(wa=Q.bottomCenter().addXY(0,-20));return wa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(Q){this.layout.row(1).height+=Q.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(Q){if(Q!==this.isEditorVisible()){var wa=this.extent,
Xa=this.layout,ib=this.ui,rc=ib.terminalToggler,cc=ib.codeEditor,ad=ib.thisBindingSelector;ib=ib.fixImportButton;Xa.disable();Q?(rc.fontColor=yc.Color.rgbHex("00e0ff"),Xa.row(3).height=this.codeEditorHeight||180,Xa.row(2).height=5,ib.animate({visible:!0,duration:200}),ad.animate({visible:!0,duration:200})):(this.codeEditorHeight=Xa.row(3).height,rc.fontColor=yc.Color.white,Xa.row(3).height=Xa.row(2).height=0,ib.animate({visible:!1,duration:200}),ad.animate({visible:!1,duration:200}));this.extent=
wa;Xa.enable({duration:200});this.relayout({duration:200});cc.focus();cc.animate({opacity:Q?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var Q=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){Q.makeEditorVisible(!Q.isEditorVisible());wa.jumpToEnd()})}},{key:"filterProperties",value:function(){var Q=this,wa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){if(1==ib.nextAddress)return wa=Q.ui.searchField,Xa=Q.ui.propertyTree,Q.originalTreeData||
(Q.originalTreeData=Xa.treeData),yc.disconnect(Xa.treeData,"onWidgetOpened",Q,"onWidgetOpened"),ib.yield(Xa.treeData.filter({maxDepth:2,showUnknown:Q.ui.unknowns.checked,showInternal:Q.ui.internals.checked,iterator:function(rc){return wa.matches(rc.key)}}),2);Xa.update();yc.connect(Xa.treeData,"onWidgetOpened",Q,"onWidgetOpened");ib.jumpToEnd()})}},{key:"relayout",value:function(Q){Q=void 0===Q?{}:Q;var wa=this,Xa,ib,rc,cc,ad,Vc,Yc,$d,Mf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Bf){wa.layout&&
wa.layout.forceLayout();Xa=wa;ib=Xa.ui;rc=ib.fixImportButton;cc=ib.terminalToggler;ad=ib.propertyTree;Vc=ib.thisBindingSelector;Yc=ad.bounds().insetBy(5).bottomLeft();$d=ad.bounds().insetBy(5).bottomRight();Mf=$d.subXY(rc.width+10,0);Vc.width=115;Vc.listMorph.itemHeight=20;Q.duration?(cc.animate(Object.assign({bottomLeft:Yc},Q)),rc.animate(Object.assign({bottomRight:$d},Q)),Vc.animate(Object.assign({bottomRight:Mf},Q))):(cc.bottomLeft=Yc,rc.bottomRight=$d,Vc.bottomRight=Mf);Bf.jumpToEnd()})}},{key:"keybindings",
get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(Eb._get(Object.getPrototypeOf(ub.prototype),"keybindings",this))}},{key:"commands",get:function(){return yc.inspectorCommands}}],[{key:"className",get:function(){return"Inspector"}},{key:"openInWindow",value:function(Q){Q=new this(Q);Q.openInWindow().activate();return Q}},{key:"properties",get:function(){return{extent:{defaultValue:yc.pt(400,
500)},fill:{defaultValue:yc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(Q){this.setProperty("remoteTarget",Q);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(Q,!0))}},targetObject:{after:["submorphs"],set:function(Q){this._serializableTarget=Q&&Q.isMorph?Q.id:Q;this.setProperty("targetObject",Q);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(Q))}},
originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var Q=this.ui.propertyTree,wa=Q.selectedNode;Q=Q.treeData;return Q.getContextFor(wa?wa:Q.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),
propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:yc.Color.gray,fontSize:14,fontFamily:yc.config.codeEditor.defaultStyle.fontFamily}},
master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Na,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25406,end:45502})}(yc.Morph);Gd=yc.Inspector;re=sa("I",Gd);yc.default=Gd;var mf=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");
mf.Inspector=re;mf.string=bd;mf.Morph=Ac;mf.pt=wd;mf.Color=db;Gd=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(xa,Na,ub){ub=void 0===ub?1:ub;var Q,wa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){switch(ib.nextAddress){case 1:return xa.maybeSelectCommentOrLine(),ib.setCatchFinallyBlocks(2),Na=Object.assign({},Na,{logDoit:!0,inspect:!0,inspectDepth:ub}),ib.yield(xa.doEval(void 0,Na),4);case 4:Q=ib.yieldResult;wa=Q.error?
Q.error:Q.isError?Q.value:null;ib.leaveTryBlock(3);break;case 2:wa=Xa=ib.enterCatchBlock();case 3:return wa?xa.showError(wa):xa.setStatusMessage(mf.string.truncate(Q.value,1E3)),ib.return(Q)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(xa,Na){var ub,Q,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){switch(Xa.nextAddress){case 1:return Xa.setCatchFinallyBlocks(2),Xa.yield(xa.doEval({start:{row:0,column:0},end:xa.documentEndPosition},
Object.assign({},Na,{logDoit:!0})),4);case 4:ub=Xa.yieldResult;Q=ub.error?ub.error:ub.isError?ub.value:null;Xa.leaveTryBlock(3);break;case 2:Q=wa=Xa.enterCatchBlock();case 3:return Q?xa.showError(Q):xa.setStatusMessage(String(ub.value)),Xa.return(ub)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(xa,Na){var ub,Q,wa,Xa,ib,rc,cc,ad;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Vc){switch(Vc.nextAddress){case 1:return xa.maybeSelectCommentOrLine(),
Vc.setCatchFinallyBlocks(2),Na=Object.assign({},Na,{asString:!1,logDoit:!0}),Vc.yield(xa.doEval(void 0,Na),4);case 4:ub=Vc.yieldResult;Q=ub.error?ub.error:ub.isError?ub.value:null;Vc.leaveTryBlock(3);break;case 2:Q=wa=Vc.enterCatchBlock();case 3:xa.selection.collapseToEnd();if(Xa=ub.value&&ub.value.isColor)return xa.selection.text=String(ub.value),ib=new mf.Morph({fill:mf.Color.transparent,extent:mf.pt(xa.fontSize+2,xa.fontSize+2),submorphs:[{fill:ub.value,center:mf.pt(xa.fontSize+2,xa.fontSize+2).scaleBy(.5)}]}),
rc=xa.selection.start,cc=rc.column,ad=rc.row,xa.insertText([ib,{}],xa.selection.start),xa.selection.start={column:cc,row:ad},Vc.return(ub);xa.insertTextAndSelect(Q?String(Q)+(Q.stack?"\n"+Q.stack:""):String(ub.value));return Vc.return(ub)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(xa,Na){var ub,Q,wa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){switch(ib.nextAddress){case 1:debugger;xa.maybeSelectCommentOrLine();
Q=xa.textInRange(xa.selection);wa=xa.evalEnvironment||{};Xa=xa.pluginFind(function(rc){return rc.isEditorPlugin&&"function"===typeof rc.runEval});wa.systemInterface||(wa.systemInterface=Xa.systemInterface(Na));if("local"!==wa.systemInterface.name){ib.jumpTo(2);break}ib.setCatchFinallyBlocks(3);return ib.yield(xa.doEval(void 0,Na),5);case 5:ub=ib.yieldResult;Q=ub.value;ib.leaveTryBlock(2);break;case 3:ib.enterCatchBlock();case 2:return xa.world().execCommand("open object editor",{target:Q,evalEnvironment:wa}),
ib.return(ub)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(xa,Na){var ub,Q,wa,Xa,ib,rc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cc){switch(cc.nextAddress){case 1:xa.maybeSelectCommentOrLine();wa=xa.textInRange(xa.selection);Xa=xa.evalEnvironment||{};ib=xa.pluginFind(function(ad){return ad.isEditorPlugin&&"function"===typeof ad.runEval});Xa.systemInterface||(Xa.systemInterface=ib.systemInterface(Na));if("local"!==
Xa.systemInterface.name){mf.Inspector.openInWindow({remoteTarget:{code:wa,evalEnvironment:Xa}});cc.jumpTo(2);break}cc.setCatchFinallyBlocks(3);return cc.yield(xa.doEval(void 0,Na),5);case 5:ub=cc.yieldResult;Q=ub.error?ub.error:ub.isError?ub.value:null;wa=ub.value;cc.leaveTryBlock(4);break;case 3:Q=rc=cc.enterCatchBlock();case 4:mf.Inspector.openInWindow({targetObject:Q?Q:wa});case 2:return cc.return(ub)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(xa,Na,ub){ub=void 0===ub?1:ub;var Q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wa){switch(wa.nextAddress){case 1:return xa.maybeSelectCommentOrLine(),wa.setCatchFinallyBlocks(2),Na=Object.assign({},Na,{inspect:!0,inspectDepth:ub,logDoit:!0}),wa.yield(xa.doEval(void 0,Na),4);case 4:Q=wa.yieldResult;wa.leaveTryBlock(3);break;case 2:wa.enterCatchBlock();case 3:return xa.selection.collapseToEnd(),xa.insertTextAndSelect(Q.value),wa.return(Q)}})}}];mf.codeEvaluationCommands=
Gd;mf.codeEvaluationCommands=Gd;mf.codeEvaluationCommands=Gd;var Jf=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Jf.changeAttributeInSelectionOrMorph=function(xa,Na,ub){var Q=xa.selection;xa.keepPosAtSameScrollOffsetWhile(function(){Q.isEmpty()?xa[Na]="function"===typeof ub?ub(xa[Na]):ub:(xa.undoManager.group(),xa.changeStyleProperty(Na,function(wa){return"function"===typeof ub?ub(wa):ub}),xa.undoManager.group())})};re=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(xa){var Na=xa.fontSize;Jf.changeAttributeInSelectionOrMorph(xa,"fontSize",function(ub){ub=ub||Na;return ub+(18<=ub?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(xa){var Na=xa.fontSize;Jf.changeAttributeInSelectionOrMorph(xa,"fontSize",function(ub){ub=ub||Na;return ub-(18>=ub?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(xa){var Na,ub,Q,wa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){if(1==ib.nextAddress){Na=
["serif","sans-serif","monospace"];if(ub=localStorage["lively.morpic/text-change-font-additional-fonts"])ub=JSON.parse(ub),Na.push.apply(Na,$jscomp.arrayFromIterable(ub));Na.map(function(rc){return rc.toLowerCase()}).includes(xa.fontFamily.toLowerCase())||(Na.push(xa.fontFamily),ub=[].concat($jscomp.arrayFromIterable(ub||[]),[xa.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(ub));return ib.yield($world.editListPrompt("choose font",Na,{requester:xa,preselect:Na.indexOf(xa.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}Q=ib.yieldResult;wa=$jscomp.makeIterator(Q.selections);if(Xa=wa.next().value)xa.fontFamily=Xa;return ib.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(xa,Na){Na=void 0===Na?{}:Na;var ub,Q,wa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){if(1==ib.nextAddress){if(Na.hasOwnProperty("link"))return ib.jumpTo(2);Q=xa.selection;wa=xa.getStyleInRange(Q);Xa=wa.link;return ib.yield(xa.world().prompt("Set link",
{input:Xa||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=ib.nextAddress&&(ub=ib.yieldResult,!ub))return ib.return();xa.undoManager.group();xa.setStyleInRange({link:ub||void 0},Q);xa.undoManager.group();ib.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(xa,Na){var ub,Q,wa,Xa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ib){if(1==ib.nextAddress)return ub=xa.selection,Q=xa.getStyleInRange(ub),wa=Q.doit,ib.yield(xa.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:xa,input:wa?wa.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:xa.evalEnvForDoit(wa||{})}),2);Xa=ib.yieldResult;xa.undoManager.group();Xa?xa.addTextAttribute({doit:{code:Xa},nativeCursor:"pointer",textDecoration:"underline"},ub):xa.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},ub);xa.undoManager.group();ib.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(xa,Na){Na=void 0===Na?{}:Na;xa.undoManager.group();
Na=!Na.onlySelection&&xa.selection.isEmpty()?xa.documentRange:xa.selection.range;xa.setStyleInRange(null,Na);xa.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(xa){var Na,ub,Q,wa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xa){if(1==Xa.nextAddress)return Xa.yield(System.import("lively.modules"),2);if(3!=Xa.nextAddress)return Na=Xa.yieldResult,ub=Na.module,Xa.yield(ub("lively.ide/text/ui.js").load(),3);Q=Xa.yieldResult;wa=Q.RichTextControl;return Xa.return(wa.openFor(xa))})}}];
Jf.commands=re;Jf.commands=re;Jf.commands=re;var Be=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");Be.guessTextModeName=zb;Be.rangedToken=function(xa,Na,ub,Q,wa){return{start:{row:xa,column:Na},end:{row:xa,column:ub},token:Q,mode:wa}};Be.fun=fc;Be.arr=Vb;Be.connect=Mc;Be.disconnect=Jb;Be.DefaultTheme=sb;Be.tokenizeDocument=ma;Be.modeInfo=ra;Be.visitDocumentTokens=Ca;Be.getMode=kb;Be.completionCommands=fa;Be.multiSelectCommands=nc;Be.navCommands=Bd;Be.codeCommands=ue;Be.codeEvaluationCommands=
Gd;Be.richTextCommands=re;Be.Color=db;Be.Range=Od;Be.guessTextModeName=zb;Be.guessTextModeName=zb;sb=function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),ub=Na.hasOwnProperty("EditorPlugin")&&"function"===typeof Na.EditorPlugin?Na.EditorPlugin:Na.EditorPlugin=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
Be.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(Q){var wa=this;this.textMorph=Q;Be.connect(Q,"textChange",this,"onTextChange");Be.connect(Q,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return wa.highlight()})}},
{key:"detach",value:function(Q){Be.disconnect(Q,"textChange",this,"onTextChange");Be.disconnect(Q,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(Q){this._ast=null;if(Q){var wa=this._tokenizerValidBefore;if("replace"===Q.selector){var Xa=Q.args[0].start;Q=Xa.row;Xa=Xa.column}else Xa=Q=0;if(!wa||Q<wa.row||Q===wa.row&&Xa<wa.column)Q=Math.max(0,Q),this._tokenizerValidBefore={row:Q,column:Xa}}this.requestHighlight()}},
{key:"requestHighlight",value:function(Q){var wa=this;(void 0===Q?0:Q)?this.highlight():Be.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return wa.highlight()})()}},{key:"highlight",value:function(){var Q=this.textMorph,wa=this.theme,Xa=this.mode,ib=this._tokenizerValidBefore;if(wa&&Q&&Q.document&&Xa){Q.fill=wa.background;Q.cursorColor=wa.cursorColor||Be.Color.black;var rc=Q.viewState,cc={};ib=Be.tokenizeDocument(Xa,Q.document,rc.firstVisibleRow,rc.lastVisibleRow,ib);Xa=ib.lines;ib=
ib.tokens;if(Xa.length){rc=Xa[0].row;for(var ad=[],Vc=0;Vc<ib.length;rc++,Vc++)for(var Yc=ib[Vc],$d=0;$d<Yc.length;$d+=5){var Mf=Yc[$d],Bf=Yc[$d+1],Hg=wa[Yc[$d+2]]||wa.default;Hg&&ad.push({start:{row:rc,column:Mf},end:{row:rc,column:Bf}},Hg)}Q.embeddedMorphs.forEach(function(cf){var Bg=Q.embeddedMorphMap.get(cf).anchor;cc[cf.id]=Q.textAttributeAt(Bg.position)});Q.setTextAttributesWithSortedRanges(ad);Q.embeddedMorphs.forEach(function(cf){var Bg=Q.embeddedMorphMap.get(cf).anchor;Bg=Be.Range.at(Bg.position);
Bg.end.column+=1;Q.replace(Bg,[cf,cc[cf.id]],!1)});this._tokenizerValidBefore={row:Be.arr.last(Xa).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},Q,this)}}},{key:"visitTokensInRange",value:function(Q,wa){var Xa=Q.start,ib=Q.end,rc=Xa.row-1;Be.visitDocumentTokens(this.mode,this.textMorph.document,Xa.row,ib.row,null,function(cc){return rc++},function(cc,ad,Vc,Yc,$d,Mf,Bf){if(rc===Xa.row&&0<Xa.column){if(Xa.column>=Yc)return;Vc<Xa.column&&Xa.column<Yc&&(Vc=Xa.column)}if(rc===ib.row){if(ib.column<=
Vc)return;Vc<ib.column&&ib.column<Yc&&(Yc=ib.column)}wa(cc,ad,rc,Vc,Yc,$d,Mf,Bf)})}},{key:"tokensInRange",value:function(Q){var wa=[];this.visitTokensInRange(Q,function(Xa,ib,rc,cc,ad,Vc,Yc,$d){return wa.push(Be.rangedToken(rc,cc,ad,Xa,$d))});return wa}},{key:"tokensOfRow",value:function(Q){var wa=this.textMorph.getLine(Q).length;return this.tokensInRange({start:{row:Q,column:0},end:{row:Q,column:wa}})}},{key:"tokenAt",value:function(Q){for(var wa=this.tokensOfRow(Q.row),Xa=wa.length;Xa--;){var ib=
wa[Xa];if(ib.token&&ib.start.column<=Q.column&&Q.column<=ib.end.column)return ib}return null}},{key:"getCommands",value:function(Q){return[].concat($jscomp.arrayFromIterable(Q),$jscomp.arrayFromIterable(Be.completionCommands),$jscomp.arrayFromIterable(Be.multiSelectCommands),$jscomp.arrayFromIterable(Be.navCommands),$jscomp.arrayFromIterable(Be.codeCommands),$jscomp.arrayFromIterable(Be.codeEvaluationCommands),$jscomp.arrayFromIterable(Be.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var Q=this.mode,wa=Q.lineComment,Xa=Q.blockCommentStart;Q=Q.blockCommentEnd;var ib={};wa&&(ib.lineCommentStart=wa);Xa&&(ib.blockCommentStart=Xa);Q&&(ib.blockCommentEnd=Q);return ib}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(Q,wa,Xa){var ib=this.textMorph,rc=Q.row,cc=Q.column;Q=wa[cc-1];wa=wa[cc];ib.selection.text="\n";ib.selection.collapseToEnd();"{"===Q&&"}"===wa&&(ib.selection.text="\n"+" ".repeat(Xa),ib.selection.collapse());
ib.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:rc+1,lastRow:rc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var Q=this.textMorph,wa=this.openPairs,Xa=Q.selection,ib=Q.getLine(Xa.end.row),rc=ib[Xa.end.column-1];ib=ib[Xa.end.column];Q.autoInsertPairs&&Xa.isEmpty()&&rc in
wa&&ib===wa[rc]&&(Xa.growRight(1),Xa.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(Q){var wa=this.openPairs,Xa=this.closePairs,ib=this.textMorph,rc=ib.selection,cc=ib.autoInsertPairs&&Q in wa,ad=ib.autoInsertPairs&&Q in Xa;if(!cc&&!ad)return!1;var Vc=ib.getLine(rc.end.row)[rc.end.column];if(!rc.isEmpty()){if(!cc)return!1;Xa=ib.undoManager.ensureNewGroup(ib);ib.insertText(wa[Q],rc.end);ib.insertText(Q,rc.start);ib.undoManager.group(Xa);rc.growRight(-1);return!0}if(Vc in Xa&&Q===Vc)return rc.goRight(1),
!0;if(ad&&!cc)return!1;Xa=ib.undoManager.ensureNewGroup(ib);ib.insertText(Q+wa[Q]);ib.undoManager.group(Xa);rc.goLeft(1);return!0}}],[{key:"className",get:function(){return"EditorPlugin"}}],Na,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);ra=sb=Be.EditorPlugin;
fa=sa("C",function(xa){var Na=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),ub=Na.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Na.CodeMirrorEnabledEditorPlugin?Na.CodeMirrorEnabledEditorPlugin:Na.CodeMirrorEnabledEditorPlugin=function(Q){Q&&Q[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Eb(ub,xa,[{key:Symbol.for("lively-instance-initialize"),value:function(){Eb._get(Object.getPrototypeOf(ub.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(Q){this.mode=this.codeMirrorMode(Q);return Eb._get(Object.getPrototypeOf(ub.prototype),"attach",this).call(this,Q)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(Q){return{indentWithTabs:!Q.useSoftTabs,indentUnit:Q.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(Q){Q=this.defaultCodeMirrorModeConfig(Q);
return Be.getMode(Q,{name:this.longName})}}],[{key:"className",get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Na,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(Be.EditorPlugin));Be.CodeMirrorEnabledEditorPlugin=fa;Be.CodeMirrorEnabledEditorPlugin=fa;Be.CodeMirrorEnabledEditorPlugin=
fa;Be.default=sb;sb=Object.freeze({__proto__:null,guessTextModeName:zb,"default":ra,CodeMirrorEnabledEditorPlugin:fa});sa("e",sb)}}});
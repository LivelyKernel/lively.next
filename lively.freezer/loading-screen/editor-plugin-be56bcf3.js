System.register(["./__root_module__-c4d7431e.js","kld-intersections","./editor-plugin-012baedf.js","./index-ad3a1066.js","./index-1640eed6.js"],function(ta){var nb,Bb,Vb,Qb,Dd,Ic,ud,Nc,Jc,Xc,id,Fd,nd,Yc,Ta,sb,dc,ac,Vc,Hd,hc,kc,xb,yb;return{setters:[function(wc){nb=wc.ar;Bb=wc.bz;Vb=wc.bA;Qb=wc.bB;Dd=wc.E;Ic=wc.ap;ud=wc.aV;Nc=wc.s;Jc=wc.aa;Xc=wc.bm;id=wc.a5;Fd=wc._;nd=wc.bC;Yc=wc.bt},function(){},function(wc){Ta=wc.p;sb=wc.d;dc=wc.a;ac=wc.r;Vc=wc.C},function(wc){Hd=wc.s},function(wc){hc=wc.localInterface;
kc=wc.systemInterfaceNamed;xb=wc.serverInterfaceFor;yb=wc.l2lInterfaceFor}],execute:function(){var wc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");wc.warnStyle={"border-bottom":"2px dotted orange"};wc.errorStyle={"background-color":"red"};var Kc=function(Nb){var rc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),xc=rc.hasOwnProperty("JavaScriptChecker")&&"function"===typeof rc.JavaScriptChecker?rc.JavaScriptChecker:rc.JavaScriptChecker=function(I){I&&I[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return nb(xc,Nb,[{key:"uninstall",value:function(I){var T=I.text||I;(T.markers||[]).forEach(function(ua){return ua.id.startsWith("js-checker-")&&T.removeMarker(ua)});T.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(I,T){return[].concat($jscomp.arrayFromIterable(I.embeddedMorphMap.values())).find(function(ua){return T.containsPosition(ua.anchor.position)})}},{key:"onDocumentChange",value:function(I,
T,ua){var Da=T.document;try{var Lb=ua.parse()}catch(ub){Lb=ub}Lb&&(I=(T.markers||[]).filter(function(ub){return ub.id.startsWith("js-checker-")}),ua=ua.undeclaredVariables().map(function(ub,Ja){var Rb=ub.start;ub=ub.end;Rb=Da.indexToPosition(Rb);ub=Da.indexToPosition(ub);return T.addMarker({id:"js-checker-"+Ja,style:wc.warnStyle,range:{start:Rb,end:ub},type:"js-undeclared-var"})}),I.slice(ua.length).forEach(function(ub){return T.removeMarker(ub)}),Lb.parseError?(I=Lb.parseError.loc,ua=I.column,I=
I.line-1,Lb=Da.indexToPosition(Lb.parseError.pos),ua=Lb.column,I=Lb.row,Lb={start:{column:ua-1,row:I},end:{column:ua+1,row:I}},this.hasEmbeddedMorphInRange(T,Lb)||T.addMarker({id:"js-syntax-error",range:Lb,style:wc.errorStyle,type:"js-syntax-error"})):T.removeMarker("js-syntax-error"))}}],[{key:"className",get:function(){return"JavaScriptChecker"}}],rc,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:118,end:1882})}(void 0),zb=Kc=wc.JavaScriptChecker;wc.default=Kc;var ab=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");ab.query=Bb;ab.fuzzyParse=Vb;ab.acorn=Qb;ab.custom=Dd;var Kb=function(Nb){var rc=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),xc=rc.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof rc.JavaScriptNavigator?rc.JavaScriptNavigator:rc.JavaScriptNavigator=function(I){I&&I[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return nb(xc,Nb,[{key:"ensureAST",value:function(I){return this.parse(I.textString)}},{key:"parse",value:function(I){return ab.fuzzyParse(I)}},{key:"move",value:function(I,T){var ua=!!T.activeMark||!T.selection.isEmpty(),Da=T.selection,Lb=T.positionToIndex(Da.lead);I=this[I](T.textString,Lb);I=T.indexToPosition(I);Da.lead=I;ua||(Da.anchor=I);T.scrollCursorIntoView()}},{key:"forwardSexp",value:function(I){this.move("_forwardSexp",
I)}},{key:"backwardSexp",value:function(I){this.move("_backwardSexp",I)}},{key:"backwardUpSexp",value:function(I){this.move("_backwardUpSexp",I)}},{key:"forwardDownSexp",value:function(I){this.move("_forwardDownSexp",I)}},{key:"_forwardSexp",value:function(I,T){I=this.parse(I);I=ab.custom.findNodesIncluding(I,T).reverse().find(function(Da){return Da.end!==T});if(!I)return T;if("BlockStatement"===I.type){var ua=I.body.find(function(Da){return Da.start>T});if(ua)return ua.start}return I.end}},{key:"_backwardSexp",
value:function(I,T){I=this.parse(I);I=ab.custom.findNodesIncluding(I,T).reverse().find(function(Da){return Da.start!==T});if(!I)return T;if("BlockStatement"===I.type){var ua=I.body.slice().reverse().find(function(Da){return Da.end<T});if(ua)return ua.end}return I?I.start:T}},{key:"_backwardUpSexp",value:function(I,T){I=this.parse(I);return(I=ab.custom.findNodesIncluding(I,T).reverse().find(function(ua){return ua.start!==T}))?I.start:T}},{key:"_forwardDownSexp",value:function(I,T){I=this.parse(I);
return(I=ab.custom.findNodeAfter(I,T,function(ua,Da){return Da.start>T}))?I.node.start:T}},{key:"markDefun",value:function(I){var T=this.rangeForFunctionOrDefinition(I.textString,[I.positionToIndex(I.selection.range.start),I.positionToIndex(I.selection.range.end)]);T&&I.execCommand("expandRegion",{start:T[0],end:T[1]})}},{key:"rangeForNodesMatching",value:function(I,T,ua){I=this.parse(I);return(T=ab.custom.findNodesIncluding(I,T).reverse().find(ua))?[T.start,T.end]:null}},{key:"rangeForFunctionOrDefinition",
value:function(I,T){var ua=T[0]===T[1];return this.rangeForNodesMatching(I,T[1],function(Da){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(Da.type)&&(ua&&Da.end!==T[1]||!ua&&Da.start<T[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(I,T){"number"!==typeof T&&(T=I.positionToIndex(T));I=this.ensureAST(I);var ua=ab.query.nodesAt(T,I).reverse(),Da=ua.find(function(ub){return"Identifier"===ub.type});if(!Da&&((ua=ua[0])&&ua.type.includes("Specifier")&&
ua.local&&"Identifier"===ua.local.type&&(Da=ua.local),!Da))return;T=(ua=ab.query.findDeclarationClosestToIndex(I,Da.name,T))?ab.query.scopeAtIndex(I,ua.start):ab.query.scopeAtIndex(I,T);var Lb=ab.query.findReferencesAndDeclsInScope(T,Da.name).refs;return{parsed:I,scope:T,id:Da,name:Da.name,decl:ua,refs:Lb}}},{key:"expandRegion",value:function(I,T,ua,Da){function Lb(Mc){Mc=I.positionToIndex({column:0,row:Ja.row});return{range:[Mc+Rb.start,Mc+Rb.start+Rb.value.length],prev:Da}}var ub=Da.range[0]!==
Da.range[1],Ja=I.indexToPosition(Da.range[0]),Rb=I.tokenAt(Ja);if(!ub&&Rb&&["keyword","identifier"].includes(Rb.type))return Lb();ua=ua||this.parse(T);T=ab.query.nodesAtIndex(ua,Da.range[0]).reverse().find(function(Mc){return Mc.start<Da.range[0]||Mc.end>Da.range[1]});if(!T)return Da;ua=T.start;ub=T.end;return"Literal"===T.type&&(T.raw||"").match(/^['"`]/)&&Da.range[0]!==T.start&&Da.range[1]!==T.end&&(T.start+1<Da.range[0]||T.end-1>Da.range[1])?{range:[ua+1,ub-1],prev:Da}:{range:[ua,ub],prev:Da}}},
{key:"contractRegion",value:function(I,T,ua,Da){return Da.prev||Da}}],[{key:"className",get:function(){return"JavaScriptNavigator"}}],rc,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:121,end:6658})}(void 0);Kc=Kb=ab.JavaScriptNavigator;ab.default=Kb;var nc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");
nc.addIndexToTextPos=function(Nb,rc,xc){return Nb.indexToPosition(Nb.positionToIndex(rc)+xc)};nc.connect=Ic;nc.disconnect=ud;nc.string=Nc;nc.KeyHandler=Jc;nc.Range=Xc;Kb=function(Nb){var rc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),xc=rc.hasOwnProperty("Snippet")&&"function"===typeof rc.Snippet?rc.Snippet:rc.Snippet=function(I){I&&I[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return nb(xc,Nb,[{key:Symbol.for("lively-instance-initialize"),
value:function(I){I=void 0===I?{trigger:null,expansion:""}:I;var T=I.expansion;this.trigger=I.trigger;this.expansion=T;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(I){this.isExpanding&&(this.textMorph=I,nc.connect(this.textMorph,"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(I){this.isExpanding&&(nc.disconnect(I,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var I=
this.expansionState,T=I.startAnchor,ua=I.endAnchor;I.isExpanding?nc.Range.fromPositions(T.position,ua.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",value:function(){var I=this.textMorph;if(I){var T=this.expansionState||{},ua=T.marker,Da=T.startAnchor,Lb=T.endAnchor;T=T.steps;Da&&I.removeAnchor(Da);Lb&&I.removeAnchor(Lb);ua&&I.removeMarker(ua);T.forEach(function(ub){return I.removeAnchor(ub.anchor)})}this.expansionState=
{stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};I&&I.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(I){var T=[],ua=0;nc.string.reMatches(I,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(Da){var Lb=Da.start,ub=Da.end;Da=Da.match;var Ja="";Da.startsWith("${")?(Ja=$jscomp.makeIterator(Da.match(/^\$\{([0-9]+):([^\}]*)\}/)),Ja.next(),Da=Ja.next().value,Ja=Ja.next().value,Da=Number(Da)):
Da=Number(Da.replace(/^\$/,""));I=I.slice(0,Lb-ua)+Ja+I.slice(ub-ua);T[Da]={index:Lb-ua,prefill:Ja,anchor:null};ua+=ub-Lb-Ja.length});return{steps:T,expansion:I}}},{key:"expandAtCursor",value:function(I){var T=I.selection,ua=I.cursorPosition.column,Da=this.expansion;this.trigger&&(ua-=this.trigger.length);if(ua=Math.max(0,ua))Da=nc.string.lines(Da),Da=[Da[0]].concat($jscomp.arrayFromIterable(Da.slice(1).map(function(Rc){return nc.string.indent(Rc," ",ua)}))),Da=Da.join("\n");var Lb=this.createExpansionSteps(Da);
Da=Lb.expansion;Lb=Lb.steps;this.trigger&&T.growLeft(this.trigger.length);T.text=Da;var ub=T.start;Da=T.end;T.collapseToEnd();if(Lb.length){var Ja=nc.string.newUUID();Lb.forEach(function(Rc,yc){return Rc.anchor=I.addAnchor(Object.assign({id:"snippet-step-"+yc+"-"+Ja},nc.addIndexToTextPos(I,ub,Rc.index)))});var Rb=I.addAnchor(Object.assign({id:"snippet-start-"+Ja},ub,{insertBehavior:"stay"})),Mc=I.addAnchor(Object.assign({id:"snippet-end-"+Ja},Da));this.expansionState={marker:I.addMarker({id:"snippet-marker-"+
Ja,get range(){return{start:Rb.position,end:Mc.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",content:"fooooo"}}),startAnchor:Rb,endAnchor:Mc,stepIndex:0,steps:Lb,isExpanding:!0};I.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var I=this.expansionState,T=I.steps,ua=this.textMorph;if(I.isExpanding&&ua){ua=ua.selection;I=T[I.stepIndex];var Da=I.prefill;ua.lead=ua.anchor=
I.anchor.position;ua.growRight(Da.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=T.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},{key:"canExpand",value:function(I,T){T=I.positionToIndex(I.cursorPosition);return I.textString.slice(T-this.trigger.length,T)===this.trigger}},{key:"tryTrigger",value:function(I,T){if(!this.canExpand(I,I.cursorPosition))return!1;this.expandAtCursor(I);return!0}},{key:"getCommands",value:function(I){var T=
this;return I.concat([{name:"[snippet] next expansion step",exec:function(ua){T.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(ua){T.resetExpansionState();return!0}}])}},{key:"getKeyHandlers",value:function(I){return I.concat(nc.KeyHandler.withBindings([{keys:"Tab",command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:"className",get:function(){return"Snippet"}}],rc,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:356,end:5934})}(void 0);nc.Snippet=Kb;nc.Snippet=Kb;nc.Snippet=Kb;var da=[{name:"get snippets",exec:function(Nb){return Nb.pluginCollect("getSnippets",[])}}];nc.snippetCommands=da;nc.snippetCommands=da;nc.snippetCommands=da;var qa=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");qa.buildEvalOpts=function(Nb,rc){return Nb.plugins.find(function(xc){return xc.isJSEditorPlugin}).sanatizedJsEnv(rc)};
qa.Snippet=Kb;da=function(Nb){var rc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),xc=rc.hasOwnProperty("ModuleTopLevelVarCompleter")&&"function"===typeof rc.ModuleTopLevelVarCompleter?rc.ModuleTopLevelVarCompleter:rc.ModuleTopLevelVarCompleter=function(I){I&&I[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return nb(xc,Nb,[{key:"compute",value:function(I,T){var ua,Da,Lb,ub,Ja,Rb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){if(1==
Mc.nextAddress){Da=(ua=I.pluginFind(function(Rc){return Rc.isJSEditorPlugin}))&&ua.systemInterface();if(!Da)return Mc.return([]);Lb=qa.buildEvalOpts(I);ub=Lb.targetModule;return"local"===Da.name?(Ja=Object.getOwnPropertyNames(Da.getModule(ub).recorder),Mc.jumpTo(2)):Mc.yield(Da.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+
ub+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',{targetModule:"lively://module-recorder-completer"}),3)}if(2!=Mc.nextAddress){Rb=Mc.yieldResult;if(Rb.isError)return Mc.return([]);Ja=JSON.parse(Rb.value)}Ja=Ja.filter(function(Rc){return!Rc.startsWith("defVar_")&&!["System","__currentLivelyModule",
"initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(Rc)});return Mc.return(Ja.map(function(Rc){return{priority:1100,completion:Rc}}))})}}],[{key:"className",get:function(){return"ModuleTopLevelVarCompleter"}}],rc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:222,
end:1678})}(void 0);qa.ModuleTopLevelVarCompleter=da;qa.ModuleTopLevelVarCompleter=da;qa.ModuleTopLevelVarCompleter=da;da=function(Nb){var rc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),xc=rc.hasOwnProperty("DynamicJavaScriptCompleter")&&"function"===typeof rc.DynamicJavaScriptCompleter?rc.DynamicJavaScriptCompleter:rc.DynamicJavaScriptCompleter=function(I){I&&I[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return nb(xc,
Nb,[{key:"isValidPrefix",value:function(I){return/\.[a-z0-9_]*$/i.test(I)}},{key:"isMethodCallCompletion",value:function(I){return I.endsWith(")")&&0<I.indexOf("(")}},{key:"isValidIdentifier",value:function(I){if("string"!==typeof I)return!1;this.isMethodCallCompletion(I)&&(I=I.slice(0,I.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(I)?!0:!1}},{key:"wrapInBrackets",value:function(I){if(!isNaN(Number(I))||I.startsWith("Symbol."))return"["+I+"]";var T="";this.isMethodCallCompletion(I)&&(T=I.slice(I.indexOf("(")),
I=I.slice(0,I.indexOf("(")));return'["'+I.replace(/"/g,'\\"')+'"]'+T}},{key:"compute",value:function(I){var T=this,ua,Da,Lb,ub,Ja,Rb,Mc,Rc,yc,Ga,qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==Za.nextAddress){ua=I.selection;ua.isEmpty()?(Da=I.getLine(ua.lead.row),Da=Da.slice(Da.lastIndexOf(":")+1,ua.lead.column)):Da=ua.text.slice(Math.max(0,ua.text.indexOf(":")),0);if(!T.isValidPrefix(Da))return Za.return([]);ub=(Lb=I.pluginFind(function(Pa){return Pa.isJSEditorPlugin}))&&
Lb.systemInterface();if(!ub)return Za.return([]);Ja=qa.buildEvalOpts(I);return Za.yield(ub.dynamicCompletionsForPrefix(Ja.targetModule,Da,Ja),2)}Rb=Za.yieldResult;Mc=Rb.isError;Rc=Rb.value;yc=Rb.completions;Ga=Rb.prefix;if(Mc)return console.warn("javascript completer encountered error: "+(Rc.stack||Rc)),Za.return([]);yc.reduce(function(Pa,Qa){Qa=$jscomp.makeIterator(Qa);Qa.next();Qa=Qa.next().value;return Pa+Qa.length},0);qc=yc.reduce(function(Pa,Qa,Hb){Qa=$jscomp.makeIterator(Qa);var Gb=Qa.next().value;
Qa=Qa.next().value;return Pa.concat(Qa.map(function(ad){var Td=T.isValidIdentifier(ad);return{info:Gb,completion:ad,prefix:Td?Ga:"."+Ga,customInsertionFn:Td?T.isMethodCallCompletion(ad)?function(Zd,Ue,Fc,Md){Ue=Md.start;Md=Md.end;Zd=Zd.replace(/\((.*)\)/,function(fd){return"("+fd.slice(1,-1).split(", ").map(function(Ib,fa){return"${"+fa+":"+Ib+"}"}).join(", ")+")"});Zd=new qa.Snippet({expansion:Zd});Fc.replace({start:Ue,end:Md},"");Zd.expandAtCursor(Fc)}:null:function(Zd,Ue,Fc,Md){Zd=Md.start;Md=
Md.end;Ue={row:Zd.row,column:Zd.column-1};Md="."===Fc.textInRange({start:Ue,end:Zd})?{start:Ue,end:Md}:{start:Zd,end:Md};Fc.replace(Md,T.wrapInBrackets(ad))}}}))},[]);qc.forEach(function(Pa,Qa){return Object.assign(Pa,{priority:2E3+qc.length-Qa})});return Za.return(qc)})}}],[{key:"className",get:function(){return"DynamicJavaScriptCompleter"}}],rc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1687,end:5122})}(void 0);qa.DynamicJavaScriptCompleter=da;qa.DynamicJavaScriptCompleter=da;qa.DynamicJavaScriptCompleter=da;qa.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
da=function(Nb){var rc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),xc=rc.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof rc.JavaScriptKeywordCompleter?rc.JavaScriptKeywordCompleter:rc.JavaScriptKeywordCompleter=function(I){I&&I[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return nb(xc,Nb,[{key:"compute",value:function(I,T){return qa.keywords.map(function(ua){return{completion:ua,priority:0}})}}],
[{key:"className",get:function(){return"JavaScriptKeywordCompleter"}}],rc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6125,end:6262})}(void 0);qa.JavaScriptKeywordCompleter=da;qa.JavaScriptKeywordCompleter=da;qa.JavaScriptKeywordCompleter=da;da=[new qa.DynamicJavaScriptCompleter,new qa.JavaScriptKeywordCompleter,
new qa.ModuleTopLevelVarCompleter];qa.completers=da;qa.completers=da;qa.completers=da;var Va=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");Va.Snippet=Kb;var cb=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],["importd",'import ${0:name} from "${1:module}";'],
["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],["do","do {${1:/* code */}} while (${0:/* condition */});"],
["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],
["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],["ll","lively.lang."],["lls","lively.lang.string."],
["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],["fun","function ${0:functionName}($1) {$2}"],
["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];Va.snippets=cb;Va.snippets=cb;Va.snippets=cb;var kb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");kb.getEvalEnv=function(Nb){return(Nb=Nb.pluginFind(function(rc){return rc.isJSEditorPlugin}))?Nb.evalEnvironment:null};kb.setEvalEnv=function(Nb,rc){(Nb=Nb.pluginFind(function(xc){return xc.isJSEditorPlugin}))&&Object.assign(Nb.evalEnvironment,rc);return Nb.evalEnvironment};kb.pToI=function(Nb,rc){return Nb.positionToIndex(rc)};
kb.iToP=function(Nb,rc){return Nb.indexToPosition(rc)};kb.arr=id;kb.promise=Fd;kb.string=Nc;kb.show=Hd;kb.Range=Xc;kb.query=Bb;kb.BaseVisitor=nd;Va=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(Nb,rc){rc=void 0===rc?{varName:null,position:null}:rc;var xc,I,T,ua,Da,Lb,ub,Ja,Rb,Mc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rc){switch(Rc.nextAddress){case 1:xc=rc;I=xc.varName;T=
xc.position;if(!I){T||(T=Nb.cursorPosition);ua=Nb.pluginInvokeFirst("getNavigator");Da=ua.ensureAST(Nb);Lb=kb.query.nodesAt(Nb.positionToIndex(T),Da).reverse().find(function(yc){return"Identifier"===yc.type});if(!Lb)return Nb.showError(Error("no identifier found!")),Rc.return(!0);I=Lb.name}rc=Nb.pluginFind(function(yc){return yc.isJSEditorPlugin}).sanatizedJsEnv();ub='lively.modules.module("'+rc.targetModule+'").undefine("'+I+'")';Rc.setCatchFinallyBlocks(2);return Rc.yield(Nb.doEval(null,rc,ub),
4);case 4:Ja=Rc.yieldResult;Rb=Ja.error?Ja.error:Ja.isError?Ja.value:null;Rc.leaveTryBlock(3);break;case 2:Rb=Mc=Rc.enterCatchBlock();case 3:return Rb?Nb.showError(Rb):Nb.setStatusMessage(I+" undefined"),Rc.return(!0)}})}},{name:"change doitContext",exec:function(Nb){var rc,xc,I,T,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){if(1==Da.nextAddress)return rc=$jscomp,xc=rc.makeIterator,Da.yield(Nb.world().execCommand("select morph",{prompt:"select morph for doitContext",justReturn:!0,
prependItems:["reset"],filterFn:function(Lb){return!Lb.isUsedAsEpiMorph()}}),2);I=xc.call(rc,Da.yieldResult);if(T=I.next().value)ua="reset"===T,Nb.doitContext=ua?null:T,Nb.setStatusMessage(ua?"doitContext is now\n"+T:"doitContext reset");return Da.return(!0)})}},{name:"change eval backend",exec:function(Nb,rc){rc=void 0===rc?{backend:void 0}:rc;var xc,I;return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){if(1==T.nextAddress)return xc=rc,I=xc.backend,void 0!==I?T.jumpTo(2):T.yield(Nb.world().prompt("choose eval backend",
{historyId:"js-eval-backend-history"}),3);if(2!=T.nextAddress&&(I=T.yieldResult,!I))return Nb.setStatusMessage("Canceled"),T.return(!0);"local"===I&&(I=null);Nb.setStatusMessage("Eval backend is now "+(I||"local"));return T.return(kb.setEvalEnv(Nb,{remote:I}))})}},{name:"copy current module name to clipboard",exec:function(Nb){var rc=Nb.evalEnvironment.targetModule;Nb.setStatusMessage(rc?rc:"Cannot find module name");Nb.env.eventDispatcher.killRing.add(Nb);Nb.env.eventDispatcher.doCopy(rc);return!0}}];
kb.jsEditorCommands=Va;kb.jsEditorCommands=Va;kb.jsEditorCommands=Va;var Ma=[{name:"[javascript] list errors and warnings",exec:function(Nb){var rc,xc,I,T,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){if(1==Da.nextAddress){rc=(Nb.markers||[]).filter(function(Lb){Lb=Lb.type;return"js-undeclared-var"===Lb||"js-syntax-error"===Lb});if(!rc.length)return kb.show("no warnings or errors"),Da.return(!0);xc=rc.map(function(Lb){var ub=Lb.range;return{isListItem:!0,string:"["+Lb.type.split("-").slice(1).join(" ")+
"] "+Nb.textInRange(ub),value:ub}});return Da.yield(Nb.world().filterableListPrompt("jump to warning or error",xc),2)}I=Da.yieldResult;T=$jscomp.makeIterator(I.selected);if(ua=T.next().value)Nb.saveMark(),Nb.selection=ua,Nb.centerRow(ua.start.row);return Da.return(!0)})}},{name:"[javascript] inject import",exec:function(Nb,rc){rc=void 0===rc?{gotoImport:!1,insertImportAtCursor:!0}:rc;var xc,I,T;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){switch(ua.nextAddress){case 1:return ua.yield(kb.promise.delay(0),
2);case 2:return ua.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return xc=ua.yieldResult,I=xc.interactivelyInjectImportIntoText,ua.yield(I(Nb,rc),4);case 4:return(T=ua.yieldResult)||Nb.setStatusMessage("canceled"),ua.return(T)}})}},{name:"[javascript] fix undeclared variables",exec:function(Nb,rc){rc=void 0===rc?{ignore:[],autoApplyIfSingleChoice:!1,requester:Nb}:rc;var xc,I,T;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){if(1==ua.nextAddress)return ua.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=ua.nextAddress)return xc=ua.yieldResult,I=xc.interactivlyFixUndeclaredVariables,ua.yield(I(Nb,rc),3);T=ua.yieldResult;Nb.focus();return ua.return(T)})}},{name:"[javascript] remove unused imports",exec:function(Nb,rc){rc=void 0===rc?{query:!0}:rc;var xc,I,T;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){if(1==ua.nextAddress)return ua.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=ua.nextAddress)return xc=ua.yieldResult,I=xc.cleanupUnusedImports,ua.yield(I(Nb,
rc),3);T=ua.yieldResult;Nb.setStatusMessage(T);return ua.return(!0)})}},{name:"[javascript] eslint report",exec:function(Nb){var rc,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(I){if(1==I.nextAddress)return I.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);rc=I.yieldResult;xc=rc.default;try{return I.return(xc.reportOnMorph(Nb))}catch(T){Nb.showError(T)}I.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(Nb){var rc,xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(I){if(1==
I.nextAddress)return I.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);rc=I.yieldResult;xc=rc.default;try{return I.return(xc.previewFixesOnMorph(Nb))}catch(T){Nb.showError(T)}I.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(Nb,rc,xc){function I(Za,Pa){Pa||(Pa=Ja(Za,{allowReturnOutsideFunction:!0}));var Qa=kb.string.lineRanges(Za),Hb=Za.split("\n"),Gb=[],ad=new kb.BaseVisitor,Td=ad.visitVariableDeclaration;ad.visitVariableDeclaration=function(Md,
fd,Ib){if(1<Md.declarations.length)for(var fa=kb.string.findLineWithIndexInLineRanges(Qa,Md.start),ma=Md.declarations[0].start-Qa[fa][0],tb={},H=1;H<Md.declarations.length;tb={$jscomp$loop$prop$actionType$2280:tb.$jscomp$loop$prop$actionType$2280,$jscomp$loop$prop$arg$2281:tb.$jscomp$loop$prop$arg$2281},H++){var ka=Md.declarations[H],Ca=kb.string.findLineWithIndexInLineRanges(Qa,ka.start);if(fa!==Ca){var rb=Hb[Ca].match(/\s*/)[0].length;rb=ma-rb;0!==rb&&(ka=kb.string.findLineWithIndexInLineRanges(Qa,
ka.end),tb.$jscomp$loop$prop$actionType$2280=0<rb?"insert":"delete",tb.$jscomp$loop$prop$arg$2281=0<rb?" ".repeat(rb):-rb,Gb.push.apply(Gb,$jscomp.arrayFromIterable(kb.arr.range(Ca,ka).map(function(sc){return function(Ac){return[sc.$jscomp$loop$prop$actionType$2280,Qa[Ac][0],sc.$jscomp$loop$prop$arg$2281]}}(tb)))))}}return Td.call(ad,Md,fd,Ib)};ad.accept(Pa,{},[]);for(Pa=Gb.length;Pa--;){var Zd=$jscomp.makeIterator(Gb[Pa]),Ue=Zd.next().value,Fc=Zd.next().value;Zd=Zd.next().value;"insert"===Ue?Za=
Za.slice(0,Fc)+Zd+Za.slice(Fc):"delete"===Ue&&(Za=Za.slice(0,Fc)+Za.slice(Fc+Zd))}return Za}var T,ua,Da,Lb,ub,Ja,Rb,Mc,Rc,yc,Ga,qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){switch(Za.nextAddress){case 1:return T=xc?xc:Math.floor(Nb.width/Nb.defaultCharExtent().width),rc=Object.assign({printWidth:T,tabWidth:2,useTabs:!1,bracketSpacing:!1},rc),ua=lively.modules.module,Da=System.normalizeSync("prettier/standalone.js"),Za.yield(ua(Da).load({format:"global",instrument:!1}),2);case 2:return Lb=
Za.yieldResult,Za.yield(ua("lively.ast/lib/acorn-extension.js").load(),3);case 3:return Za.yield(ua("lively.ast").load(),4);case 4:return ub=Za.yieldResult,Ja=ub.parse,Za.yield(ua("lively.ast/lib/query.js").load(),5);case 5:return Za.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return Rb=Za.yieldResult,Mc=Nb.selection.isEmpty()?Nb.documentRange:Nb.selection.range,Rc=Nb.positionToIndex(Mc.start),yc=Nb.positionToIndex(Mc.end),Ga=Lb.format(Nb.textString,Object.assign({},
rc,{rangeStart:Rc,rangeEnd:yc,parser:function(Pa,Qa,Hb){return Ja(Pa,{allowReturnOutsideFunction:!0})}})),Nb.undoManager.group(),qc=Rb.diffChars(Nb.textString,Ga),Nb.applyJsDiffPatch(qc),Nb.selection.text=I(Nb.selection.text),Nb.undoManager.group(),Za.return(!0)}})}}];kb.jsIdeCommands=Ma;kb.jsIdeCommands=Ma;kb.jsIdeCommands=Ma;var Oa=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(Nb,rc){rc=Nb.pluginInvokeFirst("getNavigator");if(!rc)return!0;rc=rc.resolveIdentifierAt(Nb,Nb.cursorPosition);
if(!rc||!rc.id)return kb.show("No symbol identifier selected"),!0;if(!rc.decl)return kb.show("Cannot find declaration of "+rc.name),!0;Nb.saveMark();Nb.selection={start:Nb.indexToPosition(rc.decl.start),end:Nb.indexToPosition(rc.decl.end)};Nb.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(Nb){Nb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(Nb){Nb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(Nb,rc){rc=void 0===rc?{direction:null}:rc;var xc=Nb.pluginInvokeFirst("getNavigator");if(!xc)return!0;xc=xc.resolveIdentifierAt(Nb,
Nb.cursorPosition);if(!xc||!xc.refs)return kb.show("No symbol identifier selected"),!0;var I=Nb.selection;xc=xc.refs.map(function(ua){var Da=ua.end;return kb.Range.fromPositions(kb.iToP(Nb,ua.start),kb.iToP(Nb,Da))}).concat(xc.decl?kb.Range.fromPositions(kb.iToP(Nb,xc.decl.start),kb.iToP(Nb,xc.decl.end)):[]).sort(kb.Range.compare);if(!xc.length)return!0;var T=xc.map(String).indexOf(String(I.range));if("next"===rc.direction||"prev"===rc.direction)-1===T&&xc.length?xc=[xc[0]]:(rc=T+("next"===rc.direction?
1:-1),0>rc?rc=xc.length-1:rc>=xc.length&&(rc=0),xc=[xc[rc]]);xc.forEach(function(ua){var Da=I.selections.findIndex(function(ub){return ub.range.equals(ua)}),Lb=I.selections.length-1;-1<Da?kb.arr.swap(I.selections,Da,Lb):I.addRange(ua,!1)});I.mergeSelections();return!0}}];kb.astEditorCommands=Oa;kb.astEditorCommands=Oa;kb.astEditorCommands=Oa;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var lb=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
lb.expressionAllowed=function(Nb,rc,xc){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(rc.lastType)||"quasi"==rc.lastType&&/\{\s*$/.test(Nb.string.slice(0,Nb.pos-(xc||0)))};lb.passIndent=Ta;lb.defineMode=sb;lb.defineMIME=dc;lb.registerHelper=ac;lb.defaultConfig={indentUnit:2};lb.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};lb.defineMode("javascript",
function(Nb,rc){function xc(Eb,Fb,Vd){dk=Eb;Ki=Vd;return Fb}function I(Eb,Fb){var Vd=Eb.next();if('"'==Vd||"'"==Vd)return Fb.tokenize=T(Vd),Fb.tokenize(Eb,Fb);if("."==Vd&&Eb.match(/^\d+(?:[eE][+\-]?\d+)?/))return xc("number","number");if("."==Vd&&Eb.match(".."))return xc("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(Vd))return xc(Vd);if("="==Vd&&Eb.eat(">"))return xc("=>","operator");if("0"==Vd&&Eb.eat(/x/i))return Eb.eatWhile(/[\da-f]/i),xc("number","number");if("0"==Vd&&Eb.eat(/o/i))return Eb.eatWhile(/[0-7]/i),
xc("number","number");if("0"==Vd&&Eb.eat(/b/i))return Eb.eatWhile(/[01]/i),xc("number","number");if(/\d/.test(Vd))return Eb.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),xc("number","number");if("/"==Vd){if(Eb.eat("*"))return Fb.tokenize=ua,ua(Eb,Fb);if(Eb.eat("/"))return Eb.skipToEnd(),xc("comment","comment");if(lb.expressionAllowed(Eb,Fb,1)){a:for(var Sd=Fb=!1;null!=(Vd=Eb.next());){if(!Fb){if("/"==Vd&&!Sd)break a;"["==Vd?Sd=!0:Sd&&"]"==Vd&&(Sd=!1)}Fb=!Fb&&"\\"==Vd}Eb.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return xc("regexp","string-2")}Eb.eatWhile(Ni);return xc("operator","operator",Eb.current())}if("`"==Vd)return Fb.tokenize=Da,Da(Eb,Fb);if("#"==Vd)return Eb.skipToEnd(),xc("error","error");if(Ni.test(Vd))return">"==Vd&&Fb.lexical&&">"==Fb.lexical.type||Eb.eatWhile(Ni),xc("operator","operator",Eb.current());if(xk.test(Vd))return Eb.eatWhile(xk),Eb=Eb.current(),(Vd=bg.propertyIsEnumerable(Eb)&&bg[Eb])&&"."!=Fb.lastType?xc(Vd.type,Vd.style,Eb):xc("variable","variable",Eb)}function T(Eb){return function(Fb,
Vd){var Sd=!1,Gc;if(dh&&"@"==Fb.peek()&&Fb.match(bk))return Vd.tokenize=I,xc("jsonld-keyword","meta");for(;null!=(Gc=Fb.next())&&(Gc!=Eb||Sd);)Sd=!Sd&&"\\"==Gc;Sd||(Vd.tokenize=I);return xc("string","string")}}function ua(Eb,Fb){for(var Vd=!1,Sd;Sd=Eb.next();){if("/"==Sd&&Vd){Fb.tokenize=I;break}Vd="*"==Sd}return xc("comment","comment")}function Da(Eb,Fb){for(var Vd=!1,Sd;null!=(Sd=Eb.next());){if(!Vd&&("`"==Sd||"$"==Sd&&Eb.eat("{"))){Fb.tokenize=I;break}Vd=!Vd&&"\\"==Sd}return xc("quasi","string-2",
Eb.current())}function Lb(Eb,Fb){Fb.fatArrowAt&&(Fb.fatArrowAt=null);var Vd=Eb.string.indexOf("=>",Eb.start);if(!(0>Vd)){if(ij){var Sd=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Eb.string.slice(Eb.start,Vd));Sd&&(Vd=Sd.index)}Sd=0;var Gc=!1;for(--Vd;0<=Vd;--Vd){var ig=Eb.string.charAt(Vd),Ji="([{}])".indexOf(ig);if(0<=Ji&&3>Ji){if(!Sd){++Vd;break}if(0==--Sd){"("==ig&&(Gc=!0);break}}else if(3<=Ji&&6>Ji)++Sd;else if(xk.test(ig))Gc=!0;else{if(/["'\/]/.test(ig))return;if(Gc&&!Sd){++Vd;break}}}Gc&&
!Sd&&(Fb.fatArrowAt=Vd)}}function ub(Eb,Fb,Vd,Sd,Gc,ig){this.indented=Eb;this.column=Fb;this.type=Vd;this.prev=Gc;this.info=ig;null!=Sd&&(this.align=Sd)}function Ja(){for(var Eb=arguments.length-1;0<=Eb;Eb--)df.cc.push(arguments[Eb])}function Rb(){Ja.apply(null,arguments);return!0}function Mc(Eb){function Fb(Sd){for(;Sd;Sd=Sd.next)if(Sd.name==Eb)return!0;return!1}var Vd=df.state;df.marked="def";Vd.context?Fb(Vd.localVars)||(Vd.localVars={name:Eb,next:Vd.localVars}):!Fb(Vd.globalVars)&&rc.globalVars&&
(Vd.globalVars={name:Eb,next:Vd.globalVars})}function Rc(){df.state.context={prev:df.state.context,vars:df.state.localVars};df.state.localVars=kl}function yc(){df.state.localVars=df.state.context.vars;df.state.context=df.state.context.prev}function Ga(Eb,Fb){var Vd=function(){var Sd=df.state,Gc=Sd.indented;if("stat"==Sd.lexical.type)Gc=Sd.lexical.indented;else for(var ig=Sd.lexical;ig&&")"==ig.type&&ig.align;ig=ig.prev)Gc=ig.indented;Sd.lexical=new ub(Gc,df.stream.column(),Eb,null,Sd.lexical,Fb)};
Vd.lex=!0;return Vd}function qc(){var Eb=df.state;Eb.lexical.prev&&(")"==Eb.lexical.type&&(Eb.indented=Eb.lexical.indented),Eb.lexical=Eb.lexical.prev)}function Za(Eb){function Fb(Vd){return Vd==Eb?Rb():";"==Eb?Ja():Rb(Fb)}return Fb}function Pa(Eb,Fb){return"var"==Eb?Rb(Ga("vardef",Fb.length),zc,Za(";"),qc):"keyword a"==Eb?Rb(Ga("form"),Gb,Pa,qc):"keyword b"==Eb?Rb(Ga("form"),Pa,qc):"{"==Eb?Rb(Ga("}"),ue,qc):";"==Eb?Rb():"if"==Eb?("else"==df.state.lexical.info&&df.state.cc[df.state.cc.length-1]==
qc&&df.state.cc.pop()(),Rb(Ga("form"),Gb,Pa,qc,wa)):"function"==Eb?Rb(gb):"for"==Eb?Rb(Ga("form"),La,Pa,qc):"variable"==Eb?ij&&"type"==Fb?(df.marked="keyword",Rb(Nd,Za("operator"),Nd,Za(";"))):Rb(Ga("stat"),ka):"switch"==Eb?Rb(Ga("form"),Gb,Za("{"),Ga("}","switch"),ue,qc,qc):"case"==Eb?Rb(Qa,Za(":")):"default"==Eb?Rb(Za(":")):"catch"==Eb?Rb(Ga("form"),Rc,Za("("),oc,Za(")"),Pa,qc,yc):"class"==Eb?Rb(Ga("form"),$c,qc):"export"==Eb?Rb(Ga("stat"),oe,qc):"import"==Eb?Rb(Ga("stat"),Dg,qc):"module"==Eb?Rb(Ga("form"),
Ze,Za("{"),Ga("}"),ue,qc,qc):"async"==Eb?Rb(Pa):"@"==Fb?Rb(Qa,Pa):Ja(Ga("stat"),Qa,Za(";"),qc)}function Qa(Eb){return ad(Eb,!1)}function Hb(Eb){return ad(Eb,!0)}function Gb(Eb){return"("!=Eb?Ja():Rb(Ga(")"),Qa,Za(")"),qc)}function ad(Eb,Fb){if(df.state.fatArrowAt==df.stream.start){var Vd=Fb?fa:Ib;if("("==Eb)return Rb(Rc,Ga(")"),Bd(Ze,")"),qc,Za("=>"),Vd,yc);if("variable"==Eb)return Ja(Rc,Ze,Za("=>"),Vd,yc)}Vd=Fb?Fc:Ue;return wf.hasOwnProperty(Eb)?Rb(Vd):"function"==Eb?Rb(gb,Vd):"class"==Eb?Rb(Ga("form"),
cc,qc):"keyword c"==Eb||"async"==Eb?Rb(Fb?Zd:Td):"("==Eb?Rb(Ga(")"),Td,Za(")"),qc,Vd):"operator"==Eb||"spread"==Eb?Rb(Fb?Hb:Qa):"["==Eb?Rb(Ga("]"),Cj,qc,Vd):"{"==Eb?kd(rb,"}",null,Vd):"quasi"==Eb?Ja(Md,Vd):"new"==Eb?Rb(ma(Fb)):Rb()}function Td(Eb){return Eb.match(/[;\}\)\],]/)?Ja():Ja(Qa)}function Zd(Eb){return Eb.match(/[;\}\)\],]/)?Ja():Ja(Hb)}function Ue(Eb,Fb){return","==Eb?Rb(Qa):Fc(Eb,Fb,!1)}function Fc(Eb,Fb,Vd){var Sd=0==Vd?Ue:Fc,Gc=0==Vd?Qa:Hb;if("=>"==Eb)return Rb(Rc,Vd?fa:Ib,yc);if("operator"==
Eb)return/\+\+|--/.test(Fb)?Rb(Sd):"?"==Fb?Rb(Qa,Za(":"),Gc):Rb(Gc);if("quasi"==Eb)return Ja(Md,Sd);if(";"!=Eb){if("("==Eb)return kd(Hb,")","call",Sd);if("."==Eb)return Rb(Ca,Sd);if("["==Eb)return Rb(Ga("]"),Td,Za("]"),qc,Sd)}}function Md(Eb,Fb){return"quasi"!=Eb?Ja():"${"!=Fb.slice(Fb.length-2)?Rb(Md):Rb(Qa,fd)}function fd(Eb){if("}"==Eb)return df.marked="string-2",df.state.tokenize=Da,Rb(Md)}function Ib(Eb){Lb(df.stream,df.state);return Ja("{"==Eb?Pa:Qa)}function fa(Eb){Lb(df.stream,df.state);return Ja("{"==
Eb?Pa:Hb)}function ma(Eb){return function(Fb){return"."==Fb?Rb(Eb?H:tb):Ja(Eb?Hb:Qa)}}function tb(Eb,Fb){if("target"==Fb)return df.marked="keyword",Rb(Ue)}function H(Eb,Fb){if("target"==Fb)return df.marked="keyword",Rb(Fc)}function ka(Eb){return":"==Eb?Rb(qc,Pa):Ja(Ue,Za(";"),qc)}function Ca(Eb){if("variable"==Eb)return df.marked="property",Rb()}function rb(Eb,Fb){if("async"==Eb)return df.marked="property",Rb(rb);if("variable"==Eb||"keyword"==df.style)return df.marked="property","get"==Fb||"set"==
Fb?Rb(sc):Rb(Ac);if("number"==Eb||"string"==Eb)return df.marked=dh?"property":df.style+" property",Rb(Ac);if("jsonld-keyword"==Eb)return Rb(Ac);if("modifier"==Eb)return Rb(rb);if("["==Eb)return Rb(Qa,Za("]"),Ac);if("spread"==Eb)return Rb(Qa);if(":"==Eb)return Ja(Ac)}function sc(Eb){if("variable"!=Eb)return Ja(Ac);df.marked="property";return Rb(gb)}function Ac(Eb){if(":"==Eb)return Rb(Hb);if("("==Eb)return Ja(gb)}function Bd(Eb,Fb,Vd){function Sd(Gc,ig){return(Vd?-1<Vd.indexOf(Gc):","==Gc)?(Gc=df.state.lexical,
"call"==Gc.info&&(Gc.pos=(Gc.pos||0)+1),Rb(function(Ji,Mk){return Ji==Fb||Mk==Fb?Ja():Ja(Eb)},Sd)):Gc==Fb||ig==Fb?Rb():Rb(Za(Fb))}return function(Gc,ig){return Gc==Fb||ig==Fb?Rb():Ja(Eb,Sd)}}function kd(Eb,Fb,Vd){for(var Sd=3;Sd<arguments.length;Sd++)df.cc.push(arguments[Sd]);return Rb(Ga(Fb,Vd),Bd(Eb,Fb),qc)}function ue(Eb){return"}"==Eb?Rb():Ja(Pa,ue)}function td(Eb,Fb){if(ij){if(":"==Eb)return Rb(Nd);if("?"==Fb)return Rb(td)}}function Nd(Eb){if("variable"==Eb)return df.marked="variable-3",Rb(Ye);
if("string"==Eb||"number"==Eb||"atom"==Eb)return Rb(Ye);if("{"==Eb)return Rb(Ga("}"),Bd(Ke,"}",",;"),qc);if("("==Eb)return Rb(Bd(vf,")"),Ve)}function Ve(Eb){if("=>"==Eb)return Rb(Nd)}function Ke(Eb,Fb){if("variable"==Eb||"keyword"==df.style)return df.marked="property",Rb(Ke);if("?"==Fb)return Rb(Ke);if(":"==Eb)return Rb(Nd)}function vf(Eb){if("variable"==Eb)return Rb(vf);if(":"==Eb)return Rb(Nd)}function Ye(Eb,Fb){if("<"==Fb)return Rb(Ga(">"),Bd(Nd,">"),qc,Ye);if("|"==Fb||"."==Eb)return Rb(Nd);if("["==
Eb)return Rb(Za("]"),Ye);if("extends"==Fb)return Rb(Nd)}function zc(){return Ja(Ze,td,Kf,Ce)}function Ze(Eb,Fb){if("modifier"==Eb)return Rb(Ze);if("variable"==Eb)return Mc(Fb),Rb();if("spread"==Eb)return Rb(Ze);if("["==Eb)return kd(Ze,"]");if("{"==Eb)return kd(If,"}")}function If(Eb,Fb){if("variable"==Eb&&!df.stream.match(/^\s*:/,!1))return Mc(Fb),Rb(Kf);"variable"==Eb&&(df.marked="property");return"spread"==Eb?Rb(Ze):"}"==Eb?Ja():Rb(Za(":"),Ze,Kf)}function Kf(Eb,Fb){if("="==Fb)return Rb(Hb)}function Ce(Eb){if(","==
Eb)return Rb(zc)}function wa(Eb,Fb){if("keyword b"==Eb&&"else"==Fb)return Rb(Ga("form","else"),Pa,qc)}function La(Eb){if("("==Eb)return Rb(Ga(")"),pb,Za(")"),qc)}function pb(Eb){return"var"==Eb?Rb(zc,Za(";"),xa):";"==Eb?Rb(xa):"variable"==Eb?Rb(S):Ja(Qa,Za(";"),xa)}function S(Eb,Fb){return"in"==Fb||"of"==Fb?(df.marked="keyword",Rb(Qa)):Rb(Ue,xa)}function xa(Eb,Fb){return";"==Eb?Rb(Xa):"in"==Fb||"of"==Fb?(df.marked="keyword",Rb(Qa)):Ja(Qa,Za(";"),Xa)}function Xa(Eb){")"!=Eb&&Rb(Qa)}function gb(Eb,
Fb){if("*"==Fb)return df.marked="keyword",Rb(gb);if("variable"==Eb)return Mc(Fb),Rb(gb);if("("==Eb)return Rb(Rc,Ga(")"),Bd(oc,")"),qc,td,Pa,yc);if(ij&&"<"==Fb)return Rb(Ga(">"),Bd(Nd,">"),qc,gb)}function oc(Eb){return"spread"==Eb?Rb(oc):Ja(Ze,td,Kf)}function cc(Eb,Fb){return"variable"==Eb?$c(Eb,Fb):Uc(Eb,Fb)}function $c(Eb,Fb){if("variable"==Eb)return Mc(Fb),Rb(Uc)}function Uc(Eb,Fb){if("<"==Fb)return Rb(Ga(">"),Bd(Nd,">"),qc,Uc);if("extends"==Fb||"implements"==Fb||ij&&","==Eb)return Rb(ij?Nd:Qa,
Uc);if("{"==Eb)return Rb(Ga("}"),Wc,qc)}function Wc(Eb,Fb){if("variable"==Eb||"keyword"==df.style){if(("async"==Fb||"static"==Fb||"get"==Fb||"set"==Fb||ij&&("public"==Fb||"private"==Fb||"protected"==Fb||"readonly"==Fb||"abstract"==Fb))&&df.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return df.marked="keyword",Rb(Wc);df.marked="property";return Rb(ij?Yd:gb,Wc)}if("["==Eb)return Rb(Qa,Za("]"),ij?Yd:gb,Wc);if("*"==Fb)return df.marked="keyword",Rb(Wc);if(";"==Eb)return Rb(Wc);if("}"==Eb)return Rb();if("@"==
Fb)return Rb(Qa,Wc)}function Yd(Eb,Fb){return"?"==Fb?Rb(Yd):":"==Eb?Rb(Nd,Kf):"="==Fb?Rb(Hb):Ja(gb)}function oe(Eb,Fb){return"*"==Fb?(df.marked="keyword",Rb(Eg,Za(";"))):"default"==Fb?(df.marked="keyword",Rb(Qa,Za(";"))):"{"==Eb?Rb(Bd(tf,"}"),Eg,Za(";")):Ja(Pa)}function tf(Eb,Fb){if("as"==Fb)return df.marked="keyword",Rb(Za("variable"));if("variable"==Eb)return Ja(Hb,tf)}function Dg(Eb){return"string"==Eb?Rb():Ja(Ah,Mg,Eg)}function Ah(Eb,Fb){if("{"==Eb)return kd(Ah,"}");"variable"==Eb&&Mc(Fb);"*"==
Fb&&(df.marked="keyword");return Rb(ri)}function Mg(Eb){if(","==Eb)return Rb(Ah,Mg)}function ri(Eb,Fb){if("as"==Fb)return df.marked="keyword",Rb(Ah)}function Eg(Eb,Fb){if("from"==Fb)return df.marked="keyword",Rb(Qa)}function Cj(Eb){return"]"==Eb?Rb():Ja(Bd(Hb,"]"))}Nb=Object.assign({},lb.defaultConfig,{},Nb);rc=Object.assign({},lb.defaultParserConfig,{},rc);var Te=Nb.indentUnit,xi=rc.statementIndent,dh=rc.jsonld,$d=rc.json||dh,ij=rc.typescript,xk=rc.wordCharacters||/[\w$\xa1-\uffff]/,bg=function(){function Eb(Mk){return{type:Mk,
style:"keyword"}}var Fb=Eb("keyword a"),Vd=Eb("keyword b"),Sd=Eb("keyword c"),Gc=Eb("operator"),ig={type:"atom",style:"atom"};Fb={"if":Eb("if"),"while":Fb,"with":Fb,"else":Vd,"do":Vd,"try":Vd,"finally":Vd,"return":Sd,"break":Sd,"continue":Sd,"new":Eb("new"),"delete":Sd,"throw":Sd,"debugger":Sd,"var":Eb("var"),"const":Eb("var"),let:Eb("var"),"function":Eb("function"),"catch":Eb("catch"),"for":Eb("for"),"switch":Eb("switch"),"case":Eb("case"),"default":Eb("default"),"in":Gc,"typeof":Gc,"instanceof":Gc,
"true":ig,"false":ig,"null":ig,undefined:ig,NaN:ig,Infinity:ig,"this":Eb("this"),"class":Eb("class"),"super":Eb("atom"),yield:Sd,"export":Eb("export"),"import":Eb("import"),"extends":Sd,await:Sd,async:Eb("async")};if(ij){Vd={type:"variable",style:"variable-3"};Sd={"interface":Eb("class"),"implements":Sd,namespace:Sd,module:Eb("module"),"enum":Eb("module"),"public":Eb("modifier"),"private":Eb("modifier"),"protected":Eb("modifier"),"abstract":Eb("modifier"),as:Gc,string:Vd,number:Vd,"boolean":Vd,any:Vd};
for(var Ji in Sd)Fb[Ji]=Sd[Ji]}return Fb}(),Ni=/[+\-*&%=<>!?|~^@]/,bk=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,dk,Ki,wf={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0,"jsonld-keyword":!0},df={state:null,column:null,marked:null,cc:null},kl={name:"this",next:{name:"arguments"}};qc.lex=!0;return{startState:function(Eb){Eb={tokenize:I,lastType:"sof",cc:[],lexical:new ub((Eb||0)-Te,0,"block",!1),localVars:rc.localVars,context:rc.localVars&&{vars:rc.localVars},
indented:Eb||0};rc.globalVars&&"object"==typeof rc.globalVars&&(Eb.globalVars=rc.globalVars);return Eb},token:function(Eb,Fb){Eb.sol()&&(Fb.lexical.hasOwnProperty("align")||(Fb.lexical.align=!1),Fb.indented=Eb.indentation(),Lb(Eb,Fb));if(Fb.tokenize!=ua&&Eb.eatSpace())return null;var Vd=Fb.tokenize(Eb,Fb);if("comment"==dk)return Vd;Fb.lastType="operator"!=dk||"++"!=Ki&&"--"!=Ki?dk:"incdec";a:{var Sd=dk,Gc=Ki,ig=Fb.cc;df.state=Fb;df.stream=Eb;df.marked=null;df.cc=ig;df.style=Vd;Fb.lexical.hasOwnProperty("align")||
(Fb.lexical.align=!0);for(Eb=0;;){if(1E5<Eb++)throw Error("endless");if((ig.length?ig.pop():$d?Qa:Pa)(Sd,Gc)){for(;ig.length&&ig[ig.length-1].lex;)ig.pop()();if(df.marked){Vd=df.marked;break a}if(Sd="variable"==Sd)b:{for(Sd=Fb.localVars;Sd;Sd=Sd.next)if(Sd.name==Gc){Sd=!0;break b}for(Fb=Fb.context;Fb;Fb=Fb.prev)for(Sd=Fb.vars;Sd;Sd=Sd.next)if(Sd.name==Gc){Sd=!0;break b}Sd=void 0}if(Sd){Vd="variable-2";break a}break a}}}return Vd},indent:function(Eb,Fb){if(Eb.tokenize==ua)return lb.passIndent;if(Eb.tokenize!=
I)return 0;var Vd=Fb&&Fb.charAt(0),Sd=Eb.lexical,Gc;if(!/^\s*else\b/.test(Fb))for(var ig=Eb.cc.length-1;0<=ig;--ig){var Ji=Eb.cc[ig];if(Ji==qc)Sd=Sd.prev;else if(Ji!=wa)break}for(;!("stat"!=Sd.type&&"form"!=Sd.type||"}"!=Vd&&(!(Gc=Eb.cc[Eb.cc.length-1])||Gc!=Ue&&Gc!=Fc||/^[,\.=+\-*:?[\(]/.test(Fb)));)Sd=Sd.prev;xi&&")"==Sd.type&&"stat"==Sd.prev.type&&(Sd=Sd.prev);Gc=Sd.type;ig=Vd==Gc;return(Ji=Eb._string)&&Ji.trimLeft().startsWith("?")&&":"===Vd?Ji.indexOf("?"):Ji&&":"===Eb.lastType&&"}"!==Sd.type?
Ji.match(/^\s*/)[0].length:"vardef"==Gc?(Fb=Sd.indented+Sd.info+2+Eb.localVars.name.length,"?"===Vd||":"===Vd||"|"===Vd||"&"===Vd?Fb:","==Eb.lastType?Sd.indented+Sd.info+1:"operator"==Eb.lastType?Fb+3:Sd.indented):"form"==Gc&&"{"==Vd?Sd.indented:"form"==Gc?Sd.indented+Te:"stat"==Gc?(Vd=Sd.indented,Eb="operator"==Eb.lastType||","==Eb.lastType||Ni.test(Fb.charAt(0))||/[,.]/.test(Fb.charAt(0)),Vd+(Eb?xi||Te:0)):"switch"!=Sd.info||ig||0==rc.doubleIndentSwitch?Sd.align?Sd.column+(ig?0:1):Sd.indented+(ig?
0:Te):Sd.indented+(/^(?:case|default)\b/.test(Fb)?Te:2*Te)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:$d?null:"/*",blockCommentEnd:$d?null:"*/",lineComment:$d?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:$d?"json":"javascript",jsonldMode:dh,jsonMode:$d,expressionAllowed:lb.expressionAllowed,skipExpression:function(Eb){var Fb=Eb.cc[Eb.cc.length-1];Fb!=Qa&&Fb!=Hb||Eb.cc.pop()}}});lb.registerHelper("wordChars","javascript",/[\w$]/);lb.defineMIME("text/javascript",
"javascript");lb.defineMIME("text/ecmascript","javascript");lb.defineMIME("application/javascript","javascript");lb.defineMIME("application/x-javascript","javascript");lb.defineMIME("application/ecmascript","javascript");lb.defineMIME("application/json",{name:"javascript",json:!0});lb.defineMIME("application/x-json",{name:"javascript",json:!0});lb.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});lb.defineMIME("text/typescript",{name:"javascript",typescript:!0});lb.defineMIME("application/typescript",
{name:"javascript",typescript:!0});var Wb=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");Wb.string=Nc;Wb.JavaScriptChecker=zb;Wb.JavaScriptNavigator=Kc;Wb.completers=da;Wb.jsSnippets=cb;Wb.jsIdeCommands=Ma;Wb.jsEditorCommands=Va;Wb.astEditorCommands=Oa;Wb.CodeMirrorEnabledEditorPlugin=Vc;Wb.Snippet=Kb;Wb.parser=Yc;Wb.localInterface=hc;Wb.systemInterfaceNamed=kc;Wb.serverInterfaceFor=xb;Wb.l2lInterfaceFor=yb;zb=function(Nb){var rc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),
xc=rc.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof rc.JavaScriptEditorPlugin?rc.JavaScriptEditorPlugin:rc.JavaScriptEditorPlugin=function(I){I&&I[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return nb(xc,Nb,[{key:Symbol.for("lively-instance-initialize"),value:function(){nb._get(Object.getPrototypeOf(xc.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new Wb.JavaScriptChecker;this.evalEnvironment=
{format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(I){nb._get(Object.getPrototypeOf(xc.prototype),"attach",this).call(this,I);this.evalEnvironment.context=I}},{key:"detach",value:function(I){this.checker.uninstall(this.textMorph);nb._get(Object.getPrototypeOf(xc.prototype),"detach",this).call(this,I)}},{key:"getNavigator",value:function(){return new Wb.JavaScriptNavigator}},
{key:"getCompleters",value:function(I){return Wb.completers.concat(I)}},{key:"getCommands",value:function(I){return[].concat($jscomp.arrayFromIterable(nb._get(Object.getPrototypeOf(xc.prototype),"getCommands",this).call(this,I)),$jscomp.arrayFromIterable(Wb.jsIdeCommands),$jscomp.arrayFromIterable(Wb.jsEditorCommands),$jscomp.arrayFromIterable(Wb.astEditorCommands))}},{key:"getKeyBindings",value:function(I){return[].concat($jscomp.arrayFromIterable(I),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},
{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},
{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},{key:"getMenuItems",value:function(I){var T=this,ua,Da,Lb,ub,Ja;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rb){ua=T.textMorph;Da=[{command:"doit",target:ua,showKeyShortcuts:!0},{command:"inspectit",target:ua,showKeyShortcuts:!0},{command:"printit",target:ua,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:ua,showKeyShortcuts:!0},{command:"eval all",target:ua,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:ua,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:ua,showKeyShortcuts:!0},{isDivider:!0}];T.evalEnvironment.targetModule&&Da.push({command:"[javascript] inject import",alias:"add import",target:ua},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:ua},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:ua});Lb=T.getNavigator();(ub=Lb.resolveIdentifierAt(ua,
ua.cursorPosition))&&Da.push({command:"selectDefinition",alias:'jump to definition of "'+ub.name+'"',target:ua},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+ub.name+'"',target:ua});(Ja=ua.selection.text.trim())&&Da.push({command:"open code search",alias:'code search for "'+Wb.string.truncate(Ja,30)+'"',target:ua.world(),args:{input:Ja,backend:T.backend()}});Da.push({isDivider:!0});return Rb.return(Da.concat(I))})}},{key:"getSnippets",value:function(){return Wb.jsSnippets.map(function(I){var T=
$jscomp.makeIterator(I);I=T.next().value;T=T.next().value;return new Wb.Snippet({trigger:I,expansion:T})})}},{key:"sanatizedJsEnv",value:function(I){I=Object.assign({},this.evalEnvironment,{},I);I.format||(I.formatd="esm");I.context||(I.context=this.textMorph);I.sourceURL||(I.sourceURL=I.targetModule+"_doit_"+Date.now());I.systemInterface||(I.systemInterface=Wb.localInterface);return I}},{key:"backend",value:function(I){I=this.sanatizedJsEnv(I);return I.remote?I.remote:"local"}},{key:"systemInterface",
value:function(I){return this.sanatizedJsEnv(I).systemInterface||Wb.localInterface}},{key:"setSystemInterface",value:function(I){return this.evalEnvironment.systemInterface=I}},{key:"setSystemInterfaceNamed",value:function(I){return this.setSystemInterface(Wb.systemInterfaceNamed(I))}},{key:"runEval",value:function(I,T){T=this.sanatizedJsEnv(T);return this.systemInterface(T).runEval(I,T)}},{key:"parser",get:function(){return Wb.parser}},{key:"parse",value:function(I){I=void 0===I?null:I;if(this._ast&&
this._ast._astType===I)return this._ast;var T=this.parser,ua=this.textMorph.textString;if(!T)return null;var Da={withComments:!0,allowReturnOutsideFunction:!0};I&&(Da.type=I);if(ua.startsWith("#!")){var Lb=ua.indexOf("\n");ua=" ".repeat(Lb)+ua.slice(Lb)}T=T.fuzzyParse(ua,Da);T._astType=I;return this._ast=T}},{key:"undeclaredVariables",value:function(I){var T=this.parser,ua=this.evalEnvironment.knownGlobals||[];I=this.parse(void 0===I?null:I);return T&&I?T.query.findGlobalVarRefs(I,{jslintGlobalComment:!0}).filter(function(Da){return!ua.includes(Da.name)}):
[]}}],[{key:"className",get:function(){return"JavaScriptEditorPlugin"}}],rc,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:662,end:6664})}(Wb.CodeMirrorEnabledEditorPlugin);zb=Wb.JavaScriptEditorPlugin;ta("default",zb);Wb.default=zb}}});System.register("10",[],function(){return{execute:function(){lively.FreezerRuntime.recorderFor("lively.shell/index.js")}}});
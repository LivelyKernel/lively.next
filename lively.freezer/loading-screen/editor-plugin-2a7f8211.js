System.register(["./__root_module__-a4bfb546.js","./index-164fc5db.js","./index-fa81bc5d.js"],function(ta){var cb,mb,Sb,Jb,sd,vc,wd,wc,Cc,Gc,Cd,pe,Je,ce,Qb,pc,ld,Rb,xd,Hd,Dc,bc,Ib,gc,sc,dd,bd,oc,$a,fb,ya,Ca,Aa,xa,Oa,wb,dc,Ya,jb,Za,U,va,M,da,Ia;return{setters:[function(Wa){cb=Wa.C;mb=Wa.aw;Sb=Wa.a6;Jb=Wa.a1;sd=Wa.a3;vc=Wa.ab;wd=Wa.bj;wc=Wa.aZ;Cc=Wa.au;Gc=Wa.a7;Cd=Wa.aR;pe=Wa.bn;Je=Wa.bo;ce=Wa.a8;Qb=Wa.aj;pc=Wa.at;ld=Wa.av;Rb=Wa.bp;xd=Wa.bq;Hd=Wa.a2;Dc=Wa.P;bc=Wa.$;Ib=Wa.aY;gc=Wa.an;sc=Wa.ao;dd=
Wa.ap;bd=Wa.aq;oc=Wa.aD;$a=Wa.b0;fb=Wa.az;ya=Wa.as;Ca=Wa.ad;Aa=Wa.br;xa=Wa.L;Oa=Wa.bs;wb=Wa.b5;dc=Wa.bk;Ya=Wa.b4;jb=Wa.bt;Za=Wa.ax},function(Wa){U=Wa.M;va=Wa.I;M=Wa.v;da=Wa.p},function(Wa){Ia=Wa.localInterface}],execute:function(){function Wa(ua,Ha){if(!0===Ha)return Ha;if(ua.copyState)return ua.copyState(Ha);ua={};for(var pb in Ha){var R=Ha[pb];R instanceof Array&&(R=R.concat([]));ua[pb]=R}return ua}function Zb(ua,Ha,pb){return ua.startState?ua.startState(Ha,pb):!0}function Oc(ua,Ha){return bb.modes[ua]=
Ha}function Ub(ua){if("string"==typeof ua&&bb.mimeModes.hasOwnProperty(ua))ua=bb.mimeModes[ua];else if(ua&&"string"==typeof ua.name&&bb.mimeModes.hasOwnProperty(ua.name)){var Ha=bb.mimeModes[ua.name];"string"==typeof Ha&&(Ha={name:Ha});ua=Object.assign({},Ha,ua);ua.name=Ha.name}else{if("string"==typeof ua&&/^[\w\-]+\/[\w\-]+\+xml$/.test(ua))return Ub("application/xml");if("string"==typeof ua&&/^[\w\-]+\/[\w\-]+\+json$/.test(ua))return Ub("application/json")}return"string"==typeof ua?{name:ua}:ua||
{name:"null"}}function vb(ua,Ha){Ha=bb.resolveMode(Ha);"string"===typeof Ha&&(Ha={name:Ha});if(!Ha.name)throw Error("parserConfig does not have a name of the mode to get");var pb=bb.modes[Ha.name];if(!pb)return vb(ua,"text/plain");ua=Object.assign({indentUnit:2},ua);return Object.assign(pb(ua,Ha),{name:Ha.name})}function pd(ua,Ha){for(var pb;ua.innerMode;){pb=ua.innerMode(Ha);if(!pb||pb.mode==ua)break;Ha=pb.state;ua=pb.mode}return pb||{mode:ua,state:Ha}}function $c(ua,Ha){bb.mimeModes[ua]=Ha}function Sa(ua,
Ha,pb){}function nb(ua,Ha,pb,R,pa,Va,gb){var ec=ua.editorPlugin._tokenizerValidBefore;ec&&ec.row>=pb&&(ec.row=pb-1);var ac=bb.linesToTokenize(ua.document,pb,R,ec);ec=ac.lines;ac=ac.state;if(!ec.length)return!1;ac=ac?bb.copyState(Ha,ac):bb.startState(Ha);for(var Ec=0;Ec<ec.length;Ec++){var Mc=ec[Ec],xc=Mc.row;xc>=pb&&xc<=R&&bb.indentLine(ua,Ha,Mc,ac,pa,Va,gb);ac=bb.tokenizeLine(Ha,ec[Ec],ac,function(){})}return!0}function tc(ua,Ha,pb,R,pa,Va,gb){Ha=bb.linesToTokenize(Ha,pb,R,pa);pb=Ha.lines;bb.tokenizeLines(ua,
pb,Ha.state,Va,gb);return pb}function ab(ua,Ha,pb,R,pa){var Va=[],gb,ec=function(Mc){return Va.push(gb=[])},ac=function(Mc,xc,ze,nf,bf,Bg,Me){return gb.push(ze,nf,Mc,bf.current(),xc.localMode||Me)};try{var Ec=bb.visitDocumentTokens(ua,Ha,pb,R,pa,ec,ac)}catch(Mc){Va.length=0,Ec=bb.visitDocumentTokens(ua,Ha,pb,R,null,ec,ac)}return{tokens:Va,lines:Ec}}function zc(ua,Ha,pb,R,pa){null==Ha&&(Ha=ua.search(/[^\s\u00a0]/),-1==Ha&&(Ha=ua.length));R=R||0;for(pa=pa||0;;){var Va=ua.indexOf("\t",R);if(0>Va||Va>=
Ha)return pa+(Ha-R);pa+=Va-R;pa+=pb-pa%pb;R=Va+1}}function Fc(ua){ua=ua.toLowerCase();for(var Ha=0;Ha<bb.modeInfo.length;Ha++){var pb=bb.modeInfo[Ha];if(pb.mime==ua)return pb;if(pb.mimes)for(var R=0;R<pb.mimes.length;R++)if(pb.mimes[R]==ua)return pb}if(/\+xml$/.test(ua))return Fc("application/xml");if(/\+json$/.test(ua))return Fc("application/json")}function Xa(ua){for(var Ha=0;Ha<bb.modeInfo.length;Ha++){var pb=bb.modeInfo[Ha];if(pb.ext)for(var R=0;R<pb.ext.length;R++)if(pb.ext[R]==ua)return pb}}
function db(ua){for(var Ha=0;Ha<bb.modeInfo.length;Ha++){var pb=bb.modeInfo[Ha];if(pb.file&&pb.file.test(ua))return pb}Ha=ua.lastIndexOf(".");if(ua=-1<Ha&&ua.substring(Ha+1,ua.length))return bb.findModeByExtension(ua)}function hb(ua){ua=ua.toLowerCase();for(var Ha=0;Ha<bb.modeInfo.length;Ha++){var pb=bb.modeInfo[Ha];if(pb.name.toLowerCase()==ua)return pb;if(pb.alias)for(var R=0;R<pb.alias.length;R++)if(pb.alias[R].toLowerCase()==ua)return pb}}function Rc(ua){if(!ua)return String(ua);if(Array.isArray(ua))return"["+
ua.map(Rc).join(",")+"]";if("symbol"===typeof ua)return Jc.printSymbol(ua);try{return String(ua)}catch(Ha){return"Cannot print object: "+Ha}}function qd(ua,Ha){return!Jc.arr.every(Ha.map(function(pb){return ua[pb]}),function(pb){return Jc.obj.equals(pb,ua&&ua.valueOf())})}function Xd(ua){if(Jc.obj.isPrimitive(ua))var Ha=Jc.string.print(ua);else Array.isArray(ua)?((Ha=3<ua.length)&&(ua=ua.slice(0,3)),ua=Jc.string.print(ua),Ha&&(ua=ua.slice(0,-1)+", ...]"),Ha=ua):Ha=Jc.string.print(ua);Ha=Ha.replace(/\n/g,
"");500<Ha.length&&(Ha=Ha.slice(0,20)+("...["+(Ha.length-20)+' CHARS]"'));return Ha}function hc(ua){return Db.Inspector.openInWindow({targetObject:ua})}function Id(ua,Ha){return Db.Inspector.openInWindow({remoteTarget:{code:ua,evalEnvironment:Ha}})}function Pc(ua,Ha){function pb(ec){var ac=ec.name,Ec=ec.ownerChain(),Mc=ec.owner,xc=ec.world(),ze;ec===Va&&(ze=[gb]);xc===ec&&(ze=["$world"]);if(!ze&&ac&&Mc){Mc===xc&&1===Db.arr.count(Db.arr.pluck(xc.submorphs,"name"),ac)&&(ze=['$world.get("'+ac+'")']);
if(!ze&&Mc!=xc)for(xc=Ec.length-1;xc--;)if(1===Ec[xc].getAllNamed(ac).length){ze=[].concat($jscomp.arrayFromIterable(pb(Ec[xc])),['get("'+ac+'")']);break}ze||(ac=[].concat($jscomp.arrayFromIterable(pb(Mc)),['get("'+ac+'")']),Db.syncEval(ac.join("."),{context:Va}).value===ec&&(ze=ac))}ze||(ze=[gb+'.getMorphById("'+ec.id+'")']);return ze}Ha=void 0===Ha?{}:Ha;var R=ua.world(),pa=Ha;Ha=void 0===pa.maxLength?10:pa.maxLength;var Va=void 0===pa.fromMorph?R:pa.fromMorph;if(Va===ua)return"this";var gb=R===
Va?"$world":"this";if(!(R||ua.name&&Va.get(ua.name)===ua))return"morph";R=pb(ua);return R.length>Ha?'$world.getMorphWithId("'+ua.id+'")':R.join(".")}function Jd(ua,Ha,pb){var R=(Ha=void 0===Ha?"":Ha)&&he.arr.last(Ha.split(".")).toLowerCase(),pa="",Va=0,gb=Math.pow(2,19);if("string"===typeof ua){if(ua.length>gb)return null}else if(ua.document.stringSize>gb)return null;if("string"===typeof ua)pa=ua.slice(0,1E3);else for(ua=$jscomp.makeIterator(ua.document.lines),gb=ua.next();!gb.done;gb=ua.next()){var ec=
gb.value;gb=ec.stringSize;ec=ec.text;var ac=!0;1E3<Va+gb&&(ac=!1,gb=1E3-Va);pa+=ec.slice(0,gb)+(ac?"\n":"");Va+=gb;if(1E3<=Va)break}Va=$jscomp.makeIterator(he.modeInfo);for(ua=Va.next();!ua.done;ua=Va.next()){ac=ua.value;gb=ac.contentTest;ua=ac.mode;ec=ac.ext;ac=ac.file;if("function"===typeof gb)try{if(gb(pa))return ua}catch(Ec){}if(ac&&ac instanceof RegExp&&ac.test(Ha))return ua;if(ec)for(gb=$jscomp.makeIterator(ec),ec=gb.next();!ec.done;ec=gb.next())if(ec.value===R)return ua}return pb}ta({a:$c,
d:Oc,r:Sa});var fa=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");fa.Color=cb;var Qa=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),pb=Ha.hasOwnProperty("DefaultTheme")&&"function"===typeof Ha.DefaultTheme?Ha.DefaultTheme:Ha.DefaultTheme=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:"background",get:function(){return fa.Color.white}},{key:"default",
get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},
{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},
{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},
{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},
{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:fa.Color.white,fontWeight:"bold",backgroundColor:fa.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:fa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:fa.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",
get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ha,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2826})}(void 0),Ja=Qa=fa.DefaultTheme;fa.default=Qa;var bb=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");bb.copyState=Wa;bb.startState=Zb;bb.defineMode=Oc;bb.resolveMode=Ub;bb.getMode=vb;bb.innerMode=pd;bb.defineMIME=$c;bb.registerHelper=Sa;bb.indentLines=nb;bb.indentLine=function(ua,Ha,pb,R,pa,Va,gb){gb=Object.assign({indentWithTabs:!ua.useSoftTabs,indentUnit:ua.tabWidth,tabSize:4,ignoreFollowingText:!1},
gb);null==pa&&(pa="add");"smart"==pa&&(Ha.indent||(pa="prev"));var ec=gb.tabSize,ac=pb.text,Ec=bb.countColumn(ac,null,ec);pb.modeState&&(pb.modeState=null);var Mc=ac.match(/^\s*/)[0];if(!Va&&!/\S/.test(ac)){var xc=0;pa="not"}else if("smart"==pa&&(xc=Ha.indent(R,gb.ignoreFollowingText?"":ac.slice(Mc.length),ac),xc==bb.passIndent||150<xc)){if(!Va)return;pa="prev"}"prev"==pa?xc=0<pb.row?bb.countColumn(pb.prevLine().text,null,ec):0:"add"==pa?xc=Ec+gb.indentUnit:"subtract"==pa?xc=Ec-gb.indentUnit:"number"==
typeof pa&&(xc=Ec+pa);xc=Math.max(0,xc);Ha="";R=0;if(gb.indentWithTabs)for(gb=Math.floor(xc/ec);gb;--gb)R+=ec,Ha+="\t";R<xc&&(Ha+=" ".repeat(xc-R));if(Ha!=Mc)return ua.replace({start:{row:pb.row,column:0},end:{row:pb.row,column:Mc.length}},Ha),!0};bb.tokenizeLines=function(ua,Ha,pb,R,pa){if(Ha.length){pb=pb?bb.copyState(ua,pb):bb.startState(ua);for(var Va=0;Va<Ha.length;Va++){var gb=Ha[Va];R(gb);pb=bb.tokenizeLine(ua,gb,pb,pa)}}};bb.tokenizeLine=function(ua,Ha,pb,R){var pa=Ha.text;if(!pa)return pb;
var Va=new bb.StringStream(pa,2);pb=Ha.modeState="function"===typeof ua.copyState?ua.copyState(pb):bb.copyState(ua,pb);Ha.prevLine();for(pb._string=pa;!Va.eol();)pa=ua.token(Va,pb),R(pa,pb,Va.start,Va.pos,Va,Ha,ua),Va.start=Va.pos;return pb};bb.printTokens=function(ua){for(var Ha="",pb=0;pb<ua.length;pb+=5)Ha+=ua[pb+0]+" => "+ua[pb+1]+" "+ua[pb+2]+" "+ua[pb+3]+" "+ua[pb+4].name+"\n";return Ha};bb.visitDocumentTokens=tc;bb.tokenizeDocument=ab;bb.linesToTokenize=function(ua,Ha,pb,R){if(R&&R.row>=pb)return{lines:[],
state:null};Ha=R?Math.max(0,R.row-1):Ha;var pa=ua.getLine(Ha),Va=pa.text;ua=[pa];R=null;for(var gb=0,ec;(ec=pa.prevLine())&&50>gb++;){pa=ec;if(pa.modeState){R=pa.modeState;break}ua.unshift(pa)}if(!R){for(var ac=pa,Ec=Infinity;(ec=pa.prevLine())&&100>gb++;){pa=ec;if(pa.modeState){R=pa.modeState;break}ua.unshift(pa);ec=Va.match(/^\s*/)[0].length;if(0===ec)break;ec<Ec&&(Ec=ec,ac=pa)}!R&&0<Ec&&(ua=ua.slice(ua.indexOf(ac)))}if(pb>Ha)for(pa=bb.arr.last(ua);Ha<=pb;Ha++){pa=pa.nextLine();if(!pa)break;ua.push(pa)}return{lines:ua,
state:R}};bb.countColumn=zc;bb.findModeByMIME=Fc;bb.findModeByExtension=Xa;bb.findModeByFileName=db;bb.findModeByName=hb;bb.arr=Sb;Qa=bb.modes||{};bb.modes=Qa;bb.modes=Qa;bb.modes=Qa;Qa=ta("p",{});bb.passIndent=Qa;bb.passIndent=Qa;bb.passIndent=Qa;bb.copyState=Wa;bb.copyState=Wa;bb.startState=Zb;bb.startState=Zb;bb.defineMode=Oc;bb.defineMode=Oc;bb.resolveMode=Ub;bb.resolveMode=Ub;bb.getMode=vb;bb.getMode=vb;bb.innerMode=pd;bb.innerMode=pd;Qa={};bb.mimeModes=Qa;bb.mimeModes=Qa;bb.mimeModes=Qa;bb.defineMIME=
$c;bb.defineMIME=$c;bb.registerHelper=Sa;bb.registerHelper=Sa;bb.indentLines=nb;bb.indentLines=nb;bb.visitDocumentTokens=tc;bb.visitDocumentTokens=tc;bb.tokenizeDocument=ab;bb.tokenizeDocument=ab;bb.countColumn=zc;bb.countColumn=zc;(function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),pb=Ha.hasOwnProperty("StringStream")&&"function"===typeof Ha.StringStream?Ha.StringStream:Ha.StringStream=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return mb(pb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R,pa){this.reset(R,pa)}},{key:"reset",value:function(R,pa){this.pos=this.start=0;this.string=void 0===R?"":R;this.tabSize=void 0===pa?2:pa;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",
value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(R){var pa=this.string.charAt(this.pos);if("string"==typeof R?pa==R:pa&&(R.test?R.test(pa):R(pa)))return++this.pos,pa}},{key:"eatWhile",value:function(R){for(var pa=this.pos;this.eat(R););return this.pos>pa}},{key:"eatSpace",value:function(){for(var R=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>R}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},
{key:"skipTo",value:function(R){R=this.string.indexOf(R,this.pos);if(-1<R)return this.pos=R,!0}},{key:"backUp",value:function(R){this.pos-=R}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=bb.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?bb.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return bb.countColumn(this.string,
null,this.tabSize)-(this.lineStart?bb.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(R,pa,Va){if("string"==typeof R){var gb=function(ac){return Va?ac.toLowerCase():ac},ec=this.string.substr(this.pos,R.length);if(gb(ec)==gb(R))return!1!==pa&&(this.pos+=R.length),!0}else{if((R=this.string.slice(this.pos).match(R))&&0<R.index)return null;R&&!1!==pa&&(this.pos+=R[0].length);return R}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},
{key:"hideFirstChars",value:function(R,pa){this.lineStart+=R;try{return pa()}finally{this.lineStart-=R}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],Ha,{pathInPackage:function(){return"editor-modes.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);Qa=[{name:"APL",mime:"text/apl",
mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),
alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",
mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",
mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"],contentTest:function(ua){return ua.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",
mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",
mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",
mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",
mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",
mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},
{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",
mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",
mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p",
"pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",
ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},
{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",
mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(ua){return ua.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},
{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},
{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",
mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",
mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",
ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml",
"text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];bb.modeInfo=Qa;bb.modeInfo=Qa;bb.modeInfo=Qa;for(var H=0;H<bb.modeInfo.length;H++)bb.info=bb.modeInfo[H],bb.info.mimes&&(bb.info.mime=bb.info.mimes[0]);bb.defineMode("null",function(){return{token:function(ua){return ua.skipToEnd()}}});
bb.defineMIME("text/plain","null");bb.findModeByMIME=Fc;bb.findModeByMIME=Fc;bb.findModeByExtension=Xa;bb.findModeByExtension=Xa;bb.findModeByFileName=db;bb.findModeByFileName=db;bb.findModeByName=hb;bb.findModeByName=hb;var aa=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");aa.Color=cb;aa.Rectangle=Jb;aa.pt=sd;aa.morph=vc;aa.ShadowObject=wd;aa.StyleSheet=wc;aa.connect=Cc;aa.arr=Sb;aa.string=Gc;aa.FilterableList=Cd;aa.Range=pe;H=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),
pb=Ha.hasOwnProperty("Completer")&&"function"===typeof Ha.Completer?Ha.Completer:Ha.Completer=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],Ha,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:347,end:394})}(void 0);aa.Completer=H;aa.Completer=H;aa.Completer=H;H=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),pb=Ha.hasOwnProperty("WordCompleter")&&"function"===typeof Ha.WordCompleter?Ha.WordCompleter:Ha.WordCompleter=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:"compute",value:function(R,
pa){var Va=[],gb=[],ec=R.document.lineStrings;R=R.cursorPosition.row;for(var ac=R-1;0<=ac;ac--)for(var Ec=$jscomp.makeIterator(ec[ac].split(/[^0-9a-z@_]+/i)),Mc=Ec.next();!Mc.done;Mc=Ec.next())(Mc=Mc.value)&&!Va.includes(Mc)&&Mc!==pa&&(Va.push(Mc),gb.push({priority:1E3-(R-ac),completion:Mc}));for(ac=R+1;ac<ec.length;ac++)for(Ec=$jscomp.makeIterator(ec[ac].split(/[^0-9a-z_@]+/i)),Mc=Ec.next();!Mc.done;Mc=Ec.next())(Mc=Mc.value)&&!Va.includes(Mc)&&Mc!==pa&&(Va.push(Mc),gb.push({priority:1E3-(ac-R),
completion:Mc}));return gb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Ha,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:403,end:1274})}(void 0);aa.WordCompleter=H;aa.WordCompleter=H;aa.WordCompleter=H;H=[new aa.WordCompleter];aa.defaultCompleters=
H;aa.defaultCompleters=H;aa.defaultCompleters=H;H=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),pb=Ha.hasOwnProperty("CompletionController")&&"function"===typeof Ha.CompletionController?Ha.CompletionController:Ha.CompletionController=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R,pa){pa=void 0===pa?
[]:pa;this.textMorph=R;this.completers=pa=R.pluginCollect("getCompleters",pa)}},{key:"computeCompletions",value:function(R){var pa=this,Va,gb,ec,ac,Ec,Mc,xc,ze,nf,bf,Bg,Me,sg,Gi,Tg,Zj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zf){switch(zf.nextAddress){case 1:Va=[],gb=$jscomp.makeIterator(pa.completers),ec=gb.next();case 2:if(ec.done){zf.jumpTo(4);break}ac=ec.value;zf.setCatchFinallyBlocks(5);Ec=Va;Mc=Ec.concat;return zf.yield(ac.compute(pa.textMorph,R),7);case 7:Va=Mc.call(Ec,zf.yieldResult);
zf.leaveTryBlock(3);break;case 5:xc=zf.enterCatchBlock(),console.warn("Error in completer "+ac+": "+(xc.stack||xc));case 3:ec=gb.next();zf.jumpTo(2);break;case 4:ze=new Map;Va.forEach(function(yi){var zh=ze.get(yi.completion);zh||(zh=[],ze.set(yi.completion,zh));zh.push(yi)});nf=[];bf=$jscomp.makeIterator(ze.values());for(Bg=bf.next();!Bg.done;Bg=bf.next())Me=Bg.value,nf.push(aa.arr.last(aa.arr.sortByKey(Me,"priority")));sg=0;Gi=aa.arr.sortByKey(nf,"priority").reverse();Tg=Gi.length&&Gi[0].priority||
0;Zj=Gi.map(function(yi){yi.highestPriority=Tg;var zh=yi.completion.replace(/\n/g,""),lj=String((yi.info||"").replace(/\n/g,""));sg=Math.max(sg,zh.length+lj.length);return{isListItem:!0,string:zh,annotation:lj,value:yi}});return zf.return({items:Zj,maxCol:sg})}})}},{key:"computeSortedCompletions",value:function(R,pa){pa=void 0===pa?!1:pa;var Va=this,gb,ec,ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress)return gb={tokens:[R],lowercasedTokens:[R],input:R},Ec.yield(Va.computeCompletions(R),
2);ec=Ec.yieldResult;ac=aa.arr.sortBy(ec.items.filter(function(Mc){return Va.filterFunction(gb,Mc,pa)}),function(Mc){return Va.sortFunction(gb,Mc)});return Ec.return(ac)})}},{key:"_printCompletions",value:function(R){var pa=this,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return gb.yield(pa.computeSortedCompletions(R),2);Va=gb.yieldResult.map(function(ec){return{completion:ec.value.completion,priority:ec.value.priority,maxP:ec.value.highestPriority,sortVal:ec._cache[R].sortVal,
lev:JSON.stringify(ec._cache[R].levenshtein)}});return gb.return(aa.string.printTable(lively.lang.grid.tableFromObjects(Va)))})}},{key:"prefix",value:function(){var R=this.textMorph,pa=R.selection;return(pa.isEmpty()?R.getLine(pa.lead.row).slice(0,pa.lead.column):pa.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(R,pa,Va){Va=void 0===Va?!1:Va;pa._cache||(pa._cache={});var gb=R.tokens,ec=R.lowercasedTokens,ac=R.input;ac=pa._cache[ac]||(pa._cache[ac]={});if(ac.hasOwnProperty("filtered"))return ac.filtered;
pa=pa.value.completion.replace(/\([^\)]*\)$/,"");var Ec=pa.toLowerCase();if(Va&&gb[0]&&!pa.startsWith(gb[0]))return ac.filtered=!1;if(ec.every(function(xc){return Ec.includes(xc)}))return!0;var Mc=ac.levenshtein||(ac.levenshtein={});R=Va||3>=aa.arr.sum(R.lowercasedTokens.map(function(xc){return Mc[xc]||(Mc[xc]=aa.string.levenshtein(Ec,xc))}));return ac.filtered=R}},{key:"sortFunction",value:function(R,pa){pa._cache||(pa._cache={});var Va=pa._cache[R.input]||(pa._cache[R.input]={});if(Va.hasOwnProperty("sortVal"))return Va.sortVal;
Va=pa._cache[R.input]={};var gb=pa.value;pa=gb.highestPriority;var ec=gb.completion;gb=gb.priority;ec=ec.replace(/\([^\)]*\)$/,"").toLowerCase();var ac=0;R.lowercasedTokens.forEach(function(Mc){ec.startsWith(Mc)?ac+=12:3<=Mc.length&&ec.includes(Mc)&&(ac+=5)});pa=-((gb||(ac?pa:0))/Math.pow(10,String(pa).length-2))-ac;var Ec=Va.levenshtein||(Va.levenshtein={});R=aa.arr.sum(R.lowercasedTokens.map(function(Mc){return Ec[Mc]||(Ec[Mc]=aa.string.levenshtein(ec,Mc))}));ac&&(R/=2);return Va.sortVal=R+pa}},
{key:"positionForMenu",value:function(){var R=this.textMorph,pa=R.charBoundsFromTextPosition(R.cursorPosition);return R.getGlobalTransform().transformRectToRect(pa).topLeft().addXY(-R.scroll.x,-R.scroll.y).addPt(aa.pt(R.borderWidth+4,R.borderWidth+4))}},{key:"completionListSpec",value:function(){var R=this,pa,Va,gb,ec,ac,Ec,Mc,xc,ze,nf,bf,Bg,Me,sg,Gi,Tg,Zj,zf,yi,zh;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lj){if(1==lj.nextAddress)return Va=pa=R.textMorph,gb=Va.fontSize,ec=Va.fontFamily,
ac=R.positionForMenu(),Ec=R.prefix(),lj.yield(R.computeCompletions(Ec),2);Mc=lj.yieldResult;xc=Mc.items;ze=Mc.maxCol;nf=pa.env.fontMetric.sizeFor(ec,gb,"M");bf=nf.width*ze;Bg=pa.document.getLine(0).height;Me=Math.max(120,bf<pa.width?bf:pa.width);sg=Bg*xc.length+Bg+10;Gi=Math.max(70,Math.min(700,sg));Tg=ac.extent(aa.pt(Me,Gi));if(Zj=pa.world())zf=Zj.visibleBounds().insetBy(5),Tg.bottom()>zf.bottom()&&(yi=Tg.bottom()-zf.bottom(),yi>Tg.height-50&&(yi=Tg.height-50),Tg.height-=yi),Tg.right()>zf.right()&&
(zh=Tg.right()-zf.right(),Tg.width=120>Tg.width-zh?120:Tg.width-zh),zf.containsRect(Tg)||(Tg=Tg.withTopLeft(zf.translateForInclusion(Tg).topLeft())),Tg=Tg.translatedBy(zf.insetBy(0).topLeft().negated());return lj.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},hasFixedPosition:!0,epiMorph:!0,fontSize:gb,position:Tg.topLeft(),extent:Tg.extent(),items:xc,input:Ec,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:R.filterFunction,sortFunction:R.sortFunction})})}},
{key:"removeMenuOnBlur",value:function(R){var pa=R.menu;setTimeout(function(){pa.withAllSubmorphsDetect(function(Va){return Va.isFocused()})?pa.inputMorph.focus():pa.remove()})}},{key:"openCompletionList",value:function(){var R=this,pa,Va,gb,ec,ac,Ec,Mc,xc,ze,nf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bf){if(1==bf.nextAddress)return pa=R.textMorph.selection.start,bf.yield(R.completionListSpec(),2);if(3!=bf.nextAddress)return Va=bf.yieldResult,R.textMorph.pluginFind(function(Bg){return Bg.theme}),
gb=new aa.FilterableList(Va),ec=new aa.Range({start:pa,end:R.textMorph.selection.start}),ac=R.textMorph.textInRange(ec),Ec=gb.inputMorph,Mc=gb.listMorph,xc=Va.input,ze=gb.addMorph({name:"prefix mask",fill:aa.Color.transparent,bounds:Ec.textBounds()},Ec),Mc.master=null,ec.isEmpty()||(R.textMorph.deleteText(ec),Ec.input=ac,Ec.gotoDocumentEnd()),Ec.fontColor=R.textMorph.fontColor,aa.connect(Ec,"textString",ze,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Ec}}),aa.connect(gb,"accepted",
R,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",varMapping:{prefix:xc}}),
aa.connect(gb,"accepted",gb,"remove"),aa.connect(gb,"canceled",gb,"remove"),aa.connect(gb,"remove",R.textMorph,"focus"),aa.connect(gb.inputMorph,"onBlur",R,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:gb}}),nf=R.textMorph.world(),Mc.addStyleClass("hiddenScrollbar"),gb.paddingMorph.height=2,Ec.height=Mc.itemHeight,Ec.clipMode="visible",Ec.fill=R.textMorph.fill,Ec.fixedHeight=!0,Ec.fixedWidth=!1,Ec.fontSize=Mc.fontSize,gb.relayout(),gb.selectedIndex=0,gb.master.applyIfNeeded(!0),
Ec.focus(),bf.yield(gb.master.whenApplied(),3);xc.length&&(Ec.gotoDocumentEnd(),gb.moveBy(aa.pt(-Ec.textBounds().width,0)));nf.addMorph(gb);gb.inputPadding=aa.Rectangle.inset(0,0,0,0);return bf.return(gb)})}},{key:"autoInsertBestMatchingCompletion",value:function(R,pa,Va){pa=void 0===pa?!0:pa;var gb=this,ec,ac,Ec,Mc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){if(1==xc.nextAddress)return ec=$jscomp,ac=ec.makeIterator,xc.yield(gb.computeSortedCompletions(R,pa),2);Ec=ac.call(ec,xc.yieldResult);
(Mc=Ec.next().value)&&gb.insertCompletion(Mc.value.completion,R,Va);xc.jumpToEnd()})}},{key:"insertCompletion",value:function(R,pa,Va){var gb=this.textMorph,ec=gb.document,ac=gb.selection.isMultiSelection?gb.selection.selections:[gb.selection];gb.undoManager.group();ac.forEach(function(Ec){Ec.collapseToEnd();var Mc=Ec.lead,xc=pa?ec.indexToPosition(ec.positionToIndex(Mc)-pa.length):Mc;"function"===typeof Va?Va(R,pa,gb,{start:xc,end:Mc},Ec):gb.replace({start:xc,end:Mc},R)});gb.undoManager.group()}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],Ha,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1402,end:13006})}(void 0);aa.CompletionController=H;aa.CompletionController=H;aa.CompletionController=H;H=[{name:"text completion",handlesCount:!0,
multiSelectAction:"single",exec:function(ua,Ha,pb){var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pa){return 1==pa.nextAddress?(R=new aa.CompletionController(ua,aa.defaultCompleters),pa.yield(R.openCompletionList(),2)):pa.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(ua,Ha,pb){var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pa){return 1==pa.nextAddress?(R=new aa.CompletionController(ua,aa.defaultCompleters),
pa.yield(R.autoInsertBestMatchingCompletion(R.prefix()),2)):pa.return(!0)})}}];aa.completionCommands=H;aa.completionCommands=H;aa.completionCommands=H;var Ma=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");Ma.chain=Je;Ma.arr=Sb;Ma.obj=ce;Ma.string=Gc;var tb=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(ua){var Ha=ua.selection.start;0<Ha.row&&(Ha=ua.getPositionAboveOrBelow(1,Ha,!0,0,ua.charBoundsFromTextPosition(Ha).x),ua.selection.addRange({start:Ha,
end:Ha}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(ua){var Ha=ua.selection.start;Ha.row<ua.documentEndPosition.row&&(Ha=ua.getPositionAboveOrBelow(-1,Ha,!0,0,ua.charBoundsFromTextPosition(Ha).x),ua.selection.addRange({start:Ha,end:Ha}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(ua){var Ha=ua.selection.selections[ua.selection.selections.length-1];if(Ha.isEmpty())return!0;ua.searchForAll(Ha.text,{start:{column:0,
row:0}}).forEach(function(pb){return ua.selection.addRange(pb.range,!1)});ua.selection.mergeSelections();Ma.arr.remove(ua.selection.selections,Ha);ua.selection.selections.push(Ha);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(ua){var Ha=ua.selection.selections.length-1,pb=ua.selection.selections[Ha];if(pb.isEmpty())return!0;var R=ua.search(pb.text,{start:pb.end,backwards:!1});R&&(pb=ua.selection.selections.findIndex(function(pa){return pa.range.equals(R.range)}),
-1<pb?Ma.arr.swap(ua.selection.selections,pb,Ha):ua.selection.addRange(R.range));return!0}},{name:"[multi select] more like this backward",multiSelectAction:"single",exec:function(ua){var Ha=ua.selection.selections.length-1,pb=ua.selection.selections[Ha];if(pb.isEmpty())return!0;var R=pb.start,pa=ua.search(pb.text,{start:{row:R.row,column:R.column-(pb.text.length-1)},backwards:!0});pa&&(pb=ua.selection.selections.findIndex(function(Va){return Va.range.equals(pa.range)}),-1<pb?Ma.arr.swap(ua.selection.selections,
pb,Ha):ua.selection.addRange(pa.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",exec:function(ua){var Ha=ua.selection.selections.length;1<Ha&&ua.selection.removeSelections(Ha-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(ua){ua.selection.selections=lively.lang.arr.rotate(ua.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(ua){ua.selection.selections=
lively.lang.arr.rotate(ua.selection.selections,1);return!0}},{name:"[multi select] align cursors",multiSelectAction:"single",exec:function(ua){var Ha=ua.selection.selections;if(1>=Ha.length)return!0;var pb=Ma.arr.groupBy(Ha,function(pa){return pa.range.start.row});Ha=pb.keys().map(function(pa){pa=pb[pa];var Va=Ma.arr.max(pa,function(gb){return gb.range.start.column});Ma.arr.without(pa,Va).forEach(function(gb){return gb.range=Va.range});return Va});var R=Ma.arr.max(Ha,function(pa){return pa.range.start.column}).range.start.column;
Ha.forEach(function(pa){var Va=pa.range.start;pa=Va.row;Va=Va.column;ua.insertText(" ".repeat(R-Va),{row:pa,column:Va})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(ua){ua.selection.disableMultiSelect();if(ua.selection.isEmpty())var Ha=ua.lastSavedMark&&ua.lastSavedMark.position||(void 0).lineRange().start,pb=ua.cursorPosition;else Ha=ua.selection,pb=Ha.lead,Ha=Ha.anchor;ua.selection.collapse();var R=Ha.column,pa=pb.column;Ma.arr.range(Ha.row,
pb.row).forEach(function(Va){return ua.getLine(Va).length>Math.min(pa,R)&&ua.selection.addRange({end:{row:Va,column:pa},start:{row:Va,column:R}},!1)});ua.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(ua,Ha,pb){pb=void 0===pb?1:pb;ua.undoManager.group();ua.selection.selections.forEach(function(R,pa){return R.text=String(pa+pb)});ua.undoManager.group();return!0}}];Ma.multiSelectCommands=tb;Ma.multiSelectCommands=tb;Ma.multiSelectCommands=
tb;var Lb=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");Lb.pToI=function(ua,Ha){return ua.positionToIndex(Ha)};Lb.iToP=function(ua,Ha){return ua.indexToPosition(Ha)};Lb.execCodeNavigator=function(ua){return function(Ha,pb,R){var pa=Ha.pluginInvokeFirst("getNavigator");if(!pa)return!0;Ha.saveMark();R=R||1;for(var Va=0;Va<R;Va++)pa[ua](Ha,pb);return!0}};Lb.once=Qb;var uc=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:Lb.execCodeNavigator("forwardSexp"),
multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",exec:Lb.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:Lb.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:Lb.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",
exec:Lb.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(ua,Ha){function pb(){var Va=ua.$expandRegionState,gb=Lb.pToI(ua,ua.cursorPosition);if(Va&&(Va.range[0]===gb||Va.range[1]===gb))return Va;Va=ua.selection.range;return ua.$expandRegionState={range:[Lb.pToI(ua,Va.start),Lb.pToI(ua,Va.end)]}}Ha=Ha||{};var R=ua.pluginInvokeFirst("getNavigator");if(!R)return!0;
var pa=Ha.start;Ha=Ha.end;if("number"===typeof pa&&"number"===typeof Ha)pb(),R={range:[pa,Ha],prev:pb()};else{pa=R.ensureAST(ua);if(!pa)return;R=R.expandRegion(ua,ua.textString,pa,pb())}R&&R.range&&(ua.selection={start:Lb.iToP(ua,R.range[0]),end:Lb.iToP(ua,R.range[1])},ua.$expandRegionState=R);Lb.once(ua,"selectionChange",function(){return ua.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},
exec:function(ua){if(ua.selection.isEmpty())return!0;var Ha=ua.pluginInvokeFirst("getNavigator");if(!Ha)return!0;var pb=Ha.ensureAST(ua);if(!pb)return!0;var R=ua.$expandRegionState;if(!R)return!0;(Ha=Ha.contractRegion(ua,ua.textString,pb,R))&&Ha.range&&(ua.selection={start:Lb.iToP(ua,Ha.range[0]),end:Lb.iToP(ua,Ha.range[1])},ua.$expandRegionState=Ha);Lb.once(ua,"selectionChange",function(){return ua.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];Lb.commands=uc;
Lb.commands=uc;Lb.commands=uc;var hd=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");hd.arr=Sb;hd.chain=Je;hd.string=Gc;var yd=[{name:"toggle comment",exec:function(ua){var Ha=ua.pluginInvokeFirst("getComment");if(!Ha)return!0;if(!Ha.lineCommentStart)return Ha.blockCommentStart?ua.execCommand("toggle block comment"):!0;var pb=Ha.lineCommentStart,R=new RegExp("^(\\s*)("+pb+"\\s?)(.*)");Ha=ua.document;var pa=ua.selection;pa.isEmpty()||0!==pa.end.column||pa.growRight(-1);
var Va=pa.start.row;Ha=Ha.lineStrings.slice(pa.start.row,pa.end.row+1);Ha=Ha.some(function(ac){return!!ac.trim()})?hd.arr.dropWhile(Ha,function(ac){return ac.trim()?!1:++Va&&!0}):Ha;var gb=Ha.every(function(ac){return ac.trim()&&ac.match(R)});ua.undoManager.group();if(gb)Ha.forEach(function(ac,Ec){if(ac=ac.match(R)){ac=$jscomp.makeIterator(ac);ac.next();var Mc=ac.next().value,xc=ac.next().value;ac.next();ua.deleteText({start:{row:Va+Ec,column:Mc.length},end:{row:Va+Ec,column:Mc.length+xc.length}})}});
else{var ec=Ha.reduce(function(ac,Ec,Mc){return Ec.trim()||pa.isEmpty()&&pa.start.row===pa.end.row?Math.min(ac,Ec.match(/^\s*/)[0].length):ac},Infinity);ec=Infinity===ec?0:ec;Ha.forEach(function(ac,Ec){ac=$jscomp.makeIterator(ac.match(/^(\s*)(.*)/));ac.next();ac.next();ac.next();ua.insertText(pb+" ",{row:Va+Ec,column:ec})})}ua.undoManager.group();return!0}},{name:"toggle block comment",exec:function(ua){var Ha=ua.pluginInvokeFirst("getComment");if(!Ha)return!0;if(!Ha.blockCommentStart)return Ha.lineCommentStart?
ua.execCommand("toggle comment"):!0;if(!Ha||!Ha.blockCommentStart)return!0;var pb=Ha.blockCommentStart;Ha=Ha.blockCommentEnd;var R=new RegExp("^"+pb.replace(/\*/g,"\\*")),pa=new RegExp(Ha.replace(/\*/g,"\\*")+"$"),Va=ua.tokenAt(ua.cursorPosition);if(Va&&"comment"===Va.token){var gb=ua.textInRange(Va);if(gb.match(R)&&gb.match(pa))return ua.undoManager.group(),ua.replace(Va,gb.slice(pb.length,-Ha.length)),ua.undoManager.group(),!0}ua.undoManager.group();ua.insertText(pb,ua.selection.start);ua.insertText(Ha,
ua.selection.end);ua.undoManager.group();pb=!ua.selection.isEmpty();ua.selection.growLeft(Ha.length);pb||ua.selection.collapse();return!0}},{name:"comment box",exec:function(ua,Ha,pb){Ha=ua.undoManager.ensureNewGroup(ua,"comment box");if(ua.selection.isEmpty())return ua.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),ua.execCommand("toggle comment"),ua.undoManager.group(Ha),!0;var R=ua.selection.range,pa=ua.withSelectedLinesDo(function(gb){return gb}),Va=hd.arr.min([R.start.column].concat(hd.chain(pa).map(function(gb){return gb.match(/^\s*/)}).flatten().compact().pluck("length").value()));
pa=hd.arr.max(pa.map(function(gb){return gb.length}))-Va;pa=Array(Math.ceil(pa/2)+1).join("-=")+"-";ua.execCommand("toggle comment");ua.collapseSelection();ua.cursorPosition={row:R.start.row,column:0};pb?ua.insertText(hd.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",Va)):ua.insertText(hd.string.indent(pa+"\n"," ",Va));ua.selection.goUp();ua.execCommand("toggle comment");ua.cursorPosition={row:R.end.row+2,column:0};ua.insertText(hd.string.indent(pa+"\n"," ",Va));ua.selection.goUp();
ua.execCommand("toggle comment");ua.selection.range={start:{row:R.start.row,column:0},end:ua.cursorPosition};ua.undoManager.group(Ha);return!0},multiSelectAction:"forEach",handlesCount:!0}];hd.commands=yd;hd.commands=yd;hd.commands=yd;var Jc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");Jc.printSymbol=function(ua){if(Symbol.keyFor(ua))return'Symbol.for("'+Symbol.keyFor(ua)+'")';if(Jc.knownSymbols.get(ua))return Jc.knownSymbols.get(ua);String(ua).match(Jc.symMatcher);return String(ua)};
Jc.defaultSort=function(ua,Ha){if(ua.hasOwnProperty("priority")||Ha.hasOwnProperty("priority")){var pb=ua.priority||0,R=Ha.priority||0;if(pb<R)return-1;if(pb>R)return 1}ua=(ua.keyString||ua.key).toLowerCase();Ha=(Ha.keyString||Ha.key).toLowerCase();return ua<Ha?-1:ua===Ha?0:1};Jc.safeToString=Rc;Jc.propertyNamesOf=function(ua,Ha){if(!ua)return[];if(Array.isArray(ua)){var pb=Ha?Ha.offset:0;return Jc.arr.range(pb,pb+(Ha?Ha.partitionSize:ua.length-1))}return Jc.arr.sortBy(Object.keys(ua),function(R){return R.toLowerCase()})};
Jc.isMultiValue=qd;Jc.printValue=Xd;Jc.partitionedChildren=function(ua,Ha){var pb=void 0===Ha?{}:Ha;Ha=void 0===pb.originalValue?ua:pb.originalValue;var R=void 0===pb.offset?0:pb.offset;pb=void 0===pb.partitionSize?ua.length||Object.values(ua).length:pb.partitionSize;if(Jc.obj.isArray(ua)){ua=Jc.num.roundTo(Math.max(Jc.MIN_PARTITION_SIZE,pb/50),.1);pb/=ua;for(var pa=[],Va=0;Va<pb;Va++){var gb="["+(R+Va*ua)+"-"+(R+(Va+1)*ua)+"]";pa.push({partition:{originalValue:Ha,offset:R+Va*ua,partitionSize:ua},
value:[],key:gb,keyString:gb,valueString:"...",isCollapsed:!0})}return pa}ua=Jc.num.roundTo(Math.max(Jc.MIN_PARTITION_SIZE,pb/50),.1);pb/=ua;pa=[];Va=Jc.obj.keys(Ha).sort();for(gb=0;gb<pb;gb++){var ec=R+gb*ua,ac=R+(gb+1)*ua,Ec=Jc.obj.select(Ha,Va.slice(ec,ac));ec="["+Va[ec].slice(0,4)+"-"+(Va[ac]||Jc.arr.last(Va)).slice(0,4)+"]";pa.push({partition:{originalValue:Ec,offset:R+gb*ua,partitionSize:ua},value:[],key:ec,keyString:ec,valueString:"...",isCollapsed:!0})}return pa};Jc.propertiesOf=function(ua){var Ha=
ua.partition?ua.target:ua.value;if(!Ha)return[];var pb={_rev:!0},R=[],pa="function"===typeof Ha.livelyCustomInspect?Ha.livelyCustomInspect():{},Va=Object.assign({},Jc.defaultPropertyOptions,{},pa);if(pa.properties){pa=$jscomp.makeIterator(pa.properties);for(var gb=pa.next();!gb.done;gb=pa.next()){var ec=gb.value;gb=ec.key;var ac=ec.hidden,Ec=ec.priority,Mc=ec.keyString,xc=ec.value;ec=ec.valueString;pb[gb]=!0;ac||R.push(ua.getSubNode({priority:Ec,key:gb,keyString:Mc||Jc.safeToString(gb),value:xc,valueString:ec,
isCollapsed:!0}))}}if(Va.includeDefault){pa=Jc.propertyNamesOf(Ha,ua.partition);if(pa.length>Jc.MAX_NODE_THRESHOLD)for(pb=$jscomp.makeIterator(Jc.partitionedChildren(Ha,ua.partition)),pa=pb.next();!pa.done;pa=pb.next())R.push(ua.getSubNode(pa.value));else for(ac=$jscomp.makeIterator(pa),pa=ac.next();!pa.done;pa=ac.next())Ec=pa.value,Ec in pb||(pa=Ha[Ec],gb=Jc.printValue(pa),pa={keyString:Ec,key:Ec,value:pa,valueString:gb,isCollapsed:!0},R.push(ua.getSubNode(pa)));if(Va.includeSymbols)for(pb=$jscomp.makeIterator(Object.getOwnPropertySymbols(Ha)),
pa=pb.next();!pa.done;pa=pb.next())ac=pa.value,Ec=Jc.safeToString(ac),pa=Ha[ac],gb=Jc.printValue(pa),pa={key:ac,keyString:Ec,value:pa,valueString:gb,isCollapsed:!0},R.push(ua.getSubNode(pa))}Va.sort&&(R=Va.sortFunction(Ha,R));return R};Jc.obj=ce;Jc.num=pc;Jc.arr=Sb;Jc.string=Gc;Jc.connect=Cc;Jc.signal=ld;Jc.TreeData=Rb;Jc.newUUID=xd;Jc.localInterface=Ia;Jc.MAX_NODE_THRESHOLD=1E3;Jc.MIN_PARTITION_SIZE=250;Jc.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(ua,
Ha){return Array.isArray(ua)?Ha:Ha.sort(Jc.defaultSort)}};Jc.symMatcher=/^Symbol\((.*)\)$/;Jc.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(ua){return"symbol"===typeof Symbol[ua]}).reduce(function(ua,Ha){return ua.set(Symbol[Ha],"Symbol."+Ha)},new Map)}();Jc.isMultiValue=qd;Jc.isMultiValue=qd;Jc.printValue=Xd;Jc.printValue=Xd;var Fd=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=Ha.hasOwnProperty("InspectionTree")&&
"function"===typeof Ha.InspectionTree?Ha.InspectionTree:Ha.InspectionTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R){mb._get(Object.getPrototypeOf(pb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);this.inspector=R.inspector;this.root.isInspectionNode||(this.root=Jc.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",
get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(R){R=void 0===R?!0:R;return mb._get(Object.getPrototypeOf(pb.prototype),"asListWithIndexAndDepth",this).call(this,function(pa){pa=pa.node;return R?pa.visible:!0})}},{key:"getContextFor",value:function(R){return R==this.root?this.root.value.inspectee:R.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(R){var pa=void 0===R.maxDepth?1:R.maxDepth,Va=R.iterator,gb=R.showUnknown,ec=R.showInternal,ac=this;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress)return Ec.yield(ac.uncollapseAll(function(Mc,xc){return pa>xc&&(Mc==ac.root||Mc.value.submorphs)}),2);ac.asListWithIndexAndDepth(!1).forEach(function(Mc){var xc=Mc.node;return 0==Mc.depth?xc.visible=!0:!gb&&xc.keyString&&xc.keyString.includes("UNKNOWN PROPERTY")||!ec&&xc.keyString&&xc.keyString.includes("internal")?xc.visible=!1:xc.value&&xc.value.submorphs?xc.visible=!0:xc.visible=Va(xc)});Ec.jumpToEnd()})}},{key:"getChildren",
value:function(R){return R.children}},{key:"display",value:function(R){return R.display(this.inspector)}},{key:"isCollapsed",value:function(R){return R.isCollapsed}},{key:"isLeaf",value:function(R){return Jc.obj.isPrimitive(R.value)}},{key:"collapse",value:function(R,pa){var Va=this;R.isCollapsed=pa;pa||this.isLeaf(R)||R.children.length||(R.children=Jc.propertiesOf(R).map(function(gb){Va.parentMap.set(gb,R);return gb}))}},{key:"retrieveForRemoteProxy",value:function(R){R.uuid||(R.uuid=Jc.newUUID(),
this.idToNodeMap[R.uuid]=R);return{uuid:R.uuid,value:this.isLeaf(R)?R.value:{},keyString:R.keyString,key:R.keyString,valueString:Jc.safeToString(R.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return Jc.localInterface}},{key:"getNodeViaId",value:function(R){return this.idToNodeMap[R]}},{key:"asRemoteDelegate",value:function(R){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext=
{});System.get("@lively-env").remoteInspectionContext[R]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionTree"}},{key:"forObject",value:function(R,pa){return new this({key:"inspectee",value:{inspectee:R},isCollapsed:!0,inspector:pa})}}],Ha,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5969,end:8683})}(Jc.TreeData);Jc.InspectionTree=Fd;Jc.InspectionTree=Fd;Jc.InspectionTree=Fd;var Yd=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=Ha.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Ha.RemoteInspectionTree?Ha.RemoteInspectionTree:Ha.RemoteInspectionTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return mb(pb,ua,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(R){this.parentMap=new WeakMap;this.root=R.proxy;this.evalEnvironment=R.evalEnvironment;this.inspector=R.inspector;this.delegateId=R.delegateId}},{key:"getContextFor",value:function(R){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+R.uuid+'").value'}},{key:"dispose",value:function(){var R=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pa){return pa.yield(R.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+R.delegateId+"']\n    ",R.evalEnvironment),0)})}},{key:"display",value:function(R){return R.keyString+": "+R.valueString}},{key:"collapse",value:function(R,pa){var Va=this,gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ec){if(1==ec.nextAddress)return(R.isCollapsed=pa)||Va.isLeaf(R)?ec.return():
R.children.length?ec.jumpTo(0):ec.yield(Va.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+R.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Va.delegateId+'"]'}),3);gb=ec.yieldResult;R.children=gb.isError?[]:gb.value;
ec.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(R,pa){var Va=this,gb,ec,ac,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){if(1==Mc.nextAddress)return Mc.yield(Va.createRemoteContext(R,pa),2);gb=Mc.yieldResult;ec=gb.proxy;ac=gb.delegateId;Ec=gb.evalEnvironment;return Mc.return(new Va({key:"inspectee",proxy:ec,delegateId:ac,evalEnvironment:Ec,inspector:pa}))})}},{key:"createRemoteContext",value:function(R,
pa){var Va=R.code,gb=R.evalEnvironment,ec=R.delegateId,ac,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){if(1==Mc.nextAddress)return ec="lively://inspector-"+pa.id,Mc.yield(gb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+Va+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+ec+'");\n    ',gb),2);ac=Mc.yieldResult;Ec=ac.value;return Mc.return({delegateId:ec,
evalEnvironment:gb,proxy:Ec})})}}],Ha,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8692,end:11045})}(Jc.InspectionTree);Jc.RemoteInspectionTree=Yd;Jc.RemoteInspectionTree=Yd;Jc.RemoteInspectionTree=Yd;(function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
pb=Ha.hasOwnProperty("InspectionNode")&&"function"===typeof Ha.InspectionNode?Ha.InspectionNode:Ha.InspectionNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R){var pa=R.root,Va=R.priority,gb=R.key,ec=R.keyString,ac=R.value,Ec=R.valueString,Mc=R.isCollapsed,xc=void 0===R.children?[]:R.children,ze=void 0===R.isSelected?!1:R.isSelected,nf=
void 0===R.visible?!0:R.visible;this.partition=R.partition;this.priority=Va;this.key=gb;this.keyString=String(ec||gb);this.value=ac;this.valueString=Ec||Jc.printValue(ac);this.isCollapsed=Mc;this.children=xc;this.isSelected=ze;this.visible=nf;this.root=pa}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",get:function(){return!0}},{key:"getSubNode",value:function(R){if(R.value&&R.value.isMorph)return new Jc.MorphNode(Object.assign({root:this.root},R));var pa=R.key,Va=R.keyString,
gb=this.value,ec=R.partition;ec&&(gb=ec.originalValue,Va=pa);return new Jc.PropertyNode(Object.assign({},R,{keyString:Va,key:pa,target:gb,partition:ec,root:this.root,spec:{}}))}},{key:"display",value:function(R){var pa=this.keyString,Va=this.valueString;if(!this.interactive)return pa+": "+Va;this._propertyWidget||(this._propertyWidget=R.renderDraggableTreeLabel({value:pa+": "+Va}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionNode"}},{key:"for",value:function(R,pa){pa=void 0===pa?null:pa;return R.value&&R.value.isMorph?new Jc.MorphNode(Object.assign({root:pa},R)):new Jc.InspectionNode(Object.assign({root:pa},R))}}],Ha,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11047,
end:13612})})(void 0);(function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=Ha.hasOwnProperty("MorphNode")&&"function"===typeof Ha.MorphNode?Ha.MorphNode:Ha.MorphNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R){mb._get(Object.getPrototypeOf(pb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,R);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(R){var pa=this.propertyInfo[R.key]||{};return R.value&&R.value.isMorph?new Jc.MorphNode(Object.assign({},R,{root:this.root})):new Jc.PropertyNode(Object.assign({},R,{root:this.root,target:this.target,spec:pa}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],Ha,{pathInPackage:function(){return"js/inspector/context.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13614,end:14763})})(Jc.InspectionNode);(function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=Ha.hasOwnProperty("PropertyNode")&&"function"===typeof Ha.PropertyNode?Ha.PropertyNode:Ha.PropertyNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R){mb._get(Object.getPrototypeOf(pb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);var pa=R.spec,Va=R.target;this.partition=R.partition;this.target=Va;this.spec=pa;this.foldedNodes={}}},{key:"__deserialize__",value:function(R,pa){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(R){this._interactive=
R}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(R){return this.isFoldable?this.getFoldedContext(R):mb._get(Object.getPrototypeOf(pb.prototype),"getSubNode",this).call(this,R)}},{key:"getFoldedContext",value:function(R){return this.foldedNodes[R.key]=new Jc.FoldedNode(Object.assign({},R,{root:this.root,target:this.target,foldableNode:this,spec:Jc.obj.dissoc(this.spec,
["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(R,pa){(pa=void 0===pa?!1:pa)&&(this.target[this.key]=R);this.value=this.target[this.key];this.valueString=Jc.printValue(this.value);this.interactive&&(pa||this._propertyWidget.highlight());if(this.isFoldable)for(var Va in this.foldedNodes)this.foldedNodes[Va].value=this.value[Va],this.foldedNodes[Va].valueString=Jc.printValue(this.value[Va]),this.foldedNodes[Va]._propertyWidget&&
Jc.signal(this.foldedNodes[Va]._propertyWidget,"update",this.value[Va])}},{key:"display",value:function(R){var pa=this,Va=this._propertyWidget,gb=this.keyString,ec=this.valueString,ac=this.target,Ec=this.value,Mc=this.spec;if(!(this.interactive||Mc.foldable&&Jc.isMultiValue(Ec,Mc.foldable)))return R.renderPropertyControl({target:ac,keyString:gb,valueString:ec,tree:R.ui.propertyTree,value:Ec,spec:Mc,node:this,fastRender:!0});if(Va)return Va.keyString=gb,Va.valueString=ec,Va.isSelected=this.isSelected,
Va.control&&(Va.control.isSelected=this.isSelected),Va;Va=this._propertyWidget=R.renderPropertyControl({target:ac,keyString:gb,valueString:ec,value:Ec,spec:Mc,node:this,isSelected:this.isSelected,fontColor:R.ui.propertyTree.fontColor});this.isInternalProperty||Mc.readOnly||(Jc.connect(Va,"propertyValue",this,"refreshProperty",{updater:function(xc,ze){return xc(ze,!0)}}),Jc.connect(Va,"openWidget",this.root,"onWidgetOpened",{converter:function(xc){return{widget:xc,node:pa.sourceObj}}}));return Va}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Ha,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14765,end:18244})})(Jc.InspectionNode);(function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),pb=Ha.hasOwnProperty("FoldedNode")&&
"function"===typeof Ha.FoldedNode?Ha.FoldedNode:Ha.FoldedNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(R){mb._get(Object.getPrototypeOf(pb.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);this.foldableNode=R=R.foldableNode;this.foldedProp=R.key+Jc.string.capitalize(this.key)}},{key:"refreshProperty",value:function(R,
pa){pa=void 0===pa?!1:pa;var Va={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Va[this.key]=R,Va)),pa)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Ha,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18246,
end:18928})})(Jc.PropertyNode);var ie=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");ie.Color=cb;var ue=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),pb=Ha.hasOwnProperty("DarkTheme")&&"function"===typeof Ha.DarkTheme?Ha.DarkTheme:Ha.DarkTheme=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:"background",get:function(){return ie.Color.rgb(44,62,
80)}},{key:"cursorColor",get:function(){return ie.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},
{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:ie.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:ie.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:ie.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},
{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},
{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:ie.Color.white,fontWeight:"bold",backgroundColor:ie.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:ie.Color.rgba(204,
204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:ie.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ha,{pathInPackage:function(){return"themes/dark.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3009})}(void 0),Ye=ue=ie.DarkTheme;ie.default=ue;var Db=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");Db.inspect=hc;Db.remoteInspect=Id;Db.generateReferenceExpression=Pc;Db.onNumberDragStart=function(ua,Ha){Ha.initPos=ua.position;Ha.factorLabel=(new Db.Tooltip({description:"1x"})).openInWorld(ua.hand.position.addXY(10,
10))};Db.onNumberDrag=function(ua,Ha){var pb=Db.getScaleAndOffset(ua,Ha),R=pb.scale;pb=pb.offset;Ha.factorLabel.position=ua.hand.position.addXY(10,10);Ha.factorLabel.description=R+"x";return Db.getCurrentValue(pb,R,Ha)};Db.onNumberDragEnd=function(ua,Ha){var pb=Db.getScaleAndOffset(ua,Ha);ua=pb.offset;pb=pb.scale;Ha.factorLabel.softRemove();return Db.getCurrentValue(ua,pb,Ha)};Db.getScaleAndOffset=function(ua,Ha){var pb=ua.position.subPt(Ha.initPos);ua=pb.x;Ha=Db.num.roundTo(Math.exp(-pb.y/$world.height*
6),.01)*Ha.baseFactor;return{offset:ua,scale:Ha}};Db.getCurrentValue=function(ua,Ha,pb){return Math.max(pb.min,Math.min(pb.max,pb.scrubbedValue+(pb.floatingPoint?ua*Ha:Math.round(ua*Ha))))};Db.Color=cb;Db.Rectangle=Jb;Db.rect=Hd;Db.pt=sd;Db.obj=ce;Db.num=pc;Db.Path=Dc;Db.arr=Sb;Db.promise=bc;Db.connect=Cc;Db.disconnect=Ib;Db.once=Qb;Db.Morph=gc;Db.Tooltip=sc;Db.VerticalLayout=dd;Db.GridLayout=bd;Db.HorizontalLayout=oc;Db.morph=vc;Db.CustomLayout=$a;Db.Label=fb;Db.Icon=ya;Db.StyleSheet=wc;Db.config=
Ca;Db.Tree=Aa;Db.LoadingIndicator=xa;Db.DropDownList=Oa;Db.DropDownSelector=wb;Db.SearchField=dc;Db.LabeledCheckBox=Ya;Db.MorphHighlighter=U;Db.InteractiveMorphSelector=va;Db.printValue=Xd;Db.RemoteInspectionTree=Yd;Db.InspectionTree=Fd;Db.isMultiValue=qd;Db.valueWidgets=M;Db.popovers=da;Db.DarkTheme=Ye;Db.DefaultTheme=Ja;Db.syncEval=jb;Db.inspectorCommands=[{name:"focus codeEditor",exec:function(ua){ua.get("codeEditor").show();ua.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(ua){ua.get("propertyTree").show();
ua.get("propertyTree").focus();return!0}}];(function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=Ha.hasOwnProperty("DraggedProp")&&"function"===typeof Ha.DraggedProp?Ha.DraggedProp:Ha.DraggedProp=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:"applyToTarget",value:function(R){var pa=this.currentTarget,Va=this.control;this.remove();Db.MorphHighlighter.removeHighlighters(R.world);
if(pa)if(pa.isText&&"js"===pa.editorModeName){var gb=pa.evalEnvironment.context;R=pa.textPositionFromPoint(pa.localize(R.position));gb=Db.generateReferenceExpression(this.sourceObject,{fromMorph:gb});Va.keyString&&(gb+="."+Va.keyString);pa.insertTextAndSelect(gb,R);pa.focus()}else"propertyValue"in Va&&(pa[Va.keyString]=Va.propertyValue)}},{key:"update",value:function(R){R=R.hand.globalPosition;var pa=this.morphBeneath(R);if(pa){for(pa==this.morphHighlighter&&(pa=pa.morphBeneath(R));[pa].concat($jscomp.arrayFromIterable(pa.ownerChain())).find(function(Va){return!Va.visible});)pa=
pa.morphBeneath(R);if(pa!=this.currentTarget){this.currentTarget=pa;this.morphHighlighter&&this.morphHighlighter.deactivate();if(pa.isWorld)return;this.morphHighlighter=Db.MorphHighlighter.for($world,pa);this.morphHighlighter.show()}this.position=R}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:Db.Color.rgb(169,204,227)},fill:{defaultValue:Db.Color.rgb(235,245,251).withA(.8)},
borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var R=this.control;if(!R)return this.submorphs=[];this.height=22;this.submorphs=[R];R.top=0;R.fontSize=14;"function"===typeof R.relayout&&R.relayout();this.width=R.width+20;this.adjustOrigin(Db.pt(10,10))}}}}}],Ha,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1272,end:3714})})(Db.Morph);(function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=Ha.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Ha.DraggableTreeLabel?Ha.DraggableTreeLabel:Ha.DraggableTreeLabel=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:"inspector",get:function(){return this.owner.owner}},
{key:"onDragStart",value:function(R){this.draggedProp=new Db.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();Db.connect(R.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(R){}},{key:"onDragEnd",value:function(R){Db.disconnect(R.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(R)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},
draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:Db.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:Db.Color.transparent},padding:{defaultValue:Db.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(R){this.setProperty("isSelected",R);R?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=
R)}}}}}],Ha,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3716,end:5055})})(Db.Label);Fd=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=Ha.hasOwnProperty("PropertyControl")&&"function"===typeof Ha.PropertyControl?Ha.PropertyControl:Ha.PropertyControl=
function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(R,pa,Va){R.control=new Db.DropDownSelector({opacity:.8,fill:Db.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:pa,padding:0,values:Va});Db.connect(R.control,"update",R,"propertyValue",{updater:function(gb,ec){this.targetObj.propertyValue!=
ec&&gb(ec)}});Db.connect(R,"update",R.control,"selectedValue",{updater:function(gb,ec){ec=ec&&ec.valueOf?ec.valueOf():ec;this.targetObj.propertyValue!=ec&&gb(ec)}});return R}},{key:"toggleMultiValuePlaceholder",value:function(R){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:Db.Color.transparent,layout:new Db.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:Db.arr.range(0,2).map(function(pa){return{type:"ellipse",fill:Db.Color.gray.withA(.5),
reactsToPointer:!1,extent:Db.pt(7,7)}})});R?(Db.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(Db.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(R){this.foldableProperties&&this.toggleMultiValuePlaceholder(Db.isMultiValue(R,
this.foldableProperties))}},{key:"asFoldable",value:function(R){this.foldableProperties=R;Db.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+
": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var R=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});R.isLayoutable=!1;R.fontWeight="bold";R.fontColor=Db.Color.orange;R.reactsToPointer=!1;R.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],
derived:!0,get:function(){return this.submorphs[0]||!1},set:function(R){this.submorphs=[R]}},layout:{initialize:function(){this.layout=new Db.CustomLayout({relayout:function(R){R.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(R){return(R=R.value)&&(R.isColor||R.isGradient)?"Color":R&&R.isPoint?"Point":Db.obj.isBoolean(R)?"Boolean":Db.obj.isNumber(R)?"Number":Db.obj.isString(R)?"String":R&&R.isRectangle?"Rectangle":
!1}},{key:"render",value:function(R){R.spec.type||(R.spec=Object.assign({},R.spec,{isFloat:!Number.isInteger(R.value),type:this.inferType(R)}));switch(R.spec.type){case "Color":var pa=this.renderColorControl(R);break;case "ColorGradient":pa=this.renderColorControl(Object.assign({},R,{gradientEnabled:!0}));break;case "Number":pa=this.renderNumberControl(R);break;case "String":pa=this.renderStringControl(R);break;case "RichText":pa=this.renderStringControl(R);break;case "Layout":pa=this.renderLayoutControl(R);
break;case "Enum":pa=this.renderEnumControl(R);break;case "Shadow":pa=this.renderShadowControl(R);break;case "Point":pa=this.renderPointControl(R);break;case "Rectangle":pa=this.renderRectangleControl(R);break;case "Boolean":pa=this.renderBooleanControl(R);break;default:pa=this.renderItSomehow(R)}pa.control&&(Db.connect(pa.control,"openWidget",pa,"openWidget"),pa.toggleFoldableValue(R.value));return pa}},{key:"baseControl",value:function(R){var pa=R.spec;R=new this({keyString:R.keyString,valueString:R.valueString,
isSelected:!1,propertyValue:R.value});pa.foldable&&R.asFoldable(pa.foldable);return R}},{key:"renderGrabbableKey",value:function(R){var pa=this,Va=R.target;return[R.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(gb){gb.state.draggedProp=new Db.DraggedProp({sourceObject:Va,control:pa.baseControl(R)});gb.state.draggedProp.openInWorld();Db.connect(gb.hand,"update",gb.state.draggedProp,"update")},onDrag:function(gb){},onDragEnd:function(gb){Db.disconnect(gb.hand,"update",gb.state.draggedProp,
"update");gb.state.draggedProp.applyToTarget(gb)}}]}},{key:"renderEnumControl",value:function(R){var pa=R.value,Va=R.spec.values,gb=R.keyString,ec=R.target,ac=R.node,Ec=function(Mc,xc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ze){ec.world().openWorldMenu(Mc,Va.map(function(nf){return{string:nf.toString(),action:function(){ec[gb]=nf;ac.rerender()}}}));ze.jumpToEnd()})};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(pa?pa.valueOf?pa.valueOf():pa:"Not set"),
{nativeCursor:"pointer",onMouseDown:Ec}],$jscomp.arrayFromIterable(Db.Icon.textAttribute("angle-down",{paddingTop:"4px",paddingLeft:"4px",opacity:.7,onMouseDown:Ec})))}},{key:"renderStringControl",value:function(R){var pa=R.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(200<pa.length?pa.slice(0,20)+"...":pa),{fontColor:Db.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(R){var pa=R.value,Va=R.keyString,gb=R.valueString,ec=R.target,ac=
R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+gb,{fontColor:Db.Color.black,nativeCursor:"pointer",onMouseDown:function(Ec){var Mc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){if(1==xc.nextAddress)return Mc=new Db.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:pa}),Mc.relayout(),xc.yield(Mc.fadeIntoWorld(Ec.positionIn(ec.world())),2);Db.connect(Mc,"rectangle",function(ze){ec[Va]=ze;ac.rerender()});xc.jumpToEnd()})}}])}},{key:"renderBooleanControl",
value:function(R){var pa=R.value,Va=R.keyString,gb=R.valueString,ec=R.target,ac=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+gb,{nativeCursor:"pointer",fontColor:pa?Db.Color.green:Db.Color.red,onMouseDown:function(Ec){ec[Va]=!ec[Va];ac.rerender()}}])}},{key:"renderNumberControl",value:function(R){var pa=R.value,Va=R.spec,gb=R.keyString,ec=R.valueString,ac=R.node,Ec=R.target,Mc=R.tree,xc=void 0===ac._numberControls?new Lf:ac._numberControls,ze=$jscomp.makeIterator(xc.submorphs),
nf=ze.next().value,bf=ze.next().value;xc.fontColor=Mc.fontColor;var Bg=ac._numberControls=xc;"max"in Va&&"min"in Va&&-Infinity!=Va.min&&Infinity!=Va.max?(Bg.baseFactor=(Va.max-Va.min)/100,Bg.floatingPoint=Va.isFloat,Bg.max=Va.max,Bg.min=Va.min):(Bg.floatingPoint=Va.isFloat,Bg.baseFactor=.5,Bg.min=void 0!=Va.min?Va.min:-Infinity,Bg.max=void 0!=Va.max?Va.max:Infinity);var Me=Db.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),
$jscomp.arrayFromIterable(ac._inputMorph?[ac._inputMorph,{}]:[" "+(void 0!=pa&&(pa.valueOf?pa.valueOf():pa).toFixed(Va.isFloat?Math.max(4,Db.num.precision(pa)):0))+" ",{fontColor:Me,onMouseUp:function(sg){ac._inputMorph=Db.morph({type:"input",fill:null,fontColor:Me,fontFamily:"IBM Plex Mono",fontSize:14,padding:Db.rect(8,2,-6,2),height:23,cursorColor:Db.Color.white,value:pa.valueOf?pa.valueOf():ec});Ec[gb]=pa;ac._inputMorph.focus();Db.once(ac._inputMorph,"inputAccepted",function(Gi){delete ac._inputMorph;
Ec[gb]=Va.isFloat?Number.parseFloat(Gi):Number.parseInt(Gi);ac.rerender()});Db.once(ac._inputMorph,"onBlur",function(Gi){ac._inputMorph&&(delete ac._inputMorph,Ec[gb]=pa,ac.rerender())});ac.rerender()},onDragStart:function(sg){Bg.scrubbedValue=pa;Db.onNumberDragStart(sg,Bg)},onDrag:function(sg){Ec[gb]=Db.onNumberDrag(sg,Bg);ac.rerender()},onDragEnd:function(sg){return Db.onNumberDragEnd(sg,Bg)}},xc,{onMouseUp:function(){nf.fill=bf.fill=null},onMouseDown:function(sg){if(sg.targetMorph===nf){nf.fill=
Db.Color.white.withA(.2);if("max"in Va&&Ec[gb]>=Va.max)return;Ec[gb]+=1}if(sg.targetMorph===bf){bf.fill=Db.Color.white.withA(.2);if("min"in Va&&Ec[gb]<=Va.min)return;--Ec[gb]}ac.rerender()}}]))}},{key:"renderShadowControl",value:function(R){var pa=R.keyString,Va=R.value,gb=R.target,ec=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[""+(Va?Va.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function(ac){var Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){if(1==
Mc.nextAddress)return Ec=new Db.popovers.ShadowPopover({shadowValue:gb[pa],hasFixedPosition:!0}),Mc.yield(Ec.fadeIntoWorld(ac.positionIn(gb.world())),2);Db.connect(Ec,"shadowValue",function(xc){gb[pa]=xc;ec.rerender()});Mc.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(R){var pa=R.keyString,Va=R.value,gb=R.target,ec=R.node,ac=Db.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Ec={nativeCursor:"pointer",onMouseDown:function(Mc){var xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ze){if(1==
ze.nextAddress)return xc=new Db.popovers.PointPopover({pointValue:gb[pa],hasFixedPosition:!0}),ze.yield(xc.fadeIntoWorld(Mc.positionIn(gb.world())),2);Db.connect(xc,"pointValue",function(nf){gb[pa]=nf;ec.rerender()});ze.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" pt(",Object.assign({},Ec),""+Va.x.toFixed(),Object.assign({fontColor:ac},Ec),",",Object.assign({},Ec),""+Va.y.toFixed(),Object.assign({fontColor:ac},Ec),")",Object.assign({},Ec)])}},{key:"renderLayoutControl",
value:function(R){var pa=R.valueString,Va=R.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(Va?pa:"No Layout"),{onMouseDown:function(gb){}}])}},{key:"renderColorControl",value:function(R){var pa=R.node,Va=R.gradientEnabled,gb=R.valueString,ec=R.keyString,ac=R.value,Ec=R.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[Db.morph({fill:ac.valueOf?ac.valueOf():ac,extent:Db.pt(15,15),borderColor:Db.Color.gray,borderWidth:1}),{paddingLeft:"5px",
paddingTop:"4px",paddingRight:"5px"},""+(ac?ac.valueOf?ac.valueOf():gb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Mc){var xc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ze){if(1==ze.nextAddress)return xc=new Db.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Ec,fillValue:ac,title:"Fill Control",gradientEnabled:Va}),ze.yield(xc.fadeIntoWorld(Mc.positionIn(Ec.world())),2);Db.connect(xc,"fillValue",function(nf){Ec[ec]=nf;pa.rerender()});ze.jumpToEnd()})}}])}},{key:"renderItSomehow",
value:function(R){var pa=R.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+pa,{}])}}],Ha,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5064,end:20451})}(Db.DraggableTreeLabel);Db.PropertyControl=Fd;Db.PropertyControl=Fd;Db.PropertyControl=Fd;Db.inspect=
hc;Db.inspect=hc;Db.remoteInspect=Id;Db.remoteInspect=Id;Db.generateReferenceExpression=Pc;Db.generateReferenceExpression=Pc;var Lf=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=Ha.hasOwnProperty("NumberControls")&&"function"===typeof Ha.NumberControls?Ha.NumberControls:Ha.NumberControls=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,void 0,[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=new Db.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:Db.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(R){this.submorphs.map(function(pa){return pa.fontColor=R})}},submorphs:{initialize:function(){this.submorphs=[Db.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:Db.rect(5,2,0,-6),fontSize:12}),Db.Icon.makeLabel("sort-up",
{top:10,rotation:Math.PI,autofit:!0,padding:Db.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",fontSize:12})]}}}}}],Ha,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23124,end:24169})}(Db.Morph);(function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=Ha.hasOwnProperty("PropertyTree")&&
"function"===typeof Ha.PropertyTree?Ha.PropertyTree:Ha.PropertyTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:"onDrag",value:function(R){this._onDragHandler&&this._onDragHandler(R)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Ha,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25334,end:25445})})(Db.Tree);Fd=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),pb=Ha.hasOwnProperty("Inspector")&&"function"===typeof Ha.Inspector?Ha.Inspector:Ha.Inspector=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();
this.openWidget&&this.closeOpenWidget()}},{key:"onMouseMove",value:function(R){}},{key:"__after_deserialize__",value:function(R,pa,Va){var gb=this,ec=new Db.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Db.InspectionTree.forObject(null,this)}));this.addMorph(ec,this.getSubmorphNamed("terminal toggler"));mb._get(Object.getPrototypeOf(pb.prototype),"__after_deserialize__",this).call(this,R,pa,Va);!this.isComponent&&this.master.whenApplied().then(function(){gb.layout.col(0).row(1).group.morph=
ec;gb.targetObject&&(gb.targetObject=gb.targetObject)})}},{key:"__additionally_serialize__",value:function(R,pa,Va,gb){R=R.props.submorphs.value;for(pa=R.length;pa--;)Va.refForId(R[pa].id).realObj==this.ui.propertyTree&&Db.arr.removeAt(R,pa)}},{key:"renderDraggableTreeLabel",value:function(R){return new Db.DraggableTreeLabel(R)}},{key:"renderPropertyControl",value:function(R){return Db.PropertyControl.render(R)}},{key:"onLoad",value:function(){var R=this.ui,pa=R.codeEditor,Va=R.thisBindingSelector,
gb=R.propertyTree;pa.changeEditorMode("js").then(function(){return pa.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Va.selection?pa.owner.selectedContext:pa.owner.targetObject},get systemInterface(){return Db.Path("treeData.systemInterface").get(gb)},format:"esm"}}).catch(function(ec){return $world.logError(ec)})}},{key:Symbol.for("lively-instance-initialize"),value:function(R){mb._get(Object.getPrototypeOf(pb.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,R);R=this.ui;var pa=R.targetPicker,Va=R.propertyTree,gb=R.resizer,ec=R.terminalToggler,ac=R.unknowns,Ec=R.internals,Mc=R.searchField,xc=R.codeEditor,ze=R.fixImportButton,nf=R.thisBindingSelector;xc.changeEditorMode("js").then(function(){return xc.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==nf.selection?xc.owner.selectedContext:xc.owner.targetObject},get systemInterface(){return Va.treeData.systemInterface},format:"esm"}}).catch(function(bf){return $world.logError(bf)});
Db.connect(pa,"onMouseDown",this,"selectTarget");Db.connect(Va,"onScroll",this,"repositionOpenWidget");Db.connect(gb,"onDrag",this,"adjustProportions");Db.connect(ec,"onMouseDown",this,"toggleCodeEditor");Db.connect(ac,"trigger",this,"filterProperties");Db.connect(Ec,"trigger",this,"filterProperties");Db.connect(Mc,"searchInput",this,"filterProperties");Db.connect(Va,"nodeCollapseChanged",this,"filterProperties");Db.connect(this,"extent",this,"relayout");Db.connect(nf,"selection",this,"bindCodeEditorThis");
Db.connect(ze,"fire",xc,"execCommand",{updater:function(bf){return bf("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var R=this.ui.propertyTree.selectedIndex-1,pa=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();pa=this.ui.propertyTree.document.getLine(R).textAndAttributes.slice(0,4).concat(pa.display(this));R=this.ui.propertyTree.lineRange(R,!1);this.ui.propertyTree.replace(R,pa,!1,!1,!1);
this.ui.propertyTree.selectedNode=this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var R=Db.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(R!=this.lastChange||this.lastSubmorphs!=Db.printValue(this.targetObject&&
this.targetObject.submorphs))this.focusedNode&&this.focusedNode.keyString==R.prop&&this.repositionOpenWidget(),this.lastChange=R,this.lastSubmorphs=Db.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var R;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(pa){pa=pa.node;pa.target&&(R=pa.foldableNode?pa.target[pa.foldableNode.key][pa.key]:pa.target[pa.key],!Db.obj.equals(R,
pa.value)&&pa.refreshProperty&&pa.refreshProperty(R))});this.ui.propertyTree.update(!0);this.ui.propertyTree.doNotAcceptDropsForThisAndSubmorphs()}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(R,pa){pa=void 0===pa?!1:pa;var Va=this,gb,ec,ac,Ec,Mc,xc,ze,nf,bf,Bg,Me,sg,Gi,Tg,Zj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(zf){switch(zf.nextAddress){case 1:if(!Va.isUpdating()){zf.jumpTo(2);break}return zf.yield(Va.whenUpdated(),2);case 2:gb=
Db.promise.deferred();ec=gb.promise;ac=!!Va.target;Va.updateInProgress=ec;zf.setCatchFinallyBlocks(4);pa&&(Ec=Db.LoadingIndicator.open("connecting to remote..."));if(!pa){Mc=Db.InspectionTree.forObject(R,Va);zf.jumpTo(6);break}return zf.yield(Db.RemoteInspectionTree.forObject(R,Va),7);case 7:Mc=zf.yieldResult;case 6:return xc=Mc,ze=Va.ui.propertyTree,zf.yield(xc.collapse(xc.root,!1),8);case 8:if(!xc.root.children){zf.jumpTo(9);break}return zf.yield(xc.collapse(xc.root.children[0],!1),9);case 9:if(nf=
Va.originalTreeData&&Va.originalTreeData.diff(xc)){bf=$jscomp.makeIterator(nf);for(Bg=bf.next();!Bg.done;Bg=bf.next())Me=Bg.value,sg=$jscomp.makeIterator(Me),Gi=sg.next().value,Tg=sg.next().value,Gi.refreshProperty(Tg.value);zf.jumpTo(11);break}ze.treeData=xc;return zf.yield(Va.filterProperties(),12);case 12:if(!ze.treeData.root.isCollapsed){zf.jumpTo(13);break}return zf.yield(ze.onNodeCollapseChanged({node:xc.root,isCollapsed:!1}),14);case 14:ze.selectedIndex=1;case 13:return zf.yield(ze.execCommand("uncollapse selected node"),
11);case 11:Va.toggleWindowStyle(ac);Ec&&Ec.remove();zf.leaveTryBlock(5);break;case 4:Zj=zf.enterCatchBlock(),Va.showError(Zj);case 5:Va.startStepping(1E3,"refreshAllProperties"),Va.updateInProgress=null,zf.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(R){R=void 0===R?!0:R;var pa=this,Va,gb,ec,ac,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){if(1==Mc.nextAddress)return Va=300,ac=pa.ui.codeEditor.pluginFind(function(xc){return xc.runEval}),Ec=pa.getWindow(),Mc.yield(ac.runEval("System.get('@system-env').node"),
2);Mc.yieldResult.value?(ec=[].concat($jscomp.arrayFromIterable(Db.arr.without(Ec.styleClasses,"local")),["node"]),gb=Db.DarkTheme.instance):(ec=["local"].concat($jscomp.arrayFromIterable(Ec?Db.arr.without(Ec.styleClasses,"node"):[])),gb=Db.DefaultTheme.instance);ac.theme=gb;R?(Ec&&Ec.animate({duration:Va,styleClasses:ec}),pa.ui.codeEditor.animate({fill:gb.background,duration:Va})):Ec&&(Ec.styleClasses=ec);pa.ui.codeEditor.textString=pa.ui.codeEditor.textString;ac.highlight();Mc.jumpToEnd()})}},{key:"isUpdating",
value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var R=this,pa=Object.assign({type:"text",borderWidth:1,borderColor:Db.Color.gray,lineWrapping:"by-chars"},Db.config.codeEditor.defaultStyle,{textString:""}),Va=Db.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});Db.rect(0,0,this.width,30);var gb=new Db.SearchField({styleClasses:["idle"],
name:"searchField"});Va[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[gb,{type:"button",name:"targetPicker",padding:Db.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:Db.Icon.textAttribute("crosshairs")},new Db.LabeledCheckBox({label:"Internals",name:"internals"}),new Db.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new Db.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:Db.InspectionTree.forObject(null,
this)})),Db.Icon.makeLabel("keyboard",{name:"terminal toggler"}),{name:"resizer"},Object.assign({name:"codeEditor"},pa),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:Db.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Va),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Va),[" selection",null])}]}];
this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=3;this.ui.thisBindingSelector.whenRendered().then(function(){R.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var R=this,pa,Va,gb,ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ac){switch(ac.nextAddress){case 1:if(R.env.eventDispatcher.isKeyPressed("Shift"))return Va=$jscomp,gb=Va.makeIterator,ac.yield($world.execCommand("select morph",{justReturn:!0}),
5);R.toggleSelectionInstructions(!0);return ac.yield(Db.InteractiveMorphSelector.selectMorph(),4);case 4:pa=ac.yieldResult;R.toggleSelectionInstructions(!1);ac.jumpTo(3);break;case 5:ec=gb.call(Va,ac.yieldResult),pa=ec.next().value;case 3:pa&&(R.targetObject=pa),ac.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(R){if(R&&!this.instructionWidget){var pa=Db.morph({type:"label",name:"escapeKey",value:"esc"});pa.whenRendered().then(function(){return pa.fit()});this.instructionWidget=
this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},pa,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(R){R=
R.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;R.epiMorph=!0;this.openWidget=R;Db.once(R,"close",this,"closeOpenWidget");Db.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var R=this.ui.propertyTree,pa=R.textLayout.boundsFor(R,{column:0,row:R.selectedIndex-1});pa=R.worldPoint(Db.pt(pa.x,pa.y+pa.height/2)).addPt(R.scroll.negated());R=R.globalBounds();pa.x=this.globalBounds().center().x;
pa.y<R.top()?pa=R.topCenter():R.bottom()-20<pa.y&&(pa=R.bottomCenter().addXY(0,-20));return pa}},{key:"repositionOpenWidget",value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(R){this.layout.row(1).height+=R.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(R){if(R!==this.isEditorVisible()){var pa=this.extent,
Va=this.layout,gb=this.ui,ec=gb.terminalToggler,ac=gb.codeEditor,Ec=gb.thisBindingSelector;gb=gb.fixImportButton;Va.disable();R?(ec.fontColor=Db.Color.rgbHex("00e0ff"),Va.row(3).height=this.codeEditorHeight||180,Va.row(2).height=5,gb.animate({visible:!0,duration:200}),Ec.animate({visible:!0,duration:200})):(this.codeEditorHeight=Va.row(3).height,ec.fontColor=Db.Color.white,Va.row(3).height=Va.row(2).height=0,gb.animate({visible:!1,duration:200}),Ec.animate({visible:!1,duration:200}));this.extent=
pa;Va.enable({duration:200});this.relayout({duration:200});ac.focus();ac.animate({opacity:R?1:0,duration:200})}}},{key:"toggleCodeEditor",value:function(){var R=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pa){R.makeEditorVisible(!R.isEditorVisible());pa.jumpToEnd()})}},{key:"filterProperties",value:function(){var R=this,pa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return pa=R.ui.searchField,Va=R.ui.propertyTree,R.originalTreeData||
(R.originalTreeData=Va.treeData),Db.disconnect(Va.treeData,"onWidgetOpened",R,"onWidgetOpened"),gb.yield(Va.treeData.filter({maxDepth:2,showUnknown:R.ui.unknowns.checked,showInternal:R.ui.internals.checked,iterator:function(ec){return pa.matches(ec.key)}}),2);Va.update();Db.connect(Va.treeData,"onWidgetOpened",R,"onWidgetOpened");gb.jumpToEnd()})}},{key:"relayout",value:function(R){R=void 0===R?{}:R;var pa=this,Va,gb,ec,ac,Ec,Mc,xc,ze,nf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(bf){pa.layout&&
pa.layout.forceLayout();Va=pa;gb=Va.ui;ec=gb.fixImportButton;ac=gb.terminalToggler;Ec=gb.propertyTree;Mc=gb.thisBindingSelector;xc=Ec.bounds().insetBy(5).bottomLeft();ze=Ec.bounds().insetBy(5).bottomRight();nf=ze.subXY(ec.width+10,0);Mc.width=115;Mc.listMorph.itemHeight=20;R.duration?(ac.animate(Object.assign({bottomLeft:xc},R)),ec.animate(Object.assign({bottomRight:ze},R)),Mc.animate(Object.assign({bottomRight:nf},R))):(ac.bottomLeft=xc,ec.bottomRight=ze,Mc.bottomRight=nf);bf.jumpToEnd()})}},{key:"keybindings",
get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},{keys:"F2",command:"focus codeEditor"}].concat(mb._get(Object.getPrototypeOf(pb.prototype),"keybindings",this))}},{key:"commands",get:function(){return Db.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(R){if(System._testsRunning)return console.log(R.targetObject);
R=new this(R);R.openInWindow().doNotAcceptDropsForThisAndSubmorphs();return R}},{key:"properties",get:function(){return{extent:{defaultValue:Db.pt(400,500)},fill:{defaultValue:Db.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},remoteTarget:{after:["submorphs"],set:function(R){this.setProperty("remoteTarget",R);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(R,!0))}},targetObject:{after:["submorphs"],set:function(R){this._serializableTarget=
R&&R.isMorph?R.id:R;this.setProperty("targetObject",R);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(R))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var R=this.ui.propertyTree,pa=R.treeData;return pa.getContextFor(R.selectedNode||pa.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),
fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},
treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:Db.Color.gray,fontSize:14,fontFamily:Db.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],Ha,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:25462,end:45996})}(Db.Morph);Fd=Db.Inspector;Yd=ta("I",Fd);Db.default=Fd;var me=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");me.Inspector=Yd;me.string=Gc;me.Morph=gc;me.pt=sd;me.Color=cb;Fd=[{name:"doit",doc:"Evaluates the selecte code or the current line and report the result",exec:function(ua,Ha,pb){pb=void 0===pb?1:pb;var R,pa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){switch(gb.nextAddress){case 1:return ua.maybeSelectCommentOrLine(),
gb.setCatchFinallyBlocks(2),Ha=Object.assign({},Ha,{logDoit:!0,inspect:!0,inspectDepth:pb}),gb.yield(ua.doEval(void 0,Ha),4);case 4:R=gb.yieldResult;pa=R.error?R.error:R.isError?R.value:null;gb.leaveTryBlock(3);break;case 2:pa=Va=gb.enterCatchBlock();case 3:return pa?ua.showError(pa):ua.setStatusMessage(me.string.truncate(R.value,1E3)),gb.return(R)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(ua,Ha){var pb,R,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Va){switch(Va.nextAddress){case 1:return Va.setCatchFinallyBlocks(2),
Va.yield(ua.doEval({start:{row:0,column:0},end:ua.documentEndPosition},Object.assign({},Ha,{logDoit:!0})),4);case 4:pb=Va.yieldResult;R=pb.error?pb.error:pb.isError?pb.value:null;Va.leaveTryBlock(3);break;case 2:R=pa=Va.enterCatchBlock();case 3:return R?ua.showError(R):ua.setStatusMessage(String(pb.value)),Va.return(pb)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(ua,Ha){var pb,R,pa,Va,gb,ec,ac,Ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Mc){switch(Mc.nextAddress){case 1:return ua.maybeSelectCommentOrLine(),
Mc.setCatchFinallyBlocks(2),Ha=Object.assign({},Ha,{asString:!1,logDoit:!0}),Mc.yield(ua.doEval(void 0,Ha),4);case 4:pb=Mc.yieldResult;R=pb.error?pb.error:pb.isError?pb.value:null;Mc.leaveTryBlock(3);break;case 2:R=pa=Mc.enterCatchBlock();case 3:ua.selection.collapseToEnd();if(Va=pb.value&&pb.value.isColor)return ua.selection.text=String(pb.value),gb=new me.Morph({fill:me.Color.transparent,extent:me.pt(ua.fontSize+2,ua.fontSize+2),submorphs:[{fill:pb.value,center:me.pt(ua.fontSize+2,ua.fontSize+2).scaleBy(.5)}]}),
ec=ua.selection.start,ac=ec.column,Ec=ec.row,ua.insertText([gb,{}],ua.selection.start),ua.selection.start={column:ac,row:Ec},ua.focus(),Mc.return(pb);ua.insertTextAndSelect(R?String(R)+(R.stack?"\n"+R.stack:""):String(pb.value));ua.focus();return Mc.return(pb)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(ua,Ha){var pb,R,pa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){switch(gb.nextAddress){case 1:ua.maybeSelectCommentOrLine();
R=ua.textInRange(ua.selection);pa=ua.evalEnvironment||{};Va=ua.pluginFind(function(ec){return ec.isEditorPlugin&&"function"===typeof ec.runEval});pa.systemInterface||(pa.systemInterface=Va.systemInterface(Ha));if("local"!==pa.systemInterface.name){gb.jumpTo(2);break}gb.setCatchFinallyBlocks(3);return gb.yield(ua.doEval(void 0,Ha),5);case 5:pb=gb.yieldResult;R=pb.value;gb.leaveTryBlock(2);break;case 3:gb.enterCatchBlock();case 2:return ua.world().execCommand("open object editor",{target:R,evalEnvironment:pa}),
gb.return(pb)}})}},{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(ua,Ha){var pb,R,pa,Va,gb,ec;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ac){switch(ac.nextAddress){case 1:ua.maybeSelectCommentOrLine();pa=ua.textInRange(ua.selection);Va=ua.evalEnvironment||{};gb=ua.pluginFind(function(Ec){return Ec.isEditorPlugin&&"function"===typeof Ec.runEval});Va.systemInterface||(Va.systemInterface=gb.systemInterface(Ha));if("local"!==
Va.systemInterface.name){me.Inspector.openInWindow({remoteTarget:{code:pa,evalEnvironment:Va}});ac.jumpTo(2);break}ac.setCatchFinallyBlocks(3);return ac.yield(ua.doEval(void 0,Ha),5);case 5:pb=ac.yieldResult;R=pb.error?pb.error:pb.isError?pb.value:null;pa=pb.value;ac.leaveTryBlock(4);break;case 3:R=ec=ac.enterCatchBlock();case 4:me.Inspector.openInWindow({targetObject:R||pa});case 2:return ac.return(pb)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(ua,Ha,pb){pb=void 0===pb?1:pb;var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pa){switch(pa.nextAddress){case 1:return ua.maybeSelectCommentOrLine(),pa.setCatchFinallyBlocks(2),Ha=Object.assign({},Ha,{inspect:!0,inspectDepth:pb,logDoit:!0}),pa.yield(ua.doEval(void 0,Ha),4);case 4:R=pa.yieldResult;pa.leaveTryBlock(3);break;case 2:pa.enterCatchBlock();case 3:return ua.selection.collapseToEnd(),ua.insertTextAndSelect(R.value),pa.return(R)}})}}];me.codeEvaluationCommands=
Fd;me.codeEvaluationCommands=Fd;me.codeEvaluationCommands=Fd;var tf=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");tf.changeAttributeInSelectionOrMorph=function(ua,Ha,pb){var R=ua.selection;ua.keepPosAtSameScrollOffsetWhile(function(){R.isEmpty()?ua[Ha]="function"===typeof pb?pb(ua[Ha]):pb:(ua.undoManager.group(),ua.changeStyleProperty(Ha,function(pa){return"function"===typeof pb?pb(pa):pb}),ua.undoManager.group())})};Yd=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(ua){var Ha=ua.fontSize;tf.changeAttributeInSelectionOrMorph(ua,"fontSize",function(pb){pb=pb||Ha;return pb+(18<=pb?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(ua){var Ha=ua.fontSize;tf.changeAttributeInSelectionOrMorph(ua,"fontSize",function(pb){pb=pb||Ha;return pb-(18>=pb?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(ua){var Ha,pb,R,pa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress){Ha=
["serif","sans-serif","monospace"];if(pb=localStorage["lively.morpic/text-change-font-additional-fonts"])pb=JSON.parse(pb),Ha.push.apply(Ha,$jscomp.arrayFromIterable(pb));Ha.map(function(ec){return ec.toLowerCase()}).includes(ua.fontFamily.toLowerCase())||(Ha.push(ua.fontFamily),pb=[].concat($jscomp.arrayFromIterable(pb||[]),[ua.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(pb));return gb.yield($world.editListPrompt("choose font",Ha,{requester:ua,preselect:Ha.indexOf(ua.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}R=gb.yieldResult;pa=$jscomp.makeIterator(R.selections);if(Va=pa.next().value)ua.fontFamily=Va;return gb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(ua,Ha){Ha=void 0===Ha?{}:Ha;var pb,R,pa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress){if(Ha.hasOwnProperty("link"))return gb.jumpTo(2);R=ua.selection;pa=ua.getStyleInRange(R);Va=pa.link;return gb.yield(ua.world().prompt("Set link",
{input:Va||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=gb.nextAddress&&(pb=gb.yieldResult,!pb))return gb.return();ua.undoManager.group();ua.setStyleInRange({link:pb||void 0},R);ua.undoManager.group();gb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(ua,Ha){var pb,R,pa,Va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return pb=ua.selection,R=ua.getStyleInRange(pb),pa=R.doit,gb.yield(ua.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:ua,input:pa?pa.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:ua.evalEnvForDoit(pa||{})}),2);Va=gb.yieldResult;ua.undoManager.group();Va?ua.addTextAttribute({doit:{code:Va},nativeCursor:"pointer",textDecoration:"underline"},pb):ua.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},pb);ua.undoManager.group();gb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(ua,Ha){Ha=void 0===Ha?{}:Ha;ua.undoManager.group();
Ha=!Ha.onlySelection&&ua.selection.isEmpty()?ua.documentRange:ua.selection.range;ua.setStyleInRange(null,Ha);ua.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(ua){var Ha,pb,R,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Va){if(1==Va.nextAddress)return Va.yield(System.import("lively.modules"),2);if(3!=Va.nextAddress)return Ha=Va.yieldResult,pb=Ha.module,Va.yield(pb("lively.ide/text/ui.js").load(),3);R=Va.yieldResult;pa=R.RichTextControl;return Va.return(pa.openFor(ua))})}}];
tf.commands=Yd;tf.commands=Yd;tf.commands=Yd;var he=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");he.guessTextModeName=Jd;he.rangedToken=function(ua,Ha,pb,R,pa){return{start:{row:ua,column:Ha},end:{row:ua,column:pb},token:R,mode:pa}};he.fun=Za;he.arr=Sb;he.connect=Cc;he.disconnect=Ib;he.DefaultTheme=Ja;he.tokenizeDocument=ab;he.modeInfo=Qa;he.visitDocumentTokens=tc;he.getMode=vb;he.completionCommands=H;he.multiSelectCommands=tb;he.navCommands=uc;he.codeCommands=yd;he.codeEvaluationCommands=
Fd;he.richTextCommands=Yd;he.Color=cb;he.Range=pe;he.guessTextModeName=Jd;he.guessTextModeName=Jd;Ja=function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),pb=Ha.hasOwnProperty("EditorPlugin")&&"function"===typeof Ha.EditorPlugin?Ha.EditorPlugin:Ha.EditorPlugin=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
he.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(R){var pa=this;this.textMorph=R;he.connect(R,"textChange",this,"onTextChange");he.connect(R,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return pa.highlight()})}},
{key:"detach",value:function(R){he.disconnect(R,"textChange",this,"onTextChange");he.disconnect(R,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(R){this._ast=null;if(R){var pa=this._tokenizerValidBefore;if("replace"===R.selector){var Va=R.args[0].start;R=Va.row;Va=Va.column}else Va=R=0;if(!pa||R<pa.row||R===pa.row&&Va<pa.column)R=Math.max(0,R),this._tokenizerValidBefore={row:R,column:Va}}this.requestHighlight()}},
{key:"requestHighlight",value:function(R){var pa=this;(void 0===R?0:R)?this.highlight():he.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return pa.highlight()})()}},{key:"highlight",value:function(){var R=this.textMorph,pa=this.theme,Va=this.mode,gb=this._tokenizerValidBefore;if(pa&&R&&R.document&&Va){R.fill=pa.background;R.cursorColor=pa.cursorColor||he.Color.black;var ec=R.viewState,ac={};gb=he.tokenizeDocument(Va,R.document,ec.firstVisibleRow,ec.lastVisibleRow,gb);Va=gb.lines;gb=
gb.tokens;if(Va.length){ec=Va[0].row;for(var Ec=[],Mc=0;Mc<gb.length;ec++,Mc++)for(var xc=gb[Mc],ze=0;ze<xc.length;ze+=5){var nf=xc[ze],bf=xc[ze+1],Bg=pa[xc[ze+2]]||pa.default;Bg&&Ec.push({start:{row:ec,column:nf},end:{row:ec,column:bf}},Bg)}R.embeddedMorphs.forEach(function(Me){var sg=R.embeddedMorphMap.get(Me).anchor;ac[Me.id]=R.textAttributeAt(sg.position)});R.setTextAttributesWithSortedRanges(Ec);R.embeddedMorphs.forEach(function(Me){var sg=R.embeddedMorphMap.get(Me).anchor;sg=he.Range.at(sg.position);
sg.end.column+=1;R.replace(sg,[Me,ac[Me.id]],!1)});this._tokenizerValidBefore={row:he.arr.last(Va).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},R,this)}}},{key:"visitTokensInRange",value:function(R,pa){var Va=R.start,gb=R.end,ec=Va.row-1;he.visitDocumentTokens(this.mode,this.textMorph.document,Va.row,gb.row,null,function(ac){return ec++},function(ac,Ec,Mc,xc,ze,nf,bf){if(ec===Va.row&&0<Va.column){if(Va.column>=xc)return;Mc<Va.column&&Va.column<xc&&(Mc=Va.column)}if(ec===gb.row){if(gb.column<=
Mc)return;Mc<gb.column&&gb.column<xc&&(xc=gb.column)}pa(ac,Ec,ec,Mc,xc,ze,nf,bf)})}},{key:"tokensInRange",value:function(R){var pa=[];this.visitTokensInRange(R,function(Va,gb,ec,ac,Ec,Mc,xc,ze){return pa.push(he.rangedToken(ec,ac,Ec,Va,ze))});return pa}},{key:"tokensOfRow",value:function(R){var pa=this.textMorph.getLine(R).length;return this.tokensInRange({start:{row:R,column:0},end:{row:R,column:pa}})}},{key:"tokenAt",value:function(R){for(var pa=this.tokensOfRow(R.row),Va=pa.length;Va--;){var gb=
pa[Va];if(gb.token&&gb.start.column<=R.column&&R.column<=gb.end.column)return gb}return null}},{key:"getCommands",value:function(R){return[].concat($jscomp.arrayFromIterable(R),$jscomp.arrayFromIterable(he.completionCommands),$jscomp.arrayFromIterable(he.multiSelectCommands),$jscomp.arrayFromIterable(he.navCommands),$jscomp.arrayFromIterable(he.codeCommands),$jscomp.arrayFromIterable(he.codeEvaluationCommands),$jscomp.arrayFromIterable(he.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var R=this.mode,pa=R.lineComment,Va=R.blockCommentStart;R=R.blockCommentEnd;var gb={};pa&&(gb.lineCommentStart=pa);Va&&(gb.blockCommentStart=Va);R&&(gb.blockCommentEnd=R);return gb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(R,pa,Va){var gb=this.textMorph,ec=R.row,ac=R.column;R=pa[ac-1];pa=pa[ac];gb.selection.text="\n";gb.selection.collapseToEnd();"{"===R&&"}"===pa&&(gb.selection.text="\n"+" ".repeat(Va),gb.selection.collapse());
gb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:ec+1,lastRow:ec+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var R=this.textMorph,pa=this.openPairs,Va=R.selection,gb=R.getLine(Va.end.row),ec=gb[Va.end.column-1];gb=gb[Va.end.column];R.autoInsertPairs&&Va.isEmpty()&&ec in
pa&&gb===pa[ec]&&(Va.growRight(1),Va.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(R){var pa=this.openPairs,Va=this.closePairs,gb=this.textMorph,ec=gb.selection,ac=gb.autoInsertPairs&&R in pa,Ec=gb.autoInsertPairs&&R in Va;if(!ac&&!Ec)return!1;var Mc=gb.getLine(ec.end.row)[ec.end.column];if(!ec.isEmpty()){if(!ac)return!1;Va=gb.undoManager.ensureNewGroup(gb);gb.insertText(pa[R],ec.end);gb.insertText(R,ec.start);gb.undoManager.group(Va);ec.growRight(-1);return!0}if(Mc in Va&&R===Mc)return ec.goRight(1),
!0;if(Ec&&!ac)return!1;Va=gb.undoManager.ensureNewGroup(gb);gb.insertText(R+pa[R]);gb.undoManager.group(Va);ec.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Ha,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);
Qa=Ja=he.EditorPlugin;H=ta("C",function(ua){var Ha=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),pb=Ha.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Ha.CodeMirrorEnabledEditorPlugin?Ha.CodeMirrorEnabledEditorPlugin:Ha.CodeMirrorEnabledEditorPlugin=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return mb(pb,ua,[{key:Symbol.for("lively-instance-initialize"),value:function(){mb._get(Object.getPrototypeOf(pb.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(R){this.mode=this.codeMirrorMode(R);return mb._get(Object.getPrototypeOf(pb.prototype),"attach",this).call(this,R)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(R){return{indentWithTabs:!R.useSoftTabs,indentUnit:R.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(R){R=this.defaultCodeMirrorModeConfig(R);
return he.getMode(R,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Ha,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(he.EditorPlugin));he.CodeMirrorEnabledEditorPlugin=H;he.CodeMirrorEnabledEditorPlugin=
H;he.CodeMirrorEnabledEditorPlugin=H;he.default=Ja;Ja=Object.freeze({__proto__:null,guessTextModeName:Jd,"default":Qa,CodeMirrorEnabledEditorPlugin:H});ta("e",Ja)}}});
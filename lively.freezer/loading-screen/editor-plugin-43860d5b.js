System.register(["./__root_module__-7d3cbdeb.js","kld-intersections","./index-f2f18556.js","./index-00525174.js","./editor-plugin-0bd751e4.js"],function(Ka){var wb,Ab,gc,Kb,Zc,Kc,md,Fc,Bc,Nc,Uc,ce,Zd,pe,Mc,Kd,Jb,Dc,nd,Hc,wd,Qd,Eb,ic,jd;return{setters:[function(jc){wb=jc.i;Ab=jc.bG;gc=jc.bH;Kb=jc.bI;Zc=jc.bJ;Kc=jc.bK;md=jc.c;Fc=jc._;Bc=jc.s;Nc=jc.a3;Uc=jc.bx;ce=jc.a;Zd=jc.p;pe=jc.bL;Mc=jc.aY},function(){},function(jc){Kd=jc.s},function(jc){Jb=jc.localInterface;Dc=jc.systemInterfaceNamed;nd=jc.serverInterfaceFor;
Hc=jc.l2lInterfaceFor},function(jc){wd=jc.p;Qd=jc.d;Eb=jc.a;ic=jc.r;jd=jc.C}],execute:function(){var jc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");jc.warnStyle={"border-bottom":"2px dotted orange"};jc.errorStyle={"background-color":"red"};var kd=function(Nb){var Fb=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),sb=Fb.hasOwnProperty("JavaScriptChecker")&&"function"===typeof Fb.JavaScriptChecker?Fb.JavaScriptChecker:Fb.JavaScriptChecker=function(Ea){Ea&&Ea[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wb(sb,Nb,[{key:"uninstall",value:function(Ea){var ua=Ea.text||Ea;(ua.markers||[]).forEach(function(V){return V.id.startsWith("js-checker-")&&ua.removeMarker(V)});ua.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(Ea,ua){return[].concat($jscomp.arrayFromIterable(Ea.embeddedMorphMap.values())).find(function(V){return ua.containsPosition(V.anchor.position)})}},{key:"onDocumentChange",value:function(Ea,
ua,V){var ra=ua.document;try{var ja=V.parse()}catch(Ca){ja=Ca}ja&&(Ea=(ua.markers||[]).filter(function(Ca){return Ca.id.startsWith("js-checker-")}),V=V.undeclaredVariables().map(function(Ca,va){var cb=Ca.start;Ca=Ca.end;cb=ra.indexToPosition(cb);Ca=ra.indexToPosition(Ca);return ua.addMarker({id:"js-checker-"+va,style:jc.warnStyle,range:{start:cb,end:Ca},type:"js-undeclared-var"})}),Ea.slice(V.length).forEach(function(Ca){return ua.removeMarker(Ca)}),ja.parseError?(Ea=ja.parseError.loc,V=Ea.column,
Ea=Ea.line-1,ja=ra.indexToPosition(ja.parseError.pos),V=ja.column,Ea=ja.row,ja={start:{column:V-1,row:Ea},end:{column:V+1,row:Ea}},this.hasEmbeddedMorphInRange(ua,ja)||ua.addMarker({id:"js-syntax-error",range:ja,style:jc.errorStyle,type:"js-syntax-error"})):ua.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],Fb,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),vb=kd=jc.JavaScriptChecker;jc.default=kd;var db=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");db.query=Ab;db.fuzzyParse=gc;db.acorn=Kb;db.custom=Zc;db.walk=Kc;var ec=function(Nb){var Fb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),sb=Fb.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof Fb.JavaScriptNavigator?
Fb.JavaScriptNavigator:Fb.JavaScriptNavigator=function(Ea){Ea&&Ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wb(sb,Nb,[{key:"ensureAST",value:function(Ea){return this.parse(Ea.textString)}},{key:"parse",value:function(Ea){return db.fuzzyParse(Ea)}},{key:"move",value:function(Ea,ua){var V=!!ua.activeMark||!ua.selection.isEmpty(),ra=ua.selection,ja=ua.positionToIndex(ra.lead);Ea=this[Ea](ua.textString,ja);Ea=ua.indexToPosition(Ea);
ra.lead=Ea;V||(ra.anchor=Ea);ua.scrollCursorIntoView()}},{key:"forwardSexp",value:function(Ea){this.move("_forwardSexp",Ea)}},{key:"backwardSexp",value:function(Ea){this.move("_backwardSexp",Ea)}},{key:"backwardUpSexp",value:function(Ea){this.move("_backwardUpSexp",Ea)}},{key:"forwardDownSexp",value:function(Ea){this.move("_forwardDownSexp",Ea)}},{key:"_forwardSexp",value:function(Ea,ua){Ea=this.parse(Ea);Ea=db.custom.findNodesIncluding(Ea,ua).reverse().find(function(ra){return ra.end!==ua});if(!Ea)return ua;
if("BlockStatement"===Ea.type){var V=Ea.body.find(function(ra){return ra.start>ua});if(V)return V.start}return Ea.end}},{key:"_backwardSexp",value:function(Ea,ua){Ea=this.parse(Ea);Ea=db.custom.findNodesIncluding(Ea,ua).reverse().find(function(ra){return ra.start!==ua});if(!Ea)return ua;if("BlockStatement"===Ea.type){var V=Ea.body.slice().reverse().find(function(ra){return ra.end<ua});if(V)return V.end}return Ea?Ea.start:ua}},{key:"_backwardUpSexp",value:function(Ea,ua){Ea=this.parse(Ea);return(Ea=
db.custom.findNodesIncluding(Ea,ua).reverse().find(function(V){return V.start!==ua}))?Ea.start:ua}},{key:"_forwardDownSexp",value:function(Ea,ua){Ea=this.parse(Ea);return(Ea=db.walk.findNodeAfter(Ea,ua,function(V,ra){return ra.start>ua}))?Ea.node.start:ua}},{key:"markDefun",value:function(Ea){var ua=this.rangeForFunctionOrDefinition(Ea.textString,[Ea.positionToIndex(Ea.selection.range.start),Ea.positionToIndex(Ea.selection.range.end)]);ua&&Ea.execCommand("expandRegion",{start:ua[0],end:ua[1]})}},
{key:"rangeForNodesMatching",value:function(Ea,ua,V){Ea=this.parse(Ea);return(ua=db.custom.findNodesIncluding(Ea,ua).reverse().find(V))?[ua.start,ua.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(Ea,ua){var V=ua[0]===ua[1];return this.rangeForNodesMatching(Ea,ua[1],function(ra){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(ra.type)&&(V&&ra.end!==ua[1]||!V&&ra.start<ua[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(Ea,
ua){"number"!==typeof ua&&(ua=Ea.positionToIndex(ua));Ea=this.ensureAST(Ea);var V=db.query.nodesAt(ua,Ea).reverse(),ra=V.find(function(Ca){return"Identifier"===Ca.type});if(!ra&&((V=V[0])&&V.type.includes("Specifier")&&V.local&&"Identifier"===V.local.type&&(ra=V.local),!ra))return;ua=(V=db.query.findDeclarationClosestToIndex(Ea,ra.name,ua))?db.query.scopeAtIndex(Ea,V.start):db.query.scopeAtIndex(Ea,ua);var ja=db.query.findReferencesAndDeclsInScope(ua,ra.name).refs;return{parsed:Ea,scope:ua,id:ra,
name:ra.name,decl:V,refs:ja}}},{key:"expandRegion",value:function(Ea,ua,V,ra){function ja(hc){hc=Ea.positionToIndex({column:0,row:va.row});return{range:[hc+cb.start,hc+cb.start+cb.value.length],prev:ra}}var Ca=ra.range[0]!==ra.range[1],va=Ea.indexToPosition(ra.range[0]),cb=Ea.tokenAt(va);if(!Ca&&cb&&["keyword","identifier"].includes(cb.type))return ja();V=V||this.parse(ua);ua=db.query.nodesAtIndex(V,ra.range[0]).reverse().find(function(hc){return hc.start<ra.range[0]||hc.end>ra.range[1]});if(!ua)return ra;
V=ua.start;Ca=ua.end;return"Literal"===ua.type&&(ua.raw||"").match(/^['"`]/)&&ra.range[0]!==ua.start&&ra.range[1]!==ua.end&&(ua.start+1<ra.range[0]||ua.end-1>ra.range[1])?{range:[V+1,Ca-1],prev:ra}:{range:[V,Ca],prev:ra}}},{key:"contractRegion",value:function(Ea,ua,V,ra){return ra.prev||ra}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],Fb,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:127,end:6784})}(void 0);kd=ec=db.JavaScriptNavigator;db.default=ec;var Mb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");Mb.addIndexToTextPos=function(Nb,Fb,sb){return Nb.indexToPosition(Nb.positionToIndex(Fb)+sb)};Mb.connect=md;Mb.disconnect=Fc;Mb.string=Bc;Mb.KeyHandler=Nc;Mb.Range=Uc;ec=function(Nb){var Fb=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),
sb=Fb.hasOwnProperty("Snippet")&&"function"===typeof Fb.Snippet?Fb.Snippet:Fb.Snippet=function(Ea){Ea&&Ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wb(sb,Nb,[{key:Symbol.for("lively-instance-initialize"),value:function(Ea){Ea=void 0===Ea?{trigger:null,expansion:""}:Ea;var ua=Ea.expansion;this.trigger=Ea.trigger;this.expansion=ua;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(Ea){this.isExpanding&&
(this.textMorph=Ea,Mb.connect(this.textMorph,"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(Ea){this.isExpanding&&(Mb.disconnect(Ea,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var Ea=this.expansionState,ua=Ea.startAnchor,V=Ea.endAnchor;Ea.isExpanding?Mb.Range.fromPositions(ua.position,V.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",
value:function(){var Ea=this.textMorph;if(Ea){var ua=this.expansionState||{},V=ua.marker,ra=ua.startAnchor,ja=ua.endAnchor;ua=ua.steps;ra&&Ea.removeAnchor(ra);ja&&Ea.removeAnchor(ja);V&&Ea.removeMarker(V);ua.forEach(function(Ca){return Ea.removeAnchor(Ca.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};Ea&&Ea.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(Ea){var ua=
[],V=0;Mb.string.reMatches(Ea,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(ra){var ja=ra.start,Ca=ra.end;ra=ra.match;var va="";ra.startsWith("${")?(va=$jscomp.makeIterator(ra.match(/^\$\{([0-9]+):([^\}]*)\}/)),va.next(),ra=va.next().value,va=va.next().value,ra=Number(ra)):ra=Number(ra.replace(/^\$/,""));Ea=Ea.slice(0,ja-V)+va+Ea.slice(Ca-V);ua[ra]={index:ja-V,prefill:va,anchor:null};V+=Ca-ja-va.length});return{steps:ua,expansion:Ea}}},{key:"expandAtCursor",value:function(Ea){var ua=Ea.selection,
V=Ea.cursorPosition.column,ra=this.expansion;this.trigger&&(V-=this.trigger.length);if(V=Math.max(0,V))ra=Mb.string.lines(ra),ra=[ra[0]].concat($jscomp.arrayFromIterable(ra.slice(1).map(function(gb){return Mb.string.indent(gb," ",V)}))),ra=ra.join("\n");var ja=this.createExpansionSteps(ra);ra=ja.expansion;ja=ja.steps;this.trigger&&ua.growLeft(this.trigger.length);ua.text=ra;var Ca=ua.start;ra=ua.end;ua.collapseToEnd();if(ja.length){var va=Mb.string.newUUID();ja.forEach(function(gb,Oc){return gb.anchor=
Ea.addAnchor(Object.assign({id:"snippet-step-"+Oc+"-"+va},Mb.addIndexToTextPos(Ea,Ca,gb.index)))});var cb=Ea.addAnchor(Object.assign({id:"snippet-start-"+va},Ca,{insertBehavior:"stay"})),hc=Ea.addAnchor(Object.assign({id:"snippet-end-"+va},ra));this.expansionState={marker:Ea.addMarker({id:"snippet-marker-"+va,get range(){return{start:cb.position,end:hc.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",
content:"fooooo"}}),startAnchor:cb,endAnchor:hc,stepIndex:0,steps:ja,isExpanding:!0};Ea.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var Ea=this.expansionState,ua=Ea.steps,V=this.textMorph;if(Ea.isExpanding&&V){V=V.selection;Ea=ua[Ea.stepIndex];var ra=Ea.prefill;V.lead=V.anchor=Ea.anchor.position;V.growRight(ra.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=ua.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+" done"))}}},
{key:"canExpand",value:function(Ea,ua){ua=Ea.positionToIndex(Ea.cursorPosition);return Ea.textString.slice(ua-this.trigger.length,ua)===this.trigger}},{key:"tryTrigger",value:function(Ea,ua){if(!this.canExpand(Ea,Ea.cursorPosition))return!1;this.expandAtCursor(Ea);return!0}},{key:"getCommands",value:function(Ea){var ua=this;return Ea.concat([{name:"[snippet] next expansion step",exec:function(V){ua.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(V){ua.resetExpansionState();
return!0}}])}},{key:"getKeyHandlers",value:function(Ea){return Ea.concat(Mb.KeyHandler.withBindings([{keys:"Tab",command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],Fb,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:357,end:6029})}(void 0);Mb.Snippet=ec;Mb.Snippet=ec;Mb.Snippet=ec;var Hb=[{name:"get snippets",exec:function(Nb){return Nb.pluginCollect("getSnippets",[])}}];Mb.snippetCommands=Hb;Mb.snippetCommands=Hb;Mb.snippetCommands=Hb;var pc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");pc.buildEvalOpts=function(Nb,Fb){return Nb.plugins.find(function(sb){return sb.isJSEditorPlugin}).sanatizedJsEnv(Fb)};pc.Snippet=ec;Hb=function(Nb){var Fb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),
sb=Fb.hasOwnProperty("ModuleTopLevelVarCompleter")&&"function"===typeof Fb.ModuleTopLevelVarCompleter?Fb.ModuleTopLevelVarCompleter:Fb.ModuleTopLevelVarCompleter=function(Ea){Ea&&Ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wb(sb,Nb,[{key:"compute",value:function(Ea,ua){var V,ra,ja,Ca,va,cb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(hc){if(1==hc.nextAddress){ra=(V=Ea.pluginFind(function(gb){return gb.isJSEditorPlugin}))&&
V.systemInterface();if(!ra)return hc.return([]);ja=pc.buildEvalOpts(Ea);Ca=ja.targetModule;return"local"===ra.name?(va=Object.getOwnPropertyNames(ra.getModule(Ca).recorder),hc.jumpTo(2)):hc.yield(ra.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+
Ca+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',{targetModule:"lively://module-recorder-completer"}),3)}if(2!=hc.nextAddress){cb=hc.yieldResult;if(cb.isError)return hc.return([]);va=JSON.parse(cb.value)}va=va.filter(function(gb){return!gb.startsWith("defVar_")&&!["System","__currentLivelyModule",
"initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(gb)});return hc.return(va.map(function(gb){return{priority:1100,completion:gb}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],Fb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:227,end:1700})}(void 0);pc.ModuleTopLevelVarCompleter=Hb;pc.ModuleTopLevelVarCompleter=Hb;pc.ModuleTopLevelVarCompleter=Hb;Hb=function(Nb){var Fb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),sb=Fb.hasOwnProperty("DynamicJavaScriptCompleter")&&"function"===typeof Fb.DynamicJavaScriptCompleter?Fb.DynamicJavaScriptCompleter:Fb.DynamicJavaScriptCompleter=function(Ea){Ea&&Ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return wb(sb,Nb,[{key:"isValidPrefix",value:function(Ea){return/\.[a-z0-9_]*$/i.test(Ea)}},{key:"isMethodCallCompletion",value:function(Ea){return Ea.endsWith(")")&&0<Ea.indexOf("(")}},{key:"isValidIdentifier",value:function(Ea){if("string"!==typeof Ea)return!1;this.isMethodCallCompletion(Ea)&&(Ea=Ea.slice(0,Ea.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(Ea)?!0:!1}},{key:"wrapInBrackets",value:function(Ea){if(!isNaN(Number(Ea))||Ea.startsWith("Symbol."))return"["+Ea+"]";var ua="";this.isMethodCallCompletion(Ea)&&
(ua=Ea.slice(Ea.indexOf("(")),Ea=Ea.slice(0,Ea.indexOf("(")));return'["'+Ea.replace(/"/g,'\\"')+'"]'+ua}},{key:"compute",value:function(Ea){var ua=this,V,ra,ja,Ca,va,cb,hc,gb,Oc,Cb,Gd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){if(1==Ec.nextAddress){V=Ea.selection;V.isEmpty()?(ra=Ea.getLine(V.lead.row),ra=ra.slice(ra.lastIndexOf(":")+1,V.lead.column)):ra=V.text.slice(Math.max(0,V.text.indexOf(":")),0);if(!ua.isValidPrefix(ra))return Ec.return([]);Ca=(ja=Ea.pluginFind(function(oc){return oc.isJSEditorPlugin}))&&
ja.systemInterface();if(!Ca)return Ec.return([]);va=pc.buildEvalOpts(Ea);return Ec.yield(Ca.dynamicCompletionsForPrefix(va.targetModule,ra,va),2)}cb=Ec.yieldResult;hc=cb.isError;gb=cb.value;Oc=cb.completions;Cb=cb.prefix;if(hc)return console.warn("javascript completer encountered error: "+(gb.stack||gb)),Ec.return([]);Oc.reduce(function(oc,rb){rb=$jscomp.makeIterator(rb);rb.next();rb=rb.next().value;return oc+rb.length},0);Gd=Oc.reduce(function(oc,rb,Md){rb=$jscomp.makeIterator(rb);var yb=rb.next().value;
rb=rb.next().value;return oc.concat(rb.map(function(qb){var Ia=ua.isValidIdentifier(qb);return{info:yb,completion:qb,prefix:Ia?Cb:"."+Cb,customInsertionFn:Ia?ua.isMethodCallCompletion(qb)?function(Q,za,Ta,xb){za=xb.start;xb=xb.end;Q=Q.replace(/\((.*)\)/,function(Yb){return"("+Yb.slice(1,-1).split(", ").map(function(Ac,mc){return"${"+mc+":"+Ac+"}"}).join(", ")+")"});Q=new pc.Snippet({expansion:Q});Ta.replace({start:za,end:xb},"");Q.expandAtCursor(Ta)}:null:function(Q,za,Ta,xb){Q=xb.start;xb=xb.end;
za={row:Q.row,column:Q.column-1};xb="."===Ta.textInRange({start:za,end:Q})?{start:za,end:xb}:{start:Q,end:xb};Ta.replace(xb,ua.wrapInBrackets(qb))}}}))},[]);Gd.forEach(function(oc,rb){return Object.assign(oc,{priority:2E3+Gd.length-rb})});return Ec.return(Gd)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DynamicJavaScriptCompleter"}}],Fb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5155})}(void 0);pc.DynamicJavaScriptCompleter=Hb;pc.DynamicJavaScriptCompleter=Hb;pc.DynamicJavaScriptCompleter=Hb;pc.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
Hb=function(Nb){var Fb=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),sb=Fb.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof Fb.JavaScriptKeywordCompleter?Fb.JavaScriptKeywordCompleter:Fb.JavaScriptKeywordCompleter=function(Ea){Ea&&Ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wb(sb,Nb,[{key:"compute",value:function(Ea,ua){return pc.keywords.map(function(V){return{completion:V,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],Fb,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6157,end:6295})}(void 0);pc.JavaScriptKeywordCompleter=Hb;pc.JavaScriptKeywordCompleter=Hb;pc.JavaScriptKeywordCompleter=Hb;Hb=[new pc.DynamicJavaScriptCompleter,
new pc.JavaScriptKeywordCompleter,new pc.ModuleTopLevelVarCompleter];pc.completers=Hb;pc.completers=Hb;pc.completers=Hb;var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");Ma.Snippet=ec;var Ib=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];Ma.snippets=Ib;Ma.snippets=Ib;Ma.snippets=Ib;var pb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");pb.getEvalEnv=function(Nb){return(Nb=Nb.pluginFind(function(Fb){return Fb.isJSEditorPlugin}))?Nb.evalEnvironment:null};pb.setEvalEnv=function(Nb,Fb){(Nb=Nb.pluginFind(function(sb){return sb.isJSEditorPlugin}))&&Object.assign(Nb.evalEnvironment,Fb);return Nb.evalEnvironment};
pb.pToI=function(Nb,Fb){return Nb.positionToIndex(Fb)};pb.iToP=function(Nb,Fb){return Nb.indexToPosition(Fb)};pb.arr=ce;pb.promise=Zd;pb.string=Bc;pb.show=Kd;pb.Range=Uc;pb.query=Ab;pb.BaseVisitor=pe;Ma=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(Nb,Fb){Fb=void 0===Fb?{varName:null,position:null}:Fb;var sb,Ea,ua,V,ra,ja,Ca,va,cb,hc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){switch(gb.nextAddress){case 1:sb=
Fb;Ea=sb.varName;ua=sb.position;if(!Ea){ua||(ua=Nb.cursorPosition);V=Nb.pluginInvokeFirst("getNavigator");ra=V.ensureAST(Nb);ja=pb.query.nodesAt(Nb.positionToIndex(ua),ra).reverse().find(function(Oc){return"Identifier"===Oc.type});if(!ja)return Nb.showError(Error("no identifier found!")),gb.return(!0);Ea=ja.name}Fb=Nb.pluginFind(function(Oc){return Oc.isJSEditorPlugin}).sanatizedJsEnv();Ca='lively.modules.module("'+Fb.targetModule+'").undefine("'+Ea+'")';gb.setCatchFinallyBlocks(2);return gb.yield(Nb.doEval(null,
Fb,Ca),4);case 4:va=gb.yieldResult;cb=va.error?va.error:va.isError?va.value:null;gb.leaveTryBlock(3);break;case 2:cb=hc=gb.enterCatchBlock();case 3:return cb?Nb.showError(cb):Nb.setStatusMessage(Ea+" undefined"),gb.return(!0)}})}},{name:"change doitContext",exec:function(Nb){var Fb,sb,Ea,ua,V;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){if(1==ra.nextAddress)return Fb=$jscomp,sb=Fb.makeIterator,ra.yield(Nb.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(ja){return!ja.isUsedAsEpiMorph()}}),2);Ea=sb.call(Fb,ra.yieldResult);if(ua=Ea.next().value)V="reset"===ua,Nb.doitContext=V?null:ua,Nb.setStatusMessage(V?"doitContext is now\n"+ua:"doitContext reset");return ra.return(!0)})}},{name:"change eval backend",exec:function(Nb,Fb){Fb=void 0===Fb?{backend:void 0}:Fb;var sb,Ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){if(1==ua.nextAddress)return sb=Fb,Ea=sb.backend,void 0!==Ea?ua.jumpTo(2):
ua.yield(Nb.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=ua.nextAddress&&(Ea=ua.yieldResult,!Ea))return Nb.setStatusMessage("Canceled"),ua.return(!0);"local"===Ea&&(Ea=null);Nb.setStatusMessage("Eval backend is now "+(Ea||"local"));return ua.return(pb.setEvalEnv(Nb,{remote:Ea}))})}},{name:"copy current module name to clipboard",exec:function(Nb){var Fb=Nb.evalEnvironment.targetModule;Nb.setStatusMessage(Fb||"Cannot find module name");Nb.env.eventDispatcher.killRing.add(Nb);
Nb.env.eventDispatcher.doCopy(Fb);return!0}}];pb.jsEditorCommands=Ma;pb.jsEditorCommands=Ma;pb.jsEditorCommands=Ma;var Ub=[{name:"[javascript] list errors and warnings",exec:function(Nb){var Fb,sb,Ea,ua,V;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ra){if(1==ra.nextAddress){Fb=(Nb.markers||[]).filter(function(ja){ja=ja.type;return"js-undeclared-var"===ja||"js-syntax-error"===ja});if(!Fb.length)return pb.show("no warnings or errors"),ra.return(!0);sb=Fb.map(function(ja){var Ca=ja.range;
return{isListItem:!0,string:"["+ja.type.split("-").slice(1).join(" ")+"] "+Nb.textInRange(Ca),value:Ca}});return ra.yield(Nb.world().filterableListPrompt("jump to warning or error",sb),2)}Ea=ra.yieldResult;ua=$jscomp.makeIterator(Ea.selected);if(V=ua.next().value)Nb.saveMark(),Nb.selection=V,Nb.centerRow(V.start.row);return ra.return(!0)})}},{name:"[javascript] inject import",exec:function(Nb,Fb){Fb=void 0===Fb?{gotoImport:!1,insertImportAtCursor:!0}:Fb;var sb,Ea,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){switch(V.nextAddress){case 1:return V.yield(pb.promise.delay(0),
2);case 2:return V.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return sb=V.yieldResult,Ea=sb.interactivelyInjectImportIntoText,V.yield(Ea(Nb,Fb),4);case 4:return(ua=V.yieldResult)||Nb.setStatusMessage("canceled"),V.return(ua)}})}},{name:"[javascript] fix undeclared variables",exec:function(Nb,Fb){Fb=void 0===Fb?{ignore:[],autoApplyIfSingleChoice:!1,requester:Nb}:Fb;var sb,Ea,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){if(1==V.nextAddress)return V.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=V.nextAddress)return sb=V.yieldResult,Ea=sb.interactivlyFixUndeclaredVariables,V.yield(Ea(Nb,Fb),3);ua=V.yieldResult;Nb.focus();return V.return(ua)})}},{name:"[javascript] remove unused imports",exec:function(Nb,Fb){Fb=void 0===Fb?{query:!0}:Fb;var sb,Ea,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(V){if(1==V.nextAddress)return V.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=V.nextAddress)return sb=V.yieldResult,Ea=sb.cleanupUnusedImports,V.yield(Ea(Nb,
Fb),3);ua=V.yieldResult;Nb.setStatusMessage(ua);return V.return(!0)})}},{name:"[javascript] eslint report",exec:function(Nb){var Fb,sb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ea){if(1==Ea.nextAddress)return Ea.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);Fb=Ea.yieldResult;sb=Fb.default;try{return Ea.return(sb.reportOnMorph(Nb))}catch(ua){Nb.showError(ua)}Ea.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(Nb){var Fb,sb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ea){if(1==
Ea.nextAddress)return Ea.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);Fb=Ea.yieldResult;sb=Fb.default;try{return Ea.return(sb.previewFixesOnMorph(Nb))}catch(ua){Nb.showError(ua)}Ea.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(Nb,Fb,sb){function Ea(Ec,oc){oc||(oc=va(Ec,{allowReturnOutsideFunction:!0}));var rb=pb.string.lineRanges(Ec),Md=Ec.split("\n"),yb=[],qb=new pb.BaseVisitor,Ia=qb.visitVariableDeclaration;qb.visitVariableDeclaration=
function(xb,Yb,Ac){if(1<xb.declarations.length)for(var mc=pb.string.findLineWithIndexInLineRanges(rb,xb.start),qd=xb.declarations[0].start-rb[mc][0],zd={},Ee=1;Ee<xb.declarations.length;zd={$jscomp$loop$prop$actionType$2827:zd.$jscomp$loop$prop$actionType$2827,$jscomp$loop$prop$arg$2828:zd.$jscomp$loop$prop$arg$2828},Ee++){var se=xb.declarations[Ee],ke=pb.string.findLineWithIndexInLineRanges(rb,se.start);if(mc!==ke){var w=Md[ke].match(/\s*/)[0].length;w=qd-w;0!==w&&(se=pb.string.findLineWithIndexInLineRanges(rb,
se.end),zd.$jscomp$loop$prop$actionType$2827=0<w?"insert":"delete",zd.$jscomp$loop$prop$arg$2828=0<w?" ".repeat(w):-w,yb.push.apply(yb,$jscomp.arrayFromIterable(pb.arr.range(ke,se).map(function(we){return function(ue){return[we.$jscomp$loop$prop$actionType$2827,rb[ue][0],we.$jscomp$loop$prop$arg$2828]}}(zd)))))}}return Ia.call(qb,xb,Yb,Ac)};qb.accept(oc,{},[]);for(oc=yb.length;oc--;){var Q=$jscomp.makeIterator(yb[oc]),za=Q.next().value,Ta=Q.next().value;Q=Q.next().value;"insert"===za?Ec=Ec.slice(0,
Ta)+Q+Ec.slice(Ta):"delete"===za&&(Ec=Ec.slice(0,Ta)+Ec.slice(Ta+Q))}return Ec}var ua,V,ra,ja,Ca,va,cb,hc,gb,Oc,Cb,Gd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ec){switch(Ec.nextAddress){case 1:return ua=sb||Math.floor(Nb.width/Nb.defaultCharExtent().width),Fb=Object.assign({printWidth:ua,tabWidth:2,useTabs:!1,bracketSpacing:!1},Fb),V=lively.modules.module,ra=System.normalizeSync("prettier/standalone.js"),Ec.yield(V(ra).load({format:"global",instrument:!1}),2);case 2:return ja=Ec.yieldResult,
Ec.yield(V("lively.ast/lib/acorn-extension.js").load(),3);case 3:return Ec.yield(V("lively.ast").load(),4);case 4:return Ca=Ec.yieldResult,va=Ca.parse,Ec.yield(V("lively.ast/lib/query.js").load(),5);case 5:return Ec.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return cb=Ec.yieldResult,hc=Nb.selection.isEmpty()?Nb.documentRange:Nb.selection.range,gb=Nb.positionToIndex(hc.start),Oc=Nb.positionToIndex(hc.end),Cb=ja.format(Nb.textString,Object.assign({},Fb,{rangeStart:gb,
rangeEnd:Oc,parser:function(oc,rb,Md){return va(oc,{allowReturnOutsideFunction:!0})}})),Nb.undoManager.group(),Gd=cb.diffChars(Nb.textString,Cb),Nb.applyJsDiffPatch(Gd),Nb.selection.text=Ea(Nb.selection.text),Nb.undoManager.group(),Ec.return(!0)}})}}];pb.jsIdeCommands=Ub;pb.jsIdeCommands=Ub;pb.jsIdeCommands=Ub;var dc=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(Nb,Fb){Fb=Nb.pluginInvokeFirst("getNavigator");if(!Fb)return!0;Fb=Fb.resolveIdentifierAt(Nb,Nb.cursorPosition);if(!Fb||
!Fb.id)return pb.show("No symbol identifier selected"),!0;if(!Fb.decl)return pb.show("Cannot find declaration of "+Fb.name),!0;Nb.saveMark();Nb.selection={start:Nb.indexToPosition(Fb.decl.start),end:Nb.indexToPosition(Fb.decl.end)};Nb.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(Nb){Nb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",readOnly:!0,
multiSelectAction:"single",exec:function(Nb){Nb.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(Nb,Fb){Fb=void 0===Fb?{direction:null}:Fb;var sb=Nb.pluginInvokeFirst("getNavigator");if(!sb)return!0;sb=sb.resolveIdentifierAt(Nb,
Nb.cursorPosition);if(!sb||!sb.refs)return pb.show("No symbol identifier selected"),!0;var Ea=Nb.selection;sb=sb.refs.map(function(V){var ra=V.end;return pb.Range.fromPositions(pb.iToP(Nb,V.start),pb.iToP(Nb,ra))}).concat(sb.decl?pb.Range.fromPositions(pb.iToP(Nb,sb.decl.start),pb.iToP(Nb,sb.decl.end)):[]).sort(pb.Range.compare);if(!sb.length)return!0;var ua=sb.map(String).indexOf(String(Ea.range));if("next"===Fb.direction||"prev"===Fb.direction)-1===ua&&sb.length?sb=[sb[0]]:(Fb=ua+("next"===Fb.direction?
1:-1),0>Fb?Fb=sb.length-1:Fb>=sb.length&&(Fb=0),sb=[sb[Fb]]);sb.forEach(function(V){var ra=Ea.selections.findIndex(function(Ca){return Ca.range.equals(V)}),ja=Ea.selections.length-1;-1<ra?pb.arr.swap(Ea.selections,ra,ja):Ea.addRange(V,!1)});Ea.mergeSelections();return!0}}];pb.astEditorCommands=dc;pb.astEditorCommands=dc;pb.astEditorCommands=dc;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var vc=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
vc.expressionAllowed=function(Nb,Fb,sb){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(Fb.lastType)||"quasi"==Fb.lastType&&/\{\s*$/.test(Nb.string.slice(0,Nb.pos-(sb||0)))};vc.passIndent=wd;vc.defineMode=Qd;vc.defineMIME=Eb;vc.registerHelper=ic;vc.defaultConfig={indentUnit:2};vc.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};vc.defineMode("javascript",
function(Nb,Fb){function sb(Vb,Pc,ud){Nf=Vb;Xf=ud;return Pc}function Ea(Vb,Pc){var ud=Vb.next();if('"'==ud||"'"==ud)return Pc.tokenize=ua(ud),Pc.tokenize(Vb,Pc);if("."==ud&&Vb.match(/^\d+(?:[eE][+\-]?\d+)?/))return sb("number","number");if("."==ud&&Vb.match(".."))return sb("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(ud))return sb(ud);if("="==ud&&Vb.eat(">"))return sb("=>","operator");if("0"==ud&&Vb.eat(/x/i))return Vb.eatWhile(/[\da-f]/i),sb("number","number");if("0"==ud&&Vb.eat(/o/i))return Vb.eatWhile(/[0-7]/i),
sb("number","number");if("0"==ud&&Vb.eat(/b/i))return Vb.eatWhile(/[01]/i),sb("number","number");if(/\d/.test(ud))return Vb.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),sb("number","number");if("/"==ud){if(Vb.eat("*"))return Pc.tokenize=V,V(Vb,Pc);if(Vb.eat("/"))return Vb.skipToEnd(),sb("comment","comment");if(vc.expressionAllowed(Vb,Pc,1)){a:for(var Ld=Pc=!1;null!=(ud=Vb.next());){if(!Pc){if("/"==ud&&!Ld)break a;"["==ud?Ld=!0:Ld&&"]"==ud&&(Ld=!1)}Pc=!Pc&&"\\"==ud}Vb.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return sb("regexp","string-2")}Vb.eatWhile(Oe);return sb("operator","operator",Vb.current())}if("`"==ud)return Pc.tokenize=ra,ra(Vb,Pc);if("#"==ud)return Vb.skipToEnd(),sb("error","error");if(Oe.test(ud))return">"==ud&&Pc.lexical&&">"==Pc.lexical.type||Vb.eatWhile(Oe),sb("operator","operator",Vb.current());if(ph.test(ud))return Vb.eatWhile(ph),Vb=Vb.current(),(ud=uh.propertyIsEnumerable(Vb)&&uh[Vb])&&"."!=Pc.lastType?sb(ud.type,ud.style,Vb):sb("variable","variable",Vb)}function ua(Vb){return function(Pc,
ud){var Ld=!1,mf;if(Wf&&"@"==Pc.peek()&&Pc.match(Ch))return ud.tokenize=Ea,sb("jsonld-keyword","meta");for(;null!=(mf=Pc.next())&&(mf!=Vb||Ld);)Ld=!Ld&&"\\"==mf;Ld||(ud.tokenize=Ea);return sb("string","string")}}function V(Vb,Pc){for(var ud=!1,Ld;Ld=Vb.next();){if("/"==Ld&&ud){Pc.tokenize=Ea;break}ud="*"==Ld}return sb("comment","comment")}function ra(Vb,Pc){for(var ud=!1,Ld;null!=(Ld=Vb.next());){if(!ud&&("`"==Ld||"$"==Ld&&Vb.eat("{"))){Pc.tokenize=Ea;break}ud=!ud&&"\\"==Ld}return sb("quasi","string-2",
Vb.current())}function ja(Vb,Pc){Pc.fatArrowAt&&(Pc.fatArrowAt=null);var ud=Vb.string.indexOf("=>",Vb.start);if(!(0>ud)){if(Mf){var Ld=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(Vb.string.slice(Vb.start,ud));Ld&&(ud=Ld.index)}Ld=0;var mf=!1;for(--ud;0<=ud;--ud){var pf=Vb.string.charAt(ud),rg="([{}])".indexOf(pf);if(0<=rg&&3>rg){if(!Ld){++ud;break}if(0==--Ld){"("==pf&&(mf=!0);break}}else if(3<=rg&&6>rg)++Ld;else if(ph.test(pf))mf=!0;else{if(/["'\/]/.test(pf))return;if(mf&&!Ld){++ud;break}}}mf&&
!Ld&&(Pc.fatArrowAt=ud)}}function Ca(Vb,Pc,ud,Ld,mf,pf){this.indented=Vb;this.column=Pc;this.type=ud;this.prev=mf;this.info=pf;null!=Ld&&(this.align=Ld)}function va(){for(var Vb=arguments.length-1;0<=Vb;Vb--)xe.cc.push(arguments[Vb])}function cb(){va.apply(null,arguments);return!0}function hc(Vb){function Pc(Ld){for(;Ld;Ld=Ld.next)if(Ld.name==Vb)return!0;return!1}var ud=xe.state;xe.marked="def";ud.context?Pc(ud.localVars)||(ud.localVars={name:Vb,next:ud.localVars}):!Pc(ud.globalVars)&&Fb.globalVars&&
(ud.globalVars={name:Vb,next:ud.globalVars})}function gb(){xe.state.context={prev:xe.state.context,vars:xe.state.localVars};xe.state.localVars=Jh}function Oc(){xe.state.localVars=xe.state.context.vars;xe.state.context=xe.state.context.prev}function Cb(Vb,Pc){var ud=function(){var Ld=xe.state,mf=Ld.indented;if("stat"==Ld.lexical.type)mf=Ld.lexical.indented;else for(var pf=Ld.lexical;pf&&")"==pf.type&&pf.align;pf=pf.prev)mf=pf.indented;Ld.lexical=new Ca(mf,xe.stream.column(),Vb,null,Ld.lexical,Pc)};
ud.lex=!0;return ud}function Gd(){var Vb=xe.state;Vb.lexical.prev&&(")"==Vb.lexical.type&&(Vb.indented=Vb.lexical.indented),Vb.lexical=Vb.lexical.prev)}function Ec(Vb){function Pc(ud){return ud==Vb?cb():";"==Vb?va():cb(Pc)}return Pc}function oc(Vb,Pc){return"var"==Vb?cb(Cb("vardef",Pc.length),Fd,Ec(";"),Gd):"keyword a"==Vb?cb(Cb("form"),yb,oc,Gd):"keyword b"==Vb?cb(Cb("form"),oc,Gd):"{"==Vb?cb(Cb("}"),Te,Gd):";"==Vb?cb():"if"==Vb?("else"==xe.state.lexical.info&&xe.state.cc[xe.state.cc.length-1]==
Gd&&xe.state.cc.pop()(),cb(Cb("form"),yb,oc,Gd,pa)):"function"==Vb?cb(Ba):"for"==Vb?cb(Cb("form"),xa,oc,Gd):"variable"==Vb?Mf&&"type"==Pc?(xe.marked="keyword",cb(ff,Ec("operator"),ff,Ec(";"))):cb(Cb("stat"),se):"switch"==Vb?cb(Cb("form"),yb,Ec("{"),Cb("}","switch"),Te,Gd,Gd):"case"==Vb?cb(rb,Ec(":")):"default"==Vb?cb(Ec(":")):"catch"==Vb?cb(Cb("form"),gb,Ec("("),Na,Ec(")"),oc,Gd,Oc):"class"==Vb?cb(Cb("form"),Sb,Gd):"export"==Vb?cb(Cb("stat"),$c,Gd):"import"==Vb?cb(Cb("stat"),je,Gd):"module"==Vb?cb(Cb("form"),
$d,Ec("{"),Cb("}"),Te,Gd,Gd):"async"==Vb?cb(oc):"@"==Pc?cb(rb,oc):va(Cb("stat"),rb,Ec(";"),Gd)}function rb(Vb){return qb(Vb,!1)}function Md(Vb){return qb(Vb,!0)}function yb(Vb){return"("!=Vb?va():cb(Cb(")"),rb,Ec(")"),Gd)}function qb(Vb,Pc){if(xe.state.fatArrowAt==xe.stream.start){var ud=Pc?mc:Ac;if("("==Vb)return cb(gb,Cb(")"),Od($d,")"),Gd,Ec("=>"),ud,Oc);if("variable"==Vb)return va(gb,$d,Ec("=>"),ud,Oc)}ud=Pc?Ta:za;return Qg.hasOwnProperty(Vb)?cb(ud):"function"==Vb?cb(Ba,ud):"class"==Vb?cb(Cb("form"),
tb,Gd):"keyword c"==Vb||"async"==Vb?cb(Pc?Q:Ia):"("==Vb?cb(Cb(")"),Ia,Ec(")"),Gd,ud):"operator"==Vb||"spread"==Vb?cb(Pc?Md:rb):"["==Vb?cb(Cb("]"),Re,Gd,ud):"{"==Vb?He(w,"}",null,ud):"quasi"==Vb?va(xb,ud):"new"==Vb?cb(qd(Pc)):cb()}function Ia(Vb){return Vb.match(/[;\}\)\],]/)?va():va(rb)}function Q(Vb){return Vb.match(/[;\}\)\],]/)?va():va(Md)}function za(Vb,Pc){return","==Vb?cb(rb):Ta(Vb,Pc,!1)}function Ta(Vb,Pc,ud){var Ld=0==ud?za:Ta,mf=0==ud?rb:Md;if("=>"==Vb)return cb(gb,ud?mc:Ac,Oc);if("operator"==
Vb)return/\+\+|--/.test(Pc)?cb(Ld):"?"==Pc?cb(rb,Ec(":"),mf):cb(mf);if("quasi"==Vb)return va(xb,Ld);if(";"!=Vb){if("("==Vb)return He(Md,")","call",Ld);if("."==Vb)return cb(ke,Ld);if("["==Vb)return cb(Cb("]"),Ia,Ec("]"),Gd,Ld)}}function xb(Vb,Pc){return"quasi"!=Vb?va():"${"!=Pc.slice(Pc.length-2)?cb(xb):cb(rb,Yb)}function Yb(Vb){if("}"==Vb)return xe.marked="string-2",xe.state.tokenize=ra,cb(xb)}function Ac(Vb){ja(xe.stream,xe.state);return va("{"==Vb?oc:rb)}function mc(Vb){ja(xe.stream,xe.state);return va("{"==
Vb?oc:Md)}function qd(Vb){return function(Pc){return"."==Pc?cb(Vb?Ee:zd):va(Vb?Md:rb)}}function zd(Vb,Pc){if("target"==Pc)return xe.marked="keyword",cb(za)}function Ee(Vb,Pc){if("target"==Pc)return xe.marked="keyword",cb(Ta)}function se(Vb){return":"==Vb?cb(Gd,oc):va(za,Ec(";"),Gd)}function ke(Vb){if("variable"==Vb)return xe.marked="property",cb()}function w(Vb,Pc){if("async"==Vb)return xe.marked="property",cb(w);if("variable"==Vb||"keyword"==xe.style)return xe.marked="property","get"==Pc||"set"==
Pc?cb(we):cb(ue);if("number"==Vb||"string"==Vb)return xe.marked=Wf?"property":xe.style+" property",cb(ue);if("jsonld-keyword"==Vb)return cb(ue);if("modifier"==Vb)return cb(w);if("["==Vb)return cb(rb,Ec("]"),ue);if("spread"==Vb)return cb(rb);if(":"==Vb)return va(ue)}function we(Vb){if("variable"!=Vb)return va(ue);xe.marked="property";return cb(Ba)}function ue(Vb){if(":"==Vb)return cb(Md);if("("==Vb)return va(Ba)}function Od(Vb,Pc,ud){function Ld(mf,pf){return(ud?-1<ud.indexOf(mf):","==mf)?(mf=xe.state.lexical,
"call"==mf.info&&(mf.pos=(mf.pos||0)+1),cb(function(rg,Gj){return rg==Pc||Gj==Pc?va():va(Vb)},Ld)):mf==Pc||pf==Pc?cb():cb(Ec(Pc))}return function(mf,pf){return mf==Pc||pf==Pc?cb():va(Vb,Ld)}}function He(Vb,Pc,ud){for(var Ld=3;Ld<arguments.length;Ld++)xe.cc.push(arguments[Ld]);return cb(Cb(Pc,ud),Od(Vb,Pc),Gd)}function Te(Vb){return"}"==Vb?cb():va(oc,Te)}function Ue(Vb,Pc){if(Mf){if(":"==Vb)return cb(ff);if("?"==Pc)return cb(Ue)}}function ff(Vb){if("variable"==Vb)return xe.marked="variable-3",cb(ef);
if("string"==Vb||"number"==Vb||"atom"==Vb)return cb(ef);if("{"==Vb)return cb(Cb("}"),Od(Wb,"}",",;"),Gd);if("("==Vb)return cb(Od(Kh,")"),gf)}function gf(Vb){if("=>"==Vb)return cb(ff)}function Wb(Vb,Pc){if("variable"==Vb||"keyword"==xe.style)return xe.marked="property",cb(Wb);if("?"==Pc)return cb(Wb);if(":"==Vb)return cb(ff)}function Kh(Vb){if("variable"==Vb)return cb(Kh);if(":"==Vb)return cb(ff)}function ef(Vb,Pc){if("<"==Pc)return cb(Cb(">"),Od(ff,">"),Gd,ef);if("|"==Pc||"."==Vb)return cb(ff);if("["==
Vb)return cb(Ec("]"),ef);if("extends"==Pc)return cb(ff)}function Fd(){return va($d,Ue,Wa,Gb)}function $d(Vb,Pc){if("modifier"==Vb)return cb($d);if("variable"==Vb)return hc(Pc),cb();if("spread"==Vb)return cb($d);if("["==Vb)return He($d,"]");if("{"==Vb)return He(Fa,"}")}function Fa(Vb,Pc){if("variable"==Vb&&!xe.stream.match(/^\s*:/,!1))return hc(Pc),cb(Wa);"variable"==Vb&&(xe.marked="property");return"spread"==Vb?cb($d):"}"==Vb?va():cb(Ec(":"),$d,Wa)}function Wa(Vb,Pc){if("="==Pc)return cb(Md)}function Gb(Vb){if(","==
Vb)return cb(Fd)}function pa(Vb,Pc){if("keyword b"==Vb&&"else"==Pc)return cb(Cb("form","else"),oc,Gd)}function xa(Vb){if("("==Vb)return cb(Cb(")"),Ha,Ec(")"),Gd)}function Ha(Vb){return"var"==Vb?cb(Fd,Ec(";"),ob):";"==Vb?cb(ob):"variable"==Vb?cb(S):va(rb,Ec(";"),ob)}function S(Vb,Pc){return"in"==Pc||"of"==Pc?(xe.marked="keyword",cb(rb)):cb(za,ob)}function ob(Vb,Pc){return";"==Vb?cb(fa):"in"==Pc||"of"==Pc?(xe.marked="keyword",cb(rb)):va(rb,Ec(";"),fa)}function fa(Vb){")"!=Vb&&cb(rb)}function Ba(Vb,
Pc){if("*"==Pc)return xe.marked="keyword",cb(Ba);if("variable"==Vb)return hc(Pc),cb(Ba);if("("==Vb)return cb(gb,Cb(")"),Od(Na,")"),Gd,Ue,oc,Oc);if(Mf&&"<"==Pc)return cb(Cb(">"),Od(ff,">"),Gd,Ba)}function Na(Vb){return"spread"==Vb?cb(Na):va($d,Ue,Wa)}function tb(Vb,Pc){return"variable"==Vb?Sb(Vb,Pc):lc(Vb,Pc)}function Sb(Vb,Pc){if("variable"==Vb)return hc(Pc),cb(lc)}function lc(Vb,Pc){if("<"==Pc)return cb(Cb(">"),Od(ff,">"),Gd,lc);if("extends"==Pc||"implements"==Pc||Mf&&","==Vb)return cb(Mf?ff:rb,
lc);if("{"==Vb)return cb(Cb("}"),uc,Gd)}function uc(Vb,Pc){if("variable"==Vb||"keyword"==xe.style){if(("async"==Pc||"static"==Pc||"get"==Pc||"set"==Pc||Mf&&("public"==Pc||"private"==Pc||"protected"==Pc||"readonly"==Pc||"abstract"==Pc))&&xe.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return xe.marked="keyword",cb(uc);xe.marked="property";return cb(Mf?rc:Ba,uc)}if("["==Vb)return cb(rb,Ec("]"),Mf?rc:Ba,uc);if("*"==Pc)return xe.marked="keyword",cb(uc);if(";"==Vb)return cb(uc);if("}"==Vb)return cb();if("@"==
Pc)return cb(rb,uc)}function rc(Vb,Pc){return"?"==Pc?cb(rc):":"==Vb?cb(ff,Wa):"="==Pc?cb(Md):va(Ba)}function $c(Vb,Pc){return"*"==Pc?(xe.marked="keyword",cb(Ud,Ec(";"))):"default"==Pc?(xe.marked="keyword",cb(rb,Ec(";"))):"{"==Vb?cb(Od(Jd,"}"),Ud,Ec(";")):va(oc)}function Jd(Vb,Pc){if("as"==Pc)return xe.marked="keyword",cb(Ec("variable"));if("variable"==Vb)return va(Md,Jd)}function je(Vb){return"string"==Vb?cb():va(td,qe,Ud)}function td(Vb,Pc){if("{"==Vb)return He(td,"}");"variable"==Vb&&hc(Pc);"*"==
Pc&&(xe.marked="keyword");return cb(Wd)}function qe(Vb){if(","==Vb)return cb(td,qe)}function Wd(Vb,Pc){if("as"==Pc)return xe.marked="keyword",cb(td)}function Ud(Vb,Pc){if("from"==Pc)return xe.marked="keyword",cb(rb)}function Re(Vb){return"]"==Vb?cb():va(Od(Md,"]"))}Nb=Object.assign({},vc.defaultConfig,{},Nb);Fb=Object.assign({},vc.defaultParserConfig,{},Fb);var wf=Nb.indentUnit,Bf=Fb.statementIndent,Wf=Fb.jsonld,Gf=Fb.json||Wf,Mf=Fb.typescript,ph=Fb.wordCharacters||/[\w$\xa1-\uffff]/,uh=function(){function Vb(Gj){return{type:Gj,
style:"keyword"}}var Pc=Vb("keyword a"),ud=Vb("keyword b"),Ld=Vb("keyword c"),mf=Vb("operator"),pf={type:"atom",style:"atom"};Pc={if:Vb("if"),while:Pc,with:Pc,else:ud,do:ud,try:ud,finally:ud,return:Ld,break:Ld,continue:Ld,new:Vb("new"),delete:Ld,throw:Ld,debugger:Ld,var:Vb("var"),const:Vb("var"),let:Vb("var"),function:Vb("function"),catch:Vb("catch"),for:Vb("for"),switch:Vb("switch"),case:Vb("case"),default:Vb("default"),in:mf,typeof:mf,instanceof:mf,true:pf,false:pf,null:pf,undefined:pf,NaN:pf,Infinity:pf,
this:Vb("this"),class:Vb("class"),super:Vb("atom"),yield:Ld,export:Vb("export"),import:Vb("import"),extends:Ld,await:Ld,async:Vb("async")};if(Mf){ud={type:"variable",style:"variable-3"};Ld={interface:Vb("class"),implements:Ld,namespace:Ld,module:Vb("module"),enum:Vb("module"),public:Vb("modifier"),private:Vb("modifier"),protected:Vb("modifier"),abstract:Vb("modifier"),as:mf,string:ud,number:ud,boolean:ud,any:ud};for(var rg in Ld)Pc[rg]=Ld[rg]}return Pc}(),Oe=/[+\-*&%=<>!?|~^@]/,Ch=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
Nf,Xf,Qg={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},xe={state:null,column:null,marked:null,cc:null},Jh={name:"this",next:{name:"arguments"}};Gd.lex=!0;return{startState:function(Vb){Vb={tokenize:Ea,lastType:"sof",cc:[],lexical:new Ca((Vb||0)-wf,0,"block",!1),localVars:Fb.localVars,context:Fb.localVars&&{vars:Fb.localVars},indented:Vb||0};Fb.globalVars&&"object"===typeof Fb.globalVars&&(Vb.globalVars=Fb.globalVars);return Vb},token:function(Vb,Pc){Vb.sol()&&(Pc.lexical.hasOwnProperty("align")||
(Pc.lexical.align=!1),Pc.indented=Vb.indentation(),ja(Vb,Pc));if(Pc.tokenize!=V&&Vb.eatSpace())return null;var ud=Pc.tokenize(Vb,Pc);if("comment"==Nf)return ud;Pc.lastType="operator"!=Nf||"++"!=Xf&&"--"!=Xf?Nf:"incdec";a:{var Ld=Nf,mf=Xf,pf=Pc.cc;xe.state=Pc;xe.stream=Vb;xe.marked=null;xe.cc=pf;xe.style=ud;Pc.lexical.hasOwnProperty("align")||(Pc.lexical.align=!0);for(Vb=0;;){if(1E5<Vb++)throw Error("endless");if((pf.length?pf.pop():Gf?rb:oc)(Ld,mf)){for(;pf.length&&pf[pf.length-1].lex;)pf.pop()();
if(xe.marked){ud=xe.marked;break a}if(Ld="variable"==Ld)b:{for(Ld=Pc.localVars;Ld;Ld=Ld.next)if(Ld.name==mf){Ld=!0;break b}for(Pc=Pc.context;Pc;Pc=Pc.prev)for(Ld=Pc.vars;Ld;Ld=Ld.next)if(Ld.name==mf){Ld=!0;break b}Ld=void 0}if(Ld){ud="variable-2";break a}break a}}}return ud},indent:function(Vb,Pc){if(Vb.tokenize==V)return vc.passIndent;if(Vb.tokenize!=Ea)return 0;var ud=Pc&&Pc.charAt(0),Ld=Vb.lexical,mf;if(!/^\s*else\b/.test(Pc))for(var pf=Vb.cc.length-1;0<=pf;--pf){var rg=Vb.cc[pf];if(rg==Gd)Ld=
Ld.prev;else if(rg!=pa)break}for(;!("stat"!=Ld.type&&"form"!=Ld.type||"}"!=ud&&(!(mf=Vb.cc[Vb.cc.length-1])||mf!=za&&mf!=Ta||/^[,\.=+\-*:?[\(]/.test(Pc)));)Ld=Ld.prev;Bf&&")"==Ld.type&&"stat"==Ld.prev.type&&(Ld=Ld.prev);mf=Ld.type;pf=ud==mf;return(rg=Vb._string)&&rg.trimLeft().startsWith("?")&&":"===ud?rg.indexOf("?"):rg&&":"===Vb.lastType&&"}"!==Ld.type?rg.match(/^\s*/)[0].length:"vardef"==mf?(Pc=Ld.indented+Ld.info+2+Vb.localVars.name.length,"?"===ud||":"===ud||"|"===ud||"&"===ud?Pc:","==Vb.lastType?
Ld.indented+Ld.info+1:"operator"==Vb.lastType?Pc+3:Ld.indented):"form"==mf&&"{"==ud?Ld.indented:"form"==mf?Ld.indented+wf:"stat"==mf?(ud=Ld.indented,Vb="operator"==Vb.lastType||","==Vb.lastType||Oe.test(Pc.charAt(0))||/[,.]/.test(Pc.charAt(0)),ud+(Vb?Bf||wf:0)):"switch"!=Ld.info||pf||0==Fb.doubleIndentSwitch?Ld.align?Ld.column+(pf?0:1):Ld.indented+(pf?0:wf):Ld.indented+(/^(?:case|default)\b/.test(Pc)?wf:2*wf)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:Gf?null:"/*",blockCommentEnd:Gf?
null:"*/",lineComment:Gf?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:Gf?"json":"javascript",jsonldMode:Wf,jsonMode:Gf,expressionAllowed:vc.expressionAllowed,skipExpression:function(Vb){var Pc=Vb.cc[Vb.cc.length-1];Pc!=rb&&Pc!=Md||Vb.cc.pop()}}});vc.registerHelper("wordChars","javascript",/[\w$]/);vc.defineMIME("text/javascript","javascript");vc.defineMIME("text/ecmascript","javascript");vc.defineMIME("application/javascript","javascript");vc.defineMIME("application/x-javascript",
"javascript");vc.defineMIME("application/ecmascript","javascript");vc.defineMIME("application/json",{name:"javascript",json:!0});vc.defineMIME("application/x-json",{name:"javascript",json:!0});vc.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});vc.defineMIME("text/typescript",{name:"javascript",typescript:!0});vc.defineMIME("application/typescript",{name:"javascript",typescript:!0});var gd=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");gd.string=Bc;gd.JavaScriptChecker=
vb;gd.JavaScriptNavigator=kd;gd.completers=Hb;gd.jsSnippets=Ib;gd.jsIdeCommands=Ub;gd.jsEditorCommands=Ma;gd.astEditorCommands=dc;gd.CodeMirrorEnabledEditorPlugin=jd;gd.Snippet=ec;gd.parser=Mc;gd.localInterface=Jb;gd.systemInterfaceNamed=Dc;gd.serverInterfaceFor=nd;gd.l2lInterfaceFor=Hc;vb=function(Nb){var Fb=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),sb=Fb.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof Fb.JavaScriptEditorPlugin?Fb.JavaScriptEditorPlugin:Fb.JavaScriptEditorPlugin=
function(Ea){Ea&&Ea[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return wb(sb,Nb,[{key:Symbol.for("lively-instance-initialize"),value:function(){wb._get(Object.getPrototypeOf(sb.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new gd.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(Ea){wb._get(Object.getPrototypeOf(sb.prototype),"attach",this).call(this,Ea);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:Ea})}},{key:"detach",value:function(Ea){this.checker.uninstall(this.textMorph);wb._get(Object.getPrototypeOf(sb.prototype),"detach",this).call(this,Ea)}},{key:"getNavigator",value:function(){return new gd.JavaScriptNavigator}},{key:"getCompleters",value:function(Ea){return gd.completers.concat(Ea)}},
{key:"getCommands",value:function(Ea){return[].concat($jscomp.arrayFromIterable(wb._get(Object.getPrototypeOf(sb.prototype),"getCommands",this).call(this,Ea)),$jscomp.arrayFromIterable(gd.jsIdeCommands),$jscomp.arrayFromIterable(gd.jsEditorCommands),$jscomp.arrayFromIterable(gd.astEditorCommands))}},{key:"getKeyBindings",value:function(Ea){return[].concat($jscomp.arrayFromIterable(Ea),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(Ea){var ua=this,V,ra,ja,Ca,va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(cb){V=ua.textMorph;ra=[{command:"doit",target:V,showKeyShortcuts:!0},{command:"inspectit",target:V,showKeyShortcuts:!0},{command:"editit",target:V,showKeyShortcuts:!0},{command:"printit",target:V,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:V,showKeyShortcuts:!0},{command:"eval all",target:V,showKeyShortcuts:!0},{command:"text completion",alias:"code completion",
target:V,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:V,showKeyShortcuts:!0},{isDivider:!0}];ua.evalEnvironment.targetModule&&ra.push({command:"[javascript] inject import",alias:"add import",target:V},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:V},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:V});ja=ua.getNavigator();(Ca=ja.resolveIdentifierAt(V,V.cursorPosition))&&
ra.push({command:"selectDefinition",alias:'jump to definition of "'+Ca.name+'"',target:V},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+Ca.name+'"',target:V});(va=V.selection.text.trim())&&ra.push({command:"open code search",alias:'code search for "'+gd.string.truncate(va,30)+'"',target:V.world(),args:{input:va,backend:ua.backend()}});ra.push({isDivider:!0});return cb.return(ra.concat(Ea))})}},{key:"getSnippets",value:function(){return gd.jsSnippets.map(function(Ea){var ua=
$jscomp.makeIterator(Ea);Ea=ua.next().value;ua=ua.next().value;return new gd.Snippet({trigger:Ea,expansion:ua})})}},{key:"sanatizedJsEnv",value:function(Ea){Ea=Object.assign({},this.evalEnvironment,{},Ea);Ea.format||(Ea.formatd="esm");Ea.context||(Ea.context=this.textMorph);Ea.sourceURL||(Ea.sourceURL=Ea.targetModule+"_doit_"+Date.now());Ea.systemInterface||(Ea.systemInterface=gd.localInterface);return Ea}},{key:"backend",value:function(Ea){Ea=this.sanatizedJsEnv(Ea);return Ea.remote?Ea.remote:"local"}},
{key:"systemInterface",value:function(Ea){return this.sanatizedJsEnv(Ea).systemInterface||gd.localInterface}},{key:"setSystemInterface",value:function(Ea){return this.evalEnvironment.systemInterface=Ea}},{key:"setSystemInterfaceNamed",value:function(Ea){return this.setSystemInterface(gd.systemInterfaceNamed(Ea))}},{key:"runEval",value:function(Ea,ua){ua=this.sanatizedJsEnv(ua);return this.systemInterface(ua).runEval(Ea,ua)}},{key:"parser",get:function(){return gd.parser}},{key:"parse",value:function(Ea){Ea=
void 0===Ea?null:Ea;if(this._ast&&this._ast._astType===Ea)return this._ast;var ua=this.parser,V=this.textMorph.textString;if(!ua)return null;var ra={withComments:!0,allowReturnOutsideFunction:!0};Ea&&(ra.type=Ea);if(V.startsWith("#!")){var ja=V.indexOf("\n");V=" ".repeat(ja)+V.slice(ja)}ua=ua.fuzzyParse(V,ra);ua._astType=Ea;return this._ast=ua}},{key:"undeclaredVariables",value:function(Ea){var ua=this.parser,V=this.evalEnvironment.knownGlobals||[];Ea=this.parse(void 0===Ea?null:Ea);return ua&&Ea?
ua.query.findGlobalVarRefs(Ea,{jslintGlobalComment:!0}).filter(function(ra){return!V.includes(ra.name)}):[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],Fb,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(gd.CodeMirrorEnabledEditorPlugin);
vb=gd.JavaScriptEditorPlugin;Ka("default",vb);gd.default=vb}}});
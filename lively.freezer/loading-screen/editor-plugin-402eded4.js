System.register(["./__root_module__-590131e3.js","./index-2bc8c0f4.js","./index-1bb77cad.js","./editor-plugin-956fead1.js"],function(Sa){var Lb,Vb,Fc,jc,sd,kd,Cd,ed,Zc,bd,yd,ke,ue,He,ld,Wd,gc,cd,Bd,hd,Jd,de,Zb,Ic,Ad;return{setters:[function(Jc){Lb=Jc.i;Vb=Jc.bH;Fc=Jc.bI;jc=Jc.bJ;sd=Jc.bK;kd=Jc.bL;Cd=Jc.c;ed=Jc._;Zc=Jc.s;bd=Jc.a3;yd=Jc.bx;ke=Jc.a;ue=Jc.p;He=Jc.bM;ld=Jc.aY},function(Jc){Wd=Jc.s},function(Jc){gc=Jc.localInterface;cd=Jc.systemInterfaceNamed;Bd=Jc.serverInterfaceFor;hd=Jc.l2lInterfaceFor},
function(Jc){Jd=Jc.p;de=Jc.d;Zb=Jc.a;Ic=Jc.r;Ad=Jc.C}],execute:function(){var Jc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js");Jc.warnStyle={"border-bottom":"2px dotted orange"};Jc.errorStyle={"background-color":"red"};var zd=function(fc){var zc=lively.FreezerRuntime.recorderFor("lively.ide/js/checker.js"),ac=zc.hasOwnProperty("JavaScriptChecker")&&"function"===typeof zc.JavaScriptChecker?zc.JavaScriptChecker:zc.JavaScriptChecker=function(Oa){Oa&&Oa[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(ac,fc,[{key:"uninstall",value:function(Oa){var Da=Oa.text||Oa;(Da.markers||[]).forEach(function(ka){return ka.id.startsWith("js-checker-")&&Da.removeMarker(ka)});Da.removeMarker("js-syntax-error")}},{key:"hasEmbeddedMorphInRange",value:function(Oa,Da){return[].concat($jscomp.arrayFromIterable(Oa.embeddedMorphMap.values())).find(function(ka){return Da.containsPosition(ka.anchor.position)})}},{key:"onDocumentChange",value:function(Oa,
Da,ka){var Ba=Da.document;try{var Ja=ka.parse()}catch(Fb){Ja=Fb}Ja&&(Oa=(Da.markers||[]).filter(function(Fb){return Fb.id.startsWith("js-checker-")}),ka=ka.undeclaredVariables().map(function(Fb,va){var Ka=Fb.start;Fb=Fb.end;Ka=Ba.indexToPosition(Ka);Fb=Ba.indexToPosition(Fb);return Da.addMarker({id:"js-checker-"+va,style:Jc.warnStyle,range:{start:Ka,end:Fb},type:"js-undeclared-var"})}),Oa.slice(ka.length).forEach(function(Fb){return Da.removeMarker(Fb)}),Ja.parseError?(Oa=Ja.parseError.loc,ka=Oa.column,
Oa=Oa.line-1,Ja=Ba.indexToPosition(Ja.parseError.pos),ka=Ja.column,Oa=Ja.row,Ja={start:{column:ka-1,row:Oa},end:{column:ka+1,row:Oa}},this.hasEmbeddedMorphInRange(Da,Ja)||Da.addMarker({id:"js-syntax-error",range:Ja,style:Jc.errorStyle,type:"js-syntax-error"})):Da.removeMarker("js-syntax-error"))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptChecker"}}],zc,{pathInPackage:function(){return"js/checker.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:126,end:1896})}(void 0),Mb=zd=Jc.JavaScriptChecker;Jc.default=zd;var mb=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js");mb.query=Vb;mb.fuzzyParse=Fc;mb.acorn=jc;mb.custom=sd;mb.walk=kd;var Bc=function(fc){var zc=lively.FreezerRuntime.recorderFor("lively.ide/js/navigator.js"),ac=zc.hasOwnProperty("JavaScriptNavigator")&&"function"===typeof zc.JavaScriptNavigator?
zc.JavaScriptNavigator:zc.JavaScriptNavigator=function(Oa){Oa&&Oa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(ac,fc,[{key:"ensureAST",value:function(Oa){return this.parse(Oa.textString)}},{key:"parse",value:function(Oa){return mb.fuzzyParse(Oa)}},{key:"move",value:function(Oa,Da){var ka=!!Da.activeMark||!Da.selection.isEmpty(),Ba=Da.selection,Ja=Da.positionToIndex(Ba.lead);Oa=this[Oa](Da.textString,Ja);Oa=Da.indexToPosition(Oa);
Ba.lead=Oa;ka||(Ba.anchor=Oa);Da.scrollCursorIntoView()}},{key:"forwardSexp",value:function(Oa){this.move("_forwardSexp",Oa)}},{key:"backwardSexp",value:function(Oa){this.move("_backwardSexp",Oa)}},{key:"backwardUpSexp",value:function(Oa){this.move("_backwardUpSexp",Oa)}},{key:"forwardDownSexp",value:function(Oa){this.move("_forwardDownSexp",Oa)}},{key:"_forwardSexp",value:function(Oa,Da){Oa=this.parse(Oa);Oa=mb.custom.findNodesIncluding(Oa,Da).reverse().find(function(Ba){return Ba.end!==Da});if(!Oa)return Da;
if("BlockStatement"===Oa.type){var ka=Oa.body.find(function(Ba){return Ba.start>Da});if(ka)return ka.start}return Oa.end}},{key:"_backwardSexp",value:function(Oa,Da){Oa=this.parse(Oa);Oa=mb.custom.findNodesIncluding(Oa,Da).reverse().find(function(Ba){return Ba.start!==Da});if(!Oa)return Da;if("BlockStatement"===Oa.type){var ka=Oa.body.slice().reverse().find(function(Ba){return Ba.end<Da});if(ka)return ka.end}return Oa?Oa.start:Da}},{key:"_backwardUpSexp",value:function(Oa,Da){Oa=this.parse(Oa);return(Oa=
mb.custom.findNodesIncluding(Oa,Da).reverse().find(function(ka){return ka.start!==Da}))?Oa.start:Da}},{key:"_forwardDownSexp",value:function(Oa,Da){Oa=this.parse(Oa);return(Oa=mb.walk.findNodeAfter(Oa,Da,function(ka,Ba){return Ba.start>Da}))?Oa.node.start:Da}},{key:"markDefun",value:function(Oa){var Da=this.rangeForFunctionOrDefinition(Oa.textString,[Oa.positionToIndex(Oa.selection.range.start),Oa.positionToIndex(Oa.selection.range.end)]);Da&&Oa.execCommand("expandRegion",{start:Da[0],end:Da[1]})}},
{key:"rangeForNodesMatching",value:function(Oa,Da,ka){Oa=this.parse(Oa);return(Da=mb.custom.findNodesIncluding(Oa,Da).reverse().find(ka))?[Da.start,Da.end]:null}},{key:"rangeForFunctionOrDefinition",value:function(Oa,Da){var ka=Da[0]===Da[1];return this.rangeForNodesMatching(Oa,Da[1],function(Ba){return["AssignmentExpression","FunctionDeclaration","FunctionExpression","MethodDefinition"].includes(Ba.type)&&(ka&&Ba.end!==Da[1]||!ka&&Ba.start<Da[0])?!0:!1})}},{key:"resolveIdentifierAt",value:function(Oa,
Da){"number"!==typeof Da&&(Da=Oa.positionToIndex(Da));Oa=this.ensureAST(Oa);var ka=mb.query.nodesAt(Da,Oa).reverse(),Ba=ka.find(function(Fb){return"Identifier"===Fb.type});if(!Ba&&((ka=ka[0])&&ka.type.includes("Specifier")&&ka.local&&"Identifier"===ka.local.type&&(Ba=ka.local),!Ba))return;Da=(ka=mb.query.findDeclarationClosestToIndex(Oa,Ba.name,Da))?mb.query.scopeAtIndex(Oa,ka.start):mb.query.scopeAtIndex(Oa,Da);var Ja=mb.query.findReferencesAndDeclsInScope(Da,Ba.name).refs;return{parsed:Oa,scope:Da,
id:Ba,name:Ba.name,decl:ka,refs:Ja}}},{key:"expandRegion",value:function(Oa,Da,ka,Ba){function Ja(Rb){Rb=Oa.positionToIndex({column:0,row:va.row});return{range:[Rb+Ka.start,Rb+Ka.start+Ka.value.length],prev:Ba}}var Fb=Ba.range[0]!==Ba.range[1],va=Oa.indexToPosition(Ba.range[0]),Ka=Oa.tokenAt(va);if(!Fb&&Ka&&["keyword","identifier"].includes(Ka.type))return Ja();ka=ka||this.parse(Da);Da=mb.query.nodesAtIndex(ka,Ba.range[0]).reverse().find(function(Rb){return Rb.start<Ba.range[0]||Rb.end>Ba.range[1]});
if(!Da)return Ba;ka=Da.start;Fb=Da.end;return"Literal"===Da.type&&(Da.raw||"").match(/^['"`]/)&&Ba.range[0]!==Da.start&&Ba.range[1]!==Da.end&&(Da.start+1<Ba.range[0]||Da.end-1>Ba.range[1])?{range:[ka+1,Fb-1],prev:Ba}:{range:[ka,Fb],prev:Ba}}},{key:"contractRegion",value:function(Oa,Da,ka,Ba){return Ba.prev||Ba}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptNavigator"}}],zc,{pathInPackage:function(){return"js/navigator.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:127,end:6784})}(void 0);zd=Bc=mb.JavaScriptNavigator;mb.default=Bc;var xc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js");xc.addIndexToTextPos=function(fc,zc,ac){return fc.indexToPosition(fc.positionToIndex(zc)+ac)};xc.connect=Cd;xc.disconnect=ed;xc.string=Zc;xc.KeyHandler=bd;xc.Range=yd;Bc=function(fc){var zc=lively.FreezerRuntime.recorderFor("lively.ide/text/snippets.js"),
ac=zc.hasOwnProperty("Snippet")&&"function"===typeof zc.Snippet?zc.Snippet:zc.Snippet=function(Oa){Oa&&Oa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(ac,fc,[{key:Symbol.for("lively-instance-initialize"),value:function(Oa){Oa=void 0===Oa?{trigger:null,expansion:""}:Oa;var Da=Oa.expansion;this.trigger=Oa.trigger;this.expansion=Da;this.resetExpansionState()}},{key:"isTextSnippet",get:function(){return!0}},{key:"attach",value:function(Oa){this.isExpanding&&
(this.textMorph=Oa,xc.connect(this.textMorph,"selectionChange",this,"onCursorMove"))}},{key:"detach",value:function(Oa){this.isExpanding&&(xc.disconnect(Oa,"selectionChange",this,"onCursorMove"),this.textMorph=null)}},{key:"onCursorMove",value:function(){var Oa=this.expansionState,Da=Oa.startAnchor,ka=Oa.endAnchor;Oa.isExpanding?xc.Range.fromPositions(Da.position,ka.position).containsPosition(this.textMorph.cursorPosition)||this.resetExpansionState():this.resetExpansionState()}},{key:"resetExpansionState",
value:function(){var Oa=this.textMorph;if(Oa){var Da=this.expansionState||{},ka=Da.marker,Ba=Da.startAnchor,Ja=Da.endAnchor;Da=Da.steps;Ba&&Oa.removeAnchor(Ba);Ja&&Oa.removeAnchor(Ja);ka&&Oa.removeMarker(ka);Da.forEach(function(Fb){return Oa.removeAnchor(Fb.anchor)})}this.expansionState={stepIndex:-1,steps:[],isExpanding:!1,startMarker:null,endMarker:null};Oa&&Oa.removePlugin(this)}},{key:"isExpanding",get:function(){return this.expansionState.isExpanding}},{key:"createExpansionSteps",value:function(Oa){var Da=
[],ka=0;xc.string.reMatches(Oa,/\$[0-9]+|\$\{[0-9]+:[^\}]*\}/g).forEach(function(Ba){var Ja=Ba.start,Fb=Ba.end;Ba=Ba.match;var va="";Ba.startsWith("${")?(va=$jscomp.makeIterator(Ba.match(/^\$\{([0-9]+):([^\}]*)\}/)),va.next(),Ba=va.next().value,va=va.next().value,Ba=Number(Ba)):Ba=Number(Ba.replace(/^\$/,""));Oa=Oa.slice(0,Ja-ka)+va+Oa.slice(Fb-ka);Da[Ba]={index:Ja-ka,prefill:va,anchor:null};ka+=Fb-Ja-va.length});return{steps:Da,expansion:Oa}}},{key:"expandAtCursor",value:function(Oa){var Da=Oa.selection,
ka=Oa.cursorPosition.column,Ba=this.expansion;this.trigger&&(ka-=this.trigger.length);if(ka=Math.max(0,ka))Ba=xc.string.lines(Ba),Ba=[Ba[0]].concat($jscomp.arrayFromIterable(Ba.slice(1).map(function(eb){return xc.string.indent(eb," ",ka)}))),Ba=Ba.join("\n");var Ja=this.createExpansionSteps(Ba);Ba=Ja.expansion;Ja=Ja.steps;this.trigger&&Da.growLeft(this.trigger.length);Da.text=Ba;var Fb=Da.start;Ba=Da.end;Da.collapseToEnd();if(Ja.length){var va=xc.string.newUUID();Ja.forEach(function(eb,Vc){return eb.anchor=
Oa.addAnchor(Object.assign({id:"snippet-step-"+Vc+"-"+va},xc.addIndexToTextPos(Oa,Fb,eb.index)))});var Ka=Oa.addAnchor(Object.assign({id:"snippet-start-"+va},Fb,{insertBehavior:"stay"})),Rb=Oa.addAnchor(Object.assign({id:"snippet-end-"+va},Ba));this.expansionState={marker:Oa.addMarker({id:"snippet-marker-"+va,get range(){return{start:Ka.position,end:Rb.position}},style:{"border-radius":"4px","background-color":"rgba(30, 200, 140, 0.3)","box-shadow":"0 0 4px rgba(30, 200, 140, 0.3)","pointer-events":"none",
content:"fooooo"}}),startAnchor:Ka,endAnchor:Rb,stepIndex:0,steps:Ja,isExpanding:!0};Oa.addPlugin(this);this.nextStep()}}},{key:"nextStep",value:function(){var Oa=this.expansionState,Da=Oa.steps,ka=this.textMorph;if(Oa.isExpanding&&ka){ka=ka.selection;Oa=Da[Oa.stepIndex];var Ba=Oa.prefill;ka.lead=ka.anchor=Oa.anchor.position;ka.growRight(Ba.length);this.expansionState.stepIndex++;this.expansionState.stepIndex>=Da.length&&(this.resetExpansionState(),console.log("[snippet] expansion of "+this.expansion+
" done"))}}},{key:"canExpand",value:function(Oa,Da){Da=Oa.positionToIndex(Oa.cursorPosition);return Oa.textString.slice(Da-this.trigger.length,Da)===this.trigger}},{key:"tryTrigger",value:function(Oa,Da){if(!this.canExpand(Oa,Oa.cursorPosition))return!1;this.expandAtCursor(Oa);return!0}},{key:"getCommands",value:function(Oa){var Da=this;return Oa.concat([{name:"[snippet] next expansion step",exec:function(ka){Da.nextStep();return!0}},{name:"[snippet] cancel expansion",exec:function(ka){Da.resetExpansionState();
return!0}}])}},{key:"getKeyHandlers",value:function(Oa){return Oa.concat(xc.KeyHandler.withBindings([{keys:"Tab",command:"[snippet] next expansion step"},{keys:"Escape",command:"[snippet] cancel expansion"}]))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Snippet"}}],zc,{pathInPackage:function(){return"text/snippets.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:357,end:6029})}(void 0);xc.Snippet=Bc;xc.Snippet=Bc;xc.Snippet=Bc;var ec=[{name:"get snippets",exec:function(fc){return fc.pluginCollect("getSnippets",[])}}];xc.snippetCommands=ec;xc.snippetCommands=ec;xc.snippetCommands=ec;var Dc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js");Dc.buildEvalOpts=function(fc,zc){return fc.plugins.find(function(ac){return ac.isJSEditorPlugin}).sanatizedJsEnv(zc)};Dc.Snippet=Bc;ec=function(fc){var zc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),
ac=zc.hasOwnProperty("ModuleTopLevelVarCompleter")&&"function"===typeof zc.ModuleTopLevelVarCompleter?zc.ModuleTopLevelVarCompleter:zc.ModuleTopLevelVarCompleter=function(Oa){Oa&&Oa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(ac,fc,[{key:"compute",value:function(Oa,Da){var ka,Ba,Ja,Fb,va,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Rb){if(1==Rb.nextAddress){Ba=(ka=Oa.pluginFind(function(eb){return eb.isJSEditorPlugin}))&&
ka.systemInterface();if(!Ba)return Rb.return([]);Ja=Dc.buildEvalOpts(Oa);Fb=Ja.targetModule;return"local"===Ba.name?(va=Object.getOwnPropertyNames(Ba.getModule(Fb).recorder),Rb.jumpTo(2)):Rb.yield(Ba.runEval('\n        var result, livelySystem = typeof System !== "undefined"\n                      && System.get(System.decanonicalize("lively-system-interface"));\n        if (livelySystem) {\n          result = JSON.stringify(\n            Object.getOwnPropertyNames(livelySystem.localInterface.getModule("'+
Fb+'").recorder));\n        } else {\n          var G = typeof window !== "undefined" ?\n            window : typeof global !== "undefined" ? global : this;\n          result = JSON.stringify(Object.getOwnPropertyNames(G));\n        }\n        result;\n      ',{targetModule:"lively://module-recorder-completer"}),3)}if(2!=Rb.nextAddress){Ka=Rb.yieldResult;if(Ka.isError)return Rb.return([]);va=JSON.parse(Ka.value)}va=va.filter(function(eb){return!eb.startsWith("defVar_")&&!["System","__currentLivelyModule",
"initializeES6ClassForLively","_moduleExport","_moduleImport"].includes(eb)});return Rb.return(va.map(function(eb){return{priority:1100,completion:eb}}))})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ModuleTopLevelVarCompleter"}}],zc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},
{start:227,end:1700})}(void 0);Dc.ModuleTopLevelVarCompleter=ec;Dc.ModuleTopLevelVarCompleter=ec;Dc.ModuleTopLevelVarCompleter=ec;ec=function(fc){var zc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),ac=zc.hasOwnProperty("DynamicJavaScriptCompleter")&&"function"===typeof zc.DynamicJavaScriptCompleter?zc.DynamicJavaScriptCompleter:zc.DynamicJavaScriptCompleter=function(Oa){Oa&&Oa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};
return Lb(ac,fc,[{key:"isValidPrefix",value:function(Oa){return/\.[a-z0-9_]*$/i.test(Oa)}},{key:"isMethodCallCompletion",value:function(Oa){return Oa.endsWith(")")&&0<Oa.indexOf("(")}},{key:"isValidIdentifier",value:function(Oa){if("string"!==typeof Oa)return!1;this.isMethodCallCompletion(Oa)&&(Oa=Oa.slice(0,Oa.indexOf("(")));return/^[a-z_\$][0-9a-z_\$]*$/i.test(Oa)?!0:!1}},{key:"wrapInBrackets",value:function(Oa){if(!isNaN(Number(Oa))||Oa.startsWith("Symbol."))return"["+Oa+"]";var Da="";this.isMethodCallCompletion(Oa)&&
(Da=Oa.slice(Oa.indexOf("(")),Oa=Oa.slice(0,Oa.indexOf("(")));return'["'+Oa.replace(/"/g,'\\"')+'"]'+Da}},{key:"compute",value:function(Oa){var Da=this,ka,Ba,Ja,Fb,va,Ka,Rb,eb,Vc,Qb,qd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wc){if(1==Wc.nextAddress){ka=Oa.selection;ka.isEmpty()?(Ba=Oa.getLine(ka.lead.row),Ba=Ba.slice(Ba.lastIndexOf(":")+1,ka.lead.column)):Ba=ka.text.slice(Math.max(0,ka.text.indexOf(":")),0);if(!Da.isValidPrefix(Ba))return Wc.return([]);Fb=(Ja=Oa.pluginFind(function(Mc){return Mc.isJSEditorPlugin}))&&
Ja.systemInterface();if(!Fb)return Wc.return([]);va=Dc.buildEvalOpts(Oa);return Wc.yield(Fb.dynamicCompletionsForPrefix(va.targetModule,Ba,va),2)}Ka=Wc.yieldResult;Rb=Ka.isError;eb=Ka.value;Vc=Ka.completions;Qb=Ka.prefix;if(Rb)return console.warn("javascript completer encountered error: "+(eb.stack||eb)),Wc.return([]);Vc.reduce(function(Mc,Hb){Hb=$jscomp.makeIterator(Hb);Hb.next();Hb=Hb.next().value;return Mc+Hb.length},0);qd=Vc.reduce(function(Mc,Hb,Xd){Hb=$jscomp.makeIterator(Hb);var Tb=Hb.next().value;
Hb=Hb.next().value;return Mc.concat(Hb.map(function(Gb){var Pa=Da.isValidIdentifier(Gb);return{info:Tb,completion:Gb,prefix:Pa?Qb:"."+Qb,customInsertionFn:Pa?Da.isMethodCallCompletion(Gb)?function(ca,Ha,cb,Pb){Ha=Pb.start;Pb=Pb.end;ca=ca.replace(/\((.*)\)/,function(sc){return"("+sc.slice(1,-1).split(", ").map(function(Xc,Nc){return"${"+Nc+":"+Xc+"}"}).join(", ")+")"});ca=new Dc.Snippet({expansion:ca});cb.replace({start:Ha,end:Pb},"");ca.expandAtCursor(cb)}:null:function(ca,Ha,cb,Pb){ca=Pb.start;Pb=
Pb.end;Ha={row:ca.row,column:ca.column-1};Pb="."===cb.textInRange({start:Ha,end:ca})?{start:Ha,end:Pb}:{start:ca,end:Pb};cb.replace(Pb,Da.wrapInBrackets(Gb))}}}))},[]);qd.forEach(function(Mc,Hb){return Object.assign(Mc,{priority:2E3+qd.length-Hb})});return Wc.return(qd)})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DynamicJavaScriptCompleter"}}],zc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1709,end:5155})}(void 0);Dc.DynamicJavaScriptCompleter=ec;Dc.DynamicJavaScriptCompleter=ec;Dc.DynamicJavaScriptCompleter=ec;Dc.keywords="arguments boolean break case catch class const continue debugger default delete eval export import extends false true finally instanceof static super this throw typeof while with yield await Array Date eval function hasOwnProperty Infinity isFinite isNaN isPrototypeOf length Math NaN name Number Object prototype String toString undefined valueOf alert assign clearInterval clearTimeout decodeURI decodeURIComponent document encodeURI encodeURIComponent escape navigator parseFloat parseInt setInterval setTimeout window document requestAnimationFrame cancelAnimationFrame".split(" ");
ec=function(fc){var zc=lively.FreezerRuntime.recorderFor("lively.ide/js/completers.js"),ac=zc.hasOwnProperty("JavaScriptKeywordCompleter")&&"function"===typeof zc.JavaScriptKeywordCompleter?zc.JavaScriptKeywordCompleter:zc.JavaScriptKeywordCompleter=function(Oa){Oa&&Oa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(ac,fc,[{key:"compute",value:function(Oa,Da){return Dc.keywords.map(function(ka){return{completion:ka,priority:0}})}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptKeywordCompleter"}}],zc,{pathInPackage:function(){return"js/completers.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:6157,end:6295})}(void 0);Dc.JavaScriptKeywordCompleter=ec;Dc.JavaScriptKeywordCompleter=ec;Dc.JavaScriptKeywordCompleter=ec;ec=[new Dc.DynamicJavaScriptCompleter,
new Dc.JavaScriptKeywordCompleter,new Dc.ModuleTopLevelVarCompleter];Dc.completers=ec;Dc.completers=ec;Dc.completers=ec;var Ta=lively.FreezerRuntime.recorderFor("lively.ide/js/snippets.js");Ta.Snippet=Bc;var hc=[["typef",'typeof ${0:object} === "function"$1'],["types",'typeof ${0:object} === "string"$1'],["typen",'typeof ${0:object} === "number"$1'],["typeu",'typeof ${0:object} === "undefined"$1'],["typenu",'typeof ${0:object} !== "undefined"$1'],["import",'import { ${0:name} } from "${1:module}";'],
["importd",'import ${0:name} from "${1:module}";'],["import*",'import * as ${0:name} from "${1:module}";'],["subclass","class ${0:name} extends ${1:base} {\n  constructor(${2:args}) {\n    super(${3:args})\n    $4\n  }\n}"],["class","class ${0:name} {\n  constructor(${1:args}) {\n    $2\n  }\n}"],["switch","switch (${0:expression}) {\n  case '${2:case}':\n    ${3:// code}\n    break;\n    $4\n    default:\n    ${1:// code}\n}"],["tryf","try {${0:/* code */}} finally {}"],["try","try {${0:/* code */}} catch (err) {}"],
["do","do {${1:/* code */}} while (${0:/* condition */});"],["fori","for (let ${0:prop} in ${1:obj}) {\n  ${2:obj[prop]}\n}"],["foro","for (let ${0:value} of ${1:iterable}) {\n  ${2:value}\n}"],["for-","for (let ${0:i} = ${1:list}.length; ${2:i}--; ) {\n  $3\n}"],["for","for (let ${0:i} = 0; ${1:i} < ${3:list}.length; ${2:i}++) {\n  $4\n}"],["Prom","new Promise((resolve, reject) => {$0})"],["keys","Object.keys($0)"],["assign","Object.assign(${0:dest}, ${1:source})"],["stringi","JSON.stringify(${0:object})"],
["forE","forEach(${0:ea} => $1)"],["map","map(${0:ea} => $1)"],["reduce","reduce((${1:all}, ${2:ea}) => {$3}, ${0:init})"],["from","Array.from(${0:list})"],["last","arr.last(${0:list})"],["pluck",'arr.pluck(${0:list}, "${1:key}")'],["sortBy","arr.sortBy(${0:list}, ($1) => $2)"],["join",'join("\\n")'],["con","connect(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["once","once(${0:source}, '${1:sourceAttr}', ${2:target}, '${3:targetAttr}');"],["sig","signal(${0:source}, '${1:sourceAttr}', ${2:value});"],
["ll","lively.lang."],["lls","lively.lang.string."],["lla","lively.lang.arr."],["llo","lively.lang.obj."],["llf","lively.lang.fun."],["llp","lively.lang.promise."],["withA","withAllSubmorphsDo(ea => { return ${0:ea}; })"],["$w","$world"],["$m","$morph('${0:name}')"],["get",'get("${0:name}")'],["$","${$0}"],["cl","console.log($0)"],["cw","console.warn($0)"],["ce","console.error($0)"],["s","show(`$0`);"],["l2lC",'import L2LClient from "lively.2lively/client.js";\nlet l2lClient = L2LClient.default();$0'],
["fun","function ${0:functionName}($1) {$2}"],["fn","function($0) {$1}"],["f","($0) => $1"],["aw","await $0"]];Ta.snippets=hc;Ta.snippets=hc;Ta.snippets=hc;var Eb=lively.FreezerRuntime.recorderFor("lively.ide/js/commands.js");Eb.getEvalEnv=function(fc){return(fc=fc.pluginFind(function(zc){return zc.isJSEditorPlugin}))?fc.evalEnvironment:null};Eb.setEvalEnv=function(fc,zc){(fc=fc.pluginFind(function(ac){return ac.isJSEditorPlugin}))&&Object.assign(fc.evalEnvironment,zc);return fc.evalEnvironment};
Eb.pToI=function(fc,zc){return fc.positionToIndex(zc)};Eb.iToP=function(fc,zc){return fc.indexToPosition(zc)};Eb.arr=ke;Eb.promise=ue;Eb.string=Zc;Eb.show=Wd;Eb.Range=yd;Eb.query=Vb;Eb.BaseVisitor=He;Ta=[{name:"undefine variable",doc:"Finds the variable at cursor position (or position passed) and undefines it in the module toplevel scope.",exec:function(fc,zc){zc=void 0===zc?{varName:null,position:null}:zc;var ac,Oa,Da,ka,Ba,Ja,Fb,va,Ka,Rb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(eb){switch(eb.nextAddress){case 1:ac=
zc;Oa=ac.varName;Da=ac.position;if(!Oa){Da||(Da=fc.cursorPosition);ka=fc.pluginInvokeFirst("getNavigator");Ba=ka.ensureAST(fc);Ja=Eb.query.nodesAt(fc.positionToIndex(Da),Ba).reverse().find(function(Vc){return"Identifier"===Vc.type});if(!Ja)return fc.showError(Error("no identifier found!")),eb.return(!0);Oa=Ja.name}zc=fc.pluginFind(function(Vc){return Vc.isJSEditorPlugin}).sanatizedJsEnv();Fb='lively.modules.module("'+zc.targetModule+'").undefine("'+Oa+'")';eb.setCatchFinallyBlocks(2);return eb.yield(fc.doEval(null,
zc,Fb),4);case 4:va=eb.yieldResult;Ka=va.error?va.error:va.isError?va.value:null;eb.leaveTryBlock(3);break;case 2:Ka=Rb=eb.enterCatchBlock();case 3:return Ka?fc.showError(Ka):fc.setStatusMessage(Oa+" undefined"),eb.return(!0)}})}},{name:"change doitContext",exec:function(fc){var zc,ac,Oa,Da,ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ba){if(1==Ba.nextAddress)return zc=$jscomp,ac=zc.makeIterator,Ba.yield(fc.world().execCommand("select morph",{prompt:"select morph for doitContext",
justReturn:!0,prependItems:["reset"],filterFn:function(Ja){return!Ja.isUsedAsEpiMorph()}}),2);Oa=ac.call(zc,Ba.yieldResult);if(Da=Oa.next().value)ka="reset"===Da,fc.doitContext=ka?null:Da,fc.setStatusMessage(ka?"doitContext is now\n"+Da:"doitContext reset");return Ba.return(!0)})}},{name:"change eval backend",exec:function(fc,zc){zc=void 0===zc?{backend:void 0}:zc;var ac,Oa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){if(1==Da.nextAddress)return ac=zc,Oa=ac.backend,void 0!==Oa?
Da.jumpTo(2):Da.yield(fc.world().prompt("choose eval backend",{historyId:"js-eval-backend-history"}),3);if(2!=Da.nextAddress&&(Oa=Da.yieldResult,!Oa))return fc.setStatusMessage("Canceled"),Da.return(!0);"local"===Oa&&(Oa=null);fc.setStatusMessage("Eval backend is now "+(Oa||"local"));return Da.return(Eb.setEvalEnv(fc,{remote:Oa}))})}},{name:"copy current module name to clipboard",exec:function(fc){var zc=fc.evalEnvironment.targetModule;fc.setStatusMessage(zc||"Cannot find module name");fc.env.eventDispatcher.killRing.add(fc);
fc.env.eventDispatcher.doCopy(zc);return!0}}];Eb.jsEditorCommands=Ta;Eb.jsEditorCommands=Ta;Eb.jsEditorCommands=Ta;var tc=[{name:"[javascript] list errors and warnings",exec:function(fc){var zc,ac,Oa,Da,ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ba){if(1==Ba.nextAddress){zc=(fc.markers||[]).filter(function(Ja){Ja=Ja.type;return"js-undeclared-var"===Ja||"js-syntax-error"===Ja});if(!zc.length)return Eb.show("no warnings or errors"),Ba.return(!0);ac=zc.map(function(Ja){var Fb=Ja.range;
return{isListItem:!0,string:"["+Ja.type.split("-").slice(1).join(" ")+"] "+fc.textInRange(Fb),value:Fb}});return Ba.yield(fc.world().filterableListPrompt("jump to warning or error",ac),2)}Oa=Ba.yieldResult;Da=$jscomp.makeIterator(Oa.selected);if(ka=Da.next().value)fc.saveMark(),fc.selection=ka,fc.centerRow(ka.start.row);return Ba.return(!0)})}},{name:"[javascript] inject import",exec:function(fc,zc){zc=void 0===zc?{gotoImport:!1,insertImportAtCursor:!0}:zc;var ac,Oa,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ka){switch(ka.nextAddress){case 1:return ka.yield(Eb.promise.delay(0),
2);case 2:return ka.yield(System.import("lively.ide/js/import-helper.js"),3);case 3:return ac=ka.yieldResult,Oa=ac.interactivelyInjectImportIntoText,ka.yield(Oa(fc,zc),4);case 4:return(Da=ka.yieldResult)||fc.setStatusMessage("canceled"),ka.return(Da)}})}},{name:"[javascript] fix undeclared variables",exec:function(fc,zc){zc=void 0===zc?{ignore:[],autoApplyIfSingleChoice:!1,requester:fc}:zc;var ac,Oa,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ka){if(1==ka.nextAddress)return ka.yield(System.import("lively.ide/js/import-helper.js"),
2);if(3!=ka.nextAddress)return ac=ka.yieldResult,Oa=ac.interactivlyFixUndeclaredVariables,ka.yield(Oa(fc,zc),3);Da=ka.yieldResult;fc.focus();return ka.return(Da)})}},{name:"[javascript] remove unused imports",exec:function(fc,zc){zc=void 0===zc?{query:!0}:zc;var ac,Oa,Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ka){if(1==ka.nextAddress)return ka.yield(System.import("lively.ide/js/import-helper.js"),2);if(3!=ka.nextAddress)return ac=ka.yieldResult,Oa=ac.cleanupUnusedImports,ka.yield(Oa(fc,
zc),3);Da=ka.yieldResult;fc.setStatusMessage(Da);return ka.return(!0)})}},{name:"[javascript] eslint report",exec:function(fc){var zc,ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oa){if(1==Oa.nextAddress)return Oa.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);zc=Oa.yieldResult;ac=zc.default;try{return Oa.return(ac.reportOnMorph(fc))}catch(Da){fc.showError(Da)}Oa.jumpToEnd()})}},{name:"[javascript] eslint preview fixes",exec:function(fc){var zc,ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Oa){if(1==
Oa.nextAddress)return Oa.yield(System.import("lively.ide/js/eslint/lively-interface.js"),2);zc=Oa.yieldResult;ac=zc.default;try{return Oa.return(ac.previewFixesOnMorph(fc))}catch(Da){fc.showError(Da)}Oa.jumpToEnd()})}},{name:"[javascript] auto format code",handlesCount:!0,exec:function(fc,zc,ac){function Oa(Wc,Mc){Mc||(Mc=va(Wc,{allowReturnOutsideFunction:!0}));var Hb=Eb.string.lineRanges(Wc),Xd=Wc.split("\n"),Tb=[],Gb=new Eb.BaseVisitor,Pa=Gb.visitVariableDeclaration;Gb.visitVariableDeclaration=
function(Pb,sc,Xc){if(1<Pb.declarations.length)for(var Nc=Eb.string.findLineWithIndexInLineRanges(Hb,Pb.start),Ed=Pb.declarations[0].start-Hb[Nc][0],Ld={},Ye=1;Ye<Pb.declarations.length;Ld={$jscomp$loop$prop$actionType$2982:Ld.$jscomp$loop$prop$actionType$2982,$jscomp$loop$prop$arg$2983:Ld.$jscomp$loop$prop$arg$2983},Ye++){var Fe=Pb.declarations[Ye],ye=Eb.string.findLineWithIndexInLineRanges(Hb,Fe.start);if(Nc!==ye){var z=Xd[ye].match(/\s*/)[0].length;z=Ed-z;0!==z&&(Fe=Eb.string.findLineWithIndexInLineRanges(Hb,
Fe.end),Ld.$jscomp$loop$prop$actionType$2982=0<z?"insert":"delete",Ld.$jscomp$loop$prop$arg$2983=0<z?" ".repeat(z):-z,Tb.push.apply(Tb,$jscomp.arrayFromIterable(Eb.arr.range(ye,Fe).map(function(Ke){return function(Ie){return[Ke.$jscomp$loop$prop$actionType$2982,Hb[Ie][0],Ke.$jscomp$loop$prop$arg$2983]}}(Ld)))))}}return Pa.call(Gb,Pb,sc,Xc)};Gb.accept(Mc,{},[]);for(Mc=Tb.length;Mc--;){var ca=$jscomp.makeIterator(Tb[Mc]),Ha=ca.next().value,cb=ca.next().value;ca=ca.next().value;"insert"===Ha?Wc=Wc.slice(0,
cb)+ca+Wc.slice(cb):"delete"===Ha&&(Wc=Wc.slice(0,cb)+Wc.slice(cb+ca))}return Wc}var Da,ka,Ba,Ja,Fb,va,Ka,Rb,eb,Vc,Qb,qd;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Wc){switch(Wc.nextAddress){case 1:return Da=ac||Math.floor(fc.width/fc.defaultCharExtent().width),zc=Object.assign({printWidth:Da,tabWidth:2,useTabs:!1,bracketSpacing:!1},zc),ka=lively.modules.module,Ba=System.normalizeSync("prettier/standalone.js"),Wc.yield(ka(Ba).load({format:"global",instrument:!1}),2);case 2:return Ja=
Wc.yieldResult,Wc.yield(ka("lively.ast/lib/acorn-extension.js").load(),3);case 3:return Wc.yield(ka("lively.ast").load(),4);case 4:return Fb=Wc.yieldResult,va=Fb.parse,Wc.yield(ka("lively.ast/lib/query.js").load(),5);case 5:return Wc.yield(System.import("jsdiff",System.decanonicalize("lively.morphic")),6);case 6:return Ka=Wc.yieldResult,Rb=fc.selection.isEmpty()?fc.documentRange:fc.selection.range,eb=fc.positionToIndex(Rb.start),Vc=fc.positionToIndex(Rb.end),Qb=Ja.format(fc.textString,Object.assign({},
zc,{rangeStart:eb,rangeEnd:Vc,parser:function(Mc,Hb,Xd){return va(Mc,{allowReturnOutsideFunction:!0})}})),fc.undoManager.group(),qd=Ka.diffChars(fc.textString,Qb),fc.applyJsDiffPatch(qd),fc.selection.text=Oa(fc.selection.text),fc.undoManager.group(),Wc.return(!0)}})}}];Eb.jsIdeCommands=tc;Eb.jsIdeCommands=tc;Eb.jsIdeCommands=tc;var Ec=[{name:"selectDefinition",readOnly:!0,bindKey:"Alt-.",exec:function(fc,zc){zc=fc.pluginInvokeFirst("getNavigator");if(!zc)return!0;zc=zc.resolveIdentifierAt(fc,fc.cursorPosition);
if(!zc||!zc.id)return Eb.show("No symbol identifier selected"),!0;if(!zc.decl)return Eb.show("Cannot find declaration of "+zc.name),!0;fc.saveMark();fc.selection={start:fc.indexToPosition(zc.decl.start),end:fc.indexToPosition(zc.decl.end)};fc.scrollCursorIntoView();return!0}},{name:"selectSymbolReferenceOrDeclarationNext",readOnly:!0,multiSelectAction:"single",exec:function(fc){fc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"next"})}},{name:"selectSymbolReferenceOrDeclarationPrev",
readOnly:!0,multiSelectAction:"single",exec:function(fc){fc.execCommand("selectSymbolReferenceOrDeclaration",{direction:"prev"})}},{name:"selectSymbolReferenceOrDeclaration",doc:"Finds the name of the currently selected symbol and will use the JS ast to select references and declarations whose name matches the symbol in the current scope.",readOnly:!0,multiSelectAction:"single",exec:function(fc,zc){zc=void 0===zc?{direction:null}:zc;var ac=fc.pluginInvokeFirst("getNavigator");if(!ac)return!0;ac=ac.resolveIdentifierAt(fc,
fc.cursorPosition);if(!ac||!ac.refs)return Eb.show("No symbol identifier selected"),!0;var Oa=fc.selection;ac=ac.refs.map(function(ka){var Ba=ka.end;return Eb.Range.fromPositions(Eb.iToP(fc,ka.start),Eb.iToP(fc,Ba))}).concat(ac.decl?Eb.Range.fromPositions(Eb.iToP(fc,ac.decl.start),Eb.iToP(fc,ac.decl.end)):[]).sort(Eb.Range.compare);if(!ac.length)return!0;var Da=ac.map(String).indexOf(String(Oa.range));if("next"===zc.direction||"prev"===zc.direction)-1===Da&&ac.length?ac=[ac[0]]:(zc=Da+("next"===zc.direction?
1:-1),0>zc?zc=ac.length-1:zc>=ac.length&&(zc=0),ac=[ac[zc]]);ac.forEach(function(ka){var Ba=Oa.selections.findIndex(function(Fb){return Fb.range.equals(ka)}),Ja=Oa.selections.length-1;-1<Ba?Eb.arr.swap(Oa.selections,Ba,Ja):Oa.addRange(ka,!1)});Oa.mergeSelections();return!0}}];Eb.astEditorCommands=Ec;Eb.astEditorCommands=Ec;Eb.astEditorCommands=Ec;lively.modules&&!lively.FreezerRuntime&&lively.modules.module("lively.ide/js/editor-plugin.js").reload({reloadDeps:!1,resetEnv:!1});var ad=lively.FreezerRuntime.recorderFor("lively.ide/js/mode.js");
ad.expressionAllowed=function(fc,zc,ac){return/^(?:operator|sof|keyword c|case|new|export|default|[\[{}\(,;:]|=>)$/.test(zc.lastType)||"quasi"==zc.lastType&&/\{\s*$/.test(fc.string.slice(0,fc.pos-(ac||0)))};ad.passIndent=Jd;ad.defineMode=de;ad.defineMIME=Zb;ad.registerHelper=Ic;ad.defaultConfig={indentUnit:2};ad.defaultParserConfig={name:"javascript",statementIndent:2,jsonld:!1,json:!1,typescript:!1,wordCharacters:/[\w$\xa1-\uffff]/,globalVars:[],localVars:[],doubleIndentSwitch:null};ad.defineMode("javascript",
function(fc,zc){function ac(vc,od,be){cg=vc;og=be;return od}function Oa(vc,od){var be=vc.next();if('"'==be||"'"==be)return od.tokenize=Da(be),od.tokenize(vc,od);if("."==be&&vc.match(/^\d+(?:[eE][+\-]?\d+)?/))return ac("number","number");if("."==be&&vc.match(".."))return ac("spread","meta");if(/[\[\]{}\(\),;:\.]/.test(be))return ac(be);if("="==be&&vc.eat(">"))return ac("=>","operator");if("0"==be&&vc.eat(/x/i))return vc.eatWhile(/[\da-f]/i),ac("number","number");if("0"==be&&vc.eat(/o/i))return vc.eatWhile(/[0-7]/i),
ac("number","number");if("0"==be&&vc.eat(/b/i))return vc.eatWhile(/[01]/i),ac("number","number");if(/\d/.test(be))return vc.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),ac("number","number");if("/"==be){if(vc.eat("*"))return od.tokenize=ka,ka(vc,od);if(vc.eat("/"))return vc.skipToEnd(),ac("comment","comment");if(ad.expressionAllowed(vc,od,1)){a:for(var Hd=od=!1;null!=(be=vc.next());){if(!od){if("/"==be&&!Hd)break a;"["==be?Hd=!0:Hd&&"]"==be&&(Hd=!1)}od=!od&&"\\"==be}vc.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);
return ac("regexp","string-2")}vc.eatWhile(Ng);return ac("operator","operator",vc.current())}if("`"==be)return od.tokenize=Ba,Ba(vc,od);if("#"==be)return vc.skipToEnd(),ac("error","error");if(Ng.test(be))return">"==be&&od.lexical&&">"==od.lexical.type||vc.eatWhile(Ng),ac("operator","operator",vc.current());if(th.test(be))return vc.eatWhile(th),vc=vc.current(),(be=gi.propertyIsEnumerable(vc)&&gi[vc])&&"."!=od.lastType?ac(be.type,be.style,vc):ac("variable","variable",vc)}function Da(vc){return function(od,
be){var Hd=!1,sf;if(Mg&&"@"==od.peek()&&od.match(zf))return be.tokenize=Oa,ac("jsonld-keyword","meta");for(;null!=(sf=od.next())&&(sf!=vc||Hd);)Hd=!Hd&&"\\"==sf;Hd||(be.tokenize=Oa);return ac("string","string")}}function ka(vc,od){for(var be=!1,Hd;Hd=vc.next();){if("/"==Hd&&be){od.tokenize=Oa;break}be="*"==Hd}return ac("comment","comment")}function Ba(vc,od){for(var be=!1,Hd;null!=(Hd=vc.next());){if(!be&&("`"==Hd||"$"==Hd&&vc.eat("{"))){od.tokenize=Oa;break}be=!be&&"\\"==Hd}return ac("quasi","string-2",
vc.current())}function Ja(vc,od){od.fatArrowAt&&(od.fatArrowAt=null);var be=vc.string.indexOf("=>",vc.start);if(!(0>be)){if(wf){var Hd=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(vc.string.slice(vc.start,be));Hd&&(be=Hd.index)}Hd=0;var sf=!1;for(--be;0<=be;--be){var $f=vc.string.charAt(be),dg="([{}])".indexOf($f);if(0<=dg&&3>dg){if(!Hd){++be;break}if(0==--Hd){"("==$f&&(sf=!0);break}}else if(3<=dg&&6>dg)++Hd;else if(th.test($f))sf=!0;else{if(/["'\/]/.test($f))return;if(sf&&!Hd){++be;break}}}sf&&
!Hd&&(od.fatArrowAt=be)}}function Fb(vc,od,be,Hd,sf,$f){this.indented=vc;this.column=od;this.type=be;this.prev=sf;this.info=$f;null!=Hd&&(this.align=Hd)}function va(){for(var vc=arguments.length-1;0<=vc;vc--)Le.cc.push(arguments[vc])}function Ka(){va.apply(null,arguments);return!0}function Rb(vc){function od(Hd){for(;Hd;Hd=Hd.next)if(Hd.name==vc)return!0;return!1}var be=Le.state;Le.marked="def";be.context?od(be.localVars)||(be.localVars={name:vc,next:be.localVars}):!od(be.globalVars)&&zc.globalVars&&
(be.globalVars={name:vc,next:be.globalVars})}function eb(){Le.state.context={prev:Le.state.context,vars:Le.state.localVars};Le.state.localVars=hi}function Vc(){Le.state.localVars=Le.state.context.vars;Le.state.context=Le.state.context.prev}function Qb(vc,od){var be=function(){var Hd=Le.state,sf=Hd.indented;if("stat"==Hd.lexical.type)sf=Hd.lexical.indented;else for(var $f=Hd.lexical;$f&&")"==$f.type&&$f.align;$f=$f.prev)sf=$f.indented;Hd.lexical=new Fb(sf,Le.stream.column(),vc,null,Hd.lexical,od)};
be.lex=!0;return be}function qd(){var vc=Le.state;vc.lexical.prev&&(")"==vc.lexical.type&&(vc.indented=vc.lexical.indented),vc.lexical=vc.lexical.prev)}function Wc(vc){function od(be){return be==vc?Ka():";"==vc?va():Ka(od)}return od}function Mc(vc,od){return"var"==vc?Ka(Qb("vardef",od.length),Sd,Wc(";"),qd):"keyword a"==vc?Ka(Qb("form"),Tb,Mc,qd):"keyword b"==vc?Ka(Qb("form"),Mc,qd):"{"==vc?Ka(Qb("}"),hf,qd):";"==vc?Ka():"if"==vc?("else"==Le.state.lexical.info&&Le.state.cc[Le.state.cc.length-1]==
qd&&Le.state.cc.pop()(),Ka(Qb("form"),Tb,Mc,qd,za)):"function"==vc?Ka(La):"for"==vc?Ka(Qb("form"),Fa,Mc,qd):"variable"==vc?wf&&"type"==od?(Le.marked="keyword",Ka(yf,Wc("operator"),yf,Wc(";"))):Ka(Qb("stat"),Fe):"switch"==vc?Ka(Qb("form"),Tb,Wc("{"),Qb("}","switch"),hf,qd,qd):"case"==vc?Ka(Hb,Wc(":")):"default"==vc?Ka(Wc(":")):"catch"==vc?Ka(Qb("form"),eb,Wc("("),Wa,Wc(")"),Mc,qd,Vc):"class"==vc?Ka(Qb("form"),rc,qd):"export"==vc?Ka(Qb("stat"),rd,qd):"import"==vc?Ka(Qb("stat"),se,qd):"module"==vc?Ka(Qb("form"),
oe,Wc("{"),Qb("}"),hf,qd,qd):"async"==vc?Ka(Mc):"@"==od?Ka(Hb,Mc):va(Qb("stat"),Hb,Wc(";"),qd)}function Hb(vc){return Gb(vc,!1)}function Xd(vc){return Gb(vc,!0)}function Tb(vc){return"("!=vc?va():Ka(Qb(")"),Hb,Wc(")"),qd)}function Gb(vc,od){if(Le.state.fatArrowAt==Le.stream.start){var be=od?Nc:Xc;if("("==vc)return Ka(eb,Qb(")"),$d(oe,")"),qd,Wc("=>"),be,Vc);if("variable"==vc)return va(eb,oe,Wc("=>"),be,Vc)}be=od?cb:Ha;return qh.hasOwnProperty(vc)?Ka(be):"function"==vc?Ka(La,be):"class"==vc?Ka(Qb("form"),
Jb,qd):"keyword c"==vc||"async"==vc?Ka(od?ca:Pa):"("==vc?Ka(Qb(")"),Pa,Wc(")"),qd,be):"operator"==vc||"spread"==vc?Ka(od?Xd:Hb):"["==vc?Ka(Qb("]"),jf,qd,be):"{"==vc?Ze(z,"}",null,be):"quasi"==vc?va(Pb,be):"new"==vc?Ka(Ed(od)):Ka()}function Pa(vc){return vc.match(/[;\}\)\],]/)?va():va(Hb)}function ca(vc){return vc.match(/[;\}\)\],]/)?va():va(Xd)}function Ha(vc,od){return","==vc?Ka(Hb):cb(vc,od,!1)}function cb(vc,od,be){var Hd=0==be?Ha:cb,sf=0==be?Hb:Xd;if("=>"==vc)return Ka(eb,be?Nc:Xc,Vc);if("operator"==
vc)return/\+\+|--/.test(od)?Ka(Hd):"?"==od?Ka(Hb,Wc(":"),sf):Ka(sf);if("quasi"==vc)return va(Pb,Hd);if(";"!=vc){if("("==vc)return Ze(Xd,")","call",Hd);if("."==vc)return Ka(ye,Hd);if("["==vc)return Ka(Qb("]"),Pa,Wc("]"),qd,Hd)}}function Pb(vc,od){return"quasi"!=vc?va():"${"!=od.slice(od.length-2)?Ka(Pb):Ka(Hb,sc)}function sc(vc){if("}"==vc)return Le.marked="string-2",Le.state.tokenize=Ba,Ka(Pb)}function Xc(vc){Ja(Le.stream,Le.state);return va("{"==vc?Mc:Hb)}function Nc(vc){Ja(Le.stream,Le.state);return va("{"==
vc?Mc:Xd)}function Ed(vc){return function(od){return"."==od?Ka(vc?Ye:Ld):va(vc?Xd:Hb)}}function Ld(vc,od){if("target"==od)return Le.marked="keyword",Ka(Ha)}function Ye(vc,od){if("target"==od)return Le.marked="keyword",Ka(cb)}function Fe(vc){return":"==vc?Ka(qd,Mc):va(Ha,Wc(";"),qd)}function ye(vc){if("variable"==vc)return Le.marked="property",Ka()}function z(vc,od){if("async"==vc)return Le.marked="property",Ka(z);if("variable"==vc||"keyword"==Le.style)return Le.marked="property","get"==od||"set"==
od?Ka(Ke):Ka(Ie);if("number"==vc||"string"==vc)return Le.marked=Mg?"property":Le.style+" property",Ka(Ie);if("jsonld-keyword"==vc)return Ka(Ie);if("modifier"==vc)return Ka(z);if("["==vc)return Ka(Hb,Wc("]"),Ie);if("spread"==vc)return Ka(Hb);if(":"==vc)return va(Ie)}function Ke(vc){if("variable"!=vc)return va(Ie);Le.marked="property";return Ka(La)}function Ie(vc){if(":"==vc)return Ka(Xd);if("("==vc)return va(La)}function $d(vc,od,be){function Hd(sf,$f){return(be?-1<be.indexOf(sf):","==sf)?(sf=Le.state.lexical,
"call"==sf.info&&(sf.pos=(sf.pos||0)+1),Ka(function(dg,pl){return dg==od||pl==od?va():va(vc)},Hd)):sf==od||$f==od?Ka():Ka(Wc(od))}return function(sf,$f){return sf==od||$f==od?Ka():va(vc,Hd)}}function Ze(vc,od,be){for(var Hd=3;Hd<arguments.length;Hd++)Le.cc.push(arguments[Hd]);return Ka(Qb(od,be),$d(vc,od),qd)}function hf(vc){return"}"==vc?Ka():va(Mc,hf)}function kf(vc,od){if(wf){if(":"==vc)return Ka(yf);if("?"==od)return Ka(kf)}}function yf(vc){if("variable"==vc)return Le.marked="variable-3",Ka(qf);
if("string"==vc||"number"==vc||"atom"==vc)return Ka(qf);if("{"==vc)return Ka(Qb("}"),$d(qc,"}",",;"),qd);if("("==vc)return Ka($d(ji,")"),hg)}function hg(vc){if("=>"==vc)return Ka(yf)}function qc(vc,od){if("variable"==vc||"keyword"==Le.style)return Le.marked="property",Ka(qc);if("?"==od)return Ka(qc);if(":"==vc)return Ka(yf)}function ji(vc){if("variable"==vc)return Ka(ji);if(":"==vc)return Ka(yf)}function qf(vc,od){if("<"==od)return Ka(Qb(">"),$d(yf,">"),qd,qf);if("|"==od||"."==vc)return Ka(yf);if("["==
vc)return Ka(Wc("]"),qf);if("extends"==od)return Ka(yf)}function Sd(){return va(oe,kf,fb,dc)}function oe(vc,od){if("modifier"==vc)return Ka(oe);if("variable"==vc)return Rb(od),Ka();if("spread"==vc)return Ka(oe);if("["==vc)return Ze(oe,"]");if("{"==vc)return Ze(Ma,"}")}function Ma(vc,od){if("variable"==vc&&!Le.stream.match(/^\s*:/,!1))return Rb(od),Ka(fb);"variable"==vc&&(Le.marked="property");return"spread"==vc?Ka(oe):"}"==vc?va():Ka(Wc(":"),oe,fb)}function fb(vc,od){if("="==od)return Ka(Xd)}function dc(vc){if(","==
vc)return Ka(Sd)}function za(vc,od){if("keyword b"==vc&&"else"==od)return Ka(Qb("form","else"),Mc,qd)}function Fa(vc){if("("==vc)return Ka(Qb(")"),Na,Wc(")"),qd)}function Na(vc){return"var"==vc?Ka(Sd,Wc(";"),Db):";"==vc?Ka(Db):"variable"==vc?Ka(fa):va(Hb,Wc(";"),Db)}function fa(vc,od){return"in"==od||"of"==od?(Le.marked="keyword",Ka(Hb)):Ka(Ha,Db)}function Db(vc,od){return";"==vc?Ka(sa):"in"==od||"of"==od?(Le.marked="keyword",Ka(Hb)):va(Hb,Wc(";"),sa)}function sa(vc){")"!=vc&&Ka(Hb)}function La(vc,
od){if("*"==od)return Le.marked="keyword",Ka(La);if("variable"==vc)return Rb(od),Ka(La);if("("==vc)return Ka(eb,Qb(")"),$d(Wa,")"),qd,kf,Mc,Vc);if(wf&&"<"==od)return Ka(Qb(">"),$d(yf,">"),qd,La)}function Wa(vc){return"spread"==vc?Ka(Wa):va(oe,kf,fb)}function Jb(vc,od){return"variable"==vc?rc(vc,od):Lc(vc,od)}function rc(vc,od){if("variable"==vc)return Rb(od),Ka(Lc)}function Lc(vc,od){if("<"==od)return Ka(Qb(">"),$d(yf,">"),qd,Lc);if("extends"==od||"implements"==od||wf&&","==vc)return Ka(wf?yf:Hb,
Lc);if("{"==vc)return Ka(Qb("}"),Sc,qd)}function Sc(vc,od){if("variable"==vc||"keyword"==Le.style){if(("async"==od||"static"==od||"get"==od||"set"==od||wf&&("public"==od||"private"==od||"protected"==od||"readonly"==od||"abstract"==od))&&Le.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Le.marked="keyword",Ka(Sc);Le.marked="property";return Ka(wf?Rc:La,Sc)}if("["==vc)return Ka(Hb,Wc("]"),wf?Rc:La,Sc);if("*"==od)return Le.marked="keyword",Ka(Sc);if(";"==vc)return Ka(Sc);if("}"==vc)return Ka();if("@"==
od)return Ka(Hb,Sc)}function Rc(vc,od){return"?"==od?Ka(Rc):":"==vc?Ka(yf,fb):"="==od?Ka(Xd):va(La)}function rd(vc,od){return"*"==od?(Le.marked="keyword",Ka(ge,Wc(";"))):"default"==od?(Le.marked="keyword",Ka(Hb,Wc(";"))):"{"==vc?Ka($d(Vd,"}"),ge,Wc(";")):va(Mc)}function Vd(vc,od){if("as"==od)return Le.marked="keyword",Ka(Wc("variable"));if("variable"==vc)return va(Xd,Vd)}function se(vc){return"string"==vc?Ka():va(Kd,Ee,ge)}function Kd(vc,od){if("{"==vc)return Ze(Kd,"}");"variable"==vc&&Rb(od);"*"==
od&&(Le.marked="keyword");return Ka(le)}function Ee(vc){if(","==vc)return Ka(Kd,Ee)}function le(vc,od){if("as"==od)return Le.marked="keyword",Ka(Kd)}function ge(vc,od){if("from"==od)return Le.marked="keyword",Ka(Hb)}function jf(vc){return"]"==vc?Ka():va($d(Xd,"]"))}fc=Object.assign({},ad.defaultConfig,{},fc);zc=Object.assign({},ad.defaultParserConfig,{},zc);var Sf=fc.indentUnit,Ug=zc.statementIndent,Mg=zc.jsonld,Xf=zc.json||Mg,wf=zc.typescript,th=zc.wordCharacters||/[\w$\xa1-\uffff]/,gi=function(){function vc(pl){return{type:pl,
style:"keyword"}}var od=vc("keyword a"),be=vc("keyword b"),Hd=vc("keyword c"),sf=vc("operator"),$f={type:"atom",style:"atom"};od={if:vc("if"),while:od,with:od,else:be,do:be,try:be,finally:be,return:Hd,break:Hd,continue:Hd,new:vc("new"),delete:Hd,throw:Hd,debugger:Hd,var:vc("var"),const:vc("var"),let:vc("var"),function:vc("function"),catch:vc("catch"),for:vc("for"),switch:vc("switch"),case:vc("case"),default:vc("default"),in:sf,typeof:sf,instanceof:sf,true:$f,false:$f,null:$f,undefined:$f,NaN:$f,Infinity:$f,
this:vc("this"),class:vc("class"),super:vc("atom"),yield:Hd,export:vc("export"),import:vc("import"),extends:Hd,await:Hd,async:vc("async")};if(wf){be={type:"variable",style:"variable-3"};Hd={interface:vc("class"),implements:Hd,namespace:Hd,module:vc("module"),enum:vc("module"),public:vc("modifier"),private:vc("modifier"),protected:vc("modifier"),abstract:vc("modifier"),as:sf,string:be,number:be,boolean:be,any:be};for(var dg in Hd)od[dg]=Hd[dg]}return od}(),Ng=/[+\-*&%=<>!?|~^@]/,zf=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,
cg,og,qh={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},Le={state:null,column:null,marked:null,cc:null},hi={name:"this",next:{name:"arguments"}};qd.lex=!0;return{startState:function(vc){vc={tokenize:Oa,lastType:"sof",cc:[],lexical:new Fb((vc||0)-Sf,0,"block",!1),localVars:zc.localVars,context:zc.localVars&&{vars:zc.localVars},indented:vc||0};zc.globalVars&&"object"===typeof zc.globalVars&&(vc.globalVars=zc.globalVars);return vc},token:function(vc,od){vc.sol()&&(od.lexical.hasOwnProperty("align")||
(od.lexical.align=!1),od.indented=vc.indentation(),Ja(vc,od));if(od.tokenize!=ka&&vc.eatSpace())return null;var be=od.tokenize(vc,od);if("comment"==cg)return be;od.lastType="operator"!=cg||"++"!=og&&"--"!=og?cg:"incdec";a:{var Hd=cg,sf=og,$f=od.cc;Le.state=od;Le.stream=vc;Le.marked=null;Le.cc=$f;Le.style=be;od.lexical.hasOwnProperty("align")||(od.lexical.align=!0);for(vc=0;;){if(1E5<vc++)throw Error("endless");if(($f.length?$f.pop():Xf?Hb:Mc)(Hd,sf)){for(;$f.length&&$f[$f.length-1].lex;)$f.pop()();
if(Le.marked){be=Le.marked;break a}if(Hd="variable"==Hd)b:{for(Hd=od.localVars;Hd;Hd=Hd.next)if(Hd.name==sf){Hd=!0;break b}for(od=od.context;od;od=od.prev)for(Hd=od.vars;Hd;Hd=Hd.next)if(Hd.name==sf){Hd=!0;break b}Hd=void 0}if(Hd){be="variable-2";break a}break a}}}return be},indent:function(vc,od){if(vc.tokenize==ka)return ad.passIndent;if(vc.tokenize!=Oa)return 0;var be=od&&od.charAt(0),Hd=vc.lexical,sf;if(!/^\s*else\b/.test(od))for(var $f=vc.cc.length-1;0<=$f;--$f){var dg=vc.cc[$f];if(dg==qd)Hd=
Hd.prev;else if(dg!=za)break}for(;!("stat"!=Hd.type&&"form"!=Hd.type||"}"!=be&&(!(sf=vc.cc[vc.cc.length-1])||sf!=Ha&&sf!=cb||/^[,\.=+\-*:?[\(]/.test(od)));)Hd=Hd.prev;Ug&&")"==Hd.type&&"stat"==Hd.prev.type&&(Hd=Hd.prev);sf=Hd.type;$f=be==sf;return(dg=vc._string)&&dg.trimLeft().startsWith("?")&&":"===be?dg.indexOf("?"):dg&&":"===vc.lastType&&"}"!==Hd.type?dg.match(/^\s*/)[0].length:"vardef"==sf?(od=Hd.indented+Hd.info+2+vc.localVars.name.length,"?"===be||":"===be||"|"===be||"&"===be?od:","==vc.lastType?
Hd.indented+Hd.info+1:"operator"==vc.lastType?od+3:Hd.indented):"form"==sf&&"{"==be?Hd.indented:"form"==sf?Hd.indented+Sf:"stat"==sf?(be=Hd.indented,vc="operator"==vc.lastType||","==vc.lastType||Ng.test(od.charAt(0))||/[,.]/.test(od.charAt(0)),be+(vc?Ug||Sf:0)):"switch"!=Hd.info||$f||0==zc.doubleIndentSwitch?Hd.align?Hd.column+($f?0:1):Hd.indented+($f?0:Sf):Hd.indented+(/^(?:case|default)\b/.test(od)?Sf:2*Sf)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:Xf?null:"/*",blockCommentEnd:Xf?
null:"*/",lineComment:Xf?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:Xf?"json":"javascript",jsonldMode:Mg,jsonMode:Xf,expressionAllowed:ad.expressionAllowed,skipExpression:function(vc){var od=vc.cc[vc.cc.length-1];od!=Hb&&od!=Xd||vc.cc.pop()}}});ad.registerHelper("wordChars","javascript",/[\w$]/);ad.defineMIME("text/javascript","javascript");ad.defineMIME("text/ecmascript","javascript");ad.defineMIME("application/javascript","javascript");ad.defineMIME("application/x-javascript",
"javascript");ad.defineMIME("application/ecmascript","javascript");ad.defineMIME("application/json",{name:"javascript",json:!0});ad.defineMIME("application/x-json",{name:"javascript",json:!0});ad.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});ad.defineMIME("text/typescript",{name:"javascript",typescript:!0});ad.defineMIME("application/typescript",{name:"javascript",typescript:!0});var td=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js");td.string=Zc;td.JavaScriptChecker=
Mb;td.JavaScriptNavigator=zd;td.completers=ec;td.jsSnippets=hc;td.jsIdeCommands=tc;td.jsEditorCommands=Ta;td.astEditorCommands=Ec;td.CodeMirrorEnabledEditorPlugin=Ad;td.Snippet=Bc;td.parser=ld;td.localInterface=gc;td.systemInterfaceNamed=cd;td.serverInterfaceFor=Bd;td.l2lInterfaceFor=hd;Mb=function(fc){var zc=lively.FreezerRuntime.recorderFor("lively.ide/js/editor-plugin.js"),ac=zc.hasOwnProperty("JavaScriptEditorPlugin")&&"function"===typeof zc.JavaScriptEditorPlugin?zc.JavaScriptEditorPlugin:zc.JavaScriptEditorPlugin=
function(Oa){Oa&&Oa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Lb(ac,fc,[{key:Symbol.for("lively-instance-initialize"),value:function(){Lb._get(Object.getPrototypeOf(ac.prototype),Symbol.for("lively-instance-initialize"),this).call(this);this.checker=new td.JavaScriptChecker;this.evalEnvironment={format:"esm",targetModule:null,context:null}}},{key:"isJSEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return"js"}},
{key:"longName",get:function(){return"javascript"}},{key:"attach",value:function(Oa){Lb._get(Object.getPrototypeOf(ac.prototype),"attach",this).call(this,Oa);this.evalEnvironment=Object.assign({},this.evalEnvironment,{context:Oa})}},{key:"detach",value:function(Oa){this.checker.uninstall(this.textMorph);Lb._get(Object.getPrototypeOf(ac.prototype),"detach",this).call(this,Oa)}},{key:"getNavigator",value:function(){return new td.JavaScriptNavigator}},{key:"getCompleters",value:function(Oa){return td.completers.concat(Oa)}},
{key:"getCommands",value:function(Oa){return[].concat($jscomp.arrayFromIterable(Lb._get(Object.getPrototypeOf(ac.prototype),"getCommands",this).call(this,Oa)),$jscomp.arrayFromIterable(td.jsIdeCommands),$jscomp.arrayFromIterable(td.jsEditorCommands),$jscomp.arrayFromIterable(td.astEditorCommands))}},{key:"getKeyBindings",value:function(Oa){return[].concat($jscomp.arrayFromIterable(Oa),[{keys:"Shift-Tab",command:{command:"[javascript] auto format code"}},{keys:"Ctrl-C E",command:"[javascript] list errors and warnings"},
{keys:{mac:"Meta-Shift-L L I N T R",win:"Ctrl-Shift-L L I N T R"},command:"[javascript] eslint report"},{keys:{mac:"Meta-Shift-L L I N T P",win:"Ctrl-Shift-L L I N T P"},command:"[javascript] eslint preview fixes"},{keys:{mac:"Meta-Shift-L L I N T F",win:"Ctrl-Shift-L L I N T F"},command:"[javascript] eslint fix"},{keys:{mac:"Meta-Shift-L M O D E",win:"Ctrl-Shift-L M O D E"},command:"change editor mode"},{keys:"Ctrl-C I",command:"[javascript] inject import"},{keys:"Ctrl-C C I",command:"[javascript] fix undeclared variables"}])}},
{key:"getMenuItems",value:function(Oa){var Da=this,ka,Ba,Ja,Fb,va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){ka=Da.textMorph;Ba=[{command:"doit",target:ka,showKeyShortcuts:!0},{command:"inspectit",target:ka,showKeyShortcuts:!0},{command:"editit",target:ka,showKeyShortcuts:!0},{command:"printit",target:ka,showKeyShortcuts:!0},{command:"print inspectit",alias:"print inspect",target:ka,showKeyShortcuts:!0},{command:"eval all",target:ka,showKeyShortcuts:!0},{command:"text completion",
alias:"code completion",target:ka,showKeyShortcuts:!0},{command:"[javascript] list errors and warnings",alias:"list errors and warnings",target:ka,showKeyShortcuts:!0},{isDivider:!0}];Da.evalEnvironment.targetModule&&Ba.push({command:"[javascript] inject import",alias:"add import",target:ka},{command:"[javascript] fix undeclared variables",alias:"fix undeclared variables",target:ka},{command:"[javascript] remove unused imports",alias:"remove unused imports",target:ka});Ja=Da.getNavigator();(Fb=Ja.resolveIdentifierAt(ka,
ka.cursorPosition))&&Ba.push({command:"selectDefinition",alias:'jump to definition of "'+Fb.name+'"',target:ka},{command:"selectSymbolReferenceOrDeclaration",alias:'select all occurrences of "'+Fb.name+'"',target:ka});(va=ka.selection.text.trim())&&Ba.push({command:"open code search",alias:'code search for "'+td.string.truncate(va,30)+'"',target:ka.world(),args:{input:va,backend:Da.backend()}});Ba.push({isDivider:!0});return Ka.return(Ba.concat(Oa))})}},{key:"getSnippets",value:function(){return td.jsSnippets.map(function(Oa){var Da=
$jscomp.makeIterator(Oa);Oa=Da.next().value;Da=Da.next().value;return new td.Snippet({trigger:Oa,expansion:Da})})}},{key:"sanatizedJsEnv",value:function(Oa){Oa=Object.assign({},this.evalEnvironment,{},Oa);Oa.format||(Oa.formatd="esm");Oa.context||(Oa.context=this.textMorph);Oa.sourceURL||(Oa.sourceURL=Oa.targetModule+"_doit_"+Date.now());Oa.systemInterface||(Oa.systemInterface=td.localInterface);return Oa}},{key:"backend",value:function(Oa){Oa=this.sanatizedJsEnv(Oa);return Oa.remote?Oa.remote:"local"}},
{key:"systemInterface",value:function(Oa){return this.sanatizedJsEnv(Oa).systemInterface||td.localInterface}},{key:"setSystemInterface",value:function(Oa){return this.evalEnvironment.systemInterface=Oa}},{key:"setSystemInterfaceNamed",value:function(Oa){return this.setSystemInterface(td.systemInterfaceNamed(Oa))}},{key:"runEval",value:function(Oa,Da){Da=this.sanatizedJsEnv(Da);return this.systemInterface(Da).runEval(Oa,Da)}},{key:"parser",get:function(){return td.parser}},{key:"parse",value:function(Oa){Oa=
void 0===Oa?null:Oa;if(this._ast&&this._ast._astType===Oa)return this._ast;var Da=this.parser,ka=this.textMorph.textString;if(!Da)return null;var Ba={withComments:!0,allowReturnOutsideFunction:!0};Oa&&(Ba.type=Oa);if(ka.startsWith("#!")){var Ja=ka.indexOf("\n");ka=" ".repeat(Ja)+ka.slice(Ja)}Da=Da.fuzzyParse(ka,Ba);Da._astType=Oa;return this._ast=Da}},{key:"undeclaredVariables",value:function(Oa){var Da=this.parser,ka=this.evalEnvironment.knownGlobals||[];Oa=this.parse(void 0===Oa?null:Oa);return Da&&
Oa?Da.query.findGlobalVarRefs(Oa,{jslintGlobalComment:!0}).filter(function(Ba){return!ka.includes(Ba.name)}):[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"JavaScriptEditorPlugin"}}],zc,{pathInPackage:function(){return"js/editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:664,end:6857})}(td.CodeMirrorEnabledEditorPlugin);
Mb=td.JavaScriptEditorPlugin;Sa("default",Mb);td.default=Mb}}});
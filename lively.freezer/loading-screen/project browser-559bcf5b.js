System.register(["./__root_module__-82dea728.js","kld-intersections","./index-a3ea1d44.js","./index-ebb6b2cb.js","./user-ui-4487d256.js"],function(ta,mb){var tb,Tb,Jb,rd,yc,vd,zc,Ec,Mc,zd,ne,De,Xd,Qb,qc,ld,Pb,ud,Ed,vc;return{setters:[function(ac){tb=ac.ay;Tb=ac.aw;Jb=ac.an;rd=ac.aD;yc=ac.ap;vd=ac.ab;zc=ac.Y;Ec=ac.a6;Mc=ac.ax;zd=ac.a7;ne=ac.C;De=ac.a3;Xd=ac.r;Qb=ac.aC;qc=ac.b1;ld=ac.b2;Pb=ac.au;ud=ac.a$;Ed=ac.aY},function(){},function(){},function(){},function(ac){vc=ac.UserUI}],execute:function(){var ac=
lively.FreezerRuntime.recorderFor("StaticText/index.js");ac.HTMLMorph=tb;var Eb=function(cd){var pc=lively.FreezerRuntime.recorderFor("StaticText/index.js"),cb=pc.hasOwnProperty("StaticText")&&"function"===typeof pc.StaticText?pc.StaticText:pc.StaticText=function(fb){fb&&fb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(cb,cd,[{key:"refresh",value:function(){this.html='<span style="line-height: 1.3; font-size: '+this.fontSize+
"px; color: "+this.fontColor+"; font-family: "+this.fontFamily+'">'+this.value+"</span>"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StaticText"}},{key:"properties",get:function(){return{html:{isStyleProp:!1},fontSize:{type:"Number",set:function(fb){this.setProperty("fontSize",fb);this.refresh()}},fontColor:{type:"Color",set:function(fb){this.setProperty("fontColor",fb);this.refresh()}},fontFamily:{type:"Enum",set:function(fb){this.setProperty("fontFamily",fb);this.refresh()}},
value:{set:function(fb){this.setProperty("value",fb);this.refresh()}}}}}],pc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"StaticText",version:"0.1.1-10"}}},{start:74,end:953})}(ac.HTMLMorph);Eb=ac.StaticText;ac.default=Eb;var ec=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");ec.Morph=Jb;ec.HorizontalLayout=rd;ec.VerticalLayout=
yc;ec.morph=vd;ec.MorphicDB=zc;ec.arr=Ec;ec.fun=Mc;ec.string=zd;ec.Color=ne;ec.pt=De;ec.UserUI=vc;ec.resource=Xd;ac=function(cd){var pc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),cb=pc.hasOwnProperty("WorldDashboard")&&"function"===typeof pc.WorldDashboard?pc.WorldDashboard:pc.WorldDashboard=function(fb){fb&&fb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(cb,cd,[{key:"onLoad",value:function(){"undefined"!==
typeof localStorage&&(this.ui.sortSelector.selection=localStorage.getItem("lively.morphic-projects-filter"))}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",this.ui.sortSelector.selection)}catch(fb){console.error(fb)}}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=
!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(fb){fb=void 0===fb?$world:fb;this.owner!=fb&&fb.addMorph(this);this.center=fb.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(fb){var ya=ec.UserUI.getCurrentUser();fb=this.ui.searchField.fuzzyFilter(fb,function(Ea){return Ea._commit.name+Ea._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return ec.arr.sortBy(fb,function(Ea){return-Ea._commit.timestamp});
case "TEMPLATES":return fb;case "MY PROJECTS":return ec.arr.filter(fb,function(Ea){return Ea._commit.author.name===ya.name});case "PUBLISHED":return fb}}},{key:"updateList",value:function(){var fb=this;this.previews&&ec.fun.debounceNamed("update world list",150,function(){fb.ui.worldList.items=fb.sortAndFilterPreviews(fb.previews)})()}},{key:"displayWorlds",value:function(){var fb=this,ya,Ea,Ba,xa,Qa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wb){switch(wb.nextAddress){case 1:return fb.reset(),
ya=fb.ui,Ea=ya.loadingLabel,Ea.animate({opacity:1,duration:300}),wb.yield(fb.db.latestCommits("world"),2);case 2:return Ba=wb.yieldResult,wb.yield(mb.import("./world preview-16132c54.js"),4);case 4:if(!(xa=wb.yieldResult)){wb.jumpTo(5);break}return wb.yield(ec.resource("part://partial freezing/world preview"),6);case 6:xa=wb.yieldResult;case 5:return wb.yield(xa.read(),3);case 3:return Qa=wb.yieldResult,fb.previews=Ba.map(function(fc){var $a=ec.morph({reactsToPointer:!1,fill:ec.Color.transparent,
extent:Qa.extent});$a._commit=fc;$a.displayPreview=function(){var ib;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ab){if(1==ab.nextAddress)return ib=Qa.copy(),ib._commit=fc,ib.opacity=0,$a.addMorph(ib),ib.displayPreview(),ib.position=ec.pt(0,0),ab.yield($a.whenRendered(),2);$a.layout=new ec.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});ab.jumpToEnd()})};return $a}),wb.yield(Ea.animate({opacity:0,duration:300}),7);case 7:fb.updateList(),0==Ba.length&&(fb.ui.noWorldWarning.center=
fb.innerBounds().center(),fb.ui.noWorldWarning.animate({visible:!0,duration:300})),wb.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(fb){this.ui.closeButton.visible=fb}},db:{serialize:!1,get:function(){return ec.MorphicDB.default}},
ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],pc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"WorldDashboard",version:"0.1.1-130"}}},{start:330,end:4316})}(ec.Morph);ac=ec.WorldDashboard;ec.default=ac;var wc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");wc.Morph=Jb;wc.touchInputDevice=Qb;wc.TilingLayout=qc;wc.arr=Ec;wc.pt=De;ac=function(cd){var pc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),cb=pc.hasOwnProperty("GrowingWorldList")&&"function"===typeof pc.GrowingWorldList?pc.GrowingWorldList:pc.GrowingWorldList=function(fb){fb&&
fb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(cb,cd,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(fb){Tb._get(Object.getPrototypeOf(cb.prototype),"onScroll",this).call(this,fb);this.update()}},{key:"onChange",value:function(fb){Tb._get(Object.getPrototypeOf(cb.prototype),"onChange",this).call(this,fb);"extent"==fb.prop&&this.update(!0)}},{key:"onHoverIn",value:function(fb){this.clipMode=
"auto"}},{key:"onHoverOut",value:function(fb){wc.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(fb){var ya=this.items;if(ya&&0!=ya.length){var Ea=this.scrollContainer,Ba=Ea.layout.spacing;Ea.extent=this.extent;var xa=this.ui,Qa=xa.bufferTop;xa=xa.bufferBottom;Qa=Qa||Ea.addMorph({fill:null,name:"buffer top",height:10});xa=xa||Ea.addMorph({fill:null,name:"buffer bottom",height:10});Qa.width=xa.width=this.width-100;Ea.layout.disable();var wb=ya[0];Ba=ya.slice(0,Math.floor(this.width/
(wb.width+Ba))*(Math.ceil((this.scroll.y+this.height)/(wb.height+Ba))+1)).filter(function(ab){return ab.owner!=Ea});wb=this.scroll.y+2*this.height;for(var fc={},$a=$jscomp.makeIterator(Ba),ib=$a.next();!ib.done;fc={$jscomp$loop$prop$item$2653:fc.$jscomp$loop$prop$item$2653},ib=$a.next())fc.$jscomp$loop$prop$item$2653=ib.value,wb++,fc.$jscomp$loop$prop$item$2653.top=wb,Ea.addMorph(fc.$jscomp$loop$prop$item$2653),fc.$jscomp$loop$prop$item$2653._initialized||fc.$jscomp$loop$prop$item$2653.whenRendered().then(function(ab){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(U){ab.$jscomp$loop$prop$item$2653._initialized=
!0;return U.yield(ab.$jscomp$loop$prop$item$2653.displayPreview(),0)})}}(fc));fb&&(Qa.position=wc.pt(0,0),ya.forEach(function(ab,U){return ab.position=wc.pt(U+1,U+1)}),xa.position=wc.pt(ya.length+2,ya.length+2));Ea.layout.enable();if(fb||0<Ba.length)xa.top=this.submorphBounds().height,Ea.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new wc.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(fb){this.setProperty("items",fb);var ya=this.scrollContainer;ya.layout&&ya.layout.disable();var Ea=this.ui,Ba=Ea.bufferTop;Ea=Ea.bufferBottom;wc.arr.withoutAll(ya.submorphs,
[].concat($jscomp.arrayFromIterable(fb),[Ba,Ea])).forEach(function(xa){return xa.remove()});this.update(!0)}}}}}],pc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(wc.Morph);ac=wc.GrowingWorldList;wc.default=ac;var fd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
fd.InputLine=ld;fd.Color=ne;fd.connect=Pb;fd.disconnectAll=ud;fd.disconnect=Ed;fd.arr=Ec;fd.string=zd;ac=function(cd){var pc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),cb=pc.hasOwnProperty("SearchInputLine")&&"function"===typeof pc.SearchInputLine?pc.SearchInputLine:pc.SearchInputLine=function(fb){fb&&fb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Tb(cb,cd,[{key:"fuzzyMatch",value:function(fb,ya){ya=void 0===
ya?this.parseInput():ya;if(ya.lowercasedTokens.every(function(Ba){return fb.toLowerCase().includes(Ba)}))return!0;var Ea=fb.toLowerCase();return 3>=fd.arr.sum(ya.lowercasedTokens.map(function(Ba){return fd.string.levenshtein(Ea,Ba)}))}},{key:"fuzzyFilter",value:function(fb,ya){var Ea=this;ya=void 0===ya?function(xa){return xa}:ya;var Ba=this.parseInput();return fd.arr.filter(fb,function(xa){return Ea.fuzzyMatch(ya(xa),Ba)})}},{key:"parseInput",value:function(){var fb=Array.from(this.textString).reduce(function(Ea,
Ba){if("\\"===Ba&&!Ea.escaped)return Ea.escaped=!0,Ea;" "!==Ba||Ea.escaped?(Ea.spaceSeen=!1,Ea.current+=Ba):(!Ea.spaceSeen&&Ea.current&&(Ea.tokens.push(Ea.current),Ea.current=""),Ea.spaceSeen=!0);Ea.escaped=!1;return Ea},{tokens:[],current:"",escaped:!1,spaceSeen:!1});fb.current&&fb.tokens.push(fb.current);var ya=fb.tokens.map(function(Ea){return Ea.toLowerCase()});return{tokens:fb.tokens,lowercasedTokens:ya}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],pc,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(fd.InputLine);ac=fd.SearchInputLine;fd.default=ac}}});
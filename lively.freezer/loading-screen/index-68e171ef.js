System.register(["./__root_module__-3d4e820f.js","./index-cbb45750.js","./color-picker-f9cd23a8.js"],function(){var ra,kb,zb,Sb,Mb,Fd,Jc,wd,Kc,Fc,Wc,hd,Id,nd,Xc,Na,nb,Pb,Wb,Pc,Bd,Hb,Ub,vb,kc,xc,Dc,Gb;return{setters:[function($a){ra=$a.at;kb=$a.s;zb=$a.a7;Sb=$a.aV;Mb=$a.a6;Fd=$a.a9;Jc=$a.aa;wd=$a.aB;Kc=$a.ak;Fc=$a.an;Wc=$a.ai;hd=$a.ao;Id=$a.a3;nd=$a.a1;Xc=$a.C;Na=$a.aq;nb=$a.au;Pb=$a.bQ;Wb=$a.bs;Pc=$a.ac;Bd=$a.as;Hb=$a.bh;Ub=$a.br;vb=$a.bp;kc=$a.bS},function($a){xc=$a.N;Dc=$a.I},function($a){Gb=
$a.a}],execute:function(){var $a=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js");$a.fun=ra;$a.string=kb;$a.obj=zb;$a.properties=Sb;$a.arr=Mb;$a.Text=Fd;$a.config=Jc;$a.HorizontalLayout=wd;$a.VerticalLayout=Kc;$a.morph=Fc;$a.Morph=Wc;$a.Icon=hd;$a.pt=Id;$a.Rectangle=nd;$a.Color=Xc;$a.connect=Na;$a.once=nb;$a.noUpdate=Pb;$a.ColorPicker=Gb;$a.DropDownList=Wb;$a.loadObjectFromPartsbinFolder=Pc;$a.cachedControls=new WeakMap;var dc=function(bb){var rb=lively.FreezerRuntime.recorderFor("lively.ide/text/ui.js"),
qb=rb.hasOwnProperty("RichTextControl")&&"function"===typeof rb.RichTextControl?rb.RichTextControl:rb.RichTextControl=function(Sa){Sa&&Sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bd(qb,bb,[{key:"toggleButton",value:function(Sa,Ta){Sa.master=Ta?{auto:"styleguide://SystemIDE/selected button"}:{auto:"styleguide://System/dark button"}}},{key:"reset",value:function(){var Sa=this.ui.fontSelection;Sa.items=$a.RichTextControl.basicFontItems();
Sa.selection=Sa.items[0].value;$a.connect(this.target,"selectionChange",this,"update")}},{key:"alignAtTarget",value:function(Sa){Sa=void 0===Sa?!!this.world():Sa;var Ta=this.target,sb=Ta.world()||$world,Zb=this.globalBounds();Ta=(Ta.selection.isEmpty()?Ta.globalBounds():Ta.getGlobalTransform().transformRectToRect(Ta.selectionBounds().translatedBy(Ta.scroll.negated()))).bottomCenter().subPt(Zb.topCenter());sb=sb.visibleBounds().translateForInclusion(Zb.translatedBy(Ta)).topLeft().subPt(Zb.topLeft());
sb=this.position.addPt(sb);Sa?this.animate({duration:300,position:sb}):this.position=sb}},{key:"removeFocus",value:function(){this.autoRemove&&this.target&&(this.remove(),this.target=null)}},{key:"focusOn",value:function(Sa,Ta){Ta=void 0===Ta?!0:Ta;var sb=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zb){if(1==Zb.nextAddress)return sb.target=Sa,sb.update(),Zb.yield(sb.whenRendered(),2);sb.ui.fontSizeField.relayout();Ta&&sb.alignAtTarget();Zb.jumpToEnd()})}},{key:"setupConnections",
value:function(){$a.connect(this.ui.paddingField,"number",this,"setPadding");$a.connect(this.ui.paddingFieldTop,"number",this,"setPaddingTop");$a.connect(this.ui.paddingFieldBottom,"number",this,"setPaddingBottom");$a.connect(this.ui.paddingFieldLeft,"number",this,"setPaddingLeft");$a.connect(this.ui.paddingFieldRight,"number",this,"setPaddingRight")}},{key:"update",value:function(){var Sa=this,Ta=this.target,sb=this.updateSpec,Zb=Ta.selection;Zb=Zb?Zb.isEmpty()?Ta.textAttributeAt(Zb.start):Ta.getStyleInRange(Zb):
{};var rc=this.managedProps,Xb=$a.obj.select(Ta,rc);Ta=$jscomp.makeIterator(Object.entries($a.obj.select(Zb||{},rc)));for(Zb=Ta.next();!Zb.done;Zb=Ta.next())rc=$jscomp.makeIterator(Zb.value),Zb=rc.next().value,rc=rc.next().value,"undefined"!==typeof rc&&(Xb[Zb]=rc);$a.noUpdate(function(){for(var wc=$jscomp.makeIterator(Object.entries(Sa.ui)),I=wc.next();!I.done;I=wc.next()){var T=$jscomp.makeIterator(I.value);I=T.next().value;T=T.next().value;if(sb[I])sb[I](Xb,T)}})}},{key:"relayout",value:function(){}},
{key:"changeAttributeInSelectionOrMorph",value:function(Sa,Ta){var sb=this.target,Zb=sb.selection;sb.isLabel||Zb.isEmpty()?sb[Sa]="function"===typeof Ta?Ta(sb[Sa]):Ta:(sb.undoManager.group(),sb.changeStyleProperty(Sa,function(rc){return"function"===typeof Ta?Ta(rc):Ta}),sb.undoManager.group())}},{key:"changeFont",value:function(Sa){var Ta=this,sb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zb){if(1==Zb.nextAddress)return Ta._last=Sa,(sb="custom..."===Sa)?Zb.yield($world.prompt("Enter font family name",
{requester:Ta.target,historyId:"lively.morphic-rich-text-font-names",useLastInput:!0}),3):Zb.jumpTo(2);if(2!=Zb.nextAddress&&(Sa=Zb.yieldResult,!Sa))return Zb.return();Ta.changeAttributeInSelectionOrMorph("fontFamily",Sa);Zb.jumpToEnd()})}},{key:"setPadding",value:function(Sa){this.target.padding=$a.Rectangle.inset(Sa)}},{key:"setPaddingTop",value:function(Sa){var Ta=this.target.padding;this.target.padding=$a.Rectangle.inset(Ta.left(),Sa,Ta.right(),Ta.bottom())}},{key:"setPaddingLeft",value:function(Sa){var Ta=
this.target.padding;this.target.padding=$a.Rectangle.inset(Sa,Ta.top(),Ta.right(),Ta.bottom())}},{key:"setPaddingRight",value:function(Sa){var Ta=this.target.padding;this.target.padding=$a.Rectangle.inset(Ta.left(),Ta.top(),Sa,Ta.bottom())}},{key:"setPaddingBottom",value:function(Sa){var Ta=this.target.padding;this.target.padding=$a.Rectangle.inset(Ta.left(),Ta.top(),Ta.right(),Sa)}},{key:"setLineWrapping",value:function(Sa){this.target.lineWrapping=Sa}},{key:"changeFontWeight",value:function(Sa){this.changeAttributeInSelectionOrMorph("fontWeight",
Sa)}},{key:"changeTextAlign",value:function(Sa){this.changeAttributeInSelectionOrMorph("textAlign",Sa)}},{key:"changeFontColor",value:function(Sa){this.changeAttributeInSelectionOrMorph("fontColor",Sa)}},{key:"changeFontSize",value:function(Sa){this.changeAttributeInSelectionOrMorph("fontSize",Sa)}},{key:"changeFixedWidth",value:function(Sa){this.target.fixedWidth=Sa}},{key:"changeFixedHeight",value:function(Sa){this.target.fixedHeight=Sa}},{key:"changeLink",value:function(){var Sa=this,Ta,sb,Zb,
rc,Xb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(wc){if(1==wc.nextAddress)return Ta=Sa.target,sb=Ta.selection,Zb=Ta.getStyleInRange(sb),rc=Zb.link,wc.yield(Sa.world().prompt("Set link",{input:rc||"https://"}),2);Xb=wc.yieldResult;Ta.undoManager.group();Ta.setStyleInRange({link:Xb||void 0},sb);Ta.undoManager.group();Sa.autoRemove&&Sa.remove();wc.jumpToEnd()})}},{key:"toggleUnderline",value:function(){this.changeAttributeInSelectionOrMorph("textDecoration",function(Sa){return"underline"===
Sa?"none":"underline"})}},{key:"toggleItalic",value:function(){this.changeAttributeInSelectionOrMorph("fontStyle",function(Sa){return"italic"===Sa?"normal":"italic"})}},{key:"toggleBold",value:function(){this.changeAttributeInSelectionOrMorph("fontWeight",function(Sa){return"bold"===Sa||"700"===Sa?"normal":"bold"})}},{key:"copyStyle",value:function(){var Sa=this,Ta=this.target,sb=this.ui.applyStyleButton;Ta=Ta.selection.isEmpty()?Ta.defaultTextStyle:Ta.getStyleInRange(Ta.selection);var Zb=JSON.stringify(Ta,
null,2);this.constructor.copiedStyle=Ta;sb.tooltip="paste style\n"+Zb;this.env.eventDispatcher.doCopyWithMimeTypes([{type:"text/plain",data:Zb},{type:"application/morphic-text-style",styleString:Zb}]).then(function(){return Sa.setStatusMessage("Copied style\n"+Zb)}).catch(function(rc){return Sa.showError(rc)})}},{key:"pasteStyle",value:function(){var Sa=this,Ta=this.target,sb=this.constructor.copiedStyle;Ta.selection.isEmpty()?Object.assign(Ta,sb):Ta.selections.forEach(function(Zb){return Ta.addTextAttribute(Sa.constructor.copiedStyle,
Zb)});this.update()}},{key:"clearStyle",value:function(){var Sa=this.target;Sa.selections.forEach(function(Ta){return Sa.resetStyleInRange(Ta)});this.update()}},{key:"configureRichTextOptions",value:function(){this.getSubmorphNamed("config panel")&&this.getSubmorphNamed("config panel").remove();var Sa=this.defaultSpec,Ta=this.uiSpec;Sa=this.addMorph({name:"config panel",layout:new $a.VerticalLayout({spacing:5}),epiMorph:!0,submorphs:[].concat($jscomp.arrayFromIterable(Object.keys(Sa).map(function(sb){var Zb=
Ta.rows.some(function(rc){return rc.some(function(Xb){return Xb===sb})});return{type:"labeledcheckbox",label:sb,name:sb,checked:Zb}})),[{layout:new $a.HorizontalLayout({spacing:3}),submorphs:[{type:"button",name:"OK button",label:"OK"},{type:"button",name:"cancel button",label:"Cancel"}]}])});Sa.center=this.innerBounds().center();$a.connect(Sa.getSubmorphNamed("OK button"),"fire",this,"configureAccepted");$a.connect(Sa.getSubmorphNamed("cancel button"),"fire",this,"configureCanceled")}},{key:"configureAccepted",
value:function(){var Sa=this.getSubmorphNamed("config panel");Sa&&(Sa.remove(),Sa.submorphs.filter(function(Ta){return"LabeledCheckBox"===Ta.constructor.name}))}},{key:"configureCanceled",value:function(){var Sa=this.getSubmorphNamed("config panel");Sa&&Sa.remove()}},{key:"close",value:function(){var Sa=this;this.target&&this.target.attributeConnections&&this.target.attributeConnections.forEach(function(Ta){return Ta.targetObj===Sa&&Ta.disconnect()});this.remove()}},{key:"alwaysTargetFocusedMorph",
value:function(){this.startStepping(1500,"updateTarget")}},{key:"updateTarget",value:function(){var Sa=this.world();Sa&&(Sa=Sa.focusedMorph)&&(Sa.isLabel||Sa.isText)&&!this.isAncestorOf(Sa)&&this.target!==Sa&&this.focusOn(Sa,!1)}},{key:"onMouseUp",value:function(Sa){var Ta=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(sb){if(1==sb.nextAddress)return sb.yield(Ta.whenRendered(),2);Ta.update();sb.jumpToEnd()})}},{key:"attachToWorld",value:function(){$a.connect($world,"onMouseDown",
this,"updateTarget",{garbageCollect:!0})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RichTextControl"}},{key:"properties",get:function(){return{autoRemove:{defaultValue:!1},target:{},toggleColor:{},managedProps:{readOnly:!0,get:function(){return"fontFamily fontWeight fontSize fontStyle isText fontColor textAlign link textDecoration fixedWidth fixedHeight lineWrapping padding".split(" ")}},updateSpec:{get:function(){var Sa=this;return Object.assign({fontSelection:function(Ta,sb){var Zb=
Ta.fontFamily;(Ta=Zb&&sb.items.find(function(rc){return rc.value.toLowerCase()===Zb.toLowerCase()}))?sb.selection=Ta.value:Zb&&(sb.items=sb.items.concat({isListItem:!0,label:[Zb,{fontFamily:Zb}],value:Zb}),sb.selection=$a.arr.last(sb.items));sb.fit();sb.width=Math.max(sb.width,170)},fontWeightSelection:function(Ta,sb){sb.selection="normal"==Ta.fontWeight?"Medium":Ta.fontWeight?$a.string.capitalize(Ta.fontWeight):"Medium"},boldButton:function(Ta,sb){Sa.toggleButton(sb,"bold"===Ta.fontWeight)},italicButton:function(Ta,
sb){Sa.toggleButton(sb,"italic"===Ta.fontStyle)},underlineButton:function(Ta,sb){Sa.toggleButton(sb,"underline"===Ta.textDecoration)},linkButton:function(Ta,sb){Sa.toggleButton(sb,!!Ta.link)},colorPicker:function(Ta,sb){sb.colorValue=Ta.fontColor},fontSizeField:function(Ta,sb){sb.number=Ta.fontSize},fixedWidthControl:function(Ta,sb){Ta.isText?sb.enable():sb.disable();sb.checked=Ta.fixedWidth},fixedHeightControl:function(Ta,sb){Ta.isText?sb.enable():sb.disable();sb.checked=Ta.fixedHeight},lineWrappingControl:function(Ta,
sb){var Zb=$jscomp.makeIterator(sb.submorphs);sb=Zb.next().value;Zb=Zb.next().value;sb.checked=!!Ta.lineWrapping;Zb.deactivated=!Ta.lineWrapping;Zb.deactivated?Zb.opacity=.5:(Zb.opacity=1,Zb.selection=Ta.lineWrapping)},paddingControl:function(Ta,sb){var Zb=Ta.padding,rc=Zb.left();Ta=Zb.top();var Xb=Zb.right();Zb=Zb.bottom();var wc=!$a.arr.every([rc,Ta,Xb,Zb],function(I){return I==rc});sb.get("multi value indicator").visible=wc;$a.connect(sb.get("multi value indicator"),"onMouseDown",sb.get("padding field"),
"number",{converter:"() => left",varMapping:{left:rc}});sb.get("padding field").number=rc;sb.get("padding field").visible=!wc;sb.get("padding field top").number=Ta;sb.get("padding field left").number=rc;sb.get("padding field right").number=Xb;sb.get("padding field bottom").number=Zb}},["left","center","right","block"].reduce(function(Ta,sb){Ta[sb+"Align"]=function(Zb,rc){Sa.toggleButton(rc,Zb.textAlign==sb)};return Ta},{}))}},ui:{get:function(){var Sa=this,Ta={fontSelection:"font selection",fontWeightSelection:"font weight selection",
boldButton:"bold button",italicButton:"italic button",underlineButton:"underline button",linkButton:"link button",leftAlign:"left align",centerAlign:"center align",rightAlign:"right align",blockAlign:"block align",fontSizeField:"font size field",colorPicker:"color picker",copyStyleButton:"copy style",applyStyleButton:"apply style",removeStyleButton:"remove style",fixedHeightControl:"fixed height control",fixedWidthControl:"fixed width control",lineWrappingControl:"line wrapping control",paddingControl:"padding control",
paddingField:"padding field",paddingFieldTop:"padding field top",paddingFieldLeft:"padding field left",paddingFieldRight:"padding field right",paddingFieldBottom:"padding field bottom"};return $a.obj.extract(Ta,$a.obj.keys(Ta),function(sb,Zb){return Sa.getSubmorphNamed(Zb)})}}}}},{key:"openDebouncedFor",value:function(Sa){var Ta=Sa.selection;if(Ta.isEmpty()){var sb=$a.cachedControls.get(Sa);sb&&(sb.update(),sb.alignAtTarget(),sb.world()||Sa.world().addMorph(sb))}else $a.fun.debounceNamed(Sa.id+"openRichTextControl",
600,function(){var Zb=$a.cachedControls.get(Sa);Ta.isEmpty()?Zb&&Zb.removeFocus():(Zb&&Zb.world()||(Zb=new $a.RichTextControl,$a.cachedControls.set(Sa,Zb)),Sa.world().addMorph(Zb),Zb.focusOn(Sa,!0),Zb.alwaysTargetFocusedMorph())})()}},{key:"openFor",value:function(Sa){var Ta=$a.cachedControls.get(Sa);Ta?Ta.update():(Ta=new $a.RichTextControl,$a.cachedControls.set(Sa,Ta),Ta.focusOn(Sa,!0),Ta.alwaysTargetFocusedMorph());Ta.alignAtTarget();Ta.world()||Sa.world().addMorph(Ta);return Ta}}],rb,{pathInPackage:function(){return"text/ui.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:624,end:16984})}($a.Morph);$a.RichTextControl=dc;$a.RichTextControl=dc;$a.RichTextControl=dc;dc=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js");dc.SearchField=Hb;var oc=function(bb){var rb=lively.FreezerRuntime.recorderFor("ProtoSearchField/index.js"),qb=rb.hasOwnProperty("ProtoSearchField")&&
"function"===typeof rb.ProtoSearchField?rb.ProtoSearchField:rb.ProtoSearchField=function(Sa){Sa&&Sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bd(qb,bb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoSearchField"}},{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},
subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoSearchField",version:"0.1.1-0"}}},{start:76,end:221})}(dc.SearchField);oc=dc.ProtoSearchField;dc.default=oc;var sa=lively.FreezerRuntime.recorderFor("ProtoTree/index.js");sa.Tree=Ub;sa.TreeData=vb;dc=function(bb){var rb=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),qb=rb.hasOwnProperty("TestTreeData")&&"function"===typeof rb.TestTreeData?rb.TestTreeData:rb.TestTreeData=function(Sa){Sa&&
Sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bd(qb,bb,[{key:"display",value:function(Sa){return Sa.name}},{key:"isCollapsed",value:function(Sa){return Sa.isCollapsed}},{key:"collapse",value:function(Sa,Ta){Sa.isCollapsed=Ta}},{key:"getChildren",value:function(Sa){return Sa.isLeaf?null:Sa.isCollapsed?[]:Sa.children}},{key:"isLeaf",value:function(Sa){return Sa.isLeaf}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"TestTreeData"}}],
rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:113,end:417})}(sa.TreeData);sa.TestTreeData=dc;sa.TestTreeData=dc;sa.TestTreeData=dc;dc=function(bb){var rb=lively.FreezerRuntime.recorderFor("ProtoTree/index.js"),qb=rb.hasOwnProperty("ProtoTree")&&"function"===typeof rb.ProtoTree?rb.ProtoTree:
rb.ProtoTree=function(Sa){Sa&&Sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bd(qb,bb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoTree"}},{key:"properties",get:function(){return{treeData:{initialize:function(){this.treeData=new sa.TestTreeData({name:"root",isCollapsed:!1,isLeaf:!1,children:[{name:"child 1",isLeaf:!0},{name:"child 2",isLeaf:!1,isCollapsed:!0,children:[{name:"child 2 - 1",isLeaf:!0}]},
{name:"child 3",isLeaf:!1,isCollapsed:!1,children:[{name:"child 3 - 1",isLeaf:!0},{name:"child 3 - 2",isLeaf:!0}]},{name:"child 4",isLeaf:!0}]})}},master:{initialize:function(){}}}}}],rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoTree",version:"0.1.1-2"}}},{start:434,end:1297})}(sa.Tree);dc=sa.ProtoTree;sa.default=dc;dc=
lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js");dc.NumberWidget=xc;oc=function(bb){var rb=lively.FreezerRuntime.recorderFor("ProtoNumberWidget/index.js"),qb=rb.hasOwnProperty("ProtoNumberWidget")&&"function"===typeof rb.ProtoNumberWidget?rb.ProtoNumberWidget:rb.ProtoNumberWidget=function(Sa){Sa&&Sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bd(qb,bb,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ProtoNumberWidget"}},
{key:"properties",get:function(){return{master:{initialize:function(){}}}}}],rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ProtoNumberWidget",version:"0.1.1-0"}}},{start:76,end:224})}(dc.NumberWidget);oc=dc.ProtoNumberWidget;dc.default=oc;dc=lively.FreezerRuntime.recorderFor("FrameResizer/index.js");dc.Morph=Wc;oc=function(bb){var rb=
lively.FreezerRuntime.recorderFor("FrameResizer/index.js"),qb=rb.hasOwnProperty("FrameResizer")&&"function"===typeof rb.FrameResizer?rb.FrameResizer:rb.FrameResizer=function(Sa){Sa&&Sa[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bd(qb,bb,[{key:"onDrag",value:function(Sa){var Ta=this.owner.left;Sa=Sa.positionIn(this).x;Sa*="left"==this.direction?-1:1;this.owner.width+=Sa;350>this.owner.width&&(Sa+=350-this.owner.width,this.owner.width=
350);this.owner.left="left"==this.direction?Ta-Sa:Ta}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FrameResizer"}},{key:"properties",get:function(){return{direction:{type:"Enum",values:["left","right"]}}}}],rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"FrameResizer",version:"0.1.1-24"}}},{start:56,end:840})}(dc.Morph);
oc=dc.FrameResizer;dc.default=oc;var Ca=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js");Ca.Morph=Wc;Ca.morph=Fc;Ca.layouts=kc;Ca.string=kb;Ca.connect=Na;Ca.noUpdate=Pb;Ca.InteractiveMorphSelector=Dc;Ca.Color=Xc;Ca.pt=Id;dc=function(bb){var rb=lively.FreezerRuntime.recorderFor("ShapeLayoutControl/index.js"),qb=rb.hasOwnProperty("ShapeLayoutControl")&&"function"===typeof rb.ShapeLayoutControl?rb.ShapeLayoutControl:rb.ShapeLayoutControl=function(Sa){Sa&&Sa[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Bd(qb,bb,[{key:"focusOn",value:function(Sa){this.target=Sa;this.update(!1)}},{key:"setupConnections",value:function(){var Sa=this.ui;Ca.connect(Sa.submorphSettingsControl,"fire",this,"chooseSubmorphToChangeLayoutSettings");Ca.connect(Sa.dragmeControl,"onDragStart",this,"onSubmorphSettingsDragStart");Ca.connect(Sa.xAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "x",\n        submorph: self.selectedSubmorph,\n      })',
varMapping:{self:this}});Ca.connect(Sa.yAxisPolicyControl,"selection",this,"updateSubmorphProportionalLayoutSettings",{converter:'policy => ({\n        policy,\n        axis: "y",\n        submorph: self.selectedSubmorph,\n      })',varMapping:{self:this}});for(var Ta={},sb=$jscomp.makeIterator(this.managedProps),Zb=sb.next();!Zb.done;Ta={$jscomp$loop$prop$prop$2282:Ta.$jscomp$loop$prop$prop$2282},Zb=sb.next()){var rc=$jscomp.makeIterator(Zb.value),Xb=rc.next().value;Zb=rc.next().value;rc.next().value||
(Ta.$jscomp$loop$prop$prop$2282=this.join(Xb),rc=Sa[this.join(Xb,"control")],Ca.connect(rc,Zb,this,"updateLayout",{updater:function(wc){return function(I,T){I(wc.$jscomp$loop$prop$prop$2282,T)}}(Ta),varMapping:{prop:Ta.$jscomp$loop$prop$prop$2282}}))}}},{key:"lower",value:function(Sa){return Sa.charAt(0).toLowerCase()+Sa.slice(1)}},{key:"join",value:function(Sa,Ta){return this.lower(Ca.string.camelCaseString(Sa+(Ta?" "+Ta:"")))}},{key:"updateLayoutOfTarget",value:function(Sa){Sa=Ca.layouts[Ca.string.camelCaseString(Sa)];
this.target.layout=Sa?new Sa({autoResize:!1}):null;this.update()}},{key:"updateLayout",value:function(Sa,Ta){this.target.layout[Sa]=Ta}},{key:"update",value:function(Sa){var Ta=this;this.target&&Ca.noUpdate(function(){for(var sb=Ta.ui,Zb=Ta.target.layout||{name:function(){return"No"}},rc=$jscomp.makeIterator(Ta.managedProps),Xb=rc.next();!Xb.done;Xb=rc.next()){var wc=$jscomp.makeIterator(Xb.value);Xb=wc.next().value;var I=wc.next().value;wc.next();wc=sb[Ta.join(Xb,"control")];var T=sb[Ta.join(Xb,
"label")];if(I)if("type"===Xb)wc.selection=Zb.name()+" Layout";else{var ua=Zb[Ta.join(Xb)],Da="undefined"!==typeof ua;if(Da){switch(Xb){case "align":wc.items=Zb.possibleAlignValues;break;case "direction":wc.items=Zb.possibleDirectionValues;break;case "axis":wc.items=Zb.possibleAxisValues}wc[I]=ua}T.isLayoutable=T.visible=Da}}Ta.showGridLayoutControl("Grid"===Zb.name());Ta.showProportionalControl("Proportional"===Zb.name())})}},{key:"updateSubmorphProportionalLayoutSettings",value:function(Sa){var Ta=
{};this.target.layout.changeSettingsFor(Sa.submorph,(Ta[Sa.axis]=Sa.policy,Ta),!0)}},{key:"onSubmorphSettingsDragStart",value:function(Sa){var Ta=this;Sa.stop();var sb=this.target.layout,Zb=sb.settingsFor(this.selectedSubmorph),rc=[],Xb;for(Xb in Zb)rc=[].concat($jscomp.arrayFromIterable(rc),[Xb+": ",{fontWeight:"bold"},Zb[Xb]+" ",{}]);var wc=Ca.morph({type:"label",fontColor:Ca.Color.white,value:rc,fill:Ca.Color.black.withA(.7),padding:5,borderRadius:10,isLayoutable:!1});wc.wantsToBeDroppedOn=function(I){return sb.layoutableSubmorphs.includes(I)};
wc.onBeingDroppedOn=function(I,T){wc.remove();if(I=sb.layoutableSubmorphs.includes(T)?T:Sa.world.morphsContainingPoint(Sa.hand.position).find(function(ua){return sb.layoutableSubmorphs.includes(ua)}))Ta.updateSubmorphProportionalLayoutSettings({policy:Zb.x,axis:"x",submorph:I}),Ta.updateSubmorphProportionalLayoutSettings({policy:Zb.y,axis:"y",submorph:I}),I.show(),$world.setStatusMessage("layout settings applied")};Sa.hand.grab(wc);wc.moveBy(Ca.pt(10,10))}},{key:"chooseSubmorphToChangeLayoutSettings",
value:function(){var Sa=this,Ta,sb,Zb,rc,Xb,wc,I,T,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){switch(Da.nextAddress){case 1:return Ta=Sa.target.layout.layoutableSubmorphs,Sa.manageFocus=!0,Sa.env.eventDispatcher.isKeyPressed("Shift")?(Zb=Ta.map(function(Kb){return{isListItem:!0,string:String(Kb),value:Kb}}),Da.yield($world.listPrompt("Select morph",Zb,{onSelection:function(Kb){return Kb.show()}}),5)):Da.yield(Ca.InteractiveMorphSelector.selectMorph(Sa.world(),Sa,function(Kb){return Ta.includes(Kb)}),
4);case 4:sb=Da.yieldResult;Da.jumpTo(3);break;case 5:rc=Da.yieldResult,Xb=$jscomp.makeIterator(rc.selected),sb=Xb.next().value;case 3:Sa.manageFocus=!1;Sa.selectedSubmorph=sb;if(!sb)return Da.return();wc=Sa.ui;I=wc.xAxisPolicyControl;T=wc.yAxisPolicyControl;ua=Sa.target.layout.settingsFor(sb);Ca.noUpdate(function(){I.selection=ua.x;T.selection=ua.y});Da.jumpToEnd()}})}},{key:"showProportionalControl",value:function(Sa){var Ta=this.ui;[Ta.submorphSettingsControl,Ta.dragmeControl,Ta.xAxisPolicyControl,
Ta.xAxisPolicyLabel,Ta.yAxisPolicyControl,Ta.yAxisPolicyLabel].forEach(function(sb){sb.isLayoutable=Sa;sb.visible=Sa})}},{key:"showGridLayoutHalo",value:function(){$world.showLayoutHaloFor(this.target)}},{key:"showGridLayoutControl",value:function(Sa){var Ta=this.ui.configureGridLayoutControl;Ta.visible=Ta.isLayoutable=Sa}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"ShapeLayoutControl"}},{key:"properties",get:function(){return{managedProps:{get:function(){return[["type","selection",
!0],["align","selection"],["direction","selection"],["axis","selection"],["spacing","number"],["auto resize","checked"],["resize submorphs","checked"],["x axis policy","selection",!0],["y axis policy","selection",!0],["react to submorph animations","checked"],["submorph settings",!1,!0],["order by index","checked"],["dragme",!1,!0],["configure grid layout",!1,!0]]}},ui:{readOnly:!0,get:function(){for(var Sa={labelContainer:this.getSubmorphNamed("label container"),controlContainer:this.getSubmorphNamed("control container")},
Ta=$jscomp.makeIterator(this.managedProps),sb=Ta.next();!sb.done;sb=Ta.next()){var Zb=$jscomp.makeIterator(sb.value).next().value;sb=Zb+" label";Zb+=" control";Sa[this.join(sb)]=this.getSubmorphNamed(sb);Sa[this.join(Zb)]=this.getSubmorphNamed(Zb)}return Sa}}}}}],rb,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"ShapeLayoutControl",
version:"0.1.1-166"}}},{start:345,end:7771})}(Ca.Morph);dc=Ca.ShapeLayoutControl;Ca.default=dc}}});
System.register(["./__root_module__-be0d56fe.js","./index-22c86a41.js","./index-6e2ebca5.js"],function(){var Pa,Lb,Vb,Dc,jc;return{setters:[function(qd){Pa=qd.M;Lb=qd.ba;Vb=qd.r;Dc=qd.i},function(qd){jc=qd.e},function(){}],execute:function(){var qd=lively.FreezerRuntime.recorderFor("VersionChecker/index.js");qd.Morph=Pa;qd.runCommand=Lb;qd.evalOnServer=jc;qd.resource=Vb;var id=function(Cd){var bd=lively.FreezerRuntime.recorderFor("VersionChecker/index.js"),Wc=bd.hasOwnProperty("VersionChecker")&&
"function"===typeof bd.VersionChecker?bd.VersionChecker:bd.VersionChecker=function(Zc){Zc&&Zc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return Dc(Wc,Cd,[{key:"onLoad",value:function(){this.isComponent||this.withAllSubmorphsDo(function(Zc){return Zc.halosEnabled=!1})}},{key:"checkVersion",value:function(){this.reset();this.checkIfUpToDate()}},{key:"onMouseDown",value:function(Zc){Dc._get(Object.getPrototypeOf(Wc.prototype),"onMouseDown",
this).call(this,Zc);this.isComponent||this.checkVersion()}},{key:"relayout",value:function(){var Zc=this;this.world().withTopBarDo(function(zd){Zc.bottomLeft=zd.sideBar&&zd.sideBar.visible?zd.sideBar.bottomRight.addXY(10,-10):Zc.world().visibleBounds().insetBy(10).bottomLeft()})}},{key:"checkIfUpToDate",value:function(){var Zc=this,zd,me,te,Je,jd,Zd,gc;return $jscomp.asyncExecutePromiseGeneratorProgram(function($c){switch($c.nextAddress){case 1:return zd="git rev-parse master",$c.yield(qd.evalOnServer("System.baseURL").then(function(Bd){return Bd.replace("file://",
"")}),2);case 2:return me=$c.yieldResult,$c.yield(qd.runCommand("git fetch",{cwd:me}).whenDone(),3);case 3:return $c.yield(qd.runCommand(zd,{cwd:me}).whenDone(),4);case 4:return te=$c.yieldResult,Je=te.stdout,jd=Je.split("\n")[0],$c.yield(qd.resource("https://api.github.com/repos/LivelyKernel/lively.next/commits/master").readJson(),5);case 5:return Zd=$c.yieldResult,gc=Zd.sha,jd!=gc?$c.return(Zc.showOutdated(jd.slice(0,6))):$c.return(Zc.showUpToDate(jd.slice(0,6)))}})}},{key:"showOutdated",value:function(Zc){var zd=
this.ui,me=zd.checking,te=zd.outdated;zd.status.value=["Version: ",{},"["+Zc+"]",{fontWeight:"bold"}," (Please update!)"];me.visible=me.isLayoutable=!1;te.visible=te.isLayoutable=!0}},{key:"showUpToDate",value:function(Zc){var zd=this.ui,me=zd.checking,te=zd.latest;zd.status.value=["Version: ",{},"["+Zc+"]",{fontWeight:"bold"}];me.visible=me.isLayoutable=!1;te.visible=te.isLayoutable=!0}},{key:"reset",value:function(){var Zc=this.ui,zd=Zc.checking,me=Zc.outdated,te=Zc.latest;Zc.status.value="Checking version...";
zd.visible=zd.isLayoutable=!0;me.visible=te.visible=me.isLayoutable=te.isLayoutable=!1}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"VersionChecker"}},{key:"properties",get:function(){return{isEpiMorph:{derived:!0,get:function(){return!this.isComponent}},respondsToVisibleWindow:{derived:!0,get:function(){return!this.isComponent}},ui:{derived:!0,get:function(){return{status:this.get("version status label"),checking:this.get("loading indicator"),outdated:this.get("icon outdated"),
latest:this.get("icon latest")}}}}}}],bd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"VersionChecker",version:"0.1.1-27"}}},{start:232,end:2913})}(qd.Morph);id=qd.VersionChecker;qd.default=id}}});
System.register(["./__root_module__-2cc1f5a8.js","./index-2fe3a573.js","./index-121b2137.js","./user-ui-b2bf1033.js"],function(ya,wb){var Ab,ac,Ob,kd,Cc,qd,Dc,Ic,Qc,Bd,ne,ve,Wd,Tb,wc,od,Ub,xd,Gd;return{setters:[function(lc){Ab=lc.an;ac=lc.aD;Ob=lc.ap;kd=lc.ab;Cc=lc.Y;qd=lc.a6;Dc=lc.ax;Ic=lc.a7;Qc=lc.C;Bd=lc.a3;ne=lc.r;ve=lc.aw;Wd=lc.aC;Tb=lc.b1;wc=lc.b2;od=lc.au;Ub=lc.a$;xd=lc.aY},function(){},function(){},function(lc){Gd=lc.UserUI}],execute:function(){var lc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");
lc.Morph=Ab;lc.HorizontalLayout=ac;lc.VerticalLayout=Ob;lc.morph=kd;lc.MorphicDB=Cc;lc.arr=qd;lc.fun=Dc;lc.string=Ic;lc.Color=Qc;lc.pt=Bd;lc.UserUI=Gd;lc.resource=ne;var rc=function(Hc){var ad=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),dd=ad.hasOwnProperty("WorldDashboard")&&"function"===typeof ad.WorldDashboard?ad.WorldDashboard:ad.WorldDashboard=function(fc){fc&&fc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ve(dd,
Hc,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(fc){fc=void 0===fc?$world:fc;this.owner!=fc&&fc.addMorph(this);this.center=fc.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(fc){var jb=
lc.UserUI.getCurrentUser();fc=this.ui.searchField.fuzzyFilter(fc,function(yb){return yb._commit.name+yb._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return lc.arr.sortBy(fc,function(yb){return-yb._commit.timestamp});case "TEMPLATES":return fc;case "MY PROJECTS":return lc.arr.filter(fc,function(yb){return yb._commit.author.name===jb.name});case "PUBLISHED":return fc}}},{key:"updateList",value:function(){var fc=this;this.previews&&lc.fun.debounceNamed("update world list",
150,function(){fc.ui.worldList.items=fc.sortAndFilterPreviews(fc.previews)})()}},{key:"displayWorlds",value:function(){var fc=this,jb,yb,Ja,Ta,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Fa){switch(Fa.nextAddress){case 1:return fc.reset(),jb=fc.ui,yb=jb.loadingLabel,yb.animate({opacity:1,duration:300}),Fa.yield(fc.db.latestCommits("world"),2);case 2:return Ja=Fa.yieldResult,Fa.yield(wb.import("./world preview-4dc7c126.js"),4);case 4:if(!(Ta=Fa.yieldResult)){Fa.jumpTo(5);break}return Fa.yield(lc.resource("part://partial freezing/world preview"),
6);case 6:Ta=Fa.yieldResult;case 5:return Fa.yield(Ta.read(),3);case 3:return Ka=Fa.yieldResult,fc.previews=Ja.map(function(Xa){var Hb=lc.morph({reactsToPointer:!1,fill:lc.Color.transparent,extent:Ka.extent});Hb._commit=Xa;Hb.displayPreview=function(){var ic;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lb){if(1==lb.nextAddress)return ic=Ka.copy(),ic._commit=Xa,ic.opacity=0,Hb.addMorph(ic),ic.displayPreview(),ic.position=lc.pt(0,0),lb.yield(Hb.whenRendered(),2);Hb.layout=new lc.HorizontalLayout({autoResize:!0,
reactToSubmorphAnimations:!0});lb.jumpToEnd()})};return Hb}),Fa.yield(yb.animate({opacity:0,duration:300}),7);case 7:fc.updateList(),0==Ja.length&&(fc.ui.noWorldWarning.center=fc.innerBounds().center(),fc.ui.noWorldWarning.animate({visible:!0,duration:300})),Fa.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,
get:function(){return this.ui.closeButton.visible},set:function(fc){this.ui.closeButton.visible=fc}},db:{serialize:!1,get:function(){return lc.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],
ad,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-127"}}},{start:330,end:3954})}(lc.Morph);rc=lc.WorldDashboard;lc.default=rc;var Kb=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");Kb.Morph=Ab;Kb.touchInputDevice=Wd;Kb.TilingLayout=Tb;Kb.arr=qd;Kb.pt=Bd;rc=function(Hc){var ad=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),
dd=ad.hasOwnProperty("GrowingWorldList")&&"function"===typeof ad.GrowingWorldList?ad.GrowingWorldList:ad.GrowingWorldList=function(fc){fc&&fc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ve(dd,Hc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(fc){ve._get(Object.getPrototypeOf(dd.prototype),"onScroll",this).call(this,fc);this.update()}},{key:"onChange",value:function(fc){ve._get(Object.getPrototypeOf(dd.prototype),
"onChange",this).call(this,fc);"extent"==fc.prop&&this.update(!0)}},{key:"onHoverIn",value:function(fc){this.clipMode="auto"}},{key:"onHoverOut",value:function(fc){Kb.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(fc){var jb=this.items;if(jb&&0!=jb.length){var yb=this.scrollContainer,Ja=yb.layout.spacing;yb.extent=this.extent;var Ta=this.ui,Ka=Ta.bufferTop;Ta=Ta.bufferBottom;Ka=Ka||yb.addMorph({fill:null,name:"buffer top",height:10});Ta=Ta||yb.addMorph({fill:null,name:"buffer bottom",
height:10});Ka.width=Ta.width=this.width-100;yb.layout.disable();var Fa=jb[0];Ja=jb.slice(0,Math.floor(this.width/(Fa.width+Ja))*(Math.ceil((this.scroll.y+this.height)/(Fa.height+Ja))+1)).filter(function(lb){return lb.owner!=yb});Fa=this.scroll.y+2*this.height;for(var Xa={},Hb=$jscomp.makeIterator(Ja),ic=Hb.next();!ic.done;Xa={$jscomp$loop$prop$item$2590:Xa.$jscomp$loop$prop$item$2590},ic=Hb.next())Xa.$jscomp$loop$prop$item$2590=ic.value,Fa++,Xa.$jscomp$loop$prop$item$2590.top=Fa,yb.addMorph(Xa.$jscomp$loop$prop$item$2590),
Xa.$jscomp$loop$prop$item$2590._initialized||Xa.$jscomp$loop$prop$item$2590.whenRendered().then(function(lb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(tb){lb.$jscomp$loop$prop$item$2590._initialized=!0;return tb.yield(lb.$jscomp$loop$prop$item$2590.displayPreview(),0)})}}(Xa));fc&&(Ka.position=Kb.pt(0,0),jb.forEach(function(lb,tb){return lb.position=Kb.pt(tb+1,tb+1)}),Ta.position=Kb.pt(jb.length+2,jb.length+2));yb.layout.enable();if(fc||0<Ja.length)Ta.top=this.submorphBounds().height,
yb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Kb.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},
items:{after:["layout","scrollContainer"],set:function(fc){this.setProperty("items",fc);var jb=this.scrollContainer;jb.layout&&jb.layout.disable();var yb=this.ui,Ja=yb.bufferTop;yb=yb.bufferBottom;Kb.arr.withoutAll(jb.submorphs,[].concat($jscomp.arrayFromIterable(fc),[Ja,yb])).forEach(function(Ta){return Ta.remove()});this.update(!0)}}}}}],ad,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Kb.Morph);rc=Kb.GrowingWorldList;Kb.default=rc;var qc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");qc.InputLine=wc;qc.Color=Qc;qc.connect=od;qc.disconnectAll=Ub;qc.disconnect=xd;qc.arr=qd;qc.string=Ic;rc=function(Hc){var ad=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),dd=ad.hasOwnProperty("SearchInputLine")&&"function"===typeof ad.SearchInputLine?ad.SearchInputLine:ad.SearchInputLine=
function(fc){fc&&fc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ve(dd,Hc,[{key:"fuzzyMatch",value:function(fc,jb){jb=void 0===jb?this.parseInput():jb;if(jb.lowercasedTokens.every(function(Ja){return fc.toLowerCase().includes(Ja)}))return!0;var yb=fc.toLowerCase();return 3>=qc.arr.sum(jb.lowercasedTokens.map(function(Ja){return qc.string.levenshtein(yb,Ja)}))}},{key:"fuzzyFilter",value:function(fc,jb){var yb=this;jb=void 0===
jb?function(Ta){return Ta}:jb;var Ja=this.parseInput();return qc.arr.filter(fc,function(Ta){return yb.fuzzyMatch(jb(Ta),Ja)})}},{key:"parseInput",value:function(){var fc=Array.from(this.textString).reduce(function(yb,Ja){if("\\"===Ja&&!yb.escaped)return yb.escaped=!0,yb;" "!==Ja||yb.escaped?(yb.spaceSeen=!1,yb.current+=Ja):(!yb.spaceSeen&&yb.current&&(yb.tokens.push(yb.current),yb.current=""),yb.spaceSeen=!0);yb.escaped=!1;return yb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});fc.current&&fc.tokens.push(fc.current);
var jb=fc.tokens.map(function(yb){return yb.toLowerCase()});return{tokens:fc.tokens,lowercasedTokens:jb}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],ad,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(qc.InputLine);rc=qc.SearchInputLine;
qc.default=rc}}});
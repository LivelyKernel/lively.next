System.register(["./__root_module__-be0d56fe.js","./object-classes-f8189235.js","./user-ui-f81a22e7.js","./index-a225ba89.js","./index-35f291db.js"],function(){var Pa,Lb,Vb,Dc,jc,qd,id,Cd,bd,Wc,Zc,zd,me,te,Je,jd,Zd,gc,$c;return{setters:[function(Bd){Pa=Bd.M;Lb=Bd.af;Vb=Bd.aa;Dc=Bd.m;jc=Bd.ae;qd=Bd.a;id=Bd.f;Cd=Bd.s;bd=Bd.C;Wc=Bd.b;Zc=Bd.r;zd=Bd.i;me=Bd.t;te=Bd.ay;Je=Bd.az;jd=Bd.c;Zd=Bd.ax;gc=Bd._},function(){},function(Bd){$c=Bd.UserUI},function(){},function(){}],execute:function(){var Bd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");
Bd.Morph=Pa;Bd.HorizontalLayout=Lb;Bd.VerticalLayout=Vb;Bd.morph=Dc;Bd.MorphicDB=jc;Bd.arr=qd;Bd.fun=id;Bd.string=Cd;Bd.Color=bd;Bd.pt=Wc;Bd.UserUI=$c;Bd.resource=Zc;var fd=function(Zb){var Gc=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),xd=Gc.hasOwnProperty("WorldDashboard")&&"function"===typeof Gc.WorldDashboard?Gc.WorldDashboard:Gc.WorldDashboard=function(Ic){Ic&&Ic[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zd(xd,
Zb,[{key:"onLoad",value:function(){if(!this.isComponent&&"undefined"!==typeof localStorage){var Ic=localStorage.getItem("lively.morphic-projects-filter");Ic&&this.ui.sortSelector.selection!=Ic&&(this.ui.sortSelector.selection=Ic)}}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",this.ui.sortSelector.selection)}catch(Ic){console.error(Ic)}}},
{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(Ic){Ic=void 0===Ic?$world:Ic;this.owner!=Ic&&Ic.addMorph(this);this.center=Ic.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(Ic){var Ad=Bd.UserUI.getCurrentUser();Ic=this.ui.searchField.fuzzyFilter(Ic,function(Mb){return Mb._commit.name+Mb._commit.description});
switch(this.ui.sortSelector.selection){case "RECENT":return Bd.arr.sortBy(Ic,function(Mb){return-Mb._commit.timestamp});case "TEMPLATES":return Ic;case "MY PROJECTS":return Bd.arr.filter(Ic,function(Mb){return Mb._commit.author.name===Ad.name});case "PUBLISHED":return Ic}}},{key:"updateList",value:function(){var Ic=this;this.previews&&Bd.fun.debounceNamed("update world list",150,function(){Ic.ui.worldList.items=Ic.sortAndFilterPreviews(Ic.previews)})()}},{key:"displayWorlds",value:function(){var Ic=
this,Ad,Mb,mb,Ac;return $jscomp.asyncExecutePromiseGeneratorProgram(function(vc){switch(vc.nextAddress){case 1:return Ic.reset(),Ad=Ic.ui,Mb=Ad.loadingLabel,Mb.fit(),Mb.animate({opacity:1,duration:300}),vc.yield(Ic.db.latestCommits("world"),2);case 2:return mb=vc.yieldResult,vc.yield(Bd.resource("part://partial freezing/world preview").read(),3);case 3:return Ac=vc.yieldResult,Ic.previews=mb.map(function(ec){var Bc=Bd.morph({reactsToPointer:!1,fill:Bd.Color.transparent,clipMode:"hidden",dropShadow:Ac.dropShadow,
extent:Ac.extent});Bc._commit=ec;Bc.displayPreview=function(){var Ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(hc){if(1==hc.nextAddress)return Ua=Ac.copy(),Ua.dropShadow=null,Ua._commit=ec,Ua.opacity=0,Bc.addMorph(Ua),Ua.displayPreview(),Ua.position=Bd.pt(0,0),hc.yield(Bc.whenRendered(),2);Bc.layout=new Bd.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});hc.jumpToEnd()})};return Bc}),vc.yield(Mb.animate({opacity:0,duration:300}),4);case 4:Ic.updateList(),0==mb.length&&
(Ic.ui.noWorldWarning.center=Ic.innerBounds().center(),Ic.ui.noWorldWarning.animate({visible:!0,duration:300})),vc.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(Ic){this.ui.closeButton.visible=Ic}},db:{serialize:!1,get:function(){return Bd.MorphicDB.default}},
ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],Gc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"WorldDashboard",version:"0.1.1-140"}}},{start:330,end:4524})}(Bd.Morph);fd=Bd.WorldDashboard;Bd.default=fd;var Jd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");Jd.Morph=Pa;Jd.touchInputDevice=me;Jd.TilingLayout=te;Jd.arr=qd;Jd.pt=Wc;fd=function(Zb){var Gc=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),xd=Gc.hasOwnProperty("GrowingWorldList")&&"function"===typeof Gc.GrowingWorldList?Gc.GrowingWorldList:Gc.GrowingWorldList=function(Ic){Ic&&
Ic[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zd(xd,Zb,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(Ic){zd._get(Object.getPrototypeOf(xd.prototype),"onScroll",this).call(this,Ic);this.update()}},{key:"onChange",value:function(Ic){zd._get(Object.getPrototypeOf(xd.prototype),"onChange",this).call(this,Ic);"extent"==Ic.prop&&this.update(!0)}},{key:"onHoverIn",value:function(Ic){this.clipMode=
"auto"}},{key:"onHoverOut",value:function(Ic){Jd.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(Ic){var Ad=this.items;if(Ad&&0!=Ad.length){var Mb=this.scrollContainer,mb=Mb.layout.spacing;Mb.extent=this.extent;var Ac=this.ui,vc=Ac.bufferTop;Ac=Ac.bufferBottom;vc=vc||Mb.addMorph({fill:null,name:"buffer top",height:10});Ac=Ac||Mb.addMorph({fill:null,name:"buffer bottom",height:10});vc.width=Ac.width=this.width-100;Mb.layout.disable();var ec=Ad[0];mb=Ad.slice(0,Math.floor(this.width/
(ec.width+mb))*(Math.ceil((this.scroll.y+this.height)/(ec.height+mb))+1)).filter(function(Eb){return Eb.owner!=Mb});ec=this.scroll.y+2*this.height;for(var Bc={},Ua=$jscomp.makeIterator(mb),hc=Ua.next();!hc.done;Bc={$jscomp$loop$prop$item$2998:Bc.$jscomp$loop$prop$item$2998},hc=Ua.next())Bc.$jscomp$loop$prop$item$2998=hc.value,ec++,Bc.$jscomp$loop$prop$item$2998.top=ec,Mb.addMorph(Bc.$jscomp$loop$prop$item$2998),Bc.$jscomp$loop$prop$item$2998._initialized||Bc.$jscomp$loop$prop$item$2998.whenRendered().then(function(Eb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(qc){Eb.$jscomp$loop$prop$item$2998._initialized=
!0;return qc.yield(Eb.$jscomp$loop$prop$item$2998.displayPreview(),0)})}}(Bc));Ic&&(vc.position=Jd.pt(0,0),Ad.forEach(function(Eb,qc){return Eb.position=Jd.pt(qc+1,qc+1)}),Ac.position=Jd.pt(Ad.length+2,Ad.length+2));Mb.layout.enable();if(Ic||0<mb.length)Ac.top=this.submorphBounds().height,Mb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Jd.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(Ic){this.setProperty("items",Ic);var Ad=this.scrollContainer;Ad.layout&&Ad.layout.disable();var Mb=this.ui,mb=Mb.bufferTop;Mb=Mb.bufferBottom;Jd.arr.withoutAll(Ad.submorphs,
[].concat($jscomp.arrayFromIterable(Ic),[mb,Mb])).forEach(function(Ac){return Ac.remove()});this.update(!0)}}}}}],Gc,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Jd.Morph);fd=Jd.GrowingWorldList;Jd.default=fd;var fe=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
fe.InputLine=Je;fe.Color=bd;fe.connect=jd;fe.disconnectAll=Zd;fe.disconnect=gc;fe.arr=qd;fe.string=Cd;fd=function(Zb){var Gc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),xd=Gc.hasOwnProperty("SearchInputLine")&&"function"===typeof Gc.SearchInputLine?Gc.SearchInputLine:Gc.SearchInputLine=function(Ic){Ic&&Ic[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zd(xd,Zb,[{key:"fuzzyMatch",value:function(Ic,Ad){Ad=void 0===
Ad?this.parseInput():Ad;if(Ad.lowercasedTokens.every(function(mb){return Ic.toLowerCase().includes(mb)}))return!0;var Mb=Ic.toLowerCase();return 3>=fe.arr.sum(Ad.lowercasedTokens.map(function(mb){return fe.string.levenshtein(Mb,mb)}))}},{key:"fuzzyFilter",value:function(Ic,Ad){var Mb=this;Ad=void 0===Ad?function(Ac){return Ac}:Ad;var mb=this.parseInput();return fe.arr.filter(Ic,function(Ac){return Mb.fuzzyMatch(Ad(Ac),mb)})}},{key:"parseInput",value:function(){var Ic=Array.from(this.textString).reduce(function(Mb,
mb){if("\\"===mb&&!Mb.escaped)return Mb.escaped=!0,Mb;" "!==mb||Mb.escaped?(Mb.spaceSeen=!1,Mb.current+=mb):(!Mb.spaceSeen&&Mb.current&&(Mb.tokens.push(Mb.current),Mb.current=""),Mb.spaceSeen=!0);Mb.escaped=!1;return Mb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});Ic.current&&Ic.tokens.push(Ic.current);var Ad=Ic.tokens.map(function(Mb){return Mb.toLowerCase()});return{tokens:Ic.tokens,lowercasedTokens:Ad}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],Gc,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(fe.InputLine);fd=fe.SearchInputLine;fe.default=fd}}});
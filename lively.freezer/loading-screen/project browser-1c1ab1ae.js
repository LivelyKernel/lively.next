System.register(["./__root_module__-590131e3.js","./object-classes-19c034e8.js","./user-ui-f568f4c6.js","./index-10a530fb.js","./index-ccd3ae79.js"],function(){var Sa,Lb,Vb,Fc,jc,sd,kd,Cd,ed,Zc,bd,yd,ke,ue,He,ld,Wd,gc,cd;return{setters:[function(Bd){Sa=Bd.M;Lb=Bd.af;Vb=Bd.aa;Fc=Bd.m;jc=Bd.ae;sd=Bd.a;kd=Bd.f;Cd=Bd.s;ed=Bd.C;Zc=Bd.b;bd=Bd.r;yd=Bd.i;ke=Bd.t;ue=Bd.ay;He=Bd.az;ld=Bd.c;Wd=Bd.ax;gc=Bd._},function(){},function(Bd){cd=Bd.UserUI},function(){},function(){}],execute:function(){var Bd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");
Bd.Morph=Sa;Bd.HorizontalLayout=Lb;Bd.VerticalLayout=Vb;Bd.morph=Fc;Bd.MorphicDB=jc;Bd.arr=sd;Bd.fun=kd;Bd.string=Cd;Bd.Color=ed;Bd.pt=Zc;Bd.UserUI=cd;Bd.resource=bd;var hd=function(Zb){var Ic=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),Ad=Ic.hasOwnProperty("WorldDashboard")&&"function"===typeof Ic.WorldDashboard?Ic.WorldDashboard:Ic.WorldDashboard=function(Jc){Jc&&Jc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yd(Ad,
Zb,[{key:"onLoad",value:function(){if(!this.isComponent&&"undefined"!==typeof localStorage){var Jc=localStorage.getItem("lively.morphic-projects-filter");Jc&&this.ui.sortSelector.selection!=Jc&&(this.ui.sortSelector.selection=Jc)}}},{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds();if("undefined"!==typeof localStorage)try{localStorage.setItem("lively.morphic-projects-filter",this.ui.sortSelector.selection)}catch(Jc){console.error(Jc)}}},
{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(Jc){Jc=void 0===Jc?$world:Jc;this.owner!=Jc&&Jc.addMorph(this);this.center=Jc.visibleBounds().center()}},{key:"sortAndFilterPreviews",value:function(Jc){var zd=Bd.UserUI.getCurrentUser();Jc=this.ui.searchField.fuzzyFilter(Jc,function(Mb){return Mb._commit.name+Mb._commit.description});
switch(this.ui.sortSelector.selection){case "RECENT":return Bd.arr.sortBy(Jc,function(Mb){return-Mb._commit.timestamp});case "TEMPLATES":return Jc;case "MY PROJECTS":return Bd.arr.filter(Jc,function(Mb){return Mb._commit.author.name===zd.name});case "PUBLISHED":return Jc}}},{key:"updateList",value:function(){var Jc=this;this.previews&&Bd.fun.debounceNamed("update world list",150,function(){Jc.ui.worldList.items=Jc.sortAndFilterPreviews(Jc.previews)})()}},{key:"displayWorlds",value:function(){var Jc=
this,zd,Mb,mb,Bc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){switch(xc.nextAddress){case 1:return Jc.reset(),zd=Jc.ui,Mb=zd.loadingLabel,Mb.fit(),Mb.animate({opacity:1,duration:300}),xc.yield(Jc.db.latestCommits("world"),2);case 2:return mb=xc.yieldResult,xc.yield(Bd.resource("part://partial freezing/world preview").read(),3);case 3:return Bc=xc.yieldResult,Jc.previews=mb.map(function(ec){var Dc=Bd.morph({reactsToPointer:!1,fill:Bd.Color.transparent,clipMode:"hidden",dropShadow:Bc.dropShadow,
extent:Bc.extent});Dc._commit=ec;Dc.displayPreview=function(){var Ta;return $jscomp.asyncExecutePromiseGeneratorProgram(function(hc){if(1==hc.nextAddress)return Ta=Bc.copy(),Ta.dropShadow=null,Ta._commit=ec,Ta.opacity=0,Dc.addMorph(Ta),Ta.displayPreview(),Ta.position=Bd.pt(0,0),hc.yield(Dc.whenRendered(),2);Dc.layout=new Bd.HorizontalLayout({autoResize:!0,reactToSubmorphAnimations:!0});hc.jumpToEnd()})};return Dc}),xc.yield(Mb.animate({opacity:0,duration:300}),4);case 4:Jc.updateList(),0==mb.length&&
(Jc.ui.noWorldWarning.center=Jc.innerBounds().center(),Jc.ui.noWorldWarning.animate({visible:!0,duration:300})),xc.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,get:function(){return this.ui.closeButton.visible},set:function(Jc){this.ui.closeButton.visible=Jc}},db:{serialize:!1,get:function(){return Bd.MorphicDB.default}},
ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],Ic,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"WorldDashboard",version:"0.1.1-140"}}},{start:330,end:4524})}(Bd.Morph);hd=Bd.WorldDashboard;Bd.default=hd;var Jd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");Jd.Morph=Sa;Jd.touchInputDevice=ke;Jd.TilingLayout=ue;Jd.arr=sd;Jd.pt=Zc;hd=function(Zb){var Ic=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),Ad=Ic.hasOwnProperty("GrowingWorldList")&&"function"===typeof Ic.GrowingWorldList?Ic.GrowingWorldList:Ic.GrowingWorldList=function(Jc){Jc&&
Jc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yd(Ad,Zb,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(Jc){yd._get(Object.getPrototypeOf(Ad.prototype),"onScroll",this).call(this,Jc);this.update()}},{key:"onChange",value:function(Jc){yd._get(Object.getPrototypeOf(Ad.prototype),"onChange",this).call(this,Jc);"extent"==Jc.prop&&this.update(!0)}},{key:"onHoverIn",value:function(Jc){this.clipMode=
"auto"}},{key:"onHoverOut",value:function(Jc){Jd.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(Jc){var zd=this.items;if(zd&&0!=zd.length){var Mb=this.scrollContainer,mb=Mb.layout.spacing;Mb.extent=this.extent;var Bc=this.ui,xc=Bc.bufferTop;Bc=Bc.bufferBottom;xc=xc||Mb.addMorph({fill:null,name:"buffer top",height:10});Bc=Bc||Mb.addMorph({fill:null,name:"buffer bottom",height:10});xc.width=Bc.width=this.width-100;Mb.layout.disable();var ec=zd[0];mb=zd.slice(0,Math.floor(this.width/
(ec.width+mb))*(Math.ceil((this.scroll.y+this.height)/(ec.height+mb))+1)).filter(function(Eb){return Eb.owner!=Mb});ec=this.scroll.y+2*this.height;for(var Dc={},Ta=$jscomp.makeIterator(mb),hc=Ta.next();!hc.done;Dc={$jscomp$loop$prop$item$2997:Dc.$jscomp$loop$prop$item$2997},hc=Ta.next())Dc.$jscomp$loop$prop$item$2997=hc.value,ec++,Dc.$jscomp$loop$prop$item$2997.top=ec,Mb.addMorph(Dc.$jscomp$loop$prop$item$2997),Dc.$jscomp$loop$prop$item$2997._initialized||Dc.$jscomp$loop$prop$item$2997.whenRendered().then(function(Eb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(tc){Eb.$jscomp$loop$prop$item$2997._initialized=
!0;return tc.yield(Eb.$jscomp$loop$prop$item$2997.displayPreview(),0)})}}(Dc));Jc&&(xc.position=Jd.pt(0,0),zd.forEach(function(Eb,tc){return Eb.position=Jd.pt(tc+1,tc+1)}),Bc.position=Jd.pt(zd.length+2,zd.length+2));Mb.layout.enable();if(Jc||0<mb.length)Bc.top=this.submorphBounds().height,Mb.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||
this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new Jd.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},items:{after:["layout","scrollContainer"],set:function(Jc){this.setProperty("items",Jc);var zd=this.scrollContainer;zd.layout&&zd.layout.disable();var Mb=this.ui,mb=Mb.bufferTop;Mb=Mb.bufferBottom;Jd.arr.withoutAll(zd.submorphs,
[].concat($jscomp.arrayFromIterable(Jc),[mb,Mb])).forEach(function(Bc){return Bc.remove()});this.update(!0)}}}}}],Ic,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(Jd.Morph);hd=Jd.GrowingWorldList;Jd.default=hd;var de=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");
de.InputLine=He;de.Color=ed;de.connect=ld;de.disconnectAll=Wd;de.disconnect=gc;de.arr=sd;de.string=Cd;hd=function(Zb){var Ic=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),Ad=Ic.hasOwnProperty("SearchInputLine")&&"function"===typeof Ic.SearchInputLine?Ic.SearchInputLine:Ic.SearchInputLine=function(Jc){Jc&&Jc[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return yd(Ad,Zb,[{key:"fuzzyMatch",value:function(Jc,zd){zd=void 0===
zd?this.parseInput():zd;if(zd.lowercasedTokens.every(function(mb){return Jc.toLowerCase().includes(mb)}))return!0;var Mb=Jc.toLowerCase();return 3>=de.arr.sum(zd.lowercasedTokens.map(function(mb){return de.string.levenshtein(Mb,mb)}))}},{key:"fuzzyFilter",value:function(Jc,zd){var Mb=this;zd=void 0===zd?function(Bc){return Bc}:zd;var mb=this.parseInput();return de.arr.filter(Jc,function(Bc){return Mb.fuzzyMatch(zd(Bc),mb)})}},{key:"parseInput",value:function(){var Jc=Array.from(this.textString).reduce(function(Mb,
mb){if("\\"===mb&&!Mb.escaped)return Mb.escaped=!0,Mb;" "!==mb||Mb.escaped?(Mb.spaceSeen=!1,Mb.current+=mb):(!Mb.spaceSeen&&Mb.current&&(Mb.tokens.push(Mb.current),Mb.current=""),Mb.spaceSeen=!0);Mb.escaped=!1;return Mb},{tokens:[],current:"",escaped:!1,spaceSeen:!1});Jc.current&&Jc.tokens.push(Jc.current);var zd=Jc.tokens.map(function(Mb){return Mb.toLowerCase()});return{tokens:Jc.tokens,lowercasedTokens:zd}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],Ic,
{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(de.InputLine);hd=de.SearchInputLine;de.default=hd}}});
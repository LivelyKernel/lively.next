System.register(["./__root_module__-82dea728.js","kld-intersections"],function(ta){var mb,tb,Tb,Jb,rd,yc,vd,zc,Ec,Mc,zd,ne,De;return{setters:[function(Xd){mb=Xd.bu;tb=Xd.a6;Tb=Xd.r;Jb=Xd.a8;rd=Xd.$;yc=Xd.bv;vd=Xd.bw;zc=Xd.T;Ec=Xd.a7;Mc=Xd.bx;zd=Xd.by;ne=Xd.l;De=Xd.bz},function(){}],execute:function(){function Xd(U){try{var ua=eval("("+fb.ast.transform.wrapInFunction("var _; _ = ("+U+")")+")()")}catch(M){return JSON.parse(U)}return"object"!==typeof ua?null:ua}function Qb(U,ua){var M,ea,Ka,Za,$b,
Qc,Ub,vb,pd;return $jscomp.asyncExecutePromiseGeneratorProgram(function($c){switch($c.nextAddress){case 1:return M=ua.world(),$c.yield(M.prompt("Enter package name",{requester:ua,input:"",historyId:"lively.vm-editor-add-package-name",useLastInput:!0}),2);case 2:ea=$c.yieldResult;if(!ea)throw"Canceled";$c.setCatchFinallyBlocks(3);Za=ya.resource(ea);ea=Za.name();Ka=Za.url;$c.leaveTryBlock(4);break;case 3:return $c.enterCatchBlock(),$c.yield(U.getConfig(),5);case 5:return $b=$c.yieldResult.baseURL,Qc=
ya.resource($b).join(ea).asDirectory().url,$c.yield(U.normalize(Qc),6);case 6:Ka=$c.yieldResult.replace(/\/\.js$/,"/");case 4:return $c.yield(M.prompt("Confirm or change package location",{requester:ua,input:Ka,historyId:"lively.vm-editor-add-package-address"}),7);case 7:Ub=$c.yieldResult;if(!Ub)throw"Canceled";vb=ya.resource(Ub).asDirectory();pd=vb.asFile().url;return $c.yield(U.removePackage(pd),8);case 8:return $c.yield(U.resourceCreateFiles(pd,{"index.js":"'format esm';\n","package.json":'{\n  "name": "'+
ea+'",\n  "version": "0.1.0"\n}',".gitignore":"node_modules/","README.md":"# "+ea+"\n\nNo description for package "+ea+" yet.\n",tests:{"test.js":'import { expect } from "mocha-es6";\ndescribe("'+ea+'", () => {\n  it("works", () => {\n    expect(1 + 2).equals(3);\n  });\n});'}}),9);case 9:return $c.return(ya.loadPackage(U,{name:ea,address:pd,configFile:vb.join("package.json").url,main:vb.join("index.js").url,test:vb.join("tests/test.js").url,type:"package"}))}})}function qc(U,ua,M){M=void 0===M?null:
M;var ea,Ka,Za,$b,Qc,Ub,vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pd){switch(pd.nextAddress){case 1:return ea={name:"",address:"",type:"package"},pd.yield(U.getConfig(),2);case 2:Ka=pd.yieldResult;if(!M){pd.jumpTo(3);break}return pd.yield(U.getPackage(M),4);case 4:if(Za=pd.yieldResult){pd.jumpTo(5);break}return pd.yield(U.getPackageForModule(M),6);case 6:Za=pd.yieldResult;case 5:$b=Za;case 3:return pd.yield(ua.world().prompt("What is the package directory?",{requester:ua,input:$b?
$b.address:Ka.baseURL,historyId:"lively.vm-editor-package-load-history",useLastInput:!1}),7);case 7:Qc=pd.yieldResult;if(!Qc)throw"Canceled";ea.address=Qc.replace(/\/$/,"");ea.url=new URL(ea.address+"/");ea.configFile=ya.resource(ea.url).join("package.json").url;pd.setCatchFinallyBlocks(8);Ub=JSON;vb=Ub.parse;return pd.yield(U.moduleRead(ea.configFile),10);case 10:vb.call(Ub,pd.yieldResult).name;pd.leaveTryBlock(9);break;case 8:pd.enterCatchBlock(),ea.name=String(ea.url).replace(/\/$/,""),U.resourceEnsureExistance(ea.configFile,
'{\n  "name": "'+ea.name+'",\n  "version": "0.1.0"\n}');case 9:return pd.return(ya.loadPackage(U,ea))}})}function ld(U,ua,M){var ea,Ka,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){switch($b.nextAddress){case 1:return ea=ya.resource(M).asFile().url,$b.yield(U.getPackage(ea),2);case 2:if(Ka=$b.yieldResult){$b.jumpTo(3);break}return $b.yield(U.getPackageForModule(ea),4);case 4:Ka=$b.yieldResult;case 3:Za=Ka;if(!Za)throw Error("Cannot find package for "+ea);return $b.yield(U.reloadPackage(ea),
5);case 5:if(!ua){$b.jumpTo(0);break}return $b.yield(ua.updateModuleList(),7);case 7:return $b.yield(ua.uiSelect(ea,!1),8);case 8:return $b.return($b.yieldResult)}})}function Pb(U,ua,M,ea){var Ka,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){switch($b.nextAddress){case 1:return $b.yield(U.getPackage(M),2);case 2:return Ka=$b.yieldResult,$b.yield((ea||$world).confirm("Unload package "+Ka.name+"?",{requester:ua}),3);case 3:Za=$b.yieldResult;if(!Za)throw"Canceled";return $b.yield(U.removePackage(M),
4);case 4:if(!ua){$b.jumpTo(0);break}return $b.yield(ua.updateModuleList(),6);case 6:return $b.yield(ua.uiSelect(null),0)}})}function ud(U,ua,M){var ea,Ka,Za,$b,Qc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ub){switch(Ub.nextAddress){case 1:return ea=ua.world(),Ub.yield(U.getPackage(M),2);case 2:return Ka=Ub.yieldResult,Ka?Ub.yield(ea.confirm("Really remove package "+Ka.name+"?",{requester:ua}),3):($world.inform('No package "'+M+'" found!',{requester:ua}),Ub.return());case 3:Za=Ub.yieldResult;
if(!Za)throw"Canceled";U.removePackage(M);return Ub.yield(ea.confirm("Also remove directory "+Ka.name+" including "+Ka.modules.length+" modules?"),4);case 4:$b=Ub.yieldResult;if(!$b){Ub.jumpTo(0);break}return Ub.yield(ea.confirm("REALLY *remove* directory "+Ka.name+"? No undo possible..."),6);case 6:if(Qc=Ub.yieldResult)return Ub.yield(U.resourceRemove(Ka.address),0);Ub.jumpTo(0)}})}function Ed(U,ua,M){M=void 0===M?$world:M;var ea,Ka,Za,$b,Qc,Ub,vb,pd,$c,Ta,nb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(xc){switch(xc.nextAddress){case 1:return xc.yield(U.getPackage(ua),
2);case 2:ea=xc.yieldResult;if(!ea)throw Error("Cannot find package "+ua);Ka=[];Za=$jscomp.makeIterator(ea.modules);$b=Za.next();case 3:if($b.done)return xc.yield(M.execCommand("open text window",{title:"imports and exports of "+ua,content:Ka.join("\n\n")}),0);Qc=$b.value;if(!Qc.name.match(/\.js$/)){xc.jumpTo(4);break}xc.setCatchFinallyBlocks(6);Ub=U;vb=Ub.importsAndExportsOf;pd=Qc.name;return xc.yield(U.moduleRead(Qc.name),9);case 9:return xc.yield(vb.call(Ub,pd,xc.yieldResult),8);case 8:$c=xc.yieldResult;
xc.leaveTryBlock(7);break;case 6:Ta=xc.enterCatchBlock();M.logError(Error("Error when getting imports/exports from module "+Qc.name+":\n"+Ta.stack));xc.jumpTo(4);break;case 7:nb=""+Qc.name;if(!$c.imports.length&&!$c.exports.length){nb+="\n  does not import / export anything";xc.jumpTo(4);break}$c.imports.length&&(nb+="\n  imports:\n",nb+=ya.arr.groupByKey($c.imports,"fromModule").mapGroups(function(bb,Bc){return"from "+bb+": "+Bc.map(function(uc){return uc.local||uc.imported?uc.imported&&uc.imported!==
uc.local?uc.imported+" as "+uc.local:uc.local:"nothing imported"}).join(", ")}).toArray().join("\n").split("\n").map(function(bb){return"    "+bb}).join("\n"));$c.exports.length&&(nb+="\n  exports:\n",nb+=$c.exports.map(function(bb){return bb.local?bb.local&&bb.local!==bb.exported?bb.local+" as "+bb.exported:bb.exported:bb.exported+" from "+bb.fromModule}).join(", ").split("\n").map(function(bb){return"    "+bb}).join("\n"));Ka.push(nb);case 4:$b=Za.next(),xc.jumpTo(3)}})}function vc(U){return U.match(/import.*['"]mocha(-es6)?['"]/)&&
U.match(/it\(['"]/)}function ac(U,ua,M){M=M&&M.address;if(M&&0===ua.indexOf(M))var ea=ua.slice(M.length).replace(/^\//,"");else a:{M=U.getConfig();if(!M||M.constructor!==Promise)try{ea=String((new Ea.URL(ua)).relativePathFrom(new Ea.URL(U.getConfig().baseURL)));break a}catch(Ka){}ea=ua}return ea}function Eb(U,ua,M,ea){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){return 1==Ka.nextAddress?(ea=Object.assign({targetModule:ua},ea),Ka.yield(U.normalize(ua),2)):3!=Ka.nextAddress?(ua=Ka.yieldResult,
Ka.yield(U.moduleSourceChange(ua,M,ea),3)):Ka.return(ua)})}function ec(U,ua,M,ea,Ka){ea=void 0===ea?!1:ea;Ka=void 0===Ka?!1:Ka;var Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){switch($b.nextAddress){case 1:return ua&&ua.setStatusMessage("Reloading "+M),$b.setCatchFinallyBlocks(2),$b.yield(U.reloadModule(M,{reloadDeps:ea,resetEnv:Ka}),4);case 4:if(!ua){$b.jumpTo(5);break}return $b.yield(ua.updateModuleList(),6);case 6:case 5:ua&&ua.setStatusMessage("Reloded "+M);$b.leaveTryBlock(0);
break;case 2:Za=$b.enterCatchBlock();$b.setCatchFinallyBlocks(7);if(!ua){$b.jumpTo(9);break}return $b.yield(ua.updateEditorWithSourceOf(M),10);case 10:case 9:$b.leaveTryBlock(8);break;case 7:$b.enterCatchBlock();case 8:throw ua&&ua.showError(Za),Za;}})}function wc(U,ua,M){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){switch(ea.nextAddress){case 1:return ea.yield(U.forgetModule(M,{forgetEnv:!0,forgetDeps:!0}),2);case 2:if(!ua){ea.jumpTo(3);break}return ea.yield(ua.updateModuleList(),
4);case 4:case 3:ea.jumpToEnd()}})}function fd(U,ua,M){var ea,Ka,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){switch($b.nextAddress){case 1:return $b.yield(U.normalize(M),2);case 2:return ea=$b.yieldResult,$b.yield(ua.world().confirm("Remove file "+ea+"?",{requester:ua}),3);case 3:Ka=$b.yieldResult;if(!Ka)throw"Canceled";return $b.yield(U.forgetModule(ea),4);case 4:return $b.yield(U.resourceRemove(ea),5);case 5:return $b.yield(U.getPackageForModule(ea),6);case 6:return Za=$b.yieldResult,
$b.return(Za)}})}function cd(U,ua,M){var ea,Ka,Za,$b,Qc,Ub,vb,pd;return $jscomp.asyncExecutePromiseGeneratorProgram(function($c){switch($c.nextAddress){case 1:return ea=Ea.URL,$c.yield(U.getConfig(),2);case 2:Ka=new ea($c.yieldResult.baseURL);Za=ua.world();if(!M){$c.jumpTo(3);break}return $c.yield(U.getPackage(M),4);case 4:if($b=$c.yieldResult){$c.jumpTo(5);break}return $c.yield(U.getPackageForModule(M),6);case 6:$b=$c.yieldResult;case 5:(Qc=$b)&&(Ka=new Ea.URL(Qc.address));case 3:return $c.yield(Ea._searchForExistingFiles(ua,
String(Ka),Qc),7);case 7:Ub=$c.yieldResult;if(!Ub.includes("[create new module]")){$c.jumpTo(8);break}return $c.yield(Ea._askForModuleName(U,M||String(Ka),Za),9);case 9:vb=$c.yieldResult,Ub=[vb];case 8:return $c.yield(Ea._createAndLoadModules(U,Ub),10);case 10:return pd=$c.yieldResult,Ea.arr.compact(pd.map(function(Ta){return Ta.error})),$c.return(pd)}})}function pc(U,ua){var M,ea,Ka,Za,$b,Qc,Ub,vb,pd,$c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ta){if(1==Ta.nextAddress)return Ta.yield(U.getPackage(ua),
2);if(3!=Ta.nextAddress){M=Ta.yieldResult;if(!M||!M.address.match(/^http/))throw Error("Cannot load package "+ua);ea=Ea.resource(M.address);Ka=[];Za=$jscomp;$b=Za.makeIterator;return Ta.yield(ea.dirList(5,{exclude:Ea.modulesInPackage_defaultExclude}),3)}Qc=$b.call(Za,Ta.yieldResult);for(Ub=Qc.next();!Ub.done;Ub=Qc.next())pd=vb=Ub.value,$c=pd.url,$c.match(/\.js$/)&&U.isModuleLoaded($c,!0)&&Ka.push(U.getModule($c));return Ta.return(Ka)})}function cb(U){U||(U="local");if(U.isSystemInterface)var ua=U;
else"string"===typeof U&&U.startsWith("l2l ")&&(U={type:"l2l",id:U.split(" ")[1]}),"string"!==typeof U&&"l2l"===U.type&&(ua=ab.l2lInterfaceFor(U.id,U.info)),"string"!==typeof U&&($world.setStatusMessage("Unknown system interface "+U),U="local"),ua||(ua=U&&"local"!==U?ab.serverInterfaceFor(U):ab.localInterface);return ua}ta("systemInterfaceNamed",cb);var fb=lively.FreezerRuntime.recorderFor("lively-system-interface/helpers.js");fb.parseJsonLikeObj=Xd;fb.ast=mb;fb.parseJsonLikeObj=Xd;fb.parseJsonLikeObj=
Xd;var ya=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/packages.js");ya.loadPackage=function(U,ua){var M,ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){switch(Ka.nextAddress){case 1:return Ka.yield(U.importPackage(ua.address+"/"),2);case 2:if(!ua.main){Ka.jumpTo(3);break}return Ka.yield(U.importModule(ua.main.toString()),3);case 3:if(!ua.test){Ka.jumpTo(5);break}Ka.setCatchFinallyBlocks(6);return Ka.yield(U.importPackage("mocha-es6"),8);case 8:return M=Ka.yieldResult,
Ka.yield(M.installSystemInstantiateHook(),9);case 9:return Ka.yield(U.importModule(ua.test.toString()),10);case 10:Ka.leaveTryBlock(5);break;case 6:ea=Ka.enterCatchBlock(),console.warn("Cannot load test of new package: "+ea);case 5:return Ka.return(U.getPackage(ua.address))}})};ya.interactivelyCreatePackage=Qb;ya.interactivelyLoadPackage=qc;ya.interactivelyReloadPackage=ld;ya.interactivelyUnloadPackage=Pb;ya.interactivelyRemovePackage=ud;ya.showExportsAndImportsOf=Ed;ya.parseJsonLikeObj=Xd;ya.arr=
tb;ya.resource=Tb;ya.interactivelyCreatePackage=Qb;ya.interactivelyCreatePackage=Qb;ya.interactivelyLoadPackage=qc;ya.interactivelyLoadPackage=qc;ya.interactivelyReloadPackage=ld;ya.interactivelyReloadPackage=ld;ya.interactivelyUnloadPackage=Pb;ya.interactivelyUnloadPackage=Pb;ya.interactivelyRemovePackage=ud;ya.interactivelyRemovePackage=ud;ya.showExportsAndImportsOf=Ed;ya.showExportsAndImportsOf=Ed;var Ea=lively.FreezerRuntime.recorderFor("lively-system-interface/commands/modules.js");Ea.isTestModule=
vc;Ea.shortModuleName=ac;Ea.interactivelyChangeModule=Eb;Ea.interactivelyReloadModule=ec;Ea.interactivelyUnloadModule=wc;Ea.interactivelyRemoveModule=fd;Ea.interactivelyAddModule=cd;Ea._askForModuleName=function(U,ua,M){var ea,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){switch(Za.nextAddress){case 1:return Za.yield(M.prompt("Enter module name",{input:ua,historyId:"lively.vm-editor-add-module-name"}),2);case 2:ua=Za.yieldResult;if(!ua)throw"Canceled";return Za.yield(U.normalize(ua),
3);case 3:return ea=Za.yieldResult,Za.yield(M.confirm(["Create module \n",{},ea,{fontStyle:"italic"}," ?",{}],{lineWrapping:!1}),4);case 4:Ka=Za.yieldResult;if(!Ka)throw"Canceled";return Za.return(ea)}})};Ea._searchForExistingFiles=function(U,ua,M){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){return String(ua).match(/^http/)?ea.return(Ea._searchForExistingFilesWeb(U,ua,M)):ea.return(Ea._searchForExistingFilesManually(U,ua,M))})};Ea._searchForExistingFilesManually=function(U,ua,
M){var ea,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){switch(Za.nextAddress){case 1:return Za.yield(U.world().multipleChoicePrompt("Add Module",{requester:U,choices:["Create New Module","Load Existing Module"]}),2);case 2:ea=Za.yieldResult;if("Create New Module"===ea)return Za.return("[create new module]");if("Load Existing Module"!==ea){Za.jumpTo(3);break}return Za.yield(U.world().prompt("URL of module?",{input:ua,requester:U,historyId:"lively.vm._searchForExistingFilesManually.url-of-module"}),
4);case 4:if(Ka=Za.yieldResult)return Za.return([Ka]);case 3:throw"Canceled";}})};Ea._searchForExistingFilesWeb=function(U,ua,M){function ea(pd){pd.name();return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes(pd.name())||M&&Ea.arr.pluck(M.modules,"name").includes(pd.url)?!0:!1}var Ka,Za,$b,Qc,Ub,vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pd){switch(pd.nextAddress){case 1:return(Ka=U.world())&&(Za=Ka.showLoadingIndicatorFor(U,"Loading existing modules...")),
pd.yield(Ea.resource(ua).dirList(5,{exclude:ea}),3);case 3:return pd.yield(pd.yieldResult.map(function($c){return $c.url}),2);case 2:return $b=pd.yieldResult,Qc=[{isListItem:!0,string:"[create new module]",value:"[create new module]"}].concat($b.filter(function($c){return $c.endsWith(".js")}).map(function($c){return{isListItem:!0,string:M&&0==$c.indexOf(M.address)?M.name+$c.slice(M.address.length):$c,value:$c}})),pd.yield(Promise.resolve(Za&&Za.remove()).then(function(){return U.world().filterableListPrompt("What module to load?",
Qc,Object.assign({filterLabel:"filter: ",multiselect:!0,requester:U},U?{extent:U.bounds().extent().withY(400).subXY(50,0)}:{}))}),4);case 4:Ub=pd.yieldResult;if(!Ub||"canceled"===Ub.status||!Ub.selected.length)throw"Canceled";vb=Ub.selected||Ub;Array.isArray(vb)||(vb=[vb]);return pd.return(vb)}})};Ea._createAndLoadModules=function(U,ua){var M,ea,Ka,Za,$b,Qc,Ub,vb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pd){switch(pd.nextAddress){case 1:Array.isArray(ua)||(ua=[ua]),M=[],ea=$jscomp.makeIterator(ua),
Ka=ea.next();case 2:if(Ka.done){pd.jumpTo(4);break}Za=Ka.value;return pd.yield(U.forgetModule(Za,{forgetDeps:!1,forgetEnv:!1}),5);case 5:return pd.yield(U.resourceEnsureExistance(Za,'"format esm";\n'),6);case 6:return $b=pd.yieldResult,Qc=Ea,Ub=Qc.isTestModule,pd.yield($b.read(),7);case 7:if(!Ub.call(Qc,pd.yieldResult)){pd.jumpTo(8);break}if(window.Mocha&&window.chai){pd.jumpTo(8);break}return pd.yield(System.import("mocha-es6"),10);case 10:return pd.yield(Ea.promise.waitFor(function(){return!!window.Mocha&&
!!window.chai}),8);case 8:return pd.setCatchFinallyBlocks(12),pd.yield(U.importModule(Za),14);case 14:M.push({name:Za});pd.leaveTryBlock(3);break;case 12:vb=pd.enterCatchBlock(),M.push({name:Za,error:vb});case 3:Ka=ea.next();pd.jumpTo(2);break;case 4:return pd.return(M)}})};Ea.modulesInPackage_defaultExclude=function(U){return[".git","node_modules",".optimized-loading-cache",".module_cache"].includes(U.name())?!0:!1};Ea.modulesInPackage=pc;Ea.obj=Jb;Ea.promise=rd;Ea.arr=tb;Ea.resource=Tb;Ea.isTestModule=
vc;Ea.isTestModule=vc;Ea.shortModuleName=ac;Ea.shortModuleName=ac;Ea.interactivelyChangeModule=Eb;Ea.interactivelyChangeModule=Eb;Ea.interactivelyReloadModule=ec;Ea.interactivelyReloadModule=ec;Ea.interactivelyUnloadModule=wc;Ea.interactivelyUnloadModule=wc;Ea.interactivelyRemoveModule=fd;Ea.interactivelyRemoveModule=fd;Ea.interactivelyAddModule=cd;Ea.interactivelyAddModule=cd;Ea.modulesInPackage=pc;Ea.modulesInPackage=pc;var Ba=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/interface.js");
Ba.todo=function(U){throw Error(U+" is not yet implemented!");};Ba.parseJsonLikeObj=Xd;Ba.arr=tb;Ba.Closure=yc;Ba.obj=Jb;Ba.resource=Tb;Ba.transform=vd;Ba.modules=zc;var xa=function(){};xa.prototype.dynamicCompletionsForPrefix=function(U,ua,M){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){Ba.todo("dynamicCompletionsForPrefix");ea.jumpToEnd()})};xa.prototype.runEval=function(U,ua){Ba.todo("runEval")};xa.prototype.resourceExists=function(U){Ba.todo("resourceExists")};xa.prototype.resourceEnsureExistance=
function(U,ua){Ba.todo("resourceEnsureExistance")};xa.prototype.resourceMkdir=function(U){Ba.todo("resourceMkdir")};xa.prototype.resourceRead=function(U){Ba.todo("resourceRead")};xa.prototype.resourceRemove=function(U){Ba.todo("resourceRemove")};xa.prototype.resourceWrite=function(U,ua){Ba.todo("resourceWrite")};xa.prototype.resourceCreateFiles=function(U,ua){Ba.todo("resourceCreateFiles")};xa.prototype.resourceDirList=function(U,ua,M){Ba.todo("resourceDirList")};xa.prototype.normalizeSync=function(U,
ua,M){Ba.todo("normalizeSync")};xa.prototype.normalize=function(U,ua,M){Ba.todo("normalize")};xa.prototype.printSystemConfig=function(){Ba.todo("printSystemConfig")};xa.prototype.getConfig=function(){Ba.todo("getConfig")};xa.prototype.setConfig=function(U){Ba.todo("setConfig")};xa.prototype.getPackages=function(U){Ba.todo("getPackages")};xa.prototype.isModuleLoaded=function(U,ua){Ba.todo("isModuleLoaded")};xa.prototype.doesModuleExist=function(U,ua){Ba.todo("doesModuleExist")};xa.prototype.getModules=
function(){var U=this,ua,M;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){return 1==ea.nextAddress?(ua=Ba.arr,M=ua.flatmap,ea.yield(U.getPackages(),2)):ea.return(M.call(ua,ea.yieldResult,function(Ka){return Ka.modules}))})};xa.prototype.getModule=function(U){var ua=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){return 1==M.nextAddress?M.yield(ua.getModules(),2):M.return(M.yieldResult.find(function(ea){return ea.name===U}))})};xa.prototype.getPackage=function(U){var ua=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){return 1==M.nextAddress?(U=U.replace(/\/+$/,""),M.yield(ua.getPackages(),2)):M.return(M.yieldResult.find(function(ea){return ea.address===U||ea.name===U}))})};xa.prototype.getPackageForModule=function(U){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){Ba.todo("getPackageForModule");ua.jumpToEnd()})};xa.prototype.systemConfChange=function(U){var ua=Ba.parseJsonLikeObj(U);["baseURL"].forEach(function(M){return delete ua[M]});
return this.setConfig(ua)};xa.prototype.resourcesOfPackage=function(U,ua){return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){Ba.todo("resourcesOfPackage");M.jumpToEnd()})};xa.prototype.registerPackage=function(U){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){Ba.todo("registerPackage");ua.jumpToEnd()})};xa.prototype.importPackage=function(U){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){Ba.todo("importPackage");ua.jumpToEnd()})};xa.prototype.removePackage=
function(U){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){Ba.todo("removePackage");ua.jumpToEnd()})};xa.prototype.reloadPackage=function(U){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){Ba.todo("reloadPackage");ua.jumpToEnd()})};xa.prototype.packageConfChange=function(U,ua){return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){Ba.todo("packageConfChange");M.jumpToEnd()})};xa.prototype.importModule=function(U){Ba.todo("importModule")};xa.prototype.forgetModule=
function(U,ua){Ba.todo("forgetModule")};xa.prototype.reloadModule=function(U,ua){Ba.todo("reloadModule")};xa.prototype.moduleFormat=function(U){Ba.todo("moduleFormat")};xa.prototype.moduleRead=function(U){Ba.todo("moduleRead")};xa.prototype.moduleSourceChange=function(U,ua,M){Ba.todo("moduleSourceChange")};xa.prototype.importsAndExportsOf=function(U,ua){Ba.todo("importsAndExportsOf")};xa.prototype.keyValueListOfVariablesInModule=function(U,ua){Ba.todo("keyValueListOfVariablesInModule")};xa.prototype.moduleWrite=
function(U,ua){return this.moduleSourceChange(U,ua)};Ba.AbstractCoreInterface=xa;var Qa=function(){var U=Ba.AbstractCoreInterface.call(this)||this;U.currentEval=null;return U};$jscomp.inherits(Qa,Ba.AbstractCoreInterface);Qa.prototype.runEval=function(U,ua){throw Error("Not yet implemented");};Qa.prototype.runEvalAndStringify=function(U,ua){var M=this;return this.currentEval?this.currentEval.then(function(){return M.runEvalAndStringify(U,ua)}):this.currentEval=Promise.resolve().then(function(){var ea,
Ka,Za,$b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qc){switch(Qc.nextAddress){case 1:return Qc.yield(M.runEval("\n        Promise.resolve((async "+Ba.transform.wrapInFunction(U)+')())\n          .then(function(result) { return JSON.stringify(result); })\n          .catch(function(err) { return {isError: true, value: err}; })\n          .then(function(result) {\n            if (!result || typeof result === "string") return result;\n            return JSON.stringify(result.isError ?\n              {isError: true, value: (result.value + "\\n" + result.value.stack) || String(result.value)} :\n              result)\n          });',
Object.assign({targetModule:"lively://remote-lively-system/runEvalAndStringify",promiseTimeout:3E4,waitForPromise:!0},ua)),2);case 2:if((ea=Qc.yieldResult)&&ea.isError)throw Error(String(ea.value||ea.error));if(!ea||!ea.value)return Qc.return(null);if(Ka=ea.promisedValue){Qc.jumpTo(3);break}return Qc.yield(ea.value,4);case 4:Ka=Qc.yieldResult;case 3:Za=Ka;if(!Za)return Qc.return();if("undefined"===Za)return Qc.return(void 0);if("null"===Za)return Qc.return(null);if("true"===Za)return Qc.return(!0);
if("false"===Za)return Qc.return(!1);try{$b=JSON.parse(Za)}catch(Ub){return Qc.return(Za)}if($b&&$b.isError)throw Error(String($b.value));return Qc.return($b)}})}).then(function(ea){delete M.currentEval;return ea},function(ea){delete M.currentEval;return Promise.reject(ea)})};Qa.prototype.dynamicCompletionsForPrefix=function(U,ua,M){var ea=this,Ka,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){Ka=Ba.obj.isString(M.context)?M.context:!1;M=Ba.obj.dissoc(M,["systemInterface","System",
"context"]);Za="\n      var prefix = "+JSON.stringify(ua)+",\n          opts = "+JSON.stringify(M)+";\n      opts.context = "+Ka+';\n      opts.classTransform = (await System.import("lively.classes")).classToFunctionTransform;\n      var evalFn = code => lively.vm.runEval(code, opts);\n      if (typeof System === "undefined") delete opts.targetModule;\n      lively.vm.completions.getCompletions(evalFn, prefix).then(function(result) {\n        if (result.isError) throw result.value;\n        return {\n          completions: result.completions,\n          prefix: result.startLetters\n        }\n      });';
return $b.return(ea.runEvalAndStringify(Za))})};Qa.prototype.evalWithResource=function(U,ua,M){return this.runEvalAndStringify('\n      var {resource} = (typeof lively !== "undefined" && lively.resources)\n                    || await System.import("lively.resources");\n      await resource("'+U+'").'+ua+"("+(M?JSON.stringify(M):"")+");\n    ")};Qa.prototype.resourceExists=function(U){return this.evalWithResource(U,"exists")};Qa.prototype.resourceEnsureExistance=function(U,ua){return this.evalWithResource(U,
"ensureExistance",ua)};Qa.prototype.resourceMkdir=function(U){return this.evalWithResource(U,"mkdir")};Qa.prototype.resourceRead=function(U){return this.evalWithResource(U,"read")};Qa.prototype.resourceRemove=function(U){return this.evalWithResource(U,"remove")};Qa.prototype.resourceWrite=function(U,ua){return this.evalWithResource(U,"write",ua)};Qa.prototype.resourceCreateFiles=function(U,ua){return this.runEvalAndStringify('var {createFiles} = await System.import("lively.resources"); await createFiles("'+
U+'", '+JSON.stringify(ua)+")")};Qa.prototype.resourceDirList=function(U,ua,M){return this.runEvalAndStringify('\n      var {resource} = await System.import("lively.resources");\n      (await resource("'+U+'").dirList('+JSON.stringify(ua)+", "+JSON.stringify(M)+"))\n        .map(({url}) => ({url}))")};Qa.prototype.livelySystemAccessor=function(U){U=void 0===U?"livelySystem":U;return"var "+U+' = (typeof lively !== "undefined" && lively.systemInterface)\n      || System.get(System.decanonicalize("lively-system-interface"))\n      || (typeof lively !== "undefined" && lively.modules && await lively.modules.importPackage("lively-system-interface"));\n    if (!'+
U+') throw new Error("lively-system-interface not available!");'};Qa.prototype.normalizeSync=function(U,ua,M){return this.runEvalAndStringify("lively.modules.System.decanonicalize("+JSON.stringify(U)+", "+JSON.stringify(ua)+", "+M+")")};Qa.prototype.normalize=function(U,ua,M){return this.runEvalAndStringify("lively.modules.System.normalize("+JSON.stringify(U)+", "+JSON.stringify(ua)+", "+JSON.stringify(M)+")")};Qa.prototype.printSystemConfig=function(){return this.runEvalAndStringify("lively.modules.printSystemConfig()")};
Qa.prototype.getConfig=function(){return this.runEvalAndStringify('var c = Object.assign({}, lively.modules.System.getConfig()); for (var name in c) if (name.indexOf("__lively.modules__") === 0 || name.indexOf("loads") === 0) delete c[name]; c')};Qa.prototype.setConfig=function(U){return this.runEvalAndStringify("lively.modules.System.config("+JSON.stringify(U)+")")};Qa.prototype.getPackages=function(U){U=Object.assign({excluded:[]},U);U.excluded=U.excluded.map(String);return this.runEvalAndStringify("\n      "+
this.livelySystemAccessor()+";\n      var options = "+JSON.stringify(U)+';\n      options.excluded = options.excluded.map(ea => {\n        let evaled = lively.vm.syncEval(ea).value;\n        return typeof evaled === "function" ? evaled : ea;\n      });\n      await livelySystem.localInterface.getPackages(options)\n        .map(ea => Object.assign({}, ea, {System: null}));')};Qa.prototype.getPackageForModule=function(U){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.getPackageForModule("+
JSON.stringify(U)+")")};Qa.prototype.isModuleLoaded=function(U,ua){return this.runEvalAndStringify('lively.modules.isModuleLoaded("'+U+'", '+ua+")")};Qa.prototype.doesModuleExist=function(U,ua){return this.runEvalAndStringify('lively.modules.doesModuleExist("'+U+'", '+ua+")")};Qa.prototype.registerPackage=function(U){var ua=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){return M.return(ua.runEvalAndStringify("lively.modules.registerPackage("+JSON.stringify(U)+")"))})};Qa.prototype.importPackage=
function(U){var ua=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){return M.return(ua.runEvalAndStringify("lively.modules.importPackage("+JSON.stringify(U)+")"))})};Qa.prototype.removePackage=function(U){var ua=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){return M.return(ua.runEvalAndStringify("lively.modules.removePackage("+JSON.stringify(U)+")"))})};Qa.prototype.reloadPackage=function(U,ua){var M=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){return ea.return(M.runEvalAndStringify("lively.modules.reloadPackage("+
JSON.stringify(U)+", "+JSON.stringify(ua)+")"))})};Qa.prototype.packageConfChange=function(U,ua){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.packageConfChange("+JSON.stringify(U)+", "+JSON.stringify(ua)+")")};Qa.prototype.resourcesOfPackage=function(U,ua){ua=void 0===ua?[".git","node_modules",".module_cache","lively.next-node_modules"]:ua;var M=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){U.address&&(U=
U.address);return ea.return(M.runEvalAndStringify("\n      "+M.livelySystemAccessor()+";\n      await livelySystem.localInterface.resourcesOfPackage("+JSON.stringify(U)+", "+JSON.stringify(ua)+");"))})};Qa.prototype.getModule=function(U){var ua=this,M;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){if(1==ea.nextAddress)return ea.yield(ua.getModules(),2);M=ea.yieldResult.find(function(Ka){return Ka.name===U});return ea.return(M?Ba.modules.module(M.name):null)})};Qa.prototype.importModule=
function(U){return this.runEvalAndStringify("lively.modules.System.import("+JSON.stringify(U)+")")};Qa.prototype.forgetModule=function(U,ua){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(U)+").unload("+JSON.stringify(ua)+")")};Qa.prototype.reloadModule=function(U,ua){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(U)+").reload("+JSON.stringify(ua)+")")};Qa.prototype.moduleFormat=function(U){return this.runEvalAndStringify("lively.modules.module("+
JSON.stringify(U)+").format();")};Qa.prototype.moduleRead=function(U){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(U)+").source()")};Qa.prototype.moduleSourceChange=function(U,ua,M){return this.runEvalAndStringify("lively.modules.module("+JSON.stringify(U)+").changeSource("+JSON.stringify(ua)+", "+JSON.stringify(M)+")")};Qa.prototype.keyValueListOfVariablesInModule=function(U,ua){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.keyValueListOfVariablesInModule("+
JSON.stringify(U)+", "+JSON.stringify(ua)+")")};Qa.prototype.importsAndExportsOf=function(U,ua){return this.runEvalAndStringify("({\n      imports: await lively.modules.module("+JSON.stringify(U)+").imports(),\n      exports: await lively.modules.module("+JSON.stringify(U)+").exports()})")};Qa.prototype.exportsOfModules=function(U){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+"\n      const options = "+JSON.stringify(U)+";\n      options.excludedPackages = ["+U.excludedPackages.map(function(ua){return"function"===
typeof ua?ua.toString():JSON.stringify(ua)}).join(",")+"]\n      await livelySystem.localInterface.exportsOfModules(options)")};Qa.prototype.searchInPackage=function(U,ua,M){return this.runEvalAndStringify("\n      "+this.livelySystemAccessor()+";\n      await livelySystem.localInterface.searchInPackage("+JSON.stringify(U)+", "+JSON.stringify(ua)+", "+JSON.stringify(M)+")")};Qa.prototype.loadMochaTestFile=function(U,ua){ua=void 0===ua?[]:ua;var M=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){return ea.return(M.runEvalAndStringify("\n      "+
M.livelySystemAccessor()+";\n      var {testsByFile} = await livelySystem.localInterface.loadMochaTestFile("+JSON.stringify(U)+", "+JSON.stringify(ua)+"), result;\n      result = {testsByFile}"))})};Qa.prototype.runMochaTests=function(U,ua,M,ea){var Ka=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){U&&U instanceof RegExp&&(U={isRegExp:!0,value:String(U).replace(/^\/|\/$/g,"")});return Za.return(Ka.runEvalAndStringify("\n      var grep = "+JSON.stringify(U)+";\n      if (grep && grep.isRegExp) grep = new RegExp(grep.value);\n      "+
Ka.livelySystemAccessor()+";\n      var {testsByFile, isError, value: error} = await livelySystem.localInterface.runMochaTests(grep, "+JSON.stringify(ua||[])+"), result;\n      error = error ? String(error.stack || error) : null;\n      if (testsByFile) {\n        testsByFile.forEach(ea =>\n          ea.tests.forEach(ea => {\n            if (!ea.error) return;\n            var {message, stack, actual, expected} = ea.error;\n            ea.error = {\n              message: message || String(ea.error),\n              stack: stack,\n              actual, exected\n            }\n          }));\n      }\n      result = {testsByFile, isError, error}"))})};
Ba.RemoteCoreInterface=Qa;var wb=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/local-system.js");wb.obj=Jb;wb.string=Ec;wb.arr=tb;wb.resource=Tb;wb.createFiles=Mc;wb.ast=mb;wb.modules=zc;wb.vm=zd;wb.parseJsonLikeObj=Xd;wb.AbstractCoreInterface=xa;wb.classToFunctionTransform=ne;xa=function(){return wb.AbstractCoreInterface.apply(this,arguments)||this};$jscomp.inherits(xa,wb.AbstractCoreInterface);xa.prototype.dynamicCompletionsForPrefix=function(U,ua,M){var ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){if(1==
Ka.nextAddress)return Ka.yield(wb.vm.completions.getCompletions(function(Za){return wb.vm.runEval(Za.replace("return ",""),Object.assign({targetModule:U,classTransform:wb.classToFunctionTransform},M))},ua),2);ea=Ka.yieldResult;if(ea.isError)throw ea.value;return Ka.return({completions:ea.completions,prefix:ea.startLetters})})};xa.prototype.runEval=function(U,ua){return wb.vm.runEval(U,Object.assign({classTransform:wb.classToFunctionTransform},ua))};xa.prototype.resourceExists=function(U){return wb.resource(U).exists()};
xa.prototype.resourceEnsureExistance=function(U,ua){return wb.resource(U).ensureExistance(ua)};xa.prototype.resourceMkdir=function(U){return wb.resource(U).mkdir()};xa.prototype.resourceRead=function(U){return wb.resource(U).read()};xa.prototype.resourceRemove=function(U){return wb.resource(U).remove()};xa.prototype.resourceWrite=function(U,ua){return wb.resource(U).write(ua)};xa.prototype.resourceCreateFiles=function(U,ua){return wb.createFiles(U,ua)};xa.prototype.resourceDirList=function(U,ua,M){return wb.resource(U).dirList(ua,
M)};xa.prototype.normalizeSync=function(U,ua,M){return System.decanonicalize(U,ua,M)};xa.prototype.normalize=function(U,ua,M){return System.normalize(U,ua,M)};xa.prototype.printSystemConfig=function(){return wb.modules.printSystemConfig()};xa.prototype.getConfig=function(){return System.getConfig()};xa.prototype.setConfig=function(U){wb.modules.System.config(U)};xa.prototype.getPackages=function(U){U=Object.assign({},U);U=void 0===U.excluded?[]:U.excluded;var ua=U.filter(function(ea){return"string"===
typeof ea}),M=U.filter(function(ea){return"function"===typeof ea});ua=ua.concat(ua.map(function(ea){return System.decanonicalize(ea.replace(/\/?$/,"/")).replace(/\/$/,"")}));return wb.modules.getPackages().filter(function(ea){return!ua.includes(ea.url)&&!M.some(function(Ka){return Ka(ea.url)})})};xa.prototype.registerPackage=function(U){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return ua.return(wb.modules.registerPackage(U))})};xa.prototype.importPackage=function(U){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return ua.return(wb.modules.importPackage(U))})};
xa.prototype.removePackage=function(U){return $jscomp.asyncExecutePromiseGeneratorProgram(function(ua){return ua.return(wb.modules.removePackage(U))})};xa.prototype.reloadPackage=function(U,ua){return $jscomp.asyncExecutePromiseGeneratorProgram(function(M){return M.return(wb.modules.reloadPackage(U,ua))})};xa.prototype.packageConfChange=function(U,ua){var M=this,ea,Ka,Za,$b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Qc){if(1==Qc.nextAddress)return ea=wb.modules.System,Ka=wb.parseJsonLikeObj(U),
Za=JSON.stringify(Ka,null,2),Qc.yield(wb.modules.module(ua).changeSource(Za,{doEval:!1}),2);if(3!=Qc.nextAddress)return ea.set(ua,ea.newModule(Ka)),Qc.yield(M.getPackageForModule(ua),3);($b=Qc.yieldResult)&&wb.modules.applyPackageConfig(Ka,$b.address);Qc.jumpToEnd()})};xa.prototype.resourcesOfPackage=function(U,ua){ua=void 0===ua?[".git","node_modules",".module_cache"]:ua;var M,ea,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){if(1==Za.nextAddress)return Za.setCatchFinallyBlocks(2),
M=U.address?U.address:U,ea=wb.modules.getPackage(M),Za.yield(ea.resources(void 0,ua),4);if(2!=Za.nextAddress)return Za.return(Za.yieldResult.map(function($b){return Object.assign($b,{package:$b.package.url})}));Ka=Za.enterCatchBlock();console.warn("resourcesOfPackage error for "+U+": "+Ka);return Za.return([])})};xa.prototype.getPackageForModule=function(U){return(U=wb.modules.getPackageOfModule(U))?U.asSpec():U};xa.prototype.isModuleLoaded=function(U,ua){return wb.modules.isModuleLoaded(U,ua)};xa.prototype.doesModuleExist=
function(U,ua){return wb.modules.isModuleLoaded(U,ua)};xa.prototype.getModule=function(U){return wb.modules.module(U)};xa.prototype.importModule=function(U){return wb.modules.System.import(U)};xa.prototype.forgetModule=function(U,ua){return wb.modules.module(U).unload(ua)};xa.prototype.reloadModule=function(U,ua){return wb.modules.module(U).reload(ua)};xa.prototype.moduleFormat=function(U){return wb.modules.module(U).format()};xa.prototype.moduleRead=function(U){return wb.modules.module(U).source()};
xa.prototype.moduleSourceChange=function(U,ua,M){return wb.modules.module(U).changeSource(ua,M)};xa.prototype.keyValueListOfVariablesInModule=function(U,ua){var M=this,ea,Ka,Za,$b,Qc,Ub,vb,pd;return $jscomp.asyncExecutePromiseGeneratorProgram(function($c){switch($c.nextAddress){case 1:if(ua){$c.jumpTo(2);break}return $c.yield(M.resourceRead(U),3);case 3:ua=$c.yieldResult;case 2:return ea="string"===typeof ua?wb.ast.parse(ua):ua,Ka=M.normalizeSync(U),M.moduleFormat(Ka),Za=wb.modules.module(Ka).env().recorder,
$c.yield(M.importsAndExportsOf(Ka,ea),4);case 4:return $b=$c.yieldResult,Qc=wb.ast.query.topLevelDeclsAndRefs(ea),Ub=wb.arr.sortByKey(wb.ast.query.declarationsOfScope(Qc.scope,!0),"start"),vb=wb.arr.pluck(Qc.scope.importSpecifiers,"name"),pd=0,$c.return(Ub.map(function(Ta){var nb=Ta.name.length,xc=$b.exports.find(function(Bc){return Bc.local===Ta.name}),bb=wb.arr.include(vb,Ta.name);xc&&(nb+=9);bb&&(nb+=9);pd=Math.max(pd,nb);return{isExport:xc,isImport:bb,name:Ta.name,value:Za[Ta.name],node:Ta,printedName:Ta.name+
(xc?" [export]":"")+(bb?" [import]":""),printedValue:wb.obj.inspect(Za[Ta.name],{maxDepth:1}).replace(/\n/g,"")}}).map(function(Ta){return{isListItem:!0,value:Ta,string:Ta.printedName+wb.string.indent(" = "+Ta.printedValue," ",pd-Ta.printedName.length)}}))}})};xa.prototype.importsAndExportsOf=function(U,ua){var M;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ea){return 1==ea.nextAddress?ea.yield(wb.modules.module(U).imports(ua),2):3!=ea.nextAddress?(M=ea.yieldResult,ea.yield(wb.modules.module(U).exports(ua),
3)):ea.return({imports:M,exports:ea.yieldResult})})};xa.prototype.exportsOfModules=function(U){return wb.modules.ExportLookup.run(System,U)};xa.prototype.searchInPackage=function(U,ua,M){return wb.modules.getPackage(U).search(ua,M)};xa.prototype.runMochaTests=function(U,ua,M,ea){var Ka,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){if(1==$b.nextAddress)return $b.yield(System.import("lively-system-interface/commands/mocha-tests.js"),2);Ka=$b.yieldResult;Za=Ka.runMochaTests;return $b.return(Za(U,
ua,M,ea))})};xa.prototype.loadMochaTestFile=function(U,ua){var M,ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ka){if(1==Ka.nextAddress)return Ka.yield(System.import("lively-system-interface/commands/mocha-tests.js"),2);M=Ka.yieldResult;ea=M.loadMochaTestFile;return Ka.return(ea(U,ua))})};$jscomp.global.Object.defineProperties(xa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"local"}}});wb.LocalCoreInterface=xa;var fc=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/http-interface.js");
fc.evalStrategies=De;fc.RemoteCoreInterface=Qa;var $a=function(U){var ua=fc.RemoteCoreInterface.call(this)||this;ua.currentEval=null;ua.url=U;ua.server=new fc.evalStrategies.HttpEvalStrategy(U);return ua};$jscomp.inherits($a,fc.RemoteCoreInterface);$a.prototype.runEval=function(U,ua){return this.server.runEval(U,ua)};$jscomp.global.Object.defineProperties($a.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this.url}},description:{configurable:!0,enumerable:!0,get:function(){return this.url.replace(/^https?:\/\//,
"")}}});fc.HTTPCoreInterface=$a;var ib=lively.FreezerRuntime.recorderFor("lively-system-interface/interfaces/l2l-interface.js");ib.evalStrategies=De;ib.RemoteCoreInterface=Qa;Qa=function(U,ua){var M=ib.RemoteCoreInterface.call(this)||this;M.targetId=U;M.peer=ua;return M};$jscomp.inherits(Qa,ib.RemoteCoreInterface);Qa.prototype.isConnected=function(){var U=this,ua,M,ea,Ka,Za;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){if(1==$b.nextAddress)return ua=U,M=ua.client,ea=ua.targetId,
$b.yield(M.sendToAndWait(M.trackerId,"getClients",{}),2);Ka=$b.yieldResult;Za=Ka.data;return $b.return(Za.some(function(Qc){Qc=$jscomp.makeIterator(Qc).next().value;return ea===Qc}))})};Qa.prototype.runEval=function(U,ua){var M=this,ea,Ka;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){ea=M.client;if(!ea)throw Error("No lively.2lively default client available!");Ka=new ib.evalStrategies.L2LEvalStrategy(ea,M.targetId);return Za.return(Ka.runEval(U,ua))})};$jscomp.global.Object.defineProperties(Qa.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"l2l "+this.targetId}},description:{configurable:!0,enumerable:!0,get:function(){var U=this.peer,ua="l2l "+this.targetId.slice(0,5);if(U){var M=U.location,ea=U.type,Ka=U.user;U=U.world;ea&&(ua+=", "+ea);M&&(ua+=", "+M.replace(/^https?:\/\//,"")+(U?"/"+U:""));Ka&&(ua+=", "+Ka.name)}return ua}},client:{configurable:!0,enumerable:!0,get:function(){return(lively.modules.module("lively.2lively/client.js").get()||{default:lively.l2l.L2LClient}).default.default()}}});
ib.L2LCoreInterface=Qa;var ab=lively.FreezerRuntime.recorderFor("lively-system-interface/index.js");ab.systemInterfaceNamed=cb;ab.interactivelyCreatePackage=Qb;ab.interactivelyLoadPackage=qc;ab.interactivelyReloadPackage=ld;ab.interactivelyUnloadPackage=Pb;ab.interactivelyRemovePackage=ud;ab.showExportsAndImportsOf=Ed;ab.shortModuleName=ac;ab.interactivelyChangeModule=Eb;ab.interactivelyReloadModule=ec;ab.interactivelyUnloadModule=wc;ab.interactivelyRemoveModule=fd;ab.interactivelyAddModule=cd;ab.modulesInPackage=
pc;ab.LocalCoreInterface=xa;ab.HTTPCoreInterface=$a;ab.L2LCoreInterface=Qa;Qa=function(U){this.coreInterface=U};Qa.prototype.dynamicCompletionsForPrefix=function(U,ua,M){return this.coreInterface.dynamicCompletionsForPrefix(U,ua,M)};Qa.prototype.runEval=function(U,ua){return this.coreInterface.runEval(U,ua)};Qa.prototype.printSystemConfig=function(U,ua,M){return this.coreInterface.printSystemConfig(U,ua,M)};Qa.prototype.getConfig=function(U,ua,M){return this.coreInterface.getConfig(U,ua,M)};Qa.prototype.getPackages=
function(U){return this.coreInterface.getPackages(U)};Qa.prototype.getModules=function(U,ua,M){return this.coreInterface.getModules(U,ua,M)};Qa.prototype.getModule=function(U,ua,M){return this.coreInterface.getModule(U,ua,M)};Qa.prototype.getPackage=function(U,ua,M){return this.coreInterface.getPackage(U,ua,M)};Qa.prototype.getPackageForModule=function(U,ua,M){return this.coreInterface.getPackageForModule(U,ua,M)};Qa.prototype.resourcesOfPackage=function(U,ua){return this.coreInterface.resourcesOfPackage(U,
ua)};Qa.prototype.systemConfChange=function(U,ua,M){return this.coreInterface.systemConfChange(U,ua,M)};Qa.prototype.registerPackage=function(U){return this.coreInterface.registerPackage(U)};Qa.prototype.importPackage=function(U){return this.coreInterface.importPackage(U)};Qa.prototype.removePackage=function(U){return this.coreInterface.removePackage(U)};Qa.prototype.reloadPackage=function(U){return this.coreInterface.reloadPackage(U)};Qa.prototype.packageConfChange=function(U,ua){return this.coreInterface.packageConfChange(U,
ua)};Qa.prototype.keyValueListOfVariablesInModule=function(U,ua){return this.coreInterface.keyValueListOfVariablesInModule(U,ua)};Qa.prototype.interactivelyCreatePackage=function(U){return ab.interactivelyCreatePackage(this.coreInterface,U)};Qa.prototype.interactivelyLoadPackage=function(U,ua){return ab.interactivelyLoadPackage(this.coreInterface,U,ua)};Qa.prototype.interactivelyReloadPackage=function(U,ua){return ab.interactivelyReloadPackage(this.coreInterface,U,ua)};Qa.prototype.interactivelyUnloadPackage=
function(U,ua,M){return ab.interactivelyUnloadPackage(this.coreInterface,U,ua,M)};Qa.prototype.interactivelyRemovePackage=function(U,ua){return ab.interactivelyRemovePackage(this.coreInterface,U,ua)};Qa.prototype.isModuleLoaded=function(U,ua){return this.coreInterface.isModuleLoaded(U,ua)};Qa.prototype.doesModuleExist=function(U,ua){return this.coreInterface.doesModuleExist(U,ua)};Qa.prototype.importModule=function(U){return this.coreInterface.importModule(U)};Qa.prototype.forgetModule=function(U,
ua){return this.coreInterface.forgetModule(U,ua)};Qa.prototype.reloadModule=function(U,ua){return this.coreInterface.reloadModule(U,ua)};Qa.prototype.moduleFormat=function(U){return this.coreInterface.moduleFormat(U)};Qa.prototype.moduleRead=function(U){return this.coreInterface.moduleRead(U)};Qa.prototype.moduleWrite=function(U,ua){return this.coreInterface.moduleWrite(U,ua)};Qa.prototype.getModulesInPackage=function(U){return ab.modulesInPackage(this.coreInterface,U)};Qa.prototype.shortModuleName=
function(U,ua){return ab.shortModuleName(this.coreInterface,U,ua)};Qa.prototype.interactivelyChangeModule=function(U,ua,M){return ab.interactivelyChangeModule(this.coreInterface,U,ua,M)};Qa.prototype.interactivelyReloadModule=function(U,ua){return ab.interactivelyReloadModule(this.coreInterface,U,ua)};Qa.prototype.interactivelyUnloadModule=function(U,ua){return ab.interactivelyUnloadModule(this.coreInterface,U,ua)};Qa.prototype.interactivelyRemoveModule=function(U,ua){return ab.interactivelyRemoveModule(this.coreInterface,
U,ua)};Qa.prototype.interactivelyAddModule=function(U,ua){return ab.interactivelyAddModule(this.coreInterface,U,ua)};Qa.prototype.showExportsAndImportsOf=function(U,ua){return ab.showExportsAndImportsOf(this.coreInterface,U,ua)};Qa.prototype.exportsOfModules=function(U){return this.coreInterface.exportsOfModules(U)};Qa.prototype.searchInPackage=function(U,ua,M){return this.coreInterface.searchInPackage(U,ua,M)};Qa.prototype.searchInAllPackages=function(U,ua){ua=void 0===ua?{}:ua;var M=this,ea,Ka,
Za,$b,Qc,Ub,vb,pd;return $jscomp.asyncExecutePromiseGeneratorProgram(function($c){switch($c.nextAddress){case 1:return(ea=ua.progress)&&ea.step("Fetching Packages...",0),$c.yield(M.coreInterface.getPackages({excluded:ua.excludedPackages}),2);case 2:Ka=$c.yieldResult,Za=[],ea&&ea.step("Fetching Packages...",.1),$b=0;case 3:if(!($b<Ka.length)){$c.jumpTo(5);break}Qc=Ka[$b];Ub=Qc.url;if(!Ub||"no group"===Ub){$c.jumpTo(4);break}ea&&ea.step(Ub.replace(System.baseURL,"").slice(0,20),.1+$b/Ka.length*.9);
$c.setCatchFinallyBlocks(6);return $c.yield(M.coreInterface.searchInPackage(Ub,U,ua),8);case 8:vb=$c.yieldResult;Za=Za.concat(vb);$c.leaveTryBlock(4);break;case 6:pd=$c.enterCatchBlock(),console.error("Error searching in package "+Ub+":\n"+pd.stack);case 4:$b++;$c.jumpTo(3);break;case 5:return $c.return(Za)}})};Qa.prototype.loadMochaTestFile=function(U,ua){return this.coreInterface.loadMochaTestFile(U,ua)};Qa.prototype.runMochaTests=function(U,ua,M,ea){return this.coreInterface.runMochaTests(U,ua,
M,ea)};$jscomp.global.Object.defineProperties(Qa.prototype,{isSystemInterface:{configurable:!0,enumerable:!0,get:function(){return!0}},name:{configurable:!0,enumerable:!0,get:function(){return this.coreInterface.name}}});ta("Interface",Qa);ab.Interface=Qa;ab.systemInterfaceNamed=cb;ab.systemInterfaceNamed=cb;Qa=ta("localInterface",new ab.Interface(new ab.LocalCoreInterface));ab.localInterface=Qa;ab.localInterface=Qa;ab.localInterface=Qa;ab.httpInterfaces={};Qa=ta("serverInterfaceFor",function(U){return ab.httpInterfaces[U]||
(ab.httpInterfaces[U]=new ab.Interface(new ab.HTTPCoreInterface(U)))});ab.serverInterfaceFor=Qa;ab.serverInterfaceFor=Qa;ab.serverInterfaceFor=Qa;ab.l2lInterfaces={};Qa=ta("l2lInterfaceFor",function(U,ua){return ab.l2lInterfaces[U]||(ab.l2lInterfaces[U]=new ab.Interface(new ab.L2LCoreInterface(U,ua)))});ab.l2lInterfaceFor=Qa;ab.l2lInterfaceFor=Qa;ab.l2lInterfaceFor=Qa}}});
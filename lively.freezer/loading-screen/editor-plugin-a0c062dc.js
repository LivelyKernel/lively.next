System.register(["./__root_module__-3d4e820f.js","./index-cbb45750.js","./index-7fab6f02.js"],function(ra){var kb,zb,Sb,Mb,Fd,Jc,wd,Kc,Fc,Wc,hd,Id,nd,Xc,Na,nb,Pb,Wb,Pc,Bd,Hb,Ub,vb,kc,xc,Dc,Gb,$a,dc,oc,sa,Ca,bb,rb,qb,Sa,Ta,sb,Zb,rc,Xb,wc,I,T,ua;return{setters:[function(Da){kb=Da.C;zb=Da.as;Sb=Da.a6;Mb=Da.a1;Fd=Da.a3;Jc=Da.an;wd=Da.bg;Kc=Da.aU;Fc=Da.aq;Wc=Da.s;hd=Da.aP;Id=Da.bn;nd=Da.bo;Xc=Da.a7;Na=Da.au;nb=Da.ap;Pb=Da.ar;Wb=Da.bp;Pc=Da.bq;Bd=Da.a2;Hb=Da.P;Ub=Da.$;vb=Da.aW;kc=Da.ai;xc=Da.aj;Dc=
Da.ak;Gb=Da.al;$a=Da.aB;dc=Da.aZ;oc=Da.ax;sa=Da.ao;Ca=Da.aa;bb=Da.br;rb=Da.L;qb=Da.bs;Sa=Da.b2;Ta=Da.bh;sb=Da.b1;Zb=Da.bt;rc=Da.at},function(Da){Xb=Da.M;wc=Da.I;I=Da.v;T=Da.p},function(Da){ua=Da.localInterface}],execute:function(){function Da(ta,Ma){if(!0===Ma)return Ma;if(ta.copyState)return ta.copyState(Ma);ta={};for(var ob in Ma){var R=Ma[ob];R instanceof Array&&(R=R.concat([]));ta[ob]=R}return ta}function Kb(ta,Ma,ob){return ta.startState?ta.startState(Ma,ob):!0}function Db(ta,Ma){return H.modes[ta]=
Ma}function Fa(ta){if("string"==typeof ta&&H.mimeModes.hasOwnProperty(ta))ta=H.mimeModes[ta];else if(ta&&"string"==typeof ta.name&&H.mimeModes.hasOwnProperty(ta.name)){var Ma=H.mimeModes[ta.name];"string"==typeof Ma&&(Ma={name:Ma});ta=Object.assign({},Ma,ta);ta.name=Ma.name}else{if("string"==typeof ta&&/^[\w\-]+\/[\w\-]+\+xml$/.test(ta))return Fa("application/xml");if("string"==typeof ta&&/^[\w\-]+\/[\w\-]+\+json$/.test(ta))return Fa("application/json")}return"string"==typeof ta?{name:ta}:ta||{name:"null"}}
function ac(ta,Ma){Ma=H.resolveMode(Ma);"string"===typeof Ma&&(Ma={name:Ma});if(!Ma.name)throw Error("parserConfig does not have a name of the mode to get");var ob=H.modes[Ma.name];if(!ob)return ac(ta,"text/plain");ta=Object.assign({indentUnit:2},ta);return Object.assign(ob(ta,Ma),{name:Ma.name})}function Gd(ta,Ma){for(var ob;ta.innerMode;){ob=ta.innerMode(Ma);if(!ob||ob.mode==ta)break;Ma=ob.state;ta=ob.mode}return ob||{mode:ta,state:Ma}}function fd(ta,Ma){H.mimeModes[ta]=Ma}function Gc(ta,Ma,ob){}
function Ea(ta,Ma,ob,R,va,Ya,gb){var lc=ta.editorPlugin._tokenizerValidBefore;lc&&lc.row>=ob&&(lc.row=ob-1);var $b=H.linesToTokenize(ta.document,ob,R,lc);lc=$b.lines;$b=$b.state;if(!lc.length)return!1;$b=$b?H.copyState(Ma,$b):H.startState(Ma);for(var Yc=0;Yc<lc.length;Yc++){var Sc=lc[Yc],Uc=Sc.row;Uc>=ob&&Uc<=R&&H.indentLine(ta,Ma,Sc,$b,va,Ya,gb);$b=H.tokenizeLine(Ma,lc[Yc],$b,function(){})}return!0}function Oc(ta,Ma,ob,R,va,Ya,gb){Ma=H.linesToTokenize(Ma,ob,R,va);ob=Ma.lines;H.tokenizeLines(ta,ob,
Ma.state,Ya,gb);return ob}function Va(ta,Ma,ob,R,va){var Ya=[],gb,lc=function(Sc){return Ya.push(gb=[])},$b=function(Sc,Uc,Xd,qe,tf,Ag,yh){return gb.push(Xd,qe,Sc,tf.current(),Uc.localMode||yh)};try{var Yc=H.visitDocumentTokens(ta,Ma,ob,R,va,lc,$b)}catch(Sc){Ya.length=0,Yc=H.visitDocumentTokens(ta,Ma,ob,R,null,lc,$b)}return{tokens:Ya,lines:Yc}}function kd(ta,Ma,ob,R,va){null==Ma&&(Ma=ta.search(/[^\s\u00a0]/),-1==Ma&&(Ma=ta.length));R=R||0;for(va=va||0;;){var Ya=ta.indexOf("\t",R);if(0>Ya||Ya>=Ma)return va+
(Ma-R);va+=Ya-R;va+=ob-va%ob;R=Ya+1}}function Ka(ta){ta=ta.toLowerCase();for(var Ma=0;Ma<H.modeInfo.length;Ma++){var ob=H.modeInfo[Ma];if(ob.mime==ta)return ob;if(ob.mimes)for(var R=0;R<ob.mimes.length;R++)if(ob.mimes[R]==ta)return ob}if(/\+xml$/.test(ta))return Ka("application/xml");if(/\+json$/.test(ta))return Ka("application/json")}function Wa(ta){for(var Ma=0;Ma<H.modeInfo.length;Ma++){var ob=H.modeInfo[Ma];if(ob.ext)for(var R=0;R<ob.ext.length;R++)if(ob.ext[R]==ta)return ob}}function db(ta){for(var Ma=
0;Ma<H.modeInfo.length;Ma++){var ob=H.modeInfo[Ma];if(ob.file&&ob.file.test(ta))return ob}Ma=ta.lastIndexOf(".");if(ta=-1<Ma&&ta.substring(Ma+1,ta.length))return H.findModeByExtension(ta)}function Zc(ta){ta=ta.toLowerCase();for(var Ma=0;Ma<H.modeInfo.length;Ma++){var ob=H.modeInfo[Ma];if(ob.name.toLowerCase()==ta)return ob;if(ob.alias)for(var R=0;R<ob.alias.length;R++)if(ob.alias[R].toLowerCase()==ta)return ob}}function xd(ta){if(!ta)return String(ta);if(Array.isArray(ta))return"["+ta.map(xd).join(",")+
"]";if("symbol"===typeof ta)return sd.printSymbol(ta);try{return String(ta)}catch(Ma){return"Cannot print object: "+Ma}}function Wd(ta,Ma){return!sd.arr.every(Ma.map(function(ob){return ta[ob]}),function(ob){return sd.obj.equals(ob,ta&&ta.valueOf())})}function le(ta){if(sd.obj.isPrimitive(ta))var Ma=sd.string.print(ta);else Array.isArray(ta)?((Ma=3<ta.length)&&(ta=ta.slice(0,3)),ta=sd.string.print(ta),Ma&&(ta=ta.slice(0,-1)+", ...]"),Ma=ta):Ma=sd.string.print(ta);Ma=Ma.replace(/\n/g,"");500<Ma.length&&
(Ma=Ma.slice(0,20)+("...["+(Ma.length-20)+' CHARS]"'));return Ma}function yc(ta){return uc.Inspector.openInWindow({targetObject:ta})}function Rd(ta,Ma){return uc.Inspector.openInWindow({remoteTarget:{code:ta,evalEnvironment:Ma}})}function bd(ta,Ma){function ob(lc){var $b=lc.name,Yc=lc.ownerChain(),Sc=lc.owner,Uc=lc.world(),Xd;lc===Ya&&(Xd=[gb]);Uc===lc&&(Xd=["$world"]);if(!Xd&&$b&&Sc){Sc===Uc&&1===uc.arr.count(uc.arr.pluck(Uc.submorphs,"name"),$b)&&(Xd=['$world.get("'+$b+'")']);if(!Xd&&Sc!=Uc)for(Uc=
Yc.length-1;Uc--;)if(1===Yc[Uc].getAllNamed($b).length){Xd=[].concat($jscomp.arrayFromIterable(ob(Yc[Uc])),['get("'+$b+'")']);break}Xd||($b=[].concat($jscomp.arrayFromIterable(ob(Sc)),['get("'+$b+'")']),uc.syncEval($b.join("."),{context:Ya}).value===lc&&(Xd=$b))}Xd||(Xd=[gb+'.getMorphById("'+lc.id+'")']);return Xd}Ma=void 0===Ma?{}:Ma;var R=ta.world(),va=Ma;Ma=void 0===va.maxLength?10:va.maxLength;var Ya=void 0===va.fromMorph?R:va.fromMorph;if(Ya===ta)return"this";var gb=R===Ya?"$world":"this";if(!(R||
ta.name&&Ya.get(ta.name)===ta))return"morph";R=ob(ta);return R.length>Ma?'$world.getMorphWithId("'+ta.id+'")':R.join(".")}function Fb(ta,Ma,ob){var R=(Ma=void 0===Ma?"":Ma)&&De.arr.last(Ma.split(".")).toLowerCase(),va="",Ya=0,gb=Math.pow(2,19);if("string"===typeof ta){if(ta.length>gb)return null}else if(ta.document.stringSize>gb)return null;if("string"===typeof ta)va=ta.slice(0,1E3);else for(ta=$jscomp.makeIterator(ta.document.lines),gb=ta.next();!gb.done;gb=ta.next()){var lc=gb.value;gb=lc.stringSize;
lc=lc.text;var $b=!0;1E3<Ya+gb&&($b=!1,gb=1E3-Ya);va+=lc.slice(0,gb)+($b?"\n":"");Ya+=gb;if(1E3<=Ya)break}Ya=$jscomp.makeIterator(De.modeInfo);for(ta=Ya.next();!ta.done;ta=Ya.next()){$b=ta.value;gb=$b.contentTest;ta=$b.mode;lc=$b.ext;$b=$b.file;if("function"===typeof gb)try{if(gb(va))return ta}catch(Yc){}if($b&&$b instanceof RegExp&&$b.test(Ma))return ta;if(lc)for(gb=$jscomp.makeIterator(lc),lc=gb.next();!lc.done;lc=gb.next())if(lc.value===R)return ta}return ob}ra({a:fd,d:Db,r:Gc});var ea=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js");
ea.Color=kb;var la=function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/themes/default.js"),ob=Ma.hasOwnProperty("DefaultTheme")&&"function"===typeof Ma.DefaultTheme?Ma.DefaultTheme:Ma.DefaultTheme=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:"background",get:function(){return ea.Color.white}},{key:"default",get:function(){return{fontColor:"#333"}}},{key:"header",get:function(){return{fontSize:"110%",
fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},
{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:"#708"}}},{key:"atom",get:function(){return{fontColor:"#219"}}},{key:"number",get:function(){return{fontColor:"#174"}}},
{key:"def",get:function(){return{fontColor:"#22c"}}},{key:"variable",get:function(){return{fontColor:"#05a"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:"#222"}}},{key:"operator",get:function(){return{fontColor:"#05a"}}},{key:"variable-2",get:function(){return{fontColor:"#05a"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#666"}}},{key:"string",get:function(){return{fontColor:"#181"}}},
{key:"string-2",get:function(){return{fontColor:"#0B2"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#555"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#997"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#333"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},
{key:"diff-file-header",get:function(){return{fontColor:ea.Color.white,fontWeight:"bold",backgroundColor:ea.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:ea.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:ea.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DefaultTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ma,{pathInPackage:function(){return"themes/default.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:2867})}(void 0),tb=la=ea.DefaultTheme;ea.default=la;var H=lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js");
H.copyState=Da;H.startState=Kb;H.defineMode=Db;H.resolveMode=Fa;H.getMode=ac;H.innerMode=Gd;H.defineMIME=fd;H.registerHelper=Gc;H.indentLines=Ea;H.indentLine=function(ta,Ma,ob,R,va,Ya,gb){gb=Object.assign({indentWithTabs:!ta.useSoftTabs,indentUnit:ta.tabWidth,tabSize:4,ignoreFollowingText:!1},gb);null==va&&(va="add");"smart"==va&&(Ma.indent||(va="prev"));var lc=gb.tabSize,$b=ob.text,Yc=H.countColumn($b,null,lc);ob.modeState&&(ob.modeState=null);var Sc=$b.match(/^\s*/)[0];if(!Ya&&!/\S/.test($b)){var Uc=
0;va="not"}else if("smart"==va&&(Uc=Ma.indent(R,gb.ignoreFollowingText?"":$b.slice(Sc.length),$b),Uc==H.passIndent||150<Uc)){if(!Ya)return;va="prev"}"prev"==va?Uc=0<ob.row?H.countColumn(ob.prevLine().text,null,lc):0:"add"==va?Uc=Yc+gb.indentUnit:"subtract"==va?Uc=Yc-gb.indentUnit:"number"==typeof va&&(Uc=Yc+va);Uc=Math.max(0,Uc);Ma="";R=0;if(gb.indentWithTabs)for(gb=Math.floor(Uc/lc);gb;--gb)R+=lc,Ma+="\t";R<Uc&&(Ma+=" ".repeat(Uc-R));if(Ma!=Sc)return ta.replace({start:{row:ob.row,column:0},end:{row:ob.row,
column:Sc.length}},Ma),!0};H.tokenizeLines=function(ta,Ma,ob,R,va){if(Ma.length){ob=ob?H.copyState(ta,ob):H.startState(ta);for(var Ya=0;Ya<Ma.length;Ya++){var gb=Ma[Ya];R(gb);ob=H.tokenizeLine(ta,gb,ob,va)}}};H.tokenizeLine=function(ta,Ma,ob,R){var va=Ma.text;if(!va)return ob;var Ya=new H.StringStream(va,2);ob=Ma.modeState="function"===typeof ta.copyState?ta.copyState(ob):H.copyState(ta,ob);Ma.prevLine();for(ob._string=va;!Ya.eol();)va=ta.token(Ya,ob),R(va,ob,Ya.start,Ya.pos,Ya,Ma,ta),Ya.start=Ya.pos;
return ob};H.printTokens=function(ta){for(var Ma="",ob=0;ob<ta.length;ob+=5)Ma+=ta[ob+0]+" => "+ta[ob+1]+" "+ta[ob+2]+" "+ta[ob+3]+" "+ta[ob+4].name+"\n";return Ma};H.visitDocumentTokens=Oc;H.tokenizeDocument=Va;H.linesToTokenize=function(ta,Ma,ob,R){if(R&&R.row>=ob)return{lines:[],state:null};Ma=R?Math.max(0,R.row-1):Ma;var va=ta.getLine(Ma),Ya=va.text;ta=[va];R=null;for(var gb=0,lc;(lc=va.prevLine())&&50>gb++;){va=lc;if(va.modeState){R=va.modeState;break}ta.unshift(va)}if(!R){for(var $b=va,Yc=Infinity;(lc=
va.prevLine())&&100>gb++;){va=lc;if(va.modeState){R=va.modeState;break}ta.unshift(va);lc=Ya.match(/^\s*/)[0].length;if(0===lc)break;lc<Yc&&(Yc=lc,$b=va)}!R&&0<Yc&&(ta=ta.slice(ta.indexOf($b)))}if(ob>Ma)for(va=H.arr.last(ta);Ma<=ob;Ma++){va=va.nextLine();if(!va)break;ta.push(va)}return{lines:ta,state:R}};H.countColumn=kd;H.findModeByMIME=Ka;H.findModeByExtension=Wa;H.findModeByFileName=db;H.findModeByName=Zc;H.arr=Sb;la=H.modes||{};H.modes=la;H.modes=la;H.modes=la;la=ra("p",{});H.passIndent=la;H.passIndent=
la;H.passIndent=la;H.copyState=Da;H.copyState=Da;H.startState=Kb;H.startState=Kb;H.defineMode=Db;H.defineMode=Db;H.resolveMode=Fa;H.resolveMode=Fa;H.getMode=ac;H.getMode=ac;H.innerMode=Gd;H.innerMode=Gd;la={};H.mimeModes=la;H.mimeModes=la;H.mimeModes=la;H.defineMIME=fd;H.defineMIME=fd;H.registerHelper=Gc;H.registerHelper=Gc;H.indentLines=Ea;H.indentLines=Ea;H.visitDocumentTokens=Oc;H.visitDocumentTokens=Oc;H.tokenizeDocument=Va;H.tokenizeDocument=Va;H.countColumn=kd;H.countColumn=kd;(function(ta){var Ma=
lively.FreezerRuntime.recorderFor("lively.ide/editor-modes.js"),ob=Ma.hasOwnProperty("StringStream")&&"function"===typeof Ma.StringStream?Ma.StringStream:Ma.StringStream=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:Symbol.for("lively-instance-initialize"),value:function(R,va){this.reset(R,va)}},{key:"reset",value:function(R,va){this.pos=this.start=0;this.string=void 0===R?"":R;this.tabSize=void 0===
va?2:va;this.lineStart=this.lastColumnPos=this.lastColumnValue=0}},{key:"eol",value:function(){return this.pos>=this.string.length}},{key:"sol",value:function(){return this.pos==this.lineStart}},{key:"peek",value:function(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function(R){var va=this.string.charAt(this.pos);if("string"==typeof R?va==R:va&&(R.test?R.test(va):R(va)))return++this.pos,
va}},{key:"eatWhile",value:function(R){for(var va=this.pos;this.eat(R););return this.pos>va}},{key:"eatSpace",value:function(){for(var R=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>R}},{key:"skipToEnd",value:function(){this.pos=this.string.length}},{key:"skipTo",value:function(R){R=this.string.indexOf(R,this.pos);if(-1<R)return this.pos=R,!0}},{key:"backUp",value:function(R){this.pos-=R}},{key:"column",value:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=
H.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?H.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"indentation",value:function(){return H.countColumn(this.string,null,this.tabSize)-(this.lineStart?H.countColumn(this.string,this.lineStart,this.tabSize):0)}},{key:"match",value:function(R,va,Ya){if("string"==typeof R){var gb=function($b){return Ya?$b.toLowerCase():$b},
lc=this.string.substr(this.pos,R.length);if(gb(lc)==gb(R))return!1!==va&&(this.pos+=R.length),!0}else{if((R=this.string.slice(this.pos).match(R))&&0<R.index)return null;R&&!1!==va&&(this.pos+=R[0].length);return R}}},{key:"current",value:function(){return this.string.slice(this.start,this.pos)}},{key:"hideFirstChars",value:function(R,va){this.lineStart+=R;try{return va()}finally{this.lineStart-=R}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"StringStream"}}],Ma,{pathInPackage:function(){return"editor-modes.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10431,end:12920})})(void 0);la=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",
mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj",
"cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",
mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff",
"patch"],contentTest:function(ta){return ta.match(/^diff --.* a\//m)}},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},
{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth",
"fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy",
"gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",
ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],
mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"json",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",
mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",
mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective C",mime:"text/x-objectivec",
mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:"php php3 php4 php5 php7 phtml".split(" ")},
{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",
mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",
mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash",
"sh","zsh"],file:/^PKGBUILD|\.bash(rc|_profile)|\.profile$/,contentTest:function(ta){return ta.match(/#!\//m)}},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},
{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",
mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",
mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",
mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml",
"text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",
mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];H.modeInfo=la;H.modeInfo=la;H.modeInfo=la;for(var ja=0;ja<H.modeInfo.length;ja++)H.info=H.modeInfo[ja],H.info.mimes&&(H.info.mime=H.info.mimes[0]);H.defineMode("null",function(){return{token:function(ta){return ta.skipToEnd()}}});H.defineMIME("text/plain","null");H.findModeByMIME=Ka;H.findModeByMIME=Ka;H.findModeByExtension=Wa;H.findModeByExtension=Wa;H.findModeByFileName=db;H.findModeByFileName=db;H.findModeByName=Zc;H.findModeByName=Zc;var Ba=
lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js");Ba.Color=kb;Ba.Rectangle=Mb;Ba.pt=Fd;Ba.morph=Jc;Ba.ShadowObject=wd;Ba.StyleSheet=Kc;Ba.connect=Fc;Ba.arr=Sb;Ba.string=Wc;Ba.FilterableList=hd;Ba.Range=Id;ja=function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ob=Ma.hasOwnProperty("Completer")&&"function"===typeof Ma.Completer?Ma.Completer:Ma.Completer=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return zb(ob,ta,[{key:"compute",value:function(){return[]}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Completer"}}],Ma,{pathInPackage:function(){return"text/completion.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:345,end:391})}(void 0);Ba.Completer=ja;Ba.Completer=ja;Ba.Completer=ja;ja=function(ta){var Ma=
lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ob=Ma.hasOwnProperty("WordCompleter")&&"function"===typeof Ma.WordCompleter?Ma.WordCompleter:Ma.WordCompleter=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:"compute",value:function(R,va){var Ya=[],gb=[],lc=R.document.lineStrings;R=R.cursorPosition.row;for(var $b=R-1;0<=$b;$b--)for(var Yc=$jscomp.makeIterator(lc[$b].split(/[^0-9a-z@_]+/i)),
Sc=Yc.next();!Sc.done;Sc=Yc.next())(Sc=Sc.value)&&!Ya.includes(Sc)&&Sc!==va&&(Ya.push(Sc),gb.push({priority:1E3-(R-$b),completion:Sc}));for($b=R+1;$b<lc.length;$b++)for(Yc=$jscomp.makeIterator(lc[$b].split(/[^0-9a-z_@]+/i)),Sc=Yc.next();!Sc.done;Sc=Yc.next())(Sc=Sc.value)&&!Ya.includes(Sc)&&Sc!==va&&(Ya.push(Sc),gb.push({priority:1E3-($b-R),completion:Sc}));return gb}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WordCompleter"}}],Ma,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:400,end:1228})}(void 0);Ba.WordCompleter=ja;Ba.WordCompleter=ja;Ba.WordCompleter=ja;ja=[new Ba.WordCompleter];Ba.defaultCompleters=ja;Ba.defaultCompleters=ja;Ba.defaultCompleters=ja;ja=function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/text/completion.js"),ob=Ma.hasOwnProperty("CompletionController")&&
"function"===typeof Ma.CompletionController?Ma.CompletionController:Ma.CompletionController=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:Symbol.for("lively-instance-initialize"),value:function(R,va){va=void 0===va?[]:va;this.textMorph=R;this.completers=va=R.pluginCollect("getCompleters",va)}},{key:"computeCompletions",value:function(R){var va=this,Ya,gb,lc,$b,Yc,Sc,Uc,Xd,qe,tf,Ag,yh,Lg,pi,Bg,Dj;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ve){switch(Ve.nextAddress){case 1:Ya=[],gb=$jscomp.makeIterator(va.completers),lc=gb.next();case 2:if(lc.done){Ve.jumpTo(4);break}$b=lc.value;Ve.setCatchFinallyBlocks(5);Yc=Ya;Sc=Yc.concat;return Ve.yield($b.compute(va.textMorph,R),7);case 7:Ya=Sc.call(Yc,Ve.yieldResult);Ve.leaveTryBlock(3);break;case 5:Uc=Ve.enterCatchBlock(),console.warn("Error in completer "+$b+": "+(Uc.stack||Uc));case 3:lc=gb.next();Ve.jumpTo(2);break;case 4:Xd=new Map;
Ya.forEach(function(yi){var ch=Xd.get(yi.completion);ch||(ch=[],Xd.set(yi.completion,ch));ch.push(yi)});qe=[];tf=$jscomp.makeIterator(Xd.values());for(Ag=tf.next();!Ag.done;Ag=tf.next())yh=Ag.value,qe.push(Ba.arr.last(Ba.arr.sortByKey(yh,"priority")));Lg=0;pi=Ba.arr.sortByKey(qe,"priority").reverse();Bg=pi.length&&pi[0].priority||0;Dj=pi.map(function(yi){yi.highestPriority=Bg;var ch=yi.completion.replace(/\n/g,""),Yd=String((yi.info||"").replace(/\n/g,""));Lg=Math.max(Lg,ch.length+Yd.length);return{isListItem:!0,
string:ch,annotation:Yd,value:yi}});return Ve.return({items:Dj,maxCol:Lg})}})}},{key:"computeSortedCompletions",value:function(R,va){va=void 0===va?!1:va;var Ya=this,gb,lc,$b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yc){if(1==Yc.nextAddress)return gb={tokens:[R],lowercasedTokens:[R],input:R},Yc.yield(Ya.computeCompletions(R),2);lc=Yc.yieldResult;$b=Ba.arr.sortBy(lc.items.filter(function(Sc){return Ya.filterFunction(gb,Sc,va)}),function(Sc){return Ya.sortFunction(gb,Sc)});return Yc.return($b)})}},
{key:"_printCompletions",value:function(R){var va=this,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return gb.yield(va.computeSortedCompletions(R),2);Ya=gb.yieldResult.map(function(lc){return{completion:lc.value.completion,priority:lc.value.priority,maxP:lc.value.highestPriority,sortVal:lc._cache[R].sortVal,lev:JSON.stringify(lc._cache[R].levenshtein)}});return gb.return(Ba.string.printTable(lively.lang.grid.tableFromObjects(Ya)))})}},{key:"prefix",value:function(){var R=
this.textMorph,va=R.selection;return(va.isEmpty()?R.getLine(va.lead.row).slice(0,va.lead.column):va.text).match(/[a-z0-9@_]*$/i)[0]}},{key:"filterFunction",value:function(R,va,Ya){Ya=void 0===Ya?!1:Ya;va._cache||(va._cache={});var gb=R.tokens,lc=R.lowercasedTokens,$b=R.input;$b=va._cache[$b]||(va._cache[$b]={});if($b.hasOwnProperty("filtered"))return $b.filtered;va=va.value.completion.replace(/\([^\)]*\)$/,"");var Yc=va.toLowerCase();if(Ya&&gb[0]&&!va.startsWith(gb[0]))return $b.filtered=!1;if(lc.every(function(Uc){return Yc.includes(Uc)}))return!0;
var Sc=$b.levenshtein||($b.levenshtein={});R=Ya||3>=Ba.arr.sum(R.lowercasedTokens.map(function(Uc){return Sc[Uc]||(Sc[Uc]=Ba.string.levenshtein(Yc,Uc))}));return $b.filtered=R}},{key:"sortFunction",value:function(R,va){va._cache||(va._cache={});var Ya=va._cache[R.input]||(va._cache[R.input]={});if(Ya.hasOwnProperty("sortVal"))return Ya.sortVal;Ya=va._cache[R.input]={};var gb=va.value;va=gb.highestPriority;var lc=gb.completion;gb=gb.priority;lc=lc.replace(/\([^\)]*\)$/,"").toLowerCase();var $b=0;R.lowercasedTokens.forEach(function(Sc){lc.startsWith(Sc)?
$b+=12:3<=Sc.length&&lc.includes(Sc)&&($b+=5)});va=-((gb||($b?va:0))/Math.pow(10,String(va).length-2))-$b;var Yc=Ya.levenshtein||(Ya.levenshtein={});R=Ba.arr.sum(R.lowercasedTokens.map(function(Sc){return Yc[Sc]||(Yc[Sc]=Ba.string.levenshtein(lc,Sc))}));$b&&(R/=2);return Ya.sortVal=R+va}},{key:"positionForMenu",value:function(){var R=this.textMorph,va=R.charBoundsFromTextPosition(R.cursorPosition);return R.getGlobalTransform().transformRectToRect(va).topLeft().addXY(-R.scroll.x,-R.scroll.y).addPt(Ba.pt(R.borderWidth+
3,R.borderWidth+3))}},{key:"completionListSpec",value:function(){var R=this,va,Ya,gb,lc,$b,Yc,Sc,Uc,Xd,qe,tf,Ag,yh,Lg,pi,Bg,Dj,Ve,yi,ch;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yd){if(1==Yd.nextAddress)return Ya=va=R.textMorph,gb=Ya.fontSize,lc=Ya.fontFamily,$b=R.positionForMenu(),Yc=R.prefix(),Yd.yield(R.computeCompletions(Yc),2);Sc=Yd.yieldResult;Uc=Sc.items;Xd=Sc.maxCol;qe=va.env.fontMetric.sizeFor(lc,gb,"M");tf=qe.width*Xd;Ag=va.document.getLine(0).height;yh=Math.max(120,tf<
va.width?tf:va.width);Lg=Ag*Uc.length+Ag+10;pi=Math.max(70,Math.min(700,Lg));Bg=$b.extent(Ba.pt(yh,pi));if(Dj=va.world())Ve=Dj.visibleBounds().insetBy(5),Bg.bottom()>Ve.bottom()&&(yi=Bg.bottom()-Ve.bottom(),yi>Bg.height-50&&(yi=Bg.height-50),Bg.height-=yi),Bg.right()>Ve.right()&&(ch=Bg.right()-Ve.right(),Bg.width=120>Bg.width-ch?120:Bg.width-ch),Ve.containsRect(Bg)||(Bg=Bg.withTopLeft(Ve.translateForInclusion(Bg).topLeft())),Bg=Bg.translatedBy(Ve.insetBy(0).topLeft().negated());return Yd.return({master:{auto:"styleguide://SystemWidgets/autocomplete list"},
hasFixedPosition:!0,epiMorph:!0,fontSize:gb,position:Bg.topLeft(),extent:Bg.extent(),items:Uc,input:Yc,name:"text completion menu",historyId:"lively.morphic-text completion",filterFunction:R.filterFunction,sortFunction:R.sortFunction})})}},{key:"removeMenuOnBlur",value:function(R){var va=R.menu;setTimeout(function(){va.withAllSubmorphsDetect(function(Ya){return Ya.isFocused()})?va.inputMorph.focus():va.remove()})}},{key:"openCompletionList",value:function(){var R=this,va,Ya,gb,lc,$b,Yc,Sc,Uc,Xd,qe;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(tf){if(1==tf.nextAddress)return va=R.textMorph.selection.start,tf.yield(R.completionListSpec(),2);Ya=tf.yieldResult;R.textMorph.pluginFind(function(Ag){return Ag.theme});gb=new Ba.FilterableList(Ya);lc=new Ba.Range({start:va,end:R.textMorph.selection.start});$b=R.textMorph.textInRange(lc);Yc=gb.inputMorph;Sc=gb.listMorph;Uc=Ya.input;Xd=gb.addMorph({name:"prefix mask",fill:Ba.Color.transparent,bounds:Yc.textBounds()},Yc);Sc.master=null;lc.isEmpty()||
(R.textMorph.deleteText(lc),Yc.input=$b,Yc.gotoDocumentEnd());Yc.fontColor=R.textMorph.fontColor;Ba.connect(Yc,"textString",Xd,"setBounds",{converter:"() => input.textBounds()",varMapping:{input:Yc}});Ba.connect(gb,"accepted",R,"insertCompletion",{updater:"function($upd) {\n        let textToInsert, customInsertionFn = null, completion = this.sourceObj.selection;\n        if (completion) {\n          if (completion.prefix) prefix = completion.prefix;\n          textToInsert = completion.completion;\n          customInsertionFn = completion.customInsertionFn;\n        } else {\n          textToInsert = this.sourceObj.inputMorph.textString;\n        }\n        $upd(textToInsert, prefix, customInsertionFn);\n      }",
varMapping:{prefix:Uc}});Ba.connect(gb,"accepted",gb,"remove");Ba.connect(gb,"canceled",gb,"remove");Ba.connect(gb,"remove",R.textMorph,"focus");Ba.connect(gb.inputMorph,"onBlur",R,"removeMenuOnBlur",{converter:"evt => ({menu, evt})",varMapping:{menu:gb}});qe=R.textMorph.world();qe.addMorph(gb);Sc.addStyleClass("hiddenScrollbar");Yc.height=Sc.itemHeight;Yc.fixedHeight=!0;Yc.fontSize=Sc.fontSize;Yc.focus();gb.get("padding").height=0;gb.relayout();gb.selectedIndex=0;Uc.length?(Yc.gotoDocumentEnd(),
gb.moveBy(Ba.pt(-Yc.textBounds().width+2,0))):gb.moveBy(Ba.pt(2,0));return tf.return(gb)})}},{key:"autoInsertBestMatchingCompletion",value:function(R,va,Ya){va=void 0===va?!0:va;var gb=this,lc,$b,Yc,Sc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==Uc.nextAddress)return lc=$jscomp,$b=lc.makeIterator,Uc.yield(gb.computeSortedCompletions(R,va),2);Yc=$b.call(lc,Uc.yieldResult);(Sc=Yc.next().value)&&gb.insertCompletion(Sc.value.completion,R,Ya);Uc.jumpToEnd()})}},{key:"insertCompletion",
value:function(R,va,Ya){var gb=this.textMorph,lc=gb.document,$b=gb.selection.isMultiSelection?gb.selection.selections:[gb.selection];gb.undoManager.group();$b.forEach(function(Yc){Yc.collapseToEnd();var Sc=Yc.lead,Uc=va?lc.indexToPosition(lc.positionToIndex(Sc)-va.length):Sc;"function"===typeof Ya?Ya(R,va,gb,{start:Uc,end:Sc},Yc):gb.replace({start:Uc,end:Sc},R)});gb.undoManager.group()}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CompletionController"}}],Ma,{pathInPackage:function(){return"text/completion.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1355,end:12497})}(void 0);Ba.CompletionController=ja;Ba.CompletionController=ja;Ba.CompletionController=ja;ja=[{name:"text completion",handlesCount:!0,multiSelectAction:"single",exec:function(ta,Ma,ob){var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(va){return 1==va.nextAddress?
(R=new Ba.CompletionController(ta,Ba.defaultCompleters),va.yield(R.openCompletionList(),2)):va.return(!0)})}},{name:"text completion first match",handlesCount:!0,multiSelectAction:"single",exec:function(ta,Ma,ob){var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(va){return 1==va.nextAddress?(R=new Ba.CompletionController(ta,Ba.defaultCompleters),va.yield(R.autoInsertBestMatchingCompletion(R.prefix()),2)):va.return(!0)})}}];Ba.completionCommands=ja;Ba.completionCommands=ja;Ba.completionCommands=
ja;var ub=lively.FreezerRuntime.recorderFor("lively.ide/text/multi-select-commands.js");ub.chain=nd;ub.arr=Sb;ub.obj=Xc;ub.string=Wc;var jc=[{name:"[multi select] add cursor above",multiSelectAction:"single",exec:function(ta){var Ma=ta.selection.start;0<Ma.row&&(Ma=ta.getPositionAboveOrBelow(1,Ma,!0,0,ta.charBoundsFromTextPosition(Ma).x),ta.selection.addRange({start:Ma,end:Ma}));return!0}},{name:"[multi select] add cursor below",multiSelectAction:"single",exec:function(ta){var Ma=ta.selection.start;
Ma.row<ta.documentEndPosition.row&&(Ma=ta.getPositionAboveOrBelow(-1,Ma,!0,0,ta.charBoundsFromTextPosition(Ma).x),ta.selection.addRange({start:Ma,end:Ma}));return!0}},{name:"[multi select] all like this",multiSelectAction:"single",exec:function(ta){var Ma=ta.selection.selections[ta.selection.selections.length-1];if(Ma.isEmpty())return!0;ta.searchForAll(Ma.text,{start:{column:0,row:0}}).forEach(function(ob){return ta.selection.addRange(ob.range,!1)});ta.selection.mergeSelections();ub.arr.remove(ta.selection.selections,
Ma);ta.selection.selections.push(Ma);return!0}},{name:"[multi select] more like this forward",multiSelectAction:"single",exec:function(ta){var Ma=ta.selection.selections.length-1,ob=ta.selection.selections[Ma];if(ob.isEmpty())return!0;var R=ta.search(ob.text,{start:ob.end,backwards:!1});R&&(ob=ta.selection.selections.findIndex(function(va){return va.range.equals(R.range)}),-1<ob?ub.arr.swap(ta.selection.selections,ob,Ma):ta.selection.addRange(R.range));return!0}},{name:"[multi select] more like this backward",
multiSelectAction:"single",exec:function(ta){var Ma=ta.selection.selections.length-1,ob=ta.selection.selections[Ma];if(ob.isEmpty())return!0;var R=ob.start,va=ta.search(ob.text,{start:{row:R.row,column:R.column-(ob.text.length-1)},backwards:!0});va&&(ob=ta.selection.selections.findIndex(function(Ya){return Ya.range.equals(va.range)}),-1<ob?ub.arr.swap(ta.selection.selections,ob,Ma):ta.selection.addRange(va.range));return!0}},{name:"[multi select] remove focused cursor",multiSelectAction:"single",
exec:function(ta){var Ma=ta.selection.selections.length;1<Ma&&ta.selection.removeSelections(Ma-1);return!0}},{name:"[multi select] goto previous focused cursor",multiSelectAction:"single",exec:function(ta){ta.selection.selections=lively.lang.arr.rotate(ta.selection.selections,-1);return!0}},{name:"[multi select] goto next focused cursor",multiSelectAction:"single",exec:function(ta){ta.selection.selections=lively.lang.arr.rotate(ta.selection.selections,1);return!0}},{name:"[multi select] align cursors",
multiSelectAction:"single",exec:function(ta){var Ma=ta.selection.selections;if(1>=Ma.length)return!0;var ob=ub.arr.groupBy(Ma,function(va){return va.range.start.row});Ma=ob.keys().map(function(va){va=ob[va];var Ya=ub.arr.max(va,function(gb){return gb.range.start.column});ub.arr.without(va,Ya).forEach(function(gb){return gb.range=Ya.range});return Ya});var R=ub.arr.max(Ma,function(va){return va.range.start.column}).range.start.column;Ma.forEach(function(va){var Ya=va.range.start;va=Ya.row;Ya=Ya.column;
ta.insertText(" ".repeat(R-Ya),{row:va,column:Ya})});return!0}},{name:"[multi select] create rectangular selection",multiSelectAction:"single",exec:function(ta){ta.selection.disableMultiSelect();if(ta.selection.isEmpty())var Ma=ta.lastSavedMark&&ta.lastSavedMark.position||(void 0).lineRange().start,ob=ta.cursorPosition;else Ma=ta.selection,ob=Ma.lead,Ma=Ma.anchor;ta.selection.collapse();var R=Ma.column,va=ob.column;ub.arr.range(Ma.row,ob.row).forEach(function(Ya){return ta.getLine(Ya).length>Math.min(va,
R)&&ta.selection.addRange({end:{row:Ya,column:va},start:{row:Ya,column:R}},!1)});ta.selection.mergeSelections();return!0}},{name:"[multi select] count",multiSelectAction:"single",handlesCount:!0,exec:function(ta,Ma,ob){ob=void 0===ob?1:ob;ta.undoManager.group();ta.selection.selections.forEach(function(R,va){return R.text=String(va+ob)});ta.undoManager.group();return!0}}];ub.multiSelectCommands=jc;ub.multiSelectCommands=jc;ub.multiSelectCommands=jc;var vc=lively.FreezerRuntime.recorderFor("lively.ide/text/code-navigation-commands.js");
vc.pToI=function(ta,Ma){return ta.positionToIndex(Ma)};vc.iToP=function(ta,Ma){return ta.indexToPosition(Ma)};vc.execCodeNavigator=function(ta){return function(Ma,ob,R){var va=Ma.pluginInvokeFirst("getNavigator");if(!va)return!0;Ma.saveMark();R=R||1;for(var Ya=0;Ya<R;Ya++)va[ta](Ma,ob);return!0}};vc.once=Na;var Cd=[{name:"forwardSexp",bindKey:"Ctrl-Alt-f|Ctrl-Alt-Right",exec:vc.execCodeNavigator("forwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardSexp",bindKey:"Ctrl-Alt-b|Ctrl-Alt-Left",
exec:vc.execCodeNavigator("backwardSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"backwardUpSexp",bindKey:"Ctrl-Alt-u|Ctrl-Alt-Up",exec:vc.execCodeNavigator("backwardUpSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"forwardDownSexp",bindKey:"Ctrl-Alt-d|Ctrl-Alt-Down",exec:vc.execCodeNavigator("forwardDownSexp"),multiSelectAction:"forEach",readOnly:!0},{name:"markDefun",bindKey:"Ctrl-Alt-h",exec:vc.execCodeNavigator("markDefun"),multiSelectAction:"forEach",readOnly:!0},{name:"expandRegion",
bindKey:{win:"Shift-Ctrl-E|Ctrl-Shift-Space",mac:"Shift-Command-Space|Ctrl-Shift-Space"},exec:function(ta,Ma){function ob(){var Ya=ta.$expandRegionState,gb=vc.pToI(ta,ta.cursorPosition);if(Ya&&(Ya.range[0]===gb||Ya.range[1]===gb))return Ya;Ya=ta.selection.range;return ta.$expandRegionState={range:[vc.pToI(ta,Ya.start),vc.pToI(ta,Ya.end)]}}Ma=Ma||{};var R=ta.pluginInvokeFirst("getNavigator");if(!R)return!0;var va=Ma.start;Ma=Ma.end;if("number"===typeof va&&"number"===typeof Ma)ob(),R={range:[va,Ma],
prev:ob()};else{va=R.ensureAST(ta);if(!va)return;R=R.expandRegion(ta,ta.textString,va,ob())}R&&R.range&&(ta.selection={start:vc.iToP(ta,R.range[0]),end:vc.iToP(ta,R.range[1])},ta.$expandRegionState=R);vc.once(ta,"selectionChange",function(){return ta.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0},{name:"contractRegion",bindKey:{win:"Shift-Ctrl-S|Ctrl-Alt-Space",mac:"Ctrl-Command-space|Ctrl-Alt-Space"},exec:function(ta){if(ta.selection.isEmpty())return!0;var Ma=
ta.pluginInvokeFirst("getNavigator");if(!Ma)return!0;var ob=Ma.ensureAST(ta);if(!ob)return!0;var R=ta.$expandRegionState;if(!R)return!0;(Ma=Ma.contractRegion(ta,ta.textString,ob,R))&&Ma.range&&(ta.selection={start:vc.iToP(ta,Ma.range[0]),end:vc.iToP(ta,Ma.range[1])},ta.$expandRegionState=Ma);vc.once(ta,"selectionChange",function(){return ta.$expandRegionState=null},"call");return!0},multiSelectAction:"forEach",readOnly:!0}];vc.commands=Cd;vc.commands=Cd;vc.commands=Cd;var id=lively.FreezerRuntime.recorderFor("lively.ide/text/generic-code-commands.js");
id.arr=Sb;id.chain=nd;id.string=Wc;var we=[{name:"toggle comment",exec:function(ta){var Ma=ta.pluginInvokeFirst("getComment");if(!Ma)return!0;if(!Ma.lineCommentStart)return Ma.blockCommentStart?ta.execCommand("toggle block comment"):!0;var ob=Ma.lineCommentStart,R=new RegExp("^(\\s*)("+ob+"\\s?)(.*)");Ma=ta.document;var va=ta.selection;va.isEmpty()||0!==va.end.column||va.growRight(-1);var Ya=va.start.row;Ma=Ma.lineStrings.slice(va.start.row,va.end.row+1);Ma=Ma.some(function($b){return!!$b.trim()})?
id.arr.dropWhile(Ma,function($b){return $b.trim()?!1:++Ya&&!0}):Ma;var gb=Ma.every(function($b){return $b.trim()&&$b.match(R)});ta.undoManager.group();if(gb)Ma.forEach(function($b,Yc){if($b=$b.match(R)){$b=$jscomp.makeIterator($b);$b.next();var Sc=$b.next().value,Uc=$b.next().value;$b.next();ta.deleteText({start:{row:Ya+Yc,column:Sc.length},end:{row:Ya+Yc,column:Sc.length+Uc.length}})}});else{var lc=Ma.reduce(function($b,Yc,Sc){return Yc.trim()||va.isEmpty()&&va.start.row===va.end.row?Math.min($b,
Yc.match(/^\s*/)[0].length):$b},Infinity);lc=Infinity===lc?0:lc;Ma.forEach(function($b,Yc){$b=$jscomp.makeIterator($b.match(/^(\s*)(.*)/));$b.next();$b.next();$b.next();ta.insertText(ob+" ",{row:Ya+Yc,column:lc})})}ta.undoManager.group();return!0}},{name:"toggle block comment",exec:function(ta){var Ma=ta.pluginInvokeFirst("getComment");if(!Ma)return!0;if(!Ma.blockCommentStart)return Ma.lineCommentStart?ta.execCommand("toggle comment"):!0;if(!Ma||!Ma.blockCommentStart)return!0;var ob=Ma.blockCommentStart;
Ma=Ma.blockCommentEnd;var R=new RegExp("^"+ob.replace(/\*/g,"\\*")),va=new RegExp(Ma.replace(/\*/g,"\\*")+"$"),Ya=ta.tokenAt(ta.cursorPosition);if(Ya&&"comment"===Ya.token){var gb=ta.textInRange(Ya);if(gb.match(R)&&gb.match(va))return ta.undoManager.group(),ta.replace(Ya,gb.slice(ob.length,-Ma.length)),ta.undoManager.group(),!0}ta.undoManager.group();ta.insertText(ob,ta.selection.start);ta.insertText(Ma,ta.selection.end);ta.undoManager.group();ob=!ta.selection.isEmpty();ta.selection.growLeft(Ma.length);
ob||ta.selection.collapse();return!0}},{name:"comment box",exec:function(ta,Ma,ob){Ma=ta.undoManager.ensureNewGroup(ta,"comment box");if(ta.selection.isEmpty())return ta.insertText("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-"),ta.execCommand("toggle comment"),ta.undoManager.group(Ma),!0;var R=ta.selection.range,va=ta.withSelectedLinesDo(function(gb){return gb}),Ya=id.arr.min([R.start.column].concat(id.chain(va).map(function(gb){return gb.match(/^\s*/)}).flatten().compact().pluck("length").value()));
va=id.arr.max(va.map(function(gb){return gb.length}))-Ya;va=Array(Math.ceil(va/2)+1).join("-=")+"-";ta.execCommand("toggle comment");ta.collapseSelection();ta.cursorPosition={row:R.start.row,column:0};ob?ta.insertText(id.string.indent("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n"," ",Ya)):ta.insertText(id.string.indent(va+"\n"," ",Ya));ta.selection.goUp();ta.execCommand("toggle comment");ta.cursorPosition={row:R.end.row+2,column:0};ta.insertText(id.string.indent(va+"\n"," ",Ya));ta.selection.goUp();
ta.execCommand("toggle comment");ta.selection.range={start:{row:R.start.row,column:0},end:ta.cursorPosition};ta.undoManager.group(Ma);return!0},multiSelectAction:"forEach",handlesCount:!0}];id.commands=we;id.commands=we;id.commands=we;var sd=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js");sd.printSymbol=function(ta){if(Symbol.keyFor(ta))return'Symbol.for("'+Symbol.keyFor(ta)+'")';if(sd.knownSymbols.get(ta))return sd.knownSymbols.get(ta);String(ta).match(sd.symMatcher);return String(ta)};
sd.defaultSort=function(ta,Ma){if(ta.hasOwnProperty("priority")||Ma.hasOwnProperty("priority")){var ob=ta.priority||0,R=Ma.priority||0;if(ob<R)return-1;if(ob>R)return 1}ta=(ta.keyString||ta.key).toLowerCase();Ma=(Ma.keyString||Ma.key).toLowerCase();return ta<Ma?-1:ta===Ma?0:1};sd.safeToString=xd;sd.propertyNamesOf=function(ta,Ma){if(!ta)return[];if(Array.isArray(ta)){var ob=Ma?Ma.offset:0;return sd.arr.range(ob,ob+(Ma?Ma.partitionSize:ta.length-1))}return sd.arr.sortBy(Object.keys(ta),function(R){return R.toLowerCase()})};
sd.isMultiValue=Wd;sd.printValue=le;sd.partitionedChildren=function(ta,Ma){var ob=void 0===Ma?{}:Ma;Ma=void 0===ob.originalValue?ta:ob.originalValue;var R=void 0===ob.offset?0:ob.offset;ob=void 0===ob.partitionSize?ta.length||Object.values(ta).length:ob.partitionSize;if(sd.obj.isArray(ta)){ta=sd.num.roundTo(Math.max(sd.MIN_PARTITION_SIZE,ob/50),.1);ob/=ta;for(var va=[],Ya=0;Ya<ob;Ya++){var gb="["+(R+Ya*ta)+"-"+(R+(Ya+1)*ta)+"]";va.push({partition:{originalValue:Ma,offset:R+Ya*ta,partitionSize:ta},
value:[],key:gb,keyString:gb,valueString:"...",isCollapsed:!0})}return va}ta=sd.num.roundTo(Math.max(sd.MIN_PARTITION_SIZE,ob/50),.1);ob/=ta;va=[];Ya=sd.obj.keys(Ma).sort();for(gb=0;gb<ob;gb++){var lc=R+gb*ta,$b=R+(gb+1)*ta,Yc=sd.obj.select(Ma,Ya.slice(lc,$b));lc="["+Ya[lc].slice(0,4)+"-"+(Ya[$b]||sd.arr.last(Ya)).slice(0,4)+"]";va.push({partition:{originalValue:Yc,offset:R+gb*ta,partitionSize:ta},value:[],key:lc,keyString:lc,valueString:"...",isCollapsed:!0})}return va};sd.propertiesOf=function(ta){var Ma=
ta.partition?ta.target:ta.value;if(!Ma)return[];var ob={_rev:!0},R=[],va="function"===typeof Ma.livelyCustomInspect?Ma.livelyCustomInspect():{},Ya=Object.assign({},sd.defaultPropertyOptions,{},va);if(va.properties){va=$jscomp.makeIterator(va.properties);for(var gb=va.next();!gb.done;gb=va.next()){var lc=gb.value;gb=lc.key;var $b=lc.hidden,Yc=lc.priority,Sc=lc.keyString,Uc=lc.value;lc=lc.valueString;ob[gb]=!0;$b||R.push(ta.getSubNode({priority:Yc,key:gb,keyString:Sc||sd.safeToString(gb),value:Uc,valueString:lc,
isCollapsed:!0}))}}if(Ya.includeDefault){va=sd.propertyNamesOf(Ma,ta.partition);if(va.length>sd.MAX_NODE_THRESHOLD)for(ob=$jscomp.makeIterator(sd.partitionedChildren(Ma,ta.partition)),va=ob.next();!va.done;va=ob.next())R.push(ta.getSubNode(va.value));else for($b=$jscomp.makeIterator(va),va=$b.next();!va.done;va=$b.next())Yc=va.value,Yc in ob||(va=Ma[Yc],gb=sd.printValue(va),va={keyString:Yc,key:Yc,value:va,valueString:gb,isCollapsed:!0},R.push(ta.getSubNode(va)));if(Ya.includeSymbols)for(ob=$jscomp.makeIterator(Object.getOwnPropertySymbols(Ma)),
va=ob.next();!va.done;va=ob.next())$b=va.value,Yc=sd.safeToString($b),va=Ma[$b],gb=sd.printValue(va),va={key:$b,keyString:Yc,value:va,valueString:gb,isCollapsed:!0},R.push(ta.getSubNode(va))}Ya.sort&&(R=Ya.sortFunction(Ma,R));return R};sd.obj=Xc;sd.num=nb;sd.arr=Sb;sd.string=Wc;sd.connect=Fc;sd.signal=Pb;sd.TreeData=Wb;sd.newUUID=Pc;sd.localInterface=ua;sd.MAX_NODE_THRESHOLD=1E3;sd.MIN_PARTITION_SIZE=250;sd.defaultPropertyOptions={includeDefault:!0,includeSymbols:!0,sort:!0,sortFunction:function(ta,
Ma){return Array.isArray(ta)?Ma:Ma.sort(sd.defaultSort)}};sd.symMatcher=/^Symbol\((.*)\)$/;sd.knownSymbols=function(){return Object.getOwnPropertyNames(Symbol).filter(function(ta){return"symbol"===typeof Symbol[ta]}).reduce(function(ta,Ma){return ta.set(Symbol[Ma],"Symbol."+Ma)},new Map)}();sd.isMultiValue=Wd;sd.isMultiValue=Wd;sd.printValue=le;sd.printValue=le;var Zd=function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ob=Ma.hasOwnProperty("InspectionTree")&&
"function"===typeof Ma.InspectionTree?Ma.InspectionTree:Ma.InspectionTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:Symbol.for("lively-instance-initialize"),value:function(R){zb._get(Object.getPrototypeOf(ob.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);this.inspector=R.inspector;this.root.isInspectionNode||(this.root=sd.InspectionNode.for(this.root,this))}},{key:"__only_serialize__",
get:function(){return["root"]}},{key:"asListWithIndexAndDepth",value:function(R){R=void 0===R?!0:R;return zb._get(Object.getPrototypeOf(ob.prototype),"asListWithIndexAndDepth",this).call(this,function(va){va=va.node;return R?va.visible:!0})}},{key:"getContextFor",value:function(R){return R==this.root?this.root.value.inspectee:R.value}},{key:"dispose",value:function(){}},{key:"filter",value:function(R){var va=void 0===R.maxDepth?1:R.maxDepth,Ya=R.iterator,gb=R.showUnknown,lc=R.showInternal,$b=this;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Yc){if(1==Yc.nextAddress)return Yc.yield($b.uncollapseAll(function(Sc,Uc){return va>Uc&&(Sc==$b.root||Sc.value.submorphs)}),2);$b.asListWithIndexAndDepth(!1).forEach(function(Sc){var Uc=Sc.node;return 0==Sc.depth?Uc.visible=!0:!gb&&Uc.keyString&&Uc.keyString.includes("UNKNOWN PROPERTY")||!lc&&Uc.keyString&&Uc.keyString.includes("internal")?Uc.visible=!1:Uc.value&&Uc.value.submorphs?Uc.visible=!0:Uc.visible=Ya(Uc)});Yc.jumpToEnd()})}},{key:"getChildren",
value:function(R){return R.children}},{key:"display",value:function(R){return R.display(this.inspector)}},{key:"isCollapsed",value:function(R){return R.isCollapsed}},{key:"isLeaf",value:function(R){return sd.obj.isPrimitive(R.value)}},{key:"collapse",value:function(R,va){var Ya=this;R.isCollapsed=va;va||this.isLeaf(R)||R.children.length||(R.children=sd.propertiesOf(R).map(function(gb){Ya.parentMap.set(gb,R);return gb}))}},{key:"retrieveForRemoteProxy",value:function(R){R.uuid||(R.uuid=sd.newUUID(),
this.idToNodeMap[R.uuid]=R);return{uuid:R.uuid,value:this.isLeaf(R)?R.value:{},keyString:R.keyString,key:R.keyString,valueString:sd.safeToString(R.value),isCollapsed:!0,children:[]}}},{key:"systemInterface",get:function(){return sd.localInterface}},{key:"getNodeViaId",value:function(R){return this.idToNodeMap[R]}},{key:"asRemoteDelegate",value:function(R){this.idToNodeMap={};this.isRemoteDelegate=!0;System.get("@lively-env").remoteInspectionContext||(System.get("@lively-env").remoteInspectionContext=
{});System.get("@lively-env").remoteInspectionContext[R]=this;return this.retrieveForRemoteProxy(this.root)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"InspectionTree"}},{key:"forObject",value:function(R,va){return new this({key:"inspectee",value:{inspectee:R},isCollapsed:!0,inspector:va})}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5932,end:8631})}(sd.TreeData);sd.InspectionTree=Zd;sd.InspectionTree=Zd;sd.InspectionTree=Zd;var ie=function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ob=Ma.hasOwnProperty("RemoteInspectionTree")&&"function"===typeof Ma.RemoteInspectionTree?Ma.RemoteInspectionTree:Ma.RemoteInspectionTree=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return zb(ob,ta,[{key:"systemInterface",get:function(){return this.evalEnvironment.systemInterface}},{key:Symbol.for("lively-instance-initialize"),value:function(R){this.parentMap=new WeakMap;this.root=R.proxy;this.evalEnvironment=R.evalEnvironment;this.inspector=R.inspector;this.delegateId=R.delegateId}},{key:"getContextFor",value:function(R){return"System.get('@lively-env').remoteInspectionContext[\""+this.delegateId+'"].getNodeViaId("'+R.uuid+'").value'}},{key:"dispose",value:function(){var R=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(va){return va.yield(R.evalEnvironment.systemInterface.runEval("\n      delete System.get('@lively-env').remoteInspectionContext['"+R.delegateId+"']\n    ",R.evalEnvironment),0)})}},{key:"display",value:function(R){return R.keyString+": "+R.valueString}},{key:"collapse",value:function(R,va){var Ya=this,gb;return $jscomp.asyncExecutePromiseGeneratorProgram(function(lc){if(1==lc.nextAddress)return(R.isCollapsed=va)||Ya.isLeaf(R)?lc.return():
R.children.length?lc.jumpTo(0):lc.yield(Ya.evalEnvironment.systemInterface.runEval('\n         const node = this.getNodeViaId("'+R.uuid+'");\n         try {\n           this.collapse(node, false);\n         } catch (e) {\n\n         }\n         node.children.map(n => this.retrieveForRemoteProxy(n));\n      ',{targetModule:"/lively.ide/js/inspector/context.js",context:"System.get('@lively-env').remoteInspectionContext[\""+Ya.delegateId+'"]'}),3);gb=lc.yieldResult;R.children=gb.isError?[]:gb.value;
lc.jumpToEnd()})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"RemoteInspectionTree"}},{key:"forObject",value:function(R,va){var Ya=this,gb,lc,$b,Yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return Sc.yield(Ya.createRemoteContext(R,va),2);gb=Sc.yieldResult;lc=gb.proxy;$b=gb.delegateId;Yc=gb.evalEnvironment;return Sc.return(new Ya({key:"inspectee",proxy:lc,delegateId:$b,evalEnvironment:Yc,inspector:va}))})}},{key:"createRemoteContext",value:function(R,
va){var Ya=R.code,gb=R.evalEnvironment,lc=R.delegateId,$b,Yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return lc="lively://inspector-"+va.id,Sc.yield(gb.systemInterface.runEval('\n       const { InspectionTree } = await System.import("lively.ide/js/inspector/context.js");\n       const t = (() => '+Ya+')();\n       const tree = InspectionTree.forObject(t);\n       tree.asRemoteDelegate("'+lc+'");\n    ',gb),2);$b=Sc.yieldResult;Yc=$b.value;return Sc.return({delegateId:lc,
evalEnvironment:gb,proxy:Yc})})}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:8640,end:10983})}(sd.InspectionTree);sd.RemoteInspectionTree=ie;sd.RemoteInspectionTree=ie;sd.RemoteInspectionTree=ie;(function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),
ob=Ma.hasOwnProperty("InspectionNode")&&"function"===typeof Ma.InspectionNode?Ma.InspectionNode:Ma.InspectionNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:Symbol.for("lively-instance-initialize"),value:function(R){var va=R.root,Ya=R.priority,gb=R.key,lc=R.keyString,$b=R.value,Yc=R.valueString,Sc=R.isCollapsed,Uc=void 0===R.children?[]:R.children,Xd=void 0===R.isSelected?!1:R.isSelected,qe=
void 0===R.visible?!0:R.visible;this.partition=R.partition;this.priority=Ya;this.key=gb;this.keyString=String(lc||gb);this.value=$b;this.valueString=Yc||sd.printValue($b);this.isCollapsed=Sc;this.children=Uc;this.isSelected=Xd;this.visible=qe;this.root=va}},{key:"__only_serialize__",get:function(){return[]}},{key:"isInspectionNode",get:function(){return!0}},{key:"getSubNode",value:function(R){if(R.value&&R.value.isMorph)return new sd.MorphNode(Object.assign({root:this.root},R));var va=R.key,Ya=R.keyString,
gb=this.value,lc=R.partition;lc&&(gb=lc.originalValue,Ya=va);return new sd.PropertyNode(Object.assign({},R,{keyString:Ya,key:va,target:gb,partition:lc,root:this.root,spec:{}}))}},{key:"display",value:function(R){var va=this.keyString,Ya=this.valueString;if(!this.interactive)return va+": "+Ya;this._propertyWidget||(this._propertyWidget=R.renderDraggableTreeLabel({value:va+": "+Ya}));this._propertyWidget.isSelected=this.isSelected;return this._propertyWidget}}],[{key:Symbol.for("__LivelyClassName__"),
get:function(){return"InspectionNode"}},{key:"for",value:function(R,va){va=void 0===va?null:va;return R.value&&R.value.isMorph?new sd.MorphNode(Object.assign({root:va},R)):new sd.InspectionNode(Object.assign({root:va},R))}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:10985,
end:13522})})(void 0);(function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ob=Ma.hasOwnProperty("MorphNode")&&"function"===typeof Ma.MorphNode?Ma.MorphNode:Ma.MorphNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:Symbol.for("lively-instance-initialize"),value:function(R){zb._get(Object.getPrototypeOf(ob.prototype),Symbol.for("lively-instance-initialize"),
this).call(this,R);this.target=this.value;this.propertyInfo=this.target.propertiesAndPropertySettings().properties}},{key:"getSubNode",value:function(R){var va=this.propertyInfo[R.key]||{};return R.value&&R.value.isMorph?new sd.MorphNode(Object.assign({},R,{root:this.root})):new sd.PropertyNode(Object.assign({},R,{root:this.root,target:this.target,spec:va}))}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"MorphNode"}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:13524,end:14670})})(sd.InspectionNode);(function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ob=Ma.hasOwnProperty("PropertyNode")&&"function"===typeof Ma.PropertyNode?Ma.PropertyNode:Ma.PropertyNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||
this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:Symbol.for("lively-instance-initialize"),value:function(R){zb._get(Object.getPrototypeOf(ob.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);var va=R.spec,Ya=R.target;this.partition=R.partition;this.target=Ya;this.spec=va;this.foldedNodes={}}},{key:"__deserialize__",value:function(R,va){this.spec={}}},{key:"interactive",get:function(){return this._interactive}},{key:"interactive",set:function(R){this._interactive=
R}},{key:"isFoldable",get:function(){return!!this.spec.foldable}},{key:"isInternalProperty",get:function(){return"id"==this.keyString||this.keyString.includes("internal")}},{key:"getSubNode",value:function(R){return this.isFoldable?this.getFoldedContext(R):zb._get(Object.getPrototypeOf(ob.prototype),"getSubNode",this).call(this,R)}},{key:"getFoldedContext",value:function(R){return this.foldedNodes[R.key]=new sd.FoldedNode(Object.assign({},R,{root:this.root,target:this.target,foldableNode:this,spec:sd.obj.dissoc(this.spec,
["foldable"])}))}},{key:"rerender",value:function(){this.root.inspector.refreshSelectedLine()}},{key:"refreshProperty",value:function(R,va){(va=void 0===va?!1:va)&&(this.target[this.key]=R);this.value=this.target[this.key];this.valueString=sd.printValue(this.value);this.interactive&&(va||this._propertyWidget.highlight());if(this.isFoldable)for(var Ya in this.foldedNodes)this.foldedNodes[Ya].value=this.value[Ya],this.foldedNodes[Ya].valueString=sd.printValue(this.value[Ya]),this.foldedNodes[Ya]._propertyWidget&&
sd.signal(this.foldedNodes[Ya]._propertyWidget,"update",this.value[Ya])}},{key:"display",value:function(R){var va=this,Ya=this._propertyWidget,gb=this.keyString,lc=this.valueString,$b=this.target,Yc=this.value,Sc=this.spec;if(!(this.interactive||Sc.foldable&&sd.isMultiValue(Yc,Sc.foldable)))return R.renderPropertyControl({target:$b,keyString:gb,valueString:lc,tree:R.ui.propertyTree,value:Yc,spec:Sc,node:this,fastRender:!0});if(Ya)return Ya.keyString=gb,Ya.valueString=lc,Ya.isSelected=this.isSelected,
Ya.control&&(Ya.control.isSelected=this.isSelected),Ya;Ya=this._propertyWidget=R.renderPropertyControl({target:$b,keyString:gb,valueString:lc,value:Yc,spec:Sc,node:this,isSelected:this.isSelected,fontColor:R.ui.propertyTree.fontColor});this.isInternalProperty||Sc.readOnly||(sd.connect(Ya,"propertyValue",this,"refreshProperty",{updater:function(Uc,Xd){return Uc(Xd,!0)}}),sd.connect(Ya,"openWidget",this.root,"onWidgetOpened",{converter:function(Uc){return{widget:Uc,node:va.sourceObj}}}));return Ya}}],
[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyNode"}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:14672,end:18071})})(sd.InspectionNode);(function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector/context.js"),ob=Ma.hasOwnProperty("FoldedNode")&&
"function"===typeof Ma.FoldedNode?Ma.FoldedNode:Ma.FoldedNode=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:Symbol.for("lively-instance-initialize"),value:function(R){zb._get(Object.getPrototypeOf(ob.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);this.foldableNode=R=R.foldableNode;this.foldedProp=R.key+sd.string.capitalize(this.key)}},{key:"refreshProperty",value:function(R,
va){va=void 0===va?!1:va;var Ya={};this.foldableNode.refreshProperty(Object.assign({},this.target[this.foldableNode.key],(Ya[this.key]=R,Ya)),va)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"FoldedNode"}}],Ma,{pathInPackage:function(){return"js/inspector/context.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:18073,
end:18749})})(sd.PropertyNode);var Ne=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js");Ne.Color=kb;var wf=function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/themes/dark.js"),ob=Ma.hasOwnProperty("DarkTheme")&&"function"===typeof Ma.DarkTheme?Ma.DarkTheme:Ma.DarkTheme=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:"background",get:function(){return Ne.Color.rgb(44,62,
80)}},{key:"cursorColor",get:function(){return Ne.Color.gray}},{key:"default",get:function(){return{fontColor:"#abb2bf"}}},{key:"header",get:function(){return{fontSize:"110%",fontColor:"#6b94ee"}}},{key:"header-1",get:function(){return{fontSize:"135%",fontColor:"#6b94ee"}}},{key:"header-2",get:function(){return{fontSize:"125%",fontColor:"#6b94be"}}},{key:"header-3",get:function(){return{fontSize:"120%",fontColor:"#6b94be"}}},{key:"quote",get:function(){return{fontColor:"#090"}}},{key:"negative",get:function(){return{fontColor:"#d44"}}},
{key:"positive",get:function(){return{fontColor:"#292"}}},{key:"strong",get:function(){return{fontWeight:"bold"}}},{key:"em",get:function(){return{fontStyle:"italic"}}},{key:"link",get:function(){return{textDecoration:"underline"}}},{key:"strikethrough",get:function(){return{textDecoration:"line-through"}}},{key:"hr",get:function(){return{fontColor:"#999"}}},{key:"link",get:function(){return{textDecoration:"underline",fontColor:"#2c2cff"}}},{key:"url",get:function(){return{textDecoration:"underline",
fontColor:"#2c2cff"}}},{key:"keyword",get:function(){return{fontColor:Ne.Color.rgb(204,109,243)}}},{key:"atom",get:function(){return{fontColor:"#d19a66"}}},{key:"number",get:function(){return{fontColor:Ne.Color.orange}}},{key:"def",get:function(){return{fontColor:"#e5c07b"}}},{key:"variable",get:function(){return{fontColor:"#d19a66"}}},{key:"punctuation",get:function(){return{fontColor:"#05a"}}},{key:"property",get:function(){return{fontColor:Ne.Color.rgb(33,150,243)}}},{key:"operator",get:function(){return{fontColor:"#abb2bf"}}},
{key:"variable-2",get:function(){return{fontColor:"#e06c75"}}},{key:"variable-3",get:function(){return{fontColor:"#085"}}},{key:"comment",get:function(){return{fontColor:"#7F848E"}}},{key:"string",get:function(){return{fontColor:"#98c378"}}},{key:"string-2",get:function(){return{fontColor:"#98c378"}}},{key:"meta",get:function(){return{fontColor:"#555"}}},{key:"qualifier",get:function(){return{fontColor:"#d19a66"}}},{key:"builtin",get:function(){return{fontColor:"#30a"}}},{key:"bracket",get:function(){return{fontColor:"#515a6b"}}},
{key:"brace",get:function(){return{fontColor:"#abb2bf"}}},{key:"tag",get:function(){return{fontColor:"#170"}}},{key:"attribute",get:function(){return{fontColor:"#d19a66"}}},{key:"error",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"invalidchar",get:function(){return{backgroundColor:"#ff4c4c"}}},{key:"diff-file-header",get:function(){return{fontColor:Ne.Color.white,fontWeight:"bold",backgroundColor:Ne.Color.rgba(136,136,136,.7)}}},{key:"diff-hunk-header",get:function(){return{backgroundColor:Ne.Color.rgba(204,
204,204,.4),fontWeight:"bold"}}},{key:"coord",get:function(){return{backgroundColor:Ne.Color.rgba(204,204,204,.4),fontWeight:"bold"}}},{key:"inserted",get:function(){return{backgroundColor:"rgba(108,255,108, .3)"}}},{key:"deleted",get:function(){return{backgroundColor:"rgba(255,108,108, .3)"}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DarkTheme"}},{key:"instance",get:function(){return this._instance||(this._instance=new this)}}],Ma,{pathInPackage:function(){return"themes/dark.js"},
unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:42,end:3048})}(void 0),Ye=wf=Ne.DarkTheme;Ne.default=wf;var uc=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js");uc.inspect=yc;uc.remoteInspect=Rd;uc.generateReferenceExpression=bd;uc.onNumberDragStart=function(ta,Ma){Ma.initPos=ta.position;Ma.factorLabel=(new uc.Tooltip({description:"1x"})).openInWorld(ta.hand.position.addXY(10,
10))};uc.onNumberDrag=function(ta,Ma){var ob=uc.getScaleAndOffset(ta,Ma),R=ob.scale;ob=ob.offset;Ma.factorLabel.position=ta.hand.position.addXY(10,10);Ma.factorLabel.description=R+"x";return uc.getCurrentValue(ob,R,Ma)};uc.onNumberDragEnd=function(ta,Ma){var ob=uc.getScaleAndOffset(ta,Ma);ta=ob.offset;ob=ob.scale;Ma.factorLabel.softRemove();return uc.getCurrentValue(ta,ob,Ma)};uc.getScaleAndOffset=function(ta,Ma){var ob=ta.position.subPt(Ma.initPos);ta=ob.x;Ma=uc.num.roundTo(Math.exp(-ob.y/$world.height*
6),.01)*Ma.baseFactor;return{offset:ta,scale:Ma}};uc.getCurrentValue=function(ta,Ma,ob){return Math.max(ob.min,Math.min(ob.max,ob.scrubbedValue+(ob.floatingPoint?ta*Ma:Math.round(ta*Ma))))};uc.Color=kb;uc.Rectangle=Mb;uc.rect=Bd;uc.pt=Fd;uc.obj=Xc;uc.num=nb;uc.Path=Hb;uc.arr=Sb;uc.promise=Ub;uc.connect=Fc;uc.disconnect=vb;uc.once=Na;uc.Morph=kc;uc.Tooltip=xc;uc.VerticalLayout=Dc;uc.GridLayout=Gb;uc.HorizontalLayout=$a;uc.morph=Jc;uc.CustomLayout=dc;uc.Label=oc;uc.Icon=sa;uc.StyleSheet=Kc;uc.config=
Ca;uc.Tree=bb;uc.LoadingIndicator=rb;uc.DropDownList=qb;uc.DropDownSelector=Sa;uc.SearchField=Ta;uc.LabeledCheckBox=sb;uc.MorphHighlighter=Xb;uc.InteractiveMorphSelector=wc;uc.printValue=le;uc.RemoteInspectionTree=ie;uc.InspectionTree=Zd;uc.isMultiValue=Wd;uc.valueWidgets=I;uc.popovers=T;uc.DarkTheme=Ye;uc.DefaultTheme=tb;uc.syncEval=Zb;uc.inspectorCommands=[{name:"focus codeEditor",exec:function(ta){ta.get("codeEditor").show();ta.get("codeEditor").focus();return!0}},{name:"focus propertyTree",exec:function(ta){ta.get("propertyTree").show();
ta.get("propertyTree").focus();return!0}}];(function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ob=Ma.hasOwnProperty("DraggedProp")&&"function"===typeof Ma.DraggedProp?Ma.DraggedProp:Ma.DraggedProp=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:"applyToTarget",value:function(R){var va=this.currentTarget,Ya=this.control;this.remove();uc.MorphHighlighter.removeHighlighters(R.world);
if(va)if(va.isText&&"js"===va.editorModeName){var gb=va.evalEnvironment.context;R=va.textPositionFromPoint(va.localize(R.position));gb=uc.generateReferenceExpression(this.sourceObject,{fromMorph:gb});Ya.keyString&&(gb+="."+Ya.keyString);va.insertTextAndSelect(gb,R);va.focus()}else"propertyValue"in Ya&&(va[Ya.keyString]=Ya.propertyValue)}},{key:"update",value:function(R){R=R.hand.globalPosition;var va=this.morphBeneath(R),Ya;if(va){for(va==this.morphHighlighter&&(va=va.morphBeneath(R));Ya=[va].concat($jscomp.arrayFromIterable(va.ownerChain())).find(function(gb){return!gb.visible});)va=
Ya=Ya.morphBeneath(R);if(va!=this.currentTarget){this.currentTarget=va;this.morphHighlighter&&this.morphHighlighter.deactivate();if(va.isWorld)return;this.morphHighlighter=uc.MorphHighlighter.for($world,va);this.morphHighlighter.show()}this.position=R}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggedProp"}},{key:"properties",get:function(){return{control:{},sourceObject:{},borderColor:{defaultValue:uc.Color.rgb(169,204,227)},fill:{defaultValue:uc.Color.rgb(235,245,251).withA(.8)},
borderWidth:{defaultValue:2},borderRadius:{defaultValue:4},submorphs:{after:["control"],initialize:function(){var R=this.control;if(!R)return this.submorphs=[];this.height=22;this.submorphs=[R];R.top=0;R.fontSize=14;"function"===typeof R.relayout&&R.relayout();this.width=R.width+20;this.adjustOrigin(uc.pt(10,10))}}}}}],Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:1268,end:3690})})(uc.Morph);(function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ob=Ma.hasOwnProperty("DraggableTreeLabel")&&"function"===typeof Ma.DraggableTreeLabel?Ma.DraggableTreeLabel:Ma.DraggableTreeLabel=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:"inspector",get:function(){return this.owner.owner}},
{key:"onDragStart",value:function(R){this.draggedProp=new uc.DraggedProp({sourceObject:this.inspector.targetObject,control:this.copy()});this.draggedProp.openInWorld();uc.connect(R.hand,"update",this.draggedProp,"update")}},{key:"onDrag",value:function(R){}},{key:"onDragEnd",value:function(R){uc.disconnect(R.hand,"update",this.draggedProp,"update");this.draggedProp.applyToTarget(R)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"DraggableTreeLabel"}},{key:"properties",get:function(){return{styleClasses:{defaultValue:["TreeLabel"]},
draggable:{defaultValue:!0},nativeCursor:{defaultValue:"-webkit-grab"},keyString:{},valueString:{},fontFamily:{defaultValue:uc.config.codeEditor.defaultStyle.fontFamily},fill:{defaultValue:uc.Color.transparent},padding:{defaultValue:uc.rect(0,1,10,-1)},isSelected:{after:["submorphs"],set:function(R){this.setProperty("isSelected",R);R?(this.removeStyleClass("deselected"),this.addStyleClass("selected")):(this.addStyleClass("deselected"),this.removeStyleClass("selected"));this.control&&(this.control.isSelected=
R)}}}}}],Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3692,end:5015})})(uc.Label);Zd=function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ob=Ma.hasOwnProperty("PropertyControl")&&"function"===typeof Ma.PropertyControl?Ma.PropertyControl:Ma.PropertyControl=
function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:"menuItems",value:function(){return this._targetMenuItems||[]}},{key:"renderValueSelector",value:function(R,va,Ya){R.control=new uc.DropDownSelector({opacity:.8,fill:uc.Color.white.withA(.5),name:"valueString",styleClasses:["TreeLabel"],selectedValue:va,padding:0,values:Ya});uc.connect(R.control,"update",R,"propertyValue",{updater:function(gb,lc){this.targetObj.propertyValue!=
lc&&gb(lc)}});uc.connect(R,"update",R.control,"selectedValue",{updater:function(gb,lc){lc=lc&&lc.valueOf?lc.valueOf():lc;this.targetObj.propertyValue!=lc&&gb(lc)}});return R}},{key:"toggleMultiValuePlaceholder",value:function(R){this.multiValuePlaceholder=this.multiValuePlaceholder||this.addMorph({fill:uc.Color.transparent,layout:new uc.HorizontalLayout({spacing:3}),name:"multi value placeholder",nativeCursor:"pointer",submorphs:uc.arr.range(0,2).map(function(va){return{type:"ellipse",fill:uc.Color.gray.withA(.5),
reactsToPointer:!1,extent:uc.pt(7,7)}})});R?(uc.connect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue",{converter:function(){return this.targetObj.propertyValue.valueOf()}}),this.control.opacity=0,this.multiValuePlaceholder.visible=!0):(uc.disconnect(this.multiValuePlaceholder,"onMouseDown",this,"propertyValue"),this.control.opacity=1,this.multiValuePlaceholder.visible=!1)}},{key:"toggleFoldableValue",value:function(R){this.foldableProperties&&this.toggleMultiValuePlaceholder(uc.isMultiValue(R,
this.foldableProperties))}},{key:"asFoldable",value:function(R){this.foldableProperties=R;uc.connect(this,"update",this,"toggleFoldableValue")}},{key:"relayout",value:function(){this.fit();this.control&&(this.control.topLeft=this.textBounds().topRight().addXY(-2,1),this.width=this.textBounds().width+this.control.bounds().width);this.height=18;this.multiValuePlaceholder&&(this.multiValuePlaceholder.leftCenter=this.textBounds().rightCenter())}},{key:"toString",value:function(){return this.keyString+
": "+this.valueString}},{key:"highlight",value:function(){this.highlighter&&this.highlighter.remove();var R=this.highlighter=this.addMorph({type:"label",name:"valueString",value:this.keyString});R.isLayoutable=!1;R.fontWeight="bold";R.fontColor=uc.Color.orange;R.reactsToPointer=!1;R.fadeOut(2E3)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyControl"}},{key:"properties",get:function(){return{root:{},keyString:{},valueString:{},propertyValue:{},control:{after:["submorphs"],
derived:!0,get:function(){return this.submorphs[0]||!1},set:function(R){this.submorphs=[R]}},layout:{initialize:function(){this.layout=new uc.CustomLayout({relayout:function(R){R.relayout()}})}},submorphs:{initialize:function(){this.value=this.keyString+":";this.submorphs=[]}}}}},{key:"inferType",value:function(R){return(R=R.value)&&(R.isColor||R.isGradient)?"Color":R&&R.isPoint?"Point":uc.obj.isBoolean(R)?"Boolean":uc.obj.isNumber(R)?"Number":uc.obj.isString(R)?"String":R&&R.isRectangle?"Rectangle":
!1}},{key:"render",value:function(R){R.spec.type||(R.spec=Object.assign({},R.spec,{type:this.inferType(R)}));switch(R.spec.type){case "Color":var va=this.renderColorControl(R);break;case "ColorGradient":va=this.renderColorControl(Object.assign({},R,{gradientEnabled:!0}));break;case "Number":va=this.renderNumberControl(R);break;case "String":va=this.renderStringControl(R);break;case "RichText":va=this.renderStringControl(R);break;case "Layout":va=this.renderLayoutControl(R);break;case "Enum":va=this.renderEnumControl(R);
break;case "Shadow":va=this.renderShadowControl(R);break;case "Point":va=this.renderPointControl(R);break;case "Rectangle":va=this.renderRectangleControl(R);break;case "Boolean":va=this.renderBooleanControl(R);break;default:va=this.renderItSomehow(R)}va.control&&(uc.connect(va.control,"openWidget",va,"openWidget"),va.toggleFoldableValue(R.value));return va}},{key:"baseControl",value:function(R){var va=R.spec;R=new this({keyString:R.keyString,valueString:R.valueString,isSelected:!1,propertyValue:R.value});
va.foldable&&R.asFoldable(va.foldable);return R}},{key:"renderGrabbableKey",value:function(R){var va=this,Ya=R.target;return[R.keyString+":",{nativeCursor:"-webkit-grab",onDragStart:function(gb){gb.state.draggedProp=new uc.DraggedProp({sourceObject:Ya,control:va.baseControl(R)});gb.state.draggedProp.openInWorld();uc.connect(gb.hand,"update",gb.state.draggedProp,"update")},onDrag:function(gb){},onDragEnd:function(gb){uc.disconnect(gb.hand,"update",gb.state.draggedProp,"update");gb.state.draggedProp.applyToTarget(gb)}}]}},
{key:"renderEnumControl",value:function(R){var va=R.value,Ya=R.spec.values,gb=R.keyString,lc=R.target,$b=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(va?va.valueOf?va.valueOf():va:"Not set"),{nativeCursor:"pointer",onMouseDown:function(Yc,Sc){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){lc.world().openWorldMenu(Yc,Ya.map(function(Xd){return{string:Xd.toString(),action:function(){lc[gb]=Xd;$b.rerender()}}}));Uc.jumpToEnd()})}}],$jscomp.arrayFromIterable(uc.Icon.textAttribute("angle-down",
{paddingTop:"4px",paddingLeft:"4px",opacity:.7})))}},{key:"renderStringControl",value:function(R){var va=R.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(200<va.length?va.slice(0,20)+"...":va),{fontColor:uc.Color.blue,paddingTop:"0px"}])}},{key:"renderRectangleControl",value:function(R){var va=R.value,Ya=R.keyString,gb=R.valueString,lc=R.target,$b=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+gb,{fontColor:uc.Color.black,nativeCursor:"pointer",
onMouseDown:function(Yc){var Sc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Uc){if(1==Uc.nextAddress)return Sc=new uc.popovers.RectanglePopover({hasFixedPosition:!0,rectangle:va}),Sc.relayout(),Uc.yield(Sc.fadeIntoWorld(Yc.positionIn(lc.world())),2);uc.connect(Sc,"rectangle",function(Xd){lc[Ya]=Xd;$b.rerender()});Uc.jumpToEnd()})}}])}},{key:"renderBooleanControl",value:function(R){var va=R.value,Ya=R.keyString,gb=R.valueString,lc=R.target,$b=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),
[" "+gb,{nativeCursor:"pointer",fontColor:va?uc.Color.green:uc.Color.red,onMouseDown:function(Yc){lc[Ya]=!lc[Ya];$b.rerender()}}])}},{key:"renderNumberControl",value:function(R){var va=R.value,Ya=R.spec,gb=R.keyString,lc=R.valueString,$b=R.node,Yc=R.target,Sc=R.tree,Uc=void 0===$b._numberControls?new Ze:$b._numberControls,Xd=$jscomp.makeIterator(Uc.submorphs),qe=Xd.next().value,tf=Xd.next().value;Uc.fontColor=Sc.fontColor;var Ag=$b._numberControls=Uc;"max"in Ya&&"min"in Ya&&-Infinity!=Ya.min&&Infinity!=
Ya.max?(Ag.baseFactor=(Ya.max-Ya.min)/100,Ag.floatingPoint=Ya.isFloat,Ag.max=Ya.max,Ag.min=Ya.min):(Ag.floatingPoint=Ya.isFloat,Ag.baseFactor=.5,Ag.min=void 0!=Ya.min?Ya.min:-Infinity,Ag.max=void 0!=Ya.max?Ya.max:Infinity);var yh=uc.valueWidgets.NumberWidget.properties.fontColor.defaultValue;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),$jscomp.arrayFromIterable($b._inputMorph?[$b._inputMorph,{}]:[" "+(void 0!=va&&(va.valueOf?va.valueOf():va).toFixed(Ya.isFloat?3:0))+" ",{fontColor:yh,
onMouseUp:function(Lg){$b._inputMorph=uc.morph({type:"input",fill:null,fontColor:yh,fontFamily:"IBM Plex Mono",fontSize:14,padding:uc.rect(8,2,-6,2),height:23,cursorColor:uc.Color.white,value:va.valueOf?va.valueOf():lc});Yc[gb]=va;$b._inputMorph.focus();uc.once($b._inputMorph,"inputAccepted",function(pi){delete $b._inputMorph;Yc[gb]=Ya.isFloat?Number.parseFloat(pi):Number.parseInt(pi);$b.rerender()});uc.once($b._inputMorph,"onBlur",function(pi){$b._inputMorph&&(delete $b._inputMorph,Yc[gb]=va,$b.rerender())});
$b.rerender()},onDragStart:function(Lg){Ag.scrubbedValue=va;uc.onNumberDragStart(Lg,Ag)},onDrag:function(Lg){Yc[gb]=uc.onNumberDrag(Lg,Ag);$b.rerender()},onDragEnd:function(Lg){return uc.onNumberDragEnd(Lg,Ag)}},Uc,{onMouseUp:function(){qe.fill=tf.fill=null},onMouseDown:function(Lg){if(Lg.targetMorph===qe){qe.fill=uc.Color.white.withA(.2);if("max"in Ya&&Yc[gb]>=Ya.max)return;Yc[gb]+=1}if(Lg.targetMorph===tf){tf.fill=uc.Color.white.withA(.2);if("min"in Ya&&Yc[gb]<=Ya.min)return;--Yc[gb]}$b.rerender()}}]))}},
{key:"renderShadowControl",value:function(R){var va=R.keyString,Ya=R.value,gb=R.target,lc=R.node;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[""+(Ya?Ya.toFilterCss():"No Shadow"),{nativeCursor:"pointer",onMouseDown:function($b){var Yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return Yc=new uc.popovers.ShadowPopover({shadowValue:gb[va],hasFixedPosition:!0}),Sc.yield(Yc.fadeIntoWorld($b.positionIn(gb.world())),2);uc.connect(Yc,"shadowValue",
function(Uc){gb[va]=Uc;lc.rerender()});Sc.jumpToEnd()})}}])}},{key:"renderPointControl",value:function(R){var va=R.keyString,Ya=R.value,gb=R.target,lc=R.node,$b=uc.valueWidgets.NumberWidget.properties.fontColor.defaultValue,Yc={nativeCursor:"pointer",onMouseDown:function(Sc){var Uc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xd){if(1==Xd.nextAddress)return Uc=new uc.popovers.PointPopover({pointValue:gb[va],hasFixedPosition:!0}),Xd.yield(Uc.fadeIntoWorld(Sc.positionIn(gb.world())),
2);uc.connect(Uc,"pointValue",function(qe){gb[va]=qe;lc.rerender()});Xd.jumpToEnd()})}};return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" pt(",Object.assign({},Yc),""+Ya.x.toFixed(),Object.assign({fontColor:$b},Yc),",",Object.assign({},Yc),""+Ya.y.toFixed(),Object.assign({fontColor:$b},Yc),")",Object.assign({},Yc)])}},{key:"renderLayoutControl",value:function(R){var va=R.valueString,Ya=R.value;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+(Ya?va:
"No Layout"),{onMouseDown:function(gb){}}])}},{key:"renderColorControl",value:function(R){var va=R.node,Ya=R.gradientEnabled,gb=R.valueString,lc=R.keyString,$b=R.value,Yc=R.target;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[uc.morph({fill:$b.valueOf?$b.valueOf():$b,extent:uc.pt(15,15),borderColor:uc.Color.gray,borderWidth:1}),{paddingLeft:"5px",paddingTop:"4px",paddingRight:"5px"},""+($b?$b.valueOf?$b.valueOf():gb:"No Color"),{nativeCursor:"pointer",onMouseDown:function(Sc){var Uc;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(Xd){if(1==Xd.nextAddress)return Uc=new uc.popovers.FillPopover({hasFixedPosition:!0,handleMorph:Yc,fillValue:$b,title:"Fill Control",gradientEnabled:Ya}),Xd.yield(Uc.fadeIntoWorld(Sc.positionIn(Yc.world())),2);uc.connect(Uc,"fillValue",function(qe){Yc[lc]=qe;va.rerender()});Xd.jumpToEnd()})}}])}},{key:"renderItSomehow",value:function(R){var va=R.valueString;return[].concat($jscomp.arrayFromIterable(this.renderGrabbableKey(R)),[" "+va,{}])}}],
Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:5024,end:20444})}(uc.DraggableTreeLabel);uc.PropertyControl=Zd;uc.PropertyControl=Zd;uc.PropertyControl=Zd;uc.inspect=yc;uc.inspect=yc;uc.remoteInspect=Rd;uc.remoteInspect=Rd;uc.generateReferenceExpression=bd;uc.generateReferenceExpression=
bd;var Ze=function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ob=Ma.hasOwnProperty("NumberControls")&&"function"===typeof Ma.NumberControls?Ma.NumberControls:Ma.NumberControls=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,void 0,[{key:Symbol.for("__LivelyClassName__"),get:function(){return"NumberControls"}},{key:"properties",get:function(){return{layout:{initialize:function(){this.layout=
new uc.VerticalLayout({spacing:0,orderByIndex:!0})}},fill:{defaultValue:uc.Color.transparent},width:{defaultValue:15},fontColor:{derived:!0,set:function(R){this.submorphs.map(function(va){return va.fontColor=R})}},submorphs:{initialize:function(){this.submorphs=[uc.Icon.makeLabel("sort-up",{autofit:!0,opacity:.6,nativeCursor:"pointer",padding:uc.rect(5,2,0,-6),fontSize:12}),uc.Icon.makeLabel("sort-up",{top:10,rotation:Math.PI,autofit:!0,padding:uc.rect(5,4,0,-9),opacity:.6,nativeCursor:"pointer",
fontSize:12})]}}}}}],Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:23095,end:24127})}(uc.Morph);(function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ob=Ma.hasOwnProperty("PropertyTree")&&"function"===typeof Ma.PropertyTree?Ma.PropertyTree:Ma.PropertyTree=
function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:"onDrag",value:function(R){this._onDragHandler&&this._onDragHandler(R)}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"PropertyTree"}}],Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",
version:"0.1.0"}}},{start:25279,end:25389})})(uc.Tree);Zd=function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/js/inspector.js"),ob=Ma.hasOwnProperty("Inspector")&&"function"===typeof Ma.Inspector?Ma.Inspector:Ma.Inspector=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:"onWindowClose",value:function(){this.stopStepping();this.ui.propertyTree.treeData.dispose();this.openWidget&&this.closeOpenWidget()}},
{key:"onMouseMove",value:function(R){}},{key:"__after_deserialize__",value:function(R,va,Ya){var gb=this,lc=new uc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:uc.InspectionTree.forObject(null,this)}));this.addMorph(lc,this.getSubmorphNamed("terminal toggler"));this.layout.col(0).row(1).group.morph=lc;this.whenRendered().then(function(){gb.targetObject&&(gb.targetObject=gb.targetObject)});zb._get(Object.getPrototypeOf(ob.prototype),"__after_deserialize__",this).call(this,
R,va,Ya)}},{key:"__additionally_serialize__",value:function(R,va,Ya,gb){R=R.props.submorphs.value;for(va=R.length;va--;)Ya.refForId(R[va].id).realObj==this.ui.propertyTree&&uc.arr.removeAt(R,va)}},{key:"renderDraggableTreeLabel",value:function(R){return new uc.DraggableTreeLabel(R)}},{key:"renderPropertyControl",value:function(R){return uc.PropertyControl.render(R)}},{key:"onLoad",value:function(){var R=this.ui,va=R.codeEditor,Ya=R.thisBindingSelector,gb=R.propertyTree;va.changeEditorMode("js").then(function(){return va.evalEnvironment=
{targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==Ya.selection?va.owner.selectedContext:va.owner.targetObject},get systemInterface(){return uc.Path("treeData.systemInterface").get(gb)},format:"esm"}}).catch(function(lc){return $world.logError(lc)})}},{key:Symbol.for("lively-instance-initialize"),value:function(R){zb._get(Object.getPrototypeOf(ob.prototype),Symbol.for("lively-instance-initialize"),this).call(this,R);R=this.ui;var va=R.targetPicker,Ya=R.propertyTree,
gb=R.resizer,lc=R.terminalToggler,$b=R.unknowns,Yc=R.internals,Sc=R.searchField,Uc=R.codeEditor,Xd=R.fixImportButton,qe=R.thisBindingSelector;Uc.changeEditorMode("js").then(function(){return Uc.evalEnvironment={targetModule:"lively://lively.morphic/inspector",get context(){return"selection"==qe.selection?Uc.owner.selectedContext:Uc.owner.targetObject},get systemInterface(){return Ya.treeData.systemInterface},format:"esm"}}).catch(function(tf){return $world.logError(tf)});uc.connect(va,"onMouseDown",
this,"selectTarget");uc.connect(Ya,"onScroll",this,"repositionOpenWidget");uc.connect(gb,"onDrag",this,"adjustProportions");uc.connect(lc,"onMouseDown",this,"toggleCodeEditor");uc.connect($b,"trigger",this,"filterProperties");uc.connect(Yc,"trigger",this,"filterProperties");uc.connect(Sc,"searchInput",this,"filterProperties");uc.connect(Ya,"nodeCollapseChanged",this,"filterProperties");uc.connect(this,"extent",this,"relayout");uc.connect(qe,"selection",this,"bindCodeEditorThis");uc.connect(Xd,"fire",
Uc,"execCommand",{updater:function(tf){return tf("[javascript] fix undeclared variables",{autoApplyIfSingleChoice:!0})}})}},{key:"refreshSelectedLine",value:function(){var R=this.ui.propertyTree.selectedIndex-1,va=this.ui.propertyTree.selectedNode;this.ui.propertyTree.selectedNode.refreshProperty();va=this.ui.propertyTree.document.getLine(R).textAndAttributes.slice(0,4).concat(va.display(this));R=this.ui.propertyTree.lineRange(R,!1);this.ui.propertyTree.replace(R,va,!1,!1,!1);this.ui.propertyTree.selectedNode=
this.ui.propertyTree.selectedNode}},{key:"refreshAllProperties",value:function(){this.world()||this.stopStepping();if(this.targetObject&&this.targetObject.isMorph)if(this.targetObject._styleSheetProps!=this.lastStyleSheetProps)this.refreshTreeView(),this.lastStyleSheetProps=this.targetObject._styleSheetProps;else{var R=uc.arr.last(this.targetObject.env.changeManager.changesFor(this.targetObject));if(R!=this.lastChange||this.lastSubmorphs!=uc.printValue(this.targetObject&&this.targetObject.submorphs))this.focusedNode&&
this.focusedNode.keyString==R.prop&&this.repositionOpenWidget(),this.lastChange=R,this.lastSubmorphs=uc.printValue(this.targetObject&&this.targetObject.submorphs),this.refreshTreeView()}else this.stopStepping()}},{key:"refreshTreeView",value:function(){var R;this.originalTreeData&&this.originalTreeData.asListWithIndexAndDepth(!1).forEach(function(va){va=va.node;va.target&&(R=va.foldableNode?va.target[va.foldableNode.key][va.key]:va.target[va.key],!uc.obj.equals(R,va.value)&&va.refreshProperty&&va.refreshProperty(R))});
this.ui.propertyTree.update(!0)}},{key:"isInspector",get:function(){return!0}},{key:"prepareForNewTargetObject",value:function(R,va){va=void 0===va?!1:va;var Ya=this,gb,lc,$b,Yc,Sc,Uc,Xd,qe,tf,Ag,yh,Lg,pi,Bg,Dj;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ve){switch(Ve.nextAddress){case 1:if(!Ya.isUpdating()){Ve.jumpTo(2);break}return Ve.yield(Ya.whenUpdated(),2);case 2:gb=uc.promise.deferred();lc=gb.promise;$b=!!Ya.target;Ya.updateInProgress=lc;Ve.setCatchFinallyBlocks(4);va&&(Yc=
uc.LoadingIndicator.open("connecting to remote..."));if(!va){Sc=uc.InspectionTree.forObject(R,Ya);Ve.jumpTo(6);break}return Ve.yield(uc.RemoteInspectionTree.forObject(R,Ya),7);case 7:Sc=Ve.yieldResult;case 6:return Uc=Sc,Xd=Ya.ui.propertyTree,Ve.yield(Uc.collapse(Uc.root,!1),8);case 8:if(!Uc.root.children){Ve.jumpTo(9);break}return Ve.yield(Uc.collapse(Uc.root.children[0],!1),9);case 9:if(qe=Ya.originalTreeData&&Ya.originalTreeData.diff(Uc)){tf=$jscomp.makeIterator(qe);for(Ag=tf.next();!Ag.done;Ag=
tf.next())yh=Ag.value,Lg=$jscomp.makeIterator(yh),pi=Lg.next().value,Bg=Lg.next().value,pi.refreshProperty(Bg.value);Ve.jumpTo(11);break}Xd.treeData=Uc;return Ve.yield(Ya.filterProperties(),12);case 12:if(!Xd.treeData.root.isCollapsed){Ve.jumpTo(13);break}return Ve.yield(Xd.onNodeCollapseChanged({node:Uc.root,isCollapsed:!1}),14);case 14:Xd.selectedIndex=1;case 13:return Ve.yield(Xd.execCommand("uncollapse selected node"),11);case 11:Ya.toggleWindowStyle($b);Yc&&Yc.remove();Ve.leaveTryBlock(5);break;
case 4:Dj=Ve.enterCatchBlock(),Ya.showError(Dj);case 5:Ya.startStepping(1E3,"refreshAllProperties"),Ya.updateInProgress=null,Ve.jumpToEnd()}})}},{key:"toggleWindowStyle",value:function(R){R=void 0===R?!0:R;var va=this,Ya,gb,lc,$b,Yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){if(1==Sc.nextAddress)return Ya=300,$b=va.ui.codeEditor.pluginFind(function(Uc){return Uc.runEval}),Yc=va.getWindow(),Sc.yield($b.runEval("System.get('@system-env').node"),2);Sc.yieldResult.value?(lc=[].concat($jscomp.arrayFromIterable(uc.arr.without(Yc.styleClasses,
"local")),["node"]),gb=uc.DarkTheme.instance):(lc=["local"].concat($jscomp.arrayFromIterable(Yc?uc.arr.without(Yc.styleClasses,"node"):[])),gb=uc.DefaultTheme.instance);$b.theme=gb;R?(Yc&&Yc.animate({duration:Ya,styleClasses:lc}),va.ui.codeEditor.animate({fill:gb.background,duration:Ya})):Yc&&(Yc.styleClasses=lc);va.ui.codeEditor.textString=va.ui.codeEditor.textString;$b.highlight();Sc.jumpToEnd()})}},{key:"isUpdating",value:function(){return!!this.updateInProgress}},{key:"whenUpdated",value:function(){return this.updateInProgress||
Promise.resolve()}},{key:"focus",value:function(){this.ui.codeEditor.focus()}},{key:"build",value:function(){var R=this,va=Object.assign({type:"text",borderWidth:1,borderColor:uc.Color.gray,lineWrapping:"by-chars"},uc.config.codeEditor.defaultStyle,{textString:""}),Ya=uc.Icon.textAttribute("long-arrow-alt-right",{textStyleClasses:["fas"]});uc.rect(0,0,this.width,30);var gb=new uc.SearchField({styleClasses:["idle"],name:"searchField"});Ya[1].paddingTop="2px";this.submorphs=[{name:"searchBar",submorphs:[gb,
{type:"button",name:"targetPicker",padding:uc.rect(2,2,0,0),borderRadius:15,master:{auto:"styleguide://System/buttons/light"},tooltip:"Change Inspection Target",label:uc.Icon.textAttribute("crosshairs")},new uc.LabeledCheckBox({label:"Internals",name:"internals"}),new uc.LabeledCheckBox({label:"Unknowns",name:"unknowns"})]},new uc.PropertyTree(Object.assign({name:"propertyTree"},this.treeStyle,{treeData:uc.InspectionTree.forObject(null,this)})),uc.Icon.makeLabel("keyboard",{name:"terminal toggler"}),
{name:"resizer"},Object.assign({name:"codeEditor"},va),{name:"fix import button",type:"button",visible:!1,label:"fix undeclared vars"},{name:"this binding selector",type:uc.DropDownList,visible:!1,listAlign:"top",items:[{isListItem:!0,value:"target",label:["this ",null].concat($jscomp.arrayFromIterable(Ya),[" target",null])},{isListItem:!0,value:"selection",label:["this ",null].concat($jscomp.arrayFromIterable(Ya),[" selection",null])}]}];this.ui.thisBindingSelector.listMorph.dropShadow=!0;this.ui.thisBindingSelector.listMorph.borderRadius=
3;this.ui.thisBindingSelector.whenRendered().then(function(){R.ui.thisBindingSelector.selection="target"})}},{key:"selectTarget",value:function(){var R=this,va,Ya,gb,lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){switch($b.nextAddress){case 1:if(R.env.eventDispatcher.isKeyPressed("Shift"))return Ya=$jscomp,gb=Ya.makeIterator,$b.yield($world.execCommand("select morph",{justReturn:!0}),5);R.toggleSelectionInstructions(!0);return $b.yield(uc.InteractiveMorphSelector.selectMorph(),
4);case 4:va=$b.yieldResult;R.toggleSelectionInstructions(!1);$b.jumpTo(3);break;case 5:lc=gb.call(Ya,$b.yieldResult),va=lc.next().value;case 3:va&&(R.targetObject=va),$b.jumpToEnd()}})}},{key:"toggleSelectionInstructions",value:function(R){if(R&&!this.instructionWidget){var va=uc.morph({type:"label",name:"escapeKey",value:"esc"});va.whenRendered().then(function(){return va.fit()});this.instructionWidget=this.addMorph({type:"text",opacity:0,center:this.extent.scaleBy(.5),width:120,fixedWidth:!0,lineWrapping:!0,
name:"selectionInstruction",textAndAttributes:["Select a new morph to inspect by hovering over it and clicking left. You can exit this mode by pressing ",{},va,{}]});this.instructionWidget.animate({opacity:1,duration:200})}else this.instructionWidget.fadeOut(200),this.instructionWidget=null}},{key:"closeOpenWidget",value:function(){this.openWidget.close()}},{key:"onWidgetOpened",value:function(R){R=R.widget;this.openWidget&&this.openWidget.fadeOut();this.focusedNode=this.ui.propertyTree.selectedNode;
R.epiMorph=!0;this.openWidget=R;uc.once(R,"close",this,"closeOpenWidget");uc.once(this.ui.propertyTree,"onMouseDown",this,"closeOpenWidget")}},{key:"getWidgetPosition",value:function(){var R=this.ui.propertyTree,va=R.textLayout.boundsFor(R,{column:0,row:R.selectedIndex-1});va=R.worldPoint(uc.pt(va.x,va.y+va.height/2)).addPt(R.scroll.negated());R=R.globalBounds();va.x=this.globalBounds().center().x;va.y<R.top()?va=R.topCenter():R.bottom()-20<va.y&&(va=R.bottomCenter().addXY(0,-20));return va}},{key:"repositionOpenWidget",
value:function(){this.openWidget&&this.focusedNode&&(this.openWidget.topCenter=this.getWidgetPosition())}},{key:"adjustProportions",value:function(R){this.layout.row(1).height+=R.state.dragDelta.y;this.relayout()}},{key:"isEditorVisible",value:function(){return 10<this.ui.codeEditor.height}},{key:"makeEditorVisible",value:function(R){if(R!==this.isEditorVisible()){var va=this.extent,Ya=this.layout,gb=this.ui,lc=gb.terminalToggler,$b=gb.codeEditor,Yc=gb.thisBindingSelector;gb=gb.fixImportButton;Ya.disable();
R?(lc.fontColor=uc.Color.rgbHex("00e0ff"),Ya.row(3).height=this.codeEditorHeight||180,Ya.row(2).height=5,gb.animate({visible:!0,duration:200}),Yc.animate({visible:!0,duration:200})):(this.codeEditorHeight=Ya.row(3).height,lc.fontColor=uc.Color.white,Ya.row(3).height=Ya.row(2).height=0,gb.animate({visible:!1,duration:200}),Yc.animate({visible:!1,duration:200}));this.extent=va;Ya.enable({duration:200});this.relayout({duration:200});$b.focus();$b.animate({opacity:R?1:0,duration:200})}}},{key:"toggleCodeEditor",
value:function(){var R=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(va){R.makeEditorVisible(!R.isEditorVisible());va.jumpToEnd()})}},{key:"filterProperties",value:function(){var R=this,va,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return va=R.ui.searchField,Ya=R.ui.propertyTree,R.originalTreeData||(R.originalTreeData=Ya.treeData),uc.disconnect(Ya.treeData,"onWidgetOpened",R,"onWidgetOpened"),gb.yield(Ya.treeData.filter({maxDepth:2,showUnknown:R.ui.unknowns.checked,
showInternal:R.ui.internals.checked,iterator:function(lc){return va.matches(lc.key)}}),2);Ya.update();uc.connect(Ya.treeData,"onWidgetOpened",R,"onWidgetOpened");gb.jumpToEnd()})}},{key:"relayout",value:function(R){R=void 0===R?{}:R;var va=this,Ya,gb,lc,$b,Yc,Sc,Uc,Xd,qe;return $jscomp.asyncExecutePromiseGeneratorProgram(function(tf){va.layout&&va.layout.forceLayout();Ya=va;gb=Ya.ui;lc=gb.fixImportButton;$b=gb.terminalToggler;Yc=gb.propertyTree;Sc=gb.thisBindingSelector;Uc=Yc.bounds().insetBy(5).bottomLeft();
Xd=Yc.bounds().insetBy(5).bottomRight();qe=Xd.subXY(lc.width+10,0);Sc.width=115;Sc.listMorph.itemHeight=20;R.duration?($b.animate(Object.assign({bottomLeft:Uc},R)),lc.animate(Object.assign({bottomRight:Xd},R)),Sc.animate(Object.assign({bottomRight:qe},R))):($b.bottomLeft=Uc,lc.bottomRight=Xd,Sc.bottomRight=qe);tf.jumpToEnd()})}},{key:"keybindings",get:function(){return[{keys:"Alt-Up",command:"focus propertyTree"},{keys:"Alt-Down",command:"focus codeEditor"},{keys:"F1",command:"focus propertyTree"},
{keys:"F2",command:"focus codeEditor"}].concat(zb._get(Object.getPrototypeOf(ob.prototype),"keybindings",this))}},{key:"commands",get:function(){return uc.inspectorCommands}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"Inspector"}},{key:"openInWindow",value:function(R){R=new this(R);R.openInWindow();return R}},{key:"properties",get:function(){return{extent:{defaultValue:uc.pt(400,500)},fill:{defaultValue:uc.Color.transparent},name:{defaultValue:"inspector"},_serializableTarget:{defaultValue:null},
remoteTarget:{after:["submorphs"],set:function(R){this.setProperty("remoteTarget",R);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(R,!0))}},targetObject:{after:["submorphs"],set:function(R){this._serializableTarget=R&&R.isMorph?R.id:R;this.setProperty("targetObject",R);this.ui.propertyTree&&(this.originalTreeData=null,this.prepareForNewTargetObject(R))}},originalTreeData:{serialize:!1},selectedContext:{readOnly:!0,derived:!0,get:function(){var R=this.ui.propertyTree,
va=R.selectedNode;R=R.treeData;return R.getContextFor(va?va:R.root)}},submorphs:{initialize:function(){this.build()}},ui:{readOnly:!0,derived:!0,after:["submorphs"],get:function(){return{codeEditor:this.getSubmorphNamed("codeEditor"),terminalToggler:this.getSubmorphNamed("terminal toggler"),fixImportButton:this.getSubmorphNamed("fix import button"),thisBindingSelector:this.getSubmorphNamed("this binding selector"),propertyTree:this.getSubmorphNamed("propertyTree"),unknowns:this.getSubmorphNamed("unknowns"),
internals:this.getSubmorphNamed("internals"),targetPicker:this.getSubmorphNamed("targetPicker"),searchBar:this.getSubmorphNamed("searchBar"),searchField:this.getSubmorphNamed("searchField"),resizer:this.getSubmorphNamed("resizer")}}},updateInProgress:{defaultValue:!1,serialize:!1},treeStyle:{defaultValue:{draggable:!0,borderWidth:1,borderColor:uc.Color.gray,fontSize:14,fontFamily:uc.config.codeEditor.defaultStyle.fontFamily}},master:{initialize:function(){this.master={auto:"styleguide://SystemWidgets/inspector/light"}}}}}}],
Ma,{pathInPackage:function(){return"js/inspector.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:25406,end:45571})}(uc.Morph);Zd=uc.Inspector;ie=ra("I",Zd);uc.default=Zd;var If=lively.FreezerRuntime.recorderFor("lively.ide/text/code-evaluation-commands.js");If.Inspector=ie;If.string=Wc;If.Morph=kc;If.pt=Fd;If.Color=kb;Zd=[{name:"doit",
doc:"Evaluates the selecte code or the current line and report the result",exec:function(ta,Ma,ob){ob=void 0===ob?1:ob;var R,va,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){switch(gb.nextAddress){case 1:return ta.maybeSelectCommentOrLine(),gb.setCatchFinallyBlocks(2),Ma=Object.assign({},Ma,{logDoit:!0,inspect:!0,inspectDepth:ob}),gb.yield(ta.doEval(void 0,Ma),4);case 4:R=gb.yieldResult;va=R.error?R.error:R.isError?R.value:null;gb.leaveTryBlock(3);break;case 2:va=Ya=gb.enterCatchBlock();
case 3:return va?ta.showError(va):ta.setStatusMessage(If.string.truncate(R.value,1E3)),gb.return(R)}})}},{name:"eval all",doc:"Evaluates the entire text contents",scrollCursorIntoView:!1,exec:function(ta,Ma){var ob,R,va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ya){switch(Ya.nextAddress){case 1:return Ya.setCatchFinallyBlocks(2),Ya.yield(ta.doEval({start:{row:0,column:0},end:ta.documentEndPosition},Object.assign({},Ma,{logDoit:!0})),4);case 4:ob=Ya.yieldResult;R=ob.error?ob.error:
ob.isError?ob.value:null;Ya.leaveTryBlock(3);break;case 2:R=va=Ya.enterCatchBlock();case 3:return R?ta.showError(R):ta.setStatusMessage(String(ob.value)),Ya.return(ob)}})}},{name:"printit",doc:"Evaluates selected code or the current line and inserts the result in a printed representation",exec:function(ta,Ma){var ob,R,va,Ya,gb,lc,$b,Yc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Sc){switch(Sc.nextAddress){case 1:return ta.maybeSelectCommentOrLine(),Sc.setCatchFinallyBlocks(2),Ma=Object.assign({},
Ma,{asString:!1,logDoit:!0}),Sc.yield(ta.doEval(void 0,Ma),4);case 4:ob=Sc.yieldResult;R=ob.error?ob.error:ob.isError?ob.value:null;Sc.leaveTryBlock(3);break;case 2:R=va=Sc.enterCatchBlock();case 3:ta.selection.collapseToEnd();if(Ya=ob.value&&ob.value.isColor)return ta.selection.text=String(ob.value),gb=new If.Morph({fill:If.Color.transparent,extent:If.pt(ta.fontSize+2,ta.fontSize+2),submorphs:[{fill:ob.value,center:If.pt(ta.fontSize+2,ta.fontSize+2).scaleBy(.5)}]}),lc=ta.selection.start,$b=lc.column,
Yc=lc.row,ta.insertText([gb,{}],ta.selection.start),ta.selection.start={column:$b,row:Yc},Sc.return(ob);ta.insertTextAndSelect(R?String(R)+(R.stack?"\n"+R.stack:""):String(ob.value));return Sc.return(ob)}})}},{name:"editit",doc:"Evaluates the expression and opens an object editor on the resulting object.",exec:function(ta,Ma){var ob,R,va,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){switch(gb.nextAddress){case 1:debugger;ta.maybeSelectCommentOrLine();R=ta.textInRange(ta.selection);
va=ta.evalEnvironment||{};Ya=ta.pluginFind(function(lc){return lc.isEditorPlugin&&"function"===typeof lc.runEval});va.systemInterface||(va.systemInterface=Ya.systemInterface(Ma));if("local"!==va.systemInterface.name){gb.jumpTo(2);break}gb.setCatchFinallyBlocks(3);return gb.yield(ta.doEval(void 0,Ma),5);case 5:ob=gb.yieldResult;R=ob.value;gb.leaveTryBlock(2);break;case 3:gb.enterCatchBlock();case 2:return ta.world().execCommand("open object editor",{target:R,evalEnvironment:va}),gb.return(ob)}})}},
{name:"inspectit",doc:"Evaluates the expression and opens an inspector widget on the resulting object.",exec:function(ta,Ma){var ob,R,va,Ya,gb,lc;return $jscomp.asyncExecutePromiseGeneratorProgram(function($b){switch($b.nextAddress){case 1:ta.maybeSelectCommentOrLine();va=ta.textInRange(ta.selection);Ya=ta.evalEnvironment||{};gb=ta.pluginFind(function(Yc){return Yc.isEditorPlugin&&"function"===typeof Yc.runEval});Ya.systemInterface||(Ya.systemInterface=gb.systemInterface(Ma));if("local"!==Ya.systemInterface.name){If.Inspector.openInWindow({remoteTarget:{code:va,
evalEnvironment:Ya}});$b.jumpTo(2);break}$b.setCatchFinallyBlocks(3);return $b.yield(ta.doEval(void 0,Ma),5);case 5:ob=$b.yieldResult;R=ob.error?ob.error:ob.isError?ob.value:null;va=ob.value;$b.leaveTryBlock(4);break;case 3:R=lc=$b.enterCatchBlock();case 4:If.Inspector.openInWindow({targetObject:R?R:va});case 2:return $b.return(ob)}})}},{name:"print inspectit",doc:"Prints a representation of the object showing it's properties. The count argument defines how deep (recursively) objects will be printed.",
handlesCount:!0,exec:function(ta,Ma,ob){ob=void 0===ob?1:ob;var R;return $jscomp.asyncExecutePromiseGeneratorProgram(function(va){switch(va.nextAddress){case 1:return ta.maybeSelectCommentOrLine(),va.setCatchFinallyBlocks(2),Ma=Object.assign({},Ma,{inspect:!0,inspectDepth:ob,logDoit:!0}),va.yield(ta.doEval(void 0,Ma),4);case 4:R=va.yieldResult;va.leaveTryBlock(3);break;case 2:va.enterCatchBlock();case 3:return ta.selection.collapseToEnd(),ta.insertTextAndSelect(R.value),va.return(R)}})}}];If.codeEvaluationCommands=
Zd;If.codeEvaluationCommands=Zd;If.codeEvaluationCommands=Zd;var Jf=lively.FreezerRuntime.recorderFor("lively.ide/text/rich-text-commands.js");Jf.changeAttributeInSelectionOrMorph=function(ta,Ma,ob){var R=ta.selection;ta.keepPosAtSameScrollOffsetWhile(function(){R.isEmpty()?ta[Ma]="function"===typeof ob?ob(ta[Ma]):ob:(ta.undoManager.group(),ta.changeStyleProperty(Ma,function(va){return"function"===typeof ob?ob(va):ob}),ta.undoManager.group())})};ie=[{name:"increase font size",scrollCursorIntoView:!1,
exec:function(ta){var Ma=ta.fontSize;Jf.changeAttributeInSelectionOrMorph(ta,"fontSize",function(ob){ob=ob||Ma;return ob+(18<=ob?2:1)});return!0}},{name:"decrease font size",scrollCursorIntoView:!1,exec:function(ta){var Ma=ta.fontSize;Jf.changeAttributeInSelectionOrMorph(ta,"fontSize",function(ob){ob=ob||Ma;return ob-(18>=ob?1:2)});return!0}},{name:"change font",scrollCursorIntoView:!1,exec:function(ta){var Ma,ob,R,va,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress){Ma=
["serif","sans-serif","monospace"];if(ob=localStorage["lively.morpic/text-change-font-additional-fonts"])ob=JSON.parse(ob),Ma.push.apply(Ma,$jscomp.arrayFromIterable(ob));Ma.map(function(lc){return lc.toLowerCase()}).includes(ta.fontFamily.toLowerCase())||(Ma.push(ta.fontFamily),ob=[].concat($jscomp.arrayFromIterable(ob||[]),[ta.fontFamily]),localStorage["lively.morpic/text-change-font-additional-fonts"]=JSON.stringify(ob));return gb.yield($world.editListPrompt("choose font",Ma,{requester:ta,preselect:Ma.indexOf(ta.fontFamily),
historyId:"lively.morpic/text-change-font-hist"}),2)}R=gb.yieldResult;va=$jscomp.makeIterator(R.selections);if(Ya=va.next().value)ta.fontFamily=Ya;return gb.return(!0)})}},{name:"set link of selection",scrollCursorIntoView:!1,exec:function(ta,Ma){Ma=void 0===Ma?{}:Ma;var ob,R,va,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress){if(Ma.hasOwnProperty("link"))return gb.jumpTo(2);R=ta.selection;va=ta.getStyleInRange(R);Ya=va.link;return gb.yield(ta.world().prompt("Set link",
{input:Ya||"https://",historyId:"lively.morphic-rich-text-link-hist"}),3)}if(2!=gb.nextAddress&&(ob=gb.yieldResult,!ob))return gb.return();ta.undoManager.group();ta.setStyleInRange({link:ob||void 0},R);ta.undoManager.group();gb.jumpToEnd()})}},{name:"set doit of selection",scrollCursorIntoView:!1,exec:function(ta,Ma){var ob,R,va,Ya;return $jscomp.asyncExecutePromiseGeneratorProgram(function(gb){if(1==gb.nextAddress)return ob=ta.selection,R=ta.getStyleInRange(ob),va=R.doit,gb.yield(ta.world().editPrompt("Enter doit code (runs on clicking the text)",
{requester:ta,input:va?va.code:"// empty doit",historyId:"lively.morphic-rich-text-doit-hist",mode:"js",evalEnvironment:ta.evalEnvForDoit(va||{})}),2);Ya=gb.yieldResult;ta.undoManager.group();Ya?ta.addTextAttribute({doit:{code:Ya},nativeCursor:"pointer",textDecoration:"underline"},ob):ta.removeTextAttribute({doit:null,nativeCursor:"",textDecoration:""},ob);ta.undoManager.group();gb.jumpToEnd()})}},{name:"reset text style",scrollCursorIntoView:!1,exec:function(ta,Ma){Ma=void 0===Ma?{}:Ma;ta.undoManager.group();
Ma=!Ma.onlySelection&&ta.selection.isEmpty()?ta.documentRange:ta.selection.range;ta.setStyleInRange(null,Ma);ta.undoManager.group();return!0}},{name:"open text attribute controls",exec:function(ta){var Ma,ob,R,va;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ya){if(1==Ya.nextAddress)return Ya.yield(System.import("lively.modules"),2);if(3!=Ya.nextAddress)return Ma=Ya.yieldResult,ob=Ma.module,Ya.yield(ob("lively.ide/text/ui.js").load(),3);R=Ya.yieldResult;va=R.RichTextControl;return Ya.return(va.openFor(ta))})}}];
Jf.commands=ie;Jf.commands=ie;Jf.commands=ie;var De=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js");De.guessTextModeName=Fb;De.rangedToken=function(ta,Ma,ob,R,va){return{start:{row:ta,column:Ma},end:{row:ta,column:ob},token:R,mode:va}};De.fun=rc;De.arr=Sb;De.connect=Fc;De.disconnect=vb;De.DefaultTheme=tb;De.tokenizeDocument=Va;De.modeInfo=la;De.visitDocumentTokens=Oc;De.getMode=ac;De.completionCommands=ja;De.multiSelectCommands=jc;De.navCommands=Cd;De.codeCommands=we;De.codeEvaluationCommands=
Zd;De.richTextCommands=ie;De.Color=kb;De.Range=Id;De.guessTextModeName=Fb;De.guessTextModeName=Fb;tb=function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),ob=Ma.hasOwnProperty("EditorPlugin")&&"function"===typeof Ma.EditorPlugin?Ma.EditorPlugin:Ma.EditorPlugin=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:Symbol.for("lively-instance-initialize"),value:function(){this.theme=
De.DefaultTheme.instance;this._ast=this.checker=null;this._tokens=[];this._tokenizerValidBefore=null;this.__dont_serialize__=["mode","_ast","_tokens","_tokenizerValidBefore"]}},{key:"isEditorPlugin",get:function(){return!0}},{key:"shortName",get:function(){return null}},{key:"longName",get:function(){return this.shortName}},{key:"attach",value:function(R){var va=this;this.textMorph=R;De.connect(R,"textChange",this,"onTextChange");De.connect(R,"viewChange",this,"onViewChange");this.textMorph.whenRendered().then(function(){return va.highlight()})}},
{key:"detach",value:function(R){De.disconnect(R,"textChange",this,"onTextChange");De.disconnect(R,"viewChange",this,"onViewChange");this.textMorph=null}},{key:"onViewChange",value:function(){this.requestHighlight()}},{key:"onTextChange",value:function(R){this._ast=null;if(R){var va=this._tokenizerValidBefore;if("replace"===R.selector){var Ya=R.args[0].start;R=Ya.row;Ya=Ya.column}else Ya=R=0;if(!va||R<va.row||R===va.row&&Ya<va.column)R=Math.max(0,R),this._tokenizerValidBefore={row:R,column:Ya}}this.requestHighlight()}},
{key:"requestHighlight",value:function(R){var va=this;(void 0===R?0:R)?this.highlight():De.fun.debounceNamed(this.id+"-requestHighlight",300,function(){return va.highlight()})()}},{key:"highlight",value:function(){var R=this.textMorph,va=this.theme,Ya=this.mode,gb=this._tokenizerValidBefore;if(va&&R&&R.document&&Ya){R.fill=va.background;R.cursorColor=va.cursorColor||De.Color.black;var lc=R.viewState,$b={};gb=De.tokenizeDocument(Ya,R.document,lc.firstVisibleRow,lc.lastVisibleRow,gb);Ya=gb.lines;gb=
gb.tokens;if(Ya.length){lc=Ya[0].row;for(var Yc=[],Sc=0;Sc<gb.length;lc++,Sc++)for(var Uc=gb[Sc],Xd=0;Xd<Uc.length;Xd+=5){var qe=Uc[Xd],tf=Uc[Xd+1],Ag=va[Uc[Xd+2]]||va.default;Ag&&Yc.push({start:{row:lc,column:qe},end:{row:lc,column:tf}},Ag)}R.embeddedMorphs.forEach(function(yh){var Lg=R.embeddedMorphMap.get(yh).anchor;$b[yh.id]=R.textAttributeAt(Lg.position)});R.setTextAttributesWithSortedRanges(Yc);R.embeddedMorphs.forEach(function(yh){var Lg=R.embeddedMorphMap.get(yh).anchor;Lg=De.Range.at(Lg.position);
Lg.end.column+=1;R.replace(Lg,[yh,$b[yh.id]],!1)});this._tokenizerValidBefore={row:De.arr.last(Ya).row+1,column:0}}if(this.checker)this.checker.onDocumentChange({},R,this)}}},{key:"visitTokensInRange",value:function(R,va){var Ya=R.start,gb=R.end,lc=Ya.row-1;De.visitDocumentTokens(this.mode,this.textMorph.document,Ya.row,gb.row,null,function($b){return lc++},function($b,Yc,Sc,Uc,Xd,qe,tf){if(lc===Ya.row&&0<Ya.column){if(Ya.column>=Uc)return;Sc<Ya.column&&Ya.column<Uc&&(Sc=Ya.column)}if(lc===gb.row){if(gb.column<=
Sc)return;Sc<gb.column&&gb.column<Uc&&(Uc=gb.column)}va($b,Yc,lc,Sc,Uc,Xd,qe,tf)})}},{key:"tokensInRange",value:function(R){var va=[];this.visitTokensInRange(R,function(Ya,gb,lc,$b,Yc,Sc,Uc,Xd){return va.push(De.rangedToken(lc,$b,Yc,Ya,Xd))});return va}},{key:"tokensOfRow",value:function(R){var va=this.textMorph.getLine(R).length;return this.tokensInRange({start:{row:R,column:0},end:{row:R,column:va}})}},{key:"tokenAt",value:function(R){for(var va=this.tokensOfRow(R.row),Ya=va.length;Ya--;){var gb=
va[Ya];if(gb.token&&gb.start.column<=R.column&&R.column<=gb.end.column)return gb}return null}},{key:"getCommands",value:function(R){return[].concat($jscomp.arrayFromIterable(R),$jscomp.arrayFromIterable(De.completionCommands),$jscomp.arrayFromIterable(De.multiSelectCommands),$jscomp.arrayFromIterable(De.navCommands),$jscomp.arrayFromIterable(De.codeCommands),$jscomp.arrayFromIterable(De.codeEvaluationCommands),$jscomp.arrayFromIterable(De.richTextCommands))}},{key:"getComment",value:function(){if(!this.mode)return null;
var R=this.mode,va=R.lineComment,Ya=R.blockCommentStart;R=R.blockCommentEnd;var gb={};va&&(gb.lineCommentStart=va);Ya&&(gb.blockCommentStart=Ya);R&&(gb.blockCommentEnd=R);return gb}},{key:"toString",value:function(){return this.constructor.name+"("+this.textMorph+")"}},{key:"cmd_newline",value:function(R,va,Ya){var gb=this.textMorph,lc=R.row,$b=R.column;R=va[$b-1];va=va[$b];gb.selection.text="\n";gb.selection.collapseToEnd();"{"===R&&"}"===va&&(gb.selection.text="\n"+" ".repeat(Ya),gb.selection.collapse());
gb.execCommand("indent according to mode",{undo:!1,ignoreFollowingText:!1,firstRow:lc+1,lastRow:lc+1});return!0}},{key:"openPairs",get:function(){return{"{":"}","[":"]","(":")",'"':'"',"'":"'","`":"`"}}},{key:"closePairs",get:function(){return{"}":"{","]":"[",")":"(",'"':'"',"'":"'","`":"`"}}},{key:"cmd_delete_backwards",value:function(){var R=this.textMorph,va=this.openPairs,Ya=R.selection,gb=R.getLine(Ya.end.row),lc=gb[Ya.end.column-1];gb=gb[Ya.end.column];R.autoInsertPairs&&Ya.isEmpty()&&lc in
va&&gb===va[lc]&&(Ya.growRight(1),Ya.growLeft(1));return!1}},{key:"cmd_insertstring",value:function(R){var va=this.openPairs,Ya=this.closePairs,gb=this.textMorph,lc=gb.selection,$b=gb.autoInsertPairs&&R in va,Yc=gb.autoInsertPairs&&R in Ya;if(!$b&&!Yc)return!1;var Sc=gb.getLine(lc.end.row)[lc.end.column];if(!lc.isEmpty()){if(!$b)return!1;Ya=gb.undoManager.ensureNewGroup(gb);gb.insertText(va[R],lc.end);gb.insertText(R,lc.start);gb.undoManager.group(Ya);lc.growRight(-1);return!0}if(Sc in Ya&&R===Sc)return lc.goRight(1),
!0;if(Yc&&!$b)return!1;Ya=gb.undoManager.ensureNewGroup(gb);gb.insertText(R+va[R]);gb.undoManager.group(Ya);lc.goLeft(1);return!0}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"EditorPlugin"}}],Ma,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:3088,end:11936})}(void 0);
la=tb=De.EditorPlugin;ja=ra("C",function(ta){var Ma=lively.FreezerRuntime.recorderFor("lively.ide/editor-plugin.js"),ob=Ma.hasOwnProperty("CodeMirrorEnabledEditorPlugin")&&"function"===typeof Ma.CodeMirrorEnabledEditorPlugin?Ma.CodeMirrorEnabledEditorPlugin:Ma.CodeMirrorEnabledEditorPlugin=function(R){R&&R[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return zb(ob,ta,[{key:Symbol.for("lively-instance-initialize"),value:function(){zb._get(Object.getPrototypeOf(ob.prototype),
Symbol.for("lively-instance-initialize"),this).call(this);this.mode=null}},{key:"attach",value:function(R){this.mode=this.codeMirrorMode(R);return zb._get(Object.getPrototypeOf(ob.prototype),"attach",this).call(this,R)}},{key:"__deserialize__",value:function(){this.mode=this.textMorph?this.codeMirrorMode(this.textMorph):null}},{key:"defaultCodeMirrorModeConfig",value:function(R){return{indentWithTabs:!R.useSoftTabs,indentUnit:R.tabWidth,tabSize:4}}},{key:"codeMirrorMode",value:function(R){R=this.defaultCodeMirrorModeConfig(R);
return De.getMode(R,{name:this.longName})}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"CodeMirrorEnabledEditorPlugin"}}],Ma,{pathInPackage:function(){return"editor-plugin.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"lively.ide",version:"0.1.0"}}},{start:11945,end:12633})}(De.EditorPlugin));De.CodeMirrorEnabledEditorPlugin=ja;De.CodeMirrorEnabledEditorPlugin=
ja;De.CodeMirrorEnabledEditorPlugin=ja;De.default=tb;tb=Object.freeze({__proto__:null,guessTextModeName:Fb,"default":la,CodeMirrorEnabledEditorPlugin:ja});ra("e",tb)}}});
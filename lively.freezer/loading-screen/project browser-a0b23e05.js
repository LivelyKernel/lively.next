System.register(["./__root_module__-89b08ab2.js","kld-intersections","./index-08f1886d.js","./index-4f78f9ac.js","./user-ui-281b954b.js"],function(ta,nb){var xb,Ob,Hb,qd,Dc,hd,Hc,Fc,Sc,ad,Jd,ed,sc,Sa,ob,$b,Sb,Bc,id;return{setters:[function(Xb){xb=Xb.aj;Ob=Xb.aC;Hb=Xb.al;qd=Xb.ao;Dc=Xb.Z;hd=Xb.a6;Hc=Xb.au;Fc=Xb.s;Sc=Xb.C;ad=Xb.a3;Jd=Xb.r;ed=Xb.at;sc=Xb.aB;Sa=Xb.a$;ob=Xb.b0;$b=Xb.ar;Sb=Xb.aY;Bc=Xb.aX},function(){},function(){},function(){},function(Xb){id=Xb.UserUI}],execute:function(){var Xb=
lively.FreezerRuntime.recorderFor("WorldDashboard/index.js");Xb.Morph=xb;Xb.HorizontalLayout=Ob;Xb.VerticalLayout=Hb;Xb.morph=qd;Xb.MorphicDB=Dc;Xb.arr=hd;Xb.fun=Hc;Xb.string=Fc;Xb.Color=Sc;Xb.pt=ad;Xb.UserUI=id;Xb.resource=Jd;var Ub=function(wc){var bd=lively.FreezerRuntime.recorderFor("WorldDashboard/index.js"),cd=bd.hasOwnProperty("WorldDashboard")&&"function"===typeof bd.WorldDashboard?bd.WorldDashboard:bd.WorldDashboard=function(bb){bb&&bb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,
arguments)};return ed(cd,wc,[{key:"focus",value:function(){this.ui.searchField.focus()}},{key:"update",value:function(){this.displayWorlds()}},{key:"beforePublish",value:function(){this.reset()}},{key:"reset",value:function(){this.ui.worldList.items=[];this.ui.noWorldWarning.visible=!1}},{key:"relayout",value:function(){this.alignInWorld()}},{key:"alignInWorld",value:function(bb){bb=void 0===bb?$world:bb;this.owner!=bb&&bb.addMorph(this);this.center=bb.visibleBounds().center()}},{key:"sortAndFilterPreviews",
value:function(bb){var pb=Xb.UserUI.getCurrentUser();bb=this.ui.searchField.fuzzyFilter(bb,function(pc){return pc._commit.name+pc._commit.description});switch(this.ui.sortSelector.selection){case "RECENT":return Xb.arr.sortBy(bb,function(pc){return-pc._commit.timestamp});case "TEMPLATES":return bb;case "MY PROJECTS":return Xb.arr.filter(bb,function(pc){return pc._commit.author.name===pb.name});case "PUBLISHED":return bb}}},{key:"updateList",value:function(){var bb=this;this.previews&&Xb.fun.debounceNamed("update world list",
150,function(){bb.ui.worldList.items=bb.sortAndFilterPreviews(bb.previews)})()}},{key:"displayWorlds",value:function(){var bb=this,pb,pc,ab,cb,Pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Za){switch(Za.nextAddress){case 1:return bb.reset(),pb=bb.ui,pc=pb.loadingLabel,pc.animate({opacity:1,duration:300}),Za.yield(bb.db.latestCommits("world"),2);case 2:return ab=Za.yieldResult,Za.yield(nb.import("./world preview-832bf671.js"),4);case 4:if(!(cb=Za.yieldResult)){Za.jumpTo(5);break}return Za.yield(Xb.resource("part://partial freezing/world preview"),
6);case 6:cb=Za.yieldResult;case 5:return Za.yield(cb.read(),3);case 3:return Pa=Za.yieldResult,bb.previews=ab.map(function(eb){var Na=Xb.morph({reactsToPointer:!1,fill:Xb.Color.transparent,extent:Pa.extent});Na._commit=eb;Na.displayPreview=function(){var Da;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mb){if(1==mb.nextAddress)return Da=Pa.copy(),Da._commit=eb,Da.opacity=0,Na.addMorph(Da),Da.displayPreview(),Da.position=Xb.pt(0,0),mb.yield(Na.whenRendered(),2);Na.layout=new Xb.HorizontalLayout({autoResize:!0,
reactToSubmorphAnimations:!0});mb.jumpToEnd()})};return Na}),Za.yield(pc.animate({opacity:0,duration:300}),7);case 7:bb.updateList(),0==ab.length&&(bb.ui.noWorldWarning.center=bb.innerBounds().center(),bb.ui.noWorldWarning.animate({visible:!0,duration:300})),Za.jumpToEnd()}})}},{key:"createNewProject",value:function(){document.location="/worlds/load?name=__newWorld__"}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"WorldDashboard"}},{key:"properties",get:function(){return{showCloseButton:{derived:!0,
get:function(){return this.ui.closeButton.visible},set:function(bb){this.ui.closeButton.visible=bb}},db:{serialize:!1,get:function(){return Xb.MorphicDB.default}},ui:{derived:!0,get:function(){return{worldList:this.getSubmorphNamed("world list"),sortSelector:this.getSubmorphNamed("search selector"),searchField:this.getSubmorphNamed("search field"),closeButton:this.getSubmorphNamed("close button"),loadingLabel:this.getSubmorphNamed("loading label"),noWorldWarning:this.getSubmorphNamed("no world warning")}}}}}}],
bd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"WorldDashboard",version:"0.1.1-127"}}},{start:330,end:3954})}(Xb.Morph);Ub=Xb.WorldDashboard;Xb.default=Ub;var ub=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js");ub.Morph=xb;ub.touchInputDevice=sc;ub.TilingLayout=Sa;ub.arr=hd;ub.pt=ad;Ub=function(wc){var bd=lively.FreezerRuntime.recorderFor("GrowingWorldList/index.js"),
cd=bd.hasOwnProperty("GrowingWorldList")&&"function"===typeof bd.GrowingWorldList?bd.GrowingWorldList:bd.GrowingWorldList=function(bb){bb&&bb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ed(cd,wc,[{key:"onLoad",value:function(){this.clipMode="auto"}},{key:"onScroll",value:function(bb){ed._get(Object.getPrototypeOf(cd.prototype),"onScroll",this).call(this,bb);this.update()}},{key:"onChange",value:function(bb){ed._get(Object.getPrototypeOf(cd.prototype),
"onChange",this).call(this,bb);"extent"==bb.prop&&this.update(!0)}},{key:"onHoverIn",value:function(bb){this.clipMode="auto"}},{key:"onHoverOut",value:function(bb){ub.touchInputDevice||(this.clipMode="hidden")}},{key:"update",value:function(bb){var pb=this.items;if(pb&&0!=pb.length){var pc=this.scrollContainer,ab=pc.layout.spacing;pc.extent=this.extent;var cb=this.ui,Pa=cb.bufferTop;cb=cb.bufferBottom;Pa=Pa||pc.addMorph({fill:null,name:"buffer top",height:10});cb=cb||pc.addMorph({fill:null,name:"buffer bottom",
height:10});Pa.width=cb.width=this.width-100;pc.layout.disable();var Za=pb[0];ab=pb.slice(0,Math.floor(this.width/(Za.width+ab))*(Math.ceil((this.scroll.y+this.height)/(Za.height+ab))+1)).filter(function(mb){return mb.owner!=pc});Za=this.scroll.y+2*this.height;for(var eb={},Na=$jscomp.makeIterator(ab),Da=Na.next();!Da.done;eb={$jscomp$loop$prop$item$2415:eb.$jscomp$loop$prop$item$2415},Da=Na.next())eb.$jscomp$loop$prop$item$2415=Da.value,Za++,eb.$jscomp$loop$prop$item$2415.top=Za,pc.addMorph(eb.$jscomp$loop$prop$item$2415),
eb.$jscomp$loop$prop$item$2415._initialized||eb.$jscomp$loop$prop$item$2415.whenRendered().then(function(mb){return function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(Zb){mb.$jscomp$loop$prop$item$2415._initialized=!0;return Zb.yield(mb.$jscomp$loop$prop$item$2415.displayPreview(),0)})}}(eb));bb&&(Pa.position=ub.pt(0,0),pb.forEach(function(mb,Zb){return mb.position=ub.pt(Zb+1,Zb+1)}),cb.position=ub.pt(pb.length+2,pb.length+2));pc.layout.enable();if(bb||0<ab.length)cb.top=this.submorphBounds().height,
pc.layout.apply()}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"GrowingWorldList"}},{key:"properties",get:function(){return{scrollContainer:{get:function(){return this.getSubmorphNamed("scroll container")||this.addMorph({name:"scroll container",fill:null,reactsToPointer:!1,renderOnGPU:!0,layout:new ub.TilingLayout({spacing:25,align:"center",autoResize:!0})})}},ui:{get:function(){return{bufferTop:this.getSubmorphNamed("buffer top"),bufferBottom:this.getSubmorphNamed("buffer bottom")}}},
items:{after:["layout","scrollContainer"],set:function(bb){this.setProperty("items",bb);var pb=this.scrollContainer;pb.layout&&pb.layout.disable();var pc=this.ui,ab=pc.bufferTop;pc=pc.bufferBottom;ub.arr.withoutAll(pb.submorphs,[].concat($jscomp.arrayFromIterable(bb),[ab,pc])).forEach(function(cb){return cb.remove()});this.update(!0)}}}}}],bd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},
package:function(){return{name:"GrowingWorldList",version:"0.1.1-32"}}},{start:179,end:3777})}(ub.Morph);Ub=ub.GrowingWorldList;ub.default=Ub;var hc=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js");hc.InputLine=ob;hc.Color=Sc;hc.connect=$b;hc.disconnectAll=Sb;hc.disconnect=Bc;hc.arr=hd;hc.string=Fc;Ub=function(wc){var bd=lively.FreezerRuntime.recorderFor("SearchInputLine/index.js"),cd=bd.hasOwnProperty("SearchInputLine")&&"function"===typeof bd.SearchInputLine?bd.SearchInputLine:bd.SearchInputLine=
function(bb){bb&&bb[Symbol.for("lively-instance-restorer")]||this[Symbol.for("lively-instance-initialize")].apply(this,arguments)};return ed(cd,wc,[{key:"fuzzyMatch",value:function(bb,pb){pb=void 0===pb?this.parseInput():pb;if(pb.lowercasedTokens.every(function(ab){return bb.toLowerCase().includes(ab)}))return!0;var pc=bb.toLowerCase();return 3>=hc.arr.sum(pb.lowercasedTokens.map(function(ab){return hc.string.levenshtein(pc,ab)}))}},{key:"fuzzyFilter",value:function(bb,pb){var pc=this;pb=void 0===
pb?function(cb){return cb}:pb;var ab=this.parseInput();return hc.arr.filter(bb,function(cb){return pc.fuzzyMatch(pb(cb),ab)})}},{key:"parseInput",value:function(){var bb=Array.from(this.textString).reduce(function(pc,ab){if("\\"===ab&&!pc.escaped)return pc.escaped=!0,pc;" "!==ab||pc.escaped?(pc.spaceSeen=!1,pc.current+=ab):(!pc.spaceSeen&&pc.current&&(pc.tokens.push(pc.current),pc.current=""),pc.spaceSeen=!0);pc.escaped=!1;return pc},{tokens:[],current:"",escaped:!1,spaceSeen:!1});bb.current&&bb.tokens.push(bb.current);
var pb=bb.tokens.map(function(pc){return pc.toLowerCase()});return{tokens:bb.tokens,lowercasedTokens:pb}}}],[{key:Symbol.for("__LivelyClassName__"),get:function(){return"SearchInputLine"}}],bd,{pathInPackage:function(){return"index.js"},unsubscribeFromToplevelDefinitionChanges:function(){return function(){}},subscribeToToplevelDefinitionChanges:function(){return function(){}},package:function(){return{name:"SearchInputLine",version:"0.1.1-4"}}},{start:239,end:1834})}(hc.InputLine);Ub=hc.SearchInputLine;
hc.default=Ub}}});
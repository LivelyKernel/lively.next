System.register(["./__root_module__-89b08ab2.js","kld-intersections"],function(ta){var nb,xb,Ob,Hb,qd,Dc,hd,Hc;return{setters:[function(Fc){nb=Fc.s;xb=Fc.$;Ob=Fc.bl;Hb=Fc.bm;qd=Fc.au;Dc=Fc.a7;hd=Fc.bn;Hc=Fc.aq},function(){}],execute:function(){function Fc(J,V){var pa={};V.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(db,Db,vc){Db&&(pa[Db]=vc)});return pa}function Sc(J){J=String(J);if(!(100<J.length)&&(J=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(J))){var V=
parseFloat(J[1]);switch((J[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return V*qc;case "days":case "day":case "d":return V*Vd;case "hours":case "hour":case "hrs":case "hr":case "h":return 36E5*V;case "minutes":case "minute":case "mins":case "min":case "m":return 6E4*V;case "seconds":case "second":case "secs":case "sec":case "s":return 1E3*V;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return V}}}function ad(J,V,pa){if(!(J<V))return J<
1.5*V?Math.floor(J/V)+" "+pa:Math.ceil(J/V)+" "+pa+"s"}function Jd(J){var V=0,pa;for(pa in J)V=(V<<5)-V+J.charCodeAt(pa),V|=0;return kb.colors[Math.abs(V)%kb.colors.length]}function ed(J){function V(){if(V.enabled){var db=+new Date;V.diff=db-(pa||db);V.prev=pa;pa=V.curr=db;var Db=Array(arguments.length);for(db=0;db<Db.length;db++)Db[db]=arguments[db];Db[0]=kb.coerce(Db[0]);"string"!==typeof Db[0]&&Db.unshift("%O");var vc=0;Db[0]=Db[0].replace(/%([a-zA-Z%])/g,function(od,ud){if("%%"===od)return od;
vc++;ud=kb.formatters[ud];"function"===typeof ud&&(od=ud.call(V,Db[vc]),Db.splice(vc,1),vc--);return od});kb.formatArgs.call(V,Db);(V.log||kb.log||console.log.bind(console)).apply(V,Db)}}var pa;V.namespace=J;V.enabled=kb.enabled(J);V.useColors=kb.useColors();V.color=Jd(J);V.destroy=sc;"function"===typeof kb.init&&kb.init(V);kb.instances.push(V);return V}function sc(){var J=kb.instances.indexOf(this||Lc);return-1!==J?(kb.instances.splice(J,1),!0):!1}function Sa(){try{var J=oa.storage.debug}catch(V){}!J&&
"undefined"!==typeof tb&&"env"in tb&&(J=tb.env.DEBUG);return J}function ob(J){if(J){for(var V in ob.prototype)J[V]=ob.prototype[V];return J}}function $b(J,V){if(!J)return J;if(qf(J)){var pa={_placeholder:!0,num:V.length};V.push(J);return pa}if(we(J)){pa=Array(J.length);for(var db=0;db<J.length;db++)pa[db]=$b(J[db],V);return pa}if("object"===typeof J&&!(J instanceof Date)){pa={};for(db in J)pa[db]=$b(J[db],V);return pa}return J}function Sb(J,V){if(!J)return J;if(J&&J._placeholder)return V[J.num];if(we(J))for(var pa=
0;pa<J.length;pa++)J[pa]=Sb(J[pa],V);else if("object"===typeof J)for(pa in J)J[pa]=Sb(J[pa],V);return J}function Bc(){}function id(J){var V=""+J.type;if(ib.BINARY_EVENT===J.type||ib.BINARY_ACK===J.type)V+=J.attachments+"-";J.nsp&&"/"!==J.nsp&&(V+=J.nsp+",");null!=J.id&&(V+=J.id);if(null!=J.data){try{var pa=JSON.stringify(J.data)}catch(db){pa=!1}if(!1!==pa)V+=pa;else return Ya}S("encoded %j as %s",J,V);return V}function Xb(J,V){ua.removeBlobs(J,function(pa){var db=ua.deconstructPacket(pa);pa=id(db.packet);
db=db.buffers;db.unshift(pa);V(db)})}function Ub(){(this||La).reconstructor=null}function ub(J){(this||La).reconPack=J;(this||La).buffers=[]}function hc(J){if(!J||"object"!==typeof J)return!1;if(ef(J)){for(var V=0,pa=J.length;V<pa;V++)if(hc(J[V]))return!0;return!1}if("function"===typeof zf&&zf.isBuffer&&zf.isBuffer(J)||"function"===typeof ArrayBuffer&&J instanceof ArrayBuffer||dh&&J instanceof Blob||Cg&&J instanceof File)return!0;if(J.toJSON&&"function"===typeof J.toJSON&&1===arguments.length)return hc(J.toJSON(),
!0);for(V in J)if(Object.prototype.hasOwnProperty.call(J,V)&&hc(J[V]))return!0;return!1}function wc(){}function bd(J){return J.map(function(V){if(V.buffer instanceof ArrayBuffer){var pa=V.buffer;if(V.byteLength!==pa.byteLength){var db=new Uint8Array(V.byteLength);db.set(new Uint8Array(pa,V.byteOffset,V.byteLength));pa=db.buffer}return pa}return V})}function cd(J,V){V=V||{};var pa=new Vh;bd(J).forEach(function(db){pa.append(db)});return V.type?pa.getBlob(V.type):pa.getBlob()}function bb(J,V){return new Blob(bd(J),
V||{})}function pb(J){for(var V=[],pa=0,db=J.length,Db,vc;pa<db;)Db=J.charCodeAt(pa++),55296<=Db&&56319>=Db&&pa<db?(vc=J.charCodeAt(pa++),56320==(vc&64512)?V.push(((Db&1023)<<10)+(vc&1023)+65536):(V.push(Db),pa--)):V.push(Db);return V}function pc(J,V){if(55296<=J&&57343>=J){if(V)throw Error("Lone surrogate U+"+J.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function ab(){if(Md>=Qc)throw Error("Invalid byte index");var J=Bb[Md]&255;Md++;if(128==(J&192))return J&63;throw Error("Invalid continuation byte");
}function cb(J){if(Md>Qc)throw Error("Invalid byte index");if(Md==Qc)return!1;var V=Bb[Md]&255;Md++;if(0==(V&128))return V;if(192==(V&224)){var pa=ab();V=(V&31)<<6|pa;if(128<=V)return V;throw Error("Invalid continuation byte");}if(224==(V&240)){pa=ab();var db=ab();V=(V&15)<<12|pa<<6|db;if(2048<=V)return pc(V,J)?V:65533;throw Error("Invalid continuation byte");}if(240==(V&248)&&(pa=ab(),db=ab(),J=ab(),V=(V&7)<<18|pa<<12|db<<6|J,65536<=V&&1114111>=V))return V;throw Error("Invalid UTF-8 detected");}
function Pa(J,V,pa){if(!V)return Rb.encodeBase64Packet(J,pa);var db=new FileReader;db.onload=function(){Rb.encodePacket({type:J.type,data:db.result},V,!0,pa)};return db.readAsArrayBuffer(J.data)}function Za(J,V,pa){var db=Array(J.length);pa=wf(J.length,pa);for(var Db=function(od,ud,Od){V(ud,function(He,jf){db[od]=jf;Od(He,db)})},vc=0;vc<J.length;vc++)Db(vc,J[vc],pa)}function eb(J){var V="";do V=nn[J%64]+V,J=Math.floor(J/64);while(0<J);return V}function Na(){var J=eb(+new Date);return J!==Fm?(sk=0,
Fm=J):J+"."+eb(sk++)}function Da(J){(this||Af).path=J.path;(this||Af).hostname=J.hostname;(this||Af).port=J.port;(this||Af).secure=J.secure;(this||Af).query=J.query;(this||Af).timestampParam=J.timestampParam;(this||Af).timestampRequests=J.timestampRequests;(this||Af).readyState="";(this||Af).agent=J.agent||!1;(this||Af).socket=J.socket;(this||Af).enablesXDR=J.enablesXDR;(this||Af).withCredentials=J.withCredentials;(this||Af).pfx=J.pfx;(this||Af).key=J.key;(this||Af).passphrase=J.passphrase;(this||
Af).cert=J.cert;(this||Af).ca=J.ca;(this||Af).ciphers=J.ciphers;(this||Af).rejectUnauthorized=J.rejectUnauthorized;(this||Af).forceNode=J.forceNode;(this||Af).isReactNative=J.isReactNative;(this||Af).extraHeaders=J.extraHeaders;(this||Af).localAddress=J.localAddress}function mb(J){var V=J&&J.forceBase64;if(!Jk||V)(this||Dg).supportsBinary=!1;vg.call(this||Dg,J)}function Zb(){}function dc(J){Wm.call(this||le,J);(this||le).requestTimeout=J.requestTimeout;(this||le).extraHeaders=J.extraHeaders;if("undefined"!==
typeof location){var V="https:"===location.protocol,pa=location.port;pa||(pa=V?443:80);(this||le).xd="undefined"!==typeof location&&J.hostname!==location.hostname||pa!==J.port;(this||le).xs=J.secure!==V}}function Mb(J){(this||le).method=J.method||"GET";(this||le).uri=J.uri;(this||le).xd=!!J.xd;(this||le).xs=!!J.xs;(this||le).async=!1!==J.async;(this||le).data=void 0!==J.data?J.data:null;(this||le).agent=J.agent;(this||le).isBinary=J.isBinary;(this||le).supportsBinary=J.supportsBinary;(this||le).enablesXDR=
J.enablesXDR;(this||le).withCredentials=J.withCredentials;(this||le).requestTimeout=J.requestTimeout;(this||le).pfx=J.pfx;(this||le).key=J.key;(this||le).passphrase=J.passphrase;(this||le).cert=J.cert;(this||le).ca=J.ca;(this||le).ciphers=J.ciphers;(this||le).rejectUnauthorized=J.rejectUnauthorized;(this||le).extraHeaders=J.extraHeaders;this.create()}function Yb(){for(var J in Mb.requests)Mb.requests.hasOwnProperty(J)&&Mb.requests[J].abort()}function I(){}function W(J){am.call(this||pg,J);(this||
pg).query=(this||pg).query||{};vk||(vk=xl.___eio=xl.___eio||[]);(this||pg).index=vk.length;var V=this||pg;vk.push(function(pa){V.onData(pa)});(this||pg).query.j=(this||pg).index;"function"===typeof addEventListener&&addEventListener("beforeunload",function(){V.script&&(V.script.onerror=I)},!1)}function sa(J){J&&J.forceBase64&&((this||da).supportsBinary=!1);(this||da).perMessageDeflate=J.perMessageDeflate;(this||da).usingBrowserWebSocket=ec&&!J.forceNode;(this||da).protocols=J.protocols;(this||da).usingBrowserWebSocket||
(jd=lc);za.call(this||da,J)}function xa(J,V){if(!((this||Jc)instanceof xa))return new xa(J,V);V=V||{};J&&"object"===typeof J&&(V=J,J=null);J?(J=Dj(J),V.hostname=J.host,V.secure="https"===J.protocol||"wss"===J.protocol,V.port=J.port,J.query&&(V.query=J.query)):V.host&&(V.hostname=Dj(V.host).host);(this||Jc).secure=null!=V.secure?V.secure:"undefined"!==typeof location&&"https:"===location.protocol;V.hostname&&!V.port&&(V.port=(this||Jc).secure?"443":"80");(this||Jc).agent=V.agent||!1;(this||Jc).hostname=
V.hostname||("undefined"!==typeof location?location.hostname:"localhost");(this||Jc).port=V.port||("undefined"!==typeof location&&location.port?location.port:(this||Jc).secure?443:80);(this||Jc).query=V.query||{};"string"===typeof(this||Jc).query&&((this||Jc).query=on.decode((this||Jc).query));(this||Jc).upgrade=!1!==V.upgrade;(this||Jc).path=(V.path||"/engine.io").replace(/\/$/,"")+"/";(this||Jc).forceJSONP=!!V.forceJSONP;(this||Jc).jsonp=!1!==V.jsonp;(this||Jc).forceBase64=!!V.forceBase64;(this||
Jc).enablesXDR=!!V.enablesXDR;(this||Jc).withCredentials=!1!==V.withCredentials;(this||Jc).timestampParam=V.timestampParam||"t";(this||Jc).timestampRequests=V.timestampRequests;(this||Jc).transports=V.transports||["polling","websocket"];(this||Jc).transportOptions=V.transportOptions||{};(this||Jc).readyState="";(this||Jc).writeBuffer=[];(this||Jc).prevBufferLen=0;(this||Jc).policyPort=V.policyPort||843;(this||Jc).rememberUpgrade=V.rememberUpgrade||!1;(this||Jc).binaryType=null;(this||Jc).onlyBinaryUpgrades=
V.onlyBinaryUpgrades;(this||Jc).perMessageDeflate=!1!==V.perMessageDeflate?V.perMessageDeflate||{}:!1;!0===(this||Jc).perMessageDeflate&&((this||Jc).perMessageDeflate={});(this||Jc).perMessageDeflate&&null==(this||Jc).perMessageDeflate.threshold&&((this||Jc).perMessageDeflate.threshold=1024);(this||Jc).pfx=V.pfx||null;(this||Jc).key=V.key||null;(this||Jc).passphrase=V.passphrase||null;(this||Jc).cert=V.cert||null;(this||Jc).ca=V.ca||null;(this||Jc).ciphers=V.ciphers||null;(this||Jc).rejectUnauthorized=
void 0===V.rejectUnauthorized?!0:V.rejectUnauthorized;(this||Jc).forceNode=!!V.forceNode;(this||Jc).isReactNative="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();if("undefined"===typeof self||(this||Jc).isReactNative)V.extraHeaders&&0<Object.keys(V.extraHeaders).length&&((this||Jc).extraHeaders=V.extraHeaders),V.localAddress&&((this||Jc).localAddress=V.localAddress);(this||Jc).id=null;(this||Jc).upgrades=null;(this||Jc).pingInterval=
null;(this||Jc).pingTimeout=null;(this||Jc).pingIntervalTimer=null;(this||Jc).pingTimeoutTimer=null;this.open()}function Eb(J,V,pa){(this||Ce).io=J;(this||Ce).nsp=V;(this||Ce).json=this||Ce;(this||Ce).ids=0;(this||Ce).acks={};(this||Ce).receiveBuffer=[];(this||Ce).sendBuffer=[];(this||Ce).connected=!1;(this||Ce).disconnected=!0;(this||Ce).flags={};pa&&pa.query&&((this||Ce).query=pa.query);(this||Ce).io.autoConnect&&this.open()}function Pb(J){J=J||{};(this||Ej).ms=J.min||100;(this||Ej).max=J.max||
1E4;(this||Ej).factor=J.factor||2;(this||Ej).jitter=0<J.jitter&&1>=J.jitter?J.jitter:0;(this||Ej).attempts=0}function Ha(J,V){if(!((this||Fd)instanceof Ha))return new Ha(J,V);J&&"object"===typeof J&&(V=J,J=void 0);V=V||{};V.path=V.path||"/socket.io";(this||Fd).nsps={};(this||Fd).subs=[];(this||Fd).opts=V;this.reconnection(!1!==V.reconnection);this.reconnectionAttempts(V.reconnectionAttempts||Infinity);this.reconnectionDelay(V.reconnectionDelay||1E3);this.reconnectionDelayMax(V.reconnectionDelayMax||
5E3);this.randomizationFactor(V.randomizationFactor||.5);(this||Fd).backoff=new Mq({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==V.timeout?2E4:V.timeout);(this||Fd).readyState="closed";(this||Fd).uri=J;(this||Fd).connecting=[];(this||Fd).lastPing=null;(this||Fd).encoding=!1;(this||Fd).packetBuffer=[];J=V.parser||Fp;(this||Fd).encoder=new J.Encoder;(this||Fd).decoder=new J.Decoder;(this||Fd).autoConnect=!1!==V.autoConnect;(this||
Fd).autoConnect&&this.open()}function Lb(J,V){"object"===typeof J&&(V=J,J=void 0);V=V||{};J=Gp(J);var pa=J.source,db=J.id,Db=J.path;Db=ao[db]&&Db in ao[db].nsps;V.forceNew||V["force new connection"]||!1===V.multiplex||Db?(Oq("ignoring socket cache for %s",pa),pa=So(pa,V)):(ao[db]||(Oq("new io instance for %s",pa),ao[db]=So(pa,V)),pa=ao[db]);J.query&&!V.query&&(V.query=J.query);return pa.socket(J.path,V)}var xd=lively.FreezerRuntime.recorderFor("lively.2lively/interface.js");xd.nyi=function(J){throw Error("Not yet implemented: "+
J);};xd.string=nb;xd.promise=xb;xd.debugMessageOrder=!1;var vd=function(J){this.id=xd.string.newUUID();this.actions={};this.options={ackTimeout:3500,debug:!1};this._incomingOrderNumberingBySenders=new Map;this._outgoingOrderNumberingByTargets=new Map;this._outOfOrderCacheBySenders=new Map};vd.prototype.isOnline=function(){xd.nyi("isOnline")};vd.prototype.open=function(){xd.nyi("open")};vd.prototype.close=function(){xd.nyi("close")};vd.prototype.remove=function(){xd.nyi("remove")};vd.prototype.whenOnline=
function(J){var V=this;return xd.promise.waitFor(J,function(){return V.isOnline()}).then(function(){return V}).catch(function(pa){return Promise.reject(/timeout/i.test(String(pa))?Error("Timeout in "+V+".whenOnline"):pa)})};vd.prototype.onError=function(J){this.debug&&console.log("["+this+"] error: "+J)};vd.prototype.removeService=function(J){delete this.actions[J]};vd.prototype.removeServices=function(J){var V=this;J.forEach(function(pa){return V.removeService(pa)})};vd.prototype.addService=function(J,
V){this.actions[J]=V};vd.prototype.addServices=function(J){var V=this;Object.keys(J).forEach(function(pa){return V.addService(pa,J[pa])})};vd.prototype.ping=function(J){var V=this,pa,db,Db,vc,od;return $jscomp.asyncExecutePromiseGeneratorProgram(function(ud){if(1==ud.nextAddress)return pa=Date.now(),ud.yield(V.sendToAndWait(J,"l2l-ping",{timestamp:pa}),2);db=ud.yieldResult;Db=db.data;vc=Db.timestamp;od=Date.now();return ud.return({to:vc-pa,from:od-vc,roundtrip:od-pa})})};vd.prototype.send=function(J,
V){xd.nyi("send")};vd.prototype.sendAndWait=function(J){var V=this,pa,db,Db,vc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(od){switch(od.nextAddress){case 1:return pa=new Promise(function(ud,Od){return V.send(J,ud)}),db={},Db=V.options.ackTimeout+400,"ackTimeout"in J&&(Db=!J.ackTimeout||0>J.ackTimeout?null:J.ackTimeout+400),Db?od.yield(Promise.race([xd.promise.delay(Db,db),pa]),5):od.yield(pa,4);case 4:vc=od.yieldResult;od.jumpTo(3);break;case 5:vc=od.yieldResult;case 3:if(vc===db)throw Error("Timeout sending "+
J.action);return od.return(vc)}})};vd.prototype.sendTo=function(J,V,pa,db){return this.send({target:J,action:V,data:pa},db)};vd.prototype.sendToAndWait=function(J,V,pa,db){return this.sendAndWait(Object.assign({target:J,action:V,data:pa},db))};vd.prototype.prepareSend=function(J,V){var pa=J.target,db=J.action,Db=J.messageId,vc=J.sender;if(!db)throw Error("Trying to send a message without specifying action!");if(!pa)throw Error("Trying to send message "+db+" without specifying target!");Db||(J.messageId=
xd.string.newUUID());vc||(J.sender=this.id);db=J.n=this._outgoingOrderNumberingByTargets.get(pa)||0;this._outgoingOrderNumberingByTargets.set(pa,db+1);if("function"===typeof V){vc=this;var od=V;V=function(ud){var Od=vc._incomingOrderNumberingBySenders.get(ud.sender)||0;vc.debug&&xd.debugMessageOrder&&console.log("[MSG ORDER] "+vc+" received ack for "+ud.action+" as msg "+Od);try{od.apply(null,arguments)}catch(He){console.error("Error in ack fn of "+vc+": "+He.stack)}vc._incomingOrderNumberingBySenders.set(ud.sender,
Od+1);setTimeout(function(){return vc.invokeOutOfOrderMessages(ud.sender)},0)}}this.debug&&xd.debugMessageOrder&&console.log("[MSG ORDER] "+this+" sending "+db+" ("+J.action+") to "+pa);return[J,V]};vd.prototype.prepareAnswerMessage=function(J,V){return{action:J.action+"-response",inResponseTo:J.messageId,target:J.sender,data:V,sender:this.id}};vd.prototype.installEventToMessageTranslator=function(J){var V=this,pa=J.onevent;J.onevent=function(db){var Db=db.data||[];pa.call(this,db);db.data=["*"].concat(Db);
pa.call(this,db)};J.on("*",function(db,Db){db&&"object"===typeof db&&db.action&&(Db=db,db=Db.action);var vc=arguments[arguments.length-1];vc="function"===typeof vc?vc:null;(Db=Db===vc?null:Db)&&Db.data&&("number"===typeof Db.n||Db.broadcast)&&Db.sender?V.receive(Db,J,vc):(console.warn(V+" received non-conformant message "+db+":",arguments),"function"===typeof vc&&vc({data:{error:"invalid l2l message"}}))})};vd.prototype.receive=function(J,V,pa){this.dispatchL2LMessageToSelf(J,V,pa)};vd.prototype.dispatchL2LMessageToSelf=
function(J,V,pa){var db=this,Db=J.action;if(J.broadcast)this.safeInvokeServiceHandler(Db,J,pa,V);else try{var vc=this._incomingOrderNumberingBySenders.get(J.sender)||0,od="register"===Db||"unregister";if(!od&&J.n<vc)console.error("[MSG ORDER] ["+this+"] received message no. "+J.n+" but expected >= "+vc+", dropping "+Db);else if(!od&&J.n>vc){this.debug&&xd.debugMessageOrder&&console.log("[MSG ORDER] ["+this+"] storing out of order message "+Db+" ("+J.n+") for later invocation");var ud=this._outOfOrderCacheBySenders.get(J.sender);
ud||(ud=[],this._outOfOrderCacheBySenders.set(J.sender,ud));ud.push([Db,J,pa,V])}else this.safeInvokeServiceHandler(Db,J,pa,V),setTimeout(function(){return db.invokeOutOfOrderMessages(J.sender)},0)}catch(Od){console.error("Error message ordering when handling "+Db+": "+(Od.stack||Od)),"function"===typeof pa&&pa(this.prepareAnswerMessage(J,{isError:!0,error:String(Od.stack||Od)}))}};vd.prototype.invokeOutOfOrderMessages=function(J){var V=this._outOfOrderCacheBySenders.get(J);if(V&&V.length){var pa=
this._incomingOrderNumberingBySenders.get(J)||0;J=V.findIndex(function(db){db=$jscomp.makeIterator(db);db.next();return db.next().value.n===pa});-1!==J&&(V.splice(J,1),this.invokeServiceHandler.apply(this,V[J]))}};vd.prototype.renameTarget=function(J,V){if(J!==V){var pa=this._outgoingOrderNumberingByTargets.get(J);this._outgoingOrderNumberingByTargets.delete(J);this._outgoingOrderNumberingByTargets.set(V,pa)}};vd.prototype.safeInvokeServiceHandler=function(J,V,pa,db){try{"function"===typeof this.actions[J]?
this.invokeServiceHandler(J,V,pa,db):db._events&&Object.keys(db._events).includes(J)||(console.warn("WARNING ["+this+"] Unhandled message: "+J),"function"===typeof pa&&pa(this.prepareAnswerMessage(V,{isError:!0,error:"message not understood: "+J})))}catch(Db){console.error("Error when handling "+J+": "+(Db.stack||Db)),"function"===typeof pa&&pa(this.prepareAnswerMessage(V,{isError:!0,error:String(Db.stack||Db)}))}};vd.prototype.invokeServiceHandler=function(J,V,pa,db){var Db=this;this.debug&&xd.debugMessageOrder&&
console.log("[MSG ORDER] "+this+" received "+V.n+" ("+V.action+") from "+V.sender);this._incomingOrderNumberingBySenders.set(V.sender,V.n+1);if("function"===typeof pa){var vc=!1,od=!1,ud="ackTimeout"in V?V.ackTimeout:this.options.ackTimeout,Od=this._outgoingOrderNumberingByTargets.get(V.sender)||0;this._outgoingOrderNumberingByTargets.set(V.sender,Od+1);var He=function(jf){od?console.warn("["+Db+"] ackFn for "+V.action+" called after it timed out, dropping answer!"):vc?console.warn("["+Db+"] ack function called repeatedly when handling "+
V.action):(vc=!0,pa(Db.prepareAnswerMessage(V,jf)),Db.debug&&xd.debugMessageOrder&&console.log("[MSG ORDER] "+Db+" sending "+Od+" (ack for "+V.action+")"))};ud&&setTimeout(function(){vc||(He({isError:!0,error:"Timeout error: "+Db+" did not send answer for "+V.action+" after "+ud+"ms"}),od=!0)},ud)}try{this.actions[J].call(this,this,V,He,db)}catch(jf){console.error("["+this+"] Error handling "+J+": "+(jf.stack||jf)),He&&He({error:jf.stack})}};$jscomp.global.Object.defineProperties(vd.prototype,{debug:{configurable:!0,
enumerable:!0,get:function(){return this.options.debug},set:function(J){this.options.debug=J}}});xd.L2LConnection=vd;xd.default=vd;var Gc=lively.FreezerRuntime.recorderFor("lively.2lively/default-actions.js"),Ma={"l2l-ping":function(J,V,pa,db){db=V.sender;V=V.data.timestamp;var Db=Date.now();"function"===typeof pa&&pa({timestamp:Db});J.debug&&console.log("[undefined] got ping from "+db+", time: "+(Db-V)+"ms")},"remote-eval":function(J,V,pa,db){var Db=V.data.source;Promise.resolve().then(function(){return eval(Db)}).then(function(vc){return pa({value:vc})}).catch(function(vc){vc.originalErr&&
(vc=vc.originalErr);console.error("eval error: "+vc);"function"===typeof pa&&pa({isError:!0,value:String(vc.stack||vc)})})},"remote-eval-2":function(J,V,pa,db){var Db=V.data.source;Promise.resolve().then(function(){var vc=eval(Db);if(!(vc instanceof Promise))throw console.error("unexpected eval result:"+vc),Error("unexpected eval result:"+vc);return vc}).then(function(vc){return pa(vc)}).catch(function(vc){console.error("eval error: "+vc);vc.originalErr&&(vc=vc.originalErr);"function"===typeof pa&&
pa({isError:!0,value:String(vc.stack||vc)})})}};Gc.defaultActions=Ma;Gc.defaultActions=Ma;Gc.defaultActions=Ma;var tc={},$a=(tc["[broadcast] send"]=function(J,V,pa,db){var Db=V.sender,vc=V.data,od,ud,Od,He,jf,mh,Ch,Yi,Im,Xm,tn,un;return $jscomp.asyncExecutePromiseGeneratorProgram(function(To){od=vc;ud=od.action;Od=od.broadcast;He=od.room;jf=od.namespace;mh=od.isSystemBroadcast;Ch=od.isMultiServerBroadcast;Yi=[];Ch?(console.log(".......isMultiServerBroadcast"),Im=J,Xm=Im.id,tn=J.getTrackerList(),console.log(tn),
Yi=tn.map(function(cl){return cl.id!=Xm?cl.io.nsps["/"+cl.namespace]:db.broadcast})):(mh&&(jf=J.namespace),Yi.push(jf?J.io.nsps["/"+jf]:db.broadcast));Yi.forEach(function(cl){return cl.to(He).emit({action:ud,sender:Db,broadcast:!0,data:Od})});pa&&"function"===typeof pa&&(un="message broadcasted to "+He,jf&&(un+=" in namespace "+jf),1<Yi.length&&(un+=" "+Yi.length+" trackers"),console.log(un),pa({status:un}));To.jumpToEnd()})},tc["[broadcast] join room"]=function(J,V,pa,db){var Db=V.sender,vc=V.data.room,
od,ud,Od,He;return $jscomp.asyncExecutePromiseGeneratorProgram(function(jf){if(1==jf.nextAddress)return ud=!1,Od=J.io.nsps["/"+J.namespace].adapter.rooms,(He=Od[vc]&&Od[vc].sockets&&Od[vc].sockets[db.id])?(od=Db+" already in "+vc,jf.jumpTo(2)):jf.yield(new Promise(function(mh,Ch){return db.join(vc,function(Yi){return Yi?Ch(Yi):mh()})}),3);2!=jf.nextAddress&&(od=Db+" joined "+vc,ud=!0);pa&&"function"===typeof pa&&pa({status:od,joined:ud});jf.jumpToEnd()})},tc["[broadcast] leave room"]=function(J,V,
pa,db){var Db=V.sender,vc=V.data.room,od,ud,Od,He;return $jscomp.asyncExecutePromiseGeneratorProgram(function(jf){if(1==jf.nextAddress)return ud=!1,Od=J.io.nsps["/"+J.namespace].adapter.rooms,He=Od[vc]&&Od[vc].sockets&&Od[vc].sockets[db.id],He?jf.yield(new Promise(function(mh,Ch){return db.leave(vc,function(Yi){return Yi?Ch(Yi):mh()})}),3):(od=Db+" not in "+vc,jf.jumpTo(2));2!=jf.nextAddress&&(od=Db+" left room "+vc,ud=!0);console.log(od);pa&&"function"===typeof pa&&pa({left:ud,status:od});jf.jumpToEnd()})},
tc["[broadcast] my rooms"]=function(J,V,pa,db){pa(db.rooms)},tc["[broadcast] all rooms"]=function(J,V,pa,db){pa(J.io.nsps["/"+J.namespace].adapter.rooms)},tc["[broadcast] list room members"]=function(J,V,pa,db){V=V.data.room;db=J.io;V?(J=db.nsps["/"+J.namespace].adapter.rooms[V],pa({room:V,sockets:J?J.sockets:{},length:J?J.length:0})):pa({isError:!0,error:"`room` paramerter missing!"})},tc.getClients=function(J,V,pa){J.removeDisconnectedClients();pa(Array.from(J.clients))},tc);Gc.defaultTrackerActions=
$a;Gc.defaultTrackerActions=$a;Gc.defaultTrackerActions=$a;var Cc={},Mc=(Cc.getRoomList=function(J){var V=J.client,pa=J.ackFn,db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){db=V._socketioClient.rooms;pa(db);Db.jumpToEnd()})},Cc["ask for"]=function(J,V,pa,db){var Db=V.sender,vc=V.data.query,od=this,ud,Od;return $jscomp.asyncExecutePromiseGeneratorProgram(function(He){if(1==He.nextAddress)return ud=vc.match(/password|sudo/i)?"passwordPrompt":"prompt",He.yield($world[ud](vc),2);Od=
He.yieldResult;"function"===typeof pa&&pa({answer:Od});J.debug&&console.log("["+od+"] message 'ask for' from "+Db+", query: "+vc);He.jumpToEnd()})},Cc["open editor"]=function(J,V,pa,db){var Db=V.data.args,vc;return $jscomp.asyncExecutePromiseGeneratorProgram(function(od){if(1==od.nextAddress)return Db.length?od.yield($world.execCommand("open file for EDITOR",{url:Db[0]}),2):(pa({error:"no file specified"}),od.return());vc=od.yieldResult;"function"===typeof pa&&pa("aborted"===vc?{error:String(vc)}:
{status:vc});od.jumpToEnd()})},Cc.changeWorkingDirectory=function(J,V,pa,db){var Db=V.data.args,vc,od,ud,Od,He,jf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mh){vc=$jscomp.makeIterator(Db||[]);od=vc.next().value;ud=vc.next().value;Od="OK";try{if(od)if(ud){if(He=$world.getMorphWithId(ud))if(He.__lookupSetter__("cwd"))He.cwd=od;else if("function"===typeof He.changeWorkingDirectory)He.changeWorkingDirectory(od);else if("function"===typeof He.pluginFind){if(jf=He.pluginFind(function(Ch){return Ch.isShellEditorPlugin}))jf.cwd=
od}else Od="[changeWorkingDirectory] cannot figure pout how to set dir"}else Od="[changeWorkingDirectory] No command morph";else Od="[changeWorkingDirectory] No directory received"}catch(Ch){Od=String(Ch)}"OK"!==Od&&console.warn(Od);"function"===typeof pa&&pa(Od);mh.jumpToEnd()})},Cc);Gc.defaultClientActions=Mc;Gc.defaultClientActions=Mc;Gc.defaultClientActions=Mc;var Ua={},Fa=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
Wb="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),Bd=Ua=function(J){var V=J,pa=J.indexOf("["),db=J.indexOf("]");-1!=pa&&-1!=db&&(J=J.substring(0,pa)+J.substring(pa,db).replace(/:/g,";")+J.substring(db,J.length));var Db=Fa.exec(J||"");J={};for(var vc=14;vc--;)J[Wb[vc]]=Db[vc]||"";-1!=pa&&-1!=db&&(J.source=V,J.host=J.host.substring(1,J.host.length-1).replace(/;/g,":"),J.authority=J.authority.replace("[","").replace("]","").replace(/;/g,
":"),J.ipv6uri=!0);V=J.path;pa=V.replace(/\/{2,9}/g,"/").split("/");"/"!=V.substr(0,1)&&0!==V.length||pa.splice(0,1);"/"==V.substr(V.length-1,1)&&pa.splice(pa.length-1,1);J.pathNames=pa;J.queryKey=Fc(J,J.query);return J},pd={},Vd=864E5,qc=365.25*Vd,Ld=pd=function(J,V){V=V||{};var pa=typeof J;if("string"===pa&&0<J.length)return Sc(J);if("number"===pa&&!1===isNaN(J))return V.long?ad(J,Vd,"day")||ad(J,36E5,"hour")||ad(J,6E4,"minute")||ad(J,1E3,"second")||J+" ms":J>=Vd?Math.round(J/Vd)+"d":36E5<=J?Math.round(J/
36E5)+"h":6E4<=J?Math.round(J/6E4)+"m":1E3<=J?Math.round(J/1E3)+"s":J+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(J));},Lc="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,kb={};kb=kb=ed.debug=ed["default"]=ed;kb.coerce=function(J){return J instanceof Error?J.stack||J.message:J};kb.disable=function(){kb.enable("")};kb.enable=function(J){kb.save(J);kb.names=[];kb.skips=[];var V,pa=("string"===typeof J?J:"").split(/[\s,]+/),
db=pa.length;for(V=0;V<db;V++)pa[V]&&(J=pa[V].replace(/\*/g,".*?"),"-"===J[0]?kb.skips.push(new RegExp("^"+J.substr(1)+"$")):kb.names.push(new RegExp("^"+J+"$")));for(V=0;V<kb.instances.length;V++)J=kb.instances[V],J.enabled=kb.enabled(J.namespace)};kb.enabled=function(J){if("*"===J[J.length-1])return!0;var V;var pa=0;for(V=kb.skips.length;pa<V;pa++)if(kb.skips[pa].test(J))return!1;pa=0;for(V=kb.names.length;pa<V;pa++)if(kb.names[pa].test(J))return!0;return!1};kb.humanize=Ld;kb.instances=[];kb.names=
[];kb.skips=[];kb.formatters={};var ja="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,oa={},tb=Ob;oa=oa=kb;oa.log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};oa.formatArgs=function(J){var V=(this||ja).useColors;J[0]=(V?"%c":"")+(this||ja).namespace+(V?" %c":" ")+J[0]+(V?"%c ":" ")+"+"+oa.humanize((this||ja).diff);if(V){V="color: "+(this||ja).color;J.splice(1,0,V,"color: inherit");var pa=0,
db=0;J[0].replace(/%[a-zA-Z%]/g,function(Db){"%%"!==Db&&(pa++,"%c"===Db&&(db=pa))});J.splice(db,0,V)}};oa.save=function(J){try{null==J?oa.storage.removeItem("debug"):oa.storage.debug=J}catch(V){}};oa.load=Sa;oa.useColors=function(){return"undefined"!==typeof window&&window.process&&"renderer"===window.process.type?!0:"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&
document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var G=oa;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)var ma=
chrome.storage.local;else a:{try{ma=window.localStorage;break a}catch(J){}ma=void 0}G.storage=ma;oa.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
oa.formatters.j=function(J){try{return JSON.stringify(J)}catch(V){return"[UnexpectedJSONParseError]: "+V.message}};oa.enable(Sa());var Ga=oa,lb="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,gc={};gc=ob;ob.prototype.on=ob.prototype.addEventListener=function(J,V){(this||lb)._callbacks=(this||lb)._callbacks||{};((this||lb)._callbacks["$"+J]=(this||lb)._callbacks["$"+J]||[]).push(V);return this||lb};ob.prototype.once=function(J,V){function pa(){this.off(J,pa);V.apply(this||
lb,arguments)}pa.fn=V;this.on(J,pa);return this||lb};ob.prototype.off=ob.prototype.removeListener=ob.prototype.removeAllListeners=ob.prototype.removeEventListener=function(J,V){(this||lb)._callbacks=(this||lb)._callbacks||{};if(0==arguments.length)return(this||lb)._callbacks={},this||lb;var pa=(this||lb)._callbacks["$"+J];if(!pa)return this||lb;if(1==arguments.length)return delete (this||lb)._callbacks["$"+J],this||lb;for(var db,Db=0;Db<pa.length;Db++)if(db=pa[Db],db===V||db.fn===V){pa.splice(Db,
1);break}0===pa.length&&delete (this||lb)._callbacks["$"+J];return this||lb};ob.prototype.emit=function(J){(this||lb)._callbacks=(this||lb)._callbacks||{};for(var V=Array(arguments.length-1),pa=(this||lb)._callbacks["$"+J],db=1;db<arguments.length;db++)V[db-1]=arguments[db];if(pa){pa=pa.slice(0);db=0;for(var Db=pa.length;db<Db;++db)pa[db].apply(this||lb,V)}return this||lb};ob.prototype.listeners=function(J){(this||lb)._callbacks=(this||lb)._callbacks||{};return(this||lb)._callbacks["$"+J]||[]};ob.prototype.hasListeners=
function(J){return!!this.listeners(J).length};var uc=gc,yd={},Pd={}.toString,ve=yd=Array.isArray||function(J){return"[object Array]"==Pd.call(J)},Uc={},Sd=Hb.Buffer;Uc=function(J){var V;!(V=De&&Sd.isBuffer(J))&&(V=Td)&&((V=J instanceof ArrayBuffer)||(V="function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(J):J.buffer instanceof ArrayBuffer));return V};var De="function"===typeof Sd&&"function"===typeof Sd.isBuffer,Td="function"===typeof ArrayBuffer,Gf=Uc,Te="undefined"!==typeof globalThis?globalThis:
"undefined"!==typeof self?self:global,mc={},we=ve,qf=Gf,sf=Object.prototype.toString,pe="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===sf.call(Blob),va="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===sf.call(File);mc.deconstructPacket=function(J){var V=[];J.data=$b(J.data,V);J.attachments=V.length;return{packet:J,buffers:V}};mc.reconstructPacket=function(J,V){J.data=Sb(J.data,V);J.attachments=void 0;return J};mc.removeBlobs=function(J,
V){function pa(vc,od,ud){if(!vc)return vc;if(pe&&vc instanceof Blob||va&&vc instanceof File){db++;var Od=new FileReader;Od.onload=function(){ud?ud[od]=(this||Te).result:Db=(this||Te).result;--db||V(Db)};Od.readAsArrayBuffer(vc)}else if(we(vc))for(Od=0;Od<vc.length;Od++)pa(vc[Od],Od,vc);else if("object"===typeof vc&&!qf(vc))for(Od in vc)pa(vc[Od],Od,vc)}var db=0,Db=J;pa(Db);db||V(Db)};var La="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,ib={},S=Ga("socket.io-parser"),
ua=mc;ib.protocol=4;ib.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" ");ib.CONNECT=0;ib.DISCONNECT=1;ib.EVENT=2;ib.ACK=3;ib.ERROR=4;ib.BINARY_EVENT=5;ib.BINARY_ACK=6;ib.Encoder=Bc;ib.Decoder=Ub;var Ya=ib.ERROR+'"encode error"';Bc.prototype.encode=function(J,V){S("encoding packet %j",J);ib.BINARY_EVENT===J.type||ib.BINARY_ACK===J.type?Xb(J,V):(J=id(J),V([J]))};uc(Ub.prototype);Ub.prototype.add=function(J){if("string"===typeof J){a:{var V=0,pa={type:Number(J.charAt(0))};
if(null==ib.types[pa.type])J={type:ib.ERROR,data:"parser error: unknown packet type "+pa.type};else{if(ib.BINARY_EVENT===pa.type||ib.BINARY_ACK===pa.type){for(var db="";"-"!==J.charAt(++V)&&(db+=J.charAt(V),V!=J.length););if(db!=Number(db)||"-"!==J.charAt(V))throw Error("Illegal attachments");pa.attachments=Number(db)}if("/"===J.charAt(V+1))for(pa.nsp="";++V;){db=J.charAt(V);if(","===db)break;pa.nsp+=db;if(V===J.length)break}else pa.nsp="/";db=J.charAt(V+1);if(""!==db&&Number(db)==db){for(pa.id="";++V;){db=
J.charAt(V);if(null==db||Number(db)!=db){--V;break}pa.id+=J.charAt(V);if(V===J.length)break}pa.id=Number(pa.id)}if(J.charAt(++V)){V=J.substr(V);try{var Db=JSON.parse(V)}catch(vc){Db=!1}if(!1===Db||pa.type!==ib.ERROR&&!ve(Db)){J={type:ib.ERROR,data:"parser error: invalid payload"};break a}else pa.data=Db}S("decoded %s as %j",J,pa);J=pa}}ib.BINARY_EVENT===J.type||ib.BINARY_ACK===J.type?((this||La).reconstructor=new ub(J),0===(this||La).reconstructor.reconPack.attachments&&this.emit("decoded",J)):this.emit("decoded",
J)}else if(Gf(J)||J.base64)if((this||La).reconstructor){if(J=(this||La).reconstructor.takeBinaryData(J))(this||La).reconstructor=null,this.emit("decoded",J)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+J);};Ub.prototype.destroy=function(){(this||La).reconstructor&&(this||La).reconstructor.finishedReconstruction()};ub.prototype.takeBinaryData=function(J){(this||La).buffers.push(J);return(this||La).buffers.length===(this||La).reconPack.attachments?
(J=ua.reconstructPacket((this||La).reconPack,(this||La).buffers),this.finishedReconstruction(),J):null};ub.prototype.finishedReconstruction=function(){(this||La).reconPack=null;(this||La).buffers=[]};var gb={};try{gb="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(J){gb=!1}var ic=gb,kc={},Oc=kc="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")(),Pc={},Rc=Pc=function(J){var V=J.xdomain,pa=J.xscheme;J=J.enablesXDR;try{if("undefined"!==
typeof XMLHttpRequest&&(!V||ic))return new XMLHttpRequest}catch(db){}try{if("undefined"!==typeof XDomainRequest&&!pa&&J)return new XDomainRequest}catch(db){}if(!V)try{return new (Oc[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(db){}},Ie={},zf=Hb.Buffer,ef=ve,Ee=Object.prototype.toString,dh="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Ee.call(Blob),Cg="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===Ee.call(File),
ci=Ie=hc,Og={},Mi=Og=function(J,V,pa){var db=J.byteLength;V=V||0;pa=pa||db;if(J.slice)return J.slice(V,pa);0>V&&(V+=db);0>pa&&(pa+=db);pa>db&&(pa=db);if(V>=db||V>=pa||0===db)return new ArrayBuffer(0);J=new Uint8Array(J);db=new Uint8Array(pa-V);for(var Db=0;V<pa;V++,Db++)db[Db]=J[V];return db.buffer},Hf={},Bi=Hf=function(J,V,pa){function db(vc,od){if(0>=db.count)throw Error("after called too many times");--db.count;vc?(Db=!0,V(vc),V=pa):0!==db.count||Db||V(null,od)}var Db=!1;pa=pa||wc;db.count=J;return 0===
J?V():db},sh={};(function(J){sh.encode=function(V){V=new Uint8Array(V);var pa,db=V.length,Db="";for(pa=0;pa<db;pa+=3)Db+=J[V[pa]>>2],Db+=J[(V[pa]&3)<<4|V[pa+1]>>4],Db+=J[(V[pa+1]&15)<<2|V[pa+2]>>6],Db+=J[V[pa+2]&63];2===db%3?Db=Db.substring(0,Db.length-1)+"=":1===db%3&&(Db=Db.substring(0,Db.length-2)+"==");return Db};sh.decode=function(V){var pa=.75*V.length,db=V.length,Db=0;"="===V[V.length-1]&&(pa--,"="===V[V.length-2]&&pa--);var vc=new ArrayBuffer(pa),od=new Uint8Array(vc);for(pa=0;pa<db;pa+=4){var ud=
J.indexOf(V[pa]);var Od=J.indexOf(V[pa+1]);var He=J.indexOf(V[pa+2]);var jf=J.indexOf(V[pa+3]);od[Db++]=ud<<2|Od>>4;od[Db++]=(Od&15)<<4|He>>2;od[Db++]=(He&3)<<6|jf&63}return vc}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");var yi={},Vh="undefined"!==typeof Vh?Vh:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:!1;try{var Oj=2===(new Blob(["hi"])).size}catch(J){Oj=!1}var Wj;
if(Wj=Oj)try{Wj=2===(new Blob([new Uint8Array([1,2])])).size}catch(J){Wj=!1}var Hk=Wj,mj=Vh&&Vh.prototype.append&&Vh.prototype.getBlob;"undefined"!==typeof Blob&&(cd.prototype=Blob.prototype,bb.prototype=Blob.prototype);yi=Oj?Hk?Blob:bb:mj?cd:void 0;var ch=yi,zi={},wl=zi=Object.keys||function(J){var V=[],pa=Object.prototype.hasOwnProperty,db;for(db in J)pa.call(J,db)&&V.push(db);return V},Se={},pj=String.fromCharCode,Bb,Qc,Md;Se={version:"2.1.2",encode:function(J,V){V=V||{};V=!1!==V.strict;J=pb(J);
for(var pa=J.length,db=-1,Db,vc="";++db<pa;){Db=J[db];var od=V;if(0==(Db&4294967168))Db=pj(Db);else{var ud="";0==(Db&4294965248)?ud=pj(Db>>6&31|192):0==(Db&4294901760)?(pc(Db,od)||(Db=65533),ud=pj(Db>>12&15|224),ud+=pj(Db>>6&63|128)):0==(Db&4292870144)&&(ud=pj(Db>>18&7|240),ud+=pj(Db>>12&63|128),ud+=pj(Db>>6&63|128));Db=ud+=pj(Db&63|128)}vc+=Db}return vc},decode:function(J,V){V=V||{};V=!1!==V.strict;Bb=pb(J);Qc=Bb.length;Md=0;J=[];for(var pa;!1!==(pa=cb(V));)J.push(pa);V=J.length;pa=-1;for(var db,
Db="";++pa<V;)db=J[pa],65535<db&&(db-=65536,Db+=pj(db>>>10&1023|55296),db=56320|db&1023),Db+=pj(db);return Db}};var Rb={},wf=Bi,Mf=Se,Wh;"undefined"!==typeof ArrayBuffer&&(Wh=sh);var Zl="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),Wn="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),mn=Zl||Wn;Rb.protocol=3;var Yk=Rb.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},tl=wl(Yk),ij={type:"error",data:"parser error"};Rb.encodePacket=function(J,
V,pa,db){"function"===typeof V&&(db=V,V=!1);"function"===typeof pa&&(db=pa,pa=null);var Db=void 0===J.data?void 0:J.data.buffer||J.data;if("undefined"!==typeof ArrayBuffer&&Db instanceof ArrayBuffer){if(V){pa=J.data;V=new Uint8Array(pa);pa=new Uint8Array(1+pa.byteLength);pa[0]=Yk[J.type];for(J=0;J<V.length;J++)pa[J+1]=V[J];J=db(pa.buffer)}else J=Rb.encodeBase64Packet(J,db);return J}if("undefined"!==typeof ch&&Db instanceof ch)return V?mn?J=Pa(J,V,db):(V=new Uint8Array(1),V[0]=Yk[J.type],J=new ch([V.buffer,
J.data]),J=db(J)):J=Rb.encodeBase64Packet(J,db),J;if(Db&&Db.base64)return db("b"+Rb.packets[J.type]+J.data.data);V=Yk[J.type];void 0!==J.data&&(V+=pa?Mf.encode(String(J.data),{strict:!1}):String(J.data));return db(""+V)};Rb.encodeBase64Packet=function(J,V){var pa="b"+Rb.packets[J.type];if("undefined"!==typeof ch&&J.data instanceof ch){var db=new FileReader;db.onload=function(){var od=db.result.split(",")[1];V(pa+od)};return db.readAsDataURL(J.data)}try{var Db=String.fromCharCode.apply(null,new Uint8Array(J.data))}catch(od){J=
new Uint8Array(J.data);Db=Array(J.length);for(var vc=0;vc<J.length;vc++)Db[vc]=J[vc];Db=String.fromCharCode.apply(null,Db)}pa+=btoa(Db);return V(pa)};Rb.decodePacket=function(J,V,pa){if(void 0===J)return ij;if("string"===typeof J){if("b"===J.charAt(0))return Rb.decodeBase64Packet(J.substr(1),V);if(pa){a:{V=J;try{V=Mf.decode(V,{strict:!1})}catch(db){J=!1;break a}J=V}if(!1===J)return ij}pa=J.charAt(0);return Number(pa)==pa&&tl[pa]?1<J.length?{type:tl[pa],data:J.substring(1)}:{type:tl[pa]}:ij}pa=(new Uint8Array(J))[0];
J=Mi(J,1);ch&&"blob"===V&&(J=new ch([J]));return{type:tl[pa],data:J}};Rb.decodeBase64Packet=function(J,V){var pa=tl[J.charAt(0)];if(!Wh)return{type:pa,data:{base64:!0,data:J.substr(1)}};J=Wh.decode(J.substr(1));"blob"===V&&ch&&(J=new ch([J]));return{type:pa,data:J}};Rb.encodePayload=function(J,V,pa){"function"===typeof V&&(pa=V,V=null);var db=ci(J);if(V&&db)return ch&&!mn?Rb.encodePayloadAsBlob(J,pa):Rb.encodePayloadAsArrayBuffer(J,pa);if(!J.length)return pa("0:");Za(J,function(Db,vc){Rb.encodePacket(Db,
db?V:!1,!1,function(od){vc(null,od.length+":"+od)})},function(Db,vc){return pa(vc.join(""))})};Rb.decodePayload=function(J,V,pa){if("string"!==typeof J)return Rb.decodePayloadAsBinary(J,V,pa);"function"===typeof V&&(pa=V,V=null);if(""===J)return pa(ij,0,1);var db="";for(var Db,vc,od=0,ud=J.length;od<ud;od++)if(vc=J.charAt(od),":"!==vc)db+=vc;else{if(""===db||db!=(Db=Number(db)))return pa(ij,0,1);vc=J.substr(od+1,Db);if(db!=vc.length)return pa(ij,0,1);if(vc.length){db=Rb.decodePacket(vc,V,!1);if(ij.type===
db.type&&ij.data===db.data)return pa(ij,0,1);if(!1===pa(db,od+Db,ud))return}od+=Db;db=""}if(""!==db)return pa(ij,0,1)};Rb.encodePayloadAsArrayBuffer=function(J,V){if(!J.length)return V(new ArrayBuffer(0));Za(J,function(pa,db){Rb.encodePacket(pa,!0,!0,function(Db){return db(null,Db)})},function(pa,db){pa=db.reduce(function(od,ud){ud="string"===typeof ud?ud.length:ud.byteLength;return od+ud.toString().length+ud+2},0);var Db=new Uint8Array(pa),vc=0;db.forEach(function(od){var ud="string"===typeof od,
Od=od;if(ud){Od=new Uint8Array(od.length);for(var He=0;He<od.length;He++)Od[He]=od.charCodeAt(He);Od=Od.buffer}ud?Db[vc++]=0:Db[vc++]=1;od=Od.byteLength.toString();for(He=0;He<od.length;He++)Db[vc++]=parseInt(od[He]);Db[vc++]=255;Od=new Uint8Array(Od);for(He=0;He<Od.length;He++)Db[vc++]=Od[He]});return V(Db.buffer)})};Rb.encodePayloadAsBlob=function(J,V){Za(J,function(pa,db){Rb.encodePacket(pa,!0,!0,function(Db){var vc=new Uint8Array(1);vc[0]=1;if("string"===typeof Db){for(var od=new Uint8Array(Db.length),
ud=0;ud<Db.length;ud++)od[ud]=Db.charCodeAt(ud);Db=od.buffer;vc[0]=0}od=(Db instanceof ArrayBuffer?Db.byteLength:Db.size).toString();var Od=new Uint8Array(od.length+1);for(ud=0;ud<od.length;ud++)Od[ud]=parseInt(od[ud]);Od[od.length]=255;ch&&(Db=new ch([vc.buffer,Od.buffer,Db]),db(null,Db))})},function(pa,db){return V(new ch(db))})};Rb.decodePayloadAsBinary=function(J,V,pa){"function"===typeof V&&(pa=V,V=null);for(var db=[];0<J.byteLength;){for(var Db=new Uint8Array(J),vc=0===Db[0],od="",ud=1;255!==
Db[ud];ud++){if(310<od.length)return pa(ij,0,1);od+=Db[ud]}J=Mi(J,2+od.length);od=parseInt(od);Db=Mi(J,0,od);if(vc)try{Db=String.fromCharCode.apply(null,new Uint8Array(Db))}catch(He){for(vc=new Uint8Array(Db),Db="",ud=0;ud<vc.length;ud++)Db+=String.fromCharCode(vc[ud])}db.push(Db);J=Mi(J,od)}var Od=db.length;db.forEach(function(He,jf){pa(Rb.decodePacket(He,V,!0),jf,Od)})};for(var ji={encode:function(J){var V="",pa;for(pa in J)J.hasOwnProperty(pa)&&(V.length&&(V+="&"),V+=encodeURIComponent(pa)+"="+
encodeURIComponent(J[pa]));return V},decode:function(J){var V={};J=J.split("&");for(var pa=0,db=J.length;pa<db;pa++){var Db=J[pa].split("=");V[decodeURIComponent(Db[0])]=decodeURIComponent(Db[1])}return V}},Em={},$k=Em=function(J,V){var pa=function(){};pa.prototype=V.prototype;J.prototype=new pa;J.prototype.constructor=J},Dm={},nn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Zk={},sk=0,nj=0,Fm;64>nj;nj++)Zk[nn[nj]]=nj;Na.encode=eb;Na.decode=function(J){var V=0;for(nj=
0;nj<J.length;nj++)V=64*V+Zk[J.charAt(nj)];return V};var oj=Dm=Na,Af="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Kk={},uk=Rb;Kk=Da;uc(Da.prototype);Da.prototype.onError=function(J,V){J=Error(J);J.type="TransportError";J.description=V;this.emit("error",J);return this||Af};Da.prototype.open=function(){if("closed"===(this||Af).readyState||""===(this||Af).readyState)(this||Af).readyState="opening",this.doOpen();return this||Af};Da.prototype.close=function(){if("opening"===
(this||Af).readyState||"open"===(this||Af).readyState)this.doClose(),this.onClose();return this||Af};Da.prototype.send=function(J){if("open"===(this||Af).readyState)this.write(J);else throw Error("Transport not open");};Da.prototype.onOpen=function(){(this||Af).readyState="open";(this||Af).writable=!0;this.emit("open")};Da.prototype.onData=function(J){J=uk.decodePacket(J,(this||Af).socket.binaryType);this.onPacket(J)};Da.prototype.onPacket=function(J){this.emit("packet",J)};Da.prototype.onClose=function(){(this||
Af).readyState="closed";this.emit("close")};var tk=Kk,Dg="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,ul={},vg=tk,Ai=Rb,Bh=Ga("engine.io-client:polling");ul=mb;var Jk=null!=(new Rc({xdomain:!1})).responseType;$k(mb,vg);mb.prototype.name="polling";mb.prototype.doOpen=function(){this.poll()};mb.prototype.pause=function(J){function V(){Bh("paused");pa.readyState="paused";J()}var pa=this||Dg;(this||Dg).readyState="pausing";if((this||Dg).polling||!(this||Dg).writable){var db=
0;(this||Dg).polling&&(Bh("we are currently polling - waiting to pause"),db++,this.once("pollComplete",function(){Bh("pre-pause polling complete");--db||V()}));(this||Dg).writable||(Bh("we are currently writing - waiting to pause"),db++,this.once("drain",function(){Bh("pre-pause writing complete");--db||V()}))}else V()};mb.prototype.poll=function(){Bh("polling");(this||Dg).polling=!0;this.doPoll();this.emit("poll")};mb.prototype.onData=function(J){var V=this||Dg;Bh("polling got data %s",J);Ai.decodePayload(J,
(this||Dg).socket.binaryType,function(pa,db,Db){if("opening"===V.readyState)V.onOpen();if("close"===pa.type)return V.onClose(),!1;V.onPacket(pa)});"closed"!==(this||Dg).readyState&&((this||Dg).polling=!1,this.emit("pollComplete"),"open"===(this||Dg).readyState?this.poll():Bh('ignoring poll - transport state "%s"',(this||Dg).readyState))};mb.prototype.doClose=function(){function J(){Bh("writing close packet");V.write([{type:"close"}])}var V=this||Dg;"open"===(this||Dg).readyState?(Bh("transport open - closing"),
J()):(Bh("transport not open - deferring close"),this.once("open",J))};mb.prototype.write=function(J){var V=this||Dg;(this||Dg).writable=!1;var pa=function(){V.writable=!0;V.emit("drain")};Ai.encodePayload(J,(this||Dg).supportsBinary,function(db){V.doWrite(db,pa)})};mb.prototype.uri=function(){var J=(this||Dg).query||{},V=(this||Dg).secure?"https":"http",pa="";!1!==(this||Dg).timestampRequests&&(J[(this||Dg).timestampParam]=oj());(this||Dg).supportsBinary||J.sid||(J.b64=1);J=ji.encode(J);(this||Dg).port&&
("https"===V&&443!==Number((this||Dg).port)||"http"===V&&80!==Number((this||Dg).port))&&(pa=":"+(this||Dg).port);J.length&&(J="?"+J);var db=-1!==(this||Dg).hostname.indexOf(":");return V+"://"+(db?"["+(this||Dg).hostname+"]":(this||Dg).hostname)+pa+(this||Dg).path+J};var qj=ul,le="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,vl={},Wm=qj,al=Ga("engine.io-client:polling-xhr");vl=dc;vl.Request=Mb;$k(dc,Wm);dc.prototype.supportsBinary=!0;dc.prototype.request=function(J){J=
J||{};J.uri=this.uri();J.xd=(this||le).xd;J.xs=(this||le).xs;J.agent=(this||le).agent||!1;J.supportsBinary=(this||le).supportsBinary;J.enablesXDR=(this||le).enablesXDR;J.withCredentials=(this||le).withCredentials;J.pfx=(this||le).pfx;J.key=(this||le).key;J.passphrase=(this||le).passphrase;J.cert=(this||le).cert;J.ca=(this||le).ca;J.ciphers=(this||le).ciphers;J.rejectUnauthorized=(this||le).rejectUnauthorized;J.requestTimeout=(this||le).requestTimeout;J.extraHeaders=(this||le).extraHeaders;return new Mb(J)};
dc.prototype.doWrite=function(J,V){J=this.request({method:"POST",data:J,isBinary:"string"!==typeof J&&void 0!==J});var pa=this||le;J.on("success",V);J.on("error",function(db){pa.onError("xhr post error",db)});(this||le).sendXhr=J};dc.prototype.doPoll=function(){al("xhr poll");var J=this.request(),V=this||le;J.on("data",function(pa){V.onData(pa)});J.on("error",function(pa){V.onError("xhr poll error",pa)});(this||le).pollXhr=J};uc(Mb.prototype);Mb.prototype.create=function(){var J={agent:(this||le).agent,
xdomain:(this||le).xd,xscheme:(this||le).xs,enablesXDR:(this||le).enablesXDR};J.pfx=(this||le).pfx;J.key=(this||le).key;J.passphrase=(this||le).passphrase;J.cert=(this||le).cert;J.ca=(this||le).ca;J.ciphers=(this||le).ciphers;J.rejectUnauthorized=(this||le).rejectUnauthorized;var V=(this||le).xhr=new Rc(J),pa=this||le;try{al("xhr open %s: %s",(this||le).method,(this||le).uri);V.open((this||le).method,(this||le).uri,(this||le).async);try{if((this||le).extraHeaders){V.setDisableHeaderCheck&&V.setDisableHeaderCheck(!0);
for(var db in(this||le).extraHeaders)(this||le).extraHeaders.hasOwnProperty(db)&&V.setRequestHeader(db,(this||le).extraHeaders[db])}}catch(Db){}if("POST"===(this||le).method)try{(this||le).isBinary?V.setRequestHeader("Content-type","application/octet-stream"):V.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(Db){}try{V.setRequestHeader("Accept","*/*")}catch(Db){}"withCredentials"in V&&(V.withCredentials=(this||le).withCredentials);(this||le).requestTimeout&&(V.timeout=(this||le).requestTimeout);
this.hasXDR()?(V.onload=function(){pa.onLoad()},V.onerror=function(){pa.onError(V.responseText)}):V.onreadystatechange=function(){if(2===V.readyState)try{var Db=V.getResponseHeader("Content-Type");if(pa.supportsBinary&&"application/octet-stream"===Db||"application/octet-stream; charset=UTF-8"===Db)V.responseType="arraybuffer"}catch(vc){}if(4===V.readyState)if(200===V.status||1223===V.status)pa.onLoad();else setTimeout(function(){pa.onError("number"===typeof V.status?V.status:0)},0)};al("xhr data %s",
(this||le).data);V.send((this||le).data)}catch(Db){setTimeout(function(){pa.onError(Db)},0);return}"undefined"!==typeof document&&((this||le).index=Mb.requestsCount++,Mb.requests[(this||le).index]=this||le)};Mb.prototype.onSuccess=function(){this.emit("success");this.cleanup()};Mb.prototype.onData=function(J){this.emit("data",J);this.onSuccess()};Mb.prototype.onError=function(J){this.emit("error",J);this.cleanup(!0)};Mb.prototype.cleanup=function(J){if("undefined"!==typeof(this||le).xhr&&null!==(this||
le).xhr){this.hasXDR()?(this||le).xhr.onload=(this||le).xhr.onerror=Zb:(this||le).xhr.onreadystatechange=Zb;if(J)try{(this||le).xhr.abort()}catch(V){}"undefined"!==typeof document&&delete Mb.requests[(this||le).index];(this||le).xhr=null}};Mb.prototype.onLoad=function(){try{try{var J=(this||le).xhr.getResponseHeader("Content-Type")}catch(pa){}var V="application/octet-stream"===J||"application/octet-stream; charset=UTF-8"===J?(this||le).xhr.response||(this||le).xhr.responseText:(this||le).xhr.responseText}catch(pa){this.onError(pa)}if(null!=
V)this.onData(V)};Mb.prototype.hasXDR=function(){return"undefined"!==typeof XDomainRequest&&!(this||le).xs&&(this||le).enablesXDR};Mb.prototype.abort=function(){this.cleanup()};Mb.requestsCount=0;Mb.requests={};"undefined"!==typeof document&&("function"===typeof attachEvent?attachEvent("onunload",Yb):"function"===typeof addEventListener&&addEventListener("onpagehide"in Oc?"pagehide":"unload",Yb,!1));var pn=vl,$l={},Xj=[].indexOf,qn=$l=function(J,V){if(Xj)return J.indexOf(V);for(var pa=0;pa<J.length;++pa)if(J[pa]===
V)return pa;return-1},pg="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Xn={},am=qj,xl=Oc;Xn=W;var Cm=/\n/g,Yj=/\\n/g,vk;$k(W,am);W.prototype.supportsBinary=!1;W.prototype.doClose=function(){(this||pg).script&&((this||pg).script.parentNode.removeChild((this||pg).script),(this||pg).script=null);(this||pg).form&&((this||pg).form.parentNode.removeChild((this||pg).form),(this||pg).form=null,(this||pg).iframe=null);am.prototype.doClose.call(this||pg)};W.prototype.doPoll=
function(){var J=this||pg,V=document.createElement("script");(this||pg).script&&((this||pg).script.parentNode.removeChild((this||pg).script),(this||pg).script=null);V.async=!0;V.src=this.uri();V.onerror=function(db){J.onError("jsonp poll error",db)};var pa=document.getElementsByTagName("script")[0];pa?pa.parentNode.insertBefore(V,pa):(document.head||document.body).appendChild(V);(this||pg).script=V;"undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var db=document.createElement("iframe");
document.body.appendChild(db);document.body.removeChild(db)},100)};W.prototype.doWrite=function(J,V){function pa(){db();V()}function db(){if(Db.iframe)try{Db.form.removeChild(Db.iframe)}catch(He){Db.onError("jsonp polling iframe removal error",He)}try{Od=document.createElement('<iframe src="javascript:0" name="'+Db.iframeId+'">')}catch(He){Od=document.createElement("iframe"),Od.name=Db.iframeId,Od.src="javascript:0"}Od.id=Db.iframeId;Db.form.appendChild(Od);Db.iframe=Od}var Db=this||pg;if(!(this||
pg).form){var vc=document.createElement("form"),od=document.createElement("textarea"),ud=(this||pg).iframeId="eio_iframe_"+(this||pg).index,Od;vc.className="socketio";vc.style.position="absolute";vc.style.top="-1000px";vc.style.left="-1000px";vc.target=ud;vc.method="POST";vc.setAttribute("accept-charset","utf-8");od.name="d";vc.appendChild(od);document.body.appendChild(vc);(this||pg).form=vc;(this||pg).area=od}(this||pg).form.action=this.uri();db();J=J.replace(Yj,"\\\n");(this||pg).area.value=J.replace(Cm,
"\\n");try{(this||pg).form.submit()}catch(He){}(this||pg).iframe.attachEvent?(this||pg).iframe.onreadystatechange=function(){"complete"===Db.iframe.readyState&&pa()}:(this||pg).iframe.onload=pa};var Lk=Xn,jk=Object.freeze({}),da="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,wa={},Xa=Hb.Buffer,za=tk,Qb=Rb,Nb=Ga("engine.io-client:websocket"),ec;"undefined"!==typeof WebSocket?ec=WebSocket:"undefined"!==typeof self&&(ec=self.WebSocket||self.MozWebSocket);if("undefined"===
typeof window)try{var lc=jk}catch(J){}var jd=ec||lc;wa=sa;$k(sa,za);sa.prototype.name="websocket";sa.prototype.supportsBinary=!0;sa.prototype.doOpen=function(){if(this.check()){var J=this.uri(),V=(this||da).protocols,pa={};(this||da).isReactNative||(pa.agent=(this||da).agent,pa.perMessageDeflate=(this||da).perMessageDeflate,pa.pfx=(this||da).pfx,pa.key=(this||da).key,pa.passphrase=(this||da).passphrase,pa.cert=(this||da).cert,pa.ca=(this||da).ca,pa.ciphers=(this||da).ciphers,pa.rejectUnauthorized=
(this||da).rejectUnauthorized);(this||da).extraHeaders&&(pa.headers=(this||da).extraHeaders);(this||da).localAddress&&(pa.localAddress=(this||da).localAddress);try{(this||da).ws=(this||da).usingBrowserWebSocket&&!(this||da).isReactNative?V?new jd(J,V):new jd(J):new jd(J,V,pa)}catch(db){return this.emit("error",db)}void 0===(this||da).ws.binaryType&&((this||da).supportsBinary=!1);(this||da).ws.supports&&(this||da).ws.supports.binary?((this||da).supportsBinary=!0,(this||da).ws.binaryType="nodebuffer"):
(this||da).ws.binaryType="arraybuffer";this.addEventListeners()}};sa.prototype.addEventListeners=function(){var J=this||da;(this||da).ws.onopen=function(){J.onOpen()};(this||da).ws.onclose=function(){J.onClose()};(this||da).ws.onmessage=function(V){J.onData(V.data)};(this||da).ws.onerror=function(V){J.onError("websocket error",V)}};sa.prototype.write=function(J){function V(){pa.emit("flush");setTimeout(function(){pa.writable=!0;pa.emit("drain")},0)}var pa=this||da;(this||da).writable=!1;for(var db=
J.length,Db=0,vc=db;Db<vc;Db++)(function(od){Qb.encodePacket(od,pa.supportsBinary,function(ud){if(!pa.usingBrowserWebSocket){var Od={};od.options&&(Od.compress=od.options.compress);pa.perMessageDeflate&&("string"===typeof ud?Xa.byteLength(ud):ud.length)<pa.perMessageDeflate.threshold&&(Od.compress=!1)}try{pa.usingBrowserWebSocket?pa.ws.send(ud):pa.ws.send(ud,Od)}catch(He){Nb("websocket closed before onclose event")}--db||V()})})(J[Db])};sa.prototype.onClose=function(){za.prototype.onClose.call(this||
da)};sa.prototype.doClose=function(){"undefined"!==typeof(this||da).ws&&(this||da).ws.close()};sa.prototype.uri=function(){var J=(this||da).query||{},V=(this||da).secure?"wss":"ws",pa="";(this||da).port&&("wss"===V&&443!==Number((this||da).port)||"ws"===V&&80!==Number((this||da).port))&&(pa=":"+(this||da).port);(this||da).timestampRequests&&(J[(this||da).timestampParam]=oj());(this||da).supportsBinary||(J.b64=1);J=ji.encode(J);J.length&&(J="?"+J);var db=-1!==(this||da).hostname.indexOf(":");return V+
"://"+(db?"["+(this||da).hostname+"]":(this||da).hostname)+pa+(this||da).path+J};sa.prototype.check=function(){return!!jd&&!("__initialize"in jd&&(this||da).name===sa.prototype.name)};var Ke={},Re=wa;Ke.polling=function(J){var V=!1,pa=!1,db=!1!==J.jsonp;"undefined"!==typeof location&&(pa="https:"===location.protocol,(V=location.port)||(V=pa?443:80),V=J.hostname!==location.hostname||V!==J.port,pa=J.secure!==pa);J.xdomain=V;J.xscheme=pa;if("open"in new Rc(J)&&!J.forceJSONP)return new pn(J);if(!db)throw Error("JSONP disabled");
return new Lk(J)};Ke.websocket=Re;var Jc="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,vf={},rf=Ga("engine.io-client:socket"),pi=Rb,Dj=Bd,on=ji;vf=xa;xa.priorWebsocketSuccess=!1;uc(xa.prototype);xa.protocol=pi.protocol;xa.Socket=xa;xa.Transport=tk;xa.transports=Ke;xa.parser=Rb;xa.prototype.createTransport=function(J){rf('creating transport "%s"',J);var V=(this||Jc).query,pa={},db;for(db in V)V.hasOwnProperty(db)&&(pa[db]=V[db]);pa.EIO=pi.protocol;pa.transport=J;
V=(this||Jc).transportOptions[J]||{};(this||Jc).id&&(pa.sid=(this||Jc).id);return new Ke[J]({query:pa,socket:this||Jc,agent:V.agent||(this||Jc).agent,hostname:V.hostname||(this||Jc).hostname,port:V.port||(this||Jc).port,secure:V.secure||(this||Jc).secure,path:V.path||(this||Jc).path,forceJSONP:V.forceJSONP||(this||Jc).forceJSONP,jsonp:V.jsonp||(this||Jc).jsonp,forceBase64:V.forceBase64||(this||Jc).forceBase64,enablesXDR:V.enablesXDR||(this||Jc).enablesXDR,withCredentials:V.withCredentials||(this||
Jc).withCredentials,timestampRequests:V.timestampRequests||(this||Jc).timestampRequests,timestampParam:V.timestampParam||(this||Jc).timestampParam,policyPort:V.policyPort||(this||Jc).policyPort,pfx:V.pfx||(this||Jc).pfx,key:V.key||(this||Jc).key,passphrase:V.passphrase||(this||Jc).passphrase,cert:V.cert||(this||Jc).cert,ca:V.ca||(this||Jc).ca,ciphers:V.ciphers||(this||Jc).ciphers,rejectUnauthorized:V.rejectUnauthorized||(this||Jc).rejectUnauthorized,perMessageDeflate:V.perMessageDeflate||(this||Jc).perMessageDeflate,
extraHeaders:V.extraHeaders||(this||Jc).extraHeaders,forceNode:V.forceNode||(this||Jc).forceNode,localAddress:V.localAddress||(this||Jc).localAddress,requestTimeout:V.requestTimeout||(this||Jc).requestTimeout,protocols:V.protocols||void 0,isReactNative:(this||Jc).isReactNative})};xa.prototype.open=function(){if((this||Jc).rememberUpgrade&&xa.priorWebsocketSuccess&&-1!==(this||Jc).transports.indexOf("websocket"))var J="websocket";else{if(0===(this||Jc).transports.length){var V=this||Jc;setTimeout(function(){V.emit("error",
"No transports available")},0);return}J=(this||Jc).transports[0]}(this||Jc).readyState="opening";try{J=this.createTransport(J)}catch(pa){(this||Jc).transports.shift();this.open();return}J.open();this.setTransport(J)};xa.prototype.setTransport=function(J){rf("setting transport %s",J.name);var V=this||Jc;(this||Jc).transport&&(rf("clearing existing transport %s",(this||Jc).transport.name),(this||Jc).transport.removeAllListeners());(this||Jc).transport=J;J.on("drain",function(){V.onDrain()}).on("packet",
function(pa){V.onPacket(pa)}).on("error",function(pa){V.onError(pa)}).on("close",function(){V.onClose("transport close")})};xa.prototype.probe=function(J){function V(){if(jf.onlyBinaryUpgrades){var mh=!(this||Jc).supportsBinary&&jf.transport.supportsBinary;He=He||mh}He||(rf('probe transport "%s" opened',J),Od.send([{type:"ping",data:"probe"}]),Od.once("packet",function(Ch){He||("pong"===Ch.type&&"probe"===Ch.data?(rf('probe transport "%s" pong',J),jf.upgrading=!0,jf.emit("upgrading",Od),Od&&(xa.priorWebsocketSuccess=
"websocket"===Od.name,rf('pausing current transport "%s"',jf.transport.name),jf.transport.pause(function(){He||"closed"===jf.readyState||(rf("changing transport and sending upgrade packet"),ud(),jf.setTransport(Od),Od.send([{type:"upgrade"}]),jf.emit("upgrade",Od),Od=null,jf.upgrading=!1,jf.flush())}))):(rf('probe transport "%s" failed',J),Ch=Error("probe error"),Ch.transport=Od.name,jf.emit("upgradeError",Ch)))}))}function pa(){He||(He=!0,ud(),Od.close(),Od=null)}function db(mh){var Ch=Error("probe error: "+
mh);Ch.transport=Od.name;pa();rf('probe transport "%s" failed because of error: %s',J,mh);jf.emit("upgradeError",Ch)}function Db(){db("transport closed")}function vc(){db("socket closed")}function od(mh){Od&&mh.name!==Od.name&&(rf('"%s" works - aborting "%s"',mh.name,Od.name),pa())}function ud(){Od.removeListener("open",V);Od.removeListener("error",db);Od.removeListener("close",Db);jf.removeListener("close",vc);jf.removeListener("upgrading",od)}rf('probing transport "%s"',J);var Od=this.createTransport(J,
{probe:1}),He=!1,jf=this||Jc;xa.priorWebsocketSuccess=!1;Od.once("open",V);Od.once("error",db);Od.once("close",Db);this.once("close",vc);this.once("upgrading",od);Od.open()};xa.prototype.onOpen=function(){rf("socket open");(this||Jc).readyState="open";xa.priorWebsocketSuccess="websocket"===(this||Jc).transport.name;this.emit("open");this.flush();if("open"===(this||Jc).readyState&&(this||Jc).upgrade&&(this||Jc).transport.pause){rf("starting upgrade probes");for(var J=0,V=(this||Jc).upgrades.length;J<
V;J++)this.probe((this||Jc).upgrades[J])}};xa.prototype.onPacket=function(J){if("opening"===(this||Jc).readyState||"open"===(this||Jc).readyState||"closing"===(this||Jc).readyState)switch(rf('socket receive: type "%s", data "%s"',J.type,J.data),this.emit("packet",J),this.emit("heartbeat"),J.type){case "open":this.onHandshake(JSON.parse(J.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var V=Error("server error");V.code=J.data;this.onError(V);break;case "message":this.emit("data",
J.data),this.emit("message",J.data)}else rf('packet received with socket readyState "%s"',(this||Jc).readyState)};xa.prototype.onHandshake=function(J){this.emit("handshake",J);(this||Jc).id=J.sid;(this||Jc).transport.query.sid=J.sid;(this||Jc).upgrades=this.filterUpgrades(J.upgrades);(this||Jc).pingInterval=J.pingInterval;(this||Jc).pingTimeout=J.pingTimeout;this.onOpen();"closed"!==(this||Jc).readyState&&(this.setPing(),this.removeListener("heartbeat",(this||Jc).onHeartbeat),this.on("heartbeat",
(this||Jc).onHeartbeat))};xa.prototype.onHeartbeat=function(J){clearTimeout((this||Jc).pingTimeoutTimer);var V=this||Jc;V.pingTimeoutTimer=setTimeout(function(){if("closed"!==V.readyState)V.onClose("ping timeout")},J||V.pingInterval+V.pingTimeout)};xa.prototype.setPing=function(){var J=this||Jc;clearTimeout(J.pingIntervalTimer);J.pingIntervalTimer=setTimeout(function(){rf("writing ping packet - expecting pong within %sms",J.pingTimeout);J.ping();J.onHeartbeat(J.pingTimeout)},J.pingInterval)};xa.prototype.ping=
function(){var J=this||Jc;this.sendPacket("ping",function(){J.emit("ping")})};xa.prototype.onDrain=function(){(this||Jc).writeBuffer.splice(0,(this||Jc).prevBufferLen);(this||Jc).prevBufferLen=0;0===(this||Jc).writeBuffer.length?this.emit("drain"):this.flush()};xa.prototype.flush=function(){"closed"!==(this||Jc).readyState&&(this||Jc).transport.writable&&!(this||Jc).upgrading&&(this||Jc).writeBuffer.length&&(rf("flushing %d packets in socket",(this||Jc).writeBuffer.length),(this||Jc).transport.send((this||
Jc).writeBuffer),(this||Jc).prevBufferLen=(this||Jc).writeBuffer.length,this.emit("flush"))};xa.prototype.write=xa.prototype.send=function(J,V,pa){this.sendPacket("message",J,V,pa);return this||Jc};xa.prototype.sendPacket=function(J,V,pa,db){"function"===typeof V&&(db=V,V=void 0);"function"===typeof pa&&(db=pa,pa=null);if("closing"!==(this||Jc).readyState&&"closed"!==(this||Jc).readyState){pa=pa||{};pa.compress=!1!==pa.compress;J={type:J,data:V,options:pa};this.emit("packetCreate",J);(this||Jc).writeBuffer.push(J);
if(db)this.once("flush",db);this.flush()}};xa.prototype.close=function(){function J(){db.onClose("forced close");rf("socket closing - telling transport to close");db.transport.close()}function V(){db.removeListener("upgrade",V);db.removeListener("upgradeError",V);J()}function pa(){db.once("upgrade",V);db.once("upgradeError",V)}if("opening"===(this||Jc).readyState||"open"===(this||Jc).readyState){(this||Jc).readyState="closing";var db=this||Jc;if((this||Jc).writeBuffer.length)this.once("drain",function(){(this||
Jc).upgrading?pa():J()});else(this||Jc).upgrading?pa():J()}return this||Jc};xa.prototype.onError=function(J){rf("socket error %j",J);xa.priorWebsocketSuccess=!1;this.emit("error",J);this.onClose("transport error",J)};xa.prototype.onClose=function(J,V){if("opening"===(this||Jc).readyState||"open"===(this||Jc).readyState||"closing"===(this||Jc).readyState){rf('socket close with reason: "%s"',J);var pa=this||Jc;clearTimeout((this||Jc).pingIntervalTimer);clearTimeout((this||Jc).pingTimeoutTimer);(this||
Jc).transport.removeAllListeners("close");(this||Jc).transport.close();(this||Jc).transport.removeAllListeners();(this||Jc).readyState="closed";(this||Jc).id=null;this.emit("close",J,V);pa.writeBuffer=[];pa.prevBufferLen=0}};xa.prototype.filterUpgrades=function(J){for(var V=[],pa=0,db=J.length;pa<db;pa++)~qn((this||Jc).transports,J[pa])&&V.push(J[pa]);return V};var Ik={};Ik=vf;Ik.parser=Rb;var Ep=Ik,Kq={},Mo=Kq=function(J,V){for(var pa=[],db=(V=V||0)||0;db<J.length;db++)pa[db-V]=J[db];return pa},
rn={},No=[].slice,Zj=rn=function(J,V){"string"==typeof V&&(V=J[V]);if("function"!=typeof V)throw Error("bind() requires a function");var pa=No.call(arguments,2);return function(){return V.apply(J,pa.concat(No.call(arguments)))}},Lq={},Mk=Lq=function(J,V,pa){J.on(V,pa);return{destroy:function(){J.removeListener(V,pa)}}},Ce="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Oo={},Pj=ib,bl=Ga("socket.io-client:socket");Oo=Oo=Eb;var Rr={connect:1,connect_error:1,connect_timeout:1,
connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},Gm=uc.prototype.emit;uc(Eb.prototype);Eb.prototype.subEvents=function(){if(!(this||Ce).subs){var J=(this||Ce).io;(this||Ce).subs=[Mk(J,"open",Zj(this||Ce,"onopen")),Mk(J,"packet",Zj(this||Ce,"onpacket")),Mk(J,"close",Zj(this||Ce,"onclose"))]}};Eb.prototype.open=Eb.prototype.connect=function(){if((this||Ce).connected)return this||Ce;this.subEvents();(this||Ce).io.reconnecting||
(this||Ce).io.open();if("open"===(this||Ce).io.readyState)this.onopen();this.emit("connecting");return this||Ce};Eb.prototype.send=function(){var J=Mo(arguments);J.unshift("message");(this||Ce).emit.apply(this||Ce,J);return this||Ce};Eb.prototype.emit=function(J){if(Rr.hasOwnProperty(J))return Gm.apply(this||Ce,arguments),this||Ce;var V=Mo(arguments),pa={type:(void 0!==(this||Ce).flags.binary?(this||Ce).flags.binary:ci(V))?Pj.BINARY_EVENT:Pj.EVENT,data:V,options:{}};pa.options.compress=!(this||Ce).flags||
!1!==(this||Ce).flags.compress;"function"===typeof V[V.length-1]&&(bl("emitting packet with ack id %d",(this||Ce).ids),(this||Ce).acks[(this||Ce).ids]=V.pop(),pa.id=(this||Ce).ids++);(this||Ce).connected?this.packet(pa):(this||Ce).sendBuffer.push(pa);(this||Ce).flags={};return this||Ce};Eb.prototype.packet=function(J){J.nsp=(this||Ce).nsp;(this||Ce).io.packet(J)};Eb.prototype.onopen=function(){bl("transport is open - connecting");if("/"!==(this||Ce).nsp)if((this||Ce).query){var J="object"===typeof(this||
Ce).query?ji.encode((this||Ce).query):(this||Ce).query;bl("sending connect packet with query %s",J);this.packet({type:Pj.CONNECT,query:J})}else this.packet({type:Pj.CONNECT})};Eb.prototype.onclose=function(J){bl("close (%s)",J);(this||Ce).connected=!1;(this||Ce).disconnected=!0;delete (this||Ce).id;this.emit("disconnect",J)};Eb.prototype.onpacket=function(J){var V=J.type===Pj.ERROR&&"/"===J.nsp;if(J.nsp===(this||Ce).nsp||V)switch(J.type){case Pj.CONNECT:this.onconnect();break;case Pj.EVENT:this.onevent(J);
break;case Pj.BINARY_EVENT:this.onevent(J);break;case Pj.ACK:this.onack(J);break;case Pj.BINARY_ACK:this.onack(J);break;case Pj.DISCONNECT:this.ondisconnect();break;case Pj.ERROR:this.emit("error",J.data)}};Eb.prototype.onevent=function(J){var V=J.data||[];bl("emitting event %j",V);null!=J.id&&(bl("attaching ack callback to event"),V.push(this.ack(J.id)));(this||Ce).connected?Gm.apply(this||Ce,V):(this||Ce).receiveBuffer.push(V)};Eb.prototype.ack=function(J){var V=this||Ce,pa=!1;return function(){if(!pa){pa=
!0;var db=Mo(arguments);bl("sending ack %j",db);V.packet({type:ci(db)?Pj.BINARY_ACK:Pj.ACK,id:J,data:db})}}};Eb.prototype.onack=function(J){var V=(this||Ce).acks[J.id];"function"===typeof V?(bl("calling ack %s with %j",J.id,J.data),V.apply(this||Ce,J.data),delete (this||Ce).acks[J.id]):bl("bad ack %s",J.id)};Eb.prototype.onconnect=function(){(this||Ce).connected=!0;(this||Ce).disconnected=!1;this.emit("connect");this.emitBuffered()};Eb.prototype.emitBuffered=function(){var J;for(J=0;J<(this||Ce).receiveBuffer.length;J++)Gm.apply(this||
Ce,(this||Ce).receiveBuffer[J]);(this||Ce).receiveBuffer=[];for(J=0;J<(this||Ce).sendBuffer.length;J++)this.packet((this||Ce).sendBuffer[J]);(this||Ce).sendBuffer=[]};Eb.prototype.ondisconnect=function(){bl("server disconnect (%s)",(this||Ce).nsp);this.destroy();this.onclose("io server disconnect")};Eb.prototype.destroy=function(){if((this||Ce).subs){for(var J=0;J<(this||Ce).subs.length;J++)(this||Ce).subs[J].destroy();(this||Ce).subs=null}(this||Ce).io.destroy(this||Ce)};Eb.prototype.close=Eb.prototype.disconnect=
function(){(this||Ce).connected&&(bl("performing disconnect (%s)",(this||Ce).nsp),this.packet({type:Pj.DISCONNECT}));this.destroy();if((this||Ce).connected)this.onclose("io client disconnect");return this||Ce};Eb.prototype.compress=function(J){(this||Ce).flags.compress=J;return this||Ce};Eb.prototype.binary=function(J){(this||Ce).flags.binary=J;return this||Ce};var sn=Oo,Ej="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Yn={};Yn=Pb;Pb.prototype.duration=function(){var J=
(this||Ej).ms*Math.pow((this||Ej).factor,(this||Ej).attempts++);if((this||Ej).jitter){var V=Math.random(),pa=Math.floor(V*(this||Ej).jitter*J);J=0==(Math.floor(10*V)&1)?J-pa:J+pa}return Math.min(J,(this||Ej).max)|0};Pb.prototype.reset=function(){(this||Ej).attempts=0};Pb.prototype.setMin=function(J){(this||Ej).ms=J};Pb.prototype.setMax=function(J){(this||Ej).max=J};Pb.prototype.setJitter=function(J){(this||Ej).jitter=J};var Zn=Yn,$n={},Po=Ga("socket.io-client:url"),Qo=$n=function(J,V){var pa=J;V=
V||"undefined"!==typeof location&&location;null==J&&(J=V.protocol+"//"+V.host);"string"===typeof J&&("/"===J.charAt(0)&&(J="/"===J.charAt(1)?V.protocol+J:V.host+J),/^(https?|wss?):\/\//.test(J)||(Po("protocol-less url %s",J),J="undefined"!==typeof V?V.protocol+"//"+J:"https://"+J),Po("parse %s",J),pa=Bd(J));pa.port||(/^(http|ws)$/.test(pa.protocol)?pa.port="80":/^(http|ws)s$/.test(pa.protocol)&&(pa.port="443"));pa.path=pa.path||"/";J=-1!==pa.host.indexOf(":")?"["+pa.host+"]":pa.host;pa.id=pa.protocol+
"://"+J+":"+pa.port;pa.href=pa.protocol+"://"+J+(V&&V.port===pa.port?"":":"+pa.port);return pa},Fd="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global,Fj={},Fp=ib,Xi=Ga("socket.io-client:manager"),Mq=Zn,Nq=Object.prototype.hasOwnProperty;Fj=Ha;Ha.prototype.emitAll=function(){(this||Fd).emit.apply(this||Fd,arguments);for(var J in(this||Fd).nsps)Nq.call((this||Fd).nsps,J)&&(this||Fd).nsps[J].emit.apply((this||Fd).nsps[J],arguments)};Ha.prototype.updateSocketIds=function(){for(var J in(this||
Fd).nsps)Nq.call((this||Fd).nsps,J)&&((this||Fd).nsps[J].id=this.generateId(J))};Ha.prototype.generateId=function(J){return("/"===J?"":J+"#")+(this||Fd).engine.id};uc(Ha.prototype);Ha.prototype.reconnection=function(J){if(!arguments.length)return(this||Fd)._reconnection;(this||Fd)._reconnection=!!J;return this||Fd};Ha.prototype.reconnectionAttempts=function(J){if(!arguments.length)return(this||Fd)._reconnectionAttempts;(this||Fd)._reconnectionAttempts=J;return this||Fd};Ha.prototype.reconnectionDelay=
function(J){if(!arguments.length)return(this||Fd)._reconnectionDelay;(this||Fd)._reconnectionDelay=J;(this||Fd).backoff&&(this||Fd).backoff.setMin(J);return this||Fd};Ha.prototype.randomizationFactor=function(J){if(!arguments.length)return(this||Fd)._randomizationFactor;(this||Fd)._randomizationFactor=J;(this||Fd).backoff&&(this||Fd).backoff.setJitter(J);return this||Fd};Ha.prototype.reconnectionDelayMax=function(J){if(!arguments.length)return(this||Fd)._reconnectionDelayMax;(this||Fd)._reconnectionDelayMax=
J;(this||Fd).backoff&&(this||Fd).backoff.setMax(J);return this||Fd};Ha.prototype.timeout=function(J){if(!arguments.length)return(this||Fd)._timeout;(this||Fd)._timeout=J;return this||Fd};Ha.prototype.maybeReconnectOnOpen=function(){!(this||Fd).reconnecting&&(this||Fd)._reconnection&&0===(this||Fd).backoff.attempts&&this.reconnect()};Ha.prototype.open=Ha.prototype.connect=function(J,V){Xi("readyState %s",(this||Fd).readyState);if(~(this||Fd).readyState.indexOf("open"))return this||Fd;Xi("opening %s",
(this||Fd).uri);(this||Fd).engine=Ep((this||Fd).uri,(this||Fd).opts);var pa=(this||Fd).engine,db=this||Fd;(this||Fd).readyState="opening";(this||Fd).skipReconnect=!1;var Db=Mk(pa,"open",function(){db.onopen();J&&J()});V=Mk(pa,"error",function(ud){Xi("connect_error");db.cleanup();db.readyState="closed";db.emitAll("connect_error",ud);if(J){var Od=Error("Connection error");Od.data=ud;J(Od)}else db.maybeReconnectOnOpen()});if(!1!==(this||Fd)._timeout){var vc=(this||Fd)._timeout;Xi("connect attempt will timeout after %d",
vc);0===vc&&Db.destroy();var od=setTimeout(function(){Xi("connect attempt timed out after %d",vc);Db.destroy();pa.close();pa.emit("error","timeout");db.emitAll("connect_timeout",vc)},vc);(this||Fd).subs.push({destroy:function(){clearTimeout(od)}})}(this||Fd).subs.push(Db);(this||Fd).subs.push(V);return this||Fd};Ha.prototype.onopen=function(){Xi("open");this.cleanup();(this||Fd).readyState="open";this.emit("open");var J=(this||Fd).engine;(this||Fd).subs.push(Mk(J,"data",Zj(this||Fd,"ondata")));(this||
Fd).subs.push(Mk(J,"ping",Zj(this||Fd,"onping")));(this||Fd).subs.push(Mk(J,"pong",Zj(this||Fd,"onpong")));(this||Fd).subs.push(Mk(J,"error",Zj(this||Fd,"onerror")));(this||Fd).subs.push(Mk(J,"close",Zj(this||Fd,"onclose")));(this||Fd).subs.push(Mk((this||Fd).decoder,"decoded",Zj(this||Fd,"ondecoded")))};Ha.prototype.onping=function(){(this||Fd).lastPing=new Date;this.emitAll("ping")};Ha.prototype.onpong=function(){this.emitAll("pong",new Date-(this||Fd).lastPing)};Ha.prototype.ondata=function(J){(this||
Fd).decoder.add(J)};Ha.prototype.ondecoded=function(J){this.emit("packet",J)};Ha.prototype.onerror=function(J){Xi("error",J);this.emitAll("error",J)};Ha.prototype.socket=function(J,V){function pa(){~qn(Db.connecting,db)||Db.connecting.push(db)}var db=(this||Fd).nsps[J];if(!db){db=new sn(this||Fd,J,V);(this||Fd).nsps[J]=db;var Db=this||Fd;db.on("connecting",pa);db.on("connect",function(){db.id=Db.generateId(J)});(this||Fd).autoConnect&&pa()}return db};Ha.prototype.destroy=function(J){J=qn((this||Fd).connecting,
J);~J&&(this||Fd).connecting.splice(J,1);(this||Fd).connecting.length||this.close()};Ha.prototype.packet=function(J){Xi("writing packet %j",J);var V=this||Fd;J.query&&0===J.type&&(J.nsp+="?"+J.query);V.encoding?V.packetBuffer.push(J):(V.encoding=!0,(this||Fd).encoder.encode(J,function(pa){for(var db=0;db<pa.length;db++)V.engine.write(pa[db],J.options);V.encoding=!1;V.processPacketQueue()}))};Ha.prototype.processPacketQueue=function(){if(0<(this||Fd).packetBuffer.length&&!(this||Fd).encoding){var J=
(this||Fd).packetBuffer.shift();this.packet(J)}};Ha.prototype.cleanup=function(){Xi("cleanup");for(var J=(this||Fd).subs.length,V=0;V<J;V++)(this||Fd).subs.shift().destroy();(this||Fd).packetBuffer=[];(this||Fd).encoding=!1;(this||Fd).lastPing=null;(this||Fd).decoder.destroy()};Ha.prototype.close=Ha.prototype.disconnect=function(){Xi("disconnect");(this||Fd).skipReconnect=!0;(this||Fd).reconnecting=!1;"opening"===(this||Fd).readyState&&this.cleanup();(this||Fd).backoff.reset();(this||Fd).readyState=
"closed";(this||Fd).engine&&(this||Fd).engine.close()};Ha.prototype.onclose=function(J){Xi("onclose");this.cleanup();(this||Fd).backoff.reset();(this||Fd).readyState="closed";this.emit("close",J);(this||Fd)._reconnection&&!(this||Fd).skipReconnect&&this.reconnect()};Ha.prototype.reconnect=function(){if((this||Fd).reconnecting||(this||Fd).skipReconnect)return this||Fd;var J=this||Fd;if((this||Fd).backoff.attempts>=(this||Fd)._reconnectionAttempts)Xi("reconnect failed"),(this||Fd).backoff.reset(),this.emitAll("reconnect_failed"),
(this||Fd).reconnecting=!1;else{var V=(this||Fd).backoff.duration();Xi("will wait %dms before reconnect attempt",V);(this||Fd).reconnecting=!0;var pa=setTimeout(function(){J.skipReconnect||(Xi("attempting reconnect"),J.emitAll("reconnect_attempt",J.backoff.attempts),J.emitAll("reconnecting",J.backoff.attempts),J.skipReconnect||J.open(function(db){db?(Xi("reconnect attempt error"),J.reconnecting=!1,J.reconnect(),J.emitAll("reconnect_error",db.data)):(Xi("reconnect success"),J.onreconnect())}))},V);
(this||Fd).subs.push({destroy:function(){clearTimeout(pa)}})}};Ha.prototype.onreconnect=function(){var J=(this||Fd).backoff.attempts;(this||Fd).reconnecting=!1;(this||Fd).backoff.reset();this.updateSocketIds();this.emitAll("reconnect",J)};var Ro=Fj,Hm={},Gp=Qo,Hp=ib,So=Ro,Oq=Ga("socket.io-client");Hm=Hm=Lb;var ao=Hm.managers={};Hm.protocol=Hp.protocol;Hm.connect=Lb;Hm.Manager=Ro;Hm.Socket=sn;var Sr=Hm,If=lively.FreezerRuntime.recorderFor("lively.2lively/client.js");If.determineLocation=function(){return"undefined"!==
typeof document&&document.location?document.location.origin:If.isNode?System._nodeRequire("os").hostname():System.baseURL};If.promise=xb;If.fun=qd;If.obj=Dc;If.events=hd;If.num=Hc;If.L2LConnection=vd;If.defaultActions=Ma;If.defaultClientActions=Mc;If.isNode="undefined"!==typeof System?System.get("@system-env").node:"undefined"!==typeof process&&process.env;If._ioClient=Sr;If.ioClient=If.ioClient||void 0;If.isNode?(If.require=System._nodeRequire("module")._load,If.ioClient=If.require("socket.io-client")):
If.ioClient=If._ioClient;If.urlHelper={isRoot:function(J){return"/"===If.urlHelper.path(J)},root:function(J){return If.urlHelper.isRoot(J)?J:J.slice(0,-If.urlHelper.path(J).length)+"/"},path:function(){var J=/^[a-z0-9-_\.]+:/,V=/^\/\/[^\/]+/;return function(pa){pa=pa.replace(J,"").replace(V,"");return""===pa?"/":pa}}(),join:function(J,V){J.endsWith("/")&&(J=J.slice(0,-1));V.startsWith("/")&&(V=V.slice(1));return J+"/"+V}};var Lh=function(J,V,pa,db){var Db=If.L2LConnection.call(this)||this;If.events.makeEmitter(Db);
Db.info=db;Db.origin=J;Db.path=V;Db.namespace=pa.replace(/^\/?/,"/");Db.trackerId=null;Db._socketioClient=null;Db._reconnectState={closed:!1,autoReconnect:!0,isReconnecting:!1,isReconnectingViaSocketio:!1,registerAttempt:0,registerProcess:null,isOpening:!1};Object.keys(If.defaultActions).forEach(function(vc){return Db.addService(vc,If.defaultActions[vc])});Object.keys(If.defaultClientActions).forEach(function(vc){return Db.addService(vc,If.defaultClientActions[vc])});return Db};$jscomp.inherits(Lh,
If.L2LConnection);Lh.clientKey=function(J,V,pa){J=J.replace(/\/$/,"");V=V.replace(/^\//,"");pa=pa.replace(/^\//,"");return J+"-"+V+"-"+pa};Lh.forLivelyInBrowser=function(J){var V=!!J;J=Object.assign({type:"lively.morphic browser"},J);var pa=this.default();if(!pa)return If.L2LClient.ensure({url:document.location.origin+"/lively-socket.io",namespace:"l2l",info:J});V&&!If.obj.equals(pa.info,J)&&pa.isRegistered()&&(pa.info=J,pa.unregister().then(function(){return pa.register()}).catch(function(db){return console.error("l2l re-register on info change errored: "+
db)}));return pa};Lh.default=function(){var J=If.L2LClient.clients.keys().next().value;return If.L2LClient.clients.get(J)};Lh.create=function(J){var V=J=void 0===J?{}:J;J=void 0===V.debug?!1:V.debug;var pa=V.url,db=V.namespace,Db=void 0===V.autoOpen?!0:V.autoOpen;V=void 0===V.info?{}:V.info;if(!pa)throw Error("L2LClient needs server url!");var vc=If.urlHelper.root(pa).replace(/\/+$/,"");pa=If.urlHelper.path(pa);db=new this(vc,pa,db||"",V);Db&&db.register();db.debug=J;return db};Lh.ensure=function(J){var V=
J=void 0===J?{}:J,pa=V.url;V=V.namespace;if(!pa)throw Error("L2LClient needs server url!");var db=If.urlHelper.root(pa).replace(/\/+$/,""),Db=If.urlHelper.path(pa);db=this.clientKey(db,Db,V||"");(Db=this.clients.get(db))||this.clients.set(db,Db=this.create(Object.assign({},J,{url:pa,namespace:V})));return Db};Lh.prototype.isOnline=function(){return this.socket&&this.socket.connected};Lh.prototype.isRegistered=function(){return this.isOnline()&&!!this.trackerId};Lh.prototype.open=function(){var J=
this,V,pa,db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){if(1==Db.nextAddress)return J.isOnline()||J._reconnectState.isOpening?Db.return(J):Db.yield(J.close(),2);J._reconnectState.closed=!1;V=If.urlHelper.join(J.origin,J.namespace);pa={path:J.path,transports:["websocket","polling"]};db=J._socketioClient=If.ioClient(V,pa);J.debug&&console.log("["+J+"] connecting");db.on("error",function(vc){J._reconnectState.isOpening=!1;J.debug&&console.log("["+J+"] errored: "+vc)});db.on("close",
function(vc){return J.debug&&console.log("["+J+"] closed: "+vc)});db.on("reconnect_failed",function(){return J.debug&&console.log("["+J+"] could not reconnect")});db.on("reconnect_error",function(vc){return J.debug&&console.log("["+J+"] reconnect error "+vc)});db.on("connect",function(){J.debug&&console.log("["+J+"] connected");J.emit("connected",J);J._reconnectState.isOpening=!1;J._reconnectState.isReconnecting=!1;J._reconnectState.isReconnectingViaSocketio=!1});db.on("disconnect",function(){J._reconnectState.isOpening=
!1;J.debug&&console.log("["+J+"] disconnected");J.emit("disconnected",J);J.trackerId?("tracker"!==J.trackerId&&(J.renameTarget(J.trackerId,"tracker"),J.trackerId=null),J._reconnectState.closed?J.debug&&console.log("["+J+"] won't reconnect b/c client is marked as closed"):J._reconnectState.autoReconnect?(J._reconnectState.isReconnecting=!0,setTimeout(function(){J._reconnectState.closed?J.debug&&console.log("["+J+"] won't reconnect b/c client is marked as closed 2"):J._reconnectState.isReconnectingViaSocketio?
J.debug&&console.log("["+J+"] won't reconnect again, client already reconnecting"):(J.debug&&console.log("["+J+"] initiating reconnection to tracker"),J.register())},20)):J.debug&&console.log("["+J+"] won't reconnect b/c client has reconnection disabled")):(J.debug&&console.log("["+J+"] disconnect: don't have a tracker id, won't try reconnect"),J.trackerId="tracker")});db.on("reconnecting",function(){J.debug&&console.log("["+J+"] reconnecting",J._reconnectState);J.emit("reconnecting",J);J._reconnectState.closed?
(J._reconnectState.isReconnecting=!1,J._reconnectState.isReconnectingViaSocketio=!1,db.close(),J.close()):(J._reconnectState.isReconnecting=!0,J._reconnectState.isReconnectingViaSocketio=!0)});db.on("reconnect",function(){J.debug&&console.log("["+J+"] reconnected");J._reconnectState.isReconnecting=!1;J._reconnectState.isReconnectingViaSocketio=!1;J.register()});J.installEventToMessageTranslator(db);J._reconnectState.isOpening=!0;return Db.return((new Promise(function(vc,od){db.once("error",od);db.once("connect",
vc)})).then(function(){return J}))})};Lh.prototype.close=function(){var J=this,V,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(db){if(1==db.nextAddress){J._reconnectState.closed=!0;if(V=J.socket)V.removeAllListeners("reconnect"),V.removeAllListeners("reconnecting"),V.removeAllListeners("disconnect"),V.removeAllListeners("connect"),V.removeAllListeners("reconnect_error"),V.removeAllListeners("reconnect_failed"),V.removeAllListeners("close"),V.removeAllListeners("error"),V.close();
J.debug&&console.log("["+J+"] closing...");return J.isRegistered()?db.yield(J.unregister(),2):db.jumpTo(2)}return J.isOnline()||J.socket?V&&!V.connected?(J.debug&&console.log("["+J+"] socket not connected, considering client closed"),db.return(J)):db.return(Promise.race([If.promise.delay(2E3).then(function(){return V.removeAllListeners("disconnect")}),new Promise(function(Db){return V.once("disconnect",Db)})]).then(function(){J.debug&&console.log("["+J+"] closed");return J})):(J.debug&&(pa=J.isOnline()?
"no socket":"not online",J.debug&&console.log("["+J+"] cannot close: "+pa)),db.return(J))})};Lh.prototype.remove=function(){var J=this.constructor.clientKey(this.origin,this.path,this.namespace);this.constructor.clients.delete(J);return this.close()};Lh.prototype.register=function(){var J=this,V,pa,db,Db,vc,od,ud,Od,He,jf;return $jscomp.asyncExecutePromiseGeneratorProgram(function(mh){switch(mh.nextAddress){case 1:if(J.isRegistered())return mh.return();if(J._reconnectState.closed)return J.debug&&
console.log("["+J+"] not registering this b/c closed"),J._reconnectState.registerAttempt=0,mh.return();if(J._reconnectState.registerProcess)return J.debug&&console.log("["+J+"] not registering this b/c register process exists"),mh.return();mh.setCatchFinallyBlocks(2);if(J.isOnline()){mh.jumpTo(4);break}return mh.yield(J.open(),4);case 4:return J.debug&&console.log("["+J+"] register"),mh.yield(J.sendToAndWait("tracker","register",Object.assign({userName:"unknown",type:"l2l "+(If.isNode?"node":"browser"),
location:If.determineLocation()},J.info)),6);case 6:V=mh.yieldResult;if(!V.data)throw pa=Error("Register answer is empty!"),J.emit("error",pa),pa;if(V.data.isError)throw db=Error(V.data.error),J.emit("error",db),db;J._reconnectState.registerAttempt=0;Db=V;vc=Db.data;od=vc.trackerId;ud=vc.messageNumber;J.trackerId=od;J._incomingOrderNumberingBySenders.set(od,ud||0);J.emit("registered",{trackerId:od});mh.leaveTryBlock(0);break;case 2:Od=mh.enterCatchBlock(),console.error("Error in register request of "+
J+": "+Od),He=J._reconnectState.registerAttempt++,jf=If.num.backoff(He,4,3E5),J._reconnectState.registerProcess=setTimeout(function(){J._reconnectState.registerProcess=null;J.register()},jf),mh.jumpToEnd()}})};Lh.prototype.unregister=function(){var J=this,V;return $jscomp.asyncExecutePromiseGeneratorProgram(function(pa){switch(pa.nextAddress){case 1:if(!J.isRegistered())return pa.return();J.debug&&console.log("["+J+"] unregister");V=J.trackerId;pa.setCatchFinallyBlocks(2);return pa.yield(J.sendToAndWait(J.trackerId,
"unregister",{}),4);case 4:pa.leaveTryBlock(3);break;case 2:pa.enterCatchBlock();case 3:J.renameTarget(V,"tracker"),J.trackerId=null,J.emit("unregistered",J),pa.jumpToEnd()}})};Lh.prototype.whenRegistered=function(J){var V=this;return If.promise.waitFor(J,function(){return V.isRegistered()}).catch(function(pa){return Promise.reject(/timeout/i.test(String(pa))?Error("Timeout in "+V+".whenRegistered"):pa)})};Lh.prototype.send=function(J,V){var pa=this,db=$jscomp.makeIterator(this.prepareSend(J,V));
J=db.next().value;V=db.next().value;this.whenOnline().then(function(){var Db=pa.socket,vc=J,od=vc.action;vc=vc.target;if(!Db)throw Error("Trying to send message "+od+" to "+vc+" but cannot find a connection to it!");"function"===typeof V?Db.emit(od,J,V):Db.emit(od,J)})};Lh.prototype.joinRoom=function(J){var V=this;return this.whenOnline().then(function(){return V.sendToAndWait(V.trackerId,"[broadcast] join room",{room:J})})};Lh.prototype.leaveRoom=function(J){var V=this;return this.whenOnline().then(function(){return V.sendToAndWait(V.trackerId,
"[broadcast] leave room",{room:J})})};Lh.prototype.broadcast=function(J,V,pa,db,Db){var vc=this,od={action:V,room:J,broadcast:pa};if(void 0===db?0:db)od.isSystemBroadcast=!0;if(void 0===Db?0:Db)od.isMultiServerBroadcast=!0;return this.whenOnline().then(function(){return vc.sendToAndWait(vc.trackerId,"[broadcast] send",od)})};Lh.prototype.listRoomMembers=function(J){var V=this,pa,db;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Db){if(1==Db.nextAddress)return Db.yield(V.sendToAndWait(V.trackerId,
"[broadcast] list room members",{room:J}),2);pa=Db.yieldResult;db=pa.data;return Db.return(db)})};Lh.prototype.joinedRooms=function(){var J=this,V,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(db){if(1==db.nextAddress)return db.yield(J.sendToAndWait(J.trackerId,"[broadcast] my rooms",{}),2);V=db.yieldResult;pa=V.data;return db.return(pa)})};Lh.prototype.listRooms=function(){var J=this,V,pa;return $jscomp.asyncExecutePromiseGeneratorProgram(function(db){if(1==db.nextAddress)return db.yield(J.sendToAndWait(J.trackerId,
"[broadcast] all rooms",{}),2);V=db.yieldResult;pa=V.data;return db.return(pa)})};Lh.prototype.listPeers=function(J){J=void 0===J?!1:J;var V=this,pa,db,Db,vc,od,ud;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Od){if(1==Od.nextAddress)return pa=V,db=pa._peersCached,Db=Date.now(),!J&&db&&1E3>Db-db.timestamp?Od.return(V._peersCached.sessions):V.isOnline()?Od.yield(V.sendToAndWait(V.trackerId,"getClients",{}),2):Od.return([]);vc=Od.yieldResult;od=vc.data;ud=od.map(function(He){var jf=$jscomp.makeIterator(He);
He=jf.next().value;var mh=jf.next().value,Ch=mh.info||{};jf=Ch.userRealm;var Yi=Ch.userToken,Im=Ch.l2lUserToken,Xm=Ch.location,tn=Ch.type;Ch=Ch.world;He=Object.assign({},If.obj.dissoc(mh,["info"]),{id:He,world:Ch,location:Xm,type:tn});(Yi=Yi||Im)&&"null"!==Yi&&(lively.user?He.user=lively.user.ClientUser.fromToken(Yi,jf):(He.userToken=Yi,He.userRealm=jf));return He});V._peersCached={timestamp:Db,sessions:ud};return Od.return(ud)})};Lh.prototype.toString=function(){var J=this.origin,V=this.path,pa=
this.namespace,db=this.id,Db=this.isOnline()?this.isRegistered()?"registered":"unregistered":"disconnected";return"L2LClient("+(db||"").slice(0,5)+" "+J+V+" - "+pa+" "+Db+")"};$jscomp.global.Object.defineProperties(Lh.prototype,{socket:{configurable:!0,enumerable:!0,get:function(){return this._socketioClient}},socketId:{configurable:!0,enumerable:!0,get:function(){return this.socket?this.socket.id:null}}});$jscomp.global.Object.defineProperties(Lh,{clients:{configurable:!0,enumerable:!0,get:function(){return this._clients||
(this._clients=new Map)}}});ta("default",Lh);If.L2LClient=Lh;If.default=Lh}}});